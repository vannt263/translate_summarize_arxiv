{
  "article_text": [
    "since their introduction by brenger in @xcite for the time dependent maxwell s equations , perfectly matched layers ( pmls ) have become a widely used technique in computational physics .",
    "the idea is to enclose the area of interest by surrounded layers which are absorbing and perfectly reflectionless .",
    "subsequent formulations ( @xcite ) allow to consider pmls as a complex change of co - ordinates , which implies equivalent material properties ( @xcite ) .",
    "a properly designed change of variables preserves the solution in the region of interest while introducing exponential decay at infinity .",
    "it is then obvious to truncate the problem to a finite domain , set a convenient boundary condition on the boundary of this domain and apply the fem . in a scattering problem , the `` traditional co - ordinate stretching '' is frequency dependent , yielding a constant attenuation of propagating waves .",
    "however , these kinds of pmls are inefficient for periodic problems when dealing with grazing angles of diffracted orders , i.e.  when the frequency is near a wood s anomaly ( @xcite ) , leading to spurious reflexions and thus numerical pollution of the results . an important question in designing absorbing layers",
    "is thus the choice of their parameters : the pml thickness and the absorption coefficient . to this aim ,",
    "adaptive formulation have been set up , most of them employing a posteriori error estimate ( @xcite ) . in this paper",
    ", we propose adaptive pmls ( apmls ) with a suitable co - ordinate stretching , depending both on incidence and grating parameters , capable of efficiently absorbing propagating waves with nearly grazing angles . in the first section",
    ", we detail our fem formulation and expose the problems arising when dealing with wood s anomalies .",
    "section 2 is dedicated to the mathematical formulation used to determine pml parameters adapted to any diffraction orders . in the last section ,",
    "we provide a numerical example of a dielectric slit grating showing the efficiency of our approach in comparison with classical pmls .",
    "we denote by @xmath0 , @xmath1 and @xmath2 the unit vectors of an orthogonal co - ordinate system @xmath3 .",
    "we deal with time - harmonic fields , so that the electric and magnetic fields are represented by complex vector fields @xmath4 and @xmath5 with a time - dependence in @xmath6 , which will be discarded in the sequel .",
    "moreover , we denote @xmath7 .",
    "+        the materials in this paper may be @xmath8-anisotropic , so the tensor fields of relative permittivity @xmath9 and relative permeability @xmath10 are of the following form :    @xmath11    where the coefficients @xmath12 , @xmath13, ... @xmath14 are ( possibly ) complex valued functions of @xmath15 and @xmath16 , and where @xmath17 ( resp .",
    "@xmath18 ) is the complex conjugate of @xmath19 ( resp .",
    "@xmath20 ) .",
    "the grating is illuminated by an incident plane wave of wave vector defined by the angle @xmath21 : @xmath22 .",
    "its electric ( resp .",
    "magnetic ) field is linearly polarized along the @xmath8-axis , this is the so - called transverse electric or s - polarization case ( resp . transverse magnetic or p - polarization case ) : @xmath23    where @xmath24 ( resp .",
    "@xmath25 ) are arbitrary complex numbers and @xmath26 .",
    "the diffraction problem we are dealing with is to solve maxwell s equations in harmonic regime , i.e.  to find the unique solution @xmath27 of :    @xmath28    [ systmaxwell ]    such that the diffracted field @xmath29 and @xmath30 satisfies an outgoing wave condition ( owc , @xcite ) and where @xmath4 and @xmath5 are quasi - periodic with respect to the @xmath15 co - ordinate .",
    "+ under the aforementioned assumptions , the diffraction problem in non conical mounting can be separated in two fundamental scalar cases te and tm .",
    "thus we search for a @xmath8-linearly polarized electric ( resp.magnetic ) field @xmath31 ( resp .",
    "@xmath32 ) .",
    "denoting @xmath33 and @xmath34 the @xmath35 matrices extracted from @xmath9 and @xmath10 :    @xmath36    the functions @xmath37 and @xmath38 are solution of similar differential equations :    @xmath39    with    @xmath40    for the te case , @xmath41 for the tm case .",
    "+ the gratings we are dealing with are made of three regions ( see fig . [ diffset ] ) :    * _ the superstrate _",
    "( @xmath42 ) which is supposed to be homogeneous , isotropic and lossless and characterized solely by its relative permittivity @xmath43 and its relative permeability @xmath44 and we denote @xmath45 , where @xmath46 . * _ the substrate _ ( @xmath47 ) which is supposed to be homogeneous and isotropic and therefore characterized by its relative permittivity @xmath48 and its relative permeability @xmath49 and we denote @xmath50 * _ the groove region _ ( @xmath51 ) , embedded in the superstrate , which can be heterogeneous , @xmath8-anisotropic and lossy , so that it is characterised by the tensor fields @xmath52 and @xmath53 .",
    "the periodicity of the grooves along @xmath54 is denoted @xmath55 .",
    "+      transformation optics have recently unified various techniques in computational electromagnetics such as the treatment of open problems , helicoidal geometries or the design of invisibility cloaks ( @xcite ) .",
    "these apparently different problems share the same concept of geometrical transformation , leading to equivalent material properties .",
    "a very simple and practical rule can be set up ( @xcite ) : when changing the co - ordinate system , all you have to do is to replace the initial materials properties @xmath9 and @xmath10 by equivalent material properties @xmath56 and @xmath57 given by the following rule :    @xmath58    where @xmath59 is the jacobian matrix of the co - ordinate transformation consisting of the partial derivatives of the new co - ordinates with respect to the original ones ( @xmath60 is the transposed of its inverse ) .",
    "+ in this framework , the most natural way to define pmls is to consider them as maps on a complex space @xmath61 , which co - ordinate change leads to equivalent permittivity and permeability tensors .",
    "we detail here the different co - ordinates used in this paper .    * @xmath62 are the cartesian original co - ordinates .",
    "* @xmath63 are the complex stretched co - ordinates .",
    "a suitable subspace @xmath64 is chosen ( with three real dimensions ) such that @xmath63 are the complex valued co - ordinates of a point on @xmath65 ( e.g.  @xmath66 , @xmath67 , @xmath68 ) .",
    "* @xmath69 are three real co - ordinates corresponding to a real valued parametrization of @xmath64 .    in this paper , we use rectangular pmls ( @xcite ) absorbing in the @xmath16-direction and we choose a diagonal matrix @xmath70 , where @xmath71 is a complex - valued function defined by :    @xmath72    the expression of the equivalent permittivity and permeability tensors are thus : @xmath73    . ]    note that the equivalent medium has the same impedance than the original one as @xmath9 an @xmath10 are transformed in the same way , which guarantees that the pml is perfectly reflectionless .",
    "+ we are now in position to define the so - called substituted field @xmath74 , solution of eqs .",
    "( [ systmaxwell ] ) with @xmath75 and @xmath76 .",
    "@xmath77 equals the field @xmath78 in the region @xmath79 ( with @xmath80 and @xmath81 ) , provided that @xmath82 in this region ( cf .",
    "[ cell ] ) .",
    "the complex co - ordinate mapping @xmath83 is simply defined as the derivative of the stretching coefficient @xmath71 with respect to @xmath84 . with simple stretching functions ,",
    "we can obtain a reliable criterion on the decaying of the fields .",
    "a classical choice is : @xmath85 where @xmath86 are complex constants with @xmath87 . + in that case , the complex valued function @xmath83 defined by eq .",
    "( [ ys ] ) is explicitly given by : @xmath88 + let s now study the behaviour of the field in the pmls . in the substrate and the superstrate , according to bloch s theorem , the diffracted field @xmath89 can be written as :    @xmath90    where @xmath91    eventually , denoting @xmath92    and accounting for an owc , we obtain the expressions of the different diffraction orders : @xmath93    we focus on the bottom pml , as similar considerations can be conducted for the top pml .",
    "we consider a diffraction order propagating in the substrate , which can be expressed in the stretched co - ordinate system as :    @xmath94}.\\ ] ]    the non oscillating part of this function is given by :    @xmath95    where @xmath96 . for a propagating order",
    "we have @xmath97 and @xmath98 , while for an evanescent order @xmath99 and @xmath100 .",
    "it is thus sufficient to take @xmath101 and @xmath102 to ensure the exponential decay to zero of the field inside the pml if it was of infinite extent .",
    "but , of course , for practical purposes , the height of the pml is finite and have to be suitably chosen . for this",
    ", two pitfalls must be avoided :    1 .",
    "the pml is too small compared to the skin depth . as a consequence",
    ", the electromagnetic wave can not be considered as vanishing : this limited pml is no longer reflectionless .",
    "the pml is much larger than the skin depth . in that case ,",
    "a significant part of the pml is not useful , which gives rise to the resolution of linear systems of large dimensions .",
    "it then remains to derive the skin depth , @xmath103 , associated with the propagating order @xmath104 .",
    "this characteristic depth is defined as the length for which the field is divided by @xmath37 : @xmath105    so @xmath106 , and we take the larger value among the @xmath103 : @xmath107    we set the height of the bottom pml region @xmath108 . +      our fem formulation is that described in @xcite .",
    "it relies on the fact that the diffraction problem can be rigorously treated as an equivalent radiation problem with sources inside the diffractive object .",
    "the expression of the source terms depends on the field @xmath109 solution of the annex problem of a simple interface , and is known in closed form . in this context , the role of the pmls is to damp the field radiated by the sources .",
    "we set quasi - periodicity conditions on lateral boundaries and neumann homogeneous conditions are imposed on the outward boundary of each pml . by so doing , the electromagnetic wave is not forced to vanish and the values of the computed field on these boundaries give valuable information on the absorbing efficiency of the pmls .",
    "the cell defined in fig .",
    "[ cell ] is meshed using @xmath110^nd^ order lagrange elements ( @xcite ) . in the numerical examples in the sequel ,",
    "the maximum element size is set to @xmath111 , where @xmath112 is an integer ( between 6 and 10 is usually a good choice ) .",
    "the final algebraic system is solved using a direct solver ( pardiso ) .",
    "+ note that we use this fem formulation in this paper but the results of the sequel about pmls are general and can be applied to any numerical method used for the modelling of diffraction gratings .      ) for different values of @xmath113 : blue line , @xmath114 , correct damping ; green line , @xmath115 , underdamping ; red line , @xmath116 , overdamping . ]    resuming part [ impl_pml ] , we consider only the bottom pml , as analogous conclusions holds for the top pml .",
    "the efficiency of the classical pml fails for grazing diffracted angles , in other words when a given order appears / vanishes : this is the so - called wood s anomaly , well known in the theory of gratings . in mathematical words",
    ", there exists @xmath117 such that @xmath118 .",
    "the skin depth of the pml then becomes very large . to compensate it",
    ", one should increase the value of @xmath113 , but this gives rise to spurious numerical reflections due to an overdamping .",
    "for a fixed value of @xmath119 , if @xmath113 is too weak , the absorption in the pmls is insufficient and the wave reflects on the outward boundary of the pml . to illustrate these typical behaviours ( cf .",
    "[ behaviour_classical_pml ] ) , we compute the diffracted field by a grating with a rectangular cross section of height @xmath120  and width @xmath121  with @xmath122 , deposited on a substrate with permittivity @xmath123 . the structure is illuminated by a _",
    "p_-polarized plane wave of wavelength @xmath124  and of angle of incidence @xmath125  in the air ( @xmath126 ) .",
    "all materials are non magnetic ( @xmath127 ) and the periodicity of the grating is @xmath128 .",
    "we set @xmath129 and @xmath130 .",
    "to overcome the problems pointed out in the preceding section , we propose a co - ordinate stretching that rigorously treats the problem of wood s anomalies .",
    "the wavelengths `` seen '' by the system are very different depending on the order at stake :    * if the diffracted angle @xmath131 is zero , the apparent wavelength @xmath132 is simply the incident wavelength , * if the diffracted angle is near @xmath133 ( grazing angle ) , the apparent wavelength @xmath132 is very large .",
    "thus if a classical pml is adapted to one diffracted order , it will not be for another , and vice versa .",
    "the idea behind the apml is to deal with each and every order when progressing in the absorbing medium .",
    "+ once again the development will be conducted only for the pml adapted to the substrate .",
    "we consider a real - valued co - ordinate mapping @xmath134 , the final complex - valued mapping is then @xmath135 , with the complex constant @xmath136 , with @xmath101 and @xmath102 , accounting for the damping of the pml medium .",
    "we start by transforming eq .",
    "( [ betan ] ) , @xmath137 a function with integer argument into a function with real argument continuously interpolated between the imposed integer values .",
    "indeed , the geometric transformations associated to the pml has to be continuous and differentiable in order to compute the jacobian . for this purpose",
    ", we choose the parametrization :    @xmath138    so that the application @xmath139 defined by @xmath140 is continuous .",
    "thus , the propagation constant of the @xmath141 transmitted order is given by @xmath142 .",
    "the key idea is to combine the complex stretching with a real non uniform contraction ( given by the continuous function @xmath143 , eq.([yyd ] ) ) .",
    "this contraction is chosen in such a way that for each order @xmath104 there is a depth @xmath144 such that around this depth the apparent wavelength corresponding to the order in play is contracted to a value close to @xmath145 .",
    "at that point of the pml , this order is perfectly absorbed thanks to the complex stretch .",
    "we thus eliminate first the orders with quasi normal diffracted angles at lowest depths up to grazing orders ( near wood s anomalies ) which are absorbed at greater depths . in mathematical words ,",
    "the translation of previous considerations on the real contraction can be expressed as : @xmath146}=\\exp{(-{i}k_0 y_d)}\\ ] ] the contraction @xmath143 is thus given by : @xmath147    the function @xmath143 has two poles , denoted @xmath148 . when @xmath149 with @xmath150 , @xmath151 , i.e.  we are on a wood s anomaly associated with the appearance / disappearance of the @xmath152 transmitted order .",
    "we now search for the nearest point to @xmath153 associated with a wood s anomaly , denoting :    @xmath154    in a second step , we seek the point @xmath155 such that :    @xmath156    to avoid the singular behaviour at @xmath157 , we continue the graph of the function @xmath134 by a straight line tangent at @xmath158 , which equation is @xmath159 , where @xmath160 is the so - called stretching coefficient .",
    "the final change of co - ordinate is then given by  : @xmath161    figure [ coef_stretch ] shows an example of this co - ordinate mapping .     used for the apml ( black solid line ) .",
    "the graph of @xmath134 ( blue solid line ) is continued by a straight line @xmath162 tangent at @xmath158 ( red dashed line ) to avoid the singular behaviour at @xmath163 . ]    eventually , the complex stretch @xmath164 used in eq .",
    "( [ tenspml ] ) is given by : @xmath165    equipped with this mathematical formulation , we can tailor a layer that is doubly perfectly matched :    * to a given medium , which is the aim of the pml technique , through eq .",
    "( [ equ_tranform ] ) , * to all diffraction orders , through the stretching coefficient @xmath164 , which depends on the characteristics of the incident wave and on opto - geometric parameters of the grating .",
    "we now apply the method described in the preceding parts to design an adapted bottom pml for the same example as in part [ example_pb_classical_pml ] .",
    "the parameters are the same , and we choose the wavelength of the incident plane wave close to the wood s anomaly related to the @xmath166 transmitted order ( @xmath167).moreover , we set the length of the pml @xmath168 and choose absorption coefficients @xmath169 .",
    "for both cases ( pml and apml ) , parameters are alike , the only difference being the complex stretch @xmath164 .    ,",
    "@xmath170 and @xmath171 for the dielectric slit grating at @xmath167 ( same parameters as in part [ example_pb_classical_pml ] ) .",
    "( a ) : classical pml with inefficient damping of @xmath172 in the bottom pml .",
    "( b ) : apml where the @xmath172 field is correctly damped in the bottom pml .",
    "for both cases the thickness of the pml is @xmath168 . ]     for the three propagating orders with adapted ( dashed lines ) and classical pmls ( solid lines ) .",
    "note that the classical pmls are efficient for all orders except for the grazing one ( @xmath173 ) as expected .",
    "this drawback is bypassed when using the adaptive pml . ]",
    "the field maps of the norm of @xmath172 , @xmath170 and @xmath171 are plotted in logarithmic scale on fig .",
    "[ comp_pmls ] , for the case of a classical pml and our apml .",
    "we can observe that the field @xmath172 that is effectively computed is clearly damped in the bottom apml ( leftmost on fig .",
    "[ comp_pmls](b ) ) whereas it is not in the standard case ( leftmost on fig .",
    "[ comp_pmls](a ) ) , causing spurious reflections on the outer boundary .",
    "the fields @xmath170 and @xmath171 are deduced from @xmath172 thanks to maxwell s equations .",
    "the high values of @xmath171 at the tip of the apml ( rightmost on fig .",
    "[ comp_pmls](b ) ) are due to very high values of the optical equivalent properties of the apml medium ( due to high values of @xmath164 ) , which does not affect the accuracy of the computed field within the domain of interest . + another feature of our approach is that it efficiently absorbs the grazing diffraction order , as illustrated on fig .",
    "[ behaviour_adapted_pml ] : the @xmath166 transmitted order does not decrease in the standard pml ( blue solid line ) , and reaches a high value at @xmath174 , whereas the same order tends to zero as @xmath175 in the case of the adapted pml ( blue dashed line ) . + to further validate the accuracy of the method , we compare the diffraction efficiencies computed by our fem formulation with pml and apml to those obtained by another method .",
    "we choose the rigorous coupled wave analysis ( rcwa ) , also known as the fourier modal method ( fmm , @xcite ) . for the chosen parameters , only the @xmath176^th^ order is propagative in reflexion and the orders @xmath177 , @xmath176 and @xmath166 are non evanescent in transmission .",
    "we can also check the energy balance @xmath178 since there is no lossy medium in our example .",
    "results are reported in table [ comp_pml_rcwa ] , and show a good agreement of the fem with apml with the results from rcwa . on the contrary , if classical pml are used , the diffraction efficiencies are less accurate compared to those computed with rcwa .",
    "checking the energy balance leads the same conclusions : the numerical result is perturbed by the reflection of the waves at the end of the pml if it is not adapted to the situation of nearly grazing diffracted orders .",
    "+    .diffraction efficiencies @xmath179 , @xmath180 , @xmath181 and @xmath182 of the four propagating orders , and energy balance @xmath178 , computed by three methods : rcwa ( line 1 ) , fem formulation with apml ( line 2 ) , fem formulation with classical pml ( line 3 ) . [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]      along the outer boundary of the bottom pml @xmath183 , for @xmath145 approaching the wood s anomaly @xmath184 by inferior values ( @xmath185 , red squares ) and by superior value ( @xmath186 , blue circles ) as a function of @xmath104 . ]    eventually , to illustrate the behaviour of the adaptive pml when the incident wavelength gets closer to a given wood s anomaly , we computed the mean value of the norm of @xmath172 along the outer boundary of the bottom pml @xmath183 , when @xmath186 and @xmath185 , for @xmath187 .",
    "the results are shown in fig .",
    "[ comp_pml_lambda ] .",
    "as the wavelength gets closer to @xmath184 , @xmath188 first increases but for @xmath189 , it decreases exponentially .",
    "however , in all cases , the value of @xmath188 remains small enough to ensure the efficiency of the pmls .",
    "in this paper , we have proposed an adaptive pml that can treat rigorously wood s anomalies in numerical analysis of diffraction gratings .",
    "it is based on a complex - valued co - ordinate stretching that deals with grazing diffracted orders , yielding an efficient absorption of the field inside the pml .",
    "we provided an example in the tm polarization case ( but similar results hold for the te case ) , illustrating the efficiency of our method .",
    "the value of the magnetic field on the outward boundary of the pml remains small enough to consider there is no spurious reflection .",
    "the formulation is used with the fem but can be applied to others numerical methods . moreover , the generalization to the vectorial three - dimensional case is straightforward : the recipes given in part [ part_stretch ] do work irrespective of the dimension and whether the problem is vectorial .",
    "in addition , although the designed co - ordinate stretching is specific to the context of wood s anomalies , one can adapt this kind of non uniform pml to others wave problems by following the methodology exposed here ."
  ],
  "abstract_text": [
    "<S> we propose an adaptive perfectly matched layer ( apml ) to be used in diffraction grating modeling . with a properly tailored co - ordinate stretching depending both on the incident field and on grating parameters , </S>",
    "<S> the apml may efficiently absorb diffracted orders near grazing angles ( the so - called wood s anomalies ) . </S>",
    "<S> the new design is implemented in a finite element method ( fem ) scheme and applied on a numerical example of a dielectric slit grating . </S>",
    "<S> its performances are compared with classical pml with constant stretching coefficient .    </S>",
    "<S> 10    j .- p . </S>",
    "<S> b ' erenger , `` a perfectly matched layer for the absorption of electromagnetic waves , '' journal of computational physics * 114 * , 185  200 ( 1994 ) .    </S>",
    "<S> m.  lassas , j.  liukkonen , and e.  somersalo , `` complex riemannian metric and absorbing boundary conditions , '' j. math . </S>",
    "<S> pure appl . * 80 * , 739  768 ( 2001 ) .    m.  lassas and e.  somersalo , </S>",
    "<S> `` analysis of the pml equations in general convex geometry , '' p. roy . </S>",
    "<S> soc . </S>",
    "<S> edinb . </S>",
    "<S> a * 131 * , 11831207 ( 2001 ) .    </S>",
    "<S> a.  nicolet , f.  zolla , y.  ould agha , and s.  guenneau , `` geometrical transformations and equivalent materials in computational electromagnetism , '' compel * 27 * , 806819 ( 2008 ) .    </S>",
    "<S> f.  zolla , g.  renversez , a.  nicolet , b.  kuhlmey , s.  guenneau , d.  felbacq , a.  argyros , and s.  leon - saval , _ foundations of photonic crystal fibres _ </S>",
    "<S> ( imperial college press , london , 2012 ) , 2nd ed .    </S>",
    "<S> r.  wood . </S>",
    "<S> , `` on a remarkable case of uneven distribution of light in a diffraction grating spectrum , '' p. phys . </S>",
    "<S> soc . </S>",
    "<S> lond . * 18 * , 269275 ( 1902 ) .    </S>",
    "<S> lord  rayleigh , `` note on the remarkable case of diffraction spectra described by prof . </S>",
    "<S> wood , '' philos . mag . * 14 * , 6065 ( 1907 ) .    </S>",
    "<S> z.  chen and x.  liu , `` an adaptive perfectly matched layer technique for time - harmonic scattering problems , '' siam j. numer . </S>",
    "<S> anal . * </S>",
    "<S> 43 * , 645671 ( 2005 ) .    </S>",
    "<S> g.  bao , z.  chen , and h.  wu , `` adaptive finite - element method for diffraction gratings , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 22 * , 11061114 ( 2005 ) .    </S>",
    "<S> a.  schdle , l.  zschiedrich , s.  burger , r.  klose , and f.  schmidt , `` domain decomposition method for maxwell s equations : scattering off periodic structures , '' j. comput </S>",
    "<S> . phys . * 226 * , 477  493 ( 2007 ) .    </S>",
    "<S> a.  sommerfeld , _ partial differential equations in physics _ </S>",
    "<S> ( academic press , new york , 1949 ) .    </S>",
    "<S> y.  ould  agha , a.  nicolet , f.  zolla and s.  guenneau , `` leaky modes in twisted microstructured optical fibres , '' wave random complex * 17 * , 559570 ( 2007 ) .    </S>",
    "<S> g.  demsy , f.  zolla , a.  nicolet , m.  commandr , and c.  fossati , `` the finite element method as applied to the diffraction by an anisotropic grating , '' opt . </S>",
    "<S> express * 15 * , 1808918102 ( 2007 ) .    </S>",
    "<S> g.  demsy , f.  zolla , a.  nicolet , and m.  commandr , `` versatile full - vectorial finite element model for crossed gratings , '' opt </S>",
    "<S> . lett . * 34 * , 22162218 ( 2009 ) .    </S>",
    "<S> a.  ern and j .- l .  </S>",
    "<S> guermond , `` theory and practice of finite elements , '' applied mathematical series * 159 * , ( springer , new york , 2004 ) .    </S>",
    "<S> l.  li , `` new formulation of the fourier modal method for crossed surface - relief gratings , '' j. opt . </S>",
    "<S> soc . </S>",
    "<S> am . </S>",
    "<S> a * 14 * , 27582767 , ( 1997 ) . </S>"
  ]
}