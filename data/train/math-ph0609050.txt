{
  "article_text": [
    "since random matrix theory ( rmt ) was introduced by wishart  @xcite in 1928 , it has found applications in a variety of areas of physics , pure and applied mathematics , probability , statistics and engineering .",
    "few examples  far from being exhaustive  include : analytic number theory , combinatorics , graph theory , multivariate statistics , nuclear physics , quantum chaos , quantum information , statistical mechanics , structural dynamics and wireless telecommunications .",
    "the main reasons for the ever growing success of rmt are mainly two .",
    "firstly , in the limit of large matrix dimension the statistical correlations of the spectra of a family , or ensemble , of matrices are independent of the probability distribution that defines the ensemble , but depend only on the invariant properties of such a distribution . as a consequence random matrices turn out to be very accurate models for a large number of mathematical and physical problems .",
    "secondly , rmt techniques allow analytical computations to an extent that is often impossible to achieve in the contexts that they are modelling . this predictive ability of rmt is particularly powerful whenever in the original problem there are not any natural parameters to average over .    although the advantage of using rmt lies in the possibility of computing explicit mathematical and physical quantities analytically , it is sometimes necessary to resort to numerical simulations .",
    "the purpose of this article is twofold .",
    "firstly , we provide the reader with a simple method for generating random matrices from the classical compact groups that most mathematicians  not necessarily familiar with computer programming   should be able to implement in a code of only few lines .",
    "this is achieved in section  [ corr_alg ] .",
    "secondly , we discuss in detail the main ideas , which turn out be fairly general and quite interesting , behind this algorithm .",
    "an @xmath3 unitary matrix @xmath4 is defined by the relation @xmath5 , which in terms of the matrix elements reads @xmath6 where @xmath7 is the conjugate transpose of @xmath8 , _",
    "i.e. _ @xmath9 . in this article",
    "we will use the symbol  @xmath10  to denote complex conjugation , in order to distinguish it from @xmath11 , which is reserved to the conjugate transpose of a matrix .",
    "the constraints   simply state that the columns ( rows ) of a unitary matrix form an orthonormal basis in @xmath12 .",
    "the set @xmath0 of unitary matrices forms a compact lie group whose real dimension is @xmath13 ; it is then made into a probability space by assigning as a distribution the unique measure invariant under group multiplication , known as _",
    "haar measure .",
    "_ such a probability space is often referred to as circular unitary ensemble ( cue ) .",
    "usually the correct ensemble to model a particular situation depends on the symmetries of the problem .",
    "ensembles of unitary matrices are constructed in two steps : we first identify a subset @xmath14 by imposing further restrictions on @xmath8 ; then we assign to @xmath15 a probability measure with the appropriate invariant properties . as well as @xmath0",
    ", we will discuss how to generate random matrices from the orthogonal @xmath1 and unitary symplectic @xmath2 groups with probability distributions given by the respective unique invariant measures .",
    "we shall also consider the two remaining @xmath16  @xcite , namely the circular orthogonal ensemble ( coe ) and circular symplectic ensemble ( cse ) .",
    "other symmetric spaces appear in the applications  @xcite , but we will not concern ourselves with them .    writing an algorithm to generate random unitary matrices which is both correct and numerically stable presents some pitfalls .",
    "the reason is that the conditions   imply that the matrix elements are not independent and thus are statistically correlated .",
    "the main ideas discussed in this article are centred around the qr decomposition and go back to wedderburn  @xcite , heiberger  @xcite ( corrected by tanner and thisted",
    "@xcite ) , stewart  @xcite and diaconis and shahshahani  @xcite .",
    "however , the technical literature may be difficult to access for a reader without a background in numerical analysis or statistics , while the implementation of such techniques is elementary .",
    "another method discussed in the literature involves an explicit representation of the matrix elements of @xmath8 in terms of @xmath13 independent parameters ( euler angles )  @xcite , but it does not seem to be equally efficient or convenient .",
    "before discussing how to generate random matrices it is helpful to give few examples that show how they appear in the applications .    in quantum mechanics",
    "all the information about an isolated physical system at a given time @xmath17 is contained in a state vector @xmath18 belonging to a hilbert space @xmath19  in general infinite dimensional .",
    "the time evolution of @xmath18 , _",
    "i.e. _ its dynamics , is determined by a unitary operator @xmath8 . in other words , at a time @xmath20 , @xmath18 has evolved into @xmath21 the fact that @xmath8 is unitary guarantees that @xmath22 , which is required by the probabilistic interpretation of quantum mechanics .",
    "if the dynamics is complicated  as in heavy nuclei or in quantum systems whose classical limits are characterized by a chaotic dynamics  writing down an explicit expression for @xmath8 may be hopeless .",
    "therefore , we can attempt to replace @xmath8 by a random operator and check if the predictions that we obtain are consistent with the empirical observations .",
    "it is also reasonable to simplify the problem even further and replace @xmath8 by a random unitary matrix of finite , but large , dimension .",
    "then the main question is : what are the matrix space and the probability distribution that best model our system ?    in physics the symmetries of a problem",
    "are often known a priori , even if the details of the dynamics remain obscure . now",
    ", suppose that our system is invariant under time reversal but does not have any other symmetry . from general considerations ( see mehta  @xcite p. 36 ) we know that @xmath8 is always conjugate by a unitary transformation to a symmetric matrix . therefore , we can always choose @xmath8 so that @xmath23 where @xmath24 denotes the transpose of @xmath8 .",
    "since there are not other symmetries in the problem , this is the only constraint that we can impose .",
    "therefore , the appropriate matrices that model this physical system should be symmetric .",
    "let us denote by @xmath25 the set of unitary symmeytric matrices .",
    "if @xmath26 it can be proved ( see meta  @xcite p. 499 ) that it admits the representation @xmath27 this factorization is not unique .",
    "let @xmath1 be the group of real matrices @xmath28 such that @xmath29 and set @xmath30 . by definition we have @xmath31 this statement is true also in the opposite direction : if @xmath32 there exists an @xmath33 such that @xmath34 .",
    "therefore , @xmath25 is isomorphic to the left coset space of @xmath1 in @xmath0 , _",
    "@xmath35    since a measure space with total mass equal to one is a probability space , in what follows we shall use the two terminologies interchangeably .",
    "an ensemble of random matrices is defined by a matrix space and a probability measure on it .",
    "we have found the former ; we are left to identify the latter .",
    "haar measure , which will be discussed in detail in section  [ haar_m ] , provides a natural probability distribution on @xmath0 ; ` natural ' in the sense that it equally weighs different regions of @xmath0 , thus it behaves like a uniform distribution . from the factorization",
    "the probability distribution on @xmath0 induces a measure on @xmath25 . as a consequence , if @xmath36 is haar distributed the resulting measure on @xmath25 will be uniform too . in section  [ gtheo ]",
    "we shall see that such a measure is the unique probability distribution induced by haar measure on @xmath25 .",
    "therefore , it provides a natural choice to model a time reversal invariant quantum system .",
    "the space @xmath25 together with this measure is the coe ensemble .",
    "if a quantum system does not have any symmetry , then there are no restriction to @xmath0 and the natural choice of probability distribution is haar measure .",
    "this is the cue ensemble .",
    "if the system is invariant under time reversal and has a half - integer spin , then the appropriate ensemble is the cse .",
    "the matrix space of the cse is the subset @xmath37 whose elements admit the representation @xmath38 where @xmath39 from the factorization   the probability distribution on @xmath40 induces a measure on @xmath41 . as previously ,",
    "such a measure is fixed by assigning haar measure to @xmath40 .",
    "the set @xmath41 is isomorphic to a coset space too .",
    "the unitary symplectic group @xmath2 is the subgroup of @xmath40 whose elements obey the relation @xmath42 therefore , the matrix @xmath8 in equation   does not change if we replace @xmath36 with @xmath43 , where @xmath44 . similarly , if @xmath36 and @xmath45 are such that @xmath46 then @xmath47 .",
    "therefore , @xmath48 the probability distribution of the cse is the unique invariant measure induced on the coset space   by haar measure on @xmath40 .    from equations   and",
    "all we need to generate random matrices in the cue , coe and cse ensembles is an algorithm whose output is haar distributed unitary matrices .",
    "the rest of this article will concentrate on generating random matrices from all three classical compact groups @xmath0 , @xmath1 and @xmath2 with probability distributions given by the respective haar measures .",
    "these groups are not only functional to constructing matrices in the coe and cse , but are also important ensembles in their own right . indeed , the work of montgomery  @xcite , odlyzko  @xcite , katz and sarnak  @xcite , keating and snaith  @xcite and rubinstein  @xcite has shown beyond doubt that the local statistical properties of the the riemann zeta function and other _",
    "l_-functions can be modelled by the characteristic polynomials of haar distributed random matrices . over the last few years",
    "the predictive power of this approach has brought about an impressive progress in analytic number theory that could not have been achieved with traditional techniques .",
    "( see  @xcite for a collection of review articles in the subject . )",
    "since the algorithm the we shall discuss is essentially based on the invariant properties of haar measure , in this section we introduce the main concepts that are needed to understand how it works . we , nevertheless , begin with another ensemble : _ the ginibre ensemble . _ besides being a simpler illustration of the ideas we need , generating a matrix in the ginibre ensemble is the first step toward producing a random unitary matrix .",
    "the space of matrices for the ginibre ensemble is @xmath49 , the set of all the invertible @xmath50 complex matrices @xmath51 ; the matrix elements are independent identically distributed ( _ i.i.d .",
    "_ ) standard normal complex random variables . in other words ,",
    "the probability density function ( _ p.d.f . _ ) of @xmath52 is @xmath53 by definition the matrix entries are statistically independent , therefore the joint probability density function ( _ j.p.d.f .",
    "_ ) for the matrix elements is @xmath54 since @xmath55 is a probability density , it is normalized to one , _",
    "i.e. _ @xmath56 where @xmath57 and @xmath58 .",
    "the _ j.p.d.f .",
    "_ @xmath55 contains all the statistical information on the ginibre ensemble .",
    "since @xmath59 , we will use the two notations according to what is more appropriate for the context .",
    "thus , we can write @xmath60 and think of @xmath61 as an infinitesimal volume or measure in @xmath62 .",
    "if @xmath63 , we say that @xmath64 is invariant under @xmath65 if @xmath66    [ glinv ] the measure of the ginibre ensemble is invariant under left and right multiplication of @xmath67 by arbitrary unitary matrices , i.e. @xmath68    first we need to show that @xmath69 ; then we must prove that the jacobian of the map @xmath70 ( seen as a transformation in @xmath62 ) is one .",
    "since by definition @xmath71 , we have @xmath72 now , the map   is isomorphic to @xmath73 it follows immediately that @xmath74 is a @xmath75 unitary matrix , therefore @xmath76 .",
    "the proof of right invariance is identical .    because the elements of a unitary matrix are not independent , writing an explicit formula for the infinitesimal volume element of @xmath0 is more complicated than for the ginibre ensemble .",
    "an @xmath77 unitary matrix contains @xmath78 real numbers and the constraints   form a system of @xmath13 real equations .",
    "therefore , @xmath0 is isomorphic to a @xmath13-dimensional manifold embedded in @xmath79 .",
    "such a manifold is compact and has a natural group structure that comes from matrix multiplication .",
    "thus , an infinitesimal volume element on @xmath0 will have the form @xmath80 where @xmath81 are local coordinates on @xmath0 .",
    "every compact lie group has a unique ( up to an arbitrary constant ) left and right invariant measure , known as _",
    "haar measure .",
    "_ in other words , if we denote haar measure on @xmath0 by @xmath82 , we have @xmath83 although an explicit expression for haar measure on @xmath0 in terms of local coordinates can be written down ( see yczkowski and kus  @xcite for a formula ) , we will see that in order to generate matrices distributed with haar measure we only need to know that is invariant and unique .",
    "haar measure normalized to one is a natural choice for a probability measure on a compact group because , being invariant under group multiplication , any region of @xmath0 carries the same weight in a group average .",
    "it is the analogue of the uniform density on a finite interval . in order to understand this point",
    "consider the simplest example : @xmath84 .",
    "it is the set @xmath85 of the complex numbers with modulo one , therefore it has the topology of the unit circle @xmath86 . since in this case matrix multiplication",
    "is simply addition @xmath87 , @xmath84 is isomorphic to the group of translations on @xmath86 . a probability density function that equally weighs",
    "any part of the unit circle is the constant density @xmath88 .",
    "this is the standard lebesgue measure , which is invariant under translations .",
    "therefore , it is the unique haar measure on @xmath84 .",
    "note that it is not possible to define an ` unbiased ' measure on a non - compact manifold .",
    "for example , we can provide a finite interval with a constant _ p.d.f .",
    "_ @xmath89 , but not the whole real line @xmath90 , since the integral @xmath91 would diverge .",
    "by definition the columns of a @xmath3 unitary matrix are orthonormal vectors in @xmath12 . thus",
    ", if we take an arbitrary complex @xmath92 matrix @xmath67 of full rank and apply the gram - schmidt orthonormalization to its columns , the resulting matrix @xmath93 is unitary .",
    "it turns out that if the entries of @xmath67 ares _ i.i.d .",
    "_ standard complex normal random variables , _",
    "i.e. _ if @xmath67 belongs to the ginibre ensemble , then @xmath93 is distributed with haar measure ( see eaton  @xcite , p. 234",
    ", for a proof ) . unfortunately , the implementation of this algorithm is numerically unstable .",
    "however , we may observe that @xmath94 where @xmath95 is upper - triangular and invertible .",
    "in other words , the gram - schmidt algorithm realizes the _ qr decomposition .",
    "_ this factorization is widely used in numerical analysis to solve linear least squares problems and as first step of a particular eigenvalue algorithm .",
    "indeed , every linear algebra package has a routine that implements it . in most cases ,",
    "however , the algorithm adopted is not the gram - schmidt orthonormalization but uses the _ householder reflections _",
    ", which are numerically stable .",
    "because of this simple observation , at first one might be tempted to produce a matrix in the ginibre ensemble and then to use a black box qr decomposition routine .",
    "writing such a code is straightforward .",
    "for example , if we choose the scipy library in python , we may implement the following function :    = ` from ` = ` scipy import * ` + ` def wrong``_``distribution(n ) : ` + `    a random matrix with the wrong distribution    ` + ` z = ( randn(n , n ) + 1j*randn(n , n))/sqrt(2.0 ) ` + ` q , r = linalg.qr(z ) ` + ` return q ` +    unfortunately , the output is not distributed with haar measure , as it was observed by edelman and rao  @xcite .",
    "it is instructive to give an explicit example of this phenomenon .",
    "a unitary matrix can always be diagonalized in @xmath0 . therefore ,",
    "its eigenvalues @xmath96 lie on the unit circle .",
    "a classical calculation in rmt ( see mehta  @xcite pp .",
    "203205 ) consists of computing the statistical correlations among the arguments @xmath97 .",
    "the simplest correlation function to determine is the density of the eigenvalues @xmath98 , or  as sometimes it is called  the one - point correlation .",
    "since haar measure is the analogue of a uniform distribution , each set of eigenvalues must have the same weight , therefore the normalized eigenvalue density is @xmath99 it is important to point out that equation   does not mean that the eigenvalues are statistically uncorrelated .",
    "testing   numerically is very simple .",
    "we generated @xmath100 random unitary matrices using ` wrong``_``distribution(n ) ` .",
    "the density of the eigenvalues of such matrices is clearly not constant ( figure  1(a ) ) .",
    "figure  1(b ) shows the histogram of the spacing distribution , which deviates from the theoretical prediction too .",
    "this statistics is often plotted because it encodes the knowledge of all the spectral correlations and is easy to determine empirically . for unitary matrices",
    "it is defined as follows .",
    "take the arguments of the eigenvalues and order them in ascending order : @xmath101 the normalised distances , or spacings , between consecutive eigenvalues are @xmath102 the spacing distribution @xmath103 is the probability density of @xmath104 .",
    "( for a discussion on the spacing distribution see mehta  @xcite p.  118 . )",
    "it is worth emphasising the qr decomposition is a standard routine .",
    "the most commonly known mathematical software packages like matlab , mathematica , maple , scipy for python essentially use a combination of algorithms found in lapack routines .",
    "changing software would not alter the outcome of this numerical experiment .",
    "[ fig2a ]    .",
    "what is wrong with standard qr factorization routines ? where do they differ from the gram - schmidt orthonormalization ?",
    "why is the probability distribution of the output matrix not haar measure ?",
    "the main problem is that qr decomposition is not unique .",
    "indeed , let @xmath105 and suppose that @xmath106 , where @xmath93 is unitary and @xmath95 is invertible and upper - triangular . if @xmath107 then @xmath108 are still unitary and upper - triangular respectively .",
    "furthermore , @xmath109 therefore , the qr decomposition defines a multi - valued map @xmath110 where @xmath111 denotes the group of invertible upper - triangular matrices .    in order to make the mapping",
    "single - valued , we need to specify the algorithm that achieves the factorization . in most applications such",
    "a choice is dictated only by the performance and stability of the code .",
    "for our purposes , however , the subset of @xmath112 , in which the output of the qr decomposition is chosen , is fundamental and we need to pay particular attention to it .",
    "it is convenient from a mathematical point of view to introduce a variation of the mapping  , which is not only single - valued but also one - to - one . in this way",
    "we will not have to refer all the times to a specific algorithm .",
    "indeed , the idea is that we should be able to alter the output of a qr decomposition routine without even knowing the algorithm implemented .",
    "we first need    equation   implies  , where @xmath113 and @xmath114 denotes the group of all unitary diagonal matrices  .",
    "equation   can be rearranged as @xmath115 since @xmath0 and @xmath111 are groups , both sides of equations   must belong to @xmath116 . by definition",
    "the inverse of a unitary matrix @xmath8 is its conjugate transpose and the inverse of an upper - triangular matrix is upper - triangular .",
    "therefore , if a matrix is both unitary and upper - triangular it must be diagonal , _ i.e. _ @xmath117 .",
    "this lemma suggests that , more naturally , instead of the qr factorization   we should consider a one - to - one map @xmath118 where @xmath119 is the right coset space of @xmath114 in @xmath111 .",
    "we construct   as follows : we first define it on a class of representatives of @xmath120 using the qr factorization ; then we extend it to the whole @xmath120 .",
    "however , since the qr decomposition is not unique , there is a certain degree of arbitrariness in this definition .",
    "we need to find a map under which the measure of the ginibre ensemble induces haar measure on @xmath0 .",
    "the main tool to achieve this goal is the invariance under group multiplication of haar measure and its uniqueness .",
    "thus , our choice of the decomposition   must be such that if @xmath121 with the _ same _ @xmath122 and for _ any _ @xmath123 .",
    "this property implies that left multiplication of @xmath67 by a unitary matrix reduces , after the decomposition , to the left action of @xmath0 into itself .",
    "but lemma  [ glinv ] states that @xmath124 for any @xmath125 . as a consequence ,",
    "if the map   satisfies   the induced measure on @xmath0 will be invariant under left multiplication too and therefore must be haar measure .    how do we construct the map  ?",
    "a class of representatives of @xmath126 can be chosen by fixing the arguments of the elements of the main diagonal of @xmath127 .",
    "let us impose that such elements all be real and strictly positive .",
    "using   we can uniquely factorize any @xmath105 so that the main diagonal of @xmath95 has this property .",
    "it follows that if @xmath106 , then @xmath128 this qr decomposition of @xmath129 is unique within the chosen class of representatives of @xmath120 .",
    "therefore , the resulting map   obeys  .",
    "finally , we arrive at    [ salv - th ] suppose that the map   satisfies the hypothesis  .",
    "then , it decomposes the measure   of the ginibre ensemble as @xmath130    we have    @xmath131    the choice of the class of representatives that we made coincides exactly with outcome of the gram - schmidt orthonormalization . the output of standard qr decomposition routines are such that if @xmath132 then @xmath133 with @xmath134 and @xmath135 .",
    "therefore , the corresponding map   does not obey   and theorem  [ salv - th ] does not hold .",
    "we can now give a recipe to create a random unitary matrix with distribution given by haar measure .    1 .",
    "take an @xmath3 complex matrix @xmath67 whose entries are complex standard normal random variables .",
    "feed @xmath67 into _ any _ qr decomposition routine .",
    "let @xmath136 , where @xmath137 , be the output .",
    "3 .   create the following diagonal matrix @xmath138 where the @xmath139 are the diagonal elements of @xmath95 .",
    "the diagonal elements of @xmath140 are _ always _ real and strictly positive , therefore the matrix @xmath141 is distributed with haar measure .",
    "the corresponding python function is :    = ` from ` = ` scipy import * ` + ` def haar``_``measure(n ) : ` + `    a random matrix distributed with haar measure    ` + ` z",
    "= ( randn(n , n ) + 1j*randn(n , n))/sqrt(2.0 ) ` + ` q , r = linalg.qr(z ) ` + ` d = diagonal(r ) ` + ` ph = d / absolute(d ) ` + ` q = multiply(q , ph , q ) ` + ` return q `    if we repeat the numerical experiment discussed in section  [ qrfact ] using this routine , we obtain the histograms in figure  2 , which are consistent with the theoretical predictions .",
    "up to now we have only considered @xmath0 .",
    "the discussion for @xmath1 is identical , except that the input matrix of the qr decomposition routine must be real .",
    "unfortunately , however , for @xmath2 there are not any black box routines that we can use and we must put more effort into writing an algorithm .",
    "the algebra of unitary symplectic matrices can be rephrased in terms of hamilton s quaternions ; it is convenient for our purposes to use this formalism .",
    "a quaternion @xmath142 is a linear combination @xmath143 where @xmath144 is the identity and @xmath145 , @xmath146 , @xmath147 are the quaternion units ; they obey the algebra @xmath148 we can also define the conjugate of @xmath149 , @xmath150 as well the norm @xmath151 when @xmath152 , @xmath153 reduces to @xmath154 and @xmath155 is simply the complex conjugate of @xmath149 .    in analogy with @xmath156 and @xmath12  provided we are careful with the fact that multiplication in @xmath153 is not commutative  we can study the space @xmath157 .",
    "elements in @xmath157 are @xmath158-tuples @xmath159 . the bilinear map @xmath160 is the analogue of the usual hermitian inner product in @xmath12 and the norm of a quaternion vector is simply @xmath161 similarly , @xmath162 is the group of all the @xmath92 invertible matrices with quaternion elements .",
    "the quaternion units admit a representation in terms of the @xmath163 matrices    @xmath164    where @xmath165",
    "thus , @xmath166 is mapped into the complex matrix    [ elm ] @xmath167 where @xmath168 and @xmath169 . in addition @xmath170    equations",
    "generalize to an arbitrary @xmath3 quaternion matrix @xmath171 , which can be represented in terms of a @xmath172 complex matrix @xmath93 using the decomposition @xmath173 where @xmath174 , @xmath175 , @xmath176 and @xmath177 are arbitrary @xmath3 _ real _ matrices .",
    "proceeding in the same fashion , if @xmath178 we define its conjugate transpose @xmath179 by setting @xmath180 .",
    "the symplectic group @xmath181 is the subset of @xmath162 whose matrices satisfy the identity @xmath182 .",
    "because of the analogy between @xmath0 and @xmath181 , the latter is sometimes called _ hyper - unitary group _ and is denoted by @xmath183 .",
    "the usefulness of the quaternion algebra lies in    [ symp_is ] the groups @xmath181 and @xmath2 are isomorphic , i.e. @xmath184    it is convenient to replace the skew - symmetric matrix @xmath185 in the definition   with @xmath186 this substitution is equivalent to a permutation of the rows and columns of @xmath185 , therefore it is simply a conjugation by a unitary matrix .",
    "we first prove that if @xmath187 , then its complex representation @xmath188 belongs to @xmath2 . by equation   @xmath189",
    "is mapped to @xmath190 which follows from the identities @xmath191 and from the algebra   of the quaternion units . as a consequence ,",
    "@xmath192 therefore , the matrix @xmath188 is symplectic .",
    "combining equations   and   gives @xmath193 thus @xmath44 .",
    "we now need to show that if @xmath44 then it is the representation of a matrix @xmath187 .",
    "this statement follows if we prove that @xmath188 admits a decomposition of the form  , where @xmath194 , @xmath195 , @xmath196 and @xmath197 @xmath77 must be _ real _ matrices . if this is true , then the argument of the first part of the proof",
    "can simply be reversed .",
    "let us allow the coefficients @xmath198 , @xmath199 , @xmath200 and @xmath201 in the definition   to be complex numbers .",
    "the definitions of conjugate quaternion   and conjugate transpose of a quaternion matrix , however , remain the same . the matrices   form a basis in @xmath202 .",
    "therefore , any @xmath203 complex matrix can be represented as a linear combination of @xmath204 , @xmath205 , @xmath206 and @xmath207 .",
    "thus , any matrix @xmath208 admits a decomposition of the form  , but now the matrices @xmath174 , @xmath175 , @xmath176 and @xmath177 are allowed to be complex . in other words",
    ", @xmath93 is always the representation of a quaternion matrix @xmath171 , but in general the quaternion units have complex coefficients . the important fact that we need to pay attention to",
    "is that @xmath209 if and only if the coefficients of the quaternion units are real numbers .",
    "this is a straightforward consequence of the representation  .",
    "let @xmath44 be the complex representation of the quaternion matrix @xmath210 , but assume that @xmath189 is not mapped into @xmath211 .",
    "it is still true , however , that @xmath212 because equation   is only a consequence of matrix manipulations .",
    "but since @xmath188 is unitary symplectic @xmath213 , which is a contradiction .",
    "the algebra of @xmath181 is the generalization to hamilton s quaternions of the algebra of @xmath0 .",
    "therefore , it is not surprising that the discussion of section  [ corr_alg ] is not affected by replacing @xmath49 and @xmath0 with @xmath162 and @xmath181 respectively .",
    "thus , since @xmath181 and @xmath2 are isomorphic , @xmath2 and @xmath181 have the same haar measure @xmath214 .",
    "in particular , we can introduce the quaternion ginibre ensemble , which is the set @xmath162 equipped with the probability density @xmath215    quaternion matrices can be factorized by the qr decomposition too : for any @xmath216 we can always write @xmath217 where @xmath218 and @xmath219 is an invertible and upper - triangular quaternion matrix",
    ". now , let @xmath220 where @xmath221 is the group of invertible upper - triangular quaternion matrices .",
    "furthermore , let @xmath222 be the right coset space of @xmath223 in @xmath221 .",
    "we have the following    [ qrfacth2 ] there exists a one - to - one map @xmath224 such that @xmath225 where @xmath226 .",
    "furthermore , it factorizes the measure @xmath61 of the ginibre ensemble as @xmath227    we leave proving these generalizations as an exercise for the reader .",
    "theorem  [ qrfacth2 ] provides us with the theoretical tools to generate a random matrix in @xmath2 .",
    "however , when we implement these results in computer code , we need to devise an algorithm whose output satisfies the condition  .",
    "the first one that comes to one s mind is the gram - schmidt orthonormalization . but",
    "given that black box routines for quaternion matrices do not exists on the market , and that we are forced to write the complete code ourselves , we may as well choose one that is numerically stable and which , as it turns out , requires the same effort . the most common algorithm that achieves the qr decomposition uses the _ householder reflections .",
    "_ for the sake of clarity , we will discuss this method for @xmath1 ; the generalizations to @xmath0 and @xmath181 are straightforward .    given an arbitrary vector @xmath228 , the main idea of the householder reflections is to construct a simple orthogonal transformation @xmath229 ( dependent on @xmath230 ) such that @xmath231 where @xmath232 . for any real matrix @xmath233 ,",
    "@xmath234 is determined by replacing @xmath230 in equation   with the first column of @xmath74 .",
    "the product @xmath235 will have the structure @xmath236 where @xmath237 then , define the matrix @xmath238 where @xmath239 in this case @xmath240 is the @xmath241-dimensional vector obtained by dropping the first element of the second column of the matrix  .",
    "we proceed in this fashion until the matrix @xmath242 is upper - triangular with diagonal entries @xmath243 .",
    "the product @xmath244 is by construction an orthogonal matrix . in equations   and   @xmath245",
    "denotes the block matrix @xmath246 where @xmath229 is defined in equation  .",
    "the matrix @xmath229 is constructed using elementary geometry .",
    "consider a vector in the plane , @xmath247 , and assume , for simplicity , that @xmath248 .",
    "furthermore , let @xmath249 denote the unit vector along the interior bisector of the angle @xmath250 that @xmath230 makes with the @xmath251-axis , _",
    "i.e. _ @xmath252 where @xmath253 is the unit vector along the @xmath251-axis .",
    "the reflection of @xmath230 along the direction of @xmath249 is @xmath254 ( see figure  3 ) .",
    "householder_ref ( 80,2)@xmath251 ( 3,68)@xmath255 ( 21,14)@xmath250 ( 16,31)@xmath230 ( 30,2)@xmath254 ( 65,44)@xmath256    reflections are distance - preserving linear transformations , therefore their representations in an orthonormal basis are orthogonal matrices . in this simple example",
    "it can be constructed from elementary linear algebra : @xmath257 finally , we obtain @xmath258 it is worth noting that @xmath259 depends only on the direction of @xmath230 and not on its modulus .",
    "thus we can rewrite equation   as @xmath260 where @xmath261 .",
    "the generalization to arbitrary dimensions is straightforward . for any vector @xmath262 ,",
    "the householder reflection is defined as @xmath263 where @xmath264 furthermore , we have @xmath265    how do we choose the sign in the right - hand side of equation  ?",
    "from a mathematical point of view such a choice is irrelevant : in both cases @xmath266 maps @xmath230 into a vector whose only component different from zero is the first one .",
    "however , numerically it can be important .",
    "the square of the denominator in   is @xmath267 where @xmath251 is the first component of @xmath230 .",
    "if @xmath251 is comparable in magnitude to @xmath268 and negative ( positive ) and we choose the plus ( minus ) sign , then the term @xmath269 could very small and cancellations with significant round - off errors may occur .",
    "therefore , the householder transformation to be implemented in computer code should be @xmath270 where @xmath271    the additional factor of @xmath272 in the right - hand side of equation   assures that there is no ambiguity in the sign of the right - hand side of equation  . in turn",
    ", it guarantees that all the diagonal elements of the upper - triangular matrix @xmath95 are positive .",
    "this is not the definition of householder reflection used in standard qr decomposition routines .",
    "usually , @xmath273 with the same @xmath256 as in  . therefore , @xmath274 as a consequence , the signs of the diagonal elements of @xmath95 are random .",
    "this is the reason why the output of black box qr decomposition routines must be modified in order to obtain orthogonal matrices with the correct distribution .",
    "besides being numerically stable , this algorithm has another advantage with respect to the gram - schmidt orthonormalization . in most applications of numerical analysis",
    "@xmath93 need not be computed explicitly , only @xmath275 does , where @xmath276 is a specific vector .",
    "generating all the householder reflections is an @xmath277 process and computing @xmath278 requires @xmath279 operations  it just evaluates the scalar product @xmath280 . successively multiplying @xmath281 into @xmath276",
    "is an @xmath277 process .",
    "therefore , it takes in total @xmath277 operations to compute @xmath275 .",
    "instead , the gram - schmidt orthonormalization is an @xmath282 process .",
    "however , if @xmath93 is explicitly needed computing the product   requires @xmath282 operations too .",
    "the generalizations to @xmath0 and @xmath181 are straightforward .",
    "the only differences are in the definitions of the householder reflections .",
    "a suitable choice for @xmath0 is @xmath283 the unit vector @xmath249 is @xmath284 where @xmath285 and @xmath286 .",
    "the matrix @xmath266 is unitary and @xmath287 note that the introduction of @xmath288 in equations   and   takes into account both the potential cancellations and the correct values of the arguments of the diagonal elements of the upper - triangular matrix @xmath95 : equation   implies that all the @xmath289s are real and strictly positive .    for @xmath181 we have @xmath290 with @xmath291 where @xmath292 and @xmath293 .",
    "also in this case @xmath294",
    "we now know how to generate random matrices from any of the classical compact groups @xmath0 , @xmath1 and @xmath181 .",
    "in order to achieve this goal , we have used little more than linear algebra .",
    "however simple and convenient this approach is ( after all linear algebra plays a major role in writing most numerical algorithms ) , it hides a natural group theoretical structure behind the householder reflections , which was uncovered by diaconis and shahshahani  @xcite . indeed , generating a random matrix as a product of householder reflections",
    "is only one example of a more general method that can be applied to any finite or compact lie group .",
    "our purpose in this section is to give a flavour of this perspective .",
    "for the sake of clarity , as before , we will discuss the orthogonal group @xmath1 ; the treatment of @xmath0 and @xmath181 is , once again , almost identical .",
    "the need of a more general and elegant approach arises also if one observes that there is one feature of the qr decomposition that may not be entirely satisfactory to a pure mathematician : why in order to generate a random point on a @xmath295-dimensional manifold  @xmath1 in this case  do we need to generate @xmath13 random numbers",
    "? it does not look like the most efficient option , even if it is a luxury that can be easily afforded on today s computers .",
    "we will first show how the key ideas that we want to describe apply to finite groups , as in this setting they are more transparent .",
    "suppose that we need to generate a random element @xmath296 in a finite group @xmath297 . in this context",
    ", if @xmath297 has @xmath298 elements , uniform distribution simply means that the probability of extracting any @xmath299 is @xmath300 .",
    "in addition , we assume that there exists a chain of subgroups of @xmath297 : @xmath301 in practical situations it is often easier to generate a random element @xmath302 in a smaller subgroup , say @xmath303 , than in @xmath297 itself ; we may also know how to take a random representative @xmath304 in the left coset @xmath305 .",
    "now , write the decomposition @xmath306 once we have chosen a set of representatives of @xmath307 , an element @xmath308 is uniquely factorized as @xmath309 , where @xmath310 .",
    "if both @xmath304 and @xmath302 are uniformly distributed in @xmath307 and @xmath311 respectively , then @xmath296 is uniformly distribute in @xmath312 .",
    "we can apply this algorithm iteratively starting from @xmath313 and eventually generate a random element in @xmath297 .",
    "in other words , we are given the decomposition @xmath314 an element @xmath315 has a unique representation as a product @xmath316 where @xmath304 is a representative in @xmath307 . if the @xmath304s are uniformly distributed in @xmath307 so is @xmath296 in @xmath297 .",
    "this is known as the _ subgroup algorithm _",
    "@xcite .",
    "this technique applies to random permutations of @xmath158 letters .",
    "the chains of subgroups is @xmath317 where @xmath318 is the @xmath319-th symmetric group .",
    "other examples include generating random positions of rubik s cube and random elements in @xmath320 , where @xmath321 is a finite field with @xmath298 elements .    for @xmath1 the decompositions   and",
    "are hidden behind the factorization   in terms of householder reflections .",
    "indeed , the subgroup algorithm for @xmath1 is contained in    [ hpr ] let @xmath322 be uniformly distributed on @xmath323 respectively , where @xmath324 is the unit sphere in @xmath325 .",
    "furthermore , let @xmath266 be the @xmath319-th householder reflection defined in equation  .",
    "the product @xmath326 is a random orthogonal matrix with distribution given by haar measure on @xmath1 .",
    "suppose we construct @xmath327 distributed with haar measure by factorizing a matrix @xmath74 in the ginibre ensemble as described in section  [ h_r ] .",
    "the random matrix @xmath28 is the product of householder reflections   and each factor @xmath328 is a function of the unit vector @xmath329 only .",
    "we need to show that such @xmath330s are independent and uniformly distributed in @xmath331 for @xmath332 .    at each step in the construction of the upper - triangular matrix  , the matrix multiplied by the @xmath319-th householder reflection , _",
    "i.e. _ @xmath333 is still in the ginibre ensemble .",
    "all its elements are , therefore , _",
    "i.i.d . _ normal random variables .",
    "this is a consequence of the invariance @xmath334 of the measure of the ginibre ensemble .",
    "now , @xmath335 is constructed by taking the @xmath319-th dimensional vector @xmath336 obtained by dropping the first @xmath337 elements of the @xmath338-th column of @xmath339 .",
    "the components of @xmath336 are _ i.i.d . _",
    "normal random variables .",
    "it follows that the p.d.f .",
    "of @xmath336 is @xmath340 since @xmath341 depends only on the length of @xmath336 , and not on any angular variable , the unit vector @xmath342 is uniformly distributed in @xmath331 , and is statistically independent of @xmath343 for @xmath344 .",
    "theorem  [ hpr ] is more transparent than relying on the qr decomposition , which seems only a clever technical trick . if nothing else , the counting of the number of degrees of freedom matches .",
    "in fact , the dimension of the unit sphere @xmath331 is @xmath345 .",
    "thus , the total number of independent real parameters is @xmath346    why is theorem  [ hpr ] the subgroup algorithm for @xmath1 ? as we shall see in theorem  [ quotient ] , the factorization   is unique  provided that we restrict to the definition   of the householder reflections .",
    "this means that @xmath347 where @xmath348 if we proceed by induction , we obtain @xmath349 therefore , a matrix @xmath33 admits a unique representation as @xmath350 where @xmath351 and @xmath352 .",
    "a consequence of theorem  [ hpr ] is that if @xmath353 is uniformly distributed in @xmath354 and @xmath355 is distributed with haar measure on @xmath356 , then @xmath28 is haar distributed too .",
    "the final link with the subgroup algorithm is given by    [ quotient ] the left coset space of @xmath356 in @xmath357 is isomorphic to @xmath354 , i.e. @xmath358 a complete class of representatives is provided by the map  . indeed",
    ", it can be proved that there is no continuous choice of coset representatives . in section  [ h_r ]",
    "this distinction was superfluous : if @xmath230 is randomly generated , the probability that @xmath359 is zero . ] @xmath360 , @xmath361 where @xmath362 and @xmath251 is the first component of @xmath363 .",
    "the group of @xmath3 matrices @xmath364 defined in equation   is isomorphic to @xmath356 . since @xmath365 @xmath356 can be identified with the subgroup of @xmath1 that leave @xmath253 invariant , _",
    "i.e. _ @xmath366 now , if two matrices @xmath28 and @xmath367 belong to the same coset , then @xmath368 and vice versa . in other words ,",
    "cosets are specified by where @xmath253 is mapped . furthermore , since @xmath369 , we see that they can be identified with the points in the unit sphere . finally , the map   is one - to - one and is such that @xmath370 therefore , @xmath234 spans a complete class of representatives",
    ".    incidentally , theorem  [ hpr ] implies    [ fac_mc ] let @xmath371 and @xmath372 be the haar measures on @xmath1 and @xmath356 respectively .",
    "then @xmath373 where @xmath374 is the uniform measure on @xmath354 .",
    "what is the meaning of @xmath374 ?",
    "given that we are dealing with uniform random variables , it is quite natural that we end up with the uniform measure .",
    "in this case , however , it has a precise group theoretical interpretation .",
    "left multiplication of the right - hand side of equation   by @xmath375 induces a map on the coset space : @xmath376 since the decomposition   is unique the transformation @xmath377 is well defined .",
    "this map can be easily determined .",
    "a coset is specified by where @xmath253 is mapped , therefore @xmath378 if @xmath363 is uniformly distributed on the unit circle so is @xmath379 .",
    "thus , @xmath374 is the unique measure on the coset space @xmath380 invariant under the left action of @xmath1 .",
    "its uniqueness follows from that of haar measure and from the factorization  .",
    "corollary  [ fac_mc ] is a particular case of a theorem that holds under general hypotheses for topological compact groups .",
    "indeed , let @xmath381 be such a group , @xmath382 a closed subgroup and @xmath383 .",
    "furthermore , let @xmath384 , @xmath385 and @xmath386 be the respective invariant measures , then @xmath387",
    "this article stems from a lecture that i gave at the summer school on number theory and random matrix theory held at the university of rochester in june 2006 .",
    "i would like to the thank the organisers david farmer , steve gonek and chris hughes for inviting me .",
    "i am also particularly grateful to brian conrey , david farmer and chris hughes for the encouragement to write up the content of this lecture",
    ".    99 diaconis p. and shahshahani m. the subgroup algorithm for generating uniform random variables .",
    "sc . _ * 1 * , 1532 ( 1987 ) .",
    "dyson f. m. the threefold way .",
    "algebraic structure of symmetry groups and ensembles in quantum mechanics . _ j. math .",
    "phys . _ * 3 * , 11991215 ( 1962 ) .",
    "eaton m. l. _ multivariate statistics : a vector space approach .",
    "_ wiley , new york , 1983 .",
    "edelman a. and rao n. r. random matrix theory .",
    "_ acta num . _",
    "* 14 * , 233297 ( 2005 ) .",
    "heiberger r. m. algorithm as127 .",
    "generation of random orthogonal matrices .",
    "stat . _ * 27 * , 199206 ( 1978 ) .",
    "katz n. m. and sarnak p. _ random matrices , frobenius eigenvalues , and monodromy .",
    "amer . math .",
    "colloquium publications , 45 .",
    "soc . , providence , ri , 1999 .",
    "keating j. p. and snaith n. c. random matrix theory and @xmath388 .",
    "phys . _ * 214 * , 5789 ( 2000 ) .",
    "keating j. p. and snaith n. c. random matrix theory and _ l_-functions at @xmath389 .",
    "phys . _ * 214 * , 91110 ( 2000 ) .",
    "mehta m. l. _ random matrices . _",
    "elsevier , san diego , 2004 .",
    "_ recent perspectives in random matrix theory and number theory .",
    "lms lecture note series , 322 .",
    "_ mezzadri f. and snaith n. c. eds .",
    "cambridge university press , cambridge , 2005 .",
    "montgomery h. l. the pair correlation of zeros of the zeta function .",
    "_ analytic number theory : proc .",
    "pure math .",
    "( st . louis , mo . , 1972 ) _ vol .",
    "24 , amer .",
    "soc . , providence , 1973 , pp  18193 .",
    "odlyzko a. m. _ the @xmath390-th zero of the riemann zeta function and 70 million of its neighbors , _ 1989 . `",
    "odlyzko / unpublished / index.html ` rubinstein m. low - lying zeros of _ l_-functions and random matrix theory . _ duke math",
    ". j. _ * 109 * , 147181 ( 2001 ) .",
    "stewart g. w. the efficient generation of random orthogonal matrices with an application to condition estimators .",
    "_ siam j. num .",
    "* 17 * , 403409 ( 1980 ) .",
    "tanner m. a. and thisted r. a. a remark on as127 .",
    "generation of random orthogonal matrices .",
    "stat . _ * 31 * , 190192 ( 1982 ) .",
    "wedderburn r. w. m. _ generating random rotations .",
    "_ research report , rothamsted experimental station ( 1975 ) .",
    "wishart j. the generalised product moment distribution in samples from a normal multivariate population .",
    "_ biometrika _ * 20a * , 3252 ( 1928 ) .",
    "zirnbauer m. r. riemannian symmetric superspaces and their origin in random - matrix theory . _ j. math",
    ". phys . _ * 37 * , 49865018 ( 1996 ) .",
    "yczkowski k. and kus m. random unitary matrices . _ j. phys . a : math .",
    "* 27 * , 42354245 ( 1994 ) ."
  ],
  "abstract_text": [
    "<S> we discuss how to generate random unitary matrices from the classical compact groups @xmath0 , @xmath1 and @xmath2 with probability distributions given by the respective invariant measures </S>",
    "<S> . the algorithm is straightforward to implement using standard linear algebra packages . </S>",
    "<S> this approach extends to the dyson circular ensembles too . </S>",
    "<S> this article is based on a lecture given by the author at the summer school on number theory and random matrix theory held at the university of rochester in june 2006 . </S>",
    "<S> the exposition is addressed to a general mathematical audience . </S>"
  ]
}