{
  "article_text": [
    "_ the level - set methods _ for the image segmentation have been studied and applied during the last two decades .",
    "the level - set method applied in the image segmentation is typically an iterative method .",
    "the segmentation starts with an initial curve @xmath0 representing an initial guess for the segmented object and it is evolved towards the segmented object by means of a suitable geometric law taking into account the direction to the segmented object and also the curvature of evolved curves . loosely speaking ,",
    "the better the initial guess is , the better and faster the segmentation process is .",
    "this is profitable for processing of time sequences where the final segmentation of one frame may serve as the initial guess for the next frame .",
    "we refer the reader to a wide range of literature on this topic like caselles et al .",
    "@xcite , handloviov et al .",
    "@xcite , osher , paragios @xcite or sethian and references therein . in comparison to parametric models studied e.g. in bene et al .",
    "@xcite and kass et al .",
    "@xcite the level - set methods can handle topological changes and so one initial curve can split and segment more separate objects .",
    "very different segmentation methods are _ the graph - cuts methods _",
    "boykov et al .",
    "@xcite ) which are based on graph theory and algorithms for finding _ the minimal cuts _ respectively _ the maximal flows_. it is also an optimization problem but algorithms for the minimal - cuts / maximal - flows find globally the best solution which is usually not the case of the level - set methods .",
    "these algorithms are not iterative and they do not require initial curves . instead of it , they need initial seeds - one or more points or lines in the interior and exterior of the segmented object . in this article , we show how to incorporate the a - priori information in form of the initial seeds to the level - set method .",
    "our main purpose is to propose a new constrained level - set method which can be applied to the image segmentation problems . in comparison to the classical level - set methods ( c.f .",
    "@xcite ) , our method allows an expert to prescribe an a - priori information by marking parts which are surely inside or outside the segmented region .",
    "such a possibility can be helpful for an expert conducting an interactive segmentation of medical data .",
    "a numerical approximation scheme is based on the complementary - finite volumes method developed by handloviov et al . in @xcite",
    "combined with the projected successive over - relaxation method for solving constrained problems proposed by mangasarian in @xcite and elliott , ockendon in @xcite .",
    "the advantage of the constrained level - set method is demonstrated on several artificial images as well as on cardiac mri data .",
    "the paper is organized as follows . in section  [",
    "sect : level - set - segmentation ] we show the common level - set method for the image segmentation together with the numerical scheme and successive over - relaxation ( sor ) method . section  [ sect : constrained - level - set ] explains the constrained level - set method with appropriate numerical scheme . as a solver for the linear complementarity problem with range bounds we adopt the projected sor method .",
    "comparison with the common level - set method and contributions of the constrained level - set method are demonstrated in section  [ sect : results ] .",
    "we assume an image is represented by the greyscale image function @xmath1 $ ] defined on a two dimensional rectangle @xmath2\\times[0,l_2]$ ] . a common idea how to segment an object in the image is to start from a closed , embedded and smooth initial curve @xmath0 approximating the shape of the object and let it evolve towards the exact boundary of the object . to this end , we construct a family of evolving curves @xmath3 with the property that @xmath3 converges to the boundary of a segmented object as @xmath4 goes to infinity .",
    "there are many ways how to construct such a flow of planar curves . among them",
    "we will focus our attention to the flow of curves proposed in the active contour model ( c.f .",
    "caselles et al . in @xcite ,",
    "kichenassamy et al . in @xcite ) .",
    "a problem of finding a boundary of an object in the image can be reformulated as a problem of construction of planar curves on which the gradient @xmath5 of the image intensity function @xmath6 is large .",
    "assuming @xmath3 is a @xmath7 smooth curve we can evaluate the unit tangent vector @xmath8 and outer unit normal vector @xmath9 .",
    "each point @xmath10 is evolved in the normal direction with the normal velocity @xmath11 .",
    "although the velocity vector @xmath12 can be decomposed into its tangential and normal parts , it should be noted that only the motion in the normal direction has impact on the shape of the closed curve @xmath3 .    following the active contour model ( c.f .",
    "@xcite ) , mikula and evovi @xcite considered a generalized form of the normal velocity : @xmath13 where @xmath14 is the curvature of @xmath3 and @xmath15 . here",
    "@xmath16 is a smooth edge detector function @xmath17 such that @xmath18 and @xmath19 , for some constant @xmath20 .",
    "a typical example is the function @xmath21 where @xmath22 is the contrast parameter .",
    "notice that , for a given smooth intensity function @xmath6 , the vector field @xmath23 has an important geometric property as it points towards edges in the image where the norm of the gradient @xmath5 is large ( c.f .",
    "@xcite ) . notice that a possible lack of smoothness of @xmath6 ( e.g. due to a noise ) can be overcome by taking the convolution of @xmath6 with a smooth gaussian mollifier @xmath24 with the dispersion @xmath25 ( see @xcite ) .",
    "the term @xmath26 pushes the evolved curve @xmath3 towards the edge of the image @xmath6 ( c.f .",
    "the effect of the curvature term @xmath27 consists in smoothing the segmented curve by means of minimization of its total length .",
    "this property makes the segmentation model robust for application even in the case of a noisy image .",
    "notice that the term @xmath28 slows down the normal velocity in the vicinity of an edges of @xmath6 ( c.f .",
    "@xcite ) . in the level - set method @xmath3",
    "is given implicitly as @xmath29 where @xmath30 is a real valued smooth function defined on @xmath31 such that @xmath32 for all @xmath33 belonging to the interior of @xmath3 and @xmath34 for all @xmath33 belonging to the exterior of a jordan curve @xmath3 .",
    "following derivation from @xcite , the level - set formulation of ( [ eqn : normal - velocity ] ) can be stated in terms of a solution @xmath30 to the initial - boundary value problem @xmath35 , \\\\ & { \\ensuremath{\\partial^{}_{\\nu } { u } } } = 0\\ & { \\rm on}\\ \\partial \\omega , \\\\ \\label{eq : level - set - segmentation-3 } & u \\mid_{t=0 } = u_{ini}\\ & { \\rm in}\\ \\omega,\\end{aligned}\\ ] ] where @xmath36 is the initial level - set function corresponding to the initial curve @xmath0 , @xmath37 and @xmath38 is the outer normal unit vector of the boundary @xmath39 of a computational domain @xmath31 . the quantity @xmath40 should be equal to @xmath41",
    ". however , for practical purposes , it is regularized by means of the tichonov regularization , i.e. @xmath42 where @xmath43 is a small regularizing parameter .",
    "we discretize the initial - boundary value problem ( [ eq : level - set - segmentation])([eq : level - set - segmentation-3 ] ) by means of the method of complementary finite volumes developed by handloviov et al .",
    "@xcite in the context of a class of level - set equations arising in the image processing .",
    "let @xmath44 be a time step for time discretization .",
    "let @xmath45 be spatial discretization steps such that @xmath46 for some @xmath47 .",
    "we define a numerical grid , its closure and its boundary as @xmath48 for a function @xmath49;{\\ensuremath{\\mathbbm{r}^{}}}\\right)$ ] we define its piecewise constant approximation on @xmath50 at the time @xmath51 as a grid function defined by @xmath52 .",
    "we furthermore introduce a dual mesh @xmath53 defined as @xmath54 \\times                               \\left [ \\left(j-\\frac{1}{2}\\right ) h_2 , \\left(j+\\frac{1}{2}\\right ) h_2 \\right ] \\mid   \\right .",
    "\\nonumber \\\\                               &",
    "&   i = 1 \\cdots n_1 - 1 , j = 1 \\cdots n_2 - 1 \\bigg\\}. \\label{dual - fvm - mesh}\\end{aligned}\\ ] ] for @xmath55 , @xmath56 , @xmath57 and @xmath58 fixed , we consider a finite volume @xmath59 of the dual mesh @xmath53 .",
    "we denote its interior by @xmath60 , its boundary by @xmath61 and let @xmath62 be the volume of @xmath60 ( see fig .  [",
    "fig : fin - volume ] ) .",
    "we also denote the set of all neighboring volumes of a finite volume @xmath59 by @xmath63 . for all inner finite volumes @xmath59 of the dual mesh @xmath53 ,",
    "the boundary @xmath61 consists of four linear segments .",
    "we denote them as @xmath64 for @xmath65 .",
    "it means that @xmath64 is a boundary between the finite volumes @xmath59 and @xmath66 .",
    "let @xmath67 be the length of this part of @xmath61 .    dividing equation ( [ eq : level - set - segmentation ] ) by the term @xmath40 , integrating it over the interior @xmath60 of a finite volume @xmath59 we obtain the equation : @xmath68 applying the euler backward in time discretization of @xmath69 we end up with the following time semi - discretization of ( [ eq : level - set - segmentation ] ) : @xmath70 next , after long and tedious but straightforward calculations and evaluations described in appendix we are in a position to formulate full time - space discretization of the level set equation ( [ eq : level - set - segmentation ] ) .",
    "it can be rewritten in a form of the following system of linear equations :    the elements @xmath71 are defined in appendix ( see ( [ def : a-1])([def : a-6 ] ) and ( [ def : a-7])([def : a-8 ] ) ) .    at each time level @xmath72",
    "we can represent a solution @xmath73 by a long vector @xmath74 by mapping the node @xmath75 of the two dimensional spatial domain to the one - dimensional vector , i.e. @xmath76 for @xmath77 and @xmath78 and setting @xmath79 .",
    "system of linear equations ( [ eq : algebraic - segmentation ] ) can be then rewritten as a linear equation @xmath80 for the solution vector @xmath74 .",
    "the dimension of the square matrix @xmath81 as well as of the vectors @xmath82 and @xmath83 is @xmath84 .",
    "we can solve the aforementioned linear problem ( [ eq : linear - problem ] ) by means of the _ successive over - relaxation method _",
    "( sor ) in this linear equation solver we iteratively solve @xmath85 for @xmath86 .",
    "we repeat the iterative process for @xmath87 until the prescribed tolerance level for the difference @xmath88 is achieved . the iterative sor scheme ( [ def : sor ] ) can be written in the operator form : @xmath89 where @xmath90 . here",
    "@xmath91 stand for the diagonal , sub - diagonal and upper - diagonal parts of the matrix @xmath81 , respectively .",
    "the parameter @xmath92 is the so - called relaxation parameter .",
    "it can be used in order to speed up the convergence of @xmath93 by minimizing the spectral norm of the operator @xmath94 .",
    "in this section we introduce our new constrained level - set method for image segmentation .",
    "we suppose that there are two disjoint subdomains @xmath95 and @xmath96 of the domain @xmath31 such that @xmath95 is a subset of the interior of the segmented object and @xmath96 lies outside the segmented object .",
    "furthermore , we suppose that there are two prescribed functions @xmath97 with the property such that @xmath98 in @xmath31 and @xmath99 in @xmath95 and @xmath100 in @xmath101 and @xmath102 in @xmath96 and @xmath103 in @xmath104 .",
    "notice that any function @xmath30 fulfilling @xmath105 in @xmath31 must be negative in @xmath95 and positive in @xmath96 .",
    "its zero level - set contains the set @xmath95 in its interior and @xmath96 in its exterior .",
    "our purpose is to construct a solution @xmath106 such that it satisfies the level set equation ( [ eq : level - set - segmentation ] ) in the open region where @xmath107 .",
    "moreover , we require that @xmath108 for all @xmath109 $ ] .",
    "the reason why to prescribe range bounds on the level - set function @xmath30 is to keep the set @xmath95 inside and @xmath96 outside the zero level set @xmath110 approaching the boundary of a segmented object when @xmath111 . to this end",
    "we consider the following partial differential inequality problem : @xmath112,\\ s.t.\\ w(x ) < u(x , t ) < v(x ) ,   \\nonumber \\\\ u_t & \\ge &   q { \\ensuremath { \\nabla \\cdot \\left ( g^0 \\frac{{\\ensuremath { \\nabla } } u}{q } \\right)}}\\   \\hbox{for}\\ ( x , t)\\in\\omega \\times ( 0 , t],\\",
    "s.t.\\ u(x , t)=w(x ) ,   \\label{eq : constrained - level - set - segmentation } \\\\ u_t & \\le &   q { \\ensuremath { \\nabla \\cdot \\left ( g^0 \\frac{{\\ensuremath { \\nabla } } u}{q } \\right)}}\\   \\hbox{for}\\ ( x , t)\\in\\omega \\times ( 0 , t],\\",
    "s.t.\\ u(x , t ) = v(x ) ,   \\nonumber\\end{aligned}\\ ] ] @xmath113 it can be also viewed as the following variational inequality problem : find a solution @xmath114 where @xmath115 such that @xmath116 where @xmath117 is the cone : @xmath118 ( c.f . brezis ( * ? ? ?",
    "* chapter 2 ) ) .",
    "the operator @xmath119 is defined by @xmath120 and @xmath121 is the inner product in @xmath122 , i.e. @xmath123      the discretization of ( [ eq : constrained - level - set - segmentation])([eq : constrained - level - set - segmentation-3 ] ) follows exactly from the discretization of the level set equation ( [ eq : level - set - segmentation])([eq : level - set - segmentation-3 ] ) when taking into account the range bounds constraints @xmath124 for a.e . @xmath125 . at each time step",
    "we have to construct a solution @xmath82 to the following linear complementarity problem : @xmath126 for @xmath86 .    in order to solve the linear complementarity problem ( [ eq : linear - problem - inequality ] ) we make use of the so - called projected sor method ( psor ) @xcite adopted for our problem .    for each index @xmath86 , we repeat the following up - dating of the vector @xmath127 : @xmath128 until the prescribed tolerance level for the difference @xmath88 is achieved .",
    "suppose that the matrix @xmath81 has a positive diagonal , i.e. @xmath129 for each @xmath130 .",
    "assume that @xmath131 as @xmath132 .",
    "hence @xmath133 .",
    "it means @xmath134_i ,   w_i\\ } , v_i      \\}. \\label{eqa}\\ ] ] clearly , @xmath135 for each index @xmath130 .",
    "if the strict inequality @xmath136 holds for some index @xmath130 , then @xmath137_i.\\ ] ] it means that @xmath138 on the other hand , if @xmath139 then @xmath140 . according to ( [ eqa ] )",
    "we conclude that @xmath141_i.\\ ] ] since @xmath129 we obtain @xmath142 analogously , if @xmath143 for some index @xmath130 then it follows from ( [ eqa ] ) that @xmath144_i.\\ ] ] thus @xmath145 hence the vector @xmath82 is a solution to the linear complementarity problem ( [ eq : linear - problem - inequality ] ) .",
    "in this section , we present experimental results obtained by the constrained level - set method .",
    "we first demonstrate the effect of the obstacle constraints applied to artificial images .",
    "[ fig : no - obstacle ] a ) ( left ) shows an image we want to segment .",
    "there are two rectangles with centers at points @xmath146 and @xmath147 . the width of the rectangles is @xmath148 and the height is @xmath149 .",
    "the thickness of the rectangles edges is @xmath150 . on the inner edge of each rectangle",
    ", there is a thin hole .",
    "the image intensity function is defined on the domain @xmath151 .",
    "the initial curve is a circle with the radius @xmath152 centered exactly between the rectangles .",
    "its signed distance function ( taken as the initial level - set function @xmath36 ) is depicted on fig .",
    "[ fig : no - obstacle ] a ) ( right ) .",
    "the numerical mesh consisted of @xmath153 grid points .",
    "if the thin holes in the rectangles should be taken into account we may want to segment only the rectangles edges .",
    "it can be achieved by setting the regularizing parameter @xmath154 . in @xcite mikula and sarti interpreted the regularization parameter @xmath155 as a parameter by which we can control `` convexity '' of the final segmentation curve . the result taken at time @xmath156",
    "is depicted at fig .",
    "[ fig : no - obstacle ] b ) . on the other hand ,",
    "if small holes are present by mistake , we may want the segmentation curve to fill them .",
    "it may be achieved by setting @xmath157 . however , a convex hull of both rectangles is segmented as we can see on the fig .",
    "[ fig : no - obstacle ] c ) .",
    "the segmentation we aim to can be achieved by prescribing one constraint guaranteeing that the part of the image between the rectangles must be outside the segmentation domain .",
    "we construct the constraint by putting a red bar placed on between the rectangles on the fig .",
    "[ fig : one - obstacle ] a ) .",
    "its width equals @xmath150 and the height is set to @xmath158 .",
    "the constraint function @xmath159 is positive on the red bar region and negative everywhere else .",
    "we again set @xmath157 . the result taken at time",
    "@xmath160 is shown on fig .",
    "[ fig : one - obstacle ] b ) .    in our last synthetic example shown in fig .  [",
    "fig : two - obstacles ] we place one more constraint inside the left rectangle .",
    "the segmentation poses features of both experiments on the figures [ fig : no - obstacle ] and [ fig : one - obstacle ] .",
    "it shows that the constrained level - set method is capable of controlling which part of the image we want to segment .    in the remaining two figures we present a real application of the constrained level - set method to segmentation of cardiac mri data .",
    "first we want to segment both , the left and the right ventricle of a heart . the usual level - set method for the image segmentation ( c.f .",
    "@xcite ) is not capable to separate them . in figure",
    "[ fig : cardiac - mri-1 ] we present a ) the initial set - up of the constraint barriers ; b ) segmentation without obstacles involved ; c ) segmentation with constraints separating both ventricles well . figure  [ fig : cardiac - mri-2 ] demonstrates more complex segmentation result in which we separated the left ventricle , septum and the right ventricle together with pericardial fat .",
    "we proposed a new constrained level - set method for the image segmentation .",
    "the method gives a possibility to an expert to prescribe an additional information concerning the expected shape of the segmented object . in this method",
    ", we may preset fixed constraints telling us which parts of the segmented object should be inevitably inside the segmented region and some parts must remain outside .",
    "the complementary finite - volume method was used for the numerical approximation of the level - set equation .",
    "it was combined with the projected successive over relaxation method for solving the corresponding parabolic variational inequality problem .",
    "we demonstrated the difference between the new and the usual level - set method on several artificial images as well as on data from the magnetic resonance .",
    "in this section we show details of derivation of the full time - space discretization of ( [ eq : level - set - segmentation ] ) . as usual in the finite volume methods , we apply the stokes theorem to the right hand side of ( [ eq : level - set - segmentation ] ) .",
    "we obtain @xmath161 where @xmath38 is the outer unit normal of @xmath61 .",
    "we have to approximate the `` fluxes '' @xmath162 and the `` capacity '' @xmath163 numerically .",
    "we assume that the `` fluxes '' are constant on each segment @xmath64 of the finite volume boundary @xmath61 .",
    "it means that @xmath164 first we evaluate the norm of smoothed gradient of the image intensity function @xmath165 . here",
    "@xmath166 is the gaussian mollifier .",
    "we refer the reader to @xcite for details how to effectively calculate the convolution @xmath167 .",
    "then @xmath168 on @xmath169 and we approximate @xmath170 on the finite volume edges as follows : @xmath171 denote @xmath172 .",
    "the approximation of @xmath173 in the direction of the vector @xmath174 is obvious : @xmath175 in order to calculate remaining coordinates of @xmath173 which are perpendicular to @xmath174 we need to know the value @xmath176 at the ends of @xmath67 ( corners of the finite volume @xmath59 ) .",
    "they can be only approximated using the value of @xmath176 at the neighboring volumes : @xmath177 where @xmath178 .",
    "hence we obtain the approximation of @xmath173 in the direction perpendicular to @xmath174 in the form @xmath179 having calculated approximation of @xmath173 we can approximate the term @xmath180 as follows : @xmath181 where @xmath182 .",
    "the `` capacity '' term @xmath183 and the function @xmath176 are approximated by a constant value on the finite volume @xmath59 .",
    "taking the averaged value @xmath184 yields the approximation @xmath185 it follows from ( [ stokes ] ) that @xmath186 notice that @xmath187 ( see fig .  [ fig : fin - volume ] ) .",
    "in such a regular grid , one coordinate of @xmath38 is always vanishing .",
    "it cancels one coordinate of @xmath188 in the inner product @xmath189 .",
    "recall that @xmath67 attains only the values @xmath190 or @xmath191 .",
    "we have @xmath192 finally , equation ( [ eq : constrained - level - set - segmentation ] ) is approximated as @xmath193 let us denote @xmath194 to approximate the neumann boundary condition @xmath195 on @xmath39 where @xmath38 is the outer unit normal of the domain @xmath31 we set @xmath196 which yields @xmath197",
    "this work was partially supported by the grant lc06052 of ncmm research center and research direction project msm6840770010 of the ministry of education of the czech republic , the cvut student grant agency project no . 283 ohk4 - 009/10 p3913 and vega project 1/0747/12 .",
    "99    , m.  kimura , p.  pau , d.  evovi , t.  tsujikawa , s.  yazaki , application of a curvature adjusted method in image segmentation , bulletin of inst . of mathematics , academia sinica , new series * 3 * ( 2008 ) , 509524 .                        , a.  sarti , parallel co - volume subjective surface method for 3d medical image segmentation , in : parametric and geometric deformable models : an application in biomaterials and medical imagery , volume - ii , springer publishers , ( eds . jasjit s. suri and aly farag ) , 2007 , pp .",
    "123 - 160 ."
  ],
  "abstract_text": [
    "<S> we propose a new constrained level - set method for semi - automatic image segmentation . </S>",
    "<S> the method allows to specify which parts of the image lie inside respectively outside the segmented objects . </S>",
    "<S> such an a - priori information can be expressed in terms of upper and lower constraints prescribed for the level - set function . </S>",
    "<S> constraints have the same meaning as the initial seeds of the graph - cuts based methods for image segmentation . </S>",
    "<S> a numerical approximation scheme is based on the complementary - finite volumes method combined with the projected successive over - relaxation method adopted for solving range bounds constrained linear complementarity problems . </S>",
    "<S> the advantage of the constrained level - set method is demonstrated on several artificial images as well as on cardiac mri data .    </S>",
    "<S> linear complementarity , image processing , segmentation , level - set method , projected successive over - relaxation method , graph cuts 90c33 , 35k55 , 35k52 , 53c44 , 74s10 , 74g15 </S>"
  ]
}