{
  "article_text": [
    "first - principles based descriptions of transport processes in plasmas require the solution of high - dimensional kinetic equations for the phase - space distribution function @xcite",
    ". often , diffusion in velocity - space plays an important physical role , as discussed in @xcite , and references therein .",
    "for example , in kinetic turbulence , there is a cascade of energy in velocity - space in addition to real space , so velocity diffusion cuts off the cascade at small velocity scales . in this sense ,",
    "velocity diffusion plays a role similar to that of viscosity in conventional hydrodynamic fluid turbulence . just as viscosity is important in hydrodynamic turbulence no matter how large the reynolds number , velocity diffusion is important in kinetic turbulence no matter how small the collisionality .",
    "velocity diffusion is essential to dissipate injected energy and thereby permit a statistically steady state .",
    "solving these kinetic equations numerically is computationally intensive @xcite , so an important aspect of the theoretical effort is to find new optimized discretization schemes . while high order accurate discretization schemes for the spatial variables have been succesfully used for many years , finding an ideal discretization method remains particularly challenging for the discretization of velocity space in situations involving fokker - planck collisions @xcite .",
    "since the fokker - planck collision operator has terms involving first and second order derivatives with respect to the velocity variables , the discretization method must allow accurate differentiation .",
    "the scheme must also allow accurate integration since physical quantities such as the number density , the mean fluid velocity and the pressure depend on velocity moments of the distribution function .",
    "recently , promising new approaches based on spectral and pseudo - spectral representations have been investigated @xcite .",
    "it was shown in @xcite that a hermite representation for the parallel velocity has advantages over the more common finite difference schemes used in numerical simulations . in @xcite ,",
    "different representations for the speed coordinate are explored .",
    "it is found that because the variable has values in @xmath0 instead of the entire real axis , a little - known family of polynomials ( see @xcite and references therein ) gives much better performance than finite difference schemes and schemes based on classical orthogonal polynomials .",
    "high accuracy is obtained on very coarse grids for both differentiation and integration of maxwellian - like functions , which are the functions of interest in many applications of plasma physics @xcite .",
    "the purpose of this paper is to explore the suitability of the non - classical polynomials for initial - value calculations of turbulent plasma transport in the presence of collisions @xcite .",
    "to do so , we consider a model one - dimensional problem describing energy diffusion due to fokker - planck collisions  @xcite :    @xmath1 ,    \\qquad ( x>0,\\;t>0),\\end{aligned}\\ ] ]    where @xmath2 , \\qquad    { { \\operatorname}{erf}}(x ) = \\frac{2}{\\sqrt{\\pi}}\\int_0^x e^{-s^2}\\,ds.\\end{aligned}\\ ] ] here , @xmath3 differs from the usual chandrasekhar function by an additional factor of @xmath4 .",
    "our choice to focus on this particular model problem is motivated by the following characteristic features .",
    "first , the right - hand side of corresponds exactly to the speed variable part of the energy diffusion piece in the linearized landau - fokker - planck operator for same - species collisions @xcite .",
    "since many state - of - the - art plasma turbulence codes ( e.g.  @xcite ) use variants of the linearized landau - fokker - planck operator to describe collisions , the results presented here are directly relevant to the computational effort to simulate transport processes in plasmas .",
    "second , the relative simplicity of ( [ eq : model ] ) makes it possible to represent the solution semi - analytically using a spectral transform method @xcite , which we can then use to study the properties and accuracy of various discretization schemes .",
    "third , has several physically satisfying properties .",
    "any well - behaved initial distribution function relaxes to a maxwellian distribution function @xmath5 as @xmath6 ( the `` h - theorem '' ) .",
    "also , for all @xmath7 , @xmath8 , i.e.  the number of particles is conserved .",
    "the best time - dependent numerical schemes are designed to satisfy these basic properties exactly  @xcite .    while we consider a single velocity dimension in , any accurate numerical scheme for this equation is immediately applicable to simulations with more velocity dimensions and more complete collision operators , such as the operator in @xcite or the linearized fokker - planck operator , for the following reasons . for either of these collision operators in",
    "spherical velocity coordinates , the only term involving any @xmath9 derivatives of the distribution function is the right - hand side of .",
    "for example , in the pitch - angle diffusion term , the speed @xmath10 appears only as a parameter , not as a derivative .",
    "thus , captures nearly all the complexity associated with the @xmath10 coordinate in higher - dimensional kinetic problems with linearized collisions , and the issue of how best to discretize the speed coordinate is quite independent of how the other velocity coordinates are discretized . as an example of how different discretizations may be applied to the different velocity coordinates",
    ", one may refer to the time - independent problems considered in @xcite , in which 2d velocity space is discretized using a pseudospectral @xmath10 discretization related to the approach considered here , combined with a legendre modal discretization in pitch angle . in a similar manner ,",
    "time - dependent problems in a 2d velocity space could be solved by combining the @xmath10 discretization we consider here with a legendre modal discretization in pitch angle ( or some other pitch angle discretization . )",
    "the third velocity coordinate , gyro - angle , is often averaged out of kinetic equations in plasma physics due to rapid particle gyration in a magnetic field , but this coordinate too could be included using a tensor product approach if desired .    in this article , we compute high - accuracy solutions using a true ( galerkin ) spectral method to represent the projected dynamics of ( [ eq : model ] ) .",
    "we discretize velocity space only , integrating the resulting ordinary differential equations exactly in time . in future work",
    ", we plan to adapt the methods developed here to implement exponential time differencing schemes @xcite and implicit - explicit runge - kutta methods @xcite for the time - evolution of the coupled problem .",
    "however , for the model problem ( [ eq : model ] ) , any timestepping scheme will decouple into independent eigenmodes that behave as predicted by standard linear stability theory ; thus , spatial discretization is our focus here .",
    "in a separate paper @xcite , pseudo - spectral methods will be developed that preserve the self - adjoint structure of the discrete evolution operator , mimicking the galerkin operator as closely as possible .",
    "performance on coarse grids , which is of great practical importance in high - dimensional plasma turbulence codes , will be addressed in detail there , along with comparisons with other methods . in the present article",
    ", we also look at performance on coarse grids and comparisons with existing discretization schemes ( section [ sec : low_res ] ) , but the main emphasis of the paper is on questions of convergence , discrete approximation of the continuous spectrum , and the effect of domain truncation . except in section  [ sec : low_res ] , we perform calculations in quadruple - precision arithmetic to better illustrate the connection between the discrete mode amplitudes in the eigenbasis of the projected evolution operator and the continuous spectral transform of the solution @xcite , to demonstrate that the mode amplitudes in the orthogonal polynomial basis continue to decay exponentially to arbitrarily small scales , and to more closely monitor the effect of domain truncation . the results of figures  [ fig : evol2][fig : err : compare ] and  [ fig : trunc1][fig : trunc3 ] below are similar in double - precision , with relative errors only a few times larger than machine precision , which is @xmath11 in double precision versus @xmath12 in the calculations shown in the figures",
    ".    while errors introduced by physical approximations in a model are typically large compared to the level of accuracy we consider here , it is important when assessing the validity of the model to be confident that the results of a numerical simulation accurately represent the equations one has discretized .",
    "an additional motivation for high accuracy is that small numerical errors can impede computation of damped eigenmodes , which are sometimes important for physical understanding @xcite . in applications with more dimensions , such as gyrokinetic simulations @xcite",
    ", lower resolution would be sufficient for routine simulations .",
    "typically tens of modes or fewer are used in the @xmath10 coordinate , each with tens of degrees of freedom in the pitch - angle coordinate of velocity space , and double - precision arithmetic is sufficient .",
    "we observe a remarkable feature of the non - classical polynomials of @xcite : for certain initial conditions , the exact solution ( computed using an expensive spectral transform approach ) leaves the subspace but returns arbitrarily closely ( i.e.  without losing spectral accuracy ) to the solution of the projected dynamics .",
    "the situation is different for classical hermite polynomials .",
    "while the exact solution still arrives in the subspace with spectral accuracy after some time , the projected dynamics evolves to a different location in this time , with an error that decays only algebraically as a function of the dimension of the subspace .    the structure of the article is as follows .",
    "in sections  [ sec : orthog ] and  [ sec : proj ] , we review the construction of orthogonal polynomials and present our general method for computing solutions of by projecting the pde onto finite dimensional subspaces .",
    "section  [ sec : num ] forms the core of the paper . in  [",
    "sec : evol : modes ] , we solve equation for two different initial conditions , @xmath13 and @xmath14 . in both cases",
    "we find that the non - standard polynomials are effective at representing the solution , and that they are much more accurate than classical polynomials defined by orthogonality conditions on the interval @xmath15 .",
    "the improved behavior is explained by comparing the mode amplitudes in the eigenbasis of the projected evolution operator to the spectral transform of the solution , computed as described in @xcite .",
    "this transform method is used in  [ sec : valid]-[sec : low_res ] as an independent means of validating the accuracy of the galerkin approach . in ",
    "[ sec : eigen ] , we compare the discrete eigenfunctions of the projected operator with the non - normalizable eigenfunctions of the pde to see in what sense the continuous spectrum is being approximated by a discrete one . in ",
    "[ sec : low_res ] we study the performance of the new family polynomials for the low grid resolutions commonly used in five - dimensional kinetic simulations of magnetized plasmas , and compare their accuracy to that of classical hermite polynomials and the finite difference scheme used by popular gyrokinetic solvers @xcite .",
    "we then investigate the benefits and drawbacks of truncating the domain @xmath0 to a finite interval in  [ sec : trunc ] .",
    "we summarize our results and discuss future work in  [ sec : conclusion ] .",
    "we consider two classes of orthogonal polynomials on the positive half - line .",
    "the first , discussed by shizgal @xcite and recently applied in the context of plasma physics simulations by landreman and ernst @xcite , are orthogonal with respect to the weight function @xmath16 we find in [ sec : float ] that @xmath17 is the best choice overall in floating point arithmetic , although part of the calculation is more accurately performed with @xmath18 .",
    "roundoff error aside , @xmath17 is also most natural since the projected dynamics involves an implicit change of basis to this case . indeed , as explained in section  [ sec : proj ] , @xmath19 then agrees with the weight function of the sturm - liouville problem associated with the evolution operator on the right - hand side of ( [ eq : model ] ) . thus , except in [ sec : float ] , computations will be performed using the @xmath17 polynomials . for the remainder of the paper",
    ", this class of polynomials will be referred to as `` full polynomials . ''",
    "the second class of polynomials we consider are orthogonal with respect to @xmath20 over the whole line .",
    "however , the odd polynomials will then be discarded and the even ones restricted to @xmath21 , giving a different basis for @xmath22 .",
    "this basis remains complete since any function on the half - line can be extended to the whole line by even reflection , which leads to an expansion in even polynomials only . with @xmath18 we obtain the even hermite polynomials ( scaled to be monic ) , whereas with @xmath17 we obtain the odd hermite polynomials divided by @xmath23 : @xmath24 in either case , the same @xmath25-dimensional subspace and projected dynamics will result when the polynomials are truncated to degree @xmath26 , although floating - point issues make the @xmath17 family more desirable to work with .",
    "for the remainder of the article , polynomials in this second class will be referred to as `` even polynomials '' or `` classical polynomials . ''",
    "we note that it is preferable to discard the odd polynomials rather than the even ones since the exact solution @xmath27 satisfies @xmath28 at @xmath29 for @xmath30 rather than @xmath31 ; this follows from the representation ( [ eq : uv ] ) below and the results of @xcite on the behavior of bounded solutions of @xmath32 near @xmath29 , where @xmath33 is defined in ( [ eq : pde ] ) below .",
    "one or the other must be discarded as the odd polynomials are not orthogonal to the even ones on the half - line .",
    "monic orthogonal polynomials with respect to an arbitrary weight function @xmath19 may be constructed via the stieltjes procedure @xcite .",
    "a number of technical challenges arise , partly due to the rapid decay of @xmath34 , which leads to overflow and underflow problems in floating point arithmetic , and partly due to poor conditioning of the recurrence @xmath35 for small values of @xmath10 , which amplifies roundoff errors .",
    "we overcome overflow and underflow issues by carrying an extra integer to extend the exponent range of floating point numbers in the polynomial evaluation subroutine ( see @xcite ) , and avoid ill - conditioning in the recurrence ( [ eq:3:term : brief ] ) by representing the polynomials in product form @xmath36 the roots @xmath37 of @xmath38 are the eigenvalues of the symmetric tridiagonal jacobi matrix @xmath39 with entries @xmath40 the coefficients @xmath41 and @xmath42 as well as the squared norms @xmath43 are computed via @xmath44 and the following recursion for @xmath45 : @xmath46 where @xmath47 is taken to be zero when @xmath48 . in the floating point (",
    "as opposed to symbolic ) algorithm , the formula for @xmath38 is replaced by ( [ eq : prod ] ) , and the inner products @xmath49 are computed using composite gaussian quadrature on subintervals @xmath50 $ ] with endpoints taken to be the zeros of @xmath38 together with @xmath51 and several additional points @xmath52 , ",
    ", @xmath53 chosen to integrate the tails of the integrands accurately .",
    "see @xcite for further details about this approach , and",
    "@xcite for additional perspective .    in",
    "what follows , it is useful to define @xmath54 which are ( non - monic ) polynomials of unit length in @xmath22 , and @xmath55 which are unit vectors in @xmath56 that oscillate with a fairly uniform amplitude between 0 and @xmath57 and then decay rapidly to zero , as illustrated in figure  [ fig : basis ] . to avoid excessive notation",
    ", we use the same symbols @xmath41 , @xmath42 , @xmath58 , @xmath38 , @xmath59 and @xmath60 in the full and even cases , with the recurrence relation ( [ eq:3:term : brief ] ) replaced , in the even case , by ( [ eq : even : recur ] ) below .",
    "re - scaled basis functions @xmath60 in ( [ eq : tilde : phi ] ) with @xmath61 and weight function @xmath62 .",
    "the main difference between the full and even polynomials is that the nodes cluster more tightly at @xmath29 in the former case , which causes the oscillations in @xmath60 to be less uniform .",
    "this occurs because @xmath29 is a true endpoint of the weight function in the full case and is merely a symmetry axis in the even case .",
    "note that @xmath60 is odd in the even case due to the factor of @xmath10 in @xmath63 . ]",
    "the first step to solving the pde ( [ eq : model ] ) is to transform it to a self - adjoint system .",
    "this is done by defining @xmath64 which satisfies @xmath65 where @xmath66 and @xmath67 .",
    "note that if @xmath68 and @xmath69 are bounded , @xmath70 functions on @xmath71 , we have @xmath72 thus , @xmath33 is symmetric and densely defined on the hilbert space @xmath73 physically , the @xmath74th moment of the distribution function @xmath75 may be computed as the @xmath76-inner product of @xmath68 with @xmath77 , or the @xmath78-inner product of @xmath79 with @xmath80 : @xmath81 it is shown in @xcite that @xmath33 is a singular sturm - liouville operator @xcite on @xmath71 of limit circle type at @xmath29 and limit point type at @xmath82 .",
    "the limit circle case requires a boundary condition , but it suffices to require that solutions ( of @xmath32 ) remain bounded at @xmath29 .",
    "the point spectrum of @xmath33 consists of @xmath83 with eigenfunction @xmath84 , and the continuous spectrum is @xmath71 . a spectral transform algorithm is developed in @xcite that diagonalizes the evolution operator and expresses the solution as a discrete and continuous superposition of normalizable and non - normalizable eigenfunctions of @xmath33 .",
    "we will use this computationally expensive method to assess the accuracy of the projected dynamics below .    in this work ,",
    "we approximate solutions of the pde ( [ eq : pde ] ) by projecting onto finite dimensional subspaces of orthogonal polynomials .",
    "however , it is useful to derive the discrete evolution equations without assuming that the basis functions are polynomials ( or even orthogonal ) .",
    "let @xmath85 be linearly independent and consider the subspace @xmath86 .",
    "define @xmath87 and its adjoint @xmath88 by @xmath89 let @xmath90 be the orthogonal projection from @xmath76 onto @xmath91 .",
    "the projected dynamics of ( [ eq : pde ] ) onto @xmath91 is given by @xmath92 where @xmath93 remains in @xmath91 for all time .",
    "in weak form , we have @xmath94 writing @xmath95 , we find that @xmath96 where @xmath97 are the mass and stiffness matrices associated with the basis functions @xmath98 , respectively .",
    "the finite - dimensional system of odes ( [ eq : mct])([eq : mk ] ) can be solved by a wide variety of time - advance methods .",
    "we solve them _ exactly _ here in order to focus on the effectiveness of the @xmath10-discretization , without further complications arising from the discretization of time .",
    "due to the linear self - adjoint structure of the equations , any other scheme will evolve the eigenmodes independently , in accordance with standard linear stability theory .",
    "its behavior can therefore be predicted by replacing @xmath99 in the spectral plots below by @xmath100 , where @xmath101 is the stability function of the scheme @xcite , @xmath102 is the timestep , and @xmath25 is the number of steps .",
    "since the @xmath98 are linearly independent , @xmath103 is positive definite and has both a cholesky factorization and a square root .",
    "@xmath104 does as well since it is positive definite on @xmath105 where we assume @xmath106 the cholesky approach is more convenient for our purposes , so let us write @xmath107 where the @xmath108 are upper - triangular and @xmath109 is the transpose of @xmath108 ( or the hermitian transpose if the basis functions are complex - valued ) .",
    "assuming @xmath110 is constant , which is convenient in practice , the first row and column of @xmath104 are zero .",
    "the singular value decomposition @xmath111 solves the eigenvalue problem for @xmath112 : @xmath113 the solution of ( [ eq : u : tilde ] ) is then @xmath114 where @xmath115 is treated as a row vector . since @xmath116 , the eigenfunctions of @xmath117 are the columns of @xmath118 , which are orthonormal in @xmath76 .",
    "we note that since the constant function @xmath110 is in the basis set , @xmath119 and @xmath120 i.e.  mass is conserved exactly by the projected dynamics .",
    "the same is true when the domain is truncated in ",
    "[ sec : trunc ] since we impose neumann boundary conditions at the right endpoint .",
    "the constant function remains an eigenfunction of @xmath33 in that case .    in floating point arithmetic , computing",
    "the svd of @xmath121 is more accurate than forming @xmath104 and computing its eigenvalues since we avoid squaring the condition number . @xmath122 and",
    "@xmath123 can be obtained directly ( without forming @xmath103 and @xmath104 ) as follows .",
    "first , we choose a quadrature scheme @xmath124 such that the matrix entries @xmath125 , @xmath126 in ( [ eq : mk ] ) are accurately approximated by @xmath127 we choose the @xmath128 and @xmath129 corresponding to the composite quadrature rule used to compute @xmath130 and @xmath131 in ( [ eq : recur ] ) with @xmath132 ; see @xcite for further details .",
    "note that ( [ eq : mk2 ] ) may be written @xmath133 @xmath122 and @xmath123 are then obtained by qr - factorization : @xmath134 , @xmath135 . since the zeroth column of @xmath136 is zero , we actually perform the qr factorization of columns 1 through @xmath137 to obtain @xmath138 in ( [ eq : r ] ) below .    to reduce roundoff errors in the numerically computed singular values of @xmath121 ,",
    "we compute its pseudo - inverse before computing its svd . in more detail , note that since @xmath139 , @xmath140 where @xmath141 is obtained from @xmath108 be deleting the zeroth row and column .",
    "it follows that @xmath142 it is well - known @xcite that error bounds on the numerically - computed svd of an @xmath143 matrix @xmath144 are of the form @xmath145 , where @xmath146 is a constant ( independent of @xmath144 and @xmath25 ) ; @xmath147 is machine precision ; and @xmath148 is either the 2-norm or the frobenius norm , depending on whether givens rotations or householder reflections are used in the bidiagonal reduction process .",
    "thus , we expect that computing @xmath149 and @xmath150 via ( [ eq : pinv ] ) will give better results than via ( [ eq : r ] ) if @xmath151 .",
    "we will see in [ sec : float ] that this is the case when @xmath152 are orthogonal polynomials with respect to the weight @xmath153 .",
    "we also note that since @xmath154 and @xmath155 are upper - triangular , applying @xmath156 to @xmath154 from the right causes information to propagate from left to right along the rows of @xmath154 .",
    "more precisely , the first @xmath157 columns of @xmath158 do not depend on columns @xmath159 of @xmath160 or @xmath155 .",
    "thus , numerical error in high - index basis functions does not corrupt more accurately computed low - index basis functions in the initial phase of computing @xmath161 before performing the svd .",
    "sources of numerical error that tend to be larger for high - index basis functions include the process of constructing the orthogonal polynomials @xmath59 , the evaluation of derivatives in the corresponding columns of @xmath136 , and quadrature error in the formulas @xmath162 and @xmath163 , where e.g.  @xmath164 denotes the @xmath157th column of @xmath165 .",
    "we now study the accuracy of approximating solutions of @xmath166 by their projected dynamics .",
    "to illustrate typical behavior , we study two initial conditions @xmath167 , namely @xmath168 note that @xmath169 has a singularity at the origin , so @xmath170 blows up as @xmath171 in that case . for this reason , example 2 is easier and presented first below .",
    "we did not switch the labels since it is easier to remember that example @xmath74 corresponds to @xmath172 .",
    "the cause of the singularity in example 1 is that @xmath173 must be even in order to represent a smooth , radially symmetric function in three - dimensional velocity space",
    ". the reader may wonder about the physical relevance of such an initial condition . perhaps surprisingly , this case is indeed physically relevant and occurs in several practical situations .",
    "for example , it occurs when one computes the resistivity of a plasma ( see section 3 in reference @xcite ) by solving the time - dependent kinetic equation for the distribution function until a steady - state is reached .",
    "we write the solution ( [ eq : proj : soln1 ] ) in the form @xmath174 where @xmath175 is short for @xmath176 , @xmath149 and @xmath150 were defined in ( [ eq : r12 ] ) , and the matrix @xmath177 does not appear in the second expression because @xmath17 .",
    "note however that , as discussed in [ sec : float ] , the accuracy is improved if @xmath178 is corrected for loss of orthogonality by applying @xmath179 from the right , where @xmath122 was defined in ( [ eq : r12 ] ) and deviates from the identity due to orthogonality drift in floating point arithmetic . in the numerical results that follow , @xmath180 stands for the @xmath74th column of @xmath181",
    ". see ( [ eq : proj : soln2 ] ) , ( [ eq : alpha : beta ] ) , and the last paragraph of [ sec : float ] for further clarification of how ( [ eq : up : alpha ] ) is computed .",
    "the vector @xmath175 can be computed analytically for the two examples in ( [ eq : ex12:again ] ) . in the full ( as opposed to even ) case , we have @xmath182 setting @xmath183 and computing @xmath41 , @xmath42 , @xmath58 via ( [ eq : recur ] ) yields @xmath184 which give the coefficients @xmath185 .    in the even case , we note that @xmath186 are monic orthogonal polynomials with weight function @xmath187 on @xmath188 and satisfy @xmath189 the functions @xmath190 are then orthogonal with respect to @xmath191 on the half - line and satisfy @xmath192 where @xmath193 and @xmath194 .",
    "it follows that @xmath43 is given by @xmath195 from @xmath196 and @xmath197 we obtain @xmath198 an intermediate step is to show that @xmath199 .",
    "note that @xmath200 and @xmath201 in ( [ eq : alpha : even ] ) . for large @xmath157 , stirling s approximation gives @xmath202 so the coefficients @xmath203 decay slowly in the even case of example 1 .",
    "since the columns of @xmath204 form an orthonormal set of eigenfunctions for @xmath117 on @xmath91 , the components of the vector @xmath205 represent the mode amplitudes of @xmath206 in the eigenbasis while the components of @xmath207 in ( [ eq : up : alpha ] ) represent the mode amplitudes in the orthogonal polynomial basis .",
    "panels ( a , b , d , e ) of figure  [ fig : evol2 ] show the evolution of both sets of mode amplitudes for example 2 in the full and even cases . for comparison , we also plot the spectral transform of the solution in ( c ) , which was computed at 512 equally spaced points between @xmath208 and @xmath209 using the algorithm described in @xcite . here",
    "@xmath210 is the spectral parameter used in @xcite to represent the solution as a discrete and continuous superposition of eigenfunctions . in more detail",
    ", the solution of the pde in the infinite dimensional space @xmath76 may be written @xmath211 where @xmath212 , @xmath213 is a solution of @xmath32 with appropriate boundary conditions at @xmath29 , @xmath214 is a scale factor defined in @xcite , @xmath215 and @xmath216 is the spectral density function associated with the singular sturm - liouville problem @xcite . in order to understand how the results in panels a and b are related to those of panel c , consider the following .",
    "writing @xmath217 for the @xmath157th column of @xmath149 and @xmath218 , the solution of the projected dynamics is given by @xmath219 comparing ( [ eq : uv ] ) and ( [ eq : gamma ] ) , we can interpret the projected dynamics solution as having one component that represents @xmath220 and the others approximating the integral @xmath221 .",
    "since the spacing of @xmath222 is not uniform and the functions @xmath223 are not normalized in the same way as @xmath224 , the vertical scaling in panels ( a ) , ( b ) and ( c ) is not expected to be the same . nevertheless , these graphs are remarkably similar and give insight into how the projected dynamics mimic the continuous dynamics .    panels ( d ) and ( e ) of figure  [ fig : evol2 ] show the evolution of the coefficients @xmath225 in the orthogonal polynomial basis in the full and even cases .",
    "we added @xmath226 to all the coefficients to keep the @xmath227 modes visible in the plot . in both cases",
    ", the number of active modes grows from 3 or 2 at @xmath227 to 400 or 800 at @xmath228 , then decays down to one mode ( the steady state ) as @xmath6 .",
    "the curves are plotted in black or orange depending on whether the number of active modes is growing or decaying at that time .",
    "panels ( d ) and ( e ) show that twice as many modes are necessary to represent the solution using even polynomials instead of full polynomials .",
    "panels ( a ) and ( b ) show why this is the case : the full polynomials are more efficient at sampling the interval @xmath229 of interest . indeed , the eigenvalue distribution in panel ( b ) is heavily skewed to over - sample the low end of this spectral window .",
    "evolution of mode amplitudes for example 1 in the eigenbasis ( a , b ) ; the spectral density representation ( c ) ; and the orthogonal polynomial basis ( d , e ) .",
    "large errors in the mode amplitudes for small values of @xmath230 in panel ( b ) are not damped out quickly by @xmath231 , and therefore persist for large times in panel ( e ) . in panel",
    "( d ) , the mode amplitudes @xmath232 decrease until @xmath233 or so , then enter a brief growth period until @xmath234 , then decay again toward steady - state . ]    figure  [ fig : evol1 ] shows that for example 1 the full polynomials are again able to mimic the behavior of the continuous problem in the sense that the mode amplitudes in the eigenfunction basis closely resemble the spectral transform of the initial condition .",
    "moreover , for @xmath235 , the mode amplitudes in the orthogonal polynomial basis decay exponentially to roundoff error using 1600 modes .",
    "by contrast , in the even case , the mode amplitudes in the eigenfunction basis reach a plateau when @xmath236 decreases below -3 , and cease to resemble the spectral transform @xmath237 . as a consequence ,",
    "the mode amplitudes in the orthogonal polynomial basis do not decay to roundoff error accuracy until @xmath7 reaches @xmath238 or so , and even then the mode amplitudes @xmath225 become large again for large @xmath157 .",
    "thus , the even polynomials are not able to represent the solution of example 1 effectively even for large values of @xmath7 .     evolution and error of projected dynamics in spaces of full and even orthogonal polynomials .",
    "the spectral transform approach of @xcite was used for the `` exact '' solution .",
    "( b , c , e ) both methods reach roundoff error in quadruple - precision .",
    "( f ) the projected dynamics with even orthogonal polynomials does not perform well with 5000 modes until the solution approaches steady - state . ]      of course , it is not guaranteed that the full polynomials yield the correct answer for @xmath235 just because the mode amplitudes decay fast enough to reach roundoff error at that point .",
    "the true solution might leave the subspace @xmath239 initially and come back to a different point in the subspace than the projected dynamics predicts .",
    "this was the motivation for developing the spectral transform approach in @xcite , where we know the analytic form of the solution and can use it as an independent check of the correctness of the projected dynamics . in figure",
    "[ fig : err : compare ] , we plot the solution , scaled by @xmath240 , for examples  1 and  2 at several times , together with the difference between the solution of the projected dynamics and the one obtained using the spectral transform approach , both scaled by @xmath240 .",
    "we considered other scalings , namely @xmath187 ( since @xmath241 ) and also @xmath242 ; the scaling @xmath240 is the one for which the plots are the most readable .",
    "we added @xmath243 to the error plots to avoid evaluating @xmath244 when the two methods agree to all 32 digits .",
    "at @xmath227 , both methods represent the solution with high relative accuracy for example 2 , but only the full polynomials are able to do this for example 1 .",
    "this is because the only errors at @xmath227 in panels ( b , c , e ) of figure  [ fig : err : compare ] are roundoff errors in the 23 nonzero coefficients in ( [ eq : alpha : full ] ) and ( [ eq : alpha : even ] ) , while in panel ( f ) the series in ( [ eq : alpha : even ] ) has been truncated at 5000 terms , leading to much larger errors at @xmath227 . in panels ( b ) and",
    "( e ) , which correspond to example 2 , the two approaches agree to more than 28 digits of accuracy for all positive times , though twice as many modes are needed to achieve this accuracy with even polynomials . however , the errors are now absolute errors rather than relative errors .",
    "this loss of relative accuracy is expected as the spectral density approach leads to oscillatory integrals involving a large amount of cancellation to evaluate @xmath245 for @xmath30 and @xmath246 .",
    "similarly , the orthogonal polynomial approach yields a superposition @xmath247 that involves a large amount of cancellation of digits for @xmath30 and @xmath246 .",
    "for example , @xmath248 remains @xmath249 well past @xmath250 when @xmath251 while @xmath252 is less than @xmath253 when @xmath254 and @xmath255 .",
    "for very large @xmath7 , both methods regain high relative accuracy since the oscillatory part of the calculation becomes negligible compared to the steady - state zeroth mode .",
    "panel ( c ) confirms that the full polynomials yield small ( absolute ) errors in example 1 for @xmath235 even though the true solution leaves the subspace @xmath91 for @xmath256 ( due to slower decay of mode amplitudes @xmath232 in figure  [ fig : evol1 ] than those shown for @xmath257 ) .",
    "panel  ( f ) of figure  [ fig : err : compare ] shows that this is not true for even polynomials .",
    "there are two issues in play causing the even polynomials to be less accurate .",
    "it takes longer ( by a factor of 66 ) for the exact solution ( computed using the spectral transform method ) to reach the subspace  we have checked that the distance from the exact solution to the 5000-mode even polynomial subspace does not drop below @xmath253 until @xmath258  and when it arrives , the projected dynamics solution has evolved to a different location in the subspace , with an error of @xmath259 in the @xmath76-norm at @xmath258 with 5000 modes . for comparison , the @xmath76-norm of the exact solution at this time is @xmath260 .",
    "full orthogonal polynomials @xmath59 ( orange ) grow much faster with @xmath157 at @xmath29 than even orthogonal polynomials ( black ) . in panel",
    "( c ) , the factor of @xmath261 is included to account for the fact that @xmath262 alternates in sign .",
    "the function @xmath263 increases monotonically in @xmath157 when @xmath29 is held fixed , but becomes oscillatory in @xmath157 for any other fixed value of @xmath10 . ]    in figure  [ fig : err : compare](b , c ) , the errors in the full polynomial case are much larger near @xmath29 than elsewhere .",
    "this is not a cause for concern since physical quantities , such as the moments of the distribution function in ( [ eq : moments ] ) , carry an additional factor of @xmath264 in the integrand , which suppresses these errors . nevertheless , it is instructive to identify their source .",
    "these errors occur because the coefficients @xmath203 in figures  [ fig : evol2](d ) and  [ fig : evol1](d ) carry roundoff errors that are amplified by the large values of the basis functions @xmath59 near @xmath29 for large @xmath157 .",
    "as shown in figure  [ fig : growthp0 ] , @xmath262 is already close to 1000 in the full case when @xmath61 , and grows to @xmath265 at @xmath266 . for other values of @xmath10 , @xmath263 is oscillatory in @xmath157 , with higher frequency and smaller amplitude oscillations for larger @xmath10 .",
    "thus , these functions are only large near @xmath29 .",
    "this growth in the basis functions near @xmath29 occurs because the weight function @xmath191 approaches 0 as @xmath267 . indeed , we saw in figure  [ fig : basis ] that when @xmath157 is large , @xmath268 oscillates with a fairly uniform amplitude over a large distance before eventually decaying to zero as @xmath269 . in the even case",
    ", @xmath268 resembles a sine function near @xmath29 ; hence , @xmath248 resembles a sinc function .",
    "however , in the full case , the zeros of @xmath59 are more tightly clustered near @xmath29 since it is a true endpoint rather than a symmetry axis",
    ". the higher oscillation rate near @xmath29 causes the peaks of @xmath268 to be amplified more when divided by @xmath10 to obtain @xmath248 , since @xmath10 is smaller at the peaks .",
    "thus , @xmath262 grows more rapidly with @xmath157 in the full case than in the even case .",
    "next we consider the connection between eigenfunctions of the projected operator @xmath117 and solutions of @xmath32 , which are not normalizable but serve as basis functions to represent the solution of @xmath166 in a continuous superposition via the spectral transform ( [ eq : uv ] ) and ( [ eq : gamma ] ) .",
    "since the exact solution has this form , one might expect that the accuracy of a discrete approximation of the continuous spectrum would be limited by the degree to which these eigenfunctions can be approximated .",
    "we find below that this is not the case : the eigenfunctions need only agree to 23 digits for the time dependent solutions constructed from them to agree to 30 digits .",
    "figure  [ fig : efun ] shows the solution @xmath68 of @xmath32 with @xmath270 and @xmath271 , as well as the eigenfunction @xmath93 of @xmath117 with eigenvalue closest to 1 for two choices of @xmath272",
    ". one boundary condition on @xmath68 is sufficient at @xmath29 since the other linearly independent solution blows up there .",
    "the orange curves show the envelope of the solution of @xmath32 , which we define as the prefactor @xmath273 in the asymptotic formula @xmath274+o(x^{-15/4}).\\ ] ] in @xcite , the authors show that @xmath275 , \\\\    q(x ) & = { \\textstyle}\\sqrt{2\\lambda x^5}\\left [      \\frac{2}{5 } - \\frac{1}{6x\\lambda } - \\frac{1}{16x^2\\lambda^2 } +      \\frac{1}{64x^3\\lambda^3 } + \\frac{5}{3072x^4\\lambda^4 } +      \\frac{7 - 1152\\lambda^4}{20480x^5\\lambda^5}\\right ] .",
    "\\label{eq : q}\\end{aligned}\\ ] ] the parameters @xmath276 and @xmath277 were obtained by fitting the numerical solution of @xmath32 , @xmath270 , @xmath271 to the form ( [ eq : ufit ] ) for large @xmath10 .",
    "note that the amplitude of @xmath278 decays slowly while the frequency grows rapidly since @xmath279 and @xmath280 .",
    "comparison of eigenfunctions of @xmath117 and solutions of @xmath32 .",
    "the asymptotic formula ( [ eq : ufit ] ) was used for the envelopes ( orange curves ) while a 15th order spectral deferred correction scheme was used to solve @xmath32 to plot the black curve in ( a ) and the blue markers in ( b ) , ( c ) . ]    the blue markers in figure  [ fig : efun](b , c ) show the extrema of the ( highly oscillatory ) residual @xmath281e^{-x^2/2}.\\ ] ] we re - scaled the eigenfunction @xmath93 by hand to minimize the amplitude of the oscillations in @xmath282 . due to the logarithmic scale of the plot , it is important to use the same @xmath283 for @xmath68 and @xmath93 when computing @xmath284 , but setting @xmath271 is sufficient for plotting the envelope . for @xmath285 ( panel b of the figure ) , there is an interval @xmath286 where @xmath93 agrees with @xmath68 to 23 digits of accuracy . for @xmath287 , @xmath282 grows in amplitude since there are not enough orthogonal polynomial basis functions for @xmath288 to match the accelerating frequency of oscillation in @xmath278 . as a result , the blue markers move outward and begin to oscillate about the envelope curve as @xmath68 and @xmath93 pass in and out of phase with each other . at this point",
    ", the projected eigenfunction @xmath93 drops in amplitude by a few orders of magnitude and enters a plateau phase where it no longer reaches the envelope curve but still remains significant in size . beyond @xmath289",
    ", the eigenfunction finally decays rapidly to zero .",
    "the results for @xmath290 ( panel c ) are similar , but @xmath291 over a larger window @xmath292 and is generally 310 times smaller than in the @xmath285 case .",
    "the plateau region also grows from @xmath293 when @xmath285 to @xmath294 when @xmath290 .",
    "gibbs overshoot phenomenon near @xmath29 ( left ) and coefficients @xmath203 expressing the eigenfunctions @xmath93 in the orthogonal polynomial basis .",
    "the coefficients do not decay to zero as @xmath25 increases since @xmath271 is part of the continuous spectrum of @xmath33 , i.e.  there is no normalizable eigenfunction of @xmath33 on @xmath21 to which @xmath93 could converge . ]",
    "the growth in @xmath282 as @xmath267 in figure  [ fig : efun](b , c ) is due to a gibbs phenomenon in the eigenfunctions of @xmath117 .",
    "this is shown in more detail in figure  [ fig : gibbsv](a ) , which plots the eigenfunction with eigenvalue closest to 1 for @xmath285 ( blue ) , @xmath290 ( black ) , and @xmath295 ( orange ) , along with the solution @xmath68 of @xmath32 , @xmath271 ( red ) .",
    "we used a linear scale on the @xmath296-axis to better illustrate the magnitude of the overshoot .",
    "we also plotted the results parametrically versus @xmath297 to better distinguish the oscillations from the @xmath296-axis and from each other .",
    "as @xmath25 increases , the overshoot becomes taller , narrower , and more oscillatory .    in figure",
    "[ fig : gibbsv](b ) , we plot the coefficients when these eigenfunctions are expanded in the orthogonal polynomial basis .",
    "this plot illustrates that all of the eigenfunctions @xmath93 of @xmath117 are poorly resolved in the sense that the expansion coefficients do not decay to zero once @xmath25 is large enough .",
    "the one exception is the @xmath83 eigenfunction , @xmath298 , which is normalizable and agrees with @xmath299 . for the others , as @xmath25 increases , the higher - frequency polynomials make it possible for @xmath93 to match the oscillations in @xmath68 over a greater distance .",
    "thus , as discussed above , the window over which @xmath282 is small grows from @xmath300 when @xmath285 , to @xmath292 when @xmath290 , to @xmath301 when @xmath295 ( not shown in figure  [ fig : efun ] ) .",
    "the plateau region also grows with @xmath25 .",
    "this is a consequence of all the polynomial basis functions being present in @xmath93 .",
    "indeed , the effective support of @xmath93 ( where @xmath302 , say ) is roughly the same as that of the highest frequency orthogonal polynomial present , which grows with @xmath25 .",
    "by contrast , we will see below that on a truncated domain , the eigenfunctions of @xmath117 converge to those of @xmath33 , and are independent of @xmath25 once @xmath25 increases beyond the point where the coefficients @xmath203 have converged to zero .",
    "it is remarkable that on the infinite domain , in spite of the gibbs overshoot and rather poor agreement between eigenfunctions of @xmath117 and solutions of @xmath32 , the numerical solution of the projected dynamics agrees to 30 digits of accuracy to the numerically computed spectral transform solution , which is built from solutions of @xmath32 .",
    "numerical simulations of high dimensional kinetic equations are often so computationally intensive that only a low number of modes or grid points can be retained to discretize the speed variable . for example , in the five - dimensional gyrokinetic simulations of plasma turbulence in magnetic confinement devices , the number of grid points for the speed variable is typically 8 - 24 @xcite . if the non - classical polynomials studied in this article are to replace existing discretization schemes for kinetic simulations , it is important to consider their performance at low resolution . in figures [ fig : smallgrid ] and [ fig :",
    "smallgridentropy ] , we compare the error at low resolution for three different discretization schemes .",
    "the first two are the full and even polynomials considered throughout the article .",
    "the third is that of the popular gyrokinetic codes gs2 and astrogk @xcite , in which the grid consists of @xmath303 gauss - legendre points on the interval @xmath304 $ ] , together with @xmath305 gauss - laguerre points on @xmath306 , where @xmath307 for @xmath308 and @xmath309 otherwise @xcite . in more detail ,",
    "the gauss - laguerre points @xmath310 are transformed to @xmath306 via @xmath311 , and the weights are scaled by @xmath312 , so that @xmath313 whenever @xmath314 is a polynomial of degree less than @xmath315 .",
    "we actually used @xmath316 since the errors were smaller . in gs2 and astrogk ,",
    "the gauss - legendre and gauss - laguerre points are used for accurate numerical integration @xcite , but derivatives with respect to the speed variable , such as the ones appearing on the right - hand side of ( [ eq : model ] ) , are computed with a 3-point finite - difference stencil .",
    "evolution of the error in the hilbert space @xmath76 as a function of time for three discretization schemes : the full and even polynomials discussed throughout the article , and the hybrid gauss - legendre / gauss - laguerre grid used by the gyrokinetic codes gs2 and astrogk . here",
    "@xmath25 is the number of modes or grid points used to solve ( [ eq : model ] ) , the initial conditions correspond to example 1 , and the spectral transform approach of @xcite was used for the `` exact '' solution . ]",
    "figure [ fig : smallgrid ] gives the norm of the error in the hilbert space @xmath76 as a function of time , and figure [ fig : smallgridentropy ] gives the error in the computed value of @xmath317 as a function of time .",
    "@xmath318 is an entropy - like function in the sense that it satisfies @xmath319 , which can be viewed as a `` second principle of thermodynamics . ''",
    "this can be easily seen by multiplying ( [ eq : model ] ) by @xmath320 and integrating from @xmath29 to @xmath82 .",
    "the initial conditions in figures  [ fig : smallgrid ] and  [ fig : smallgridentropy ] are those of the more challenging example 1 , and the error is measured by comparing the solutions obtained with the three different discretization schemes with the solution obtained from the spectral transform approach .",
    "these figures show that for small grid sizes , the full polynomials are several orders of magnitude more accurate than the even polynomials for small times , and become comparable at larger times . for larger grid sizes ( @xmath321 ) ,",
    "the full polynomials remain more efficient than even polynomials for all time , as seen in the third panel of figures [ fig : smallgrid ] and [ fig : smallgridentropy ] , and also in figures  [ fig : evol2 ] and  [ fig : evol1 ] .",
    "we can also see that at a fixed grid size , the full polynomials lead to more accurate solutions than the gs2 scheme for all times , often by several orders of magnitude .",
    "evolution of the error in the entropy - like scalar function @xmath322 as a function of time for the discretization schemes of figure  [ fig : smallgrid ] .",
    "as before , @xmath25 is the number of modes or grid points used to solve ( [ eq : model ] ) , the initial conditions correspond to example 1 , and the spectral transform approach of @xcite was used for the `` exact '' solution . ]    for the time evolution of the present paper , we evolve to any time @xmath7 by diagonalizing the discrete differential operators .",
    "this leads to almost no difference in the running times of gs2 and the orthogonal polynomial approach .",
    "for example , to compute the solution at all 90 values of @xmath7 in figures  [ fig : smallgrid ] and  [ fig : smallgridentropy ] , the running time ( in milliseconds ) of the computational phases of our two codes was @xmath323 the columns labeled @xmath144 correspond either to balancing the tridiagonal matrix and computing its eigenvalues and eigenvectors ( gs2 approach ) or computing the svd of @xmath121 in ( [ eq : r ] ) , which is precomputed and read from a file ( orthogonal polynomial approach ) .",
    "the same file works for any @xmath25 ( up to the one used to generate the file ) since the @xmath121 matrices are nested .",
    "the columns labeled @xmath324 correspond to evolving the solution from @xmath227 to the times shown in the figures by computing @xmath325 , where @xmath149 is the eigenvector matrix . for these small values of @xmath25 ,",
    "the running times depend more on the blas implementation than the number of flops involved , and the first phase ( column a ) is actually faster when @xmath326 than @xmath327 in both approaches .",
    "we used the intel math kernel library in a c++ framework for both codes .",
    "one advantage of the gs2 scheme is that the discretized differential operator @xmath33 on the right - hand side of ( [ eq : pde ] ) is tridiagonal .",
    "thus , if the timestepping scheme of the high - dimensional problem involves solving one - dimensional subproblems ( e.g.  through operator splitting ) , the computational cost of applying @xmath33 or inverting @xmath328 will be lower for gs2 than for either set of orthogonal polynomials .",
    "thus , one could potentially use a larger @xmath25 in gs2 for the same computational cost as the orthogonal polynomial approach . however , increasing @xmath25 also increases the required storage space and communication costs , which may be more limiting resources than the cpu cycles available to solve the local one - dimensional subproblems",
    ". nevertheless , sparse discretizations are clearly desirable .",
    "we are developing a banded version of the orthogonal polynomial approach in a pseudo - spectral framework that is more accurate than gs2 while retaining much of the sparsity advantage over the dense galerkin approach presented here @xcite .",
    "there are three benefits to truncating the domain to a finite interval .",
    "first , the method is easier to implement as the integration domain in the inner products is fixed .",
    "we continue to use a composite gaussian quadrature rule using the zeros of @xmath329 as the endpoints of the integration sub - intervals . however , it is no longer necessary to deal with the last sub - interval as a special case since it no longer extends to infinity .",
    "second , the coefficients @xmath330 and @xmath331 grow less rapidly on a truncated domain . for example , numerical experiments suggest that for large @xmath74 @xmath332 \\hline      { \\raisebox{-2pt}{$\\text{even}$ } } &       { \\raisebox{-2pt}{$b_k = k\\big(k+\\frac{1}{2}\\big)$ } } &      { \\raisebox{-2pt}{$b_k = 14.0625 + o(1/k^2)$ } } \\\\[4pt ] \\hline      { \\raisebox{-2pt}{$\\text{full}$ } } &      { \\raisebox{-2pt}{$b_k",
    "= \\frac{1}{6}(k+1 ) + \\frac{17}{72}(k+1)^{-1 } + o(1/k^3)$ } } &      { \\raisebox{-2pt}{$b_k = 14.0625 + o(1/k^2)$ } }    \\end{array}.\\ ] ] since @xmath333 , we see that the monic polynomial norms grow super - exponentially on the half - line and exponentially on the truncated domain .",
    "if @xmath25 is not too large ( say @xmath334 ) , this alleviates the need to use special floating point numbers to guard against overflow and underflow . for larger @xmath25",
    ", there is little advantage in this respect .",
    "third , orthogonal polynomials on the truncated domain are more efficient at representing functions supported near the origin since their zeros remain confined to the truncated interval , and therefore can resolve more features of the solution with fewer basis functions . on the other hand ,",
    "an obvious drawback of truncating the domain is that the solution and its gradient must remain essentially zero at the right endpoint to remain a good approximation of the solution on the half - line .",
    "plots showing the use of orthogonal polynomials on a truncated domain to solve examples 1 and 2 .",
    "the error in ( b ) is nearly identical to the half - line case of figure  [ fig : err : compare](c ) , but only required 1200 ( instead of 1600 ) modes . in ( c )",
    ", the modes decay faster on the truncated domain because the oscillations in the basis functions are more localized near the origin , as shown in ( a ) . ]    in figure  [ fig : trunc1 ] , we illustrate these issues in the context of examples  1 and  2 , where @xmath335 , @xmath336 or @xmath337 .",
    "panel a compares the 175th normalized basis function , defined in ( [ eq : tilde : phi ] ) , on the half - line and truncated domain .",
    "both functions have 175 zeros , but they are more spread out in the half - line case .",
    "panel b repeats the calculation of figure  [ fig : err : compare ] , showing the difference between the solution obtained from the projected dynamics ( this time on a truncated domain ) to the spectral transform solution ( plotted in figure  [ fig : err : compare](a , d ) ) .",
    "the errors are essentially the same as for the half - line ( ranging from @xmath338 near @xmath29 to @xmath339 for larger @xmath10 ) , but only 1200 modes were needed to reach roundoff accuracy instead of 1600 . as before , with this choice of @xmath25 , the projected dynamics solution for example 1 is correct at @xmath227 and for @xmath340 , but not at intermediate times @xmath256 .",
    "similar results , valid for @xmath255 , were obtained for example 2 .",
    "panel c shows the mode amplitudes @xmath232 at @xmath257 in example 1 and @xmath234 for example 2 .",
    "fewer modes are needed on the truncated domain since the zeros remain confined to @xmath341 in that case .",
    "next we look for an initial condition that is initially confined to @xmath341 but spreads out past the right endpoint .",
    "we tried a number of formulas and settled on a two - hump initial distribution of the form @xmath342 \\exp\\left ( -\\frac{15}{15-x } \\right ) ,    & 0<x<15 , \\\\    0 , & \\text{otherwise}.    \\end{cases}\\ ] ]",
    "the results are shown in figure  [ fig : trunc2 ] .",
    "panels a and b show the solution at the times @xmath343 , computed on the half - line , on a linear and log scale , respectively .",
    "up until @xmath344 , the solution remains confined to @xmath341 .",
    "but then from @xmath345 , the solution is not negligible ( in quadruple - precision ) at the right endpoint .",
    "panel c shows the difference between the truncated domain solution and the half - line solution .",
    "as expected , they agree to roundoff error for @xmath346 , but then begin to differ near the right end of the domain due to an incorrect assumption that @xmath347 at @xmath348 in the truncated domain calculation .",
    "once @xmath349 , the solution has decayed to the steady - state maxwellian distribution , and the two methods agree again .",
    "panel d shows that many fewer modes were needed to resolve the initial condition on the truncated domain than on the half - line .",
    "this is because the nodes cluster at @xmath29 and @xmath348 for the truncated domain calculation , but only at @xmath29 for the half - line calculation , and this initial condition varies rapidly near @xmath348 due to the factor of @xmath350 $ ] in ( [ eq : ex:15 ] ) . even in this example , where the initial distribution @xmath245 has a peak of order 1 near @xmath351 , the error in truncating the domain to @xmath341 was never larger than @xmath352 .",
    "thus , we expect that in practice it is safe to truncate the domain as long as the initial condition and any sources are fully supported inside the truncated region .",
    "evolution of two - hump initial condition that is initially contained in @xmath341 but eventually spreads out past the right endpoint . in panel",
    "( c ) , @xmath353 was computed on a truncated domain while @xmath354 was computed on the half - line .",
    "the modes decay faster in ( d ) for the truncated domain due to clustering of the zeros of @xmath329 near @xmath348 . ]    as a final remark , we note that the eigenfunctions of @xmath117 converge to eigenfunctions of @xmath33 when the domain is truncated , unlike the half - line case .",
    "this is illustrated in figure  [ fig : trunc3 ] .",
    "panels a and d show the eigenmode amplitudes for examples 1 and 2 on a half - line and truncated domain .",
    "the main difference is that on a truncated domain , further mesh refinement will not increase the density of eigenvalues of @xmath117 at the left end of the spectrum since these are converged eigenvalues of the continuous problem . by contrast , on the half - line , the eigenvalues of @xmath117 become more densely spaced as the mesh is refined to better approximate the continuous spectrum of @xmath33 . in figure",
    "[ fig : trunc1 ] , we saw that 1200 modes was sufficient to resolve the solution in example 1 and 350 modes was sufficient for example 2 . in panels ( b ) and",
    "( e ) here , we plot the eigenfunction @xmath93 of @xmath117 with eigenvalue @xmath283 closest to  1 , re - scaled to agree as closely as possible with @xmath68 , the solution of @xmath32 with the same @xmath283 and satisfying @xmath270 .",
    "note that 1200 modes yields perfect agreement between @xmath68 and @xmath93 ( to 26 digits ) while 350 modes yields large discrepancies : a gibbs overshoot occurs near @xmath29 , and a beat pattern appears for large @xmath10 where the two functions fall out of phase .",
    "the minimum amplitude of oscillation of @xmath355 in panel e is roughly @xmath356 when @xmath357 , which is 23 orders of magnitude larger than in panel b. panels c and f show why this occurs : the solution @xmath68 of @xmath32 with @xmath358 requires about 500 orthogonal polynomial basis functions to be represented on @xmath341 .",
    "when 1200 basis functions are used , the modes decay rapidly between @xmath359 and @xmath360 and the remaining modes are zero up to roundoff error .",
    "when 350 modes are used , as in example 2 , the eigenfunction of @xmath117 does not agree closely with that of @xmath33 due to lack of resolution .",
    "however , just as in the half - line case , where none of the eigenfunctions of @xmath117 agree closely with solutions of @xmath32 , the projected dynamics is accurate to roundoff error in both examples  it is not necessary to resolve all the active eigenfunctions to accurately represent the solution of the pde on a truncated domain either .",
    "comparison of mode amplitudes on a half - line and truncated domain ( a , d ) and plots of resolved ( b ) and unresolved ( e ) eigenfunctions of @xmath117 and @xmath33 on @xmath341 .",
    "as before , @xmath217 is the @xmath157th column of the matrix @xmath149 in the singular value decomposition @xmath111 , and @xmath361 is the @xmath157th eigenfunction of @xmath117 , where @xmath362 are the orthogonal polynomials . ]",
    "shizgal @xcite showed that a new class of non - classical polynomials could be used very effectively for numerical quadratures of the collision operator in kinetic simulations .",
    "more recently , landreman and ernst @xcite showed that the same polynomials could also be much more accurate than other schemes for the discretization of the speed variable in steady - state kinetic calculations involving the collision operator . in this article , we have demonstrated that the new polynomials are also useful for time - dependent problems by examining the one - dimensional relaxation of a distribution function to a maxwell - boltzmann distribution via energy diffusion .",
    "we found that the new polynomials are effective at representing the solution of the partial differential equation for a wide class of initial conditions , and can be more accurate than generalized hermite ( `` even '' ) polynomials by many orders of magnitude for the same computational work .",
    "this was seen e.g.  in fig .",
    "[ fig : evol2](d , e ) , where 350 modes are sufficient to reach errors of @xmath253 with the new polynomials and @xmath363 for the even polynomials , and fig .",
    "[ fig : err : compare](c , f ) , where 1600 modes with the new polynomials are @xmath364 times more accurate than 5000 classical modes .    given the sturm - liouville structure that we associated with the problem ,",
    "the polynomials defined with integration weight @xmath365 are the most natural to use , and the most accurate for most parts of the computations . as discussed in [ sec : float ] , the polynomials defined with integration weight @xmath366 ( on the half - line ) , chosen for most computations in @xcite , also give satisfying results .",
    "it is often the case , given the size of the numerical simulations , that one can only afford very coarse grids for a given variable .",
    "our analysis at low resolution , in figures [ fig : smallgrid ] and [ fig : smallgridentropy ] , shows that the full polynomials are more accurate than even polynomials as well as the discretization scheme used in popular plasma kinetic codes , often by several orders of magnitude .",
    "these results , together with exact mass conservation at all times suggests that the new polynomials could be an attractive alternative to the finite difference schemes currently in use in state - of - the - art plasma microturbulence codes @xcite .",
    "however , for the new polynomials to make a truly compelling case , at least two questions must be answered .",
    "first , the stiffness matrix @xmath104 is dense , whereas finite difference matrices are sparse .",
    "does the fact that the polynomials yield accurate results on very coarse grids compensate this disadvantage ? are there formulations based on these polynomials that can avoid operations on dense matrices ?",
    "curiously , when @xmath18 , we find that @xmath103 is pentadiagonal and the entries @xmath126 decay exponentially as @xmath367 increases , but this still leads to a much wider band of nonzero entries centered about the diagonal than in a finite - difference approach .",
    "second , what is the best way to incorporate these polynomials in time - dependent simulations with more complete collision operators ?",
    "exponential time - differencing schemes @xcite and implicit - explicit runge - kutta methods @xcite appear promising , but this is the subject of ongoing research , with results to be reported at a later date .",
    "j.w .  was supported in part by the u.s .",
    "department of energy , office of science , office of advanced scientific computing research , applied mathematics program under contract number  de - ac02 - 05ch11231 , and by the national science foundation under grant no .",
    "a.j.c .  was supported by the u.s .",
    "department of energy , office of science , fusion energy sciences under award no .",
    "de - fg02 - 86er53223 and de - sc0012398 .",
    "m.l .  was supported in part by the u.s .",
    "department of energy , office of science , office of fusion energy science , under award numbers de - fg02 - 93er54197 and de - fc02 - 08er54964 .",
    "in exact arithmetic , the projected dynamics onto @xmath369 is identical for any choice of @xmath368 in ( [ eq : rho : plus ] ) since the subspace @xmath91 consists of polynomials of degree less than or equal to @xmath25 , regardless of the weight function .",
    "however , changing @xmath368 can have a large effect in the presence of roundoff error . to understand this ,",
    "first observe that using a monomial basis for @xmath91 ( instead of orthogonal polynomials ) would lead to numerical difficulties as the basis functions become nearly linearly dependent in @xmath370 .",
    "using orthogonal polynomials with weight exponent @xmath371 has the potential to cause similar difficulties .    in exact arithmetic , the mass matrix @xmath372 in ( [ eq : mk ] ) is the identity when @xmath17 since the @xmath98 in ( [ eq : varphi ] ) are orthonormal in @xmath76 . for any other choice of @xmath368 , the cholesky factor",
    "@xmath122 gives the change of basis to the @xmath17 case : @xmath373 similarly , @xmath374",
    "so that @xmath375 in ( [ eq : r12 ] ) is independent of @xmath368 ( up to roundoff errors ) , and is largely unaffected by orthogonality drift when @xmath17 as long as @xmath376 is actually computed rather than assumed to be the identity matrix . from ( [ eq : exp : mk ] ) , the solution of the projected dynamics is @xmath377    \\big [ v e^{-{s^2}t } v^t\\big ] \\big [    \\underbrace{r_1^{(\\nu)}\\vec\\alpha^{(\\nu)}}_{b}\\big]\\ ] ] where @xmath378 , @xmath379 , @xmath380 , and @xmath381 thus , if @xmath371 , the numerical algorithm performs a change of basis to the @xmath17 case as an intermediate step .",
    "comparison of roundoff errors for @xmath382 .",
    "here @xmath383 stands for `` even , '' @xmath384 stands for `` assuming @xmath385 , '' and errors are measured against the @xmath17 or @xmath386 quadruple - precision results . (",
    "a ) and ( b ) show the error in using @xmath387 with @xmath18 to compute @xmath388 .",
    "( d ) gives the sup - norm of the error in computing @xmath389 in this way .",
    "( e ) shows the error in the @xmath74th column of @xmath161 , as defined in ( [ eq : e : nu : def ] ) .",
    "( c ) and ( f ) give the largest and smallest singular values of @xmath122 and @xmath155 , which help explain the results in ( a ) , ( b ) , ( d ) , ( e ) . ]",
    "figure  [ fig : phi2err ] shows the sources and effect of roundoff error in evaluating the solution @xmath206 via ( [ eq : proj : soln2 ] ) . panels ( a ) and",
    "( b ) show the normalized basis functions @xmath388 and @xmath390 in ( [ eq : tilde : phi ] ) and the error in computing them in double - precision with @xmath18 or @xmath391 , where `` @xmath383 '' stands for even : @xmath392 -    \\tilde\\varphi_k^{(2\\text { or } 2e)}(x).\\ ] ] here @xmath393 is the @xmath74th column of @xmath394 .",
    "the second term on the right is the `` exact '' solution , which was computed with @xmath17 in quadruple - precision .",
    "the relative error for @xmath360 is about 60 times smaller in the even case ( b ) than the full case ( a ) .",
    "this is because the orthogonal polynomials are more oscillatory near @xmath29 in the full case , where @xmath29 is a true integration boundary .",
    "a similar thing occurs in chebyshev and legendre polynomials , which are more oscillatory near @xmath395 than @xmath29 .",
    "we plotted @xmath396 in ( a ) to obtain more uniform oscillations for visualization .    in both ( a ) and ( b )",
    ", we note that the error has more structure than might be expected from roundoff errors alone .",
    "this is because @xmath397 is present in ( [ eq : err : def ] ) , which amplifies errors along singular vectors corresponding to the smallest singular values more than in other directions .",
    "( c ) shows the largest and smallest singular values of @xmath376 as a function of @xmath398 .",
    "since the matrices @xmath376 are nested as @xmath25 increases , @xmath399 is an increasing function of @xmath25 while @xmath400 is decreasing .",
    "the condition number of @xmath376 is the ratio @xmath401 .",
    "it is 1 for @xmath17 , grows slowly for @xmath391 and @xmath402 , and grows faster for @xmath18 and @xmath403 .",
    "the condition number of @xmath103 is the square of the condition number of @xmath122 .",
    "thus , roundoff errors are reduced by computing @xmath122 directly rather than from @xmath103 .",
    "panel ( d ) shows the max - norm of @xmath404 as a function of @xmath74 for @xmath405 in the even and full cases .",
    "for example , the amplitudes of the largest peaks in the error curves in ( a ) and ( b ) are plotted at @xmath360 in ( d ) on the double - precision curves labeled @xmath406 and @xmath407 , respectively . for small values of @xmath74 ,",
    "all the values of @xmath368 that we tested yield reasonably accurate results .",
    "however , as @xmath74 increases , the growth in the condition number of @xmath376 in ( c ) leads to significant loss of accuracy in @xmath408 when computed via @xmath409 for @xmath371 .",
    "in particular , roundoff error is amplified by more than 5 orders of magnitude with @xmath403 and @xmath410 .",
    "the @xmath17 curves ( full and even ) are missing from the quadruple - precision results as they are treated as `` exact '' solutions in ( [ eq : err : def ] ) . note that even for @xmath17 we compute @xmath122 and apply its inverse to @xmath411 to correct for the slight loss of orthogonality that occurs when computing the basis functions by the three - term recurrence ( [ eq:3:term : brief ] ) or ( [ eq : even : recur ] ) .",
    "in other words , the second term in ( [ eq : err : def ] ) is computed as @xmath412.\\ ] ] the curves labeled @xmath413 and @xmath414 give uncorrected results in which @xmath122 is assumed equal to the identity and dropped from the first term in ( [ eq : err : def ] ) .",
    "these errors are comparable to using @xmath18 or @xmath403 , where @xmath122 is required .",
    "panel ( e ) shows the error in computing @xmath161 in ( [ eq : pinv ] ) .",
    "more precisely , we plot @xmath415,\\ ] ] where @xmath141 is obtained from @xmath108 by deleting the zeroth row and column .",
    "the second term on the right is computed in quadruple precision , and treated as `` exact . ''",
    "since @xmath122 and @xmath123 are upper - triangular , the @xmath74th column of @xmath416 is independent of @xmath417 for @xmath418 . note that the double - precision curves labeled @xmath18 and @xmath391 are more accurate than the @xmath17 and @xmath386 curves , respectively .",
    "this is because we compute the svd of @xmath161 , which involves @xmath419 rather than @xmath179 , and @xmath420 is better conditioned than @xmath421 , as shown in panel ( f ) .",
    "the reason is that the orthogonal polynomials for @xmath18 are less oscillatory near @xmath29 than for @xmath17 ( since @xmath19 vanishes at @xmath29 in the latter case ) , and @xmath123 involves derivatives of these orthogonal polynomials .",
    "thus , a better `` exact '' solution would be @xmath18 instead of @xmath17 in ( [ eq : e : nu : def ] ) .",
    "when this is done , the only visible effect on the plot in panel ( e ) is that the two most accurate quadruple - precision curves should be re - labeled ( 0 to 2 , @xmath407 to @xmath422 ) to better account for the primary source of error in ( [ eq : e : nu : def ] ) .    as mentioned previously ,",
    "we compute the svd of @xmath161 rather than of @xmath121 because @xmath423 .",
    "this may be seen in panel ( f ) , where @xmath424 grows faster than @xmath425 decays .",
    "( recall that @xmath426 since @xmath427 . ) also , the largest singular values of a matrix are computed with the most relative accuracy , and the largest singular values of @xmath161 are the ones that matter most in accurately representing solutions of the pde ( [ eq : pde ] ) .    in summary , the most accurate computation of @xmath206 in ( [ eq : proj : soln2 ] ) in floating point arithmetic would involve computing @xmath428 with @xmath17 ( without assuming @xmath427 ) , and computing @xmath149 and @xmath150 from @xmath429 with @xmath18 . in practice",
    "we set @xmath17 when computing @xmath149 and @xmath150 as well since the improvement in switching to @xmath18 is small .",
    "the last term in ( [ eq : proj : soln2 ] ) , @xmath430 , can often be computed analytically . if not , then it is most accurately computed as @xmath431 with @xmath17 , including @xmath122 as before to account for the slight loss of orthogonality in the basis functions .",
    "a.  a.  schekochihin , s.  c.  cowley , w.  dorland , g.  w.  hammett , g.  g.  howes , g.  g.  plunk , e.  quataert , t.  tatsuno .",
    "gyrokinetic turbulence : a nonlinear route to dissipation through phase space , plasma physics and controlled fusion 50 ( 2008 ) 124024 .",
    "m.  barnes , i.  abel , w.  dorland , d.  ernst , g.  hammett , p.  ricci , b.  rogers , a.  schekochihin , t.  tatsuno , linearized model fokker ",
    "planck collision operators for gyrokinetic simulations .",
    "numerical implementation and tests , physics of plasmas 16 ( 2009 ) 072107 .",
    "a.  j. cox , n.  j. higham , stability of householder qr factorization for weighted least squares problems , in : proceedings of the 17th dundee biennial conference , vol .",
    "380 of pitman research notes in mathematics , addison wesley longman , harlow , essex , uk , 1998 , pp ."
  ],
  "abstract_text": [
    "<S> we examine the merits of using a family of polynomials that are orthogonal with respect to a non - classical weight function to discretize the speed variable in continuum kinetic calculations . </S>",
    "<S> we consider a model one - dimensional partial differential equation describing energy diffusion in velocity space due to fokker - planck collisions . </S>",
    "<S> this relatively simple case allows us to compare the results of the projected dynamics with an expensive but highly accurate spectral transform approach . </S>",
    "<S> it also allows us to integrate in time exactly , and to focus entirely on the effectiveness of the discretization of the speed variable . </S>",
    "<S> we show that for a fixed number of modes or grid points , the non - classical polynomials can be many orders of magnitude more accurate than classical hermite polynomials or finite - difference solvers for kinetic equations in plasma physics . </S>",
    "<S> we provide a detailed analysis of the difference in behavior and accuracy of the two families of polynomials . for the non - classical polynomials , </S>",
    "<S> if the initial condition is not smooth at the origin when interpreted as a three - dimensional radial function , the exact solution leaves the polynomial subspace for a time , but returns ( up to roundoff accuracy ) to the same point evolved to by the projected dynamics in that time . </S>",
    "<S> by contrast , using classical polynomials , the exact solution differs significantly from the projected dynamics solution when it returns to the subspace . </S>",
    "<S> we also explore the connection between eigenfunctions of the projected evolution operator and ( non - normalizable ) eigenfunctions of the full evolution operator , as well as the effect of truncating the computational domain .    </S>",
    "<S> = 1    orthogonal polynomials , continuum kinetic calculations , fokker - plank collisions , sturm - liouville theory , continuous spectrum </S>"
  ]
}