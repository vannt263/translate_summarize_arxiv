{
  "article_text": [
    "over the past two decades , large galaxy redshift surveys , such as the sloan digital sky survey ( sdss ; @xcite ) , the two - degree field galaxy redshift survey ( 2dfgrs ; @xcite ) , the sdss - iii @xcite , and the wigglez dark energy survey @xcite , have enabled us to study in detail the large - scale structure of the universe probed by galaxies .",
    "galaxy clustering has become a powerful tool to study galaxy formation and evolution and to learn about cosmology . an informative way to interpret",
    "galaxy clustering is to link galaxies to the underlying dark matter halo population , whose formation and evolution are dominated by gravitational interaction and whose properties are well understood with analytic models and @xmath0body simulations .",
    "the commonly adopted descriptions of the connection between galaxies and dark matter haloes include the halo occupation distribution ( hod ; e.g. @xcite ) and the conditional luminosity function ( clf ; e.g. @xcite ) .",
    "the former specifies the probability distribution of the number of galaxies in a given sample as a function of halo mass , together with the spatial and velocity distribution of galaxies inside haloes .",
    "the latter specifies the luminosity distribution of galaxies as a function of halo mass .",
    "given a set of hod or clf parameters , with the halo population for a given cosmological model , galaxy clustering statistics can be predicted .",
    "such frameworks have been successfully applied to galaxy clustering data to infer the connection between galaxy properties and halo mass ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and to constrain cosmology ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "in particular , the main clustering statistic used is the two - point correlation function ( 2pcf ) of galaxies , which is the focus of this paper as well .",
    "halo properties , like their mass function and spatial clustering ( bias ) , can be understood analytically ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and @xmath0-body simulations also enable accurate fitting formulae to be obtained ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "based on these , analytic models of galaxy 2pcf can be developed .",
    "the basic idea is to decompose the 2pcf into contributions from intra - halo and inter - halo galaxy pairs .",
    "the intra - halo component , or the one - halo term , represents the highly nonlinear part of the 2pcf .",
    "the inter - halo component , or the two - halo term , can be largely modelled by linear theory .",
    "such analytic models have the advantage of being computationally inexpensive , and they can be used to efficiently probe the hod / clf and cosmology parameter space . however , as the precision of the 2pcf measurements in large galaxy surveys continues to improve , the requirement on the accuracy of the analytic models becomes more and more demanding . as pointed out in @xcite , an accurate model of the galaxy 2pcf needs to incorporate the nonlinear growth of the matter power spectrum ( e.g. * ? ? ?",
    "* ) , the halo exclusion effect , and the scale - dependent halo bias .",
    "in addition , the non - spherical shape of haloes should also be accounted for ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "these are just factors to be taken into account in computing the real - space or projected 2pcfs .",
    "for redshift - space 2pcfs , more factors come into play .",
    "an accurate analytical description of the velocity field of dark matter haloes in the nonlinear or weakly nonlinear regime proves to be difficult and complex ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    ". therefore , an accurate analytic model of redshift - space 2pcfs on small and intermediate scales is still not within reach .",
    "the above complications faced by analytic models can all be avoided or greatly reduced if the 2pcf calculation is directly done with the outputs of @xmath0-body simulations . with the simulation , dark matter haloes can be identified , and their properties ( mass , velocity , etc ) can be obtained . for a given set of hod / clf parameters , one can populate haloes with galaxies accordingly ( e.g. using dark matter particles as tracers ) and form a mock galaxy catalog . the 2pcfs measured from the mock catalog",
    "are then the model predictions used to model the measurements from observations .",
    "such a method of directly populating simulations have been developed and applied to model galaxy clustering data ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "this simulation - based model is attractive , as more and more large high - resolution @xmath0-body simulations emerge .",
    "it is also straightforward to implement .",
    "once the mock catalog is produced , measuring the 2pcfs can be made fast ( e.g. with tree code ) .",
    "however , populating haloes with a given set of hod / clf parameters is probably the most time - consuming step , as one needs to loop over all haloes of interest .",
    "in addition , information of individual haloes and tracer particles is needed , like their positions and velocities .",
    "even with only a subset of all the particles in a high - resolution simulation , the amount of data can still be substantial .",
    "the purpose of this paper is to introduce a method that takes the advantage of the simulation - based model , but being much more efficient in modelling galaxy clustering .",
    "the main idea is to decompose the galaxy 2pcfs and compress the information in the simulation by tabulating relevant clustering - related quantities of dark matter haloes .",
    "we also apply a similar idea to extend the commonly used sub - halo abundance matching method ( sham ; e.g. @xcite ) .",
    "the paper is structured as follows . in section  [",
    "sec : method ] , we formulate the method , within the hod / clf - like framework and within the halo / sub - halo framework . in section  [ sec : application ] , we show an example of modelling redshift - space 2pcfs , which also provides an understanding of the three - dimensional ( 3d ) small- and intermediate - scale galaxy redshift - space 2pcf and its multipoles by decomposing them into the various components . in section  [ sec : discussion ] , we summarize the method and discuss possible generalizations and limitations .",
    "in our simulation - based method , we divide haloes identified in @xmath0-body simulations into narrow bins of a given property , which determines galaxy occupancy . in the commonly used hod / clf ,",
    "the property is the halo mass . in our presentation , we use halo mass as the halo variable , but the method can be generalized to any set of halo properties .    the basic idea of the method is to decompose the galaxy 2pcf into contributions from haloes of different masses , from one - halo and two - halo terms , and from different types of galaxy pairs ( e.g. central - central , central - satellite , and satellite - satellite pairs ) .",
    "the decomposition also allows the separation between the halo occupation and halo clustering .",
    "the former relies on the specific hod / clf parameterization , while the latter can be calculated from the simulation .",
    "the method is to tabulate all relevant information about the latter for efficient calculation of galaxy 2pcfs and exploration of the hod / clf parameter space .",
    "we first formulate the method in the hod / clf framework .",
    "we then apply the similar idea to the sham case , which provides a more general sham method .",
    "let us start with a given @xmath0-body simulation and a given set of hod / clf parameters . to populate galaxies into a halo identified in the simulation",
    ", we can put one galaxy at the halo ` centre ' as a central galaxy , according to the probability specified by the hod / clf parameters .",
    "halo ` centre ' should be defined to reflect galaxy formation physics .",
    "for example , a sensible choice is the position of potential minimum rather than centre of mass . for satellites ,",
    "we can choose particles as tracers .",
    "in the usually adopted models , it is assumed that satellite galaxies follow dark matter particles inside haloes ( e.g. * ? ? ? * ; * ? ? ? * ; * ? ? ? * ) , rooted in theoretical basis ( e.g. * ? ? ? * ) .",
    "one can certainly modify the distribution profile as needed , and below we assume that the distribution of galaxies inside haloes has been specified and that the corresponding tracer particles have been selected for each halo .",
    "we divide haloes in the simulation into @xmath0 narrow mass bins and denote the mean number density of haloes in the mass bin @xmath1 as @xmath2 .",
    "the mean number density of galaxies is computed as @xmath3,\\ ] ] where @xmath4 and @xmath5 are the occupation numbers of central and satellite galaxies in a halo of mass @xmath6 , @xmath7 denotes the average over all haloes of this mass , and @xmath8 , ... , @xmath0 .    in the halo - based model , galaxy",
    "2pcf @xmath9 is computed as the combination of two terms , @xmath10 @xcite , where the one - halo term @xmath11 ( two - halo term @xmath12 ) are from contributions of intra - halo ( inter - halo ) galaxy pairs . following @xcite ,",
    "the one - halo term can be computed based on @xmath13 = \\sum_i \\ni \\langle n_{\\rm pair}(m_i)\\rangle f(\\vecr ; m_i ) d^3\\vecr .",
    "\\label{eqn : npair1h}\\ ] ] the left - hand side ( lhs ) is the number density of one - halo pairs with separation in the range @xmath14 from the definition of 2pcf .",
    "the right - hand side ( rhs ) is the same quantity from counting one - halo pairs in each halo and the summation is over all the halo mass bins . here",
    "@xmath15 is the total mean number of galaxy pairs in haloes of mass @xmath6 , and @xmath16 is the probability distribution of pair separation in haloes of mass @xmath6 , i.e. @xmath17 is the probability of finding pairs with separation in the range @xmath14 in haloes of @xmath6 . by further decomposing pairs into central - satellite ( cen - sat ) and satellite - satellite ( sat - sat ) pairs , we reach the following expression , @xmath18 the functions @xmath19 and @xmath20 are the probability distributions of one - halo cen - sat and sat - sat galaxy pair separation in haloes of mass @xmath6 .",
    "they are normalized such that @xmath21 note that here and in what follows , the 2pcf can be either real - space , projected - space , redshift - space , or it can be the multipoles of the redshift - space 2pcf .",
    "the variable @xmath22 should be understood as pair separation in the corresponding space . for redshift - space clustering , we discuss how to specify velocity distribution of galaxies later .",
    "to compute the two - halo term , we add up all possible two - halo galaxy pairs , following the 2pcf decomposition from different pair counts in @xcite .",
    "similar to equation  ( [ eqn : npair1h ] ) , the total number density of two - halo pairs with separation in the range @xmath14 is @xmath23,\\ ] ] which is composed of two - halo central - central ( cen - cen ) pairs @xmath24[\\nj\\meanncenj d^3\\vecr ] \\nonumber\\\\ & & \\times [ 1+\\xihhcc(\\vecr ; \\mi,\\mj ) ] , \\label{eqn : ccpair2h}\\end{aligned}\\ ] ] two - halo cen - sat pairs @xmath25[\\nj\\meannsatj d^3\\vecr ] \\nonumber\\\\ & & \\times [ 1+\\xihhcs(\\vecr ; \\mi,\\mj ) ] , \\label{eqn : cspair2h}\\end{aligned}\\ ] ] and two - halo sat - sat pairs @xmath26[\\nj\\meannsatj d^3\\vecr ] \\nonumber\\\\ & & \\times [ 1+\\xihhss(\\vecr ; \\mi,\\mj ) ] .",
    "\\label{eqn : sspair2h}\\end{aligned}\\ ] ] in each of equations  ( [ eqn : ccpair2h])([eqn : sspair2h ] ) , the summation is over all halo mass bins ( i.e. @xmath8 , ... ,",
    "@xmath0 and @xmath27 , ... , @xmath0 ) .",
    "the three correlation functions on the rhs have the following meanings ",
    "@xmath28 is just the two - point cross - correlation function between ` centres ' ( positions to put central galaxies ) of haloes of masses @xmath29 and @xmath30 ( cen - cen ) ; @xmath31 is the two - point cross - correlation function between the ` centres ' of @xmath29 haloes and the satellite tracer particles in the ( extended ) @xmath30 haloes ( cen - sat ) ; @xmath32 is the two - point cross - correlation function between satellite tracer particles in the ( extended ) @xmath29 haloes and those in the ( extended ) @xmath30 haloes ( sat - sat ) . with @xmath33 , we reach the final expression for the two - halo term , @xmath34    equations  ( [ eqn : ng ] ) , ( [ eqn:1h ] ) , and ( [ eqn:2h ] ) lead to the method we propose .",
    "the quantities related to galaxy occupancy are specified by the hod / clf parameterization one chooses , while those related to haloes are from the simulation , independent of the hod / clf parameterization .",
    "we therefore can prepare tables for @xmath2 , @xmath35 , @xmath36 , @xmath28 , @xmath31 , and @xmath37 . for a given set of hod / clf parameters ,",
    "the predictions of galaxy 2pcfs can be obtained from performing the weighted summation over the tables .",
    "the tables are only prepared once , and we can then change the galaxy occupation as needed to compute galaxy 2pcfs for different galaxy samples and different sets of hod / clf parameters , which is much more efficient than populating galaxies into haloes by selecting particles .    since summation is used to replace integration in the method , we need to choose narrow halo mass bins ( @xmath38 is usually sufficient , as shown in section  [ sec : application ] ) .",
    "the @xmath2 table represents the halo mass function . to prepare the other tables that depend on pair separation , the bins of pair separation @xmath22 are best chosen to match the ones used in the measurements from observational data , which would naturally avoid any discrepancy related to the finite bin sizes . for haloes in each mass bin ,",
    "the @xmath39 and @xmath40 tables can be computed by using either all the particles in the haloes with the specified distribution or a random subset . for @xmath41 , @xmath42 , and @xmath43",
    ", we effectively compute the halo - halo two - point cross - correlation function with different definitions of halo positions . for @xmath41 ,",
    "halo positions are defined by our choice of ` centres ' . for @xmath31 ,",
    "we choose ` centres ' for @xmath29 haloes and positions of arbitrary tracer particles in @xmath30 haloes . for @xmath32 , positions of arbitrary tracer particles in both @xmath29 and @xmath30 haloes are chosen .",
    "we can use any number of tracer particles in each halo to do the calculation . for haloes with positions defined by the tracer particles",
    ", they can be thought as extended ( with positions having a probability distribution ) . on large scales , @xmath41 , @xmath42 , and @xmath43",
    "are the same , while on small scales , @xmath42 and @xmath43 are smoothed version of @xmath41 . note that in analytic models such differences are usually neglected . in computing the three halo - halo correlation functions , we do not need to construct random catalogs to find out the pair counts from a uniform distribution  in the volume @xmath44 of the simulation with periodic boundary conditions , the counts of cross - pairs at separation in the range @xmath14 between two randomly distributed populations with number densities @xmath2 and @xmath45 are simply @xmath46 . making use of this fact",
    "can greatly reduce the computational expense in preparing the tables .    for the redshift - space tables ,",
    "in addition to the halo velocities , one needs to specify the velocity distribution of galaxies inside haloes , which can be different from that of dark matter particles ( a.k.a .",
    "velocity bias ; e.g. @xcite ) .",
    "the difference can be parameterized by central and satellite velocity bias parameters ( e.g. * ? ? ?",
    "for a set of central and satellite velocity bias parameters and with a choice of the line - of - sight direction , we can obtain the redshift - space positions of the central galaxy and satellite tracer particles according to halo velocities and central and satellite galaxy velocity distributions inside haloes , and the redshift - space tables can be computed .",
    "we suggest to prepare tables for different sets of central and satellite velocity bias parameters and interpolate among tables to probe the velocity bias parameter space , as is done in @xcite .",
    "multipole moments of redshift - space galaxy 2pcfs are usually modelled .",
    "we can derive the corresponding tables by computing the corresponding multipole moments of @xmath39 , @xmath40 , @xmath41 , @xmath42 , and @xmath43 .",
    "in such a case , @xmath47 is expressed by @xmath48 and @xmath49 , the cosine of the angle between @xmath22 and the line - of - sight direction . in the integration ( summation ) for obtaining the multipoles , the bins of @xmath49 match those used in observational measurements to remove any finite - bin - size effect .    for modelling the projected 2pcf @xmath50 , a corresponding set of tables",
    "can be obtained by integrating the redshift - space tables over the line - of - sight separation .",
    "the integration is done in the same way as in the measurements with data to avoid any finite - bin - size effect , summing over the same line - of - sight bins ( with the same bin size ) up to the same maximum line - of - sight separation .",
    "the sham method uses more information from ( high - resolution ) simulations , including both distinct haloes and subhaloes identified inside distinct haloes , where the distinct haloes refer to haloes that are not subhaloes of another halo .",
    "distinct haloes are also referred to as haloes , main haloes , or host haloes .",
    "central galaxies are hosted by distinct haloes at the centres , while satellite galaxies are in subhaloes . before merging into distinct haloes , subhaloes are distinct haloes themselves .",
    "the sham method generally works in the following way . by adopting one property , subhaloes and distinct haloes",
    "can be treated as a unified entity . for distinct haloes ,",
    "the property is evaluated at the time of interest . for subhaloes",
    ", it becomes common practice to evaluate the property at the time when subhaloes were still distinct haloes .",
    "the properties commonly used include mass ( @xmath51 ) at the time a subhalo was accreted into a host halo , maximum circular velocity @xmath52 at the time of accretion , and peak maximum circular velocity @xmath53 over the history of the subhalo as a distinct halo .",
    "the connection between haloes / subhaloes and galaxies is established by rank ordering haloes / subhaloes according to the given property and galaxies according to one certain property ( e.g. luminosity or stellar mass ) .",
    "when normalized to the same survey / simulation volume , halo / subhalo and galaxy of the same rank are linked .",
    "a more general treatment also accounts for the scatter between the halo / subhalo property and the galaxy property .",
    "the simple procedure of linking light ( galaxies ) to matter ( haloes / subhaloes ) can provide a reasonable interpretation of galaxy clustering trend and enable a study of galaxy evolution ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "we generalize the idea in section  [ sec : particle ] to the subhalo case , extending the sham model and making it efficient to model galaxy clustering .",
    "the model allows the scatter between the halo / subhalo property and the galaxy property to be different for distinct haloes ( central galaxies ) and subhaloes ( satellite galaxies ) .",
    "we use mass as the halo / subhalo property variable here , which can be understood as the mass at accretion ( @xmath51 ) .",
    "however , it can be replaced by any property one chooses to adopt , e.g. @xmath52 and @xmath53 . a halo / subhalo method following a similar spirit of pair decomposition to model the projected galaxy 2pcf and weak lensing signal is presented in @xcite and @xcite .",
    "compared to the commonly used sham method that connects the whole range of galaxy property and halo / subhalo property , the method presented here works for each individual galaxy sample . to some degree",
    ", it is formulated in an hod / clf - like form , with distinct haloes and subhaloes as tracers of central and satellite galaxies , respectively .",
    "it is no longer limited to _ abundance _ matching . instead",
    ", the method can be used to fit both galaxy abundance and galaxy clustering ( 2pcfs ) .    for a given galaxy sample",
    ", the scatter between halo / subhalo property and galaxy property means that not all haloes / subhaloes are fully occupied by these galaxies , which can be characterized by the probability of occupancy ( or the smaller - than - unity mean occupation number ) .",
    "denote the mean occupation number of central galaxies in distinct haloes of mass @xmath54 as @xmath55 and that of satellite galaxies in subhaloes of mass @xmath56 as @xmath57 .",
    "the same bins of mass are adopted for @xmath54 and @xmath56 . in principle",
    "we do not need to differentiate @xmath56 and @xmath54 , since the scripts of ` c ' ( cen ) and ` s ' ( sat ) below make the situation self - explanatory .",
    "let the mean number densities of distinct haloes and subhaloes in the mass bin @xmath1 be @xmath58 and @xmath59 , respectively .    for a given sample of galaxies , with a model of @xmath60 and @xmath61 ,",
    "the mean number density of galaxies @xmath62 is computed as @xmath63.\\ ] ] with a similar decomposition as in equation  ( [ eqn:2h ] ) , the galaxy 2pcf can be computed as @xmath64 which simply states that the total number of galaxy pairs is the sum of cen - cen , cen - sat , and sat - sat pairs .",
    "the three correlation functions on the rhs have the following meanings ",
    "@xmath65 is just the two - point cross - correlation function between centres of distinct haloes of masses @xmath29 and @xmath30 ; @xmath66 is the two - point cross - correlation function between centres of @xmath29 distinct haloes and those of @xmath30 subhaloes ; @xmath67 is the two - point cross - correlation function between centres of subhaloes of masses @xmath29 and @xmath30 .",
    "unlike the particle case in section  [ sec : particle ] , there are no explicit one - halo and two - halo terms here ( though they can be derived ) , and the @xmath68 condition is not imposed in the summation .",
    "the quantities @xmath60 and @xmath69 come from the occupation function model , which is up to our choice of parameterization for the sample of galaxies . in this halo / subhalo - based method",
    ", we only need to prepare tables for @xmath58 , @xmath59 , @xmath65 , @xmath66 , and @xmath67 .    as with the tables using particles",
    "( section  [ sec : particle ] ) , for redshift - space 2pcf or multipole moments , tables for different sets of central and satellite velocity bias parameters can be prepared . for each set , haloes and subhaloes",
    "are shifted to redshift - space positions for calculation .",
    "tables can also be generated for modelling the projected 2pcf @xmath50 .",
    "the procedures and bins used in the measurements should be followed so that the model and measurements are made fully consistent .",
    "the method developed here has been successfully applied to model projected and redshift - space 2pcfs of sdss and sdss - iii galaxies on small to intermediate scales ( e.g. @xcite ) and to compare hod and sham models ( guo et  al . in prep . ) . as the method",
    "is built on the basis of decomposition of galaxy 2pcfs , here we provide an example to illustrate the different 2pcf components . in particular , we show the components for the redshift - space 3d 2pcf and the manifestation of redshift - space distortions in each component to have a better understanding of the redshift - space 2pcfs within the hod framework .",
    "in addition , we also investigate how redshift - space 2pcfs help with hod constraints , including the inference of the galaxy velocity distribution inside haloes .",
    "the example adopts hod parameters for the sample of @xmath70 cmass galaxies in the the sdss - iii baryon oscillation spectroscopic survey ( boss ; @xcite ) . with spherical overdensity haloes and halo particles from the @xmath71 output of the multidark simulation ( mdr1 ; @xcite ) ,",
    "we create tables for halo properties , including halo number density @xmath72 ( i.e. halo mass function ) , projected 2pcf @xmath50 , redshift - space 2pcf monopole @xmath73 , quadrupole @xmath74 , and hexadecapole @xmath75 .",
    "we choose the position of the potential minimum as the centre of each halo for putting the central galaxy and halo particles as tracers of satellites .",
    "each of @xmath50 and @xmath76 has five components ( one - halo cen - sat , one - halo sat - sat , two - halo cen - cen , two - halo cen - sat , and two - halo sat - sat ) . to generate the @xmath77 tables",
    ", we measure @xmath78 for each component and for each combination of halo mass bins and sum over the @xmath79 direction , where @xmath80 and @xmath79 are the pair separations in the directions perpendicular and parallel to the line - of - sight direction ( chosen to be one principle direction of the simulation box ) .",
    "to generate the @xmath76 tables , we measure @xmath81 for each component and for each combination of halo mass bins and form the multipoles by integrating over @xmath49 , where @xmath82 is the redshift - space pair separation and @xmath49 the cosine of the angle between pair displacement and the line - of - sight direction . following the setup in the observational measurements @xcite",
    ", we have 19 bins for @xmath80 and @xmath82 uniformly spaced in logarithmic space , 50 linearly spaced bins in @xmath79 and 20 linearly spaced bins in @xmath49 . for halo mass bins , we use @xmath38 .",
    "we construct tables for 5 bins of central velocity bias parameter @xmath83 and 8 bins of satellite velocity bias parameter @xmath84 , respectively .",
    "the total size of the final set of tables is about 10 gb . that is , the information in the high - resolution simulation output relevant for modelling projected and redshift - space 2pcfs of galaxies has been tremendously compressed , making the modelling tractable even with a desktop computer .    for the hod",
    ", we adopt the common parameterization for a sample of galaxies above a luminosity threshold @xcite .",
    "the mean occupation function of central galaxies in haloes of mass @xmath6 is @xmath85,\\ ] ] where @xmath86 is the error function . for the mean occupation function of satellite galaxies ,",
    "we use @xmath87 the number of satellites in haloes of mass @xmath6 is assumed to follow the poisson distribution with the above mean .",
    "in addition , for modelling redshift - space 2pcfs , we have two additional hod parameters @xmath83 and @xmath84 for central and satellite velocity bias .",
    "essentially , @xmath83 ( @xmath84 ) is the ratio of the velocity dispersion of central ( satellite ) galaxies to that of dark matter particles inside halos ( see @xcite ) . for the fiducial model",
    ", we adopt the set of parameters that fit the projected and redshift - space 2pcfs for the cmass sample in @xcite  @xmath88 , @xmath89 , @xmath90 , @xmath91 , @xmath92 , @xmath93 , and @xmath94 .",
    "halo masses are in units of @xmath95 .    with the tables and the fiducial hod parameters , we follow equations  ( [ eqn : ng ] ) , ( [ eqn:1h ] ) , and ( [ eqn:2h ] ) to compute all the components of @xmath50 and @xmath76 . for the purpose of a sanity check",
    ", we also measure the components from 100 mock galaxy catalogs .",
    "the mock catalogs are generated from populating haloes in the simulation by putting central galaxies at the potential minimum in haloes and drawing random dark matter particles as satellite galaxies , in accordance with the occupation distributions and velocities set by the fiducial hod parameters .",
    "for the purpose of comparison with the model based on the tables , we decompose the galaxy 2pcf ( either @xmath50 or @xmath76 ) measured in the mock catalogs into five components , @xmath96 the first two terms on the rhs are one - halo terms  @xmath97 and @xmath98 are the mean number densities of one - halo cen - sat pairs and one - halo sat - sat pairs measured in the mock catalogs , and @xmath99 and @xmath100 are the normalized average distributions of one - halo cen - sat and sat - sat pairs in the mock .",
    "the last three terms on the rhs are two - halo terms  @xmath101 and @xmath102 are the mean number densities of central and satellite galaxies in the mock , and @xmath103 , @xmath104 , @xmath105 are the 2pcfs by counting only two - halo cen - cen , cen - sat , and sat - sat pairs @xcite .",
    "figure  [ fig : wpxi024 ] shows the decomposition of @xmath50 and @xmath76 for the fiducial model .",
    "as expected , the calculations from the simulation - based method ( curves ) agree with the measurements from the mock catalogs ( circles ) , which is reassuring . for the projected 2pcf @xmath50 ( top - left panel ) , the one - halo cen - sat term ( red ) dominate the small - scale signal .",
    "the one - halo sat - sat term ( magenta ) extends to larger scales , since the maximum sat - sat pair separation in a halo is the diameter of the halo , twice that of the cen - sat pair separation .",
    "owing to the low satellite fraction ( @xmath106 ) of this sample of galaxies , the contribution of the one - halo sat - sat pairs to @xmath50 is overall small , but noticeable around @xmath107 , the one - halo to two - halo term transition scales . on large scales ,",
    "the three two - halo terms have a similar shape , since they essentially follow the halo - halo correlation .",
    "the flattening towards small scales are caused by the halo exclusion effect .",
    "compared to the two - halo cen - cen component , the two - halo cen - sat is smoothed on small scales , since each halo contributing the satellite of the cen - sat pair on average is extended instead of a point source ( the case for the halo contributing the central galaxy of the pair ) as a result of the spatial distribution of satellites inside haloes .",
    "the two - halo sat - sat term is even more smoothed , since every halo becomes extended . to see the relative contribution of each term to the large - scale 2pcf",
    ", we note that in equation  ( [ eqn : xigg ] ) , @xmath108 , @xmath109 , and @xmath110 on large scales , where @xmath111 and @xmath112 are the large - scale bias factors for central and satellite galaxies , respectively .",
    "since satellites on average reside in more massive haloes than central galaxies , the value of @xmath112 is higher than that of @xmath111 ( roughly by tens of per cent for luminosity - threshold samples ) . from equation  ( [ eqn : xigg ] ) , we see that the relative contributions to the large - scale 2pcf from the two - halo cen - cen , cen - sat , and sat - sat terms are 1 : @xmath113 : @xmath114 , with @xmath115 the satellite to central galaxy number density ratio and @xmath116 the satellite to central galaxy bias ratio . for the sample",
    "we consider , the ratios are 1 : 25% : 1.6% . for lower luminosity samples with higher satellite fractions",
    ", we expect the contributions from the two - halo cen - sat and sat - sat to be substantially higher .    the decomposition of the redshift - space 2pcf monopole @xmath73 ( top - right panel ) and the relative amplitudes of the various terms are similar to the case of @xmath50 .",
    "the bottom two panels show the case of quadrupole @xmath74 and hexadecapole @xmath75 , and a factor @xmath117 is multiplied for each term so that both the small - scale and large - scale signals can reasonably show up .",
    "the fingers - of - god effect @xcite from one - halo terms causes a positive quadrupole . in the @xmath74 panel",
    ", we see that the influence of the one - halo terms can extend to about 10@xmath118 in the quadrupole .",
    "the negative quadrupole on large scales manifests the kaiser effect @xcite caused by the coherent motion of haloes , falling into overdense regions and streaming out of underdense regions .",
    "the two - halo cen - cen term dominates the large - scale quadrupole , but the cen - sat term is also important .",
    "both terms show low positive quadrupole signals toward small scales caused by the random motion of haloes ( and galaxies ) .",
    "the two - halo sat - sat term makes an almost negligible contribution to the quadrupole on all scales .",
    "the hexadecapole @xmath75 ( bottom - right panel ) are mostly positive from all components .",
    "the relative contributions from different components are similar to the quadrupole case .    the projected 2pcf and the redshift - space 2pcf multipoles are usually the quantities to model .",
    "the 3d redshift - space 2pcf measurements are commonly displayed as contours of @xmath78 , which make the redshift - space distortion effects on all scales easily visualized .",
    "it would be instructive to have the corresponding one - halo and two - halo components to gain a better intuition about the redshift - space distortions . figure  [ fig : xi3d ] shows such a decomposition measured from the mock catalogs , which can also be calculated using the @xmath78 component tables .",
    "the leftmost panel shows the total redshift - space 2pcf of the sample , with the fingers - of - god and kaiser effects clearly seen .",
    "the fingers - of - god effect , limited to small transverse separation @xmath80 , is mainly contributed by the one - halo terms ( two middle panels on the top ) .",
    "the one - halo sat - sat component appears to be more extended than the one - halo cen - sat component in both the transverse and the line - of - sight direction . in the transverse direction , it can be explained by the fact that the largest one - halo sat - sat ( cen - sat ) pair separation is about the diameter ( radius ) of the largest haloes . in the line - of - sight direction ,",
    "the elongation is mainly a result of galaxy motion inside haloes .",
    "the relative line - of - sight velocity of sat - sat pairs are higher than that of cen - sat pairs , causing the one - halo sat - sat component to be more extended ( shallower profile as a function of @xmath79 ) . the total one - halo term ( rightmost panel on the top )",
    "is dominated by the cen - sat and sat - sat component at small @xmath80 and slightly large @xmath80 , respectively .",
    "the three two - halo components and the total two - halo term are shown in the bottom panels of figure  [ fig : xi3d ] . in each component , the double - hump feature at small @xmath80 reflects the halo - exclusion effect .",
    "the effect would lead to a hole at the centre if the real - space 2pcf were plotted here .",
    "the shift in the line - of - sight galaxy positions in redshift space from galaxy peculiar motion makes the hole partially filled .",
    "the two - halo cen - cen component shows an overall kaiser squashing effect along the line of sight .",
    "however , the contours at small @xmath80 are elongated along the line of sight , like the fingers - of - god effect .",
    "this is caused by the random motion of haloes and that of central galaxies with respect to haloes ( i.e. a non - zero central velocity bias ) .",
    "the two - halo cen - sat component shows a much stronger line - of - sight elongation up to a few mpc in @xmath80 .",
    "the reason lies in the motion of satellites inside haloes , which causes the average redshift - space distribution of satellites appears extended along the line of sight in an average halo hosting the satellites of the two - halo cen - sat pairs .",
    "the line - of - sight elongation pattern is even stronger in the two - halo sat - sat component  the correlation of elongated haloes ( as a result of the redshift - space spatial distribution of satellites inside haloes ) completely suppresses the kaiser effect even on the largest scales shown here ( @xmath119 ) .",
    "the total two - halo term is dominated by the cen - cen component with a substantial contribution from the cen - sat component .",
    "the sat - sat component does not make an important contribution for this sample . as discussed before , we expect the two - halo cen - sat and sat - sat components to become more important for galaxy samples with lower luminosity thresholds and higher satellite fractions .    overall , for the 3d redshift 2pcf @xmath78 different components of the one - halo and two - halo terms have different transverse range of the line - of - sight elongation .",
    "the profile along the line of sight also depends on the type of pairs in consideration , becoming increasingly shallower from cen - cen , cen - sat , to sat - sat components . for each component , the streaming model ( e.g. * ? ? ?",
    "* ) usually adopted in simple models of redshift - space distortions should work well , which is kind of a convolution of the real - space 2pcf with a velocity dispersion kernel .",
    "for the total redshift - space 2pcf , our results indicate that it is hard to use a single velocity dispersion kernel to accurately model the redshift - space distortion effect .",
    "the different components are needed if one wishes to develop an accurate analytic model ( e.g. * ? ? ?",
    "* ) .    finally , we investigate the constraints on the hod parameters from projected and redshift - space 2pcfs .",
    "the 2pcfs predicted from the fiducial set of hod parameters are used as the input measurements , and the full covariance matrix from @xcite measured from the cmass data is adopted . the model uncertainty caused by the finite volume of the simulation",
    "is also accounted for by rescaling the covariance matrix ( see appendix  [ sec : appendix ] ) .",
    "we employ a monte carlo markov chain method to explore the parameter space of the 7 hod parameters , @xmath120 , @xmath121 , @xmath122 , @xmath123 , @xmath124 , @xmath83 , and @xmath84 .",
    "we first model the projected 2pcf @xmath50 only .",
    "the first five parameters related to the galaxy mean occupation function can be constrained , while there are virtually no constraints on the velocity bias parameters ( @xmath83 and @xmath84 ) as the line - of - sight information is lost . we then jointly model @xmath50 and the redshift - space 2pcf multipoles @xmath76 .",
    "we find that redshift - space 2pcfs help tighten the constraints mainly in @xmath120 and @xmath121 , the two parameters for the mean occupation function of central galaxies . in the left panel of figure  [ fig : hod ]",
    ", we compare the constraints ( marginalized 1@xmath125 and 2@xmath125 contours ) from @xmath50 only ( blue ) and @xmath50+@xmath76 ( black ) .",
    "the constraints on the parameters for the mean occupation function of satellite galaxies are only slightly improved , mainly in @xmath122 . in general , compared to the @xmath50-only case , redshift - space 2pcfs do not lead to a substantial improvement in the hod parameters related to the occupation function .",
    "the reason may be related to the fact that the projected 2pcf @xmath50 is not independent of the redshift - space 2pcfs , and that the information content in @xmath76 to constrain the occupation - related parameters is largely overlapped with that in @xmath50 . the correlated information in @xmath50 and @xmath76 is embedded in the covariance matrix .",
    "therefore , when jointly modelling @xmath50 and @xmath76 , it is important to use the full covariance matrix including the covariances between @xmath50 and @xmath76 to avoid double counting the information content and artificially tightening the hod constraints .",
    "the redshift - space distortions are caused by the peculiar motion of galaxies .",
    "the peculiar motion of haloes is in the simulation and built in the tables .",
    "so modelling redshift - space 2pcfs lead to constraints of galaxy motion inside haloes , i.e. the central and satellite velocity bias parameters .",
    "the right panel of figure  [ fig : hod ] shows that velocity bias parameters can be clearly detected for the fiducial sample .",
    "velocity bias parameters have been constrained from redshift - space clustering for the @xmath70 boss cmass galaxies @xcite and @xmath126 sdss main galaxies ( see @xcite and @xcite for applying the modelling method based on simulation particles and subhaloes , respectively ) . more discussions on the velocity bias constraints and the implications can be found in @xcite .",
    "in this paper , we introduce a simulation - based method to accurately and efficiently model galaxy 2pcfs in projected and redshift spaces .",
    "the basic idea is to make use of a high - resolution simulation and tabulate all the halo information necessary for galaxy clustering calculation . then on top of the tables , galaxy 2pcfs can be computed with the galaxy - halo relation specified by the hod or clf model .",
    "we also provide a version that applies to and extends the sham method .",
    "based on the method , we also study the decomposition of the projected and redshift - space galaxy 2pcfs into different components according to the type of galaxy pairs .",
    "the proposed method is accurate , since it is directly based on high - resolution simulations .",
    "the effects like halo exclusion , nonlinear evolution , scale - dependent halo bias , and non - sphericity of haloes , which are difficult to deal with in analytic methods of computing galaxy 2pcfs , are all automatically accounted for in the simulation - based method .",
    "the method also breaks the 2pcfs into all the one - halo and two - halo components based on the nature of galaxy pairs and computes each component accurately , which are usually not the case in analytic methods ( especially for the two - halo term ) . when building the tables , the same binning scheme ( in pair separation and in angle ) and the same integration procedure as used in the observation measurements",
    "are adopted , so there is no binning - related issue when comparing the model prediction with the measurements .",
    "the method is equivalent to measure the model galaxy 2pcfs from mock catalogs and is as accurate as what the mean mock catalog can achieve .",
    "the mock catalogs are constructed by populating galaxies ( using tracer particles ) to haloes identified in the simulation , according to the halo occupation specified by the hod / clf model . however , the method is more efficient , as it avoids the construction of mock catalogs and the measurement of the 2pcfs from the mocks .",
    "instead , ` populating galaxies ' and ` measuring the 2pcfs ' are performed analytically within the hod / clf framework .",
    "this greatly reduces the computational time and make it possible to efficiently explore the parameter space when modelling the 2pcf data .",
    "a similar method working in fourier space can be easily developed to model galaxy redshift - space power spectrum .",
    "the method can also be generalized to other clustering statistics , e.g. angular 2pcf of galaxies , two - point cross - correlation function of galaxies , and galaxy - galaxy lensing . generalizing the method to three - point correlation function ( 3pcf ) of galaxies",
    "is also possible . in principle , there are more components for the 3pcf  cen - sat - sat and sat - sat - sat triplets for the one - halo term , cen-(cen - sat ) , cen-(sat - sat ) , sat-(cen - sat ) , and sat-(sat - sat ) triplets for the two - halo term ( the pair in the parentheses is in the same halo ) , and cen - cen - cen , cen - cen - sat , cen - sat - sat , and sat - sat - sat triplets for the three - halo term .",
    "more importantly , compared to the 2pcf case , the dimension of each 3pcf component table will increase ( e.g. two sides and the angle in between for a triangle configuration and three halo mass indices ) . to make such a method suitable for the 3pcf modelling ,",
    "further simplification is necessary , e.g. through multipole or fourier expansion ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    to make use of the high precision of small- to intermediate - scale 2pcfs measurements to help constrain cosmological parameters ( e.g. * ?",
    "* ; * ? ? ?",
    "* ) , a set of tables need to be prepared based on simulations with different cosmological parameters or by rescaling one simulation to different cosmological models ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "? * ; * ? ? ?",
    "* ; * ? ? ?",
    "even with one cosmological model , there may be situations that need more tables .",
    "for example , in the particle - based model , random particles are selected to trace satellite galaxies by default .",
    "however , the difference between the spatial distributions of satellites and dark matter can be an additional parameter to be constrained .",
    "for such a purpose , one needs to build different sets of tables using tracer particles of different distributions . in either of the above cases ( or any case that needs to extend the tables )",
    ", the total size of the tables would have an order - of - magnitude increase .",
    "compared with methods of directly populating simulations , such an increase in table size is still reasonable and manageable .    with one simulation , we do not have the global or ensemble average properties of haloes .",
    "that is , the model with one simulation has uncertainty caused by the finite volume effect .",
    "one can use multiple simulations with different realizations of the initial conditions to build the average tables , which reduces the model uncertainty .",
    "the model uncertainty should be included in modelling data . in appendix",
    "[ sec : appendix ] , we show that this can be done by rescaling the covariance matrix of the measurements based on the ratio of simulation and survey volume . for any simulation , the fluctuation modes with wavelengths longer than the box size are missing , so the application of our modelling method should be limited to scales much smaller than the simulation box size .",
    "this is particularly true for redshift - space distortion modelling , since the velocity field is more sensitive to large - scale modes than the density field .    in presenting the method ,",
    "the halo variable is adopted to be halo mass ( or characteristic velocity for the subhalo case ) to build the tables .",
    "the corresponding hod / clf model assumes that the statistical properties of galaxies inside haloes only depend on halo mass , not on halo environment or growth history .",
    "clustering of haloes at fixed mass is found to depend on the assembly history ( a.k.a .",
    "assembly bias ; e.g. @xcite ) .",
    "there is room for the galaxy content in haloes of fixed mass to depend on halo formation history , which would affect galaxy clustering and hod constraints ( e.g. * ? ? ?",
    "* ) , although no clear evidence is found in hydrodynamic galaxy formation simulations ( e.g. * ? ? ?",
    "* ) or galaxy clustering measurements ( e.g. * ? ? ? * ) .",
    "as mentioned in section  [ sec : method ] , the halo variable in our method is not necessarily the halo mass",
    ". it can certainly be a set of variables , like halo mass plus a variable characterizing halo formation history ( e.g. halo concentration or formation redshift ) . with tables built in terms of the set of variables , along with an hod / clf model depending on these variables",
    ", the simulation - based method works in the same way as presented in this paper .",
    "however , the efficiency of the method drops sharply when including more halo variables .",
    "the limitation is mainly set by the computation of the two - halo terms , where both the table size and computational time scale as @xmath127 , with @xmath0 the total number of bins in halo properties ( e.g. with @xmath128 halo mass bins and @xmath129 halo formation time bins , @xmath130 ) . in practice",
    ", we may be barely able to accomodate the case of two halo variables , by choosing bin sizes to minmize the table size and computational cost without sacrificing the accuracy of the method . before resorting to directly populating the simulations ,",
    "a possible way of circumventing the limitation is to use some combination of halo variables , reducing the problem to one effective halo variable .",
    "certainly further investigations are needed to find the appropriate combination(s ) .",
    "a different approach to model galaxy clustering is through an emulator ( e.g. * ? ? ?",
    "* ) . with this approach ,",
    "galaxy correlation functions are first obtained with mock catalogs from @xmath0-body simulations , spanning a range of hod parameters .",
    "then the emulator works by interpolation to predict the galaxy correlation function for any given set of hod parameters .",
    "compared to the method we propose in this paper , the emulator can be extremely fast , since it only performs interpolations and avoids any calculation at the level of dark matter haloes . in principle",
    ", the emulator can be generalized to interpolate among the one - halo and two - halo component contributions to the 2pcfs .",
    "however , by construction , the emulator only operates with a certain hod form and within a certain range of hod parameters for the interpolation to work and for the accuracy to be under control .",
    "the method we propose performs direct calculations with clear physical meanings based on halo properties , and therefore it does not suffer from the above restrictions of an emulator .    with increasingly more precise measurements of galaxy clustering from forthcoming large galaxy surveys , such as desi @xcite and euclid @xcite",
    ", we expect that the accurate and efficient modelling method introduced in this work and its generalizations will have great potentials and wide applications .",
    "zz is partially supported by nsf grant ast-1208891 .",
    "hg acknowledges the support of nsfc-11543003 and the 100 talents program of the chinese academy of sciences .    [ 2]#2 [ 1]http://arxiv.org / abs/#1[arxiv:#1 ]    r.  e. , white s.  d.  m. , 2010 , , 405 , 143    p.  s. , wechsler r.  h. , conroy c. , 2013 , , 770 , 57    a.  a. , weinberg d.  h. , 2002 , , 575 , 587    a.  a. et  al . , 2003 , , 593 , 1    c. , kazin e.  a. , beutler f. et  al . , 2011 , , 418 , 1707    m. , van den bosch f.  c. , more s. , mo h. , yang x. , 2013 , , 430 , 767    m. , 1999 , rspta , 357 , 105    c. , wechsler r.  h. , kravtsov a.  v. , 2006 , , 647 , 201    c. , wechsler r.  h. , 2009 , , 696 , 620    k.  s. et  al . , 2013 , , 145 , 10    d.  j. , weinberg d.  h. , agol e. et  al .",
    "2011 , , 142 , 72    h.  a. , kaiser n. , peacock j.  a. , 1994 , , 426 , 23    l. , springel v. , white s.  d.  m. , 2005 , , 363 , l66",
    "h. et  al . , 2015a , , 446 , 578    h. et  al . , 2015b , , 449 , l95    h. et  al . , 2015c , , 453 , 4368    h. et  al . , 2015d , arxiv:1508.07012    h. et  al . , 2014 , , 441 , 2398    a.  j.  s. , 1992 , , 385 , l5    j.  p. , 1988",
    ", in dickey j.  m. , ed . , astronomical society of the pacific conference series vol .",
    "5 , the minnesota lectures on clusters of galaxies and large - scale structure . pp",
    "4170    j.  c. , 1972 , , 156 , 1p    a. , frenk c.  s. , white s.  d.  m. et  al .",
    ", 2001 , , 321 , 372    y.  p. , mo h.  j. , boerner g. , 1998 , , 494 , 1    y.  p. , suto y. , mo h.  j. , 2007 , , 657 , 664    n. , 1987 , , 227 , 1    j. , heitmann k. , habib s. , et  al . , 2015 , , 810 , 35    r. , amiaux j. , arduini s. et  al . , 2011 , arxiv e - prints ,    m. , bebek c. , beers t. et  al . , 2013 , arxiv e - prints ,    y .- t . , mandelbaum r. , huang y .- h . ,",
    "huang h .- j . , dalal n. , diemer b. , jian h .- y . , kravtsov a. , 2015 , arxiv e - prints ,    h.  j. , jing y.  p. , white s.  d.  m. , 1996 , , 282 , 1096    d. , kravtsov a.  v. , 2005 , , 618 , 557    e. , li c. , khochfar s. et  al . , 2011 , , 416 , 1486    e. , khochfar s. , 2012 , arxiv e - prints ,    j.  k. et  al . , 2013 , , 429 , 98    j.  a. , smith r.  e. , 2000 , , 318 , 1144    p.  j.  e. , 1980 , the large - scale structure of the universe    f. , klypin a.  a. , cuesta a.  j. , betancort - rijo j.  e. , primack j. , 2012 , , 423 , 3018    w.  h. , schechter p. , 1974",
    ", , 187 , 425    r.  m. , wechsler r.  h. , tinker j.  l. , behroozi p.  s. , 2013 , , 771 , 30    b.  a. , seo h .- j .",
    ", leauthaud a. , tinker j.  l. , white m. , 2014 , , 444 , 476    b.  a. , white m. , 2011 , , 417 , 1913    k. et  al . , 2013 , an , 334 , 691    r. , sheth r.  k. , hui l. , jain b. , 2001 , , 546 , 20    u. , 2000 , , 318 , 203    r.  k. , tormen g. , 1999 , , 308 , 119    r.  a. , coil a.  l. , mendez a.  j. , et al . , 2015 , , 807 , 152    z. , eisenstein d.  j. , 2015 , , 454 , 4142    r.  e. et  al .",
    ", 2003 , , 341 , 1311    i. , 2004 , , 605 , l89",
    "m. , 1997 , physical review letters , 79 , 3806    j.  l. , weinberg d.  h. , zheng z. , 2006 , , 368 , 85    j.  l. , 2007 , , 374 , 477    j.  l. , weinberg d.  h. , zheng z. , zehavi i. , 2005 , , 631 , 41    j. , kravtsov a.  v. , klypin a. et  al . , 2008 , , 688 , 709    j.  l. , robertson b.  e. , kravtsov a.  v. et  al .",
    ", 2010 , , 724 , 878    f.  c. , yang x.",
    "h. , mo h.  j. , 2003 , , 340 , 771    f.  c. , mo h.  j. , yang x.  h. , 2003 , , 345 , 923    f.  c. , more s. , cacciato m. , mo h. , yang x. , 2013 , , 430 , 725    r.  h. , zentner a.  r. , bullock j.  s. , kravtsov a.  v. , allgood b. , 2006 , , 652 , 71    m. et  al . , 2011 , , 728 , 126    x. , mo h.  j. , van den bosch f.  c. , 2003 , , 339 , 1057    d.  g. et  al . , 2000 , , 120 , 1579    i. et  al .",
    ", 2005 , , 621 , 22    i. et  al . , 2011 , , 736 , 59    a.  r. , hearin a.  p. , van den bosch f.  c. , 2014 , , 443 , 3044    z. , tinker j.  l. , weinberg d.  h. , berlind a.  a. , 2002 , , 575 , 617    z. , 2004a , , 610 , 61    z. , 2004b , , 614 , 527    z. et  al . , 2005 , , 633 , 791    z. , coil a.  l. , zehavi i. , 2007 , , 667 , 760    z. , weinberg d.  h. , 2007 , , 659 , 1    z. , zehavi i. , eisenstein d.  j. , weinberg d.  h. , jing y.  p. , 2009",
    ", , 707 , 554    g. , zheng z. , lin w.  p. , jing y.  p. , kang x. , gao l. , 2006 , , 639 , l5    y. , weinberg d.  h. , 2013 , , 431 , 3319    y. , zheng z. , zhu g. , jing y.  p. , 2008",
    ", , 686 , 41",
    "let us consider the case that we use a model built on one simulation in a volume @xmath131 ( ` m ' for model ) to interpret the observation obtained from a survey volume @xmath132 ( ` o ' for observation ) .",
    "what covariance matrix should we use to model the data ?",
    "the covariance matrix estimated for the observation tells us the covariance in the observational data .",
    "however , the model is based on a simulation with a finite volume , and therefore it is not the global model or the model from ensemble average .",
    "the model itself has uncertainty , and the modelling needs to account for this . to derive the effective covariance matrix @xmath133 to be used in the modelling ,",
    "let us define the @xmath134-th data point measured in the observational volume @xmath132 as @xmath135 , the @xmath134-th data point from the model with simulation volume @xmath131 as @xmath136 , and the global averages ( or the ensemble averages ) of the observational and model data points as @xmath137 and @xmath138 , respectively .",
    "note that for an accurate model that reflects the reality , we have @xmath139 .",
    "that is , the global model reproduces the global average observation .",
    "the effective covariance matrix with model uncertainty included is then @xmath140\\right .",
    "\\nonumber \\\\ & & \\,\\,\\left.\\left [ \\left(\\fvoj-\\foj\\right ) - \\left(\\fvmj-\\fmj\\right ) \\right ] \\right\\rangle \\label{eqn:2}\\\\ & = & \\left\\langle \\left(\\fvoi-\\foi\\right ) \\left(\\fvoj-\\foj\\right ) \\right\\rangle \\nonumber\\\\ & & + \\left\\langle \\left(\\fvmi-\\fmi\\right ) \\left(\\fvmj-\\fmj\\right ) \\right\\rangle \\nonumber\\label{eqn:3}\\\\ & & + \\left\\langle \\left(\\fvoi-\\foi\\right ) \\left(\\fvmj-\\fmj\\right ) \\right\\rangle \\nonumber\\\\ & & + \\left\\langle \\left(\\fvmi-\\fmi\\right ) \\left(\\fvoj-\\foj\\right ) \\right\\rangle .\\end{aligned}\\ ] ] the symbol @xmath141 denotes global / ensemble average over observations in volumes of @xmath132 and over models in volumes of @xmath131 . from ( [ eqn:1 ] ) to ( [ eqn:2 ] ) , we make use of the above @xmath139 relation . in ( [ eqn:3 ] ) ,",
    "the first term is the element @xmath142 of the covariance matrix for the measurements in volume @xmath132 , the second term is the element @xmath143 of the covariance matrix for the measurements in volume @xmath131 ( since the model values can be regarded as mock measurements ) , and both the third and fourth terms are zero ( since there is no correlation between observation measurements and mock measurements ) .",
    "we then have @xmath144 and the result is expected and intuitive .    for power spectrum or 2pcf measurements ,",
    "the covariance matrix element is inversely proportional to the volume @xcite",
    ". we can express the effective covariance matrix in equation  ( [ eqn : c_eff1 ] ) in terms of the one estimated for the observation and the relative volume of the simulation and observation , @xmath145"
  ],
  "abstract_text": [
    "<S> small- and intermediate - scale galaxy clustering can be used to establish the galaxy - halo connection to study galaxy formation and evolution and to tighten constraints on cosmological parameters . with the increasing precision of galaxy clustering measurements from ongoing and forthcoming large galaxy surveys , </S>",
    "<S> accurate models are required to interpret the data and extract relevant information . </S>",
    "<S> we introduce a method based on high - resolution @xmath0-body simulations to accurately and efficiently model the galaxy two - point correlation functions ( 2pcfs ) in projected and redshift spaces . </S>",
    "<S> the basic idea is to tabulate all information of haloes in the simulations necessary for computing the galaxy 2pcfs within the framework of halo occupation distribution or conditional luminosity function . </S>",
    "<S> it is equivalent to populating galaxies to dark matter haloes and using the mock 2pcf measurements as the model predictions . </S>",
    "<S> besides the accurate 2pcf calculations , the method is also fast and therefore enables an efficient exploration of the parameter space . as an example of the method , we decompose the redshift - space galaxy 2pcf into different components based on the type of galaxy pairs and show the redshift - space distortion effect in each component . </S>",
    "<S> the generalizations and limitations of the method are discussed .    </S>",
    "<S> cosmology : observations  cosmology : theory  galaxies : clustering  galaxies : distances and redshifts  galaxies : haloes  galaxies : statistics  large - scale structure of universe </S>"
  ]
}