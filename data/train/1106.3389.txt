{
  "article_text": [
    "it is well known that magnetic fields play an important role in various astrophysical phenomena , such as the formation of stars and planets , and high energy astrophysics .",
    "gas dynamics with a magnetic field is well described by magnetohydrodynamics ( mhd ) .",
    "the mhd equations are too complicated to solve analytically except for special cases , therefore to understand physical phenomena involving magnetic fields , numerical simulations are indispensable and powerful tools . a numerical technique to solve the mhd equations has been developed successfully in the form of the finite - volume methods by many authors",
    ".    smoothed particle hydrodynamics ( sph ) is a fully lagrangian particle method @xcite .",
    "this lagrangian nature has major advantages in problems that have a large dynamic range in spatial scale , such as the formation of large scale structures , galaxies , stars , and planets .",
    "several authors have tried to apply the sph method to mhd problems . in this paper , we call sph for mhd `` smoothed particle magnetohydrodynamics '' ( spmhd ) . @xcite have developed an one - dimensional spmhd scheme . to describe shock waves , they used artificial dissipation terms proposed by @xcite based on an analogy with riemann solutions of compressible gas dynamics .",
    "as the signal velocity , they adopted the speed of the fast wave , which is analogous to the sound wave in hydrodynamics ( hd ) .",
    "their spmhd has been shown to give good results on a wide range of standard one - dimensional problems used in recent finite - volume mhd schemes .",
    "* hereafter pm05 ) have developed a multi - dimensional spmhd scheme based on the above one - dimensional one .",
    "alternatively , @xcite and @xcite have implemented an spmhd scheme using a regularization of the underlying particle distribution and artificial viscosity .",
    "recently , @xcite have implemented mhd in the cosmological sph code _ gadget _",
    "@xcite mainly based on pm05 .",
    "broad discussions of the sph and spmhd are found in reviews by @xcite , @xcite , and @xcite .",
    "the spmhd in pm05 can capture fast shocks accurately .",
    "however , since they use the fast wave speed as the signal velocity in the artificial viscosity and resistivity terms , alfvn waves become dissipative . in the finite - volume method",
    ", it is well known that alfvn waves can not be described accurately if the characteristics of alfvn waves are not taken into account in the caluculation of the numerical flux ( e.g. , * ? ? ?",
    "this is also the case in spmhd . in this paper , we apply the godunov method to spmhd .",
    "the godunov method was originally developed in the finite - volume method @xcite .",
    "unlike artificial viscosity , the godunov method can , in principle , take into account the minimum and sufficient amount of dissipation without any free parameters . in hd , the application of the godunov method to sph has been carrried out by ( * ?",
    "* hereafter i02 ) . in mhd",
    ", we can also consider the general riemann problem ( rp ) with arbitrary directions of velocity and magnetic field in both sides .",
    "however , it is computationally expensive and complex to solve the rp because the mhd equations have seven characteristics and non - hyperbolicity .",
    "recently , @xcite have approximate riemann solver hllc into a variant particle method @xcite .",
    "besides the sph method , @xcite implemented mhd with the approximate riemann solver hlld @xcite in unstructured , moving - mesh code arepo code @xcite . in this paper , we use a simplified approach proposed for the finite - volume method by @xcite . in this method ,",
    "compressible and incompressible parts of the mhd equations are completely divided .",
    "the former is calculated by a non - linear riemann solver with magnetic pressure , and the latter is calculated by the method of characteristics ( moc ) proposed by @xcite .",
    "the paper is organized in the following ways . in section [ sec : spheq ] , we derive the spmhd equations from the basic equations of mhd . in section [ sec : implementation ] , we describe the implementation of the derived spmhd equations .",
    "various test calculations are demonstrated in section [ sec : test ] .",
    "this paper is summarized in section [ sec : summary ] .",
    "the basic equations of mhd can be written as @xmath0 @xmath1 where @xmath2 is the stress tensor , @xmath3 the specific total energy is given by @xmath4 @xmath5 $ ] is the specific internal energy , @xmath6 is the lagrangian time derivative , and we have chosen units so that factor of @xmath7 does not appear in the equations , where @xmath7 is the magnetic permeability .    in the sph method ,",
    "density field is expressed as @xmath8 where subscripts denote particle labels , @xmath9 is the mass of the @xmath10-th particle , @xmath11 is a kernel function , and @xmath12 is the smoothing length that is assumed to depend on @xmath13 .",
    "there are many choices of kernel functions . in the godunov sph ( gsph )",
    "schemes , i02 adopted the following gaussian kernel , @xmath14 where @xmath15 is the number of dimension .",
    "this is because the gaussian kernel makes the formulation of the gsph simpler than other kernel functions .",
    "in addition , the results with gaussian kernel seem to be better than those with the cubic spline kernel in test calculations shown in section [ sec : test ] . in this paper",
    ", we follow the choice in i02 .",
    "we define the equation for the evolution of the particle positions as @xmath16 where @xmath17 $ ] .",
    "substituting equation ( [ basic eq ] ) into equation ( [ eom1 ] ) , one obtains @xmath18 where we integrate by part .",
    "the first term on the right - hand side in equation ( [ eom2 ] ) becomes the surface integral by the gauss theorem , and vanishes when @xmath19 .",
    "with equation ( [ sph den ] ) , the last factor of equation ( [ eom2 ] ) becomes @xmath20 therefore , we can obtain the equation for the evolution of the particle positions , @xmath21      we define the equation for the evolution of the particle energy as @xmath22 substituting equation ( [ basic eq ] ) into equation ( [ eoe1 ] ) , one obtains @xmath23 using equation ( [ eom3 ] ) , we can obtain the energy equation of sph particles , @xmath24      the @xmath25-th sph particle is assigned its own magnetic field , @xmath26 .",
    "the equation for the evolution of the magnetic field is defined as @xmath27 substituting equation ( [ induc ] ) into equation ( [ induc1 ] ) , one obtains @xmath28 the right - hand side of equation ( [ induc2 ] ) can be transformed into the following expression : @xmath29 we approximate the last term on the right - hand side of equation ( [ induc2 ] ) as follows : @xmath30 using equations ( [ induc2 ] ) and ( [ induc3 ] ) and integrating by parts , one obtains the following equation for the evolution of the magnetic field : @xmath31",
    "we define @xmath32-axis as being along the vector @xmath33 .",
    "the unit vector in the @xmath32-direction is @xmath34 .",
    "the distance between @xmath25- and @xmath10-th particles is @xmath35 where @xmath36 and @xmath37 are the coordinates of the @xmath25- and @xmath10-th particles on the @xmath32-axis , respectively .",
    "we need to perform the volume integral in equations ( [ eom sph ] ) , ( [ eoe sph ] ) , and ( [ induc sph ] ) .",
    "if the smoothing length is spatially constant , the volume integral can be done analytically by interpolating physical variables @xcite . in a similar way",
    ", one can derive the gspmhd equations as follows : @xmath38 where @xmath39 @xmath40 , @xmath41 , and @xmath42 are the values at @xmath43 ( see * ? ? ?",
    "* ) , and @xmath44 is the time - centered velocity of the @xmath25-th particle . the quantity @xmath45 is obtained by the following integration @xmath46 where i02 used linear and cubic interpolations of @xmath47 .",
    "the detailed expression of @xmath45 is found in i02 .",
    "however , for the case with variable smoothing length , the volume integral can not be easily performed analytically .",
    "i02 proposed a simple approximation in which he used @xmath48 for the half of the integration space that includes @xmath49 and @xmath50 for the other half . in this case , @xmath51 becomes @xmath52 this formulation can capture contact discontinuities accurately @xcite . in this paper , just for simplicity , we use the following crude approximation in the volume integral of equations ( [ eom sph ] ) , ( [ eoe sph ] ) , and ( [ induc sph ] ) : @xmath53 using this , one can get @xmath54 where @xmath55 is an average of @xmath48 and @xmath50 .",
    "this paper adopts @xmath56 .",
    "the equation ( [ sph eqs ] ) do not include a dissipative process , which is required to describe shock waves .",
    "the godunov method uses the exact riemann solver to include the minimum and sufficient amount of dissipation into the scheme . in the finite - volume method ,",
    "the result of the riemann problem at cell interfaces is used in the calculation of numerical flux . in the gsph in i02 , the values @xmath57 and @xmath58 in equations ( 58 ) and ( 59 ) in his paper",
    "are replaced by the results of the rp between the @xmath25-th and the @xmath10-th particles . in the same way ,",
    "@xmath40 and @xmath59 are replaced by the results of the rp between the @xmath25-th and the @xmath10-th particles . in equation ( [ sph eqs ] ) , the projection of @xmath2 on the @xmath32-axis is found as follows : @xmath60 where @xmath61 , and component parallel ( perpendicular ) to @xmath62 is represented by using the subscript of @xmath63 ( @xmath64 ) . the first term on the right - hand side of equation ( [ projection ] ) represents the compressive term working alone the @xmath32-axis .",
    "in contrast , the second term represents the incompressible term working in the perpendicular direction . in the compressible part",
    ", we use the result of the non - linear rp without @xmath65 , which contains fast shocks , fast rarefaction waves , and one contact discontinuity . from the rp",
    ", one can obtain @xmath66 and @xmath67 .",
    "the detailed description is shown in appendix [ riemann ] . in the incompressible term , moc",
    "is used @xcite . from the moc",
    ", one can obtain @xmath68 and @xmath69 .",
    "the detailed description is shown in appendix [ moc ] .    in the calculation of the rp and the moc ,",
    "the initial values on each side at @xmath70 are required . in this paper , we adopt @xmath71 for simplicity . it is confirmed that the value of @xmath70 does not affect the results . to make a spatially second - order method",
    ", we consider the piecewise linear distribution of the physical variables .",
    "using the gradients , the initial values on each side of a one - dimensional rp are the average values of each domain of dependence : @xmath72\\ ] ] @xmath73\\ ] ] where @xmath74 , and @xmath75 is a characteristic speed . in the compressible rp , the speed of the fast wave @xmath76 is adopted . in the incompressible rp , the speed of the alfvn wave @xmath77 is adopted . in finite - volume methods with higher spatial accuracy ,",
    "we need to impose a monotonicity constraint on the gradients of the physical variable to obtain a stable description of discontinuities .",
    "this is the case in the gspmhd scheme .",
    "the detailed description of the monotonicity constraint adopted in this paper is shown in appendix [ app : mono ] .    in actual calculations ,",
    "we solve the following equation : @xmath78 where subscripts `` rp '' and `` moc '' indicate values evaluated using the rp and moc , respectively , and @xmath79 and @xmath80 .      in this paper ,",
    "the variable smoothing length is used to obtain large dynamic ranges .",
    "the smoothing length of the @xmath25-th particle is determined iteratively by @xmath81 where @xmath82 is a parameter .",
    "the density of the @xmath25-th particle is evaluated by @xmath83 the gaussian kernel is not truncated at a finite radius but has infinite range . in practical calculations , we ignore the contribution from the @xmath10-th to @xmath25-th particles if @xmath84 because @xmath85 is sufficiently small .",
    "the number of neighbours becomes @xmath86 in 1d , @xmath87 in 2d , and @xmath88 in 3d schemes . in this paper , we present the results of 2d test calculations and adopt @xmath89 , indicating that the average neighbour number is @xmath90 .      from equation ( [ projection ] )",
    ", one can see that the stress tensor can be negative when the plasma beta @xmath91 is low .",
    "this causes unphysical clumping of sph particles @xcite .",
    "this numerical instability is called `` tensile instability '' @xcite .",
    "the tensile instability arises from the fact that the sph expression of @xmath92 is not completely zero . in finite - volume methods",
    ", it is well known that nonzero @xmath92 produces an unphysical force along the magnetic field and causes large errors in the simulations when using conservative form @xcite .",
    "many authors proposed methods for vanishing @xmath93 , such as the projection method @xcite , the constrained transport @xcite , and so on .    in spmhd",
    ", @xmath93 inevitably has some amount of numerical noise that causes the tensile instability to occur even if divergence - cleaning methods are used in the conservation form @xcite .",
    "therefore , several methods have been proposed to suppress the tensile instability .",
    "@xcite proposed that the stress tensor make positive by subtracting an constant value from the stress tensor ( also see * ? ? ?",
    "as another approach , @xcite suggested that the monopole source terms are explicitly subtracted from the equation of motion and the energy equation as follows : @xmath94 and @xmath95 the left - hand side of equation ( [ eom corr ] ) corresponds to the lorentz force @xmath96 .",
    "this source terms significantly stabilize the tensile instability .",
    "this formulation is the same as so - called 8-wave formulations proposed by @xcite in the finite - volume method .",
    "this formulation is numerically stable , and the value of @xmath93 keeps zero within truncation error without any cleaning methods for simple test problems .",
    "however , in realistic 3d problems , satisfaction of the divergence constraint is not guaranteed .",
    "thus , we need to monitor the value of @xmath93 in actual calculations . to derive the gspmhd equations , we take the convolution of the source term in equation ( [ eom corr ] ) , @xmath97 using equation ( [ eom3 ] ) , one can get @xmath98 in a similar way , the energy equation is also obtains as @xmath99 the major disadvantage of this correction is violation of the momentum and the total energy conservation . actually , in all spmhd schemes without the tensile instability , the conservations of the momentum and/or total energy are sacrificed .      in spmhd",
    ", there are many choices of @xmath93 estimate . in this paper",
    ", we use the following expression : @xmath100 in order to estimate errors in the @xmath101 constraint , we monitor @xmath102 defined as @xmath103 where @xmath104 is the total number of the sph particles . this estimate is the same as that in the correction terms in section [ sec : corr ] . note that pm05 and @xcite adopted different choice , @xmath105 the divergence error estimated in equation ( [ divb1 ] ) tends to be smaller than those in equation ( [ divb ] ) .",
    "in this section , we show the results of test calculations in the two - dimensional gspmhd method , starting with the convergence test .      in this section , we check the accuracy of the gspmhd . a good problem for the convergence test is the propagation test of linear mhd waves in a uniform media .",
    "first , we define the unperturbed state . a uniform and rest gas is considered ( @xmath106 , @xmath107 , @xmath108 ) .",
    "the magnetic field is parallel to the @xmath109-direction , and its magnitude is @xmath110 .",
    "the simulations are performed in the square domain , @xmath111 $ ] .",
    "the particles are uniformly spaced on a cubic lattice with sides parallel to the @xmath109- and @xmath112-axes .",
    "a periodic boundary condition is imposed .",
    "we consider linear mhd waves having a wavenumber of @xmath113 , indicating that the simulation domain contains two wavelengths .",
    "it is well known that mhd linear waves consist of the fast , alfvn , and slow waves with phase velocities given by 1.4 , 0.5 , and 0.46 , respectively in this configuration .",
    "we add the initial perturbation based on the eigenmode . in the fast and slow modes ,",
    "all fluctuations lie in the @xmath114 plane .",
    "the amplitude of the density fluctuation is set to @xmath115 . in the alfvn wave , only @xmath116 and @xmath117",
    "the amplitude of the fluctuation of @xmath117 is set to @xmath115 .",
    "the vector component parallel ( perpendicular ) to the wavenumber is expressed in terms of the subscripts @xmath118 ( @xmath119 ) in the @xmath114 plane .    as a measure of the error",
    ", we introduce the error vector defined as @xmath120 where @xmath121 for the fast and slow waves , @xmath122 for the alfvn wave . as a reference solution , @xmath123",
    ", we adopt the results with @xmath124 . to eliminate the error coming from @xmath125 ,",
    "@xmath125 is set to the small value of @xmath126 in all resolutions .",
    "the error vector is evaluated after 100 time steps at various resolutions . in fig .",
    "[ fig : convergence ] , the norm of the error vector is plotted as a function of the average smoothing length , which represents the resolution for the fast ( the circles ) , alfvn ( triangles ) , and slow waves ( boxes ) . in the scheme having second - order of spatial accuracy , @xmath127 is expected to scale as @xmath128 .",
    "[ fig : convergence ] shows that the error is proportional to @xmath128 for all wave modes .",
    "therefore , it is confirmed that our gspmhd is spatially a second - order scheme .    .",
    "the upper and lower solid lines represent the lines of @xmath129 and of @xmath130 , respectively .",
    ", width=264 ]               ( the circles ) after 5 periods .",
    "the solid line indicates the analytic solution .",
    ", width=302 ]    @xcite investigated a non - linear circularly polarized alfvn wave that is one of the exact solutions of the non - linear mhd .",
    "following @xcite , we set the following initial condition .",
    "the alfvn wave propagates toward an angle @xmath131 with respect to the @xmath109-axis .",
    "the initial condition is @xmath132 , @xmath133 , @xmath134 , and @xmath135 , where @xmath136 . in order to investigate the effect of the particle distribution , two kind of initial particle distributions",
    "are considered .",
    "one is the ordered distribution ( a hexagonal packed lattice ) , and the other is the random distribution that is relaxed until the density dispersion is sufficiently small . in each particle distribution",
    ", we calculate this test at three resolutions , @xmath137 , @xmath138 , and @xmath139 particles .",
    "the results are shown in fig .",
    "[ fig : alf circ ] after five periods .",
    "the abscissa and the ordinate denote the projected coordinate @xmath140 and the perpendicular magnetic field @xmath141 in the @xmath114 plane , respectively .",
    "the exact solution is shown by the solid line in each panel .",
    "all particles are plotted by the circles .",
    "the results are shown at three different resolutions @xmath142 , @xmath138 , and @xmath139 from bottom to top .",
    "the left and right panels correspond to the hexagonal lattice and the random distributions as the initial condition , respectively .",
    "[ fig : alf circ ] also shows that the results with different initial particle configurations agree extremely well in each resolution .",
    "@xcite performed the same test . in their fig .",
    "6 , the phase error is found even in the highest resolution . in all panels of fig .",
    "[ fig : alf circ ] , the phase error is not seen in our gspmhd .",
    "the phase error may come from the fact that pm05 used the cubic spline kernel .",
    "the results with the cubic spline and the gaussian kernels after one period are shown in figs .",
    "[ fig : alf cubic]a and [ fig : alf cubic]b for @xmath143 , respectively . to see the phase error clearly , figs .",
    "[ fig : alf cubic ] are plotted for @xmath144 . in each panel",
    ", we show the results with different smoothing length @xmath145 ( the circles ) , 1.2 ( the triangles ) , and 1.5 ( the boxes ) ( see equation ( [ hi ] ) ) .",
    "the solid line indcates the analytic solution in each panel . from fig .",
    "[ fig : alf cubic]a , even after one period , one can see that the cubic spline kernel gives relatively large phase errors , the values of which depend on the smoothing length , @xmath82 . on the other hand",
    ", the gaussian kernel shows sufficiently small phase errors compared with the cubic spline kernel , and the phase errors are nearly independent of @xmath82 .",
    "therefore , the gaussian kernel is superior to the cubic spline kernel in the propagation of alfvn waves .",
    "[ fig : alf circ ] shows some errors around the extremal points of @xmath141 at @xmath146 , 0.75 , 1.25 , and 1.75 .",
    "this error comes from the strange `` clipped '' shape of the wave compared with the exact solution in fig .",
    "[ fig : alf circ ] while it was not found in pm05 .",
    "this is caused by the monotonicity constraint on the gradients of the physical variables , required for a stable description of discontinuities ( see section [ sec : use riemann solver ] ) . because the monotonicity constraint makes the scheme s spatial accuracy first - order around extremal points , the profile around extremal points dissipates preferentially and is flattened as seen in fig .",
    "[ fig : alf circ ] . fig .",
    "[ fig : alf circ nomon ] shows the results without the monotonicity constraint for @xmath143 ( the circles ) after five periods .",
    "one can see that no deformation arises .",
    "deformation of the wave shape is also found in finite - volume methods using the monotone upstream - centered scheme for conservative laws ( muscl ) method @xcite .",
    "apart from the wave shape , the waves in gspmhd are less dissipated than those in pm05 , who adopted the artificial resistivity .",
    "mhd shock tube problems are widely used to test numerical codes . in this section ,",
    "we calculate two shock tube tests .",
    "first , we perform a shock tube where initial states are given by ( @xmath147 , @xmath148 , @xmath149 , @xmath150 , @xmath116 , @xmath151 , @xmath117)=(1.08 , 0.95 , 1.2 , 0.01 , 0.5 , @xmath152 , @xmath153 for @xmath154 and @xmath1551 , 1 , 0 , 0 , 0 , @xmath156 , @xmath153 for @xmath157 with @xmath158 .",
    "initially , sph particles are distributed in a hexagonal lattice with the particle separation of @xmath159 .",
    "the particle separation in the @xmath109-direction for @xmath157 widens slightly to obtain the initial density discontinuity .",
    "the rectangular domain is @xmath160\\times[-3.2\\times10^{-2},3.2\\times10^{-2}]$ ] .",
    "the same shock tube problem was presented by @xcite and @xcite in finite - volume methods and pm05 in spmhd .",
    "the exact solution consists of two fast shocks , two rotational discontinuities , two slow shocks , and one contact discontinuity .",
    "[ fig : shock3_1dim ] shows the results of the gspmhd at @xmath161 .",
    "the solid gray lines indicate the exact solution .",
    "one can see that gspmhd describes all discontinuities very well .",
    "our gspmhd can resolve the rotational discontinuities and the slow shocks although they are smeared out in fig 9 of pm05 .",
    "this may illustrate the contrast that our gspmhd takes into account the characteristics of alfvn waves and pm05 use an artificial resistivity in the induction equation .",
    "next , we perform a shock tube test contains stronger shocks than the previous one .",
    "the initial states are given by @xmath162 for @xmath154 and @xmath163 for @xmath157 with @xmath164 .",
    "the same shock tube problem was presented by @xcite , @xcite and @xcite in finite - volume methods .",
    "the exact solution consists of two fast shocks , a left - propagating slow rarefaction wave , a right - propagating slow shock , and one contact discontinuity .",
    "the initial particle distribution is a hexagonal lattice with the average particle separation of @xmath165 in @xmath166\\times [ -7.2\\times10^{-2},\\;7.2\\times10^{-2}]$ ] .",
    "[ fig : shock4_1dim ] shows the results of the gspmhd at @xmath167 , with the solid gray lines indicating the exact solution .",
    "this figure shows that gspmhd can reproduce the exact solution and describes all discontinuities better than those in pm05 and @xcite .",
    "the fast shocks can be resolved by small number of particles . in the finite - volume method",
    ", @xcite reported a relatively large error of @xmath168 in his fig .",
    "13 where the non - conservative method @xcite is used .",
    "however , even in this kind of shock tube problem with strong shocks , our scheme shows the error in @xmath168 less than 1 percent except for the vicinity of the discontinuities .",
    "the next test is the orszag - tang vortex problem that was originally investigated by @xcite in incompressible mhd flows .",
    "this problem is a standard two - dimensional test for compressible mhd schemes @xcite .",
    "this calculation is performed in @xmath169\\times[0,1]$ ] domain . in all boundaries ,",
    "periodic boundary conditions are imposed .",
    "the initial conditions are given by @xmath170 , @xmath171 , @xmath172 although the initial velocity and magnetic field are not random , the system moves into turbulence through non - linear interaction of mhd waves .",
    "[ fig : otvtem ] shows that contour maps of the test at @xmath173 for ( a)density , ( b)pressure , ( c)magnetic energy @xmath174 , and ( d)specific kinetic energy @xmath175 .",
    "[ fig : otvtem ] can be directly compared with fig .",
    "22 of @xcite and one can see that the agreement is excellent . to view the results quantitatively",
    ", we compare the horizontal cuts of the temperature for gspmhd and a finite - volume method with hlld rieman solver and the constraint transport method ( provided by dr .",
    "t. matsumoto ) in fig .",
    "[ fig : otv1dim ] at ( a)@xmath176 , ( b)@xmath177 , and ( c)@xmath178 .",
    "the black and grey solid lines denotes the results with the gspmhd and the finite - volume method with the resolution of 256@xmath179256 .",
    "one can see that the profiles between the two methods show good agreement except for the peak at @xmath180 in the @xmath176 slice .",
    "our scheme does not strictly conserve the total energy , @xmath181 .",
    "the time evolution of the relative error of @xmath182 is presented in fig .",
    "[ fig : otvdivb]a .",
    "one can see that the error of @xmath182 is sufficiently small .",
    "[ fig : otvdivb]b shows the time evolution of the divergence error , which is maintained at an acceptable level @xmath183 parcent .",
    "the distribution of the divergence error localizes at shock fronts .",
    "the spatial distribution of the sph particles for @xmath184 is shown in fig . [",
    "fig : otvdivb]c .",
    "the divergence error is highly localized at discontinuities .",
    "this error comes from the irregular particle distribution .",
    "the mhd rotor problem was introduced by @xcite to test propagation of strong torsional alfvn waves .",
    "the computation domain is a square unit @xmath185\\times[-0.5,0.5]$ ] .",
    "this problem consists of a dense and rapidly rotating cylinder ( rotor ) embedded by a rarefied uniform medium .",
    "the initial conditions are given by @xmath186 @xmath187 and @xmath188 for @xmath189 , where @xmath190 , @xmath191 , and @xmath192 .",
    "the pressure and the magnetic field @xmath107 , @xmath193 are uniform , and the adiabatic index is @xmath194 .",
    "all sph particles are assumed to have the same mass .",
    "therefore , the number density of sph particles in the rotor is larger than that in the ambient gas .",
    "the sph particle mass is determined so that the resolution in the ambient gas is as large as @xmath195 , leading that the total particle number is 86968 .",
    "the initial particle distribution is constructed by using a relaxation method presented in @xcite .",
    "[ fig : rotor ] shows the contour maps of ( a)density , ( b)gas pressure , ( c)mach number @xmath196 , and ( d)magnetic energy @xmath174 at @xmath197 .",
    "the contour levels are the same as those in fig .",
    "18 of @xcite . from fig .",
    "[ fig : rotor ] , the results agree with @xcite quite well . compared with other spmhd schemes , such as @xcite , the contours appear to be smoother .    to compare with the finite - volume method in more detail , we plot horizontal slices of the rotor problem at @xmath176 ( first row ) and at @xmath198 ( second row ) in fig . [",
    "fig : rotor1dim ] . in each panel ,",
    "the black and grey lines indicate results with gspmhd and the finite - volume method , respectively .",
    "one can see that the agreement between the two methods is quantitatively excellent in all variables .",
    "since the gspmhd is a lagrangian method , the resolution is better in the dense ring while the gspmhd gives more diffusive results in the narrow region with low density ahead of the dense ring .",
    "[ fig : rotordivb ] is the same as fig .",
    "[ fig : otvdivb ] but for the rotor test .",
    "in this test , the energy and the divergence error is maintained in a sufficiently low level .",
    "the next test is blast waves that propagates into a strongly magnetized gas @xcite .",
    "the calculation region is a square domain of @xmath185\\times[-0.5,0.5]$ ] . in this problem , an overpressured hot region with pressure of @xmath199",
    "is set within @xmath200 , where @xmath201 . around the hot central region",
    "there is a rarefied ambient gas with a pressure of @xmath202 .",
    "the density @xmath106 is spatially uniform .",
    "the initial uniform magnetic field @xmath203 makes the angle @xmath204 with the @xmath109-axis . here , @xmath205 , @xmath199 , @xmath202 , and @xmath206 are parameters .",
    "we consider two cases : moderate-@xmath207 case and low-@xmath207 case .",
    "we adopts @xmath191 , @xmath208 , @xmath209 , and @xmath210 .",
    "therefore , the plasma @xmath207 of the ambient gas is as low as 0.2 .",
    "these parameters were adopted in @xcite .",
    "[ fig : blast ] shows that the contour maps of the blast wave at @xmath197 for ( a)@xmath147 , ( b)@xmath148 , ( c)@xmath175 , and ( d)@xmath174 . the total particle number is as large as @xmath195 .",
    "one can see the shock structures around the elongated hot bubble along @xmath211 .",
    "the fast ( slow ) shock propagates toward the direction parallel ( perpendicular ) to @xmath211 .",
    "this figure can be directly compared with the bottom column of fig .",
    "28 in @xcite .",
    "one can see that the contour maps is quite similar to those in @xcite except for the central rarefied hot bubble where gspmhd is more diffusive owing to its lagrangian nature .    for comparison with the finite - volume method in detail , we consider slices of physical variables passing through the centre @xmath212 . to characterize the direction of the slice , we introduce an angle @xmath213 that is the angle between the slice and the @xmath109-axis .",
    "[ fig : blast1dim ] shows the results for the cases with @xmath214 and @xmath215 , which correspond to the directions parallel and perpendicular to the initial magnetic field , respectively .",
    "the subscripts @xmath63 and @xmath64 represent the components parallel and perpendicular to the direction of the slice .",
    "the black and grey lines indicate the results with gspmhd and the finite - volume method , respectively .",
    "one can see that the results with gspmhd agree with those of the finite - volume method very well except in the central region , as mentioned above . in the profile of the parallel magnetic field @xmath65 for @xmath214 , there are some wiggles near the contact discontinuity .",
    "this comes from the pressure jump in the initial condition , and does not serious because @xmath65 agrees with that in the finite - volume method in the other places .",
    "if the pressure jump is smoother , the wiggle becomes small .",
    "[ fig : blastdivb ] is the same as fig .",
    "[ fig : otvdivb ] but for the blast wave test . in this test",
    ", the energy and the divergence error is maintained in a sufficiently low level .",
    "we adopts @xmath216 , @xmath217 , @xmath218 , and @xmath219 .",
    "therefore , the plasma @xmath207 of the ambient gas is as low as 0.02 .",
    "these parameters were adopted in @xcite and @xcite .",
    "[ fig : blast_strong ] is the same as fig .",
    "[ fig : blast ] but for the low @xmath207 case .",
    "one can see a stronger slow shock along the initial magnetic field than that in the previous case .",
    "[ fig : blast1dim_strong ] shows the slices of the physical variables along @xmath220 with respect to the @xmath109-axis , and is the same as fig .",
    "[ fig : blast1dim ] but for the low @xmath207 case .",
    "one can see that the results of gspmhd coincide with those of the finite - volume method very well also in the low @xmath207 case .",
    "in this paper , we developed a new spmhd scheme with the godunov method . to take into account the physical dissipation , we consider the non - linear rp with magnetic pressure and the moc in the interaction between the sph particles instead of artificial dissipation used in previous works .",
    "using the muscl method , the spatial accuracy of our scheme attains second order accuracy @xmath221 that is confirmed in the convergence test of linear mhd waves ( see section [ sec : test ] ) . from several test calculations in section [ sec : test ] , it is confirmed that our method can capture all mhd discontinuities more accurately than previous proposed methods .",
    "the gspmhd can provide results comparable to finite - volume methods with approximate riemann solvers .",
    "we will apply the gspmhd to astrophysical problems where the lagrangian description has advantages .",
    "the gspmhd described in this paper loses strict conservation property with respect to both momentum and energy .",
    "this is to avoid the tensile instability in strong magnetic fields .",
    "although conservation errors are sufficiently small in the test calculations ( see section [ sec : test ] ) , the non - conservative formulation can be problematic in long - term calculations .",
    "thus , further investigations are needed to improve the conservation property together with the better performance in low-@xmath207 plasma cases .    in the gspmhd , the gaussian kernel is used .",
    "other kernel functions ( e.g. , the cubic spline kernel ) can be applied easily in our gspmhd if one use equation ( [ fij monaghan ] ) or other symmetrization of the kernel function . however , in the spmhd , choice of kernel functions may be important in contrast to the hd case . in section [ alf circ ] , it is shown that the cubic spline kernel brings relatively large phase errors into the propagation of alfvn waves .",
    "in shock tube tests , we confirm that the results with the cubic spline kernel are worse compared with the gaussian kernel .",
    "to obtain reasonable results with the cubic spline kernel , one need a large neighbours @xmath222 in the two - dimensional code as suggested in pm05 .",
    "thus , we recommend the gaussian kernel in the gspmhd .",
    "we thank the referee , dr . daniel price for many constructive comments that improved the paper .",
    "we thank dr .",
    "takuma matsumoto for variable discussions and providing his results of test calculations using the hlld@xmath223ct method .",
    "we also thank dr .",
    "takeru k. suzuki and dr .",
    "toru tsuribe for many constructive discussions .",
    "this work was supported by grants - in - aid for scientific research from the mext of japan ( k.i.:22864006 ; s.i.:18540238 and 16077202 ) .",
    "balsara , d. s. , & spicer , d. s. 1999 , j. comput .",
    "phys . , 149 , 270    brve , s. , omang , m. , & trulsen , j. 2001 , apj , 561 , 82    brve , s. , omang , m. , & trulsen , j. 2006 , apj , 652 , 1306    brackbill , j. u. & barnes , d. c. 1980 , j. comp .",
    "phys , 35 , 426    cha , s. h. , inutsuka , s. , & nayakshin , s. 2010 , mnras , 403 , 1165    dai , w. , & woodward , p. r. 1994 , j. comput .",
    "phys , 111 , 354    dolag , k. , & stasyszyn , f. 2009 , mnras , 398 , 1678    evans , c. r. & hawley , j. f. 1988 , apj , 332 , 659    gaburov , e. , & nitadori , k. 2011 , mnras , 414 , 129    gardiner , t. a. , & stone , j. m. 2005 , j. comput .",
    ", 205 , 509    gingold , r. a. , & monaghan , j. j. 1977 , mnras , 181 , 375    godunov , s. k. 1959 , mat .",
    ", 47 , 271    inutsuka , s. 2002 , j. comput .",
    "phys , 179 , 238    miyoshi , t. , & kusano , k. , 2005 , j. comput .",
    "phys , 208 , 315    li , s. 2005 , j. comput .",
    "phys . , 203 , 344    londrillo , p. , & del zanna , l. 2000 , apj , 530 , 508    lucy , l. 1977 , aj , 82 , 1013    miyoshi , t. , kusano , k. , 2005 , j. comput .",
    "phys . , 208 , 315    monaghan , j. j. 1992 , araa , 30 , 543    monaghan , j. j. 1997 , j. comput .",
    "phys . , 136 , 298    murante , g , borgani , s. , bruino , r. , and cha , s. 2011 , mnras , 417 , 136    orszag , s. a. , & tang , c. m. 1979 , j. fluid mech . , 90 , 129    pakmor , r. , bauer , a. , & springel , v. , 2011 , mnras in press ( arxiv:1108.1792 )    phillips , g. j. , & monaghan , j. j. 1985 , mnras , 216 , 883    powell , k. g. , roe , p. l. , linde , t. j. , gombosi , t. i. , & de zeeuw , d. l. 1999 , j. comput .",
    "phys . , 154 , 284    price , d. j. 2010 , j. comput .",
    ", doi:10.1016/j.jcp.2010.12.011    price , d. j. , & monaghan , j. j. 2004 , mnras , 348 , 123    price , d. j. , & monaghan , j. j. 2004 , mnras , 348 , 139    price , d. j. , & monaghan , j. j. 2005 , mnras , 364 , 384    ryu , d. , jones , t. w. 1995 , apj , 442 , 228    sano , t. , inutsuka , s. , & miyama , s. m. 1999 , in numerical astrophysics , ed . s. m. miyama , k. tomisaka , & t. hanawa ( dordrecht : kluwer ) , 383    springel , v. , yoshida , n. , white s. d. m. 2001 , newa , 6 , 51    springel , v. 2005 , mnras , 364 , 1105    springel , v. 2010a , araa , 48 , 391    springel , v. 2010b , mnras , 401 , 791    stone , j. m. , gardiner , t. a. , teuben , p. , hawley , j. f. , & simon , j. b. 2008 , apjs , 178 , 137    stone , j. m. , & norman , m. l. 1992 , j. comput .",
    "phys . , 80 , 791    swegle , j. , hicks , d. l. , & attaway , s. w. 1995 , j. comput .",
    ", 116 , 123    toro , e. f. , & spruce , m. 1994 , shock waves , 4 , 25    tth , g. 2000 , j. comput . phys . , 161 , 605    van leer , b. 1979 , j. comput .",
    "phys . , 32 , 101    whitworth , a. p. , bhattal , a. s. , turner , j. a. , & watkins , s. a&a , 301 , 929",
    "in this appendix , we present the non - linear riemann solver . fig .",
    "[ fig : riemann ] shows that the schematic picture of the non - linear rp .",
    "initially , we consider two uniform states @xmath224 that are separated by the discontinuity at @xmath225 , where @xmath226 and @xmath227 is the mass coordinate . the magnetic field in the @xmath32-direction , @xmath65 , is assumed to be zero .",
    "the rp depends only on @xmath228 . since @xmath229 for @xmath230",
    ", @xmath231 is constant spatially and temporary in each side even if @xmath231 has a discontinuity at @xmath225 .",
    "therefore , @xmath231 does not affect the rp , suggesting that we can set @xmath232 without loss of generality .        in this rp",
    ", the fast shock ( fs ) or the fast rarefaction ( fr ) waves propagate outward as shown in fig .",
    "[ fig : riemann ] .",
    "this configuration is the same as the rp used in the godunov method of the hd @xcite .",
    "the rp is separated into the left and the right intermediate state , @xmath233 and @xmath234 , by the contact discontinuity ( cd ) . at the cd , since the total pressure and the velocity is continuous , one can get the following relations , @xmath235 @xmath236 in order to take into account the fr exactly , we need the numerical integration that is computationally expensive . therefore , we treat the fr as `` rarefaction shock '' .",
    "this mean that the shock jump condition is used in the case of @xmath237 or @xmath238 .",
    "this treatment is reasonably accurate because the tangential lines of the hugoniot curve and the adiabatic curve coincide at any point in @xmath239 plane .    from equation ( [ basic eq ] ) , the relations between the jump of the total pressure and velocity across the right - facing fast shock and the left - facing fast shock are given by @xmath240 respectively , where @xmath241 and @xmath242 are the lagrangian speeds of the right - facing and the left - facing shocks , respectively . from equation ( [ right ] ) , the total pressure and the velocity in the intermediate state are given by @xmath243 ,          \\label{riemann p}\\ ] ] @xmath244 .",
    "\\label{riemann v}\\ ] ] the lagrangian shock speeds @xmath242 , @xmath241 are derived from the jump conditions across the shock , @xmath245 = 0,\\;\\ ;           \\left [ \\rho v_\\parallel^2   + p+\\frac{b_\\perp^2}{2 } \\right ] = 0 ,          \\label{jump1}\\ ] ] @xmath246=0,\\;\\ ;          \\left [ \\left(\\frac{\\rho v_\\parallel^2}{2 } + \\frac{\\gamma p}{\\gamma-1}\\right )          v_\\parallel          + v_\\parallel b_\\perp^2 \\right]=0 .",
    "\\label{jump2}\\ ] ] using equations ( [ jump1 ] ) and ( [ jump2 ] ) , one can get @xmath247 ,          \\label{lag shock}\\ ] ] @xmath248 where @xmath249l and r. from equation ( [ lag shock ] ) , since @xmath242 and @xmath241 depend on @xmath66 , equation ( [ riemann p ] ) is non - linear with respect to @xmath66 .",
    "therefore , we solve equation ( [ riemann p ] ) iteratively by the following procedure .",
    "first , the total pressure @xmath250 is inserted into the right hand side of equation ( [ riemann p ] ) .",
    "then , we can get @xmath251 that is also inserted into equation ( [ riemann p ] ) to get @xmath252 .",
    "the iteration is continued until the desired accuracy is reached .",
    "finally , the velocity @xmath253 is obtained from equation ( [ riemann v ] ) .",
    ", width=302 ]    in this appendix , moc is briefly reviewed .",
    "we consider the propagation of the alfvn wave along the @xmath32-axis . for simplicity",
    ", we consider the case with @xmath254 .",
    "more general expression including the case with @xmath255 is presented later . the mhd equations for a one - dimensional ( the @xmath32-direction ) incompressible fluid",
    "are given by @xmath256 equations ( [ moc eq1 ] ) can be written as @xmath257 and @xmath258 from equations ( [ cp ] ) and ( [ cm ] ) , one can see that @xmath259 are constant on a trajectories with @xmath260 and @xmath261 , respectively .",
    "[ fig : moc ] shows the schematic picture .",
    "the partially updated values @xmath262 and @xmath263 at @xmath264 can be obtained by extrapolate back in time along @xmath265 and @xmath266 to the present time step where all variables are known .",
    "the positions @xmath267 and @xmath268 are the foot points of @xmath265 and @xmath266 intersect at @xmath269 on @xmath264 , respectively ( see fig . [",
    "fig : moc ] ) . using the riemann invariant @xmath270 , the characteristic equations along @xmath265 and @xmath266 are given by @xmath271 respectively . from equations",
    "( [ eq1 ] ) , @xmath272 and @xmath273 are given by @xmath274\\ ] ] and @xmath275 respectively .",
    "so far , we consider only for the case with @xmath254 . for the case with @xmath255 , the alfvn wave propagates in the opposite direction of the @xmath32-axis .",
    "therefore , the positions of @xmath276 and @xmath277 replace each other .",
    "the general expressions are given by @xmath278          \\label{moc mag}\\ ] ] and @xmath279 where @xmath280 is the sign of @xmath65 .",
    "in actual calculations , as @xmath65 , we use the following simple average value , @xmath281 .",
    "to solve the rp and the moc in the interaction between the @xmath25- and @xmath10-th particles , we need to evaluate physical variables @xmath282 and",
    "@xmath283 at @xmath284 as shown in section [ sec : use riemann solver ] . in the gspmhd",
    ", a second order spatial accuracy can be achieved using a piecewise linear interpolation of the physical variables to determine @xmath282 and @xmath283 .",
    "[ fig : mono ] shows the schematic picture of the linear interpolation of a physical variable @xmath285 that is one of @xmath286 .",
    "the slope of the linear interpolation of @xmath285 is simply assigned by the gradient at each particle s position that is evaluated as @xmath287 ,     \\label{gradient}\\ ] ] for @xmath288 , otherwise @xmath289 .",
    "\\label{gradient}\\ ] ] using the gradient , the values at left and right side in the rp are given by @xmath290 respectively , where @xmath291 if equation ( [ gradient ] ) is directly used in the derivation of @xmath292 and @xmath293 , unphysical numerical oscillations arise @xcite . in order to obtain stable second - order scheme , we need to impose a monotonicity constraints on @xmath294 . in the finite - volume method",
    ", @xcite proposed several monotonicity constraints .",
    "we apply one of them to the gspmhd as follows @xmath295 where @xmath296 satisfies @xmath297 here , we consider the case with @xmath298 and @xmath299 as shown in fig .",
    "[ fig : mono ] . the first two terms in equation ( [ mono ] ) ,",
    "@xmath300 , ensure the condition of @xmath301 ( see fig .",
    "[ fig : mono ] ) .",
    "this is the lower bound of @xmath293 for @xmath298 . in the finite - volume method ,",
    "the upper bound of @xmath293 is determined by @xmath285 for @xmath302 . on the other hand , in the sph method",
    ", we do not know the distribution of @xmath285 for @xmath302 explicitly at the instance in the calculation of the interaction between @xmath25- and @xmath10-th particles . however , it can be estimated by the fact that @xmath303 is calculated by using all particles for @xmath304 and @xmath302 , suggesting that @xmath303 can be regarded as the average gradient around @xmath305 .",
    "if the gradient in @xmath306 is simply approximated by @xmath307 , the gradient in @xmath302 , @xmath308 , can be guessed by equation ( [ dq ] ) . in this paper , we set the upper bound of @xmath293 by @xmath296 ( see equation ( [ mono ] ) .    in the actual calculation , we take into account the domain of dependence as follows , @xmath309 in the rp , we use the monotonicity constraint with respect to @xmath147 , @xmath310 , @xmath311 , @xmath312 . in the moc",
    ", the monotonicity constraint is used with respect to the riemann invariants @xmath313 ( see equation ( [ j+- ] ) ) .",
    "using them , we derive @xmath314 and @xmath315 . equation ( [ mono ] ) suppresses numerical oscillations reasonably well .",
    "however , many improvements could still be made to the monotonicity constraint in the sph method ."
  ],
  "abstract_text": [
    "<S> in this paper , we develop a new method for magnetohydrodynamics ( mhd ) using smoothed particle hydrodynamics ( sph ) . </S>",
    "<S> to describe mhd shocks accurately , the godunov method is applied to sph instead of artificial dissipation terms . in the interaction between particles , </S>",
    "<S> we solve a non - linear riemann problem with magnetic pressure for compressive waves and apply the method of characteristics for alfvn waves . </S>",
    "<S> an extensive series of mhd test calculations is performed . in all test calculations , </S>",
    "<S> we compare the results of our sph code with those of a finite - volume method with an approximate riemann solver , and confirm excellent agreement .    </S>",
    "<S> [ firstpage ]    magnetic fields - mhd - methods : numerical </S>"
  ]
}