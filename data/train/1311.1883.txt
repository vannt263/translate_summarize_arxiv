{
  "article_text": [
    "magnetic flux ropes play a key role in the models of various solar activities , such as flares , filament / prominence eruptions , and coronal mass ejections ( cmes ) .",
    "they have been thoroughly studied by numerical simulations ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and observations ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . to drive an eruption , there must be sufficient free energy stored in the magnetic field and forces acted on the erupted object .",
    "however , a current - free ( potential ) magnetic field contains the least amount of magnetic energy in all the possible magnetic configurations given the same magnetic fluxes on the bottom boundary .",
    "therefore , a flux rope with large electric currents is required to exist in the pre - eruptive magnetic field or form during the eruption .",
    "the field lines are highly twisted around each other in such a configuration .",
    "the loss of equilibrium @xcite or the torus instability @xcite ejects the flux rope , whose eruption stretches the overlying magnetic field lines .",
    "@xcite pointed out that the loss of equilibrium and the torus instability are two different views of the same physical mechanism , which is the lorentz repulsion force of electric currents with different paths . or in the magnetohydrodynamic ( mhd ) point of view , it is the result of the force imbalance between the magnetic pressure in the flux rope and the magnetic tension of the overlying magnetic field .",
    "there are still some key problems awaiting to be answered for the magnetic flux rope eruption .",
    "for example , can a magnetic flux rope exist long time before a major flare or cme ? how is the non - potential state built up before the flux rope eruption ? does the magnetic reconnection occur in a flux rope ?",
    "it matters whether a flux rope exists before an eruption because it determines the initiation mechanism of an eruption .",
    "for example , @xcite found that the helical kink instability of a pre - existing twisted flux rope could trigger and initially drive an eruption .",
    "magnetic flux ropes have been found before the onset of flares or cmes by nonlinear force - free field ( nlfff ) extrapolations @xcite and indicated by extreme - ultraviolet ( euv ) and x - ray observations @xcite . on the other hand",
    ", a flux rope can be formed from magnetic arcades during the eruption by magnetic reconnection @xcite .",
    "a magnetic flux rope is built up by the line - tied photospheric motions , such as the magnetic flux emergence or the horizontal flows .",
    "this process injects the magnetic helicity into the higher solar atmosphere , which increases the twist and kink of a flux rope ( self - helicity ) and the linkage between different flux ropes ( mutual helicity ) .",
    "the magnetic helicity is conserved in an ideal mhd process and changes very slowly in a resistive process .",
    "thus , a flux rope with continuous injection of magnetic helicity inevitably erupts to remove the accumulated helicity .",
    "magnetic helicity injection can be inferred from magnetic field and velocity field observations in the photosphere .",
    "theory and techniques to measure the magnetic helicity and the velocity field have been developed in the past years .",
    "@xcite proposed a new expression @xmath4 for the flux density of magnetic helicity .",
    "various optical flow techniques have been proposed and tested with analytical velocity field models and mhd simulations @xcite .",
    "however , it is not easy to estimate the reliability of these calculations when they are applied to observations",
    ". therefore , we cross - check the helicity injection in a fast evolving active region with two methods , one from the magnetic field and the velocity field in the photosphere and the other from the nlfff extrapolation .    with nlfff extrapolations",
    ", one could compute the total relative helicity in a three dimensional volume and the self - helicity of an elementary magnetic flux rope .",
    "the comparison between magnetic helicity injection and total relative helicity from force - free fields has been done in a few cases @xcite .",
    "they all found overall good agreement between the two helicity estimation methods .",
    "@xcite assumed linear force - free field models , for which the total relative helicity measurement is mathematically straightforward and well posed .",
    "however , there are still problems in dealing with the boundaries in the direct helicity measurement with nlfff models as did in @xcite and @xcite .",
    "four methods to deal with these problems have been proposed by @xcite , @xcite , @xcite , and @xcite . here , our main purpose is not to quantify the relationship between the magnetic helicity injection from the photosphere and the total relative helicity from nlfff models .",
    "instead , we compare in detail the former with the self - helicity contained in a magnetic flux rope . neither the total relative magnetic helicity nor the self - helicity measures the same quantity as the magnetic helicity injection from the photosphere , because the coronal helicity may see variations related to a cme that could not be seen in the helicity flux on the photosphere .",
    "however , compared to the total relative helicity , magnetic helicity contained in a magnetic flux rope has a more direct relationship with the trigger mechanism of the eruption .",
    "a traditional view is that magnetic reconnection in a flare occurs in the current sheet tracing behind an erupting flux rope .",
    "there is more and more evidence suggesting that it could also occur in the leading edge of a flux rope , both from numerical simulations @xcite and from observations @xcite .",
    "@xcite proposed an alternative possibility that the magnetic reconnection could occur inside a flux rope by the internal kink instability .",
    "the occurrence of the magnetic reconnection requires the formation of current sheets , which are prone to form at locations where the magnetic linkages change drastically , namely the quasi - separatrix layers ( qsls ; @xcite ) . in the extreme case ,",
    "the magnetic linkages are discontinuous , and qsls degenerate into the separatrix .",
    "@xcite proposed a norm , @xmath5 , of the jacobian matrix of the field line mapping to compute the locations of qsls .",
    "however , the norm @xmath5 is not constant along a magnetic field line .",
    "@xcite proposed a new parameter ( squashing degree , @xmath3 ) to define qsls .",
    "the squashing degree @xmath3 is invariant along a magnetic field line .",
    "qsls are three dimensional volumes where @xmath5 or @xmath3 are large .",
    "@xcite analyzed several methods and proposed the best one to compute two - dimensional ( 2d ) q maps in the three - dimensional ( 3d ) domain .",
    "this magnetic field topology analysis method has been applied to studying coronal sigmoids @xcite .    to solve the above discussed problems",
    ", we have to know the 3d kinematic , thermal , and magnetic parameters in the solar atmosphere .",
    "the kinematic and thermal parameters can be derived from multi - wavelength imaging and spectral observations .",
    "however , the magnetic field information is difficult to observe directly in the higher solar atmosphere above the photosphere , where vector magnetic field has been observed routinely with both ground - based and space - borne instruments . although big efforts have been made to observe magnetic fields in the chromosphere and corona @xcite , much information of the 3d magnetic field in the solar atmosphere can only be derived by various magnetic models . due to the low plasma @xmath6 condition in the solar corona @xcite , the magnetic field , @xmath7 ,",
    "is usually modeled by the force - free field model that obeys the equations @xmath8 and @xmath9 .",
    "if the torsional parameter @xmath10 is a constant , the equations describe a linear force - free field .",
    "a special case is when @xmath11 , where the model degenerates to a potential field . from observations",
    ", it is found that @xmath10 usually changes in solar active regions @xcite .",
    "therefore , the nlfff model is necessary to model such cases more realistically than the potential or linear force - free field models .",
    "the force - free field equations are thus nonlinear and needed to be solved numerically ( see the review by * ? ? ?",
    "several numerical methods to solve the nlfff equations have been thoroughly tested against analytical , numerical , and observations @xcite .    in this paper",
    ", we study the magnetic helicity injection and 3d magnetic field evolutions before an x2.6 class flare that peaked at 23:02 ut on 2005 january 15 .",
    "an evolving magnetic flux rope extrapolated by the nlfff model has been reported in @xcite . here",
    ", we further compute the twist of the flux rope and compare it with the accumulated magnetic helicity .",
    "in particular , we study the build up phase of the magnetic flux rope .",
    "since the velocities on the photosphere are much lower than that in the corona , the evolution can be regarded as a quasi - static process .",
    "we use a series of nlfff to approximate this process . in most cases ,",
    "only one major flux rope exists in a solar active region , and we could use the twist of the flux rope to approximate the self - helicity if it is not highly kinked . besides , we analyze the magnetic topology , namely the 3d squashing degree ( q ) maps , of the evolving magnetic flux rope to study the magnetic reconnection locations .",
    "observations and data analysis are presented in section  [ sec : data ] .",
    "results on the comparison between the injected magnetic helicity and the twist evolution and qsls of the flux rope are described in section  [ sec : resu ] .",
    "we finally summarize and discuss our findings in section  [ sec : disc ] .",
    "two halo cmes and associated flares were observed in active region noaa 10720 on 2005 january 15 by the large angle and spectrometric coronagraph ( lasco ; @xcite ) and the extreme - ultraviolet imaging telescope ( eit ; @xcite ) , respectively , on board the _ solar and heliospheric observatory _ ( _ soho _ ) .",
    "@xcite studied the evolution of the flare loops after the peak of the m8.6 flare at 06:38 ut .",
    "the second flare ( x2.6 ) peaked at 23:02 ut .",
    "the authors found that the flare loops after the first flare were accelerated again and became the envelope field of the second flare and cme , which were driven by the fast evolving flux rope .    between the two cmes and flares",
    ", there was no cme detected by _",
    "however , many flares were observed in active region noaa 10720 during this period .",
    "here , we only focus on the period between 18:00 to 24:00 ut on 2005 january 15 as shown by the _ goes _ soft x - ray fluxes in figure  [ fig : goes ]",
    ". there were at least five flares before the x2.6 flare in this period in active region noaa 10720 , i.e. , the c4.4 ( 18:16 ut ) , c8.8 ( 18:53 ut ) , c3.5 ( 19:49 ut ) , c5.4 ( 20:11 ut ) , and m1.0 ( 22:08 ut ) class flares .",
    "the time in the parenthesis indicates the peak time of that flare .",
    "_ soho_/eit recorded the aforementioned flares in the 195    band .",
    "the spatial resolution and temporal cadence of eit are @xmath12 per pixel and 12 minutes , respectively .",
    "figure  [ fig:195 ] and an online only movie attached to it displays the evolution of the 195    images .",
    "we can get two pieces of important information from figure  [ fig:195 ] and the movie .",
    "first , some brightenings appeared intermittently in the core field along the polarity inversion line , as indicated by the five c and m class flares .",
    "secondly , the core field always stayed in the low corona and did not erupt into a higher place .",
    "this is because no evidence for a flux rope eruption was found until the x2.6 flare , when the magnetic flux rope eruption led to the second cme .      in the case of the ideal condition that the conductivity approaches infinity , the time ( @xmath13 ) variation of the magnetic helicity ( @xmath14 ) can be written as @xcite @xmath15 where @xmath16 denotes the boundary surface , @xmath17 is the vector potential of the potential field",
    ", @xmath18 denotes the velocity of the footpoints of flux tubes ( namely the flux transport velocity ) , and @xmath19 is the normal component of the magnetic field . in practical applications to solar events , the magnetic helicity flux through the photosphere dominates those from other surfaces .",
    "therefore , we can integrate the magnetic helicity flux only in the photosphere .",
    "the flux transport velocity is defined as @xcite @xmath20 where @xmath21 and @xmath22 are the transverse and normal components of the velocity , respectively , and @xmath23 is the transverse component of the magnetic field .",
    "the integrand in equation  ( [ eqn : dhdt1 ] ) can be recognized as the helicity flux density , @xmath24 where @xmath25 is the postion vector .",
    "@xmath26 has been adopted to compute the magnetic helicity flux distribution in active regions by many authors @xcite .",
    "@xcite found that @xmath26 creates artificial polarities even with simple flows without magnetic helicity injection into the corona .",
    "they proposed a new expression for the time variation of the magnetic helicity : @xmath27 where @xmath28_n , \\label{eqn : dthdt}\\ ] ] where @xmath29 represents the position vector pointing from @xmath30 to @xmath25 .",
    "equation  ( [ eqn : dhdt2 ] ) tells us that the magnetic helicity changes due to the rotation between each pair of two infinitesimal magnetic flux tubes @xcite .",
    "the helicity flux density @xmath31 is then defined as @xmath32 @xcite found that @xmath33 for the non - rotating motion of a single footpoint .",
    "for two magnetic regions with opposite polarities , both @xmath26 and @xmath4 have two artificial polarities , but @xmath4 is lower by a factor of 10 than @xmath26 .    from equations  ( [ eqn : dhdt1 ] ) and ( [ eqn : dhdt2 ] ) , we find that it is necessary to measure the velocity field in the photosphere in order to compute the helicity injection .",
    "the velocity field can be inferred from a series of magnetic fields by the so - called optical flow techniques , for instance , the local correlation tracking ( lct ) method . using only the normal component of magnetic fields",
    ", lct has been extensively applied to derive the photospheric velocity , @xmath34 , which is assumed to be the horizontal plasma velocity , @xmath21 @xcite .",
    "the normal magnetic fields can be constructed from the line - of - sight magnetic fields by assuming that all magnetic fields are vertical .",
    "lct tries to maximize the correlation coefficient of the intensity ( @xmath35 ) between two images using a prescribed window , which corresponds to @xcite @xmath36 .\\ ] ] if the image intensity is differentiable , @xmath37 satisfies the advection equation : @xmath38    the normal component of the magnetic induction equation in the ideal condition is @xcite @xmath39 or @xmath40 where we have used the expression for the flux transport velocity defined by equation  ( [ eqn : u ] ) .",
    "equations  ( [ eqn : dbdt1 ] ) or ( [ eqn : dbdt2 ] ) govern the evolution of the magnetic fields on the photosphere . all the newly developed optical flow techniques have considered the induction equation , such as the inductive local correlation tracking method ( ilct ; @xcite ) , the minimum energy fit method ( mef ; @xcite ) , and the minimum structure reconstruction method ( msr ; @xcite ) .",
    "@xcite pointed out that the magnetic induction equation is a continuity equation , and the lct method is inconsistent with it .",
    "therefore , an appropriate method should start with the continuity equations  ( [ eqn : dbdt1 ] ) or ( [ eqn : dbdt2 ] ) .",
    "there are two ambiguities in deriving the photospheric velocities from equations  ( [ eqn : dbdt1 ] ) or ( [ eqn : dbdt2 ] ) .",
    "first , the flux transport vector , which is defined as the product of the flux transport velocity and the normal magnetic field , can be decomposed to @xcite @xmath41 where @xmath42 is the unit vector of the normal direction .",
    "the scalar functions @xmath43 and @xmath44 are the inductive and electrostatic potentials .",
    "only the inductive potential @xmath43 can be determined by equations  ( [ eqn : dbdt1 ] ) or ( [ eqn : dbdt2 ] ) , while the electrostatic potential @xmath44 could be arbitrary functions .",
    "the velocity field can not be determined uniquely without additional assumptions .",
    "for example , @xcite assumed an affine velocity profile for the velocity model in a small window , where the velocity is linearly dependent on the local coordinates around the central position . with the affine velocity model",
    ", the continuity equation has an analytical solution , thus the velocities can be determined via a least - square method .",
    "this optical flow technique is termed as the differential affine velocity estimator ( dave ; @xcite ) .",
    "dave not only removes the first ambiguity but also guarantees that the dynamics of magnetic fields is consistent with the continuity equation .",
    "the second ambiguity is that the plasma velocity along a field line , @xmath45 , can not be constrained only by the evolution of the normal magnetogram .",
    "the dave method has been extended for vector magnetic fields ( dave4vm ; @xcite ) .",
    "the plasma velocity is assumed to be a three dimensional affine velocity profile .",
    "under such an assumption , the first and the second ambiguities are removed at the same time .",
    "a vector velocity field including the component along a field line can be determined through a time sequence of vector magnetic fields .    the digital vector magnetograph ( dvmg ) at big bear solar observatory ( bbso ) observed a series of vector magnetic fields with a cadence of about 1 minute and a spatial resolution of about @xmath46 .",
    "the details of the data process can be found in @xcite and @xcite .",
    "the @xmath47 ambiguity of the transverse component of the vector magnetic field is removed by the minimum energy method that minimizes the electric current density and the magnetic field divergence simultaneously @xcite .",
    "since the active region 10720 was crossing the central meridian and close to the solar disk center , the projection effect is of little influence .",
    "the finally processed vector magnetic field at 18:27 ut is shown in figures  [ fig : bvh]a and [ fig : bvh]b .",
    "we adopt the dave4vm method developed by @xcite to compute the vector velocity fields through a time sequence of magnetic fields .",
    "the window size is selected to be 23 pixels , which is determined by examining the pearson correlation and slope between @xmath48 and @xmath49 @xcite . to restrict the amount of computation and resolve small velocities , we select the following vector magnetic fields to analyze in detail at the time of 18:27 , 19:04 , 19:30 , 20:05 , 20:38 , 21:02 , 21:33 , and 22:20 ut on 2005 january 15 . with each pair of consecutive magnetic fields , we compute the velocity field at the middle time .",
    "for example , figure  [ fig : bvh]c shows the velocity derived by dave4vm at the middle time ( 18:46 ut ) of 18:27 and 19:04 ut .",
    "an averaged vector magnetic field is also constructed by the same pair of magnetic fields . the magnetic helicity flux density , @xmath4 ,",
    "is thus obtained by equation  ( [ eqn : gth ] ) and the computed vector magnetic field and velocity field at 18:46 ut .",
    "figure  [ fig : bvh]d displays the magnetic helicity flux density at 18:46 ut . the magnetic helicity flux ( namely the helicity injection rate or the time variation of the helicity ) , @xmath50 , is derived by the integration of @xmath4 over the photosphere , i.e. , by equation  ( [ eqn : dhdt2 ] ) .",
    "@xcite defined the twist between an axis curve and a secondary curve for arbitrary geometries as long as they do not intersect with themselves and are smooth .",
    "as shown in figure  [ fig : twist1 ] , @xmath51 denotes a smooth axis curve and @xmath52 a secondary curve .",
    "@xmath53 is a unit vector tangent to @xmath51 , where @xmath54 is the arc length from an reference starting point on the axis curve .",
    "@xmath55 denotes a unit vector normal to @xmath53 and pointing from @xmath51 to @xmath52 .",
    "then , the twist density of the secondary curve around the axis is defined by @xmath56 the total twist is derived by the integration along the axis curve .",
    "equation  ( [ eqn : twist ] ) can be applied to the twisted field lines of the flux ropes , which are constructed by the nlfff extrapolations with the optimization method @xcite . as an example ,",
    "figure  [ fig : bvh]b shows the vector magnetic field and its field of view on the photosphere that are used for the nlfff extrapolation .",
    "the flux balance parameter , which is defined as @xmath57 , is -0.02 .",
    "it indicates that the bottom boundary is very well flux balanced .",
    "then , we preprocess the vector magnetic field with the method of @xcite to remove the net magnetic force and torque on the boundary . the preprocessed vector magnetic field is finally used as the bottom boundary for the nlfff extrapolation .    to compute the twist of the reconstructed flux rope",
    ", we have to determine the axis . from the extrapolated results ( as shown in @xcite and in the following analysis )",
    ", it is found that the middle section of the flux rope was always horizontal and close to the polarity inversion line .",
    "similar to what has been done in @xcite , we assume the section of the flux rope between points 1 and 3 in figure  [ fig : twist2]a is horizontal and tangent to the polarity inversion line .",
    "an objective function is defined to measure how well the above assumptions are met : @xmath58 where @xmath59 and @xmath60 are the cartesian coordinates of a magnetic field line , @xmath61 is the @xmath62-component of the polarity inversion line , and @xmath63 is the average height of a magnetic field line .",
    "the integration is done between points 1 and 3 .",
    "the axis field line should have a minimum objective function @xmath64 .    to calculate the starting points for integrating the sample magnetic field lines and determining the axis",
    ", we fit the polarity inversion line between points 1 and 3 as shown in figure  [ fig : twist2]a with a third order polynomial .",
    "points 1 and 3 are selected in the middle part of the magnetic flux rope with a certain degree of freedom .",
    "we will test the errors in computating the twists caused by the positions of points 1 and 3 in the following analysis .",
    "a square surface of @xmath65 is selected perpendicular to the third order polynomial in the middle of points 1 and 3 ( at point 2 ) and perpendicular to the bottom surface .",
    "the area of the square is selected to be large enough to include all the magnetic field lines of the magnetic flux rope and small enough to miminize the computation efforts .",
    "the bottom edge of the square is on the photosphere , and the projection of the square is shown as the line segment in figure  [ fig : twist2]a .",
    "then , we integrate some field lines starting from @xmath66 sample points uniformly distributed on the square . the field lines are computed in the computation box until they reach the boundary .",
    "finally , the axis is determined as the magnetic field line with minimum objective function @xmath64 defined in equation  ( [ eqn : f ] ) .",
    "the axis is shown as the dark field line in figure  [ fig : twist2]b .",
    "the sample field lines of the magnetic flux rope is determined by two criteria .",
    "namely , they all pass through the @xmath65 square and are longer than the axis .",
    "the twist density between a sample magnetic field line and the axis is computed with equation  ( [ eqn : twist ] ) .",
    "the total twist is then derived by the integration of the twist density along the axis .",
    "the twists of some sample field lines are noted in figure  [ fig : twist2]b .",
    "we quantify the twist of the flux rope as the average twist of the sample field lines of the magnetic flux rope .",
    "the average twist is about @xmath67 turns , or @xmath68 in radian , for the flux rope at 18:27 ut on 2005 january 15 .",
    "the error is estimated as the standard deviation of the twists of the sample field lines .",
    "the error can also be caused by the determination of the axis , which depends on the locations of points 1 and 3 in figure  [ fig : twist2]a .",
    "if we assume the @xmath69-coordinates of points 1 and 3 are @xmath70 and @xmath71 , respectively , the following four cases are considered to compute the twist error caused by the determination of the axis .",
    "we chose four pairs of points 1 and 3 on the polarity inversion line and their @xmath69-coordinates are located at \\{@xmath72 } , \\{@xmath73 } , \\{@xmath74 } , and \\{@xmath75}. the average and standard deviation of the twists of the four cases at 18:27 ut are -1.90 and 0.03 turns , respectively . compared to @xmath76 turns derived from the original case , the average twist of the four test cases are the same , and the standard deviation is much smaller .",
    "we have also checked the results for the other 7 samples , whose results are similar to this one at 18:27 ut .",
    "therefore , the method to determine the axis of the flux rope is very robust .",
    "the twist does not depends sensitively on the selection of the choice of points 1 and 3 .",
    "using the methods described in sections  [ sec : dhdt ] and [ sec : twist ] , we compute the helicity injection rate and twist of the flux rope at the time of 18:27 , 19:04 , 19:30 , 20:05 , 20:38 , 21:02 , 21:33 , and 22:20 ut on 2005 january 15 .",
    "the injected magnetic helicity @xmath77 is evaluated by @xmath78 with @xmath79 , where @xmath80 is a reference time . here , we select @xmath80 to be 18:27 ut ,",
    "i.e. , the first moment we extrapolate the 3d magnetic field . the time evolution of @xmath77 is plotted in figure  [ fig : ht ] , which shows that the negative helicity is injected during the studied period . with a linear fitting , we find that the helicity injection rate is @xmath0 .",
    "the errors of the injected helicity , @xmath77 , are estimated as follows .",
    "equations  ( [ eqn : dhdt2 ] ) and ( [ eqn : dthdt ] ) indicate that the errors come both from the magnetic field measurements and the velocity field computation . for the velocity field ,",
    "the spatial alignment between two consecutive magnetic fields also affects the accuracy derived by dave4vm , besides the magnetic field measurement errors . for simplicity , we consider the two effects one by one .",
    "the first source of the errors of the helicity injection rate ( @xmath81 ) can be estimated by considering the errors in the magnetic field measurements .",
    "some artificial errors in the normal distribution with the standard deviation of 2 g for @xmath82 and 10 g for @xmath83 and @xmath84 are added to the vector magnetic field , with which the velocity field is derived using the dave4vm method . here",
    ", the errors for @xmath82 and for @xmath83 and @xmath84 are determined by the dvmg sensitivity .",
    "then , the helicity injection rate , @xmath81 , is computed with equations  ( [ eqn : dhdt2 ] ) and ( [ eqn : dthdt ] ) .",
    "we repeated the above process 10 times .",
    "the error for @xmath81 is estimated as the standard deviation of the 10 results .",
    "we computed the errors of @xmath81 for all the 7 middle time points of the 8 selected samples .",
    "the maximum and minimum errors are @xmath85 and @xmath86 , respectively .",
    "the second source of the errors of the helicity injection rate ( @xmath81 ) is estimated by considering the spatial alignment between two consecutive magnetic fields .",
    "we assume the upper limit of the alignment error is one pixel .",
    "then , the second magnetic field is shifted one pixel upward , downward , leftward , and rightward , respectively , each of which can be paired with the first magnetic field and yield a new velocity field .",
    "therefore , we get four more velocity fields in addition to the one computed by the originally aligned magnetic fields .",
    "next , the helicity injection rate , @xmath81 , is computed with equations  ( [ eqn : dhdt2 ] ) and ( [ eqn : dthdt ] ) based on the five velocity fields .",
    "we further estimate the standard deviation of the five results as three times the error of the helicity injection rate .",
    "the errors are also computed for the other 6 middle time points .",
    "the maximum and minimum errors are @xmath87 and @xmath88 , respectively . since the errors of @xmath81 caused by the magnetic field measurement errors are much smaller than that caused by the spatial alignment , we only consider the latter in estimating the errors of the injected helicity , @xmath77 .",
    "the errors are finally computed with the error propagation formula for the addition when equation  ( [ eqn : delh ] ) is used to compute @xmath77 . if we include the magnetic field measurement errors , it would only increase the errors of @xmath77 slightly",
    ". however , the following conclusion does not change .",
    "the twists of the flux rope at all the 8 selected time points are computed with the method described in section  [ sec : twist ] .",
    "the twist error at each time is estimated as the standard deviation of the twists of the sample field lines .",
    "figure  [ fig : ht ] shows the time evolution of the twist , whose absolute value increases with the time .",
    "the negative sign indicates that the twist is left - handed .",
    "a linear fitting to the twist time evolution suggests that the twist increasing rate is @xmath1 turns hr@xmath2 .    as described in @xcite , the magnetic helicity of a magnetic field",
    "can be divided into the twist and kink of elementary flux tubes and the linkage between them , which are deemed as the self - helicity ( @xmath89 ) and mutual helicity ( @xmath90 ) , respectively : @xmath91 where the summation runs over @xmath5 flux tubes .",
    "the self - helicity of an elementary flux tube is @xmath92 where @xmath93 is the twist in the unit of turns and @xmath94 is the axial magnetic flux of the @xmath95th magnetic flux tube . in our case , there is only one major twisted flux tube ( or flux rope ) . the ratio between the radius and the length of the flux rope is less than @xmath96 as shown in figure  [ fig : twist2 ] , which shows that the radius is less than @xmath97 and the length is @xmath98 .",
    "therefore , the flux rope is relatively thin , and the magnetic helicity of the flux rope can be estimated as the twist since the axis of the flux rope is not highly kinked .    the axial magnetic flux of the flux rope is estimated as follows .",
    "we cut a section perpendicular to the flux rope at point 2 as shown in figure  [ fig : twist2 ] and as described in section  [ sec : twist ] .",
    "the magnetic flux of the flux rope is defined as the integration of the magnetic flux of the field lines belonging to the flux rope through the above defined cross section .",
    "the flux rope field lines have been defined in section  [ sec : twist ] as the axis field line and those sample field lines that are longer than it .",
    "we compute the axial magnetic field and the magnetic fluxes for all the 8 samples .",
    "the mean values of the 8 results are 520 g and @xmath99 mx , respectively .",
    "we have derived that the twist increasing rate is @xmath1 turns hr@xmath2 .",
    "following equation  ( [ eqn : hsi ] ) , the corresponding self - helicity increasing rate is @xmath100 , which is about 1.8% of the total helicity flux , @xmath0 , injected from the bottom boundary .",
    "@xcite analyzed three methods to compute the 2d squashing degree ( q ) maps in the 3d domain .",
    "they proposed that the third method ( their equations ( 12 ) to ( 22 ) ) is the most accurate , which we adopt to do the following analysis .",
    "the normal direction of the 2d cut points to the right .",
    "it moves from left to right to scan the 3d domain . to save the computation resource and to increase the spatial resolution",
    ", we only compute the qsls in a sub - domain of the nlfff computation box .",
    "for the time at 18:27 ut , the sub - domain is selected as @xmath101 $ ] , @xmath102 $ ] , and @xmath103 $ ] , where @xmath69 and @xmath62 are the heliocentric coordinates and @xmath104 represents the height referred to the solar surface .",
    "this sub - domain is resolved by @xmath105 grid points .",
    "therefore , the spatial resolution to compute the qsls is 5 times the original one to resolve the nlfff extrapolation .",
    "the 3d distribution of the squashing degree @xmath3 is derived by the scanning of the 2d vertical cuts along the @xmath69-axis .",
    "the maximum value is about @xmath106 .",
    "it is visualized by a 3d contour at @xmath107 as shown in figure  [ fig : qsl_j1 ] .",
    "the most prominent feature of the qsls is that they go along and wrap the flux rope .",
    "similar to the helical structure of the twisted magnetic field lines , the hollow shell of the qsl contours along the flux rope also have a helical shape .",
    "these qsls are associated with bald patches , where the magnetic field lines touch the bottom surface on the polarity inversion line and concave up .",
    "the magnetic field line mappings at the bald patches are discontinuous ; therefore , the @xmath3 values are extremely large in these regions .",
    "but due to the finite spatial resolutions , @xmath3 can not be infinite in practical numerical computations . also , as a generalization to true separatrix surfaces , such as those at the bald patches , qsls along the flux rope include more features .",
    "for example , the extended qsl contours at about @xmath108 $ ] represent some magnetic field lines bifurcating from the flux rope . the magnetic field line mappings are not necessarily discontinuous , but change drastically .",
    "besides the qsls with large @xmath3 values along the main flux rope , some are distributed in the eastern part detached from the flux rope at about @xmath109 $ ] as shown in figure  [ fig : qsl_j1]a .",
    "they belong to some sheared and twisted field lines to the east of the main flux rope .",
    "in fact , the _",
    "soho_/eit 195    image indicates the existence of these qsls as shown in figures  [ fig:195]a and [ fig:195]b , which shows that the brightening extended longer and more to the east than the main flux rope in figure  [ fig : qsl_j1]a . however , due to the limitation of the spatial resolution of _",
    "soho_/eit , it is not clear if the brightening feature disconnected in the middle part where the magnetic field lines disconnected .    in figure",
    "[ fig : qsl_j1 ] , we also plot the 3d contours of the electric current density , @xmath110 , where @xmath111 .",
    "similar to the distribution of the qsls , the electric currents are also along the magnetic flux rope .",
    "it is the basic property of the nlfff model , which requires that the electric current density , @xmath112 , is parallel to the magnetic field , @xmath7 .",
    "however , there is one major difference between the distributions of the qsls and the electric current density .",
    "it is a hollow shell for the qsls , but a solid body for the electric current density .",
    "to clearly display this feature , we plot the distributions of the qsls and the electric current density on three selected cuts , which are both perpendicular to the @xmath69-axis , as shown in figure  [ fig : qsl_j2 ] .",
    "it is found that the qsls , where the squashing degree is large , are self - closed or self - intersected at some places .",
    "but the electric current density is large at a center part , and the magnitude decreases from the center to the periphery . from figure",
    "[ fig : qsl_j2 ] , we also find that the places where @xmath113 is the largest is also where the qsls appears .",
    "but there are also places where qsls appear while @xmath113 is not necessarily large .",
    "if we plot the qsl cuts in the nlfff as shown in figure  [ fig : qsl ] , we can find clearly what magnetic field structures are associated with the qsls .",
    "an online only movie is attached to figure  [ fig : qsl ] to show the scanning of the qsl cut along the @xmath69-axis .",
    "it is found that the self - closed qsls are located at the border of the magnetic flux rope .",
    "in addition to these qsls , some other qsl sections are associated with highly sheared but not twisted field lines .",
    "a twisted field line points to the inverse direction as a potential field would do at the associated magnetic dips .",
    "this kind of qsls can be found , for example , in figures  [ fig : qsl_j2]b and [ fig : qsl]c as those qsl sections extend outside the flux rope .",
    "there are also some qsl sections inside the flux rope as shown in figures  [ fig : qsl_j2]c and [ fig : qsl]d .",
    "they are surrounded by the self - closed qsl sections and the electric current density is large there .",
    "two major cmes and the associated flares , m8.6 at 06:38 ut and x2.6 at 23:02 ut , occurred on 2005 january 15 in the fast evolving active region noaa 10720 . in a previous paper , @xcite found that a magnetic flux rope existed about 5 hours before the x2.6 flare by the nlfff model . in this paper",
    ", we further study the pre - flare brightening by the _ soho_/eit and compute the magnetic helicity injection , the vector velocity field , the twist accumulation , and the topology structure of the magnetic flux rope .",
    "first , the helicity flux density is computed via the expression , @xmath4 , proposed by @xcite and the velocity field is derived by the dave4vm method @xcite using the time series of vector magnetic fields observed by bbso / dvmg .",
    "next , we compute the twist of the flux rope using the nlfff model and the twist density formula proposed by @xcite . we have got the nlfff models at eight time points during about five hours before the x2.6 flare at 23:02 ut .",
    "thus , the time evolution of the twist is also derived in this period .",
    "finally , we compute the 3d distributions of the squashing degree , @xmath3 , via the scan of selected 2d cuts in the 3d domain using the method proposed in @xcite .",
    "the qsls are 3d volumes where the @xmath3 values are large .    with the above analysis",
    ", we have the following findings .",
    "first , there were five c and m class flares that appeared intermittently in the core field along the polarity inversion line in the five hour period before the x2.6 flare .",
    "the core field did not erupt to a cme until the one associated with the x2.6 flare .",
    "secondly , noaa 10720 was a fast evolving active region , where large horizontal flows and fast magnetic flux emergence existed .",
    "these photospheric motions injected negative magnetic helicity into the corona .",
    "the helicity injection rate was @xmath0 from 18:27 ut to 22:20 ut on 2015 january 15 .",
    "about 1.8% of the injected magnetic helicity became the internal helicity of the magnetic flux rope , resulting in the twist increasing with a rate of @xmath1 turns hr@xmath2 .",
    "the evolutions of the accumulated magnetic helicity and twist had a good correlation with each other .",
    "the correlation coefficient was about 0.6 .",
    "it is expected that most part of the magnetic helicity in a given magnetic configuration is stored in the mutual helicity . from the theoretical analysis of @xcite , the ratio of the self - helicity to the mutual helicity scales to @xmath114 , where @xmath5 is number of the elementary flux tubes in the magnetic field and it is usually large .",
    "besides , we only compute the self - helicity in one major flux rope , but do not count those in other elementary flux tubes .",
    "this may explain the large difference in quantity between the injected magnetic helicity and the self - helicity in the major flux rope , though they are highly correlated . as a test",
    ", we also estimate the total relative helicity contained in the computation box with the nlfff models , using the method proposed by @xcite .",
    "the preliminary results show that it is overall consistent with the injected magnetic helicity from the photosphere",
    ". however , since there are still large errors in the computed total relative magnetic helicity , an affirmative conclusion asks for a detailed error analysis and computations in a larger time range of , say , several days .",
    "thirdly , we find that the flux rope was wrapped by qsls , which were associated with bald patches and highly sheared and twisted magnetic field lines . the main feature of the qsls was a hollow shell , but there were also some qsls in the shell .",
    "the magnitude of the electric current density , @xmath113 , did not have a one to one correspondence to the qsls .",
    "for example , qsls with large @xmath3 were not necessarily associated with large @xmath113 , and the distributions of @xmath3 and @xmath113 are different .",
    "the largest @xmath3 was located on a shell and their distributions are highly intermittent . while the largest @xmath113 was located at a center and decreased to its periphery .",
    "the features of the qsl and electric current density distributions are similar for all the other 7 time points .",
    "@xcite made a detailed comparison between the electric current density and the qsl distributions for a sigmoid observed in 2007 february .",
    "the nlfff extrapolation was made using the flux rope insertion method .",
    "similar results are reached regarding the qsl distributions in @xcite and our studies .",
    "both @xcite and this work find that qsls wrap the boundary of a flux rope .",
    "qsls and strong currents do not necessarily match each other .",
    "there are qsls without strong electric currents .",
    "for example , qsls could appear in a potential magnetic field with no electric currents , such as the initial configuration of @xcite .",
    "strong currents can also exist where no qsls appear . here",
    ", we have to discriminate the difference between volume currents , which is aligned with the magnetic field , and current sheets , where the electric current is not parallel with the magnetic field .",
    "the electric current distribution found here represents the volume currents associated with the twisted magnetic flux rope .",
    "while qsls are preferential sites for non - field aligned currents , whose width is very thin .",
    "the current sheet is not found in the qsls derived by the nlfff model because of two reasons .",
    "first , the very small width of a current sheet is out of the resolution ability of the nlfff model .",
    "second , the nlfff model intends to smear out the non - field aligned currents ( it only allows field aligned currents ) .",
    "the current sheet formation can only be revealed by an mhd process , which has been shown in @xcite , @xcite , and @xcite .",
    "the difference between @xcite and our work lies mainly in the electric current density distributions .",
    "while @xcite found that the large electric current is distributed on a hollow shell ( see also @xcite ) , we find that it is located in a center region and decreases to its periphery . despite different nlfff extrapolation methods adopted by @xcite and us , the different distributions of the electric current density may reflect the different nature of the active regions , the former of which is a decaying active region and the latter is a new flux emerging region ( private communication with b. kliem ) .",
    "@xcite also found a hyperbolic flux tube ( hft ) , where two qsls intersect with each other and the @xmath3 value is very large .",
    "we have made time series of the 3d magnetic field and topology analysis at 8 time points .",
    "the last time is about 40 minutes before the flux rope eruption .",
    "we do not find hft along the flux rope in all the time series of the 3d magnetic fields .",
    "the difference may either reflect the real structures of the different active regions , or , come from the different extrapolation methods . in @xcite",
    ", on the one hand , there was a clear sigmoid in the active region ; on the other hand , the flux rope is ejected ( not in equilibrium ) and relaxes to a solution more or less close to the boundary .",
    "thus , the presence of a flux rope is an initial assumption .",
    "therefore , hft and bald patches are easy to appear . while with the optimization method , depending on the preprocessing parameters , it tends to smooth the currents and therefore reduce the size and strength of the flux rope .",
    "based on the above results , we propose the following scenario for the occurrence of the five confined flares and the x2.6 class eruptive flare .",
    "the photospheric motions caused by the magnetic flux emergence injected magnetic helicity ( and energy , which is not studied here ) continuously into the solar corona .",
    "although only a small part ( @xmath115 1.8% ) of the magnetic helicity was built into the magnetic twist of the flux rope , qsls were created around and inside it . according to previous studies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , electric currents are preferentially built up in qsls .",
    "once the strength of the electric currents were large enough to trigger the resistive instability , magnetic energy in the current layers was released by the magnetic reconnection , which also redistributed the magnetic helicity in the active region .",
    "the intermittent confined flares were the manifestation of this reconnection process .",
    "we find that the twist of the flux rope always exceeded the critical value of 1.5 and 1.75 turns for the kink instability found by @xcite and @xcite , respectively .",
    "however , the flux rope touched the photosphere in bald patches , where the line tied effects prevented the flux rope from an eruption via the kink instability .",
    "consequently , the flux rope did not rise to a height to trigger the torus instability that would lead to a full eruption . for the x2.6 eruptive flare ,",
    "the mechanism was most probably the same as that proposed in @xcite .",
    "an hft would be formed below the flux rope .",
    "tether - cutting magnetic reconnection @xcite is supposed to occur in the hft .",
    "the flux rope would erupt into the interplanetary space successfully via the loss - of - equilibrium @xcite or the torus instability @xcite .",
    "the authors thank b. kliem and s. yang for helpful discussions and thank the referee for constructive suggestions .",
    "yg , mdd , and xc were supported by the national natural science foundation of china ( nsfc ) under the grant numbers 11203014 , 10933003 , 11373023 , 11303016 , and the grant from the 973 project 2011cb811402 .",
    "and another arbitrary curve @xmath52 showing the way to compute the twist of two curves , where @xmath54 is the arc length from a reference point on @xmath51 .",
    "@xmath53 is a unit vector tangent to @xmath51 and @xmath55 denotes a unit vector normal to @xmath53 and pointing from @xmath51 to @xmath52 , where @xmath52 = @xmath116 .",
    "this figure is after figure  1 in @xcite .",
    ", scaledwidth=80.0% ]     square , which is perpendicular to the polynomial and to the photosphere .",
    "( b ) sample field lines of the flux rope at 18:27 ut on 2005 january 15 .",
    "the black line is the computed axis of the flux rope .",
    "the twist of the sample field lines about the axis is shown in the lower right corner.,scaledwidth=80.0% ]       on the bottom surface with the color scale shown in the lower right color bar .",
    "solid lines depict the magnetic field line , which is rendered according to the magnitude of the electric current density ( @xmath113 ) .",
    "golden surfaces represent the contours of the electric current density at @xmath117 .",
    "semitransparent white surfaces represent the contours of the squashing degree at @xmath107 .",
    "( a ) top view .",
    "( b ) side view.,scaledwidth=90.0% ]    ) and the magnitude of the electric current density ( @xmath113 ) on three selected vertical cuts at 18:27 ut on 2005 january 15 .",
    "the three cuts are perpendicular to the @xmath69-axis and at @xmath118 , @xmath119 , and @xmath120 for panels ( a ) , ( b ) , and ( c ) , respectively .",
    "the images display the distributions of the squashing degree on the cuts , and the contours display that of the electric current density .",
    "the levels of the contours are 8 , 10 , and 12 ma  m@xmath121 for the solid line from outmost to innermost.,scaledwidth=60.0% ]    -axis and at @xmath118 , @xmath119 , and @xmath120 for panels ( a)/(b ) , ( c ) , and ( d ) , respectively .",
    "the solid lines represent the magnetic field lines , which are rendered with the magnitude of the electric current density ( @xmath113 ) .",
    "the image parallel to the @xmath122-plane shows @xmath82 at @xmath123 , and the images parallel to the @xmath124-plane show the distributions of @xmath125 .",
    "the color scales for @xmath82 , @xmath113 , and @xmath125 are shown by the color bars in the lower part of the figure .",
    "( an animation showing the scanning of the vertical cut is available in the online journal.),scaledwidth=65.0% ]"
  ],
  "abstract_text": [
    "<S> to study the build up of a magnetic flux rope before a major flare and coronal mass ejection ( cme ) , we compute the magnetic helicity injection , twist accumulation , and the topology structure of the three dimensional magnetic field , which is derived by the nonlinear force - free field model . </S>",
    "<S> the extreme - ultraviolet imaging telescope on board the _ solar and heliospheric observatory _ observed a series of confined flares without any cme before a major flare with a cme at 23:02 ut on 2005 january 15 in active region noaa 10720 . </S>",
    "<S> we derive the vector velocity at eight time points from 18:27 ut to 22:20 ut with the differential affine velocity estimator for vector magnetic fields , which were observed by the digital vector magnetograph at big bear solar observatory . </S>",
    "<S> the injected magnetic helicity is computed with the vector magnetic and velocity fields . </S>",
    "<S> the helicity injection rate was @xmath0 . </S>",
    "<S> we find that only about 1.8% of the injected magnetic helicity became finally the internal helicity of the magnetic flux rope , whose twist increasing rate was @xmath1 turns hr@xmath2 . </S>",
    "<S> the quasi - separatrix layers ( qsls ) of the three dimensional magnetic field are computed by evaluating the squashing degree , @xmath3 . </S>",
    "<S> we find that the flux rope was wrapped by qsls with large @xmath3 values , where the magnetic reconnection induced by the continuously injected magnetic helicity further produced the confined flares . </S>",
    "<S> we suggest that the flux rope was built up and heated by the magnetic reconnection in the qsls . </S>"
  ]
}