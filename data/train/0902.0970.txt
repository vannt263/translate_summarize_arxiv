{
  "article_text": [
    "a _ phylogenetic birth - and - death model _ formalizes the evolution of an organism - specific census variable along a phylogeny . the phylogeny is a rooted tree , i.e. , a connected acyclic graph in which the edges are directed away from a special node designated as the tree root ; the terminal nodes , or _ leaves _ ,",
    "are bijectively labeled by the organisms .",
    "the model specifies edge lengths , as well as birth - and - death processes @xcite acting on the edges .",
    "let  @xmath0 denote the set of edges , and let  @xmath1 denote the node set of the tree .",
    "populations of identical individuals evolve along the tree from the root towards the leaves by galton - watson processes . at non - leaf nodes of the tree",
    ", populations are instantaneously copied to evolve independently along the adjoining descendant edges .",
    "let the random variable  @xmath2 denote the population count at every node  @xmath3 .",
    "every edge  @xmath4 is characterized by a loss rate  @xmath5 , a duplication rate  @xmath6 and a gain rate  @xmath7 . if  @xmath8 is a linear birth - and - death process @xcite with these rate parameters , then @xmath9 where  @xmath10 is the edge length , which defines the time interval during which the birth - and - death process runs .",
    "the joint distribution of  @xmath11 is determined by the phylogeny , the edge lengths and rates , along with the distribution at the root  @xmath12 , denoted as @xmath13 .",
    "specifically , for all set of node census values @xmath14 , @xmath15}\\ ] ] where @xmath16 } = { \\condgen{{\\mathbb{p}}}{\\bigl\\{}{\\bigm|}{\\bigr\\}}{x(t_{xy})=m}{x(0)=n}}$ ] denotes the transition probability on the edge  @xmath17 for the markov process operating there .",
    "it is assumed that one can observe the population counts at the terminal nodes ( i.e. , leaves ) , but not at the inner nodes of the phylogeny .",
    "since individuals are considered identical , we are also ignorant of the ancestral relationships between individuals within and across populations .",
    "the population counts at the leaves form a _",
    "phylogenetic profile_. our central problem is to compute the likelihood of a profile , i.e. , the probability of the observed counts for fixed model parameters .",
    "the transient distribution of linear birth - and - death processes is well - characterized @xcite , as shown in table  [ tbl : bd ] .",
    "table  [ tbl : bd ] precisely states the distribution of xenolog and inparalog group sizes .",
    ".transient behavior of linear birth - and - death processes with loss rate  @xmath18 , gain rate @xmath19 and duplication rate  @xmath20 : gain - loss - duplication ( * gld * ) , gain - loss ( * gl * ) , duplication - loss ( * dl * ) and pure - loss ( * pl * ) models .",
    "the last column of the table shows the relevant group for computing transition probabilities in a phylogenetic birth - and - death model . for the meaning of xenolog and inparalog groups ,",
    "see the main text . [ cols=\"<,<,<,<\",options=\"header \" , ]     [ [ parameters ] ] parameters : + + + + + + + + + + +    @xmath21    [ [ distributions ] ] distributions : + + + + + + + + + + + + + +    @xmath22    the distribution of population counts can be obtained analytically from the constituent distributions of table  [ tbl : bd ] , as shown by the following lemma .",
    "[ lm : psum ] let  @xmath23 be independent random variables that have identical , shifted geometric distributions with parameters  @xmath24 and  @xmath25 .",
    "let  @xmath26 be a discrete nonnegative random variable that is independent from @xmath27 , with probability mass function @xmath28 .",
    "define  @xmath29 } = { \\mathbb{p}}\\{{\\eta}+\\sum_{i=1}^n { \\zeta}_i = m\\}$ ] for all @xmath30 , and @xmath31 } = { \\mathbb{p}}\\{{\\eta}+\\sum_{i=1}^n { \\zeta}_i = m ; \\forall { \\zeta}_i>0\\}$ ] for all @xmath32 .",
    "these values can be expressed recursively as follows .",
    "[ eq : sumo ] @xmath33 } & = { h(m ) } & \\{m\\ge 0\\}\\label{eq : sumo.0m}\\\\ { { w}[{0}\\vert{n } ] } & = p\\cdot { { w}[{0}\\vert{n-1 } ] } & \\{n>0\\}\\label{eq : sumo.n0}\\\\ { { w}[{1}\\vert{n } ] } & = p\\cdot { { w}[{1}\\vert{n-1 } ] } + ( 1-p)(1-q ) \\cdot{{w}[{0}\\vert{n-1 } ] }      & \\{n>0\\}\\label{eq : sumo.n1}\\\\ { { w}[{m}\\vert{n } ] } & =      \\begin{aligned}[t ]        & q \\cdot{{w}[{m-1}\\vert{n } ] } \\\\      & + ( 1-p - q ) \\cdot{{w}[{m-1}\\vert{n-1 } ] } \\\\      & + p \\cdot{{w}[{m}\\vert{n-1 } ] }       \\end{aligned } & \\{n>0,m>1\\ } \\label{eq : sumo.nm}\\end{aligned}\\ ] ]    furthermore ,    [ eq : sumi ] @xmath34 } & = { h(m ) } & \\{m\\ge 0\\ } \\label{eq : sumi.0m}\\\\ { { w}^{*}[{n}\\vert { n } ] } & = ( 1-p)(1-q ) \\cdot{{w}^{*}[{n-1}\\vert { n-1 } ] } & \\{n>0\\}\\label{eq : sumi.nn}\\\\ * { { w}^{*}[{m}\\vert { n } ] } & =       \\begin{aligned}[t ]          & q \\cdot{{w}^{*}[{m-1}\\vert { n}]}\\\\ *          & + ( 1-p)(1-q)\\cdot { { w}^{*}[{m-1}\\vert { n-1 } ] }      \\end{aligned } & \\{m >",
    "n>0\\}\\label{eq : sumi.nm}\\end{aligned}\\ ] ]    for every edge  @xmath17 , equation   provides the transition probabilities  @xmath35}={{w}[{m}\\vert{n}]}$ ] in  , when  @xmath24 , @xmath25 and @xmath36 are taken from table  [ tbl : bd ] for the process operating on the edge  @xmath17 .",
    "equation   is used below in our formulas .",
    "a key factor in inferring the likelihood formulas is the probability that a given individual at a tree node  @xmath37 has no descendants at the leaves within the subtree rooted at  @xmath37 .",
    "the corresponding _ extinction probability _ is denoted by  @xmath38 .",
    "an individual at node  @xmath37 is referred to as _ surviving _ if it has at least one progeny at the leaves descending from  @xmath37 .",
    "let  @xmath39 denote the number of surviving individuals at each node  @xmath37 .",
    "the distribution of  @xmath39 can be related to that of  @xmath40 by @xmath41    the next two lemmas characterize the number of surviving xenologs and inparalogs : they follow the same class of distributions as the total number of xenologs and inparalogs .",
    "[ lm : paralog.survive ] for every edge  @xmath4 , let @xmath42 denote the probability that there are  @xmath43 surviving members within an inparalog group at  @xmath44 . then @xmath45 with @xmath46    [ lm : xenolog.survive ] for every edge  @xmath4 , let @xmath47 denote the probability that there are  @xmath43 xenologs at  @xmath44 that survive . if @xmath48 , then @xmath49 where @xmath50 .",
    "if @xmath51 , then @xmath52 .    in the formulas to follow , we use the probabilities @xmath53}$ ] , which apply lemma  [ lm : psum ] to surviving populations on edge  @xmath17 : @xmath53}={{w}^{*}[{m}\\vert { n}]}$ ] , where the latter is defined by equation   with settings @xmath54 , @xmath55 , @xmath56 from lemmas  [ lm : paralog.survive ] and  [ lm : xenolog.survive ] .",
    "lemma  [ lm : paralog.survive ] provides the means to compute extinction probabilities in a postorder traversal of the phylogeny .",
    "[ lm : extinct ] if  @xmath37 is a leaf , then  @xmath57 .",
    "otherwise , let  @xmath37 be the parent of  @xmath58 .",
    "then @xmath38 can be written as @xmath59",
    "let  @xmath60 denote the set of leaf nodes .",
    "a phylogenetic profile  @xmath61 is a function @xmath62 , which are the population counts observed at the leaves .",
    "define the notation @xmath63 for the partial profile within a subset  @xmath64 .",
    "similarly , let  @xmath65 denote the vector - valued random variable composed of individual population counts .",
    "the _ likelihood _ of  @xmath61 is the probability @xmath66 let  @xmath67 denote the subtree of  @xmath68 rooted at node  @xmath37 .",
    "define the _ survival count range _",
    "@xmath69 for every node  @xmath70 as @xmath71 .",
    "the survival count ranges are calculated in a postorder traversal , since @xmath72    we compute the likelihood using _ conditional survival likelihoods _ defined as the probability of observing the partial profile within  @xmath67 given the number of surviving individuals @xmath39 : @xmath73 } = { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\xi}\\bigl({{\\mathcal{l}}({t}_x)}\\bigr)={\\phi}\\bigl({{\\mathcal{l}}({t}_x)}\\bigr ) .",
    "{ \\xi}(x)=n}\\ ] ] for  @xmath74 , @xmath75}=0 $ ] . for values",
    "@xmath76 , the conditional survival likelihoods can be computed recursively as shown in theorem  [ tm : likelihood.recursion ] below .",
    "[ tm : likelihood.recursion ] if node  @xmath37 is a leaf , then @xmath73 }       = \\begin{cases }          0 & \\text{if $ n \\ne { \\phi}(x)$;}\\\\ *          1 & \\text{if $ n = { \\phi}(x)$. }      \\end{cases}\\ ] ] if  @xmath37 is an inner node with children  @xmath77 , then @xmath78}$ ] can be expressed using @xmath79}$ ] and auxiliary values @xmath80 and  @xmath81 for @xmath82 in the following manner .",
    "let @xmath83}$ ] denote the transition probability in lemma  [ lm : psum ] , applied to surviving individuals at  @xmath84 , using the distributions  @xmath85 from lemma  [ lm : xenolog.survive ] and @xmath86 from lemma  [ lm : paralog.survive ] .",
    "let  @xmath87}=\\sum_{i=1}^j m_{x_i}$ ] for all @xmath88 and @xmath89}=0 $ ] .",
    "define also @xmath90 } = \\prod_{i=1}^j { g_{x_i}(0)}$ ] and @xmath91}=1 $ ] .",
    "auxiliary values @xmath92 are defined for all @xmath82 , @xmath93}$ ] and @xmath94 as follows .",
    "[ eq : lineagelik ] @xmath95 } { { l}_{x_i}[m ] } & \\{0\\le s\\le m_{x_i}\\}\\label{eq : llik.i0s}\\\\ *   { b_{i ; t , m_{x_i } } } & = { g_{x_i}(0 ) } { b_{i ; t-1 , m_{x_i } } } & \\{0<t\\le { m[i-1]}\\}\\label{eq : llik.itm}\\\\ * { b_{i ; t , s } } & = { b_{i ; t-1 , s+1 } } + { g_{x_i}(0 ) } { b_{i ; t-1 , s } }       &    \\bigl\\{\\begin{smallmatrix }              0\\le s < m_{x_i}\\\\              0<t\\le{m[i-1 ] }              \\end{smallmatrix}\\bigr\\ } \\label{eq : llik.its}\\end{aligned}\\ ] ]    for all  @xmath82 and @xmath96}$ ] , define @xmath97 as    [ eq : recursion.section ] @xmath98})^{-n } { b_{1 ; 0 , n } } ; \\label{eq : recursion.section.1}\\\\ { a_{i;n } } & = \\bigl(1-{d[i]}\\bigr)^{-n }       \\sum_{\\substack{0\\le t\\le m[i-1]\\\\0\\le s\\le m_{x_i}\\\\t+s = n } }        \\mathsf{binomial}(s ; n , { d[i-1 ] } )          { a_{i-1;t } } { b_{i ; t , s}},\\label{eq : recursion.section.i}\\end{aligned}\\ ] ]    where @xmath99 in  .    for all @xmath100 , @xmath78 } = { a_{{c};n}}$ ]",
    ".    the complete likelihood is computed as @xmath101}{\\mathbb{p}}\\{{\\xi}(\\rho)=m\\}\\\\      = \\sum_{m=0}^{m_{\\rho } } { { l}_{\\rho}[m]}\\biggl(\\sum_{i=0}^\\infty { \\gamma}(m+i ) \\binom{m+i}{i } { d_{\\rho}}^i ( 1-{d_{\\rho}})^m\\biggr).\\end{gathered}\\ ] ]    for some parametric distributions  @xmath102 , the infinite sum in   can be replaced by a closed formula for  @xmath103 .",
    "theorem  [ tm : likelihood.finite ] below considers the stationary distributions for gain - loss - duplication and gain - loss models .",
    "[ tm : likelihood.finite ] for negative binomial or poisson population distribution at the root , the likelihood can be expressed as shown below .    1 .   if @xmath104 , then @xmath105 with @xmath106 .",
    "2 .   if @xmath107 , then @xmath108 with @xmath109 .",
    "3 .   if @xmath110 has a bernoulli distribution , i.e. , if @xmath111 , then @xmath112 } + p\\bigl(1-{d_{\\rho}}\\bigr ) \\bigl({{l}_{\\rho}[1]}-{{l}_{\\rho}[0]}\\bigr)\\ ] ]    consequently , the likelihood for a poisson distribution at the root is computed as @xmath113 } \\mathsf{poisson}\\bigl(m;\\gamma(1-{d_{\\rho}})\\bigr),\\ ] ] where  @xmath114 is the mean family size at the root .",
    "the algorithm we describe computes the likelihood of a phylogenetic profile for a given set of model parameters .",
    "algorithm computeconditionals below proceeds by postorder ( depth - first ) traversals ; the necessary variables are calculated from the leaves towards the root .",
    "the loop of line  [ line : loop.transition ] computes the transition probabilities @xmath115}$ ] , extinction probabilities @xmath116 and survival count ranges @xmath117 .",
    "the loop of line  [ line : loop.likelihood ] carries out the computations suggested by theorem  [ tm : likelihood.recursion ] .",
    "[ tm : runtime ] let  @xmath68 be a phylogeny with  @xmath43 nodes where every node has at most @xmath118 children .",
    "let  @xmath119 denote the tree height , i.e. , the maximum number of edges from the root to a leaf the computeconditionals algorithm computes the conditional survival likelihoods for a phylogenetic profile  @xmath61 on  @xmath68 in @xmath120 time , where  @xmath121 is the total number of homologs .",
    "if  @xmath122 is constant , then the running time bound of theorem  [ tm : runtime ] is @xmath123 . for almost all phylogenies in a yule - harding random model , @xmath124 ,",
    "so the typical running time is  @xmath125 .",
    "for all phylogenies , @xmath126 , which yields a  @xmath127 worst - case bound .",
    "0.98    computeconditionals    * input : * phylogenetic profile @xmath61    * for * each node @xmath70 in a postorder traversal * do*[line : loop.transition ]    compute the sum of gene counts @xmath69 by  .[line : ranges ]    compute @xmath38 using .[line : extinct ]    * if * @xmath37 is not the root [ line : survive.loop ]    * then * let @xmath44 be the parent of @xmath37.[line : survive.body ]    * for * @xmath100 * do *    * for * @xmath128 * do *    compute @xmath129}$ ] using with @xmath130 and @xmath131 from lemmas  [ lm : xenolog.survive ] and  [ lm : paralog.survive].[line : sumi ]    * for * each node @xmath70 in a postorder traversal * do*[line : loop.likelihood ]    * if * @xmath37 is a leaf    * then * * for * all @xmath132 * do * set @xmath78}{\\leftarrow}\\{n={\\phi}(x)\\}$ ]    * else *    let @xmath77 be the children of @xmath37    initialize @xmath133{\\leftarrow}0 $ ] and @xmath134{\\leftarrow}1 $ ]    * for * @xmath135 * do*[line : loop.lineages ]    set @xmath136{\\leftarrow}m[i-1]+m_{x_i}$ ] and @xmath137{\\leftarrow}d[i-1 ] \\cdot { d_{x_i}}$ ]    * for * all @xmath138 $ ] and @xmath139 * do *    compute @xmath92 by eqs .     *",
    "if * @xmath140 * then * * for * all @xmath141 $ ] * do * set @xmath142})^{-n } { b_{1 ; 0 , n}}$ ]    * else *    * for * all @xmath141 $ ] * do * initialize @xmath143    * for * @xmath138 $ ] and @xmath139 * do *     set @xmath144 } )          { a_{i-1;t } } { b_{i ; t , s}}$ ]    * for * all @xmath141 $ ] * do * @xmath145}\\bigr)^{-n } { a_{i;n}}$ ]    * for * all @xmath146 * do * set @xmath78 } { \\leftarrow}{a_{{c};n}}$ ] .",
    "equations   and   are immediate since @xmath147 } = { { w}^{*}[{m}\\vert { 0}]}={\\mathbb{p}}\\{{\\eta}=m\\ } = { h(m)}.\\ ] ] by the independence of  @xmath27 , for all @xmath148 , @xmath149 } = { \\mathbb{p}}\\{{\\eta}+\\sum_{i=1}^n { \\zeta}_i=0\\ }       = { { w}[{0}\\vert{n-1 } ] } { \\mathbb{p}}\\{{\\zeta}_{n}=0\\ } = { { w}[{0}\\vert{n-1}]}\\cdot p,\\ ] ] as in  .",
    "let  @xmath150 be the common probability mass function of  @xmath27 .",
    "for  @xmath151 , @xmath152 } = { \\mathbb{p}}\\bigl\\{{\\eta}+\\sum_{i=1}^n { \\zeta}_i = m\\bigr\\ }                 = \\sum_{k=0}^m { \\mathbb{p}}\\{{\\zeta}_n = k\\}\\cdot{\\mathbb{p}}\\bigl\\{{\\eta}+\\sum_{i=1}^{n-1}{\\zeta}_i = m - k\\bigr\\}\\\\                = \\sum_{k=0}^m { g(k)}\\cdot { { w}[{m - k}\\vert{n-1}]}.\\end{gathered}\\ ] ] for  @xmath153 , is tantamount to  , since @xmath154 and @xmath155 . for  @xmath156",
    ", can be further rewritten using  @xmath157 for all  @xmath158 : @xmath159 }   & =       \\begin{aligned}[t ]          & { g(0)}\\cdot { { w}[{m}\\vert{n-1 } ] } + { g(1)}\\cdot { { w}[{m-1}\\vert{n-1}]}\\\\          & + \\sum_{k=2}^m q { g(k-1 ) } \\cdot{{w}[{m - k}\\vert{n-1 } ] }      \\end{aligned}\\\\ & =           \\begin{aligned}[t ]          & p \\cdot{{w}[{m}\\vert{n-1 } ] } + { g(1)}\\cdot { { w}[{m-1}\\vert{n-1}]}\\\\          & + q \\sum_{k=1}^{m-1 } { g(k ) } \\cdot{{w}[{m-1-k}\\vert{n-1 } ] }      \\end{aligned}\\\\ & =           \\begin{aligned}[t ]          & p \\cdot{{w}[{m}\\vert{n-1 } ] } + { g(1)}\\cdot { { w}[{m-1}\\vert{n-1}]}\\\\          & + q \\bigl({{w}[{m-1}\\vert{n}]}-{g(0)}\\cdot{{w}[{m-1}\\vert{n-1}]}\\bigr ) ,       \\end{aligned}\\end{aligned}\\ ] ] which leads to the recursion of   since  @xmath160 .",
    "equation   follows from @xmath161 } = { \\mathbb{p}}\\bigl\\{{\\eta}+\\sum_{i=1}^n { \\zeta}_i = n ; \\forall { \\zeta}_i>0\\bigr\\ }      = { \\mathbb{p}}\\{{\\eta}=0\\}\\cdot \\prod_{i=1}^n { \\mathbb{p}}\\{{\\zeta}_i=1\\ } = h(0)\\bigl(g(1)\\bigr)^n.\\ ] ] for @xmath162 , @xmath163 } & = { \\mathbb{p}}\\bigl\\{{\\eta}+\\sum_{i=1}^n { \\zeta}_i = m ; { \\zeta}_i>0\\bigr\\ } \\\\               & = \\sum_{k=1}^{m - n+1 } { \\mathbb{p}}\\{{\\zeta}_n = k\\}\\cdot { { w}^{*}[{m - k}\\vert { n-1}]}\\\\               & = \\sum_{k=1}^{m - n+1 } { g(k)}\\cdot { { w}^{*}[{m - k}\\vert { n-1}]}\\\\               & = { g(1)}\\cdot{{w}^{*}[{m-1}\\vert { n-1 } ] } + \\sum_{k=2}^{m - n+1 } q { g(k-1)}\\cdot { { w}^{*}[{m - k}\\vert { n-1}]}\\\\               & = { g(1)}\\cdot{{w}^{*}[{m-1}\\vert { n-1 } ] } + q\\cdot { { w}^{*}[{m}\\vert { n-1}]},\\end{aligned}\\ ] ] as claimed in  .",
    "lemmas  [ lm : paralog.survive ] and  [ lm : xenolog.survive ] rely on the following general result .",
    "[ lm : extinctionsum.generating ]    let @xmath164 be a fixed parameter , and let @xmath165 and @xmath166 be two number sequences related by the formula @xmath167 ( we use the convention @xmath168 in the formula when @xmath169 . ) let  @xmath170 and @xmath171 denote the generating functions for the sequences",
    ". then @xmath172    if @xmath173 , then @xmath174 , and , thus   holds .",
    "if @xmath175 , then @xmath176 , and @xmath177 for @xmath148 , which implies  . otherwise , @xmath178 as claimed .",
    "[ cor : extinctionsum.distribution ] let  @xmath165 and  @xmath166 be two probability mass functions for non - negative integer random variables , related as in  .    1 .   if @xmath179 , then @xmath180 with @xmath181 2 .   if @xmath182 , then @xmath183 , where @xmath184 is defined as in  .",
    "3 .   if @xmath185 , then @xmath186 with @xmath187 .",
    "the corollary follows for plugging into lemma  [ lm : extinctionsum.generating ] the generating functions @xmath188 , @xmath189 and @xmath190 for the shifted geometric , negative binomial , and poisson distributions , respectively .",
    "let  @xmath191 be the random variable that is the size of an inparalog group at node  @xmath44 .",
    "in order to have  @xmath43 surviving inparalogs , there must be @xmath192 inparalogs in total , out of which  @xmath193 do not survive , for some  @xmath194 . therefore , @xmath195by table  [ tbl : bd ] , @xmath196 where the distribution parameters  @xmath24 and  @xmath25 are determined by the parameters of the birth - and - death process on the edge leading to  @xmath44 ( @xmath197 in the degenerate case where duplication rate is  0 ) .",
    "the lemma thus follows from corollary  [ cor : extinctionsum.distribution ] with  @xmath198 .",
    "let  @xmath26 be the random variable that is the size of the xenolog group at  @xmath44 .",
    "in order to have  @xmath43 surviving xenologs , there must be @xmath192 xenologs in total , out of which  @xmath193 do not survive , for some  @xmath194 . therefore , @xmath199 by table  [ tbl : bd ] if @xmath200 , then @xmath26 has a poisson distribution with parameter  @xmath201 ; otherwise , @xmath26 has a negative binomial distribution with parameters  @xmath202 and  @xmath25 . in either case",
    ", the lemma follows from corollary  [ cor : extinctionsum.distribution ] after setting  @xmath203 .    for leaves ,",
    "the statement is trivial .",
    "when  @xmath37 is not a leaf , the lemma follows from the fact that survivals are independent between disjoint subtrees .",
    "the formulas are obtained by tracking survival within the lineages  @xmath204 among the individuals at  @xmath37 .",
    "define the indicator variables  @xmath205 for each individual @xmath206 and lineage @xmath207 , taking the value  1 if and only if individual  @xmath208 has at least one surviving offspring at  @xmath84 . in order to work with the survivals",
    ", we introduce some auxiliary random variables that have the distributions of surviving xenologs and inparalogs . for every edge  @xmath204 ,",
    "define the sequence of independent random variables @xmath209 with identical distributions  @xmath86 , and the random variable  @xmath210 with distribution @xmath85 .",
    "consequently , @xmath211 , and @xmath212 . by lemma",
    "[ lm : paralog.survive ] , @xmath213 with some  @xmath214 and  @xmath184 .",
    "define the shorthand notation @xmath215 for observing the counts in the subtree rooted at  @xmath84 .",
    "let @xmath216 in other words , if there are @xmath217 individuals at  @xmath37 , then @xmath92 is the probability that  @xmath218 selected individuals survive in the lineage  @xmath204 and the given profile is observed in  @xmath219 . by lemma  [ lm : psum ] , @xmath220}\\cdot { { w}^{*}_{x_i}[{m}\\vert{s}]}\\end{aligned}\\ ] ] as shown in  . if @xmath221 , then @xmath222      & { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\phi}_i ;      x_{i , s+1}=0 ;   \\sum_{j=1}^s x_{ij}=s \\\\ { \\xi}(x)=t+s } *      + & { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\phi}_i ;      x_{i , s+1}=1 ; \\sum_{j=1}^s x_{ij}=s \\end { \\xi}(x)=t+s}{aligned}\\\\      & = \\begin{aligned}[t ]          & { g_{x_i}(0 ) } \\cdot{{{{\\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\phi}_i ;           \\sum_{j=1}^s x_{ij}=s \\\\ { \\xi}(x)=t+s-1 } *          + &   { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\phi}_i ;           \\sum_{j=1}^{s+1 } x_{ij}=s+1 \\end { \\xi}(x)=t+s}{aligned } \\\\       & = { g(0 ) } \\cdot { b_{i ; t-1 , s } } + { b_{i ; t-1 , s+1}},\\end{aligned}\\ ] ] which is tantamount to  . equation   follows from the fact that @xmath223 for @xmath224 .    for every  @xmath193 ,",
    "let  @xmath225 denote the set of individuals at  @xmath37 that survive in at least one of the lineages @xmath226 , i.e. , @xmath227 .",
    "given the exchangeability of individuals , @xmath228 is the same for all sets of the same size @xmath229 .",
    "let @xmath230 in particular , @xmath231 and , thus , @xmath232}$ ] .",
    "since @xmath97 is the same for all values of  @xmath233 , and @xmath234 is determined solely by survival in lineage  @xmath235 , @xmath236})^n { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\phi}_1 = |\\mathcal{y}_1|=n } ( 1-{d[1]})^n { a_{1;n}},\\end{aligned}\\ ] ] implying  .    by a similar reasoning for  @xmath99 , @xmath237           & = { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } |\\mathcal{y}_i|=n \\cdot { \\xi}(x)=n } { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\phi}_1;\\dotsc;{\\phi}_i \\\\ |\\mathcal{y}_i|=n;{\\xi}(x)=n } *          & = ( 1-{d[i]})^n { a_{i;n } }      \\end{aligned}\\end{gathered}\\ ] ] let  @xmath238 denote the set of individuals that survive in the lineage  @xmath204 : @xmath239 .",
    "we rewrite the left - hand side of   by conditioning on the set of individuals that survive in lineage  @xmath204 but not in the lineages  @xmath235,  ,@xmath240 . @xmath241       & =           \\sum_{\\mathcal{s}\\in 2^{[n ] } } \\begin{aligned}[t ]              & { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\phi}_i ; \\mathcal{x}_i\\setminus\\mathcal{y}_{i-1}=\\mathcal{s } \\\\ { \\xi}(x)=n }              & \\times{{{{\\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\phi}_1;\\dotsc;{\\phi}_{i-1 } ; \\mathcal{y}_{i-1}=[n]\\setminus\\mathcal{s } \\end { \\xi}(x)=n}{aligned}\\\\      & = \\sum_{s+t = n } { b_{i ; t , s } } { a_{i-1;t } } { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } |\\mathcal{y}_{i-1}|=t \\\\ { \\xi}(x)=n }      & = \\sum_{s+t = n } { b_{i ; t , s } } { a_{i-1;t } } \\binom{t+s}{s } ( { d[i-1]})^s(1-{d[i-1]})^t .       \\end{aligned}\\end{gathered}\\ ] ] combining this latter equality with   leads to  .    by  , lemma",
    "[ lm : extinctionsum.generating ] with  @xmath242 shows the relationship between the generating functions for the distributions of  @xmath40 and  @xmath39 .",
    "the theorem considers the case when  @xmath37 is the root and corollary  [ cor : extinctionsum.distribution ] applies to  @xmath243 .    by theorem  [ tm : likelihood.recursion ]",
    ", the algorithm correctly computes the conditional survival likelihoods .",
    "let  @xmath68 be the phylogeny with root  @xmath12 and  @xmath43 nodes .",
    "in order to prove the running time result , consider first the loop of line  [ line : loop.transition ] .",
    "lines  [ line : ranges][line : survive.body ] take  @xmath244 time for each  @xmath70",
    ". line  [ line : sumi ] is executed  @xmath245 times for every non - root  @xmath37 . if  @xmath37 is an inner node with children  @xmath246 , then @xmath247 .",
    "consequently , @xmath248 now , consider the _ tree levels _",
    "@xmath249 , where  @xmath250 , and for all  @xmath251 , @xmath252 consists of all the children of nodes in  @xmath253 . in other words , @xmath252 is the set of nodes that are reached through  @xmath193 edges from the root . by  ,",
    "@xmath254 for all  @xmath255 .",
    "therefore , @xmath256 so , @xmath257 therefore , executing line  [ line : sumi ] through all iterations takes  @xmath258 time . in order to bound",
    "the loop s running time in line  [ line : loop.likelihood ] , consider the @xmath92 and @xmath97 values that are needed for a given node  @xmath37 with children @xmath77 . by",
    ", computing all  @xmath259 values takes @xmath260 time . every @xmath92 with @xmath221 and @xmath97",
    "is calculated in  @xmath244 time .",
    "using the bound  @xmath136\\le m_x$ ] , iteration  @xmath193 of the loop in line  [ line : loop.lineages ] takes @xmath261 time . by summing for  @xmath82 , we get that for node  @xmath37 with  @xmath262 children , the loop of line  [ line : loop.likelihood ] takes @xmath263 time ( since @xmath264 ) .",
    "now , @xmath265 , and @xmath266 by our previous discussions , @xmath267 so , the loop of line  [ line : loop.likelihood ] takes @xmath268 time , which leads to the theorem s claim when combined with the bound on the loop s running time in line  [ line : loop.transition ] .",
    "suppose that profiles are restricted to the condition that @xmath269 must hold for at least one terminal node  @xmath37 .",
    "the corresponding likelihoods @xmath270 are obtained from the full likelihood by employing a correction that involves the probability of the condition  @xcite .",
    "namely , @xmath271 the probability that @xmath272 at all the leaves is the likelihood of the all-0 profile @xmath273 . by theorem  [ tm : likelihood.recursion ] ,",
    "@xmath274}=\\prod_{xy\\in\\mathcal{e}({t } ) } { h_{y}(0)}$ ] for the profile  @xmath275 . combined with",
    ", we have the correction formula @xmath276 with @xmath277 for @xmath278 .",
    "given a profile  @xmath61 , the posterior probabilities for gene family size at node  @xmath37 are computed by using the conditional survival likelihoods  @xmath78}$ ] and likelihoods of some relevant profiles on truncated phylogenies . in order to compute the gene content at node  @xmath37 , for example , consider the profile  @xmath279 for all  @xmath280 that applies to a phylogeny obtained by pruning the edges below  @xmath37 , that is , @xmath281 for @xmath282 and @xmath283 .",
    "let  @xmath284 denote the likelihood of  @xmath279 on the pruned tree .",
    "then @xmath285 } }      { { l}}\\ ] ] gives the posterior probability that the family had  @xmath280 homologs at node  @xmath37 .",
    "the number of families present at node  @xmath37 , denoted by  @xmath286 , is inferred as a posterior mean value by summing posterior probabilities : @xmath287 where @xmath288 are the profiles in the data set and @xmath289 is the likelihood of the all-0 profile  @xmath275 from  .",
    "notice that the formula includes the absent all-0 profiles ; there are @xmath290 such profiles by expectation .    for each edge  @xmath17 ,",
    "the posterior probabilities for _ gain _ , _ loss _ , _ expansion _ and _ contraction _ are : @xmath291 where all probabilities are conditioned on the observation of the phylogenetic profile  @xmath292 .",
    "expected numbers for gains , losses , expansions and contractions on each edge  @xmath17 are computed by formulas analogous to  .",
    "posterior probabilities of the general form @xmath293 , characterizing lineage - specific family size changes on edge  @xmath17 , can also be computed by using survival likelihoods on truncated phylogenies . in particular , we decompose the events as @xmath294          & { \\mathbb{p}}\\bigl\\{{\\xi}(x)=n , { \\xi}\\bigl({{\\mathcal{l}}({t})}\\setminus{{\\mathcal{l}}({t}_x)}\\bigr)={\\phi}\\bigl({{\\mathcal{l}}({t})}\\setminus{{\\mathcal{l}}({t}_x)}\\bigr)\\bigr\\}\\\\          \\times & { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\xi}(y)=m , { \\xi}\\bigl({{\\mathcal{l}}({t}_y)}\\bigr)={\\phi}\\bigl({{\\mathcal{l}}({t}_y)}\\bigr ) \\\\ { \\xi}(x)=n }          \\times & { { { { \\mathbb{p}}}\\bigl\\{}{\\bigm|}{\\bigr\\ } } { \\xi}\\bigl({{\\mathcal{l}}({t}_x)}\\setminus{{\\mathcal{l}}({t}_y)}\\bigr)={\\phi}\\bigl({{\\mathcal{l}}({t}_x)}\\setminus{{\\mathcal{l}}({t}_y)}\\bigr ) , { \\xi}(x)=n }          \\end{aligned}\\end{gathered}\\ ] ] where the second factor can be written as @xmath295}.\\end{gathered}\\ ] ] figure  [ fig : posterior.decomposition ] illustrates the decomposition of the phylogeny into three parts , corresponding to the three factors in  .",
    "mikls csrs and istvn mikls .",
    "a probabilistic model for gene content evolution with duplication , loss , and horizontal transfer .",
    ", 3909:206220 , 2006 .",
    "tenth annual international conference on research in computational molecular biology ( recomb ) ."
  ],
  "abstract_text": [
    "<S> a phylogenetic birth - and - death model is a probabilistic graphical model for a so - called phylogenetic profile , i.e. , the size distribution for a homolog gene family at the terminal nodes of a phylogeny . </S>",
    "<S> profile datasets are used in bioinformatics analyses for the inference of evolutionary trees , and of functional associations between gene families , as well as for the quantification of various processes guiding genome evolution . here </S>",
    "<S> we describe the mathematical formalism for phylogenetic birth - and - death models . </S>",
    "<S> we also present an algorithm for computing the likelihood in a gain - loss - duplication model .    for background information on phylogenetic birth - and - death models , see  @xcite ( preprint available under http://arxiv.org/abs/q-bio/0509037v1 ) . here </S>",
    "<S> we give a self - containg comprehensive review , concentrating on the mathematical results . </S>",
    "<S> we describe our new algorithm for a very general class of gain - loss - duplication models . </S>"
  ]
}