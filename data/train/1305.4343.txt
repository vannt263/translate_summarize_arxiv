{
  "article_text": [
    "generalizing the well known construction of the homogeneous coordinate ring of a toric variety  @xcite , one associates to any normal complete variety @xmath0 defined over an algebraically closed field @xmath1 of characteristic zero and having a finitely generated divisor class group @xmath2 its _ cox ring _",
    "@xmath3 a characteristic feature of the cox ring is its divisibility theory : it allows unique factorization in the multiplicative monoid of homogeneous elements  @xcite .",
    "projective varieties with finitely generated cox ring are called _ mori dream spaces _",
    "such a mori dream space is determined by its cox ring up to a finite choice of possible mori chambers , which in turn correspond to git quotients of the action of @xmath4 $ ] on the total coordinate space @xmath5 . in the surface case ,",
    "the cox ring @xmath6 even completely encodes  @xmath0 .",
    "once the cox ring of a variety @xmath0 is known in terms of generators and relations , this opens an approach to the explicit study of @xmath0 .",
    "for example , in  @xcite , manin s conjecture was proven for the @xmath7-singular surface using such a presentation for its cox ring .",
    "explicit cox ring computations are often based on a detailed knowledge of the geometry of the underlying variety ; the pioneer work in this direction concerns ( generalized ) smooth del pezzo surfaces and is due to batyrev / popov  @xcite and hassett / tschinkel  @xcite .",
    "the aim of the present paper is to provide computational methods for cox rings not depending on a detailed geometric understanding of the underlying varieties .",
    "we consider modifications @xmath8 of projective varieties , where one of the associated cox rings @xmath9 and @xmath10 is explicitly given in terms of generators and relations , for example , @xmath11 might be a projective space and @xmath8 a sequence of blow ups . whereas @xmath9 can be directly determined from @xmath10 ,",
    "see proposition  [ prop : coximage ] , the problem of computing @xmath10 from @xmath9 is in general delicate ; even finite generation can get lost .",
    "our approach uses the technique of toric ambient modifications developed in  @xcite and upgraded in section  [ sec : ambmod ] according to our computational needs .",
    "the idea is to realize @xmath8 via a modification of toric varieties @xmath12 , where @xmath13 is embedded in a compatible way , which means in particular that @xmath9 is the factor ring of the cox ring of @xmath14 by the @xmath15-homogeneous ideal describing @xmath11 .",
    "prospective homogeneous generators @xmath16 for @xmath10 correspond either to exceptional divisors or can be encoded as prime divisors on @xmath11 .",
    "the general basic algorithms  [ algo : stretchcemds ] and  [ algo : modifycemds ] check via the algebraic criteria  [ thm : ambientblow ] and  [ rem : k1primcrit ] if a given guess of @xmath16 indeed generates the cox ring @xmath10 and , in the affirmative case , compute the defining ideal of relations for @xmath10 .",
    "the main computational issues are a saturation process to compute the @xmath17-homogeneous ideal @xmath18 of the proper transform @xmath19 in the cox ring @xmath20 and @xmath17-primality tests of the @xmath21 to verify that @xmath22 is the cox ring @xmath10 of @xmath19 according to  [ thm : ambientblow ] and  [ rem : k1primcrit ] .    as a first application",
    ", we consider in section  [ section : picnr1 ] the gorenstein log del pezzo surfaces  @xmath0 of picard number one ; see  ( * ? ? ?",
    "* theorem  8.3 ) for a classification in terms of the singularity type .",
    "the toric ones correspond to the reflexive lattice triangles , see for example  @xcite , and their cox rings are directly obtained by  @xcite .",
    "the cox rings of the nontoric @xmath0 allowing still a @xmath23-action have been determined in  @xcite . in theorem",
    "[ thm : gorensteinlogpezzos ] , we provide the cox rings for the remaining cases ; that means for the @xmath0 admitting no nontrivial torus action .",
    "the approach is via a presentation @xmath24 , where @xmath25 is smooth . from  @xcite",
    "we infer enough information on the generators of the cox ring of @xmath25 for computing the cox ring of @xmath0 by means of our algorithms ; we note that an explicit computation of the cox ring of @xmath25 is not needed ( and in fact was not always feasible on our systems ) .",
    "the `` lattice ideal method '' presented in section  [ section : latticeideal ] produces systematically generators for the cox ring of the blow up @xmath19 of a given mori dream space @xmath11 at a subvariety @xmath26 contained in the smooth locus of @xmath11 .",
    "the theoretical basis for this is proposition  [ prop : reesalg ] where we describe the cox ring @xmath10 of @xmath19 as a saturated rees algebra defined by the @xmath15-homogeneous ideal of the center @xmath26 in the cox ring @xmath9 of @xmath11 . building on this , algorithm  [ algo : latticeideal ] verifies a given set of prospective generators for @xmath10 and , in the affirmative case computes the ideal of relations of @xmath10 ; a major computational advantage compared to the more generally applicable algorithm  [ algo : modifycemds ] is that the involved primality checks are now replaced with essentially less complex dimension computations .",
    "the @xmath27-grading of @xmath10 given by the rees algebra structure allows to produce systematically generators of @xmath10 by computing stepwise generators for the @xmath27-homogeneous components .",
    "this is implemented in algorithm  [ algo : latticeideal2 ] , which basically requires the cox ring @xmath9 of @xmath11 in terms of generators and relations and @xmath17-homogeneous generators of the ideal of the center of @xmath8 .",
    "it then terminates if and only if the blow up @xmath19 is a mori dream space and in this case , it provides the cox ring @xmath10 of @xmath19 .",
    "a sample computation is performed in example  [ ex : wpp345 ]    an application of the lattice ideal method is given in section  [ sec : smoothrat ] , where we investigate smooth rational surfaces @xmath0 of picard number @xmath28 .",
    "using our algorithms , we show in theorem  [ thm : pic6 ] that they are all mori dream surfaces and we provide the cox rings for those @xmath0 that do not admit a nontrivial torus action ; for the toric @xmath0 one obtains the cox ring directly by  @xcite and for the @xmath0 with a @xmath23-action , the methods of  @xcite apply .",
    "certain blow ups of the projective plane have also been considered earlier : general point configurations lead to the smooth del pezzo surfaces and almost general ones lead to so - called weak del pezzo surfaces , see  @xcite .",
    "wheras the remaining blow ups of the plane can be settled by our methods in a purely computational way , the blow ups of hirzebruch surfaces require besides the algorithmic also a theoretical treatment .    in section  [ section : lineargen ] , we consider blow ups of point configurations in the projective space .",
    "algorithm  [ algo : lineargen ] tests whether the cox ring is generated by proper transforms of hyperplanes and , if so , computes the cox ring . in example",
    "[ ex : almostfanoplane ] we treat the blow up of the projective plane at a symmetric configuration of seven points .",
    "then we leave the surface case and study blow ups of the projective space @xmath29 at configurations of six distinct points . recall that in the case of general position , castravet / tevelev  @xcite determined generators of the cox ring and sturmfels / xu  @xcite the relations , see also  @xcite .",
    "moreover , in  @xcite special configurations are considered and a certain subring of the cox ring is described , compare  @xcite .",
    "we obtain in theorem  [ thm : pp3 ] that the blow up of six points not contained in a hyperplane is always a mori dream space and we list the cox rings for the _ edge - special _ configurations , i.e.  four points are general and at least one of the six lies in two hyperplanes spanned by the others .    all our algorithms are stated explicitly and will be made available within a software package . in our computations",
    ", we made intensive use of the software systems macaulay2",
    "@xcite , magma  @xcite , maple  @xcite and singular  @xcite .",
    "we would like to thank the developers for providing such helpful tools .",
    "moreover , we are grateful to cinzia casagrande for her comments and discussions about section  [ section : lineargen ] . finally , we want to express our sincere thanks to the referees for many valuable hints and helpful suggestions for improving our manuscript .",
    "as indicated before , the ground field @xmath1 is algebraically closed and of characteristic zero throughout the article . in this section , we provide the necessary background on cox rings , mori dream spaces and their modifications .",
    "let us begin with recalling notation and basics from  @xcite . to any normal complete variety  @xmath0 with",
    "finitely generated divisor class group @xmath2 , one can associate a _",
    "cox sheaf _ and a _ cox ring _",
    "@xmath30 the cox ring @xmath6 is _ factorially @xmath2-graded _ in the sense that it is integral and every nonzero homogeneous nonunit is a product of @xmath2-primes . here",
    ", a nonzero homogeneous nonunit @xmath31 is called _ @xmath2-prime _ if for any two homogeneous @xmath32 we have that @xmath33 implies @xmath34 or @xmath35 .",
    "if the divisor class group @xmath2 is torsion free , then the cox ring @xmath6 is even a ufd in the usual sense .",
    "if @xmath36 is locally of finite type , e.g.  @xmath0 is @xmath37-factorial or @xmath0 is a _ mori dream space _ , i.e.  a normal projective variety with @xmath6 finitely generated  @xcite , then one has the relative spectrum @xmath38 .",
    "characteristic quasitorus _",
    "$ ] acts on @xmath40 and the canonical map @xmath41 is a good quotient for this action .",
    "we call @xmath41 a _ characteristic space _ over @xmath0",
    ". if @xmath0 is a mori dream space , then one has the _ total coordinate space _ @xmath42 and a canonical @xmath43-equivariant open embedding @xmath44 .",
    "note that the characteristic space @xmath41 coincides with the universal torsor introduced by colliot - thlne and sansuc  @xcite if and only if @xmath0 is locally factorial in the sense that for every closed point @xmath45 the local ring  @xmath46 is a ufd .    given a mori dream space @xmath0 and a system @xmath47 of pairwise non - associated @xmath2-prime generators of the cox ring @xmath6",
    ", we can construct an embedding into a toric variety .",
    "first , with @xmath48 , we have a closed embedding @xmath49 this embedding is @xmath50-equivariant , where the characteristic quasitorus @xmath50 acts diagonally on @xmath51 via the weights @xmath52 . for any ample class @xmath53 on @xmath0",
    ", we obtain a set of @xmath54-semistable points @xmath55_{nw } , \\ ,",
    "n > 0\\}.\\ ] ] the intersection @xmath56 is the set of @xmath54-semistable points for the action of @xmath50 on @xmath57 .",
    "altogether , this gives rise to a commutative diagram @xmath58|\\subseteq & { \\kk^r } \\\\",
    "{ \\rq{x } } \\ar@{}[r]|\\subseteq \\ar[d]_{p } \\ar[u ] & { \\rq{z } } \\ar[d]^{p } \\ar[u ] \\\\",
    "x \\ar@{}[r]|\\subseteq & z } \\ ] ] where @xmath59 is the toric characteristic space  @xcite and we have an induced embedding @xmath60 of quotients .",
    "then @xmath61 holds and @xmath0 inherits many geometric properties from @xmath62 , see  ( * ? ? ?",
    "iii.2.5 ) for details .",
    "we call @xmath60 in this situation a _ compatibly embedded mori dream space ( cemds)_.    [ rem : semistab ] consider a cemds @xmath60 .",
    "let @xmath63 denote the degree map of the cox ring @xmath64 $ ] of the ambient projective toric variety @xmath62 , sending the @xmath65-th canonical basis vector @xmath66 to the degree of the @xmath65-th variable  @xmath67 and let @xmath68 be the gale dual map , i.e.  @xmath69 is dual to the inclusion @xmath70 . if @xmath71 is an ample class of @xmath62 and hence for @xmath0 , then the fans @xmath72 of @xmath73 and @xmath74 of @xmath62 are given by @xmath75 where we write @xmath76 for the face relation of cones and regard @xmath77 and @xmath69 as maps of the corresponding rational vector spaces .",
    "if @xmath60 is a cemds , then the ample class @xmath78 is also an ample class for @xmath0 .",
    "note that a different choice of the ample class @xmath79 may lead to another cemds @xmath80 according to the fact that the mori chamber decomposition of @xmath62 refines the one of @xmath0 .",
    "we now consider modifications , that means proper birational morphisms @xmath81 of normal projective varieties .",
    "a first general statement describes the cox ring of @xmath82 in terms of the cox ring of  @xmath83 . by a morphism of graded algebras",
    "@xmath84 and @xmath85 we mean an algebra homomorphism @xmath86 together with an accompanying homomorphism @xmath87 of the grading groups such that @xmath88 holds for all @xmath89 .    [ prop : coximage ] let @xmath81 be a modification of normal projective varieties and let @xmath90 be the center of @xmath91",
    ". set @xmath92 and @xmath93 and identify @xmath94 with @xmath95 .",
    "then we have canonical surjective push forward maps @xmath96 \\mapsto [ \\pi_*d ] , \\qquad \\pi _ * \\colon r_2 \\to r_1 ,   \\   ( r_2)_{[d ] } \\ni f \\mapsto f_{\\vert u } \\in ( r_1)_{[\\t{\\pi}_*d]}.\\ ] ] now suppose that @xmath97 is finitely generated , let @xmath98 denote the exceptional prime divisors and @xmath99 the corresponding canonical sections",
    ". then we have a commutative diagram @xmath100^{\\pi _ { * } } \\ar@{->>}[dr]_{\\lambda } & & r_1 \\\\ & r_2 / \\bangle{f_i-1 ; \\ ; 1 \\le i \\le l } \\ar[ur]_{\\psi}^{\\cong } & } \\ ] ] of morphisms of graded algebras , where @xmath101 is the canonical projection with the projection @xmath102 as accompanying homomorphism and the induced morphism @xmath103 is an isomorphism .",
    "[ lem : k1grad ] let @xmath104 be a @xmath105-graded domain , @xmath106 with @xmath54 of infinite order in @xmath107 and consider the downgrading of @xmath104 given by @xmath108 .",
    "then @xmath109 is @xmath110-prime .",
    "let @xmath111 , where @xmath112 are @xmath110-homogeneous elements .",
    "since @xmath54 has infinite order , any @xmath110-homogeneous element @xmath113 can be uniquely written as a sum @xmath114 , where each @xmath115 is @xmath105-homogeneous , both @xmath116 and @xmath117 are non - zero and @xmath118 holds for each @xmath65 such that @xmath115 is non - zero . according to this observation we write",
    "@xmath119 we have @xmath120 since otherwise , by equating the @xmath105-homogeneous elements of the same degree we would obtain either @xmath121 or @xmath122 .",
    "similarly , we see @xmath123",
    ". thus @xmath124 by an induction argument , eliminating the @xmath125 gives @xmath126 since @xmath104 is integral , one of the two factors must be zero , say the first one .",
    "then @xmath109 divides @xmath127    let @xmath128 be smooth points with @xmath129 such that @xmath130 is not contained in any of the exceptional divisors . consider the divisorial sheaf @xmath131 on @xmath132 associated to the subgroup of divisors avoiding the point @xmath133 , see  ( * ? ? ?",
    "* constr .",
    "the open subset @xmath134 is mapped by @xmath91 isomorphically onto @xmath95 .",
    "this leads to canonical morphisms of graded algebras @xmath135 where the accompanying homomorphisms of the grading groups are the respective push forwards of weil divisors ; here we use that @xmath136 is of codimension at least two in  @xmath11 and thus any section of @xmath137 over @xmath95 extends uniquely to a section of @xmath137 over  @xmath11 .",
    "the homomorphisms are compatible with the relations of the cox sheaves @xmath138 , see again  ( * ? ? ?",
    "* constr .",
    "4.2.3 ) , and thus induce canonical morphisms of graded rings @xmath139 this establishes the surjection @xmath140 with the canonical push forward @xmath141 of divisor class groups as accompanying homomorphism .",
    "clearly , the canonical sections @xmath142 of the exceptional divisors are sent to @xmath143 .",
    "we show that the induced map @xmath103 is an isomorphism .",
    "as we may proceed by induction on @xmath144 , it suffices to treat the case @xmath145 .",
    "lemma  [ lem : k1grad ] tells us that @xmath146 is @xmath110-prime . from",
    "3.2 ) we infer that @xmath147 is a radical ideal in @xmath10 . since @xmath148 is a closed embedding of varieties of the same dimension and equivariant with respect to the action of the quasitorus @xmath149 $ ] , the assertion follows .",
    "we are grateful to the referee suggesting to us the following example as a geometric illustration .",
    "[ ex : referee ] let @xmath19 be the blow - up of @xmath150 at the three toric fixed points and @xmath151 $ ] and let @xmath152 be the contraction of the exceptional curve @xmath153 over  @xmath154 .",
    "the cox ring @xmath10 of @xmath19 is the coordinate ring of the affine cone @xmath155 over @xmath156 , that means that @xmath10 is @xmath157 $ ] modulo the ideal @xmath18 generated by the plcker relations @xmath158 @xmath159 the @xmath17-grading is the finest one leaving variables and relations homogeneous .",
    "we assume @xmath153 to be @xmath160 in cox coordinates . according to proposition  [ prop : coximage ]",
    ", we have an epimorphism @xmath161 onto the cox ring @xmath9 of @xmath11 .",
    "this defines a closed embedding of @xmath162 as @xmath163 into @xmath164 ; this embedding is explicitly given by @xmath165 observe that @xmath166 is the subset of the affine cone over @xmath156 corresponding to a schubert cell consisting of all lines of @xmath167 not meeting a certain plane in @xmath167 .    as an immediate consequence of proposition  [ prop : coximage ]",
    ", we obtain that @xmath11 is a mori dream space provided @xmath19 is one ; recall that in  @xcite it is more generally proven that for any dominant morphism @xmath168 of @xmath37-factorial projective varieties , @xmath19 is a mori dream space if @xmath11 is .",
    "the converse question is in general delicate .",
    "for a classical counterexample , consider points @xmath169 that lie on precisely one smooth cubic @xmath170 and admit a line @xmath171 such that @xmath172 is not a torsion element of @xmath173 .",
    "then the blow up @xmath11 of @xmath174 at @xmath175 is a mori dream surface and the blow up @xmath19 of @xmath82 at @xmath176 is not , see for example  ( * ? ? ?",
    "4.3.4.5 ) .",
    "we now upgrade the technique of toric ambient modifications developed in  @xcite according to our computational purposes . in the following setting , @xmath177 is not necessarily a characteristic space and @xmath178 not necessarily a total coordinate space .",
    "[ set : ambmod ] let @xmath179 be a toric modification , i.e.  @xmath14 , @xmath180 are complete toric varieties and @xmath91 is a proper birational toric morphism",
    ". moreover , let @xmath181 be closed subvarieties , both intersecting the big @xmath182-torus @xmath183 , such that @xmath184 holds .",
    "then we have a commutative diagram @xmath185|= & { \\b{z}_2 } \\ar@{}[r]|\\supseteq & { \\b{x}_2 } & { \\b{x}_1 } \\ar@{}[r]|\\subseteq & { \\b{z}_1 } \\ar@{}[r]|= & { \\kk^{r_1 } } \\\\ & { \\rq{z}_2 } \\ar@{}[r]|\\supseteq \\ar@{}[u]|{\\rotatebox[origin = c]{90}{$\\scriptstyle \\subseteq$ } } \\ar[d]_{p_2 } & { \\rq{x}_2 } \\ar@{}[u]|{\\rotatebox[origin = c]{90}{$\\scriptstyle \\subseteq$ } } \\ar[d]_{p_2 } & { \\rq{x}_1 } \\ar@{}[u]|{\\rotatebox[origin = c]{90}{$\\scriptstyle \\subseteq$ } } \\ar[d]^{p_1 } \\ar@{}[r]|\\subseteq & { \\rq{z}_1 } \\ar@{}[u]|{\\rotatebox[origin = c]{90}{$\\scriptstyle \\subseteq$ } } \\ar[d]^{p_1 } & \\\\ & z_2 \\ar@{}[r]|\\supseteq \\ar@/_2pc/[rrr]_{\\pi } & x_2 \\ar[r ] & x_1 \\ar@{}[r]|\\subseteq & z_1 & \\\\ & & & & & } \\ ] ] where the downwards maps @xmath186 are toric characteristic spaces and @xmath187 are the closures of the inverse image @xmath188 .",
    "let @xmath189 $ ] be the vanishing ideal of the closure @xmath190 of @xmath187 and set @xmath191 / i_i$ ] .",
    "note that @xmath192 is graded by @xmath193 .",
    "[ thm : ambientblow ] consider the setting  [ set : ambmod ] .    1 .",
    "if @xmath13 is a cemds , the ring @xmath10 is normal and @xmath194 define pairwise non - associated @xmath105-primes in  @xmath10 , then @xmath195 is a cemds . in particular",
    ", @xmath105 is the divisor class group of @xmath19 and @xmath10 is the cox ring of  @xmath19 .",
    "if @xmath195 is a cemds , then @xmath13 is a cemds . in particular , @xmath110 is the divisor class group of @xmath11 and @xmath9 is the cox ring of  @xmath11 .",
    "first consider the lattice homomorphisms @xmath196 associated to the toric morphisms @xmath197 . viewing the @xmath198 as matrices , we may assume that @xmath199 $ ] with a matrix @xmath200 of size @xmath201 .",
    "we have a commutative diagram of lattice homomorphisms and the corresponding diagram of homomorphisms of tori : @xmath202_{\\genfrac{}{}{0pt}{}{e_i \\mapsto e_i}{e_j \\mapsto m_je_j } } \\ar[dr]^{[e_{r_1},a ] } & \\\\ { \\zz^{r_2 } } \\ar[d]_{p_2 = [ p_1,b ] } & & { \\zz^{r_1 } } \\ar[d]^{p_1 } \\\\ { \\zz^{n } } \\ar[rr]_{e_n } & & { \\zz^{n } } } \\qquad\\qquad\\qquad \\xymatrix { & { \\tt^{r_2 } } \\ar[dl]_{\\mu } \\ar[dr]^{\\alpha } & \\\\ { \\tt^{r_2 } } \\ar[d]_{p_2 } & & { \\tt^{r_1 } } \\ar[d]^{p_1 } \\\\ { \\tt^{n } } \\ar[rr]_{\\id } & & { \\tt^{n } } } \\end{aligned}\\ ] ] where in the left diagram , the @xmath203 are the first @xmath204 , the @xmath205 the last @xmath206 canonical basis vectors of @xmath207 , the @xmath208 are positive integers and @xmath209 denote the unit matrices of size @xmath210 respectively and @xmath211 is an integral @xmath212 matrix .    we prove  ( i ) .",
    "we first show that @xmath213 is integral . by construction , it suffices to show that @xmath214 is irreducible . by assumption",
    ", @xmath215 is irreducible .",
    "since @xmath216 has connected kernel , also @xmath217 is irreducible .",
    "we conclude that @xmath218 is irreducible .",
    "moreover , since @xmath83 is complete and the @xmath107-grading of @xmath213 has a pointed weight cone , we obtain that @xmath213 has only constant units .",
    "thus , ( * ? ? ?",
    "3.2 ) yields that @xmath213 is factorially @xmath107-graded .",
    "since the @xmath219 are pairwise non - associated @xmath107-primes and @xmath10 is normal , we conclude that @xmath10 is the cox ring of @xmath19 and @xmath220 is a cemds .",
    "we turn to  ( ii ) .",
    "observe that for every @xmath221 , the laurent polynomials @xmath222 and @xmath223 differ by a monomial factor .",
    "we conclude @xmath224 \\cdot i_{2 } \\",
    "\\bangle{\\alpha^*(f(t_{1},\\ldots , t_{r_{1}},1,\\ldots,1 ) ) ; f \\in i_{2 } } \\ \\subseteq",
    "\\ \\kk[t_{1}^{\\pm 1 } , \\ldots , t_{r_{2}}^{\\pm 1}].\\ ] ] now proposition  [ prop : coximage ] tells us that @xmath225 is the cox ring of @xmath82 . since @xmath226 define pairwise different prime divisors in @xmath82 , we conclude that @xmath227 is a cemds .",
    "the verification of normality as well as the primality tests needed for theorem  [ thm : ambientblow ]  ( ii ) are computationally involved .",
    "the following observation considerably reduces the effort in many cases .",
    "[ rem : k1primcrit ] see  ( * ? ? ?",
    "consider the setting  [ set : ambmod ] and assume that the canonical map @xmath228 admits a section ( e.g. @xmath110 is free ) .    1 .",
    "if @xmath9 is normal and @xmath229 define primes in @xmath10 ( e.g. they are @xmath105-prime and @xmath105 is free ) , then @xmath10 is normal .",
    "2 .   let @xmath230 define @xmath110-primes in @xmath9 and @xmath229 define @xmath105-primes in @xmath10 .",
    "if no @xmath231 with @xmath232 divides a @xmath67 with @xmath233 in @xmath10 , then also @xmath230 define @xmath105-primes in @xmath10 .    as a consequence of theorem  [ thm : ambientblow",
    "] , we obtain that the modifications preserving finite generation are exactly those arising from toric modifications as discussed .",
    "more precisely , let @xmath234 be a toric modification mapping @xmath220 onto @xmath227 .",
    "we call @xmath234 a _ good _ toric ambient modification if it is as in theorem  [ thm : ambientblow ]  ( i ) .",
    "let @xmath235 be a birational morphism of normal projective varieties such that the cox ring @xmath236 is finitely generated .",
    "then the following statements are equivalent .    1 .",
    "the cox ring @xmath237 is finitely generated .",
    "2 .   the morphism @xmath235 arises from a good toric ambient modification .",
    "the implication `` ( ii)@xmath238(i ) '' is theorem  [ thm : ambientblow ] . for the reverse direction , set @xmath239 and @xmath240 .",
    "let @xmath241 be pairwise nonassociated @xmath105-prime generators for @xmath10 . according to proposition  [ prop : coximage ] , we may assume , after suitably numbering , that @xmath242 define generators of @xmath9 , where @xmath243 .",
    "now take an ample class @xmath244 .",
    "then the pullback @xmath245 of @xmath246 under @xmath8 is semiample on @xmath19 .",
    "choose @xmath247 such that @xmath248 is ample on @xmath19 and the toric ambient variety @xmath180 of @xmath19 defined by @xmath248 has an ample cone containing @xmath249 in its closure .",
    "then , with the sets of semistable points @xmath250 defined by @xmath248 , @xmath249 respectively and @xmath251 the one defined by @xmath246 . then we obtain morphisms @xmath252 where @xmath253 $ ] denotes the characteristic quasitorus of @xmath254 ; observe that @xmath255 is in general not a toric characteristic space .",
    "thus , we arrive at setting  [ set : ambmod ] and @xmath12 is the desired good toric ambient modification inducing the morphism @xmath8 .    for a flexible use of theorem  [ thm : ambientblow ] we will have to adjust given embeddings of a mori dream space , e.g.  bring general points of a cemds into a more special position , or remove linear relations from a redundant presentation of the cox ring .",
    "the formal framework is the following .",
    "[ set : stretchcompress ] let @xmath14 be a projective toric variety with toric total coordinate space @xmath256 , toric characteristic space @xmath257 and ample class @xmath258 . consider @xmath110-homogeneous polynomials @xmath259 $ ] and , with @xmath260 , the ( in general non - toric ) embedding @xmath261",
    "note that @xmath262 $ ] is graded by @xmath263 via attaching to @xmath230 their former @xmath110-degrees and to @xmath264 the degree of @xmath265 .",
    "the class @xmath266 defines a toric variety @xmath267 with toric total coordinate space @xmath268 toric characteristic space @xmath269 .",
    "any closed subvariety @xmath13 and its image @xmath270 lead to a commutative diagram @xmath271|= & { \\b{z}_1 } \\ar@/^2pc/[rrrrr]^{\\b{\\imath } } \\ar@{}[r]|\\supseteq & { \\rq{z}_1 } \\ar@{}[r]|\\supseteq \\ar[d]_{p_1 } & { \\rq{x}_1 } \\ar[d]_{p_1 } & { \\rq{x}_1 ' } \\ar[d]^{p_1 ' } \\ar@{}[r]|\\subseteq & { \\rq{z}_1 ' } \\ar@{}[r]|\\subseteq \\ar[d]^{p_1 ' } & { \\b{z}'_1 } \\ar@{}[r]|= & { \\kk^{r_1 ' } } \\\\ & & z_1 \\ar@{}[r]|\\supseteq \\ar@/_2pc/[rrr]_{\\imath } & x_1 \\ar[r ] & x_1 ' \\ar@{}[r]|\\subseteq & z_1 ' & & \\\\ & & & & & & & } \\ ] ] where @xmath272 and @xmath273 are the closures of the inverse image @xmath274 and @xmath275 .",
    "denote by @xmath276 and @xmath277 the respective vanishing ideals of the closures @xmath278 of @xmath272 and @xmath279 of @xmath273 . set @xmath280",
    "/ i_1 $ ] and @xmath281 / i_1'$ ] .",
    "[ prop : stretchcompress ] consider the setting  [ set : stretchcompress ] .    1 .",
    "if @xmath13 is a cemds and @xmath282 define pairwise non - associated @xmath110-primes in  @xmath9 then @xmath283 is a cemds .",
    "if @xmath284 is normal the localization @xmath285 is factorially @xmath286-graded and @xmath287 define pairwise non - associated @xmath110-primes in @xmath9 such that @xmath110 is generated by any @xmath288 of their degrees , then @xmath13 is a cemds .",
    "3 .   if @xmath283 is a cemds , then @xmath13 is a cemds .",
    "first , observe that the ideal @xmath277 equals @xmath289 .",
    "consequently , we have a canonical graded isomorphism @xmath290 sending @xmath264 to @xmath265 .",
    "assertion  ( i ) follows directly .",
    "we prove  ( ii ) .",
    "since @xmath285 is factorially @xmath286-graded , we obtain that @xmath291 is factorially @xmath110-graded .",
    "since @xmath287 define @xmath110-primes in @xmath9 , we can apply  ( * ? ? ?",
    "1.2 ) to see that @xmath9 is factorially @xmath110-graded .",
    "since @xmath287 are pairwise non - associated we conclude that @xmath13 is a cemds .",
    "we turn to  ( iii ) . according to  (",
    "ii ) , we only have to show that any @xmath288 of the degrees of @xmath287 generate @xmath110 . for this",
    ", it suffices to show that each @xmath292 for @xmath293 is a linear combination of any @xmath288 of the first @xmath204 degrees .",
    "since @xmath287 generate @xmath9 and @xmath231 is not a mutiple of any @xmath67 , we see that for any @xmath294 , there is a monomial in @xmath295 not depending on @xmath67 .",
    "the assertion follows .",
    "here we provide the general algorithmic framework . in order to encode a compatibly embedded mori dream space @xmath181 and its cox ring @xmath192 , we use the triple @xmath296 , where @xmath297 and @xmath298 are as in remark  [ rem : semistab ] and @xmath299 is a system of generators of the defining ideal @xmath300 of the cox ring @xmath192 .",
    "we call such a triple @xmath296 as well a cemds .    given a cemds @xmath296 ,",
    "the total coordinate space @xmath178 is the common zero set of the functions in @xmath301 and the degree map @xmath302 and @xmath297 are gale dual to each other in the sense that @xmath303 is surjective and @xmath297 is the dual of the inclusion @xmath304 . moreover , @xmath305 is the restriction of the toric morphism defined by  @xmath297 . the following two algorithms implement proposition  [ prop : stretchcompress ] .",
    "[ algo : stretchcemds ] _ input : _ a cemds @xmath306 , a list @xmath307 of polynomials @xmath308 $ ] defining pairwise non - associated @xmath110-primes in  @xmath9 .    *",
    "compute the gale dual @xmath309 of @xmath310 .",
    "* let @xmath311 be the extension of @xmath312 by the degrees of @xmath313 .",
    "* compute the gale dual @xmath314 of @xmath315 and the fan @xmath316 in @xmath317 defined by @xmath318 and the ample class @xmath319 of @xmath14 . *",
    "set @xmath320 , where @xmath321 .",
    "_ output : _ the cemds @xmath322 .",
    "the input of the second algorithm is more generally an _ embedded space _ @xmath13 that means just a closed normal subvariety intersecting the big torus . in particular",
    ", we do not care for the moment if @xmath9 is the cox ring of @xmath11 .",
    "we encode @xmath13 as well by a triple @xmath306 and name it for short an es . for notational reasons we write @xmath322 for the input .",
    "[ algo : compresscemds ] _ input : _ an es @xmath322 such that @xmath284 is normal , the localization @xmath285 is factorially @xmath286-graded and the last @xmath144 relations in @xmath323 are fake , i.e.  of the form @xmath324 with @xmath265 not depending on @xmath67 . _",
    "option : _ ` verify ` .",
    "* successively substitute @xmath325 in @xmath323 .",
    "set @xmath326 , where @xmath327 and @xmath328 .",
    "* set @xmath329 and let @xmath309 be the map sending @xmath203 to @xmath330 for @xmath331 . *",
    "compute a gale dual @xmath332 of @xmath312 and the fan @xmath333 in @xmath334 defined by @xmath310 and the ample class @xmath335 of @xmath267 . *",
    "if ` verify ` was asked then * * check if any @xmath288 of the degrees of @xmath336 generate @xmath110 , * * check if @xmath337 for all @xmath338 , * * check if @xmath336 define @xmath110-primes in @xmath9 .    _",
    "output : _ the es @xmath306 .",
    "if @xmath322 is a cemds or all verifications were positive , then @xmath306 is a cemds .",
    "in particular , then @xmath9 is the cox ring of the corresponding subvariety @xmath13 .",
    "we turn to the algorithmic version of theorem  [ thm : ambientblow ]",
    ". we will work with the _ saturation _ of an ideal @xmath339 $ ] with respect to an ideal @xmath340 $ ] ; recall that this is the ideal @xmath341 ; \\ ;   g\\,\\bb^k \\subseteq \\aa\\text { for some } k \\in \\zz_{\\ge 0}\\ } \\ \\subseteq \\",
    "\\kk[t_1,\\ldots , t_r].\\ ] ] in case of a principal ideal @xmath342 , we write @xmath343 instead of @xmath344 .",
    "we say that an ideal @xmath339 $ ] is @xmath345-_saturated _ if @xmath346 holds",
    ". we will only consider saturations with respect to @xmath347 $ ] ; we refer to  ( * ? ? ? * chap .",
    "12 ) for the computational aspect .",
    "let us recall the basic properties , see also  @xcite .",
    "[ lem : satprops ] consider @xmath348 $ ] with @xmath349 and @xmath350 . for",
    "@xmath351 $ ] , one has mutually inverse bijections @xmath352 \\end{array } \\right\\ } &   \\",
    "\\longleftrightarrow \\ & \\left\\ { \\begin{array}{c } \\text{$f$-saturated ideals in}\\   \\kk[t , u ] \\end{array } \\right\\ } \\\\",
    "\\aa & \\mapsto & \\aa\\ , \\cap\\ , \\kk[t , u ]",
    "\\\\ \\bangle{\\bb}_{\\kk[t , u^{\\pm 1 } ] } &   \\mapsfrom & \\bb.\\end{aligned}\\ ] ] under these maps , the prime ideals of @xmath353 $ ] correspond to the @xmath345-saturated prime ideals of @xmath354 $ ] .",
    "for transferring polynomials from @xmath355 $ ] to @xmath356 $ ] and vice versa , we use the following operations , compare also  @xcite . consider a homomorphism @xmath357 of tori and its kernel @xmath358 .    * by a _",
    "@xmath359-pull back _ of @xmath360 $ ] we mean a polynomial @xmath361 $ ] with coprime monomials",
    "such that @xmath362 and @xmath363 are associated in @xmath364 $ ] .",
    "@xmath359-push forward _ of an @xmath43-homogeneous @xmath365 $ ] we mean a polynomial @xmath366 $ ] with coprime monomials such that @xmath367 and @xmath368 are associated in @xmath364 $ ] .    note that @xmath359-pull backs and @xmath359-push forwards always exist and are unique up to constants .",
    "the @xmath359-pull back @xmath363 of a laurent polynomial is its usual pull back @xmath369 scaled with a suitable monomial . to compute the @xmath359-push forward ,",
    "factorize the describing @xmath370 matrix of @xmath91 as @xmath371 , where @xmath372 are invertible and @xmath373 is in smith normal form . then push forward with respect to the homomorphisms corresponding to the factors .",
    "[ lem : pushpullprops ] consider a monomial dominant morphism @xmath374 .",
    "write @xmath375 and @xmath376 .    1 .   if @xmath377 $ ] is a prime ideal , then @xmath378 $ ] is a prime ideal .",
    "2 .   if @xmath379 $ ] is a radical ideal , then @xmath380 $ ] is a radical ideal .",
    "the first statement follows from @xmath381 . to prove  ( ii ) ,",
    "let @xmath382 .",
    "since @xmath383 is invariant under @xmath384 , we may assume that @xmath345 is @xmath43-homogeneous , i.e.  @xmath385 holds with some character @xmath386 .",
    "choose @xmath387 with @xmath388 .",
    "then @xmath389 is @xmath43-invariant and thus belongs to @xmath390 .",
    "hilbert s nullstellensatz and the assumption give @xmath391 .",
    "we conclude @xmath392 .",
    "we are ready for the algorithm treating the contraction problem .",
    "we enter a _ weak cemds _ @xmath393 in the sense that @xmath394 provides generators for the extension of @xmath18 to @xmath395 $ ] and a toric contraction @xmath12 , encoded by @xmath396 .",
    "[ contractcemds ] [ algo : contractcemds ] _ input : _ a weak cemds @xmath393 and a pair @xmath396 , where @xmath397 $ ] and @xmath333 is a coarsening of @xmath398 removing the rays through the columns of @xmath200 .    *",
    "set @xmath399 $ ] , where @xmath400 . *",
    "compute a system of generators @xmath323 for @xmath401 . *",
    "set @xmath402 and reorder the variables such that the last @xmath144 relations of @xmath323 are as in algorithm  [ algo : compresscemds ] .",
    "* apply algorithm  [ algo : compresscemds ] to @xmath322 and write @xmath306 for the output .    _",
    "output : _ @xmath306 .",
    "this is a cemds .",
    "in particular , @xmath9 is the cox ring of the image @xmath13 of @xmath195 under @xmath12 .",
    "first we claim that in @xmath403 $ ] , the ideal generated by @xmath404 coincides with the ideal generated by @xmath405 . to see this , consider @xmath406 and let @xmath407 be the variables on @xmath408 .",
    "then the claim follows from @xmath409 for @xmath410 and @xmath411    as a consequence of the claim , we may apply lemma  [ lem : pushpullprops ] and obtain that @xmath323 defines a radical ideal in @xmath412 $ ] .",
    "moreover , from theorem  [ thm : ambientblow ] we infer that @xmath413 , defined as in setting  [ set : ambmod ] , is irreducible .",
    "since @xmath323 has @xmath414 as its zero set , it defines a prime ideal in @xmath412 $ ] .",
    "lemma  [ lem : satprops ] then shows that @xmath415 $ ] is a prime ideal .",
    "using theorem  [ thm : ambientblow ] again , we see that @xmath322 as defined in the third step of the algorithm is a cemds",
    ". thus , we may enter algorithm  [ algo : compresscemds ] and end up with a cemds .",
    "we turn to the modification problem . given a mori dream space @xmath11 with cox ring @xmath9 and a modification @xmath8 , we want to know if @xmath19 is a mori dream space , and if so , we ask for the cox ring @xmath10 of @xmath19 .",
    "our algorithm verifies a guess of prospective generators for @xmath10 and , if successful , computes the relations . in practice",
    ", the generators are added via algorithm  [ algo : stretchcemds ] .",
    "[ algo : modifycemds ] _ input : _ a weak cemds @xmath306 , a pair @xmath416 with a matrix @xmath397 $ ] and a fan @xmath398 having the columns of @xmath417 as its primitive generators and refining @xmath333 . _",
    "options : _ ` verify ` .    *",
    "compute @xmath418 , where @xmath419 and @xmath321 . *",
    "compute a system of generators @xmath394 of @xmath420 . *",
    "if ` verify ` was asked then * * compute a gale dual @xmath421 of @xmath417 , * * check if @xmath422 for all @xmath423 , * * check if @xmath424 define @xmath105-primes in @xmath10 . *",
    "* check if @xmath10 is normal , e.g.  using remark  [ rem : k1primcrit ] .",
    "_ output : _",
    "@xmath393 , if the ` verify`-checks were all positive , this is a cemds . in particular , then @xmath10 is the cox ring of the strict transform @xmath195 of @xmath13 with respect to @xmath12 .",
    "we write shortly @xmath348 $ ] with the tuples @xmath349 and @xmath350 of variables .",
    "lemma  [ lem : pushpullprops ] ensures that @xmath394 generates a radical ideal in @xmath425 $ ] . to see that the zero set @xmath426 is irreducible , consider the situation of equation   in the proof of theorem  [ thm : ambientblow ]",
    "there , in the right hand side diagram , we may lift the homomorphisms of tori to @xmath427_{\\mu } \\ar[dr]^{\\alpha } & \\\\ { \\kk^{r_1}\\times\\tt^{r_2-r_1 } } \\ar[d]_{p_2 } & & { \\kk^{r_1 } } \\ar[d]^{p_1 } \\\\ { \\tt^{n } } \\ar[rr]_{\\id } & & { \\tt^{n } } } \\end{aligned}\\ ] ] observe that we have an isomorphism @xmath428 given by @xmath429 since @xmath430 is irreducible , so is @xmath431 .",
    "hence , the image @xmath432 is irreducible as well .",
    "moreover , lemma  [ lem : satprops ] implies that @xmath394 generates a prime ideal in @xmath354 $ ] .",
    "if the ` verify`-checks were all positive , then theorem  [ thm : ambientblow ] tells us that @xmath393 is a cemds .",
    "compare remark  [ rem : k1primcrit ] .",
    "if the canonical map @xmath433 admits a section , e.g.  if @xmath434 is free , then it suffices to check the variables @xmath435 for @xmath107-primeness in @xmath213 in the verification step of algorithm  [ algo : modifycemds ] .",
    "let @xmath436 $ ] be graded by a finitely generated abelian group @xmath437 and @xmath438 a @xmath437-homogeneous ideal . by  (",
    "3.2 ) , @xmath439 being @xmath437-prime in @xmath440 is equivalent to the divisor of @xmath439 in @xmath441 being @xmath442$]-prime . in computational terms , this means computing the prime components of @xmath443 and testing whether @xmath43 permutes them transitively . see  @xcite for the computational background .",
    "there are also recent methods from numerical algebraic geometry  @xcite .",
    "as an application of algorithm  [ algo : contractcemds ] , we compute cox rings of gorenstein log terminal del pezzo surfaces @xmath0 of picard number one . here , `` del pezzo '' means that @xmath0 is a normal projective surface with ample anticanonical divisor @xmath444 and the conditions `` gorenstein '' and `` log terminal '' together are equivalent to saying that @xmath0 has at most canonical singularities which in turn are precisely the rational double points ( also called ade or du val singularities ) , see for example  ( * ? ? ?",
    "* thm .  4 - 6 - 7 ) .",
    "a classification of gorenstein log terminal del pezzo surfaces @xmath0 of picard number one according to the singularity type , i.e.  the configuration @xmath445 of singularities , has been given in  ( * ? ? ?",
    "* theorem  8.3 ) .",
    "besides @xmath174 , there are four toric surfaces , namely the singularity types @xmath446 , @xmath447 , @xmath448 and @xmath449 .",
    "moreover , there are thirteen ( deformation types of ) @xmath23-surfaces ; they represent the singularity types @xmath450 , @xmath451 , @xmath7 , @xmath452 , @xmath453 , @xmath454 , @xmath455 , @xmath456 , @xmath457 , @xmath458 , @xmath459 , @xmath460 and their cox rings have been determined in  ( * ? ? ?",
    "* theorem  5.6 ) .",
    "we now compute the cox rings of the remaining ones using algorithm  [ algo : stretchcemds ] and the knowledge of generators of their resolutions  @xcite ; note that the relations for cox rings of the resolutions are still unknown in some of the cases . in the sequel ,",
    "we will write a cox ring as a quotient @xmath440 and specify generators for the ideal @xmath438 . the @xmath2-grading is encoded by a _ degree matrix _ , i.e.  a matrix with @xmath461 as columns .",
    "[ thm : gorensteinlogpezzos ] the following table lists the cox rings of the gorenstein log terminal del pezzo surfaces @xmath0 of picard number one that do not allow a non - trivial @xmath23-action .    p.7cmp4.8cml @xmath445 & cox ring @xmath6 & @xmath2 and degree matrix +   + @xmath462 & @xmath463/i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle -t_{2}t_{5}+t_{3}t_{4}+t_{6}^{2},\\ -t_{2}t_{4}+t_{3}^{2}+t_{5}t_{6 } , \\\\ \\scriptstyle t_{1}t_{6}-t_{3}t_{5}+t_{4}^{2 } , \\",
    "t_{1}t_{3}-t_{4}t_{6}+t_{5}^{2 } ,   \\\\",
    "\\scriptstyle t_{1}t_{2}-t_{3}t_{6}+t_{4}t_{5 } \\end{array } $ ] & @xmath464 \\mbox{\\tiny$ \\left [ \\begin{array}{rrrrrr } 1 & 1 & 1 & 1 & 1 & 1 \\\\ \\bar 2 & \\bar 2 & \\bar 3 & \\bar 4 & \\bar 0 & \\bar 1   \\end{array } \\right ] $ } \\end{array } $ ] +   +   + @xmath465 & @xmath466/i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle t_{1}^{2}-t_{4}^2t_{2}t_{3}+t_{4}^{4}+t_{3}^{4 } \\end{array } $ ] & @xmath467 \\mbox{\\tiny$ \\left [ \\begin{array}{rrrr } 2 & 1 & 1 & 1 \\\\ \\bar 1 & \\bar 1 & \\bar 1 & \\bar 0   \\end{array } \\right ] $ } \\end{array } $ ] +   +   + @xmath468 & @xmath469 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle t_{1}t_{3}-t_{4}^{2}-t_{5}^{2 } , \\",
    "t_{1}t_{2}-t_{3}^{2}+t_{4}t_{5 } \\end{array } $ ] & @xmath470 \\mbox{\\tiny$ \\left [ \\begin{array}{rrrrr } 1 & 1 & 1 & 1 & 1\\\\ \\bar 2 & \\bar 2 & \\bar 0 & \\bar 3 & \\bar 1\\\\ \\end{array } \\right ] $ } \\end{array } $ ] +   +   + @xmath471 & @xmath469 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle   t_{5}t_{2}-t_{5}^{2}+t_{3}^{2}+t_{4}^{2},\\   -t_{2}^{2}+t_{5}t_{2}+t_{1}^{2}-t_{4}^{2 } \\end{array } $ ] & @xmath472 \\mbox{\\tiny $       \\left [      \\begin{array}{rrrrr }      1 & 1 & 1 & 1 & 1 \\\\      \\bar 1 & \\bar 0 & \\bar 0 & \\bar 1 & \\bar 0 \\\\",
    "\\bar 0 & \\bar 1 & \\bar 0 & \\bar 1 & \\bar 1      \\end{array }      \\right ] $ } \\end{array } $ ] +   +   + @xmath473 & @xmath466 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle -t_{1}t_{4}^{2}+t_{2}^{3}+t_{2}t_{3}t_{4}+t_{3}^{3 } \\end{array } $ ] & @xmath474 \\mbox{\\tiny $ \\left [   \\begin{array}{rrrrrr }   1 & 1 & 1 & 1\\\\ \\bar 1 & \\bar 2 & \\bar 0 & \\bar 1 \\end{array }   \\right ] $ } \\end{array } $ ] +   +   + @xmath475 & @xmath466 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle -t_{1}t_{3}^{3}-t_{2}^{2}+t_{2}t_{3}t_{4}+t_{4}^{4 } \\end{array } $ ] & @xmath476 \\mbox{\\tiny$ \\left [   \\begin{array}{rrrrrr } 1 & 2 & 1 & 1\\\\ \\bar 1 & \\bar 1 & \\bar 1 & \\bar 0 \\end{array }   \\right ] $ } \\end{array } $ ] +   +   + @xmath459 & @xmath466 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle    t_{1}^{3}+t_{1}^{2}t_{4}^{2}+t_{2}^{2}-t_{3}t_{4}^{5 } \\end{array } $ ] & @xmath477 \\mbox{\\tiny$ \\left [   \\begin{array}{rrrrrr } 2 & 3 & 1 & 1 \\end{array }   \\right ] $ } \\end{array } $ ] +   +   + @xmath478 & @xmath466 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle t_{1}^{2}-t_{4}t_{2}t_{3}+t_{4}^{4}+t_{3}^{4 } \\end{array } $ ] & @xmath476 \\mbox{\\tiny$ \\left [   \\begin{array}{rrrr } 2 & 2 & 1 & 1\\\\ \\bar 1 & \\bar 1 & \\bar 1 & \\bar 0 \\end{array }   \\right ] $ } \\end{array } $ ] +   +   + @xmath479 & @xmath466 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle -t_{1}t_{2}t_{3}+t_{2}^{3}+t_{3}^{3}+t_{4}^{3 } \\end{array } $ ] & @xmath480 \\mbox{\\tiny$       \\left [      \\begin{array}{rrrr }      1 & 1 & 1 & 1 \\\\      \\bar 1 & \\bar 2 & \\bar 0 & \\bar 1      \\end{array }      \\right ] $ } \\end{array } $ ] +   +   + @xmath481 & @xmath469 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle -t_{2}t_{3}+t_{4}^{2}-t_{5}^{2},\\   t_{1}^{2}-t_{3}^{2}+t_{4}t_{5 } \\end{array } $ ] & @xmath482 \\mbox{\\tiny$       \\left [      \\begin{array}{rrrrr }      1 & 1 & 1 & 1 & 1\\\\      \\bar 2 & \\bar 2 & \\bar 0 & \\bar 3 & \\bar 1      \\end{array }      \\right ] $ } \\end{array } $ ] +   +   + @xmath483 & @xmath484/i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle t_{5}^2+t_{6}^2-t_{7}t_{1 } , \\",
    "t_{4}t_{5}+t_{6}t_{1}-t_{2}t_{6}-t_{7}^2 , \\\\",
    "\\scriptstyle -t_{3}t_{6}-t_{5}t_{7}+t_{1}t_{4},\\ t_{3}^2-t_{6}t_{1}+t_{7}^2 , \\\\ \\scriptstyle t_{1}t_{5}-t_{2}t_{5}-t_{4}t_{6}+t_{7}t_{3 } , \\ \\\\",
    "\\scriptstyle t_{3}t_{4}-t_{6}^2+t_{7}t_{1}-t_{2}t_{7 } , \\\\[1ex ] \\text{the class group and degree matrix are}\\\\[1ex ] \\zz\\oplus \\zz/6\\zz \\end{array } $ ] & @xmath485 \\mbox{\\tiny$ \\left [ \\begin{array}{rrrrrrr } 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\ \\bar 2 & \\bar 2 & \\bar 3 & \\bar 5 & \\bar 1 & \\bar 4 & \\bar 0   \\end{array } \\right ] $ } \\end{array } $ ] +   +   + @xmath486 & @xmath487/i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle -\\frac{1}{2}t_{4}^{2}+t_{5}^{2}+\\frac{1}{2}t_{7}t_{9 } , \\\\",
    "\\scriptstyle      -\\frac{1}{2}t_{3}t_{8}-\\frac{1}{2}t_{4}t_{5}+t_{6}^{2 } , \\\\",
    "\\scriptstyle      -\\frac{1}{2}t_{3}t_{4}+t_{5}t_{8}+\\frac{1}{2}t_{6}t_{9 } , \\\\   \\scriptstyle      t_{2}t_{6}-t_{7}t_{9}-{4}t_{8}^{2 } , \\\\",
    "\\scriptstyle      t_{5}t_{2}-{2}t_{3}t_{7}+t_{8}t_{9 } , \\\\",
    "\\scriptstyle      -\\frac{1}{4}t_{2}t_{4}+\\frac{1}{4}t_{3}t_{9}+t_{7}t_{8 } , \\\\",
    "\\scriptstyle      t_{1}t_{7}+t_{2}t_{7}-{4}t_{3}t_{4}+{2}t_{6}t_{9 } , \\\\   \\scriptstyle      t_{1}t_{6}-{2}t_{4}^{2}+t_{7}t_{9 } , \\\\",
    "\\scriptstyle      \\frac{1}{2}t_{1}t_{6}-\\frac{1}{2}t_{2}t_{6}+t_{3}^{2}-t_{4}^{2 } , \\\\   \\scriptstyle      t_{1}t_{8}-{2}t_{4}t_{7}+t_{5}t_{9 } ,   \\\\[1ex ]   \\text{the class group and degree matrix are}\\\\[1ex ]   \\zz \\oplus \\zz/2\\zz \\oplus \\zz/4\\zz \\end{array } $ ] & @xmath488      \\mbox{\\tiny$        \\left [      \\begin{array}{rrrrrrrrr }      1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\      \\bar 1 & \\bar 1 & \\bar 0 & \\bar 1 & \\bar 1 & \\bar 1 & \\bar 0 & \\bar 0 & \\bar 0 \\\\",
    "\\bar 3 & \\bar 3 & \\bar 2 & \\bar 0 & \\bar 2 & \\bar 1 & \\bar 3 & \\bar 0 & \\bar 1      \\end{array }      \\right ]      $ }   \\end{array } $ ] +   +   + @xmath489 & @xmath490 / i \\text { with $ i$ generated by } \\\\[1ex ] \\scriptstyle      { 3}t_{3}t_{6}+{3}t_{4}t_{7}\\zeta + ( -{3}\\zeta -{3})t_{5}t_{8},\\\\ \\scriptstyle       ( \\zeta -{1})t_{2}t_{8}+{3}t_{3}^{2}+(-\\zeta -{2})t_{6}t_{9},\\\\ \\scriptstyle       { 3}t_{2}t_{7}\\zeta + { 3}t_{6}t_{10}+(-{3}\\zeta -{3})t_{8}t_{9},\\\\ \\scriptstyle       ( -\\zeta + { 1})t_{2}t_{5}+(\\zeta -{1})t_{4}t_{9}+{3}t_{6}t_{8},\\\\ \\scriptstyle       -\\zeta",
    "t_{1}t_{10}+t_{2}t_{10}\\zeta + { 3}t_{4}t_{7}-{3}t_{5}t_{8},\\\\ \\scriptstyle       ( \\zeta + { 1})t_{1}t_{10}-t_{2}t_{10}\\zeta + { 3}t_{5}t_{8}-t_{9}^{2},\\\\   \\scriptstyle       -t_{1}t_{9}\\zeta -t_{2}t_{9}+{3}t_{3}t_{7}+(\\zeta + { 1})t_{10}^{2},\\\\ \\scriptstyle       -t_{1}t_{9}\\zeta + t_{2}t_{9}\\zeta + { 3}t_{3}t_{7}-{3}t_{8}t_{4},\\\\   \\scriptstyle       ( -\\zeta + { 1})t_{1}t_{8}+(\\zeta -{1})t_{2}t_{8}+{3}t_{3}^{2}-{3}t_{4}t_{5},\\\\ \\scriptstyle       ( \\zeta + { 2})t_{1}t_{7}+(-\\zeta -{2})t_{2}t_{7}+{3}t_{4}t_{3}-{3}t_{5}^{2},\\\\      \\scriptstyle       t_{2}t_{1}+(-\\zeta -{1})t_{2}^{2}+{3}t_{8}t_{3}+t_{9}t_{10}\\zeta,\\\\ \\scriptstyle       -\\zeta   t_{1}t_{2}+{3}t_{4}t_{6}+t_{9}t_{10}\\zeta , \\\\ \\scriptstyle       t_{1}^{2}+(-\\zeta -{1})t_{1}t_{2}+{3}t_{5}t_{7}+t_{9}t_{10}\\zeta      \\\\[1ex ]      \\text{the class group and degree matrix are}\\\\[1ex ]      \\zz \\oplus",
    "\\zz/3\\zz \\oplus \\zz/3\\zz      \\end{array } $ ] & @xmath491      \\text{where $ \\zeta$ is a primitive third root of unity.}\\\\[2ex ]      \\mbox{\\tiny$       \\left [      \\begin{array}{rrrrrrrrrr }      1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\      \\bar   2 & \\bar   2 & \\bar   1 & \\bar   0 & \\bar   2 & \\bar   1 & \\bar   2 & \\bar   0 & \\bar   1 & \\bar   0 \\\\      \\bar   1 & \\bar   1 & \\bar   2 & \\bar   2 & \\bar   2 & \\bar   0 & \\bar   0 & \\bar   0 & \\bar   1 & \\bar   1      \\end{array }      \\right ] .",
    "$ } \\end{array } $ ] +   +    first recall from  ( * ? ? ?",
    "* theorem  8.3 ) that the isomorphy classes of gorenstein log del pezzo surfaces of picard number one that do not allow a @xmath492-action correspond bijectively to singularity types we listed .",
    "each surface @xmath0 of the list is obtained by contracting curves of a smooth surface @xmath19 arising as a blow up of @xmath174 with generators for the cox ring known by  @xcite . a direct application of algorithms  [ algo : modifycemds ] and  [ algo : contractcemds ] is not always feasible .",
    "however , we have enough information to present the blow ups of @xmath174 as a weak cemds . as an example",
    ", we treat the @xmath468-case . by  @xcite , with @xmath493 , additional generators for @xmath494 correspond in @xmath495 to @xmath496 using algorithm  [ algo : stretchcemds ] with input the cemds @xmath174 and @xmath497 , we obtain a cemds @xmath11 .",
    "again by  ( * ? ? ?",
    "6 ) , we know the degree matrix @xmath498 of @xmath19 .",
    "write @xmath499 $ ] with submatrices @xmath373 and @xmath136 consisting of the first @xmath204 and the last @xmath206 columns respectively .",
    "we compute a gale dual matrix @xmath417 of the form @xmath500 $ ] by solving @xmath501 .",
    "let @xmath502 and @xmath503 be the maps of tori corresponding to @xmath310 and @xmath417 . instead of using algorithm  [ algo : modifycemds ] , we directly produce the equations @xmath504 for @xmath19 on the torus : @xmath505 note that by  @xcite , the variables define pairwise non - associated @xmath17-prime generators for @xmath494 .",
    "this makes @xmath19 a weak cemds with data @xmath506 , where @xmath398 is the stellar subdivision of the fan @xmath333 of the cemds @xmath11 at the columns of @xmath200 .",
    "we now use algorithm  [ algo : contractcemds ] to contract on @xmath19 the curves corresponding to the variables @xmath67 with @xmath507 .",
    "the resulting ring is the one listed in the table of the theorem .",
    "the minimal resolutions @xmath25 of the surfaces @xmath0 listed in theorem  [ thm : gorensteinlogpezzos ] arise from the plane @xmath174 by blowing up @xmath508 points in almost general position , where @xmath509 is the _ degree _ of the weak del pezzo surface @xmath25 . in the case of singularity type @xmath478",
    "we obtain degree  2 and in all other cases we have degree  1 .",
    "the surfaces with singularity type @xmath473 , @xmath475 and @xmath459 are the only ones in the list theorem  [ thm : gorensteinlogpezzos ] for which the minimal resolution has a hypersurface as cox ring , see  ( * ? ? ?",
    "* sect .  3 , table  9 ) .",
    "moreover , these surfaces admit small degenerations into @xmath23-surfaces .",
    "in fact , multiplying the monomials @xmath510 and @xmath511 in the respective cox rings with a parameter @xmath512 gives rise to a flat family of cox rings over @xmath1 .",
    "the induced flat family of surfaces over @xmath1 has a @xmath23-surface as zero fiber , compare also the corresponding cox rings listed in  ( * ? ? ?",
    "* theorem  5.6 ) .",
    "the surfaces of singularity type @xmath478 , @xmath479 and @xmath465 have hypersurface cox rings but their resolutions do not , see again  ( * ? ? ?",
    "* sect .  3 , table  9 ) .",
    "for example , the cox ring of the minimal resolution of the surface with a @xmath465 singularity is @xmath513/i$ ] , where @xmath438 is generated by @xmath514 and the degree matrix of the @xmath515-grading is given by @xmath516 $ } .\\ ] ] we remark here that the computation of the cox rings for the minimal resolutions of the surfaces with singularity type @xmath478 and @xmath479 were not feasible on our systems .    [",
    "rem : anticanmod ] given a cemds @xmath60 with cox ring @xmath104 and a divisor class @xmath53 , consider the graded ring @xmath517 given monomial generators @xmath518 of a veronese subalgebra @xmath519 , where @xmath520 , one obtains homogeneous equations for @xmath521 by computing the closure of the image of @xmath57 under the toric morphism @xmath522 where @xmath51 denotes the ambient toric total coordinate space .",
    "if the canonical class of @xmath0 is known , e.g.  if @xmath104 is a complete intersection cox ring  ( * ? ? ?",
    "4.15 ) , one obtains this way equations for anticanonical models . for the surfaces @xmath0 of theorem  [ thm : gorensteinlogpezzos ] with a minimal resolution @xmath25 of degree 1 , the anticanonical model is always a hypersurface in @xmath523 .",
    "for example , we have the following equations ( listed by singularity type ) : @xmath524 d_8 \\colon & \\scriptstyle   t_{1}^4t_{3 } - t_{1}t_{2}t_{3}^2 + t_{3}^3 + t_{4}^2 \\\\[3pt ] d_5a_3 \\colon & \\scriptstyle   t_{1}^2t_{2}t_{4 } - t_{1}t_{2}t_{3}^2 + t_{1}t_{3}t_{4 } - t_{3}^3 - t_{4}^2 \\\\[3pt ] d_62a_1 \\colon & \\scriptstyle   t_{1}^3t_{2}t_{3 } - 3t_{1}^2t_{2}^2t_{3 } + t_{1}^2t_{3}^2 + 3t_{1}t_{2}^3t_{3 } - 3t_{1}t_{2}t_{3}^2 - t_{2}^4t_{3 } + 2t_{2}^2t_{3}^2 - t_{3}^3 + t_{4}^2 \\\\[3pt ] e_6a_2 \\colon & \\scriptstyle   t_{1}^2t_{2}t_{4 } - t_{1}t_{3}t_{4 } - t_{3}^3 - t_{4}^2 \\\\[3pt ] e_7a_1 \\colon & \\scriptstyle   t_{1}^3t_{2}t_{3 } - t_{1}t_{3}t_{4 } - t_{3}^3 + t_{4}^2 \\\\[3pt ] e_8 \\colon & \\scriptstyle   t_{1}t_{2}^5 - t_{2}^2t_{3}^2 - t_{3}^3 - t_{4}^2 \\\\[3pt ] a_8 \\colon & \\scriptstyle   t_{1}^3t_{4 } - t_{2}t_{3}t_{4 } + t_{3}^3 + t_{4}^2 \\\\[3pt ] a_7a_1 \\colon & \\scriptstyle   t_{1}^2t_{2}t_{4 } - t_{1}^2t_{3}^2 + t_{2}t_{3}t_{4 } - t_{3}^3 + t_{4}^2 \\end{array}\\ ] ]",
    "we consider the blow up of a given mori dream space with known cox ring and develop a method to produce systematically generators for the new cox ring .",
    "the key step is a description of the cox ring of a blow up as a saturated rees algebra .",
    "let @xmath11 be a mori dream space and @xmath81 the blow up of an irreducible subvariety @xmath26 contained in the smooth locus of @xmath11 .",
    "as before , write @xmath239 for the divisor class groups and @xmath240 for the cox rings . then we have the canonical pullback maps @xmath525 \\mapsto [ \\pi^*d ] , \\qquad \\pi^ * \\colon r_1 \\to r_2 ,   \\   ( r_1)_{[d ] } \\ni f \\mapsto \\pi^*f \\in ( r_2)_{[\\pi^*d]}.\\ ] ] moreover , identifying @xmath94 with @xmath95 , we obtain canonical push forward maps @xmath526 \\mapsto [ \\pi_*d ] , \\qquad \\pi _ * \\colon r_2 \\to r_1 ,   \\   ( r_2)_{[d ] } \\ni f \\mapsto f_{\\vert u } \\in ( r_1)_{[\\pi_*d]}.\\ ] ] let @xmath527 be the irrelevant ideal , i.e.  the vanishing ideal of @xmath528 , and @xmath529 the vanishing ideal of @xmath530 with the characteristic space @xmath531 .",
    "we define the _ saturated rees algebra _ to be the subalgebra @xmath532^{\\rm sat } \\ : = \\   \\bigoplus_{d \\in \\zz } ( i^{-d}:j^\\infty ) t^d \\ \\subseteq \\",
    "r_1[t^{\\pm 1 } ] , \\qquad \\text{where } i^k : = r_1 \\text { for }   k \\le 0.\\ ] ]    the usual rees algebra @xmath533 = \\oplus_{\\zz } i^ { -d}t^d$ ] is a subalgebra of the saturated rees algebra @xmath534^{\\rm sat}$ ] . in the above situation , @xmath535 is a @xmath110-prime ideal and thus we have @xmath536 .",
    "consequently , @xmath534^{\\rm sat}$ ] equals @xmath534 $ ] if and only if @xmath534^{\\rm sat}$ ] is generated in the @xmath27-degrees @xmath537 and @xmath538 . in this case , @xmath534^{\\rm sat}$ ] is finitely generated because @xmath533 $ ] is so .",
    "note that the saturated rees algebra @xmath533^{\\rm sat}$ ] is naturally graded by @xmath539 as @xmath225 is @xmath434-graded and the ideals @xmath438 , @xmath540 are homogeneous .",
    "let @xmath541 denote the exceptional divisor .",
    "then we have a splitting @xmath542 \\cong k_1 \\times \\zz$ ] .",
    "[ prop : reesalg ] in the above situation , we have the following mutually inverse isomorphisms of graded algebras @xmath543^{\\rm sat } , \\\\ ( r_2)_{[\\pi^*d]+d[e ] } \\ni f & \\mapsto &   \\pi_*f \\cdot t^d \\in ( r_1[i]^{\\rm sat})_{([d],d ) } , \\\\ ( r_2)_{[\\pi^*d]+d[e ] } \\ni \\pi^ * f \\cdot 1_e^d & \\mapsfrom &   f \\cdot",
    "t^d \\in ( r_1[i]^{\\rm sat})_{([d],d)}.\\end{aligned}\\ ] ]    [ lem : reeslem ] in the above situation , consider the characteristic spaces @xmath305 and let @xmath544 , @xmath545 , @xmath546 , @xmath547 be the ideal sheaves of @xmath136 , @xmath548 , @xmath153 , @xmath549 on @xmath11 , @xmath550 , @xmath19 , @xmath551 respectively . then , for any @xmath552 , we have @xmath553 moreover , with the vanishing ideals @xmath535 of the closure of @xmath554 and @xmath527 of @xmath555 , we have @xmath556 for any @xmath552 .    for the first equality",
    ", we use that @xmath136 is contained in the smooth locus of @xmath11 .",
    "this implies that @xmath557 has no multiple fibers near @xmath136 and the claim follows .",
    "the second equality is obtained by the same reasoning .",
    "the third one is a standard fact on blowing up  ( * ? ? ?",
    "8.1.7 and cor .",
    "the last statement follows from the fact that @xmath550 is quasiaffine .",
    "we only have to prove that the maps are well defined .",
    "for the map from @xmath10 to @xmath533^{\\rm sat}$ ] consider @xmath558,d)}$ ] .",
    "we have to show that for @xmath559 , the push forward @xmath560 belongs to @xmath561 .",
    "note that @xmath562 holds with @xmath563}$ ] .",
    "pushing @xmath564 locally to @xmath19 , then to @xmath11 and finally lifting it to @xmath550 , we see using lemma  [ lem : reeslem ] that @xmath565 is a global section of the @xmath566-th power of the ideal sheaf of @xmath567 .",
    "this gives @xmath568 .",
    "for the map from @xmath533^{\\rm sat}$ ] to @xmath10 , consider @xmath569^{\\rm sat})_{([d],d)}$ ] , where @xmath559 .",
    "we need that @xmath570 divides @xmath571 in @xmath10 . by definition ,",
    "there exist an @xmath572 and a @xmath573 such that @xmath574 and @xmath575 .",
    "then we have @xmath576 . using @xmath577 and the fact that @xmath578 is a @xmath105-prime not dividing any power of @xmath579 we see that @xmath570 divides @xmath571 .    for the computation of the cox ring @xmath10",
    ", we work in the notation of setting  [ set : ambmod ] ; in particular @xmath11 comes as a cemds @xmath13 . as before",
    ", @xmath26 is an irreducible subvariety contained in the smooth locus of @xmath11 and @xmath580 denotes its inverse image with respect to @xmath581 .",
    "the idea is to stretch the given embedding @xmath13 by suitable generators of the vanishing ideal @xmath535 of @xmath582 and then perform an ambient modification .",
    "[ algo : latticeideal ] _ input : _ a cemds @xmath306 , a @xmath110-prime ideal @xmath583 with pairwise non - associated @xmath110-primes @xmath584 defining an irreducible subvariety @xmath26 inside the smooth locus and coprime positive integers @xmath585 with @xmath586 .    *",
    "compute the stretched cemds @xmath322 by applying algorithm  [ algo : stretchcemds ] to @xmath306 and @xmath307 .",
    "* define a multiplicity vector @xmath587 by @xmath588 for @xmath589 and @xmath590 for @xmath591 . *",
    "determine the stellar subdivision @xmath592 of the fan @xmath593 along the ray through @xmath594 .",
    "set @xmath595 $ ] . *",
    "compute @xmath393 by applying algorithm  [ algo : modifycemds ] to @xmath322 and the pair @xmath416 .",
    "* let @xmath596 be the product over all @xmath67 with @xmath597 where @xmath598 is the divisor corresponding to @xmath67 .",
    "test whether @xmath599 .",
    "* set @xmath600 .",
    "eliminate all fake relations by applying algorithm  [ algo : compresscemds ] .",
    "call the output @xmath393 .",
    "_ output : _ @xmath393 .",
    "if the verification in the next to last step was positive , then @xmath393 is a cemds describing the blow up @xmath19 of @xmath11 along  @xmath136 . in particular then the @xmath105-graded algebra @xmath10 is the cox ring of  @xmath19 .",
    "consider the @xmath105-graded ring @xmath601/i_2 $ ] associated to the output @xmath393 .",
    "the first step is to show that @xmath10 is normal ; then @xmath393 is a cemds and @xmath213 is the cox ring of the output variety @xmath83 . in a second step",
    "we show that @xmath19 equals the blow up of @xmath11 along  @xmath136 .",
    "consider the output @xmath393 of the fourth item , i.e.  the situation before eliminating fake relations .",
    "the variables @xmath602 correspond to @xmath313 and @xmath603 to the exceptional divisor .",
    "observe that we have a canonical @xmath105-graded homomorphism @xmath604^{\\rm sat}$ ] induced by @xmath605 \\",
    "\\to \\   r_1[i]^{\\rm sat } , \\qquad t_i   \\ \\mapsto \\",
    "\\begin{cases } t_i , & 1 \\le i \\le r_1 , \\\\",
    "f_{i - r_{1}}t^{-v_i } , & r_1 < i < r_2 , \\\\ t ,         & i = r_2 . \\end{cases}\\ ] ] indeed , because @xmath136 is contained in the smooth locus of @xmath11 , the cone generated by the last @xmath144 columns of @xmath318 is regular and , because in addition @xmath606 are coprime , the vector @xmath594 is primitive .",
    "thus , the ideal @xmath18 of @xmath19 is the saturation with respect to @xmath603 of @xmath607.\\ ] ] consequently , the above assignment induces a homomorphism @xmath604^{\\rm sat}$ ] .",
    "this homomorphism induces an isomorphism of the @xmath105-graded localizations @xmath608^{\\rm sat } \\right)_{t}\\ ] ] and hence is in particular injective . as the image @xmath609 contains generators @xmath610 and @xmath611 for the rees algebra @xmath533 $ ] , we obtain @xmath532 \\",
    "\\ \\subseteq \\ \\   { \\varphi}(r_2 )",
    "\\ \\ \\subseteq \\ \\   r_1[i]^{\\rm sat}.\\ ] ]    we show that @xmath609 equals @xmath533^{\\rm sat}$ ] .",
    "otherwise , the algebras must be different in some degree , i.e.  we can choose @xmath612 minimal such that there is @xmath613^{\\rm sat})_{-n}\\setminus { \\varphi}(r_2)_{-n}$ ] .",
    "the minimality implies @xmath614^{\\rm sat}}\\cap { \\varphi}(r_2)$ ] with @xmath615 .",
    "in particular , @xmath616 is properly contained in @xmath617^{\\rm sat}}\\cap { \\varphi}(r_2)$ ] .",
    "define @xmath596 as the product over all @xmath67 such that @xmath597 where @xmath598 is the divisor corresponding to @xmath67 . note that @xmath618 . in the localized algebras @xmath532_{t^\\nu } \\ = \\   { \\varphi}(r_2)_{t^\\nu } \\ = \\    \\left(r_1[i]^{\\rm sat}\\right)_{t^\\nu}\\ ] ] the ideal @xmath616 and the @xmath105-prime ideal @xmath617^{\\rm sat}}\\cap { \\varphi}(r_2)$ ] coincide , i.e.  @xmath619 is @xmath105-prime in @xmath620 . by the dimension test we know that @xmath619 and @xmath596 are coprime in @xmath609 . consequently , @xmath619 is @xmath105-prime in @xmath609 .",
    "therefore , @xmath617^{\\rm sat}}\\cap { \\varphi}(r_2)= \\<t\\>_{{\\varphi}(r_2)}$ ] in @xmath609 , a contradiction .",
    "we conclude @xmath621^{\\rm sat}$ ] .    by proposition  [ prop : reesalg ] ,",
    "@xmath533^{\\rm sat}\\cong r_2 $ ] is the cox ring of the blow up @xmath622 of @xmath11 at @xmath136 . in particular",
    ", @xmath623 is normal .",
    "we may now apply algorithm  [ algo : compresscemds ] .",
    "note that there is no need to use the ` verify ` option as the variables @xmath624 are @xmath105-prime and the generators surviving the elimination process are @xmath105-prime as well . as for any cox ring ,",
    "the @xmath105-grading is almost - free .",
    "we show that @xmath625 holds .",
    "let @xmath626 be the chamber representing @xmath11 .",
    "then @xmath101 is of codimension one in @xmath627 and lies on the boundary of @xmath628 .",
    "since there are the contraction morphisms @xmath8 and @xmath629 , the chambers @xmath630 corresponding to @xmath19 , @xmath622 both have @xmath101 as a face .",
    "we conclude @xmath631 and thus @xmath625 .",
    "an important special case of algorithm  [ algo : latticeideal ] is blowing up a smooth point .",
    "the point @xmath632 can be given in cox coordinates , i.e.  as a point @xmath633 with @xmath634 .",
    "the steps are as follows .",
    "let @xmath635 be a cemds and @xmath636 a smooth point given in cox coordinates @xmath637 .",
    "let @xmath638 be the indices with @xmath639 and @xmath640 a lattice basis for @xmath641 .",
    "the _ associated ideal _ to @xmath310 and @xmath642 is @xmath643,\\end{aligned}\\ ] ] where @xmath644 is the unique representation as a sum of a nonnegative and a nonpositive vector having disjoint supports .",
    "the ideal is generated by variables and binomials ; for general @xmath642 it is a lattice ideal see  @xcite . then @xmath645 is the vanishing ideal of the orbit closure @xmath646 in @xmath647 .",
    "let @xmath307 be a list of pairwise non - associated @xmath110-prime generators for @xmath648 and @xmath649 .",
    "then the cox ring of the blow up of @xmath11 in @xmath650 can be computed with algorithm  [ algo : latticeideal ] with input @xmath307 and @xmath651 .",
    "the following algorithm produces systematically generators and their multiplicities @xmath652 of the cox ring of a blow up of a mori dream space in the sense that adds step by step generator sets for the positive rees algebra components .",
    "[ algo : latticeideal2 ] _ input : _ a cemds @xmath306 , a @xmath110-prime ideal @xmath438 defining an irreducible subvariety @xmath26 inside the smooth locus .",
    "* let @xmath653 and @xmath373 be empty lists . * for each @xmath654 do * *",
    "compute a set @xmath655 of generators for @xmath656 .",
    "let @xmath657 be a maximal subset of pairwise non - associated elements of @xmath655 with @xmath658 * * determine integers @xmath659 such that @xmath660 . * * add the elements of @xmath657 to @xmath653 that are not associated to any other element of @xmath653 . add the respective integers among @xmath661 to  @xmath373 .",
    "* * run algorithm  [ algo : latticeideal ] with input @xmath306 , @xmath653 and  @xmath373 . * * if algorithm  [ algo : latticeideal ] terminated with @xmath393 and positive verification , return @xmath393 .",
    "_ output ( if provided ) : _ the algorithm terminates if and only if @xmath19 is a mori dream space . in this case",
    ", the cemds @xmath393 describes the blow up @xmath19 of @xmath11 along @xmath136 .",
    "in particular then the @xmath105-graded algebra @xmath10 is the cox ring of  @xmath19 .",
    "note that each @xmath662 is a @xmath110-prime element .",
    "otherwise , @xmath663 with @xmath110-homogeneous elements @xmath584 . as @xmath438 is @xmath110-prime , @xmath664 or @xmath665",
    "lies in @xmath666 with @xmath667 , i.e.  @xmath668 .",
    "this contradicts the choice of  @xmath662 .    by proposition  [ prop : reesalg ] ,",
    "the cox ring @xmath10 of the blow up is isomorphic to the saturated rees algebra @xmath533^{\\rm sat}$ ] .",
    "after the @xmath669-th step , @xmath670 are generators for a subalgebra @xmath671^{\\rm sat}$ ] such that @xmath672 \\ \\subseteq\\   b_k \\ \\subseteq\\   \\bigoplus_{k\\in \\zz } a_{k}t^{-k } \\ = \\   r_1[i]^{\\rm sat}.\\ ] ] if the algorithm stops , by the correctness of algorithm  [ algo : latticeideal ] , the output then is a cemds describing the blow @xmath19 with cox ring @xmath10 . vice versa , if @xmath19 has finitely generated cox ring , there is @xmath673 with @xmath533^{\\rm sat } = b_{k_0}$ ] .",
    "then algorithm  [ algo : latticeideal ] is called with @xmath110-prime non - associated generators for @xmath674^{\\rm sat}$ ] and thus terminates with positive verification .",
    "[ ex : wpp345 ] we compute the cox ring of the blow up of the weighted projective plane @xmath675 at the general point with cox coordinates @xmath676 by the steps of algorithm  [ algo : latticeideal2 ] .",
    "the lattice ideal of @xmath677 with respect to @xmath310 is    @xmath678    @xmath679.\\ ] ]    an application of algorithm  [ algo : latticeideal ] with the three generators @xmath680 of @xmath681 and all @xmath682 fails .",
    "however , adding the additional generator @xmath683 with @xmath684 to the input , algorithm  [ algo : latticeideal ] returns the @xmath685-graded cox ring @xmath686 of the blow up @xmath19 of @xmath11 in @xmath687 $ ] .",
    "all verifications are positive .",
    "the ring is given as @xmath688 with generators for @xmath18 and the degree matrix being    @xmath689    @xmath690.\\ ] ]    in algorithm  [ algo : latticeideal ] , the saturation computation may become infeasible . in this case , the following variant can be used to obtain at least finite generation .",
    "[ algo : fg ] _ input : _ a cemds @xmath306 , a @xmath110-prime ideal @xmath583 with pairwise non - associated @xmath110-primes @xmath142 defining an irreducible subvariety @xmath26 inside the smooth locus and coprime positive integers @xmath585 with @xmath586 .    *",
    "compute the stretched cemds @xmath322 by applying algorithm  [ algo : stretchcemds ] to @xmath306 and @xmath307 .",
    "* define a multiplicity vector @xmath587 by @xmath588 if @xmath691 and @xmath692 for @xmath693 .",
    "* determine the stellar subdivision @xmath592 of the fan @xmath593 along the ray through @xmath594 .",
    "set @xmath595 $ ] .",
    "* compute @xmath418 , where @xmath694 and @xmath695 .",
    "* choose a system of generators @xmath394 of an ideal @xmath696 with @xmath697 . *",
    "check if @xmath422 for all @xmath423 .",
    "* check if @xmath603 is prime in @xmath698[t_{r_2}]/i_2 $ ] .",
    "_ output : _ @xmath393 .",
    "the es @xmath393 describes the blow up @xmath19 of @xmath11 along @xmath136 .",
    "if all verifications in the last steps were positive , the cox ring @xmath494 is finitely generated and is given by the @xmath699-equivariant normalization of @xmath700 .    by the last verification ,",
    "the exceptional divisor @xmath701 inherits a local defining equation from the toric ambient variety @xmath180 .",
    "thus , the ambient modification is neat in the sense of  ( * ? ? ?",
    "5.4 ) . by  ( * ? ? ?",
    "5.5 ) , @xmath702 is a neat embedding . in turn , the dimension checks enable us to use  ( * ? ? ?",
    "2.7 ) , which completes the proof .",
    "we consider smooth rational surfaces @xmath0 of picard number @xmath28 . using algorithm  [ algo : latticeideal ] , we show that they are all mori dream surfaces and we compute their cox rings .",
    "recall that every smooth rational surface @xmath0 of picard number @xmath703 can be obtained by blowing up the projective plane @xmath174 at @xmath704 points or a hirzebruch surface @xmath705 at @xmath706 points , where , in both cases , some points may be infinitely near , i.e.  one also performs iterated blow ups . whereas blow ups of the projective plane @xmath174 can be done in a purely computational manner , the treatment of the ( infinitely many ) hirzebruch surfaces @xmath705 requires also theoretical work due to their parameter @xmath707 .    in the following statement , we concentrate on those surfaces @xmath0 that do not admit a ( non - trivial ) @xmath23-action ; for the full list of cox rings in the case @xmath708",
    ", we refer to  @xcite .",
    "note that the rational @xmath23-surfaces as well as the toric ones admit a combinatorial description which opens a direct approach to their cox rings , see  @xcite .",
    "we denote the iterated blow up of a point @xmath650 by sequences of @xmath709 and @xmath710 indicating general and special points on the @xmath65-th exceptional divisor over @xmath650 .",
    "for example , @xmath711 indicates a fourfold blow up of a point with a general point @xmath712 on the first exceptional divisor , a general point @xmath713 on the second and a special point @xmath714 on the third .",
    "the special points will be precisely defined in each case .",
    "[ thm : pic6 ] let @xmath0 be a smooth rational surface with picard number @xmath715 . then @xmath0 is a mori dream space . if @xmath716 , then either @xmath0 admits a @xmath23-action or is isomorphic to @xmath717 , the blow up of @xmath174 in four general points .",
    "if @xmath718 , then @xmath0 admits a @xmath23-action or its cox ring is isomorphic to exactly one of the following , where @xmath719 .    1 .   the @xmath720-graded ring @xmath721 , where generators for @xmath438 and the degree matrix are given as + @xmath722 +   + + in this case , @xmath0 is a @xmath723-fold blow up of @xmath174 in a point of type @xmath724 , where @xmath714 is the intersection point of the 3rd and the 2nd exceptional divisor .",
    "+ ( p1 ) at ( -2,0 ) ; ( p2 ) at ( 2,0 ) ; ( p3 ) at ( 0,3 ) ; + ( p1)(p2)(p3)cycle ; ( p1)(p2)(p3)cycle ; + ( p1 ) circle ( .20 cm ) node[anchor = east]@xmath723 ; 2 .",
    "the @xmath720-graded ring @xmath721 , where generators for @xmath438 and the degree matrix are given as + @xmath725 +   + + in this case , @xmath0 is a @xmath726-fold blow up of @xmath174 in @xmath727 $ ] of type @xmath728 , and single blow ups in @xmath729 $ ] and @xmath730 $ ] .",
    "+ ( p1 ) at ( -2,0 ) ; ( p2 ) at ( 2,0 ) ; ( p3 ) at ( 0,3 ) ; + ( p1)(p2)(p3)cycle ; ( p1)(p2)(p3)cycle ; + ( p1 ) circle ( .20 cm ) node[anchor = east]@xmath726 ; ( p2 ) circle ( .20 cm ) ; ( @xmath731 ) circle ( .20 cm ) ; 3 .",
    "the @xmath720-graded ring @xmath732 , where generators for @xmath438 and the degree matrix are given as + @xmath733 +   + + in this case , @xmath0 is the @xmath726-fold blow up of @xmath174 in @xmath727 $ ] of type @xmath734 and single blow ups in @xmath729 $ ] and @xmath730 $ ] .",
    "+ ( p1 ) at ( -2,0 ) ; ( p2 ) at ( 2,0 ) ; ( p3 ) at ( 0,3 ) ; + ( p1)(p2)(p3)cycle ; ( p1)(p2)(p3)cycle ; + ( p1 ) circle ( .20 cm ) node[anchor = east]@xmath726 ; ( p2 ) circle ( .20 cm ) ; ( @xmath731 ) circle ( .20 cm ) ; 4 .",
    "the @xmath720-graded ring @xmath721 , where generators for @xmath438 and the degree matrix are given as + @xmath735 +   + + in this case , @xmath0 is the @xmath726-fold blow up of @xmath174 in @xmath727 $ ] of type @xmath736 with the intersection point @xmath737 of the 1st exceptional divisor and the transform of @xmath738 and single blow ups in @xmath729 $ ] and @xmath730 $ ] .",
    "+ ( p1 ) at ( -2,0 ) ; ( p2 ) at ( 2,0 ) ; ( p3 ) at ( 0,3 ) ; + ( p1)(p2)(p3)cycle ; ( p1)(p2)(p3)cycle ; + ( p1 ) circle ( .20 cm ) node[anchor = east]@xmath726 ; ( p2 ) circle ( .20 cm ) ; ( @xmath731 ) circle ( .20 cm ) ; 5 .   the @xmath720-graded ring @xmath739 , where generators for @xmath438 and the degree matrix are given as + @xmath740 +   + + in this case , @xmath0 is the the blow up of @xmath174 in @xmath727 $ ] , @xmath729 $ ] , @xmath741 $ ] , @xmath742 $ ] and @xmath743 $ ] where @xmath744 . + ( p1 ) at ( -2,0 ) ; ( p2 ) at ( 2,0 ) ; ( p3 ) at ( 0,3 ) ; ( gen ) at ( 0,1.25 ) ; + ( p1)(p2)(p3)cycle ; ( p1)(p2)(p3)cycle ; + ( p1 ) circle ( .20 cm ) ; ( p2 ) circle ( .20 cm ) ; ( p3 ) circle ( .20 cm ) ; ( gen ) circle ( .20 cm ) ; ( @xmath745 ) circle ( .20 cm ) node[anchor = north]@xmath101 ; 6 .   the @xmath720-graded ring @xmath746 , where generators for @xmath438 and the degree matrix are given as + @xmath747 +   + + in this case , @xmath0 is the blow up of @xmath174 in @xmath727 $ ] , @xmath729 $ ] , @xmath741 $ ] , @xmath742 $ ] and @xmath748 $ ] where @xmath749 .",
    "+ ( p1 ) at ( -2,0 ) ; ( p2 ) at ( 2,0 ) ; ( p3 ) at ( 0,3 ) ; ( gen ) at ( .2,1.25 ) ; ( gen2 ) at ( -.65,1.15 ) ; + ( p1)(p2)(p3)cycle ; ( p1)(p2)(p3)cycle ; + ( p1 ) circle ( .20 cm ) ; ( p2 ) circle ( .20 cm ) ; ( p3 ) circle ( .20 cm ) ; ( gen ) circle ( .20 cm ) ; ( gen2 ) circle ( .20 cm ) node[anchor = east]@xmath750 ; 7 .",
    "the @xmath720-graded ring @xmath732 , where generators for @xmath438 and the degree matrix are given as + @xmath751 +   + + in this case , @xmath0 is the blow up of @xmath174 in the points @xmath727 $ ] , @xmath729 $ ] , @xmath741 $ ] , @xmath730 $ ] and @xmath752 $ ] .",
    "+ ( p1 ) at ( -2,0 ) ; ( p2 ) at ( 2,0 ) ; ( p3 ) at ( 0,3 ) ; ( gen ) at ( 0,1.25 ) ; + ( p1)(p2)(p3)cycle ; ( p1)(p2)(p3)cycle ; + ( p1 ) circle ( .20 cm ) ; ( p2 ) circle ( .20 cm ) ; ( p3 ) circle ( .20 cm ) ; ( @xmath731 ) circle ( .20 cm ) ; ( @xmath753 ) circle ( .20 cm ) ; 8 .",
    "the @xmath720-graded ring @xmath721 , where generators for @xmath438 and the degree matrix are given as + @xmath754 +   + + in this case , @xmath0 is the @xmath755-fold blow up of @xmath174 in @xmath727 $ ] of type @xmath712 and single blow ups in @xmath729 $ ] , @xmath741 $ ] and @xmath730 $ ] .",
    "+ ( p1 ) at ( -2,0 ) ; ( p2 ) at ( 2,0 ) ; ( p3 ) at ( 0,3 ) ; ( gen ) at ( 0,1.25 ) ; + ( p1)(p2)(p3)cycle ; ( p1)(p2)(p3)cycle ; + ( p1 ) circle ( .20 cm ) node[anchor = east]@xmath755 ; ( p2 ) circle ( .20 cm ) ; ( p3 ) circle ( .20 cm ) ; ( @xmath731 ) circle ( .20 cm ) ; 9 .",
    "the @xmath720-graded ring @xmath721 , where generators for @xmath438 and the degree matrix are given as + @xmath756 +   + + in this case , @xmath0 is the blow up of @xmath757 in @xmath758 $ ] , @xmath759 $ ] , @xmath760 $ ] and @xmath761 $ ] where @xmath719 .",
    "+ ( 0,0 ) rectangle ( 4,-2.5 ) ; + ( 0,0 )  ( 4,0 ) ; ( 0,-2.5 )  ( 4,-2.5 ) ; ( 4,0 )  ( 4,-2.5 ) ; ( 0,0 )  ( 0,-2.5 ) ; + ( 0,0 ) circle ( .2 cm ) ; ( 2,0 ) circle ( .2 cm ) ; ( 4,0 ) circle ( .2 cm ) ; ( 0,-1.25 ) circle ( .2 cm ) ; 10 .",
    "the @xmath720-graded ring @xmath721 , where generators for @xmath438 and the degree matrix are given as + @xmath762 +   + + in this case , @xmath0 is the @xmath726-fold blow up of @xmath757 , @xmath719 , in @xmath758 $ ] of type @xmath736 with the intersection point @xmath737 of the 1st exceptional divisor and the transform of @xmath763 and a single blow up of @xmath761 $ ] .",
    "+ ( 0,0 ) rectangle ( 4,-2.5 ) ; + ( 0,0 )  ( 4,0 ) ; ( 0,-2.5 )  ( 4,-2.5 ) ; ( 4,0 )  ( 4,-2.5 ) ; ( 0,0 ) ",
    "( 0,-2.5 ) ; + ( 0,0 ) circle ( .2 cm ) node[anchor = east]@xmath726 ; ( 0,-1.25 ) circle ( .2 cm ) ; 11 .",
    "the @xmath720-graded ring @xmath721 , where generators for @xmath438 and the degree matrix are given as + @xmath764 +   + + in this case , @xmath0 is the @xmath726-fold blow up of @xmath757 , @xmath719 , in @xmath758 $ ] of type @xmath765 with the intersection point @xmath737 of the 1st exceptional divisor and the transform of @xmath766 and a single blow up of @xmath761 $ ] .",
    "+ ( 0,0 ) rectangle ( 4,-2.5 ) ; + ( 0,0 ) ",
    "( 4,0 ) ; ( 0,-2.5 ) ",
    "( 4,-2.5 ) ; ( 4,0 ) ",
    "( 4,-2.5 ) ; ( 0,0 ) ",
    "( 0,-2.5 ) ; + ( 0,0 ) circle ( .2 cm ) node[anchor = east]@xmath726 ; ( 0,-1.25 ) circle ( .2 cm ) ; 12 . @xmath767 the @xmath720-graded ring @xmath768 , where generators for @xmath438 and the degree matrix are given as + @xmath769 +   + + in this case , @xmath0 is the @xmath770-fold blow up of @xmath757 , @xmath719 , in @xmath758 $ ] of type @xmath771 with the intersection point @xmath737 of the 1st exceptional divisor and the transform of @xmath766 .",
    "+ ( 0,0 ) rectangle ( 4,-2.5 ) ; + ( 0,0 )  ( 4,0 ) ; ( 0,-2.5 )  ( 4,-2.5 ) ; ( 4,0 )  ( 4,-2.5 ) ; ( 0,0 )  ( 0,-2.5 ) ; + ( 0,0 ) circle ( .2 cm ) node[anchor = east]@xmath770 ; 13 .",
    "@xmath767 the @xmath720-graded ring @xmath768 , where generators for @xmath438 and the degree matrix are given as + @xmath772 +   + + in this case , @xmath0 is the @xmath755-fold blow up of @xmath757 , @xmath719 , in @xmath758 $ ] of type @xmath737 with the intersection point @xmath737 of the 1st exceptional divisor and the transform of @xmath773 and the @xmath755-fold blow up of @xmath761 $ ] of type @xmath712 .",
    "+ ( 0,0 ) rectangle ( 4,-2.5 ) ; + ( 0,0 )  ( 4,0 ) ; ( 0,-2.5 )  ( 4,-2.5 ) ; ( 4,0 )  ( 4,-2.5 ) ; ( 0,0 )  ( 0,-2.5 ) ; + ( 0,0 ) circle ( .2 cm ) node[anchor = east]@xmath755 ; ( 0,-1.25 ) circle ( .2 cm ) node[anchor = east]@xmath755 ; 14 .",
    "@xmath774 the @xmath720-graded ring @xmath732 , where generators for @xmath438 and the degree matrix are given as + @xmath775 +   + + in this case , @xmath0 is the blow up of @xmath757 , @xmath719 , in @xmath758 $ ] , @xmath759 $ ] , @xmath761 $ ] , @xmath776 $ ] where @xmath777 .",
    "+ ( 0,0 ) rectangle ( 4,-2.5 ) ; + ( 0,0 )  ( 4,0 ) ; ( 0,-2.5 )  ( 4,-2.5 ) ; ( 4,0 )  ( 4,-2.5 ) ; ( 0,0 )  ( 0,-2.5 ) ; + ( 0,0 ) circle ( .2 cm ) ; ( 4,0 ) circle ( .2 cm ) ; ( 4,-1.25 ) circle ( .2 cm ) node[anchor = west]@xmath778 ; ( 0,-1.25 ) circle ( .2 cm ) ;    of the surfaces marked with a single @xmath767 we do not know whether they admit a @xmath23-action .",
    "the surface marked with @xmath774 does not admit a non - trivial @xmath23-action and the listed ring is the cox ring for @xmath779 , whereas for @xmath780 , the surface is a mori dream surface having the @xmath699-equivariant normalization of @xmath781 as its cox ring .    in theorem  [ thm : pic6 ]",
    ", surface ( vi ) is a smooth del pezzo surface of degree  4 .",
    "the surfaces @xmath782 , @xmath783 , @xmath784 , @xmath785 are weak del pezzo surfaces of degree @xmath770 of singularity type @xmath786 , @xmath446 , @xmath787 , @xmath788 respectively .",
    "the number of generators and relations of their cox rings was given in  ( * ? ? ?",
    "* table  6.2 ) .",
    "all other surfaces listed in the table of theorem  [ thm : pic6 ] contain @xmath789-curves with @xmath790 and therefore are not weak del pezzo surfaces .",
    "the cox ring generators occurring in theorem  [ thm : pic6 ] , are either contractible curves on @xmath0 or they define curves in @xmath174 or , in the case of a blown up @xmath757 , in @xmath791 , where their degrees are given as follows ( the contractible ones are indicated by `` @xmath792 '' ) :    [ cols=\"<,<\",options=\"header \" , ]     [ lem : isblowup ] consider setting  [ set : ambmod ] .",
    "assume that @xmath13 is a cemds , @xmath12 arises from a barycentric subdivision of a regular cone @xmath793 and @xmath8 has as center a point @xmath794 .",
    "let @xmath345 be the product over all @xmath67 , where @xmath795 , and choose @xmath796 with @xmath797 .",
    "then @xmath8 is the blow up at @xmath650 provided we have @xmath798_{f}.\\ ] ]    let @xmath799 be the affine chart given by @xmath800 and set @xmath801 .",
    "in order to see that the toric blow up @xmath12 induces a blow up @xmath8 , we have to show @xmath802 consider the quotient map @xmath257 . then we have @xmath803 and , since @xmath800 is regular , @xmath804 admits units in every @xmath110-degree .",
    "this implies @xmath805 consequently , the assumption together with injectivity of the pullback map @xmath806 give the assertion .",
    "the idea is a stepwise classification of the cox rings for all smooth rational surfaces of picard number @xmath807 . for @xmath716 ,",
    "it is possible to list all occurring cox rings up to isomorphism .",
    "see  @xcite for the full list .",
    "we treat exemplarily the surface @xmath808 in the table of the theorem , which is obtained as blow up of a @xmath23-surface @xmath11 with @xmath809 .",
    "the cox ring and degree matrix @xmath312 of @xmath11 are @xmath810/\\ < t_{2}^{a}t_{4}-t_{3}t_{5}t_{6}^{2}-t_{7}t_{8 } \\ > , \\quad \\mbox{\\tiny $ \\left [ \\begin{array}{rrrrrrrr }      1 & 1 & 0 & -a & 0 & 0 & 0 & 0 \\\\",
    "-1 & 0 & -1 & 0 & 1 & 0 & 0 & 0 \\\\      -1 & 0 & -2 & 0 & 0 & 1 & 0 & 0 \\\\      0 & 0 & 1 & 1 & 0 & 0 & 1 & 0 \\\\      -1 & 0 & 1 & 1 & 0 & 0 & 0 & 1      \\end{array }   \\right ]   $ }   .\\ ] ]    the surface @xmath19 is the blow up of @xmath11 in the point with cox coordinates @xmath811 . to compute the cox ring of @xmath19 , we formally apply the steps of algorithm  [ algo : latticeideal ] . in setting  [ set :",
    "stretchcompress ] , we choose the embedding @xmath812 the new degree matrix @xmath315 and the matrix @xmath318 , whose columns are generators for the rays of the fan @xmath593 of the ambient toric variety @xmath267 , are @xmath813    , \\quad    p_1 ' =      \\left [    \\mbox {    \\tiny    $    \\begin{array}{rrrrrrrrr }      1 & a-1 & 0 & 1 & 0 & 0 & 0 & 1 & -1 \\\\      0 & a & 0 & 1 & 0 & 0 & -1 & -1 & 0 \\\\      0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & -1 \\\\      0 & 0 & 0 & 0 & 1 & 1 & -1 & -1 & 1      \\end{array }    $    }    \\right ]    .\\ ] ] to blow up the point on @xmath814 with cox coordinates @xmath815 , we perform the toric modification @xmath816 given by the stellar subdivision @xmath592 at @xmath817 . note that this completes the first threes steps of algorithm  [ algo : latticeideal ] . for the fourth",
    "one , we now formally apply algorithm  [ algo : modifycemds ] .",
    "let @xmath818 $ ] .",
    "the ideal @xmath819 of @xmath820 is generated by @xmath821 we show that @xmath18 is prime ; this implies in particular that @xmath18 is saturated with respect to @xmath822 . on the open subset @xmath823",
    "the jacobian @xmath824 is of rank two and @xmath825 is a subset of the union of the @xmath826-dimensional subspaces @xmath827 all of which have six - dimensional intersection with @xmath820 .",
    "hence , @xmath828 is of codimension at least two in @xmath820 .",
    "furthermore , since the effective cone of @xmath19 is pointed , @xmath820 is connected . by serre",
    "s criterion the ideal @xmath18 is prime , see e.g.  @xcite .",
    "we claim that in @xmath829 , the variable @xmath822 defines a prime element . instead of showing that @xmath830 is prime",
    ", removing non - used variables , we may show this for @xmath831 considered as an ideal in @xmath832 , it is prime since the matrix with the exponents of the binomial generators as its rows @xmath833\\end{aligned}\\ ] ] has smith normal form @xmath834 $ ] , where @xmath835 is the @xmath836 unit matrix .",
    "now , by lemma  [ lem : satprops ] , @xmath837 is prime if @xmath838 . to this end",
    ", the set @xmath839 turns out to be a grbner basis for @xmath837 with respect to the degree reverse lexicographical ordering for any ordering of the variables . by",
    "12.1 ) , we know that @xmath840 is a grbner basis for @xmath841 for any @xmath65 . as in  @xcite , the claim follows from @xmath842    moreover , no two variables @xmath67 , @xmath231 are associated since @xmath843 for all @xmath65 ,  @xmath844 and @xmath845 for all @xmath846 because @xmath847 is at most six for each @xmath65 .",
    "for instance , @xmath848 is of dimension six on @xmath849 since its dimension equals @xmath850 with @xmath851\\ ] ] having the exponents of the binomial equations as its rows .",
    "similarly , on the smaller tori , the dimension is at most six . by theorem  [ thm : ambientblow ] and algorithm  [ algo : modifycemds ]",
    ", @xmath10 is the cox ring of the performed modification .",
    "we claim that we performed the desired blow up .",
    "the ideal @xmath852 is prime since @xmath837 is prime , @xmath853 and , as seen above , @xmath854 by  ( * ? ? ?",
    "7.4 ) , as @xmath286 is free , @xmath855 is prime . this implies @xmath856 .",
    "lemma  [ lem : isblowup ] applies .",
    "the cox ring and degree matrix of @xmath19 are listed in the table under @xmath808 .",
    "note that @xmath19 is not a @xmath23-surface : by the blow up sequence , its graph of negative curves contains the subgraph        where , by the theory of @xmath23-surfaces  @xcite , the curves corresponding to @xmath857 and @xmath858 must correspond to the sink and source of the @xmath23-action . on a @xmath23-surface , sink and source must not meet .",
    "we consider the blow up @xmath0 of a projective space @xmath859 at @xmath669 distinct points @xmath860 , where @xmath861 .",
    "our focus is on special configurations in the sense that the cox ring of @xmath0 is generated by the exceptional divisors and the proper transforms of hyperplanes .",
    "we assume that @xmath862 are the standard toric fixed points , i.e.  we have @xmath863 ,   \\quad \\ldots , \\quad   x_{n+1 } \\",
    "= \\ [ 0 , \\ldots , 0,1].\\ ] ] now , write @xmath864 and let @xmath865 denote the set of all hyperplanes @xmath866 containing @xmath182 ( or more ) points of @xmath867 . for every @xmath868",
    ", we fix a linear form @xmath869 $ ] with @xmath870 .",
    "note that the @xmath871 are homogeneous elements of degree one in the cox ring of @xmath859 .",
    "the idea is now to take all @xmath872 , where @xmath868 , as prospective generators of the cox ring of the blow up @xmath0 and then to compute the cox ring using algorithms  [ algo : stretchcemds ] , [ algo : modifycemds ] and  [ algo : compresscemds ] .",
    "here comes the algorithmic formulation .      *",
    "set @xmath874 , let @xmath333 be the fan of @xmath859 and @xmath310 the matrix with columns @xmath875 , where @xmath876 .",
    "* compute the set @xmath865 of all hyperplanes through any @xmath182 of the points @xmath877 , let @xmath878 be the collection of the @xmath871 different from all @xmath67 .",
    "* compute the stretched cemds @xmath322 by applying algorithm  [ algo : stretchcemds ] to @xmath306 and @xmath878 . *",
    "determine the cox coordinates @xmath879 of the points @xmath880 corresponding to @xmath881 .",
    "* let @xmath398 be the barycentric subdivision of @xmath593 at the cones @xmath882 , corresponding to the toric orbits containing @xmath883 .",
    "write primitive generators for the rays of @xmath398 into a matrix @xmath397 $ ] . *",
    "compute @xmath393 by applying algorithm  [ algo : modifycemds ] to @xmath322 and the pair @xmath416 * set @xmath600 .",
    "eliminate all fake relations by applying algorithm  [ algo : compresscemds ] with option ` verify ` .",
    "call the output @xmath393 .",
    "_ output : _ @xmath393 .",
    "if the verifications in the last step were positive , this is a cemds describing the blow up of @xmath859 at the points @xmath877 ; in particular the @xmath105-graded algebra @xmath10 is the cox ring of  @xmath19 .      in algorithm  [ algo :",
    "lineargen ] , let @xmath885 .",
    "we have @xmath886 since the left hand side is @xmath887-invariant .",
    "equality is achieved by comparing dimensions and the fact that @xmath133 is cut out by @xmath182 hyperplanes .",
    "taking ideals , this implies that @xmath888 equals @xmath889 because the ideals are linear and thus radical .",
    "since @xmath882 is smooth , we may use lemma  [ lem : isblowup ] .    by lemma  [ lem : lingenisblowup ]",
    ", @xmath890 is the blow up at  @xmath891 .",
    "it remains to show that the input ring @xmath892 of the last step is normal ; this is necessary for algorithm  [ algo : compresscemds ] .",
    "we only treat the case @xmath893 .",
    "consider the stretched ring @xmath284 obtained from the third step and the ring @xmath10 obtained after the sixth step @xmath894/\\bangle{g_1 ' } , \\qquad    r_2   \\",
    "\\kk[t_1,\\ldots , t_{r_1'},t_{r_2}]/\\bangle{g_2},\\end{aligned}\\ ] ] where @xmath603 corresponds to the exceptional divisor .",
    "we assume that of the @xmath895 new equations @xmath896 in @xmath897 the last @xmath144 will result in fake relations in @xmath898 .",
    "localizing and passing to degree zero , we are in the situation @xmath899   &   ( r_1)_{t_1\\cdots t_{r_1}f_1\\cdots f_{r_1'-l } }   &   ( r_2)_{t_1\\cdots t_{r_1'-l}t_{r_2 } }    \\\\    \\left (    ( r_1)_{t_1\\cdots t_{r_1 } }    \\right)_0   \\ar[r ]   &   \\ar[u ]   \\ar@{=}[r ]   \\left (   ( r_1)_{t_1\\cdots t_{r_1}f_1\\cdots f_{r_1'-l } }   \\right)_0   &   \\ar[u ]    \\left (   ( r_2)_{t_1\\cdots t_{r_1'-l}t_{r_2 } }    \\right)_0   } \\ ] ] the upper left ring is @xmath110-factorial by assumption . by",
    "1.1 ) the middle ring in the lower row is a ufd and the ring on the upper right is @xmath105-factorial .",
    "thus , @xmath10 is @xmath105-factorial .",
    "since @xmath110 is free , also @xmath105 is , so @xmath10 is a ufd . in particular",
    ", @xmath10 is normal and we may apply algorithm  [ algo : compresscemds ] .      at the end of the fifth step in algorithm  [ algo : lineargen ] , the cox ring of @xmath180 is the polynomial ring @xmath901 $ ] with indices @xmath868 and @xmath902 .",
    "consider the homomorphism @xmath903 \\ \\to \\ \\kk[t_\\ell , s_p;\\,\\ell\\in\\mathcal{l},\\,p\\in\\mathcal{p } ] , \\qquad t_\\ell   \\ \\mapsto \\",
    "t_\\ell \\cdot \\prod_{p\\in \\ell } s_p.\\ ] ] then the extension of the ideal @xmath904 $ ] to the laurent polynomial ring @xmath905 $ ] is generated by @xmath906 , where @xmath907 .",
    "[ rem : linearspace ] some geometric properties of the blow up @xmath0 may be seen directly from the combinatorics of the underlying _ finite linear space _ @xmath908 , compare e.g.  @xcite .",
    "for instance , if @xmath909 is an _",
    ", i.e.  each line @xmath910 contains exactly @xmath182 points , the ideal of the cox ring of @xmath0 is classically homogeneous",
    ". furthermore , for a surface @xmath0 , if all points but one lie on a common line , i.e.  @xmath909 is a _ near - pencil _ , then @xmath0 comes with a @xmath23-action .",
    "it would be interesting to see further relations between @xmath0 and  @xmath909 .",
    "write @xmath912 for the variables corresponding to @xmath133 and let @xmath913 correspond to the nine lines in @xmath865 .",
    "algorithm  [ algo : lineargen ] provides us with the cox ring of @xmath0 . it is given as the factor ring @xmath914/i$ ] where @xmath438 is generated by @xmath915 and the @xmath916-grading is given by the degree matrix @xmath917 .",
    "\\end{aligned}\\ ] ]    the following theorem concerns blow ups of @xmath29 in six points @xmath918 . as before , we assume that @xmath919 are the standard toric fixed points .",
    "we call the point configuration _ edge - special _ if at least one point of @xmath920 is contained in two different hyperplanes spanned by the other points .",
    "[ thm : pp3 ] let @xmath0 be the blow up of @xmath921 at distinct points",
    "@xmath922 not contained in a hyperplane .",
    "then @xmath0 is a mori dream space .",
    "moreover , for the following typical edge - special configurations , we obtain :      + @xmath926 + with the @xmath927-grading given by the degree matrix @xmath928.\\end{aligned}\\ ] ] 2 .   for @xmath929 $ ] ,",
    "@xmath930 $ ] , the cox ring of @xmath0 is @xmath931/i$ ] , where @xmath438 is generated by +            let @xmath0 be the blow up of @xmath921 at six non - coplanar points @xmath922 .",
    "denote by @xmath43 the total transform of a plane of @xmath921 and by @xmath946 the exceptional divisor over @xmath133 .",
    "denote by @xmath947 and by @xmath948 , the last being the strict transform of the quadric cone with vertex in @xmath133 and through the remaining five @xmath949 .",
    "we consider five possibilities for @xmath0 according to the collinear subsets of @xmath950 , modulo permutations of the indices .",
    "the meaning of the divisor @xmath951 in the second column of the table will be explained in the proof of theorem  [ thm : pp3 ] .",
    "[ base ] let @xmath0 be a smooth projective variety , let @xmath373 be an effective divisor of @xmath0 and let @xmath136 be an irreducible and reduced curve of @xmath0 such that @xmath961 . then @xmath136 is contained in the stable base locus of @xmath962 .",
    "[ mori ] let @xmath0 be the blow up of @xmath921 at six non - coplanar points @xmath922",
    ". denote by @xmath964 with @xmath965 the class of the strict transform of the line through the points @xmath966 , if @xmath967 , or the class of a line in the exceptional divisor @xmath946 over @xmath133 , if @xmath968 .",
    "then the mori cone of @xmath0 is @xmath969    we consider five cases for @xmath0 according to the collinear subsets of @xmath950 . in each case",
    "we denote by @xmath970 be the cone spanned by the classes of the @xmath964 defined in the statement .",
    "recall that , via the intersection form between divisors and curves , the nef cone @xmath971 is dual to the closure of the mori cone @xmath972  ( * ? ? ?",
    "* proposition 1.4.28 ) .",
    "hence @xmath973 gives @xmath974 .",
    "thus , it is enough to show that each extremal ray of @xmath975 is a nef class .",
    "a direct calculation shows that the primitive generator @xmath54 of an extremal ray is the strict transform of one of the following divisors ( here , by `` points '' we mean a subset of @xmath950 ) :      in each case , @xmath54 is the class of a divisor @xmath976 , where @xmath977 is a collinear subset for any @xmath978 , where @xmath979 is a finite set of indices .",
    "hence the base locus of @xmath962 is contained in the union of the strict transforms of the lines spanned by each subset @xmath980 .",
    "again , a direct calculation shows that @xmath981 for any @xmath978 and thus @xmath373 is nef by lemma  [ base ] .",
    "we prove the first statement .",
    "the anticanonical divisor @xmath444 of @xmath0 is big and movable since @xmath982 , where @xmath983 is the strict transform of a quadric through the six points .",
    "hence , @xmath0 is mori dream if and only if it is log fano by  ( * ? ? ?",
    "* lemma 4.10 ) .",
    "we will prove that @xmath0 is log fano by showing that @xmath984 where both @xmath211 and @xmath951 are @xmath985-divisors , @xmath211 is nef and big , @xmath951 is effective , its support is simple normal crossing and @xmath986 . in the above table we provide @xmath951 in each case .",
    "the ampleness of @xmath211 is a direct consequence of our description of the mori cone of @xmath0 given in proposition  [ mori ] .",
    "the second part of the theorem is an application of algorithm  [ algo : lineargen ] .",
    "alekseev , v.v  nikulin : _ classification of log del pezzo surfaces of index @xmath987_. memoirs of the mathematical society of japan , vol .",
    "15 ( 2006 ) , preprint version arxiv : math.ag/0406536 .",
    "m.  artebani , a.  garbagnati , a.  laface : _ cox rings of extremal rational elliptic surfaces_. to appear in transactions of the ams .",
    "preprint , arxiv:1302.4361 .",
    "arzhantsev : _ on the factoriality of cox rings_. mat .",
    "zametki 85 ( 2009 ) , 5 , 643651 .",
    "i.  arzhantsev , u.  derenthal , j.  hausen , a.  laface : _",
    "cox rings_. cambridge sudies in advanced mathematics 144 , cambridge university press , cambridge , 2014 .",
    "see also arxiv:1003.4229 .",
    "h.  bker , j.  hausen , s.  keicher : _ chow quotients of torus actions_. preprint , arxiv:1203.3759 . l.m .",
    "batten , a.  beutelspacher : _ the theory of finite linear spaces_. cambridge university press , cambridge , 1993 .",
    "v.  batyrev , o.  popov : _ the cox ring of a del pezzo surface _",
    "arithmetic of higher - dimensional algebraic varieties ( palo alto , ca , 2002 ) , 85103 , progr .",
    ", 226 , birkhuser boston , boston , ma , 2004 .",
    "b.  bechtold : _ factorially graded rings and cox rings_. j. algebra 369 ( 2012 ) , 351359 .",
    "f.  berchtold , j.  hausen : _ homogeneous coordinates for algebraic varieties_. j. algebra 266 ( 2003 ) , 636670 . c.  bertone : _ modular absolute decomposition of equidimensional polynomial ideals_. preprint , arxiv:1012.5210 .",
    "w.  bosma , j.  cannon , c.  playoust : _ the magma algebra system .",
    "i. the user language_. j. symbolic comput . 24",
    "( 1997 ) , no . 3 - 4 , 235265 .",
    "r.  de  la  bretche , t.d .",
    "browning , u.  derenthal : _ on manin s conjecture for a certain singular cubic surface _ ann .",
    "sci . cole norm .",
    "( 4 ) 40 ( 2007 ) , no .",
    "castravet , j.  tevelev : _",
    "hilbert s 14th problem and cox rings_. compos .",
    "142 ( 2006 ) , no . 6 ,",
    "g.  chze , g.  lecerf : _ lifting and recombination techniques for absolute factorization_. j. complexity 23 ( 2007 ) , no .",
    "3 , 380420 . j .-",
    "colliot - thlne , j .- j .",
    "sansuc : _ torseurs sous des groupes de type multiplicatif ; applications  ltude des points rationnels de certaines varits algbriques _ c. r. acad .",
    "paris sr .",
    "a - b  282 ( 1976 ) , no .",
    "18 , aii , a1113a1116 .",
    "colliot - thlne , j .- j .",
    "sansuc : _ la descente sur une varit rationnelle dfinie sur un corps de nombres _ c. r. acad .",
    "paris sr .",
    "a - b  284 ( 1977 ) , no .",
    "19 , a1215a1218 .",
    "cox : _ the homogeneous coordinate ring of a toric variety_. j. algebraic geom . 4 ( 1995 ) , no .",
    "1 , 1750 . w.  decker , g .-",
    "m .  greuel , g.  pfister , h.  schnemann : _ singular 3 - 1 - 6  a computer algebra system for polynomial computations_. 2012 .",
    "available at http://www.singular.uni-kl.de u.  derenthal : _ singular del pezzo surfaces whose universal torsors are hypersurfaces_. proc .",
    "( 3 ) 108 ( 2014 ) , no .",
    "3 , 638681 .",
    "u.  derenthal : _ geometry of universal torsors_. phd thesis .",
    "universitt gttingen , 2006 .",
    "a.  gibney , d.  maclagan : _ equations for chow and hilbert quotients_. algebra number theory 4 ( 2010 ) ,",
    "7 , 855885 .",
    "d.  grayson , m.  stillman : _",
    "macaulay2 , a software system for research in algebraic geometry_. available at http://www.math.uiuc.edu/macaulay2/ g .-",
    "greuel , g.  pfister : _ a singular introduction to commutative algebra_. second edition .",
    "springer , berlin , 2008 a.  grothendieck : _ elments de gomtrie algbrique .",
    "tude globale lmentaire de quelques classes de morphismes_. inst .",
    "hautes tudes sci .",
    "8 , 1961 b.  hassett , y.  tschinkel : _ universal torsors and cox rings_. arithmetic of higher - dimensional algebraic varieties ( palo alto , ca , 2002 ) , 149173 , progr .",
    ", 226 , birkhuser boston , boston , ma , 2004 . j.  hausen : _ cox rings and combinatorics ii_. mosc . math . j. 8 ( 2008 ) , no .",
    "4 , 711757 , 847 .",
    "j.  hausen : _ three lectures on cox rings_. in : torsors , tale homotopy and applications to rational points .",
    "london mathematical society lecture note series 405 , 360 , 2013 .",
    "j.  hausen , h.  s : _ the cox ring of an algebraic variety with torus action_. adv .",
    "( 2010 ) , 9771012 .",
    "e.  huggenberger : _ fano varieties with torus action of complexity one_. phd thesis .",
    "universitt tbingen , 2013 , http://nbn-resolving.de/urn:nbn:de:bsz:21-opus-69570 . y.  hu , s.  keel : _ mori dream spaces and git_. dedicated to william fulton on the occasion of his 60th birthday .",
    "michigan math .",
    "j. 48 ( 2000 ) , 331348 .",
    "a.  jensen : _ algorithmic aspects of grbner fans and tropical varieties_. phd thesis , university of aarhus , 2007 .",
    "h.  kraft : _ geometrische methoden in der invariantentheorie_. aspects of mathematics , d1 .",
    "vieweg & sohn , braunschweig , 1984 .",
    "s.  keicher : _ algorithms for mori dream spaces_. phd thesis , universitt tbingen , 2014 , http://nbn-resolving.de/urn:nbn:de:bsz:21-dspace-540614 .",
    "r.  koelman : _ the number of moduli of families of curves on toric surfaces_. thesis , univ .",
    "nijmegen , 1991 .",
    "r.  lazarsfeld : _ positivity in algebraic geometry i_. ergebnisse der mathematik und ihrer grenzgebiete .",
    "3 . folge . a series of modern surveys in mathematics , 48 .",
    "springer - verlag , berlin , 2004 .",
    "_ maple 10_. maplesoft , a division of waterloo maple inc . ,",
    "waterloo , ontario .",
    "see http://www.maplesoft.com/ k.  matsuki .",
    "_ introduction to the mori program_. universitext .",
    "springer - verlag , new york , 2002 .",
    "j.  mckernan : _ mori dream spaces_. jpn .",
    "j. math . 5 ( 2010 ) , no .",
    "1 , 127151 .",
    "e.  miller , b.  sturmfels : _ combinatorial commutative algebra_. graduate texts in mathematics , 227 .",
    "springer - verlag , new york , 2005 .",
    "s.  okawa : _ on images of mori dream spaces_. preprint , arxiv:1104.1326 .",
    "p.  orlik , p.  wagreich : _ algebraic surfaces with @xmath988-action _ , acta math .",
    "138 ( 1977 ) , no .",
    "12 , 4381 .",
    "a.  sommese , j.  verschelde , c.  wampler : _ numerical decomposition of the solution sets of polynomial systems into irreducible components .",
    "_ siam j. numer .",
    "38 ( 2001 ) , no . 6 , 20222046 .",
    "m.  stillman , d.  testa , m.  velasco : grbner bases , monomial group actions , and the cox rings of del pezzo surfaces .",
    "j. algebra 316 ( 2007 ) , no .",
    "2 , 777801 .",
    "b.  sturmfels : _ grbner bases and convex polytopes_. university lecture series , 8 .",
    "american mathematical society , providence , ri , 1996 .",
    "b.  sturmfels , m.  velasco : _ blow - ups of @xmath989 at @xmath182 points and spinor varieties_. j. commut .",
    "algebra 2 ( 2010 ) , no .",
    "2 , 223244 .",
    "b.  sturmfels , z.  xu : _ sagbi bases of cox - nagata rings_. j. eur . math .",
    "( jems ) 12 ( 2010 ) , no .",
    "2 , 429459 ."
  ],
  "abstract_text": [
    "<S> we consider modifications , for example blow ups , of mori dream spaces and provide algorithms for investigating the effect on the cox ring , for example verifying finite generation or computing an explicit presentation in terms of generators and relations . as a first application </S>",
    "<S> , we compute the cox rings of all gorenstein log del pezzo surfaces of picard number one . </S>",
    "<S> moreover , we show computationally that all smooth rational surfaces of picard number at most six are mori dream surfaces and we provide explicit presentations of the cox ring for those not admitting a torus action . </S>",
    "<S> finally , we provide the cox rings of projective spaces blown up at certain special point configurations . </S>"
  ]
}