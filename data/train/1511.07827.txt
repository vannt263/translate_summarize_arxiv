{
  "article_text": [
    "the central question addressed by functional neuroimaging is to elucidate the inter - relation between cognition and the brain . in a typical functional magnetic resonance imaging ( fmri )",
    "experiment , a neuroscientist selects a task that is associated with a particular cognitive process , and studies the brain regions that elicit a response @xcite .",
    "however , it is well documented that the same brain region can be activated by inherently different tasks ( e.g. , the superior temporal sulcus has been termed the `` chameleon of the brain '' @xcite ) , thus undermining the standard approach . to date , there is no approach available that systematically investigates how many different tasks activate the same brain region or network of regions .",
    "gaining insights into the complex relationship between the brain and cognition though requires a more thorough investigation of this mapping .    in order to address this concern ,",
    "the _ automatic neuroscientist _",
    "@xcite has recently been proposed .",
    "this framework turns the conventional fmri approach on its head by using real - time fmri @xcite in combination with a state - of - the - art bayesian optimization technique @xcite to systematically unveil the relationship between different tasks and their neural responses within an individual . in a nutshell ,",
    "the framework starts with a target brain pattern and automatically finds a set of tasks that maximally activates it .",
    "this is done using a brain - machine interface : the subject s brain pattern is analyzed in real - time in response to the current task .",
    "based on this , the bayesian optimization algorithm proposes a task that will be presented to the subject in the next iteration .",
    "this closed - loop cycle continues until the optimal task is found .    while the _",
    "automatic neuroscientist _ was validated in a proof - of - principal study involving five subjects @xcite , there remains several open questions .",
    "in particular , in this work we focus on the need to define a stopping criterion . due to expensive scanning time as well as the limited attentional capacity of subjects",
    "it is imperative to devise formal stopping criteria . while there has been an extensive focus on online learning in the context of bayesian optimization ( e.g. , minimizing cumulative regret @xcite ) , there are limited results relating to online stopping . in this work",
    "we propose two stopping criteria and provide an empirical evaluation of their performance using data collected in the experiments of @xcite .",
    "we begin by providing an overview of the study presented in lorenz et al .",
    "@xcite in section [ overview ] and a brief description of the bayesian optimization technique in section [ fixitsec ] .",
    "the proposed stopping criteria are introduced and discussed in section [ stopsection ] .",
    "five healthy subjects ( 2 females , mean age @xmath0 sd : 26.8 @xmath0 3.6 years ) participated in the study of lorenz et al . @xcite .",
    "two target brain regions were identified based on previous literature @xcite : bilateral lateral occipital cortex and bilateral superior temporal cortex .",
    "the target brain pattern was defined as the maximum difference in brain activation between those regions ( i.e. , maximized occipital cortex activity with minimum superior temporal cortex activity ) .",
    "visual and auditory stimuli were selected that have been shown to strongly activate those regions @xcite .",
    "those stimuli were then systematically corrupted to span an experimental parameter space consisting of 361 different combinations of audio - visual stimuli ( see figure  [ fig : grid ] ) . for both , visual and auditory dimensions , stimuli varied in their perceptual complexity from no visual / auditory input to video footage / a sentence spoken by a human voice in 19 discrete steps , respectively . in the online experiment , incoming whole - brain images ( siemens verio 3 t , tr = 2 sec ) were pre - processed ( i.e. , motion - corrected and spatially smoothed ) in real - time .",
    "extracted timecourses of the target regions were further cleaned by removing low - frequency signal drifts as well as large signal spikes @xcite .",
    "after each audio - visual stimulus presented to the subject , the difference in brain level activation between the two regions was calculated in real - time using a general linear model approach .",
    "the result of this was then fed into the bayesian optimization algorithm as loss function .",
    "see lorenz et al .",
    "@xcite for further details .          the underlying intuition behind the method of lorenz et al .",
    "@xcite is that the target brain pattern is a function of auditory and visual stimulus parameters . as such",
    ", the authors propose to learn the relationship by modeling the observed brain activation as a sample from a gaussian process ( gp ) .",
    "this facilitates the use of a bayesian optimization framework @xcite to iteratively infer the combination of audio - visual stimuli which maximizes the target activation .",
    "bayesian optimization algorithms are appealing due to their computational and mathematical simplicity .",
    "they are particularly relevant in the scenario of real - time fmri as the aim is to optimize an unknown objective for which we do not have an analytical expression nor can we make formal statements regarding their properties ( e.g. , convexity ) ; thus precluding traditional optimization techniques .    the bayesian optimization algorithm proposed by lorenz et al .",
    "@xcite is an iterative scheme where subjects are presented with a stimulus and their brain activation is measured .",
    "this activation is subsequently employed to update our belief regarding the relationship between the stimuli and target brain activation , captured in the posterior distribution of the gp @xcite .",
    "the posterior distribution is subsequently employed to propose a new stimulus combination via the use of an acquisition function @xcite .",
    "the choice of acquisition function represents a trade - off between exploration of the stimuli space and exploitation .",
    "an advantage of employing a gp prior is that many acquisitions functions depend solely on the prediction mean , @xmath1 , and variance function , @xmath2 , of the model . throughout this work ,",
    "we follow @xcite and employ the expected improvement ( ei ) acquisition function @xcite : @xmath3 where @xmath4 and @xmath5 are the cumulative and probability density functions for a standard gaussian random variable and we define @xmath6 . at each iteration , a new candidate is selected as @xmath7 .",
    "the use of a gp prior requires the specification of a mean and covariance function .",
    "as the objective of this work is to study the results of @xcite in the context of stopping criteria , we select the same parameters as employed in the initial study . formally , a trivial zero - mean covariance , @xmath8 , was employed together with a squared exponential covariance with automatic relevance discarding @xcite .",
    "this required the specification of three hyper - parameters ( two length - scale parameters and a noise parameter ) .",
    "the choice of these parameters is crucial to the success of bayesian optimization methods and several sophisticated techniques have been proposed to select them @xcite . in this work",
    "the hyper - parameters were selected via type-2 maximum likelihood on independent datasets @xcite .      within the bayesian optimization literature the focus has traditionally been on online learning @xcite . as a result , there is limited work studying stopping criteria which are particularly relevant in our scenario . in this section",
    "we propose two stopping criteria and study their performance empirically .",
    "the first stopping criterion is based on the euclidean distance between consecutive proposed audio - visual stimuli combinations .",
    "the second approach exploits the wealth of information in the gp posterior to provide a more formal stopping criterion .",
    "this approach looks to establish a stopping criterion by combining two popular acquisition functions as we discuss below .",
    "as mentioned previously , the ei acquisition function @xcite is employed throughout this work .",
    "the ei acquisition function effectively looks to sample candidate stimuli that have a high posterior variance in the gp model , thereby favoring exploration in the face of uncertainty .",
    "this is in contrast to the probability of improvement ( pi ) acquisition @xcite which is purely exploitative .",
    "the intuition behind this first stopping criterion is that when points within a similar region are consistently proposed , then it may be the case that the bayesian optimization algorithm has entered a purely exploitative phase .",
    "while such a phase is desirable in many applications , the primary objective of bayesian optimization within the context of real - time fmri is to efficiently explore the set of potential stimuli and reliably learn the relationship with observed brain activation . as such , once we enter a purely exploitative phase it may be the case that a sufficiently accurate model has been learnt .",
    "our proposed stopping criterion is as follows : at each iteration , we calculate the euclidean distance ( ed ) between the point of the most recent observation and the proposed stimulus to be presented in the next iteration .",
    "once this falls below a certain threshold , the resulting bayesian optimization algorithm is terminated .",
    "a clear shortcoming of such a stopping criterion is that it can not handle multimodal functions .",
    "in such a scenario it could be possible that each of the peaks is sampled iteratively , resulting in an experiment that is never terminated .",
    "another shortcoming is the need to specify a threshold for the ed which in practice is non - trivial and difficult to interpret . in order to address these two issues",
    "we propose a second stopping criterion .      in order to address the shortcomings of the aforementioned approach",
    "we propose a criterion based upon a hybrid of the ei and pi acquisition functions .",
    "hybrids of acquisition functions have been studied in @xcite , however the motivation there was to improve sampling by proposing a portfolio of acquisition functions .",
    "in contrast , our interest here is to combine two popular acquisition functions in order to obtain an intuitive and effective stopping criterion .    an advantage of both the pi and ei acquisition functions are that they are easily interpretable . in particular",
    ", the pi is a measure of the probability of observing an improvement in the latent objective function .",
    "moreover , for a candidate stimuli , @xmath9 , the pi acquisition function resembles a traditional @xmath10-test with the pivotal quantity @xmath11 where @xmath12 is the maximum observed activation @xcite . as a result , calculating the pi is akin to calculating the @xmath13-value for the hypothesis test associated with the null @xmath14 .",
    "based on this observation , we propose a stopping criteria by calculating the pi of each new candidate point , @xmath15 , proposed by the ei acquisition function .",
    "formally , we propose to terminate the bayesian optimization algorithm when @xmath16 , where @xmath17 is the significance level .",
    "the resulting stopping criterion requires one input parameter which can be interpreted as the probability of type 1 error ( or of incorrectly terminating the algorithm ) .",
    "the performance of the proposed stopping criteria was studied empirically using data from the original bayesian optimization study @xcite .",
    "data from the initial two runs for each of the five subjects was studied ( sub04 only underwent one run ) . in the interest of clarity , we plot the proposed stopping criteria for two subjects in figure  [ fig : results ] .",
    "we note that both proposed online stopping criteria seem suitable . in the majority of the runs",
    ", ed went to zero indicating that the same stimulus is proposed by the ei acquisition function over multiple iterations .",
    "for all of those runs , the pi at those points was consistently below @xmath18 , suggesting that the experiment was run for a sufficiently long time . in order to infer the accuracy of our model predictions we also computed the euclidean distance between the predicted optimum and the hypothezised optimum at each iteration ( thin black line in figure  [ fig : results ] ) .",
    "we found that accuracy would have not been impaired when stopping those runs earlier .",
    "in contrast , for three runs ed stayed above zero , indicating that for those runs a longer imaging acquisition might have been advantageous for making more accurate predictions .",
    "this can be inferred for example from run2 of sub01 in which the accuracy at the last iteration is worse ( i.e. , euclidean distance between predicted and hypothesized optimum is higher ) than for the first run .",
    "we present and empirically validate two stopping criteria for bayesian optimization methods .",
    "the motivation behind this work was the use of such techniques in conjunction with real - time fmri methods to provide a more holistic understanding of how cognition and the brain inter - relate .",
    "our work is closely related and complementary to the recently proposed _",
    "automatic neuroscientist _ framework by lorenz et al .",
    "@xcite where stopping criteria are required due to the expense of scanning and limited subject attention .    the first criterion proposed is simply based on the euclidean distance between successive samples . while such an approach has clear shortcomings , it is shown to perform relatively well in the audio - visual task studied in this work .",
    "we believe this may be due to the clear unimodal nature of the response function and we would expect such a stopping criterion to perform poorly when faced with multimodal responses .",
    "the second criterion we propose is based upon a hybrid of acquisition functions . in this manner",
    ", new candidate stimuli can be proposed via the ei acquisition function and the bayesian optimization algorithm is terminated when the pi of corresponding stimuli falls below a threshold @xmath17 .",
    "the advantage of such an approach is that @xmath17 can be directly interpreted as the significance level in a traditional hypothesis test .",
    "an area for future work of such a stopping criteria would involve correcting for multiple comparisons , however this is challenging when the number of comparisons is unknown a priori .",
    "moreover , our results display clear inter - subject and inter - run variability .",
    "while for the majority of runs scanning time could have been potentially reduced by up to seven observations ( corresponding to approximately 2/3 minutes ) , for others , our stopping criteria indicated that further observations would have been required .",
    "moreover , we find that employing the proposed stopping criteria would not affect the accuracy of the model predictions .",
    "the _ automatic neuroscientist _ has direct clinical relevance , since it can be extended to any desirable target brain pattern , including fmri biomarkers relevant to clinical populations ( e.g. , a specific functional connectivity network configuration tracked in real - time @xcite ) . in this respect ,",
    "the development of online stopping criteria is of paramount importance for the framework to be pulled through the translational pathway .",
    "various neurological and psychiatric disorders are characterized by impaired sustained attention , such as attention deficit disorder @xcite , traumatic brain injury @xcite , or bipolar disorder @xcite .",
    "in addition , children and the elderly only have limited attentional capacities .",
    "lorenz , r. , monti , r.p . ,",
    "violante , i.r . ,",
    "anagnostopoulos , c. , faisal , a.a . , montana , g. , leech , r. : the automatic neuroscientist : a framework for optimizing experimental design with closed - loop real - time fmri .",
    "neuroimage , _ in press _",
    ", doi : 10.1016/j.neuroimage.2016.01.032 ( 2016 )      brochu , e. , cora , v.m . , de freitas , n. : a tutorial on bayesian optimization of expensive cost functions , with application to active user modeling and hierarchical reinforcement learning .",
    "arxiv:1012.2599 ( 2010 )        hoffman , m.d .",
    ", shahriari , b . ,",
    "de freitas , n. : on correlation and budget constraints in model - based bandit optimization with application to automatic machine learning .",
    "proc . of the 17th int conf on artificial intelligence and statistics ( aistats ) ( 2014 )          brochu , e. , brochu , t. , de freitas , n. : a bayesian interactive optimization approach to procedural animation design .",
    "proceedings of the 2010 acm siggraph / eurographics symposium on computer animation .",
    "eurographics association.(2010 ) .",
    "monti , r.p . ,",
    "hellyer , p and sharp , d. and leech , r. and anagnostopoulos , c. and montana , g. : estimating time - varying brain connectivity networks from functional mri time series .",
    "neuroimage , 103 , 427443 ( 2014 )    monti , r.p . ,",
    "lorenz , r. , anagnostopoulos , c. , leech , r. , montana , g. : measuring the functional connectome `` on - the - fly '' : towards a new control signal for fmri - based brain - computer interfaces .",
    "arxiv:1502.02309 ( 2015 )    stins , j.f . ,",
    "tollenaar , m.s . , slaats - willemse , d.i.e . ,",
    "buitelaar , j.k . , swaab - barneveld , h. , verhulst , f.c . ,",
    "polderman , t.c . ,",
    "boomsma , d.i . : sustained attention and executive functioning performance in attention - deficit / hyperactivity disorder , child neuropsychology , 11(3 ) , 285294 ( 2005 )"
  ],
  "abstract_text": [
    "<S> bayesian optimization has been proposed as a practical and efficient tool through which to tune parameters in many difficult settings . </S>",
    "<S> recently , such techniques have been combined with real - time fmri to propose a novel framework which turns on its head the conventional functional neuroimaging approach . </S>",
    "<S> this closed - loop method automatically designs the optimal experiment to evoke a desired target brain pattern . </S>",
    "<S> one of the challenges associated with extending such methods to real - time brain imaging is the need for adequate stopping criteria , an aspect of bayesian optimization which has received limited attention . in light of high scanning costs and limited attentional capacities of subjects an accurate and reliable stopping criteria </S>",
    "<S> is essential . in order to address this issue </S>",
    "<S> we propose and empirically study the performance of two stopping criteria . </S>"
  ]
}