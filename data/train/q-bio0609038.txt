{
  "article_text": [
    "a major obstacle to phylogenetic inference is the heterogeneity of genomic data .",
    "for example , mutation rates vary widely between genes , resulting in different branch lengths in the phylogenetic tree for each gene . in many cases ,",
    "even the topology of the tree differs between genes . within a single long gene , we are also likely to see variations in the mutation rate , see @xcite for a current study on regional mutation rate variation .",
    "our focus is on phylogenetic inference based on single nucleotide substitutions . in this paper",
    "we study the effect of mutation rate variation on phylogenetic inference",
    ". the exact mechanisms of single nucleotide substitutions are still being studied , hence the causes of variations in the rate of these mutations are unresolved , see @xcite . in this paper",
    "we study phylogenetic inference in the presence of heterogeneous data .    for homogenous data , i.e. , data generated from a single phylogenetic tree ,",
    "there is considerable work on consistency of various methods , such as likelihood @xcite and distance methods , and inconsistency of other methods , such as parsimony @xcite .",
    "consistency means that the methods converge to the correct tree with sufficiently large amounts of data .",
    "we refer the interested reader to felsenstein @xcite for an introduction to these phylogenetic approaches .",
    "there are several works showing the pitfalls of popular phylogenetic methods when data is generated from a mixture of trees , as opposed to a single tree .",
    "we review these works in detail shortly .",
    "the effect of mixture distributions has been of marked interest recently in the biological community , for instance , see the recent publications of kolczkowski and thornton @xcite , and mossel and vigoda @xcite .    in our setting the data",
    "is generated from a mixture of trees which have a common tree topology , but can vary arbitrarily in their mutation rates .",
    "we address whether it is possible to infer the tree topology .",
    "we introduce the notion of a _",
    "linear test_. for any mutational model whose transition probabilities can be parameterized by an open set ( see the following subsection for a precise definition ) , we prove that the topology can be reconstructed by linear tests , or it is impossible in general due to a non - identifiable mixture distribution . for several of the popular mutational models we determine which of the two scenarios ( reconstruction or non - identifiability ) hold .",
    "the notion of a linear test is closely related to the notion of linear invariants .",
    "in fact , lake s invariants are a linear test .",
    "there are simple examples where linear tests exist and linear invariants do not ( in these examples , the mutation rates are restricted to some range ) . however , for the popular mutation models , such as jukes - cantor and kimura s 2 parameter model ( both of which are closed under multiplication ) we have no such examples . for the jukes - cantor and kimura s 2 parameter model , we prove the linear tests are essentially unique ( up to certain symmetries ) .",
    "in contrast to the study of invariants , which is natural from an algebraic geometry perspective , our work is based on convex programming duality .",
    "we present the background material before formally stating our new results .",
    "we then give a detailed comparison of our results with related previous work .",
    "an announcement of the main results of this paper , along with some applications of the technical tools presented here , are presented in @xcite .",
    "a phylogenetic tree is an unrooted tree @xmath0 on @xmath1 leaves ( called taxa , corresponding to @xmath1 species ) where internal vertices have degree three .",
    "let @xmath2 denote the edges of @xmath0 and @xmath3 denote the vertices .",
    "the mutations along edges of @xmath0 occur according to a continuous - time markov chain .",
    "let @xmath4 denote the states of the model .",
    "the case @xmath5 is biologically important , whereas @xmath6 is mathematically convenient .",
    "the model is defined by a phylogenetic tree @xmath0 and a distribution @xmath7 on @xmath4 .",
    "every edge @xmath8 has an associated @xmath9 rate matrix @xmath10 , which is reversible with respect to @xmath7 , and a time @xmath11 .",
    "note , since @xmath10 is reversible with respect to @xmath7 , then @xmath7 is the stationary vector for @xmath10 ( i.e. , @xmath12 ) .",
    "the rate matrix defines a continuous time markov chain .",
    "then , @xmath10 and @xmath11 define a transition matrix @xmath13 .",
    "the matrix is a stochastic matrix of size @xmath14 , and thus defines a discrete - time markov chain , which is time - reversible , with stationary distribution @xmath7 ( i.e. , @xmath15 ) .",
    "given @xmath16 we then define the following distribution on labellings of the vertices of @xmath0 .",
    "we first orient the edges of @xmath0 away from an arbitrarily chosen root @xmath17 of the tree .",
    "( we can choose the root arbitrarily since each @xmath18 is reversible with respect to @xmath7 . ) then , the probability of a labeling @xmath19 is @xmath20    let @xmath21 be the marginal distribution of @xmath22 on the labelings of the leaves of @xmath0 ( @xmath21 is a distribution on @xmath23 where @xmath1 is the number of leaves of @xmath0 ) . the goal of phylogeny reconstruction is to reconstruct @xmath0 ( and possibly @xmath24 ) from @xmath21 ( more precisely , from independent samples from @xmath21 ) .",
    "the simplest four - state model has a single parameter @xmath25 for the off - diagonal entries of the rate matrix .",
    "this model is known as the jukes - cantor model , which we denote as jc .",
    "allowing 2 parameters in the rate matrix is kimura s 2 parameter model which we denote as k2 , see section [ sec : k2 ] for a formal definition .",
    "the k2 model accounts for the higher mutation rate of transitions ( mutations within purines or pyrimidines ) compared to transversions ( mutations between a purine and a pyrimidine ) .",
    "kimura s 3 parameter model , which we refer to as k3 accounts for the number of hydrogen bonds altered by the mutation .",
    "see section [ sec : k3 ] for a formal definition of the k3 model . for @xmath6 ,",
    "the model is binary and the rate matrix has a single parameter @xmath25 .",
    "this model is known as the cfn ( cavender - farris - neyman ) model . for any examples in this paper involving the cfn , jc , k2 or k3 models ,",
    "we restrict the model to rate matrices where all the entries are positive , and times @xmath11 which are positive and finite .    we will use @xmath26 to denote the set of transition matrices obtainable by the model under consideration , i.e. , @xmath27 the above setup allows additional restrictions in the model , such as requiring @xmath28 which is commonly required .    in our framework",
    ", a model is specified by a set @xmath26 , and then each edge is allowed any transition matrix @xmath29 .",
    "we refer to this framework as the _ unrestricted framework _ , since we are not imposing any dependencies on the choice of transition matrices between edges . this set - up is convenient since it gives a natural algebraic framework for the model as we will see in some later proofs .",
    "a similar set - up was required in the work of allman and rhodes @xcite , also to utilize the algebraic framework .",
    "an alternative framework ( which is typical in practical works ) requires a common rate matrix for all edges , specifically @xmath30 for all @xmath8 .",
    "note we can not impose such a restriction in our unrestricted framework , since each edge is allowed any matrix in @xmath26 .",
    "we will refer to this framework as the _ common rate framework_. note , for the jukes - cantor and cfn models , the unrestricted and common rate frameworks are identical , since there is only a single parameter for each edge in these models .",
    "we will discuss how our results apply to the common rate framework when relevant , but the default setting of our results is the unrestricted model .    returning to our setting of the unrestricted framework , recall under the condition @xmath28 the set @xmath26 is not a compact set ( and is parameterized by an open set as described shortly ) .",
    "this will be important for our work since our main result will only apply to models where @xmath26 is an open set .",
    "moreover we will require that @xmath26 consists of multi - linear polynomials .",
    "more precisely , a polynomial @xmath31 $ ] is _ multi - linear _",
    "if for each variable @xmath32 the degree of @xmath33 in @xmath32 is at most @xmath34 .",
    "our general results will apply when the model is a set of multi - linear polynomials which are parameterized by an open set which we now define precisely .",
    "we say that a set @xmath26 of transition matrices is _",
    "parameterized by an open set _ if there exists a finite set @xmath4 , a distribution @xmath7 over @xmath4 , an integer @xmath35 , an open set @xmath36 , and multi - linear polynomials @xmath37 $ ] such that @xmath38 where @xmath26 is a set of stochastic matrices which are reversible with respect to @xmath7 ( thus @xmath7 is their stationary distribution ) .",
    "typically the polynomials @xmath39 are defined by an appropriate change of variables from the variables defining the rate matrices .",
    "some examples of models that are paraemeterized by an open set are the general markov model considered by allman and rhodes @xcite ; jukes - cantor , kimura s 2-parameter and 3-parameter , and tamura - nei models . for the tamura - nei model ( which is a generalization of jukes - cantor and kimura s models )",
    "we show in @xcite how the model can be re - parameterized in a straightforward manner so that it consists of multi - linear polynomials , and thus fits the parameterized by an open set condition ( assuming the additional restriction @xmath28 ) .      in our setting",
    ", we will generate assignments from a mixture distribution .",
    "we will have a single tree topology @xmath0 , a collection of @xmath40 sets of transition matrices @xmath41 where @xmath42 and a set of non - negative reals @xmath43 where @xmath44 .",
    "we then consider the mixture distribution : @xmath45 thus , with probability @xmath46 we generate a sample according to @xmath47 .",
    "note the tree topology is the same for all the distributions in the mixture ( thus there is a notion of a generating topology ) .",
    "in several of our simple examples we will set @xmath48 and @xmath49 , thus we will be looking at a uniform mixture of two trees .",
    "we begin by showing a simple class of mixture distributions where popular phylogenetic algorithms fail . in particular",
    ", we consider maximum likelihood methods , and markov chain monte carlo ( mcmc ) algorithms for sampling from the posterior distribution .    in the following ,",
    "for a mixture distribution @xmath50 , we consider the likelihood of a tree @xmath0 as , the maximum over assignments of transition matrices @xmath24 to the edges of @xmath0 , of the probability that the tree @xmath51 generated @xmath50 .",
    "thus , we are considering the likelihood of a pure ( non - mixture ) distribution having generated the mixture distribution @xmath50 .",
    "more formally , the maximum expected log - likelihood of tree @xmath0 for distribution @xmath50 is defined by @xmath52 where @xmath53    recall for the cfn , jc , k2 and k3 models ,",
    "@xmath26 is restricted to transition matrices obtainable from positive rate matrices @xmath10 and positive times @xmath11 .",
    "chang @xcite constructed a mixture example where likelihood ( maximized over the best single tree ) was maximized on the wrong topology ( i.e. , different from the generating topology ) . in chang s",
    "examples one tree had all edge weights sufficiently small ( corresponding to invariant sites ) .",
    "we consider examples with less variation within the mixture and fewer parameters required to be sufficiently small .",
    "we consider ( arguably more natural ) examples of the same flavor as those studied by kolaczkowski and thornton @xcite , who showed experimentally that in the jc model , likelihood appears to perform poorly on these examples .",
    "figure [ fig : cfnbadmle ] shows the form of our examples where @xmath54 and @xmath55 are parameters of the example .",
    "we consider a uniform mixture of the two trees in the figure .",
    "for each edge , the figure shows the mutation probability , i.e. , it is the off - diagonal entry for the transition matrix .",
    "we consider the cfn , jc , k2 and k3 models .     and",
    "@xmath55 sufficiently small , maximum likelihood is inconsistent on a mixture of the above trees.,height=96 ]    we prove that in this mixture model , maximum likelihood is not robust in the following sense : when likelihood is maximized over the best single tree , the maximum likelihood topology is different from the generating topology",
    ".    in our example all of the off - diagonal entries of the transition matrices are identical .",
    "hence for each edge we specify a single parameter and thus we define a set @xmath56 of transition matrices for a 4-leaf tree by a 5-dimensional vector where the @xmath57-th coordinate is the parameter for the edge incident leaf @xmath57 , and the last coordinate is the parameter for the internal edge .    here is the statement of our result on the robustness of likelihood .",
    "[ thm : mlebad ] let @xmath58 .",
    "let @xmath59 and @xmath60 .",
    "consider the following mixture distribution on @xmath61 : @xmath62    1 .",
    "in the cfn model , for all @xmath63 , there exists @xmath64 such that for all @xmath65 the maximum - likelihood tree for @xmath66 is @xmath67 .",
    "[ thm : cfnbad ] 2 .",
    "in the jc , k2 and k3 models , for @xmath68 , there exists @xmath64 such that for all @xmath65 the maximum - likelihood tree for @xmath66 is @xmath67 .",
    "[ thm : jcbad ]    recall , likelihood is maximized over the best pure ( i.e. , non - mixture ) distribution .",
    "note , for the above theorem , we are maximizing the likelihood over assignments of valid transition matrices for the model . for the above models , valid transition matrices are those obtainable with finite and positive times @xmath11 , and rate matrices @xmath10 where all the entries are positive .",
    "a key observation for our proof approach of theorem [ thm : mlebad ] is that the two trees in the mixture example are the same in the limit @xmath69 .",
    "the @xmath70 case is used in the proof for the @xmath71 case .",
    "we expect the above theorem holds for more a general class of examples ( such as arbitrary @xmath55 , and any sufficiently small function on the internal edge ) , but our proof approach requires @xmath55 sufficiently small .",
    "our proof approach builds upon the work of mossel and vigoda @xcite .",
    "our results also extend to show , for the cfn and jc models , mcmc methods using nni transitions converge exponentially slowly to the posterior distribution .",
    "this result requires the 5-leaf version of mixture example from figure [ fig : cfnbadmle ] .",
    "we state our mcmc result formally in theorem [ thm : mcmc - main ] in section [ sec : mcmc ] after presenting the background material .",
    "previously , mossel and vigoda @xcite showed a mixture distribution where mcmc methods converge exponentially slowly to the posterior distribution .",
    "however , in their example , the tree topology varies between the two trees in the mixture .      based on the above results on the robustness of likelihood",
    ", we consider whether there are any methods which are guaranteed to determine the common topology for mixture examples .",
    "we first found that in the cfn model there is a simple mixture example of size @xmath72 , where the mixture distribution is non - identifiable .",
    "in particular , there is a mixture on topology @xmath67 and also a mixture on @xmath61 which generate identical distributions .",
    "hence , it is impossible to determine the correct topology in the worst case .",
    "it turns out that this example does not extend to models such as jc and k2 .",
    "in fact , all mixtures in jc and k2 models are identifiable .",
    "this follows from our following duality theorem which distinguishes which models have non - identifiable mixture distributions , or have an easy method to determine the common topology in the mixture .",
    "we prove , that for any model which is parameterized by an open set , either there exists a linear test ( which is a strictly separating hyperplane as defined shortly ) , or the model has _",
    "non - identifiable _ mixture distributions in the following sense .",
    "does there exist a tree @xmath0 , a collection @xmath73 , and distribution @xmath74 , such that there is another tree @xmath75 , a collection @xmath76 and a distribution @xmath77 where : @xmath78 thus in this case it is impossible to distinguish these two distributions .",
    "hence , we can not even infer which of the topologies @xmath0 or @xmath79 is correct .",
    "if the above holds , we say the model has _",
    "non - identifiable mixture distributions_.    in contrast , when there is no non - identifiable mixture distribution we can use the following notion of a linear test to reconstruct the topology .",
    "a _ linear test _ is a hyperplane strictly separating distributions arising from two different 4 leaf trees ( by symmetry the test can be used to distinguish between the 3 possible 4 leaf trees ) . it suffices to consider trees with 4 leaves , since the full topology can be inferred from all 4 leaf subtrees ( bandelt and dress @xcite ) .",
    "our duality theorem uses a geometric viewpoint ( see kim @xcite for a nice introduction to a geometric approach ) .",
    "every mixture distribution @xmath50 on a 4-leaf tree @xmath0 defines a point @xmath80 where @xmath81 .",
    "for example , for the cfn model , we have @xmath82 and @xmath83 .",
    "let @xmath84 denote the set of points corresponding to distributions @xmath85 for the 4-leaf tree @xmath86 , @xmath87 .",
    "a linear test is a hyperplane which strictly separates the sets for a pair of trees .",
    "consider the 4-leaf trees @xmath88 and @xmath61 .",
    "a _ linear test _ is a vector @xmath89 such that @xmath90 for any mixture distribution @xmath91 arising from @xmath88 and @xmath92 for any mixture distribution @xmath93 arising from @xmath61",
    ".    there is nothing special about @xmath88 and @xmath61 - we can distinguish between mixtures arising from any two @xmath94 leaf trees , e.g. , if @xmath95 is a test then @xmath96 distinguishes the mixtures from @xmath67 and the mixtures from @xmath88 , where @xmath97 swaps the labels for leaves @xmath34 and @xmath98 .",
    "more precisely , for all @xmath99 , @xmath100    [ thm : dual ] for any model whose set @xmath101 of transition matrices is parameterized by an open set ( of multilinear polynomials ) , exactly one of the following holds :    * there exist non - identifiable mixture distributions , or * there exists a linear test .    for the jc and k2 models , the existence of a linear test follows immediately from lake s linear invariants @xcite .",
    "hence , our duality theorem implies that there are no non - identifiable mixture distributions in this model .",
    "in contrast for the k3 model , we prove there is no linear test , hence there is an non - identifiable mixture distribution .",
    "we also prove that in the k3 model in the common rate matrix framework , there is a non - identifiable mixture distribution .    to summarize",
    ", we show the following :    1 .",
    "[ thm : main222 ] in the cfn model , there is an ambiguous mixture of size 2 . 2 .",
    "in the jc and k2 model , there are no ambiguous mixtures .",
    "3 .   in the k3 model",
    "there exists a non - identifiable mixture distribution ( even in the common rate matrix framework ) .",
    "steel , szkely and hendy @xcite previously proved the existence of a non - identifiable mixture distribution in the cfn model , but their proof was non - constructive and gave no bound on the size of the mixture .",
    "their result had the more appealing feature that the trees in the mixture were scalings of each other .",
    "allman and rhodes @xcite recently proved identifiability of the topology for certain classes of mixture distributions using invariants ( not necessarily linear ) .",
    "rogers @xcite proved that the topology is identifiable in the general time - reversible model when the rates vary according to what is known as the invariable sites plus gamma distribution model .",
    "much of the current work on invariants uses ideas from algebraic geometry , whereas our notion of a linear test is natural from the perspective of convex programming duality .",
    "note , that even in models that do not have non - identifability between different topologies , there is non - identifiability within the topology .",
    "an interesting example was shown by evans and warnow @xcite .",
    "we prove , in section [ sec : duality ] , theorem [ thm : dual ] that a phylogenetic model has a non - identifiable mixture distribution or a linear test . we then detail lake s linear invariants in section [ sec : tests ] , and conclude the existence of a linear test for the jc and k2 models . in sections",
    "[ sec : ambiguity ] and [ sec : k3 ] we prove that there are non - identifiable mixtures in the cfn and k3 models , respectively .",
    "we also present a linear test for a restricted version of the cfn model in section [ sec : cfntest ] .",
    "we prove the maximum likelihood results stated in theorem [ thm : mlebad ] in section [ sec : maxlik ] .",
    "the maximum likelihood results require several technical tools which are also proved in section [ sec : maxlik ] .",
    "the mcmc results are then stated formally and proved in section [ sec : mcmc ] .",
    "let the permutation group @xmath102 act on the 4-leaf trees @xmath103 by renaming the leaves .",
    "for example @xmath104 swaps @xmath88 and @xmath61 , and fixes @xmath67 .",
    "for @xmath105 , we let @xmath106 denote tree @xmath0 permuted by @xmath7 .",
    "it is easily checked that the following group @xmath107 ( klein group ) fixes every @xmath86 : @xmath108 note that @xmath109 , i.e. , @xmath107 is a normal subgroup of @xmath102 .",
    "for weighted trees we let @xmath102 act on @xmath51 by changing the labels of the leaves but leaving the weights of the edges untouched .",
    "let @xmath105 and let @xmath110 .",
    "note that the distribution @xmath111 is just a permutation of the distribution @xmath112 : @xmath113 the actions on weighted trees and on distributions are compatible : @xmath114",
    "[ sec : duality ]    in this section we prove the duality theorem ( i.e. , theorem [ thm : dual ] ) .    our assumption that the transition matrices of the model are parameterized by an open set implies the following observation .",
    "[ obs : multisecond ] for models parameterized by an open set , the coordinates of @xmath115 are multi - linear polynomials in the parameters .",
    "we now state a classical result that allows one to reduce the reconstruction problem to trees with 4 leaves .",
    "note there are three distinct leaf - labeled binary trees with @xmath94 leaves",
    ". we will call them @xmath116 see figure [ trees ] .     leaves . ]    for a tree @xmath0 and a set @xmath117 of leaves , let @xmath118 denote the induced subgraph of @xmath0 on @xmath117 where internal vertices of degree @xmath72 are removed .    for distinct leaf - labeled binary trees @xmath0 and @xmath79 there exist a set @xmath117 of @xmath94 leaves where @xmath119 .",
    "hence , the set of induced subgraphs on all 4-tuples of leaves determines a tree .",
    "the above theorem also simplifies the search for non - identifiable mixture distributions .",
    "if there exists a non - identifiable mixture distribution then there exists a non - identifiable mixture distribution on trees with @xmath94 leaves .",
    "recall from the introduction , the mixtures arising from @xmath86 form a convex set in the space of joint distributions on leaf labelings .",
    "a test is a hyperplane _ strictly _ separating the mixtures arising from @xmath88 and the mixtures arising from @xmath61 . for general disjoint",
    "convex sets a strictly separating hyperplane need not exist ( e.g. , take @xmath120 and @xmath121 ) .",
    "the sets of mixtures are special - they are convex hulls of images of open sets under a multi - linear polynomial map .",
    "[ lem : dua ] let @xmath122 be multi - linear polynomials in @xmath123 .",
    "let @xmath124 .",
    "let @xmath125 be an open set .",
    "let @xmath54 be the convex hull of @xmath126 .",
    "assume that @xmath127 .",
    "there exists @xmath128 such that @xmath129 for all @xmath130 .",
    "suppose the polynomial @xmath131 is a linear combination of the other polynomials , i.e. , @xmath132 .",
    "let @xmath133 .",
    "let @xmath134 be the convex hull of @xmath135 .",
    "then @xmath136 is a bijection between points in @xmath134 and @xmath54 .",
    "note , @xmath137 .",
    "there exists a strictly separating hyperplane between @xmath138 and @xmath54",
    "( i.e. , there exists @xmath128 such that @xmath129 for all @xmath130 ) if and only if there exists a strictly separating hyperplane between @xmath138 and @xmath134 ( i.e. , there exists @xmath139 such that @xmath140 for all @xmath130 ) . hence , without loss of generality , we can assume that the polynomials @xmath141 are linearly independent .",
    "since @xmath54 is convex and @xmath127 , by the separating hyperplane theorem , there exists @xmath142 such that @xmath143 for all @xmath130 . if @xmath129 for all @xmath130 we are done .",
    "now suppose @xmath144 for some @xmath145 .",
    "if @xmath146 , then by translating @xmath147 by @xmath148 and changing the polynomials appropriately ( namely , @xmath149 ) , without loss of generality , we can assume @xmath150 .",
    "let @xmath151 .",
    "note that @xmath17 is multi - linear and @xmath152 because @xmath141 are linearly independent . since @xmath150 , we have @xmath153 and hence @xmath17 has no constant monomial .",
    "let @xmath154 be the monomial of lowest total degree which has a non - zero coefficient in @xmath17 .",
    "consider @xmath155 where @xmath156 for @xmath157 which occur in @xmath154 and @xmath158 for all other @xmath157 .",
    "then , @xmath159 since there are no monomials of smaller degree , and any other monomials contain some @xmath160 which is @xmath138 .",
    "hence by choosing @xmath161 sufficiently close to @xmath138 , we have @xmath162 ( since @xmath147 is open ) and @xmath163 ( by choosing an appropriate direction for @xmath161 ) .",
    "this contradicts the assumption that @xmath164 is a separating hyperplane .",
    "hence @xmath165 which is a contradiction with the linear independence of the polynomials @xmath141 .",
    "we now prove our duality theorem .",
    "clearly there can not exist both a non - identifiable mixture and a linear test .",
    "let @xmath84 be the convex set of mixtures arising from @xmath86 ( for @xmath166 ) .",
    "assume that @xmath167 , i.e. , there is no non - identifiable mixture in @xmath101 .",
    "let @xmath168 .",
    "note that @xmath54 is convex , @xmath127 , and @xmath54 is the convex hull of an image of open sets under multi - linear polynomial maps ( by observation [ obs : multisecond ] ) . by lemma  [ lem : dua ]",
    "there exists @xmath142 such that @xmath169 for all @xmath170 .",
    "let @xmath171 ( where @xmath172 is defined as in ) .",
    "let @xmath173 and let @xmath174 where @xmath175 is defined analogously to @xmath176 .",
    "then @xmath177 similarly for @xmath178 we have @xmath179 and hence @xmath95 is a test .",
    "the cfn , jc , k2 and k3 models all have a natural group - theoretic structure .",
    "we show some key properties of linear tests utilizing this structure .",
    "these properties will simplify proofs of the existence of linear tests in jc and k2 ( and restricted cfn ) models and will also be used in the proof of the non - existence of linear tests in k3 model .",
    "our main objective is to use symmetry inherent in the phylogeny setting to drastically reduce the dimension of the space of linear tests .",
    "symmetric phylogeny models have a group of symmetries @xmath180 ( @xmath181 is the intersection of the automorphism groups of the weighted graphs corresponding to the matrices in @xmath101 ) .",
    "the probability of a vertex labeling of @xmath0 does not change if the labels of the vertices are permuted by an element of @xmath181 .",
    "thus the elements of @xmath23 which are in the same orbit of the action of @xmath181 on @xmath23 have the same probability in any distribution arising from the model .",
    "let @xmath182 be the orbits of @xmath183 under the action of @xmath181 .",
    "let @xmath184 be the orbits of @xmath182 under the action of @xmath107 .",
    "note that the action of @xmath185 on @xmath184 is well defined ( because @xmath107 is a normal subgroup of @xmath102 ) .",
    "for each pair @xmath186 that are swapped by @xmath185 let @xmath187    [ lem : tes ] suppose that @xmath101 has a linear test @xmath164 .",
    "then @xmath101 has a linear test @xmath95 which is a linear combination of the @xmath188 .",
    "let @xmath164 be a linear test .",
    "let @xmath189 let @xmath91 be a mixture arising from @xmath88 . for any @xmath190 the mixture @xmath191 arises from @xmath88 and hence @xmath192 similarly @xmath193 for @xmath93 arising from @xmath61 and hence @xmath194 is a linear test .",
    "now we show that @xmath95 is a linear test as well .",
    "let @xmath91 arise from @xmath88 .",
    "note that @xmath174 arises from @xmath61 and hence @xmath195 similarly @xmath196 for @xmath93 arising from @xmath61 and hence @xmath95 is a linear test .",
    "note that @xmath95 is zero on orbits fixed by @xmath185 .",
    "on orbits @xmath197 swapped by @xmath185 we have that @xmath95 has opposite value ( i.e. , @xmath198 on @xmath199 , and @xmath148 on @xmath200 for some @xmath198 ) .",
    "hence @xmath95 is a linear combination of the @xmath188 .      for the later proofs it will be convenient to label the edges by matrices which are not allowed by the phylogenetic models .",
    "for example the identity matrix @xmath201 ( which corresponds to zero length edge ) is an invalid transition matrix , i.e. , @xmath202 , for the models considered in this paper .",
    "the definition ( [ eq : defp ] ) is continuous in the entries of the matrices and hence for a weighting by matrices in @xmath203 ( the closure of @xmath101 ) the generated distribution is arbitrarily close to a distribution generated from the model .",
    "[ closure ] a linear test for @xmath26 ( which is a strictly separating hyperplane for @xmath101 ) is a separating hyperplane for @xmath204 .",
    "the above observation follows from the fact that if a continuous function @xmath205 is positive on some set @xmath206 then it is non - negative on @xmath207 .",
    "suppose that the identity matrix @xmath208 .",
    "let @xmath50 arise from @xmath88 with weights such that the internal edge has weight @xmath201 .",
    "then @xmath91 arises also from @xmath61 with the same weights .",
    "a linear test has to be positive for mixtures form @xmath88 and negative for mixtures from @xmath61 .",
    "hence we have :    [ obs : zero ] let @xmath50 arise from @xmath88 with weights such that the internal edge has transition matrix @xmath201 .",
    "let @xmath95 be a linear test . then @xmath209 .",
    "in this section we show a linear test for jc and k2 models .",
    "in fact we show that the linear invariants introduced by lake @xcite are linear tests .",
    "we expect that this fact is already known , but we include the proof for completeness and since it almost elementary given the preliminaries from the previous section .      to simplify many of the upcoming expressions throughout the following section , we center the transition matrix for the jukes - cantor ( jc ) model around its stationary distribution in the following manner . recall the jc model has @xmath210 and its semigroup @xmath211 consists of matrices @xmath212 where @xmath213 is the all ones matrix ( i.e. , @xmath214 for all @xmath215 ) and @xmath216 .",
    "we refer to @xmath217 as the _ centered edge weight_. thus , a centered edge weight of @xmath218 ( which is not valid ) means both endpoints have the same assignment . whereas @xmath219 ( also not valid ) means the endpoints are independent .",
    "the group of symmetries of @xmath220 is @xmath221 .",
    "there are @xmath222 orbits in @xmath223 under the action of @xmath224 ( each orbit has a representative in which @xmath57 appears before @xmath225 for any @xmath226 ) .",
    "the action of @xmath107 further decreases the number of orbits to @xmath227 .",
    "here we list the @xmath227 orbits and indicate which orbits are swapped by @xmath185 : @xmath228 by lemma  [ lem : tes ] every linear test in the jc model is a linear combination of @xmath229    we will show that @xmath230 is a linear test and that there exist no other linear tests ( i.e. , all linear tests are multiples of @xmath230 ) .",
    "[ lcj ] let @xmath50 be a single - tree mixture arising from a tree @xmath0 on @xmath94 leaves .",
    "let @xmath95 be defined by @xmath231 let @xmath232 arise from @xmath86 , for @xmath87 .",
    "we have @xmath233 in particular @xmath95 is a linear test .",
    "label the 4 leaves as @xmath234 , and let @xmath235 denote the centered edge weight of the edge incident to the respective leaf .",
    "let @xmath236 denote the centered edge weight of the internal edge .",
    "let @xmath237 arise from @xmath238 with centered edge weights @xmath239 , @xmath240 .",
    "let @xmath241 be the multi - linear polynomial @xmath242 .",
    "if @xmath243 then @xmath237 does not depend on the label of @xmath244 and hence , for all @xmath245 , @xmath246 thus @xmath247 divides @xmath241 .",
    "the @xmath248 are invariant under the action of @xmath107 ( which is transitive on @xmath249 ) and hence @xmath241 is invariant under the action of @xmath107 .",
    "hence @xmath250 divides @xmath241 for @xmath251 .",
    "we have @xmath252 where @xmath253 is a linear polynomial in @xmath236 .",
    "let @xmath254 arise from @xmath67 with @xmath255 . in leaf - labelings with non - zero probability in @xmath254 the labels of @xmath256 agree and the labels of @xmath257 agree .",
    "none of the leaf - labelings in ( [ ephi ] ) satisfy this requirement and hence @xmath258 if @xmath255 .",
    "hence @xmath253 is the zero polynomial and @xmath259 is the zero polynomial as well .",
    "now we consider @xmath88 .",
    "if @xmath260 then , by observation  [ obs : zero ] , @xmath261 .",
    "thus @xmath262 is a root of @xmath263 and hence @xmath264 .",
    "we plug in @xmath265 and @xmath266 to determine @xmath25 .",
    "let @xmath267 be the distribution generated by these weights .",
    "the leaf - labelings for which @xmath268 is non - zero must have the same label for @xmath269 and the same label for @xmath270 .",
    "thus @xmath271 and hence @xmath272 .",
    "we have @xmath273 note that @xmath274 is always positive .",
    "the action of @xmath185 switches the signs of the @xmath248 and hence @xmath275 .",
    "thus @xmath276 is always negative .",
    "we now show uniqueness of the above linear test , i.e. , any other linear test is a multiple of @xmath230 .",
    "any linear test in the jc model is a multiple of ( [ ephi ] ) .",
    "let @xmath277 be a linear test .",
    "let @xmath278 be the distribution generated by centered weights @xmath279 and @xmath280 on @xmath88 .",
    "by observation  [ obs : zero ] we must have @xmath281 .",
    "note that @xmath282 hence @xmath283 thus @xmath284 and hence @xmath95 is a multiple of ( [ ephi ] ) .",
    "mutations between two purines ( and ) or between two pyrimidines ( or ) are more likely than mutations between a purine and a pyrimidine .",
    "kimura s 2-parameter model ( k2 ) tries to model this fact .",
    "we once again center the transition matrices to simplify the calculations .",
    "the k2 model has @xmath285 and its semigroup @xmath286 consists of matrices @xmath287 with @xmath288 and @xmath289 .",
    "see felsenstein @xcite for closed form of the transition matrices of the model in terms of the times @xmath11 and rate matrices @xmath10 .",
    "one can then derive the equivalence of the conditions there with the conditions @xmath290 .",
    "note , @xmath217 can be negative , and hence certain transitions can have probability @xmath291 but are always @xmath292 .",
    "observe that @xmath293 , i.e. , the jc model is a special case of the k2 model .",
    "the group of symmetries is @xmath294 ( it has @xmath295 elements ) .",
    "there are @xmath296 orbits in @xmath183 under the action of @xmath297 ( each orbit has a representative in which @xmath138 appears first and @xmath72 appears before @xmath98 ) .",
    "the action of @xmath107 further decreases the number of orbits to @xmath298 .",
    "the following orbits are fixed by @xmath185 : @xmath299 the following orbits are swapped by @xmath185 : @xmath300 by lemma [ lem : tes ] any linear test for the k2 model is a linear combination of @xmath301    [ lk2 ] let @xmath50 be a single - tree mixture arising from a tree @xmath0 on @xmath94 leaves .",
    "let @xmath95 be defined by @xmath302 let @xmath232 arise from @xmath86 , for @xmath87 .",
    "we have @xmath233 in particular @xmath95 is a linear test .",
    "let @xmath303 for some @xmath240 .",
    "let the transition matrix of the edge incident to leaf @xmath304 be @xmath305 , and the internal edge has @xmath306 .",
    "let @xmath237 be the generated distribution , and let @xmath241 be the multi - linear polynomial @xmath242 .    if @xmath307 then the matrix on the edge incident to leaf @xmath244 has the last two columns the same .",
    "hence roughly speaking this edge forgets the distinction between labels @xmath72 and @xmath98 , and therefore , in , we can do the following replacements : @xmath308 and we obtain , @xmath309    thus @xmath310 divides @xmath241 .",
    "since @xmath241 is invariant under the action of @xmath107 we have that @xmath311 divides @xmath241 for @xmath251 and hence @xmath312 where @xmath313 is linear in @xmath236 and @xmath314 .",
    "now let @xmath315 for @xmath251 .",
    "the label of the internal vertices @xmath316 for @xmath317 must agree with the labels of neighboring leaves and hence @xmath318 now plugging @xmath319 into and , for this setting of @xmath320 , we have @xmath321 by plugging @xmath322 into and we have @xmath323 note that @xmath324 and @xmath325 and hence ( [ emu2 ] ) is always positive .",
    "linearity of the test @xmath326 implies that @xmath327 is positive for any mixture generated from @xmath88 and negative for any mixture generated from @xmath61 .",
    "[ k2unique ] any linear test in the k2 model is a multiple of ( [ ephi2 ] ) .",
    "let @xmath328 be a linear test .",
    "a linear test in the k2 model must work for jc model as well .",
    "applying symmetries @xmath224 we obtain    @xmath329    comparing ( [ k2jkfuj ] ) with ( [ ephi ] ) we obtain @xmath330    let @xmath278 arise from @xmath88 with centered weights @xmath331 , @xmath332 , and @xmath333 . from observation  [ obs :",
    "zero ] it follows that @xmath334 .",
    "the leaf - labelings with non - zero probability must give the same label to @xmath335 and @xmath244 , and the labels of @xmath336 and @xmath335 must either be both in @xmath337 or both in @xmath338 .",
    "the only such leaf - labelings involved in @xmath339 are @xmath340 .",
    "thus @xmath341 thus @xmath342 and from ( [ k2jc ] ) we get @xmath343 and @xmath344 .",
    "let @xmath91 be generated from @xmath88 with centered weights @xmath345 , @xmath346 , and @xmath347 . in leaf - labelings with non - zero probability the labels of @xmath335 and @xmath244 are either both in @xmath337 or both in @xmath338 .",
    "the only such leaf labelings in @xmath348 are 0202,0213,0212 , and 0203 .",
    "hence @xmath349 thus @xmath350 and all the @xmath351 are determined .",
    "hence the linear test is unique ( up to scalar multiplication ) .",
    "in this section we consider the cfn model .",
    "we first prove there is no linear test , and then we present a non - identifiable mixture distribution .",
    "we then show that there is a linear test for the cfn model when the edge probabilities are restricted to some interval .      again , when considering linear tests we look at the model with its transition matrix centered around its stationary distribution .",
    "the cfn model has @xmath352 and its semigroup @xmath353 consists of matrices @xmath354 with @xmath355 .    in the cfn model , note that the roles of @xmath138 and @xmath34 are symmetric , i.e. , @xmath356 hence the group of symmetries of @xmath357 is @xmath358 .",
    "there are @xmath295 orbits of the action of @xmath359 on @xmath360 ( one can choose a representative for each orbit to have the first coordinate @xmath138 ) .",
    "the action of @xmath107 further reduces the number of orbits to @xmath361 .",
    "the action of @xmath185 swaps two of the orbits and keeps @xmath98 of the orbits fixed : @xmath362 by lemma  [ lem : tes ] , if there exists a linear test for cfn then ( a multiple of ) @xmath363 is a linear test .",
    "let @xmath50 arise from @xmath88 with the edge incident to leaf @xmath304 labeled by @xmath364 , for @xmath251 , and the internal edge labeled by @xmath365 .",
    "a short calculation yields @xmath366 note that ( [ ecf ] ) is negative if @xmath236 is much smaller than the other @xmath250 ; and ( [ ecf ] ) is positive if @xmath367 are much smaller than the other @xmath250 .",
    "thus @xmath368 is not a linear test and hence there does not exist a linear test in the cfn model . by theorem  [ thm : dual ]",
    "there exists a non - identifiable mixture .",
    "the next result gives an explicit family of non - identifiable mixtures .",
    "for each edge @xmath8 we will give the edge probability @xmath369 , which is the probability the endpoints receive different assignments ( i.e. , it is the off - diagonal entry in the transition matrix . for a 4-leaf tree @xmath0",
    ", we specify a set of transition matrices for the edges by a 5-dimensional vector @xmath370 where , for @xmath371 , @xmath372 is the edge probability for the edge incident to leaf labeled @xmath57 , and @xmath373 is the edge probability for the internal edge .    for @xmath374 and @xmath375 , set @xmath376 where @xmath377 and @xmath378 let @xmath379 the distribution @xmath50 is invariant under @xmath380 .",
    "hence , @xmath50 is also generated by a mixture from @xmath106 , a leaf - labeled tree different from @xmath381 .",
    "in particular , the following holds : @xmath382 hence , whenever @xmath383 and @xmath384 satisfy @xmath385 then @xmath50 is in fact a distribution and there is non - identifiability .",
    "note , for every @xmath375 , there exist @xmath198 and @xmath386 which define a non - identifiable mixture distribution .",
    "note that @xmath387 fixes leaf labels @xmath388 and swaps @xmath389 with @xmath390 and @xmath391 with @xmath392 .",
    "a short calculation yields @xmath393 which are both zero for our choice of @xmath383 and @xmath384 .",
    "this implies that @xmath50 is invariant under the action of @xmath185 , and hence non - identifiable .",
    "let @xmath394 .",
    "if the centered edge weight @xmath217 for the cfn model is restricted to the interval @xmath395 then there is a linear test .",
    "we will show that ( [ ecf ] ) is positive if the @xmath250 are in the interval @xmath395 .",
    "let @xmath396 .",
    "note that @xmath397 .    since ( [ ecf ] ) is multi - linear ,",
    "its extrema occur when the @xmath250 are from the set @xmath398 ( we call such a setting of the @xmath250 extremal ) .",
    "note that the @xmath250 are positive and @xmath236 occurs only in terms with negative sign .",
    "thus a minimum occurs for @xmath399 .",
    "the only extremal settings of the @xmath250 which have @xmath400 are @xmath401 and @xmath402 . for the other extremal settings ( [ ecf ] ) is positive , since @xmath403 .",
    "for @xmath401 the value of ( [ ecf ] ) is @xmath404 .",
    "in contrast to the above lemma , it is known that there is no linear invariant for the cfn model .",
    "this implies that there is also no linear invariant for the restricted cfn model considered above , since such an invariant would then extend to the general model .",
    "this shows that the notion of linear test is more useful in some settings than linear invariants .",
    "[ sec : k3 ]    in this section we prove there exists a non - identifiable mixture distribution in the k3 model . our result holds even when the rate matrix is the same for all edges in the tree ( the edges differ only by their associated time ) , i.e. , the common rate matrix framework .",
    "morevoer , we will show that for most rate matrices @xmath405 in the k3 model there exists a non - identifiable mixture in which all transition matrices are generated from @xmath405 .",
    "the kimura s 3-parameter model ( k3 ) has @xmath285 and its semigroup @xmath406 consists of matrices of the following form ( which we have centered around their stationary distribution ) : @xmath407 with @xmath408 , @xmath289 , and @xmath409 .",
    "note that @xmath410 , i.e. , the k2 model is a special case of the k3 model .",
    "the group of symmetries is @xmath411 ( which is again the klein group ) .",
    "there are @xmath412 orbits in @xmath183 under the action of @xmath413 ( each orbit has a representative in which @xmath138 appears first ) .",
    "the action of @xmath107 further decreases the number of orbits to @xmath414 .",
    "the following orbits are fixed by @xmath185 : @xmath415 the following orbits switch as indicated under the action of @xmath185 : @xmath416 and @xmath417      by lemma  [ lem : tes ] any test is a linear combination of @xmath418    we first present a non - constructive proof of non - identifiability by proving that there does not exist a linear test , and then theorem [ thm : dual ] implies there exists a non - identifiable mixture .",
    "we then prove the stronger result where the rate matrix is fixed .",
    "[ lem : k3-ambiguity ] there does not exist a linear test for the k3 model .",
    "there exists a non - identifiable mixture in the k3 model .",
    "suppose that @xmath419 is a test .",
    "let @xmath420 , @xmath421 . for @xmath422",
    ", @xmath423 denotes the centered parameters for the edge incident to leaf @xmath57 , and @xmath424 are the centered parameters for the internal edge .    in the definitions of @xmath278 and @xmath91 below",
    "we will set @xmath425 .",
    "this ensures that in labelings with non - zero probability , leaves @xmath426 and both internal vertices all have the same label .",
    "moreover , by observation  [ obs : zero ] , @xmath427 .",
    "let @xmath278 be generated from @xmath88 with @xmath428 , and @xmath429 . in labelings with non - zero probability ,",
    "the labels of @xmath335 and @xmath430 have to both be in @xmath337 or both in @xmath338 .",
    "the only labels in @xmath431 with this property are @xmath432 .",
    "thus , @xmath433 any @xmath434 $ ] with @xmath435 gives a valid matrix in the k3 model . for ( [ eq : q2c ] ) to be always zero",
    "we must have @xmath436 ( since @xmath437 are linearly independent polynomials ) .",
    "let @xmath91 be generated from @xmath88 with @xmath428 , and @xmath438 .",
    "the only labels in @xmath439 with @xmath335 and @xmath244 having the same label are @xmath440 ( we ignore the labels in @xmath441 because @xmath436 ) .",
    "thus @xmath442 polynomials @xmath443 are linearly independent and hence @xmath444 .",
    "thus @xmath95 is a linear combination of @xmath445 and hence has at most @xmath446 terms .",
    "a test for k3 must be a test for k2 , but the unique test for k2 has @xmath295 terms .",
    "thus @xmath447 can not be a test for k3 .",
    "we will now consider rate matrices for the model , as opposed to the transition probability matrices .",
    "the rate matrix for the k3 model is @xmath448 where the rates usually satisfy @xmath449 . for our examples we will also assume that @xmath450 $ ] .",
    "since the examples are negative they work immediately for the above weaker constraint .",
    "recall , the k2 model is a submodel of the k3 model : the rate matrices of the k2 model are precisely the rate matrices of k3 model with @xmath451 . by lemma  [ lk2 ] there",
    "exists a test in the k2 model and hence there are no non - identifiable mixtures .",
    "we will show that the existence of a test in the k2 model is a rather singular event : for almost all rate matrices in the k3 model there exist non - identifiable mixtures and hence no test .",
    "we show the following result .    [ rara ]",
    "let @xmath452 be chosen independently from the uniform distribution on @xmath453 $ ] . with probability @xmath34 ( over the choice of @xmath452 ) there does not exist a test for the k3 model with the rate matrix @xmath454 .    to prove lemma  [ rara ] we need the following technical concept .",
    "generalized polynomial _ is a function of the form @xmath455 where the @xmath456 are non - zero polynomials and the @xmath457 are distinct linear polynomials .",
    "note that the set of generalized polynomials is closed under addition , multiplication , and taking derivatives .",
    "thus , for example , the wronskian of a set of generalized polynomials ( with respect to one of the variables , say @xmath458 ) is a generalized polynomial .    for @xmath459 we have the following bound on the number of roots of a generalized polynomial ( see @xcite , part v , problem 75 ) :    [ lem : bnd ] let @xmath460 be a univariate generalized polynomial .",
    ". then @xmath181 has at most @xmath462 real roots , where @xmath463 is the degree of the polynomial @xmath464 .",
    "[ comes ] let @xmath465 be a generalized polynomial .",
    "assume @xmath461 ( i.e. , that @xmath181 is not the zero polynomial ) . let @xmath466 be picked in independently and randomly from uniform distribution on @xmath453 $ ] . then with probability @xmath34 ( over the choice of @xmath467 ) we have @xmath468 .",
    "we will proceed by induction on @xmath1 .",
    "the base case @xmath459 follows from lemma  [ lem : bnd ] since the probability of a finite set is zero .    for the induction step consider the polynomial @xmath469 .",
    "since @xmath469 is a non - zero polynomial there are only finitely many choices of @xmath470 $ ] for which @xmath471 is the zero polynomial .",
    "thus with probability @xmath34 over the choice of @xmath472 we have that @xmath471 is a non - zero polynomial .",
    "now , by the induction hypothesis , with probability @xmath34 over the choice of @xmath473 we have that @xmath474 . hence with probability @xmath34 over the choice of @xmath475 we have that @xmath476 .",
    "any test has to be a linear combination of @xmath431 defined in section  [ sec : k3ambiguity ] .",
    "suppose that @xmath477 is a test .",
    "we will use observation  [ obs : zero ] to show that @xmath478 and hence @xmath95 can not be a test .",
    "let @xmath479 .",
    "the transition matrix of the process with rate matrix @xmath405 , at time @xmath164 is @xmath480 .",
    "we have ( see , e.g. , @xcite ) @xmath481 where @xmath482 we have changed notation from our earlier definition of @xmath483 by exchanging @xmath484 for @xmath485 to indicate these as functions of @xmath486 and @xmath487 .",
    "let @xmath66 be generated from @xmath61 with edge weights @xmath488 .",
    "the internal edge has length @xmath138 ( i.e. , it is labeled by the identity matrix ) , and hence , by observation  [ obs : zero ] , we must have @xmath489 for all @xmath490 .",
    "let @xmath491 for @xmath492 .",
    "let @xmath493 be the wronskian matrix of @xmath494 with respect to @xmath55 .",
    "the entries of @xmath493 are generalized polynomials in variables @xmath452 , and @xmath55 . thus the wronskian ( i.e. , @xmath495 ) is a generalized polynomial in variables @xmath452 , and @xmath55 .",
    "now we show that for a particular choice of @xmath452 and @xmath55 we have @xmath496 .",
    "let @xmath497 , @xmath498 , @xmath499 , and @xmath500 .",
    "of course complex rates are not valid in the k3 model , we use them only to establish that @xmath493 is a non - zero generalized polynomial .",
    "tedious computation ( best performed using a computer algebra system ) yields that the wronskian matrix is the following .",
    "the first 7 columns are    @xmath501    the last 2 columns are    @xmath502    the determinant of @xmath493 is @xmath503 which is non - zero .",
    "thus @xmath504 is a non - zero generalized polynomial and hence for random @xmath452 and @xmath55 we have that @xmath504 is non - zero with probability @xmath34 .",
    "assume now that @xmath496 .",
    "let @xmath505 .",
    "the first entry @xmath506 of @xmath154 is given by @xmath507 . since @xmath95 is a test we have @xmath508 .",
    "the second entry @xmath509 of @xmath154 is given by @xmath510 .",
    "again we must have @xmath511 , since @xmath95 is a test .",
    "similarly we show @xmath512 .",
    "note that @xmath493 is a regular matrix and hence @xmath513 must be the zero vector .",
    "thus @xmath95 is not a test .",
    "since @xmath496 happens with probability @xmath34 we have that there exists no test with probability @xmath34 .",
    "here we prove theorem [ thm : mlebad ] .      in the cfn and jc model",
    "there is a single parameter defining the transition matrix for each edge , namely a parameter @xmath514 where @xmath515 . in k2 , there are 2 parameters and in k3 there are 3 parameters .",
    "we use the term weights @xmath516 to denote the setting of the parameters defining the transition matrix for the edge @xmath8 .",
    "and then we let @xmath517 denote the set of vectors defining the transition matrices for edges of tree @xmath0 .",
    "we use the term zero weight edge to denote the setting of the weights so that the transition matrix is the identity matrix @xmath201 .",
    "thus , in the cfn and jc models , this corresponds to setting @xmath518 .",
    "we refer to a non - zero weight edge as a setting of the parameters so that all entries of the transition matrix are positive .",
    "hence , in the cfn and jc models this corresponds to @xmath519 .",
    "note , @xmath520 is maximized over the set of weights @xmath521 .",
    "hence our consideration of weights @xmath521 .",
    "there are typically constraints on @xmath521 in order to define valid transition matrices .",
    "for example , in the cfn model we have @xmath522 where @xmath523 , and similarly @xmath524 in the jc model .",
    "in the k2 model we have @xmath525 where @xmath526 .",
    "finally in the k3 model we have further constraints as detailed in section [ sec : k3 ] .",
    "our proof begins starts from the following observation .",
    "consider the cfn model .",
    "note that for @xmath70 we have @xmath527 and hence @xmath528 where @xmath529 are the weights for the cfn model , i.e. , @xmath530 is generated by a pure distribution from @xmath61 .",
    "in fact it can be generated by a pure distribution from any leaf - labeled tree on @xmath94 leaves since the internal edges have zero length .",
    "[ obs : achievable ] consider a tree @xmath0 on @xmath1 leaves and weights @xmath154 where all internal edges have zero weight . for all trees",
    "@xmath531 on @xmath1 leaves , there is a unique weight @xmath532 such that @xmath533 .",
    "let @xmath532 have the same weight as @xmath521 for all terminal edges , and zero weight for all internal edges .",
    "note , we then have @xmath533 and it remains to prove uniqueness of @xmath532 .",
    "let @xmath534 be a set of weights where @xmath535 .",
    "let @xmath536 be obtained from @xmath117 by contracting all the edges of zero weight in @xmath534 , and let @xmath537 be the resulting set of weights for the remaining edges .",
    "the tree @xmath536 has all internal vertices of degree @xmath538 and internal edges have non - zero weight .",
    "it follows from the work of buneman @xcite that @xmath539 is unique among trees with non - zero internal edge weights and without vertices of degree two .",
    "if @xmath540 , then @xmath536 is a star , and hence every @xmath534 must contract to a star .",
    "this is only possible if @xmath534 assigns zero weight to all internal edges .",
    "therefore , @xmath532 is the unique weight .    for @xmath154 and @xmath541 defined for the cfn model in theorem [ thm : mlebad ] , for any 4-leaf tree @xmath117",
    ", the maximum of @xmath542 is achieved on @xmath543 . for any @xmath544",
    "the distribution @xmath545 is different from @xmath530 and hence @xmath546 .",
    "intuitively , for small @xmath55 the maximum of @xmath547 should be realized on a @xmath548 which is near @xmath549 .",
    "now we formalize this argument in the following lemma . then in lemma [",
    "lem : mai ] we will use the hessian and jacobian of the expected log - likelihood functions to bound @xmath547 in terms of @xmath542 .    [ obs : epsdel ] let @xmath50 be a probability distribution on @xmath23 such that every element has non - zero probability .",
    "let @xmath117 be a leaf - labeled binary tree on @xmath1 leaves .",
    "suppose that there exists a unique @xmath549 in the closure of the model such that @xmath550 .",
    "then for every @xmath551 there exists @xmath552 such that for any @xmath553 with @xmath554 the global optima of @xmath555 are attained on @xmath556 for which @xmath557 .    in our application of the above lemma we have @xmath558 .",
    "consider a tree @xmath117 and its unique weight @xmath549 where @xmath559 .",
    "note , the requirement that every element in @xmath560 has non - zero probability , is satisfied if the terminal edges have non - zero weights .",
    "in contrast , the internal edges have zero weight so that observation [ obs : achievable ] applies , and in some sense the tree is achievable on every topology",
    ".    we will prove the lemma by contradiction .",
    "roughly speaking , we now suppose that there exists @xmath553 close to @xmath50 where the maximum of @xmath553 is achieved far from the maximum of @xmath50 . formally ,",
    "suppose that there exists @xmath551 and sequences @xmath561 and @xmath562 such that latexmath:[$\\lim_{i\\ra\\infty }    @xmath562 is a weight for which the optimum of @xmath564 is attained . by the optimality of the @xmath565",
    "we have @xmath566 we assumed @xmath550 and hence the entries of @xmath567 are finite since we assumed @xmath50 has positive entries .",
    "thus @xmath568 take a subsequence of the @xmath562 which converges to some @xmath556 .",
    "note , @xmath556 is in the closure of the model .",
    "let @xmath569 be the smallest entry of @xmath50 .",
    "for all sufficiently large @xmath57 , @xmath561 has all entries @xmath570 .    hence , @xmath571    because of , for all sufficiently large @xmath57 , @xmath572 ( recall that the log - likelihoods are negative ) .",
    "combining with , we have that the entries of @xmath573 are bounded from below by @xmath574 .",
    "thus , both @xmath561 and @xmath573 are bounded . for bounded and convergent sequences , @xmath575 therefore ,",
    "@xmath576 from ( [ e:1 ] ) , ( [ e:2 ] ) , and ( [ e:3 ] ) we have @xmath577 .",
    "since @xmath544 we get a contradiction with the uniqueness of @xmath549 .",
    "we now bound the difference of @xmath555 and @xmath578 when the previous lemma applies .",
    "this will then imply that for @xmath55 sufficiently small , @xmath547 is close to @xmath542 .",
    "here is the formal statement of the lemma .",
    "[ lem : mai ] [ lem : sv ] let @xmath579 be a probability distribution on @xmath23 such that every element has non - zero probability .",
    "let @xmath117 be a leaf - labeled binary tree on @xmath1 vertices .",
    "suppose that there exists @xmath532 in the closure of the model such that @xmath580 and that @xmath532 is the unique such weight .",
    "let @xmath581 be such that @xmath582 , and @xmath583 is continuous around @xmath138 in the following sense : @xmath584 as @xmath585 .",
    "let @xmath586 , and @xmath587 .",
    "let @xmath588 be the hessian of @xmath589 at @xmath532 and @xmath590 be the jacobian of @xmath591 at @xmath532 .",
    "assume that @xmath588 has full rank",
    ". then @xmath592 moreover , if @xmath593 for all @xmath57 such that @xmath594 then the inequality in ( [ e : es ] ) can be replaced by equality .",
    "[ rem : nonzero ] when @xmath595 for all @xmath57 such that @xmath596 then the likelihood is maximized at non - trivial branch lengths . in particular , for the cfn model , the branch lengths are in the interval @xmath597 , that is , there are no branches of length @xmath138 or @xmath598 .",
    "similarly for the jukes - cantor model the lengths are in @xmath599 .    for notational convenience ,",
    "let @xmath600 .",
    "thus , @xmath601 .",
    "note that @xmath602 the function @xmath603 maps assignments of weights for the @xmath604 edges of @xmath117 to the logarithm of the distribution induced on the leaves .",
    "hence , the domain of @xmath603 is the closure of the model , which is a subspace of @xmath605 , where @xmath384 is the dimension of the parameterization of the model , e.g. , in the cfn and jc models @xmath606 and in the k2 model @xmath607 .",
    "we denote the closure of the model as @xmath608 .",
    "note , the range of @xmath603 is @xmath609^{|\\omega|^n}$ ] .",
    "let @xmath610 be the jacobian of @xmath603 and @xmath611 be the hessian of @xmath603 ( @xmath612 is a rank @xmath98 tensor ) .",
    "if @xmath532 is in the interior of @xmath608 , then since @xmath521 optimizes @xmath613 we have @xmath614 we will now argue that equality ( [ e : j ] ) remains true even when @xmath532 is on the boundary of @xmath608 .",
    "function @xmath615 is a polynomial function of the coordinates of @xmath532 .",
    "the coordinates of @xmath615 sum to the constant @xmath34 function .",
    "we assumed that @xmath616 is strictly positive and hence for all @xmath521 in a small neighborhood of @xmath532 we have that @xmath617 is still a distribution ( note that @xmath521 can be outside of @xmath608 ) .",
    "suppose that @xmath618",
    ". then there exists @xmath619 such that @xmath620 .",
    "this contradicts the fact that the maximum ( over all distributions @xmath621 of @xmath622 is achieved at @xmath623 . thus ( [ e : j ] ) holds .",
    "if we perturb @xmath50 by @xmath624 and @xmath532 by @xmath619 the likelihood changes as follows : @xmath625 where in the third step we used and in the last step we used ( [ e : j ] ) . in terms of @xmath626 defined in the statement of the theorem",
    "we have @xmath627    we will now prove that @xmath588 is negative definite .",
    "first note that we assumed that @xmath588 is full - rank , thus all of its eigenvalues are non - zero .",
    "moreover , @xmath586 is maximized for @xmath628 . plugging @xmath70 into",
    ", we obtain @xmath629 hence , if @xmath588 was not negative definite , then it would have at least one positive eigenvalue .",
    "let @xmath630 denote the corresponding eigenvector .",
    "let @xmath619 be a sufficiently small multiple of @xmath630 .",
    "by we have @xmath631 which contradicts the earlier claim that @xmath628 maximizes @xmath632 .",
    "hence , all of the eigenvalues of @xmath588 are negative , i.e. , it is negative definite .",
    "let @xmath633 be the largest eigenvalue of @xmath588 , i.e. , closest to zero .",
    "we will use that @xmath634 .",
    "note , @xmath635 set @xmath619 so that @xmath636 is maximized .",
    "( @xmath619 is a function of @xmath55 . )",
    "now we will prove that @xmath637 .",
    "for any @xmath551 , by lemma  [ obs : epsdel ] , for all sufficiently small @xmath55 , we have @xmath638 . by and we have @xmath639    assume @xmath640 ( i.e. , assume that @xmath641 goes to zero more slowly than @xmath55 ) .",
    "then , we have @xmath642 on the other hand , we have @xmath643 since @xmath644 is negative then for sufficiently small @xmath641 ( recall we can choose any @xmath551 where @xmath638 ) , we have @xmath645    thus we may restrict ourselves to @xmath619 such that @xmath646 . hence @xmath647    the maximum of @xmath648 occurs at @xmath649 ; for this @xmath650 the value of ( [ e : ce ] ) is @xmath651 .",
    "therefore , @xmath652 from @xmath653 , we have @xmath654 , and hence @xmath655 this completes the proof of the first part of the lemma .",
    "it remains to prove the case when the inequality can be replaced by equality .",
    "note that in general the inequality can not be replaced by equality , since @xmath656 can be an invalid weight ( i.e. , outside of @xmath608 ) for all @xmath55 .",
    "if @xmath657 whenever @xmath594 then @xmath656 is a valid weight vector for sufficiently small @xmath55 and hence plugging directly into we have @xmath658      in this section we deal with the cfn model .",
    "we prove part [ thm : cfnbad ] of theorem  [ thm : mlebad ] .",
    "for simplicity , we first present the proof for the case @xmath659 .",
    "let @xmath278 be generated from @xmath61 with weights @xmath660 and @xmath91 be generated from @xmath61 with weights @xmath661 .",
    "let @xmath662 .",
    "note that @xmath663 fixes @xmath278 , and @xmath91 ; and @xmath664 swaps @xmath278 and @xmath91 .",
    "hence @xmath50 is invariant under @xmath665 .",
    "this simplifies many of the following calculations .",
    "one can verify that the hessian is the same for all the trees : @xmath666 the above is straightforward to verify in any symbolic algebra system , such as maple .",
    "the jacobians differ only in their last coordinate .",
    "for @xmath61 we have @xmath667 finally , @xmath668    hence , for @xmath543 , by lemma [ lem : mai ] , we have @xmath669    for @xmath88 we have @xmath670 then , @xmath671 by lemma [ lem : mai ] , we have @xmath672    for @xmath67 we have @xmath673 @xmath674 @xmath675 note that the last coordinate of @xmath676 ( in ( [ hj1 ] ) ) is positive and hence we have equality in lemma  [ lem : mai ] .",
    "thus , @xmath677    the largest increase in likelihood is attained on @xmath67 .",
    "thus @xmath67 is the tree with highest likelihood for sufficiently small @xmath55 .",
    "the hessian is the same for all four - leaf trees . in this case",
    "we state the inverse of the hessian which is simpler to state than the hessian itself .",
    "we have @xmath678 the first @xmath94 coordinates of the jacobians are equal and have the same value for all trees : @xmath679 thus for each tree we will only list the last coordinate of the jacobian @xmath680 which we denote as @xmath681 $ ] .",
    "let @xmath682 note that @xmath683 and @xmath684 for @xmath685 .    for @xmath67",
    "we have @xmath686=\\frac{1}{\\beta}\\cdot 128c^2(16c^6 - 24c^4 + 17c^2 + 1),\\ ] ] @xmath687 and the last coordinate of @xmath676 is @xmath688 it is easily checked that @xmath689 is positive for @xmath63 and hence we have equality in lemma  [ lem : mai ] .    for @xmath88 we have @xmath686=\\frac{1}{\\beta}\\cdot 128c^4(16c^4 - 40c^2 - 7),\\ ] ] @xmath690    for @xmath61 we have @xmath686=\\frac{1}{\\beta}\\cdot 256c^4(16c^4 - 8c^2 - 3),\\ ] ] @xmath691    it remains to show that @xmath692 and @xmath693 .",
    "we know that for @xmath659 the inequalities hold .",
    "thus we only need to check that @xmath694 and @xmath695 do not have roots for @xmath685 .",
    "this is easily done using sturm sequences , which is a standard approach for counting the number of roots of a polynomial in an interval .",
    "our technique requires little additional work to extend the result to jc , k2 , and k3 models .",
    "let jc - likelihood of tree @xmath0 on distribution @xmath50 be the maximal likelihood of @xmath112 over all labelings of @xmath154 , in the jc model .",
    "similarly we define k2-likelihood and k3-likelihood .",
    "note that k3-likelihood of a tree is greater or equal to its k2-likelihood which is greater or equal to its jc - likelihood . in the following",
    "we will consider a mixture distribution generated from the jc model , and look at the likelihood ( under a non - mixture ) for jc , k2 and k3 models .",
    "for the k3 model , the transition matrices are of the form @xmath696 with @xmath697 , @xmath698 , and @xmath699 .",
    "the k2 model is the case @xmath451 , the jc model is the case @xmath700 .",
    "[ mlebadother ] let @xmath701 and @xmath702 .",
    "let @xmath66 denote the following mixture distribution on @xmath61 generated from the jc model : @xmath703 there exists @xmath64 such that for all @xmath65 the jc - likelihood of @xmath67 on @xmath66 is higher than the k3-likelihood of @xmath88 and @xmath61 on @xmath66 .",
    "note , part [ thm : jcbad ] of theorem  [ thm : mlebad ] for the jc , k2 , and k3 models is immediately implied by theorem  [ mlebadother ] .",
    "first we argue that in the jc model @xmath67 is the most likely tree . as in the case for the cfn model , because of symmetry , we have the same hessian for all trees .",
    "@xmath704 again the jacobians differ only in the last coordinate .    for @xmath61 :",
    "@xmath705 then , @xmath706    for @xmath88 : @xmath707 then , @xmath708    for @xmath67 : @xmath709 @xmath710 note , again the last coordinate is positive as required for the application of lemma  [ lem : mai ] .",
    "finally , @xmath711    now we bound the k3-likelihood of @xmath88 and @xmath61 .",
    "the hessian matrix is now @xmath712 .",
    "it is the same for all the @xmath94-leaf trees and has a lot of symmetry .",
    "there are only @xmath295 different entries in @xmath588 . for distinct @xmath713",
    "$ ] we have @xmath714 @xmath715 @xmath716 for @xmath61 , its jacobian @xmath680 is a vector of 15 coordinates .",
    "it turns out that @xmath717 is the concatenation of 3 copies of the jacobian for the jc model which is stated in .",
    "finally , we obtain @xmath718    for @xmath88 we again obtain that for its jacobian @xmath680 , @xmath717 is the concatenation of @xmath98 copies of .",
    "then , @xmath719    finally , for @xmath67 , for its jacobian @xmath680 , @xmath717 is the concatenation of @xmath98 copies of ( [ j1 ] ) and @xmath676 is the concatenation of @xmath98 copies of .",
    "then , @xmath720    note the quantities @xmath721 are the same in the k3 model are the same as the corresponding quantities in the jc model .",
    "it appears that even though the optimization is over the k3 parameters , the optimum assignment is a valid setting for the jc model .",
    "observe that @xmath722 for @xmath67 in the jc model ( see ) is larger than for @xmath88 and @xmath61 in the @xmath723 model ( see and ) .",
    "applying lemma [ lem : mai ] , this completes the proof of theorem [ mlebadother ] .",
    "the following section has a distinct perspective from the earlier sections . here",
    "we are generating @xmath724 samples from the distribution and looking at the complexity of reconstructing the phylogeny .",
    "the earlier sections analyzed properties of the generating distribution , as opposed to samples from the distribution .",
    "in addition , instead of finding the maximum likelihood tree , we are looking at sampling from the posterior distribution over trees . to do this",
    ", we consider a markov chain whose stationary distribution is the posterior distribution , and analyze the chain s mixing time .",
    "for a set of data @xmath725 where @xmath726 , its likelihood on tree @xmath0 with transition matrices @xmath24 is @xmath727    let @xmath728 denote a prior density on the space of trees where @xmath729 our results extend to priors that are lower bounded by some @xmath730 as in mossel and vigoda @xcite . in particular , for all @xmath731 , we require @xmath732 .",
    "we refer to these priors as @xmath569-regular priors .    applying bayes law we get the posterior distribution : @xmath733",
    "note that for uniform priors the posterior probability of a tree given @xmath734 is proportional to @xmath735 .",
    "each tree @xmath0 then has a posterior weight @xmath736    we look at markov chains on the space of trees where the stationary distribution of a tree is its posterior probability .",
    "we consider markov chains using nearest - neighbor interchanges ( nni ) .",
    "the transitions modify the topology in the following manner which is illustrated in figure [ fig : nni ] .",
    "let @xmath737 denote the tree at time @xmath95 .",
    "the transition @xmath738 of the markov chain is defined as follows .",
    "choose a random internal edge @xmath739 in @xmath117 .",
    "internal vertices have degree three , thus let @xmath740 denote the other neighbors of @xmath741 and @xmath742 denote the other neighbors of @xmath549 .",
    "there are three possible assignments for these 4 subtrees to the edge @xmath8 ( namely , we need to define a pairing between @xmath743 ) .",
    "choose one of these assignments at random , denote the new tree as @xmath536 .",
    "we then set @xmath744 with probability @xmath745 with the remaining probability , we set @xmath746 .",
    "the acceptance probability in is known as the metropolis filter and implies that the unique stationary distribution @xmath7 of the markov chain statisfies , for all trees @xmath0 : @xmath747    we refer readers to felsenstein @xcite and mossel and vigoda @xcite for a more detailed introduction to this markov chain .",
    "we are interested in the mixing time @xmath748 , defined as the number of steps until the chain is within variation distance @xmath749 of the stationary distribution .",
    "the constant @xmath262 is somewhat arbitrary , and can be reduced to any @xmath750 with @xmath751 steps .    for the mcmc result",
    "we consider trees on 5 taxa .",
    "thus trees in this section will have leaves numbered @xmath752 and internal vertices numbered @xmath753 .",
    "let @xmath754 denote the tree @xmath755 .",
    "thus , @xmath754 has edges @xmath756 , @xmath757 , @xmath758 , @xmath759 , @xmath760 , @xmath761 , @xmath762 .",
    "we will list the transition probabilities for the edges of @xmath754 in this order .",
    "for the cfn model , we consider the following vector of transition probabilities .",
    "let @xmath763 where @xmath764    for the jc model , let @xmath765 where @xmath766    let @xmath767 and @xmath768 .",
    "we are interested in the mixture distribution : @xmath769 let @xmath770 denote the tree @xmath771 .",
    "the key lemma for our markov chain result states that under @xmath50 , the likelihood has local maximum , with respect to nni connectivity , on @xmath772 and @xmath770 .",
    "[ lem : mcmc - mle ] for the cfn and jc models , there exists @xmath64 such that for all @xmath65 then for all trees @xmath117 that are one nni transition from @xmath772 or @xmath770 , we have @xmath773    this then implies the following corollary .",
    "[ thm : mcmc - main ] there exist a constant @xmath774 such that for all @xmath552 the following holds .",
    "consider a data set with @xmath724 characters , i.e. , @xmath725 , chosen independently from the distribution @xmath50 .",
    "consider the markov chains on tree topologies defined by nearest - neighbor interchanges ( nni ) . then with probability @xmath775 over the data generated ,",
    "the mixing time of the markov chains , with priors which are @xmath569-regular , satisfies @xmath776    the novel aspect of this section is lemma  [ lem : mcmc - mle ] .",
    "the proof of theorem  [ thm : mcmc - main ] using lemma  [ lem : mcmc - mle ] is straightforward .",
    "the proof follows the same lines as the proof of theorems [ thm : mlebad ] and [ mlebadother ] .",
    "thus our main task is to compute the hessian and jacobians , for which we utilize maple .",
    "we begin with the cfn model .",
    "the hessian is the same for all @xmath222 trees on 5-leaves : @xmath777    we begin with the two trees of interest : +    ( 80,60)(0,0 ) ( 10,9)(0,15)3 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)5 ( 70,9)(0,15)4 ( 10,41)(0,15)2 ( 70,41)(0,15)1    and     ( 80,60)(0,0 ) ( 10,9)(0,15)2 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)5 ( 70,9)(0,15)4 ( 10,41)(0,15)1 ( 70,41)(0,15)3    their jacobian is @xmath778 thus , @xmath779 note the last two coordinates are positive , hence we get equality in the conclusion of lemma  [ lem : mai ] .",
    "finally , @xmath780    we now consider those trees connected to @xmath772 and @xmath770 by one nni transition . since there are 2 internal edges each tree has 4 nni neighbors",
    "the neighbors of @xmath772 are    ( 80,60)(0,0 ) ( 10,9)(0,15)4 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)2 ( 70,9)(0,15)5 ( 10,41)(0,15)3 ( 70,41)(0,15)1    ( 80,60)(0,0 ) ( 10,9)(0,15)4 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)1 ( 70,9)(0,15)5 ( 10,41)(0,15)3 ( 70,41)(0,15)2    ( 80,60)(0,0 ) ( 10,9)(0,15)2 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)3 ( 70,9)(0,15)5 ( 10,41)(0,15)1 ( 70,41)(0,15)4    ( 80,60)(0,0 ) ( 10,9)(0,15)2 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)4 ( 70,9)(0,15)5 ( 10,41)(0,15)1 ( 70,41)(0,15)3    the neighbors of @xmath770 are    ( 80,60)(0,0 ) ( 10,9)(0,15)3 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)1 ( 70,9)(0,15)5 ( 10,41)(0,15)2 ( 70,41)(0,15)4    ( 80,60)(0,0 ) ( 10,9)(0,15)3 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)4 ( 70,9)(0,15)5 ( 10,41)(0,15)2 ( 70,41)(0,15)1    ( 80,60)(0,0 ) ( 10,9)(0,15)4 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)2 ( 70,9)(0,15)5 ( 10,41)(0,15)1 ( 70,41)(0,15)3    ( 80,60)(0,0 ) ( 10,9)(0,15)4 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)3 ( 70,9)(0,15)5 ( 10,41)(0,15)1 ( 70,41)(0,15)2    the jacobian for all 8 of these trees is @xmath781 finally , @xmath782    note the quantities @xmath722 are larger for the two trees @xmath772 and @xmath770 .",
    "this completes the proof for the cfn model .",
    "we now consider the jc model . again",
    "the hessian is the same for all the trees : @xmath783    beginning with tree @xmath772    ( 80,60)(0,0 ) ( 10,9)(0,15)2 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)5 ( 70,9)(0,15)4 ( 10,41)(0,15)1 ( 70,41)(0,15)3    we have : @xmath784 the last two coordinates of @xmath676 are @xmath785 since they are positive we get equality in the conclusion of lemma [ lem : mai ] .",
    "finally , @xmath786    for the neighbors of @xmath772 :    ( 80,60)(0,0 ) ( 10,9)(0,15)4 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)1 ( 70,9)(0,15)5 ( 10,41)(0,15)3 ( 70,41)(0,15)2    ( 80,60)(0,0 ) ( 10,9)(0,15)4 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)2 ( 70,9)(0,15)5 ( 10,41)(0,15)3 ( 70,41)(0,15)1    ( 80,60)(0,0 ) ( 10,9)(0,15)2 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)3 ( 70,9)(0,15)5 ( 10,41)(0,15)1 ( 70,41)(0,15)4    ( 80,60)(0,0 ) ( 10,9)(0,15)2 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)4 ( 70,9)(0,15)5 ( 10,41)(0,15)1 ( 70,41)(0,15)3    we have : @xmath787 hence , @xmath788    considering @xmath770 :    ( 80,60)(0,0 ) ( 10,9)(0,15)3 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)5 ( 70,9)(0,15)4 ( 10,41)(0,15)2 ( 70,41)(0,15)1    @xmath789 the last two coordinates of @xmath676 are @xmath790 which are positive . finally , @xmath791    considering the neighbors of @xmath770 :    ( 80,60)(0,0 ) ( 10,9)(0,15)4 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)2 ( 70,9)(0,15)5 ( 10,41)(0,15)1 ( 70,41)(0,15)3    ( 80,60)(0,0 ) ( 10,9)(0,15)4 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)3 ( 70,9)(0,15)5 ( 10,41)(0,15)1 ( 70,41)(0,15)2    ( 80,60)(0,0 ) ( 10,9)(0,15)3 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)1 ( 70,9)(0,15)5 ( 10,41)(0,15)2 ( 70,41)(0,15)4    ( 80,60)(0,0 ) ( 10,9)(0,15)3 ( 10,23)(1,1)10 ( 70,43)(-1,-1)10 ( 70,23)(-1,1)10 ( 10,43)(1,-1)10 ( 20,33)(1,0)40 ( 40,33)(0,-1)10 ( 40,9)(0,15)4 ( 70,9)(0,15)5 ( 10,41)(0,15)2 ( 70,41)(0,15)1    we have : @xmath792 hence , @xmath793    in fact @xmath772 and @xmath770 have larger likelihood than any of the 13 other 5-leaf trees .",
    "however , analyzing the likelihood for the 5 trees not considered in the proof of lemma [ lem : mcmc - mle ] requires more technical work since @xmath722 is maximized at invalid weights for these 5 trees .",
    "we now show how the main theorem of this section easily follows from the above lemma .",
    "the proof follows the same basic line of argument as in mossel and vigoda @xcite , we point out the few minor differences .    for a set of characters @xmath794 , define the maximum log - likelihood of tree @xmath0 as @xmath795 where @xmath796    consider @xmath794 where each @xmath797 is independently sampled from the mixture distribution @xmath50 .",
    "let @xmath798 be @xmath772 or @xmath770 , and let @xmath117 be a tree that is one nni transition from @xmath798 .",
    "our main task is to show that @xmath799 .",
    "let @xmath800 denote the assignment which attains the maximum for @xmath801 , and let @xmath802    for @xmath803 , let @xmath804 . by chernoff s inequality ( e.g. , ( * ? ? ?",
    "* remark 2.5 ) ) , and a union bound over @xmath803 , we have for all @xmath551 , @xmath805 assuming the above holds , we then have @xmath806 and , @xmath807 let @xmath808 note , lemma [ lem : mcmc - mle ] states that @xmath684 .",
    "set @xmath809 .",
    "note , @xmath810 .",
    "hence , @xmath811    this then implies that @xmath812 with probability @xmath813 by the same argument as the proof of lemma 21 in mossel and vigoda @xcite .",
    "then , the theorem follows from a conductance argument as in lemma 22 in @xcite .",
    "we thank elchanan mossel for useful discussions , and john rhodes for helpful comments on an early version of this paper .",
    "p. buneman .",
    "the recovery of trees from measures of dissimilarity , in : f. r. hodson , d. g. kendall , p. tautu ( eds . ) , _ mathematics in the archaeological and historical sciences _ , edinburgh university press , edinburgh , 387 - 395 , 1971 .",
    "i. i. hellmann , i. ebersberger , s. e. ptak , s. pbo , and m. przeworski . a neutral explanation for the correlation of diversity with recombination rates in humans .",
    "_ , 72:1527 - 1535 , 2003 .",
    "e. mossel and e. vigoda . limitations of markov chain monte carlo algorithms for bayesian inference of phylogeny . to appear in _ annals of applied probability_. preprint available from arxiv at http://arxiv.org/abs/q-bio.pe/0505002      j. s. rogers .",
    "maximum likelihood estimation of phylogenetic trees is consistent when substitution rates vary according to the invariable sites plus gamma distribution .",
    "_ systematic biololgy _ , 50(5):713 - 722 , 2001 ."
  ],
  "abstract_text": [
    "<S> we address phylogenetic reconstruction when the data is generated from a mixture distribution . </S>",
    "<S> such topics have gained considerable attention in the biological community with the clear evidence of heterogeneity of mutation rates . in our work </S>",
    "<S> we consider data coming from a mixture of trees which share a common topology , but differ in their edge weights ( i.e. , branch lengths ) . </S>",
    "<S> we first show the pitfalls of popular methods , including maximum likelihood and markov chain monte carlo algorithms . </S>",
    "<S> we then determine in which evolutionary models , reconstructing the tree topology , under a mixture distribution , is ( im)possible . </S>",
    "<S> we prove that every model whose transition matrices can be parameterized by an open set of multi - linear polynomials , either has non - identifiable mixture distributions , in which case reconstruction is impossible in general , or there exist linear tests which identify the topology . </S>",
    "<S> this duality theorem , relies on our notion of linear tests and uses ideas from convex programming duality . </S>",
    "<S> linear tests are closely related to linear invariants , which were first introduced by lake , and are natural from an algebraic geometry perspective . </S>"
  ]
}