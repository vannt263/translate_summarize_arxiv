{
  "article_text": [
    "physical - chemical processes taking place in liquid solution are ubiquitous , and are at the heart of a wide variety of applications .",
    "electro - chemical reactions , surfactants adsorption , self - assembly , crystal nucleation and growth , are just a handful of such applications . however , in many cases , a detailed description of the molecular mechanisms at play during these processes is still lacking .",
    "molecular dynamics ( md ) represents a powerful method for investigating such processes with atomistic detail .",
    "however md suffers from many limitations such as the relatively small time and size scales that can be simulated . with the presently available computational resources , classical md calculations , based on empirical potentials ,",
    "can typically study systems of size up to @xmath2 atoms .",
    "such size limitations are particularly dramatic in the simulation of phase transformations , as in the paradigmatic case of crystal growth from solution . in such a case , while the crystallization proceeds , the solution is depleted , thus changing its chemical potential and affecting the growth process itself . for this reason md results require",
    "seizable finite - size corrections before being compared with the experimental results , which involve much larger system sizes @xcite .    in general , the numerical approach to prevent such finite size problems",
    "is that of sampling configurations in the gran - canonical ( gc ) ensemble , namely simulating a system in contact with an external reservoir , which maintains the chemical potential constant .",
    "however , the classical methods for gc sampling @xcite require on - the - fly insertion and removal of particles .",
    "this constitutes a crucial obstacle for chemical processes in solution , since the probability of a successful particle insertion in a dense fluid is extremely low @xcite , preventing efficient numerical studies .",
    "recently , the development of adaptive resolution simulation methods adress ( see e.g.  ref .   and references therein ) and @xmath3-adress @xcite has lead to an alternative path to md simulation in the gc ensemble . in these methods the region of primary interest is described with atomistic detail , while its surroundings are treated through a lower resolution model .",
    "it has been shown that the low resolution region can act as an external molecule reservoir , enforcing the sampling of the gc ensemble in the atomistically resolved region . moreover , in this low resolution region , particle - insertion or swapping techniques can be applied more efficiently@xcite .    here ,",
    "inspired by this approach , we use an analogous volume subdivision and implement a method that addresses the problem of solution depletion in md simulations . to be more definite , we focus our attention on the simulation of crystal growth from solution , which lately has received much attention @xcite and for which the pitfalls of limited size numerical modeling have been underlined @xcite .",
    "nonetheless we stress that the present method can be applied to many other systems .    in our scheme the region containing the growing crystal and its immediate surroundings",
    "is maintained at constant solution concentration , while the remainder of the simulation box acts as a molecular reservoir . in this way we are able to study the crystal as it grows or dissolves in contact with a solution at constant chemical potential .",
    "the paper is organized as follows : first , in sec .",
    "[ mustat ] , our method is introduced and described in detail .",
    "after that we apply it to the crystallization of urea in aqueous solution .",
    "the technical details of the calculations are presented in sec .",
    "[ simsetup ] .",
    "then , in sec .",
    "[ growth ] , the simulation results are illustrated and discussed . finally , sec .",
    "[ concl ] is devoted to the conclusions and possible perspectives of our work .",
    "qualitative behavior of the solute local density in the vicinity of a planar crystal surface .",
    "the blue , vertical line indicates the solid - liquid interface position at @xmath4 .",
    "the light blue shaded area corresponds to the tr , defined in the text . within this region ,",
    "the dashed line is explanatory and non - representative of the realistic @xmath5 behavior.,title=\"fig : \" ] +    in the present section we describe in detail our new method , named constant chemical potential md ( c@xmath0md ) , which allows to perform md of chemical processes in a solution at constant chemical potential . in order to illustrate the method we focus on the problem of crystal growth in a binary solution , while in principle any first order phase transition can be considered .",
    "moreover , for the sake of simplicity , we consider a planar crystal - solution interface .",
    "extension to other geometries is possible , although rather more complicated .    in fig .",
    "[ scha ] we show a qualitative description of the local solute density @xmath5 in the neighborhood of the crystal - solution interface , located at @xmath6 . to the left of the interface",
    "there is the crystal region , characterized by the solid density @xmath7 . on the other side of @xmath6",
    "we find a transition region ( tr ) , of length @xmath8 , in which the growth process takes place .",
    "the extension of the tr is such that for @xmath9 the density reaches its bulk value @xmath10 . the @xmath5 profile within the tr depends on the kinetics of crystallization and on the diffusivity of the liquid , and can not be easily guessed a priori .",
    "here we are implicitly assuming the considered transition does not involve macroscopic correlation lengths , so that @xmath8 is finite .    during crystal growth or dissolution , the solid - liquid interface moves together with the tr . in a macroscopic system @xmath10",
    "remains unchanged and the density at the boundaries of the tr is constant , leading to a stationary growth process .",
    "this is in contrast with the behavior of a finite - size system , in which @xmath10 varies due to the limited number of molecules .",
    "same profile displayed in fig .",
    "[ scha ] , with the addiction of an external force @xmath11 applied at @xmath12 ( green vertical line ) .",
    "the green shaded area corresponds to the transition region connecting the cr and the reservoir .",
    "also in this case the dashed profiles are purely explanatory .",
    ", title=\"fig : \" ] +    our method aims at restoring this stationarity condition , enforcing a constant solution composition in a control region ( cr ) in contact with the tr , while the rest of the solution volume is used as a molecule reservoir , as shown in fig .  [ schb ] . to control the solution density ,",
    "an external force @xmath11 is applied at a fixed distance @xmath13 from the moving crystal interface .",
    "@xmath11 acts as a membrane , regulating the flux of molecules between the cr and the reservoir , in order to maintain the former at a constant concentration .",
    "if we assume that the effect of the external force is felt in a region of size @xmath14 , the cr is located between @xmath15 and @xmath16 . in order not to affect the growth process",
    "the cr should be larger than the typical correlation lengths of the solution .",
    "we stress the fact that the force is applied at a fixed distance from the solid - liquid interface , to maintain a stationary solution environment in the proximity of the growing crystal interface .    as the crystallization proceeds the reservoir",
    "is depleted , so that the chemical potential can only be maintained for a limited amount of time @xmath17 .",
    "in general , when applying the c@xmath0md technique to some molecular process , this time limit must be taken into account , and the simulation box has to be properly engineered so that @xmath11 is able to act efficiently during the timescale of interest .",
    "we write the external force @xmath11 as : @xmath18 where @xmath19 labels the solute or solvent species , @xmath20 is a force constant , @xmath21 is a target density and @xmath22 is a bell - shaped function which is nonzero in the vicinity of the force center @xmath23 .",
    "( [ fb ] ) defines a harmonic - like force , localized at a fixed distance @xmath13 from the solid , which acts on the solution molecules to compensate the deviations of the instantaneous cr density @xmath24 from @xmath21 .",
    "if @xmath25 is the total number of @xmath19-species molecules and @xmath26 the cr volume , we evaluate @xmath24 as : @xmath27 where : @xmath28 is a function that selects the molecules inside the cr . in the practice , we let @xmath29 switch continuously to 0 at the cr boundaries , in order to avoid sudden jumps in @xmath24 .",
    "we then define the function @xmath30 , localizing the action of @xmath11 close to the force center @xmath31 , as : @xmath32^{-1}.\\ ] ] @xmath33 is nonzero only for @xmath34 , with an intensity peak proportional to @xmath35 and a width proportional to @xmath36 .",
    "we observe that @xmath11 is non - conservative , since it is not possible to define a potential function that leads to eq .",
    "( [ fb ] ) .    as a further remark",
    "we note that eq .",
    "( [ fb ] ) defines two separate forces acting on the solute and solvent species . in principle",
    "the concentration of both species affects the chemical potential of the solution @xcite and should be controlled .",
    "however , we are mainly interested in constant pressure simulations , where only a single population needs to be subject to @xmath11 , because the action of the barostat algorithm @xcite guarantees a prompt equilibration of the other species concentration .",
    "if instead an nvt dynamics is considered , @xmath11 should act on both solute and solvent species .    to conclude this section",
    "let us summarize the c@xmath0md scheme in explicit algorithm steps :    1 .",
    "the solid - liquid interface position @xmath6 is located on - the - fly analyzing the solvent molecules distribution within the box , 2 .",
    "the force center @xmath31 , is updated maintaining a fixed distance @xmath13 from @xmath6 , and the cr position is shifted accordingly , 3 .",
    "the densities @xmath24 are evaluated via eq .",
    "( [ ni ] ) .",
    "4 .   the md equations of motions , including the external forces of eq .  ( [ fb ] ) , are integrated .",
    "we recall once again that this method is effective for a finite validity time @xmath17 , depending on the availability of molecules in the reservoir .",
    "in the present section we introduce the typical setup of our calculations .",
    "we considered here the case of a urea crystal growing in aqueous solution in slab geometry , as shown in fig .",
    "the system is generated starting from an approximately @xmath37 thick crystal slab , periodically repeated in the @xmath38 and @xmath39 directions .",
    "along @xmath40 , the slab exposes either the @xmath41 or the @xmath42 face , the two stable faces in urea crystal growth from aqueous solution @xcite .",
    "such a crystal is immersed in a supersaturated solution , generated by means of the packmol @xcite and genbox ( gromacs package ) utilities .",
    "the typical size of the simulation box is of @xmath43 , periodic boundary conditions ( pbc ) are applied in the @xmath38,@xmath39 and @xmath40 directions .",
    "the number of urea and of water molecules for each simulated system is reported in tab .",
    "the initial solute concentration has to be larger than the target concentration , to allow a stationary growth regime for a timescale of @xmath44 ns .     typical simulation box for the study of urea crystal growth in aqueous solution .",
    "the vertical lines indicate the force center @xmath31 , where @xmath11 is applied ( see eq .",
    "( [ fb ] ) ) , located at both sides of the slab , at distance @xmath13 from the crystal interfaces .",
    "the gray - shaded areas indicate the cr.,title=\"fig : \" ] +    following our previous work @xcite , we use the generalized amber force field ( gaff ) @xcite to model urea , and the tip3p model @xcite for water .",
    "the molecular bonds are constrained through the lincs algorithm @xcite and long range electrostatics is handled by means of particle mesh ewald ( pme ) method @xcite .",
    "the system is kept at a constant temperature of @xmath45 k and pressure of @xmath46 bar by using the stochastic velocity rescaling thermostat @xcite and the parrinello - rahman barostat @xcite .",
    "because of the planar symmetry , the barostat is applied in its semi - isotropic version , so that the @xmath40-side of the box , parallel to the growth direction , is rescaled separately from the @xmath38 and @xmath39 sides .",
    "since the system is rescaled during the dynamics , also the c@xmath0md length parameters , as e.g.  @xmath13 , have to be rescaled accordingly .",
    "our implementation redefines the lengths on - the - fly , following the fluctuations of the @xmath40-edge of the box . in the considered simulations",
    "@xmath11 does not affect the pressure of the system by a significant amount , since it determines a surface effect , small compared to the potential and kinetic bulk contributions .",
    "for this reason in the presented results we did not couple the external force with the barostat equations .",
    "[ cols=\"^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     to answer this question in fig .",
    "[ sigmak ] we report the local standard deviation @xmath47 of @xmath48 . while at distances @xmath49 nm from the interface the @xmath50 runs exhibit a different @xmath51 behavior compared to the npt@xmath52 case , this difference is much mitigated as we get closer to the solid - liquid interface .",
    "this analysis suggests that , for this system , the choice of @xmath53 does not affect significantly the composition fluctuations of the solution in contact with the crystal . as a result",
    "it is preferable to choose a large @xmath53 , which entails a more effective control on the cr .",
    "logarithmic plot of the @xmath54 standard deviation , for the @xmath50 and npt@xmath52 runs .",
    "each value is measured by detecting @xmath5 within a @xmath55 nm thick layer placed at a distance @xmath56 from the solid - liquid interface .",
    "the dashed vertical lines indicate the cr boundaries.,title=\"fig : \" ] +    as a last remark we underline that in this study @xmath11 was applied exclusively to the urea specie .",
    "however the results are still useful when the restraining force acts on the water population , provided that @xmath57 is rescaled according to the typical @xmath58 fluctuations .",
    "in this section we report the additional material concerning the md calculations presented in sec .  4 of the ms .",
    "we organize the information in two sub - sections , concerning the growth processes of the @xmath41 and @xmath42 faces of urea .",
    "+    for the study of @xmath41 face growth we have performed two sets of simulations , named @xmath60 and @xmath61 ( see tab .",
    "i of ms ) . in the first one the urea population is controlled , while in the second water is controlled .",
    "the results of the @xmath60 set are reported in the ms , here we show the results of the @xmath61 runs , in fig .  [ g001si ] , compared to the ordinary npt dynamics .",
    "also in this set of simulations the c@xmath0md method succeeds in establishing a linear growth regime , even though the control of @xmath38 is less rigid and allows larger fluctuations .",
    "the dependence of the growth rates extracted from both the @xmath60 and @xmath61 simulations on the corresponding solution mole fraction has been assessed with a linear fit , represented in fig .",
    "5 of the ms .",
    "the parameters resulting from the interpolation are the following : @xmath62 where the linear model is @xmath63 .",
    "+    for the study of @xmath42 face growth the @xmath65 and @xmath66 simulation sets have been performed , the relative parameters are shown in tab .",
    "each set is constituted by 5 repetitions of the same simulations , in order to collect a relevant statistics for the presented analysis .",
    "moreover , the c@xmath0md settings have been designed so that both @xmath65 and @xmath66 simulations reach analogous growth conditions .",
    "for this reason , in our analysis , we have considered the results of the @xmath65 and @xmath66 runs as equivalent . in the multiple plot of fig .",
    "[ g110si ] we report the resulting dynamics of each simulation .    in the ms we have reported the estimate of the @xmath42 face growth rate , obtained from the trajectories displayed in fig .  [ g110si ] . as explained in the text , under constant supersaturation conditions we can assume that the probability of growth events occurrence follows a poisson distribution .",
    "therefore the waiting time between two consecutive events is exponentially distributed , and the growth rate can be extracted from this distribution . to this purpose",
    "the time intervals between two consecutive growth events have been collected .",
    "we have considered only those events occurring within the validity time of c@xmath0md , during which the growth could be considered at constant supersaturation .",
    "we have also discarded the waiting time preceding the first event , since it is affected by the initial transient time , during which the solution is brought at the desired composition .    from the resulting statistics",
    "we have then constructed the cumulative time distribution , and fitted it with the cumulative distribution associated to an exponential probability density : @xmath67 from the fit we have extracted @xmath68 ns ( as shown in fig .",
    "7 of the ms ) .",
    "the corresponding error has been obtained with the bootstrap technique @xcite .",
    "the growth rate has been estimated by calculating the average @xmath69 increase associated to the growth events ( @xmath70 ) , and dividing it by @xmath71 , to obtain the result reported in the ms .    1",
    "h.  flyvbjerg and h.  g. petersen , `` error estimates on averages of correlated data , '' _ the journal of chemical physics _ , vol .  91 , no .  1 , 1989"
  ],
  "abstract_text": [
    "<S> molecular dynamics studies of chemical processes in solution are of great value in a wide spectrum of applications , which range from nano - technology to pharmaceutical chemistry . however , </S>",
    "<S> these calculations are affected by severe finite - size effects , such as the solution being depleted as the chemical process proceeds , which influence the outcome of the simulations . to overcome these limitations </S>",
    "<S> , one must allow the system to exchange molecules with a macroscopic reservoir , thus sampling a grand - canonical ensemble . despite the fact that different remedies have been proposed , this still represents a key challenge in molecular simulations .    in the present work we propose the constant chemical potential molecular dynamics ( c@xmath0md ) method , which introduces an external force that controls the environment of the chemical process of interest . </S>",
    "<S> this external force , drawing molecules from a finite reservoir , maintains the chemical potential constant in the region where the process takes place . </S>",
    "<S> we have applied the c@xmath0md method to the paradigmatic case of urea crystallization in aqueous solution . as a result </S>",
    "<S> , we have been able to study crystal growth dynamics under constant supersaturation conditions , and to extract growth rates and free - energy barriers . </S>",
    "<S> @xmath1 +    _ j.  chem .  </S>",
    "<S> phys .  </S>",
    "<S> 142 ,  144113 ( 2015 ) ; http://dx.doi.org/10.1063/1.4917200_ </S>"
  ]
}