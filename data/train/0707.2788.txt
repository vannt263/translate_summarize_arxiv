{
  "article_text": [
    "curve fitting plays a central role in the analysis of lattice simulation data .",
    "one of the most important and common uses of curve fitting in lattice gauge theory is the extraction of hadronic masses and matrix elements from measured correlation functions .    the problem of extracting the mass spectrum from the correlators measured in lattice qcd simulations is well known @xcite .",
    "the simulation produces data @xmath1 for the expectation values of the correlator @xmath2 at a finite number of discrete ( euclidean ) time steps @xmath3 , @xmath4 . on the other hand , from theory the exact form of the propagator",
    "is known to be given by an infinite series @xmath5 where we will assume that the energy levels are ordered , @xmath6 .",
    "the problem is then to determine an infinite number of amplitudes @xmath7 and energies @xmath8 from only a finite number of data points @xmath9 , an obviously ill - posed problem .    to make the problem well - posed , we have to add some further physical constraints .",
    "the piece of theoretical information that is normally used is that the sequence of the @xmath10 is bounded from above , and therefore the correlator will be dominated by the lowest few terms at all but the smallest values of @xmath11 due to the exponential suppression by @xmath12 .",
    "we can therefore truncate the series in equation  ( [ eqn : thform ] ) after a finite number of terms , provided we only attempt to fit at @xmath13 large enough for the truncation to include all terms that make a significant contribution .",
    "in doing so , we are faced with a choice : either take a fixed number @xmath14 of terms of the sum in ( [ eqn : thform ] ) and adjust @xmath15 so as to obtain a good fit , or fix @xmath15 and vary @xmath14 so as to extract the largest possible amount of significant information .",
    "the problem with the first strategy is that we are throwing away valuable information contained in the data points at @xmath16 , leading to large statistical errors if @xmath15 is chosen too big .",
    "these need to be balanced against large systematic errors arising if @xmath15 is chosen too small for the given @xmath14@xcite . in this paper",
    "we will therefore adopt the second approach and attempt to fit all data points ( excluding only the single point at @xmath17 for practical reasons ) with a variable number @xmath14 of exponentials .",
    "naively , one might want to try to simply run a series of fits using a state - of - the art fitting method such as levenberg - marquardt @xcite at a number of different @xmath14 , and with a variety of initial parameter values , and choose the fit that produces the lowest @xmath0 per degree of freedom .",
    "this method can be made to work in the case of one single correlator if the problem of finding an appropriate starting point in a potentially multi - modal landscape is somehow solved .",
    "however , for many questions in lattice qcd it is necessary to fit multiple correlators , which may or may not share some of the energy levels @xmath12 . in this case",
    ", the fast combinatorial growth with @xmath14 of the number of possibilities of assigning shared or separate fit parameters @xmath12 to the fitting functions for the different correlators renders the application of this naive method to those problems largely impossible .",
    "the problem of choosing appropriate initial parameter values further exacerbates this approach .",
    "the current state of the art using the variable-@xmath14 approach is that taken in   @xcite where it is used in the context of a bayesian method @xcite of _ constrained curve fitting_. the latter works by adding prior information about the fit parameters and using it to constrain the fit to a smaller subset of likely parameter values out of the space of all possible values .",
    "only those parameters whose fitted values are largely independent of the priors used to constrain them are considered to be determined by the data , while the others are disregarded as having been imposed by the priors .    while it is thus possible to determine which fitted quantities are independent of , or only weakly dependent on , the priors and thus determined from the data , the idea of using some external knowledge as an input could be seen as incompatible with the notion of a first - principles determination of the quantities of interest from qcd itself , without any recourse whatsoever to empirical models . moreover , in some cases appropriate priors may not be available . under those circumstances , it becomes desirable to be able to extract some estimate of the parameters to be fitted from the data themselves , and to use this estimate as a prior in the context of a bayesian constrained fit .",
    "a number of methods to do this , such as the _ sequential empirical bayes method _ @xcite , have been used in the existing literature .    a completely different state - of - the - art approach that does not rely on prior information while allowing for extraction of a spectrum from multiple sets of data for improved statistics",
    "is the _ variational method _ @xcite .",
    "here one sets out by fixing a channel corresponding to a specific set of quantum numbers , and finds a set of appropriate linearly independent operators @xmath18 for the channel .",
    "one then calculates all diagonal @xmath19 and off - diagonal @xmath20 correlators between these operators , each operator having a corresponding form for the sink that annihilates the state created by the operator at the source .",
    "one may then use the variational method on this cross - correlator matrix @xmath21 to find a superposition of the original operators that corresponds to the lowest energy state of the channel .",
    "assuming a meson channel , the diagonal correlator of this operator may be fit by a single exponential function whose mass in the exponent is the ground state energy .",
    "operators corresponding to excited states , whose diagonal correlators ideally correspond to functions only of the excited state masses , may be produced in a similar manner @xcite .",
    "while very powerful , the variational method has a number of features that limit the scope of its applicability .",
    "firstly , the use of the variational method is facilitated by the selection of operators such that the correlator matrix is hermitian @xcite .",
    "however , in lattice simulations it is often desirable to suppress unwanted but usually present contributions from high - frequency modes by means of _ quark smearing _ of the operators @xcite . in this case",
    ", hermiticity of the correlator matrix requires smearing to be applied both at the source and the sink of the correlator , which in most cases is very expensive computationally .",
    "secondly , the variational approach also requires both source and sink operators to have the exact quantum numbers of the channel of interest , instead of the less stringent usual requirement that both operators overlap with the state of interest and that at least one of them have its exact quantum numbers .",
    "this requirement limits the selection of correlators that are usable with the variational method .",
    "finally , the variational method requires all off - diagonal correlators to be calculated .",
    "the number of needed correlators thus grows as @xmath22 , with @xmath23 the number of operators in the channel of interest .",
    "since automated generation of group theoretical operators for a given symmetry channel @xcite means that the number of operators that could be used may be rather large , this quadratic growth in computational complexity imposes further limitations .",
    "thus correlator selection may be done more judiciously without the restrictions imposed by the variational method .",
    "a different problem arises in the case where one desires to fit correlators corresponding to channels with _",
    "different _ lattice quantum numbers .",
    "an example of this occurs when the continuous rotational symmetries of a quantum theory get broken when discretizing it to a lattice . in the continuum , the rotational group has representations corresponding to arbitrary integer or half - integer angular momenta @xmath24 , but on the lattice one only retains the finite symmetry of the octahedral group .",
    "a particle of angular momentum @xmath24 will therefore appear in one or more of the lattice channels labeled by those irreducible representations of the octahedral group to which the value of @xmath24 subduces @xcite .",
    "thus a particle of integral spin will appear in some known subset of the irreps @xmath25 , @xmath26 , @xmath27 , @xmath28 and @xmath29 of the octahedral group .",
    "therefore , the extraction of the physical spectrum is complicated by the fact that a physical state s mass may lie in several lattice symmetry channels .",
    "one needs to identify in which irreps the physical state lies not only to aid in identifying its physical angular momentum @xmath24 via its subduction signature , but also to extract its mass as the latter is contained in the data in all channels in which it appears .",
    "since a state either lies within a lattice symmetry channel or it does not , the process of state identification and fitting requires an algorithm that is inherently discontinuous .",
    "as the number of resolvable states in lattice simulations increases , the need for a systematic solution to this second problem will as well .",
    "evolutionary fitting algorithms , while widely used in other areas of research @xcite , are not currently in common use in lattice qcd . in this paper , we present an application of evolutionary algorithms @xcite to the problem of extracting mass spectra from hadronic correlators . we believe that the advantages of evolutionary algorithms are particularly pertinent to this problem : evolutionary algorithms allow dynamic variation of the functional form of the fit function ( such as the number of states to be fitted ) in a natural way so as to minimize @xmath0 per degree of freedom ; the data themselves thus tell us how many states can be reliably extracted .",
    "in addition , evolutionary algorithms are inherently global optimizers and as such largely eliminate any residual dependence of the result on the initial guesses used as starting values , which may be a problem when using conventional local optimizers .",
    "furthermore , based as they are on the darwinian principle of adaptation by mutation and natural selection @xcite , evolutionary fitting methods excel at extracting information from data without the need for any external prior information . finally , evolutionary fitting is able to fit multiple correlator datasets with either identical or differing quantum numbers .    in this paper",
    "we aim to introduce lattice theorists to the possibilities and features of evolutionary fitting algorithms and to present some preliminary results from our practical implementation of such an algorithm .",
    "section [ sec_evolalg ] gives a general overview of the concepts and ideas of evolutionary algorithms .",
    "section [ sec_evsingle ] details an evolutionary algorithm that can be used to fit a single hadronic correlator , and section [ sec_evmulti ] outlines the adaptations to the algorithm that are necessary in order to fit across multiple datasets .",
    "some possible variations of the basic algorithm are explained in section [ sec_altvar ] .",
    "evolutionary computing and genetic algorithms @xcite are a very active field in computer science and numerical optimization ( cf . e.g. the review @xcite and references therein ) . by borrowing concepts from evolutionary biology ,",
    "evolutionary computing is able to harness the power of natural selection by mutation and selective breeding for the purpose of solving function optimization and related problems .",
    "the nomenclature is borrowed from evolutionary biology as well : candidate solutions are called `` organisms '' , whose internal encodings are their `` genotypes '' , the target function is referred to as `` fitness '' , and each step of the algorithm produces a new `` generation '' .",
    "a number of fine distinctions between `` genetic algorithms '' , `` evolution strategies '' , `` evolutionary programming '' and related evolutionary algorithms and methods is sometimes employed in the literature @xcite ; here we will use the term `` evolutionary algorithm '' broadly to mean any global optimization method that relies on some form of random mutation combined with selective breeding in a population of candidate solutions @xcite . from this point of view , an evolutionary algorithm consists of the following ingredients :    * a search space @xmath30 , * a fitness function @xmath31 , assumed to be bounded from above , * a mutation function @xmath32 , and * a selection function @xmath33    here @xmath23 is the ( fixed ) size of the population .",
    "both the mutation and the selection function depend on some uncorrelated white noise @xmath34 that acts as a source of randomness .",
    "the update step on a population @xmath35 is then @xmath36 the mutation function acts on each individual in a population separately , while the selection function performs comparisons in fitness between individuals , and may also involve crossover or `` sexual '' reproduction , which creates a new individual from a pair of `` parent '' individuals .",
    "the simplest selection procedure to use is straightforward `` elitist '' selection of the fittest @xmath37 individuals from a population of size @xmath23 , followed by repopulation with their pairwise offspring ( where a child is formed by random interpolation between the parameter values from either parent for each parameter ) .",
    "more sophisticated selection procedures ( such as `` roulette wheel '' , `` rank '' or `` tournament '' selection @xcite ) could be used instead . adding additional , less fit , members to the elite on the basis of genetic distance",
    "may be helpful in maintaining genetic diversity and avoiding premature convergence .",
    "if we require that the mutation function leaves the fittest individual in a population alone , thereby ensuring @xmath38 and that the selection procedure never decreases the maximum fitness within a population , @xmath39 it follows that the sequence @xmath40 is bounded from above and monotonically increasing , and hence will converge .",
    "evolutionary algorithms are inherently global optimizers , as opposed to local optimizers such as steepest descent or newton methods .",
    "this global nature is largely due to their inherent parallelism , since all organisms in a population search the fitness landscape in parallel , and also because crossover allows information learned by different organisms to be combined and propagate throughout the population .",
    "another important feature of evolutionary algorithms is their ability to optimize by varying discrete parameters ( such as the functional form of a candidate solution ) in a natural and straightforward way , something which local optimizers relying on certain smoothness assumptions about the target function can not easily do .",
    "while evolutionary algorithms have not yet become a standard tool in lattice qcd , they have previously been used for the purpose of nonperturbative landau gauge fixing @xcite and ( in combination with an accept - reject step to achieve detailed balance ) as a simulation algorithm @xcite .",
    "in other fields of physics , evolutionary fitting algorithms have been used among other things to discriminate between different susy models @xcite , to analyze resonances in @xmath41 reactions @xcite , to fit stellar spectra @xcite , to determine the mass loss rate of stellar winds @xcite , to search for extrasolar planets @xcite , to build diatomic potentials using a variational method @xcite , and to solve black - box system characterization problems in engineering @xcite . in most of these cases , just as in this work , it has been observed that combining the evolutionary algorithm with a conventional ( local ) optimization step gave the best results .",
    "we believe that the flexibility and global nature of evolutionary algorithms makes them an excellent tool for the purpose of curve fitting , especially when the exact form of the fitting function ( such as the number of exponentials to use in our case ) is subject to some kind of data - dependent uncertainty .",
    "in this and the following section we present some details of our version of an evolutionary algorithm for fitting correlation functions in lattice qcd .    for the purpose of fitting a diagonal meson correlator ,",
    "the search space is @xmath42 where @xmath43 is the temporal extent of the periodic lattice .",
    "the fitness function is @xmath44 , where the correlated @xmath0 @xcite is @xmath45 with the covariance matrix defined by @xmath46 and where @xmath47 is the number of degrees of freedom of the fit given by @xmath48.$ ] is desired , functions such as @xmath49 or @xmath50 can be used instead . ]",
    "an organism @xmath51 can therefore be represented by a list of @xmath14 pairs  @xmath52 , and it is this representation on which the mutation and breeding algorithms outlined below work .",
    "there are two kinds of mutation steps needed to search the entire search space  @xmath30 .",
    "the first amounts to increasing or decreasing @xmath14 of an individual organism . when making these length mutations it is valuable to keep the sum @xmath53 of all amplitudes fixed .",
    "one reason for this is that the coefficient sum @xmath54 can become relatively stable across the population early on , so that changing @xmath14 by simply dropping the pair @xmath55 or adding a random pair will tend to produce an unfit organism , regardless of whether some potentially desirable organism of the new length exists .",
    "moreover , a situation can occur where spurious near - degenerate states are kept because the change in overall amplitude from just removing a single one of them increases @xmath0 more than is offset by the simultaneous increase in @xmath56 caused by the mutation .",
    "the second type of mutation performs a random modification of a pair @xmath52 . a natural way to implement",
    "this is the addition of a pair of independent gaussian random variables to the original pair .",
    "since mutations can become somewhat disruptive of already accumulated genetic information in the later stages of evolution , it may be useful to make the rate of mutation dependent on @xmath57 in such a way as to increase the search area early on , before contracting it to a more local search around the optima already found as the algorithm converges .",
    "mutation steps can also be combined with a finite number of steps of a local optimization routine ( such as levenberg - marquardt ) .",
    "we have found that the addition of this latter step can greatly accelerate convergence by giving beneficial mutations an improved chance of survival .",
    "putting these ingredients together , we arrive at the following mutation algorithm :    1 .",
    "generate a random number @xmath58 $ ] .",
    "2 .   if @xmath59 ( where @xmath60 , @xmath61 are tunable parameters ) : 1 .   generate a random number @xmath62 $ ] .",
    "2 .   if @xmath63 , decrease @xmath14 by one , removing one randomly chosen exponential @xmath52 from the fit , and redistributing the amplitude in @xmath10 between the neighboring exponentials .",
    "3 .   else increase @xmath14 by one and add a new , randomly generated @xmath52 pair to the fit , decreasing the amplitudes of the pre - existing exponentials so as to keep the total amplitude fixed .",
    "3 .   generate a random number @xmath64 $ ] .",
    "4 .   if @xmath65 ( where @xmath66 is a tunable parameter ) : 1 .   generate @xmath14 pairs of gaussian deviates @xmath67 with zero mean and standard deviation @xmath68 ( where @xmath69 and @xmath70 are tunable parameters ) .",
    "2 .   replace @xmath52 by @xmath71 , unless this would lead to a negative new value for @xmath12 or @xmath10 .",
    "5 .   optionally perform a local ( e.g. levenberg - marquardt ) optimization on the fit with probability @xmath72 .",
    "this mutation procedure depends on a number of tunable parameters . in a number of numerical tests on a set of synthetic data",
    ", we found that the point to which the algorithm ultimately converged did not depend on the values of these parameters , indicating good stability of the answer .",
    "the rate of convergence , on the other hand , did depend on the particular parameters chosen , although the dependence was small for `` sensible '' parameter choices .",
    "generally , @xmath73 should not be too small , in order to explore the full solution space ; we found that @xmath74 worked well .",
    "@xmath61 did not appear to have a crucial influence on convergence , and was set to @xmath75 in subsequent runs . since element mutations can be rather disruptive of already achieved partial convergence , @xmath66 has to be chosen reasonably small ; we found @xmath76 a sensible choice .",
    "the convergence rate did not appear to strongly depend on @xmath70 and @xmath77 , which were set to @xmath78 and @xmath79 , respectively .",
    "on the other hand , performing a local optimization step can never be harmful , and @xmath72 should be set as large as computational resources allow . it should be pointed out that the optimal choice of parameters will likely depend on the particular fitting problem investigated in each case , since the fitness landscapes can conceivably look very different for different data .",
    "the breeding or crossover function returns a child organism from two parent organisms ( par1 and par2 ) , and works as follows :    1 .",
    "let @xmath80 .",
    "2 .   generate @xmath81 pairs of independent uniformly distributed random numbers @xmath82 $ ] .",
    "3 .   for @xmath83 , choose the fit parameters of the child to be @xmath84 ; for other @xmath85 , choose them equal to the longer parent s fit parameter values .",
    "the fit parameter values of the child organism are therefore chosen in a hypercube spanned by the parent s fit values .",
    "allowing for the possibility of extrapolation instead of interpolation by introducing a parameter @xmath86 is necessary to avoid rapid contraction towards central points . in agreement with @xcite",
    ", we found @xmath87 sufficient to prevent this contraction .",
    "`` parthenogenesis '' or `` cloning '' of an existing individual is possible by breeding an organism with itself .    putting these elements together ,",
    "we arrive at the following basic evolutionary step to generate the next generation from a given population :    1 .",
    "all organisms except the fittest one are subjected to mutations according to the mutation algorithm stated above .",
    "selection and breeding are carried out as follows : 1 .",
    "the fittest @xmath88 organisms are selected .",
    "another @xmath89 organisms are selected at random in order to maintain genetic diversity and avoid premature convergence .",
    "3 .   for each possible combination of the selected organisms ( including those containing the same organism twice ) ,",
    "a child organism is created according to the breeding algorithm above , and these child organisms form the next generation .",
    "@xmath90 copies of organisms from the elite are added to the population and are subjected to targeted mutations as a form of local search around the elite .    by not subjecting the fittest organism to mutations and including parthenogenesis in the breeding step , we ensure that inequalities ( [ eqn : nomutatefittest ] ) and ( [ eqn : fittestleftalone ] ) are fulfilled , and that thus the algorithm will eventually converge .",
    "the basic evolutionary step is repeated until @xmath57 converges below a chosen threshold @xmath91_{max}$ ] , or until a chosen maximum number @xmath92 of generations has been exceeded with no improvement in the best overall genotype for the last @xmath93 generations .    in order to be able to get a handle on the overall stability of the evolutionary fit , and also as an aid in a possible parallelization",
    ", we add a final wrinkle by partitioning the total population into `` islands '' of equal size , each of which forms a separate population to which the basic evolutionary step is applied independently of the other islands . to avoid individual islands with particularly unfavorable starting conditions getting stuck ,",
    "a weak coupling between islands is introduced by replacing the least fit organism on each island with a randomly chosen immigrant from a randomly chosen island with probability @xmath94 before carrying out the selection step .",
    "we find that the lowest - lying states are identified rather consistently across all islands fairly early on ; only for the most massive states discrepancies in number , energy and amplitude are found between different islands , sometimes even in late generations , indicating that the identification of these states is somewhat uncertain .",
    "our main program thus employs a multi - island ecosystem for the evolutionary optimization and then tries to improve on the results of the best evolutionary fit by performing a levenberg - marquardt optimization upon it . if sufficiently many islands are being used , it is possible to do this as a constrained fit where desired , with the average and standard deviation of the parameter values derived from bootstrapping @xcite the best island fits being employed as priors .",
    "real parameter errors may be determined by bootstrapping the data configurations and rerunning the fit algorithm . however , as this could in principle produce different functional forms for different bootstrap configurations , and as this procedure may be quite expensive , one may choose instead to apply a levenberg - marquardt fit to the bootstrap configurations using the final functional form obtained from the evolutionary algorithm , as one would do in a conventional fit .",
    "we have settled on the latter procedure for our implementation , and have found that the final levenberg - marquardt fit always returned within errors ( as estimated by the bootstrapped levenberg - marquardt procedure ) of the evolutionary fit , indicating that the evolutionary fit was already close to optimal .",
    "the errors from the bootstrapped levenberg - marquardt fit were usually ( though not always , depending on how well genetic diversity between islands was preserved in each case ) comparable to those estimated from the difference between the fits obtained on different islands . islands . ] in the following , we use the error estimates from the final bootstrapped levenberg - marquardt fit as our estimate of the error in the fitted parameters .    to demonstrate the viability of our method ,",
    "we have run a fit on two sets of synthetic data consisting of 200 artificial correlators for 48 timesteps , each constructed from a signal consisting of a sum of exponentials with known masses and amplitudes , and gaussian noise . in one case ( `` pion - like '' ,",
    "figure  [ fig : synthetic_pion ] ) the amplitude of the noise scaled linearly with the signal , in the other ( `` rho - like '' , figure  [ fig : synthetic_rho ] ) the noise amplitude was kept constant .",
    "it can be seen that the ground state mass and the mass of the first excited state are extracted with high reliability , while for the higher states good estimates are obtained .",
    "the increased error in the excited states is largely due to the noise component in the created data which makes it impossible to adequately resolve those states and not to a shortcoming in the algorithm itself .",
    "the running time for our python  implementation of each of the two bootstrapped fits was on the order of one to two hours on a single - processor pentium 4 workstation ; implementing the same algorithm in a compiled language could cut this runtime down further .",
    "it should be stressed that the evolutionary fit works robustly without any human intervention , thus saving valuable human time at the expense of a moderate increase in computer time when compared to more conventional excited state fitting methods that often require a larger degree of user intervention .",
    "finally , in figure  [ fig : real_data ] we show the results from fits to actual pion and rho correlators from a quenched simulation using wilson quarks , demonstrating the ability of our program to deal with real lattice data .",
    "in this section we discuss the generalizations of the evolutionary fitting algorithm required for fitting multiple datasets simultaneously . a more sophisticated genotype is required in this case , since now the same energy @xmath12 can occur throughout some subset of the datasets .",
    "hence , the fit for dataset number @xmath95 will now be represented by a list of @xmath96 coefficients @xmath97 , @xmath98 where @xmath99 is an integer index into a list of @xmath100 energy states @xmath101 indicating to which state the coefficient is associated . to ensure it maps to an actual energy state . ]",
    "the list @xmath102 is common to all datasets .",
    "in summary , for a fit of @xmath103 datasets the complete genotype is of the form : @xmath104 with @xmath105 assuming the datasets are not correlated in any way , the new @xmath0 is simply the sum of terms of the form in equation  ( [ eq : chi2_single ] ) , one per dataset .",
    "the number of degrees of freedom changes from the form of equation  ( [ eq : ndof_single ] ) to : @xmath106 where @xmath107 now counts all included timesteps in the fit of all datasets .",
    "the presence of integer variables in the multi - dataset genotype requires some adaptations to the breeding algorithm used . for practical reasons , it is advantageous to use a fixed - length integer implementation with @xmath85-bit integers , where @xmath108 is the maximum number of distinct states we will allow in our fit",
    ". crossover can be performed by exchanging the first @xmath109 ( @xmath110 ) bits of two integers .",
    "mutations are implemented by flipping each bit of the integer with some fixed probability .",
    "the genotype  ( [ eq : multidatasetfit ] ) has a hierarchical structure as a list of lists ultimately containing floating point or integer numbers .",
    "mutation and crossover can therefore be structured by recursing through these list structures , applying appropriate mutation and crossover operations at each level .",
    "the lists can be distinguished by the number ( fixed or variable ) and type ( homogeneous or heterogeneous ) of their elements , and by whether they are ordered or unordered .",
    "elementwise mutation can be done on any kind of list .",
    "lists of variable length can also be mutated by removing elements or adding a random new element , and ordered lists may be mutated by permuting their elements .",
    "likewise for crossover , building two new lists by picking from the elements of the parent lists in order can be done for any list .",
    "homogeneous lists allow more general subsets of the parents elements to be chosen .",
    "elementwise crossover may also be done , in order for heterogeneous lists or with random pairs of the parents elements in the homogeneous case .",
    "all of the different mutation and crossover operations that are possible in each case can have different probabilities assigned to them and for lists of variable length , a range of valid list lengths may be specified .",
    "in addition to these generic genetic operations , the multi - dataset fitting problem benefits from some operations specific to its structure .",
    "one notes that the genotype of equation  ( [ eq : multidatasetfit ] ) allows for multiple representations of the same fitting function , because the coefficient integers are taken modulo the number of masses in the fit , because either the masses or the indices to them may be in different orders , and because some masses may be unused or referred to multiple times for a single dataset .",
    "this degeneracy can have an adverse effect on the convergence of the algorithm . to encourage the algorithm to work toward a single representation of the solution",
    ", we employ a reduction mutation which sorts the mass list and removes unused masses .",
    "it also combines coefficients pointing to the same mass , places coefficient indices uniquely within the range @xmath111 , and orders them within each dataset by the associated mass index . in order to favor this operation , as well as any other mutation that may reduce redundancies ,",
    "it is beneficial to count all masses and coefficients , whether redundant or not , in the count of the degrees of freedom in equation  ( [ eq : chi2_multi ] ) .    as in the single - correlator case , interspersing local optimization steps using the levenberg - marquardt method with the other mutations was found to be useful in accelerating convergence . limiting the mutation to a fixed number of steps of the levenberg - marquardt algorithm and making it a relatively improbable mutation keeps the overall time evolution reasonable .",
    "special care needs to be taken in the multi - dataset case when adding or removing masses , since simply dropping a mass from the list will mean that any coefficients belonging to the dropped mass will now become associated with a different mass , which tends to have a catastrophic effect on fitness , especially for more evolved genotypes . a careful generalization of the way in which amplitudes are redistributed when changing the number of masses in the single - correlator case is therefore necessary .",
    "this is facilitated by first applying the reduction operation mentioned above before adding or removing a mass from the mass list .",
    "when removing a mass , one then loops through the dataset functions to see which ones have a coefficient corresponding to the removed mass . for any that do , the coefficient is deleted and its amplitude is redistributed between neighboring masses , either by increasing the coefficients for the closest masses already having coefficients in that dataset function , or by adding a new coefficient for an unrepresented neighboring mass . when adding a mass , at least one of the datasets receives a new coefficient associated with it , and the coefficients of the other masses in those datasets are lowered accordingly . as a final step ,",
    "a levenberg - marquardt optimization step is carried out in order to give the new mutant a better chance of survival .",
    "there is obviously a tradeoff between the probability of such relatively expensive mutations and the maximum size of the population that can be employed .    as a test of the efficiency of the evolutionary algorithm in the multi - dataset case we have run fits of synthetic data .",
    "the result of such a test is shown in figure  [ fig : synthetic_multidataset ] .",
    "four hypothetical diagonal meson correlators were constructed to contain four masses among them .",
    "one correlator had coefficients for only two of the masses , two had coefficients for three of the masses , and one had coefficients for all four masses .",
    "the four datasets , with @xmath112 timesteps each , were modified by adding gaussian noise , the amplitude of which was chosen small enough to allow statistical discrimination of all states . a levenberg - marquardt fit to the synthetic data , using the masses and coefficients used to generate the data as the starting point , is shown in the last column of figure  [ fig : synthetic_multidataset ] . as expected , the parameters shifted only marginally from their ideal values and @xmath57 for the fit is very close to @xmath113 .",
    "the multi - dataset algorithm was then run on the synthetic data .",
    "it was restricted to fit genotypes containing a maximum of eight masses with positive masses of value less than @xmath114 .",
    "each dataset function was allowed to have up to six coefficients whose values were only restricted to being positive .",
    "four islands were used , each containing @xmath115 individuals ( specifically @xmath116 ,  @xmath117 ) . figure  [ fig : synthetic_multidataset ]",
    "displays the best fit genotype from each generation along with its @xmath57 .",
    "it is evident that the algorithm quickly succeeds at finding a good fit to the data . by generation",
    "@xmath118 one has a fit with good @xmath57 and characteristics almost identical to the model function , having the same number of masses and corresponding coefficients , except for the addition of a small ( four orders of magnitude lower ) coefficient added in the first dataset for the highest mass .",
    "generation @xmath119 shows that this functional form with an additional coefficient actually improves the fit , having a lower @xmath57 than the optimized model function .",
    "generations @xmath120 onward _ improve _ even further in the fit by bifurcating the lowest mass to produce a fit of ever so slightly _ greater _ probability than the actual model function used to generate the data .",
    "this was the final result as of generation  @xmath121 .",
    "the total run was performed overnight on a single - processor pentium 4 workstation .",
    "overall one notices that the algorithm adds masses initially as required before proceeding to coalesce masses and combine coefficients to improve the fit .",
    "the reduction mutation serves to encourage an ordering of masses from lowest to highest but generations @xmath122 to @xmath114 show it is not strictly required .",
    "we are currently employing this program in a forthcoming analysis @xcite of the meson spectrum of twisted - mass qcd @xcite based on the representation theory of the octahedral group with generalized parity @xcite .",
    "in figure  [ fig : multipion ] , we show the results of a fit to actual data from the wilson qcd action in the pion channel .",
    "the algorithmic parameters were the same as for the previous fit .",
    "again , one observes that initially the number of states found fluctuates considerably , with states being added to improve the fit . at some point , too many states which are nearly degenerate have been introduced , and the population culls unnecessary bifurcations .",
    "one observes that by generation @xmath123 the energy states have been largely found , further improvements occurring within the coefficients .",
    "the fitness of the best genotype traces this behavior .",
    ", the restriction @xmath124 was initially imposed with an eye to restricting ourselves to physical masses and thereby preventing the occurrence of `` runaway '' solutions commonly encountered in this fitting task .",
    "we subsequently found this restriction to be unnecessary .",
    "we conjecture that the problem with runaway solutions may be due to trying to fit a poor functional form to the data , something which our algorithm avoids , thus removing the need for such a constraint .",
    "subsequently , we merely constrain parameters to be positive . ]    to get an impression of how well the algorithm converges , we show histograms of @xmath57 values of the final best fit for 160 twisted - mass meson channels in figure  [ fig : cfgcompare ] .",
    "the 160 channels correspond to four quark masses ( the mesons consist of mass - degenerate quarks and antiquarks ) , two particle types ( charged or neutral ) , and @xmath118 octahedral irreducible representations ( @xmath125 ) .",
    "the @xmath126 operators used ( @xmath127 local and @xmath128 extended ) are detailed in @xcite .",
    "diagonal correlators were obtained for all of these operators , encompassing all channels . for operators in representations of dimension greater than one ,",
    "all the correlators were row - averaged before fitting .",
    "the quenched simulation used degenerate twisted mass quarks with quark and link smearing of operators on a @xmath129 lattice at @xmath130 ( where @xmath131 is the physical strange quark mass ) ; see @xcite for further details .    for each channel the evolutionary algorithm was run three times : first using all of the data ( @xmath132 configurations ) , then one third of it ( @xmath133 ) , and finally one sixth of it ( @xmath134 ) .",
    "the fitness distribution for the full data set is excellent with @xmath57 distributed locally about @xmath135 , clearly demonstrating the algorithm is robust in its ability to find a good fit , when the latter exists .",
    "as the amount of data included drops , however , the certainty with which states are resolved falls and the optimal fit becomes poorer .",
    "fits required a minimum of @xmath136 generations , and ran for up to @xmath137 generations if improvement still occurred in the best organism .",
    "the shown fits are for correlators with smeared operators .",
    "unsmeared correlators ( not shown ) of the same operators which exhibit a greater number of excited states were also fit for the @xmath136 configuration case with no appreciable difference from the histogram of the smeared one .",
    "as a measure of stability of these fits , bootstrap errors of the fitness , @xmath138 , have been calculated for each fit and their histograms are also shown .",
    "specifically , for each fit , @xmath139 bootstrap configurations of the data were made and the functional forms of the best fits were fit to them using a levenberg - marquardt routine whose initial values were those of the best fit .",
    "for the full @xmath136 configurations one observes the variation in the goodness of the fit is small ( @xmath140 ) . since good fits",
    "occur in essentially all of the bootstrap configurations , this increases confidence that the spectrum found is accurate .",
    "the same is largely true for @xmath123 configurations as well ( @xmath141 ) , but by the time the data set is reduced to only @xmath120 configurations the error in @xmath57 is as wide as the value itself , indicating along with the fit histogram , that the amount of data is insufficient for solution of the problem .",
    "finally , in figure  [ fig : timeperparameter ] we show the runtime per parameter as a function of the total number of parameters ( masses and coefficients in all datasets ) in the final fit .",
    "overall , we find that the dominant contribution to runtime comes from the number of coefficients , which in turn is largely proportional to the number of correlators used for the fit , as might be expected from a naive runtime analysis .",
    "the specific implementation described in the previous section is just one of many possible ways to approach the problem of extracting excited state energies using evolutionary algorithms . in this section",
    "we wish to point out some alternatives to our current implementation , many of which we are actively exploring at the moment .",
    "the previously described algorithm used a genetic encoding based on real numbers .",
    "this offers the advantage of being a straightforward representation , as well as the ability to interject local optimization steps in a natural manner .",
    "an alternative would be to use an integer - based representation of real parameters instead ; the advantage in this case would be the ability to use bit - based mutation and crossover operations instead of our gaussian mutations and interpolating crossover .",
    "the bit - based operations , besides likely being faster in most cases , are better understood in terms of rigorous theorems regarding global convergence properties ( such as from schema theory @xcite ) , but do not offer the possibility for easy mixing with local optimization .    using straight elitism as the selection method has been found to be favorable in the case of problems with a real - number genetic code @xcite , but introduces a certain risk of premature convergence if the elite should happen to cluster around a local optimum .",
    "this risk is significantly reduced by the addition of random survivors and our use of an island - based ecosystem , but other , more sophisticated , selection methods could help to further eliminate any remaining bias .",
    "another disadvantage of elitist selection is that it requires a full sort of the organisms by fitness in each generation , which makes up a fair part of our implementation s computational cost .",
    "other selection methods manage to avoid this requirement , which could lead to further gains in speed .",
    "the specific mutation schedule implemented in our algorithm is also to be seen as just one example out of many that are possible . in some cases",
    ", it may be more favorable to mutate each parameter separately instead of mutating all parameters at once .",
    "our evolutionary algorithm depends on a number of parameters , such as the rate for different kinds of mutations , their dependence on @xmath57 , and the size of the breeding pool . in the current implementation , these parameters have been set to reasonable values by hand . for a more highly optimized implementation , these parameters should be tuned to values that tend to give the fastest rate of convergence towards the true optimum ; in principle , such tuning itself could be done by means of another evolutionary algorithm , although that approach might prove to be fairly expensive computationally .",
    "evolutionary multi - modal algorithms ( see @xcite and refs . therein )",
    "are able to find not only absolute extrema but relative extrema as well .",
    "`` niching '' and `` diversity preservation '' algorithms have been devised that dissuade too many elements of the population from going after the single best solution , thereby finding not only the best solution but other good solutions .",
    "this could be useful in the context of fitting since these algorithms can produce the best fit as well as other fits that lie in relative extrema that are perhaps comparable with the best fit .",
    "comparison of such fits would give the researcher a better feel for the uniqueness and likelihood of the functional form of the solution found .",
    "several improvements might be made for the simultaneous fitting of multiple correlators .",
    "obviously it is of value to cull from the fit any datasets which clearly only contain noise .",
    "as well , if fitting a large number of datasets it could be of value to partition the datasets and find viable fits on each subset first . one could then merge these populations into genotypes suitable for the entire dataset by stitching together fits from each subset . this could be done crudely by just putting the masses back to back , or one could implement some algorithm which tried to find common masses at this point between two genotypes being merged in some systematic fashion . running the algorithm on these new datasets",
    "would then optimize these fits globally , presumably by coalescing common masses across the subsets that are statistically equal to improve the final fit .",
    "the local optimization steps used as mutations in our algorithm could be rendered more efficient by employing techniques that exploit the partial linearity of the functional form of equation ( [ eqn : thform ] ) by separating the linear and non - linear variables @xcite .",
    "there is also the possibility to combine the variational method with an evolutionary fitting algorithm .",
    "to do this , one could diagonalize the correlator matrix as usual with the variational method , and then use the evolutionary algorithm to fit the resulting diagonal correlators . in this way , any remaining mixing between the optimized operators could be detected and quantified , while at the same time reducing the number of correlators to be fit .",
    "an alternative to evolutionary algorithms , which we have not investigated so far , might be the use of markov chain monte carlo optimization methods such as simulated annealing @xcite , which share evolutionary algorithms ability to accommodate discrete changes in functional form .",
    "evolutionary fitting methods provide an interesting and useful addition to the lattice field theorist s data analysis toolkit .",
    "especially when combined with other well - known and well - tested fitting methods , evolutionary fitting can help to extract information from simulation data without having to impose any external constraints , such as bayesian priors .",
    "evolutionary methods allow one instead to extract all of this information from the data themselves by harnessing the globally optimizing nature of evolving systems .",
    "this is particularly true in the case of discrete parameters such as the number of states to fit , which are hard to determine using more conventional methods .",
    "we have demonstrated a working method for the extraction of excited state masses from lattice qcd correlators using evolutionary fitting .",
    "we believe that evolutionary fitting algorithms have significant potential as a data analysis method in lattice qcd , and that further investigation in this direction is warranted .",
    "we thank the reviewer for pointing out the potential of markov chain monte carlo methods as a possible alternative to evolutionary algorithms , and george fleming for bringing reference @xcite to our attention .",
    "we also thank richard m. woloshyn for providing gauge field configurations and propagators @xcite .",
    "this work was supported in part by the natural sciences and engineering research council ( nserc ) of canada , the canada research chairs program , and the government of saskatchewan .",
    "a.  yamaguchi , a.  sugamoto , genetic algorithm for lattice gauge theory : on su(2 ) and u(1 ) on 4-dimensional lattice , how to hitchhike to thermal equilibrium state , nucl .",
    "83 ( 2000 ) 837839 .",
    "g.  singh , k.  deb , comparison of multi - modal optimization algorithms based on evolutionary algorithms , in : gecco 06 : proceedings of the 8th annual conference on genetic and evolutionary computation , acm press , new york , ny , usa , 2006 , pp ."
  ],
  "abstract_text": [
    "<S> we present an application of evolutionary algorithms to the curve - fitting problems commonly encountered when trying to extract particle masses from correlators in lattice qcd . </S>",
    "<S> harnessing the flexibility of evolutionary methods in global optimization allows us to dynamically adapt the number of states to be fitted along with their energies so as to minimize overall @xmath0/(d.o.f . ) , leading to a promising new way of extracting the mass spectrum from measured correlation functions .    ,    , and    .    </S>",
    "<S> lattice field theory , curve fitting , evolutionary algorithms 12.38.gc , 02.60.ed , 02.70.uu , 87.23.-n 81v05 , 65d10 , 65c05 , 65k10 , 92d15 </S>"
  ]
}