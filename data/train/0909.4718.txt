{
  "article_text": [
    "let @xmath0 be a connected , compact and orientable surface with the euler characteristic @xmath1 negative .",
    "it is widely known that the complex of curves , @xmath2 , for @xmath0 plays an important role in the study of the mapping class group @xmath3 of @xmath0 .",
    "in fact , understanding of the automorphism group of @xmath2 leads to the computation of the commensurator of @xmath3 as discussed in @xcite and @xcite ( see also @xcite for the automorphism group of @xmath2 ) .",
    "the aim of this paper is to compute the automorphism group of the torelli complex @xmath4 and the complex of separating curves , @xmath5 , for most of surfaces @xmath0 .",
    "these simplicial complexes are variants of the complex of curves and were introduced in @xcite and @xcite for closed surfaces to compute the commensurators of the torelli group @xmath6 and the johnson kernel @xmath7 for @xmath0 ( see also @xcite for a related work ) .",
    "we refer to section [ sec - comp ] for a precise definition of these complexes and groups .",
    "the extended mapping class group @xmath8 of @xmath0 naturally acts on @xmath4 and @xmath5 by simplicial automorphisms .",
    "these actions induces the natural homomorphisms from @xmath8 into the automorphism groups @xmath9 and @xmath10 , which are shown to be isomorphisms in the following theorems . as an application",
    ", we prove that the natural homomorphisms from @xmath8 into the commensurators of @xmath6 and @xmath7 are isomorphisms .",
    "we shall recall the definition of the commensurator of a group @xmath11 .",
    "let @xmath12 be the set of all isomorphisms between finite index subgroups of @xmath11 .",
    "we say that two elements @xmath13 , @xmath14 of @xmath12 are equivalent if there exists a finite index subgroup of @xmath11 on which @xmath13 and @xmath14 are equal .",
    "the composition of two elements @xmath15 , @xmath16 of @xmath12 given by @xmath17 induces the product operation on the quotient set of @xmath12 by this equivalence relation .",
    "this makes it into the group called the _ ( abstract ) commensurator _ of @xmath11 and denoted by @xmath18 .",
    "one has the natural homomorphism @xmath19 defined by inner conjugation .",
    "it is easily verified that @xmath20 is injective if and only if the center of any finite index subgroup of @xmath11 is trivial .",
    "let @xmath21 denote a connected , compact and orientable surface of genus @xmath14 with @xmath22 boundary components .",
    "unless otherwise stated , we always assume a surface to satisfy these conditions .",
    "[ thm - tor - comm ] let @xmath21 be a surface and assume one of the following three conditions : @xmath23 and @xmath24 ; @xmath25 and @xmath26 ; or @xmath27 and @xmath28 . then    1 .",
    "the homomorphism from @xmath8 into @xmath9 is an isomorphism .",
    "the homomorphism @xmath29 defined by conjugation is an isomorphism .    when the genus of @xmath0 is equal to one , the torelli group for @xmath0 is closely related to the braid groups on the torus .",
    "following the argument of @xcite , we describe the commensurators of them in section [ sec - torus ] .",
    "an analogous result on the complex of separating curves and the johnson kernel for @xmath0 is stated as follows .",
    "[ thm - jo - comm ] let @xmath0 be a surface satisfying the assumption in theorem [ thm - tor - comm ]",
    ". then    1 .",
    "the homomorphism from @xmath8 into @xmath10 is an isomorphism .",
    "the homomorphism @xmath30 defined by conjugation is an isomorphism .",
    "the conclusion of these two theorems for closed surfaces is due to brendle - margalit @xcite .",
    "our proof of these theorems for surfaces of genus at least two partly follows their argument using sharing pairs and spines .",
    "when the genus of @xmath0 is equal to one , there exists no sharing pair in @xmath0 . in the case of @xmath31 , we look at pentagons in @xmath32 and hexagons in @xmath33 , which are cycles of minimal length . the case of @xmath34 with @xmath35",
    "is proved by inductive argument on @xmath22 .",
    "let us describe some known facts on surfaces which are not dealt with in the above theorems . if @xmath36 is a surface of genus zero with @xmath37 , then both @xmath4 and @xmath5 are equal to @xmath2 , and both @xmath6 and @xmath7 are equal to the pure mapping class group @xmath38 of @xmath0 .",
    "the same conclusions as theorems [ thm - tor - comm ] and [ thm - jo - comm ] thus hold .",
    "the birman exact sequence shows that @xmath39 is isomorphic to @xmath40 and @xmath41 is isomorphic to the commutator subgroup @xmath42 $ ] .",
    "mess @xcite proved that @xmath43 is isomorphic to the free group of infinite rank .",
    "it is easy to see that both @xmath4 and @xmath5 are zero - dimensional if @xmath44 or @xmath45 .",
    "this shows that the same conclusions as theorems [ thm - tor - comm ] and [ thm - jo - comm ] is not true for @xmath46 and @xmath45 .",
    "it is interesting to ask the same question for @xmath47 .",
    "we know that the natural homomorphism from @xmath48 into @xmath49 is not surjective . indeed , @xmath50 consists of infinitely many @xmath51-regular trees .",
    "this is readily verified by combining the following facts :    * let @xmath52 be the natural simplicial map obtained by filling a disk in the boundary of @xmath47 .",
    "the fiber of @xmath53 on each vertex of @xmath54 is then a connected simplicial tree ( see section 7 of @xcite ) .",
    "* @xmath54 is a zero - dimensional simplicial complex consisting of infinitely many vertices .    on the other hand , @xmath55 is a connected graph , which contains a hexagon because one can embed @xmath33 into @xmath55 by gluing any two boundary components of @xmath31 ( see figure [ fig - hex ] for a hexagon in @xmath33 ) .    more generally , we study superinjective maps from the torelli complex @xmath4 into itself when @xmath0 is a surface of genus one .",
    "superinjectivity of simplicial maps of @xmath2 was introduced by irmak @xcite , @xcite to study injective homomorphisms from finite index subgroups of @xmath8 into @xmath8 ( see @xcite , @xcite and @xcite for related works ) .",
    "superinjectivity of simplicial maps of @xmath4 is also defined similarly ( see section [ subsec - comp ] ) . as a result",
    ", we obtain the following :    [ thm - g-1 ] let @xmath56 be a surface of genus one with @xmath24 .",
    "then the following assertions hold :    1 .   any superinjective map @xmath57 is an isomorphism .",
    "2 .   let @xmath11 be a finite index subgroup of @xmath6 and @xmath58 an injective homomorphism .",
    "then there exists a unique @xmath59 satisfying the equation @xmath60 for any @xmath61 .",
    "in particular , @xmath11 is co - hopfian .",
    "recall that a group @xmath11 is said to be _ co - hopfian _ if any injective homomorphism from @xmath11 into itself is an isomorphism .",
    "this paper is organized as follows .",
    "section [ sec - comp ] collects the definition of simplicial complexes and subgroups of @xmath8 mentioned in this section .",
    "their fundamental properties are also reviewed .",
    "section [ sec - basic - torelli ] studies the torelli complex @xmath4 .",
    "a simplex of maximal dimension in @xmath4 is described .",
    "this is the first observation to prove that any superinjective map @xmath57 preserves topological types of vertices of @xmath4 .",
    "section [ sec - super - torelli ] presents a construction of a simplicial map @xmath62 which induces @xmath63 when the genus of @xmath0 is equal to one . by using known facts on simplicial maps of @xmath2 , we conclude that @xmath64 is an automorphism of @xmath2 and obtain theorem [ thm - tor - comm ] ( i ) and theorem [ thm - g-1 ] ( i ) for surfaces of genus one . in section [ sec - aut - sep ] ,",
    "given an automorphism @xmath63 of @xmath5 , we construct an automorphism @xmath64 of @xmath2 extending @xmath63 .",
    "the argument for surfaces of genus at least two heavily relies on @xcite .",
    "section [ sec - twist ] gives an algebraic characterization of twisting elements of the torelli group @xmath6 .",
    "this is used to associate an automorphism of @xmath4 ( resp .",
    "@xmath5 ) to each element of @xmath65 ( resp .",
    "@xmath66 ) . the proof in section [ sec - twist ] follows vautaw s argument @xcite , @xcite for closed surfaces . as a consequence ,",
    "we compute @xmath65 and @xmath66 .",
    "section [ sec - torus ] describes the commensurator of the braid groups on the torus by using theorem [ thm - tor - comm ] for surfaces of genus one and the argument in @xcite . in appendix",
    ", we prove that each element of @xmath6 is pure in the sense of ivanov @xcite .",
    "this fact is used in section [ sec - twist ] .",
    "_ acknowledgements .",
    "_ the manuscript of this paper was written during the stay at institut des hautes tudes scientifiques .",
    "the author thanks the institute for giving nice environment and for warm hospitality .",
    "unless otherwise stated , we always assume that a surface is connected , compact and orientable , and it may have non - empty boundary . let @xmath21 be a surface of genus @xmath14 with @xmath22 boundary components .",
    "the euler characteristic of @xmath0 is denoted by @xmath1 and is equal to @xmath67 .",
    "a simple closed curve in @xmath0 is said to be _ essential _ if it is neither homotopic to a single point of @xmath0 nor isotopic to a boundary component of @xmath0 .    when there is no confusion , we mean by a curve either an essential simple closed curve on @xmath0 or an isotopy class of it .",
    "a curve @xmath68 is said to be _ separating _ in @xmath0 if @xmath69 is disconnected , and otherwise @xmath68 is said to be _ non - separating _ in @xmath0 .",
    "a pair of non - separating curves in @xmath0 , @xmath70 , is called a _ bounding pair ( bp ) _ in @xmath0 if @xmath68 and @xmath71 are disjoint and not isotopic to each other and if @xmath72 is disconnected . when we take into account an order of two curves of a bounding pair @xmath70 , it is denoted by @xmath73 and",
    "is called an _ ordered bounding pair_. we often confuse a bp with and without an order if they can be distinguished in the context .",
    "we say that two non - separating curves in @xmath0 are _ bp - equivalent _ in @xmath0 if they are disjoint and form a bp in @xmath0 .",
    "let @xmath68 be a separating curve in @xmath0 .",
    "if @xmath68 cuts off a handle from @xmath0 , then @xmath68 is called an _",
    "h - curve _ in @xmath0 , where we mean by a _ handle _ a surface homeomorphic to @xmath74 .",
    "if @xmath68 cuts off a pair of pants from @xmath0 , then @xmath68 is called a _",
    "p - curve _ in @xmath0 , where we mean by a _ pair of pants _ a surface homeomorphic to @xmath75 .",
    "a curve which is either an h - curve or a p - curve in @xmath0 is called an _",
    "hp - curve _ in @xmath0 .",
    "if a bp @xmath76 in @xmath0 cuts off a pair of pants from @xmath0 , then @xmath76 is called a _",
    "p - bp _ in @xmath0 .",
    "we shall collect the definition of several abstract simplicial complexes arising from topology of simple closed curves on surfaces .",
    "the first complex was introduced by harvey @xcite .",
    "the second and third complexes ( with an additional structure and for closed surfaces ) were introduced by farb and ivanov @xcite .    * the complex of curves .",
    "* let @xmath77 denote the set of isotopy classes of essential simple closed curves on @xmath0 and @xmath78 denote the set of non - empty finite subsets @xmath79 of @xmath80 such that all curves of @xmath79 can be realized disjointly on @xmath0 at the same time .",
    "the _ complex of curves _ , denoted by @xmath81 , is the abstract simplicial complex such that the sets of vertices and simplices of @xmath82 are given by @xmath80 and @xmath83 , respectively .",
    "let @xmath84 denote the _ geometric intersection number _",
    ", i.e. , the minimal cardinality of the intersection of representatives for two elements of @xmath80 . given two simplices @xmath85 and",
    "@xmath86 of @xmath82 , we define @xmath87 to be the sum @xmath88 .",
    "we say that @xmath79 and @xmath89 are _ disjoint _ if @xmath90 , and otherwise we say that they _",
    "intersect_.    * the complex of separating curves .",
    "* the full subcomplex of @xmath2 spanned by all vertices corresponding to isotopy classes of separating curves is called the _ complex of separating curves _ and is denoted by @xmath91 .",
    "we denote the set of vertices and simplices of @xmath92 by @xmath93 and @xmath94 , respectively .    * the torelli complex .",
    "* let @xmath95 be the set of isotopy classes of bps in @xmath0 .",
    "torelli complex _ for @xmath0 , denoted by @xmath96 , is the abstract simplicial complex such that the set of vertices , denoted by @xmath97 , is given by the disjoint union @xmath98 , and a non - empty finite subset @xmath79 of @xmath98 forms a simplex of @xmath99 if and only if any two elements of @xmath79 are disjoint as elements of @xmath83 .",
    "let @xmath100 denote the set of simplices of @xmath99 .",
    "we often regard an element of @xmath101 as an edge of @xmath2 .",
    "we note that if @xmath0 is a surface of genus zero , then both @xmath5 and @xmath4 are equal to @xmath2 since any essential simple closed curve in @xmath0 is separating in @xmath0 .",
    "let us collect here terminology and symbols used throughout this paper .",
    "let @xmath102 be a simplex .",
    "a _ bp - equivalence class _ in @xmath79 is an equivalence class in the set of all non - separating curves of @xmath79 with respect to the bp - equivalence relation .",
    "when all curves of @xmath79 are non - separating and bp - equivalent to each other , we say that @xmath79 forms a bp - equivalence class .",
    "two elements @xmath103 , @xmath104 of @xmath101 are said to be _ bp - equivalent _ if @xmath103 and @xmath104 are disjoint and the set of all curves in @xmath103 and @xmath104 forms a bp - equivalence class .",
    "an element of @xmath101 is called a _",
    "bp - vertex_. similarly , an element of @xmath80 corresponding to an h - curve and a p - curve is called an _",
    "h - vertex _ and a _",
    "p - vertex _",
    ", respectively .",
    "let @xmath105 be one of the simplicial complexes @xmath2 , @xmath5 and @xmath4 .",
    "we denote by @xmath106 the set of vertices of @xmath105 .",
    "note that a map @xmath107 defines a simplicial map from @xmath105 into itself if and only if @xmath108 for any two vertices @xmath109 with @xmath110 .",
    "we mean by a _ superinjective map _ @xmath111 a simplicial map @xmath111 satisfying @xmath112 for any two vertices @xmath109 with @xmath113 .",
    "it is easy to see that any superinjective map @xmath111 is injective .    finally , given a surface @xmath0 and a simplex @xmath102 , we denote by @xmath114 the surface obtained by cutting @xmath0 along all curves in @xmath79 .",
    "when @xmath79 consists of a single curve @xmath68 , we denote it by @xmath115 for simplicity .",
    "if @xmath116 is a component of @xmath114 , then we have the natural inclusion of @xmath117 into @xmath118 .",
    "let @xmath0 be a surface .",
    "the _ extended mapping class group _ @xmath8 for @xmath0 is the group consisting of all isotopy classes of homeomorphisms on @xmath0 , where isotopy may move points in the boundary of @xmath0 .",
    "the _ mapping class group _ @xmath3 for @xmath0 is the subgroup of @xmath8 of index two consisting of all isotopy classes of orientation - preserving homeomorphisms on @xmath0 .",
    "the _ pure mapping class group _ @xmath38 for @xmath0 is the group consisting of all isotopy classes of orientation - preserving homeomorphisms on @xmath0 which fix each boundary component of @xmath0 as a set .",
    "the reader should consult @xcite and @xcite for fundamentals of these groups .",
    "given the isotopy class @xmath68 of an essential simple closed curve in @xmath0 , we denote by @xmath119 the _ ( left ) dehn twist _ about @xmath68 . for an ordered bp @xmath120 , we write @xmath121 and call it the _ bp twist _ about @xmath122 .",
    "the _ torelli group _ @xmath6 for @xmath0 is the subgroup of @xmath38 generated by dehn twists about all separating curves and bp twists about all bps in @xmath0 .",
    "the _ johnson kernel _",
    "@xmath7 for @xmath0 is the subgroup of @xmath38 generated by dehn twists about all separating curves in @xmath0 .",
    "it is clear that both @xmath6 and @xmath7 are normal subgroups of @xmath8 .",
    "we refer to @xcite for variants of the definition of the torelli group .",
    "note that if @xmath0 is a surface of genus zero , then any curve in @xmath0 is separating , and thus both @xmath6 and @xmath7 are equal to @xmath38 .",
    "let @xmath21 be a surface .",
    "it is known that if @xmath123 and @xmath124 , then @xmath6 is equal to the subgroup of @xmath3 consisting of all elements which trivially act on the homology group @xmath125 .",
    "this is due to powell @xcite ( for closed surfaces and based on birman s work @xcite on @xmath126 ) and johnson @xcite .",
    "this description is the original definition of the torelli group for @xmath0 with @xmath124 .",
    "afterward , johnson @xcite produced a finite generating set for @xmath6 consisting of bp twists when @xmath27 and @xmath124 .",
    "in contrast , if @xmath25 and @xmath127 , then @xmath6 is not finitely generated .",
    "indeed , @xmath6 is isomorphic to the free group of infinite rank ( see @xcite , @xcite and @xcite ) .",
    "the following fact on @xmath7 is fundamental and will be used in section [ sec - twist ] .",
    "[ thm - johnson ] let @xmath21 be a surface with @xmath123 and @xmath128 .",
    "then @xmath7 contains no non - zero power of a bp twist .",
    "[ prop - jo - bp ] if @xmath21 is a surface with either ( a ) @xmath123 and @xmath28 ; or ( b ) @xmath23 and @xmath26 , then @xmath7 contains no non - zero power of a bp twist .",
    "we first assume the condition ( a ) and @xmath26 .",
    "let @xmath120 be an ordered bp in @xmath0 .",
    "if @xmath122 does not cut off a surface of genus zero , then fill disks in any @xmath129 components of @xmath130 .",
    "otherwise , choose one component of @xmath130 contained in the surface of genus zero cut off by @xmath122 , and fill disks in all of the other components of @xmath130 .",
    "one then obtains the surface @xmath116",
    "homeomorphic to @xmath131 and the homomorphism @xmath132 .",
    "note that @xmath122 can be seen as an ordered bp in @xmath116 .",
    "it follows from @xmath133 and theorem [ thm - johnson ] that no non - zero power of @xmath134 is contained in @xmath7 .",
    "we next assume the condition ( b ) .",
    "once the conclusion for @xmath44 is shown , the conclusion for the other cases is verified along the argument in the previous paragraph .",
    "put @xmath44 and let @xmath135 be the surface obtained by filling a disk in one boundary component of @xmath0 , which is homeomorphic to @xmath74 .",
    "one then obtains the birman exact sequence @xmath136 and @xmath137 is the free group generated by two standard non - separating simple loops @xmath68 , @xmath71 in @xmath135 .",
    "it follows from the definition of @xmath138 that both @xmath139 and @xmath140 are bp twists in @xmath38 .",
    "thus , @xmath141 .",
    "note that @xmath142)$ ] is the dehn twist about a separating curve in @xmath0 , where @xmath143 $ ] denotes the commutator of @xmath68 and @xmath71 . since the actions of @xmath38 on the set of all bps and the set of all separating curves in @xmath0 are both transitive , the normal closure of @xmath139 in @xmath38 is equal to @xmath6 .",
    "therefore , @xmath144 .",
    "the same argument proves that the image of the commutator subgroup @xmath145 $ ] via @xmath138 is equal to @xmath7 .",
    "it is clear that no non - zero power of @xmath139 and its conjugate in @xmath38 is contained in @xmath146)$ ] .",
    "since @xmath8 naturally acts on the complex of curves , @xmath2 , we have the natural homomorphism @xmath53 from @xmath8 into the simplicial automorphism group @xmath147 of @xmath2 .",
    "the following theorem is a fundamental tool to compute commensurators of mapping class groups and their subgroups .",
    "it is proved in @xcite , @xcite and @xcite .",
    "[ thm - cc ] let @xmath21 be a surface with @xmath148 , and let @xmath149 be the natural homomorphism",
    ". then    1 .",
    "if @xmath150 , then @xmath53 is an isomorphism .",
    "2 .   if @xmath151 , then @xmath152 is equal to the center of @xmath8 , and the image of @xmath53 is equal to the group of automorphisms of @xmath2 preserving vertices corresponding to separating curves , which is a finite index subgroup of @xmath147 .",
    "3 .   if @xmath153 , then @xmath152 is equal to the center of @xmath8 , and @xmath53 is surjective .    it is known that if @xmath154 , then the center of @xmath8 consists of exactly two elements . any superinjective map from @xmath2 into itself is shown to be an isomorphism in @xcite , @xcite , @xcite and @xcite . more generally , the following theorem is obtained .",
    "[ thm - sha ] let @xmath21 be a surface with @xmath148 .",
    "then any injective simplicial map @xmath155 is an isomorphism .",
    "this section proves that any superinjective map of the torelli complex and the complex of separating curves preserves the topological type of each vertex .      a description of simplices of maximal dimension in the torelli complex is given .",
    "the next observation on bps will be used many times in what follows .",
    "[ lem - bp ] let @xmath68 be a bp in @xmath0 , and let @xmath71 be either a separating curve in @xmath0 disjoint from @xmath68 or a bp in @xmath0 which is disjoint from @xmath68 and is not bp - equivalent to @xmath68 .",
    "then the two curves in @xmath68 are contained in a single component of @xmath156 .",
    "let @xmath157 and @xmath158 denote the non - separating curves in @xmath68 .",
    "assume @xmath71 to be a separating curve .",
    "one can easily check that each @xmath159 is non - separating in the component of @xmath156 containing it .",
    "if @xmath157 and @xmath158 were contained in different components of @xmath156 , then @xmath160 would be connected .",
    "this is a contradiction .",
    "we next assume @xmath71 is a bp .",
    "note that each separating curve in a component of @xmath156 is either separating in @xmath0 or forms a bp in @xmath0 with any curve of @xmath71 .",
    "since @xmath68 and @xmath71 are not bp - equivalent , each curve in @xmath68 is non - separating in the component of @xmath156 containing it .",
    "the conclusion of the lemma then follows as before .",
    "[ lem - bc ] let @xmath0 be a surface and let @xmath161 be simplices such that    * @xmath162 , @xmath163 , @xmath164 and @xmath165 ; and * each curve of @xmath71 and @xmath166 is non - separating , and each of @xmath71 and @xmath166 forms a bp - equivalence class in the simplex @xmath167 .",
    "then the following assertions hold :    1 .   for each component @xmath116 of @xmath156 , there exist exactly two curves of @xmath71 corresponding to boundary components of @xmath116 .",
    "2 .   there exists a unique component @xmath135 of @xmath156 such that @xmath168 .",
    "moreover , each curve of @xmath166 is non - separating in @xmath135 , and @xmath166 forms a bp - equivalence class as an element of @xmath169 .",
    "if @xmath116 is a component of @xmath156 , then the number of curves of @xmath71 corresponding to boundary components of @xmath116 is at least two because each curve of @xmath71 is non - separating in @xmath0 .",
    "assume that the number is at least three .",
    "choose three curves @xmath103 , @xmath104 and @xmath170 of @xmath71 corresponding to boundary components of @xmath116 , and take a p - curve @xmath68 in @xmath116 cutting off a pair of pants whose boundary contains @xmath103 and @xmath104 .",
    "since the pair @xmath171 separates @xmath0 into two components , @xmath68 is separating in @xmath0 .",
    "this contradicts lemma [ lem - bp ] because both components of @xmath115 contain a curve of @xmath71 .",
    "this proves the assertion ( i ) .",
    "take a curve @xmath172 and a component @xmath135 of @xmath156 with @xmath173 .",
    "we first claim that @xmath174 is non - separating in @xmath135 .",
    "assume otherwise , and let @xmath175 be curves corresponding to boundary components of @xmath135 .",
    "if both @xmath103 and @xmath104 were contained in a single component of @xmath176 , then @xmath174 would be separating in @xmath0 .",
    "this is a contradiction .",
    "otherwise , @xmath103 and @xmath174 form a bp in @xmath0 , and this is also a contradiction .",
    "therefore , @xmath174 is non - separating in @xmath135 .",
    "suppose that a curve @xmath177 different from @xmath174 is contained in a component @xmath178 of @xmath156 different from @xmath135 .",
    "the curve @xmath179 is then non - separating in @xmath178 , and @xmath180 is connected because any two curves of @xmath71 can be connected by an arc in @xmath0 which does not intersect @xmath174 and @xmath179 . since @xmath181 is a bp in @xmath0 , this is a contradiction and proves that each curve of @xmath166 is contained in @xmath135 .",
    "it is clear that @xmath166 forms a bp - equivalence class as an element of @xmath169 .",
    "[ lem - sep - number ] let @xmath21 be a surface and let @xmath79 be a simplex of @xmath2 consisting of separating curves in @xmath0 . then the following assertions hold :    1 .   the inequality @xmath182 holds and this equality can be attained . in particular ,",
    "2 .   if @xmath184 , then @xmath114 consists of @xmath14 handles and @xmath185 pairs of pants .    if there exists a component @xmath116 of @xmath114 which is neither a pair of pants nor a handle , then any separating curve in @xmath116 is separating in @xmath0 .",
    "this implies that once the assertion ( i ) is proved , the assertion ( ii ) follows . to prove the assertion ( i ) , we may assume that each component of @xmath114 is either a pair of pants or a handle .",
    "note that the number of components of @xmath114 is equal to @xmath186 .",
    "the assertion ( i ) is then verified by the counting argument of the number of boundary components of components of @xmath114 .",
    "[ prop - max ] let @xmath21 be a surface with @xmath187 and @xmath188",
    ". then @xmath189 moreover , if @xmath190 , then for any simplex @xmath79 of @xmath4 of maximal dimension , there exists a unique simplex @xmath191 of @xmath2 such that    1 .",
    "each of @xmath192 is an h - curve ; 2 .",
    "each of @xmath193 is non - separating , and the family @xmath194 forms a bp - equivalence class ; and 3 .",
    "@xmath79 consists of @xmath192 and all bps of two curves in @xmath194 .",
    "it is easy to find a simplex @xmath191 of @xmath2 satisfying the conditions ( a ) and ( b ) .",
    "one can verify that the dimension of the simplex of @xmath4 containing all @xmath195 s and all bps of two curves chosen from the family @xmath194 is equal to the right hand side of the equality in the proposition .",
    "therefore , @xmath196 is not smaller than this number .",
    "we prove the equation in the proposition by induction on @xmath197 . when @xmath198 , we have @xmath199 , and it is then easy to see @xmath200 . note that the cardinality of bp - vertices in a simplex of @xmath4 is at most one .",
    "in what follows , we assume @xmath190 .",
    "let @xmath201 be a simplex of maximal dimension .",
    "let @xmath202 be the collection of curves of elements in @xmath79 such that    * each of @xmath203 is separating in @xmath0 ; and * @xmath204 is non - separating in @xmath0 for each @xmath138 , @xmath205 , and the family @xmath206 forms a bp - equivalence class in @xmath207 for each @xmath138 .",
    "since the dimension of @xmath79 is maximal , @xmath79 contains the bp of any two curves in @xmath208 for any @xmath138 , and we have @xmath209 the following two claims show that @xmath207 contains exactly one bp - equivalence class .",
    "we have @xmath210 .    we suppose @xmath211 and deduce a contradiction . by lemma [ lem - bc ]",
    ", there exists a unique component @xmath135 of @xmath212 containing all curves of @xmath104 . after exchanging the indices",
    ", we may assume that    * @xmath213 and @xmath214 are curves of @xmath103 corresponding to boundary components of @xmath135 ; and * the curves @xmath215 and all curves in @xmath216 with @xmath217 and @xmath218 form the family of all curves in @xmath207 contained in @xmath135 .",
    "note that the curves @xmath215 and all bps obtained from @xmath216 form the simplex @xmath219 of @xmath220 .",
    "since @xmath213 and @xmath214 are contained in a single component of the surface obtained by cutting @xmath135 along each element of @xmath221 , there exists a p - curve @xmath166 in @xmath135 such that @xmath222 and @xmath166 cuts off a pair of pants whose boundary contains @xmath213 and @xmath214 .",
    "note that @xmath166 is separating in @xmath0 and has to be contained in @xmath221 since @xmath223 is maximal .",
    "it follows that @xmath166 is equal to one of @xmath215 .",
    "let @xmath178 be the component of @xmath224 which does not contain @xmath213 and @xmath214 .",
    "the simplex @xmath225 can be seen as an element of @xmath226 .",
    "let @xmath227 be the genus of @xmath135 and @xmath228 the number of boundary components of @xmath135 .",
    "note that @xmath227 is positive because @xmath104 is contained in @xmath135 .",
    "since @xmath178 is a surface of genus @xmath227 with @xmath229 boundary components , the hypothesis of the induction implies the inequality @xmath230 choose a simplex @xmath231 such that for each @xmath138 , each @xmath232 is separating in @xmath135 , and @xmath213 and @xmath214 are not contained in a single component of @xmath233 .",
    "one can then find a simplex @xmath234 consisting of h - curves disjoint from all @xmath232 s .",
    "after deleting curves in @xmath221 from @xmath207 , add all @xmath232 s and @xmath235 s to it . this new collection of curves is denoted by @xmath236 and associates the simplex @xmath237 containing all separating curves in @xmath236 and all bps of curves in @xmath236 .",
    "we then obtain the equality @xmath238 and the inequality @xmath239 by using the inequality shown above .",
    "if @xmath240 , then @xmath104 can not be in @xmath135 .",
    "therefore , the right hand side in the last inequality is positive .",
    "this contradicts the maximality of @xmath223 .",
    "we have @xmath241 .    if @xmath242 , then @xmath79 consists of separating curves in @xmath0 .",
    "lemma [ lem - sep - number ] implies that @xmath243 . the inequality @xmath244 then holds when @xmath190 .",
    "this is a contradiction .",
    "these two claims show that @xmath207 is of the form @xmath245 where each @xmath246 is separating in @xmath0 and any two curves in the family @xmath247 are bp - equivalent in @xmath0 .",
    "we put @xmath248 and @xmath249 .",
    "any curve in @xmath250 is then separating in @xmath251 .",
    "it follows from maximality of @xmath223 that the surface @xmath252 consists of @xmath253 handles and @xmath254 pairs of pants . applying lemma [ lem - sep - number ] to @xmath251",
    ", we obtain the equation @xmath255 .",
    "since any @xmath256 can not be the boundary of a handle in @xmath252 , we have the inequality @xmath257 .",
    "thus , @xmath258 . the inequality",
    "@xmath259 then implies the inequality @xmath260 this proves the equality in the proposition .",
    "the equality in the last inequality holds if and only if @xmath261 and @xmath262 .",
    "the above argument shows that each @xmath246 is an h - curve .",
    "therefore , we proved that @xmath207 satisfies the conditions ( a ) , ( b ) and ( c ) .",
    "the uniqueness of @xmath207 is obvious .",
    "[ lem - bp - s ] let @xmath21 be a surface with @xmath187 .",
    "suppose either @xmath190 or @xmath263 .",
    "let @xmath57 be a superinjective map .",
    "then the following assertions hold :    1 .   if @xmath123 , then the inclusions @xmath264 and @xmath265 hold . 2 .   if @xmath23 , then the inclusion @xmath264 holds .",
    "3 .   if @xmath103 and @xmath104 are disjoint bps in @xmath0 and are bp - equivalent , then @xmath266 and @xmath267 are also bp - equivalent .",
    "the assertion ( ii ) is a direct consequence of proposition [ prop - max ] .",
    "assume @xmath123 and @xmath190 .",
    "the same proposition implies that if @xmath268 is an h - vertex , then @xmath269 is either an h - vertex or a bp - vertex .",
    "note that for any simplex @xmath201 of maximal dimension , a vertex @xmath68 in @xmath79 is an h - vertex if and only if there exists a vertex @xmath270 with @xmath113 and @xmath271 for each vertex @xmath272 .",
    "therefore , if @xmath268 is an h - vertex , then so is @xmath269 .",
    "this also implies the inclusion @xmath264 and the assertion ( iii ) by proposition [ prop - max ] .",
    "let @xmath273 be a vertex which is not an h - vertex .",
    "choose h - vertices @xmath274 such that @xmath275 is a @xmath14-simplex of @xmath5 .",
    "if @xmath276 , then this contradicts the fact that all of @xmath277 are h - vertices .",
    "thus , @xmath278 .",
    "this shows the inclusion @xmath265 .    when @xmath279 , any simplex @xmath79 of @xmath4 of maximal dimension consists of either three h - vertices or two h - vertices and one bp - vertex .",
    "note that the former occurs if and only if for each vertex @xmath280 , there exists a vertex @xmath281 satisfying @xmath282 and @xmath283 for each vertex @xmath284 .",
    "this implies that @xmath63 preserves h - vertices .",
    "if we have a bp - vertex @xmath285 with @xmath286 an h - vertex , then choose four distinct h - curves @xmath174 , @xmath179 , @xmath287 and @xmath288 disjoint from @xmath71 such that @xmath174 and @xmath179 are contained in a single component of @xmath156 and @xmath287 and @xmath288 are contained in another component of @xmath156 .",
    "it then follows that @xmath289 , @xmath290 , @xmath291 and @xmath292 are h - curves in the component of @xmath293 , denoted by @xmath116 , that is not a handle and is homeomorphic to @xmath47 . on the other hand , the two subsurfaces filled by @xmath289 and @xmath290 and by @xmath291 and @xmath292 are disjoint .",
    "this contradicts @xmath294 .",
    "we put @xmath296 throughout this subsection .",
    "we say that a 5-tuple @xmath297 of vertices of @xmath4 forms a _ pentagon _ in @xmath4 if @xmath298 and @xmath299 for each @xmath205 mod @xmath300 ( see figure [ fig - pen ] ) .",
    ", width=453 ]    [ lem - pen - bp ] there exists no pentagon in @xmath4 consisting of only bp - vertices .",
    "we assume that there exists a 5-tuple @xmath297 forming a pentagon in @xmath4 with @xmath301 for each @xmath138 .",
    "we denote by @xmath302 , @xmath303 and @xmath304 the three components of @xmath130 . for each bp @xmath71 in @xmath0",
    ", one can associate the index @xmath305 such that @xmath306 is contained in the pair of pants cut off by @xmath71 .",
    "let us denote this association by @xmath307 .",
    "since different indices are associated to two adjacent vertices in @xmath101 , we may assume @xmath308 let @xmath135 be the surface obtained by filling a disk in @xmath304 .",
    "we denote by @xmath309 the simplicial cone over @xmath310 and denote by @xmath311 the cone point .",
    "one can define the natural simplicial map @xmath312 so that @xmath313 consists of all p - curves in @xmath0 cutting off a pair of pants containing @xmath304 .",
    "it is easy to check the following facts :    * if @xmath314 satisfy @xmath315 , @xmath316 and @xmath317 , then @xmath318 and it is an edge of @xmath310 . * if @xmath319 satisfies @xmath320 , then @xmath321 consists of exactly one vertex of @xmath310 corresponding to a non - separating curve in @xmath135 . *",
    "if @xmath322 and @xmath319 satisfy @xmath113 , @xmath323 and @xmath320 , then @xmath324 and @xmath325 .",
    "the first fact implies @xmath326 .",
    "we put @xmath327 and @xmath328 .",
    "note that any two adjacent vertices in @xmath329 have a common curve .",
    "one of the two curve in @xmath330 , say @xmath331 , belongs to @xmath332 , and the other curve @xmath333 in @xmath330 intersects @xmath334 and is disjoint from @xmath332 .",
    "thus , @xmath333 intersects @xmath335 .",
    "the third fact implies @xmath336 .",
    "this contradicts @xmath337 .",
    "[ lem - si - pre - p ] let @xmath57 be a superinjective map , and let @xmath68 be a p - vertex of @xmath4 .",
    "then @xmath269 is also a p - vertex of @xmath4 .",
    "the image of the pentagon in figure [ fig - pen ] ( b ) via @xmath63 contains four bp - vertices by lemma [ lem - bp - s ] ( ii ) .",
    "lemma [ lem - pen - bp ] implies that the other vertex is not a bp - vertex . since any separating curve in @xmath0 which is disjoint from a bp",
    "is a p - curve , we obtain the lemma .",
    "[ lem - pen - h ] suppose that we are given a 5-tuple @xmath297 of vertices of @xmath4 forming a pentagon in @xmath4 such that both @xmath338 and @xmath339 are bp - vertices and both @xmath334 and @xmath330 are p - vertices .",
    "then @xmath332 is an h - vertex .",
    "it is clear that @xmath332 is not a p - vertex because there is no p - vertex in the link of a p - vertex in @xmath4 .",
    "we number components of @xmath130 from one to three as in the proof of lemma [ lem - pen - bp ] . for each bp or p - curve @xmath68 in @xmath0 , let @xmath116 be the component of @xmath115 containing only one component of @xmath130 .",
    "one then associates to @xmath68 the number of the component of @xmath130 contained in @xmath116 .",
    "note that different numbers are associated to two adjacent vertices in @xmath101 and that the same number is associated to a p - vertex and a bp - vertex which are adjacent .",
    "therefore , we may assume that @xmath334 and @xmath338 are associated the number 1 and that @xmath339 and @xmath330 are associated the number 2 .",
    "it follows that @xmath332 is not a bp - vertex , and thus it is an h - vertex .",
    "lemmas [ lem - si - pre - p ] and [ lem - pen - h ] imply the following :    [ prop - sep - p3 ] put @xmath296 and let @xmath57 be a superinjective map .",
    "then @xmath63 preserves p - vertices and h - vertices in @xmath4 , respectively .",
    "in particular , the inclusion @xmath265 holds .",
    "the aim of this subsection is to prove that any superinjective map from @xmath4 into itself preserves vertices corresponding to separating curves in the case of @xmath56 with @xmath35 .",
    "we first introduce rooted simplices of @xmath4 to prove it .",
    "let @xmath0 be a surface , and let @xmath79 be a simplex of @xmath4 consisting of bp - vertices .",
    "we say that @xmath79 is _ rooted _ if @xmath79 forms a bp - equivalence class and there exists a non - separating curve @xmath331 in @xmath0 contained in any bps of @xmath79 .",
    "if @xmath340 , then @xmath331 is uniquely determined and called the _ root curve _ for @xmath79 .",
    "[ lem - rooted ] let @xmath21 be a surface with @xmath187 , and suppose either @xmath190 or @xmath263 .",
    "let @xmath57 be a superinjective map , and let @xmath79 be a simplex of @xmath4 consisting of bp - vertices .",
    "if @xmath79 is rooted , then so is @xmath341 .",
    "we first prove that @xmath63 preserves rooted simplices consisting of @xmath185 bp - vertices .",
    "let @xmath342 be such a simplex , where we put @xmath343 .",
    "it then follows that for each @xmath205 , there exists a vertex @xmath344 such that @xmath345 and @xmath346 for each @xmath347 .",
    "this implies that for each @xmath205 , there exists a non - separating curve @xmath348 contained in @xmath349 , but not in @xmath350 for each @xmath347 .",
    "let @xmath351 be the curve in @xmath266 that is not equal to @xmath174 .",
    "note that @xmath352 are pairwise distinct curves and bp - equivalent to each other by lemma [ lem - bp - s ] ( iii ) .",
    "it follows from proposition [ prop - max ] that there exist at most @xmath353 non - separating curves in @xmath0 such that each bp of @xmath341 consists of two of them .",
    "we therefore obtain the equality @xmath354 for each @xmath205 .",
    "this shows @xmath341 is rooted .",
    "since a simplex of @xmath4 consisting of bp - vertices is rooted if and only if it is contained in a rooted simplex consisting of @xmath185 bp - vertices , the lemma follows .",
    "[ lem - simp - ind ] let @xmath0 be a surface in lemma [ lem - rooted ] , and let @xmath57 be a superinjective map .",
    "suppose that we are given two distinct and disjoint bps @xmath355 and @xmath356 in @xmath0 with the common curve @xmath357 .",
    "we put @xmath358 for each @xmath359 .",
    "then we have @xmath360 .    note that lemma [ lem - rooted ]",
    "implies that @xmath266 and @xmath267 have the common curve @xmath361 . if the conclusion of the lemma were not true , then @xmath362 would be a bp containing @xmath361 by lemma [ lem - rooted ] . in general , the maximal dimension of rooted simplices in any simplex of maximal dimension in @xmath4 is equal to @xmath363 . by choosing a simplex of maximal dimension in @xmath4 containing @xmath103 and @xmath104 and by using injectivity of @xmath63 , one",
    "can then deduce a contradiction .",
    "[ lem - p - curve ] let @xmath56 be a surface with @xmath35 , and let @xmath57 be a superinjective map . if @xmath364 is a p - curve , then @xmath365 and it is a p - curve .",
    "let @xmath364 be a p - curve , and choose a rooted simplex @xmath79 consisting of @xmath366 bps in @xmath0 disjoint from @xmath68 .",
    "once it is shown that @xmath269 belongs to @xmath367 , one can easily verify that @xmath269 is a p - curve because any separating curve in @xmath0 disjoint from the rooted simplex @xmath341 is a p - curve .",
    "we assume @xmath368 .",
    "it then follows that @xmath269 and each bp in @xmath341 are bp - equivalent since the genus of @xmath0 is equal to one .",
    "note that @xmath129 non - separating curves in @xmath0 appear in bps of @xmath341 and that at most @xmath22 non - separating curves in @xmath0 appear in bps of any simplex of @xmath4 .",
    "therefore , there exists a bp @xmath71 in @xmath79 such that @xmath269 and @xmath286 have a common curve .",
    "assume that this common curve is not equal to the root curve for @xmath341 .",
    "let @xmath369 be a bp of @xmath79 different from @xmath71 .",
    "we then have @xmath370 .",
    "this contradicts the existence of a vertex @xmath371 with @xmath372 and @xmath373 .",
    "therefore , the common curve of @xmath269 and @xmath286 is the root curve for @xmath341 .",
    "let @xmath374 be all non - separating curves in bps of @xmath79 .",
    "by lemma [ lem - simp - ind ] , @xmath63 induces the map @xmath375 from the set of all curves of bps in @xmath79 into the set of all curves of bps in @xmath341 such that @xmath376 for any distinct @xmath138 , @xmath205 . since for each @xmath138 ,",
    "the family @xmath377 is a rooted simplex disjoint from @xmath68 , the argument of the previous paragraph shows that @xmath269 contains @xmath378 for each @xmath138 .",
    "this is a contradiction .",
    "let @xmath56 be a surface with @xmath24 , and let @xmath57 be a superinjective map",
    ". then @xmath265 .    by lemma [ lem - p - curve ]",
    ", it suffices to show that if @xmath364 is a separating curve which is not a p - curve , then @xmath365 .",
    "we prove this claim by induction on @xmath22 . when @xmath295 , this is proved in proposition [ prop - sep - p3 ] .",
    "assume @xmath35 and let @xmath364 be a curve which is not a p - curve .",
    "one can then find a p - curve @xmath379 disjoint from @xmath68 .",
    "the map @xmath63 induces the superinjective map @xmath380 , where for a p - curve @xmath333 in @xmath0 , we denote by @xmath381 the component of @xmath382 that is not a pair of pants .",
    "since @xmath383 and @xmath384 are homeomorphic and since the number of boundary components of @xmath383 is less than the one of @xmath0 , the hypothesis of the induction implies that @xmath385 .",
    "it follows from @xmath386 that @xmath387 , and thus @xmath388 .",
    "we have proved that any superinjective map @xmath57 preserves vertices corresponding to separating curves in @xmath0 .",
    "it follows that @xmath63 induces a superinjective map from @xmath5 into @xmath5 .",
    "this subsection studies general superinjective maps from @xmath5 into itself .",
    "let @xmath79 be a simplex of maximal dimension in @xmath5 .",
    "we say that two curves @xmath68 and @xmath71 in @xmath79 are _ adjacent with respect to _",
    "@xmath79 if there exists a component of @xmath114 containing @xmath68 and @xmath71 as boundary components .",
    "we define the _ adjacency graph _ @xmath389 for @xmath79 as the simplicial graph consisting of a vertex for each curve in @xmath79 and edges corresponding to adjacency with respect to @xmath79 .",
    "adjacency graphs for simplices of maximal dimension in @xmath2 are introduced by irmak @xcite in the work on superinjective maps of @xmath2 .",
    "[ lem - ad ] let @xmath21 be a surface with @xmath390 , and let @xmath391 be a superinjective map .",
    "then for any simplex @xmath79 of maximal dimension in @xmath5 , @xmath63 induces an isomorphism between the adjacency graphs of @xmath79 and @xmath341 .",
    "the proof follows lemma 5.1 in @xcite .",
    "it is enough to prove that @xmath63 preserves adjacency and non - adjacency with respect to @xmath79 .",
    "note that two curves in @xmath79 are adjacent with respect to @xmath79 if and only if there exists a separating curve in @xmath0 which intersect both of them and is disjoint from any other curve of @xmath79 .",
    "this proves that @xmath63 preserves adjacency .",
    "let @xmath392 , where @xmath393 .",
    "if @xmath157 and @xmath103 are not adjacent with respect to @xmath79 , then one can find two separating curves @xmath158 and @xmath104 such that @xmath394 is a simplex of maximal dimension in @xmath5 for any @xmath395 .",
    "it is then obvious that @xmath157 , @xmath103 , @xmath158 and @xmath104 form a square in @xmath5 in this order .",
    "conversely , if @xmath157 and @xmath103 are adjacent with respect to @xmath79 , then there exists a component @xmath116 of @xmath396 containing @xmath157 and @xmath103 , where we put @xmath397",
    ". one can easily show @xmath294 .",
    "since there exists no square in @xmath398 , this proves that @xmath63 preserves non - adjacency .",
    "[ lem - chi ] let @xmath21 be a surface with @xmath399 and let @xmath391 be a superinjective map . then the following assertions hold :    1 .",
    "for each @xmath364 , let @xmath400 be components of @xmath115 and let @xmath401 be components of @xmath402 .",
    "then the inclusion @xmath403 holds for each @xmath138 after exchanging the indices if necessary .",
    "@xmath63 is @xmath404-preserving , i.e. , @xmath405 for each @xmath138 in the assertion ( i ) .",
    "the claim in the case @xmath406 is obvious .",
    "assume @xmath390 . recall that we refer as an _ hp - curve _ in @xmath0 a curve which is either an h - curve or a p - curve in @xmath0 .",
    "we first show that if @xmath364 is an hp - curve , then so is @xmath269 .",
    "let @xmath116 be the component of @xmath115 that is neither a handle nor a pair of pants .",
    "superinjectivity of @xmath63 implies the inclusion @xmath407 for some component @xmath135 of @xmath402 .",
    "it follows from lemma [ lem - sep - number ] and superinjectivity of @xmath63 that @xmath408 and @xmath269 is an hp - curve .",
    "let @xmath364 be a curve which is not an hp - curve .",
    "let @xmath409 and @xmath410 be components of @xmath115 , and let @xmath411 and @xmath412 be components of @xmath402 .",
    "superinjectivity of @xmath63 implies that for each @xmath138 , there exists @xmath205 such that @xmath413 . if the assertion ( i ) were not true , then @xmath414 for some @xmath205 . by lemma [ lem - sep - number ] , @xmath415 , and",
    "thus @xmath269 is an hp - curve .",
    "note that any simplex of @xmath5 contains at most @xmath416 hp - curves if @xmath390 .",
    "if the number of components of @xmath130 contained in one of components of @xmath115 is even , then by choosing a simplex of @xmath5 containing @xmath68 and @xmath416 hp - curves , one can deduce a contradiction .",
    "suppose that the numbers of components of @xmath130 contained in both components of @xmath115 are odd .",
    "choose a simplex @xmath79 of maximal dimension in @xmath5 containing the two curves @xmath157 and @xmath158 described in figure [ fig - si ] ( a ) . in the adjacency graph @xmath389 , @xmath68 and @xmath159 are adjacent for each @xmath417 , and @xmath157 and @xmath158 are not adjacent .",
    "let @xmath418 denote the pair of pants in @xmath419 that contains the hp - curve @xmath269 and is different from the one cut off by @xmath269 from @xmath0 . since @xmath269 and @xmath420 are adjacent for each @xmath417 in the graph @xmath421 by lemma [ lem - ad ] , @xmath422 and @xmath423 are boundary components of @xmath418 .",
    "this is a contradiction because @xmath422 and @xmath423 are not adjacent in @xmath421 by the same lemma .",
    "we thus proved the assertion ( i ) .",
    "the assertion ( ii ) follows from lemma [ lem - sep - number ] .",
    "[ lem - top - pre - s ] let @xmath21 be a surface with @xmath390 . then",
    "any superinjective map @xmath391 preserves topological types , that is , @xmath424 and @xmath425 are homeomorphic for each @xmath359 in the notation in lemma [ lem - chi ] .",
    "once it is shown that @xmath63 preserves h - curves , one can easily verify that @xmath63 preserves topological types . to prove it",
    ", we may assume @xmath187 .",
    "when @xmath127 or @xmath426 , the claim immediately follows because @xmath63 is @xmath404-preserving and there is no p - curve in @xmath0 . in what follows ,",
    "we assume @xmath26 and that there exists a p - curve @xmath68 in @xmath0 such that @xmath269 is an h - curve .",
    "one can find an hp - curve @xmath71 in @xmath0 different and disjoint from @xmath68 .",
    "lemma [ lem - chi ] implies that @xmath286 is also an hp - curve .",
    "choose @xmath427 as in figure [ fig - si ] ( b ) . since any separating curve in @xmath46 is an h - curve",
    ", @xmath428 is an h - curve ( see figure [ fig - si ] ( c ) ) .",
    "this contradicts the fact that @xmath63 is @xmath404-preserving .",
    "summarizing the argument in this section , we obtain the following :    [ prop - top - pre ] let @xmath21 be a surface satisfying either @xmath23 and @xmath295 ; or @xmath187 and @xmath390 .",
    "let @xmath57 be a superinjective map .",
    "then the inclusions @xmath264 and @xmath265 hold , and the restriction of @xmath63 to @xmath5 preserves topological types .",
    "the latter assertion in the proposition means that for each @xmath364 , @xmath424 and @xmath425 are homeomorphic and the inclusion @xmath403 holds for each @xmath359 , where @xmath409 , @xmath410 are components of @xmath115 and @xmath411 , @xmath412 are components of @xmath402 with an appropriate numbering .",
    "let @xmath0 be a surface of genus one . given a superinjective map @xmath57",
    ", we construct a simplicial map @xmath62 which induces @xmath63 .",
    "this map @xmath64 will be defined as follows : let @xmath429 . if @xmath331 is separating , then we put @xmath430 . if @xmath331 is non - separating , then we choose two bps @xmath431 such that the pair @xmath432 is a rooted 1-simplex of @xmath4 whose root curve is equal to @xmath331 .",
    "we then define @xmath433 as the root curve of the rooted 1-simplex @xmath434 of @xmath4 .",
    "sections [ subsec - si - p3 ] and [ subsec - si - p4 ] are devoted to showing that our construction of @xmath64 is well - defined .",
    "section [ subsec - simp - inj ] proves that @xmath64 is an injective simplicial map .",
    "we then conclude that @xmath64 is an automorphism of @xmath2 by using theorem [ thm - sha ] .",
    "we put @xmath296 throughout this subsection .",
    "[ lem - pent - share ] suppose that we are given a pentagon in @xmath4 whose vertices are labeled as in figure [ fig - pent ] ( a ) .",
    "assume that each @xmath246 is a bp - vertex , each @xmath256 is a p - vertex and @xmath166 is an h - vertex .",
    "let @xmath331 denote the root curve for the rooted simplex @xmath435",
    ". then @xmath436 .",
    "it is clear that @xmath437 .",
    "note that the subsurface filled by the two p - curves @xmath103 and @xmath104 is homeomorphic to @xmath438 and contains @xmath130 .",
    "the h - curve @xmath166 is then a boundary curve of this subsurface . since @xmath331 is disjoint from @xmath103 and @xmath104 , @xmath331 is disjoint from @xmath166 .",
    "[ lem - pen - root ] let @xmath439 and @xmath440 be pentagons in @xmath4 sharing two edges which share a vertex as described in figure [ fig - pent ] ( b ) .",
    "assume that each @xmath246 is a bp - vertex , each @xmath256 is a p - vertex and @xmath166 is an h - vertex .",
    "then the root curves for the simplices @xmath435 and @xmath441 are equal .",
    "let @xmath331 be the root curve for @xmath435 .",
    "if the root curve for @xmath441 were not equal to @xmath331 , then we could put @xmath442 with @xmath443 .",
    "applying lemma [ lem - pent - share ] to @xmath439 , we see @xmath444 . since @xmath445",
    ", we have @xmath446 .",
    "on the other hand , applying lemma [ lem - pent - share ] to @xmath440 , we have @xmath447 .",
    "this is a contradiction .",
    "[ lem - pen - chain ] let @xmath448 be a non - separating curve in @xmath0 , and let @xmath449 be bps such that each of the pairs @xmath435 and @xmath441 is a rooted simplex of @xmath4 whose root curve is @xmath331 .",
    "then there exists a sequence of pentagons , @xmath450 , in @xmath4 satisfying the following three conditions :    1 .   for each @xmath138 ,",
    "the pentagon @xmath451 consists of h- , p- , bp- , bp- and p - vertices in this order .",
    "@xmath452 , @xmath453 and @xmath454 for each @xmath138 .",
    "3 .   for each @xmath138 , the two pentagons @xmath451 and @xmath455 have two common edges which share either a bp - vertex or a p - vertex .",
    "we put @xmath456 for @xmath457 .",
    "choose two p - curves @xmath103 , @xmath104 and an h - curve @xmath166 in @xmath0 as described in figure [ fig - pent ] ( c ) .",
    "we then have the pentagon @xmath439 in @xmath4 consisting of vertices @xmath157 , @xmath158 , @xmath104 , @xmath166 and @xmath103 .",
    "label components of @xmath130 as @xmath302 , @xmath303 and @xmath304 as in figure [ fig - pent ] ( c ) .",
    "let @xmath135 be the component of @xmath458 that is not a a pair of pants .",
    "it then follows that @xmath459 is an element of @xmath460 .",
    "let @xmath461 be the half twist about @xmath103 exchanging @xmath302 and @xmath303 , and let @xmath462 be the bp twist about @xmath158 .",
    "we denote by @xmath11 the subgroup of @xmath3 generated by @xmath463 and @xmath122 .",
    "since @xmath11 fixes @xmath331 and @xmath464 , one obtains the natural homomorphism @xmath465 .",
    "we denote by @xmath466 the subgroup of @xmath467 consisting of all elements which fix the two components of @xmath468 corresponding to @xmath331 and @xmath464 . we claim that @xmath469 is equal to @xmath466 .",
    "obviously , @xmath470 is the half twist about @xmath471 , and @xmath472 is the dehn twist ( or its inverse ) about @xmath473 .",
    "hence , @xmath474 .",
    "since the dehn twists about @xmath103 and @xmath335 generate @xmath475 and since @xmath476 exchanges @xmath302 and @xmath303 , we have the inclusion @xmath477 .",
    "this proves the claim .",
    "when we regard @xmath335 and @xmath459 as elements of @xmath460 , we see that @xmath335 and @xmath459 lie in the same orbit for the action of @xmath466 on @xmath460 because @xmath331 and @xmath464 are contained in different components of @xmath478 and the same holds for @xmath479 .",
    "the claim in the previous paragraph shows that there exist integers @xmath480 , @xmath481 such that @xmath482 we put @xmath483 if @xmath484 and put @xmath485 if @xmath486 .",
    "similarly , we define @xmath487 by using @xmath481 .",
    "it then follows that the sequence of pentagons in @xmath4 , @xmath488 satisfies the conditions ( a ) , ( b ) and ( c ) in the lemma .",
    "let @xmath135 be a surface of genus zero , and let @xmath302 and @xmath303 be boundary components of @xmath135 .",
    "we say that a curve @xmath68 in @xmath135 _ separates _ @xmath302 and @xmath303 if @xmath302 and @xmath303 are contained in different components of @xmath489 .",
    "[ prop - d - conn ] let @xmath135 be a surface homeomorphic to @xmath490 with @xmath37 , and choose two components @xmath302 and @xmath303 of @xmath468 .",
    "then the full subcomplex @xmath491 of @xmath310 spanned by all vertices corresponding to curves which separate @xmath302 and @xmath303 is connected .",
    "let @xmath492 denote components of @xmath468 and put @xmath493 .",
    "when components of @xmath468 is denoted as in figure [ fig - braid ] ( a ) , it is known that the family of dehn twists @xmath494 about the simple closed curve @xmath495 described in figure [ fig - braid ] ( b ) for any two integers @xmath496 with @xmath497 and @xmath498 generates the pure mapping class group @xmath475 ( see chapters 1 and 4 in @xcite ) .",
    "let us denote by @xmath499 the set of all pairs @xmath500 satisfying these two inequalities .",
    "we put @xmath501 .",
    "given a curve @xmath68 in @xmath135 and a decomposition @xmath502 with @xmath503 , let us say that @xmath68 _ decomponses _ @xmath504 into @xmath505 and @xmath506 if one component of @xmath489 contains @xmath507 for each @xmath508 and another component of @xmath489 contains @xmath306 for each @xmath509 .",
    "let @xmath502 be a decomposition of @xmath504 into two subsets such that @xmath510 , @xmath511 and both @xmath505 and @xmath506 contain at least two elements .",
    "then one can find a path in @xmath512 connecting @xmath357 and a vertex @xmath331 of @xmath512 which decomposes @xmath504 into @xmath505 and @xmath506 .    if @xmath513 , then one can readily find a curve @xmath331 such that @xmath514 and @xmath331 decomposes @xmath504 into @xmath505 and @xmath506 .",
    "assume @xmath515 .",
    "if @xmath516 , then one can find a path of curves @xmath357 , @xmath333 , @xmath331 in @xmath517 such that @xmath333 decomposes @xmath504 into @xmath518 and @xmath519 and @xmath331 decomposes @xmath504 into @xmath505 and @xmath506 . if @xmath520 , then @xmath521 .",
    "one can then find a path @xmath357 , @xmath464 , @xmath335 , @xmath459 in @xmath517 consisting of p - vertices and satisfying the following : for each @xmath457 , let @xmath522 denote the pair of pants cut off by @xmath195 .",
    "then @xmath523 contains @xmath302 and @xmath524 , @xmath525 contains @xmath303 and @xmath526 , and @xmath527 contains @xmath302 and @xmath304 .",
    "there exists a path in @xmath512 connecting @xmath357 and @xmath528 for each @xmath529 .",
    "pick @xmath529 . if @xmath530 , then @xmath531 , and thus @xmath532 .",
    "if @xmath533 and @xmath534 , then @xmath535 , and thus @xmath536 . since @xmath537 is a vertex of @xmath512 and since @xmath538 , one can connect @xmath357 and @xmath539 .",
    "figure [ fig - conn ] shows that @xmath357 and @xmath540 can be connected in @xmath512 via @xmath464 , @xmath335 and @xmath459 .",
    "it is easy to see that the second claim implies that each point of the orbit for the action of @xmath475 on @xmath512 containing @xmath357 can be connected with @xmath357 and that the first claim then implies that @xmath512 is connected .",
    "this kind of argument proving connectivity has already appeared in lemma 2.1 of @xcite .",
    "[ lem - bp - a - conn ] let @xmath56 be a surface with @xmath24 , and let @xmath448 be a non - separating curve in @xmath0 .",
    "then the full subcomplex of @xmath4 spanned by all vertices corresponding to bps containing @xmath331 is connected .",
    "let @xmath135 be the surface obtained by cutting @xmath0 along @xmath331 .",
    "we denote by @xmath302 and @xmath303 the two components of @xmath468 corresponding to @xmath331 .",
    "it is obvious that there is a natural one - to - one correspondence between vertices of the complex @xmath491 and bp - vertices of @xmath4 containing @xmath331 .",
    "proposition [ prop - d - conn ] then shows the lemma .",
    "let @xmath57 be a superinjective map .",
    "we define a map @xmath541 as follows : let @xmath429 . if @xmath331 is separating , then we put @xmath430 . if @xmath331 is non - separating , then we choose two bps @xmath431 such that the pair @xmath432 is a rooted 1-simplex of @xmath4 whose root curve is equal to @xmath331 .",
    "we then define @xmath433 as the root curve of the rooted 1-simplex @xmath434 of @xmath4 .",
    "lemma [ lem - rooted ] implies that the pair @xmath434 is rooted .",
    "it follows from lemmas [ lem - pen - chain ] and [ lem - bp - a - conn ] that any two rooted 1-simplices @xmath542 , @xmath543 with the same root curve @xmath331 can be connected by a sequence of pentagons such that two successive pentagons in it have two common edges which share either a bp - vertex or a p - vertex .",
    "lemma [ lem - pen - root ] then shows that the root curves for @xmath544 and @xmath545 are equal .",
    "this proves that @xmath64 is well - defined .",
    "we put @xmath56 with @xmath35 throughout this subsection .",
    "[ lem - three - bp ] the following assertions hold :    1 .   let @xmath103 , @xmath104 and @xmath170 be bps in @xmath0 such that both of the pairs @xmath171 and @xmath546 form rooted simplices of @xmath4 . if there exists a vertex @xmath371 satisfying @xmath547 and @xmath548 , then the root curves of @xmath171 and @xmath546 are equal .",
    "if @xmath549 is a rooted 2-simplex , then there exists a vertex @xmath550 satisfying @xmath547 and @xmath548 .",
    "if the conclusion of the assertion ( i ) were not true , then one of the two curves in @xmath104 would be contained in @xmath103 and another curve would be contained in @xmath170 .",
    "hence , any curve in @xmath80 intersecting @xmath104 intersects either @xmath103 or @xmath170 .",
    "this contradicts the existence of @xmath166 .    on the assumption in the assertion ( ii ) , choose a curve @xmath268 with @xmath551 and @xmath552 .",
    "the bp @xmath553 satisfies the desired condition .",
    "[ lem - bp-2-conn ] let @xmath68 , @xmath71 and @xmath166 be bps in @xmath0 such that both of the pairs @xmath432 and @xmath76 are rooted 1-simplices of @xmath4 and the root curves for them are equal .",
    "let @xmath448 denote the root curve .",
    "then there exists a sequence @xmath554 of bps in @xmath0 such that for each @xmath555 , @xmath246 contains @xmath331 and @xmath556 is a 2-simplex of @xmath4 , where @xmath557 and @xmath558 .    let @xmath135 be the surface obtained by cutting @xmath0 along @xmath331 .",
    "we denote by @xmath302 and @xmath303 the two components of @xmath468 corresponding to @xmath331 .",
    "the surface @xmath135 is homeomorphic to @xmath559 , and we have @xmath560 . note that there is a natural one - to - one correspondence between vertices of the complex @xmath491 in proposition [ prop - d - conn ] and bp - vertices of @xmath4 containing @xmath331 .",
    "it therefore suffices to prove that the link of each vertex of @xmath512 is connected .",
    "let @xmath333 be a vertex of @xmath512 .",
    "if @xmath333 is not a p - curve in @xmath135 , then it is clear that the link of @xmath333 in @xmath512 is connected . if @xmath333 is a p - curve in @xmath135 , then the component of @xmath561 that is not a pair of pants is homeomorphic to @xmath562 .",
    "since we have @xmath563 , proposition [ prop - d - conn ] implies that the link of @xmath333 in @xmath512 is connected .",
    "let @xmath57 be a superinjective map .",
    "we define a map @xmath541 in the same manner as in the previous subsection .",
    "namely , we define @xmath564 on @xmath565 and if @xmath429 is a non - separating curve , then we choose two bps @xmath431 such that the pair @xmath432 is a rooted 1-simplex of @xmath4 whose root curve is equal to @xmath331 .",
    "we then define @xmath433 as the root curve for the rooted 1-simplex @xmath434 of @xmath4 . by using lemmas [ lem - bp - a - conn ] and [ lem - bp-2-conn ]",
    ", one can construct a sequence of rooted 2-simplices between any two given rooted 1-simplices with the same root curve @xmath331 .",
    "lemma [ lem - three - bp ] is then applied to proving that @xmath64 is well - defined .      in this subsection",
    ", we fix a surface @xmath56 with @xmath24 and fix a superinjective map @xmath57 . let @xmath541 be the map constructed in sections [ subsec - si - p3 ] and [ subsec - si - p4 ] .",
    "we first prove that our @xmath64 in fact is a map inducing @xmath63 .",
    "[ lem - phi - bp ] the equality @xmath566 holds for each bp @xmath567 in @xmath0 .",
    "it follows from the definition of @xmath64 that both @xmath568 and @xmath569 are contained in @xmath570 .",
    "it suffices to show @xmath571 . after choosing a non - separating curve @xmath572 in @xmath0 such that both @xmath573 and @xmath574 form bps in @xmath0",
    ", one can readily prove @xmath571 by using lemma [ lem - simp - ind ] .",
    "the map @xmath64 defines a simplicial map from @xmath2 into @xmath2 .",
    "let @xmath575 be two distinct curves with @xmath282 .",
    "if both @xmath331 and @xmath333 are separating , then @xmath576 . if both @xmath331 and @xmath333 are non - separating , then @xmath567 is a bp since @xmath0 is of genus one .",
    "lemma [ lem - phi - bp ] shows that @xmath577 is also a bp , and thus @xmath578 .",
    "suppose that @xmath331 is non - separating and @xmath333 is separating . unless @xmath333 is an h - curve and @xmath579 , where @xmath580 is the handle cut off by @xmath333 , one can find a non - separating curve @xmath581 such that @xmath582 and the pair @xmath583 is a bp .",
    "it follows from @xmath584 that @xmath585 , and thus @xmath578 .",
    "we now assume that @xmath333 is an h - curve and @xmath579 .",
    "choose separating curves @xmath586 and non - separating curves @xmath587 as described in figure [ fig - simp ] .",
    "note that @xmath333 is the only h - curve in @xmath0 that is disjoint from both of @xmath588 and @xmath589 . by using proposition [ prop - top - pre ]",
    ", one can readily verify that the same holds for the image of these separating curves via @xmath63 .",
    "since @xmath590 and @xmath591 are disjoint and since @xmath592 and @xmath593 are disjoint , we see that @xmath568 is disjoint from @xmath593 and @xmath591 .",
    "therefore , @xmath568 is disjoint from @xmath569 .",
    "the simplicial map @xmath62 is injective .    since @xmath64 preserves separating curves and non - separating curves , respectively , and since the restriction of @xmath64 to @xmath367 is superinjective , it is enough to show that for non - separating curves @xmath331 and @xmath333 in @xmath0 , the equality @xmath594 implies @xmath595 . note that each curve in @xmath596 is either separating in @xmath0 or bp - equivalent to @xmath331 in @xmath0 .",
    "the map @xmath64 induces a superinjective map @xmath597 because @xmath63 is superinjective . since",
    "both @xmath598 and @xmath599 are homeomorphic to @xmath559 , theorem [ thm - sha ] implies that @xmath600 is an isomorphism .",
    "similarly , one obtains an isomorphism @xmath601 .",
    "if @xmath594 , then we have the equality @xmath602 since @xmath63 is injective , the equality @xmath603 holds .",
    "this implies @xmath595 .",
    "applying theorem [ thm - sha ] , we obtain the following conclusion .",
    "[ thm - g-1-si ] let @xmath56 be a surface with @xmath24 , and let @xmath57 be a superinjective map .",
    "then there exists a unique automorphism @xmath64 of @xmath2 such that we have @xmath430 for each separating curve @xmath331 in @xmath0 and @xmath604 for each bp @xmath573 in @xmath0 .    the construction of the simplicial map @xmath62 associated with a superinjective map @xmath57 is valid for a surface @xmath21 with @xmath605 as well after establishing connectivity of an appropriate complex as in proposition [ prop - d - conn ] .",
    "however , it is not clear whether @xmath64 is an isomorphism when @xmath123 .",
    "if one assumes that @xmath63 is an isomorphism , then it easily follows that @xmath64 is an isomorphism .",
    "let @xmath21 be a surface . given @xmath606",
    ", we construct @xmath607 which extends @xmath63 .",
    "when @xmath23 , we first focus on the case @xmath295 . results of this case is used in the case @xmath35 in an inductive argument on @xmath22 . when @xmath123 , the construction of @xmath64 follows the argument , due to brendle - margalit @xcite , using sharing pairs and spines in @xmath0 .",
    "we put @xmath296 throughout this subsection .",
    "note that the link of an h - vertex in @xmath5 consists of only p - vertices and that the link of a p - vertex in @xmath5 consists of only h - vertices .",
    "it follows that there exists no pentagon in @xmath5 .",
    "we say that a 6-tuple @xmath608 of vertices of @xmath5 forms a _ hexagon _ in @xmath5 if @xmath298 , @xmath299 and @xmath609 for each @xmath205 mod @xmath610 ( see figure [ fig - hex ] ) .    , width=453 ]    [ lem - hex ] suppose that we have a 6-tuple @xmath611 of vertices of @xmath5 forming a hexagon with @xmath195 a p - vertex for each @xmath457 .    1 .   for each @xmath457",
    ", let @xmath424 denote the component of @xmath612 homeomorphic to @xmath46 , and let @xmath507 denote the component of @xmath130 contained in @xmath424 .",
    "then @xmath302 , @xmath303 and @xmath304 are different to each other .",
    "2 .   for each @xmath457 , let @xmath425 denote the component of @xmath613 homeomorphic to @xmath438 . then for each @xmath138 mod @xmath614",
    ", one can realize @xmath615 and @xmath616 so that they are disjoint in @xmath425 .",
    "we have @xmath617 for each @xmath138 mod @xmath614 .",
    "we first prove the assertion ( i ) .",
    "suppose the assertion ( i ) is not true .",
    "we may assume @xmath618 , and denote it by @xmath619 .",
    "let @xmath620 be the surface obtained by filling a disk in @xmath619 , and let @xmath621 be the natural map , where @xmath622 is the simplicial cone over @xmath623 with the cone point @xmath311 .",
    "note that @xmath313 consists of all p - curves in @xmath0 cutting off a pair of pants containing @xmath619 .",
    "it is clear that if @xmath331 is a p - curve such that @xmath619 is contained in the component of @xmath598 homeomorphic to @xmath46 and if @xmath333 is an h - curve in @xmath0 disjoint from @xmath331 , then @xmath624 .",
    "this implies that @xmath625 .",
    "if @xmath626 , then @xmath627 implies @xmath628 , and this is a contradiction .",
    "therefore , @xmath629 and @xmath630 is equal to the image via @xmath53 of the other five vertices .",
    "this contradicts the fact that @xmath631 is a simplicial tree for each @xmath632 ( see section 7 of @xcite ) .",
    "suppose that the assertion ( ii ) is not true for @xmath533 .",
    "the other cases are discussed similarly .",
    "since @xmath464 is a p - curve cutting off a pair of pants containing @xmath303 and @xmath304 , the intersection @xmath633 consists of parallel arcs each of which cuts off an annulus containing @xmath302 . similarly , @xmath634 consists of parallel arcs each of which cuts off an annulus containing @xmath303 .",
    "since @xmath634 and @xmath633 intersect , the union of them cuts off an annulus which contains @xmath302 and whose another boundary component consists of an arc in @xmath635 and an arc in @xmath636 .",
    "this contradicts the fact that @xmath459 is a boundary component of a regular neighborhood of @xmath637 and is a p - curve cutting off a pair of pants containing @xmath302 .",
    "this proves the assertion ( ii ) .",
    "the assertion ( iii ) immediately follows from the assertion ( ii ) .",
    "[ lem - hex - share ] in the notation of lemma [ lem - hex ] , there exists a unique non - separating curve in @xmath0 disjoint from all of the curves @xmath195 and @xmath638 for @xmath639 .",
    "lemma [ lem - hex ] shows that each of the intersections @xmath640 and @xmath641 is a single separating arc in @xmath409 . if these two arcs were parallel , then the h - curves corresponding to boundary components of regular neighborhoods of @xmath642 and @xmath643 would be equal .",
    "this is a contradiction .",
    "hence , the two arcs @xmath640 and @xmath641 intersect in @xmath409 .",
    "let @xmath251 be the component of @xmath644 of genus one and having one boundary component .",
    "the intersection @xmath645 then consists of two parallel arcs because @xmath459 is separating in @xmath0 . we can therefore find a unique non - separating curve @xmath166 in @xmath0 disjoint from @xmath464 , @xmath335 and @xmath459 .",
    "it is then obvious that @xmath166 is also disjoint from @xmath635 , @xmath636 and @xmath646 .",
    "given a 6-tuple @xmath611 of vertices of @xmath5 forming a hexagon @xmath647 , we denote by @xmath648 the non - separating curve in @xmath0 satisfying the conclusion of lemma [ lem - hex - share ] .",
    "the proof of lemma [ lem - hex - share ] shows that the topological type of the curves @xmath464 , @xmath335 and @xmath459 in a hexagon of @xmath5 is uniquely determined .",
    "we thus obtain the following :    the action of @xmath38 on the set of subcomplexes of @xmath5 consisting of six vertices forming a hexagon in some order is transitive .",
    "[ lem - equal - c ] if two hexagons @xmath439 and @xmath440 in @xmath5 share two edges which share a p - vertex , then @xmath649 .",
    "let @xmath635 and @xmath636 be two h - vertices in a hexagon @xmath647 of @xmath5 , and let @xmath331 be the p - vertex adjacent to both of @xmath635 and @xmath636 .",
    "the lemma follows from the fact that @xmath648 is the only curve in @xmath0 disjoint from any of @xmath331 , @xmath635 and @xmath636 .",
    "[ lem - hex - chain ] fix a non - separating curve @xmath166 in @xmath0 , and let @xmath647 and @xmath418 be hexagons with @xmath650 .",
    "then there exists a sequence of hexagons , @xmath450 , in @xmath5 satisfying the following two conditions :    1 .",
    "@xmath651 and @xmath652 .",
    "2 .   for each @xmath138 ,",
    "the two hexagons @xmath451 and @xmath455 share two edges which share a p - vertex .    to prove this lemma",
    ", we need the following proposition , which can be readily proved along the same spirit as proposition [ prop - d - conn ] .",
    "[ prop - d - conn2 ] we put @xmath653 and choose two components @xmath302 , @xmath303 of @xmath468 .",
    "we define @xmath654 as the simplicial graph so that    * the set of vertices is given by the set of all curves in @xmath135 which cut off a pair of pants containing @xmath302 and @xmath303 ; and * two such vertices @xmath331 , @xmath333 are connected by an edge if and only if @xmath655 .",
    "then the graph @xmath654 is connected .",
    "we first prove the lemma when @xmath647 and @xmath418 have a common h - vertex .",
    "let @xmath611 be a 6-tuple of vertices of @xmath5 forming @xmath647 with @xmath195 a p - vertex for each @xmath457 , as described in figure [ fig - hex ] .",
    "assume that @xmath418 contains @xmath646 .",
    "if we denote by @xmath463 the involution that is described in figure [ fig - inv ] ( a ) and exchanges @xmath464 and @xmath335 ,",
    "then we have @xmath656 .",
    "note that @xmath463 and the half twists about @xmath464 and @xmath335 generate the stabilizer of @xmath646 and @xmath166 in @xmath3 .",
    "the uniqueness of the topological type of hexagons in @xmath5 implies that @xmath418 is the image of @xmath647 by a product of @xmath463 , the half twists about @xmath464 and @xmath335 and their inverses . as in the proof of lemma [ lem - pen - chain ]",
    ", we can then find a sequence of hexagons satisfying the conditions ( a ) and ( b ) .    in general",
    ", proposition [ prop - d - conn2 ] shows that there exists a sequence , @xmath554 , of vertices in @xmath5 such that    * @xmath657 and @xmath658 for each @xmath205 ; * @xmath157 is an h - vertex in @xmath647 , and @xmath659 is an h - vertex in @xmath418 ; and * for each @xmath205 , if @xmath159 is a p - vertex , then the three vertices @xmath660 , @xmath159 and @xmath661 lie in a hexagon of @xmath5 .    by using this sequence and the fact proved in the previous paragraph ,",
    "we obtain a desired sequence of hexagons .",
    "any two of which are connected by an edge in the graph @xmath662,width=453 ]    [ lem - pre - h - p ] any superinjective map @xmath391 preserves h - vertices and p - vertices in @xmath0 , respectively .",
    "pick @xmath379 .",
    "we define a simplicial graph @xmath662 as follows : the set of vertices of @xmath662 is given by the set of vertices in the link of @xmath331 in @xmath5 .",
    "two distinct vertices @xmath635 , @xmath636 in @xmath662 are connected by an edge if and only if there exists a hexagon containing @xmath331 , @xmath635 and @xmath636 .",
    "note that when @xmath331 is an h - vertex ( resp .",
    "a p - vertex ) , @xmath635 and @xmath636 are connected if and only if @xmath663 ( resp .",
    "@xmath664 ) .",
    "if @xmath331 is an h - vertex , then @xmath662 is the farey graph .",
    "one can easily see that if @xmath331 is a p - vertex , then @xmath662 contains at least four vertices such that any two of them are connected by an edge ( see figure [ fig - inv ] ( b ) ) .",
    "this proves the lemma because the farey graph does not contain such a subgraph and because the link of an h - vertex ( resp .",
    "a p - vertex ) in @xmath5 consists of p - vertices ( resp .",
    "h - vertices ) .",
    "[ thm - ext - p3 ] we put @xmath296",
    ". then for each automorphism @xmath63 of @xmath5 , there exists a unique automorphism @xmath64 of @xmath2 such that @xmath430 for each separating curve @xmath331 in @xmath0",
    ".    let @xmath606 .",
    "since @xmath63 preserves hexagons of @xmath5 , we define the extension @xmath541 of @xmath63 by putting @xmath665 for each non - separating curve @xmath166 in @xmath0 , where @xmath647 is a hexagon of @xmath5 with @xmath666 .",
    "this is well - defined thanks to lemmas [ lem - equal - c ] , [ lem - hex - chain ] and [ lem - pre - h - p ] .",
    "it is clear that @xmath64 is bijective .",
    "we next prove that @xmath64 is simplicial .",
    "it is easy to see that for two curves @xmath174 and @xmath179 in @xmath0 , @xmath667 implies @xmath668 unless both @xmath174 and @xmath179 are non - separating .",
    "let @xmath174 and @xmath179 be distinct non - separating curves in @xmath0 .",
    "we note that if @xmath174 and @xmath179 are disjoint , then there exist infinitely many p - curves in @xmath0 disjoint from both of @xmath174 and @xmath179 , and there is no h - curve in @xmath0 disjoint from both of @xmath174 and @xmath179 .",
    "assume that @xmath174 and @xmath179 intersect .",
    "if the subsurface of @xmath0 filled by @xmath174 and @xmath179 is homeomorphic to @xmath74 , then there exists an h - curve in @xmath0 disjoint from both of @xmath174 and @xmath179 .",
    "otherwise , one can find at most one p - curve in @xmath0 disjoint from both of @xmath174 and @xmath179 if it exists .",
    "these observations prove that @xmath64 preserves two disjoint non - separating curves in @xmath0 and that @xmath64 is simplicial .",
    "given a superinjective map @xmath391 , one can define a map @xmath541 and prove that @xmath64 is a simplicial map from @xmath2 into itself in the same way as in the proof of theorem [ thm - ext - p3 ] .",
    "however , it is not obvious whether @xmath64 is ( super)injective or not . once @xmath64 is shown to be injective , the same conclusion as theorem [ thm - ext - p3 ] follows from theorem [ thm - sha ] .",
    "let @xmath56 be a surface with @xmath35 , and fix @xmath606 .",
    "we define a simplicial automorphism of @xmath2 extending @xmath63 by induction on @xmath22 . for an integer @xmath669 with @xmath670",
    ", we refer as a @xmath669-_hbc ( hole bounding curve ) _ in @xmath0 a separating curve @xmath331 in @xmath0 such that the component of @xmath598 of genus zero contains exactly @xmath669 components of @xmath130 .",
    "let @xmath331 be a @xmath669-hbc in @xmath0 with @xmath671 .",
    "by the hypothesis of the induction , we obtain a simplicial isomorphism @xmath672 extending the restriction of @xmath63 to @xmath673 , where for each @xmath674 , @xmath675 denotes the link of @xmath572 in @xmath2 .",
    "we next assume that @xmath331 is a @xmath676-hbc in @xmath0 .",
    "let @xmath409 and @xmath410 be two components of @xmath598 with @xmath409 of genus one . choosing a separating curve @xmath333 in @xmath410 , we define a simplicial isomorphism @xmath672 as @xmath677 on @xmath678 and @xmath679 on @xmath680 .",
    "note that @xmath333 is a @xmath669-hbc with @xmath671 and that @xmath680 is contained in @xmath565 .",
    "this definition is independent of the choice of @xmath572 thanks to the following lemma , which is readily proved by using theorem [ thm - cc ] .",
    "[ lem - uni ] we put @xmath681 with @xmath26 .",
    "then two simplicial automorphisms of @xmath310 which preserve @xmath682 and are equal on @xmath682 are equal on @xmath460 .",
    "let @xmath683 be the set of all @xmath669-hbcs in @xmath0 with @xmath684 .",
    "lemma [ lem - uni ] also shows that if @xmath685 are disjoint curves , then @xmath686 on @xmath687 . by using the following proposition ,",
    "one obtains a simplicial automorphism @xmath64 of @xmath2 as an extension of @xmath688 for each @xmath689 .",
    "we put @xmath690 with @xmath691 and choose two components @xmath302 , @xmath303 of @xmath468 .",
    "we define @xmath692 as the full subcomplex of @xmath310 spanned by all curves @xmath331 in @xmath135 such that one component of @xmath693 contains both @xmath302 and @xmath303 and contains at least three components of @xmath468",
    ". then @xmath692 is connected .",
    "this proposition is also verified along the same idea used in the proof of proposition [ prop - d - conn ] . combining theorem [ thm - ext - p3 ] , we proved the following :    [ thm - g-1-s ] let @xmath56 be a surface with @xmath24 .",
    "then for each automorphism @xmath63 of @xmath5 , there exists a unique automorphism @xmath64 of @xmath2 such that @xmath430 for each separating curve @xmath331 in @xmath0 .",
    "the idea for the construction of @xmath64 due to brendle - margalit @xcite is to use sharing pairs defined below .",
    "[ defn - share ] let @xmath21 be a surface with @xmath123 and @xmath694 , and let @xmath68 and @xmath71 be h - curves in @xmath0 .",
    "we denote by @xmath695 and @xmath696 the handles cut off by @xmath68 and @xmath71 , respectively .",
    "we say that @xmath68 and @xmath71 _ share _ a non - separating curve @xmath333 in @xmath0 if @xmath697 is an annulus with its core curve @xmath333 and if @xmath698 is connected ( after exchanging @xmath68 and @xmath71 into curves isotopic to themselves if necessary ) . in this case , we also say that @xmath432 is a _ sharing pair _ for @xmath333 ( see figure [ fig - spine ] ( a ) ) .        by looking at the arcs @xmath699",
    ", one can easily see that if a pair @xmath432 of h - curves share a non - separating curve @xmath333 , then @xmath700 , and the subsurface filled by @xmath68 and @xmath71 is homeomorphic to @xmath438 and has two boundary components corresponding to @xmath333 .",
    "it is also shown that topological types of sharing pairs are the same , i.e. , the action of @xmath38 on the set of sharing pairs is transitive .",
    "note that when @xmath0 is a surface of genus one , there exists no pair @xmath432 of h - curves in @xmath0 satisfying the condition in definition [ defn - share ] .",
    "the following lemma characterizes sharing pairs in terms of disjointness and non - disjointness .",
    "[ lem - share - cha ]",
    "let @xmath21 be a surface with @xmath123 and @xmath390 , and let @xmath68 and @xmath71 be h - curves in @xmath0 .",
    "then @xmath68 and @xmath71 form a sharing pair if and only if there exist separating curves @xmath701 , @xmath122 , @xmath702 and @xmath703 in @xmath0 satisfying the following six conditions :    * @xmath703 cuts off a subsurface @xmath116 homeomorphic to @xmath47 from @xmath0 ; * @xmath704 and @xmath113 ; * @xmath705 ; * @xmath706 , @xmath707 and @xmath708 ; * @xmath709 , @xmath710 and @xmath711 ; and * @xmath712 , @xmath713 and @xmath714 .",
    "this lemma for closed surfaces is proved in lemma 4.1 and addendum of @xcite . the same proof of the  if \" part is also valid for general surfaces .",
    "the  only if \" part is proved by using figure [ fig - share ] ( a ) and ( b ) for surfaces with @xmath27 and @xmath25 , respectively .",
    "let @xmath606 .",
    "lemmas [ lem - top - pre - s ] and [ lem - share - cha ] imply that @xmath63 preserves sharing pairs .",
    "we will define a map @xmath541 extending @xmath63 by letting @xmath568 be the curve shared by @xmath269 and @xmath286 for each non - separating curve @xmath331 in @xmath0 , where @xmath432 is a sharing pair for @xmath331 .",
    "spines for sharing pairs , defined below , were introduced in @xcite to show that @xmath64 is well - defined . for two curves @xmath715 with @xmath716 , we denote by @xmath717 the handle filled by @xmath331 and @xmath333 .",
    "[ defn - spine ] let @xmath21 be a surface with @xmath123 and @xmath694 . a triplet of distinct non - separating curves in @xmath0 , @xmath718 , is called a _ spine _ in @xmath0",
    "if the following three conditions are satisfied :    1 .   @xmath719 and @xmath720 .",
    "2 .   let @xmath68 and @xmath71 denote the boundary components of the handles @xmath717 and @xmath721 , respectively .",
    "then @xmath432 is a sharing pair for @xmath333 .",
    "3 .   there exist realizations @xmath722 , @xmath723 and @xmath724 of @xmath331 , @xmath333 and @xmath572 , respectively , such that they intersect transversely and @xmath725 is connected .    in this case",
    ", @xmath718 is called a spine for the sharing pair @xmath432 ( see figure [ fig - spine ] ( b ) )",
    ".    a _ move _ between two spines in @xmath0 is defined to be a change of the form , @xmath726 , with @xmath727 a spine .    in",
    "what follows , we describe some basic properties of spines and moves between them , which will be used to prove that @xmath64 is well - defined .",
    "let @xmath21 be a surface with @xmath123 and @xmath694 .",
    "suppose that we are given a spine @xmath718 in @xmath0 , and let @xmath722 , @xmath723 and @xmath724 be realizations of @xmath331 , @xmath333 and @xmath572 , respectively , satisfying the condition ( c ) in definition [ defn - spine ]",
    ". then    1 .",
    "@xmath728 , @xmath729 and @xmath730 .",
    "let @xmath135 denote the surface obtained by cutting @xmath0 along @xmath722 and @xmath723 .",
    "let @xmath228 , @xmath731 , @xmath732 and @xmath733 denote the identified points on the cut end that correspond to the intersection of @xmath722 and @xmath723 ( see figure [ fig - spine ] ( c ) )",
    ". then    1 .   if @xmath734 , then @xmath735 . in this case , @xmath724 is given by an essential arc in @xmath135 connecting either @xmath228 and @xmath732 or @xmath731 and @xmath733 .",
    "2 .   if @xmath736 , then @xmath724 is given by an essential arc in @xmath135 connecting a point in an arc corresponding to @xmath723 with a point in another arc corresponding to @xmath723 . in this case , @xmath724 is isotopic to a simple closed curve in @xmath0 which is given by an essential arc in @xmath135 connecting either @xmath228 and @xmath733 or @xmath731 and @xmath732 .",
    "the assertion ( i ) immediately follows from the bigon criterion ( see proposition 1.3 in @xcite ) .",
    "let @xmath737 and @xmath738 be curves in @xmath0 corresponding to boundary components of the subsurface filled by @xmath331 , @xmath333 and @xmath572 .",
    "since @xmath739 is connected , @xmath724 is given by a single essential arc @xmath740 in @xmath135 connecting either two of @xmath228 , @xmath731 , @xmath732 and @xmath733 or two points in the arcs corresponding to @xmath723 . if @xmath740 connected either @xmath228 and @xmath731 or @xmath732 and @xmath733 , then @xmath724 could be moved into a curve disjoint from @xmath723 .",
    "this is a contradiction .",
    "the assertion ( ii ) and ( iii ) then follows .",
    "[ lem - move - sep ]",
    "let @xmath21 be a surface with @xmath123 and @xmath694 .",
    "let @xmath726 be a move between two spines in @xmath0 .",
    "then the following two assertions hold :    1 .",
    "let @xmath737 and @xmath738 denote the boundary components of the subsurface of @xmath0 filled by @xmath331 , @xmath333 and @xmath572 .",
    "then @xmath741 intersects either @xmath737 or @xmath738 .",
    "2 .   if @xmath390 , then there exists a separating curve @xmath742 in @xmath0 which intersects @xmath741 , but is disjoint from each of @xmath331 , @xmath333 and @xmath572 .    suppose that @xmath741 intersects nether @xmath737 nor @xmath738 . by the definition of a move of spines , @xmath572 and @xmath741",
    "are given by essential arcs which connect two of @xmath228 , @xmath731 , @xmath732 and @xmath733 in figure [ fig - spine ] ( c ) and are disjoint in their interiors . by using the assumption that @xmath743 is connected , one can easily see that this is impossible .",
    "this proves the assertion ( i ) .",
    "the assertion ( ii ) immediately follows from the assertion ( i ) .",
    "the next lemma can be proved along the same idea as lemma 4.4 in @xcite by using lemma [ lem - move - sep ] .",
    "[ lem - move - well ] let @xmath21 be a surface with @xmath123 and @xmath390 , and let @xmath57 be a superinjective map .",
    "suppose that we are given a move between two spines in @xmath0 , @xmath726 .",
    "we denote by @xmath68 , @xmath71 and @xmath369 the boundary components of the handles @xmath717 , @xmath721 and @xmath744 , respectively .",
    "then @xmath434 and @xmath745 are sharing pairs for the same non - separating curve in @xmath0 .",
    "the next proposition also follows from the argument in the proof of proposition 4.5 in @xcite .",
    "[ prop - move ] let @xmath21 be a surface with @xmath123 and @xmath390 . for each non - separating curve @xmath333 in @xmath0 , any two spines @xmath718 and @xmath746 differ by finitely many moves .",
    "[ thm - g-2 ] let @xmath21 be a surface with @xmath123 and @xmath390 .",
    "then the following assertions hold :    1 .   for each automorphism @xmath63 of @xmath4",
    ", there exists a unique automorphism @xmath64 of @xmath2 such that we have @xmath430 for each separating curve @xmath331 in @xmath0 and @xmath604 for each bp @xmath573 in @xmath0 .",
    "2 .   for each automorphism @xmath747 of @xmath5",
    ", there exists a unique automorphism @xmath748 of @xmath2 such that @xmath749 for each separating curve @xmath331 in @xmath0 .    for each @xmath750",
    ", we define a map @xmath751 as follows : put @xmath749 for each separating curve @xmath331 in @xmath0 , and define @xmath752 as the non - separating curve shared by the pair @xmath753 for each non - separating curve @xmath333 in @xmath0 , where @xmath432 is a sharing pair for @xmath333 .",
    "this is well - defined thanks to lemma [ lem - move - well ] and proposition [ prop - move ] .",
    "we note that lemma [ lem - top - pre - s ] shows that @xmath747 preserves topological types of each vertex of @xmath5 . for an h - curve @xmath68 in @xmath0 ,",
    "we denote by @xmath695 the handle cut off by @xmath68 .",
    "note that in general , if @xmath68 is an h - curve in @xmath0 and @xmath333 is a non - separating curve in @xmath695 , then @xmath754 is also an h - curve in @xmath0 , and @xmath752 is in the handle @xmath755 .",
    "this immediately follows from the definition of the extension @xmath748 .",
    "we next prove that @xmath748 is simplicial .",
    "let @xmath331 and @xmath333 be disjoint and distinct curves in @xmath0 .",
    "if both @xmath331 and @xmath333 are separating , then it is clear that @xmath756 and @xmath752 are disjoint since @xmath747 is simplicial .",
    "if @xmath331 is separating and @xmath333 is non - separating , then there always exists an h - curve @xmath68 in @xmath0 such that @xmath757 and @xmath333 is contained in @xmath695 . since @xmath331 is either equal to @xmath68 or in the complement of @xmath695 , @xmath756 and @xmath752",
    "are disjoint .",
    "finally , we suppose that both @xmath331 and @xmath333 are non - separating . it is readily proved that @xmath756 and @xmath752 are disjoint if there exist distinct and disjoint h - curves @xmath68 and @xmath71 such that @xmath331 lies in @xmath695 and @xmath333 lies in @xmath696 .",
    "otherwise , @xmath331 and @xmath333 form a bp in @xmath0 .",
    "choose separating curves @xmath588 and @xmath589 in @xmath0 which cut off the surface homeomorphic to @xmath46 and containing @xmath331 and @xmath333 ( see figure [ fig - bp ] ) .",
    "lemma [ lem - top - pre - s ] implies that @xmath758 and @xmath759 also cut off the surface homeomorphic to @xmath46 and containing @xmath756 and @xmath752 .",
    "choose a separating curve @xmath742 in @xmath0 which intersects exactly one of @xmath588 and @xmath589 and is disjoint from @xmath331 and @xmath333 .",
    "suppose that @xmath756 and @xmath752 intersect .",
    "let @xmath116 be the subsurface filled by @xmath756 and @xmath752 .",
    "if @xmath116 is a handle , then one can deduce a contradiction by using the inverse @xmath760 and the boundary curve of @xmath116 .",
    "it follows that @xmath761 and the existence of @xmath762 implies a contradiction .",
    "we therefore proved that @xmath748 is simplicial and proved the assertion ( ii ) .",
    "let @xmath763 .",
    "since @xmath63 preserves @xmath565 by lemma [ lem - bp - s ] ( i ) , we obtain the extension @xmath607 of the restriction of @xmath63 to @xmath565 by using the assertion ( ii ) . along the same idea in section 6 of @xcite to find separating curves defining a bp , we can show the equality @xmath604 for each bp @xmath573 in @xmath0 .",
    "using the result on the automorphism groups of the torelli complex and the complex of separating curves , we compute the commensurators of the torelli group and the johnson kernel .",
    "we first present a few facts on abelian subgroups of the torelli group and an algebraic characterization of dehn twists about separating curves and bp twists .",
    "the argument of this subsection heavily depends on @xcite , @xcite and @xcite , where closed surfaces are dealt with .",
    "let @xmath21 be a surface with @xmath764 .",
    "let @xmath79 be a simplex of @xmath2 if @xmath148 , and let @xmath79 be a vertex of @xmath2 otherwise . pick a curve @xmath331 in @xmath79 .",
    "we say that @xmath331 is of _ a - type _ in @xmath79 if @xmath331 is separating in @xmath0 .",
    "we say that @xmath331 is of _ b - type _ in @xmath79 if @xmath331 is non - separating in @xmath0 and is contained in a bp - equivalence class in @xmath79 consisting of at least two curves .",
    "otherwise , i.e. , if @xmath331 is non - separating in @xmath0 and any other curve in @xmath79 is not bp - equivalent to @xmath331 , then @xmath331 is said to be of _ c - type _ in @xmath79 .",
    "each curve of @xmath79 is classified into these three types .",
    "this terminology follows @xcite .",
    "we denote by @xmath765 the subgroup of @xmath3 generated by dehn twists about all curves in @xmath79 .",
    "the following theorem relies on @xcite and @xcite .",
    "[ thm - vau ] let @xmath21 be a surface with @xmath764 .",
    "let @xmath79 be a simplex of @xmath2 if @xmath148 , and let @xmath79 be a vertex of @xmath2 otherwise",
    ". then    1 .",
    "@xmath766 is generated by dehn twists about separating curves in @xmath79 and bp twists about bps of two curves in @xmath79 .",
    "@xmath767 is generated by dehn twists about separating curves in @xmath79 .",
    "when @xmath768 , the theorem immediately follows . when @xmath769 , the assertions ( i ) and ( ii ) are obvious because both @xmath6 and @xmath7 are trivial and any vertex of @xmath2 corresponds to a non - separating curve . when @xmath123 and @xmath127 , the assertions ( i ) and ( ii ) are proved in theorem 3.1 in @xcite and theorem a.1 in @xcite , respectively .",
    "we prove the theorem by induction on the number of boundary components of @xmath0 .",
    "we assume either @xmath23 and @xmath26 or @xmath123 and @xmath770 . filling a disk in a boundary component @xmath771 of @xmath0 ,",
    "one obtains the surface @xmath135 homeomorphic to @xmath772 and the natural simplicial map @xmath312 , where @xmath309 is the simplicial cone over @xmath310 with the cone point @xmath311 .",
    "note that @xmath313 consists of all p - curves in @xmath0 cutting off a pair of pants containing @xmath771 .",
    "we have the natural homomorphism @xmath773 satisfying @xmath774 and @xmath775 .",
    "let @xmath79 be a simplex of @xmath2 .",
    "it is easy to see the following facts :    1 .",
    "let @xmath103 and @xmath104 be distinct curves of b - type in @xmath79 .",
    "note that both @xmath776 and @xmath777 lie in @xmath460 .",
    "if @xmath778 , then @xmath103 and @xmath104 are bp - equivalent in @xmath0 and they cut off a pair of pants containing @xmath771 .",
    "if @xmath166 is a curve of c - type in @xmath79 , then @xmath779 is a curve of c - type in @xmath780 .",
    "we can readily prove the assertions ( i ) by using @xmath669 and the fact ( b ) .",
    "suppose that @xmath781 is not in the group generated by dehn twists about all separating curves in @xmath79 .",
    "we may assume that @xmath122 is a product of dehn twists about non - separating curves in @xmath79 and their inverses .",
    "the assertion ( i ) implies that @xmath122 is a product of bp - twists for bps of curves in @xmath79 . by using the fact ( a ) and the hypothesis of the induction",
    ", we see that @xmath122 is a non - zero power of the bp - twist of the bp in @xmath79 cutting off a pair of pants containing @xmath771 .",
    "this contradicts proposition [ prop - jo - bp ] .",
    "[ lem - abe ] let @xmath21 be a surface with @xmath148 , and let @xmath79 be a simplex of @xmath2 .",
    "we denote by @xmath782 the number of components of @xmath114 and denote by @xmath783 the number of components of @xmath114 which are neither a handle nor a pair of pants",
    ". then    1 .",
    "the inequality @xmath784 holds .",
    "2 .   the inequality @xmath785 holds .",
    "if the equality holds , then each component @xmath116 of @xmath114 satisfies @xmath786 .",
    "3 .   if @xmath722 is an abelian reducible subgroup of @xmath6 whose canonical reduction system is equal to @xmath79 , then @xmath787 .",
    "the assertions ( i ) and ( ii ) can be verified along the idea in the proof of lemmas 3.1 and 3.2 in @xcite , respectively .",
    "the assertion ( iii ) immediately follows from the definition of canonical reduction systems .",
    "we refer to @xcite for the definition of canonical reduction systems for subgroups of @xmath3 . one can prove the next proposition by using lemma [ lem - abe ] and following the proof of theorem 3.3 in @xcite .",
    "let @xmath21 be a surface with @xmath148 .",
    "if @xmath722 is an abelian subgroup of @xmath6 , then @xmath788 and this equality is attained for some @xmath722 .",
    "the same conclusion holds for abelian subgroups of @xmath7 .      to prove the following theorem ,",
    "let us recall reduction system graphs for simplices of @xmath2 , which were introduced in @xcite .",
    "let @xmath21 be a surface with @xmath148 , and let @xmath89 be a simplex of @xmath2 .",
    "the _ reduction system graph _",
    "@xmath789 is then defined as follows : vertices of @xmath789 are given by components of @xmath790 .",
    "edges of @xmath789 are given by curves in @xmath89 .",
    "the two ends of the edge corresponding to a curve @xmath166 in @xmath89 are defined to be vertices corresponding to components of @xmath790 which lie in the left and right hand sides of @xmath166 in @xmath0 .",
    "note that @xmath789 may have a loop .",
    "the reader should consult @xcite for basics of reduction system graphs .    given a group @xmath11 and an element @xmath791 ,",
    "let us denote by @xmath792 the centralizer of @xmath122 in @xmath11 and denote by @xmath793 the center of @xmath11 .",
    "the following result for closed surfaces is announced in @xcite and is proved in @xcite .",
    "[ thm - cha ] let @xmath21 be a surface with @xmath694 and pick @xmath794 .",
    "then @xmath122 is a non - zero power of either the dehn twist about a separating curve in @xmath0 or the bp twist about a bp in @xmath0 if and only if the following three conditions hold :    1 .",
    "@xmath795 is not isomorphic to @xmath796 ; 2 .",
    "@xmath797 is isomorphic to @xmath796 ; and 3 .",
    "@xmath122 is contained in an abelian subgroup of @xmath6 of rank @xmath798 .",
    "this proof follows the argument in theorem 3.5 in @xcite , where closed surfaces are dealt with .",
    "as shown in theorem [ thm - pure ] , each element of @xmath6 is pure in the sense of ivanov @xcite . for each @xmath794 , we put @xmath799 .",
    "if @xmath122 is a non - zero power of the bp twist about an ordered bp @xmath71 , then @xmath800 is the stabilizer of @xmath71 in @xmath6 .",
    "thanks to the assumption @xmath694 , @xmath800 contains a non - abelian free group .",
    "thus , the condition ( a ) holds .",
    "since each element of @xmath800 is pure , we have the natural homomorphism @xmath801 , where @xmath116 and @xmath135 are components of @xmath156 .",
    "one can easily see that the center of the image of @xmath669 is trivial .",
    "it then follows that @xmath802 is equal to @xmath803 , which is the cyclic group generated by @xmath804 .",
    "this proves the condition ( b ) .",
    "it is clear that the condition ( c ) holds .",
    "this argument can be also applied to the case where @xmath122 is a non - zero power of the dehn twist about a separating curve in @xmath0 .",
    "conversely , we assume that @xmath794 satisfies the conditions ( a ) , ( b ) and ( c ) .",
    "it is easy to see that @xmath122 is a reducible element of infinite order .",
    "let @xmath102 be the canonical reduction system for the cyclic group generated by @xmath122 .",
    "one can readily show that if @xmath79 contains a curve of either a - type or b - type , then @xmath122 is a non - zero power of either the dehn twist about a separating curve in @xmath79 or the bp twist about a bp of curves in @xmath79 .",
    "we assume that @xmath79 consists of only curves of c - type and deduce a contradiction . by theorem [ thm - vau ] ( i ) ,",
    "there exists a pseudo - anosov component @xmath116 of @xmath114 for @xmath122 .",
    "let us denote by @xmath805 the set of all curves in @xmath79 corresponding to a component of @xmath806 .",
    "let @xmath722 be an abelian subgroup of @xmath6 of rank @xmath798 containing @xmath122 .",
    "we denote by @xmath807 the canonical reduction system for @xmath722 .",
    "note that @xmath89 contains @xmath79 and that @xmath116 is a component of @xmath790 .",
    "by lemma [ lem - abe ] ( ii ) , ( iii ) , each component of @xmath790 is homeomorphic to one of @xmath75 , @xmath438 , @xmath74 and @xmath46 .",
    "if @xmath116 were homeomorphic to @xmath46 , then at least one curve in @xmath805 would be a curve of either a - type or b - type in @xmath79 .",
    "this is a contradiction .",
    "therefore , @xmath116 is homeomorphic to @xmath438 .",
    "note that there is no curve in @xmath805 whose both sides are contained in @xmath116 because otherwise , one of the other two curves of @xmath805 would be of a - type or b - type in @xmath79 .",
    "each curve of @xmath805 is a curve of either b - type or c - type in @xmath89 . moreover ,",
    "if two curves in @xmath805 are of b - type in @xmath89 , then they are not bp - equivalent in @xmath0 .",
    "let us assume that there is a curve @xmath808 which is a curve of c - type in @xmath89 .",
    "one can construct a maximal tree @xmath251 in the reduction system graph @xmath789 for @xmath89 containing the edge corresponding to @xmath166 because the edge is not a loop .",
    "we write @xmath809 so that    * each @xmath204 is of b - type in @xmath89 , and the family @xmath810 forms a bp - equivalence class in @xmath89 for each @xmath138 ; and * each @xmath811 is of c - type in @xmath89 .",
    "let @xmath812 and @xmath813 be the numbers defined in lemma [ lem - abe ] . since the number of edges of @xmath251 is equal to @xmath814 , we obtain the inequalities @xmath815 and @xmath816 by using lemma [ lem - abe ] .",
    "this is a contradiction .",
    "finally , we suppose that @xmath805 consists of curves of b - type in @xmath89 .",
    "we write @xmath89 as in the previous paragraph .",
    "note that if for each curve @xmath331 in @xmath805 , we choose one curve from the bp - equivalence class of @xmath331 in @xmath89 and if we cut @xmath0 along all chosen curves , then @xmath0 is decomposed into two connected components .",
    "this implies that for any maximal tree @xmath251 in @xmath789 , there exists a curve @xmath333 in @xmath805 such that @xmath251 contains all edges corresponding to curves in the bp - equivalence class of @xmath333 .",
    "we may assume @xmath817 .",
    "we then obtain the inequality @xmath818 and deduce a contradiction as in the previous paragraph",
    ".      the argument of this subsection has already appeared in many works to compute commensurators of mapping class groups and their subgroups ( see e.g. , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite and @xcite ) .",
    "this is outlined as follows : given an injective homomorphism between subgroups of mapping class groups , we associate a superinjective map between appropriate complexes by using characterization of twisting elements in theorem [ thm - cha ] . after proving that the superinjective map is induced from an element of the mapping class group , we conclude that the original homomorphism is given by inner conjugation of that element .",
    "[ prop - homo - si ] let @xmath0 be a surface with @xmath694 , and let @xmath819 be either @xmath820 or @xmath821 . given a finite index subgroup @xmath11 of @xmath822 and an injective homomorphism @xmath823 , one can find a unique superinjective map @xmath111 such that for each vertex @xmath122 of @xmath105 , we have @xmath824 where @xmath825 denotes the group generated by @xmath826 for a vertex @xmath702 of @xmath105 .",
    "if @xmath827 is of finite index in @xmath822 , then @xmath63 is an isomorphism .",
    "let @xmath122 be a vertex of @xmath105 and @xmath828 a non - zero integer with @xmath829 . by using theorem [ thm - cha ] and the fact that @xmath6 is torsion - free ( see theorem [ thm - pure ] )",
    ", one can easily conclude that @xmath830 is a non - zero power of either the dehn twist about a separating curve in @xmath0 or the bp twist about a bp in @xmath0 .",
    "if @xmath831 , then one can define a map @xmath832 so that @xmath833 for each @xmath834 . if @xmath835 , then proposition [ prop - jo - bp ] implies that @xmath830 is a non - zero power of the dehn twist about a separating curve in @xmath0 .",
    "one then defines a map @xmath836 in the same way .",
    "we can prove that @xmath63 is simplicial and superinjective by using the fact that for two vertices @xmath122 , @xmath702 of @xmath105 and for any non - zero integers @xmath828 , @xmath837 , the subgroup generated by @xmath838 and @xmath839 is abelian if and only if @xmath122 and @xmath702 are disjoint . by using @xmath840 , we can prove that @xmath63 is an isomorphism if @xmath827 is of finite index in @xmath822 .",
    "the assertion ( i ) follows from theorem [ thm - g-1-si ] .",
    "let @xmath11 be a finite index subgroup of @xmath6 and @xmath58 an injective homomorphism .",
    "proposition [ prop - homo - si ] implies that there exists a superinjective map @xmath57 such that for each vertex @xmath834 , we have @xmath833 .",
    "it follows from theorem [ thm - g-1-si ] that @xmath63 is induced from an automorphism @xmath64 of @xmath2 , which is induced from a unique element @xmath59 by theorem [ thm - cc ] .",
    "pick @xmath61 . for each separating curve @xmath68 in @xmath0",
    ", we then have @xmath841 and thus @xmath842 .",
    "this implies @xmath843 .",
    "theorems [ thm - tor - comm ] and [ thm - jo - comm ] can be verified in a similar manner by using theorems [ thm - g-1-s ] , [ thm - g-2 ] and proposition [ prop - homo - si ] .",
    "let @xmath0 be a surface and @xmath828 a positive integer .",
    "choose @xmath828 base points @xmath844 in @xmath0 .",
    "we denote by @xmath845 the space of embeddings of the set of @xmath828 points , @xmath846 , into @xmath0 with the compact - open topoloty .",
    "the _ pure braid group of @xmath828-strings _ on @xmath0 , denoted by @xmath847 , is defined to be the fundamental group @xmath848 .",
    "we refer the reader to @xcite , @xcite and @xcite for basic facts on braid groups on surfaces .",
    "let @xmath251 denote the closed torus , and let @xmath849 be a surface of genus one with @xmath828 boundary components . by filling disks in all components of @xmath130",
    ", we obtain the birman exact sequence @xmath850 a description of the homomorphism @xmath205 shows that @xmath152 is equal to @xmath6 . on the other hand",
    ", @xmath851 is equal to the center of @xmath852 , denoted by @xmath853 , which is isomorphic to @xmath854 ( see proposition 4.2 in @xcite for a precise description ) .",
    "we refer to chapter 4 of @xcite and section 2.8 of @xcite for details of the birman exact sequence .",
    "note that @xmath855 is isomorphic to @xmath856 .",
    "this final section describes commensurators of braid groups of @xmath828-strings on the torus @xmath251 with @xmath857 .",
    "the following computation of commensurators of central extensions is discussed in section 3 of @xcite in a general framework , and the reader should consult the reference for more details .",
    "a description of the automorphism groups of ( pure ) braid groups on @xmath251 is given in @xcite .",
    "to carry out the computation in @xcite , we need the following lemma on braid groups on @xmath251 .    [ lem - split ] for each integer @xmath857 , we have a homomorphism @xmath858 such that @xmath22 is injective on the center @xmath853 of @xmath852 and the image @xmath859 is the subgroup of @xmath854 generated by @xmath860 and @xmath861 .",
    "it is known that the braid group @xmath862 of @xmath828-strings on @xmath251 admits the following presentation ( see theorem 1.2 in @xcite ) :    * generators : @xmath863 , @xmath68 , @xmath71 .",
    "* braid relations : 1 .",
    "@xmath864 for each @xmath138 , @xmath205 with @xmath865 ; 2 .",
    "@xmath866 for each @xmath138 with @xmath867 ; * mixed relations : 1 .",
    "@xmath868 and @xmath869 for each @xmath138 with @xmath870 ; 2 .",
    "@xmath871 and @xmath872 ; 3 .",
    "@xmath873 4 .",
    "@xmath874=\\sigma_{1}\\cdots \\sigma_{n-2}\\sigma_{n-1}^{2}\\sigma_{n-2}\\cdots \\sigma_{1}$ ] .",
    "one can then define a homomorphism @xmath875 by putting @xmath876 for each @xmath138 and putting @xmath877 and @xmath878 .",
    "note that @xmath852 is contained in @xmath862 and that the quotient group is isomorphic to the symmetric group of @xmath828 letters .",
    "it follows from geometric description of @xmath79 , @xmath68 and @xmath71 in section 2.2 of @xcite and of the center of @xmath862 in proposition 4.2 of @xcite that the two elements @xmath879 and @xmath880 generate the center of @xmath862 , which is also equal to the center @xmath853 of @xmath852 .",
    "it is then obvious that @xmath859 is generated by @xmath860 and @xmath861 .",
    "let @xmath857 be an integer and @xmath0 a surface of genus one with @xmath828 boundary components .",
    "this lemma implies that the exact sequence @xmath881 virtually split .",
    "more precisely , the exact sequence @xmath882 splits .",
    "one can therefore find a finite index subgroup of @xmath852 isomorphic to @xmath883 , where @xmath11 is a finite index subgroup of @xmath6 . by using the fact that the center of any finite index subgroup of @xmath6 is trivial",
    ", we obtain the split exact sequence @xmath884 the group @xmath885 , called the transvection subgroup , fits into the split exact sequence @xmath886 where @xmath887 is the direct limit taken over all finite index subgroups @xmath888 of @xmath11 . as a conclusion",
    ", we have @xmath889 where we put @xmath890 .",
    "note that @xmath39 is isomorphic to @xmath40 and to the free group of rank two .",
    "since we have a surjective homomorphism from @xmath6 into the free group of rank two , we see that @xmath891 is isomorphic to the countably infinite dimensional vector space @xmath892 over @xmath893 .",
    "theorem [ thm - tor - comm ] shows that @xmath894 is naturally isomorphic to @xmath895 when @xmath896 .",
    "the following theorem is stated in theorem 3.1 of @xcite for the pure braid group on a surface @xmath0 , which is contained in the torelli group @xmath6 .",
    "[ thm - pure ] let @xmath21 be a surface with @xmath187 .",
    "then each element of @xmath6 is pure .",
    "namely , for each element @xmath897 , there exist @xmath898 and realizations @xmath899 of @xmath13 and @xmath724 of @xmath79 such that    * @xmath900 ; * @xmath899 does not exchange components of @xmath724 and components of the surface @xmath901 obtained by cutting @xmath0 along @xmath724 ; and * @xmath899 induces either the identity or a pseudo - anosov homeomorphism on each component of @xmath901 .",
    "[ lem - pre ] let @xmath21 be a surface with @xmath187 and pick @xmath897 .",
    "suppose that @xmath102 is fixed by @xmath13 .",
    "choose realizations @xmath899 of @xmath13 and @xmath724 of @xmath79 such that @xmath900 and @xmath899 is the identity on @xmath130 .",
    "then @xmath899 preserves each component of @xmath724 .",
    "let @xmath620 denote the surface obtained by filling disks in all components of @xmath130 .",
    "we define the homeomorphism @xmath902 of @xmath620 by extending @xmath899 so that @xmath902 is the identity on all filled disks .",
    "we denote by @xmath622 the simplicial cone over @xmath623 with the cone point @xmath311 .",
    "let @xmath621 be the natural map induced from the inclusion of @xmath0 into @xmath620 , where @xmath313 consists of all separating curves in @xmath0 cutting off a surface of genus zero .",
    "assume that there are components @xmath174 , @xmath179 of @xmath724 with @xmath903 and @xmath904 .",
    "we first claim that the equality @xmath905)=\\pi([c_{2}])$ ] holds , where @xmath906 $ ] denotes the isotopy class of a simple closed curve @xmath166 in @xmath0 .",
    "when @xmath23 , the claim is obvious .",
    "assume @xmath123 .",
    "since @xmath902 acts on @xmath907 trivially , theorem 1.2 of @xcite implies that @xmath902 fixes each element of @xmath908 .",
    "thus , we have @xmath905)=\\pi([c_{2}])$ ] .",
    "if @xmath905)=\\pi([c_{2}])=\\ast$ ] , then the sets of components of @xmath130 contained in the surfaces of genus zero cut off by @xmath174 and by @xmath179 are different .",
    "since @xmath909)=[c_{2}]$ ] , this contradicts the fact that @xmath13 does not exchange components of @xmath130 .",
    "let us assume @xmath905)=\\pi([c_{2}])\\in v(\\bar{s})$ ] .",
    "it then follows that @xmath174 and @xmath179 cut off a holed annulus @xmath722 from @xmath0 .",
    "since @xmath13 does not exchange components of @xmath130 , one sees @xmath910 .",
    "orient @xmath174 and @xmath179 so that they are parallel when disks are filled in all components of @xmath911 .",
    "it follows from @xmath903 and @xmath910 that the orientations of @xmath912 and @xmath179 are different .",
    "if @xmath174 is non - separating in @xmath0 , then so is @xmath179 , and both @xmath174 and @xmath179 are non - zero as an element of @xmath907 .",
    "this contradicts the fact that @xmath902 acts on @xmath907 trivially .",
    "if @xmath174 is separating in @xmath0 , then so is @xmath179 . for each @xmath359 ,",
    "let @xmath425 be the component of @xmath913 that does not contain @xmath722 .",
    "we then have @xmath914 .",
    "in particular , @xmath411 and @xmath412 are homeomorphic and are of positive genus .",
    "this also contradicts the fact that @xmath902 acts on @xmath907 trivially .",
    "let @xmath166 be a component of @xmath724 . if @xmath166 is non - separating in @xmath0 , then one can prove that @xmath899 preserves an orientation of @xmath166 by using the fact that @xmath902 acts on @xmath907 trivially , as in the proof of lemma [ lem - pre ] .",
    "suppose that @xmath166 is separating in @xmath0 .",
    "if @xmath899 reversed an orientation of @xmath166 , then @xmath899 would exchange the two components of @xmath396 .",
    "one can then deduce a contradiction as in the proof of lemma [ lem - pre ] .",
    "the latter assertion of the lemma follows from lemma [ lem - pre ] and the former assertion .",
    "[ lem - id ] let @xmath21 be a surface with @xmath187 , and pick @xmath897 and @xmath898 with @xmath915 .",
    "choose realizations @xmath899 of @xmath13 and @xmath724 of @xmath79 such that @xmath900 and @xmath899 is the identity on @xmath130 .",
    "let @xmath116 be a component of @xmath901 , and suppose that the mapping class of the homeomorphism @xmath916 on @xmath116 induced from @xmath899 is of finite order as an element of @xmath917 .",
    "then @xmath916 is isotopic to the identity .",
    "we prove this lemma by induction on @xmath22 , the number of components of @xmath130 .",
    "when @xmath124 , the lemma follows from lemma 1.6 of @xcite because @xmath13 acts on @xmath125 trivially .",
    "assume @xmath26 , and let @xmath116 be a component of @xmath901 .",
    "if @xmath116 is a pair of pants , then it is clear that @xmath916 is isotopic to the identity .",
    "we thus assume that @xmath116 is not a pair of pants .",
    "we first assume that @xmath116 contains a component of @xmath130 . by filling a disk @xmath918 in that component of @xmath130 ,",
    "one obtains the surfaces @xmath919 and @xmath920 with @xmath921 since @xmath116 is not a pair of pants .",
    "let @xmath922 be the homeomorphism of @xmath923 defined by the extention of @xmath899 that is the identity on @xmath918 .",
    "note that @xmath724 determines a simplex of @xmath924 and that @xmath925 belongs to @xmath926 , where @xmath927 is the natural homomorphism .",
    "since the mapping class , denoted by @xmath928 , of @xmath916 is of finite order , so is the mapping class , denoted by @xmath929 , of the restriction of @xmath922 to @xmath409 .",
    "the hypothesis of the induction implies that @xmath929 is the identity .",
    "it then follows that @xmath928 lies in the kernel of the natural homomorphism from @xmath917 into @xmath930 , which is isomorphic to @xmath931 and is torsion - free . therefore , @xmath928 is the identity .",
    "we next assume that @xmath116 contains no component of @xmath130 . by filling a disk @xmath932 in a component @xmath619 of @xmath130",
    ", we obtain the surface @xmath933 .",
    "it is then possible either that there are two components of @xmath724 which are isotopic in @xmath934 to each other or that there is a component of @xmath724 which is isotopic in @xmath934 to a component of @xmath935 .",
    "if the former is the case , then delete one of those two components of @xmath724 .",
    "if the latter is the case , then delete that component of @xmath724 .",
    "otherwise , we do nothing .",
    "we then obtain the family , denoted by @xmath936 , of essential simple closed curves in @xmath934 which are pairwise non - isotopic in @xmath934 .",
    "we denote by @xmath937 the component of @xmath938 containing @xmath116 .",
    "note that the complement of the interior of @xmath116 in @xmath937 is an annulus containing @xmath932 if it is non - empty .",
    "let @xmath939 denote the homemomorphism of @xmath934 defined by the extension of @xmath899 which is the identity on @xmath932 .",
    "since the mapping class of @xmath916 is of finite order , so is the mapping class of the restriction of @xmath939 to @xmath937 , denoted by @xmath940 . by the hypothesis of the induction ,",
    "@xmath940 is isotopic to the identity , and thus @xmath916 is isotopic to the identity .    the latter assertion of the theorem follows from lemmas [ lem - pre ] and [ lem - ori - pre ] .",
    "let @xmath724 be a realization of the canonical reduction system @xmath898 for the cyclic group generated by @xmath13 with @xmath900 .",
    "we may assume that @xmath899 is the identity on @xmath130 .",
    "lemmas [ lem - pre ] and [ lem - ori - pre ] imply that @xmath899 preserves each component of @xmath724 and each component of @xmath901 .",
    "it follows from theorem 7.16 in @xcite that the mapping class of the restriction of @xmath899 to each component of @xmath901 is either of finite order or pseudo - anosov . by lemma [ lem - id ] ,",
    "the restriction is either trivial or pseudo - anosov .",
    "w. j. harvey , boundary structure of the modular group , in _",
    "riemann surfaces and related topics : proceedings of the 1978 stony brook conference _",
    ", 245251 , ann . of math",
    ", 97 , princeton univ .  press , princeton , n.j . , 1981 ."
  ],
  "abstract_text": [
    "<S> we compute the automorphism groups of the torelli complex and the complex of separating curves for most of compact orientable surfaces . as an application </S>",
    "<S> , we show that the commensurators of the torelli group and the johnson kernel for such surfaces are naturally isomorphic to the extended mapping class group . </S>"
  ]
}