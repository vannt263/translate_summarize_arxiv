{
  "article_text": [
    "random recursive trees have been heavily studied since their introduction in 1970 @xcite , and are closely related to binary search trees , preferential attachment trees and increasing trees in general , see e.g. @xcite . in the current work",
    "we obtain strong information about the joint law of degrees and depths of maximum and near - maximum degrees and contrast our results to similar results established for linear preferential attachment trees , see @xcite .",
    "we first recall basic notation and the standard construction of both random recursive trees ( rrts ) and linear preferential attachment trees .",
    "we use @xmath13 to denote natural logarithms and @xmath14 to denote logarithms with base 2 .    for @xmath15 ,",
    "let @xmath0 be a random recursive tree with vertex set @xmath16=\\{1,\\ldots , n\\}$ ] .",
    "the standard construction of rrts , which couples the elements of @xmath17 , is the following : let @xmath18 be a single vertex labeled 1 , which is the root . for @xmath19 , the tree @xmath20 is obtained from @xmath0 by adding an edge from a new vertex @xmath21 to a vertex @xmath22 $ ] ; the choice of @xmath23 is uniformly random , and is independent for each @xmath19 . for @xmath24 $ ]",
    ", the depth @xmath25 is the distance from @xmath26 to the root in @xmath0 .",
    "we write @xmath27 for the number of children of @xmath26 in @xmath0 and call this the degree of @xmath26 in @xmath0 .",
    "a particular characteristic of rrts , as contrasted with other increasing trees e.g. @xmath28-ary trees , is that for each @xmath29 , almost surely @xmath30 as @xmath31 .",
    "let @xmath32 be the maximum degree in @xmath0 and let @xmath33 be the set of vertices in @xmath0 attaining @xmath34 .",
    "linear preferential attachment trees are also constructed recursively , except that the parent @xmath23 of vertex @xmath21 is chosen with probability proportional to the degree of @xmath23 in the current tree .",
    "more precisely , for @xmath35 , the linear preferential attachment process @xmath36 is defined as follows .",
    "let @xmath37 be a single vertex labeled 1 .",
    "for @xmath19 let @xmath38 be the tree obtained from @xmath39 by adding an edge from a new vertex @xmath21 to a vertex @xmath22 $ ] . in this case , the @xmath40 is proportional to @xmath41 .",
    "note that , in this context , rrts correspond to the case @xmath42 .    for the linear preferential attachment models , it has been proven that the renormalized maximum degree @xmath43 converges a.s . and in @xmath44 to a positive , finite random variable with absolutely continuous distribution , @xcite .",
    "furthermore , the label of the vertex attaining the maximum degree is finite a.s . @xcite .    for random recursive trees ,",
    "the picture is quite different . naturally , if @xmath45 then @xmath46 stochastically dominates @xmath47 .",
    "however , it is unlikely that the root of @xmath0 will attain the maximum degree in @xmath0 . by construction",
    ", @xmath46 is distributed as @xmath48 where the summands are independent and @xmath49 is distributed as @xmath50 .",
    "it follows easily that @xmath51 .",
    "however , it is known that the maximum degree satisfies @xmath52 a.s . as @xmath31 @xcite .",
    "it is also known that the limiting distribution of @xmath53 is , up to lattice effects , a gumbel distribution @xcite .",
    "the latter can be explained since the gumbel distribution arises as the limiting distribution of the maximum of independent random variables under rather general hypotheses on the laws of such variables .",
    "the degrees of vertices in @xmath0 are correlated and are not identically distributed , but between pairs of vertices in @xmath0 the correlation is weak and the gumbel limit still occurs .",
    "this was first shown by goh and schmutz @xcite using singularity analysis of generating functions .",
    "our approach to rrts provides a probabilistic explanation of this phenomenon ; see @xcite for more details .    in @xcite , addario - berry and the author",
    "describe the number of high - degree vertices in @xmath0 via the sequence @xmath54)$ ] .",
    "they show that , along suitable subsequences , this sequence converges in distribution to a poisson point process @xmath55 in @xmath56 with @xmath57}=\\theta(2^{-j})$ ] for all @xmath58 .",
    "this work provides a detailed description of the degrees and depths of high - degree vertices in @xmath0 .",
    "in particular we show that the number of vertices attaining the maximum degree is random and their depths are independent and asymptotically normal .",
    "write @xmath59 and @xmath60 .",
    "[ max normal ] for each @xmath61 $ ] , there exists a positive integer - valued random variable @xmath62 such that , for any increasing sequence of integers @xmath63 for which @xmath64 as @xmath65 , then @xmath66 converges to @xmath62 in distribution , and @xmath67 where @xmath68 are independent standard gaussian variables .",
    "we remark that theorem  [ max normal ] implies that maximum - degree vertices of rrts are constantly changing along the process @xmath17 .",
    "our main result gives a more general description of the depths of all vertices in @xmath0 , indexed in decreasing order of their degrees .",
    "list vertices of @xmath0 in decreasing order of degree as @xmath2 ; here we break ties between vertices with the same degree by ordering them uniformly at random . write @xmath3 and @xmath4 for the degree and depth of @xmath5 , respectively",
    ". let @xmath69 be a poisson point process in @xmath70 with intensity @xmath71 .",
    "then for @xmath72 , let @xmath73 be the @xmath74-th largest point of @xmath69 so @xmath75 and @xmath76 .",
    "this ordering is well defined as @xmath77 almost surely .",
    "[ mppp ] let @xmath68 be independent standard gaussian variables , @xmath78 .",
    "for each @xmath61 $ ] and for any increasing sequence of integers @xmath63 for which @xmath79 as @xmath80 , then @xmath81    the condition on the subsequence @xmath82 in theorems [ max normal ] and  [ mppp ] is due to a lattice effect on the law of @xmath83 caused by the fact that degrees are integer - valued .",
    "our last result provides information about vertices with degree near @xmath84 for fixed @xmath85 $ ] . for @xmath85",
    "$ ] , let @xmath86 and @xmath87 ; note that @xmath88 and @xmath89 .",
    "[ cond normal ] fix @xmath90 and let @xmath91)$ ] be @xmath92 distinct vertices in @xmath0 chosen uniformly at random . for every @xmath93^k$ ] and @xmath94 , the conditional law of @xmath95 \\right)_,\\ ] ]",
    "given that @xmath96 for all @xmath97 $ ] , converges to the law of @xmath92 independent standard gaussian variables .",
    "note that the case @xmath98 for all @xmath97 $ ] of theorem  [ cond normal ] involves no conditioning , and thus yields the joint distribution for the depths of @xmath92 uniformly random vertices in @xmath0 .",
    "this extends the results of the papers @xcite where the case for @xmath99 , @xmath100 of theorem  [ cond normal ] is established .",
    "these results were obtained in the context of analyzing the _ insertion depth _ , @xmath101 of rrts , important for the analysis of data structures in computer science .",
    "theorem  [ max normal ] is a quite straightforward consequence of theorem  [ mppp ] , whose proof relies essentially on theorem  [ cond normal ] .",
    "the proof of theorem  [ cond normal ] exploits the relation between degrees and depths of vertices in a different random tree @xmath102 whose shape has the same law as that of @xmath0 .",
    "this alternative tree @xmath102 is constructed through kingman s coalescent , as described in section  [ kingman ] . a binary tree representation of kingman s coalescent had been previously used to study a data structure known as union - find trees , @xcite .",
    "pittel mentions the connection between the results of @xcite and the height of rrts in @xcite .",
    "however , although the connection between kingman s coalescent and random recursive trees had been observed , prior to our previous work with addario - berry @xcite , its utility in studying vertex degrees seems to have gone unremarked .      in this section",
    "we briefly explain how we use the method of moments ( e.g. , see @xcite section 6.1 ) to obtain the limiting distribution of a sequence of ( marked ) point processes .",
    "in particular , we present an alternative characterization of the processes involved in theorem  [ mppp ] .",
    "although this change of perspective requires the introduction of further notation , the problem of establishing theorem  [ mppp ] becomes , in fact , more tractable .",
    "we start by considering the unmarked processes @xmath103)$ ] and @xmath104 .",
    "define , for each @xmath19 , @xmath105 .",
    "we consider a fixed @xmath61 $ ] and increasing sequence @xmath82 such that @xmath106 as @xmath65 .    for @xmath58 ,",
    "we define the following counting measures of the sequence @xmath107 ; @xmath108 note that @xmath109 and @xmath110 ; in particular , the number of points of @xmath111 on any interval @xmath112 $ ] is finite almost surely .",
    "therefore , @xmath111 is characterized by the collection of joint distributions @xmath113 for any integers @xmath114 ; see e.g. section 3.1 of @xcite and section 9.2 of @xcite .",
    "similarly , the collection of the joint distribution of the variables @xmath115 : { \\mathrm{d}}_{t_n}(v)={\\lfloor \\log n \\rfloor}+j \\ } , \\\\ x_{\\ge j}^{{(n)}}= \\#\\{v\\in [ n ] : { \\mathrm{d}}_{t_n}(v)\\ge { \\lfloor \\log n \\rfloor}+j\\}\\end{aligned}\\ ] ] characterizes the law of the sequence @xmath116 . finally , to prove that @xmath117 it suffices to show that , for all @xmath118 @xmath119 next , for any @xmath120 and @xmath121 , let @xmath122 and set @xmath123 .",
    "recall that , if @xmath124 , @xmath125}=\\lambda^a$ ] for all integers @xmath126 .",
    "now , using the method of moments , the following estimates imply .",
    "[ moments 0 ] for all @xmath127 and @xmath128 there is @xmath129 such that the following holds .",
    "if @xmath130 and @xmath131 are integer - valued functions with @xmath132 , then uniformly over non - negative integers @xmath133 with @xmath134 , we have @xmath135 } & = \\left(2^{-j+{\\varepsilon}_n } \\right)^{a_{j } } \\prod_{j'\\le k < j } \\left ( 2^{-(k+1)+{\\varepsilon}_n } \\right)^{a_k}(1+o(n^{-\\beta})).\\end{aligned}\\ ] ]    marked point processes are , in fact , point processes in a larger space ; thus , the same approach can be used when we add the information of the depths @xmath136 and the marks @xmath137 .",
    "let us define subsets of @xmath138 that will help us define the fdds of our marked point processes ; see figure  [ fdd fig ] for an example .",
    "it suffices to consider the set @xmath139,\\ , ( a , b],\\ , ( a,\\infty);\\ , -\\infty < a < b<\\infty \\}.\\ ] ]    fix positive integers @xmath140 .",
    "if the pairs @xmath141 , @xmath142 $ ] , satisfy    1 .",
    "@xmath143 and 2 .   for all @xmath144 , if @xmath145 then @xmath146",
    ";    then we say that @xmath147)$ ] is a _",
    "@xmath148-canonical fdd _ sequence .",
    "-canonical set . in this case ,",
    "@xmath149 , @xmath150 and @xmath151 , @xmath152 . ]",
    "also , for @xmath153 , let @xmath154 : { \\mathrm{d}}_{t_n}(v)={\\lfloor \\log n \\rfloor}+j,\\,\\frac{{\\mathrm{h}}_{t_n}(v)-\\mu_1\\ln n}{\\sqrt{\\sigma_1 ^ 2\\ln n}}\\in b \\right\\};\\end{aligned}\\ ] ] and let @xmath155 , @xmath156 be defined accordingly .",
    "now the convergence in distribution of point processes is equivalent to the convergence of its finite dimensional distributions ( fdd ) ; see ( * ? ? ?",
    "* theorem  11.1.vii ) . in our case , this leads to the following lemma .",
    "[ equiv mppp ] the following are equivalent .    1 .   as @xmath65 ,",
    "@xmath157 2 .",
    "for every @xmath148-canonical fdd sequence @xmath158 as @xmath65 , @xmath159    let @xmath160 denote the measure of a standard gaussian variable ; that is @xmath161 for any @xmath162 .    for all @xmath58 and @xmath163 , @xmath164 and @xmath165 ; additionally , for any @xmath148-canonical fdd sequence , the variables @xmath166 are independent .",
    "below is the more general form of moment estimation which is required to obtain theorem  [ mppp ] .",
    "[ moments ] fix @xmath127 and @xmath167 .",
    "let @xmath131 and @xmath168 are integer - valued functions with @xmath169 , and let @xmath170 and non - negative integers @xmath171)$ ] @xmath170 be such that @xmath172 } a_k = m$ ] . then uniformly over @xmath148-canonical sequences @xmath158 with @xmath173 and @xmath174 , we have @xmath175 } \\\\",
    "= & \\prod_{k=1}^{k ' } \\left(2^{-j_k+{\\varepsilon}_n-1 } \\phi(b_k)\\right)^{a_k } \\prod_{k = k'+1}^{k } \\left(2^{-j'+{\\varepsilon}_n } \\phi(b_k)\\right)^{a_k } ( 1+o(1)).\\end{aligned}\\ ] ]    fix @xmath61 $ ] and let @xmath82 be an increasing sequence with @xmath106 as @xmath65 .",
    "let @xmath176 and @xmath158 be a fixed @xmath148-canonical fdd sequence .",
    "set @xmath177 , which implies for @xmath1 large enough that @xmath178 .",
    "thus , proposition  [ moments ] implies , by the method of moments , that the first condition in lemma  [ equiv mppp ] is satisfied for each @xmath179-canonical fdd sequence .",
    "this completes the proof of theorem  [ mppp ] .",
    "we briefly explain a key ingredient to proving proposition  [ moments ] .",
    "note that each @xmath180 and @xmath181 is a sum of indicator variables .",
    "therefore , the expectations of their factorial moments are reduced to a sum of probabilities as follows : for each @xmath182 $ ] , collection @xmath183 and sequence @xmath184 , @xmath185 the first factor in has been analyzed in @xcite ; the result we need from that paper is restated below as proposition  [ old core ] . the second factor in",
    "is bounded in theorem  [ limit ck ] .",
    "we now turn to describing kingman s coalescent .",
    "the connection between rrts and kingman s coalescent is central to understanding the close relation between degree and depth of vertices reflected in theorem  [ cond normal ] , which is key to the proofs of theorems [ max normal ] and  [ mppp ] .",
    "therefore , we briefly sketch the role that theorem  [ cond normal ] plays in the proof of theorem  [ mppp ] . in section  [ kingman ]",
    "we define the tree @xmath102 , after which we discuss the contents of the remainder of the paper .      in this section",
    "we give a representation of kingman s coalescent in terms of labeled forests and connect this with rrts . for a general description of kingman s coalescent , see ( * ? ? ?",
    "* chapter  2 ) ; the construction below is based on that given in @xcite . for the remainder of the paper ,",
    "all trees are rooted and we use @xmath186 to denote the root of tree @xmath187 . we write @xmath188 and @xmath189 for the sets of vertices and edges of @xmath187 , respectively . by convention , we assume that edges of a tree @xmath187 are directed towards @xmath186 and an edge directed from @xmath190 to @xmath26 is denoted by @xmath191 . if @xmath187 has @xmath1 vertices , we say that @xmath187 has size @xmath1 ; we also write @xmath192 and @xmath193 for the degree and depth of vertex @xmath26 in @xmath187 .",
    "a rooted labeled tree @xmath187 is _ increasing _ if its labels are increasing along root - to - leaf paths .",
    "let us write @xmath194\\}$ ] to denote the set of increasing trees on @xmath16 $ ] .",
    "it is not difficult to see that @xmath0 is a uniformly random element of @xmath195 and that @xmath196 .",
    "a forest @xmath197 is a set of trees whose vertex sets are pairwise disjoint .",
    "denote by @xmath198 and @xmath199 , respectively , the union of the vertex and edge sets of the trees contained in @xmath197 .",
    "for each @xmath15 , we consider the set of forests @xmath200\\}$ ] with vertex labels @xmath16 $ ] .",
    "an @xmath1-chain is a sequence @xmath201 of elements of @xmath202 if for @xmath203 , @xmath204 is obtained from @xmath205 by adding an edge connecting two of the roots in @xmath205 . in particular",
    ", @xmath206 contains @xmath1 one - vertex trees , and @xmath207 contains exactly one tree denoted by @xmath208 .    for an @xmath1-chain @xmath209 and @xmath210 , we write @xmath211 , ordering of the trees",
    "is in increasing order of their smallest - labeled vertex .",
    "the following constructs kingman s @xmath1-coalescent as a random @xmath1-chain @xmath212 .    for each @xmath203 , choose @xmath213 independently and uniformly at random ; also let @xmath214)$ ] be a sequence of independent @xmath215 random variables .    for @xmath216 , @xmath217 is obtained from @xmath218 as follows .",
    "add an edge @xmath219 between the roots of @xmath220 and @xmath221 ; direct @xmath219 towards @xmath220 if @xmath222 , and towards @xmath221 otherwise .",
    "then @xmath217 contains the new tree and the remaining @xmath223 unaltered trees from @xmath218 .    for an example of the process see figure  [ chain ] .",
    "-coalescent @xmath224 for @xmath225 . for @xmath203 , we present the edge @xmath226 with a dotted line in @xmath227 .",
    "edges are marked with the labels @xmath228 ; @xmath229 is the first forest where @xmath230 is present . in this case ,",
    "@xmath231 , @xmath232 and @xmath233 @xmath234 . ]",
    "[ uniform chain ] kingman s @xmath1-coalescent @xmath235 is uniformly random in @xmath236 , the set of @xmath1-chains .    any @xmath237 is determined by the order in which the edges of @xmath238 are added . for each @xmath239 , there are @xmath240 possible oriented edges between the roots in @xmath241 and only one of them is @xmath242 .",
    "thus , @xmath243^{-1}.\\ ] ] this expression holds for all @xmath237 , so the result follows .",
    "let @xmath244 be the edges of @xmath238 ordered as they were added to the chain @xmath245 .",
    "that is , @xmath246 while @xmath247 for all @xmath248 .",
    "now , write @xmath249 .",
    "let @xmath250 $ ] be defined as @xmath251 and for each @xmath252 , @xmath253 this is well defined as all edges are directed towards the root , so @xmath254 for all @xmath255 $ ] .",
    "note that for each @xmath216 , @xmath219 is directed towards the root of the new tree in @xmath205 .",
    "thus , the labels @xmath256\\}$ ] decrease along leaf - to - root paths in @xmath238 . as a consequence ,",
    "we obtain an increasing tree by relabeling the vertices of @xmath238 using @xmath257 .",
    "[ law ] for each @xmath258 , relabel the vertices in @xmath238 with @xmath257 to obtain @xmath259 .",
    "then the law of @xmath260 is that of a rrt of size @xmath1 .    from the argument in the proof of lemma  [ uniform chain ]",
    ", we have that @xmath261 .",
    "next , we show that @xmath262 is onto and , additionally , an @xmath263-to-1 mapping",
    ". thus @xmath262 preserves the uniform measure from @xmath236 to @xmath195 .",
    "fix an increasing tree @xmath264 .",
    "every vertex @xmath265 has outdegree 1 in @xmath187 , thus we write uniquely define @xmath266 such that @xmath267 . for each @xmath268 ,",
    "let @xmath269 .",
    "consider an @xmath1-chain @xmath201 defined as follows .",
    "let @xmath270 have no edges , and for each @xmath216 , construct @xmath271 from @xmath241 by adding the edge @xmath272 .",
    "it is easy to see that @xmath245 satisfies @xmath273 for all @xmath274 $ ] and @xmath238 .",
    "therefore @xmath275 , showing that @xmath262 is onto .",
    "now , consider @xmath276 such that @xmath275 .",
    "for each permutation @xmath277\\to[n]$ ] , let @xmath278 be the @xmath1-chain obtained from @xmath279 by applying @xmath280 to each of the labels of @xmath281 , @xmath274 $ ] .",
    "the mapping @xmath262 does not depend of the vertex labels in @xmath245 , but on the order in which edges are added ; therefore , @xmath282 for all permutations @xmath280 .",
    "this shows that @xmath283 for any @xmath264 , completing the proof .    for each @xmath1 ,",
    "let @xmath235 be a kingman s @xmath1-coalescent and let @xmath284 .",
    "since @xmath260 only relabels vertices in @xmath285 , it follows that the shape of the tree is preserved ; and so are the degrees and depths of the vertices .",
    "that is , as multisets , @xmath286}=\\{(deg_{\\phi(\\mathbf{c})}(v ) , h_{\\phi(\\mathbf{c})}(v))\\}_{v\\in [ n]}.\\ ] ] moreover , for each @xmath264 the set @xmath287 can be indexed by permutations on @xmath16 $ ] .",
    "this directly implies the following key corollary of proposition  [ law ] .",
    "[ relabel cor ] for all @xmath19 , @xmath288 ) = ( ( { \\mathrm{d}}_{t_n } ( \\sigma(i ) ) , { \\mathrm{h}}_{t_n}(\\sigma(i))),\\ , i\\in [ n]);\\ ] ] where @xmath289 is a uniformly random permutation of @xmath16 $ ] and is independent of @xmath0 .",
    "consequently , the following equality in distribution holds jointly for all @xmath290 and @xmath291 , @xmath292 : { \\mathrm{d}}_{t_n}(v)=i,\\ , { \\mathrm{h}}_{t_n}=j \\}|=|\\{v\\in [ n ] : { \\mathrm{d}}_{t^{{(n)}}}(v)=i,\\ , { \\mathrm{h}}_{t^{{(n)}}}(v)=j\\}|\\ ] ]    for any @xmath19 , let @xmath293 be the set of permutations on @xmath16 $ ] . for any @xmath1-chain @xmath201 let @xmath294 .",
    "then @xmath295 is a bijection and the result follows .      in this section",
    "we provide a heuristic for the approach we use to study the conditional distributions involved in theorem  [ limit ck ] below , which is equivalent to theorem  [ cond normal ] , and also outline the remainder of the paper .",
    "fix @xmath19 and consider kingman s @xmath1-coalescent @xmath212 . for each vertex",
    "@xmath24 $ ] and @xmath210 , let @xmath296 be the tree in @xmath227 that contains @xmath26 .",
    "we use @xmath297 and @xmath298 to denote the degree and depth of @xmath26 in @xmath296 . recall that @xmath284 is the unique tree in @xmath299 ; for simplicity",
    ", we use @xmath300 and @xmath301 for the degree and depth of vertices in @xmath102 .",
    "[ limit ck ] fix @xmath90 . for any @xmath93^k$ ] and @xmath94 , the conditional law of @xmath302 \\right)_,\\ ] ] given that @xmath303 $ ] , converges to the law of @xmath92 independent standard gaussian variables .    by corollary",
    "[ relabel cor ] , theorem  [ cond normal ] follows from theorem  [ limit ck ] .    in this section",
    "we give a heuristic for theorem  [ limit ck ] , when @xmath99 .",
    "first , we analyze the case @xmath304 , in which @xmath305 occurs ; and second @xmath306 . finally , we discuss the obstacles in treating several vertices , that is , when @xmath307 .",
    "let @xmath308 and suppose @xmath309 .",
    "if @xmath219 is directed towards @xmath310 , then the degree of @xmath310 increases by one in @xmath311 . if @xmath219 is directed outwards @xmath310 , then the depth of each @xmath312 increases by one in @xmath311 . ]",
    "we next define indicator functions @xmath313 and the _ selection set _ @xmath314 as follows , let @xmath315 be the indicator that @xmath316 ; that is , @xmath317 when @xmath318 is chosen to be merged and form a larger tree in @xmath311 , and otherwise @xmath319 .",
    "now we set @xmath320 the selection set @xmath314 keeps track of each time @xmath74 where @xmath321 merges .",
    "the choice of trees to be merged at each step is both independent and uniform .",
    "thus , for fixed @xmath24 $ ] , the variables @xmath322 are independent bernoulli random variables , with @xmath323}=2/i$ ] .",
    "this implies that @xmath324}=\\sum_{i=1}^n \\frac{2}{i}=2\\ln n + o(1)$ ] and @xmath325}=\\sum_{i=1}^n \\left(\\frac{2}{i}-\\frac{4}{i^2}\\right)=2\\ln n + o(1)$ ] .",
    "it is straightforward to see that the lindenberg conditions are satisfied by @xmath326 and thus , the following holds for any vertex @xmath29 , @xmath327 as @xmath31 and where @xmath328 is a standard gaussian variable .",
    "moreover , bernstein s inequalities ( see , e.g. ( * ? ? ? * theorem 2.8  and  ( 2.9 ) ) ) yield that , for any @xmath329 , @xmath330}| > \\delta{{\\mathbf e}\\left[|{{\\mathcal s}}_n(v)|\\right]}\\right)}=o(1).\\end{aligned}\\ ] ]    now , consider the indicator random variables @xmath331 where @xmath332 precisely when @xmath317 and the edge added to @xmath227 is directed outwards of @xmath333 .",
    "the latter condition depends only on @xmath334 and thus @xmath335}=1/i$ ] .",
    "recall that @xmath219 is the edge added to @xmath218 to obtain @xmath217 .",
    "if @xmath219 is directed towards @xmath336 , the degree of @xmath336 increases by one in @xmath217 .",
    "otherwise , @xmath219 is directed outwards @xmath336 and all vertices in @xmath337 increase their depth by one in @xmath217 .",
    "therefore @xmath338 , and in particular @xmath339 similarly to , it follows that @xmath340 converges in distribution to a standard gaussian variable ; this already solves the case when @xmath341 .",
    "however , such arguments can not be directly applied to the case when @xmath306 or when @xmath307 .",
    "we next describe a slightly different proof that @xmath342 is asymptotically normal , which we later extend to cover the general case of theorem  [ limit ck ] .",
    "the direction of the edge @xmath219 is determined by a @xmath343 , independent of the choice of trees to be merged .",
    "thus , we have the following distributional equality , @xmath344    now , from , it follows that there exist random variables @xmath345 such that @xmath346 similarly , the central limit theorem allows us to write @xmath347 with @xmath348 , @xmath349 a standard gaussian variable .",
    "we then have @xmath350 in the last approximation , we neglect the variations of @xmath351 around @xmath352 .",
    "the binomial variable is determined by the coin flips @xmath334 which are independent of @xmath314 .",
    "thus their ( limiting ) fluctuations , @xmath328 and @xmath349 , should behave independently .",
    "it now follows that @xmath353 where the latter expression has a standard gaussian distribution .",
    "this gives a heuristic of the limiting distribution of @xmath354 without any conditioning .    to prepare for the proof of theorem  [ limit ck ] , we next state a lemma describing the joint law of the depth and degree of a given vertex .",
    "[ deg dep ] fix @xmath24 $ ] , let @xmath355 be @xmath356 independent of @xmath314 and let @xmath357 .",
    "then , @xmath358 and for all @xmath359 , @xmath360    any vertex starts as the root of a single - vertex tree .",
    "if @xmath361 , then we flip a fair coin @xmath28 times and set @xmath300 as the length of the first streak of heads and @xmath301 as the total number of tails ; this proves the distributional identity of @xmath300 .    moreover , if @xmath362 , then @xmath363 and the first @xmath92 coin flips are determined to be heads , the latter event occurring with probability @xmath364 .",
    "the remaining @xmath365 coin flips are independent of the previous tosses .    using lemma  [ deg dep ]",
    ", we have for all @xmath366 , @xmath367 the last equality by use the bounds in and the fact that for any @xmath368 $ ] and @xmath369 , we have @xmath370 for @xmath1 large enough .    thus , conditioning on the event @xmath305 does not have a real impact on the distribution of @xmath371 .",
    "therefore , @xmath354 depends essentially on @xmath372 fair coin flips . in other words ,",
    "the conditional law of @xmath373 , given that @xmath374 satisfies @xmath375 this suggests that , using a suitable choice of renormalizing constants , the conditional law of @xmath354 given that @xmath374 has an asymptotic normal distribution .",
    "to conclude the proof outline for theorem  [ limit ck ] , we briefly explain how the depths of distinct vertices are correlated . for @xmath307 , the joint distribution of @xmath376)$ ] does not depend only on the sizes of the selection sets @xmath377)$ ] , but also on their overlaps ( i.e. on the sets @xmath378 , for @xmath379 $ ] ) .    for distinct vertices @xmath380 , let @xmath381 .",
    "then , @xmath382 is the first time that both the trees containing @xmath26 and @xmath383 are merged together ; moreover , the merging of @xmath380 coincide for the rest of the process . in terms of theirs depths , this implies that @xmath384 , i.e. exactly one of @xmath26 or @xmath383 increases its depth at step @xmath382 , and also @xmath385 , for all @xmath386 .",
    "we proceed to outline the contents of the remainder of the paper . in the next section , section  [ case 1 ] ,",
    "we make rigorous the heuristics in and .",
    "to do so , we express the cumulative distribution function of @xmath301 as the expected value of a function of @xmath387 .    in section  [ kingman i d ] , we address the correlations between @xmath376)$ ] .",
    "we work with the coalescent process stopped at the moment where there are @xmath388 remaining trees , @xmath389 . using @xmath389 we define , for each @xmath24 $ ] , the _ truncated selection sets _",
    "@xmath390\\ ] ] and a partial depth @xmath391 . in section  [ trunc sec ]",
    "we show that if @xmath392 then @xmath393 is negligible for the asymptotic distribution of @xmath301 ; this holds even if we condition on a finite set of vertices ( that includes @xmath26 ) to have large degree . stopping the process , instead , at @xmath394 would facilitate the analysis of @xmath395 , but estimates on @xmath396,\\ , v\\in [ k])$ ] would become much more delicate .",
    "in section  [ key section ] we study the joint limiting distribution of @xmath397)$ ] and complete the proof of theorem  [ limit ck ] .",
    "finally , sections [ mppp proof ] and  [ proof max normal ] contain the proofs of proposition  [ moments ] and theorem  [ max normal ] , respectively .",
    "in this section we fix @xmath85 $ ] , @xmath398 and write @xmath399 .",
    "we establish the conditional limiting distribution of @xmath400 given that @xmath401 .",
    "our approach consists on averaging over the size of the selection set @xmath402 , and applying the following limit equivalence for the renormalized version of @xmath371 .",
    "[ port ] let @xmath403 be a uniformly continuous bounded function , @xmath404 a continuous function and @xmath405 be a sequence of functions uniformly converging to @xmath406 over any compact set of @xmath70 .",
    "let @xmath407 be a sequence of random variables which converges in distribution to @xmath408 , then @xmath409}={{\\mathbf e}\\left[f(g(x))\\right]}.\\ ] ]    by the portmanteau theorem we have that @xmath410}={{\\mathbf e}\\left[f(g(x))\\right]},\\ ] ] so it suffices to prove that @xmath411}=0.\\ ] ]    for an arbitrary @xmath412 , let @xmath413 be such that @xmath414 and let @xmath415 such that if @xmath416 then @xmath417 this is possible by the uniform continuity of @xmath197 .",
    "now , let @xmath418 be such that @xmath419 for all @xmath420 $ ] and @xmath421 .",
    "this is possible by the uniform convergence of @xmath422 on a bounded set . if follows that @xmath423 for any @xmath420 $ ] and @xmath1 large enough .",
    "finally , if @xmath424 is a bound for @xmath197 then for @xmath1 large enough we have @xmath425 } = \\;&{{\\mathbf e}\\left[|f(g_n(x_n))-f(g(x_n))|{{\\mathbf 1}_{[|x_n|>k]}}\\right ] } \\\\ & + { { \\mathbf e}\\left[|f(g_n(x_n))-f(g(x_n))|{{\\mathbf 1}_{[|x_n|\\le k]}}\\right]}\\\\ \\le \\;&2m{{\\mathbf p}\\left(|x_n|>k\\right ) } + { \\varepsilon}{{\\mathbf p}\\left(|x_n|\\le k\\right)}\\\\ \\le \\;&(2m+1){\\varepsilon}.\\end{aligned}\\ ] ] since @xmath426 is arbitrary , this completes the proof .    we describe here a straightforward computation which arises in our proofs .",
    "[ intb ] let @xmath328 be a standard gaussian variable .",
    "then , for every @xmath427 and @xmath428 , @xmath429}=\\phi(x).\\ ] ]    write @xmath430 , @xmath431 and @xmath432 .",
    "the expected value can be expressed as a double integral , and changing variables with @xmath433 in the second line , we have @xmath434 } & = \\int_{-\\infty}^\\infty \\int_{-\\infty}^{\\frac{ax - z}{c } } \\frac{e^{-(y^2+z^2)/2}}{2\\pi } dydz\\\\ & = \\int_{-\\infty}^\\infty \\int_{-\\infty}^{x } \\frac{\\exp\\{-\\frac{1}{2}[(\\frac{aw - z}{b})^2+z^2]\\}}{2\\sigma\\pi } dwdz\\\\ & = \\int_{-\\infty}^x \\frac{e^{-w^2/2}}{\\sqrt{2\\pi } } \\left(\\int_{-\\infty}^{\\infty } \\frac{\\exp\\{-\\frac{1}{2\\sigma^2}[z-\\mu w]^2\\}}{\\sqrt{2\\sigma^2\\pi } } dz\\right)dw\\\\ & = \\int_{-\\infty}^x \\frac{e^{-w^2/2}}{\\sqrt{2\\pi } } dw=\\phi(x).\\end{aligned}\\ ] ] the third equality holds by the following chain of identities , the key point being that @xmath435 , @xmath436    we first consider the case @xmath437 ; in other words , the limiting distribution of @xmath354 without conditioning on its degree .",
    "for any fixed @xmath427 , let @xmath438 $ ] be defined as @xmath439 the motivation behind this definition is that , conditioning on @xmath371 and using , we have @xmath440}. \\end{aligned}\\ ] ]    the following result describes @xmath441 as a function in terms of @xmath442 and exploits the gaussian limit of binomial variables @xmath443 as @xmath444 .",
    "[ step 2 ] let @xmath328 be a standard gaussian variable .",
    "for any @xmath427 fixed , @xmath445 } = { { \\mathbf e}\\left[\\phi(\\sqrt{2}x - n)\\right]}.\\end{aligned}\\ ] ]    for each @xmath19 , let @xmath446 be defined as @xmath447 for @xmath448 , and zero otherwise .",
    "note that @xmath449 converges to @xmath450 , uniformly over bounded intervals as @xmath31 ; this is easily proven and we omit the details .",
    "next , we rewrite @xmath451}$ ] as function of @xmath452 ; this is to exploit the fact that @xmath452 converges in distribution to a standard gaussian variable by .",
    "we show that @xmath453}&= \\lim_{n\\to \\infty } { { \\mathbf e}\\left[\\phi(g_{n , x}(\\hat{s}_n))\\right]}={{\\mathbf e}\\left[\\phi\\left ( \\sqrt{2}x - n\\right)\\right]},\\end{aligned}\\ ] ] where @xmath328 is a standard gaussian variable .",
    "the last equality follows by lemma  [ port ] as the necessary conditions are satisfied : @xmath160 is uniformly continuous and bounded , @xmath449 converges uniformly over bounded intervals , and @xmath452 converges in distribution .",
    "it remains to prove the first equality in .",
    "note that @xmath454 additionally , letting @xmath455 we have both @xmath448 and @xmath456 for @xmath457 , let @xmath458 by the berry - essen theorem for gaussian approximation , see e.g. ( * ? ? ?",
    "* theorem 3.4.9 ) , we have that @xmath459 for all @xmath457 .",
    "therefore , using the tail bound in for @xmath371 , we have as @xmath31 , @xmath460 } \\le { { \\mathbf e}\\left[|{\\mathcal e}(|{{\\mathcal s}}_n(1)|)|\\right ] } \\le { { \\mathbf p}\\left(|{{\\mathcal s}}_n(1)| \\le \\ln n\\right ) } + c(\\ln n)^{-1/2}\\to 0.\\ ] ] this completes the proof as follows from @xmath445 } & = \\lim_{n\\to \\infty } { { \\mathbf e}\\left[\\phi(g_{n , x}(\\hat{s}_n))\\right]}+ \\lim_{n\\to \\infty}{{\\mathbf e}\\left[{\\mathcal e}(|{{\\mathcal s}}_n(1)|)\\right]},\\end{aligned}\\ ] ] where both limits in the right - hand side exist and the last one vanishes .    despite lemma  [ step 2c ] below being an stronger statement than lemma  [ step 2 ]",
    ", we decided to present the detailed proof of lemma  [ step 2 ] as the computations are easier to follow .",
    "in particular , lemmas [ intb ] and  [ step 2 ] together imply that for any @xmath427 , @xmath461 which formalizes the heuristic in and already yields a particular case of theorem  [ limit ck ] .",
    "we now proceed to deal with the case @xmath99 and a non - trivial conditioning in theorem  [ limit ck ] . for any @xmath462 let @xmath463 $ ]",
    "be defined as @xmath464}}.\\end{aligned}\\ ] ] by lemma  [ deg dep ] we get @xmath465}. \\nonumber\\end{aligned}\\ ] ]    recall the next definitions given for theorem  [ cond normal ] ; for @xmath85 $ ] , let @xmath86 and @xmath87 .",
    "[ step 2c ] fix @xmath85 $ ] , @xmath398 and let @xmath427 .",
    "write @xmath466 and @xmath467 . if @xmath468 then @xmath469}={{\\mathbf e}\\left[\\phi\\left(\\frac{\\sqrt{2\\sigma_a^2}x - n}{\\sqrt{\\mu_a}}\\right)\\right]}.\\ ] ]    the proof uses lemma  [ port ] and follows the same approach as in lemma  [ step 2 ] .",
    "we also use the renormalization @xmath452 .",
    "fix @xmath470 and set @xmath471 as given in the statement .",
    "for the rest of the proof , write @xmath472 and @xmath473 . we show that @xmath474 } & = \\lim_{n\\to \\infty } { { \\mathbf e}\\left[\\phi(\\tilde{g}_{n , a , x}(\\hat{s}_n))\\right]},\\end{aligned}\\ ] ] where @xmath475 are functions , defined below , such that @xmath476 converges to @xmath477 , uniformly over bounded sets , as @xmath31 .",
    "once is established , the result follows by lemma  [ port ] . to do so",
    ", we are required to bound the error of approximating @xmath478 with @xmath479 .",
    "now , write @xmath480 ; then @xmath481 .",
    "a direct calculation shows that @xmath482 if @xmath483 , and zero otherwise .",
    "the uniform convergence of @xmath484 is straightforward , but we omit the details . for @xmath457 ,",
    "let @xmath485 by the berry - essen theorem , see e.g. ( * ? ? ?",
    "* theorem 3.4.9 ) , we have that @xmath459 . finally , for @xmath1 large enough , @xmath486 and so , having @xmath487 implies @xmath488 . by we",
    "get , @xmath489}\\le { { \\mathbf e}\\left[|{\\mathcal e}(|{{\\mathcal s}}_n(1)|-m)|\\right]}\\le { { \\mathbf p}\\left ( |{{\\mathcal s}}_n(1)|\\le ( 2 - 1/4)\\ln n\\right ) } + 2c(\\ln n)^{-1/2}=o(1).\\ ] ] this completes the proof as @xmath490 } = \\lim_{n\\to \\infty } { { \\mathbf e}\\left[\\phi(\\tilde{g}_{n , a , x}(\\hat{s}_n))\\right ] } = \\lim_{n\\to \\infty } { { \\mathbf e}\\left[{\\mathcal e}(|{{\\mathcal s}}_n(1)|-m)\\right]},\\ ] ] and the last limit vanishes .",
    "fix @xmath85 $ ] , @xmath398 and @xmath427 .",
    "let @xmath491 and @xmath492 .",
    "our goal is to show that @xmath493    if @xmath437 then @xmath494 . the result",
    "then follows by since @xmath495 , and so @xmath496 consider now the case @xmath497 . note that @xmath498 for @xmath1 large enough .",
    "therefore , by lemma  [ deg dep ] and , we have @xmath499    using the equations , , and lemma  [ step 2c ] we get that for any @xmath427 , @xmath500}}{{{\\mathbf p}\\left(|{{\\mathcal s}}_n(1)|\\ge m\\right ) } }   = { { \\mathbf e}\\left[\\phi\\left(\\frac{\\sqrt{2 } \\sigma_a x - n}{\\sqrt{\\mu_a}}\\right)\\right]}.\\end{aligned}\\ ] ] we use the fact that @xmath501 to apply lemma  [ intb ] to the last term above .",
    "this yields the desired result .    in the following section we lay down the necessary approximations to obtain a generalization of to several vertices .",
    "in this section we fix @xmath307 and consider the depths of vertices in @xmath389 . recall from section  [ outline 2 ] that the truncated selection sets are defined by @xmath502 $ ] for @xmath24 $ ] .",
    "let @xmath503 .",
    "for the remainder of the paper we use , e.g. @xmath504 to denote the vector @xmath505)$ ] .",
    "our main objective is showing that @xmath505)$ ] behave , asymptotically , as if they were independent sets ; see proposition  [ s indep ] .",
    "also , the conditional law of the depths @xmath506)$ ] given the truncated selection sets @xmath505)$ ] can be approximated by the law of @xmath92 independent binomial variables .",
    "this holds even if we condition on the final degrees @xmath507)$ ] ; see proposition  [ dep degd ] and remark  [ cond b ] .",
    "these properties are crucial to establishing theorem  [ limit ck ] in full generality .",
    "the choice of halting the process at @xmath389 , and not e.g. @xmath394 , implies that we must also provide the limiting distribution of @xmath508 ( a priori @xmath509 ) .",
    "nevertheless , we use @xmath389 since it allows to use simple arguments in the estimates of proposition  [ s indep ] below .",
    "note that , @xmath510}=2\\ln n-2\\ln \\ln n+o(1)=2\\ln n(1+o(1))$ ] and thus , similar to , we get concentration of @xmath511 around @xmath352 and a normal asymptotic limit .    [ b2 ] for any @xmath24 $ ] and @xmath412 , @xmath512 and @xmath513 where @xmath328 is a standard gaussian variable .",
    "the following proposition is used to obtain independent limiting distributions for the depths of @xmath92 vertices in the final tree @xmath102 .",
    "[ dep degd ] fix @xmath514 . for all @xmath515 such that @xmath516\\}$ ]",
    "are pairwise disjoint , we have @xmath517\\,|\\ , \\bar{{{\\mathcal s}}}_{n,1}=\\bar{j}\\right ) } & = \\prod_{i=1}^k { { \\mathbf p}\\left({\\mathrm{bin}(|j_i|,1/2 ) } \\le   l_i\\right ) } , \\\\ { { \\mathbf p}\\left({\\mathrm{d}}_{f_{\\ln^2n}}(i)\\ge m_i,\\ , { \\mathrm{h}}_{n,1}(i)\\le l_i,\\ , i\\in [ k]\\,|\\ , \\bar{{{\\mathcal s}}}_{n,1}=\\bar{j}\\right ) } & = 2^{-\\sum m_i}\\prod_{i=1}^k { { \\mathbf p}\\left({\\mathrm{bin}(|j_i|-m_i,1/2 ) } \\le   l_i\\right)}{{\\mathbf 1}_{[|j_i|\\ge m_i]}}. \\end{aligned}\\ ] ]    fix @xmath514 and @xmath515 as given in the statement .",
    "once the sets @xmath505)$ ] are fixed , the depth @xmath518 of @xmath97 $ ] in @xmath389 is determined by the variables @xmath519 .",
    "consequently , given that @xmath520 the conditional law of the degrees and depths of vertices in @xmath521 depend on disjoint sets of independent variables",
    ". therefore , we can decouple the event @xmath522 .",
    "the first equality in the statement corresponds to the case when @xmath523 for all @xmath97 $ ] .",
    "now , for the second equality we first note that the product of indicator functions follows since @xmath524 for all @xmath97 $ ] occurs only if @xmath525 for each @xmath97 $ ] .",
    "then , for each @xmath97 $ ] we flip @xmath526 independent fair coins .",
    "the first @xmath527 coins must be heads and this occurs with probability @xmath528 .",
    "the number of tails in the remaining coin flips determine the depth @xmath518 ; this is distributed as @xmath529 .",
    "[ cond b ] furthermore , if @xmath515 is such that @xmath530 for all @xmath97 $ ] , then @xmath531,\\,\\bar{{{\\mathcal s}}}_{n,1}=\\bar{j}\\ } = \\{{\\mathrm{d}}_{f_{\\ln^2 n}}(i)\\ge m_i , i\\in [ k ] , \\bar{{{\\mathcal s}}}_{n,1}=\\bar{j}\\}.\\ ] ]    now , with high - probability , vertices in @xmath532 $ ] still belong to distinct trees in @xmath389 which implies that the truncated selection sets @xmath505)$ ] are disjoint . to see this ,",
    "let us define @xmath533\\}.\\ ] ] recall that the trees in @xmath534 are ordered in increasing order of their least element . by definition of @xmath535 ,",
    "@xmath536|\\le 1 $ ] for @xmath537 .",
    "thus , at no point @xmath538 are @xmath539 and @xmath540 merged , for distinct @xmath541 $ ] . in other words , @xmath542 for all @xmath97 $ ] , @xmath543",
    ". therefore , @xmath544 ) \\text { are pairwise disjoint } \\}.\\end{aligned}\\ ] ]    [ tau eq ] fix an integer @xmath307 . for @xmath1",
    "large enough , @xmath545    by definition , @xmath546 for all @xmath97 $ ] and @xmath543 .",
    "therefore , @xmath547|<2\\right)}=\\prod_{j = l+1}^n \\left(1-\\frac{k(k-1)}{j(j-1)}\\right ) \\ge \\prod_{j = l}^\\infty \\left(1-\\frac{k^2}{j^2}\\right).\\ ] ] the second equality is since the pairs @xmath548 are chosen independently and uniformly at random .",
    "for the next approximation we use that @xmath549 for @xmath550 sufficiently small and that @xmath551 for all @xmath427 .",
    "then , letting @xmath552 and @xmath1 large enough , we have @xmath553    finally , we consider the following family of sets as representing the bulk of the probability measure induced by @xmath92 truncated sets .",
    "we add the parameter @xmath329 to cover the distinct possible values of @xmath554^k$ ] in theorem  [ limit ck ] . for @xmath555",
    "let @xmath556\\}. \\end{aligned}\\ ] ]    [ bulk ] fix an integer @xmath307 and @xmath555 .",
    "then @xmath557    this follows directly from and facts [ b2 ] and  [ tau eq ] ; @xmath558    let @xmath559)$ ] be @xmath92 independent copies of @xmath560 .",
    "we use sets @xmath561 to make explicit the claim that @xmath505)$ ] are asymptotically independent ; this occurs uniformly on such @xmath561 .",
    "[ s indep ] fix an integer @xmath307 and @xmath555 .",
    "uniformly for @xmath562 , @xmath563    the remainder of the section is devoted to proving proposition  [ s indep ] , and to do so we fix @xmath555 and @xmath562 .",
    "the notation we define below does not reflect the dependency on @xmath564 .",
    "we use the index @xmath28 with @xmath565 unless otherwise specified . recall that @xmath566 .",
    "similarly , for all @xmath28 and @xmath97 $ ] , let @xmath567 be the random indicator of @xmath568 and let @xmath569}}$ ] . also , let @xmath570 } j_{m , i}$ ] and note that from the choice of @xmath564 we have that @xmath571 for all @xmath28 .",
    "[ am ] for each @xmath28 , let @xmath572\\}$ ] .",
    "then @xmath573 and furthermore , @xmath574\\right)}=\\prod_{m } { { \\mathbf p}\\left(a_m\\,|\\ , a_l,\\,m < l\\le n\\right)}.\\ ] ]    the second equality follows since @xmath575\\}=\\{\\cap_m a_m\\}$ ] .",
    "we proceed to prove by induction on @xmath576 . for @xmath577 ,",
    "the formula is trivial . for @xmath578 note",
    "that the condition @xmath579 implies that @xmath580 for all @xmath581 .",
    "that is , there has been no merges of distinct trees @xmath582 for @xmath541 $ ] .",
    "in particular , @xmath583 for all @xmath97 $ ] . if @xmath584 , then none of these trees are selected to be merged in the next step , and this occurs with probability @xmath585 .",
    "if @xmath586 , then there is exactly one vertex @xmath97 $ ] which is selected and the other tree is selected among @xmath587 trees .",
    "similarly , we have the following estimates for @xmath559)$ ] .",
    "[ am ] for each @xmath28 , let @xmath588\\}$ ] .",
    "then @xmath589 and furthermore , @xmath590\\right)}=\\prod_{m } { { \\mathbf p}\\left(a_m\\right)}.\\ ] ]    it is clear that @xmath591\\}=\\{\\cap_m a'_m\\}$ ] .",
    "observe that the events @xmath592 are independent .",
    "also , follows immediately from the distribution of @xmath593)$ ] and the fact that these variables are independent .",
    "proposition  [ s indep ] is obtained by comparing the two products in the claims above .",
    "the following claim relates each of the terms in and .",
    "let @xmath594    [ pm01 ] there exists a constant @xmath595 such that for @xmath28 large enough , we have @xmath596    first we prove the bounds on @xmath597 .",
    "note that @xmath598 and so @xmath599 the upper bound on @xmath597 follows from the first inequality in .",
    "for the lower bound , use that @xmath600 as @xmath444 then @xmath601 the bounds on @xmath602 are obtained similarly .",
    "we use that @xmath603 as @xmath444 and @xmath604    fix @xmath555 and @xmath307 .",
    "the bounds we give below do not depend on the choice of @xmath562 and so the bounds obtained are uniform in @xmath561 . by claims",
    "[ am ] and  [ am ] , it suffices to prove that @xmath605 the lower bounds in claim [ pm01 ] give , for @xmath28 large enough , @xmath606 the last equality follows in the same manner as the bound for @xmath607 obtained in fact  [ bulk ] .",
    "now , using the upper bounds in claim [ pm01 ] we have , for @xmath28 large enough , @xmath608}}\\right ) \\\\ & = { { \\mathbf p}\\left(a'_m\\,,\\ , \\ln^2 n < m\\le n\\right)}\\prod_{m:\\sigma_m=1 } \\left(1+\\frac{c}{m}\\right)\\\\ & \\le { { \\mathbf p}\\left(a'_m\\,,\\ , \\ln^2 n < m\\le n\\right)}\\left(1+\\frac{2(2+\\delta)ck}{\\ln n}\\right).\\end{aligned}\\ ] ] in the last inequality we use that @xmath609 by the second condition on @xmath561 .",
    "thus , @xmath610 in the first inequality we use that @xmath611 and @xmath612 for all @xmath427 ; for the second inequality , we use that @xmath613 for @xmath614 sufficiently small .",
    "in this section we fix @xmath307 and prove that the main contribution to @xmath615)$ ] is already found in @xmath389 . recall that @xmath616 and @xmath617 , for @xmath274 $ ] . the key observation in this section",
    "is that the coalescence after @xmath389 can be compared with an independent @xmath618-coalescent .",
    "[ h2 dom ] for any @xmath24 $ ] , @xmath619 is stochastically dominated by @xmath620 .    in an @xmath1-coalescent @xmath212",
    "we have that @xmath621 with @xmath622 .",
    "thus , @xmath623 the result then follows since for any @xmath624 , we have that @xmath625 .",
    "[ neglig ] for any vertex @xmath274 $ ] , we have @xmath626 , in probability as @xmath31 .",
    "by fact [ h2 dom ] , it suffices to prove that for every @xmath412 , @xmath627 write @xmath628 and note that @xmath629 } = 2\\ln \\ln n + o(1)$ ] and so @xmath630}}{{{\\mathbf e}\\left[|{{\\mathcal s}}_{m}(i)|\\right]}}>0 $ ] for @xmath1 large enough . therefore , lemma  [ b2 ] yields @xmath631}| > \\delta{{\\mathbf e}\\left[|{{\\mathcal s}}_m(i)|\\right]}\\right)}=o(1).\\ ] ]    in fact , for @xmath97 $ ] , @xmath632 is also negligible when we condition on the vertices in @xmath532 $ ] to have large degree .",
    "let @xmath633)$ ] be the power set of @xmath16 $ ] and fix @xmath634 . let @xmath635\\right ) } > 0\\},\\\\ { { \\mathcal l}}_{\\bar{m}}&=\\ { \\bar{j}\\in \\omega^k:\\ , |j_i\\setminus [ \\ln^2 n]|\\ge m_i,\\ , i\\in [ k]\\}.\\end{aligned}\\ ] ]    [ ai ] fix @xmath634 . for any @xmath636 and @xmath97 $ ] ,",
    "if @xmath637 we have @xmath638\\,|\\ , \\bar{{{\\mathcal s}}_n}=\\bar{j}\\right ) } & \\le 2^{-\\sum_{j } m_j } ;   \\intertext{if $ \\bar{j}\\in { \\mathcal a}_{\\bar{m}}\\cap { { \\mathcal l}}_{\\bar{m}}$ , then } { { \\mathbf p}\\left({\\mathrm{h}}_{n,2}(i)\\ge s,\\ ,   { \\mathrm{d}}_n(j ) \\ge m_j,\\ , j\\in [ k]\\,|\\ , \\bar{{{\\mathcal s}}_n}=\\bar{j}\\right ) } & \\le 2^{-\\sum_{j } m_j } { { \\mathbf p}\\left({{\\mathcal s}}_{\\ln^2 n}(i)\\ge s\\right)}.\\end{aligned}\\ ] ]    recall that the degree of a vertex @xmath97 $ ] is determined by the first streak of selection times @xmath639 where @xmath640 . if @xmath637 , then the event @xmath641 has the property that the set of the first @xmath527 selection times in @xmath642 are pairwise disjoint for all @xmath97 $ ] ; otherwise @xmath643\\right)}=0 $ ] .",
    "it then follows that @xmath644\\,|\\ , \\bar{{{\\mathcal s}}_n}=\\bar{j}\\right ) } = 2^{-\\sum_{j } m_j } , \\end{aligned}\\ ] ] which yields the first inequality . for the second inequality it remains to prove that for @xmath645 , @xmath646,\\ , \\bar{{{\\mathcal s}}_n}=\\bar{j}\\right ) } & \\le { { \\mathbf p}\\left({{\\mathcal s}}_{\\ln^2 n}(i)\\ge s\\right)}.\\end{aligned}\\ ] ] in this case , the event @xmath647\\}$ ] is already determined by the forest @xmath389 .",
    "consequently , the remaining selection times @xmath648 $ ] , which determine @xmath649 , are independent of the conditioning event and so the argument in fact [ h2 dom ] can be applied .",
    "the next lemma uses a result from @xcite , whose proof can be derived from this work but we omit its proof for brevity .",
    "[ old core ] fix @xmath127 and @xmath90 .",
    "there exists @xmath650 such that uniformly over positive integers @xmath651 , @xmath652\\right)}= 2^{-\\sum_{j } m_j } ( 1+o(n^{-\\beta})).\\ ] ]    [ neglig d ] fix @xmath127 .",
    "if @xmath653 for all @xmath654 $ ] , then for any @xmath655 $ ] , @xmath656\\right ) } \\to 0.\\ ] ]    let @xmath657 satisfy the conditions of the statement . by lemma  [ ai ] , we have for any @xmath97 $ ] and @xmath636 , @xmath658\\right ) } & = \\sum_{\\bar{j}\\in { \\mathcal a}_{\\bar{m } } } { { \\mathbf p}\\left(\\bar{{{\\mathcal s}}_n}=\\bar{j},\\ , { \\mathrm{h}}_{n,2}(i)\\ge s,\\ , { \\mathrm{d}}_n(j ) \\ge m_j,\\ , j\\in [ k]\\right)}\\\\ & \\le \\quad 2^{-d}[{{\\mathbf p}\\left(|{{\\mathcal s}}_{\\ln^2 n}(i)|\\ge s\\right ) } + { { \\mathbf p}\\left(\\bar{{{\\mathcal s}}_n}\\notin { { \\mathcal l}}_{\\bar{m}}\\right)}].\\end{aligned}\\ ] ] if @xmath659 , the first probability in the last line vanishes as @xmath31 by .",
    "also , by we get @xmath660 therefore @xmath661\\right)}=\\frac{2^{-\\sum_j m_j}o(1)}{{{\\mathbf p}\\left({\\mathrm{d}}_n(j ) \\ge m_j,\\ , j\\in [ k]\\right)}};\\ ] ] and the proof is completed since @xmath662\\right)}=2^{-\\sum_j m_j}(1+o(1))$ ] by proposition  [ old core ] .",
    "fix an integer @xmath307 .",
    "we would like to express @xmath663\\right)}$ ] as a product of expectations of the form in since this would yield the independence of the limiting variables .",
    "however we have seen previously that this is not possible largely due to the correlations between the selection sets of vertices @xmath97 $ ] .",
    "instead we consider the depths @xmath664)$ ] and exploit the fact that @xmath665)$ ] are asymptotically independent . given a measure @xmath666 , we write @xmath667 for expectations with respect to @xmath666 .    [ approxint ] for each @xmath19 , let @xmath668 and @xmath669 be probability measures in a space @xmath670 .",
    "let @xmath671 be such that , uniformly for each @xmath672 , @xmath673 ; and @xmath674 .",
    "if @xmath675 are bounded and @xmath676 for all @xmath672 ; then @xmath677}=(1+o(1)){{\\mathbf e_{\\nu_n}}\\left[g_n\\right ] } + o(1).\\ ] ]    in the subspace @xmath678 we can interchange @xmath206 and @xmath422 ; and since the approximation @xmath679 is uniform over @xmath672 we have that @xmath680}}\\right]}=(1+o(1)){{\\mathbf e_{\\nu_n}}\\left[f_n{{\\mathbf 1}_{[b_n]}}\\right]}=(1+o(1)){{\\mathbf e_{\\nu_n}}\\left[g_n{{\\mathbf 1}_{[b_n]}}\\right]}.\\ ] ] the result follows by noting that @xmath681}}\\right]}-(1+o(1)){{\\mathbf e_{\\mu_n}}\\left[g_n{{\\mathbf 1}_{[\\omega_n\\setminus b_n]}}\\right]}=o(1);\\ ] ] which is a straightforward consequence of @xmath206 and @xmath422 being bounded and that the measure of @xmath682 vanishes for both measures as @xmath31 .",
    "similar to section  [ case 1 ] above , we will start with the unconditional case ; that is , the limiting distribution of @xmath506)$ ] .",
    "[ limit kt ] fix an integer @xmath307 .",
    "for any @xmath683 , @xmath684\\right ) } = \\prod_{i=1}^k \\phi(x_i).\\ ] ]    recall the definition of @xmath685 in .",
    "we claim that for any @xmath683 , @xmath686\\right ) }   = ( 1+o(1))\\prod_{i=1}^k { { \\mathbf e}\\left[g_{n , x_i } ( |{{\\mathcal s}}_{n,1}(i)|)\\right ] } + o(1).\\end{aligned}\\ ] ]    to see this , let @xmath668 denote the law of @xmath505)$ ] and @xmath669 denote the law of @xmath559)$ ] ; recall that the latter are @xmath92 independent copies of @xmath560 .",
    "let @xmath687 be as defined in and set @xmath688\\,|\\ , \\bar{{{\\mathcal s}}}_{n,1}=\\bar{j}\\right)},\\\\ g_n(\\bar{j } ) & = \\prod_{i=1}^k g_{n , x_i}(|j_i|).\\end{aligned}\\ ] ] from the first equation in proposition  [ dep degd ] , it follows that @xmath689 for all @xmath690 .",
    "therefore , the conditions on lemma  [ approxint ] for @xmath691 and @xmath687 are satisfied by lemma  [ bulk ] and proposition  [ s indep ] , establishing .",
    "finally , it suffices to verify that , for all @xmath97 $ ] , @xmath692 } = { { \\mathbf e}\\left[\\phi(\\sqrt{2}x_i - n))\\right ] } = \\phi(x_i);\\ ] ] where @xmath328 is a standard gaussian variable .",
    "the proof of this follows with the same argument as that for lemma  [ step 2 ] with the main difference being that , instead of using @xmath693 , we use @xmath526 . by lemma",
    "[ b2 ] , the renormalization @xmath694 also converges to a standard gaussian distribution .",
    "we now proceed to treat the case with nontrivial conditioning .",
    "[ limit ckt ] fix an integer @xmath307 and vectors @xmath554^k$ ] , @xmath695 and @xmath683 ; we have @xmath696 \\,|\\ , { \\mathrm{d}}_n(i)\\ge m_i,\\ , i\\in [ k ] \\right)}=\\prod_{i=1}^k \\phi(x_i),\\ ] ] where @xmath697 and @xmath698 .",
    "recall the definition of @xmath699 in . in",
    "what follows , we assume , without lose of generality , that @xmath700 ( if @xmath701 then @xmath702 a.s . ,",
    "so we set @xmath523 ) .",
    "now , we first show that @xmath703\\right ) } = ( 1+o(1 ) ) 2^{-\\sum_i m_i } \\prod_{i=1}^k { { \\mathbf e}\\left[\\widetilde{g}_{m_i , l_i } ( |{{\\mathcal s}}_{n,1}(i)|)\\right ] } + o(1).\\end{aligned}\\ ] ] to see this , let @xmath668 denote the law of @xmath505)$ ] and @xmath669 denote the law of @xmath559)$ ] ; recall that the latter are @xmath92 independent copies of @xmath560 .",
    "also , write @xmath704\\,|\\ , \\bar{{{\\mathcal s}}}_{n,1}=\\bar{j}\\right)}\\\\ g_n(\\bar{j } ) & = 2^{-\\sum_i m_i } \\prod_{i=1}^k \\widetilde{g}_{m_i , l_i } ( |j_i|).\\end{aligned}\\ ] ]    let @xmath705\\}$ ] and set @xmath706 . note that @xmath707 is chosen so that , for @xmath1 large enough , @xmath689 for all @xmath562 ; this follows from remark  [ cond b ] and the second equation in proposition  [ dep degd ] .",
    "lemma  [ bulk ] and proposition  [ s indep ] yield the remaining conditions on @xmath691 and @xmath561 , which applying lemma  [ approxint ] gives .",
    "next , let @xmath328 be a variable with standard gaussian distribution . for each @xmath97",
    "$ ] , @xmath708 } = { { \\mathbf e}\\left[\\phi\\left(\\frac{\\sqrt{1 + \\mu_{a_i } } x_i - n}{\\sqrt{\\mu_{a_i } } } \\right)\\right]}=\\phi(x_i).\\end{aligned}\\ ] ]    the last equality follows by lemma  [ intb ] and the proof of the first equality follows similar to lemma  [ step 2 ] when replacing the variables @xmath693 to @xmath526 , which have the same limiting distribution .",
    "finally , it follows from and that @xmath709\\right ) } & = 2^{-\\sum_i m_i } \\prod_{i=1}^k \\phi(x_i);\\end{aligned}\\ ] ] the result now follows by proposition  [ old core ] , since @xmath710\\right)}$ ] converges to @xmath711 .",
    "let @xmath554^k$ ] and @xmath712 be fixed and set @xmath713 .",
    "if @xmath714 for all @xmath97 $ ] , the result follows from proposition  [ limit kt ] and lemma  [ neglig ] .",
    "otherwise , the result follows from proposition  [ limit ckt ] and lemma  [ neglig d ] .",
    "the next lemma appeared in @xcite ; we include its short proof for completeness .",
    "[ inclusion - ex ] for any @xmath715 and integers @xmath716)$ ] , @xmath717\\right ) } = \\sum_{l=0}^{k ' } \\sum_{\\stackrel{s\\subset [ k']}{|s|=l } } ( -1)^l { { \\mathbf p}\\left({\\mathrm{d}}(i)\\ge m_i+{{\\mathbf 1}_{[i\\in s]}},\\ , i\\in [ k']\\right)}.\\ ] ] furthermore , for fixed @xmath127 ; if @xmath718 for @xmath97 $ ] and @xmath719 , then @xmath720}{|s|=l } } ( -1)^l   { { \\mathbf p}\\left({\\mathrm{d}}_n(i)\\ge m_i+{{\\mathbf 1}_{[i\\in s]}},\\ , i\\in [ k]\\right)}\\\\ = & 2^{-k'-\\sum_i m_i}(1+o(1)).\\end{aligned}\\ ] ]    the first part is proven directly proved using the inclusion - exclusion principle",
    ". the second equation follows by intersecting the event @xmath721 along all probabilities in the first equation ; then applying proposition  [ old core ] to each term : @xmath722}{|s|=l } } ( -1)^l   { { \\mathbf p}\\left({\\mathrm{d}}_n(i)\\ge m_i+{{\\mathbf 1}_{[i\\in s]}},\\ , i\\in [ k]\\right ) } = ( 1+o(1))2^{-\\sum_i m_i}\\sum_{l=0}^{k ' } \\sum_{\\stackrel{s\\subset [ k']}{|s|=l } } ( -1)^l 2^{-l}.\\ ] ]    [ pre - moments ] let @xmath719 and fix @xmath723 for @xmath724 .",
    "write @xmath725 and @xmath726 \\right\\}.\\end{aligned}\\ ] ] then @xmath727    we start by intersecting the event @xmath728 along all probabilities in the second expression of lemma  [ inclusion - ex ] ; then we use the approximation by independent gaussian variables given in theorem  [ limit ck ] .",
    "this gives    @xmath729}{|s|=l } } ( -1)^l   { { \\mathbf p}\\left({\\mathcal h}_{\\bar{a}},\\ , { \\mathrm{d}}_n(i)\\ge m_i+{{\\mathbf 1}_{[i\\in s]}},\\ , i\\in [ k]\\right)}\\\\ = & \\sum_{l=0}^{k ' } \\sum_{\\stackrel{s\\subset [ k']}{|s|=l } } ( -1)^l   { { \\mathbf p}\\left({\\mathcal h}_{\\bar{a}}\\,\\middle|\\ , { \\mathrm{d}}_n(i)\\ge m_i+{{\\mathbf 1}_{[i\\in s]}},\\ , i\\in [ k]\\right)}{{\\mathbf p}\\left({\\mathrm{d}}_n(i)\\ge m_i+{{\\mathbf 1}_{[i\\in s]}},\\ , i\\in [ k]\\right)}\\\\ = & ( 1+o(1)\\prod_{i=1}^{k } \\phi(a_i ) \\sum_{l=0}^{k ' } \\sum_{\\stackrel{s\\subset [ k']}{|s|=l } } ( -1)^l   { { \\mathbf p}\\left({\\mathrm{d}}_n(i)\\ge m_i+{{\\mathbf 1}_{[i\\in s]}},\\ , i\\in [ k]\\right)}\\\\ = & ( 1+o(1))\\left ( 2^{-k'-\\sum_i m_i } \\right ) \\prod_{i=1}^{k } \\phi(a_i).\\end{aligned}\\ ] ]    fix @xmath127 and @xmath167 .",
    "let @xmath131 and @xmath168 be integer - valued functions with @xmath169 ; let @xmath730 and @xmath171)$ ] be non - negative integers such that @xmath731 } a_k = m$ ] and set @xmath732}a_k$ ] . consider an arbitrary @xmath148-canonical sequence @xmath158 with @xmath173 and @xmath174 .",
    "we define @xmath733 and @xmath734 as follows . for each @xmath142 $ ] , if @xmath735 then set @xmath736 and let @xmath737 . in this case , consider the sets @xmath738 \\right\\}.\\end{aligned}\\ ] ] by corollary  [ relabel cor ] and the exchangeability of the vertex degrees of @xmath739 ,    @xmath175 } \\\\ & = ( n)_m { { \\mathbf p}\\left({\\mathcal d}_{\\bar{m}},\\,{\\mathcal h}_{\\bar{a}}\\right)}\\\\ & = ( 1+o(1))\\left ( 2^{m\\log n - m'-\\sum_i m_i } \\right ) \\prod_{i=1}^{m } \\phi(a_i),\\end{aligned}\\ ] ]    the last equality holding by corollary  [ pre - moments ] and since @xmath740 .",
    "finally , note that @xmath741 and so @xmath742 similarly , @xmath743 ; which completes the proof .",
    "recall that @xmath33 is the set of vertices in @xmath744 attaining the maximum degree . in light of theorem  [ mppp ] , to prove theorem  [ max normal ] it suffices to prove the convergence of @xmath745 over suitable subsequences .",
    "[ conv m ] let @xmath61 $ ] .",
    "if @xmath82 is an increasing sequence such that @xmath106 as @xmath65 , then @xmath746 converges in distribution to @xmath747 , where @xmath748 is defined by @xmath749 for each integer @xmath750 .",
    "the formula for @xmath751 may be seen using the following heuristic .",
    "each of the terms in the sum represent the limit of the probability that ; given that the maximum degree in @xmath0 equals @xmath752 , there exist precisely @xmath92 vertices attaining such degree .",
    "we first verify that @xmath753 ; this follows from a telescopic analysis of the sum .",
    "we now proceed to the proof of the theorem ; we abuse notation by writing , e.g. @xmath755 .",
    "consider @xmath61 $ ] fixed and @xmath82 an increasing sequence for which @xmath106 as @xmath65 .",
    "we assume @xmath756 for simplicity of the formulas below .",
    "fixing @xmath757 we have @xmath758 by lemma  [ equiv mppp ] and theorem  [ mppp ] we have that for each @xmath759 , @xmath760 and that the limit is a vector of independent vector of poisson variables .",
    "in particular , @xmath761 also @xmath762 , and @xmath763 .",
    "thus , in the limit @xmath764 this holds for arbitrary @xmath167 , hence @xmath765 similarly , @xmath766",
    "i would like to thank louigi addario - berry and henning sulzbach for some very helpful discussions .",
    "this research was supported by fqrnt thrhough pbeee scholarship with number 169888 .",
    "louigi addario - berry .",
    "partition functions of discrete coalescents : from cayley s formula to frieze s @xmath767(3 ) limit theorem . in _ xi symposium on probability and stochastic processes : cimat , mexico , november 18 - 22 , 2013 _ , pages 145 .",
    "springer international publishing , cham , 2015 ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a random recursive tree with @xmath1 nodes . </S>",
    "<S> list vertices of @xmath0 in decreasing order of degree as @xmath2 , and write @xmath3 and @xmath4 for the degree of @xmath5 and the distance of @xmath5 from the root , respectively . </S>",
    "<S> we prove that , as @xmath6 along suitable subsequences , @xmath7 where @xmath8 , @xmath9 , @xmath10 is a poisson point process on @xmath11 and @xmath12 is a vector of independent standard gaussians . </S>",
    "<S> we additionally establish joint normality for the depths of uniformly random vertices in @xmath0 , which extends results from @xcite . </S>",
    "<S> the joint holds even if the random vertices are conditioned to have large degree , provided the normalization is adjusted accordingly .    </S>",
    "<S> our results are based on a simple relationship between random recursive trees and kingman s @xmath1-coalescent ; a utility that seems to have been largely overlooked . </S>"
  ]
}