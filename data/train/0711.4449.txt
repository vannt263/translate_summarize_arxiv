{
  "article_text": [
    "during experimental data processing often there is a task to fit arbitrary distribution with the only peak to some function with a set of free parameters .",
    "this can be necessary for more precise determination of peak position , or full width at half maximum ( devise resolution ) , or for the signal form approximation using monte carlo events for subsequent analysis of data distribution and so on .",
    "available set of fitting functions does not always matches the experimental requirements , especially for high statistics ( it is difficult to achieve suitable confidence level ) .    in practice most often",
    "the sum of the three gaussian distributions is used to fit such histograms . in most cases",
    "this fit provides suitable confidence level .",
    "at least one can add more and more gaussians until confidence level is admissible .",
    "disadvantage of this method is that every gaussian used is symmetric , so in principle one can not used sum of gaussians with common center to fit asymmetric distributions , and if all gaussians have different centers , then it is difficult to provide the only maximum of fitting function and monotony to the right and left of maximum .",
    "another often used function is a spline of two halves of different gaussians .",
    "this function is good in case that the function `` tails '' can be approximated with gaussian .",
    "however for high statistics the major experimental distributions far of peak have exponential or power - of - x dependence , which do not match gaussian .",
    "logarithmic gaussian distribution is also often used ( at slac it is called `` novosibirsk '' function ) : @xmath0,\\;\\ ; \\int\\limits_{\\frac{x_m - x}{x_m - x_p}>0}\\!\\!\\!\\!\\!f_n{\\,\\mathrm{d}}x=1,\\ ] ] where @xmath1 is a peak location ( function maximum ) , @xmath2 is full width at half maximum ( fwhm ) , @xmath3 is asymmetry parameter , @xmath4 is normalization factor . @xmath5",
    "@xmath6 @xmath7 as is seen from  ( [ eq : xm - expression ] ) , for @xmath8 the boundary coordinate @xmath9 and all @xmath10 .",
    "if @xmath11 , then @xmath12 and @xmath13 .",
    "using these notations one can rewrite this function , excluding the inconvenient variable @xmath14 : @xmath15 . \\end{array}\\ ] ] function is equal to 0 for all @xmath16 , for which the logarithm argument is negative .",
    "possible values of parameters : @xmath17 , @xmath3 is arbitrary , @xmath1 is arbitrary . for @xmath18",
    "the formulae have an ambiguity of the type @xmath19 , so some parameters should be expanded to the tailor series .",
    "@xmath20{c}\\sim \\\\[-2mm]\\scriptstyle\\lambda\\sim 0\\end{array } 1+\\frac{h\\left|\\lambda\\right|}{2}+\\frac{h^2\\lambda^2}{8},\\ ] ] therefore @xmath21{c}\\sim \\\\[-2mm]\\scriptstyle\\lambda\\sim 0\\end{array } \\lambda\\cdot\\left[1-\\frac{h^2\\lambda^2}{8 } + \\frac{7h^4\\lambda^4}{128}\\right],\\ ] ] @xmath22{c}\\sim \\\\[-2mm]\\scriptstyle\\lambda\\sim 0\\end{array } \\frac{h^2\\lambda^2}{8\\ln 2}\\cdot\\left [ 1-\\frac{h^2\\lambda^2}{3 } \\right],\\;\\;\\ ; \\frac{\\sigma}{\\left|\\lambda\\right| } \\begin{array}[t]{c}\\sim \\\\[-2mm]\\scriptstyle\\lambda\\sim 0\\end{array } \\frac{h}{2\\sqrt{2\\ln 2}}\\cdot\\left[1-\\frac{h^2\\lambda^2}{6 } \\right],\\ ] ] @xmath23{c}\\sim \\\\[-2mm]\\scriptstyle\\lambda\\sim 0\\end{array } \\frac{4\\ln 2 \\left(x - x_p\\right)^2}{h^2}\\cdot\\left [ 1-\\left(x - x_p\\right)\\lambda \\right].\\ ] ] for @xmath24 the function converts to @xmath25,\\ ] ] that is gaussian distribution with root mean square @xmath26    this function is convenient for fitting the distributions with abrupt spectrum end .",
    "however many experimental distributions are more smooth , and suggested in this paper function can be more successful .",
    "it is suggested to build the fitting function on the base of convolution of gaussian and exponential distributions , which can be easily derived : @xmath27 \\times \\\\[3mm]\\rule{35mm}{0mm}\\times \\exp\\left [ -\\frac{x - x_g}{\\lambda } + \\frac{\\sigma_g^2}{2\\lambda^2 } \\right ] .",
    "\\end{array}\\ ] ] integral of this function over all @xmath16 equals 1 .",
    "such a function was first used by the author in 2004 at slac ( babar note # 582 ) for fitting the deposited energy distributions in calorimeter with the aim of peak position and resolution determination for the algorithms of absolute photon energy calibration , and despite some technical difficulties , this function proved to be enough convenient for fitting such distributions , especially for high statistics .",
    "technical difficulties appear when the argument of erf function is big @xmath28 if the argument of erf function in formula  ( [ eq : fitcurve1explicit ] ) is denoted as @xmath29 @xmath30 then the formula  ( [ eq : fitcurve1explicit ] ) looks like : @xmath31 \\exp\\left[\\frac{z\\sigma_g\\sqrt{2}}{\\left|\\lambda\\right|}- \\frac{\\sigma_g^2}{2\\lambda^2 } \\right].\\ ] ] if @xmath32 , then exponential index also goes to infinity , and so the ambiguity of the type @xmath33 arises . because of finite accuracy of computer calculations , this difficulty appears rather fast , just for moderate values of @xmath34 .    to avoid this problem one can use the asymptotic expansion @xmath35 , \\;\\;\\ ; k_0\\leq z^2 .",
    "\\end{array}\\ ] ] substituting this expansion to  ( [ eq : fitcurve1reduced ] ) , we obtain : @xmath36 \\cdot \\left[1+\\sum\\limits_{k=1}^{k_0}\\frac{(-1)^k(2k-1)!!}{2^kz^{2k } } \\right ] .",
    "\\end{array}\\ ] ] here for big @xmath29 values no ambiguities appear , function goes to 0 .",
    "this very expansion allows to find the limit for @xmath37 . indeed ,",
    "@xmath38 and @xmath39 \\ ] ] let us consider the limit @xmath40 .",
    "@xmath41    and substituting this to  ( [ eq : fitcurve1reduced ] ) , we get @xmath42 \\frac{1}{\\left|\\lambda\\right|}\\exp\\left[-\\frac{(x - x_g)}{\\lambda}\\right ] , \\;\\ ; \\frac{(x - x_g)}{\\lambda}>0 . \\end{array}\\right.\\ ] ] function @xmath43 plots for several sets of parameters are presented in fig.[sampleoffb1 ] .",
    "= 0.49 = 0.49    sometimes the integral distribution can be useful : @xmath44 -\\\\[1 mm ] \\rule{40mm}{0 mm } -\\frac{\\lambda}{2\\left|\\lambda\\right| } e^{\\frac{\\sigma_g^2}{2\\lambda^2}-\\frac{x - x_g}{\\lambda}}\\left [ 1-\\mathrm{erf}\\left(\\frac{\\sigma_g}{\\sqrt{2}\\left|\\lambda\\right|}- \\frac{\\left(x - x_g\\right)\\left|\\lambda\\right|}{\\sqrt{2}\\sigma_g\\lambda } \\right)\\right ] .",
    "\\end{array}\\ ] ]    usage of @xmath43 to fit the distributions would be more convenient , if the free parameter is @xmath14  location of function maximum , instead of @xmath45 .",
    "equation for the search for @xmath14 looks rather complicated : @xmath46 \\end{array}\\ ] ] or in other notations @xmath47 where @xmath48 . for @xmath49",
    "@xmath50 : @xmath51 } \\longrightarrow z_m\\approx -\\sqrt{\\ln\\frac{\\rho}{2-\\frac{2}{\\rho\\sqrt{\\left|\\ln\\frac{\\rho}{2}\\right| } \\sqrt{\\pi}}\\cdot\\left [ 1-\\frac{1}{2\\ln\\frac{\\rho}{2}}\\right ] } } \\longrightarrow \\\\[7mm]\\rule{5mm}{0mm}\\longrightarrow -\\frac{\\left(x_m - x_g\\right)\\lambda}{\\sigma_g\\left|\\lambda\\right|\\sqrt{2 } } + \\frac{\\sigma_g}{\\left|\\lambda\\right|\\sqrt{2}}= -\\sqrt{\\ln\\frac{\\left|\\lambda\\right|}{\\sigma_g\\sqrt{2\\pi } } } \\end{array}\\ ] ] or @xmath52{c } \\approx \\\\[-2 mm ] \\scriptstyle \\sigma_g",
    "\\ll |\\lambda| \\end{array } \\frac{\\sigma_g^2}{\\lambda}+\\frac{\\sigma_g\\left|\\lambda\\right|\\sqrt{2}}{\\lambda}\\cdot \\sqrt{\\ln\\frac{\\left|\\lambda\\right|}{\\sigma_g\\sqrt{2\\pi } } } \\to 0.\\ ] ]    for @xmath53 @xmath54 , and here we also can derive approximate solution : @xmath55 = \\rho\\exp\\left(-z_m^2\\right)\\ ] ]    @xmath56    or @xmath57 from  ( [ eq : peakcondition ] ) one can derive more terms of taylor series : @xmath52{c } \\approx \\\\[-2 mm ]",
    "\\scriptstyle |\\lambda| \\ll   \\sigma_g \\end{array } \\lambda\\cdot\\left[1-\\left(\\frac{\\lambda}{\\sigma_g}\\right)^2 + \\left(\\frac{\\lambda}{\\sigma_g}\\right)^4+\\ldots \\right].\\ ] ]    let us return to the equation  ( [ eq : maxfb1 ] ) , which should be solved in order to find @xmath43 maximum location .",
    "let us transform the interval of @xmath58 variable to the interval @xmath59 : @xmath60 at the ends of the interval we know the solution : @xmath61 \\mu \\sim 1\\longrightarrow z_m\\approx \\frac{\\sqrt{\\pi}\\ln\\mu}{2}-\\frac{1}{\\sqrt{\\pi}\\ln\\mu } \\end{array}\\ ] ] let us look for approximating function in the form : @xmath62 function @xmath63 plot and the approximating cubic spline with 5 knots are presented in fig.[fpapproximation ] .",
    "= 0.7    root mean square deviation equals @xmath64 , maximum error of interpolation @xmath65 is achieved at @xmath66 .",
    "spline coefficients are cited in table[tab : fpspline ] .",
    ".[tab : fpspline]spline of deficiency 2 coefficients for approximation of @xmath63 function . [ cols=\"<,^,^,^,^,^\",options=\"header \" , ]     now we can calculate the shift of peak position vs gaussian center : @xmath67 the function @xmath68 can be easily implemented in any programming language , using the above formulae .",
    "in some cases the function @xmath43 itself can be suitable for fitting .",
    "however more often this function is not enough flexible to provide satisfactory confidence level with experimental distribution .",
    "one could try to use the function which is the convolution of the three distributions : gaussian and two different exponential .",
    "such a function could be useful if the distribution `` tails '' both to the right and left from the peak do not match gaussian distribution .",
    "however in this case and in other difficult ones the distributions are fitted more successfully to the sum of different @xmath43 functions with the common parameter  peak position @xmath14 . for the sum of two functions one can use the following expression : @xmath69\\rule{51mm}{0mm}+ \\sin^2\\xi\\cdot   f_{b1}\\left(x;x_m-\\delta x_{mg}(\\sigma_2,\\lambda_2),\\sigma_2,\\lambda_2\\right ) \\end{array}\\ ] ]    sample of using such a function is presented in fig.[fitetram0acfb1 ] (",
    "one more parameter is added  common factor @xmath4 ) .",
    "= 0.49 = 0.49    in principle for complicated cases one can use the sum of more @xmath43 functions .",
    "however for so many free parameters the likelihood function minimization can be unstable , and one need to help minuit program .",
    "the simplest and enough effective trick is optimization of parameters in turn , initially fixed at some reasonable values .",
    "for fitting the smooth distributions with one peak a function is suggested , which is the convolution of gaussian and exponential distributions ."
  ],
  "abstract_text": [
    "<S> in the paper a new fitting function is suggested , which can essentially increase the existing instrumentation for fitting of asymmetric peaks with the only maximum . </S>"
  ]
}