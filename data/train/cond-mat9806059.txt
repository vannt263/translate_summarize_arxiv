{
  "article_text": [
    "among the sources of systematic error in monte carlo ( mc ) simulations , the most frightening is the lack of randomness in the used pseudo random number generator ( prng ) . indeed , in a modern mc simulation as much as @xmath0 random numbers may be generated  @xcite .",
    "this is as long as the longest test of random numbers we have heard of  @xcite .",
    "therefore , a prng needs to be fast and thus not too sophisticated , but it also should not bias the simulation results .",
    "shift - register prng s  @xcite have become very popular , due to their speed , but they have been shown to be unreliable for some applications  @xcite .",
    "the study of the trustworthiness of a prng is quite difficult as the answer is problem - dependent , algorithm - dependent and ( most important ) precision - dependent .",
    "for instance , in ref .",
    "@xcite some commonly used shift - register prng s were shown to yield incorrect results for the two dimensional ising model simulated with the wolff s single - cluster algorithm  @xcite .",
    "of course , this failure is related to one s statistical accuracy ( all the generators in ref .",
    "@xcite would be `` correct '' with @xmath1 errors ) .",
    "in particular , the * r250 * shift - register prng was found to be very dangerous for single - cluster update , but safe for its use with the metropolis algorithm .",
    "not long after that , * r250 * was shown to fail in the metropolis update of the blume - capel model for some lattice sizes  @xcite .",
    "another example of the difficulty in certifying prng s can be found in ref .",
    "@xcite . there ,",
    "* ranf * ( the standard cray prng ) is shown to be `` very good '' in the author own wording .",
    "this means that the longest carried run did not find bias in a two dimensional ising model simulation , where comparison with the exact solution is possible  @xcite .",
    "nevertheless , it has produced awfully wrong results in a u(1 ) lattice gauge - theory simulation  @xcite .",
    "moreover , it is fairly common that one s simulation is , itself , the longest run ever carried for this particular problem ( otherwise , why bother doing it ? ) . unless independent , algorithmically different simulations were performed , it is clear that one s result will not be yet _",
    "established_. further confidence can be obtained if sensible consistency tests are also carried . in this paper",
    "we want to show that schwinger - dyson identities may be useful in this respect , specially when no exact solution is at hand .",
    "let us finally mention that the investigation of the reasons for prng induced bias is interesting in itself  @xcite , but it has not yet reached predictive power ( one wants to know _ before _ carrying the simulation ) .",
    "generally speaking , schwinger - dyson equations are relations of the type @xmath2 where @xmath3 is an arbitrary operator and @xmath4 is the hamiltonian ( notice however that for eq .",
    "( [ sdcont ] ) not to be a trivial @xmath5 statement , @xmath3 should be an odd operator if @xmath4 is symmetric under the @xmath6 transformation ) .",
    "the problem is that the longest mc runs are usually done in discrete spin models , for which there are no continuous variables .",
    "nevertheless , for spin models the measure usually has a z@xmath7 symmetry , which allows to obtain equations analogous to ( [ sdcont ] ) . as an example , let us consider the ising model on the cubic lattice , with nearest neighbors interaction .",
    "the hamiltonian is @xmath8 where @xmath9 are the usual z@xmath7 spin variables .",
    "let us call @xmath10 to the sum of the spins coupled to spin @xmath11 .",
    "the self - evident relation @xmath12 yields for any observable depending on the spin @xmath11 ( and possibly also on others ) , @xmath13 , the following relation @xmath14 in particular , one gets @xmath15 where @xmath16 is the kronecker symbol . in order to gain statistics , it is useful to sum eq .",
    "( [ uno ] ) for all the lattice sites ( the lattice size being @xmath17 , its volume is @xmath18 ) .",
    "one obtains : @xmath19    summing to the nearest neighbors in eq .",
    "( [ sdcorr ] ) , we obtain an expression which has been very useful in mc renormalization group investigations of the dynamics of the poliakov loop in lattice gauge - theories  @xcite : @xmath20 it is trivial to generalize eq .",
    "( [ energia ] ) when more couplings are included in the hamiltonian , as needed in a mc renormalization group study .",
    "in addition , a non - local identity is obtained from eq .",
    "( [ sdcorr ] ) summing to all @xmath21 and @xmath22 : @xmath23    at this point , it is natural to ask if the right - hand side of eqs .",
    "( [ unoglobal],[energia],[sdmag ] ) can be measured with reasonable statistical accuracy .",
    "we shall see that the answer is positive .",
    "then the next natural question to ask is if a prng inducing bias also spoils the fulfillment of these equations . we shall find a positive answer only for eqs .",
    "( [ unoglobal ] ) and ( [ energia ] ) .",
    "finally , let us mention that the z@xmath7 symmetry is embedded in the symmetry of many other models , therefore eqs.([unoglobal],[energia],[sdmag ] ) hold as they are for o(@xmath24 ) spin - models , or , with trivial modifications , for su(@xmath25 ) lattice gauge - theories .",
    "we have studied the ising model ( with periodic boundary conditions ) in two and three dimensions at their critical points .",
    "three update methods have been considered : metropolis @xcite , the swendsen - wang cluster method @xcite and wolff s single - cluster ( sc ) @xcite . for each update ,",
    "we have employed three prng .",
    "one has been the problematic  @xcite * r250 * @xmath26 the second has been the parisi - rapuano ( * pr * ) prng  @xcite , which has been found not quite correct in four dimensional site - percolation  @xcite : @xmath27 where @xmath28    our last generator is defined with the help of a congruential generator : @xmath29 then , the * prc * prng @xcite is defined as @xmath30 our statistics have been the following . in two dimensions",
    "we have considered a @xmath31 lattice .",
    "we have simulated at the exact critical point up to 6 digits @xmath32 we have measured every 20 metropolis sweeps or 20 single - clusters , performing @xmath33 metropolis full - lattice sweeps , and updating @xmath34 clusters . for the swendsen - wang algorithm , we measure every 5 sweeps , and have generated the clusters @xmath34 times .    in three dimensions ,",
    "the critical coupling is known with great accuracy @xcite .",
    "we have simulated at @xmath35 as shown in ref .",
    "@xcite , it might happen that the bias only appears for some lattice sizes .",
    "therefore , we have studied @xmath31 and @xmath36 lattices . for metropolis or single - cluster ,",
    "we measure every 10 sweeps .",
    "we perform @xmath37 metropolis sweeps , and generate @xmath37 clusters . in the swendsen - wang case",
    ", we measure every 4 sweeps , generating the clusters @xmath38 times .",
    "we have found quite clear results for the different simulations , except for the single - cluster update of the @xmath39 and @xmath40 lattices , with * pr * as prng .",
    "we have found convenient to extend these two simulations , although this is in principle a dangerous procedure . of course",
    ", one can not proceed the run until the results `` looke nice '' , since this would bias the results . to avoid subjective decisions ,",
    "we have fixed _ a priori _ the total ( much longer than the initial ) simulation time : these two simulations have been 40 times longer than the others . in this way , error bars shrink enough to distinguish between a large statistical fluctuation and a systematic error .    before presenting our results ,",
    "a word of caution is in order .",
    "we have carried 27 independent simulations ( 3 lattices @xmath41 3 prng @xmath41 3 updates ) , so , the number of expected data points which are more than one standard deviation away is uncomfortably large .",
    "specifically , one can easily estimate that the number of points that are more than 1.7 deviations away ( @xmath42 probability ) must be between 2 and 4 .",
    "moreover , errors are not obtained with perfect accuracy . allowing a @xmath42 error in the error determination ,",
    "we have considered deviations larger than 3.3 error bars as a significant signal of bias ( less than a @xmath43 probability ) .",
    "let us first discuss our results in two dimensions .",
    "in the left - hand side of figure [ 162d ] we plot the deviations of the energy and the specific - heat from their exact values @xcite .",
    "we find significant deviations only for the single - cluster update when using * r250 * and * pr * as prng s ( the former is not surprising @xcite ) .",
    "it is clear that the exact solution is the best of possible tests , but we would like to confront it with the schwinger - dyson test . for this , let us define the quantities : @xmath44 which are the right - hand side of eqs.([unoglobal],[energia ] ) .",
    "unfortunately eq .",
    "( [ sdmag ] ) has been found to hold within errors in all cases . in the above expressions @xmath45",
    "is the mc average , not the expectation value .",
    "we show our results for a@xmath46 and a@xmath7 in the right - side of figure [ 162d ] .",
    "the only significant deviation found is in the single - cluster update with * r250*. this does not mean that the schwinger - dyson identities can be fulfilled with a biasing prng , as this is of course a matter of accuracy . in fact , performing a 40 times longer run with * pr * , we find @xmath47 thus , both the exact solution test and the schwinger - dyson identities test are failed by this sc-*pr * combination , but the exact solution test is more sensitive in this case .",
    "we can discuss our results more quantitatively . for small bias ,",
    "it is natural to expect that its main effect can be described as a shift on the coupling , from @xmath48 to @xmath49 . with this assumption",
    ", we can relate the different bias .",
    "let @xmath50 be the the difference between the mean value of @xmath3 obtained with some mc simulation , and its true boltzmann average , we obtain to first order in @xmath51 , and it is a growing function of @xmath48 . ]",
    "@xmath52 in this way , we can understand that the bias for the energy has opposite sign that the one for @xmath53 ( see footnote ) , and it is also opposite to the bias for the specific heat ( it is well known that the maximum of the specific heat of the two dimensional ising model in a finite lattice is at @xmath54 ) . the only evidence that we can offer for eq .",
    "( [ supertest ] ) is empirical , and it is shown in table [ sesgo2d ] .",
    "nevertheless , we find the agreement quite satisfactory for such a rough calculation .",
    "moreover , from table [ sesgo2d ] we can estimate that @xmath55 where the coefficient for the energy is really @xmath56 , to be compared with 1.33 from eq .",
    "( [ supertest ] ) .",
    "notice that if eq .",
    "( [ supertest ] ) could be rigourously established , it would be enough to estimate the failure in the schwinger - dyson test for any prng , to get the safe accuracy level for every observable .",
    "however , to our knowledge , such an interesting property has not been proved for any prng test .    for the three dimensional case",
    ", we plot our results for the energy and the specific - heat in the left - hand side of figures [ 163d ] and [ 243d ] . in this case",
    ", we unfortunately lack an exact solution to control for the bias .",
    "however , we can study the statistical compatibility of our data . from the plot it is apparent that the sc-*r250 * results are biased . in the figures we show the data with a weighted estimate of the energy and the specific - heat ( excluding the sc-*r250 * data ) .",
    "in fact , no further significant deviations are found . for the schwinger - dyson test , we find again strong signal of bias in a@xmath46 and a@xmath7 for the combination of * r250 * with single - cluster .",
    "we also find worrying deviations in the single - cluster update with * pr * as prng for @xmath31 . to clarify",
    "if a bias is present in this case , we have performed a 40 times longer run .",
    "the new results are @xmath57 thus , the * pr * prng does produce biased results in combination with the single - cluster update . in this case , we can not check eq .",
    "( [ supertest ] ) directly , as the deviations in the energy and specific - heat for sc-*pr * are not large compared to the errors .",
    "nevertheless , we can compare the bias for the sc-*r250 * in the @xmath40 and @xmath58 lattices ( see table [ sesgo3d ] ) , which is a test of the @xmath17 dependence of the linear coefficient in eq .",
    "( [ supertest ] ) . from finite - size scaling theory",
    ", we can estimate that @xmath59 where @xmath60 is the critical exponent for the correlation - length . from table",
    "[ sesgo3d ] , the above quotient can be estimated to be @xmath61 , which is certainly compatible with our prediction , but the error is so big that this is not a compelling evidence for eq .",
    "( [ supertest ] ) .",
    "now , if we assume again eq .",
    "( [ supertest ] ) , we obtain for the @xmath40 lattice @xmath62 and @xmath63 from these relations , and from the estimate of @xmath64 we obtain for the bias ( the statistical errors in fig . [ 163d ] being @xmath65 and @xmath66 ) @xmath67 thus , it is not surprising that the bias does not show up in fig .",
    "[ 163d ] . for the @xmath58 lattice",
    "we lack an accurate measure of the bias for @xmath53 , and so we can not obtain a bias estimate .",
    "as a final remark , notice that the sign of the bias seems to be independent of the lattice size and the space dimension for * r250*. this seems to be consistent with the simple ( unidimensional ) model proposed in ref .",
    "however in the * pr * case , the ( much smaller ) bias changes sign when going from 2 to 3 dimensions .",
    "this suggests that the reason for bias is more involved in this case .",
    "in this work , we have shown that some schwinger - dyson identities , eqs .",
    "( [ unoglobal],[energia ] ) , are sensitive test of prng induced bias .",
    "most important , they can be used when no exact solution is at hand .",
    "we have provided some empirical evidence for a simple relation between the bias induced in the different observables ( our eq .",
    "( [ supertest ] ) ) .",
    "this relation is obtained under the assumption that the main effect of the bias is to produce a shift on the coupling .",
    "it might be possible to justify this in terms of relevant and irrelevant operators , in the framework of the renormalization group .",
    "furthermore , this suggests that an investigation along the lines of ref .",
    "@xcite could be useful to establish which new couplings are generated by the prng - induced bias .",
    "if this relation could be established , the sd equation test would provide an estimate on the maximum _ safe _ accuracy that one can get for any observable , with the given prng .    in three dimensions , where there is no exact solution at hand",
    ", the schwinger - dyson equations test has shown that the single - cluster update with the * r250 * and * pr * prng s produces biased results , without resource to seven more simulations .",
    "it should be noticed that the measure of the schwinger - dyson equations comes almost for free , as the number of possible exponential factors is finite , and the local energy should be measured anyway .",
    "disk storage is not a shortcoming either , because no reweighting  @xcite is to be done , and the calculation can be made `` on the fly '' .",
    "they are also extremely helpful for code debugging .",
    "so , we believe schwinger - dyson equations to be very useful tools , which can be easily measured in almost every circumstances .",
    "we acknowledge interesting discussions with l. a. fernndez , j. j. ruiz - lorenzo and a. muoz - sudupe .",
    "the computations have been carried out using the rtnn machines at universidad de zaragoza and universidad complutense de madrid .",
    "we acknowledge cicyt for partial financial support ( aen97 - 1708 and aen97 - 1693 ) .",
    ".the bias for @xmath68 , for the @xmath39 lattice simulated with the sc-*r250 * , sc-*pr * combinations . to be able of measuring the bias in the sc-*pr",
    "* combination we have needed a much longer simulation ( see text ) .",
    "the constancy of the ratios is a check for eq .",
    "( [ supertest ] ) . [ cols=\"<,<,<,<,<\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> we use a set of schwinger - dyson equations for the ising model to check several random number generators . for the model in two and three dimensions </S>",
    "<S> , it is shown that the equations are sensitive tests of bias originated by the random numbers . </S>",
    "<S> the method is almost costless in computer time when added to any simulation .    </S>",
    "<S> pacs : 02.70 lq , 75.40 mg , 05.50.+q , 75.10 hk </S>"
  ]
}