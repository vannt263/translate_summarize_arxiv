{
  "article_text": [
    "we use a room - temperature type iia diamond with @xmath107 of @xmath1c grown by chemical vapor deposition ( element 6 ) . we apply a magnetic field of @xmath108 g along the nv symmetry axis ( @xmath30-axis ) , yielding a @xmath1c larmor frequency @xmath109 khz . the electronic dephasing time @xmath60 is @xmath110s .",
    "the hyperfine interaction for nuclear spin @xmath7 is given by @xmath111 ( fig .",
    "1a ) , with @xmath53 the component parallel to the magnetic field and @xmath112 the perpendicular component . @xmath113 khz and @xmath114 khz for nuclear spin 1 , and @xmath115 khz and @xmath116 khz for nuclear spin 2 .",
    "because @xmath117 khz the nuclear spins are weakly coupled to the electron spin and the hyperfine splittings are unresolved .      in a suitable rotating frame , the hamiltonian with a single nuclear spin can be written :    @xmath118    with @xmath119 and @xmath120 and with @xmath35 and @xmath14 the @xmath34 and @xmath45 electron states , respectively .",
    "nuclear spin gates are performed by applying sequences of the type @xmath121 on the electron spin ( rabi frequency @xmath122 mhz ) . because we set @xmath123",
    ", sharp resonances occur at @xmath124 , with integer @xmath125 . at these values",
    "a nuclear @xmath16-rotation is performed ( assuming @xmath126 ) . for odd",
    "@xmath125 the direction of the rotation is conditional on the electron spin ( e.g. the @xmath15 gates ) , for even @xmath125 it is unconditional ( @xmath127 gates ) . for the conditional gates we use @xmath128s , @xmath129 for spin 1 and @xmath130s , @xmath131 for spin 2 . for the unconditional gates we use @xmath132s , @xmath133 for spin 1 and @xmath134s , @xmath135 for spin 2 .",
    "z - rotations are implemented by choosing @xmath29 off - resonant .",
    "detailed simulations of the nuclear spin dynamics are available in the supplementary information .      the electron ramsey measurements in fig . 1d and 1e",
    "are analyzed in two ways : ( 1 ) the measurements are separately fit to @xmath136 , in which @xmath60 is a measure for the dephasing time set by the entire spin bath . the external magnetic field stability of better than @xmath137 mg over the total integration time ( @xmath138 hours ) , required in these experiments ,",
    "was achieved by post selecting from a larger measurement set .",
    "( 2 ) we determine the nuclear spin initialization fidelities @xmath139 and @xmath140 by averaging over multiple measurement runs ( supplementary information ) and using the hyperfine components @xmath141 and @xmath142 together with :    @xmath143 + f_1(1-f_2 ) \\cos\\bigg[\\left(\\omega+\\frac{a_\\parallel^1-a_\\parallel^2}{2}\\right)t\\bigg]\\ ] ]    @xmath144+(1-f_1)(1-f_2)\\cos\\bigg[\\left(\\omega-\\frac{a_\\parallel^1 + a_\\parallel^2}{2}\\right)t\\bigg]\\bigg).\\ ] ]    here @xmath145s is the electronic dephasing due to the rest of the spin bath , i.e. not including the two spins under study .      the applied errors realize the quantum map :    @xmath146    in which @xmath147 is the initial density matrix ( error characterization in supplementary information ) .",
    "we analyze the error - correction protocol by separating depolarization during the encoding , decoding and error - correction steps from the robustness of the encoded state to applied errors , which is characterized by the three probabilities @xmath86 that an error applied on qubit @xmath87 is successfully corrected ( derivation in supplementary information ) .",
    "the process fidelity for a single - qubit error ( fig .",
    "4d ) is then given by :    @xmath148,\\ ] ]    where @xmath149 and @xmath150 characterize the additional depolarization and are given by the average fidelities without applied errors .",
    "the equation contains a constant due to the @xmath69 states , which are unaffected by the applied error , and a sum of successful ( @xmath151 ) and unsuccessful ( @xmath152 ) error correction for the @xmath70 and @xmath71 states . for errors simultaneous on all three qubits ( fig .",
    "4e ) , the process fidelity becomes :    @xmath153,\\ ] ]    with @xmath154 the error probability .",
    "in general this equation describes a third order polynomial . for ideal error correction ( @xmath96 ) the linear term vanishes , whereas without robustness to errors ( @xmath94 ) , the result is strictly linear .",
    "the inversion symmetry about @xmath155 observed both theoretically and experimentally ensures that the nonlinear behavior is not due to spurious coherent rotations .",
    "after submission of this manuscript we became aware of related work by waldherr et al .",
    ", arxiv:1309.6424 in which 3-qubit quantum error correction is implemented using strongly coupled nuclear spins .",
    "we thank l. childress , j. j. l. morton , o. moussa and l.m.k .",
    "vandersypen for helpful discussions and comments .",
    "t.h.t . acknowledges support by a marie curie intra european fellowship within the 7th european community framework programme .",
    "work at the ames laboratory was supported by the u.s .",
    "department of energy basic energy sciences under contract no .",
    "de - ac02 - 07ch11358 .",
    "we acknowledge support from the dutch organization for fundamental research on matter ( fom ) , the netherlands organization for scientific research ( nwo ) , the darpa quasar programme , the eu solid , and diamant programmes and the european research council through a starting grant .",
    "[ 1 ] awschalom , d.d . ,",
    "bassett , l.c . ,",
    "dzurak , a.s . , hu ,",
    "e.l . , & petta , j.r . , quantum spintronics : engineering and manipulating atom - like spins in semiconductors .",
    "_ science _ * 339 * , 1174 - 1179 ( 2013 ) .",
    "[ 2 ] koehl , w.f . ,",
    "buckley , b.b . , heremans , f.j . , calusine , g. , & awschalom , d.d .",
    ", room temperature coherent control of defect spin qubits in silicon carbide .",
    "_ nature _ * 479 * , 84 - 87 ( 2011 ) .",
    "[ 3 ] yin , c. et al . , optical addressing of an individual erbium ion in silicon .",
    "_ nature _ * 497 * , 91 - 94 ( 2013 ) .",
    "[ 4 ] gurudev dutt , m.v .",
    "quantum register based on individual electronic and nuclear spin qubits in diamond .",
    "_ science _ * 316 * , 1312 - 1316 ( 2007 ) .",
    "[ 5 ] neumann , p. et al . ,",
    "multipartite entanglement among single spins in diamond",
    ". _ science _ * 320 * , 1326 - 1329 ( 2008 ) .    [ 6 ]",
    "fuchs , g.d .",
    ", burkard , g. , klimov , p.v . , & awschalom , d.d . , a quantum memory intrinsic to single nitrogen - vacancy centres in diamond . _ nature phys . _ * 7 * , 789 - 793 ( 2011 ) .    [ 7 ] van der sar , t. et al .",
    ", decoherence - protected quantum gates for a hybrid solid - state spin register .",
    "_ nature _ * 484 * , 82 - 86 ( 2012 ) .",
    "[ 8 ] maurer , p.c .",
    "et al . , room - temperature quantum bit memory exceeding one second .",
    "_ science _ * 336 * , 1283 - 1286 ( 2012 ) .",
    "[ 9 ] pfaff , w. et al . ,",
    "demonstration of entanglement - by - measurement of solid - state qubits . _ nature phys . _",
    "* 9 * , 29 - 33 ( 2013 ) .",
    "[ 10 ] pla , j.j .",
    "et al . , high - fidelity readout and control of a nuclear spin qubit in silicon .",
    "_ nature _ * 496 * , 334 - 338 ( 2013 ) .",
    "[ 11 ] dolde , f. et al .",
    ", room - temperature entanglement between single defect spins in diamond .",
    "_ nature phys . _",
    "* 9 * , 139 - 143 ( 2013 ) .",
    "[ 12 ] jiang , l. et al .",
    ", repetitive readout of a single electronic spin via quantum logic with nuclear spin ancillae .",
    "_ science _ * 326 * , 267 - 272 ( 2009 ) .",
    "[ 13 ] lee , s .- y .",
    "et al . , readout and control of a single nuclear spin with a metastable electron spin ancilla .",
    "_ nature nanotech . _",
    "* 8 * , 487 - 492 ( 2013 ) .",
    "[ 14 ] cory , d.g .",
    "et al . , experimental quantum error correction . _",
    "_ * 81 * , 2152 - 2155 ( 1998 ) .    [ 15 ] moussa , o. , baugh , j. , ryan , c.a . , &",
    "laflamme , r. , demonstration of sufficient control for two rounds of quantum error correction in a solid state ensemble quantum information processor .",
    "lett . _ * 107 * , 160501 ( 2011 ) .",
    "[ 16 ] schindler , p. et al . , experimental repetitive quantum error correction .",
    "_ science _ * 332 * , 1059 - 1061 ( 2011 ) .",
    "[ 17 ] reed , m.d .",
    "et al . , realization of three - qubit quantum error correction with superconducting circuits .",
    "_ nature _ * 482 * , 382 - 385 ( 2012 ) .",
    "[ 18 ] bernien , h. et al . , heralded entanglement between solid - state qubits separated by three metres .",
    "_ nature _ * 497 * , 86 - 90 ( 2013 ) .",
    "[ 19 ] nickerson , n.h . , li , y. , & benjamin , s.c . , topological quantum computing with a very noisy network and local error rates approaching one percent . _ nat .",
    "commun . _ * 4 * , 1756 ( 2013 ) .",
    "[ 20 ] neumann , p. et al . , single - shot readout of a single nuclear spin .",
    "_ science _ * 329 * , 542 - 544 ( 2010 ) .    [ 21 ] robledo , l. et al . , high - fidelity projective read - out of a solid - state spin quantum register .",
    "_ nature _ * 477 * , 574 - 578 ( 2011 ) .",
    "[ 22 ] dreau , a. , spinicelli , p. , maze , j.r . ,",
    "roch , j.f .",
    ", & jacques , v. , single - shot readout of multiple nuclear spin qubits in diamond under ambient conditions . _ phys . rev . lett . _ * 110 * , 060502 ( 2013 ) .",
    "[ 23 ] taminiau , t.h .",
    "et al . , detection and control of individual nuclear spins using a weakly coupled electron spin .",
    "lett . _ * 109 * , 137602 ( 2012 ) .",
    "[ 24 ] kolkowitz , s. , unterreithmeier , q.p . ,",
    "bennett , s.d . , & lukin , m.d . , sensing distant nuclear spins with a single electron spin .",
    "* 109 * , 137601 ( 2012 ) .",
    "[ 25 ] zhao , n. et al . , sensing single remote nuclear spins . _ nature nanotech . _ * 7 * , 657 - 662 ( 2012 ) .    [ 26 ] hodges , j.s .",
    ", yang , j.c . , ramanathan , c. , & cory , d.g . ,",
    "universal control of nuclear spins via anisotropic hyperfine interactions .",
    "rev . a _ * 78 * , 010303 ( 2008 ) .",
    "[ 27 ] zhang , y. , ryan , c.a . ,",
    "laflamme , r. , & baugh , j. , coherent control of two nuclear spins using the anisotropic hyperfine interaction .",
    "lett . _ * 107 * , 170503 ( 2011 ) .",
    "[ 28 ] london , p. et al . , detecting and polarizing nuclear spins with double resonance on a single electron spin .",
    "lett . _ * 111 * , 067601 ( 2013 ) .",
    "[ 29 ] filidou , v. et al .",
    ", ultrafast entangling gates between nuclear spins using photoexcited triplet states .",
    "_ nature phys . _",
    "* 8 * , 596 - 600 ( 2012 ) .",
    "[ 30 ] bar - gill , n. , pham , l.m . ,",
    "jarmola , a. , budker , d. , & walsworth , r.l .",
    ", solid - state electronic spin coherence time approaching one second .",
    "commun . _ * 4 * , 1743 ( 2013 ) .",
    "the experimental setup and sample are described in detail in the supplementary information of van der sar et al .",
    "@xcite we used a type - iia chemical vapour deposition grown diamond with a @xmath107 natural abundance of carbon-13 ( element 6 ) .",
    "solid immersion lenses were fabricated on top of the nitrogen vacancy ( nv ) centres to enhance the collection efficiency @xcite .",
    "the electron spin is controlled by microwaves through an on - chip stripline ( rabi frequency of 31.25 mhz ) .",
    "a magnetic field of @xmath108 g was applied along the nv symmetry axis using three electromagnets . at this magnetic field",
    "the intrinsic nv nitrogen-14 spin is polarized due to an excited - state anti - crossing @xcite .",
    "this section discusses the electron spin initialization , re - initialization and readout .",
    "in particular it analyzes how the imperfect spin and charge state initialization affect the outcomes of the different type of experiments performed .",
    "the electron spin is initialized in the @xmath34 state by a @xmath156 nm ( @xmath157w ) laser pulse ( typically 4@xmath158s ) and read out through its spin - dependent time - resolved fluorescence . in all experiments we measure the difference signal @xmath159 between the fluorescence signal @xmath160 for the final state and the fluorescence signal @xmath161 for the final state with a pi - pulse applied just before readout ( @xmath34 to @xmath45 transition ) .",
    "the obtained value is then normalized by dividing it by the same difference signal right after initialization : @xmath162 , where @xmath163 is without pi - pulse and @xmath164 with pi - pulse .",
    "the final normalized contrast @xmath165 is :    @xmath166    this method directly measures the contrast between @xmath34 and @xmath45 states .",
    "note that @xmath167 and that the result is independent of the population in other states , such as @xmath168 , that are not affected by the microwave pi - pulse .",
    "the reported expectation values directly correspond to @xmath165 , the measured fidelities are obtained from @xmath169 .",
    "the electronic initialization involves both spin states ( @xmath170 ) and charge states ( @xmath171 and @xmath172 ) .",
    "the initial state @xmath173 is :    @xmath174    with @xmath175 , and in which @xmath176 is the desired @xmath34 state , @xmath177 is the completely mixed state of @xmath34 and @xmath45 , @xmath178 represents the other spins states ( here @xmath168 ) and @xmath179 other charge states ( here @xmath172 )",
    ".    the precise values for @xmath180 and @xmath181 are unknown . for this nv centre",
    "the spin - state initialization fidelity was previously reported to be @xmath182 under similar conditions @xcite .",
    "the nv@xmath183 charge - state initialization fidelity @xmath184 is unknown here , but values of @xmath185 have been reported for other nv centres @xcite .",
    "the available initial population is given by @xmath186 .",
    "ideally , measurements of @xmath187 directly reflect the actual polarization so that @xmath188 . because only the @xmath176 term in equation [ eq : electron init ] is affected by microwave pulses only this term yields signal ( non - zero @xmath189 ) , so that the normalization signal always is @xmath190 , with @xmath191 an unknown proportionality constant .",
    "next we determine the obtainable final signal @xmath192 for two types of experiments : experiments that do not re - initialize the electron to create additional polarization in the nuclear spin register and those that do .",
    "first consider experiments where only a single electron initialization step is used , i.e. experiments that do not transfer polarization to the nuclear spins before resetting the electron spin . in this case",
    "the maximum value of @xmath192 simply is @xmath193 and the maximum contrast is @xmath194 . due to the calibration ,",
    "the final measured contrast is independent of @xmath186 and therefore does not take into account the charge and spin initialization fidelities .",
    "now consider experiments in which the electron spin polarization is transferred to a nuclear spin , the electron is re - initialized , and finally the electron is used to measure the nuclear spin state .",
    "the result @xmath192 depends on the correlations of the spin ( charge ) state after the re - initialization step with the spin ( charge ) state before it .",
    "we assume the spin states before and after re - initialization are uncorrelated , and derive the result @xmath192 for both uncorrelated ( no memory ) and maximally positive correlations ( ideal memory ) for the charge state .",
    "the state of the initialized electron and a single nuclear spin in a completely mixed state is : @xmath195 swapping the electron and nuclear spin states gives : @xmath196 as the swap gate has no effect on the erroneous electron spin ( @xmath197 ) and charge ( @xmath198 ) states .",
    "the electron spin initialization @xmath186 is thus directly transferred to the nuclear spin .",
    "we re - initialize the electron spin and assume that electron spin initialization is independent of the nuclear spin state .",
    "first consider the case of no correlations ( no memory ) for the charge state , so that the electron is completely re - initialized .",
    "the state in equation [ eq : after_swap ] becomes : @xmath199 reading out the nuclear spin with the electron spin only yields non - zero signal for both the electron and nuclear spins in the pure state @xmath176 , so that :    @xmath200    which shows that the maximum contrast @xmath201 is reduced by a factor @xmath186 and thus that the experiment faithfully reflects the actual nuclear spin state , including a reduced fidelity due to the imperfect electron spin and charge initialization .",
    "if the electron re - initialization does not change the charge state , equation [ eq : after_swap ] after electron re - initialization becomes : @xmath202 again taking into account that no difference signal is obtained if either the electron or the nuclear spin is not in state @xmath176 : @xmath203 the result now accurately reflects the spin state initialization , but is independent of the charge state initialization .",
    "the high nuclear initialization fidelity obtained here ( @xmath204 , figure 1 of the main text ) , indicates that the charge state initialization fidelity is high ( @xmath205 ) or that the measurements are not sensitive to it ( i.e. the re - initialization laser pulse has low probability to change the charge state ) .",
    "the same value gives a lower limit of the electron spin initialization @xmath206 , as the swap gate for initialization and the nuclear spin readout have limited fidelities as well .",
    "as in previous room temperature experiments , the charge state is thus not rigourously initialized nor proven to be fully reflected in the measurement outcomes . therefore the measured state fidelities do not give the actual purity of the states and no entanglement can be proven to be present .",
    "nevertheless the ( entangling ) gates and protocols developed and studied in this work can be accurately investigated through their action on the prepared states .",
    "note that methods to initialize the charge state have been developed at room temperature @xcite and that pure entangled states have been reported at cryogenic temperatures using simultaneous spin and charge initialization @xcite .",
    "to demonstrate that harnessing weakly coupled spins makes multiple qubits available for each defect with high certainty , we have controlled three weakly coupled nuclear spins for each of the three nv centres studied .",
    "this section contains the characterization of the nv centres and the nuclear - spin free - evolution experiments that demonstrate the initialization , control and readout of the nuclear spins .      , nv@xmath207 and nv@xmath208",
    ". the electron spin is prepared in a coherent superposition state ( @xmath209 ) and a dynamical decoupling sequence with 32 pi - pulses of the form @xmath210 is applied with variable interpulse delay @xmath9 before measuring @xmath211 .",
    "sharp dips in the signal indicate an entangling operation of the electron spin with individual @xmath1c spins in the spin bath @xcite .",
    "the arrows indicate the 9 different @xmath1c nuclear spins , and the values of @xmath29 used , for which we implemented initialization , control and readout ( see figures [ fig : ramseys_nv_a ] for nv@xmath212 , [ fig : ramseys_nv_b ] for nv@xmath207 and [ fig : ramseys_nv_c ] for nv@xmath208 ) .",
    "the experiments in the main text use nuclear spin 1 and 2 of nv@xmath212 .",
    "@xmath213 is the bare larmor period . ]",
    "we use dynamical decoupling spectroscopy @xcite to characterize the nuclear spin environment of a total of three nv centres : nv@xmath212 , which is studied in the main text , and the two additional centres nv@xmath207 and nv@xmath208 ( fig .",
    "[ fig : compare_nv ] ) .",
    "the resulting curves provide characteristic fingerprints of the nuclear spin environments of the nv centre .",
    "nv@xmath212 and nv@xmath207 show qualitatively similar behavior ( fig .",
    "[ fig : compare_nv ] ) ; both curves display broad echo collapses due to the spin bath at @xmath214 with odd @xmath215 and show distinct sharp dips due to individual @xmath1c nuclear spins that become visible at larger @xmath29 @xcite .",
    "however , the positions and depths of the different dips differ strongly due to the characteristic distribution of nuclear spins near each nv centre .",
    "in addition to a bath of weakly - coupled @xmath1c spins nv@xmath208 shows a rapidly oscillating component in the signal due to the presence of a strongly coupled nuclear spin ( hyperfine interaction of @xmath216 khz ) .      * .",
    "experiments as in figure 2 of the main text , but with the electron spin in @xmath34 ( left ) or @xmath45 ( right ) .",
    "the values for @xmath29 used for spin 1 ( orange ) , spin 2 ( green ) and spin 3 ( purple ) are marked in fig .",
    "[ fig : compare_nv ] . note that nuclear spin 1 and nuclear spin 2 are the two spins studied in detail and used for implementing the quantum - error - correction protocol . ]    * .",
    "experiments as in figure 2 of the main text , but with the electron spin in @xmath34 ( left ) or @xmath45 ( right ) .",
    "the values for @xmath29 used for spin 1 ( orange ) , spin 2 ( green ) and spin 3 ( purple ) are marked in fig .",
    "[ fig : compare_nv ] . ]    * .",
    "experiments as in figure 2 of the main text , but with the electron spin in @xmath34 ( left ) or @xmath45 ( right ) .",
    "the values for @xmath29 used for spin 1 ( orange ) , spin 2 ( green ) and spin 3 ( purple ) are marked in fig .",
    "[ fig : compare_nv ] . ]    for each of the three nv centres in figure [ fig : compare_nv ] , we select three nuclear spins ( marked in the figure ) and demonstrate initialization , control and direct readout by performing nuclear free precession experiments ( see figures 2a - d of the main text ) .",
    "we prepare the electron spin in @xmath34 or @xmath45 .",
    "the unique precession frequencies for @xmath45 confirm that in each case three different @xmath1c spins are controlled ( fig .",
    "[ fig : ramseys_nv_a ] , [ fig : ramseys_nv_b ] and [ fig : ramseys_nv_c ] ) .",
    "these results demonstrate the control of three weakly - coupled nuclear spins for each nv centre studied .",
    "our decoherence - protected gates therefore make several nuclear spins available per defect centre with a high certainty , in stark contrast to the highly probabilistic nature of the presence of strongly coupled @xmath1c spins .",
    "the fact that the gates can be applied in the presence of strongly coupled nuclear spins , including the intrinsic nitrogen and nearby @xmath1c nuclear spins , indicates that quantum registers with over @xmath217 nuclear spins are now well within reach ( see e.g. nv@xmath208 in figure [ fig : compare_nv ] ) .",
    "the hyperfine parameters for the three nuclear spins for nv@xmath212 , the nv centre used in the main text , are given in table [ table : hyperfine_parameters ] .",
    "the two nuclear spin qubits in the main text are spin 1 and 2 .",
    ".*hyperfine parameters for 3 relevant @xmath1c spins .",
    "* @xmath53 is the component parallel to the applied magnetic field ( along the nv symmetry axis ) .",
    "@xmath112 is the perpendicular component .",
    "this nv centre was studied previously @xcite . [",
    "cols=\"^,^,^ \" , ]      for a variable strength error on one of the qubits the final fidelity for inputs @xmath70 and @xmath71 is given by a weighted sum of the two corresponding values in table [ table:8 signals ] :    @xmath218    in which @xmath219 and @xmath220 identify the applied error combination .",
    "for example , for the variable error applied to qubit 2 and no error to qubits 1 and 3 , we have @xmath221 and @xmath222 . for @xmath69",
    "the signal is simply constant :    @xmath223    in figure 4d of the main text two different types of errors are applied : ( 1 ) just a variable error on qubit @xmath87 and ( 2 ) a variable error on qubit 2 and a full flip on qubit 1 . for a variable error on qubit @xmath87 ( @xmath224 ) and input @xmath70 or @xmath71",
    "equation [ fit_equation1 ] simplifies to :    @xmath225    in agreement with the interpretation of the values @xmath86 as the probability that an error on qubit @xmath87 is successfully corrected . for the variable error on qubit 2 and a full flip on qubit 1",
    "we find :    @xmath226    which is of the same form as equation [ fit_equation3 ] and shows that for @xmath227 a cosine around fidelity @xmath228 is obtained ; the error correction is effectively switched of .",
    "the process fidelity @xmath81 of the error correction process with the identity is :    @xmath229    in which the @xmath230 are given by equations [ fit_equation1 ] and [ fit_equation2 ] . for a single applied error",
    "this simplifies to :    @xmath231    in which @xmath232 and @xmath233 .",
    "note that all the different fidelities without error get grouped into two constants , one related to the average fidelity of the @xmath69 states and one related to the average fidelity of the @xmath70 and @xmath71 states without applied errors .       as in figure 4d of the main text .",
    "solid lines are a fit to the model including equation [ initialization_matrix ] .",
    "the dashed lines are the expected results for ideal initialization of the two nuclear ancillas ( @xmath234).,title=\"fig : \" ] +    the above model can be modified to explicitly take the effect of imperfect initialization / polarization of the ancilla qubits ( qubit 1 and 3 ) into account .",
    "the effect of the initialization fidelities @xmath235 and",
    "@xmath236 of the two ancilla qubits is that the measured values @xmath237 are now combinations of the @xmath238 values in table [ table:8 signals ] following :    @xmath239    this extended model separates the initialization imperfections from imperfections in the error correction process .",
    "we take @xmath240 as an estimate for the initialization fidelities ( fig .",
    "[ fig : nuclear_initialization ] ) .",
    "the resulting fits are shown in figure [ selected_errors_process_corrected ] ( solid lines ) and yield @xmath241 and @xmath242 .",
    "we calculate the expected result for ideal initialization by using the same value for @xmath243 but now setting @xmath234 ( dashed lines , fig .",
    "[ selected_errors_process_corrected ] ) .",
    "the imperfect initialization has two effects .",
    "first it strongly affects the success probability of the error correction as double errors ( one initialization error + one applied error ) can not be corrected .",
    "second , it lowers the overall maximum fidelity .",
    "this is a weak effect because it requires an error in the preparation of both ancillas at the same time and is therefore proportional to @xmath244 .",
    "input states @xmath245 and @xmath246 , for @xmath247 different combinations of errors and as a function of the error angle @xmath76 .",
    "we apply @xmath248 to each of the three qubits separately and a combination of @xmath248 to the electron and @xmath249 to nucleus 1 .",
    "lines are fits to equations [ fit_equation2]-[fit_equation4 ] . , title=\"fig : \" ] +      the process fidelity @xmath81 for simultaneous errors is given by :    @xmath250    with @xmath251 the error probability and @xmath252 the process fidelity for applied error @xmath219 , i.e. :    @xmath253    with @xmath254 as given in table [ table:8 signals ] we obtain :    @xmath255,\\ ] ]    the experiment is completely described by just 3 parameters : the offset @xmath84 ( due to the average @xmath69 fidelity without applied errors ) , the amplitude @xmath256 ( due to the average @xmath257 fidelity without applied errors ) and the average error correction probability @xmath258 .",
    "order polynomial fits to the data .",
    ", title=\"fig : \" ] +    the complete set of state fidelities used to derive the process fidelities for errors applied to one of the qubits at a time ( main text figure 4d ) is shown in figure [ selected_errors ] .",
    "the complete sets of state fidelities used to obtain the process fidelities for simultaneously applied errors ( fig .",
    "4e of the main text ) are given in figure [ 6_curves_encdec]a ( without error correction ) and figure [ 6_curves_encdec]b ( with error correction ) .",
    "in this section we analyze the different decoherence mechanisms in the three - qubit register .",
    "the electronic depolarization ( longitudinal relaxation or t1-type process ) due to phonon interactions plays an important role at these room temperature experiments . to measure the depolarization rates we prepare one of the three states @xmath45 , @xmath34 and @xmath168 and",
    "let the system relax for a time @xmath259 .",
    "we then apply a pi - pulse on the @xmath34 transition ( for the state starting in @xmath34 nothing is done ) before reading out the electron .",
    "the results are fit to a 3-level model that yields three rates between the different levels ( fig .",
    "[ fig : t1_3level ] ) .",
    "we find : @xmath260 s@xmath261 , @xmath262 s@xmath261 and @xmath263 s@xmath261 . in this three level system",
    "no unique `` @xmath19 '' value can be defined .",
    "nevertheless , a separate analysis of each of the curves gives @xmath264 times of @xmath265 ms ( @xmath45 ) , @xmath266 ms ( @xmath34 , which is often reported as the @xmath19 value ) and @xmath267 ms ( @xmath168 ) .",
    "we verified that the same rates were obtained with a 4 times lower laser output power , indicating that transitions induced by background illumination are negligible .",
    "the fits additionally use the measured fluorescence for @xmath45 and @xmath168 preparation . ]      to measure the electronic coherence time under dynamical decoupling @xmath31 the electron spin is prepared along @xmath16 .",
    "we then apply a decoupling sequence with @xmath268s and measure the spin projection along @xmath16 . the total time is varied by varying the number of pulses @xmath8 in the sequence .",
    "the result is shown in figure [ fig : dd_superposition ] .     and measure the final state along @xmath16 .",
    "the interpulse delay @xmath29 is @xmath269 , in the same range as used for the nuclear gates .",
    "purple : exponential fit to the data that gives @xmath12 .",
    "green : expected value due to electron depolarization alone . ]",
    "the green line marks the limit given by phonon - induced depolarization of the electron spin .",
    "it is given by the total decay rate out of the @xmath34 and @xmath45 levels : @xmath270 .",
    "the additional decoherence observed experimentally is consistent with previous reports @xcite and is likely due to phonon - induced dephasing , as much longer coherence times were reported at low temperatures @xcite .",
    "the expected signal without phonon - induced dephasing and depolarization is given by :    @xmath271    with the spin echo time @xmath272s .",
    "with @xmath273 this gives an estimated decay time of @xmath274 ms , indicating that decoupling from the spin bath is not the limiting factor .",
    "we measure the nuclear dephasing time @xmath275 by preparing the nuclear spin in a superposition and the electron spin in @xmath34 , and let the system evolve for variable time .",
    "the electron spin is then reset to @xmath34 before the nuclear spin is measured along an axis that creates an effective detuning of approximately 1 khz .",
    "we obtain @xmath276 ms for nuclear spin 1 and @xmath277 ms for nuclear spin 2 ( fig .",
    "[ fig : t2star ] ) .",
    "an electron free - precession ( ramsey - type ) measurement is performed during the experiments ( interleaved on a @xmath278 timescale ) , so that the electron and nuclear @xmath275 can be compared under the same magnetic field fluctuations .    . * ( a ) for nuclear spin 1 .",
    "@xmath276 ms , simultaneously measured electron @xmath279s .",
    "( b ) for nuclear spin 2 .",
    "@xmath277 ms , simultaneously measured electron @xmath280s .",
    "fits are sine functions with a decaying envelope @xmath281 .",
    "spin 1 : @xmath282 , spin 2 : @xmath283 . no readout correction . ]",
    "we expect the nuclear dephasing time to be set by a combination of electron relaxation and magnetic field fluctuations ( including the nuclear spin bath ) .",
    "electron relaxation gives a rate of @xmath284 s@xmath261 ( time constant of 8.2 ms ) . to estimate the intrinsic nuclear dephasing timescale @xmath285 we subtract the electron depolarization rate from the inverse of the measured dephasing time @xmath286 .",
    "we find @xmath287 ms for spin 1 and @xmath288 ms for spin 2 .",
    "the difference inthese values could originate from the differences in the nuclear spin s microscopic environments .",
    "we stabilize the magnetic field through a feedback loop by periodically measuring the energy splitting of the nv centre .",
    "this stabilization is required to counteract slow magnetic field drifts ( order of 0.1 g ) over the measurement time .",
    "figure [ fig : b - field_stabilization ] characterizes the magnetic field stability during the quantum - error - correction measurements with simultaneous errors ( taken over a total of @xmath289 hours , spread out over 1 month ) .",
    "these values are representative for the other measurements .",
    "khz ( @xmath26 ) are observed , corresponding to @xmath290 mg .",
    "( right ) the average measurement uncertainty in a single instance of the magnetic field measurement is @xmath291 khz ( @xmath137 mg ) . ]",
    "the measured residual slow fluctuations of the magnetic field ( @xmath292 khz , @xmath293 g ) are small compared to the fast fluctuations due to the @xmath1c bath ( @xmath294 khz , @xmath295 g ) .",
    "these slow fluctuations are expected to decrease the electron @xmath296 from the instantaneous value @xmath297s to @xmath298s ( and the nuclear @xmath299 with approximately the same factor ) .",
    "part of the fluctuations are caused by the uncertainty in the measurements of the electron splitting .",
    "figure [ fig : b - field_stabilization ] shows that this effect is small , because the measurement uncertainty of ( @xmath291 khz ) is small compared to the total drift observed ( @xmath292 khz ) .",
    "the nuclear spin coherence times can be extended by decoupling from the spin bath .",
    "figure [ fig : spin_echo ] shows the results of nuclear spin echo experiments .",
    "the required pi - pulse is constructed in the same way as all nuclear gates in this work .",
    "the electron is prepared in @xmath34 and re - initialized before the pi - pulse , which makes it possible to use a conditional gate , and re - initialized again to be used in the final measurement .",
    "we find @xmath300 ms ( nuclear spin 1 ) and @xmath301 ms ( nuclear spin 2 ) .",
    "( b ) for nuclear spin 2 : @xmath301 ms .",
    "single exponential fits . no readout or initialization correction . ]      being able to re - initialize the electron spin without depolarizing or dephasing the nuclear spins is essential for initializing the multiqubit register and for performing partial measurements within such registers .     under illumination .",
    "* ( a ) nuclear spin 1 , @xmath302 @xmath158s .",
    "( b ) nuclear spin 2 , @xmath303 ms .",
    "the laser power is the same as used in the initialization , re - initialization and readout steps .",
    "no readout or initialization correction . ]",
    "figure [ fig : t2star_laser ] shows a @xmath286 under illumination of @xmath304 @xmath158s for nuclear spin 1 and @xmath62 ms for nuclear spin 2 .",
    "these times are long compared to the time required to re - initialize the electron spin ( @xmath305s ) .",
    "for example , for nuclear spin 1 this predicts a contrast loss of approximately @xmath306 .",
    "figure [ fig : t1_nuclei ] shows nuclear relaxation measurements for the both spins , with and without laser illumination .",
    "the nuclear spin is prepared in @xmath35 and the electron spin in @xmath34 .",
    "we let the system relax for a variable time during which the laser is either on or off .",
    "for the experiment without laser illumination , the electron is reset by a short laser pulse ( @xmath307s ) so that it can be used to measure the nuclear spin state . without illumination , we find @xmath308 s and @xmath309 ms for spin 1 and 2 respectively . with illumination",
    ", we find @xmath310 ms and @xmath311 ms for spin 1 and 2 respectively .",
    "the nuclear depolarization during laser illumination is slow compared to the time it takes to re - initialize the electron spin ( @xmath305s ) , so that the electron can be re - initialized without depolarizing the nuclei .",
    "note that the final signal approaches a fidelity of @xmath312 ; prolonged laser light does not create a preferential polarization for these nuclear spins .",
    "the estimates for the final fidelities for the three - qubit quantum error correction protocol in the main text are obtained from the values above as follows .",
    "we take the electron decoherence time ( @xmath313 ms ) and the two nuclear spin intrinsic dephasing times ( @xmath287 ms and @xmath314 ) . as a rough estimate we approximate the three processes for the three qubits by rates and add them to obtain a final decay time @xmath315 ms .",
    "the typical fidelity for the @xmath68 ms quantum error correction protocol becomes @xmath316 .",
    "this corresponds to estimated process fidelity @xmath317 , similar to the observed value .",
    "the average gate fidelity for the 10 nuclear gates in the error correction protocol is estimated from @xmath318{2f_{est}-1 } + 1/2 = 0.94 $ ] .    99 van der sar , t. et al . ,",
    "nature * 484 * , 82 ( 2012 ) .",
    "bernien , h. et al .",
    "lett . * 108 * , 043604 ( 2012 ) .",
    "smeltzer , b. , mcintyre , j. , childress , l. , phys . rev . a 80 ( 5 ) , 050302 ( 2009 ) .",
    "jacques , v. et al .",
    "102 ( 5 ) , 057403 ( 2009 ) .",
    "taminiau , t.h .",
    "et al . , phys . rev .",
    "lett . * 109 * , 137602 ( 2012 ) .",
    "bar - gill , n. , pham , l.m . ,",
    "jarmola , a. , budker , d. , walsworth , r.l . , nat",
    ". commun . * 4 * , 1743 ( 2013 ) .",
    "bernien , h. et al . ,",
    "nature * 497 * , 7447 ( 2013 ) .",
    "aslam , n. , waldherr , g. , neumann , p. , jelezko , f. , wrachtrup , j. , new j. phys . * 15 * , 013064 ( 2013 ) .",
    "aslam , n. et al .",
    "* 107 * , 090401 ( 2011 ) .",
    "pfaff , w. et al .",
    ", nature phys .",
    "* 9 * , 29 ( 2013 ) ."
  ],
  "abstract_text": [
    "<S> quantum registers of nuclear spins coupled to electron spins of individual solid - state defects are a promising platform for quantum information processing [ 1 - 13 ] . </S>",
    "<S> pioneering experiments selected defects with favourably located nuclear spins having particularly strong hyperfine couplings [ 4 - 10 ] . for progress towards large - scale applications , larger and deterministically available nuclear registers are highly desirable . here </S>",
    "<S> we realize universal control over multi - qubit spin registers by harnessing abundant weakly coupled nuclear spins . </S>",
    "<S> we use the electron spin of a nitrogen - vacancy centre in diamond to selectively initialize , control and read out carbon-13 spins in the surrounding spin bath and construct high - fidelity single- and two - qubit gates . </S>",
    "<S> we exploit these new capabilities to implement a three - qubit quantum - error - correction protocol [ 14 - 17 ] and demonstrate the robustness of the encoded state against applied errors . </S>",
    "<S> these results transform weakly coupled nuclear spins from a source of decoherence into a reliable resource , paving the way towards extended quantum networks and surface - code quantum computing based on multi - qubit nodes [ 11,18,19 ] .    </S>",
    "<S> electron and nuclear spins associated with defects in solids provide natural hybrid quantum registers [ 3 - 11 ] . </S>",
    "<S> fully - controlled registers of multiple spins hold great promise as building blocks for quantum networks [ 18 ] and fault - tolerant quantum computing [ 19 ] . </S>",
    "<S> the defect electron spin enables initialization and readout of the register and coupling to other ( distant ) electron spins [ 11,18 ] , whereas the nuclear spins provide well - isolated qubits and memories with long coherence times [ 8,9,11 ] . </S>",
    "<S> previous experiments relied on selected defects having nuclear spins with strong hyperfine couplings that exceed the inverse of the electron spin dephasing time ( @xmath0 ) . with these strongly coupled spins , single - shot readout [ 9,10,20 - 22 ] and entanglement [ 9,11 ] were demonstrated . </S>",
    "<S> however , the number of strongly coupled spins varies per defect and is intrinsically limited , so that universal control has so far been restricted to two - qubit registers [ 4,7 ] and the required control of multi - qubit registers has remained an open challenge .    here we overcome this challenge by demonstrating universal control of weakly coupled nuclear spins ( unresolved hyperfine coupling @xmath0 ) . </S>",
    "<S> we use the electron spin of single nitrogen - vacancy ( nv ) centres in room - temperature diamond to selectively control multiple carbon-13 ( @xmath1c ) nuclear spins in the surrounding spin bath ( fig . </S>",
    "<S> 1a ) . </S>",
    "<S> with this new level of control we realize multi - qubit registers by constructing high - fidelity unconditional and electron - controlled gates , implementing initialization and readout , and creating nuclear - nuclear entangling gates through the electron spin . finally , we demonstrate the power of this approach by implementing the first quantum - error - correction protocol with individual solid - state spins .    ; </S>",
    "<S> @xmath2,@xmath3 ) and weakly coupled @xmath1c nuclear spins ( @xmath4 ; state @xmath5 and hyperfine interaction @xmath6 for nuclear spin @xmath7 , see methods for values ) . </S>",
    "<S> all gates on nuclear spins are implemented by sequences of @xmath8 pi - pulses on the electron spin spaced by a time @xmath9 ( methods ) . </S>",
    "<S> ( b ) the electronic coherence as a function of the total sequence length . </S>",
    "<S> the number of pi - pulses @xmath8 is increased for fixed @xmath10 , which is representative for our gates . </S>",
    "<S> @xmath11 khz is the @xmath1c larmor frequency . </S>",
    "<S> the 1/e time is @xmath12 ms . </S>",
    "<S> ( c ) nuclear spin initialization by swapping the electron state , @xmath13 or @xmath14 , onto the nuclear spin . </S>",
    "<S> the controlled gates ( @xmath15 ) are @xmath16-rotations by @xmath17 with a direction conditional on the electron spin state ( methods ) . </S>",
    "<S> the final electron spin re - initialization by a @xmath18s laser pulse ( labelled `` init . '' ) preserves the nuclear spin polarization ( @xmath19 values under illumination : @xmath20 ms for nuclear spin 1 and @xmath21 ms for nuclear spin 2 , supplementary information ) . </S>",
    "<S> ( d ) electron ramsey measurements without nuclear spin initialization and with nuclear spin 1 initialized in @xmath22 or @xmath23 , and ( e ) with nuclear spin 1 initialized in @xmath23 and nuclear spin 2 in @xmath24 or @xmath25 . all error bars and uncertainties in this work </S>",
    "<S> are @xmath26 . ]    </S>",
    "<S> we have used dynamical decoupling spectroscopy [ 23 - 25 ] to characterize the nuclear spin environment of a total of three nv centres , including one with an additional strongly coupled @xmath1c spin ( supplementary information ) . to demonstrate the universality of our approach to create multi - qubit registers , </S>",
    "<S> we have realized initialization , control and readout of three weakly coupled @xmath1c spins for each nv centre studied ( supplementary information ) . </S>",
    "<S> below we consider one of these nv centres in detail and use two of its weakly coupled @xmath1c spins to form a three - qubit register for quantum error correction ( fig . </S>",
    "<S> 1a ) .    </S>",
    "<S> our control method exploits the dependence of the nuclear spin quantization axis on the electron spin state due to the anisotropic hyperfine interaction ( see methods for hyperfine parameters ) , so that no radio - frequency driving of the nuclear spins is required [ 23 - 27 ] . </S>",
    "<S> all nuclear gates are implemented by pulse sequences of the form ( @xmath27 where @xmath28 is a microwave pi - pulse on the electron spin , @xmath9 is the inter - pulse delay and @xmath8 is the total number of pulses in the sequence . </S>",
    "<S> each nuclear spin is controlled by precisely choosing @xmath29 in resonance with that spin s particular hyperfine interaction . </S>",
    "<S> the target spin , the type of gate ( conditional or unconditional ) and the rotation axis ( @xmath16- or @xmath30-rotation ) are determined by the value of @xmath29 ; the total rotation angle is determined by @xmath8 ( methods ) . </S>",
    "<S> crucially , these sequences at the same time decouple the electron from the other nuclear qubits and the environment [ 7 ] ; these decoherence - protected gates are selective and allow the full electron coherence time @xmath31 to be exploited ( @xmath12 ms , fig . </S>",
    "<S> 1b ) . </S>",
    "<S> the gates are thus not limited by the electron spin dephasing time @xmath32s or hahn echo time @xmath33 and do not require strong coupling .    to initialize the nuclear spins we first prepare the electron spin in @xmath34 by optical pumping ( supplementary information ) , then swap the electron state onto the nuclear spin , and finally re - initialize the electron spin ( fig . </S>",
    "<S> 1c ) . </S>",
    "<S> we characterize the nuclear initialization by preparing the electron spin in a superposition state and letting it evolve in a ramsey - type experiment . without initialization a single - frequency oscillation with a gaussian decaying envelope </S>",
    "<S> is observed , confirming that the nv centre feels a decohering bath of weakly coupled spins ( fig . </S>",
    "<S> 1d ) . </S>",
    "<S> initializing one of the nuclear spins in the @xmath35 ( @xmath14 ) state ( fig . </S>",
    "<S> 1d and 1e ) , we increase ( decrease ) the oscillation frequency because the magnetic field at the electron is enhanced ( reduced ) due to the hyperfine interaction . </S>",
    "<S> the oscillations also persist longer as quasistatic fluctuations of the two nuclear spins are suppressed [ 28 ] , increasing the electronic dephasing time to @xmath36s . from this data , we obtain state initialization fidelities of @xmath37 and @xmath38 for nuclear spin 1 and 2 respectively ( see methods ) .    </S>",
    "<S> -rotation is implemented by an off - resonant sequence ( @xmath39 ) with a variable number of pulses @xmath8 . </S>",
    "<S> ( b ) nuclear spin state tomography is performed by mapping the @xmath40 , @xmath41 and @xmath42 expectation values onto the electron spin and reading out the electron ( shaded gates are optional basis rotations ) . </S>",
    "<S> ( c - d ) measurement of @xmath40 , @xmath41 and @xmath42 as function of the free - evolution time . </S>",
    "<S> the oscillations in @xmath40 and @xmath41 confirm the selective control and readout of the targeted nuclear spins . </S>",
    "<S> the amplitude yields a combined readout and initialization fidelity of @xmath43 for spin 1 in ( c ) and @xmath44 for spin 2 in ( d ) . </S>",
    "<S> curves are sinusoidal fits . </S>",
    "<S> see supplementary information for a complete data set with three nuclear spins for each of the three nv centres studied , demonstrating the universality of the control method . </S>",
    "<S> ( e ) characterization of the conditional gate for nuclear spin 1 . </S>",
    "<S> the nuclear spin rotates about @xmath16 with opposite directions for @xmath34 ( without shaded gates ) and @xmath45 ( with shaded gates ) . </S>",
    "<S> time for a @xmath46-rotation : @xmath47s . </S>",
    "<S> ( f ) unconditional gate for nucleus 1 ; the rotation is independent of the electron state . </S>",
    "<S> time for a @xmath17-rotation : @xmath48s . </S>",
    "<S> see supplementary information for gates on nuclear spin 2 . </S>",
    "<S> results are not corrected for initialization or readout fidelities . ]    </S>",
    "<S> next we demonstrate the measurement of the individual nuclear spin states and verify that we observe two distinct @xmath1c spins by performing nuclear free - evolution experiments ( fig . </S>",
    "<S> 2a - d ) . </S>",
    "<S> the oscillations in the expectation values @xmath40 and @xmath41 show that the nuclear spins states are successfully read out . </S>",
    "<S> the precession frequencies , @xmath49 khz for nuclear spin 1 ( fig . </S>",
    "<S> 2c ) and @xmath50 khz for nuclear spin 2 ( fig . </S>",
    "<S> 2d ) , are different and agree with the average of @xmath51 ( for @xmath34 ) and @xmath52 ( for @xmath45 ) , as expected because the electron spin is continuously flipped . </S>",
    "<S> @xmath53 is the parallel component of the hyperfine interaction ( methods ) and @xmath11 khz is the bare nuclear larmor frequency . </S>",
    "<S> these results confirm that we selectively address the two targeted @xmath1c spins .    </S>",
    "<S> universal control requires both conditional and unconditional gates , while maintaining a high degree of coherence for all qubits in the register . to characterize our gates </S>",
    "<S> , we initialize the nuclear spins , prepare the electron spin either in @xmath34 or in @xmath45 and apply a gate with a variable number of pulses . for the conditional gate </S>",
    "<S> , @xmath41 oscillates in anti - phase for the two electron states : the nuclear spin rotates around @xmath16 in a direction that depends on the initial electron state ( fig . </S>",
    "<S> 2e ) . </S>",
    "<S> in contrast , for the unconditional gate the rotation direction is independent of the electron state ( fig . </S>",
    "<S> 2f ) . </S>",
    "<S> the slow decay of the oscillations indicates that high gate fidelities are possible ( @xmath54 for a nuclear @xmath28/2-rotation ) , enabling us to explore multi - gate sequences that implement nuclear - nuclear gates and quantum error correction .     and two - qubit tomography is performed by mapping the @xmath55 combinations of pauli operators @xmath56 onto the electron spin ( supplementary information ) . </S>",
    "<S> after correction for single - qubit initialization and readout fidelities , the state fidelity with the target state is @xmath57 , indicating that the sequential initialization and two - qubit readout are accurate . </S>",
    "<S> ( b ) entangling gate between nuclear spins by coherently swapping the state of the electron onto nuclear spin 1 . </S>",
    "<S> the gate consists of @xmath58 electron operations over @xmath59s ( excluding initialization and tomography ) . </S>",
    "<S> the nuclear spin coherence is preserved during electron spin re - initialization ( a @xmath18s laser pulse ) ; @xmath60 values under illumination are @xmath61s and @xmath62 ms for nuclear spin 1 and 2 respectively ( supplementary information ) . </S>",
    "<S> the grey bars depict the target state . ]    </S>",
    "<S> to realize quantum gates between the nuclear spins [ 27,29 ] , whose mutual interaction is negligible , we use the electron spin as a quantum bus . </S>",
    "<S> we first verify that both nuclear spins can be prepared and read out in the same experiment by initializing the spins in an eigenstate and performing state tomography by mapping the two - qubit correlations onto the electron spin ( fig . </S>",
    "<S> 3a ) . </S>",
    "<S> we then implement entangling gates through an electron controlled gate on nuclear spin 2 and a subsequent coherent swap gate between the electron and nuclear spin 1 ( fig . </S>",
    "<S> 3b ) . </S>",
    "<S> the tomography reveals strong correlations between the nuclear spins with near - zero single - qubit expectation values , a clear signature of an entangling gate . </S>",
    "<S> the fidelity with the target state is @xmath63 ( initialization and readout corrected ) , demonstrating that the gate can take a pure input state into an entangled state of nuclear spins .    </S>",
    "<S> finally , we implement a quantum - error - correction protocol that protects a quantum state from bit - flip errors by encoding it in a @xmath64-qubit state and correcting errors through majority voting ( fig . </S>",
    "<S> 4a ) . </S>",
    "<S> such protocols have been realized with nuclear magnetic resonance [ 14,15 ] , trapped ions [ 16 ] and superconducting qubits [ 17 ] , but have so far been out of reach for individual solid - state spins due to a lack of multi - qubit control . </S>",
    "<S> we compose this protocol from one- and two - qubit gates ( fig . </S>",
    "<S> 4b ) and separately confirm that the constructed doubly - controlled gate flips the state around x only if the control qubits ( nuclear spins ) are in @xmath65 ( fig . </S>",
    "<S> 4c ) .     </S>",
    "<S> is encoded in an entangled state using two ancilla qubits . </S>",
    "<S> potential errors @xmath66 are detected by decoding and are corrected based on a doubly - controlled not gate . </S>",
    "<S> ( b ) our implementation of the quantum - error - correction protocol in ( a ) . </S>",
    "<S> the doubly - controlled gate ( blue ) is constructed using 4 controlled gates as the final ancilla states are irrelevant . </S>",
    "<S> the experiment consists of @xmath67 electron operations in @xmath68 ms ( excluding initialization ) . </S>",
    "<S> ( c ) characterization of the doubly - controlled gate ( blue gates in ( b ) only ) . </S>",
    "<S> the average output fidelities for @xmath69 , for @xmath70 and for @xmath71 are shown for the four ancilla basis states . </S>",
    "<S> the average process fidelity with the targeted action is @xmath72 . </S>",
    "<S> ( d ) process fidelity for errors applied to nucleus 1 , to nucleus 2 , or to the electron spin ( with and without additional flip of nuclear spin 1 ) . </S>",
    "<S> grey data and fit are @xmath73 which sets the average value for the expected oscillations if no errors are corrected . </S>",
    "<S> ( e ) process fidelity for errors simultaneously applied to all three qubits with error probability @xmath74 . </S>",
    "<S> purple : without error correction . </S>",
    "<S> blue : with error correction . </S>",
    "<S> grey : for ideal robustness against errors . </S>",
    "<S> error bars are given by the symbol size ( typical standard deviation @xmath75 ) . </S>",
    "<S> inset : deviation of the error correction data from a linear curve . </S>",
    "<S> all curves in ( d ) and ( e ) are fits to the model in the methods section . ]    </S>",
    "<S> we first characterize the effect of errors on each individual qubit . </S>",
    "<S> the applied errors are rotations around the x - axis by an angle @xmath76 with a random sign ( @xmath77 clockwise , @xmath77 anticlockwise ) and therefore represent a decoherence - type process with a strength determined by @xmath76 . </S>",
    "<S> we prepare @xmath78 input states @xmath79 and @xmath71 , measure the corresponding fidelities @xmath80 of the output states and calculate the process fidelity @xmath81 with the identity process :    @xmath82    without error correction , errors on the data qubit ( electron spin ) are expected to result in an oscillation about @xmath83 because only the @xmath69 states are unaffected by the applied errors . </S>",
    "<S> instead , the experimental process fidelity with error correction always remains above @xmath84 , even for a completely randomizing error ( @xmath85 ) , indicating that the state is partly recovered ( fig . </S>",
    "<S> 4d ) . </S>",
    "<S> if one of the ancilla qubits ( nuclear spins ) is also flipped , an oscillation about @xmath84 is observed ; the error correction is effectively turned off because the protocol can not correct two - qubit errors .    to quantitatively determine the effectiveness of the error correction we analyze it in terms of the three probabilities @xmath86 that an applied error on qubit @xmath87 is successfully corrected and a decoherence / depolarization process during the error - correction protocol itself ( methods ) . </S>",
    "<S> the model accurately fits the data and gives @xmath88 , @xmath89 and @xmath90 for errors on the electron , nucleus 1 and nucleus 2 respectively . </S>",
    "<S> crucially , the average probability @xmath91 is well above @xmath92 , demonstrating that the process is robust against applied single - qubit errors and that the entropy associated with the errors is successfully shuttled to the ancilla qubits .    </S>",
    "<S> we further demonstrate the robustness by applying errors simultaneously on all three qubits ( fig . </S>",
    "<S> 4e ) . without error correction , </S>",
    "<S> i.e. without doubly - controlled gate , a linear dependence is observed and a fit to the expected form gives @xmath93 in excellent agreement with @xmath94 expected for no robustness to errors . with error correction a markedly slower initial decay and a non - linear behaviour with @xmath95 </S>",
    "<S> is obtained . </S>",
    "<S> this suppression of the linear dependence is a key characteristic of quantum error correction .    </S>",
    "<S> the deviation from @xmath96 is mainly due to imperfect nuclear initialization , which might be improved by repeated initialization steps ( supplementary information ) or projective measurements [ 9,21 ] . </S>",
    "<S> we calculate @xmath97 for ideal initialization fidelity ( supplementary information ) . without applied errors , decoherence and depolarization during the protocol itself ( more than @xmath98 electron operations over @xmath68 ms ) result in a process fidelity of @xmath99 , corresponding to an average gate fidelity of @xmath100 for the @xmath101 nuclear spin gates . </S>",
    "<S> the main source of infidelity is electron decoherence ( @xmath102 ms , fig . </S>",
    "<S> 1b ) , which is likely phonon - induced [ 30 ] and limits the average gate fidelity to @xmath103 . </S>",
    "<S> nuclear spin dephasing further reduces the fidelity to @xmath104 , close to the observed value ( supplementary information ) . </S>",
    "<S> the electronic coherence time is greatly increased at cryogenic temperatures , at which @xmath105 ms ( single nv ) [ 18 ] and @xmath106 s ( ensembles ) [ 30 ] have already been reported . </S>",
    "<S> nuclear spin dephasing can be mitigated by decoupling nuclear - nuclear interactions ( @xmath33 measurements in supplementary information ) . with such future improvements , </S>",
    "<S> our results can be used to protect entangled states of solid - state spins .    in conclusion , we have established universal control over weakly coupled nuclear spins that were previously regarded as a source of decoherence . </S>",
    "<S> these results provide multiple qubits per defect with high certainty and are compatible with control of the intrinsic nitrogen spin and potential strongly coupled @xmath1c spins . </S>",
    "<S> our techniques can be applied to a wide variety of other electron - nuclear spin systems [ 2,3,10,13 ] . </S>",
    "<S> the resulting reliable multi - qubit registers can be combined with recently demonstrated coherent coupling between ( distant ) electron spins [ 11,18 ] to realize novel surface - code quantum - computation architectures that use four qubits per defect node [ 19 ] and extended quantum networks for long - distance quantum communication . </S>"
  ]
}