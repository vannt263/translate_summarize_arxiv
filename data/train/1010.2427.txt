{
  "article_text": [
    "we consider the wave equation @xmath9 in @xmath0 space dimensions and time . in",
    "spherical coordinates , the laplace operator @xmath10 in @xmath0 space dimensions can be split into radial and angular derivatives as @xmath11 the laplacian on @xmath12 has eigenfunctions @xmath13 that obey @xmath14 we can therefore make the separation of variables ansatz @xmath15 in 2 space dimensions , @xmath16 in 3 space dimensions , and @xmath17 in higher space dimensions , where the @xmath18 are the familiar scalar spherical harmonics , and @xmath13 their generalisation to higher dimension .",
    "the nonstandard notation for the fourier series in the @xmath19 case was chosen to give @xmath5 the range @xmath20 for all @xmath21 .",
    "@xmath19 is then a regular case in what follows .",
    "each @xmath22 now obeys @xmath23 here a dot denotes a @xmath24-derivative , and a prime an @xmath25-derivative .",
    "we no longer write the suffix @xmath26 , @xmath27 , or @xmath28 that labels the spherical harmonic .",
    "regularity of @xmath29 at @xmath7 , in the sense that it admits an expansion in positive integer powers of the cartesian coordinates @xmath30 , requires that @xmath31 , where @xmath32 is even and regular , in the sense that it admits an expansion in positive even powers of @xmath25 .",
    "@xmath33 is difficult to enforce numerically .",
    "this may lead to a loss of convergence or to instability , and it is preferable to evolve @xmath34 with @xmath35 where @xmath36 therefore @xmath37 is an even integer in an odd number ( in particular , three ) of space dimensions , and an odd integer in an even number of space dimensions . with the first - order auxiliary variables @xmath38",
    "this is equivalent to @xmath39 regularity implies @xmath40 if we formally extend the functions to negative values of @xmath25 .    in this paper",
    ", we use the summation by part ideas ( sbp ) of strand @xcite to construct finite differencing schemes of a given accuracy for ( [ myeqns ] ) , for positive integer @xmath37 , with the regularity conditions ( [ evenodd ] ) at @xmath7 , which admit a discrete energy whose time derivative is a boundary term at a spherical outer boundary @xmath8 .",
    "we then use the projection method of olsson @xcite to impose boundary conditions of one of the three forms @xmath41 ( maximally dissipative boundary conditions ) , @xmath42 or @xmath43 any of these guarantee that a discrete energy exists that is positive definite and non - increasing .",
    "hence the numerical scheme is stable .",
    "( a continuum energy exists and implies well - posedness also for the more general class of boundary conditions @xmath44 , but we have not been able to find an equivalent discrete energy . )",
    "we are aware of two other sbp schemes for ( [ myeqns ] ) in the literature .    the scheme proposed in @xcite and used in @xcite is sbp including at the outer boundary @xmath8 , and is second - order accurate at fixed @xmath25 .",
    "however , it has error terms that behave as @xmath45 . therefore , at a fixed grid point @xmath46 near the origin the error scales as @xmath47 , and is independent of @xmath48 .",
    "therefore , the error does not converge in the maximum norm , although for @xmath49 it converges with @xmath50 in the energy norm ( [ hatedef ] ) defined below @xcite .",
    "by contrast , the schemes we present here have an error of @xmath51 or @xmath52 at all grid points including the origin .",
    "a second - order accurate ( including at the origin ) finite differencing scheme for ( [ myeqns ] ) was described by evans @xcite and is widely used , see for example @xcite for @xmath53 and @xcite for @xmath54 .",
    "although this method was not explicitly designed as an sbp scheme , it actually is sbp at interior points and at the origin .",
    "this may explain its empirical robustness . here ,",
    "we complete it as an sbp scheme on the finite range @xmath55 by a suitable modification at the outer boundary .",
    "our paper is structured as follows .",
    "[ section : general ] discusses general considerations . in sec .",
    "[ section : discretisation ] we introduce our notation for the discretisation in @xmath25 . in sec .",
    "[ section : sb ] we identify the summation by parts ( sbp ) property that our difference operators must obey for a discrete energy to exist . in sec .",
    "[ section : accuracy ] we discuss the accuracy of these operators and in secs .  [ section : ghostpoints ] and [ section : used0 ] we discuss the symmetry boundary @xmath7 and physical outer boundary @xmath8 .    in sec .",
    "[ section : particular ] we construct specific sbp schemes . in sec .",
    "[ section : evans ] we review the evans method and make it sbp at the outer boundary .",
    "the evans method is simple , but we have not been able to generalise it directly to 4-th order accuracy .",
    "therefore , based on the general principles of sec .",
    "[ section : general ] , in sec .",
    "[ section:2nd ] we derive another 2nd - order accurate sbp method , and in sec .  [ section:4th ] we generalise this to 4th - order accuracy .",
    "it should be possible to construct implementations with arbitrary order of accuracy at interior points by extending our two examples .",
    "[ section : numerics ] confirms the expected accuracy and discrete energy conservation of the three methods in numerical experiments .",
    "[ section : conclusions ] summarises our results and comments on their significance .",
    "appendix  [ appendix : ghostpoints ] contains a rigorous discussion of ghost points at the origin , which are handled more informally in the main text . for completeness",
    ", appendix  [ appendix : olsson ] reviews olsson s projection method @xcite .",
    "appendix  [ appendix : bcderivslwave ] uses the energy method to show that a class of homogeneous boundary conditions that include first space derivatives ( or first time derivatives , modulo the evolution equations ) , is stable . in appendix",
    "[ appendix : numericalbc ] we use the projection method to construct a discretisation for the three subclasses of boundary conditions stated above .",
    "throughout this discussion we finite difference in @xmath25 only , but assume the continuum limit in time .",
    "a fully discrete scheme is obtained by using a suitable ode solver in @xmath24 ( the method of lines ) .",
    "we use grid functions @xmath56 and @xmath57 on a grid @xmath58 to represent the continuum functions @xmath59 and @xmath60 , assuming that @xmath61 and @xmath62 , and that @xmath59 and @xmath60 admit taylor expansions in @xmath25 to the required order at any @xmath25 . from now on , we use a matrix notation where grid functions are written as column vectors , and finite differencing operators as matrices .",
    "we also suppress the @xmath24-dependence as it is relevant only later when we add time discretisation using the method of lines , that is we write @xmath63 and @xmath64 , etc .    a @xmath65-point difference operator @xmath66 is defined by @xmath67 where @xmath68 is an offset .",
    "the parameters @xmath69 of the difference operator are simply the elements of the band - diagonal matrix @xmath66 .",
    "we assume a uniform grid with step size @xmath70 .",
    "our methods will require a grid that is either staggered about @xmath7 or centred about @xmath7 .",
    "in either case we find it convenient to introduce the notation @xmath71 that is , the grid index @xmath46 takes half - integer values for the staggered grid and integer values for the centred grid . in either case @xmath72 .",
    "the continuum equations admit the energy @xmath73 with time derivative @xmath74_0^r,\\ ] ] where the second equation is obtained after using the evolution equations and integrating by parts . in order to control the growth of @xmath75 , the boundary term at @xmath8",
    "must be controlled by a suitable boundary condition .",
    "the boundary condition @xmath76 clearly guarantees @xmath77 for @xmath78 .",
    "such boundary conditions are called maximally dissipative .",
    "we show in appendix  [ appendix : bcderivslwave ] that the more general boundary condition ( [ genbc ] ) also guarantees @xmath79 for a generalised energy @xmath80 .",
    "by contrast , the boundary at @xmath7 is not a physical boundary , but rather a point in the interior of the ball @xmath81 .",
    "indeed regularity alone implies that @xmath82 , and so the boundary term at @xmath7 vanishes .    as is well - known , the continuum equations are well - posed in the norm provided by @xmath75 because @xmath75 is conserved .",
    "a summation by parts ( sbp ) finite differencing scheme exactly conserves a discrete equivalent @xmath83 of the continuum energy @xmath75 .",
    "this guarantees that it is stable ( the discrete equivalent of well - posed ) .",
    "we consider the discrete energy @xmath84 where @xmath85 and write the finite differencing scheme as @xmath86 the powers of @xmath48 have been introduced so that @xmath87 , @xmath88 , @xmath89 , @xmath66 are all dimensionless and independent of @xmath48 .",
    "the quantity @xmath90 also has this property .",
    "the sbp property that guarantees that @xmath83 is constant up to boundary terms is @xmath91 where the boundary operator @xmath92 is defined by @xmath93 and the constant @xmath94 obeys @xmath95 in the continuum limit @xmath96 as @xmath97 at fixed @xmath8 . as @xmath87 is positive definite , it is invertible , and we can consider @xmath66 as determined by @xmath89 , @xmath87 , @xmath88 and @xmath92 : @xmath98      a useful reparameterisation of the difference operator coefficients @xmath99 is obtained by expressing @xmath100 through the taylor expansion of @xmath101 about the fixed grid point @xmath58 .",
    "we can then write @xmath102 with a straighforward linear relation between the @xmath103 and the @xmath69 at each point @xmath46 . in the following",
    "we adopt a simplified notation where the @xmath103 ( with @xmath104 ) are written as @xmath105 , @xmath106 simply as @xmath107 , etc . , and @xmath58 simply as @xmath25 .",
    "that is , we do not write the dependence on @xmath46 , and all continuum quantities are evaluated at @xmath108 .",
    "our difference operators are defined to be accurate to order @xmath109 if they obey ( using our abbreviated notation ) @xmath110    a key observation for our problem is that the @xmath111 error needs to be obtained formally in the limit @xmath97 , both at ( approximately ) constant @xmath25 , and at constant @xmath46 .",
    "the possible problem with the latter limit are error terms of the form @xmath112 , which are @xmath113 at constant @xmath25 , but only @xmath114 at constant @xmath46 . as an example",
    ", the identity @xmath115 suggests the finite differencing operator @xcite @xmath116 however , for @xmath117 and @xmath53 , the local error of the finite differencing operator @xmath118 is exactly @xmath119 .",
    "( for higher @xmath120 , terms up to @xmath121 also appear . )",
    "this does not go to zero with @xmath48 at fixed @xmath46 .",
    "we assume in the following that the operator @xmath122 is a standard representation of @xmath123 with known accuracy , and concentrate on the difference operator @xmath66 , where the @xmath124 term may cause accuracy problems at the origin .",
    "the point @xmath7 , which arises ( only ) on a centered grid , must be treated specially . taking the limit @xmath125 of ( [ psiaccuracy ] ) at finite @xmath48",
    "we see that at @xmath7 the accuracy conditions are @xmath126 with the even @xmath105 undetermined because @xmath127 for an odd function at the origin . for the methods with a centred grid that we have considered",
    ", these conditions will be discussed below for each specific method .",
    "turning now to generic points with @xmath128 , naively one would expect the accuracy requirement for @xmath66 to be equivalent to the following constraints on the coefficients of the difference operator ( as defined above ) : @xmath129 clearly , we need a stencil of width @xmath130 or larger to control all these @xmath105 .",
    "however , we shall now see that we can replace some of the equalities ( [ cequalities ] ) with inequalities , which gives us additional freedom to impose the sbp conditions . rather than devising a general notation , we present the cases @xmath131 and @xmath132 .    for @xmath131",
    ", we make the following ansatz : @xmath133 where the @xmath134 may depend on @xmath46 .",
    "the special case @xmath135 gives ( [ cequalities ] ) .",
    "substituting this ansatz into ( [ cdef ] ) gives @xmath136\\nonumber \\\\ & & + \\delta_1 h^2 \\left[r^{-1}\\psi''\\right]+r_2.\\end{aligned}\\ ] ] here @xmath137 where for a 3-point stencil @xmath138 , @xmath139 ,  are known linear functions of @xmath140 , @xmath141 and @xmath142 .",
    "now , because of ( [ evenodd ] ) and regularity , both square brackets in ( [ ansatz2 ] ) are actually @xmath143 as @xmath125 .",
    "therefore , as long as @xmath144 and @xmath145 are bounded uniformly in @xmath46 , the coefficients of @xmath50 in ( [ ansatz2 ] ) are bounded .",
    "similarly , as @xmath146 are regular functions of @xmath144 and @xmath145 , @xmath50 and all higher powers of @xmath48 in ( [ r2def ] ) are also explicitly regular at @xmath7 and so we have the desired second - order accuracy .    for @xmath132",
    "we make the ansatz @xmath147 which gives @xmath148\\nonumber \\nonumber \\\\ & & + \\delta_1 h^4 \\left[r^{-2}\\left({\\psi''\\over r}-\\psi'''\\right)\\right]\\nonumber \\\\ & & + \\delta_2 h^4 \\left[r^{-1}\\psi ' ' ' ' \\right]+r_4,\\end{aligned}\\ ] ] where @xmath149 in the sense discussed above .",
    "again , all the square brackets are regular at @xmath7 , and so we have fourth order accuracy if and only if the @xmath150 are bounded uniformly in @xmath46 .    the values of @xmath151 in the methods we construct below are plotted against @xmath46 and @xmath37 in figs .",
    "[ deltas_n=1 ] and  [ deltas_n=2 ] .",
    "it is clear that this method extends to arbitrary @xmath152 , giving @xmath152 equations to be solved and @xmath153 inequalities ( uniform in @xmath46 bounds on the @xmath150 ) to be then verified .",
    "informally , our method can be described as `` trading @xmath25 for @xmath48 '' .",
    "it works because the terms in square brackets above are all @xmath143 as @xmath125 , which in turn requires @xmath60 to be a regular odd function of @xmath25 .",
    "note that for @xmath154 , our @xmath105 given by ( [ n1first]-[n1last ] ) and ( [ n2first]-[n2last ] ) approach the values ( [ cequalities ] ) .",
    "similarly , @xmath155 and @xmath156 approach the values they take for the standard stencils @xmath89 given below in ( [ d2 ] ) and ( [ d4 ] ) , which are precisely the minimum width stencils for a given accuracy that obey ( [ cequalities ] )",
    ".      in numerical simulations using polar coordinates one is faced with the fact that @xmath7 is a boundary of the numerical grid , but is not in fact a boundary of the physical domain . as a result , there are ( typically ) no physical boundary conditions one can or must impose in the continuum limit , but the numerical simulation does require boundary conditions .",
    "these are derived from the assumption that the desired solution is not less differentiable at @xmath7 than for @xmath128 ( usually implicitly assumed smooth ) .",
    "the standard general approach to such `` symmetry boundary conditions '' or `` regularity conditions '' is to identify variables which under the assumption of regularity are either even functions of @xmath25 ( for example @xmath157 ) or odd functions of @xmath25 ( for example @xmath107 ) , and then to extend standard centered finite difference methods to the boundary by extending the numerical grid into a small number of `` ghost points '' representing negative @xmath25 and which are populated by the assumed even or odd parity of the grid functions .",
    "from a strict sbp point of view , there are no ghost points , and finite difference operators are necessarily skewed near the boundary . the fact that @xmath7 is not a physical boundary",
    "is represented by the fact that @xmath92 is zero at the boundary @xmath7 .    however , we find that the use of ghost points allows a clearer derivation of our results , in that we do not need to discuss @xmath7 explicitly as a boundary . rather than introduce a few ghostpoints , for our _ derivation",
    "_ we extend all grid objects from @xmath158 or @xmath159 to @xmath160 , corresponding to @xmath161 .",
    "we extend the grid functions to negative @xmath46 as @xmath162 because of how @xmath87 and @xmath88 define @xmath83 , we can assume without loss of generality that @xmath163 and similarly for @xmath88 .",
    "@xmath92 is extended by @xmath164 . in appendix",
    "[ appendix : ghostpoints ] we prove from these assumptions that ( [ discreteevenodd ] ) holds at all times if and only if @xmath165    when _ coding _ our method , we implement @xmath89 and @xmath66 with a few ghost points .",
    "equivalently , the ghost points can be explicitly eliminated .",
    "a rigorous treatment is relegated to appendix  [ appendix : ghostpoints ] , as it introduces additional notation not required for our main argument .",
    "we begin by reviewing the one - dimensional wave equation @xmath166 with energy @xmath167_a^b.\\ ] ] [ this corresponds to the case @xmath168 of ( [ myeqns ] ) ] .",
    "it is natural to discretize this symmetrically in @xmath157 and @xmath107 , that is @xmath169 with energy @xmath170 and sbp condition @xmath171 notice that this problem is translation - invariant , and so @xmath172 and @xmath173 will naturally be translation - invariant in the interior , except for finite - sized end blocks . @xmath172 and @xmath173 with various orders of accuracy in the interior and at the boundaries have been constructed by strand @xcite .    in ( [ myeqns ] ) with @xmath120 additional problems",
    "result because the equations are not translation - invariant but depend explicitly on @xmath25 . in the previous two sections we have addressed these problems at interior points and at the pseudo - boundary @xmath7 .",
    "intuitively , the problem of imposing sbp at the outer boundary @xmath8 should be similar to those solved by strand because with increasing resolution @xmath25 varies less over a finite number of near - boundary grid points , and we should be able to make use of strand s results .",
    "we now formalise this idea .",
    "strand provides , among others , norms @xmath173 that are the unit matrix except near the boundaries .",
    "we shall later construct norms @xmath174 and @xmath175 for the problem without an outer boundary ( on the range @xmath176 ) which are diagonal everywhere except near @xmath7 . in this subsection",
    "we denote their _ restrictions _ to @xmath177 by the same names .",
    "we now set @xmath178 where @xmath173 , @xmath172 and @xmath179 are the strand operators with diagonal @xmath173 on @xmath161 .",
    "then from ( [ sbpbis ] ) and ( [ sbp0 ] ) we obtain @xmath180 let us assume we have already shown that this is accurate to some given order at the interior points where @xmath172 takes a simple translation - invariant form .",
    "let us also assume that @xmath172 is accurate to some order @xmath181 at the boundary points , and let us assume that @xmath182,\\ ] ] near the boundary and similarly for @xmath175 . then near the boundary , at @xmath183 , for fixed @xmath184 , @xmath185 = d_0+{p\\over i}\\left[1+o(h^{-\\tau})\\right],\\ ] ] which is accurate to order @xmath181 .",
    "we concentrate at first on interior grid points by considering the range @xmath176 , furthermore , points near the boundary @xmath7 can be treated like interior points if we use ghost points , as discussed in sec",
    ".  [ section : ghostpoints ] .",
    "we use the notation @xmath186 etc . for operators on @xmath187 , and @xmath89 etc . for operators on @xmath55 .    the identity @xmath188 motivates the difference operator @xmath189 which is the generalisation to arbitrary even @xmath37 of a difference operator introduced in @xcite .",
    "it is second - order accurate including at @xmath7 . we combine it with the usual second - order accurate 3-point symmetric difference operator @xmath190 @xmath191 and @xmath64 for negative @xmath46 are defined by ( [ discreteevenodd ] ) .",
    "consider now @xmath192 the sbp formula ( [ sbpbis ] ) then gives @xmath193 comparing ( [ dtilde2 ] ) with ( [ evans1 ] ) we see that the evans method is of this form with ( using our convention @xmath194 ) @xmath195    we note that these are well defined for all @xmath46 including @xmath196 . indeed",
    ", the accuracy conditions at the origin ( [ cequalities_origin ] ) for a method with diagonal energy ( [ vwdef ] ) reduce to @xmath197 , which is easily seen to hold for the ansatz ( [ evansv],[evansw ] ) for even @xmath37 .",
    "note that the evans method does not work for odd @xmath37 ( the wave equation in even space dimensions ) on a staggered grid , as then @xmath198 .",
    "we now address the outer boundary . following the general prescription of sec .",
    "[ section : used0 ] we set @xmath199 note that this gives @xmath200 . from ( [ sbp ] )",
    "we read off @xmath201 we read off @xmath202h\\psi'\\nonumber \\\\ & & + \\left[1+o(m^{-1})\\right]{p\\over m}\\psi+o(h^2 )   \\nonumber \\\\ & = & h\\left[\\psi'+{p\\over r}\\psi+o(h)\\right],\\end{aligned}\\ ] ] where the last equality holds because @xmath203 , and hence this method is first - order accurate at the boundary point @xmath204 .",
    "the identity ( [ evansidentity ] ) suggests a generalization of the evans method to accuracy order @xmath109 , discretizing @xmath205 as @xmath206 where @xmath89 is some discretization of @xmath123 of accuracy order @xmath109 .",
    "if we take the norms @xmath207 then ( [ evansgeneralized ] ) also obeys the sbp property .",
    "however , for the minimal - width centered stencils @xmath89 of order larger than 2 this does not work . to see this we differentiate @xmath208 using the operators @xmath89 of accuracy @xmath131 and @xmath132 .",
    "the discretization errors are , respectively , @xmath209 in the latter case we see an error of the form @xmath210 , which becomes @xmath50 near the centre .",
    "we have not been able to generalize evan s method to avoid this type of singular error term .",
    "now we present a new , general approach to this problem , which allows high - order sbp methods that are regular at the centre .",
    "there are many ways of solving both the sbp conditions and the accuracy conditions for any required order of accuracy .",
    "we choose as our priority to make @xmath89 and @xmath66 as narrow as possible . for given @xmath89 , wider @xmath87 and @xmath88",
    "make @xmath66 [ given by ( [ sbpbis ] ) ] wider , so we try to make them as narrow as possible . finally , we choose @xmath87 to be diagonal in order to make it easy to invert .",
    "we note that an overall constant factor in @xmath87 ( and its inverse in @xmath88 ) cancels out from @xmath66 .",
    "given that @xmath122 represents @xmath123 , it is natural to make the _ extended _ finite difference operator @xmath186 the `` standard '' minimal width operator for a given order of accuracy @xmath109 at interior points .",
    "we concentrate at first on interior grid points .",
    "we assume again that @xmath186 is given by ( [ d2 ] ) , and we look for @xmath174 and @xmath175 of the form @xmath211 where @xmath212 . the sbp formula ( [ sbpbis ] )",
    "gives @xmath213 where @xmath214 for negative @xmath215 is defined by ( [ discreteevenodd ] ) .",
    "we can now read off @xmath140 , @xmath141 and @xmath142 in terms of @xmath216 .",
    "the one equality contained in ( [ n1first]-[n1last ] ) , namely @xmath217 gives the linear recurrence relation of degree 2 for @xmath216 @xmath218 the other two accuracy conditions are taken to define @xmath145 and @xmath219 in terms of @xmath216 . on a staggered grid , we have @xmath220 .",
    "we initially fix an arbitary value for @xmath221 , and can then solve the recursion for @xmath216 for all @xmath222 .",
    "( note that @xmath223 is unchanged if @xmath174 is multiplied a constant factor ) . on a centered grid , evaluating the accuracy conditions ( [ cequalities_origin ] ) with @xmath224 gives @xmath225 .",
    "we initially fix an arbitrary value of @xmath226 and can then solve the recursion for @xmath216 for all @xmath227 .",
    "we note in passing that the method @xcite is given at interior points by @xmath228 , which does not obey ( [ sbp2recurrence ] ) .    to work with a bounded quantity , we define the new variable @xmath229 as @xmath230 ( therefore @xmath231 for odd @xmath37 , while @xmath232 . )",
    "it obeys the linear recurrence relation @xmath233 trying asymptotic solutions of the form @xmath234 for constants @xmath235 and @xmath236 shows that the two linearly independent solutions have @xmath237 and are ( fixing a constant overall factor , and assuming @xmath238 ) @xmath239 the first one is asymptotically constant , and the second is an oscillating decaying solution . the general asymptotic solution is an arbitrary linear combination of those , and hence it is also asymptotically constant .",
    "[ the asymptotically constant mode ( [ sbp2mode+ ] ) for given @xmath37 is a finite polynomial in @xmath240 of ( the integer part of ) @xmath241 terms .",
    "for example , restricting to @xmath238 , for @xmath242 we have @xmath243 and for @xmath53 we have @xmath244 . ]",
    "from these results we can infer the asymptotic behaviour of the @xmath150 .",
    "if @xmath229 tends to a constant @xmath245 then we have @xmath246 only in the case that @xmath247 and only the oscillating mode is present is there a divergence in @xmath248 , namely @xmath249 however , with our initial data @xmath220 on the staggered grid or @xmath225 on the centred grid , the constant solution is present , and hence the sequence @xmath150 converges as @xmath250 , and is therefore bounded .",
    "furthermore , the upper bound of its absolute value is close to the asymptotic value , as we show in fig .",
    "[ deltas_n=1 ] .    finally , we adjust the arbitrary overall factor such that @xmath251 . on the centred grid",
    "we need @xmath252 for any value of @xmath37 .",
    "@xmath253 for @xmath238 is then actually given by the asymptotically constant polynomial ( [ sbp2mode+ ] ) .",
    "( for even @xmath37 , this is true for all @xmath46 , but not for @xmath196 with odd @xmath37 , where the special form of the accuracy condition at the centre needs to be used . )    on the staggered grid we need for even @xmath37 @xmath254 ^ 2}{p+1 } , \\ ] ] which also leads to the polynomials ( [ sbp2mode+ ] ) .",
    "however for odd @xmath37 the symmetry condition at the centre is incompatible with having only the asymptotically constant mode , and we need a contribution from the oscillating mode ( [ sbp2mode- ] ) . for @xmath255 we now need @xmath256 ^ 2}{p+1}.\\ ] ]          this works exactly as in sec .  [ section : evansouter ] , except that @xmath257 and @xmath258 only in the continuum limit .        for @xmath132",
    ", we have found a scheme where @xmath186 is the unique 4-th order accurate 5-point difference operator , @xmath259 and where @xmath174 is diagonal and @xmath175 is band - diagonal with three bands .",
    "we parameterize them as @xmath260 and all other components zero , where on the staggered grid the index on @xmath261 and @xmath262 takes half - integer values and the index on @xmath263 takes integer values , and the other way around on the centred grid .",
    "@xmath264 on the staggered grid and @xmath265 on the centred grid because we assumed in ( [ wsymmetry ] ) that the off - diagonal blocks of @xmath175 vanish .",
    "if we take temporarily @xmath266 as given , we can solve the accuracy conditions for the @xmath150 and @xmath216 , plus a linear recurrence relation of order 4 for @xmath267 . on the staggered grid ,",
    "we can fix @xmath268 and @xmath269 arbitrarily , and solve the recurrence relation for @xmath267 for @xmath270 starting from those four points and our choice of @xmath271 . on the centred grid , the accuracy conditions ( [ cequalities_origin ] ) at the origin reduce to @xmath272 and @xmath273 .",
    "we can fix @xmath274 and choose the the @xmath271 arbitrarily and then compute @xmath267 for @xmath275 from the recurrence relation .",
    "( note that @xmath276 and @xmath277 multiply @xmath278 , which vanishes , and hence do not participate in the recurrence . )    as we shall see , it is sufficient to set all @xmath279 except for @xmath280 on the staggered grid and @xmath281 and @xmath282 on the centered grid . in compact form , we can write @xmath283 where we have introduced the shorthand @xmath284 for the staggered grid and @xmath285 for the centred grid .    with the equivalent of ( [ wbar ] ) and ( [ asymptotic ] ) for @xmath267 , the fourth - order linear recurrence for @xmath286 has four independent asymptotic solutions with @xmath287 all with @xmath288 .",
    "the linearity of the recurrence implies that the general solution @xmath286 is a linear combination of the four corresponding modes @xmath289 .",
    "it is possible to show that if the linear combination contains any contribution of the growing or oscillating modes then the @xmath134 are not bounded .",
    "hence we must find a solution which only contains the asymptotically constant and the decaying modes .",
    "the freedom in @xmath280 , @xmath290 and @xmath291 on the staggered grid , and in @xmath281 , @xmath282 and @xmath274 on the centred grid allows us precisely to cancel simultaneously the growing mode and the oscillating non - decaying mode and fix an overall constant factor . to do",
    "that we proceed as follows .",
    "we first compute three arbitrary solutions of the recurrence up to some high value of @xmath46 , say 1000 .",
    "for example , on the staggered grid we can set each of @xmath280 , @xmath290 and @xmath291 to 1 and the other two to 0 .",
    "the three solutions are dominated by the growing mode , and reach very high values , of order @xmath292 .",
    "we have detected extreme sensitivy of the solution in the initial conditions , roughly losing one decimal digit of precision per iteration , and hence the recurrence is solved with exact rational arithmetics , using _",
    "then we compute the asymptotic form of the modes , up to order @xmath293 .",
    "for instance for the asymptotically constant mode we have @xmath294 ( for @xmath53 this is simply @xmath295 . ) however , in contrast to the @xmath131 case , these are only finite polynomials for odd @xmath37 , but not for even @xmath37 . for @xmath296 this expression will give results correct up to relative errors smaller than @xmath297 for @xmath298 .",
    "we take three such values of @xmath46 and construct a linear system to find which linear combination of our three solutions gives that mode @xmath299 . for such high values of @xmath46",
    "we can neglect the contribution of the decaying mode . in this way",
    "we determine the values of @xmath286 up to @xmath300 .",
    "for larger @xmath46 , and @xmath298 , the asymptotic series are accurate to 16 digits . in our experiments below we shall use up to @xmath301 , for wich values up to @xmath302 must be computed to use the given asymptotic expansions with relative errors below double precision . note that we do not know if these series are convergent .    from @xmath267 we can compute @xmath216 .",
    "this gives the following asymptotic behaviour for @xmath229 , @xmath303    for @xmath304 on the staggered grid and @xmath305 on the centred grid the @xmath306 can be computed from @xmath267 and @xmath216 as follows , @xmath307 the previous expansions imply that the @xmath306 are bounded and have finite limits : @xmath308 the limit value of @xmath144 is cubic in @xmath37 .",
    "that means that @xmath144 is very large for large values of @xmath37 . comparing with @xmath131",
    "it is plausible that @xmath144 has an asymptotic limit which grows like @xmath309 .",
    "we provide in our webpage @xcite data files with double - precision results for @xmath310 , @xmath311 and the @xmath306 for @xmath312 and @xmath313 . formulas ( [ asympvbar ] ) and ( [ asympwbar ] ) can be used to compute @xmath310 and @xmath311 for these @xmath37 and @xmath314 to 16 digits .",
    "we find that for @xmath242 and @xmath53 ( the wave equation in cylindrical and spherical symmetry ) , on the staggered grid , @xmath315 , so that @xmath88 is then not positive definite .",
    "this problem is absent for @xmath316 , or on the centred grid .",
    "it is possible that allowing for @xmath266 other than @xmath280 to be nonzero , this could be fixed , but we have not tried this .",
    "strand provides boundary operators with interior accuracy order @xmath109 ( @xmath317 in the notation of strand ) and different boundary accuracy orders @xmath181 , depending on the number @xmath25 of boundary points used and the form of the @xmath173 ( @xmath87 in the notation of strand ) operator .",
    "he finds that @xmath318 with @xmath25 ranging from @xmath319 for a general @xmath173 to @xmath320 for diagonal @xmath173 . in our case @xmath321 and we want to have diagonal @xmath173 , so there are two possibilities : @xmath322 and @xmath323 .    for @xmath324 , following the general prescription of sec .",
    "[ section : used0 ] , we set @xmath325 from ( [ sbp ] ) we read off @xmath326 this @xmath66 is fourth - order accurate in the interior , and first - order accurate at @xmath327 .    for @xmath328 , following the general prescription we set    @xmath329    @xmath330    the expressions for @xmath89 and @xmath87 are obtained by setting @xmath267 and @xmath216 to @xmath331 .",
    "we have tested our 2nd and 4th order accurate implementations as described above , combined with 4th - order runge - kutta discretisation in time , with a courant factor @xmath332 .",
    "in sbp4 we use the numerical coefficients @xmath69 , or equivalently @xmath280 , @xmath333 and @xmath253 , calculated by the relaxation method described above up to @xmath334 , and using the asymptotic results ( [ asympvbar ] ) , ( [ asympwbar ] ) for larger @xmath46 .",
    "initial data are set with @xmath157 a smooth function of compact support bounded away from @xmath7 and @xmath184 , and @xmath335 , so that at early times we can verify accuracy without the complication of boundary conditions .    to determine the accuracy of the method we have investigated self - convergence .",
    "this means that we check that @xmath336 as defined by @xmath337 ( the richardson expansion , here assuming 4th - order accuracy ) is approximately independent of @xmath48 .",
    "starting from a reference resolution , we refine twice ( by a factor of 2 on the centred grid , and a factor of 3 on the staggered grid ) .",
    "we can then obtain two independent estimates of @xmath338 ( or @xmath339 or @xmath340 if we are testing for third or second - order accuracy ) and we compare these . using refinement by a factor of 3 allows us to combine a staggered grid with fixed @xmath341 , and still have appropriate grid points of all refined grids align with the coarsest grid . keeping @xmath184",
    "exactly resolution - independent is necessary to compare different resolutions , while aligned grids avoid the need for high - order interpolation to the same values @xmath25 in comparing different resolutions .",
    "both @xmath157 and @xmath107 and their associated errors scale as @xmath342 to leading order , and we therefore plot @xmath343 and @xmath344 .",
    "this is sensible also because technically speaking we expect convergence to the continuum in the energy norm @xmath75 , rather than the usual @xmath345 norm , or in other words we expect convergence of @xmath343 and @xmath346 in the standard @xmath345 norm .",
    "we have tested evans , sbp2 , sbp41 and sbp42 , for @xmath347 , on the staggered and centred grids , with representative outer boundary conditions ( see below ) .",
    "we note two exceptions .",
    "the evans method does not exist on the centred grid for odd @xmath37 , because @xmath226 is then not defined .",
    "the energy of sbp4 is not positive definite on the staggered grid for @xmath348 , and so we would not expect it to be stable . however , we do not see signs of instability in our numerical experiments .    in all other cases , our numerics confirm theoretical expectations , as follows . at short times , before the solution has interacted with the boundary @xmath8 , we see convergence at precisely the expected order , that is second order for evans and sbp2 , and fourth order for sbp41 and sbp42 .",
    "as expected , the error @xmath336 is identical for sbp41 and sbp42 , because they are the same method except at the boundary .",
    "surprisingly , the error @xmath340 is almost identical also between evans and sbp2",
    ". this may be because they agree more and more with each other , and the naive method , with increasing @xmath46 .",
    "once the solution has interacted with the boundary , we still see precise second - order convergence for evans and sbp2 . for sbp41",
    "we see second - order convergence and for sbp42 we see third - order convergence .",
    "note that in each case this global accuracy is one order higher than the accuracy at the boundary .",
    "we do not know if this was to be expected , see sec .",
    "12.7 of @xcite . for sbp41 and sbp42",
    "after the wave has interacted with the boundary , the error is dominated by grid noise , and hence the strict richardson expansion is lost , but the _ envelope _ of @xmath339 or @xmath340 respectively is still approximately resolution - independent .",
    "we have also evaluated the discrete energy at every time step . with the boundary conditions @xmath349 and @xmath350 discussed in appendix  [ appendix : numericalbc ] we have @xmath351 . with the maximally dissipative boundary condition @xmath352 we have @xmath353 , and we have evolved the expected value of @xmath83 by discretising this in @xmath24 using 4th - order runge - kutta . in all these cases",
    "the discrepancy between the evaluated and predicted numerical energy is of relative size @xmath354 , essentially independent of the method ( evans , sbp2 , sbp41 or sbp42 ) and of @xmath48 , and increases linearly with @xmath24 . as expected , it is due only to accumulated roundoff error ( machine precision ) .",
    "the wave equations ( [ lwave ] ) , ( [ lwavebis ] ) or ( [ myeqns ] ) appear in many areas of mathematical physics . in a larger class of applications ,",
    "these evolution equations are modified by @xmath25-dependent coefficients ( for example in the wave equation on a curved spacetime ) , lower - order nonlinear terms ( for example a scalar field potential ) , or couplings through lower - order terms to other equations in a larger system ( for example stellar perturbation theory ) .",
    "our experience suggests that the key stability problems in such systems of equations arise already in the simple linear system considered here .",
    "prior to the results presented here , we are not aware of any completely stable finite differencing scheme for these equations .",
    "methods which appear to be stable at first fail to converge at sufficiently high resolution or large @xmath37 , with problems either at the origin @xmath7 or the outer boundary @xmath8 .",
    "it is surprising that the lower order term @xmath355 in ( [ myeqns ] ) alone can make standard schemes unstable , and that an elaborate sbp scheme is necessary .",
    "note however that a standard centered finite difference implementation of the one - dimensional wave equation is already sbp except possibly at the boundaries , while the equivalent naive finite differencing of ( [ myeqns ] ) for @xmath120 is not sbp even at interior points .",
    "it seems highly unlikely to us that any boundary conditions can be devised to make such a scheme stable .",
    "finally , the reader may be used to adding numerical dissipation to keep numerical methods stable .",
    "however , strictly linear equations such as the ones we consider here should not require explicit dissipation , which should be reserved for dealing with nonlinearities .",
    "moreover , in a naive finite differencing of our equations , the amount of dissipation required increases rapidly with @xmath37 , so that this is not a feasible approach if large @xmath37 are required .",
    "the answer is then two - fold : first , to make the numerical scheme sbp at interior points and second , to make it sbp also at the boundary and to use the olsson projection method to impose suitable boundary conditions . in hindsight , the evans method is already sbp at interior points , which explains why it works much better than a naive scheme",
    ". however , sbp at the outer boundary is also necessary to make it into a demonstrably stable scheme .",
    "this is not difficult to achieve , but without an explicit reference to discrete energy methods would not be at all obvious , especially as sbp methods appear to require a reduction in the order accuracy at boundary points @xcite .",
    "furthermore , the evans method does not have an obvious generalisation to higher order accuracy , and does not work for odd @xmath37 on a centred grid .",
    "as the main result of this paper , we have therefore constructed 2nd and 4th - order accurate sbp methods by using discrete energies that are non - diagonal near the origin . these can be made 1st and 2nd - order accurate , respectively , at the boundary @xmath8 , leading to global 2nd and 3rd - order accuracy after the solution has interacted with the boundary .",
    "( our sbp4 is not positive definite for @xmath348 on a staggered grid . )",
    "it is clear that our ansatz can be generalized to order @xmath109 in the interior and order @xmath152 at the boundary , giving rise to global accuracy of order @xmath153 .    in the appendix ,",
    "we have used the sbp property to construct discretisations of the boundary conditions ( [ maxdissbc]-[psibc ] ) that give rise to a strictly non - increasing discrete energy , and hence guarantee numerical stability .",
    "we would like to thank olivier sarbach for instructive conversations .",
    "jmm was supported by anr grant blan07 - 1_201699 `` lisa science '' , and also in part by micinn projects fis2009 - 11893 and fis2008 - 06078-c03 - 03 .",
    "cg would like to thank greco / iap and luth / observatoire de meudon for hospitality , and was partly supported by anr grant 06 - 2 - 134423 `` mathematical methods in general relativity '' .",
    "dg was supported by nsf grant phy-0855532 .",
    "consider @xmath356 for physical grid points @xmath238 . we can write the use of ghost points explicitly as @xmath357 where @xmath358 we think of this as `` folding over the ghost points '' .",
    "a similar observation holds for @xmath66 , except that as @xmath191 is odd , the equivalent of ( [ d+ ] ) is @xmath359 note that @xmath360 even for @xmath361 , thus requiring a separate symbol .",
    "( the symbol @xmath362 is a reminder of the range @xmath361 . )",
    "the split of @xmath363 into @xmath364 and @xmath365 for @xmath361 is in general not unique .",
    "we do , however , have a natural prescription for this split if we assume that @xmath364 is translation - invariant , i.e. depends only on @xmath366 even at the boundary .    in order to extend @xmath364 and @xmath69 to negative @xmath46",
    ", we use the requirement that ( [ discreteevenodd ] ) hold at all times , or @xmath367 the first equation of ( [ discreteevenodd ] ) and the second equation of ( [ discreteevenodddot ] ) immediately give , for @xmath361 , that @xmath368 the second equation of ( [ discreteevenodd ] ) and the first equation of ( [ discreteevenodddot ] ) , after substituting ( [ sbpbis ] ) and using ( [ wsymmetry ] ) , give , for @xmath361 , that @xmath369 and hence @xmath370 taking the sum and difference of ( [ tmp1 ] ) and ( [ tmp2 ] ) , we obtain ( [ dsymmetry ] ) .    finally , we have , for @xmath361 , that @xmath371 and so ( [ sbp ] ) holds for the operators @xmath362 and @xmath372 with ghost points folded in if and only if it holds for the extened operators @xmath89 and @xmath66 .",
    "this confirms that the introduction of ghost points is just a matter of notation .",
    "for completeness , this appendix summarises relevant methods from @xcite .",
    "suppose a first - order in space and time system of pdes in one spatial dimension has been discretised in space as @xmath373 note that the vector @xmath263 in general ranges over multiple variables ( for example @xmath157 and @xmath107 ) as well as grid points ( for example @xmath46 ) , and we use calligraphic letters such as @xmath374 for operators on this vector space .",
    "suppose this system has a discrete energy @xmath375 and obeys the sbp property that @xmath376 is a boundary operator .",
    "then @xmath377 is a boundary term .",
    "we want to impose one or several homogenous linear boundary conditions that we write as @xmath378 in matrix notation where @xmath263 is a column vector , @xmath379 is a matrix that has one row for each boundary condition .    to focus on the essential idea , we define the inner product @xmath380 in this notation we can write @xmath381 the adjoint with respect to this inner product is defined by @xmath382 and is therefore given by @xmath383    the operator @xmath384 clearly obeys @xmath385 and so is a self - adjoint projection operator into the space of grid functions that obey the boundary conditions .",
    "if we now use the semi - discrete evolution equation @xmath386 instead of ( [ simpleupdate ] ) , we have @xmath387 exactly , and hence @xmath388 and therefore @xmath389 at all times if it holds initially .",
    "then we have @xmath390 as before and so both the discrete energy bound and the desired boundary conditions hold .",
    "consider the class of boundary conditions of the form @xmath391 or equivalently @xmath392 for @xmath393 not all vanishing at once . to fix an overall sign",
    ", we also assume that at least one of them is positive .",
    "we now use an energy argument to show that these boundary conditions give rise to a stable initial - boundary value problem if @xmath394 with @xmath395 .",
    "[ the maximally dissipative special case @xmath396 with @xmath397 is also stable based on the energy @xmath75 defined in ( [ mye ] ) ] .",
    "we consider the energy @xmath398 where @xmath75 is given by ( [ mye ] ) , @xmath80 stands for @xmath75 modified by a boundary term , and @xmath399 is @xmath400 its time derivative is @xmath401_{r = r } \\nonumber \\\\ & = & r^p\\left[\\pi\\psi -{1\\over s}(\\mu\\psi+\\nu\\pi)\\left(\\rho\\pi+\\sigma\\psi\\right ) \\right]_{r = r } \\nonumber \\\\ & = & -{r^p\\over s}(\\mu\\sigma\\psi^2+\\nu\\rho\\pi^2)_{r = r},\\end{aligned}\\ ] ] the necessary and sufficient conditions for @xmath80 to be positive definite and its time derivative to be non - positive are @xmath402 we have @xmath403 if @xmath404 , and @xmath405 otherwise .",
    "however , the limiting case @xmath406 is not allowed because it would give @xmath407 , except for the maximally dissipative sub - case @xmath396 , where @xmath75 and @xmath408 are given by ( [ mye ] ) and ( [ myedot ] ) instead of ( [ eb ] ) and ( [ ebdot ] ) .",
    "we define the modified numerical energy @xmath409 where @xmath94 parameterises finite differencing error in the boundary term , as defined by ( [ bdef ] ) .",
    "we find @xmath410,\\end{aligned}\\ ] ] so if the numerical boundary could be chosen to be @xmath411 the argument could be completed as in the continuum case . however , @xmath412 and not @xmath413 .",
    "we have not been able to find an ansatz for @xmath414 and @xmath415 such that @xmath416 .",
    "consider however the two subclasses of boundary conditions where @xmath403 in the continuum .",
    "consider first the case @xmath417 with @xmath418 .",
    "then ( [ dhatebdt ] ) reduces to @xmath419 where the second equality holds because in this special case the boundary condition is independent of @xmath420 so that @xmath421 only acts on @xmath422 , and the last equality holds if we implement @xmath423 as @xmath424 the case @xmath425 with @xmath426 works the same way , with the roles of @xmath422 and @xmath420 interchanged ."
  ],
  "abstract_text": [
    "<S> splitting a solution of the wave equation in @xmath0 space dimensions into spherical harmonic components on @xmath1-spheres and reducing to first order results in the pair of first - order partial differential equations in radius and time @xmath2 and @xmath3 for each spherical harmonic , where @xmath4 , and @xmath5 is a spherical harmonic index . </S>",
    "<S> the @xmath6 term gives rise to numerical stability problems near the origin , and also poses the key numerical difficulty in related systems of equations . </S>",
    "<S> we propose a class of summation by parts finite differencing methods that converge pointwise , including at @xmath7 , and are stable because they admit a discrete energy . </S>",
    "<S> we explicitly construct such schemes that are 2nd and 4th order accurate at interior points , and first and 2nd order accurate at the spherical outer boundary @xmath8 . </S>",
    "<S> we use the projection method to impose a class of boundary conditions for which the discrete energy is non - increasing .    _ </S>",
    "<S> keywords : _ finite differencing , summation by parts , wave equation , spherical harmonics . </S>"
  ]
}