{
  "article_text": [
    "the most common type of functional data are curves , typically measured over time .",
    "also spectral data , measured over a range of wavelengths , can be considered as functional data and can be analyzed as such  @xcite .",
    "when several measurements are taken at each time point , we obtain multivariate functional data .",
    "bivariate examples are height and weight curves of children , temperature and dewpoint temperature at several weather stations during several days , or measurements of the human heart activity at two different places on the body @xcite .",
    "whereas the domain of these data is always univariate , the response can thus be multivariate .",
    "surface data are an increasingly common data type in several fields of research . in chemistry for example ,",
    "fluorescence spectroscopy is a well known technique that yields surface data with an excitation and an emission dimension . in geography ,",
    "surface data is obtained by measuring characteristics such as daily precipitation on a certain area of land . also digital image and video data",
    "are represented by a grid of pixels and typically contain grayscale values or three - dimensional rgb values that define the color intensities .",
    "all these advanced data types can thus be seen as multivariate functional data with a bivariate domain .    to detect outlying surfaces or to flag outlying parts of a surface ,",
    "it is well known that classical statistical techniques are not trustworthy as the analysis itself may be distorted by the outliers .",
    "outlier detection for multivariate functional data with a univariate domain has been studied in depth in @xcite . in that paper a taxonomy of outlying curves",
    "was proposed , and distribution - free statistical methods were introduced to measure their degree of outlyingness .",
    "@xcite illustrated this on a raw excitation - emission fluorescence dataset , and proposed the functional outlier map ( fom ) as a graphical display to visualize the functions according to their degree and type of outlyingness .    in this paper , we build on these methods with a threefold objective .",
    "first , we propose a cutoff to distinguish between the outlying and the regular surfaces , which makes the fom more informative .",
    "secondly , we improve the outlier detection ability for surface data by first modeling the data according to a multiway model and applying the fom to the residuals instead of the raw data .",
    "finally , we illustrate the extension of these techniques to multivariate image and video data .",
    "the next section introduces the methodology behind the fom as well as our new outlier detection rule . in section [ sec : surface ]",
    "we apply the new rule to excitation - emission matrices before and after fitting a parafac model to them .",
    "section  [ sec : image ] demonstrates the performance of our method on mri image data and introduces the idea of including gradients in the analysis . in section  [ sec : video ]",
    "we apply the methodology to a video consisting of 633 color images .",
    "the main concept for measuring the degree of outlyingness is the _ adjusted outlyingness _ ( ao ) of  @xcite .",
    "its construction is recalled in the appendix . for univariate data ,",
    "the ao is a robust version of the absolute @xmath0-score as it measures an observation s deviation from the median .",
    "it allows for skewness in the data by estimating scale separately on either side of the median . for multivariate data ,",
    "the ao of a point is defined as its maximal univariate ao when projecting the data on many directions .    to extend the ao to multivariate functional data , @xcite defined the _ functional adjusted outlyingness _ ( fao ) of a @xmath1-dimensional curve @xmath2 as the ( weighted ) average of its ao values over all points of its domain .",
    "more precisely , let @xmath3 be a sample of @xmath1-dimensional curves , recorded at time points @xmath4 .",
    "the fao of @xmath2 with respect to @xmath5 is then defined as @xmath6 where @xmath7 is a sample in @xmath1 dimensions and @xmath8 is a weight function for which @xmath9 .",
    "this weight function allows to assign a different importance to the outlyingness of a curve at different time points .",
    "one could for example downweight time points near the boundaries if measurements are recorded less precisely at the beginning and the end of the process .",
    "definition   for functional data with a univariate domain can easily be extended to functions with a bivariate domain such as surfaces and images .",
    "we then assume that the outcome of the experiment is recorded at a grid of discrete points , e.g.  discrete excitation and emission wavelengths .",
    "therefore , it is convenient to use two indices @xmath10 and @xmath11 , one for each dimension of the grid , to characterize these points . a surface or image",
    "can then be represented by a @xmath12 matrix where each cell @xmath13 contains the height of the surface or the color intensity at that grid point .",
    "we then define the functional adjusted outlyingness of a multivariate function @xmath2 with bivariate domain relative to a dataset @xmath5 of functions recorded at grid points @xmath14 as @xmath15 with @xmath16 . for illustrative purposes we will use a uniform weight function throughout this paper , i.e. @xmath17 for all @xmath10 and @xmath11 .",
    "definition   can trivially be extended to functions with a multivariate domain of dimension @xmath18 , such as three - dimensional images consisting of voxels .",
    "the fao can be applied to raw data , but in other applications it might be interesting to first fit a parametric model to the data , after which the fao can be computed on the residuals . for multiway data , parafac is a commonly used method to fit a trilinear model .",
    "the concept of applying fao to the residuals of a parafac model is illustrated on a real data example in section  [ sec : surface ] .    when analyzing curves , it is often informative to consider the derivative of the curves as well .",
    "in particular , this is helpful when the goal is to detect curves with a deviating shape , see @xcite for some examples . for surfaces or images",
    ", we can augment the available raw data by including gradients instead .",
    "this idea will be illustrated in section  [ sec : image ] .",
    "the functional outlier map ( fom ) was introduced in  @xcite as a graphical tool to visualize the degree of outlyingness of curves .",
    "a similar definition can be applied to surfaces or images .",
    "the fom is a scatter plot which displays each function s fao on the horizontal axis and vao , a measure of the variability of its ao over all points of the domain , on the vertical axis . more precisely , for each @xmath19 the vao is defined as @xmath20 so the fom is a scatter plot of the points @xmath21 for @xmath22 .",
    "we divide by fao in equation   in order to measure relative instead of absolute variability .",
    "this can be understood as follows .",
    "suppose that the functions are centered around zero and that @xmath23 for all @xmath24 and @xmath25 .",
    "then @xmath26 but their relative variability is the same . because @xmath27 , dividing by fao solves this problem",
    "the objective of the fom is to reveal outliers in the data , and its interpretation is fairly straightforward .",
    "we use the taxonomy of functional outliers presented by  @xcite to distinguish between different types of outliers .",
    "points in the lower left part of the fom represent regular surfaces which hold a central position in the dataset .",
    "points in the lower right part are surfaces with a high fao but a low variability of their ao values .",
    "this happens for shift outliers , i.e.  surfaces which have the same shape as the majority but are shifted on the whole domain .",
    "points in the upper left part have a low fao but a high vao .",
    "typical examples are isolated outliers , i.e.  surfaces which only display outlyingness over a small part of their domain .",
    "the points in the upper right part of the fom have both a high fao and a high vao .",
    "these correspond to surfaces which are strongly outlying on a substantial part of their domain .",
    "in this paper we add an additional feature to the fom , namely a rule to flag the outliers . for this purpose",
    "we define a summary measure , the _ combined functional outlyingness _ ( cfo ) of a surface @xmath19 as @xmath28 where @xmath29 , @xmath30 and similarly forvao .",
    "note that the cfo characterizes the points on the fom through their euclidean distance to the origin , after scaling .",
    "we expect outliers to have a large cfo . in general",
    ", the distribution of the cfo is unknown but skewed to the right . to define a cutoff",
    ", we first symmetrize the cfo by the logarithmic transformation .",
    "then we center and scale the resulting values in a robust way and compare them with a high quantile of the gaussian distribution .",
    "more precisely , let @xmath31 for all @xmath22 .",
    "then we flag function @xmath19 as an outlier if @xmath32 in the denominator , mad denotes the median absolute deviation defined as@xmath33 .",
    "in addition to the fom , it is often instructive to plot the ao values themselves over their domain . for a function with a bivariate domain ,",
    "this yields a two - dimensional heatmap .",
    "these plots can reveal particularly outlying regions and provide more insight into why certain surfaces are flagged as outliers by the fom .",
    "this will be illustrated in the following sections .",
    "the dorrit dataset contains excitation - emission landscapes of 27 mixtures of 4 fluorophores in an aqueous solution and has been studied extensively by @xcite , @xcite and @xcite .",
    "such landscapes are typically stored in excitation - emission matrices ( eem ) .",
    "these matrices contain measurements of fluorescence intensity for 116 emission spectra ranging from 250 to 482 nm at 18 excitation wavelengths ranging from 230 to 315 nm .",
    "this yields 27 samples @xmath19 , each containing measurements @xmath34 for @xmath35 and @xmath36 .",
    "raman and rayleigh scattering , showing up in figure  [ fig : l8](a ) as two diagonal ridges in landscape 8 , are a common problem in this type of experiment and can severely distort the analysis . to resolve this we used the method of @xcite which automatically identifies the scattering .",
    "after setting the scattering to missing values , we imputed them by interpolating each excitation profile .",
    "the result of this process is illustrated in figure  [ fig : l8](b ) .        using definition   with a uniform weight function ,",
    "we obtain the functional outlier map depicted in figure  [ fig : dorritfom ] .",
    "the dashed black line is determined by the cutoff value   and shows the boundary between the regular data and the outliers .",
    "the outliers , plotted as red squares , are landscapes 3 and 5 .",
    "we can improve our analysis by incorporating more information , for example by applying parallel factor analysis ( parafac ) to the data .",
    "parafac is known to be a powerful tool for analyzing multiway data and can in particular be used to decompose three - way eem data into a trilinear model .",
    "this trilinear model states that the value of a landscape @xmath19 at ee - point @xmath13 can be written as the product of three corresponding values of the score matrix @xmath37 and the loading matrices @xmath38 and @xmath39 , plus an error term : @xmath40 here @xmath41 denotes the number of components which we take as @xmath42 , corresponding to the 4 known fluorophores present in the mixtures . applying parafac to the data results in 27 residual landscapes @xmath43 . with the objective of outlier detection in mind ,",
    "it is important to use a robust parafac algorithm as it is well known that the presence of outliers can severely impact the parafac decomposition .",
    "we have used the robust parafac algorithm proposed by @xcite in which we set the robustness parameter @xmath44 .",
    "this parameter indicates that the parafac model is based on the @xmath45 of surfaces which yield the smallest residuals .    by computing the fao on the residuals instead of the original data , the trilinear structure of the dataset",
    "is taken into account .",
    "the resulting functional outlier map is shown in figure  [ fig : dorritfom_parafac ] and flags landscapes 2 , 3 and 5 .",
    "these outliers were also detected in  @xcite .",
    "note that points 3 and 5 lie much further from the boundary ( the dashed black curve ) than in the fom of figure  [ fig : dorritfom ] .",
    "this indicates that surfaces 3 and 5 have outlying values but mostly expose an outlying structure .",
    "landscape 2 barely contains abnormally low or high values but has large residuals with respect to the parafac model fitted to the majority of eem landscapes .",
    "a heatmap of the ao values over the domain allows us to inspect surface 2 in more detail .",
    "figure [ fig : aomap_dorrit](a ) plots the aos of the original landscape 2 , whereas figure [ fig : aomap_dorrit](b ) shows the aos of its parafac residuals . to improve visibility ,",
    "all ao values of 15 or higher received the darkest color .",
    "the left plot indicates that landscape 2 indeed does not have large outlying regions , as the vast majority of its cells are light - colored .",
    "however , the right plot shows that its residuals are significantly outlying in the emission spectra between 275 and 350 nm .",
    "this indicates that the shape of landscape 2 differs strongly from the shape predicted by the parafac model .",
    "therefore , this landscape can be classified as a shape outlier .",
    "the mri dataset contains brain imaging data of 416 persons , aged between 18 and 96 years  @xcite and can be freely accessed at _ www.oasis - brains.org_. for each person , multiple mri scans are available including 3 to 4 raw mri images and several processed scans such as an averaged image of the raw scans , the atlas - registered gain field - corrected image and a masked version of the latter scan resampled to 1 mm isotropic pixels . masking sets all non - brain pixels to an intensity value of zero .",
    "moreover these images are normalized , meaning that the size of the head is exactly the same in each image .",
    "the masked images have 176 by 208 pixels with grayscale values between 0 and 255 .",
    "all together we thus have 416 observed images @xmath19 containing univariate intensity values @xmath34 , where @xmath46 and @xmath47 .",
    "there is more information in the image than just the raw values .",
    "we can incorporate part of the shape information by computing the gradient in every pixel of the image .",
    "this gradient is composed of the derivatives in the horizontal and the vertical direction .",
    "more precisely , the gradient in pixel @xmath13 is defined as the 2-dimensional vector @xmath48 . in practice",
    "we do not have the exact derivatives of the image at the recorded pixels , so we have to rely on numerical approximations .",
    "we use forward and backward finite differences to approximate the derivatives in the pixels at the boundary of the brain . for the other pixels",
    ", we have used central differences . in the horizontal direction",
    "these are given by @xmath49 the derivatives in the vertical direction are computed analogously .    adding these derivatives to the data yields a multiway dataset of dimensions @xmath50 , so each @xmath34 is trivariate . for each person",
    "we thus have three data matrices which represent the original mri image and its derivatives in both directions .",
    "figure  [ fig : mridata ] represents these three matrices for person 144 .",
    "the functional adjusted outlyingness of an mri image @xmath19 relative to the sample @xmath5 is given by   : @xmath51 where @xmath52 is the adjusted outlyingness of the trivariate pixel @xmath13 .",
    "the resulting fom is presented in figure  [ fig : mrifom ] .",
    "this plot indicates the presence of 8 outliers of several types .",
    "image 126 has a remarkably high fao combined with a relatively low vao .",
    "this suggests a shift outlier , i.e.  a function whose values are all shifted relative to the majority of the data .",
    "images 29 and 92 have a large fao in combination with a high vao , indicating that they have strongly outlying subdomains .",
    "images 108 , 188 and 234 have an fao which is on the high end relative to the dataset but which by itself does not make them outlying . only in combination with their large vao",
    "are they flagged as outliers .",
    "images 69 and 211 have a cfo value just slightly above the cutoff , meaning they are borderline cases .",
    "a heatmap of the ao values can help to understand the root cause of an image s outlyingness . in figure",
    "[ fig : mrigrid ] we compare the mri images ( left ) and the ao maps ( right ) of persons 144 , 92 , and 126 .",
    "( ao values of 8 or higher received the darkest color . ) image 144 has the smallest cfo value , and as such can be thought of as the least outlying image in the dataset .",
    "as expected , the ao heatmap of image 144 shows very few outlying pixels . for person 92 , the ao heatmap nicely marks the region in which the mri image deviates most from the majority of the images .",
    "note that the boundaries of this region have the highest outlyingness .",
    "this is the result of including the derivatives in the analysis , as they emphasize the pixels at which the grayscale intensity changes .",
    "the ao heatmap of person 126 does not show any extremely outlying region but a rather high outlyingness over the whole domain , which explains its large fao and regular vao value .",
    "the actual mri image to its left is globally lighter than the others , which confirms that it is a shift outlier .",
    "this dataset consists of 633 images which together form a surveillance video of a beach , filmed with a static camera  @xcite .",
    "the data and the original video can be found at _ http://perception.i2r.a - star.edu.sg / bk_model / bk_index.html_. the video first shows a beach with a tree during 8 seconds , shown in the leftmost frame of figure  [ fig : videodata ] .",
    "then a man enters the screen from the left ( second frame ) , disappears behind the tree ( third frame ) , and then reappears again on the right side of the tree and stays on screen until the end of the video .",
    "the aim of applying our method to this dataset is to detect the man in this video .",
    "the images have @xmath53 pixels and are stored using the rgb ( red , green and blue ) color model , so each image corresponds to three matrices , each of dimensions @xmath53 .",
    "overall we have 633 images @xmath19 containing trivariate @xmath34 for @xmath54 and @xmath55 .        computing the fao according to   yields the fom in figure  [ fig : videofom ] .",
    "it is very instructive as the path of the man in the video can be traced in it .",
    "the first 480 images , which depict the beach and the tree and where only the water surface causes slight variations , are found on the bottom left side of the fom inside the dashed curve that separates the regular frames from the outliers . around frame 483",
    "the man enters and as a result the standard deviation of the adjusted outlyingness rises slightly .",
    "the fao itself increases more slowly as the fraction of the pixels covered by the man is still low .",
    "these frames can thus be classified as isolated outliers .",
    "their cfo barely exceeds the cutoff   so on the fom they are still close to the dashed line .",
    "frames 484487 have a very high fao and vao . in these images ,",
    "the man is clearly visible between the left border of the frame and the tree .",
    "consequently these images have outlying pixels in a substantial part of their domain .",
    "frames 488491 see the man disappear behind the tree . in these frames",
    "the fao goes down as the fraction of outlying pixels decreases . from frame 492",
    "onward the man reappears on the right side of the tree and stays in the screen until the end , as is reflected in the fom since these frames contain many outlying pixels .",
    "in addition to the fom we can construct ao heatmaps of individual frames . for frames 100 , 487 , 491 and 500 , figure  [ fig : videosum ] shows the raw image on the left , the ao heatmap in the middle and the fom on the right . on the fom",
    "we have drawn a blue circle around the relevant frame to indicate its location .",
    "this sequence of plots clearly shows that the proposed method works very well for this surveillance video data : not only can the man s path be followed on the fom , it is also clear from the ao heatmaps where exactly the man is in those frames .",
    "we have created a video in which the raw image , the ao heatmap and the fom evolve over time alongside each other .",
    "it can be downloaded from _ http://wis.kuleuven.be",
    "/ stat / robust / publ_.",
    "mh , jr and pr acknowledge the financial support of grants c16/15/068 andstrt/13/006 of the internal fund ku leuven .",
    "marcus , d. , wang , t. , parker , j. , csernansky , j. , morris , j. , and buckner , r. ( 2007 ) .",
    "pen access series of imaging studies ( oasis ) : cross - sectional mri data in young , middle aged , nondemented , and demented older adults .",
    ", 19:14981507 .",
    "the adjusted outlyingness of multivariate data has been introduced by  @xcite and was studied in detail by  @xcite .",
    "we first recall the adjusted outlyingness of a point @xmath56 relative to a univariate dataset @xmath57 .",
    "it can be seen as a robust version of the absolute @xmath0-score since it uses robust measures of location and scale ( instead of the usual mean and standard deviation ) .",
    "it also accounts for skewness by computing the scale on each side of the median separately .    as a robust measure of location",
    "we take the median of @xmath58 .",
    "the robust estimates of scale are based on the adjusted boxplot  @xcite .",
    "this modified boxplot is well - suited for skewed distributions .",
    "first , an interval called the fence is computed . for right - skewed data",
    "it is given by @xmath59\\ ] ] with @xmath60 and @xmath61 the first and third quartile of @xmath58 , @xmath62 and @xmath63 the medcouple , a robust measure of skewness @xcite .",
    "for left - skewed data a similar definition holds . note that for perfectly symmetric data the medcouple is zero , and then the fence is identical to that of the standard boxplot .",
    "the whiskers of the adjusted boxplot are lines from the box to the most remote data points inside the fence .",
    "figure  [ fig : adjbox ] shows the adjusted boxplot of a right - skewed dataset @xmath58 .",
    "the points @xmath64 and @xmath65 have the same distance @xmath66 to the median of @xmath58 , but @xmath64 lies outside the lower whisker @xmath67 whereas @xmath65 lies inside the upper whisker .",
    "the adjusted outlyingness of @xmath68 is now defined as @xmath69 with @xmath70 and @xmath71 . for @xmath72",
    "the ao is given by @xmath73 with @xmath74 and @xmath75 .",
    "in this example @xmath76 .",
    "+      ( 170,50 ) ( 5.00,20.00)(0,1)20.00 ( 5.00,30.00)(1,0)30.00 ( 35.00,20.00)(1,0)40.00 ( 35.00,20.00)(0,1)20.00 ( 35.00,40.00)(1,0)40.00 ( 75.00,20.00)(0,1)20.00 ( 75.00,30.00)(1,0)70.00 ( 145.00,20.00)(0,1)20.00 ( 50.00,20.00)(0,1)20.00 ( 0,30.00 ) ( 5,30.00 ) ( 100,30 ) ( 160,30.00 ) ( 145,30.00 ) ( 3.00,25.00)(0,0)[rr]@xmath64 ( 103.00,25.00)(0,0)[rr]@xmath65 ( 8.00,44.00)(0,0)[rr]@xmath67 ( 147.00,44.00)(0,0)[rr]@xmath77 ( 25.00,16.00)(0,0)[rr]@xmath78 ( 77.00,16.00)(0,0)[rr]@xmath79 ( 25.00,5.00)(0,0)[rr]@xmath80 ( 100.00,5.00)(0,0)[rr]@xmath81 ( 54.00,44.00)(0,0)[rr]@xmath82 ( 38.00,44.00)(0,0)[rr]@xmath83 ( 77.00,44.00)(0,0)[rr]@xmath84          to compute the ao of a @xmath1-dimensional point @xmath56 relative to an @xmath86 data matrix @xmath58 , the following projection pursuit procedure is applied .",
    "the point @xmath56 and all data points are projected on a direction @xmath87 , and we compute the univariate ao of the projected point @xmath88 relative to the projected dataset @xmath89 as in .",
    "this is repeated for many directions @xmath87 , and the multivariate ao is defined as the maximum over all corresponding univariate ao s : @xmath90 this definition is based on the principle that a multivariate point is outlying with respect to a dataset if it is outlying in at least one direction of the multivariate space .",
    "note that this outlying direction does not have to correspond to one of the coordinate axes .    to compute the multivariate ao we have to rely on approximate algorithms , as it is impossible to consider the projections on _ all _ directions @xmath87 in @xmath1-dimensional space .",
    "@xcite suggest using @xmath91 directions . a possible procedure to generate a direction",
    "is to randomly draw @xmath1 data points , compute the hyperplane passing through them , and then to take the direction orthogonal to it .",
    "this approach guarantees that the multivariate ao is affine invariant .",
    "this means that the ao does not change when we add a constant vector to the data , or multiply the data by a nonsingular @xmath92 matrix ."
  ],
  "abstract_text": [
    "<S> surface , image and video data can be considered as functional data with a bivariate domain . to detect outlying surfaces or images , </S>",
    "<S> a new method is proposed based on the mean and the variability of the degree of outlyingness at each grid point . </S>",
    "<S> a rule is constructed to flag the outliers in the resulting functional outlier map . </S>",
    "<S> heatmaps of their outlyingness indicate the regions which are most deviating from the regular surfaces . the method is applied to fluorescence excitation - emission spectra after fitting a parafac model , to mri image data which are augmented with their gradients , and to video surveillance data .    </S>",
    "<S> * keywords : * adjusted outlyingness , functional data , image data , multiway , robustness . </S>"
  ]
}