{
  "article_text": [
    "strongly correlated materials exhibit a wide range of exotic physical phenomena , ranging from magnetism to superconductivity  @xcite .",
    "this rich physics is interesting for the scientific community since it has a high potential for future technological applications . in the last decades several theories have been developed to describe the electronic structure of strongly correlated materials with a good accuracy ,",
    "e.g. the combination of density - functional theory ( dft ) and dynamical mean - field theory ( dmft )  @xcite .",
    "practical calculations for systems at finite temperature are usually performed using the green s function formalism for complex energies  @xcite . in this approach",
    "determining physical observables requires an analytical continuation from complex energies ( matsubara frequencies ) to real energies , as depicted in fig .",
    "[ figtikz ] .    .",
    "the values @xmath0 at the matsubara frequencies @xmath1 are used to reconstruct the function @xmath2 just above the axis of real energies . ]",
    "traditionally , the analytical continuation of one - particle green s functions has received the most attention , since it is related to the one - particle spectral function .",
    "the latter is not only of fundamental importance , but can also be probed ( more or less ) directly via various types of photoemission experiments . over the last few years however , dynamical _ two - particle _ quantities became more and more important  @xcite .",
    "significant examples include the electron energy loss spectrum ( eels )  @xcite and dynamical susceptibilities  @xcite .",
    "physically , the two - particle spectrum contains several interesting features , such as low - energy dispersive goldstone modes , landau damping of collective modes and sharp transitions between isolated energy levels . even in a weakly interacting fermi liquid",
    ", the two - particle spectrum presents some of these interesting features  @xcite . from a more technical point of view",
    ", two - particle quantities also play an important role in the treatment of nonlocal interaction in dmft - based approaches such as extended dmft ( edmft )  @xcite and its extension dual boson  @xcite , by describing the feedback of collective excitations on the one - particle spectrum .    similarly to the one - particle green s function",
    ", two - particle quantities are usually obtained on the matsubara axis .",
    "some physical information , such as the occurrence of charge - order transitions  @xcite , can be obtained directly from computational data on the matsubara axis at zero - frequency .",
    "however , the full dynamical susceptibilities , as well as related observables such as the eels and the plasmon spectrum , require an analytical continuation to real energies .",
    "it is easy to understand why finding a reliable method for the analytical continuation of two - particle functions has evolved from a niche problem to a necessity in computational many - body physics .",
    "the usual methods of analytical continuation of fermionic functions can , after some manipulation , also be used for bosonic functions  @xcite .",
    "it was previously shown that the maximum entropy method ( mem ) is able to perform the analytical continuation of the optical conductivity with a good accuracy  @xcite .",
    "more recently , in the context of edmft , huang _ et al .",
    "_  @xcite focused on the retarted interaction , emphasizing that a modified version of mem  @xcite leads to a good analytical continuation .",
    "while these studies provide a very interesting and useful analysis , they do not cover the applicability of various methods to functions of different shapes and characters .",
    "so far , a more complete study of the analytical continuation problem for bosonic functions is lacking . in this work",
    "we intend to provide such an analysis , by considering five different methods of analytical continuation in three physically relevant scenarios .",
    "in addition to the mem  @xcite , we will also test the non - negative least - square ( nnls ) method  @xcite , the non - negative tikhonov ( nnt ) method  @xcite , the pad approximant ( pad ) method  @xcite , and mishchenko s stochastic sampling method  @xcite .",
    "furthermore , we will investigate the effect of numerical noise on the quality of the continuation , in connection to the usage of quantum monte carlo techniques ( see e.g. ref .  ) .",
    "this article is structured as follows ; in sec .",
    "[ sec : greensfunction ] we review bosonic green s functions and their analytical and symmetry properties . in sec .",
    "[ sec : algorithms ] a brief introduction to the various continuation schemes is given .",
    "then , in sec .  [ sec : testapproach ] , we describe the different testing cases and highlight the reasons why they are interesting . in sec .",
    "[ sec : testresults ] , we show and analyze the results of the tests . finally in sec .",
    "[ sec : testconclusions ] we present the conclusions of our study , including a comparative summary of the performance of the continuation methods investigated .",
    "the analytical continuation consists in obtaining a function @xmath3 in the whole complex plane from a finite set of values .",
    "the focus in this work is on functions with bosonic symmetry that are known on a finite number of bosonic matsubara frequencies @xmath4 , where @xmath5 is the temperature and @xmath6 is an integer number . from this partial knowledge , we intend to extract the values of the function in the entire complex plane , and especially just above the real axis , for @xmath7 .    the analytical continuation problem can be formulated in terms of the spectral function @xmath8 by means of the hilbert transform @xmath9 for bosonic functions , the spectral function is an odd function , i.e. @xmath10 , which allows us to simplify eq .",
    "to @xmath11 from this equation we find that for large matsubara frequencies @xmath0 is asymptotically proportional to @xmath12 . without the odd symmetry of @xmath13",
    ", one would obtain an asymptotic behavior as @xmath14 , like for the one - particle green s function .",
    "furthermore , @xmath0 is purely real and @xmath15 .",
    "it follows from the analytical properties of @xmath3 that @xmath16 decreases monotonously as a function of @xmath1   @xcite .",
    "the correct symmetry can be enforced in the analytical continuation procedure either explicitly by using eq .   or implicitly by including both positive and negative matsubara frequencies as input points .",
    "this issue is studied in more detail in app .",
    "[ sec : impose_mirrorsym ] .",
    "the analytical continuations are performed by means of five different methods .",
    "we use our own , in - house implementations for all algorithms except for mishchenko s method . for mishchenko",
    "s method we use an mpi - parallelized version of the original code presented in ref .  . here",
    ", a brief introduction to these algorithms is given .",
    "discretizing the integral in eq .  [ hilbert4bosons ]",
    "makes it possible to reformulate the problem as a system of linear equations @xmath17 where @xmath18 is a quadrature weight and @xmath19 is the matrix to invert .",
    "however , this approach would not work in practice , since obtaining @xmath8 , once @xmath0 is given , is an ill - posed problem .",
    "the nnls method solves eq .   in a least - square sense and",
    "stabilises the solution by enforcing the known symmetry property @xmath20 .",
    "this means finding a non - negative solution to a least - square problem : @xmath21 here , @xmath22 and @xmath23 are vectors containing the values @xmath0 and @xmath24 on the discrete points of equation .",
    "the nnls problem can be solved iteratively as described extensively in ref .  .",
    "for ill - posed problems , regularisations are commonly used .",
    "one of the most famous regularisation methods is the tikhonov method  @xcite . applying the tikhonov method to the problem of analytical continuation",
    "defines the nnt method as @xmath25 where @xmath26 is a weight parameter that can be determined by the l - curve method  @xcite which selects @xmath26 corresponding to the smallest value of @xmath27 . here",
    "@xmath28 denotes the solution of eq .",
    "[ eq : nnt ] for a fixed @xmath26 .",
    "another famous regularisation method is the maximum entropy method ( mem )  @xcite .",
    "this method maximises the neumann entropy for the spectral function .",
    "formulated as a minimisation problem , the equations become : @xmath29 \\right \\| \\ : , \\ ] ] where the entropy @xmath30=&\\int de \\rho(e ) \\ln \\left(\\frac{\\rho(e ) } { m(e)}\\right )   \\notag \\\\ \\approx &   \\sum_j f_j \\rho_j \\ln \\left(\\frac{\\rho_j}{m_j } \\right ) \\ : \\end{aligned}\\ ] ] contains a default model @xmath31 , which can incorporate a priori knowledge about the spectral function .",
    "the pad approximant method  @xcite is based on a fitting procedure .",
    "this method starts with a rational polynomial ansatz for @xmath3 with unknown coefficients , and fits this ansatz to the known values at the matsubara axis @xmath0 . in this way one can reconstruct the function in the entire complex plane .",
    "the pad method can be formulated as a matrix problem  @xcite , which improves its numerical accuracy . as recently proposed  @xcite , one can enhance the stability of the continuations ( especially in presence of matsubara noise ) by taking an average of several pad approximants , obtained by varying the number of pad coefficients and matsubara points in the fitting procedure .      finally , we consider the stochastic sampling method proposed by mishchenko _",
    "et al . _",
    "@xcite . in this method",
    "the spectral function is approximated by a set @xmath32 of rectangles @xmath33 , i.e. : @xmath34 the rectangles @xmath33 are defined by their height @xmath35 , width @xmath36 and center position @xmath37 .",
    "a stochastic algorithm updates the rectangles randomly and accepts the changes according to a metropolis algorithm based on the difference between the known function @xmath16 and the corresponding function obtained from @xmath38 . combining this update scheme with a deterministic minimization of the matsubara difference",
    "further improves the performance of the method .",
    "an average over different independent monte carlo chains is taken to minimize the influence of noise . since the algorithm uses a condition for the sum of the rectangle weights , we scale @xmath13 by introducing @xmath39 . instead of finding @xmath13 by solving eq .",
    "[ hilbert4bosons ] , we calculate @xmath40 , which has to obey @xmath41 for @xmath42 we have the desired normalization condition @xmath43 . once @xmath40 is found we scale back to obtain @xmath13 .",
    "this rescaling can in principle be used for the other methods as well , with the exception of pad where the continuation is not done by solving eq .",
    "[ hilbert4bosons ] .",
    "to investigate the quality of the analytical continuation provided by the different methods we focus on test functions that are known in the entire complex plane , including the real energy axis .",
    "the functions are first evaluated at the matsubara energies and then analytically continued to the real axis . in an ideal situation ,",
    "the solution obtained by analytical continuation coincide with the original exact values .",
    "however , in practice , some differences arise due to the limited precision and amount of input data .",
    "the continuation becomes more difficult when we add numerical noise to the matsubara data , which models what happens in real calculations as by , e.g. , monte carlo methods .",
    "there , the noise typically scales inversely with the square root of the computational time . as a practical example , the numerical noise in dual boson calculations  @xcite is often in the 0.1% range .",
    "the numerical noise is modelled by adding relative gaussian noise to each matsubara point , @xmath44 , where @xmath45 is sampled from a gaussian distribution with zero mean and a standard deviation @xmath46 .",
    "we use the same @xmath46 for all frequencies . in realistic monte carlo simulations ,",
    "the noise level will usually depend on the matsubara frequency @xmath1 in a complicated way .",
    "it is important to individuate test functions that are realistic and cover bosonic functions of different character as one would encounter in practice .",
    "naturally , the exact real energy solutions of many of the most interesting systems are not known , so we need to find realistic but tractable cases . here , we consider three scenarios : ( i ) a two - pole model , ( ii ) the momentum resolved random phase approximation ( rpa ) solution of the 2d doped non - interacting hubbard model and ( iii ) that of a band insulator ( with two identical bands separated by a gap ) . these three functions , which are explicitly described in sec .",
    "[ sec : testresults ] , cover sharp features , a sharp low - energy zero sound mode ( that gets broadened by landau damping at larger momenta ) , high frequency modes , features far away from zero energy and a combination of sharp features with a broad base .",
    "all these functions are evaluated for matsubara frequencies corresponding to an inverse temperature @xmath47 and at a distance above the real axis @xmath48 .",
    "for all methods we used 100 matsubara frequencies , except for pad where a spectral average is done by varying the number of matsubara points between 50 to 100 in steps of 4 .",
    "it is important to use a sufficiently large number of matsubara frequencies .",
    "we study the dependence of the quality of the continuation on the number of matsubara frequencies in sec .",
    "[ sec : two - polemod ] .",
    "we also investigate the effect of including a few negative frequencies in appendix  [ sec : impose_mirrorsym ] .",
    "in this section we present a comparison between the different methods of analytical continuation when applied to three selected test functions .",
    "the first function we address is a simple model function whose analytical structure is @xmath49 where the parameters have the following values @xmath50 , @xmath51 , @xmath52 and @xmath53 . for @xmath54 ,",
    "the exact spectrum has two distinct peaks at energies @xmath55 and @xmath56 .",
    "therefore this function has similarities to the gaussian two - peak structure used in ref .  .",
    "to understand how the position of the high energy peak influences the quality of the attained spectra , we also perform tests with parameters @xmath57 and @xmath58 .",
    "this choice preserves the height of both peaks in the two chosen setups .",
    "the two spectra , corresponding to @xmath57 and @xmath53 , present different degrees of difficulty . for @xmath57 ,",
    "the two peaks in the spectrum are close to each other and therefore it is difficult to resolve them as two separate peaks . for @xmath53 , on the other hand , the second peak is far away from the first peak , but also far away from zero energy ( the complex @xmath1-axis ) .",
    "this makes it difficult to resolve the distant peak .    in fig .",
    "[ fig:2pole : spectra ] the two exact spectra are reported , and compared to the analytical continuation obtained through the five methods for three different noise levels .",
    "it is known that the pad method is much more sensitive to the precision of the input data than the other methods .",
    "the various noise levels are therefore chosen to illustrate the critical input precision where the pad method starts to fail .",
    "these noise levels are realistic for monte carlo simulations  @xcite .    as the top panels of fig .",
    "[ fig:2pole : spectra ] show , for relatively low noise ( @xmath59 ) , all methods capture the two peaks and their positions correctly , for both sets of parameters .",
    "the pad method performs the best , if we also consider the height of the peaks .",
    "conversely , the mem has the most difficulties to resolve the distant peak at @xmath53 .",
    "this picture changes drastically for intermediate noise levels ( @xmath60 ) , shown in the middle panels of fig .",
    "[ fig:2pole : spectra ] . for @xmath57 (",
    "left panel ) , the pad method is not able to reproduce the two peaks , and finds only the one at low energy .",
    "the other methods also gain spectral weight in between the peaks , but are still able to resolve both peaks . for @xmath53 ( right panel ) , results are significantly better for all methods .",
    "interestingly , the mem performs worse than the pad method . in situations",
    "where the input data is characterized by high noise ( @xmath61 ) , depicted in the bottom panels of fig .",
    "[ fig:2pole : spectra ] , both the mem and the pad method fail to find distinct peaks and merge them into one single broad peak .",
    "the other methods find distinct peaks , but locate them at the wrong energies , which is especially evident for @xmath57 ( left panel ) . in any case , these methods are still able to describe the basic physics correctly , i.e. the presence of two well defined peaks . in general , mishchenko s method seems to offer the best results across various levels of noise . even for the highest noise ( @xmath61 ) ,",
    "mishchenko s method gives an acceptable description of the exact spectra .",
    "nevertheless one has to notice , if two peaks are close to each other , this approach tends to increase the spectral weight in between the peaks . as a matter of fact , this problem is not an intrinsic property of mishchenko s algorithm , but is related to an insufficient number of local updates in the sampling .",
    "the dependence of mishchenko s results with respect to the number of local updates is investigated in appendix  [ app : conv_mish ] .",
    "for the two - pole model , for small noise levels , mishchenko s method can achieve results as good as pad , although at the cost of a much bigger computational effort .    finally , from the comparison of the left and right panels of fig .  [ fig:2pole : spectra ] , one can conclude that partially overlapping peaks seem to be more difficult to describe than having one peak close and one peak far from zero energy .",
    "this is not so trivial , since usually analytical continuation methods are supposed to perform well to describe ( even complex ) structures close to zero energy .",
    "it is also useful to illustrate how the quality of the analytical continuation depends on the number of input points , e.g. , the number of matsubara frequencies .",
    "the quality of the continuation can be measured through the difference between the obtained @xmath8 and the exact function on the real axis @xmath62 in the following way @xmath63 where the upper bound of the integrals is chosen to be larger than the actual extension of the function .",
    "the error measure given by eq .",
    "for the two - pole model with noise @xmath59 is plotted in fig .",
    "[ fig:2pole : error ] with respect to different number of the maximum matsubara index , @xmath64 .",
    "note that for the pad method the notion of @xmath64 is a bit more complicated to define , since an average is done over several continuations with varying numbers of input points and pad coefficients  @xcite . to make optimal usage of the averaging procedure , both the number of input points and pad coefficients take values between @xmath65 and @xmath66 in steps of 4 , under the constraint of not having more coefficients than matsubara points .",
    "if @xmath67 , then 4 is used as the lower boundary instead .     used .",
    "upper panel @xmath50 , @xmath58 , @xmath52 and @xmath57 , lower panel @xmath50 , @xmath51 , @xmath52 and @xmath53 , as defined in eq .",
    "[ eq : two - pole ]",
    ". matsubara noise level @xmath59 is used . ]    in fig .",
    "[ fig:2pole : error ] , the general trend is that the quality of the continuation initially improves with an increasing number of matsubara points .",
    "at some point , the error stabilises .",
    "when the typical energy scale on the real axis ( @xmath56 ) increases , this stabilisation point moves to higher matsubara frequencies .",
    "however , there are small variations to this general picture for the different methods .",
    "the error between the pad continuation and the exact function quickly drops at @xmath68 and is very small until @xmath69 ( or 120 for @xmath53 ) .",
    "when taking into account more matsubara points , the error increases .",
    "we attribute this behavior mainly to the number of physical continuations in the averaging procedure . for small @xmath64 ,",
    "the total number of continuations is limited .",
    "for large @xmath64 , the number of physical continuations decreases significantly . for this particular test , at least 30 to 40 physical continuations where needed , to optimally use the power of the averaging procedure .",
    "the continuations obtained with nnt and nnls , on the other hand , continue improving when additional matsubara frequencies are taken into account .",
    "however the improvement becomes smaller and smaller .",
    "the mem error quickly drops at @xmath70 and decreases only slightly for higher @xmath64 .",
    "the error of the mishchenko continuation stabilises at a relatively small number of matsubara frequencies . for this method",
    ", we have used the same number of local updates ( 15000 ) for all continuations .",
    "the behaviour for more local updates is discussed in appendix  [ app : conv_mish ] .",
    "it is conceivable that adding additional frequencies does give extra information , but also requires a longer runtime of the stochastic sampling .",
    "-point of the rpa spectrum of the doped hubbard model reported in fig .",
    "[ fig : rpa : noise : pade_nnls_nnt_mem_2 ] .",
    "data for two noise levels @xmath59 and @xmath71 are shown . ]    for the second test , we use a metallic system , namely the two - dimensional non - interacting hubbard model on a square - lattice with nearest - neighbor interaction .",
    "the correlation function depends on the matsubara frequency and on the momentum @xmath72 . according to rpa",
    "it is given by  @xcite @xmath73 where the sum denotes an average over the brillouin zone , @xmath74 is the fermi distribution and the dispersion relation is @xmath75.\\end{aligned}\\ ] ] the energy scale of this model is given by the half bandwidth @xmath76 , where @xmath77 is the hopping parameter .",
    "therefore , we fix the energy unit to @xmath78 . the chemical potential is set to @xmath79 , which corresponds approximately to a filling of 0.185 per spin flavor .    in fig .",
    "[ fig : rpa : noise : pade_nnls_nnt_mem_2 ] the analytical continuation of the momentum resolved rpa susceptibility for all methods is reported .",
    "the panels in the first three columns correspond to data for various levels of noise @xmath46 .",
    "the panels in the last column illustrate the exact spectrum on the real axis , repeated in each row for an easier comparison .    at small wavevectors ( close to @xmath80 ) ,",
    "the susceptibility exhibits a single low - energy mode , the zero sound mode .",
    "this mode consists of low energy excitations close to the fermi surface .",
    "further away from @xmath80 , landau damping broadens this zero sound mode .",
    "all methods correctly capture the zero sound mode .",
    "however , nnls shows an unphysical splitting of this mode into two branches roughly halfway from @xmath81 .",
    "the tendency of nnls to introduce spurious peaks is even more pronounced when going from @xmath82 , and in fact it is not even possible to illustrate all countour lines in fig .",
    "[ fig : rpa : noise : pade_nnls_nnt_mem_2 ] without compromising its readibility .",
    "the complex spectral evolution in the path @xmath82 seems indeed rather difficult to describe for all methods , especially for high noise . at the @xmath83-point the exact spectrum acquires a seemingly simpler structure , consisting of a relatively flat bump between @xmath84 and @xmath85",
    "this point is analysed more in detail in fig .",
    "[ fig : rpa : noise : pade_nnls_nnt_mem_2_inset ] .",
    "it shows that it is not so easy to capture the broad flat feature instead of two separate peaks .",
    "similarly to the previous test function , pad correctly reproduces the spectrum at low noise , but gives a single sharp peak instead of a broad flat mode when @xmath46 is increased .",
    "nnls performs very poorly here , with a spectrum of a few sharp peaks even at low noise @xmath71 .",
    "nnt does a lot better , compared to nnls ; the regularisation flattens the spectrum , although an unphysical local minimum remains at @xmath59 .",
    "similarly , mem also captures the general shape of the spectrum , but again an unphysical local minimum forms between the main peaks .",
    "mishchenko s method is the only one that correctly reproduces the very flat spectrum between @xmath84 and @xmath85 even for high noise .",
    "these feature is consistent with the behavior observed in the top left panel of fig .",
    "[ fig:2pole : spectra ]",
    ".    in general mishchenko s method performs the best across various levels of noise , while nnls leads to the poorest continuation for this function .",
    "as expected , the quality of the continuation obtained with pad worsens quickly when @xmath46 is increased .",
    "interestingly , nnt seems to perform slightly better for higher noise .",
    "for very low noise , the features are sharper and some spurious wiggles occur .",
    "these properties influence strongly the applicability of nnt and pad to realistic problems where the exact function is unknown .",
    "the mem is rather robust to external noise , but for high precision data its quality seems inferior to both mishchenko s method and pad .",
    "the final model function is useful to investigate realistic features that are not close to zero energy .",
    "we again use a non - interacting hubbard model on a square lattice with nearest - neighbor hopping . differently from the previous test ,",
    "we now consider two non - degenerate bands . again",
    ", we take @xmath86 for the half bandwidth .",
    "the two bands are shifted with respect to each other by an energy @xmath87 .",
    "since the half bandwidth of both bands is 1 , there is an indirect gap of @xmath88 . in equation",
    ", this would correspond to two bands with shifted dispersions @xmath89 and @xmath90 .",
    "we consider both excitations within one band as well as between the two bands .",
    "the chemical potential @xmath91 lies in the gap between the two bands .",
    "this model could correspond to the presence of a magnetic field that splits the dispersion of the electrons with spins up and down .",
    "the electronic states with spin down have energy @xmath92 $ ] , i.e. they are all below the fermi energy . the electronic states with spin up , on the other hand , have energy @xmath93 $ ] . i.e. they are all above the fermi energy",
    ". excitations between the two bands have energies between @xmath84 and @xmath94 .    in fig .",
    "[ fig : bandgap : noise : pade_nnls_nnt_mem ] the analytical continuation of the momentum resolved rpa susceptibility for all methods is reported .",
    "as above , the panels in the first three columns correspond to data for various level of noise @xmath46 , while the panels in the last column illustrate the exact spectrum on the real axis . at the @xmath80-point",
    ", the exact spectrum shows the presence of a single peak at @xmath95 .",
    "this essential feature is captured by all methods and for all levels of noise , although the mem and the nnt method exhibit the usual tendency to broaden the peak . going from @xmath80 to @xmath96 ,",
    "the single peak splits into two distinct peaks , with some spectral weight remaining in the intermediate region . to illustrate this , fig .",
    "[ subfig : gx ] shows the spectrum half way between @xmath80 and @xmath96 . at @xmath59 mem , nnt and",
    "mishchenko s method all capture the widening of the peak as we move away from the @xmath80-point .",
    "however only mishchenko s method captures the gradual splitting into two peaks at this point .",
    "mem and nnt find the splitting closer to @xmath96 . for smaller noise ,",
    "i.e. for @xmath71 , the mem is also capable of resolving the two - peak structure at @xmath97 .",
    "nnls , nnt and pad fail to offer an acceptable description of the spectrum at this point , since they also introduce one or more spurious peaks in between the two physical peaks .    at the @xmath83 point",
    ", the exact spectrum has a sharp peak at @xmath95 with a very broad base .",
    "all methods , except for nnls , give the correct width , but are not very accurate on the symmetric character of the spectrum .",
    "this improves for lower noise levels , but the sharp peak in the middle stays slightly broadened , as can be seen in fig .",
    "[ subfig : m ] .",
    "these data show that mishchenko s method is the only one to offer a fully satisfactory description of the spectrum for @xmath59 .",
    "it is also worth noticing that although the pad method does not fail too badly at @xmath83 , the general trend for @xmath59 observed in fig .",
    "[ fig : bandgap : noise : pade_nnls_nnt_mem ] is rather negative and violates symmetry constraints . for even smaller noise , @xmath71 ,",
    "all methods but nnls give a very good description of the spectrum at the @xmath83-point .    in summary , for this model function , mishchenko s method is stable with respect to input noise and clearly performs best of all methods for @xmath60 .",
    "however , great care has to be taken concerning the number of updates in the sampling chain , as is investigated in appendix  [ app : conv_mish ] .",
    "the pad method performs quite well for high precision data but fails badly when noise is present .",
    "finally , for intermediate levels of noise , mem and nnt also lead to reasonable results , although mishchenko s method is still superior .      as a final note ,",
    "we want to make a brief comment on the computational effort required to perform the analytical continuation of these functions .",
    "momentum resolved calculations , such as the rpa spectra for the hubbard model shown above , typically involve linear dimensions of approximately 100 sites . even considering a minimal effort , analytical continuation is required on a path through the high symmetry points of the lattice , involving about a hundred analytical continuations .",
    "additionally , the analytical continuation should be done several times with different continuation parameters to ascertain its stability .",
    "therefore , the computational time required to perform a single continuation becomes a factor of practical importance .",
    "it is not simple to compare the fundamental computational effort required by the five methods investigated here , due that the employed codes have different degrees of optimization and parallelization .",
    "nevertheless , we can still provide some estimates .",
    "the fastest methods are undoubtedly nnls and nnt , which require less than a second per continuation .",
    "the mem and pad are slower , and usually require from several to a hundred seconds per continuation , depending on the parameters used .",
    "mishchenko s method is by far the most demanding method among those tested here . to obtain properly converged results",
    "one has to perform the stochastic sampling for a time ranging from a few hours to weeks .",
    "the effective time can be significantly reduced by using a parallelized code , like we do in the present work . however , parallelization is easy to implement only over global updates in the monte carlo chain , while local updates have still to be handled serially .",
    "this limits the scalability of the code , and therefore the reduction in computational time , to about hundred cpus . even in this case",
    ", we must notice that it is not always possible to dedicate such a large amount of resources to the analytical continuation problem .",
    "this sets a limit on the applicability of mishchenko s method in current research .",
    "we are currently exploring an alternative formulation of mishchenko s method based on a graphical processing unit ( gpu )  @xcite .",
    "[ cols=\"<,<,<,<,<,<,<\",options=\"header \" , ]     we have presented results for the analytical continuation of bosonic functions by five different methods and using three realistic test cases , corresponding to different scenarios of physical relevance for strongly correlated systems .",
    "an overview of the major features emphasized in the previous section is given in table  [ tab : summary ] .",
    "the first conclusion of our work is that , at the moment , for low input accuracy , none of the existing methods is good enough to be able to continue all different types of two - particle quantities from the matsubara frequencies to real energies .",
    "nevertheless , a combination of several methods can give enough information to reconstruct the physical picture behind the analytical continuation problem .",
    "table  [ tab : summary ] can offer useful guidelines to perform this type of analysis .",
    "conversely , for high precision input data , our results are encouraging . among all methods ,",
    "the pad averaging scheme  @xcite is the one that performs best when the numerical noise is absent . for complicated spectra , such as that of the band gap model",
    ", even pad can not completely resolve the spectrum for @xmath98 , and it is indeed not even clear that it performs better than mishchenko s method , due to small violations of the symmetry characterizing the exact spectrum . in general , mishchenko s method seems to be the most robust approach across various levels of noise . as a matter of fact , its results do not seem very affected by the different noise levels for all the tested functions .",
    "the accuracy of mishchenko s method is also good , although care is needed when choosing the numerical parameters of the stochastic sampling . for optimal parameter values ,",
    "the accuracy of mishchenko s method is definitely good .",
    "overall , a single sharp peak close to zero energy is resolved by all methods even for a relatively high noise .",
    "the mem , nnt method and mishchenko s method are able to resolve broad features .",
    "however , these methods also have the tendency to smear several pronounced peaks , sometimes into a single broad feature . in mishchenko",
    "s method , this problem is related to the number of local updates performed in the sampling . as shown in appendix  [ app : conv_mish ] , increasing the number of local updates leads to more peaked spectra , but those are not always in better agreement with the exact results . in general ,",
    "the tendency to smear pronounced features into broad peaks and , at the same time , to create spurious peaks makes it difficult to know if a calculated broad .",
    "but on the other hand , sometimes spurious structure is created .",
    "this makes it difficult to know if a calculated broad spectral feature really is a broad feature or a combination of several peaks . as an example of this , the mem continuation of the two - pole function for @xmath57 at @xmath59 ( fig .",
    "[ fig:2pole : spectra ] ) looks similar to the mem continuation of the two - dimensional doped hubbard model at the @xmath83-point for the same noise level ( fig .",
    "[ fig : rpa : noise : pade_nnls_nnt_mem_2_inset ] ) , although the exact functions are very different .",
    "the very broad modes that appear , e.g. , around the @xmath83 point of the doped two - dimensional hubbard model , are difficult to resolve correctly .",
    "functions with two distinct poles , on the other hand , are much easier .",
    "nnls , in particular , performs well for the two - pole model whereas it performs very poorly for more complicated spectra .",
    "this shows the importance of varied , realistic test functions for assessing the potential of each continuation method .",
    "finally , we compare our work to previous studies .",
    "two previous works  @xcite found that pad generally performs poorer than the other methods .",
    "et al . _",
    "@xcite found that mem outperforms pad for a spectrum generated from a combination of two gaussian distributions .",
    "in particular , their results show that the pad method sometimes merges two peaks , just as we have seen in the two - pole spectra . in ref .",
    "@xcite , the authors test several methods of analytical continuation on the optical conductivity for relatively high noise levels ( @xmath61 to @xmath99 ) .",
    "they find that all methods ( pad , singular value decomposition , sampling and mem ) perform similarly , but that the pad method generally gives slightly less accurate results and sometimes finds unphysical continuations .",
    "however , in both studies , the averaging scheme for pad  @xcite was not used .",
    "this averaging scheme solves the problem of unphysical continuations and should improve the overall performance of the pad method .",
    "we would also like to stress two more fundamental conclusions of this study .",
    "first , we want to emphasize the importance of varied , realistic test functions in the assessment of continuation algorithms .",
    "the dependence of the performance of each method on the type of function investigated is a clear indication that no analysis can be meaningful without exploring a proper number of test cases .",
    "second , we want to stress that our findings fully support what was already claimed in ref .",
    "@xcite , namely , despite no universal tool currently available , a better insight into the continuation problem can be obtained by using a combined approach of several methods .",
    "this work was sponsored by the swedish research council ( vr ) , the swedish strategic research programme essence and the knut and alice wallenberg foundation ( kaw ) .",
    "and m.i.k acknowledge support from erc advanced grant 338957 femto / nano .",
    "the authors acknowledge the computational resources provided by the swedish national infrastructure for computing ( snic ) at the pdc center for high performance computing at the kth royal institute of technology , at uppsala multidisciplinary center for advanced computational science ( uppmax ) and at chalmers centre for computational science and engineering ( c3se )",
    ".     used in mishchenko s method .",
    "different number of local iterations are investigated and are indicated by the legend .",
    "upper panel @xmath50 , @xmath58 , @xmath52 and @xmath57 , lower panel @xmath50 , @xmath51 , @xmath52 and @xmath53 , as defined in eq .",
    "[ eq : two - pole ]",
    ". matsubara noise level @xmath59 is used . ]",
    "the mem , the nnt and the nnls method conserve the symmetry of the spectra @xmath10 , since they use the symmetric definition of the hilbert transform , eq .. the pad method does not have such symmetry imposed . for fermionic one - particle greens functions and self - energies with zero imaginary part at the origin of the complex plane , it is shown  @xcite that the continuation improves by taking a few negative matsubara frequencies into account to impose the mirror symmetry .",
    "such a procedure , with a single negative matsubara frequency , has also been used for the optical conductivity  @xcite .",
    "we have tried the same scheme for the pad continuation of the bosonic functions in this paper , but in most cases imposing mirror symmetry actually gave a worse continuation .",
    "in particular , when the exact spectrum has a broad , rather flat spectrum , such as at the @xmath83-point of the doped hubbard model , imposing the symmetry can lead to spurious sharp features .",
    "broad modes in the spectrum are related to branch cuts in the complex function @xmath3 .",
    "the pad approximant uses a finite number of poles to simulate @xmath3 .",
    "when the mirror symmetry is imposed on the pad approximant , the poles move closer to the real axis , which results in sharper spectral features .",
    "hence broad features are harder to accurately simulate by imposing mirror symmetry .",
    "the stochastic sampling method by mishchenko _",
    "et al . _",
    "@xcite consists of many iterative steps . in every step ,",
    "the configuration of the rectangles is altered . in the main text results with 15000 iterations",
    "are presented , which is a suitable setup to obtain reasonable results in a decent computational time ( 30 cpu hours using 128 cpus ) . however , in principle the method should be converged carefully with respect to the number of iterations . in fig .",
    "[ fig : mconv ] we increase that number by a factor of 4 several times , and show the resulting spectral function .",
    "for the two - pole model ( see fig .",
    "[ fig:2pole : spectra ] ) it is clear that increasing the number of iterations improves the resulting spectrum , see fig .  [ subfig : mconv-2p ] .",
    "however for a more complicated spectrum , such as the band gap model at the k - point @xmath100 ( see fig .  [ subfig : gx ] ) , convergence with respect to the number of iterations does not lead to an improvement , see fig .",
    "[ subfig : mconv - gap ] .",
    "this issue is particularly pronounced when the input noise is big .",
    "the tendency to produce too sharp features resembles the overfitting occurring in the nnls method . for the doped hubbard model at the @xmath83-point ( see left panel in fig .  [",
    "fig : rpa : noise : pade_nnls_nnt_mem_2_inset ] ) the spectra converge already for 15000 iterations , see fig .",
    "[ subfig : mconv - doped ] . in summary ,",
    "the optimal number of iterations is highly dependent on the function under investigation . with increasing number of iterations , the computational cost increases as well as the risk of overfitting to the input matsubara data .",
    "hence care should be taken when choosing the number of iterations .",
    "further , it is interesting to repeat the analysis on the accuracy of the continuation with respect to the number of matsubara points ( fig .",
    "[ fig:2pole : error ] ) while varying the number of local updates .",
    "these results are illustrated in fig .",
    "[ fig : mishchenko_local ] .",
    "while increasing the number of local updates leads to a better continuation , the general trend reported in fig .",
    "[ fig : mishchenko_local ] is very similar to fig .",
    "[ fig:2pole : error ] . increasing the number of matsubara frequencies the quality of the continuation reaches saturation very quickly and with a threshold that does not seem to depend on the number of local updates .",
    "a posteriori , this shows that the approach used in fig .",
    "[ fig:2pole : error ] , i.e. keeping fixed the number of local updates while increasing the number of matsubara points , is justifiable .",
    "46ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _ _ ,  edited by  ,  springer series in solid - state sciences  ( ,  ,  ) link:\\doibase 10.1103/physrevlett.62.324 [ *",
    "* ,   ( ) ] link:\\doibase    10.1103/revmodphys.68.13 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.57.6884 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.78.865 [ * * ,   ( ) ] @noop _ _  ( , ) @noop _ _  ( ,  ,  ) link:\\doibase 10.1103/physrevb.85.115128 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.109.226401 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.110.166401 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.87.125149 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.195114 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.113.246407 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.235105 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.92.205132 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.114.146401 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.81.045117 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.84.075145 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.77.3391 [ * * ,   ( ) ] @noop ph.d .",
    "thesis ,   ( ) link:\\doibase 10.1103/physrevb.61.5184 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.84.3678 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.63.115110 [ * * ,   ( ) ] link:\\doibase 10.1016/j.aop.2012.01.002 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.90.235135 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.92.081106 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.82.165125 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.81.155107 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.85.035115 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.41.2380 [ * * ,   ( ) ] \\doibase    http://dx.doi.org/10.1016/0370-1573(95)00074-7 [ * * , ( ) ] link:\\doibase 10.1007/bf02427376 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.44.6011 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.81.056701 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.82.026701 [ * * ,   ( ) ] @noop _ _  ( ,  ,  ) in  @noop _ _  ( , )  pp .",
    "link:\\doibase 10.1103/physrevb.61.5147 [ * * ,   ( ) ] link:\\doibase 10.1007/bf00655090 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.62.6317 [ * * ,   ( ) ] in  http://juser.fz-juelich.de/record/22915[__ ] ,  ( ) link:\\doibase    10.1103/revmodphys.83.349 [ * * ,   ( ) ] @noop `` , ''   ( ) link:\\doibase    10.1103/physrevb.93.075104 [ * * ,   ( ) ] @noop _ _  ( ,  ) @noop `` , ''   ( ) ,"
  ],
  "abstract_text": [
    "<S> in this article we perform a critical assessment of different known methods for the analytical continuation of bosonic functions , namely the maximum entropy method , the non - negative least - square method , the non - negative tikhonov method , the pad approximant method , and a stochastic sampling method . </S>",
    "<S> three functions of different shape are investigated , corresponding to three physically relevant scenarios . </S>",
    "<S> they include a simple two - pole model function and two flavours of the non - interacting hubbard model on a square lattice , i.e. a single - orbital metallic system and a two - orbitals insulating system . </S>",
    "<S> the effect of numerical noise in the input data on the analytical continuation is discussed in detail . </S>",
    "<S> overall , the stochastic method by mishchenko _ et al . _ </S>",
    "<S> [ phys . </S>",
    "<S> rev . </S>",
    "<S> b * 62 * , 6317 ( 2000 ) ] is shown to be the most reliable tool for input data whose numerical precision is not known . for high precision input data , </S>",
    "<S> this approach is slightly outperformed by the pad approximant method , which combines a good resolution power with a good numerical stability . </S>",
    "<S> although none of the methods retrieves all features in the spectra in the presence of noise , our analysis provides a useful guideline for obtaining reliable information of the spectral function in cases of practical interest . </S>"
  ]
}