{
  "article_text": [
    "given finite sets @xmath7 , diaconis and fulton @xcite defined the _ smash sum _ @xmath8 as a certain random set whose cardinality is the sum of the cardinalities of @xmath9 and @xmath10 .",
    "write @xmath11 . to construct the smash sum ,",
    "begin with the union @xmath12 and for each @xmath13 let @xmath14 where @xmath15 is the endpoint of a simple random walk started at @xmath16 and stopped on exiting  @xmath17 .",
    "then define @xmath18 .",
    "the key observation of @xcite is that the law of @xmath19 does not depend on the ordering of the points @xmath16 .",
    "the sum of two squares in @xmath4 overlapping in a smaller square is pictured in figure  [ smashsumfigure ] .     overlapping in a smaller square , for internal dla",
    "( top left ) , the rotor - router model ( top right ) , and the divisible sandpile .",
    ", title=\"fig : \" ]   overlapping in a smaller square , for internal dla ( top left ) , the rotor - router model ( top right ) , and the divisible sandpile .",
    ", title=\"fig : \" ]   overlapping in a smaller square , for internal dla ( top left ) , the rotor - router model ( top right ) , and the divisible sandpile .",
    ", title=\"fig : \" ]    in theorem  [ dfsum ] , below , we prove that as the lattice spacing goes to zero , the smash sum @xmath8 has a deterministic scaling limit in @xmath1 . before stating our main results , we describe some related models and describe our technique for identifying their common scaling limit , which comes from the theory of free boundary problems in pde .",
    "the diaconis - fulton smash sum generalizes the model of _ internal diffusion - limited aggregation _ ( `` internal dla '' ) studied in @xcite , and in fact was part of the original motivation for that paper . in classical internal dla",
    ", we start with @xmath5 particles at the origin @xmath20 and let each perform a simple random walk until it reaches an unoccupied site .",
    "the resulting random set of @xmath5 occupied sites in @xmath0 can be described as the @xmath5-fold smash sum of @xmath21 with itself .",
    "we will use the term internal dla to refer to particles which perform simple random walks in @xmath0 until reaching an unoccupied site , starting from an arbitrary initial configuration . in this broader sense of the term , both the diaconis - fulton sum and",
    "the model studied in @xcite are particular cases of internal dla .",
    "in defining the smash sum @xmath19 , various alternatives to random walk are possible .",
    "_ rotor - router walk _ is a deterministic analogue of random walk , first studied by priezzhev et al .",
    "@xcite under the name `` eulerian walkers . '' at each site in @xmath4 is a _ rotor _ pointing north , south , east or west .",
    "a particle performs a nearest - neighbor walk on the lattice according to the following rule : during each time step , the rotor at the particle s current location is rotated clockwise by @xmath22 degrees , and the particle takes a step in the direction of the newly rotated rotor . in higher dimensions ,",
    "the model can be defined analogously by repeatedly cycling the rotors through an ordering of the @xmath23 cardinal directions in @xmath0 .",
    "the sum of two squares in @xmath4 using rotor - router walk is pictured in figure  [ smashsumfigure ] ; all rotors began pointing west .",
    "the shading in the figure indicates the final rotor directions , with four different shades corresponding to the four possible directions .",
    "the _ divisible sandpile _",
    "model uses continuous amounts of mass in place of discrete particles .",
    "a lattice site is _ full _ if it has mass at least @xmath24 .",
    "any full site can _ topple _ by keeping mass @xmath24 for itself and distributing the excess mass equally among its neighbors . at each time step , we choose a full site and topple it . as time goes to infinity , provided each full site is eventually toppled , the mass approaches a limiting distribution in which each site has mass @xmath25 .",
    "note that individual topplings do not commute .",
    "however , the divisible sandpile is `` abelian '' in the sense that any sequence of topplings produces the same limiting mass distribution ; this is proved in lemma  [ abelianproperty ] .",
    "figure  [ smashsumfigure ] shows the limiting domain of occupied sites resulting from starting mass @xmath24 on each of two squares in @xmath4 , and mass @xmath26 on the smaller square where they intersect .",
    "figure  [ smashsumfigure ] raises a few natural questions : as the underlying lattice spacing becomes finer and finer , will the smash sum @xmath19 tend to some limiting shape in @xmath1 , and if so , what is this shape",
    "? will it be the same limiting shape for all three models ? to see how we might identify the limiting shape , consider the divisible sandpile _ odometer function _",
    "@xmath27 since each neighbor @xmath28 emits an equal amount of mass to each of its @xmath23 neighbors , the total mass received by @xmath29 from its neighbors is @xmath30 , hence @xmath31 where @xmath32 and @xmath33 are the initial and final amounts of mass at @xmath29 , respectively . here",
    "@xmath34 is the discrete laplacian in @xmath0 , defined by @xmath35    equation ( [ netchangeinmass ] ) suggests the following approach to finding the limiting shape .",
    "we first construct a function on @xmath0 whose laplacian is @xmath36 ; an example is the function @xmath37 where in dimension @xmath38 the green s function @xmath39 is the expected number of times a simple random walk started at @xmath29 visits @xmath40 ( in dimension @xmath41 we use the recurrent potential kernel in place of the green s function ) . here",
    "@xmath42 denotes the euclidean norm @xmath43 . by ( [ netchangeinmass ] ) , since @xmath44 the sum @xmath45 is a superharmonic function on @xmath0 ; that is , @xmath46 .",
    "moreover if @xmath47 is any superharmonic function lying above @xmath48 , then @xmath49 is superharmonic on the domain @xmath50 of fully occupied sites , and nonnegative outside @xmath51 , hence nonnegative everywhere .",
    "thus we have proved the following lemma .",
    "[ discretemajorantintro ] let @xmath52 be a nonnegative function on @xmath0 with finite support",
    ". then the odometer function ( [ odomdefintro ] ) for the divisible sandpile started with mass @xmath32 at each site @xmath29 is given by @xmath53 where @xmath48 is given by ( [ theobstacleintro ] ) , and @xmath54 is the _ least superharmonic majorant _ of @xmath48 .     corresponding to starting mass @xmath24 on each of two overlapping disks ( top ) and mass @xmath55 on each of two nonoverlapping disks.,title=\"fig : \" ] +    corresponding to starting mass @xmath24 on each of two overlapping disks ( top ) and mass @xmath55 on each of two nonoverlapping disks.,title=\"fig : \" ]    lemma  [ discretemajorantintro ] allows us to formulate the problem in a way which translates naturally to the continuum . given a function @xmath52 on @xmath1 representing the initial mass density , by analogy with ( [ theobstacleintro ] )",
    "we define the _ obstacle _ @xmath56 where @xmath57 is the green s function on @xmath1 proportional to @xmath58 in dimensions @xmath59 and to @xmath60 in dimension two .",
    "we then let @xmath61 the _ odometer function _ for @xmath52 is then given by @xmath62 , and the final domain of occupied sites is given by @xmath63 this domain @xmath51 is called the _ noncoincidence set for the obstacle problem _ with obstacle @xmath48 ; for an in - depth discussion of the obstacle problem , see @xcite .",
    "if @xmath64 are bounded open sets in @xmath1 , we define the _ smash sum _ of @xmath9 and @xmath10 as @xmath65 where @xmath51 is given by ( [ thenoncoincidencesetintro ] ) with @xmath66 .",
    "in the two - dimensional setting , an alternative definition of the smash sum in terms of quadrature identities is mentioned in @xcite .    in this thesis",
    "we prove , among other things , that if any of our three aggregation models is run on finer and finer lattices with initial mass densities converging in an appropriate sense to @xmath52 , the resulting domains of occupied sites will converge in an appropriate sense to the domain @xmath51 given by ( [ thenoncoincidencesetintro ] ) .",
    "we will always work in dimension @xmath67 ; for a discussion of the rotor - router model in one dimension , see @xcite .",
    "let us define the appropriate notion of convergence of domains , which amounts essentially to convergence in the hausdorff metric .",
    "fix a sequence @xmath68 representing the lattice spacing .",
    "given domains @xmath69 and @xmath70 , write @xmath71 if for any @xmath72 @xmath73 for all sufficiently large @xmath5 . here",
    "@xmath74 and @xmath75 are the inner and outer @xmath76-neighborhoods of @xmath51 .",
    "for @xmath77 we write @xmath78^d$ ] . for @xmath79 write @xmath80 for the closest integer to @xmath81 .    throughout this thesis , to avoid trivialities we work in dimension @xmath67 .",
    "our first main result is the following .",
    "[ intromain ] let @xmath82 be a bounded open set , and let @xmath83 be a bounded function which is continuous almost everywhere , satisfying @xmath84 .",
    "let @xmath85 be the domains of occupied sites formed from the divisible sandpile , rotor - router model , and internal dla , respectively , in the lattice @xmath86 started from source density @xmath87 then as @xmath88 @xmath89 and if @xmath90 , then with probability one @xmath91 where @xmath51 is given by ( [ thenoncoincidencesetintro ] ) , and the convergence is in the sense of  ( [ convergenceinthehausdorffmetric ] ) .",
    "when forming the rotor - router domains @xmath92 , the initial rotors in each lattice @xmath86 may be chosen arbitrarily .",
    "we prove a somewhat more general form of theorem  [ intromain ] which allows for some flexibility in how the discrete density @xmath93 is constructed from @xmath52 .",
    "in particular , taking @xmath94 we obtain the following theorem , which explains the similarity of the three smash sums pictured in figure  [ smashsumfigure ] .",
    "[ dfsum ] let @xmath95 be bounded open sets whose boundaries have measure zero .",
    "let @xmath85 be the smash sum of @xmath96 and @xmath97 , formed using divisible sandpile , rotor - router and internal dla dynamics , respectively .",
    "then as @xmath88 @xmath98 and if @xmath90 , then with probability one @xmath99 where @xmath8 is given by ( [ smashsumdef ] ) , and the convergence is in the sense of  ( [ convergenceinthehausdorffmetric ] ) .    for the divisible sandpile , theorem  [ intromain ] can be generalized by dropping the requirement that @xmath52 be integer valued ; see theorem  [ domainconvergence ] for the precise statement",
    ". taking @xmath52 real - valued is more problematic in the case of the rotor - router model and internal dla , since these models work with discrete particles .",
    "still , one might wonder if , for example , given a domain @xmath100 , starting each even site in @xmath96 with one particle and each odd site with two particles , the resulting domains @xmath101 would converge to the noncoincidence set @xmath51 for density @xmath102 .",
    "this is in fact the case : if @xmath93 is a density on @xmath86 , as long as a certain `` smoothing '' of @xmath93 converges to @xmath52 , the rotor - router and internal dla domains started from source density @xmath93 will converge to @xmath51 . see theorems  [ rotordomainconvergence ] and  [ idlaconvergence ] for the precise statements .",
    "one interesting case not covered by theorems  [ intromain ] and  [ dfsum ] is the case of point sources .",
    "lawler , bramson and griffeath @xcite showed that the scaling limit of internal dla in @xmath0 with a single point source of particles is a euclidean ball . in chapter  [ pointsource ]",
    ", we prove analogous results for rotor - router aggregation and the divisible sandpile , and give quantitative bounds on the rate of convergence to a ball .",
    "let @xmath103 be the domain of @xmath5 sites in @xmath0 formed from rotor - router aggregation starting from a point source of @xmath5 particles at the origin .",
    "thus @xmath103 is defined inductively by the rule @xmath104 where @xmath105 is the endpoint of a rotor - router walk started at the origin in @xmath0 and stopped on first exiting @xmath106 .",
    "for example , in @xmath4 , if all rotors initially point north , the sequence will begin @xmath107 , @xmath108 , @xmath109 .",
    "the region @xmath110 is pictured in figure  [ rotor1 m ] .    .",
    "each site is colored according to the direction of its rotor . ]",
    "jim propp observed from simulations in two dimensions that the regions @xmath103 are extraordinarily close to circular , and asked why this was so @xcite . despite the impressive empirical evidence for circularity , the best result known until now",
    "@xcite says only that if @xmath103 is rescaled to have unit volume , the volume of the symmetric difference of @xmath103 with a ball of unit volume tends to zero as a power of @xmath5 , as @xmath111 .",
    "the main outline of the argument is summarized in @xcite .",
    "fey and redig @xcite also show that @xmath103 contains a diamond .",
    "in particular , these results do not rule out the possibility of `` holes '' in @xmath103 far from the boundary or of long tendrils extending far beyond the boundary of the ball , provided the volume of these features is negligible compared to @xmath5 .    our main result on the shape of rotor - router aggregation with a single point source is the following , which rules out the possibility of holes far from the boundary or of long tendrils .",
    "for @xmath112 let @xmath113    [ rotorcircintro ] let @xmath103 be the region formed by rotor - router aggregation in @xmath0 starting from @xmath5 particles at the origin and any initial rotor state . there exist constants @xmath114 depending only on @xmath115 , such that @xmath116 where @xmath117 , and @xmath118 is the volume of the unit ball in @xmath1 .",
    "we remark that the same result holds when the rotors evolve according to stacks of bounded discrepancy ; see the remark following lemma  [ odomflow ] .    by way of comparison with theorem  [ rotorcircintro ] , if @xmath119 is the internal dla region formed from @xmath5 particles started at the origin , the best known bounds @xcite are ( up to logarithmic factors ) @xmath120 for all sufficiently large @xmath5 , with probability one .",
    "our next result treats the divisible sandpile with all mass initially concentrated at a point source .",
    "the resulting domain of fully occupied sites is extremely close to a ball ; in fact , the error in the radius is bounded independent of the total mass .",
    "[ divsandcircintro ] for @xmath121 let @xmath122 be the domain of fully occupied sites for the divisible sandpile formed from a pile of mass @xmath123 at the origin .",
    "there exist constants @xmath114 depending only on @xmath115 , such that @xmath124 where @xmath125 and @xmath118 is the volume of the unit ball in @xmath1 .",
    "the divisible sandpile is similar to the `` oil game '' studied by van den heuvel @xcite . in the terminology of @xcite",
    ", it also corresponds to the @xmath126 limit of the classical abelian sandpile ( defined below ) , that is , the abelian sandpile started from the initial condition in which every site has a very deep `` hole . ''    .",
    "colors represent the number of grains at each site . ]    in the classical _ abelian sandpile model _",
    "@xcite , each site in @xmath0 has an integer number of grains of sand ; if a site has at least @xmath23 grains , it _",
    "topples _ , sending one grain to each neighbor .",
    "if @xmath5 grains of sand are started at the origin in @xmath0 , write @xmath127 for the set of sites that are visited during the toppling process ; in particular , although a site may be empty in the final state , we include it in @xmath127 if it was occupied at any time during the evolution to the final state .    .",
    "the inner diamond and outer square are due to le borgne and rossin @xcite ; the inner and outer circles are those in theorem  [ sandpilecircintro ] . ]    until now the best known constraints on the shape of @xmath127 in two dimensions were due to le borgne and rossin @xcite , who proved that @xmath128 fey and redig  @xcite proved analogous bounds in higher dimensions , and extended these bounds to arbitrary values of the height parameter @xmath129 . this parameter is discussed in section  [ sandpilepointsource ] .",
    "the methods used to prove the near - perfect circularity of the divisible sandpile shape in theorem  [ divsandcircintro ] can be used to give constraints on the shape of the classical abelian sandpile , improving on the bounds of  @xcite and  @xcite .",
    "[ sandpilecircintro ] let @xmath127 be the set of sites that are visited by the classical abelian sandpile model in @xmath0 , starting from @xmath5 particles at the origin .",
    "write @xmath130 .",
    "then for any @xmath72 we have @xmath131 where @xmath132 the constant @xmath133 depends only on @xmath115 , while @xmath134 depends only on @xmath115 and @xmath76 .",
    "note that theorem  [ sandpilecircintro ] does not settle the question of the asymptotic shape of @xmath127 , and figure  [ sandpile1 m ] indicates that the limiting shape in two dimensions may be a polygon rather than a disk .",
    "even the existence of an asymptotic shape is not known , however",
    ".       started from two point sources on the @xmath29-axis .",
    "the boundary of the limiting shape is an algebraic curve of degree  @xmath135 ; see equation ( [ twosourcequartic ] ) . ]    using our results for single point sources together with the construction of the smash sum ( [ smashsumdef ] ) , we can understand the limiting shape of our aggregation models started from multiple point sources .",
    "the answer turns out to be a smash sum of balls centered at the sources . for @xmath136 write @xmath137 for the closest lattice point in @xmath86 , breaking ties to the right .",
    "our shape theorem for multiple point sources , which is deduced from theorems  [ dfsum ] ,  [ rotorcircintro ] and  [ divsandcircintro ] along with the main result of @xcite , is the following .",
    "[ multiplepointsources ] fix @xmath138 and @xmath139 .",
    "let @xmath140 be the ball of volume @xmath141 centered at @xmath142 .",
    "fix a sequence @xmath68 , and for @xmath77 let @xmath143 let @xmath144 be the domains of occupied sites in @xmath86 formed from the divisible sandpile , rotor - router model , and internal dla , respectively , started from source density @xmath93 .",
    "then as @xmath88 @xmath145 and if @xmath146 , then with probability one @xmath147 where @xmath148 denotes the smash sum ( [ smashsumdef ] ) , and the convergence is in the sense of  ( [ convergenceinthehausdorffmetric ] ) .",
    "implicit in equation ( [ smashsumofballs ] ) is the associativity of the smash sum operation , which is not readily apparent from the definition ( [ smashsumdef ] ) . for a proof of associativity , see lemma  [ associativity ] . for related results in dimension two ,",
    "see ( * ? ? ?",
    "* prop .  3.10 ) and @xcite .",
    "we remark that a similar model of internal dla with multiple point sources was studied by gravner and quastel @xcite , who also obtained a variational solution . in their model , instead of starting with a fixed number of particles , each source @xmath142 emits particles according to a poisson process .",
    "the shape theorems of @xcite concern convergence in the sense of volume , which is a weaker form of convergence than ( [ convergenceinthehausdorffmetric ] ) .      by analogy with the discrete case",
    ", we would expect that volumes add under the smash sum operation ; that is , @xmath149 where @xmath150 denotes lebesgue measure in @xmath1 .",
    "although this additivity is not immediately apparent from the definition ( [ smashsumdef ] ) , it holds for all bounded open @xmath95 provided their boundaries have measure zero ; see corollary  [ volumesadd ]",
    ".    we can derive a more general class of identities known as _",
    "quadrature identities _ involving integrals of harmonic functions over @xmath8 .",
    "let us first consider the discrete case . if @xmath129 is a superharmonic function on @xmath0 , and @xmath52 is a mass configuration for the divisible sandpile ( so each site @xmath151 has mass @xmath32 ) , the sum @xmath152 can only decrease when we perform a toppling .",
    "thus @xmath153 where @xmath154 is the final mass configuration .",
    "we therefore expect the domain @xmath51 given by ( [ thenoncoincidencesetintro ] ) to satisfy the _ quadrature inequality _",
    "@xmath155 for all integrable superharmonic functions @xmath129 on @xmath51 . for a proof under suitable smoothness assumptions on @xmath52 and @xmath129 ,",
    "see proposition  [ boundaryregularitysmooth ] ; see also @xcite .",
    "a domain @xmath70 satisfying an inequality of the form ( [ quadratureineq ] ) is called a _ quadrature domain _ for @xmath52 .",
    "such domains are widely studied in potential theory and have a variety of applications in fluid dynamics @xcite . for more on quadrature domains and their connection with the obstacle problem ,",
    "see @xcite .",
    "equation ( [ discretequadrature ] ) can be regarded as a discrete analogue of a quadrature inequality ; in this sense our aggregation models , in particular the divisible sandpile , produce discrete analogues of quadrature domains .    in proposition",
    "[ ballquadrature ] , we show that the smash sum of balls @xmath156 arising in theorem  [ multiplepointsources ] obeys the classical quadrature identity @xmath157 for all harmonic functions @xmath129 on @xmath156 . this can be regarded as a generalization of the classical mean value property of harmonic functions , which corresponds to the case @xmath158 . using results of gustafsson @xcite and sakai @xcite on quadrature domains in the plane",
    ", we can deduce the following theorem , which is proved in section  [ multiplesources ] .",
    "[ algebraicboundary ] let @xmath159 be disks in @xmath160 with distinct centers .",
    "the boundary of the smash sum @xmath156 lies on an algebraic curve of degree @xmath161 .",
    "more precisely , there is a polynomial @xmath162 $ ] of the form @xmath163 and there is a finite set of points @xmath164 , possibly empty , such that @xmath165    for example , if @xmath166 and @xmath167 are disks of equal radius @xmath168 centered at @xmath169 and @xmath170 , then @xmath171 is given by the quartic curve @xcite @xmath172 this curve describes the shape of the rotor - router model with two point sources pictured in figure  [ rotortwosource ] .",
    "let @xmath173 be the infinite @xmath115-regular tree .",
    "to define rotor - router walk on a tree , for each vertex of @xmath173 choose a cyclic ordering of its @xmath115 neighbors .",
    "each vertex is assigned a rotor which points to one of the neighboring vertices , and a particle walks by first rotating the rotor at each site it comes to , then stepping in the direction of the newly rotated rotor . fix a vertex @xmath174 called the origin . beginning with @xmath175 , define the rotor - router aggregation cluster @xmath103 inductively by @xmath176 where @xmath177 is the endpoint of a rotor - router walk started at @xmath178 and stopped on first exiting @xmath106 .",
    "we do not change the positions of the rotors when adding a new chip .",
    "thus the sequence @xmath179 depends only on the choice of the initial rotor configuration .",
    "our next result is the analogue of theorem  [ rotorcircintro ] on regular trees .",
    "call a configuration of rotors _ acyclic _ if there are no directed cycles of rotors . on a tree , this is equivalent to forbidding directed cycles of length @xmath26 : for any pair of neighboring vertices @xmath180 , if the rotor at @xmath181 points to @xmath182 , then the rotor at @xmath182 does not point to @xmath181 .",
    "as the following result shows , provided we start with an acyclic configuration of rotors , the occupied cluster @xmath103 is a perfect ball for suitable values of @xmath5 .    [ aggregintro ] let @xmath173 be the infinite @xmath115-regular tree , and let @xmath183 be the ball of radius @xmath2 centered at the origin @xmath174 , where @xmath42 is the length of the shortest path from @xmath178 to @xmath29 .",
    "write @xmath184 let @xmath103 be the region formed by rotor - router aggregation on the infinite @xmath115-regular tree , starting from @xmath5 chips at @xmath178 . if the initial rotor configuration is acyclic , then @xmath185    the proof of theorem  [ aggregintro ] uses the _ sandpile group _ of a finite regular tree with the leaves collapsed to a single vertex .",
    "this is an abelian group defined for any graph @xmath186 whose order is the number of spanning trees of @xmath186 . in section  [ sandpiletree ]",
    "we recall the definition of the sandpile group and prove the following decomposition theorem expressing the sandpile group of a finite regular tree as a product of cyclic groups .",
    "[ sandpilegroupdecomp ] let @xmath187 be the regular tree of degree @xmath188 and height @xmath5 , with leaves collapsed to a single sink vertex and an edge joining the root to the sink .",
    "then writing @xmath189 for the group @xmath190 with @xmath191 summands , the sandpile group of @xmath187 is given by @xmath192    for example , taking @xmath193 we obtain that the sandpile group of the regular ternary tree of height @xmath5 has the decomposition @xmath194    toumpakari @xcite studied the sandpile group of the ball @xmath195 inside the infinite @xmath115-regular tree .",
    "her setup differs slightly from ours in that there is no edge connecting the root to the sink .",
    "she found the rank , exponent , and order of @xmath196 and conjectured a formula for the ranks of its sylow @xmath197-subgroups .",
    "we use theorem  [ sandpilegroupdecomp ] to give a proof of her conjecture in section  [ toumpakari ] .    chen and schedler",
    "@xcite study the sandpile group of thick trees ( i.e.  trees with multiple edges ) without collapsing the leaves to the sink .",
    "they obtain quite a different product formula in this setting .    in section  [ rotortree ]",
    "we define the _ rotor - router group _ of a graph and show that it is isomorphic to the sandpile group .",
    "we then use this isomorphism to prove theorem  [ aggregintro ] .",
    "much previous work on the rotor - router model has taken the form of comparing the behavior of rotor - router walk with the expected behavior of random walk .",
    "for example , cooper and spencer @xcite show that for any configuration of chips on even lattice sites in @xmath0 , letting each chip perform rotor - router walk for @xmath5 steps results in a configuration that differs by only constant error from the expected configuration had the chips performed independent random walks .",
    "we continue in this vein by investigating the recurrence and transience of rotor - router walk on trees .",
    "a walk which never returns to the origin visits each vertex only finitely many times , so the positions of the rotors after a walk has escaped to infinity are well - defined .",
    "we construct two `` extremal '' rotor configurations on the infinite ternary tree , one for which walks exactly alternate returning to the origin with escaping to infinity , and one for which every walk returns to the origin .",
    "the latter behavior is something of a surprise : to our knowledge it represents the first example of rotor - router walk behaving fundamentally differently from the expected behavior of random walk .    in between these two extreme cases , a variety of intermediate behaviors are possible .",
    "we say that a binary word @xmath198 is an _ escape sequence _ for the infinite ternary tree if there exists an initial rotor configuration on the tree so that the @xmath199-th chip escapes to infinity if and only if @xmath200 . the following result characterizes all possible escape sequences on the ternary tree .",
    "[ escapeseqs ] let @xmath201 be a binary word . for @xmath202 write @xmath203 .",
    "then @xmath204 is an escape sequence for some rotor configuration on the infinite ternary tree if and only if for each @xmath205 and @xmath206 , every subword of @xmath207 of length @xmath208 contains at most @xmath209 ones .",
    "theorem  [ escapeseqs ] is proved in section  [ recurrenceandtransience ] by expressing the escape sequence corresponding to a rotor configuration on the full tree in terms of the escape sequences of the configurations on each of the principal subtrees .",
    "this chapter is devoted to the proofs of theorems  [ rotorcircintro ] , [ divsandcircintro ] and  [ sandpilecircintro ] . in section  [ basicestimate ]",
    ", we derive the basic green s function estimates that are used in the proofs . in section  [ divsandpointsource ] we prove the abelian property and theorem  [ divsandcircintro ] for the divisible sandpile . in section  [ sandpilepointsource ]",
    "we adapt the methods used for the divisible sandpile to prove theorem  [ sandpilecircintro ] for the classical abelian sandpile model .",
    "section  [ rotorpointsource ] is devoted to the proof of theorem  [ rotorcircintro ] for the rotor - router model .",
    "write @xmath210 for simple random walk in @xmath0 , and for @xmath38 denote by @xmath211 the expected number of visits to  @xmath40 by simple random walk started at  @xmath29 .",
    "this is the _ discrete harmonic green s function _ in  @xmath0 . for fixed  @xmath29 ,",
    "the function  @xmath212 is harmonic except at @xmath29 , where its discrete laplacian is  @xmath213 .",
    "our notation  @xmath214 is chosen to distinguish between the discrete green s function in  @xmath0 and its continuous counterpart  @xmath215 in  @xmath1 .",
    "for the definition of @xmath215 , see section  [ superharmonicpotentials ] .",
    "estimates relating the discrete and continuous green s functions are discussed in section  [ discretepotentialtheory ] .    in dimension @xmath41 ,",
    "simple random walk is recurrent , so the expectation on the right side of ( [ greensfunctiondef ] ) infinite .",
    "here we define the _ potential kernel _ @xmath216 where @xmath217 the limit defining @xmath214 in ( [ potentialkerneldef ] ) is finite @xcite , and @xmath212 is harmonic except at @xmath29 , where its discrete laplacian is @xmath213 .",
    "note that ( [ potentialkerneldef ] ) is the negative of the usual definition of the potential kernel ; we have chosen this sign convention so that @xmath214 has the same laplacian in dimension two as in higher dimensions .",
    "fix a real number @xmath218 and consider the function on @xmath0 @xmath219 let @xmath2 be such that @xmath220 , and let @xmath221 where @xmath222 is the first standard basis vector in @xmath0 .",
    "the function @xmath223 plays a central role in our analysis . to see where it comes from , recall the divisible sandpile",
    "_ odometer function _ @xmath224 let @xmath122 be the domain of fully occupied sites for the divisible sandpile formed from a pile of mass @xmath123 at the origin . for @xmath225 ,",
    "since each neighbor @xmath40 of @xmath29 emits an equal amount of mass to each of its @xmath23 neighbors , we have @xmath226 moreover , @xmath227 on @xmath228 , where for @xmath229 we write @xmath230 for the boundary of @xmath9 . by construction",
    ", the function @xmath223 obeys the same laplacian condition : @xmath231 ; and as we will see shortly , @xmath232 on @xmath233 .",
    "since we expect the domain @xmath234 to be close to the ball @xmath235 , we should expect that @xmath236 .",
    "in fact , we will first show that @xmath237 is close to @xmath223 , and then use this to conclude that @xmath234 is close to @xmath235 .",
    "we will use the following estimates for the green s function @xcite ; see also ( * ? ? ?",
    "* theorems 1.5.4 and 1.6.2 ) .",
    "@xmath238    here @xmath239 , where @xmath118 is the volume of the unit ball in @xmath1 , and @xmath240 is a constant whose value we will not need to know . here and throughout this thesis , constants in error terms denoted @xmath241 depend only on @xmath115 .",
    "we will need an estimate for the function @xmath223 near the boundary of the ball @xmath235 .",
    "we first consider dimension @xmath41 . from ( [ standardgreensestimate ] )",
    "we have @xmath242 where @xmath243 in the taylor expansion of @xmath244 about @xmath245 @xmath246 the linear term vanishes , leaving @xmath247 for some @xmath81 between @xmath42 and @xmath2 . in dimensions",
    "@xmath59 , from ( [ standardgreensestimate ] ) we have @xmath248 setting @xmath249 , the linear term in the taylor expansion ( [ secondordertaylor ] ) of @xmath244 about @xmath245 again vanishes , yielding @xmath250 for @xmath81 between @xmath42 and @xmath2 . together with ( [ taylordim2 ] ) , this yields the following estimates in all dimensions @xmath251 .",
    "[ gammalowerbound ] let @xmath223 be given by ( [ subtractoffconstant ] ) .",
    "for all @xmath151 we have @xmath252    [ gammaupperbound ] let @xmath223 be given by ( [ subtractoffconstant ] ) .",
    "then uniformly in @xmath2 , @xmath253    the following lemma is useful for @xmath29 near the origin , where the error term in ( [ quadraticgrowtheq ] ) blows up .",
    "[ gammanearorigin ] let @xmath223 be given by ( [ subtractoffconstant ] ) .",
    "then for sufficiently large @xmath2 , we have @xmath254    since @xmath255 is superharmonic , it attains its minimum in @xmath256 at a point @xmath257 on the boundary .",
    "thus for any @xmath258 @xmath259 hence by lemma  [ gammalowerbound ] @xmath260    lemmas  [ gammalowerbound ] and  [ gammanearorigin ] together imply the following .",
    "[ gammanonnegativeeverywhere ] let @xmath223 be given by ( [ subtractoffconstant ] ) .",
    "there is a constant @xmath204 depending only on @xmath115 , such that @xmath261 everywhere .        in this section",
    "we prove the abelian property of the divisible sandpile mentioned in the introduction .",
    "we work in continuous time .",
    "fix @xmath262 , and let @xmath263 \\rightarrow \\z^d$ ] be a function having only finitely many discontinuities in the interval @xmath264 $ ] for every @xmath265 .",
    "the value @xmath266 represents the site being toppled at time @xmath81 .",
    "the odometer function at time @xmath81 is given by @xmath267\\right),\\ ] ] where @xmath150 denotes lebesgue measure .",
    "we will say that @xmath173 is a _ legal toppling function _ for an initial configuration @xmath268 if for every @xmath269 @xmath270 where @xmath271 is the amount of mass present at @xmath29 at time @xmath81 .",
    "if in addition @xmath272 , we say that @xmath173 is _",
    "complete_. the abelian property can now be stated as follows .    [ abelianproperty ] if @xmath273 \\rightarrow \\z^d$ ] and @xmath274 \\rightarrow \\z^d$ ] are complete legal toppling functions for an initial configuration @xmath268 , then for any @xmath151 @xmath275 in particular , @xmath276 and the final configurations @xmath277 , @xmath278 are identical .    for @xmath279 write @xmath280 \\right ) ; \\\\      & \\nu^i_t(x ) = \\nu_0(x ) + \\delta u^i_t(x ) .",
    "\\end{aligned}\\ ] ] write @xmath281 and @xmath282 .",
    "let @xmath283 and let @xmath284 be the points of discontinuity for @xmath285 .",
    "let @xmath286 be the value of @xmath285 on the interval @xmath287 .",
    "we will show by induction on @xmath199 that @xmath288 note that for any @xmath289 , if @xmath290 , then letting @xmath291 be maximal such that @xmath292 , since @xmath293 on the interval @xmath294 , it follows from the inductive hypothesis ( [ inductivehypothesis ] ) that @xmath295 since @xmath285 is legal and @xmath296 is complete , we have @xmath297 hence @xmath298 since @xmath285 is constant on the interval @xmath287 we obtain @xmath299 by ( [ strongerformofindhyp ] ) , each term in the sum on the right side is nonnegative , completing the inductive step .",
    "since @xmath300 as @xmath301 , the right side of ( [ strongerformofindhyp ] ) converges to @xmath302 as @xmath301 , hence @xmath303 . after interchanging the roles of @xmath285 and @xmath296 , the result follows .",
    "recall that a function @xmath304 on @xmath0 is _ superharmonic _ if @xmath305 .",
    "given a function @xmath48 on @xmath0 the _ least superharmonic majorant _ of @xmath48 is the function @xmath306 note that if @xmath307 is superharmonic and @xmath47 then @xmath308 taking the infimum on the left side we obtain that @xmath304 is superharmonic .",
    "[ discretemajorant ] let @xmath263 \\to \\z^d$ ] be a complete legal toppling function for the initial configuration @xmath268 , and let @xmath309 be the corresponding odometer function for the divisible sandpile .",
    "then @xmath310 , where @xmath311 and @xmath304 is the least superharmonic majorant of @xmath312 .    from ( [ laplacianofu_t ] )",
    "we have @xmath313 since @xmath314 , the difference @xmath315 is superharmonic . as @xmath237 is nonnegative",
    ", it follows that @xmath316 . for the reverse inequality , note that @xmath317 is superharmonic on the domain @xmath318 of fully occupied sites and is nonnegative outside @xmath51 ,",
    "hence nonnegative inside @xmath51 as well .",
    "we now turn to the case of a point source mass @xmath123 started at the origin : @xmath319 .",
    "more general starting densities are treated in chapter  [ scalinglimit ] . in the case of a point source of mass @xmath123 , the natural question is to identify the shape of the resulting domain @xmath234 of fully occupied sites , i.e.  sites @xmath29 for which @xmath320 . according to theorem  [ divsandcirc ] ,",
    "@xmath234 is extremely close to a ball of volume @xmath123 ; in fact , the error in the radius is a constant independent of @xmath123 .",
    "as before , for @xmath112 we write @xmath321 for the lattice ball of radius @xmath2 centered at the origin .",
    "[ divsandcirc ] for @xmath121 let @xmath122 be the domain of fully occupied sites for the divisible sandpile formed from a pile of size @xmath123 at the origin .",
    "there exist constants @xmath114 depending only on @xmath115 , such that @xmath124 where @xmath125 and @xmath118 is the volume of the unit ball in @xmath1 .",
    "the idea of the proof is to use lemma  [ discretemajorant ] along with the basic estimates on @xmath48 , lemmas  [ gammalowerbound ] and  [ gammaupperbound ] , to obtain estimates on the odometer function @xmath224 we will need the following simple observation .",
    "[ boundarypath ] for every point @xmath322 there is a path @xmath323 in @xmath234 with @xmath324 .    if @xmath325 , let @xmath326 be a neighbor of @xmath142 maximizing @xmath327 .",
    "then @xmath328 and @xmath329 where in the last step we have used the fact that @xmath330 .",
    "we first treat the inner estimate .",
    "let @xmath223 be given by ( [ subtractoffconstant ] ) . by lemma  [ discretemajorant ]",
    "the function @xmath331 is superharmonic , so its minimum in the ball @xmath235 is attained on the boundary .",
    "since @xmath332 , we have by lemma  [ gammaupperbound ] @xmath333 hence by lemma  [ gammalowerbound ] , @xmath334 it follows that there is a constant @xmath335 , depending only on @xmath115 , such that @xmath336 whenever @xmath337 .",
    "thus @xmath338 . for @xmath258 ,",
    "by lemma  [ gammanearorigin ] we have @xmath339 , hence @xmath340 .    for the outer estimate , note that @xmath331 is harmonic on @xmath234 . by lemma  [ gammanonnegativeeverywhere ]",
    "we have @xmath261 everywhere , where @xmath204 depends only on @xmath115 .",
    "since @xmath237 vanishes on @xmath228 it follows that @xmath341 on @xmath234 .",
    "now for any @xmath225 with @xmath342 , we have by lemma  [ gammaupperbound ] @xmath343 for a constant @xmath344 depending only on @xmath115 . lemma  [ boundarypath ] now implies that @xmath345 .",
    "we consider a generalization of the classical abelian sandpile , proposed by fey and redig @xcite .",
    "each site in @xmath0 begins with a `` hole '' of depth @xmath346 .",
    "thus , each site absorbs the first @xmath346 grains it receives , and thereafter functions normally , toppling once for each additional @xmath23 grains it receives .",
    "if @xmath346 is negative , we can interpret this as saying that every site starts with @xmath347 grains of sand already present .",
    "aggregation is only well - defined in the regime @xmath348 , since for @xmath349 the addition of a single grain already causes every site in @xmath0 to topple infinitely often .",
    "let @xmath350 be the set of sites that are visited if @xmath5 particles start at the origin in @xmath0 .",
    "fey and redig ( * ? ? ?",
    "* theorem  4.7 ) prove that @xmath351 where @xmath130 , and @xmath352 denotes symmetric difference .",
    "the following theorem strengthens this result .",
    "[ sandpilecirc ] fix an integer @xmath353 . let @xmath354 be the set of sites that are visited by the classical abelian sandpile model in @xmath0 , starting from @xmath5 particles at the origin , if every lattice site begins with a hole of depth @xmath346 .",
    ". then @xmath355 where @xmath356 and @xmath133 is a constant depending only on @xmath115 .",
    "moreover if @xmath357 , then for any @xmath72 we have @xmath358 where @xmath359 and @xmath134 is independent of @xmath5 but may depend on @xmath115 , @xmath346 and @xmath76 .",
    "note that the ratio @xmath360 as @xmath361 .",
    "thus , the classical abelian sandpile run from an initial state in which each lattice site starts with a deep hole yields a shape very close to a ball .",
    "intuitively , one can think of the classical sandpile with deep holes as approximating the divisible sandpile , whose limiting shape is a ball by theorem  [ divsandcirc ] . following this intuition",
    ", we can adapt the proof of theorem  [ divsandcirc ] to prove theorem  [ sandpilecirc ] ; just one additional averaging trick is needed , which we explain below .",
    "consider the odometer function for the abelian sandpile @xmath362 let @xmath363 be the set of sites which topple at least once .",
    "then @xmath364 in the final state , each site which has toppled retains between @xmath365 and @xmath366 grains , in addition to the @xmath346 that it absorbed .",
    "hence @xmath367 we can improve the lower bound by averaging over a small box . for @xmath151 let @xmath368 be the box of side length @xmath369 centered at @xmath29 , and",
    "let @xmath370 write @xmath371 le borgne and rossin @xcite observe that if @xmath173 is a set of sites all of which topple , the number of grains remaining in @xmath173 is at least the number of edges internal to @xmath173 : indeed , for each internal edge , the endpoint that topples last sends the other a grain which never moves again . since the box @xmath372 has @xmath373 internal edges , we have @xmath374 the following lemma is analogous to lemma  [ boundarypath ] .",
    "[ boundarypathology ] for every point @xmath375 adjacent to @xmath376 there is a path @xmath377 in @xmath187 with @xmath324 .",
    "by ( [ dumblaplbounds ] ) we have @xmath378 since @xmath379 , some term @xmath380 in the sum above must exceed @xmath381 .",
    "let @xmath382 .",
    "let @xmath383 and let @xmath384 taking @xmath385 in lemma  [ gammaupperbound ] , we have @xmath386 by ( [ dumblaplbounds ] ) , @xmath387 is superharmonic , so ( [ minattainedonboundary ] ) holds in all of @xmath388 .",
    "hence by lemma  [ gammalowerbound ] @xmath389 it follows that @xmath237 is positive on @xmath390 for a suitable constant @xmath133 .",
    "for @xmath391 , by lemma  [ gammanearorigin ] we have @xmath392 .",
    "thus @xmath393 .    for the outer estimate ,",
    "let @xmath394 choose @xmath199 large enough so that @xmath395 and define @xmath396 finally , let @xmath397 by ( [ averagedinabox ] ) , @xmath398 is subharmonic on @xmath399 .",
    "taking @xmath400 in lemma  [ gammanonnegativeeverywhere ] , there is a constant @xmath204 such that @xmath401 everywhere . since @xmath402 on @xmath403 it follows that @xmath404 on @xmath399 .",
    "now for any @xmath405 with @xmath406 we have by lemma  [ gammaupperbound ] @xmath407 for a constant @xmath408 depending only on @xmath115 , @xmath346 and @xmath76",
    ". then @xmath409 .",
    "lemma  [ boundarypathology ] now implies that @xmath410 , and hence @xmath411    we remark that the crude bound of @xmath412 used in the proof of the outer estimate can be improved to a bound of order @xmath413 , and the final factor of @xmath414 can be replaced by a constant factor independent of @xmath199 and @xmath346 , using the fact that a nonnegative function on @xmath0 with bounded laplacian can not grow faster than quadratically ; see lemma  [ atmostquadratic ]",
    ".      given a function @xmath307 on @xmath0 , for a directed edge @xmath415 write @xmath416 given a function @xmath304 on directed edges in @xmath0 , write @xmath417 the discrete laplacian of @xmath307 is then given by @xmath418      fixing @xmath419 , consider the odometer function for rotor - router aggregation @xmath420 we learned the idea of using the odometer function to study the rotor - router shape from matt cook @xcite .",
    "[ odomflow ] for a directed edge @xmath415 in @xmath0 , denote by @xmath421 the net number of crossings from @xmath29 to @xmath40 performed by the first @xmath5 particles in rotor - router aggregation .",
    "then @xmath422 for some edge function @xmath423 which satisfies @xmath424 for all edges @xmath415 .    in the more general",
    "setting of rotor stacks of bounded discrepancy , the @xmath425 will be replaced by a different constant here .",
    "writing @xmath426 for the number of particles routed from @xmath29 to @xmath40 , we have @xmath427 hence @xmath428    for the remainder of this section @xmath429 denote constants depending only on  @xmath115 .",
    "[ diameterbound ] let @xmath430 be a finite set .",
    "then @xmath431    let @xmath432 then @xmath433 since @xmath434 can intersect at most diam@xmath435 distinct sets @xmath436 , the proof is complete .",
    "[ letsgetthispartystarted ] let @xmath437 be the green s function for simple random walk in @xmath0 stopped on exiting @xmath235 .",
    "let @xmath438 with @xmath439 .",
    "then @xmath440    let @xmath441 denote simple random walk in @xmath0 , and let @xmath173 be the first exit time from @xmath235 . for fixed @xmath40 , the function",
    "@xmath442 has laplacian @xmath443 in @xmath235 and vanishes on @xmath233 , hence @xmath444 .",
    "let @xmath445 and @xmath446 . from ( [ standardgreensestimate ] )",
    "we have @xmath447 using the triangle inequality together with ( [ stoppedgreen ] ) , we obtain @xmath448 where @xmath449 .",
    ". then @xmath451 by lemma  [ diameterbound ] , the inner sum on the right is at most @xmath452diam@xmath453 , so the right side of ( [ twointegrals ] ) is bounded above by @xmath454 for a suitable @xmath455 .",
    "finally , the terms in which @xmath40 or @xmath257 coincides with @xmath29 make a negligible contribution to the sum in ( [ theparty ] ) , since for @xmath456 @xmath457    [ hitthehyperplane ] let @xmath458 be linear half - spaces in @xmath0 , not necessarily parallel to the coordinate axes .",
    "let @xmath459 be the first hitting time of @xmath460 .",
    "if @xmath461 , then @xmath462 where @xmath463 is the distance from @xmath29 to @xmath460 .    if one of @xmath458 contains the other , the result is vacuous",
    ". otherwise , let @xmath464 be the half - space shifted parallel to @xmath465 by distance @xmath466 in the direction of @xmath29 , and let @xmath467 be the first hitting time of @xmath468 .",
    "let @xmath441 denote simple random walk in @xmath0 , and write @xmath469 for the ( signed ) distance from @xmath470 to the hyperplane defining the boundary of @xmath471 , with @xmath472 .",
    "then @xmath469 is a martingale with bounded increments . since @xmath473",
    ", we obtain from optional stopping @xmath474 hence @xmath475 likewise , @xmath476 is a martingale with bounded increments , giving @xmath477    let @xmath478 . denoting by @xmath479 the distance from @xmath470 to the hyperplane defining the boundary of @xmath480 ,",
    "the quantity @xmath481 is a martingale .",
    "writing @xmath482 we have @xmath483 hence by ( [ timeupperbound ] ) @xmath484 finally by ( [ justgamblersruin ] ) @xmath485    [ geoshells ] let @xmath438 and let @xmath486 .",
    "let @xmath487 let @xmath488 be the first hitting time of @xmath489 , and @xmath173 the first exit time from @xmath235 .",
    "then @xmath490    let @xmath346 be the outer half - space tangent to @xmath235 at the point @xmath491 closest to @xmath29 .",
    "let @xmath492 be the cube of side length @xmath493 centered at @xmath29 .",
    "then @xmath492 is disjoint from @xmath489 , hence @xmath494 where @xmath495 and @xmath496 are the first hitting times of @xmath497 and @xmath346 .",
    "let @xmath498 be the outer half - spaces defining the faces of @xmath492 , so that @xmath499 .",
    "by lemma  [ hitthehyperplane ] we have @xmath500 since dist@xmath501 and dist@xmath502 , and @xmath503 , taking @xmath504 completes the proof .",
    "[ greengradbound ] let @xmath505 be the green s function for random walk stopped on exiting @xmath235 .",
    "let @xmath438 and let @xmath506 .",
    "then @xmath507    let @xmath489 be given by ( [ shells ] ) , and let @xmath508 let @xmath509 be the first hitting time of @xmath510 and @xmath173 the first exit time from @xmath235",
    ". for @xmath511 let @xmath512 fixing @xmath513 and @xmath514 , simple random walk started at @xmath29 must hit @xmath510 before hitting either @xmath40 or @xmath257 , hence @xmath515 for any @xmath516 we have @xmath517 and @xmath518 .",
    "lemma  [ letsgetthispartystarted ] yields @xmath519 by lemma  [ geoshells ] we have @xmath520 , so the above sum is at most @xmath521 .",
    "since the union of shells @xmath522 covers all of @xmath235 except for those points within distance @xmath523 of @xmath29 , and @xmath524 by lemma  [ letsgetthispartystarted ] , the result follows .",
    "let @xmath240 and @xmath423 be defined as in lemma [ odomflow ] . since the net number of particles to enter a site @xmath525 is at most one , we have @xmath526 .",
    "likewise @xmath527 . taking the divergence in ( [ gradodom ] )",
    ", we obtain @xmath528 let @xmath173 be the first exit time from @xmath235 , and define @xmath529 then @xmath530 for @xmath531 and @xmath532",
    ". moreover @xmath533 on @xmath233 .",
    "it follows from lemma  [ gammaupperbound ] with @xmath534 that @xmath535 on @xmath235 for a suitable constant @xmath536 .",
    "we have @xmath537 each summand on the right side is zero on the event @xmath538 , hence @xmath539 taking expectations and using ( [ laplodom ] ) and ( [ laplodomat0 ] ) , we obtain @xmath540 \\\\      & \\hspace{-0.25 in } = n\\ee_x \\ # \\{k < t | x_k = o \\ } - \\ee_x t -   \\sum_{k\\geq 0 } \\ee_x \\big [ 1_{\\{t > k\\ } }   \\div r(x_k ) \\big ] ,      \\end{aligned}\\ ] ] hence @xmath541.\\ ] ] since random walk exits @xmath235 with probability at least @xmath542 every time it reaches a site adjacent to the boundary @xmath233 , the expected time spent adjacent to the boundary before time @xmath173 is at most @xmath23 . since @xmath543 , the terms in ( [ sumofrs ] ) with @xmath544 contribute at most @xmath545 to the sum .",
    "thus @xmath546 - 8d^2.\\ ] ] for @xmath547 we have @xmath548 , hence @xmath549 write @xmath550 .",
    "note that since @xmath551 and @xmath240 are antisymmetric , @xmath423 is antisymmetric .",
    "thus @xmath552 summing over @xmath199 and using the fact that @xmath543 , we conclude from ( [ triplesum ] ) that @xmath553 where @xmath505 is the green s function for simple random walk stopped on exiting @xmath235 . by lemma  [ greengradbound ]",
    "we obtain @xmath554 using the fact that @xmath535 , we obtain from lemma  [ gammalowerbound ] @xmath555 the right side is positive provided @xmath556 . for @xmath557 , by lemma  [ gammanearorigin ] we have @xmath558 , hence @xmath559 .",
    "the following result is due to holroyd and propp ( unpublished ) ; we include a proof for the sake of completeness .",
    "notice that the bound in ( [ hpbound ] ) does not depend on the number of particles .",
    "[ hp ] let @xmath560 be a finite connected graph , and let @xmath561 be subsets of the vertex set of @xmath560 .",
    "let @xmath304 be a nonnegative integer - valued function on the vertices of @xmath560 .",
    "let @xmath562 be the expected number of particles stopping in @xmath563 if @xmath564 particles start at each vertex @xmath29 and perform independent simple random walks stopped on first hitting @xmath565 .",
    "let @xmath566 be the number of particles stopping in @xmath563 if @xmath564 particles start at each vertex @xmath29 and perform rotor - router walks stopped on first hitting @xmath565 .",
    "let @xmath567 .",
    "then @xmath568 independent of @xmath304 and the initial positions of the rotors .    for each vertex @xmath237",
    ", arbitrarily choose a neighbor @xmath569 .",
    "order the neighbors @xmath570 of @xmath237 so that the rotor at @xmath237 points to @xmath571 immediately after pointing to @xmath572 ( indices mod @xmath115 ) .",
    "we assign _ weight _ @xmath573 to a rotor pointing from @xmath237 to @xmath569 , and weight @xmath574 to a rotor pointing from @xmath237 to @xmath572 .",
    "these assignments are consistent since @xmath346 is a harmonic function : @xmath575 .",
    "we also assign weight @xmath576 to a particle located at @xmath237 .",
    "the sum of rotor and particle weights in any configuration is invariant under the operation of routing a particle and rotating the corresponding rotor .",
    "initially , the sum of all particle weights is @xmath562 .",
    "after all particles have stopped , the sum of the particle weights is @xmath566 .",
    "their difference is thus at most the change in rotor weights , which is bounded above by the sum in ( [ hpbound ] )",
    ".    for @xmath577 let @xmath578 then @xmath579 note that for simple random walk started in @xmath580 , the first exit time of @xmath580 and first hitting time of @xmath581 coincide .",
    "our next result is a modification of lemma  5(b ) of @xcite .",
    "[ inthezone ] fix @xmath503 and @xmath582 . for @xmath583",
    "let @xmath584 , where @xmath173 is the first hitting time of @xmath581 .",
    "then @xmath585 for a constant j depending only on @xmath115 .",
    "we induct on the distance @xmath586 , assuming the result holds for all @xmath587 with @xmath588 ; the base case can be made trivial by choosing @xmath589 sufficiently large . by lemma  5(b ) of @xcite , we can choose @xmath589 large enough so that the result holds provided @xmath590 .",
    "otherwise , let @xmath471 be the outer half - space tangent to @xmath591 at the point of @xmath591 closest to @xmath29 , and let @xmath480 be the inner half - space tangent to the ball @xmath592 of radius @xmath593 about @xmath40 , at the point of @xmath592 closest to @xmath29 .",
    "by lemma  [ hitthehyperplane ] applied to these half - spaces , the probability that random walk started at @xmath29 reaches @xmath592 before hitting @xmath581 is at most @xmath594 .",
    "writing @xmath595 for the first hitting time of @xmath596 , we have @xmath597 where we have used the inductive hypothesis to bound @xmath598 .",
    "the _ lazy _ random walk in @xmath0 stays in place with probability @xmath599 , and moves to each of the @xmath23 neighbors with probability @xmath600 .",
    "we will need the following standard result , which can be derived e.g.  from the estimates in @xcite , section ii.12 ; we include a proof for the sake of completeness .",
    "[ lazycoupling ] given @xmath601 , lazy random walks started at @xmath237 and @xmath181 can be coupled with probability @xmath602 before either reaches distance @xmath423 from @xmath237 , where @xmath603 depends only on @xmath115 .",
    "let @xmath604 be the coordinate such that @xmath605 . to define a step of the coupling , choose one of the @xmath115 coordinates uniformly at random .",
    "if the chosen coordinate is different from @xmath604 , let the two walks take the same lazy step so that they still agree in this coordinate .",
    "if the chosen coordinate is @xmath604 , let one walk take a step while the other stays in place . with probability @xmath599 the walks",
    "will then be coupled . otherwise , they are located at points @xmath606 with @xmath607 . moreover , @xmath608 for a constant @xmath609 depending only on @xmath115 . from now on , whenever coordinate @xmath604 is chosen , let the two walks take lazy steps in opposite directions .",
    "let @xmath610 be the hyperplane bisecting the segment @xmath611 $ ] . since the steps of one walk are reflections in @xmath471 of the steps of the other , the walks couple when they hit @xmath471 .",
    "let @xmath492 be the cube of side length @xmath612 centered at @xmath237 , and let @xmath480 be a hyperplane defining one of the faces of @xmath492 . by lemma  [ hitthehyperplane ] with @xmath613 and @xmath614 , the probability that one of the walks exits @xmath492 before the walks couple is at most @xmath615 .",
    "[ harmonicmeasuregrad ] with @xmath346 defined as in lemma  _ [ inthezone ] _ ,",
    "we have @xmath616 for a constant @xmath617 depending only on @xmath115 .    given @xmath618 and @xmath619 , by lemma  [ lazycoupling ] , lazy random walks started at @xmath237 and @xmath181 can be coupled with probability @xmath620 before either reaches distance @xmath621 from @xmath237 .",
    "if the walks reach this distance without coupling , by lemma  [ inthezone ] each has still has probability at most @xmath622 of exiting @xmath580 at @xmath40 . by the strong markov property it follows that @xmath623 summing in spherical shells about @xmath40",
    ", we obtain @xmath624    we remark that lemma  [ harmonicmeasuregrad ] could also be inferred from lemma  [ inthezone ] using ( * ? ? ?",
    "1.7.1 ) in a ball of radius @xmath621 about @xmath237 .",
    "fix integers @xmath625 , @xmath626 . in the setting of proposition  [ hp ] ,",
    "let @xmath186 be the lattice ball @xmath627 , and let @xmath628 .",
    "fix @xmath629 and let @xmath630 . for @xmath631",
    "let @xmath564 be the number of particles stopped at @xmath29 if all particles in rotor - router aggregation are stopped upon reaching @xmath581 .",
    "write @xmath632 where @xmath173 is the first hitting time of @xmath633 . by lemma  [ inthezone ]",
    "we have @xmath634 where @xmath635 is the number of particles that ever visit the shell @xmath581 in the course of rotor - router aggregation .    by lemma  [ harmonicmeasuregrad ]",
    "the sum in ( [ hpbound ] ) is at most @xmath636 , hence from propositon  [ hp ] and ( [ h_wbound ] ) we have @xmath637 let @xmath638 , and define @xmath639 inductively by @xmath640 fixing @xmath641 , we have @xmath642 so ( [ tinyrrs ] ) with @xmath643 simplifies to @xmath644 where @xmath645 .    since all particles that visit @xmath646 during rotor - router aggregation must pass through @xmath647 ,",
    "we have @xmath648 let @xmath649 .",
    "there are at most @xmath650 nonzero terms in the sum on the right side of ( [ alltermsaresmall ] ) , and each term is bounded above by ( [ eventinierrrs ] ) , hence @xmath651 where the second inequality follows from @xmath652 . summing over @xmath129 , we obtain @xmath653 the left side is at most @xmath654 , hence @xmath655 provided @xmath656 .",
    "thus the minimum in ( [ doublemin ] ) is not attained by its first argument .",
    "it follows that @xmath657 , hence @xmath658 for a sufficiently large constant @xmath204 .    by the inner estimate , since the ball @xmath659 is entirely occupied , we have @xmath660 write @xmath661 ; by ( [ lotsavolume ] ) we have @xmath662 by jensen s inequality , subject to this constraint , @xmath663 is maximized when all @xmath142 are equal , in which case @xmath664 and @xmath665 since @xmath666 we have @xmath667 ; that is , no particles reach the shell @xmath668 .",
    "taking @xmath669 , we obtain from ( [ outershellbound ] ) @xmath670",
    "this chapter is devoted to proving theorems  [ intromain ] , [ dfsum ] and  [ multiplepointsources ] .",
    "the proofs use many ideas from potential theory , and the relevant background is developed in section  [ potentialtheorybackground ] .",
    "the proof of theorem  [ intromain ] is broken into three sections , one for each of the three aggregation models .",
    "of the three models the divisible sandpile is the most straightforward and is treated in section  [ divsandscalinglimit ] .",
    "the rotor - router model and internal dla are treated in sections  [ rotorscalinglimit ] and  [ idlascalinglimit ] , respectively . finally ,",
    "in section  [ multiplesources ] we deduce theorem  [ multiplepointsources ] for multiple point sources from theorem  [ dfsum ] along with our results for single point sources .      in this section",
    "we review the basic properties of superharmonic potentials and of the least superharmonic majorant . for more background on potential theory in general , we refer the reader to @xcite ; for the obstacle problem in particular , see @xcite .      since we will often be working with functions on @xmath1 which may not be twice differentiable , it is desirable to define superharmonicity without making reference to the laplacian",
    ". instead we use the mean value property .",
    "a function @xmath237 on an open set @xmath82 is _ superharmonic _ if it is lower - semicontinuous and for any ball @xmath671 @xmath672 here @xmath118 is the volume of the unit ball in @xmath1 .",
    "we say that @xmath237 is subharmonic if @xmath673 is superharmonic , and harmonic if it is both super- and subharmonic .        1 .   @xmath237 attains its minimum in @xmath674 on the boundary .",
    "2 .   if @xmath129 is harmonic on @xmath434 and @xmath675 on @xmath676 , then @xmath677 .",
    "3 .   if @xmath678 , then @xmath679 4 .   if @xmath237 is twice differentiable on @xmath434 , then @xmath680 on @xmath434 . 5 .",
    "if @xmath681 is an open ball , and @xmath181 is a function on @xmath434 which is harmonic on @xmath10 , continuous on @xmath682 , and agrees with @xmath237 on @xmath683 , then @xmath181 is superharmonic .    given a function @xmath48 on @xmath1 which is bounded above , the _ least superharmonic majorant _ of @xmath48 ( also called the solution to the obstacle problem with obstacle @xmath48 ) is the function @xmath684 note that since @xmath48 is bounded above , the infimum is taken over a nonempty set .",
    "\\(i ) let @xmath47 be continuous and superharmonic",
    ". then @xmath686 . by the mean value property ( [ meanvalueproperty ] ) ,",
    "we have @xmath687 taking the infimum over @xmath307 on the left side , we conclude that @xmath688 .",
    "it remains to show that @xmath304 is lower - semicontinuous .",
    "let @xmath689 since @xmath690 the function @xmath691 is continuous , superharmonic , and lies above @xmath48 , so @xmath692 since @xmath48 is uniformly continuous , we have @xmath693 as @xmath694 , hence @xmath695 as @xmath694 .",
    "moreover if @xmath696 , then by lemma  [ basicproperties](iii ) @xmath697 thus @xmath304 is an increasing limit of continuous functions and hence lower - semicontinuous .",
    "\\(iii ) given @xmath698 , write @xmath699 . choose @xmath700 small enough so that for all @xmath701 @xmath702 let @xmath307 be the continuous function which is harmonic in @xmath10 and agrees with @xmath304 outside @xmath10 . by lemma  [ basicproperties](v ) , @xmath307 is superharmonic . by lemma  [ basicproperties](i ) ,",
    "@xmath307 attains its minimum in @xmath703 at a point @xmath704 , hence for @xmath705 @xmath706 it follows that @xmath707 everywhere , hence @xmath686 . from lemma  [ basicproperties](ii )",
    "we conclude that @xmath708 , and hence @xmath304 is harmonic at @xmath29 .",
    "next we describe the particular class of obstacles which relate to the aggregation models we are studying . for a bounded measurable function @xmath52 on @xmath1 with compact support , write @xmath709 where @xmath710 here @xmath239 , where @xmath118 is the volume of the unit ball in @xmath1 .",
    "note that ( [ greenskernel ] ) differs by a factor of @xmath23 from the standard harmonic potential in @xmath1 ; however , the normalization we have chosen is most convenient when working with the discrete laplacian and random walk .          regarding ( ii ) ,",
    "if we remove the smoothness assumption on @xmath52 , equation ( [ laplacianofpotential ] ) remains true in the sense of distributions .",
    "for our applications , however , we will not need this fact , and the following lemma will suffice .            fix a bounded nonnegative function @xmath52 on @xmath1 with compact support , and let @xmath723 let @xmath724 be the least superharmonic majorant of @xmath48 , and let @xmath725 be the noncoincidence set .",
    "\\(ii ) let @xmath730 be a ball containing the support of @xmath52 . by ( [ ballpotential ] ) and ( [ ballpotentialdim2 ] ) , for @xmath731 we have @xmath732 where @xmath733 and @xmath734 for @xmath59 .",
    "hence for @xmath731 we have @xmath735 since @xmath736 on @xmath434 , by lemma  [ superharmonicpotential ] the function @xmath737 is superharmonic in @xmath738 .",
    "since this holds for all sufficiently large @xmath423 , it follows that @xmath737 is superharmonic on all of @xmath434 .",
    "\\(ii ) with @xmath743 defined by ( [ meanvalueproperty ] ) , we have @xmath744 by lemma  [ laplacianofobstacle ]",
    "we have @xmath745 since @xmath746 is continuous and superharmonic , it follows that @xmath747 , hence @xmath748 thus @xmath749 is subharmonic on @xmath1 , and hence by lemma  [ laplacianofobstacle](ii ) the function @xmath750 is subharmonic on @xmath434 .        if @xmath755 in a ball @xmath756 , by ( [ ballpotential ] ) and ( [ ballpotentialdim2 ] ) , for @xmath705 we have @xmath757 by lemma  [ superharmonicpotential ] it follows that @xmath48 is subharmonic in @xmath10 .",
    "in particular , @xmath758 in @xmath10 , so @xmath698 .",
    "[ monotonicity ] let @xmath759 be functions on @xmath1 with compact support , and suppose that @xmath760 .",
    "let @xmath761 let @xmath762 be the least superharmonic majorant of @xmath763 , let @xmath764 , and let @xmath765 then @xmath766 and @xmath767 .",
    "let @xmath307 be any continuous function which is superharmonic on @xmath434 and @xmath779 .",
    "by lemma  [ majorantbasicprops](iii ) , @xmath304 is harmonic on @xmath51 , so @xmath780 is superharmonic on @xmath51 and attains its minimum in @xmath781 on the boundary .",
    "hence @xmath780 attains its minimum in @xmath782 at a point @xmath29 where @xmath783 . since @xmath47",
    "we conclude that @xmath686 on @xmath434 and hence everywhere .",
    "thus @xmath304 is at most the infimum in ( [ majorantinadomain ] ) . since the infimum in ( [ majorantinadomain ] )",
    "is taken over a strictly larger set than that in ( [ themajorant ] ) , the reverse inequality is trivial .",
    "next we turn to the regularity of the solution to the obstacle problem ( [ themajorant ] ) and of the free boundary @xmath784 .",
    "there is a substantial literature on boundary regularity for the obstacle problem . in our setup , however , extra care must be taken near points where @xmath785 : at these points the obstacle ( [ theobstacle ] ) is harmonic , and the free boundary can be badly behaved .",
    "we show only the minimal amount of regularity required for the proofs of our main theorems .",
    "much stronger regularity results are known in related settings ; see , for example , @xcite .",
    "the following lemma shows that if the obstacle is sufficiently smooth , then the superharmonic majorant can not separate too quickly from the obstacle near the boundary of the noncoincidence set . for the proof ,",
    "we follow the sketch in caffarelli ( * ? ? ?",
    "* theorem 2 ) . as usual , we write @xmath786 for the inner @xmath76-neighborhood of @xmath51 , given by ( [ innerepsilonneighborhood ] )    [ smoothdensity ] let @xmath52 be a @xmath712 function on @xmath1 with compact support .",
    "let @xmath776 be given by ( [ theobstacle])-([thenoncoincidenceset ] ) , and write @xmath787 .",
    "then @xmath237 is @xmath712 , and for @xmath788 we have @xmath789 , for a constant @xmath790 depending on @xmath52 .",
    "fix @xmath791 , and define @xmath792 since @xmath52 is @xmath712 , we have that @xmath48 is @xmath713 by lemma  [ smoothnessofpotential](ii ) .",
    "let @xmath9 be the maximum second partial of @xmath48 in the ball @xmath793 . by the mean value theorem and cauchy - schwarz , for @xmath731",
    "we have @xmath794 where @xmath795 .",
    "hence @xmath796 thus the function @xmath797 is nonnegative and superharmonic in @xmath10 .",
    "write @xmath798 , where @xmath799 is harmonic and equal to @xmath182 on @xmath800",
    ". then since @xmath801 , we have @xmath802 by the harnack inequality , it follows that @xmath803 on the ball @xmath804 , for a suitable constant @xmath344 .",
    "since @xmath805 is nonnegative and vanishes on @xmath800 , it attains its maximum in @xmath682 at a point @xmath806 in the support of its laplacian .",
    "since @xmath807 , by lemma  [ majorantbasicprops](iii ) we have @xmath808 , hence @xmath809 where in the last step we have used ( [ secondordererror ] ) .",
    "we conclude that @xmath810 on @xmath811 and hence @xmath812 on @xmath811 .",
    "thus on @xmath811 we have @xmath813 in particular , @xmath237 is differentiable at @xmath814 , and @xmath815 .",
    "since @xmath304 is harmonic in @xmath51 and equal to @xmath48 outside @xmath51 , it follows that @xmath237 is differentiable everywhere , and @xmath712 off @xmath784 .    given @xmath788 ,",
    "let @xmath814 be the closest point in @xmath784 to @xmath40 .",
    "since @xmath816 , by lemma  [ majorantbasicprops](iii ) the function @xmath182 is harmonic on @xmath817 , so by the cauchy estimate ( * ? ?",
    "* theorem 2.4 ) we have @xmath818 since @xmath819 , the right side of ( [ fromcauchyest ] ) is at most @xmath820 , hence @xmath821 where @xmath822 .",
    "thus @xmath237 is @xmath712 on @xmath784 as well .",
    "next we show that mass is conserved in our model : the amount of mass starting in @xmath51 is @xmath823 , while the amount of mass ending in @xmath51 is @xmath824 , the lebesgue measure of @xmath51 . since no mass moves outside of @xmath51",
    ", we expect these to be equal .",
    "although this seems intuitively obvious , the proof takes some work because we have no _ a priori _ control of the domain @xmath51 . in particular , we first need to show that the boundary of @xmath51 can not have positive @xmath115-dimensional lebesgue measure .",
    "to prove the first part of proposition  [ boundaryregularitysmooth ] , given a boundary point @xmath834 , the idea is first to find a point @xmath40 in the ball @xmath835 where @xmath739 is relatively large , and then to argue using lemma  [ smoothdensity ] that a ball @xmath836 must be entirely contained in @xmath51 .",
    "taking @xmath837 in the lebesgue density theorem , we obtain that @xmath838 .",
    "the proof of the second part of proposition  [ boundaryregularitysmooth ] uses green s theorem in the form @xmath839 here @xmath840 is the union of boxes @xmath841 that are contained in @xmath51 , and @xmath842 is the volume measure in @xmath840 , while @xmath843 is the @xmath844-dimensional surface measure on @xmath845 .",
    "the partial derivatives on the right side of ( [ greensidentity ] ) are in the outward normal direction from @xmath845 .",
    "\\(i ) fix @xmath846 . for @xmath834 with @xmath847 , for small enough @xmath76 we have @xmath848 on @xmath835 . by lemma",
    "[ laplacianofobstacle](ii ) the function @xmath849 is superharmonic on @xmath850 , so by lemma  [ majorantbasicprops](iii )",
    "the function @xmath851 is subharmonic on @xmath850 . since @xmath852",
    ", its maximum is not attained on @xmath784 , so it must be attained on @xmath853 , so there is a point @xmath40 with @xmath854 and @xmath855    by lemma  [ smoothdensity ] we have @xmath856 in the ball @xmath836 .",
    "taking @xmath857 , we obtain for @xmath858 @xmath859 thus for any @xmath860 @xmath861 by the lebesgue density theorem it follows that @xmath862 by lemma  [ startingdensitygreaterthan1 ] we have @xmath863 on @xmath784 .",
    "taking @xmath864 in ( [ fromthedensitytheorem ] ) , we obtain @xmath865    \\(ii ) fix @xmath866 and let @xmath867 where @xmath868^d$ ] . by lemmas  [ majorantbasicprops](iii ) and  [ smoothnessofpotential](ii ) , in @xmath840 we have @xmath869 now by green s theorem ( [ greensidentity ] ) , since @xmath237 is nonnegative and @xmath129 is superharmonic , @xmath870 where @xmath871 denotes the unit outward normal vector to @xmath845 . by lemma  [ smoothdensity ] , the integral on the right side",
    "is bounded by @xmath872 where @xmath873 denotes @xmath844-dimensional lebesgue measure .",
    "let @xmath874 since @xmath875 , given @xmath72 we can choose @xmath700 small enough so that @xmath876 .",
    "since @xmath877 , we have @xmath878 since @xmath51 is open , @xmath879 as @xmath880 .",
    "taking @xmath881 smaller if necessary so that @xmath882 , we obtain from ( [ greensthm ] ) and ( [ surfaceintegral ] ) @xmath883 where @xmath884 is the maximum of @xmath885 .",
    "since this holds for any @xmath72 , we conclude that @xmath886 .",
    "we will need a version of proposition  [ boundaryregularitysmooth ] which does not assume that @xmath52 is @xmath712 or even continuous .",
    "we can replace the @xmath712 assumption and the condition that @xmath825 by the following condition .",
    "@xmath887 for a constant @xmath888 .",
    "then we have the following result .",
    "[ boundaryregularity ] let @xmath52 be a bounded function on @xmath1 with compact support .",
    "let @xmath51 be given by ( [ thenoncoincidenceset ] ) , and let @xmath889 . if @xmath52 is continuous almost everywhere and satisfies ( [ boundedawayfrom1again ] ) , then          \\(i ) fix @xmath72 . since @xmath52 is continuous almost everywhere , there exist @xmath712 functions @xmath895 with @xmath896 .",
    "scaling by a factor of @xmath897 for sufficiently small @xmath700 , we can ensure that @xmath898 , so that @xmath899 and @xmath900 satisfy the hypotheses of proposition  [ boundaryregularitysmooth ] .",
    "for @xmath901 let @xmath902 and let @xmath762 be the least superharmonic majorant of @xmath763 .",
    "choose @xmath903 with @xmath904 such that @xmath905 for @xmath901 , and write @xmath906 by ( [ boundedawayfrom1again ] ) we have @xmath907 , hence by lemma  [ monotonicity ] @xmath908 for @xmath901 write @xmath909 by proposition  [ boundaryregularitysmooth](ii ) with @xmath830 , we have @xmath910 for @xmath911 , we have @xmath912 since @xmath913 on @xmath914 , the first term is bounded by @xmath915 where the equality in the middle step follows from ( [ conservation ] ) .    by proposition  [ boundaryregularitysmooth](i )",
    "we have @xmath916 , hence @xmath917 .",
    "taking @xmath918 we obtain from ( [ leftsqueeze ] ) , ( [ rightsqueeze ] ) , and ( [ thisissmall ] ) @xmath919 since this holds for any @xmath72 , the result follows .",
    "( ii ) write @xmath920 from ( [ conservation ] ) we have @xmath921 the left and right side differ by at most @xmath76 . since @xmath922 , and @xmath72 is arbitrary , it follows that @xmath923 , hence @xmath924",
    "\\(iii ) by lemma  [ startingdensitygreaterthan1 ] , if @xmath925 and @xmath926 , then @xmath52 is discontinuous at  @xmath29 . thus @xmath927 almost everywhere on @xmath928 , and we obtain from ( [ conservationind ] ) @xmath929    our next lemma describes the domain resulting from starting mass @xmath930 on a ball in @xmath1 . not surprisingly , the result is another ball , concentric with the original , of @xmath123 times the volume .",
    "in particular , if @xmath123 is an integer , the @xmath123-fold smash sum of a ball with itself is again a ball .      since @xmath933 is spherically symmetric and the least superharmonic majorant commutes with rotations , @xmath51 is a ball centered at the origin . by proposition  [ boundaryregularity](ii )",
    "we have @xmath934 .            in broad outline , many of our arguments have the following basic structure : @xmath938 an appropriate convergence of starting densities is built into the hypotheses of the theorems . from these hypotheses we use green s function estimates to deduce the relevant convergence of obstacles .",
    "next , as we have already seen in lemmas  [ laplacianofobstacle ] and  [ laplacianofodometer ] , properties of the obstacle can often be parlayed into corresponding properties of the least superharmonic majorant .",
    "finally , deducing convergence of domains ( i.e. , noncoincidence sets ) from the convergence of the majorants often requires additional regularity assumptions .",
    "the following lemma illustrates this basic three - step approach .",
    "[ threesteps ] let @xmath52 and @xmath93 , @xmath939 be densities on @xmath1 satisfying @xmath940 for a constant @xmath884 and ball @xmath730 .",
    "suppose that @xmath52 is continuous except on a set of lebesgue measure zero , and that @xmath941 as @xmath942 , for all continuity points @xmath29 of @xmath52",
    ". then    1 .",
    "@xmath943 uniformly on compact subsets of @xmath1 .",
    "@xmath944 uniformly on compact subsets of @xmath1 , where @xmath945 are the least superharmonic majorants of the functions @xmath946 , and @xmath947 , respectively .",
    "3 .   for any @xmath72",
    "we have @xmath948 for all sufficiently large @xmath5 , where @xmath949 are the noncoincidence sets @xmath950 and @xmath951 , respectively .",
    "\\(i ) since @xmath952 are supported on @xmath10 , we have @xmath953 fix @xmath954 .",
    "since @xmath955 , we have by ( [ ballpotential ] ) and ( [ ballpotentialdim2 ] ) @xmath956 now let @xmath957 and @xmath958 then by ( [ convergingdensitiescontinuum ] ) @xmath959 where @xmath960 is the set of discontinuities of @xmath52 .",
    "as @xmath961 and the sets @xmath962 are monotone increasing in @xmath963 , we can choose @xmath963 large enough so that @xmath964 given @xmath965 , for @xmath966 we have @xmath967 splitting the right side of ( [ triangleineq ] ) into separate integrals over @xmath835 , @xmath103 , and @xmath968 , we obtain @xmath969    \\(ii ) by lemmas  [ monotonicity ] and  [ relaxingaball ] , the noncoincidence sets @xmath949 are contained in the ball @xmath970 .",
    "given @xmath72 and a compact set @xmath971 containing @xmath166 , choose @xmath963 large enough so that @xmath972 on @xmath971 for all @xmath965 .",
    "then @xmath973 on @xmath971 , so the function @xmath974 max@xmath975 is superharmonic on @xmath971 . by lemma  [ majorantonacompactset ]",
    "we have @xmath976 , and hence @xmath977 on @xmath971 .",
    "likewise @xmath978 on @xmath971 , so the function @xmath979 max@xmath980 is superharmonic on @xmath971 . by lemma  [ majorantonacompactset ]",
    "we have @xmath981 and hence @xmath982 on @xmath971 .",
    "thus @xmath944 uniformly on @xmath971 .",
    "\\(iii ) let @xmath983 be the minimum value of @xmath936 on @xmath984 , and choose @xmath963 large enough so that @xmath985 on @xmath781 for all @xmath986 .",
    "then @xmath987 on @xmath786 , hence @xmath948 for all @xmath986 .",
    "consider the functions @xmath994 by hypothesis , @xmath995 is subharmonic and @xmath996 is superharmonic on @xmath992 . given @xmath997 , let @xmath998 min@xmath999 , and let @xmath1000 be the harmonic function on the ball @xmath1001 which agrees with @xmath1002 on @xmath800",
    ". then @xmath1003 by the harnack inequality ( * ? ? ?",
    "* theorem 1.7.2 ) there is a constant @xmath1004 such that @xmath1005 since @xmath1006 we have from ( [ f_+upperbound ] ) @xmath1007 hence @xmath1008 with @xmath1009 .",
    "the following continuous version of lemma  [ atmostquadratic ] is proved in the same way , using the continuous harnack inequality in place of the discrete one , and replacing @xmath1010 by @xmath1011 in ( [ quadraticcorrection ] ) .    [ continuumatmostquadratic ] fix @xmath988 .",
    "there is a constant @xmath1012 such that the following holds .",
    "let @xmath307 be a nonnegative function on @xmath1 with @xmath990 , and let @xmath1013 if @xmath995 is subharmonic and @xmath996 is superharmonic in @xmath992 , then @xmath1014        let @xmath971 be the closure of @xmath1018 , and let @xmath1019 . since @xmath971 is contained in @xmath1020 , the sets @xmath1021 form an open cover of @xmath971 , which has a finite subcover , i.e.  @xmath1022 for some @xmath5 .",
    "simulations indicate a regular polygon with some rounding at the corners ; it remains unclear if the rounded portions of the boundary become negligible in the limit .",
    "if the limiting shape is not a polygon , it would still be very interesting to establish the weaker statement that it has the dihedral symmetry @xmath1025 .",
    "the only case that is even partly solved is @xmath1026 : fey and redig @xcite prove that @xmath1027 is a cube in @xmath0 , but the growth rate of the cube is still not known .",
    "it would be of interest to show that the volume of the cube @xmath1027 is of order @xmath5 .",
    "p. koosis , la plus petite majorante surharmonique et son rapport avec lexistence des fonctions entires de type exponentiel jouant le rle de multiplicateurs , _ ann .",
    "fourier ( grenoble ) _ * 33 * ( 1983 ) , fasc .  1 , 67107 ."
  ],
  "abstract_text": [
    "<S> we study the scaling limits of three different aggregation models on @xmath0 : internal dla , in which particles perform random walks until reaching an unoccupied site ; the rotor - router model , in which particles perform deterministic analogues of random walks ; and the divisible sandpile , in which each site distributes its excess mass equally among its neighbors . as the lattice spacing tends to zero , all three models are found to have the same scaling limit , which we describe as the solution to a certain pde free boundary problem in @xmath1 . in particular </S>",
    "<S> , internal dla has a deterministic scaling limit . </S>",
    "<S> we find that the scaling limits are quadrature domains , which have arisen independently in many fields such as potential theory and fluid dynamics . </S>",
    "<S> our results apply both to the case of multiple point sources and to the diaconis - fulton smash sum of domains .    in the special case </S>",
    "<S> when all particles start at a single site , we show that the scaling limit is a euclidean ball in @xmath1 and give quantitative bounds on the rate of convergence to a ball . for the divisible sandpile , </S>",
    "<S> the error in the radius is bounded by a constant independent of the total starting mass . for the rotor - router model in @xmath0 , </S>",
    "<S> the inner error grows at most logarithmically in the radius @xmath2 , while the outer error is at most order @xmath3 . </S>",
    "<S> we also improve on the previously best known bounds of le borgne and rossin in @xmath4 and fey and redig in higher dimensions for the shape of the classical abelian sandpile model .    </S>",
    "<S> lastly , we study the sandpile group of a regular tree whose leaves are collapsed to a single sink vertex , and determine the decomposition of the full sandpile group as a product of cyclic groups . </S>",
    "<S> for the regular ternary tree of height @xmath5 , for example , the sandpile group is isomorphic to @xmath6 . </S>",
    "<S> we use this result to prove that rotor - router aggregation on the regular tree yields a perfect ball .    </S>",
    "<S> = 1     +   +   +   +   +    to my parents , lance and terri .    </S>",
    "<S> this work would not have been possible without the incredible support and insight of my advisor , yuval peres . </S>",
    "<S> yuval taught me not only a lot of mathematics , but also the tools , techniques , instincts and heuristics essential to the working mathematician . </S>",
    "<S> somehow , he even managed to teach me a little bit about life as well . </S>",
    "<S> my entire philosophy and approach , and my sense of what is important in mathematics , are colored by his ideas .    </S>",
    "<S> i would like to thank jim propp for introducing me to this beautiful area of mathematics , and for many inspiring conversations over the years . </S>",
    "<S> thanks also to scott armstrong , henry cohn , darren crowdy , craig evans , anne fey , chris hillar , wilfried huss , itamar landau , karola mszros , chandra nair , david pokorny , oded schramm , scott sheffield , misha sodin , kate stange , richard stanley , parran vanniasegaram , grace wang , and david wilson for many helpful conversations . </S>",
    "<S> richard liang taught me how to write image files using c , so that i could write programs to generate many of the figures . </S>",
    "<S> in addition , itamar landau and yelena shvets helped create several of the figures .    </S>",
    "<S> i also thank the nsf for supporting me with a graduate research fellowship during much of the time period when this work was carried out .    </S>",
    "<S> finally , i would like to thank my family and friends for supporting me and believing in me through the best and worst of times . </S>",
    "<S> your love and support mean more to me than i can possibly express in words . </S>"
  ]
}