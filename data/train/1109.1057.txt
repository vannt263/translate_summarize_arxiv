{
  "article_text": [
    "the wide applications of partial differential equations ( pdes ) in computer vision and image processing can be attributable to two main factors @xcite .",
    "first , pdes in classical mathematical physics are powerful tools to describe , model , and simulate many dynamics such as heat flow , diffusion , and wave propagation .",
    "second , many variational problems or their regularized counterparts can often be effectively solved from their euler - lagrange equations .",
    "therefore , in general there are two types of methods for designing pdes for vision tasks .",
    "for the first kind of methods , pdes are written down directly ( e.g. , anisotropic diffusion @xcite , shock filter @xcite , based on some understandings on the properties of mathematical operators and the physical natures of the problems , and curve - evolution - based equations @xcite ) .",
    "the second kind of methods basically define an energy functional and then derive the evolution equations by computing the euler - lagrange equation of the energy functional ( e.g. , total - variation - based variational methods @xcite@xcite@xcite ) . in either way , people have to heavily rely on their intuition on the vision tasks . therefore , traditional pde - based methods require good mathematical skills when choosing appropriate pde forms and predicting the final effect of composing related operators such that the obtained pdes roughly meet the goals .",
    "if people do not have enough intuition on a vision task , they may have difficulty in acquiring effective pdes .",
    "for example , although there has been much work on pde - based image segmentation @xcite@xcite@xcite@xcite , the basic philosophy is always to follow the strong edges in the image and also require the edge contour to be smooth .",
    "can we have a pde system for objective detection ( fig .",
    "[ fig : intro ] ) that locates the object region if the object is present and does not respond if the object is absent ?",
    "we believe that this is a big challenge to human intuition and is much more difficult than traditional segmentation tasks if a pde - based method is required , because it is hard to describe an object class , which may have significant variation in shape , texture and pose . without using additional information to judge the content ,",
    "the existing pdes for segmentation , e.g. , @xcite , always output an `` object region '' for any non - constant image . in short ,",
    "current pde design methods greatly limit the applications of pdes to a wider and more complex scope .",
    "this motivates us to explore whether we can acquire pdes that are less artificial yet more powerful . in this paper , we give an affirmative answer to this question .",
    "we demonstrate that learning particular coefficients of a general intelligent pde system from a given training data set might be a possible way of designing pdes for computer vision in a lazy manner .",
    "furthermore , borrowing this learning strategy from machine learning can generalize pdes techniques for more complex vision problems .    inspired by the electromagnetic field theory and maxwell s equations @xcite , we assume that the visual processing has two coupled evolutions in different scale spaces : one is in the _ image scale space _ , which controls the evolution of the output , and the other is in the _ indicator scale space _ that helps collect the global information to guide the evolution in the image scale space . in this way ,",
    "our general intelligent pde system consists of two coupled evolutionary pdes .",
    "both pdes are coupled equations between the image and indicator , up to their second order partial derivatives .",
    "another key idea of our general intelligent pde system is to assume that the pdes that are sought could be written as combinations of `` atoms '' which satisfy the general properties of vision tasks . as a preliminary investigation",
    ", we utilize all the translational and rotational invariants as such``atoms '' and propose the general intelligent pde system as a linear combination of all these invariants @xcite .",
    "then the problem boils down to determining the combination coefficients among such `` atoms '' .    the theory of optimal control @xcite has been well developed for over fifty years . with the enormous advances in computing power",
    ", optimal control is now widely used in multi - disciplinary applications such as biological systems , communication networks and socio - economic systems etc @xcite .",
    "optimal design and parameter estimation of systems governed by pdes give rise to a class of problems known as pde - constrained optimal control @xcite . in this paper , a pde - constrained optimal control technique as the training tool",
    "is introduced for our pde system .",
    "we further propose a general framework for learning pdes to accomplish a specific vision task via pde - constrained optimal control , where the objective functional is to minimize the difference between the expected outputs and the actual outputs of the pdes , given the input images .",
    "such input - output image pairs are provided in multiple ways ( e.g. , ground truth , results from other methods or manually generated results by humans ) for different tasks . therefore , we can train the general intelligent pde system to solve various vision problems which traditional pdes may find difficult or even impossible .    in summary ,",
    "our contributions are as follows :    1 .",
    "our intelligent pde system provides a new way to design pdes for computer vision .",
    "based on this framework , we can design particular pdes for different vision tasks using different sources of training images  .",
    "this may be very difficult for traditional pde design methods .",
    "however , we would like to remind the readers that we have no intention to beat all the existing approaches for each task , because these approaches have been carefully and specially tuned for the task .",
    "2 .   we propose a general data - based optimal control framework for training the pde system .",
    "fed with pairs of input and output images , the proposed pde - constrained optimal control training model can automatically learn the combination coefficients in the pde system .",
    "unlike previous design methods , our approach requires much less human wits and can solve more difficult problems in computer vision .",
    "the rest of the paper is structured as follows .",
    "we first introduce in section  [ sec : pde ] the general intelligent pde system . in section",
    "[ sec : opt ] we utilize the pde - constrained optimal control technique as the training framework for our intelligent pde system .",
    "then in section  [ sec : exp ] we evaluate our intelligent pde system with optimal control training framework by a series of computer vision and image processing problems .",
    "finally , we give concluding remarks and a discussion on the future work in section  [ sec : con ] .",
    "electromagnetism is the force that causes the interaction among electrically charged particles .",
    "the areas in which electromagnetic interaction happens are called the electromagnetic fields .",
    "but in physics , electrically charged objects were first thought to produce two types of fields associated with their charge property : an electric field and a magnetic field . over time",
    ", it was realized that the electric and magnetic fields are better thought of as two parts of a greater whole ",
    "the electromagnetic field @xcite .",
    "it affects the behavior of charged objects in the vicinity of the field .",
    "the electromagnetic field extends infinitely throughout space and describes the electromagnetic interaction .",
    "the theoretical implications of electromagnetism also led to the development of special relativity by albert einstein in 1905 .    in this paper , inspired by this fundamental force of nature",
    ", we consider the image evolution in a similar way . for a target image signal @xmath0 , different from most traditional ways , which only consider the evolution in the image scale space , we define a companion signal",
    "@xmath1 named the indicator signal .",
    "it changes with time and guides the evolution of @xmath0 by collecting large scale information in the image . in this way",
    ", these two signals evolve in two coupled scale spaces .",
    "similar to maxwell s equations @xcite , which are a set of pdes describing how the electric and magnetic fields relate to their sources and how they develop with time , we propose a general pde system for the evolution of our coupled signals .",
    "the space of all pdes is infinitely dimensional . to find the right form ,",
    "we start with the properties that our pde system should have , in order to narrow down the search space .",
    "we notice that translationally and rotationally invariant properties are very important for computer vision , i.e. , in most vision tasks , when the input image is translated or rotated , the output image is also translated or rotated by the same amount .",
    "so we require that our pde system is translationally and rotationally invariant .",
    "according to the differential invariant theory @xcite , the form of our pdes must be functions of the fundamental differential invariants under the group of translation and rotation .",
    "the fundamental differential invariants are invariant under translation and rotation and other invariants can be written as their functions .",
    "we list those up to second order in table  [ tab : inv ] , where some notations can be found in table  [ tab : not ] . in the sequel",
    ", we shall use @xmath2 to refer to them in order . note that those invariants are ordered with @xmath3 going before @xmath4 .",
    "we may reorder them with @xmath4 going before @xmath3 . in this case",
    ", the @xmath5-th invariant will be referred to as @xmath6 .",
    "so the simplest choice of our general pde system is the linear combination of the differential invariants , leading to the following form : @xmath7 where @xmath8 @xmath9 is the rectangular region occupied by the input image @xmath10 , @xmath11 is the time that the pde system finishes the visual information processing and outputs the results , and @xmath12 and @xmath13 are the initial functions of @xmath3 and @xmath4 , respectively .",
    "the meaning of other notations in ( [ eq : lpde ] ) can be found in table  [ tab : not ] . for computational issues and the ease of mathematical deduction ,",
    "@xmath10 will be padded with zeros of several pixels width around it . as we can change the unit of time , it is harmless to fix @xmath14 .",
    "@xmath15 and @xmath16 are sets of functions defined on @xmath17 that are used to control the evolution of @xmath3 and @xmath4 , respectively .",
    "as @xmath18 and @xmath19 change to @xmath20 and @xmath21 , respectively , when the image is rotated by a matrix @xmath22 , it is easy to check the rotational invariance of those quantities .",
    "so the pde system ( [ eq : lpde ] ) is rotationally invariant .",
    "furthermore , the following proposition implies that the control functions @xmath23 and @xmath24 can be functions of @xmath25 only .    [ thm : inv ] suppose the pde system ( [ eq : lpde ] ) is translationally invariant , then the control functions @xmath26 and @xmath27 must be independent of @xmath28 .",
    "the proof of proposition  [ thm : inv ] is presented in [ app : invprof ] .    [ cols=\"^,^,<,<\",options=\"header \" , ]",
    "in this section , we propose a data - based optimal control framework to train the intelligent pde system for particular vision tasks .      given the forms of pdes shown in ( [ eq : lpde ] ) , we have to determine the coefficient functions @xmath23 and @xmath24",
    ". we may prepare training samples @xmath29 , where @xmath30 is the input image and @xmath31 is the expected output image , and compute the coefficient functions that minimize the following functional : @xmath32 ^ 2{\\mbox{d}}\\omega\\\\ + \\frac{1}{2}\\sum_{j=0}^{16}\\lambda_j\\int_{0}^{1}a_j^2(t){\\mbox{d}}t + \\frac{1}{2}\\sum_{j=0}^{16}\\mu_j\\int_{0}^{1}b_j^2(t){\\mbox{d}}t , \\end{array}\\ ] ] where @xmath33 is the output image at time @xmath34 computed from ( [ eq : lpde ] ) when the input image is @xmath30 , and @xmath35 and @xmath36 are positive weighting parameters .",
    "the first term requires that the final output of our pde system be close to the ground truth .",
    "the second and the third terms are for regularization so that the optimal control problem is well posed , as there may be multiple minimizers for the first term .",
    "then we have the following optimal control problem with pde constraints : @xmath37 by introducing the adjoint equation of ( [ eq : opc ] ) , the gteaux derivative of @xmath38 can be computed and consequently , the ( local ) optimal @xmath26 and @xmath27 can be computed via gradient - based algorithms ( e.g. , conjugate gradient ) . here , we give the adjoint equation and gteaux derivative directly :      @xmath39    where @xmath40      with the help of the adjoint equation , at each iteration the derivative of @xmath38 with respect to @xmath23 and @xmath24 are as follows : @xmath41 where the adjoint functions @xmath42 and @xmath43 are the solutions to ( [ eq : ad ] ) .",
    "good initialization increases the approximation accuracy of the learnt pdes . in our current implementation",
    ", we simply set the initial functions of @xmath3 and @xmath4 as the input ] then we employ a heuristic method to initialize the control functions . at each time step",
    ", @xmath44 is expected to be @xmath45 so that @xmath46 moves towards the expected output @xmath31 and by the form of ( [ eq : lpde ] ) we may solve @xmath15 such that @xmath47 ^ 2{\\mbox{d}}\\omega\\label{eq : init}\\ ] ] is minimized ) . ] . in this way",
    ", we initialize @xmath23 successively in time while fixing @xmath48 .",
    "to solve the intelligent pde system numerically , we design a finite difference scheme @xcite for the pdes .",
    "we discretize the pdes , i.e. replace the derivatives @xmath49 , @xmath50 and @xmath51 with finite differences as follows : @xmath52 the discrete forms of @xmath53 , @xmath54 and @xmath55 can be defined similarly . in addition , we discretize the integrations as @xmath56 where @xmath57 is the number of pixels in the spatial area , @xmath58 is a properly chosen time step size and @xmath59 is the index of the expected output time",
    ". then we use an explicit scheme to compute the numerical solutions .",
    "we now summarize in algorithm  [ alg : l - pde ] the data - based optimal control training framework for the intelligent pde system .",
    "after the pde system is learnt , it can be applied to new test images by solving ( [ eq : lpde ] ) , whose inputs @xmath12 and @xmath13 are both the test image and the solution @xmath60 is the desired output image .",
    "training image pairs @xmath61 .",
    "initialize @xmath23 , @xmath62 , by minimizing ( [ eq : init ] ) and fix @xmath63 , @xmath64 . compute @xmath65 and @xmath66 , @xmath67 , using ( [ eq : gradient ] ) . decide the search direction using the conjugate gradient method @xcite .",
    "perform golden search along the search direction and update @xmath23 and @xmath24 , @xmath67 .",
    "the coefficient functions @xmath15 and @xmath16 .",
    "[ alg : l - pde ]",
    "in this section , we apply our data - based optimal control framework to learn pdes for four groups of basic computer vision problems : natural image denoising , edge detection , blurring and deburring , and image segmentation and object detection .",
    "as our goal is to show that the data - based optimal control framework could be a new approach for designing pdes and an effective regressor for many computer vision tasks , _ not _ to propose better algorithms for these tasks , we are not going to fine tune our pdes and then compare it with the state - of - the - art algorithms in every task .",
    "image denoising is one of the most fundamental low - level vision problems .",
    "for this task , we compare our learnt pdes with the existing pde - based denoising methods , rof @xcite and tv-@xmath68 @xcite , on images with unknown natural noise .",
    "this task is designed to demonstrate that our method can solve problems by learning from the ground truth .",
    "this is the first advantage of our data - based optimal control model .",
    "we take @xmath69 images , each with a size of @xmath70 pixels , of @xmath71 objects using a canon 30d digital camera , setting its iso to @xmath72 . for each object ,",
    "@xmath73 images are taken without changing the camera settings ( by fixing the focus , aperture and exposure time ) and without moving the camera position .",
    "the average image of them can be regraded as the noiseless ground truth image .",
    "we randomly choose @xmath74 objects .",
    "for each object we randomly choose @xmath75 noisy images .",
    "these noisy images and their ground truth images are used to train the pde system .",
    "then we compare our learnt pdes with the traditional pdes in @xcite and tv-@xmath68 @xcite on images of the remaining @xmath76 objects .",
    "[ fig : denoise ] shows the comparison results .",
    "one can see that the psnrs of our intelligent pdes are dramatically higher than those of traditional pdes .",
    "this is because our data - based pde learning framework can easily adapt to unknown types of noise and obtain pde forms to fit for the natural noise well , while most traditional pde - based denoising methods were designed under specific assumptions on the types of noise ( e.g. , rof is designed for gaussian noise @xcite while tv-@xmath68 is designed for impulsive noise @xcite ) .",
    "therefore , they may not fit for unknown types of noise as well as our intelligent pdes .",
    "the curves of the learnt coefficients for image denoising are shown in fig .",
    "[ fig : denoise_a ] .      the image edge detection task is used to demonstrate that our pdes can be learnt from the results of different methods and achieve a better performance than all of them .",
    "this is another advantage of our data - based optimal control model .",
    "for this task , we use three simple first order edge detectors @xcite ( sobel , roberts cross , and prewitt ) to generate the training data .",
    "we randomly choose @xmath77 images from the berkeley image database @xcite and use the above three detectors to generate the output images , together with the input images , to train our pde system for edge detection .",
    "[ fig : edge ] shows part of the edge detection results on other images in the berkeley image database .",
    "one can see that our pdes respond selectively to edges and basically produce visually significant edges , while the edge maps of other three detectors are more chaotic .",
    "note that the solution to our pdes is supposed to be a more or less smooth function .",
    "so one can not expect that our pdes produce an exactly binary edge map .",
    "instead , an approximation of a binary edge map is produced .",
    "the curves of the learnt coefficients for edge detection are shown in fig .",
    "[ fig : edge_a ] .",
    "the traditional pdes for solving different problems are usually of very different appearance .",
    "the task of solving both blurring and deblurring is designed to show that the same form of pdes can be learnt to solve both the primal and inverse problems .",
    "this is the third advantage of our data - based optimal control model .    for the image blurring task ( the primal problem ) ,",
    "the output image is the convolution of the input image with a gaussian kernel .",
    "so we generate the output images by blurring high resolution images using a gaussian kernel with @xmath78 .",
    "the original images are used as the input . as shown in the third row of fig .",
    "[ fig : blur ] , the output is nearly identical to the ground truth ( the second row of fig .",
    "[ fig : blur ] ) . for the image deblurring task ( the inverse problem ) , we just exchange the input and output images for training .",
    "one can see in the bottom row of fig .",
    "[ fig : blur ] that the output is very close to the original image ( first row of fig .",
    "[ fig : blur ] ) .",
    "the curves of the learnt coefficients for image deblurring are shown in fig .",
    "[ fig : blur_a ] .",
    "image segmentation and object detection are designed to demonstrate that our pde system can learn from the human behavior directly ( learn the segmentation and detection results provided by humans , e.g. , manually segmented masks ) .    for image segmentation , it is a highly ill - posed problem and there are many criteria that define the goal of segmentation , e.g. , breaking an image into regions with similar intensity , color , texture , or expected shape . as none of the current image segmentation algorithms can perform object level segmentation well out of complex backgrounds ,",
    "we choose to require our pdes to achieve a reasonable goal , namely segmenting relatively darker objects against relatively simple backgrounds , where both the foreground and the background can be highly textured and simple thresholding can not separate them .",
    "so we select 60 images from the corel image database @xcite that have relatively darker foregrounds and relatively simple backgrounds , but the foreground is not of uniformly lower graylevels than the background , and also prepare the manually segmented binary masks as the outputs of the training images , where the black regions are the backgrounds ( fig .",
    "[ fig : seg_train ] ) .",
    "part of the segmentation results are shown in fig .",
    "[ fig : seg ] , where we have set a threshold for the output mask maps of our learnt pdes with a constant 0.5 .",
    "we see that our learnt pdes produce fairly good object masks .",
    "we also test the active contour method by li et al .",
    "@xcitecmli/ ] and the normalized cut method @xcitejshi / software/ ] .",
    "one can see from fig .",
    "[ fig : seg ] that the active contour method can not segment object details due to the smoothness constraint on the object shape and the normalized cut method can not produce a closed foreground region . to provide a quantitative evaluation",
    ", we use the @xmath79-measures that merge the precision and recall of segmentation : @xmath80 @xmath81 in which @xmath82 is the ground truth mask and @xmath83 is the computed mask .",
    "the most common choice of @xmath84 is 2 . on our test images ,",
    "the @xmath85 measures of our pdes , @xcite and @xcite are @xmath86 , @xmath87 and @xmath88 , respectively .",
    "one can see that the performance of our pdes is better than theirs , in both visual quality and quantitative measure .",
    "the curves of the learnt coefficients for image segmentation are shown in fig .",
    "[ fig : seg_a ] .",
    "we also present the evolution process of the mask maps across time ( fig .",
    "[ fig : evolution ] ) .",
    "one can see that although the foreground is relatively darker than the background , the pdes correctly detect the most salient points / edges and then propagate the information across the foreground region , resulting in a _",
    "brighter _ output region for the foreground .",
    "now we apply our intelligent pdes for a more complex task : object detection .",
    "namely , the pdes should respond strongly to the object of interest while not responding ( or responding much more weakly ) if the object is absent in the image .",
    "it should be challenging enough for one to manually design pdes to perform such a problem . as a result",
    ", we are unaware of any pde - based method that can accomplish this task",
    ". the existing pde - based segmentation algorithms always output an `` object region '' even if the image does not contain the object of interest .",
    "in contrast , we will show that as desired our pdes are able to respond selectively .",
    "we choose the `` plane '' data set in corel @xcite .",
    "we select @xmath73 images from this data set as positive samples and also prepare @xmath73 images without the object of interest as negative samples .",
    "we also provide their ground truth object masks in order to complete the training data .    in fig .",
    "[ fig : detection ] , one can see that our learnt pdes respond well to the objects of interest ( first three images ) , while the response to images without the objects of interest is relatively low across the whole images ( last two images ) .",
    "it seems that our pdes automatically identify that the concurrent high - contrast edges / junctions / corners are the key features of planes .",
    "the above examples show that our learnt pdes are able to differentiate the object / non - object regions , without requiring the user to teach them what features are and what factors to consider .",
    "the curves of the learnt coefficients for object detection are shown in fig .",
    "[ fig : det_a ] .",
    "in this paper , we have presented a framework for using data - based optimal control to learn pdes as a general regressor to approximate the nonlinear mappings of different visual processing tasks .",
    "the experimental results on some computer vision and image processing problems show that our framework is promising . however , the current work is still preliminary , so we plan to improve and enrich our work in the following aspects .",
    "first , more theoretical issues should be addressed for this pde system .",
    "for example , we will try to apply the adomian decomposition method @xcite to express the exact analytical solution to ( [ eq : lpde ] ) and then analyze its physical properties .",
    "second , we would like to develop more computationally efficient numerical algorithms to solve our pde - constrained optimal control problem ( [ eq : opc ] ) .",
    "third , we will apply our framework to more vision tasks to find out to what extent it works .",
    "we prove that the coefficients @xmath26 and @xmath27 must be independent of @xmath28 .    we prove for @xmath89 in ( [ eq : lpde ] ) only .",
    "we may rewrite @xmath90 then it suffices to prove that @xmath91 is independent of @xmath28 .    by the definition of translational invariance ,",
    "when @xmath92 changes to @xmath93 by shifting with a displacement @xmath94 , @xmath95 and @xmath96 will change to @xmath97 and @xmath98 , respectively .",
    "so the pair @xmath97 and @xmath98 fulfils ( [ eq : lpde ] ) , i.e. , @xmath99 next , we replace @xmath100 in the above equation with @xmath28 and have : @xmath101 on the other hand , the pair @xmath102 also fulfils ( [ eq : lpde ] ) , i.e. , @xmath103 therefore , @xmath104 , @xmath105 that confines the input image inside @xmath9 .",
    "so @xmath91 is independent of @xmath28 .",
    "this work was partially supported by the grants of the national science foundation of china , no .",
    "u0935004 and 60873181 .",
    "d.  r. martin , c.  fowlkes , d.  tal , and j.  malik , `` a database of human segmented natural images and its application to evaluating segmentation algorithms and measuring ecological statistics , '' in _ international conference on computer vision ( iccv ) _ , 2001 ."
  ],
  "abstract_text": [
    "<S> many computer vision and image processing problems can be posed as solving partial differential equations ( pdes ) . however , designing pde system usually requires high mathematical skills and good insight into the problems . in this paper , we consider designing pdes for various problems arising in computer vision and image processing in a lazy manner : _ learning pdes from real data via data - based optimal control_. we first propose a general intelligent pde system which holds the basic translational and rotational invariance rule for most vision problems . by introducing a pde - constrained optimal control framework , it is possible to use the training data resulting from multiple ways ( ground truth , results from other methods , and manual results from humans ) to learn pdes for different computer vision tasks . </S>",
    "<S> the proposed optimal control based training framework aims at learning a pde - based regressor to approximate the unknown ( and usually nonlinear ) mapping of different vision tasks . </S>",
    "<S> the experimental results show that the learnt pdes can solve different vision problems reasonably well . </S>",
    "<S> in particular , we can obtain pdes not only for problems that traditional pdes work well but also for problems that pde - based methods have never been tried before , due to the difficulty in describing those problems in a mathematical way .    </S>",
    "<S> optimal control , pdes , computer vision , image processing . </S>"
  ]
}