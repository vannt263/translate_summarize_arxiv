{
  "article_text": [
    "force - free magnetic fields , @xmath2 , satisfy @xmath3 , or equivalently @xmath4 calculation of such force - free fields is of importance in many astrophysical settings , for example accretion disks around various objects ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , neutron stars @xcite , pulsars @xcite , magnetic clouds @xcite , and solar and stellar coronae ( e.g. * ? ? ? * ) .",
    "a particular application in solar physics is the controversial ` topological dissipation ' model proposed by @xcite .",
    "the assertion of this model is that if an equilibrium magnetic field is perturbed by arbitrary motions at a line - tied boundary , then the subsequent field can not relax to a smooth force - free equilibrium .",
    "rather , the equilibrium must contain tangential discontinuities  corresponding to current sheets .",
    "doubt has been cast upon the model however , as a number of authors have demonstrated the existence of smooth solutions in the scenario posed @xcite .",
    "the question as to whether current sheets form spontaneously in the coronal magnetic field is key to understanding the so - called coronal heating problem .",
    "this is just one example which demonstrates that determining both the structure and stability of force - free magnetic fields is of fundamental importance .",
    "there are different approaches that one may take when searching for force - free magnetic fields .",
    "one method , often used when modelling the solar corona , is to solve a boundary value problem ( @xcite , and see @xcite for a comparison of numerical schemes ) .",
    "the force - free field is reconstructed from boundary data , provided for example by a vector magnetogram .",
    "an alternative approach is to begin with an initial magnetic field that is not force - free and to perform a relaxation procedure .",
    "this is the natural approach if one wants to investigate the properties of particular magnetic topologies .",
    "as long as the relaxation procedure can be guaranteed to be ideal , then the topology will be conserved during the relaxation .",
    "one powerful computational approach for investigating the properties of force - free fields is to employ an ideal lagrangian relaxation scheme .",
    "such schemes exploit the property that under ideal mhd the vector @xmath5 evolves according to the equation @xmath6 where @xmath7 is the material derivative , @xmath8 the plasma density and @xmath9 the plasma velocity .",
    "this is of exactly the same form as the evolution equation of a line element @xmath10 in a flow ( see , e.g.  @xcite ) , and thus a lagrangian description facilitates a relaxation that is , by construction , ideal .",
    "these schemes can be used to investigate the structure and ( ideal mhd ) stability of force - free fields .",
    "the latter is guaranteed by the iterative convergence of the scheme provided that the resolution is sufficient .",
    "the primary variables that the numerical scheme dynamically updates are the locations of the mesh points , with the quantities @xmath11 and @xmath12 being calculated via matrix products involving the initial magnetic field and derivatives of the mapping that describes the mesh deformation .",
    "an artificial frictional term is included in the equation of motion ( see also @xcite ) which guarantees a monotonic decrease of the energy .",
    "two implementations of this method are described in @xcite and @xcite .",
    "the method has been used extensively to investigate the stability and equilibrium properties of various different magnetic configurations , such as the kink instability of magnetic flux tubes @xcite , line - tied collapse of 2d and 3d magnetic null points @xcite and the parker problem @xcite .    in the following section",
    "we describe a test problem that illustrates one major difficulty in the computation of force - free fields , in the context of the lagrangian relaxation scheme outlined above . in section [ numsec ]",
    "we present two possible extensions of the numerical scheme . in section [ ressec ]",
    "we describe our results , and in section [ concsec ] we present our conclusions .",
    "in a numerical relaxation experiment using braided initial fields @xcite we came across an inconsistency of the resulting numerical force - free state , which is best explained with the help of the following example . consider a magnetic field obtained from the homogenous field by a simple twisting deformation as shown in fig .",
    "[ twoblobfig](a ) .",
    "obviously an ideal relaxation towards a force - free state must end again in a homogenous state ( @xmath13 ) . during this process",
    "the lagrangian relaxation leads to a deformation of the initial computational mesh which exactly cancels the initial deformation applied to the homogenous field .",
    "this is a well defined setup in which we know exactly the initial and final states .",
    "we now employ the implicit ( adi ) relaxation scheme detailed by @xcite to relax our twisted field to a force - free equilibrium .",
    "the magnetic field is line - tied on all boundaries ( @xmath14 on @xmath15 and @xmath16 boundaries ) .",
    "the @xmath17 force as calculated by the numerical scheme decreases monotonically to an arbitrarily small value ( e.g.  @xmath18@xmath19 ) , giving the appearance that the scheme converges ( in an iterative sense ) to a force - free equilibrium ( to any desired accuracy , down to machine precision ) .",
    "however , when plotting @xmath20 , the force - free proportionallity factor , along a field line it shows variations which are by orders of magnitude higher than would be expected from @xmath21 .",
    "it is this inconsistency that we investigate in what follows .",
    "as we will discuss the convergence of the numerical scheme in what follows , it is worth emphasising here the distinction between iterative convergence ( at fixed resolution @xmath22 ) and real convergence , i.e.  convergence towards a ` correct ' solution as the resolution @xmath22 becomes sufficiently large .      in order to investigate the source of the inconsistency described in the previous section , we consider the test problem outlined there . specifically , we begin with an initially uniform magnetic field ( @xmath23 ) , and superimpose two regions of toroidal field , centred on the @xmath24-axis at @xmath25 , with exactly the same functional form , but of opposite signs : @xmath26 with @xmath27 , @xmath28 , @xmath29 and @xmath30 , @xmath31 , @xmath32 , @xmath33 .",
    "we refer to this field in the following as @xmath34 .",
    "the field @xmath34 ( see fig .",
    "[ twoblobfig](a ) ) is constructed such that the two regions of twisted field , which are of opposite sign , should exactly cancel one another under an ideal relaxation , approaching the uniform field ( with @xmath35 ) as the equilibrium .",
    "note that @xmath36 is the maximum turning angle of field lines around the @xmath24-axis .",
    "( a ) , given by eq .  ( [ t2 ] ) .",
    "( b ) mesh in the @xmath37 plane for the test problem with artificially imposed deformation , with @xmath38 and resolution @xmath39.,title=\"fig : \" ] ( b ) , given by eq .",
    "( [ t2 ] ) .",
    "( b ) mesh in the @xmath37 plane for the test problem with artificially imposed deformation , with @xmath38 and resolution @xmath39.,title=\"fig : \" ]    one of the great advantages of an ideal lagrangian relaxation is that it is possible to extract the paths of the magnetic field lines of the final state if one knows them in the initial state , simply by interpolating over the mesh displacement . calculating the field lines in this way , no error is accumulated by integrating along @xmath11 .",
    "given knowledge of the field line paths , one can test the quality of the force - free approximation by plotting @xmath20 along field lines . for a force - free field @xmath40 and @xmath20",
    "should be constant along field lines since taking the divergence of the above yields @xmath41    we begin by defining the variable @xmath42 , motivated by eq .",
    "( [ fff ] ) , as @xmath43 we find that for the magnetic field calculated by the relaxation scheme , the value of @xmath44 changes dramatically along field lines .",
    "of course the relaxation gives a magnetic field for which @xmath45 is not identically zero .",
    "so for a given value of @xmath17 , what is the maximum possible variation in @xmath44 along a field line ?",
    "consider @xmath46 say , where @xmath47 is representative of the error in calculating @xmath48 . using eq .",
    "( [ alphastar ] ) to replace @xmath49 gives @xmath50 or @xmath51 where @xmath52 is a parameter along a magnetic field line with units of length .",
    "now suppose that @xmath53 within our domain .",
    "this implies that @xmath54 , so that @xmath55 where @xmath56 is the length scale of variations perpendicular to the magnetic field . then from eq .",
    "( [ eq8 ] ) @xmath57    returning to our relaxation results , we have for example @xmath58 , with @xmath59 , @xmath60 .",
    "however , we find that @xmath61 .",
    "the discrepancy between this figure and the value of @xmath62 must come from the final term in eq .",
    "( [ fffquality ] ) .",
    "this has been checked by interpolating the data onto a rectangular mesh and approximating @xmath63 using standard finite differences .",
    "we find @xmath64 , and it therefore appears that the residual currents parallel to @xmath2 are not relaxed because @xmath65 . as demonstrated below , this error does however decrease as the resolution is increased ( see tables [ errortab][tab3 ] ) .",
    "it turns out that the appearance of the errors is related to the way in which @xmath12 is calculated within the scheme , via a combination of 1st and 2nd derivatives of the deformation matrix .",
    "these derivatives are calculated via finite differences in the numerical scheme , and it is here that these discretisation errors arise .",
    "this is demonstrated below .      to ascertain the source of the errors , we take our initial state @xmath34 and _ instead of performing the relaxation procedure _ , we artificially apply a deformation to the mesh which we can write down as a closed form expression , and moreover for which we can obtain the derivatives of the mesh displacement , and thus the resultant @xmath11 and @xmath12 fields , as closed form expressions .",
    "motivated by the results of the relaxation , we impose a similar rotational distortion of the mesh which acts to ` untwist ' the field , via the transformation @xmath66 where @xmath67 @xmath68 constant .",
    "we now apply this transformation to an initially rectangular mesh on which @xmath2 is given by @xmath34 , and compare the numerical and exact values for each entry in the mesh deformation jacobian , and each component of @xmath11 and @xmath12 .",
    "results are shown for three different values of the parameter @xmath68 in table [ errortab ] .",
    ".errors in @xmath11 and @xmath12 for deformations with @xmath69 ( in eq .",
    "( [ analytangle ] ) ) using 2nd - order finite differences .",
    "@xmath70 is the mesh resolution . in each case",
    "the upper number shows the maximum relative percentage error in the domain over all components of @xmath11 , i.e. @xmath71 , where @xmath72 is the exact value .",
    "the lower number is @xmath73 . [",
    "cols=\"^,^,^,^ \" , ]      we now leave the artificially imposed deformation , and relax @xmath34 using both the 2nd- and 4th - order schemes . the relaxation is allowed to run until @xmath74 as calculated by the relevant numerical scheme is reduced to @xmath75 .",
    "we compare this value with @xmath76 ( defined by eq .",
    "( [ epsilonstar ] ) ) , and also the maximum value of the lorentz force obtained by calculating @xmath48 via the stokes - based routine , denoted @xmath77 .",
    "the results for two levels of initial twist ( @xmath78 ) are displayed in tables  [ tab2 ] and [ tab3 ] .",
    "c || c|c |@| c | c & & + @xmath22 & @xmath76 & @xmath79 & @xmath76 & @xmath79 + & & & & + 21 & 0.11 & 0.053 & 0.048 & 0.063 + 41 & 0.054 & 0.046 & 0.0067 & 0.018 + 61 & 0.032 & 0.035 & 0.0042 & 0.0050 + 81 & 0.021 & 0.027 & 0.0015 & 0.0019    c || c|c",
    "|@| c | c & & + @xmath22 & @xmath76 & @xmath79 & @xmath76 & @xmath79 + & & & & + 21 & 0.28 & 0.18 & 0.17 & 0.21 + 41 & 0.16 & 0.17 & 0.071 & 0.13 + 61 & 0.11 & 0.13 & 0.026 & 0.062 + 81 & 0.074 & 0.11 & 0.021 & 0.023    a number of points are immediately clear .",
    "first , in no simulation do we approach the apparent value of @xmath80 .",
    "however , the use of fourth- rather than second - order finite differences improves the quality of the relaxed field by an order of magnitude in @xmath76 when @xmath81 . increasing the deformation in the final state ( by increasing @xmath36 in the initial state @xmath34 ) has a strong adverse effect on the relaxation process .",
    "this is found to be because spurious ( unphysical ) current concentrations arise where none should reasonably be expected .",
    "examining the corresponding mesh , we find that these ` false ' current regions appear where the grid is most distorted  see fig .",
    "[ jiso ] , and compare with fig .",
    "[ twoblobfig](b ) .",
    "\\(a )   at 2/3 of maximum , for ( a ) an intermediate stage in the relaxation ( @xmath82 ) and ( b ) the final state ( @xmath83 ) .",
    "4th - order scheme , @xmath84 , @xmath85 .",
    "inset : view in @xmath86-plane (",
    "i.e.  from @xmath87).,title=\"fig : \" ] ( b )   at 2/3 of maximum , for ( a ) an intermediate stage in the relaxation ( @xmath82 ) and ( b ) the final state ( @xmath83 ) .",
    "4th - order scheme , @xmath84 , @xmath85 .",
    "inset : view in @xmath86-plane ( i.e.  from @xmath87).,title=\"fig : \" ]    the ` current shards ' shown in fig .",
    "[ jiso](b ) actually intensify as the relaxation proceeds .",
    "we find that this is possible since @xmath88 ( approximated by interpolating @xmath48 onto a uniform mesh ) is not close to zero . as a result",
    "there is no ` return current ' associated with these localised current regions , which might be expected to generate a lorentz force that would act against the further intensification of the current shards ( if they have no physical basis ) . in previous studies using such codes ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , intensification of @xmath89 as @xmath74 decreased in time was associated with current singularities , so at first sight it appears that these current shards could naively be interpreted as ` current sheets ' , which would of course be unphysical .",
    "note , however , that the most important signature of current singularity in previous studies was a ( power - law ) proportionality of the peak current with mesh resolution ( for given @xmath62 ) .",
    "we have found that in fact the current shards become less intense as @xmath22 is increased , so there is a clear distinction between the two phenomena .    finally , consider the values of @xmath79 we find for the relaxed fields ( tables [ tab2][tab3 ] ) .",
    "they are clearly of the same order as @xmath76 ( note that @xmath76 based on @xmath48 from the numerical scheme and @xmath76 based on @xmath77 are of the same order ) , and thus it seems that an implementation involving the stokes - based routine has the capacity to yield a magnetic field that is much closer to being force - free ( with lower @xmath76 ) .",
    "this is illustrated in fig .",
    "[ alpha_t ] .",
    "s through the relaxation with second order finite differences with @xmath84 and @xmath90 .",
    "the dashed line is the observed value of @xmath44 , while the solid line is the maximum allowable @xmath44 defined via eq .",
    "( [ alphamax ] ) with @xmath62 given by @xmath91 from the 2nd - order numerical scheme .",
    "the dot - dashed line is the maximum @xmath44 with @xmath62 given by @xmath79 .",
    "inset : close - up of behaviour at early time . ]",
    "we consider the observed value of @xmath44 based on eq .",
    "( [ alphastar ] ) ( dashed line ) , compared with a maximum allowable value for @xmath44 . since @xmath44 is anti - symmetric about @xmath37 , the maximum value allowed , based on eq .",
    "( [ fffquality ] ) , is @xmath92 and we take @xmath93 and @xmath94 as before , and @xmath95 , the length of the domain .",
    "then we obtain the maximum possible @xmath44 by taking @xmath62 to be the maximum value during the relaxation of @xmath96 ( solid line ) or @xmath97 ( dot - dashed ) .",
    "we see that very early in the relaxation the actual value of @xmath44 becomes greater than the maximum allowed by @xmath96 from the numerical scheme ( 2nd - order ) .",
    "moreover , the discrepancy grow steadily .",
    "however , @xmath44 always remains less than the maximum allowed by the stokes - based method , implying that this may be a more sound method to calculate the current and resulting lorentz force .",
    "force - free magnetic fields are important in many astrophysical applications . determining the properties of such force - free fields  especially smoothness and stability properties  is key to understanding energy release processes that heat the plasma and lead to dynamic events such as flares in the solar corona .",
    "we have investigated the properties of different relaxation procedures for determining force - free fields based on a lagrangian mesh approach .",
    "these techniques have previously been shown to have many powerful and advantageous properties .",
    "previous understanding was that such schemes would iteratively converge ( i.e.  @xmath96 decreasing monotonically to a given level ) up to a certain degree of mesh deformation . beyond this level of mesh deformation",
    "the scheme no longer converges ( @xmath96 oscillates or grows ) , and it is this phenomenon that was thought to limit the method .",
    "however , we have shown above that even when the numerical scheme iteratively converges , the accuracy of the force - free approximation can become seriously compromised for even ` moderate ' mesh deformations .",
    "this error is an accumulation of numerical discretisation errors resulting from the calculation of @xmath48 via combinations of 1st and 2nd derivatives of the mesh deformation jacobian  which are calculated using finite differences .",
    "the result is that neither @xmath98 nor subsequently @xmath99 are well satisfied .",
    "it was demonstrated that a result of the breaking of the solenoidal condition for @xmath48 can be the development of spurious ( unphysical ) current structures .",
    "however , we note that these rogue currents do diminish with resolution ( @xmath22 ) , so when using these schemes this property should always be checked where possible .",
    "we expect that , as a result , if it were possible to systematically increase @xmath22 indefinitely the rogue currents would eventually vanish . in other words ,",
    "the real problem is that the iterative convergence ( i.e.  monotonic decrease of @xmath74 with @xmath100 ) is not compromised by the rogue currents but the real convergence to a correct solution is severely impaired .",
    "a force - free field is defined by @xmath101 .",
    "one key result of this equation is that @xmath20 must be constant along magnetic field lines .",
    "we therefore argued that a correct diagnostic to measure the quality of a force - free apprioximation is the constancy of the parameter @xmath102 along field lines .",
    "an appropriate normalisation is given in eq .",
    "( [ epsilonstar ] ) .",
    "the results of our investigations suggest that for lagrangian schemes the @xmath74 measure does not provide a good indicator of true convergence-a better measure in the constancy of @xmath44 along @xmath2 .",
    "we note that other authors have proposed measures other than the maximum of @xmath96 for testing a force - free approximation  for example @xcite introduced the ",
    "mean current - weighted angle between @xmath48 and @xmath2 \" .",
    "however , calculation of this measures still relies upon the value of @xmath96 in the numerical scheme , and in the present scenario we have shown that the errors arise not because @xmath48 and @xmath2 are not parallel , but because @xmath103 .    since errors in the ( lagrangian ) numerical scheme investigated here arise as the mesh becomes increasingly distorted , a natural choice is to begin with a non - equilibrium field on a non - rectangular mesh , and relax towards a ( perhaps approximately ) rectangular one .",
    "however , this approach is not feasible if the field has complex topology . in the case of a braided field  which is of particular interest to the theory of the solar corona  we find that for our realisation of such a field @xcite there is no escaping having at least a moderately distorted mesh in the final state .",
    "we proposed two possible extensions to the numerical method .",
    "the first was to increase the order of the finite differences used .",
    "it was found that for certain levels of deformation this can give an order of magnitude improvement in the quality of the force - free approximation obtained .",
    "it is therefore certainly a good approach to use in some circumstances .",
    "as the mesh became more and more highly deformed , the advantage of the scheme with 4th - order finite differences was lost for our test case @xmath34 .",
    "furthermore , we found that for relaxation of the braided field described in @xcite no appreciable improvement arose from using the 4th - order scheme .",
    "the other extension that we proposed to the scheme seems very promising . in section [ stokessec ]",
    "we presented an algorithm for calculating the curl of a vector field on an arbitrary mesh , based on stokes theorem .",
    "for increasing levels of mesh deformation , this performed progressively better than the finite difference methods .",
    "what s more , in all of our tests the resultant lorentz force @xmath97 had lower errors than that calculated by the traditional finite difference .",
    "in order for a relaxation experiment to remain accurate as it proceeds , the maximum allowed value of @xmath44 based on @xmath96 ( see eq .",
    "( [ alphamax ] ) ) must always remain greater than the maximum observed value of @xmath44 .",
    "we found that this is the case for the stokes - based @xmath44 down to at least an order of magnitude lower in @xmath97 than for the finite difference methods ( see fig .",
    "[ alpha_t ] ) .",
    "all of the above leads us to believe that the stokes - based algorithm is a highly promising one for improving the accuracy of lagrangian relaxation schemes . at present it has not been implemented ( i.e.  the code does not act to minimise @xmath97 ) because this requires a complete re - writing of the implicit ( adi ) time - stepping , and a simple explicit implementation turns out to be prohibitively computationally expensive . however , our intended next step in this investigation is to implement this scheme , either by introducing the stokes - based current calculation as a correction term in the existing scheme or by employing a more sophisticated explicit time - stepping to reduce the computational expense to acceptable levels .",
    "we note that while the algorithm at present only uses two nearest neighbour points in each direction , it could be extended to include further line integrals as corrections to the present formula for @xmath77 in much the same way as is done by increasing the order of finite difference derivatives ."
  ],
  "abstract_text": [
    "<S> force - free magnetic fields are important in many astrophysical settings . determining the properties of such force - free fields  </S>",
    "<S> especially smoothness and stability properties  is crucial to understanding many key phenomena in astrophysical plasmas , for example energy release processes that heat the plasma and lead to dynamic or explosive events . here </S>",
    "<S> we report on a serious limitation on the computation of force - free fields that has the potential to invalidate the results produced by numerical force - free field solvers even for cases in which they appear to converge ( at fixed grid resolution ) to an equilibrium magnetic field . in the present work we discuss this problem within the context of a lagrangian relaxation scheme that conserves magnetic flux and @xmath0 </S>",
    "<S> identically . </S>",
    "<S> error estimates are introduced to assess the quality of the calculated equilibrium . </S>",
    "<S> we go on to present an algorithm , based on re - writing the @xmath1 operation via stokes theorem , for calculating the current which holds great promise for improving dramatically the accuracy of the lagrangian relaxation procedure . </S>"
  ]
}