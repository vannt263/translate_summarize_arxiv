{
  "article_text": [
    "two - stage stochastic programs arise as deterministic equivalents of improperly posed random linear programs @xmath3 where @xmath4 is a convex polyhedral subset of @xmath5 , @xmath6 a matrix , @xmath7 is a @xmath8-dimensional random vector , @xmath9 represents an affine function from @xmath10 to @xmath11 and @xmath12 denotes the inner product in @xmath5 .",
    "the modeling idea consists in the compensation of a possible deviation @xmath13 for a given realization @xmath14 of @xmath7 , by introducing additional costs @xmath15 whose mean with respect to the probability distribution @xmath16 of @xmath7 is added to the objective of ( [ imlp ] ) . in two - stage stochastic programming it is assumed that the additional costs represent the optimal value of a second - stage linear program , i.e. , @xmath17 where @xmath18 is a @xmath19-matrix called recourse matrix , @xmath20 the recourse costs and @xmath21 the recourse decision .",
    "the deterministic equivalent program then is of the form @xmath22 in practical applications of stochastic programming the dimension @xmath8 is often large , e.g. , in economics , energy , finance or transportation ( see @xcite for a survey of applied models ) .",
    "it is worth noting that the option pricing models that served as motivating examples for the further development of quasi - monte carlo algorithms ( e.g. in @xcite ) may be reformulated as linear two - stage stochastic programs whose stochastic inputs are means of geometric brownian motions paths .",
    "so , in a sense , the models considered here may be regarded as extensions of such financial models ( see example [ option ] ) .    the standard approach to solving the optimization model ( [ twost ] )",
    "consists in approximating the underlying probability distribution by discrete distributions @xmath23 based on a finite number @xmath24 of _ samples _ or _ scenarios _ @xmath25 with probabilities @xmath26 , @xmath27 , and to consider the approximate stochastic program @xmath28 while the case of random samples is studied in detail at least for independent and identically distributed ( iid ) samples ( see e.g. chapters 6 and 7 in @xcite , ( * ? ? ?",
    "4 ) ) , where the convergence rate ( in probability or quadratic mean ) is @xmath29 .",
    "only a few papers related to stochastic programming dealt with the situation of deterministic samples with identical weights @xmath30 and proved ( general ) convergence results ( see @xcite , @xcite for randomized samples or @xcite for an overview ) .",
    "there exist two main approaches for the generation of discrete approximations to @xmath16 based on deterministic samples with identical weights .",
    "the first one is called _ optimal quantization of probability distributions _",
    "( see @xcite , @xcite ) and determines such quantizations by ( approximately ) solving best approximation problems for @xmath16 in terms of the @xmath31-minimal ( or @xmath31-wasserstein ) metric @xmath32 , @xmath33 ( see section 2.5 in @xcite ) .",
    "the primal and dual representations of @xmath34 together with a classical result ( see ( * ? ? ?",
    "* proposition 2.1 ) ) imply that @xmath35 holds for sufficiently large @xmath24 and some constant @xmath36 if @xmath16 has a density on @xmath10 and @xmath37 denotes the banach space of lipschitz functions on @xmath10 equipped with the lipschitz norm @xmath38 .",
    "this shows that the convergence rate of @xmath39 is at most @xmath40 .",
    "this rate is indeed established in ( * ? ? ?",
    "* theorem 6.2 ) under certain conditions on @xmath16 .",
    "it is known that the unit ball @xmath41 is too large for obtaining better rates .",
    "the second approach utilizes _ quasi - monte carlo algorithms _ that are of the form @xmath42 and relies on the concept of equidistributed or low discrepancy point sets @xmath43 or sequences @xmath44 in @xmath45 ( see @xcite ) . as observed in @xcite certain reproducing kernel hilbert spaces @xmath37 of functions @xmath46^{d}\\to{\\mathbb{r}}$ ]",
    "are particularly useful for estimating the quadrature error .",
    "let @xmath47^{d}\\times[0,1]^{d}\\to{\\mathbb{r}}$ ] be a kernel satisfying @xmath48 and @xmath49 for each @xmath50^{d}$ ] and @xmath51 . if @xmath12 and @xmath52 denote the inner product and norm in @xmath37 , and the integral @xmath53^{d}}f(x)dx\\ ] ] is a continuous functional on @xmath37 , the worst - case quadrature error @xmath54 allows the representation @xmath55 according to riesz representation theorem for linear bounded functionals on hilbert spaces .",
    "the _ representer _",
    "@xmath56 of the quadrature error is of the form @xmath57^{d}}k(x , y)dy - n^{-1}\\sum_{j=1}^{n}k(x , x^{j})\\quad(\\forall x\\in[0,1]^{d}).\\ ] ] in the standard setting , the weighted tensor product sobolev space @xcite @xmath58^{d } ) = \\bigotimes_{i=1}^{d}w_{2}^{1}([0,1])\\ ] ] equipped with the weighted norm @xmath59 and inner product ( see section [ anovadec ] for the notation ) @xmath60^{|u|}}\\frac{\\partial^{|u|}}{\\partial x^{u}}f(x^{u},\\mathbf{1}^{-u})\\frac{\\partial^{|u|}}{\\partial x^{u}}g(x^{u},\\mathbf{1}^{-u})d x^{u},\\ ] ] where the sequence @xmath61 is positive and nonincreasing , and @xmath62 is given by @xmath63 for @xmath64 , is a reproducing kernel hilbert space with the kernel @xmath65\\big)\\quad(x , y\\in[0,1]^{d}).\\ ] ] this is the so called weighted _ anchored _ tensor product sobolev space , with anchor at the point @xmath66^d$ ] . by considering @xmath37 now with the inner product @xmath67^{|u|}}\\!\\!\\big(\\int_{[0,1]^{d-|u| } }   \\frac{\\partial^{|u|}}{\\partial x^{u}}f(x)dx^{-u}\\big)\\ !",
    "\\big ( \\int_{[0,1]^{d-|u|}}\\frac{\\partial^{|u|}}{\\partial x^{u}}g(x)dx^{-u}\\big)d x^{u}\\ ] ] we obtain the so called weighted _ unanchored _ tensor product sobolev space @xcite with the kernel @xmath68^{d}),\\ ] ] where @xmath69 and @xmath70 are the bernoulli polynomials of order @xmath71 and @xmath72 , respectively .",
    "another example is a weighted tensor productwalsh space consisting of walsh series ( see ( * ? ? ?",
    "* example 2.8 ) and @xcite ) .",
    "these three spaces became important for analyzing the recently developed randomized lattice rules , namely , randomly shifted lattice rules @xcite ) and random digitally shifted polynomial lattice rules ( see @xcite ) .",
    "both are special cases of _ randomized quasi - monte carlo algorithms ( rqmc ) _ which will be discussed in section [ rqmc ] .    here , we just mention that randomly shifted lattice rules @xmath73 can be constructed , where @xmath74 is uniformly distributed in @xmath75 , @xmath76 is the generator of the lattice which is obtained by a component - by - component algorithm and @xmath77 means taking componentwise the fractional part . for @xmath78 belonging to the weighted ( un)anchored tensor product sobolev space @xmath37 the root mean square error of such randomly shifted lattice rules can be bounded by @xcite @xmath79 where the constant @xmath80 does not depend on the dimension @xmath8 if the sequence of nonnegative weights @xmath81 satisfies @xmath82    unfortunately , typical integrands in linear two - stage stochastic programming ( see section [ twostage ] ) do not belong to such tensor product sobolev or walsh spaces and are even not of bounded hardy and krause variation ( on @xmath83^{d}$ ] ) .",
    "the latter condition represents the standard requirement on the integrand @xmath78 to justify quasi - monte carlo algorithms via the koksma - hlawka theorem ( * ? ? ?",
    "* theorem 2.11 ) .",
    "alternatively , it is suggested in the literature to study the so - called anova decomposition ( see section [ anovadec ] ) of such integrands , the smoothness of the anova terms , effective dimensions and/or sensitivity indices of the integrands .    the aim of the present paper is to follow the suggestions and to derive theoretical arguments that explain why modern rqmc methods , with focus on randomly shifted lattice rules ( [ rslr ] ) , converge with nearly the optimal rate ( [ rate ] ) for the considered class of stochastic programs although the integrands do not satisfy standard requirements in qmc analysis , e.g.",
    ", do not belong to the weighted tensor product sobolev space ( [ wsob ] ) .    as a first step in this direction we show in section [ anovatwostage ] that all anova terms except the one of highest order",
    "are continuously differentiable and possess second order partial derivatives almost everywhere under some geometric condition on the second stage program . in particular , the first and second order anova terms belong to the tensor product sobolev space ( [ wsob ] ) .",
    "error estimates show that the qmc convergence rate dominates the error if the effective superposition dimension is equal to @xmath72 ( remark [ r1 ] ) .",
    "in addition , we show in section [ generic ] that the geometric condition is satisfied for almost all covariance matrices if the underlying random vector is gaussian .",
    "the meaning of ",
    "almost all  is also explained there .",
    "we also provide estimates of sensitivity indices and mean dimension in section [ sens ] and discuss techniques for dimension reduction . in accordance with the theoretical results in section [ anovatwostage ] our preliminary computational results in section [ compexp ] show that scrambled sobol sequences and randomly shifted lattice rules applied to a large scale two - stage stochastic program achieve convergence rates close to the optimal rate ( [ rate ] ) if principal component analysis ( pca ) is employed for dimension reduction .",
    "randomized quasi - monte carlo algorithms ( rqmc ) permit us to combine the good features of monte carlo within quasi - monte carlo methods for practical error estimation .",
    "if @xmath78 has mixed partial derivatives of second order in each variable in @xmath84^d)$ ] , then the convergence rate can be improved to nearly @xmath85 by embedding the function into an appropriate korobov space through the so called _ tent _ or _ baker s",
    "_ transformation ( see ( * ? ? ? * section 5 ) ) .",
    "although this is theoretically true , this `` extra '' improved rate of convergence ( over the already good @xmath1 ) for smoother integrands is rarely observed for rqmc in practical applications of high - dimensional integration where only moderate or small sample sizes @xmath24 are affordable for computations @xcite .    a large class of qmc rules that can be randomized",
    "are the well known @xmath86-nets and @xmath87-sequences @xcite .",
    "the randomization techniques for these constructions follow mainly two schemes : _ random digital shifts _ and _ random scramblings_. random digital shifting of @xmath86-nets and @xmath87-sequences can be performed in a similar way as mentioned for randomly shifting lattice rules , but the operations to add the shift must be carried out in the basis @xmath88 used to define the @xmath86-nets ( see ( * ? ? ?",
    "* section 6 ) ) .",
    "the resulting rqmc point set preserves the original net structure .",
    "similar bounds for the root mean square error as in can be obtained for integrands belonging to the weighted ( anchored and unanchored ) tensor product sobolev space @xmath37 by using a special class of @xmath86-nets called _ polynomial lattice rules _ , see again ( * ? ? ?",
    "* section 6 ) .",
    "+ the scrambling method was first introduced by owen in @xcite .",
    "the basic properties of owen s scrambling are the following :    ( * equidistribution * ) + a randomized @xmath86-net in base @xmath88 using owen s scrambling is again a @xmath86-net in base @xmath88 with probability 1 .",
    "a randomized @xmath87-sequence in base @xmath88 using owen s scrambling is again a @xmath87-sequence in base @xmath88 with probability 1 .",
    "( * uniformity * ) + let @xmath89 be the randomized version of a point @xmath90 originally belonging to a @xmath86-net in base @xmath88 or a @xmath87-sequence in base @xmath88 , using owen s scrambling",
    ". then @xmath89 has a uniform distribution in @xmath75 , that is , for any lebesgue measurable set @xmath91 , @xmath92 , with @xmath93 the @xmath8-dimensional lebesgue measure .",
    "note that the uniformity property stated above ensures that the resulting rqmc estimator @xmath94 is unbiased .",
    "we mention here the general results about the variance of a rqmc estimator @xmath94 after owen s random scrambling technique to @xmath86-nets in base @xmath88 for functions @xmath95^d)$ ] ( see @xcite ) .",
    "[ t1 ] let @xmath89 , @xmath96 , be the points of a scrambled @xmath86-net in base @xmath88 , and let @xmath78 be a function on @xmath75 with integral @xmath97 and variance @xmath98 let @xmath99 with @xmath100 be the rqmc estimator .",
    "then its variance @xmath101 has the properties @xmath102 for @xmath103 we have @xmath104    note that the last inequality for @xmath103 above holds since in this case one must have @xmath105 .",
    "if the function @xmath78 has bounded variation in the sense of hardy and krause @xmath106 , then by the equidistribution property stated above the classical koksma - hlawka inequality holds with probability 1 for random scrambled @xmath86-nets , therefore the classical discrepancy bounds for @xmath86-nets @xcite lead to @xmath107 if the integrand @xmath78 has a mixed partial derivatives of order @xmath8 which satisfies a hlder condition , the above rate of convergence can be improved to @xcite @xmath108 further improved results for functions having _ finite generalized hardy and krause variation _ can be found in ( * ? ? ?",
    "* theorem 13.25 ) .",
    "note , however , that distinct from ( [ rate ] ) sequences of the form @xmath109 increase as long as @xmath110 and , hence , require extremely large sample sizes @xmath24 for higher dimensons @xmath8 to get small .",
    "the piecewise linear convex functions arising in stochastic programming ( see section [ twostage ] ) do even not have mixed partial derivatives ( in the sense of sobolev ) in general .",
    "they do not have finite ( generalized ) hardy and krause variation , too .",
    "the latter is shown for the classical hardy and krause variation of the special function @xmath111 in ( * ? ? ?",
    "* proposition 17 ) , but its proof carries over to the generalized variation . thus , none of the results stated or mentioned above for rqmc can be used to formally justify an observed root mean square error convergence near to @xmath112 ( see section [ compexp ] ) for integrands appearing in linear two - stage stochastic programming .",
    "several modifications of the original scrambling method proposed by owen have been investigated in order to provide efficient implementations of scramblings for practical applications , see the survey @xcite and @xcite for example .",
    "+ recent qmc constructions that aim to advantage from a setting with even higher smoothness of the integrands are the so called _ higher order digital nets _ in combination with _ higher order scramblings_. for further information on this topic we refer the reader to @xcite .",
    "as described in the introduction , the integrands of two - stage linear stochastic programs with random right - hand sides are @xmath113 where @xmath114 denotes the optimal value function assigning to each @xmath115 the infimum @xmath116 in @xmath117 . due to duality in linear programming ,",
    "the function @xmath114 is finite and @xmath118 if @xmath119 and the dual feasible set @xmath120 is nonempty . here ,",
    "@xmath20 , @xmath18 is a @xmath19-matrix and @xmath121 varies in the polyhedral cone @xmath122 . if @xmath123 is nonempty , it is of the form @xmath124 where @xmath125 are the vertices of @xmath123 , @xmath126 means convex hull and @xmath127 is the polar cone to the cone @xmath128 , i.e. , @xmath129 furthermore , there exist polyhedral cones @xmath130 , @xmath131 , decomposing @xmath132 .",
    "the cone @xmath130 is the normal cone to the vertex @xmath133 , i.e. , @xmath134 moreover , @xmath135 and @xmath136 .",
    "the intersection @xmath137 for @xmath138 coincides with a common closed face of dimension less than @xmath8 .",
    "it is a common closed face of dimension @xmath139 iff the two cones are adjacent . in the latter case , the intersection is contained in @xmath140 if there exists @xmath141 such that the @xmath142th components of @xmath133 and @xmath143 coincide , the common closed face of @xmath130 and @xmath144 contains at least one of the two one - dimensional cones @xmath145 the cones @xmath130 may also be represented by @xmath146 where @xmath147 are the columns of @xmath18 and @xmath148 .",
    "each vertex @xmath133 is determined by @xmath149 linear independent equations out of the @xmath150 equations @xmath151 , @xmath152 .    in the following we assume + * ( a1 ) * @xmath153 for all @xmath154 , @xmath155 ( _ relatively complete recourse _ ) . + * ( a2 ) * the dual feasible set @xmath123 is nonempty ( _ dual feasibility _ ) . + * ( a3 ) * @xmath156 ( _ finite first moment _ ) . + * ( a4 ) * @xmath16 has a density of the form @xmath157 ( @xmath154 ) , where @xmath158 is a continuous ( marginal ) density on @xmath159 , @xmath160 ( _ independent components _ ) . + * ( a5 ) * all components of the adjacent vertices of @xmath123 are distinct , i.e. , all common closed faces of the normal cones to two adjacent vertices of @xmath123 do not parallel any coordinate axis ( _ geometric condition _ ) .",
    "+ conditions ( a1 ) , ( a2 ) , ( a3 ) imply that the two - stage stochastic program ( [ twost ] ) is well defined and represents an optimization problem with finite convex objective and polyhedral convex feasible set . if @xmath4 is compact its optimal value @xmath161 is finite and its solution set @xmath162 is nonempty , closed and convex . the quantitative stability results ( * ? ? ?",
    "* theorems 5 and 9 ) for general stochastic programs imply the perturbation estimate @xmath163 where @xmath164 is the unit ball in @xmath5 , @xmath165 is the growth function of the objective @xmath166 its inverse is defined by @xmath167 , and @xmath168 is a probability measure satisfying ( a3 ) , too .",
    "for further information on linear parametric programming and two - stage stochastic programming we refer to @xcite and @xcite .    to give an example for ( [ twost ] ) we show that option pricing models considered as stimulating examples for the recent developments in qmc theory ( see e.g. @xcite ) may be reformulated as linear two - stage stochastic programs .    [ option ]",
    "let the first stage variable @xmath169 represent the strike price at the expiration date @xmath170 .",
    "the dimensions are set to @xmath171 , @xmath172 and the matrix @xmath18 is set to @xmath173 with @xmath174 and @xmath149 denoting the risk - free interest rate .",
    "the second stage program and its dual are @xmath175 the terminal payoff is @xmath176 and @xmath177 and @xmath178 are the only vertices .",
    "taking the expectation then leads to the optimization model @xmath179 for maximizing the strike price .",
    "now , it depends on the kind of option how the random variable @xmath7 depends on the geometric brownian motion @xmath180 given by @xmath181 with volatility @xmath182 and standard brownian motion @xmath183 .",
    "for example , for arithmetic asian options one has @xcite",
    "@xmath184    hence , in a sense , the integrands ( [ int2st ] ) , ( [ primdual ] ) extend the situations encountered in such option pricing models .",
    "they are , however , much more involved than in example [ option ] .",
    "the analysis of variance ( anova ) decomposition of a function was first proposed as a tool in statistical analysis ( see @xcite and the survey @xcite ) . in @xcite it was first used for the analysis of quadrature methods .",
    "we consider a density function @xmath185 on @xmath10 and assume ( a4 ) from section [ twostage ] . as in @xcite",
    "we consider the weighted @xmath186 space over @xmath10 , i.e. , @xmath187 , with the norm @xmath188 let @xmath189 and @xmath190 .",
    "the projection @xmath191 , @xmath192 , is given by @xmath193 clearly , the function @xmath194 is constant with respect to @xmath195 .",
    "for @xmath196 we use @xmath197 for its cardinality , @xmath198 for @xmath199 and write @xmath200 where the product means composition .",
    "we note that the ordering within the product is not important because of fubini s theorem .",
    "the function @xmath201 is constant with respect to all @xmath195 , @xmath202 .",
    "note that @xmath203 satisfies the properties of a projection , namely , @xmath203 is linear and @xmath204 .",
    "the anova decomposition of @xmath190 is of the form @xcite @xmath205 with @xmath206 depending only on @xmath207 , i.e. , on the variables @xmath208 with indices @xmath209 .",
    "it satisfies the property @xmath210 for all @xmath209 and the recurrence relation @xmath211 it is known from @xcite that the anova terms are given explicitly by @xmath212 where @xmath213 and @xmath214 mean integration with respect to @xmath208 , @xmath215 and @xmath216 , respectively .",
    "the second representation motivates that @xmath206 is essentially as smooth as @xmath217 due to the inheritance theorem ( * ? ? ?",
    "* theorem 2 ) .",
    "the following result is well known ( e.g. @xcite ) .",
    "[ p1 ] if @xmath78 belongs to @xmath218 , the anova functions @xmath219 are orthogonal in @xmath218 .",
    "we define the variance of @xmath78 and @xmath206 by @xmath220 , @xmath221 , and have @xmath222 in the literature , the anova decomposition is often considered for functions @xmath223^{d})$ ]",
    ". then the projections are defined by @xmath224^{d})\\ ] ] and @xmath225 similarly to the case in @xmath226 the anova decomposition of @xmath223^{d})$ ] is of the form @xmath227 with @xmath228 depending only on @xmath229 , i.e. , on the variables @xmath230 with indices @xmath209 .",
    "note that @xmath231 is indeed again a projection and , assuming that @xmath232^{d})$ ] , the same orthogonality property ( now over @xmath233^{d})$ ] ) as in proposition 3.1 follows .",
    "assuming now for simplicity that @xmath234 for all @xmath235 , @xmath236 , an integrand @xmath190 can be transformed into a function @xmath237 defined on @xmath83^d$ ] by inverting the function @xmath238 and by defining @xmath239^{d}\\setminus ( 0,1)^{d}. \\end{cases}\\ ] ] then the anova terms @xmath228 of @xmath237 are @xmath240 where @xmath241 when setting @xmath242^{|u| } } g^2_{u}(\\upsilon^{u } ) d\\upsilon^{u}$ ] for @xmath243 and @xmath244 one obtains @xmath245 for @xmath196 .",
    "we return to the @xmath10 and assume @xmath246 in the following to avoid trivial cases .",
    "the _ normalized ratios _",
    "@xmath247 serve as indicators for the importance of the variable @xmath207 in @xmath78 .",
    "they are used in @xcite to define _ global sensitivity indices _ of a set @xmath196 by @xmath248 if @xmath249 is small , then the variable @xmath207 is considered inessential for @xmath78 in @xcite .",
    "the normalized ratios are also used in @xcite to define and study the _ dimension distribution _ of a function @xmath78 in two ways .",
    "the dimension distribution of @xmath78 in the _ superposition ( truncation ) sense _ is a probability measure @xmath250 ( @xmath251 ) defined on the power set of @xmath252 by @xmath253 hence , the _ mean dimension _ in the superposition ( truncation ) sense is @xmath254 it is proved in ( * ? ? ?",
    "* theorem 2 ) that the mean dimension @xmath255 in the superposition sense is closely related to the global sensitivity indices of subsets of @xmath252 containing a single element .",
    "namely , @xmath256 the paper @xcite also provides a formula for the dimension variance based on @xmath249 for all subsets @xmath257 of @xmath252 containing two indices .    for small @xmath258",
    "( @xmath259 is suggested in a number of papers ) , the _ effective superposition ( truncation ) dimension _ @xmath260 ( @xmath261 ) is the @xmath262-quantile of @xmath250 ( @xmath251 ) , i.e. , @xmath263 note that @xmath264 and ( see @xcite ) @xmath265 small effective superposition dimension @xmath266 , even if @xmath267 is large , suggests that we may expect superiority of qmc over mc .",
    "we note that there exist algorithms based on mc or qmc to compute global sensitivity indices and effective dimensions approximately ( see @xcite for example ) .",
    "since the algorithms are often described for functions on @xmath83^{d}$ ] , we mention that    * the dimension distribution and , hence , any effective dimension of @xmath78 is the same as for @xmath237 given by ( [ anova01 ] ) . *",
    "the algorithm of @xcite for estimating the effective truncation dimension can be carried out equivalently for @xmath78 , with its obvious adaption to the @xmath10 setting .",
    "all these notions are discussed in @xcite for different classes of functions , including additive and multiplicative functions .",
    "we record here the results for additive functions for later reference .",
    "[ e0 ] for functions",
    "@xmath78 having separability structure , i.e. , @xmath268 with @xmath269 , @xmath236 , the anova terms are ( see @xcite ) @xmath270 where @xmath271 , @xmath272 , @xmath236 .",
    "hence , one obtains for the global sensitivity indices , and the mean dimension in the superposition and truncation sense , respectively , @xmath273 while the superposition and truncation dimensions are @xmath274 with @xmath275 .",
    "the importance of the anova decomposition in the context of this paper is also due to the fact that the functions @xmath206 can be ( much ) smoother than the original integrand @xmath78 under some conditions ( see @xcite and the next section ) .",
    "according to section [ twostage ] the integrands in linear two - stage stochastic programming map from @xmath10 to @xmath159 and are given by @xmath276 where the @xmath133 , @xmath277 , are the vertices of the dual feasible set @xmath278 and @xmath130 are the normal cones to @xmath133 , @xmath277 .",
    "we assume that the affine function @xmath9 is of the form @xmath279 with some fixed element @xmath280 .",
    "the integrands are parametrized by the first - stage decision @xmath169 varying in @xmath4 .",
    "such functions do not belong to the tensor product sobolev spaces described in section [ intro ] and , in general , are not of bounded variation in the sense of hardy and krause ( see ( * ? ? ?",
    "* proposition 17 ) ) .",
    "next we intend to compute projections @xmath281 for @xmath192 .",
    "let @xmath155 be fixed , @xmath282 , @xmath160 , @xmath283 , be given .",
    "we set @xmath284 and @xmath285 .",
    "we assume ( a1)(a5 ) and have according to section [ twostage ] @xmath286 for every @xmath287 and by definition of the projection @xmath288 the one - dimensional affine subspace @xmath289 intersects a finite number of the polyhedral cones @xmath130 . hence , there exist @xmath290 , @xmath291 , @xmath292 , and @xmath293 , @xmath294 , such that @xmath295 and @xmath296\\\\ ( \\xi_{s}^{k},\\bar{h})-tx&\\in&{\\mathcal{k}}_{j_{i}}\\quad\\quad\\forall s\\in[s_{i-1},s_{i}]\\quad(i=2,\\ldots , p)\\\\ ( \\xi_{s}^{k},\\bar{h})-tx&\\in&{\\mathcal{k}}_{j_{p+1}}\\quad\\forall s\\in[s_{p},+\\infty).\\end{aligned}\\ ] ] by setting @xmath297 , @xmath298 , we obtain the following explicit representation of @xmath194 @xmath299 where the points @xmath300 , @xmath292 , satisfy the equations @xmath301 according to ( [ subspace ] ) . by setting @xmath302 for @xmath292 and @xmath303",
    "this leads to the explicit formula @xmath304\\quad(i=1,\\ldots , p).\\ ] ] hence , all @xmath300 , @xmath292 , are affine functions of the remaining components @xmath208 , @xmath305 .",
    "the first step in our analysis consists in studying smoothness properties of the projection @xmath194 on @xmath10 .",
    "we note that @xmath78 and @xmath194 are finite convex functions on @xmath10 and , hence , twice differentiable almost everywhere due to alexandroff s theorem ( see , for example , ( * ? ? ?",
    "* section 6.4 ) ) .",
    "our analysis shows that the integration in ( [ pkf ] ) improves the smoothness properties .",
    "in the following , we consider a point @xmath306 and an open ball @xmath307 .",
    "assume that the ball @xmath307 is small enough such that the set of cones @xmath308 satisfies @xmath309 for @xmath310 .",
    "thus , the relevant interception cones are fixed in a neighboring ball @xmath311 of @xmath312 .",
    "we consider also the sets of intercepted cones at an arbitrary point @xmath313 @xmath314 note that each polyhedral convex cone @xmath315 in @xmath316 contains at least one point of the affine one dimensional space @xmath317 , therefore we have @xmath318 moreover , since the cones @xmath315 are convex , the intersection of a cone @xmath315 with the affine one dimensional space @xmath319 is given either by a single point or by an interval . in case that the intersection is given by an interval @xmath320 , we have due to ( a5 ) that the interior of @xmath320 , denoted @xmath321 , contains only interior points of @xmath315 and , hence , of @xmath10 .",
    "this is true because otherwise the interval @xmath320 must lie in a facet of @xmath315 , and this would imply that there is a facet that is parallel to one of the canonical basis elements @xmath322 , @xmath323 , in contradiction to ( a5 ) .",
    "this implies that we can partition the affine one - dimensional space @xmath319 by considering the intervals @xmath324 , @xmath325 , such that @xmath326 recall that @xmath327 and @xmath328 .",
    "it follows also that for each point @xmath329 , the resulting point @xmath330 satisfies @xmath331 for a set of cones @xmath332 , and that we have @xmath333 , @xmath334 for @xmath335 , and @xmath336 .",
    "now , we are ready to state our first result on smoothness properties of @xmath194 .",
    "[ t2 ] let @xmath192 and @xmath155 .",
    "assume ( a1)(a5 ) and let @xmath337 be the integrand ( [ integr ] ) of the linear two - stage stochastic program ( [ twost ] ) .",
    "then the @xmath142th projection @xmath194 of @xmath78 is continuously differentiable on @xmath10 .",
    "@xmath194 is @xmath338-times continuously differentiable almost everywhere if the density @xmath339 belongs to @xmath340 for some @xmath341 , @xmath342 .    in the following ,",
    "we consider two possible cases for a given ball @xmath307 satisfying the requirement described above : + * @xmath343 . )",
    "* the set of intercepted cones is the same for every @xmath344 , that is , @xmath345 * @xmath346 . ) * the set of intercepted cones @xmath347 varies for @xmath348 .",
    "+ for the case * @xmath343 . ) * , we have that the limiting functions @xmath300 are differentiable over the entire neighborhood @xmath307 , because they admit a representation as an affine function over the whole ball @xmath307 .",
    "thus , we obtain from ( [ pkf1 ] ) for any @xmath349 , @xmath350 , that @xmath194 is partially differentiable with respect to @xmath351 at @xmath352 and @xmath353 where we used the identity @xmath354 for each @xmath292 and @xmath355 denotes the marginal distribution function with density @xmath339 . by reordering the latter sum we have @xmath356 hence ,",
    "the behavior of all first order partial derivatives of @xmath194 only depends on the @xmath142th marginal distribution function @xmath355 .",
    "the latter are again differentiable and it follows for @xmath357 , @xmath358 , @xmath359 hence , @xmath194 is second order continuously differentiable on the neighborhood @xmath307 . more generally , if @xmath360 for some @xmath341 , @xmath342 , @xmath194 is @xmath338-times continuously differentiable on the neighborhood @xmath307 .",
    "for the case * @xmath346 . ) * , we consider @xmath361 and the corresponding projection @xmath362 since , as mentioned above , there is a partition of the affine one - dimensional space @xmath319 into intervals , each one contained in the interior of different cones , we can consider actually @xmath363 to be small enough such that the affine space @xmath364 contains intervals each one contained in the interior set of the same mentioned cones .",
    "moreover , due to ( a5 ) and the finite cone decomposition we must have @xmath365 and @xmath366 .",
    "thus we can modify our notation to write @xmath367 where for each vertex @xmath368 , @xmath369 , we have a corresponding cone @xmath370 , and for simplicity we omitted in the notation the dependence of @xmath371 on @xmath372 .",
    "the functions @xmath373 , @xmath374 , @xmath369 , are affine since they can be obtained through equation by considering the corresponding neighboring cones belonging to @xmath375 , @xmath376 .",
    "moreover , we have @xmath377 , @xmath376 .",
    "note also that in this representation we can have @xmath378 for some @xmath376 , meaning in this case that the corresponding sum of integral terms vanishes , and we only have to consider the corresponding limiting function @xmath379 .",
    "+ we show now the existence of partial derivatives @xmath380 , @xmath350 , at @xmath381 . because no facet of the cones is parallel to the canonical basis element @xmath382 , we have that there exists @xmath383 such that @xmath384 , for all elements @xmath352 in the line segment @xmath385 $ ] .",
    "thus , there exist corresponding continuous limiting functions , denoted by @xmath386 , @xmath387 , that are affine , defined on @xmath385 $ ] , and for which the derivative exist on the open segment @xmath388 . by using the univariate mean - value theorem we have for @xmath389 @xmath390 @xmath391 for some @xmath392 .",
    "we also have that @xmath393 } \\rho_{k}(s)\\left ( b_{i , m_i}(\\xi^{k}_0 + e_l \\mu)-b_{i,1}(\\xi^{k}_0 + e_l \\mu ) \\right),\\end{aligned}\\ ] ] where @xmath394 } b_{i,1}(\\xi)$ ] and @xmath395 } b_{i , m_i}(\\xi)$ ] .",
    "+ because @xmath396 , @xmath376 , we can divide both sides of the above equality by @xmath397 , and then take @xmath398 to obtain @xmath399 a similar argument in the opposite direction , that is on the segment @xmath400 , shows that in fact we obtain @xmath401 and , hence , the same representation as in ( [ firstpartial ] ) .",
    "because this argument is valid for each point @xmath402 , we have that all first order partial derivatives of @xmath194 exist at each point of @xmath403 .",
    "note that partial differentiability with respect to @xmath195 holds by definition .",
    "+ to prove that a partial derivative @xmath404 is continuous at @xmath312 for the case * @xmath346 . ) * , we consider a sequence of points @xmath405 converging to @xmath312 .",
    "then for each point @xmath406 we have @xmath407 where we introduced the short notation @xmath408 .",
    "note that if we have a limiting function @xmath409 obtained trough equation by two adjacent cones @xmath410 , then we have that @xmath409 is affine , and @xmath411 .",
    "moreover , by considering that are finite many different cones contained in @xmath412 , it is clear that we can have at most finite many possible different limiting functions @xmath409 that can be obtained from two adjacent cones @xmath413 by .",
    "let us denote by @xmath414 the maximum , and by @xmath415 the minimum , of all such limiting functions @xmath409 over @xmath307 .",
    "then we have that @xmath414 and @xmath415 are continuous on @xmath307 .",
    "we also have that @xmath416 .",
    "thus we have @xmath417 } \\rho_{k}(s ) \\left ( \\overline{a}_{s_i}(\\xi^{k}_n ) - \\underline{a}_{s_i}(\\xi^{k}_n ) \\right),\\end{aligned}\\ ] ] where @xmath418 , and @xmath419 .",
    "+ by letting @xmath420 the the right - hand side of the latter inequality tends to zero .",
    "this holds for @xmath376 .",
    "therefore , we obtain @xmath421 which proves continuity of @xmath422 under the case * @xmath346 . ) * . + by combining both * @xmath343 . )",
    "* and * @xmath346 . ) * @xmath194 is continuously differentiable on @xmath10",
    ". @xmath423    [ c1 ] let @xmath243 and @xmath155 .",
    "assume ( a1)(a5 ) .",
    "then the projection @xmath201 is continuously differentiable on @xmath10 and second order continuously differentiable almost everywhere in @xmath10 .    if @xmath424 the result follows from theorem [ t2 ] .",
    "for @xmath425 with @xmath426 , @xmath427 , we obtain from the leibniz theorem ( * ? ? ?",
    "* theorem 1 ) for @xmath428 and @xmath429 @xmath430 and from the proof of theorem [ t2 ] @xmath431 if @xmath257 contains more than two elements , the integrals on the right - hand side become multiple integrals . in all cases , however , such an integral is a continuous function of the remaining variables @xmath432 , @xmath433 .",
    "this can be shown using lebesgue s theorem as @xmath355 and @xmath339 are continuous and bounded on @xmath159 .",
    "@xmath423    the following is the main result of this section .",
    "[ t3 ] assume ( a1)(a5 ) .",
    "then all anova terms of @xmath78 except the one of highest order are first order continuously differentiable on @xmath10 and all second order partial derivatives exist are continuous except in a set of lebesgue measure zero and quadratically integrable with respect to the density @xmath185 . in particular , the first and second order anova terms of @xmath78 belong to the tensor product sobolev space @xmath434 .    according to ( [ anova ] ) the anova terms of @xmath78",
    "are defined by @xmath435 for all nonempty subsets @xmath257 of @xmath252 .",
    "hence , all anova terms of @xmath78 for @xmath436 are continuously differentiable on @xmath10 .",
    "second order partial derivatives of those anova terms exist and are continuous at least at those @xmath7 such that @xmath437 belongs to the interior of some cone @xmath130 , i.e. , almost everywhere in @xmath10 .",
    "the non - vanishing first order partial derivatives of the second order anova terms are of the form @xmath438 for all @xmath439 and some @xmath192 . since @xmath355 is lipschitz continuous , the function @xmath440 is lipschitz continuous , too , and , hence , partially differentiable with respect to @xmath441 in the sense of sobolev ( see , for example , ( * ? ? ?",
    "* section 4.2.3 ) ) .",
    "furthermore , the second order partial derivative is a bounded function ( see also ( [ secondpartial ] ) ) and due to ( a3 ) quadratically integrable with respect to @xmath185 .",
    "@xmath423    [ r1 ] the second order anova approximation of @xmath78 , i.e. , @xmath442 belongs to the tensor product sobolev space @xmath434 .",
    "hence , if the effective superposition dimension is at most 2 , @xmath443 is a good approximation of @xmath78 due to ( [ errdim ] ) and favorable behavior of randomly shifted lattice rules may be expected .",
    "the following two examples show that conditions ( a1)(a5 ) are necessary for the first order continuous differentiability of projections , but , in general , do not imply continuity of second order partial derivatives of the projections .",
    "[ ex3 ] let @xmath444 , @xmath445 , @xmath446 , @xmath16 denote a probability distribution with independent marginal densities @xmath447 , @xmath448 , whose means are w.l.o.g .",
    "equal to @xmath449 .",
    "we assume that ( a3 ) is satisfied for @xmath16 .",
    "let the vector @xmath450 and matrix @xmath18 @xmath451 be given .",
    "then ( a1 ) and ( a2 ) are satisfied and the dual feasible set @xmath123 is @xmath452 i.e. , @xmath123 is a triangle and has the three vertices @xmath453    ( 200,150 ) ( 0,50)(1,0)200 ( 100,50)(0,1)100 ( 100,50 ) ( 60,50 ) ( 100,90 ) ( 140,50 ) ( 60,50)(1,1)40 ( 100,90)(1,-1)40 ( 60,50)(1,0)80 ( 40,30)(0,0)[t]@xmath454 ( 160,30)(0,0)[t]@xmath455 ( 120,110)(0,0)[t]@xmath456 ( 95,45)(0,0)[t]@xmath449 ( 108,100)(0,0)[t]@xmath457 ( 60,45)(0,0)[t]@xmath458 ( 140,45)(0,0)[t]@xmath459 ( 120,60)(0,0)[t]@xmath123    [ fig1 ]    hence , the second component of the two adjacent vertices @xmath459 and @xmath458 coincides . according to ( [ nc ] ) the normal cones @xmath130 to @xmath123 at @xmath133 , @xmath460 , are @xmath461 the function @xmath462 ( see ( [ int2st ] ) ) is of the form @xmath463 and the two - stage stochastic program is @xmath464_{1}| , \\xi_{2}-[tx]_{2}\\}\\rho(\\xi)d\\xi : x\\in x\\big\\}.\\ ] ] the anova projection @xmath465 is defined by @xmath466_{1}| , \\xi_{2}-[tx]_{2}\\}\\rho_{1}(\\xi_{1})d\\xi_{1}\\quad(\\xi_{2}\\in{\\mathbb{r}}).\\ ] ] for @xmath467_{2}\\le 0 $ ] one obtains @xmath468_{1}|\\rho_{1}(\\xi_{1})d\\xi_{1}\\\\ & = & \\int_{-\\infty}^{+\\infty}(\\xi_{1}-[tx]_{1})\\rho_{1}(\\xi_{1})d\\xi_{1}-2\\int_{-\\infty}^{[tx]_{1 } } ( \\xi_{1}-[tx]_{1})\\rho_{1}(\\xi_{1})d\\xi_{1}\\end{aligned}\\ ] ] and in case @xmath467_{2}\\ge 0 $ ] @xmath469_{1}|\\rho_{1}(\\xi_{1})d\\xi_{1}-\\ ! \\int_{0}^{\\xi_{2}-[tx]_{2}}\\!\\!\\!\\!\\!(\\xi_{1}+\\xi_{2}-[tx]_{1}-[tx]_{2})\\rho_{1}(\\xi_{1})d\\xi_{1}.\\end{aligned}\\ ] ] hence , @xmath465 belongs to @xmath470 for all @xmath155 if @xmath185 is continuous . + when calculating the anova projection @xmath471 , notice that assumption ( a5 ) is violated .",
    "we obtain @xmath472_{1}|\\int_{-\\infty}^{|\\xi_{1}-[tx]_{1}|}\\rho_{2}(\\xi_{2})d\\xi_{2}+ \\int_{|\\xi_{1}-[tx]_{1}|}^{+\\infty}(\\xi_{2}-[tx]_{2})\\rho_{2}(\\xi_{2})d\\xi_{2}\\ ] ] and _ @xmath471 does not belong to @xmath470 _ for all @xmath155 .",
    "[ ex4 ] let @xmath444 , @xmath445 , @xmath16 denote a two - dimensional probability distribution with independent continuous marginal densities @xmath447 , @xmath448 , whose means are w.l.o.g .",
    "equal to @xmath449 .",
    "again we assume that ( a3 ) is satisfied for @xmath16 .",
    "let the vector @xmath450 and matrix @xmath18 @xmath473 be given .",
    "then ( a1 ) and ( a2 ) are satisfied and the dual feasible set @xmath123 is @xmath474 i.e. , @xmath123 is also a triangle and has the three vertices @xmath475 hence , both components of the vertices @xmath133 , @xmath460 , are distinct .",
    "this means that ( a4 ) and ( a5 ) are satisfied .",
    "the normal cones @xmath130 to @xmath123 at @xmath133 , @xmath460 , are @xmath476    ( 200,150 ) ( 0,50)(1,0)200 ( 100,0)(0,1)150 ( 100,50 ) ( 60,50 ) ( 100,90 ) ( 180,10 ) ( 60,50)(1,1)40 ( 100,90)(1,-1)80 ( 60,50)(3,-1)120 ( 93,46)(0,0)[t]@xmath449 ( 108,100)(0,0)[t]@xmath457 ( 60,45)(0,0)[t]@xmath458 ( 190,15)(0,0)[t]@xmath459 ( 120,43)(0,0)[t]@xmath123 ( 198,45)(0,0)[t]@xmath477 ( 95,148)(0,0)[t]@xmath478    [ fig2 ]    the function @xmath114 is of the form @xmath479 and the two - stage stochastic program is @xmath480_{1},\\xi_{2}-[tx]_{2 } ) \\rho_{1}(\\xi_{1})\\rho_{2}(\\xi_{2})d\\xi_{1}d\\xi_{2}:x\\in x\\big\\}.\\ ] ] then its anova projection @xmath465 is given by @xmath481_{1})-\\xi_{2}+[tx]_2 , -s+[tx]_{1},\\xi_{2}-[tx]_{2}\\}\\rho_{1}(s)ds\\ ] ] for every @xmath482 .",
    "for simplicity let @xmath483 .",
    "first let @xmath484 .",
    "@xmath485 where @xmath486 and @xmath487 .",
    "hence , @xmath488 now , we compute the partial derivatives for @xmath484 and obtain @xmath489 @xmath465 is for @xmath484 @xmath338-times continuously differentiable if @xmath490 for any @xmath341 .",
    "+ now , let @xmath491 .",
    "then we obtain with @xmath492 @xmath493 @xmath465 is for @xmath494 @xmath338-times continuously differentiable if @xmath490 for any @xmath341 .",
    "+ hence , _",
    "@xmath465 belongs to @xmath470 _ , but its second derivative is discontinuous at @xmath495 .",
    "the same holds for @xmath471 .",
    "[ r2 ] ( error estimate ) + if the assumptions of theorem [ t3 ] are satisfied and all marginal densities @xmath496 , @xmath497 , are positive , all anova terms @xmath228 , @xmath498 , of @xmath237 given by ( [ anova01 ] ) belong to the tensor product sobolev space ( [ wsob ] ) .",
    "then the qmc quadrature error may be estimated as follows : @xmath499^{d}}g(x)dx - n^{-1}\\sum_{j=1}^{n}g(x^{j})\\big|\\\\ \\nonumber & \\leq&\\sum_{0<|u|\\le d}\\big|\\int_{[0,1]^{d}}g_{u}(x^{u})dx^{u}- n^{-1}\\sum_{j=1}^{n}g_{u}(x^{j})\\big|\\\\ \\label{est3 } & \\leq&\\sum_{|u|=1}^{2}{\\rm disc}_{n , u}(x^{1},\\ldots , x^{n})\\|g_{u}\\|_{\\gamma}+\\\\ \\label{est4 } & & \\sum_{|u|=3}^{d}\\big|\\int_{[0,1]^{d}}g_{u}(x)dx - n^{-1}\\sum_{j=1}^{n}g_{u}(x^{j})\\big|,\\end{aligned}\\ ] ] where @xmath500 , @xmath27 , @xmath160 , are the qmc points and @xmath501 is the weighted @xmath0- discrepancy @xmath502^{|u|}}{\\rm disc}_{u}^{2}(x^{u})dx^{u},\\ ] ] where the discrepancy @xmath503 is given by @xmath504 and @xmath505 the weighted norm of @xmath228 given by ( [ wnorm ] ) in the weighted tensor product sobolev space ( [ wsob ] ) .",
    "recalling the arguments in the introduction one may conclude that all terms in ( [ est3 ] ) converge with the optimal rate ( [ rate ] ) while all terms in ( [ est4 ] ) also converge to @xmath449 due to proinov s convergence result @xcite ( as the @xmath228 are continuous ) .",
    "in addition , the sum ( [ est4 ] ) can be further estimated by @xmath506^{d}}g_{u}^{2}(x)dx+n^{-1 } \\sum_{j=1}^{n}g_{u}^{2}(x^{j})\\big)=\\sum_{|u|=3}^{d}\\big ( \\|f_{u}\\|_{l_{2}}^{2}+n^{-1}\\sum_{j=1}^{n}f_{u}^{2}(\\xi^{j})\\big).\\ ] ] since ( [ errdim ] ) implies @xmath507 if @xmath508 and the second term on the right - hand side of ( [ errterm ] ) represents a qmc approximation of the first term , we may conclude that the term in ( [ est4 ] ) is of the form @xmath509 . hence , we obtain the estimate @xmath510 if the condition @xmath508 is satisfied .",
    "the latter may eventually be achieved by applying dimension reduction techniques ( see section [ sens ] ) .",
    "moreover , when recalling the results in @xcite , one may hope that the convergence rate for the terms in ( [ est3 ] ) is even better .",
    "finally , we note that the constants involved in the estimate ( [ errorrate ] ) may be chosen to be uniform with respect to @xmath155 . together with the perturbation estimates ( [ valest ] ) and ( [ solest ] ) in section [ twostage ] one , hence , obtains @xmath511 if @xmath508 . here",
    ", @xmath23 is the discrete probability measure representing the qmc method , i.e. , @xmath512 , where @xmath513 denotes the dirac measure placing unit mass at @xmath7 .",
    "we consider the stochastic program ( [ twost ] ) with @xmath514 as in section [ anovatwostage ] and assume that ( a1)(a3 ) is satisfied . further we assume that @xmath515 is of the form @xmath516 with some orthogonal @xmath517 matrix @xmath168 and with @xmath7 satisfying ( a4 ) .",
    "then the relevant integrand is of the form @xmath518 where the @xmath519 matrix @xmath520 is given by @xmath521 with @xmath97 denoting the @xmath522 identity matrix .",
    "hence , the results of section [ anovatwostage ] apply if the vertices @xmath523 , @xmath277 , of the linearly transformed dual feasible set @xmath524 satisfy the corresponding assumptions . the set @xmath524",
    "may be represented in the form @xmath525 the geometric condition on the vertices is violated only if some face of @xmath524 is parallel to some coordinate axis . clearly , there are only countably many orthogonal matrices @xmath168 for which this is the case .",
    "assume now that @xmath7 is normally distributed with zero mean and nonsingular covariance matrix @xmath526 .",
    "let the nonsingular diagonal matrix @xmath252 be the result of a unitary decomposition of @xmath526 , i.e. , @xmath527 with an orthogonal matrix @xmath168 .",
    "if @xmath528 enters the integrand ( [ integr ] ) with given dual feasible polyhedron @xmath123 and vertices @xmath133 , @xmath277 , and @xmath520 is defined as in ( [ hq ] ) , the integrand may be rewritten as @xmath529 as @xmath530 is normal with covariance matrix @xmath252 and , thus , satisfies ( a4 ) , the results of the preceding section apply when using the transformed dual feasible set @xmath531 and normal cones @xmath532 , @xmath277 , respectively",
    ". however , given @xmath123 , there are only countably many orthogonal matrices @xmath168 such that the geometric condition on the vertices of @xmath531 is satisfied . when equipping the metric space of all orthogonal @xmath517 matrices with the standard norm topology , the set of all orthogonal matrices @xmath168 such that @xmath531 satisfies the algebraic condition on the vertices is _ residual _ ,",
    "i.e. , it may be represented as countable intersection of open dense subsets .",
    "it is said that a property is _ generic _ or holds for _ almost all _ elements of a metric space if it holds in a residual set .",
    "[ c2 ] let @xmath155 and assume ( a1)(a3 ) with @xmath528 with fixed @xmath280 to be satisfied .",
    "* the geometric condition that all components of all adjacent vertices of @xmath531 are distinct is a generic property in the space of all @xmath517 orthogonal matrices @xmath168 where @xmath520 is defined by ( [ hq ] ) .",
    "* let @xmath7 be normally distributed with mean @xmath533 and nonsingular covariance matrix @xmath526 , and let the orthogonal matrix @xmath168 be chosen such that @xmath534 .",
    "let @xmath185 be the normal density with mean @xmath535 and covariance matrix @xmath536 .",
    "if @xmath168 belongs to the residual set of orthogonal matrices satisfying the generic property , the anova approximation @xmath443 of @xmath78 given by ( [ secordanova ] ) belongs to the tensor product sobolev space @xmath434 .",
    "while ( a ) is shown above , it remains to note for part ( b ) that ( a4 ) is satisfied and , hence , the result follows from theorem [ t3].@xmath423",
    "in this section we discuss sensitivity and possibilities for reducing the effective dimension of two - stage models .",
    "first , we derive an upper bound for the global sensitivity indices @xmath537 , @xmath160 , and the mean dimension @xmath255 in the superposition sense , respectively .    [ p4 ] let ( a1)(a4 ) with @xmath528 with fixed @xmath280 be satisfied and @xmath538 denote the variance of @xmath432 , @xmath160 .",
    "then @xmath539 where @xmath133 , @xmath277 , are the vertices of the dual polyhedron",
    ".    we use ( * ? ? ?",
    "* theorem 3 ) and compute the partial derivatives of @xmath78 with respect to @xmath432 , @xmath160 , which exist almost everywhere on @xmath10 . if @xmath540 belongs to the cone @xmath130 , then @xmath541_{i})+\\sum_{i = d+1}^{r}v_{i}^{j } ( \\bar{h}_{i}-[tx]_{i}),\\ ] ] where @xmath155 is fixed .",
    "we obtain for @xmath154 such that @xmath540 belongs to the interior of @xmath130 that @xmath542 hence , the partial derivative is piecewise constant and may be bounded from above by @xmath543 . using ( * ? ? ?",
    "* theorem 3 ) this proves our estimate for the global sensitivity index @xmath537 .",
    "the second estimate is a consequence of formula ( [ mdimest]).@xmath423    proposition [ p4 ] indicates that the importance of variable @xmath544 on @xmath78 gets lower if @xmath545 gets smaller .",
    "if @xmath7 is normal with nonsingular covariance matrix @xmath526 , the _ standard _ ( lower triangular ) cholesky matrix @xmath546 performing the factorization @xmath547 seems to assign the same importance to every variable and , hence , is not suitable to reduce the effective dimension ( at least in the truncation sense ) .",
    "this fact is confirmed in our numerical experiments ( see section [ compexp ] ) .",
    "a universal principle for dimension reduction in the normal case is _ principal component analysis _ ( pca ) .",
    "it is universal in the sense that it does not depend on the structure of the underlying integrand @xmath78 .",
    "the basic idea of pca is to determine the best mean square approximation of the form @xmath548 to a @xmath8-dimensional normal random vector @xmath7 , where @xmath549 , @xmath160 , and @xmath550 is normal with mean @xmath449 and covariance matrix @xmath97 .",
    "the solution is @xmath551 and @xmath552 , where @xmath553 are the eigenvalues of @xmath526 in decreasing order and @xmath554 , @xmath160 , the corresponding orthonormal eigenvectors ( see @xcite ) .",
    "hence , pca consists in using the factorization @xmath555 where @xmath556 .",
    "several authors report an enormous reduction of the effective truncation dimension in financial models if pca is used ( see , for example , @xcite ) .",
    "we observed the same effect in our numerical experiments ( see section [ compexp ] ) .",
    "however , the reduction effect certainly depends on the eigenvalues of @xmath526 .",
    "if the ratio @xmath557 is close to @xmath71 , the performance of pca gets worse .",
    "nevertheless we recommend to use first pca and to resort to other ideas only after its failure .",
    "several other _ dimension reduction techniques _",
    "exploit the fact that a normal random vector @xmath7 with mean @xmath558 and covariance matrix @xmath526 can be transformed by @xmath559 and matrix @xmath560 satisfying @xmath561 into a standard normal random vector @xmath562 with independent components .",
    "the choice of @xmath560 may change the qmc error and the effective dimension of the integrand @xmath563 . as observed in @xcite ,",
    "however , there is no consistent dimension reduction effect for any such matrix @xmath560 .",
    "this means that a specific choice of the matrix @xmath560 may result in a dimension reduction for one integrand , but eventually not for another one .",
    "the following observation is seemingly due to @xcite , too ( see also ( * ? ? ?",
    "* lemma 1 ) ) .",
    "[ p5 ] let @xmath526 be a @xmath517 nonsingular covariance matrix and @xmath564 be a fixed @xmath517 matrix such that @xmath565 .",
    "then @xmath561 if and only if @xmath560 is of the form @xmath566 for some orthogonal @xmath517 matrix @xmath168 .",
    "to apply the proposition , one may choose @xmath567 since computing the standard cholesky matrix @xmath546 requires only @xmath568 operations .",
    "then any other decomposition matrix @xmath560 with @xmath561 is of the form @xmath569 with some orthogonal matrix @xmath168 .",
    "the approach proposed in @xcite for linear functions @xmath570 consists in determining a _ good _ orthogonal matrix @xmath168 by minimizing the mean truncation dimension ( [ meandim ] ) .",
    "this approach is extended in @xcite to functions @xmath78 of the form @xmath571 for some function @xmath572 and @xmath573 , @xmath574 , @xmath575 .",
    "the latter is applicable to linear two - stage integrands if the function @xmath572 is chosen as @xmath576 and @xmath577 contains the first @xmath8 components of the vertex @xmath578 of the dual feasible set @xmath123 ( see proposition [ p4 ] ) . of course",
    ", applying the orthogonalization techniques developed in @xcite to two - stage integrands is not straightforward since the vertices @xmath133 of @xmath123 are not known in general and the computation of all of them is too expensive .",
    "so , its application to two - stage stochastic programs requires further work .    for general ( non - normal )",
    "random vectors @xmath7 the influence ( of groups ) of variables and the computation of effective dimensions are studied , e.g. , in @xcite .",
    "for our tests we consider a two - stage stochastic production planning problem which consists in minimizing costs of a company . the company aims to satisfy stochastic demands @xmath579 in a time horizon @xmath580 with multivariate probability distribution @xmath16 ( on @xmath581 ) , but its production capacity based on @xmath97 company owned units does eventually",
    "not suffice to cover the demand .",
    "hence , it has to buy the necessary amounts from other @xmath582 providers or markets at fixed prices @xmath583 and @xmath584 , @xmath585 , and aims at minimizing the expected costs .",
    "the optimization model is of the form @xmath586 where the recourse costs @xmath462 are given by @xmath587 with the polyhedral constraint sets @xmath588 and @xmath589 with fixed positive prices @xmath590 and bounds @xmath373 , @xmath591 , @xmath592 , @xmath593 , @xmath594 , @xmath595 , @xmath596 , @xmath597 .",
    "we assume that the demands @xmath598 follow the condition @xmath599 where @xmath600 is a vector of expected values simulating the _ trend _ or _",
    "seasonality _ of the demands , and @xmath562 is an _ arma(p , q ) process _ given by the recurrence equation @xmath601 with i.i.d .",
    "gaussian noise @xmath602 n(0,1 ) and characteristic polynomials @xmath603 and @xmath604 .",
    "an arma(p , q ) process is stationary ( i.e. , the covariance function @xmath605 is of the form @xmath606 , @xmath607 ) iff the polynomials @xmath16 and @xmath168 do not have common zeros and @xmath608 for all @xmath609 with @xmath610 ( see ( * ? ? ? * chapter 3 ) ) .",
    "the vector of demands @xmath611 is then normally distributed with mean vector @xmath535 and covariance matrix dependending on the constants @xmath612 , @xmath613 , @xmath614 , @xmath615 , @xmath616 .",
    "such models have been considered for simulating electricity load demands in energy industry , see e.g. @xcite and @xcite .",
    "note that since the model includes unbounded demands @xmath7 , no upper bounds in the variables @xmath617 , @xmath618 , @xmath619 , were imposed , allowing to cover arbitrarily large demand values .",
    "we select in addition the prices @xmath584 significantly higher than the prices @xmath583 , such that the variables @xmath617 , @xmath618 , @xmath619 , do not represent always the trivial choice for costs minimization . for our tests ,",
    "we choose the real dimension @xmath620 , and the model constants @xmath621",
    ", @xmath622 , @xmath623 , @xmath624 , @xmath625 , @xmath626 , @xmath627 , @xmath628 , @xmath629 , @xmath630 .",
    "the resulting arma process @xmath562 is stationary and , hence , @xmath631 , @xmath607 .",
    "the values @xmath632 , can be obtained by solving a system of linear equations with coefficients depending on the constants @xmath612 , @xmath613 , @xmath633 , @xmath634 ( see @xcite for detailed information about modeling with arma processes ) .",
    "the resulting covariance matrix @xmath526 is toeplitz symmetric , with entry values @xmath635 .",
    "the integration problem is transformed by factorizing the covariance matrix @xmath636 as usually recommended in gaussian high - dimensional integration ( see ( * ? ? ?",
    "2.3.3 ) ) .",
    "we carry out our tests using the cholesky factorization @xmath567 ( ch ) and the principal component analysis factorization @xmath637 ( pca ) ( see section [ sens ] ) . after the factorization of @xmath526 assumptions ( a1)(a4 ) ( see section [ twostage ] ) are satisfied .",
    "hence , theorem [ t3 ] applies if ( a5 ) is satisfied .    a simulated demands - path",
    "can then be obtained by @xmath638 where @xmath639^d)$ ] ( i.e. , the probability distribution of @xmath640 is uniform on @xmath83^{d}$ ] ) , and @xmath641 represents the inverse cumulative normal distribution function , which can be efficiently and accurately calculated by moro s algorithm ( see ( * ? ? ? * sect .",
    "2.3.2 ) ) .",
    "the evaluation begins then with mc or randomized qmc points for the samples @xmath642^d)$ ] . for mc points in @xmath83^d$ ] we used the mersenne twister @xcite as pseudo random number generator .",
    "for qmc , we use randomly scrambled sobol points with direction numbers given in @xcite and randomly shifted lattice rules @xcite .",
    "the implemented scrambling technique is random linear scrambling described in @xcite . for our tests , we considered cubic decaying weights @xmath643 for constructing the lattice rules .",
    "we chose the following parameters for the numerical experiments :    * @xmath644 , @xmath645 , @xmath646 .",
    "* for all @xmath647 we select randomly @xmath648 $ ] , @xmath649 $ ] , @xmath650 $ ] , @xmath651 $ ] , @xmath652 $ ] , and @xmath653 $ ] .",
    "* for all @xmath647 we select randomly @xmath654 $ ] , @xmath655 $ ] , and @xmath656 $ ] .",
    "the given parameters were chosen to attempt avoiding trivial solutions of the linear programs .",
    "+ we perform two different kind of tests in our experiments . for",
    "the first kind of tests we fix @xmath24 sampling points @xmath657 and replace the integral of the second stage function @xmath658 by the equal weight mc and randomized qmc quadrature rule , respectively .",
    "then we solve the resulting large linear program @xmath659 for the second kind of tests , we select fixed feasible points @xmath660 and examine the integration errors for the expected recourse @xmath661 by equal weight mc or randomized qmc quadrature rules .     of relative rmse with pca factorization of covariance matrix for integrating @xmath658 ( upper figure ) and for the minimum in ( lower figure ) .",
    "results for mersenne twister mc and randomly scrambled sobol qmc with @xmath662 and @xmath663 points ( mc @xmath664 , ... or so @xmath664 , ... ) , and randomly shifted lattice rules qmc with @xmath665 and @xmath666 lattice points ( la @xmath667 , ... ) . , title=\"fig:\",width=453,height=264 ] +   of relative rmse with pca factorization of covariance matrix for integrating @xmath658 ( upper figure ) and for the minimum in ( lower figure ) .",
    "results for mersenne twister mc and randomly scrambled sobol qmc with @xmath662 and @xmath663 points ( mc @xmath664 , ... or so @xmath664 , ... ) , and randomly shifted lattice rules qmc with @xmath665 and @xmath666 lattice points ( la @xmath667 , ... ) .",
    ", title=\"fig:\",width=453,height=264 ]    for simplicity we choose the fixed feasible points @xmath668 to be the optimal solutions of the tests of the first kind , which were obtained by solving the resulting linear program for different costs while keeping the constraint set unchanged .",
    "the aim of these experiments is twofold .",
    "first we examine the convergence rate of the mc or randomized qmc quadrature rules with some fixed feasible points @xmath660 for the expected recourse in the tests of second kind .",
    "secondly we examine if these convergence rates in terms of sample sizes @xmath24 are translated to the resulting large linear programs for the tests of first kind .     of relative rmse with cholesky factorization of covariance matrix for integration of @xmath669 ( upper figure ) and for the minimum in ( lower figure ) .",
    "results for mersenne twister mc and randomly scrambled sobol qmc with @xmath662 and @xmath663 points ( mc @xmath664 , ... or so @xmath664 , ... ) , and randomly shifted lattice rules qmc with @xmath665 and @xmath666 lattice points ( la @xmath667 , ... ) .",
    ", title=\"fig:\",width=453,height=264 ] +   of relative rmse with cholesky factorization of covariance matrix for integration of @xmath669 ( upper figure ) and for the minimum in ( lower figure ) .",
    "results for mersenne twister mc and randomly scrambled sobol qmc with @xmath662 and @xmath663 points ( mc @xmath664 , ... or so @xmath664 , ... ) , and randomly shifted lattice rules qmc with @xmath665 and @xmath666 lattice points ( la @xmath667 , ... ) . ,",
    "title=\"fig:\",width=453,height=264 ]    the results for the tests of first and second kind under pca factorization are summarized in figure [ fig : pca ] .",
    "we chose @xmath670 for the mersenne twister and for sobol points .",
    "for randomly shifted lattices , we chose the primes @xmath671 .",
    "the random shifts were generated using the mersenne twister .",
    "we estimate the relative root mean square errors ( rmse ) of the estimated integrals ( for the tests of the first kind ) and of the optimal objective values ( for the tests of the second kind ) by taking @xmath672 runs of every experiment , and repeat the process @xmath673 times for the box plots in the figures .",
    "the box - plots show the first ( lower bound of the box ) and third quartiles ( upper bound of the box ) , and the median ( line between lower and upper bound ) .",
    "outliers are marked by plus signs and the remaining results lie between the bounds .    the average of the estimated rates of convergence for both kind of tests under pca ranged in @xmath674 $ ] for randomly shifted lattice rules , and in @xmath675 $ ] for randomly scrambled sobol points , for different price- and bound - parameters as listed above .",
    "this is clearly superior to the mc convergence rate of @xmath676 .",
    "the effective truncation dimension of @xmath658 was tested at @xmath677 different feasible vertices @xmath169 ( obtained from the tests of first kind with different price parameters and fixed bounds ) .",
    "we used the algorithm proposed in @xcite with @xmath678 randomly scrambled sobol points ensuring that all results for the anova total and partial variances were obtained with at least @xmath679 digits accuracy .",
    "the effective dimension @xmath680 remained close to @xmath72 in most cases and always @xmath681 .",
    "further tests for the case @xmath682 showed that the variance accumulated by the first order anova terms @xmath683 was approximately @xmath684 of the total variance .",
    "the first order anova terms @xmath685 accumulated in total approximately @xmath686 of the total variance .",
    "moreover , adding the variance of the anova terms @xmath687 and @xmath688 to the variance of the terms @xmath683 resulted in a variance accumulation higher than @xmath689 .",
    "therefore we can conclude that the effective superposition dimension for the pca case is @xmath690 in this case .",
    "intensive computations seem to show that we may have @xmath691 for even smaller values of @xmath397 than @xmath692 .",
    "hence , pca serves as excellent dimension reduction technique .",
    "although the geometric condition ( a5 ) seems difficult to prove in this case ( and maybe in many high - dimensional realistic examples encountered in energy industry ) , we may rely on corollary [ c2 ] which states that the condition is satisfied for almost all covariance matrices except for countably many .",
    "indeed , it seems that the recourse function @xmath658 is well approximated by a low dimensional smooth function as is the case in many practical examples considered in finance ( see @xcite ) , for different feasible vertices @xmath155 .",
    "further tests were carried out by combining randomly shifted lattice rules with the tent transformation as described in @xcite , but no improvements in the convergence rates beyond @xmath112 were observed for our feasible range of sample sizes .",
    "similarly no improvement beyond the rate @xmath112 was observed for scrambled sobol sequences as might be expected for smooth integrand ( see section [ rqmc ] ) ) .",
    "this may be explained by the lack of the required smoothness properties of the second order anova approximation .    using the cholesky factorization ,",
    "the results for both kind of tests were completely different than those under pca .",
    "the average of the estimated rates of convergence of randomized qmc ranged in @xmath693 $ ] , which is very close to the expected mc rate of @xmath676 .",
    "the results for the cholesky factorization are presented in figure [ fig : ch ] .",
    "the effective truncation dimension of @xmath658 was estimated to be equal to @xmath694 , which is just the real dimension @xmath8 of the problem .",
    "tests showed that the variance accumulated by the first order anova terms @xmath695 was approximately @xmath696 of the total variance .",
    "it seems very likely that the the effective superposition dimension for the cholesky case is really high - dimensional .",
    "our theoretical results in section [ anovatwostage ] imply that all anova terms except the one of highest order of integrands @xmath78 appearing in linear two - stage stochastic programs are smoother than @xmath78 .",
    "more precisely , the anova terms of first and second order belong to the tensor product sobolev space which is important for optimal convergence rates of randomly shifted lattice rules .",
    "error estimates as in remark [ r2 ] then indicate that we may expect that quasi - monte carlo approximations of two - stage stochastic programs converge with the optimal rate ( [ rate ] ) even for high dimensions @xmath8 if the effective superposition dimension satisfies @xmath697 . since we estimate the effective truncation dimension @xmath680 and it holds @xmath698 , it is important that @xmath680 is equal to or at least close to @xmath72 .",
    "this requires the use of dimension reduction techniques , for example , principal component analysis for ( log)normal probability distributions @xmath16 .",
    "our preliminary computational experience on applying quasi - monte carlo methods to a two - stage stochastic production planning problem confirms the theoretical results .",
    "they show that using appropriate quasi - monte carlo methods instead of monte carlo may lead to a substantial improvement , because one may work with a much smaller number of scenarios if suitable dimension reduction techniques allow for an essential reduction from @xmath699 to @xmath680 close to @xmath72 .",
    "altogether , there are good reasons to conclude that recent quasi - monte carlo methods ( like ( scrambled ) sobol sequences and randomly shifted lattice rules ) _ may be efficient _ for two - stage linear stochastic programs ( even if the programs are large scale ) if they allow for a clear dimension reduction .",
    "however , our present theoretical results do not support the use of higher order qmc methods ( see @xcite ) since the first and second order anova terms do not satisfy the required smoothness conditions .",
    "the authors wish to express their gratitude to prof .",
    "ian sloan ( university of new south wales , sydney ) for inspiring conversations during his visit of the humboldt - university berlin in 2011 .",
    "the research of the first author is partially supported by a grant of kisters ag , the second by a grant of the german bundesministerium fr wirtschaft und technologie ( bmwi ) and the third by the dfg research center matheon at berlin .",
    "the authors extend their gratitude to two anonymus referees and to the associate editor for their constructive and stimulating criticism .",
    "f. j. hickernell : obtaining @xmath700 convergence for lattice quadrature rules , in _",
    "monte carlo and quasi - monte carlo methods 2000 _ ( k .- t .",
    "fang , f. j. hickernell , h. niederreiter eds . ) , springer , berlin , 2002 , 274289 .",
    "f. y. kuo , i. h. sloan , g. w. wasilkowski and b. j. waterhouse : randomly shifted lattice rules with the optimal rate of convergence for unbounded integrands , _ journal of complexity _ 26 ( 2010 ) , 135160 .",
    "d. nuyens and r. cools : fast algorithms for component - by - component constructions of rank-1 lattice rules in shift - invariant reproducing kernel hilbert spaces , _ mathematics of computation _ 75 ( 2006 ) , 903 - 922 .",
    "a. b. owen : randomly permuted @xmath701-nets and @xmath702-sequences .",
    "_ monte carlo and quasi - monte carlo methods in scientific computing",
    "_ ( h. niederreiter and p. j .- s .",
    "shiue eds . ) , lecture notes in statistics , vol .",
    "106 , springer , new york , 1995 , 299317 .",
    "pappas , l. ekonomou , p. karampelas , d. c. karamousantas , s.k .",
    "katsikas , g.e .",
    "chatzarakis and p.d .",
    "skafidas : electricity demand load forecasting of the hellenic power system using an arma model , _ electric power systems research _ 80 ( 2010 ) , 256264 .",
    "pflug and a. pichler : approximations for probability distributions and stochastic optimization problems , in : _",
    "stochastic optimization methods in finance and energy _ ( m.i .",
    "bertocchi , g. consigli , m.a.h .",
    "dempster eds . ) , springer , 2011 , 343387 .",
    "w. rmisch : stability of stochastic programming problems , in : _",
    "stochastic programming _",
    "( a. ruszczyski , a. shapiro eds . ) , handbooks in operations research and management science , volume 10 , elsevier , amsterdam 2003 , 483554 ."
  ],
  "abstract_text": [
    "<S> quasi - monte carlo algorithms are studied for designing discrete approximations of two - stage linear stochastic programs . </S>",
    "<S> their integrands are piecewise linear , but neither smooth nor lie in the function spaces considered for qmc error analysis . </S>",
    "<S> we show that under some weak geometric condition on the two - stage model all terms of their anova decomposition , except the one of highest order , are continuously differentiable and second order mixed derivatives exist almost everywhere and belong to @xmath0 . </S>",
    "<S> hence , quasi - monte carlo algorithms may achieve the optimal rate of convergence @xmath1 with @xmath2 $ ] and a constant not depending on the dimension if the effective dimension is close to two . </S>",
    "<S> the geometric condition is shown to be generically satisfied if the underlying probability distribution is normal . </S>",
    "<S> we discuss effective dimensions and dimension reduction techniques for two - stage integrands . </S>",
    "<S> numerical experiments show that indeed convergence rates close to the optimal rate are achieved when using randomly scrambled sobol point sets and randomly shifted lattice rules accompanied with suitable dimension reduction techniques . </S>"
  ]
}