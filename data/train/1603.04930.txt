{
  "article_text": [
    "video compressive sensing ( cs ) refers to the problem of recovering an unknown spatio - temporal volume from limited samples .",
    "it comes in two incarnations , namely , spatial cs and temporal cs .",
    "spatial video cs architectures stem from the well - known single - pixel - camera  @xcite , which performs spatial multiplexing per measurement , and enable video recovery by expediting the capturing process .",
    "they either employ fast readout circuitry to capture information at video rates  @xcite or parallelize the single - pixel architecture using multiple sensors , each one responsible for sampling a separate spatial area of the scene  @xcite .",
    "in this work , we focus on temporal cs where multiplexing occurs across the time dimension .",
    "figure  [ fig : measurementmodel ] depicts this process , where a spatio - temporal volume of size @xmath0 is modulated by @xmath1 binary random masks during the exposure time of a single capture , giving rise to a coded frame of size @xmath2 .",
    "we denote the vectorized versions of the unknown signal and the captured frame as @xmath3 and @xmath4 , respectively .",
    "each vectorized sampling mask is expressed as @xmath5 giving rise to the measurement model @xmath6 where @xmath7 : m_{f } \\times n_{f}$ ] and @xmath8 creates a diagonal matrix from its vector argument .",
    "various successful temporal cs architectures have been proposed .",
    "their differences mainly involve the implementation of the random masks on the optical path ( i.e. , the measurement matrix in figure  [ fig : measurementmodel ] ) . digital micromirror devices ( dmd ) , spatial light modulators ( slm ) and liquid crystal on silicon ( lcos ) were used in  @xcite while translating printed masks were employed in  @xcite .",
    "moreover , a few architectures have eliminated additional optical elements by directly programming the chip s readout mode through hardware circuitry modifications  @xcite .    despite their reasonable performance ,",
    "temporal cs architectures lack practicality .",
    "the main drawback is that existing reconstruction algorithms ( e.g. , using sparsity models  @xcite , combining sparsity and dictionary learning  @xcite or using gaussian mixture models  @xcite ) are often too computationally intensive , rendering the reconstruction process painfully slow .",
    "even with parallel processing , recovery times make video cs prohibitive for modern commercial camera architectures .    in this work",
    ", we address this problem by employing deep learning and show that video frames can be recovered in a few seconds at significantly improved reconstruction quality compared to existing approaches .",
    "our contributions are summarized as follows :    1 .",
    "we present a novel temporal video cs reconstruction approach , based on fully - connected neural networks , which learns to map directly temporal cs measurements to video frames .",
    "for such task to be practical , a measurement mask with a repeated pattern is proposed .",
    "we show that a simple linear regression - based approach learns to reconstruct video frames adequately at a minimal computational cost .",
    "such reconstruction could be used as an initial point to other video cs algorithms .",
    "the learning parading is extended to deeper architectures exhibiting reconstruction quality and computational cost improvements compared to previous methods .",
    "deep learning  @xcite is a burgeoning research field which has demonstrated state - of - the - art performance in a multitude of machine learning and computer vision tasks , such as image recognition  @xcite or object detection  @xcite .    in simple words ,",
    "deep learning tries to mimic the human brain by training large multi - layer neural networks with vast amounts of training samples , describing a given task .",
    "such networks have proven very successful in problems where analytical modeling is not easy or straightforward ( e.g. , a variety of computer vision tasks  @xcite ) .    the popularity of neural networks in recent years has led researchers to explore the capabilities of deep architectures even in problems where analytical models often exist and are well understood ( e.g. , restoration problems  @xcite ) . even though performance improvement is not as pronounced as in classification problems ,",
    "many proposed architectures have achieved state - of - the - art performance in problems such as deconvolution , denoising , inpainting , and super - resolution .",
    "more specifically , investigators have employed a variety of architectures : deep fully - connected networks or multi - layer perceptrons ( mlps )  @xcite ; stacked denoising auto - encoders ( sdaes )  @xcite , which are mlps whose layers are pre - trained to provide improved weight initialization ; convolutional neural networks ( cnns )  @xcite and recurrent neural networks ( rnns )  @xcite .",
    "based on such success in restoration problems , we wanted to explore the capabilities of deep learning for the video cs problem .",
    "however , the majority of existing architectures involve outputs whose dimensionality is smaller than the input ( e.g. , classification ) or have the same size ( e.g. , denoising / deblurring ) . hence , devising an architecture that estimates @xmath9 unknowns , given @xmath10 inputs , where @xmath11 is not necessarily straightforward .",
    "two recent studies , utilizing sdaes  @xcite or cnns  @xcite , have been presented on spatial cs for still images exhibiting promising performance .",
    "our work constitutes the first attempt to apply deep learning on temporal video cs .",
    "our approach differs from prior 2d image restoration architectures  @xcite since we are recovering a 3d volume from 2d measurements .",
    "we started our investigation by posing the question : can training data be used to find a linear mapping @xmath12 such that @xmath13 ? essentially , this question asks for the inverse of @xmath14 in equation   which , of course , does not exist .",
    "clearly , such a matrix would be huge to store but , instead , one can apply the same logic on video blocks  @xcite .",
    "we collect a set of training video blocks denoted by @xmath15 , @xmath16 of size @xmath17 .",
    "therefore , the measurement model per block is now @xmath18 with size @xmath19 , where @xmath20 and @xmath21 refers to the corresponding measurement matrix per block",
    ".     videos ( unrelated to the training data ) , using measurement matrices @xmath22 with varying percentages of nonzero elements . ]    collecting a set of @xmath23 video blocks , we obtain the matrix equation @xmath24 where @xmath25 $ ] , @xmath26 $ ] and @xmath21 is the same for all blocks .",
    "the linear mapping @xmath27 we are after can be calculated as @xmath28 where @xmath29 is of size @xmath30 .    intuitively , such an approach would not necessarily be expected to even provide a solution due to ill - posedness .",
    "however , it turns out that , if @xmath23 is sufficiently large and the matrix @xmath22 has at least one nonzero in each row ( i.e. , sampling each spatial location at least once over time ) , the estimation of @xmath15 s by the @xmath31 s provides surprisingly good performance .",
    "specifically , we obtain measurements from a test video sequence applying the same @xmath21 per video block and then reconstruct all blocks using the learnt @xmath29 .",
    "figure  [ fig : wcomparison ] depicts the average peak signal - to - noise ratio ( psnr ) and structural similarity metric ( ssim )  @xcite for the reconstruction of @xmath32 video sequences using @xmath33 different realizations of the random binary matrix @xmath22 for varying percentages of nonzero elements .",
    "the empty bars for @xmath34 and @xmath35 of nonzeros in realizations @xmath36 and @xmath33 , respectively , refer to cases when there was no solution due to the lack of nonzeros at some spatial location . in these experiments @xmath37",
    "was selected as @xmath38 simulating the reconstruction of @xmath39 frames by a single captured frame and @xmath40 .",
    "based on the performance in figure  [ fig : wcomparison ] , investigating the extension of the linear mapping in @xmath41 to a nonlinear mapping using deep networks seemed increasingly promising . in order for such an approach to be practical , though , reconstruction has to be performed on blocks and each block must be sampled with the same measurement matrix @xmath22 .",
    "furthermore , such a measurement matrix should be realizable in hardware .",
    "hence we propose constructing a @xmath14 which consists of repeated identical building blocks of size @xmath42 , as presented in figure  [ fig : maskconstruction ] .",
    "such a matrix can be straightforwardly implemented on existing systems employing dmds , slms or lcos  @xcite . at the same time , in systems utilizing translating masks  @xcite , a repeated mask can be printed and shifted appropriately to produce the same effect .    in the remainder of this paper",
    ", we select a building block of size @xmath43 as a random binary matrix containing @xmath44 of nonzero elements and set @xmath45 , such that @xmath46 and @xmath47 .",
    "therefore , the compression ratio is @xmath48 .",
    "in addition , for the proposed matrix @xmath14 , each @xmath49 block is the same allowing reconstruction for overlapping blocks of size @xmath38 with spatial overlap of @xmath50 .",
    "such overlap can usually aid at improving reconstruction quality .",
    "the selection of @xmath44 of nonzeros was just a random choice since the results of figure  [ fig : wcomparison ] did not suggest that a specific percentage is particularly beneficial in terms of reconstruction quality .          in this section ,",
    "we extend the linear formulation to mlps and investigate the performance in deeper structures .",
    "we consider an mlp architecture to learn a nonlinear function @xmath51 that maps a measured frame patch @xmath52 via several hidden layers to a video block @xmath53 , as illustrated in figure  [ fig : network ] .",
    "each hidden layer @xmath54 , @xmath55 is defined as @xmath56 where @xmath57 is the bias vector and @xmath58 is the output weight matrix , containing linear filters .",
    "@xmath59 connects @xmath31 to the first hidden layer , while for the remaining hidden layers , @xmath60 .",
    "the last hidden layer is connected to the output layer via @xmath61 and @xmath62 without nonlinearity .",
    "the non - linear function @xmath63 is the rectified linear unit ( relu )  @xcite defined as , @xmath64 .",
    "the mlp architecture was chosen due to the following considerations ; there is a need for at least one fully - connected layer ( the first one ) that would provide a 3d signal from the compressed 2d measurements . following that , one could argue that the subsequent layers could be 3d convolutional layers  @xcite .",
    "although that would sound reasonable , in practice , the small size of blocks used in this paper ( @xmath38 ) do not allow for convolutions to be effective .",
    "such small block sizes have provided good reconstruction quality in dictionary learning approaches used for cs video reconstruction  @xcite .",
    "thus , mlps were considered more reasonable in our work and we found that when applied in @xmath38 blocks they capture the motion and spatial details of videos adequately .",
    "besides , increasing the size of blocks would dramatically increase the network complexity in 3d volumes such as in videos .",
    "to train the proposed mlp , we learn all the weights and biases of the model .",
    "the set of parameters is denoted as @xmath65 and is updated by the backpropagation algorithm  @xcite minimizing the quadratic error between the set of training mapped measurements @xmath66 and the corresponding video blocks @xmath15 .",
    "the loss function is the mean squared error ( mse ) which is given by @xmath67 the mse was used in this work since our goal is to optimize the psnr which is directly related to the mse .",
    "we compare our proposed deep architecture with state - of - the - art approaches both quantitatively and qualitatively .",
    "the proposed approaches are evaluated assuming noiseless measurements or under the presence of measurement noise .",
    "finally , we investigate the performance of our methods under different network parameters ( e.g. , number of layers ) and size of training samples .",
    "the metrics used for evaluation were the psnr and ssim .      for deep neural networks , increasing",
    "the number of training samples is usually synonymous to improved performance .",
    "we collected a diverse set of training samples using @xmath68 high - definition videos from youtube , depicting natural scenes .",
    "the video sequences contain more than @xmath69 frames which were converted to grayscale .",
    "all videos are unrelated to the test set .",
    "we randomly extracted @xmath70 million video blocks of size @xmath71 while keeping the amount of blocks extracted per video proportional to its duration .",
    "this data was used as output while the corresponding input was obtained by multiplying each sample with the measurement matrix @xmath22 ( see subsection  [ subsec : mask_construction ] for details ) .",
    "example frames from the video sequences used for training are shown in figure  [ fig : trainingframes ] .",
    "our networks were trained for up to @xmath72 iterations using a mini - batch size of @xmath73 .",
    "we normalized the input per - feature to zero mean and standard deviation one .",
    "the weights of each layer were initialized to random values uniformly distributed in @xmath74 , where @xmath75 is the size of the previous layer  @xcite .",
    "we used stochastic gradient descent ( sgd ) with a starting learning rate of @xmath76 , which was divided by @xmath70 after @xmath77 iterations .",
    "the momentum was set to 0.9 and we further used @xmath78 norm gradient clipping to keep the gradients in a certain range .",
    "gradient clipping is a widely used technique in recurrent neural networks to avoid exploding gradients  @xcite .",
    "the threshold of gradient clipping was set to @xmath70 .",
    "we compare our method with the state - of - the - art video compressive sensing methods :    * gmm - tp , a gaussian mixture model ( gmm)-based algorithm  @xcite . *",
    "mmle - gmm , a maximum marginal likelihood estimator ( mmle ) , that maximizes the likelihood of the gmm of the underlying signals given only their linear compressive measurements  @xcite .",
    "for temporal cs reconstruction , data driven models usually perform better than standard sparsity - based schemes  @xcite .",
    "indeed , both gmm - tp and mmle - gmm have demonstrated superior performance compared to existing approaches in the literature such as total - variation ( tv ) or dictionary learning  @xcite , hence we did not include experiments with the latter methods .    in gmm - tp",
    "@xcite we followed the settings proposed by the authors and used our training data ( randomly selecting @xmath79 samples ) to train the underlying gmm parameters .",
    "we found that our training data provided better performance compared to the data used by the authors . in our experiments",
    "we denote this method by gmm-@xmath80 to denote reconstruction of overlapping blocks with spatial overlap of @xmath50 pixels , as discussed in subsection  [ subsec : mask_construction ] .",
    "mmle  @xcite is a self - training method but it is sensitive to initialization . a satisfactory performance is obtained only when mmle is combined with a good starting point . in  @xcite ,",
    "the gmm - tp  @xcite with full overlapping patches ( denoted in our experiments as gmm-1 ) was used to initialize the mmle .",
    "we denote the combined method as gmm-1+mmle . for fairness",
    ", we also conducted experiments in the case where our method is used as a starting point for the mmle .    in our methods , a collection of overlapping patches of size @xmath81",
    "is extracted by each coded measurement of size @xmath82 and subsequently reconstructed into video blocks of size @xmath71 .",
    "overlapping areas of the recovered video blocks are then averaged to obtain the final video reconstruction results , as depicted in figure  [ fig : network ] .",
    "the step of the overlapping patches was set to @xmath50 due to the special construction of the utilized measurement matrix , as discussed in subsection  [ subsec : mask_construction ] .",
    "we consider six different architectures :    * w-10 m , a simple linear mapping ( equation  ) trained on @xmath83 samples .",
    "* fc4 - 1 m , a @xmath84 mlp trained on @xmath85 samples ( randomly selected from our @xmath83 samples ) .",
    "* fc4 - 10 m , a @xmath84 mlp trained on @xmath86 samples .",
    "* fc7 - 1 m , a @xmath87 mlp trained on @xmath88 samples ( randomly selected from our @xmath83 samples ) .",
    "* fc7 - 10 m , a @xmath87 mlp trained on @xmath83 samples .",
    "* fc7 - 10m+mmle , a @xmath87 mlp trained on @xmath86 samples which is used as an initialization to the mmle  @xcite method .",
    "note that the subset of randomly selected @xmath36 million samples used for training fc4 - 1 m and fc7 - 1 m was the same .    our test set consists of @xmath32 video sequences .",
    "they involve a set of videos that were used for dictionary training in  @xcite , provided by the authors , as well as the `` basketball '' video sequence used by  @xcite .",
    "all video sequences are unrelated to the training set ( see subsection  [ subsec : training_data ] for details ) . for fair comparisons ,",
    "the same measurement mask was used in all methods , according to subsection  [ subsec : mask_construction ] .",
    "all code implementations are publicly available provided by the authors .",
    "quantitative reconstruction results for all video sequences with all tested algorithms are illustrated in table  [ tb : psnr_table ] and average performance is summarized in figure  [ fig : allalgorithmcomparison ] .",
    "the presented metrics refer to average performance for the reconstruction of the first @xmath89 frames of each video sequence , using @xmath33 consequtive captured coded frames through the video cs measurement model of equation  . in both , table  [ tb : psnr_table ] and figure  [ fig : allalgorithmcomparison ] , results are divided in two parts .",
    "the first part lists reconstruction performance of the tested approaches without the mmle step , while the second compares the performance of the best candidate proposed and previous methods with a subsequent mmle step  @xcite . in table",
    "[ tb : psnr_table ] the best performing algorithms are highlighted for each part while the bottom row presents average reconstruction time requirements for the recovery of @xmath39 video frames using @xmath36 captured coded frame .    .",
    "]     video sequences between the proposed method fc7 - 10 m and the previous method ggm-4  @xcite . ]",
    "our fc7 - 10 m and fc7 - 10m+mmle yield the highest psnr and ssim values for all video sequences .",
    "specifically , the average psnr improvement of fc7 - 10 m over the gmm-1  @xcite is @xmath90 db . when these two methods are used to initialize the mmle  @xcite algorithm , the average psnr gain of fc7 - 10m+mmle over the gmm-1+mmle  @xcite is @xmath91 db . notice also that the fc7 - 10 m achieves @xmath92 db higher than the combined gmm-1+mmle .",
    "the highest psnr and ssim values are reported in the fc7 - 10m+mmle method with @xmath93 db average psnr over all test sequences .",
    "however , the average reconstruction time for the reconstruction of @xmath39 frames using this method is almost two hours while for the second best , the fc7 - 10 m , is about @xmath94 seconds , with average psnr @xmath95 db .",
    "we conclude that , when time is critical , fc7 - 10 m should be the preferred reconstruction method .",
    "qualitative results of selected video frames are shown in figure  [ fig : framesandinsets ] .",
    "the proposed mlp architectures , including the linear regression model , favorably recover motion while the additional hidden layers emphasize on improving the spatial resolution of the scene .",
    "one can clearly observe the sharper edges and high frequency details produced by the fc7 - 10 m and fc7 - 10m+mmle methods compared to previously proposed algorithms .    due to the extremely long reconstruction times of previous methods ,",
    "the results presented in table  [ tb : psnr_table ] and figure  [ fig : allalgorithmcomparison ] refer to only the first @xmath89 frames of each video sequence , as mentioned above .",
    "figure  [ fig : fullpsnrcomparison ] compares the psnr for all the frames of @xmath96 video sequences using our fc7 - 10 m algorithm and the fastest previous method gmm-4  @xcite , while figure  [ fig : framesandinsetsfullvideo ] depicts representative snapshots for some of them . the varying psnr performance across the frames of a @xmath39 frame block is consistent for both algorithms and is reminiscent of the reconstruction tendency observed in other video cs papers in the literature  @xcite .",
    "previously , we evaluated the proposed algorithms assuming noiseless measurements . in this subsection , we investigate the performance of the presented deep architectures under the presence of measurement noise .",
    "specifically , the measurement model of equation   is now modified to @xmath97 where @xmath98 is the additive measurement noise vector .",
    "we employ our best architecture utilizing @xmath99 hidden layers and follow two different training schemes . in the first one , the network is trained on the @xmath86 samples , as discussed in subsection  [ subsec : comparison ] ( i.e. , the same fc7 - 10 m network as before ) while in the second , the network is trained using the same data pairs @xmath100 after adding random gaussian noise to each vector @xmath31 .",
    "each vector @xmath31 was corrupted with a level of noise such that signal - to - noise ratio ( snr ) is uniformly selected in the range between @xmath101 db giving rise to a set of @xmath86 noisy samples for training .",
    "we denote the network trained on the noisy dataset as fc7n-10 m .",
    "we now compare the performance of the two proposed architectures with the previous methods gmm-4 and gmm-1 using measurement noise .",
    "we did not include experiments with the mmle counterparts of the algorithms since , as we observed earlier , the performance improvement is always related to the starting point of the mmle algorithm .",
    "figure  [ fig : algorithmcomparisonnoise ] shows the average performance comparison for the reconstruction of the first @xmath89 frames of each tested video sequence under different levels of measurement noise while figure  [ fig : algorithmcomparisonnoiseinsets ] depicts example reconstructed frames .    .",
    "]    as we can observe , the network trained on noiseless data ( fc7 - 10 m ) provides good performance for low measurement noise ( e.g. , @xmath102 db ) and reaches similar performance to gmm-1 for more severe noise levels ( e.g. , @xmath103 db ) .",
    "the network trained on noisy data ( fc7n-10 m ) , proves more robust to noise severity achieving better performance than gmm-1 under all tested noise levels .    despite proving more robust to noise ,",
    "our algorithms in general recover motion favorably but , for high noise levels , there is additive noise throughout the reconstructed scene ( observe results for @xmath103 db noise level in figure  [ fig : algorithmcomparisonnoiseinsets ] ) .",
    "such degradation could be combated by cascading our architecture with a denoising deep architecture ( e.g. ,  @xcite ) or denoising algorithm to remove the noise artifacts .",
    "ideally , for a specific camera system , data would be collected using this system and trained such that the deep architecture incorporates the noise characteristics of the underlying sensor .",
    "run time comparisons for several methods are illustrated at the bottom row of table  [ tb : psnr_table ] .",
    "all previous approaches are implemented in matlab .",
    "our deep learning methods are implemented in caffe package  @xcite and all algorithms were executed by the same machine .",
    "we observe that the deep learning approaches significantly outperform the previous approaches in order of several magnitudes .",
    "note that a direct comparison between the methods is not trivial due to the different implementations .",
    "nevertheless , previous methods solve an optimization problem during reconstruction while our mlp is a feed - forward network that requires only few matrix - vector multiplications .      from figure",
    "[ fig : allalgorithmcomparison ] we observe that as the number of training samples increase the performance consistently improves .",
    "however , the improvement achieved by increasing the number of layers ( from @xmath80 to @xmath104 ) for architectures trained on small datasets ( e.g. , 1 m ) is not significant .",
    "this is perhaps expected as one may argue that in order to achieve higher performance with extra layers ( thus , more parameters to train ) more training data would be required . intuitively , adding hidden layers",
    "enables the network to learn more complex functions .",
    "indeed , reconstruction performance in our 10 million dataset is higher in fc7 - 10 m than in fc4 - 10 m . increasing the number of hidden layers further",
    "did not help in our experiments as we did not observe any additional performance improvement .",
    "to the best of our knowledge , this work constitutes the first deep learning architecture for temporal video compressive sensing reconstruction .",
    "we demonstrated superior performance compared to existing algorithms while reducing reconstruction time to a few seconds . at the same time , we focused on the applicability of our framework on existing compressive camera architectures suggesting that their commercial use could be viable .",
    "we believe that this work can be extended in three directions : 1 ) exploring the performance of variant architectures such as rnns , 2 ) investigate the training of deeper architectures and 3 ) finally , examine the reconstruction performance in real video sequences acquired by a temporal compressive sensing camera ."
  ],
  "abstract_text": [
    "<S> in this work we present a deep learning framework for video compressive sensing . </S>",
    "<S> the proposed formulation enables recovery of video frames in a few seconds at significantly improved reconstruction quality compared to previous approaches . </S>",
    "<S> our investigation starts by learning a linear mapping between video sequences and corresponding measured frames which turns out to provide promising results . </S>",
    "<S> we then extend the linear formulation to deep fully - connected networks and explore the performance gains using deeper architectures . </S>",
    "<S> our analysis is always driven by the applicability of the proposed framework on existing compressive video architectures . </S>",
    "<S> extensive simulations on several video sequences document the superiority of our approach both quantitatively and qualitatively . </S>",
    "<S> finally , our analysis offers insights into understanding how dataset sizes and number of layers affect reconstruction performance while raising a few points for future investigation . </S>"
  ]
}