{
  "article_text": [
    "simple discrete - time models are frequently used to gain insight into the behavior of more complex models of real world systems .",
    "the logistic map , for example , can be used to study the population dynamics of species that have non - overlapping generations . here , the many interactions between the individuals in the population ( birth , death , competition etc . ) are replaced with an effective interaction which returns the population of the next generation as a function of the current one .",
    "more theoretically , this system also provides a very simple setting in which to study deterministic chaos @xcite .    the effect of noise on such a system is interesting for a number of reasons .",
    "any real world population will be subject to internal ( demographic ) and external ( environmental ) fluctuations . from a more theoretical point of view",
    ", the inclusion of noise allows us to consider a simple system which contains two types of uncertainty : it exhibits chaotic and stochastic behavior ( see e.g. refs  @xcite ) . in a series of articles",
    "@xcite , we introduced a microscopic model from which the logistic map is recovered in the thermodynamic limit ( the limit of zero fluctuations ) .",
    "this process is frequently studied in continuous - time models , but to the best of our knowledge had not been carried out in discrete - time systems . from this microscopic model , expressed as a markov chain , we established a mesoscopic formalism , to elucidate certain aspects of the process , and also to connect with well - known techniques developed for continuous - time stochastic models .",
    "this mesoscopic description resembles the deterministic map , but has an extra noise term .",
    "we stress that the form of this noise is derived from the microscopic model , and is not simply ` put in by hand ' , as in previous studies .",
    "we also extended the formalism from one to many variables @xcite .",
    "discrete - time models  in the deterministic limit  are commonly defined on a fixed interval .",
    "for instance , the dynamics of the one - dimensional logistic map is confined to the interval between 0 and 1 .",
    "the principal reason for this is to facilitate its study ; even with only one variable , discrete - time systems are capable of such a wide range of behavior ( e.g. cycles , chaos , intermittency ) that they allow for large jumps between successive time points ( or , from a population biology point of view , ` generations ' ) .",
    "this should be contrasted with a system of ordinary differential equations which has trajectories that take the form of continuous flows . as a result of these large jumps , the addition of stochasticity can in principle",
    "lead to trajectories leaving the interval on which the dynamics is defined",
    ". this may be unphysical in that it leads to either negative population numbers or to the population blowing up .",
    "equally , if one wants to study the effects of noise on the attractor of the underlying deterministic map , one is not so interested in trajectories that leave the interval .",
    "a variety of approaches have been taken in the past to deal with this problem . in the physics literature , it is common to study the system in the weak noise regime ( e.g.  refs .",
    "this means that fluctuations are highly unlikely to cause a trajectory to leave the interval , and so this possibility may be neglected quite safely in applications .",
    "one can also choose to condition the noise to explicitly forbid escape events  @xcite .",
    "alternatively , one can treat the escape events as part of the dynamics of the system , and study them statistically ( see e.g.  refs  @xcite ) . in the mathematical literature , on the other hand , one can view the desired behavior ( i.e. trajectories that remain in the interval for the duration of a simulation ) as metastable behavior ",
    "see for example ref .",
    "@xcite , and references therein .",
    "the interpretation in this case is that , if the system is allowed to evolve for a sufficiently long period of time , all of the probability distribution will ` leak ' out of the interval , representing the true , stationary behavior of the system .",
    "the microscopic model used as a starting point for our investigations does not suffer from these problems .",
    "this is because the process is defined as a markov chain on a one - dimensional , finite lattice , and the transition probabilities that specify the jump from one lattice point to another , are such that transitions outside the interval are not allowed . in the mesoscopic description , however , the discrete lattice points are replaced with a continuous variable ( details will be given in sec .",
    "[ sec : meso ] ) . in this case , it does become possible , when the fluctuations are large , for probability to leak out of the interval .",
    "our previous investigations did not focus on the point but , when studying the process for very strong noise , this effect becomes noticeable . in this paper , we will examine the issue of probability leakage out of the interval from a number of perspectives and , through a more careful analysis , describe and compare several methods for remedying this problem .",
    "the outline of the paper is as follows . in sec .",
    "[ sec : micro ] we will discuss the microscopic starting point : a markov chain with states @xmath0 , taking as a particular example a model which leads to the logistic map in the deterministic limit .",
    "we examine the nature of the eigenvalues and eigenvectors of the transition matrix of this model for small to moderate values of @xmath1 ( up to a few hundred ) in order to compare with the results found in the mesoscopic approximation . in sec .",
    "[ sec : meso ] we briefly present the formalism used in our previous work , and provide results of the mesoscopic expansion of the markov chain model .",
    "we will also show that , unlike the microscopic model , the mesoscopic system allows probability to leave the system , and explore this aspect quantitatively .",
    "this allows us to develop the ideas which lead us to a prescription ensuring that trajectories do not leave the interval on which the process is defined .",
    "this is discussed in sec .",
    "[ sec : trun_cen ] , while results obtained from the methods proposed in this section are presented in sec .",
    "[ sec : results ] .",
    "we discuss our findings in sec .",
    "[ sec : discuss ] and give some brief technical details in the appendices .",
    "our starting point is a microscopic model that has the form of a markov chain , which we write as @xmath2 where @xmath3 denotes the probability for the system to be found in state @xmath4 at time @xmath5 .",
    "the system is defined on a one - dimensional lattice with @xmath6 sites and is updated by an application of the transition matrix @xmath7 , once an initial condition is provided .",
    "our arguments will be quite general , but for numerical illustration we will focus on models that have the following binomial form : @xmath8^{n}\\,\\left [ 1 - p\\left ( \\frac{m}{n } \\right ) \\right]^{n - n } , \\label{binomial}\\ ] ] which was used in our previous work  @xcite .",
    "here we have introduced a function @xmath9 such that @xmath10 .",
    "we can find the equation of the evolution of the first moment @xmath11 , as follows : @xmath12 and since @xmath13 is a binomial distribution , so that , @xmath14 , this leads to @xmath15 the macroscopic evolution equation is therefore @xmath16 , where @xmath17 . choosing the function @xmath9 to be @xmath18",
    ", we see that the model corresponds to the logistic map in the determinitic limit .",
    "we note that in this case @xmath19 and @xmath20 , which in terms of the transition matrix implies that @xmath21 for @xmath22 , with @xmath23 and @xmath24 not determined .",
    "since @xmath7 is a stochastic matrix , that is @xmath25 , for all @xmath26 , we define @xmath27 and @xmath28 . in terms of a population model",
    "these correspond respectively to an extinct population remaining extinct and a population which has reached a critical size , @xmath1 , becoming extinct .",
    "we would expect both of these conditions to hold in a wide range of population models .",
    "the solution to the markov chain eq .   is given by @xmath29 where @xmath30 is the @xmath31th eigenvalue of the transition matrix @xmath7 and @xmath32 and @xmath33 are the corresponding left and right eigenvectors .",
    "thus the long - time , and even moderate - time , behavior of the system will be dominated by the largest eigenvalues of @xmath7 .",
    "we now explore the qualitative and quantitative nature of these eigenvalues and associated eigenvectors for later comparison with the results found from the mesoscopic form of the model .",
    "since @xmath7 is a stochastic matrix , it follows that it has an eigenvalue equal to 1 , with a corresponding left - eigenvector given by @xmath34 . from the general theory of markov chains  @xcite",
    ", we would expect this to correspond to the stationary state and for this eigenvalue to be the largest .",
    "the properties of @xmath35 , described above as following from the condition @xmath19 , imply that the boundary at @xmath36 is absorbing , or in terms of a population model , extinction is the final state of the system with probability @xmath37 .",
    "therefore we would expect the right - eigenvector corresponding to the eigenvalue @xmath37 to be @xmath38 , which is straightforward to verify .",
    "the main focus of this paper is , however , the mesoscopic version of the model , which is a good approximation for larger values of @xmath1 for which the system settles around some stable state and remains there for a very long time , before being eventually absorbed at the boundary . in applications",
    "it is frequently this state that we are interested in , not the stationary state .",
    "it is commonly referred to as the quasistationary state , since to all intents and purposes it resembles a stationary state of the system , except that if one waits a sufficiently long time the system will ` decay ' to the @xmath36 state .",
    "we would expect , therefore , that it is the second largest eigenvalue of @xmath7 that is of real interest to us , with @xmath39 and @xmath40 , for some constant @xmath41 .",
    "we envisage this to be the case , since the decay to the extinction state is via ` rare events ' which will have the exponentially small character typically found in large deviation theory .",
    "this can be tested numerically , where it is indeed found that when @xmath1 is larger than about @xmath42 , the second eigenvalue is visually indistinguishable from @xmath37 .",
    "a more systematic analysis shows the following behavior : @xmath43 figure [ fig : rhostar ] shows @xmath44 as a function of @xmath1 for @xmath45 and @xmath46 , obtained numerically using the built - in mathematica function  @xcite . although not of primary concern here , we note that in the `` critical '' case @xmath47 , the exponential decay is replaced by a power law .     with respect to @xmath1 for the logistic map with @xmath45 ( top ) and @xmath46 ( bottom ) .",
    "the red , dashed lines correspond to eq .   with @xmath48 , @xmath49 ( top ) and @xmath50 , @xmath51 ( bottom ) .",
    "the top panel is representative of the general behavior observed for various choices of @xmath52 , as stated in eq .",
    ".,title=\"fig : \" ] +   +   with respect to @xmath1 for the logistic map with @xmath45 ( top ) and @xmath46 ( bottom ) .",
    "the red , dashed lines correspond to eq .   with @xmath48 , @xmath49 ( top ) and @xmath50 , @xmath51 ( bottom ) .",
    "the top panel is representative of the general behavior observed for various choices of @xmath52 , as stated in eq .",
    ".,title=\"fig : \" ]    the absorbing state , @xmath36 , and the `` true '' stationary state , @xmath53 , can be eliminated by the following method @xcite .",
    "a matrix , @xmath54 , is constructed by removing the first row and first column of the transition matrix @xmath7 .",
    "that is , we write the decomposition of @xmath7 as @xmath55 where @xmath56 and @xmath57 are vectors of length @xmath1 and @xmath54 is an @xmath58 matrix .",
    "it is straightforward to show that @xmath59 , where @xmath60 and @xmath61 are the characteristic polynomials of @xmath7 and @xmath54 respectively . from this",
    "it follows that ( i ) the eigenvalues of @xmath54 are those of @xmath7 , apart from the additional one equal to unity , ( ii ) the left - eigenvectors of @xmath7 , other than @xmath34 , have @xmath62 as their first entry , and the left - eigenvectors of @xmath54 as the other @xmath1 entries , and ( iii ) the right - eigenvectors of @xmath7 , other than @xmath38 , have a first entry we denote as @xmath63 , and the right - eigenvectors of @xmath54 as the other @xmath1 entries . by orthogonality with @xmath34 , @xmath64 , @xmath65 .    in summary",
    ", the introduction of the matrix @xmath54 means that the absorbing state @xmath36 has been moved outside of the system , and is reduced to a collection point for the probability exiting the states @xmath66 . the perron - frobenius theorem for non - negative matrices  @xcite",
    "can now be applied to @xmath54 to show that the right - eigenvector corresponding to its largest eigenvalue , @xmath44 , has non - negative entries .",
    "we will denote this as @xmath67 , and is the quasistationary probability distribution that we seek .",
    "it is important to note that @xmath54 is not a stochastic matrix : the vector @xmath57 has at least one entry not equal to @xmath62 , and so the columns of @xmath54 do not all sum to @xmath37 . as a consequence , the largest eigenvalue of @xmath54 , @xmath68 .",
    "nonetheless , the perron - frobenius theorem is still applicable since , despite being widely applied for the case of stochastic matrices , it holds for non - negative matrices in general and does not impose any restriction on the magnitude of the largest eigenvalue  @xcite .",
    "we may now examine the form of @xmath67 for various values of @xmath69 , the parameter which appears in the logistic map .",
    "for @xmath70 , where the logistic map has a single stable fixed point at @xmath71 , it takes the form of a gaussian centered at the fixed point . as @xmath69 increases , and passes through @xmath72 , a two - peaked distribution smoothly develops , reflecting the fact that for @xmath73 a two - cycle is the stable attractor .",
    "the profile of @xmath67 for two parameter choices is shown in fig .",
    "[ fig : qsd ] . obtaining the eigenvalues and eigenvectors of @xmath54 numerically is not feasible for values of @xmath1 greater than a few hundred , but the results obtained for @xmath67 for values of @xmath1 which can be investigated will allow us to verify the output of the mesoscopic version of the model that will be discussed in the following sections .     associated to the largest eigenvalue of the constrained matrix @xmath74 .",
    "results are shown for both @xmath75 ( blue solid line ) and @xmath76 ( purple dashed line ) . in the former case ,",
    "the logistic map has a stable fixed point ; in the latter a stable two - cycle . in both cases @xmath77 . ]    while it is not possible to explore very large values of @xmath1 numerically using the markov chain , some analytic results are available in the infinite @xmath1 ( deterministic ) limit , and we will end this section with a discussion of these . in this limit",
    "the dynamics is that of the logistic map @xmath78 .",
    "however , we can also formulate this in terms of the distribution of densities found from the kernel of the transfer operator , or ruelle operator , defined by  @xcite @xmath79 which takes the distribution @xmath80 and returns the distribution @xmath81 one time - step later .",
    "therefore @xmath82 where @xmath83 is the jacobian of the map .",
    "we would expect that , in the case of the logistic map , the gaussian and two - peaked distributions in fig .",
    "[ fig : qsd ] would be replaced by their respective @xmath84 limits , namely one delta - function spike located at the fixed point and two delta - function spikes located at the two cycle .",
    "that this is so is easily checked .",
    "for example , in the case of the fixed point , @xmath85 which shows that @xmath86 is an eigenfunction of @xmath87 with eigenvalue @xmath37 .",
    "similarly one can show that @xmath88 $ ] is an eigenfunction of @xmath87 when a two - cycle at @xmath89 and @xmath90 exists , also with an eigenvalue @xmath37 .",
    "there is no `` escape '' from these states in the @xmath84 limit , and so these are absorbing states . as @xmath69 increases ,",
    "so does the number of absorbing states , and so the number of eigenvalues equal to @xmath37 . in dynamical systems",
    "theory the quasistationary distribution in the @xmath84 limit is referred to as the invariant measure , which in the chaotic regime can have a very complex structure , as opposed to the delta - function spikes we have seen for the fixed point and two - cycle .",
    "when @xmath47 the invariant density for the logistic map can be found analytically @xcite , and is given by @xmath91^{-1}$ ] .    as we have already stressed , the microscopic model , which takes the form of a finite markov chain , is difficult to analyze and can only be numerically investigated for relatively small values of @xmath1 . to make further progress we construct a mesoscopic @xcite version of the model , in which we lose some of the finer details , but still retain enough of the structure of the model so as to allow accurate predictions at moderate to large values of @xmath1 .",
    "the derivation of a mesoscopic model from a microscopic one , where the discrete lattice points are replaced by a continuous variable @xmath92 , is quite standard in the theory of continuous - time markov processes @xcite , and the derivation for the discrete - time case initially follows the same route .",
    "that is , one begins from the chapman - kolmogorov equation  which holds because the process is markovian  and rewrites it so it takes the form of a kramers - moyal expansion @xcite : @xmath93 , \\label{km_conventional}\\ ] ] where @xmath94 is the @xmath95th jump moment and is defined by @xmath96^{\\ell } \\rangle_{z_{t}=z}. \\label{defn_m}\\ ] ] here we have suppressed the dependence on the initial conditions in both @xmath81 and @xmath97 .",
    "the jump moments only involve one time step , and can be calculated for the particular microscopic model one wishes to study .",
    "it is frequently found that that for @xmath98 they are small , and the infinite series can be truncated at @xmath99 .    here , however , this is not the case .",
    "if time is continuous , @xmath100 appears in eq .",
    "( [ defn_m ] ) as @xmath101 and is infinitesimally close to @xmath102 , whereas in the discrete - time case large jumps are allowed .",
    "furthermore , the distribution of values for @xmath100 will not in general be centered around @xmath102 .",
    "progress can be made by noting that @xmath100 is expected to be close to @xmath103 for large @xmath1 , since they are equal in the macroscopic limit , this being the definition of the equivalent deterministic map .",
    "we can now rewrite the jump moments as @xcite @xmath104^{\\ell } \\rangle_{z_{t}=z } \\nonumber \\\\ & = & \\langle \\left[z_{t+1 } - p_t +   \\left\\ { p - z \\right\\ } \\right]^{\\ell } \\rangle_{z_{t}=z } , \\label{new_m}\\end{aligned}\\ ] ] where @xmath105 . expanding out eq .",
    "( [ new_m ] ) gives @xmath106 where @xmath107^r \\right\\rangle_{z_{t}=z}. \\label{j_r}\\ ] ] as expected , these jump moments do fall off with @xmath1 : for @xmath108 @xmath109 @xcite , and so a truncation can be effected by neglecting the @xmath110 for @xmath111 .",
    "this approximation applied to eq .",
    "( [ km_conventional ] ) leads to @xmath112 \\nonumber \\\\ & & + \\frac{1}{2n}\\,\\sum^{\\infty}_{\\ell = 0}\\,\\frac{(-1)^{\\ell}}{\\ell ! } \\ , \\frac{\\partial^{\\ell}}{\\partial z^{\\ell}}\\,\\frac{\\partial^2}{\\partial z^2}\\ , \\left [ ( p - z)^{\\ell}\\,p(1-p)\\,p_t(z)\\right ] \\nonumber \\\\ & & +   \\mathcal{o}\\left(\\frac{1}{n^2}\\right ) .",
    "\\label{strange_km_expansion}\\end{aligned}\\ ] ] in the continous - time case this truncation would lead to a fokker - planck equation  a partial differential equation which is second order in the @xmath113 variable and first order in time .",
    "here we find an equation which is infinite order in the @xmath113 variable and a difference equation in time .",
    "however , in ref .",
    "@xcite we showed that a change of variables , allied to the use of the fourier transform , allows us to write the equation as @xmath114 + \\mathcal{o}\\left(\\frac{1}{n^2}\\right ) .",
    "\\label{second_order_form}\\ ] ] the pdf @xmath115 enters through a change of variables and is defined by @xmath116 . note that we can write the @xmath117 limit of the equation above explicitly in terms of @xmath118 as eq .  .",
    "equation , for finite @xmath1 , is the discrete - time equivalent of a fokker - planck equation .",
    "our interest in this paper is intimately connected with the structure of eq .",
    "( [ strange_km_expansion ] ) .",
    "since it has derivatives of infinite order , presumably an infinite number of boundary conditions need to be specified .",
    "thus we are led to conclude that the entire functional form of @xmath97 needs to be specified for @xmath119 and @xmath120 for all @xmath5 .",
    "this would fit in with our intuition , that finite jumps in this mesoscopic formulation can now take us out of the interval @xmath121which was not the case in the microscopic formulation  and need to be forbidden by extra conditions .",
    "in fact , in the derivation of eq .",
    "( [ second_order_form ] ) @xcite we had to explicitly make the assumption that @xmath122 for @xmath119 and @xmath120 for all @xmath5 , and this clearly is the additional data that needs to be specified in addition to either eq .",
    "( [ strange_km_expansion ] ) or eq .",
    "( [ second_order_form ] ) .    in continuous - time processes , working with stochastic differential equations , rather than with the equivalent fokker - planck equation ,",
    "is frequently more intuitive , and this is even more so in the discrete - time case .",
    "the equation is now a stochastic _ difference _ equation ( sde ) , and takes the form @xcite @xmath123 where @xmath124 is a gaussian variable with zero mean and correlator @xmath125 we have argued above that the differential - difference equation for @xmath97 should be augmented with the condition that it vanishes outside of the interval @xmath121 . in terms of eq .",
    "( [ stoch_diff_eqn ] ) this means that trajectories should not be allowed to leave the interval . but how can this rule be implemented in practice ?    it should be stressed that this question has little connection with ones relating to conventional boundary conditions . for instance , in the microscopic formulation of sec .",
    "[ sec : micro ] , only conditions at the actual boundary need be considered .",
    "these in any case are determined naturally from the nature of the transition matrix @xmath7 : an absorbing boundary at @xmath36 and a transition from @xmath126 to @xmath36 with probability @xmath37 .",
    "similarly , in the analogous stochastic differential equation , where time is continuous , the multiplicative form of the noise would resolve this problem since the noise vanishes at the boundary .",
    "however , because the system we are studying here admits large jumps , it is possible to jump directly from inside to outside of the interval .",
    "so although the noise vanishes at the boundary , this is not sufficient to prevent trajectories escaping .",
    "it is possible to postulate reasonable rules to deal with this `` leakage '' of probability out of the system . in simulations of the sde",
    "one could simply discard trajectories that at some time exited the interval @xmath127 , and restart the simulation . or one could restart such trajectories in some random position @xmath128 $ ] .",
    "the former method is how we proceeded in previous work where we compared exact results from the markov chain in eq .",
    "( [ markov_chain ] ) with numerical simulation results from the stochastic difference equation and found good agreement  @xcite .",
    "however we believe this question needs a more systematic analysis , especially when @xmath1 is not large and also when @xmath69 takes a value close to 4 , where the invariant density of the deterministic map covers most of the unit interval ( see sec .  [",
    "sec : micro ] ) .     +    before devising algorithms to deal with this leakage in sec .",
    "[ sec : trun_cen ] , we need to have some idea of how often it happens .",
    "we carried out numerical simulations of the sde ( [ stoch_diff_eqn ] ) for @xmath47 , since as explained above we expect the effect to be most noticeable here .",
    "the top panel of fig .",
    "[ fig : leakfraction ] shows the fraction @xmath129 of trajectories that leave the unit interval as a function of @xmath1 in the logistic map with @xmath46 , from a total of 5000 realizations of the sde , of 20000 iterations each .",
    "this fraction is found to scale roughly as @xmath130 . as a comparison ,",
    "the same quantity is plotted for @xmath131 in the bottom panel ; the fraction of trajectories leaving the interval falls off exponentially , and escape events are very rare even for relatively low values of @xmath1 .",
    "one can also ask where the exits from the interval land .",
    "figure [ fig : leakdist ] shows the distribution of first iterates to leave the unit interval , both through the lower and upper boundaries , for the case @xmath46 and @xmath132 .",
    "finally , we consider the maximum separation from either boundary reached by the first iterate to leave the interval for a given value of @xmath1 . denoting by @xmath133 the value of the first iterate to leave the unit interval through the lower boundary , where @xmath31 runs over all the trajectories leaving through the lower boundary for a given @xmath1",
    ", we define the maximum distance from the boundary as @xmath134 . in a similar way",
    ", we define @xmath135 , corresponding to the case of trajectories that leave the interval through the upper boundary .",
    "it is found that these distances scale roughly as @xmath136 for the logistic map with @xmath137 , as shown in fig .",
    "[ fig : maxmin ] .     +     ( @xmath138 , blue circles ) and @xmath139 ( @xmath140 , yellow triangles ) as a function of @xmath1 for the logistic map with @xmath46 . the red dashed line corresponds to @xmath141 . ]",
    "one of the most significant aspects of the approximation which takes us from the microscopic model in the form of eq .",
    "( [ markov_chain ] ) to the sde ( [ stoch_diff_eqn ] ) is the neglect of jump moments @xmath110 for @xmath111 .",
    "we end this section by examining the consequence of this by performing the calculation of the higher jump moments ( from the original , microscopic model ) numerically , to check whether this truncation is reasonable .",
    "as shown in appendix [ app_1 ] , in a mesoscopic context , the jump moments are simply the moments of the noise , @xmath124 , at time @xmath5 . therefore these can be used to numerically calculate the characteristic function corresponding to the probability distribution of the noise .",
    "the probability distribution can then be obtained by taking the fourier transform of the characteristic function .",
    "we denote this distribution by @xmath142 , since it will depend on the value of @xmath9 . here",
    "we present some results graphically : further details can be found in appendix [ app_1 ] .",
    "we would expect non - gaussian effects to be most noticeable when @xmath1 is small and @xmath143 is very close to one of the boundaries .",
    "under these conditions it is indeed found that the probability distribution for the noise becomes noticeably skewed , and therefore non - symmetric about the origin .",
    "such a distribution is indicated by a characteristic function that has a non - zero imaginary component , as shown in fig .",
    "[ fig : char_func ]  @xcite . the corresponding probability distribution is shown in fig .",
    "[ fig : prob_dist ] , where it is compared with the noise distribution used in the stochastic difference equation given in eq .  , which is gaussian with zero mean and with a variance given by eq .",
    "( [ correlator ] ) .",
    "figure [ fig : prob_dist ] also shows the two cumulative distributions . although the consideration of the higher jump moments does introduce a measurable skew to the distribution , so that now less probability lies in the forbidden region , it does not remove escape events from the system , as the lower panel of fig .  [",
    "fig : prob_dist ] clearly shows .",
    "we also repeated the procedure for larger values of @xmath1 .",
    "as the value of @xmath1 increases , the gaussian distribution for the noise becomes more and more accurate , and eq .   can safely be used to model the microscopic process .",
    "note , however , that very large values of @xmath1 are required as the deterministic map approaches the boundaries , as illustrated in fig .",
    "[ fig : leakfraction ] for the extreme case @xmath46 .    in order to use such a non - gaussian distribution in the next section ,",
    "we need to parameterize it in some way .",
    "this is due to the fact that computing the characteristic function of the noise distribution at every iteration of the sde would be extremely time - consuming .",
    "therefore , we choose to fit the noise distribution to a skew - normal distribution with shape parameter @xmath144 , scale parameter @xmath145 , and location parameter @xmath146  @xcite given by @xmath147^{1/2 } \\left[1-\\frac{2 \\alpha^2}{\\pi ( 1+\\alpha^2)}\\right]^{-1/2},\\\\ \\xi & = p - \\alpha \\omega \\sqrt{\\frac{2}{\\pi ( 1+\\alpha^2 ) } } , \\label{para_skew_dist } \\end{split}\\end{aligned}\\ ] ] where , away from the boundaries , @xmath148 and @xmath149 ; meanwhile , @xmath150 is the skewness of the binomial distribution with parameters @xmath1 and @xmath9  @xcite .",
    "we choose this distribution for the simple reason that it is a natural generalization of the normal distribution to allow for non - zero skewness .",
    "the choice of parameters ensures that the mean and variance of the distribution are independent of @xmath144 and are , respectively , @xmath9 and @xmath151 .",
    "furthermore , for @xmath152 , @xmath153 and @xmath149 , and the distribution tends to a gaussian distribution with variance @xmath154 centered on @xmath9 , which corresponds to the distribution specified by eq .  .",
    "near the boundaries , we take @xmath155 with @xmath156 .",
    "these values are an approximation to the ones obtained by fitting the pdf of a skew - normal distribution , with parameters given by eq .",
    ", to the binomial distribution for the noise . figure  [ fig : skew ] shows the skew - normal distribution given by   for the same choice of parameters as in fig .",
    "[ fig : prob_dist ] .     +     +     and @xmath157 . ]",
    "numerical studies of the model expressed as a markov chain [ eq .  ( [ markov_chain ] ) ] , using standard tools such as mathematica  @xcite , are only feasible up to values of a few hundred for @xmath1 . in the mesoscopic formulation",
    "[ eq .  ] , on the other hand , @xmath1 appears as a parameter , and therefore arbitrarily large values can be investigated . the problem , as we have discussed in detail in sec .",
    "[ sec : meso ] , is that in the numerical simulation of the sde ( [ stoch_diff_eqn ] ) , trajectories which escape outside of the interval @xmath158 $ ] have to be somehow discounted .",
    "simple rules for implementing this have already been mentioned , for example rejecting escaping trajectories and restarting the simulation or resetting the value of @xmath113 to an arbitrary point in @xmath127 .",
    "here we examine two more methodical approaches to this question .    a more sophisticated prescription would be to use a suitably defined noise distribution to make a choice for the noise which ensures that the trajectory does not exit the boundary . in sec .",
    "[ sec : meso ] we discussed possible forms of the noise distribution . here we now ask : what is the microscopic distribution to which this noise distribution is equivalent , and does it have any properties that we would wish to impose on @xmath159 ?",
    "this question is discussed in appendix [ app_2 ] , where we argue that the @xmath26-th column of the transition matrix @xmath160 fulfills this role ; we recall that this is a binomial distribution with parameters @xmath1 and @xmath9 . here",
    "@xmath26 is fixed such that @xmath161 , and @xmath4 corresponds to @xmath162 . since @xmath163 vanishes for @xmath164 or @xmath165",
    ", this suggests that we should demand that @xmath159 is zero for noises such that @xmath166 and @xmath167 .",
    "using such a distribution does indeed seem reasonable , since starting at @xmath9 implies ( using eq .",
    "( [ stoch_diff_eqn ] ) ) that we move to @xmath168 in one jump .",
    "but if @xmath169 is drawn from a distribution for which @xmath169 can never be smaller than @xmath170 or larger that",
    "@xmath171 , this means that a @xmath100 is never found which is less than @xmath62 or greater than @xmath37 , and so the sde ( [ stoch_diff_eqn ] ) can safely be simulated ignoring escape events altogether .",
    "there are two ways to achieve this which are discussed in the literature  @xcite . in the first",
    ", one constructs the `` truncated distribution '' , which consists of truncating the noise distribution at @xmath172 and @xmath173 , and renormalizing it so that the area under the curve is again @xmath37 .",
    "the second approach , consists in `` censoring '' the distribution so that @xmath169 is drawn from a distribution where the probability that it is exactly @xmath170 ( resp .",
    "@xmath171 ) corresponds to the probability that @xmath174 ( resp .",
    "@xmath175 ) in the original distribution . in other words ,",
    "the probability mass lying outside of the unit interval is not redistributed in the whole interval _ via _ renormalization , but rather placed at the boundaries themselves . in figure",
    "[ fig : prob_dist_trunc ] we compare the microscopic form of the distribution , @xmath13 , to the truncated and renormalized @xmath159 , as well as its censored version , and find that in both cases  the distribution obtained with higher moments , and its skew - normal parameterization  the censored distribution yields better agreement with the microscopic distribution @xmath13 , an effect which is more pronounced for the skew - normal parameterization .",
    "we can further illustrate this by comparing the cumulative distribution functions of the truncated and censored distributions , which are shown in figure  [ fig : cdfs ] both for the gaussian and skew - normal distributions .",
    "+    , for @xmath13 ( green dots ) , and the gaussian ( red ) and skew - normal ( blue ) parameterizations of @xmath176 . the dashed and continuous lines correspond to the truncated and censored distributions , respectively .",
    "the parameter values are @xmath157 and @xmath177 . ]",
    "we end this section with a summary of the methods we have suggested to treat the problem of trajectories leaving the interval on which the model is defined .",
    "the method of _ random replacement _ employs the stochastic difference equation used previously @xcite , which is summarized in eqs .",
    "( [ stoch_diff_eqn ] ) and ( [ correlator ] ) .",
    "when a trajectory leaves the unit interval it is returned to the interval at a randomly chosen position .",
    "the _ truncated gaussian _",
    "method uses the same gaussian distribution for the noise , truncated and renormalized so that trajectories can not leave the interval .",
    "the _ censored gaussian _ method again uses the gaussian noise , but this time the total probability to leave the interval through the lower ( or upper ) boundary is instead placed at that boundary .",
    "the methods of censoring and truncating the distributions are also used with the skew - normal distribution introduced in sec  [ sec : meso ] for the methods of _ censored skew - normal _ and _ truncated skew normal_. this distribution is parameterized as shown in eq .",
    "( [ para_skew_dist ] ) .",
    "we now compare these different straegies to each other and to the results obtained from the original , microscopic , model .",
    "in the previous section we have described a number of different descriptions of the noise in the stochastic difference equation .",
    "these have involved placing restrictions on the noise , so that trajectories remain the unit interval .",
    "allied to this , we have examined the non - gaussian nature of the noise near the boundary , and have proposed including higher - order jump moments , parameterized through the use of a skew - normal distribution to describe the noise . for a range of @xmath178",
    "we will now show results from all five prescriptions for the noise , each designed to prevent trajectories leaving the interval .    in figs .",
    "[ fig : qsd_meso_1 ] to [ fig : qsd_meso_4 ] we compare the results for the quasistationary probability distribution for all the methods above against the desired result obtained from the markov chain , for the logistic map with different choices of parameters . in the case where the noise distribution is truncated , the simulations are straightforward to perform , as trajectories will not leave the unit interval . for the censored distributions ,",
    "however , some trajectories will be discarded , to reflect probability building up at the boundaries .",
    "a large number of trajectories are generated , until 25000 of them survive ( i.e. remain in the unit interval ) until iteration number @xmath1 .",
    "we use the system size here , since we expect the survival times to depend on the noise strength . from each of these trajectories , we take the last iterate and build a histogram as a numerical approximation of the desired probability distribution .     +     +    we find that when the dynamics stays sufficiently far from the boundaries , the simulation method employed is less important , and all of them yield a quasistationary distribution which is in good agreement with the markov chain .",
    "an example of this is shown in fig .",
    "[ fig : qsd_meso_1 ] . in cases such as this one , the unbounded noise used in eq .",
    "( [ stoch_diff_eqn ] ) will only cause trajectories to leave the interval very rarely .",
    "furthermore , as trajectories seldom venture close to the boundaries , the gaussian noise in eq .",
    "( [ stoch_diff_eqn ] ) is a very good approximation of the microscopic dynamics . as the map spends more and more time near the boundaries",
    ", however , we observe a clearer difference between the various methods . in figs  [ fig : qsd_meso_2 ] and [ fig :",
    "qsd_meso_3 ] we examine the case where almost the entire interval is being explored , for two choices of @xmath1 . for the smaller value of @xmath1 , shown in fig .",
    "[ fig : qsd_meso_2 ] , all methods overestimate the amount of time spent near the boundary at zero , although the random replacement method and the censored distributions perform better than the truncated distributions . as we show in fig .",
    "[ fig : qsd_meso_3 ] , increasing the value of @xmath1 provides better agreement with the markov chain for all methods .",
    "+     +    the most testing regime in which to challenge our various prescriptions for the noise is when the noise is strong and @xmath69 is chosen such that there is a stable fixed point lying very close to one of the boundaries .",
    "we show results for this scenario in fig .",
    "[ fig : qsd_meso_4 ] . here , the results from the random replacement method are easy to interpret . returning a trajectory to a randomly chosen point in the unit interval has the effect of reducing the amount of time trajectories spend near the stable fixed point , causing a broadening of the probability distribution . in this figure",
    "it is clear that the censored distributions perform much better than the truncated distributions .",
    "this is because the renormalization of the truncated distribution means that if @xmath102 is close to zero then the following iteration , @xmath100 , is artificially more likely to fall near ( but not at ) the boundary , since in this case the noise distribution is very large near zero , and renormalizing it adds even more weight to this region .",
    "subsequent iterations , then , will very likely become ` trapped ' inside it .",
    "we also note that , for both truncated and censored distributions , the gaussian distribution performs as well as the more complicated skew - normal distribution .",
    "although the method of censoring outperforms the other methods , it is clear from our results that some discrepancies are apparent when trajectories spend an appreciable amount of time very close to zero .",
    "we hypothesized that the key to the discrepancies apparent here , and in the other methods , is an important difference in the behavior of the microscopic and mesoscopic models .",
    "it is noticeable in fig .",
    "[ fig : qsd_meso_4 ] that the blue solid line , denoting the largest eigenvector of @xmath179 ( or , equivalently , the second - largest eigenvalue of @xmath7 ) does not extend all the way to @xmath180 .",
    "this is because when we form @xmath179 we remove the absorbing state present in @xmath7 .",
    "so the first lattice point in the reduced microscopic system corresponds to @xmath181 , not @xmath180 . in constrast ,",
    "in a mesoscopic model , a trajectory can enter the region @xmath182 , and then later return to the region @xmath183 .",
    "this is then a possible explanation for why the region near zero is more ` populated ' than expected from the metastable state of a microscopic model with an absorbing boundary .",
    "we tested this theory by using a modified censoring for the noise distribution .",
    "previously , the probability mass lying outside the unit interval was placed at the boundaries .",
    "now , we stipulate that the total probability outside the interval @xmath184 be placed at the boundaries .",
    "we used a gaussian distribution for the noise , and will refer to this method as the _ modified censored gaussian_. the bottom right panels in figs .",
    "[ fig : qsd_meso_1 ] to [ fig : qsd_meso_4 ] show the results obtained .",
    "a clear difference between the two types of censoring is visible in fig .",
    "[ fig : qsd_meso_4 ] .",
    "although the modified censoring method does not perfectly capture the results from the microscopic system , the results are qualitatively more similar , in that the probability distribution has a local maximum .",
    "for the parameters chosen in fig .",
    "[ fig : qsd_meso_1 ] trajectories vary rarely visit the interval @xmath185 , and so no difference between the types of censoring is visible . in fig .",
    "[ fig : qsd_meso_2 ] , the results from the modified censoring method are more similar to the behavior of the microscopic model . however , as @xmath1 increases , the difference between the methods diminishes , as the region @xmath185 becomes very small ( see fig .  [",
    "fig : qsd_meso_3 ] ) .",
    "in a series of earlier articles @xcite we developed a formalism where , starting from a microscopic model , a mesoscopic description of a discrete - time stochastic process in can be studied .",
    "previously many authors had studied discrete - time stochastic models but they either assumed that time became continuous ( as the number of states became large ) or simply added a noise term to the deterministic dynamics .",
    "in contrast we began from a microscopic model with discrete states and discrete time , and derived the corresponding mesoscopic model now with a continuous state space and discrete time , which has a multiplicative noise generated by the underlying microscopic process .",
    "we found an analog of the fokker - planck equation , but which contained an infinite number of derivatives in the state variable .",
    "as discussed in sec .",
    "[ sec : meso ] , this can be thought of as a reflection of the fact that large jumps can occur in systems where time is discrete .",
    "it is possible to manipulate this partial differential equation into one with no more than second order derivatives , and from this obtain an sde .",
    "the advantage of the sde is that it may be simulated for arbitarily large @xmath1 , which is not the case for the microscopic model .",
    "however , one difficulty arises : unlike in the continuous time situation , the large jumps can lead to transitions which leave the state space on which the microscopic model is defined .",
    "it is clear that we have to somehow suppress these escape events , since the probability of the system being outside of the state space must be strictly zero , but the question is : how should this be imposed on the sde ?    in this paper we have investigated a number of aspects of this feature , leading up to a variety of algorithms designed to forbid escape trajectories , described in sec .",
    "[ sec : trun_cen ] . after studying the results from five prescriptions for preventing trajectories leaving the interval",
    ", we propose that in the mesoscopic approximation an extra ingredient is needed which is not required when the time is continuous .",
    "this is that the noise term in the sde should not have a distribution which is gaussian , but instead should be a censored gaussian .",
    "the censoring is carried out in such a way that it ensures that any realization of the noise does not lead to a trajectory which leaves the interval on which the system is defined .",
    "this may appear to detract from the perceived simplicity of the sde formalism , but we can make little analytical progress from the sde , and so most investigations are numerical , for which the simplicity of the noise distribution is not so important . furthermore ,",
    "if we are only interested in the quasistationary distribution of the markov chain , the censoring can be easily implemented by using a standard gaussian distribution and discarding the trajectories that leave the interval in which the process is defined .",
    "we compared the results found by using a censored gaussian with results using other methods , namely ( i ) using a truncated distribution , ( ii ) replacing trajectories back in the interval in some random position once they leave , and ( iii)(iv ) using a truncated and censored skew - normal distribution , which better approximates the continuous analog of the microscopic noise distribution .",
    "we also compared these results to the desired behavior obtained from the markov chain for values of @xmath1 where this is feasible .",
    "when carrying out this comparison for the quasistationary probability distribution , we found only small variation between methods for parameter values when the map either stays far from the boundaries or explores almost the entire unit interval  the latter case requiring larger values of @xmath1 to obtain good agreement with the markov chain  while in the case when the map has a stable fixed point close to one of the boundaries , only the censored distribution yields reasonably accurate results .",
    "these can be improved if the censoring is performed in such a way that the sde is forbidden from entering the region @xmath186 , which does not feature in the quasistationary distribution of the markov chain .",
    "it is important to note that the parameter choices explored in this paper , when comparing different methods of dealing with escape events , represent extreme cases of the behavior of the system . in practice",
    ", the sde approach will be employed for larger values of @xmath1 , for which it is impractical to analyze the markov chain directly . in such cases",
    ", we would expect the mesoscopic quasistationary distribution to accurately reproduce its microscopic counterpart when employing a censored distribution for the noise .",
    "we would also expect the original censored distribution to become sufficiently accurate as @xmath1 increases , eliminating the need for the modified version .",
    "since we find no noticeable difference between the gaussian and skew - normal versions of the censored distribution , the simpler gaussian implementation is advised .",
    "cp - r was funded by conicyt becas chile scholarship no .",
    "72140425 and d.f .",
    "acknowledges financial support from h2020-msca - itn-2015 project cosmos 642563 .",
    "in this appendix we provide details for constructing the characteristic function of the probability distribution for the noise , as displayed graphically in sec .  [",
    "sec : meso ] .",
    "our starting point is the definition of the jump moments , found in eq .",
    "( 53 ) in ref .",
    "@xcite : @xmath187 where we include a factor @xmath188 which was missing in ref .",
    "@xcite . here",
    "@xmath189 is the @xmath190 moment of the microscopic distribution , and is defined through the binomial structure of the transition matrix @xmath191 i.e. @xmath192 . from eq .",
    "( [ j_r ] ) we also have the relation @xmath193^r \\rangle_{z_t = z}=\\langle \\eta_t^r \\rangle .\\ ] ] we wish to use knowledge of the jump moments to reconstruct the probability distribution for the noise @xmath169 .",
    "this distribution will in general depend on the value of @xmath194 , so we label it @xmath159 .",
    "this is carried out by using the characteristic function , defined as the fourier transform of @xmath159 : @xmath195 expanding the exponential we find @xmath196 we can calculate the left - hand side of the above equation using our knowledge of the jump moments . for the figures presented in this article",
    ", we used the first 150 jump moments to approximate @xmath197 .",
    "we can then find the distribution @xmath159 by taking the inverse fourier transform .",
    "in this second appendix we explore the properties of the microscopic distribution of which the noise distribution @xmath159 , discussed in appendix [ app_1 ] , is the mesoscopic equivalent .",
    "we therefore return to the model defined as a markov chain , and recall from the definition of the transition matrix @xmath160 , that its @xmath26-th column @xmath198 represents the ( discrete ) probability distribution of jumps starting from the @xmath26-th state .",
    "so this is in some sense the microscopic analog of @xmath199 .",
    "the main difference is that in the former the initial state @xmath26 is fixed , whereas in the latter it is @xmath143 that is fixed .",
    "in addition , in the microscopic version , the initial state @xmath26 and the final state @xmath4 are respectively @xmath200 and @xmath201 in the notation of the mesoscopic formulation .",
    "however , @xmath199 is more naturally expressed as a function of @xmath9 and @xmath169 , and so the correct analog of @xmath13 is @xmath202 .",
    "that is , it is the probability distribution of states @xmath100 , given that @xmath102 satisfies @xmath203 , but expressed in terms of the variables @xmath169 and @xmath9 .",
    "we can now ask if @xmath13 has any properties which we would wish to impose on @xmath204 .",
    "one significant feature can be seen by examining the probabilities of jumping from the given state @xmath26 to the boundaries at @xmath36 ( @xmath180 ) and @xmath126 ( @xmath139 ) .",
    "these are given , respectively , by @xmath205 and @xmath206 , where @xmath207 $ ] for the logistic map .",
    "these elements are non - zero except for @xmath208 and @xmath209 , i.e.  for @xmath210 and @xmath211 , and yet they are by definition @xmath62 for @xmath4 negative or greater than @xmath1 .",
    "this suggests that we should ask that @xmath199 does not smoothly tend to zero at the boundaries , but instead has discontinuities at @xmath212 and @xmath213 , that is , at noise strengths @xmath170 and @xmath171 .",
    "25ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _",
    "( ,  ,  ) @noop _ _  ( ,  ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  ed .",
    "( ,  , ) @noop _ _  ( ,  ,  ) @noop _ _ ( ,  ) @noop * * ,   ( ) @noop _ _  ( , ) http://chaosbook.org/[__ ]  ( ,  ,  ) @noop _ _ ,  ed .",
    "( ,  ,  ) @noop _ _ ,  ed .",
    "( ,  ,  ) https://books.google.co.uk/books?id=kgv3bwaaqbaj[__ ] ,  lecture notes in statistics  ( ,  ,  ) @noop * * ,   ( )  and ,  eds . , @noop _ _  ( ,  ,  ) @noop _ _  ( ,  )   @noop _ _ ,  ed .",
    "( ,  ,  )"
  ],
  "abstract_text": [
    "<S> we explore the properties of discrete - time stochastic processes with a bounded state space , whose deterministic limit is given by a map of the unit interval . </S>",
    "<S> we find that , in the mesoscopic description of the system , the large jumps between successive iterates of the process can result in probability leaking out of the unit interval , despite the fact that the noise is multiplicative and vanishes at the boundaries . by including higher - order terms in the mesoscopic expansion , we are able to capture the non - gaussian nature of the noise distribution near the boundaries , but this does not preclude the possibility of a trajectory leaving the interval . </S>",
    "<S> we propose a number of prescriptions for treating these escape events , and we compare the results with those obtained for the metastable behavior of the microscopic model , where escape events are not possible . </S>",
    "<S> we find that , rather than truncating the noise distribution , censoring this distribution to prevent escape events leads to results which are more consistent with the microscopic model . </S>",
    "<S> the addition of higher moments to the noise distribution does not increase the accuracy of the final results and it can be replaced by the simpler gaussian noise . </S>"
  ]
}