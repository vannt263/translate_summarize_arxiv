{
  "article_text": [
    "in this proceedings we present some specific work about the material presented in the proceedings of michael joyce , where a detailed introduction can be found . in what follows",
    "we remind very briefly the motivations of our work .    at the scales of interest in cosmology",
    ", the evolution of the dark mater can be very well described as a fluid , which obeys the vlasov equation coupled with the poisson equation ( e.g. @xcite ) : [ vlasov - poisson ] @xmath0 where @xmath1 is the one - particle phase space density in physical coordinates ( i.e. it gives the probability density to find a particle at @xmath2 with velocity @xmath3 at time @xmath4 ) , @xmath5 the local density of dark matter and @xmath6 the gravitational constant .",
    "the solution of the vlasov equation is generally `` estimated '' performing n - body simulations , using a number of particles much smaller than the number of dark matter particles ( it can be seen as a discretization of the system ) .",
    "this method leads inevitably to discreteness effects , which are still not well understood .    up to now the primary approach to the study of discreteness in n - body simulations",
    "has been through numerical studies of convergence ( see e.g. @xcite ) , i.e. , one changes the number of particles in a simulation and studies the stability of the measured quantities .",
    "where results seem fairly stable , they are assumed to have converged to the continuum limit . while this is a coherent approach , it is far from conclusive as , beyond the range of perturbation theory , we have no theoretical `` benchmarks '' to compare with . nor is there any systematic theory of discreteness effects , e.g. , we have no theoretical knowledge of the @xmath7 dependence of the convergence .",
    "it can be found in the literature several studies using this approach of the most obvious effect of discreteness  and certainly the one most emphasized in the literature  which is the two body collisionality : pairs of particles can have strong interactions with one another , which is an effect absent in the collisionless limit . for analysis and discussion of these effects",
    "see , e.g. , @xcite .",
    "in this proceedings we present a work which permits to understand systematically the discreteness in the _ linear regime _ of gravitational clustering .",
    "we do so by developing a perturbative solution to the fully discrete cosmological n - body problem .",
    "this essentially analytic solution can be compared to the analogous fluid ( @xmath8 ) theory , of which analytic solution is well - known .",
    "we will remind first the standard _ perturbative fluid theory _ ( flt ) , we will construct the _ particle linear theory _ ( plt ) and by comparing both we will quantify the discreteness effects in the linear regime . we will also present a test which permits to quantify the discreteness effects in the non - perturbative regime of gravitational clustering . the material presented in these proceedings",
    "is based on work which can be found in @xcite .",
    "it is convenient , to simplify the problem vlasov equation , to construct a set of _ fluid equations _ , which give a less detailed ( but sufficiently accurate ) description of the system .",
    "we define the _ mass density _ and the _ mean fluid velocity _ from the velocity moments of @xmath1 : [ momenta - f ] ( , t)=md f(,,t),(,t)=md f(,,t ) . where @xmath9 is the mass of the dark matter particles .",
    "inserting eqs .   in the vlasov - poisson equation , we obtain the _ continuity _ equation and the _ euler _ equation in the variables @xmath5 and @xmath10 .",
    "these are the fluid equations in the _ eulerian _ formalism . in cosmology , it is common to use the _ lagrangian _ formalism which is known to give better results in a perturbative approach ( see e.g. @xcite).the idea of the lagrangian formulation is to calculate the trajectories of infinitesimal fluid elements .",
    "the velocity is given by the velocity of these fluid elements and the density varies according with the convergence or the divergence of the fluid elements to each point .",
    "we define the lagrangian coordinate @xmath11 as the position of the fluid element at the initial time . because we work in an expanding universe , it is natural to write the physical position of a fluid element @xmath2 in function of its lagrangian coordinate @xmath11 as : [ mapping ] ( t)=a(t)(+(,t ) ) , where @xmath12 is the scale factor ( which is given by the particular cosmological model considered ) and @xmath13 is a `` displacement field '' of the fluid elements .",
    "the displacement field @xmath13 in eq .   can be understood as a perturbation of the homogeneous model which expands with the scale factor @xmath12 . using the coordinate transformation",
    "we obtain a set of fluid equations for the displacement field @xmath13 . linearizing them about the displacements @xmath13 and neglecting pressure corrections ( which is a very good approximation for sufficiently large scales ) ,",
    "one obtains a simple system of equations ( see e.g. @xcite for details ) . to look for a solution of these equations , it is convenient to divide the displacements into a curl - free part , @xmath14 and a divergence - free part , @xmath15 , i.e. , @xmath16 ( i.e. @xmath17 and @xmath18 )",
    ". then we obtain the set of equations ( choosing appropriate boundary conditions ) @xcite : [ lagb - expl ] _ + 2_=0,_+2_+3_=0 . given initial conditions",
    ", it is simple to compute the solution for the displacement field with time .",
    "the linear approximation ( and more generally a perturbative approach of the lagrangian fluid equations ) breaks down when the volume of a fluid element becomes zero .",
    "this is called _",
    "in this section we will present a linearized theory of the n - body problem ( plt ) , which is the discrete analogue of the linear fluid theory presented in the previous section .",
    "the starting point is the full evolution of the n - body system in comoving coordinates : [ full - ev ] _",
    "i+2_i=-_ij , where @xmath19 is the position of the @xmath20-th particle and @xmath12 the scale factor .    a standard way to generate initial conditions for n - body simulations",
    "consists in perturbing a lattice ( see e.g. @xcite ) .",
    "it is therefore natural to build a perturbative theory where the perturbed variable is the displacement of each particle about the lattice , which is an equilibrium position .",
    "we will therefore have an accurate description of the clustering when the displacements ( or , in fact , the relative displacements ) are smaller than the inter - particle distance .",
    "when the relative displacements become larger than the inter - particle distance , the approximation breaks down , which is equivalent to the `` shell - crossing '' in fluid theory .",
    "we define the displacement @xmath21 about the lattice position @xmath22 as @xmath23 , where @xmath22 is the lattice site of particle @xmath20 . using this notation we can linearize the full evolution as [ linear - ev ] * u*(*r*,t ) + 2 ( * r*,t ) = - _ * r* d ( * r*- * r* ) * u*(*r*,t ) , where @xmath24 is called the _ dynamical matrix _ , which is @xmath25 and @xmath26 .",
    "taking periodic boundary conditions ( as in the n - body simulations ) , it is possible to diagonalize eq .   simply by taking its fourier transform , defined as @xmath27 for the displacement field , and in an analogue manner for the dynamical matrix @xmath28 . using eqs .   and the definition of the fourier transform , we obtain for each @xmath29 : [ modes - eq ] * * ( * k*,t ) + 2 ( * k*,t ) = - ( * k * ) * u*(*k*,t ) .",
    "it is possible to solve eq .   by diagonalizing the @xmath30 matrices",
    "@xmath31 . for each @xmath29 , this determines three orthonormal eigenvectors @xmath32 with three associated real eigenvalues is a real and symmetric matrix . ]",
    "@xmath33 ( @xmath34 ) , satisfying the eigenvalue equation @xmath35 .",
    "once @xmath33 is calculated , the evolution of the displacement of the particles is straightforward to compute .      to understand the dynamics of the plt is important to study the spectrum of eigenvalues of the matrix @xmath31 .",
    "we will describe in what follows this spectrum for a simple cubic ( hereafter sc ) lattice , which is very widely used in n - body simulations of structure formation in cosmology .    in fig .",
    "[ fig1 ] we plot the spectrum of a sc lattice , for @xmath36 particles .",
    "we show the normalized eigenvalues @xmath37 as a function of the modulus of the @xmath29 vectors , normalized to the nyquist frequency @xmath38 ( @xmath39 is the inter - particle distance ) . with this normalization",
    "the spectrum remains substantially the same as we increase the number of particles : the only change is that the eigenvalues become denser in the plot , filling out the approximate functional behaviors with more points .",
    "we see how for each vector @xmath29 there are three eigenvalues @xmath33 , @xmath34 .",
    "each family of eigenvalues ( i.e. with same @xmath40 ) defines a surface , corresponding to the three branches of the frequency - wavevector dispersion relation .",
    "sections of these surfaces are plotted for some chosen directions of the vector @xmath29 in fig .",
    "[ fig1 ] .    the fluid limit of this system is given by taking the @xmath41 limit keeping the inter - particle distance @xmath39 constant : a plane wave fluctuation @xmath42 with @xmath43 has a variation scale much larger than the inter - particle distance , and therefore does not `` see '' the particles .",
    "it is simple to show ( e.g. @xcite ) that in this limit the eigenvectors and eigenvalues are : _ (",
    "i ) _ one _ longitudinal _ eigenvector polarized parallel to @xmath29 with normalized eigenvalue @xmath44 and _ ( ii ) _ two _ transverse _ eigenvectors polarized in the plane transverse to @xmath29 with normalized eigenvalues @xmath45 .",
    "it is interesting to note that in this limit , using eq .",
    ", we obtain exactly the two fluid equations , particularized to an einstein - de sitter ( eds ) universe and with the same boundary conditions .",
    "this means that the n - body system is a specific discretization  at least in the linear regime of the underlying fluid theory .",
    "divided by the fluid amplification factor at @xmath46 , for a sc lattice , in function of the modulus of the wave - vectors normalized to the nyquist frequency .",
    "[ fig2],scaledwidth=60.0% ]      it is now straightforward to quantify precisely the discreteness effects  in the linear regime  by comparing the flt explained in section [ flt ] and the plt derived in section [ plt ] .",
    "we will focus here on the discreteness effects in the power spectrum ( hereafter ps , for its definition see e.g. @xcite ) but an analogous analysis can be performed for any statistical quantity or , for example , the trajectories of a single particle ( see @xcite ) .",
    "it is possible to show , considering an initial power spectrum @xmath47 at @xmath48 , that we have , as a very good approximation ( for not too large displacements compared to the lattice spacing ) , @xmath49 , where @xmath50 is a function which depends on the particular lattice and the cosmological model considered .",
    "one of the most important result obtained in this work is that discreteness effects _ increase with time_. in the literature the time was not considered as a parameter in which depends the discretness effects , but only `` static '' parameters as the number density of particles .",
    "it is possible to check that , in the fluid limit , we recover the well - known amplification of the ps in the fluid theory , i.e. , @xmath51 .",
    "we plot the function @xmath52 , normalized to the fluid amplification , in fig .",
    "we have chosen a value of @xmath46 for the scale factor .",
    "this is a typical scale factor at which shell crossing occurs in cosmological simulations .",
    "notice the similarity of this figure with the optical branch in fig .",
    "[ fig1 ] : the evolution `` deforms '' the spectrum of eigenvalues .",
    "note how the eigenvalues with @xmath53 give rise to @xmath54 for these modes , i.e. , there are modes which grow faster than the fluid limit . in the figure , we have classified the modes as a function of the angle subtended by their wave vector @xmath29 with the lattice axis that form the minimal angle with it .",
    "we see that there is a strong dependence of the value of the eigenvalue on this angle : the closer @xmath29 is to parallel to one of the axes , the larger is the eigenvalue of the mode , on average .",
    "this is a manifestation of the breaking of isotropy introduced by the n - body discretization on the lattice .",
    "even if there are some modes that grow faster than the fluid , averaging over bins with similar @xmath55 the resultant growth is slower  because we consider sufficiently early times  than the fluid limit .",
    "note that this averaging is generally performed when computing statistical properties of the particle distribution , such as the ps , for example .",
    "it is much more difficult to quantify the discreteness effects in the non perturbative regime because there is no known solution of the fluid theory . in this section",
    "we present briefly some work in progress which goal is to quantify the discreteness effects in this regime .",
    "we run a set of simulations with exactly the same parameters ( time - step , force accuracy , etc . ) for an initial ps @xmath56 ( which corresponds to the kind of density fluctuations of the standard cosmological model ) in an expanding eds universe , taking different perturbed lattices to generate the initial conditions : body cubic centered ( bcc ) , face cubic centered ( fcc ) , sc and `` glass '' .",
    "it can be considered as different discretizations of the same continuous density field .    in fig .",
    "[ corr ] we show the evolution of the ps for times corresponding to @xmath57 , @xmath58 , @xmath59 . in the largest figures are shown the ps and in the smallest ones the relative residuals @xmath60 between the ps of a particular lattice @xmath20 ( @xmath61 bcc , fcc , glass or sc ) and the average of all of them : [ residuals ] c_i(k)=. at the initial time , the ps up to the nyquist frequency is approximately the same for all the lattices .",
    "however , at scales larger than the nyquist frequency , the ps corresponding to the different lattices is very different due to the great differences between the distributions at small scales .",
    "time evolution ( @xmath58 ) erases almost all the differences at small scales . at all scales",
    ", the evolution of the ps of the different initial distributions is very similar .",
    "the residuals show that _ i ) _ the discreteness effects have been globally reduced , _ ii ) _ the differences can be up to @xmath62 and _ iii ) _ the scale at which these differences appear is much larger than the initial discreteness scale @xmath63 : there is a propagation of discreteness from small scales to large scales . in the figure we have shown also the evolution of the initial ps using fluid linear theory . at @xmath59",
    "there are no linear modes left in the box ( it can be seen by the fact that linear fluid theory does not reproduce the evolution of any smallest fourier mode ) . the differences between the ps of the different initial lattices are larger than in the previous time slice @xmath58 ( in which there were still some linear modes ) .",
    "this is related to the fact that all the system is highly non linear . finally , it is interesting to note that , as in the linear regime , the discreteness effects increase with time .",
    "* acknowledgments * + i am indebted to t. baertschiger , a. gabrielli , m. joyce and f. sylos labini for our fruitful collaboration .",
    "i also thank them to have read and for comments on this manuscript .",
    "the simulations where performed on the cluster of the `` e. fermi '' center of rome ."
  ],
  "abstract_text": [
    "<S> we present the problematic of controlling the discreteness effects in cosmological n - body simulations . </S>",
    "<S> we describe a perturbative treatment which gives an approximation describing the evolution under self - gravity of a lattice perturbed from its equilibrium , which allows to trace the evolution of the fully discrete distribution until the time when particles approach one another ( `` shell - crossing '' ) . </S>",
    "<S> perturbed lattices are typical initial conditions for cosmological n - body simulations and thus we can describe precisely the early time evolution of these simulations . a quantitative comparison with fluid lagrangian theory permits to study discreteness effects in the linear regime of the simulations . </S>",
    "<S> we show finally some work in progress about quantifying discreteness effects in the non - perturbative ( highly non - linear ) regime of cosmological n - body simulations by evolving different discretizations of the same continuous density field .    </S>",
    "<S> n - body simulations , fluid theory , linearized gravity , discreteness effects . </S>"
  ]
}