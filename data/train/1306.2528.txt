{
  "article_text": [
    "the understanding of granular dynamics is taking an increasingly prominent place in the field of planetary science .",
    "indeed , we now know that granular material , in the form of regolith , is covering the uppermost layer of most solid bodies in our solar system , from planets and their satellites to asteroids and comets .",
    "this presence of a regolith layer plays a particularly important role in the surface geology of asteroids .",
    "the same can be stated , although to a lesser extent , for bodies like mars and the moon , whose surface gravities are also smaller than that of earth .",
    "thus , flows of granular materials driven by different gravitational conditions are particularly important in the understanding of the geology of small bodies and planets .",
    "the exploration of the moon and mars in the next two decades will require deployment of landing vehicles on surfaces of loose granular material .",
    "space missions to small bodies also involve measurements by landers ( e.g. , the rosetta space mission of the european space agency ) and sampling devices capable of coping with a wide range of surface properties .",
    "therefore , understanding how granular materials , as a function of their properties ( angle of friction , size distribution of their components , etc . ) , react to different kinds of stresses is of great interest for the design of landers and sampling devices of space missions .",
    "the same holds true in the framework of mitigation strategies against a potential impactor , which involve an interaction with the body s surface .",
    "the presence or relative absence of gravitational acceleration on granular flow is of importance for understanding the geology of small bodies and planets , and to clarify the environments that may be encountered during planetary exploration .",
    "bodies with low surface gravity can be very sensitive to processes that appear irrelevant in the case of larger planetary bodies .",
    "for instance , seismic vibration induced by small impacts can occur throughout a small body and can be at the origin of motion of its granular surface . such a mechanism has been proposed to explain the lack of very small craters on both asteroid 433 eros ( richardson et al .  2004 ) and asteroid 25143 itokawa ( michel et al .",
    "shaking can also drive size sorting / segregation in granular media .",
    "this has been observed on earth ( rosato et al .",
    "1987 ) , as well as on eros ( robinson et al .  2002 ) and itokawa ( miyamoto et al .",
    "in particular , on asteroid itokawa it has been observed that the neck is formed mainly by centimeter or smaller - sized regolith but that both the head and body are covered by meter - scale boulders .",
    "this finding has led some to suggest that subsequent impacts on an asteroid could provide the energy and driving mechanism for segregation to occur ( asphaug et al .",
    "2001 , miwa et al .",
    "2008 ) , leading to a phenomenon commonly called the `` brazil - nut effect . '' however , it was then found for itokawa that an erosion mechanism was not sufficient to explain the selective location of coarse material in the potential lows and highs , and that other factors , such as cohesion , rotation , or avalanches may be involved ( sanchez et al .",
    "in fact , rotational spin - up of a small body as a result of the thermal yorp effect can lead to regolith motion on the surface ( scheeres et al .",
    "2007 ) , and even to the escape of material that can eventually result in the formation of a satellite ( walsh et al .  2008 ) .",
    "all these aspects demonstrate the great importance of understanding the dynamics of granular matter for planetary science applications .",
    "the study of granular dynamics requires dealing with complex mechanical processes and currently constitutes an entire field of research by itself . as examples of the complexity , it has been found that granular matter may strengthen under a variety of conditions , for instance as a result of a slow shift in the particle arrangement under shear stress or because of humidity ( losert et al .",
    "moreover , while granular materials are a discrete medium , their flow in response to stress can , under certain conditions , be described by continuum models ( savage 1998 ; goddard 1990 ; losert et al .",
    "however , many processes can not be captured using classical continuum approaches .",
    "for example , highly stressed granular materials exhibit shear localization during failure ( mueth et al .",
    "2000 ) but this localization can not be described accurately by existing continuum models ( kamrin et al .",
    "in addition , situations have been identified in which material under shear stress weakens when the shear direction is changed / reversed ( toiya et al .",
    "2004 ; falk et al .",
    "finally , at low gravity , other physical forces relevant to regolith in the asteroid environment , such as van der waals forces , may exceed the particle weights and require consideration ( scheeres et al .",
    "2010 ) .",
    "improving our understanding of the dynamics of granular materials under a wide variety of conditions requires that both experimental and numerical work be performed and compared .",
    "once numerical approaches have been validated by successful comparison with experiments , then they can cover a parameter space that is too wide for or unreachable by laboratory experiments .",
    "there are several different approaches that have been used to perform modeling of granular materials ( mehta 2007 ) .",
    "one commonly used technique is the discrete element method ( dem ) .",
    "dem is a numerical method for computing the motion of a large number of particles of micron - scale size and above . though dem is very closely related to molecular dynamics ( in which atoms and molecules are allowed to interact for a period of time by approximations of known physics ) , the method is generally distinguished by its inclusion of rotational degrees of freedom , inelastic collisions , and often - complicated geometries ( including polyhedra ; e.g. , cleary and sawley 2002 ; fraige et al .",
    "2008 ; latham et al .  2008",
    "; szarf et al .",
    "2010 ) .",
    "however , the dem method remains relatively computationally intensive , which limits either the length of a simulation or the number of particles .",
    "several dem codes , and related molecular dynamics codes , take advantage of parallel processing capabilities to scale up the number of particles or length of the simulation ( e.g. , cleary and sawley 2002 ; kacianauskas et al .",
    "2008 ) .",
    "hard - sphere particle dynamics have been used successfully in many granular physics applications .",
    "hong and mclennan ( 1992 ) used hard - sphere molecular dynamics to study particles flowing through a hole in a two - dimensional box under the influence of gravity .",
    "huilin et al .  (",
    "2007 ) used an eulerian - lagrangian approach coupled with a discrete hard - sphere model to obtain details of particle collision information in a fluidized bed of granular material .",
    "also kosinski and hoffman ( 2009 ) compared the standard hard - sphere method including walls to a hard - sphere model with walls that also accounts for particle adhesion .",
    "the van der waals type interaction is presented as a demonstration case .",
    "an alternative to treating all particles separately is to average the physics across many particles and thereby treat the material as a continuum . in the case of solid - like granular behavior",
    ", the continuum approach usually treats the material as elastic or elasto - plastic and models it with the finite element method or a mesh - free method ( e.g. , elaskar et al .",
    "2000 ; also see holsapple 2001 and 2004 , holsapple and michel 2006 and 2008 , and sharma et al .  2006 and 2009 for use of analytical and continuum approaches in modeling asteroid shapes ) . in the case of liquid - like or gas - like granular flow",
    ", the continuum approach may treat the material as a fluid and use computational fluid dynamics .",
    "however , as explained previously , the homogenization of the granular - scale physics is not necessarily appropriate , and the discreteness of the particles and the forces between particles ( and walls ) need to be taken into account ( wada et al .",
    ". therefore limits of such homogenization must be considered carefully before attempting to use a continuum approach .",
    "recently , numerical codes have been developed to address specifically the dynamics of granular materials in the framework of planetary science .",
    "for instance , sanchez et al .  (",
    "2010 ) simulated the particles forming an asteroid by means of soft - sphere molecular dynamics . in this approach ,",
    "particles forming the aggregate have short- and long - range interactions , for contact and gravitational forces respectively , which are taken into account using two types of potentials ( see sanchez et al .",
    "2010 for details ) .    in this paper",
    ", we present our method to simulate the dynamics of granular materials , along with a few basic tests that show its ability to address different problems involving these dynamics . a more complete validation by comparison with a well - documented laboratory experiment of seismic shaking is the subject of a follow - up paper ( murdoch et al .",
    "2011 , in preparation ) .",
    "we use the @xmath0-body code ` pkdgrav ` ( stadel 2001 ) , adapted for hard - body collisions ( richardson et al .  2000 ;",
    "richardson et al .  2009 ) .",
    "the granular material is therefore represented by hard spheres that interact via impulsive , point - contact forces . advantages of ` pkdgrav ` over other many discrete element approaches include full support for parallel computation , the use of hierarchical tree methods to rapidly compute long - range interparticle forces ( namely gravity , when included ) and to locate nearest neighbors ( for short - range hookes - law type forces ) and potential colliders , and options for particle bonding to make irregular shapes that are subjet to euler s laws of rigid - body rotation with non - central impacts ( cf .",
    "richardson et al .  2009 ) .",
    "in addition , collisions are determined prior to advancing particle positions , insuring that no collisions are missed and that collision circumstances are computed exactly ( in general , to within the accuracy of the integration ) , which is a particular advantage when particles are moving rapidly .",
    "here we focus on the implementation of a wide range of boundary conditions ( `` walls '' ) that can be used to represent the different geometries involved in experimental setups , but more generally provide the needed particle confinement and possible external forcings , such as induced vibrations , for small - scale investigations of regolith dynamics in varying gravitational environments ( different surface slopes , etc . ) .",
    "our approach is designed to be general and flexible : any number of walls can be combined in arbitrary ways to match the desired configuration without changing any code , whereas many existing methods are tailored for a specific geometry . the long - term goal is to understand how scaling laws , different flow regimes , segregation , and so on change with gravity , and to apply this understanding to asteroid surfaces , without the need to simulate the surfaces in their entirety .",
    "we present the full detail of our numerical method in section [ s : method ] , describe basic tests of the method in section [ s : tests ] , and offer discussion and conclusions in section [ s : disc ] and section [ s : concl ] , respectively .",
    "this section details the numerical method employed in our granular dynamics simulations .",
    "we use ` pkdgrav ` , a parallel @xmath0-body tree code ( stadel 2001 ) that has been adapted for hard - body collisions ( richardson et al .  2000 ; richardson et al .",
    "2009 ) . in what follows we present the general strategy of searching for and resolving collisions among particles , and between particles and the `` walls '' of the simulated apparatus .",
    "this is followed by detailed derivations of the collision equations for the four wall `` primitives '' that we have developed so far , namely the infinite plane , finite disk , infinite cylinder , and finite cylinder , plus degenerate cases of these .      in our approach",
    ", we predict when collisions will occur based on trajectory extrapolation at the beginning of each integration step .",
    "we use a second - order leapfrog integrator in ` pkdgrav ` : each step consists of `` kicking '' particle velocities by a half step ( keeping particle positions fixed ) , `` drifting '' particle positions at constant velocity for a full step , recomputing accelerations due to gravity , then performing a final half - step velocity kick ( see richardson et al .",
    "2009 for details ) .",
    "collision searches are performed during the drift step by examining the trajectories of enough neighbors of each particle to ensure no collisions are missed . since there is no interparticle gravity for the granular dynamics experiments discussed here ( only a configurable uniform gravity field ) , the equations of motion are particularly simple , but we nonetheless use the full machinery of the @xmath0-body code for these simulations  the tree is still used to speed up neighbor searches , and parallelism reduces computation time for large simulations .",
    "also , more complex gravity fields for which there is no analytical solution for particle motion will be used in the future .    the condition for two particles with initial vector positions @xmath1 and @xmath2 and velocities @xmath3 and @xmath4 to collide after a time interval @xmath5 ( measured from the start of the drift step in this case ) is @xmath6 where @xmath7 and @xmath8 are the radii of the particles ( treated as perfect hard spheres ) , or @xmath9 where we have introduced the relative position @xmath10 and velocity @xmath11 ( fig .",
    "[ f : spheres.pptx ] ) . to collide ,",
    "the particles must be approaching one another , so @xmath12 .",
    "we assume the particles are not initially touching or overlapping , i.e. , we require @xmath13 , where @xmath14 .",
    "equation ( [ e : sphcol ] ) can be solved for @xmath5 by squaring both sides and applying the quadratic formula : @xmath15        \\nu^2}}{\\nu^2 } , \\label{e : twoparticles}\\ ] ] where @xmath16 and the sign ambiguity is resolved by taking @xmath5 to be the smallest positive value of any real roots .",
    "if @xmath5 is between zero and the drift step time interval ( i.e. , the simulation time step ) , the collision takes place during this integration step .",
    "collisions are treated as instantaneous events with no flexing and a configurable amount of energy loss due to restitution ( parameterized by the normal coefficient of restitution @xmath17 , where 0 means perfect sticking and 1 means perfect bouncing ) and surface coupling ( parameterized by the transverse coefficient of restitution @xmath18 , where @xmath19 means reversal of transverse motion on contact , 0 means complete damping of transverse motion , and 1 means no surface coupling ) . for completeness , the collision resolution equations for perfect spheres are ( richardson et al .",
    "2009 , appendix b ; also see richardson 1994 , fig .",
    "1 ) : @xmath20 , \\\\    { \\mathbf{v}}_2^\\prime & = & { \\mathbf{v}}_2 - \\frac{m_1}{m } \\left [ ( 1 +      \\varepsilon_n ) { \\mathbf{u}}_n + \\frac{2}{7 } ( 1 - \\varepsilon_t )      { \\mathbf{u}}_t \\right ] , \\\\    { \\mbox{\\boldmath $ \\omega$}}_1^\\prime & = & { \\mbox{\\boldmath $ \\omega$}}_1 + \\frac{2}{7 }    \\frac{\\mu ( 1 - \\varepsilon_t)}{i_1 } ( { \\mathbf{s}}_1 { { \\mbox{\\boldmath $ \\times$}}}{\\mathbf{u } } ) ,    \\\\    { \\mbox{\\boldmath $ \\omega$}}_2^\\prime & = & { \\mbox{\\boldmath $ \\omega$}}_2 - \\frac{2}{7 }    \\frac{\\mu ( 1 - \\varepsilon_t)}{i_2 } ( { \\mathbf{s}}_2 { { \\mbox{\\boldmath $ \\times$}}}{\\mathbf{u } } ) , \\end{aligned}\\ ] ] where the primes denote post - collision quantities , @xmath21 is the sum of the particle masses , @xmath22 is the total relative velocity at the contact point ( with @xmath23 , @xmath24 , where @xmath25 is the spin vector of particle @xmath26 , @xmath27 , and @xmath28 ) , @xmath29 , @xmath30 , @xmath31 is the reduced mass @xmath32 , and @xmath33 is the moment of inertia of particle @xmath26 ; the factors of 2/7 result from using spheres .",
    "these equations come from conservation of linear and angular momentum combined with the following statement of energy loss : @xmath34    [ figure [ f : spheres.pptx ] goes here ]    the approach for handling wall collisions is similar : first the time to collision is determined , then the collision is resolved .",
    "the collision condition is that the distance of the particle center from the point of contact on the wall must equal the particle radius , i.e. , @xmath35 where @xmath36 is the vector position of the point of contact and we have dropped the subscript @xmath26 .",
    "( for the derivations that follow , we have adopted the convention that the wall corresponds to @xmath37 and the particle to @xmath38 ; this minimizes the number of minus signs in the equations . ) because @xmath36 depends on the particular wall geometry , it is best to consider each geometry in turn and exploit any symmetries to determine more conveniently when ( if at all ) this contact condition is satisfied for a given particle and wall pair . note that often a wall consists of a combination of more than one geometry ( for example , a finite disk is a round portion of a plane plus a surrounding ring , i.e. , a cylinder of zero length)the collision prediction routines for walls in ` pkdgrav ` return a list of possible collision times , one for each `` face '' ( for the finite disk example , there are 3 faces : one flat side , the opposite flat side , and the perimeter ring ) , with the smallest positive time corresponding to the face that will be struck first .    in `",
    "pkdgrav ` , after all neighbors of a given particle have been checked for possible collisions , every wall is checked also . whatever body ( whether particle or wall ) that gives the shortest time to collision is taken to be the next collision event .",
    "that collision is resolved , collision times are updated depending on whether the collision that just happened changes future collision circumstances , and the next collision is carried out until all collisions during the current drift interval have been handled .",
    "walls are treated as having infinite mass , so the restitution equations reduce to : @xmath39 where @xmath40 ( for a static wall ) , @xmath41 and @xmath42 are specific to the wall ( see below ) , and @xmath43 , with @xmath44 being the unit vector in direction @xmath45 , i.e. , from the point of contact ( which depends on the wall geometry ) to the particle center . to account for any wall motion , @xmath46 in eq .",
    "( [ e : staticwall ] ) is adjusted as needed ( see below ) .",
    "the parameters of each wall type are specified by the user at run time via a simple text file .",
    "information common to each wall that must be specified includes the origin ( a vector reference point ) , orientation ( a unit vector ) , @xmath41 and @xmath42 for the wall ( which override the particle values during a particle - wall collision ) , and color and transparency ( for drawing purposes ) .",
    "in addition , each geometry has a unique set of parameters particular to that geometry , e.g. , radius in the case of the finite disk and cylinders , and length for the finite cylinder .",
    "also , simple motions are supported for each geometry ; e.g. , a plane or disk can have translational and/or sinusoidal oscillatory motion , while a cylinder can rotate around its symmetry ( orientation ) axis .",
    "oscillations are treated by updating the wall position in stepwise fashion , holding the velocity constant between timesteps . in ` pkdgrav ` , a single function is used to get the position and velocity of a particle relative to any ( possibly moving ) wall at a given time .",
    "finally , a wall can be `` sticky , '' meaning any particles that come into contact with it become rigidly held , or `` absorbing , '' meaning any particles that come into contact with it are removed from the simulation .",
    "these latter options are encoded as special cases of the wall normal coefficient of restitution ( 0 indicating sticky , @xmath47 indicating absorbing ) .",
    "the sticky wall is particularly useful for creating a rough surface ( cf .",
    "section [ s : tumbler ] ) ; the absorbing wall is helpful when particles are no longer needed , such as when they have moved beyond the flow regime of interest .    for a particle hitting another particle that is rigidly stuck to a wall , eqs .",
    "( [ e : wallbounce1 ] ) and ( [ e : wallbounce2 ] ) also apply when resolving the collision ( the stuck particle is treated as having infinite mass ) , with @xmath44 pointing from the center of the stuck particle to the center of the free particle , and @xmath41 and @xmath42 being the usual particle values ( i.e. , not the values specific to the wall ) .",
    "detection of collisions with stuck particles is handled by setting the stuck particles velocities equal to the instantaneous velocities of their host walls at the start of the step . in the case of particles stuck on rotating cylinders ,",
    "the component @xmath48 $ ] is added to the particle velocities , where @xmath49 is the cylinder s rotation vector and @xmath50 is its radius , and in this case @xmath44 is the perpendicular from the cylinder rotation axis to the particle center at the start of the step ( the sign of @xmath51 depends on whether the particle is on the outer [ positive ] or inner [ negative ] surface ) .",
    "the positions of particles stuck on moving / rotating walls are updated at the end of the drift step .",
    "collisions with particles stuck on rotating cylinders can optionally be predicted to higher order using a quartic expression that accounts for the curvilinear motion ( cf .",
    "richardson et al .  2009 , eq .",
    "( a.4 ) ) .    for resolving collisions with moving walls , and particles stuck to moving walls , each wall s instantaneous velocity at the start of the step",
    "is substracted from @xmath46 in eq .",
    "( [ e : staticwall ] ) before applying eqs .",
    "( [ e : wallbounce1 ] ) and ( [ e : wallbounce2 ] ) . for cylinder rotation , with the rotation axis parallel to the symmetry axis of the cylinder , @xmath52",
    "is subtracted , where @xmath44 is as defined for those equations . for particles stuck to rotating walls",
    ", the stuck particle itself is given an extra speed component ( see above ) , which is taken into account when resolving the collision outcome .",
    "the following sections detail the implementation of the supported wall geometries in ` pkdgrav ` .",
    "the parameters for the infinite plane are the origin @xmath53 and normal @xmath54 , plus optional velocity @xmath55 , oscillation amplitude @xmath56 , and oscillation angular frequency @xmath57 ( so the relative vector displacement after time @xmath58 due to oscillation , measured from the start of the simulation and evaluated at the start of the step , is @xmath59 ) . the origin can be any point in the plane ( the choice is arbitrary ) .",
    "to simplify the equations in this and subsequent derivations , we define the relative position vector @xmath60 and separate it into perpendicular and parallel components , @xmath61 and @xmath62 , respectively , where @xmath63 , @xmath64 , and @xmath65 ( so @xmath66 , which is only defined if @xmath67 and means @xmath68 generally has a time dependence ; for completeness , we also define @xmath69 ) .",
    "it is important to note that @xmath70 and @xmath71 are _ signed _ quantities ( vector components ) , unlike @xmath72 defined previously , which is an unsigned magnitude .",
    "we similarly define the relative velocity @xmath73 , with corresponding perpendicular and parallel components .    returning to the specific case of the infinite plane ,",
    "the collision condition is @xmath74 , i.e. , that the perpendicular distance from the particle center to the surface ( the height above or below the plane ) at the time of impact is equal to the particle radius ( fig .  [",
    "f : plane.pptx ] ) . for this geometry , and measured from the start of the drift step , the time to impact is @xmath75 where the first condition corresponds to impact with the `` upper '' face ( the surface out of which the normal vector @xmath54 points ) and the second corresponds to the opposite `` lower '' face .",
    "( we take this two - case approach to avoid having to solve a quadratic ; cf .",
    "section [ s : infinitecylinder ] . )",
    "note @xmath76 is a requirement for collision ( otherwise the particle is moving away from or parallel to the plane ) . for completeness , the wall position at the start of the step is @xmath77 , where @xmath78 is the origin at the start of the simulation , and the wall velocity is @xmath79 .",
    "[ figure [ f : plane.pptx ] goes here ]    to resolve the collision , eqs .",
    "( [ e : wallbounce1 ] ) and ( [ e : wallbounce2 ] ) apply , with @xmath44 being either @xmath54 or @xmath80 , depending on which face was struck ; specifically , @xmath81 { { \\mathbf{\\hat{n}}}}$ ] .",
    "this geometry uses the same parameters as the infinite plane ( fig .  [",
    "f : plane.pptx ] ) but now includes the finite radius @xmath50 of the object . the origin @xmath53 is the geometric center of the disk .",
    "collision prediction proceeds in 3 stages : first , eq .",
    "( [ e : planeimpact ] ) is used to determine the impact time ( if any ) with the infinite plane that contains the disk ( i.e. , taking @xmath82 ) ; second , the position the particle would have relative to the ( possibly moving ) disk at that impact time is checked to determine whether @xmath83 , i.e. , that the separation of the particle center from the disk origin , projected onto the plane , would be less than the disk radius , indicating actual contact with the flat surface of the finite disk ; third , the impact time ( if any ) with the disk perimeter , i.e. , a ring , is checked ( see section [ s : ring])the smallest positive time for impact with both faces and the perimeter is taken to be the next impact time with this object .",
    "collision resolution is the same as for the infinite plane , unless the particle has made contact with the perimeter , in which case the collision is treated as a ring bounce ( section [ s : ring ] ) .",
    "the parameters for the infinite cylinder are the origin @xmath53 , symmetry - axis orientation @xmath54 , radius @xmath50 , and optional angular frequency @xmath57 ( with @xmath54 as the spin axis ) .",
    "the origin is any point along the symmetry axis . in the current implementation ,",
    "cylinders are fixed in space , and since the rotation does nt change the orientation ( it only affects the tangential motion and spin of particles that come into contact with the cylinder , assuming @xmath84 ) , @xmath53 is constant ( so @xmath85 ) .",
    "the collision condition is @xmath86 , i.e. , the perpendicular distance from the particle center to the cylinder wall is equal to the particle radius .",
    "note that particles can either be inside ( assuming @xmath87 ) or outside the cylinder ; each face is considered in turn .",
    "figure [ f : cylinder.pptx ] illustrates the geometry .",
    "[ figure [ f : cylinder.pptx ] goes here ]    to find the collision time ( if any ) , note @xmath88 , where recall @xmath89 , @xmath90 in this case , and @xmath5 is the impact time measured from the start of the drift step . substituting into the collision condition equation , @xmath91",
    "taking the square , @xmath92 this is a quadratic equation for @xmath5 and can be solved in the usual way . for completeness ,",
    "@xmath93}}{\\nu_t^2 }    .",
    "\\label{e : cylinderimpact}\\ ] ] note there are _ four _ solutions , two each for impacts with the inner face ( corresponding to @xmath94 on the right - hand side of eq .",
    "( [ e : cylinder ] ) ) and outer face ( @xmath95 ) .",
    "again , for each face , the smallest positive ( real ) value for @xmath5 is chosen .",
    "if @xmath96 , there will be no impact ( the particle is either stationary with respect to the cylinder , or moving parallel to the cylinder s symmetry axis ) . if the particle is outside the cylinder ( so @xmath97 ) , a collision can only occur if @xmath98 ; for an infinite cylinder , the collision can only be with the outer face .",
    "if the particle is inside the cylinder ( so @xmath99 ) , all solutions are real ( i.e. , there must be a collision , assuming @xmath100 ) ; furthermore , only collisions with the inner face are possible ( even in the case of a finite cylinder ) .",
    "together these facts can be used to reduce the computation time involved with this geometry .",
    "note however , unlike other collision circumstances handled by ` pkdgrav ` , in the case of an interior bounce involving a cylinder ( or a ring ) , it is possible for the particle to hit the same object two or more times in one integration step without an intervening collision with another object .    to resolve the collision , eqs .",
    "( [ e : wallbounce1 ] ) and ( [ e : wallbounce2 ] ) apply , with @xmath44 being either @xmath101 , if the outer face was struck ( requiring @xmath102 ) , or @xmath103 , if the inner face was struck ( requiring @xmath104 ) .",
    "recall a cylinder can be spinning , in which case @xmath105 is subtracted from the total relative velocity @xmath46 in eq .",
    "( [ e : staticwall ] ) before applying the collision equations .",
    "this geometry uses the same parameters as the infinite cylinder , but now includes the finite length @xmath106 of the object .",
    "the origin @xmath53 is the geometric center of the cylinder . in a manner similar to the finite disk case ( section [ s : finitedisk ] ) , collision prediction proceeds in 3 stages : first , eq .  (",
    "[ e : cylinderimpact ] ) is used to determine the impact time ( if any ) with the infinite counterpart to the cylinder ( i.e. , taking @xmath107 ) ; second , the position the particle would have relative to the cylinder at that impact time is checked to determine whether @xmath108 , i.e. , that the separation of the particle center from the cylinder origin , projected onto the cylinder s orientation axis , would be less than half the cylinder length , indicating actual contact with the surface of the finite object ( not the ends ) ; third , the impact times ( if any ) with the cylinder ends are checked ( see section [ s : ring])the smallest positive time for impact with both faces and the cylinder ends is taken to be the next impact time with this object .",
    "three special cases for this geometry are supported : @xmath109 is a ring ( section [ s : ring ] ) ; @xmath110 is a line ( so there is no inner surface ) ; and @xmath111 is a point , which is treated as a special case of an infinitesimal ring .",
    "collision resolution is the same as for the infinite cylinder , unless the particle has made contact with either end , in which case the collision is treated as a ring bounce ( section [ s : ring ] ) .",
    "this is a special degenerate case of a zero - length cylinder , but it is also needed for both the perimeter of a finite disk and the ends of a finite cylinder .",
    "the parameters are inherited from whatever base type needs to consider ring collisions , i.e. , in addition to the origin @xmath53 and orientation @xmath54 , the parameters are the radius @xmath50 of either the finite disk or the finite cylinder , and either @xmath55 , @xmath56 , and @xmath57 for the disk or @xmath57 for the cylinder  see the corresponding sections above .    solving for the impact time of a sphere of radius @xmath51 with a thin ring",
    "is equivalent to finding the first intersection of a ray with a torus of tube radius @xmath51 , a common problem in computer ray tracing .",
    "we use the approach developed by wagner ( 2004 ) , for which the possible impact times @xmath5 are roots of the quartic equation @xmath112 where @xmath113 and @xmath114 for which @xmath115 and @xmath116 have the usual definitions ( so the ray is given by @xmath117 )",
    ". however , this derivation only applies to the special case @xmath118 and @xmath119 , i.e. , a ring centered at the origin of a cartesian coordinate system and lying in the @xmath120 plane ( so the normal is in the @xmath121 direction ) . for the general case , @xmath115 and @xmath116",
    "must first be transformed ( rotated ) into the torus frame according to @xmath122 where the primes indicate post - rotation quantities , @xmath123 and @xmath124 and @xmath125 are constructed from @xmath54 using gram - schmidt orthonormalization ( note rotation around the torus symmetry axis is unimportant , so we are free to choose any @xmath124 and @xmath125 so long as @xmath124 , @xmath125 , and @xmath54 are mutually orthogonal ) . note @xmath126 , as required .",
    "we solve the quartic using laguerre s method ( press et al .",
    "2007 ) , a root - finding scheme optimized for polynomials that does not require prior bracketing of the roots .",
    "there are several special cases that are checked for before committing to solving the quartic . in the case of @xmath110 ( a point ) ,",
    "( [ e : twoparticles ] ) applies immediately , with @xmath127 and @xmath128 . in the case of @xmath129 ( particle center on the ring symmetry axis ) and @xmath130 ( particle moving parallel to the symmetry axis ) , an arbitrary point is chosen on the ring and eq .",
    "( [ e : twoparticles ] ) is used to find the impact time . also , as usual ,",
    "if @xmath131 ( @xmath132 ) , there can be no collision .    to resolve the collision , eqs .",
    "( [ e : wallbounce1 ] ) and ( [ e : wallbounce2 ] ) apply , with @xmath133 ( so in the degenerate case of @xmath110 , i.e. , contact with a point , @xmath134 . ) for the special case of the particle center lying on the orientation axis , with @xmath135 ( indicating the particle has struck an entire end perimeter perfectly and thus @xmath101 is undefined ) , @xmath81 { { \\mathbf{\\hat{n}}}}$ ] , i.e. , the same as for a plane bounce ( section [ s : infiniteplane ] ) .",
    "the derivations above make the tacit assumption that particles are neither touching nor intersecting any geometric shapes ( including other particles ) at the start of the drift interval , i.e. , legitimate impact times @xmath5 should always be positive .",
    "unfortunately , due to finite computer precision , sometimes a particle ends up in contact with or interpenetrating another object at the start of the step , e.g. , a collision during the previous step may have been missed , or round - off error led to an overlap .",
    "the simplest fix is to allow @xmath5 to be negative ( or zero ) to correct such situations .",
    "it does , however , greatly complicate the decision logic when computing @xmath5 for the various wall geometries discussed above .",
    "as an example , in the case of the infinite plane , a particle is touching or overlapping if @xmath136 , in which case the smallest non - positive @xmath5 for impact is chosen . in practice , a modified version of eq .",
    "( [ e : planeimpact ] ) is used when computing @xmath5 : both faces are considered regardless of which side the particle center is on , allowing for the possibility of initial touching / overlap ( which is revealed by one  but not both  of the @xmath5 s being negative , or one being negative and the other being zero ) .",
    "note that it is still the case that collisions are ignored if @xmath137 or @xmath138 , regardless of whether the particle is touching or overlapping the surface  generally overlaps are a tiny fraction of the particle radius , whereas the condition @xmath139 with @xmath140 implies the particle has penetrated more than a full radius .    in the interest of brevity , we do not provide exhaustive case - by - case touching / overlap remedies for all geometries here .",
    "it is sufficient to note that overlaps do happen , particularly in close - packed situations where a great many collisions can occur during a single timestep , but the errors are typically very small ( many orders of magnitude smaller than the particle radius ) and can be corrected by allowing @xmath5 to be negative ( or zero ) .",
    "the test suite described in section [ s : tests ] was designed to stress the code and shows that any overlap artifacts encountered are negligible . `",
    "pkdgrav ` incorporates other overlap strategies for situations involving interparticle gravity and/or more complex aggregated particle shapes , but discussion of these strategies is beyond the scope of this paper .",
    "a suite of simple tests was developed during the coding stage to exercise each new feature / geometry as it was added .",
    "examples include dropping particles into a cylinder bisected by an inclined plane , `` rolling '' a perfectly balanced sphere on the inside edge of a vertical ring , and bouncing hundreds of spheres on an oscillating disk inside a cylinder . here",
    "we report on two tests designed to demonstrate correct dynamic behavior of the granular assembly . in the companion paper ( murdoch et al .",
    "2011 , in preparation ) , we present a detailed study of grain motions on a vibrating plate .      for this test , a ball of approximately 1,000 close - packed particles is dropped from rest into the top half of an infinitely long vertical cylinder bisected by an infinite horizontal plane .",
    "a uniform gravity field points vertically downward ( there is no interparticle gravity ) and collisions among the particles and between particles and the walls are elastic ( so there is no dissipation ) .",
    "the particles are roughly equally divided among three different masses : 1 , 3 , and 10 ( arbitrary units ; for this simulation , the cylinder radius is 1.0 , the particle radius is 0.022 for all masses , the drop height of the center of the particle ball is 1.0 , and the acceleration in the vertical @xmath141 direction is @xmath142 ; internally , the universal constant of gravitation @xmath143 ) .",
    "the expected behavior , after the transient splash , is that the particles achieve energy equipartition , with the smallest - mass particles reaching a scale height 3 times higher than that of the medium - mass particles and about 10 times higher than that of the most massive particles .",
    "figure [ f : atmossnaps.pptx ] shows ray - traced snapshots of the system , from the initial condition to the final equilibrium state .",
    "figure [ f : atmosevol ] shows the evolution of the mean heights of the three particle mass populations .",
    "the `` height '' of a particle is the distance separating its bottom surface from the plane , i.e. , the @xmath141 coordinate of its center minus its radius , with the horizontal plane located at @xmath144 .",
    "our hypothesis is that the height @xmath141 of a particle with mass @xmath145 is drawn from a probability distribution @xmath146 , where @xmath147 is the scale height associated with particles of mass @xmath145 .",
    "the best estimate of @xmath147 for our model ( for a given @xmath145 ) is found by maximizing the likelihood @xmath148 substituting for our model @xmath149 , we find @xmath150 is maximized when @xmath151 , where @xmath152 is the number of particles of mass @xmath145 ; in other words , the best estimate of @xmath147 is the average height of all particles with that mass .",
    "this is what is shown in fig .",
    "[ f : atmosevol ] ( solid lines ) .",
    "the measured scale heights show the expected inverse proportionality with mass , but exhibit some fluctuations .",
    "in fact , a perfect match to the model is not expected due to finite - size effects : in the limit of large particle sizes compared to the cylinder diameter , the bottom layers may become fully occupied , which is not predicted by the functional form of @xmath149 used here . to test this ,",
    "a few runs varying the cylinder - to - particle diameter ratio were carried out and showed larger discrepancies from the ideal scale height ratios for smaller diameter ratios .",
    "[ figure [ f : atmossnaps.pptx ] goes here ]    [ figure [ f : atmosevol ] goes here ]    we also performed kolmogorov - smirnov ( k - s ) tests to compare the height data with the expected distributions @xmath153 .",
    "figure [ f : kstest ] shows the k - s curves ( solid lines ) for the final snapshot in fig .",
    "[ f : atmossnaps.pptx ] compared to the normalized cumulative probability distributions @xmath154 ( dotted lines ) , where @xmath155 and @xmath156 is the largest value of @xmath141 ( among particles of mass @xmath145 ) for this snapshot .",
    "the normalization ensures the cumulative probability distribution has a value of unity at @xmath157 ( each curve has a different @xmath156 , but the k - s statistic is insensitive to scaling of the independent variable , which is why there are no tick marks on the horizontal axis of fig .",
    "[ f : kstest ] ) .",
    "for this particular snapshot , which represents an arbitrary instant after equilibrium has been reached , we find k - s probabilities of 0.89 , 0.08 , and 0.70 , corresponding to masses 1 , 3 , and 10 , meaning we can not reject the null hypothesis that the data is drawn from @xmath149 at those confidence levels . for the middle mass ,",
    "this is not very convincing , but we find there is significant variation between snapshots . taking the average probabilities from 50% , 60% , 70% , 80% , 90% , and 100% of the way through the simulation , we find mean k - s probabilities of @xmath158 , @xmath159 , and @xmath160 ( the errorbars denote 1 standard deviation from the mean ) . moreover , if we repeat the analysis for a cylinder that is half as wide , the probabilities drop to @xmath161 , @xmath162 , and @xmath163 .",
    "we must caution that because the mean and maximum @xmath141 values measured from the data were used in the model for the k - s test , the distribution of the k - s statistic may not be fully consistent with the formula used to compute the null hypothesis probability ( cf .",
    "press et al .",
    "2007 ) . repeating the analysis using the _ expected _ values of @xmath147",
    "( see below ) , the mean k - s probabilities for the radius 1.0 cylinder do not change significantly .",
    "regardless , there is no way to avoid using @xmath156 to insure the cumulative probability is normalized , so the k - s test probabilities must be considered formal values only .",
    "[ figure [ f : kstest ] goes here ]    finally , we can apply the principles of hydrostatic equilibrium and the energy equipartition theorem to derive the expected scale heights @xmath147 and compare these with the measured values for each mass population . treating the particles as an ideal gas at constant temperature @xmath58 ( an ideal isothermal atmosphere ) ,",
    "the number density @xmath164 of particles is proportional to the pressure @xmath165 . in hydrostatic equilibrium , @xmath166 where @xmath167 and @xmath168 is the ( assumed constant ) gravitational acceleration . substituting @xmath169 from the ideal gas law , where @xmath170 is the boltzmann constant , and integrating",
    ", we find @xmath171 which , since @xmath165 is proportional to @xmath72 , gives the desired scale height @xmath172 now , the total energy of the system , which remained constant to better than 1 part in @xmath173 for the duration of all the model atmosphere tests we performed ( the starting value was @xmath174 in system units ) , should be roughly equally divided among the particles once equilibrium is achieved .",
    "the energy of a given particle in our system is @xmath175 where @xmath176 is the particle speed . applying the equipartition theorem , which states in part that for each degree of freedom @xmath177 that contributes @xmath178 to the energy , the average energy corresponding to that degree of freedom at thermal equilibrium is @xmath179 , the average energy per particle is @xmath180 ( recall @xmath176 incorporates three degrees of freedom , one for each component of the velocity vector in three dimensions ) . equating this to the total energy divided by the number of particles ( exactly 991 in our simulation ) , solving for @xmath181 and substituting into eq .",
    "( [ e : scaleheight ] ) , we get expected @xmath147 values of 1.88 , 0.626 , and 0.188 for our particle masses of 1 , 3 , and 10 , respectively ( notice these are in the correct 10:3:1 ratio ; the values are shown as the dotted lines in fig .",
    "[ f : atmosevol ] ) .",
    "averaging as we did previously for the k - s probabilities , we find measured @xmath147 values of @xmath182 , @xmath183 , and @xmath184 ( cf .",
    "[ f : atmosevol ] ) , in quite good agreement . for the simulation where the radius is halved ,",
    "the values are @xmath185 , @xmath186 , and @xmath187 , in worse agreement , as might be expected due to the greater severity of the finite - size effect .    in summary , we find that this test of the integrator with particle and wall bouncing gives results consistent with what would be expected in a real system .",
    "brucks et al .",
    "( 2007 ) carried out a series of laboratory experiments to measure the dynamic angle of repose @xmath188 of glass beads in a rotating drum ( tumbler ) at various effective gravitational accelerations .",
    "the beads had _ diameter _ ( not radius ) @xmath189 mm and occupied about 50% of the volume of a tumbler of radius @xmath50 = 30 mm and length @xmath106 = 5 mm . a tumbler with @xmath50",
    "= 45 mm was also used , but we restrict our comparison to the smaller one for this test .",
    "the inner wall of the cylinder was lined with sandpaper to provide a rough surface .",
    "a centrifuge was used to provide effective gravitational accelerations between 1 and 25 @xmath168 ( where @xmath168 = 9.81 m s@xmath190 is earth - norm gravity ) .",
    "the angular rotation speed of the tumbler @xmath57 was varied to achieve a range of froude numbers ( `` fr '' ) for the system , where fr is defined as the ratio of centripetal to effective gravitational acceleration at the cylinder periphery : ) is found in the literature , i.e. , @xmath191 ; we use the expression in eq .",
    "( [ e : froude ] ) to compare our results more easily with brucks et al .",
    "( 2007 ) . ]",
    "@xmath192    figure 3 of brucks et al .",
    "( 2007 ) shows @xmath188 as a function of fr for various @xmath193 obtained in their experiment .",
    "our aim for this test was to compare simulated results for @xmath194 and @xmath195 .",
    "smaller fr numbers are computationally challenging due to the limited motion of the particles ( but the @xmath188 curve is essentially flat for fr @xmath196 0.01 anyway ) .",
    "different @xmath193 , particularly @xmath197 ( a regime brucks et al .",
    "2007 could not explore ) , will be the subject of future work .",
    "we constructed the simulated experimental apparatus using an infinite horizontal cylinder of radius @xmath50 ( 30 mm ) cut into a short segment by two infinite vertical planes separated by a distance @xmath106 ( 5 mm ) .",
    "for the purpose of this test , the planes were `` frictionless '' ( @xmath198 ) . to keep the tests tractable , a fixed particle _",
    "radius _ of @xmath199 mm was used , i.e. , twice the size of the glass beads used in the experiment ( thereby providing nearly a factor of 10 savings in particle number , so each run would take of order a day , instead of more than a week ) .",
    "the initial conditions were prepared in stages , alternately filling the `` bottom '' of the cylinder ( i.e. , by removing one plane and having gravity point down the length of the cylinder ) , closing and rotating the cylinder to allow particles to stick uniformly to the inner cylinder wall ( to mimic the roughness provided by the sandpaper in the real experiment ) , refilling to get the desired volume fraction ( about 50% ) , rotating some more , and then allowing the particles to settle .",
    "there were 6513 particles total , of which 568 ended up stuck to the cylinder wall .",
    "= 31.06 mm in radius . ]",
    "this starting condition was used for all the runs . for particle collisions , the normal coefficient of restitution @xmath200 ( an estimate for glass beads derived by heielmann et al .",
    "2009 ) and the tangential coefficient of restitution @xmath201 ( to provide some roughness ; this value is poorly constrained ) .    as an aside , initially this experiment was conducted with surface coupling ( i.e. , @xmath202 for the cylinder ) instead of sticky walls .",
    "although , for sufficiently fast cylinder spin , the particles also start to tumble in this setup , the particle spins quickly align with the cylinder spin ( so that @xmath203 , within a factor of a few ) and the particles settle to the bottom of the cylinder , sloshing around slightly . a rough surface instead provides a constant , somewhat random perturbation that ensures the tumbling behavior persists among the loose particles .",
    "figure [ f : tumbsnaps.pptx ] shows ray - traced snapshots after achieving equilibrium for 8 different froude numbers ( 0.001 , 0.01 , 0.05 , 0.1 , 0.3 , 0.5 , 1.0 , and 1.5 ) .",
    "for the sub - critical cases ( @xmath204 ) , the total simulated run time was about 2.5 s , with a fixed timestep of about 5 @xmath31s .",
    "for fr = 1.0 and 1.5 , the run time was @xmath2050.5 s with a timestep of @xmath2051 @xmath31s ( these latter cases achieve equilibrium faster , but the more rapid cylinder rotation dictated a smaller timestep ) . also shown for the sub - critical cases",
    "is the estimated slope , which was measured by fitting straight lines to sample surface points over several snapshots and taking the average .",
    "only particles to the left of center were considered for these measurements , as particles tend to pile up on the right .",
    "as expected , for fr = 1.0 , it can be seen that centrifuging has begun ; by fr = 1.5 , a thin layer of free particles persists along the inner surface of the upper - right quadrant of the cylinder . for @xmath204 ,",
    "@xmath188 depends on the rotation rate , with roughly the expected dependence from the experiments .",
    "a study by taberlet et al .  ( 2006 ) shows that the shape of the granular pile in these kinds of experiments depends on interactions with the end caps , with friction leading to `` s '' shapes and lack of friction leading to straighter slopes ( as in our case ) .",
    "they also found that larger @xmath106 ( i.e. , using a longer cylinder , for a fixed particle size ) leads to straighter slopes .",
    "testing such dependencies in our approach will be the subject of future work .",
    "[ figure [ f : tumbsnaps.pptx ] goes here ]    figure [ f : tumbplot ] shows the measured values of @xmath188 from the simulations ( filled squares ) , with 1-@xmath206 uncertainty errorbars , along with data taken from fig .  3 of brucks et al .",
    "( 2007 ) for the @xmath50 = 30 mm tumbler .",
    "the experimental data show systematically larger dynamic slopes compared with the simulated data , but both follow a similar trend with froude number",
    ". some of the discrepancy in slope may arise from the different @xmath207 ratio for the data sets , namely about 110 for the experiment while only 57 for the simulations .",
    "increasing the ratio for the simulations to match the experiments would require a factor of 8 more free particles ( as well 4 times more stuck particles ) , which was beyond the scope of these tests .",
    "we note that the @xmath50 = 45 mm tumbler used in the experiments , with @xmath208 , exhibits equilibrium dynamic slopes about 10 deg higher than for @xmath50 = 30 mm ( brucks et al .",
    "2007 , fig .  3 ) .",
    "[ figure [ f : tumbplot ] goes here ]    there are other caveats to consider as well .",
    "the simulated particles are identical in size and are perfectly spherical ; deviations from uniformity of the glass beads used in the experiments may increase the dynamic slopes ( this could also give rise to a higher slope at small froude numbers , where the experimental results did not appear to be as sensitive to @xmath207 ) . furthermore , the adopted @xmath41 and @xmath42 values for the simulations are mostly educated guesses ; more experimentation is needed .",
    "the simulation used frictionless confining planes , whereas the flat walls in the experiment were comprised of a metal plate and a glass plate , both constrained to rotate with the cylinder , and neither of which were frictionless . in the simulations ,",
    "the cylinder rotation rate was imposed instantaneously at the start , which may have caused spurious bulking as the assemblage reacted to the sudden shear stress . a better approach ( not implemented here )",
    "would be to accelerate the tumbler gradually to the desired rotation rate .",
    "a related issue is that the dynamic angle of repose may be affected by the initial packing fraction of the particles , which depends on the dominant interparticle forces . in the absence of interparticle friction ,",
    "random close packing is expected , whereas with friction , random loose packing is a more likely starting condition ( makse et al .",
    "2000 ) , and may lead to a different dynamic angle of repose .",
    "this difference was not explored here but will be part of a future investigation .",
    "finally , certain minor run parameters required to keep the simulations tractable in the particle - based , collision - prediction approach may result in excessive particle energy , leading to shallower simulated slopes ; experimentation with these thresholds is needed .",
    "the model atmosphere scenario presented in section [ s : atmos ] is an example of a dilute granular flow in which particle - particle and particle - wall interactions are dominated by near - instantaneous , inelastic , two - body collisions .",
    "our numerical approach , in the context of granular dynamics literature , can be characterized as hard - sphere dem ( see section [ s : intro ] ) , which is particularly well - suited to simulating dilute granular flows ( mehta 2007 ) . in the dilute regime , soft- and hard - particle methods should give equivalent results , but so - called event - driven simulations , in which no computations are needed between collision events , are typically much faster ( luding 2004 ) . however , within dense granular flows in which many - body interactions dominate and particles have long - lived contacts with many neighbors , it is possible that the assumptions of the event - driven and hard - sphere dem models fail ( delannay et al .",
    "2007 ) .    in a rotating tumbler ( cf .",
    "section [ s : tumbler ] ) , there exists a region of long - lived contacts but also a faster flowing layer . by varying the froude number , it is possible to investigate many different regimes , from the fast - flowing regime with a large froude number to the regime when the froude number is low and most contacts are longer - lived .",
    "thus the tumbler is an intermediate regime between dilute and dense flows , providing a convenient test of the range of applicability of our hard - sphere method .",
    "indeed , the tumbler has been studied in detail with many different numerical techniques ; we provide a brief overview in the following .",
    "mccarthy et al .",
    "( 1996 , 2000 ) and mccarthy and ottino ( 1998 ) used a soft - sphere model to compare simulations of non - cohesive granular materials in a slowly rotating drum to experimental data . in order to limit the number of particles necessary in the simulations they proposed a `` hybrid '' simulation technique .",
    "this method involves using a geometrical model to determine the bulk motion of the particles and then performing particle dynamics simulations on only the particles contained within and bordering the avalanching wedge .",
    "they found a favorable match between experiment and simulation , at low computational cost , but with the tradeoff that the method is tailored to a very specific geometry .",
    "khakhar et al .  ( 1997 ) used a similar technique to separate the granular material in the rotating drum into a `` rapid flow region '' and a `` fixed bed . '' a continuum model in which averages are taken across the layer was used to analyze behavior of the flowing layer .",
    "the motion of grains on the free surface of a granular mixture in a rotating drum was also investigated by monetti et al .",
    "( 2001 ) using monte carlo simulations of a two - dimensional lattice gas model .",
    "the model takes into account rotational frequency , frictional forces , and the gravitational field .",
    "soft - sphere methods have also repeatedly and successfully been used to describe granular material in a rotating drum ( dury et al .",
    "1998 ; dury and ristow 1999 ; rapaport 2002 ; pohlman et al .  2006 ; taberlet et al .",
    "this has also extended been to two - dimensional simulations of irregular - shaped particles by poschel and buchholtz ( 1995 ) .",
    "hard - sphere methods have not been commonly used for rotating drums , however gui and fan ( 2009 ) did perform numerical simulations of motion of rigid spherical particles within a 2-d tumbler with an inner wavelike surface .",
    "the rotation of the tumbler was simulated as a traveling sine wave around a circle .",
    "the observed behavior in our tumbler simulations shows that the code correctly models the transitions from global regimes with increasing froude number .",
    "the differences between experiment and simulation are larger at lower froude number and start to decrease at higher froude number .",
    "this suggests that our hard - sphere model is more suited to the dilute flow regimes of high froude number rather than dense flow regimes of low froude number .",
    "soft - sphere dem is typically used for dense granular flows ( zhu et al .",
    "2007 ) , as the detailed characterization of interparticle contacts is more suitable for this regime .",
    "however , hard - sphere methods can approach experimental and soft - sphere simulation results for very low friction materials .",
    "for example , pohlman et al .  (",
    "2006 ) found an angle of repose of only 16.9@xmath209 , for low friction ( @xmath210 ) chrome steel beads at a froude number of @xmath211 .",
    "this is within a few degrees of our expected results at this froude number .    in summary ,",
    "our approach currently favors dilute or fluid flows over dense granular flows , but we are in the process of implementing a soft - sphere method .",
    "whether regolith in low - gravity environments , such as the surface of an asteroid , when reacting to external stresses , is more appropriately modeled as a dilute or dense granular flow is the subject of ongoing investigation .",
    "regardless , numerical methods will play an important role in the study of these environments .",
    "we have added new features to an existing , well - tested @xmath0-body code that allow convenient modeling of granular dynamics in a variety of conditions .",
    "details of collision detection and resolution involving four principal supported wall geometries ( infinite plane , finite disk , infinite cylinder , and finite cylinder ) and associated degenerate cases ( point , line , and ring ) were provided .",
    "two dynamical test suites were presented , one for a model `` atmosphere '' showing the correct equilibrium distribution of scale heights among a polydisperse population of dissipationless balls , and the other for a tumbler that showed correct qualititative behavior as a function of surface wall properties and cylinder rotation rate .",
    "application of these new capabilities to numerical simulations designed to investigate collective grain behavior on vibrating plates will be presented in murdoch et al .",
    "( 2011 , in preparation ) .",
    "planned future code development includes adding support for rigid and semi - rigid particle aggregates ( cf .",
    "richardson et al .  2009 ) that would allow study of more complex particle shapes in simulations of granular dynamics , and implementing a soft - sphere model to better match the properties of dense granular flows .",
    "this material is based upon work supported by the national aeronautics and space administration under grant no .",
    "nnx08am39 g issued through the office of space science and by the national science foundation under grant no .",
    "kjw was supported by a poincar fellowship at observatoire de la cte dazur ( oca ) .",
    "pm and nm acknowledge financial support from the french programme national de plantologie .",
    "nm acknowledges financial support from thales alenia space and the open university .",
    "dcr thanks m. c. miller for helpful discussions .",
    "we thank dan scheeres and an anonymous reviewer for their comments and suggested improvements . some simulations in this work",
    "were performed on the crimson beowulf cluster at oca .",
    "raytracing for figs .",
    "[ f : atmossnaps.pptx ] and [ f : tumbsnaps.pptx ] was carried out using the persistence of vision raytracer .",
    "data points from fig .  3 of brucks et al .",
    "( 2007 ) were extracted using plot digitizer .",
    "2001 brazil nuts on eros : size - sorting of asteroid regolith proc .",
    "lunar sci .  conf .",
    "32 1708    2007 behavior of flowing granular materials under variable @xmath168 phys .",
    "e 75 032301 - 1032301 - 4    2002 dem modelling of industrial granular flows : 3d case studies and the effect of particle shape on hopper discharge applied mathematical modelling 26 89111    2007 towards a theoretical picture of dense granular flows down inclines nature materials 6 99108    1999 competition of mixing and segregation in rotating cylinders phys .",
    "fluids 11 13871394    1998 boundary effects on the angle of repose in rotating cylinders phys .  rev .",
    "e 57 44914497    2000 a viscoplastic approach to model the flow of granular solids international journal of solids and structures 37 21852214    falk , m.l . ,",
    "toiya , m. , losert , w. , 2008 .",
    "shear transformation zone analysis of shear reversal during granular flow .",
    "arxiv e - prints 0802.1752 .",
    "2008 distinct element modelling of cubic particle packing and flow powder technology 186 224240    1990 nonlinear elasticity and pressure - dependent wave speeds in granular media proc",
    ".  royal soc .",
    "london a430 105131    2009 numerical simulation of motion of rigid spherical particles in a rotating tumbler with an inner wavelike surface powder technology 192 234241    2009 microgravity experiments on the collisional behavior of saturnian ring particles icarus 206 424430    2001 equilibrium configurations of solid cohesionless bodies icarus 154 432448    2004 equilibrium figures of spinning bodies with self - gravity icarus 172 272303    2006 tidal disruptions : a continuum theory for solid bodies icarus 183 331348    2008 tidal disruptions .",
    "a continuum theory for solid bodies with strength , with applications to the solar system icarus 193 283301    1992 molecular dynamics simulations of hard sphere granular particles physica a : statistical mechanics and its applications 187 159171    2007 investigation of mixing / segregation of mixture particles in gas - solid fluidized beds chem .",
    "62 301317    2010 parallel discrete element simulation of poly - dispersed granular material advances in engineering software 41 5263    2007 stochastic flow rule for granular materials phys .",
    "e 75 041301    1997 transverse flow and mixing of granular material in a rotating cylinder phys .",
    "fluids 9 3143    2009 extension of the hard - sphere particle - wall collision model to account for particle deposition phys .  rev .",
    "e 79 061302    2007 three - dimensional particle shape acquisition and use of shape library for dem and fem / dem simulation minerals engineering 21 797805    2000a particle dynamics in sheared granular matter phys .",
    "85 14281431    2000b mechanisms for slow strengthening in granular materials phys .",
    "e 61 40604068    # 1 # 2 # 3 # 4 # 5 # 6 # 7 # 1 , # 2 .",
    "# 3 . in : # 4 ( eds . ) , # 5 .",
    "# 6 , pp .",
    "2004 molecular dynamics simulations of granular materials hinrichsen , h. , wolf , d.e .",
    "the physics of granular media wiley - vch , weinheim 299323 revise check end page    2000 packing of compressible granular materials phys .",
    "84 41604163    1998 particle dynamics simulation : a hybrid technique applied to granular mixing powder technology 97 9199    1996 mixing of granular materials in slowly rotated containers aiche journal 42 33513363    2000 computational studies of granular mixing powder technology 109 7282    2007 granular physics cambridge univ .",
    "press new york    2009 itokawa s cratering record as observed by hayabusa : implications for its age and collisional history icarus 200 503513    miwa , y. , yano , h. , morimoto , m. , mori , o. , kawaguchi , j. , 2008 .",
    "a study on constitution of asteroids with brazil - nut effect .",
    "26th international symposium on space technology and science 2008 , 2008-k-03 .",
    "2007 regolith migration and sorting on asteroid itokawa science 316 10111014    2001 simulations for dynamics of granular mixtures in a rotating drum granular matter 3 113116    2000 signatures of granular microstructure in dense shear flows nature 406 385389    2011 numerical simulations of granular material dynamics .",
    "ii . comparison with shaking experiments icarus    2007 numerical recipes : the art of scientific computing , third ed .",
    "cambridge univ .  press , new york    2006 surface roughness effects in granular matter : influence on angle of repose and the absence of segregation phys .",
    "e 73 031304    poschel , t. , buchholtz , v. , 1995 .",
    "complex flow of granular material in a rotating cylinder .",
    "chaos , solitons & fractals 5 , 19011905 , 1907 - 1912 .",
    "2002 simulational studies of axial granular segregation in a rotating cylinder phys .",
    "e 65 061306    1994 tree code simulations of planetary rings mon .  not .",
    "r. astron .",
    "269 493511    2000 direct large - scale @xmath0-body simulations of planetesimal dynamics icarus 143 4559    2009 numerical simulations of asteroids modeled as gravitational aggregates plan .",
    "& space sci .",
    "57 183192    2004 impact - induced seismic activity on asteroid 433 eros : a surface modification process science 306 15261529    2002 the geology of 433 eros meteorit .  planet .",
    "37 16511684    1987 why the brazil nuts are on top : size segregation of particulate matter by shaking phys .",
    "58 10381040    snchez , p. , scheeres , d.j . ,",
    "swift , m.r .",
    "impact driven size sorting in self - gravitating granular aggregates .",
    "lunar planet .",
    "abstract 1533 .",
    "1998 analyses of slow high - concentration flows of granular materials j. fluid mech .",
    "377 126    2007 the effect of yorp on itokawa icarus 188 425429    2010 scaling forces to asteroid surfaces : the role of cohesion icarus 210 968984    2006 tidal encounters of ellipsoidal granular asteroids with planets icarus 183 312330    2009 dynamical passage to approximate equilibrium shapes for spinning , gravitating rubble asteroids icarus 200 304322    2001 cosmological @xmath0-body simulations and their analysis university of washington , seattle 126    2010 polygons vs.  clumps of discs : a numerical study of the influence of grain shape on the mechanical behaviour of granular materials powder technology    2006 s shape of a granular pile in a rotating drum phys .",
    "e 73 050301(r )    2004 transient and oscillatory granular shear flow phys .",
    "93 088001    2006 numerical simulation of impact cratering on granular material icarus 180 528545    wagner , m. 2004 . ray / torus intersection .",
    "independent online publication .",
    "2008 rotational breakup as the origin of small binary asteroids nature 454 18819    2007 discrete particle simulation of particulate systems : theoretical developments chem .",
    "* figure [ f : spheres.pptx ] : *    diagram illustrating the quantities used for predicting the collision of two spheres ( cf .   eqs .",
    "( [ e : sphcolcomp])([e : twoparticles ] ) ) .",
    "although the diagram depicts a collision in two dimensions , the derivations apply to the full three - dimensional case .",
    "geometry of sphere - plane collision . here",
    "the plane is depicted as a finite , thick disk for illustration only ; in reality the plane has zero thickness and infinite extent . for simplicity ,",
    "velocity vectors are not shown .",
    "the unit vector @xmath68 is in the plane , while @xmath54 is perpendicular to it ( for clarity of presentation , the vector representing @xmath68 is given length @xmath212 , i.e. , the distance from the plane origin to the contact point ) .",
    "note @xmath213 and @xmath214 , where in this scenario @xmath70 must equal @xmath51 , the radius of the impacting sphere .",
    "the geometry is similar for a sphere - disk collision ( section [ s : finitedisk ] ) , where the disk in the figure would have radius @xmath50 but still have no thickness .",
    "geometry of sphere - cylinder collision .",
    "shown is a finite cylinder of radius @xmath50 and length @xmath106 , with origin @xmath53 at the geometric center .",
    "for an infinite cylinder , @xmath215 and @xmath53 can be anywhere along the symmetry axis . for ease of illustration , only the case of exterior impact is shown ; interior impact is similar , except @xmath44 has opposite sign .",
    "the unit vector @xmath68 is the perpendicular pointing from the cylinder axis to the point of contact , while @xmath54 points along the cylinder axis ( for clarity of presentation , the vectors representing @xmath68 and @xmath44 are given length @xmath50 and @xmath51 , respectively , where @xmath51 is the radius of the impacting sphere ) .",
    "note @xmath216 ( for exterior impact ) and @xmath217 , where in this scenario @xmath71 must equal @xmath95 ; @xmath70 is simply @xmath218 .",
    "snapshots from the model atmosphere test ( section [ s : atmos ] ) showing ( a ) the initial condition , ( b ) splash , and ( c ) final equilibrated state .",
    "the particle colors red , magenta , and blue correspond to particle masses 1 , 3 , and 10 , respectively ( particle radii are the same for all masses ) .",
    "the scale heights of the 3 populations are expected to be inversely proportional to their masses .",
    "the full vertical extent of the smallest - mass particle distribution is not shown .",
    "gravity is directed down in the figure .",
    "evolution of the mean particle heights in the model atmosphere test .",
    "the colors red ( top line ) , magenta ( middle line ) , and blue ( bottom line ) correspond to particle masses 1 , 3 , and 10 , respectively .",
    "the dotted horizontal lines are the corresponding expected scale heights assuming hydrostatic equilibrium , the ideal gas law , and energy equipartition .",
    "the timestep for these simulations was @xmath219 in system units .",
    "the snapshots of fig .",
    "[ f : atmossnaps.pptx ] correspond to timesteps 0 , 30 , and 1,000 , respectively .",
    "cumulative probability distributions for the height data ( solid lines ) and model ( dotted lines ) corresponding to the final snapshot in fig .",
    "[ f : atmossnaps.pptx ] .",
    "the colors red ( middle lines at small @xmath141 ) , magenta ( bottom lines at small @xmath141 ) , and blue ( top lines ) correspond to particle masses 1 , 3 , and 10 , respectively .",
    "the k - s statistic measures the maximum vertical deviation of the data from the model ( see text ) .",
    "snapshots of the simulated tumbler experiments taken at the end of each run .",
    "the froude number ( eq .  ( [ e : froude ] ) ) is indicated .",
    "view size is about 7.5 cm across each frame .",
    "the view is down the cylinder axis , and rotation is in the clockwise rotation direction ( at this viewing angle , the short cylinder itself can not be seen ) .",
    "the blue particles along the inner surface of the cylinder are `` glued '' in place to provide roughness .",
    "where shown , the yellow line indicates an estimate of the surface slope ( also see fig .",
    "[ f : tumbplot ] ) .",
    "plot of dynamic repose angle as a function of froude number for the simulated tumblers ( filled squares ) and from the experiments of brucks et al .",
    "( 2007 ; open squares connected with dashed line , from their fig .  3 ) .",
    "errorbars for the simulated points are 1-@xmath206 uncertainties from averaging slope estimates over several snapshots .",
    "the simulated points are shifted down and to the right compared with the experiments , which may be due partly to the difference in particle - to - tumbler radius ratio .",
    "see main text for discussion ."
  ],
  "abstract_text": [
    "<S> we present a new particle - based ( discrete element ) numerical method for the simulation of granular dynamics , with application to motions of particles on small solar system body and planetary surfaces . </S>",
    "<S> the method employs the parallel @xmath0-body tree code ` pkdgrav ` to search for collisions and compute particle trajectories . </S>",
    "<S> collisions are treated as instantaneous point - contact events between rigid spheres . </S>",
    "<S> particle confinement is achieved by combining arbitrary combinations of four provided wall primitives , namely infinite plane , finite disk , infinite cylinder , and finite cylinder , and degenerate cases of these . </S>",
    "<S> various wall movements , including translation , oscillation , and rotation , are supported . </S>",
    "<S> we provide full derivations of collision prediction and resolution equations for all geometries and motions . </S>",
    "<S> several tests of the method are described , including a model granular `` atmosphere '' that achieves correct energy equipartition , and a series of tumbler simulations that show the expected transition from tumbling to centrifuging as a function of rotation rate .    * keywords * : asteroids , surfaces ; collisional physics ; geological processes ; regoliths </S>"
  ]
}