{
  "article_text": [
    "the study of the anisotropies in the cosmic microwave background ( cmb ) is revolutionizing cosmology .",
    "fluctuations across a range of angular scales have been detected and their precision in the measurement of the power spectra are improving steadily .",
    "ground based and balloon born experiments are making effort to detect the acoustic features in the power spectrum predicted by inflationary models . in the near future the map satellite and a few years later the planck satellite will be able to measure the cmb power spectrum with sufficient accuracy to constraint several cosmological parameters with a few percent accuracy percent accuracy ( @xcite ) .",
    "there are two reasons that explain why the cmb is so powerful at constraining the cosmological parameters .",
    "first is the improvement in the experimental sensitivity that allows the detection of these small anisotropies with increasing precision .",
    "second is our ability to accurately calculate the predictions for the different world models .",
    "these theoretical predictions can be made with high accuracy because the calculation of the power spectrum only involves linear perturbation theory .",
    "the same fact that makes the anisotropies difficult to detect makes them also easy to calculate .",
    "the most widely used boltzmann code to calculate anisotropy spectra , cmbfast , was developed by the authors and has become a standard tool freely available to the community @xcite .",
    "the code is based on the integral solution of the transport equation for the photons , the boltzmann equation .",
    "the algorithm is much more efficient than the traditional way of solving the hierarchy because it takes advantage of the large difference between the distance photons have traveled since recombination and the horizon at that time .",
    "there have been several studies intended to constrain cosmological parameters with the existing cmb data @xcite .",
    "these studies rely on the speed of cmbfast to search a multidimensional parameter space for the best fitting model and the confidence regions for the parameters .",
    "they typically evaluate millions of models which would be prohibitely slow with a traditional boltzmann code taking a hundred times longer than cmbfast to run .",
    "so far the available versions of cmbfast did not allow the user to explore models with spatially closed geometries and thus that part of parameter space has not been explored with this code ( although closed universe boltzmann codes do exist , see e.g. @xcite ) .",
    "since the data are pushing us into the corner of parameter space with vanishing curvature , any meaningful error determination must also explore the models with positive curvature .",
    "it is therefore timely to make cmbfast available also for this class of models .",
    "a key part of the cmbfast algorithm is being able to calculate efficiently the radial part of the eigenfunctions of the laplacian , the ultraspherical bessel functions . in our implementation of open models we calculate these functions by integrating their corresponding differential equation .",
    "the straightforward extension of this algorithm is not possible for closed models . in this paper",
    "we explain the technical difficulties that arise for closed models and present the solution that is implemented in the new version of cmbfast ( v3.0 ) .",
    "in spherical coordinates the unperturbed geometry is described by , @xmath0 .",
    "\\label{metric}\\ ] ] the scale factor is @xmath1 , the coordinate @xmath2 is conformal time and the radial coordinate @xmath3 is related to the angular radius @xmath4 by @xmath5 with @xmath6 , where @xmath7 includes the contribution from both matter and the cosmological constant . note that with our choice of variables we have @xmath8 along radial geodesics .    to calculate the cmb power spectrum @xmath9 we need to evolve the perturbations in the different species ( cdm , baryons , photons , neutrinos ) .",
    "the perturbations are so small that linear theory suffices .",
    "the standard method is first to expand all perturbations in eigenvalues of the laplacian which evolve independently . in a flat spacetime",
    "this is a fourier expansion .",
    "the wavenumber @xmath10 labels the different eigenmodes .",
    "the fluctuations produced by each mode can be calculated separately and then all the contributions to the power are added , @xmath11 we have introduced @xmath12 , the contribution by a mode of wavenumber @xmath10 to the amplitude of multipole @xmath13 of the temperature anisotropies .",
    "the primordial power spectrum is denoted by @xmath14 .",
    "equation ( [ cls ] ) says that to obtain the total power in multipole @xmath13 we add the contributions from all modes labeled by @xmath10 .",
    "we have written this sum as a continuous integral , which applies to flat and open models .",
    "for closed spatial hypersurfaces the eigenvalues of the laplacian are discrete so the integral becomes a discrete sum over @xmath10 with @xmath15 .",
    "the first two modes are pure gauge modes and should be excluded from the sum @xcite .    in cmbfast the amplitudes @xmath16 are obtained using the integral solution , @xmath17 the ultraspherical bessel functions @xmath18 depend on the wavenumber @xmath10 and the radial coordinate along the geodesic @xmath19 .",
    "the source @xmath20 is a sum of the different terms that can generate temperature anisotropies . among these",
    "are gravitational redshift , doppler shift and intrinsic density fluctuation in the photon baryon fluid .",
    "the dominant contribution to the source is produced at the last scattering surface .",
    "the full expression for @xmath21 together with the equivalent formulas for the cmb polarization can be found in @xcite .",
    "equation ( [ integsol ] ) has several advantages over the more traditional way of calculating the anisotropies .",
    "the main one is that the sampling in @xmath10 needed to compute accurately the source @xmath21 ( essentially the inverse of the sound horizon at recombination ) is much smaller than that needed to obtain an accurate representation of @xmath22 ( approximately the inverse of the distance to the last scattering surface ) . in the traditional boltzmann method one solves directly for @xmath16 so one has to sample @xmath10 with the inverse of the distance to the last scattering surface .",
    "obtaining the source for each @xmath10 involves solving the perturbation equations for the different species so a reduction in the number of equations to be solved greatly enhances the performance of the code .",
    "in essence traditional boltzmann codes spend most of their time computing bessel functions . if we had a fast method for computing the bessel functions we could use equation ( [ integsol ] ) to make a fast algorithm .",
    "this is what cmbfast does . in flat geometries",
    "the ultraspherical bessel functions reduce to ordinary spherical bessel functions @xmath23 which are a function of a single variable @xmath24 . in the implementation of cmbfast for flat models we use tables with the values of the spherical bessel functions which are generated in advance and stored in disk .",
    "for open model we are unable to tabulate the ultraspherical bessel functions in advance because they no longer depend on only one variable .",
    "they depend separately on @xmath10 and @xmath3 because the curvature radius of the universe introduces another scale that can be used to turn @xmath10 and @xmath3 into two dimensionless numbers and the ultraspherical bessel functions depend on these two numbers independently . in our implementation of cmbfast for open models we choose to calculate the bessel function by solving their differential equation",
    ", @xmath25 u_{\\beta}^l=0\\ ] ] where @xmath26 .",
    "although at first this may not seem to be the most efficient method ( for example , we could have used the recurrence relation for the ultraspherical bessel functions instead ) , it is actually very efficient for our purposes .",
    "the point is that we need the function at a succession of neighboring points in time when evaluating equation ( [ integsol ] ) . to get from one point to the next a runge kutta integrator only performs a handful of operations , as opposed to the recurrence relation calculation which has to start at sufficiently high @xmath13 .",
    "it is true that recurrence relation gives the function value at all @xmath13 , but since the final cmb spectra are so smooth we actually only use every 50th @xmath13 or so , so this advantage of recurrence relation becomes less significant .",
    "thus although the recurrence relation is the most efficient way to obtain a single value of the bessel function , for our purposes solving the differential equation is a better method than the recurrence relation .",
    "another method to calculate these bessel functions based on the wkb approximation has been proposed ( @xcite ) .",
    "this method is again a fast way to obtain a single value of any @xmath22 since it only involves a few operations per @xmath22 call .",
    "however , for the integral solution which requires many calls at nearby arguments , the available implementation of these formulas does not appear to be faster than solving the differential equations .",
    "in @xcite we had developed the necessary formalism to solve the perturbation equations in both open and closed universes .",
    "we derived the boltzmann hierarchy for both temperature and polarization and the integral solution .",
    "the other trivial differences between closed and open models like the discreteness of the eigenvalues of the laplacian were also mentioned .",
    "the only problem not addressed was the calculation of the bessel functions in closed models .",
    "we discuss this issue here .",
    "equation ( [ diffeq ] ) is a second order differential equation and thus has two independent solutions .",
    "it can be viewed as the schr \" odinger equation for a particle with energy @xmath27 in a potential @xmath28 .",
    "thus for @xmath3 such that @xmath29 , where the `` energy '' is greater than the `` potential '' , the solution is oscillatory . for @xmath30",
    "there is a growing and a decaying solution , @xmath31 and @xmath32 , respectively .",
    "the growing solution corresponds to @xmath33 . in order to obtain an accurate numerical convergence the integration needs to be started in the regime where @xmath33 is small , which in our case means starting the integration close to @xmath34 .",
    "the equation then needs to be evolved in the direction of increasing @xmath3 until recombination , where @xmath35 .",
    "the integration of @xmath33 therefore proceeds in the direction of decreasing time , opposite to the evolution of boltzmann , fluid and einstein equations .",
    "if one were to start the integration at early time and evolve the bessel functions to small radial distances @xmath3 ( i.e. present time ) the integration would be numerically unstable , as the decaying mode @xmath32 would increasingly contaminate the solution .",
    "= 4.0 in    in closed models the angular distance @xmath36 is periodic around @xmath37 .",
    "the potential @xmath38 is a potential well . for parameters",
    "such that the maximum value of @xmath39 required in the evaluation of equation ( [ integsol ] ) is greater than @xmath40 the integration of the differential equation ( [ diffeq ] ) becomes unstable , similarly to integrating in the direction of decreasing @xmath3 in the open model case .",
    "as the integration proceeds the solution becomes increasingly contamined by the decaying solution which diverges at @xmath41 . in figure [ fig1 ]",
    "we show lines of constant @xmath39 in the @xmath42 plane for @xmath43 .",
    "the region upwards of the @xmath44 line suffers from this instability .",
    "we can use symmetry arguments analogous to those in quantum mechanics to solve the instability problem .",
    "the potential well @xmath38 is symmetric around @xmath44 and thus the eigenfunctions are either symmetric or antisymmetric around this point . just like in quantum mechanics",
    "we find that modes with even ( odd ) @xmath45 are symmetric ( antisymmetric ) . in our implementation of cmbfast for closed models we use this fact to obtain the bessel functions for regions with @xmath46 .",
    "we integrate equation ( [ diffeq ] ) up to @xmath44 and extend the solution further using the symmetry of the mode . in practice",
    "we apply the symmetry operation to the source term @xmath20 .",
    "we construct a symmetric @xmath47 and an antisymmetric @xmath48 version of the source . here",
    "@xmath2 and @xmath49 are times that have the same @xmath36 , related by @xmath50 .",
    "we use one of those in ( [ integsol ] ) according to the parity of the mode being calculated and stop the time integration at the @xmath51 corresponding to @xmath44 .",
    "we found this to be both a satisfactory solution of the instability and an efficient numerical algorithm .",
    "= 4.0 in    in figure [ fig2]a we show the power spectra obtained using the new cmbfast version for several closed models .",
    "we choose models with @xmath52 , @xmath53 and varying @xmath54 .",
    "the position of the models in the @xmath42 plane is shown in figure [ fig1 ] .",
    "the models we show all have the same values of @xmath55 and @xmath56 , so the physics of the acoustic peaks is the same for all the models .",
    "they only differ in the angular diameter distance to the last scattering surface and their amplitude which was normalized to cobe . in figure",
    "[ fig2]b we rescale the @xmath13 values so that a given physical scale at recombination corresponds to the same angular scale .",
    "this is achieved using @xmath57 , where @xmath58 is the radial comoving distance to recombination and primed variables correspond to the values in a fiducial model .",
    "we also renormalized the amplitude of the spectra",
    "so they are no longer cobe normalized .",
    "the agreement at high @xmath13 overall is very good , which is a consistency check for the code .    as we approach @xmath41 , @xmath59 , when we are able to see the antipode .",
    "as @xmath60 the @xmath9 spectra is compressed so that the acoustic peaks appear at larger and larger scales .",
    "when @xmath41 all the cmb photons that arrive to us from every direction come form one single point , so there are no anisotropies .",
    "we have restricted the range of models implemented in cmbfast to those with @xmath61 .    in our previous implementations of cmbfast",
    "we took advantage of the smoothness of the @xmath9 spectra to calculate ( [ integsol ] ) for every 50th @xmath13 in the region of the acoustic peaks .",
    "this was sufficient to obtain one percent accuracy in flat models and became even better for open model were the spectra are stretched further out in @xmath13 . for closed models",
    "the situation is reversed because the spectra are compressed so this sampling can become insufficient .",
    "if the first acoustic peak occurs at @xmath62 as opposed to @xmath63 for flat universes , the sampling every 50 ls introduces an error of 2% ( 5% ) .",
    "we extended the cmbfast code to the closed universes .",
    "the main technical issue in this implementation was the computation of ultraspherical bessel functions , which was obtained by solving their differential equation jut like in the case of open models .",
    "we use the symmetry of the ultraspherical bessel functions around @xmath44 to obtain their values at @xmath46 without integration .",
    "the code only works for models with @xmath64 . the new version of cmbfast for",
    "closed universes will allow the exploration of the full parameter space .",
    "the results of such an exploration will be presented elsewhere @xcite .",
    "we thank anthony challinor and antony lewis for helpful comparisons with their version of cmbfast for closed universes .",
    "m.z . is supported by nasa through hubble fellowship grant hf-01116.01 - 98a from stsci , operated by aura , inc . under nasa contract nas5 - 26555 .",
    "u.s . is supported by nasa grant nag5 - 8084 ."
  ],
  "abstract_text": [
    "<S> we extend the cosmological linear perturbation theory code cmbfast to closed geometries . </S>",
    "<S> this completes the implementation of cmbfast to all types of geometries and allows the user to perform an unlimited search in the parameter space of models </S>",
    "<S> . this will be specially useful for placing confidence limits on cosmological parameters from existing and future data . </S>",
    "<S> we discuss some of the technical issues regarding the implementation .    </S>",
    "<S> epsf    # 1    ( 2 )    = cmmib10 = cmmib10 scaled 833 v u    # 1#23.6pt </S>"
  ]
}