{
  "article_text": [
    "one of the central problems of physics from the mid nineteenth century on has been how to make the transition from a microscopic to a macroscopic theory of matter .",
    "this problem has two aspects .",
    "the first is the task of deriving the equations governing the macroscopic behaviour of matter from the underlying microscopic equations , exemplified by the derivation of maxwell s macroscopic equations from the microscopic theory of charges and fields in vacuum .",
    "this problem is elegantly solved by a coarse - graining procedure which takes an average over `` physically infinitesimal '' regions .",
    "such an elementary region is chosen to be small enough to let the average of a quantity follow all the changes that are observable at the macroscopic level , but large enough compared with characteristic atomic dimensions for it to contain so many particles that the behaviour of an individual particle has a negligible effect on the average quantity .",
    "this coarse - graining procedure smooths over the atomic - scale fluctuations in physical quantities , leaving only the slow spatial variation of their macroscopic components . a beautifully clear derivation of the macroscopic maxwell s equations , first derived by h. a. lorentz in 1902",
    ", @xcite can be found in rosenfeld s _ theory of electrons _",
    ", a now forgotten classic .",
    "@xcite in the coarse - graining procedure there are three distance scales : @xmath0 , the scale on which the macroscopic quantities vary ; @xmath1 , the scale on which the smoothing is carried out ; and @xmath2 , the microscopic scale , that is , the atomic scale . for the procedure to work , @xmath0 must be sufficiently larger than @xmath2 that the pair of inequalities @xmath3 can both be satisfied . indeed , this criterion makes clear the distinction between macroscopic and microscopic .",
    "the second aspect is the task of deriving macroscopic constitutive equations from microscopic properties .",
    "an early example is the derivation of the claussius - mossotti equation @xcite which provides the link between the microscopic polarizability ( response of the atoms or molecules to the local electric field ) and the macroscopic dielectric constant .",
    "the systems of interest in the present paper are those with interfaces between quite different materials .",
    "a planar capacitor comprised of an insulating layer sandwiched between metallic electrodes is a good example of such a system .",
    "further examples are heterojunctions between different semiconductors and schottky barriers at semiconductor - metal interfaces . in all such systems , there are multiple causes of charge transfer across or to the interfaces",
    ". these can include charge transfer to establish spatial uniformity of the chemical potential ( the fermi level ) , charge transfer in response to the local change in chemical composition across the interface and to the interface - induced atomic relaxation of the structure , charge accumulation to screen the interface charge density associated with the termination of bulk polarization at the interface , and charge accumulation attendant to charging or shorting @xcite of a capacitor .",
    "interface dipole densities arise from such transfer of charges and are responsible for offsets of the average electrostatic potentials across the interfaces , a dominant factor in determining schottky barriers and valence and conduction band offsets in semiconductor heterojunctions .",
    "@xcite in all such cases , the charge density of each material is perturbed , and the perturbation is localized near the interfaces , usually within a few interatomic distances .",
    "the case of thin ferroelectric films between metallic electrodes provides a good illustrative example of this general class of systems .",
    "since the early seventies a phenomenological model has been developed @xcite to explain the modification of the polar phases ( substantial reduction of the spontaneous polarization for small thicknesses , or even the complete suppression of ferroelectricity below a certain critical thickness ) and of their thermodynamic properties ( depression of the transition temperature with respect to that of the bulk material ) .",
    "the model , mainly due to batra and coworkers , relies on three basic assumptions : @xmath4 the polarization charge lies in a sheet right at the interface , @xmath5 the surface polarization charge density equals the magnitude of the polarization inside the thin film , and ( @xmath6 ) the free compensation charge spreads out at least over a finite distance @xmath7 within the electrode , decaying exponentially towards its interior as in the thomas - fermi approximation . in this model ,",
    "the screening length @xmath7 is dependent only on intrinsic properties of the electrode , such as the density of free carriers or the dielectric constant .",
    "all effects are neglected which might come from a particular choice of the electrode / ferroelectric interface , such as the different chemical bondings formed at the junction or the interpenetration of the electrode and dielectric / ferroelectric wave functions that might screen the polarization charge in part within the insulator , reducing therefore the magnitude of the interface dipole density .",
    "atomic level charge fluctuations are neglected as well , implying a smoothing on a microscopic scale distinct from the smoothing on the coarse - graining scale in the derivation of macroscopic equations and properties .",
    "the need to go beyond such simple models is well illustrated by this interpenetration of wave functions across the interface . as pointed out first by heine , @xcite and later by tejedor _",
    "_ @xcite and tersoff , @xcite the bulk bloch - states of the metal with energies below the fermi level of the metal and within the semiconductor band - gap and its valence band decay exponentially inside the semiconductor ( and , indeed , might have a significant amplitude for a few layers from the interface ) , creating a continuum of gap states [ the so - called metal - induced gap states ( migs ) ] . achieving deep understanding of interface properties with quantitative predictive power and free of adjustable parameters when they are determined by such effects occurring at the atomic scale",
    "requires first - principles computations . in recent years",
    "it has become possible to carry out first - principles calculations for systems of the complexity of those under discussion here .",
    "these simulations provide a wealth of information at the atomic level about the structural and electronic properties of materials and their responses to various external perturbations .",
    "@xcite some quantities , such as the microscopic charge density distribution @xmath8 or the corresponding electrostatic potentials , are routinely available from first - principles calculations .",
    "the question becomes how to extract from the immense detail provided by the first - principles computations reliable values of the physical quantities of interest *  * interface charge and dipole densities , screening lengths , etc .",
    "*  * which enter the pseudo - macroscopic models currently used .",
    "two major difficulties arise .",
    "first , coarse graining is inapplicable because the relevant distance scale for interface properties is the atomic scale , i. e. @xmath9 .",
    "second , the charge - density changes associated with maintaining the constancy of the fermi levels can be orders of magnitude smaller than the unperturbed bulk charge densities , themselves very rapidly varying functions of position , reflecting the underlying atomic structure .",
    "the relative magnitudes of these changes in the microscopic charge densities are illustrated in fig .",
    "[ fig : chargedensity ] .",
    "moreover , the polarization - induced charge densities and their screening charge densities can be smaller by additional orders of magnitude than those arising from imposing fermi - level constancy .",
    "therefore , all the interface - related dipole densities are overwhelmed by much larger variations of the total microscopic charge density .",
    "[ cc][cc]@xmath10 [ cc][cc]@xmath11 [ cc][cc]@xmath12 [ cc][cc]@xmath13     planes [ see eq .",
    "( [ eq : planarav ] ) below ] of bulk batio@xmath14 ( a ) , srruo@xmath14 ( b ) , and ( c ) an unpolarized planar capacitor comprised of 4 layers of batio@xmath14 between metallic electrodes made of 5 layers of srruo@xmath14 , all from first - principles . the charge - density profile of the capacitor looks like a juxtaposition of the bulk charge densities of the two materials , highlighting the fact that the charge transferred from one material to the other to establish the constancy of the chemical potential is overwhelmed by much larger variations of the total microscopic charge density .",
    "details of the first - principles calculations can be found in refs . and .",
    "the unit of the charge density is electrons / bohr@xmath15 . , width=377 ]    it is still possible to carry out smoothing of the computed charge density at the nanoscale where the conditions for coarse - graining are not met , providing sufficient care is taken .",
    "a heuristic smoothing procedure has been introduced @xcite to extract the quantities of interest from the results of first - principles charge - density computations as described in more detail below .",
    "however , that procedure has not yet been systematically analyzed to establish the conditions under which it accurately extracts the quantities of interest : surface charge densities , surface dipole densities , etc . in the present paper",
    ", we introduce such an analysis . in addition , in order to focus only on the perturbations introduced by the nanosmoothing procedure , avoiding other sources of numerical noise coming from the first - principles simulations , we illustrate the analysis with a toy model whose accuracy can be arbitrarily improved .",
    "the application of this theory to first - principles computations on realistic ferroelectric capacitors is the subject of a forthcoming paper . despite this focus on the ferroelectric capacitor ,",
    "our analysis is of general utility for the extraction of interface properties for all multilayer systems .",
    "the rest of the paper is organized as follows .",
    "we set the grounds of our discussion of simulations of interfaces from first - principles and define the microscopic behaviour of the different quantities that are the targets of our study in sec .",
    "[ sec : first - principles ] . in sec .",
    "[ sec : unpolar ] we define the interface quantities of interest for an unpolarized interface . in sec .",
    "[ sec : refint ] we describe the difficulties encountered in defining precisely the location of a reference interface .",
    "we develope the theory of nanosmoothing of unpolarized systems in sec .",
    "[ sec : nanosmoothing ] with particular attention to questions of the sensitivity of quantities of interest to the smoothing procedure .",
    "we describe in sec .",
    "[ sec : toymodel ] a toy model used to illustrate all of the essential elements of the smoothing theory . in sec .",
    "[ sec : resultsunpolar ] , we present the results of the toy model computations for the unpolarized case .",
    "we generalize the nanosmoothing theory of sec .",
    "[ sec : nanosmoothing ] for polarized systems in sec .",
    "[ sec : polar ] and present the corresponding toy model results in sec .",
    "[ sec : resultspolar ] . finally in sec .",
    "[ sec : summary ] , we summarize our results , emphasizing the specific criteria smoothing functions must satisfy to yield interfacial properties insensitive to their parameters and specifying which of our results are new .",
    "first - principles calculations of interfaces between two materials , where there is no periodicity in at least one direction , are almost universally done by means of the supercell approximation .",
    "@xcite within this approach a basic unit cell that contains a suitable number of multiatom layers of the two materials is periodically repeated over all space ( fig . [",
    "fig : supercell ] ) . for the interfaces within a nanostructured multilayer to be well defined , with properties",
    "distinct from those of the bulk - like regions between them , the widths of the layers of each material introduced in the construction of the basic unit cell must be large enough to avoid the interaction between adjacent interfaces through the bulk materials , so that the calculation accurately represents an isolated interface .",
    "axis is taken as normal to the interface , whereas the plane parallel to the discontinuity is taken as the @xmath16 plane . @xmath17 and @xmath18 multiatomic layers of two materials , whose bulk lattice constants in the out - of - plane direction are respectively @xmath19 and @xmath20 , are stacked to build a basic unit cell ( hatched rectangle ) that is periodically repeated in space . @xmath21",
    "is the length of the supercell in the out - of - plane direction , with @xmath22 . in the figure , @xmath17 = 2 , and @xmath18 = 3 .",
    ", width=226 ]    throughout this work , we shall assume that the interface is oriented along the @xmath23 axis , and each material is periodic in the plane parallel to the interface , referred to as the @xmath16 plane .",
    "precisely the same methodology is used to treat nanostructured multilayer materials , and in this paper we do not distinguish between the cases , specializing to multilayers in which the individual material thicknesses are large enough for the interfaces to be noninteracting .    the microscopic charge densities @xmath24 [ see fig .",
    "[ fig : chargedensity](c ) ] and electrostatic potentials @xmath25 provided by the first - principles computations for the previously described supercells are continuous functions periodically repeated in space with the periodicity of the supercell ( @xmath21 in fig .",
    "[ fig : supercell ] ) .",
    "a few interatomic distances away from the interfaces , the microscopic quantities recover their bulk features .",
    "in other words , if the layer widths are large enough , it is possible to identify `` bulk - like '' regions in the middle of each of the layers that constitute the superlattice , with large variations of the microscopic quantities with the same periodicity as in the bulk , reflecting the underlying atomic structure .",
    "many of the interface - related quantities that we shall define below depend only on what happens in the direction perpendicular to the interface , where the actual discontinuities of the physical structure occur .",
    "since we assume in - plane periodicity , we can trivially eliminate the in - plane dependence by taking a planar average of the corresponding microscopic quantity , e. g. , for the electron density ,    @xmath26    where @xmath27 is the area of the interface unit cell .",
    "as is proven in appendix [ sec : transversepoisson ] , this transverse averaging has no effect on the poisson equation , which reads after averaging    @xmath28",
    "one of the most important physical properties of heterojunction devices is the band offset or schottky barrier at an interface , that is , the relative positions of the energy levels on both sides of the interface . in the case of semiconductor heterojunctions , the valence - band offset ( vbo ) [ conduction - band offset ( cbo ) ]",
    "is defined as the difference between the positions of the tops of the valence bands [ the bottoms of the conduction bands ] of the two materials . in the case of metal - semiconductor contacts",
    ", we can define the @xmath29-type ( @xmath30-type ) schottky barrier as the difference between the fermi level of the metal and the top of the valence band ( bottom of the conduction band ) of the semiconductor .",
    "these differences in the band positions determine the effective barrier for electron or hole transport across the junction .",
    "the computation of such effects from first - principles can not be achieved by a direct comparison of the corresponding single - particle energies ( tops of the valence bands , bottoms of the conduction bands and/or fermi level of the metal ) in the two compounds as obtained from two independent _ bulk _ band - structure calculations .",
    "the reason is the lack of an intrinsic energy origin to which to refer all the energies : in a first - principles simulation , the hamiltonian eigenvalues are referred to an average of the electrostatic potential that is ill defined for an infinite system @xcite where , due to the long - range nature of the coulomb interaction , it is defined only to within an arbitrary constant .",
    "consequently , together with the eigenvalue difference , we must consider both the shift of this average between the two materials and the redefinition of the averaging process so that it is appropiate to the multilayer system under consideration . as was mentioned in sec .",
    "[ sec : intro ] , the coarse - graining procedure used historically fails when applied to the results of first - principles computations .",
    "we designate the averaged potential as @xmath31 and its shift as @xmath32 .",
    "the brackets @xmath33 indicate that the averaging process is not yet defined .",
    "we shall label all quantities of physical interest of the unpolarized system by a subscript @xmath34 .",
    "this potential shift depends on the dipole induced by the electronic charge transferred from one side of the interface to the other after interfacial hybridization .",
    "as the charge transfer depends not only on the materials that constitute the interface , but also on intrinsic interface effects such as the chemical composition ( termination of each material at the interface ) , on particular orientation and on other structural details , the shift can only be obtained from a self - consistent calculation on a supercell including both materials .",
    "this ensures that the averaged electrostatic potentials of both materials in the `` bulk - like '' regions defined in the previous section , where all the physical quantities recover the bulk features , are expressed with respect the same reference and allows a direct extraction of the shift .",
    "this shift of the averaged electrostatic potential should be directly related to an averaged interface dipole - moment density @xmath35 ,    @xmath36    we prove in appendix [ sec : elecdipole ] that eq .",
    "( [ eq : deltavdipole ] ) holds for the specific definition of the average procedure @xmath33 introduced in sec .",
    "[ sec : nanosmoothing - procedure ] below and discussed in this context in sec .",
    "[ sec : nanosmoothing - poisson ] .    from a fundamental point of view , @xcite the charge @xmath37 , and electric dipole moment at the interface @xmath38 are defined respectively as the zero and the first moment of the total microscopic charge density ,    @xmath39    for the previous equations to be meaningful and truly represent an interface quantity , the thicknesses of the adjacent layers must be wide enough so that they contain regions within which the charge density is essentially unaffected by the presence of interfaces within which @xmath40 and @xmath41 could be located .",
    "however , from a practical point of view , such a definition poses serious questions .",
    "indeed , both @xmath37 and @xmath38 are ill - defined due to the large and rapid oscillations of the microscopic charge density [ see fig . [",
    "fig : chargedensity](c ) ] .",
    "in fact , different choices of the integration limits @xmath40 and @xmath41 yield widely different values of the charge and interface dipole moment . only in the extreme case of a clausius - mossotti model ,",
    "in which the total charge is unambiguously decomposed into an assembly of localized and neutral charge distributions , so that a unit cell can be chosen with no charge at the surface , the dipole moment of a periodic charge distribution would be well - defined as the integral of the first moment of the charge density .",
    "however , any claussius - mossotti approach does not correspond to reality , particularly in materials where delocalized covalent charge is present.@xcite this ambiguity in the definition of @xmath38 with respect to the boundaries of the region within which the dipole moment is computed is closely connected to the problem of defining the polarization of a periodic system from the charge density .",
    "in order to get rid of bulk effects and extract interface - related features , some authors @xcite have defined an ideal interface by stacking alternate slabs , each of them made from slicing the planar average of the bulk charge density of the corresponding material perpendicular to a particular direction .",
    "let us define @xmath42 and @xmath43 as the planar - averaged [ eq . ( [ eq : planarav ] ) ] bulk charge densities of the left and right material respectively , unaffected by the presence of the interface .",
    "they are locally periodic in @xmath23 , and , assuming that both bulk materials are unpolarized , the net charge and the dipole moment vanish within each bulk unit cell ,    @xmath44    where @xmath45 is the lattice constant of the bulk unit cell of each material in the @xmath23 direction , and @xmath46 refers to the side of the interface considered , 1 or 2 .",
    "the bulk unit cell boundaries are chosen so as to preserve inversion symmetry .    replicating the bulk charge densities up to the as yet unspecified interface from each side",
    ", we could define the reference charge density @xmath47 for all @xmath23 as    @xmath48                            , &   \\ : \\ :   z = z_{int } ,                         \\\\                                                            \\\\",
    "\\overline{\\rho}_{0}^{(2 ) } \\left ( z \\right ) , &   \\ : \\ :   z > z_{int } ,   \\\\                                                            \\\\",
    "\\end{array } \\right .",
    "\\label{eq : rho0 }   \\end{aligned}\\ ] ]    where @xmath49 is the coordinate assigned to the position of the interface .",
    "@xmath50 is discontinous at the interfacial plane @xmath49 by its very definition .",
    "we now define the interface - induced deformation of the charge density @xmath11 as    @xmath51    if the thicknesses of the two layers are wide enough , @xmath11 becomes negligibly small over the ranges @xmath52 in the left material and @xmath53 in the right material [ see fig .",
    "[ fig : nanotoy](b ) ] .",
    "the interface region can thus be identified as comprised of those ranges where @xmath11 differs significantly from zero , in other words where the microscopic charge density differs from the relevant bulk values . the interface charge and dipole density associated with @xmath11",
    "are defined as ,    @xmath54    the advantage of this approach is that both @xmath55 and @xmath56 are well defined quantities with respect the location of the integration limits @xmath40 and @xmath41 in eqs .",
    "( [ eq : deltaq])-([eq : deltap ] ) , provided that @xmath40 lies in @xmath52 and @xmath41 lies in @xmath53 .",
    "however , this approach has pitfalls . in particular @xmath4 the position of the interface , @xmath49 in eq .",
    "( [ eq : rho0 ] ) , is not yet specified .",
    "some recipes have been given for how to cut the bulk slabs , but they have limited applicability .",
    "one case is for common anion heterostructures with non - relaxed interfaces along high - symmetry planes , such as the ( 001 ) @xcite , ( 110 ) @xcite , or ( 111 ) @xcite interfaces of gaas / alas superlattices .",
    "as soon as an interface - induced rippling of the atomic layers is introduced , for instance after an atomic relaxation of the interface geometry , the problem of defining the position of the interface worsens .",
    "@xmath5 therefore , the interface charge and dipole densities are not unique , since they depend critically on where the mathematical surface representing the interface is chosen , and no objective criterion for locating it has been established .",
    "in particular @xmath55 and @xmath56 [ eqs .",
    "( [ eq : deltaq])-([eq : deltap ] ) ] equal @xmath37 and @xmath38 [ eqs .",
    "( [ eq : qu])-([eq : pu ] ) ] if and only if @xmath57 contains an integer number of unit cells of the left material and @xmath58 contains an integer number of unit cells of the right material",
    ". the location of the interface determines where on one side , the bulk charge density of the left material is subtracted , and on the other side that of the right material .",
    "a different choice of the mathematical interface can produce very different charge and dipole densities .",
    "in addition , comparison between different interface orientations makes little sense with this definition .",
    "@xcite @xmath59 since the interface dipole moment is dependent on the reference charge density , the corresponding potential drop at the interface ( @xmath60 in the notation of refs . )",
    "must be too .",
    "however , it is important to note that the potential drop generated by @xmath11 is only part of the total potential shift .",
    "the total charge density of the interface is given by    @xmath61    thus the potential shift associated with @xmath50 must be included as well .",
    "although the existence of a potential shift generated by @xmath50 is general , we shall explain its origin only in the particular case where @xmath62 contains an integer number of unit cells of the left material , and @xmath58 contains an integer number of unit cells of the right material . in this particular situation both slabs used to construct the reference charge density in eq .",
    "( [ eq : rho0 ] ) have neither a charge nor a dipole moment . under these circumstances ,",
    "the potential shift is the difference in the locally averaged potentials produced by the @xmath63 of each material in the regions @xmath52 and @xmath53 respectively . for this shift to be an interface property ,",
    "the layer width of each material must be large enough that the local average @xmath64 has approached the unperturbed value within the center of an slab .",
    "the planar averaged potential within any point of the slab will be given by @xcite    @xmath65    so the local average can be computed as    @xmath66    since @xmath64 depends on the charge density distribution , it differs for the left and right slabs used in the construction of the reference charge density and produces an additional shift .",
    "therefore , the total potential drop at the interface is the sum of the potential drop generated by @xmath11 , @xmath60 , and the difference of the average potential of the two reference slabs @xmath67 .",
    "only the sum @xmath68 is independent of the reference charge density chosen and is a physically measurable property of the interface . since each term in the sum is sensitive to the arbitrary location of the interface , each must be computed accurately enough for the sensitivity to disappear from the sum .",
    "as the charge density shifts of interest are so small , this is an unnecessary burden , removed by the use of a proper nanosmoothing @xcite procedure as shown in sec .",
    "[ sec : nanosmoothing ] .",
    "a procedure to eliminate charge fluctuations in the regions of the material which do not contribute to the interfacial hybridization , thereby localizing the physically relevant charge densities to the interface , consists of filtering out the periodic oscillations of microscopic quantities , which typically follow the underlying atomic structure , preserving only those features that emerge in the vicinity of the interface .    to obtain this smoothed charge density ,",
    "we have followed the recipe given by baldereschi _",
    "et al . _ in ref . and",
    "generalized by colombo and coworkers for lattice mismatched heterostructures in ref . .",
    "starting from the planar - averaged charge density @xmath69 , we construct the smoothed density @xmath70 by convoluting it with a smoothing function @xmath71 ,    @xmath72    which has the following properties : @xcite    @xmath73    so that    @xmath74    in addition , @xmath71 should be monotonic in @xmath75 and sufficiently smooth itself . @xmath76 should be chosen on the scale of the unit cell length or larger , but smaller than the widths of the left and right layers . a sharper criterion for @xmath76 is introduced below .",
    "we define this as the averaging procedure @xmath33 left unspecified above in sec .",
    "[ sec : unpolar ] .",
    "the particular smoothing function we have used , following refs . , and , is the convolution of two square - wave filter functions :    @xmath77    where    @xmath78    giustino and coworkers @xcite propose convolution with a gaussian kernel that can be an approximation to the asymptotic limit of a convolution of a large number of square - wave filter functions .",
    "this method is best suited for superlattices where crystal deviates from perfect periodicity far away from the interface so that it is not possible to define regions where the interface - induced charge density vanishes , or in disordered three - dimensional systems with short - range order .",
    "even more general functions can be used , providing the criteria established above are met .    the explicit dependence of @xmath71 , defined in eq .",
    "( [ eq : filterconvolution ] ) , on @xmath23 is :    @xmath79 ,                    &   \\ : \\ : \\frac{\\left| l_{1 } - l_{2 } \\right|}{2 } <                          \\left| z \\right| \\le                          \\frac { l_{1 } + l_{2 } } { 2 } ,                                                             \\\\",
    "\\frac{1}{l _ { > } } ,                    &   \\ : \\ : 0 < \\left| z \\right| <                    \\frac{\\left| l_{1 } - l_{2 } \\right|}{2 } ,                                       \\end{array } \\right .",
    "\\label{eq : doublefilter }   \\end{aligned}\\ ] ]    [ cc][cc]@xmath80 [ cc][cc]@xmath81 [ cc][cc]@xmath82 [ cc][cc]@xmath83 [ cc][cc]@xmath84 [ cc][cc]@xmath85 [ cc][cc]@xmath86 [ cc][cc]@xmath87 [ cc][cc]@xmath88 [ cc][cc]@xmath89 [ cc][cc]@xmath90     and @xmath91 , as defined in eqs .",
    "( [ eq : step1 ] ) and ( [ eq : step2 ] ) , are represented in panel ( a ) .",
    "the corresponding convolution , given by eq .",
    "( [ eq : filterconvolution ] ) , is shown in panel ( b ) . for numerical calculations ,",
    "the square - wave functions are expanded in fourier series .",
    "the small oscillations in the vicinity of each discontinuity are due to the gibbs phenomenon . @xcite , width=377 ]    as shown in fig .",
    "[ fig : filter ] .",
    "@xmath92 is the greater of @xmath93 and @xmath91 .",
    "after nanosmoothing the planar averaged charge density @xmath10 , the resulting charge density @xmath12 is a continuous function that joins smoothly at the interface .",
    "even though we have not subtracted any reference charge , the smoothed charge density becomes negligibly small over ranges @xmath94 in the left material and @xmath95 in the right material [ see fig . [",
    "fig : nanotoy](c ) ] , and the interface region can be unambiguosuly defined as the region where the smoothed charge significantly differs from zero .",
    "note that @xmath96 and @xmath97 will differ in general , as shown in fig .",
    "[ fig : diffr ] and discussed further in secs .",
    "[ sec : nanosmoothing - insensitivity ] and [ sec : resultsunpolar ] .      providing the filter function",
    "@xmath98 satisfies the following additional conditions ,    @xmath99    the poisson equation remains invariant after the nanosmoothing ( see appendix [ sec : nanosmoothpoisson ] ) and transforms into    @xmath100    the nanosmoothing function @xmath101 defined in eq .",
    "( [ eq : step1 ] ) and eq .",
    "( [ eq : step2 ] ) violates condition eq .",
    "( [ eq : conditionf1 ] ) at its end points @xmath102 , where @xmath101 is discontinuous so that condition ( [ eq : conditionf3 ] ) can not be unambiguously applied .",
    "similarly , the @xmath98 of eq . (",
    "[ eq : doublefilter ] ) violates condition ( [ eq : conditionf1 ] ) at the four points @xmath103 , and @xmath104 is discontinuous at the points @xmath103 so that condition ( [ eq : conditionf2 ] ) can not be unambiguously applied .",
    "nevertheless , one can think of the @xmath98 as a _ distribution _ , a family of smooth functions all of which meet conditions ( [ eq : conditionf1 ] ) - ( [ eq : conditionf3 ] ) and which approach the @xmath98 of eq .",
    "( [ eq : doublefilter ] ) as their limit . in practice , because the smoothing operation is a convolution , eq .",
    "( [ eq : nanosmoothing ] ) , one carries out smoothing via fast fourier transformations .",
    "the family of the finite fourier series involved is thus a distribution which converges to @xmath98 in the limit , meeting conditions ( [ eq : conditionf1 ] ) - ( [ eq : conditionf3 ] ) along the way .",
    "( [ eq : poissonnanosmoothed ] ) holds in general for both the unpolarized and the polarized cases , so subscripts have been omitted .",
    "otherwise the subscript @xmath34 is used because we are presently treating the unpolarized case .",
    "we prove in appendix [ sec : elecdipole ] that the full electrostatic potential shift @xmath105 is given by the nanosmoothed dipole density @xmath106 ,    @xmath107    where    @xmath108      the microscopic charge density @xmath109 must return to the bulk microscopic charge densities @xmath110 and @xmath111 in the regions @xmath52 and @xmath53 for it to be possible to ascribe physical properties specifically to individual interfaces .",
    "however rapidly it approaches those values , the approach must be complete within @xmath52 and @xmath53 , as summarized by eq .",
    "( [ eq : rhor1r2 ] ) ,    @xmath112    with @xmath113 such that @xmath10 and all its derivatives are continuous ( the cusps at the nuclei are washed out by lateral averaging ) .",
    "consequently , _ locally _ within @xmath52 and @xmath53 , the microscopic charge density @xmath109 can be _ represented _ by the fourier transforms of @xmath110 and @xmath111 ,    @xmath114    in eq .",
    "( [ eq : ftrho12 ] ) @xmath115 vanishes because of charge neutrality",
    ".    the smoothing function @xmath116 , eq .",
    "( [ eq : filterconvolution ] ) , is a convolution of two square wave functions @xmath117 , eqs .",
    "( [ eq : step1])-([eq : step2 ] ) , s = 1 , 2 .",
    "the order of the @xmath118 within the convolution is immaterial , so the @xmath118 can be applied to the nanosmoothing of @xmath63 first , in the two - step nanosmoothing process implied by use of @xmath116 in eq .",
    "( [ eq : nanosmoothing ] ) .",
    "as long as @xmath119 is an integer multiple of the lattice constant of material @xmath46 , all contributions to @xmath63 from @xmath120 , are smoothed to zero , leaving only @xmath115 which itself vanishes .",
    "however the regions @xmath97 within which @xmath121 vanishes lie within @xmath96 because smoothing @xmath109 within @xmath96 brings into @xmath121 values of @xmath109 for @xmath23 outside @xmath96 .",
    "the limits @xmath122 for the determination of @xmath123 in eq .",
    "( [ eq : macrodipole ] ) must lie within @xmath97 , and @xmath76 must be significantly smaller than the width of @xmath96 .",
    "similarly the electrostatic potential @xmath124 can be expressed within @xmath96 as a comparable fourier series ,    @xmath125    with the @xmath126 fixed by the poisson equation , eq .",
    "( [ eq : transavpoisson ] ) ,    @xmath127^{2 } } , \\:\\ : n \\ne 0 ,     \\label{eq : ftpotcoef}\\ ] ]    except for @xmath128 which is influenced by the charge density outside of @xmath97 . upon nanosmoothing ,",
    "all contributions to @xmath129 for @xmath23 within @xmath97 vanish except that for @xmath130 ,    @xmath131    which is invariant to the smoothing process .    the potential shift @xmath105 , defined in eq .",
    "( [ eq : deltav ] ) as    @xmath132    is thus invariant to the smoothing procedure ,    @xmath133    moreover , according to eq .",
    "( [ eq : relshiftdip ] ) , the nanosmoothed dipole - moment density @xmath106 is invariant as well ,    @xmath134.\\ ] ]      it is of considerable physical interest to establish the value of the charge transferred across the interface , a difficult task .",
    "a criterion for establishing the position of the interface is needed , the difficulty of which is discussed in sec .",
    "[ sec : refint ] .",
    "the rapid , large oscillations of @xmath10 and the relative smallness of the pertinent component of @xmath10 make using it impractical . on the other hand ,",
    "if one uses a criterion based on @xmath12 , @xmath49 can be sensitive to the smoothing function .",
    "nevertheless , we shall attack the problem using @xmath12 and attempt to overcome the resulting sensitivity to the smoothing function of the position of @xmath49 and the amount of charge transferred .",
    "we start by defining two cumulative charge densities    @xmath135    for the unpolarized case now under consideration , @xmath136 .",
    "thus , as    @xmath137    holds for @xmath138 , and it is sufficient to consider either one or the other . define @xmath139 as the magnitude of the charge transferred per unit area of the interface , the transferred charge density .",
    "we estimate @xmath139 as    @xmath140    and estimate @xmath49 as    @xmath141    now both @xmath139 and @xmath49 are sensitive to the choices of @xmath93 and @xmath91 in the smoothing function @xmath142 . as @xmath93 and @xmath91 increase",
    ", @xmath143 can reach across the interface from material 1 to material 2 bringing contributions from @xmath144 , @xmath145 within material 2 , to @xmath146 , @xmath23 within material 1 , and vice versa , thus returning part of the transferred charge back to its origin and reducing the value of @xmath139 .",
    "moreover , since @xmath147 contains components which oscillate strongly with @xmath23 , @xmath148 could develope multiple suprema or maxima as @xmath93 and @xmath91 increase in multiples of the lattice constants of materials 1 and 2 , respectively .",
    "this would vitiate the utility of the definitions ( [ eq : qchartrans ] ) and ( [ eq : defzint ] ) of the transferred charge @xmath139 and the interface location @xmath49 , respectively , should it happen .",
    "we have found that it does happen in the toy model described in sec .",
    "[ sec : toymodel ] and studied in sec .",
    "[ sec : resultsunpolar ] , cf .",
    "[ fig : diffr ] below , in the case where the interatomic distance remains unchanged across the entire superlattice . accordingly",
    ", as a precaution , the smallest acceptable values of @xmath93 and @xmath91 should be used for @xmath71 , a single lattice constant of each material , an important additional condition on @xmath93 and @xmath91 .",
    "if the transferred charge density were concentrated equally on two surfaces at either side of the interface , separated by a distance @xmath7 , a dipole moment density of magnitude @xmath149 would be created .",
    "setting @xmath149 equal to the actual dipolar density @xmath106 allows us to define @xmath150 as the dipolar length    @xmath151    where we have restored the subscript @xmath34 to @xmath139 as we are dealing with the unpolarized case .",
    "now we can ask whether the physical magnitudes of interest , such as the interfacial charge [ eq .",
    "( [ eq : qu ] ) ] or dipole moment densities [ eq . ( [ eq : pu ] ) ]",
    "remain unchanged if the microscopic charge density is replaced with the nanosmoothed charge density .",
    "in other words , if we define the interfacial charge @xmath152 and dipolar densities @xmath106 computed from @xmath12 as    @xmath153    then the question is whether @xmath154 and @xmath155 for given integration limits @xmath40 and @xmath41 .",
    "replacing eq .",
    "( [ eq : bbrho ] ) into eq .",
    "( [ eq : bbqu ] ) ,    @xmath156    , @xmath145 plane according to eq .",
    "( [ eq : bbqu1 ] ) .",
    "( b ) the range of integration according to eq .",
    "( [ eq : qu1 ] ) .",
    "the direction of the shading lines , horizontal in ( a ) and vertical in ( b ) , indicates the variable of which the first integral occurs , over @xmath145 in eq .",
    "( [ eq : bbqu1 ] ) , and @xmath23 in eq .",
    "( [ eq : qu1 ] ) respectively . ,",
    "width=226 ]    the region of integration in eq .",
    "( [ eq : bbqu1 ] ) within the @xmath23 , @xmath145 plane is shaded in fig .",
    "[ fig : rangeint](a ) .",
    "then , the integral of eq .",
    "( [ eq : bbqu1 ] ) can be decomposed into the integral on the central square plus the integrals on the cross hatched triangles    @xmath157    on the other hand , @xmath158 is defined as    @xmath159    where the region of integration in the @xmath23 , @xmath145 plane is now shaded in fig .",
    "[ fig : rangeint](b ) . decomposing the domain of integration as for @xmath152 above",
    "gives    @xmath160    therefore , the equality @xmath161 is verified if and only if the integrals over the shaded regions on either side of the line @xmath162 are the same , that is if the following pair of equations hold    @xmath163    if in eq .",
    "( [ eq : condtriangle1 ] ) we apply the following change of variables @xmath164 and @xmath165 in the left hand side and @xmath166 and @xmath167 in the right hand side , then eq . ( [ eq : condtriangle1 ] ) transforms into    @xmath168    due to the parity conditions of the filter function , we know that @xmath169 .",
    "but , @xmath170 if and only if @xmath171 is even about @xmath41",
    ". completely analogous reasoning can be applied to eq .",
    "( [ eq : condtriangle2 ] ) and is omitted here .",
    "thus , for @xmath152 to equal @xmath37 , it must be possible to find a @xmath40 and a @xmath41 about which @xmath172 is _ symmetric _ for @xmath173 .",
    "we now show for the unpolarized case that this symmetry condition can be satisfied . for a multilattice consisting on alternating layers of two different materials @xmath46 ,",
    "@xmath174 or @xmath175 , there are two distinct interfaces within the supercell bounded by @xmath40 and @xmath176 , interface 1,2 and interface 2,1 .",
    "we define total charge @xmath177 and @xmath178 which are the sums of the charges associated with each individual interface ,    @xmath179    proceeding in analogy with eq .",
    "( [ eq : bbqu2 ] ) and eq .",
    "( [ eq : qu2 ] ) , we obtain    @xmath180    @xmath181    the fact that @xmath182 is periodic in @xmath23 with period @xmath21 allows as to rewrite eqs .",
    "( [ eq : qsc2 ] ) and ( [ eq : qsc3 ] ) so as to establish the equality of @xmath177 and @xmath178 ,    @xmath183    since the supercell is electrically neutral , so must the nanosmoothed supercell be ,    @xmath184    consequently , from eq .",
    "( [ eq : qscbar ] ) it follows that    @xmath185    implying that there would be a smooth electrostatic field within each layer if @xmath186 is nonzero .",
    "the existence of such a field would polarize the system in contradiction to the initial condition that the system is unpolarized .",
    "we conclude that    @xmath187    thus , for the interface charge to be invariant to nanosmoothing , that is , for @xmath188 to hold , @xmath40 and @xmath41 must be positioned in @xmath52 and @xmath53 so that @xmath189 vanishes in the unpolarized case . to do this",
    ", one could make an arbitrary choice of @xmath40 in @xmath52 , say , and then integrate @xmath190 from @xmath40 up to some @xmath41 in @xmath53 at which the integral vanishes .",
    "there is no need to do this , as it is the nanosmoothing quantities themselves which are of interest .    repeating the reasoning for the dipole moment density , we arrive at the conclusion that for @xmath191 , the following condition must be satisfied    @xmath192    applying the same change of variables as before , that is @xmath164 and @xmath165 in the left hand side and @xmath166 and @xmath167 in the right hand side , then eq . ( [ eq : condtrianglep1 ] ) transforms into    @xmath193    even in the case of a function @xmath109 symmetric around @xmath40 and @xmath41",
    ", the previous condition does not hold in general , and the difference between @xmath106 and @xmath38 amounts to    @xmath194    plus a similar term that comes from the difference in the lower triangles in fig .",
    "[ fig : rangeint](a ) and fig .",
    "[ fig : rangeint](b ) .",
    "this has to be evaluated for each particular case .    in conclusion ,",
    "the interface dipole - moment density is not invariant to nanosmoothing and the interface charge density can be made so only by exquisite case in the choice of @xmath40 and @xmath41 .",
    "this is of no concern , as it is the nanosmoothed quantites which are of physical interest .",
    "as highlighted in the introduction , the components of the density which give rise to the interface - related dipole densities are nearly obscured by the much larger variations of the total microscopic charge density .",
    "this atomic - scale charge density , routinely provided by any density - functional - based first - principles code , is affected by numerical noise and convergence problems inherent in some of the standard approximations in the practical implementations of density functional theory ( dft ) .",
    "therefore , the accuracy of the computations required for extracting the actual charge transferred from one side of the interface to the other must be high enough so that the numerical noise of the calculations is orders of magnitude smaller than the relevant interface - related charge densities . in this paper , in order to illustrate all of the essential elements of the theory of smoothing while avoiding these practical problems , we shall define a toy interface model that resembles closely a realistic multilayer material but whose computational accuracy can be systematically improved .",
    "the requirements that such a toy model should meet are : ( i ) its electron density must be a continuous function ; ( ii ) far away from the interfaces , where the interface - induced perturbation of the charge density becomes negligible , the toy electron density must tend to two distinct periodic functions on the left and on the right of each interface , mimicking the differing behaviour at the bulk level of the materials that constitute the multilayer system containing the interfaces ; and ( iii ) the interlayer spacing at the interfaces should be distorted with respect those at bulk so as to simulate better the interface induced relaxations that happen in real interfaces .    in the toy model we propose here , we represent only the laterally averaged density , a one - dimensional function . as before , the direction perpendicular to the interface is referred to as the @xmath23 axis .",
    "we shall consider atomic - like charge densities @xmath195 ( again as before , the superindex @xmath196 refers to the side of the interface , left or right , where a given `` atom '' @xmath197 is located ) of the sum of two gaussians , centered at each atomic site @xmath198 ,    @xmath199      \\nonumber \\\\      & - \\frac{a^{e , s}_{i } } { \\sigma_{e , s } \\sqrt{2\\pi } }       exp\\left [ - \\frac{\\left(z - z^{(s)}_{i}-\\delta^{(s)}_{i}\\right)^{2 } }      { 2 \\sigma_{e , s}^{2 } } \\right ] .",
    "\\end{aligned}\\ ] ]    the positive ( negative ) gaussian , whose standard deviation is denoted by @xmath200 ( @xmath201 ) , mimics the nuclear charge density ( electronic charge density ) of atom @xmath197 centered on position @xmath202 . by imposing @xmath203 we make the `` nuclear '' charge more confined than the `` electronic '' charge .",
    "since the gaussians are normalized , a net charge per atomic site can be simulated by making @xmath204 .",
    "the parameter @xmath205 allows us to displace the electronic clouds with respect to the nuclei and thereby produce a net dipole moment on a particular atom .",
    "the atomic - like charge densities are arranged in bulk unit cells that might contain one single atom or a more complicated polyatomic basis . in this section",
    "we shall assume that the bulk unit cells of each of the materials that form the superlattice contains a single atom that does not carry any charge ( @xmath206 ) or dipole moment ( @xmath207 ) .",
    "for the polarized case , we refer the reader to sec . [ sec : resultspolar ] .",
    "thus , for the unpolarized interface each material can be considered as a one - dimensional monoatomic chain , where consecutive `` atoms '' are separated by a distance @xmath208 .",
    "the interatomic distance at the interface , @xmath209 , is taken as @xmath210 . then , consecutive interatomic distances from the interface evolve smoothly towards the bulk value as a function of the distance to the interface . in our simulations ,",
    "when we move from the interface towads material @xmath211 the second interatomic distance is set up to @xmath212 , where @xmath213 is the lattice constant of the other material .",
    "the bulk value is recovered only at the third interatomic distance from the surface .",
    "a supercell is then built , as described in sec .",
    "[ sec : first - principles ] .",
    "the basic unit cell , periodically repeated in space , contains a suitable number @xmath214 and @xmath215 of bulk unit cells of the two materials .",
    "the microscopic charge density , @xmath147 , is defined as the superposition of all the atomic - like charge densities    @xmath216    the resulting model is illustrated for the non polar case ( @xmath217 , and @xmath218 ) in fig .",
    "[ fig : nanofun ] ; the parameters of the model are specified in the figure caption . an isolated atomic - like charge density is shown in the inset .",
    "the sizes of the layers of the two materials that constitute the multilayer can be tuned by changing the number of building blocks in the left , @xmath214 , or in the right , @xmath215 .     and @xmath218 ) .",
    "the remaining parameters have been chosen as @xmath219 , @xmath220 , @xmath221 , @xmath222 , @xmath223 , @xmath224 , @xmath225 for all the `` atoms '' , @xmath226 , and @xmath227 . within each period of the multilayer",
    ", there are 10 atomic layers of the left material and 10 of the right .",
    "only a small portion , centered at the interface , of the microscopic charge density of the supercell is shown here .",
    "inset : charge density of an individual `` atom '' on the left .",
    "atomic units are used .",
    ", width=377 ]    @xmath228 is formed from @xmath147 by convoluting it with the filter function",
    ". such convolutions are most conveniently formed by fast fourier transforms , which require the discretization of space into a uniformly - spaced grid of points .",
    "[ cc][cc]@xmath52 [ cc][cc]@xmath53 [ cc][cc]@xmath94 [ cc][cc]@xmath95     within a unit supercell for an unpolarized system .",
    "the widths of the left ( 1 ) and right ( 2 ) materials have both been set to 10 atomic layers , with interatomic separations of @xmath226 and @xmath227 .",
    "the rest of the parameters of the toy model are as in the caption of fig . [",
    "fig : nanofun ] .",
    "( b ) interface - induced charge density @xmath11 defined by subtracting the charge density of a reference system , defined as in eq .",
    "( [ eq : rho0 ] ) .",
    "the interface plane @xmath49 is positioned at the middle of the separation between the last atomic plane on the left and the first atomic plane on the right .",
    "( c ) nanosmoothed charge density @xmath229 of the microscopic charge density .",
    "the nanosmoothing function is defined as in eq .",
    "( [ eq : filterconvolution ] ) with @xmath230 , and @xmath231 , single interplanar distances along @xmath23 for each material .",
    "atomic units are used .",
    ", width=377 ]    in fig .",
    "[ fig : nanotoy](a ) we illustrate the specific toy model we shall analyze in detail for the unpolarized case .",
    "the parameters of the model are @xmath219 , @xmath220 , @xmath221 , @xmath222 , @xmath223 , @xmath224 , @xmath225 for all the `` atoms '' , @xmath226 , and @xmath227 .",
    "atomic units are used throughout the paper .",
    "first , we consider a reference density @xmath50 defined as in eq .",
    "( [ eq : rho0 ] ) , locating the interface at @xmath49 half way between the rightmost atomic layer of material 1 and the leftmost atomic layer of material 2 .",
    "@xmath11 , defined as in eq .",
    "( [ eq : deltarho ] ) , is plotted in fig .",
    "[ fig : nanotoy](b ) . next , we construct @xmath12 from @xmath10 directly using a nanosmoothing function @xmath232 defined as in eq .",
    "( [ eq : filterconvolution ] ) , in which @xmath233 , and @xmath234 .",
    "the smoothed charge density @xmath12 is shown in fig .",
    "[ fig : nanotoy](c ) . as we have already discussed in sec .",
    "[ sec : nanosmoothing - insensitivity ] , the regions @xmath97 within which @xmath121 vanishes lie within the regions @xmath96 within which @xmath235 vanishes , because smoothing @xmath109 within @xmath96 brings into @xmath121 values of @xmath109 for @xmath23 outside @xmath96 . due to the symmetry of the microscopic charge density at the center of each layer ,",
    "the interfacial charge density between material 1 and material 2 is the mirror image of the interfacial charge density between material 2 and material 1 [ see the center and the edges of the fig . [",
    "fig : nanotoy](b ) and fig .",
    "[ fig : nanotoy](c ) ] .    a closer look at the interface region is shown in fig .",
    "[ fig : nanotoy - zoom ] .",
    "the discontinuity of @xmath235 at the interface plane is clearly observed .",
    "also , we can see how @xmath235 displays large fluctuations at the atomic scale in the neighborhood of the interface due to the interface - induced relaxations of the atomic layers .",
    "the positions of the atoms in the layers close to the interface do not coincide with the positions of the atoms after the cleaving of the bulk to define @xmath47 ( see sec .",
    "[ sec : refint ] ) .",
    "therefore , in the computation of @xmath235 we are subtracting charge densities centered on different positions .",
    "the nanosmoothing procedure eliminates not only the contributions associated with @xmath47 in the bulk regions @xmath52 and @xmath53 , but it filters out the oscillations due to the interface induced relaxations while producing a continuous charge distribution .",
    "nanosmoothing @xmath109 is clearly superior to forming @xmath235 .",
    "[ cc][cc]@xmath236 [ cc][cc]@xmath237 [ cc][cc]@xmath238 [ cc][cc]@xmath239 [ cc][cc]@xmath240        in fig .",
    "[ fig : diffr ] , we show @xmath12 for three different smoothing functions , defined as in eq .",
    "( [ eq : filterconvolution ] ) with @xmath230 , and @xmath231 ; @xmath241 , and @xmath242 ; and @xmath243 , and @xmath244 , respectively .",
    "the widths of the regions where @xmath12 vanishes ( @xmath94 and @xmath95 ) depend on the width of the filter function .",
    "as a general rule , the more extended the filter function , the narrower the @xmath245 regions .",
    "although the profiles of the charge density differ significantly , the three charge distributions have the _ same _ net charge density @xmath152 and dipole moment density @xmath106 ( see table [ table : results - unpol ] ) .",
    "this striking sensitivity of the nanosmoothed charge density to the smoothing function impedes detailed physical interpretation of its features .",
    "[ cc][cc]@xmath246 [ cc][cc]@xmath247 [ cc][cc]@xmath248 [ cc][cc]@xmath249 [ cc][cc]@xmath250 [ cc][cc]@xmath251     obtained by nanosmoothing the planar average charge density @xmath10 shown in fig .",
    "[ fig : nanotoy](a ) with three different filter functions .",
    "they are defined following eq .",
    "( [ eq : filterconvolution ] ) with @xmath230 , and @xmath231 ( solid line ) ; @xmath241 , and @xmath242 ( dashed line ) ; and @xmath243 , and @xmath244 ( dotted line ) , respectively . ,",
    "width=377 ]    even though we are dealing with an unpolarized interface made of the juxtaposition of neutral and non - polar atoms , the interface charge density @xmath37 , eq .",
    "( [ eq : qu ] ) , vanishes if and only if the integration limits @xmath40 and @xmath41 are taken midway between atoms inside each material layer , meeting the requirements for symmetry described in sec .",
    "[ sec : looseinvariance ] ( see table [ table : results - unpol ] ) .",
    "@xmath55 , eq .",
    "( [ eq : deltaq ] ) , on the other hand , does not vanish since , with our criterion for locating the interface plane @xmath49 , we do not conform to the requirement that @xmath62 contains an integer number of unit cells of the left material , and @xmath58 contains an integer number of unit cells of the right material .",
    "consequently , the integral of the reference charge density @xmath47 between @xmath40 and @xmath41 carries a net charge . on the other hand , as it should",
    ", @xmath152 vanishes and is independent of the integration limits provided that @xmath40 lies in @xmath94 and @xmath41 lies in @xmath95 .    .",
    "interfacial charges and dipole moments of the microscopic interface - like charge density shown in fig .",
    "[ fig : nanotoy](a ) . the interface charge @xmath37 and the dipole - moment @xmath38 densities are defined respectively in eqs . (",
    "[ eq : qu ] ) and ( [ eq : pu ] ) and the integration limits @xmath40 and @xmath41 taken midway between the atoms at the center of each material layer .",
    "when a reference charge density of an ideal interface is subtracted , the corresponding charge @xmath55 and dipole moment @xmath56 are defined as in eqs .",
    "( [ eq : deltaq ] ) and ( [ eq : deltap ] ) with the same integration limits as before .",
    "since the nanosmoothed charge density does not play any role in the definition of @xmath37 , @xmath38 , @xmath55 , and @xmath56 , these magnitudes are insensitive to nanosmoothing . @xmath152 and @xmath106 are defined in eqs .",
    "( [ eq : bbqu ] ) and ( [ eq : bbpu ] ) . @xmath93 and @xmath91 are the lengths of the square - wave functions entering in the definition of the smoothing function , eq .",
    "( [ eq : filterconvolution ] ) . [ cols=\"^,^,^,^,^,^,^,^\",options=\"header \" , ]     [ table : results - pol ]    from the knowledge of the change of the macroscopic electric field across the interface we can determine the difference in the zero - field polarization of the two materials . assuming that in our toy model the dielectric constant of the two materials are the same and equal to 1 , then    @xmath252    since @xmath253 ,    @xmath254    but our material 2 is unpolarized , so @xmath255 , and we arrive to the conclusion that    @xmath256    this conclusion can be checked analytically in our particular toy model , where the charge density is the juxtaposition of `` atomic - like '' charge densities . integrating the first - moment of the microscopic charge density for the _ slab _ of material 1 used to build the superlattice , defined in eq .",
    "[ eq : combgauss ] ) , we arrive to the conclusion that @xmath257 , whose numerical value in our numerical example equals the polarization charge shown in table [ table : results - pol ] .",
    "a generalization for the dielectrically mismatched interface can be found in sec .",
    "f of ref . .",
    "a second toy model we shall analyze for the polarized case is shown in fig . [ fig : nanotoypolarbasis ] .",
    "it is made of a one dimensional chain in which the unit cell of material 1 has two atoms per unit cell . inside the unit cell , one of the atoms",
    "is charged negatively and the other positively so that the overall charge in the unit cell is neutral .",
    "thus , besides the electronic polarization discussed in the previous case , polarization can be induced by ionic displacements .",
    "the parameters of the model are as in fig .",
    "[ fig : nanotoypolar ] , with the exception of @xmath258 for the odd `` atoms '' ( net charge , -0.5 per site ) , @xmath259 for the even `` atoms '' ( net charge , + 0.5 per site ) , and @xmath260 , where @xmath197 runs over all the `` atoms '' of material 1 ( no displacement of the electronic cloud is considered ) .     within a unit supercell for a polarized system in which the unit cell of material 1 has two atoms of opposite charge in the unit cell .",
    "the widths of the layers of both material and the rest of the parameters of the toy model are as in the caption of fig .",
    "[ fig : nanotoypolar ] , with the exception of @xmath258 ( net charge , -0.5 per site ) for the odd atoms and @xmath259 ( net charge , + 0.5 per site ) for the even atoms of material 1 , and @xmath260 , where @xmath197 runs over all the `` atoms '' of material 1 .",
    "( b ) interface - induced deformation of the charge density @xmath261 defined as in eq .",
    "( [ eq : deltarhop ] ) . as before ,",
    "the interface plane @xmath49 is positioned at the middle of the separation between the last atomic plane on the left and the first atomic plane on the right .",
    "( c ) nanosmoothed charge density @xmath262 of the microscopic charge density .",
    "the nanosmoothing function is defined as in eq .",
    "( [ eq : filterconvolution ] ) with @xmath230 , and @xmath231 , single interplanar distances along @xmath23 for each material .",
    "atomic units are used .",
    ", width=377 ]    the main conclusions that can be drawn from fig .",
    "[ fig : nanotoypolarbasis ] are the same as in fig .",
    "[ fig : nanotoypolar ] . as we made for the electronic polarized case",
    ", we can infer the value of the bulk zero field polarization from the polarization charge at the interface , that in this case amounts to + 0.25 .",
    "the problem of how to extract from the immense detail provided by the first - principles calculations , with resolution at the atomic scale , reliable values of physical quantities of interest which enter into nanoscale electrostatic analysis has been reviewed .",
    "this problem is particularly challenging in the case of interfaces between quite different materials , since all the relevant magnitudes ( interface charge and dipole densities , screening lengths , etc . )",
    "are overwhelmed by the large and rapid oscillations of the microscopic charge density .",
    "the different procedures to filter out the periodic oscillations of the microscopic quantities , which typically follow the underlying atomic structure , preserving only those features that change in the vicinity of a surface or interface are critically analyzed , and the criteria under which they accurately extract the quantities of interest are discussed .",
    "the approach of defining a reference interface charge density from the bulk unperturbed charge densities of each material is spoilt by the fact that the interface position is undetermined .",
    "the profile of the charge density at the interface is discontinuous and displays large fluctuations in the neighborhood of the interface due to the interface - induced atomic relaxations . moreover ,",
    "both the interface charge and dipole densities ( and so the potential drop at the interface ) are not unique in this approach , since they depend critically on the position of the interface .",
    "a clearly superior method consists in nanosmoothing the microscopic charge density by taking its convolution with a filter function .",
    "this procedure eliminates the contributions coming from the bulk together with the oscillations due to the interface - induced relaxations while producing a continuous charge distribution .    in this work , we prove rigorously that the interface charge and dipolar densities are independent of the nanosmoothing function used provided the following conditions are met : @xmath4 it is positive definite , even and normalized within the support region of space within which it is defined [ eqs .",
    "( [ eq : filterfuna])-([eq : filterfund ] ) ] ; @xmath5 it must be sufficiently smooth itself for the poisson equation to remain invariant after nanosmoothing . by `` sufficiently smooth ''",
    "we understand that the second derivative must exist , and both the function and the first derivative must vanish at the end points . [ eqs .",
    "( [ eq : conditionf1])-([eq : conditionf3 ] ) ] ; @xmath59 in practice the convolution is done using fast fourier transforms . therefore , although the nanosmothing function might violate some of the previous conditions , the family of the finite fourier series involved in the convolutions is a distribution which converges to the smoothing function in the limit , meeting all the requirements along the way .",
    "@xmath263 if square - wave filter functions ( or convolutions of them ) are chosen as filtering functions , the width of each filter function @xmath93 and @xmath91 must be integral numbers of the lattice constant of each material in order to have charge and dipole moment densities ( and therefore potential shifts across the interface ) insensitive to the smoothing function ; @xmath264 the smallest acceptable value for @xmath93 and @xmath91 should be used in order to avoid the presence of multiple maxima and minima in the smoothed charge density ; @xmath265 the total width of the filter function @xmath76 should be chosen on the scale of the unit cell length or larger , but significantly smaller than the regions @xmath96 of each material where the microscopic charge density is unaffected by the presence of the interface ; @xmath266 after nanosmoothing , the charge density displays two regions @xmath267 , within the @xmath96 , where the smoothed charge density @xmath268 vanishes .",
    "the integration limits @xmath40 and @xmath41 used to compute the interface charge and dipole densities must lie in these regions ; @xmath269 once the integration limits are chosen , the charge density at the interface computed from the microscopic and the nanosmoothed charge density are equal if and only if the microscopic charge density is symmetric for @xmath270 . the interface dipole density computed from the microscopic and the nanosmoothed charge density are never equal ; @xmath271 nanosmoothing is only valid for computing charge and dipole moment densities .",
    "nothing can be said about the shape of the nanosmoothed charge density at the interface since it depends critically on the filter function ; @xmath272 by using the smallest acceptable values of @xmath93 and @xmath91 , generally one unit cell length , reasonable estimates of the density of the charge transferred across the interface and of dipole - layer width can be made .",
    "the nanosmoothing procedure is a powerful technique that allows us to extract the information relevant for computing the change in the average potentials and charge densities from one side of the interface to the other , opening the door to the calculations of band offsets , @xcite polarization @xcite and dielectric permittivity @xcite profiles , effective charges , @xcite and force constants @xcite in semiconductor - semiconductor interfaces , and depolarizing electric fields and screening lengths in real ferroelectric capacitors .",
    "@xcite the present work sets the basis for a rigorous selection of the minimum size of the supercell required to obtain accurate and smoothing - independent results .",
    "the authors are indebted to richard m. martin for very clarifying discussions .",
    "jj acknowledges finantial support of the spanish ministery of science and education through the `` ramn y cajal '' program , mec grants .",
    "mat2005 - 00107 and fis2006 - 02261 , the nsf mrsec grant no .",
    "dmr-00 - 80008 , and the arc discovery grant dp 0666231 .",
    "the microscopic poisson equation is written as    @xmath273    integrating both sides of eq .",
    "( [ eq : micropoisson ] ) in the @xmath274 plane and dividing by the surface @xmath27 of the interface unit cell , we get    @xmath275    we now write out the integral of the left - hand - side of eq .",
    "( [ eq : planpoisson ] ) explicitly ,    @xmath276    the first two integrals on the right - hand - side can be performed trivially ,    @xmath277    where @xmath278 refers to the two intersections of the boundary of the unit cell with the @xmath279 axis . since the potential and all its derivatives are periodic in the plane , the previous integral vanishes .",
    "the same holds for the second integral in the right - hand - side of eq .",
    "( [ eq : decompxyz ] ) .    regarding the third integral in eq .",
    "( [ eq : decompxyz ] ) , we can take the second derivative with respect @xmath23 out of the integral ,    @xmath280    gathering together the results of eqs .",
    "( [ eq : planpoisson ] ) through ( [ eq : derz ] ) we can conclude that    @xmath281    that is , the transverse average of the poisson equation yields a one - dimensional poisson equation for the transverse average of the potential .",
    "applying the nanosmoothing procedure to the electrostatic potential @xmath282 results in    @xmath283    where @xmath284 is the planar average of the of @xmath282 in planes parallel to the interface ,    @xmath285    and @xmath286 vanishes for @xmath287 and @xmath288 . taking the second derivative of the nanosmoothed potential and requiring that @xmath289 exists yields    @xmath290      \\nonumber \\\\      & = \\int_{z - l}^{z+l } dz^ { ' } \\ : \\frac{d^{2 } f ( z - z^ { ' } ) } { dz^{2 } } \\ :          \\overline{v } ( z^ { ' } )       \\nonumber \\\\      & = \\int_{z - l}^{z+l } dz^ { ' } \\ :           \\frac{d^{2 } f ( z - z^ { ' } ) } { d { z^{'}}^{2 } } \\ :          \\overline{v } ( z^ { ' } )       \\nonumber \\\\      & = \\left .",
    "\\frac{d f ( z - z^ { ' } ) } { d z^ { ' } }       \\overline { v } ( z^ { ' } ) \\right|_{z - l}^{z+l } -       \\int_{z - l}^{z+l } dz^ { ' } \\ : \\frac{d f ( z - z^ { ' } ) } { d z^ { ' } } \\ :      \\frac{d \\overline{v } ( z^ { ' } ) } { d z^ { ' } } .",
    "\\label{eq : nanopoisson-1 }   \\end{aligned}\\ ] ]    requiring that    @xmath291    makes the first term in the right hand side of eq .",
    "( [ eq : nanopoisson-1 ] ) vanish . integrating the second term in the right hand side of that equation yields    @xmath292    so that we arrive at the conclusion that    @xmath293",
    "the formal solution of the poisson equation , eq .",
    "( [ eq : poissonnanosmoothed ] ) , is        @xmath295       - z_{1 } \\left [ \\int_{-\\infty}^{z_{1 } }       dz^ { ' } \\overline{\\overline{\\rho } } ( z^ { ' } ) -       \\int_{z_{1}}^{\\infty }       dz^ { ' } \\overline{\\overline{\\rho } } ( z^ { ' } )      \\right ]       \\right\\}.      \\label{eq : deltav }   \\end{aligned}\\ ] ]    the location of the points at @xmath296 are thus far unspecified .",
    "they can both be chosen at an image of @xmath40 or of @xmath41 within the unit cell without loss of generality since all the relevant computational procedures require periodicity . in that case , all four integrals within the square brackets of eq .",
    "( [ eq : deltav ] ) vanish because of overall electrical neutrality and of the choice of @xmath40 and @xmath41 at the microscopic unit cell boundaries , with eq .",
    "( [ eq : relshiftdip ] ) following ."
  ],
  "abstract_text": [
    "<S> the interface properties of interest in multilayers include interfacial charge densities , dipole densities , band offsets , and screening - lengths , among others . </S>",
    "<S> most such properties are inaccesible to direct measurements , but are key to understanding the physics of the multilayers . </S>",
    "<S> they are contained within first - principles electronic structure computations but are buried within the vast amount of quantitative information those computations generate . </S>",
    "<S> thus far , they have been extracted from the numerical data by heuristic nanosmoothing procedures which do not necessarily provide results independent of the smoothing process . in the present paper </S>",
    "<S> we develop the theory of nanosmoothing , establishing procedures for both unpolarized and polarized systems which yield interfacial charge and dipole densities and band offsets invariant to the details of the smoothing procedures when the criteria we have established are met . </S>",
    "<S> we show also that dipolar charge densities , i. e. the densities of charge transferred across the interface , and screening lengths are not invariant . </S>",
    "<S> we illustrate our procedure with a toy model in which real , transversely averaged charge densities are replaced by sums of gaussians . </S>"
  ]
}