{
  "article_text": [
    "solar filaments , called prominences when they appear above the solar limb , are important magnetized structures containing cool and dense plasma embedded the hot solar corona .",
    "typically , a filament is 100 times cooler and denser than its surrounding corona .",
    "they are particularly visible in h@xmath0 observations , where they often appear as elongated dark features with several barbs @xcite .",
    "filaments are always aligned with photospheric magnetic - polarity inversion lines @xcite and are located at a wide range of heliocentric latitudes .",
    "this characteristic makes filaments suitable for tracing and analyzing the solar magnetic fields @xcite .",
    "moreover , filaments sometimes undergo large - scale instabilities , which break their equilibria and lead to eruptions , so they are often associated with flares and coronal mass ejections ( cmes ) @xcite .",
    "therefore , both case study and statistical analysis of filaments are important and significant .    with the rapid development of the telescopes , both time cadences and spatial resolutions of the observations are becoming higher and higher .",
    "as a consequence , we have to deal with a vast amount of data , and automated detection is an efficient way to derive the features of interest in the observations . in terms of solar filaments ,",
    "a number of automated filament detection methods and algorithms have been developed in the past decade .",
    "for example , combined the intensity threshold and region growing methods in order to develop an algorithm to automatically detect the growth and the disappearance of filaments . adopted local and global thresholding and employed morphological closing operations to identify filaments .",
    "utilized morphological  hit or miss \" transformation and calculated euclidean distance to get the filament spines . developed an algorithm based on a geometric method , which was recently updated by , to determine the filament chirality in addition to the locations , where they confirmed the hemispheric rule of the filament chirality .",
    "based on the sobel operator , applied an adaptive threshing method to detect and derive various parameters of filaments .",
    "employed morphological methods , while applied the support vector machine ( svm ) method to detect euvi 304  prominence above the solar limb .",
    "designed a cascading hough circle to determine the center location and the radius of the solar disk , and further to find the filament spines based on graph theory .    in this paper , we present an efficient and versatile automated detecting and tracing method for solar filaments .",
    "it is able not only to recognize filaments , determine their features such as the position , the area , the spine , and other relevant parameters , but also to trace the daily evolution of the filaments . in section  [ preproc ] we describe image preprocessing before detecting filaments .",
    "the filament detection algorithm based on the canny edge - detection method and connected components process are given in section  [ detection ] .",
    "a detailed description of the feature recognition algorithm is given in section  [ feature ] .",
    "the tracing algorithm is explained in section  [ tracing ] .",
    "the performance of our program is described in section  [ performance ] .",
    "finally , statistical results about the filament latitudinal distribution based on the h@xmath0 archive of mauna loa solar observatory ( mlso ) are presented in section  [ results ] before the conclusions are drawn in section  [ conclusion ] .",
    "the raw image preprocessing consists of five steps , which are explained one by one in the following subsections .",
    "the full - disk h@xmath0 images that we processed are mainly downloaded from the mlso website ( http://mlso.hao.ucar.edu ) .",
    "each image has a size of 1024@xmath21024 pixels and is taken by the _ polarimeter for inner coronal studies _ ( pics ) .",
    "the pixel size of the image is 2.9@xmath3 .",
    "the mlso h@xmath0 data archive provides two types of images : one has a limb - darkening correction applied along with contrast enhancement , the other is the raw data .",
    "our program can process both the  fits \" format and the web image formats such as  gif \" and  jpeg \" .      the limb - darkening effect , _ i.e. _ the intensity drops towards the solar limb , may cause false detections .",
    "we should remove it first .",
    "some observatories such as mlso , also provide limb - darkening corrected images .",
    "a polynomial fitting method of keith pierce @xcite is adopted to remove the limb - darkening effect :    @xmath4    where @xmath5 is the corrected intensity and @xmath6 is the intensity in the raw images , @xmath7 is the angle between the local radial direction and the line of sight , @xmath8 and @xmath9 are the fitted constants for the h@xmath0 wavelength at 6563  .",
    "since the solar disk is only a part of the entire image , surrounded by a large part of the sky background , we need to remove the background in order to process the solar disk only , which can reduce the processing time and the storage space .",
    "the method for the disk extraction is simple : we just find the left , the right , the top , and the bottom ranges of the solar disk",
    ". then we get the sub - image according to these ranges .",
    "an example is shown in figure  [ mlso_pre](b ) .",
    "morphological image processing is a type of processing in which the spatial forms or the structures of the objects within an image are modified @xcite .",
    "erosion , dilation , opening ( erosion followed by dilation ) , and closing ( dilation followed by erosion ) are the basic operators in the morphological concepts that have been extended to work with gray - scale images for image segmentation and enhancement .",
    "sometimes we get the images where the boundaries of filaments are not very clear . in order to make more accurate segmentation of the filament structure ,",
    "it is necessary to enhance the image to increase the intensity contrast between the filament and non - filament structures .",
    "we use the morphological top - hat transformation to enhance the images .",
    "the algorithm is composed of three steps :    * i ) * to compute the morphological opening of the image with the top - hat filtering and then to subtract the result from the original image ;    * ii ) * to compute the morphological closing of the image with the bottom - hat filtering and then to subtract the result from the original image ;    * iii ) * to add the top - hat filtered image to the original image , and then to subtract the result from the bottom - hat filtered image .    as a result",
    ", we can get an enhanced image , as shown in figure  [ mlso_pre](c ) .",
    "* *    * *      on the solar disk in h@xmath0 , besides the dark features such as filaments and sunspots , there are some other bright features such as plages and flares .",
    "many authors used local threshold method to filter out these non - interesting features .",
    "actually , after limb - darkening removal and top - hat filtering , we can easily distinguish the filaments from these non - filament structures in the gray - scale images via the global threshold method.we tested several hundred images to find the appropriate global threshold value .",
    "for mlso images , we found that the threshold value is about 95100 .",
    "the algorithm is simple : if the pixel s value is greater than the threshold value , we assign it to be 255 , which means white in the image .",
    "an example is shown in figure  [ mlso_pre](d ) .",
    "segmentation of an image entails the division or separation of the image into regions of similar attributes @xcite .",
    "the most basic attribute for segmentation is the intensity level for a gray - scale image and color components for a color image .",
    "in addition , the image edge is also a useful attribute for segmenting.it is possible to segment an image into regions of common attribute by detecting the boundary of each region across which there is a significant change in intensity .",
    "we adopt the most powerful edge - detection method , _",
    "i.e. _ the canny method @xcite , to identify filaments .",
    "the canny method differs from other edge - detection methods in that it uses two different thresholds : one for detecting strong edges and the other for weak edges .",
    "the weak edges are included in the output only if they are connected to strong edges .",
    "compared to others , this method is therefore less fooled by noise , and is more likely to detect true weak edges @xcite .",
    "the canny method works in a multi - step process :    * step 1 : * noise reduction .",
    "because the canny edge detector is susceptible to noise present in the image data , the image should be smoothed first . in our method , each image after preprocessing is smoothed by gaussian convolution as follows ,    @xmath10    @xmath11    where @xmath12 is the 2d gaussian filter ; @xmath13 is the input image and @xmath14 is the output image which is convolved with the 2d gaussian filter ; ( @xmath15 ) is the position in the @xmath16@xmath17 plane of the image .",
    "we choose @xmath18 in our processing .    * step 2 : * finding gradients .",
    "the edges usually can be found at those places where the gray - scale intensity drastically changes .",
    "it means that we can find them by checking the gradient at each pixel in the image .",
    "the first is to get the gradient in the @xmath16-direction @xmath19 and @xmath17-direction @xmath20 , respectively , by applying the derivative of a gaussian filter :    @xmath21    @xmath22    where @xmath23    @xmath24    then we use the following two equations to determine the gradient magnitude and the direction of the edge :    @xmath25    @xmath26    * step 3 : * non - maximum suppression . for an image array ,",
    "the edge direction angle is rounded to one of four angles representing vertical , horizontal and the two diagonals ( _ i.e. _ 0 , 45 , 90 , 135 , 180 , 225 , 270 , 315 and 360 degrees ) , corresponding to the use of an 8-connected neighbourhood .",
    "then , for each pixel of the gradient image , we compare the edge gradient magnitude of the current pixel with the edge gradient magnitude of the pixel along the gradient direction . for example , if the gradient direction is to the northeast , the pixel should be compared with the pixels to the northeast and to the southwest",
    ". if the edge gradient magnitude of the current pixel is the largest one , we mark it as one part of the edge . if not , we suppress it , _",
    "i.e. _ it is ignored .",
    "* step 4 : * edge tracing by hysteresis .",
    "after step 3 , many of the remaining edge pixels would probably be the true edges of filaments , but some may be caused by noises .",
    "the canny method uses thresholding with hysteresis to determine whether the edges obtained in step 3 are true or not .",
    "the algorithm adopts two thresholds , _",
    "i.e. _ high and low thresholds : if the edge pixel s gradient magnitude is higher than the high threshold , the pixel is marked as a strong pixel ; if the edge pixel s gradient magnitude is lower than the low threshold , the pixel will be suppressed ; if it is between the two thresholds , the pixel will be marked as a weak one .    in order to find the thresholds , we use an automatic method : first , we should provide a probability of the pixels that are not the edge points and calculate the number of pixels that may not be the edge points in the entire image by the probability ; then we increase the gradient threshold until the total number of the pixels with the gradient smaller then the threshold is just greater than the probability value , then the current gradient threshold is chosen as the high threshold .",
    "the low threshold is about half of the high one . in our process",
    "the probability is chosen to be about 0.98 , and the low threshold is 0.4 times the high threshold .",
    "after tracing through the entire image we have strong and weak pixel arrays which can be treated as a set of edge curves .",
    "the weak edges are included if and only if they are connected to strong edges .",
    "we scan the entire binary image to find the pixels where strong and weak edges overlap each other and finally get the edge map .",
    "then , the morphological thinning operation @xcite is applied to minimize the connected lines in order to get accurate and fine edges .    after applying the canny edge - detection method",
    ", we get the edge of each filament , as shown in figure  [ mlso_detection](a ) .    * *      after segmentation process , in the computer vision the image is still an array of pixels .",
    "we are not interested in each pixel but the special region ( _ i.e. _ the filament ) constituted by the pixels .",
    "these regions are called the connected components of the binary images , which are more complex and have a rich set of properties ( _ i.e. _ shape , position , and area ) .",
    "we use a classical method @xcite to realize the connected component labeling .",
    "it means that the pixels in a connected component are given with the same identity label . after connected component labeling",
    ", the product we get is changed from pixels to regions that we are interested in .",
    "the input binary images are of 8-connectivity , and the algorithm consists of the following two steps :    in the first step , the algorithm goes through each pixel from left to right and from top to bottom , as indicated by the arrows shown in figure  [ connect_component_label](a ) .",
    "it checks the labels of four neighboring pixels that are north - east , north , north - west and west of the current pixel .",
    "for example , suppose the current pixel is @xmath27 as shown in figure  [ connect_component_label](a ) , the code checks the labels of four pixels that are @xmath28 , @xmath29 , @xmath30 , and @xmath31 :    \\i ) if all four neighbors are not assigned , a new label is assigned to the current pixel .",
    "an example is shown in figure  [ connect_component_label](b ) : supposing that the value of the current pixel is 1 and the values of the four neighbors are 0 ( 0 means this pixel is a background pixel , and 1 means the pixel is the foreground ) , it means a new filament is encountered . if the previous label is  2 \" , we assign label  3 \" to the new filament .",
    "\\ii ) if one of the four neighbors has been labeled before , we assign the neighbor s label to the current pixel .",
    "an example is shown in figure  [ connect_component_label](c ) : one of the four neighbors has been labeled , _",
    "i.e. _ the north neighbor has been labeled  3 \" , so we assign the same label to the current pixel .",
    "\\iii ) if more than one of the neighbors have been labeled before , we assign the smaller label to it .",
    "an example is shown in figure  [ connect_component_label](d ) : two neighbors have been labeled , _ i.e. _ the north - east and west neighbors .",
    "the label of north - east neighbor is  3 `` , which is smaller than the west neighbor s , so we use ' ' 3 \" to assign the current pixel .    after completing the scanning ,",
    "the equivalent label pairs are sorted into equivalence classes and a unique label is assigned to each class .    in the second step",
    ", the above algorithm goes through again , during which each label is replaced by the label assigned to its equivalence class . after completing the scanning ,",
    "a unique label is assigned to each equivalence class . in other words",
    ", we have assigned each filament a unique label .      actually , it is not easy to distinguish between sunspots and filaments by gray - scale levels .",
    "the labeled  filaments \" so far may include some sunspots .",
    "thus , we have to separate real filaments from sunspots by use of geometric structures : the size and the long - to - short - axis ratio of the filament.a candidate with the size ( e.g. the perimeter ) larger than the threshold is considered to be a filament .",
    "in the case that the size of the labeled object is smaller than the size threshold , only if the ratio of the long axis to short axis is larger than a given value , the candidate is treated as a small filament ; otherwise it would be removed .",
    "we have got the edge of each filament whose length can be treated as the filament perimeter .",
    "we set the perimeter threshold to be 25 pixels , and the long - to - short - axis ratio threshold being 2 in our procedure .",
    "an example is shown in figure  [ mlso_detection](b ) .",
    "the filament label should be updated after removing the sunspots .",
    "then each filament is labeled with a unique number .",
    "an example is shown later in figure  [ mlso_update](a ) .",
    "this method is used to filter out sunspots . with the same method",
    ", we can filter out other features .",
    "in other words , we can adopt the method to automatically detect sunspots , which will be implemented in our future work .",
    "as mentioned above , we have the filament edge , which can be easily used to derive the filament perimeter after the connected component process .",
    "it is done by the integration of the distance connecting neighboring pixels along the edge of each filament .",
    "we choose the geometric center of each filament , _",
    "i.e. _ the centroid , as the location of the filament .",
    "first , we find the centroid of a filament ( @xmath32 ) , _ i.e. _ we calculate the average of the abscissa and the ordinate of all the filament pixels .",
    "since filaments follow the solar rotation and the rotation axis wobbles with time , the position of a certain filament has an elliptic orbit in the plane of the sky . in order to get the longitude and the latitude of the filament in the heliographic coordinates , we use the solar software routine  xy2lonlat.pro \" .",
    "it is noted that the center of the solar disk we used here is not that provided in the header of the  fits \" file .",
    "after the canny edge detection , besides the locations of the filaments , we also got the boundary of the solar disk , and it is the biggest connected component after the connected component processing .",
    "we fit the circle and calculate the geometric center of the fitted circle , which is the exact center of the solar disk .",
    "* *      in our process , the area of a filament is the integration of the pixel area divided by the cosine of the heliocentric angle , where the integration is taken in the area enclosed by the edge curve .",
    "we use the foreground color ( white ) to fill the edge curve so that the pixels inside the curve become white , then the white pixels constitute the filament area . the algorithm is based on morphological reconstruction @xcite .",
    "the edge curve with holes is filled with white pixels .",
    "the hole is a set of background pixels ( _ i.e. _ black pixels ) surrounded by foreground pixels ( white pixels ) .",
    "an example is given in figure  [ mlso_feature](a ) and an extracted filament example is shown in figure  [ feature_example](c ) .",
    "the morphological skeletonization method is adopted to get the filament spine , which is a stick - like skeleton , spatially placed along the medial region of the filament .",
    "the skeleton is a unit - wide set that contains only the pixels that can be removed without changing its topology @xcite .",
    "iterations of the morphological - thinning operation are employed for the skeleton method @xcite .",
    "assuming that the input binary image is @xmath33 ( _ i.e. _ a matrix only has values of 0 and 1 ) , the details of the method are described below :    first , the thinning processing of @xmath33 by structuring - element pair @xmath34 is defined as    @xmath35    where @xmath36 is the morphological thinning operator , @xmath37 and @xmath38 must satisfy @xmath39 , where the symbol @xmath40 represents the empty set .",
    "@xmath41 , _ i.e. _ the hit - and - miss transformation of set @xmath33 by @xmath34 , is defined by    @xmath42    where @xmath43 is the hit - and - miss transformation operator , @xmath44 the intersection operator , @xmath45 the complement of @xmath33 and the symbol @xmath46 denotes the morphological erosion operator .    then , using the sequence of eight structuring - element pairs as shown in figure  [ jk_array ] to iteratively process the thinning operation :    @xmath47 \\oslash ( j_{2},k_{2})\\ }      \\oslash \\ldots \\oslash ( j_{8},k_{8 } ) ) . \\ ] ]    we let @xmath48 , which is firstly thinned by the structure - element pair @xmath49 , and then by @xmath50 , ",
    ", @xmath51 , the thinned result is defined as @xmath52 .",
    "such a process is repeated in order to get @xmath53 , @xmath54 ,  , @xmath55 .",
    "finally , the thinning process repeats until @xmath56 , _",
    "i.e. _ the filament skeleton is the final structure that can not be thinned any more .",
    "actually , some of the resulting filament skeletons still contain small barbs .",
    "we use the morphological hit - and - miss transformation to find the endpoints that constitute the barbs , and then remove the barbs .",
    "this process may iterate several times because some of these points may not be removed in one go . in our process",
    "it is iterated four times .",
    "the filament spines on the whole sun are shown in figure  [ mlso_feature](b ) and an extracted filament example is shown in figure  [ feature_example](c ) .",
    "the tilt angle is defined as the fitted filament spine orientation with respect to the solar equator .",
    "after we get the spine , we use a linear polynomial to fit it , by which we calculate the slope @xmath57 .",
    "the tilt angle is @xmath58 .",
    "a filament may consist of several fragments .",
    "thus , the filaments we obtained after the previous processing may not be the real individual filaments , with some being fragments of one filament . we adopt a  distance criterion \" in order to find the fragments belonging to a single filament .",
    "the method is the same as the  labelling criterion \" filament tracking method used by , which is explained as follows : for a certain filament or filament fragment , we compare it with all other fragments .",
    "the fragments would be recognized to belong to a common filament if the two fragments lie within the distance threshold .",
    "the process is iterated until all fragments are checked .",
    "the filaments in the new image are compared with those in the previous image . the experiential distance threshold in our processing",
    "is taken to be 60 pixels for the mlso data .",
    "after this process , the fragment labels will be updated ; if several fragments belong to a common filament , the label should be unified , as shown in figure  [ mlso_update](b ) .",
    "for example , filament fragments number 11 and 15 in figure  [ mlso_update](a ) are recognized as one filament , thus they are updated with the same label number 7 . for the update of the area , perimeter , and the length of spine , we just calculate the sum of each fragment with the same label , while the position and the tilt angle must be reprocessed .",
    "another criterion for identifying a broken filament is to compare the tilt angle of the fragments , _",
    "i.e. _ if the neighboring candidates have similar tilt angles , they could be considered as one big filament .",
    "this method works fine for the magnetic inversion lines that are not strongly curved , and will be incorporated in our future version .    *",
    "*    * *    * *",
    "tracing the evolution of the filament is important for understanding the physical nature and the solar cyclic variation of the filaments . in this section",
    "we present a tracing method . here",
    "we use the filament label , position and area as the input parameters , which have been obtained in section  [ feature ] , to trace the daily evolution of the filaments .",
    "we define two input images as @xmath59 ( _ i.e. _ the image observed at the old time ) and @xmath60 ( _ i.e. _ the image at the new time ) . the main steps of the tracing method are as follows :    * i ) * we obtain the observation time of the two images @xmath59 and @xmath60 , then calculate the time interval @xmath61 ;    * ii ) * using the latitude from the position features of each filament in @xmath59 ( or @xmath60 ) in order to calculate the rotation velocity at this latitude @xmath62 ( or @xmath63 ) , then calculate the possible longitude @xmath64 ( or @xmath65 ) with the time interval @xmath61 . here the @xmath65 is calculated by assuming that the sun rotates backward ;    @xmath66    @xmath67    where @xmath68 ( or @xmath69 ) is the current longitude of @xmath70-th ( or @xmath71-th ) filament in @xmath59 ( or @xmath60 ) . here , we adopt the solar rotation angular velocity formula @xcite to determine @xmath72 and @xmath73 :    @xmath74    where @xmath75 is the angular velocity ( degrees per day ) and @xmath7 the latitude ;    * iii ) * we obtain the possible position [ @xmath76 of the filament after @xmath61 via the differential rotation formula , then calculate the distance @xmath77 between @xmath78 and real current position [ @xmath79 of the filament in @xmath60 . because the drift velocity of the filament is much smaller than the solar rotation velocity , we assume the filament latitude does not change in @xmath59 ( _ i.e. _ @xmath80 , @xmath81 is the possible latitude and @xmath82 is the current latitude in @xmath59 ) .",
    "the distance @xmath77 between @xmath78 and @xmath83 is :    @xmath84    * iv ) * we assume that the sun rotate backward , then obtain the possible position of the filament [ @xmath85 after @xmath61 .",
    "a processing which is similar to 3 ) is processed , the distance @xmath86 between @xmath87 and @xmath88 is :    @xmath89    * v ) * for each filament in @xmath60 , we check all of the filaments in @xmath59 . only if one meets the following three conditions , the filament in @xmath59 would be considered to be the same filament and marked with the same label as in @xmath60 :    * condition 1 : * @xmath90 ;    * condition 2 : * @xmath91 ;    * condition 3 : * @xmath92    where @xmath93 and @xmath94 are the distance threshold . in our program",
    "we take @xmath95 pixels day@xmath96 .",
    "@xmath97 and @xmath98 are the filament area at the old and new times , respectively .",
    "condition 3 gives the maximum proportion of the deformation , _",
    "i.e. _ less than the specified @xmath99 of the size of the previous filament . here",
    "we set @xmath100 .",
    "if the three conditions are not satisfied , the filament at the new time would be identified as a new filament and given a new label .",
    "this step continues until all filaments in @xmath60 are treated .",
    "finally , the filament labels in @xmath60 are updated .",
    "figure  [ mlso_trace ] gives an example of our tracing method , where panel ( a ) shows the detected result of the earlier image with each filament labeled a unique number , panel ( b ) depicts the filament fragments after detection , penel ( c ) shows the updated filaments where several fragments merged into one filament , and panel ( d ) shows the tracing result based on the earlier image in panel ( a ) .",
    "for example , the filament 2 in the earlier image ( panel a ) is split into three fragments ( labeled 2 , 4 , and 5 in the later image ( panel b ) . after using the tracing method ,",
    "they were labeled the same number in the earlier image ( panel a ) .",
    "filament 13 in the later image ( panel d ) was not detected in the earlier image ( panel a ) , so it was given a new number .",
    "our code was developed by using @xmath101 desktop tools and development environment on a desktop computer ( cpu : @xmath102 duo 3.00 ghz ) .",
    "after processing of each image file , the result ( such as the label , the position , the area , and other features ) are written to a text file .",
    "the average processing speed is 1 second for the filament detection in a single image and 3.5 seconds for the filament detection and tracing in two images .",
    "we randomly selected 100 images from the mlso h@xmath0 archive for testing , and compared the automated result with the manual ones . for filaments and filament fragments",
    ", the two methods are overlapping by @xmath103 and @xmath104 , respectively .",
    "the error includes two types of false recognition : one is that there is a manually recognized filament , but the automated method can not detect it . the other is that the automated method detects a filament , but it does not appear on the real solar disk . it is noted that the latter is rarely seen in our method .",
    "if a filament splits into several small fragments , and the criterion of the ratio of the long to short axes is not satisfied ( _ i.e. _ being recognized as a sunspot ) , our method may miss these fragments .",
    "the accuracy of the filament fragment number is a little higher than that of the filament , which is due to the prescribed  distance criterion \" .",
    "sometimes several filaments or filament fragments in one active region are so close to each other and within the  distance criterion \" , they are recognized as one filament .",
    "this kind of false recognition does appear in our filament fragment detection and we have to improve the filament fragments merging method in the future . for other features such as position , perimeter , area , and spine , there are no standard criteria to test the accuracy of the results processed by our codes .",
    "however , we defined two indices in order to test the performance of our method , _",
    "i.e. _ the  edge closed rate \" and the  area fully filled rate \"",
    "edge closed rate \" is defined as the number of detected filaments with edge curve closed as a percentage of the total number of detected filaments among the 100 test images .",
    "we found that the rate is 91% .",
    "this rate mainly depends on the selection of the threshold in the threshold filter processing and the two thresholds in the canny edge - detection method .",
    "if the filament edge curve is not closed , it leads to low detection accuracy and affects the subsequent processing .",
    "the  area fully filled rate \" is defined as the number of the detected filaments with edge curve fully filled with foreground pixels as a percentage of the total number of detected filaments among the 100 test images , and the rate is 75% .",
    "after the edge detection is finished , if the edge curve is not closed , the morphological object filling method could not fully fill in the area enclosed by the edge curve .",
    "this leads to the decrease in  area fully filled rate \" and the detection accuracy rate .",
    "the filament spine is also affected by the area problem , _",
    "i.e. _ if the area is not fully filled , our method may get a wrong topology of the filament after the morphological skeletonization processing .",
    "furthermore , if the barbs are located near the end of the filament spine or the filament size is relatively small , the recognized spine may be shorter than the real length after the morphological barb removal processing .",
    "the shorter the time interval is , the higher the tracing accuracy is . here , we set the default time interval to be about one day , the accuracy of the tracing method is about 80% .",
    "in addition , we also test images from big bear solar observatory ( bbso ) h@xmath0 archive ( ftp://ftp.bbso.njit.edu/pub/archive ) to validate the versatility of our method .",
    "the results are similar and satisfactory .",
    "we use our automated method to analyze 3470 images obtained by mlso from january 1998 to december 2009 . in this section ,",
    "we present the statistical results of the evolution of the filament latitudinal distribution because of its relatively high accuracy .",
    "furthermore , from a statistical point of view , such results can be significant in understanding the cyclic migration of solar filaments .      for the period from january 1998 to december 2009",
    ", we process one image per day and have detected 13,832 filaments . the temporal evolution of the latitudinal distribution of these filaments is depicted as the scatter plot in figure  [ bfd_f ] ( each dot represents a single observation ) , where we can clearly see a butterfly diagram , similar to sunspots .",
    "because of the lack of observations in some periods , there are several white vertical gaps in the butterfly diagram . from the diagram",
    "we can see the distribution and the migration of the filaments .",
    "this butterfly diagram indicates that the formation of the filaments mainly migrates towards the equator from the beginning to the end of the solar cycle 23 .      from the butterfly diagram",
    "we only get qualitative results , as mentioned by . in order to make a quantitative analysis",
    ", we adopt the monthly mean latitude of the filaments in the northern and southern hemispheres , respectively .",
    "the calculated results are plotted in figure [ mm_total ] .",
    "it can be seen that the monthly mean latitudinal distribution of the filaments has three drift trends : from 1998 to the solar maximum ( 2001 ) the drift velocity is very fast . after the solar maximum",
    "it becomes relatively slow .",
    "after 2006 , the drift velocity becomes divergent .",
    "a linear fitting is used to the data points in different periods , resulting in an average drift velocity being 0.0138 degree day@xmath96 , or 1.86 m s@xmath96 , during 19982001 , and 0.0017 degree day@xmath96 or 0.23 m s@xmath96 during 20022006 in the northern hemisphere .",
    "it is 0.0134 degree day@xmath96 , or 1.80 m s@xmath96 during 19982001 and 0.0029 degree day@xmath96 , or 0.39 m s@xmath96 during 20022006 in the southern hemisphere . here",
    ", we did not fit the monthly mean filament distribution after 2006 , because it becomes divergent near the solar minimum .",
    "since the normal solar activity is usually applied to the events with latitudes lower than @xmath1 @xcite , we analyze the filaments with latitudes lower than @xmath1 .",
    "the calculated result is plotted in figure  [ mm_0 - 50 ] .",
    "it can be seen that the monthly mean latitudinal distribution of these filaments again has three drift trends : from 1998 to the solar maximum ( 2001 ) the drift velocity is fast , _",
    "i.e. _ 0.0123 degree day@xmath96 or 1.66 m s@xmath96 in the northern hemisphere and 0.086 degree day@xmath96 or 1.16 m s@xmath96 in the southern hemisphere . after the solar maximum",
    "the drift velocity becomes relatively slow , _",
    "i.e. _ 0.0022 degree day@xmath96 or 0.29 m s@xmath96 in the northern hemisphere and 0.0010 degree day@xmath96 or 0.13 m s@xmath96 in the southern hemisphere , respectively .",
    "after 2006 it becomes divergent .",
    "these results are similar to those of the entire latitudinal distribution .",
    "the reason is easy to understand : among the 13,832 filaments we detected , only 1,130 filaments have latitudes higher than @xmath1 . in other words ,",
    "the detected filaments are mainly distributed in latitudes lower than @xmath1 .",
    "there is no obvious difference between the northern and the southern hemispheres .",
    "these results are similar to the statistical results of .",
    "similarly , we plot the monthly mean latitude of the filaments with latitudes higher than @xmath1 in figure  [ mm_50 - 90 ] .",
    "however , no clear trend is discernible .    in order to find the migration of the individual filaments above @xmath1",
    ", we employ our tracing method and set three additional conditions for tracing :    * condition 1 : * the filament positions are higher than @xmath1 at the first detection ;    * condition 2 : * the time interval is less than two days .",
    "in other words , in three consecutive days , observations are available in at least two days .",
    "the purpose of this condition is to improve the accuracy .",
    "* condition 3 : * the total time lapse should be less than ten days , because one specific filament observation can be clearly visible in less than a half - period of the solar rotation . if the time lapse is greater , the accuracy of the tracing method is lower .",
    "we plot the tracing results of the latitude versus normalized time in figure [ normalized ] . here",
    "the normalized time means that we put the dates of the first detection of the filaments as the start time .",
    "the drift velocity distribution histograms in the northern hemisphere and the southern hemisphere are shown in figure  [ hist ] . in the northern hemisphere , there are 103 filaments ( which occupy 57% of all filaments satisfying the conditions and being traced with the latitude higher than @xmath1 ) , which migrate towards the polar region .",
    "the average drift velocity is 0.7126 degree day@xmath96 ( 96.2 m s@xmath96 ) . in the southern hemisphere , there are 97 filaments ( which occupy 61% of all filaments satisfying the conditions and being traced with latitude higher than @xmath1 ) , which migrate towards the polar region .",
    "the average drift velocity is 0.7771 degree day@xmath96 ( 104.9 m s@xmath96 ) . from figure  [ hist ]",
    ", we found that the drift velocities of the filaments with latitudes higher than @xmath1 are divergent , while most of these filaments migrate towards the polar region with relatively high velocities .",
    "such a result is similar to that of .",
    "however , they found that the poleward drift velocity is about 10 m s@xmath96 , which is much slower than ours .",
    "we have developed a method to automatically detect and trace solar filaments from h@xmath0 full - disk images .",
    "the program consists of three parts : first , a preprocessing module is applied to correct the original images .",
    "top - hat enhancement enables us to clearly distinguish the filaments from non - filament features .",
    "second , we introduce the canny edge - detection method to segment and detect filaments .",
    "this method gives us a precise filament edge .",
    "third , our program routines recognize filament features through the morphological operators .",
    "we randomly selected 100 images from mlso observations to test our method , which is demonstrated to be robust and efficient .",
    "for the filament detection , the similarity between the machine recognition and human vision is @xmath103 .",
    "the solar rotation , the filament position , and the deformation of the filament have been considered in order to trace the filament evolution .",
    "the accuracy of the tracing method is about 80% when the time interval is about one day .",
    "in addition , our program can process images not only in different file formats , but also from different observatories .",
    "we used our method to automatically process and analyze 3470 images obtained by mlso from january 1998 to december 2009 .",
    "a butterfly diagram of filaments is obtained , where we can clearly see that filaments move mainly towards the equator in both hemispheres . in order to obtain more quantitative results , we calculated the monthly mean latitudes of the filaments whose latitudes are within @xmath105 or higher than @xmath1 in both northern and southern hemispheres , respectively",
    ". furthermore , we use our tracing method to trace the evolution of the individual filaments with a latitude higher than @xmath1 .",
    "our main conclusions are listed as follows :    @xmath106 the latitudinal migration of solar filaments have three trends in the solar cycle 23 : from 1998 to 2001 ( the solar maximum ) the drift velocity is fast . from the solar maximum to the year 2006",
    "the drift velocity becomes relatively slow .",
    "after 2006 , _",
    "i.e. _ near solar minimum , the migration becomes divergent .",
    "the authors thank the mauna loa solar observatory team for making the data available and sun j. q. for his help in identifying filaments .",
    "we also thank the referee very much for the constructive suggestions which greatly improved the paper in various ways .",
    "this work is supported by the national natural science foundation of china ( nsfc ) under the grants 10221001 , 10878002 , 10403003 , 10620150099 , 10610099 , 10933003 , 11025314 , and 10673004 , as well as the grant from the 973 project 2011cb811402 ."
  ],
  "abstract_text": [
    "<S> we developed a method to automatically detect and trace solar filaments in h@xmath0 full - disk images . </S>",
    "<S> the program is able not only to recognize filaments and determine their properties , such as the position , the area , the spine , and other relevant parameters , but also to trace the daily evolution of the filaments . </S>",
    "<S> the program consists of three steps : first , preprocessing is applied to correct the original images ; second , the canny edge - detection method is used to detect filaments ; third , filament properties are recognized through the morphological operators . to test the algorithm , we applied it to the observations from the mauna loa solar observatory ( mlso ) , and </S>",
    "<S> the program is demonstrated to be robust and efficient . </S>",
    "<S> h@xmath0 images obtained by mlso from 1998 to 2009 are analyzed , and a butterfly diagram of filaments is obtained . </S>",
    "<S> it shows that the latitudinal migration of solar filaments has three trends in the solar cycle 23 : the drift velocity was fast from 1998 to the solar maximum ; after the solar maximum , it became relatively slow . </S>",
    "<S> after 2006 , the migration became divergent , signifying the solar minimum . </S>",
    "<S> about 60% filaments with the latitudes larger than @xmath1 migrate towards the polar regions with relatively high velocities , and the latitudinal migrating speeds in the northern and the southern hemispheres do not differ significantly in the solar cycle 23 . </S>"
  ]
}