{
  "article_text": [
    "the theory of figures of equilibrium is a broad and ancient astrophysical subject , aiming at understanding the flatenning of the earth and stars due to proper spin and tides @xcite .",
    "while very complex structures and shapes are permitted , matter can basically attain two configurations , depending on angular momentum and rotation profile @xcite : an ellipsoidal shape or a toroidal shape at high momentum .",
    "this latter class is of great interest since disks and rings are seen in various astrophysical environments @xcite , around planets and satellites @xcite , around young and evolved stars @xcite , around stellar and supermassive black holes @xcite .",
    "the subject is less documented @xcite , probably for technical reasons ( i.e. the strong deviation with respect to sphericity ) . for compact systems subject to rapid evolutions ,",
    "the framework of general relativity is pertinent @xcite .",
    "most investigations of self - gravitating tori are , however , performed in classical gravity .",
    "configurations have been computed in details by @xcite and collaborators ( see also * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "despite restrictive assumptions ( polytropic gas , symetries , etc . ) , there is a wide and rich collection of possible equilibria @xcite .",
    "this paper revisits the determination of single - body , toroidal configurations from the self - consistent - field ( scf)-method .",
    "a special attention is paid to the convergence process leading to the physical solution and to the preservation of the accuracy order , which points are rarely discussed in the litterature @xcite . here , we work at @xmath0nd - order in the grid resolution . following the pioneering work by @xcite , the poisson - solver is based on multigrid .",
    "indirectly , the polytropic equation - of - state ( eos ) plays a critical role .",
    "for instance , we show that the fluid volume | a key - quantity when building equilibrium sequences | appears quite uncertain due to curvature effects at the inner and outer edges . this is fixed by a subgrid approach .",
    "there is an additionnal diffculty for @xmath6 : the presence of infinite gradients of the mass density at the fluid surface makes standard quadrature schemes unprecise .",
    "this is solved by treating the underlying power - law behavior separately .",
    "globally , the fluid boundary needs to be accounted for in order to fully recover the order of underlying schemes , i.e. @xmath0nd - order .",
    "the virial parameter is then a good indicator of the precision of the solution and integrated values .",
    "finally , we propose a semi - empirical recipe to speed - up the scf - loop by a factor up to @xmath0 typically .",
    "it is a mass density preconditionner .",
    "the article is organized as follows . in sect .",
    "[ sec : physmod ] , we list the assumptions , review the equation set and define the enthalpy associated with the polytropic eos",
    ". we briefly comment on the existence of solutions , and in particular how the index @xmath7 shapes the mass density profile at the fluid surface and below .",
    "we put the problem into dimensionless form and write down the virial equation , associated kernels , and the virial parameter . in sect .",
    "[ sec : solving ] , we express the three constants of the problem and recall the principle of the scf - method , including self - normalisation ( which permits to isolate a particular solution ) .",
    "we briefly outline the multigrid method used to solve the poisson equation , and define the associated nested grids , from the coarsest level to the finest one .",
    "the formula for boundary values is given .",
    "then comes the discretization of the poisson equation and a short error analysis which gives the optimal multigrid level .",
    "we discuss how the polytropic hypothesis impacts on the accuracy of quadratures at @xmath0nd - order .",
    "section [ sec : perf ] is devoted to examples obtained under rigid rotation for both hard and soft eos , with index @xmath8 $ ] , at a low resolution of @xmath9 .",
    "we show how the gravitational , centrifugal and internal energy densities are distributed within the fluid section .",
    "the effect of various parameters ( number of nested grids , covering factor ) on the convergence process is discussed . in sect .",
    "[ sec : subgrid ] , we describe the subgrid approach and kernel splitting which are necessary to go beyond the raw model . a few examples demonstrate its efficiency . in sect .",
    "[ sec : convacc ] , we show that the number of scf - iterations can be reduced by an appropriate preconditionning of the mass density field inside the loop .",
    "this gain ( a factor @xmath0 typically ) directly concerns the computing time and is therefore important when performing high resolution models .",
    "the last section is devoted to concluding remarks .",
    "we study the equilibrium of an isolated , compressible fluid with pressure @xmath10 and mass density @xmath11 rotating in its own gravitational potential @xmath12 at rotation rate @xmath13 .",
    "we assume no accretion , no internal circulation , and no viscosity .",
    "the equation - of - state ( eos ) is of the form @xmath14 .",
    "barotropes ( and in particular polytropes ) enable to cover various situations , e.g. perfect gas , gas with relativistic electrons , degenerate gas , convective media , etc . @xcite .",
    "the analysis is performed in cylindrical coordinates @xmath15 with vector basis @xmath16 , and the rotation axis is along @xmath17 , i.e. @xmath18 .    the meridional section of the fluid is denoted @xmath19 , and it intercepts the fluid surface through a closed curve @xmath20 .",
    "we define a unit vector @xmath21 locally normal to @xmath22 and oriented outward and the associated coordinate is @xmath23 with @xmath24 onto @xmath22 and @xmath25 inside the fluid ( i.e. below the surface ) . under axial and equatorial symmetries",
    ", we have    _ f = 0 , + f(z)-f(-z)=0 ,    for any scalar quantity @xmath26 . the system and notations are summarized in fig .",
    "[ fig : tore_et_ell ] .",
    "we focus on toroidal configurations , where matter has deserted the rotation axis .",
    "according to the schwarz condition , the angular momentum and subsequently the rotation rate are independant of the @xmath27-coordinate @xcite .",
    "the circular velocity is of the form @xmath28 and the equilibrium of the self - gravitating fluid is described by the equation set    - _ r=- p - , + f(p,)=0 , + = 4 g .",
    "+    [ eq : eset ]    the poisson equation , i.e. eq.([eq : eset]c ) , is subject to boundary conditions .",
    "boundary values ( bvs ) are accessible uniquely from the generalized newton s law @xmath29 where @xmath30 and @xmath31 are spherical vectors . if we define the centrifugal potential @xmath32 as @xmath33 then eq.([eq : eset]a ) takes the form    p + ( + ) = 0 .",
    "[ eq : eset_bis ]    the coupling between the rotation rate and the spatial distribution of matter is a tricky problem which exceeds the present context ( e.g. * ? ? ?",
    "* ) . in @xcite ,",
    "the link is made through conservation of potential vorticity . in general",
    "however , @xmath34 remains an input profile .",
    "various options are classically considered @xcite , including power laws of the radius ( e.g. * ? ? ?",
    "we will not favour a particular profile , except for illustrative purposes .",
    "equation ( [ eq : eset_bis ] ) can be fully integrated provided the pressure term is the gradient of a scalar field @xmath35 , the enthalpy , i.e. @xmath36 which is possible for a polytropic eos @xmath37 where @xmath38 and @xmath39 are positive constants .",
    "we thus have @xmath40 where the constant is generally forgotten .",
    "so , the equation set becomes    ( + h+ ) = , + h = k ( n+1 ) ^1/n , + = 4 g , +    [ eq : eset2 ]    where the polytropic index @xmath41 is defined by @xmath42    for isothermal structures where @xmath43 and possibly for layered systems made of different polytropes where continuity is required @xcite , eq.([eq : enthalpy ] ) still holds but the integration constant must be accounted for .",
    "actually , with the definition @xcite    h = k ( ^-1 - _ 0 ^ -1 ) , [ eq : enthalpy_iso ]    where @xmath44 is a constant , we have @xmath45    the incompressible approximation @xmath46 is also of great interest @xcite . in this case , eq .",
    "( [ eq : eset2]b ) is obsolete because @xmath11 is uniform in the system throughout and disconnected from the enthalpy field .",
    "we see from eq.([eq : eset2]a ) that @xmath47 is a space invariant , namely @xmath48 where @xmath49 is a constant . because @xmath12 and @xmath32 are both negative , and due to the correlation between @xmath50 and @xmath11 ( the larger the mass density , the deeper the potential well ) , @xmath35 is expected to rise inside matter , with one maximum ( or more ) .",
    "the regions occupied by the fluid ( where @xmath51 ) are didacted by the value of constant @xmath49 ( to be compared with jacobi s constant in the restricted three body problem ) .",
    "when @xmath52 , matter fills the whole physical space .",
    "so , finite size systems require @xmath53 .",
    "clearly , eq . ( [ eq : eset2]b ) allows for a large variety of mathematical solutions , depending on the polytropic index . for some indices",
    ", @xmath11 can be negative or complex .",
    "we retain the physical solutions associated with @xmath54 for any @xmath7 .",
    "this condition is explicitly stated by replacing eq.([eq : eset2]b ) by @xmath55 this cut - off is a major difference with the approach based on the lane - emden equation , apart from the rotation term .",
    "besides , we focus on single bodies while @xmath54 can occur in two disconnected regions ( or more ) , leading to multibody configurations ( see e.g. * ? ? ? * ) .",
    "if the fluid is isolated , the surface is defined by @xmath56 .",
    "this corresponds to the zero - enthalpy level .",
    "in the isothermal limit ( and possibly for other particular indices ) , this surface may not exist at all , or be rejected at infinity , which case is well known for spherical configurations @xcite . just below the boundary , @xmath11 rises according to eq.([eq : rhoh_sup ] ) .",
    "perpendicularly to @xmath22 ( see sec . [",
    "subsec : hypothesis ] and fig .",
    "[ fig : tore_et_ell ] ) , the mass density gradient is @xmath57 which , by linearly expanding @xmath35 around @xmath24 , is given by @xmath58 as a result , the mass density gradient is finite at the fluid boundary for @xmath1 ( soft eos ) , but infinite for @xmath4 ( hard eos ) .",
    "this latter case introduces a difficulty from a numerical point of view ( see below ) . since the gravitational potential is a continuous function of space @xcite as well as the rotation law",
    ", @xmath35 is also continuous , which property is transmitted to @xmath11 inside the fluid , from eq.([eq : hcontinuous ] ) .",
    "figure [ fig : gradrho ] summarizes four different situations : the larger the index , the more peaked the mass density , and the wider the wings .",
    "conversely , the closer to zero the index , the sharper the transition from the fluid to the external medium , with a bare jump for @xmath59 .",
    "it is convenient to work with adimensionned quantities , especially for a numerical approach .",
    "we use the generic notation @xmath60 where @xmath61 is the magnitude of @xmath26 , which leaves @xmath62 of the order of unity .",
    "space coordinates are normalized by the physical length scale @xmath63 , i.e.    , + ,    and we set    , + , + = + , + , + ,    for the mass density , pressure , rotation rate , gravitational potential , enthalpy and centrifugal potential respectively , where    p_0=k _ 0^ , + _ 0 = g_0l^2 , + h_0=k(n+1)_0 ^ 1/n , + _ 0=_0 l^2 .",
    "the dimensionless equation set then writes    + c_1 + c_2 = c_3 , + ^1/n= ( , 0 ) , + = 4 , +    [ eq : eset3 ]    where    = - , [ eq : phidedims ]    @xmath64    for bvs , and the constants are    c_1 , + c_2 ,    [ eq : c1c2c3 ]    for finite indices . for @xmath43 ,",
    "we have    h_0=k , + = e^ , + c_1=.    while notations and definitions can vary from one author to another , these formulae are standard . note that constant @xmath65 does not exist in @xcite , since it is included into the definition of @xmath66 .",
    "the virial theorem is established by projecting the vectorial euler equation , i.e. eq.([eq : eset]a ) , on the position - vector @xmath67 and integrating over the mass distribution .",
    "it is an energy equation which shows how the gravitational @xmath68 , internal @xmath69 and kinetic @xmath70 energies are spatially distributed ( e.g. * ? ? ?",
    "for the actual problem where only the gravitational and pressure forces are present , the theorem reads @xmath71 where    w= , + t= , + u=3 , + = .",
    "+    when other forces are acting in volume or at the surface , the virial equation must be modified .",
    "this is for instance the case for loaded polytropes @xcite , with magnetic fields @xcite , when the fluid is overpressurized @xcite , for multibody configurations @xcite , etc .",
    "given axial symmetry and eq.([eq : c1c2c3 ] ) , we easily show that eq.([eq : viriel ] ) becomes @xmath72 for finite indices @xmath7 ( the second term is just @xmath73 for @xmath43 ) , where    w = g l^5 _ 0 ^ 2 , + = p_0 l^3 , + t= l^5 _ 0 _ 0 ^ 2 ,    [ eq : wth ]    and @xmath74    interestingly enough , eq.([eq : viriel_dedim ] ) can be written in the form @xmath75 where @xmath76 is the energy per unit meridional section area and @xmath77 with @xmath78 in the isothermal case .",
    "this kernel varies in space : it is a positive where dispersive forces dominate , and negative when cohesion ( i.e. gravitational ) forces dominate .",
    "when eq.([eq : eset3 ] ) is solved numerically , eq.([eq : viriel_dedim ] ) is expected to be satisfied too . since numerical methods have not infinite precision but produce small errors , the virial equation is generally not stricly zero .",
    "the self - consistency of a solution can then be checked a posteriori by comparing the left - hand - side of eq.([eq : viriel_dedim ] ) to its largest term .",
    "relative to the gravitational term , the virial test writes @xmath79 where the virial parameter is @xmath80    this test does not prove the exactness of the computed solution , but only its self - consistency .",
    "it must also be interpreted with caution since , in numerical calculus , tiny quantities are difficult to determine with precision .",
    "we see that @xmath81 ( or @xmath66 ) is the solution of a non - linear , integro - algebraic equation . given @xmath63 , @xmath44 , @xmath82 , @xmath38 and @xmath7 , one can compute @xmath65 and @xmath83 from eq.([eq : c1c2c3 ] ) , but",
    "constant @xmath84 remains undertermined unless @xmath85 , @xmath66 and @xmath81 are known at some point in space . on the contrary , if the three constants are set arbitrarily , the solution in the form of @xmath85 , @xmath66 and @xmath81 may not exist .",
    "actually , for three reference points a , b , and m of space , these constants must satisfy    _ a + c_1_a + c_2 _ a = c_3 , + _ b + c_1_b + c_2 _ b = c_3 , + _",
    "m + c_1_m + c_2 _ m = c_3 , [ eq : bernouilliabc ]    which is not automatic . by selecting points a and b onto @xmath22 where the enthalpy is zero , we get    c_1=- , + c_2=- , + c_3= ,    [ eq : ctebc_hahbnull ]    with @xmath86 and so on for @xmath87 and @xmath88 .      to get the equilibrium ,",
    "the three constants are often regarded as unknowns and solved together with the enthalpy , mass density and gravitational potential through an iterative procedure .",
    "a common method consists in computing successively : i ) the mass density from the enthalpy through eq.([eq : eset3]b ) , ii ) the gravitation potential from eq.([eq : eset3]c ) and the centrifugal potential from eq.([eq : phidedims ] ) , iii ) constants @xmath65 , @xmath83 and @xmath84 from eqs.([eq : ctebc_hahbnull ] ) , and iv ) the enthalpy from eq.([eq : eset3]a ) , and so on until input and output match .",
    "this is the so - called `` self - consistent field''-(scf ) method @xcite .",
    "it requires a starting guess @xmath89 and a convergence criterion to detect , at some step @xmath90 within the cycle , if the enthalpy @xmath91 has converged in the numerical sense .",
    "the capacities of convergence of the scf - method are seemingly misunderstood @xcite , but it happens to work in most cases if : i ) the @xmath5 reference points are conveniently chosen , and ii ) the enthalpy is appropriately rescaled within the cycle .",
    "traditionnally , points a and b are radii at the inner and outer edge of the torus respectively .",
    "since @xmath92 is generally monotonic with the radius , this ensures that @xmath93 is maximum .      as outlined in @xcite",
    ", @xmath66 does not necessarily remain under control . from eqs.([eq : eset3]a ) and ( [ eq : eset3]b ) , we have @xmath94 and we see that both sides respond in the same way when @xmath81 varies . the scf - cycle is therefore prone to runaway .",
    "however , since neither @xmath83 nor @xmath84 depend on point m , we have an extra degree of freedom to avoid any drift",
    ". we can impose that the enthalpy at some point in the fluid takes a particular value ( see sect .",
    "[ subsec : mrecsaling ] ) . by inserting @xmath95 into eq.([eq : scfnewh ] ) , we get @xmath96 meaning that if m is held fixed , its enthalpy is constant during the scf - iterations .",
    "then , at convergence : i ) @xmath97 has conserved its initial value , and ii ) the maximum enthalpy is not under control , and it does not necessarily occur at point m. this is not an obstacle to convergence , but there are clearly an infinity of solutions , each dictated by @xmath98 .",
    "we follow @xcite by requiring    _ m= ( ) , + _",
    "m=1 ,    [ eq : hselfscaled ]    at convergence .",
    "now , point m is not known in advance but changes during the scf - iterations .",
    "in fact , this `` self - normalized '' version is obtained by computing constants @xmath83 and @xmath84 at time @xmath90 and constant @xmath65 at time @xmath99 from the new estimate @xmath100 .",
    "this is feasible because only @xmath65 depends upon @xmath97 . at step @xmath90 ,",
    "we successively determine    1 .",
    "@xmath101 from eq.([eq : eset3]b ) , 2 .",
    "@xmath102 from eq.([eq : eset3]c ) , 3 .",
    "@xmath103 from eq.([eq : phidedims ] ) , 4 .",
    "constants @xmath104 and @xmath105 from eqs.([eq : ctebc_hahbnull]b ) and ( [ eq : ctebc_hahbnull]c ) , 5 .   @xmath106 from eq.([eq : eset3]a ) , namely @xmath107 6 .   its maximum value , happening at some point m @xmath108 \\equiv c_1^{(t+1)},\\ ] ] 7 .   and",
    "the new enthalpy field @xmath109    since the computational grid is fixed , @xmath110 does not vary during the cycle and so step ( iii ) can be removed from the list and executed once for all .",
    "convergence is checked after step ( vii ) .",
    "a natural indicator of convergence is ( see below ) : @xmath111      the main difficulty arising in the actual problem is the determination of the potential in eq.([eq : eset3]a ) which varies during the scf - iterations due to the evolution of the enthalpy .",
    "we solve eq.([eq : eset3]c ) for @xmath85 on an uniform grid @xmath112 from multigrid .",
    "this technique is very efficient for solving partial differential equations ( pdes ) since it combines nested grids and relaxation ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "it has already been employed in the context of figures of equilibrium @xcite .",
    "short wavelengths are fastly smoothed by relaxation on a given grid , in contrast to long wavelengths .",
    "this is circumvented by using low resolution versions of the finest grid , thereby converting long wavelengths into small ones .",
    "the communication between all levels , from the coarsest to the finest grid and vice - versa , is achieved from restriction and prolongation operators , enabling to write fields and solve the discretized pde at all levels .",
    "the restriction operator is based on full - weighting , while the prolongation operator employs bilinear interpolation .",
    "all the grids are visited , from finest grid to coarsest and back .",
    "this is called a `` v - cycle '' .",
    "at each level , one red - black gauss - seidel algorithm ( or more ) is performed . despite a good convergence rate ( about @xmath113 extra digit fixed by v - cycle ) , a unique v - cycle does not deliver the exact solution of the discretized problem , only a better approximation .",
    "however , by applying a v - cycle several times , multigrid becomes almost equivalent to matrix diagonalisation methods . in single precision , about @xmath114 successive v - cycles are necessary typically , and this is @xmath115 in double precision .",
    "because multigrid has nominal performance when the spacing is the same in all directions , we use a square grid @xmath116 \\times [ { \\hat{z}}_0,{\\hat{z}}_n]$ ] . in order to vary the fluid section - to - grid area ratio ( i.e. the covering factor ) , we put @xmath117 nodes in between the inner and outer edge of the fluid and the grid boundary , as indicated in fig .",
    "[ fig : grid.eps ] .",
    "since there are no forces susceptible to thicken the torus in the @xmath27-direction ( i.e. the section @xmath19 is expected to be oblate ) , the grid size is imposed by the the equatorial diameter of the torus @xmath118 ( expected to be larger than the polar one @xmath119 ) . in spite of the equatorial symmetry , we found no real advantage to work in the half - plane @xmath120 only .",
    "this would mean i ) neumann conditions at the grid bottom @xmath121 , ii ) much more dirichlet boundary values to compute , and iii ) a smaller covering factor .",
    "the grid is therefore centered in the equatorial plane . under these conditions , the number of subintervals between points a and b is @xmath122 and the numerical resolution of the finest grid is @xmath123 both in the @xmath124- and @xmath125-directions .",
    "the grid extends radially from @xmath126 to @xmath127 with    _ 0= _ a - n_0 0 , + _ n= _",
    "b + n_0 ,    [ eq : rorn ]    and we have    _ n= ( _ n-_0 ) , + _ 0= -_n ,    in the vertical direction .",
    "the sampling is    _ i=_0+i , i , + _",
    "i=_0+j , j .",
    "this is for the finest level @xmath128 ( i.e. highest resolution ) and we have @xmath129 per direction .",
    "the nested grids are easily generated . with mesh size doubling",
    ", the coarser grid at level @xmath130 is obtained by keeping nodes @xmath131 and @xmath132 . at level @xmath133 , we keep nodes @xmath134 and @xmath135 . at level @xmath136 , we keep nodes @xmath137 and @xmath138 . for the coarsest level , @xmath139 ,",
    "there are just @xmath5 nodes per direction , @xmath140 in total , where @xmath141 belong to the grid boundary .",
    "the discretization of eq.([eq : eset3]c ) writes @xmath142 where @xmath143 and @xmath144 denotes the approximations for the first and second derivatives and @xmath145 is the truncation error . by using second - order centered schemes , the dimensionless potential at node @xmath146",
    "is given by    _",
    "i , j=&(a_+ _ i+1,j + a_- _ i-1,j .",
    "+ _ i , j+1 + _ i ,",
    "j-1 - 4_i , j^2 ) , [ eq : poissonorder2 ]    where @xmath147    the magnitude of the scheme error is @xmath148 and explicitly decreases with @xmath149 . as usual in error analysis @xcite",
    ", we assume that the third and fourth derivatives are bounded , i.e. @xmath150 at a node @xmath151 , the total error is then given by @xmath152 where @xmath153 is the computer precision .",
    "as it is well known , finite differences become inaccurate if the spacing is too small , leaving round - off errors and loss of significance .",
    "the error is minimum for @xmath154 when the second derivative is the limiting quantity , the optimal spacing is @xmath155 .",
    "the first derivative can bring a similar contribution if @xmath156 typically ( i.e. the computational grid is close to the @xmath27-axis ) .",
    "it all depends on @xmath157 which is difficult to estimate .",
    "the optimal spacing is in the range @xmath158 which can be converted into an optimal level @xmath159 of the multigrid from eq.([eq : nl ] ) . with standard numbers , we get values listed in table [ tab : ehl ] .",
    "lcc & single precision & double precision + @xmath153 & @xmath160 & @xmath161 + @xmath162 & @xmath163 & @xmath164 + @xmath159 & @xmath165 & @xmath166 + @xmath167 & @xmath168 & @xmath169 +   + @xmath128 & & @xmath114 + absolute error & & @xmath170 +      under axial symmetry and equatorial symmetries , eq.([eq : psinewton ] ) simplifies somehow .",
    "the adimensionned potential takes the form @xcite @xmath171 where    , + ,    @xmath172 , \\label{eq : kappa}\\ ] ]    @xmath173    is the complete elliptic integral of the first kind , @xmath174 is the modulus , @xmath175 and @xmath176 .",
    "when @xmath177 ( which occurs when @xmath178 and @xmath179 ) , @xmath180 diverges logarithmically , and the determination of @xmath12 can become inaccurate .",
    "this never happens here since the fluid and the grid boundary are never in contact as soon as @xmath181 ( see sect .",
    "[ subsec : grid ] ) .",
    "we need a quadrature scheme that preserves the @xmath0nd - order of the finite different scheme .",
    "not only bvs are concerned , but also most output quantities ( mass , volume , angular momentum , virial parameter , etc . ) .",
    "the trapezoidal rule is the natural choice . for any function",
    "@xmath62 that vanishes outside the fluid ( if it depends on @xmath11 ) , we can consider the full grid , i.e.    [ eq : trap ] _ fluidd d & _ i , j _",
    "i , j + & -_i ( _ i,0+_i , n ) + & -_j ( _ 0,j+_n , j ) + & + ( _ 0,0 + _ n,0 + _ 0,n + _ n , n ) .    for geometrical quantities like the fluid volume , one must multiply @xmath62 by a weighting function @xmath182 , namely @xmath183    there are two pending problems that can damage the @xmath0nd - order . first , @xmath22 is rounded and does not follow the grid lines ( see fig .",
    "[ fig : tore_et_ell ] ) .",
    "standard quadrature schemes are generally not well suited to irregular or curved integration domains .",
    "this is a natural motivation for space mapping @xcite .",
    "second , for hard eos ( @xmath4 ) , @xmath81 does not reach @xmath22 through a finite gradient .",
    "again , this is a situation where many quadrature schemes fail to be accurate .",
    "the question of determining the fluid boundary @xmath22 is then naturally addressed .",
    "it is instructive to estimate the relative contribution of the numerical cells located just below the fluid surface .",
    "let @xmath184 denote the typical value of @xmath62 onto or close to @xmath22 , @xmath185 be the mean value of @xmath62 inside the fluid , @xmath186 the perimeter and @xmath187 the fluid section .",
    "this contribution is given by @xmath188 it is first - order in @xmath149 if @xmath189 , but second - order if @xmath190 .",
    "further , if @xmath62 depends linearly on @xmath81 ( see sect .",
    "[ subsec : fsi ] ) , then this contribution is @xmath191 .",
    "it immediately follows that all geometrical quantities like the fluid volume are only @xmath113st - order accurate , and all quantities which are senstive to the mass density ( bvs , mass , angular momentum , virial kernels , etc . )",
    "are @xmath0nd - order accurate as soon as @xmath1 ( i.e. for soft eos ) . for @xmath6 ,",
    "the situation is worse ( see sec .",
    "[ subsec : fb ] ) : not only the fluid boundary is first - order , but the gradient of mass density is infinite at @xmath22 . increasing the order of the quadrature scheme is not the right way to fix the problem . instead , a specific treatment must be considered .",
    "this is discussed in sect .",
    "[ sec : subgrid ] .",
    "we have built a fortran 90 code nammed drop for `` differentially rotating polytropes '' for solving toroidal figures of equilibrium by using methods described above .",
    "the main input parameters are ( see sec .",
    "[ subsec : grid ] )    * @xmath128 ( or @xmath2 ) for the multigrid method and grid , * @xmath7 , @xmath192 , @xmath193 for the polytropic torus , * @xmath194 for the covering factor .",
    "the starting guess @xmath89 is obviously a critical point .",
    "we use a paraboloid with circular section ( radius @xmath195 ) which is , in general , a good choice . regarding the convergence criterion",
    ", we use the frobenius norm @xmath196 , namely    _",
    "i , j=1,n-1_i , j^2 ,    which is a good compromise , and so the solution is found when @xmath197 where @xmath198 is a small number .",
    "it is tempting to link this threshold to the scheme errors . in some cases",
    "however , the process seems to converge but finally oscillates without getting stable , which could lead to false solutions .",
    "this is observed for instance close to the mass shedding limit . in practical ,",
    "we therefore let the field @xmath199 fall down at its minimum , which is generally close to the computer precision .",
    "this does not appear detrimental .",
    "once the solution ( i.e. @xmath81 and the three constants @xmath65 , @xmath83 and @xmath84 ) is known , several output quantities can be infered , in particular ( in dimensionless form ) :    * the area of the meridional section @xmath200 , * the fluid volume @xmath201 , * the mass @xmath202 , * the mean mass density @xmath203 , * the angular momentum @xmath204 , * @xmath205 , @xmath206 , @xmath207 , and the virial parameter @xmath208 .      as a first example",
    ", we consider a rigidly rotating torus with parameters @xmath209 , @xmath210 , @xmath211 .",
    "this case is for instance reported in @xcite and others . for @xmath212 ,",
    "the centrifugal potential is quadratic with the radius , namely @xmath213 regarding the numerical grid , we take @xmath214 ( i.e. @xmath215 ) and @xmath216 which implies for the radial sampling @xmath217 and @xmath218 . according to sect .",
    "[ subsec : grid ] , we have @xmath219     +   +    for these parameters , the absolute error in potential values is expected to be of the order of @xmath220 ( see sect .",
    "[ subsec : secondorderpoisson ] ) , which is transmitted to @xmath66 , @xmath81 , constants @xmath65 , @xmath84 , @xmath84 , @xmath208 , etc .",
    "this means @xmath221 correct digits typically , which is typical at such a spatial resolution @xcite .",
    "the equilibrium solution is found after @xmath222 iterations .",
    "the remarkable capability of convergence of the scf - loop is shown in fig .",
    "[ fig : ehent_01.ps ] which displays @xmath199 a few steps after .",
    "figure [ fig : config_ref.eps ] displays @xmath85 , @xmath66 and @xmath81 at convergence .",
    "we notice the slight asymetry of the enthalpy and density maps ( point m is closer to edge a than edge b ) , due to curvature effects .",
    "centrifugation shifts the gravitational potential well towards the inner edge .",
    "equatorial forces are plotted in fig .",
    "[ fig : eqforces ] .",
    "we see that the zero - gravity and zero - pressure points do not coincide .",
    "the virial kernel and the quantity @xmath223 are displayed in fig .",
    "[ fig : kernels_ref.eps ] .",
    "the gravitational energy density is more concentrated at the inner edge of the torus , while the internal and centrifugal energies dominate in the outer region .",
    "the kinetic term always exceeds the pressure term , and this is especially pronounced close to the fluid boundary .",
    "table [ tab : cpredtohachisu ] shows that output quantities are in agreement with @xcite who works with simpson s @xmath221th - order quadrature rule in spherical coordinates and rather low covering factor .",
    "successful comparisons are observed for many other configurations .",
    "deviations appear close to critical rotation and in the thin ring limit as well .",
    ".comparison with hachisu ( 1986 ) . at the actual resolution ,",
    "only four figures are guaranteed ( @xmath224estimated ) . [",
    "cols=\"<,<,<\",options=\"header \" , ]",
    "the evolution of @xmath225 during the scf - iterations is shown in fig .",
    "[ fig : allconv.eps ] for the three configurations studied before ( see sect .",
    "[ subsec : scfloop ] ) .",
    "we see the remarkable stabilisation of the scf - iteration at a very high level of precision ( see also fig . [",
    "fig : ehent_01.ps ] ) .",
    "as mentionned , this holds whatever the polytropic index , with or without subgrid approaches .",
    "the striking feature is the exponential decay which appears after a very few iterations , once the starting guess is almost forgotten .",
    "there is obviously a sensitivity to the polytropic index and axis ratio @xmath226 of the torus , but this property appears relatively universal .",
    "the decay is not only observed for @xmath225 , but for the enthalpy field at almost all of the grid nodes .",
    "it has an origin in the scf - method .",
    "we can therefore try to reduce the number of iterations , at least empirically , from this decay .",
    "let us assume that , at time @xmath90 , we have @xmath227 where @xmath228 and @xmath229 .",
    "since this expression also writes    ( t+ ) & = ^(t+-1 ) e^-b ,    we can estimate field values at the end of the next iteration , i.e. at time @xmath230 . with @xmath231 ,",
    "we have    ^(t+1 ) + ^(t)e^-b ^(t+2 ) , .",
    "[ eq : hcorrected ]    like @xmath66 , @xmath232 is a function of space ( each node has its own path to convergence ) , namely @xmath233 which can be determined from finite differences . at second order",
    ", we have    - b & + & .",
    "[ eq : bij ]    the mass density field to be considered in bvs when entering step @xmath99 of the scf - method is therefore given by @xmath234^n , \\label{eq : rhocorrected}\\ ] ] which requires the storage of the enthalpy over a @xmath5 successive iterations , at @xmath235 , @xmath90 and @xmath99 .",
    "the next question concerns the application of such a correction : where and when can we anticipate and provide a improved guess for the mass density at the begining of iteration @xmath99 ? we must first remind that we are mainly interested in bvs , and so only nodes of positive enthalpy are concerned .",
    "second , the correction must not perturb the scf - iterations too much , and cancel convergence .",
    "there is no risk at nodes where @xmath229 , but this may be critical with @xmath236 .",
    "a possible criterion for preconditionning is @xmath237 where the second inequality means that the enthalpy field must vary monotonically at the actual node .",
    "an accelerated version of the scf - iterations can be obtained by modifying the algorithm given in sect .",
    "[ subsec : mrecsaling ] as follows    1 .",
    "* preconditionning ( optional ) * : if ineq.([eq : towardsc ] ) are fulfilled , then @xmath11 is given by eq.([eq : rhocorrected ] ) when entering step @xmath99 , i.e. @xmath100 is replaced by @xmath238 .",
    "figure [ fig : b_coefficient_at_t5.ps ] displays @xmath232 computed from eq.([eq : bij ] ) for the torus with @xmath209 after @xmath239 steps of the classical scf - iterations . with a mean value @xmath240 ,",
    "the enthalpy is on the way to convergence as the deviation from one step to the other already diminishes , and preconditionning helps to accelerate the process .",
    "we have checked this recipe to many configurations and observed mostly no failure indeed .",
    "it works well with or without including boundary effects and kernel splitting for @xmath6 .",
    "the results are given in fig .",
    "[ fig : allconv_improved.eps ] for the three examples discussed in sect .",
    "[ sec : perf ] where we have used @xmath241 . by using the same convergence criterion ,",
    "the scf - iterations require about half the normal time .",
    "in this article , we have reinvestigated toroidal figures of equilibrium with a special focus on the convergence process of the scf - iterations and accuracy of solutions . in this context , we have carried out the full problem at @xmath0nd - order and discussed the impact of discretisation and quadrature schemes on ouput quantities . as argued , the polytropic hypothesis sets severe constraints on the determination of solution for @xmath6 due to the non - derivability of the mass density at the fluid boundary .",
    "though a few selected examples , we have shown how the gravitational , centrifugal and internal energy densities are distributed in space . we have demonstrated that the virial parameter is a good tracer of the precision of output quantities , except for geometrical quantities like the volume which fluctuates with the resolution .",
    "such an uncertainty directly impacts on the location of critical rotation in the @xmath242 equilibrium digrams . rather than increasing the order of the quadrature scheme",
    ", we have shown that the @xmath0nd - order can finally be recovered if the fluid boundary is detected and accounted for correctly .",
    "for polytropic indices lower than unity , quadrature troubles due to infinite gradients of the mass density can be circumvented through kernel splitting .",
    "finally , we have shown that it is possible to speed - up the convergence of the scf - method by internal preconditionning of the enthalpy field .",
    "actually , the temporal evolution of the enthalpy at the grid nodes shows an almost universal exponential decay that can be used back to improve the new guess inside the scf - loop .",
    "this improvement is particularly interesting when building high resolution equilibrium sequences .",
    "it is a step toward the understanding of the convergence of the scf algorithm which remains poorly understood and documented @xcite .",
    "the recipe is probably not limited to toroidal structures and can probably apply to spheroidal ones , which would be interested to check .",
    "it is a pleasure to thank b. boutin - basillais .",
    "we would like to dedicate this paper to our colleague and friend dr .",
    "j.p . zahn .",
    "n.  j. , meacham s.  p. , spiegel e.  a. , young w.  r. , 1992 , in dermott s.  f. , hunter jr .",
    "j.  h. , wilson r.  e. , eds , astrophysical disks vol .  675 of annals of the new york academy of sciences , global equilibria of turbulent accretion disks .. pp 5364                                                                                            a. , 1987 , in bruzzo u. , cianci r. , massa e. , eds , general relativity and gravitational physics self - gravitating toroidal figures of equilibrium around a rotating black hole : the numerical method ."
  ],
  "abstract_text": [
    "<S> we compute the structure of a self - gravitating torus with polytropic equation - of - state ( eos ) rotating in an imposed centrifugal potential . </S>",
    "<S> the poisson - solver is based on isotropic multigrid with optimal covering factor ( fluid section - to - grid area ratio ) . </S>",
    "<S> we work at @xmath0nd - order in the grid resolution for both finite difference and quadrature schemes . for soft eos ( i.e. polytropic index @xmath1 ) , </S>",
    "<S> the underlying @xmath0nd - order is naturally recovered for boundary values ( bvs ) and any other integrated quantity sensitive to the mass density ( mass , angular momentum , volume , virial parameter , etc . ) , i.e. errors vary with the number @xmath2 of nodes per direction as @xmath3 . </S>",
    "<S> this is , however , not observed for purely geometrical quantities ( surface area , meridional section area , volume ) , unless a subgrid approach is considered ( i.e. boundary detection ) . </S>",
    "<S> equilibrium sequences are also much better described , especially close to critical rotation . </S>",
    "<S> yet another technical effort is required for hard eos ( @xmath4 ) , due to infinite mass density gradients at the fluid surface . </S>",
    "<S> we fix the problem by using kernel splitting . </S>",
    "<S> finally , we propose an accelerated version of the scf - algorithm based on a node - by - node pre - conditionning of the mass density at each step . the computing time is reduced by a factor @xmath0 typically , regardless of the polytropic index . </S>",
    "<S> there is a priori no obstacle to applying these results and techniques to ellipsoidal configurations and even to @xmath5d - configurations .    </S>",
    "<S> [ firstpage ]    gravitation | methods : analytical | methods : numerical </S>"
  ]
}