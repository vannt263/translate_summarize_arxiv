{
  "article_text": [
    "widely separated time - scales occur in many radio - frequency ( rf ) circuits such as mixers , oscillators , plls , etc . , making the analysis with standard numerical methods difficult and costly .",
    "low frequency or baseband signals and high frequency carrier signals often occur in the same circuit , enforcing very small time - steps over a long time - period for the computation of the numerical solution .",
    "the occurrence of widely separated time - scales is also referred to as a multi - scale or multi - rate problem , where classical numerical techniques require prohibitively long run - times .    a method to circumvent this bottleneck",
    "is to reformulate the ordinary circuit equations , which are differentieal algebraic equations ( daes ) , as a system of partial daes ( multi - rate pdae ) .",
    "the method was first presented in @xcite , specialized to compute steady states.the technique was adapted to the transient simulation of driven circuits with a - priori known frequencies in @xcite .",
    "a generalization for circuits with a - priori unknown or time - varying frequencies was developed in @xcite .",
    "this approach opened the door to multi - rate techniques with frequency modulated signal sources or autonomous circuits such as oscillators with a priori unknown fundamental frequency @xcite .    here ,",
    "we present a new approach for the computation of a not a - priori known , time - varying frequency , which is driven by the requirement to have a smooth multi - rate solution , crucial for the efficiency of the computation .",
    "we consider circuit equations in the charge / flux oriented modified nodal analysis ( mna ) formulation , which yields a mathematical model in the form of a system of differential - algebraic equations ( daes ) : @xmath0 here @xmath1 is the vector of node potentials and specific branch voltages and @xmath2 is the vector of charges and fluxes .",
    "the vector @xmath3 comprises static contributions , while @xmath4 contains the contributions of independent sources .    to separate different",
    "time scales the problem is reformulated as a multi - rate pdae ( cf .",
    "@xcite ) , i.e. , @xmath5 if the new source term is chosen , such that @xmath6 where @xmath7 , then a solution @xmath8 of ( [ multirate ] ) determines a family @xmath9 of solutions for @xmath10 by @xmath11    although the formulation ( [ multirate ] ) is valid for any circuit , it offers a more efficient solution only for certain types of problems .",
    "this is the case if @xmath12 is periodic in @xmath13 and smooth with respect to @xmath14 . then , a semi - discretization with respect to @xmath14 can be done resulting in a relative small number of periodic boundary problems in @xmath13 for only a few discretization points @xmath15 . in the sequel we will consider ( [ multirate ] ) with periodicity conditions in @xmath13 , i.e. , @xmath16 and suitable initial conditions @xmath17 . here",
    "@xmath18 is an arbitrary but fixed period length , which results in a scaling of @xmath12 and @xmath19 as we will see in the next section",
    ".    note that for a given initial value for the original circuit equations ( [ eq_mna_charge ] ) the multi - rate formulation ( [ multirate ] ) is not unique .",
    "first it does not correspond to a single problem , but to a family of problems as described in ( [ singlerate ] ) .",
    "this usually permits some freedom in the choice of the multi - rate source term @xmath20 and for the initial conditions .",
    "furthermore , @xmath19 can , in principle , be chosen arbitrarily , but influences on the other hand , which choice of @xmath20 satisfies ( [ char_source ] ) .    in the sequel",
    ", we want to study how the above freedom can be used to facilitate an efficient numerical solution of ( [ multirate ] ) .",
    "the smoothness of @xmath12 is essential for the efficiency of classical solvers .",
    "that is , the freedom we have for the formulation of ( [ multirate ] ) should be used to make the solution as smooth as possible .",
    "it can be easily verified that @xmath19 can be any positive function , if the source term @xmath20 is chosen to satisfy ( [ char_source ] ) .",
    "therefore , we will first investigate , what effect different selections of @xmath19 have .",
    "let @xmath21 and @xmath22 be two choices . if @xmath23 and @xmath24 both satisfy ( [ character ] ) , then it is obvious that @xmath25 where @xmath26 .",
    "that is , for a fixed @xmath14 changing @xmath27 results in a phase shift of @xmath12 .",
    "a corresponding phase shift for the source term has to be performed in order to satisfy ( [ char_source ] ) .",
    "the following lemma describes how @xmath19 affects the smoothness of @xmath12 .",
    "[ smoothmr ] let @xmath28 for any @xmath29 .",
    "if @xmath30 for @xmath31 $ ] , then @xmath32 where @xmath33 is the unique solution of @xmath34    following ( [ character ] ) we have @xmath35 by the mean value theorem for integration we obtain @xmath36 thus , @xmath37 and ( [ smoothx ] ) follows from ( [ smoothxhat ] ) by ( [ character ] ) .",
    "lemma  [ smoothmr ] states that we can only expect smoothness of @xmath12 in @xmath14 if @xmath38 is nearly @xmath33-periodic in a neighborhood of @xmath14 .    since typical multi - rate signals behave locally like a periodic signal , i.e. , @xmath39 as long as @xmath13 is close to some @xmath40",
    "that is , there should be a choice of @xmath19 such that @xmath41 and @xmath42 do not differ much for sufficiently small @xmath43 .",
    "this leads to the additional condition @xmath44 in order to determine @xmath19 .",
    "a similar condition is used in @xcite ) . the difference to our approach is in the discretization of the problem .",
    "while pulch derives a phase condition from the minimization condition , we will discretize the minimization condition directly , which will lead to a smaller linear system to be solved in the algorithm . furthermore",
    ", we are using a rothe method for the discretization of the pdae , which allows a completely adaptive solution .",
    "a different approach is suggested in @xcite , where @xmath12 is replaced by @xmath45 in ( [ min_cond ] ) .",
    "although this seems the proper condition for an efficient discretization of the derivative in @xmath14 in the multi - rate pdae ( [ multirate ] ) , another problem occurs here . using an implicit multistep method for the discretization in @xmath14",
    ", we need a predictor ( as initial guess for newton s method ) , which is usually based on the solution of the previous time step . here , a condition on @xmath12 as in ( [ min_cond ] ) occurs naturally .",
    "a condition on @xmath45 covers only contributions of the signal which are already smoothed ( by capacitances or inductances ) , and might not provide a sufficient initial guess .",
    "it turns out that condition ( [ min_cond ] ) yields the expected result for amplitude and frequency modulation of a periodic signal , i.e. , for typical multirate rf signals .",
    "[ mr_modulated ] assume @xmath46 with @xmath47 is a solution of _ ( [ singlerate ] ) _ with non - trivial @xmath48 and @xmath49 .",
    "the solution of the corresponding multi - rate problem _ ( [ multirate ] ) _ satisfies _ ( [ min_cond ] ) _ if and only if @xmath50 and @xmath51 .    according to ( [ character ] ) and ( [ omega2 ] ) we can write the multi - rate solution as @xmath52 , where @xmath53 vanishes if and only if @xmath50 . taking the derivative with respect to @xmath14 we",
    "obtain @xmath54 note , that due to periodicity of @xmath55 we have @xmath56 thus , the expression in ( [ min_cond ] ) , which has to be minimized becomes @xmath57 obviously the expression becomes minimal if @xmath58 , @xmath59 $ ] . from ( [ omega2 ] )",
    "we see that @xmath60 and the statement is proven .",
    "applying the approach to more general problems , permits to consider @xmath61 as a generalization of the instantaneous frequency of the multi - rate problem , if ( [ min_cond ] ) is satisfied .",
    "for the numerical solution of the multi - rate problem we have to discretize the mpdae s ( [ multirate ] ) together with the smoothness condition ( [ min_cond ] ) .",
    "the following section presents a new approach for the numerical solution of the multi - rate problem with unknown frequency parameter .",
    "we discretize ( [ multirate ] ) with respect to @xmath14 by a rothe method using a linear multi step method and obtain @xmath62 complemented by the periodicity condition @xmath63 . here",
    "we have to determine an approximation @xmath64 of @xmath65 from known , approximative solutions @xmath66 at previous time steps @xmath67 .",
    "examples are the trapezoidal rule with @xmath69 , @xmath70 and @xmath71 or gear - bdf of order @xmath72 with @xmath73 and suitable @xmath74 .",
    "that is , @xmath75 is the solution of a periodic boundary value problem for the daes given in ( [ rothe ] ) .    assuming that the @xmath67 , @xmath76 and @xmath66 are known and fixed for @xmath77 we define @xmath78 & + ~\\sum_{i=1}^s\\bigg\\ { \\alpha^k_i q\\big(x_{k - i}(t)\\big ) + \\beta^k_i \\left(\\omega_{k - i}\\,\\frac{d}{dt}q\\big(x_{k - i}(t)\\big )                            + g\\big(x_{k - i}(t)\\big)-\\hat{s}\\big(\\tau_{k - i},t\\big)\\right)\\bigg\\},\\end{aligned}\\ ] ] as well as @xmath79 .",
    "then ( [ rothe ] ) becomes the periodic boundary value problem @xmath80    furthermore , @xmath81 is an approximation for @xmath82 , which has to be determined during the computation ( if not known in advance ) . since the midpoint rule states for a suitable choice of @xmath83 that @xmath84 we replace condition ( [ min_cond ] ) by @xmath85 i.e. , we aim to minimize the change of @xmath64 from one time step to the next , which corresponds well to the original goal .",
    "if we have a smooth envelope , we may be able to choose the step sizes @xmath86 much larger than the period @xmath87 .",
    "that means the number of time steps will become much smaller compared to the number of oscillations of the carrier signal .",
    "this can lead to an essential gain in computation time compared to transient analysis , since the computation cost for one period is comparable to one envelope time step .",
    "the periodic problem ( [ envelope ] ) can be solved by a collocation or galerkin method , where @xmath64 is expanded in a periodic basis @xmath88 ( as a fourier , b - spline , or wavelet basis ) and tested at collocation points or integrated against test functions ( see e.g. @xcite ) .",
    "this leads to a nonlinear system @xmath89 of equations for the coefficients @xmath90 of the basis expansion @xmath91 and the unknown frequency parameter @xmath92 . here ,",
    "condition ( [ min_cond2 ] ) is replaced by a condition on the expansion coefficients , namely @xmath93 this means , that we are still minimizing the distance of @xmath64 and @xmath94 , although with respect to a slightly modified measure .    the nonlinear system ( [ nonlinear ] )",
    "is solved by a modified newton s method .",
    "the linearization of the problem yields the under - determined system @xmath95 with the right hand site @xmath96 , the jacobian @xmath97 , and @xmath98 .",
    "furthermore , @xmath99 and @xmath100 are the updates in the newton iteration @xmath101 with an initial guess chosen as @xmath102 and @xmath103 .    to find a solution satisfying ( [ min_cond3 ] ) we rewrite ( [ newton_ud ] ) as @xmath104 where @xmath105 and @xmath106 are computed by solving the corresponding linear systems .",
    "this needs a lu - decomposition of @xmath107 and two forward - backward substitution , i.e. , the computational costs are only slightly higher as for @xmath19 fixed in advance .",
    "possible higher step sizes and faster convergence of newton s method justify this extra cost if a good choice for @xmath19 is not available in advance . in the @xmath108-th newton step @xmath109 we determine the newton correction , which satisfies ( [ min_cond3 ] ) as follows .",
    "we want @xmath110 to be minimal .",
    "obviously the minimum is attained for @xmath111",
    "the method has been tested on several circuits .",
    "we show results from the multi - rate simulation of a phase locked loop ( pll ) with a frequency modulated input signal .",
    "the phase of the output signal is synchronized with the phase of the input `` reference '' signal .",
    "this is achieved , by comparing the phases of the `` reference '' signal and the output or `` feedback '' signal in a phase detector .",
    "the result is then filtered , in order to stabilize the behavior of the pll , and fed to a voltage controlled oscillator ( vco ) whose frequency depends on the ( filtered ) phase difference .",
    "the output is fed back ( possibly through a frequency divider ) to the phase detector .",
    "if the pll is locked , the phases of reference and feedback signal are synchronized .",
    "thus both signal will have ( almost ) the same local frequency .",
    "we have tested a pll ( containing 145 mosfets and 80 unknowns ) with a frequency modulated sinusoidal signal with frequency 222khz .",
    "the baseband signal is also sinusoidal with frequency 200hz and frequency deviation 200hz .",
    "we have chosen this example , since it was particular challenging , due to its size , but also due its digital - like behavior , which requires an efficient adaptive representation of the solution , as well as a very accurate estimate of the frequency parameter @xmath19 .",
    "although the baseband signal is known to us after locking of the pll , this information is not provided to the algorithm .",
    "this permits a verification of the @xmath19 determined by our algorithm . before the locking of the pll the optimal @xmath19",
    "is not known to us , and the estimate of the algorithm proved essential for this part of the simulation to be successful .",
    ", scaledwidth=60.0% ]    due to the chosen circuit design most of the signals show a digital behavior such that the solution can not efficiently be expanded by a fourier basis .",
    "thus , using the harmonic balance method is not suited for the solution of the problem , in particular since the use of a frequency divider results in a wide frequency range of the solution .",
    "therefore , the periodic problem is solved by an adaptive spline wavelet method described in @xcite .",
    "the quality of the estimate of @xmath19 is essential for the efficiency of the method , because this results in a good initial guess for the solution and the spline grid in newton s method .    in figure  [ pllcontrol ] ( left )",
    "one can see the control signal for the vco ( the filtered output of the phase detector ) , which controls the frequency of the oscillator .",
    "note , that after the locking phase at the beginning the envelope corresponds to the baseband signal , while the carrier signal is due to the filtering almost constant .",
    "figure  [ pllcontrol ] ( right ) shows the digital feedback signal .",
    "note that @xmath19 was chosen to satisfy the condition ( [ min_cond3 ] ) .",
    "the plot of @xmath19 in figure  [ pllomega ] fits almost perfectly the baseband signal , after the pll is locked . in the light of lemma  [ mr_modulated ] ,",
    "the graphs in figures  [ pllcontrol ] and [ pllomega ] show indeed a frequency modulated box shaped signal . the optimal choice of @xmath19 results in high smoothness with respect to @xmath14 .",
    "this allows to do the shown envelope simulation using only 74 envelope time steps , while a corresponding transient analysis would contain 3100 oscillations .",
    "the wavelet envelope simulation of this circuit was done in 7min . however , a comparable transient simulation on the same simulator needed 33hours .",
    "we have presented a new method for an accurate estimate of an unknown frequency parameter in multi - rate envelope simulations , which permits an efficient simulation even for challenging problems .",
    "k.  bittner and e.  dautbegovic ( 2012_a _ ) , adaptive wavelet - based method for simulation of electronic circuits , in _ scientific computing in electrical engineering 2010 _ ( b.  michielsen and j .- r .",
    "poirier , eds ) , mathematics in industry , springer , berlin heidelberg , pp .  321  328 .",
    "k.  bittner and e.  dautbegovic ( 2012_b _ ) , wavelets algorithm for circuit simulation , in _ progress in industrial mathematics at ecmi 2010 _ ( m.  gnther , a.  bartel , m.  brunk , s.  schps and m.  striebel , eds ) , mathematics in industry , springer , berlin heidelberg , pp .  5  11 .      h.  g. brachtendorf ( 1997 ) , on the relation of certain classes of ordinary differential algebraic equations with partial differential algebraic equations , technical report 1131g0 - 971114 - 19tm , bell - laboratories .",
    "h.  g. brachtendorf ( 2001 ) , ` theorie und analyse von autonomen und quasiperiodisch angeregten elektrischen netzwerken .",
    "eine algorithmisch orientierte betrachtung ' , universitt bremen .",
    "abilitationsschrift .",
    "s.  houben ( 2004 ) , simulating multi - tone free - running oscillators with optimal sweep following , in _ scientific computing in electrical engineering 2010 _ ( w.  schilders , e.  ter maten and s.  houben , eds ) , mathematics in industry , springer , berlin , pp .  240  247 .    e.  ngoya and r.  larchevque ( 1996 ) , envelope transient analysis : a new method for the transient and steady state analysis of microwave communication circuit and systems , in _ proc .",
    "ieee mtt - s int .",
    "microwave symp .",
    "_ , san francisco , pp .  13651368 ."
  ],
  "abstract_text": [
    "<S> * purpose  rf circuits often possess a multi - rate behavior . </S>",
    "<S> slow changing baseband signals and fast oscillating carrier signals often occur in the same circuit . </S>",
    "<S> frequency modulated signals pose a particular challenge . </S>",
    "<S> *    * design / methodology / approach  the ordinary circuit differential equations ( odes ) are first rewritten by a system of ( multi - rate ) partial differential equations ( mpdes ) in order to decouple the different time scales . for an efficient simulation </S>",
    "<S> we need an optimal choice of a frequency dependent parameter . </S>",
    "<S> this is achieved by an additional smoothness condition . </S>",
    "<S> *    * finding  by incorporating the smoothness condition into the discretization , we obtain a nonlinear system of equations complemented by a minimization constraint </S>",
    "<S> . this problem is solved by a modified newton method , which needs only little extra computational effort . </S>",
    "<S> the method is tested on a phase locked loop with a frequency modulated input signal . </S>",
    "<S> *    * originality / value  a new optimal frequency sweep method was introduced , which will permit a very efficient simulation of multi - rate circuits . *    rf circuit simulation , multi - rate simulation , envelope simulation .    </S>",
    "<S> * paper type : * research paper </S>"
  ]
}