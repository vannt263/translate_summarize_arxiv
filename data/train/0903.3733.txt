{
  "article_text": [
    "the coalescences of supermassive black holes ( smbhs ) in binaries are expected to be a major source of gravitational waves ( gws ) for the laser interferometer space antenna ( lisa )  @xcite . due to the huge amount of energy released in gravitational radiation during the final inspiral and merger , these smbh binaries ( smbhbs )",
    "will be detected by lisa at cosmological distances with signal to noise ratios ( snrs ) of many hundreds to thousands .",
    "the brightness of these sources should allow us to conduct high precision cosmology and cosmography , at a level of accuracy that is unprecedented in modern astronomy .",
    "we will be able to detect smbhbs out to a redshift of @xmath1  @xcite with parameter errors of a few percent , and may also be able to use these observations to test the predictions of general relativity , such as the uniqueness of a kerr black hole as the endstate of gravitational collapse .",
    "there is a significant effort being made at present in both parameter estimation ( see for example  @xcite ) and the development of search algorithms for these sources  @xcite . to date",
    ", the most successful search methods have been based on a variant of a markov chain monte carlo ( mcmc ) .",
    "this is a stochastic search method which is highly efficient in searching through high dimensional parameter spaces .",
    "the most commonly employed mcmc variant , referred to as metropolis - hastings monte carlo , has been successfully applied to searches for non - spinning smbhbs in both controlled  @xcite studies , and in blind studies in the context of the mock lisa data challenges  @xcite .",
    "the algorithm uses a number of directed proposal distributions to accelerate the convergence of the search .",
    "however , this method is limited in that it only looks for one source at any one time .",
    "in addition , the nature of the detector response is such that low - frequency smbhbs have bi - modal solutions for the sky location . with the mhmc algorithm",
    ", one would need to run multiple chains in order to explore both modes of the solution .    with this in mind",
    ", we have investigated a new method based on a mixture of evolutionary algorithms , nested sampling  @xcite and metropolis - hastings methods  @xcite .",
    "evolutionary algorithms ( eas ) are becoming a popular method for searching high dimensional parameter spaces .",
    "the idea is to use aspects from evolution , such as birth , death , fitness etc . to evolve a set of organisms within the environment of the parameter space .",
    "most eas work along the principle of generating a random population of organisms , and letting them evolve according to particular rules . at predetermined points during the evolution ,",
    "the fitness of each individual organism is tested .",
    "the fitter organisms are allowed to survive , while the most unfit members are killed off .",
    "a particular type of ea , the genetic algorithm , has already been used in gravitational wave astronomy in the search for galactic binaries  @xcite .",
    "the nested sampling algorithm was developed as a tool for evaluating the bayesian evidence .",
    "it uses a number of live points to climb through nested contours of increasing likelihood .",
    "the algorithm works on the principle that the colony of live points is constantly moving to areas of higher likelihood  at each step a point is found of higher likelihood than the minimum in the set and is used to replace the lowest likelihood point of the cluster .",
    "the primary difficulty of nested sampling is to efficiently sample points of higher likelihood , but techniques have been developed that can achieve this  @xcite . nested sampling techniques have previously been applied to gravitational wave data analysis , in the context of model selection for ground - based gravitational wave detectors  @xcite , but to our knowledge this work is the first application to lisa .",
    "the main advantage of both eas and nested sampling is that they use a number of organisms , whereas the standard mcmc employs just one chain at a time .",
    "as the population of organisms can fracture and recombine into clusters , the organisms can move through the parameter space looking for multiple modes of a solution .",
    "this , for example , allows us to circumvent the problems arising from the fact that all smbhbs produce a bi - modal solution in the sky position .",
    "the detection problem for non - spinning smbh binaries has already been solved , in the sense that several groups have been able to successfully detect and recover parameters for such systems in the mock lisa data challenges . while solving for multiple such binaries",
    "simultaneously will be useful , it is not essential to the success of lisa . however , there are other lisa sources , such as extreme - mass - ratio inspirals , for which it has proven much more difficult to accurately recover parameters  @xcite .",
    "this has been in part because of the large number of secondary modes of the solution that exist in the likelihood surface .",
    "techniques which can simultaneously find multiple modes may be essential for successful identification of these types of signal .",
    "we have chosen to illustrate the ideas of evolutionary algorithms in this paper with an application to the non - spinning smbh problem , since the latter is well understood and hence facilitates direct comparison of these methods to other available techniques .    in this paper",
    ", we will discuss some of the general principles of evolutionary algorithms , and a particular implementation of a hybrid algorithm that combines the various elements outlined above .",
    "the paper is organised as follows . in section  [",
    "sec : waveform ] we describe the gravitational waveform model for non - spinning smbhbs by defining the describing parameter set .",
    "we also outline the parameters of our test sources and the priors we impose on the parameter space . in section  [ sec : lisada ] we define some of the important quantities used in lisa data analysis , such as the fisher information matrix , the signal - to - noise ratio and the detector noise model that we employ . in section  [ sec : mhmc ] we review the metropolis - hastings monte carlo method and outline the advantageous features of this algorithm including simulated and thermostated annealing . in section  [ sec : gbmhmc ] we discuss some of the techniques that allow us to go beyond the metropolis - hastings algorithm .",
    "this includes a description of nested sampling , metropolis - hastings nested sampling , evolutionary algorithms and the clustering methods used to partition the live point set . in section  [ sec : hea ] we describe our hybrid evolutionary algorithm , before presenting in section  [ sec : heares ] the results obtained from using the algorithm to search data sets containing multiple smbhbs .",
    "we finish in section  [ sec : discuss ] with a discussion of possible future applications of these techniques .",
    "the waveform for a binary system composed of two schwarzschild black holes is described by the nine parameter set @xmath2 , where @xmath3 is the chirp mass , @xmath4 is the reduced - mass , @xmath5 are the sky location of the source , @xmath6 is the time - to - coalescence , @xmath7 is the inclination of the orbit of the binary to the line of sight from the observer , @xmath8 is the phase of the gw at coalescence , @xmath9 is the luminosity distance and @xmath10 is the polarization of the gw .",
    "the four parameter subset , @xmath11 , are extrinsic parameters ( i.e. parameters that only affect how the gravitational waveform projects onto a detector response ) , while all the rest are intrinsic ( i.e. parameters that describe the gw phasing at the detector ) .",
    "we point out that @xmath5 , which are normally classed as extrinsic parameters for ground based gw observations , are intrinsic parameters due to the fact that they determine the beam pattern functions and doppler motion , which are time - dependent due to the motion of lisa over the course of an inspiral observation .    in this study , we use the restricted post - newtonian approximation , i.e. we keep only the dominant newtonian term in the gw amplitude . using the low frequency approximation  @xcite ,",
    "the detector response is given by @xmath12 where the phase shifted time parameter is @xmath13 @xmath14 500 secs is the radial distance to the detector guiding center , @xmath15 , @xmath16 is the lisa modulation frequency , @xmath17 gives the initial ecliptic longitude of the guiding center and @xmath18 are the beam pattern functions  @xcite .",
    "the gw polarizations are defined by @xmath19 where @xmath20 is the total mass of the binary , @xmath21 is the reduced mass ratio , @xmath22 is newton s constant and @xmath23 is the speed of light .",
    "the invariant pn velocity parameter is @xmath24 . here",
    ", @xmath25 is the orbital frequency for a circular orbit , which is formally defined as @xmath26 and @xmath27 is the gravitational wave phase .",
    "we take these at 2pn order , using the expressions  @xcite @xmath28\\label{eqn : freq}\\\\ \\phi(t ) & = & \\varphi_{c}-\\frac{2}{\\eta}\\left[\\theta^{5/8}+\\left(\\frac{3715}{8064}+\\frac{55}{96}\\eta\\right)\\theta^{3/8}-\\frac{3\\pi}{4}\\theta^{1/4}\\right.\\nonumber\\\\ & + & \\left.\\left(\\frac{9275495}{14450688}+\\frac{284875}{258048}\\eta+\\frac{1855}{2048}\\eta^{2}\\right)\\theta^{1/8}\\right],\\label{eqn : phase}\\end{aligned}\\ ] ] where @xmath29 the chirp mass , @xmath3 , and reduced mass , @xmath4 are given in terms of @xmath30 and @xmath31 by @xmath32 and @xmath33 .",
    "[ [ sources - being - investigated ] ] sources being investigated + + + + + + + + + + + + + + + + + + + + + + + + + +    in table  [ tab : params ] we list the parameter values for the two mbhbs that we use in this analysis .",
    "we decided to simultaneously search for one coalescing and one non - coalescing source .",
    "the individual masses in the table are the source frame masses .",
    "we chose very wide priors that encompassed both sources at the same time .",
    "these priors are presented in table  [ tab : priors ] .",
    "the relation between luminosity distance and redshift is calculated using the usual relation @xmath34^{-1/2}.\\ ] ] where we use the concordance wmap values of @xmath35 and @xmath36=71 km / s / mpc  @xcite .",
    "the luminosity distances for the two sources are then 6.634gpc and 5.024gpc respectively .",
    "the redshifted chirp mass and mass ratio are @xmath37 for source 1 , and @xmath38 for source 2 .",
    "the last stable orbit frequencies of the sources are @xmath39hz and @xmath40hz respectively .",
    "the signal to noise ratios ( snr ) , which we will define in the next section , are 200 for the coalescing source and 131 for the non - coalescing source .",
    "@*10l @xmath41&@xmath42&@xmath43&@xmath44&@xmath45&@xmath46&@xmath47&@xmath7&@xmath10&@xmath48 1&@xmath49 & @xmath50&@xmath51&@xmath52 & 4.7124&1.0&1.1120&1.2330&2.22202&@xmath53&@xmath50&@xmath54&@xmath55&3.9429 & 0.8 & 0.6565&2.6354&4.6532    @*4l @xmath41&@xmath56&@xmath57&@xmath44 @xmath58&@xmath59 & @xmath60&@xmath61@xmath62&@xmath63&@xmath64&@xmath65",
    "using a geometric model of signal analysis  @xcite , the waveforms can be thought of as inhabiting a vector space with the natural scalar product @xmath66 .",
    "\\label{eq : scalarprod}\\ ] ] and vector norm @xmath67 , where @xmath68 is the fourier transform of the time domain waveform @xmath69 .",
    "the quantity @xmath70 is the one - sided noise spectral density of the detector .",
    "the total noise power spectral density is in two parts : instrumental noise and galactic confusion noise .",
    "the one - sided noise spectral density for the lisa instrument noise is  @xcite @xmath71 . \\end{aligned}\\ ] ] where @xmath72 km is the arm - length for lisa , @xmath73hz and @xmath74hz are the position and acceleration noise respectively .",
    "the quantity @xmath75 is the mean transfer frequency for the lisa arm .",
    "note that we use a pessimistic noise curve which rises steeply at frequencies lower than @xmath76 hz .    to model the foreground confusion noise from galactic white - dwarf binaries , we use the following confusion noise estimate derived from the galaxy model of nelemans , yungelson and portegies - zwart  @xcite @xmath77 where the confusion noise has units of @xmath78hz@xmath79 . in the search , we weight the scalar product , eq .",
    "( [ eq : scalarprod ] ) , with the total power spectral density @xmath80    at low frequency , the three arms of the lisa interferometer can be regarded as being two separate @xmath81 interferometers , with the signal in each of the detectors given by @xmath82 where @xmath83 label the detectors .",
    "we assume that the noise @xmath84 is stationary , gaussian and uncorrelated in each detector , and characterized by the noise spectral density @xmath70 . using the scalar product , eq .",
    "( [ eqn : scalarprod ] ) , the optimal matched filtering snr in each detector is @xmath85 given some signal @xmath86 , the likelihood that the true parameter values are given by a parameter vector @xmath87 is @xmath88 where @xmath89 is a normalization constant .",
    "the maximum likelihood corresponds to the parameter set that minimizes the exponent in the above equation . as most smbhbs in lisa will have high snr , the errors in the parameter estimation at the maximum will have a gaussian probability distribution given by @xmath90 where @xmath91 is the fisher information matrix ( fim ) @xmath92 and @xmath93 .",
    "when we use both lisa detectors the total snr is given by @xmath94 while the total fim is given by @xmath95 the inverse of the fisher matrix gives the variance - covariance matrix @xmath96 the diagonal elements of @xmath97 is a @xmath98 estimate of the error in the recovered parameter @xmath99 while the off - diagonal elements can be used to obtain the correlations between the various parameters @xmath100    as described earlier , it is possible to divide the parameter space for smbhb inspirals into intrinsic parameters , @xmath101 , and extrinsic parameters , @xmath102 .",
    "it is possible to maximize the likelihood over the extrinsic parameters analytically using a generalisation of the f - statistic  @xcite .",
    "the details of this maximization for smbh binary systems are given in  @xcite so we do not repeat it here .",
    "however , we do make use of the f - statistic in our search in order to reduce the dimensionality of the parameter space that we must search .",
    "in previous works  @xcite a version of markov chain monte carlo ( mcmc ) , called metropolis - hastings monte carlo ( mhmc ) , has been used to successfully search for non - spinning smbhbs .",
    "this variant employs a number of different techniques during the search phase which contravene the markovian property normally required by standard mcmcs . starting with the signal @xmath103",
    ", we choose a starting point randomly in the parameter space , @xmath87 , with template @xmath104 .",
    "we then draw from a proposal distribution , @xmath105 , and propose a jump to another point in the space @xmath106 . in order to evaluate whether or not we move",
    ", we calculate the metropolis - hastings ratio @xmath107 here @xmath108 is the prior on the parameters and @xmath109 is the likelihood .",
    "this jump is then accepted with probability @xmath110 , otherwise the chain stays at @xmath87 .",
    "the efficiency of any mhmc search is highly dependent on the proposal distributions used . in previous works , to make small jumps in the parameter space , the most efficient proposal distribution is a multi - variate gaussian distribution with jumps that use a product of normal distributions in each eigendirection of the fim , @xmath111 .",
    "here we use latin indices to indicate that this is the fim on the 5-@xmath112 subspace of intrinsic parameters .",
    "the standard deviation of the jump in each eigendirection is given by @xmath113 , where @xmath112 is the dimensionality of the search space ( 5 in this case ) and @xmath114 is the corresponding eigenvalue ( the factor of @xmath115 ensures an average net jump of @xmath116 ) .",
    "other similar proposal distributions may also be used to make medium and large jumps .",
    "in addition , due to the response of the lisa detector , it is necessary to include a proposal that jumps to the antipodal sky position , i.e. @xmath117 .",
    "one of the fastest ways to improve convergence is to ensure that one is using adequate proposal distributions .",
    "however , it has also been shown that by ignoring the markovian property , the convergence speed of the algorithm can be greatly increased .",
    "the primary modification that increased the convergence speed was the introduction of a number of different annealing schemes . the first called frequency annealing  @xcite initially uses a short duration , low frequency waveform `` snippet '' , and then gradually increases the frequency band of the template .",
    "the main advantage of this particular annealing scheme is that it avoids a very difficult problem in the detection of smbhbs . for bright smbhbs ,",
    "most of the snr comes in the last few days before plunge as the binary enters the highly relativistic regime .",
    "the problem in parameter estimation is that the frequency and phase are increasing very quickly during this phase , and in a high dimensional parameter space it can be very difficult to match .",
    "the frequency annealing avoids this problem by first fitting the early waveform where the frequency evolution is slow .",
    "as the template lengthens and approaches the highly relativistic regime , the chain is then close enough in parameter space to acceptably lock onto the true solution . in this work",
    "we do not use frequency annealing .",
    "however , we do employ the other annealing schemes that we now describe .",
    "[ [ simulated - and - thermostated - annealing ] ] simulated and thermostated annealing + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    simulated annealing works by treating the likelihood like a partition function with an inverse heat . in the definition of the likelihood , eq .",
    "( [ eqn : likelihood ] ) we can replace the factor of 1/2 in the exponent with a parameter @xmath118 , such that @xmath119 where @xmath120 is the heat - index defining the initial heat , @xmath121 is the number of the step in the chain and @xmath122 is the cooling schedule .",
    "this heats the likelihood surface making it easier to move in an uphill direction .",
    "one of the problems with simulated annealing is knowing , a priori , exactly what the optimal starting temperature should be , especially as each optimal initial heat is source dependent .",
    "if the initial temperature is too hot , we waste too many computer cycles jumping randomly over the likelihood surface .",
    "if it is too low , we quickly converge to a secondary solution and stay there .",
    "to circumvent this problem , the concept of thermostated annealing was introduced  @xcite . in this case",
    "the heat injected into the likelihood surface becomes a function of the shape of the surface .",
    "the thermostated heat is defined by @xmath123 which ensures that once we reach an snr greater than @xmath124 , the effective snr never exceeds this value .",
    "in this section we describe how we can go beyond the mhmc algorithms by constructing a hybrid evolutionary algorithm ( hea ) .",
    "this involves using concepts such as nested sampling , a variant of the mhmc and aspects of evolutionary computation .",
    "we will treat each modification in turn .",
    "nested sampling ( ns )  @xcite was developed as a method for model comparison in bayesian statistics .",
    "the main advantage of the method was the ability to directly calculate the evidence , something which is notoriously difficult for other algorithms , such as mcmc , to do .",
    "the ns algorithm works by randomly populating the parameter space with a number of live points chosen from some prior @xmath125 , where @xmath45 are the parameters of the system .",
    "the live points are then sorted in order from the lowest to highest likelihood points . at each iteration @xmath121 ,",
    "the idea is to find a new point @xmath126 such that @xmath127 and @xmath128 .",
    "once such a point has been found , the lowest likelihood point in the set is deleted and replaced with the new point . as a consequence",
    ", the entire cluster of points moves to higher likelihood by climbing through nested contours of likelihood , while keeping the number of live points constant .",
    "the new point can be found by uniform , random sampling of the prior . however , the main difficulty in nested sampling is the need to find a higher likelihood point via this random prior sampling .",
    "depending on the distribution of live points and the shape of the likelihood surface , it can be time consuming to find a new point by random sampling . a more efficient way of sampling higher likelihood points from the prior is known  we decompose the distribution of live points as a superposition of overlapping ellipsoids and sample from within one of these , chosen at random , and with appropriate weight , from the set .",
    "this is the approach employed in the multinest algorithm  @xcite .",
    "one way to find a higher likelihood point that avoids the need to randomly sample from the prior is to use a mhmc move within the algorithm . at step",
    "@xmath121 , when the lowest likelihood in the cluster is @xmath129 , a point ( not necessarily the point of lowest likelihood ) , with parameters @xmath130 , is chosen at random , and then a short ( 20 - 30 ) iteration markov chain is used to move that organism , ending at a point with parameters @xmath131 .",
    "this final point is compared to the lowest likelihood point in the cluster ( not the original point ) and the lowest likelihood is replaced by the point @xmath131 with probability @xmath132 , where @xmath133 it is desirable to use a multiple - step mhmc to ensure that the @xmath131 is uncorrelated with the initial random point @xmath130 . the new point is included if it has improved the fitness of the cluster and reduced the total prior volume of the point set ( i.e. , has higher values of the priors ) . the new point may also be accepted if it only improves the likelihood .",
    "one of the key aims in developing these new algorithms was to tackle likelihood surfaces that are multi - modal .",
    "an important element in this is to separate out different modes of the solution as they are identified , in order to avoid the whole population migrating to the same peak of the likelihood surface .",
    "mode separation is achieved by clustering the live points periodically into individual groups which are then evolved separately . after a pre - defined number of steps ,",
    "the clustering is re - evaluated in case modes have merged together or separated further .",
    "the clustering is achieved via an algorithm based on the ` k - means ' and ` x - means ' techniques  @xcite .    in the ` k - means ' algorithm , the number of modes , @xmath134 , that the set of points will be partitioned into is specified in advance . the point division is then achieved by ( i ) choosing the first @xmath134 centres at random ; ( ii ) assigning each point to the centre to which it is closest ; ( iii ) computing the centroid of the points within each cluster and updating the cluster centres to these values ; ( iv ) iterating ( ii ) and ( iii ) until a steady state is reached , or a pre - specified number of iterations have been attempted .    the ` x - means ' algorithm  @xcite aims to determine the `` best - fit '' number of clusters that characterizes the live point set . at each step , the k - means algorithm is applied to the point set and the goodness - of - fit of each k - mode decomposition is assessed using a suitable criterion . in our implementation",
    "we use the bayesian information criterion ( bic ) , which is @xmath135 where @xmath136 is the log - likelihood of the data according to model @xmath112 , evaluated at the maximum likelihood point , @xmath137 is the number of data points and @xmath138 is the number of parameters in the model , @xmath139 . if we represent all the clusters as identical spherical gaussians , with variance @xmath140 , the maximum log - likelihood for a cluster containing @xmath141 points is @xmath142 where @xmath143 is the dimensionality of the parameter space and @xmath134 is the number of means used at this clustering stage .",
    "the total log - likelihood is given by the sum of the likelihoods for the @xmath134 clusters .",
    "the number of free parameters , @xmath138 , is the sum of @xmath144 class probabilities , @xmath145 centroid coordinates and one variance estimate  @xcite .",
    "the user specifies a minimum and a maximum value of @xmath134 to try .",
    "the algorithm is then ( i ) set @xmath146 ; ( ii ) perform a k - means division and record the bic score ; ( iii ) for each cluster point set , perform a ` 2-means ' division of that set ; if the bic of the 2-mode model is higher than the bic of the 1-mode model , accept the division , otherwise reject it ;",
    "( iv ) evaluate the bic of the whole resulting set of @xmath134 clusters and record it ; ( v ) if @xmath147 , set @xmath148 and repeat steps ( ii)(v ) , else stop ; ( vi ) compare bic scores of all recorded k - means divisions and accept the value of @xmath134 with the highest bic .",
    "the likelihood given by equation  ( [ biclik ] ) assumes clusters are identical and spherical , but we have also tried a modified bic in which each cluster is modeled as an independent ellipsoid .",
    "this increases the number of model parameters required to describe each cluster .",
    "this did not improve the performance of the algorithm , which is why we continued to employ the spherical version of the bic .",
    "the other refinement we considered was in the choice of distance measure .",
    "the easiest distance measure to use when assigning points to clusters and determining the centroid is the euclidean distance measure on a unit hypercube , i.e. , we rescale each coordinate so that they range from @xmath149 to @xmath150 over the prior .",
    "the natural measure on the waveform parameter space is the fisher matrix derived distance , as this describes the expected shape of likelihood peaks , and therefore the shape that we expect clusters to approach at late times .",
    "we have implemented a fisher matrix version of the clustering algorithm , but it did not show sufficient improved performance to warrant the additional computational overhead .",
    "however , the fisher matrix does inform us as to which parameters have significant influence on the likelihood , and which parameters have a more minor influence .",
    "this allows us to construct a suitable rescaled set of coordinates ( not a unit hypercube ) for which the likely size of the likelihood peaks in each parameter direction would be comparable .",
    "we found this was the better approach to clustering , since it tends to make clusters as spherical as possible , and was the version of the clustering finally employed .",
    "evolutionary algorithms ( eas ) have been used extensively in other fields .",
    "these algorithms use aspects from evolutionary biology and natural selection as search techniques in high dimensional spaces .",
    "the most common criteria introduced are concepts like fitness , altruism , selection , leadership , birth , death etc .",
    "a form of evolutionary algorithm , the genetic algorithm , has already been used in gravitational wave data analysis  @xcite to search for galactic binary systems . within the framework of eas , the candidate solutions play the role of organisms in an environment .",
    "the main advantage of the ea is that it makes no a priori assumptions about the underlying landscape .",
    "these algorithms also have the advantage that they have many organisms travelling over the likelihood surface simultaneously , whereas a standard mcmc algorithm relies on a single chain .",
    "the population evolves according to the principle that each successive generation must be fitter than the last .",
    "the general aim , at each iteration , is to find the weakest member of the population and replace it with a fitter organism . as we are using a population of organisms",
    ", there is a reduced chance that the algorithm will get stuck on a local maximum .",
    "one aspect that we do not use in our ea is mutation . in genetic algorithms",
    ", mutation plays an important role .",
    "this is achieved by representing the candidate solutions in a binary string and changing one of the bits . however , from evolutionary biology , it is now clear that mutation plays more of a negative than positive role in evolution .",
    "most mutations result in directing that particular species towards extinction .",
    "ironically , the main disadvantage of an ea comes from its main advantage .",
    "as we said , an ea makes no prior assumptions about its underlying landscape .",
    "but because of this , it has no concept of the difference between a local and global maximum , nor does it have any natural stopping criterion . in the following subsections ,",
    "we describe some of the features of our hybrid evolutionary algorithm ( hea ) .      in this study",
    "we decided to search a data set with two sources .",
    "of these sources , one is coalescing within the observation time , and the other coalescing very shortly after the period of observation has finished . as we knew a priori that the sources had these particular characteristics , we chose our initial set of organisms such that half would search for the coalescing source , and the other half would search for the non - coalescing source .",
    "this places each of the organisms in one of two sub - regions in @xmath151 space .",
    "our first fitness condition was that , to be accepted , an organism must have a log likelihood corresponding to at least a certain snr , which we took to be 20 for non - coalescing organisms , or a snr of 30 or greater for coalescing organisms . in principle , the choice of initial fitness is down to the user .",
    "we can choose the two fitness criteria to be different from one other from the knowledge that , in general , non - coalescing sources are dimmer .",
    "we should mention that even though we had a priori knowledge of the solutions , our fitness criteria were still set low relative to the snr of the global solution .    to begin the search , in each sub - region , we choose the first two points at random , drawing from the prior until the first fitness criterion is satisfied by both organisms .",
    "we then continue to choose points at random , but after the second point , each new accepted organism must satisfy a second fitness condition in addition to the first .",
    "we require that each new organism has a log likelihood which is greater than the mean log likelihood in the sub - region , i.e. @xmath152 for @xmath153 .",
    "this ensures that each new organism is fitter than the mean fitness of the local population .",
    "once the desired number of organisms have been generated , we allow them the chance to improve their fitness by exploring their locality .",
    "for this we move each organism for 300 iterations of an uphill climber mcmc , i.e. , jumps are only accepted if the new likelihood is greater than the previous likelihood .",
    "this aims to put each organism onto the nearest peak of the likelihood surface at the start of the search .",
    "the improvement can be small for some live points , but is large for others .",
    "while this initial phase is the most time consuming part of the search , we have found that it is important for the subsequent rapid convergence of the algorithm . once this investigative phase is complete ,",
    "we perform the first partition of the live points .      as described in section  [ sec : clus ] , we can specify the range of the number of clusters into which the clustering algorithm attempts to partition the live point set .",
    "for this particular search we told the algorithm that there were between 2 and 8 possible solutions .",
    "this was equivalent to telling the algorithm that there were between 1 and 4 possible sources in the data , assuming that the algorithm would only find the true solution and the antipodeal sky solution .",
    "if there were less than four sources , it then allowed the algorithm to find other secondary maxima in the likelihood .",
    "one of the important things for the evolution of each cluster is the choice of heat used for simulated annealing in that region of the likelihood surface .",
    "initially all clusters are given the same heat , as we use a common simulated annealing scheme .",
    "however , once the heat for the simulated annealing drops below a certain value , we change this approach . in geometrical terms , each cluster occupies a voronoi region of the parameter space ( see figure  [ fig : voronoi ] ) . as each cluster",
    "will eventually be associated with a mode of the likelihood of different brightness , it does not seem logical to subject each cluster to the same heat . to improve convergence",
    ", we allowed each voronoi region to have a different thermostated heat depending on the snr of the fittest member of each cluster .",
    "this allows the fitter clusters to move faster through the parameter space .",
    "as all the clusters improve in fitness , the heat equilibrates between the voronoi regions associated with the same source .",
    "another advantage of the different heats in the different voronoi regions is that the clusters evolve independently .",
    "in other words , there is no inter - cluster competition .",
    "all competition between organisms occurs only within a cluster . at each step , we update the clusters in one of three ways . the first is a straight - forward update , where we try to update the lowest likelihood organism of each cluster by a random choice of parameters within a certain distance of its current location . to do this ,",
    "we construct a hypercube in the parameter space around the current point , where the distance from the current point to the surface of the hypercube is given by @xmath154 where @xmath155 are the diagonal elements of the inverse fim , @xmath156 is the heat associated with that particular cluster and @xmath157 is a scaling factor .",
    "the scale factor decreases the volume of the hypercube in a monotonic fashion as we make subsequent trials .",
    "the reason for this scaling is to encourage the lowest likelihood organism to improve its fitness by allowing it to look initially at some distance away , but eventually looking in its nearby environment as well . for this particular move",
    "we allow the organism 100 attempts to become fitter , assigning @xmath157 values between 1 and 1/100 .",
    "the second option for a cluster to move is to choose an organism at random within the cluster and update it using the mhmc technique described in section  [ sec : mhns ] . if we can not improve the likelihood this way , we try to update the lowest likelihood organism in a similar manner . in both cases",
    "we allow the organism 50 attempts with the directed proposal distributions to improve their fitness .",
    "the third option is to try and sample a new point uniformly from within an iso - likelihood contour passing through the lowest likelihood live point of the set . to achieve this",
    ", we find the best fit ellipsoid to the current live point set , and assume that this represents the shape of the likelihood contours .",
    "we then draw uniformly from within the ellipsoid through the lowest likelihood point until a higher likelihood point is found .      while there is no inter - cluster competition , we re - cluster the organisms after a predetermined number of iterations ( 20 in this analysis ) , which allows immigration / emigration between clusters .",
    "this also allows cluster numbers to change over the course of the run .",
    "in general we find that each cluster has an optimal population size .",
    "if the cluster is too small or too big , it does not evolve as quickly as other clusters .",
    "one aspect that we may explore in the future is to examine the global fitness of a cluster , as well as the fitness of the individual organisms . in cases where we find the rate of increase of the overall fitness of the cluster beginning to slow ,",
    "we could induce forced immigration / emigration .",
    "the concept of elitism has been very important in evolutionary biology and is also becoming important in evolutionary algorithms . in this algorithm",
    "we single out the fittest member of each cluster and allow them the opportunity to improve their current fitness level .",
    "this accelerates the convergence of the algorithm over a straight - forward nested sampling search . in that case",
    ", the fittest member has to be selected at random , or another organism may become the fittest . in our algorithm , being the fittest is rewarded with special treatment over all others . in this case the fittest member of each cluster is never replaced and in fact , guides the direction of the entire cluster .",
    "we should point out that we do allow competition within each cluster , so that while the fittest organism is given special treatment , other organisms can become the fittest member of the cluster .",
    "this competition prevents a runaway scenario where a cluster evolves too quickly and gets stuck on a secondary solution .",
    "we also attempt to improve clusters with the ideas of altruism and crossover .",
    "altruism is normally defined as a selfless concern for the welfare of others , whereas crossover is defined as the creation of a new organism using information from existing organisms . in this context",
    "we use altruism as follows : we assign a particular fitness criterion to the fittest members of any cluster associated with a particular solution .",
    "if one cluster is not performing very well , the fittest member of the fittest cluster is moved to the under - performing cluster .",
    "the crossover then comes in as follows : the now fittest member breeds with the second fittest member ( this is done very simply by exchanging combinations of chirpmass , reduced mass , time to coalescence , or a mixture of all three ) . the new organism should now be fitter than the weakest member of the cluster . if this is the case , the weakest member is replaced .",
    "if not , the fittest member is reabsorbed into a better performing population during the next round of clustering .",
    "one of the most crucial aspects of all evolutionary algorithms is the ability to reduce the volume of the priors in an efficient manner . at the beginning of the algorithm",
    "we divide the organisms into coalescing and non - coalescing solutions , thus splitting the total volume of the parameter space . once the centroids of each cluster start to converge to local solutions , we use their fitness information to decide on whether or not they should guide the other clusters . for this",
    "we proceed as follows : as each cluster moves through the parameter space , we examine the fitness of the cluster members .",
    "the fitness of the worst and best organisms define the prior volumes for the source parameters .",
    "we also examine the values of the times of coalescence to see if we can associate each cluster with the same source .",
    "we call clusters part of the same family if the difference between the fittest members of each cluster is less than @xmath158 years .",
    "this corresponds to about 8.8 hours ( while always possible , it seems unlikely that two sources would be coalescing in the same @xmath159 hour period ) .",
    "if we can associate two separate clusters as being part of the same family of solutions , we ensure that the priors for the best performing cluster are included in the priors for the other family members as well .",
    "this prevents a cluster confining itself to a distant solution without the possibility of improving .",
    "we ran the search algorithm for 1500 iterations using 80 live organisms on a data set containing the two sources listed in table  [ tab : params ] . to recap the algorithm ,",
    "the initial search divides the number of organisms between coalescing and non - coalescing organisms .",
    "the original population of organisms is selected so that each successive organism is fitter than the current mean fitness of the population . once the population has been created , the organisms are allowed the opportunity to improve their fitness using an uphill climber proposal .",
    "we then create a number of centroids at random and allow the organisms to be clustered into sub - populations .",
    "afterwards , the clusters evolve according to the methods outlined in the previous sections .",
    "we point out once again , that all inter - organism competition is confined to individual clusters and there is no inter - cluster competition . during the first 750 iterations we use a mixture of simulated and thermostated annealing , while for the final 750 iterations we use a slow cool - down until unit heat was reached . in all cases",
    "we allow the temperature in each voronoi region to evolve independently . in figures  [ fig : skysearch]-[fig :",
    "masstimesearch ] we show the evolution of the live point set as it searches for the two sources . in each plot",
    "we have four cells .",
    "going from left to right , top to bottom , we plot the parameters at the following points : ( a ) after the first clustering has taken place , ( b ) after 200 iterations , ( c ) after 780 iterations and ( d ) the final positions in the parameter space .            . for the dim source",
    ", there is a greater spread in both parameters .",
    "however , by 200 iterations , we have converged on the correct answer for both sources , and we have one extra cluster associated with the dim source . by 780 iterations , this cluster has also migrated to the primary solution .",
    "note once again the shrinking axes in each cell . ]    in figure  [ fig : skysearch ] we track the evolution of the organisms in the @xmath5 subspace .",
    "we can see that even after the initial selection criteria has been satisfied and the first clustering has taken place , the organisms are spread throughout the parameter space , although some of the fitter organisms are already close to the main modes of the solution . after two hundred iterations ,",
    "most of the organisms have started to cluster around the two modes ( i.e. , the real and antipodal sky locations ) of each source , or one of several secondary modes . by 780 iterations",
    ", the original population has fragmented into eight individual clusters . of these , four match the expected modes of the solution .",
    "the other four clusters have matched secondary solutions .",
    "what is interesting about the solutions at this point is that the sky modes appear in reflective pairs , with the secondary pair rotated to almost @xmath160 from the primary modes .",
    "this also happens to be approximately the sky - location of the other source in each case , i.e. , there is a secondary mode of the coalescing source at roughly the sky position of the non - coalescing source and vice - versa .",
    "this is an interesting feature of the multi - source likelihood surface that warrants further investigation . by the end of the run",
    ", the primary modes have refined their solutions , and one of the secondary modes of source 1 has migrated to one of the primary modes .",
    "figure  [ fig : masssearch ] shows the evolution in the @xmath161 subspace . in this case we see that , even with a quite competitive initial fitness criterion , there is still a wide spread in the possible masses of the organisms , with chirp masses ranging from @xmath162 and reduced mass ranging from @xmath163 .",
    "after 200 iterations the volume of the parameter space has shrunk dramatically .",
    "the organisms have already converged on the true solutions for the bright source .",
    "it is clear that while the organisms have also converged to the correct chirp mass , there is quite a spread in reduced mass for the dimmer source . by 780 and 1500 iterations , the organisms have begun to converge and in fact , only carry out a small refinement during this period . in figure",
    "[ fig : masstimesearch ] , we plot the evolution in the @xmath164 subspace . in this case",
    "we can see that the initial fitness criteria has had an interesting effect . for the bright source , while there is a large spread in chirp mass , all the organisms have approximately the correct coalescence time .",
    "this is presumably because a significant fraction of the snr accumulates near coalescence .",
    "for the dimmer source , as the coalescence is not seen , there is a greater spread in both parameters .",
    "after 200 iterations a number of the clusters have converged to the correct solutions , although one cluster associated with the dim source has moved toward the edge of the prior , with a low mass value and a coalescence time of approximately 1.05 years . however , by 780 iterations , all the organisms have converged to the correct solutions in this subspace , and the solutions are then further refined until the end of the run .    in order to give a quantitive assessment of the algorithm , in table  [ tab : parerrs ] we quote the predicted one sigma errors from the fisher matrix .",
    "we also quote the errors for the antipodal sky solutions having taken care of the appropriate rotations for the inclination and polarization angles .",
    "note that as this search is based on the f - statistic , we only quote errors for the five parameters for which we search . in table  [ tab : eaerrs ] we give the errors in the recovered parameters as multiples of the fisher matrix error estimate , i.e @xmath165 , where @xmath166 denotes true value , map denotes maximum a posteriori value and @xmath167 is the fisher matrix one sigma error prediction .",
    "we can see that the algorithm did extremely well on the bright source , with all recovered parameters within @xmath168 of the true values . the performance for the dim source , while not as impressive , was still good , with all recovered parameters within @xmath0 of the true answer . while it is clear that there is still some tuning to do , to our knowledge , this is the first time that a simultaneous detection of smbhbs has been attempted for lisa .",
    "the important conclusion is that not only did we find the two sources , but we also found all the modes of each source . in terms of run time , the algorithm took about ten hours to run on a macbook pro with a 2.6 ghz dual - core processor and 4 gb of memory .",
    "of these ten hours , about four hours are spent refining the initial population .",
    "@*6l source&@xmath169&@xmath170&@xmath171yrs&@xmath172rads&@xmath173rads 1&@xmath174 & @xmath175&@xmath176&@xmath177&@xmath178 1a&@xmath179&@xmath180&@xmath181&@xmath182&@xmath183 2&@xmath184 & @xmath185&@xmath186&@xmath187 & @xmath1882a&@xmath189&@xmath190&@xmath191&@xmath192&@xmath193    @*6l @xmath41&@xmath194&@xmath4&@xmath195&@xmath45&@xmath46 1&@xmath196 & @xmath197&@xmath198&@xmath199 & 2.13381a&@xmath200&@xmath201&@xmath202&@xmath203&2.8196 2&@xmath204 & @xmath205&@xmath206&@xmath207 & 2.41972a&@xmath208&@xmath209&@xmath210&@xmath211&1.7567",
    "we have developed a hybrid evolutionary algorithm and applied it to the problem of simultaneous detection of two smbhbs in lisa data .",
    "the algorithm uses aspects from nested sampling , metropolis - hastings theory and evolutionary computation to evolve a population of organisms through the parameter space . after an initial selection based on a particular fitness criterion ,",
    "the organisms are clustered into sub - populations .",
    "we then evolve these clusters according to a number of different criteria . while we do not allow inter - cluster competition , we do permit emigration / immigration between clusters and all inter - organism competition takes place on a local level .",
    "each cluster occupies a voronoi space , and in each space we use a combination of simulated and thermostated annealing . by allowing each voronoi region to have its own heat , we find that the clusters evolve more rapidly .",
    "using this hybrid algorithm , we were able to detect the two injected smbhbs simultaneously . as well as detecting the true sky solution mode , we were also able to detect the antipodal sky modes . furthermore , we also detected secondary mode solutions for each of the sources . in both cases the maximum a posteriori parameter values were within @xmath0 of the injected values . at present",
    "the algorithm uses 80 organisms , and the entire run takes about 10 hours on a macbook pro laptop .",
    "the code in its current state uses a number of aspects that can be trimmed in the future , which should make it possible to reduce the run time by at least @xmath212 .",
    "it is clear that this algorithm has a lot of potential and is worth developing further in the context of gravitational wave astronomy .",
    "it is not immediately clear how the algorithm s performance will scale when used to search for other lisa source types , such as spinning black holes or emris , where the likelihood surface contains many more secondaries .",
    "we plan to explore the application of this technique to these other cases in the future .",
    "the hea was originally based on the nested sampling algorithm described in  @xcite , but that work has now been superceded by the improved multinest algorithm  @xcite .",
    "the multinest algorithm is entirely model - independent in the sense that the problem to which it is applied enters specifically only in the computation of the likelihood and not in the techniques used to update the live point set .",
    "it utilizes an efficient way to sample higher likelihood points from the prior by decomposing the distribution of live points as a superposition of overlapping ellipsoids .",
    "one of these ellipsoids is chosen at random , with appropriate weight , from the set and a new point is sampled uniformly from within it .",
    "the algorithm has proven to be very effective in many different applications  @xcite .",
    "we are also in the process of exploring the application of this algorithm to gravitational wave data analysis problems , and these results will be reported elsewhere .",
    "+ we thank farhan feroz and mike hobson for first pointing us to the nested sampling algorithm , and for very useful discussions and collaboration on this project .",
    "jg s work is supported by a royal society university research fellowship .",
    "99 k.  danzman et al . , _ lisa pre - phase a report _ , max - planck - institute fur quantenoptic , report mpq 233 ( 1998 ) ."
  ],
  "abstract_text": [
    "<S> we describe a hybrid evolutionary algorithm that can simultaneously search for multiple supermassive black hole binary ( smbhb ) inspirals in lisa data . </S>",
    "<S> the algorithm mixes evolutionary computation , metropolis - hastings methods and nested sampling . </S>",
    "<S> the inspiral of smbhbs presents an interesting problem for gravitational wave data analysis since , due to the lisa response function , the sources have a bi - modal sky solution . </S>",
    "<S> we show here that it is possible not only to detect multiple smbhbs in the data stream , but also to investigate simultaneously all the various modes of the global solution . in all cases , </S>",
    "<S> the algorithm returns parameter determinations within @xmath0 ( as estimated from the fisher matrix ) of the true answer , for both the actual and antipodal sky solutions .    </S>"
  ]
}