{
  "article_text": [
    "with the advance of electronics , data acquisition ( daq ) and computing capabilities , it is more and more common to use flash analog to digital convertors ( fadcs ) as the general - purpose readout device for different detectors .",
    "typically , the entire pulse shape from the individual detector module , as well as the relative timing between pulses from different detector channels , are recorded .",
    "such readout scheme replaces analog digital convertors and time - to - digital convertors , which give information only on the amplitude or integrated area and the timing of the pulses , respectively .    with fadcs as readout ,",
    "the information related to a single pulse is represented by many measurements .",
    "frequently , multi - channel ( order of hundreds and thousands is common ) fadc systems are deployed . as a result ,",
    "a large volume of data have to be extracted , stored and processed .",
    "the _ n_-bit resolution per time - bin and the sampling rate of the fadc are important parameters which will have tremendous effect on the characterization and performance of the experiment such as detector resolution , daq dead time , data size , data processing time , cost and so on .    a motivated question to address is therefore `` what is the dynamic range of an n - bit fadc , beyond the nominal @xmath9 value ? '' that is , can the crucial information like the total area as well as the rise and fall times be reconstructed , even though part of the pulse @xmath10 the largest and usually the most important part @xmath10 is not recorded ? these are the focuses of investigation of this article .    in section  [ sect::basic ]",
    ", we describe the research program on which this project is based , and the hardware used to generate the data which allow such an investigation .",
    "two approaches are surveyed and compared .",
    "one of the algorithms , the charge summation correction method , showed better potentials and were pursued in depth .",
    "the goals are to achieve both energy reconstruction and particle identification even for saturated events .",
    "the details and results are discussed in section  [ sect::partq ] .",
    "though the algorithm was developed and tested with scintillating csi(tl ) crystal detectors , the approach is generic and can be applicable to other detector schemes using fadc readout as well .",
    "the present investigation is part of the research program of the texono collaboration  @xcite .",
    "a csi(tl ) scintillating crystal  @xcite array with 2  kg modular mass and a total mass of 186  kg is taking data at the kuo - sheng ( ks ) nuclear power plant to study low energy neutrino physics .",
    "each module is read out by two photo - multipliers ( pmts ) and the signals are recorded by a 20  mhz fadcs with 8-bit resolution  @xcite . the fadc value at the @xmath11 time - bin is denoted by @xmath12 .",
    "throughout this work , we use the normalized value @xmath13 which is @xmath12 divided by the saturation level @xmath14  : @xmath15",
    ".    the physics requirements of the experiment are that events with energy from 10  kev to 10  mev can be reconstructed , and that pulse shape discrimination ( psd ) can be applied to these events to achieve event ( @xmath16/@xmath17 ) identification .",
    "that is , a dynamic range of at least 1000 is necessary with an 8-bit resolution readout per time - bin .",
    "special data were taken to devise techniques and to develop software algorithms addressing this issue .",
    "a @xmath18 csi(tl ) crystal was used and signals were read out by a single pmt and a fadc channel at identical settings to the ks experiment .",
    "the trigger was set at the @xmath19 fadc time - bin , such that the pulse information of @xmath20=5  @xmath21s ( 100 time - bins ) and @xmath22=25.6@xmath23s ( 512 time - bins ) before and after the trigger were recorded , respectively .",
    "both @xmath16 and @xmath17 events were taken by activating the csi(tl ) crystal with @xmath24am - be and @xmath25cs sources , respectively .",
    "the amplitude of the pulse was adjusted by selecting the appropriate pmt high voltage .",
    "typical unsaturated and saturated pulses are displayed in figures  [ singlepulse]a and [ singlepulse]b , respectively .",
    "a large sample of unsaturated events are added together to produce a smooth reference pulse shape @xmath26(t ) , where the peak amplitude is normalized to 1 .",
    "the profiles of @xmath26(t ) due to @xmath16- and @xmath17-events are depicted in figure  [ pulseshape ] , and can be fitted to the function  @xcite @xmath27 \\ast [ ~ \\frac{1}{\\tau_1 } ~ exp ( - \\frac{t}{\\tau_1 } ) + \\frac{r}{\\tau_2 } ~ exp ( - \\frac{t}{\\tau_2 } ) ~ ] ~ .   } \\ ] ] the rise time(@xmath28 ) and fall times(@xmath29 ) as well as the ratio between the slow and fast decay components(r ) are listed in table  [ time ] .",
    "the normalization constant n is chosen to make the peak amplitude equal to unity .",
    "the values of @xmath28 are dominated by the electronics shaping rise time of 250  ns  @xcite , while ( @xmath29 ) are due to the characteristic fluorescence time profile of csi(tl ) .",
    "saturated events are those with pulse amplitude larger than those corresponding to the maximum fadc value of @xmath34 .",
    "the focus of this section is to devise an algorithm with which energy reconstruction and event identification by psd can be achieved for these class of events .",
    "two approaches were surveyed as initial studies :    1 .   * statistical approach * in principle , one can derive the values of n in equation  [ eq::shape ] , using maximum likelihood analysis or minimum @xmath35 fitting methods , based only on the ( @xmath36,@xmath12 ) data where @xmath37 .",
    "the values of @xmath38 are adopted from those in table  [ time ] . in practice ,",
    "the fits are computer - time consuming and unstable .",
    "the efficiencies are bad , especially when the saturation is severe .",
    "the main reason is that the values of @xmath28 and @xmath39 are derived from small portions of the pulse shape .",
    "when the data from these portions are missing due to saturation , there will be insufficient constraints such that it is difficult for the analysis procedures to converge to the optimal values for n. 2 .",
    "* pulse analysis approach * the objective of this approach is to identify measure - able values which are related to the physics variables of interest , namely , the total energy and the decay time .",
    "the observables are the `` saturated charge '' and `` mean time '' .",
    "this method uses all the available information from the saturated pulses .",
    "such an approach can be compared to @xmath10 and in fact inspired by @xmath10 the `` double charge method ''",
    "@xcite commonly - used to achieve @xmath16/@xmath17 identification in liquid  @xcite and crystal  @xcite scintillators .",
    "results of the initial surveys indicated that the pulse analysis approach would show better promises .",
    "the `` charge summation method '' based on this approach was therefore pursued in details .",
    "we discuss the algorithm , its consistency checks and performance in energy reconstruction and event identification in the following sub - sections .      from a standard reference pulse shape",
    ", a relationship is obtained between the `` saturated charge ( @xmath40 ) '' defined by the integration of the saturated events and the `` total charge ( @xmath41 ) '' from that of the raw fully - recorded pulses .",
    "a relationship between @xmath41 and @xmath40 for the saturated events ( that is , when @xmath56 ) can then be obtained .",
    "it is described by a polynomial function @xmath57 for both the @xmath17- and @xmath16-samples as displayed in figure  [ qtqs ] .",
    "the coefficients @xmath58 are obtained from minimum @xmath35-fits .",
    "this function is then used to compensate the missing area in saturated events .",
    "integration of the saturated pulses provide the values of @xmath40 , from which the correct values of the total charge @xmath41 can be derived in an event - by - event basis .",
    "the correction algorithm discussed in the previous section does not depend on the exact saturation level @xmath46 .",
    "one can use this feature to perform consistency checks on data sample where the total charge is known .",
    "an unsaturated event is _ made saturated _ by software .",
    "the algorithm is applied to the simulated saturated event , and the corrected total charge is compared with the raw measurements .",
    "a level of @xmath59=100 is chosen .",
    "a new set of @xmath60 is obtained by going through eqs .",
    "[ eq::beta ] to [ eq::qtqs ] again , with @xmath46 replaced by @xmath59 .",
    "a data set of @xmath17-events was taken with a @xmath25cs source .",
    "the pmt high - voltage was adjusted such that the amplitude for the 662  kev line is below the actual saturation level of 255 but significantly above @xmath59 .",
    "the charge @xmath61 is measured by integrating the normalized fadc counts @xmath13 , and the spectrum is displayed in figure  [ xchecks]a . the same data is then made saturated by re - defining @xmath62 such that @xmath63 the saturated charge is derived by integrating the normalized @xmath64 and the spectra is shown in figure  [ xchecks]b , while that for the corrected charge @xmath65 after the correction procedures is shown in figure  [ xchecks]c .",
    "there is excellent agreement on the @xmath25cs peaks in terms of their integrated charge , resolution and area between figures  [ xchecks]a and [ xchecks]c .",
    "the event - by - event deviations are parametrized by @xmath66 the distribution of @xmath67 is depicted in figure  [ deltaplot ] .",
    "the results show that the mean bias is less than 0.5% which is small compared to the intrinsic fwhm resolution of 8.7% .",
    "therefore , the correction procedures are valid and justified .",
    "the algorithms are applied to actual saturated data .",
    "the data is generated by increasing the pmt high voltages such that the events corresponding to the 662  kev @xmath17-line from @xmath25cs have amplitude larger than @xmath46=255 , while those from the 32  kev line remain unsaturated .",
    "an example of the energy spectra of the saturated events , as well as the corrected spectra are illustrated in figure  [ hv950]a and figure  [ hv950]b , respectively .",
    "the ratio of the peak positions at 32  kev and 662  kev ( denoted by @xmath68 and @xmath69 , respectively ) is measured and compared to the nominal values : @xmath70 this can be used as a figure of merit to quantify the performance .",
    "the values of r for saturated and corrected events as functions of the expected peak amplitudes are displayed in figure  [ range]a .",
    "it can be seen that the charge summation correction methods extend the effective dynamic range of the fadc by at least a factor of 14 , or equivalently , 4 more bits .",
    "the dependence of performance of the algorithm on the fadc recording period @xmath22 is studied .",
    "the data are truncated by software to a shorter interval and the same correction procedures are repeated .",
    "the results are displayed in figure  [ range]b for the variation of r with peak amplitudes at @xmath71 ( that is , 512 , 256 and 128 time - bins , respectively ) .",
    "it can be seen that the charge reconstruction is no longer valid for @xmath72 at an amplitude of @xmath738 times of @xmath46 .",
    "alternatively , a plot of r versus @xmath74/@xmath22 is displayed in figure  [ dtsat ] , where @xmath74 is the unsaturated interval , where the fadc counts are less than @xmath46 .",
    "it can be seen the values of r deviate from 1 only for @xmath74/@xmath75 .",
    "accordingly , the algorithm is valid so long as the the unsaturated interval of the event is more than 2% of the fadc recording period . in comparison ,",
    "the fitting method as discussed in section  [ sect::survey ] would start to fail when the saturation interval is more than twice the value of @xmath76 , or equivalently , the figure - of - merit r deviates from 1 when @xmath74/@xmath77 .",
    "the dependence of energy resolution of the 662  kev line on amplitudes is shown in figure  [ range]c .",
    "there is no intrinsic bias in the correction , though the energy resolution gets worse from around 9% to 16% fwhm when the amplitude increases by a factor of 14 at @xmath22=25.6  @xmath21s .",
    "the degradation in energy resolution is larger for the shorter fadc recording time .",
    "as depicted in figure  [ pulseshape ] , the scintillation light in csi(tl ) has different decay time constants for @xmath17- and @xmath16-activated events .",
    "the @xmath16-events decay faster in inorganic crystal scintillators @xmath10 opposite to the responses in organic liquid scintillators  @xcite .",
    "accordingly , the pulse shape information recorded by the fadc can provide event identification capabilities .",
    "an algorithm to process saturated events in flash analog - to - digital convertor was developed and studied .",
    "charge reconstruction and event identification via pulse shape analysis are achieved , effectively extending an 8-bit fadc by at least 4 more bits .",
    "the algorithm is valid so long as the unsaturated interval is more than 2% of the fadc recording period .",
    "although this work originates from the goals of handling data from csi(tl ) crystal scintillators , the approach should be generic and can be applicable to other detector systems where the entire pulse shape are recorded while part of which are saturated .",
    "these studies will facilitate the specification and design of large fadc - based data acquisition systems .",
    "h.t .  wong and j. li ,",
    "lett . * a 15 * , 2011 ( 2000 ) ; + h.b .",
    "li et al . , texono coll . , nucl .",
    "methods * a 459 * , 93 ( 2001 ) ; + h.b .",
    "li et al . , texono coll . , phys .",
    "lett . * 90 * , 131802 ( 2003 ) .",
    "y. liu et al . , texono coll . , nucl .",
    "methods * a 482 * , 125 ( 2002 ) .",
    "lai et al . , texono coll . , nucl .",
    "methods * a 465 * , 550 ( 2001 ) .",
    "morris et .",
    "al . , nucl .",
    "methods * 137 * , 397 ( 1976 ) ; + m.s . zucker and n. tsoupas ,",
    "methods * a 299 * , 281 ( 1990 ) .",
    "s.c . wang et al . , nucl .",
    "methods * a 432 * , 111 ( 1999 ) .",
    "see , for example , `` theory and practice of scintillation counting '' , j.b .",
    "birks , pergamon ( 1964 ) ."
  ],
  "abstract_text": [
    "<S> flash analog to digital convertor ( fadc ) is frequently used in nuclear and particle physics experiments , often as the major component in big multi - channel systems . </S>",
    "<S> the large data volume makes the optimization of operating parameters necessary . </S>",
    "<S> this article reports a study of a method to extend the dynamic range of an 8-bit fadc from the nominal @xmath0 value . by comparing the integrated pulse area with that of a reference profile </S>",
    "<S> , good energy reconstruction and event identification can be achieved on saturated events from csi(tl ) crystal scintillators . </S>",
    "<S> the effective dynamic range can be extended by at least 4 more bits . </S>",
    "<S> the algorithm is generic and is expected to be applicable to other detector systems with fadc readout .    as - texono/03 - 03 +    * effective dynamic range in measurements + with flash analog - to - digital convertor *   + 0.5 cm q.  yue@xmath1 , w.p .  </S>",
    "<S> lai@xmath2 , w.c .  </S>",
    "<S> chang@xmath3 , h.b .  </S>",
    "<S> li@xmath3 , j.  li@xmath4 , + s.t .  </S>",
    "<S> lin@xmath3 , d.z .  </S>",
    "<S> liu@xmath5 , j.f .  </S>",
    "<S> qiu@xmath6 , v.  singh@xmath3 , h.t .  </S>",
    "<S> wong@xmath7    .2 cm    @xmath6 institute of high energy physics , beijing 100039 , china . </S>",
    "<S> +   @xmath5 department of engineering physics , tsing hua university , beijing 100084 , china +   @xmath3institute of physics , academia sinica , taipei 115 , taiwan . </S>",
    "<S> +   @xmath8 department of management information systems , chung kuo institute of technology , + hsin - chu 303 , taiwan . </S>",
    "<S> +    0.5 cm    * pacs codes : * 07.05.kf , 07.05.pj , 07.50.qx + * keywords : * data analysis , image processing , electronics    _ ( submitted to nucl . instrum . methods a ) _ </S>"
  ]
}