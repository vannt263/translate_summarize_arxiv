{
  "article_text": [
    "facial landmark point extraction is a key step in facial image representation and analysis . the active appearance model ( aam ) proposed by _",
    "cootes et al . _",
    "@xcite is a powerful object description method that is commonly used for facial landmark points extraction  @xcite , facial action unit extraction  @xcite , medical image segmentation and analysis  @xcite .",
    "the idea behind aam is to represent a visual object ( e.g. facial image ) using a linear model of shape and texture ( appearance ) eigenvectors obtained from a set of manually labeled training images .",
    "then , the model is used to represent an instance of the object in a novel image .",
    "this process is often called * aam fitting*. aam fitting is a non - linear optimization problem .",
    "different optimization approaches have been proposed to find the best model parameters that result in minimum error between the synthesized appearance models obtained from the aam and the input image . in general ,",
    "due to variation of camera view angle , resolution and focal distance , facial images have different scaling , rotation , and translations . in order to remove global shape variations , all shapes are normalized and the modeling is only concerned with local shape deformation .",
    "therefore , it is necessary to combine a global shape transformation with the normalized aam .",
    "the global shape transformation is often a 2d similarity transformation .",
    "finding optimal parameters of the global transformation improves the accuracy of fitting in representing novel facial images with different shape and pose variations .",
    "traditionally , the stochastic gradient descent algorithm or iteratively incremental additive techniques are used to update the aam parameters to fit onto novel images  @xcite .",
    "the fitting problem can also be viewed as finding a model instance similar to the given facial image and therefore it can be considered as an image alignment problem .",
    "baker and matthews  @xcite have categorized these approaches into four classes : forwards additive , forwards compositional , inverse additive , and inverse compositional .",
    "they proposed the projecting out ( po ) technique which is admittedly one of the fastest algorithms for aam fitting  @xcite .",
    "they also proposed the simultaneously inverse compositional ( sic ) method that can handle images of subjects not included in the training better at the price of losing speed  @xcite .    in the literature , there are some works  @xcite on image alignment for applications , such as motion estimation  @xcite , that take advantage of the gradients of both the template and target images .",
    "these approaches are called bidirectional image alignment .",
    "bidirectional approaches work better than unidirectional image alignment approaches  @xcite . in this paper , we reformulate aam fitting using a bidirectional image alignment scheme .    in our approach , we minimize the error between a warped image and the appearance template by iteratively solving a non - linear least square problem .",
    "the warping is a piecewise affine of a normalized aam that is followed by a global transformation . in each iteration ,",
    "shape parameters are optimized based on the trained appearance template using the inverse compositional algorithm ( ica )  @xcite , and global transformation is found based on the gradient of the input image using incremental update .",
    "we call this approach bidirectional warping",
    ". moreover , we utilize affine transformation instead of 2d similarity to increase the generality of the global shape transformation , and apply a fitting constraint to prevent the algorithm from resulting in non - face shapes .",
    "we show that the proposed bidirectional approach can be applied to po and sic fitting methods .",
    "we study the performance of the proposed bidirectional po and sic methods in extracting facial landmark points , and examine and compare the effect of proposed affine transformation , and the fitting constraint on both bidirectional and the original po and sic fitting methods .",
    "the rest of this paper is organized as follows .",
    "section  [ background ] briefly introduces aam algorithms and particularly reviews image alignment - based aam fitting .",
    "section  [ bidirectional_warping_aam_fitting ] describes the bidirectional warping method .",
    "experimental results are given in section  [ experimentalresults ] , and section  [ discussion_conclusions ] concludes the paper .",
    "aam consists of a shape component and an appearance component obtained from a set of annotated landmark points in training images .",
    "let s assume we are given a training facial image set with annotated shapes defined as : @xmath0 .",
    "the training images are first normalized and aligned using iterative procrustes analysis  @xcite .",
    "this step removes variations due to a chosen global shape normalization transformation so that the resulting model can efficiently consider local and non - rigid shape deformation .",
    "we then can combine the resulting aam with a global transformation .",
    "afterwards , principal component analysis ( pca ) is applied to the set of normalized training shapes and a shape model is defined as : @xmath1 where the base shape @xmath2 is the mean shape and the vectors @xmath3 are @xmath4 eigenvectors corresponding to the @xmath4 largest eigenvalues .",
    "then , all the training images are normalized by warping them into the base shape @xmath2 , using piecewise affine warp , and the appearance model is defined as : @xmath5 where @xmath6 is the mean appearance and the vectors @xmath7 are the @xmath8 eigenvectors corresponding to the @xmath8 largest eigenvalues .",
    "the goal of fitting is to find a model instance that can efficiently describe the object ( e.g. face ) in a given image .",
    "thus , it can be considered as an image alignment problem .",
    "in other words , we want to find the model instance @xmath9 as similar as the image @xmath10 .",
    "in general , facial images have different scaling , rotation , and translations .",
    "therefore , it is necessary to combine a global shape transformation with the normalized aam . if we consider the global shape transformation as @xmath11 , we want to minimize the error between the template and @xmath12 . considering global shape transformation ,",
    "the objective of the fitting process is to find @xmath13 and @xmath14 in order to minimize the error image as : @xmath15 ^ 2},\\ ] ] which is a non - linear least square problem .",
    "we can have different definitions for the global transformation @xmath11 . in  @xcite , a set of 2d similarity transformations as a subset of piecewise affine warps is defined .",
    "assuming the base mesh @xmath16 , we choose @xmath17 , @xmath18 , @xmath19 and @xmath20 , then global transformation is @xmath21 .",
    "this representation of @xmath11 is similar to @xmath22 and therefore similar analysis on the shape parameters * p * can be applied to * q*. if we assume that the two sets of shape vectors @xmath3 and @xmath23 are orthogonal to each other , we can add the four 2d similarity vectors @xmath23 to the beginning of aam shape vectors @xmath3  @xcite and model any given shape as : @xmath24 . in practice , @xmath3 and @xmath23 are not quite orthogonal to each other .",
    "this can either be ignored when the size of @xmath3 is small or the complete set of @xmath3 and @xmath23 can be orthonormalized preferably .    in  @xcite ,",
    "_ baker et al . _",
    "relate aam to the lucas - kanade algorithm .",
    "they proposed the inverse compositional algorithm ( ica ) , in which they find shape variation on the template and compose the inverse of that with the current shape .",
    "therefore , many computationally expensive tasks are precomputed .    in  @xcite ,",
    "appearance variation is considered in the fitting by finding shape parameters in a linear subspace where the appearance variation is ignored and then `` projected out '' to the full space with respect to the appearance eigenvectors .",
    "the method is more generic compared with the ica , but the fitting is not accurate when applied to subjects that are not similar to subjects in the training set .",
    "the `` projecting out '' approach is called po in the rest of this paper .    in  @xcite ,",
    "simultaneously inverse compositional ( sic ) method is introduced , which is more generic . in this method",
    "the fitting procedure minimizes the error between @xmath25 $ ] and @xmath26 , where @xmath7 are @xmath8 appearance eigenvectors correspond to the @xmath8 largest appearance eigenvalues , and @xmath27 are parameters of appearance that are found simultaneously with respect to the @xmath28 .",
    "as the appearance parameters are optimized in each iteration , both steepest descent and the hessian matrix @xmath29 should be calculated in each iteration , and therefore the method is slower . in  @xcite the po",
    "is compared with the sic , and the sic is reported more accurate in modeling unseen subjects .",
    "in this paper , we optimize the global transformation s parameters ( @xmath14 ) based on @xmath30 , using an incremental update and the shape s parameters ( @xmath13 ) based on @xmath6 , using inverse compositional approach .",
    "if we assume @xmath13 and @xmath14 are known , reversing the role of @xmath31 in @xmath12 and computing the incremental global warp @xmath32 with respect to @xmath31 in @xmath12 , we can solve the equation iteratively as : @xmath33 ^ 2}}.\\ ] ]    then to update the warping parameters , we use @xmath34 and @xmath35 .",
    "assuming @xmath36 and @xmath37 are identity warps , first order taylor series expansion of the equation on @xmath38 and @xmath39 gives : @xmath40 ^ 2}},\\ ] ]    where @xmath41 is the image gradient , @xmath42 and @xmath43 are the jacobian of the warp evaluated at @xmath44 and current @xmath14 respectively . by taking the derivative of the equation , neglecting second order @xmath45 terms and optimizing for @xmath38 and @xmath39",
    ", we obtain :    * * p**= _ 1 ^ -1 _ ^t , [ eq : deltap ] + * * q**= _ 2 ^ -1 _ , [ eq : deltaq ]    where    @xmath46^t\\left [ \\nabla   \\mbox a_0 \\frac{\\partial \\textbf{w}}{\\partial \\textbf{p}}\\right ] } ,                                     \\label{eq : hessianmatrix1}\\\\                   \\small{\\mbox{h}_2=\\left [ \\nabla i \\frac{\\partial \\textbf{n}}{\\partial \\textbf{q}}\\right]^t\\left [ \\nabla i \\frac{\\partial \\textbf{n}}{\\partial \\textbf{q}}\\right]}. \\label{eq : hessianmatrix2}\\end{aligned}\\ ] ]    as @xmath47 is evaluated at @xmath44 , @xmath48 can be precomputed and saved in the memory , while @xmath49 depends on the current shape and the warped input image gradient , and therefore it should be computed in each iteration .",
    "algorithm  [ alg : bidirectionalwarping ] shows the steps of the bidirectional warping for inverse compositional algorithm .",
    "we call this approach bi - ica in the rest of this paper .",
    "\\(3 ) evaluate the gradient @xmath50 of the template @xmath51 ( 4 ) evaluate the jacobian @xmath52 at @xmath53 ( 5 ) compute the steepest descent images @xmath54 ( 6 ) compute the hessian matrix @xmath48 using equation ( 1 ) warp @xmath30 with @xmath55 and @xmath56 to compute + @xmath57 ( 2 ) compute @xmath58 $ ] ( 7 ) evaluate the gradient @xmath59 ( 8) evaluate the jacobian @xmath60 ( 9 ) compute the steepest descent images @xmath61 ( 10 ) compute the hessian matrix @xmath49 using equation ( 11 ) compute @xmath62 and @xmath63 using equation and ( 12 ) update @xmath64 + and @xmath65    the `` projecting out '' technique can be applied to the bidirectional warping , i.e. instead of @xmath66 $ ] in the equation and , @xmath67 is calculated as : @xmath68   \\mbox{a}_i(\\mbox{x})}},\\ ] ]    similar to the po , the @xmath69 can be precomputed , but the dot product of the modified steepest descent images with the error image should be computed in each iteration .",
    "the bidirectional warping of the po is called bi - po in the rest of this paper .    to have a more generic fitting",
    ", we can optimize the shape parameters on the full space of the appearance vectors . in this case",
    ", we need to optimize the appearance parameters as well as the shape parameters like the sic method .",
    "the algorithm operates by iteratively minimizing : @xmath70 ^ 2,\\end{aligned}\\ ] ] simultaneously with respect to @xmath38 , @xmath39 and @xmath71 .",
    "then we update the warp @xmath34 , @xmath35 and @xmath72 .",
    "we define the concatenation parameter of the shape and the appearance @xmath73^t$ ] , and the steepest - descent images as : @xmath74 where @xmath75 .",
    "we can then compute the parameter update @xmath76 as : @xmath77 where @xmath78 .    to find the parameter of the global transformation ( @xmath14 ) , we used incremental update as : @xmath35 , where @xmath79 } } $ ] .",
    "this approach is called bi - sic in the rest of this paper . in this case",
    "both @xmath80 and @xmath81 are calculated in each iteration .",
    "the extra computational load of bi - sic in comparison with sic is to calculate the gradient of the warped image and @xmath49 in each iteration .",
    "in addition to the introduced bidirectional approach , we also propose two modifications to aam fitting as follows :    * 1-affine transformation : * image alignment techniques for aam fitting usually consider a 2d set of similarity transform for the global transformation .",
    "affine transformation can improve the performance of active shape model for facial feature extraction  @xcite . in this paper",
    ", we apply an affine transformation with six degrees of freedom for aam fitting . assuming the base mesh is : @xmath16 .",
    "we choose @xmath82 , @xmath83 , @xmath84 , @xmath85 , @xmath86 and @xmath87 .",
    "the global affine transformation is defined as : @xmath88 .",
    "this transformation has more degrees of freedom and therefore results in a better modeling of the shape variation .    *",
    "2- fitting constraint : * introduced approaches for aam fitting still suffer from lack of generality for unseen faces .",
    "in addition , the result can differ significantly from trained shapes .",
    "one idea is to apply some constraints on fitting iterations .",
    "defining a well constraint is not easy because of the complexity of the face shape , huge variation of the appearance due to different subjects , illuminations and expressions , and the existence of non - face areas ( e.g. glasses ) . in this paper",
    ", we apply a simple constraint of active shape models ( asm )  @xcite , i.e. those shape parameters ( @xmath89 ) are updated that @xmath90 , where @xmath91 are the eigenvalues of the trained shapes",
    ". this constraint will force the algorithm to result in shapes similar to trained shapes with a limited degree of freedom and therefore prevent it from resulting in non - face shapes .",
    "we implemented the po  @xcite , the sic  @xcite , and our proposed bi - po and bi - sic methods using matlab platform .",
    "we also used the affine transformation for the global transformation instead of 2d similarity and applied the introduced constraint to the po , sic , bi - po , and bi - sic methods and called them po - ac , sic - ac , bi - po - ac , and bi - sic - ac , respectively .",
    "we applied the aforementioned methods on cmu multi - pie face dataset  @xcite .",
    "the cmu multi - pie database contains more than 750,000 images of 337 people .",
    "subjects were imaged under 15 view points and 19 illumination conditions .",
    "the image resolution is 640@xmath92480 , where the distance between the center of the eyes are approximately 80 pixels .",
    "certain poses of a subset have 68 facial landmark points .",
    "we select a subset from the dataset containing 100 different subjects with the frontal head pose and with the same illumination .",
    "we also selected 50 images of left and right head poses that have 68 facial landmark points .",
    "figure [ fig : someimages ] shows images of sample subjects in frontal , left and right poses .                                        to initialize the shape model in aam fitting , we selected two outer eye corners and the chin point ( 3 points ) from the ground truth landmarks and perturbed them randomly by 5 pixels .",
    "then we used the average shape obtained from training subjects as the initial shape and transformed it using similarity transformation obtained by those three perturbed points .",
    "figure [ fig : subfig_initial ] shows the initial shape for a sample image .",
    "[ initialfittedsample ]    we tested the performance of the po , sic , po - ac , sic - ac , bi - po , bi - sic , bi - po - ac , and bi - sic - ac methods when the number of images in the training sets varied using 10-fold cross validation .",
    "particularly , we selected 10 , 20 , 30 , 40 , 50 , 60 , 70 , 80 and 90 images randomly from the frontal subset and trained separate aams .",
    "for testing the generalization performance of the fitting methods , we fitted the trained models onto 10 images that are not included in the training sets and repeated this experiment 10 times for different test images . for comparing the fitting performance , we calculated the root mean square error ( rmse ) .",
    "the value of rmse shows the distance between the fitted and the actual shape .",
    "naturally , the smaller the rmse , the better the fitting .    in our first experiment",
    ", we examined the effect of using affine transformation and constraint on both the po and sic method as well as the introduced bidirectional warping .",
    "figure [ fig : rmspo ] shows the fitting rmse value of the po , bi - po , po - ac , and bi - po - ac on the frontal subset .",
    "figure [ fig : rmssic ] shows the fitting rmse value of the sic , bi - sic , sic - ac , and bi - sic - ac on the frontal subset . in both experiments , using affine transformation and having constraint improved the fitting performance .",
    "when we have the constraint , it keeps the shape similar to the trained shapes ( i.e. face ) during the fitting process and prevents the algorithm from resulting non - face shapes .",
    "in addition , the affine transformation gives the algorithm more degrees of freedom , and therefore it fits better on unseen samples .",
    "it is also shown that bidirectional warping has a better fitting performances than unidirectional warping .",
    "bi - po and bi - sic both have comparative fitting performance and both fit better in comparison with the original unidirectional algorithms",
    ".            there are no standard or established choices for the convergence criterion . in this paper",
    ", we visually inspected a number of results in the rmse range of 0 - 20 and confirmed that those having rmse less than 5 pixels seem successfully fitted .",
    "figure [ fig : subfig_fitted ] shows a sample fitted image having rmse 4.02 .",
    "figure [ fig : percentagefittedpo ] shows the percentage of fitted shapes for the frontal subset using po , bi - po , po - ac , and bi - po - ac .",
    "figure [ fig : percentagefittedsic ] shows the percentage of fitted shapes for the frontal subset using sic , bi - sic , sic - ac and bi - sic - ac . as it shown , the bidirectional warping has better performance than the unidirectional method . also applying the constraint and affine transformation result in a better modeling of unseen images and more convergence on both the po and sic .",
    "it should be mentioned that the percentage of fitting depends on the threshold value , but empirically both algorithms have more or less similar performance in comparison to each other in a reasonable range of threshold value .            in another experiment , we tested the generalization performance of our proposed approach for different poses .",
    "we trained an aam with 120 images ( 40 images of each frontal , left and right subsets ) . to test the generality of the fitting , we fitted the trained model onto the 10 other subjects from each pose .",
    "we repeated this experiment five times and averaged the fitting results of the sic , bi - sic , sic - ac , and bi - sic - ac .",
    "initial shape was again the warped average shape obtained from training subjects .",
    "table [ tab : rmsfittingleftrightupdown_sic ] shows the average rmse of fitting for frontal , left and right poses .",
    "similarly , we defined a threshold of rmse less than 5 pixels as the fitted shape .",
    "table [ tab : numberoffittedleftrightupdown_sic ] shows the percentage of fitted shapes for frontal , left and right pose subsets .",
    "similar to the previous experiment , using affine transformation and applying constraints on sic improve the fitting performance .",
    "the introduced bidirectional approach also improves the sic performance significantly , especially when we have pose variations .",
    ".rmse of fitting on the left and right poses .",
    "[ cols=\"<,^,^,^,^\",options=\"header \" , ]     * computational complexity : * the bidirectional method introduces an extra computation in every iterations of fitting .",
    "if we assume @xmath4 is the number of warp parameters , @xmath93 is the number of pixels , and @xmath8 is the number of top appearance eigenvectors , the complexity of the po and sic methods per iteration are @xmath94 and @xmath95 , respectively @xcite . in the bidirectional approach , we have @xmath96 parameters for the chosen global transformation , and in every iterations we need to compute : the gradient of the image ( step 7 ) with the complexity of @xmath97 ; the jacobian @xmath60 ( step 8) with the complexity of @xmath98 ; the steepest descent images ( step 9 ) with the complexity of @xmath98 ; the hessian matrix @xmath49 and invert it ( step 10 ) with the complexity of @xmath99 ; and @xmath63 with complexity of @xmath100 .",
    "the complexity overload of the bidirectional approach is @xmath99 .",
    "the numbers @xmath4 and @xmath8 depend on the size of the training set and the model dimensionalities . in most aam implementations , the dimensionalities of the shape and appearance models are chosen by retaining a fixed percentage ( typically 95% ) of the variance in the eigenvalues @xcite . in our experimental results , depending on the size of the training set , @xmath4 varies between @xmath101 $ ] and @xmath8 varies between @xmath102 $ ] . for the affine transformation",
    ", @xmath96 is 6 .",
    "hence , the complexity of bi - po is at least two times greater than po , and the complexity of bi - sic is greater than sic .",
    "however , this is based on the assumption of having the same constant factor for all steps .",
    "we implemented all algorithms using matlab on a windows platform .",
    "we executed them on a pc with intel core duo 3.00 ghz cpu having 4 gb of ram , where both implementations have the same termination condition , i.e. the algorithm terminates if the shape does not change or continues for 50 iterations at maximum . in practice ,",
    "the implemented po and sic methods take 3 and 8 seconds for each frame , while the execution of the bi - po and bi - sic - ac methods take 20 and 27 seconds , respectively ,",
    "in summary , unlike previous image alignment approaches for aam fitting that warp either the input image ( e.g. lucas - kanade method ) or the appearance template ( e.g. inverse compositional algorithm ) , we warp both the input image for the global transformation and the template for the shape parameters in the fitting process . warping both the input image and",
    "the appearance template causes the aam to consider more appearance variations , and therefore it can fit better on images with different poses and appearances .",
    "we showed that the introduced bidirectional approach can be applied on the `` projected out '' and the `` simultaneously inverse compositional '' approaches for aam fitting .",
    "we also proposed using affine transformation with six degrees of freedom instead of 2d similarity and applying a simple constraint to prevent the fitting algorithm from resulting in shapes far from face geometry .",
    "we tested the performance of the proposed approach on mutli - pie dataset .",
    "we compared the accuracy of our proposed fitting approach with the po and sic methods .",
    "first , we trained the aam with different number of training images and tested the fitting accuracy on unseen images . in another experiment",
    ", we then compared the accuracy of fitting on images with different poses .",
    "our experimental results showed that warping both the image and the template makes the aam fitting more generic .",
    "in addition , applying affine transformation gives the algorithm more degrees of freedom to model new face instances and the proposed constraint in the fitting iterations prevents resulting in non - face shapes . in conclusion ,",
    "our method is promising for modeling and tracking facial images of unseen subjects ( i.e. generic model ) and also when the accuracy of aam fitting has priority to the execution speed .",
    "m.  h. mahoor , s.  cadavid , d.  s. messinger , and j.  f. cohn .",
    "a framework for automated measurement of the intensity of non - posed facial action units . in _ computer vision and pattern recognition workshops , 2009 .",
    "cvpr workshops 2009 _ , pages 7480 .",
    "ieee , 2009 ."
  ],
  "abstract_text": [
    "<S> active appearance model ( aam ) is a commonly used method for facial image analysis with applications in face identification and facial expression recognition . </S>",
    "<S> this paper proposes a new approach based on image alignment for aam fitting called bidirectional warping . </S>",
    "<S> previous approaches warp either the input image or the appearance template . we propose to warp both the input image , using incremental update by an affine transformation , and the appearance template , using an inverse compositional approach . </S>",
    "<S> our experimental results on multi - pie face database show that the bidirectional approach outperforms state - of - the - art inverse compositional fitting approaches in extracting landmark points of faces with shape and pose variations . </S>"
  ]
}