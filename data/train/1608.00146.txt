{
  "article_text": [
    "combinatorics is at a crossroads of several mathematical fields , including logic , algebra , probability , and analysis .",
    "bridges have been built between these fields ( notably at the instigation of leibniz and hilbert ) . from the interactions of algebra and logic",
    "is born model theory , which is founded on the duality of semantical and syntactical elements of a language .",
    "several frameworks have been proposed to unify probability and logic , which mainly belong to two kinds : probabilities over models ( carnap , gaifman , scott and kraus , nilsson , vnnen , valiant ,  ) , and models with probabilities ( h. friedman , keisler and hoover , terwijn , goldbring and towsner ,  ) .",
    "see @xcite for a partial overview .",
    "recently , new bridges appeared between combinatorics and analysis , which are based on the concept of graph limits ( see @xcite for an in - depth exposition ) .",
    "two main directions were proposed for the study of a `` continuous limit '' of finite graphs by means of statistics convergence :    * the _ left convergence _ of a sequence of ( dense ) graphs , for which the limit object can be either described as an _ infinite exchangeable random graph _",
    "( that is a probability measure on the space of graphs over @xmath4 that is invariant under the natural action of @xmath5 ) @xcite , or as a _ graphon _ ( that is a measurable function @xmath6\\times[0,1]\\rightarrow[0,1]$ ] ) @xcite . *",
    "the _ local convergence _ of a sequence of bounded degree graphs , for which the limit object can be either described as a _",
    "unimodular distribution _",
    "( a probability distribution on the space of rooted connected countable graphs with bounded degrees satisfying some invariance property ) @xcite , or as a _ graphing _ ( a borel graph that satisfies some intrinsic mass transport principle or , equivalently , a graph on a borel space that is defined by means of finitely many measure preserving involutions ) @xcite .",
    "a general ( unifying ) framework has been introduced by the authors , under the generic name `` structural limits '' @xcite . in this",
    "setting , a sequence of structures is convergent if the satisfaction probability of every formula ( in a fixed fragment of first - order logic ) for a ( uniform independent ) random assignment of vertices to the free variables converges .",
    "the limit object can be described as a probability measure on a stone space invariant by some group action , thus generalizing approaches of @xcite and @xcite .",
    "this may be viewed as a natural bridge between combinatorics , model theory , probability theory , and functional analysis @xcite .",
    "the existence of a graphing - like limit object , called _ modeling _ , has been studied in @xcite , and the authors conjectured that such a limit object exists if and only if the structures in the sequence are sufficiently `` structurally sparse '' .",
    "for instance , the authors conjectured that if a convergent sequence is _ non - dispersive _ ( meaning that the structures in the sequence have no `` accumulation elements '' ) then a modeling limit exists :    [ conj : res ] every convergent residual sequence of finite structures admits a modeling limit .    for the case of sequences of graphs from a monotone class ( that is a class of finite graphs closed by taking subgraphs ) the authors conjectured the following exact characterization , where _ nowhere dense _",
    "classes @xcite form a large variety of classes of sparse graphs , including all classes with excluded minors ( as planar graphs ) , bounded degree graphs and graph classes of bounded expansion @xcite .",
    "[ conj : nd ] a monotone class of graphs @xmath1 admits modeling limits if and only if @xmath1 is nowhere dense .    note that this conjecture is known in one direction @xcite .",
    "to prove the existence of modeling limits for sequences of graphs in a nowhere dense class is the main problem addressed in this paper .",
    "nowhere dense classes enjoy a number of ( non obviously ) equivalent characterizations and strong algorithmic and structural properties @xcite .",
    "for instance , deciding properties of graphs definable in first - order logic is fixed - parameter tractable on nowhere dense graph classes ( which is optimal when the considered class is monotone , under a reasonable complexity theoretic assumption ) @xcite .",
    "modeling limits exist for sequences of graphs with bounded degrees ( as graphings are modelings ) , and this has been so far verified for sequences of graphs with bounded tree - depth @xcite , for sequences of trees @xcite , for sequences of plane trees and sequences of graphs with bounded pathwidth @xcite , and for sequences of mappings @xcite ( which is the simplest form of non relational nowhere dense structures ) .",
    "( see also related result on sequences of matroids @xcite . ) in this paper , we prove both conjecture  [ conj : res ] and conjecture  [ conj : nd ] in their full generality .    our paper is organized as follows : in section  [ sec : pre ] we recall all necessary notions , definitions , and notations . in section  [ sec : fo1 ] we will deal with limits with respect to the fragment @xmath7 of all first - order formulas with at most one free variable . in section  [ sec : mod ]",
    "we deduce a proof of conjecture  [ conj : res ] and , using a characterization of nowhere denses from @xcite , we prove that conjecture  [ conj : nd ] holds .",
    "finally , we discuss some possible developments in section  [ sec : comment ] .",
    "the general proof strategy is depicted bellow :",
    "a _ signature _ is a set @xmath8 of function or relation symbols , each with a finite arity . in this paper",
    "we consider finite or countable signatures .",
    "a _ @xmath8-structure _",
    "@xmath9 is defined by its _ domain _",
    "@xmath10 , and by the interpretation of the symbols in @xmath8 , either as a relation @xmath11 ( for a relation symbol @xmath10 ) or as a function @xmath12 ( for a function symbol @xmath13 ) .",
    "a signature @xmath8 also defines the ( countable ) set @xmath14 of all first - order formulas built using the relation and function symbols in @xmath8 , equality , the standard logical conjunctives , and quantification over elements of the domain .",
    "the quotient of @xmath14 by logical equivalence has a natural structure of countable boolean algebra , the _ lindenbaum - tarski algebra _",
    "@xmath15 of @xmath14 .    for a formula @xmath16 with @xmath2 free variables and a structure @xmath9",
    "we denote by @xmath17 the set of all satisfying assignments of @xmath16 in @xmath9 , that is @xmath18 if @xmath9 is a finite structure ( or a structure whose domain is a probability space ) , we define the _ stone pairing _ @xmath19 of @xmath16 and @xmath9 as the probability of satisfaction of @xmath16 in @xmath9 for a random assignments of the free variables . hence if @xmath9 is finite ( and no specific probability measure is specified on the domain of @xmath9 ) it holds @xmath20 generally , if the domain of @xmath9 is a probability space ( with probability measure @xmath21 ) and @xmath17 is measurable then @xmath22 where @xmath23 denotes the product measure on @xmath24 .    for a @xmath8-structure @xmath9",
    "we denote by @xmath25 the graph with vertex set @xmath10 , such that two ( distinct ) vertices @xmath26 and @xmath27 are adjacent in @xmath25 if both belong to some relation in @xmath9 ( that is if @xmath28 ) .",
    "the term of stone pairing comes from a functional analysis point of view : let @xmath29 be the stone dual of the boolean algebra @xmath15 .",
    "points of @xmath29 are equivalently described as the ultrafilters on @xmath15 , the homomorphisms from @xmath15 to the two - element boolean algebra , or the maximal consistent sets @xmath30 of formulas from @xmath14 ( point of view we shall make use of here ) .",
    "the space @xmath29 is a compact totally disconnected polish space , whose topology is generated by its clopen sets @xmath31 let @xmath9 be a finite @xmath8-structure ( or a @xmath8-structure on a probability space such that every first - order definable set is measurable ) . identifying @xmath16 with the indicator function @xmath32 of the clopen set @xmath33 , the map @xmath34 uniquely extends to a continuous linear form on the space @xmath35 . by riesz representation theorem",
    "there exists a unique probability measure @xmath36 such that for every @xmath37 it holds @xmath38 note that the permutation group @xmath5 defines a ( subgroup of the ) group of automorphisms of @xmath39 ( by permuting free variables ) and acts naturally on @xmath29 .",
    "the probability measure @xmath36 associated to the structure @xmath9 is obviously invariant under the @xmath5-action .    for more details on this",
    "_ representation theorem _",
    "we refer the reader to @xcite .",
    "let @xmath8 be a signature , and let @xmath40 be a fragment of @xmath14 .",
    "a sequence @xmath41 of @xmath8-structures is _",
    "if @xmath42 converges as @xmath43 grows to infinity or , equivalently , if the associated probability measures @xmath44 on @xmath45 converge weakly @xcite .    in our setting ,",
    "the strongest notion of convergence is @xmath46-convergence ( corresponding to the full fragment of all first - order formulas ) .",
    "convergence with respect to the fragment @xmath47 ( of all quantifier - free formulas without equality ) is equivalent to the _ left convergence",
    "_ introduced by lovsz _",
    "et al _ @xcite .",
    "( it is also equivalent to convergence with respect to the fragment @xmath48 of all quantifier - free formulas , provided that the sizes of the structures in the sequence tend to infinity . ) for bounded degree graphs , convergence with respect to the fragment @xmath49 of local formulas with a single free variable is equivalent to the _ local convergence _ introduced by benjamini and schramm @xcite .",
    "( recall that a formula is _ local _ if its satisfaction only depends on a fixed neighborhood of its free variables . ) also , in this case , local convergence is equivalent to convergence with respect to the fragment @xmath50 of all local formulas , provided that the sizes of the structures in the sequence tend to infinity . for a discussion on the different notions of convergence arising from different choices of the considered fragment of first - order logic",
    ", we refer the interested reader to @xcite .",
    "note that the equivalence of @xmath40-convergence with the weak convergence of the probability measures on @xmath45 associated to the finite structures in the sequence is stated in @xcite as a representation theorem , which generalizes both the representation of the left limit of a sequence of graphs by an infinite random exchangeable graph @xcite and the representation of the local limit of a sequence of graphs with bounded degree by an unimodular distribution on the space of rooted connected countable graphs @xcite .",
    "a construction of a non - standard limit object for fo - convergent sequences has been proposed in @xcite , which closely follows elek and szegedy construction for left limits of hypergraphs  @xcite .",
    "one proceeds as follows :    let @xmath51 be a sequence of finite @xmath8-structures and let @xmath52 be a non - principal ultrafilter .",
    "let @xmath53 and let @xmath54 be the equivalence relation on @xmath55 defined by @xmath56 if @xmath57 .",
    "then the _ ultraproduct _ of the structures @xmath58 is the structure @xmath59 , whose domain @xmath60 is the quotient of @xmath55 by @xmath54 , and such that for each relational symbol @xmath61 it holds is defined by @xmath62,\\dots,[v^p])\\in r^{\\mathbf l}\\quad\\iff\\quad\\{n : ( v^1_n,\\dots , v^p_n)\\in r^{\\mathbf a_n}\\}\\in u.\\ ] ]    as proved by o @xcite , for each formula @xmath63 and each @xmath64 we have @xmath65,\\dots,[v^p])\\quad\\text { iff } \\quad \\{i:\\ \\mathbf a_i\\models\\phi(v^1_i,\\dots , v^p_i)\\}\\in u.\\ ] ]    in @xcite a probability measure @xmath66 is constructed from the normalised counting measures @xmath67 of @xmath68 via the loeb measure construction , and it is proved that every first - order definable set of the ultraproduct is measurable . the ultraproduct is then a limit object for the sequence @xmath51 . in particular , for every first - order formula @xmath16 with @xmath2 free variables it holds :    @xmath69,\\dots,[x_p])\\ { \\rm d}\\nu([x_1])\\,\\dots\\,{\\rm d}\\nu([x_p])=\\lim_u\\langle\\phi,\\mathbf a_i\\rangle.\\ ] ] moreover , the above integral is invariant by any permutation on the order of the integrations .    however , the constructed object is difficult to handle . in particular ,",
    "the sigma - algebra constructed on @xmath70 is not separable . for a discussion",
    "we refer the reader to @xcite .",
    "the ultraproduct construction is used in the proof of lemma  [ lem : cons ] to prove consistency of some theories in friedman s @xmath71 logic ( see section  [ sec : friedman ] ) .      by similarity with _",
    "graphings _ , which are limit objects for local convergent sequences of graphs with bounded degrees @xcite , the authors proposed the term of _ modeling _ for a structure @xmath9 built on a standard borel space @xmath10 , endowed with a probability measure @xmath21 , and such that every first - order definable set is borel @xcite .",
    "such structures naturally avoid pathological behaviours ( for instance , every definable set is either finite , countable , or has the cardinality of continuum ) .",
    "the definition of stone pairing obviously extends to modeling by setting @xmath72    an @xmath40-convergent sequence @xmath51 has _ modeling @xmath40-limit _ @xmath73 ( or simply _ modeling limit _",
    "@xmath73 when @xmath74 ) if @xmath73 is a modeling such that for every @xmath75 it holds @xmath76    let @xmath1 be a class of structures .",
    "we say that @xmath1 _ admits modeling limits _ if every @xmath46-convergent sequence of structures @xmath51 with @xmath77 has a modeling limit",
    ".    note that not every @xmath46-convergent sequence has a modeling limit : consider a sequence @xmath78 of graphs , where @xmath79 is a graph of order @xmath43 , with edges drawn randomly ( independently ) with edge probability @xmath80 .",
    "then with probability @xmath81 the sequence @xmath78 is fo - convergent .",
    "however , this sequence has no modeling limit , and even no modeling @xmath47-limit : assume for contradiction that @xmath78 has a modeling @xmath48-limit @xmath73 . because @xmath82 the probability measure @xmath83 is atomless thus @xmath60 is uncountable . as @xmath60 is a standard borel space ,",
    "there exists zero - measure sets @xmath84 and @xmath85 $ ] , and a bijective measure preserving map @xmath86\\setminus n'$ ] . by the equivalence of @xmath47-convergence and left - convergence the modeling @xmath73 defines a @xmath87-valued graphon @xmath6\\times [ 0,1]\\rightarrow [ 0,1]$ ] , which is a left limit of @xmath78 by : @xmath88 but a left limit of @xmath78 is the constant graphon @xmath2 , which is not weakly equivalent to @xmath89 ( as it should , according to @xcite ) thus we are led to a contradiction .",
    "this example is prototypal , and this allows us to prove that if a monotone class of graphs admits modeling limits then this class has to be nowhere dense @xcite .",
    "the proof involves the characterization of nowhere dense classes by the model theoretical notions of stability and independence property @xcite , their relation to vc - dimension @xcite , and the characterization of sequences of graphs admitting a _ random - free _ ( i.e. almost everywhere @xmath87-valued )",
    "left limit graphon @xcite .",
    "conjecture  [ conj : nd ] asserts that the converse is true as well .",
    "friedman @xcite studied a logical system where the language is enriched by the quantifier `` there exists x in a non zero - measure set  '' , for which he studied axiomatizations , completeness , decidability , etc .",
    "a survey including all these results was written by steinhorn @xcite .",
    "in particular , h. friedman considered specific type of models , which he calls _ totally borel _ , which are ( almost ) equivalent to our notion of modeling : a _ totally borel structure _ is a structure whose domain is a standard borel space ( endowed with implicit borel measure ) with the property that every first - order definable set ( with parameters ) is measurable .",
    "in this context , friedman introduced a new quantifier @xmath71 , which is to be understood as expressing `` there exists non - measure @xmath90 many '' , and initiated the study of the extension @xmath91 of first order logic , whose axioms are all the usual axiom schema for first - order logic together with the following ones @xcite :    * @xmath92 ; * @xmath93 , where @xmath94 is an @xmath95-formula in which @xmath27 does not occur and @xmath96 is the result of replacing each free occurrence of @xmath26 by @xmath27 ; * @xmath97 ; * @xmath98\\rightarrow ( q_m x)\\psi$ ] ; * @xmath99 .",
    "the rules of inference for @xmath95 are the same as for first - order logic : _ modus ponens _ and generalization .",
    "let the proof system just described be denoted by @xmath100 .",
    "the standard semantic for @xmath71 is as follows : for a structure @xmath101 on a probability space such that every first - order definable ( with parameters ) is measurable ( for probability measure @xmath102 ) it holds @xmath103 note that the set of @xmath91-sentences satisfied by @xmath101 ( for this semantic ) is obviously consistent in @xmath100 .",
    "the following completeness theorem has been proved by friedman @xcite ( see also @xcite ) :    [ thm : wmod ] a set of sentences @xmath30 in @xmath95 has a totally borel model if and only if @xmath30 is consistent in @xmath100 .",
    "it has been noted that one can require the domain of the totally borel model to be a borel subset of @xmath104 with lebesgue measure @xmath81 .",
    "let @xmath41 be an fo - convergent sequence of finite structures , and let @xmath105 be the union of a complete theory of an elementary limit of @xmath106 together with , for each first order formula @xmath16 with free variables @xmath107 , @xmath108    the ultraproduct construction provides a model for @xmath105 :    [ lem : cons ] for every fo - convergent sequence @xmath106 of finite structures , the theory @xmath105 is consistent in @xmath100 .    using the standard semantic for @xmath71 it is immediate that any ultraproduct @xmath109 is a model for @xmath105",
    "hence @xmath105 is consistent in @xmath100 .",
    "[ thm:1 ] for every fo - convergent sequence @xmath106 of finite structures , there exists a modeling @xmath101 whose domain @xmath110 is a borel subset of @xmath104 , and such that :    1 .",
    "the probability measure @xmath111 associated to @xmath101 is uniformly continuous with respect to lebesgue measure @xmath102 ; 2 .",
    "@xmath101 is a modeling @xmath7-limit of @xmath106 ; 3 .   for every @xmath112 it holds @xmath113    according to lemma  [ lem : cons ]",
    "the theory @xmath105 is consistent in @xmath100 .",
    "hence , according to theorem  [ thm : wmod ] , @xmath105 has a totally borel model @xmath114 .",
    "( furthermore , we may assume that @xmath30 is a borel subset of @xmath104 with lebesgue measure @xmath81 . )    for every integer @xmath115 , there exists an integer @xmath116 and @xmath116 formulas @xmath117 ( with a single free variable ) defining the local @xmath81-types up to quantifier rank @xmath115 in the sense that all of these formulas are local and have quantifier rank @xmath115 , they induce a partition ( formalized as @xmath118 if @xmath119 and @xmath120 ) , and for every local formula @xmath121 with quantifier rank @xmath115 and for every @xmath122 either it holds @xmath123 , or @xmath124 .",
    "define @xmath125 .",
    "define the probability measure @xmath126 on @xmath60 as follows : for every borel subset @xmath40 of @xmath60 define @xmath127 obviously @xmath126 weakly converges to some probability measure @xmath128 .",
    "let @xmath101 be the modeling obtained by endowing @xmath73 with the probability measure @xmath129 .",
    "note that @xmath111 is absolutely continuous with respect to @xmath102 by construction .",
    "theorem  [ thm:1 ] immediately implies    [ cor : fo1 ] every @xmath7-convergent sequence has a modeling @xmath7-limit .",
    "we know that in general an @xmath46-convergent sequence does not have a modeling limit ( hence corollary  [ cor : fo1 ] does not extend to full @xmath46 ) .",
    "this nicely relates to sparse ",
    "dense dichotomy .",
    "recall that a class @xmath1 of ( finite ) graphs is _ nowhere dense _",
    "if , for every integer @xmath115 , there exists an integer @xmath130 such that the @xmath115-th subdivision of the complete graph @xmath131 on @xmath130 vertices is the subgraph of no graph in @xmath1 @xcite .",
    "( note a subgraph needs not to be induced . ) based on a characterization by lovsz and szegedy @xcite or random - free graphon and a characterization of nowhere - dense classes in terms of vc - dimension ( adler and adler @xcite and laskowski @xcite ) the authors derived in @xcite the following necessary condition for a monotone class @xmath1 to have modeling limits .",
    "let @xmath1 be a monotone class of graphs .",
    "if every fo - convergent of graphs from @xmath1 has a modeling limit then the class @xmath1 is nowhere dense .",
    "however , there is a particular case where a modeling limit for an fo - convergent sequence will easily follow from theorem  [ thm:1 ] .",
    "that will be done next .",
    "a sequence @xmath51 is _ residual _ if , for every integer @xmath0 it holds @xmath132 where @xmath133 denotes the set of elements of @xmath134 at distance at most @xmath0 from @xmath135 ( in the gaifman graph of @xmath58 ) .",
    "equivalently , @xmath51 is residual if , for every integer @xmath0 , it holds @xmath136    the notion of residual sequence is linked to the one of residual modeling : a _ residual modeling _ is a modeling , all components of which have zero measure ( that is if and only if for every integer @xmath0 , every ball of radius @xmath0 has zero measure ) .    by an interplay of these notions",
    "we now can prove conjecture  [ conj : res ] .",
    "[ thm : res ] every @xmath46-convergent residual sequence has a modeling limit .",
    "the main characteristic of residual sequences is that a residual sequence is @xmath46-convergent if and only if it is @xmath7-convergent @xcite .",
    "consider the modeling limit @xmath101 obtained in theorem  [ thm:1 ] for a @xmath46-convergent residual sequence .",
    "then for every integer @xmath0 it holds @xmath137 it follows that @xmath101 is residual , and thus the convergence of @xmath42 to @xmath138 for first - order formulas with ( at most ) one free variable ( i.e. @xmath7-convergence ) implies convergence for all first - order formulas ( i.e. @xmath46-convergence ) .",
    "here we prove our main result in the form of a generalization of section  [ sec : modres ] for quasi - residual sequences .",
    "the motivation for the introduction of the definition of quasi - residual sequences is the following :    known constructions of modeling limits for some nowhere dense classes with unbounded degrees @xcite are based on the construction of a countable `` skeleton '' on which residual parts are grafted .",
    "we shall use the same idea here for the general case .",
    "the countable skeleton will be built thanks to the following characterization of nowhere dense classes proved in @xcite :    [ thm : nd1 ] let @xmath1 be a class of graphs .",
    "then @xmath1 is nowhere dense if and only if for every integer @xmath0 and every @xmath139 there is an integer @xmath140 with the following property : for every graph @xmath141 , and every subset @xmath10 of vertices of @xmath142 , there is @xmath143 with @xmath144 such that no ball of radius @xmath0 in @xmath145 $ ] has order greater than @xmath146 .",
    "this theorem justifies the introduction of the following relaxation of the notion of residual sequence :    [ def : qres ] a sequence @xmath51 ( with @xmath147 ) is _ quasi - residual _ if , for every integer @xmath0 and every @xmath139 there exists an integer @xmath148 such that it holds @xmath149    in other words , @xmath51 is quasi - residual if , for every distance @xmath0 and every @xmath139 there exists an integer @xmath148 so that ( for sufficiently large @xmath43 ) one can remove at most @xmath148 vertices in the gaifman graph of @xmath58 so that no ball of radius @xmath0 will contain at least @xmath150 proportion of @xmath134 .",
    "the next result directly follows from theorem  [ thm : nd1 ] .",
    "let @xmath1 be a nowhere dense class of graphs and let @xmath78 be a sequences of graphs from @xmath1 such that @xmath151 .",
    "then @xmath78 is quasi - residual .",
    "we now consider a relaxation of the notion of residual sequence and show how this allows to partially reduce the problem of finding modeling @xmath46-limits to finding modeling @xmath7-limits .",
    "let @xmath0 be an integer and let @xmath150 be a positive real .",
    "a sequence @xmath51 is _",
    "@xmath152-residual _ if it holds @xmath153    similarly , a modeling @xmath101 is _",
    "@xmath152-residual _ if it holds @xmath154    [ lem : epsres ] let @xmath155 and let @xmath139 be a positive real .",
    "assume @xmath51 is a @xmath46-convergent @xmath156-residual sequence of graphs and assume @xmath73 is a @xmath156-residual modeling @xmath7-limit of @xmath51 .",
    "then for every @xmath0-local formula @xmath16 with @xmath2 free variables it holds @xmath157    by restricting the signature to the symbols in @xmath16 if necessary , we can assume that @xmath8 is finite .",
    "let @xmath158 be the quantifier rank of @xmath16 .",
    "then there exists finitely many local formula @xmath159 with quantifier rank at most @xmath158 ( expressing the rank @xmath158 @xmath0-local type ) such that :    * every element of every model satisfies exactly one of the @xmath160 ( formally , @xmath161 and @xmath162 if @xmath119 ) ; * two elements @xmath26 and @xmath27 satisfies the same local first - order formulas of quantifier rank at most @xmath158 if and only if they satisfy the same @xmath160 .",
    "let @xmath163 be the formula @xmath164 .",
    "by @xmath0-locality of @xmath16 there exists a subset @xmath165^p$ ] such that @xmath166.\\ ] ] let @xmath167 . for every structure",
    "@xmath9 it holds @xmath168 as @xmath73 is a modeling @xmath7-limit of @xmath58 it holds @xmath169 , hence @xmath170 on the other hand , as @xmath171 , for every structure @xmath9 holds @xmath172 note that @xmath173 is nothing but the expected measure of a ball of radius @xmath174 in @xmath9 . in particular , if @xmath9 is @xmath156-residual , then it holds @xmath175 .",
    "thus , @xmath157      to allow an effective use of the properties of quasi - residual sequences , we use a ( lifted ) variant of the notion of quasi - residual sequence .",
    "let @xmath8 be a countable signature and let @xmath176 be the signature obtained by adding to @xmath8 countably many unary symbols @xmath177 and @xmath178 .    for integers",
    "@xmath179 we define the formulas @xmath180 and @xmath181 as @xmath182 in other words , @xmath183 holds if @xmath26 belongs to the ball of radius @xmath0 centered at the element marked @xmath184 , and @xmath185 holds if @xmath26 belongs to the @xmath0-neighborhood of elements marked by @xmath186 .",
    "a sequence @xmath187 ( with @xmath188 ) of @xmath176-structures is a _ marked quasi - residual _ sequence if the following condition holds :    * for every integers @xmath189 it holds @xmath190 ( i.e. at most one element in @xmath191 is marked by @xmath184 ) ; * for every distinct integers @xmath192 and every integer @xmath43 , no element of @xmath191 is marked both @xmath184 and @xmath193 ; * for every integer @xmath0 there is a non - decreasing unbounded function @xmath194 with the property that for every integer @xmath43 it holds @xmath195 * for every integer @xmath0 and every positive real @xmath139 there is @xmath196 such that @xmath197 ( in other words , every ball of radius @xmath0 in @xmath198 contains less than @xmath150 proportion of all the vertices , as soon as @xmath43 is sufficiently large . ) * for every integer @xmath0 the following limit equality holds : @xmath199    the main purpose of this admittedly technical definition is to allow to make use of the sets @xmath200 arising in the definition of quasi - residual sequences by first - order formula , by means of the marks @xmath184 .",
    "the role of the marks @xmath186 is to allow a kind of of limit exchange .",
    "( note that @xmath201 is nothing but the ball of radius @xmath0 of @xmath202 centered at the element marked by @xmath184 . )",
    "[ lem : mqres ] for every quasi - residual sequence @xmath51 of @xmath8-structures there exists an @xmath46-convergent marked quasi - residual sequence @xmath203 of @xmath8-structures such that @xmath204 is a subsequence of @xmath51 .",
    "let @xmath205 be the signature obtained by adding to @xmath8 countably many unary symbols @xmath177 .",
    "for @xmath206 we define the @xmath205-structure @xmath207 has the @xmath205-structure obtained from @xmath58 by defining marks @xmath184 are assigned in such a way that for every @xmath155 and @xmath139 there is @xmath196 such that letting @xmath208 it holds @xmath209 this is obviously possible , thanks to the definition of a quasi - residual sequence .",
    "considering an fo - convergent subsequence we may assume that @xmath210 is @xmath46-convergent .    for @xmath155 we define the constant @xmath211 ( note that the values @xmath212 exist as @xmath210 is @xmath46-convergent and that they form , for increasing @xmath213 , a non - decreasing sequence bounded by @xmath81 . )    then for each @xmath155 there exists a non - decreasing function @xmath194 such that @xmath214 and @xmath215 then we define @xmath191 to be the sequence obtained from @xmath207 by marking by @xmath186 all the elements in @xmath216 .",
    "now we let @xmath217 to be a converging subsequence of @xmath187 .",
    "let @xmath218 be the formula asserting that the ball of radius @xmath0 centered at @xmath219 contains @xmath220 but no element marked @xmath221 , that is @xmath222    [ lem : zeta ] let @xmath187 be a marked quasi - residual sequence .",
    "then @xmath223    assume for contradiction that @xmath224 is strictly positive .    according to the definition of a marked quasi - residual sequence",
    ", there exists an integer @xmath213 such that no ball of radius @xmath0 in @xmath225 contains more than @xmath226 elements .",
    "let @xmath227 be such that @xmath228 , and let @xmath229 be such that @xmath230 holds for every @xmath231 .",
    "then there exists @xmath232 such that the ball of radius @xmath0 centered at @xmath232 contains no element marked @xmath221 ( hence no element marked @xmath233 ) and contains more than @xmath226 elements , what contradicts the fact that this ball is a ball of radius @xmath0 in @xmath225 .    in general , a modeling @xmath7-limit of a @xmath152-residual sequence does not need to be @xmath234-residual .",
    "however , if we consider a sequence that is also marked quasi - residual , and if we assume that the modeling @xmath7-limit satisfies the additional properties asserted by theorem  [ thm:1 ] then we can conclude that the modeling is @xmath235-residual , as proved in the next lemma .",
    "[ lem : resmod ] if the sequence @xmath236 is @xmath237-residual and @xmath238 is a modeling with the properties asserted by theorem  [ thm:1 ] then @xmath238 is @xmath152-residual .",
    "we first prove that the set @xmath239 of vertices @xmath240 such that the ball of radius @xmath174 centered at @xmath232 has measure greater than @xmath150 has zero measure . according to lemma  [ lem :",
    "zeta ] , it holds @xmath241 hence @xmath242 .",
    "this implies that the set @xmath243 of @xmath219 such that the ball of radius @xmath174 centered at @xmath219 contains no element marked @xmath244 and has measure at least @xmath150 has zero measure .",
    "hence we only have to consider vertices @xmath232 in the @xmath174-neighborhood of @xmath245 .",
    "let @xmath246    let @xmath247 .",
    "there exists @xmath248 such that @xmath249 which means that at least @xmath250 proportion of @xmath238 is at distance at most @xmath174 from elements marked @xmath251 .",
    "however , according to  , and as @xmath238 is a modeling @xmath7-limit of @xmath187 it holds @xmath252 which means that a @xmath253 proportion of @xmath238 is at distance at most @xmath174 from elements marked @xmath244 ( which include elements marked @xmath251 ) .",
    "thus the set @xmath254 of vertices in the @xmath174-neighborhood of @xmath245 but not in the @xmath174-neighborhood of @xmath255 has measure at most @xmath256 .",
    "let @xmath232 be in the @xmath174-neighborhood of @xmath255 .",
    "then the ball of radius @xmath174 centered at @xmath232 is included in the ball of radius @xmath257 centered at a vertex marked @xmath184 , for some @xmath258 . but this ball has measure @xmath259 . as the sequence @xmath236 is @xmath237-residual , it holds @xmath260 for sufficiently large @xmath43 .",
    "hence the ball of @xmath238 of radius @xmath174 centered at @xmath232 ( which is included in the ball of radius @xmath257 centered at the vertex marked @xmath184 ) has measure less than @xmath150 .",
    "it follows that the set of @xmath232 such that the ball of radius @xmath174 centered at @xmath232 has measure at least @xmath150 is included in @xmath261 hence has zero measure .",
    "now assume for contradiction that there exists a vertex @xmath232 such that the ball @xmath262 of radius @xmath0 centered at @xmath232 has measure at least @xmath150 .",
    "then for every @xmath263 the ball of radius @xmath174 centered at @xmath232 has measure at least @xmath150 , what contradicts the fact that the measure of @xmath262 is positive .",
    "we now consider how to turn a marked quasi - residual into a @xmath152-residual marked quasi - residual sequence .",
    "the idea here , is to encode each relation @xmath61 with arity @xmath264 with @xmath265 relations plus a sentence .",
    "the sentence expresses the behaviour of @xmath61 when restricted to elements marked @xmath233 .",
    "the @xmath265 relations expresses which tuples of non - marked elements can be extended ( and how ) with elements marked @xmath233 to form a @xmath115-tuple of @xmath61 .    as above , let @xmath176 be a countable signature with unary relations @xmath184 and @xmath266 .",
    "let @xmath267 .",
    "we define the signature @xmath268 as the signature obtained from @xmath176 by adding , for each symbol @xmath269 with arity @xmath264 the relation symbols @xmath270 of arity @xmath271 , where @xmath272 $ ] and @xmath273 $ ] .",
    "let @xmath202 be a @xmath176-structure .",
    "we define the structure @xmath274 as the @xmath268-structure @xmath275 , which has same domain as @xmath202 , same unary relations , and such that for every symbol @xmath276 with arity @xmath264 , for every @xmath272 $ ] and @xmath273 $ ] , denoting @xmath277 the elements of @xmath278\\setminus i$ ] and @xmath279 the elements of @xmath280 , it holds @xmath281   \\intertext{and } & \\mathbf a^\\ast\\models r(v_1,\\dots , v_k)\\\\ & \\iff \\mathbf a^+\\models r(v_1,\\dots , v_k)\\wedge\\bigwedge_{i=1}^k\\bigwedge_{j=1}^m\\neg m_j(v_i).\\end{aligned}\\ ] ]    note that the gaifman graph of @xmath275 can be obtained from the gaifman graph of @xmath202 by removing all edges incident to a vertex marked @xmath233 .",
    "we now explicit how the relation @xmath61 in @xmath202 can be retrieved from @xmath275 .    for @xmath267 , @xmath269 with arity @xmath264 , and @xmath282^k$ ]",
    "let @xmath283 be defined as follows : @xmath284 \\\\",
    "\\vee   \\bigvee_{\\emptyset\\neq i\\subseteq [ k]}\\bigvee_{f : i\\rightarrow [ m]}\\bigl[n_{i , f}(x_{i_1},\\dots , x_{i_\\ell})\\wedge\\bigwedge_{i\\in i}m_{f(i)}(x_i)\\wedge\\bigwedge_{i\\in [ k]\\setminus ii } \\bigwedge_{j=1}^m\\neg m_{j}(x_i)\\bigr]\\\\      \\end{gathered}\\ ] ]    and let @xmath285 be the following sentence , which expresses that @xmath286 encodes the set of all the tuples of elements marked @xmath233 in @xmath61 .",
    "@xmath287\\\\ \\wedge\\neg\\bigl[\\bigvee_{(i_1,\\dots , i_k)\\in[m]^k\\setminus\\mathcal z}(\\exists x_1,\\dots , x_k ) \\bigl(r(x_1,\\dots , x_k)\\wedge\\bigwedge_{j=1}^k ( m_{i_j}(x_i)\\bigr)\\bigr ] .",
    "\\end{gathered}\\ ] ]    the following lemma sums up the main properties of our construction .    [ lem : enc ] let @xmath202 be a @xmath176-structure , and let @xmath288 .",
    "let @xmath269 be a relation symbol with arity @xmath264 .",
    "then    * there exists a unique subset @xmath286 of @xmath289^k$ ] such that @xmath290 * for this @xmath286 and for every @xmath291 it holds @xmath292    this lemma straightforwardly follows from the above definitions .",
    "let @xmath267 be fixed .",
    "an _ elimination theory _ is a set @xmath293 containing , for each @xmath269 with arity @xmath264 , exactly one sentence @xmath285 ( for some @xmath294^k$ ] ) . for a @xmath176-structure @xmath202 , the _ elimination theory of @xmath202 _",
    "is the set of all sentences @xmath285 satisfied by @xmath202 .",
    "for a formula @xmath37 , we define the _ elimination formula _",
    "@xmath295 of @xmath16 with respect to an elimination theory @xmath296 as the formula obtained from @xmath16 by replacing each occurence of relation symbol @xmath61 with arity @xmath264 by the formula @xmath297 , where @xmath286 is the unique subset of @xmath289^k$ ] such that @xmath298 .",
    "it directly follows from lemma  [ lem : enc ] that if @xmath202 is a @xmath176-structure which satisfies all sentences in an elimination theory @xmath296 , then for every formula @xmath37 , denoting @xmath295 the elimination formula of @xmath16 with respect to @xmath296 it holds @xmath299      let us recall gaifman locality theorem .",
    "[ thm : g ] every first - order formula @xmath300 is equivalent to a boolean combination of @xmath301-local formulae @xmath302 and basic local sentences of the form @xmath303 where @xmath16 is @xmath304-local .",
    "furthermore @xmath305 , @xmath306 , @xmath307 , and , if @xmath308 is a sentence , only basic local sentences occur in the boolean combination .    from this theorem",
    "we deduce :    [ lem : asymploc ] let @xmath51 be an elementary convergent sequence of @xmath8-structures .",
    "then for every formula @xmath309 with quantifier rank @xmath158 there exists a @xmath310-local formula @xmath311 and an integer @xmath227 such that for every @xmath312 it holds @xmath313 .",
    "according to theorem  [ thm : g ] @xmath16 is equivalent to a boolean combination of sentences and @xmath310-local formulas .",
    "putting it in disjunctive normal form and considering all boolean combinations of the sentences , we get that @xmath16 is equivalent to @xmath314 , for some sentences @xmath315 and @xmath310-local formulas @xmath316 , with the additional property that in every model exactly one of the sentences @xmath317 is satisfied .",
    "( formally we require @xmath318 and @xmath319 for @xmath119 . )",
    "as @xmath51 is elementary convergent , there exists @xmath320 and @xmath321 such that @xmath322 for every @xmath312 .",
    "let @xmath323 .",
    "then the result follows from @xmath324 .",
    "we can now prove our main result , which directly implies conjecture  [ conj : res ] and , from which will also follow conjecture  [ conj : nd ] .",
    "[ thm : main ] every quasi - residual fo - convergent sequence has a modeling limit .",
    "let @xmath325 be an fo - convergent quasi - residual sequence . according to lemma  [ lem : mqres ] , up to considering a subsequence",
    ", there exists an @xmath46-convergent marked quasi - residual sequence @xmath187 of @xmath8-structures such that @xmath326 .",
    "let @xmath238 be a modeling with properties asserted by theorem  [ thm:1 ] , and let @xmath327 .",
    "our aim is to prove that @xmath73 is a modeling limit of the sequence @xmath51 .",
    "let @xmath309 be a formula with quantifier rank @xmath158 and @xmath2 free variables , and let @xmath139 be a positive real .",
    "let @xmath328 and let @xmath213 and @xmath227 be integers such that for every @xmath312 no ball of radius @xmath329 in @xmath330 contains at least @xmath331 vertices .",
    "let @xmath332 .",
    "each relation of @xmath333 being defined by a fixed formula from relations of @xmath191 , the sequence @xmath334 is @xmath46-convergent and @xmath335 is a modeling @xmath7-limit of @xmath334 satisfying additional properties asserted by theorem  [ thm:1 ] .",
    "let @xmath296 be the elimination theory of @xmath238 ( as defined above ) . as @xmath238 is an @xmath7-limit ( hence an elementary limit ) of @xmath187 there exists @xmath229 such that for every symbol @xmath269 with arity @xmath264 used in @xmath16 , if @xmath298 then @xmath336 holds for every @xmath231 .",
    "let @xmath295 be the elimination formula of @xmath16 with respect to @xmath296 .",
    "note that @xmath295 has also quantifier rank at most @xmath158 . according to lemma  [ lem : enc ] , for every @xmath231 it holds @xmath337 .",
    "thus , as @xmath338 ( as @xmath16 only uses symbols in @xmath8 ) it holds @xmath339 as @xmath340 satisfies @xmath296 we get @xmath341    note that by our choice of @xmath213 the sequence @xmath342 is @xmath343-residual hence by lemma  [ lem : resmod ] the modeling @xmath340 is @xmath344-residual .",
    "according to lemma  [ lem : asymploc ] there exists a @xmath0-local formula @xmath311 and an integer @xmath345 such that for every @xmath346 it holds @xmath347 hence @xmath348 as @xmath340 is elementary limit of @xmath334 it similarly holds @xmath349    according to lemma  [ lem : epsres ] ( as @xmath311 is @xmath0-local , @xmath342 is @xmath343-residual and @xmath340 is @xmath344-residual ) it holds @xmath350 hence by and it holds latexmath:[\\[\\label{eq : approx }    as holds for every @xmath139 we have @xmath76 as this holds for every formula @xmath309 , we conclude that @xmath73 is a modeling limit of @xmath51 .    from theorems  [ thm : nd1 ]",
    "it follows that any @xmath46-convergent sequence of graphs from a nowhere dense class is quasi - residual thus from theorem  [ thm : main ] directly follows a proof of conjecture  [ conj : nd ] .",
    "let @xmath1 be a monotone class of graphs .",
    "then @xmath1 has modeling limits if and only if @xmath1 is nowhere dense .",
    "let @xmath10 and @xmath262 be measurable subsets of the domain @xmath60 of the modeling limit of an fo - convergent sequence @xmath51 of finite structures .",
    "assume that every element in @xmath10 has at least @xmath352 neighbours in @xmath262 and every element in @xmath262 has at most @xmath353 neighbours in @xmath10 .",
    "it is easily checked that if both @xmath10 and @xmath262 are first - order definable ( without parameters ) then holds : let @xmath355 and @xmath356 .",
    "define @xmath357 then @xmath358 and @xmath359 . as @xmath360 holds for every integer @xmath43 ( as @xmath58 is finite ) , by continuity we deduce @xmath361 .",
    "however , it is not clear whether an fo - convergent sequence of graphs from a nowhere dense class has a modeling limit that satisfies the strong finitary mass transport principle .",
    "this can be formulated as            * the theory of @xmath73 has the finite model property .",
    "* every interpretation of @xmath73 satisfies the finitary mass transport principle . precisely , for every first - order formulas @xmath362 such that @xmath363 it holds @xmath364 * for every integer @xmath0 there is an integer @xmath148 such that @xmath73 does not contain the @xmath0-th subdivision of @xmath365 .        note",
    "that the last condition implies that there exists no integer @xmath0 such that @xmath73 includes the @xmath0-subdivision of @xmath366 , thus @xmath73 has a countable skeleton , that is there are @xmath367 such that for every integer @xmath0 and every @xmath139 there is @xmath148 with the property @xmath368                  c.  borgs , j.  chayes , l.  lovsz , v.t .",
    "ss , and k.  vesztergombi , _ counting graph homomorphisms _ , topics in discrete mathematics ( m.  klazar , j.  kratochvl , m.  loebl , j.  matouek , r.  thomas , and p.  valtr , eds . ) , algorithms and combinatorics , vol .",
    "26 , springer verlag , 2006 , pp .",
    "315371 .        c.  borgs , j.t .",
    "chayes , l.  lovsz , v.t .",
    "ss , and k.  vesztergombi , _ convergent sequences of dense graphs i : subgraph frequencies , metric properties and testing _ , adv . math .",
    "* 219 * ( 2008 ) , no .",
    "6 , 18011851 .",
    "j.  gajarsk , p.  hlinn , t.  kaiser , d.  kr , m.  kupec , j.  obdrlek , s.  ordyniak , and v.  tuma , _ first order limits of sparse graphs : plane trees and path - width _ , http://arxiv.org/abs/1504.08122v1 , 2015 .",
    "m.  grohe , s.  kreutzer , and s.  siebertz , _ deciding first - order properties of nowhere dense graphs _ , proceedings of the 46^th^ annual acm symposium on theory of computing ( new york , ny , usa ) , stoc 14 , acm , 2014 , pp .",
    "8998 .",
    "j.  o , _ quelques remarques , thormes et problmes sur les classes dfinissables dalgbres _ , mathematical interpretation of formal systems , studies in logic and the foundations of mathematics , north - holland , 1955 .",
    "to3em , _ regularity partitions and the topology of graphons _ , an irregular mind ( szemerdi is 70 ) ( i.  brny and j.  solymosi , eds . ) , bolyai society mathematical studies , vol .",
    "21 , springer , 2010 , pp .",
    "415446 .                              c.  steinhorn , _ borel structures for first - order and extended logics _ , harvey friedman s research on the foundations of mathematics ( a.  sdrov l.a .",
    "harrington , m.d .",
    "morley and s.g .",
    "simpson , eds . ) , studies in logic and the foundations of mathematics , vol . 117 , elsevier , 1985 , pp .  161  178"
  ],
  "abstract_text": [
    "<S> a sequence of graphs is fo - convergent if the probability of satisfaction of every first - order formula converges . </S>",
    "<S> a graph modeling is a graph , whose domain is a standard probability space , with the property that every definable set is borel . </S>",
    "<S> it was known that fo - convergent sequence of graphs do not always admit a modeling limit , and it was conjectured that this is the case if the graphs in the sequence are sufficiently sparse . </S>",
    "<S> precisely , two conjectures were proposed :    1 .   </S>",
    "<S> if a fo - convergent sequence of graphs is residual , that is if for every integer @xmath0 the maximum relative size of a ball of radius @xmath0 in the graphs of the sequence tends to zero , then the sequence has a modeling limit . </S>",
    "<S> 2 .   a monotone class of graphs @xmath1 has the property that every fo - convergent sequence of graphs from @xmath1 has a modeling limit if and only if @xmath1 is nowhere dense , that is if and only if for each integer @xmath2 there is @xmath3 such that no graph in @xmath1 contains the @xmath2th subdivision of a complete graph on @xmath3 vertices as a subgraph .    in this paper </S>",
    "<S> we prove both conjectures . </S>",
    "<S> this solves some of the main problems in the area and among others provides an analytic characterization of the nowhere dense  somewhere dense dichotomy . </S>"
  ]
}