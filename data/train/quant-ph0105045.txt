{
  "article_text": [
    "nuclear magnetic resonance ( nmr ) spectroscopy has become well established as a tool for exploratory experimental investigations of quantum computation .",
    "fundamental gates , algorithms , error correction and other issues in quantum information theory have been demonstrated at the level of a few qubits using room temperature , solution state nmr systems.@xcite    recently we successfully implemented the @xmath0 case of the deutsch - jozsa algorithm using room temperature solution state nmr.@xcite this implementation was characterized by the choice of qubits , namely the @xmath1 nuclei of alanine , and the resulting methods for processing the quantum information .",
    "the homonuclear nature of the qubits ( henceforth qubit and spin are used interchangeably ) demands qubit selective pulses throughout the realization , thus greatly complicating the experimental effort in comparison to a heteronuclear system .",
    "furthermore the arrangement of couplings between qubits in alanine is such that the only reliable method for processing quantum information is along a chain of qubits , whose pattern of couplings is effectively @xmath2 ( i.e.  the @xmath3 coupling is too weak ) .",
    "this demands `` indirect '' gate realizations using swapping techniques via intermediate spins  @xcite and is more difficult than `` direct '' realizations , possible in the fully coupled case .",
    "although these restrictions are artificial at the level of a few qubits there is reason to believe that they will become important as the number of qubits increases  @xcite .",
    "therefore the ability to implement the associated information processing techniques will become crucial ; hence our choice of this restrictive qubit system .    even at the low level of three qubits",
    "the resulting experiments were sufficiently complicated to motivate the development and use of a host of simplification techniques and experimental methods to construct the appropriate pulse sequence .",
    "much of the literature bypasses or only briefly describes such details , which will become increasingly important as the number of qubits in nmr quantum computation implementations grows .",
    "the purpose of this article is to describe in detail the construction of an nmr realization from the theoretical algorithm through to the final spectrometer output and the algorithm result .",
    "section  [ sec : dj ] briefly describes the deutsch - jozsa problem and algorithm and the initial decomposition of the algorithm s evolution stage into fundamental quantum gates .",
    "section  [ sec : qctheory ] covers the theoretical development of initialization schemes , pulse sequences and readout schemes .",
    "general pulse sequence compilation techniques and methods for constructing indirectly coupled gate realizations are presented here .",
    "section  [ sec : exp ] describes the experimental details and includes pulse parameterization , bookkeeping methods for pulse phases , construction of appropriate evolution delays , results and possible sources of error .",
    "the deutsch problem  @xcite addresses a global property of certain binary valued functions @xmath4 . in particular ,",
    "a function is _ balanced _ if it returns @xmath5 as many times as @xmath6 after evaluation over its entire range .",
    "given any function which is either balanced or constant the problem is to determine its type .",
    "classical algorithms which rely on repeatedly evaluating the function for various arguments require a number of evaluations which grows exponentially with @xmath7 to answer the problem with certainty  @xcite .",
    "however , a quantum algorithm requires a single evaluation of @xmath8 and solves the problem with certainty  @xcite . in its simplest rendition",
    "the algorithm needs an @xmath7 qubit register  @xcite and follows the scheme illustrated in fig .",
    "[ pic : djscheme ] .",
    "the ease of implementation relative to other quantum algorithms has made the deutsch - jozsa algorithm a natural candidate for experimental nmr demonstrations of features of quantum computation .",
    "the @xmath9 case , using the cleve version  @xcite , was the first quantum algorithm implemented experimentally  @xcite .",
    "this was followed by the @xmath10 case  @xcite .",
    "however , the algorithm is uninteresting from a quantum computational perspective for @xmath11 , in which case the essential operations could be implemented classically  @xcite . recently the modified version ( see fig .  [",
    "pic : djscheme ] ) of the @xmath12 algorithm has been implemented for various balanced functions  @xcite .",
    "finally , limited balanced function cases at the @xmath13 level have been tested using the cleve version  @xcite .",
    "the heart of the deutsch - jozsa algorithm is the function evaluation step , @xmath14 and the bulk of the effort in any experiment will be devoted to its realization .",
    "this is initiated by decomposing @xmath15 into a product of fundamental one and two qubit operations which are amenable to physical realization . in general single bit rotations ( one qubit operations ) and controlled - not gates ( two qubit operations ) are satisfactory.@xcite in this scheme",
    ", the hope is to be able to devise physical realizations for the fundamental gates and concatenate these to recreate @xmath15 .",
    "the definition of @xmath15 , eq .  ( [ eq : ufdef ] ) , does not immediately provide such a decomposition .",
    "one approach for arriving at a fundamental gate decomposition begins by representing any admissible function via power series expansions in the argument bits , @xmath16 where @xmath17 .",
    "such expansions terminate since @xmath18 for @xmath19 , leaving at most a cubic term for @xmath0 .",
    "however , it can be shown that for balanced and constant functions the cubic term disappears .",
    "thus for @xmath0 any admissible function can be expanded as : @xmath20 where addition is modulo 2 and @xmath21 .",
    "therefore @xmath22 the constant term merely provides an irrelevant overall phase factor and can be ignored .",
    "the quadratic and linear terms motivate the definitions of the _ quadratic term gates _ and _ linear term gates _ : @xmath23 leaving @xmath24 where the order of operation reads from right to left .",
    "however , quadratic and linear term gates all commute and any rearrangement is permitted in this decomposition .",
    "decompositions of these in terms of fundamental gates are @xmath25 where @xmath26 is a controlled - not gate with control @xmath27 and target @xmath28 and @xmath29 is the operator representation of a rotation of spin @xmath27 about axis @xmath30 through angle @xmath31 .",
    "there are @xmath32 balanced functions with @xmath7 bit arguments and for @xmath0 this gives @xmath33 distinct possibilities",
    ". however , certain distinct balanced functions are such that the operations required to realize @xmath15 are related by permutations of the argument qubits .",
    "for example , permuting the qubit indices using the rule @xmath34 transforms the operation required to realize @xmath35 to that for @xmath36 . the physical difference between",
    "the realization for these cases is minor in comparison to that for a case which is unrelated in this fashion ; an example is @xmath37 .",
    "thus it makes sense to classify the balanced functions according to the similarity of their power series expansions under permutations of argument indices ; this is mirrored by an equivalent classification of the operations required for function evaluation under qubit permutations . within each class",
    "the arrangement of linear and quadratic term gates differ only by permutations of their qubit indices and this reduces the number of essentially different experimental realizations needed to demonstrate the algorithm .",
    "it emerges that there are ten classes of balanced functions ; a representative of each is provided in table  [ tab : foutput ] .",
    "all possible quadratic term gates are required for the classes represented by @xmath38 and @xmath39 and all possible linear term gates are required for @xmath40 .",
    "thus realization of the algorithm for one representative from each class requires the construction of all possible linear and quadratic term gates , which could be used for realization of any other case . the experiment will be limited to one function from each balanced class plus the constant functions",
    ".    .representatives of each class of admissible functions ( @xmath0 ) and the corresponding density operator after the function evaluation step . [ cols=\"<,<\",options=\"header \" , ]",
    "nmr spectroscopy of spin @xmath41 nuclei of appropriate molecules in solution offers a readily accessible experimental approach to quantum computing.@xcite any molecule containing three distinguishable , coupled spin @xmath41 nuclei in an external magnetic field provides the three qubits needed to solve the @xmath0 deutsch problem . to a good approximation",
    "the hamiltonian for a room temperature , solution - state sample is @xmath42 where @xmath43 are the zeeman frequencies , @xmath44 the scalar coupling constants , and @xmath45 pauli operators  @xcite .",
    "superscripts label the spins and identify them with the corresponding argument bits .      equations  ( [ eq : fdecomp ] )  -  ( [ eq : quadgateseq ] ) provide a method for constructing a real pulse sequence for @xmath15 in terms of an appropriate sequence of single bit rotations and controlled - not gates .",
    "pulse sequences for the latter then enable a practical realization of the algorithm .",
    "the resulting sequences can be displayed , following conventional quantum mechanics formalism , as a sequence of operators with order of application read from right to left , @xmath46 .",
    "an alternative , more familiar to nmr users , is a sequence of pulses , @xmath47 - \\left [ u_2 \\right ] - \\cdots - \\left [ u_m \\right]$ ] , with order of application read from left to right . in the room temperature , solution - state nmr paradigm two types of operations",
    "are necessary and sufficient for gate construction .",
    "these are spin selective rotations caused by appropriate externally applied rf pulses , and delays during which the system evolves under only one of the hamiltonian coupling terms .",
    "the process of pulse sequence construction is initially simplified by considering spin selective rotations which are idealized in the sense that they are instantaneous and yet perfectly selective .",
    "an ideal rotation of spin @xmath27 about axis @xmath48 through angle @xmath31 will be represented by the pulse sequence term @xmath49^i_n$ ] , corresponding to the operator @xmath50 .",
    "a delay or period of free evolution of duration @xmath51 under the scalar coupling term @xmath52 ( no sum over the indices ) alone will be represented by @xmath53 or the pulse sequence term @xmath54^{ij}$ ] .",
    "this operation is unnatural in the sense that some of the scalar coupling terms are absent . in practice",
    "it is more convenient to build this from periods of free evolution of duration @xmath51 under all scalar couplings , one of which will be denoted @xmath55 or @xmath54^{\\mbox{\\scriptsize tot}}$ ] .",
    "single qubit gates , equivalent to qubit selective rotations , can be implemented by applying spin selective rf pulses of the appropriate shape , power and duration  @xcite .",
    "controlled - not gates can be realized using the rotation and delay method  @xcite .",
    "there are two idealized decompositions ( i.e.  in terms of idealized rotations ) : @xmath56 or in pulse sequence terms : @xmath57                                   = \\left [ 90^\\circ \\right]^j_{\\pm y }                                   - \\left [ 1/2j_{ij } \\right]^{ij }                                   - \\left [ 90^\\circ \\right]^j_{\\pm x }                                   - \\left [ 90^\\circ \\right]^i_{\\pm z }                                   - \\left [ 90^\\circ \\right]^j_{-z }   \\label{eq : cn2}\\ ] ] where the axes of rotation are given by either all the upper signs or else all the lower signs .    in order to implement any algorithm",
    ", it suffices to simply concatenate constituent pulse sequences for the required fundamental gates .",
    "however , the difficulty of experimental implementation may be reduced by various simplification techniques , which can be implemented efficiently at the algorithm design level via rudimentary , general schemes , applicable in any physical realization .",
    "these use @xmath58 where @xmath59 and which is easily verified by expansion and multiplication .",
    "this provides two avenues for simplification :    * the pulse sequence can be rearranged so that all rotations about @xmath60 follow all other operations .",
    "this is possible in the context of the linear and quadratic term gates because such rotations commute with periods of evolution under @xmath61 and because they can be interchanged with rotations about axes in the transverse plane by applying eq .",
    "( [ eq : rotint ] ) ( here illustrated for qubit @xmath27 , but applicable for any @xmath27 ) : @xmath62 the result is that , all rotations about @xmath60 on qubit @xmath27 can be replaced , after modification of the succeeding rotations on qubit @xmath27 , by a single rotation about @xmath60 on qubit @xmath27 immediately prior to the measurement step . in the context of solution state nmr spectroscopy this can be implemented via a qubit dependent phase shift applied to the acquired data .",
    "the need to actively implement @xmath60 rotations is thereby eliminated . *",
    "successive @xmath63 rotations ( on one qubit and with no intervening period of evolution under couplings involving this qubit ) about orthogonal axes in the @xmath64 plane , @xmath65 and @xmath66 , can be replaced by a single rotation about an axis in the @xmath64 plane followed by a rotation about @xmath60 . again eq .",
    "( [ eq : rotint ] ) prescribes : @xmath67 and @xmath68 is oriented along @xmath69 .",
    "the @xmath60 rotation can be interchanged with all succeeding operations according to the previous scheme .",
    "this reduces the number of rotations requiring active implementation .",
    "the number of steps required to carry out these compilation procedures scales polynomially with the number of gates and thus does not adversely affect the computational complexity of the algorithm . applying these rules to the concatenated sequences for the deutsch - jozsa algorithm yields :",
    "* the linear term gates and other single qubit rotations about @xmath60 can be interchanged with the remaining gates ( with appropriate modifications to their axes of rotation ) and absorbed in the final qubit - dependent phase shifts .",
    "these can be implemented passively via mathematical transformations on the acquired data and need not be included in the actual physical information processing stage .",
    "the fact that this gives a single manipulation per qubit means that this strategy does not change the computational complexity of the problem . *",
    "the remaining gates in the sequence are either single qubit rotations through @xmath63 about the @xmath70 or @xmath71 axes and scalar coupling gates . for any qubit",
    ", the single qubit rotations which appear between successive scalar coupling gates involving this qubit can be reduced to at most one rotation about an axis in the @xmath64 plane and at most one rotation about @xmath60 , which can be interchanged and absorbed as a phase shift .",
    "the result of compilation is a sequence of scalar coupling gates interspersed with single qubit rotations about axes in the @xmath64 plane and terminated with one qubit dependent rotation about @xmath60 per qubit .",
    "thus the sequence of operations involving qubit @xmath27 ( ignoring operations which only involve the remaining qubits ) has the form , @xmath72 where @xmath73 is the number of scalar coupling gates in the sequence , and @xmath74 , @xmath75 and @xmath76 are arrays of parameters which are determined by the algorithm and pulse sequence compilation .",
    "the distillation , via the compilation scheme , of all qubit selective rotations about @xmath60 to one rotation per qubit immediately prior to measurement and the possibility of implementation via post - acquisition mathematical operations motivates the division of the pulse sequence into an _ active section _ ,",
    "@xmath77 and a _ passive section _",
    ", @xmath78 giving @xmath79 in an nmr realization the active section has to be implemented by externally applied fields and delays for internal hamiltonian evolution .",
    "this requires an experiment in which the appropriate pulse parameters ( corresponding to @xmath80 and @xmath81 ) and delays ( corresponding to @xmath82 ) are carefully adjusted so as to achieve the correct evolution .",
    "in contrast the passive section is best implemented mathematically on the acquired data using the spectrometer s phase shifting capability .",
    "an interesting and useful feature of the active section of the pulse sequence is that the absolute orientations of its constituent rotations axes are less important than their relative orientations provided that the initial density operator satisfies certain general conditions .",
    "this results from eq .",
    "( [ eq : rotint ] ) which gives @xmath83 and consequently @xmath84 where @xmath85 .",
    "the initial rotation , @xmath86 , can be omitted whenever the initial state of the system is a mixture of eigenstates of @xmath87 operators .",
    "examples include the thermal equilibrium state for weakly coupled nuclei and pure ( or the equivalent pseudopure ) states such as @xmath88 .",
    "henceforth we shall consider this case , so that @xmath89 and which demonstrates that , for qubit @xmath27 , only the relative orientations of the axes of the rotations on qubit @xmath27 are important .",
    "thus the axis of the initial rotation for each qubit can be chosen arbitrarily with no need to correlate these between the different qubits .",
    "thereafter the axes of the succeeding rotations are fixed .",
    "the freedom of choice of the axis of the initial rotation is offset by the necessity for a compensatory adjustment in phase of the passive section rotation although later it will emerge that this is unimportant for the @xmath0 deutsch - jozsa algorithm .",
    "this simplification is akin to working in co - rotating frames ( one for each spin ) which do not coincide at the point of the first spin selective rotation and eq .",
    "( [ eq : ipulses3 ] ) demonstrates that this is legitimate .      for linear term gates",
    "the resulting idealized pulse sequence is @xmath90 =   \\left [ 180^\\circ \\right]^i_z.\\ ] ] the function evaluation gate can always be arranged so that the linear term gates appear after the quadratic term gates .",
    "this adds @xmath91 to the passive section @xmath60 rotation for spin @xmath27 and can be implemented as part of the post - acquisition phase shift .",
    "this motivates a further classification of admissible functions based on the similarity of the active sections of the evaluation step pulse sequence ( i.e.  on the similarity of the quadratic terms in @xmath8 ) . ignoring all linear terms and distinguishing only between arrangements of quadratic terms ,",
    "the following classes emerge : @xmath92 , @xmath93 , @xmath94 and @xmath95 . within a given class",
    "the pulse sequences differ only by combinations of @xmath91 post - acquisition phase shifts ; their active sections are identical .",
    "there are essentially four different experiments to perform to implement @xmath0 deutsch - jozsa algorithm .",
    "apart from the initial rotations , the only other contributions to the active sections of the pulse sequences come from the quadratic term gates .",
    "substitution of a controlled - not gate pulse sequence , eq .",
    "( [ eq : cn1 ] ) , into the quadratic term gate decomposition , eq .",
    "( [ eq : quadgateseq ] ) , followed by compilation yields the idealized pulse sequence @xmath96 or @xmath97 = \\left [ 1/2j_{ij } \\right]^{ij }                - \\left [ 90^\\circ \\right]^j_{-z }                - \\left [ 90^\\circ \\right]^i_{-z}.   \\label{eq : quseq}\\ ] ] the success of a literal translation of this sequence into a refocused delay followed by relevant phase shifts depends on the ratio of @xmath98 to the fastest relaxation rate for the spins which represent the qubits . if this ratio is large enough then such a _ directly coupled realization _ is feasible .    on the other hand",
    ", if @xmath98 is comparable to or less than any of the relaxation rates the directly coupled realization will result in unacceptable errors . however , provided that a network of substantially stronger couplings connects @xmath27 and @xmath28 it may be possible to implement an _ indirectly coupled realization _ by swapping information along the coupling pathway .",
    "suppose , for example , that each of @xmath27 and @xmath28 are coupled to @xmath99 appropriately strongly .",
    "then the swap operation @xmath100 , defined on the computational basis as @xmath101 and extended linearly to all states , allows  @xcite information to be exchanged via @xmath99 . a decomposition into controlled - not gates is given in fig .",
    "[ pic : swap_cnot ] .",
    "two possibles strategies for the construction of @xmath102 are apparent :    * use evolution under the coupling between @xmath99 and @xmath28 and the swapping technique to give @xmath103 one possible compiled pulse sequence is provided in fig .",
    "[ pic : quad_ind ] .",
    "others are available by mixing alternative constructions for the constituent controlled - not gates . +",
    "* use an indirectly coupled controlled - not gate between @xmath28 and @xmath99 to construct a controlled - not gate between @xmath27 and @xmath28 , which in turn gives @xmath102 .",
    "thus @xmath104 and @xmath105 and simplification gives the sequence of fig .",
    "[ pic : quad_cnot ] .    the relevant quadratic term gate",
    "can then be constructed by appending the appropriate rotations about @xmath106 .",
    "the pulse sequences of eqs .",
    "( [ eq : cn2 ] ) and ( [ eq : quseq ] ) or figs .",
    "[ pic : quad_ind ] and [ pic : quad_cnot ] assume that the internal hamiltonian for the molecule , eq .",
    "( [ eq : ham ] ) , is only active is during the delays which appear in the sequence .",
    "furthermore during such delays it is assumed that only one scalar coupling term is active .",
    "these assumptions fail in two ways .",
    "first , externally applied spin selective rf pulses have a finite duration , during which the hamiltonian is active .",
    "second , during any delays , which are implemented in practice by allowing the spins to evolve freely for an appropriate duration , all the terms of the hamiltonian are active .    during the externally applied pulses this is addressed by neglecting evolution under the coupling terms , which are typically small in comparison to the external field strengths , and noting that evolution under the zeeman terms can be viewed as rotations about the @xmath106 axis . in this approximation",
    "the effect of hamiltonian evolution has been to include unwanted qubit - dependent @xmath106 rotations .",
    "fortunately , eq .  ( [ eq : zrot_rearrange ] ) provides a rule for interchanging any such @xmath106 rotation with succeeding rotations about transverse axes for the same qubit and gives the necessary phase correction for these",
    ". additionally they commute with any scalar coupling terms .",
    "thus the zeeman evolution terms can be interchanged so that they effectively appear at the end of the algorithm pulse sequence .",
    "this procedure amounts to working in the co - rotating frames , which essentially remove the zeeman terms from @xmath61 .",
    "the same technique effectively removes the zeeman terms during delays for scalar coupling evolution .",
    "the remaining difficulty is to `` turn off '' evolution due to other scalar couplings during the delay .",
    "this is accomplished via standard refocusing schemes  @xcite , which are based on periods of free evolution under all scalar coupling terms interspersed with qubit selective @xmath91 rotations .",
    "for example , the sequence @xmath107 where @xmath108 , results in evolution of duration @xmath109 under all scalar couplings _ except those involving spin @xmath28 _ together with the identity operation on spin @xmath27 ( ignoring the zeeman evolutions as discussed previously ) .",
    "a typical room temperature solution state nmr sample consists of an ensemble of non - interacting identical molecules .",
    "although the nuclear spin state of any individual constituent molecule is generally inaccessible , it is possible to control and acquire information about the ensemble s average state , typically described in terms of the system s density operator .",
    "fortunately , it has been possible to modify conventional quantum computation schemes accordingly . in particular ,",
    "initialization schemes , relying on the concept of pseudopure states have been developed  @xcite and tomography schemes allow for the reconstruction of final state density operators  @xcite . the algorithm stage is implemented by subjecting the ensemble to a pulse sequence derived from the concatenation of the pulse sequences for the algorithm s constituent fundamental gates .",
    "bulk state preparation and tomography schemes typically require efforts , in the form of additional pulses or repeated experiments , beyond those demanded by the algorithms .",
    "however , it emerges that , for @xmath110 , it is possible to apply the evolution stage ( see fig .  [",
    "pic : djscheme ] ) directly to a thermal equilibrium initial state and successfully solve the deutsch problem with an expectation value measurement  @xcite .",
    "analysis of the system state after the function evaluation step , which is equivalent to running the algorithm followed by the readout @xmath111 , demonstrates this for @xmath0 ( the reasoning is similar for @xmath112 ) . using the product operator formalism ,",
    "the deviation part of the thermal equilibrium equilibrium density operator for a weakly coupled homonuclear nmr system is proportional to  @xcite @xmath113 setting the initial rotation s axis to @xmath114 results in @xmath115 which are listed in table  [ tab : foutput ] .",
    "the spectrometer measures the components of the magnetization along the @xmath70 and @xmath116 axes , @xmath117 where @xmath118 is the density operator immediately prior to acquisition .",
    "finally the spectrum resulting from a time domain fourier transform of @xmath119 is calculated and displayed .",
    "the acquisition phase , @xmath120 , describes any overall phase which is independent of the pulse sequence applied to the sample .",
    "typically it depends on factors such as the spectrometer s construction , probe construction or receiver electronics and may be difficult to determine .",
    "the appearance of any spectrum depends on @xmath120 , although this can be adjusted arbitrarily by applying phase shifts to the acquired data . in conventional nmr applications",
    "the lack of knowledge of @xmath120 does not usually impose any impediments .",
    "for example , post - acquisition phase shifts can be applied to the data so a line of interest appears in absorption mode . however , for quantum computation purposes @xmath120 could be important because the only possible method of extracting information from @xmath118 , and hence results from the computation , is via the acquired spectrum .",
    "fortunately , the fact that @xmath120 is constant for different pulse sequences means that it is completely irrelevant when comparing two spectra provided that the physical setup ( except for the pulse sequences ) used to acquire these is unaltered . in practice",
    "such comparisons are facilitated by adjusting post - acquisition phase shifts .",
    "it follows that the algorithm will have to be answered by comparing spectra .",
    "signal acquisition _ immediately after application of @xmath15 _ and with _ no additional readout pulses _ provides a spectrum , the _ @xmath8-spectrum _ , whose form depends on @xmath8 .",
    "this will be compared to a _ fiducial spectrum _ which is obtained in the same way but with @xmath15 replaced by @xmath121 ; here the system s pre - acquisition state is @xmath122 , identical to the @xmath8-spectrum for a constant function .",
    "the pertinent features of the resulting spectra can be deduced from the density operator prior to acquisition and depend on the presence of scalar coupling terms .",
    "the analysis is simplest in the case where all scalar coupling strengths are significantly larger than the line widths .",
    "= 2.2 in    here each multiplet consists of four distinct lines .",
    "the form of the spin @xmath28 multiplet ( i.e. the lines relative intensities and phases ) depends on the density operator term containing a factor of @xmath123 ( see fig .",
    "[ pic : multiplets ] ) . a single factor of @xmath123 yields a multiplet with lines of equal phases and intensities .",
    "@xmath124 yields an multiplet in which the pairs of lines separated by frequency @xmath44 have opposite phases but equal intensities ( an antiphase multiplet ) .",
    "@xmath125 yields a multiplet in which pairs of lines separated by a @xmath44 have opposite phases while simultaneously those separated by @xmath126 have opposite phases and equal intensities ( a doubly antiphase multiplet ) .",
    "multiplication of a product operator term by @xmath127 corresponds to a phase shift of @xmath91 for the corresponding multiplet . now consider the case where",
    "one or more of the scalar couplings is small in comparison with the linewidths .",
    "suppose , for example , that @xmath44 is small relative to the linewidths for spin @xmath28 .",
    "it follows that the spin @xmath28 multiplet s constituent lines which would otherwise be separated by @xmath44 will overlap .",
    "the resulting lineshapes can be predicted by adding two appropriately overlapping lorentzian lines . in the case of lines of opposite phase separated by @xmath44 partial cancellation",
    "will result . in the extreme case ,",
    "@xmath128 , the cancellation is complete and these lines disappear .",
    "thus the multiplet arising from any product operator term containing a factor of @xmath129 disappears if @xmath128 .",
    "the quantum logic for this algorithm demands that for each qubit is coupled to at least one other qubit with a scalar coupling much larger than any relaxation rates ( and hence linewidths ) . for a three qubit molecule",
    "this implies that only one scalar coupling term can be negligible . in this case table  [",
    "tab : foutput ] indicates that at for @xmath130 to @xmath39 at least one antiphase or doubly antiphase multiplet survives .",
    "for @xmath131 to @xmath132 the multiplet for spin @xmath5 survives but its lines are all out of phase with those of the fiducial spectrum . for @xmath133 to @xmath40",
    "the same applies to spin @xmath134 .",
    "similar results apply for other representatives of the function categories but with the qubits permuted appropriately . on the other hand",
    "the spectrum for the constant functions is identical to the fiducial spectrum .",
    "thus we arrive at an algorithm answer criterion for applicable functions :    \\(i ) _ @xmath8 is constant if and only if the @xmath8-spectrum is identical to the fiducial spectrum and _",
    "\\(ii ) _ @xmath8 is balanced if and only if there is a @xmath135 phase difference between at least one line of the @xmath8-spectrum and its counterpart in the fiducial spectrum .",
    "_    the fiducial spectrum can be phased ( effectively adjusting the acquisition phase ) so that its constituent lines all appear upright .",
    "thus , the answer to the @xmath0 deutsch problem may be determined by inspecting the @xmath8-spectrum for inverted lines .",
    "each balanced function produces at least one inversion . for constant functions all lines are upright",
    "this provides a solution state nmr scheme for conclusively answering the @xmath0 deutsch problem with just one application of the evolution stage to the thermal equilibrium input state .",
    "a saturated solution of @xmath1 labeled alanine in @xmath136 provided the qubits ( see fig .",
    "[ pic : alanine ] ) .",
    "we denote the carboxyl carbon , qubit @xmath134 , the @xmath137 carbon , 1 and the methyl carbon , @xmath5 .",
    "protons were decoupled using a standard heteronuclear decoupling technique .",
    "scalar couplings are @xmath138hz , @xmath139hz and @xmath140hz . for @xmath141 ,",
    "the linewidth is comparable to the relevant interpeak splitting and thus the coupling strength differs from the interpeak distance .",
    "however , the swap method of gate construction allows for a creation of an antiphase doublet between these peaks without any prior knowledge of @xmath141 , giving an accurate method for calculating its value ( see appendix a ) .",
    "the @xmath142 relaxation times were determined via an inversion relaxation sequence and @xmath143 s by a single spin echo .",
    "results are @xmath144s , @xmath145s , @xmath146s , @xmath147s , @xmath148s , and @xmath149s where the argument labels the qubit .",
    "quadratic term gates between the pair of qubits 1 and 2 or the pair 0 and 1 can be implemented using the directly coupled realization , eq .",
    "( [ eq : quseq ] ) . here",
    "the refocusing scheme of eq .",
    "( [ eq : refoc_seq ] ) suggests @xmath150   =                   \\left [ 1/4j_{21 } \\right]^{\\mbox{\\scriptsize tot } }                - \\left [ 180^\\circ \\right]^0_{n }                - \\left [ 1/4j_{21 } \\right]^{\\mbox{\\scriptsize tot } }                - \\left [ 180^\\circ \\right]^0_{n }                - \\left [ 90^\\circ \\right]^1_{-z }                - \\left [ 90^\\circ \\right]^2_{-z }   \\label{eq : u21seq}\\ ] ] and @xmath151   =                    \\left [ 1/4j_{10 } \\right]^{\\mbox{\\scriptsize tot } }                - \\left [ 180^\\circ \\right]^2_{n }                - \\left [ 1/4j_{10 } \\right]^{\\mbox{\\scriptsize tot } }                - \\left [ 180^\\circ \\right]^2_{n }                 - \\left [ 90^\\circ \\right]^0_{-z }                - \\left [ 90^\\circ \\right]^1_{-z}\\ ] ] where @xmath152 represents any axis in the @xmath64 plane . note that in each of these sequences the refocusing scheme eliminates the coupling between qubits 0 and 2 .",
    "unfortunately , for @xmath153 , which is required for @xmath38 and @xmath39 , the directly coupled realization is inadequate since @xmath154s which is comparable to the smallest @xmath143 .",
    "however , one of the indirectly coupled realizations illustrated in fig .",
    "[ pic : quad_ind ] or fig .  [ pic : quad_cnot ] , where @xmath155 and @xmath156 , provides a construction which requires additional pulses but is sufficiently faster .",
    "the approach based on swapping to a controlled - not gate ( see fig .  [",
    "pic : quad_cnot ] ) is preferable despite the fact that it appears to require more pulses than that based on swapping to a scalar coupling gate .",
    "the reason is that the initial rotation of the algorithm ( see fig .",
    "[ pic : djscheme ] ) may be chosen with @xmath157 .",
    "then the first two rotations on spins 1 and 0 cancel , leaving the scalar coupling term between 0 and 1 as the initial operation on these qubits ( see fig .  [",
    "pic : quad_cnot ] ) .",
    "however , these are initially in thermal equilibrium and this operation has no effect and may be omitted .",
    "the resulting pulse sequence has duration @xmath158ms , which is significantly faster than the direct version using @xmath159^{20}$ ] , and comfortably within the shortest relaxation time .",
    "the pulse sequence compiles to @xmath160 & = &   \\left [ 90^\\circ \\right]^0_{x } - \\left [ 90^\\circ \\right]^1_{x } -   \\left [ 1/2j_{10 } \\right]^{10 } - \\left [ 90^\\circ \\right]^1_{y } -   \\left [ 1/2j_{21 } \\right]^{21 } -    \\nonumber \\\\ & &    \\left [ 90^\\circ \\right]^1_{x } -   \\left [ 1/2j_{10 } \\right]^{10 } - \\left [ 90^\\circ \\right]^1_{y } -   \\left [ 90^\\circ \\right]^0_{x } - \\left [ 1/2j_{10 } \\right]^{10 } -    \\nonumber \\\\ & &    \\left [ 90^\\circ \\right]^1_{x } -    \\left [ 90^\\circ \\right]^0_{-y } -    \\left [ 90^\\circ \\right]^2_{z } - \\left [ 90^\\circ \\right]^1_{-z }   \\label{eq : f9seq }   \\end{aligned}\\ ] ] where @xmath161^{21 }   =                   \\left [ 1/4j_{21 } \\right]^{\\mbox{\\scriptsize tot } }                - \\left [ 180^\\circ \\right]^0_{n }                - \\left [ 1/4j_{21 } \\right]^{\\mbox{\\scriptsize tot } }                - \\left [ 180^\\circ \\right]^0_{n }   \\label{eq : realrefoc1}\\ ] ] and @xmath162^{10 }   =                    \\left [ 1/4j_{10 } \\right]^{\\mbox{\\scriptsize tot } }                - \\left [ 180^\\circ \\right]^2_{n }                - \\left [ 1/4j_{10 } \\right]^{\\mbox{\\scriptsize tot } }                - \\left [ 180^\\circ \\right]^2_{n}.    \\label{eq : realrefoc2}\\ ] ] again",
    "the refocusing schemes eliminate the coupling between qubits @xmath5 and @xmath134 .",
    "thus , only the linear coupling chain @xmath163 is used to carry out the algorithm s evolution stage ; for all admissible functions the value of @xmath141 is irrelevant during this step .",
    "the pulse sequences for @xmath38 are obtained by concatenating those of eqs .",
    "( [ eq : u21seq ] )  -  ( [ eq : f9seq ] ) .",
    "the experiments were performed at room temperature using a bruker 500-drx spectrometer and an inverse detection probe .",
    "the bulk of the experimental effort was devoted to constructing @xmath164 $ ] according to eq .",
    "( [ eq : f9seq ] ) and consequently to implementing the algorithm for @xmath38 and @xmath39 .    all realizations required qubit selective @xmath63 rotations and",
    "most also used selective @xmath91 rotations for refocusing .",
    "shaped gaussian pulses with @xmath165 truncation and durations of @xmath166ms for qubits 0 and 1 and duration @xmath167ms for qubit 2 gave sufficient selectivity .",
    "no hard pulses were used .",
    "the power parameters for selective rotations were found by applying the selective pulse to the thermal equilibrium state followed by signal acquisition ; this procedure was repeated , starting at a low power and increasing this with each application .",
    "the resulting acquired signals with maximal and minimal intensities correspond to @xmath63 and @xmath91 rotations .",
    "the effectiveness of the resulting @xmath63 rotation can be examined partially by applying the following sequence to the thermal equilibrium state :    @xmath168^i_{\\bf \\hat{y } } - \\mbox{delay } t -   \\left[90^\\circ \\right]^i_{\\cos{\\theta}{\\bf \\hat{x } }                            + \\sin{\\theta}{\\bf\\hat{y } } } - \\mbox{acquire }   \\label{eq : rottrot}\\ ] ]    where @xmath109 is small enough to neglect any scalar coupling effects . for a rotation through",
    "exactly @xmath63 the acquired signal s intensity is proportional to @xmath169 where @xmath170 is the offset relative to the receiver frequency .",
    "furthermore , if the axis of the second rotation compared to that of the receiver remains constant as @xmath109 varies , then the phase of the acquired spectrum should remain constant .",
    "we found that this was resulting signal dependence on @xmath109 , particularly in the region where the signal intensity approaches a minimum , is fairly sensitive to variations in the pulse power .",
    "we used this to perform fine adjustments to the power levels for @xmath63 pulses .",
    "construction of the real pulse sequence corresponding to eq .",
    "( [ eq : f9seq ] ) is accomplished by supplying the correct parameters for the active section of the pulse sequence ( such as pulse phases and duration of delays ) followed by computation of the correct passive section parameters .",
    "the division of the pulse sequence into active and passive parts is reflected in the different techniques required for realizing the correct operations .",
    "the passive section of the algorithm s pulse sequence ( see eq .",
    "( [ eq : passive ] ) ) , is implemented by adjusting qubit - dependent phase shifts after signal acquisition . for the fiducial case and any @xmath8 the passive section parameter contains absolute phase information ( unlike the relative rotation axes of the active section ) given by the algorithm and assorted corrections which arise from zeeman evolution during the active section .",
    "however , the fact that the algorithm answer criterion is based on comparing @xmath8-spectra line phases to those in the fiducial spectrum means that for any @xmath8 only @xmath171 are important where @xmath172 are the passive section parameters for @xmath8 and @xmath173 those for the fiducial case .",
    "such relative values are determined by the algorithm and are independent of the acquisition phase and choice of the arbitrary initial rotation phases ( provided that these remain constant for all admissible functions and the fiducial case ) .",
    "it follows that an acceptable procedure is to begin by acquiring the fiducial spectrum , phase this to give upright absorption - mode multiplets and save the resulting post - acquisition phase shifts .",
    "then , for any @xmath8 , the active section of the algorithm pulse sequence is applied followed by post - acquisition phase shifts , @xmath174 , added to the values stored after processing of the fiducial spectrum .",
    "the resulting output spectra will be phased in accordance with those of fig .",
    "[ pic : multiplets ] .      the active section of the algorithm ( see eq .",
    "( [ eq : active ] ) ) is implemented by applying a sequence of spin selective gaussian shaped pulses with the appropriate rotation axes and refocused delays of the appropriate durations .",
    "these parameters are derived from the corresponding algorithm sequence ; for example , those for @xmath38 are derived from eq .",
    "( [ eq : f9seq ] ) .",
    "applying a pulse program with rotation axes and delays taken literally from eq .",
    "( [ eq : f9seq ] ) is unsatisfactory because this would ignore effects such as the ongoing zeeman evolution discussed earlier .",
    "in fact , the bulk of the effort is devoted to tuning these parameters correctly .",
    "axes of rotation are determined by pulse phases , which can be specified with a resolution of @xmath175 on the bruker equipment . in general",
    "it is not straightforward to associate spectrometer phases with absolute rotation axes such as those required by eq .",
    "( [ eq : f9seq ] ) .",
    "however , eq .  ( [ eq : ipulses3 ] ) shows that it is only the relative axes and hence relative pulse phases which are important .",
    "the primary difficulty in adjusting these relative phases correctly arises from evolution under the zeeman terms during pulse applications and delays .",
    "there are three cases :    * zeeman evolution during delays , * zeeman evolution experienced by spectator qubits during application of any selective pulse and * zeeman evolution experienced by the rotated qubit during a selective pulse .    during a delay of duration @xmath51",
    "the zeeman terms produce qubit - dependent rotations about @xmath60 through angles @xmath176 where @xmath177 is the offset frequency of qubit @xmath28 .",
    "this is corrected by re - expressing the idealized delay term as @xmath178^{\\mbox{\\scriptsize tot } }     = \\left [ t \\right]^{\\mbox{\\scriptsize tot } }     - \\left [ 2 \\pi \\nu^2 t \\right]^2_z     - \\left [ 2 \\pi \\nu^1 t \\right]^1_z     - \\left [ 2 \\pi \\nu^0 t \\right]^0_z     - \\left [ -2 \\pi \\nu^1 t\\right]^2_z     - \\left [ -2 \\pi \\nu^0 t   \\right]^1_z     - \\left [ -2 \\pi \\nu^0 t \\right]^0_z\\ ] ] and noting that if the zeeman terms are correctly included then the spectrometer actually implements @xmath54^{\\mbox{\\scriptsize tot}}-\\left [ 2 \\pi \\nu^2 t \\right]^2_z - \\left [ 2 \\pi \\nu^1 t \\right]^1_z - \\left [ 2 \\pi \\nu^0 t \\right]^0_z.$ ] the corrections @xmath179 ^ 2_z - \\left [ -2 \\pi \\nu^1 t \\right]^1_z - \\left [ -2 \\pi \\nu^0 t \\right]^0_z$ ] are then rearranged according to the compilation scheme with the result that for qubit @xmath28 the axes of rotation of succeeding rotations must be shifted through @xmath180 and the final phase shift must be altered according to @xmath181    during a selective pulse of duration @xmath51 to any qubit the same rules apply to spectator qubits . the remaining complication is the effect of zeeman terms on the qubit to which the selective pulse is applied .",
    "these can be calculated analytically for rectangularly shaped pulses by passing to a rotating frame ; the results are similar to those for delays  @xcite . however , to the best of our knowledge , no such comparable result exists for gaussian shaped pulses .",
    "our approach is to adjust the phases experimentally by considering the form of the spectrum acquired after each spin selective rotation .",
    "this sometimes requires readout pulses , judiciously selected to reveal key features of the density operator without going to the extreme of complete state tomography .",
    "this technique depends on a complete knowledge of the density operator prior to acquisition . although this is not satisfactory for general purpose quantum computation , it is sufficient to demonstrate the essential dynamics",
    ". furthermore it should be possible to simulate the exact effects of simultaneously zeeman evolution and rotation under gaussian shaped pulses .    in principle ,",
    "evolution under the scalar coupling terms also provides erroneous effects during the pulse sequence .",
    "fortunately , the @xmath182^{ij}$ ] delays are exempt from such errors since these are designed to utilize these couplings .",
    "it remains to assess the effects during @xmath183s delays between selective pulses ( required by the spectrometer for switching purposes ) and during the selective pulses .",
    "the extent of such evolution can be estimated crudely by comparing @xmath51 to @xmath184 , which represents the `` maximum '' evolution under the relevant scalar coupling .",
    "thus a crude measure of the fractional error is @xmath185 where @xmath51 is the duration of the delay or pulse . for a @xmath183s delay this yield at most @xmath186 and for the @xmath187ms pulses and the strongest coupling , @xmath188 thus to a fair approximation",
    "the scalar coupling terms can be neglected during selective pulses .",
    "the remaining experimental issue is to construct the refocused delays of eqs .",
    "( [ eq : realrefoc1 ] ) and  ( [ eq : realrefoc2 ] ) .",
    "the durations were determined experimentally by comparing the signal acquired after the delay to that calculated theoretically . for @xmath189^{\\mbox{\\scriptsize tot}}$ ] the optimal delay was found to be @xmath190ms and for @xmath191^{\\mbox{\\scriptsize tot}}$ ] it was @xmath192ms .",
    "the respective theoretical values were @xmath193ms and @xmath194ms .",
    "the discrepancies can only be partially explained by coupling evolution during the @xmath195ms required for the refocusing pulses . in principle , the phases of the two @xmath91 pulses within any refocused delay relative to those elsewhere in the pulse sequence are unimportant ; only the relative phases of the two matter .",
    "these were again determined experimentally by the general process described for the selective pulses .",
    "an additional improvement is attained by adding the results of two experiments in which the sequences are identical except that in the second the axes of the refocusing pulses were both offset by @xmath91 .",
    "this is done using the spectrometer s phase cycling routines . in theory",
    "the pulse sequences are identical ; in practice the refocusing appears to be more accurate using this scheme .",
    "= 3.375 in    for each representative function listed in table  [ tab : foutput ] signal acquisition takes place immediately after implementation of @xmath15 .",
    "figure  [ pic : output ] provides selected experimental spectra that are phased so that @xmath196 product operator terms correspond to upright multiplets . in general",
    "it is necessary to adjust the post - acquisition phase for each multiplet .",
    "the bruker-500 spectrometer allows only two adjustments , a constant and linear phase shift , per processed spectrum .",
    "the entire spectrum can be displayed with the correct phases by inserting , immediately before acquisition , a qubit selective @xmath91 rotation about the appropriate axis in the @xmath64 plane for the remaining multiplet .",
    "if the axis of rotation is chosen correctly relative to the density operator terms for the qubit then it has the same effect as a qubit - dependent phase shift .",
    "this requires knowledge of the final density operator and is not useful for general purpose quantum computation . in our experiment",
    "it is merely used for convenient display of the @xmath8-spectra .",
    "the arrangements of in - phase , antiphase and doubly antiphase multiplets agree with those predicted from @xmath197 , indicating that the correct dynamical evolution for the algorithm had been implemented .",
    "an interesting feature is that the doubly antiphase multiplets for qubits 0 and 2 are well resolved in the @xmath38 and @xmath39 cases ( see fig .",
    "[ pic : output](e ) ) . for qubit 2",
    "the small @xmath141 as well as the larger @xmath198 splitting are clearly discernable . similarly for qubit @xmath5 .",
    "the improvement in resolution of the @xmath141 splitting in comparison to the inphase case stems from the fact that the resolution of an antiphase doublet is always better than that of an inphase doublet whenever the linewidth is comparable to the splitting ( see appendix a ) .",
    "it follows that this indirectly coupled gate realization offers a method for determining the values of small couplings .",
    "an estimate of errors for the most complicated case , @xmath38 , may be obtained by applying a selective @xmath63 readout pulse about the @xmath199 axis immediately after @xmath15 .",
    "ideally the readout spin multiplet should remain while the others disappear .",
    "the average amplitudes of the residual signals for the latter lie between @xmath200 and @xmath201 of the average amplitude of the corresponding lines with no readout .",
    "the ability to extract the deutsch problem solution for @xmath202 via pure phase information in the output spectrum , in contrast to amplitude information , has clearly mitigated such errors .",
    "the most likely source of error are imperfections in the selective rotations . the most complicated case , @xmath38 , required eight selective @xmath63 rotations , during each of which possible effects of scalar coupling evolution during application were ignored . indeed , for the indirectly coupled realization of @xmath203 the total duration of all eight selective rotations , @xmath204ms , is @xmath205 of @xmath206ms",
    "to the best of our knowledge there is no satisfactory analytical understanding of the effects of coupling dynamics during selective pulses . at the very least such effects",
    "need to be modeled in terms of typical quantum information processing operations and must be applicable to shaped selective pulses .",
    "this work was supported , in part , by the darpa and the onr .",
    "we would also like to thank gary sanders for useful discussion .",
    "lineshapes are predicted via @xmath207 and @xmath208 magnetization components , which are solutions of the bloch equations ,  @xcite @xmath209 where @xmath210 is the offset from the resonance frequency , @xmath211 where @xmath212 is the perturbing field strength , @xmath213 the magnetization after relaxation and @xmath142 and @xmath143 are the relaxation times . for weak perturbations @xmath214 @xmath215 where @xmath216 is the maximum amplitude attained by either magnetization and @xmath217 is the half width of @xmath218 . by setting @xmath219 and @xmath220",
    "then @xmath221 describe the lineshapes in frequency units of @xmath222 and magnetization units of @xmath223 .",
    "suppose that two lines with resonance ( angular ) frequencies separated by @xmath224 are superimposed . in units of linewidth",
    "the separation is @xmath225 thus an _ inphase doublet in absorption mode _ is described by @xmath226 it is straightforward to show that this has three distinct extrema whenever @xmath227 and only one when @xmath228 . in the former case two maxima ( peaks ) of height @xmath229",
    "are separated by @xmath230 and are equidistant from a minimum ( interpeak trough ) of height @xmath231 . in the latter case",
    "the two formerly distinct peaks collapse into a single peak of height @xmath231 .    on the other hand an _ antiphase doublet in absorption mode _",
    "is described by @xmath232 for all @xmath233 this has two extrema ; a maximum and minimum of equal amplitude and which are separated by @xmath234 thus for @xmath235 the two peaks of the antiphase doublets will , in principle , always be distinct whereas those of the inphase doublet always collapse into a single peak .",
    "it may seem that this would provide a method for determining @xmath236 based on the peak separation . however , unless @xmath237 is known , this is impossible as eq .",
    "( [ eq : antisep ] ) only applies when the separation is given in units of linewidth and the spectrometer only supplies such measurements in units of hz . nor",
    "would it be possible to extract such information from the peak heights as these require @xmath223 , another typically unknown variable .",
    "a convenient way around these difficulties is to phase the antiphase doublet so that the lines are in _",
    "dispersion mode_. here the spectrum is described by @xmath238 the number and arrangement of extrema depends on @xmath239 but for @xmath240 , which is the region of most interest , there are two maxima of equal intensity equally spaced from a single minimum .",
    "the maxima and minima are @xmath241 the two roots of @xmath73 are situated between the maxima and are separated by @xmath242 the two maxima , which are easily identifiable , are separated by @xmath243 the ratio @xmath244 is independent of the units in which the peak amplitudes are measured and can be determined from the spectrometer output .",
    "inversion of eq .",
    "( [ eq : ampratio ] ) equation yields @xmath239 .",
    "then , eq .  ( [ eq : maxsplit ] ) gives @xmath245 ( in units of linewidth ) .",
    "this is related to the value determined from the output spectrum ( in units of hz ) by a factor of @xmath246 .",
    "this gives the linewidth , @xmath246 , which together with @xmath239 gives @xmath236 .",
    "it is important to note that all that this method requires is the ability to create an antiphase doublet . for weak scalar couplings it is possible to do this without any knowledge of @xmath236 provided that a network of strong couplings connects the relevant spins"
  ],
  "abstract_text": [
    "<S> a detailed description of the development of a three qubit nmr realization of the deutsch - jozsa algorithm [ collins et.al . , phys.rev .  </S>",
    "<S> a * 62 * 022304 ( 2000 ) ] is provided . </S>",
    "<S> the theoretical and experimental techniques used for the reduction of the algorithm s evolution steps into a sequence of nmr pulses are discussed at length . </S>",
    "<S> this includes the description of general pulse sequence compilation techniques , various schemes for indirectly coupled gate realizations , experimental pulse parameterization techniques and bookkeeping methods for pulse phases .    </S>"
  ]
}