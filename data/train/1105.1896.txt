{
  "article_text": [
    "in markov chain monte carlo ( mcmc ) , one simulates a markov chain and uses sample averages to estimate corresponding means of the stationary distribution of the chain .",
    "mcmc has become a staple tool in the physical sciences and in bayesian statistics . when sampling the markov chain , the transitions are driven by a stream of independent @xmath0 random numbers .",
    "in this paper , we study what happens when the i.i.d .",
    "@xmath0 random numbers are replaced by deterministic sequences , or by some dependent @xmath0 values . the motivation for replacing i.i.d .",
    "@xmath0 points is that carefully stratified inputs may lead to more accurate sample averages .",
    "one must be cautious though , because as with adaptive mcmc @xcite , the resulting simulated points do not have the markov property .",
    "the utmost in stratification is provided by quasi - monte carlo ( qmc ) points .",
    "there were a couple of attempts at merging qmc into mcmc around 1970 , and then again starting in the late 1990s .",
    "it is only recently that significant improvements have been reported in numerical investigations .",
    "for example , tribble @xcite reports variance reductions of several thousand fold and an apparent improved convergence rate for some gibbs sampling problems .",
    "those results motivate our theoretical work .",
    "they are described more fully in the literature survey below .    to describe our contribution ,",
    "represent mcmc sampling via @xmath1 for @xmath2 , where @xmath3 is a nonrandom starting point and @xmath4 .",
    "the points @xmath5 belong to a state space @xmath6 .",
    "the function @xmath7 is chosen so that @xmath5 form an ergodic markov chain with the desired stationary distribution @xmath8 when @xmath9 independently . for a bounded continuous function @xmath10 ,",
    "let @xmath11 and @xmath12 .",
    "then @xmath13 as @xmath14 . in this paper , we supply sufficient conditions on @xmath7 and on the deterministic sequences @xmath15 so that @xmath16 holds when those deterministic sequences are used instead of random ones .",
    "the main condition is that the components of @xmath15 be taken from a completely uniformly distributed ( cud ) sequence , as described below .",
    "ours are the first results to prove that deterministic sampling applied to mcmc problems on continuous state spaces is consistent . in practice",
    ", of course , floating point computations take place on a large discrete state space . but invoking finite precision does not provide a satisfying description of continuous mcmc problems . in a finite state space argument ,",
    "the resulting state spaces are so big that vanishingly few states will ever be visited in a given simulation .",
    "then if one switches from @xmath17 to @xmath18 to @xmath19 bit representations , the problem seemingly requires vastly larger sample sizes , but in reality is not materially more difficult .    to avoid using the finite state shortcut ,",
    "we adopt a computational model with infinite precision . as a side benefit ,",
    "this paper shows that the standard practice of replacing genuine i.i.d .",
    "values @xmath15 by deterministic pseudo - random numbers is consistent for some problems with continuous state spaces .",
    "we do not think many people doubted this , but neither has it been established before , to our knowledge .",
    "it is already known from roberts , rosenthal and schwartz @xcite that , under certain conditions , a geometrically ergodic markov chain remains so under small perturbations , such as rounding . that work does not address the replacement of random points by deterministic ones that we make here .",
    "there have been a small number of prior attempts to apply qmc sampling to mcmc problems .",
    "the first appears to have been chentsov @xcite , whose work appeared in 1967 , followed by sobol  @xcite in 1974 .",
    "both papers assume that the markov chain has a discrete state space and that the transitions are sampled by inversion .",
    "unfortunately , qmc does not usually bring large performance improvements on such unsmooth problems and inversion is not a very convenient method .",
    "chentsov replaces i.i.d .",
    "samples by one long cud sequence , and this is the method we will explain and then adapt to continuous problems .",
    "sobol uses what is conceptually an @xmath20 matrix of values from the unit interval .",
    "each row is used to make transitions until the chain returns to its starting state .",
    "then the sampling starts using the next row .",
    "it is like deterministic regenerative sampling .",
    "sobol shows that the error converges as @xmath21 in the very special case where the transition probabilities are all rational numbers with denominator a power of @xmath22 .",
    "these methods were not widely cited and , until recently , were almost forgotten , probably due to the difficulty of gaining large improvements in discrete problems , and the computational awkwardness of inversion as a transition mechanism for discrete state spaces .",
    "the next attempt that we found is that of liao @xcite in 1998 .",
    "liao takes a  set of qmc points in @xmath23^d$ ] shuffles them in random order , and uses them to drive an mcmc .",
    "he reports 4- to 25-fold efficiency improvements , but gives no theory .",
    "an analysis of liao s method is given in @xcite .",
    "later , chaudary  @xcite tried a different strategy using qmc to generate balanced proposals for metropolis ",
    "hastings sampling , but found only small improvements and did not publish the work .",
    "craiu and lemieux @xcite also consider multiple - try metropolis and find variance reductions of up to @xmath24% , which is still modest .",
    "earlier , lemieux and sidorsky @xcite report variance reduction factors ranging from about @xmath25 to about @xmath26 in some work using qmc in conjunction with the perfect sampling method of propp and wilson @xcite .    only recently have there been significantly large benefits from the combination of qmc and mcmc .",
    "those benefits have mainly arisen for problems on continuous state spaces .",
    "@xcite best results come from gibbs sampling problems computing posterior means . for problems with @xmath27 parameters",
    ", he used every @xmath27-tuple from a small custom built linear feedback shift register ( lfsr ) .",
    "one example is the well - known model used by gelfand and smith @xcite for failure events of @xmath28 pumps from the article by gaver and omurcheartaigh @xcite .",
    "there are @xmath29 unknown parameters , one for each pump and one for the scale parameter in the distribution of pump failure rates .",
    "a second example is a @xmath30 parameter probit model for vasorestriction based on a famous data set from @xcite and analyzed using latent variables as in albert and chib @xcite . of those @xmath30 parameters , the @xmath31 regression coefficients are of greatest interest and @xmath32 latent variables",
    "are nuisance variables .",
    "table [ tab : tribbles ] sets out variance reduction factors found for randomized cud versus i.i.d .   sampling .",
    "the improvements appear to grow with @xmath33 , and are evident at very small sample sizes .",
    "@ld3.0d4.0d3.0d4.0d4.0d5.0@ & & & + & & & + * data * & & & & & & + pumps & 286 & 1543 & 304 & 5003 & 1186 & 16089 + vasorestriction & 14 & 15 & 56 & 76 & 108 & 124 +    there is another line of research in which large improvements have been obtained by combining qmc with mcmc .",
    "this is the array - rqmc method described in lecuyer , lecot and tuffin @xcite and other articles .",
    "that method simulates numerous chains in parallel using quasi - monte carlo to update all the chains .",
    "it requires a complicated method to match the update variables for each step to the various evolving chains .",
    "this method has achieved variance reductions of many thousand fold on some problems from queuing and finance .",
    "very few properties have been established for it , beyond the case of heat particles in one dimension that was considered by morokoff and caflisch  @xcite .    finally , jim propp s rotor - router method is a form of deterministic markov chain sampling .",
    "it has brought large efficiency improvements for some problems on a discrete state space and has been shown to converge at better than the monte carlo rate on some problems .",
    "see , for example , doerr and friedrich @xcite .",
    "the use of cud sequences that we study has one practical advantage compared to the rotor - router , array - rqmc , regenerative sampling , and the other methods .",
    "it only requires replacing the i.i.d .   sequence used in a typical mcmc run by some other list of numbers .",
    "the paper is organized around our main results which appear in section [ sec : consistency ] .",
    "theorem [ thm : withhomecouple ] gives sufficient conditions for consistency of qmc - mcmc sampling by metropolis ",
    "theorem [ thm : ifmalsfuh ] gives sufficient conditions for consistency of qmc - mcmc sampling for the systematic scan gibbs sampler .",
    "section [ sec : background ] contains necessary background and notation for the two main theorems of section [ sec : consistency ] .",
    "it introduces quasi - monte carlo and markov chain monte carlo giving key definitions we need in each case .",
    "that section presents the rosenblatt  chentsov transformation .",
    "we have combined a classic sequential inversion method based on the rosenblatt transformation with an elegant coupling argument that chentsov @xcite used .",
    "the consistency results for metropolis  hastings ( theorem [ thm : withhomecouple ] ) make moderately strong assumptions in order to ensure that a coupling occurs .",
    "section  [ sec : homeandcouple ] shows that those assumptions are satisfied by some metropolized independence samplers and also by some slice samplers .",
    "we also assumed some riemann integrability properties for our mcmc proposals .",
    "the riemann integral is awkward compared to the lebesgue integral , but considering it is necessary when we want to study specific algorithms on deterministic inputs .",
    "section [ sec : riemaninteg ] gives sufficient conditions for an mcmc algorithm to satisfy the required riemann integrability conditions .",
    "our consistency results for the gibbs sampler ( theorem [ thm : ifmalsfuh ] ) require some contraction properties and some jordan measurability .",
    "section [ sec : gibbsexample ] shows that these properties hold under reasonable conditions .",
    "section [ sec : openclose ] has a brief discussion on open versus closed intervals for uniform random numbers .",
    "our conclusions are in section [ sec : conclusions ] .",
    "the lengthier or more technical proofs are placed in the .",
    "our random vectors are denoted by @xmath34 for @xmath35 .",
    "points in the unit cube @xmath23^d$ ] are denoted by @xmath36 .",
    "two points @xmath37 with @xmath38 for @xmath39 define a rectangle @xmath40 $ ] , denoted by @xmath41 $ ] for short .",
    "the indicator ( or characteristic ) function of a set @xmath42 is written @xmath43 .",
    "we assume the reader is familiar with the definition of the ( proper ) riemann integral , for a bounded function on a finite rectangle @xmath41\\subset{\\mathbb{r}}^d$ ] .",
    "the bounded set @xmath42 is jordan measurable if @xmath43 is riemann integrable on a  bounded rectangle containing @xmath44 . by lebesgue s theorem ( see section [ sec : riemaninteg ] )  @xmath44 is jordan measurable if @xmath45 . here",
    "@xmath46 denotes lebesgue measure on @xmath47 , and @xmath48 is the boundary of @xmath44 , that is , the set on which @xmath43 is discontinuous .      here , we give a short summary of quasi - monte carlo .",
    "further information may be found in the monograph by niedereiter  @xcite .",
    "qmc is ordinarily used to approximate integrals over the unit cube @xmath23^d$ ] , for @xmath49 .",
    "let @xmath50^d$ ] . the qmc estimate of @xmath51^d } f({\\mathbf{x}})\\,{{d}}{\\mathbf{x}}$ ] is @xmath52 , just as we would use in plain monte carlo .",
    "the difference is that in qmc , distinct points @xmath5 are chosen deterministically to make the discrete probability distribution with an atom of size @xmath53 at each @xmath5 close to the continuous @xmath54^d$ ] distribution .    the distance between these distributions is quantified by discrepancy measures .",
    "the local discrepancy of @xmath55 at @xmath56^d$ ] is @xmath57 the star discrepancy of @xmath55 in dimension @xmath27 is @xmath58^d}}|\\delta({\\mathbf{a}};{\\mathbf{x}}_1,\\ldots,{\\mathbf{x}}_n)|.\\ ] ] for @xmath59 , the star discrepancy reduces to the kolmogorov  smirnov distance between a discrete and a continuous uniform distribution .",
    "a uniformly distributed sequence is one for which @xmath60 as @xmath14 .",
    "if @xmath5 are uniformly distributed then @xmath61 provided that @xmath62 is riemann integrable .    under stronger conditions than riemann integrability",
    ", we can get rates of convergence for qmc .",
    "the koksma  hlawka inequality is @xmath63 is the total variation of @xmath62 in the sense of hardy and krause . for properties of @xmath64 and other multidimensional variation measures ,",
    "see @xcite .    equation ( [ eq : khbound ] ) gives a deterministic upper bound on the integration error , and it factors into a measure of the points quality and a measure of the integrand s roughness .",
    "there exist constructions @xmath55 where @xmath65 holds for any @xmath66 .",
    "therefore , functions of finite variation can be integrated at a much better rate by qmc than by mc .",
    "rates of convergence of @xmath67 , where @xmath68 denotes the smoothness of the integrand which can therefore be arbitrarily large , can also be achieved  @xcite .",
    "equation ( [ eq : khbound ] ) is not usable for error estimation .",
    "computing the star discrepancy is very difficult @xcite , and computing @xmath69 is harder than integrating @xmath62 .",
    "practical error estimates for qmc may be obtained using randomized quasi - monte carlo ( rqmc ) . in rqmc each @xmath70^d$ ] individually while the ensemble @xmath55 has @xmath71 for some @xmath72 . for an example , see @xcite .",
    "a small number of independent replicates of the rqmc estimate can be used to get an error estimate .",
    "rqmc has the further benefit of making qmc unbiased . for a survey of rqmc ,",
    "see @xcite .",
    "a key distinction between qmc and mc is that the former is effective for riemann integrable functions , while the latter , in principle , works for lebesgue integrable functions . in practice",
    ", mc is usually implemented with deterministic pseudo - random numbers .",
    "the best generators are proved to simulate independent @xmath54 $ ] random variables based on either discrepancy measures over rectangles or on spectral measures .",
    "those conditions are enough to prove convergence for averages of riemann integrable functions , but not for lebesgue integrable functions . as a result ,",
    "ordinary monte carlo with pseudo - random numbers is also problematic for lebesgue integrable functions that are not riemann integrable .      in the markov chain context",
    ", we need a lesser known qmc concept as follows .",
    "a sequence @xmath73 $ ] is completely uniformly distributed ( cud ) if for any @xmath74 the points @xmath75 satisfy @xmath76 as @xmath14 .",
    "this is one of the definitions of a random sequence from knuth @xcite , and it is an important property for modern random number generators .    using a cud sequence in an mcmc is akin to using up the entire period of a random number generator , as remarked by niederreiter @xcite in 1986 .",
    "it is then necessary to use a small random number generator .",
    "the cud sequences used by tribble @xcite are miniature versions of linear congruential generators and feedback shift register generators . as such ,",
    "they are no slower than ordinary pseudo - random numbers .    in the qmc context",
    ", we need to consider nonoverlapping @xmath27-tuples @xmath77 for @xmath78 .",
    "it is known @xcite that @xmath79      in the qmc context , the function @xmath62 subsumes all the necessary transformations to turn a finite list of i.i.d .",
    "@xmath54 $ ] random variables into the desired nonuniformly distributed quantities , as well as the function of those quantities whose expectation we seek . in some problems",
    ", we are unable to find such transformations , and so we turn to mcmc methods .",
    "suppose that we want to sample @xmath80 for a density function @xmath8 defined with respect to lebesgue measure on @xmath81 . for definiteness , we will seek to approximate @xmath82 . in this section ,",
    "we briefly present mcmc . for a full description of mcmc , see the monographs by liu @xcite or robert and casella @xcite .    in an mcmc simulation ,",
    "we choose an arbitrary @xmath83 with @xmath84 and then for @xmath78 update via @xmath85 where @xmath86^d$ ] and @xmath7 is an update function described below .",
    "the distribution of @xmath5 depends on @xmath87 only through @xmath88 and so these random variables have the markov property . the function @xmath7 is chosen so that the stationary distribution of @xmath5 is @xmath8",
    ". then we estimate @xmath89 by @xmath90 as before . if a burn - in period was used , we assume that @xmath3 is the last point of it .",
    "first , we describe the metropolis ",
    "hastings algorithm for computing @xmath91 from the current point @xmath92 and @xmath93^d$ ] .",
    "it begins with a proposal @xmath94 taken from a transition kernel @xmath95 . with genuinely random proposals ,",
    "the transition kernel gives a complete description .",
    "but for either quasi - monte carlo or pseudo - random sampling , it matters how we actually generate the proposal .",
    "we will assume that @xmath96 @xmath54 $ ] random variables are used to generate @xmath94 via @xmath97",
    ". then the proposal @xmath94 is either accepted or rejected with probability @xmath98 .",
    "the decision is typically based on whether the @xmath27th random variable @xmath99 is below @xmath44 .",
    "the function @xmath100^d\\to{\\mathbb{r}}^s$ ] is a generator for the distribution @xmath101 on @xmath102 if @xmath103 when @xmath104^d$ ] .    for @xmath92 ,",
    "let @xmath105^{d-1}\\to{\\omega}$ ] be a generator for the transition kernel @xmath95 with conditional density . the metropolis ",
    "hastings sampler has @xmath106 where @xmath107 and @xmath108    the mis update is a special case of the metropolis ",
    "hastings update in which @xmath109 does not depend on @xmath110 .",
    "the rwm update is a special case of the metropolis ",
    "hastings update in which @xmath111 for some generator @xmath112 not depending on @xmath110 .",
    "let @xmath113 with @xmath114 and @xmath115 . to construct the systematic scan gibbs sampler ,",
    "let @xmath116 be a @xmath117-dimensional generator of the full conditional distribution of @xmath118 given @xmath119 for all @xmath120 .",
    "this gibbs sampler generates the new point using @xmath93^d$ ] .",
    "write @xmath121 with @xmath122^{k_j}$ ] .",
    "the systematic scan gibbs sampler has @xmath123 where , for @xmath124 , @xmath125}}({\\mathbf{u}}_j)\\ ] ] and @xmath126 } = ( \\phi_1({\\mathbf{x}},{\\mathbf{u}}),\\ldots,\\phi_{j-1}({\\mathbf{x}},{\\mathbf{u } } ) , x_{j+1},\\ldots , x_d)$ ] .",
    "let @xmath8 be a probability density function on @xmath127 .",
    "let @xmath128 and let @xmath129 be the uniform distribution on @xmath130 .",
    "the inversive slice sampler is the systematic scan gibbs sampler for @xmath129 with each @xmath131 using inversion for every @xmath132}}$ ] .",
    "there are many other slice samplers .",
    "see @xcite .",
    "it is elementary that @xmath133 implies @xmath80 .",
    "it is more usual to use @xmath134 , but our setting simplifies when we assume @xmath135 is updated first .",
    "we generate our random variables as functions of independent uniform random variables .",
    "the generators we consider require a finite number of inputs , so acceptance - rejection is not directly covered , but see the note in section [ sec : conclusions ] .",
    "for an encyclopedic presentation of methods to generate nonuniform random vectors , see devroye @xcite . here , we limit ourselves to inversion and some generalizations culminating in the rosenblatt  chentsov transformation introduced below .",
    "we will not need to assume that @xmath8 can be sampled by inversion .",
    "we only need inversion for an oracle used later in a coupling argument .",
    "let @xmath101 be the cdf of @xmath136 , and for @xmath137 define @xmath138 take @xmath139 and @xmath140 , using extended reals if necessary .",
    "then @xmath141 has distribution @xmath101 on @xmath142 when @xmath143 $ ] .",
    "multidimensional inversion is based on inverting the rosenblatt transformation  @xcite .",
    "let @xmath101 be the joint distribution of @xmath144 .",
    "let @xmath145 be the marginal cdf of @xmath146 and for @xmath147 , let @xmath148 be the conditional cdf of @xmath118 given @xmath149 .",
    "the inverse rosenblatt transformation @xmath150 of @xmath93^s$ ] is @xmath151 where @xmath152 and @xmath153 if @xmath104^s$ ] , then @xmath154 .",
    "we will use the inverse rosenblatt transformation as a first step in a  coupling argument which extends the one in chentsov @xcite .",
    "let @xmath150 be the inverse rosenblatt transformation for the stationary distribution @xmath8 and let @xmath7 be the update function for mcmc .",
    "the rosenblatt  chentsov transformation of the finite sequence @xmath155^d$ ] is the finite sequence @xmath156 , with @xmath157 , where @xmath158 and @xmath159 for @xmath160 .",
    "the rosenblatt  chentsov transformation starts off using @xmath161 and inversion to generate @xmath3 and then it applies whatever generators are embedded in @xmath7 with the innovations @xmath15 , to sample the transition kernel .",
    "the transition function @xmath7 need not be based on inversion .",
    "in this section , we prove sufficient conditions for some deterministic mcqmc samplers to sample consistently .",
    "the same proof applies to deterministic pseudo - random sampling .",
    "first , we define consistency , then some regularity conditions , and then we give the main results .",
    "our definition of consistency is that the empirical distribution of the mcmc samples converges weakly to @xmath8 .",
    "[ def : consist ] the triangular array @xmath162 for @xmath33 in an infinite set @xmath163 consistently samples the probability density function @xmath8  if @xmath164 holds for all bounded continuous functions @xmath165 .",
    "the infinite sequence @xmath166 consistently samples @xmath8 if the triangular array of initial subsequences with @xmath167 for @xmath2 does .    in practice",
    ", we use a finite list of vectors and so the triangular array formulation is a closer description of what we do .",
    "however , to simplify the presentation and avoid giving two versions of everything , we will work only with the infinite sequence version of consistency .",
    "triangular array versions of cud sampling for discrete state spaces are given in @xcite .",
    "it suffices to use functions @xmath62 in a convergence - determining class .",
    "for example , we may suppose that @xmath62 is uniformly continuous @xcite , or that @xmath168}$ ]  @xcite .",
    "when @xmath8 is a continuous distribution , we may use @xmath169}$ ] .      here",
    ", we define some assumptions that we  need to make on the mcmc update functions .",
    "[ def : coupleregion ] let @xmath170^d$ ] have positive jordan measure . if @xmath171 implies that @xmath172 for all @xmath173 , then @xmath174 is a coupling region .",
    "consider two iterations @xmath175 and @xmath176 with the same innovations @xmath15 but possibly different starting points @xmath3 and @xmath177 .",
    "if @xmath178 , then @xmath179 holds for all @xmath180 . in section [ sec : homeandcouple ] , we give some nontrivial examples of mcmc updates with coupling regions .",
    "[ def : regular ] let @xmath181 be the last point generated in the rosenblatt  chentsov transformation , viewed as a  function on @xmath23^{d(m+1)}$ ] . the mcmc is _ regular _ ( _ for bounded continuous functions _ )",
    "if the function @xmath182 is riemann integrable on @xmath23^{d(m+1)}$ ] whenever @xmath62 is bounded and continuous .    note that if an mcmc is regular , then the definition of the rosenblatt  chentsov transformation implies that @xmath183^{d(m+1 ) } } f({\\mathbf{x}}_m({\\mathbf{u}}_0,\\ldots,{\\mathbf{u}}_m ) ) \\,{{d}}{\\mathbf{u}}_0 \\cdots{{d}}{\\mathbf{u}}_m = \\int_{{\\omega } } f({\\mathbf{x } } ) \\pi({\\mathbf{x } } ) \\,{{d}}{\\mathbf{x}}\\ ] ] for any @xmath184 and all bounded continuous functions @xmath62 .",
    "we can , of course , define regularity for mcmc also with respect to other classes of functions . indeed ,",
    "there are numerous equivalent conditions for regularity .",
    "for example , the portmanteau theorem ( @xcite , chapter 1.2 ) implies that it is enough to assume that the functions @xmath62 are bounded and uniformly continuous .",
    "of interest are also indicator functions of rectangles since they appear in the definition of the local discrepancy at ( [ eq : localdis ] ) .",
    "the following theorem states some equivalent conditions . to simplify the statements",
    ", we write that mcmc is _",
    "regular for indicator functions _ whenever @xmath185 is riemann integrable on @xmath23^{d(m+1)}$ ] , where @xmath44 is either @xmath186 $ ] with @xmath187 finite or @xmath188 .",
    "[ thm : eq_regularity ] the following statements are equivalent :    a.   mcmc is regular for bounded continuous functions .",
    "b.   mcmc is regular for bounded uniformly continuous functions . c.   mcmc is regular for indicator functions @xmath189}$ ] of rectangles",
    "@xmath41 $ ] .",
    "this result follows by applying the portmanteau theorem ( @xcite , chapter  1.2 ) and some methods from real analysis .",
    "a regular mcmc is one that satisfies any ( and hence all ) of the above .",
    "theorem [ thm : withhomecouple ] below is the main result that we will use for metropolis ",
    "hastings sampling .",
    "one does not expect cud sampling to correct for an mcmc algorithm that would not be ergodic when sampled with i.i.d .",
    "ergodicity is assured through our assumption that there is a coupling region .",
    "section [ sec : homeandcouple ] below shows that some nontrivial mcmc methods have such regions .",
    "theorem [ thm : withhomecouple ] does not require the detailed balance condition that metropolis ",
    "hastings satisfies , and so it may apply to some nonreversible chains too .",
    "[ thm : withhomecouple ] let @xmath190 and let @xmath191 , and for @xmath192 let @xmath193 where @xmath7 is the update function of a regular mcmc with a coupling region  @xmath174 . if @xmath194 for a cud sequence @xmath195 , then @xmath55 consistently samples @xmath8 .",
    "the proof of theorem [ thm : withhomecouple ] is in the .",
    "it shows that the fraction of points @xmath5 in a bounded rectangle @xmath41 $ ] converges to @xmath196}\\pi({\\mathbf{x}})\\,{{d}}{\\mathbf{x}}$ ] .",
    "almost the same proof technique applies to expectations of bounded continuous functions .",
    "the gibbs sampler can be viewed as a special case of metropolis ",
    "hastings with acceptance probability one .",
    "however , it is more straightforward to study it by applying results on iterated function mappings to ( [ eq : defphi ] ) using methods from diaconis and freedman  @xcite and alsmeyer and fuh @xcite .    in this subsection",
    ", we assume that @xmath197 is a complete separable metric space .",
    "we assume that the update function @xmath91 is jointly measurable in @xmath110 and @xmath198 and that it is lipschitz continuous in @xmath110 for any @xmath198 .",
    "lipschitz continuity is defined through the metric @xmath199 on @xmath200 .",
    "the lipschitz constant , which depends on @xmath198 , is @xmath201 for each @xmath202^d$ ] , define @xmath203 .",
    "next , we present a theorem from alsmeyer and fuh @xcite on iterated random mappings .",
    "the @xmath33 step iteration , denoted @xmath204 , is defined by @xmath205 and for @xmath206 .",
    "[ thm : ifmalsfuh ] let the update function @xmath91 be jointly measurable in @xmath110 and @xmath198 with @xmath207^d } \\log(\\ell({\\mathbf{u}}))\\,{{d}}{\\mathbf{u}}<0 $ ] and , for some @xmath208 , @xmath207^d } \\ell({\\mathbf{u}})^p\\,{{d}}{\\mathbf{u}}<\\infty$ ] .",
    "assume that there is a point @xmath209 with @xmath207^d } \\log^+ ( d(\\phi({\\mathbf{x}}',{\\mathbf{u}}),{\\mathbf{x}}'))\\,{{d}}{\\mathbf{u}}<\\infty$ ] and @xmath210 .",
    "then there is a @xmath211 such that for all @xmath212 there is a @xmath213 such that for every @xmath214 @xmath215    this follows by specializing corollary 2.5(a ) of @xcite to the present setting .",
    "[ thm : withiterfunction ] let @xmath216 be a complete separable metric space and let @xmath217 be a cud sequence such that for every sequence @xmath218 of natural numbers with @xmath219 , we have @xmath220 .",
    "let @xmath221 , and for @xmath192 let @xmath193 be the gibbs sampler update for stationary distribution @xmath8 .",
    "assume that @xmath7 satisfies the conditions of theorem [ thm : ifmalsfuh ] and that there is a @xmath212 such that @xmath222^{dm}\\dvtx d(\\phi_m({\\mathbf{x}},{\\mathbf{v } } ) , \\phi_m(\\widehat{{\\mathbf{x}}},{\\mathbf{v } } ) ) > \\gamma^m \\}\\ ] ] is jordan measurable for all @xmath223 and @xmath224 .",
    "under these conditions , if the gibbs sampler is regular , then @xmath225 consistently samples @xmath8 .",
    "the proof of theorem [ thm : withiterfunction ] is in the .",
    "like theorem [ thm : withhomecouple ] , it shows that bounded rectangles @xmath41 $ ] have asymptotically the correct proportion of points .",
    "once again , similar arguments apply for bounded continuous functions of @xmath110 .",
    "although not explicitly stated there , the proof of @xcite , theorem 1 , shows the existence of sequences @xmath217 for which @xmath226 for all @xmath227 , where @xmath228 is a constant independent of @xmath33 and @xmath27 . unfortunately",
    ", no explicit construction of such a sequence is given in @xcite .",
    "then for any sequence @xmath229 of natural numbers with @xmath219 we obtain that @xmath230    in theorem [ thm : withhomecouple ] , we assumed that the coupling region @xmath174 is jordan measurable in theorem [ thm : withiterfunction ] , we do not have a coupling region , but still have an analogous assumption , namely that the sets @xmath231 are jordan measurable . a condition on @xmath7 which guarantees that @xmath231 is jordan measurable is given in section [ sec : gibbsexample ] .",
    "theorem [ thm : withhomecouple ] used coupling regions .",
    "these are somewhat special .",
    "but they do exist for some realistic mcmc algorithms .",
    "let @xmath7 be the update for the metropolized independence sampler on @xmath81 obtaining the proposal @xmath232 , where @xmath112 generates samples from the density @xmath233 , which are accepted when @xmath234 assume that the importance ratio is bounded above , that is , @xmath235 suppose also that there is a rectangle @xmath41\\subset[0,1]^{d-1}$ ] of positive volume with @xmath236 } \\frac{\\pi(\\psi({\\mathbf{u}}))}{p(\\psi ( { \\mathbf{u } } ) ) } > 0.\\ ] ] then @xmath237\\times[0,\\eta/\\kappa]$ ] is a coupling region .",
    "the set @xmath174 has positive jordan measure .",
    "suppose that @xmath238 .",
    "then @xmath239 and so @xmath240 , regardless of @xmath110 .",
    "[ lem : slicecouple ] let @xmath8 be a density on a bounded rectangular region @xmath241\\subset{\\mathbb{r}}^s$ ] .",
    "assume that @xmath242 holds for all @xmath92 .",
    "let @xmath243\\times[0,\\kappa]$ ] be the domain of the inversive slice sampler .",
    "let @xmath244 for @xmath86^{s+1}$ ] be the update for the inversive slice sampler and put @xmath245 . if @xmath246\\times[0,1]^s$ ] , then @xmath247 .    if @xmath248 , then @xmath249 and @xmath250 are in the set @xmath251 $ ] .",
    "the distribution of @xmath110 given @xmath135 for any @xmath252 $ ] is @xmath253 $ ] .",
    "therefore , @xmath254 ( componentwise ) .",
    "lemma [ lem : slicecouple ] does not couple the chains because @xmath255 and @xmath256 are different in general .",
    "but because @xmath247 , a coupling will happen at the next step , that is , @xmath257 when @xmath258\\times[0,1]^s$ ] . one could revise theorem [ thm : withhomecouple ] to include couplings that happen within some number @xmath259 of steps after @xmath238 happens . in this case",
    ", it is simpler to say that the chain whose update comprises two iterations of the inversive slice sampler satisfies theorem [ thm : withhomecouple ] . for a chain",
    "whose update is just one iteration , the averages over odd and even numbered iterations both converge properly and so that chain is also consistent .",
    "alternatively , we could modify the space of @xmath135 values so that all @xmath252 $ ] are identified as one point .",
    "then @xmath174 is a coupling region .",
    "the result of lemma [ lem : slicecouple ] also applies to slice samplers that sample @xmath260 and then @xmath261 using an @xmath262-dimensional generator that is not necessarily inversion .",
    "theorem [ thm : withhomecouple ] proves that mcmc consistently samples @xmath8 when implemented using cud sequences .",
    "we required certain riemann integrability conditions in defining regular rosenblatt ",
    "chentsov transformations . here",
    ", we verify that nontrivial mcmc algorithms can have regular rosenblatt  chentsov transformations .",
    "it seems odd to use the riemann integral over @xmath263 years after lebesgue  @xcite .",
    "but pseudo - random number generators are now typically designed to meet an equidistribution criterion over rectangular regions @xcite .",
    "other times they are designed with a spectral condition in mind .",
    "this again is closely related to riemann integrability via the weyl @xcite condition where @xmath16 for all trigonometric polynomials @xmath264 if and only if @xmath55 are uniformly distributed . unless one is using physical random numbers , the riemann integral , or perhaps the improper riemann integral is almost implicit .",
    "a function from @xmath42 to @xmath102 for is riemann integrable if all of its @xmath262 components are . to study how riemann integrability propagates",
    ", we will use the following two definitions .    for a function @xmath265 ,",
    "the discontinuity set of @xmath62 is @xmath266 if @xmath62 is only defined on @xmath267 , then @xmath268 where @xmath269 for @xmath270 and @xmath271 for @xmath272 .    for a function @xmath265 ,",
    "the graph of @xmath62 is @xmath273    lebesgue s theorem , next , provides a checkable characterization of riemann integrability .",
    "[ thm : lebesgues ] let @xmath42 be bounded and let @xmath274 be a bounded function .",
    "then @xmath62 is riemann integrable iff @xmath275 .",
    "see marsden and hoffman @xcite , page 455 .      here",
    ", we show that riemann integrability adds a special requirement to the way an algorithm is implemented .",
    "then we give an example to show that propagation rules for riemann integrability are more complicated than are those for continuity and differentiability .",
    "suppose that @xmath101 is the @xmath276 distribution for some @xmath277 .",
    "if we take @xmath278 and @xmath279 then we find that @xmath280 is discontinuous only on a set of measure zero .",
    "it is trivially bounded , and these two facts imply it is riemann integrable on @xmath23 ^ 2 $ ] .",
    "another transformation for the same distribution @xmath101 is @xmath281 and @xmath282 changing the conditional distribution of @xmath283 given @xmath146 on a set of measure @xmath284 leaves the distribution @xmath101 of @xmath110 unchanged . but for this version , we find @xmath62 can be discontinuous on more than a set of measure @xmath284 and so this inverse rosenblatt transformation of @xmath101 is not regular .    in practice , of course , one would use the regular version of the transformation . but",
    "propagating riemann integrability to a function built up from several other functions is not always straightforward .",
    "the core of the problem is that the composition of two riemann integrable functions need not be riemann integrable .    as an example @xcite ,",
    "consider thomae s function on @xmath285 , @xmath286 where it is assumed that @xmath233 and @xmath287 in the representation @xmath288 have no common factors .",
    "this @xmath62 is continuous except on @xmath289 and so it is riemann integrable .",
    "the function @xmath290 is also riemann integrable . but",
    "@xmath291 for @xmath292 , which is famously not riemann integrable .",
    "the class of riemann integrable functions , while more restrictive than we might like for conclusions , is also too broad to use in propagation rules .      first , we show that the acceptance - rejection step in metropolis ",
    "hastings does not cause problems with riemann integrability .",
    "[ lem : accrej ] let @xmath293 and suppose that @xmath294 , @xmath295 and @xmath44 are real - valued riemann integrable functions on @xmath23^k$ ] . for @xmath93^{k+1}$ ] define @xmath296 then @xmath62 is riemann integrable on @xmath23^{k+1}$ ] .",
    "first , @xmath297)\\cup g(a)$ ] .",
    "riemann integrability of @xmath294 gives @xmath298 .",
    "similarly , @xmath299 .",
    "therefore , @xmath300)=0 $ ] .    turning to @xmath301",
    ", we split the domain @xmath23^k$ ] of @xmath44 into @xmath302 congruent subcubes @xmath303 ( whose boundaries overlap ) . then @xmath304 $ ] , where @xmath305 and @xmath306 . as a result @xmath307 .",
    "riemann integrability of @xmath44 implies this upper bound vanishes as @xmath14 .",
    "therefore , @xmath308 and so @xmath309 and the result follows by lebesgue s theorem .    in the mcmc context ,",
    "@xmath294 and @xmath295 are the @xmath310th component of the proposal and the previous state , respectively , @xmath44 is the acceptance probability , and @xmath198 is the ensemble of uniform random variables used in @xmath311 stage rosenblatt  chentsov coupling and @xmath312 .    for consistency results , we study the proportion of times @xmath313 $ ] .",
    "it is enough to consider the components one at a time and in turn to show @xmath314 and @xmath315 are riemann integrable .",
    "however , as the example with thomae s function shows , even the indicator function of an interval applied to a riemann integrable function can give a non - riemann integrable composite function .",
    "we may avoid truncation by employing bounded continuous test functions .",
    "we will use the following simple corollary of lebesgue s theorem .",
    "[ lem : ctsofriemann ] for @xmath316 and @xmath317 , let @xmath318 be riemann integrable functions from @xmath23^k$ ] to a bounded interval @xmath319\\subset{\\mathbb{r}}$ ] .",
    "let @xmath295 be a continuous function from @xmath319^k$ ] to @xmath142 .",
    "then @xmath320 is riemann integrable on @xmath23^k$ ] .",
    "because @xmath295 is continuous , @xmath321 . but",
    "therefore , @xmath322 and so @xmath62 is riemann integrable by lebesgue s",
    ".    we can also propagate riemann integrability through monotonicity . if @xmath294 is a monotone function from @xmath142 to @xmath142 and @xmath62 is the indicator of an interval , then @xmath323 is the indicator of an interval too , and hence is riemann integrable , when that interval is of finite length .",
    "[ lem : rosenblatt ] let @xmath324 be the cdf of @xmath146 and for @xmath147 , let @xmath325 be the conditional cdf of @xmath118 given @xmath326 .",
    "suppose that the cdfs @xmath325 are continuous functions of @xmath327 and that the quantile functions @xmath328 are continuous in @xmath329\\times{\\mathbb{r}}^{j-1}$ ] , for @xmath147 .",
    "define functions @xmath330 and @xmath331 for @xmath147 , where @xmath332 .",
    "then for , the set @xmath333 is jordan measurable .    by hypothesis , @xmath334 is a continuous function of @xmath93^s$ ] , for @xmath335 , and so is @xmath336 .",
    "this latter only depends on @xmath337 , for @xmath338 , and so we write it as @xmath339 .    for @xmath335 ,",
    "let @xmath340 .",
    "the set @xmath341 is the interval @xmath342 $ ] , and hence is jordan measurable .",
    "suppose @xmath343 is jordan measurable for @xmath344 .",
    "then @xmath345 ) \\cap g_{k+1 } \\qquad \\mbox{where } g_{k+1 } = \\bigl\\ { { \\mathbf{u}}_{1\\dvtx ( k+1)}\\mid u_{k+1 } \\le g_{k+1 } ( { \\mathbf{u}}_{1\\dvtx k})\\bigr\\}.\\end{aligned}\\ ] ] the set @xmath346 $ ] is jordan measurable because @xmath343 is .",
    "the boundary of @xmath347 is contained within the intersection of the graph of @xmath348 and the boundary of @xmath23^{k+1}$ ] and so @xmath347 is jordan measurable .",
    "the result follows by induction because @xmath349 .      here , we give sufficient conditions for the rosenblatt  chentsov transformation to be regular .    for integer @xmath350 ,",
    "let @xmath351 be the endpoint of the rosenblatt  chentsov transformation of @xmath23^{(d+1)m}$ ] , started with a riemann integrable function @xmath150 and continued via the metropolis ",
    "hastings update @xmath7 .",
    "let @xmath7 be defined in terms of the proposal function @xmath352^{d-1}\\to{\\mathbb{r}}^s$ ] with proposal density @xmath353 and target density @xmath354 .",
    "let @xmath62 be a bounded continuous function on @xmath102 .    if @xmath112 is bounded and @xmath94 , @xmath355 and @xmath8 are bounded continuous functions , then @xmath182 is a riemann integrable function of the variables @xmath23^{(d+1)m}$ ] used in the rosenblatt  chentsov transformation .",
    "we only need to show that @xmath356 is a riemann integrable function of @xmath357^{d(m+1)}$ ] and then the result follows by lemma [ lem : ctsofriemann ] .",
    "we proceed by induction . for @xmath358",
    ", @xmath359 is bounded and continuous on @xmath23^d$ ] , hence it is riemann integrable .    now suppose that @xmath360 is a riemann integrable function on @xmath23^{dm}$ ] .",
    "let @xmath361 be the value @xmath360 , written as a riemann integrable function on @xmath23^{dm+d-1}$ ] , so it ignores its last @xmath96 arguments .",
    "let @xmath362 be the proposal @xmath363 , @xmath364 .",
    "this is a continuous function @xmath365 of two riemann integrable functions on @xmath23^{d(m+1)-1}$ ] and so it is riemann integrable .",
    "next , @xmath366 is a continuous function of both @xmath360 and @xmath367 which are in turn riemann integrable functions on @xmath23^{dm+d-1}$ ] , and so @xmath366 is riemann integrable .",
    "then @xmath351 is a riemann integrable function on @xmath23^{dm+d}$ ] , by lemma  [ lem : accrej ] , completing the induction .",
    "in studying the gibbs sampler , we made several assumptions .",
    "first , we required jordan measurability for the sets @xmath368 .",
    "second , we required a contraction property . in this section , we show that those assumptions are reasonable .",
    "we give an example where the conditions of theorem [ thm : withiterfunction ] are satisfied , that is , the sets @xmath369 are jordan measurable for all @xmath370 and @xmath214 ( for some suitable domain @xmath6 ) .",
    "assume ( additionally to the assumptions made in theorem [ thm : withiterfunction ] ) that @xmath91 is totally differentiable with continuous derivative with respect to @xmath198 for each @xmath371 and that @xmath27 is based on the @xmath372 norm for some @xmath373 .",
    "further , assume that the gradient of @xmath374 with respect to @xmath198 vanishes only on a null set for all @xmath375 , @xmath376 , that is , @xmath377^{d}\\dvtx",
    "\\nabla_{{\\mathbf{u}}}\\ , d(\\phi({\\mathbf{x}},{\\mathbf{u}}),\\phi(\\widehat{{\\mathbf{x}}},{\\mathbf{u } } ) ) = { \\mathbf{0}}\\}\\bigr ) = 0,\\ ] ] for all @xmath378 , @xmath379 , where @xmath380 denotes the lebesgue measure and where @xmath381 denotes the gradient .",
    "then , for all @xmath223 , we also have @xmath377^{dm}\\dvtx   \\nabla_{{\\mathbf{u}}}\\ , d(\\phi_m({\\mathbf{x}},{\\mathbf{u}}),\\phi_m(\\widehat{{\\mathbf{x}}},{\\mathbf{u } } ) ) = { \\mathbf{0}}\\}\\bigr ) = 0\\ ] ] for all @xmath214 , @xmath376 .",
    "let @xmath382 with @xmath376 be fixed .",
    "then for almost all @xmath383^{dm}$ ] we have @xmath384 .",
    "therefore , there is a @xmath385 such that @xmath386 for all @xmath387 , where @xmath388^{dm}\\dvtx   \\|{\\mathbf{u}}^\\ast-{\\mathbf{v}}\\|_{l_2 } < \\delta\\}$ ] is a neighborhood of @xmath389 .",
    "therefore , the directional derivative at a point @xmath387 is different from @xmath284 , except on a hyperplane , that is , almost everywhere .",
    "hence , by the mean value theorem , the function @xmath390 for @xmath391 can at most be constant on a hyperplane , which has lebesgue measure @xmath284 .",
    "note that @xmath392 , therefore there is a countable number of elements @xmath393 and numbers @xmath394 with the properties of @xmath389 and @xmath395 described above and for which we have @xmath396^{dm}$ ] .",
    "therefore , we have @xmath377^{dm}\\dvtx d(\\phi_m({\\mathbf{x}},{\\mathbf{u}}),\\phi_m(\\widehat{{\\mathbf{x}}},{\\mathbf{u } } ) ) = c \\ } \\bigr ) = 0,\\ ] ] for any @xmath397 .",
    "the set of points where @xmath398 is discontinuous is given by @xmath399^{dm}\\dvtx   \\forall\\delta > 0\\ \\exists{\\mathbf{v}},{\\mathbf{v } } ' \\in n_\\delta({\\mathbf{u } } ) \\mbox { such that } \\\\ & & \\hspace*{4.5pt } d(\\phi_m({\\mathbf{x}},{\\mathbf{v}}),\\phi_m(\\widehat{{\\mathbf{x}}},{\\mathbf{v } } ) ) > \\gamma^m \\mbox { and } d(\\phi_m({\\mathbf{x}},{\\mathbf{v}}'),\\phi_m(\\widehat{{\\mathbf{x}}},{\\mathbf{v } } ' ) ) \\le \\gamma^m \\}.\\end{aligned}\\ ] ] as @xmath369 and @xmath400^{dm}\\dvtx d(\\phi_m({\\mathbf{x}},{\\mathbf{u}}),\\phi_m(\\widehat{{\\mathbf{x}}},{\\mathbf{u } } ) ) < \\gamma^m \\}$ ] are open , it follows that @xmath401^{dm}\\dvtx d(\\phi_m({\\mathbf{x}},{\\mathbf{u}}),\\phi_m(\\widehat{{\\mathbf{x}}},{\\mathbf{u } } ) ) = \\gamma^m \\}.\\ ] ] therefore , @xmath402 and lebesgue s theorem ( see theorem [ thm : lebesgues ] ) implies that @xmath369 is jordan measurable .      here , we illustrate how the gibbs sampler yields a  contraction for the probit model . in this model , @xmath403 and @xmath404 for @xmath2 for independent @xmath405 .",
    "the coefficient @xmath406 has a  noninformative prior distribution .",
    "the predictors are @xmath407 .",
    "we define the matrix @xmath408 with @xmath409 element @xmath410 .",
    "we assume that @xmath408 has rank @xmath233 .",
    "the state of the markov chain is @xmath411 , where @xmath412 .",
    "given the observed data @xmath413 , we can use the gibbs sampler to simulate the posterior distribution of @xmath414 and @xmath415 .",
    "a single step of the gibbs sampler makes the transition @xmath416 for @xmath316 using generators given explicitly below .",
    "the values @xmath417 are the components of @xmath418 .",
    "we also write the transitions as @xmath419 where @xmath7 and its components @xmath420 and @xmath421 ( for @xmath414 and @xmath422 , resp . )",
    "are given explicitly below .",
    "given @xmath414 , the components of @xmath422 are independent , with @xmath423 we may generate them from @xmath424 by @xmath425    given @xmath422 , the distribution of @xmath414 is @xmath426 . we may generate it using @xmath427 via @xmath428 thus equation ( [ eq : betafromz ] ) defines @xmath420 while ( [ eq : zfrombeta ] ) defines @xmath421 .",
    "the framework in @xcite allows one to pick a metric that conforms to the problem .",
    "we use the metric @xmath429 where @xmath430 and @xmath431 we show below that @xmath432 for pairs @xmath433 of distinct points in @xmath434",
    ". both metrics @xmath435 and @xmath436 are also norms , which simplifies our task .",
    "suppose first that @xmath437 .",
    "then it follows easily that @xmath438 and @xmath439 , so then the left - hand side of ( [ eq : itcontracts ] ) is @xmath284 . as a result , we may assume without loss of generality that @xmath440 . with this assumption , we will use the bound @xmath441\\\\[-8pt ] & & \\qquad\\le\\max\\biggl ( \\frac{d_1(\\beta^{(k)}-\\beta^{\\prime(k ) } ) } { d_1(\\beta^{(k-1)}-\\beta^{\\prime(k-1 ) } ) } , \\frac{d_2({\\mathbf{z}}^{(k)}-{\\mathbf{z}}^{\\prime(k ) } ) } { d_1(\\beta^{(k-1)}-\\beta^{\\prime(k-1 ) } ) } \\biggr).\\nonumber\\end{aligned}\\ ] ]    we begin by studying the update to @xmath422 . subtracting @xmath442 from both sides of ( [ eq : zfrombeta ] ) , applying @xmath443 , differentiating with respect to @xmath414 and gathering up terms , we find that @xmath444 where @xmath445 and @xmath446 is the @xmath447 probability density function .",
    "it is clear that @xmath448 .",
    "next , we show that @xmath449 .",
    "we begin by inverting  ( [ eq : zfrombeta ] ) to get @xmath450 substituting ( [ eq : ufrombeta ] ) into ( [ eq : lambdafrom ] ) and simplifying yields @xmath451 now consider the function @xmath452 .",
    "this function is nonnegative and decreasing , using a mill s ratio bound from @xcite . when @xmath453 , then @xmath454 because then @xmath455 .",
    "we also used symmetry of @xmath456 . if instead @xmath457 , then @xmath458 because then @xmath459 . either way , @xmath460 and therefore @xmath461 for all @xmath462 .",
    "writing the previous results in a compact matrix form , we have @xmath463 where @xmath464 . similarly , equation ( [ eq : betafromz ] ) yields @xmath465    thus , for the @xmath422 update with any @xmath418 , @xmath466\\\\[-8pt ] & \\le&{\\mathop{\\sup_{\\beta,{\\mathbf{z}}}}_{(x\\xi)^{\\mathsf{t}}x\\xi= 1 } } \\vert\\lambda(\\beta,{\\mathbf{z } } ) x \\xi\\vert < 1.\\nonumber\\end{aligned}\\ ] ]    for the @xmath414 update , applying the chain rule gives @xmath467 and then @xmath468\\\\[-8pt ] & = & { \\sup_{\\beta,{\\mathbf{z}},\\vert\\eta\\vert= 1 } } \\vert x(x^{\\mathsf{t}}x)^{-1}x^{\\mathsf{t}}\\lambda\\eta\\vert \\nonumber\\\\ & \\le&{\\max_{1\\le i\\le n}\\lambda_i } \\nonumber\\\\ & < & 1,\\nonumber\\end{aligned}\\ ] ] using the nonexpansive property of the projection matrix @xmath469 . by combining ( [ eq : zup ] ) with ( [ eq : bup ] ) , we establish the contraction ( [ eq : itcontracts ] ) .",
    "in the lebesgue formulation , @xmath470 and @xmath54^d$ ] are the same distribution , in that they can not be distinguished with positive probability from any countable sample of independent values .",
    "riemann integrals are usually defined for @xmath23^d$ ] and discrepancy measures are usually defined for either @xmath23^d$ ] or @xmath471 .",
    "these latter theories are designed for bounded functions .    in monte carlo simulations ,",
    "sometimes values @xmath472 are produced .",
    "these end points can be problematic with inversion , where they may yield extended real values , and hence good practice is to select random number generators supported in the open interval @xmath285 .",
    "for our gibbs sampler example with the probit model , we required @xmath418 .",
    "this was necessary because otherwise the values @xmath91 might fail to belong to @xmath200 .",
    "our slice sampler example had @xmath200 equal to the bounded rectangle @xmath41 $ ] .",
    "then values @xmath472 do not generate sample points outside @xmath200 .",
    "our metropolized independence sampler did not require bounded support .",
    "it could produce extended real values .",
    "those however are not problematic for weak convergence , which is based on averages of @xmath189}({\\mathbf{x}}_i)$ ] or other bounded test functions .",
    "also , the chain will not get stuck at an unbounded point .",
    "we have demonstrated that mcqmc algorithms formed by metropolis  hastings updates driven by completely uniformly distributed points can consistently sample a continuous stationary distribution .",
    "some regularity conditions are required , but we have also shown that those conditions hold for many , though by no means all , mcmc updates . the result is a kind of ergodic theorem for qmc like the ones in @xcite and @xcite for finite state spaces .    when rqmc is used in place of qmc to drive an mcmc simulation , then instead of cud points , we need to use weakly cud points .",
    "these satisfy @xmath473 for all @xmath66 and all @xmath49 .",
    "our version of mcmc above leaves out some methods in which one or more components of @xmath15 are generated by acceptance - rejection sampling because then we can not assume @xmath474 . a modification based on splicing i.i.d .",
    "@xmath54 $ ] random variables into a cud sequence was proposed by liao @xcite and then shown to result in a weakly cud sequence in @xcite .",
    "we do not expect that a global substitution of qmc points will always bring a large improvement to mcmc algorithms .",
    "what we do expect is that means of smooth functions of the state vector in gibbs samplers will often benefit greatly from more even sampling .",
    "it is also a fair question to ask when one needs an mcmc result computed to the high precision that qmc sometimes makes possible .",
    "gelman and shirley @xcite address this issue , distinguishing task 1 ( inference about a  parameter @xmath475 ) from task 2 [ precise determination of @xmath476 or more generally @xmath477 conditional on the data , or a posterior quantile of @xmath475 ] .",
    "the accuracy of task 1 problems may be limited more by sample size than by monte carlo effort .",
    "task 2 problems include computation of normalizing constants and problems where one wants to report numerically stable , and hence more reproducible , simulation output .",
    "this appendix contains the lengthier proofs .",
    "we need one technical lemma about cud points .",
    "consider overlapping blocks of @xmath479-tuples from @xmath480 , with starting indices @xmath27 units apart .",
    "if @xmath480 are cud then these overlapping blocks are uniformly distributed .",
    "the proof works by embedding the @xmath479-tuples into nonoverlapping @xmath481-tuples . for large @xmath482 ,",
    "the boundary effect between adjacent blocks becomes negligible .",
    "this result is also needed for the argument in  @xcite .",
    "[ lem : tech ] for @xmath483 , let @xmath484 $ ] . for integers @xmath485 , let @xmath486 .",
    "if @xmath487 are completely uniformly distributed , then @xmath488^{dk}$ ] are uniformly distributed .",
    "choose any @xmath489^{dk}$ ] .",
    "let @xmath490 be the volume of @xmath491 .",
    "for integers @xmath317 , define @xmath492 on @xmath23^{rdk}$ ] by @xmath493 .",
    "each @xmath492 has riemann integral @xmath494 .",
    "we use @xmath492 on nonoverlapping blocks of length @xmath481 from @xmath487 : @xmath495 after using ( [ eq : overlapornot ] ) . taking @xmath482",
    "as large as we like , we get @xmath496 .",
    "it follows that @xmath497 for any rectangular subset @xmath498^{dk}$ ]",
    ". therefore , @xmath499 too , for otherwise some rectangle @xmath500 would get too few points .",
    "now , we prove the main theorems from section [ sec : consistency ] .",
    "proof of theorem [ thm : withhomecouple ] pick @xmath501 . now let @xmath502 and for @xmath2 define the sequence @xmath503 as the rosenblatt  chentsov transformation of @xmath504 .",
    "suppose that @xmath7 is regular and for a bounded rectangle @xmath41\\subset{\\mathbb{r}}^s$ ] , let @xmath505}({\\mathbf{x}})$ ] .",
    "then @xmath506 where @xmath507 and @xmath508    for @xmath509 , notice that @xmath510 $ ] if and only if @xmath511 lies in a @xmath512-dimensional region @xmath513 .",
    "the region @xmath513 has volume @xmath196 } \\pi({\\mathbf{x } } ) \\,{{d}}{\\mathbf{x}}$ ] because @xmath514)$ ] is @xmath196 } \\pi({\\mathbf{x } } ) \\,{{d}}{\\mathbf{x}}$ ] when @xmath515^{d(m+1)}$ ] .",
    "it has a riemann integrable indicator function by hypothesis .",
    "then because @xmath217 are cud , and using lemma [ lem : tech ] with @xmath516 , we get @xmath517    now , consider @xmath518 .",
    "the only nonzero terms arise when @xmath519 .",
    "this in turn requires that the coupling region @xmath174 is avoided @xmath311 consecutive times , by @xmath520",
    ". then @xmath521 belongs to a region of volume at most @xmath522 .",
    "choose @xmath311 large enough that @xmath523 . then @xmath524    for the third term , @xmath525 is at most @xmath526 , which goes to @xmath284 as @xmath527 .",
    "thus , we have @xmath528 } - \\int_{[{\\mathbf{a}},{\\mathbf{b } } ] } \\pi({\\mathbf{x } } ) \\,{{d}}{\\mathbf{x}}\\biggr| < \\varepsilon.\\ ] ] as @xmath529 was chosen arbitrarily , the result follows for this case .",
    "the result holds trivially for the function @xmath530 , hence we are done .",
    "proof of theorem [ thm : ifmalsfuh ] we use the notation from the proof of theorem  [ thm : withhomecouple ] . as in the proof of theorem [ thm : withhomecouple ]",
    ", we write @xmath531 as the sum of three terms .",
    "the first and third terms vanish by the same arguments we used in theorem [ thm : withhomecouple ] .    for the second term , we have @xmath532 let @xmath529 be arbitrary .",
    "we show that @xmath533 .",
    "as @xmath529 is arbitrary , this then implies that @xmath534 .",
    "assume that the gibbs sampler is regular for rectangles and for a bounded positive volume rectangle @xmath41 \\subset{\\mathbb{r}}^s$ ] let @xmath505}({\\mathbf{x}})$ ] .",
    "for @xmath535 , let @xmath536 and put @xmath537}$ ] and @xmath538}$ ] .    because @xmath539 , the triple @xmath540 must be in the set @xmath541 . likewise @xmath542 . by inspecting all @xmath543 cases in @xmath544 , we find that @xmath545 , for @xmath546 and @xmath547 where @xmath548",
    ".    choose @xmath385 such that @xmath549 \\setminus[{\\mathbf{a}}+{\\bolds{\\delta}},{\\mathbf{b}}-{\\bolds{\\delta } } ] ) } \\pi({\\mathbf{x } } ) \\,{{d}}{\\mathbf{x } } < \\frac{\\varepsilon}{3}.\\ ] ] as the gibbs sampler is regular for rectangles , @xmath217 is a cud sequence , and @xmath550 is constructed using the rosenblatt  chentsov transformation we have @xmath551^{dm+d}\\dvtx { \\mathbf{x}}'_{i , m , m } \\in [ { \\mathbf{a}}-{\\bolds{\\delta}},{\\mathbf{b}}+{\\bolds{\\delta}}]\\setminus[{\\mathbf{a}},{\\mathbf{b } } ] \\ } ) \\\\ & & \\qquad = \\int_{{\\omega}\\cap ( [ { \\mathbf{a}}-{\\bolds{\\delta}},{\\mathbf{b}}+{\\bolds{\\delta } } ] \\setminus[{\\mathbf{a}}+{\\bolds{\\delta}},{\\mathbf{b}}+{\\bolds{\\delta } } ] ) } \\pi({\\mathbf{x } } ) \\,{{d}}{\\mathbf{x } } < \\frac{\\varepsilon}{3},\\end{aligned}\\ ] ] and so @xmath552 .",
    "the points @xmath550 and @xmath553 have different starting points @xmath554 and @xmath555 , but are updated @xmath311 times using the same @xmath556 , that is , @xmath557 , @xmath558 and @xmath559 .",
    "therefore , theorem [ thm : ifmalsfuh ] implies that there is a constant @xmath228 such that for all sufficiently large @xmath560 the region @xmath561^{dm}\\dvtx d(\\phi_m({\\mathbf{x}}'_{i , m,0},({\\mathbf{v}}_1,\\ldots,{\\mathbf{v}}_m)),\\\\ & & \\hspace*{142.2pt}\\phi_m({\\mathbf{x}}_{i},({\\mathbf{v}}_1,\\ldots,{\\mathbf{v}}_m ) ) ) > \\gamma^m\\},\\end{aligned}\\ ] ] has volume at most @xmath562 .",
    "let @xmath563 .",
    "let @xmath564 if @xmath41 \\cap{\\omega}= \\varnothing$ ] or @xmath565 = \\varnothing$ ] and @xmath566 \\cap{\\omega } , { \\mathbf{y } } ' \\in{\\omega}\\setminus[{\\mathbf{a}}-{\\bolds{\\delta}},{\\mathbf{b}}+{\\bolds{\\delta}}]\\}$ ] otherwise .",
    "let @xmath567 be such that @xmath568 and @xmath569 .",
    "now take @xmath570 .",
    "for large enough @xmath33 , we can take @xmath571 .",
    "then @xmath572 has volume at most @xmath573 .",
    "thus , @xmath574 implies that @xmath575 , which in turn implies that @xmath576 , and so @xmath577 .",
    "therefore , we have @xmath578 a similar argument shows that @xmath579 .",
    "combining the three bounds yields @xmath580 establishing consistency when the gibbs sampler is regular .",
    "since the result holds trivially for the function @xmath530 , the result follows .",
    "the coupling region in theorem [ thm : withhomecouple ] was replaced by a mean contraction assumption @xmath207^d } \\log(\\ell({\\mathbf{u}}))\\,{{d}}{\\mathbf{u } } < 0 $ ] in theorem [ thm : withiterfunction ] . this way we obtain ( possibly different )",
    "coupling type regions @xmath581 for each @xmath582 .",
    "we remedy this situation by letting @xmath311 depend on @xmath33 , which in turn requires us to use a stronger assumption on the cud sequence @xmath217 , namely , that @xmath583 .",
    "we thank seth tribble , erich novak , ilya m. sobol and two anonymous reviewers for helpful comments .",
    "gelman , a. and shirley , k. ( 2010 ) .",
    "inference from simulations and monitoring convergence . in _ handbook of markov chain monte carlo : methods and applications_. ( s.  brooks , a. gelman , g. jones and x .-",
    "meng , eds . ) 131143 . chapman and hall / crc press , boca raton , fl .",
    "lecuyer , p. and lemieux , c. ( 1999 ) .",
    "quasi - monte carlo via linear shift - register sequences . in _ proceedings of the 1999 winter simulation conference _",
    "( p. a. farrington , h. b. nembhard , d. t. sturrock and g. w. evans , eds . ) 632639 .",
    "ieee press , piscataway , nj .                      owen , a. b. ( 1995 ) .",
    "randomly permuted @xmath585-nets and @xmath586-sequences . in _",
    "monte carlo and quasi - monte carlo methods in scientific computing _ ( h. niederreiter and p. jau - shyong shiue , eds . ) 299317 .",
    "springer , new york .",
    "owen , a. b. ( 2005 ) .",
    "multidimensional variation for quasi - monte carlo . in",
    "_ contemporary multivariate analysis and design of experiments : in celebration of prof .",
    "kai - tai fang s 65th birthday _ ( j. fan and g. li , eds . ) .",
    "world sci .",
    "hackensack , nj ."
  ],
  "abstract_text": [
    "<S> the random numbers driving markov chain monte carlo ( mcmc ) simulation are usually modeled as independent @xmath0 random variables . </S>",
    "<S> tribble [ markov chain monte carlo algorithms using completely uniformly distributed driving sequences ( 2007 ) stanford univ . ] </S>",
    "<S> reports substantial improvements when those random numbers are replaced by carefully balanced inputs from completely uniformly distributed sequences . the previous theoretical justification for using anything other than i.i.d .   </S>",
    "<S> @xmath0 points shows consistency for estimated means , but only applies for discrete stationary distributions . </S>",
    "<S> we extend those results to some mcmc algorithms for continuous stationary distributions . </S>",
    "<S> the main motivation is the search for quasi - monte carlo versions of mcmc . as a side benefit , </S>",
    "<S> the results also establish consistency for the usual method of using pseudo - random numbers in place of random ones .    ,    and    .    </S>"
  ]
}