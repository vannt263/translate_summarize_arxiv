{
  "article_text": [
    "a large effort has been recently devoted to the study of a very large ensemble of interacting systems that can be described in terms of complex networks ( or graphs ) , in which the vertices represent typical units and the edges represent the interactions between pairs of units @xcite .",
    "stimulated by this finding , a theory of complex networks , deeply rooted in the classical graph theory @xcite , has hence been developed , finding fruitful applications in fields as diverse as the internet @xcite , the world - wide - web @xcite , social communities @xcite , food - webs @xcite , or biological interacting networks @xcite .",
    "the study of complex networks , boosted by the new availability of powerful computers capable to deal with very large databases , was initially focused in the study of global properties , such as the average shortest path length , the average clustering coefficient , or the degree distribution @xcite .",
    "this work led to the discovery that most natural complex networks usually exhibit two typical properties : ( i ) the _ small - world _ property @xcite , that is defined by an average path length ",
    "average distance between any pair of vertices  increasing very slowly ( usually logarithmically ) with the network size @xmath0 .",
    "( ii ) a _ scale - free _ degree distribution .",
    "if we define the degree distribution , @xmath1 , as the probability that a vertex is connected to @xmath2 other vertices , then scale - free networks are characterized by a power - law behavior @xmath3 , where @xmath4 is a characteristic degree exponent .",
    "these properties imply a large connectivity heterogeneity and a short average distance between vertices , which have considerable impact on the behavior of physical processes taking place on top of the network , such as the resilience to random damage @xcite or the spreading of infective agents @xcite .",
    "it was soon realized , however , that these properties do not provide a sufficient characterization of natural networks . in particular , these systems seem to exhibit also ubiquitous degree _ correlations _ , which translate in the fact that the degrees of the vertices at the end points of any given edge are not independent @xcite . this observation has led to a classification of networks according to the nature of their degree correlations @xcite : in the presence of positive correlations ( vertices with large degree tend to connect more preferably with vertices with large degree ) , the network is said to show _ assortative mixing_. on the other hand , negative correlations ( highly connected vertices are preferably connected to vertices with low degree ) imply the presence of _ dissortative mixing_. at the same time , it has been pointed out that the presence of correlations might have important consequences in dynamical processes taking place in the topology defined by the network @xcite .",
    "motivated by these observations , several works have been recently devoted to set up a general framework to study the origin of correlations in random networks @xcite . at this respect , it is particularly interesting the models introduced by caldarelli _",
    "_ @xcite and sderberg @xcite .",
    "these models consider graphs in which each vertex has assigned a tag ( _ type _ or _ fitness _ ) , randomly drawn from a fixed probability distribution .",
    "edges are assigned to pairs of vertices with a given connection probability , depending on the values of the tags assigned at the edge end points .",
    "this construction generates random networks which exhibit peculiar correlation and percolation properties @xcite .    in this paper",
    "we present a generalization of the models described in ref .",
    "@xcite , that can be encompassed in a general class of models with _",
    "hidden variables _ tagging the vertices , and completely determining the topological structure of the ensuing network .",
    "we develop a detailed analysis of the correlations present in this class of network models , providing explicit analytical expressions for both two and three vertices degree correlations .",
    "we distinguish between sparse networks ( with finite average degree @xmath5 ) and non - sparse networks ( with diverging @xmath5 for a number of vertices @xmath6 ) .",
    "even though both cases are enclosed in this class of networks , analytical expressions are simpler in the former case . as an example of our formalism , we consider the intrinsic fitness model introduced in ref .",
    "@xcite , which belongs to the subset of non - sparse networks , and that has attracted a great deal of attention as an alternative to generate scale - free networks without growth nor preferential attachment @xcite . the solution of this model in the continuous degree approximation is compared with extensive numerical simulations , yielding a remarkable agreement for all the topological properties considered . as a particular case of the general class of models with hidden variables ,",
    "we propose a practical algorithm to generate correlated random networks with a given correlation structure .",
    "the algorithm levers in the assignation of hidden variables with the structure of the degrees of a real network . following this approach , it is possible to easily generate networks matching any desired correlation pattern , as we show by means of analytical calculations and numerical simulations . finally , we present the extension of this class of models to non - equilibrium growing networks . by mapping the hidden variables to the time in which vertices are introduced in the network @xcite , and by means of an appropriately chosen connection probability , we define an algorithm that yields networks exhibiting all the properties ( in particular aging ) exhibited by traditional scale - free growing models .    the paper is organized as follows . in sec .",
    "[ sec : meas - corr - compl ] we review some general results concerning the measure of correlations in complex networks , which will be useful through the rest of the paper . in sec .",
    "[ sec : hidd - vari - models ] we introduce the general analytical formulation of the class of correlated networks with hidden variables . sec .",
    "[ sec : intr - fitn - model ] is devoted to the analytical and numerical study of the intrinsic fitness model introduced in ref .",
    "@xcite . in sec .",
    "[ sec : pract - algor - gener ] we present an algorithm to generate correlated random networks with a given _ a priori _ correlation structure .",
    "[ sec : non - equil ] deals with the mapping into this class of models of non - equilibrium growing networks . finally , in sec .",
    "[ sec : conclusions ] we draw our conclusions and perspectives .",
    "let us consider the class of unstructured undirected networks , in which all vertices with the same degree can be considered to be statistically equivalent .",
    "in this sense , the following results will not apply to structured networks , in which a distance ordering can be defined ; for instance , when the small - world property is absent @xcite .",
    "a network is said to be _ uncorrelated _ when the probability that an edge departing from a vertex of degree @xmath2 arrives at a vertex of degree @xmath7 is independent of the degree of the initial vertex @xmath2 .",
    "most natural networks are not uncorrelated , in the sense that the degrees at the end points of any given edge are not independent .",
    "this kind of two vertices degree correlations can be measured in undirected networks by means of the conditional probability @xmath8 that a vertex of degree @xmath2 is connected to a vertex of degree @xmath7 . from the point of view of correlations , it is useful to consider the restricted subset of undirected _ markovian _ random networks @xcite , which are completely defined by the degree distribution @xmath1 and the conditional probability @xmath8 .",
    "the markovian nature of this class of networks implies that all higher order correlations can be expressed as a function of @xmath8 .    the functions @xmath1 and @xmath8 are assumed to be normalized , i.e. @xmath9 and they are constrained by a degree detailed balance condition @xcite stating the physical conservation of edges among vertices : the total number of edges pointing from vertices with degree @xmath2 to vertices with degree @xmath7 must be equal to the number of edges that point from vertices @xmath7 to vertices @xmath2",
    ". there is an intuitive way to derive the degree detailed balance condition @xcite .",
    "let us denote by @xmath10 the number of vertices of degree @xmath2 .",
    "since @xmath11 , where @xmath0 is the size of the network , we can define the degree distribution as @xmath12 .",
    ", although , for the sake of simplicity , we will obviate the limit here and in the following . ] to completely define the network , we need to specify also how the different degree classes are connected . to this end",
    ", let us define the symmetric matrix @xmath13 , that gives the number of edges between vertices of degree @xmath2 and @xmath7 , for @xmath14 , and two times the number of self - connections for @xmath15 ( the number of connections between vertices in the same degree class ) .",
    "this matrix fulfills the identities @xmath16 where @xmath17 is the total number of edges in the network .",
    "this last identity allows to define the _ joint distribution _",
    "@xmath18 where the symmetric function @xmath19 is the probability that a randomly chosen edge connects two vertices of degrees @xmath2 and @xmath7 .",
    "the conditional probability , @xmath8 , defined as the probability that an edge from a @xmath2 vertex points to a @xmath7 vertex , can be easily written as @xmath20 from the symmetry of @xmath21 it follows immediately the degree detailed balance condition @xmath22 the joint distribution , @xmath21 , conveys all the information needed to construct a markovian random network .",
    "in fact , it is easy to see that @xmath23 this relation , together with eq .",
    "( [ condp ] ) , completely defines the network properties , i.e. @xmath1 and @xmath8 , as a function of the joint distribution @xmath21 .",
    "notice that eqs .",
    "( [ condp ] ) and  ( [ eq:1 ] ) define the degree distribution and the conditional probability in the whole @xmath2 range , except for @xmath24 .",
    "these values can be recovered by noticing that @xmath25 , and , from the normalization condition eq .",
    "( [ eq:2 ] ) , @xmath26    the empirical evaluation of @xmath21 ( or @xmath8 ) is , in most real networks , a quite difficult task , since the available data , restricted to finite sizes , usually yields results extremely noisy and difficult to interpret .",
    "for this reason , it is more useful for practical purposes to analyze instead the average degree of the nearest neighbors ( annd ) as a function of the vertex degree , defined by @xcite @xmath27 for uncorrelated networks , in which @xmath8 does not depend on @xmath2 , application of the normalization condition eq .",
    "( [ eq:2 ] ) into eq .",
    "( [ eq:3 ] ) yields @xmath28 . in this case , we obtain @xmath29 , independent of @xmath2 .",
    "therefore , a function @xmath30 with an explicit dependence on @xmath2 signals the presence of degree correlations in the network . based on the annd",
    ", it is possible to characterize the correlation properties of the network @xcite : when @xmath30 is an increasing function of @xmath2 , the network shows assortative mixing .",
    "examples of assortative behavior can be found in several social networks @xcite . on the other hand ,",
    "when @xmath30 is a decreasing function of @xmath2 , the network shows disassortative mixing , as found for example is technological systems such as the internet @xcite .",
    "correlations among three vertices can be measured by means of the probability @xmath31 that a vertex of degree @xmath2 is simultaneously connected to two vertices with degrees @xmath7 and @xmath32 . in the particular case of markovian networks , this function is related to the two vertices correlation through @xmath33 . for non markovian networks , however , the functions @xmath31 and @xmath8 are in principle not related .",
    "information about three vertices correlations can be obtained from the clustering coefficient .",
    "the concept of clustering in a graph refers to the tendency to form cliques ( complete subgraphs @xcite ) in the neighborhood of any given vertex . in this sense",
    ", clustering implies that if the vertex @xmath34 is connected to the vertex @xmath35 , and at the same time @xmath35 is connected to @xmath36 , then , with high probability , @xmath34 is also connected to @xmath36 .",
    "the probability that two vertices with a common neighbor are also connected to each other is called the _ clustering coefficient _ of the common vertex @xcite .",
    "numerically , the clustering coefficient , @xmath37 , of the vertex @xmath34 can be computed as the ratio between the number of edges existing between the @xmath38 neighbors of @xmath34 , @xmath39 , and its maximum possible value , @xmath40 , that is , @xmath41 on the other hand , the clustering coefficient of a vertex of degree @xmath2 , @xmath42 @xcite , can be formally computed as the probability that it is connected to vertices @xmath7 and @xmath32 , and that those two vertices are , on their turn , joined by and edge , averaged over all the possible values of the degrees of the neighbor vertices .",
    "therefore , we can write @xmath42 as a function of the three vertices correlations as @xmath43 where the function @xmath44 is the probability that the vertices @xmath7 and @xmath32 are connected . will in general depend on the particular network considered , and can also be a function of the degree @xmath2 of the common vertex . ]",
    "the quantity @xmath42 has been recently used to study the level of hierarchy and modularity in real complex networks @xcite .",
    "recently , caldarelli _ et al .",
    "_ @xcite and sderberg @xcite ( see also ref .",
    "@xcite ) have proposed different models of inhomogeneous random graphs that represents a natural generalization of the classical erds - rnyi random graph model @xcite .",
    "these models consider inhomogeneous graphs in which each vertex is characterized by a different _ type _ or _",
    "fitness_. types can be either discrete or continuous variables and are assigned to vertices according to a certain probability distribution .",
    "then , pairs of vertices are independently joined by an undirected edge with a probability depending on the type of the respective end points .",
    "this construction leads to an ensemble of undirected random networks , which inherits the simplicity of the erds - rnyi model while allowing freedom for general forms of the degree distribution and correlation structure .",
    "@xcite was mainly concerned with the component distribution and the onset of the giant component in this kind of models , and ref .",
    "@xcite reported numerical simulations for different model parameters , and analytical arguments for the form of the degree distribution .",
    "the models defined in refs .",
    "@xcite can be generalized as a class of models with _",
    "hidden variables_. the hidden variables play the role of tags assigned to the vertices , and they completely determine the topological properties of the network through their probability distribution and the probability to connect pairs of vertices .",
    "we define the class of models with hidden variables as follows : let us consider a set of @xmath0 disconnected vertices and a general hidden variable @xmath45 , that can be a natural or a real number .",
    "an undirected graph is generated by the following two rules :    1 .",
    "each vertex @xmath34 is assigned a variable @xmath46 , independently drawn from the probability distribution @xmath47 .",
    "2 .   for each pair of vertices @xmath34 and @xmath35 , with respective hidden variables @xmath46 and @xmath48 , an undirected edge is created with probability @xmath49 ( the _ connection probability _ ) , where @xmath50 is a symmetric function of @xmath45 and @xmath51 .",
    "given the independent assignment of hidden variables and edges among vertices , this procedure generates correlated random networks with neither loops nor multiple edges , which are markovian at the hidden variable level and whose degree distribution and correlation properties are encoded in the two functions @xmath47 and @xmath52 .",
    "here we will focus in the case in which the distribution @xmath47 is _ independent _ of the network size @xmath0 .",
    "the case in which @xmath47 is allowed to depend on @xmath0 will be considered in sec .",
    "[ sec : non - equil ] .    in this section",
    "we will provide analytic expressions for the correlation function and clustering coefficient of the networks generated with this class of models as a function of the distribution of hidden variables and the probability to connect pairs of vertices .",
    "the degree distribution , @xmath1 , is defined as the probability that any given vertex has @xmath2 edges attached to it .",
    "therefore , in order to compute it , we need to know the conditional probability @xmath53 ( propagator ) that a vertex with initial hidden variable @xmath45 ends up connected to other @xmath2 vertices .",
    "the degree distribution can then be written as @xmath54 where the summation sign must be exchanged by an integral for continuous @xmath45 .",
    "the propagator , which is obviously normalized , @xmath55 , provides full information about the dependence of the actual degree @xmath2 on the hidden variable @xmath45 .",
    "in particular , we can see that the average degree of the vertices with hidden variable @xmath45 , @xmath56 , is given by @xmath57 and the average degree can be expressed as @xmath58 on the other hand , the probability that a vertex of actual degree @xmath2 has associated a hidden variable @xmath45 , @xmath59 , can be computed as the inverse of the propagator by means of bayes formula @xcite , @xmath60    in order to get an explicit expression for the propagator , we start by noticing that it can be written as    @xmath61    where @xmath62 is the probability that a vertex with hidden variable @xmath45 ends up with @xmath38 connections with vertices of hidden variable @xmath46 , @xmath63 being the maximum value of @xmath45 . since the connections between vertices with hidden variables @xmath45 and @xmath51 are independently drawn with probability @xmath52 , the probability @xmath62 is simply given by a binomial distribution , i.e. @xmath64^{n_i - k_i},\\ ] ] where @xmath65 is the number of vertices with hidden variable @xmath46 .",
    "let us define now the generating function @xcite @xmath66 since the propagator is given by a convolution , eq .",
    "( [ eq:4 ] ) , we can write its generating function as the product of the generating functions of the partial propagators @xmath62 , which on their turn , being binomial distributions , yield @xmath67^{n_i}.\\ ] ] inserting this expression into the definition of @xmath68 and taking logarithms on both sides we are led to the equation @xmath69 . \\label{eq:5}\\ ] ] for general probabilities @xmath47 and @xmath70 , eq .",
    "( [ eq:5 ] ) must be solved and inverted in order to obtain the corresponding propagator .",
    "the degree distribution is then obtained applying eq .",
    "( [ eq:6 ] ) . even without solving the previous equation , however , it is already possible to obtain some information on the connectivity properties of the network . from the definition eq .",
    "( [ eq:26 ] ) , the first moment of @xmath53 is given by the first derivative of @xmath68 evaluated at @xmath71 .",
    "therefore we have @xmath72 and @xmath73 where we have used eq .",
    "( [ eq:5 ] ) in computing these expressions .    at this point",
    "we must consider the possibility of two different kinds of networks : sparse networks , with a well - defined thermodynamic limit for the average degree @xmath5 , and non - sparse networks , in which the average degree diverges with the network size . in the case of sparse networks",
    ", the number of edges grows linearly with the system size and , therefore , the joint distribution is a well defined quantity , independent of @xmath0 . in the opposite case ,",
    "non - sparse networks have a number of edges growing faster that linearly , which causes the breakdown of the thermodynamic limit and the emergence of the phenomenon of condensation of edges ( see sec .",
    "[ sec : intr - fitn - model ] ) . in order to distinguish between sparse and non - sparse networks we must consider the value of the average degree , given by eq .",
    "( [ eq:28 ] ) .",
    "if the density @xmath47 is independent of the size of the system , the only possibility to have a sparse network is that the connection probability scales as @xmath74 .",
    "this scaling behavior turns out to have a strong implication in the form of the propagator . defining @xmath75 ( as considered in ref .",
    "@xcite ) , where @xmath76 is a bounded symmetric function , independent of @xmath0 , we can expand the right - hand - side of eq .",
    "( [ eq:5 ] ) in the limit @xmath6 to obtain @xmath77 the generating function of the propagator is a pure exponential , which indicates that the propagator itself is a poisson distribution , @xmath78 where in this case @xmath79 .",
    "( [ eq:19 ] ) is , indeed , a strong result since is states the universality of the propagator for sparse networks regardless of the form of the connection probability .",
    "degree correlations are completely characterized by means of the conditional probability @xmath8 , that gives the probability that an edge emanating from a vertex of degree @xmath2 is connected to a vertex of degree @xmath7 . in order to construct the function @xmath8 we consider a vertex of degree @xmath2 , that with probability @xmath59 has associated a hidden variable @xmath45 .",
    "let us define @xmath80 the conditional probability that a @xmath45 vertex is connected to a @xmath51 vertex .",
    "then , the conditional probability @xmath8 can be written as @xmath81 where the propagator @xmath82 gives the probability that the @xmath51 vertex ends up with degree @xmath7 ( since one connection has already been used up for the conditional edge with @xmath45 ) .",
    "using the form of @xmath59 given by eq .",
    "( [ eq:34 ] ) we have @xmath83 valid for @xmath84 .",
    "in order to close eq .",
    "( [ eq:8bis ] ) , we need , finally , to provide an expression for the conditional probability @xmath80 . in order to do so",
    ", we consider that the probability of drawing an edge from @xmath45 to @xmath51 is proportional to the probability of finding an @xmath51 vertex , times the probability of creating the actual edge .",
    "taking into account normalization , we have that @xmath85 finally , using eqs .",
    "( [ eq:8bis ] ) and  ( [ eq:14 ] ) we can compute the annd as @xmath86 where we have defined the annd of a @xmath45 vertex ( see eq .  ( [ eq:7 ] ) ) as @xmath87      the clustering coefficient is defined as the probability that two vertices , adjacent to a third vertex , are also connected to each other . in the space of hidden variables , consider a @xmath45 vertex , which is connected to two other vertices @xmath51 and @xmath88 with probability @xmath89 .",
    "on the other hand , @xmath51 and @xmath88 are connected with probability @xmath90 .",
    "therefore , the clustering coefficient of a vertex @xmath45 in given by @xmath91 . note that this is the natural counterpart of eq .",
    "( [ eq:29 ] ) in the space of hidden variables .",
    "now , since the network is markovian at the hidden variable level , we have that @xmath92 .",
    "thus we have that @xmath93 the clustering coefficient of the vertices of degree @xmath2 , @xmath42 , will be given by the probability that a vertex @xmath2 has hidden variable @xmath45 , @xmath59 , times @xmath94 , averaged over all the possible values of @xmath45 .",
    "thus @xmath95 where we have used the form of @xmath59 given by eq .  ( [ eq:34 ] ) .",
    "the results derived in this section represent the general solution of the class of networks with hidden variables . in the rest of the paper",
    "we will show how this formalism is able to deal with a wide variety of models , from sparse to non - sparse networks , and from equilibrium to non - equilibrium ones .",
    "as an example of the general class of models with hidden variables , caldarelli _ et al . _",
    "@xcite considered the model defined by the probability distributions @xmath96 where @xmath97 is the heaviside step function and @xmath98 is a constant . in this model , hereafter referred to as the intrinsic fitness ( if ) model , vertices have assigned an exponentially distributed hidden variable ( fitness ) , and are joined by an edge whenever the sum of the fitness of the end points is larger than a given threshold @xmath98 . by means of numerical simulations and analytical arguments ,",
    "caldarelli _ et al . _",
    "@xcite showed that the degree distribution in this model is power - law distributed .",
    "this observation led to the very interesting conclusion that it is possible to generate scale - free networks without growth not preferential attachment @xcite .      using the general formalism developed in the previous section",
    ", we can provide analytic expressions for the main properties of the if model . in order to do so ,",
    "let us compute in the first place the propagator @xmath53 . inserting eqs .",
    "( [ eq:9 ] ) and  ( [ eq:10 ] ) into eq .",
    "( [ eq:5 ] ) , we have , substituting the summation by an integral ,    @xmath99 = n \\ln z \\begin{cases }                                   e^{h -\\zeta } & \\mathrm{if } \\ ; 0 \\leq h \\leq \\zeta \\\\                                   1 & \\mathrm{if } \\ ; h > \\zeta                                   \\end{cases},\\ ] ]    from where we obtain @xmath100 for @xmath101 , and @xmath102 for @xmath103 . in order to invert this generating function ,",
    "we approximate @xmath2 by a continuous variable . in this case",
    ", the propagator takes the simple form @xmath104 where @xmath105 is the dirac delta function and we have introduced the window function @xmath106 this approximation is expected to perform poorly for small values of @xmath2 , as we will see when comparing the analytical results with computer simulations of the if model .    inserting the propagator eq .",
    "( [ eq:11 ] ) into the general expression eq .",
    "( [ eq:6 ] ) , and performing the integrals corresponding to the dirac delta functions , we obtain the degree distribution @xmath107 that is , the networks generated by the if model exhibit a scale - free degree distribution , with degree exponent @xmath108 , for degrees in the range @xmath109 , plus an accumulation point at @xmath110 , given by the delta function , with weight @xmath111 .",
    "this accumulation point signals the presence of a _ condensation _ of edges in the fraction @xmath111 of the vertices of the network with @xmath112 , that establish connections to all the other vertices @xcite .",
    "this condensation , reminiscent to that observed in models with non - linear preferential attachment @xcite , is the result of the non - sparse nature of the network , that , from eq .",
    "( [ eq:28 ] ) , has average degree @xmath113 .    in order to characterize the correlations of the model",
    ", we compute the annd , given by eq .",
    "( [ eq:13 ] ) . in the continuous @xmath2 approximation",
    ", the function @xmath56 takes the form @xmath114 inserting this expression into the formula for the annd , we obtain @xmath115\\ ] ] the regular part of this expression ( discarding the delta function singularities , signaling again the effect of the condensation of edges in the correlation function ) takes the form @xmath116",
    "\\theta_k(n e^{-\\zeta } , n).\\ ] ] that is , the regular part of the annd is proportional to @xmath117 , times a logarithmic correction term .",
    "we are therefore in the presence of disassortative mixing .",
    "note that , in the limit @xmath6 , we have that @xmath118 , in agreement with the theoretical prediction made in ref .",
    "@xcite .",
    "finally , to estimate the clustering coefficient , we have to compute first the conditional probability at the level of hidden variables , given by eq .",
    "( [ eq:14 ] ) . using eqs .",
    "( [ eq:9 ] ) and  ( [ eq:10 ] ) , we obtain @xmath119.\\ ] ] from this expression we can obtain the clustering coefficient at the level of the hidden variables @xmath120 and the clustering coefficient as a function of the degree @xmath2 , @xmath121   \\theta_k(ne^{-\\zeta/2 } , n )    \\nonumber\\\\    & & + \\frac{1}{p(k ) } e^{-2\\zeta } ( \\zeta+1 ) \\delta(k - n).\\end{aligned}\\ ] ] the regular part of this formula is finally @xmath122   \\theta_k(ne^{-\\zeta/2 } ,    n).\\ ] ] that is , for @xmath123 the clustering coefficient is constant and equal to its maximum possible value @xmath124 .",
    "the presence of this flat region in the clustering coefficient is easy to understand .",
    "the degree range @xmath123 corresponds , from eq .",
    "( [ eq:30 ] ) , to vertices with fitness @xmath125 .",
    "these vertices can only establish connections with vertices with @xmath126 , which are on their turn fully interconnected among them . from here",
    ", it follows a maximum clustering coefficient equal to @xmath124 for all vertices with @xmath125 . on the other hand , for @xmath127 , the clustering coefficient decreases as @xmath128 , modulated again by a logarithmic correction term .      in order to check the validity of the proposed analytical expressions ,",
    "we have performed numerical simulations of the if model . to simplify the comparison , we have considered the particular case @xmath129 , in which the relevant expressions take the form : @xmath130   \\theta_k(1 ,    n)\\label{eq:16}\\\\     \\bar{c}^r(k ) & = & \\theta_k(1 , n^{1/2 } ) + \\frac{2 n}{k^2 } \\left[\\ln       \\left ( \\frac{k}{n^{1/2 } } \\right)+ \\frac{1}{2 } \\right ]     \\theta_k(n^{1/2 } , n)\\label{eq:17}\\end{aligned}\\ ] ] simulations were performed for networks of size @xmath131 ( corresponding to @xmath132 ) , averaging all statistical distributions over @xmath133 to @xmath134 network realizations .    in fig .",
    "[ fig : pk ] we depict the results corresponding to the degree distribution .",
    "as we can see , the theoretical prediction ( solid line ) overestimates the value of the actual degree distribution for small @xmath2 .",
    "this is a natural effect of the continuous @xmath2 approximation , that can be readily understood from the form of eq .",
    "( [ eq:15 ] ) : the form @xmath135 can not be correct in a discrete approximation , since it does not fulfill the normalization condition .",
    "the condensation of edges at @xmath110 is clearly visible in the presence of an isolated peak , of height approximately equal to @xmath74 .",
    "[ fig : knn ] and  [ fig : ck ] , on the other hand , represent the annd and the clustering coefficient as a function of the degree @xmath2 , respectively .",
    "as we can see , the fit between the computer simulations and the analytical expressions is quite good .",
    "the hidden variable class of models represents a natural extension of the erds - rnyi random graph model , that allows to generate a broad class of correlated networks from which it is possible to compute the most relevant topological properties . from a practical point of view",
    ", however , it is still missing an important point .",
    "indeed , there are many situations in which it is desirable to generate a network with a particular correlation structure given by a certain joint distribution @xmath136 . for a hidden variable model it is possible to compute this quantity as a function of the initial probabilities @xmath47 and @xmath52 . however , this relation is non - trivial , and it is generally not possible to invert it .",
    "therefore , in order to implement an algorithm capable to generate networks with any _ a priori _ correlation structure one must carefully choose the distribution of hidden variables and the connection probability .",
    "one possible way to proceed is to define hidden variables @xmath45 that have themselves the structure of the degrees of a real network ( _ hidden degrees _ ) , with correlations given by a joint distribution @xmath137 .",
    "those hidden degrees will then be natural numbers , that are assigned to the vertices according to the probability distribution ( see eq .",
    "( [ eq:1 ] ) ) @xmath138 with @xmath139 . in order to define the connection probability , we consider that , if the hidden degrees were the actual degrees characterizing the network , then the total number of edges between vertices @xmath45 and @xmath51 would be @xmath140 .",
    "since the total number of @xmath45 vertices is @xmath141 , it is therefore natural to define @xmath142 on the other hand , the conditional probability that a vertex @xmath45 is connected to a vertex @xmath51 is given by ( see eq .",
    "( [ condp ] ) ) @xmath143 the quantities @xmath47 and @xmath80 will be , in this case , related through the hidden degree detailed balance condition , @xmath144 as can be checked by inserting into the definition of @xmath80 , eq .",
    "( [ eq:14 ] ) , the expression eq .",
    "( [ eq:18 ] ) .",
    "it is interesting to note that , if two - point correlations are absent at the level of the hidden variables , then we have that @xmath145 .",
    "thus , the connection probability reads @xmath146 recovering the model recently introduced by chung and lu @xcite ( see also ref .",
    "@xcite ) .    assuming that the connection probability is bounded and decreases for large network sizes as @xmath74",
    ", we can compute the propagator @xmath53 applying eq .",
    "( [ eq:19 ] ) with @xmath147 , where we have used eq .",
    "( [ eq:18 ] ) .",
    "therefore , the propagator is a simple poisson distribution , with average value @xmath45 , i.e. @xmath148 note that the validity of this result levers on a quite strong assumption for the boundedness of the connection probability @xmath149 .",
    "the nature of this condition is more clearly seen in the case of uncorrelated networks , with @xmath150 .",
    "if @xmath151 has to decrease as @xmath74 , then the maximum value of the hidden degree must be smaller than @xmath152 @xcite , a condition that imposes restrictions on the maximum degree available for any vertex .    from the propagator eq .",
    "( [ eq:20 ] ) , the degree distribution as a function of @xmath47 follows immediately from eq .",
    "( [ eq:6 ] ) : @xmath153 this relation between distributions implies a relation between the respective moments .",
    "indeed , it is straightforward to prove that @xmath154 and , in particular , the first two moments read @xmath155 it is also instructive to see how we can recover the classical erds - rnyi random graph model from this formalism",
    ". the erds - rnyi model corresponds to joining pairs of vertices with a constant probability @xmath156 .",
    "such connection probability results from imposing uncorrelated hidden degrees with distribution @xmath157 , which yields a poisson degree distribution with average degree @xmath5 .    in order to compute the annd function from eq .",
    "( [ eq:13 ] ) , we observe that in this case @xmath158 .",
    "from here we obtain @xmath159 where , in this case , the average hidden degree of the nearest neighbors as a function of @xmath45 ( see eq .",
    "( [ knnhidden ] ) ) is @xmath160 for uncorrelated networks at the hidden level , the annd yields @xmath161 recovering the well - known result @xcite .",
    "finally , the clustering coefficient takes , from eq .",
    "( [ eq:8 ] ) , the form @xmath162 where the clustering coefficient in terms of the hidden degrees is given by    @xmath163    when correlations are missing in the hidden degree distribution , we obtain @xmath164 recovering the result previously derived by newman @xcite .",
    "the key point to notice in the above expressions is that the poisson propagator eq .",
    "( [ eq:20 ] ) is a sharply peaked function at @xmath165 , that in the large @xmath2 limit is analogous to a delta function @xmath166 .",
    "therefore , in the limit @xmath167 , we expect to observe the behavior @xmath168 that is , the main topological properties referred to the actual degree @xmath2 tend to their analogs computed for the hidden degree @xmath45 , with the sole exception of a constant of order unit added to the annd function .",
    "we can take advantage of this observation to propose the following algorithm to generate a correlated random network with theoretical degree distribution @xmath169 and joint distribution @xmath170 :    1 .",
    "assign to each vertex @xmath34 an integer random variable @xmath171 , @xmath172 , drawn from the probability distribution @xmath169 .",
    "2 .   for each pair of vertices @xmath34 and @xmath35 , draw an undirected edge with probability @xmath173 .    the outcome of this process will be a random network whose actual degree structure , in the large @xmath2 limit , will be distributed according to the probability @xmath169 , with correlations given by @xmath170 .    in order to check the accuracy of the previous algorithm ,",
    "we have tested it with the joint probability distribution @xmath174 where @xmath175 is a normalization constant and @xmath176 is a constant parameter . with this choice , the degree distribution takes the form @xmath177 which , for @xmath178 , approaches a power - law distribution with exponent @xmath108 . in figs .",
    "[ fig : pkex ] , [ fig : knnex ] , and  [ fig : ckex ] we present the results for the degree distribution , the annd function , and the clustering coefficient , respectively , from computer simulations of the proposed algorithm , using the joint probability distribution given by eq .",
    "( [ eq:22 ] ) .",
    "the plots have been obtained for networks of size @xmath131 and a parameter @xmath179 , averaging over @xmath133 realizations . in the same graphs",
    "we also represent the theoretical values corresponding to a network with a correlation structure given by @xmath180 , plus the transformed functions given by eqs .",
    "( [ eq:23 ] ) , ( [ eq:24 ] ) , and  ( [ eq:25 ] ) , respectively , that correspond to the actual topological properties of the network . as discussed previously , and to ease the comparison of the plots , a factor @xmath124 has been subtracted to the annd function obtained from computer simulations and the transformation eq .",
    "( [ eq:24 ] ) .",
    "we can see that for all three quantities , the matching between the computer simulations and the theoretical results is very good for values of @xmath2 larger than @xmath181 .",
    "being the discrepancy limited to such small degree values , we conclude that the proposed algorithm reproduces the desired correlation structure with an accuracy that is more that satisfactory for any purpose dealing with the large scale properties of the network .",
    "the class of models we have introduced so far are static models , in which , starting from a fixed number @xmath0 of vertices , edges are assigned with a given probability . as we have seen",
    ", this construction is extremely useful because it gives us control over the final network structure and , at the same time , the possibility to calculate important structural properties .",
    "many real networks , however , are far from being static . instead , many of them are the result of an evolving process @xcite , in which vertices are added to the network following some growing process ( lineal , exponential , etc . ) , establishing connections to other existing vertices with a given attachment rule ( preferential attachment @xcite , deactivation of vertices @xcite , etc ) . from this growing mechanism",
    "the network reaches a non - equilibrium steady state where the statistical properties are time independent .    in the following",
    "we will see how it is possible to map non - equilibrium growing networks into a particular kind of models with hidden variables .",
    "the key point is to realize that , after the growth of the network , all vertices that joined the network at the same time are statistical equivalent and , thus , the hidden variable of a vertex must correspond to its injection time , @xmath182 @xcite .",
    "we consider a time window @xmath183 $ ] , with @xmath184 , in which the initial time can be taken @xmath185 without lack of generality .",
    "if @xmath186 is the rate of creation of new vertices per unit time the network size is given by @xmath187 .",
    "in this case , the density of hidden variables , @xmath188 , is a uniform distribution defined in the range @xmath189 $ ] , that is , @xmath190 , reflecting the linear growth of the network . the main difference between this class of non - equilibrium networks and the classes discussed in the previous sections lies in the fact that the distribution @xmath191 has now an explicit dependence on the system size @xmath0 ( or the final time @xmath192 ) .",
    "the next step is to define the connection probability of two vertices that joined the network at times @xmath182 and @xmath193 , @xmath194 .",
    "the choice of this function is equivalent to the connection probability at the time that the vertices were added and its specific form will determine the final properties of the network .",
    "for instance , an homogeneous form for @xmath194 , that is , @xmath195 , will produce , in the large @xmath192 limit , networks in which all the vertices will have the same statistical properties , independent of the injection time . in the opposite case of inhomogeneous networks , vertices introduced at early times",
    "will have different topological properties than those added later , giving rise to _ aging _ ( that is , an explicit dependence on the injection time @xmath182 of all the vertex properties evaluated at time @xmath196 ) .    in order to provide a particular example , we focus on the class of growing scale - free networks , whose most characteristic element is the barabsi - albert model @xcite . from general scaling arguments",
    "@xcite , it is possible to see that growing scale - free networks are described by a power - law degree distribution @xmath3 , while the average degree at time @xmath182 of a vertex introduced at time @xmath193 is given by @xmath197 where the exponents @xmath198 and @xmath4 fulfill the scaling relation @xmath199 in the barabsi - albert model , corresponding to @xmath200 and @xmath201 , new edges are joined to old vertices following a preferential attachment prescription , that is , with probability proportional to the degree of the existing vertices .",
    "we can generalize this prescription and consider a preferential attachment as a function of the time @xmath182 , mapping the degree to the time by means of eq .",
    "( [ degreeba ] ) . in this case , however , when a new vertex is added at time @xmath182 , it can establish connections with nodes introduced between @xmath124 and @xmath182 and , consequently , the connection probability is to be rescaled by a factor @xmath202 , that is proportional to @xmath182 .",
    "therefore , the probability that a new vertex , created at time @xmath182 , will be joined to a vertex injected at time @xmath203 , is proportional to @xmath204 .    following this reasoning we propose a connection probability as a function of the times @xmath182 and @xmath193 given by @xmath205 , \\label{eq:35}\\ ] ] where @xmath206 is a parameter that controls the final average degree of the network .",
    "the connection probability has been symmetrized for @xmath182 and @xmath193 to comply with the general conditions of this function .",
    "its symmetric property , however , does not imply that the average properties of the vertices are independent of @xmath182 .",
    "for example , computing the average degree of a @xmath182 vertex ( introduced at time @xmath182 ) , evaluated at the final time @xmath192 , using eq .",
    "( [ eq:31 ] ) , we obtain , @xmath207 , should not be confused with @xmath208 , that measures the average degree of the same vertex at an intermediate time @xmath209 . ]",
    "@xmath210 for large @xmath192 , we have @xmath211 , recovering the behavior obtained in growing network models , eq .",
    "( [ degreeba ] ) , if we consider the time @xmath192 as the observation time . on the other hand",
    ", @xmath207 is a decreasing function of @xmath182 between the limits @xmath212 , yielding @xmath213 , and @xmath214 , where it converges to the constant @xmath215 .",
    "this functional form implies that the oldest vertices ( with smaller @xmath182 ) have a larger average degree , which is the signature of aging in the network @xcite .    from eq .",
    "( [ eq:28 ] ) , the average degree of the network can be computed as @xmath216 that , in the limit of large @xmath192 and @xmath217 , tends to @xmath218 , from where we identify the normalization parameter @xmath206 as a function of the average degree . for @xmath219 , on the other hand , the average degree diverges as @xmath220 .",
    "note that this choice of the connection probability , independent of the network size , yields for @xmath217 a sparse network ( with finite average degree in the thermodynamic limit ) , in opposition with the case discussed in sec .",
    "[ sec : hidd - vari - models ] .",
    "this fact is due to the explicit dependence on @xmath0 of the distribution of times @xmath191 , and signals the crucial difference of non - equilibrium networks with hidden variables .    in order to obtain the form of the degree distribution",
    ", we observe that , even though the network is sparse , since @xmath221 is not proportional to @xmath74 we can not rigorously apply eq .",
    "( [ eq:19 ] ) .",
    "however , we note that the maximum value of @xmath222 takes place at @xmath223 , namely @xmath224 for not very large values of @xmath5 and large @xmath182 , the connection probability is bounded by an small value , and therefore we can still approximate its propagator by means of eq .",
    "( [ eq:19 ] ) . working for simplicity with the generating function of the degree distribution , @xmath225",
    ", we therefore write , from eq .",
    "( [ eq:32 ] ) , @xmath226 performing the change of variables @xmath227 , and considering the limit @xmath228 , we obtain    @xmath229    & = &   \\left [      \\frac{\\alpha \\lambda}{\\beta } ( 1-z ) \\right]^{1/ \\beta } \\frac{\\gamma(-1/ \\beta , \\alpha \\lambda      ( 1-z ) / \\beta)}{\\beta } \\exp\\left\\{\\frac{\\alpha \\lambda ( 2\\beta-1)(z-1 ) } { \\beta ( 1-\\beta)}\\right\\},\\end{aligned}\\ ] ]    where @xmath230 is the incomplete gamma function .",
    "expanding @xmath231 around @xmath71 , we obtain the leading terms @xmath232 applying tauberian theorems @xcite , it follows from the singularity @xmath233 in the vicinity of @xmath71 , the large @xmath2 behavior of the degree distribution , namely @xmath234 .",
    "that is , the model recovers a scale - free network , @xmath3 , with a degree exponent @xmath235 , and a cut - off given by the maximum degree @xmath236 , in agreement with the results obtained for growing network models @xcite .    in order to check this result ,",
    "we have numerically generated networks of size @xmath237 , with the connection probability eq .",
    "( [ eq:35 ] ) . for a rate of addition of new vertices",
    "@xmath238 , the numerical prefactor in @xmath221 is @xmath239 ; we impose @xmath240 .",
    "[ fig : simsnoneq ] shows the numerical cumulated degree distributions obtained for values @xmath241 , @xmath242 , and @xmath243 .",
    "the plots show a clear power - law behavior in all three cases , with a degree exponent , estimated from a linear fit in the scaling region , given by @xmath244 , @xmath245 , and @xmath246 , respectively .",
    "this values compare very well with the theoretical prediction @xmath247 , that provides the expected exponents @xmath248 , @xmath249 , and @xmath250 .",
    "the annd function , @xmath30 , can also be analyzed using our formalism . by means of eq .",
    "( [ eq:13 ] ) , assuming a poisson form for the propagator , we can define the generating function @xmath251 $ ] , that takes the form @xmath252 from where it is possible to derive the large @xmath2 limit of the annd .",
    "we are primary interested in the case @xmath253 , that is , the scale - free range of the model . focusing in @xmath254 , the limit @xmath255 of eq .",
    "( [ knn ] ) is @xmath256 where we have used the same change of variables as before .",
    "an expansion of this equation around @xmath71 leads to @xmath257 applying again tauberian theorems , we can write that , in the large @xmath2 limit , @xmath258 from where it is straightforward to derive the large @xmath2 limit of the annd : @xmath259 the case @xmath200 is very similar to the previous one , except for the type of divergence with the system size appearing as a prefactor . in the large @xmath192 limit",
    ", we can write @xmath260 using the same arguments we conclude that the right hand side of this equation scales as @xmath128 and , therefore , the annd converges to a constant value proportional to @xmath261 .",
    "in this paper we have analyzed in detail a general class of complex network models which are based on the existence of a hidden space , in which vertices are located , and a connection probability that depends on the hidden variable of each vertex .",
    "the markovian character at the hidden level allows to calculate analytical expressions for the most important structural properties , such as degree distribution , the annd function  quantifying two vertices correlations  and clustering coefficient , as a measure of three vertices correlation .",
    "our formalism is valid for both sparse and non - sparse networks , extending the applicability of our results to a wide range of complex networks . at this respect ,",
    "one of the applications of our formalism is to provide the analytical solution of a recently introduced model with intrinsic fitness , which has recently attracted a great deal of interest as a way to obtain scale - free networks without preferential attachment .",
    "our solution has been successfully contrasted with numerical simulations , thus validating the accuracy of our formalism .",
    "another interesting result of our analysis is to provide a new algorithm for generating correlated random networks with an _ a priori _ specified correlation structure . in this case",
    ", we also calculate exact formulas for the relevant quantities .",
    "we have tested the algorithm using a probe joint distribution @xmath21 , with very encouraging results .",
    "perhaps the most striking result concerns the application of the formalism to growing networks . even though , in this case , the network is out of equilibrium",
    ", it is possible to map it to a specific kind of hidden variables model by the identification of the injection time as the hidden variable . in order to check this point",
    "we have applied the method to a general class of growing networks , which , as a particular case , contains the barabsi - albert model .",
    "using our formalism , we have recovered all the known results for this models , both for the degree distribution and the correlation structure .",
    "it is remarkable that , from a static approach , our formalism is able to derive correct results for non - equilibrium evolving networks . therefore , this approach opens a novel and appealing way to study such systems .",
    "we thank g. caldarelli , m. a. muoz , and a. vespignani for helpful comments and discussions .",
    "this work has been partially supported by the european commission - fet open project cosin ist-2001 - 33555 .",
    "r.p .- s . acknowledges financial support from the ministerio de ciencia y tecnologa ( spain ) ."
  ],
  "abstract_text": [
    "<S> we study a class models of correlated random networks in which vertices are characterized by _ </S>",
    "<S> hidden variables _ controlling the establishment of edges between pairs of vertices . </S>",
    "<S> we find analytical expressions for the main topological properties of these models as a function of the distribution of hidden variables and the probability of connecting vertices . </S>",
    "<S> the expressions obtained are checked by means of numerical simulations in a particular example . </S>",
    "<S> the general model is extended to describe a practical algorithm to generate random networks with an _ a priori _ specified correlation structure . </S>",
    "<S> we also present an extension of the class , to map non - equilibrium growing networks to networks with hidden variables that represent the time at which each vertex was introduced in the system . </S>"
  ]
}