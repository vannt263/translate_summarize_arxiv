{
  "article_text": [
    "an extension of the theory of variational integrators @xcite to nonholonomic systems was proposed by corts and martnez @xcite by introducing a discrete version of the lagrange - dalembert principle ( dla ) .",
    "their approach requires the definition of two objects .",
    "the first of them is the _ discrete lagrangian _ @xmath0 which is a real valued function on the cartesian product @xmath2 , where @xmath3 is the configuration space .",
    "the second object involved in their discretisation is the _ discrete constraint space _ @xmath1 which is a submanifold of @xmath2 that is the discrete counterpart of the non - integrable distribution @xmath4 defined by the nonholonomic constraints .",
    "the discrete dynamics defined by the dla algorithm are sensitive to the choice of the discrete lagrangian @xmath0 and the discrete constraint space @xmath1 .",
    "while there is no recipe to construct these objects , corts and martnez suggest that they should be constructed in a _ consistent _ manner with respect to a _ finite difference map _ ( rigorous definitions for these concepts are given in  [ ss : diffmaps ] ) .",
    "more precisely , in remark 3.1 of their article they state without proof : `` to guarantee that the dla algorithm approximates the continuous flow within a desired order of accuracy , one should select the discrete lagrangian @xmath0 and the discrete constraint space @xmath1 in a consistent way '' .",
    "similar statements appear in other sources like @xcite , @xcite .",
    "the use of consistent discretisations is also suggested in @xcite,@xcite , @xcite .",
    "the goal of this paper is to examine the importance of the consistency condition by considering in detail the performance of two different discretisations of the classical nonholonomic suslov problem , only one of which is consistent .",
    "recall that the suslov problem @xcite is a simple example of a nonholonomic system that can be realised physically and that exhibits some of the main features that distinguish nonholonomic from hamiltonian systems , like the non - existence of a smooth invariant measure , and the presence of attracting and repelling periodic orbits on the energy level sets of the system .",
    "our analysis of the performance of the two integrators focuses on the calculation of their local truncation errors , on a discussion of their energy - preservation properties , and on the execution of numerical experiments .",
    "our results , explained in more detail below , indicate that the consistent discretisation does not perform better than the other in any of the aspects described above .",
    "our research suggests that consistency is not the most relevant property to consider in order to construct geometric integrators for nonholonomic systems with an enhanced behaviour .",
    "the configuration space for the suslov problem is the lie group @xmath5 , and both the lagrangian and the constraints are invariant with respect to left multiplication on @xmath6 , making the problem into a classical example of an _ ll - system_. the reduced dynamics takes place on the reduced velocity phase space , which is the two - dimensional subspace @xmath7 of the lie algebra @xmath8 that defines the constraint distribution at the group identity , and is governed by the _ euler - poincar - suslov _ equations .    both of the discretisations that we consider fall into the scheme proposed by fedorov and zenkov @xcite in which the discrete objects @xmath0 and @xmath1 are chosen to be invariant with respect to the diagonal left multiplication of @xmath6 on @xmath9 . as a consequence , the discrete constraint space @xmath10 is determined by a _",
    "discrete displacement subvariety _",
    "@xmath11 which is the discrete version of the reduced velocity phase space @xmath12 .",
    "similarly , the discrete lagrangian @xmath0 is determined by a reduced discrete lagrangian @xmath13 . the discrete dynamics on @xmath1 drop to @xmath14 and define _ discrete euler - poincar - suslov _ equations .    in our analysis",
    "we define the discrete displacement subvariety @xmath14 as the image of @xmath7 under the _ cayley transform_. this definition of @xmath14 is reminiscent of the work in @xcite , where @xmath14 is chosen as the image of @xmath7 under the exponential map .",
    "in fact , as we explain in  [ s : l1 ] , both approaches to define @xmath14 are equivalent since the images of @xmath7 under the cayley and the exponential map coincide on an open dense subset of @xmath15 that contains the identity .",
    "the advantage to consider the cayley transform over the exponential map is that the inverse transformation can be explicitly written down as a rational map from @xmath15 to @xmath16 .",
    "moreover , in our work , we interpret this inverse map as a ( reduced ) difference map @xmath17 which we use to define a reduced discrete lagrangian that we denote by @xmath18 which can be explicitly computed ( here and in what follows @xmath19 is the time step ) .",
    "the discretisation of the suslov problem resulting from the choice of @xmath14 and @xmath18 is consistent with respect to @xmath17 .",
    "an alternative choice of the ( reduced ) discrete lagrangian is the one considered by moser and veselov in their celebrated discretisation of the free rigid body @xcite .",
    "we denote this discrete lagrangian by @xmath20 .",
    "the discretisation of the suslov problem resulting from the choice of @xmath14 and @xmath20 is a reparametrisation of the one considered by fedorov and zenkov in @xcite and , as we show in proposition [ p : nonconsistent ] , it is _ not _ consistent .      in order to compare the discrete and the continuous ( reduced ) flows on a common space ,",
    "it is necessary to pass to the momentum phase space @xmath21 . at the continuous level , this passage is defined by the inertia tensor of the body @xmath22 which is interpreted as a linear isomorphism between @xmath16 and @xmath21 .",
    "the image @xmath23 is a two - dimensional subspace of @xmath21 that is the reduced momentum phase space for the continuous euler - poincar - suslov equations .    at the discrete level",
    "one defines the _ discrete legendre transformation _ @xmath24 as the right trivialisation of the derivative of @xmath25 .",
    "the discrete euler - poincar - suslov dynamics in momentum variables takes place in _ the momentum locus _ @xmath26 which is a nonlinear , possibly non - smooth , subvariety of @xmath21 .",
    "since the definition of the momentum locus involves the discrete reduced lagrangian , the momentum loci @xmath27 and @xmath28 , defined respectively by @xmath20 and @xmath18 , are different .",
    "the two discretisations of the suslov problem introduced above , give rise to discrete evolution maps @xmath29 and @xmath30 defined respectively on @xmath27 and @xmath28 that approximate the continuous euler - poincar - suslov equations on @xmath31 , provided that the time step @xmath32 is sufficiently small .",
    "we obtain asymptotic expansions for @xmath29 and @xmath30 as @xmath33 , that allow us to conclude that the local truncation error in both cases is of second order ( theorems [ t : accuracymosves ] and [ t : accuracycayley ] ) .",
    "as reported in @xcite , the non - consistent discretisation , whose reduced constrained lagrangian is @xmath20 , defines a multi - valued map that exactly preserves the energy of the system .    on the other hand ,",
    "the consistent discretisation corresponding to @xmath18 defines a multi - valued map that only preserves the energy of the system if a certain , non - generic , condition on the inertia tensor of the body holds .",
    "in  [ simulations ] we present a series of work - precision diagrams that illustrate the convergence of both discrete systems to the continuous one as the time step @xmath34 .",
    "the only advantage that results by working with the consistent discretisation is that the resulting algorithm is well - defined for larger values of @xmath32 .",
    "however , for a sufficiently small time step , the non - consistent discretisation appears to give a better approximation of the continuous flow .",
    "the paper is structured as follows : in  [ preli ] we quickly recall the necessary ingredients for our developments and we give the definitions of finite difference maps and of consistency of a discretisation .",
    "we also consider equivariant finite difference maps for systems on lie groups and we give a characterisation of consistency in this special case . in  [ suspro ]",
    "we review the main aspects of the suslov problem and we give a taylor expansion of its solutions that is later used to compute the local truncation error of the discretisations . in  [ s : pade ] we define the two different discretisations of the suslov problem and show that only one of them is consistent . in  [ s : req1 ] ( respecively ,  [ s : reqinfty ] ) we give working formulae for the discrete algorithm of the non - compatible ( respectively compatible ) discretisation and show that the local truncation error in the approximation of the continuous flow is second order . in ",
    "[ s : energy ] we discuss the preservation of energy for both discretisations and in  [ simulations ] we present some numerical results .",
    "the main conclusions of the paper are given in ",
    "[ s : conclusions ] . finally , we present an appendix that shows that the momentum loci defined by both discretisations are contained in the zero level sets of certain polynomials .",
    "a nonholonomic system on an @xmath35 dimensional configuration manifold @xmath3 is determined by the triple @xmath36 .",
    "here @xmath37 is a non - integrable _ constraint distribution _ over @xmath3 of constant rank that at each @xmath38 defines an @xmath39-dimensional subspace @xmath40 .",
    "a curve @xmath41 on @xmath3 satisfies the nonholonomic constraints if @xmath42 at all time @xmath43 .",
    "the lagrangian function @xmath44 is of the form kinetic energy minus potential energy , @xmath45 , where @xmath46 defines a riemannian metric on @xmath3 and @xmath47 .",
    "the equations of motion are obtained via the lagrange - dalembert principle of ideal constraints . in local coordinates , it leads to    [ ldaeqs ] @xmath48    in the above equations @xmath49 are any set of @xmath50 independent one - forms on @xmath3 whose joint annihilator is @xmath37 , and the scalars @xmath51 , that specify the reaction forces , are sometimes called lagrange multipliers and are uniquely determined by the constraints . since the constraints are ideal , the energy @xmath52 is conserved along the flow . for more details",
    "we refer to @xcite .",
    "discretisations of the lagrange - dalembert principle for nonholonomic systems have been introduced in @xcite as an extension of variational integrators ( see @xcite and references therein for more details in this last topic ) . according to these references",
    ", the discretisation of the nonholonomic system @xmath36 requires the construction of a _ discrete lagrangian _ and a _",
    "discrete constraint space _ @xmath53 . in the following definition we emphasise",
    "the role of the time step which is important for our purposes .",
    "[ discnhset ] a discretisation of the nonholonomic system @xmath54 is given by a time step @xmath19 and a pair @xmath55 where :    1 .",
    "the discrete constraint space @xmath1 is a submanifold of @xmath2 of dimension @xmath56 with the additional property that @xmath57 and , moreover , for all @xmath58 @xmath59 2 .",
    "@xmath60 is the discrete lagrangian .",
    "[ rm : disclag ] the discrete lagrangian in the definition is taken as an approximation of the action functional over a time interval of length @xmath32 , say @xmath61 , where the curve @xmath41 satisfies @xmath62 , see e.g. @xcite .",
    "the dependence of @xmath63 on @xmath32 is not made explicit in @xcite , @xcite , @xcite and @xcite .",
    "condition is required so that the discrete constraint space @xmath1 is a consistent approximation of the constraint distribution @xmath37 .",
    "it is tacitly assumed in @xcite and a particular case of it is mentioned in @xcite .    the _ discrete lagrange - dalembert principle _ ( dla ) defined by corts and martnez in @xcite yields the set of discrete nonholonomic equations    [ dla ] @xmath64    here , just as in , the independent one - forms @xmath65 are an arbitrary basis of the annihilator of @xmath37 . at each step , the multipliers @xmath66 appearing in are determined by the condition . under certain technical conditions ,",
    "the above is a well defined algorithm for the discrete approximation of the solutions of ; see @xcite for details . for generalisations of discrete nonholonomic systems ,",
    "see @xcite .",
    "the performance of a dla nonholonomic integrator will depend on the choice of the pair @xmath55 .",
    "a possibility to construct them is to use _ finite difference maps _ @xcite .",
    "[ d : fdm]@xcite a _ finite difference map _",
    "@xmath67 is a diffeomorphism @xmath68 , where @xmath69 is a neighbourhood of the diagonal @xmath70 in @xmath2 and @xmath71 denotes a neighbourhood of the zero section of @xmath72 which satisfies the following    1 .",
    "@xmath73 is the zero section of @xmath72 ; 2 .   @xmath74 ; and 3 .   along the diagonal @xmath70",
    "we have @xmath75    where @xmath76 is the bundle projection and @xmath77 , @xmath78 are the projections from @xmath2 to @xmath3 .    a simple example of a finite difference map with time step @xmath32 if @xmath79 is given by @xmath80    with a finite difference map at hand , one can define the discrete lagrangian @xmath81 by @xmath82 that is the simplest quadrature approximation of the action @xmath83 .    following the discussion in @xcite ,",
    "we make the following definition .",
    "[ d : consistency ] the discrete nonholonomic system defined by the pair @xmath55 is _ consistent with respect to the finite difference map @xmath67 _ if holds and @xmath84 .",
    "in remark 3.1 of @xcite the authors claim that consistency is a necessary condition to guarantee approximation of the continuous flow to a desired level of accuracy .",
    "the main contribution of this paper is to examine the validity of this statement by treating in detail a concrete example .",
    "we will examine two different discretisations of the suslov problem .",
    "only one of them is consistent , but they both lead to discrete algorithms having local truncation errors of the same order .",
    "our results indicate that the statement made in @xcite is not entirely correct .",
    "if the configuration space is a lie group @xmath85 , and both the constraint distribution @xmath37 and the lagrangian @xmath86 are invariant under left multiplication on @xmath6 , then we speak of an _",
    "ll system_. in this case there is a subspace @xmath7 of the lie algebra @xmath87 , where @xmath88 is the group identity , such that @xmath89 for all @xmath90 .",
    "the non - integrability of the constraints means that @xmath7 is not a subalgebra .    by left invariance ,",
    "the lagrangian @xmath91 is of pure kinetic energy and is determined by its value at the identity .",
    "we have @xmath92 , where @xmath93 .",
    "we call @xmath94 the _ reduced lagrangian_. it is defined by the _ inertia tensor _ @xmath95 that specifies the left invariant kinetic energy metric at the identity",
    ". we will label such ll system by the triple @xmath96 .",
    "the reduction of the system by the left action of @xmath6 leads to the _ euler - poincar - suslov _ equations @xcite    [ e : euposusmom ] @xmath97    here @xmath98 and @xmath99 are independent vectors whose joint annihilator is @xmath7 . as before ,",
    "the multipliers @xmath100 appearing in are uniquely determined by .",
    "the above equations are consistent with the lagrange - dalembert principle of ideal constraints and therefore preserve the energy of the system .",
    "the discretisation of ll systems in accordance with the dla algorithm was thoroughly considered by fedorov and zenkov @xcite .",
    "the authors proposed a discretisation scheme under the natural assumptions that both the discrete lagrangian @xmath101 and the discrete constraint space @xmath10 are invariant under the diagonal action of @xmath6 on @xmath9 by left multiplication .",
    "we briefly recall some of their results .    by invariance of @xmath81",
    ", one can define a _ reduced discrete lagrangian _",
    "@xmath102 by the rule @xmath103 where @xmath104 is the _ left incremental displacement_. one should interpret @xmath105 an approximation of @xmath106 , where @xmath107 .",
    "the relation @xmath108 , is the discrete counterpart of the _ reconstruction equation _",
    "@xmath109    similarly , by left invariance of @xmath1",
    "there exists a _",
    "discrete displacement subvariety _",
    "@xmath11 determined by the condition @xmath110 given that @xmath111 for all @xmath90 , it follows that the identity element @xmath112 .",
    "moreover , one can easily show , using , that @xmath113 .    therefore , under the above invariance conditions on @xmath114 the corresponding dla nonholonomic integrator is completely determined by the pair @xmath115 .",
    "this motivates the following .",
    "[ d : ll - disc ] a left invariant discretisation of the nonholonomic ll system @xmath116 is given by a time step @xmath19 and a pair @xmath117 where :    1 .",
    "the discrete displacement subvariety @xmath14 is a submanifold of @xmath6 that contains the identity and @xmath113 . in particular , @xmath118 .",
    "2 .   the discrete reduced lagrangian @xmath119 .    in accordance with remark [ rm : disclag ] , the reduced discrete lagrangian is an approximation of the action : @xmath120 , where the curve @xmath121 satisfies @xmath122 .",
    "define the _ discrete legendre transformation _ @xmath123 by the right trivialisation of the derivative of @xmath124 @xcite . for @xmath125 and @xmath126",
    "we have @xmath127    for @xmath128 we define the associated discrete momentum @xmath129 one should understand @xmath130 as an approximation of the inertia tensor @xmath131 . note that numerous complications arise in the discrete setting .",
    "firstly , @xmath132 is locally invertible but in general will fail to be globally invertible ( see @xcite and the discussion in  [ s : asympexpsuslovmoserves ] ) .",
    "secondly , @xmath132 is a nonlinear map , in fact its domain is not even a linear space .",
    "the _ discrete momentum locus _ is defined in @xcite as @xmath133 the discrete momentum locus is a nonlinear subvariety of @xmath134 that approximates the linear constraint space @xmath135 .",
    "provided that @xmath136 is a consistent approximation of the continuous reduced action , it will contain @xmath137 and will be tangent to @xmath31 .",
    "fedorov and zenkov @xcite prove that the discrete nonholonomic equations reduce to the _ discrete euler - poincar - suslov equations _    [ depsalg ] @xmath138    where @xmath128 . as usual , the multipliers @xmath139 are determined by .",
    "since the discrete legendre transform is only locally invertible , this scheme will generally be multivalued and some care should be taken in the choice of the branch to adequately approximate the solutions of ( see the discussion in @xcite ) .",
    "given that the discretisation of ll systems proposed by fedorov , zenkov in @xcite considers a discrete lagrangian @xmath0 and a discrete constraint space @xmath1 that are invariant with respect to the diagonal action of @xmath6 on @xmath9 by left multiplication , it is natural to consider the construction of these objects using a finite difference map @xmath67 that is equivariant .",
    "namely , one that satisfies @xmath140 where @xmath141 is left multiplication by @xmath142 .",
    "if in addition to equivariance , the finite difference map @xmath67 satisfies @xmath143 for some @xmath144 ( and hence all @xmath145 ) then @xmath67 induces a _ reduced difference map _ defined by @xmath146",
    "where , as before , @xmath147 .",
    "note that @xmath17 is defined for @xmath148 on a neighbourhood of the of the identity @xmath149 and maps into the lie algebra .",
    "moreover , we have @xmath150 .",
    "we now state the following proposition whose proof is a direct consequence of the definitions .",
    "[ p : consistency ] let @xmath151 be the invariant discretisation of the ll system @xmath152 that arises as the reduction of the invariant pair @xmath153 , where @xmath10 and @xmath101 .",
    "let @xmath67 be an equivariant difference map that satisfies .",
    "then , the discretisation of the unreduced ll system @xmath154 defined by @xmath155 is consistent with respect to @xmath67 if and only if the induced reduced difference map @xmath17 defined by satisfies @xmath156    in practice , to construct an invariant consistent discretisation of an ll system one can start with a _ retraction map _ , that is a local diffeomorphism @xmath157 , with the property that @xmath158 and @xmath159 .",
    "the reduced finite difference map @xmath17 can be taken as the local inverse of @xmath160 ( defined in a neighbourhood @xmath161 of @xmath149 ) , and the discrete displacement subvariety as @xmath162 .",
    "examples of retraction maps are the exponential and the cayley maps .",
    "the suslov problem , first introduced in @xcite , is a prototype example of a nonholonomic ll system in which the lie group @xmath163 . physically it models the motion of a rigid body under its own inertia subject to the nonholonomic constraint that one of the components of the angular velocity as seen in the _ body frame _ vanishes .",
    "here we recall a series of known facts of the problem and we give a taylor expression of its reduced solutions in order to later examine the performance of geometric integrators for the system .      without loss of generality ,",
    "we assume that the body frame has been chosen in such way that the nonholonomic constraint is @xmath164 , where @xmath165 denotes the angular velocity vector written the body frame . as usual , we interpret @xmath166 as an element of the lie algebra @xmath167 equipped with the vector product @xmath168 .",
    "we have @xmath169 , where @xmath170 is the attitude matrix of the body and @xmath171 is the skew - symmetric matrix that represents @xmath165 via the hat map , see below .",
    "the nonholonomic constraint defines a left - invariant non - integrable , rank 2 distribution @xmath172 determined at the identity by the linear subspace @xmath173 it is clear that @xmath7 is not a subalgebra of @xmath174 .",
    "the reduced lagrangian of the system is @xmath175 where @xmath22 is the inertia tensor of the body and @xmath176 is the euclidean product in @xmath177 .",
    "rotating the body frame about its third axis if necessary , we can assume without loss of generality that @xmath178 the euler - poincar - suslov equations for the angular momentum vector @xmath179 are @xmath180 where @xmath181 is a multiplier that is uniquely determined by the condition that @xmath182 , and @xmath183 .",
    "explicitly we have @xmath184 therefore , the first two components of become @xmath185    the above equations preserve the restriction of the energy @xmath186 to the constraint space @xmath31 .",
    "explicitly , the first integral is @xmath187 using this first integral , equations can be integrated explicitly in terms of hyperbolic functions .      in order to evaluate the order of local truncation error of the geometric integrators for the suslov problem to be defined ahead , we perform a taylor expansion of the solutions of . by repeated differentiation of these equations",
    "we find @xmath188 with @xmath189 and @xmath190      for our treatment ahead it is useful to write the angular velocity @xmath166 , the angular momentum @xmath191 and the reduced lagrangian @xmath192 , in terms of skew - symmetric @xmath193 matrices .",
    "recall ( see e.g. @xcite ) that the _ hat map _ is the lie algebra isomorphism @xmath194 defined by @xmath195 the hat map is also an isometry between @xmath177 with the standard euclidean metric and @xmath16 equipped with the scalar product @xmath196    a short calculation shows that @xmath197 where the symmetric matrix @xmath198 is given by @xmath199 using the properties of the trace and the skew - symmetry of @xmath171 we can write @xmath200 in the following sections we will make an indistinctive treatment of vectors in @xmath177 and skew - symmetric matrices in @xmath16 .",
    "there should be no risk of confusion and any kind ambiguities are resolved by the hat map .",
    "we now define two different invariant discretisations of the suslov problem that follow the prescription of fedorov - zenkov @xcite described in  [ llnii ] . recall that such discretisations are determined by a choice of discrete displacement subvariety @xmath201 and a reduced discrete lagrangian @xmath202 .",
    "the choice of @xmath14 for both discretisations is given in ",
    "[ s : s ] .",
    "the two different choices of the reduced discrete lagrangian are respectively given in ",
    "[ s : l1 ] and  [ s : linfty ] .",
    "we show that only the second discretisation is consistent in the sense of definition [ d : consistency ] .",
    "our construction will use the _ cayley map _ ( see e.g. @xcite ) . for a skew - symmetric matrix @xmath203 define",
    "is included for consistency with physical units . ]",
    "@xmath204 the cayley map is injective and for @xmath205 , we have @xmath206 by euler s theorem ( see e.g. @xcite ) we know that , except for the identity , any matrix in @xmath15 is a rotation through an angle @xmath207 about a certain axis .",
    "such matrix will have eigenvalues @xmath208 . on the other hand , from the above formula",
    "we see that the range of @xmath209 consists of matrices in @xmath15 that do not have eigenvalue @xmath210 . therefore , the range of @xmath209 consists of those matrices whose angle of rotation @xmath207 lies strictly between @xmath211 and @xmath212 .",
    "we define @xmath201 by @xmath213 where @xmath214 is given by .    setting @xmath164 in , and using , we obtain the following expression for the matrix @xmath215 @xmath216 matrices of the above form with @xmath217 parametrise @xmath14 .",
    "note that the above matrix has axis of rotation @xmath218 .",
    "therefore , the condition @xmath128 can be restated by saying that the incremental displacements @xmath147 have axis of rotation perpendicular to @xmath219 , and angle of rotation @xmath220 .",
    "using one can check that the condition @xmath113 in definition [ d : ll - disc ] is satisfied .      as first considered by moser and veselov in @xcite",
    ", we define the reduced discrete lagrangian @xmath221 by @xmath222 up to the addition of an irrelevant constant , it is obtained by formally putting @xmath223 in .",
    "the superscript @xmath224 in the notation indicates that @xmath225 is the first term in the expansion of as a power series in @xmath226 .",
    "[ p : nonconsistent ] the geometric discretisation of the suslov problem defined by the constraint subvariety @xmath14 given by and the reduced discrete lagrangian is not consistent in the sense of definition [ d : consistency ] .",
    "up to an irrelevant constant term we have @xmath227 where @xmath228 is defined by @xmath229 in view of proposition [ p : consistency ] and equation , the discretisation is consistent if there exists an open submanifold @xmath230 of @xmath231 containing the identity , such that @xmath232 .",
    "but this is not possible since for @xmath233 , @xmath234 if only if @xmath235 .    in @xcite fedorov and zenkov",
    "considered a geometric discretisation of the suslov problem having discrete reduced lagrangian given by and with constraint displacement subvariety @xmath236 . such choice of @xmath230 consists of all matrices in @xmath15 having axis of rotation perpendicular to @xmath219 .",
    "therefore , @xmath14 given by is an open and dense subset of @xmath230 that contains the identity . the complement @xmath237 consists of matrices in @xmath15 that are a rotation by @xmath212 about an axis that is perpendicular to @xmath219 . in particular , given that @xmath14 and @xmath230 coincide on a neighbourhood of the identity , we conclude that the geometric discretisation that we have introduced above is equivalent to the one considered by fedorov and zenkov .",
    "the geometric discretisation of the suslov problem considered by fedorov and zenkov in @xcite is not consistent in the sense of definition [ d : consistency ] .",
    "it is remarkable that fedorov and zenkov @xcite do not seem to notice that their discretisation is not consistent given that they explicitly mention the consistency condition at the end of section 2 in their paper .",
    "having chosen @xmath238 , a way to construct a consistent discretisation is to define @xmath239 , where @xmath240 is a local inverse of the exponential map in a neighbourhood of @xmath241 .",
    "the inverse cayley map allows us to make an alternative consistent construction without dealing with the matrix logarithm .",
    "this is explained next .",
    "consider the reduced constrained lagrangian @xmath242 , where @xmath192 is given by . explicitly ,",
    "for @xmath243 in the range of @xmath244 we have @xmath245 it is immediate to check that the geometric discretisation of the suslov problem defined by @xmath14 and @xmath18 is consistent .",
    "the role of @xmath17 in is played by @xmath244 .",
    "the @xmath246 superscript in the notation indicates that we use the exact value of @xmath244 in the definition of @xmath18 instead of a partial sum approximation in its expansion as a power series in @xmath226 ( compare with the definition of @xmath20 ) .",
    "as mentioned before , this is a reparametrisation of the discretisation of the suslov problem considered by fedorov and zenkov in @xcite .",
    "we will determine the order of local truncation error of the approximation of the continuous flow by the resulting discrete euler - poincar - suslov equations . to avoid double subscripts , throughout this section we write @xmath248 .",
    "we identify @xmath21 with @xmath16 via the inner product . the discrete legendre transformation associated to the discrete lagrangian @xmath250 given by",
    "is computed to be @xmath251 using , we find that for @xmath252 we have @xmath253 given by    [ mparame ] @xmath254    where we are using the hat map to identify @xmath255 with @xmath177 .    by putting @xmath256 in it is clear that @xmath257 .",
    "moreover , a direct calculation using this parametrisation shows that a normal vector to @xmath249 at the origin is @xmath258 .",
    "this vector is readily seen to be the normal vector to the plane @xmath259 defined in .",
    "therefore we have shown the following .    for any @xmath19 ,",
    "the momentum locus @xmath249 and the plane @xmath259 are tangent at the origin in @xmath21 .",
    "figure [ f : momlocusmosves ] illustrates both the momentum locus @xmath249 and the plane @xmath31 for generic numerical values of @xmath22 and a small value of @xmath32 .",
    "defined by @xmath260 and the plane @xmath31 immersed in @xmath261 .",
    "although it can not be appreciated from the figure , the surface is tangent to the plane at the origin .",
    ", width=245 ]    the figure illustrates that @xmath249 is bounded , which can be directly proved from .",
    "it is a complicated surface with pinch points and self intersections . in the appendix",
    "we show that @xmath249 is contained in the zero locus of a degree @xmath262 polynomial in @xmath263 .",
    "now , we turn our attention towards the discrete euler - poincar - suslov equations , which in our case read @xmath264 where @xmath265 and the multiplier @xmath266 is determined by the condition that @xmath267 .    using and the hat map , the above identity between skew - symmetric @xmath193 matrices",
    "is written in vector form as @xmath268 taking into account , the first two components in the above equation yield @xmath269    given @xmath270 , in order to obtain @xmath271 one needs to solve the polynomial equations @xmath272 for @xmath273 and @xmath274 where @xmath275 , @xmath276 are degree two polynomials given by @xmath277 here @xmath278 and @xmath279 depend on @xmath270 as @xmath280    in order to understand the number of solutions that has , we compute the resultant of the polynomials @xmath281 with respect to the variable @xmath273 .",
    "this gives a polynomial of degree four in @xmath274 whose leading coefficient is @xmath282 under the assumption that the inertia tensor is not diagonal , for generic @xmath270 , this is non - zero .",
    "hence generically admits 4 different ( possibly complex ) solutions for @xmath283 .",
    "experiments show that if @xmath284 are real , and @xmath19 is small enough , then two solutions are real and two are complex .",
    "this is consistent with the results reported by fedorov - zenkov in @xcite , and with the degree of the polynomial @xmath285 given in proposition [ 4orderp ] in the appendix .      from the above discussion",
    "it follows that generically defines a 4-valued map from @xmath286 to itself .",
    "we shall now explain how to select a branch to construct a ( locally defined ) single valued discrete time map , @xmath32 , on @xmath287 are inherited from the discrete lagrangian @xmath260 .",
    "] @xmath287 on @xmath288 that approximates the flow of the continuous suslov problem on @xmath15 .",
    "a matrix @xmath289 specifies a point @xmath290 through the inverse cayley map ( @xmath148 is represented by replacing @xmath291 by @xmath292 ) .",
    "applying the implicit function theorem to equations one can show that , for @xmath32 small enough , there exists a unique solution for @xmath271 that depends smoothly on @xmath293 and @xmath32 and converges to @xmath292 when @xmath294 .",
    "the point @xmath271 defines the matrix @xmath295 via the cayley map . the asymptotic expansion for @xmath271 in terms of @xmath292 is given by @xmath296 where @xmath297 and @xmath298    it can be shown that the momentum locus @xmath299 has pinch points and self - intersections .",
    "this is suggested by its graph in figure [ f : momlocusmosves ] and agrees with the discussion in fedorov and zenkov @xcite . away from these points ,",
    "the inverse of the discrete legendre transformation is defined and is smooth , so we can locally define the discrete time momentum mapping on @xmath300 by @xmath301    we will compute the order of local truncation error of the approximation of the continuous flow of by the projection of @xmath302 onto the @xmath303-@xmath304 plane .    by the implicit function theorem ,",
    "the equations , , can be inverted in a vicinity of @xmath305 where we consider @xmath32 as a parameter .",
    "the asymptotic expansion for the inversion as @xmath34 is computed to be given by @xmath306 where @xmath307 and @xmath308@xmath309    on the other hand , equations , admit the asymptotic expansion in @xmath32 @xmath310    an asymptotic expansion for the projection of @xmath302 onto the @xmath303-@xmath304 plane can now be obtained using , and .",
    "denoting @xmath311 and @xmath312 , we have @xmath313 where @xmath314 are given by , and @xmath315 expansions are valid in a vicinity of @xmath305 and for a small @xmath19 .",
    "comparing and , with and , we conclude the following .    [",
    "t : accuracymosves ] the local truncation error of the approximation of the flow of the euler - poincar - suslov equations by the projection of the discrete time momentum mapping @xmath302 onto the @xmath303-@xmath304 plane is second order .",
    "we repeat the analysis performed in  [ s : req1 ] for the discretisation defined by @xmath18 and @xmath14 . as in the previous section , we denote @xmath317 to avoid double subscripts .      upon the same considerations of  [",
    "e : momlocusmosves ] , the discrete legendre transformation associated to the discrete lagrangian @xmath18 given by is computed to be @xmath319 where @xmath320    using and , we obtain the following expression for the components of @xmath321 where @xmath322    [ mparameinfty ] @xmath323    also in analogy with the discussion presented in  [ s : req1 ] , one can check that the momentum locus @xmath324 contains the origin , where it is tangent to the plane @xmath259 defined in .",
    "figure [ f : momlocuscayley ] illustrates both the momentum locus @xmath325 and the plane @xmath31 for generic numerical values of @xmath22 and a small value of @xmath32 .",
    "defined by @xmath326 and the plane @xmath31 immersed in @xmath261 .",
    "they intersect along the red curve , which self - intersects at the origin where @xmath325 is tangent to @xmath31 .",
    ", width=173 ]    notice that @xmath325 appears to be unbounded .",
    "this can be directly proved using the parametrisation and contrasts with the situation encountered in the study of the momentum locus defined by @xmath20 and illustrated in figure [ f : momlocusmosves ] .",
    "in the appendix we show that @xmath325 is contained in the zero locus of a polynomial of degree @xmath327 in @xmath328 .      using , and ,",
    "the components of the euler - poincar - suslov equations that do not involve the multiplier @xmath266 may be rewritten as a set of implicit equations to determine @xmath271 in terms of @xmath270 .",
    "these equations are @xmath329 where @xmath330 and @xmath331 are the degree three polynomials @xmath332    in order to understand the number of solutions that has , we compute the resultant of the polynomials @xmath333 with respect to the variable @xmath273 , where @xmath334 and @xmath335 are scalars .",
    "this gives a polynomial of degree seven in @xmath274 , say @xmath336 .",
    "the coefficients @xmath337 and @xmath338 of this polynomial are @xmath339 if the inertia tensor is non - diagonal and @xmath340 , then @xmath341 and hence admits exactly 7 ( possibly complex ) solutions .",
    "this coincides with the degree of the polynomial @xmath342 given in proposition [ propoq7 ] of the appendix .",
    "experiments show that if @xmath284 are real , then 1 solution is real and six are complex .    on the other hand , if @xmath343 then @xmath344 has degree 5 . in this case",
    ", the leading coefficient is @xmath345 that does not vanish if the inertia tensor is non - diagonal .",
    "hence , in this case admits exactly 5 ( possibly complex ) solutions .",
    "experiments show that if @xmath284 are real , then 1 solution is real and four are complex .      in analogy with",
    "the discussion of  [ s : asympexpsuslovmoserves ] , one of the branches of the scheme defines a single - valued discrete time map @xmath346 on @xmath14 that approximates the flow of the continuous suslov problem on @xmath15 .",
    "the asymptotic expansion for such @xmath271 in terms of @xmath292 as @xmath33 is given by @xmath347 where @xmath348 are defined in and @xmath349    analogous to , we can locally define the discrete time momentum mapping on @xmath324 by @xmath350 we will now compute the order of local truncation error of the approximation of the continuous flow of by the projection of @xmath351 onto the @xmath303-@xmath304 plane as we did with @xmath352 in  [ s : asympexpsuslovmoserves ] .    the inversion of equations and in a neighbourhood of @xmath305 yields @xmath353 where @xmath354 , @xmath355 are given by , and @xmath356    an asymptotic expansion for the projection of @xmath357 onto the plane @xmath358 is obtained using , and . denoting @xmath311 and @xmath312 , we have @xmath359 where @xmath314 are given by , and @xmath360 expansions are valid in a vicinity of @xmath305 and for a small @xmath19 .    comparing and , with and , we conclude the following .    [",
    "t : accuracycayley ] the local truncation error of the approximation of the flow of the euler - poincar - suslov equations by the projection of the discrete time momentum mapping @xmath357 onto the @xmath303-@xmath304 plane is second order .",
    "theorems [ t : accuracymosves ] and [ t : accuracycayley ] show the local truncation error for both discretisations is of the same order .",
    "this indicates that consistency of the discretisation of a nonholonomic geometric integrator is not the essential feature to guarantee an approximation of the continuous flow within with a desired order of accuracy .",
    "this seems to contradict the remark 3.1 in @xcite quoted in the introduction .",
    "here we discuss the energy preservation properties of both discretisations .",
    "it is shown by fedorov - zenkov @xcite that the discretisation of the suslov problem defined by @xmath14 and @xmath260 exactly preserves the restriction of the constrained energy @xmath361 defined by to the momentum locus @xmath27 . at the group level , this conservation law is formulated in the following .",
    "[ rationalfunction ] the discrete system evolves on the level sets of the rational function @xmath362    a direct calculation shows that @xmath363 so , using , we get @xmath364 but the expression on the right hand side equals @xmath365 .",
    "it is important to notice that _ all _ branches of the multi - valued discrete map defined by possess this invariant .",
    "the relationship between the rational function @xmath366 and @xmath361 is established by noticing that , in view of , , the relation @xmath367 can be rewritten as @xmath368 but , up to multiplication by a constant factor , @xmath369 coincides with @xmath361 .",
    "the proposition above shows that the discrete map defined by evolves on the algebraic curve @xmath370 where @xmath371 .",
    "the maple package  algcurves \" indicates that the compactification of @xmath372 has genus 3 and is not hyperelliptic .",
    "the consistent discretisation defined by @xmath14 and @xmath373 only preserves the constrained energy @xmath361 defined by if @xmath343 .",
    "one can show that this condition implies that the axis of forbidden rotations of the body @xmath219 is contained in an inertia eigen - plane .    at the group level",
    ", we have the following .    [ p : consenergycayley ] let @xmath3 be the following polynomial in two variables @xmath374    1 .",
    "if @xmath343 then the discrete system evolves on the level sets of @xmath3 .",
    "2 .   if @xmath340 then for successive points defined by , we have @xmath375    a direct calculation shows that @xmath376 and also @xmath377 it follows from that @xmath378    note that this proposition applies to all branches of the multi - valued discrete map defined by . in particular , if @xmath343 , all 5 branches preserve @xmath3 . given that in this case @xmath219 lies on an inertia eigen - plane , by performing a rotation of the body frame about @xmath219 , we may assume that @xmath379 vanishes and @xmath3 takes the simplified form @xmath380 hence , the multi - valued map evolves on the algebraic curve @xmath381 where the constant @xmath382 .",
    "according to the maple package  algcurves \" the compactification of @xmath372 has genus 4 and is not hyperelliptic .    the relationship between the polynomial @xmath3 and the constrained energy @xmath383 given by is established by noting that in view of and we have @xmath384 which , up to multiplication by a constant factor , coincides with @xmath361 .",
    "if @xmath340 , the proposition states that the approximation of @xmath361 by the discrete flow is @xmath385 which is considerably good .",
    "one could imagine that in this case there still exists an energy - like first integral of the discrete system , for instance an @xmath386-perturbation of @xmath361 .",
    "we were unable to prove or disprove this possibility that was brought to our attention by one of the anonymous referees of the paper .",
    "note that in the energy - preserving cases mentioned above , the discrete flow at a fixed energy value defines a multi - valued map on an algebraic curve .",
    "such curve has symmetries and is a covering of another curve with lower genus . as future work",
    ", it is interesting to investigate if an exact analytical expression for the @xmath387 iterate of these maps can be obtained in any of these curves .",
    "in this section we compare the performance of the integrators @xmath302 and @xmath357 by conducting numerical experiments .",
    "we consider two different choices of the inertia tensor .",
    "the first one is generic while the second one satisfies the condition @xmath343 that ensures that @xmath357 exactly preserves @xmath361 . in both cases",
    "we observe that the approximation by the non - consistent integrator @xmath302 is slightly better .      throughout this section",
    "we suppose that the inertia tensor has @xmath388 we will approximate the solution @xmath389 to the euler - poincar - suslov equations having initial condition @xmath390 over the time interval @xmath391 .",
    "such solution can be obtained analytically , see e.g. @xcite .",
    "this choice of initial condition is such that @xmath392 will evolve from one asymptotic state to another over the time interval @xmath393 .",
    "our numerical experiments show that the momentum integrator @xmath302 corresponding to the non - compatible discretisation defined by @xmath14 and @xmath260 approximates @xmath389 for @xmath391 if the the time step @xmath394 . for @xmath395 we can not generate sufficient iterations for the approximation .",
    "the problem arises since the map @xmath396 that appears in only exists locally .",
    "we did not find this type of restriction on the time step for the momentum integrator @xmath357 corresponding to the consistent discretisation . in figure",
    "[ f : generic ] below we show approximations of @xmath392 by both integrators for @xmath397 . on the insets we show respectively the approximation of the constrained energy @xmath361 and the signed distance @xmath398 to the constraint subspace @xmath31 given by at each time step . for the latter graph it is necessary to compute the iterates of all components of the vector @xmath191 .     and the evolution of the energy @xmath361 ( inset ) .",
    "the graph on the right shows the approximation of @xmath304 and the evolution of the signed distance @xmath398 to the constraint subspace @xmath31 ( inset ) .",
    ", title=\"fig:\",width=566 ] ( -143,60 ) @xmath399 ( -76,60 ) @xmath400 ( -143,38 ) @xmath399 ( -76,38 ) @xmath400 ( -400,60)consistent approximation defined by @xmath401 ( -400,38)non - consistent approximation defined by @xmath402 ( -400,17)exact      now we consider an inertia tensor having @xmath403 and we approximate the solution to the euler - poincar - suslov equations having initial condition @xmath404 once again , the choice of initial condition is such that the solution will evolve from one asymptotic state to another over the time interval @xmath393 .",
    "this time the non - consistent momentum integrator @xmath302 has problems if @xmath405 .",
    "figure [ f : special ] below is analogous to figure [ f : generic ] in the previous section for @xmath406 .    .",
    "the graph on the left shows the approximation of @xmath303 and the evolution of the energy @xmath361 ( inset ) .",
    "the graph on the right shows the approximation of @xmath304 and the evolution of the signed distance @xmath398 to the constraint subspace @xmath31 ( inset ) .",
    ", title=\"fig:\",width=566 ] ( -143,60 ) @xmath407 ( -76,60 ) @xmath408 ( -143,38 ) @xmath407 ( -76,38 ) @xmath408 ( -400,60)consistent approximation defined by @xmath401 ( -400,38)non - consistent approximation defined by @xmath402 ( -400,17)exact    note that the numerical experiments show that the evolution of the non - consistent discrete map @xmath302 is slower than the continuous dynamics while the evolution of the consistent discrete map @xmath357 is faster .",
    "we have no explanation for this phenomenon .",
    "to our knowledge , this work is the first in which the usefulness of the consistency condition of a discretisation of a nonholonomic system is explored .",
    "our results indicate that consistency may not be the essential property to consider in order to construct nonholonomic integrators . indeed , for the specific discretisations of the suslov problem that we considered",
    ", we have shown that    1 .",
    "both the consistent and the non - consistent discretisations approximate the continuous flow of the system with local truncation errors of the same order .",
    "2 .   the non - consistent discretisation preserves the energy of the continuous system for an arbitrary inertia tensor . on the other hand ,",
    "the consistent discretisation only preserves the energy of the continuous system for a family of rigid bodies whose inertia tensor has a specific type of symmetry , and it is unclear if an energy - like first integral exists in the general case .",
    "our numerical experiments indicate that the non - consistent discretisation gives rise to an integrator that performs better than the consistent one for the same value of the time step .",
    "we are grateful to the two anonymous referees for their detailed comments and remarks that helped us to improve both the content and the presentation of the paper .",
    "we acknowledge the support of the project b4 of sfb - transregio 109  discretization in geometry and dynamics \" and the hospitality of technische universitt berlin during a joint visit of the authors in april 2015 when this project was started .",
    "lgn also benefited from the hospitality at tu berlin during the months of june and november of 2015 , and these visits were very valuable to make progress in this project .",
    "we are thankful to yuri fedorov , yuri suris and claude viallet for very useful comments and remarks .",
    "also to matteo petrera for his guidance with maple and to ramiro chvez - tovar for his help in the edition of the figures in the paper .",
    "lgn acknowledges support of the program unam - dgapa - papiit ia103815 that served to cover travel expenses and to fund a visit of fj to unam in mexico in february 2016 .    the research of fj has been partially supported in its late stages by dgist research and development program ( cps global center ) funded by the ministry of science , ict & future planning , global research laboratory program ( 2013k1a1a2a02078326 ) through nrf , and institute for information & communications technology promotion ( iitp ) grant funded by the korean government ( msip ) ( no .",
    "b0101 - 15 - 0557 , resilient cyber - physical systems research ) .",
    "[ 4orderp ] the momentum locus @xmath409 defined by @xmath20 is contained in the zero locus of the degree four polynomial @xmath410 given by @xmath411 where , for @xmath412 , @xmath413 is a homogeneous polynomial of degree @xmath414 .",
    "[ propoq7 ] the momentum locus @xmath418 defined by @xmath18 is contained in the zero locus of the degree seven polynomial @xmath419 given by @xmath420 where for @xmath421 , @xmath422 denotes a homogeneous polynomial of degree @xmath414 .",
    "y. n. fedorov , a. j. maciejewski and m. przybylska , the poisson equations in the nonholonomic suslov problem : integrability , meromorphic and hypergeometric solutions , _ nonlinearity _ , * 22 * ( 2009 ) , 22312259 .",
    "j. e. marsden and t. s. ratiu , _ introduction to mechanics and symmetry . a basic exposition of classical mechanical systems _ , 2@xmath427 edition , texts in applied mathematics , * 17*. springer - verlag , new york , 1999"
  ],
  "abstract_text": [
    "<S> geometric integrators for nonholonomic systems were introduced by corts and martnez in @xcite by proposing a discrete lagrange - dalembert principle . </S>",
    "<S> their approach is based on the definition of a discrete lagrangian @xmath0 and a discrete constraint space @xmath1 . </S>",
    "<S> there is no recipe to construct these objects and the performance of the integrator is sensitive to their choice .    </S>",
    "<S> corts and martnez @xcite claim that choosing @xmath0 and @xmath1 in a consistent manner with respect to a finite difference map is necessary to guarantee an approximation of the continuous flow within a desired order of accuracy . </S>",
    "<S> although , this statement is given without proof , similar versions of it have appeared recently in the literature .    </S>",
    "<S> we evaluate the importance of the consistency condition by comparing the performance of two different geometric integrators for the nonholonomic suslov problem , only one of which corresponds to a consistent choice of @xmath0 and @xmath1 . </S>",
    "<S> we prove that both integrators produce approximations of the same order , and , moreover , that the non - consistent discretisation outperforms the other in numerical experiments and in terms of energy preservation . </S>",
    "<S> our results indicate that the consistency of a discretisation might not be the most relevant feature to consider in the construction of nonholonomic geometric integrators . </S>"
  ]
}