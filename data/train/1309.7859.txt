{
  "article_text": [
    "a key component for dealing with larger scale soft matter systems is the coarse graining approach to model building . by reducing the degrees of freedom of the particle system",
    ", a significant speedup can be achieved allowing to reach the necessary length and time scales of soft matter systems . a very common approach to coarse graining in aqueous soft matter systems such as biological systems , polyelectrolyte solutions or colloidal suspensions",
    "@xcite is to treat the solvent implicitly . in most of these models",
    "water is not included as an explicit species , but is simply modelled as a homogeneous dielectric background that reduces the electrostatic interactions everywhere by the inverse of the relative dielectric constant , _",
    "i.e._80 for water at room temperature .",
    "while this assumption works well in homogenous solutions , it breaks down in the presence of spatial changes in the dielectric constant .",
    "this happens , for example , if walls are part of the aqueous system , _",
    "i.e._salty water in nano pores , glas walls in microfluidic channels , or the air -water interface of an open solution .",
    "many approaches have been presented in recent years to deal with dielectric enclosures , where interfaces between regions of different permittivity are treated via explicit image charges or boundary elements  @xcite , via extended poisson - boltzmann solvers  @xcite , or as an extension of a local monte carlo scheme  @xcite .",
    "while the influence of sharp dielectric contrasts in biophysical systems with a homogeneous salt concentration is not yet fully understood , its importance has been clearly demonstrated in such systems as ions near an air - water interface @xcite , where the inclusion of the correct polarizability plays a crucial role .",
    "another important step would be to take into account not only the effects of sharp dielectric contrasts , but allow for the bulk dielectric background to become inhomogeneous .",
    "such effects can happen , for example in regions of water with different salt concentrations .",
    "we know that the dielectric constant of water depends on salt concentration , see for example ref @xcite and references therein .",
    "it becomes lower , as the concentration of salt is increased .",
    "physically , this can occurs in many systems , _",
    "i.e. _  polyelectrolyte solutions , suspensions of charged colloids , or the variation in polarizability of water close to strongly charged surfaces  @xcite .",
    "in addition , to our knowledge there is currently only one other recently presented algorithm  @xcite that allows particles to cross a dielectric boundary and enter a region with different dielectric properties , and it requires more computational effort and is less versatile .",
    "smoothly varying dielectric properties have recently been the subject of algorithmic research and a few methods have been explored  @xcite . in this article , an extension to the local maxwell equations molecular dynamics ( )",
    "algorithm is presented , the idea of which was first introduced by a.  maggs  @xcite and later adapted by j.  rottler and a.  maggs  @xcite , and simultaneously by i.  pasichnyk and b.  dnweg  @xcite for molecular dynamics ( md ) simulations .",
    "is extended to deal with locally spatially varying dielectric properties for coulomb interactions .",
    "we also point out general restrictions of the algorithm , and introduce an important correction to the handling of the global dipole term .",
    "the electrostatics approach has not been as widely adopted as many other well known electrostatics algorithms  @xcite , such as the various particle - mesh approaches  @xcite or the multipole method  @xcite .",
    "this is despite the fact that it comes with several benefits that have become of significant interest over the past few years .",
    "since the maxwell equations for electrodynamics are intrinsically local and require no global information on the system , we gain two fundamental advantages :    first , unlike for all ewald - based algorithms , the parallelization for such a local system of equations is trivial and communications need only be done at the boundaries of each domain . in addition , the scaling of the algorithm is only dependent on the lattice mesh size and therefore it scales linearly , @xmath0 , for a fixed particle density .",
    "this is a very nice feature in a time where systems with several @xmath1 charges @xcite are often simulated using massive parallel computers .",
    "moreover this makes this algorithm also attractive to be ported on a graphical processing unit ( gpu ) .",
    "second , because of its locality the method easily allows changes of the dielectric properties within the system , which is introduced in this article .",
    "the article is structured as follows .",
    "first , the algorithm ( its initial and thermodynamic solution ) is extended mathematically to locally varying permittivities .",
    "it is shown that the important features still hold and the statistical observables are reproduced correctly .",
    "second , an estimate for the systematic error is presented and discussed .",
    "third , the effect of handling the global dipole term in periodic boundary conditions is shown to be erroneous by a comparison to the classical ewald method , paving immediately the way to constructing a correction term .",
    "fourth , both the initial and the dynamic part of the extended algorithm are validated against analytical solutions and simulations .",
    "fifth , the numerical performance of the algorithm is evaluated and advantages and limitations are discussed . finally , we conclude and present a brief outlook on the future of the algorithm .",
    "most of the proofs for the extended algorithm go along the lines of the original introduction by maggs  @xcite pasichnyk and dnweg  @xcite",
    ". the general idea will be given , but the main mathematical steps can be retraced in the aforementioned publication .",
    "the algorithm consists of two parts : calculating an initial solution of the gauss law of electrodynamics on a lattice .",
    "the second part consists of applying and propagating all temporal changes to said solution within the system .",
    "the initial solution proposed by pasichnyk for a constant permittivity only has to be adapted slightly to ensure the correct result for varying dielectric permittivities .    .",
    "then the charge @xmath2 is subtracted from each charge in the @xmath3-plane .",
    "analogue with @xmath4-lines and the single nodes in @xmath5-direction . ]    a scheme to acquire an initial solution is shown in figure [ fig : initialscheme ] .",
    "first , the charges on each plane are averaged , scaled by the lattice size and local permittivity , and added to the field on each node @xmath6 and the charge @xmath2 is subtracted from each vertex in the @xmath7-plane . the charges in @xmath4- and",
    "@xmath5-direction are updated accordingly on lines and vertices , following @xmath8    summation of the total charge in one cell is given by @xmath9 and this yields the gauss law directly , if the @xmath10 operator is defined via finite differences @xmath11 .",
    "an iterative procedure of energy minimization is equivalent to the second maxwell equation @xmath12 and gives a correct initial solution .",
    "this method of numerical relaxation is not very efficient but has to be done only once .    starting from this solution of gauss law , only updates of the electric field following a constraint",
    "have to be applied .",
    "hereby , we can assume that the time scales of the propagation speed of the fields and the motion of the particles decouple .",
    "then the propagation of the fields can be described by an artificial dynamics , in a car - parrinello ( cpmd ) manner  @xcite .",
    "analog to pasichnyk and dnweg , the most general constraint for the system is    @xmath13    with the electric displacement field @xmath14 , the electric current density @xmath15 , and an arbitrary vector field @xmath16 as an additional degree of freedom . from this , the lagrangian @xmath17 is obtained , where the lagrange multiplier @xmath18 is used to impose the kinematic constraint , @xmath19 is the position , @xmath20 and @xmath21 are the particle masses and velocities respectively , and @xmath22 is an additional potential .",
    "the prefactor @xmath23 simply denotes the mass equivalent of the exchange particles , analog to electrons in cpmd , and later turns out to be related to the wave propagation speed as @xmath24 .",
    "the equations of motion for this lagrangian @xmath25 can be calculated using variational calculus .",
    "the derivative in @xmath16 and @xmath26 is zero , and the motion of particles and fields is defined by @xmath27 where @xmath28 is the lagrangian density , which by definition satisfies @xmath29 .",
    "variation with respect to @xmath30 results in    @xmath31    where the second transformation is a time derivative .",
    "variation with respect to @xmath32 yields    @xmath33    combining these two results and introducing the vector field    @xmath34    provides the equations of motion for the particle    @xmath35    as expected .",
    "the equations of motion for the electromagnetic fields can be found by varying the lagrangian density @xmath28 .",
    "variation in @xmath36 and in time gives    @xmath37    where the natural initial condition @xmath38 is used in the last step , and @xmath39 for convenience .",
    "the next variation in @xmath40 gives    @xmath41    which leads to the more commonly known expression for equation ( [ maggs : eq : force ] ) . with these two last results , ( [ maggs : eq : wave ] ) and ( [ maggs : eq : danda ] ) , two more maxwell equations can be obtained by inserting into the constraint equation ( [ eq : constraint ] ) , namely ampre s and faraday s law :",
    "@xmath42    this means that simply applying the constraint ( [ eq : constraint ] ) reproduces the complete electromagnetic formalism .",
    "it should be noted that the equations ( [ maggs : eq : b - vector ] ) and ( [ maggs : eq : danda ] ) represent nothing more than the so - called temporal or weyl gauge in electromagnetism , in which the scalar potential @xmath43 is identically zero , and which turns out to be the most appropriate gauge for our purposes .    since the lagrangian we introduced is constrained , it is not possible to easily construct a hamiltonian from it , only via the dirac theory of constrained systems .",
    "an elementary construction would be beneficial to simplify further proofs for the conservation of phase - space volume , energy and momentum .",
    "however , it is possible to construct a lagrangian that is not constrained and produces the exact same equations of motion . the proofs and details will not be carried out , but the resulting lagrangian is    @xmath44    the equations of motion for the particles and the fields can be derived from equation   and the lagrangian density by the use of variational calculus .",
    "the resulting equations of motion for the particles and fields from the unconstrained lagrangian are    @xmath45    in our implementation , the magnetic part of the lorentz force , @xmath46 from equation , is omitted .",
    "this increases the speed significantly , but makes it impossible to construct an unconstrained lagrangian from eq .  , and therefore the hamiltonian nature of the algorithm does not hold .",
    "momentum conservation is violated by the amount of momentum that the virtual photons carry .",
    "this is a negligible percentage and perfect momentum conservation is not important in most simulated systems since many contain a thermostat .",
    "energy conservation , however , holds , as can be shown with a pseudo liouville theorem for the lagrangian , along the lines of  @xcite .",
    "all additional terms that show up due to a spatially dependent permittivity simply cancel out .",
    "like in the algorithm for constant background permittivity , the thermodynamic observables are perfectly reproduced , since they are not dependent on the speed of light nor the magnetic field component .",
    "in contrast to the original version , the partition function in this extended algorithm contains an extra term for the varying permittivity .",
    "the particle momenta and the vector field @xmath18 can still be integrated out in a straightforward way .",
    "if we split up the integration of the electric field in a longitudinal and a transversal component , we end up with    @xmath47    the integration over the transversal component also only contributes a factor , and the longitudinal component cancels with the delta function .",
    "this contribution of the transversal component is constant for a static dielectric background , but can vary if the dielectric interfaces are mobile .",
    "this gives rise to thermal casimir / lifshitz interactions as discussed by pasquali and maggs  @xcite , but the effect will not be discussed further in this article since we focus on moving charges in static dielectric backgrounds .",
    "the only degrees of freedom now left are the particle coordinates , which finally leads to    @xmath48    this is what is expected from the static case of electromagnetic interactions .    the lattice discretization in space is done in a way analog to the original implementation ( see figure  [ fig : discretization ] ) , featuring the same finite differences representations for the gradient @xmath10 and the curl @xmath49 operators .",
    "the local permittivity values @xmath50 can assume tensorial form , equivalent to a differential 2-form . in our implementation , we reduce the tensor to its diagonal entries ( differential 1-form ) , which merely represents an optically isotropic medium .",
    "the local permittivity therefore has a value and a direction , and they are placed on the links of the interpolating grid .",
    "the electric displacement field values @xmath14 are still stored on the links , although they are represented by a rotation around these links .    to map given permittivity values , set by an interface or function , to the lattice , the finite difference between adjacent grid points is employed .",
    "if the difference is significantly bigger than the values , the link is marked as an _",
    "interface link_. the values for these interface links are then calculated by taking the harmonic average @xmath51 where @xmath52 and @xmath53 are the permittivity values on the adjacent lattice sites on each side of the interface respectively , @xmath54 and @xmath55 are the distances of the according lattice site along the link to the interface , and @xmath56 is the lattice spacing , as depicted in fig .",
    "[ fig : epsilon - interpolation ] .",
    "even in the continuum , the solution of the maxwell equations for point charges is singular at the position of the particle .",
    "the point charge carries along with it the electrostatic energy    @xmath57    which is a diverging integral .",
    "this would mean that the particle has infinite mass and can not respond to forces . with a lattice spacing , a `` cut - off ''",
    "is introduced for this self - interaction , but still the particle is driven to the center of the cell by the field created from its own ( interpolated ) charge .",
    "it is , from an energy point of view , most favorable for the particle to distribute its charge evenly on all surrounding lattice points , since it then produces the smallest possible curl @xmath58 in the cell .",
    "this spurious self - influence is in the original algorithm corrected by the use of yukawa - potentials .",
    "however , if the permittivity of the system changes within the cell , every potential based correction scheme fails .",
    "however , this problem can be solved both with a lattice greens function , or a direct subtraction scheme .    in our implementation",
    ", the permittivity , as it is a differential 1-form , is placed on the lattice links .",
    "therefore it remains constant on the link , allowing us to set up a green s function of the form    @xmath59    if @xmath19 and @xmath60 are placed on adjacent lattice sites .",
    "for a point charge , the electrostatic potential can then be found using a convolution with the green s function    @xmath61    where we assume that @xmath50 remains constant within the cell .",
    "this green s function for a point charge on a cubic lattice can now be solved by a fourier transform and is limited to the first brioullin zone .",
    "for an infinitely large lattice , the back transform yields the integral    @xmath62    if the laplace operator on the left - hand side of equation is used to construct a finite - differences operator and applied to each of the interpolated charges on the lattice , we end up with a solution of the self - energy influence that can be added up .",
    "this is a well - known scheme for lattices of constant dielectric permittivity and applies in a straight forward way here if @xmath50 does not change within the cell of each charge  @xcite . while this is not suitable for all cases , it can be applied to many and is fairly fast , since the solution for the given integral only needs to be calculated once at the beginning of the simulation and it can be done analytically  @xcite .",
    "another approach to allow for dielectric variations on very small scales ( within one lattice site ) is to use a direct subtraction scheme . with the assumption that the gradient of the permittivity , @xmath63 , is constant on each lattice link ,",
    "the influence of the interpolated charges can be directly calculated and subtracted .",
    "this also requires the charge interpolation scheme to be of linear order and , after some algebra , results in    @xmath64    where @xmath65 denotes the charge of the particle , @xmath56 the lattice spacing , @xmath66 the position of the charge relative to the vertex  @xmath67 , and @xmath68 the position of the charge folded onto dimension  @xmath69 relative to the vertex  @xmath67 , and @xmath70 the permittivity on the lattice link between vertices  @xmath67 and  @xmath71 .",
    "both correction schemes as well as the use of yukawa potentials are included in our implementation within  @xcite , an extensible software package for research on soft matter . for constant dielectric background , yukawa potential correction is used as the most precise option . for dielectric interfaces that can not be approached and penetrated by charges ,",
    "the greens function correction is suitable .",
    "the direct scheme is the most general , and it is used by default for spatially varying dielectric systems .",
    "an error estimate for the local electrostatics algorithm has been presented in  @xcite , but it features a more complex interpolation scheme and can not be applied here .",
    "thus , we want to analyze and check the error contributions of our implementation .",
    "other than the physical error from omitting the magnetic part of the lorenz force , the algorithm carries a numerical error which consists of two parts .",
    "the first contribution stems from the linear interpolation scheme of the electric current onto the lattice .",
    "it can be reduced by introducing a splitting of the far field and near field part of the coulombic interaction and calculating the near field ( e.g. the 27 surrounding next neighbor lattice cubes ) with a direct pairwise potential calculation .",
    "this splitting , however , comes with a considerable overload in computational effort , since the near field correction needs to be subtracted from the algorithm via a lattice greens function or a similar construct .",
    "it is also not possible for spatially varying dielectric properties , since the coulomb potential based near field approach breaks down for a non - constant dielectric background .",
    "this is why , for the extended algorithm , we stick with a linear interpolation scheme with a short - range cutoff of only one lattice cell .",
    "the second contribution is of algorithmic origin and relates to the artificially small speed of light .",
    "since the propagation speed of the magnetic fields is finite , the system does not feature true electrostatics but retarded solutions of the maxwell equation .",
    "this error is also indirectly related to the lattice spacing , since a coarser lattice allows for the magnetic fields to be propagated over greater distances in one time step .",
    "the two errors are connected via the courant stability criterion :    @xmath72    ) are included , compared to high precision p3 m force calculations . ]    with a lattice spacing @xmath56 , the error introduced by a linear interpolation scheme for geometric reasons scales with @xmath73 , whereas the algorithmic error scales with @xmath74 ( from equations and ) .",
    "the resulting overall numerical error is shown in figure  [ fig : theoretical - error ] for a random distribution of charges .",
    "in addition , three simulations have been performed with the algorithm and compared in force to reference values from a implementation tuned to high accuracy .",
    "+    the three systems were chosen to represent three different setups that contain different types of error sources .",
    "the system of a polyelectrolyte in salt water solution in figure  [ fig : polyelectrolyte ] features a very dilute system with a high charge concentration around the polymer .",
    "oppositely , the silica melt in figure  [ fig : salt - melt ] is very dense and includes ions of different valency .",
    "the third example is an artificial setup of two infinite charged walls and a surrounding cloud of randomly placed charges .",
    "this system features a strong dipole moment and a significant long - range contribution throughout the simulation box .    from figure",
    "[ fig : theoretical - error ] , two things can be deduced : first , the numerical error has a predictable minimum , since the two error sources have a clear mathematical relation .",
    "second , the relative rms force error for a typical system does not go below @xmath75 .",
    "this is sufficient for most md simulations , but it should be considered before using this algorithm . the error can be reduced further by introducing an effective short range cutoff , as mentioned above .    it should also be noted that the error increases at very small distances between two charges due to the linear interpolation . for inhomogenous systems with very dense areas",
    "not only the error increases but the algorithm slows down significantly , having to propagate all fields into empty regions .",
    "in md simulations , the box geometry is often set to be periodic in all dimensions , to avoid boundary effects .",
    "this type of boundary condition is introduced very naturally in the algorithm .",
    "because of its locality , the boundaries and according field propagations can be directly stitched together , creating infinitely many periodic replicas .    in fully periodic charged systems using ewald - based algorithms , like the particle - particle particle - mesh method ,",
    "the boundary conditions at infinity have a considerable effect on the solution  @xcite . for physical simulations",
    ", one normally assumes metallic boundaries at infinity to fix the electric field and potential to zero .",
    "this assumption cancels the system s overall charge and its dipole moment for force calculations , since the potential and the electric fields at the metallic boundary at infinity are forced to zero .",
    "physically , this allows the algorithm to compensate for a non - neutrality of the system , and it allows the dipole moment of the system to perform an unrestricted random walk .",
    "this is intentional , because in realistic systems , the dipole moments of all periodic copies would not be exactly the same but perform individual random walks to cancel out on average after spatial integration  @xcite .    for a standard ewald method , the correction of the dipole term to the electric field at @xmath76 has been calculated in  @xcite and  @xcite as @xmath77 where @xmath78 is the charge distribution , @xmath79 is the number of particles , @xmath80 are magnetic dipoles in the system , and @xmath81 is the permittivity at infinite distance .",
    "if this is transferred to electrostatic monopoles , it will create an energetic influence @xmath82 on each particle of    @xmath83    where @xmath84 is the volume of the simulation box , @xmath85 is the boundary permittivity at infinite distance , and @xmath86 is the total dipole moment of the unfolded coordinates of the charges .",
    "similar corrections have been introduced in  @xcite with additional moves to the original monte carlo algorithm , but were not transferred to the md implementation .    in ewald - based methods , the monopole and dipole terms",
    "can directly be set to zero in fourier space , providing a simple and exact way to set metallic boundary conditions at infinity .",
    "this is not possible within the algorithm since it solves the maxwell equations locally in real space .",
    "in addition , the contribution in will not only include the dipole moment contribution of the folded particle coordinates within the box geometry but also that of the unfolded coordinates , since the phase space history of the system is stored in the magnetic field .     +    for clarification , two simulations were set up , and the results can be seen in figure  [ fig : dipole - moments ] .",
    "first , an electrolyte was simulated over a long time and the total dipole moment of the system was recorded for the original and the corrected implementation , as well as with metallic and @xmath87 boundaries ( figure  [ fig : dipole - moments - fluctuation ] ) . for the corrected local algorithm and with metallic boundaries , a random walk of the dipole moment can be observed , as expected for an unrestricted system .",
    "the uncorrected algorithm shows the same behavior as with @xmath87 boundaries , forcing the dipole moment to remain around zero in a harmonic potential .",
    "second , two charges of opposite sign are placed in a system and slowly pulled apart by an external field ( figure  [ fig : dipole - moment - force ] ) . for the uncorrected algorithm ,",
    "the oscillating force on one particle induced by the periodic images of the second particle is overshadowed by the influence of the resetting dipole force for the linearly increasing dipole moment of the system .    as can be seen in figure  [ fig : dipole - moments - fluctuation ] ,",
    "this true 3d periodic behavior of relates to boundary conditions of @xmath88 at infinity in the equivalent .",
    "this is an unwanted effect , and in a local real space method , there is no mathematical trick to apply metallic boundary conditions as in ewald methods .",
    "the solution in our implementation is to calculate the system s dipole moment directly from the unfolded particle coordinates and subtract its influence from the force .",
    "this works reasonably well as long as there is no external driving force on the dipole moment .",
    "systems with an additional external field or other means of introducing a net electric current will result in a drift in the dipole moment to a point where the dipole correction outweighs the actual force on the particles , and the algorithm breaks down . in these cases ,",
    "the system has to be re - initialized quite often , and the badly scaling numerical relaxation leads to slow performance .",
    "therefore , systems with external driving forces on charged particles should be avoided for .",
    "two changes to the algorithm have to be validated in simulations : the adapted scheme for our initial solution and the extended dynamic algorithm for varying permittivity . for the initial scheme ,",
    "we check two setups against their analytical solution .",
    "since there is no analytical solution for the dynamic behavior of such a system , we will investigate the distribution of particles in statistical equilibrium for a system that has been studied with monte carlo simulations  @xcite and can also be simulated with an algorithm for dielectric interfaces  @xcite .      to validate the initial solution for spatially varying dielectric media , the field",
    "is compared to the analytical solution in a system that consists of a single charge in the box center and a dielectric background that is @xmath89 at the charge position and linearly rises with distance ( @xmath90 ) .",
    "this can be solved analytically using direct spherical integration .",
    "+    the result can be inspected in figure  [ fig : linear - dielectric - data ] and matches the analytic prediction .",
    "the relative rms error of the absolute field value stays well below the algorithmic precision limit of @xmath75 , which is not surprising since the error contribution of the retarded solutions due to the dynamic algorithm is not present yet .",
    "while the absolute error shows no spatial preference , the relative error shown in figure  [ fig : linear - dielectric - error ] is very small in the cell center and increases near the boundaries .",
    "this behavior shows that the absolute error is independent of the local field strength and only influenced by the lattice spacing .      in order to validate the thermodynamic behavior of the extended algorithm , we place a charged particle between two dielectric walls and",
    "manually drag it from the center to one of the walls . in this artificial case",
    ", the force on the particle can be theoretically predicted in every position and compared to the simulation .",
    "the results can be seen in figure  [ fig : dielectric - wall ] and match the analytical prediction up to algorithmic precision .",
    "+    a less conceptional and more physical simulation is performed with a fixed colloid ( charge @xmath91 , radius @xmath92 , hard sphere boundary ) in a solution of counterions and salt ( concentration @xmath93{mmol / l}$ ] ) .",
    "the radial distribution of the ions around the colloid is measured and compared against the results of a monte carlo simulation from  @xcite and an md simulation using the icc@xmath94 algorithm for sharp dielectric boundaries  @xcite .",
    "the data matches very well , but shows slight deviation at short distances from the boundary .",
    "this is due to the linear lattice interpolation of charges which leads to inaccuracy where charges are very close to each other , at the order of one lattice spacing .",
    "+    both adapted algorithms ( initial and thermodynamics ) match the established methods and theoretical predictions to the expected precision . as long as the systematic limitations",
    "( see  [ sec : limitations ] ) are kept in mind , the algorithm produces valid results .",
    "[ sec : limitations ]    the scaling with the number of particles follows the linear @xmath0 theoretical prediction as can be seen in figure  [ fig : scaling ] .",
    "the strong parallel scaling works but shows some communication overhead .",
    "this is due to the large amount of data being exchanged ( @xmath95-fields , @xmath40-fields , electric currents and charges for all lattice sites at domain boundaries ) .",
    "to @xmath96 particles . for this system ,",
    "the implementation is slower than the optimized solver , but the inclusion of dielectric changes comes at no extra cost . ]    in comparison to other methods , performs acceptably . at a comparable rms force error of @xmath75 , the tuned implementation in runs at about @xmath97 times as fast ( see figure  [ fig : scaling ] ) .",
    "all scalings and simulations were done within the package  @xcite .",
    "considering that does not include dielectric interfaces or variations and has been highly optimized , this is an acceptable loss in speed .",
    "a more thorough performance analysis and comparison to other methods is presented within the library for scalable fast coulomb solvers ,  @xcite .",
    "the algorithm comes with some systematic limitations .",
    "first , as pointed out in section  [ sec : periodicity ] , the system should not have an externally driven dipole moment , i.e.  an electric current .",
    "second , while not impossible , highly inhomogenous systems will reduce the precision noticeably and the speed drastically ( see section  [ sec : error ] ) .",
    "third , fixed charges within the system ( i.e.  charges that are forced to stay at a predefined position ) should be avoided since we noticed that the system equilibrates more slowly and these charges give rise to systematic errors in their close vicinity . since the algorithm will only propagate fields created from electric currents within the system , and non - moving charges do not produce any current , this will lead to the effect that the influence of a charge is lessened .",
    "pseudo - fixed charges enclosed in a strong potential are a way around this problem .",
    "lastly , for simulations that require a very high precision in force , the linear interpolation scheme is not feasible ( see section  [ sec : error ] ) .",
    "we have extended the existing algorithm to deal with spatially varying dielectric properties . in the theoretical part",
    ", we have analytically proven that the algorithm reproduces correct behavior , conserves energy and reproduces the expected equations of motion .",
    "we have introduced an error estimate and a correction for the dipole moment influence arising from periodic boundary conditions . in the simulational part , we have shown that our implementation of the algorithm can reproduce analytical solutions and simulation results based on the induced charge algorithm icc@xmath94 .",
    "we have also tested and verified the linear scaling of the implementation .",
    "the extended algorithm is an interesting method , and able to dynamically deal with charges in locally varying properties with very little computational overload .",
    "it is of high interest to researchers who study electrolytic systems and highly charged objects , such as dna strands or colloids .",
    "the method has already been applied successfully to several research projects , and publications are in preparation .              c.  holm , p.  kkicheff , and r.  podgornik , eds . , _",
    "electrostatic effects in soft matter and biophysics _ , vol .",
    "46 of _ nato science series ii - mathematics , physics and chemistry_. dordrecht , nl : kluwer academic publishers , dec . 2001 .",
    "isbn(hardbound ) : 1 - 4020 - 0196 - 7 , isbn(paperback ) : 1 - 4020 - 0197 - 5 .    c.  holm ,",
    "`` efficient methods for long range interactions in periodic geometries plus one application , '' in _ computational soft matter : from synthetic polymers to proteins _ ( n.  attig , k.  binder , h.  grubmller , and k.  kremer , eds . ) , vol .",
    "23 of _ nic series _ , research centre jlich , 2004 .",
    "d.  boda , t.  varga , d.  henderson , d.  d. busath , w.  nonner , d.  gillespie , and b.  eisenberg , `` monte carlo simulation study of a system with a dielectric boundary : application to calcium channel selectivity , '' _ molecular simulation _ , vol .",
    "30 , no .  2 , pp .",
    "8996 , 2004 .",
    "s.  tyagi , a.  arnold , and c.  holm , `` electrostatic layer correction with image charges : a linear scaling method to treat slab 2d + h systems with dielectric interfaces , '' _ journal of chemical physics _ , vol .  129 , no .  20 , p.  204102",
    ", 2008 .    c.  tyagi , m.  szen , m.  sega , m.  barbosa , s.  kantorovich , and c.  holm , `` an iterative , fast , linear - scaling method for computing induced charges on arbitrary dielectric boundaries , '' _ journal of chemical physics _ , vol .",
    "132 , p.  1154112",
    ", 2010 .",
    "a.  arnold , k.  breitsprecher , f.  fahrenberger , s.  kesselheim , o.  lenz , and c.  holm , `` efficient algorithms for electrostatic interactions including dielectric contrasts , '' _ entropy _ , vol .",
    "15 , no .  11 , pp .",
    "45694588 , 2013 .",
    "b.  lu , x.  cheng , j.  huang , and j.  a. mccammon , `` order n algorithm for computation of electrostatic interactions in biomolecular systems , '' _ proceedings of the national academy of sciences _ , vol .  103 , no .  51 , p.  19314",
    ", 2006 .",
    "m.  d. altman , j.  p. bardhan , j.  k. white , and b.  tidor , `` accurate solution of multi - region continuum biomolecule electrostatic problems using the linearized poisson  boltzmann equation with curved boundary elements , '' _ journal of computational chemistry _",
    "30 , no .  1",
    ", pp .  132153 , 2009 .",
    "d.  j. bonthuis , s.  gekle , and r.  r. netz , `` profile of the static permittivity tensor of water at interfaces : consequences for capacitance , hydration interaction and ion adsorption , '' _ langmuir _ , vol .",
    "28 , no .  20 , pp .",
    "76797694 , 2012 .",
    "d.  boda , d.  henderson , b.  eisenberg , and d.  gillespie , `` a method for treating the passage of a charged hard sphere ion as it passes through a sharp dielectric boundary , '' _ the journal of chemical physics _ , vol .",
    "135 , p.  064105",
    ", 2011 .",
    "v.  jadhao , f.  j. solis , and m.  o. de  la cruz , `` a variational formulation of electrostatics in a medium with spatially varying dielectric permittivity , '' _ the journal of chemical physics _ , vol .",
    "138 , p.  054119",
    ", 2013 .",
    "a.  arnold and c.  holm , `` efficient methods to compute long range interactions for soft matter systems , '' in _ advanced computer simulation approaches for soft matter sciences ii _ ( c.  holm and k.  kremer , eds . ) , vol .",
    "ii of _ advances in polymer sciences _ , pp .",
    "59109 , berlin : springer , 2005 .",
    "s.  sonntag , c.  trichet  paredes , j.  roth , and h .-",
    "trebin , `` molecular dynamics simulations of cluster distribution from femtosecond laser ablation , '' _ aluminum applied physics a _ , vol .",
    "104 , no .  2 , pp .",
    "559565 , 2011 .",
    "s.  pasquali , f.  nitti , and a.  c. maggs , `` numerical methods for fluctuation - driven interactions between dielectrics , '' _ physical review e : statistical , nonlinear , and soft matter physics _ , vol .  77 , 2008 .            a.  arnold , o.  lenz , s.  kesselheim , r.  weeber , f.  fahrenberger , d.  rhm , p.  koovan , and c.  holm , `` espresso  3.1  molecular dynamics software for coarse - grained models , '' in _ meshfree methods for partial differential equations vi _ ( m.  griebel and m.  a. schweitzer , eds . ) , vol .",
    "89 of _ lecture notes in computational science and engineering _ , pp .",
    "123 , springer , 2013 .",
    "s.  w. de  leeuw , j.  w. perram , and e.  r. smith , `` simulation of electrostatic systems in periodic boundary conditions .",
    "i. lattice sums and dielectric constants , '' _ proceedings of the royal society of london .",
    "series a : mathematics and physical sciences _ ,",
    "373 , pp .  2756 ,",
    "1980 .",
    "a.  arnold , f.  fahrenberger , c.  holm , o.  lenz , m.  bolten , h.  dachsel , r.  halver , i.  kabadshow , f.  ghler , f.  heber , j.  iseringhausen , m.  hofmann , m.  pippig , d.  potts , and g.  sutmann , `` comparison of scalable fast methods for long - range interactions , '' _ phys .",
    "e _ , vol .",
    "88 , p.  063308",
    ", dec 2013 ."
  ],
  "abstract_text": [
    "<S> the local approach to computing electrostatic interactions proposed by a.  maggs and adapted by j.  rottler and i.  pasichnyk for molecular dynamics simulations is extended to situations where the dielectric background medium is inhomogeneous . </S>",
    "<S> we furthermore correct a problem of the original algorithm related to the correct treatment of the global dipole moment , provide an error estimate for the accuracy of the algorithm , and suggest a different form of the treatment of the self - energy problem . </S>",
    "<S> our implementation is highly scalable on many cores , and we have validated and compared its performance against theoretical predictions and simulation data obtained by other algorithmic approaches . </S>"
  ]
}