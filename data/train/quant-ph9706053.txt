{
  "article_text": [
    "quantum computation involves the transformation of one known pure quantum state into another unknown state , which can be measured to provide a computationally useful output .",
    "traditionally , it has been understood that an important part of this process is proper preparation of a fiducial initial pure state , such that the computational input is well known , and the output is thus meaningful . in particular",
    ", it has usually been assumed that the input can not be a stochastic mixture .",
    "however , two groups@xcite have recently shown that by using a different technique , called _ bulk quantum computation _ , the same computation can be performed but with an initial mixture state , which is often much easier to achieve experimentally .",
    "bulk quantum computation is being implemented for small numbers of qubits using nuclear magnetic resonance ( nmr ) techniques .",
    "bulk quantum computation is performed on a large ensemble of indistinguishable quantum computers . at the beginning of a computation ,",
    "each member @xmath0 of the ensemble is in an initial state @xmath1 such that the average @xmath2 of these states is known .",
    "a bulk computation with such an ensemble can be divided into three steps consisting of preparation , computation and readout .",
    "each of these steps is equivalent to an application of the same quantum operation to each member of the ensemble .",
    "the purpose of the preparation step is to transform the input state to an _ effective pure state _ which permits an unbiased observation of the output of the algorithm .",
    "the computation is assumed to be a fixed unitary operator derived from a standard quantum algorithm , that is an algorithm with a one qubit answer .",
    "we wish to determine this answer on input @xmath3 ( the state where every qubit is @xmath4 ) .",
    "the readout procedure may include some postprocessing of the algorithm s output and terminates in the measurement of the observable @xmath5 , the spin along the @xmath6-axis of the first qubit . in bulk quantum computation ,",
    "the measurement yields a noisy version of the average value of @xmath5 over the ensemble of quantum computers .",
    "for our signal to noise analyses , we assume that the noise is unbiased with variance @xmath7 .    formally , a bulk quantum computation of an algorithm implementing the unitary transformation @xmath8 with preparation and postprocessing operations @xmath9 and @xmath10 transforms @xmath11 to _ out & = & _ i , jr_icp_j_0p_j^c^r_i^ , where the @xmath12 and @xmath13 are the operators in a linear representation of the quantum operations @xmath9 and @xmath10  @xcite . the measurement step of the readout procedure yields @xmath14 with noise . in the methods investigated in this paper ,",
    "@xmath10 is unitary , usually the identity .",
    "the purpose of @xmath9 is to create an _ effective pure state_. the simplest example of an effective pure state is a density matrix of the form",
    "_ j p_j_0 p_j^&= & p|00| + qn i. here @xmath15 , where @xmath16 is the number of qubits . if @xmath17 , then @xmath18 , so that ( _ out_z^(1 ) ) & = & p  ( c||c^_z^(1 ) ) . if the excess probability @xmath19 of the ground state @xmath3 is larger than the smallest detectable signal , we are able to determine whether the output of a standard algorithm is @xmath20 or @xmath21 by learning whether the measurement yields a negative or a positive value . to achieve sufficient confidence in the answer or",
    "to learn more about the average answer , the bulk computation is repeated several times .",
    "confidence @xmath0 in the answer of a standard algorithm at a signal to noise ratio of @xmath22 per experiment requires @xmath23 experiments .",
    "prior to the present work , there were two approaches to implementing an effective pure state preparation procedure .",
    "these approaches may be classified as _ spatial averaging _ and",
    "_ logical labeling_. spatial averaging was introduced and implemented by cory et al .  @xcite . in general",
    ", spatial averaging involves partitioning the ensemble of quantum computers into a number of subensembles and applying a different unitary operator to each of them .",
    "given enough subensembles and proper choices of unitary operators , the average density matrix over the whole ensemble can be transformed into an effective pure state .",
    "this procedure requires methods for distinguishing between quantum computers in the ensemble . in nmr",
    "this can be accomplished by using well - known gradient pulse methods to address individual cells in a bulk sample .",
    "the cells in the implementation of cory et al .",
    "are two dimensional slices of constant magnetic fields defined by a transient gradient .",
    "the logical labeling technique of gershenfeld and chuang  @xcite is fundamentally different ; it avoids the use of explicit subensembles by exploiting ancillary qubits as labels .",
    "an initial unitary transformation is applied which redistributes the states in such a way that conditional on the state of the labels , an effective pure state is obtained in the qubits to be used for computation .",
    "gershenfeld and chuang demonstrated that this can be done efficiently in the high temperature limit for non - interacting qubits , where @xmath11 can be expressed as a small deviation from @xmath24 .    here , we consider a new and different technique : _ temporal averaging_. rather than attempting to guarantee an effective pure state in a single experiment , this method uses several experiments with different preparation steps chosen either systematically or randomly .",
    "the measurements from each experiment are averaged to give the final answer .",
    "the preparation steps are chosen such that the average of the prepared input states is an effective pure state .",
    "the advantages of this method are that no ancillary qubits are needed , it can be implemented to work at any temperature and it is not necessary to distinguish subensembles of quantum computers . in the high temperature regime",
    "it can be implemented efficiently without any loss of signal , and in general , the signal to noise ratios are sufficiently well behaved to permit efficient determination of the desired answer to any given level of confidence",
    ".    we will describe several temporal averaging methods and discuss their properties .",
    "temporal averaging methods can be loosely categorized into high temperature and low temperature methods .",
    "the high temperature methods tend to be simpler and are the most efficient for nmr quantum computations involving small numbers of qubits .",
    "three such methods will be described : exhaustive averaging , labeled flip&swap and randomized flip&swap .",
    "labeled flip&swap uses a limited form of logical labeling to obtain the desired answer in two experiments with only one ancilla , while randomized flip&swap needs no ancillas but may require additional experiments to overcome noise from the randomization procedure .",
    "flip&swap methods rely on an inversion symmetry of high temperature thermal states of non - interacting particles .",
    "low temperature methods do not require special assumptions on the initial state , but tend to use more operations to implement .",
    "two such methods are of interest , randomization over a group and averaging by entanglement .",
    "the first depends on which unitary group is used .",
    "we will show that there are groups which yield good signal to noise behavior and which can be implemented in cubic time .",
    "averaging by entanglement has the advantage of requiring fewer experiments , but necessitates discarding some of the qubits .",
    "this method may be useful if some of the qubits are discarded anyway for the purpose of polarization enhancement by computational cooling , a family of techniques for statically or dynamically increasing polarization of the ground state for a subset of the available qubits .",
    "the different temporal averaging methods are introduced and analyzed in the following sections .",
    "we begin with a simple example borrowed from nmr , discuss exhaustive averaging and the flip&swap methods , show how randomized averaging over a group can be used and give the method based on entanglement .",
    "more detailed descriptions of the algorithms and the mathematical analyses are in the appendix .",
    "it is assumed that the reader is familiar with the basic concepts of quantum computation  @xcite and nuclear magnetic resonance  @xcite .",
    "to illustrate the ideas on which temporal averaging is based , consider a two qubit example from room temperature nmr with liquids .",
    "the density matrix of an ax system consisting of a proton and a carbon-13 nucleus in a 400mhz spectrometer is approximately given by = + 10 ^ -5 .",
    "how to calculate these input states will be discussed below . because all relevant observables are traceless , we focus our attention on the second matrix , the _ deviation density matrix_. suppose our goal is to perform some computation @xmath8 on the ground state @xmath25 and then to observe @xmath26 on the proton .",
    "for this observation , the states @xmath27 , @xmath28 and @xmath29 constitute noise . to remove this noise we can exploit the fact that the computation and the observation are linear in the input .",
    "we perform three experiments , each with a different preparation step which permutes the undesirable input states , and then average the output .",
    "the first experiment uses the unmodified input , corresponding to preparation with @xmath30 . the second permutes @xmath31 using the unitary transformation p_1 & = & .",
    "[ eq : pone ] this results in the input state _ 1 = p_1 p_1^= + 10 ^ -5 .",
    "the third preparation applies the inverse permutation @xmath32 to produce the input state",
    "_ 2 = p_2 p_2^ + 10 ^ -5 .",
    "the average of the input density matrices is then given by |&= & _ i p_i p_i^ + & = & + 10 ^ -5 + & = & ( -0.33310 ^ -5 ) + 10 ^ -5 .",
    "[ eq : twoeps ] the average of the measurements of @xmath5 after a computation gives @xmath33 .",
    "it can be seen that the contributions to the measurements of the undesirable input states have been eliminated . in nmr , @xmath5 is measured by applying a radiofrequency pulse to rotate the magnetization of the target spin into the plane and observing the free induction decay as discussed in  @xcite .",
    "the example of the previous section is an instance of _ exhaustive averaging_. for @xmath16 qubits , it involves cyclicly permuting the non - ground states in @xmath34 different ways such that the average of the prepared states is given by @xmath35 .",
    "this method works for any initial state which is diagonal in the computational basis states .",
    "although the number of experiments required grows exponentially , it is reasonable to consider implementing it for small numbers of qubits .    to design the quantum network for the preparation steps",
    ", one can exploit the structure of the galois field @xmath36 . if the non - ground initial states are labeled by elements of @xmath36 , multiplication by a non - zero element @xmath37 of this field",
    "implements one of the cyclic permutations . since multiplication can be implemented with a reasonable ( quadratic ) number of controlled nots , each such @xmath37 yields a preparation operator @xmath38 .",
    "details are given in the appendix .",
    "the seven networks needed to exhaustively average three qubits are in figure  [ figure : ex - av-3 ] .    the signal to noise ratio of exhaustive averaging is determined by the sensitivity of each measurement , the excess probability in the ground state and the number of experiments being performed .",
    "if the initial density matrix is @xmath39 with @xmath40 , then the average density matrix over all experiments is given by @xmath41 , where @xmath42 .",
    "if the computation s output is @xmath43 , then the observed average signal is @xmath44 . given that the variance of the noise in each measurement is @xmath7 , the standard deviation of the noise in the average is @xmath45 , which gives an overall signal to noise ratio of @xmath46 .",
    "typically , the density matrix will describe a high temperature , polarized system of non - interacting spins , in which case @xmath47 , where @xmath48 is the single spin polarization ( see section  [ section : flip&swap ] ) .",
    "it is also convenient to define @xmath49 as the signal to noise ratio from a single spin measurement , such that we may express the signal to noise ratio of exhaustive averaging as & & |x| _ 1 .",
    "this argument assumes no bias in the individual measurements . to ensure that exhaustive averaging works correctly for standard quantum algorithms , the bias must be small compared to @xmath50",
    "_ flip_&_swap _ is a method which exploits special properties of the high temperature thermal state for non - interacting particles to create an effective pure state with few experiments .",
    "if the internal hamlitonian of a collection of @xmath16 qubits is given by @xmath51 , then the thermal state is given by & = & , where @xmath52 is the usual boltzmann factor and @xmath53 is the partition function normalization factor . at high temperatures ,",
    "a good approximation is to take _ in ( i - ) , where @xmath54 and we have defined energies so that @xmath55 .    consider the case where the hamiltonian for the qubits is that of non - interacting distinguishable particles with energy eigenstates @xmath4 and @xmath56 and energies @xmath57 and @xmath58 , respectively , for the @xmath59th qubit .",
    "this is a good approximation for many spin systems in nmr , provided that the coupling constants are small compared to the chemical shift differences between the different spins . in this case , the energy eigenstates are close to the standard computational basis states and the energy shifts due to coupling are small compared to the larmor frequencies .",
    "the probability of the state @xmath60 for bit string @xmath61 is given by _",
    "bb & = & _ i=0^n-112(1 + ( -1)^b_i_i ) with ( 1+_i ) & = & e^e_ie^e_i + e^-e_i .",
    "to first order , @xmath62 is the polarization of the @xmath59th qubit .",
    "thus we can write _ bb & = & 1n(1+_i=0^n-1(-1)^b_i_i ) , where this first order approximation is valid as long as @xmath63 .",
    "given the linear approximation to @xmath64 , it can be seen that if @xmath65 is obtained from @xmath66 by flipping each bit , then @xmath67 .",
    "thus to obtain an unbiased , uniform input from two experiments , it suffices to perform one experiment with no preparation step and one with all the qubits flipped in the preparation step , averaging the results .",
    "however , this eliminates effective polarization in the ground state as well as all the other states .    to retain the ground state polarization",
    "we can perform two experiments . in the first",
    ", the thermal input state is used without modification by applying preparation operator @xmath30 . in the second ,",
    "the preparation @xmath68 consists of first inverting each qubit by applying @xmath69 and then swapping the ground state @xmath3 with the state @xmath70 ( all qubits in state @xmath56 ) .",
    "the average of the two prepared states is given by _ s & = & 1n ( i + _ t ( || - || ) ) .",
    "[ equation : def_rho_s ] there are two methods for eliminating the remaining polarization in @xmath70 . the first , _ randomized _ flip&swap , uses randomization to average this polarization over all non - ground states . the second , _ labeled _",
    "flip&swap , uses one of the qubits as a logical label , following the method of  @xcite    the simplest randomization method involves first selecting a random non - ground state @xmath60 and applying a unitary operation @xmath71 which maps @xmath72 and leaves the ground state unchanged .",
    "both preparation steps are modified by adding this unitary operation after the flip&swap and before the computation . to improve the signal to noise ratio",
    ", the whole procedure can be repeated several times .",
    "@xmath71 can be implemented efficiently using at most @xmath73 controlled - nots .",
    "the signal to noise ratio for a randomized flip&swap now depends not only on the initial polarization of the ground state , the computation and the sensitivity of the measurements , but also on the contribution to the variance from the random choice of @xmath71 .",
    "the detailed calculations of this variance will be given in the appendix .",
    "if all the polarizations @xmath74 are the same , @xmath75 , we define @xmath49 ( the signal to noise ratio for a measurement @xmath5 of the thermal state ) , and a lower bound on the signal to noise ratio is given by & & n2^n |x| _ 1 .",
    "graphs of the behavior of the signal to noise ratio of this and the other methods are given in figure  [ figure : snr - comp ] .",
    "for small @xmath16 , the limited number of possible random choices results in a significant reduction in the signal to noise ratio .",
    "however , a reasonable number of repetitions of the experiment can still reliably determine any bias in @xmath37 , if @xmath37 is not too small .",
    "an improvement in the @xmath22 can also be obtained by using randomization over the normalizer group as discussed in section  [ section : rand - group ] .",
    "this is called _ fully randomized _ flip&swap .    labeled flip&swap requires @xmath76 qubits and applies the flip&swap operation to all them . instead of removing the polarization in @xmath70 by averaging , it is exploited by using the @xmath76th qubit as a label similar to the methods introduced in  @xcite .",
    "this method was discovered independently by d. leung .",
    "conditionally on the @xmath76th qubit being in state @xmath4 , the first @xmath16 qubits are in an effective pure state with excess probability in @xmath3 . conditionally on the @xmath76th qubit being in state @xmath56 , the first @xmath16 qubits are in an effective pure state , but with a deficiency in @xmath70 .",
    "both experiments preparation steps must be followed by an operation which conditionally on the @xmath76th qubit flips all the other qubits to turn the conditional deficiency in @xmath70 into one in @xmath3 . after the computation is complete",
    ", the deficiency can be turned into an effective excess by conditionally reversing the sign of the answer . the full network for @xmath77",
    "is given in figure  [ figure : lab - f&s ] .",
    "the signal to noise ratio for labeled flip&swap is given by & = & ( n+1 )",
    "exhaustive averaging is useful for small numbers of qubits and flip&swap works for nearly non - interacting qubits at high temperatures .",
    "if the number of qubits and the polarization satisfy @xmath78 or if the initial state does not have approximate inversion symmetry , it is necessary to consider other methods which are both reasonably efficient and can be applied to arbitrary initial states .",
    "randomization based on groups of unitary operators has this property .",
    "in general , randomization involves choosing a preparation operator @xmath79 according to a predetermined probability distribution . to ensure that the expected value of the measurement represents the output of the computation on an effective pure state",
    ", we require that @xmath80 is an effective pure state . the methods to be discussed",
    "satisfy that |&= & ( _ 00-|p)|00| + |p i , with @xmath81 .",
    "it is desirable that the initial state @xmath82 has excess probability in the ground state .",
    "if possible , the true initial state should be transformed by a unitary transformation which guarantees that the maximum probability state is the ground state , and that the density matrix is diagonal in the computational basis .",
    "( for nearly uniform mixtures of states and high sensitivity , it may be more efficient to have a sufficiently large deficiency in the ground state . )",
    "let @xmath83 , so that @xmath84 . a single experiment with randomized preparation yields the measurement @xmath85 with variance @xmath7 ; the expectation of @xmath86 is given by @xmath87 .",
    "the signal to noise ratio for a single run of the computation is determined by comparing the variance @xmath88 of @xmath86 to @xmath89 .",
    "thus , the signal to noise ratio is ( p , c , ) =    @xmath90 to within @xmath91 , the number of experiments required to achieve confidence @xmath0 is proportional to @xmath92 in the gaussian regime . due to the large number of choices in the randomization it is reasonable to expect that this regime applies even for one experiment .",
    "if this is were not the case , the average would need to be inferred by techniques robust against outliers .",
    "if we are only interested in learning the sign of @xmath90 with confidence @xmath0 , this can be done with @xmath93 experiments , regardless of the actual distribution .",
    "one method is to use the sign of the median of the @xmath94 averages of the results from @xmath95 independent experiments .",
    "because the probability of the event that the average of @xmath96 experiments has the wrong sign is bounded by @xmath97 , the probability of failure is @xmath98 .",
    "the constant in the exponent can be obtained from the chernoff - hoeffding bounds  @xcite for the probablity of having more than @xmath99 heads in @xmath94 flips of a biased coin with the probability of head given by @xmath97 .    to compute the variance of @xmath86 ,",
    "define & & -_p pp^ + & = & - |p i - ( _ 00-|p)|00|",
    ". then |v & = & _ p(pp^)^2 + & = & _ p((pp^pp^ ) ( ) ) + & = & ( _ p ( pp^pp^ ) ( ) ) . thus",
    "to ensure that @xmath90 is as desired and to compute @xmath88 , we first verify that @xmath100 and then compute @xmath101 .    in the algorithms described below ,",
    "@xmath79 is a random product of operators , each chosen uniformly from various groups of unitary operators .",
    "the desired expectations can often be computed in closed form if @xmath79 is a random element of a unitary group @xmath102 . for this purpose , it is convenient to use the representations of @xmath102 defined by @xmath103 and @xmath104 , where @xmath105 is linearly extended to all four - tensors .",
    "both @xmath106 and @xmath107 are unitary representations of @xmath102 for the usual inner product of operators and four - tensors : @xmath108 and @xmath109 , with the latter inner product extended bilinearly to all four - tensors . using this representation , for @xmath79 sampled uniformly from @xmath102",
    ", it follows that the expectations can be obtained by projecting @xmath82 and @xmath110 onto the trivial eigenspaces of @xmath106 and @xmath107 .",
    "specifically , let @xmath111 and @xmath112 be the projection superoperators onto the space of all @xmath113 such that @xmath114 and onto the space of all @xmath115 such that @xmath116 , respectively",
    ". then @xmath117 and @xmath118 .",
    "we use this to calculate variances resulting from averaging over four groups , below .",
    "if the initial density matrix is not diagonal and it is not feasible to perform the unitary transformation which makes it diagonal in the computational basis , one can use randomization over a diagonal group to reduce the effect of the offdiagonal entries .",
    "let @xmath119 be a group of diagonal operators @xmath120 , with @xmath121 . to ensure sufficiently small trivial eigenspaces for the representations @xmath106 and @xmath107 , we require that the following phase independence condition holds : if @xmath122 for all @xmath123 , then @xmath124 and @xmath125 or @xmath126 and @xmath127 .",
    "we call a group with this property a _ diagonal group_. randomization over @xmath119 is accomplished by choosing a member of @xmath119 uniformly and applying it to the initial state . although the expectation of the randomized density matrix is not yet an effective pure state , it does reduce the off - diagonal contributions to the expectation and the variance .",
    "for example , _",
    "p pp^&= & _ i=0^n-1_ii|i| . to obtain an effective pure state ,",
    "additional randomization steps are required .",
    "the expectations needed for computing variances are calculated in the appendix .",
    "an efficiently implementable diagonal group @xmath119 can be obtained as a subgroup of the normalizer group introduced below .",
    "let @xmath128 be a two - transitive group of permutations acting on the set of states @xmath129 . by definition , for every @xmath130 and @xmath131 , there is a permutation @xmath132 such that @xmath133 and @xmath134 . then _",
    "p_1 , p_2 p_2p_1 p_1^p_2^&= & ( _ 00-|p)|00| + |p i , which is the desired effective pure state . an effective pure state would be obtained on average even with a one - transitive group , such as the cyclic permutations used for exhaustive averaging . however , the variance for one - transitive groups can be quite large and two - transitivity helps in reducing it .    to give the upper bound on @xmath88 for randomization with @xmath119 and @xmath128 , define _ d & & _ i1 _ ii|i| , then    appendix .",
    "in the high temperature regime , this implies a signal to noise ratio of at least & & n2^n|x|_1 .",
    "efficiently implementable two - transitive permutation groups can be obtained from the normalizer group .",
    "the normalizer group @xmath135 , more specifically , the normalizer of the error group , consists of all unitary operations @xmath136 which satisfy that for any tensor product of pauli operators @xmath137 , @xmath138 is also a tensor product of pauli operators ( up to a phase factor ) .",
    "if the pauli operators are labeled by @xmath139 and , for example , @xmath140 , then the elements of the normalizer group are characterized by @xmath141 , where @xmath37 is an arbitrary bit vector , @xmath142 denotes the inner product modulo @xmath143 of bit vectors and @xmath144 is an arbitrary invertible ( modulo 2 ) 0 - 1 matrix which satisfies @xmath145 , where @xmath146 is the bit vector obtained from @xmath66 by swapping adjacent bits belonging to the same factor .",
    "the exponent @xmath147 depends only on @xmath66 and @xmath144 ; its values are not needed for the present analyses .",
    "the group of matrices @xmath144 with this property acts transitively on non - zero bit vectors .",
    "the normalizer group yields several subgroups useful for randomization .",
    "* linear phase shifts .",
    "*    the group @xmath119 generated by controlled - sign flips and the operator @xmath148 acting on any qubit consists of diagonal operators with action @xmath149 , where @xmath37 is a vector with entries in @xmath150 and @xmath115 is an arbitrary @xmath16 by @xmath16 0 - 1 matrix . to check that the phase independence condition ( section  [ section : diagonal ] ) holds , suppose that for all @xmath37 and @xmath151 , x^t(k - l+m - n ) + 2(k^t y z^t k - l^ty z^tl + m^t y z^t m - n^t y z^t n ) & = & 0(4 ) . +",
    "this implies that @xmath152 . if @xmath153 , then @xmath154 , since @xmath155 and @xmath16 are all 0 - 1 vectors .",
    "if not , without loss of generality , suppose that @xmath156 . to derive a contradiction ,",
    "suppose also that @xmath131 and @xmath157 .",
    "if @xmath158 is not in the span ( modulo two ) of @xmath159 and @xmath16 , then there exists @xmath6 orthogonal ( modulo two ) to @xmath159 and @xmath16 , but not @xmath158 , which contradicts the equality above",
    ". thus @xmath158 must be in the span of @xmath159 and @xmath16 .",
    "if @xmath158 is not in the span of two of them , say @xmath160 and @xmath161 , then there exists @xmath6 orthogonal to @xmath160 and @xmath161 but not @xmath158 and a @xmath162 orthogonal to @xmath16 but not @xmath158 .",
    "again , we find that the equality can not hold",
    ". thus it must be the case that @xmath163 , @xmath164 and @xmath165 .",
    "this implies that @xmath166 and @xmath167 .",
    "thus the desired independence condition holds .",
    "* linear cyclic permutations . *    a group @xmath168 acting cyclicly on the set @xmath169 is obtained by representing the field @xmath36 as a vector space over @xmath170 with elements represented by bit strings of length @xmath16 in some basis .",
    "multiplication by non - zero elements of @xmath36 defines a cyclic subgroup of @xmath171 of order @xmath34 .",
    "* linear permutations .",
    "*    the group @xmath128 of linear permutations is generated by the controlled - not operations .",
    "the group consists of the unitary @xmath136 s which satisfy @xmath172 , where @xmath144 is an invertible ( modulo two ) 0 - 1 matrix .",
    "the group acts two - transitively on the set @xmath173 .",
    "randomization over the normalizer group is as effective for variance reduction as is randomization over the unitary group .",
    "the main difficulty is that the normalizer group does not fix @xmath4 .",
    "this can be remedied by alternating randomization with @xmath128 and with the conditional normalizer group @xmath174 which acts on the first @xmath73 qubits given that the last one is in state @xmath56 .",
    "the first step in the procedure is to randomize with @xmath119 ( if needed ) and @xmath128 .",
    "each following step involves randomizing with @xmath174 and then with @xmath128 .",
    "the total number of steps determines how effective the randomization is .",
    "the procedure is designed such that the expectation of the resulting density matrix is the desired effective pure state after every step .",
    "the variance @xmath175 after the @xmath158th step can be estimated by ( see the appendix ) : |v_k+1 & & ^knn-2(_d^2 ) + 1n-2 ^ 2 , with @xmath176 . in the high temperature regime",
    "this implies a signal to noise ratio of & & n2^n|x|_1 , where @xmath158 was chosen such that @xmath177 .",
    "the temporal randomization methods discussed above are useful when the device is qubit limited , in the sense that it is difficult to access additional qubits .",
    "it is important to realize that ancillary qubits involved only in preparation and postprocessing generally do not need to have long decoherence or relaxation times .",
    "for example , if they are used only in the preparation phase , their quantum coherence does not need to be maintained in computation or readout . if such ancillas are available , they can and should be used to simplify the effective pure state preparation . interestingly ,",
    "if an additional @xmath16 qubits are available , it is possible to prepare a nearly perfect effective pure state for any diagonal initial state by exploiting entanglement .",
    "here is an explicit algorithm which results in an effective pure state on the first @xmath16 qubits given @xmath178 qubits .",
    "the basic idea is to map the computational basis states other than the ground state on the first @xmath16 qubits to nearly maximally entangled states .",
    "write a computational basis state on the @xmath178 qubits as @xmath179 , where @xmath180 and @xmath66 are length @xmath16 bit vectors .",
    "let @xmath37 be a generator of the multiplicative group of non - zero elements of @xmath36 .",
    "the desired unitary transformation is the composition of the maps p_1&:&|a|b_c(-1)^b , c|a|c , + p_2&:&|a|b|a x^b|b , where @xmath66 is interpreted as a bit vector in the first exponent and as a binary number in the second .",
    "consider the reduced density matrix @xmath181 on the first @xmath16 qubits derived from the state @xmath182 . if @xmath183 , _ ab & = & 1n(i-|00| + |a| ) + _ 0b & = & |00| .",
    "this is nearly an effective pure state . if @xmath82 is the reduced initial density matrix on the first @xmath16 qubits and @xmath82 is diagonal , then after applying @xmath184 , the reduced density matrix is ( ( _ 00-|p)|00| + |p",
    "the deviation from the effective pure state is sufficiently small to be of no concern in most cases .",
    "entanglement can be exploited even if less than @xmath16 additional bits are available .",
    "in fact , essentially the same algorithm works .",
    "however , the deviation from an effective pure state becomes larger and residual bias must be removed by another technique such as randomization . in general , if ancillary qubits are available , the effectiveness of averaging methods can be improved .",
    "for example , we can randomize the states @xmath179 with @xmath183 with the subgroup @xmath185 of the group of linear permutations which preserves the subspace @xmath186 .",
    "if this does not reduce the variance enough , a version of the conditional normalizer randomization method can be used , where @xmath185 is used instead of the full group of linear permutations .",
    "ancillary qubits are likely to be available whenever a computational cooling method is used to increase the probability of the ground state in some of the available qubits",
    ". computational cooling uses ancillas and in - place operations to transfer heat from the computational qubits to the ancillas .",
    "the simplest such methods are based on decoding a classical error - correcting code in - place and exploiting the fact that the thermal state is equivalent to a noisy ground state .",
    "the temporal randomization methods can find immediate application in nmr quantum computation , even with simple molecules , as we demonstrate with the following experimental results utilizing exhaustive averaging to extract an effective pure state from a two spin system .",
    "using a model two spin system , we prepared an effective state similar to that of eq.([eq : twoeps ] ) from a thermal state .",
    "this was done by implementing the quantum circuits shown in fig .",
    "[ fig : permcirc ] to perform the permutation of eq.([eq : pone ] ) and its inverse .",
    "the two - spin physical system used in these experiments was carbon-13 labeled chloroform ( fig .",
    "[ fig : chloroform ] ) supplied by cambridge isotope laboratories , inc .",
    "( catalog no .",
    "clm-262 ) , and used without further purification . a 200 millimolar sample was prepared with d6-acetone as a solvent , degassed , and flame sealed in a standard 5 mm nmr sample tube , at the u.c .",
    "berkeley college of chemistry .",
    "spectra were taken using bruker amx-400 ( u.c .",
    "berkeley ) and drx-500 ( los alamos ) spectrometers using standard probes .",
    "the resonance frequencies of the two proton lines ( in the drx-500 ) were measured to be at @xmath187 mhz and @xmath188 mhz , and the carbon lines were at @xmath189 mhz and @xmath190 mhz , with errors of @xmath191 hz .",
    "the radiofrequency ( rf ) excitation carrier ( and probe ) frequencies were set at the midpoints of these peaks , so that the chemical shift evolution could be suppressed , leaving only the @xmath192 hz j - coupling between the two spins .",
    "the @xmath193 and @xmath194 relaxation times were measured using standard inversion - recovery and carr - purcell - meiboom - gill pulse sequences . for the proton , it was found that @xmath195 sec , and @xmath196 sec , and for carbon , @xmath197 sec , and @xmath198 sec .",
    "the short carbon @xmath194 time is due to coupling with the three quadrupolar chlorine nuclei , which shortens the coherence time .",
    "nevertheless , these time scales were all much longer than those of the operations applied , guaranteeing that we could implement quantum transforms and observe quantum dynamics .",
    "we performed _",
    "quantum state tomography _ to systematically obtain the final quantum state ; this procedure will be described in detail elsewhere  @xcite . in each tomography procedure ,",
    "nine experiments were performed , applying different pulses to measure all the possible elements in the density matrix in a robust manner .",
    "the resulting deviation density matrix for the thermal state is shown in fig .",
    "[ fig : denmats]a .",
    "as expected , all the off - diagonal elements are nearly zero , while the diagonal elements follow a pattern of @xmath199 , @xmath200 , @xmath201 , and @xmath202 .",
    "an error of about @xmath203% was observed in the data , due primarily to imperfect calibration of the @xmath204 pulse widths and inhomogeneity of the magnetic field .",
    "the two permutation quantum circuits were implemented using the pulse programs shown in fig .",
    "[ fig : permpulses ] .",
    "because of the absence of phase correction steps in the controlled - not gates@xcite , the actual transforms implemented were not exactly those of eq.([eq : pone ] ) , but rather , p_1 & = & [ eq : ponetilde ] + p_2 & = & [ eq : ptwotilde ] .",
    "for the purposes of temporal randomization of an initially diagonal density matrix , the phases of the transformations can be ignored .",
    "we obtained the density matrices shown in fig .",
    "[ fig : denmats]b - c from these two transformations .",
    "the effective pure state we obtained was approximately |= - 57 i [ eq : twoepsexpt ] , where @xmath205 .",
    "an error of @xmath206 was calculated , based on analysis of the linewidth integration , least squares fitting used in the tomography procedure , and standard error propagation .",
    "this result compares favorably with the result expected from eq.([eq : twoeps ] ) .",
    "further work has been done to use this state as an input into a non - trivial computation ; that work demonstrates the creation and manipulation of effective pure states which are in superpositions , and will be reported elsewhere@xcite .",
    "( a )  ( b )   + ( c )  ( d )",
    "we have described new techniques for creating effective pure states which complement the logical labeling and spatial averaging techniques previously discovered .",
    "our _ temporal averaging _ methods are unique in their use of summation over experiments carried out at different times and powerful by virtue of averaging over transformations chosen systematically ( in the case of labeled flip&swap ) or randomly ( for randomization over a transformation group ) .",
    "the choice of temporal averaging method in an experiment depends on the number of qubits available , how many are required for computation , the initial density matrix and the desired signal to noise ratio .",
    "a summary of our recommendations based on the analyses in this manuscript follows : for small numbers of qubits exhaustive averaging can be used for any initial density matrix which is diagonal in the computational basis .",
    "if the initial state is close to that of non - interacting particles at high temperature , the flip&swap techniques can be used . if a non - computational qubit is available , then labeled flip&swap is the simplest and most efficiently implemented method .",
    "asymptotically it requires a linear number of quantum operations , and unless high signal to noise ratios are needed , involves many fewer experiments than exhaustive averaging . in terms of quantum operations ,",
    "exhaustive averaging appears to be more efficient up to at least four qubits .",
    "the actual minimum number of qubits for which labeled flip&swap uses fewer quantum operations per experiment then exhaustive averaging depends on the implementation and remains to be determined .",
    "if every qubit is required for computation , then randomized flip&swap can be used at a cost of more quantum operations per experiment . for large numbers of qubits where the high temperature regime or the non - interacting assumption fails , randomization over a group can be used .",
    "if ancillary qubits are available , randomization can be combined with entanglement .",
    "it remains to be seen whether this situation will be encountered in practice .",
    "future theoretical work will investigate combinations of logical , spatial , and temporal labeling techniques , and establish a connection between these procedures and error - correction .",
    "experiments will also be performed to demonstrate the different techniques with large molecules and to explore their relative merits in practice .",
    "* acknowledgements . *",
    "d. leung independently discovered that labeling and temporal averaging could be combined in the high temperature regime by labeled flip&swap .",
    "thanks to w. zurek for encouraging our work on nmr quantum computation .",
    "we profited from stimulating discussions with j. anglin and d. divincenzo , and ackowledge m. kubinec , p. catasti and s. velupillai for experimental assistance .",
    "in particular we thank s. velupillai for suggesting the use of labeled chloroform in the experiment .",
    "this work was performed under the auspices of the u.s .",
    "department of energy under contract no .",
    "w-7405-eng-36 .    10    n. gershenfeld , i. chuang , and s. lloyd , in _ proceedings of the 4th workshop on physics and computation _",
    "( new england complex systems institute , boston , massachusetts , 1996 ) , p.  134 .",
    "n.  a. gershenfeld and i.  l. chuang , science * 275 * , 350 ( 1997 ) .",
    "d.  g. cory , a.  f. fahmy , and t.  f. havel , in _ proceedings of the 4th workshop on physics and computation _ ( new england complex systems institute , boston , massachusetts , 1996 ) , pp .",
    "d.  g. cory , a.  f. fahmy , and t.  f. havel , proceedings of the national academy of sciences of the united states of america * 94 * , 1634 ( 1997 ) .",
    "b. schumacher , quant - ph/9604023 ( unpublished ) .",
    "a. ekert and r. jozsa , reviews of modern physics ( 1993 ) .",
    "a. yao , in _ proceedings of the 34th annual symposium on foundations of computer science _",
    "( ieee press , address , 1993 ) , pp .",
    "352360 .",
    "a. barenco , contemporary physics * 37 * , 375 ( 1996 ) .",
    "r.  r. ernst , g. bodenhausen , and a. wokaun , _ principles of nuclear magnetic resonance in one and two dimensions _ ( oxford university press , oxford , 1994 ) .",
    "n. alon , j. spencer , and p.  e. os , _ the probabilistic method _",
    "( john wiley & sons , new york , 1992 ) .    i.  l. chuang , n. gershenfeld , m. kubinec , and d. leung , submitted to _ proc .",
    "royal soc .",
    "a_. ( unpublished ) .",
    "a. barenco _",
    "a * 52 * , 3457 ( 1995 ) .",
    "d. randall , random structures and algorithms * 4 * , 111 ( 1993 ) .",
    "r. cleve and d. gottesman , quant - ph/9607030 ( unpublished ) .",
    "the expectation and variance of the outcome of an experiment using randomization over a group @xmath102 can be determined from the trivial eigenspaces of the representations @xmath207 and @xmath208 . in the next sections ,",
    "these eigenspaces are determined and the resulting variances estimated .",
    "we begin with some calculations for the diagonal groups .",
    "let @xmath119 be a diagonal group as defined in section  [ section : diagonal ] .",
    "this group is used to diagonalize the average density matrix before randomizing with more powerful groups .",
    "we compute the projections onto the trivial eigenspaces of both representations @xmath106 and @xmath107 .",
    "_ p p|i|p^&= & _ i , j|i| , and _ p p|i|p^p|k|p^ & = & |i||k | , + _ p p|i|p^p|k|p^ & = & |i||k | .",
    "other expectations of @xmath209 are @xmath20 .",
    "the projections of @xmath210 and @xmath211 onto the trivial eigenspaces of @xmath106 and @xmath107 are therefore given by _",
    "p pp^&= & _ i0_ii|i| , + _",
    "p pp^pp^&= & _ i , j0_ii|i|_jj|j| + _ i = j0_ij|i|_ji|j| .",
    "+ unfortunately , it is impossible to completely eliminate the contributions of the off - diagonal elements of @xmath82 to the variance by this method . as will be seen , to reduce the effect of these contributions it is necessary to ensure that @xmath82 is approximately diagonal by an initial unitary operation , or to design the algorithm so that @xmath137 is approximately diagonal ( as will be the case if the output of the algorithm is deterministic when given one of the computational basis states for input ) .    the calculations for the other groups to be presented below assume that @xmath82 has already been randomized by a diagonal group .",
    "as a result , only the subspaces spanned by @xmath212 ( for @xmath106 ) and by @xmath213 ( for @xmath107 ) and @xmath214 will be considered in our analysis .",
    "let @xmath128 be a two - transitive permutation group which fixes @xmath4 .",
    "it is straightforward to check that for @xmath130 _",
    "p p|i|p^&= & 1n-1_i|i| , + _",
    "p p|i|p^&= & 1(n-1)(n-2)_i=j|i| , where the indices in the sums range from @xmath21 to @xmath215 .",
    "this convention for indices and labels will be in place for the remainder of the appendix unless otherwise indicated .",
    "the relevant part of the trivial eigenspace of @xmath106 is spanned by @xmath216 and an operator with no diagonal entries . for @xmath130 , _",
    "p p|i|p^p|i|p^ & = & 1n-1_i|i| |i| , + _",
    "p p|i|p^p|j|p^ & = & 1(n-1)(n-2)_i=j|i||j| , + _ p p|i|p^p|j|p^ & = & 1(n-1)(n-2)_i=j|i||j| , + _ p p|0|p^p|j0|p^ &",
    "= & 1(n-1)_j|0||j0| , + _ p p|j0|p^p|0|p^ & = & 1(n-1)_j|j0||0| and expressions involving other combinations of indices which will be of no further concern . the relevant part of the trivial eigenspace of @xmath107 is therefore spanned ( non - orthogonally ) by d & & _ i|i||i| , + e & & _ i,j|i||j| , + j & & _ i,j|i||j| , + z_1 & & _ i|0||i0| , + z_2 & & _ i|i0||0| .    define _ 0 & & _ i1_0i|i0|+_i0|0| , + _ |0 & & - _ 0 . if @xmath79 is a random product of operators in @xmath128 and in a diagonal group @xmath119 , then _",
    "p_1d , p_2 p_2p_1p_1^p_2^&= & 1n-1_i_ii i = 0 , + _",
    "p_1d , p_2 p_2p_1p_1^p_2^ p_2p_1p_1^p_2^ & = & 1n-1_i_ii^2d + & & + _",
    "i= j _ ii_jj(e - d ) + & & + _ i = j _ ij_ji(j - d ) + & & + _ i_0i_i0 ( z_1+z_2 ) + & = & 1n-1(_d^2)d + & & + ( ( _ |0)^2-(_d^2))(e - d ) + & & + ( ( _ |0 ^ 2 ) -(_d^2 ) ) ( j - d ) + & & + ( _ 0 ^ 2 ) ( z_1+z_2 ) .",
    "[ equation : two - trans ] the variance @xmath88 is obtained by taking the inner product of this expression with @xmath217 .",
    "define _ d & & _ i_ii|i| , + _ 0 & & _ i_0i|i0|+_i0|0| , + _ |0 & & -_0 - _ 00|00| .",
    "we will make use of the following ( in)equalities : & = & _",
    "|0 + & = & _ d + & = & 0 , + ( ^2 ) & = & ( _ |0 ^ 2 ) + ( _ 0 ^ 2)+ _ 00 ^ 2 + ( n-1)|p^2 + & & 1 , + ( _ |0 ) & = & -_00 , + ( ^2 ) & = & ( _ |0 ^ 2 ) + ( _ 0 ^ 2 ) + _ 00 ^ 2 + & = & n , + ( _ 0 ^ 2 ) + 2_00 ^ 2 & = & 2 , + ( _ d^2 ) & & ( _ |0 ^ 2 ) + & & n-1 , where we used the properties of the trace inner product and the fact that @xmath137 is unitary",
    ". the variance can now be estimated by |v & = & 1n-1(_d^2)(_d^2 ) + & & + ( ( _ d)^2-(_d^2 ) ) ( ( _ d)^2 - ( _ d^2 ) ) + & & + ( ( _ |0 ^ 2 ) -(_d^2 ) ) ( ( _ |0 ^ 2 ) - ( _ d^2 ) ) ) + & & + ( _ 0 ^ 2)(_0 ^ 2 ) + & & ( _ d^2 ) + 1n-2 ( _ d^2 ) + 1n-2((_|0 ^ 2)-(_d^2 ) ) + 1n-1(_0 ^ 2 ) + & & ( _ d^2 ) + 1n-2(^2 ) . both of the terms in this expression can be large compared to @xmath89 .",
    "the presence of the second term shows the importance of ensuring that @xmath82 is initially in a nearly diagonal form , and implies a limit on the effectiveness of the diagonal group .",
    "however , if @xmath137 is diagonal in the computational basis , the second term does not arise .",
    "the signal to noise ratio for the thermal distribution can now be obtained as follows . with the definitions from section  [ section : flip&swap ] , ( ^2 ) & = & _ i=1^n-1(_ii-|p)^2 + & & _ i=0^n-1(_ii - 1n)^2 + & = & _ i=0^n-1_ii^2 - 1n + & = & _ i=1^n14((1+_i)^2 + ( 1-_i)^2 ) - 1n + & = & 12^n(_i=1^n(1+_i^2 ) - 1 ) + & & 12^n(e^_i_i^2 - 1 ) , + ^2 & & 12^n_i_i^2 . the last expression is a good approximation as long as @xmath218 .",
    "the probability of the ground state is given by _ 00 & = & 12^n_i=1(1+_i ) + & & 12^n(1+_i_i ) , which is a good approximation as long as @xmath219 .",
    "thus the signal to noise ratio for randomization using a two - transitive group is bounded by & & _ i_i|_00| . to understand the behavior of this expression ,",
    "consider the case where @xmath75 is independent of the qubit .",
    "we express @xmath220 in terms of the signal to noise ratio @xmath221 for a single qubit , @xmath222 . for a typical nmr experiment with protons , @xmath223 . with these definitions , & & n|_00|   + & & n2^n_1|_00| . for small @xmath16 , @xmath22 is dominated by the contribution to the variance from the randomization process , while for large @xmath16 , it is dominated by the reduction in excess probability in the ground state .",
    "consider using a cyclic group @xmath224 of permutations which leave @xmath4 fixed .",
    "this was done for exhaustive averaging , but can also be applied to randomization . as we will see , the main problem is that the variance of the measurements can not be guaranteed to be sufficiently small .",
    "let @xmath225 be a generator of the group of order @xmath215 .",
    "the trivial eigenspaces of @xmath224 can be computed as in the previous section .",
    "the relevant subspaces are spanned by @xmath226 for @xmath106 and d_k & & _ i 1|i||^k(i)^k(i)| , + j_k & & _ i1|i^k(i)||^k(i)| , @xmath227 , @xmath228 and a few others of no further concern for @xmath107 .",
    "let @xmath79 be a random product of an element of a diagonal group @xmath119 and the cyclic group @xmath224 .",
    "_ p_1 , p_2_1 p_2p_1p_1^p_2^&= & 0 , + _",
    "p_1 , p_2_1 p_2p_1p_1^p_2^p_2p_1p_1^p_2^ & = & _ k=0^n-21n-1 _ i_ii_^k(i)^k(i ) d_k + & & + _ k=1^n-21n-1 _ i_i^k(i)_^k(i)i j_k + & & + ( _ 0 ^ 2 ) ( z_1+z_2 ) . to compute @xmath88",
    "we take the trace after multiplying by @xmath217 . |v & = & _ k=0^n-21n-1 _ i_ii_^k(i)^k(i ) _",
    "i_ii_^k(i)^k(i ) + & & + _ k=1^n-21n-1 _ i_i^k(i)^2 _ i_i^k(i)_i^k(i ) + & & + ( _ 0 ^ 2)(_0 ^ 2 ) .",
    "the sum involves off - diagonal expressions and products of correlations of the diagonals of @xmath82 and @xmath137 .",
    "although @xmath88 can be much too high in the worst case , in practice one can expect it to be close to what was obtained for a two - transitive group .",
    "however , since the known algorithms for the cyclic groups are no more efficient than those for the linear group , there is presently little to be gained by using cyclic groups .",
    "a spanning set of eigenvectors of the representation @xmath107 of the unitary group @xmath136 acting on @xmath129 consists of @xmath229 , @xmath230 , @xmath227 , @xmath228 and @xmath231 . as a result one obtains _",
    "pupp^pp^ & = & 12n(n-1 ) ( ( _ d)^2 + ( _ |0 ^ 2))(e+j ) + & & + 12(n-1)(n-2 ) ( ( _ d)^2 - ( _ |0",
    "^ 2))(e - j ) + & & + 12(n-1)(_0 ^ 2)(z_1 + z_2 ) + & = & 1n(n-2)(_|0 ^ 2)j -1n(n-1)(n-2)(_|0 ^ 2)e + 12(n-1)(_0 ^ 2)(z_1 + z_2 ) .",
    "thus |v & = & 1n(n-2)(_|0 ^ 2)(_|0 ^ 2 ) -1n(n-1)(n-2)(_|0 ^ 2)(_d)^2 + 12(n-1)(_0 ^",
    "2)(_0 ^ 2 ) + & & n-1n(n-2)(_|0 ^ 2 ) + 1n-1(_0 ^ 2 ) + & & 1n-2(^2 ) . by using the unitary group ,",
    "it is possible to eliminate the term @xmath232 that occurs in the expression for @xmath88 for the two - transitive permutation groups .",
    "although it is impossible to efficiently implement random elements of the unitary group , there are effective methods for accomplishing the same by using the normalizer group .",
    "the normalizer group is as effective at randomizing @xmath233 as the full unitary group , at least in terms of expectations and variance .",
    "it is straightforward to determine the trivial eigenspaces of @xmath106 and @xmath107 in the pauli operator basis . for @xmath130 and @xmath234 , _ pn p_i p^&= & _ i,0_0 , + _ pn p_i p^p_j p^ & = & 0 , + _ pn p_j p^p_j p^ & = & 12 ^ 2m-1_j=0_j_j , + where @xmath161 is the number of qubits . using these identities , it can be verified that the trivial eigenspace of @xmath106 is spanned by the identity , and that of @xmath107 by @xmath235 and @xmath236 .    to exploit the normalizer group without removing the polarization in @xmath4 requires conditioning it on one of the qubits .      in this section",
    "we analyze the behavior of the algorithm based on alternate randomizations using @xmath128 and the conditional normalizer group @xmath174 .",
    "let @xmath237 be the expectation of @xmath238 after the @xmath158th step of the conditional normalizer group algorithm .",
    "using eq.([equation : two - trans ] ) , |r_0 & = & 1(n-1)(n-2)(n(_d^2 ) - ( _ |0 ^ 2))d + 1(n-1)(n-2)((_|0 ^ 2)-(_d^2))j + & & -(_d^2)e",
    "+ & & + ( _ 0 ^ 2)(z_1+z_2 ) .",
    "define @xmath239 , @xmath240 , @xmath241 and @xmath48 by @xmath242 , where we have used the fact that @xmath243 are not affected by randomization with @xmath128 and @xmath174 .    because @xmath174 distinguishes the state of the first qubit",
    ", we need to subdivide the tensors in the expression for @xmath244 .",
    "write @xmath245 , @xmath246 and @xmath247 .",
    "for example , @xmath248 , @xmath249 and @xmath250 , where we are using the convention that the indices @xmath251 are those referring to states with the first qubit in state @xmath56 .",
    "randomizing over @xmath174 preserves all but one of these expressions : _",
    "p_1_2(p)(d_1 ) & = & 2n+ 2j_11 + 2n+2e_11 . + hence _",
    "p_1_2(p)(|r_k ) & = & _ kd_0 + _ k j+2n+2_kj_11 + _ ke + 2n+2_ke_11 + ( z_1+z_2 ) . randomizing over @xmath128 gives _",
    "p_2(p)(d_0 ) & = & n-22(n-1)d , + _ p_2(p)(e_11 ) & = & n2(n-1)d + n4(n-1)(e - d ) , + & = & n4(n-1)d + n4(n-1)e + _",
    "p_2(p)(j_11 ) & = & n2(n-1)d + n4(n-1)(j - d ) + & = & n4(n-1)d + n4(n-1)j , so that |r_k+1 & = & _ p_2_p_1_1_2(p_2p_1)(|r_k ) ) + & = & ( 1-n^22(n-1)(n+2))_kd + ( _ k + n2(n+2)(n-1)_k ) j + ( _ k + n2(n+2)(n-1)_k)e + ( z_1+z_2 ) ) . the variance @xmath175 after the @xmath158th step is given by |v_k+1 & = & ( |r_k+1 ) + & = & _ k+1(_d^2 ) + _ k+1(_|0 ^ 2 ) + _ k+1(_d)^2 + ( _ 0 ^ 2 ) .",
    "we can estimate the coefficients as follows : _",
    "0(_d^2)&&nn-2(_d^2 ) , + _ 0(_|0 ^ 2 ) & & 1n-2((_|0 ^ 2 ) - ( _ d^2 ) ) , + _ 0(_d)^2 & = & -1(n-1)(n-2)(_d^2)(_d)^2 + & & 0 , + ( _ 0 ^ 2 ) & & 1n-1_0 ^ 2 , + _",
    "k+1(_d^2 ) & = & 12(1+n-2(n-1)(n+2))_k(_d)^2 + & & 12e^1n+2_k(_d^2 ) + & & 12^ke^kn+2nn-2(_d^2 ) . define @xmath252 .",
    "the coefficients @xmath253 and @xmath241 are monotonically increasing .",
    "the limiting values are _ ( _ |0 ^ 2 ) & = & ( _ 0 + 1n_0)(_|0 ^ 2 ) + & & 1n-2(_|0 ^ 2 ) , + _ ( _ d)^2&= & ( 1n_0+_0)(_d)^2 + & & 0 . thus |v_k+1 & & ^knn-2(_d^2 ) + 1n-2(^2 ) . by choosing @xmath158 large enough",
    ", the variance can be reduced to near that obtainable by randomizing over the whole unitary group .",
    "in fact , if @xmath158 is chosen so that @xmath254 , then the maximum contribution to the variance is @xmath255 .",
    "consider the case where @xmath82 is diagonal with @xmath256 maximal , @xmath257 and the output of the algorithm is deterministic ( i.e. @xmath258 ) .",
    "then @xmath259 and & & _ 00-|p + & & . consequently , if @xmath260 , the signal to noise ratio is dominated by @xmath261 , the term due to measurement noise . if @xmath262 , then the signal to noise ratio is determined by the contribution from the randomization method .",
    "as long as @xmath263 is sufficiently smaller than @xmath256 and @xmath264 the signal to noise ratio is bounded below by a constant , which ensures that a small number of experiments are required to determine whether @xmath265 or @xmath266 . however , in the case where @xmath267 , the signal to noise ratio can be very small , for example if @xmath268 or @xmath269 for all @xmath59 .",
    "the situation where @xmath267 is small arises in the high temperature limit of nmr quantum computation . in this case",
    "the signal to noise ratio can be estimated as & & n2^n_1|_00| .      for fully randomized flip&swap , each experimental determination of the output of the computation consists of two experiments .",
    "first a sequence of @xmath158 random operators implementing the conditional normalizer method is chosen .",
    "for the present purposes we choose @xmath158 so that @xmath270",
    ". next two experiments are performed . in the first the chosen sequence of operators",
    "is applied before measuring @xmath137 . in the second ,",
    "the flip&swap operation is used before applying the same sequence of random operators and measuring @xmath137 .",
    "the measurements are added to obtain the desired answer .",
    "this algorithm behaves exactly like a single randomized experiment with input @xmath271 ( eq.([equation : def_rho_s ] ) ) and measurement variance @xmath272 .",
    "the variance of the randomization is therefore given by |v & & 2n-1(_s^2 ) + & & 2 n^2 ^ 2n^2 ( n-1 ) .",
    "substituting in the expression for the signal to noise ratio gives & & n2^n _ 1|_00| , where we have taken into account the fact that two experiments contributed to the signal .    instead of using the conditional normalizer group , one can use any set of permutation operators @xmath273 with @xmath274 and @xmath275 .",
    "for example , a cyclic linear group can be relabeled to have this property . because of the symmetries of @xmath271 , this is as effective as using a two - transitive group . since @xmath276 , |v & & ( 2^n-1 ) n^2 ^ 22 ^ 2n(2^n-2 ) and & & n2^n _ 1|_00| .",
    "the implementation of labeled flip&swap for three qubits and an ancilla is shown in figure  [ figure : lab - f&s ] .",
    "the flip&swap is the first group of gates , consisting of a not applied to each qubit , followed by controlled - nots from the first to each of the other qubits , an @xmath73-controlled - not conditioned on the last @xmath73 qubits being @xmath4 , and finally a reversal of the first set of controlled - nots .",
    "efficient quantum networks for the @xmath73-controlled not ( generalized toffoli gates ) are given in  @xcite .",
    "note that for diagonal initial states , phase variants are equivalent , so we can use an @xmath277 variant of the toffoli gate to avoid ancillas while still having an @xmath278 implementation .",
    "also , the computation can be arranged so that it is @xmath278 even if controlled operations can only be performed between adjacent qubits in a linear ordering .",
    "an efficient method for implementing randomized flip&swap is to choose for each @xmath279 an `` easy '' linear operator @xmath144 modulo 2 such that @xmath280",
    ". if @xmath66 has @xmath281 one s , such an operator with at most @xmath282 off - diagonal ones exists .",
    "the corresponding unitary operator in the group of linear permutations can be implemented with @xmath282 controlled nots .",
    "every element of the normalizer group @xmath135 operating on @xmath16 qubits can be implemented by @xmath283 controlled - nots and @xmath284 or @xmath225 rotations of single qubits . for the purposes of randomly choosing one of the members of @xmath135 , the natural representation of @xmath285 is u:_b u_bu^&= & ( -1)^x , bi^f(b , l)_lb .",
    "a uniform random element can be obtained by choosing @xmath37 and @xmath144 uniformly subject to @xmath286 ( see section  [ section : normalizer - group ] ) .",
    "the vector @xmath37 is obtained by setting each of the @xmath178 entries of @xmath37 independently and uniformly to @xmath20 or @xmath21 .",
    "to obtain uniformly distributed valid @xmath144 s one can construct @xmath144 column by column .",
    "write m & = & , where the entries are @xmath16 by @xmath16 matrices and the partitioning is based on writing the index @xmath66 of @xmath287 in the form @xmath288 , with @xmath289 and @xmath290 containing the indices coming from the first and second members of each qubit s pair , respectively .    if @xmath291 is the @xmath178 by @xmath158 matrix consisting of the first @xmath158 columns of @xmath144 , then @xmath292 , where @xmath293 is the @xmath158 by @xmath158 matrix submatrix of @xmath294 in the upper left corner .",
    "the columns of @xmath291 are linearly independent ( modulo @xmath143 ) .",
    "suppose @xmath291 has been constructed and we wish to add another column to obtain @xmath295 .",
    "the new column @xmath296 has to satisfy l_k+1^t m l_k+1 & = & 0 , + l_k+1^t m l_k & = & m_k+1,k .",
    "the first equality is satisfied for any @xmath296 , so we wish to choose @xmath296 randomly , not in the span of @xmath291 and subject to the second equality .",
    "the dimension of the affine space of solutions to this equality is @xmath297 , while the dimension of the span of @xmath291 is @xmath158 .",
    "we consider two cases . if @xmath298 , then @xmath299 , and the span of @xmath291 is contained in the space of solutions . because @xmath300 , suitable @xmath296 can be found .",
    "to pick @xmath296 uniformly one can use any algorithm ( e.g. one based on gaussian elimination modulo @xmath143 ) to obtain @xmath301 vectors @xmath302 independent of the columns of @xmath291 which together with @xmath291 span the solution space .",
    "a random @xmath296 is obtained by choosing a random non - zero linear combination of the @xmath302 and adding it to a random linear combination of the columns of @xmath291 .    if @xmath303 , then @xmath304 is non - zero .",
    "if @xmath162 is in the span of @xmath291 , then the @xmath305th entry of @xmath306 is zero .",
    "since that entry of @xmath304 is @xmath21 , the set of solutions to @xmath307 does not contain any element @xmath162 in the span of @xmath291 .",
    "we can therefore pick a random element in this affine subspace of dimension @xmath297 .",
    "an affine basis for this subspace can again be obtained by a gaussian elimination method .",
    "the above construction shows that the number of valid @xmath144 s is @xmath308 . in view of the technique for constructing random invertible matrices over @xmath309 given in  @xcite",
    ", there are probably more efficient methods for constructing random @xmath144 s .    to obtain a quantum network which implements the unitary operator defined by @xmath310 requires decomposing @xmath144 into elementary operations corresponding to controlled - nots and single qubit rotations .",
    "this can be done by adapting the methods described in  @xcite .",
    "the basic idea is to multiply @xmath144 on the left and right be the linear operators corresponding to controlled - nots and rotations . since controlled - nots correspond to elementary row / column operations in the @xmath16 by @xmath16 subblocks",
    ", one can apply gaussian elimination methods to convert the first ( say ) subblock to standard form .",
    "the @xmath284 rotations around the different axes permit elementary row / column operations between corresponding rows / columns of different subblocks .",
    "this can be used to transform @xmath144 to @xmath311 .",
    "the representation of the resulting sequence of controlled - nots and rotations is of the form @xmath312 . to correct the first component",
    ", one can apply @xmath313 to the qubits .",
    "the total number of gates needed to implement an operator in @xmath135 is @xmath283  @xcite .    * implementing @xmath119 . * being a subgroup of @xmath135 , it is clear that each operator in @xmath119 has an efficient quantum network .",
    "the random phase shifts of @xmath119 are described by operators @xmath314 defined by @xmath315 .",
    "a random such operator is obtained by choosing @xmath37 randomly and uniformly from all @xmath16 dimensional vectors over @xmath150 and @xmath115 uniformly from the set of strictly upper triangular @xmath16 by @xmath16 @xmath316 matrices .",
    "given such an @xmath37 and @xmath115 , the phase shifts are implemented by first applying phase shifts by @xmath317 of @xmath56 to the @xmath318th qubit , and then performing a sequence of controlled - sign flips . the sequence of controlled - sign flips can be read off the entries of @xmath115 by the following procedure : if @xmath319 , apply a controlled sign - flip between bits @xmath59 and @xmath318 .",
    "the number of operations required to apply the random phase shift is at most @xmath320 .    * implementing @xmath128 . * a unitary operator @xmath136 in @xmath128 is defined by @xmath172 for an invertible ( modulo @xmath143 ) @xmath16 by @xmath16 matrix @xmath144 .",
    "any such unitary operator can be implemented using only controlled - nots . since a controlled not corresponds to an elementary row / column operation , a decomposition of @xmath144 into such operations yields the desired quantum network .",
    "the decomposition can be accomplished by the usual gaussian elimination methods .",
    "a random invertible @xmath144 can be generated column by column using a simpler version of the method described for the normalizer group .",
    "a more efficient algorithm which can be used to construct the decomposition into elementary operations at the same time is described in  @xcite .",
    "the operations @xmath68 and @xmath321 required to implement the method for effective pure states by entanglement are implemented as follows .",
    "a phase variant equivalent to @xmath68 for diagonal initial states is obtained by applying a @xmath284 rotation around the @xmath162 axis to each of the second group of @xmath16 qubits . the operation @xmath321 is decomposed into the product of @xmath322 for @xmath323 .",
    "multiplication by @xmath324 in @xmath36 is a linear map modulo two and defines an element of @xmath128 which can be implemented with @xmath283 controlled - nots .",
    "each @xmath325 can therefore be implemented with @xmath283 toffoli gates , and @xmath184 takes @xmath326 operations ."
  ],
  "abstract_text": [
    "<S> in bulk quantum computation one can manipulate a large number of indistinguishable quantum computers by parallel unitary operations and measure expectation values of certain observables with limited sensitivity . </S>",
    "<S> the initial state of each computer in the ensemble is known but not pure . </S>",
    "<S> methods for obtaining effective pure input states by a series of manipulations have been described by gershenfeld and chuang  @xcite ( logical labeling ) and cory et al .  </S>",
    "<S> @xcite ( spatial averaging ) for the case of quantum computation with nuclear magnetic resonance . </S>",
    "<S> we give a different technique called temporal averaging . </S>",
    "<S> this method is based on classical randomization , requires no ancilla qubits and can be implemented in nuclear magnetic resonance without using gradient fields . </S>",
    "<S> we introduce several temporal averaging algorithms suitable for both high temperature and low temperature bulk quantum computing and analyze the signal to noise behavior of each </S>",
    "<S> .    [ section ] [ theorem]lemma </S>"
  ]
}