{
  "article_text": [
    "analytic modelling of photometric variations induced by stellar spots was presented several years ago ( budding 1977 ) providing the general solution for any given spot dimension and location across the stellar disk and any given limb darkening law .",
    "this solution holds under the assumptions that the star is a sphere and the spot profile is drawn from the interception of a cone with the stellar sphere .",
    "subsequently other investigators faced this problem from a theoretical standpoint .",
    "dorren ( 1987 ) and eker ( 1994 ) for example , reobtained an equivalent solution to that one of budding ( 1977 ) , but adopted a more convenient set of integration variables .",
    "in other cases more restrictive solutions than the one of budding ( 1977 ) have been discussed ( e. g. kipping 2012 ) .",
    "one of the most important limitations of current analytic models is their inability to construct spot regions being limited to the case of the so called circular spots introduced by budding ( 1977 ) .",
    "the purpose of this work is to reobtain the result of budding ( 1977 ) by following a different method , by means of which we will be able to construct the solution for more complex and realistic spots shapes in a very efficient and strightforward way .",
    "our results can be also applied to the calculation of photometric effects due to the occultation of spot regions by transiting objects .",
    "it is worth noting that photometric spot modelling is also performed by means of numeric integrations on a pixellized grid ( e. g. lanza et al .",
    "2010 , boisse et al .",
    "2007 , oshagh et al .",
    "2013 ) . nonetheless , despite the computational power of modern computers is far superior to those available in the past , analytic techniques still play a very important role in the context of stellar activity studies .",
    "this is due to the fact that inverting a lightcurve to derive spots geometries and distributions is in fact a very complex problem that in general does not lead to a unique solution .",
    "it is therefore necessary to explore a huge parameter space to derive the family of solutions that more likely satisfy the observational constraints .",
    "the dependencies among the physical parameters are explicitely stated in analytic models given that the functional form of the model is explicitely given , and this renders the analysis of the degenerate scenarios well suited for this technique .",
    "moreover analytic techniques allow us to sample the parameter space at a considerable higher speed than numerical methods which could be subsequently applied only to local minima regions eventually relaxing the simplifing assumptions to which analytic methods may be bounded .",
    "it should be stressed that , in particular in the case of single - band purely rotationally modulated lightcurves ( e. g. in the absence of additional information coming from eclipses , line broadening , multi - color photometry ) it is in general impossible to reconstruct the true spot distribution on the stellar surface ( russell 1906 ) .",
    "this is due to the fact that both limb darkening and foreshortening effects suppress high order terms in the fourier expansion of the lightcurve . by applying the maximum entropy reconstruction method",
    "it has been deduced that rotationally modulated lightcurves generated by an arbitrarily complex spot distribution can be reproduced by using no more than two compact regions ( e. g. collier cameron 1997 ) .",
    "eclipse mapping of stellar spots can be regarded as a more favourable approach to reconstruct spot geometries , in particular in the case of transiting planets given that planets are small , intrinsically dark and proximity effects can be neglected .",
    "photometric spot modelling is also complementary to spectroscopic techniques like zeeman doppler imaging ( zdi ) and doppler imaging .",
    "both of them are applied to the case of fast rotators .",
    "zdi allows to study stellar magnetic fields topologies from the analysis of sets of rotationally modulated circularly polarized profiles of photospheric lines ( e. g. donati & brown 1997 ) .",
    "doppler imaging monitors spectral line asymmetries to reconstruct the spatial distribution of active regions ( vogt & penrod 1983 ) .",
    "improvements on analytic modelling is highly reccomended especially once the observations require higher precision calculations .",
    "thanks to the advent of space satellites like most ( walker et al .",
    "2003 ) , corot ( auvergne et al . 2009 ) , and more recently kepler ( koch et al . 2010 ) a large database of very precise stellar photometric time - series is now available .",
    "perhaps one of the limitations of the work of budding ( 1977 ) is that the solution is explicitely stated only up to the case of linear limb darkening . for higher degrees of limb darkening the solution",
    "may be obtained from the lower degree solution by using recursive relations . in this work we decided to present explicitely the solution up to the quadratic term in the limb darkening law ,",
    "since this is presently the most widely adopted limb darkening law .",
    "another limitation of the analysis of budding ( 1977 ) is that the calculation is based on a direct integration of the stellar flux over the @xmath0 visible projected surface of the spot . if we wish , for example , to construct more realistic spot shapes by adding several smaller spots together , the solution presented by budding ( 1977 ) requires to subtract the flux from the overlapped regions and requires a complex calculation of the interception geometry .",
    "the same problem is present to calculate the photometric effect produced , for example , by a transiting planet occulting a stellar spot .",
    "as it has been recently demonstrated ( pl 2012 ) for the case of mutual transiting planets , this problem can be greatly simplified applying the kelvin - stokes theorem to the occulting region , and thereby performing the integral only over the border rather than over the entire surface of the region . in this work",
    "we develop further the idea proposed by pl ( 2012 ) applying it to the case of stellar spots and afterwords provide the link between the planet and spot calculations .",
    "as we will demonstrate this approach is far more efficient than the direct integration once dealing with complex geometries and still preserves the accuracy of the solution in its entire generality .",
    "considering fig .  1 ( left panel ) , we define a cartesian coordinate system centered on the stellar sphere which radius is normalized to one . the @xmath1 axis of the coordinate system is oriented along the line of sight of the observer , and the @xmath2 plane is coincident with the meridian of the star passing through the center of the stellar spot , thereby splitting the spot in two identical hemispheres .",
    "hereafter we will overline quantities that are considered constant during the integration .",
    "we define the angle @xmath3 along this meridian , between the sub - stellar point c and the center of the spot s ( the arc in fig .  1 ) .",
    "then we consider a great circle on the sphere passing through the center of the spot s and a generic point p on the spot profile . the arc measured along this circle",
    "is denoted by @xmath4 .",
    "we assume here that the spot profile on the sphere is drawn from the interception of a cone ( which vertex is at the center of the sphere ) with the sphere itself , and therefore @xmath4 is constant denoting the angular dimension of the spot .",
    "the angle between d and p in fig .",
    "1 , measured along the spot profile , is identified by @xmath5 .",
    "therefore , by using spherical trigonometry , we estabilish the following relationships between the cartesian coordinates of the position vector op , measured from the center of the sphere to the generic point p along the spot profile , and the angles above defined    @xmath6    and for the first derivatives of op with respect to @xmath5 we have    @xmath7    in fig  1 ( right panel ) we present the geometry of the problem once the spot intercepts the plane of the sky . in this case",
    "we define the angle @xmath8 between the position vector op at the interception point and the @xmath9 axis of the cartesian coordinate system measured along the great circle on the plane of the sky .",
    "recurring again to spherical trigonometry we estabilish the following definition for @xmath8    @xmath10    thanks to the kelvin - stokes theorem we know that the surface integral of the curl of a vector field @xmath11 across a closed surface @xmath12 on the sphere is equal to the line intgral of @xmath11 along the border @xmath13 of the surface    @xmath14    if we assume for @xmath11 the following functions we adopted are concident with those presented in pl ( 2012 ) with the only exception of @xmath15 for which we assumed a slightly simpler expression .",
    "it is however strightforward to calculate the correspondent integral of pl ( 2012 ) using our choice for @xmath15 . ]",
    "@xmath16    @xmath17    @xmath18    where @xmath19 and @xmath20 are the unit vector along the @xmath9 and @xmath21 axis , the respective curl evaluated on the surface of the sphere are    @xmath22    @xmath23    @xmath24    where @xmath25 is the unit vector along the @xmath1 axis .    adopting a quadratic limb darkening law and denoting with @xmath26 as usual the cosine of the angle between the normal to the stellar surface at a given point and the line of sight",
    ", we can express the stellar intensity as    @xmath27    since @xmath28 .",
    "therefore , by using the above definitions for @xmath11 and extending the integral of @xmath29 on the left hand side of eq .  1 to the surface of the spot , we will obtain respectively the projected surface of the spot along the line of sight , the linear and the quadratic limb darkening corrections .",
    "equivalently , these integrals can be calculated from the right hand side of eq .  1 , integrating @xmath11 along the border of the spot . in the next section",
    "we will proceed following the second approach .",
    "for the calculation of the projected surface ( which corresponds to the flux variation under the assumption of a constant luminosity across the stellar disk ) , the right - hand side of eq .  1 reads    @xmath30    the solution is :    @xmath31    once the spot is fully visible ( @xmath32 ) we set @xmath33 which gives    @xmath34    once the spot is partially visible ( @xmath35 ) we set @xmath36 ( which corresponds to the value of @xmath5 at the interception point with the plane of the sky ) , and we have then to proceed with the integration along the plane of the sky . to do that we will use as integration variable the more convenient angle @xmath37 defined in sect .",
    "[ s : definition ] which is measured along the great circle where the spot interception arc resides .",
    "we also note that @xmath38 can be expressed simply as @xmath39 .",
    "therefore the remaining integral is given by    @xmath40    where @xmath8 has been defined in section  [ s : definition ] . to have the result we have finally to sum eq .",
    "8 and eq .",
    "10    @xmath41    where the factor of two has been introduced to account for the remaining symmetrical hemisphere of the spot .",
    "the procedure reported above can be applied in the same manner also for the other cases corresponding to linear and quadratic limb darkening .",
    "here we only report the results of the calculations .      by substituting eq .  3 in the right hand side of eq .  1 and",
    "proceeding with the integration we obtain the following result for the linear limb darkening correction    @xmath42-\\\\ \\nonumber & -\\frac{1}{32}\\overline{\\alpha}\\big[3\\cos(2\\overline{\\psi}-3\\overline{\\theta})-8\\cos(\\overline{\\psi}-2\\overline{\\theta})-\\\\ \\nonumber & -3\\cos(2\\overline{\\psi}-\\overline{\\theta})-3\\cos(2\\overline{\\psi}+\\overline{\\theta})-\\\\ \\nonumber & -8\\cos(\\overline{\\psi}+2\\overline{\\theta})+3\\cos(2\\overline{\\psi}+3\\overline{\\theta})+\\\\ \\nonumber & + 16\\cos\\overline{\\psi}+30\\cos\\overline{\\theta}+2\\cos(3\\overline{\\theta})\\big]+\\\\ \\nonumber & + 2\\arctan\\big[\\tan\\frac{\\overline{\\alpha}}{2}\\cos\\big(\\frac{\\overline{\\theta}+\\overline{\\psi}}{2}\\big)\\sec\\big(\\frac{\\overline{\\psi}-\\overline{\\theta}}{2}\\big)\\big]+\\\\ & + \\cos\\overline{\\psi}\\sin^2\\overline{\\theta}\\,\\overline{\\alpha}-\\sin\\overline{\\psi}\\cos\\overline{\\theta}\\sin\\overline{\\theta}\\sin\\overline{\\alpha}\\big).\\end{aligned}\\ ] ]      for the quadratic limb darkening , with the aid of the following useful definitions    @xmath43    and    @xmath44    we can express the solution as    @xmath45    as it is possible to see , the solutions for the integrals are expressed as simple algebric and inverse trigonometric functions .",
    "this is a general result that was already proven by budding ( 1977 ) .",
    "as stated in pl ( 2012 ) it is interesting to calculate the solutions of the integrals also for any polynomial expansion of the stellar intensity with respect to the @xmath9 and @xmath21 coordinates .",
    "this can be done by using recursive relations giving the solution for higher order terms as a function of lower order terms . also , as correctly specified by pl ( 2012 ) to obtain the solution it is sufficient to calculate the expressions for the integrals of the form @xmath46 and @xmath47 .",
    "first of all introducing a notation similar to pl ( 2012 ) we note that in our case we can write    @xmath48    if we adopt the following definitions    @xmath49    @xmath50    @xmath51    @xmath52    then we can express @xmath53 as    @xmath54    where @xmath55 is the same expression as in pl ( 2012 ) .",
    "therefore eq.10-eq.17 of pl ( 2012 ) can be applied simply substituting @xmath56 with @xmath57 and considering the above definitions .",
    "the only case that can not be treated in this way is once @xmath58 ( once only half of the spot surface is visible ) . in that case",
    "however @xmath59 reduces to    @xmath60    then for the integrals @xmath61 and @xmath62 we have    @xmath63    @xmath64",
    "the integrals provided in sect.[s : solution ] are calculated in the reference system of each spot having the @xmath21 axis passing through the center of the spot , as defined in fig.1 .",
    "it is possible however to provide some more general expressions to calculate the integrals in a generic reference system , arbitrarily rotated around the z axis with respect to the reference system of a spot .    assuming therefore that the @xmath65 positive axis of this fixed reference system @xmath66 is rotated of an angle @xmath67 ( positive counter - clockwise ) with respect to the positive @xmath9-axis of a spot as defined in fig.1 , the novel @xmath65 and @xmath68 coordinates of a generic point on the spot border , as expressed in the new system are    @xmath69    where @xmath9 and @xmath21 are the coordinates of the point in the reference system of the spot , presented in sect.[s : definition ] .",
    "the expressions for the integrals are reported below      for the projected surface , applying the above equations for @xmath65 and @xmath68 and the function @xmath70 defined in eq .",
    "2 we have    @xmath71      for the linear limb darkening we simply have    @xmath72    where @xmath73 has been obtained in sect.[s : solution ] .      introducing the following definitions where @xmath74 and @xmath75 are as reported in sect.[s : solution ]    @xmath76    and    @xmath77    the solution is expressed as    @xmath78    where the reader can verify that imposing @xmath79 all the above integrals reduce to the simpler expressions presented in sect.[s : solution ] .",
    "as for the recurrent integrals we note that in the novel reference system the expression for @xmath59 is    @xmath80    since we can always expand the above expression as a polynomial of @xmath9 and @xmath21 , and since we already described in sect.[s : solution ] how to obtain the solution for any polynomial expansion of the stellar intensity as a function of the spot coordinates , to obtain the solution in the fixed coordinate system it is sufficient to sum the results of the integration over each term of the expansion of @xmath59 .",
    "it is now possible to provide the solution for the calculation of multiple spots overlap and occultations of spots by transiting bodies . for the latter case",
    "we note that pl ( 2012 ) already provided the integrals to calculate the flux intercepted by a transiting body with the kelvin - stokes theorem .",
    "given that in this work we provided the integrals for the case of spots with the same approach , it is sufficient to join the two results to obtain the general solution .    for convenience we will adopt here the same naming convention of pl ( 2012 ) with only a slight useful modification .",
    "the projected shape of a spherical transiting body on the plane of the sky is a circle , while that one of a spot is an ellipse as it is possible to see for example from our definitions of @xmath9 and @xmath21 .",
    "the interception of a circle with an ellipse yields in general a quartic equation which can be solved for each couple of objects with classic methods to find the roots ( see below ) .",
    "the interception points define a set of arcs which are characterized with the notation @xmath81 where the number k indicates the circle or ellipse to which this l - th arc belongs and @xmath82 is a list of circles or ellipses that contain this arc . to identify if the arc is an arc of ellipse or circle we introduce here the modification that the indexes @xmath83 , @xmath84 can be either negative or positive .",
    "all the arcs that define the boundary of integration @xmath85 are those that are either corresponding to the stellar boundary ( which we denote with the index 1 ) , and are therefore of the form 1:@xmath86 or those that are contained only in it ( k:@xmath87 ) . in the case in which we impose that the spots have a different contrast ratio @xmath88 to the stellar surface than the planets , ( which are considered totally dark ) we need to multiply the integrals on the spots arcs by the factor @xmath88 and we need also to consider in the integration the arcs of the planets contained inside the spots ( see e.g. fig.[f : example ] ) integrating on these arcs two times : the first on the same sense of the other planetary arcs that are not occulting the spots ( to close the surface of the planet ) , and the second in the opposite sense ( to close the surface of the spot region ) multiplying this second integral by the factor @xmath88 . keeping this in mind",
    "if we consider like in pl ( 2012 ) a set of arcs @xmath89 satisfying the above conditions which union is the boundary of integration @xmath90 we can express the total integral in a compact form as    @xmath91    where @xmath92 and @xmath93 are the extreme of integration along the generic arc a , as defined by the intersection points , and @xmath94 , @xmath95 are the values of the appropriate integrals at these extreme points . if the arc a is denoted by a negative index k we will adopt our set of integrals reported in eq .",
    "26,27,28 ( or eq .",
    "8,12,15 ) .",
    "if the index k is positive or is the stellar boudary we will adopt the respective integrals calculated by pl  ( 2012 ) .    to determine the values of @xmath92 , @xmath93 located on an arc of a spot we proceed as follows . considering a cartesian coordinate system @xmath96 where the @xmath65 axis is now oriented toward the north and the @xmath68 axis toward the east and",
    "the @xmath97 axis is always along the line of sight , the coordinates of the center of a spot on the surface of the star will be given by a longitude angle @xmath98 measured from the @xmath65 axis toward the positive @xmath68 axis , and by a co - latitude angle @xmath3 measured from the sub - stellar point toward the plane of the sky . if @xmath99 , @xmath100 , @xmath101 denote the cartesian coordinates of the interception point in this system , the coordintes @xmath102 , @xmath103 , @xmath104 in the reference system of the spot shown in fig .",
    "1 are obtained inverting eq.25 , and by means of these coordinates it is easy to obtain the correspondent value of @xmath105 using the definitions in section  [ s : definition ] .",
    "in such a way we can step from one arc to the other along the whole boundary to obtain the solution .",
    "in fig.[fig : lc_comparison ] , we present one application where we first consider the overlap of a single spot , with angular dimension equal to 10 degrees and contrast ratio equal to 0.5 with a planet which radius is equal to 0.1 stellar radii .",
    "we additionally considered a stellar inclination angle of 50 degrees to the line of sight and a position angle ( with respect to the y+ axis clockwise ) of 320 degrees .",
    "the planet has an orbital period of 3 days transiting perfectly along the x - axis in the same sense of stellar rotation ( p=30 days ) .",
    "this configuration produces the transit denoted by the black line in fig.[fig : lc_comparison ] ( rightmost panel ) .",
    "alternatively we replace in fig.[fig : lc_comparison ] ( middle panel ) the single spot with a double spot model composed by two spots each of 8 degrees angular dimension and contrast ratio equal to 0.5 , creating overall an homogeneous spot region .",
    "the disposition of the two spots relative to each other is selected in such a way that the projected area they offer at the time of the transit is identical to that one of the single larger spot previously considered .",
    "the resulting transit is indicated by the red line in fig.[fig : lc_comparison ] ( rightmost panel ) , where in the bottom panel we present the difference between the two lightcurves .",
    "the result indicates that spot structure may appreciably affect the exact shape of the observed photometric signal , since variation of a few millimagnitudes with respect to the single spot model can be expected",
    ". a time resolution of around 1 min would be sufficient to resolve these structures .",
    "depending on the extension of these regions spot crossing events may last also for a significant fraction of the transit event .",
    "sub - millimag photometric precisions can be acheved today both from space and from the gound over these timescale .",
    "studying accurately these events we can produce a tomographic analysis of the stellar surface .",
    "integration ( kelvin - stokes integration ) and soap - t ( oshagh et al .  2013 ) for the case of a single circular spot crossed by a transiting planet .",
    "bottom : the difference between the soap - t and the @xmath106 lightcurve .",
    ", width=302 ]    as another example , we compare in fig.[fig : comparison_soap ] the output of @xmath106 integration ( kelvin - stokes integration , black points ) with the soap - t numeric integrator result ( oshagh et al . 2013 ) , considering the case of a single circular spot and a planet crossing in front of it .",
    "the average difference over the considered transit window is 8@xmath107 with a scatter equal to @xmath108 denoting a good agreement between the two approaches .",
    "in fig.[fig : spot_image ] we present an image of a spot region obtained by the sacramento peak observatory of the national solar observatory in new mexico . on top of the image we present a possible reconstruction of this region by means of the method presented in this work . here",
    "the inner umbra region is modelled with two overlapping spots of equal contrast ratio , while the outer penumbra region is model by other two ( lower constrast ratio ) overlapping spots . to achieve the result in this case",
    "is sufficient to define some slightly different summation rules for the spots than considered before .",
    "for example spots of equal contrast ratio can be summed up homogeneously ( thereby creating a larger spot region with the same contrast ratio of the components ) whereas for spots with different contrast ratios we sum up algebrically the contrast ratio . in this way",
    "it is technically possible to create also very complex regions with sofisticated inner - side umbrae and outer side penumbrae .",
    "as explained above the interception between spot and planet profiles leads to a quartic equation for the roots . here",
    "we report the explicit expression for the quartic coefficients as a function of the cosine of the angle @xmath109 between an interception point on the stellar surface and the line of sight . defining @xmath3 ( @xmath110 ) as the angle between the center of the spot ( planet ) and the line of sight , and @xmath111 as the angle between the spot and the planet centers ( as seen from the center of the star on the plane of the sky ) , and introducing    @xmath112    @xmath113    @xmath114    where @xmath115 is the planet radius we have that the coefficients of the quartic are defined as    @xmath116    @xmath117    we recall that four is the highest degree of a polynomial for which an algebric solution for the roots can be found .",
    "the solution was first provided by lodovico ferrari ( 1540 ) .",
    "in this work we presented the solution of the stellar spot problem obtained applying the kelvin - stokes theorem .",
    "the solution has been expressed in a closed form up to the second degree of the limb - darkening law and recursive expressions are provided for any polynomial expansion of the stellar intensity .",
    "we expressed the results both in the reference system of the spot and in a generic reference system arbitrarily oriented around the line of sight of the observer .",
    "coupled with previous results on planets presented in pl ( 2012 ) we have now a powerful technique to incorporate the effects of stellar activity into light - curve modelling including mutual photometric effects produced by planets with planets or planets with spots and allowing for the creation of complex and more realistic spot regions , and independent on the number , positions and dimensions of these objects .",
    "the software implementation of the method described in this paper is made publically available directly at the following address http://eduscisoft.com/ksint/ or through the link http://www.astro.up.pt/exoearths/tools.html .",
    "it is written in fortran 95 and it has been tested on a linux machine using a gfortran compiler .",
    "the program is called ksint ad can generate the lightcurve produced by an arbitrary combination of spots and planets .",
    "mm acknowledges the support from fct in the form of grant reference sfrh / bdp/71230/2010 .",
    "this work was supported by the european research council / european community under the fp7 through starting grant agreement number 239953 .",
    "ncs was supported by fct through the investigador fct contract reference if/00169/2012 and poph / fse ( ec ) by feder funding through the program `` programa operacional de factores de competitividade '' - compete .",
    "auvergne , m. , bodin , p. , boisnard , l. , et al .",
    "2009 , a&a , 506 , 411 + boisse , i. , bonfils , x. , santos , n. c. , a&a , 545 , 109 + budding 1977 , ap&ss , 48 , 207 + collier cameron 1997 , mnras , 287 , 556 + donati , j. f. & brown , s. f. 1997 , a&a , 326 , 1135 + eker , z. 1994 , apj , 420 , 373 + kipping , d. m. , 2012 , mnras , 427 , 2487 + koch , d. g. , borucki , w. j. , basri , g. , batalha , n. m. , brown , t. m. , caldwell , d. , christensen - dalsgaard , j. , cochran , w. d. et al .",
    "2010 , apjl , 713 , l79 + lanza , a. f. , bonomo , a. s. , and rodon , m 2007 , a&a , 464 , 741 + oshagh , m. , bou g. , figueira , p. , santos , n. c. , haghighipour , n. 2013 , a&a , 558 , 65 + pl 2012 , mnras , 421 , 1825 + russell h. n. 1906 , apj , 24 , 1 + vogt , s. s. & penrod , g. d. 1983 , pasp , 95 , 565 + walker , g. , matthews , j. , kuschnig , r. , johnson , r. , rucinski , s. , pazder , j. , burley , g. , walker , a. et al .",
    "2003 , pasp , 115 , 1023 + [ lastpage ]"
  ],
  "abstract_text": [
    "<S> in this work we present the solution of the stellar spot problem using the kelvin - stokes theorem . our result is applicable for any given location and dimension of the spots on the stellar surface . </S>",
    "<S> we present explicitely the result up to the second degree in the limb darkening law . </S>",
    "<S> this technique can be used to calculate very efficiently mutual photometric effects produced by eclipsing bodies occulting stellar spots and to construct complex spot shapes .    </S>",
    "<S> [ firstpage ]    methods : analytical ; stars : activity </S>"
  ]
}