{
  "article_text": [
    "the importance of shocks as generators of highly non - thermal particle distributions in heliospheric and astrophysical environments has been well - documented in the literature ( e.g. axford 1981 ; vlk 1984 ; blandford and eichler 1987 ; jones and ellison 1991 ) .",
    "while direct detections of high energy particles are obtained via terrestrial observations of the cosmic ray flux and spacecraft measurements of non - thermal ions in the solar neighbourhood and in environs of planetary bow shocks and interplanetary travelling shocks , the existence of abundant non - thermal particle populations in a diversity of astrophysical locales can be inferred from the prominence of non - thermal radiation emitted by many cosmic objects .",
    "understanding the details of shock acceleration is of critical importance since many such objects emit predominantly non - thermal radiation , and indeed some sources are observed _ only because they produce non - thermal particles ( e.g. radio emission from supernova remnants and extra - galactic jets ) .",
    "the first - order fermi mechanism of diffusive shock acceleration is the most popular candidate for particle energization at astrophysical shocks .",
    "the test - particle ( i.e. linear ) theory ( krymsky 1977 ; axford et al .",
    "1977 ; bell 1978 ; blandford and ostriker 1978 ) of this process is straightforward and yields the most important result , namely that a power - law with a spectral index that is relatively insensitive to the ambient conditions , is the natural product of collisionless shock acceleration . _",
    "the equally important question of the efficiency of the process can only be adequately addressed with a fully non - linear ( and therefore complex ) calculation .",
    "the inherent efficiency of shock acceleration , which is evident in observations at the earth s bow shock ( e.g. ellison , mbius , and paschmann 1990 ) , and in modelling of plane - parallel ( e.g. see ellison and eichler 1985 ; ellison , jones and reynolds 1990 ) shocks , where the field is normal to the shock , and oblique shocks ( e.g. baring , ellison and jones 1993 ; ellison , baring and jones 1995 ) , implies that hydrodynamic feedback effects between the accelerated particles and the shock structure are very important and therefore essential to any complete description of the process .",
    "this has turned out to be a formidable task because of the wide range of spatial and energy scales that must be self - consistently included in a complete calculation . on the one hand , the microphysical plasma processes of the shock dissipation control injection from the thermal population and on the other hand , the highest energy particles ( extending to at least ev in the case of galactic cosmic rays ) with extremely long diffusion lengths , are dynamically significant in strong shocks and feedback on the shock structure .",
    "ranges of interacting scales of many orders of magnitude must be described self - consistently .",
    "additional complications stem from the fact that the geometry of shocks , i.e. , whether they are oblique or parallel , strongly affects the acceleration efficiency ( e.g. , ellison , baring , and jones 1995 ) , even though the test - particle result is independent of the geometry .",
    "observations indicate that interplanetary shocks , bow shocks ( both planetary and from jets ) , the solar wind termination shock , and supernova remnant blast waves have a wide range of obliquities thereby rendering considerations of shock geometry salient .",
    "it turns out that the angle between the upstream magnetic field and the shock normal , , is a decisive parameter in determining all aspects of the shock , including the ability to inject and accelerate particles , and therefore has obvious observational consequences .",
    "for instance , diffuse ions generated at quasi - parallel portions of the earth s bow shock differ radically in energy content , distribution function , etc . , from field aligned beams generated at quasi - perpendicular portions of the shock ( e.g. ipavich et al .",
    "furthermore , the observed variation of radio intensity around the rim of shell - like supernova remnants may be the result of varying shock obliquity ( e.g. fulbright and reynolds 1990 ) , and the acceleration of the anomalous cosmic ray component at the solar wind termination shock may depend on rapid acceleration rates obtained in highly oblique portions of the shock ( jokipii 1992 ) .",
    "unfortunately , in models which ignore the plasma microstructure as we do here , oblique shocks are more complicated and require additional parameters for a complete description than do parallel ( i.e. @xmath1 ) ones , primarily the degree of diffusion perpendicular to the mean ambient magnetic field direction .    in this paper",
    "we present our method for calculating the structure of steady - state , collisionless shocks of arbitrary obliquity and with efficient particle injection and acceleration .",
    "the method , a computer simulation using monte carlo techniques , is an extension of our previous work on modified parallel shocks ( e.g. see jones and ellison 1991 and references therein ) , where we explored the properties of the non - linear modified shock scenario , and test - particle oblique shocks ( ellison , baring , and jones 1995 ; baring , ellison , and jones 1993 , 1995 ) , where we determined the dependence of acceleration efficiency on obliquity .",
    "these studies have been successfully applied to ampte observations near the parallel portion of the earth s bow shock ( ellison , mbius , and paschmann 1990 ) , a high mach number shock with strong modification by the accelerated ions , and measurements by ulysses at highly oblique travelling interplanetary shocks in the heliosphere ( baring et al .",
    "1995 ) , which generally have low mach numbers and therefore are well - modelled by linear test - particle simulations .",
    "the impressive fits obtained to the spectral data ( i.e. ion distribution functions ) from each of these experiments underlines the importance of the fermi mechanism and the value of the monte carlo technique .",
    "the present work represents the first self - consistent treatment of modified shocks that includes three - dimensional diffusion .    with the monte carlo simulation , we self - consistently determine the average flow speed and magnetic field structure across the shock under the influence of accelerated particles maintaining constant particle , momentum , and energy fluxes at all positions from far upstream to far downstream of the shock .",
    "particles are injected upstream of the shock , propagated and diffused in the shock environs until they eventually leave the system .",
    "we calculate their orbits exactly as in the works of decker ( 1988 ) , begelman and kirk ( 1990 ) , ostrowski ( 1991 ) and our recent test - particle treatment ( ellison , baring and jones 1995 ) , and make no assumption relating to the particle magnetic moment .",
    "our method does not self - consistently calculate the complex plasma processes responsible for dissipation , but instead postulates that these processes can be adequately described with a simple elastic scattering relation that is assumed to be valid for _ all particle energies ; thermal and non - thermal particles are treated identically .",
    "this simplification sacrifices the details of wave - particle interactions , but permits simultaneous description of the thermal plasma and the particle injection and acceleration to the high energies associated with space plasma shocks , thereby satisfying the aforementioned goal of broad dynamic range .",
    "cross - field diffusion is included via a parametric description but is fully three - dimensional in contrast to hybrid or full plasma simulations with one or two ignorable dimensions which suffer from artificial suppression of cross - field diffusion ( e.g. jokipii , giacalone , and kta 1993 ) .",
    "simulation output includes the ion distribution function at all relevant positions in the shocked flow , for a range of obliquities and mach numbers .",
    "_    results are compared ( in section  4 ) for two extreme scattering modes , namely large - angle scattering ( las ) , where the direction of a particle is isotropized in a single scattering event , and pitch - angle diffusion ( pad ) , where small changes in the angle a particle s momentum makes with the local magnetic field occur at each time step .",
    "the former of these extremes mimics particle motion in highly turbulent fields , while the latter is usually implemented in analytic treatments of fermi acceleration ( e.g. kirk and schneider 1987 , but see also the monte carlo work of ostrowski 1991 ) .",
    "we find that in our application to non - relativistic shocks , the choice of scattering mode is largely immaterial to the resultant distributions ; we expect this not to be so for relativistic shocks where the modes generate vastly different particle anisotropies .",
    "we also compare non - linear ( section  4.2 ) results with test - particle ones where the non - thermal particles do not modify a discontinuous shock ( section  4.1 ) , finding that , as in our earlier work on plane - parallel shocks , some spectral curvature arises in high mach number shocks where a large fraction of the partial pressure resides in the non - thermal population .",
    "an outline of the monte carlo method is given in section  2 , followed in section  3 by flux conservation considerations and the associated scheme for iterative determination of the modified shock flow and field profiles .",
    "the spectral and flux results comprise section  4 , culminating in a presentation of acceleration efficiencies and discussion of the results .",
    "the monte carlo technique for describing particle acceleration at plane shocks has been described in previous papers ( e.g. ellison , jones and reynolds 1990 ; jones and ellison 1991 ; baring , ellison and jones 1993 ; ellison , baring and jones 1995 ) , and is essentially a kinematic model that closely follows bell s ( 1978 ) approach to diffusive acceleration .",
    "the simulation follows individual particles as they traverse a background `` plasma '' consisting of an average bulk flow and magnetic field ; the flow velocity and magnetic field consist of a grid of values from far upstream to far downstream with a subshock positioned at .",
    "our subshock is a sharp discontinuous substructure of the overall shock , defining the conventional boundary between ( infinite ) upstream and downstream regions .",
    "strictly it should be no sharper than the smallest diffusion scale ( i.e. the gyroradius of thermal particles ) , however we require it to be abrupt for the purposes of expedience in the simulation .",
    "particles are injected far upstream of the shock with a thermal distribution at temperature , mimicking for example solar wind ions ( as in applications to the earth s bow shock ) , and are allowed to convect in the flow and scatter , crossing the shock a few or many times before they eventually leave the system either far downstream or beyond an upstream free escape boundary ( feb ) .",
    "they are moved one at a time according to a prescribed scattering law , defined below , in a test - particle fashion until they exit the simulation . in cases where efficient acceleration arises",
    ", feedback of the accelerated population leads to significant smoothing of the shock profile and heating of particles occurs in the foreshock region ; discussion of such non - linear aspects of the simulation are deferred to section  3 below .",
    "following our previous treatments of oblique shocks ( baring , ellison and jones 1993 ; ellison , baring and jones 1995 ) particle convection is performed in the de hoffmann - teller ( ht ) frame ( de hoffmann and teller 1950 ) , a frame where the shock is stationary , the fluid flow is everywhere parallel to the local field , and the electric field is everywhere .",
    "the ht frame of reference is therefore particularly convenient because of the associated absence of drift electric fields : particle trajectories are then simple gyrohelices and the description of convection is elementary .",
    "furthermore , it follows from the mere existence of an ht frame that the so - called shock drift mechanism is inseparable from , and intrinsically part of , the fermi acceleration process ( e.g. drury 1983 ; jones and ellison , 1991 ) and is therefore automatically included in our monte carlo technique since particle motion is followed in the ht frame .    while field and flow directions in the ht frame are uniquely defined downstream of the shock , the non - linear nature of this work yields a spatial variation of and , due to the compressive effects of the accelerated population .",
    "this variation is accommodated using a grid - zone structure that was implemented in many earlier versions of the monte carlo technique ; each zone contains uniform field and flow , with discontinuities at the boundaries satisfying the rankine - hugoniot conditions discussed in section  3 below .",
    "the grid - zone boundaries therefore mimic mini - shocks , with the subshock defining a particular grid boundary ; a depiction of this grid structure is given in baring , ellison and jones ( 1992 ) .",
    "the spatial resolution of the grid can be adapted at will , but in our applications , we require it to be finer at some distance upstream than the typical mean free path of particles that penetrate to that distance from the shock . note that the ability to define ( for example via the rankine - hugoniot conditions ) an ht frame with on both sides of a grid point implies , by spatial extension , that the ht frame is uniquely defined throughout the flow , regardless of flow and field compression and deflection upstream .",
    "in addition , note that even though the electric field is transformed away by going to the ht frame , charge separation electric fields are not and these have not been included in our model , being beyond the scope of the present work .",
    "while particle transport is monitored in the ht frame , all measured quantities such as particle distributions and momentum and energy fluxes are output in the normal incidence frame ( nif ) , which is the frame where the shock is also stationary , but is defined such that the flow far upstream ( i.e. where it is uniform to infinity ) is normal to the shock plane . a simple velocity boost with a speed of parallel to the shock front effects transformation between the nif and ht frames , where is the far upstream angle the magnetic field makes with the shock normal and is the far upstream flow speed in the frame where the shock is at rest .",
    "note that hereafter , the index ` 1 ' will indicate far upstream values and the index ` 2 ' will indicate far downstream values well away from the smooth shock transition .",
    "a depiction of the nif geometry is given in figure  [ fig : shock ] for the specific case of unmodified shocks ; modified shock geometry extends this to include piecewise increments of and . in the normal incidence frame",
    ", the @xmath2-axis defines the shock normal , and the senses of the other axes are as in figure  [ fig : shock ] .",
    "the results of this paper are restricted to highly subluminal cases where , the speed of light , since our monte carlo technique has not yet been generalized to include relativistic effects in oblique shocks .",
    "the simulation is an orbit code , where particle propagation is performed by following the gyromotions exactly , as in the test - particle work of ellison , baring and jones ( 1995 ) and a diversity of works in the literature ( e.g. decker 1988 ; begelman and kirk 1990 ; ostrowski 1991 ; takahara and terasawa 1991 ) .",
    "the position of particles is incrementally updated on a timescale , which is a small fraction of a gyroperiod , i.e. , , where and are the particle s mass and charge number respectively , and is the electronic charge .",
    "a particle in a particular grid - zone is moved in a helical orbit determined by the magnetic field and bulk flow velocity for that grid position .",
    "having outlined the procedure for convection , here we describe our prescription for particle scattering , which is somewhat more involved .",
    "after each time step a determination of whether the particle should `` scatter '' or not is made using a scattering probability where the collision time , , is given by , is the mean free path , and is the particle speed , both measured in the local fluid frame . this prescription yields an exponential pathlength distribution .",
    "the scatterings , presumably off magnetic irregularities in the flow , are assumed to be elastic in the local plasma frame so that monotonic energy gains naturally arise as a particle diffuses back and forth across the shock due to the converging nature of the flow .",
    "it proves convenient to scale the mean free path by the gyroradius , introducing a model parameter that is the ratio of the two quantities ( following jokipii 1987 ; ellison , baring and jones 1995 ) : @xmath3 where is the diffusion coefficient parallel to the ambient local field .",
    "it follows that the collision time satisfies @xmath4 generally , is a function of energy , however in this paper it is assumed to be a constant independent of position and energy ( also following jokipii 1987 ) . for this choice ,",
    "the collision time is independent of particle energy , a convenient simplification that can be easily generalized to some other dependence of on ( see ellison , mbius , and paschmann 1990 ) .",
    "note also that is hence implicitly inversely proportional to .",
    "the assumed constancy of is the most important approximation we make , since all of the complicated plasma physics of wave - particle interactions is incorporated in equation  ( [ eq : mfp ] ) .",
    "convenience aside , there are sound reasons for choosing this simple relation .",
    "first of all , as long as electrostatic effects are neglected ( they are omitted from our treatment ) , the gyroradius is the fundamental scale length of a particle at a particular energy and the mean free path can be expected to be some function of this parameter .",
    "second , if the plasma is strongly turbulent with , as is generally observed in space plasmas , the large - scale structures in the magnetic field will mirror particles effectively on gyroradii scales ( i.e. for , the bohm diffusion limit ; zachary 1987 ) .",
    "third , and most important , spacecraft observations suggest that in the self - generated turbulence near the earth s bow shock ( e.g. ellison , mbius , and paschmann 1990 ) .",
    "fourth , hybrid plasma simulation results also suggest that the mean free path is a moderately increasing function of ( giacalone , burgess , and schwartz 1992 ; ellison et al .",
    "note that while the exact form for will surely have quantitative effects on the injection rate and all other shock characteristics , the most important qualitative effects should be well modeled as long as a strongly energy dependent diffusion coefficient is used . employing a",
    "realistic with a strong energy dependence is essential because of the intrinsic efficiency of shock acceleration .",
    "if is indeed energy dependent , the highest energy particles with large fractions of energy and pressure have very different scales from thermal particles , leading to the spectral curvature that appears in the simulated distributions ( see section  4 ) .",
    "the simulation employs two complementary types of scattering modes , namely large - angle scattering and pitch - angle diffusion . for each mode ,",
    "elasticity of scattering is imposed , which amounts to neglecting any recoil effects of wave production on the particles and hence that the background scattering centers ( i.e. magnetic irregularities ) are frozen in the plasma .",
    "this approximation is generally quite appropriate but becomes less accurate for low afvnic mach numbers when the flow speed does not far exceed the alfvn wave speed . in large - angle scattering ( las ) , a particle s direction is randomized in a single scattering event ( on a timescale of ) and the new direction is made isotropic in the local plasma frame .",
    "such quasi - isotropic scattering is adopted in most of our earlier simulation work ( e.g. see jones and ellison 1991 ; baring , ellison and jones 1993 ; ellison baring and jones 1995 ) , and is intended to mimic the effect of large amplitude field turbulence on particle motions .",
    "such turbulence is present in both plasma simulations ( e.g. quest 1988 ; burgess 1989 ; winske et al . 1990 ) and observations of shocks in the heliosphere ( e.g. , hoppe et al . 1981 ) .",
    "the second scattering mode we employ is pitch - angle diffusion ( pad ) , as used in the diverse works of decker and vlahos ( 1985 ) , decker ( 1988 ) , kirk and schneider ( 1987 ) and ostrowski ( 1988 , 1991 ) . in this mode , the direction of the velocity vector is changed by a small amount after each time step , , rendering the scattering process more `` continuous '' than large angle collisions , and more appropriate to physical systems with small levels of field turbulence . here we adopt the procedure detailed in ellison , jones , and reynolds ( 1990 ) for determining the maximum amount the pitch angle can change after each ; our procedure is summarized in the appendix .",
    "a comparison of the simulation results for these two modes is one goal of this paper , motivated by an expectation that they could , in principal , produce different injection efficiencies at modified shocks .",
    "this expectation is partly based on the spectral differences observed between las and pad applications to unmodified relativistic shocks ( e.g. ellison , jones , and reynolds 1990 ) , where the two modes generate significantly different particle anisotropies ; distribution anisotropies are indeed relevant to the injection problem considered here .    as a particle convects ,",
    "the simulation tracks both its position and the position of its gyrocenter .",
    "after a scattering occurs and a new direction is obtained for its velocity vector , a new gyrocenter is calculated .",
    "this shift of the gyrocenter means the particle is now gyrating around a different field line and diffusion across the field has occurred ; the new field line is within of the one the particle was circling before the scattering .",
    "such cross field diffusion is an integral part of diffusive acceleration at oblique shocks ( e.g. jokipii 1987 , ellison , baring , and jones 1995 ) , and its presence is required in the monte carlo simulation in order to match spacecraft observations of particle spectra associated with interplanetary shocks ( baring et al .",
    "ellison , baring and jones ( 1995 ) showed that this scheme for cross - field diffusion together with the assumption contained in equation  ( [ eq : mfp ] ) is equivalent to a kinetic theory description of diffusion ( e.g. axford 1965 ; forman , jokipii and owens 1974 ) , where the diffusion coefficients perpendicular to ( ) and parallel to ( ) the field are related via .",
    "the parameter in equation  ( [ eq : mfp ] ) then clearly determines the strength of the scattering and when , , the so - called bohm limit where particles diffuse across the magnetic field as quickly as they move along it .",
    "the properties of highly oblique and quasi - parallel shocks tend to merge when the scattering is strong .      when a particle crosses a grid zone boundary , the values of the bulk flow velocity and the magnetic field ( both magnitude and direction for these vector quantities ) change and a new gyroradius , gyrocenter , and phase in the gyro - orbit are determined , as outlined in the appendix .",
    "the particle then acquires a new gyromotion with subsequent convection along the new field direction . at a crossing of a grid zone boundary ,",
    "we adopt the standard requirement ( e.g. see terasawa 1979 ; decker 1988 ; begelman and kirk 1990 ) in orbit calculations that the momentum vector of the particle is conserved in the de hoffmann - teller frame , since there is no electric field in the shock layer in this frame .",
    "while this implies conservation of energy in the ht frame ( i.e. between scatterings ) , particle energies do change at the discontinuity in the nif ( e.g. toptyghin 1980 ) due to the presence of drift electric fields , a manifestation of the transformation between frames .",
    "this transmission criterion differs from the imposition of magnetic moment conservation that was made in earlier applications of our monte carlo technique ( e.g. baring , ellison and jones 1993 ) ; in the present paper we make no assumption concerning the magnetic moment of a particle at a grid point or anywhere else .",
    "particles may of course ` reflect ' at any zone boundary or be transmitted depending on their phase and pitch angle after a number of gyrations in the vicinity of the boundary",
    ".    there are two limiting boundaries to the simulation region , the free escape boundary ( feb ) and the downstream return boundary .",
    "our introduction of an upstream feb facilitates modelling of the finite extent , for example through geometrical curvature , of real shocks .",
    "escape is naturally expected in real systems since the region of influence of a shock on its environs is finite , and the level of shock - generated turbulence diminishes to background levels at sufficient distances from the shock .",
    "an escape boundary is most relevant to the upstream region ( i ) because the direction of convection renders the downstream region more spatially uniform , and ( ii ) because the upstream region is usually on the convex side of the shock ( e.g. supernova remnant shocks , the earth s bow shock ) , although particles can escape from the downstream side as well .",
    "the inclusion of such a free escape boundary is also motivated on theoretical grounds .",
    "the fundamental point is that for fermi acceleration in steady - state shocks , escape must occur for mach numbers above some critical value",
    ". this has been fully documented ( e.g. eichler 1984 , 1985 ; ellison and eichler 1984 ; jones and ellison 1991 ) , where it is observed that within the context of the non - linear acceleration model , the fermi acceleration / hydrodynamics coupling becomes unstable for shocks of mach numbers above a few , and leads to singularities in the energy density when particle escape is suppressed .",
    "finite solutions are achievable when an upstream feb is introduced , since its presence causes the acceleration process to truncate at the highest energies . in the case",
    "where the diffusion coefficient increases with energy , the feb produces a distribution which falls off approximately exponentially at an energy where the upstream diffusion length is on the order of the distance from the feb to the shock . in the simulation ,",
    "particles are removed just before they scatter for the first time on the upstream side of the feb ; this choice leads to a spatial smearing of the effects of the feb on the scale length of the mean free path of the escaping particles , i.e. on length scales comparable to the distance between the feb and the shock . in the results presented here ,",
    "the feb is chosen close enough to the shock to guarantee that all particles in the simulation remain non - relativistic ; the domain of acceleration to relativistic energies and also relativistic shock scenarios are deferred to future work .",
    "the dynamical consequences of the feb are discussed in detail in section  4 below .    while the upstream region in the simulation is finite , delimited with a feb , we model an infinite downstream region with a probability of return calculation beyond a downstream return boundary ( drb ) ; this spatial border renders the simulation finite in time . beyond the drb , which is maintained more than a scattering length downstream of the shock",
    ", the spatial diffusion properties are treated using appropriate statistical probabilities .",
    "if the position of a particle ( as opposed to its guiding center ) is followed , then the probability of return to the upstream side of the drb assumes a simple form .",
    "if the flow is uniform with a component of velocity perpendicular to the drb ( in our case , this direction is also perpendicular to the shock plane ) and particles of speed in the frame of the flowing plasma are also isotropic in that fluid frame , then the probability , , that a particle which crosses some arbitrary - plane will return to the upstream side of that plane , is @xmath5 while this calculation has been done many times ( e.g. bell 1978 ; drury 1983 ; jones and ellison 1991 ; and ellison , baring , and jones 1995 ) we emphasize that equation  ( [ eq : probret ] ) is fully relativistic ( peacock 1981 ) and holds regardless of the orientation of the magnetic field or the flow .",
    "the principal requirement for the validity of equation  ( [ eq : probret ] ) is that the particles are isotropic in the local fluid frame , a condition that is satisfied since the drb is at least a scattering length downstream of the shock .",
    "hence while equation  ( [ eq : probret ] ) can be used downstream where the flow is uniform for any , it can not be used at the shock where the flow speed changes unless . the particle speed , , must also remain constant during the time a particle spends downstream from the - plane , a natural consequence of our elastic scattering assumption .",
    "the decision of return ( or otherwise ) is made via a random number generator .",
    "particles which do return , must be injected back across the - plane with properly flux - weighted @xmath6-components of velocity , pitch angles , and phases .",
    "the determination of these , along with a detailed derivation of equation  ( [ eq : probret ] ) , are given in the appendix .",
    "note that the drb is not only a feature of our monte carlo simulation , but is also used in hybrid plasma simulations of shocks ( bennett and ellison 1995 ) .",
    "before presenting the results of our modified shock simulations , it is instructive to review the elements of non - linear shock hydrodynamics and our procedure for determining the fluid flow and magnetic field spatial profiles that simultaneously conserve all relevant fluxes and are also self - consistent products of the fermi acceleration mechanism .      the starting point for these considerations is the well - known one - dimensional , steady - state , magnetohydrodynamic conservation relations ( i.e. , the rankine - hugoniot ( r - h ) jump conditions ) for an infinite , plane shock lying in the - plane ( see the geometry in figure  [ fig : shock ] ) .",
    "variations of all quantities occur only in the -direction and these equations are written in the normal - incidence - frame [ nif ] .",
    "the notation is that of decker ( 1988 ) , with the square brackets representing differences between quantities far upstream ( with the ` 1 ' subscript ) and downstream ( with the ` 2 ' subscript ) of the shock , however the origin of the forms used here is based on the presentation on p.  56 of boyd and sanderson ( 1969 ) . for a magnetic field strength of , if is the bulk speed of the plasma , the purely electromagnetic equations ( i.e. maxwell s equations ) are @xmath7 ^ 2_1 \\ ; = \\ ; 0 \\quad ,     \\label{eq : divb}\\ ] ] which defines a divergenceless magnetic field ( remember that our system has ) , and @xmath8 ^ 2_1 \\ ; = \\ ; 0 \\quad ,       \\label{eq : curle}\\ ] ] which expresses ( since ) the uniformity of the tangential electric field across the shock .",
    "the hydrodynamic equations are as follows : the mass flux equation corresponding to the -direction is @xmath9 ^ 2_1 \\ ; = \\ ; 0 \\quad , \\label{eq : massflux}\\ ] ] where is the mass density ; the equations for the flux in the -direction of the and components of momentum are @xmath10 ^ 2_1 \\ ; = \\ ; 0 \\quad ,                        \\label{eq : xmoflux}\\ ] ] and @xmath11 ^ 2_1 \\ ; = \\ ; 0\\quad ,    \\label{eq : zmoflux}\\ ] ] respectively , where and are the appropriate components of the pressure tensor .",
    "finally , the energy flux in the -direction satisfies @xmath12 ^ 2_1 \\ ; = \\ ; 0 \\quad .",
    "\\label{eq : enflux}\\end{aligned}\\ ] ] here is the ratio of specific heats , which enters via the thermal contribution to the energy density using the equation of state ; we set this equal to 5/3 in this paper , since only non - relativistic particles appear in the simulation results presented",
    ". equations  ( [ eq : xmoflux])([eq : enflux ] ) neglect so - called gradient terms that are spatial diffusion contributions that arise from non - uniformity of the fluid flow and magnetic field profiles . note also that equations  ( [ eq : xmoflux ] ) , ( [ eq : zmoflux ] ) , and  ( [ eq : enflux ] ) approximate the respective parallel shock relations for high alfvnic mach numbers ( i.e. where the field is dynamically unimportant ) , whereas equation  ( [ eq : curle ] ) remains important regardless of the mach number .    in equation  ( [ eq : enflux ] )",
    "we have added the term , , to model the escape of particles at an upstream free escape boundary ( feb ) . as mentioned above",
    ", a feb causes the acceleration process to truncate as particles leave the system producing important dynamical effects since the escaping energy , and therefore pressure , results in an increase in the compression ratio of the shock ( see ellison , mbius , and paschmann 1990 for a discussion of the effects of such a term in the r - h relations ) . the escaping energy flux , , is taken to be constant for the far downstream region and zero for the region far upstream ( i.e. several mean free paths ) of the feb , and varies most rapidly in the neighbourhood of the feb . we assume that the concurrent escaping momentum and mass fluxes are small and neglect them in equations  ( [ eq : massflux ] ) ,  ( [ eq : xmoflux ] ) , and  ( [ eq : zmoflux ] ) .",
    "this is a good approximation if the particles that escape have speeds such that ( see ellison 1985 ) , a situation that is always realized in the simulation results presented here .",
    "the appearance of different components of the pressure tensor in the rankine - hugoniot relations is requisite for the monte carlo simulation since we do not assume that particles are isotropic in any frame .",
    "normally , implementations of the conservation equations in astrophysical or heliospheric applications ( e.g. decker 1988 ) are restricted to scenarios where the plasma is isotropic in the local fluid frame , in which case and the off - diagonal terms of the pressure tensor are zero . however , our system generates anisotropic plasma in all frames of reference , due to the non - uniformity of the flow _ combined with the self - consistently determined fermi acceleration of the particles . in this paper , for the sake of simplicity , we assume that the plasma is gyrotropic but anisotropic in the local fluid frame in the flux equations . _",
    "when an isotropic population of particles is convected across a velocity discontinuity and then subjected to isotropic scattering , compression of the plasma is close to , but not perfectly , gyrotropic : asymmetric phase sampling at the discontinuity yields non - uniform phase distributions prior to scattering .",
    "plasma isotropy in the new local fluid frame is attained only after many scattering lengths ; in fact adjustment to true isotropy is never achieved in our non - linear monte carlo treatment because the scale length of velocity ( and directional ) changes in the fluid flow is always comparable to the mean - free - path of the particles comprising the flow .",
    "gyrotropy is a good approximation that is also expedient because it yields a diagonal pressure tensor in the de hoffman - teller and fluid frames for co - ordinate systems with one axis aligned along the magnetic field ; since the diagonal components generally differ , oblique shocks lead to non - zero off - diagonal components : . a discussion of the generation of such terms is presented in the appendix , specifically focusing on the details of the derivation of the pressure terms of the energy flux in equation  ( [ eq : enflux ] ) ; there the coefficient of is alternatively expressed in terms of pressure components parallel to and orthogonal to the local field .",
    "note that non - zero also arise in hydrogenic plasma flows in conjunction with out - of - the - plane components of the electric field ( jones and ellison 1987 , 1991 ) ; such off - diagonal terms apply only to quantities in the @xmath13-direction , and therefore are irrelevant to the considerations of this paper .",
    "the flux equations are used in the simulation in dimensionless form , scaling by relevant upstream quantities . in the nif ,",
    "the far upstream flow is taken along the shock normal , i.e. .",
    "we define the flow velocity , the magnitude of the far upstream magnetic field , and a far upstream plasma density .",
    "these specify a far upstream alfvnic mach number : or , where the alfvn speed is , and a far upstream sonic mach number , , where is the far upstream ( isotropic ) pressure . here and are the number density and temperature far upstream , and is boltzmann s constant . these upstream parameters , along with , define the key input for the simulation runs .",
    "using these definitions , one can write equations  ( [ eq : curle ] ) and  ( [ eq : xmoflux])([eq : enflux ] ) in a dimensionless form at any position :    @xmath14    defines the uniformity of tangential electric field , @xmath15 and @xmath16 define the momentum flux equations , and @xmath17      \\right \\}\\nonumber\\\\ & & \\qquad\\qquad + \\dover{1}{2}u_{\\rm x}^ { ' 2}(x ) + \\dover{1}{2 } u_{\\rm z}^ { ' 2}(x ) + { { b_{\\rm z}^{'}(x ) } \\over { \\ma^2 } }    \\left [ u_{\\rm x}'(x ) b_{\\rm z}^{'}(x ) - u_{\\rm z}'(x ) b_{\\rm x1}^ { ' } \\right ]     + q_{\\rm esc}^ { ' } \\ ; = \\ ; \\fenups \\ , \\vphantom{\\biggl ( } \\label{eq : endim}\\end{aligned}\\ ] ] rearranges the energy flux equation .",
    "all primed quantities are dimensionless , using the notation , , and .",
    "note that is a constant throughout the flow for the non - relativistic applications here .",
    "the constancy of the @xmath6-component of magnetic field has been used to substitute , and we have also used mass flux conservation @xmath18 in these equations . as mentioned above ,",
    "the escaping momentum and mass fluxes are of progressively smaller orders in than , and therefore are neglected .",
    "the far upstream fluxes on the right hand sides of equations  ( [ eq : curledim])([eq : endim ] ) are constants determined by the input shock parameters : @xmath19 note that in all of the examples described below , we have set the electron temperature equal to zero .",
    "a finite electron temperature can be modeled with our procedure and is necessary when fitting spacecraft data ( as done in ellison , mbius , and paschmann 1990 ) , but is not necessary for the discussion given here .",
    "we assume , as is generally done , that the ions dominate the shock structure and the addition of electrons has little effect other than changing the mach number .",
    "if and are both assumed to be zero at all , the four unknowns in equations  ( [ eq : curledim])([eq : endim ] ) ; , , , and , can be obtained at every position .",
    "this is just the standard situation of a discontinuous shock , and these rankine - hugoniot relations are analytically solvable ( e.g. see decker 1988 ) for the shock compression ratio , .",
    "however , in the modified collisionless shocks considered here , the non - thermal component of the particle distribution that is generated by particles crossing the shock more than once contributes significantly to the total pressure of the system , and will not , in general , be zero .",
    "in fact , will have different values at various locations , and can not be determined before the shock structure is known , making a direct solution of equations  ( [ eq : curledim])([eq : endim ] ) impossible ; this is the inherent non - linearity in the problem even if isotropy is assumed , defined by the coupling between the acceleration process and the flow hydrodynamics .",
    "in our approach , we iterate to achieve a solution for the velocity and field shock profiles by varying , , the overall compression ratio , for successive simulation runs ( each accelerating particles and generating non - thermal distributions ) until equations  ( [ eq : curledim])([eq : zmodim ] ) are satisfied at every .",
    "the overall compression ratio depends on far downstream from the shock and is determined by our solution .",
    "when this value is consistent with equation  ( [ eq : endim ] ) , a complete solution to the non - linear acceleration problem is obtained , satisfying equations  ( [ eq : divb])([eq : enflux ] ) at all positions .",
    "the details of the iterative procedure follow .",
    "the iteration of the shock profile is done in two stages .",
    "we first choose the overall compression ratio ( normally the r - h value for the first iteration ) and , using this ratio , we iterate the _ shape of the profile . as individual particles move through the shock , the momentum and energy fluxes are calculated at each grid zone boundary .",
    "we therefore obtain the quantity @xmath20 at each boundary , where and are the current values for the shock structure . from this",
    "we compute the pressure and calculate a new -component of the flow speed from equation  ( [ eq : xmodim ] ) , @xmath21 such that the momentum flux will equal the constant far upstream value , , at all . replacing with , we solve equations  ( [ eq : curledim ] ) and  ( [ eq : zmodim ] ) for new values of and . to speed convergence , before running the next iteration we smooth this new profile , force it to be monotonic , average it with the previous profile , and scale the profile by setting all downstream values of the -component of flow to and the far upstream value to .",
    "since no wave physics is employed in our description , we do not attempt to model anything other than a monotonic decrease in flow speed and a monotonic increase in the magnitude and obliquity of from upstream to downstream .",
    "alternatively , we can calculate both and in the simulation and obtain the new prediction for from equation  ( [ eq : endim ] ) , but in either case , our procedure rapidly and stably converges . _    with this new shock profile we repeat the simulation by again injecting particles far upstream from the shock and propagating them until they leave at either the feb or the probability of return plane .",
    "our algorithm converges rapidly ( within a few steps : see the examples in section  4 below ) to values of , , and , which no longer change significantly with subsequent iterations .",
    "however , in general , this profile will not simultaneously conserve momentum and energy fluxes unless a compression ratio consistent with the escaping energy flux has been chosen .",
    "the second stage of the iteration process is to successively choose new overall compression ratios ( larger than the r - h value ) , each time repeating the iteration of the profile shape , and continue until the momentum fluxes and the energy flux ( with added ) are constant everywhere .",
    "thus , within statistical limits , a shock profile and overall compression ratio that are consistent with the fermi acceleration process are obtained .",
    "oblique shocks are highly complex , even in the steady state and in plane geometry , and several parameters control the dissipative processes as well as the injection from thermal energies into the fermi acceleration mechanism .",
    "these far upstream parameters include the magnetic field strength , , the obliquity , , the temperature , , the number density , , and the shock speed , , all of which are determined by the ambient upstream conditions and can , in principle , be determined by observations of a given physical system .",
    "the size of the acceleration region is also an observable ( for example the radius of a supernova remnant shock ) , and we model it using the distance between the upstream free escape boundary and the shock .",
    "however , the ` size ' of the shock in units of mean free paths is very important and this will depend on the scattering law we assume .",
    "this requires the introduction of another parameter , , the ratio of the mean free path to the gyroradius , via equation  ( [ eq : mfp ] ) .",
    "the value of , which determines the amount of cross - field diffusion , depends on the highly complex plasma interactions that occur in the shock environs ; the prescription in equation  ( [ eq : mfp ] ) is a simple but insightful way to model these plasma processes .",
    "another `` variable '' results from the inclusion of two extreme modes of scattering , namely large - angle scattering ( las ) and pitch - angle diffusion ( pad ) . while more complicated scattering models can be used",
    ", we believe these contain the essential physics of plane shocks and yield important information on the nonlinear processes linking shock structure and particle acceleration .",
    "the type of scattering we employ and are free parameters and can not be determined in our model except by comparison with observations of space plasma shocks or 3-d plasma simulations .",
    "hence ( replacing and with and ) , there are seven parameters in our model : , , , , , , and , together with the choice of the type of scattering ( either las or pad ) . in all of the following examples we use a shock speed of km  sec@xmath22 and a far upstream number density of @xmath23 , which define physical scales for our system that are more or less appropriate for astrophysical shocks .",
    "the spatial scales of the results presented here are all in units of the `` low - energy mean free path '' , which is defined as the mean free path [ see equation  ( [ eq : mfp ] ) ] of a proton with speed in the upstream magnetic field , i.e. , , where ( ) remains an adjustable parameter for each simulation run .",
    "the simplest acceleration results obtainable from the monte carlo simulation are for test - particle cases where the shock profile is uniform on either side of the subshock ; this limit corresponds to the first run in the iteration sequence described in sections  3.2 and  3.3 , and has been studied in detail in ellison , baring and jones ( 1995 ) .",
    "several interacting elements of the code , including shock ( or grid zone ) crossings and the probability of return calculation ( which includes the flux - weighting of momenta of the returning particles : see section  a.3 in the appendix ) must be implemented properly in order to yield the well - known test - particle acceleration power - law .",
    "the fermi power - law is achieved when particle speeds far exceed the ht flow speed . from analytic calculations ( e.g. drury 1983 ; jones and ellison 1991 )",
    ", the spectral index of the power - law then depends only on the compression ratio regardless of the obliquity or other plasma parameters .",
    "the compression ratio is determined from equations  ( [ eq : divb])([eq : enflux ] ) with ( see also decker 1988 ) . for",
    "non - relativistic particle energies and shock speeds the test - particle distribution is : @xmath24 where is the number of particles in units of ( @xmath25-sec - steradian - kev)@xmath22 , i.e. is an omni - directional flux ( see jones and ellison 1991 ) .",
    "the reproducibility of this form is a powerful tool for debugging the portions of the code that are directly related to the transport and acceleration of particles .",
    "it is instructive to review test - particle distributions before proceeding to our results for the non - linear problem .    in figure",
    "[ fig : testspectra ] we show spectra calculated with a discontinuous shock for three different sets of parameters and for both large - angle scattering ( solid lines ) and pitch - angle diffusion ( dotted lines ) .",
    "note that the examples labelled ( c ) are multiplied by 0.01 for clarity of display .",
    "all spectra here and elsewhere are omni - directional , calculated several ( i.e. `` thermal '' mean free paths ) downstream from the shock in the normal incidence frame , and are normalized to one particle per square cm per second injected far upstream . in all cases",
    "we have used km  sec@xmath22 , and @xmath23 ; the ( sonic and alfvnic ) mach number 20 cases here use g and k , while the mach number 3 case uses g and k. the other parameters are given in the figure .",
    "no free escape boundary is included in these test - particle cases , being necessary only for the non - linear acceleration problem .",
    "note that the compression ratio varies slightly between the two high mach number examples , being for the case and for the case ; this occurs because of a slight dependence of on obliquity for non - infinite mach numbers . for the low mach number example ( c )",
    ", the shock is quite weak with .",
    "the fermi power - laws obtained from equation  ( [ eq : testpower ] ) for these compression ratios are shown as light solid lines in the figure ( with adjusted normalization to aid visual distinction ) .",
    "clearly the most important feature of figure  [ fig : testspectra ] is that the simulation does reproduce the fermi power - law index at high energies for a wide range of shock parameters .",
    "comparison of examples ( a ) and ( b ) with similar compression ratios but quite different , supports the fact that the fermi spectral index is determined solely by .",
    "the next most striking feature of these plots is that the two modes of scattering produce very little difference in the spectra .",
    "this difference is largest for portions of the spectrum ( b ) between thermal energies and about kev .",
    "there the distribution for the las mode [ the solid line in ( b ) ] is somewhat noisy due to comparatively poor statistics in high , high obliquity runs ( i.e. weak injection : see ellison , baring and jones 1995 ) , and this noise may obscure some underlying structure that can arise from large energy boosts in individual shock crossings . at these energies , the particle speed does not far exceed the ht frame flow speed , leading to significant anisotropies in the particle population , and more importantly , measurable differences in the degree of anisotropy produced in pad and las modes . since such differences in angular distributions",
    "are responsible for observed differences between las and pad applications to unmodified relativistic shocks ( e.g. see ellison , jones , and reynolds 1990 for a comparison of the modes , and kirk and schneider 1987 ; ostrowski 1991 for pad cases ) , it is not surprising that spectral differences should appear here at suprathermal energies for highly oblique shocks .",
    "clearly , figure  [ fig : testspectra ] shows that for this intermediate obliquity case , the mode of scattering has virtually no effect on the resultant spectrum at either thermal or the highest energies , and therefore that the scattering mode plays little role here in determining the efficiency of acceleration , i.e. the fractional energy deposited in high energy particles .",
    "this is not surprising , because of the low value of here : we naturally expect that strong scattering ( near the bohm diffusion limit ) will destroy any sensitivity of the acceleration process to the shock obliquity or distribution anisotropies , and hence the type of scattering .",
    "later , we shall see that larger ( but still relatively small ) differences between the scattering modes occur for weak scattering ( i.e. , large )",
    ".    also evident in figure  [ fig : testspectra ] is the strong effect the input parameters have on injection efficiency : the spectra fall an order of magnitude below the spectra at high energies even though they both obtain the same power law index . increasing either or will result in decreased injection efficiency .",
    "these effects were detailed in ellison , baring , and jones ( 1995 ) , where an anti - correlation between acceleration time and efficiency of acceleration in test - particle shocks was observed .",
    "we note that existing analytic predictions for the transition between the thermal peak and the high energy power - law , i.e. , the injection efficiency , require _ ad hoc _ parameters additional to and independent of those made for the shock structure to connect the thermal gas to the cosmic ray population ( e.g. zank , webb , and donohue 1993 ; kang and jones 1995 ; malkov and vlk 1995 ) .",
    "the advantage of our model is that the single relation [ equation  ( [ eq : mfp ] ) ] controls the shock structure , the absolute injection efficiency , and , in fact , the entire shock solution .",
    "this makes it straightforward to compare model predictions to observations and to infer plasma properties ( such as the level of turbulence , the correctness of the elastic scattering assumption , etc . ) from these comparisons , an attractive feature .",
    "properties of upstream particle distributions are deferred to the discussion of non - linear results in the next subsection , though test - particle spectra upstream of oblique shocks were presented in baring , ellison and jones ( 1994 ) .      for our next examples , we compute the self - consistent smooth shock profile beginning with a low mach number case , i.e. , , , , and , yielding a plasma of .",
    "this corresponds to a weak shock , typical of interplanetary shocks observed in the heliosphere ( e.g. see burton et al .",
    "1992 , baring et al .",
    "1995 ) . to reiterate , in the results that follow",
    ", all lengths are measured in units of , which is the mean free path of a proton of gyroradius , i.e. with the speed in the upstream magnetic field .    in the left panels of figure  [ fig : twoprofiles ]",
    "we depict the average flow speed , , the flux of the @xmath6-component of momentum , and the energy flux , all normalized to far upstream values , for several iterations starting from a discontinuous shock ( light solid line ) and yielding the final profile ( heavy solid line ) .",
    "these iterations were done using las and an overall compression ratio of which was determined in previous iterations on . the rankine hugoniot compression ratio with is which is equal ( within errors ) of our 2.7 value .",
    "the convergence is quite rapid and the heavy solid lines ( fourth iteration ) show no further statistically significant change with additional iterations . except for a departure of about 5% near , the flux of the @xmath6-component of momentum ( middle panels ) is constant for all after the final shock profile has been obtained .",
    "the flux of the @xmath26-component of momentum is generally small and less interesting ; its profile ( and those of and ) is not displayed for reasons of brevity .",
    "for the discontinuous shock ( light solid lines ) , the momentum flux was clearly not conserved and rose to of the far upstream value downstream from the shock .    the escaping energy flux at the feb ( which is at @xmath27 and not shown in the figure ) , is less than 1% of the far upstream value and does not influence the overall compression ratio significantly .",
    "the check on the consistency of the final profile is that the momentum flux and the energy flux , including the escaping flux , must both be conserved .",
    "when this is achieved ( i.e. corresponding to the solid lines ) , we have a unique , self - consistent solution .",
    "the discrepancy in the energy flux near is most likely the result of the strong gradients in the shock and/or agyrotropic pressure tensor terms in the rankine - hugoniot relations which we have neglected from our flux considerations .",
    "this discrepancy decreases rapidly with increasing mach number , and so is greatest for this present case .",
    "figure  [ fig : twoprofiles ] also shows the shock structure obtained with pitch - angle diffusion pad ( right panels ) , all other shock parameters being the same as the las case . within statistics ,",
    "the two scattering modes give identical results , both for the shape of the profile and the overall compression ratio .",
    "this feature is not surprising given that the test - particle results of the previous simulation bore this similarity out .    in figure",
    "[ fig : specone ] we show the distribution functions generated by the smooth shocks of figure  [ fig : twoprofiles ] .",
    "the spectra are omni - directional , measured downstream from the shock , and calculated in the shock ( i.e. nif ) frame . as with the shock structure , the distribution functions obtained with the two scattering modes are identical within statistics .",
    "this is to be expected because is close to the bohm diffusion limit where , as mentioned above , isotropic diffusion will naturally obscure the differences between pad and las .",
    "there is a large difference , however , between the smooth shock results and the test - particle , discontinuous shock ( dotted line ) , which was obtained using the same compression ratio ( ) computed in the self - consistent solution of the non - linear las simulation .",
    "the light solid line is the fermi power - law expected from ; the test - particle spectrum attains this result before the falloff at kev produced by the feb .",
    "the discontinuous shock produces more efficient acceleration at low energies than the smooth shock , which follows from the nature of the smoothed shock profile : low energy particles feel the effect of the subshock whereas only the high energy particles sample the full compression ratio of .",
    "this same property is responsible for the upward curvature of the non - linear spectra , which never attain the fermi power - law , but flatten towards it before falling off due to the feb .",
    "we have also obtained solutions ( not shown ) using exactly the same parameters as above except with a feb at .",
    "the smaller shock system causes a cutoff at a lower energy than seen in figure  [ fig : specone ] and the shock structure is correspondingly on smaller length scales .",
    "however , the self - consistent compression ratio is still , consistent with a , as expected , since these low mach number shocks put a small fraction of the available energy into energetic particles regardless of the shock size .    as a more extreme example",
    ", we show in figure  [ fig : febprofile ] a high mach number shock ( ) with a much larger shock size , i.e. , the feb is at .",
    "the other input parameters are : km  sec@xmath22 , @xmath23 , , , g , and k , yielding .",
    "we have only used the las scattering mode since the pad results are essentially identical .",
    "note that the self - consistent compression ratio used here is ( well above the r - h value of ) which has been determined with previous runs not shown .",
    "the distance scale in figure  [ fig : febprofile ] is logarithmic for and linear for .",
    "there are several important features of this shock solution . in the first iteration with no shock smoothing ,",
    "the momentum and energy fluxes are wildly non - conserved with both of them obtaining downstream fluxes almost 15 times as large as the upstream values . despite this , the subsequent iterations converge rapidly and by the fourth iteration the momentum flux is conserved everywhere to within 5% of the upstream value ( the first , second , third , and fourth iterations are shown by light solid , dashed , dash - dot , and heavy solid lines , respectively ; the flat dotted line indicates the far upstream value ) .",
    "the effects from the anisotropic terms in the momentum and energy fluxes are less noticeable here than in the previous low mach number examples . as with the previous examples ,",
    "the shock is smoothed out to the feb , however the subshock here is considerably more distinct showing a sharp discontinuity between the flow just upstream from the subshock and the downstream flow .",
    "the width of the subshock is well within one .    as for the energy flux",
    ", it falls about 20% below the far upstream value due to the particles lost at the feb .",
    "the escaping energy flux , , which is zero far upstream , falls rapidly around and then becomes approximately constant into the downstream region .",
    "this results in a compression ratio , obtained by iteration in previous runs , of , compared to the r - h value of",
    ". a compression ratio of implies and a , and when this is added to the energy flux shown in the bottom panel of figure  [ fig : febprofile ] , we have a self - consistent solution with all fluxes constant at all to within a few percent .",
    "larger escaping fluxes are expected for such high mach number shocks because their greater compression ratios enhance the acceleration efficiency to the highest energies .",
    "the complete shock structure is shown in figure  [ fig : febstruct ] , where we have included along with , the -component of flow speed , , the angle the local magnetic field makes with the shock normal , , and the total magnetic field magnitude , .",
    "the solid lines show the final shock structure and this is compared to the initial structure shown by dotted lines .",
    "as noted above , both the shape and the overall compression ratio must be modified to obtain a self - consistent solution , and this translates to a change from the r - h values in the downstream , , and as indicated by the dotted lines .",
    "the sharpness of the subshock in figure  [ fig : febstruct ] at is partially an artifact of how we smooth and truncate the flow profile between iterations . as mentioned above , we average the predicted profile with the previous one and , since we start with a discontinuous shock , some sharpness persists",
    ". we also set all predicted values of to at . despite this , the subshock is , in fact , quite sharp as we discuss at the end of this section .    in figure",
    "[ fig : febspec ] we show ( solid line ) the downstream , shock frame distribution function obtained in the smooth shock solution just described .",
    "it differs considerably from the test - particle solution ( dotted line ) in that the downstream thermal peak is at a lower energy , the temperature is slightly lower , and far fewer thermal particles become accelerated .",
    "the straight line is the power - law slope expected from the test - particle fermi solution with and matches our test - particle solution at energies well above thermal and below where the feb becomes important .",
    "the smooth shock solution , however , does not attain the test - particle power - law and remains considerably steeper .",
    "this can be understood by examining the top panel of figure  [ fig : febprofile ] where it can be seen that at there is enough escaping energy flux to smooth the shock further upstream from this point .",
    "particles leave the shock at the feb before feeling the full compression ratio .",
    "to complete this example , we show in figure  [ fig : upsspec ] distribution functions at various -positions , i.e. , ( dotted line ) , ( dashed line ) , ( light solid line ) , and ( heavy solid line ) . at observation",
    "points far upstream from the shock , only the unshocked thermal peak is present since energetic particles from the shock are not able to diffuse against the background flow to reach the observation point .",
    "as the upstream observation point moves toward the shock two things happen .",
    "first , the highest energy particles begin to show their presence , and second , the thermal peak from particles which have not yet crossed the shock begins to shift to lower energy ( see insert where we have plotted the thermal peaks of the and spectra ) .",
    "since we take , the diffusion length increases with energy and higher energy particles from the shock are able to stream further upstream than low energy ones , thus as the observation point moves toward the shock the spectrum fills in from high energy to low ( this property was recognized , for test - particle situations , by baring , ellison and jones 1994 ) .",
    "the shift in the thermal peak arises because spectra calculated in the shock frame shift to lower energy as the bulk flow speed falls as the shock is approached .",
    "the slowing of the bulk flow in the shock precursor also heats the incoming particles somewhat before they encounter the sharp subshock lowering the local mach number .",
    "these features are well - defined model predictions that can be tested against observations .    in figure",
    "[ fig : upsscale ] we show the upstream scale height for particles of various energies .",
    "the ordinate is the ratio of the flux at over the flux at for a given energy .",
    "as expected , the length scale ( i.e. distance at which the flux _ e - folds ) is largest for the highest energy particles , and the fluxes fall off exponentially with distance from the shock ( a property of diffusion against the convecting flow ) .",
    "it is also important to note that low energy particles ( i.e. the 3 and 10 kev examples ) can have extremely short upstream precursors .",
    "particle detectors on spacecraft being overtaken by interplanetary shocks will see very different time profiles depending on the particle energy sampled and may , depending on the time integration of the spectrometer ( which is usually long compared with typical gyroperiods ) , see a step function increase in intensity at low energies simultaneously with a slow rise in high energy particles .",
    "this effect may explain some puzzling aspects of recent ulysses observations which have led to the suggestion that a two - stage acceleration mechanism operates for pickup protons ( gloeckler et al .",
    "_    as our final example , we show in figure  [ fig : sfprofile ] a highly oblique shock ( ) with , , , and using large - angle scattering . for these parameters little acceleration occurs and the shock profile is nearly discontinuous .",
    "nevertheless , the little smoothing evident in the top panel of figure  [ fig : sfprofile ] is enough to reduce the energy flux from being above the far upstream value to a constant value .",
    "because of the inefficient acceleration , few particles , carrying very little energy flux , escape at the feb , so there is no need to adjust the compression ratio .",
    "the final ratio is , effectively the r - h value .",
    "we have done the same calculation with the same parameters except using pitch - angle diffusion and find essentially the same profile ( which is not shown ) , although some slight differences do show up in the distribution functions .",
    "the top two curves in figure  [ fig : sfspec ] are the distribution function from the las example ( solid line ) along with the distribution produced in a shock with the same parameters as that shown in figure  [ fig : sfprofile ] , only using pad ( dashed line ) .",
    "the main difference between the two cases is that the pad distribution is somewhat smoother than the las one .",
    "the pad shock is also somewhat less efficient in accelerating particles to the highest energies . in general , however , even at this large obliquity , the choice of scattering mode does not play a dominant role in determining the acceleration efficiency . the lower two curves ( multiplied by 0.01 for clarity ) are test - particle results and are similar to the distribution functions produced by the smooth shock , but slightly flatter , as expected .",
    "no portions of these examples elicit the fermi , test - particle power - law slope ( dotted line ) but are clearly flattening toward it before the feb causes the spectra to turn over .    finally , we comment on the sharpness of the subshock seen in all of the examples we have presented . as mentioned above ,",
    "part of this is due to the scheme we have for iterating the profile and insuring rapid convergence .",
    "we average the predicted profile with the previous one , make the predicted profile monotonic , and set all predicted values of to for . in figure",
    "[ fig : aveflow ] we show the same final plots as shown in the top left panel of figure  [ fig : twoprofiles ] , the top panel of figure  [ fig : febprofile ] , and the top panel of figure  [ fig : sfprofile ] , except here they are all plotted on an expanded linear distance scale ( solid lines ) .",
    "the dotted lines in figure  [ fig : aveflow ] are the _ calculated obtained from distributions produced by the simulation using the solid line shock profiles . in all cases ,",
    "the mean velocities are nearly as sharp as our processed profiles except for statistical fluctuations and the truncation we impose at . outside of the range shown , and are indistinguishable except for noise . with the possible exception of the low mach number case , a clear subshock exists which is considerably less than in width .",
    "while comparing and is somewhat artificial since is calculated using , the small broadening of the flow speed around does nt have an appreciable influence on the momentum and energy fluxes .",
    "we have performed simulations using instead of and the momentum and energy fluxes remain within of the conserved values at all . for our purposes , since we do not attempt to model scales less than a convected thermal ion gyroradius , there is essentially no difference between the used in the simulation and . _",
    "a quantity that is central to the acceleration problem is the efficiency of the fermi mechanism .",
    "it can be defined in a variety of ways : we define the acceleration efficiency , , at or behind the shock as the downstream energy flux above energy divided by the incoming energy flux , i.e. , @xmath28 where is the downstream pressure in particles with energies greater than .",
    "the pressure is obtained by taking of the energy density in the omni - directional distribution , , and we take to be energy independent , i.e. , we assume all of the escaping energy flux is carried by the highest energy particles .",
    "this last assumption will distort somewhat at the highest energies since particles of varying energies leave the feb .    in figure",
    "[ fig : figacceff ] we show for our three previous non - linear examples , i.e. , curve ( a ) is for the las case shown in figure  [ fig : specone ] , ( b ) is for the case shown in figure  [ fig : febspec ] , and ( c ) is for the las , smooth shock case shown in figure  [ fig : sfspec ] . as is apparent from the figure ,",
    "large differences in the efficiency depending on , the mach number , , and the distance to the feb occur .",
    "examples ( b ) and ( c ) both accelerate particles to above 1000 kev and have similar mach numbers , but the highly oblique shock ( c ) , is much less efficient .",
    "examples ( a ) and ( b ) have the same but differ considerably in mach numbers ( 3 versus 20 , respectively ) , with ( b ) being more efficient because its higher mach numbers generate a larger compression ratio . at this stage of our work , there appears to be no simple way to characterize the injection and acceleration efficiency of oblique shocks , but the trends with obliquity and mach number are quite clear .",
    "the flattening at the highest energies seen in ( a ) and ( b ) is an artifact of assuming that is carried totally by the highest energy particles ; if a spread of escape energies were possible , corresponding to a range of , the flattening would be replaced by a quasi - exponential turnover .",
    "note also , that the efficiency curves in figure  [ fig : figacceff ] do not quite converge to unity at low energies due to simulation statistics .",
    "another point which should be made concerning figure  [ fig : figacceff ] is that we choose to define our efficiency as a function of energy .",
    "if we do not have an independent source of energetic seed particles , all accelerated particles must originate as thermal particles and they will be drawn more or less continuously from the thermal population  there will be no clear separation between thermal and energetic particles .",
    "our identical treatment of the thermal and non - thermal populations is why we have defined our efficiency as a function of energy .",
    "however , there are ways to qualitatively prescribe efficiencies that describe the overall distribution rather than different particle energies . for example , while all three cases in figure  [ fig : figacceff ] have comparable efficiency at around 0.8 kev , this energy does not define the approximate juncture between thermal and non - thermal populations for cases ( a ) and ( c ) , whereas it does for case ( b ) .",
    "this juncture is _ roughly represented by the upward kinks at energies 3 kev and 1.7 kev for cases ( a ) and ( c ) respectively .",
    "hence , the ratio of downstream non - thermal to thermal energy densities for the three cases are roughly ( a ) 0.2 , ( b ) 0.7 and ( c ) 0.2 ; these numbers could be taken as an alternative measure of acceleration efficiency . _",
    "a host of observational evidence , both direct and indirect , confirms that collisionless shocks in space accelerate particles with high efficiency .",
    "possibly a large fraction of _ all _ non - thermal particle populations in diffuse regions of space are generated by shocks , making shock acceleration one of the most important problems in high energy astrophysics . as a step toward a full understanding of shock acceleration , we have developed a model which combines nonlinear particle acceleration and diffusion with shock dissipation and non - linear hydrodynamics forming the shock structure .",
    "this paper presents both the details of our simulation technique and representative acceleration results as a prelude to a more comprehensive survey of the parameter space associated with modified , oblique shocks . while our model is still incomplete , with simplifying assumptions concerning the microphysical processes involved , we believe it is the most realistic current solution of the steady - state shock acceleration problem . we include ( i ) a strongly energy - dependent diffusion coefficient [ see equation  ( [ eq : mfp ] ) ] , which models cross - field diffusion , ( ii ) the ability to model either large - angle scattering or pitch - angle diffusion , ( iii ) injection from the thermal background with no additional free parameters , ( iv ) the determination of the self - consistent , average shock structure including the dynamic effects of accelerated particles on the thermal shock , ( v ) the dynamic effects of particle escape from finite shocks , and ( vi ) shock drift and compressional acceleration simultaneously .",
    "principal results of this paper include downstream spectra ( see figures  [ fig : specone ] , [ fig : febspec ] and  [ fig : sfspec ] ) , properties of upstream populations ( see figures  [ fig : upsspec ] and  [ fig : upsscale ] ) , and acceleration efficiencies ( figure  [ fig : figacceff ] ) .",
    "the monte carlo simulation does not treat ( i ) a self - consistent determination of the diffusion coefficient from wave - particle interactions , ( ii ) time - dependent effects , ( iii ) relativistic particles or flow speeds ( iv ) a cross - shock potential due to charge separation , or ( v ) geometry other than a plane shock .",
    "clearly the most important omission is the self - consistent determination of the diffusion coefficient .",
    "our results hinge on the energy - dependent form we have assumed for , which is motivated by previous theoretical analyses ( see jokipii 1987 ; giacalone , burgess and schwartz 1992 ; ellison baring and jones 1995 ) , and also observational constraints at parallel shocks ( see ellison , mbius , and paschmann 1990 and ellison and reynolds 1991 ) .",
    "however , the self - consistent determination of requires knowledge of the microphysics and only plasma simulations where the electric and magnetic fields are calculated directly from particle motions ( e.g. quest 1988 ) can give this information .",
    "these simulations are extremely demanding computationally and will not , in the foreseeable future , be able to adequately model particle acceleration in shocks to astrophysically important energies",
    ". the recent work of jokipii et al .",
    "( jokipii , giacalone , and kta 1993 ; giacalone , jokipii , and kta 1994 ; jokipii and jones 1996 ) has shown that if a coordinate is ignorable ( as in one- or two - dimensional hybrid simulations ) , cross - field diffusion effects are suppressed , and since cross - field diffusion is an essential part of injection and acceleration in shocks ( certainly oblique ones ) _ three - dimensional simulations _ must be used to model shocks .",
    "no existing computer is capable of running realistic three - dimensional plasma simulations over dynamical ranges of energies appropriate to astrophysical applications .",
    "we emphasize that even though we model plane shocks and our scattering operator is a gross simplification of the complex plasma processes taking place in shocks , the operator is fully three - dimensional , includes cross - field diffusion , and may well produce more realistic results than current one- or two - dimension plasma simulations .",
    "in fact , comparisons between our model and spacecraft observations of highly oblique interplanetary shocks ( ipss ) ( baring et al .",
    "1995 ) suggest that this is the case .",
    "the spacecraft observations clearly show that highly oblique shocks inject and accelerate _ thermal _ particles , a result we can model accurately ( e.g. figures  [ fig : sfspec ] and  [ fig : figacceff ] ) , but one which , to our knowledge , all existing one- and two - dimensional plasma simulations fail to show ( e.g. liewer , goldstein , and omidi 1993 ; liewer , rath , and goldstein 1995 )",
    ".    virtually all analytic models of nonlinear shock acceleration have been restricted to parallel shocks , however , jones and kang ( 1995 ) have recently extended the cosmic ray diffusion - advection equation approach to oblique geometry and produced impressive fits to the ulysses observations mentioned above ( e.g. baring et al .",
    "however , all models based on the diffusion approximation ( i.e. the requirement that particle speeds be large compared to flow speeds ) are limited in their ability to treat thermal particles and must use additional free parameters to model injection .",
    "for example , the parallel shock model of berezhko et al .",
    "( i.e. berezhko , yelshin , and ksenofontov 1994 ; berezhko , ksenofontov , and yelshin 1995 ; berezhko et al .",
    "1995 ) uses a source term for monoenergetic injection at the gas subshock which is treated as a discontinuity . here",
    ", a small fraction of incoming gas is transferred to cosmic rays , the injected particles instantly obtaining a superthermal momentum , . both and are free parameters and the final results depend strongly on them .",
    "the main advantage of our model is that the monte carlo description is not restricted to superthermal particles and injection is treated self - consistently regardless of whether or not we assume that all particles obey equation  ( [ eq : mfp ] ) .",
    "once some such scattering description is chosen , both the injection rate and the effective injection momentum are fully determined , as is the complete shock structure , by the monte carlo solution without any additional parameters such as .",
    "in fact , there is no ` injection momentum ' in our solution since particles are drawn smoothly from the background thermal gas .",
    "the parameters which determine the injection and acceleration efficiency of shocks are the obliquity , , the strength of cross - field diffusion , , the mach numbers , and , and the size of the shock system ( i.e. ) .",
    "these all influence the shock in complex ways and there is no simple relationship between them . in general",
    ", we can state that the acceleration efficiency ( i.e. the fraction of energy flux which ends up in high energy particles ) increases with : ( i ) decreasing , ( ii ) decreasing ( i.e. stronger scattering ) , ( iii ) increasing mach number , and ( iv ) increasing shock size .",
    "we have found that the differences in the shock structure and acceleration efficiency resulting from using either large - angle scattering ( las ) or pitch - angle diffusion ( pad ) are generally small ( e.g. see figure  [ fig : testspectra ] for the test - particle regime , and figures  [ fig : specone ] and  [ fig : sfspec ] for full non - linear results ) for parameter regime we have investigated , namely , and can be neglected in the bohm diffusion limit .",
    "however , the differences between the nonlinear results and the test - particle ones are very large ( e.g. figure  [ fig : febspec ] ) except for high obliquities ( i.e. figure  [ fig : sfspec ] ) or very low mach numbers ( figure  [ fig : specone ] ) , where the acceleration efficiency is low enough for the thermal gas to dominate the non - thermal population dynamically , and the shock profiles are very sharp .    for the first time",
    ", we have been able to calculate the absolute injection and acceleration efficiency of non - linear oblique shocks without the use of an _ ad hoc _ injection parameter .",
    "our results ( figure  [ fig : figacceff ] ) show how large differences in efficiency can occur as parameters change , however , we have not yet explored the vast parameter regime oblique geometry opens up .",
    "our next step toward a more complete solution of the shock acceleration problem will be a survey intended to quantify the differences the various parameters make in the distribution function and overall efficiency .",
    "this will include determining the effect of varying equation  ( [ eq : mfp ] ) and will yield predictions for future spacecraft and plasma simulation results .",
    "the only way to constrain our parameter is by comparing our results with direct observations of shocks or with three - dimensional plasma simulations . since , to our knowledge",
    ", no three - dimensional simulation results showing significant acceleration exist , we will concentrate on spacecraft observations as they become available .",
    "as already mentioned , this work has begun with spectral comparisons to ulysses observations of nearby interplanetary shocks ( i.e. those not expected to encounter pick - up ions ) , and our preliminary comparisons with data from ulysses have already indicated that strong scattering accompanies highly oblique ipss , constraining to values smaller than about 10 ( baring et al .",
    "our simulation produces particle distributions at different distances upstream and downstream of the subshock , thereby providing a wealth of model predictions for testing against observations .",
    "once we are successful in constraining our parameters with heliospheric shock observations , the next step will be to apply our results to shocks with no _ in situ particle observations , such as the termination shock and supernova remnant blast waves .",
    "this is another useful aspect of our model and we expect to be able to make predictions for the relative injection and acceleration efficiency as a function of ionic composition for both thermal and pickup ions at the termination shock , and to calculate how efficiency varies around the rim of a supernova remnant shock . since",
    "relativistic particles are produced in these shocks , our model will soon be generalized to include relativistic particle energies . _",
    "the authors wish to thank b. lembege , a. mangeney , and s. reynolds for helpful comments .",
    "our code runs on massively parallel machines and computing time for this project was provided by the cray t3d s at cnrs idris and at c.e.a . ,",
    "grenoble , france .",
    "this research was supported in part by the nasa space physics theory program and dce wishes to thank the service dastrophysique , c.e .",
    "saclay , observatoire de paris  meudon , and cnet / cetp ( issy - les - moulineaux ) for hospitality during the time part of this work was performed .",
    "this appendix describes four technical aspects of the monte carlo simulation , namely ( 1 ) our description of pitch angle diffusion , ( 2 ) how particles cross the shock and grid points ( actually planes of discontinuity of the flow and field profiles ) in the simulation , ( 3 ) the details of how the probability of particle return from beyond the downstream simulation `` boundary '' is determined , and ( 4 ) how we derive the form of the conservation of energy flux in equation  ( [ eq : enflux ] ) .      to summarize our implementation of pitch - angle diffusion ( pad ) ,",
    "which has been given in detail in ellison , jones , and reynolds ( 1990 ) , we simulate small - angle scattering effects by allowing the tip of the particle s fluid frame momentum vector to undergo a random walk on the surface of a sphere . if the particle originally had a pitch angle , , and after a time undergoes a small change in direction of magnitude , its new pitch angle , , is related to the old by @xmath29 where is the azimuthal angle of the momentum change measured relative to the plane defined by the original momentum and . after each scattering , a new phase angle around the magnetic field , , is determined from the old phase angle , , by @xmath30     \\label{eq : phasenew}\\ ] ] is randomly chosen from a uniform distribution between and , and is randomly chosen from a uniform distribution between and , so that the tip of the momentum vector walks randomly over the surface of a sphere of radius .",
    "if the time required to accumulate deflections of the order of is identified with the collision time , , using a diffusion analysis , the relation between and the mean free path was shown by ellison , jones , and reynolds ( 1990 ) to be @xmath31 where .",
    "pitch angle diffusion is then defined by the regime .",
    "clearly , using this approach implies a magnetic fluctuation correlation length smaller than the particle gyroradius ; this method then becomes an approximation that is nevertheless still very convenient for implementation in monte carlo simulations .",
    "note that in the limit of , this prescription of pad becomes comparable to our scheme for large angle scattering ( see ellison , jones , and reynolds 1990 ) .",
    "equations  ( [ eq : pitchnew ] ) and  ( [ eq : phasenew ] ) then can be used to determine the coordinates of the new gyrocenter @xmath32 where is the position of the particle when it scatters .",
    "the phase offset of represents the differences between position and momentum vector phases .",
    "the gyroradius remains unchanged in the pad event ( true also for large angle scattering ) since is fixed at the point of scattering and our assumption of elastic scattering leaves the magnitude of the momentum unchanged in the fluid frame .",
    "however , in contrast to the las case where the particle s momentum vector is only updated after on average , the momentum vector is updated after every for pad .",
    "when a particle crosses a grid zone boundary ( there is no distinction in our code between the shock and any other grid boundary ) , its orbit is changed because the magnetic field changes direction and magnitude .",
    "the new values of the particle s pitch angle are obtained from the assumption that the momentum in the ht frame remains unchanged at the zone boundary ; this follows from of the absence of drift electric fields in this frame .",
    "this method does not require that the magnetic moment be conserved ; differences between gyrohelix computations at a flow interface and the adiabatic approximation are discussed by terasawa ( 1979 ) .",
    "the detailed calculation ( see also decker 1988 ; begelman and kirk 1990 ; ostrowski 1991 ; and takahara and terasawa 1991 ) is as follows ( the geometry is illustrated in figure  [ fig : gdcross ] ) .",
    "the component of the old momentum ( i.e. the momentum before crossing the grid zone boundary ) in the @xmath13-direction is given by @xmath33 and the component along the @xmath34-direction is @xmath35 where @xmath36 is the component of momentum along @xmath37 , and @xmath38 is perpendicular to the @xmath13-@xmath39 plane .",
    "note that all momenta in this section are measured in the ht frame .",
    "the component of momentum along the @xmath40-direction ( i.e. the axis perpendicular to the @xmath13-@xmath41 plane ) , is given by @xmath42 where @xmath43 is the difference in @xmath44 across the grid zone boundary .",
    "the total momentum perpendicular to the new magnetic field direction , @xmath41 , is @xmath45 and the new momentum parallel to the new magnetic field direction is @xmath46 finally , the new phase around @xmath41 is given by @xmath47      the details of how particle return from the far side of the downstream return boundary ( drb ) is effected are presented here ; such return boundaries are found not only in our monte carlo technique , but also in hybrid plasma simulations ( e.g bennett and ellison 1995 ) .",
    "assume a uniform flow with a component of velocity in the positive -direction of and assume that particles in the local fluid frame are isotropic and of speed .",
    "quantities denoted by subscript f are measured in this fluid ( plasma ) frame .",
    "the flux of particles crossing a - plane that is parallel to , and downstream of , the subshock interface is proportional to , the -component of particle speed in _ any frame in which the shock is at rest . here",
    "( ) for transmissions to the downstream ( upstream ) side of the drb .",
    "_    the probability that particles return to the drb after crossing it from the upstream side is therefore simply ( e.g. see jones and ellison 1991 ) the ratio of the flux of particles moving upstream of the drb to the flux of particles moving to the downstream side of this plane . clearly defines downstream crossings of the drb , while prescribes upstream crossings .",
    "we confine the discussion to cases with , and further specialize hereafter to the specific shock rest frame where the flow has zero component of velocity in the plane of the drb . integrating over the angle of the particle velocity relative to the shock normal , or alternatively over , the probability of return to the drb for isotropic particles of speed ( in the fluid frame ) is @xmath48 this expression is valid for any shock obliquity and is relativistically correct ( peacock 1981 ) .",
    "it applies to all ( for , ) , and the only requirements for its validity are that the particles be isotropic in the local fluid frame and that they do not change speed in the region to the right of the return plane . to ensure isotropy",
    ", we only apply equation  ( [ eq : probreturn ] ) after particles have scattered at least once in the downstream region when las is used , or that particles have diffused through in the downstream region when pad is used .",
    "the decision for return , or otherwise , is made via a random number generator .",
    "now , consider only those particles which return back across the return plane .",
    "both their pitch angle relative to the magnetic field , , and their phase around the magnetic field , must be determined in the fluid frame .",
    "determining these requires knowledge of for the returning particles , which can be computed by again noting that the flux of particles returning across the return plane ( moving in the negative -direction ) is proportional to .",
    "this means that the number of particles returning with between and is proportional to .",
    "so , for a particular , returning particles are drawn from a distribution such that @xmath49 where is a random number uniformly distributed between 0 and 1 .",
    "therefore , @xmath50 and from this the -component of speed in the plasma frame @xmath51 can be obtained . choosing a series of random numbers ,",
    ", between 0 and 1 gives the proper distribution of returning particles .    to determine and in the fluid frame , we assume that particles will return distributed symmetrically around the -axis in the fluid frame , a consequence of isotropy .",
    "this symmetry appears also in our special shock frame ( see figure  [ fig : probretone ] ) , where the flow is orthogonal to the drb , since phases are preserved in velocity transformations orthogonal to this plane .",
    "the velocity vector of a returning particle will make an angle in the fluid frame with the -axis , given by .",
    "if it also has an azimuthal angle about the -axis of , chosen randomly between 0 and , then from figure  [ fig : probretone ] , using spherical triangles , the values of the fluid frame pitch angle and phase can be expressed in terms of , and .",
    "subsequently , the returning particle is placed at the downstream return plane and , using the new fluid frame phase and pitch angle ( and also a new position for the guiding center ) , propagated upstream by transforming to the de hoffmann - teller frame .",
    "the statistical prescription in this subsection guarantees that our code effectively simulates an infinite region to the downstream side of the probability of return plane .      while the pressure terms in the momentum fluxes in equations  ( [ eq : xmoflux ] ) and  ( [ eq : zmoflux ] )",
    "are elementary to write down , derivation of the forms for the corresponding terms in the energy flux in equation  ( [ eq : enflux ] ) involve some subtleties . as outlined section  3.1 ,",
    "we restrict the analysis to gyrotropic particle distributions in local fluid frames in the interest of simplicity ; we believe that such an approximation is quite good , and certainly better than the assumption of isotropy that is ubiquitous in flux conservation equation usage in the literature .    in a local fluid frame somewhere in the shock environs , consider coordinate axes oriented so that the @xmath6-direction is aligned with the local magnetic field , but such that a single rotation about the @xmath13-axis produces an identical orientation to the system depicted in figure  [ fig : shock ] . in this coordinate system ,",
    "a gyrotropic plasma has a diagonal pressure tensor , namely and with otherwise . and",
    "are components of pressure parallel to and orthogonal to the ambient field , and for a thermal plasma are related to analogous temperature components by two equations of state . rotating the axes into alignment with the system in figure  [ fig : shock ] yields a non - diagonal pressure tensor due to mixing of the components : @xmath52 where is the rotation matrix .",
    "this gives a specific form for the pressure tensor of @xmath53 since pressure represents the spread of velocities about the mean speed , the pressure tensor is invariant under bulk velocity transformations .",
    "hence it follows that equation  ( [ eq : ptensor ] ) defines the pressure in the normal incidence frame , and therefore is directly applicable to the flux conservation considerations .",
    "the above coordinate rotation therefore yields the relationships @xmath54 which define the components of the pressure tensor on the fluid frame in terms of normal incidence frame tensor components that can be simply determined using the structure of our simulation . at this point",
    "it becomes apparent that the assumption of gyrotropy in the fluid frame is indeed expedient , since it enables complete specification of the fluid frame pressure tensor using only flux quantities measured in the nif in the @xmath6-direction : generalizing from the gyrotropic approximation would require construction of coordinate grids in the other directions , thereby complicating the simulation immensely , with only marginal gain in physical accuracy .",
    "the energy flux equation can now be simply constructed from the formalism on p.  56 of boyd and sanderson ( 1969 ) .",
    "the convective contribution to the energy flux is simply .",
    "the thermal - type ( i.e. velocity spread ) term is usually written in the form for temperature , where is boltzmann s constant , and is the ratio of specific heats .",
    "for the non - thermal application here , prescribing the temperature is inappropriate , so we make use an equation of state in order to generalize to non - thermal situations by converting to pressure formalism .",
    "it follows that @xmath55 is the non - convective contribution to the energy flux in the @xmath6-direction that results from particle pressure .",
    "this applies to both the non - relativistic gases considered in this paper ( with ) , and also more general cases with different equations of state ( i.e. ) , including relativistic plasmas . using the magnetic field identity then results in the form given in equation  ( [ eq : enflux ] ) .",
    "axford , w.  i. : 1965 @xmath56 * 13 , 115 * axford , w.  i. : 1981 in _ proc .",
    ". cosmic ray conf .",
    "( paris ) , @xmath56 * 12 , 155 * axford , w.  i. , leer , e. , and skadron , g. : 1977 in _ proc .",
    ". cosmic ray conf .",
    "( plovdiv ) , @xmath56 * 11 , 132 * baring , m.  g. , ellison , d.  c. , and jones , f.  c. : 1992 in _ particle acceleration in cosmic plasmas , eds .",
    "zank , g.  p. and gaisser , t.  k. ( aip conf .",
    "264 ; aip , new york ) p.  177",
    "baring , m.  g. , ellison , d.  c. , and jones , f.  c. : 1993 @xmath56 * 409 , 327 * baring , m.  g. , ellison , d.  c. , and jones , f.  c. : 1994 @xmath56 * 90 , 547 * baring , m.  g. , ellison , d.  c. , and jones , f.  c. : 1995 @xmath56 * 15 ( 8/9 ) , 397 * baring , m.  g. , ogilvie , k. , ellison , d.  c. , and forsyth , r. : 1995 @xmath56 * 15 ( 8/9 ) , 388 * begelman , m.  c. and kirk , j. g. : 1990 @xmath56 * 353 , 66 * bell , a.  r. : 1978 @xmath56 * 182 , 147 * bennett , l. and ellison , d.  c. : 1995 @xmath56 * 100 , 3439 * berezhko , e.  g. , krymsky , g.  f. , ksenofontov , l.  t. , and yelshin , v.  k. : 1995 in _ proc .",
    ". cosmic ray conf .",
    "( rome ) , @xmath56 * 3 , 392 * berezhko , e.  g. , ksenofontov , l.  t. , and yelshin , v.  k. : 1995 nucl .",
    "b ( proc . suppl . )",
    "@xmath56 * 39a , 171 * berezhko , e.  g. , yelshin , v.  k. , and ksenofontov , l.  t. : 1994 @xmath56 * 2 , 215 * blandford , r.  d. and eichler , d. : 1987 @xmath56 * 154 , 1 * blandford , r.  d. , and ostriker , j.  p : 1978 @xmath56 * 221 , l29 * boyd , t.  j.  m. and sanderson , j.  j. : 1969 _ plasma dynamics _ , ( barnes and noble , new york ) .",
    "burgess , d. : 1989 @xmath56 * 16 , 163 * burton , m.  e. , smith , e.  j. , goldstein , b.  e. , balogh , a. , forsyth , r.  j. , and bame , s.  j. : 1992 @xmath56 * 19 , 1287 * decker , r.  b. : 1988 @xmath56 * 48 , 195 * decker , r.  b. , and vlahos , l. : 1985 , @xmath56 * 90 , 47 * de hoffmann , f. and teller , e. : 1950 _ phys . rev.@xmath56",
    "* 80 , 692 * drury , l.  oc . : 1983 _ rep .",
    "_ @xmath56 * 46 , 973 * eichler , d. : 1984 @xmath56 * 277 , 429 * eichler , d. : 1985 @xmath56 * 294 , 40 * ellison , d.  c. : 1985 @xmath56 * 90 , 29 * ellison , d.  c. , baring , m.  g. and jones , f.  c. : 1995 @xmath56 * 453 , 873 * ellison , d.  c. , and eichler , d. : 1984 @xmath56 * 286 , 691 * ellison , d.  c. , and eichler , d. : 1985 @xmath56 * 55 , 2735 * ellison , d.  c. , giacalone , j. , burgess , d. , and schwartz , s.  j. : 1993 @xmath56 * 98 , 21,085 * ellison , d.  c. , jones , f.  c. , and reynolds , s.  p. : 1990 @xmath56 * 360 , 702 * ellison , d.  c. , mbius , e. , and paschmann , g. : 1990 @xmath56 * 352 , 376 * ellison , d.  c. , and reynolds , s.  p. : 1991 @xmath56 * 382 , 242 * forman , m.  a. , jokipii , j.  r. , and owens , a.  j. : 1974 @xmath56 * 192 , 535 * fulbright , m.  s. , and reynolds , s.  p. : 1990 @xmath56 * 357 , 591 * giacalone , j. , burgess , d. , and schwartz , s.  j. : 1992 , in _ study of the solar - terrestrial system , _ proc .",
    "26th eslab symposium , esa special publication .",
    "giacalone , j. , jokipii , j.  r. , and kta , j. : 1994 @xmath56 * 99 , 19351 * gloeckler , g. , geiss , j. , roelof , e.  c. , fisk , l.  a. , ipavich , f.  m. , ogilvie , k.  w. , lanzerotti , l.  j. , von steiger , r. , and wilken , b. : 1994 @xmath56 * 99 , 17,637 * hoppe , m.  m. , russell , c.  t. , frank , l.  a. , eastman , t.  e. and greenstadt , e.  w. : 1981 @xmath56 * 86 , 4471 * ipavich , f.  m. , gloeckler , g. , hamilton , d.  c. , kistler , l.  m. , and gosling , j.  t. : 1988 @xmath56 * 15 , 1153 * jokipii , j.  r. : 1987 @xmath56 * 313 , 842 * jokipii , j.  r. : 1992 @xmath56 * 393 , l41 * jokipii , j.  r. , and f.  c. jones , 1996 , , submitted .",
    "jokipii , j.  r. , kta , j. , and giacalone , j. : 1993 @xmath56 * 20 , 1759 * jones , f.  c. , and ellison , d.  c. : 1987 @xmath56 * 92 , 11,205 * jones , f.  c. , and ellison , d.  c. : 1991 @xmath56 * 58 , 259 * jones , t.  w. , and kang , h. : 1995 in _ proc .",
    "cosmic ray conf . , ( rome ) @xmath56 * 3 , 245 * kang , h. , and jones , t.  w. : 1995 @xmath56 * 447 , 944 * kirk , j.  g. and schneider , p. : 1987 @xmath56 * 315 , 425 * krymsky , g.  f. : 1977 _ dokl . akad .",
    "nauk sssr _",
    ", @xmath56 * 243 , 1306 * liewer , p.  c. , goldstein , b.  e. , and omidi , n. : 1993 @xmath56 * 98 , 15,211 * liewer , p.  c. , rath , s. , and goldstein , b.  e. : 1995 @xmath56 * 100 , 19,809 * malkov , m.  a. , and vlk , h.  j. : 1995 in _ proc .",
    ". cosmic ray conf .",
    "( rome ) , @xmath56 * 3 , 269 * ostrowski , m. : 1988 @xmath56 * 206 , 169 * ostrowski , m. : 1991 @xmath56 * 249 , 551 * peacock , j.  a. : 1981 @xmath56 * 196 , 135 * quest , k.  b. : 1988 @xmath56 * 93 , 9649 * takahara f. and terasawa , t. : 1991 in proc .",
    "icrr international symposium : _ astrophysical aspects of the most energetic cosmic rays _ , eds .",
    "nagano , m. , takahara , f. ( world scientific , singapore ) p.  291",
    "terasawa , t. : 1979 _ planet .",
    "space sci.@xmath56 * 27 , 193 * toptyghin , i.  n. : 1980 @xmath56 * 26 , 157 * vlk , h.  j. : 1984 , in _ high energy astrophysics , proc .",
    "19th rencontre de moriond , _ ed .",
    "tran than van ( gif - sur - yvette : editions frontires ) , p. 281 .",
    "_ _ _ _ _ _ _ _    winske , d. , omidi , n. , quest , k.  b. and thomas , v.  a. : 1990 @xmath56 * 95 , 18,821 * zachary , a. : 1987 _ resonant alfvn wave instabilities driven by streaming fast particles , _ ph.d .",
    "thesis , lawrence livermore national laboratory , university of california .",
    "zank , g.  p. , webb , g.  m. , and donohue , d.  j. : 1993 @xmath56 * 406 , 67 *"
  ],
  "abstract_text": [
    "<S> the solution of the non - linear diffusive shock acceleration problem , where the pressure of the non - thermal population is sufficient to modify the shock hydrodynamics , is widely recognized as a key to understanding particle acceleration in a variety of astrophysical environments . </S>",
    "<S> we have developed a monte carlo technique for self - consistently calculating the hydrodynamic structure of oblique , steady - state shocks , together with the first - order fermi acceleration process and associated non - thermal particle distributions . </S>",
    "<S> this is the first internally consistent treatment of modified shocks that includes cross - field diffusion of particles . </S>",
    "<S> our method overcomes the injection problem faced by analytic descriptions of shock acceleration , and the lack of adequate dynamic range and artificial suppression of cross - field diffusion faced by plasma simulations ; it currently provides the most broad and versatile description of collisionless shocks undergoing efficient particle acceleration . </S>",
    "<S> we present solutions for plasma quantities and particle distributions upstream and downstream of shocks , illustrating the strong differences observed between non - linear and test - particle cases . </S>",
    "<S> it is found that there are only marginal differences in the injection efficiency and resultant spectra for two extreme scattering modes , namely large - angle scattering and pitch - angle diffusion , for a wide range of shock parameters , i.e. , for non - perpendicular subluminal shocks with field obliquities less than or equal to and de hoffmann - teller frame speeds much less than the speed of light .    </S>",
    "<S> = cmr5 = cmbx5 = cmr7 = cmbx7 = cmr8 = cmmi8 = cmsy8 = cmbx8 = cmtt8 = cmti8 = cmsl8 = cmr6 = cmmi6 = cmsy6 = cmbx6 # 1@xmath0 # 1#2 </S>"
  ]
}