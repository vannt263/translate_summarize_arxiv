{
  "article_text": [
    "a central aim of systems biology is to develop computational models for simulation and analysis of complex biological systems .",
    "the scale of this challenge is well illustrated by two examples .",
    "firstly , the recent whole - cell model of the pathogenic bacterium _ mycoplasma genitalium _",
    "@xcite which the authors claim accounts for the dynamics over the cell cycle of every gene product . even for this relatively simple organism ,",
    "the model was developed in the form of many submodels describing different cellular processes such as transcription , translation and metabolism ; each submodel required a _",
    "different _ mathematical description and simulation approach , which were coupled together at simulation time .",
    "secondly the virtual physiological human project @xcite `` is a concerted effort to explain how each and every component in the body , from the scale of molecules up to organ systems and beyond , works as part of the integrated whole '' .    in both examples ,",
    "a key challenge is to devise modelling strategies and frameworks which not only handle complexity but also unite different aspects of cell biology , for example : cellular metabolism , signalling and electrophysiology .",
    "such systems involve diverse physicochemical domains such as biochemical , chemoelectric and chemomechanical .",
    "there is therefore a need for a modelling approach to large multi - domain systems . as discussed below , the bond graph modelling formalism",
    "has long been used to model multi - domain engineering systems ; and recently it has been applied to components of biochemical systems @xcite .",
    "the purpose of this paper is extend the modelling of biochemical _ components _ to the modelling of biochemical",
    "_ systems _ by developing a hierarchical bond graph representation of biochemical systems .",
    "as detailed in @xcite , thermodynamic aspects of chemical reactions have a long history in the physical chemistry literature .",
    "the roles of chemical potential and gibb s free energy in biochemical system analysis is described in the textbooks of : @xcite , @xcite and @xcite . indeed ,",
    "if a computational model of a biochemical system is to be securely founded in the underlying chemistry , it must fully comply with the fundamental principles of physical chemistry as , for example laid out by @xcite .    thermodynamic compliance for a set of rate equations has been considered in some detail by a number of authors @xcite allowing this theory to be applied over preexisting models and providing rules to examine new models and ensure that they are constructed to be compliant .",
    "however , when rules such as the haldane constraint are used to constrain a set of numerical parameter values , numerical errors may still destroy thermodynamical compliance .",
    "the bond graph approach to modelling dynamical systems is well established - a comprehensive account is given in the textbooks of @xcite , @xcite and @xcite and a tutorial introduction for control engineers is given by @xcite .",
    "it has been applied to chemical reaction networks by @xcite and to chemical reactions by @xcite , @xcite and @xcite .",
    "@xcite discuss `` osmosis as chemical reaction through a membrane '' , @xcite model cardiac muscle using the bond graph approach and @xcite discuss the application of bond graphs to biological system in general and muscle models in particular .",
    "as illustrated in this paper , the bond graph method provides an alternative approach to ensuring thermodynamic compliance : a biochemical reaction network built out of bond graph components _ automatically _ ensures thermodynamic compliance even if numerical values are not correct . in this sense ,",
    "the bond graph approach is _ robustly _ thermodynamically compliant ( rtc ) .",
    "conversely , the discipline imposed by bond graph modelling can alert the modeller to errors and inconsistencies that may otherwise have escaped attention .",
    "this is illustrated in this paper in the context of revising a well - established model of glycogenolysis @xcite .",
    "thermodynamics distinguishes between : _ open systems _ where energy and matter can cross the system boundary ; _ closed systems _ where energy , but not matter , can cross the system boundary ; and _ isolated systems _ where neither energy nor matter can cross the system boundary @xcite .",
    "living organisms and their subsystems are open as both matter and energy cross the boundaries , thus , mathematical models of living organisms and their subsystems should have explicit formulation as an open system . in the bond graph approach used for this paper ,",
    "open subsystem models explicitly contain _ ports _ through which matter and energy can flow .",
    "the need for a systems level approach has been termed `` understanding the parts in terms of the whole '' by @xcite and the need for mathematical methods to integrate the range of cellular processes has been emphasised by @xcite .",
    "building such system - level models from components is simplified if preexisting validated models can be _ reused _ and combined in new models .",
    "a number of standards have been established to distribute re - usable and consistent models of biochemical networks @xcite , including the mark - up languages sbml @xcite and cellml @xcite , and reporting guidelines such as the minimum information requested in the annotation of biochemical models ( miriam ) @xcite .",
    "a number of models described with sbml and cellml have been published , and many of these are stored within the biomodels database @xcite and the physiome repository @xcite .",
    "more recently developed , sed - ml @xcite now allows `` simulated experiments '' with sbml and cellml models to be described .",
    "however , despite the increasing availability of models written using standardised formats , it is still a difficult and complex task to combine such models within a larger system @xcite . in the context of a thermodynamically compliant reaction network",
    ", model reuse requires that interconnecting models with preexisting thermodynamical compliance produces a model where this property is inherited . as discussed in this paper , bond graph models for open systems contain energy ports which provide the required interconnections thus allowing the models to be combined to produce a higher - level model which is robustly thermodynamically compliant .",
    "this form of hierarchical modelling has been used in the bond graph context by @xcite and makes use of bond graph energy ports @xcite . as discussed in more detail by @xcite and later within this paper , the _ source sensor _ ( ) bond graph component , introduced by @xcite ,",
    "provides a convenient notation for such energy ports .",
    "because the system components are connected by energy ports , interactions between the components are two - way , thus the distinction between input and output is meaningless and a component s dynamic properties depend on those components which are connected to it .",
    "thus the analogy with _ active _ electronic components ( _ e.g. _ diodes and transistors ) designed to avoid such two - way interactions is not helpful here .",
    "rather , the analogy is with _ passive _ electronic components ( _ e.g. _ resistors and capacitors ) .",
    "@xcite also discuss how bond graph models are parameterised such that parameters relating to thermodynamic quantities are clearly demarcated from reaction kinetics . however , this alternative parameterisation leads to an important issue : the parameters required by the bond graph model are not the same as the parameters normally used to describe a biochemical reaction network . thus parameters must be converted from one form to another .",
    "this conversion is not trivial for two reasons : the given parameters must be checked for thermodynamic compliance for a solution to exist , and this solution is not necessarily unique .",
    "the problem is solved in this paper and illustrated using a specific example from the literature .",
    "complex systems may be difficult to comprehend theoretically , and the practical derivation of properties is often tedious .",
    "these issues can be overcome to some extent by providing general representations of , and general formulae relating to arbitrarily complex systems .",
    "the stoichiometric matrix approach @xcite is one such methodology ; another approach is provided by @xcite who investigate the mathematical structure of balanced chemical reaction networks governed by mass action kinetics and provide a powerful mathematical notation .",
    "this paper provides a general representation of an open biochemical reaction network described using bond graphs as well as general formulae based on the stoichiometric matrix @xcite approach and on the mathematical structure and notation of @xcite . as discussed by @xcite , the use of the bond graph concept of _ causality _ visually and intuitively ties the mathematical concepts of the stoichiometric matrix and its subspaces ( representing pathways and conserved moieties ) @xcite to the actual chemistry underlying the system as represented by the biochemical system bond graph .",
    "one purpose of this paper is to introduce systems biologists to the bond graph modelling approach . to this end ,",
    "a metabolic pathway model from the literature is re - implemented and reexamined from the bond graph point of view . in particular , @xcite consider `` a computational model for glycogenolysis in skeletal muscle '' and provide a detailed thermodynamically consistent model .",
    "this model has been further embellished by @xcite who also provide a detailed comparison with experimental data .",
    "* chapter 7 ) uses this model as an example for the simulation of complex biochemical cellular systems , and @xcite uses a similar model to examine the interaction of the akt pathway on metabolism .",
    "this paper uses the @xcite model as an exemplar of how the bond graph approach can be applied to build a hierarchical model which is rtc .",
    "the outline of the paper is as follows .",
    "  [ sec : closed - open - systems ] discusses the modelling of open thermodynamical systems using bond graphs and the bond graph notion of an _ energy port _ ;   [ sec : simple - exampl - extern ] introduces the topic using a simple example ,   [ sec : general - case ] gives the general case and   [ sec : energy - flow ] focuses on energy flows .",
    "conversion of kinetic data into the form required for bond graphs is considered in   [ sec : conv - kinet - data ] ; in particular [ sec : equil - const ] examines the relation between equilibrium constants and free - energy constants and gives a general formula .",
    "existence and uniqueness issues are discussed and an alternative derivation of the wegscheider conditions is given and ",
    "[ sec : enzyme - catal - react ] discusses the reformulation of enzyme - catalysed reactions . ",
    "[ sec : hier - modell ] develops a hierarchical bond graph model based on the well - established model of glycogenolysis by @xcite to illustrate the concepts developed in this paper , and ",
    "[ sec : conclusion ] concludes the paper with suggested directions for further work .",
    "a virtual reference environment @xcite is available for this paper at https://sourceforge.net / projects / hbgm/.    [ [ notation ] ] notation + + + + + + + +    following @xcite , we use the convenient notation @xmath0 to denote the vector whose @xmath1th element is the exponential of the @xmath1th element of @xmath2 and @xmath3 to denote the vector whose @xmath1th element is the natural logarithm of the @xmath1th element of @xmath2 . @xcite also use the element - wise multiplication operator `` @xmath4 '' ; here , for clarity , we use the equivalent hadamard or schur product with symbol `` @xmath5 '' .",
    "the hadamard or schur operator @xmath5 ( * ? ? ?",
    "7.3 ) corresponds to element - wise multiplication of two matrices which have the same dimensions .",
    "this is the same as the @xmath6 notation within matrix manipulation software .",
    "note that @xmath7 , where the notation `` @xmath8 '' is used for the matrix with elements of @xmath2 along the diagonal .",
    "this section discusses the modelling of open thermodynamic systems using bond graphs . in particular ,",
    "it is shown how an otherwise closed system becomes an open system by the addition of energy ports and the standard bond graph components that represent such ports are introduced .",
    "a simple motivational example is discussed in   [ sec : simple - exampl - extern ] and the general case is discussed in   [ sec : general - case ] .",
    "as described in @xcite , the reaction scheme :    3 a & b & b & c & c & a [ eq : abca_reac ]    has the bond graph representation given within the dashed box of figures [ subfig : abcao_abg ] and [ subfig : abcav_abg ] .",
    "this is a _ closed _ system with respect to the three species @xmath9 , @xmath10 and @xmath11 , thus the system equilibrium ( where the quantities of @xmath9 , @xmath10 and @xmath11 are constant ) corresponds to zero reaction flows .    in contrast , consider the reaction scheme :    3 a & b & b & c & c + f & a + r [ eq : abcao_reac ]    where the reactants @xmath12 and @xmath13 correspond to large external pools with effectively fixed concentrations @xmath14 and @xmath15 .",
    "this is represented in figure [ subfig : abcao_abg ] where two instances of the _ effort source _ and _ flow sensor _",
    "components , and , have been appended to the bond graph .",
    "each imposes a chemical potential ( effort in bond graph parlance ) upon the system and inherits the flow on the corresponding junction . with the sign convention shown ,",
    "energy flows into the system through and out of the system through .",
    "although there is a net flow of energy into the system , in this particular case there is no net flow of material .",
    "the two junctions are connected by an component thus the flows are equal .",
    "further details are given within @xcite as to how the mass - action kinetics of this closed system can be directly derived from the bond graph :    3 [ eq : intro : closed_x ] _ a & = v_3 - v_1 & _ b & = v_1 - v_2 & _ c & = v_2 - v_3    where : @xmath16 , @xmath17 and @xmath18 are the amounts of species @xmath9 , @xmath10 and @xmath11 in moles ; and @xmath19 , @xmath20 and @xmath21 are the molar flows associated with reactions 13 , given by :    3 [ eq : intro : closed_v ] v_1 & = _ 1 ( k_a x_a - k_b x_b ) & v_2 & = _ 2 ( k_b x_b - k_c x_c ) & v_3 & = _ 3 ( k_c x_c - k_a x_a )    these linear equations can be written in the notation of   [ sec : intro ] using the stoichiometric matrix @xmath22 :    3 [ eq : simple_open_v ] & = n v & v & = -(n^t k x ) & n & =    -1 & 0 & 1 + 1 & -1 & 0 + 0 & 1 & -1    with associated mass and flow vectors , and coefficient matrices :    4 [ eq : simple_open_v_cont ] x & =    x_a + x_b + x_c    & v & =    v_1 + v_2 + v_3    & & =    _ 1 + _ 2 + _ 3    & k & =    k_a + k_b + k_c    the open system given by the reaction scheme ( [ eq : abcao_reac ] ) and the bond graph of figure [ subfig : abcao_abg ] is given by equations ( [ eq : intro : closed_x ] ) but the equation for @xmath21 of equations ( [ eq : intro : closed_v ] ) is replaced by : @xmath23 the simple linear expression is also no longer applicable , but as discussed in   [ sec : general - case ] it can be replaced in general terms by :    3 [ eq : simple_open_v_1 ] _ i & = n_i v & v & = ( n^f^t k x - n^r^t k x ) & n_i & = n^r_i - n^f_i    and where    4 [ eq : n_simple ] x & =    x_a + x_b + x_c + x_f + x_r    & k & =    k_a + k_b + k_c + k_f + k_r    & n^f & =    n^f_i + n^f_e    & n^r & =    n^r_i + n^r_e    4[eq : simple_n ] n^f_i & =    1 & 0 & 0 + 0 & 1 & 0 + 0 & 0 & 1    & n^r_i & =    0 & 0 & 1 + 1 & 0 & 0 + 0 & 1 & 0    & n^f_e & =    0 & 0 & 1 + 0 & 0 & 0    & n^r_e & =    0 & 0 & 0 + 0 & 0 & 1    a simulation of this simple example is shown in figure [ fig : sim_abcao ] in order to emphasise the main distinctions between open and closed systems .",
    "figure [ subfig : open_abg ] is a generalisation of figures [ subfig : abcao_abg ] and [ subfig : abcav_abg ] , giving a schematic representation of the structure for an open system . with reference to figure [ subfig : open_abg ] ,",
    "the five @xmath24 components represent the five flow transformations :    5 [ eq : gentf ] v^f_i & = n^f_i v & v^r_i & = n^r_i v & v^f_e & = n^f_e v & v^r_e & = n^r_e v & v^r_e & = n_e v_e    and thus the five matrices @xmath25 , @xmath26 , @xmath27 , @xmath28 & @xmath29 define the stoichiometry of the chemical network .    as emphasised by @xcite - bonds , components and junctions all transport , but do not create or destroy , chemical energy .",
    "it follows from this that :    4 [ eq : conserve ] v^t a^f_i & = v^f_i^t _ i & v^t a^r_i & = v^r_i^t _ i & v^t a^f_e & = v^f_e^t _ e & v^t a^r_e & = v^r_e^t _ e    using equations , equations become :    4 [ eq : conserve_2 ] v^t a^f_i & = v^tn^f_i^t _ i & v^t a^r_i & = v^tn^r_i^t _",
    "i & v^t a^f_e & = v^tn^f_e^t _ e & v^t a^r_e & = v^tn^r_e^t _ e    as the equations must be true for all @xmath30 , it follows that the affinities @xmath9 can be expressed in terms of chemical potential @xmath31 as :    5 [ eq : affinities ] a^f_i & = n^f_i^t _ i & a^r_i & = n^r_i^t _ i & a^f_e & = n^f_e^t _ e & a^r_e & = n^r_e^t _ e & _ e & = n_e^t _ i    the fact that energy conservation implies equation is discussed by @xcite .    with the notation given in ",
    "[ sec : intro ] , the _ marcelin _ formula for reaction flows ( used by ( * ? ? ?",
    "( 2.6 ) ) for the scalar case ) may be written as :    3 [ eq : marcelin ] v & = ( v_0^+ - v_0 ^ - ) + n_e v_e & v_0^+ & = & v_0 ^ - & =    similarly , the formula for chemical potential @xmath31 of ( * ? ? ?",
    "( 2.3 ) ) in terms of the vector @xmath32 of _ free - energy constants _ is given by :    2[eq : mu ] _ i & = rt k_i x_i & k_i & =    where @xmath33 is the vector of standard chemical potentials for the internal species .",
    "it is also convenient to re - express the external chemical potentials @xmath34 as @xmath35 . combining equations   , the reaction flows @xmath36 are given by :    3 [ eq : open_v ] v & = ( v^+_0 - v^-_0 ) + v^e & v^+_0 & = n^f^t k x & v^-_0 & = n^r^t k x    where the composite stoichiometric matrices @xmath37 and @xmath38 , the composite state @xmath2 and the vector of free - energy constants @xmath39 are given by :    4[eq : composite ] n^f & =    n_i^f + n_e^f    & n^r & =    n_i^r + n_e^r    & x & =    x + x_e    & k & =    k_i + k_e    in the context of the simple example shown in figure [ subfig : abcao_abg ] it can be verified that substituting the stoichiometric matrices of equation into equation leads to equations and .",
    "equation expresses the forward and reverse reaction flows @xmath40 and @xmath41 in terms of _ species _ : amounts @xmath2 and free - energy constants @xmath39 .",
    "it is helpful to reexpress @xmath40 and @xmath41 in terms of quantities related to _",
    "reactions_. in particular :    3 v^+_0 & = k^f x^f & k^f & = n^f^t k & x^f & = n^f^t x [ eq : kfxf ] + v^-_0 & = k^r x^r & k^r & = n^r^t k & x^r & = n^r^t x [ eq : krxr ]    in the context of the simple example of figure [ subfig : abcao_abg ]    2 [ eq : simple_n_fr ] n^f^t & =    1 & 0 & 0 & 0 & 0 + 0 & 1 & 0 & 0 & 0 + 0 & 0 & 1 & 1 & 0    & n^r^t & =    0 & 1 & 0 & 0 & 0 + 0 & 0 & 1 & 0 & 0 + 1 & 0 & 0 & 0 & 1    hence    4 k^f & =    k_a + k_b + k_ck_f    & k^r & =    k_b + k_c + k_ak_r    & x^f & =    x_a + x_b + x_cx_f    & x^r & =    x_b + x_c + x_ax_r      with reference to figure [ subfig : open_abg ] : the bonds ( @xmath42 ) and transformers ( @xmath24 ) transmit , but do not create or destroy , chemical energy ; the @xmath43 components store , but do not create or destroy , chemical energy ; the reactions ( @xmath44 ) dissipate , but do not store , chemical energy ; and the ports ( @xmath45 ) transmit chemical energy in and out of the system .",
    "the energy dissipated within the components represented by @xmath44 is :    2 [ eq : p_re_0 ] p_r & = _ j=1^n_v ( v_j a^f_j - v_j a^r_j ) = v^t a & a & = a^f - a^r    using equations , the affinity @xmath46 can be rewritten as : @xmath47 similarly and @xmath48 and @xmath9 can be rewritten as :    2 [ eq : affinity ] a_e & = -n_e^t _ e = -n_e^t rt_e x_e & a & = -n^t = -n^t rtx    hence naming the external energy flow into the system as @xmath49 and the energy flow into the components as @xmath50 it follows that : @xmath51 these three equations imply energy conservation : @xmath52 figure [ fig : energy ] is based on data corresponding to the simulations of figure [ fig : sim_abcao ] and illustrates these equations for both closed ( no external energy source ) and open systems .",
    "for the bond graph formulation of this paper to be widely applicable , it is necessary to develop a framework for converting kinetic data from the conventional form used with enzyme modelling into the parameters required by the bond graph formulation . as an example of the issues involved",
    ", the reaction @xmath53 { } \\ ; } } } } b$ ] has a single equilibrium constant @xmath54 , whereas the bond graph formulation uses the two thermodynamic constants @xmath55 and @xmath56 . in this case ,",
    "@xmath57 , thus it follows that deriving @xmath55 and @xmath56 from @xmath54 does not have a _",
    "unique _ solution .",
    "similarly , the reaction @xmath53 { } \\ ; } } } } b {    {    {    { \\ ; \\xrightleftharpoons [ ] { } \\ ; } } } } c {    {    {    { \\ ; \\xrightleftharpoons [ ] { } \\ ; } } } } a$ ] of equation has three equilibrium constants . in this case , the solution for @xmath55 , @xmath56 and @xmath58 does not _ exist _ unless the product of the three equilibrium constants is unity ( detailed balance ) . in ",
    "[ sec : equil - const ] a derivation of the formulae that convert equilibrium constants to thermodynamic constants for arbitrary networks of reactions is shown .",
    "the solution fully accounts for the potential of such existence and uniqueness issues .",
    "enzyme - catalysed reactions are commonly represented using michaelis - menten kinetics @xcite .",
    "it should be noted that when a reaction is assumed to be irreversible , the associated michaelis - menten kinetics fail to satisfy thermodynamical compliance .",
    "for this reason , michaelis - menten like kinetics which are thermodynamically compliant have been developed @xcite .",
    "section [ sec : conv - kinet - data][sec : enzyme - catal - react ] focuses on the enzyme - catalysed reaction formulation of ( * ? ? ?",
    "* ( a ) ) and compares it to previously developed methods .    in the supplementary material , this model",
    "is shown to be the same as the as the _ direct binding modular _ rate law of @xcite in  [ app : conv - kinet - data][sec : relat - direct - bind ] , compared with the _ common modular _ rate law of @xcite in  [ app : conv - kinet - data][sec : relat - comm - modul ] and compared with the the computational model of @xcite in  [ app : conv - kinet - data][sec : relat - comp - model ] . as well as the equilibrium constant , mass - action reaction kinetics also require a rate constant . the corresponding conversion to bond graph form is discussed in  [ app : conv - kinet - data][app : mass - acti - react ] of the supplementary material .      with the notation given in ",
    "[ sec : intro ] , the scalar de donder formula ( * ? ? ?",
    "* equation(11 ) ) for the ratio @xmath59 of the forward @xmath60 and backward @xmath61 reaction rates of equation can be written in vector form as :    2 _ 0 & = & _ 0 & = [ eq : dedonder ]    where @xmath62 in a similar fashion to & and using equation , equation can be written as :    3 _ 0 & = k^v x^v & k^v & = ( -n^t k ) & x^v & = ( -n^t x ) [ eq : kvxv ]    substituting equation into equation gives the alternative expression for the affinity @xmath9 : @xmath63    in the context of the simple example of figure [ subfig : abcao_abg ] :    3 -n^t & =    1 & -1 & 0 & 0 & 0 + 0 & 1 & -1 & 0 & 0 + -1 & 0 & 1 & 1 & -1    & k^v & =     +   +    & x^v & =     +   +    as discussed by ( * ? ? ?",
    "* eq 1.15 ) , the equilibrium constant of a reaction is given by @xmath64 .",
    "combining all reactions , the vector @xmath65 of equilibrium constants is thus : @xmath66 where the subscript @xmath67 indicates the reference state where @xmath2 is unity .",
    "hence , substituting unit @xmath2 into equation , equation becomes : @xmath68 equilibrium corresponds to @xmath69 or @xmath70 hence , using equation , equilibrium also corresponds to :    2 [ eq : equilibrium ] x^v & = x^eq & k^eq x^eq = 1_n_v1    equation gives an explicit expression for the vector @xmath65 , containing @xmath71 reaction equilibrium constants , in terms of the vector @xmath39 which contains the free energy constants of @xmath72 species .",
    "however , the transposed stoichiometric matrix @xmath73 is not normally full rank , and so it is _ not _ possible to directly use equation to give @xmath39 in terms of @xmath65 .",
    "but , as is now demonstrated , the left and right null space matrices ( as used to detect conserved moieties and flux pathways @xcite ) lead to the solutions ( if any ) of equation giving @xmath39 in terms of @xmath65 .    the @xmath74 right null - space matrix @xmath13 of @xmath22 has the property that :    2 nr & = 0 & r^t n^t & = 0 [ eq : rn ]    this matrix is used in stoichiometric analysis to analyse metabolic pathways @xcite . here",
    ", it is reused to examine thermodynamic constraints .",
    "multiplying equation by @xmath75 gives : @xmath76 equation defines a thermodynamic constraint on the equilibrium constants , and is a form of _ wegscheider condition _ @xcite .",
    "assuming that the constraint holds , the moore - penrose generalised inverse @xcite @xmath77 of @xmath78 can be used to find a solution for @xmath39 . in particular :    2 k_0 & = n^k^eq & k_0 & = ( n^k^eq ) [ eq : kc0 ]    in general , the solution of equation , @xmath79 , is not the only value of @xmath39 satisfying equation .",
    "the @xmath80 left null - space matrix @xmath81 ( as used to detect conserved moieties @xcite ) has the property that :    2 gn & = 0 & n^t g^t & = 0 [ eq : gn ]    hence a family of solutions of equation is given by : @xmath82 where @xmath83 is an arbitrary @xmath84 vector .",
    "equation can be rewritten as : @xmath85    finally , we show that the affinity @xmath9 is also unaffected by the choice of @xmath83 . from equations and  it follows that : @xmath86 using & , @xmath87 .",
    "hence @xmath9 is unaffected by the choice of @xmath83 .",
    "it follows that the energy - based analysis of   [ sec : energy - flow ] is also unaffected by the choice of @xmath83 .",
    "[ [ example ] ] example + + + + + + +    the closed system embedded in figure [ subfig : abcao_abg ] has stoichiometric matrix @xmath22 , and left and right null space matrices @xmath81 and @xmath13 given by :    3 [ eq : example_ngr ] n & = n_i =    -1 & 0 & 1 + 1 & -1 & 0 + 0 & 1 & -1    & g & =    1&1&1    & r & =    1 + 1 + 1    with this value of @xmath13 , equation implies that :    2 [ eq : c_example_constraint ] k^eq_1 + k^eq_2 + k^eq_1 & = 0 & k^eq_1k^eq_3k^eq_3 & = 1    this is the standard `` detailed balance '' result applied to a three - reaction loop @xcite .    taking the example further ,",
    "suppose @xmath88 ( which satisfies equation ) . then using the gnu octave implementation ` pinv ` to calculate the pseudo inverse for equation gives @xmath89 . noting that @xmath90",
    ", @xmath91 is a scalar and may be chosen as @xmath92 leading to @xmath93 .",
    "in contrast , the open system of figure [ subfig : abcao_abg ] has stoichiometric matrix @xmath22 , and left and right null space matrices @xmath81 and @xmath13 are given by    3 [ eq : example_ngr_open ] n & =    -1 & 0 & 1 + 1 & -1 & 0 + 0 & 1 & -1 + 0 & 0 & -1 + 0 & 0 & 1 +    & g & =    1&1&1&0&0 + 0&0&0&1&1    & r & = 0    because @xmath94 , the constraint holds for any choice of the three elements of @xmath65 .",
    "for example , suppose @xmath95 , then using the gnu octave implementation ` pinv ` for the pseudo inverse , equation gives @xmath96 .",
    "noting that @xmath97 , @xmath91 has two elements and may be chosen , for example , as @xmath98 leading to @xmath99 .",
    "the kinetics of enzyme catalysed reactions are usually described by versions of the michaelis - menten equations ; see , for example , @xcite or @xcite .",
    "the key issue is that the equations should be thermodynamically compliant @xcite .",
    "* ( a ) ) give one possible formulation of the kinetics for enzyme catalysed reactions that is guaranteed to be thermodynamically compliant :    2 v & = | _ v & _ v = [ eq : v_gc ]    where @xmath60 and @xmath61 are given by equation , @xmath100 is the total enzyme concentration , and @xmath101 and @xmath102 are reaction constants for the reactions relating substrate to complex and complex to product respectively .",
    "@xmath103 is a constant related to the enzyme / complex equilibrium .",
    "as is now shown this formulation can be rewritten as a reversible michaelis - menten equation . defining : @xmath104 with reference to equation , define : @xmath105 then equation can be rewritten as : @xmath106 combining equations and : @xmath107    [ [ remarks ] ] remarks + + + + + + +    1 .",
    "equation explicitly shows that this particular form of the reversible michaelis - menten equation has three parameters : @xmath108 , @xmath109 and @xmath110 .",
    "when @xmath111 , equation becomes the irreversible michaelis - menten equation but with the addition of the @xmath61 term to give reversibility .",
    "3 .   using equation , the two parameters @xmath108 and @xmath110 can be computed from @xmath112 and @xmath113 as : @xmath114 4 .   using equation ,",
    "the third parameter @xmath103 can be computed from : @xmath115 5 .",
    "note that the haldane equation @xmath116 is automatically satisfied by equation .",
    "6 .   in the limit as @xmath117",
    ", equation becomes the mass - action flow ( * ? ? ?",
    "* equation ( 2.6 ) ): @xmath118",
    ", inorganic phosphate ; g1p , glucose-1-phosphate ; g6p , glucose-6-phosphate ; f6p , fructose-6-phosphate ; atp , adenosine triphosphate ; adp , adenosine diphosphate ; fbp , fructose-1,6-biphosphate ; dhap , dihydroxyacetone phosphate ; gap , glyceraldehyde 3-phosphate ; nad , oxidised nicotinamide adenine dinucleotide ; nadh , reduced nad ; 13bpg , 1,3-bisphosphoglycerate ; 3pg , 3-phosphoglycerate ; 2pg , 2-phosphoglycerate ; pep , phosphoenolpyruvic acid ; pyr , pyruvate ; lac , lactate ; pcr , phosphocreatine ; cr , creatine ; amp , adenosine monophosphate . enzyme commission ( ec ) numbers are shown.,title=\"fig : \" ]    the bond graph representation for open systems detailed in  [ sec : closed - open - systems ] figure [ fig : closed - open - systems ] , with the @xmath45 ports to connect systems , provides a basis to construct hierarchical models of biochemical systems that are robustly thermodynamically compliant .",
    "this approach is illustrated using a well - established model from the literature : `` a computational model for glycogenolysis in skeletal muscle '' presented by @xcite .",
    "although the model has been further embellished by @xcite and used as an example in the book of @xcite , we use information and parameters from the original model as a basis for the discussion in this paper .",
    "figure [ fig : lamkus02 ] shows the simplified glycolysis pathway from ( * ? ? ? * figure 1 ) using systems biology graphical notation ( sbgn ) @xcite .",
    "there are many ways to subdivide this system to create a hierarchical model . here , we have chosen to divide the system into three conceptual modules :    1 .   the primary glycolytic reaction chain leading from glycogen ( @xmath119 ) to lactate ( @xmath120 ) which converts adenosine diphosphate ( @xmath121 ) and inorganic phosphate ( @xmath122 ) into adenosine triphosphate ( @xmath123 ) making use of the energy stored in glycogen .",
    "this module is a _",
    "producer _ of atp .",
    "2 .   the pair of reactions catalysed by creatine kinase @xmath124 and adenylate kinase @xmath125 involving creatine ( @xmath126 ) , phosphocreatine ( @xmath127 ) and adenosine monophosphate ( @xmath128 ) as well as @xmath123 and @xmath121 . this module is a _ buffer _ of atp .",
    "the reactions catalysed by numerous atpases ( @xmath129 ; for a more comprehensive description see @xcite ) which convert @xmath123 into @xmath121 and @xmath122 , and use the released energy to perform work .",
    "this module is a _",
    "consumer _ of atp .",
    "figure [ fig : bg ] gives a bond graph representation of this top - level decomposition where the three modules are represented by the compound bond graph components labelled * gly2lac * , * cramp * and the simple reaction bond graph component * re : atpase*. the metabolites @xmath123 , @xmath121 and @xmath122 flow between these three modules as illustrated , forming the overall system model * * lamkus02 * * ) with only two impinging bonds could be deleted .",
    "they are often left in place for clarity or to make further connections if the model is further refined . ] .",
    "the module * gly2lac * is the most complex of figure [ fig : bg ] , and for this reason it is itself hierarchically decomposed in to three further modules ( figure [ subfig : gly2lac_abg ] ) , represented by the compound bond graph components : * gly2fbp * , * fbp2gap * and * gap2lac*. bond graph representations for these reactions and species are given in figure [ fig : bg ] .",
    "the additional component * ss : glyo * is discussed in   [ sec : modelling - issues ] .",
    "the module corresponding to * cramp * is simpler and is shown using the bond graph representation of reactions and species in the supplementary material , figure [ fig : cramp ] .      1 .",
    "the allosteric modulation of reactions @xmath130 and @xmath131 by * amp * is ignored .",
    "the reaction kinetics are represented by equation . as discussed in  [ app : conv - kinet - data ] , the kinetics presented by @xcite are essentially the common modular rate law of @xcite and , as mentioned in   [ sec : enzyme - catal - react ] , equation is essentially the direct binding modular rate law of @xcite , our kinetics differ except for first - order reactions .    neither assumption conflicts with our aim of illustrating the creation of robustly thermodynamically compliant model .",
    "as discussed in   [ sec : conclusion ] , future work will look at the more complicated case .",
    "the bond graph approach to modelling imposes discipline on the modelling process and thus exposes errors and inconsistencies that may otherwise have escaped attention .",
    "the process of revising the well - established model of @xcite , and its reuse by other authors illustrate this process .",
    "in particular , four issues were encountered during the development of these bond graph models and deserve special attention : the parallel reactions @xmath132 and @xmath133 forming the overall @xmath130 reaction ; the modelling of the conversion of glycogen @xmath119 to glucose-1-p @xmath134 ; the reaction catalysed by @xmath129 ; and reaction directionality .      the parallel reactions @xmath132 and @xmath133 are represented in bond graph terms in figure [ subfig : gp_abg ] .",
    "applying the analysis of  [ sec : conv - kinet - data ]  [ sec : equil - const ] to the @xmath135 stoichiometric matrix @xmath22 corresponding the entire network gives a @xmath136 right null - space matrix @xmath13 with an entry of @xmath137 corresponding to @xmath132 and @xmath138 corresponding to @xmath133 .",
    "thus the condition @xmath139 of equation gives :      equation must be satisfied for thermodynamical compliance , corresponding to the notion that these alternative forms of the enzyme are catalysing the same chemical reaction .",
    "in fact , ( * ? ? ?",
    "* table 1 ) have @xmath140 such that condition is satisfied and it is therefore possible to convert equilibrium constants of this model to the free - energy constants required for bond graph modelling .",
    "it should be noted , however , that in its original form the model is _ not _ robustly thermodynamically compliant : if equality was violated due to computing or human error , the compliance would not be enforced . in this context , it is interesting to note that such an error exists in the published literature , with the paper of @xcite re - using the model of @xcite . in particular , although on p. 17",
    "@xcite correctly use @xmath141 , the value on p. 18",
    "incorrectly gives @xmath142 thus their model is not thermodynamically compliant .",
    "a glance at ( * ? ? ?",
    "* table 1 ) reveals that @xcite have inadvertently copied the equilibrium constant for phosphoglucomutase instead of that for glycogen phosphorylase b. in contrast , a model expressed in bond graph form could have incorrect parameters ; but it would still be thermodynamically compliant .",
    "this is the advantage of _ robust _ thermodynamical compliance .",
    "[ [ the - conversion - of - glycogen - gly - to - glucose-1-p - g1p ] ] the conversion of glycogen ( @xmath119 ) to glucose-1-p ( @xmath134 ) + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    @xcite discuss `` uncertainty in the kinetic function and substrate concentration describing the glycogen phosphorylase reaction '' and embed a simplified model of the reaction within the overall model .",
    "however ( as they explicitly state ) the resulting model is stoichiometrically and thermodynamically inconsistent .",
    "figure [ fig : lamkus02 ] , and the underlying figure 1 of @xcite imply a reaction : @xmath143 { } \\ ; } } } } g1p\\ ] ] and this is consistent with their equation ( p. 821 ) for the rate of change of @xmath119 : @xmath144 .",
    "however , their equation ( p. 822 ) for @xmath145 implies the reaction : @xmath146 { } \\ ; } } } } gly + g1p\\ ] ] as they explain , this arises by equating two versions of the glycogen molecule which differ in length by the presence of a single monomer : @xmath147 and @xmath148 .",
    "biologically , this reflects the large , polymeric nature of glycogen such that a monomer / subunit can be cleaved with little discernible effect .",
    "it is explicitly stated as an assumption by @xcite that @xmath147/@xmath148 is unity . unlike reaction",
    ", reaction implies a zero rate of change of @xmath119 : @xmath149 .    using the bond graph",
    "approach it is not possible to simultaneously implement the rate change of @xmath119 corresponding to reaction with the reaction flux implied by . in short , this is because the stoichiometric matrix associated with reactions and are different and thus the assumption of  [ sec : closed - open - systems ]  [ sec : general - case ] that bonds and junctions transmit , but do not create or destroy , chemical energy would be violated .",
    "conceptually , this is equivalent to mass creation , as glycogen is cleaved by glycogen phosphorylase but does not change . in practice",
    "the effects would be limited over short simulation times , but with a longer term goal of building reusable modular models , it will ultimately lead to models lacking thermodynamic compliance .",
    "this issue is addressed by introducing the external substance @xmath150 , representing the difference between @xmath147 and @xmath148 , into the @xmath130 catalysed reactions and of @xcite using the bond graph component * ss : glyo * ( figure [ subfig : gly2fbp_abg ] ) : @xmath151 { } \\ ; } } } } gly + g1p\\ ] ] using the notation of @xcite ; reaction implies that @xmath152 and @xmath149 , thus combining the two incompatible expressions for @xmath153 in a stoichiometrically and thermodynamically consistent way .",
    "this illustrates how the bond graph methodology forces the modeller to tackle such issues by not allowing a stoichiometrically and thermodynamically inconsistent model to be constructed .",
    "thus this revision replaces a thermodynamically inconsistent submodel by a thermodynamically consistent , and therefore physically plausible , submodel .",
    "this physically plausible submodel acts as a placeholder until a more complex chemically - correct submodel can be devised .",
    "this illustrates the role of the bond graph framework to allow incremental refinement of individual submodels within a hierarchical system .",
    "@xcite state that `` the model design features stoichiometric constraints , mass balance , and fully reversible thermodynamics as defined by the haldane relation . ''",
    "however they do break this feature by choosing the reaction catalysed by @xmath129 to be irreversible . unlike @xcite , the reaction catalysed by @xmath129 ( represented by * re : atpase * in figure [ fig : bg ] )",
    "is _ reversible _ and corresponds to : @xmath154 { } \\ ; } } } } adp+p\\ ] ] thus the model in this paper is fully thermodynamically reversible and a closed system .",
    "of course this reaction is , for practical purposes , one way .",
    "but , to follow the systematic bond graph modelling procedure , this fact should be reflected by the choice of reaction parameters rather than by violating thermodynamic principles .",
    "this point is discussed in detail by @xcite who state that `` our view is that it is always best to use reversible equations in metabolic simulations for all processes apart from exit fluxes ... '' .",
    "however , as will be discussed in ",
    "[ sec : sim ] , this closed system may be converted into an open system by injecting external flows of : @xmath155 , @xmath156 and @xmath120 in such a way as to make the concentrations of these three substances constant . the simulation is also arranged such that that flows can be optionally disconnected to examine system connectivity .",
    "this is used in  [ sec : hier - modell][sec : sim ] to disconnect the reactions @xmath157 and @xmath129 as appropriate .",
    "the @xmath158 reaction within @xcite provides an interesting example about definitions of reaction `` direction '' , which must be specified within an associated model description . on page 823 , @xcite say that `` the forward direction of @xmath158 is defined as producing dihydroxyacetone phosphate '' .",
    "this is why the directions of the bonds impinging on * re : tpi * in figure [ subfig : fbp2gap_abg ] are in the directions shown .",
    "@xcite also state that the equilibrium constant for @xmath158 is @xmath159 .",
    "however , this is inconsistent with the stated directionality and should be replaced by the reciprocal value ( see supplementary material ,   [ app : tpi ] for more details ) .",
    "the discipline imposed by the bond graph model avoids ambiguity with regard to reaction direction .",
    ".conserved moieties .",
    "the left null matrix of the stoichiometric matrix for this system reveals six conserved moieties .",
    "the simulation takes account of these using equation in ",
    "[ app : reduc - order - equat ] .",
    "[ cols= \" < , < \" , ]     using the methods of ",
    "[ sec : equil - const ] , the equilibrium constants quoted by ( * ? ? ?",
    "* tables 1&2 ) ( table [ tab : lamkus02-par ] ) were converted into the free - energy constants required by the bond graph formulation and are listed in table [ tab : species_par ] .    using the methods of ",
    "[ sec : enzyme - catal - react ] , the reaction constants quoted by @xcite ( table [ tab : lamkus02-par ] ) were converted into the reaction constants required by the bond graph formulation of   [ sec : enzyme - catal - react ] and are listed in table [ tab : reaction_par ] .",
    "section [ app : mass - acti - react ] looks at mass - action reactions as used for @xmath129 , ",
    "[ sec : relat - direct - bind ] looks at the relationship of the approach in   [ sec : enzyme - catal - react ] to the direct - binding modular rate law of @xcite ,   [ sec : relat - comm - modul ] to the common modular rate law of @xcite and   [ sec : relat - comp - model ] to the computational model of @xcite .",
    "the mass - action formulation of chemical equations reveals key issues encountered in converting kinetic data from enzymatic models into the form required by a bond graph model .",
    "enzyme catalysed reactions are discussed in   [ sec : enzyme - catal - react ] .",
    "it is now shown using an example that equation is of the same form as the _ direct binding modular _ rate law of @xcite .",
    "consider the enzyme catalysed reaction @xmath166 { } \\ ; } } } } 2c$ ] in this case : @xmath167 equation is of the form : @xmath168 the _ direct binding modular _ rate law is given by equation ( 4 ) of @xcite and in the notation of this paper is : @xmath169 equations and are identical if we set :        however , equation is not the same as the _ common modular _ rate law of @xcite . in the context of the reaction @xmath160 { } \\ ; } } } } 2c$ ] , the _ common modular _ rate law of @xcite is of the form : @xmath170 as discussed by @xcite , the additional denominator terms imply that equation is not the same as equation but can be considered an approximation to it .",
    "however , in the case of reaction @xmath53 { } \\ ; } } } } b$ ] , the common modular and direct binding modular reaction rates are identical .",
    "the general enzyme catalysed reaction between two species is given by @xmath53 { } \\ ; } } } } b$ ] and the corresponding rate is written by @xcite as : @xmath171 in this case @xmath172 and @xmath173 hence equation becomes : @xmath174 comparing equations and and using equation it follows that they are identical if : @xmath175 or : @xmath176 having deduced @xmath110 from the given data using equation , @xmath103 can then be deduced from @xmath177 using @xmath55 , as shown in   [ sec : equil - const ] .",
    "the equilibrium constant is given as @xmath181 .",
    "however this gives the wrong value of @xmath182 .",
    "because the reaction is specified in the `` wrong '' direction , it is assumed that @xmath54 should be the reciprocal of the given value , ie @xmath183 .",
    "@xcite quotes @xmath184 ; so this alteration seems to be correct .",
    "figure [ subfig : lamkus02 - 0_cm ] provides another validity check , showing that the conserved moieties are constant ; because the reduced order equations (   [ app : reduc - order - equat ] ) were used , this constraint is automatically enforced and thus numerical drift is avoided .",
    "figure [ subfig : lamkus02 - 0_foutatpase ] shows mass flows within the system .",
    "figure [ subfig : lamkus02 - 4_x ] shows the evolution of simulated concentrations for @xmath123 , @xmath121 , @xmath122 , @xmath119 and @xmath120 which reach new steady state values due to flows induced by the @xmath129 reaction . as with figure [ subfig : lamkus02 - 0_cm ] , figure [ subfig : lamkus02 - 4_cm ] shows the conserved moieties are constant for the open system .",
    "in contrast to figure [ subfig : lamkus02 - 0_foutatpase ] , figure [ subfig : lamkus02 - 4_foutatpase ] shows mass flow which , in this open - system context settle to non - zero values .",
    "the software required to generate all of the simulation figures shown in this paper from the bond graph representation is packaged in the form of a _ virtual reference environment _ @xcite .",
    "it is available at https://sourceforge.net / projects / hbgm/."
  ],
  "abstract_text": [
    "<S> the bond graph approach to modelling biochemical networks is extended to allow hierarchical construction of complex models from simpler components . </S>",
    "<S> this is made possible by representing the simpler components as thermodynamically open systems exchanging mass and energy via ports . </S>",
    "<S> a key feature of this approach is that the resultant models are _ robustly _ thermodynamically compliant : the thermodynamic compliance is _ not _ dependent on precise numerical values of parameters . </S>",
    "<S> moreover , the models are _ reusable _ due to the well - defined interface provided by the energy ports .    to extract bond graph model parameters from parameters found in the literature , general and compact formulae are developed to relate free - energy constants and equilibrium constants . </S>",
    "<S> the existence and uniqueness of solutions is considered in terms of fundamental properties of stoichiometric matrices .    </S>",
    "<S> the approach is illustrated by building a hierarchical bond graph model of glycogenolysis in skeletal muscle . </S>"
  ]
}