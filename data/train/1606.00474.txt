{
  "article_text": [
    "among the technologies for biometric identification and verification , face recognition has become a widely - used method , as it is a non - intrusive and reliable method .",
    "however , the robustness of a facial recognition system is constrained by the degree of head pose that is involved and the recognition rates of state of the art systems drop significantly for large pose angles . especially for tasks where a great variation in head pose has to be expected , like in human - robot interaction , pose - invariant face recognition is crucial .",
    "the rise of collaborative and assistive robots in industrial and home environments will increase the demand for algorithms that can adapt to changing settings and uncontrolled conditions .",
    "a humanoid robot s cognitive ability to interpret non - verbal communication during conversations relies also heavily on the face of the human counterpart .",
    "the impact of head pose on the face analysis performance can be minimised by using normalisation techniques that transform non - frontal faces into frontal representations .",
    "this type of image pre - processing can loosely be classified into two categories :    * 2d methods ( cylindrical warping , aam ( active appearance models )  @xcite , 2d warping  @xcite ) * 3d methods ( 3dmm , gem ( generic elastic models )  @xcite ,",
    "mean face shape  @xcite )    as the 2d methods are trained on 2d data , the warping will only be an approximation of the underlying 3d rotation .",
    "they also do not model imaging parameters like the pose of the face and illumination , and face parameters like expressions , explicitly . instead , these parameters are inherent and implicitly encoded in the model parameters .",
    "when dealing with larger pose ranges than around @xmath040@xmath1 in yaw angle , a single 2d model is often no longer sufficient and a multi - model approach must be used ( e.g. @xcite , @xcite ) .",
    "the use of a 3d face model has several advantages , especially when further analysis involving the shape of the face is required , like in emotion detection . to correct the pose for face recognition ,",
    "a 3d representation of the face can be rotated easily into a frontal view . at close ranges ,",
    "the use of a 3d or rgb - d sensor can provide the additional depth information for the model .",
    "however , since the error of depth measurements increases quadratically with increasing distance when using rgb - d sensors like microsoft kinect  @xcite , they are not suitable for acquiring image data from a distance . on the other hand ,",
    "2d cameras are more widely - used in existing platforms and cost - efficient , so that a method combining the advantages of 2d image acquisition and the analysis with a 3d model is needed .    the 3d morphable model ( 3dmm )",
    "@xcite satifies this need by providing a parameterised principal component analysis ( pca ) model for shape and albedo , which can be used for the synthesis of 3d faces from 2d images . a morphable model can be used to reconstruct a 3d representation from a 2d image through fitting .",
    "fitting is the process of adapting the 3d morphable model in such a way that the difference to a 2d input image is as small as possible .",
    "depending on the implementation , the fitter s cost function uses different model parameters to iteratively minimise the difference between the modeled image and the original input image .",
    "existing fitting algorithms solve a complex cost function , using the image information to perform shape from shading , edge detection , and solve for both shape and texture coefficients ( @xcite ) . due to the complexity of the cost functions , these algorithms require several minutes to fit a single image . while the execution time may not be crucial for offline applications , real - time robotics applications require faster solutions .",
    "more recently , new methods were introduced that use local features @xcite or geometric features ( landmarks , edges ) with a fitting algorithm similar to the iterative closest point algorithm @xcite .    in this paper",
    ", we present and evaluate a complete , fully automatic face modelling framework consisting of landmark detection , landmark - based 3d morphable model fitting , and pose - normalisation for face recognition purposes .",
    "the whole process is designed to be lightweight enough to run in real - time on a standard pc , but is also especially intended to be used for human - robot interaction in uncontrolled , in the wild environments .",
    "the theory is explained in section [ sec : lm_3dmm ] . in section [ sec : exp ] , we show how the approach improves the recognition rates of a regular cots ( commercial off - the - shelf ) face recognition system when it is used as a pre - processing method for pose - normalisation on non - frontal and uncontrolled images from two image databases .",
    "finally , we show how our approach is suitable for real - time robotics applications by presenting its integration into the hmi framework of our scitos robot platform in section [ sec : app ] .",
    "section [ sec : conclusion ] concludes the paper and gives an outlook to future work .",
    "all parts of the framework are publicly available to support other researchers : the c++ implementations of the landmark detection and the fitting algorithm and the face model , as well as a demo app that combines both .",
    "in this section , we will give a brief introduction to the 3d morphable model and then introduce our algorithm to recover pose and shape from a given 2d image .",
    "we will then present our pose - invariant texture representation in form of a so - called isomap .",
    "a 3d morphable model consists of a shape and albedo ( colour ) pca model constructed from 169 3d scans of real faces .",
    "these meshes first have to be brought in dense correspondence , that is , vertices with the same index in the mesh correspond to the same semantic point on each face . the model used for this implementation",
    "consists of 3448 vertices .",
    "a 3d shape is expressed in the form of @xmath2^\\mathrm{t}$ ] , where @xmath3^\\mathrm{t}$ ] are the coordinates of the @xmath4th vertex and @xmath5 is the number of mesh vertices .",
    "the rgb colour values are stacked in a similar manner .",
    "pca is then applied to both the vertex- and colour data matrices separately , each consisting of @xmath6 stacked 3d face meshes , resulting in @xmath7 shape eigenvectors @xmath8 , their variances @xmath9 , and a mean shape @xmath10 , and similarly for the colour model ( @xmath11 , @xmath12 and @xmath13 ) .",
    "a face can then be approximated as a linear combination of the respective basis vectors :    @xmath14    where @xmath15^\\mathrm{t}$ ] and @xmath16^\\mathrm{t}$ ] are vectors of shape and colour coefficients respectively .",
    "given an image with a face , we would like fit the 3d morphable model to that face and obtain a pose invariant representation of the subject . at the core of our fitting algorithm",
    "is an affine camera model , shape reconstruction from landmarks , and a pose invariant textural representation of the face .",
    "we thus only use the shape pca model from the 3dmm and not the colour pca model , and instead use the original texture from the image to obtain the best possible image quality for subsequent face analysis steps .",
    "similar to aldrian and smith @xcite , we obtain a linear solution by decomposing the problem into two steps which can be alternated . the first step in our framework",
    "is to estimate the pose of the face . given a set of 2d landmark locations and their known correspondences in the 3d morphable model , we compute an affine camera matrix .",
    "the detected 2d landmarks @xmath17 and the corresponding 3d model points @xmath18 ( both represented as homogeneous coordinates ) are normalised by similarity transforms that translate the centroid of the image and model points to the origin and scale them so that the root - mean - square distance from their origin is @xmath19 for the landmark and @xmath20 for the model points respectively : @xmath21 with @xmath22 , and @xmath23 with @xmath24 .",
    "using @xmath25 landmark points , we then compute a normalised camera matrix @xmath26 using the _ gold standard algorithm _ @xcite and obtain the final camera matrix after denormalising : @xmath27 .    the second step in our framework",
    "consists of reconstructing the 3d shape using the estimated camera matrix .",
    "we estimate the vector of pca shape coefficients @xmath28 : @xmath29 where @xmath30 is the number of landmarks and @xmath31 is a weighting parameter for the regularisation that is needed to only allow plausible shapes .",
    "@xmath32 are the detected landmark locations and @xmath33 is the projection of the 3d morphable model shape to 2d using the estimated camera matrix .",
    "subsequently , the camera matrix can then be re - estimated using the now obtained identity specific face shape , instead of only the mean face .",
    "both steps are iterated for a few times - each of them only involves solving a small linear system of equations .    in the experiments with automatically detected landmarks , we use a cascaded regression based approach similar to feng et al .  @xcite .",
    "after an initial estimate , i.e. placing the landmarks in the region found by a face detector , we extract local features ( hog @xcite ) to update the landmark locations until convergence towards their actual position .",
    "the detected 2d landmarks have known corresponding points in the 3d morphable model , and these points are then used to fit the model .",
    "the combination of the regression based landmark detection and the landmark - based 3d morphable model fitting results in a lightweight framework that is feasible to run on videos ( all components run in the order of milliseconds on a standard cpu ) .      after fitting the pose and shape ,",
    "a correspondence between the 3d mesh and the face in the 2d image is known for each point in the image .",
    "we use this correspondence to remap the original face texture from the image onto a pose - invariant 2d surface that covers the face from all angles .",
    "we create such a generic representation with the isomap algorithm  @xcite : it finds a projection from the 3d vertices to a 2d plane that preserves the geodesic distance between the mesh vertices .",
    "our mapping is computed with the algorithm from tena  @xcite .",
    "the isomap of different persons are in dense correspondence with each other , meaning each location in the map corresponds to the same physical point in the face of every subject ( for example , a hypothetical point @xmath34 $ ] is always the center of the right eye ) .",
    "it can consequently show the accuracy of the fitting and is therefore a plausible representation of the result .",
    "figure  [ fig_isomap ] shows an isomap and a frontal rendering side by side .",
    "the isomap captures the whole face , while the rendering only shows the frontal parts of the face . as the face in the input image",
    "is frontal , with most parts of the face visible , there is little self occlusion . in case of large poses , a major part of the isomap can not be filled with face texture , and these regions will be marked black ( for example , a small black spot next to the nose can be observed in the figure ) .",
    "to analyse the performance of our approach , we have run experiments on two different image databases ( muct and point and shoot challenge ( pasc ) ) .",
    "our experiments are face verification experiments , which means that the system has to verify the identity of probe images compared to a set of gallery images via matching .",
    "the results are then statistically analysed regarding the ratio of the two possible error types , the false acceptance rate ( far ) and false rejection rate ( frr ) and plotted into detection error tradeoff ( det ) curves @xcite , using the ground - truth subject - id information provided in the metadata of the image databases . in the experiments on the pasc database ( section [ sec : pasc ] ) , we filter the probe and gallery images according to different head poses .    we used a market - leading , commercial face recognition engine for the process of enrolment and matching . as a reference measure ,",
    "all experiments were also conducted using the original , unprocessed images from the databases ( denoted as _ org _ ) . with this reference , we are able to analyse the impact of using our approach compared to a conventional face recognition framework without 3d modelling .",
    "the muct database consists of 3755 faces of 276 subjects and is published by the university of cape town @xcite . for our experiments only persons without glasses and their mouths closed were used . after this filtering",
    ", 1221 pictures were left .",
    "the pictures are taken from 5 different cameras that cause different pose angles and there are in total 10 different lighting schemes applied to the pictures . moreover , the size of the faces within the images is quite large and the subjects are placed in a controlled lab environment .",
    "muct comes with 76 manually labeled landmarks given for every image , from which we used 16 for the initialisation of our landmark - based 3dmm fitting ( _ lm _ ) .    in total",
    ", we used the unprocessed images ( _ org _ ) and the pose normalised renderings coming from our fitting method ( _ lm _ ) .",
    "we ran a verification experiment on these images , leading to similarity matrices with 1  490  841 scores for both methods . using these scores ,",
    "a det curve was plotted , of which a relevant part is depicted in figure [ fig_muct ] .",
    "it is clear to see that the verification errors of the face recognition drop significantly when our landmark - based modelling approach is used to correct the head pose .",
    "this experiment shows that when pose is the major uncontrolled factor , like on muct , the usage of our _ lm _ aproach leads to a clearly improved face recognition performance .      for our proposed use case in assistive or humanoid robotics ,",
    "muct is not representative of typical in the wild images we encounter . to verify the performance in heavily uncontrolled settings",
    ", we decided to do further investigations on a larger , more challenging database .",
    "the point and shoot challenge ( pasc ) is a performance evaluation challenge for developers of face recognition systems initiated by the colorado state university @xcite .",
    "as the name depicts , the images and videos used in the challenge are taken with consumer point and shoot cameras and not with the help of professional equipment .",
    "the database offers 9376 still images of varying resolution up to 4000@xmath353000 pixels and labeled metadata .",
    "the arrangement of the image sceneries raises some major challenges for the automated recognition of faces .",
    "the pictures were taken in various locations , indoors and outdoors , with complex backgrounds and harsh lighting conditions , accompanied by a low image quality due to blur , noise or incorrect white balance . additionally , the regions of interest for face recognition are also relatively small and of low resolution because the photographed people are not the main subject of the scenery .    in a direct comparison ,",
    "the verification rate on pasc equals only 0.22 at 0.001 far , in contrast to the more controlled databases mbe ( 0.997 ) , gbu ( 0.8 ) and lfw ( 0.54 ) @xcite .",
    "because of these harsh , uncontrolled conditions , which are similar to a real life scenario , we chose this image database for our experiments and applied our fitting algorithm ( _ lm _ ) to the images .",
    "like the previous experiment on muct ( sec .",
    "[ sec : muct ] ) , it was a verification experiment using the same cots face recognition algorithm .",
    "our experiments on pasc are intended to be as near to a realistic scenario as possible .",
    "therefore , we used the automatic landmark detection of @xcite instead of using manually annotated facial landmarks .",
    "the detector and our fitting algorithm ( _ lm _ ) allow the use of different landmark schemes , which can vary in their amount .",
    "we tested three different sets of 7 , 13 and 49 landmarks , which are visualised on the 3d morphable model in figure [ fig_det_landmarks ] ( a ) . to compare the different amounts of landmarks ,",
    "their corresponding results for the face recognition experiment on pasc are shown in figure [ fig_det_landmarks ] ( b ) .",
    "it can be observed that a higher number of facial landmarks leads to a higher quality 3dmm fitting , which then leads to a better verification performance .",
    "one of the key questions of this work is whether our approach can improve the performance of face recognition under uncontrolled conditions , especially when dealing with head pose .    to allow a more detailed interpretation of the results",
    ", we generated head pose annotations for the pasc database .",
    "we used opencv s implementation of the posit algorithm @xcite to calculate the yaw angles for each image in the database .",
    "posit estimates the pose of an object from an image using a 3d reference model and corresponding feature points of the object in the image . in our case , the 3d model was the 3d morphable model and the feature points were facial landmarks .",
    "we used this yaw angle annotation to filter the scores into different groups of yaw angles .",
    "the results obtained with our method were then compared to the results without any face modelling . for comparison",
    ", we also tested the performance of a commercial face modelling system ( _ cfm _ ) using the same workflow .",
    "the _ cfm _ uses additional modelling capabilities like mirroring ( to reconstruct occluded areas of the face ) and deillumination .",
    "figure [ fig : ce_lm ] depicts frontalised renderings of the commercial system and our fitter . in total , we compared all images of pasc against each other and the yaw angle filter separated the scores into 10@xmath36 bins that span from -70@xmath36 to + 70@xmath36 .                 to better see how the pose normalisation methods improve the performance , the resulting curves show the absolute difference of the false rejection rate to the baseline without face modelling ( _ org _ ) at a specific operating point .",
    "this type of diagram allows a more simple and clearly arranged representation of the results at different head poses .    in figure [ fig_curvedeltayaw_0 ] ,",
    "such a curve from the experiment is shown .",
    "a set of gallery images of 0@xmath36 yaw is compared to sets of probe images from 0@xmath36 to 70@xmath36 . as gallery databases in face recognition applications often contain frontal images , this experiment reflects a common use case .",
    "at the operating point 0.01 far , we then plot the improvement for each group of yaw angles .",
    "the commercial face modelling solution shows its first improvements over the conventional face recognition starting at 30@xmath36 yaw .",
    "surprisingly , our 3d morphable model based method is even able to slightly improve the matching performance for frontal images .",
    "although the cots face recognition system was used outside of the specification for the large yaw angles , we are able to improve the performance for the whole pose range . by using the original image s texture , our fitter ( _ lm _ ) does not alter the face characteristics and corrects only rotations in the pitch or roll angles .    in the next two experiments ,",
    "we take a look at how well the system operates when the gallery is also not frontal . in figure",
    "[ fig_curvedeltayaw_20_40 ] , the results for the experiment with a 20@xmath36 and a 40@xmath36 gallery can be seen . in this case , matching the faces is a much more difficult task , especially when the subjects look in different directions and large areas of the faces are not visible due to self - occlusion . while we are still able to improve the face recognition capabilities in the experiment with a 20@xmath36 gallery , our method _ lm _ struggles to keep up with the commercial solution for a 40@xmath36 gallery .",
    "the ability to reconstruct parts of the non - visible texture is a key component of the commercial modelling system ( _ cfm _ ) in such a use case which our system currently does nt offer .",
    "although , for the robotics application , which we present in section [ sec : app ] of this paper , it is likely that frontal images are used for the gallery enrolment .",
    "our fast and accurate 3d face modelling method is particularly suitable for face analysis tasks in assistive or humanoid robotics . in the following ,",
    "we demonstrate our efforts in this field by illustrating how we integrate our approach into a mobile robot s software framework .        a mobile robot platform combined with an hmi system",
    "is the basis for our research on human - robot interaction .",
    "the robot is based on a scitos g5 drive system with onboard industrial pc which is able to navigate autonomously in indoor buildings . for mapping and localisation ability , as well as collision avoidance ,",
    "two laser scanners are attached to the base ( sick s300 and hokuyo urg-04lx ) . using this base platform ,",
    "the robot is able to approach humans safely .",
    "the hmi part of the robot consists of a touch - based display and a head with moveable , human - like eyes . on top of the robot",
    ", we mounted a pan - tilt - unit ( ptu ; directed perception d46 - 17 ) , where additional sensors and cameras can be installed .",
    "the ptu adds an additional degree of freedom which is used for camera positioning to enhance the tracking process .    to align the cameras to the region of interest , we track people by applying an adaptive approach which uses a particle filter to track the position and size of the target and estimates the target motion using an optical flow based prediction model .",
    "furthermore , an svm - based learning strategy is implemented to calculate the particle weights and to prevent bad updates while staying adaptive to changes in object pose @xcite . at this point , the 3dmm",
    "pose normalisation of our approach can be used for the image of the tracked face .",
    "it can be either applied continuously or if the pose of the subject is greater than a certain threshold ( using the knowledge obtained in the experiments of section [ sec : pasc ] ) .",
    "key frames of an example video taken from our robot system are presented in the upper row of figure [ fig_filmstreifen_philipp ] .",
    "the opencv object detection with a face cascade @xcite was used to initialise the regression based landmark detector , which then automatically found 15 facial landmarks .",
    "the fitting results , represented in isomaps , are shown in the second row of figure [ fig_filmstreifen_philipp ] .",
    "on the robot , we use the frontal renderings as an input for the same face recognition engine that was also used for the experiments . to distinguish the person s identity properly",
    ", the system should generate a rather high score for this positive match . the pose normalised renderings allow the face recognition algorithm to achieve a clearly higher score compared to the original , unprocessed images .",
    "possible use cases for a robot of this kind are industrial mobile robotics , shop or museum tour guides or a surveillance system ( e.g. in a supermarket ) . in all these cases ,",
    "the robot has to interact naturally with technically unskilled people .",
    "it is therefore convenient to be able to analyse people independent of their pose , without requiring them to look at the robot directly .",
    "identification , age and gender estimation on pose normalised renderings offer the possibility to personalise the robot s behaviour .",
    "we proposed a powerful method for head pose correction using a fully automatic landmark - based approach for fitting a 3d morphable model . by using an efficient fitting algorithm ,",
    "our approach can be used for tasks which require a fast real - time solution that can be also used on live video streams .",
    "in contrast to existing work , we focus on an evaluation of our approach with automatically found landmarks and in - the - wild images and publish the whole 3dmm fitting pipeline as open source software ( see section [ sec : intro ] )",
    ".    an experimental evaluation on the two commonly - used image databases muct and pasc showed the significance of our approach as a means of image processing for facial recognition in both controlled and heavily unconstrained settings .",
    "for recognition algorithms that are mostly trained for frontal faces , a rotation of the head means a loss of information that results in a lower matching score .",
    "we showed that our methodology is capable of improving the recognition rates for larger variations in head pose .",
    "compared to a commercial face modelling solution , our approach keeps up well and even outperforms it in certain scenarios .",
    "the addition of 3dmm pose normalisation certainly brings advantages compared to a conventional face recognition framework when the setting is uncontrolled - like in robotics , surveillance or consumer electronics .",
    "furthermore , we presented our software framework on a mobile robot platform which uses our pose normalisation approach to allow a more reliable face analysis .",
    "we are currently doing further research on age- and emotion - estimation systems to expand the abilities of our robot . in the future",
    ", we also plan to statistically evaluate the effect on their performance when using our landmark - based pose normalisation , like we did for face recognition in this paper .",
    "the authors would like to thank huan fui lee and the rt - lions robocup team of reutlingen university .",
    "we would also like to thank cyberextruder , inc . for supporting our research ."
  ],
  "abstract_text": [
    "<S> face analysis techniques have become a crucial component of human - machine interaction in the fields of assistive and humanoid robotics . </S>",
    "<S> however , the variations in head - pose that arise naturally in these environments are still a great challenge .    in this paper , we present a real - time capable 3d face modelling framework for 2d in - the - wild images that is applicable for robotics . </S>",
    "<S> the fitting of the 3d morphable model is based exclusively on automatically detected landmarks . after fitting </S>",
    "<S> , the face can be corrected in pose and transformed back to a frontal 2d representation that is more suitable for face recognition . </S>",
    "<S> we conduct face recognition experiments with non - frontal images from the muct database and uncontrolled , in the wild images from the pasc database , the most challenging face recognition database to date , showing an improved performance .    </S>",
    "<S> finally , we present our scitos g5 robot system , which incorporates our framework as a means of image pre - processing for face analysis . </S>"
  ]
}