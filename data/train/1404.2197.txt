{
  "article_text": [
    "polarization and reflects the photons in @xmath0 polarization .",
    ", width=264 ]    in this section , we introduce the mdi - sarg04 qkd protocol . first , we summarize the assumptions and mathematical definitions made in this paper , and then we describe how the protocol runs .",
    "we assume that each of alice and bob has a phase randomized photon source , _ i.e. _ the vacuum , a single photon , and multi photons are emitted probabilistically .",
    "the probabilities of the @xmath1-photon emission from alice and bob are @xmath2 and @xmath3 , respectively , which satisfy @xmath4 .",
    "we encode the bit information in polarization of photons , and we assume that the preparation of the polarization is precise without any flaw . for simplicity , we consider the asymptotic case to neglect any statistical fluctuation , i.e. , the number of the signals sent by alice and bob is infinite . in our paper , horizontal and vertical polarization states of a single photon",
    "are represented by @xmath5-basis qubit states , namely @xmath6 and @xmath7 , respectively .",
    "we also define @xmath8  ( rectilinear)-basis states as @xmath9 for @xmath10 . by using a creation operator @xmath11 for a single photon in a polarization @xmath12 and the vacuum state @xmath13",
    ", we denote an @xmath1-photon number state with polarization @xmath12 by @xmath14 .",
    "( note that when the subscript @xmath12 is @xmath15 or @xmath16 , it refers to the qubit state rather than the photon number state ) .",
    "other definitions we use are as follows : @xmath17 for @xmath10 and @xmath18 for @xmath19 .",
    "@xmath20 , where @xmath21 , which satisfies @xmath22 for all @xmath23 . @xmath24 and @xmath25 .",
    "we denote @xmath26 .",
    "the protocol runs as follows :    ( a1 ) alice and bob choose a bit value @xmath23 and @xmath27  @xmath28 , respectively , and they encode the bit value into the photonic states of their pulses as @xmath29 and @xmath30 .",
    "( a2 ) alice and bob rotate the polarization of their pulses by applying rotation @xmath31 and @xmath32 with randomly - chosen values of @xmath33 and @xmath34 , respectively , where @xmath31 is defined by @xmath35 . after the rotation",
    ", alice and bob send the pulses to eve s measurement unit  ( mu ) through quantum channels .",
    "( a3 ) eve performs a measurement on the incoming pulses and announces to alice and bob over the authenticated public channel whether her measurement outcome is successful or not . when the outcome is successful , she also announces types of the successful events , either type1 or type2 .",
    "( a4 ) alice and bob broadcast @xmath36 and @xmath37 , over the authenticated public channel .",
    "if the measurement outcome in ( a3 ) is successful with type1 and @xmath38 , they keep their bit values @xmath23 and @xmath27 in ( a1 ) , and alice flips her bit . if the measurement outcome in ( a3 ) is successful with type2 and @xmath39 , they keep their bit values @xmath23 and @xmath27 in ( a1 ) . in all the other cases ,",
    "they discard their bit values .",
    "type1 ( @xmath40&@xmath41 or @xmath42&@xmath43 ) & @xmath44 + type2 ( @xmath40&@xmath43 or @xmath42&@xmath41 ) & @xmath45 +    ( a5 ) alice and bob repeat from ( a1 ) to ( a4 ) until the number of the successful events with rotation @xmath46 in type1 becomes @xmath47 and @xmath39 in type2 becomes @xmath48 .",
    "let @xmath49 be the number of the successful detection event of type @xmath23 .",
    "alice and bob announce randomly - chosen @xmath50 bits over the authenticated public channel , where @xmath51 is much smaller than 1 , and estimate the error rate @xmath52 in the remaining code bits .",
    "the estimated number of the bit error in the code bits is denoted by @xmath53 .",
    "( a6 ) alice and bob perform error correction and privacy amplification on the remaining @xmath54 bits by their discussion over the public channel . as a result",
    ", they share a final key of length @xmath55 .    at eve s mu in ( a3 ) , honest eve performs the bell measurement in order to establish quantum correlations between alice and bob to generate the key . in fig .",
    "[ fig : actual ] , the experimental setup for the bell measurement is depicted .",
    "it employs a half beam splitter  ( bs ) , two polarization bss  ( pbss ) , and the photon detectors . in the case where both alice and bob emit a single photon",
    ", the simultaneous photon detection events matching the pattern type1  ( type2 ) , listed in table  [ tbl : type ] , corresponds to the detection of @xmath44  ( @xmath45 ) .",
    "we emphasize that in the security proof we assume that eve is malicious and has a control over the quantum channels , and all the bit errors are attributed to the consequence of the eavesdropping .      in prepare & measure setting ,",
    "the sarg04 protocol is different from the bb84 protocol only in the post - processing part , i.e. , no modification is needed in the experimental setup . in the mdi setting , however , the experimental setup for the bb84 protocols  @xcite can not be directly used in mdi - sarg04 as it induces a high bit error rate , and this is a significant qualitative difference of mdi setting from prepare & measure setting , implying that not all the prepare & measure qkd protocols can not be directly converted to mdi setting .",
    "therefore , we need to consider an alternative experimental scheme for mdi - sarg04 . in this section ,",
    "we first discuss why the setup for mdi - bb84 gives the high bit error rate , and then we propose alternative experimental schemes for mdi - sarg04 .    for the explanation we denote by @xmath56 the joint probability that eve receives @xmath1 and @xmath57 photons from alice and bob , respectively , and obtains the successful measurement outcome . note that while we do not deal with the types of eve s successful outcomes separately , the following discussion is valid for both types .",
    "for simplicity , we neglect all the losses , including those in the quantum channel and the photon detectors , and therefore we can also regard @xmath56 as @xmath58 , which is the joint probability that alice and bob respectively emit @xmath1 and @xmath57 photons and eve obtains the successful measurement outcome . like in the mdi - bb84 protocols , we assume that alice and bob use a phase randomized weak coherent light whose average photon number is much smaller than 1 .",
    "thus , we have @xmath59 for @xmath60 . for simplicity , we assume eve is honest , namely the bit error rate for @xmath61 is zero , and all photon detectors have unit quantum efficiency and no dark counting . in the following ,",
    "we show that even with this simplification favorable to alice and bob , no significant key is expected . to see this",
    ", we consider the bit error rate , and the total bit error rate @xmath62 is expected to be @xmath63 where @xmath64 is the bit error probability under the condition that alice emits @xmath1 photons and bob emits @xmath57 photons , and eve announces the successful outcome .",
    "note that equation  ( [ eq : etotapprox ] ) holds in both the mdi - bb84 and mdi - sarg04 protocols .",
    "it is clear from equation  ( [ eq : etotapprox ] ) that the bit error is caused by the case where one party emits two photons and the other party emits the vacuum .",
    "it is also clear that @xmath65 can not be zero since the vacuum emission carries no bit information . in the case of mdi - bb84 , this event is always discarded from the sifted key , and consequently the bit error rate in the key generation basis , i.e. , rectilinear basis , is zero .",
    "this is so because the two - photon states @xmath66 and @xmath67 , which contribute to the bit values , are orthogonal and they never produce the successful outcomes in eve s projection measurement for the basis @xmath68 .",
    "therefore , in the experiment of mdi - bb84 , the bit error rate is very small . in the case of mdi - sarg04 , however , two states @xmath69 and @xmath70 consisting bit values are not orthogonal .",
    "this means that the two - photon emission contributes to the successful outcome .",
    "more precisely , @xmath71 holds from the direct calculation of @xmath72 . and",
    "@xmath73 hold for any linear loss transmittance channel . ]",
    "therefore , we conclude that the use of the phase randomized coherent light source gives no significant key in mdi - sarg04",
    ".    , @xmath74 and other problematic photon number configurations . ( a ) eve performs the qnd measurements on the pulses from alice and bob , and she does not perform the interference measurement for @xmath75 or @xmath76 .",
    "eve accepts only when @xmath77 and @xmath78 are satisfied .",
    "( b ) a quasi single - photon source used by alice and bob , which is composed of the heralded spdc process . when detector @xmath79 clicks , alice / bob sends her / his pulse at the remaining mode to eve s mu . , width=302 ]    in order to generate a key in the mdi - sarg04 protocol , eve s mu or the photon sources should be modified such that the probability of obtaining the successful outcome due to the two photons and the vacuum state is suppressed . in order to suppress the probability , we propose two experimental setups : ( i ) eve performs quantum nondemolition  ( qnd ) measurement on the two incoming pulses from alice and bob just before mixing them as shown in fig .",
    "[ fig : qnd+parame](a ) .",
    "the qnd measurement discriminates whether the photon number in the pulse is 0 , 1 or more .",
    "eve accepts only the case where @xmath77 and @xmath78 and discards the other cases with multiple photons .",
    "thanks to the qnd measurement , the total bit error rate is suppressed even if the phase randomized coherent light is used as a photon source .",
    "( ii ) without the modification of eve s mu , alice and bob replace the phase randomized coherent light by a heralded single photon source based on a spontaneous parametric down - conversion  ( spdc ) and a threshold photon detector  ( see fig .  [",
    "fig : qnd+parame](b ) ) .",
    "this dramatically reduces the probabilities of the events of @xmath80 and @xmath74 .",
    "we will show that these setups enable us to generate the key later .",
    "in this section , we discuss the unconditional security proof  ( i.e. , the security proof against most general attacks ) of our scheme .",
    "the security proof is independent of the specific device models like in fig .",
    "[ fig : qnd+parame ] , namely it is valid for any eve s mu and any photon sources of alice and bob .",
    "our proof employs the security proof based on the entanglement distillation protocol  ( edp )  @xcite , where the distillation of @xmath81 is considered for type1 and that of @xmath82 is considered for type2 .",
    "the proposed edp - based virtual protocol , which is equivalent to the mdi - sarg04 qkd from eve s viewpoint , runs as follows .    ( v1 ) alice and bob prepare @xmath83 , where @xmath84 for @xmath85=a , b . here",
    "@xmath86 and @xmath87 are randomly chosen .",
    "the probability distribution of the photon number is equal to that of the photon source in the actual protocol .",
    "alice and bob send the @xmath1 and @xmath57 photon states in @xmath88 and @xmath89 to eve s mu , respectively .",
    "( v2 ) eve performs a measurement on the photons coming from alice and bob , and announces to them whether the measurement is successful  ( including the type of the event ) or not . if the measurement result is not successful , alice and bob discard their qubits .",
    "( v3 ) alice and bob broadcast the labels @xmath36 and @xmath37 , respectively . in the cases of @xmath90 with the announcement of type2 or @xmath91 , alice and",
    "bob discard their qubits .",
    "( v4 ) alice and bob repeat ( v1 )  ( v3 ) many times until the number of the successful events for @xmath92 becomes @xmath93 for @xmath94 , where @xmath23 corresponds to the type of the events .",
    "( v5 ) let @xmath95 be the number of the successful detection event for type @xmath23 .",
    "alice and bob announce randomly chosen @xmath50-photon pairs over the authenticated public channel , where @xmath51 is much smaller than 1 , and then they perform @xmath5-basis measurement on their qubits of the chosen pairs . by sharing their measurement results over the authenticated public channel",
    ", they estimate the bit error rate on the code qubits denoted by @xmath96 . as a result",
    ", the number of the bit error is estimated to be @xmath97 .",
    "( v6 ) they estimate the upper bound on the phase error rate @xmath98 for @xmath1 and @xmath57 photons from the bit error rate @xmath99 for @xmath1 and @xmath57 photons . here",
    "the phase error is defined by the bit error that would have been obtained if they had measured the qubit pairs by @xmath8 basis , which is the complementarity basis of the computational basis .",
    "( v7 ) when the bit and the phase errors are smaller than a threshold value for entanglement distillation , they perform the distillation for @xmath54 qubit pairs . for the cases of type1 and type2 , they distill the photon pairs in states @xmath44 and @xmath45 , respectively .",
    "we denote the number of the distilled maximally entangled qubit pairs as @xmath100 .",
    "finally , by performing @xmath5-measurements on the distilled photon pairs , they obtain the key .    the important quantities in the proof is the bit and phase errors , and the phase error rate determines the amount of privacy amplification . the bit error rate in the code bits of the virtual protocol , which is exactly the same as the one of the actual protocol ,",
    "is directly estimated by test bits .",
    "on the other hand , the phase error rate is defined by the complementary basis @xmath8 , which alice and bob never employ , and therefore this rate is not directly estimated in the protocols .",
    "note that we are allowed to work on alice s @xmath1-photon emission and bob s @xmath57-photon emission separately , because alice s and bob s photon sources in the protocols are phase randomized . in the following subsections , we present the estimation of the phase error rates for the cases of type1 and type2 independently .",
    "we derive an upper bound on the phase error @xmath101 for @xmath94 , where the superscript @xmath102 denotes @xmath61 and the subscript represents the type of the successful outcome , and derive an upper bound on the phase error @xmath103 .",
    "we show that in the case of @xmath104 , no key can be generated when the probability of eve s successful outcome for the two - photon emission event is smaller than 1/16 .",
    "we note that in the cases of either @xmath105 or @xmath106 , eve can perform an unambiguous state discrimination to one of the three - photon emission part  @xcite , and thus we can not extract the key from such events , given that the channel is lossy enough .",
    "fnally , we note that given the phase error rates , @xmath107 and @xmath108 , the asymptotic key rate for type @xmath23 is written by  @xcite @xmath109+q_i^{(1,2)}[1-h(e^{(1,2)}_{i,\\u{ph } } ) ] \\nonumber\\\\ & + q_i^{(2,1)}[1-h(e^{(2,1)}_{i,\\u{ph}})]-f(e_i^\\u{tot})q_i^\\u{tot}h(e_i^\\u{tot } ) .",
    "\\label{eq : keyrate}\\end{aligned}\\ ] ] here @xmath110 is the binary shannon entropy .      by the analysis based on the virtual protocol , we give the phase error estimation formula for @xmath111 and @xmath113 .",
    "the estimation is performed for type1 and type2 , separately , and we detail the derivation of the phase error estimation in methods section .    in the case of type 1 , we have @xmath114 for @xmath111 and @xmath115 for @xmath113 , where @xmath116    in the case of type 2 , we have @xmath117 for @xmath111 and @xmath118 for @xmath113 , where @xmath119 is the maximal solution of the following equation for @xmath16 @xmath120     and ( b ) for @xmath113 .",
    ", width=264 ]    we depict the dependencies of the phase error rates on the bit error rates in fig .",
    "[ fig : pb ] .      for the case of @xmath104 , the key can not be obtained for @xmath104 in type1 and type2 by giving an explicit eve s attack which give a phase error of 0.5 , as long as the success probability of eve s measurement conditioned that both alice and bob emit two photons is not larger than 1/16 .",
    "we show the proof in methods section . we will prove that we can not generate a key from @xmath104 in the virtual protocol , and it follows that we can not generate a key from @xmath104 in the actual protocol either . to see this , note that the virtual protocol differs from the actual protocol only in the way to prepare the state , and the state prepared and post data - processing are exactly the same in both protocols .",
    "in other words , only the local operation needed in state - preparation process by the legitimated parties are different in the two protocols . by recalling that any local operation can not convert a separable state into a non - separable state , we conclude that if we can not generate a key from a virtual protocol , then we can not generate a key from the actual protocol .      here",
    "we show the results of the key generation rate for the two experimental setups as shown in figs .",
    "[ fig : qnd+parame](a ) and ( b ) by using typical experimental parameters taken from gobby - yuan - shields  ( gys ) experiment  @xcite , where the quantum efficiency and the dark counting of the all detectors in eve s mu are @xmath121 and @xmath122 , respectively , the loss coefficient of the quantum channel is @xmath123db / km , and the inefficiency of the error correcting code is @xmath124 . in the simulation",
    ", we use infinite number of decoy states  @xcite in order to obtain @xmath125 , @xmath126 , @xmath127 and @xmath128 . assuming that the bit error is stemmed only from dark countings of the detectors , we ignore the other imperfections such as the misalignment of the devices .",
    "we also assume that the mean photon numbers of the signal pulses prepared by alice and bob are the same , and the mu in eve is the middle of alice and bob .",
    "the mean photon number for the signal is optimized for maximizing the key generation rate at each distance . by using equation  ( [ eq : keyrate ] ) with the above parameters and assumptions",
    ", we calculate the key generation rate as a function of the distance between alice and bob ( i ) when eve postselects the events with @xmath77 and @xmath78 with the qnd measurement as shown in fig .",
    "[ fig : qnd+parame](a ) and alice and bob use the coherent pulses , and ( ii ) when eve uses the mu in fig .",
    "[ fig : actual ] and alice and bob use quasi single photon sources prepared by the spdc in fig .",
    "[ fig : qnd+parame](b ) .     only .",
    "middle : the key rate of the mdi - sarg04 protocol from @xmath111 , @xmath112 and @xmath129 .",
    "top : the key rate of the mdi - bb84 protocol .",
    "( b ) the upper and lower solid lines are the key rates from @xmath111 , @xmath112 and @xmath129 for type1 and type2 , respectively .",
    "the upper and lower dashed lines are the key rates from @xmath111 for type1 and type2 , respectively .",
    ", width=302 ]    .",
    "for the key rates from @xmath111 , the three lines show the mean photon number when we consider only type1 , both types and only type2 from the top .",
    "the mean photon numbers for the key rates from @xmath111 , @xmath112 and @xmath129 show a similar tendency .",
    "the dashed line is for the mdi - bb84 protocol .",
    ", width=264 ]    _ case ( i )  _ the simulation result of the key rate is shown in fig .  [",
    "fig : qnd](a ) , and the mean photon number which maximizes the key rate is shown in fig .",
    "[ fig : qnd_alpha ] .",
    "we also plot the key rates of type1 and type2 separately in fig .",
    "[ fig : qnd](b ) . the details for obtaining these figures",
    "are shown in supplementary .",
    "when the distance is zero , since there is no photon loss before the bs and the multi - photon emissions are excluded , the events of multi - photon input have no contribution to the key rate .",
    "in fact , in fig .  [",
    "fig : qnd](a ) , the two key rates at zero distance obtained from only @xmath111 and from both @xmath111 , @xmath112 and @xmath129 are exactly the same . when the distance becomes longer , we see from fig .  [",
    "fig : qnd_alpha ] that the contribution of the multi photons becomes larger .",
    "for the key rate from only @xmath111 , the mean photon number is monotonically decrease because the multi - photon emissions give only adverse effect . on the other hand ,",
    "when we extract the key additionally from the multi photons , the mean photon number does not decrease monotonically , which shows an advantage in using multi - photon emission .    , and",
    "the successful events of @xmath113 and @xmath130 give little contribution to the key rate .",
    "this is so because the probability of the two - photon component in the heralded photon source is negligibly small compared with the probability of the single - photon component .",
    "the lines are for mdi - bb84  ( black ) , for both types  ( red ) , type1  ( green ) and type2  ( blue ) of the mdi - sarg04 .",
    ", width=264 ]    .",
    "the upper line  ( black ) is the mean photon number for the mdi - bb84 protocol .",
    "the lower three lines are for the key rates of the mdi - sarg04 protocol obtained from type1  ( green ) , both types  ( red ) and type2  ( blue ) from the top . ,",
    "width=283 ]    _ case ( ii )  _ alice and bob use quasi single photon sources by spdc as shown in fig .",
    "[ fig : qnd+parame](b ) .",
    "detector @xmath79 is the same as that used in eve s mu , namely it is the threshold detector with the quantum efficiency of @xmath121 and the dark counting of @xmath122 .",
    "eve s mu is the same as that shown in fig .",
    "[ fig : actual ] .",
    "the key rate is shown in fig .",
    "[ fig : pdc ] . the details for calculating the key rates",
    "are shown in supplementary . the mean photon number which maximizes the key rate",
    "is shown in fig .",
    "[ fig : pdc_alpha ] . from fig .",
    "[ fig : pdc ] , we see that the key rate only from type1 and that both from type1 and type2 intersect . for the distribution distance",
    "longer than the cross point , type2 has no contribution of the key , which is shown by the blue line in the figure , and therefore it is better to generate a key from type1 only . from fig .",
    "[ fig : pdc_alpha ] , we see that the mean photon number is very small .",
    "this is so because the use of larger mean photon numbers results in two - photon emission , which increases the bit error rate . from all the figures of the key rate",
    ", one sees that the key rates of mdi - sarg04 are lower than those of mdi - bb84 .",
    "this tendency holds also for prepare & measure sarg04  @xcite , and the higher phase error rates of sarg04 protocol than that of bb84 is the main reason of this tendency .",
    "in recent years , many proposals and experimental demonstrations of the mdi qkd have been studied .",
    "so far , all of them except for the continuous - variable qkd protocol  @xcite are based on the bb84 protocol .",
    "we first proved the unconditional security of the mdi qkd based on the sarg04 protocol . in our security proof",
    ", we gave the upper bounds on the phase error rate when alice and bob emit single photons and when one party emit one photon and the other half emit two photons .",
    "for the case of the two photon emissions from both parties , we proved that a key can not be generated as long as the probability of success in her measurement conditioned that both alice and bob emit two photons is not larger than 1/16 .",
    "another important issue to be addressed in mdi setting is what kind of measurement should be implemented experimentally at eve s laboratory .",
    "we have shown that the measurement setup for bb84 in mdi setting can not be used in sarg04 in mdi setting , and we proposed two measurement schemes for mdi sarg04 . in the first one , alice and bob use heralded single photon sources prepared by spdc . in the second one , eve performs qnd measurement on the two pulses coming from alice and bob individually . in our simulation",
    "based on these experimental setups , it was confirmed that these setup can generate a key .",
    "while eve accesses only the photons in modes @xmath131 and @xmath132 in the actual protocol , we pessimistically suppose that she can prepare any state in @xmath133 and @xmath134 for simplicity of the proof .",
    ", width=321 ]    here , we give the phase error estimation for @xmath61 . for this , it is convenient to recall a mathematical property of the maximally entangled state that @xmath135 is satisfied for any operator @xmath136",
    ". therefore @xmath137 in ( v1 ) is expressed as @xmath138 , where @xmath139 .",
    "physically , this identification can be interpreted as the situation where @xmath140 is prepared by each of the parties , the filtering operation , of which successful case is described by @xmath141 , is applied , and then each party sends the photons to eve only when the filtering operation succeeds  ( also see fig .  [",
    "fig : nm11 ] ) . for the simplicity of the security proof",
    ", we make an overestimation of eve s ability in terms of the accessibility of the photons , namely , we imagine eve who has a direct access to photons of @xmath133 and @xmath134 rather than @xmath131 and @xmath132 , and she can prepare any joint state of the photons of @xmath133 and @xmath134 . for later convenience ,",
    "we denote by @xmath142 the state prepared by eve .    in the following ,",
    "we first discuss the case of type1 .",
    "we define @xmath143 as the joint probability that the photons in @xmath142 pass through the filtering operation and induces a bit / phase error to the state @xmath44 after the rotation . here",
    "@xmath144 and @xmath145 are povm elements of the bit and phase error measurements on @xmath142 , respectively .",
    "the probability that the two photons in @xmath142 pass through the successful filtering operation is described by @xmath146 , where the povm element of the successful filtering operation on the two photons is @xmath147 where @xmath26 .",
    "the povms for the bit and the phase errors are written as @xmath148 applying the bayes rule , the bit error rate @xmath149 and the phase error rate @xmath150 in the final state in modes @xmath151 and @xmath152 are described by @xmath153 the phase error estimation can be established by directly writing down the explicit form of equation  ( [ eq : pibit11type1 ] ) comparing each matrix element , and one can conclude that @xmath154 thus from equations  ( [ eq : pifil11type1 ] ) and ( [ eq : phasebitperfil11type1 ] ) , the phase error rate is precisely estimated , by using the bit error rate , as shown in equation  ( [ eq:11phasebittype1 ] ) . thanks to azuma s inequality  @xcite , equation  ( [ eq:11phasebittype1 ] ) holds for any eavesdropping including coherent attacks .",
    "next , we estimate the phase error rate for type2 . because only the cases of @xmath155 are accepted for type2 , the definition of the povm element of the successful filtering operation is changed to @xmath156 and the probability that the two photons in @xmath142 pass through the successful filtering operation",
    "is expressed by @xmath157 .",
    "we describe a joint probability that the two photons in @xmath142 pass through the successful filtering operation after the rotation and then the photons in modes @xmath151 and @xmath152 have a bit / phase error to the state @xmath45 by @xmath158 . like in the case of type1 ,",
    "the povm elements of @xmath159 and @xmath160 are written by @xmath161 and @xmath162    by using the bayes rule , the bit / phase error rate of @xmath163 in the final state is expressed by @xmath164 in order to see the relation between the bit and phase error rates , we consider an inequality to bound the phase error as @xmath165 , where @xmath166 is a real number , which is equivalent to @xmath167 for @xmath168 . by considering a non - negativity condition of @xmath167",
    ", we see that this inequality always holds when @xmath169 , and therefore , we have the relation between the phase error rate and the bit error as shown in equation  ( [ eq:11phasebittype2 ] ) .       and @xmath171 .",
    "by eve s announcement for the successful measurement on the photons in @xmath88 , @xmath89 and @xmath172 , the three - photon state @xmath173 is prepared .",
    ", width=321 ]    below , we give the phase error estimation for @xmath170 and @xmath171 . by using the similar argument as @xmath61 , @xmath174 at bob s side in ( v1 )",
    "is defined by @xmath175 as in fig .",
    "[ fig : nm12 ] , where @xmath176 . here",
    "we note that two - photon emission part is simulated by preparing two pairs of @xmath140 followed by the rotation and the filtering operation on two qubits  ( see also fig .",
    "[ fig : nm12 ] ) . in this virtual protocol",
    ", while we consider two photons in different modes , this never underestimates eve s ability .",
    "this is so because two photons in the different modes and two photons in a single mode can be converted just by an unitary transformation as @xmath177 .",
    "we note that because the photon in mode @xmath178 is in @xmath179 after the filtering operation , and it is decoupled from all the other systems , the component is not related to the security proof .",
    "again , we employ the overestimation that eve has the control over the state of the systems of @xmath180 , @xmath181 and @xmath182 , and we denote the three - photon state by @xmath173 , which is prepared by eve after her announcement of the success . like in the case for @xmath61",
    ", we estimate a phase error for each case of type1 and type2 separately .    for type1 ,",
    "define a povm element of the successful filtering operations on @xmath173 as @xmath183 here the probability of the successful filtering operation is written by @xmath184 .",
    "we define @xmath185 as a joint probability that the photons in @xmath173 pass through the filtering operation and induces a bit / phase error to the state @xmath44 after the rotation . the successful filtering operation",
    "after the rotation is performed on the two photons in @xmath173 and then the photons in modes @xmath151 and @xmath152 have a bit / phase error to the state @xmath44 . here",
    ", povm elements of @xmath186 are written by @xmath187 the actual bit error rate @xmath188 and phase error rate @xmath189 for @xmath170 and @xmath171 are obtained by accommodating the normalization by @xmath190 , and they are expressed as @xmath191 in order to see the relation between the bit and phase error rates , we consider an inequality to bound the phase error as @xmath192 , where @xmath193 and @xmath194 are real numbers . by using equations  ( [ eq : pifil12type1 ] )  ( [ eq : eebit12type1 ] ) , and the linearity of the trace",
    ", we obtain an inequality as @xmath195 , which is satisfied when @xmath196 therefore the phase error rate is given by using the bit error as shown in equation  ( [ eq:12phasebittype1 ] ) .    for type2 , we define a povm element @xmath197 of the successful filtering operation by limiting the summation only to @xmath198 and by replacing @xmath199 with @xmath200 in equation  ( [ eq : pifil12type1 ] ) . the probability of the successful filtering operation is described by @xmath201 .",
    "we also define joint probabilities of @xmath173 passing through the filtering and presenting bit and phase errors to the state @xmath45 by @xmath202 and @xmath203 .",
    "we define the povm element of @xmath204 by limiting the summation only to @xmath198 and replacing @xmath199 with @xmath200 in equation  ( [ eq : pibit12type1 ] ) , and that of @xmath205 is defined by limiting the summation only to @xmath198 , replacing @xmath199 with @xmath200 , and @xmath206 with @xmath207 for mode @xmath152 . in a similar manner as the case of type1 for @xmath170 and @xmath171 , by using the bit error rate defined by @xmath208 , the phase error rate as @xmath209 and real numbers @xmath210 and @xmath211 , we consider an inequality as @xmath212 , which leads to @xmath213 . from this inequality ,",
    "we obtain @xmath214 , where @xmath119 is the maximal solution of equation  ( [ eq : gs2 ] ) .",
    "using @xmath119 , we have the relation between the phase error rate and the bit error as shown in equation  ( [ eq:12phasebittype2 ] ) .      .",
    "by eve s announcement for the successful measurement on the photons in @xmath88 , @xmath215 , @xmath89 and @xmath172 , the four - photon state @xmath216 is prepared .",
    ", width=321 ]    for the case of @xmath104 , like in the previous subsection , @xmath217 at alice s side in ( v1 ) is obtained by @xmath218 , and @xmath174 at bob s side is prepared by the same manner . as a result , the virtual protocol for @xmath104 is equivalent to the successful situation of the filtering operations , which we depict in fig .  [",
    "fig : nm22 ] .",
    "we denote the state of alice s and bob s four qubits after eve s successful announcement by @xmath219 . in the following , we prove that the key can not be obtained for @xmath104 by giving an explicit eve s attack , namely we give explicit states of @xmath180 , @xmath220 , @xmath181 and @xmath182 which give a phase error of 0.5 .",
    "the key ingredient is that while eve can not manipulate these four qubits , she conclusively prepare such a state on their qubits by announcing the success of her measurement only when she succeeds an eavesdropping measurement on eve s photons @xmath88 , @xmath215 , @xmath89 and @xmath172 .",
    "this attack gives eve the perfect information on the bit values when her measurement succeeds .",
    "for type1 , the probability of the successful filtering operation is expressed by @xmath221 , where @xmath222 the joint probability , that the filtering operation succeeds and the bit / phase error to the state @xmath44 is detected , is expressed by @xmath223 , where @xmath224 the bit / phase error rate is expressed as @xmath225 .",
    "one can confirm by direct calculation that a four - photon state of @xmath226 gives @xmath227 and @xmath228 , and another four - photon state @xmath229 , which is orthogonal to @xmath230 , gives @xmath231 and @xmath228 .",
    "therefore , although eve can not touch the four modes @xmath180 , @xmath181 , @xmath220 and @xmath182 , eve can prepare the two states by a projective measurement on the four photons in @xmath88 , @xmath89 , @xmath215 and @xmath172 as @xmath232 .",
    "one sees this fact from the equation @xmath233 , which also implies that the preparation succeeds with a probability of 1/16 .",
    "thus a malicious eve achieves the phase error rate of 0.5 for any bit error rate by distributing these states with a relevant probability .",
    "this means that the state in @xmath234 and @xmath235 is separable , and it follows that no key can be generated for @xmath236 , where @xmath237 is the probability of eve s successful detection of type @xmath23 conditioned that both alice and bob emit two photons .    for type2 , with the same fashion as the case of @xmath170 and @xmath171 , povm elements @xmath238 for the successful filtering operation and @xmath239 for the bit / phase error are defined by replacing the summation range of @xmath36 , the prefactor and the proper inversion of the bit value of the projection in equations  ( [ eq : pifil22 ] ) and ( [ eq : pibit22 ] ) .",
    "we consider the following four orthogonal four - photon states for systems @xmath180 , @xmath181 , @xmath220 and @xmath182 @xmath240 , @xmath241 , @xmath242 and @xmath243 .",
    "each state can be prepared by eve s projective measurement @xmath244 on the four photons in @xmath88 , @xmath89 , @xmath215 and @xmath172 with a probability of @xmath245 . by calculating the error probabilities",
    ", we see that mixed states @xmath246 and @xmath247 give @xmath248 and @xmath249 , respectively .",
    "therefore eve achieves any bit error rate below 0.5 while keeping @xmath250 by distributing the above two mixed states with an appropriate probability . as a result",
    ", we conclude that for @xmath251 , the key can not be obtained .",
    "this work was supported by the funding program for world - leading innovative r & d on science and technology  ( first ) , mext grant - in - aid for scientific research on innovative areas 21102008 , mext grant - in - aid for young scientists(a ) 23684035 , jsps grant - in - aid for scientific research(a ) 25247068 and ( b ) 25286077 .",
    "kt acknowledges support from the national institute of information and communications technology  ( nict ) of japan  ( project `` secure photonic network technology '' as part of `` the project uqcc '' ) .",
    "99 mayers , d. unconditional security in quantum cryptography .",
    "_ j. acm _ * 48 * ( 3 ) , 351 ( 2001 ) .",
    "lo , h. k. & chau , h. f. unconditional security of quantum key distribution over arbitrarily long distances .",
    "_ science _ * 283 * , 2050 ( 1999 ) .",
    "shor , p. w. & preskill , j. simple proof of security of the bb84 quantum key distribution protocol .",
    "lett . _ * 85 * , 441 ( 2000 ) .",
    "lydersen , l. _ et al .",
    "_ hacking commercial quantuk cryptography systems by tailored blight illumination .",
    "_ nature photonics _ * 4 * , 686 ( 2010 ) .",
    "lo , h. k. , curty , m. & qi , b. measurement - device - independent quantum key distribution .",
    "_ _ * 108 * , 130503 ( 2012 ) .",
    "bennett , c. h. & brassard , g. quantum cryptography : public key distribution and coin tossing .",
    "_ in proceedings of ieee international conference on computers , systems , and signal processing _ 175 - 179  ( ieee press , new york , 1984 ) .",
    "tamaki , k. , lo , h. k. , fung , c. h. f. & qi , b. phase encoding schemes for measurement - device - independent quantum key distribution with basis - dependent flaw .",
    "_ _ * 85 * , 042307 ( 2012 ) .",
    "xu , f. , curty , m. , qi , b. & lo , h. k. practical aspects of measurement - device - independent quantum key distribution .",
    "_ new j. phys . _ * 15 * , 113007 ( 2013 ) .",
    "tang , z. _ et al_. experimental demonstration of polarization encoding measurement - device - independent quantum key distribution . _ arxiv_:1306.6134 .",
    "liu , y. _ et al_. experimental measurement - device - independent quantum key distribution .",
    "_ _ * 111 * , 130502 ( 2013 ) .",
    "bennett , c. h. quantum cryptography using any two nonorthogonal states .",
    "_ _ * 68 * , 3121 ( 1992 ) .",
    "inoue , k. , waks , e. & yamamoto , y. differential phase shift quantum key distribution .",
    "_ _ * 89 * , 037902 ( 2002 ) .",
    "gisin , n. towards practical and fast quantum cryptography .",
    "_ arxiv : quant - ph/_0411022 .",
    "scarani , v. , acin , a. , ribordy , g. & gisin , n. quantum cryptography protocols robust against photon number splitting attacks for weak laser pulse implementations . _ _ * 92 * , 057901 ( 2004 )",
    ".    sasaki , m. _ et al .",
    "_ field test of quantum key distribution in the tokyo qkd network .",
    "express _ * 19 * , 10387 ( 2011 ) .",
    "huttner , b. , imoto , n. , gisin , n. & mor , t. quantum cryptography with coherent states .",
    "a _ * 51 * , 1863 ( 1995 ) .",
    "brassard , g. , ltkenhaus , n. , mor , t. & sanders , b. c. limitations on practical quantum cryptography .",
    "_ _ * 85 * , 1330 ( 2000 ) .",
    "tamaki , k. & lo , h. k. unconditionally secure key distillation from multi - photons .",
    "_ _ * 73 * , 010302(r ) ( 2006 ) .",
    "koashi , m. security of quantum key distribution with discrete rotational symmetry .",
    "_ arxiv : quant - ph/_0507154 .",
    "bennett , c. h. , divincenzo , d. p. , smolin , j. a. & wootters , w. k. mixed state entanglement and quantum error correction .",
    "_ _ * 54 * , 3824 ( 1996 ) .",
    "chefles , a. unambiguous discrimination between linearly independent quantum states .",
    "lett . a _ * 239 * , 339 ( 1998 ) .",
    "chefles , a. unambiguous discrimination between linearly dependent states with multiple copies .",
    "_ _ * 64 * , 062305 ( 2001 )",
    ".    gottesman , d. , lo , h. k. , ltkenhaus , n. , & preskill , j. security of quantum key distribution with imperfect devices .",
    "_ quantum information and computation _ * 5 * , 325 ( 2004 ) .",
    "gobby , c. , yuan , z. l. & shields , a. j. quantum key distribution over 122 km of standard telecom fiber . _",
    "phys . lett .",
    "_ * 84 * , 3762 ( 2004 ) .    lo , h. k. , ma , x. , & chen , k. decoy state quantum key distribution .",
    "_ _ * 94 * , 230504 ( 2005 ) .",
    "fung , c. h. f. , tamaki , k. , & lo , h. k. on the performance of two protocols : sarg04 and bb84 .",
    "_ _ * 73 * , 012337 ( 2006 ) .",
    "li , z. , zhang , y. c. , xu , f. , peng , x. , & guo , h. continuous - variable measurement - device - independent quantum key distribution .",
    "_ arxiv_:1312.4655 .",
    "azuma , k. weighted sums of certain dependent random variables .",
    "_ tohoku math .",
    "j. _ * 19 * , 357 ( 1967 ) .",
    "here we describe the details of our simulation .",
    "the quantum efficiency and the dark counting of the detectors are @xmath121 and @xmath122 , respectively .",
    "the loss coefficient of the quantum channel is @xmath123db / km . we denote @xmath252 and @xmath253 .",
    "we define that @xmath254 is a probability that the photons are detected as the successful event of type @xmath23 conditioned that alice and bob emit @xmath1 and @xmath57 photons in the states @xmath255 and @xmath256 for @xmath257 , respectively .",
    "@xmath258 is the probability of the successful detection of type @xmath23 conditioned that alice and bob emit photons in @xmath255 and @xmath256 , respectively . assuming that eve is in the middle of alice and bob , the channel transmittance to eve from alice is the same as that from bob .",
    "denoting that @xmath259 is the distance between alice and bob , the channel transmittance for alice and bob is @xmath260 in the following , we give the experimental data for the simulation ( i ) when eve postselects the events with @xmath77 and @xmath78 by the qnd measurement before mixing the pulses from alice and bob  ( see fig .",
    "2(a ) ) , and ( ii ) when alice and bob use quasi single photon sources by the spdc  ( see fig .",
    "2(b ) ) .",
    "each of alice and bob uses a phase randomized weak coherent pulse with the mean photon number of @xmath261 .",
    "the probability @xmath262 for @xmath1-photon emission is @xmath263 for later use , we define the equations @xmath264 in the following , we give @xmath265 and @xmath266 .          from ref .",
    "@xcite , the probability distribution function of the thermal state conditioned that the detector @xmath79 clicked in fig .",
    "2(b ) is @xmath271 where @xmath272 is the probability that the detector @xmath79 clicks , which is described by @xmath273 by defining @xmath274 , the probability that @xmath1 photons exist before the bs conditioned on the click of @xmath79 is @xmath275    for type1 , the relevant equations for @xmath276 and @xmath277 are expressed by @xmath278 where @xmath279 we note that in equation  ( [ eq : pes ] ) , we took the pessimistic scenario that all of the events for @xmath75 and @xmath76 are detected as the bit error . here",
    "@xmath280 are given by @xmath281"
  ],
  "abstract_text": [
    "<S> the measurement - device - independent quantum key distribution  ( mdi qkd ) was proposed to make bb84 completely free from any side - channel in detectors . </S>",
    "<S> like in prepare & measure qkd , the use of other protocols in mdi setting would be advantageous in some practical situations . in this paper </S>",
    "<S> , we consider sarg04 protocol in mdi setting . </S>",
    "<S> the prepare & measure sarg04 is proven to be able to generate a key up to two - photon emission events . in mdi </S>",
    "<S> setting we show that the key generation is possible from the event with single or two - photon emission by a party and single - photon emission by the other party , but the two - photon emission event by both parties can not contribute to the key generation </S>",
    "<S> . on the contrary to prepare & measure sarg04 protocol where the experimental setup is exactly the same as bb84 , the measurement setup for sarg04 in mdi setting can not be the same as that for bb84 since the measurement setup for bb84 in mdi setting induces too many bit errors . to overcome this problem , we propose two alternative experimental setups , and we simulate the resulting key rate . </S>",
    "<S> our study highlights the requirements that mdi qkd poses on us regarding with the implementation of a variety of qkd protocols .    </S>",
    "<S> the security of quantum key distribution  ( qkd ) can be guaranteed based on some mathematical models of the users devices  @xcite . </S>",
    "<S> unfortunately , the actual devices do not necessarily follow mathematical models , and we need to close the gap  ( side - channel ) between the actual device and the mathematical model to implement secure qkd systems in practice . among side - channels , </S>",
    "<S> the side - channel of a photon detector seems to be most easily exploited by an eavesdropper  ( eve ) since it accepts any input from eve who can generate an arbitrary optical state such that it causes an unexpected behavior in the detector . </S>",
    "<S> in fact , the famous bright - pulse illumination attacks are based on side - channel in detectors  @xcite . in order to countermeasure such attacks , measurement - device - independent  ( mdi ) qkd  @xcite </S>",
    "<S> was proposed to make bb84  @xcite free from any possible side - channel in a detector . in mdi qkd </S>",
    "<S> , alice and bob do not perform any measurement but only send quantum signals to be measured by eve . therefore </S>",
    "<S> , bit strings generated by alice and bob are free from side - channels in photon detectors since they do not employ photon detectors . since its invention , mdi qkd has been actively studied both theoretically  @xcite and experimentally  @xcite .    as is the case in prepare & measure scheme , implementation of protocols other than bb84 in mdi </S>",
    "<S> setting could be suitable for some practical situations . </S>",
    "<S> in fact , many experiments for non - bb84 type prepare & measure schemes , including b92  @xcite , dps qkd  @xcite , coherent one - way protocol  @xcite , sarg04  @xcite , etc , have been reported  @xcite . therefore , it is useful in practice to use non - bb84 type protocols in mdi setting , and in this paper we consider to use sarg04 protocol in mdi setting , which we refer to as mdi sarg04 . </S>",
    "<S> sarg04 was originally proposed to make bb84 robust against photon number splitting ( pns ) attacks  @xcite just by changing the classical post - processing part in bb84 . </S>",
    "<S> it is proven that sarg04 can indeed generate a key from two - photon emission event by alice in addition to single - photon emission event  @xcite , showing robustness against pns attack in some parameter regimes . note in mdi setting is that both alice and bob are the sender of the signals , and as a result , the information leakage from the signals seems to be larger than the one in prepare & measure setting . </S>",
    "<S> therefore , it is not trivial whether both single and two - photon emission events can contribute to the key generation or not . </S>",
    "<S> our work answers this question , and we have found that the single - photon emission event by both alice and bob , or single - photon and two - photon emission by each of alice and bob can contribute to generating a key , but two - photon emission by the two parties can not make the contribution when a probability of eve s announcement of the successful measurement for the two - photon emission event is smaller than 1/16 .    </S>",
    "<S> another important issue to be addressed in mdi setting is what kind of measurement setup should be implemented experimentally at eve s laboratory . naively thinking , as sarg04 differs from bb84 only in the post - processing part , the same measurement setup for mdi bb84 should also work for mdi - sarg04 protocol . on the contrary , however , it turns out that the measurement setup for mdi bb84 results in high bit error rate when applied to mdi - sarg04 protocol , and consequently , no significant key can be generated . to generate a key in practice </S>",
    "<S> , we propose two alternative measurement schemes for the mdi - sarg04 protocol , and simulate the resulting key generation rate . </S>"
  ]
}