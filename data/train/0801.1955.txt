{
  "article_text": [
    "the current paradigm of large scale structure formation in the universe is hierarchical , meaning that structures are formed by merger aggregation .    the dominant driver for this merger dynamic is thought to be the non - baryonic and non - collisional cold dark matter .",
    "therefore , research in large scale structure formation is principally done through the study of dark matter structures , which on large scales are thought to serve as scaffolding for baryonic structures @xcite .",
    "the dark matter merger process has been usually represented by a tree , keeping the analogy with the genealogical tree of an individual .",
    "great effort has been put into the methods of construction of merger trees , as they are a way to understand dark matter aggregation and are a necessary input for codes of semi - analytic galaxy formation .",
    "the methods range from the analytical approach of monte - carlo methods ( @xcite for a review ) passing through hybrid approaches that mix numerical realizations of a density field with analytical approximations for its evolution @xcite to the fully numerical approach that identifies the dark matter halos from different snapshots in a @xmath4-body simulation to construct the merger history@xcite .",
    "usually , the validity of the trees constructed in the analytical and hybrid way is stated from comparisons with trees constructed from numerical simulations @xcite .",
    "unfortunately , the quantities used to compare trees from two approaches usually sacrifice the complexity inherent to the tree structure in the sake of simple tests . the most common simplification is to select one branch of the tree ( the most massive ) to make the analysis .",
    "another approach , measures the abundance of structures of a given mass among the halos in all the merger tree .",
    "in all these cases the geometrical information is suppressed , mostly because of the lack of simple structures to describe that kind of information .    in this paper",
    "we present a new way , in the astrophysical context , to translate the geometrical information from a merger tree into a 1-dimensional structure .",
    "the translation is based on the encoding of the tree information into its _",
    "contour walk_.    we apply this description to the merger trees from a large dark matter numerical simulation , the millennium run @xcite .",
    "we use its public database to select halos in different bin masses at redshift @xmath5 to extract its merger histories and build the contour walk .",
    "we analyze each tree in terms of two simple statistics extracted from these walks .",
    "we have also performed this kind of analysis on merger trees obtained with the algorithm described by @xcite , using the source code they kindly made public . with this code",
    "we have constructed trees with two resolutions for the minimum mass halo , one mimicking the millennium run , and the other with nearly @xmath6 times lower resolution .",
    "this paper is divided as follows . in section 2",
    "we explain the construction of a contour walk from a merger tree . in section 3",
    "we present the simulation that produced the public data we used in this paper and the monte carlo code for the construction of markovian merger trees . in section 4",
    "we perform an immediate implementation of these concepts to the available merger trees .",
    "we calculate global statistics from the walks , and discuss its possible physical meaning . in the last section we discuss our results and suggest how the tool we have proposed can be used to tackle more complex questions about merger trees .",
    "the merger trees in the current dark matter paradigm are simple , as only merging is allowed . from the mathematical point of view",
    "this tree structure corresponds to a galton - watson tree .",
    "galton - watson trees are genealogical trees of a population that evolves according to very simple rules . at generation @xmath7 , the population starts with one individual , called the ancestor .",
    "then each individual in the population has , independently of the others , a random number of children according to an offspring probability distribution . in the structure formation context",
    "we identify the ancestor with the halo at redshift zero , and the offsprings with the parents of the halo .",
    "these trees can be coded by a discrete path around the contour of the tree @xcite .",
    "this _ contour process _ is easy to visualize .",
    "we imagine the displacement of a particle that starts at time zero from the root of the tree ( a halo at redshift zero ) and then visit the first not yet visited parent halo , if any , and if none , the successor of the halo .",
    "we do so until all the members in the tree have been explored and the particle has come back to the origin .",
    "this process is illustrated in the fig.[contorno ] . where the different values of @xmath8 correspond to the discrete snapshots for which we have the halo information , and @xmath9 is the imaginary time giving the pace of the particle around the tree .",
    "we point out that one has to define some order between the halos at a given point in the tree in order to define a unique way to walk the tree , a criteria to decide to which parent should jump the particle .",
    "this ordering criterium in our case is naturally imposed by the masses of the halos , as we always visit first the most massive progenitor .",
    "we can express this as visiting all the halos in the tree in a depth - first fashion , visiting first the most massive branch at every time .",
    "( horizontal lines ) , time flowing from top to bottom .",
    "we start from the last halo at the bottom , and visit the halos in the tree at unit timesteps @xmath10 .",
    "the most massive progenitor is always visited first .",
    "we go around until we go back to the initial point .",
    "the bottom part of the figure shows the contour walk , its values correspond to the time @xmath8 where the particle was located at time @xmath11 .",
    "the tree structure can be recovered completely from the contour walk as indicated by the solid lines in the lower panel . ]",
    "the millennium run @xcite ( mr hereafter ) was carried out by the virgo consortium in 2004 at the max planck s society s supercomputer center in garching .",
    "it is a dark matter only simulation containing @xmath12 particles , it was evolved from @xmath13 to the present - day inside a cubic region of @xmath14 mpc h@xmath15 on a side , the individual particle mass is @xmath16 m@xmath17 .",
    "it adopted @xmath18 , @xmath19 for the current densities of dark matter and baryons in a lambda cold dark matter cosmological model , furthermore it used @xmath20 for the present dimensionless value of the hubble constant , @xmath21 for the _ rms _ linear mass fluctuation in a sphere of radius @xmath22mpc extrapolated to @xmath5 , and @xmath23 for the slope of the primordial fluctuation spectrum .",
    "the simulation was run using the tree - pm n - body code gadget2 @xcite , 64 outputs were stored at times spaced approximately equally in the logarithm of the expansion factor at early times and at approximately @xmath24 myr intervals after @xmath25 . at run time",
    "all collapsed halos with at least @xmath26 particles ( @xmath27 m@xmath17 ) were identified using a friends - of - friends ( fof ) @xcite group - finder with linking length @xmath28 .",
    "post processing with the substructure algorithm subfind @xcite allowed a detection and measurement of the resolved sub - halos .",
    "this in turn allowed trees to be built with detailed assembly histories for every object and its substructure .",
    "the postprocessed data have been publicly disseminated through an interactive database : http://www.g-vo.org/millennium/mydb .",
    "the particular structure of the database design which allows efficient querying for merger trees was implemented by @xcite .",
    "conveniently enough , the structure for merger trees in the database is based on a depth - first ordering , making that the output of a tree query is an incomplete version of the contour walk in terms of the lower panel in fig.[contorno ] , only the upward arrows offspring - progenitor exist .",
    "the authors @xcite recently proposed and algorithm for the construction of merger trees based on a markovian approach .",
    "this approach to merger trees means that any halo of a given mass @xmath29 at time @xmath8 has a progenitor probability distribution depending only on @xmath29 and @xmath8 .",
    "this scheme is explicitly independent of the large scale environment that could be defined for a halo .",
    "their merger trees are parameterized by a time variable @xmath30 and a mass variable @xmath31 , where @xmath32 and @xmath33 is the cosmological linear growth rate and @xmath34 is the variance of the initial density fluctuation field , linearly extrapolated to @xmath5 and smoothed using a window function that corresponds to a mass @xmath29 .",
    "these two variables are also the natural variables in the extended press - schechter formalism @xcite .",
    "their approach is the following .",
    "first , from the mr data they find the conditional probabilities for the masses of the main progenitors at a past time @xmath35 as a function of halo mass @xmath29 at a present time @xmath8 . with this",
    "conditional probabilities they build the main progenitor history which by construction reproduce to a good extent the mr data .",
    "then , they extended this approach to the construction of a full merger tree .",
    "the extension included some additional heuristic rules based again on the premise of a fair match to the total progenitor number density @xmath36 from the millennium run data .",
    "nevertheless , the lack of a true physical motivation can not ensure the reconstruction of the correct full joint distribution of progenitors .",
    "even if n - body merger trees are not markovian , the proposed algorithm manages to reproduce some tree properties , specially those related with the main progenitor but also the total mass distribution in all the progenitors .",
    "the detected inaccuracies come from the fact that the estimation of the average mass for the second progenitor is not reliable .    in spite of that",
    ", we have decided to use these author s public available code given its explicit effort to reproduce the mr data .",
    "we make use of two kind of trees .",
    "trees extracted from the mr public data base and trees constructed with the public code implementing the markovian approach . in both cases we concentrate on halos with masses greater than @xmath0m@xmath17 .    for the mr trees we selected all the halos in the simulation box with a given mass @xmath37 m@xmath38 at redshift @xmath5 , for @xmath39 different values of @xmath40 in bins of width @xmath41 dex , where @xmath42 is the halo mass measured within the radius where the halo has an overdensity @xmath24 times the critical density of the simulation .",
    "the bins are spaced by @xmath43 dex , the least massive bin corresponds to @xmath44 and has @xmath45 dark matter halos and the most massive bin corresponds to @xmath46 and has @xmath47 dark matter halos .",
    "we also performed measurements for the @xmath48 most massive bins with @xmath49dex , which provided us with nearly five times more halos per bin .",
    "the results we obtained in that case are basically the same than in the case @xmath41 . in this paper",
    "we only report and discuss the results for the selection with the smaller @xmath50 sample .    for the markovian trees we made two different runs changing the minimal halo mass .",
    "the first one mimicked the mr and its minimal mass was @xmath51 m@xmath17 .",
    "the second run used a higher minimal mass of @xmath52 m@xmath1 .",
    "we will refer to these runs as the high resolution and low resolution runs , respectively . in both cases we also constructed merger trees for halo mass bins spaced by @xmath43 dex .",
    "the mass bins for the high resolution run are the same as in the mr case , for the low resolution run we can only describe trees from the bin @xmath53 up to @xmath46 . for each bin",
    "we construct @xmath54 trees , each one with @xmath55 steps in @xmath56 with @xmath57 . which is equivalent to have trees described from redshifts @xmath58 .",
    "the snapshots in the dark matter simulation will be labeled by @xmath59 , where @xmath60 ranges from @xmath7 to @xmath61 .",
    "the snapshot @xmath62 corresponds to the @xmath5 .",
    "we select a halo in the snapshot @xmath62 to extract its merger tree . the contour walk , as described in section [ sec : trees ] ,",
    "can be visualized as a dynamical process of a particle going around the tree , at unit time - steps stopping at each node in the tree and recording the snapshot @xmath63 to which it belongs .",
    "the discrete variable counting the imaginary time of the particle walking the tree is noted @xmath64 .    we write the walk as a sequence of discrete values @xmath65 ,",
    "corresponding to different values of the discrete intermediary times @xmath66 , @xmath4 is the total length of the walk , and every @xmath67 can take values from the possible snapshots @xmath68 . in the case of",
    "the markovian trees the values the walk can take vary from @xmath69 to @xmath70 , consistent with the fact that we have described these trees at @xmath55 points equally spaced by @xmath71 .    for each merger tree",
    "we compute two statistics : its length and action .",
    "the length corresponds to the number of points in the walk .",
    "the action , which will be defined later , is an statistic based on the first derivatives of the walk .",
    "we offer in fig.[examples ] , a feeling on the merger walks for halos in four different mass bins .",
    "the figure [ longhalo ] shows the walk length for halo merger trees as a function of halo mass . at low masses where the growth should be dominated by mass accretion and not by mergers , @xmath72 . at high masses where the growth starts to be controlled by mergers @xmath73 .",
    "the transitional scale corresponds to halos for a halo mass @xmath74m@xmath1 .",
    "this transitional scale should depend on the resolution of the dark matter simulation .",
    "when smaller halos are resolved , the merger trees will be populated with more branches of this lower mass halos , and one could start to see that all the growth is done trough mergers .    nevertheless , if we intend to study galaxy formation using merger trees , this suggested transitional scale may have some significance . in the favored paradigm of galaxy formation ,",
    "not every halo can harbor galaxies at a cosmic epoch . only halos that can cool",
    "efficiently the gas may hold star forming galaxies .",
    "a lower limit is imposed by the uv background from star formation , which sets a low baryonic fraction in halos of masses below @xmath75m@xmath1 , which is roughly the minimal resolution for halo detection in the millennium run .",
    "if one aims to study galaxy formation , the uv background sets naturally a minimal mass of the progenitors that should be included in the merger history of a dark matter halo . in any case",
    ", we decided to explore the influence of the resolution using the results from the monte - carlo code .    in the case of merger trees constructed with a resolution mimicking the mr we find again a transitional scale ( fig.[longhalo_markov ] ) around @xmath76m@xmath1 .",
    "the biggest difference in comparison with the @xmath4-body results are the exponents describing the length of the walk as a function of halo mass . in the monte carlo case",
    "both exponents are closer to @xmath77 .",
    "this results would favor a view from which there is still room left for a better description of smooth accretion into the markov description .     _",
    "upper panel _ walk length @xmath78 for halo merger trees extracted from the millennium run as a function of the logarithm of the final halo mass .",
    "the solid lines show two different power law trends for the relation @xmath79 , @xmath80 and @xmath81 .",
    "the intersection of the two lines is located at @xmath82m@xmath1 .",
    "the dashed line simply passes through the two extreme mass points in the plot .",
    "_ lower panel _ the same results as in the upper panel , but this time the measured values are normalized to the functional dependence of the dashed line in the upper panel .",
    "this enhances the features in the curve and allows an easier determination of the transitional mass - scale.,title=\"fig : \" ]   _ upper panel _ walk length @xmath78 for halo merger trees extracted from the millennium run as a function of the logarithm of the final halo mass .",
    "the solid lines show two different power law trends for the relation @xmath79 , @xmath80 and @xmath81 .",
    "the intersection of the two lines is located at @xmath82m@xmath1 .",
    "the dashed line simply passes through the two extreme mass points in the plot .",
    "_ lower panel _ the same results as in the upper panel , but this time the measured values are normalized to the functional dependence of the dashed line in the upper panel .",
    "this enhances the features in the curve and allows an easier determination of the transitional mass - scale.,title=\"fig : \" ]     _ _ upper panel__same as fig.[longhalo ] for merger trees constructed with the markovian algorithm .",
    "black symbols show the high resolution run , and white symbols the low resolution run . _",
    "upper panel _",
    "the lines show again two different power law trends for the relation @xmath83 , @xmath84 and @xmath85 .",
    "this is more steeper than the @xmath86 found in the millennium merger trees .",
    "_ lower panel _ the transitional mass - scale is roughly located at @xmath87m@xmath1 with a weak dependence on the run s resolution .",
    "the dispersion for the measurements from the markovian trees is noticeably larger than the measurements coming from millennium run data.,title=\"fig : \" ]   _ _ upper panel__same as fig.[longhalo ] for merger trees constructed with the markovian algorithm .",
    "black symbols show the high resolution run , and white symbols the low resolution run . _",
    "upper panel _",
    "the lines show again two different power law trends for the relation @xmath83 , @xmath84 and @xmath85 .",
    "this is more steeper than the @xmath86 found in the millennium merger trees . _",
    "lower panel _ the transitional mass - scale is roughly located at @xmath87m@xmath1 with a weak dependence on the run s resolution .",
    "the dispersion for the measurements from the markovian trees is noticeably larger than the measurements coming from millennium run data.,title=\"fig : \" ]    we extend the statistical description of the contour walk by the quantification of the its waviness .",
    "we borrow from statistical mechanics the concept of action , which is used in the numerical calculation of path integrals @xcite .",
    "the action can be defined as the potential energy invested in bending the path , comparing it with a characteristic temperature . if there is a walk defined by points @xmath88 , the action",
    "is usually defined as @xmath89    where @xmath90 plays the role of a temperature or imaginary time depending on the context .",
    "if we take that definition applied to our case : @xmath91    as we have unit steps , @xmath92 is equal to @xmath93 , making the action @xmath94 equal to the walk length .",
    "therefore , we decide to define a normalized action only from the extreme points in the contour walk . we take this extreme points , @xmath95 , as a sample of the contour walk where the derivative at point @xmath67 , defined as @xmath96 , is equal to zero .",
    "we note the set of times @xmath64 corresponding to the vanishing points of the derivative as @xmath97 ( as in @xmath97xtreme ) .",
    "if we now define the action on the sampled walk @xmath98 @xmath99    which makes the action @xmath94 equal to the walk length divided by the number of extreme points . in the context of merger trees ,",
    "each peak in the walk corresponds to a branch in the tree , making the contribution to the action roughly proportional to the length of that branch .",
    "therefore , the normalized action could be loosely interpreted as a proxy for the mean length of one branch in the tree .          in fig.[actionhalo ]",
    "we show the normalized action as the function of halo mass for the mr and the monte - carlo code . for mr trees",
    "we find a distinction between the behavior of the action for low and high mass halos .",
    "this time the two mass extremes share the same action values , meaning that we can identify the same mean branch length for the two extremes masses . for intermediate masses",
    "the action increases . in the case of the mr trees ,",
    "the action achieves a maximum for a mass scale @xmath100 m@xmath17 . for monte",
    "carlo trees the maximum takes the form of a broader plateau ranging almost two orders of magnitude between @xmath101 m@xmath17 and @xmath102 m@xmath17 .",
    "perhaps the most distinguishing factor between the mr and markovian approach is that the dispersion in the latter is much higher that in the former .",
    "a fact that can be interpreted as a higher variability in the geometry of markovian trees .",
    "we introduced from the mathematical literature the contour process of a tree , and we applied this concept to the description of merger trees .",
    "we used a large dark matter simulation ( the millennium run ) and a monte - carlo code ( implementing a markovian approach ) to obtain merger trees in these two approximations .",
    "furthermore , the markovian trees were obtained with two different values for the minimal mass of a parent halo .",
    "one resolution mimicked exactly the mr , and the other resolution had a @xmath6 times more massive minimal halo mass .",
    "we refer to these markovian runs as the high resolution and low resolution runs respectively .",
    "we extracted simple statistics from these walk : the length @xmath4 ( proportional to the total number of halos in the tree ) and the action @xmath94 ( which can be loosely interpreted as the mean longitude of a branch ) .",
    "we report our results of walk length and action emphasizing its evolution as a function of the physical halo mass , and not its absolute values .    from the length and the action",
    ", we found in the millennium run a transitional mass scale at @xmath103 m@xmath17 . in the case of the walk length , @xmath4 , this transitional mass - scale marks the change between a dependence @xmath72 for low halo masses and @xmath104 for high mass halos , where @xmath29 is the mass of the final dark matter halo in the tree . with the action , the scale marks the highest value for the action as function of the halo mass .",
    "for the markovian trees the dependence of the walk length on the halo mass is almost the same everywhere , although much steeper than the dependence found in the millennium run . nonetheless , we found the same transitional scale from the length statistics for the two resolutions .",
    "it does not prove that the transitional scale is independent on the resolution mass ( in fact , it should be dependent ) but suggests that the scale does not have a strong dependence with the minimal mass resolution used to describe the merger tree .",
    "the evolution of the action as a function of halo mass is completely different from the mr case .",
    "the markovian run with mimicking mr resolution does not show a sharp transitional scale , instead it shows a large plateau ranging for two orders of magnitude in mass .",
    "perhaps the biggest difference between the two ways of constructing the trees is that the markovian approach always show a bigger dispersion on its contour walk statistics , which seem best defined in the millennium run , judging from its low dispersion .",
    "this could be interpreted in fact as a higher geometrical variability in the markovian trees .",
    "we have shown how simple statistics from the contour walk can give a new handle on the description of merger tree , exploring the geometrical information of merger trees .",
    "even if the length of the walk could have been obtained without an intermediating contour process , the approach of extracting information from higher order statistics , as was the case for the normalized action @xmath94 , can be extended in complexity .",
    "for instance , is relevant to point out that the information of the mass in each node is also encoded in the contour walk .",
    "the mass information is used as an ordering criteria to walk the tree .",
    "one could define sections defined by @xmath105 , i.e. the points where the walk touches the next to last snapshot , and the _ length ratio _ of the sections delimited by these points would include information of the _ mass ratio _ of the mergers at time @xmath106 . in general the study of crossing paths , defined as the the section of the contour walks within some boundary @xmath107 might produce useful statistics to further classify the complex merger trees of massive halos .",
    "we thank jrmy blaizot ( jb ) and gerard lemson ( gl ) for early discussions , motivation and criticism around the ideas presented here .",
    "we thank jb s suggestion on pointing the discussion towards a comparison with markovian merger trees .",
    "we thank again gl for his amazing day - to - day work on the public millennium database .",
    "we also thank the authors neistein and dekel for making public a well documented and easy to use code for merger tree construction .",
    "the necessary infrastructure to develop this work was provided in the framework of the horizon project ( france ) .",
    "g. , springel v. , 2006 , in gabriel c. , arviset c. , ponz d. , enrique s. , eds , astronomical data analysis software and systems xv vol .",
    "351 of astronomical society of the pacific conference series , cosmological simulations in a relational database : modelling and storing merger trees .",
    "pp 212+                v. , white s.  d.  m. , jenkins a. , frenk c.  s. , yoshida n. , gao l. , navarro j. , thacker r. , croton d. , helly j. , peacock j.  a. , cole s. , thomas p. , couchman h. , evrard a. , colberg j. , pearce f. , 2005 , nature , 435 , 629"
  ],
  "abstract_text": [
    "<S> we introduce the contour process to describe the geometrical properties of merger trees . </S>",
    "<S> the contour process produces a one - dimensional object , the contour walk , which is a translation of the merger tree . </S>",
    "<S> we portray the contour walk through its length and action . </S>",
    "<S> the length is proportional to to the number of progenitors in the tree , and the action can be interpreted as a proxy of the mean length of a branch in a merger tree .    </S>",
    "<S> we obtain the contour walk for merger trees extracted from the public database of the millennium run and also for merger trees constructed with a public monte - carlo code which implements a markovian algorithm . </S>",
    "<S> the trees correspond to halos of final masses between @xmath0 m@xmath1 and @xmath2 m@xmath1 . </S>",
    "<S> we study how the length and action of the walks evolve with the mass of the final halo . </S>",
    "<S> in all the cases , except for the action measured from markovian trees , we find a transitional scale around @xmath3 m@xmath1 . as a general trend </S>",
    "<S> the length and action measured from the markovian trees show a large scatter in comparison with the case of the millennium run trees .    </S>",
    "<S> [ firstpage ]    cosmology : theory , cosmology : dark matter </S>"
  ]
}