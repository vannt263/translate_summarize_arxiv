{
  "article_text": [
    "newton s law of gravitation is one of the fundamental laws in the universe that holds everything together .",
    "although formulated in the 17th century , scientists today still study the consequences , in particular those of many - body systems , like the solar system , star clusters and the milky way galaxy .",
    "general analytic solutions to the n - body problem only exist for configurations with one mass , commonly referred to as @xmath0 solutions , and for two masses ( equivalently named @xmath1 , @xcite ) .",
    "problems for @xmath2 can be reduced via liouville s theorem for hamiltonian systems to the collisionless boltzmann equation ( * ? ? ?",
    "* ; * ? ? ?",
    "* but see also @xcite ) , and therefore analytic solutions for the global distribution function exist .",
    "solutions for @xmath3 in between these two limits are generally realized by computer simulations .",
    "these so - called @xmath3-body simulations have a major shortcoming in that the solution to any initial realization can only be approximated .",
    "the main limiting factors in numerically obtaining a true solution include errors due to round - off and approximations both in the integration and in the time - step strategy @xcite .",
    "these generally small errors are magnified by the exponentially sensitive dependence on the 6n - dimensional phase - space coordinates , position and velocity @xcite . as a consequence ,",
    "the solution for a numerically integrated self - gravitating system of @xmath3 masses diverges from the true solution .",
    "this error can be controlled to some degree by selecting a phase - space volume preserving or a symplectic algorithm @xcite and by reducing the integration time step .",
    "the latter however , can not be reduced indefinitely due to the accumulation of numerical round - off in the mantissa , which is generally limited to 53 bits ( 64 bits in total , but 11 bits are reserved for the exponent , resulting in only about 15 significant digits ) .",
    "the exponential divergence subsequently causes this small error to propagate to the entire system on a dynamical time scale @xcite , which is the time scale for a particle to cross the system once .",
    "the result of these errors together with the exponential divergence , is the loss of predicting power for a numerical solution to a self gravitating system with @xmath4 after a dynamical time scale .",
    "one can subsequently question the predicting qualities of @xmath3-body simulations for self - gravitating systems , and therewith their usefulness as a scientific instrument .",
    "we address this question for @xmath5 by brute - force numerical integration to arbitrary precision .",
    "the choice of @xmath5 is motivated by the realization that this represents the first fundamental irregular configuration with the smallest possible number of objects that can not be solved analytically and can not be addressed with collisionless theory .",
    "in addition , 3-body encounters form a fundamental and frequently occurring topology in any large @xmath3-body simulation , and therefore also drive the global dynamics of these larger systems .",
    "the divergence between two different , approximate solutions to the @xmath3-body problem can be quantified by the phase - space distance in the positions @xmath6 and velocities @xmath7 of the @xmath3 particles ( in dimension - less n - body units ) : @xmath8.\\ ] ] values of @xmath9 are obtained by comparing the configurations from solution @xmath10 and solution @xmath11 at any moment in time .",
    "each star has a position and velocity in solution a and ( generally ) a different position and velocity in solution b. for each star we calculate its phase - space distance between the two solutions . by dividing by @xmath12 , @xmath9 can be thought of as the average difference per coordinate .",
    "the two different runs can be performed either with the same code at a different precision , or with two different codes , all having exactly the same initial realization .",
    "a value of @xmath13 indicates that the results of the two simulations have diverged beyond recognition .",
    "we consider a solution to be converged to @xmath14 decimal places when , for any time @xmath15 , @xmath16 .",
    "( in stable hierarchical few - body systems the value of @xmath9 can vary substantially across the orbital phase @xcite , and one has to assure that temporary large deviations can diminish again at a later instant . )    to investigate the build - up of numerical errors and the corresponding exponential divergence , we developed an @xmath3-body solver for self - gravitating systems which solves the n - body problem to arbitrary precision .",
    "this code , named brutus ( boekholt & portegies zwart , in preparation ) , is composed of a bulirsch - stoer integrator @xcite , that preserves energy to the level of the bulirsch - stoer tolerance . this tolerance is a parameter which can be interpreted as the discretization error per integration step .",
    "the round - off error is controlled by choosing the word - length with which all floating point numbers in the computer code are represented . by decreasing the bulirsch - stoer tolerance and increasing the word - length",
    ", we can obtain solutions to the n - body problem to arbitrary precision .",
    "we tested brutus by adopting a 3-body system of identical particles , which are located on the vertices of an equilateral triangle , with initial velocities such that the orbits are on a circle around the center of mass @xcite . because this system is intrinsically unstable , small perturbations in the position and velocity vectors cause the triangular configuration to dissolve quickly .",
    "the time at which this happens depends on precision . using brutus we can reach arbitrary precision , but in this validation experiment we stopped reducing the time step and increasing the word length once the energy was conserved up - to 75 decimal places , which is sufficient to demonstrate our point . for any pre - determined time of stability there is a combination of word - length and bulirsch - stoer tolerance for which brutus converges .",
    "we define a solution to be converged when the first @xmath14 decimal places become independent of the size of the time step and the word length .",
    "this is equivalent to saying that @xmath9 is always below @xmath17 ; for @xmath18 ( at least the first 3 digits have converged ) , then @xmath19 at all times .",
    "having established the possibility of integrating a self - gravitating @xmath3-body system to arbitrary precision we can study the reliability of n - body simulations in general .",
    "we limit ourselves to the problem of 3 bodies , by generating a database of different 3-body problems and solve them until a converged solution is achieved .",
    "the positions of the particles are taken randomly from a @xcite distribution and are either cold ( zero kinetic energy ) or virialized . in the cold case we assured ourselves that the mutual distances between the particles are initially comparable ( within an order of magnitude ) .",
    "we performed runs with identical masses and with the masses in a ratio of 1:2:4 .",
    "for each of the four selected ensembles of initial conditions we generated 10@xmath20 random realizations .",
    "the masses and coordinates for these systems are specified in standard double precision , to assure that the double - precision calculations use exactly the same initial realizations as the arbitrary - precision calculations .",
    "every initial condition is integrated using the leapfrog - verlet ( @xcite , we adopted the implementation available in http://nbabel.org ) and the 4th - order hermite predictor - corrector scheme in a code called ph4 @xcite .",
    "( both codes , brutus and ph4 are assimilated in the public amuse framework which is available at http://amusecode.org , @xcite ) .",
    "the integration continues until the system has been dissolved into a permanent binary and a single escaper @xcite .",
    "dissolution is declared upon the first integral dynamical time upon which one particle is unbound , outside a sphere of 2 initial virial radii around the barycenter , and receding from the center of mass @xcite .",
    "a particle is considered unbound if its kinetic energy in the center of mass reference frame exceeds the absolute value of its potential energy , which is more strict than adopted in @xcite . for a fraction of the simulations",
    "( see fig.[fig : fdissolved ] ) , the dissolution time turns out to be very long as the evolution consists of a sequence of ejections where a particle almost escapes , but then still returns to once again enter a 3-body resonance .",
    "we therefore put a constraint on the integration time and use the fraction of long - lived systems as a measurable statistic .",
    "we obtain ensembles of solutions using the hermite and leapfrog integrators with a time - step parameter @xmath21 .",
    "here we adopted the definition for @xmath22 given by .",
    "we subsequently recalculate each of these initial realizations with brutus using the same tolerance . in subsequent calculation",
    "we systematically reduce the time - step size and increase the word - length until we obtain a converged solution ( as we discussed in ",
    "[ sect : validation ] for @xmath18 ) for every realization of the initial conditions .",
    "this converged solution is then compared to the earlier simulations performed with the hermite and leapfrog integrators .",
    "we now have three solutions for each initial realization of the 3-body problem , one of which is the converged solution .",
    "we compare the three solutions for the time of dissolution , the semi - major axis ( or equivalently the reciprocal of the orbital energy ) of the surviving binary , its eccentricity ( equivalent to the angular momentum ) and the escaper s velocity and direction .    in fig.[fig :",
    "timescatter ] we individually compare the time to dissolution for a certain initial realization as given by the hermite integrator and the converged solution as given by brutus .",
    "about half of the individual hermite solutions lie along the diagonal representing the accurate solutions .",
    "the other half is scattered around the diagonal .",
    "these solutions have diverged away from the converged solution , producing a binary and an escaper with completely different properties . for dissolutions within @xmath23 dynamical times",
    ", there is insufficient time for the solution to diverge and the results of the various numerical methods are consistent .",
    "but once the hermite or leapfrog solutions have diverged away from the converged solution the entire parameter space of the numerical experiment is sampled .",
    "a similar statement holds when instead of comparing the dissolution time , we compare the properties of the binaries or the escapers .    ) is on the ordinate and the converged value given by brutus on the abscissa .",
    "about 50@xmath24 of the data points lie on the diagonal which represents the cases for which hermite and brutus gave very similar results .",
    "the scatter around the diagonal is symmetric . for very short dissolution times ( @xmath2510 dynamical times )",
    ", there is insufficient time to grow errors and the results are in agreement .",
    "once the divergence becomes important the hermite integrator can return any value allowed in the experiment irrespective of the converged dissolution time .",
    "[ fig : timescatter ] ]    in fig.[fig : cumulativeerror ] we present the cumulative distribution function of the difference between the time to dissolution of the hermite and brutus calculations : @xmath26 for three different values of @xmath27 , @xmath28 and @xmath29 .",
    "the differences for @xmath30 are symmetric around the origin with a dispersion of @xmath31-body time units , but for @xmath32 it is not symmetric .",
    "the distributions in the differences in semi - major axis , eccentricity and the direction of the escaper ( polar and azimuthal angle with respect to the binary plane ) at the time we stop the experiment for @xmath33 down to @xmath34 are symmetric with respect to the origin .",
    "the global distributions are statistically indistinguishable via a kolmogorov - smirnov test .",
    "we empirically determine that for a value of the time - step parameter @xmath28 the majority of the ensemble conserves energy to better than 1/10 .",
    "( solid ) , @xmath28 ( dashes ) and @xmath29 ( dotted curve ) .",
    "the black curves give the distribution where the interaction calculated with hermite lasted longer , and the red curves give the absolute value for the cases where converged solutions gave the longest lifetime for the interaction . each ( black - red ) pair of curves for @xmath35 is statistically indistinguishable , and the mean difference is centered around the origin .",
    "[ fig : cumulativeerror ] ]    in fig.[fig : fdissolved ] we present the fraction of undissolved systems in time .",
    "the colored symbols give the converged solutions , whereas the curves give the results obtained using the hermite integrator .",
    "the two solutions for each ensemble of initial realizations for @xmath30 ( as well as those obtained with the leapfrog integrator , not shown ) are statistically indistinguishable after comparing @xmath36 realizations of the initial conditions .",
    "the distributions obtained using @xmath37 are not symmetric .",
    "the duration of stability was studied as a function of accuracy by @xcite using the sitnikov problem @xcite .",
    "they found that the remaining time for the system to stay bound depends on the integration accuracy .",
    "our simulations did not reveal this effect , because we study systems that dissolve on a much shorter time - scale .    .",
    "the virialized plummer sphere with identical masses is represented by the black bullets , and with the range in masses as red triangles .",
    "the blue squares and green stars give the results for the cold plummer distribution without and with different masses , respectively .",
    "the results of the runs with hermite are statistically indistinguishable from those with brutus . up - to @xmath38",
    "each of the four curves can be approximated with exponential decay with a half - life time of 95 , 63 , 42 and 26 crossing times ( from top to bottom ) .",
    "[ fig : fdissolved ] ]",
    "the properties of the binary and the escaper of a three - body system can be described in a statistical way .",
    "this is consistent with the findings in previous analytic @xcite and numerical @xcite studies .",
    "this behavior was named quasi - ergodicity by @xcite .",
    "we confirm that this behavior remains valid also for converged 3-body solutions .    based on the symmetry of the distribution in dissolution times ( see fig.[fig : cumulativeerror ] )",
    ", the final parameters of the binary and escaper , as well as the consistency of the mean and median values of the inaccurate simulations when compared to the converged solution ( see fig.[fig : cumulativeerror ] and fig.[fig : fdissolved ] ) we argue that global statistical distributions are preserved irrespective of the precision of the calculation as long as energy is preserved to better than 1/10th of the initial energy of the system .",
    "although we have tested only three algorithms for solving the equations of motion we conjecture that the statistical consistency may be preserved also for some other direct @xmath39 methods , and these may also require that energy and angular momentum are preserved to @xmath40th . if such direct @xmath3-body methods comply to the same statistical behavior for collision - less ( @xmath41 ) systems , it will be interesting to investigate how also other non-@xmath39 algorithms , like the hierarchical tree - method @xcite or particle - mesh methods @xcite behave in this respect .    in studies of self - gravitating systems which adopt the 4th order hermite integrator , energy and angular momentum",
    "are generally conserved up to @xmath42 per dynamical time . only those simulations in which this requirement is met",
    "are often considered reliable and suitable for scientific interpretation .",
    "proof for this seemingly conservative choice has never been provided , and it is unknown whether or not the numerical error and the exponential divergence are not preventing certain parts in parameter space to be accessed , or new physically inaccessible parts in parameters space being explored .",
    "we argued that for the resonant 3-body problem the error made during the integration of the equations of motion poses no problem for obtaining scientifically meaningful results so long as energy is conserved to better than about one - tenth of the initial total energy of the system . in that case",
    "resonant 3-body interactions should be treated as an ensemble average , and individual results only contribute statistically .    by means of numerical integration until a converged solution is obtained we find that the statistical properties of the binary and the escaper resulting from a 3-body resonant encounter are deterministic .",
    "this behavior is not guaranteed to propagate to larger @xmath3 ( see also @xcite ) ; @xmath43 requires independent testing , because these introduce more complex solutions in the form of , for example binary - binary outcomes and hierarchical triples .",
    "the more extended parameter space for increasing @xmath3 from 3 to @xmath44 is quite dramatic , in particular for solving the system until a converged solution is reached .",
    "* acknowledgements * we would like to thank douglas heggie for many in - depth discussions , but also alice quillen , piet hut , jun makino , steve mcmillan , vincent icke and inti pelupessy for discussions and comments on the manuscript , as well as the anonymous referee for careful reading and detailed comments .",
    "this work was supported by the netherlands research council nwo ( grants # 643.200.503 , # 639.073.803 and # 614.061.608 ) and by the netherlands research school for astronomy ( nova ) .",
    "part of the numerical computations were carried out on the little green machine at leiden university and on the lisa cluster at surfsara in amsterdam .",
    ", h.  e. 1996 , in r.  t. jantzen , g. mac keiser , r. ruffini ( eds . ) , proceedings of the seventh marcel grossman meeting on recent developments in theoretical and experimental general relativity , gravitation , and relativistic field theories , p.  167            , s. , portegies zwart , s. , van elteren , a. , whitehead , a. 2012 , in r. capuzzo - dolcetta , m. limongi , a. tornamb ( eds . ) , advances in computational astrophysics : methods , tools , and outcome , vol .",
    "453 of _ astronomical society of the pacific conference series _ , 129                      , m. , myllri , a. , orlov , v. , rubinov , a. 2004 , in g.  g. byrd , k.  v. kholshevnikov , a.  a. myllri , i.  i. nikiforov , v.  v. orlov ( eds . ) , order and chaos in stellar and planetary systems , vol .",
    "316 of _ astronomical society of the pacific conference series _"
  ],
  "abstract_text": [
    "<S> the conservation of energy , linear momentum and angular momentum are important drivers for our physical understanding of the evolution of the universe . </S>",
    "<S> these quantities are also conserved in newton s laws of motion under gravity @xcite . </S>",
    "<S> numerical integration of the associated equations of motion is extremely challenging , in particular due to the steady growth of numerical errors ( by round - off and discrete time - stepping , @xcite ) and the exponential divergence @xcite between two nearby solution . as a result , numerical solutions to the general n - body problem are intrinsically questionable @xcite . using brute force integrations to arbitrary numerical precision we demonstrate empirically that ensembles of different realizations of resonant 3-body interactions produce statistically indistinguishable results . </S>",
    "<S> although individual solutions using common integration methods are notoriously unreliable , we conjecture that an ensemble of approximate 3-body solutions accurately represents an ensemble of true solutions , so long as the energy during integration is conserved to better than 1/10 . </S>",
    "<S> we therefore provide an independent confirmation that previous work on self - gravitating systems can actually be trusted , irrespective of the intrinsic chaotic nature of the n - body problem . </S>"
  ]
}