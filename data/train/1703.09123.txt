{
  "article_text": [
    "quantum metrology holds the promise to enhance the measurement of physical quantities with the help of quantum effects @xcite . in practice",
    ", ideas from quantum metrology may improve gravitational wave detectors @xcite , imaging in biology @xcite or sensors for protein molecules @xcite . in a typical metrological scenario one",
    "aims at estimating a certain phase @xmath1 , e.g. , generated by a magnetic field , with quantum probe systems . by using entanglement between the systems ,",
    "the uncertainty @xmath2 of the estimate can be reduced @xcite . in this way ,",
    "quantum metrology offers an advantage in theory , but for practical implementations noise and decoherence have to be taken into account . here",
    ", is has been shown that noise has often a negative effect and the improved scaling gets lost @xcite .",
    "nevertheless , concepts such as differential metrology , where some probe systems are used to monitor the noise , can be use to maintain a quantum advantage @xcite .",
    "a different problem is the estimation of the gradient of a spatially distributed magnetic field @xcite . of course",
    ", one may just measure the field at different positions @xcite or move a single probe through the field @xcite , and then compute the gradient .",
    "but these are not necessarily the optimal strategies , especially in cases where one aims at measuring small fluctuations of a large offset field .",
    "then , a detection of magnetic fields with high precision and spatial resolution is often not possible @xcite .",
    "furthermore , techniques to measure spatial varying fields by probes with well known position could be reversed in order to measure the spatial distributions of probes @xcite or the spatial distribution of entanglement @xcite by a well known spatial field distribution .",
    "for example in magnetic resonance imaging ( mri ) , the spatial resolution of such an image depends on the strength of the applied magnetic field gradient .",
    "the larger the magnetic field gradient , the better the resolution . however , practically the resolution is limited by the patients , e.g. for patients with medical implants . an old cardiac pacemaker or",
    "a cochlea implant would make the application of a large magnetic field gradient and therefore a high spatial resolution mri impossible . here ,",
    "quantum metrology could offer a solution for high resolution mri at small magnetic field gradients , such that also patients with medical implants can be medicated .    in this paper",
    "we discuss the estimation of magnetic gradients using the language of quantum metrology .",
    "we consider @xmath0 particles distributed in an arbitrary but fixed manner along a line , and ask in which quantum state they have to be prepared and which measurements have to be carried out in order to estimate the magnetic field gradient with the optimal precision .",
    "we also consider the case of dephasing noise , as it occurs in realistic set - ups with trapped ions or neutral atoms .",
    "we arrive at a general scheme which states and measurements are optimal , depending on the knowledge of the offset field , or on the presence of noise .",
    "this paper is organized as follows : in section ii we explain basic facts about quantum metrology and the fisher information , being the central figure of merit in estimation scenarios . in section iii",
    "we introduce the scenario of gradient estimation .",
    "section iv deals with the case that the offset field @xmath3 at a certain position is known and the gradient should be estimated .",
    "section v considers the situation , where the offset field @xmath3 is not known .",
    "section vi discusses shortly the measurement of more general notions than the gradient of the field .",
    "finally , we conclude and discuss the optimal strategies .",
    "we first review the basics of quantum metrology @xcite and introduce the main technical tools and notation that will be used in our work . then we briefly present the canonical phase estimation scheme and compare it with gradient estimation that is studied in this work .    the task in a typical quantum metrology scheme",
    "is to determine an unknown parameter @xmath4 which is encoded in a quantum state @xmath5 by a quantum channel described via the map @xmath6 . after passing through the quantum channel , the state is subsequently measured and the whole process repeated @xmath7 times to gather the sufficient statistics .",
    "let @xmath8 be the probability for the measurement outcome @xmath9 , given that the initial state was @xmath10 and the unknown parameter was @xmath4 . then",
    "a result in classical statistics states that the variance @xmath11 of any unbiased and consistent estimator @xmath12 of @xmath4 is lower - bounded by the _ cramr - rao bound _ ( crb ) @xcite : @xmath13 where @xmath14 ^ 2}{p_j(\\varphi)}\\ ] ] is the _ classical fisher information _ ( fi ) . a single estimator saturating eq .",
    "may not always exist for the whole parameter range . when estimating small fluctuations of a parameter around a given value , the crb in eq .",
    "is guaranteed to be tight in the limit of large number of repetitions @xmath7 @xcite .",
    "if the probabilities @xmath15 come from a quantum mechanical experiment , the classical fisher information ( fi ) @xmath16 depends on the initial state @xmath17 , the map @xmath6 encoding the phase @xmath18 and the performed measurement . in quantum mechanics the measurement process is described by a positive operator - valued measure ( povm ) , i.e. a collection @xmath19 of positive semi definite operators satisfying the normalisation condition @xmath20 .",
    "the probability of measuring the outcome @xmath21 on the state @xmath5 is given by @xmath22.\\ ] ] in the following we will denote the classical fisher information for the measurement statistics obtained from @xmath5 by the povm @xmath23 by @xmath24 .",
    "the optimization of @xmath24 over all possible povms is called _ quantum fisher information _",
    "@xmath25 $ ] ( qfi ) @xcite .",
    "the qfi depends solely on the quantum state @xmath10 and @xmath6 , whereas the fi depends on the state @xmath10 , @xmath6 and the povm @xmath23 . the qfi operationally quantifies metrological usefulness of the initial state @xmath10 under the map @xmath6 for the estimation of @xmath4 .",
    "the precision limitations for estimating @xmath4 is usually put in the form of the _ quantum cramr - rao bound _ @xmath26}\\ .\\ ] ] the qfi @xmath27 can be computed explicitly via the formula @xcite , @xmath28=2\\sum_{\\alpha,\\beta:\\lambda_\\alpha + \\lambda_\\beta \\neq 0 } \\frac{|\\bk{\\alpha|\\partial_\\varphi \\lambda_{\\operatorname{\\varphi}}(\\operatorname{\\varrho})}{\\beta}|^2}{\\lambda_\\alpha + \\lambda_\\beta}\\,,\\ ] ] where @xmath29 are the eigenvalues and @xmath30 the eigenvectors of @xmath31 .",
    "if the parameter @xmath4 is encoded via an unitary evolution , i.e. when @xmath32 , where @xmath33 for some hermitian operator @xmath34 , then the qfi depends only on the initial state @xmath10 and the operator @xmath34 and will be denoted by @xmath35 $ ] .",
    "the qfi for pure states @xmath36 in unitary time evolutions is related to the variance of the operator @xmath34 , @xmath37=4 \\delta^{2}_\\psi a \\coloneqq 4\\left[\\operatorname{tr}\\left(a^2 \\psi \\right ) - \\operatorname{tr}\\left(a \\psi \\right)^2    \\right]\\ .\\ ] ] let us also recall that @xmath38 $ ] is a convex function of @xmath10 .",
    "for this reason the maximal value of qfi is attained always for pure states .",
    "in fact , for a fixed hermitian operator @xmath34 , the maximal @xmath27 can be computed explicitly by @xcite @xmath39=\\left(\\lambda_{\\max}-\\lambda_{\\min}\\right)^{2}\\ , \\ ] ] where @xmath40 and @xmath41 are the maximal and minimal eigenvalues of @xmath34 respectively , and @xmath42 denotes the set of ( mixed and pure ) quantum states supported on the hilbert space @xmath43 .",
    "the pure state for which the qfi attains eq .",
    "is given by @xmath44 where @xmath45 and @xmath46 are eigenvectors of @xmath47 corresponding to eigenvalues @xmath40 and respectively @xmath41 .",
    "in the experimental context it is common to infer the value of the parameter solely from the expectation value @xmath48 of some observable @xmath49 .",
    "this is done by using the taylor expansion @xmath50 to construct the estimator @xmath51 , one has to assume that the statistical fluctuations of the phase @xmath4 around the _ known _ value @xmath52 are small ( so that eq .   makes sense ) and that the expectation value is known .",
    "] of the value of @xmath4 .",
    "this strategy is in general only optimal for a specific choice ) the precision attainable by this method saturates quantum cramr - rao bound given in eq .",
    ", for the suitable choice of the observable .",
    "the optimal observable in general depends on the value of the phase .",
    "in particular , it is known that error propagation formula in eq .   for so - called symmetric logarithmic derivative @xcite saturates .",
    "however , in general there is no guarantee that symmetric logarithmic derivative is an observable easily accessible in experiment . ] of the operator @xmath49 .",
    "the precision of this estimator @xmath53 , after the experiment is repeated @xmath7 times , is given by the error - propagation formula @xcite    @xmath54 ^ 2 } \\ .\\ ] ]    in what follows , we will drop the number of repetitions @xmath7 in order to simplify the notation and discussion.*standard metrological scenario : * in the standard scenario a quantum device ( e.g. an interferometer ) acts on a single particle ( photon , atom , etc . ) with the hamiltonian @xmath55 ( often taken to be equal to @xmath56 ) .",
    "the device encodes the unknown parameter @xmath4 on the system of @xmath0 particles by performing the parallel unitary transformation @xmath57 , where @xmath58 [ see figure [ fig : shemes](a ) ] .",
    "this unitary evolution is generated by the global hamiltonian @xmath59 , where @xmath60 denotes the hamiltonian on the @xmath21th particle . in classical measurement strategies ( corresponding to separable input sates ) , the particles are only classical correlated and the variance @xmath61 for measuring @xmath1 is limited by the number of particles @xmath0 via the standard quantum limit ( sql ) @xmath62 . however , in quantum mechanics , we have a freedom to apply the device in parallel to an entangled state of @xmath0 particles [ see figure [ fig : shemes ] ( a ) ] .",
    "this allows to obtain the accuracy @xmath63 , which is usually refereed to as the heisenberg limit ( hl ) .    the concepts of sql and hl are tailored to the schemes where every particle is affected by the same unitary @xmath64 .",
    "as we will see later , in the context of the estimation of gradients of electric or magnetic fields , it is natural to consider again parallel encoding , but this time allowing single particle unitaries @xmath65 acting differently on different particles - see figure [ fig : shemes ] ( b ) . the standard hl and the sql are no longer valid and new bounds in precision have to be derived",
    "this is one of the main aim of the present paper .    at this point",
    ", it is important to remark that in the standard metrological scenario , the heisenberg scaling is typically destroyed by local noise and asymptotically only an enhancement by a constant factor can be achieved @xcite .",
    "however , in the case of global noise such as collective phase noise the scaling @xmath66 can be restored e.g. by differential interferometry @xcite . in this work",
    "we will also discuss the impact of the effects on the performance for gradient estimation .",
    "component along the string . the magnetic field",
    "@xmath67 acts on each particle , depending on its position .",
    "the particles are labelled such that the smallest magnetic field acts on the first and the largest magnetic field on the last particle . ]    throughout the paper , we consider a string of @xmath0 particles whose internal , qubit - like , degrees of freedom are coupled to the @xmath68 component of the spatially - varying magnetic field @xmath67 with @xmath69 with @xmath70 being the field at position @xmath71 , called offset field , and @xmath72 being the strength of the gradient . usually in experiments the offset field @xmath3 is set to split the degenerate energetic levels .",
    "the direction of the offset field @xmath3 is defined to be the quantization axis that is called @xmath68 axis .",
    "furthermore , the offset field @xmath3 is strong comparing to fields that point in other directions .",
    "therefore , we neglect all other components .",
    "we assume without loss of generality a spatial gradient in the @xmath73 direction .",
    "the particles are arranged along the @xmath73 axis and labelled in such a way that @xmath74 , where @xmath75 with @xmath76 denotes the position of the @xmath21th qubit - see fig .",
    "[ fig : particles_in_gradient ] .    the magnetic field @xmath77 depends on the positions @xmath75 of the qubits .",
    "in our analysis we will focus on experiments , where these positions can be measured with high precision .",
    "this is the case , e.g. in experiments with trapped ions @xcite or neutral atoms in optical microtraps @xcite . in both kinds of experiments",
    "the position of the qubits can be measured up to @xmath78 nm , whereas the distance of the qubits scales with @xmath79 m .",
    "generally , position dependent fields such as magnetic gradients lead to a coupling between the internal and external degrees of freedom @xcite . within this paper",
    ", we will assume that this coupling is negligible small , such that the position @xmath75 of the @xmath21th qubit can be treated classically .",
    "this can be always achieved by e.g. trapping the particles strong enough .",
    "the hamiltonian describing the interaction of the internal degrees of freedom with the magnetic field is given by @xmath80 , with @xmath81 where @xmath82 denotes the pauli matrix acting on the @xmath21th qubit , @xmath83 is the collective spin operator , and @xmath84 is the coupling strength .",
    "the map @xmath85 describing the unitary time evolution due to @xmath47 for time @xmath86 is given by @xmath87 , where @xmath88.\\ ] ]    in the following , we will use tools of quantum metrology to derive limits in precision for classical and quantum estimation for the gradient @xmath72 , analogous to sql and hl known form the standard phase estimation scheme .",
    "the maximal achievable precision of @xmath72 depends on whether the offset field is known or unknown .",
    "therefore , we will differentiate between the case of full _ a priori _ knowledge and the case of no _ a priori _ knowledge about the offset field @xmath3 .",
    "in general , an experimenter could measure the offset field with some uncertainty @xmath89 first and would have some _ a priori _ knowledge about the offset field .",
    "however , throughout this paper we focus on two extremal situations : full and no _ a priori _ knowledge about @xmath3",
    ". please note that in the main text of the paper we will make two implicit assumptions on the system that we are considering .",
    "first , we will assume that @xmath90 for all particles .",
    "this affects the precise form of the optimal states and the formula for the maximal qfi . for the sake of simplicity of the presentation we decided to discuss this in detail in appendix  [ app : maxfi ] .",
    "second , we will assume that the number of particles @xmath0 is even .",
    "this has only a slight effect on the form of the results for the case of no _ a priori _ knowledge about @xmath3 .",
    "the change for odd @xmath0 is that the summation range has to be changed from @xmath91 to @xmath92 .",
    "these are discussed in full generality in appendix  [ app : presicion_bounds_not_knowing_b ] .",
    "having the full _ a priori _ knowledge about the offset field @xmath3 amounts to treating it as a fixed constant . using the commutation relations @xmath93=\\left[u_g , h_g \\right]=0\\ .\\ ] ] and eq .",
    "we obtain the following relation @xmath94=(\\gamma t)^2   \\operatorname{\\mathnormal{f_q}\\!}\\left[\\operatorname{\\varrho},h_g\\right ] \\ .\\ ] ] in what follows we will reserve the notation @xmath95\\ ] ] to avoid ambiguity and simplify the notation .",
    "the physical meaning of eq .",
    "is that qfi for the gradient estimation is reduced to qfi for the standard `` hamiltonian '' qfi @xmath96 $ ] , and that @xmath97 $ ] does not depend on the value of the magnetic offset field @xmath3 at @xmath71 .",
    "however , the qfi does depend on @xmath71 , via the dependence of @xmath98 on this parameter - see eq .  .",
    "notice that the unitary transformation generated by the field has the product structure @xmath99 , where @xmath100 \\sigma^{(i)}_z /2\\}$ ] is a single qubit unitary .",
    "therefore , the problem of deriving the maximal qfi and the optimal state becomes mathematically equivalent to the case of parallel encoding of the phase given in figure  [ fig : shemes ] ( b ) .",
    "the rest of this section is organised as follows .",
    "first , in part a we identify the bounds in precision for the estimation of the gradient @xmath72 with separable and entangled states . then ,",
    "in part b we give simple , physically - accessible measurements saturating these bound .",
    "finally , in part c , we discuss the influence of collective phase noise on the proposed gradient estimation scheme .      here , we first derive precision bounds for fixed positions @xmath101 and identify optimal probe states .",
    "then , we discuss the case of linear spacing of particles . finally , we identify the optimal positioning of qubits and give the ultimate bounds for the precision of gradient estimation .",
    "* separable states : * our first result concerns the maximal qfi for estimating @xmath72 using separable states .",
    "we start with the observation that from the decomposition @xmath102 with @xmath103 , we can simplify the qfi for product states @xmath104 via @xmath105=\\sum_{i=1}^n \\operatorname{\\mathnormal{f_q}\\!}\\left[\\operatorname{\\varrho}_i , h^{(i)}_g \\right ] \\ , \\ ] ] by using the additivity of the qfi @xcite . using this relation together with the convexity of qfi and eq .",
    "we find that the maximum of the qfi on the set of separable states on @xmath0 qubit systems @xmath106 is obtained for the product state @xmath107 such that each @xmath108 maximises @xmath109 $ ] .",
    "therefore , we have @xmath110 and the maximum is obtained for the state @xmath111 from eq .",
    "we get the bound on achievable precision with separable input states @xmath112 * entangled states : * the second result concerns the maximal qfi over all states from the @xmath0 qubit hilbert space @xmath113 . to compute this maximum we use eq .  , eq .  , and the fact that @xmath98 can be explicitly diagonalised by the computational basis of @xmath0 qubit space @xmath113 .",
    "we obtain @xmath114 ^ 2\\ , \\ ] ] with the optimal state being the @xmath0 qubit greenberger - horne - zeilinger ( ghz ) state @xcite @xmath115 analogously to the case of separable states in eq .",
    "we use the quantum cramr - rao bound to get the limitations on the precision for estimating @xmath72 with entangled states @xmath116^{2 } } \\ .\\ ] ]    let us remark that both , the maximal qfi in eq .   and the maximal qfi for separable states in eq .   strongly depend on the positioning of the particles and the coordinate @xmath71 , if the value of the magnetic field is assumed to be known .",
    "notice , however , that the quantum states for which the optimal values are attained do not depend on the spacing of particles . moreover ,",
    "the optimal states derived by us are invariant under the relabeling of qubits according to @xmath117 , which proves that our scheme works also for a negative value of the gradient @xmath72 .",
    "let us finally remark that in our analysis we have assumed , according to the note in the end of sec .",
    "[ sec : gradient_estimation_theory ] , that @xmath118 .",
    "the structure of optimal states and the precise formula for maximal qfi changes if this assumption is dropped .",
    "we discuss this in detail in appendix  [ app : maxfi ] . *",
    "equidistant spacing : * consider an experiment for measuring the gradient @xmath72 in which @xmath0 qubits are equally spaced in the interval @xmath119 $ ] , i.e. @xmath120 . for",
    "this positioning the qfi for separable states is given by @xmath121 which ( for fixed length @xmath122 ) scales proportionally to @xmath0 for a large number of particles .",
    "on the other hand , the qfi for entangled states becomes @xmath123 and scales with @xmath124 ( for fixed @xmath122 ) .",
    "* optimal positioning and the ultimate bounds * : we can optimize the qfi in eq .   and eq .   over the positions of qubits .",
    "again , we assume that the particles are located in the interval @xmath119 $ ] and we fix both @xmath71 and @xmath122 . in order to maximize the right - hand sides of both eq .",
    "and eq .  , an experimenter should put all qubits at the position @xmath125 .",
    "this means that the particles are as far away as possible from the point @xmath71 .",
    "if this is the case we get for separable states @xmath126 similarly , the maximal qfi over all states becomes @xmath127    using eq .",
    "and eq .   we can give now the ultimate bounds for the precision of estimating @xmath72 , with the usage of @xmath0 qubits placed in the fixed interval @xmath119 $ ] , and when we perfectly know the value of the field at @xmath71 .",
    "for separable probe states , the best achievable precision for the determination of @xmath72 is given by @xmath128 similar to the sql .",
    "likewise , for entangled probe states , we get a heisenberg - like scaling given by @xmath129 for both , the scaling behavior in @xmath0 ( for fixed length @xmath122 ) is identical to the case of the estimation of global parameters .",
    "this is not surprising , since we assumed that we perfectly know the value of the offset field @xmath3 at the position @xmath71 and the optimal strategy is to use all particles for the estimation of the field at the position @xmath130 .",
    "the optimal states derived by us can be prepared in experimental settings such as trapped ions and neutral atoms in optical microtraps . in experiments with trapped ions",
    "the preparation of ghz states @xcite up to @xmath131 qubits with high fidelity is possible @xcite . in experiments with neutral atoms in optical microtraps",
    "the preparation of a bell or ghz state as defined in eq .   with @xmath132 qubits has been achieved",
    ".    however , as explained in section  [ sec : gradient_estimation_theory ] the bounds involving qfi assume implicitly the application of the optimal measurement . in general , the optimal measurement saturating the quantum cramr - rao bound is the projective measurement in the eigenbasis of the so - called symmetric logarithmic derivative @xcite .",
    "this measurement can be difficult to perform in practice .",
    "fortunately , the optimal measurement is not necessarily unique . in what follows",
    "we show that parity measurements in the @xmath73 basis are sufficient in order to reach the maximal possible precision of gradient estimation for ghz states .",
    "parity measurements can be easily performed in experiments with trapped ions @xcite as first proposed by bollinger et al . in 1996",
    "@xcite and neutral atoms in optical microtraps @xcite .",
    "a parity measurement is basically a detection of the number of qubits in either the spin - up or spin - down state and can be realized with almost @xmath133 efficiency @xcite .",
    "interestingly , the parity measurement does not depend on the spacing of particles and is thus the same for any configuration @xmath134 . * classical fisher information : * a parity measurement in the @xmath73 basis is a projective measurement @xmath135 with the projective operators @xmath136 after the time @xmath86 the initial @xmath0-qubit state @xmath10 evolves due to @xmath137 . upon measuring @xmath138 on @xmath139 ,",
    "the output probabilities are given by @xmath140 in appendix  [ app : fi ] we show that @xmath141\\ , \\ ] ] where @xmath142 . using this expression , together with eq . and the definition of the fi in eq .",
    "we find that the classical fisher information associated with the statistics of parity measurement on ghz states is given by @xmath143 ^ 2 \\ , \\ ] ] and equals the qfi for estimating @xmath72 with ghz states [ see eq .  ] .",
    "therefore , parity measurements in the @xmath73 basis are optimal for gradient estimation with ghz states .",
    "the choice of an optimal measurement is not unique , also measurements of the collective spin operator in the @xmath73-direction @xmath144 are optimal as shown in appendix  [ app : jxmes ] .",
    "* error propagation formula : * it turns out that measurements of the expectation value of the parity @xmath145 with ghz states also saturate the ultimate limitations given in eq .   for the accuracy of the measurement of @xmath72 .",
    "in usual experiments this expectation value @xmath146 is measured for different probing times @xmath86 and if the initial state is @xmath147 the theoretical time dependence is given in eq .  . in this measurement scheme",
    "the gradient @xmath72 is deduced from the value of the frequency , which can be estimated by a fit on the data .",
    "this procedure however requires the known value of the offset field @xmath3 . if one has no _ a prior _ knowledge about @xmath3 one has to average @xcite over all possible values of @xmath3 and one can not infer the value of @xmath72 .",
    "it is possible to avoid this problem by measuring this expectation value for different positioning @xmath148 at a _ fixed _ probing time @xmath86 .",
    "this strategy has been realized with a single ion moving through a gradient field in ref .",
    "however , this scheme is definitely a less practical solution as one has to make sure that the initial quantum states are the same , despite the change in the configuration of the chain .",
    "the case of _ no priori _ knowledge about the offset field will be considered systematically in section  [ sec : no_a_priori_knowledge ] .    with the error propagation formula in eq .   and using eq .   together with the fact that @xmath149 we can show that both measurement strategies ( varying the probing time at a fixed positioning and varying the positioning at a fixed probing time ) saturate the cramr - rao bound and therefore also the analogue hl for gradient estimation , assuming that the positioning @xmath148 and the measurement time @xmath86 can be determined with high precision , so we have @xmath150^{2 } } \\ .\\ ] ]       qubits in the presence of collective phase noise [ see eq .",
    ", we assume typical field fluctuations in the order of @xmath151hz and correlation time @xmath152s ( see , e.g. , ref .",
    "@xcite ) . ,",
    "scaledwidth=45.0% ]    in realistic experiments noise affects the time evolution of a quantum system , reducing the entanglement of the probe states .",
    "this can diminish the enhancement in precision for gradient estimation obtained with entangled states . in both types of experiments considered in this work",
    "collective phase noise is the main source of decoherence . in experiments with trapped ions ,",
    "this noise is caused by temporal magnetic field fluctuations @xcite , whereas in experiments with neutral atoms in optical microtraps , collective phase noise is caused by temporal fluctuations of the trapping potential @xcite . in what follows",
    "we describe the influence of collective phase noise on the proposed scheme for the estimation of the gradient of the magnetic field . *",
    "collective phase noise : * we focus our attention on trapped ions .",
    "we follow the steps and assumptions for describing the noise source in this system given in ref .",
    "the total hamiltonian of the system including the noise is given by @xmath153 where operators @xmath154 and @xmath98 are defined in eq .  , @xmath155 is the coupling constant , and @xmath156 is the temporally fluctuating random field .",
    "we will use @xmath157 to denote the average over the stochastic fluctuations of this field . following ref .",
    "@xcite we assume ( i ) no systematic time - dependent bias due to phase fluctuations @xmath158 , where @xmath159 , ( ii ) gaussian character of the fluctuations @xmath160 , ( iii ) stationarity of the noise process , @xmath161 , and finally ( iv ) that the time correlation @xmath162 $ ] decays exponentially , with the correlation time @xmath163 and the fluctuation strength @xmath164 .",
    "now , for the fixed realization of the stochastic process the output state at a given time @xmath86 is given by @xmath165 with @xmath166 , where @xmath167 is given in eq .   and",
    "@xmath168 $ ] describes the noise acting on the system . by averaging over the realization of the stochastic process @xmath156 ( for the fixed time @xmath86 )",
    "we get that the initial state @xmath10 is mapped into @xmath169 , where @xmath170 since the encoding of the value of the gradient commutes with the map describing the noise we have @xmath171 \\ .\\ ] ] that is , in order to compute the qfi in the presence of collective phase noise it suffices to calculate the `` standard '' qfi on the noisy initial state . * noisy gradient estimation with ghz states : * for a ghz state in presence of collective phase noise",
    ", the qfi can be calculated analytically ( see appendix  [ app : ghx_under_noise ] for details ) and takes a closed form @xmath172 ^ 2\\ , \\ ] ] with @xmath173 $ ] .",
    "we see that the qfi first increases with @xmath174 and then , in the limit of large times , decreases double exponentially to zero .",
    "therefore , there exists a global maximum and an optimal measurement time as shown in fig .",
    "[ fig : noisyghz ] .",
    "furthermore , we see that in the presence of collective phase noise and for large probing times @xmath86 , the ghz state can not be used any more to effectively estimate the gradient @xmath72 . in appendix",
    "[ app : parity_noisyghz ] and [ app : epf_noisyghz ] we show that , just like in the noiseless case , measurements of parity @xmath175 suffice to saturate the quantum cramr - rao bound for the estimation of the gradient @xmath72 , with the qfi as in eq .  . however , this time the optimal probe state is @xmath176 where @xmath177 is a phase depending on the value of the offset field @xmath3 , time @xmath86 , and the prior value of the gradient @xmath72 .",
    "* noisy gradient estimation with the state @xmath178 : * in general , it is difficult to evaluate the qfi in eq .",
    "analytically for arbitrary probe states @xmath10 .",
    "the initial pure product state @xmath179 , given in eq .  , evolves into a mixed state @xmath180 due to noise .",
    "we will focus on the regime of large probing times @xmath181 . in this limit",
    ", the state does not change any more due to collective phase noise and @xmath182=0 $ ] @xcite and therefore we call this regime the _ steady state regime_. we get that for this state the qfi does not vanish in the limit of large times ( see appendix  [ app : product_state_steady ] for details ) , @xmath183\\ .\\label{eq : qfi_p_steady}\\ ] ] thus , in the steady state regime , the product state @xmath178 performs better then the ghz state in the presence of noise .",
    "interestingly the qfi in eq .   is independent of @xmath71 .",
    "this is due to the fact that in the steady state regime the probe state is not only invariant under collective phase noise but also under the offset field @xmath3 since @xmath184=0 $ ] . *",
    "optimal positioning : * for the ghz state in the steady state regime the qfi vanishes independent of the positioning of the qubits .",
    "however , for the separable state @xmath178 in the steady state regime the optimal positioning ( see lemma 1 in appendix  [ app : product_state_steady ] for the proof ) at the interval @xmath185 $ ] is to place one half of the qubits at position @xmath186 and the other half as far away as possible @xmath187 ( note that the position @xmath188 has nothing to do with @xmath71 and is just some fixed reference coordinate ) . for this case",
    "the qfi is given by @xmath189 that is linear in @xmath0 and by constant factor of @xmath190 smaller than in the case of having no noise and placing all qubits at @xmath191 [ see eq .  ] .",
    "the optimal spacing of the particles leads to the situation in which the particles are located at two different positions . as a result ,",
    "two different unitaries @xmath192 and @xmath193 act on one half of the particles each .",
    "this is a local estimation strategy similar to differential interferometry @xcite . in these works",
    "phase and frequency estimation in the presence of correlated phase noise were investigated .",
    "it was shown that the quadratic scaling in @xmath0 can be preserved by the usage of differential interferometry in presence of correlated noise .",
    "furthermore , it was shown that for the product state @xmath178 a linear scaling in @xmath0 up to a constant factor can be preserved .",
    "similar results where found in ref .",
    "@xcite . here , the two unitaries @xmath192 and @xmath194 act on half of the particles each . for this estimation scenario",
    "it was shown that the hl can be preserved in presence of correlated dephasing . in eq .",
    "we find a similar result .",
    "in section  [ sec : full_a_priori_knowledge ] , we derived bounds in precision for the estimation of the gradient @xmath72 , assuming complete knowledge of the offset field @xmath3 .",
    "the question arises whether it is possible to measure @xmath72 without knowing anything about @xmath3 .",
    "we can already answer this question : collective phase noise can be interpreted as an erasure of information about @xmath3 in time .",
    "therefore , waiting long enough leads to the case of having no knowledge about @xmath3 . in eq .",
    "we saw that in the steady state regime the qfi for the ghz state @xmath195 vanishes such that the ghz state is useless in order to estimate @xmath72 in the case of having no knowledge about @xmath3 .",
    "however , in eq .",
    "we saw that in the steady state regime the qfi for the product state @xmath178 did nt vanish .",
    "therefore , it is possible to measure @xmath72 without knowing @xmath3 . in this section",
    "we systematically study limits on the accuracy for estimating the gradient @xmath72 , when no knowledge about @xmath3 is available .    in this section we first ( a ) identify optimal probe states and the corresponding bounds in precision for estimating @xmath72 when no",
    "_ a priori _ knowledge of @xmath3 is available .",
    "interestingly , we find that these bounds asymptotically behave in the similar way , as in the noiseless case . then , ( b ) we prove that similarly to the noiseless case parity measurements in the @xmath73 basis saturate the derived bounds in precision . finally , ( c ) we compare these results with the other measurement strategies considered in this paper and earlier works on the subject .",
    "in what follows we derive precision bounds for estimating a gradient with a fixed positioning @xmath148 .",
    "then , we discuss the case of equidistant spacing . finally , we derive the optimal positioning for the particles located in the fixed interval of length @xmath122 .    when assuming no _ a priori _ knowledge about the offset field @xmath3 the hamiltonian of the system does not change compared to eq .",
    "however , now the offset field @xmath3 is unknown and therefore must be treated as a random variable and all states , operations , and measurements performed on the system have to be averaged over all realizations of this random variable . phrasing this in a different language",
    "it can be said that we erase the reference frame @xcite associated to the knowledge of the offset field [ or , formally speaking , the one - parameter group of transformations formed by operators @xmath196 , where @xmath197 .",
    "complete erasure of the knowledge about @xmath3 is modeled by averaging the initial state @xmath10 over all possible rotations around the @xmath68-axis @xmath198 states of the above form are called decoherence - free states since they are stationary states of collective phase noise : @xmath199=0 $ ] .",
    "conversely , every state @xmath200 satisfying @xmath201=0 $ ] can be written as @xmath202 , for a suitable @xmath10 @xcite . in what follows",
    "we will use the decoherence - free subspace for @xmath0 qubits @xmath203 to denote the set of decoherence - free states in the considered scenario .",
    "it is easy to see from the definition that every @xmath204 can be written as a convex combination @xmath205 of decoherence - free states @xmath206 , each supported on the subspaces @xmath207 spanned by computational basis vectors @xmath208 containing exactly @xmath209 excitations ( `` 1 '' ) and @xmath210 `` 0 . ''",
    "can be characterized as the eigenspace of @xmath211 corresponding to the eigenvalue @xmath212 . ]",
    "* optimal decoherence - free states : * in order to compute how useful decoherence - free states are for the estimation of the gradient @xmath72 we use directly eq .  , which reduces the problem of computing the qfi for the proposed metrological scheme to the computation of the @xmath213 $ ] , where @xmath214 .",
    "using the fact that @xmath98 preserves subspaces @xmath207 and the properties of @xmath213 $ ] ( see appendix  [ app : presicion_bounds_not_knowing_b ] for details ) , we prove that in order to find optimal decoherence - free states it suffices to look only at optimal ( and thus necessary pure ) states in each subspace @xmath207 separately , @xmath215 \\,.\\label{eq : sequentialreduction}\\ ] ] the maximal attainable qfi for states in the subspaces @xmath207 with @xmath209 excitations is given by ( see appendix  [ app : presicion_bounds_not_knowing_b ] ) @xmath216^{2}\\ , \\ ] ] where @xmath217 .",
    "we observe that the above result is independent of @xmath71 and that it does not change under the simultaneous translation of each @xmath218 by the same distance @xmath219 .",
    "this is a consequence of the relation @xmath220=0 $ ] , valid for @xmath204 .",
    "the optimal decoherence - free ( odf ) state for a given number of excitations @xmath209 , yielding eq .",
    "is given by @xmath221 the detailed derivation of eq .",
    "end eq .",
    "is given in appendix  [ app : presicion_bounds_not_knowing_b ] .",
    "a remarkable fact is that for decoherence - free states qfi for estimation of the gradient @xmath72 does not decrease in time due to the collective phase noise . in fig .",
    "[ fig : max_qfi_vs_k ] we show the maximal qfi from eq .   for different number of excitations @xmath209 and for different positionings @xmath148 .",
    "we observe that the maximal qfi is attained exactly for @xmath222 , for arbitrary positioning of qubits .",
    "this observation can be proven analytically for any positioning of particles ( see appendix  [ app : presicion_bounds_not_knowing_b ] for details ) and we have @xmath223^{2}\\ ] ] with @xmath224 being the optimal state .",
    "it is important to note that just like in the noiseless case [ see eq .  ]",
    ", the optimal state does not depend on the spacing of particles . from the quantum cramr - rao bound in eq .",
    "we get the ultimate bound on the precision of the estimation of the gradient @xmath72 with decoherence - free states @xmath225^{2 } } \\ .\\ ] ]    * separable states : * in the case of no _ a priori _ knowledge about the offset field it is hard to derive precision bounds for separable states .",
    "this follows from the difficulty to characterise the convex set @xmath226 , consisting of states that are both decoherence - free and separable .",
    "in particular , extremal points of @xmath226 generally do not have the form of pure state .",
    "we leave the problem of finding the optimal decoherence - free separable state open .",
    "however , let us remark that the decoherence - free separable state preserves separability of quantum states . ]",
    "@xmath227 exhibits asymptotically the same ( linear in @xmath0 ) scaling of the qfi as the optimal product state @xmath228 at least for the case of equal and optimal spacing ( that is placing half of the qubits at each position @xmath188 and @xmath229 for @xmath227 and placing all qubits at position @xmath130 for @xmath230 ) - see eq .",
    "and eq .  .",
    "* equidistant spacing : * just like in the case of complete knowledge about @xmath3 ( described in sec .",
    "[ sec : full_a_priori_knowledge ] ) we consider a measurement scheme in which @xmath0 particles are equally spaced in the interval @xmath231 $ ] , i.e. @xmath232 . does not have anything to do with the coordinate @xmath71 considered in sec .",
    "[ sec : full_a_priori_knowledge ] .",
    "the latter is not even defined in the considered setting .",
    "] then , for the optimal decoherence - free state @xmath233 we have @xmath234 which scales @xmath235 for large numbers of particles .    with the optimal separable state from the noiseless case @xmath236 ,",
    "the qfi for equidistant spacing in the steady state regime becomes @xmath237 which scales @xmath238 for large numbers of particles .",
    "* optimal positioning : * optimizing the right hand side of eq .   over the positions",
    "@xmath239 $ ] , we find the maximal qfi over all decoherence - free states @xmath240 which is independent of @xmath188 and scales  @xmath235 .",
    "the optimal positioning leading to eq .",
    "is @xmath241 for @xmath242 and @xmath243 for @xmath244 ( see appendix  [ app : presicion_bounds_not_knowing_b ] for the proof ) .",
    "this corresponds to locating particles at two positions with the maximal possible distance @xmath122 . recall that the same positioning was found as optimal for estimating the gradient @xmath72 with the state @xmath178 in the steady state regime",
    "[ see the discussion above eq .  ] .",
    "optimal decoherence - free states @xmath245 are equivalent under local unitaries to ghz states , that means that odf states can be transformed into ghz states and vice versa by local unitaries .",
    "odf states can be prepared with high fidelity by a global srensen - mlmer gate @xcite in experiments with trapped ions . that has been performed for @xmath131 qubits in ref .",
    "@xcite . in experiments with neutral atoms in a lattice",
    "the preparation of the odf state with @xmath246 for @xmath132 qubits has been realized @xcite .",
    "we therefore conclude that optimal probe states for gradient estimation can be realized in experiments considered in this work .",
    "as in the case of full knowledge about @xmath3 and the absence of noise , the question remains of which measurement should be performed in order to attain the maximal precision . in what follows",
    "we show that for parity measurements in the @xmath73 basis ( i ) the classical fisher information [ see eq .  ] and ( ii ) the error propagation formula [ see eq .  ]",
    "saturate the quantum cramr - rao bound in eq .   for optimal decoherence - free states @xmath245 .",
    "* classical fisher information : * as described in sec .",
    "[ sec : measurements_noiseless_case ] , the projective measurement @xmath138 of the parity in the @xmath73-basis is described by the projectors @xmath247 [ see eq .  ] . in appendix",
    "[ app : fi ] we show that the expectation value of the parity on the state @xmath248 evolves according to @xmath249 \\ , \\ ] ] where @xmath250 . using this result and performing the analogous computations as the ones given in sec .",
    "[ sec : measurements_noiseless_case ] we get @xmath251^{2 } \\ , \\ ] ] with @xmath250 . comparing eq .   and",
    "eq .   we see that parity measurements in the @xmath73 basis saturate the quantum cramr - rao bound for the estimation of @xmath72 with the optimal decoherence - free state @xmath245 .",
    "in particular , the quantum cramr - rao bound is saturated for the optimal state @xmath224 and therefore also the bound in eq .",
    "is saturated .",
    "* error propagation formula : * just like in the noiseless case ( discussed in sec .",
    "[ sec : measurements_noiseless_case ] ) , one can try to estimate the gradient @xmath72 from the measurements of the expectation value of @xmath252 given in eq .  .",
    "using the error propagation formula in eq .   and the formula for the expectation value in eq .   with @xmath149 , we obtain that this measurement strategy again leads ( for small fluctuations of the gradient @xmath72 ) to the maximal achievable precision , provided by the optimal state @xmath224 : @xmath253^{2 } } \\ .\\ ] ]    from the above discussion we see that parity measurements in the @xmath73 basis are optimal in both extremal scenarios considered in this paper - under the condition of full or no _ a priori _ knowledge about the offset field @xmath3 . as discussed in sec .",
    "[ sec : measurements_noiseless_case ] these measurements can be routinely realized in experiments with trapped ions and neutral atoms in an optical lattices .",
    "it is also important that the ultimate accuracy given in eq .",
    "is saturated independently on the value of the gradient @xmath72 and does not deteriorate with time due to collective phase noise .",
    "in this part we compare the performance of odf states with ( i ) ghz states in the case of full _ a priori _ knowledge of @xmath3 but in the presence of collective phase noise , and ( ii ) with dicke states , for the estimation of gradients .",
    "* comparison with ghz states : * we compare the performance of ghz states with optimal decoherence - free states when we have complete information about @xmath3 and collective phase noise is present . as mentioned before , collective phase noise can be interpreted as an erasure of information about @xmath3 .",
    "therefore , the qfi for @xmath254 states vanishes for long measurement times @xmath86 and odf states @xmath224 with @xmath222 excitations perform better .",
    "in contrast , for short probing times @xmath86 ghz states perform better .",
    "we can calculate the critical time @xmath255 for which the qfi for ghz states under noise is equal to the qfi for @xmath224 . in experiments for which this paper is relevant typically @xmath256s - ms and @xmath257s .",
    "therefore , we can assume @xmath258 from which we get ( see appendix  [ app : critical_time ] ) @xmath259\\right\\}^{1/2}}{n\\gamma ' \\delta e}\\,,\\ ] ] in the case of complete _ a priori _ knowledge about @xmath3 at the beginning and collective phase noise ghz states perform good for @xmath260 . for @xmath261 odf states",
    "@xmath224 outperform ghz states .",
    "neutral atoms in an optical microtrap are arranged equidistant @xmath262 .",
    "for this positioning we find the critical time @xmath263}/(n \\gamma ' \\delta e)$ ] .",
    "this is independent of the total length @xmath122 of the string . for @xmath264 qubits and @xmath265hz ( as used for fig .",
    "[ fig : noisyghz ] ) we find @xmath266s and for @xmath267 we find @xmath268s .",
    "both are within typical coherence times of such experiments .    in sec .",
    "[ sec : full_a_priori_knowledge ] we discussed the case of full _ a priori _ knowledge about @xmath3 .",
    "here , we found that in the absence of noise ghz states are optimal .",
    "however , this holds only under the assumption that @xmath269 , this means that the hole string of qubits is on the right hand side of the position @xmath71 where @xmath3 is known . if @xmath71 is defined to be located within the range of the qubit string ghz states are not optimal anymore ( as shown in appendix  [ app : maxfi ] ) .",
    "the experimentally relevant case is , if an experimenter has full _ a priori _ knowledge about the offset field @xmath3 right in the middle of the qubit string @xmath270 , e.g. , by estimating the average field .",
    "interestingly , in this case the optimal states are odf states ( as shown in appendix  [ app : maxfi ] ) that are decoherence free . therefore , when @xmath71 is defined to be in the middle of the string it does nt matter whether an experimenter has knowledge about the offset field . this fact implies , that only if an experimenter is able to measure the offset field at a position that is not right in the middle of the string , she could gain from having information about the offset field .",
    "* gradient estimation with dicke states : * in ref .",
    "@xcite it was claimed that for gradient estimation with a w state a good scaling of the qfi in @xmath0 is possible . recall that w states are decoherence - free states and belong to the set of symmetric dicke states @xcite @xmath271 , where @xmath272 is a normalization constant and @xmath273 denotes the sum over all possible permutations .",
    "symmetric dicke states with @xmath274 excitations are exactly w states .",
    "we use eq .   to compute the qfi for dicke states @xmath275",
    "[ see appendix  [ app : product_state_steady ] , eq .   for details ] and the final result is @xmath276\\ . \\end{split}\\end{aligned}\\ ] ] for equidistant positioning @xmath277 we have @xmath278 which is maximal for @xmath222 , @xmath279 for w states ( @xmath274 ) we have @xmath280 this is exactly the same result as the one from ref .",
    "@xcite with @xmath281 . in ref .",
    "@xcite @xmath282 is defined as a fixed distance between the qubits with @xmath283 , such that adding a qubit leads to an extension of the total length @xmath122 of the string . using this convention the qfi for w states in eq .",
    "scales with @xmath284 for large @xmath0 . at first sight",
    "this seems to be a good scaling since it is quadratic in @xmath0 .",
    "however , when fixing the distance between the qubits @xmath282 the hl for gradient estimation is @xmath285 and the sql @xmath286 for large @xmath0 and with @xmath287 .",
    "therefore , a quadratic scaling in @xmath0 is not a good scaling for a fixed distance between the qubits .",
    "the product state @xmath288 in the steady state regime in eq .   performs better then a w state in eq .   and",
    "is for large @xmath0 equal to the maximal attainable qfi with symmetric dicke states ( @xmath222 ) .",
    "we conclude the section with the graphical comparison of the performance of different families of states for gradient estimation in fig .",
    "[ fig : scaling_equidistant ] , under the assumption of ( a ) full or ( b ) no _ a priori _ knowledge about the offset field @xmath3 .",
    "the model described in section  [ sec : gradient_estimation_theory ] can be generalized to an arbitrary known spatial distribution @xmath289 of the @xmath68 component of the magnetic field .",
    "we can consider an experiment for the estimation of the strength @xmath72 of a spatial magnetic field distribution given by @xmath290 where the function @xmath289 is known .",
    "e.g. due to the quadratic zeeman effect it may be known that the field has to be quadratic in @xmath73 such that @xmath291 as depicted in fig .",
    "[ fig : particles_in_field ] .",
    "the hamiltonian in eq",
    ".   is then generalized by replacing @xmath292 by @xmath293 , for @xmath294 .",
    "the labeling of particles is then imposed by the ordering of the values of magnetic field i.e. @xmath295 . under these slight modifications essentially",
    "all the results presented in this paper carry over . in particular , the bounds on the precision given by the qfi in eq .   and eq .   for the case of full",
    "_ a priori _ knowledge of @xmath3 , and in eq",
    ".  , for the case of no _ a priori _ knowledge are valid in this generalized model .",
    "acts on each particle , depending on its position .",
    "the particles are labeled such that the smallest magnetic field acts on the first and the highest magnetic field on the last particle .",
    ", scaledwidth=45.0% ]    also the optimal states and the optimal measurements attaining these bounds do not change .",
    "furthermore , the optimal positioning for the case of full _ a priori _ knowledge about @xmath3 is to put all qubits at the position @xmath296 that maximizes @xmath297 . for the case of no",
    "_ a priori _ knowledge about @xmath3 it is optimal to put half of the qubits at the position @xmath298 that minimizes @xmath297 and the other half of the qubits at the position @xmath296 that maximizes @xmath297 .",
    "note that one has to keep in mind that the above analysis is valid under the assumption @xmath299 ( which corresponds to the condition @xmath118 from the note given in the end of sec .",
    "[ sec : gradient_estimation_theory ] ) .",
    "if this assumption is dropped all the results for the case of no knowledge about @xmath3 ( decoherence free states ) still carry over .",
    "however , for the case of complete knowledge @xmath3 , the precise form for the optimal states and formulas for maximal fisher information change .",
    "although one can still recover the solution by substituting @xmath292 by @xmath293 in the appropriate formulas given in appendix  [ app : maxfi ] .",
    "equidistant spacing + & @xmath300 & @xmath301^{2}$]&@xmath302 & @xmath303 & + & @xmath288 & @xmath304&@xmath305 & @xmath306 & + & @xmath224 & @xmath307^{2}$ ] & @xmath308 & @xmath309 & + & @xmath288 & @xmath310 $ ] & @xmath311 & @xmath312 & +    we presented a systematic analysis of the ultimate limits in precision for the estimation of a gradient of a spatially - varying magnetic field in systems of cold atoms and trapped ions .",
    "the position degrees of freedom were treated classically and taken as fixed .",
    "we used the framework of quantum metrology to study two extreme scenarios : ( i ) the case when the magnetic offset field is known and ( ii ) the case , where the magnetic offset field is not _ a priori _ known .    for the first case ( i ) we have introduced the bounds in precision for gradient estimation analogous to the standard quantum limit ( maximal possible accuracy with separable states ) and the heisenberg limit ( maximal possible accuracy with entangled states ) known form the usual phase estimation scenario .",
    "moreover , we have identified the optimal probe states , that is a ghz state [ see eq .  ] .",
    "it is then optimal to put all qubits as far away as possible from the point @xmath71 , where the magnetic offset field is known .",
    "this leads to a magnetic field measurement , similar to a magnetic offset field measurement , but at a different place .",
    "for the second case ( ii ) we found that ghz states are completely useless ( @xmath313 ) for the estimation of a magnetic field gradient . in the absence of knowledge about @xmath3",
    "effective super - selection rules restrict the class of allowed states to decoherence - free states .",
    "we proved that the decoherence - free state given in eq .   with @xmath222 excitations",
    "is optimal and does not depend on the positions of the qubits . here , the optimal positioning is , to put half of the qubits at one place and the other half as far away as possible .",
    "we also showed that the performance of optimal decoherence - free states is generically comparable to optimal ghz states in the case of complete knowledge about @xmath3 .",
    "both optimal states can be prepared with high fidelities in experiments with trapped ions up to @xmath131 and cold atoms up to @xmath132 .    for both scenarios , we identified the parity measurement in the @xmath73 basis as the optimal measurement saturating the quantum cramr - rao bounds for gradient estimation .",
    "this measurement is feasible in experiments considered in this work , as for the positions of the particles can be considered fixed and local measurement of @xmath314 can be easily performed .    finally , we investigated the effect of collective phase noise .",
    "collective phase noise can be interpreted as an erasure of knowledge about the magnetic offset field and continuously interpolates between scenario ( i ) and ( ii ) for strong noise or rather long probing times .",
    "we found a critical time @xmath255 for which the ghz state performs as good as the odf state with @xmath222 excitations .",
    "for @xmath315 ghz states perform better then odf states and for @xmath316 odf states outperform ghz states .",
    "these results are summarized in the decision diagram in fig .",
    "[ fig : flowchart ] .",
    "values of the qfi for different positioning and different states in the two cases ( i ) and ( ii ) are summarized in table  [ tab : overview ] .    for further work",
    ", it would be interesting to take the uncertainty in positioning of the qubits into account .",
    "furthermore , in certain setups there is a coupling between the internal and external degrees of freedom , i.e. the spin and the position @xcite .",
    "this requires an adaption of our ideas .",
    "also , the investigation of precision limits and optimal strategies for estimating both the offset field @xmath3 , the gradient @xmath72 and higher derivatives could be interesting .",
    "finally , another interesting topic for further studies is the performance of random multiparticle states @xcite for gradient estimation .",
    "we are grateful to iagoba apellaniz , michael johanning , janek koodyski , morgan mitchell , and christina ritz for interesting and fruitful discussions .",
    "this work has been supported by the european research council ( consolidator grants tempoq/683107 and qitbox ) , spanish mineco ( qibeqi fis2016 - 80773-p , and severo ochoa grant no .",
    "sev-2015 - 0522 ) , fundacio privada cellex , generalitat de catalunya ( grant no .",
    "sgr 874 , 875 , and cerca programme ) , the friedrich - ebert - stiftung , the fqxi fund ( silicon valley community foundation ) , and the dfg .",
    "in this part we derive the maximal values of the qfi for gradient estimation for an arbitrary position of @xmath71 , in which the offset field is assumed to be perfectly known .",
    "let us first introduce the auxiliary notation @xmath317 .",
    "moreover , just like in the main text let us label the qubits in such a way that @xmath318 . by virtue of eq .   we can focus on maximizing @xmath319 $ ] , where @xmath320 let us note that the above hamiltonian can be diagonalized by the computational basis @xmath321 the symbol @xmath322 labels the set of positions of particles which are in the state @xmath323 and is formally defined by @xmath324 note that @xmath322 can be arbitrary ( in particular it can be also the empty set ) .",
    "the eigenvalue corresponding to the eigenvector @xmath325 is given by @xmath326 where @xmath327 denotes the complement of the set @xmath322 in the set @xmath328 .",
    "the maximal eigenvalue @xmath40 is given by @xmath329 with the corresponding eigenvector that is @xmath330 , where @xmath331 let @xmath332 be the minimal number with @xmath333 , that is the number of particles on the left side of @xmath71 .",
    "now , using the ordering @xmath334 we find @xmath335 because of @xmath336 we get @xmath337 and @xmath338 finally , by virtue of eq .  , eq . , and eq .  , we obtain @xmath339 ^ 2\\ , , \\ ] ] with the optimal state given by @xmath340 note that for @xmath341 this state happens to be the optimal decoherence - free state @xmath224 .",
    "in this part of the appendix we compute expectation values of the parity operator @xmath252 on the families of quantum states investigated in this paper .",
    "these computations are relevant for the computations involving the classical fisher information and the error propagation formula given the main text .      recall that @xmath342 . using the identities @xmath343 \\ket{0}^{{\\otimes}n},\\ ] ]",
    "@xmath344   \\ket{1}^{{\\otimes}n},\\ ] ] and the property @xmath345 we obtain @xmath346.\\ ] ]      let @xmath347 , where @xmath348 in this part we compute the expectation value of the parity @xmath349 on the noisy state @xmath350 . using eq .",
    "we find @xmath351 \\ ,   \\end{split}\\end{aligned}\\ ] ] where @xmath352 is given below eq .   in appendix  [ app : ghx_under_noise ] .",
    "from the above expression and using @xmath353 , we get @xmath354 finally , repeating essentially the same computations as the ones from section  [ subsub : ghz ] we obtain @xmath355\\ .\\ ] ]      repeating the analogous computations to these given in appendix  [ subsub : ghz ] for @xmath356 we obtain @xmath357 } \\ket{a}\\ , \\ ] ] @xmath358 \\ket{b } \\ , \\ ] ] where we denoted @xmath359 and @xmath360 . using the above expressions together with the identity @xmath361 we obtain    @xmath362    where @xmath363 .",
    "analogous computations to the ones performed in section  [ sec : full_a_priori_knowledge ] can be performed to show that the classical fisher information for the measurement of the projective povm @xmath364 , associated with the eigenspaces of @xmath144 , also gives the qfi for the optimal states .",
    "more precisely @xmath365 for @xmath366 and @xmath367 .",
    "this result can be also derived from the monotonicity of qfi under coarse - graining , i.e. , @xmath368 where @xmath369 is a povm obtained by coarse - graining of a povm @xmath370 i.e for every outcome @xmath21 we have @xmath371 for some stochastic matrix @xmath372 ( we call a matrix @xmath372 stochastic if and only if @xmath373 and for every @xmath9 we have @xmath374 ) . a measure @xmath138 , describing the measurement of the parity in @xmath73 basis @xmath375 , can be obtained as follows : first , measuring the projective measurement @xmath364 .",
    "second , output `` + 1 '' or `` -1 '' depending on the number of excitations contributing to the observed eigenvalue of @xmath144 .",
    "therefore , @xmath138 is coarse - graining of @xmath376 and thus , by the virtue of eq .",
    "we obtain eq .   for arbitrary state @xmath10 .",
    "the aim of this section is to show that for a suitable chosen value of the initial relative phase in a state @xmath377 it is possible to saturate the quantum cramr - rao bound with the measurement of @xmath252 , even in the presence of of collective phase noise .",
    "our reasoning essentially mimics the one given in the previous section . setting @xmath378 and using we",
    "obtain @xmath379 \\ , \\ ] ] with @xmath380 . using this formula in the error propagation formula given in eq .",
    "we get @xmath381}{\\left[d(t)\\gamma t \\sum_{i=1}^n ( x_i - z)^2 \\right]^2 \\sin^2\\left[\\alpha(t)\\right]}\\ , , \\\\ & = \\frac{1+\\left[1-d(t)^2\\right ] \\mathrm{cot}^2\\left[\\alpha(t)\\right]}{\\left[d(t)\\gamma t \\sum_{i=1}^n ( x_i - z)^2 \\right]^2 } \\ , .",
    "\\end{split}\\end{aligned}\\ ] ] from this we see that @xmath382=0 $ ] ( for a suitable choice of the initial phase @xmath177 ) if the quantum cramr - rao bound [ in this case given by the inverse of the qfi in eq . ] is saturated .",
    "in this section we will assume full _ a priori _ knowledge about @xmath3 .",
    "we calculate the qfi first for ghz states in presence of noise and then for optimal states for arbitrary position @xmath71 in presence of noise .      due to the noise",
    ", the probe state @xmath17 evolves into a mixed state @xmath383 where @xmath168 $ ] describes the noise acting on the system .",
    "the diagonal entries of the probe state do not change @xmath384 .",
    "however , the off - diagonal ones do .",
    "the ghz state has only two non - zero off - diagonal entries @xmath385 , where @xmath386 for a state of dimension @xmath387 . for these entries",
    "we find @xcite @xmath388_{0,q}&= \\mathrm{exp}\\left[-{\\mathrm{i}}\\gamma ' n \\int_0^t\\delta e(\\tau ) \\mathrm { d}\\tau \\right]\\operatorname{\\varrho}_{0,q}\\ , . \\end{split}\\end{aligned}\\ ] ] now we use the fact that @xmath389\\rangle=\\exp[-\\frac{1}{2}\\delta^2\\delta\\varphi]$ ] for an unbiased gaussian distribution of @xmath160 that means that @xmath390 . with the fact that the variance @xmath391 we can calculate @xmath392\\right\\rangle=\\exp\\left[-\\frac{1}{2}(\\gamma ' n)^2 c(t)\\right ]   \\end{aligned}\\ ] ] with @xmath393 . substituting @xmath394 and @xmath395 and using @xmath161 and@xmath162 $ ]",
    "we find @xmath396 together , we find the @xmath0-particle ghz state evolves in presence of collective phase noise into the state @xmath397 with @xmath398 $ ] .",
    "this state in its eigendecomposition is given by the non - zero eigenvalues @xmath399 and the corresponding eigenvectors @xmath400 . in order to compute the qfi for a noisy ghz state and for estimating @xmath72 we use eq .",
    "and eq .  , with the final result @xmath401 ^ 2 \\ , \\end{split}\\end{aligned}\\ ] ] where all other terms in eq .",
    "vanish since @xmath402      let @xmath332 be the minimal number with @xmath333 , that is the number of particles on the left side of @xmath71 .",
    "then , in appendix [ app : maxfi ] we showed that the optimal state is given by @xmath340 following the calculations from the previous section we find the averaged state for a given time @xmath86 @xmath403 with @xmath404.\\end{aligned}\\ ] ] in the cases of @xmath405 and @xmath406 the optimal state is a ghz state @xmath407 and we find @xmath408 .",
    "the non - zero eigenvalues of @xmath409 are given by @xmath410 with the corresponding eigenvectors @xmath411 now we can use the fact that @xmath412 to evaluate the qfi for estimating @xmath72 that is given by @xmath413",
    "in the noiseless case , the product state @xmath288 is the best classical probe state .",
    "we now want to understand , what noise ( loosing information about @xmath3 ) does to the scaling for this state .",
    "the state @xmath414 is a mixture of symmetric dicke states @xmath415 @xcite with probabilities @xmath416 , where @xmath417 .",
    "recall first that @xmath418 where we set for convenience @xmath419 .",
    "we perform the calculations analogous to the ones given in ref .  @xcite . because of the fact that @xmath98 preserves subspaces @xmath207 and @xmath420 we have @xmath421 and therefore the qfi reduces to @xmath422 with @xmath423 being the variance of @xmath98 in the state @xmath415 .",
    "the second term of the variance is the squared expectation value @xmath424 , which is given by @xmath425 using the symmetry of the state .",
    "the expectation value of the squared operator @xmath426 is @xmath427 ^ 2}{{\\ensuremath{\\mathcal{d}}}_n^k}&=\\sum_{i , j=1}^{n } f_i f_j \\bk{{\\ensuremath{\\mathcal{d}}}_n^k| \\frac{\\sigma_z^{(i)}}{2 } \\frac{\\sigma_z^{(j)}}{2}}{{\\ensuremath{\\mathcal{d}}}_n^k}\\\\&=\\sum_{i=1}^n f_i^2\\underbrace{\\bk{{\\ensuremath{\\mathcal{d}}}_n^k|\\left ( \\frac{\\sigma_z^{(i)}}{2}\\right)^2}{{\\ensuremath{\\mathcal{d}}}_n^k}}_{=1/4}\\\\&+ \\sum_{i \\neq j=1}^n f_if_j\\bk{{\\ensuremath{\\mathcal{d}}}_n^k| \\frac{\\sigma_z^{(i)}}{2 } \\frac{\\sigma_z^{(j)}}{2}}{{\\ensuremath{\\mathcal{d}}}_n^k}. \\end{split}\\end{aligned}\\ ] ] using the symmetry of the state @xmath428 for arbitrary @xmath282 and @xmath429 , we can rewrite the second term @xmath430 together the variance is given by @xmath431.\\label{app : eq : qfi_dicke } \\end{split}\\end{aligned}\\ ] ] here , all terms with @xmath71 vanish .",
    "therefore , @xmath432 is independent of @xmath71 . using @xmath433",
    ", we can calculate the qfi @xmath434.\\label{app : eq : qfi_prod_steady } \\end{split}\\end{aligned}\\ ] ]    for the maximization of eq .   over the positioning",
    "@xmath148 we can state :    let @xmath0 be an even natural number and let @xmath435 then , the restriction of @xmath436 to the domain @xmath437 $ ] attains the maximum value for @xmath438 , for @xmath439 and @xmath440 for @xmath441 .",
    "a direct computation shows that for any @xmath442 we have @xmath443 therefore , the problem of maximizing @xmath436 in the domain specified by the restrictions @xmath437 $ ] can be reduced to the problem of maximizing this function for its arguments satisfying @xmath444 $ ] . for such restrictions setting half of @xmath75 equal to @xmath445 and",
    "the other half equal to @xmath446 maximizes @xmath447 while at the same time minimizing @xmath448 .",
    "thus , such configuration maximizes @xmath436 for @xmath444 $ ] . coming back to the original interval we get the thesis of the lemma .",
    "in this section we derive the bounds in precision for gradient estimation under the assumption of no _ a priori _ knowledge about the offset field @xmath3 .",
    "in particular , we will prove eq .",
    ", eq .  , eq .  , and given in section  [ sec : no_a_priori_knowledge ] .",
    "let us start with proving eq . which reads @xmath449 \\,.\\ ] ] in order to prove this equation we first recall the connection @xmath450 $ ] .",
    "then , for the `` hamiltonian '' quantum fisher information we have @xmath451=   \\sum_{k=0}^n p_k   \\operatorname{\\mathnormal{f_q}\\!}[\\operatorname{\\varrho}_k , h_g]\\ , \\ ] ] where @xmath452 is a probability distribution and states @xmath453 are supported on @xmath207 .",
    ".   follows from the fact that @xmath98 preserves decoherence - free subspaces @xmath207 and the `` additivity '' qfi under the convex combinations of states supported on orthogonal subspaces @xcite .",
    "the identity in eq .   follows now from the linearity of the right - hand side of eq .   in @xmath454 and the fact that decoherence - free states are precisely of the form @xmath455 for @xmath453 supported on @xmath207 .",
    "the optimal value of the qfi on @xmath456 can be found by using eq .",
    "and eq .  .",
    "let @xmath457 and @xmath458 denote the maximal and respectively minimal eigenvalues of @xmath459 ( the formula for @xmath98 is given for example in eq .  ) . using the monotonicity of the coefficients @xmath460 with @xmath461 we get @xmath462",
    "the corresponding eigenvectors are given by @xmath463 using ( [ eq : restricted optimal ] ) and ( [ eq : resticted minimal ] ) we get @xmath464 from eq .   and",
    "eq .   we obtain the explicit formula for the maximal qfi on @xmath465 , @xmath466^{2}\\ , \\ ] ] where @xmath217 . from eq .",
    "we find that the above value is attained for the state @xmath467 we have therefore proved eq .",
    "and eq .  .",
    "we conclude by noting that the right hand side of eq .",
    "is a monotonic function of @xmath209 for @xmath468 and @xmath469 - see fig .",
    "[ fig : particles_sums ] for a graphical explanation of this fact .",
    "therefore , the qfi is maximal for @xmath470 , where @xmath471 is the smallest integer smaller or equal to @xmath472 that is called the floor of @xmath472 .",
    "using eq .",
    "we get @xmath473^{2}\\,,\\label{app : eq : max fischer}\\ ] ] this maximum is obtained for the state @xmath474\\,,\\label{eq : optimaldecohstatenice}\\ ] ] where @xmath475 is the highest integer greater or equal to @xmath472 that is called the ceil of @xmath472 .",
    "let us note that if @xmath0 is not even also the state    @xmath476    attains the maiximal qfi in eq .  .",
    "first , @xmath477 is subtracted from @xmath478 .",
    "these differences will be summed up .",
    "then , the qfi is given by the square of the sum .",
    "for @xmath479 the number of terms in the summation increases with @xmath209 and decreases with @xmath209 for @xmath480 .",
    "this is due to the fact , that the summation cutoff is given by @xmath481 . in total",
    ", @xmath482 is a monotonic function of @xmath209 for @xmath483 .",
    ", scaledwidth=40.0% ]      consider @xmath0 particles that are set to be located in the interval @xmath484 $ ] . here",
    ", @xmath485 is an arbitrary point .",
    "we are interested in how to optimally locate the qubits in order to get the best possible accuracy for the estimation of @xmath72 ( for fixed @xmath0 and @xmath122 ) . according to eq .",
    "the maximal qfi , attainable with a state from the @xmath486 is given by @xmath487^{2}\\,.\\label{eq : optimfisheven}\\ ] ] the maximum of over the locations of all particles @xmath488 is attained for @xmath489 for @xmath490 and @xmath491 for @xmath492 or vice versa . then the maximal qfi is given by @xmath493    let us note that in the case when @xmath0 is odd the position of the `` middle '' particle can be arbitrary .",
    "we want to emphasize that the scaling behaviour ( with respect to @xmath0 and @xmath122 ) of the ( over the choice of @xmath494 s ) optimized qfi is preserved if one picks the optimal state which is invariant to the considered noise model .      in the noiseless case",
    "the ghz state is optimal for gradient estimation when @xmath3 is known .",
    "however , collective phase noise causes an erasure of knowledge about the offset field @xmath3 . in the limit of no knowledge about @xmath3",
    "we found an optimal state from the @xmath486 given in eq .   with @xmath495 . in total",
    "the maximal attainable qfi for this state is smaller then for the ghz state in the noiseless case .",
    "therefore , in this section we calculate the measurement time @xmath255 in which both perform similar .",
    "the qfi for ghz states in presence of collective phase noise is given by @xmath496 ^ 2\\ , , \\ ] ] with @xmath398 $ ] .",
    "the qfi for the optimal state from the @xmath486 with @xmath495 is given by @xmath497^{2}\\,.\\ ] ] then , we can calculate the critical time @xmath255 by setting both equal and solve for @xmath86 .",
    "in realistic experiments the correlation time @xmath498s and the measurement time @xmath499ms .",
    "such that we can assume @xmath500 which leads to @xmath501 and we find @xmath502\\right\\}^{1/2}}{n\\gamma ' \\delta e}\\,,\\ ] ]",
    "in fig .  [ fig : max_qfi_vs_k ] we illustrated the qfi with a state from the @xmath486 with @xmath209 excitations for different kinds of spatial distributions of the qubits .",
    "for these , we used the following functions : the optimal spatial distribution for the positioning of the qubits is marked in black in fig .  [ fig : max_qfi_vs_k ] and is given by @xmath503 the spatial distribution marked by the color darker grey ( purple ) , is given by @xmath504\\right\\}\\,.\\ ] ] the equidistant spatial distribution marked in grey ( red ) is given by @xmath505 and the spatial distribution marked by lighter grey ( yellow ) , is given by @xmath506\\right\\}\\,.\\ ] ]                      s.  wildermuth , s.  hofferberth , i.  lesanovsky , s.  groth , p.  krger , and j.  schmiedmayer , appl .",
    "lett . * 88 * , 264103 ( 2006 ) ; h.  cable and g.  a.  durkin , phys .",
    "lett . * 105 * , 013603 ( 2010 ) ; m .- k .",
    "zhou , z .- k .",
    "hu , x .- c .",
    "duan , b .-",
    "sun , j .- b .",
    "zhao , and j.  luo , phys .",
    "a * 82 * , 061602(r ) ( 2010 ) .",
    "g.  balasubramanian , i.  y.  chan , r.  kolesov , m.  al - hmoud , j.  tisler , c.  shin , c.  kim , a.  wojcik , p.  r.  hemmer , a.  krueger , t.  hanke , a.  leitenstorfer , r.  bratschitsch , f.  jelezko , and j.  wrachtrup , nature * 455 * , 648 ( 2008 ) ; s.  y.  huang , a.  nummenmaa , t.  witzel , t.  duval , j.  cohen - adad , l.  l.  wald , and j.  a.  mcnab , neuroimage * 106 * , 464 ( 2015 ) ; m.  s.  grinolds , m.  warner , k.  de greve , y.  dovzhenko , l.  thiel , r.  l.  walsworth , s.  hong , p.  maletinsky , and a.  yacoby , nat . nanotechnol .",
    "* 9 * , 279 ( 2014 ) .",
    "t.  monz , p.  schindler , j.  t.  barreiro , m.  chwalla , d.  nigg , w.  a.  coish , m.  harlander , w.  hnsel , m.  hennrich , and r.  blatt , phys .",
    "lett . * 106 * , 130506 ( 2011 ) ; see also t.  monz , _ quantum information processing beyond ten ion - qubits _ ( phd thesis , university of innsbruck ) , available at www.quantumoptics.at/images/ publications / dissertation / monz_diss.pdf ."
  ],
  "abstract_text": [
    "<S> we develop a general theory to estimate magnetic field gradients in quantum metrology . </S>",
    "<S> we consider a system of @xmath0 particles distributed on a line whose internal degrees of freedom interact with a magnetic field . </S>",
    "<S> classically , gradient estimation is based on precise measurements of the magnetic field at two different locations , performed with two independent groups of particles . </S>",
    "<S> this approach , however , is sensitive to fluctuations of the off - set field determining the level - splitting of the ions and therefore suffers from collective dephasing , so we concentrate on states which are insensitive to these fluctuations . </S>",
    "<S> states from the decoherence - free subspace ( dfs ) allow to measure the gradient directly , without estimating the magnetic field . </S>",
    "<S> we use the framework of quantum metrology to assess the maximal accuracy of the precision of gradient estimation . </S>",
    "<S> we find that states from the dfs achieve the highest measurement sensitivity , as quantified by the quantum fisher information and find measurements saturating the quantum cramr - rao bound .    </S>",
    "<S> # 1 # 1 # 1#2 # 1#2    # 1#2 </S>"
  ]
}