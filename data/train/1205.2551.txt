{
  "article_text": [
    "semi - markov processes ( smp ) are a wide class of stochastic processes which generalize at the same time both markov chains and renewal processes .",
    "the main advantage of smp is that they allow the use of whatever type of waiting time distribution for modeling the time to have a transition from one state to another one . on the contrary ,",
    "markovian models have constraints on the distribution of the waiting times in the states which should be necessarily represented by memoryless distributions ( exponential or geometric for continuous and discrete time cases respectively ) .",
    "this major flexibility has a price to pay : the parameters to be estimated are more numerous .",
    "+ semi - markov processes ( smp ) generalizes also non - markovian models based on continuous time random walks extensively used in the econophysics community , see for example @xcite .",
    "smp have been used to analyze financial data and to describe different problems ranging from credit rating data modeling @xcite to the pricing of options @xcite .    with the financial industry becoming fully computerized ,",
    "the amount of recorded data , from daily close all the way down to tick - by - tick level , has exploded .",
    "nowadays , such tick - by - tick high - frequency data are readily available for practitioners and researchers alike @xcite .",
    "it seemed then natural to us trying to verify the semi - markov hypothesis of returns on high - frequency data , see @xcite . in @xcite",
    "we proposed a semi - markov model showing its ability to reproduce some stylized empirical facts such for example the absence of autocorrelations in returns and the gain / loss asymmetry . in that paper",
    "we showed also that the autocorrelation in the square of returns is higher with respect to the markov model .",
    "unfortunately this autocorrelation was still too small compared to the empirical one . in order to overcome the problem of low autocorrelation , in another paper @xcite we proposed an indexed semi - markov model for price return .",
    "more precisely we assumed that the intraday returns ( up to one minute frequency ) are described by a discrete time homogeneous semi - markov process where we introduced a memory index which takes into account the periods of different volatility in the market .",
    "it is well known that the market volatility is autocorrelated , then periods of high ( low ) volatility may persist for long time .",
    "we made the hypothesis that the kernel of the semi - markov process depend on which level of volatility the market is at that time .",
    "it is to be remarked that the weighted memory index is a stochastic process which do depend on the same markov renewal chain @xmath0 to which the semi - markov chain is associated .",
    "then , in our model , the high autocorrelation is obtained endogenously without introducing external or latent auxiliary stochastic processes . to improve",
    "further our previous results , in this work , we propose an exponentially weighted index which will be described in the following .",
    "the database used for the analysis is made of high frequency tick - by - tick price data from all the stock in italian and german stock market from first of january 2007 until end of december 2010 . from prices",
    "we then define returns at one minute frequency .",
    "the plan of the paper is as follows . in section 2",
    "we define the weighted indexed semi - markov chain model with memory and we explain how to perform a monte carlo simulation of its trajectory . in section 3 , we present the empirical results deriving from the application of our model to real stock market data . finally , in section 4 we present our conclusion .",
    "in this section we propose a generalization of the semi - markov process that is able to represent higher - order dependencies between successive observations of a state variable .",
    "one way to increase the memory of the process is by using high - order semi - markov processes as defined in @xcite and more recently reviseted and extended in a discrete time framework in @xcite .",
    "a more parsimonious model has been defined by @xcite and it is showed that it describes appropriately important empirical regularities of financial time series . in this paper",
    "we propose a further improvement of the indexed semi - markov chain model proposed in reference @xcite named weighted - indexed semi - markov chain ( wismc ) model which allows the possibility of reproducing long - term dependence in the square of stock returns in a very efficient way .",
    "let us assume that the value of the financial asset under study is described by the time varying asset price @xmath1 .",
    "the return at time @xmath2 calculated over a time interval of lenght @xmath3 is defined as @xmath4 .",
    "the return process changes value in time , then we denote by @xmath5 the stochastic process with finite state space @xmath6 and describing the value of the return process at the @xmath7-th transition .",
    "+ let us consider the stochastic process @xmath8 with values in @xmath9 .",
    "the random variable @xmath10 describes the time in which the @xmath7-th transition of the price return process occurs .",
    "+ let us consider also the stochastic process @xmath11 with values in @xmath12 .",
    "the random variable @xmath13 describes the value of the index process at the @xmath7-th transition .",
    "+ in reference @xcite the process @xmath14 was defined as a reward accumulation process linked to the markov renewal process @xmath15 ; in @xcite the process @xmath14 was defined as a moving average of the reward process . here , motivated by the application to financial returns , we consider a more flexible index process defined as follows : @xmath16 where @xmath17 is a borel measurable bounded function and @xmath18 is known and non - random .",
    "+ the process @xmath13 can be interpreted as an accumulated reward process with the function @xmath19 as a measure of the weighted rate of reward per unit time .",
    "the function @xmath19 depends on the current time @xmath20 , on the state @xmath21 visited at current time and on the parameter @xmath22 that represents the weight .",
    "+ in next section a specific functional form of @xmath19 will be selected in order to produce a real data application .",
    "+ to construct the wismc model we have to specify a dependence structure between the variables . toward this end",
    "we adopt the following assumption : @xmath23\\\\ & = \\mathbb{p}[j_{n+1}=j,\\ : t_{n+1}-t_{n}\\leq t |j_{n}=i , u_{n}^{\\lambda}=v]:=q_{ij}^{\\lambda}(v;t ) , \\end{aligned}\\ ] ] where @xmath24 is the natural filtration of the three - variate process .",
    "+ the matrix of functions @xmath25 has a fundamental role in the theory we are going to expose , in recognition of its importance , we call it @xmath26 @xmath27 @xmath28 .",
    "+ the joint process @xmath29 depends on the process @xmath13 , the latter acts as a stochastic index .",
    "moreover , the index process @xmath13 depends on @xmath29 through the functional relationship @xmath30 .",
    "+ observe that if @xmath31=\\mathbb{p}[j_{n+1}=j,\\ : t_{n+1}-t_{n}\\leq t |j_{n}=i]\\ ] ] for all values @xmath32 of the index process , then the weigthed indexed semi - markov kernel degenerates in an ordinary semi - markov kernel and the wismc model becomes equivalent to classical semi - markov chain model as presented for example in @xcite and @xcite .",
    "+ the triple of processes @xmath33 describes the behaviour of the system only in correspondence of the transition times @xmath10 . to describe the behavior of our model at whatever time @xmath2",
    "which can be a transition time or a waiting time , we need to define additional stochastic processes . + given the three - dimensional process @xmath33 and the weighted indexed semi - markov kernel @xmath34 , we define by @xmath35 where @xmath36 .",
    "+ the stochastic processes defined in @xmath37 represent the number of transitions up to time @xmath2 , the state of the system ( price return ) at time @xmath2 and the value of the index process ( weighted moving average of function of price return ) up to @xmath2 , respectively .",
    "we refer to @xmath38 as a weighted indexed semi - markov process .",
    "+ the process @xmath39 is a generalization of the process @xmath13 where time @xmath2 can be a transition or a waiting time .",
    "it is simple to realize that if @xmath40 we have that @xmath41 .",
    "+ let @xmath42,\\ ] ] be the transition probabilities of the embedded indexed markov chain .",
    "it denotes the probability that the next transition is in state @xmath43 given that at current time the process entered in state @xmath44 and the index process is equal to @xmath45 .",
    "it is simple to realize that @xmath46 let @xmath47 be the sojourn time cumulative distribution in state @xmath48 : @xmath49= \\sum_{j\\in e}q_{ij}^{\\lambda}(v;t).\\ ] ] it expresses the probability to make a transition from state @xmath44 with sojourn time less or equal to @xmath2 given the indexed process is @xmath45 .",
    "+ the conditional waiting time distribution function @xmath50 expresses the following probability : @xmath51.\\ ] ] it is simple to establish that @xmath52 in the papers @xcite and @xcite explicit renewal - type equations were given to describe the probabilistic behavior of the indexed semi - markov chain .",
    "it is possible to derive similar results for the wismc model but here we prefer to not report these results applied to our model because , in the implementation of the model given in the next section , we follow a monte carlo simulation based approach .",
    "monte carlo methods are very useful for simulating the system behavior and represent a way of generate replicable results . in the following we give a monte carlo algorithm in order to simulate a trajectory of a given wismc in the time interval @xmath53 $ ] .",
    "the algorithm consists in repeated random sampling to compute successive visited states of the random variables @xmath54 , the jump times @xmath55 and the index values @xmath56 up to the time @xmath57 .",
    "+ the algorithm consists of 5 steps : + 1 ) set @xmath58 , @xmath59 , @xmath60 , @xmath61 , horizon time@xmath62 ; + 2 ) sample @xmath63 from @xmath64 and set @xmath65 ; + 3 ) sample @xmath66 from @xmath67 and set @xmath68 ; + 4 ) set @xmath69 ; + 5 ) if @xmath70 stop + else set @xmath71 and go to 2 ) .",
    "in the following we show as our model performs comparing its statistical features and those of real data returns .",
    "the comparison is done by means of monte carlo simulations according to the algorithms described in the previous section .    for our analysis",
    "we choose 4 stocks from two databases of tick - by - tick quotes of real stocks from the italian stock exchange (  borsa italiana \" ) and the german stock exchange (  deutsche brse \" ) .",
    "the chosen stocks are eni and fiat from the italian database and allianz and volkswagen from the german database.the period used goes from january 2007 to december 2010 ( 4 full years ) .",
    "the data have been re - sampled to have 1 minute frequency .",
    "the number of returns analyzed is then roughly @xmath72 for each stock .    to be able to model returns",
    "has a semi - markov process the state space has been discretized . in the 4 examples shown in this work , we discretized returns into 5 states chosen to be symmetrical with respect to returns equal zero and to keep the shape of the distribution unchanged .",
    "returns are in fact already discretized in real data due to the discretization of stock prices which is fixed by each stock exchange and depends on the value of the stock .",
    "just to make an example , in the italian stock market for stocks with value between 5.0001 and 10 euros the minimum variation is fixed to 0.005 euros ( usually called tick ) .",
    "we then tried to remain as much as possible close to this discretization . in figure [ discr ]",
    "we show an example of the discretization of the returns of one of the analyzed stocks .",
    "the model described in the previous section requires the specification of a function @xmath19 in the definition of the weighted index @xmath13 in ( [ funcrela ] ) .",
    "let us briefly remind that volatility of real market is long range positively autocorrelated and then clustered in time .",
    "this implies that , in the stock market , there are periods of high and low volatility .",
    "motivated by this empirical facts we suppose that also the transition probabilities depends on whether the market is in a high volatility period or in a low one . in a previous work @xcite , for simplicity reason , we used a moving average of the squares of returns as the index variable @xmath73 . in that case",
    "we imposed that the index depended only on a memory @xmath74 which was the number of transitions in the past used for the moving average . in this work we decided to use a more appropriate expression for @xmath19 .",
    "we use an exponentially weighted moving average ( ewma ) of the squares of returns which as the following expression : @xmath75 and consequently the index process becomes @xmath76 the index @xmath77 was also discretized into 5 states of low , medium low , medium , medium high and high volatility .",
    "an example of the discretization used in the analysis is shown in figure [ discu ] .",
    "a very important feature of stock market data is that , while returns are uncorrelated and show an i.i.d . like behavior ,",
    "their square or absolute values are long range correlated .",
    "it is very important that theoretical models of returns reproduce this features .",
    "we then tested our model to check whether it is able to reproduce such behavior .",
    "given the presence of the parameter @xmath22 in the index function , we tested the autocorrelation behavior as a function of @xmath22 .",
    "note that in the definition of the index variable the ewma is performed over all the previous square of returns each with its weight . before summing over all past returns we decided to check whether a better memory time @xmath74 exists .",
    "for this reason we checked our model also against this other parameter . with this choice formula",
    "@xmath78 takes the form : @xmath79 we remind the definition of the autocorrelation function : if @xmath80 indicates returns , the time lagged @xmath81 autocorrelation of the square of returns is defined as @xmath82 we estimated @xmath83 for real data and for returns time series simulated with different values of the memory time @xmath74 and the weights @xmath22 . the time lag @xmath84 was made to run from 1 minute up to 100 minutes .",
    "note that to be able to compare results for @xmath83 each simulated time series was generated with the same length as real data . in figure [ fig1 ]",
    "we show the mean square error between @xmath83 obtained from real and simulated returns ( using definition @xmath85 for the index process ) for the four stocks analyzed and for different @xmath74 and @xmath22 .     and for different values of @xmath22.,height=340 ]",
    "let us make some considerations on the results shown in figure [ fig1 ] : @xmath74 should be chosen as big as possible and then definition @xmath78 is appropriate as far as @xmath22 is chosen less than @xmath3 , in fact , in this last case definition ( [ ewma ] ) becomes equivalent to a moving average without weights and results presented in @xcite hold for @xmath74 . in figure [ fig2 ]",
    "we show again the mean square error but only as a function of the weights @xmath22 then using definition @xmath78 for the index process .",
    ".,height=340 ]    we can notice that the behavior is very similar for the different analyzed stocks even if the best value for @xmath22 is not the same for all of them . as it is possible to see the best values of @xmath22 for the stocks fiat , eni , allianz and volkswagen are @xmath86 , @xmath87 , @xmath87 and @xmath88 , respectively .",
    "+ the comparison between the autocorrelations for the best values of @xmath22 for each stock and real data is shown in figure [ fig3 ] .",
    "this figure shows that real and synthetic data have almost the same autocorrelation function for the square of returns .",
    "+ we tested our model also to verify if it is able to reproduce the feature shown by real data regarding the first passage time ( fpt ) distribution @xcite .",
    "let us remind here the definition of fpt : the fpt for an investment made at time @xmath2 at price @xmath1 is defined as the time interval @xmath89 , @xmath90 where the relation @xmath91 is fulfilled for the first time .",
    "we will denote the fpt as @xmath92 .",
    "then @xmath93 in @xcite we have shown how to calculate analytically such distribution for a semi - markov process then we will not repeat that here . using the best values for @xmath22 for each stock fiat , eni , allianz and volkswagen and choosing a value @xmath94 for all of them we compare in figure [ fpt ] results for the first passage time distribution for each stock .",
    "it can be noticed that they are almost identical improving the results obtained for a simple semi - markov process presented in @xcite .",
    "the results obtained here improve those obtained in our previous work @xcite even further showing that the semi - markov approach is adequate to model high frequency financial time series .",
    "we have modeled financial price changes through a semi - markov model where we have added a weighted index .",
    "our work is motivated by two main results : the existence in the market of periods of low and high volatility and our previous work @xcite , where we showed that an indexed semi - markov model , is able to capture almost all the correlation in the square of returns present in real data .",
    "the results presented here show that the semi - markov kernel is influenced by the past volatility and that its influence decreases exponentially with time .",
    "in fact , if the past volatility is used as an exponentially weighted index , the model is able to reproduce almost exactly the behavior of market returns : the returns generated by the model are uncorrelated while the square of returns present a long range correlation very similar to that of real data .",
    "we have also shown , by analyzing different stocks from different markets ( italian and german ) , that results do not depend on the particular stock chosen for the analysis even if the value of the weights may depends on the stock .",
    "we stress that out model is very different from those of the arch / garch family .",
    "we do not model directly the volatility as a correlated process .",
    "we model returns and by considering the semi - markov kernel conditioned by a weighted index the volatility correlation comes out freely .",
    "99              d.m .",
    "guillaume , m.m .",
    "dacorogna , r.r .",
    "davve , j.a .",
    "mwuller , r.b .",
    "olsen , o.v .",
    "pictet . _ from the birds eye to the microscope : a survey of new stylized facts of the intra - daily foreign exchange markets _ , finance and stochastics * 1 * , ( 1997 ) , 95 - 129 .",
    "barbu , v. and limnios , n. ( 2008 ) . _ semi - markov chains and hidden semi - markov models toward applications_. springer - verlag new york inc",
    ". i. simonsen .",
    "jensen , a. johansen , _ optimal investment horizons _",
    "j. 27 ( 2002 ) 583 ."
  ],
  "abstract_text": [
    "<S> in this paper we propose a new stochastic model based on a generalization of semi - markov chains to study the high frequency price dynamics of traded stocks . </S>",
    "<S> we assume that the financial returns are described by a weighted indexed semi - markov chain model . </S>",
    "<S> we show , through monte carlo simulations , that the model is able to reproduce important stylized facts of financial time series as the first passage time distributions and the persistence of volatility . </S>",
    "<S> the model is applied to data from italian and german stock market from 1 january 2007 until the end of december 2010 . </S>"
  ]
}