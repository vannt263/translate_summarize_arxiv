{
  "article_text": [
    "a great variety of physical processes and chemical reactions occurs due to nonadiabatic transitions between adiabatic electronic states , often mediated by conical intersections @xcite .",
    "nonadiabatic transitions are of quantum nature and , in general , should be described with quantum mechanical theory .    while for small molecular systems the nonadiabatic effects",
    "can indeed be investigated in detail with quantum mechanical methods , for larger systems these methods are computationally too expensive .",
    "example of such systems are biomolecules , atomic and molecular clusters , molecular complexes and condensed matter .",
    "for this reason , more approximate classical or semiclassical computational methods are becoming an important alternative because their lower computational cost scales more favorably with the system size .",
    "moreover , these methods can provide intuitive insight into the dynamics of a chemical reaction @xcite .",
    "particularly interesting for practical purposes are mixed quantum ",
    "classical approaches which treat the electronic motion quantum - mechanically and the nuclear motion classically .",
    "several quasi - classical methods exist for the treatment of the nonadiabatic nuclear dynamics .",
    "well - known examples are the semiclassical initial - value representation ( ivr ) @xcite , the ehrenfest dynamics method @xcite , the frozen gaussian wave - packet method @xcite , the propagation of classical trajectories with surface hopping @xcite , as well as the multiple - spawning wave - packet method @xcite ; see the leading perspective@xcite of the special issue dedicated to nonadiabatic nuclear dynamics .",
    "also the mathematical literature provides rigorous analytical results on nonadiabatic nuclear dynamics@xcite .",
    "one of the most widely used mixed quantum - classical approaches for simulating nonadiabatic dynamics is the classical trajectory surface - hopping method with its many variants .",
    "to the best of our knowledge , the combination of classical trajectories and surface hopping was first introduced by @xcite , though with reduced dimensionality .",
    "they proposed to branch a classical trajectory into two trajectories after traversing a nonadiabatic region which had to be specified beforehand .",
    "the more systematic classical trajectory surface - hopping approach was proposed by @xcite based on the deterministic ( `` ants '' ) procedure or / and on the probabilistic ( `` anteater '' ) method . in the latter , classical trajectories remain unbranched and a random decision is made whether to hop or not , depending on a hopping probability . in both papers ,",
    "nonadiabatic transition probabilities were estimated in an approximate way within the landau - zener ( lz ) model @xcite , with parameters calculated beforehand .",
    "@xcite have also used semiclassical methods to investigate the hopping probability and to prove lz model usage .",
    "later , @xcite proposed a probabilistic approach in which hopping points were not specified beforehand but determined during the trajectory propagation , based on a maximum of the nonadiabatic time - derivative coupling matrix element . approaches to localize nonadiabatic regions by a local minimum for an adiabatic splitting",
    "have been proposed by @xcite as well as @xcite .",
    "in contrast to these approaches , where nonadiabatic transitions are localized , @xcite proposed the fewest - switches approach , which extended the classical trajectory surface - hopping method to an arbitrary number of states and to situations in which transitions can occur anywhere , not just at localized regions .",
    "this is achieved by a solution of the time - dependent schrdinger equation along classical trajectories in combination with the probabilistic fewest - switches algorithm that decides at each integration time step whether to switch the electronic state . since then , many variants of the classical trajectory surface - hopping approaches have been proposed and applied to different physical phenomena and processes .",
    "the main differences between different classical trajectory surface - hopping versions are in two features : ( i ) how a nonadiabatic region ( a seam ) is defined , and ( ii ) when and how a hopping probability is determined .",
    "the present paper is addressed to these questions in connection with a conical intersection case .",
    "the simplicity of the classical trajectory surface - hopping technique renders it attractive for the study of high - dimensional quantum systems which are difficult or unreachable for quantum treatments . today , trajectory",
    "surface - hopping calculations are widely employed in the context of so - called _ ab initio _ molecular dynamics , that is , the forces for the trajectory calculation and the nonadiabatic couplings are computed `` on - the - fly '' with _ ab initio _ or semiempirical electronic - structure methods , see , e.g. , ref .  @xcite .",
    "nevertheless , many surface - hopping methods have been derived and tested for one- or two - dimensional cases . in the present paper , we treat a two - dimensional two - state model for studying nonadiabatic transitions in the vicinity of a conical intersection by different classical trajectory approaches .",
    "a classical trajectory surface - hopping simulation of nonadiabatic dynamics involves the following steps : ( i ) sampling of the initial condition , ( ii ) performing classical trajectory calculations on multi - dimensional adiabatic potential energy surfaces ( pes ) , ( iii ) accounting for nonadiabatic effects through surface hopping according to specified criteria , and ( iv ) evaluation of the observables of interest from the ensemble of trajectories .",
    "the important feature distinguishing different surface - hopping approaches is the way of calculating nonadiabatic transition probabilities .",
    "there are several solutions to this problem , many of them based on the lz model , see , e.g. , @xcite . although the lz model provides the simple formula for a nonadiabatic transition probability ( see below ) , it is formulated as a one - dimensional problem in a two - state diabatic representation . in practical applications to polyatomic systems however , nonadiabatic transitions occur in a multi - dimensional space and quantum - chemical data are usually provided in an adiabatic representation , for example , for an on - the - fly study . moreover , often only adiabatic pess are available , not nonadiabatic couplings . as is well known , in contrast to adiabatic states , diabatic states are not uniquely defined , and diabatic representations obtained by the same procedure in two - state and in multiple - state cases may deviate substantially @xcite .",
    "lastly , a determination of lz parameters is often troublesome in practical applications of the conventional lz formula .",
    "two novel formulas have recently been proposed for nonadiabatic transition probabilities within the lz model : the diabatic multi - dimensional formula @xcite and the adiabatic - potential - based transition probability formula @xcite adapted for classical trajectory surface - hopping studies .",
    "the former was derived when mathematically analysing effective dynamics through conical intersections@xcite and tested on the two - state three - mode model of pyrazine @xcite by means of the single switch classical trajectory surface - hopping algorithm , while the latter was applied to inelastic multi - channel atomic collisions by means of the branching classical trajectory @xcite and the branching probability current algorithms @xcite .",
    "the formula derived in ref .",
    "@xcite is easy implemented in practice as it only requires the information about adiabatic potentials ( see below ) .",
    "it should be mentioned that @xcite have derived the formula for the lz transition probability written in terms of several parameters that are expressed via adiabatic potentials , but the zhu - nakamura formula is different from the adiabatic - potential - based formula @xcite .",
    "@xcite have calculated transition probabilities by means of the conventional lz formula with diabatic lz parameters determined from adiabatic potentials along a trajectory .",
    "their approaches are also different from the one of ref .",
    "the adiabatic - potential - based formula has been applied so far to nonadiabatic transitions in atomic collisions@xcite .",
    "thus , the main goal of the present work is to study different versions of classical trajectory surface - hopping algorithms based on the novel formulas for nonadiabatic transition probabilities within the landau - zener model in their applications to a two - state two - dimensional model for a conical intersection .",
    "in addition , we test probabilistic versus deterministic versions of the algorithm and study simulation performance for several consecutive nonadiabatic transition phases .",
    "we also explore the possibilities of visualizing nonadiabatic dynamics by surface - hopping simulations .",
    "molecular quantum motion is governed by the schrdinger operator @xmath0 where @xmath1 and @xmath2 denote electronic and nuclear repulsion , respectively , and @xmath3 the attraction between electrons and nuclei . by a rescaling of the nuclear coordinates",
    ", we can assume that all nuclei have identical mass  @xmath4 .",
    "then , the kinetic energy operators are @xmath5 where @xmath6 and @xmath7 denote laplacians with respect to the nuclear and electronic coordinates .",
    "moving to atomic units ( @xmath8 ) and defining @xmath9 the molecular hamiltonian rewrites as @xmath10    let @xmath11 be the electronic hamiltonian for a given position @xmath12 of the nuclei .",
    "let @xmath13 be two adiabatic potential energy surfaces ( pes ) , that is , two eigenvalues of the electronic hamiltonian .",
    "we assume that each eigenvalue is of multiplicity one and that both are well separated from the rest of the electronic spectrum .",
    "then , by time - dependent born ",
    "oppenheimer theory @xcite , the effective nuclear quantum motion is governed by the time - dependent nuclear schrdinger equation @xmath14 where the potential @xmath15 takes values in the real symmetric @xmath16 matrices and is given in a global diabatic representation as @xmath17 we note that by the definition of a diabatic matrix , the potential energy surfaces are its eigenvalues . in the present work , we assume the existence of a conical intersection , that is , @xmath18 is a manifold of codimension two of the nuclear configuration space .",
    "then , one has to account for nonadiabatic transitions between the eigenspaces associated with the potential energy surfaces .    for notational convenience , we write the diabatic matrix as the sum of a centric dilation and its trace - free part , @xmath19 and",
    "express the two potential energy surfaces as @xmath20 their gap is denoted by @xmath21 the corresponding eigenvectors of @xmath22 satisfy @xmath23 .",
    "they are uniquely determined up to a phase and are singular at conical intersection points .",
    "our choice for the phase is @xmath24 with mixing angle @xmath25 .",
    "we write the wave function at time @xmath26 as a linear combination of the eigenvectors @xmath27 with scalar - valued functions @xmath28 and @xmath29 .",
    "we use the wigner functions of the scalar components @xmath30 which map phase space points @xmath31 to the real numbers .",
    "the @xmath32-scaling of the wigner function allows the direct relation to the position , momentum , and kinetic energy operators , @xmath33 for the nuclear degrees of freedom .",
    "indeed , up to normalizing factors , we obtain the corresponding expectation values of the upper and the lower adiabatic surface as @xmath34 more general expectation values for the weyl quantization @xmath35 of a phase space function @xmath36 are accordingly written as @xmath37 these are the observables whose dynamics can be approximated by surface hopping algorithms .",
    "cross - term quantities like @xmath38 , which require relative phase information of the upper and the lower surface components can not be obtained , since the wigner functions @xmath39 and @xmath40 determine the functions @xmath28 and @xmath29 only up to a global phase factor .",
    "the class of surface hopping algorithms to be investigated is determined by the following steps :    \\(i ) sampling of the initial condition : we choose phase space points @xmath41 so that @xmath42 for the observables @xmath36 of interest .",
    "this is achieved by monte carlo or quasi - monte carlo sampling of the initial wigner functions @xmath43 .",
    "we note that an unrefined sampling of the initial husimi functions deteriorates the approximation@xcite .",
    "\\(ii ) classical trajectory calculations : the chosen phase space points are evolved along the trajectories of the corresponding classical hamiltonian system @xmath44 since the observables of interest are computed by phase space averaging , these classical equations of motion should be discretized symplectically as e.g. by the strmer  verlet method or by higher order symplectic runge ",
    "kutta schemes@xcite .",
    "\\(iii ) surface hopping : whenever the eigenvalue gap becomes minimal along an individual classical trajectory a nonadiabatic transition occurs .",
    "let @xmath45 be a classical trajectory associated with the upper or the lower surface . whenever the function @xmath46 attains a local minimum , a transition to the other eigenspace is performed according to a landau  zener transition probability . in the following sections  [ sec : differentlz ] and  [ sec : transitionschemes ] , different landau - zener formulas and transition schemes",
    "will be discussed in more detail .",
    "\\(iv ) evaluation of the observables : at some time  @xmath26 , the surface hopping algorithm has resulted in phase space points @xmath47 .",
    "then , the expectation values of interest are approximated according to @xmath48 where the individual weight @xmath49 depends on the initial sampling and the employed transition scheme , see  [ sec : transitionschemes ] .",
    "we compare two recent formulas for nonadiabatic transition probabilities .",
    "both of them are applied whenever the eigenvalue gap becomes minimal along an individual classical trajectory @xmath45 , that is , when the function @xmath46 attains a local minimum .",
    "we denote corresponding critical times and phase space points by @xmath50 and @xmath51 respectively .",
    "the first formula is a multi - dimensional landau ",
    "zener formula derived from a global diabatic representation of the potential matrix@xcite @xmath52 where @xmath53 denotes the @xmath54 gradient matrix of the vector @xmath55 defining the trace - free part of the diabatic potential matrix @xmath22 .",
    "the second formula is the purely gap and trajectory based , adiabatic formula@xcite @xmath56 contrary to the diabatic formula , the building blocks of the adiabatic one are accessible also in cases when a diabatic potential matrix is missing , which is often the case for the simulation of polyatomic systems .",
    "a simple calculation reveals the connection between the two lz formulas : depending on the potential energy surface @xmath57 guiding the classical motion , we have @xmath58 with @xmath59 where @xmath60 denotes the hessian matrix of @xmath61 . since @xmath62 ,",
    "the difference between the two formulas is dominated by the gap size and negligible for trajectories with small minimal gap .",
    "nevertheless , we observe a notable difference .",
    "the diabatic formula has the same functional form for transitions originating from the upper or the lower surface , while the adiabatic formula implicitly depends on the surface with which the hopping trajectory is associated .",
    "one can algorithmically interprete nonadiabatic transitions with lz probabilities either in a deterministic way with branching trajectories or probabilistically with surface hopping trajectories .",
    "the probabilistic method is appealing , since it is less costly from the computational point of view .",
    "the deterministic branching process has been mathematically analysed@xcite and has been proven to be asymptotically correct in the semiclassical limit @xmath63 , provided that at the same time @xmath50 and in the same phase point @xmath51 only upper or lower surface trajectories initiate nonadiabatic transitions .",
    "this restriction is due to the neglect of relative phase information for the upper and the lower wavefunctions @xmath64 and @xmath65 .",
    "the numerical experiments presented later confirm the mathematical assessment of the algorithm s properties .",
    "for the deterministic branching process@xcite , at a critical point @xmath66 of minimal gap a trajectory splits into two , and a new branch is created on the other surface . the weight of the new trajectory is equal to the old weight multiplied by the landau  zener probability @xmath67 , while the weight of the trajectory remaining on the same surface is multiplied by @xmath68 . at time @xmath26 , we are left with a certain number of classical trajectories distributed along the upper and the lower surface .",
    "let us indicate with @xmath69 the number of trajectories on the upper surface and with @xmath70 the corresponding weights .",
    "each weight @xmath71 is the product of the initial sampling weight @xmath72 and a certain number of landau  zener probabilities .",
    "corresponding expectation values are computed according to ( [ eq : gridex ] ) .",
    "we note that the number of trajectories may rapidly increase as time evolves , demanding more memory storage and increasing computational costs .      in constrast to the deterministic method , the probabilistic version of the surface hopping algorithm keeps the number of trajectories constant during all the simulation time . in this case , once a classical trajectory attains a local gap minimum , we compute the lz probability @xmath67 and compare it with a pseudo random number @xmath73 generated from a uniform distribution on @xmath74 $ ] .",
    "if @xmath75 the trajectory hops on the other surface , otherwise it continues along the same surface .",
    "the weights in the expectation summation ( [ eq : gridex ] ) are all equal to @xmath72 .      in both methods described above",
    ", a choice has to be made regarding the point in phase space at which a trajectory appears on the other energy surface at the moment of a nonadiabatic transition . for clarity ,",
    "let us consider a transition from the upper to the lower surface .",
    "we denote with @xmath76 the point on the upper surface , in which the trajectory attains a local gap minimum , and with @xmath77 the point on the lower surface , in which a new trajectory is initiated .",
    "our choice is @xmath78 for the position , and we rescale the momentum according to @xmath79 with @xmath80 to ensure conservation of energy . the value of @xmath81 is computed by simply imposing @xmath82 leading to @xmath83 .",
    "analogously for transitions from the lower to the upper surface , we have @xmath84 , where we neglect the transition if the trajectory does not have enough kinetic energy to compensate the difference in the potential energy .",
    "this particularly simple momentum adjustment seems natural from the classical trajectory point of view , since it treats each newly generated trajectory as a continuation of its generator , while ensuring that both trajectories have the same classical energy .",
    "moreover , it only depends on the adiabatic surfaces and their gap . with respect to the direction of the momentum adjustment ,",
    "the literature contains various other , more complicated choices , such as the normal direction to a predefined surface of ( avoided ) intersection@xcite or the direction of the nonadiabatic coupling vector@xcite defined as @xmath85 .",
    "we now compare the two landau  zener transition probabilities for the schrdinger equation  ( [ eq : schro ] ) associated with a linear jahn  teller matrix @xmath86 where the quadratic term confines the motion around the conical intersection located at the origin .",
    "the strength of the confinement is chosen to be @xmath87 , while for the semiclassical parameter we set @xmath88 .",
    "these values are comparable with those obtained by ab initio electronic structure calculations for the triangular silver molecule@xcite .",
    "the initial wave packet is localized entirely on the upper surface and is given by @xmath89 where @xmath90 the initial position center is @xmath91 , so that the wave packet is localized close to the conical intersection .",
    "the final simulation time @xmath92 roughly corresponds to @xmath93 fs and allows the wavefunction to pass the conical intersection four times .    as previously developed for the computation of expectation values via the wigner function @xcite",
    ", the initial wigner function @xmath94 is sampled by a quasi - monte carlo technique so that @xmath95 for the observables @xmath35 of interest .",
    "we have used @xmath96 halton points @xmath97 , which deterministically approximate the uniform distribution on the unit cube @xmath98 , and have mapped them by the inverse of the cumulative distribution function of @xmath99 one - dimensional gaussian distributions to approximate the @xmath99-dimensional gaussian distribution given in equation  ( [ eq : wo ] ) .",
    "the corresponding convergence rate for the approximation of expectation values scales as @xmath100 compared to the @xmath101 scaling characterizing plain monte carlo .    the numerical integration of the classical trajectories",
    "is implemented using a 4th order symplectic runge - kutta time - stepping method , while , in order to estimate the second derivative @xmath102 for the evaluation of the adiabatic lz probability , a 4th order accurate central finite difference scheme is used .",
    "the simulations presented below are performed both in the deterministic and the probabilistic setting . for each numerical experiment",
    ", we compute the values of the surface populations and the expected values of the momentum and position , that is , @xmath103 for @xmath104 , @xmath105 and @xmath106 , respectively .",
    "these expected values are compared with reference solutions computed by solving the schrdinger equation ( [ eq : schro ] ) via a numerically converged strang splitting scheme using the fast fourier transform for the computation of the laplacian .",
    "this grid - based reference solution @xmath107 approximates@xcite the solution  @xmath108 of the schrdinger equation ( [ eq : schro ] ) with an accuracy of @xmath109 .",
    "we compare the time evolution of the above mentioned observables when using the two different lz formulas for nonadiabatic transition probabilities . in fig .",
    "[ fig : pop ] we show the population of the upper and lower surfaces calculated in the deterministic setting . as suggested by our previous analysis , the curves associated with probabilities computed by the two different lz formulas are almost indistinguishable and in good agreement with the reference .",
    "the slight deterioration of both surface hopping approximations after the third and fourth nonadiabatic passage ( around time @xmath110fs and @xmath111fs , respectively ) are due to unresolved interference effects between the upper and the lower wave packet components .",
    "this effect is also visible in fig .",
    "[ fig : error ] later on ."
  ],
  "abstract_text": [
    "<S> a class of surface hopping algorithms is studied comparing two recent landau - zener ( lz ) formulas for the probability of nonadiabatic transitions . </S>",
    "<S> one of the formulas requires a diabatic representation of the potential matrix while the other one depends only on the adiabatic potential energy surfaces . for each classical trajectory , </S>",
    "<S> the nonadiabatic transitions take place only when the surface gap attains a local minimum . </S>",
    "<S> numerical experiments are performed with deterministically branching trajectories and with probabilistic surface hopping . </S>",
    "<S> the deterministic and the probabilistic approach confirm the affinity of both the lz probabilities , as well as the good approximation of the reference solution computed by solving the schrdinger equation via a grid based pseudo - spectral method . </S>",
    "<S> visualizations of position expectations and superimposed surface hopping trajectories with reference position densities illustrate the effective dynamics of the investigated algorithms . </S>"
  ]
}