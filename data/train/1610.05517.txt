{
  "article_text": [
    "the main goal in output regulation is to find a controller such that the output of a given plant asymptotically follows a given reference signal generated by an exosystem .",
    "it is known that a regulating feedback controller contains a built - in copy of the exosystem @xcite .",
    "robustness of regulation is needed in order to make the controller work despite some perturbations of the plant , e.g. , parameter uncertainties and modelling errors .",
    "if the controller is required to tolerate all arbitrarily small perturbations of the plant , then the internal model principle due to francis and wonham @xcite and davison @xcite states that if the plant has @xmath0-dimensional output space , then every robustly regulating controller must contain a @xmath0-fold copy or in short @xmath0-copy of the exosystem .    in this paper",
    "we study the robust regulation problem in a situation where the controller is only required to tolerate uncertainties from a restricted class @xmath1 of perturbations .",
    "such a situation can arise due to several different reasons . in the simplest situation",
    ", @xmath1 contains only a finite number of plants , for example , if our controller is required to function after specific component failures  @xcite . in the case of only one possible failure , the original plant @xmath2 changes to a new plant @xmath3 and @xmath4 . on the other hand , the class @xmath1 becomes infinite in a situation where the values of some specific parameters of the plant are not known accurately @xcite .",
    "our example in section  [ sec : example ] illustrates the latter case .    in the situation where robustness is only required with respect to a given class @xmath1 of perturbations , it is natural to ask if the controller must contain full @xmath0-copy internal model of the exosystem .",
    "this problem was studied by paunonen in  @xcite using state space methods .",
    "it was shown in  @xcite that the @xmath0-copy internal model guaranteeing robustness with respect to all small perturbations can be relaxed in many situations , and this observation leads to design of controllers with so - called _ reduced order internal models_.    in this paper , we introduce frequency domain conditions for a controller to achieve output regulation and robustness with respect to a given class @xmath1 of perturbations .",
    "our results give a precise meaning for reduced order internal models in the frequency domain .",
    "in addition , we present methods for constructing controllers with reduced order internal models .",
    "our constructions result in minimal complexity requirements for the number of copies built into the robustly regulating controllers .",
    "we choose the reference signal to be of the form @xmath5 the class of signals that can be presented in this form is fairly large as it contains reference signals that are linear combinations of sinusoids , and in particular finite approximations of uniformly continuous periodic signals .    in the first part of this paper we present our theoretical results .",
    "our first main result shows that a stabilizing controller @xmath6 where @xmath7 is analytic at @xmath8 , is robustly regulating for the class @xmath1 of perturbed plants if and only if @xmath9 for all @xmath10 .",
    "this is the frequency domain analogue of the time domain condition that was presented in  @xcite .",
    "the condition   leads to our second main results that gives a lower bound for the ranks of the matrices @xmath11 in the controller .",
    "in particular , if the plants have the same number @xmath0 of inputs and outputs and @xmath12 are invertible at @xmath13 , then the lower bounds for the ranks of @xmath11 in the controller   that is robust with respect to the class @xmath1 are @xmath14 the controller constructions presented shows that the bounds @xmath15 are optimal , as our method results in controllers satisfying @xmath16 for @xmath17 . in the frequency domain",
    "the controller containing a full @xmath0-copy internal model of the exosystem satisfies @xmath18 for all @xmath19  @xcite . in light of results ,",
    "the frequency domain interpretation is that the controller   contains a _ reduced order internal model _ if @xmath20 for some @xmath19 . in a situation",
    "where @xmath21 for some @xmath19 , e.g. , when @xmath22 and @xmath1 contains only two plants , robust output regulation can then be achieved without the full internal model of the exosystem .    in the second part of the paper",
    "we construct a controller to solve the robust output regulation problem for a given class of perturbations @xmath1 .",
    "the design procedure is a two step process where we first stabilize the system and then design a robustly regulating controller for the stabilized plant .",
    "the robust regulation of the stabilized plant is carried out using the controller @xmath23 where @xmath24 are chosen in such a way that they satisfy the regulation condition and have ranks @xmath15 defined in  .",
    "in addition , we choose @xmath11 such that the eigenvalues of @xmath25 have nonpositive real parts . we show that for such choices of parameters there exists @xmath26 such that for any @xmath27 controller stabilizes the closed - loop system .",
    "controllers of this type have been used in robust output regulation with full internal models in  @xcite .    in the final part of the paper",
    "we illustrate the results by designing a robustly regulating controller for a laboratory process with five water tanks . in the studied experimental setup",
    "the restricted class of perturbations arises naturally from considering the unknown valve positions of the water tank system as parameters with uncertainty . by design the controller with a reduced order internal model achieves output regulation irregardless of the valve positions .",
    "robust output regulation with a restricted class of perturbations has been studied previously using frequency domain techniques for stable systems in  @xcite by the authors . in this paper",
    "we extend the results of  @xcite most notably by introducing a controller design procedure for unstable plants , by establishing the optimality of the presented lower bounds for @xmath28 , and by giving a new and simplified proof for the characterization   of robust controllers .",
    "our results also establish a new sufficient condition for the solvability of the robust output regulation problem for a class @xmath1 of perturbations . finally , we present a new real world example on construction of controllers with reduced order internal models .",
    "locatelli and schiavoni studied a similar control problem in  @xcite .",
    "however , in  @xcite the controller was required to be robustly regulating in a small neighborhood of a given finite set of plants , and consequently the controller required a full @xmath0-copy of the exosystem .",
    "in this section we introduce the notation used in this paper and state the robust output regulation problem .",
    "we denote the class of functions that are bounded and analytic in the right half plane @xmath29 by @xmath30 .",
    "the set of all matrices of arbitrary size and of all @xmath31-matrices over a set @xmath32 are denoted by @xmath33 and @xmath34 , respectively .",
    "we denote the rank , the range , the kernel , and the moore - penrose pseudoinverse of a matrix @xmath35 by @xmath36 , @xmath37 , @xmath38 , and @xmath39 , respectively .",
    "we assume that the class @xmath1 of perturbations has the following properties throughout the rest of the paper .    *",
    "the nominal plant is in the class @xmath1 , i.e. , @xmath40 .",
    "* every @xmath12 is analytic at the points @xmath41 .",
    "in this paper we assume that the error feedback controller is of the form , @xmath42 where @xmath24 and where @xmath43 is analytic at @xmath13 for all @xmath17 .",
    "this means in particular that the poles of the controller are located at the frequencies @xmath13 the reference signal   and that their orders are at most one .",
    "the plant and the controller form the closed loop depicted in fig .",
    "[ fig : closedloop ] . here",
    "@xmath44 is an external disturbance .",
    "the closed loop transfer function from @xmath45 to @xmath46 is @xmath47    fig1.eps ( 1,13)@xmath48 ( 17,12.5)@xmath49 ( 32.5,9)@xmath50 ( 59,12.5)@xmath51 ( 53,23)@xmath44 ( 74,9)@xmath52 ( 91,13)@xmath53    given a class @xmath1 of perturbations , choose the parameters @xmath7 and @xmath54 of the controller   in such a way that    * the controller @xmath55 stabilizes the plant @xmath2 , i.e. @xmath56 . * if @xmath12 is such that @xmath55 stabilizes @xmath57 , then @xmath58 where @xmath59 with distinct real numbers @xmath60 and @xmath61 .    if condition   is satisfied , we say that @xmath55 _ regulates _ @xmath12 . in the time - domain , this corresponds to the output @xmath62 converging to @xmath63 of asymptotically with respect to time .",
    "in this section we present a characterization for controllers that are robust with respect to a given class @xmath1 of perturbations .",
    "the following theorem is the main result of this section .",
    "[ thm : robchar2 ] assume the controller is of the form .",
    "* if @xmath10 is such that @xmath55 stabilizes @xmath57 , then @xmath55 regulates @xmath57 if and only if @xmath64 for all @xmath65 . *",
    "if @xmath55 stabilizes @xmath2 , then it solves the robust output regulation problem for the class @xmath1 of perturbations if and only if   is satisfied for all @xmath10 that are stabilized by the controller @xmath55 .",
    "the second part of the theorem  [ thm : robchar2 ] is a direct consequence of the first part and the statement of the robust output regulation problem . in order to prove the first part ,",
    "let @xmath10 be such that @xmath55 stabilizes @xmath57 and let @xmath65 be arbitrary . since @xmath66 is analytic at @xmath13 it has the taylor series expansion @xmath67 and since @xmath55 has a simple pole at @xmath13 it has the laurent series @xmath68 since @xmath69 is stable , it has the taylor series @xmath70 since @xmath71 , the coefficient of the term @xmath72 of the laurent series expansion on the left hand side is zero , i.e. @xmath73 similarly , since @xmath74 , comparing the constant terms we see that @xmath75    in order to show the sufficiency of , observe that implies that @xmath76 if the condition holds .",
    "thus @xmath77 does not have a pole at @xmath13 .",
    "consequently , if holds for all @xmath65 then @xmath55 is regulating .",
    "next we show the necessity of .",
    "if @xmath55 is regulating then @xmath77 is stable .",
    "this implies that @xmath78 .",
    "using , we see that @xmath79 . thus , the condition holds .",
    "if the controller @xmath55 solves the robust output regulation problem for a class @xmath1 of perturbations , then theorem  [ thm : robchar2 ] gives us the following optimal lower bounds for the ranks of the matrices @xmath11 .",
    "we call the bound @xmath80 of the theorem _ the minimal order of the internal model related . _    [ thm : minimumrank ] let @xmath80 be the minimum dimension over all the subspaces @xmath81 of @xmath82 satisfying @xmath83  here @xmath84 is the preimage of @xmath85  for all @xmath12 .",
    "a.   if @xmath55 of the form stabilizes all the plants in @xmath1 and solves the robust output regulation problem , then @xmath86 b.   if @xmath87 for all @xmath65 and @xmath2 is stabilizable , then there exists a robustly regulating controller satisfying @xmath88 for all @xmath65 .",
    "the second item is justified by section [ sec : contdesign ] . in order to prove the first item ,",
    "let @xmath89 be the rank of @xmath11 , and let @xmath90 be linearly independent columns of @xmath11 .",
    "we set @xmath91 .",
    "since @xmath55 is robustly regulating , theorem [ thm : robchar2 ] implies that for all @xmath12 there exists a vector @xmath92 such that @xmath93 thus , @xmath94 .",
    "it follows that @xmath95 .",
    "we want to point out that if @xmath96 is invertible for all @xmath12 , then @xmath97 since @xmath98 is a unique element .",
    "the second item implies the following sufficient solvability condition .",
    "[ cor : solvability ] the robust regulation problem is solvable if the plant @xmath2 is stabilizable , @xmath87 for all @xmath65 , and @xmath99 for all @xmath100 .    the input to output effect of the internal model is characterized by transmission zeros . in @xcite",
    "it was shown that the regulation condition implies that @xmath101 this simply means that there exists a transmission zero at @xmath8 blocking the pole of the reference signal .",
    "the transmission zero must be in the appropriate direction , which is determined by the plant @xmath66 and the reference signal @xmath85 .",
    "thus , the aim of the robust regulation is to find a controller that aligns the direction of the transmission zero with the reference signal for every plant in @xmath1 .",
    "this is achieved by building an internal model of large enough order into the controller . a way of doing this is proposed in section [ sec : contdesign ] .",
    "an internal model of order @xmath89 basically introduces @xmath89 overlapping transmission zeros . in the extreme case @xmath102",
    "there is a blocking zero , meaning that the whole transfer function vanishes at @xmath8 .",
    "this is what is required in the classical robust regulation .",
    "if we consider more than one reference signals , then the condition is required for all of them .",
    "for example , if there is an additional reference signal @xmath103 then is replaced by the condition @xmath104 this naturally increases the size of the internal model .",
    "in this section , we propose a two stage robust controller design .",
    "first stage is to find a stabilizing controller for the given nominal plant , and in the second stage a robust controller for the stabilized plant is found .",
    "combining the two controllers results in a robustly regulating controller for the nominal plant .",
    "we begin by showing that for stable plants there exists a simple robust controller , and then proceed to show how the design procedure is carried out for unstable plants .      the next theorem is the main result of this subsection and it gives a design procedure of a robustly regulating controller .",
    "the simple structure suffices because the nominal plant is stable .",
    "additional structure is needed for example if the plant is unstable ( see section [ sec : unstable ] ) or there are some other design goals , e.g , .",
    "optimization , which together with the minimal internal model leads to the controller .",
    "[ thm : contdesignstab ] assume that @xmath105 for all @xmath65 and that @xmath2 is stable .",
    "then the contoller @xmath106 solves the robust output regulation problem for a class @xmath1 of perturbations if the design parameters @xmath11 and @xmath107 are chosen in the following way :    1 .",
    "find a subspace @xmath81 such that @xmath83 and @xmath108 .",
    "2 .   choose a basis @xmath109 of @xmath81 .",
    "3 .   define @xmath110.\\end{aligned}\\ ] ] 4 .",
    "choose an invertible matrix @xmath111 so that the eigenvalues of @xmath112 are zero or have negative real parts , and that the jordan blocks related to the zero eigenvalue are trivial .",
    "5 .   set @xmath113 6 .",
    "choose suitably small @xmath107 to guarantee closed - loop stability .",
    "the proof of theorem [ thm : contdesignstab ] is divided into two theorems .",
    "theorem [ thm : designparameterck ] shows that the proposed controller is regulating and theorem [ thm : designparametere ] shows that with the choices made there exists a sufficiently small @xmath107 guaranteeing stability of the closed loop .    before proceeding",
    "further we discuss the choice of @xmath81 in the design procedure .",
    "the condition @xmath108 is not automatically satisfied if the rank of @xmath114 is less than @xmath0 .",
    "this can happen if the plant has transmission zeros at @xmath8 or there are less inputs than outputs . in the classical robust regulation",
    "it is well known that in order to stabilize the nominal plant with a controller containing a full internal model the plant must not have transmission zeros at the poles of the reference signal @xcite .",
    "indeed , the condition is not satisfied if @xmath115 and @xmath116 . in our case",
    ", @xmath2 may have transmission zeros or less inputs than outputs , since @xmath81 need not in general be @xmath82 .",
    "the choice @xmath81 achieving the minimal order internal model exists if @xmath114 has full rank since the condition @xmath108 is then trivially satisfied .",
    "a particular choice for @xmath81 would be @xmath117 with @xmath118 .",
    "the condition @xmath119 or equivalently @xmath120 is then needed @xcite . in general , choosing @xmath121 is not optimal , since @xmath15 can be strictly greater than the minimal order of the internal model related to the pole @xmath13 . on the other hand ,",
    "if @xmath96 are invertible for all @xmath12 , then item ( iii ) of theorem [ thm : minimumrank ] shows that @xmath122 is an optimal choice .",
    "[ thm : designparameterck ] let @xmath2 be stable and assume that @xmath123 for all @xmath100 .",
    "if @xmath11 of are as in , then the condition holds for every @xmath100 .",
    "we show that holds for arbitrarily chosen @xmath12 .",
    "since @xmath124 and @xmath83 there exists @xmath125 such that @xmath126 it follows that @xmath127 .",
    "[ thm : designparametere ] let @xmath2 be stable and assume that @xmath123 for all @xmath100 .",
    "if @xmath11 of are as in , then there exists @xmath128 such that @xmath55 of stabilizes @xmath2 for every @xmath129 $ ] .",
    "[ lem : localbound ] let @xmath2 be stable and assume that @xmath123 for all @xmath100 . if @xmath11 of are as in , then @xmath130 is bounded above in @xmath131 by a bound independent of @xmath132 .    by the choice of @xmath11 ,",
    "we know that the jordan blocks of @xmath133 related to the eigenvalue 0 are trivial , and that the non - zero eigenvalues of @xmath133 have negative real parts .",
    "this means that there exist a matrix @xmath32 and a matrix @xmath134 with eigenvalues that have negative real parts such that @xmath135 so @xmath136 since all the eigenvalues of @xmath137 have positive real parts , @xmath138 is analytic in @xmath131 . in addition , it approaches @xmath139 as @xmath140 .",
    "thus , it is bounded in @xmath131 . since @xmath141 it follows that @xmath142 is bounded in @xmath131 by a bound independent of @xmath132 .",
    "this shows the claim .",
    "_ proof of theorem  [ thm : designparametere ] .",
    "_ first we show that @xmath143 is stable for all sufficiently small @xmath107 . to this end",
    ", we choose @xmath144 and define the half discs @xmath145 our aim is to show the existence a constant @xmath146 such that @xmath143 is bounded in @xmath147 whenever @xmath148 , and of @xmath149 such that @xmath143 is bounded in @xmath111 whenever @xmath150 . then @xmath143 is stable for all @xmath129 $ ] where @xmath151 .    by the stability of @xmath2 and the definition of @xmath55 ,",
    "@xmath152 is bounded in @xmath147 .",
    "thus , there exists small enough @xmath146 such that @xmath143 is bounded in @xmath147 whenever @xmath153 .",
    "next we show the existence of suitable @xmath149 .",
    "we decompose @xmath154 where @xmath155 by lemma [ lem : localbound ] , @xmath156 is bounded in @xmath111 by a bound independent of @xmath157 .",
    "in addition , @xmath158 is bounded in @xmath111 since @xmath2 and @xmath159 are analytic in @xmath111 .",
    "the decomposition implies that we can choose @xmath149 such that @xmath160 is bounded in @xmath111 for all @xmath161 $ ] .",
    "this completes the proof of the stability of @xmath143 .",
    "since @xmath2 is stable , it remains to show the stability of @xmath162 . by the stability of @xmath143 and the decomposition , we only need to show that @xmath163 is stable . by the above discussion @xmath164",
    "can only have poles of order one .",
    "thus , it has the representation @xmath165 where @xmath166 is the projection to @xmath167 along @xmath168 and @xmath169 is an analytic function @xcite .",
    "since @xmath108 and @xmath124 we have that @xmath170 .",
    "consequently , @xmath171 , and @xmath172 is analytic .",
    "this completes the proof .",
    "@xmath173      for unstable plants ,",
    "the design procedure is given in the following theorem .",
    "it is based on the two stage approach proposed in ( * ? ? ?",
    "* section 5.3 ) .",
    "[ thm : contdesignunstab ] if the steps of items 1 and 2 below can be carried out , then the controller of step 3 is robustly regulating .    1 .",
    "stabilize the nominal plant @xmath2 using a stabilizing controller @xmath174 that does not possess poles at @xmath13 for @xmath175 .",
    "2 .   find a controller @xmath176 of form that stabilizes the plant @xmath177 and satisfies the condition for every @xmath100 .",
    "a robustly regulating controller of @xmath2 is given by @xmath178    [ rem : contdesign ] in step 2 we may use the approach proposed for stable plants if we choose the matrices @xmath179 implied by @xmath1 as earlier , but in we replace @xmath2 by @xmath180 when choosing @xmath111 . in particular ,",
    "if the plant @xmath2 is invertible at @xmath8 , then so is the stabilized plant @xmath180 , because @xmath174 does not posses poles at @xmath8 .",
    "it follows that step 2 of the above design procedure can be carried out .",
    "_ proof of theorem  [ thm : contdesignunstab ] . _",
    "theorem 5.3.6 of @xcite ( the generalization to the current case follows by ( * ? ? ?",
    "* section 8) ) shows that @xmath55 stabilizes @xmath2 since @xmath174 stabilizes @xmath2 and @xmath176 stabilizes @xmath180 .",
    "thus we only need to show that @xmath55 is regulating for @xmath100 .",
    "since @xmath174 does not possess poles at @xmath13 and @xmath176 is of the form , it is obvious that @xmath55 is of the form as well with the same matrices @xmath11 .",
    "the matrices @xmath11 satisfy the condition by assumption .",
    "let us consider the laboratory process of fig .",
    "[ fig : tanks ] with five water tanks .",
    "there is a hole in the bottom of each water tank and the water from the tanks four and five flows to the tanks below them .",
    "the three pumps with operating voltages @xmath181 , @xmath182 , induce a flow @xmath183 where @xmath184 is a constant . denote the deviation from the initial water levels of tank @xmath185 by @xmath186 , @xmath187 .",
    "the aim of our control problem is to choose the inputs @xmath181 so that the outputs @xmath188 follow the reference signal @xmath189 i.e. the water level of tank 1 is changing in a periodic manner while kept one unit above the initial level in the other two bottom tanks .                                      the parameters @xmath201 correspond to how the three valves are set prior to the experiment .",
    "the flow induced by the first pump to tank 1 is @xmath202 and @xmath203 to tank 5 , and similarly for the other two valves .",
    "the changes to the valve positions can be considered as perturbations to the system .",
    "the transfer function of the system linearized at the initial water levels is @xmath204 where the parameters @xmath205 and @xmath206 depend on the tank cross - sections , the outlet hole cross - sections , constants of proportionality @xmath207 , and the initial water levels . for more details ,",
    "see @xcite where a similar system with four tanks was considered .",
    "here we choose the initial setup so that @xmath208 and @xmath209 for simplicity , i.e. we have @xmath210 let the initial positions of the valves be @xmath211 , i.e. the nominal plant is @xmath212 the frequency domain representation of @xmath213 is @xmath214    in order to find a robustly regulating controller , we define a basis of @xmath215 for @xmath216 and @xmath217 .",
    "let @xmath218 be the @xmath185th natural basis vector of @xmath219 .",
    "because of the upper triangular block structure of @xmath96 , it is easy to deduce that @xmath220 and @xmath221 . following the design procedure of theorem [ thm : designparameterck ]",
    ", we choose @xmath222 and @xmath223 .",
    "now the controller satisfies the regulation property .",
    "it remains to choose invertible @xmath111 and small enough @xmath132 to guarantee stability .",
    "we can choose @xmath224 since all the eigenvalues of @xmath225 have positive real parts for every @xmath217 .",
    "if we choose @xmath226 , then we have @xmath227 in order to show that the controller is stabilizing for @xmath2 we note that the proof of theorem [ thm : designparametere ] shows that it is sufficient that @xmath143 is stable .",
    "the stability follows now by observing that the zeros of @xmath228 have negative real parts , i.e. @xmath143 can not have poles in the closed right half plane @xmath131 .",
    "we end this section by comparing the proposed design procedure to the classical one . here",
    "we have used the knowledge that the first two inputs do not affect the third output , i.e. , we have structured perturbations , whereas the classical design procedure ignores this fact and the perturbations are taken to be totally arbitrary .",
    "one should also note that small perturbations in the other parameters such as the hole or tank diameters do not affect the zero components of the plant transfer function , so actually we gain robustness for all small parameter changes . in our controller",
    "the internal model is minimal in the sense that the ranks of the matrices @xmath11 for @xmath217 are minimal . since @xmath229 and @xmath230 have rank two instead of rank three , which would be the case",
    "if classical approach is used , the order of the controller s realization is reduced by two .",
    "k. kim , s.  skogestad , m.  morari , and r.  d. braatz .",
    "necessary and sufficient conditions for robust reliable control in thepresence of model uncertainties and system component failures .",
    ", 70:6777 , 2014 .",
    "p.  laakkonen and l.  paunonen . a simple controller with a reduced order internal model in the frequency domain . in _ proceedings of the 15th european control conference",
    "aalborg , denmark , june 29  july 1 2016 ."
  ],
  "abstract_text": [
    "<S> the internal model principle states that all robustly regulating controllers must contain a suitably reduplicated internal model of the signal to be regulated . using frequency domain methods </S>",
    "<S> , we show that the number of the copies may be reduced if the class of perturbations in the problem is restricted . </S>",
    "<S> we present a two step design procedure for a simple controller containing a reduced order internal model achieving robust regulation . </S>",
    "<S> the results are illustrated with an example of a five tank laboratory process where a restricted class of perturbations arises naturally . </S>"
  ]
}