{
  "article_text": [
    "in 1962 m.j .",
    "wicks @xcite showed that any commutator in a free group or a free product of groups could always be reduced to a particular form .",
    "for any free group @xmath1 , a word @xmath2 in @xmath1 is a commutator in @xmath1 if and only if @xmath3 is conjugate to a cyclically reduced word of the form @xmath4 , with @xmath5 , where at most one of @xmath6 , @xmath7 and @xmath8 may be equal to the identity .    for any free product @xmath9 ,",
    "if @xmath10 is a commutator , either @xmath11 for some @xmath12 , @xmath13 , and @xmath14 is a commutator in @xmath15 , or some fully cyclically reduced conjugate of @xmath14 has one of the following forms .",
    "1 .   @xmath16 with @xmath17 , @xmath18 , @xmath19 for some @xmath13 , and @xmath20 conjugate to @xmath21 in @xmath22 ; or 2 .",
    "@xmath23 with @xmath17 , @xmath24 , @xmath25 for some @xmath13 , and @xmath26 ; or 3 .",
    "@xmath27 with @xmath28 for some @xmath13 and @xmath29 , @xmath30 for @xmath31 and @xmath32 , and either not all of @xmath33 are in any one free factor of @xmath34 or each of @xmath35 are nontrivial .",
    "call these ` forms ' for commutators in such groups .",
    "similar lists of forms have also been constructed in these settings for certain products of commutators , see @xcite and @xcite , and products of squares , see @xcite .",
    "in @xcite a.  vdovina described a procedure for constructing forms for elements of any genus @xmath36 in a free product .",
    "this involved an ` extension ' over the free product of the graph associated with some orientable word .",
    "( these terms are explained below ) . in this paper",
    "we establish a similar method for constructing forms for elements of genus @xmath36 in hyperbolic groups .",
    "we then use this to give a list of all the possible forms for commutators in hyperbolic groups as wicks did for free groups and free products .",
    "we begin by introducing a number of definitions including how we extend an orientable word over a hyperbolic group .",
    "this will put us in the position to state the main result of this paper ( see theorem [ thexp ] ) , a method for constructing genus @xmath36 forms in hyperbolic groups .",
    "we follow this by an example of how to implement this theorem . in section [ prelim ]",
    "we give preliminary results which will be needed throughout the proof of theorem [ thexp ] before moving on to the proof itself in section [ startthm ] .",
    "finally we end this paper by proving proposition [ propos ] in section [ commutators ] which states the possible forms for commutators in a hyperbolic group @xmath0 .",
    "let @xmath34 be a group and @xmath37 be @xmath38 elements in @xmath34 .",
    "we define the _ genus of @xmath39 _ , denoted @xmath40 , to be equal to @xmath41 , if @xmath41 is the smallest integer such that there exist elements @xmath42 , @xmath43 , @xmath44 , for @xmath45 and @xmath46 , with @xmath47\\ldots [ x_k , y_k].\\ ] ]    let @xmath48 be a hyperbolic group such that geodesic triangles in the cayley graph @xmath49 are @xmath50-thin .",
    "consider any word @xmath51 in @xmath1 .",
    "we denote the length of @xmath51 by @xmath52 .",
    "if @xmath53 then we say that the word @xmath51 is _ minimal _ in @xmath0 .",
    "clearly minimal words are represented by geodesic paths in @xmath49 .",
    "if @xmath51 is not minimal in @xmath0 then we use the notation @xmath54 to denote the length of a word minimal in @xmath0 which is equal to @xmath51 in @xmath0 .",
    "we can think of the @xmath50-thin condition as being equivalent to the following condition .",
    "let @xmath51 and @xmath55 be any words in @xmath1 which are minimal in @xmath0 , with @xmath56 and @xmath57 . if @xmath58    let @xmath59 be an infinite countable alphabet .",
    "we shall define a word in @xmath60 to be _",
    "orientable quadratic _",
    "if each letter appears exactly twice , once with exponent @xmath61 and once with exponent @xmath62 .    a orientable quadratic word @xmath51 is said to be _ redundant _ if there are letters @xmath63 and @xmath64 in @xmath60 which only occur in @xmath51 as subwords of the form @xmath65 .",
    "a word is called _ irredundant _ otherwise .    use the term _",
    "cyclic word _ to mean the equivalence class @xmath66 $ ] of a word @xmath51 under the relation which relates two words if one is a cyclic permutation of the other .",
    "when we talk about a word @xmath51 being cyclic we mean that @xmath51 is a representative of the equivalence class @xmath66 $ ] .",
    "if a word @xmath67 is both cyclic and orientable quadratic then @xmath67 is called an _ orientable word _ in @xmath60 .",
    "let @xmath68 be an orientable word .",
    "@xmath68 is called a _",
    "wicks form _ if the following conditions hold .    1 .",
    "@xmath68 is freely cyclically reduced and 2 .",
    "@xmath68 is irredundant .",
    "consider an orientable word @xmath67 of genus @xmath69 in @xmath70 , that is an orientable word such that @xmath71 .",
    "take the disc @xmath72 and divide its boundary into @xmath73 segments .",
    "write @xmath67 counterclockwise around the boundary of a disc , labelling each segment with a letter of @xmath67 .",
    "let the segments which are labelled by letters with exponent @xmath61 be oriented counterclockwise and the segments which are labelled by letters with exponent @xmath62 be oriented clockwise .",
    "now identify the segments labelled by the same letters , respecting orientation .",
    "we obtain a closed compact surface of genus @xmath69 . after identification the oriented boundary of the disc",
    "gives us an oriented graph embedded on this surface .",
    "we shall label this graph @xmath74 and call it the genus @xmath69 graph associated with @xmath67 .",
    "suppose that we have the orientable word @xmath75 we construct @xmath74 as shown in figure [ gammau ] .    ]",
    "that the graph @xmath76 associated to a wicks form @xmath68 contains no vertices of degree @xmath61 or @xmath77(if it did then rule @xmath61 or @xmath77 in the definition of a wicks form would be violated ) .",
    "let @xmath78 be any oriented connected graph such that an eulerian circuit exists in @xmath78 .",
    "here we are taking eulerian circuit to be a circuit which traverses every edge exactly twice once in each direction .",
    "let @xmath14 be a vertex of @xmath78 of degree @xmath79 and let the edges @xmath80 be incident to @xmath14 and oriented away from @xmath14 .",
    "note that these are not necessarily distinct , we may have loops .",
    "we define @xmath14 to be _ regular _ if the edges can be renumbered such that the cyclic subwords @xmath81 appear in an eulerian circuit .",
    "see figure [ regular ] .    ]",
    "if every vertex of @xmath78 is regular then we say that it has a _ regular eulerian circuit_. the following result can easily be deduced from results found in @xcite .",
    "if @xmath67 is an orientable word in @xmath59 then its associated graph has a regular eulerian circuit labelled by @xmath67 .",
    "let @xmath78 be any graph with a regular eulerian circuit , @xmath82 say .",
    "write @xmath82 around the boundary of a disc and identify the edges , respecting orientation , to obtain a surface @xmath83 . then the euler characteristic @xmath84 is given by the formula @xmath85 , where @xmath14 and @xmath86 are the number of vertices and edges respectively in @xmath78 and @xmath84 is equal to @xmath87 .",
    "we define the @xmath88 to be equal to @xmath89 .",
    "it follows that this is given by @xmath90      let @xmath67 be an orientable word of genus @xmath41 in the infinitely countable alphabet @xmath59 and @xmath91 its associated genus @xmath41 graph .",
    "we shall be thinking of edges of @xmath74 being labelled with letters of @xmath67 and @xmath67 itself as being a regular eulerian circuit .",
    "recall that @xmath48 is a hyperbolic group in which geodesic triangles in @xmath92 are @xmath50-thin .",
    "we shall now give a procedure which can be applied to @xmath74 .",
    "this shall be called an _ extension of the orientable word @xmath67 over @xmath0_. this involves the following three steps .    1 .",
    "let @xmath86 be a directed edge in @xmath91 with end points @xmath93 and @xmath94(note that @xmath3 may be the same vertex as @xmath14 ) .",
    "we replace @xmath86 by two new edges @xmath95 and @xmath96 with labels in @xmath60 not in @xmath67 such that @xmath97 and @xmath98 .",
    "we shall do this to every edge in @xmath74 and call the new graph @xmath99 where @xmath100 is the circuit which reads @xmath95 wherever @xmath67 reads @xmath86 in @xmath74 and @xmath101 wherever @xmath67 reads @xmath102 .",
    "let @xmath14 be a vertex of @xmath74 of degree @xmath79 and assume that the edges @xmath103 are oriented away from @xmath14 . since @xmath14 is regular , we can renumber the edges such that @xmath67 contains the cyclic subwords @xmath104 . thus in @xmath105",
    "the circuit @xmath100 contains the cyclic subwords @xmath106",
    ". see figure [ extstep1 ] .",
    "+   + [ extstep1 ] figure 2 .",
    "now we extend each vertex of @xmath105 by some cyclic word in @xmath1 .",
    "let @xmath14 be a vertex of @xmath105 of degree @xmath107 and assume that the edges @xmath108 , for @xmath109 are oriented away from @xmath14 . let @xmath51 be a cyclic word in @xmath1 such that @xmath110 .",
    "we have already shown that we can renumber the edges of @xmath105 such that @xmath100 contains the cyclic subwords @xmath111 .",
    "we extend the vertex @xmath14 as follows .",
    "remove the vertex @xmath14 from @xmath99 and add @xmath79 distinct vertices @xmath112 such that @xmath113 now add an edge labelled by @xmath114 from @xmath115 to @xmath116 for all @xmath117 .",
    "see figure [ extstep2 ] .",
    "+   + [ extstep2 ] figure + if @xmath14 is a vertex of degree one then we add a loop with the label @xmath51 to @xmath14 .",
    "see figure [ extstep2b ] .",
    "+   + [ extstep2b ] figure + after each vertex has been extended by some cyclic word in @xmath1 , we obtain a new graph which we shall call @xmath118 .",
    "we can still read @xmath100 in this graph .",
    "in fact it is now a hamiltonian cycle .",
    "we shall call @xmath100 the _ hamiltonian cycle associated with @xmath67_. 3 .   consider a directed edge @xmath86 of the original graph @xmath91 . in step 1",
    "this is replaced by a pair of edges @xmath119 .",
    "then in step 2 we extend the end points of these edges such that we have a subgraph of @xmath120 of the form shown in figure [ extstep3 ] , +   + [ extstep3 ] figure + where @xmath63 and @xmath64 are subwords of the cyclic words in @xmath1 used in the extension of the end points of @xmath86 .",
    "we label the pair @xmath119 with a pair of words @xmath121 in @xmath1 which are minimal in @xmath0 such that @xmath122 .",
    "we do this to every pair of edges .",
    "we then have an _ extension of @xmath67 over the hyperbolic group @xmath0_.      suppose that we have an extension of an orientable word @xmath67 of genus @xmath41 . we define the _ length of the extension _ to be the sum of the lengths in @xmath1 of the cyclic words @xmath51 given in step 2 of the extension .",
    "that is , if @xmath123 are the vertices of @xmath124 , and these are extended by cyclic words @xmath125 respectively , then the length of the extension is @xmath126 let @xmath127 be a subset of the vertices of @xmath74 that have been extended by cyclic words @xmath128 .",
    "then we say that a _ genus @xmath69 joint extension _ has been constructed on these vertices if the genus of the @xmath38-tuple @xmath129 is equal to @xmath130 in @xmath0 .",
    "now partition the vertices of @xmath74 into @xmath131 sets @xmath132 such that a genus @xmath133 joint extension is constructed on the vertices in the set @xmath134 , for all @xmath135 .",
    "we say that @xmath67 has had a _",
    "genus @xmath69 extension over @xmath0 _ if @xmath136 where @xmath137 if @xmath138 and its only element is a vertex of degree one or two ( i.e.  if @xmath139 and hence @xmath140 then @xmath134 s only element is a vertex of degree greater than or equal to @xmath141 ) .",
    "we are now in a position to state the main result of this paper , a method for constructing forms for elements of genus @xmath36 in @xmath0 . in the following theorem @xmath142",
    "is the number of elements of @xmath0 represented by words of length at most @xmath143 in @xmath1 and @xmath144 where @xmath36 is given in the hypothesis .",
    "[ thexp ] let @xmath145 be a word in @xmath146 such that the @xmath147 .",
    "then @xmath145 is conjugate in @xmath0 to a word @xmath148 in @xmath1 which is minimal in @xmath0 such that @xmath148 has one of the following forms .    1 .   @xmath149 and @xmath150 where @xmath68 is a genus",
    "@xmath36 wicks form and @xmath151 is a map from @xmath152 to @xmath1 such that @xmath153 for each letter @xmath154 of @xmath68 .",
    "@xmath148 is the label on the hamiltonian cycle @xmath100 obtained by a genus @xmath69 extension of length at most @xmath155 on some orientable word @xmath67 of genus @xmath41 , where @xmath156 .",
    "the proof of this theorem runs from page to page .",
    "it involves considering a genus @xmath36 wicks form @xmath68 which can be mapped to a word in @xmath1 conjugate to @xmath145 in @xmath0 such that @xmath68 has the property of being the shortest length wicks form in @xmath1 which is conjugate to @xmath145 in @xmath0 . from page to page we state and prove a number of preliminary lemmas involving the wicks form @xmath68 as well as showing that @xmath68 either takes form 1 in our theorem or can be reduced to an orientable word @xmath67 ( obtained by setting certain letters of @xmath68 to @xmath61 ) .",
    "then from page to page we will show that if we do nt have form 1 then @xmath145 is conjugate to a form given by an extension of @xmath67 over @xmath0 of bounded length and known genus , that is it takes form 2 in our theorem .",
    "below we give an example of how to construct one of these genus @xmath36 forms from an extension .    *",
    "( a possible form of an element of genus @xmath141 in @xmath0 ) * + let @xmath157 , an orientable word of genus @xmath158 .",
    "let @xmath159 be the vertices of the associated graph @xmath74 .",
    "we shall do a joint genus @xmath77 extension on the vertices @xmath160 and @xmath161 , by words @xmath162 and @xmath163 respectively , and a joint genus @xmath61 extension on the vertices @xmath164and @xmath165 , by words @xmath166 and @xmath167 respectively .",
    "see figure [ extex ] .",
    "+ [ extex ] figure    here @xmath168 and @xmath169 .",
    "thus , by theorem [ thexp ] , a possible form for an element of genus @xmath141 is @xmath170 where @xmath148 is a word in @xmath1 which is minimal in @xmath0 and @xmath171 @xmath172 is a commutator in @xmath0 , @xmath173 and @xmath174 .",
    "let @xmath48 be a finitely generated hyperbolic group",
    ". then the following lemma by r.  i.  grigorchuk and i.  g.  lysionok in @xcite shows that the conjugacy problem is solvable @xmath0 .",
    "[ lb ] if minimal words @xmath175 and @xmath176 are conjugate in @xmath0 , then a word @xmath51 can be found such that @xmath177 and @xmath178 where @xmath142 is the number of elements of @xmath0 represented by words of length @xmath179 .",
    "the following lemma can be found in k.j .",
    "friel @xcite , lemma @xmath180 .",
    "a proof has been provided , to help understand lemma [ lac ] which follows it .    [",
    "la ] suppose that we have a closed path @xmath181 in @xmath182 , where @xmath183 is a geodesic path , for @xmath184 .",
    "let vertices @xmath185 and @xmath186 lie on @xmath187 such that @xmath188",
    ". then vertices @xmath189 can be found on @xmath190 such that    1 .",
    "@xmath191 ; 2 .",
    "@xmath192 and 3 .",
    "if @xmath193 , @xmath194 for some @xmath195 then @xmath196 .    now for some integer @xmath41 it follows that @xmath197 .",
    "therefore by adding paths of length zero between @xmath198 and @xmath199 , we may assume that @xmath200 and replace the bound @xmath201 in part @xmath61 by the bound @xmath202 we now carry out a subdivision on the closed path @xmath190 .",
    "let @xmath203 and @xmath204 be geodesic paths from @xmath205 and @xmath206 to @xmath206 and @xmath207 respectively .",
    "let @xmath208 be a binary sequence of length @xmath209 , where @xmath210 or @xmath61 for all @xmath211 .",
    "we define @xmath212 and @xmath213 to be geodesic paths from @xmath214 and @xmath215 to @xmath215 and @xmath216 respectively , where @xmath217 note that , if @xmath218 then we choose the geodesic paths @xmath212 and @xmath213 to be @xmath219 and @xmath220 respectively .",
    "this gives a subdivision of @xmath190 into geodesic triangles .",
    "for example if @xmath221 we have the subdivision shown in figure [ subdiv ] .",
    "+ [ subdiv ] figure    consider a geodesic triangle of the subdivision with sides @xmath222 , @xmath212 and @xmath213 .",
    "let @xmath14 be a vertex lying on @xmath222 .",
    "by the definition of @xmath50-thin triangles there exists a vertex @xmath223 on @xmath224 such that @xmath225 and either    1 .",
    "@xmath226 and @xmath227 , or 2 .",
    "@xmath228 and @xmath229 .    from this",
    "we see that for any vertex on a geodesic path @xmath222 there always exists a vertex on a geodesic path @xmath230 where the length of the binary sequence @xmath231 is one greater than @xmath232 .",
    "now @xmath233 is within @xmath234 of some vertex @xmath235 on either @xmath203 or @xmath204 . from the above there",
    "exists a sequence of vertices @xmath236 , where each @xmath237 lies on a @xmath238 such that the length of the binary sequence @xmath239 is one greater than the length of the binary sequence @xmath240 and @xmath241 for all @xmath242 .",
    "this implies that @xmath243 and from the construction of the subdivision @xmath244 for some @xmath245 .",
    "therefore , let @xmath246 .",
    "we shall denote this path passing through the sequence of vertices by @xmath247 , i.e.  @xmath248 .",
    "for example if @xmath221 we have a path as shown in figure [ subdiv2 ] .",
    "+ [ subdiv2 ] figure    clearly the same construction of a path @xmath249 of length at most @xmath250 applies to @xmath251 .",
    "hence part @xmath61 of the lemma holds .",
    "consider two vertices @xmath160 and @xmath161 lying on the geodesic @xmath222 for some binary sequence @xmath232 such that @xmath252 , for some positive constant @xmath7 .",
    "then by the definition of @xmath50-thin triangle there exist vertices @xmath253 lying on @xmath254 such that @xmath255 and either    1 .",
    "@xmath256 and @xmath257 , or 2 .",
    "@xmath258 and @xmath259 , or 3 .",
    "@xmath260 and @xmath261 .    now suppose that paths @xmath247 and @xmath249 follow the same sequence of @xmath222 s , until for some @xmath230 , @xmath249 meets @xmath262 and @xmath247 meets @xmath263 .",
    "let @xmath247 and @xmath249 meet the geodesic path @xmath230 at the vertices @xmath264 and @xmath265 respectively . by",
    "( a ) and ( b ) it follows that @xmath266 and @xmath267 .",
    "since @xmath249 meets @xmath262 and @xmath247 meets @xmath263 , the construction of the @xmath268 implies that @xmath192 .",
    "finally , suppose that @xmath247 and @xmath249 meet exactly the same sequence of @xmath268 .",
    "let @xmath230 be the last in this sequence .",
    "again by our construction of the @xmath268 , @xmath269 for some @xmath270 and by ( a ) and ( b ) it follows that @xmath271 and @xmath272 .",
    "hence both part @xmath77 and @xmath141 hold .",
    "[ lac ] given @xmath273 and @xmath274 from above , if @xmath275 is vertex lying on @xmath190 such that @xmath276 and @xmath277 or @xmath278 for some @xmath270 then a vertex @xmath279 can be found on @xmath190 such that    1 .",
    "@xmath280 and 2 .",
    "@xmath281 .",
    "again consider the subdivision constructed above with the path @xmath247 from @xmath273 to @xmath274 .",
    "let the terminal vertex of the path @xmath247 lie on @xmath282 for some @xmath283 .",
    "if @xmath275 lies on @xmath284 then we have the hypothesis of the previous lemma , and the lemma holds .",
    "so assume that @xmath285 for some @xmath286 .",
    "consider a geodesic triangle @xmath287 in the subdivision , for some binary sequence @xmath232 .",
    "let @xmath14 be a vertex on @xmath288 , where @xmath289 or @xmath61 .",
    "then there exists a vertex @xmath223 on @xmath290 , where @xmath291 , such that @xmath292 .",
    "it follows from the subdivision that @xmath293 for some binary sequence @xmath294 of length @xmath41 ( remember that @xmath200 ) . by the above paragraph",
    "we may choose a sequence of vertices @xmath295 through the @xmath222 s such that each @xmath115 lies on @xmath296 , where each binary sequence @xmath297 is distinct .",
    "let @xmath298 be the first vertex such that either    1 .",
    "the length of @xmath299 is the same as the length of @xmath300 , or 2 .",
    "@xmath298 lies on @xmath301 .",
    "\\(i ) the length of the binary sequence decreases by one each time until @xmath298 is reached .",
    "therefore there exists a path of length at most @xmath250 from @xmath302 to @xmath298 .",
    "now by the construction of the subdivision and the argument in the previous lemma , the length of the binary sequence associated to each vertex in the sequence @xmath303 increases by one each time .",
    "thus for some @xmath304 , @xmath305 lies on @xmath190 and there exists a path from @xmath306 to @xmath305 of length at most @xmath250 .",
    "let @xmath307 .",
    "then @xmath308 and in this case the part @xmath61 holds .",
    "\\(ii ) without loss of generality let @xmath298 lie on @xmath203 .",
    "once again there is a path from @xmath309 to @xmath298 of length at most @xmath250 .",
    "if @xmath306 lies on @xmath284 then @xmath310 and part @xmath61 holds .",
    "if @xmath306 lies on @xmath204 , then we use the same argument to as ( i ) to show that there is a @xmath298 on @xmath190 such that @xmath311 .",
    "hence part @xmath61 holds in all cases .",
    "let @xmath312 be the path of length at most @xmath313 constructed above . from the previous lemma @xmath247 passes through @xmath41 distinct @xmath222 s . let the sequence of vertices which lie on these @xmath222 s be @xmath314 such that @xmath315 lies on @xmath316 for some binary sequence @xmath317 .",
    "now , if @xmath312 never passes through @xmath316 for all @xmath318 , then by the construction of the subdivision , part @xmath77 clearly holds .",
    "therefore , assume that @xmath312 passes through @xmath316 at the vertex @xmath63 , for some @xmath319 .",
    "now , since @xmath320 , it follows from the construction of @xmath312 that @xmath321 .",
    "it clearly follows from the construction of the @xmath222 s and statement ( a ) , ( b ) and ( c ) from the previous lemma that @xmath281 .",
    "see figure [ subdiv3 ] .",
    "+ [ subdiv3 ] figure    hence the lemma holds .",
    "[ startthm ] we begin by considering all genus @xmath36 wicks forms in @xmath60 ( remember that this is an infinitely countable alphabet ) and choosing one which when mapped to a word in @xmath1 which is conjugate to h in @xmath0 has the property of being a word of shortest length over all such mapping of wicks forms to words into @xmath1 which are conjugate to @xmath145 in @xmath0 .    the genus of @xmath145 is equal to @xmath36 in @xmath48 .",
    "therefore , by definition , there exist words @xmath322 , for @xmath323 , such that @xmath324[a_2,b_2]\\ldots [ a_n , b_n].\\ ] ] in @xmath60 the orientable word @xmath325\\ldots [ a_n , b_n]$ ] is a genus @xmath36 wicks form .",
    "let @xmath326 and let @xmath327 be a homomorphism defined by @xmath328 and @xmath329 , for all @xmath330 .",
    "we shall call this a _ labelling function for @xmath67_. note that @xmath331\\ldots[\\phi(a_n),\\phi(b_n)]\\\\          & = & [ a_1,b_1]\\ldots [ a_n , b_n].\\end{aligned}\\ ] ] let @xmath332 be the set of pairs @xmath333 where @xmath67 is a genus @xmath36 wicks form and @xmath334 is a labelling function for @xmath67 such that @xmath335 is conjugate to @xmath145 in @xmath0 . consider a pair @xmath336 in which @xmath337 is minimal amongst all pairs in @xmath332(since we have shown that at least one pair exists in @xmath332 this is always possible ) .",
    "clearly @xmath338 is minimal in @xmath0 for each letter @xmath154 of @xmath68 or our choice of minimal pair in @xmath339 would be incorrect .",
    "we should note that there exists no genus @xmath304 wicks form @xmath340 , @xmath341 , with a labelling function @xmath342 such that @xmath343 is conjugate to @xmath145 in @xmath0 , as this would contradict the genus of @xmath145 in @xmath0 .",
    "now , for our minimal pair @xmath336 in @xmath332 we are able to state a number of preliminary lemmas .",
    "the first lemma we state uses ideas from @xcite , lemma @xmath344 .",
    "it displays bounded length properties of subwords of @xmath345 , where @xmath6 is any letter of @xmath68 .",
    "this lemma will be used regularly in the proof of lemma [ lsc ] which shows that in the cayley graph @xmath182 the path represented by the word @xmath346 is ` close ' to a geodesic path representing a word @xmath148 which is equal to @xmath346 in @xmath0 .",
    "let @xmath347 be the genus @xmath36 graph associated to @xmath68 .",
    "[ l1 ] let @xmath348 be the cyclic sequence of letters in the regular eulerian circuit @xmath68 in @xmath76 .",
    "let @xmath349 where @xmath20 and @xmath350 are subwords of the word @xmath345 which is minimal in @xmath0 .",
    "similarly , let @xmath351 , for @xmath352",
    ". then    1 .",
    "@xmath353 , for @xmath354 ; 2 .",
    "@xmath355 , for @xmath356 and 3 .",
    "@xmath357 , for @xmath358 .    first we shall prove statement ( ii ) .",
    "let @xmath359 be a word in @xmath1 which is minimal in @xmath0 such that @xmath360 .",
    "consider the edges labelled @xmath6 and @xmath361 in the graph @xmath76 .",
    "bisect @xmath361 into two new edges , the first new edge shall be denoted @xmath362 and the second @xmath363 , where @xmath364 are elements of @xmath60 not occurring in @xmath68 .",
    "now remove edge @xmath6 and add a new edge , @xmath365 , joining @xmath366 to @xmath367 .",
    "see figure [ newfgra2 ] .",
    "+ [ newfgra2 ] figure    note that if @xmath368 in @xmath76 has degree @xmath141 then we also remove the edges @xmath369 and @xmath370 and add a new edge @xmath371 from @xmath372 to @xmath373 .",
    "we can see from the new graph that we have a regular eulerian circuit @xmath374 .",
    "we know that @xmath361 occurs as @xmath375 for some @xmath376 , @xmath352 in @xmath68 so @xmath377 is replaced by @xmath378 .",
    "but since these new edges remain together in the new eulerian circuit @xmath374 we shall ignore this as it does not effect the proof .",
    "therefore the cyclic sequence of letters of @xmath374 is either @xmath379 if the degree of @xmath368 in @xmath76 is greater than three or @xmath380 otherwise .",
    "suppose that the numbers of vertices and edges of @xmath76 are @xmath14 and @xmath86 respectively .",
    "if the degree of @xmath368 in @xmath76 is greater than three then the numbers of vertices and edges in the new graph are @xmath381 and @xmath382 respectively .",
    "if the degree of @xmath368 is three then the numbers of vertices and edges in the new graph are @xmath14 and @xmath86 respectively . in both cases",
    "it is easy to check , using equation ( [ gengra ] ) , that the new graph also has genus @xmath36 and has no vertices of degree @xmath61 or @xmath77 .",
    "thus @xmath374 is a genus @xmath36 wicks form .",
    "now we shall define a labelling function for @xmath374 .",
    "first consider the case where @xmath368 has degree greater than @xmath141 .",
    "let @xmath383 .",
    "we define a homomorphism @xmath384 in the following way .",
    "@xmath385 therefore , @xmath386 this implies that @xmath387 is conjugate to @xmath145 in @xmath0 .",
    "thus @xmath388 is an element of @xmath332 .",
    "now since @xmath337 was chosen to be minimal over all pairs in @xmath332 , it follows that @xmath389 also , we can see from figure [ newfgra2 ] that @xmath390 therefore , by equations ( [ psitheta1 ] ) and ( [ psitheta2 ] ) , it is clear that @xmath391 as required .",
    "now suppose that the degree of @xmath368 in @xmath392 is three .",
    "let @xmath393 we define a homomorphism @xmath394 in the following way .",
    "@xmath395 we can use the same argument to show that @xmath396 and again , since @xmath337 was chosen to be minimal over all pairs in @xmath332 , it follows that @xmath397 also , we know that @xmath398 therefore , by equations ( [ psitheta3 ] ) and ( [ psitheta4 ] ) , it is clear that @xmath391 as required . hence in both cases @xmath399 holds .    the same argument , using @xmath400 , can be used to show that @xmath401 holds .",
    "therefore we only need to consider case @xmath402 .",
    "let @xmath403 be a word in @xmath1 which is minimal in @xmath0 such that @xmath404 again we follow the same method of altering the graph @xmath347 .",
    "bisect the edge labelled @xmath405 .",
    "the first half shall be labelled by @xmath406 and the second half labelled by @xmath407 , where @xmath408 are elements of @xmath409 not occurring in @xmath68 .",
    "again , we shall remove the edge @xmath6 but now we add a new edge @xmath410 joining @xmath411 to @xmath368 , with @xmath412 .",
    "see figure [ newfgra3 ] .",
    "+ [ newfgra3 ] figure    if @xmath413 in @xmath76 has degree @xmath141 then we also remove the edges @xmath414 and @xmath415 and add a new edge @xmath416 from @xmath417 to @xmath418 .",
    "we can see from the new graph that we have a regular eulerian circuit @xmath419 .",
    "the cyclic sequence of letters of @xmath419 is either @xmath420 if the degree of @xmath413 in @xmath76 is greater than three , or @xmath421 otherwise . once again , it is easy to check that the genus of the new graph is @xmath36 and it contains no vertices of degree @xmath61 or @xmath77 .",
    "thus @xmath419 is a genus @xmath36 wicks form .",
    "we shall define a labelling function for @xmath419 .",
    "first consider the case where @xmath413 has degree greater than @xmath141 .",
    "let @xmath422 .",
    "we define a homomorphism @xmath423 in the following way .",
    "@xmath424 therefore , @xmath425 this implies that @xmath426 is conjugate to @xmath145 in @xmath0 .",
    "thus @xmath427 is an element of @xmath332 . now",
    "since @xmath337 was chosen to be minimal over all pairs in @xmath332 , it follows that @xmath428 also , we can see from figure [ newfgra3 ] that @xmath429 therefore , by equations ( [ psitheta5 ] ) and ( [ psitheta6 ] ) , it is clear that @xmath430 as required .",
    "now suppose that @xmath413 has degree three in @xmath392 .",
    "let @xmath431 we define a homomorphism @xmath432 in the following way .",
    "@xmath433 again , we can use the same argument to show that @xmath434 and again , since @xmath337 was chosen to be minimal over all pairs in @xmath332 , it follows that @xmath435 also , we know that @xmath436 therefore , by equations ( [ psitheta7 ] ) and ( [ psitheta8 ] ) , it is clear that @xmath430 as required . hence in both cases @xmath402 holds .",
    "suppose that for each letter @xmath154 of the wicks form @xmath68 we have @xmath437 . by the following lemma the maximum length of a genus @xmath36 wicks form is @xmath438 .",
    "for a proof of this lemma see m.  culler @xcite theorem @xmath439 .",
    "[ cull ] let @xmath340 be a wicks form in the alphabet @xmath60 such that @xmath440 . then the length of @xmath340 is at most @xmath441 .",
    "it clearly follows that we have part @xmath61 of the theorem .",
    "therefore , we shall assume that there is at least one letter of @xmath68 which is labelled by a word of length greater than @xmath442 in @xmath1(this of course implies that there are two since each letter appears twice . ) for convenience in the proof we shall take @xmath443 to be a cyclic permutation of @xmath68 such that the last letter of @xmath443 is labelled by a word of length greater than @xmath442 in @xmath1 but one should note that the proof does go through using any cyclic permutation .",
    "consider @xmath444 as a path in the cayley graph @xmath182 .",
    "let @xmath148 and @xmath445 be words in @xmath1 which are minimal in @xmath0 such that @xmath446 and @xmath447 .",
    "see figure [ fandr ] .",
    "+ [ fandr ] figure    suppose that @xmath448 is the label on one of the letters of @xmath443 with @xmath449 .",
    "since the word @xmath448 is a minimal in @xmath0 , the path in the cayley graph above labelled by @xmath444 contains a geodesic subpath labelled by @xmath448 .",
    "[ lsc ] there exists a vertex @xmath14 on the geodesic path labelled by @xmath148 such that @xmath450 .",
    "we shall assume that the letter of @xmath443 labelled by @xmath448 in the @xmath182 appears before be its inverse i.e.  @xmath451 and @xmath452 .",
    "it is easy to show that the same proof follows through for the converse .",
    "let @xmath453 and @xmath204 be vertices on @xmath448 such that @xmath454 .",
    "( note that we could use smaller segments of @xmath448 of length @xmath455 here to prove this lemma but we require this set up for lemma [ chouv ] to hold . )",
    "see figure [ l1a ] .",
    "+ [ l1a ] figure    by lemma [ la ] part 1 , there are vertices @xmath456 and @xmath457 , which lie either on the path labelled by @xmath458 or on the geodesic path labelled by @xmath148 , such that @xmath459 suppose that @xmath456 lies on some geodesic path @xmath460 which is the label of some letter @xmath7 in @xmath443 which is different to @xmath6 .",
    "lemma [ l1 ] implies that @xmath453 is within @xmath461 of @xmath462 but we have chosen @xmath453 such that this is not the case . therefore @xmath456 and similarly @xmath457 can only lie on @xmath463 .",
    "also , if @xmath456 lies on @xmath464 then by lemma [ la ] part 2 , @xmath457 lies on @xmath465 .",
    "this leaves us with just three possibilities",
    ". see figure [ l1b ] .",
    "+ [ l1b ] figure    suppose that both @xmath456 and @xmath457 lie on @xmath148 . by the triangle inequality it immediately follows that @xmath466 therefore in this case the lemma holds .",
    "suppose that both @xmath456 and @xmath457 lie on @xmath465 .",
    "let @xmath467 be the vertex lying on @xmath465 such that @xmath468 .",
    "we need the following lemma .",
    "[ x1x2 ] let @xmath264 and @xmath265 be any vertices on @xmath448 and @xmath465 respectively such that + for some constant @xmath41 . if @xmath469 is a vertex on @xmath465 such that @xmath470 then @xmath471 .",
    "the proof falls into the following two cases :    1 .",
    "@xmath472 2 .",
    "@xmath473    \\(a ) by lemma [ l1 ] @xmath474 and from the hypothesis and the triangle inequality it follows that @xmath475 since @xmath448 is a geodesic path we have @xmath476 it follows from equations ( [ alp1 ] ) and ( [ alp2 ] ) that @xmath471 .    by lemma [ l1 ] @xmath477 and from the hypothesis and the triangle inequality",
    "it follows that @xmath478 since @xmath448 is a geodesic path we have @xmath479 it follows from equations ( [ alp3 ] ) and ( [ alp4 ] ) that @xmath471 .",
    "hence the lemma holds .    returning to case ( ii )",
    ", the lemma above implies that @xmath480 .",
    "thus @xmath481 .",
    "similarly , if @xmath482 is the vertex on @xmath465 such that @xmath483 , we can follow the same argument to show that @xmath484 .",
    "let the segment of @xmath448 from @xmath453 to @xmath204 be labelled by @xmath485 .",
    "therefore the segment on @xmath465 from @xmath467 to @xmath482 is labelled @xmath486 .",
    "let @xmath487 and @xmath38 be geodesic paths from @xmath453 and @xmath204 to @xmath482 and @xmath467 respectively .",
    "we have shown such paths to have length at most @xmath488 .",
    "see figure [ l1c ] .",
    "+ [ l1c ] figure    since @xmath346 was chosen to be of shortest length over all pairs in @xmath332 , we can use lemma [ lb ] to show that @xmath489 therefore it follows that @xmath490 we have a contradiction .",
    "hence this case ca nt occur .",
    "suppose that @xmath456 lies on @xmath148 and @xmath457 lies on @xmath465 .",
    "see figure [ l1b ] .",
    "again let @xmath467 be the vertex on @xmath465 such that @xmath468 .",
    "as in case ( ii ) we can show that @xmath481 .",
    "as before , by lemma [ la ] and lemma [ l1 ] , for each vertex @xmath3 of @xmath448 lying between @xmath453 and @xmath204 , there exists a vertex @xmath14 on @xmath491 such that @xmath492 .",
    "let @xmath160 be the first vertex along @xmath448 which is within @xmath461 of a vertex @xmath164 on @xmath465 .",
    "by lemma [ la ] part @xmath77 vertex @xmath160 clearly lies between @xmath453 and @xmath204 on @xmath448 .",
    "let @xmath165 be the vertex on @xmath465 such that @xmath493 . by lemma [ x1x2 ]",
    "it follows that @xmath494 .",
    "thus @xmath495 .",
    "let the segment of @xmath448 from @xmath160 to @xmath204 be labelled by @xmath496 .",
    "therefore the segment on @xmath465 from @xmath467 to @xmath165 is labelled @xmath497 .",
    "let @xmath498 and @xmath499 be geodesic paths from @xmath453 and @xmath160 to @xmath482 and @xmath165 respectively .",
    "we have shown such paths to have length at most @xmath488 . again , since @xmath346 was chosen to be of shortest length in @xmath332 , we can use lemma [ la ] to show that @xmath489 let @xmath161 be the vertex on @xmath448 such that @xmath500 . since @xmath160 was chosen to be the first vertex along @xmath448 which was within @xmath461 of a vertex on @xmath465",
    ", there exists a vertex @xmath501 on @xmath148 such that @xmath502",
    ". see figure [ l1d ] .",
    "+ [ l1d ] figure    clearly it follows that @xmath503 hence the lemma holds in all cases .",
    "consider all letters of @xmath443 which have labels of length greater than @xmath442 in @xmath1 .",
    "we shall call these the _ long edges _ of @xmath443 .",
    "all other letters shall be called _",
    "short edges_. the terminal vertex of each long edge in @xmath182 has each been shown , in the previous lemma , to be within @xmath504 of some vertex on @xmath148 .",
    "let @xmath7 be a long edge of @xmath443 which is not the first long edge in the sequence of letters .",
    "since @xmath443 is quadratic , @xmath7 appears twice , once with exponent @xmath61 and once with exponent @xmath62 .",
    "first we shall consider the appearance of @xmath7 with exponent @xmath61 . in the sequence of letters of @xmath443 ,",
    "let @xmath505 be the long edge before @xmath7 in the sequence such that no long edge appears between @xmath505 and @xmath7 ( note that @xmath505 could be @xmath506 ) .",
    "by lemma [ lsc ] there exist vertices @xmath3 and @xmath14 on @xmath148 such that @xmath507 . see figure [ apmb ] .",
    "+ [ apmb ] figure    [ chouv ] we can choose @xmath3 and @xmath14 such that @xmath508 .",
    "suppose that @xmath509 .",
    "from the proof of lemma [ lsc ] , there exist vertices @xmath510 and @xmath223 lying on @xmath511 and @xmath512 respectively such that we have the following inequalities .",
    "1 .   @xmath513 ; 2 .",
    "@xmath514 .    in this proof @xmath3 and @xmath14 were chosen in @xmath92 from @xmath510 and @xmath223 using part @xmath515 of lemma [ la ] .",
    "let @xmath190 be the closed path labelled by the cyclic word @xmath516 in @xmath1 starting at @xmath517 .",
    "now we can use lemma [ lac ] to show that there exists another vertex @xmath518 on @xmath190 such that @xmath519 and @xmath520 since @xmath521 , @xmath518 must lie on @xmath522 or lemma [ l1 ] would be violated .",
    "we need to consider two cases .",
    "+ see figure [ apmb2 ] .",
    "+ [ apmb2 ] figure    using the triangle inequality we have the following inequalities .",
    "@xmath523 we can combine these to give @xmath524 which implies that @xmath525 .",
    "we need to consider two possibilities .",
    "first suppose that @xmath526 .",
    "then by lemma [ l1 ] it follows that @xmath527 and from 2 above @xmath528 since @xmath7 is a long edge this is a contradiction .",
    "now suppose that @xmath529",
    ". we can now strengthen statement 2 above to @xmath530 we can choose @xmath223 to be this vertex since this vertex is within @xmath461 of a vertex on @xmath531(again see lemmas [ la ] and [ l1 ] ) and if it lies on @xmath532 we would have case ( ii ) of the proof of lemma [ lsc ] , which we have already shown can not occur .",
    "now consider the vertex @xmath533 on @xmath532 such that @xmath534 .",
    "if @xmath3 was chosen by case ( iii ) of lemma [ lsc ] then @xmath533 is within @xmath461 of a vertex @xmath535 on @xmath512 , otherwise @xmath3 was chosen using case ( i ) of lemma [ lsc ] and @xmath536 .",
    "first consider the latter case .",
    "let @xmath154 be the first letter after @xmath506 in @xmath443 .",
    "by lemma [ l1 ] , a geodesic path from @xmath537 to @xmath538 has length greater than @xmath539 .",
    "but by the triangle inequality @xmath540 this implies that @xmath541 , but @xmath7 is a long edge so this is a contradiction .",
    "therefore assume that @xmath533 is within @xmath461 of a vertex @xmath535 on @xmath512 .",
    "let @xmath131 be the vertex on @xmath512 such that @xmath542 .",
    "by lemma [ x1x2 ] @xmath543 .",
    "therefore , @xmath544 .",
    "thus we have all the bounded distances shown in figure [ apmb3 ] .",
    "+ [ apmb3 ] figure    from this it is clear that @xmath545 . since @xmath512 is a geodesic path , it follows that @xmath546 but @xmath7 is a long edge so this can not occur .",
    "+ we can see from lemma [ lac ] that this case falls into two subcases .    1 .",
    "@xmath547 and @xmath548 or 2 .",
    "@xmath506 lies after @xmath7 in the sequence of letters of @xmath443 .",
    "we first consider subcase ( i ) .",
    "see figure [ apmb5 ] .",
    "+ [ apmb5 ] figure    as in the previous case with @xmath529 ( see equations ( [ aeqb1 ] ) and ( [ aeqb2 ] ) ) we can strengthen statement 2 on page to @xmath549 it follows that @xmath550 . consider a geodesic path @xmath51 from @xmath223 to @xmath551 .",
    "lemma [ l1 ] implies that @xmath552 and by the triangle inequality we have that @xmath553 it follows that @xmath554 but @xmath7 is a long letter so we have a contradiction . therefore this subcase ca nt occur",
    "now consider ( ii ) .",
    "see figure [ apmb6 ] .",
    "+ [ apmb6 ] figure    consider the vertex @xmath131 which lies on @xmath512 such that @xmath555 .",
    "let @xmath556 be the closed path labelled by the cyclic word @xmath557 in @xmath1 starting at @xmath537 .",
    "lemma [ la ] part 1 and part 2 imply that there is a vertex @xmath558 on the closed path @xmath556 such that @xmath559 it follows from lemma [ l1 ] that @xmath558 must lie on @xmath148 ( it ca nt lie on @xmath532 or equation ( [ case2eq ] ) would not hold ) .",
    "this also means that we have part 3 of lemma [ la ] , i.e. @xmath560 see figure [ ampb7 ] .",
    "+ [ ampb7 ] figure    now consider the closed path @xmath190 again .",
    "lemma [ lac ] implies that there exists a vertex @xmath561 on @xmath190 such that @xmath562 and @xmath563 since @xmath564 and @xmath565 , it follows from lemma [ l1 ] that @xmath561 lies on either @xmath148 or @xmath532 .",
    "first consider the case where @xmath561 lies on @xmath148 .",
    "we have the bounded distances as shown in figure [ ampb8 ] .",
    "+ [ ampb8 ] figure    using the triangle inequality we have the following equations .",
    "@xmath566 it follows from these equations and equation ( [ case2eq2 ] ) that @xmath567 lemma [ l1 ] implies that @xmath568 .",
    "thus @xmath569 but @xmath7 is a long letter so we have a contradiction .",
    "finally we need to consider the case where @xmath561 lies on @xmath532 .",
    "we have the bounded distances as shown in figure [ ampb9 ] .",
    "+ [ ampb9 ] figure    we know by the choice of vertex @xmath131 that @xmath555 .",
    "the vertex @xmath223 was chosen from either case ( i ) or case ( iii ) of lemma [ lsc ] .",
    "if it was chosen by case ( i ) then @xmath570 .",
    "if it was chosen by case ( iii ) then there exists a vertex @xmath535 on @xmath512 such that @xmath571 and @xmath535 is within a distance @xmath461 of a vertex on @xmath532 .",
    "either way there is vertex @xmath63 which is on the @xmath512 at a distance @xmath572 from @xmath537 which is within @xmath488 of a vertex @xmath573 on @xmath532 .",
    "see figure [ xyx1y1 ] .",
    "+ [ xyx1y1 ] figure    it follows from lemma [ x1x2 ] that there exist vertices @xmath574 and @xmath575 lying on @xmath532 such that we have the following equations .",
    "@xmath576 equations ( [ xx  ] ) and ( [ pp ] ) imply that @xmath577 and @xmath578 .",
    "see figure [ xyx2y2 ] .",
    "+ [ xyx2y2 ] figure    by lemma [ lb ] we have that @xmath579 it follows that @xmath580 .",
    "but @xmath7 is a long letter so we have a contradiction .",
    "therefore this case ca nt occur .",
    "hence we have the required result .",
    "we shall label the segment of @xmath148 between @xmath3 and @xmath14 by @xmath581 and a geodesic path from @xmath537 to @xmath14 by @xmath582 .",
    "if we were considering @xmath506 we would label the appropriate paths @xmath583 and @xmath584 respectively",
    ". remember the last letter of @xmath443 was chosen to be long , thus if @xmath7 is the last letter then @xmath585 and @xmath586",
    ". we shall do this for every long edge in @xmath443 .",
    "suppose that @xmath587 where @xmath6 and @xmath8 are long edges and @xmath7 is a short edge .",
    "then we label paths in @xmath182 as shown in figure [ exabc ] .",
    "+ [ exabc ] figure    where @xmath588 , @xmath589 and @xmath590 are at most @xmath504 and @xmath591 .",
    "let us write @xmath443 around the boundary of a disc ( i.e.  divide the boundary up into @xmath592 segments , assigning a letter to each ) and identify the long edges , respecting orientation .",
    "we obtain a surface @xmath83 of genus @xmath593 with @xmath594 holes .",
    "the boundary of the disc becomes a graph on this surface , we shall denote this graph @xmath595 .",
    "this graph consists of short edges all of which are written around the boundary components and long edges all of which are properly embedded on the surface .",
    "separate the cyclic words in @xmath60 written around the @xmath594 boundary components into @xmath131 disjoint sets , @xmath596 , with @xmath131 as large as possible as follows .",
    "each set @xmath597 contains some @xmath598-tuple of cyclic words @xmath599 , where @xmath600 is the path written around a boundary component of @xmath83 , such that if a small edge @xmath6 of @xmath443 appears in @xmath600 , for some @xmath601 then @xmath602 appears in @xmath603 for some @xmath604 . we shall define the genus of @xmath597 to be equal to @xmath133 , for @xmath605 , where @xmath606 .",
    "[ gi ] let @xmath607 . for each @xmath597 containing",
    "a @xmath598-tuple @xmath608 we have",
    "@xmath609 it follows that @xmath610 .",
    "suppose that this is not the case . clearly",
    "the genus of @xmath608 in @xmath152 , which we shall denote @xmath611 , is at least @xmath612 for all @xmath605 .",
    "therefore assume that @xmath613 for some @xmath614 .",
    "now , since @xmath68 has genus @xmath36 in @xmath152 , if we identify all the short edges on the genus @xmath41 surface @xmath83 , respecting orientation , we obtain a closed compact surface of genus @xmath36 . therefore , @xmath615",
    "but this implies that @xmath616 , a contradiction .",
    "thus @xmath617 for all @xmath605 and @xmath618 .",
    "hence the lemma holds .",
    "consider the surface @xmath83 with @xmath594 holes with the embedded graph @xmath595 consisting of long and short edges .",
    "if we paste a disc onto each of the @xmath594 boundary components and contract the cyclic word of short edges to a point , we obtain a graph of genus @xmath41 consisting of long edges only on a closed compact surface of genus @xmath41 .",
    "the orientable word @xmath67 associated with this graph is obviously the word obtained by setting all the short edges of @xmath68 to @xmath61 . as usual",
    "we denote this graph @xmath74 .",
    "we should note that , by the way the geodesic path labelled by @xmath148 in @xmath182 has been cut up into segments , the cyclic sequence of letters of @xmath67 gives the cyclic sequence of segments of @xmath148 by replacing a letter @xmath154 of @xmath67 with @xmath619 for its occurrence with exponent @xmath61 and @xmath620 for its occurrence with exponent @xmath62 .",
    "we now show that an extension over @xmath0 may be carried out on the orientable word @xmath67 , so that part @xmath77 of the theorem holds.[edw ]      first we shall construct @xmath621 sets , @xmath622 , of cyclic words in @xmath1 such that each vertex of @xmath74 will be extended by a unique element from one of these sets . consider a cyclic word @xmath623 , @xmath624 and @xmath625 , in the graph @xmath595 .",
    "thus , if we are thinking of @xmath595 as being embedded in @xmath83 , @xmath600 is a word in the short edges written around a boundary component of the surface .",
    "suppose that there are @xmath79 end points of long edges lying on this boundary component .",
    "let @xmath626 be the long edges .",
    "see figure [ eandws ] .",
    "+ [ eandws ] figure    here @xmath627 , where each @xmath628 is a subword which may or may not have length zero . also , note that the @xmath629 are not necessarily distinct ( both end points may lie on the same boundary component ) .",
    "since @xmath67 is an orientable word , each vertex of @xmath74 is regular",
    ". therefore , since @xmath74 is obtained from @xmath595 by pasting each boundary component of the surface @xmath83 with a disc and contracting the edges around the boundary components to a point , we may think of the boundary components also as being ` regular ' .",
    "that is , we may renumber the long edges , as shown in the diagram , such that the following cyclic subwords appear in @xmath68 .",
    "@xmath630 where @xmath631 , for all @xmath632 .",
    "now we have already shown that , for each long edge @xmath154 in @xmath443 , there exists words , @xmath95 and @xmath96 , in @xmath1 of length at most @xmath504 such that , in the cayley graph @xmath182 , @xmath95 and @xmath96 label geodesic paths from @xmath633 and @xmath634 respectively to vertices on the geodesic path labelled by @xmath148 .",
    "let @xmath635 be a cyclic word in @xmath1 such that @xmath636 where @xmath637 with @xmath638 from the definition of @xmath635 , in the group @xmath0 we can see that @xmath639 we construct @xmath635 for all @xmath601 and @xmath135 .",
    "we shall denote the set @xmath640 by @xmath641 .",
    "now , since @xmath642 for all @xmath643 , it follows that @xmath644 we shall say that the genus of @xmath641 is @xmath133 .",
    "[ c_i ] with @xmath133 and @xmath79 defined as above , if @xmath139 and hence @xmath140 then @xmath645 .",
    "suppose that @xmath646 .",
    "then @xmath647 .",
    "we know that @xmath648 and lemma [ gi ] implies that @xmath649 .",
    "that is @xmath650 .",
    "but @xmath651 is a cyclic subword of the wicks form @xmath68 and by definition @xmath68 is cyclically reduced .",
    "therefore this ca nt occur .",
    "now suppose that @xmath652 .",
    "then @xmath653 . with a similar argument",
    "it follows that @xmath649 and thus @xmath654 .",
    "but the cyclic subwords @xmath655 and , @xmath656 appear in the wicks form @xmath68 which implies we that we have redundancy in @xmath68 .",
    "therefore this also ca nt occur .",
    "finally we need to construct a set of cyclic words in @xmath1 which we shall denote @xmath657 .",
    "we do this in the following way .",
    "let @xmath658 be the set of vertices of @xmath595 which do not lie on a boundary component of @xmath83 i.e.  they lie on the endpoints of only long edges .",
    "note that each of these vertices has degree at least @xmath141[least3 ] since @xmath595 is the graph obtained by identifying long letters of @xmath68 and @xmath68 is a wicks form ( recall that @xmath392 has no vertices of degree @xmath61 or @xmath77 ) .",
    "consider @xmath115 , for some @xmath659 .",
    "let the degree of this vertex be @xmath660 .",
    "thus there are long edges @xmath661 which have an end point which is @xmath115 .",
    "note that these @xmath662 are not necessarily distinct , that is we could have loops .",
    "see figure [ vertvandf ] .",
    "+ [ vertvandf ] figure    thus , since @xmath115 is regular , we can renumber the long edges which have an end point @xmath115 such that the following cyclic subwords appear in @xmath68 .",
    "@xmath663 where @xmath631 , for all @xmath632 . as in the construction of @xmath641",
    "we again use the fact that for each long edge @xmath86 in @xmath443 there exists words @xmath95 and @xmath96 , in @xmath1 , of length at most @xmath504 , such that , in the cayley graph @xmath182 , @xmath95 labels a geodesic path from @xmath633 to a vertex on @xmath148 and @xmath96 labels a geodesic path from @xmath634 to a vertex on @xmath148 .",
    "let @xmath664 be a cyclic word in @xmath1 such that @xmath665 where @xmath666 again with @xmath638 clearly @xmath664 is equal to @xmath61 in @xmath0 so has genus @xmath158 in @xmath0 .",
    "let @xmath667 .",
    "we have constructed the required sets of cyclic words in @xmath1 which shall be used in the extension of @xmath67 needed to obtain part @xmath77 of the theorem .",
    "write @xmath68 around the outer boundary component of an annulus and label the inner boundary component with @xmath148 from some fixed base point",
    ". see figure [ wandf ] .",
    "+ [ wandf ] figure    let @xmath6 be a long edge of @xmath68 . for the occurrence of @xmath6 with exponent @xmath61 we add a properly embedded path , labelled by @xmath668 ( remember this has length at most @xmath504 in @xmath0 , see lemma [ lsc ] ) , from @xmath368 to @xmath669 on @xmath148 and similarly , for the occurrence of @xmath6 with exponent @xmath62 , we add a properly embedded path , labelled by @xmath670 , from @xmath671 to @xmath672 on @xmath148",
    ". see figure [ wanadf2 ] .",
    "+ [ wanadf2 ] figure    we do this for each long edge of @xmath68 .",
    "identify the long edges of @xmath68 , respecting orientation to obtain a surface @xmath673 .",
    "the new surface @xmath673 is just the surface @xmath83 with a disc removed .",
    "the boundary of the disc removed from @xmath83 is labelled by @xmath148 . now",
    "the graph @xmath674 is embedded in @xmath673 and is a subgraph of a larger graph also embedded in @xmath673 , which consists of the boundary of the annulus and the properly embedded paths on the annulus after identification .",
    "we denote this graph @xmath675 .",
    "see figure [ gammasa ] .",
    "embedded in @xmath673 ]    we again consider sections of the graph @xmath595 where long edges either meet a cyclic word @xmath623 , @xmath624 , @xmath677 or one of the vertices @xmath678 , @xmath679 , which does not lie on a boundary component of @xmath83 .",
    "let @xmath626 be the long edges which have an end point on @xmath600(_resp .",
    "_ which have an end point which is @xmath678 ) .",
    "let @xmath627 .",
    "again these can be renumbered such that @xmath68 contains the cyclic subwords @xmath630 where @xmath631 , for all @xmath632 .",
    "see figure [ eandws ] .",
    "the word @xmath600 obviously has length zero if we are considering @xmath678 . in our new extended graph @xmath675",
    "this section of the graph now takes the form as shown in figure [ eandws2 ] ,     + [ eandws2 ] figure    where @xmath680 and @xmath681 remove the edges @xmath682 from @xmath675 .",
    "now , for each @xmath683 , there is an edge path from @xmath684 to @xmath685 labelled by @xmath686 , where @xmath687 , @xmath688 and @xmath689 is sequence of short edges in @xmath68 .",
    "note that if @xmath690 then the edge path from @xmath691 to @xmath692 is labelled by @xmath693 .",
    "we have already defined @xmath694 , for @xmath683 and @xmath695 for @xmath690 . for all @xmath632 ,",
    "we shall also remove the edges labelled by @xmath689 and @xmath696 , add new edges from @xmath684 to @xmath685 , labelled by @xmath697 , for @xmath683 , and add a new edge from @xmath698 to @xmath692 , labelled by @xmath699 , for @xmath690 .",
    "see figure [ eandws3 ] .",
    "+ [ eandws3 ] figure    we now do this for all @xmath623 , @xmath700 , @xmath605 , and @xmath678 , @xmath701 .",
    "we shall call this new graph @xmath702 .",
    "it is clear , by the way we numbered @xmath626 , that the following are cyclic subwords of the hamiltonian cycle in @xmath702 labelled by @xmath148 .",
    "@xmath703 where @xmath631 , for all @xmath632 .",
    "the cyclic sequence of letters of @xmath67 gives the cyclic sequence of segments of @xmath148 by replacing a letter @xmath154 of @xmath67 with @xmath619 for its occurrence with exponent @xmath61 and @xmath620 for its occurrence with exponent @xmath62 .",
    "thus , to show that @xmath702 is an extension of @xmath67 over @xmath0 by the cyclic words in the sets @xmath704 , it is clear that we must show that step @xmath141 , of the construction of an extension over @xmath0 , holds .",
    "let @xmath6 be a long edge of @xmath443 and without loss of generality assume that @xmath6 appears before @xmath602 .",
    "consider the two edges @xmath705 and @xmath706 in @xmath702 .",
    "there exist an @xmath707 and @xmath708 which we shall denote @xmath63 and @xmath64 respectively such that the edge path @xmath709 is a cycle in @xmath702 .",
    "see figure [ extstep3b ] .",
    "+ [ extstep3b ] figure    by the construction ( see definitions of the @xmath635 s and figure [ eandws2 ] ) @xmath63 and @xmath64 can be split up into subwords , @xmath710 and @xmath711 respectively , such that in @xmath182 we have closed paths as shown in figure [ apmb4 ] .",
    "note that @xmath265 and @xmath712 are @xmath20 and @xmath350 but @xmath264 and @xmath713 may include part of @xmath346 as indicated in the diagram .",
    "+ [ apmb4 ] figure    from @xmath182 we can see that @xmath714 it follows that @xmath715 . hence step @xmath141 holds and we have an extension of @xmath67 over @xmath0 .",
    "we have already shown that the genus of @xmath67 is @xmath41 .",
    "remember that the genus of the extension is given by the sum of the genus of the cyclic words used .",
    "but these are just the elements of the sets @xmath622 . now",
    "the genus of every element of @xmath657 is zero ( note also that the vertices extended by elements of @xmath657 have degree of at least @xmath141 , see page ) and the genus of the elements in each set @xmath641 , for @xmath605 is equal to @xmath612 ( again note that if the genus of @xmath716 then the vertex extended by the only element of @xmath641 is of degree at least @xmath141 , see lemma [ c_i ] ) .",
    "therefore , it follows from the definition that the genus of the extension is equal to the sum of the genus of each set @xmath641 , for @xmath605 .",
    "we know that @xmath717 and @xmath718 , see lemma [ gi ] .",
    "thus the extension is of the required genus for part @xmath77 of the theorem to hold .",
    "the length of the extension is given by the sum of the length of the words in the sets @xmath622 .",
    "each element of a set @xmath641 , for @xmath719 , takes the form @xmath636 where @xmath720 with all the @xmath721 s having length zero if @xmath722 .",
    "each short edge of @xmath68 appears in a unique @xmath689 and these have labels in @xmath1 which have length at most @xmath442 .",
    "each @xmath723 is a word of length at most @xmath504 arising from a long edge of @xmath68 , see lemma [ lsc ] and these each appear twice in some @xmath635 . by lemma [ cull ] , it follows that the maximum number of letters in @xmath68 is @xmath438 .",
    "thus the sum of number of short letters and long letters is at most @xmath438 .",
    "therefore , if @xmath724 and @xmath725 are the numbers of short edges and long edges respectively , the length of the extension is given by @xmath726 hence we have the required extension and the theorem holds.[endthm ]",
    "we shall now use theorem [ thexp ] to obtain a full list of all possible forms for commutators in @xmath48 .",
    "now since in this case @xmath727 , it follows that @xmath728 .",
    "[ propos ] if @xmath145 is a commutator in @xmath0 then there are words @xmath445 and @xmath148 in @xmath1 which are minimal in @xmath0 such that @xmath729 , where @xmath730 and @xmath148 takes one of the following forms .",
    "1 .   @xmath731 with @xmath732 and @xmath733 , @xmath734 , @xmath735 .",
    "2 .   @xmath736 with @xmath737 . where @xmath738 and @xmath739 is conjugate to @xmath740 in @xmath0 .",
    "3 .   @xmath741 with @xmath742 , @xmath743 . where @xmath744 and @xmath745 .",
    "4 .   @xmath746 with @xmath747 , @xmath748 and @xmath749 . where @xmath750 and @xmath751 .",
    "by theorem [ thexp ] and our knowledge of genus @xmath61 wicks forms ( see beginning of the paper ) , @xmath145 is conjugate to a minimal word @xmath148 which either has form @xmath61 above or is obtained by a genus @xmath69 extension of length at most @xmath752 on some orientable word of genus @xmath41 such that @xmath753 .",
    "this implies that there are only three possible orientable words which can have a suitable extension(this is easy to check ) .    1 .   an orientable word @xmath754 of genus @xmath158 with a joint genus @xmath61 extension constructed on the two vertices of @xmath74 .",
    "2 .   an orientable word @xmath755 of genus @xmath61 with a genus @xmath158 extension constructed on the only vertex of @xmath756 .",
    "3 .   an orientable word @xmath757 of genus @xmath61 with a genus @xmath158 extension constructed on both of the vertices of @xmath392 .        by theorem",
    "[ thexp ] , @xmath148 takes the form of the hamiltonian cycle @xmath758 in the extended graph and from the nature of the extension constructed on @xmath67 , it is clear that we have form @xmath77 .        by theorem [ thexp ]",
    ", @xmath148 takes the form of the hamiltonian cycle @xmath759 in the extended graph and from the nature of the extension constructed on @xmath340 , it is clear that we have form @xmath141 .",
    "again , by theorem [ thexp ] , @xmath148 takes the form of the hamiltonian cycle @xmath760 in the extended graph and from the nature of the extension constructed on @xmath68 , it is clear that we have form @xmath761 .",
    "hence @xmath145 is conjugate to some @xmath148 which takes one of the required forms .",
    "let @xmath445 be the shortest word in @xmath0 such that @xmath447 .",
    "if @xmath148 takes form @xmath61 then , by lemma [ lb ] , it follows that @xmath762 thus the proposition holds . therefore , suppose that @xmath148 is obtained by an extension of some orientable word . in the proof of theorem [ thexp ] ,",
    "@xmath148 was constructed from some wicks form @xmath68 and a labelling function @xmath763 such that @xmath346 was minimal over the set of pairs in @xmath332 . in the proof we chose a cyclic permutation @xmath443 of @xmath68 such that the last letter was a long edge .",
    "now in the genus @xmath61 case all wicks forms take the form @xmath764 where at most one of these letters is set to @xmath61 , see @xcite , and obviously all cyclic permutations are of this form too .",
    "thus , in this case , we shall choose the cyclic permutation @xmath443 which ends in a long letter such that @xmath445 is the shortest over all cyclic permutations which end in a long letter .",
    "let @xmath587 .",
    "it follows from the proof of theorem [ thexp ] that @xmath446",
    ". see figure [ caywhat ] .",
    "let @xmath160 be the terminal vertex of the label of a long edge of @xmath443 in @xmath182 .",
    "suppose that there exist a vertex @xmath161 lying on @xmath148 such that @xmath765 , for some constant @xmath766 .",
    "if @xmath767 for some constant @xmath768 then @xmath769    without loss of generality let @xmath770 . also we shall let @xmath771 be a minimal word such that @xmath772 . consider the vertex @xmath161 .",
    "by lemma [ la ] part @xmath515 , there exists a vertex @xmath773 on @xmath774 such that @xmath775 .",
    "first suppose that @xmath773 lies on either @xmath445 or @xmath776 .",
    "without loss of generality we shall assume this to be @xmath445 .",
    "now by lemma [ la ] part 3 we can see that @xmath777 . by the triangle inequality",
    "@xmath778 so there exists a path @xmath487 in cayley graph from @xmath160 to @xmath773 of length at most @xmath779 .",
    "let @xmath780 such that @xmath781 .",
    "cut and paste along @xmath487 as shown in figure [ cuts ] .",
    "it is easy to see from the cayley graph that @xmath782 thus we have a new cyclic permutation of @xmath68 , with the last letter @xmath6 being a long edge .",
    "now , since @xmath443 was chosen to be the cyclic permutation which end in a long letter such that @xmath445 is minimal over all cyclic permutations which ends in a long letter , it follows that @xmath783 .",
    "this implies that @xmath784 .",
    "therefore , by the hypothesis @xmath785 thus by lemma [ lb ] @xmath786 as required",
    ".    now suppose that @xmath773 lies on @xmath771 .",
    "it is easy to see that either @xmath787 or @xmath788 . without loss of generality",
    "we shall assume the former .",
    "using the triangle in equality it follows that @xmath789 therefore , there exists a path @xmath38 of length at most @xmath790 from @xmath791 to @xmath160 . since @xmath792 , it is easy to see that @xmath793 again , from our choice of cyclic permutation of @xmath68 , we know that @xmath794 . hence the lemma holds .",
    "suppose that @xmath148 has form @xmath77 , that is @xmath736 . by the triangle inequality",
    "it follows that @xmath795 also , by lemma [ lsc ] , @xmath669 on @xmath148 in @xmath182 is within @xmath504 of a terminal vertex of some long edge of @xmath444 .",
    "therefore , lemma [ conj ] implies that @xmath796 thus in this case the proposition holds .",
    "now if @xmath148 takes form @xmath141 or @xmath761 we follow the same procedure . for form @xmath141 , that is @xmath797 , we have @xmath798 and we know that @xmath799 on @xmath148 in @xmath182 is within @xmath504 of a terminal vertex of some long edge of @xmath444 . for form @xmath761 , that is @xmath746 , we have @xmath800 and we know that @xmath801 on @xmath148 in @xmath182 is within @xmath504 of a terminal vertex of some long edge of @xmath444 .",
    "thus we may use lemma [ conj ] in both cases to get the required bound for @xmath802 .",
    "hence the proposition holds .",
    "similar lists of forms can of course be constructed for elements of higher genus .",
    "although , the number of possible extension increases dramatically with the increase of genus .",
    "a.  vdovina lists the number of maximal orientable wicks forms up to genus @xmath803 , see @xcite .",
    "this gives an idea of the number of extensions one would need to do .",
    "alonso , t.  brady , d.  cooper , v.  ferlini , m.  lustig , m.  mihalik , m.  shapiro and h.  short , _ notes on word hyperbolic groups _ from group theory from a geometric viewpoint edited by e.  ghys , a.  haefliger and a.  verjovsky , world scientific , 1990 , pp 3 - 63 .",
    "r.  bacher and a.  vdovina , _ counting 1-vertex triangulations of oriented surfaces _ , discrete math .",
    ", * 246 * , 2002 , pp .",
    "comerford , l.p .",
    "comerford , jr . , and c.c .",
    "edmunds , _ powers as products of commutators _ , comm .",
    "algebra , * 19 * , no . 2 , 1991 , pp .",
    "675 - 684 .",
    "comerford and c.c .",
    "edmunds , _ products of commutators and products of squares in a free group _ , inter .",
    "jour . of alg . and computation , vol .",
    "4 , no . 3 , 1994 ,",
    "469 - 480 .",
    "comerford , c.c .",
    "edmunds and g.   rosenberger , _ commutators as powers in free products _ , proc . of amer . math .",
    "122 , no . 1 , 1994 , pp .",
    "m.  culler , _ using surfaces to solve equations in free groups _ , topology , vol . 20 , 1981 , pp",
    ". 133 - 145 .",
    "friel , _ decision problems in hyperbolic groups _",
    ", phd thesis , newcastle upon tyne , 2000 .",
    "grigorchuk and i.g  lysionok , _ a description of solutions of quadratic equations in hyperbolic groups _ , inter .",
    "jour . of alg . and computation , vol .",
    "2 , no . 3 , 1992 ,",
    "237 - 274 .",
    "i.g  lysionok , _ on some algorithmic properties of hyperbolic groups _ ,",
    "math , vol .",
    "53(4 ) , 1989 , english transl . in math .",
    "145 - 163 , 1990 .",
    "massey , _ algebraic topology : an introduction _ , harbrace college mathematics series , 1967 .",
    "a.  vdovina , _ products of commuators in free products _ , inter .",
    "jour . of alg . and computation , vol",
    ". 7 , no . 4 , 1997 , pp . 471 - 485 .",
    "a.  vdovina , _ on the number of nonorientable wicks forms in a free group _ , proc .",
    "royal soc . of edin .",
    "* 126a * , 1996 , pp .",
    "113 - 116 .",
    "wicks , _ commutators in free products _ , j. london math .",
    "soc . * 37 * , 1962 , pp .",
    "433 - 444 ."
  ],
  "abstract_text": [
    "<S> in 1962 m.j .  </S>",
    "<S> wicks @xcite gave a list of forms for commutators in both free groups and free products . since then similar lists have been constructed for elements of higher genus . in @xcite a.  </S>",
    "<S> vdovina described a method for the construction of forms for elements of any genus in free products . </S>",
    "<S> we shall give a similar result for the construction of such forms in any hyperbolic group @xmath0 and from this we shall obtain a full list of forms for commutators in @xmath0 . </S>"
  ]
}