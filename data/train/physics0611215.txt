{
  "article_text": [
    "we introduce electro - magnetic field variables @xmath0 that are designed to have directional characteristics .",
    "these variables have the potential to speed up numerical simulations , while providing valuable insight into the process of optical pulse propagation at the same time .",
    "simple plane - polarized versions of @xmath0 for a dispersionless medium were originally proposed by fleck at the beginning of ref .",
    "@xcite , although he did not use them in the rest of the paper . in the generalized form defined below , it is possible to use them to advantage in practical situations .",
    "we note that a different approach to directional pulse propagation based on projection operators was proposed by kolesik et.al .",
    "@xcite ; there is also the recent work of ferrando et.al .",
    "@xcite based on a second order wave equation .",
    "the essential characteristic of @xmath1 and @xmath2 is that they represent energy fluxes directed in the forward and backward directions respectively .",
    "this implies that @xmath1 is the appropriate variable to use in situations where pulses are travelling only in the forward direction .",
    "indeed , as we will explain , optimal construction of @xmath1 makes @xmath2 negligible under these circumstances , and the computational effort can then be halved by neglecting @xmath2 altogether .",
    "if we apply a @xmath3-propagated pseudospectral spatial - domain ( pssd ) algorithm @xcite , we also gain a fast and flexible treatment of dispersion and nonlinear effects , which significantly outperforms standard finite difference time - domain ( fdtd ) methods @xcite .",
    "further , since many authors ( including the recent @xcite ) assume that the backward field is negligible in any case , the explicit appearance of @xmath2 within our formalism provides a direct test of the validity of this assumption .",
    "a further advantage of @xmath0 is that it is as easy to include magneto - optic effects as electro - optic effects such as dispersion and nonlinearity .",
    "it is in situations involving both electro- and magneto - optic effects where we achieve the greatest computational speed increase  potentially up to 100% faster .",
    "moreover , even if one chooses to propagate an optical pulse using @xmath4 and @xmath5 , it is still easy to analyse its directional characteristic by constructing @xmath0 after the event .",
    "after reviewing fleck s original form of the @xmath0 variables at the start of section [ s - definitions ] , we proceed to discuss how to represent the permittivity and permeability of the medium ; this is a crucial step in the optimal construction of @xmath0 in a generalized form .",
    "the treatment of nonlinearities and the calculation of energy and flux are also covered .    in section [ s - firstorder ]",
    ", we derive a first - order wave equation , both in a form that is fully equivalent to maxwell s equations , and in a more useful one that is applicable in the transverse field limit . in section [ s - simulations ] , we demonstrate a simple procedure for the numerical implementation of @xmath0 simulations ; techniques for specifying initial conditions and for handling dispersion and nonlinear effects are examined in detail .",
    "we take as an example the case of second harmonic generation in periodically - poled lithium niobate , to demonstrate that our method can be applied to practical as well as illustrative simulations . in all cases ,",
    "we retain both @xmath1 and @xmath2 , but show that with optimal construction , @xmath2 can be made negligible .    in section [ s - envelopes ]",
    "we derive a propagation equation for envelopes based on @xmath0 ; in section [ s - secondorder ] we develop a second order wave equation ; and in section [ s - alternatives ] we propose alternative definitions for field variables with directional properties .",
    "finally , in section [ s - conclusion ] , we present our conclusions .",
    "for plane - polarized fields , propagating in the @xmath3 direction in a dispersionless medium , fleck defined the direction field variables   @xmath6 their directional properties are apparent from the form of the poynting vector   @xmath7 , \\label{eqn - s - defs - sfleck}\\end{aligned}\\ ] ] which shows that @xmath8 and @xmath9 are associated with positive and negative energy flux respectively . unfortunately , if eqn .",
    "( [ eqn - s - defs - gfleck ] ) is used to describe a forward - propagating pulse in a _ dispersive _ medium , it will contain significant contributions from both @xmath8 and @xmath9 .",
    "we therefore need to generalize the construction in order to make the concept useful in practical situations .",
    "the definitions of @xmath10 ( and their generalized vector counterparts @xmath0 , introduced below ) depend on the properties of the propagation medium through the permittivity @xmath11 and permeability @xmath12 . in principle",
    "it would be attractive to define @xmath0 using the exact values of @xmath13 ( including the nonlinearity ) , but this is usually impractical , and we will instead use `` reference '' values @xmath14 , @xmath15 , chosen to be as close as practicable to the true medium properties , typically by including all the dispersive properties .    in the frequency domain ( indicated by tildes ) , we write   @xmath16 where the correction parameters @xmath17 and @xmath18 represent the discrepancy between the true values and the reference .",
    "the smaller these correction terms are , the better the match , and the more likely it is that a description involving only @xmath8 will suffice .",
    "note that since the definitions of @xmath10 depend on the square roots of @xmath19 and @xmath20 , we introduce the @xmath21 and @xmath22 parameters , which will feature prominently ( along with their time domain counterparts @xmath23 ) , in the generalized definitions of @xmath24 that follow .    by using these frequency dependent parameters in the generalized definitions of @xmath10 , we are able to propagate pulses using only the @xmath8 variable , a gain in both mathematical simplicity and computational speed .          the divergence of @xmath0 , allowing for both charge density @xmath42 and current density @xmath43 , is @xmath44 we note that this is zero when the @xmath42 and @xmath43 are zero , as long as there is no longitudinal electric field .",
    "different choices of @xmath45 produce different @xmath0 pairs .",
    "whilst using the true values to describe a forward propagating pulse results in @xmath46 , any other choice of reference will produce a non - zero @xmath2 component that co - propagates with @xmath1 .",
    "note that this @xmath2 still has an energy flux directed in the reverse direction ( @xmath47 ) , but travels forwards with the @xmath1 with which it is tightly coupled .",
    "we will almost always choose @xmath45 to include the entire linear dispersion of the medium .",
    "we exclude the nonlinearity because it removes the ability to reconstruct @xmath48 fields uniquely from the @xmath0 , as can be seen from eqns .",
    "( [ eqn - s - defs - gvectorw ] , [ eqn - s - defs - gvector ] , [ eqn - s - defs - evector ] , [ eqn - s - defs - hvector ] ) , which will become nonlinear in @xmath37 and @xmath38 .",
    "the vectorized definitions of @xmath0 accommodate any polarization of the @xmath4 and @xmath5 fields . for propagation along the @xmath3 axis",
    ", the @xmath49 component of @xmath0 ( @xmath50 ) will contain @xmath51 and @xmath52 ; and similarly @xmath53 , will contain @xmath54 and @xmath55 .",
    "it is then a simple matter to see how linearly or circularly polarized @xmath37 and @xmath38 fields can be represented in terms of @xmath0 .",
    "the definitions are also easily generalized to include birefringent media , provided the propagation direction and transverse coordinate axes are such that @xmath14 and @xmath15 become diagonal matrices .",
    "finally , note that @xmath0 bear some resemblance to beltrami variables ( see e.g. @xcite ) which are defined as @xmath56 ; but they differ in two important respects .",
    "first , a given beltrami @xmath57 defines @xmath37 and @xmath38 uniquely , whereas both @xmath1 and @xmath2 are needed to do the same .",
    "secondly , @xmath57 does not assume any preferred direction , whereas the @xmath0 variables include the direction @xmath26 in their definition .",
    "further , beltrami variables are not defined using the full time ( or frequency ) dependence of @xmath13 as we use for @xmath0 in eqns . ( [ eqn - s - defs - gvectorw ] , [ eqn - s - defs - gvector ] ) , although presumably this would be possible .",
    "since it is usually impractical to include nonlinearities in the reference parameters , these will normally appear in the correction terms @xmath58 , @xmath59 .",
    "as an example , consider a @xmath60-th order ( electric ) nonlinearity , in which case @xmath61 , and   @xmath62^{-1 }   .",
    "\\mathscr{f }       \\left [        \\chi^{(n)}(t )        \\ast         e(t)^{n-1 }      \\right ] , \\label{eqn - nonlinear - alphac - w } \\\\    \\alpha_c ( t ) & = &   \\mathscr{f}^{-1 }   \\left\\ {     \\left [        \\tilde{\\alpha}_r ( \\omega )     \\right]^{-1 }    .",
    "\\tilde{\\chi}^{(n)}(\\omega )     .        \\mathscr{f }          \\left [                e(t)^{n-1 }          \\right ]   \\right\\ } , \\label{eqn - nonlinear - alphac - t}\\end{aligned}\\ ] ] where @xmath63 $ ] is the fourier transform ( ft ) from time to frequency , and @xmath64 can be found from eqn .",
    "( [ eqn - s - defs - evector ] ) .",
    "if the reference parameters @xmath65 contain dispersion ( which will be the typical case ) , we can see from eqn .",
    "( [ eqn - nonlinear - alphac - w ] ) that this will make @xmath66 dispersive even if @xmath67 is instantaneous . in the case of an instantaneous nonlinearity",
    ", this adds more computational work ( an extra two fts ) , although for non - instantaneous ones we needed the fts anyway .",
    "if the nonlinearity is instantaneous _ and _ the reference parameters are non - dispersive , we have simply @xmath68^{n-1}$ ] .        since both the @xmath72 terms are real and positive",
    ", we see that @xmath1 and @xmath2 contribute positive and negative energy fluxes respectively .",
    "this leads to the simple interpretation that for particular @xmath37 and @xmath38 fields , @xmath1 corresponds to the energy flux directed forward ( along @xmath26 ) , and @xmath2 to flux directed backward .",
    "the need for this distinction between the direction of the flux due to a @xmath0 field , and its direction of travel has already arisen in [ ss - definitions - g ] above .",
    "notice the cross terms , which appear whenever there is a mismatch between the reference and medium parameters . these occur because of the interference between the @xmath1 and @xmath2 contributions to the field .    for a dispersive reference ,",
    "the relevant formulae for @xmath75 and @xmath76 are relatively complicated because of the appearance of cross terms and/or convolutions",
    ". however , this should not produce a significant overhead in numerical simulations because the code will be switching between time and frequency domains at each step , allowing @xmath75 and @xmath76 to be calculated in whatever way is most efficient .",
    "we now consider using a moving reference frame .",
    "this is particularly useful in a space - propagated model where the pulse is held as a function of time , since it will stay nearly centered when propagating forwards .",
    "a simple choice of frame speed might be the phase velocity at the centre frequency of the pulse , which minimises the motion of the carrier - like oscillations ; however , the pulse as a whole will move within the frame because of its different group velocity .",
    "the frame translation for a speed @xmath77 is   @xmath78   where @xmath79 is the distance travelled in the direction of @xmath26 .",
    "thus   @xmath80    in vector calculations , we need to know how this frame translation transforms the curl and divergence operations .",
    "the divergence is a straightforward consequence of eqn .",
    "( [ eqn - z - frametranslation ] ) , and the curl of an arbitrary vector @xmath57 transforms to   @xmath81    the ratio of the reference speed ( the phase velocity in the reference medium   described by @xmath82 ) and frame speeds is   @xmath83    if we choose to give @xmath84 and @xmath85 a frequency dependence , we have defined a `` dispersive frame '' , where different frequency components travel at different speeds . in such a frame , any matching dispersive evolution ( i.e. where @xmath86 and @xmath87 ) results in no change to the pulse profile .",
    "however , at the end of the simulation , we need to transform from the dispersive frame back into a normal ( non - dispersive ) laboratory frame .",
    "moreover , using a dispersive frame can give rise to numerical stability problems .",
    "we now derive a set of first - order differential equations for the forward and backward directed fields @xmath0 , and use the moving frame set out above in eqns .",
    "( [ eqn - z - frametranslation ] , [ eqn - vector - frametranslation ] ) .",
    "we assume that the medium is continuous , so that @xmath88 , where @xmath89 .",
    "this does not impose a significant restriction in practice , since a simulation propagated forwards in space can easily handle interfaces between different media .      for a vector derivation of propagation equations for @xmath0",
    ", we start with the two relevant ( source free ) maxwell s equations . writing them in frequency space , with @xmath90 and @xmath91 ; and taking the cross product of @xmath26 and the @xmath92 equation yields   @xmath93 multiplying respectively by @xmath94 and @xmath95 and taking sums and differences leads to   @xmath96          the equations above are written to suggest a spatially directed propagation ( along @xmath26 ) , and indeed are most straightforwardly solved that way",
    ". however , a simple rearrangement of the terms leads to a @xmath39-directed propagation model , although , in its present form , the time - like evolution of eqn .",
    "( [ eqn - firstorder - gpm - std ] ) is obscured . whilst @xmath39-directed propagation has some advantages",
    ", it makes the treatment of dispersion and other time - memory effects more demanding , as discussed by kolesik and moloney @xcite and tyrrell et.al . @xcite .",
    "note that reversing the direction of propagation by changing @xmath26 to @xmath47 reverses the roles of @xmath1 and @xmath2 .",
    "one nice property of this equation is that matching the frame velocity to the phase velocity causes the carrier - like oscillations in the forward travelling fields @xmath8 to freeze in place , leaving only the evolution due to the correction terms .",
    "if we are prepared to make the common assumption of only forward - travelling pulses , we will have managed to greatly reduce the rate of change of the fields .",
    "this in turn will allow coarser numerical resolutions to be employed in numerical simulations , leading to significant speed advantages over and above those obtained by assuming @xmath112 .      in fdtd solutions of maxwell s equations , optical pulses travel either forwards or backwards in space as they propagate ( or march ) forward with time .",
    "however , most nonlinear optical simulations are done in a space - propagated picture ; with the consequence that optical pulses travel either forwards or backwards in _ time _ as the calculations propagate ( march ) through space .    since we follow the space - propagated picture , the pulse travelling forward in time",
    "will be described by @xmath8 , and the one travelling backward by @xmath9 .",
    "note that any backward travelling pulse in a @xmath3-propagated picture is travelling backwards in time while propagating forwards in space .",
    "although at first this might seem non - causal , it is in fact the way that the simulation represents a pulse which we would normally describe as propagating backwards ( i.e. in the direction @xmath47 ) .",
    "this is clear from the wave equations ; swapping the sign of the propagation direction @xmath26 swaps the behaviour of @xmath1 and @xmath2 .",
    "we can make the most of our approach by decoupling @xmath1 from @xmath2 , enabling the two first - order coupled maxwell s eqns .",
    "( [ eqn - firstorder - dte ] , [ eqn - firstorder - dth ] ) or @xmath0 eqns .",
    "( [ eqn - firstorder - gpm ] ) ( or co - moving form eqn .",
    "( [ eqn - firstorder - gpm - comoving ] ) ) to be reduced to two uncoupled first - order equations .",
    "the equation describing propagation in the uninteresting direction can then be discarded , leaving one first - order equation where there were originally two .",
    "this step requires an approximation , although since we can perfectly match the reference parameters ( @xmath113 , @xmath114 ) to the material dispersion , it is not a very stringent one . since the correction parameters @xmath115 , @xmath116 depend only on nonlinear effects , they will in general",
    "be small , keeping cross coupling between @xmath1 and @xmath2 minimal .",
    "further , whilst the @xmath1 field will rotate forwards according to its wavevector ( i.e. @xmath117 , with @xmath118 ) , the @xmath2 field will rotate backwards at the same rate ( i.e. at @xmath119 ) .",
    "this means the correction terms for @xmath1 will contain both an in - sync component from @xmath1 , and a component from @xmath2 with a large detuning . since this detuning ( amounting to @xmath120 will usually be large compared to the spatial bandwidth of the pulse",
    ", we can apply a rotating wave approximation and average the @xmath2 contribution to zero . after applying the same steps to the @xmath2 equation as well , eqn .",
    "( [ eqn - firstorder - gpm ] ) becomes   @xmath121",
    "we now examine the procedure needed to simulate wave propagation using the @xmath10 variables . this will clarify various practical issues as well as illuminate some of the less - obvious features of our approach .",
    "we consider a plane - polarized em wave propagating along @xmath3 in a non - magnetic medium with dispersion and a weak nonlinearity . since our aim is to explain the fundamental principles of the use of @xmath10 variables , we first present a number of simple examples .",
    "our numerical simulations of the g@xmath122 wave equations are implemented by straightforward adaption of the pssd technique @xcite . in pssd",
    ", fields are stored as functions of time , and fast fourier transforms ( ffts ) are used to convert to the frequency domain for the calculation of pseudospectral derivatives and the effects of dispersion .",
    "this technique allows the simple application of arbitrary dispersion , which becomes a simple multiplication in frequency space .",
    "fields are then transformed back to the time domain , where the nonlinear effects are calculated , before propagating the fields forward in space .",
    "computational details , such as how to design the mesh and control the accuracy of the simulations are well known ( e.g. the courant and nyquist criteria ) , and can be found in a range of sources ( e.g. @xcite ) .    when applied to g@xmath122 fields , the basic spatially - propagated pssd algorithm does not change , but",
    "the wave equation to be solved is now eqn .",
    "( [ eqn - firstorder - gpm - std ] ) instead of maxwell s equations .",
    "this means that the full flexibility of pssd is harnessed with the advantages of g@xmath122 fields to give a powerful and efficient combination .",
    "the computational speed of any pssd - type propagation depends primarily on the time spent doing fts . in the pssd technique described in @xcite ,",
    "five fts are used , two forward and back pairs , and one ( forward only ) to calculate the derivative of the electric displacement @xmath123 .",
    "if magnetic dispersion were present , pssd would require an extra ft for the magnetic induction @xmath124 , making six fts in all .",
    "in contrast , a @xmath8 simulation requires only three fts .",
    "this comprises two forward fts which are used to calculate the derivative for the dispersion and nonlinearity , and one backward ft is used to change back into the time domain ; the two derivatives are combined in the frequency domain where the problem becomes linear .",
    "such a simulation will therefore run 67% faster than the corresponding @xmath4 and @xmath5 pssd algorithm ; or 100% if there is also magnetic dispersion .    to include both @xmath8 and @xmath9 would require six fts ; one more than the usual pssd case , but the same if magnetic dispersion needs to be included .      as a first step ,",
    "we divide the total permittivity into three : a reference component with constant permittivity @xmath125 , a linear dispersion correction @xmath126 , and an instantaneous nonlinearity @xmath127 ; the permeability has the vacuum value @xmath128 .",
    "the medium properties can therefore be represented in the following fashion   @xmath129   this particular breakdown of @xmath19 is for illustrative purposes only ; in practice , we would choose a dispersive reference and try to leave only nonlinear terms in the correction parameters ( i.e. use @xmath130 ) .",
    "we might also regroup various terms to optimise the numerical performance .    the first order evolution equation , specialized from eqn .",
    "( [ eqn - firstorder - gpm - std ] ) , is   @xmath131 \\nonumber \\\\ & &   ~~   \\mp     \\frac{\\imath \\omega \\tilde{\\alpha}_c^{nl } \\tilde{\\beta}_r }         { 2 }    \\left [ g_x^{+ } + g_x^{- } \\right ] .",
    "\\label{eqn - firstorder - example1}\\end{aligned}\\ ] ] where the rhs contains respectively a reference carrier term ( @xmath132 ) , a linear dispersion term ( @xmath133 ) , and a nonlinear polarization term ( @xmath134 ) .",
    "we integrate forward in @xmath3 using a split - step method , where each term is integrated through @xmath135 in sequence .",
    "this procedure is accurate to first order , so we need to ensure @xmath135 is sufficiently small .    in this simple case",
    ", the reference term merely applies a complex rotation to the field in frequency space represented by   @xmath136 \\label{eqn - firstorder - example1-g1 } .\\end{aligned}\\ ] ]    if the frame velocity is chosen to be the same as the phase velocity given by the reference parameters , the @xmath137 field no longer undergoes any reference evolution as it propagates .",
    "this contrasts with the usual approach , which is to match the frame velocity to the group velocity .",
    "however , with our choice of reference parameters , the group velocity corrections appear in the second rhs term as part of @xmath138 .",
    "if we were to propagate @xmath139 in a group velocity frame , we would retain part of the reference term , which would then cancel with part of the group velocity contribution from the dispersion term .",
    "this could lead to a better overall cancellation , just as in the usual @xmath4 field approaches .",
    "if that were our aim , we could indeed easily rearrange eqn .",
    "( [ eqn - firstorder - example1 ] ) to incorporate such a cancellation , and then solve the equation appropriately .",
    "the next step is to solve for the linear dispersion @xmath140 .",
    "fortunately , this part of the equation is also easy to solve exactly in the frequency domain , through the operation   @xmath141        .        \\delta",
    "z      \\right ] .",
    "\\label{eqn - firstorder - example1-g2}\\end{aligned}\\ ] ]    although both reference and dispersion steps can be solved using exponentials , there is an important difference .",
    "the reference evolution of @xmath8 depends only on @xmath8 , whereas the dispersion evolution depends on the sum @xmath142 , since the dispersion acts on the electric field . in a forward - only approximation where @xmath112 , it is trivial to combine these first two steps , as in most approaches to solving for the propagation of optical pulses .",
    "the third and final step is performed by transforming into the time domain and solving for the @xmath60-th order nonlinear effects . since the reference @xmath143",
    "are constants , @xmath144 , a simple euler method gives   @xmath145^n    \\delta z .",
    "\\label{eqn - firstorder - example1-g3}\\end{aligned}\\ ] ]    for a narrow - band field centred at @xmath146 , the time derivative would be dominated by ( and proportional to ) @xmath146 . in most envelope theories we see only this factor @xmath146 in the analogous expression ; although correction terms exist for wider - band fields @xcite .",
    "most descriptions of pulse propagation start with initial conditions chosen to represent a pulse travelling forward in the medium . here",
    "we consider how to choose the best initial conditions for @xmath10 in the case of a pulse travelling _ only _ in the forward @xmath26 direction .",
    "they are based on the best practical parameterization of the medium @xmath147 , @xmath148 , which need not be the same as @xmath149 and @xmath150 .",
    "assuming only the electric field @xmath151 of the pulse is known , the procedure is :    \\(1 ) choose @xmath152 and @xmath153 to be as close as possible to the actual medium parameters @xmath154 .",
    "one might even try to put the nonlinear properties into @xmath152 and @xmath153 as well , but only if one can get a solution for steps ( 2 ) and ( 3 ) below with this added complication .",
    "\\(2 ) calculate @xmath155 corresponding to @xmath151 for a forward travelling pulse , so that a @xmath9 based on @xmath156 would be zero :   @xmath157    \\(3 ) calculate an initial @xmath10 using the chosen reference parameters @xmath158 and @xmath159 , given our initial @xmath151 and @xmath155 fields :   @xmath160    e(\\omega ) .",
    "\\label{eqn - initialconds - g}\\end{aligned}\\ ] ] note that step ( 3 ) is unnecessary if @xmath161 and @xmath162 .",
    "notwithstanding step ( 2 ) , @xmath9 is only eliminated from the simulation if both @xmath152 and @xmath153 are perfect matches to the material parameters . if the ( @xmath152 , @xmath153 ) values are good , but ( @xmath149 , @xmath150 ) less so , a weak @xmath9 field will co - propagate _ forwards _ with @xmath8 , even though the poynting vector of the @xmath9 is directed backwards . if ( @xmath152 , @xmath153 ) is a bad match as well , the initial @xmath9 will have a component that _ travels _ backwards , its magnitude corresponding to that of the reflection between a medium with parameters ( @xmath152 , @xmath153 ) and one with the actual parameters . since it is usually possible to include all the linear dispersive properties in @xmath152 , @xmath153 ,",
    "any discrepancy is likely to be due to the nonlinear contribution , and consequently very small .",
    "figure [ f - diagram - initialconditions ] shows how different choices of reference parameter affect the @xmath10 fields required to model a simple forward - propagating few - cycle pulse at 500 nm in fused silica . note that although the @xmath10 fields in ( a ) and ( b ) are directly proportional to @xmath4 and @xmath5 , in ( c ) , the use of a dispersive reference means that a deconvolution would be needed ( if in the time - domain ) to transform from @xmath10 to @xmath4 and @xmath5 .    in figure [ f - diagram - initialconditions](a ) , the mismatch between the reference parameters ( with @xmath163 ) and the actual medium ( @xmath164 at the 500 nm pulse center wavelength ) causes a significant co - propagating @xmath9 component to appear",
    "; this is improved in ( b ) where the reference parameters specify a constant refractive index close to that at the centre frequency of the initial pulse . since the mismatch between the reference and the true material properties is due only to the material dispersion , the initial co - propagating @xmath9 component is smaller in figure [ f - diagram - initialconditions](b ) than in figure [ f - diagram - initialconditions](a ) .",
    "the reduction in the size of @xmath9 is rather smaller than might be expected , mainly because although fused silica has a refractive index of about 1.5 at 500 nm , we have used non - dispersive reference parameters with a refractive index of 1.5 at all frequencies .    in figure [ f - diagram - initialconditions](b ) , although the construction of @xmath10 has the phase velocity reasonably well matched , the group velocity of the pulse is poorly matched .",
    "in addition there is a smaller effect caused by the wide - band nature of the pulse , where the reference parameters are ( even ) less well matched to frequency components away from the center frequency .",
    "+   +    the conclusion is that , for any pulse propagating in a material whose dispersion is not perfectly matched by the reference over the pulse bandwidth , a finite co - propagating @xmath9 will appear .",
    "this will be made up of frequency components whose phase velocity in the medium do not match the phase velocity given by the reference .",
    "thus , in typical dispersive media , only very narrow - band pulses result in a negligible @xmath9 for non - dispersive reference parameters . however , the mismatch between the reference and the true material properties can be completely removed by using a dispersive reference identical to that of the material being simulated .",
    "the results of this are shown in figure [ f - diagram - initialconditions](c ) , where @xmath9 is identically zero .",
    "we now present a variety of numerical results demonstrating pulse propagation in a dispersive medium .",
    "we take the medium to have the properties of fused silica , but we do not include nonlinear effects for the moment . our aim is to give a flavour of what the @xmath10 fields look like for different reference parameters . the choice of reference is important because , as explained earlier , if the reference is not perfectly matched to the actual medium , a forward travelling pulse will contain a @xmath9 wave co - propagating with the main @xmath8 component .",
    "usually we will want to choose a reference that makes @xmath9 negligible , so we can save computational effort .",
    "we deliberately choose ultra - short pulses containing only a few optical cycles to demonstrate the flexibility of our method in the short pulse limit .",
    "figure [ f - diagram - fifteenmicron ] shows the results for the fields in fig .",
    "[ f - diagram - initialconditions ] after propagating 15@xmath12 m in fused silica with the nonlinearity ignored . in all cases , the initial size of @xmath9",
    "is broadly maintained and , in particular , it remains zero when the reference parameters are perfectly matched .",
    "although the @xmath10 fields in [ f - diagram - fifteenmicron](a ) and [ f - diagram - fifteenmicron](b ) are directly proportional to @xmath4 and @xmath5 , in ( c ) , the use of a dispersive reference means that in that case a deconvolution is needed to transform from @xmath10 to @xmath4 and @xmath5 .    we can also consider the effect of neglecting a finite ( but significant ) @xmath9 field , where the @xmath8 part of the pulse then undergoes the wrong dispersion .",
    "this is because the dispersive correction part ( see e.g. eqn .",
    "( [ eqn - firstorder - example1 ] ) ) depends on @xmath142 , and thus , without @xmath9 , will be either too big or too small .",
    "this problem is avoided by using a dispersive reference identical to that of the material being simulated .",
    "the results of this are shown in figure [ f - diagram - fifteenmicron](c ) , where @xmath9 is always identically zero and no approximation is necessary to omit @xmath9 .",
    "+   +    in figure [ f - diagram - sim - propperref ] we show the result for a simulation with both a perfectly matched dispersive reference _ and _ a perfectly matched dispersive frame . since all the material properties are included in the reference parameters , _ and",
    "_ we pick a frame that exactly matches the propagation , fig .",
    "[ f - diagram - sim - propperref ] looks identical to the initial state in fig .",
    "[ f - diagram - initialconditions](c ) .",
    "we can recover the expected lab - frame final state by transforming fig .",
    "[ f - diagram - sim - propperref ] out of its dispersive frame , and so get a graph identical to fig .",
    "[ f - diagram - fifteenmicron](c ) .",
    "the main message from these simulations is that the better matched the reference parameters are to the material parameters , the smaller the co - propagating @xmath9 . for a perfectly matched reference , the co - propagating @xmath9 vanishes .",
    "also , the better matched the frame is to the material parameters , the slower the evolution of the pulse shape .",
    "however , we then have to do more work to transform the final state of the pulse ( in its moving frame ) into the stationary - frame counterpart we would see in the lab  although for a linearly dispersive frame , the transformation is straightforward .",
    "we now demonstrate some simple pulse propagations in nonlinear media . since neither the initial conditions ( determined by @xmath165 ) nor the reference parameters ( determined by @xmath82 ) include the nonlinearity ,",
    "the pulse is not perfectly forward propagating , and a small `` reflection '' occurs as the pulse starts propagating in the nonlinear medium .",
    "figure [ f - diagram - sim - nonlinearity - chi3 ] shows how pulses similar to those in fig .",
    "[ f - diagram - initialconditions ] look after propagating @xmath166 m through fused silica .",
    "the pulse parameters were adjusted to give a clearer final pulse shape .",
    "we see the same pattern as in figs [ f - diagram - initialconditions ] and [ f - diagram - fifteenmicron ] , where a weak @xmath9 remains except for perfectly matched reference parameters .",
    "note , however , that the addition of nonlinearity does not cause the size of the @xmath9 field to change significantly during propagation .",
    "+   +    we now apply our approach to the practical problem of second harmonic generation in 120@xmath12 m of periodically poled lithium niobate .",
    "the results are shown on figure [ f - diagram - nonlinear - shg ] , and agree with the simulations of tyrrell et.al . @xcite .",
    "+   +   +      a complication arises when propagating a pulse through layers of material with significantly different dispersions .",
    "because the @xmath0 definitions are carefully constructed to match the propagation medium , @xmath0 variables ideal for one layer ( and so ensuring @xmath46 ) will not be ideal for another .",
    "this gives us two options : ( a ) either retain the @xmath2 field in the description , or ( b ) at each layer boundary , switch to a set of @xmath0 variables matched to that medium .",
    "option ( a ) is simpler , but it is not necessarily computationally efficient and leads to complications involving reflections from the interfaces . option ( b ) is more efficient computationally when we are only interested in the forward - going pulse , as the effort involved in switching @xmath0 definitions is comparable to only a single spatial step in the ongoing propagation calculation .",
    "the ability to accurately incorporate dispersion into our reference permittivity allows great control over the magnitude of the @xmath9 field .",
    "our tests have shown that we can confidently neglect @xmath9 if our construction of @xmath10 accurately includes the medium dispersion , although possible exceptions may occur in cases involving extremely strong nonlinearities .",
    "this can be seen in the case of periodically poled lithium niobate discussed above ( see fig . [ f - diagram - nonlinear - shg ] ) , where the ratio of the @xmath9 to @xmath8 intensities was @xmath167 .",
    "an even more rigorous test of @xmath8 s ability to accurately simulate short pulse propagation was our recent study of the effects of dispersion on carrier shocking @xcite . despite the strong nonlinear effects , and significant distortion to the pulse profiles , @xmath8 simulations consistently produced results in agreement with pssd  whilst still only requiring half the computational effort .",
    "the ability to accurately model pulse propagation using _ only _ @xmath8 after carefully choosing a reference permittivity clearly justifies neglecting @xmath9 , which in turn simplifies numerical simulations .",
    "when computing the interaction of narrow - band fields , it is common to remove chosen carrier frequencies , and to evolve the envelopes rather than the complete em fields .",
    "in fact , if sufficient care is taken with the approximations , and the system simulated is well behaved , even quite wide - band pulses can be successfully modelled in this way .",
    "we can use an envelope approach with the @xmath10 variables .",
    "however , a full model requires four envelopes to describe the @xmath10 , just as in a complete maxwell theory where envelopes are needed for both the backward and forward travelling @xmath4 and @xmath5 . a full expansion of @xmath10 into forward and backward envelopes @xmath168 , @xmath169 would be   @xmath170 where we have suppressed the @xmath3 argument on the envelope functions for brevity .",
    "note that the forward - like @xmath9 contribution ( i.e. @xmath171 ) needs a backward - travelling carrier , as otherwise it is not possible to match the reference evolution terms for both @xmath172 and @xmath171 .",
    "when inserted into the wave equations , this expansion results in a large number of terms , even for the relatively simple case of a third - order nonlinearity .",
    "however , we can specialize to the case where only forward - travelling waves are considered , and set @xmath173 .",
    "since the backward - travelling waves are now eliminated , we can propagate pulses efficiently in a moving frame .",
    "this is important , because the backward parts in a moving frame move at _ twice _ the frame speed . in a full ( non - envelope )",
    "simulation , we need somehow to filter out the backward components , as otherwise the hoped - for numerical gains are lost by the fact that a finer @xmath3-step is required for accurate integration .",
    "the first order wave equation for the forward - travelling envelopes defined above is   @xmath174 here @xmath175 , which is simple in the case of dispersion but , in the presence of nonlinearity , will be the appropriately carrier - matched , positive frequency part of the permittivity correction parameter .",
    "if @xmath176 , we have   @xmath177         in a suitable narrow - band limit , we should be able to ignore the first term on the rhs of this equation , leaving the evolution of the envelopes to be controlled solely by the correction term .",
    "the description can be easily generalized to cases involving multiple components centred on different carrier frequencies .",
    "note that this is a first - order envelope equation , and , as such , does not require the various extra approximations needed when deriving an envelope propagation equation from the standard ( @xmath4 field ) second order wave equation .",
    "in section [ s - firstorder ] we derived first - order wave equations for the field variables @xmath0 . however , since many pulse propagation theories start from a second - order form , we have also derived a second - order propagation equation .",
    "we apply the usual restriction to transverse - only fields , and split the medium properties ( i.e. the permittivity and permeability ) into a reference part ( with @xmath178 ) , a linear dispersive part ( controlled by @xmath179 ) and a nonlinear electro - optic polarization part ( @xmath180 ) .",
    "the time - domain wave equation for a non - dispersive reference is   @xmath181     \\pm      \\beta_c^{d } \\ast       \\left [        \\vec{g}^{+ } - \\vec{g}^{- }      \\right ]    \\right\\ }   & & \\nonumber \\\\",
    "=   +    \\frac{1}{2\\alpha_r }      \\partial_t    \\left [      \\frac{1}{c_r }      \\partial_t     \\mp      \\vec{u } \\times       \\nabla \\times    \\right ]        \\vec{p } . & & \\label{eqn - secondorder}\\end{aligned}\\ ] ]    this is similar to the usual second - order equation for the electric field , but has the addition of a curl operator applied to the dispersion and polarization terms .",
    "this second order wave equation can be solved with the use of an envelope - carrier representation for @xmath0 , as is often done with the standard equation for the electric field @xmath4 .",
    "such a derivation can be found in @xcite , which contains both svea and gfea @xcite versions for both @xmath4 and @xmath10 .",
    "the most general form of eqn .",
    "( [ eqn - secondorder ] ) appears in @xcite .",
    "just as one may decide to propagate the @xmath182 field instead of the @xmath4 field , so directional field variables in the style of @xmath0 can be defined in a number of ways .",
    "continuing with the pattern of combining transverse field components with a cross product , alternative directional fields are   @xmath183    the @xmath0 or @xmath184 variables will best suit problems defined in terms of @xmath37 and @xmath38 ; the @xmath0 are best suited to electric media , and the @xmath184 to magnetic media .",
    "in contrast , the @xmath185 or @xmath186 variables are more suited to @xmath187 and @xmath188 .",
    "all these definitions can be used to generate wave equations , by a similar procedure to that in section [ s - firstorder ] .",
    "a point to note is that if the wave equations are generalized to include source terms , the @xmath0 and @xmath184 forms ( or @xmath185 and @xmath186 forms ) of the wave equations look somewhat different .    as an example , here are the full first order wave equations for the @xmath189 form , which is conceptually closest to the uppe ( unidirectional pulse propagation equation ) of kolesik et.al .",
    "@xcite based on projections of @xmath182",
    "   @xmath190 \\nonumber \\\\ & &   ~~   ~~   -    \\frac{\\imath \\omega \\alpha_c \\beta_r }         { 2 }      \\vec{u } \\times \\left [ \\vec{f}^+ - \\vec{f}^- \\right ] \\nonumber \\\\ & &   ~~   ~~   ~~   \\pm",
    "~~    \\vec{u } \\times     \\left ( \\beta_r + \\beta_c \\right )    \\vec{j } , \\label{eqn-1storderd - statframe - transverse } \\\\   \\pm    \\nabla { f}^{\\circ } & = &   +    \\imath \\omega       \\alpha_r \\beta_r      \\vec{u } ~       { f}^{\\circ }   ~~   +    \\imath \\omega       \\alpha_c \\beta_r      \\vec{u } ~       { f}^{\\circ } , \\label{eqn-1storderd - statframe - longitudinal } \\\\    \\nabla     \\cdot    \\left (      \\vec{f}^{+ } - \\vec{f}^{- }     \\right ) & = &    -    \\imath \\omega    \\alpha_r     \\left ( \\beta_r + \\beta_c \\right )    \\vec{u }     \\cdot    \\left (      \\vec{f}^{+ } + \\vec{f}^{- }     \\right ) \\nonumber \\\\ & &   ~~   +   \\left ( \\beta_r + \\beta_c \\right )    \\vec{u }     \\cdot    \\vec{j } .",
    "\\label{eqn-1storderd - statframe - divergence}\\end{aligned}\\ ] ]",
    "we have introduced generalized forms of the directional field variables first envisaged by fleck@xcite ] .",
    "we have demonstrated that they are associated with energy fluxes in the forward and backward directions .",
    "they provide the ideal basis for the standard `` forward - only '' pulse propagation model , both improving our insight into pulse propagation , and allowing the backward - propagating component to be efficiently discarded if desired . by developing the theory in frequency space ,",
    "we have shown how the dispersive properties of the propagation medium can be incorporated .",
    "we have derived first - order wave equations for @xmath0 that are equivalent to maxwell s equations .",
    "if dispersion is included carefully , the equations decouple and we can get a single equation for forward - only propagation , and hence achieve significant speed gains over direct maxwell s equation solvers for @xmath4 and @xmath5 ( such as pssd@xcite or fdtd@xcite ) . we have also presented a number of simulations demonstrating their use .",
    "since the @xmath0 variables are not restricted to use in first order wave equations , we have also presented an envelope theory and a second - order wave equation analogous to those regularly used in pulse propagation work .",
    "either of these equations can be used to extend the practical applications of @xmath0 variables into the long - pulse narrow - band regimes .",
    "further , @xmath0 can still be constructed from the @xmath4 and @xmath5 field obtained in traditional simulations , enabling their use for either diagnosis or analysis .",
    "j. a. fleck , phys .",
    "rev . b*1 * , 84 ( 1970 ) .",
    "note that we use an alternative notation to avoid possible confusion with the electric field variables @xmath4 ( since fleck used @xmath191 , not @xmath10 ) .",
    "m. kolesik , j.v .",
    "moloney , m. mlejnek phys .",
    "lett . * 89 * , 283902 ( 2002 ) .",
    "m. kolesik , j.v .",
    "moloney , phys .",
    "rev . e*70 * , 036604 ( 2004 ) .",
    "a. ferrando , m. zacars , p.f",
    ". de crdoba , d. binosi ,  .",
    "montero , phys .",
    "rev . e*71 * , 016601 ( 2005 ) .",
    "tyrrell , p. kinsler , g.h.c .",
    "new , j. mod . opt . * 52 * , 973 ( 2005 ) .",
    "yee , ieee trans .",
    "antennas propagat .",
    "ap-*14 * , 302 ( 1966 ) .",
    "joseph , a. taflove , ieee trans .",
    "antennas propag .",
    "* 45 * , 364 ( 1997 ) .",
    "a. lakhtakia , international journal of infrared and millimeter waves , * 15 * , 369 ( 1994 ) .",
    "p. hillion , j. phys .",
    "a * 28 * , 2647 ( 1995 ) .",
    "moses , siam j.appl.math . *",
    "21 * , 114 ( 1971 ) .",
    "t. brabec and f. krausz , phys .",
    "lett . * 78 * 3282 , ( 1997 ) .",
    "p. kinsler , g.h.c .",
    "new , phys .",
    ".  a * 67 * , 023813 ( 2003 ) ."
  ],
  "abstract_text": [
    "<S> we construct combined electric and magnetic field variables which independently represent energy flows in the forward and backward directions respectively , and use these to re - formulate maxwell s equations . </S>",
    "<S> these variables enable us to not only judge the effect and significance of backward - travelling field components , but also to discard them when appropriate . </S>",
    "<S> they thereby have the potential to simplify numerical simulations , leading to potential speed gains of up to 100% over standard fdtd or pssd simulations . </S>",
    "<S> we present results for various illustrative situations , including an example application to second harmonic generation in periodically poled lithium niobate . </S>",
    "<S> these field variables are also used to derive both envelope equations useful for narrow - band pulse propagation , and a second order wave equation . </S>",
    "<S> alternative definitions are also presented .    </S>",
    "<S> = 10000    _ published as phys . </S>",
    "<S> rev . a*72 * , 063807 ( 2005 ) . </S>",
    "<S> a more detailed derivation of the fields and equations herein can be found at http://arxiv.org/abs/physics/0611216_ </S>"
  ]
}