{
  "article_text": [
    "the collider detector at fermilab ( cdf ) is a general purpose detector at the fermilab tevatron @xcite .",
    "the tevatron , the world largest @xmath0 collider with the c.m.s . energy of about 2  tev , has undergone a major upgrade for run ii that started april 2001 . the cdf detector has been equipped with a new tracking system , a tof system , a new plug calorimeter and luminosity counters . the muon system coverage has been extended .",
    "the cdf trigger and daq systems have been upgraded to accommodate 10@xmath1 increase in luminosity .",
    "the experimental program at cdf includes search for higgs boson , precision measurements of electroweak parameters , study of t - quark properties , qcd at large @xmath2 , heavy flavor physics and search for phenomena beyond standard model .    during the first years of run ii the cdf collaboration plans to record about 1  pb of data .",
    "this volume is more than 20 times the volume of the previous data recording , run i. the sheer volume of data and increased analysis activity due to collaboration growth and extended physics potential constitute serious challenges for a data handling system .",
    "all data is accessed multiple times during several years of active analysis . direct access storage devices ( dasd )",
    "are not affordable for this data volume .",
    "instead the data is archived to sequential media .",
    "any of the data can be retrieved onto dasd into available space on a modified least recently used ( lru ) basis .",
    "users access the data only from disk .",
    "the purpose of the dh system is to collect , organize , archive and then make available the data to user analysis job .",
    "the cdf run ii data handling strategy is essentially an evolution of the run i approach of successive filtering of events of interest from huge primary datasets produced at cdf production farm into smaller sub - samples relevant for individual analyses .",
    "the process of filtering of events and information stored per each event continues until the samples used to produce final physics results are obtained .",
    "these final samples could be small enough to be held on disk .",
    "cdf has adopted a hierarchical data organization with the dataset at the highest level and runsection at the lowest level of the structure .",
    "the dataset is the collection of events passing pre - defined set of level-3 paths ( primary and secondary datasets ) or other selection criteria relevant for particular physics analysis ( tertiary or derived datasets ) .",
    "level-3 path is defined as and of level-1 , level-2 and level-3 triggers .",
    "there are 50 pre - defined primary datasets at cdf . during the data taking events that belong to similar datasets",
    "are grouped into 8 streams .",
    "grouping of datasets into the streams is done in such a way that event overlap between the streams is minimized and the fraction of the stream in any dataset is not small .",
    "runsections are the time intervals of data taking for which integrated luminosity is calculated .",
    "typically , a runsection is defined every 30 seconds of data taking and contains on average 3,000 events .",
    "events are written to files of about 1  gb in size .",
    "no runsection is split between two files .",
    "groups of 10  gb or more worth of files form filesets to optimize tape i / o .    at the beginning of the run ii",
    "the cdf was writing data to partitioned ait-2 tapes , one fileset per partition .",
    "the individual data unit existing in the data handling system was therefore a fileset and not a file .",
    "users access data by datasets following the datasets @xmath3 filesets @xmath3 files @xmath3 runsections hierarchy . at the same time data handling access to data followed tape@xmath3filesets@xmath3files hierarchy .",
    "these two interlacing access patterns are shown in figure  [ data - access ] .      during data taking",
    ", the consumer - server / logger ( csl ) @xcite receives events from the level-3 pc farm at 20 mb / sec ( 75 hz@xmath1250 kb / event ) and logs files to dual ported scsi raid array disks at 20 mb / sec .",
    "these functions are performed on b0dau32 , an sgi 2200 server dedicated to the csl and located in cdf assembly building . a fileset - tape daemon running on another identical sgi 2200 , fcdfsgi1 , located in feynman computer center , forms files into filesets and logs them to mass storage system ( mss ) using the enstore @xcite interface layer that provides access to network - attached tape drives in the stk robotic tape library .",
    "once the data are on tape and the calibrations are defined , the raw data are fed to the cdf production farm @xcite where they are reconstructed .",
    "after production , the data are split into the 50 primary datasets .",
    "these datasets are written to tapes .",
    "the average production farm i / o throughput is about 30 mb / sec .",
    "the primary datasets are split into secondary datasets of interest for the physics analysis groups .",
    "users create tertiary datasets or n - tuples using secondary datasets as inputs .",
    "figure  [ data - size ] shows the amount of raw and produced data logged to tape at cdf since the beginning of run ii .",
    "some tapes containing older produced data were recycled to free up media .",
    "some characteristics of the cdf data and analysis software :",
    "* root i / o as persistency mechanism * typical raw event size is 250  kb * typical produced event size is 350  kb , in dst format ( raw banks are kept ) * pad format or mini - dst format , ultimate event size 50 - 100  kb * n - tuple format 10 - 30 kb / event * typical dataset size is @xmath4 events * typical analysis job runs at 5 hz on a 1  ghz piii corresponding to few mb / sec input rate * analysis jobs are cpu rather than network or i / o bound over fast ethernet",
    "the dh system at cdf has several distinct components ( figure  [ dh ] ) each of which has a well - defined interface .",
    "user specifies a request for data by dataset or other selection criteria based on meta - data information associated with the dataset , fileset or file via talk - to to a special dhinput module .",
    "the dhinput module translates the request into a list of filesets using information available in the data file catalog via db access layer provided by datafiledb package .",
    "the list of filesets is passed to a client api of the disk cache manager .",
    "the client software contacts the disk cache manager server process to query the status of filesets in the list .",
    "the filesets available in the disk cache are processed while separate staging jobs are launched to copy missing filesets from mss to disk .",
    "raw and produced data are put to tape by data logging daemons that currently write directly into mss using enstore interface .",
    "an object oriented analysis framework , ac++ @xcite jointly developed by babar and cdf provides hooks to plug in high - level user interfaces to data handling system  dhinput / dhoutput modules .",
    "the low - level api , the means to open , read and define internal structure of the data files is provided by the event data model @xcite .",
    "the dhinput provides fast navigation through input data made possible by the direct access root format of the cdf data .",
    "the dhoutput module writes out ansi named files furnished with begin run record , empty runsections records , necessary for luminosity calculations , and makes entries in the data file catalog .",
    "the data file catalog is a relational database that contains information about cdf datasets @xcite .",
    "it also contains physics - related bookkeeping information such as data quality , triggers and filters used , average and integrated luminosity , dynamic pre - scales values , etc .",
    "the data access granularity of the dfc is a runsection , i.e. a group of events rather than individual events .",
    "the dfc table structure reflects cdf data hierarchy depicted in figure  [ data - access ]",
    ".    the dfc tables store information about physical entities existing in the data handling system .",
    "such entities are dataset , tape , fileset , file and runsection .",
    "each entity has a corresponding primary table .",
    "the primary dfc tables are shown in table i    .primary data file catalog tables [ cols=\"<,<\",options=\"header \" , ]     [ tab : secondary ]    data file catalog defines the following primary relationships among the entities :    * a dataset has zero or more parent datasets * a dataset contains zero or more filesets * a dataset is contained on one or more tapes * tape pool may have zero or more tapes * a tape has one parent tape pool * a fileset has one parent dataset * a fileset contains one or more files * a file has one parent fileset * a file has one parent dataset * a file contains one or more runsection range * a file contains zero or more average prescales * a runsection contains zero or more dynamic prescales ( livetimes )    there exists an oracle implementation of the dfc tables used at fermilab to keep track of centrally produced as well as secondary user data .",
    "there is also msql implementation of the dfc that can be set up and run at remote institutions if for some reasons either use of dfc located at fermilab via network or installation and maintenance of oracle dfc replica are not possible .",
    "oracle and msql implementations are identical with the exception of latter not having integrity constraints and database triggers .",
    "integrity constraints and the functionality of triggers are embedded in the datafiledb library , a c++ db access api .",
    "recently the support for mysql implementation of the dfc has been added .",
    "the information stored in the dfc is presented to the data processing algorithms as transient objects which are retrieved using compound keys .",
    "the management of mapping of persistent data to transient objects is provided by the common database interface manager layer@xcite .",
    "this layer exists between the algorithm code and the code which reads directly from database tables . at the persistent storage end",
    ", it allows multiple back - end mapping classes to be plugged in and identified as data sources by character string at the run time . at the user end , it provides a put / get / update / delete interface on top of a transient class for storage / retrieval / change / removal of objects of this class using a key .",
    "the mapping object creates a transient object from the data stored in the dfc using the key .",
    "objects are cached by keys to prevent multiple database accesses from different algorithms for the same data .",
    "the dbmanager@xcite has two apis .",
    "the back - end persistent - to - transient mapping api , _ iopackage _ , is an abstract base class . in order to create new persistent - to - transient mapping class , or mapper class",
    ", one has to derive this class from _",
    "iopackage_. the user code sees the front - end api as template based .",
    "transient classes are used as the template instantiation parameters of the ` manager < object , key > ` class .",
    "the ` manager < object , key > ` class has methods such as put , get , update and remove to manipulate transient objects .",
    "the datafiledb @xcite package is built on the top of dbmanager and provides all the code needed to manipulate the dfc from a c++ program .",
    "it contains an implementation of the transient object classes , their associated keys and mapper classes .",
    "there are three mapper classes for each transient class corresponding to the three supported underlying relational database implementations ",
    "oracle ( using oci and otl libraries ) , msql and mysql .",
    "information from any supported database implementation can be manipulated without code changes , the source database can be selected at the run time .",
    "there are six classes representing rows of the dfc tables .",
    "each of these classes , so called row - classes , has an interface that allows users to view the information held inside an object of the class .",
    "many of these objects contain the data collected from the secondary dfc tables like parent datasets or runsection ranges .",
    "each transient object class has an associated key object class .",
    "the key object defines the where clause of the sql statement emitted by the mapper back - end implementation for the corresponding transient object .",
    "some of the row - objects have hierarchical views associated with them .",
    "the hierarchical views make calls down to dbmanager classes which perform connections to the database to do put , get , update or remove queries .",
    "e.g. , the code to retrieve all the files belonging to the dataset , identified by dataset name identifier aphysr looks like this :    .... //",
    "make connection to database identified   // by key \" prd_dfc \"          dfcfilecatalognode fc(\"dfc_prd \" ) ; //",
    "key class associated with file          dfcfilekey key ;          key.setdatasetnameid(\"aphysr \" ) ; //",
    "typedef std::vector < dfcfile > dfcfiles ; //",
    "typedef handle < dfcfiles > dfcfiles_var ;          dfcfiles_var files ;           fc.findfiles(key,files ) ; ....    the ` findfiles ` method of hierarchical view ` dfcfilecatalognode ` instantiates manager provided by dbmanager api with appropriate template parameters and arguments :    ....          dfcfiles_mgr m(\"dfc_prd\",\"dfcfiles \" ) ;          m.get(key,files ) ; ....    the front - end api is in ` dfcfiles_mgr ` class which is ` typedef   manager < dfcfiles , dfcfilekey > ` .",
    "the argument `` dfc_prd '' identifies the entire set of classes such as otl or msql or mysql mappers to be used to perform data base operation .",
    "an ascii text configuration file associates this string with the real database instance by including user , password , node name and class set name .",
    "the second argument instructs _ iopackage _ factory which particular mapper sub - class to instantiate .",
    "the object returned from the api is managed by a smart pointer ( handle < dfcfiles > ) .",
    "one of the central components of the cdf dh system is the disk inventory manager ( dim ) @xcite .",
    "it acts as read / write cache in front of the mss .",
    "the primary function of the dim is to cache data from the tape library onto a large collection of shared disks , secondary functions include automating the writing of new filesets onto tape , handling quotas for space and reservation management .",
    "the unit of space management is a fileset .",
    "dim keeps track of fileset status and has no knowledge of datasets as such .",
    "this serves to decouple the manager from database system .",
    "the dim is a client - server application with the communication between client and server via tcp / ip sockets .",
    "the server daemon is a multi - threaded program written to the posix c api using the worker pool model .",
    "for better scalability it uses a dynamic threading system , starting more threads under load and eliminating them when the load is reduced .",
    "the caching mechanism scores each fileset thet is not being reserved by users , just arrived or marked static based on reservations , time on disk and time since last usage . it deletes the fileset with the lowest score to make room for newly requested fileset , an lru algorithm .    the initial design of the central analysis system was based on the idea of tight storage and cpu connection .",
    "the large computing machine , a sgi origin 2000 with 128 300 mhz mips r12000 cpus , fcdfsgi2 , has been purchased and commissioned at the end of 1999 .",
    "a 12 tb disk cache pool of fiber channel scsi disk raid arrays is managed by the dim .",
    "the dim has originally been designed to work with attached disks on a large smp .",
    "the smp - centric model was first envisioned for run ii in 1998 . in later revisions",
    "the model s inflexibility , cost / performance considerations and single source upgrades were acknowledged and an extension towards incorporating commodity pcs and network distributed ide raid based disk storage was adopted    while network nature of dim allows it to handle network - attached storage , it has never been developed to fully support distributed caching .",
    "the cdf dh group evaluated an effort required to support dim in distributed environment and decided in favor of adopting different cache layer ",
    "dcache @xcite .",
    "dcache is a front - end disk cache for the large mss .",
    "originally conceived at desy , dcache has been jointly developed by desy and fermilab computing division ( cd ) for several years now .",
    "dcache uses network mounted disks to implement distributed data caches with user authentication .",
    "dcache provides file - based staging , making concept of fileset obsolete .",
    "a client , requesting a file , contacts a dcache admin node and is authenticated . if the file is in any of the cache pools managed by the dcache admin server , the client is redirected to the pool containing the file .",
    "if the file is not on any of the pools is is staged from tape to pool with available disk space and client is redirected to that pool .",
    "cdf has started run ii with a mss based on an aml-2 robotic tape library with cheap commodity ait-2 tape drives , sony - cdx500c , directly attached to main cdf data logger and central analysis smp , fcdfsgi2 .",
    "interface to mss was written using cdf - specific software .",
    "the choice of tape technology turned out to be more difficult than anticipated .    in may 2002 ,",
    "this tape system has been replaced with a enstore mass storage system with dual stk powderhorn 9310 robotic libraries equipped with 10 network - attached data center quality tape drives stk t9940a , 10  mb / sec read / write rate each @xcite .",
    "cdf enstore mss is called cdfen .",
    "all existing data were copied from ait-2 tapes to stk cartridges using the dh system running on the central analysis smp .",
    "this year , stk t9940a are being replaced with stk t9940b tape drives .",
    "the total i / o rate of cdf tape system system becomes 10x30  mb / sec=300  mb / sec .",
    "this bandwidth is shared between raw data logging , production farms and a 600 cpu central analysis farm ( caf ) @xcite for user analysis and legacy smp system .",
    "total data capacity is about 2 pb with 200 gb / tape cartridges . the tape system i / o rate and volume capacity are sufficient for the run iia luminosity goals .    data delivery became stable and reliable .",
    "figure  [ space ] illustrates increased read rate from enstore on legacy dh system .",
    "having achieved operational stability and reliable data delivery at fermilab , the cdf data handling group is looking forward to further development of the data handling system towards providing data flow to world - wide distributed computing resources .",
    "the cdf has evaluated the d0 data handling system based on sequential access through meta data ( sam ) system @xcite .",
    "sam is a complete data handling system that provides :    * meta - data file catalog , * clustering the data onto tertiary storage in the manner corresponding to access pattern * caching frequently accessed data on disk or tape , * organization of data request to minimize tape mounts * a resource manager that estimates resources required for the file requests before they are submitted and , with this information , makes administrative decisions concerning data delivery priorities    the sam infrastructure consists of a central data repository and a number of sam - stations .",
    "a station consists of one or more computer nodes that share a data cache managed by one or more station master nodes and accessible to consumer / producer nodes .",
    "users submit jobs to computer in a stations specifying the project their job will access .",
    "using the file catalog meta - data , sam translates the request into the list of files .",
    "if the requested files are available in the station cache they are sent to the requesting job . if some files are missing in the local cache , a station , following a set of rules will request the data from central repository or from neighboring stations .    by design ,",
    "the sam is inherently a scalable , flexible data handling solution specifically tailored to accommodate distributed computing resources .",
    "this realization and the initial success of integrating sam into cdf software @xcite resulted in creation of cdf sam project in the framework of joint d0/cdf / cd project .",
    "the outcome of this project was a modified file catalog sam schema that would allow to absorb the cdf data file catalog into sam and interfacing of sam data access layer with dcache for reading and writing data .",
    "the cdf collaboration has changed significantly its computing analysis system towards using globally distributed commodity cpu resources and network accessible ide raid arrays for disk caching .      *",
    "the _ enstore _ generic interface to tape system that utilizes _ data center quality _ drives allowed to achieve stable and robust operations in a very short period of time * the _ network disk caching _ management layer , dcache , runs successfully on commodity linux file servers managing about 100 tb of distributed cache pools achieving unprecedented tb / hour data delivery rate to analysis jobs running on caf . *",
    "an adaptation of the sam as the first step towards grid for cdf that ultimately allows off - site users to fully utilize their computing resources      the cdf detector has achieved stable data taking .",
    "stable detector operation complemented by a reliable data handling system will result in high quality and timely physics results . the first cdf run ii paper is in print , cdf is back in business .    in conclusion",
    "the author wishes to thank members of cdf data handling group and fermilab computing division for their significant contribution to design , implementation and operational support of the cdf data handling system ."
  ],
  "abstract_text": [
    "<S> the collider detector at fermilab ( cdf ) records proton - antiproton collisions at center of mass energy of 2.0 tev at the tevatron collider . a new collider run , run ii , of the tevatron started in april 2001 . </S>",
    "<S> increased luminosity will result in about 1  pb of data recorded on tapes in the next two years . </S>",
    "<S> currently the cdf experiment has about 260 tb of data stored on tapes . </S>",
    "<S> this amount includes raw and reconstructed data and their derivatives . </S>",
    "<S> the data storage and retrieval are managed by the cdf data handling ( dh ) system . </S>",
    "<S> this system has been designed to accommodate the increased demands of the run ii environment and has proven robust and reliable in providing reliable flow of data from the detector to the end user . </S>",
    "<S> this paper gives an overview of the cdf run ii data handling system which has evolved significantly over the course of this year . </S>",
    "<S> an outline of the future direction of the system is given . </S>"
  ]
}