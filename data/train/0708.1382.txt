{
  "article_text": [
    "in hierarchical models of structure formation , such as @xmath0cdm , the formation of a dark matter ( dm ) halo through accretion and repeated mergers can be described by a merger tree @xcite .",
    "the merger trees , which list the progenitors of a given halo at a series of redshifts and describe the sequence in which they merge together , contain essentially all the information one needs about the dm when building models of the other processes involved in galaxy formation .",
    "thus , the merger trees , whether extracted from n - body simulations such as the millennium simulation @xcite or generated by monte - carlo ( mc ) algorithms ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , provide the framework within which one can model the additional astrophysical processes of galaxy formation @xcite .",
    "the statistical properties of monte - carlo merger trees based on the approximate extended press - schechter ( eps ) theory @xcite are not in perfect agreement with those built from high resolution , highly non - linear n - body simulations ( e.g. * ? ? ?",
    "we have found that when the same semi - analytic galaxy formation model is run first with mc trees and then with n - body trees there can be significant differences in the properties of their resulting galaxy populations . in some ways",
    "these differences are minor as small changes in the uncertain parameters of the star formation and feedback prescriptions can often bring them back into alignment .",
    "however , it would be far better if mc and n - body merger trees were in much better agreement .",
    "for instance , this would allow galaxy formation models to be run first on mc trees and parameters including cosmological parameters tuned to match observed galaxy properties in advance of running an expensive n - body simulation which will furnish the positional information needed to make galaxy clustering predictions . additionally ,",
    "as n - body simulations always have poorer mass resolution than can be obtained with mc merger trees , one would like to be able to use mc trees of varying resolution to assess the impact of the limited resolution of the n - body simulation .",
    "this can be hard to achieve when the two sets of trees differ systematically .",
    "in this paper we present a modification to the mc merger tree algorithm of @xcite that we tune to be in accurate agreement with the statistical properties of the millennium simulation merger trees that were presented in @xcite . in section  [ sec : mc ]",
    "we describe both the original eps mc algorithm as implemented in @xcite and our modification .",
    "section  [ sec : compare ] compares the results of our modified algorithm with the original and with the statistics of merger trees from the millennium simulation .",
    "we briefly discuss relationship of our algorithm to other models in section  [ sec : disc ] and conclude in section  [ sec : conc ] .",
    "in the following sections , we briefly review the monte - carlo algorithm implemented in the galform semi - analytic code @xcite and then describe how we modify it to achieve more accurate agreement with simulation data .",
    "the merger tree algorithm employed in the galform semi - analytic model uses as its starting point the conditional mass function @xmath2^{3/2 } } } \\ , \\times } & & \\nonumber \\\\ & & \\displaystyle { \\exp\\left [ - \\frac{1}{2 } \\frac{(\\delta_1-\\delta_2)^2}{(\\sigma_1 ^ 2-\\sigma_2 ^ 2)}\\right ] \\left\\vert \\frac{d\\ln\\sigma}{d\\ln m_1 } \\right\\vert \\ , d\\ln m_1 } , \\label{eq : cmff}\\end{aligned}\\ ] ] given by extended press - schechter theory @xcite . here",
    "@xmath3 represents the fraction of mass from halos of mass @xmath4 at redshift @xmath5 that is contained in progenitor halos of mass @xmath6 at an earlier redshift @xmath7 .",
    "the linear density thresholds for collapse at these two redshifts are @xmath8 and  @xmath9 ( e.g. * ? ? ?",
    "the rms linear density fluctuation extrapolated to @xmath10 in spheres containing mass @xmath11 is denoted @xmath12 with @xmath13 and @xmath14 . taking the limit of @xmath3",
    "as @xmath15 one finds , @xmath16^{3/2}}\\ \\frac{d\\delta_1}{dz_1 }   \\big\\vert\\frac{d \\ln \\sigma_1}{d\\ln m_1}\\big\\vert\\ d \\ln m_1 \\ dz_1 ,   \\label{eq : lin}\\end{aligned}\\ ] ] which implies that the mean number of halos of mass @xmath6 into which a halo of mass @xmath4 splits when one takes a step @xmath17 up in redshift is @xmath18 then , by specifying a required mass resolution , @xmath19 , for the algorithm on can integrate to determine @xmath20 which is the mean number of progenitors with masses @xmath6 in the interval @xmath21 and @xmath22 which is the fraction of mass of the final object in progenitors below this resolution limit .",
    "note that both these quantities are proportional to the redshift step , @xmath17 , by virtue of equation  ( [ eq : dnp ] )    the galform merger tree algorithm then proceeds as follows .",
    "firstly , choose a mass and redshift , @xmath23 , for the final halo in the merger tree . then , pick a redshift step , @xmath17 , such that @xmath24 , to ensure that the halo is unlikely to have more than two progenitors at the earlier redshift @xmath25 . next ,",
    "generate a uniform random number , @xmath26 , in the interval @xmath27 to @xmath28 .",
    "if @xmath29 , then the main halo is not split at this step .",
    "we simply reduce its mass to @xmath30 to account for mass accreted in unresolved halos .",
    "alternatively if @xmath31 , then we generate a random value of @xmath6 in the range @xmath32 , consistent with the distribution given by equation  ( [ eq : dnp ] ) , to produce two new halos with masses @xmath6 and @xmath33 .",
    "the same process is repeated on each new halo at successive redshift steps to build up a complete tree .",
    "more details are given in appendix  a.       the binary merger algorithm described above fully respects a natural symmetry that whenever one fragment has mass @xmath6 the other must have mass @xmath34 ( at least in the limit of @xmath35 ) .",
    "this means that it is not consistent with eps theory as equation  ( [ eq : dnp ] ) does not satisfy this symmetry of remaining unchanged when @xmath36 @xcite . to force the required symmetry the algorithm only uses equation  ( [ eq : dnp ] ) for @xmath37 and ignores its predictions for @xmath38 .",
    "the algorithm is also unsatisfactory because the eps conditional mass functions , and also the original press - schechter mass function , do not accurately match what is found in n - body simulations @xcite .",
    "however , many statistical properties of the merger trees produced by the above algorithm have trends with mass and redshift that agrees well with those of merger trees constructed from high resolution n - body simulations , but with increasing redshift they systematically underestimate the mass of the most massive progenitors @xcite .",
    "( in practice , the problem is ameliorated in galform by starting the merger tree construction at higher redshift . ) here , our aim is to reduce these systematic differences . given the simplicity and zeroth order success of the original galform algorithm , it seems reasonable to try modifying it by perturbing the basic function that drives the algorithm .",
    "namely we consider replacing the function defined in equation  ( [ eq : dnp ] ) by making the substitution @xmath39 here @xmath40 is the `` perturbing '' function which we expect to be of order unity for most of the range of interest .",
    "the choice that the function @xmath41 should only depend on the ratios @xmath42 and @xmath43 is motivated by the desire that the algorithm should preserve self - similarity if used in a flat @xmath44 cosmology with scale free initial conditions ( e.g. see * ? ? ? * ) .",
    "the dependence on @xmath43 allows the halo splitting rate to be modified as a function of @xmath45 , where the characteristic non - linear mass , @xmath46 , is defined by @xmath47 , while the dependence on @xmath42 allows the mass distribution of the resulting fragments to be modified .",
    "restricting the dependence of the function to only these parameters is necessary to preserve self - similarity , but on its own does not guarantee self - similarity .",
    "the additional unwanted freedom we hope to remove by fitting to the statistical properties of the millennium simulation merger trees , as presented in @xcite . note that since the merger tree algorithm described above only makes use of equation  ( [ eq : dnp_mod ] ) for progenitor masses @xmath37 it is only the behaviour of @xmath40 for @xmath37 ( @xmath48 ) that is constrained by comparison to the millennium simulation merger trees .",
    "consequently the predictions of equation  ( [ eq : dnp_mod ] ) for @xmath38 are of no relevance .",
    "[ sec : cmf ]     -0.8 cm    to simplify the problem still further we make the assumption that @xmath49 which can be considered as a first order taylor series approximation for @xmath50 in terms of @xmath51 and @xmath52 .",
    "this functional form is particularly convenient .",
    "the two terms @xmath53 and @xmath54 have no dependence on @xmath6 and so just enter the integrals in equations ( [ eq : p ] ) and  ( [ eq : f ] ) as multiplicative constants .",
    "the term @xmath55 alters the distribution @xmath56 and the integrands in both ( [ eq : p ] ) and  ( [ eq : f ] ) , but has simple analytic properties that allow a very fast implementation of the splitting algorithm ( see appendix  [ appendix ] ) .",
    "the millennium simulation ( ms , * ? ? ? * ) is , to date , the largest n - body simulation of a cosmologically representative volume .",
    "it uses @xmath57 particles in a comoving cube of side @xmath58  mpc to follow the non - linear gravitational evolution of a gaussian random density field drawn from a power spectrum consistent with cosmological constraints from 2dfgrs @xcite and the first year wmap data @xcite .",
    "the cosmological density parameters are @xmath59 , @xmath60 and @xmath61 , the hubble parameter @xmath62  km  s@xmath63  mpc@xmath64 and the linear amplitude of the density fluctuations in spheres of radius @xmath65  mpc is @xmath66 . at each of over @xmath67 output times",
    "a catalogue of friends - of - friends @xcite groups was constructed and the descendant of each group found at the subsequent timestep .",
    "details of the construction of these merger trees and and their statistical properties can be found in @xcite .",
    "below we compare a variety of the statistics they estimated with the results of the original @xcite galform mc algorithm and our new modified algorithm .      in fig .",
    "[ fig : cmf ] we compare the conditional mass functions of the ms merger trees with those of the mc algorithms . here for halos of various masses @xmath4 at redshift @xmath68 we find what fraction of their mass is in progenitor halos of mass @xmath6 at various earlier redshifts @xmath7 .",
    "the histograms show the results of the ms while the solid curves show an analytic fit described in @xcite .",
    "the results of the original galform algorithm are shown by the dotted curves . as has been noted by @xcite",
    "these conditional mass functions evolve more rapidly than those of the simulation .",
    "thus , the `` galform 2000 '' algorithm strongly underpredicts the number of high mass progenitors at high redshift . that the eps theory gives predictions that evolve more rapidly with redshift than is found in n - body simulations",
    "has been noted previously ( e.g * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "@xcite have shown that average halo formation times agree better with the elliptical collapse model of @xcite than with the spherical collapse eps formalism .",
    "furthermore , @xcite find that scaling the time variable in eps theory by the factor @xmath69 that comes from fitting the elliptical collapse model to n - body data results in formation time predictions that better match the n - body data for a wide range of final masses and redshifts . by reference to equation  ( [ eq : dnp ] )",
    "it can be seen that our factor @xmath40 of equation  ( [ eq : dnp_mod ] ) can be viewed as a modification to the timestep @xmath17 .",
    "thus , the elliptical collapse modelling of @xcite suggests that we should find @xmath70 .",
    "in fact , we expect a somewhat lower value as the monte carlo trees of the original galform algorithm evolve even more rapdily than the analytic predictions of the eps formalism @xcite .    to find the best fit parameters we have minimised the rms difference @xmath71 between ms data and the results of the mc algorithm over all twelve panels in fig .",
    "[ fig : cmf ] . with the exception of the lowest two mass bins plotted in each panel , which were discarded as they are influenced by the mass resolution of the ms ,",
    "equal weight was given to each bin .",
    "initially we kept @xmath72 fixed and allowed only @xmath53 to vary .",
    "for @xmath73 , the original galform algorithm , the rms difference @xmath74 .",
    "the best fitting value of @xmath53 is @xmath75 , as anticipated , somewhat smaller than the factor @xmath76 from @xcite , and this reduces the rms difference significantly to @xmath77 .",
    "however , this is a compromise and the data from the different panels of fig .",
    "[ fig : cmf ] prefer different values of @xmath53 .",
    "this can be accommodated by allowing @xmath78 and @xmath79 to vary . as @xmath43 is an increasing function of the final mass @xmath4 , a positive @xmath79 would give a relatively higher merger rate for high mass , @xmath80 , halos ( where the character mass , @xmath46 , has the usual definition of @xmath47 ) .",
    "choosing @xmath81 skews the shape of the progenitor mass functions by boosting the ratio of low mass to high mass progenitors . since @xmath48 , setting @xmath81 boosts the overall merger rate and so needs to be compensated for by a the lower value of @xmath53 . allowing all three parameters to vary , consistently good fits",
    "are found with @xmath82 , @xmath83 and @xmath84 with a reduced rms deviation from the ms data of @xmath85 . over most of the range over which it is employed",
    "@xmath86 remains less than but of order unity .",
    "the conditional mass functions produced by this new set of trees are shown by the dashed lines in fig .",
    "[ fig : cmf ] .",
    "we see that this minor change to the merger tree algorithm has resulted in merger trees that are in good agreement with the n - body simulation results over a wide range of masses and redshifts .",
    "the only mass bins where the mc and ms conditional mass functions are not in good agreement are the bins with @xmath87 . in a truly hierarchical model such as is produced by our algorithm @xmath6 can never be greater than @xmath4 . in the ms data @xcite noted that @xmath87 happens occasionally for low mass halos due to the temporary , premature linking of fof groups .     -1 cm      the parameters of our new mc merger tree algorithm were tuned to produce good agreement with the conditional mass functions plotted in fig .",
    "[ fig : cmf ] and so the level of agreement is perhaps not surprising . however we can go further and test the success of the algorithm by testing other statistical properties of the merger trees .",
    "fig  [ fig:1st2nd ] plots the mass functions for the first and second most massive progenitors for the same selection of redshifts and final masses as in fig  [ fig : cmf ] .",
    "this is an interesting test of the merger trees as often in galaxy formation applications it is the most massive progenitors and mergers between them that are most important in determining the properties of the galaxies hosted by the halos .",
    "it also tests an aspect of the merger trees that can not be predicted by eps theory alone as it involves how often one has a progenitor of a given mass and not just the mean number of such progenitors .    as noted in @xcite the mass functions for the first and second most massive progenitors given by the original galform algorithm do a good job of matching the shape and relative positions of the two distributions , but",
    "systematically underestimate both masses with increasing redshift .",
    "this is completely remedied in the new algorithm which matches the positions and shapes of the n - body distributions extremely accurately .",
    "another important aspect of the merger trees is the occurrence of major mergers . in galaxy formation models major mergers between galaxies , which occur after halo mergers ,",
    "are often deemed to be responsible for initiating bursts of star formation and for converting disc galaxies to spheroidal systems .",
    "thus it is interesting to see what level of agreement our new algorithm has with estimates from the ms .",
    "[ fig : majmerg ] compares the redshift distribution of the most recent major merger for halos of various final masses . here",
    "a major merger has been defined as a merger between two halos where the smaller is at least fraction @xmath88 of the mass of the larger . at each redshift",
    "we find the most massive progenitor of the final halo and record the lowest redshift at which one of these progenitors is undergoing a major merger .",
    "it was found in @xcite that the original galform algorithm , shown by the dotted line in fig .",
    "[ fig : majmerg ] , significantly overestimated the number of recent major mergers .",
    "[ fig : majmerg ] shows that this shortcoming is very largely overcome by our new algorithm .",
    "the redshift distributions of the most recent major mergers match accurately the overall shape of those from the ms including their dependence on final halo mass .    .",
    "here a major merger is defined as a merger of the most massive progenitor of the final halo with a second halo whose mass is at least @xmath88 times that of the main progenitor .",
    "the histogram shows the n - body results and the dotted and dashed lines show the results from the original galform and new monte - carlo algorithm respectively .",
    ", width=321 ]    .",
    "this is compared to mass functions at redshifts @xmath89,@xmath28,@xmath90 and @xmath91 determined by generating grids of merger trees starting at @xmath10 and counting their progenitors at these higher redshifts .",
    "the top panel shows the results for the original galform merger trees and the bottom panel the results for our new merger trees .",
    ", width=321 ]      the above comparisons to the results of the ms test the mass range of the merger trees that is most important for galaxy formation applications , but it is also interesting to probe whether our new algorithm remains plausible for much larger ranges in mass .",
    "@xcite ( see also * ? ? ?",
    "* ) have shown that for a wide range of initial conditions and redshifts that the halo mass function has a universal form . a good analytic match to this universal form for the fraction of mass in halos of mass @xmath11",
    "is provided by the @xcite mass function @xmath92 where @xmath93 \\nu \\exp(-a \\nu^2/2 ) \\label{eq : st}\\ ] ] with @xmath94 , @xmath95 , @xmath96 and the mass dependent variable @xmath97 .",
    "taking this as a good description of the mass distribution of halos at redshift @xmath10 one can generate a grid of merger trees rooted at @xmath10 , weight them by their redshift @xmath10 abundance and compute the overall abundance of progenitor halos at any earlier redshift .",
    "if the merger the tree algorithm is in good agreement with n - body simulations then these @xmath98 mass functions should be in good agreement with the sheth - tormen mass function evaluated at that redshift .",
    "[ fig : tmf ] compares the sheth - tormen mass function with those determined with both the original galform and new merger trees . in the top panel one",
    "sees that the high mass exponential cut off to the mass function systematically moves to lower @xmath99 at higher redshift .",
    "in other words , as we saw with the conditional mass functions in fig .",
    "[ fig : cmf ] , the characteristic mass evolves too rapidly in these trees .",
    "in contrast in the lower panel we see that with our new trees this systematic error is greatly reduced and the abundance of high mass halos matches the sheth - tormen prediction quite accurately over a wide range of redshift .",
    "note that for each merger tree mass function the turnover at low masses ( low @xmath99 ) is due to the specified mass resolution of the trees . at higher",
    "redshift a fixed mass implies higher @xmath100 and so the mass resolution causes deviations at higher and higher @xmath99 .",
    "it is perhaps surprising that an algorithm motivated by eps theory , which is only a function of the smoothed linear theory overdensity at a point , is able to accurately describe the complete merger histories of dark matter haloes in a fully non - linear n - body simulation . the eps theory , as derived by @xcite , makes the following series of assumptions none of which can rigorously be true .",
    "it assumes that virialized halos form when the linear theory overdensity equals the threshold for collapse given by the pure spherical collapse model ; the linear overdensity at a given point in space is assumed to vary with the smoothing scale as an uncorrelated ( brownian ) random walk ( the sharp @xmath101-space filtering approximation ) ; when assigning mass points to halos of mass @xmath11 no condition is set to require that these mass points should lie in spatially localised regions capable of forming halos of that mass .",
    "one might have thought that a more natural starting point for developing an accurate merger tree algorithm would have been the ellipsoidal collapse model of @xcite as its mass function much more accurately matches that of n - body simulations ( although a free parameter , @xmath102 in @xcite and @xmath102 in @xcite ] , is adjusted to achieve this fit ) .",
    "however , it is not easy to work with this model as there is no simple analytic expression for the conditional mass function for small timesteps .",
    "furthermore , the results of this more complicated model can often be approximated by minor modifications of the formulae that are derived using the eps formalism .",
    "for example , @xcite have shown the inserting a factor of @xmath103 into the eps formation time formula of @xcite results in a reasonable match to the predictions of the ellipsoidal collapse model .",
    "our algorithm was motivated by the eps formalism , but the modification we introduce in equation  ( [ eq : dnp_mod ] ) means that its predictions are no longer those of the eps formalism . if instead one were trying to come up with an algorithm based on the ellipsoidal collapse model , then the end result might well be very similar .",
    "in fact , as noted in section  [ sec : cmf ] , the @xmath103 factor advocated by @xcite is equivalent to our @xmath53 factor .",
    "the other assumptions of the eps theory , listed above , and not addressed in the ellipsoidal collapse model must also play a role in determining merger histories . by adopting the modification defined in equation  ( [ eq : dnp_mod ] ) and fitting directly to n - body simulation results ,",
    "our model is fitting the net effect of all the additional physics and not just that due to the shape of the density perturbation .",
    "after we completed this project @xcite presented an alternative algorithm to generate dark matter halo merger trees based on fitting log - normal distributions to progenitor mass functions expressed in scaled mass and time variables .",
    "their algorithm , which is of very comparable speed to ours , is also tuned to fit the conditional mass functions of merger trees extracted from the millennium simulation .",
    "there will be some differences in the results of the two algorithms because the millennium simulation merger trees used by @xcite are not the simple friends - of - friends merger trees we constructed for this project , but instead the `` dhalo '' merger trees that were constructed by the durham group and used in the semi - analytic galaxy formation model of @xcite .",
    "both sets of trees are based on the same catalogues of friends - of - friends groups , but the `` dhalo '' algorithm uses additional information concerning substructures identified using subfind @xcite .",
    "( there is some discussion of the additional criteria useful for galaxy formation calculations in @xcite . )",
    "we opted not to use these trees since a criterion that delays the time at which the merger is deemed to take place has the side effect of causing some halos to loose mass prior to the merger .",
    "this artificially increases the occurence of progenitor halos that are more massive than their descendents and so slightly distorts the conditional mass functions .",
    "we have presented a new monte - carlo algorithm to generate dark matter halo merger trees .",
    "the algorithm is a modification of the extended press - schechter algorithm described in @xcite .",
    "the change we have made to the algorithm was motivated empirically and tuned to match the conditional mass function of halos extracted from the millennium simulation ( ms , * ? ? ?",
    "we find that not only can we get a very accurate match to these conditional mass functions over a wide range of mass and redshift , but that the other statistical properties of the new trees match very well those from the millennium simulation .",
    "the improvement in accuracy over the algorithm previously used in the galform semi - analytic code @xcite is very significant and should make the new algorithm a very useful tool .    while our algorithm has been tuned to match the results of ms , which is a particular @xmath0cdm model , we would expect it to a significant improvement over eps based algorithms for quite a wide range of cdm - like initial conditions .",
    "the overly rapid evolution in the typical mass of progenitor halos was a generic problem with the old algorithm and the reduced merger rate of the new algorithm should be an improvement in all cases .",
    "we have made a fortran90 implementation of algorithm available at http://star-www.dur.ac.uk/@xmath1cole/merger_trees .",
    "we thank the referee , ravi sheth , for comments that improved the paper .",
    "we thank yu lu for finding an error in our code in time for us to remedy the code , correct the published version of the paper and make improvements to the appendix . the millennium simulation used in this paper",
    "was carried out as part of the programme of the virgo consortium on the regatta supercomputer of the computing centre of the max - planck - society in garching .",
    "data for the halo population in this simulation , as well as for the galaxies produced by several different galaxy formation models , are publically available at http://www.mpa-garching.mpg.de/millennium and under the `` downloads '' button at http://www.virgo.dur.ac.uk/new .",
    "this work was supported in part by the pparc rolling grant for extragalactic and cosmology research at durham .",
    "benson , a.  j. , kamionkowski , m. , hassani , s.  h.  2005 , mnras , 357 , 847    bond , j.  r. , cole , s. , efstathiou , g. , kaiser , n.  1991 , apj , 379 , 440    bower , r.  g.  1991 , mnras , 248 , 332    bower , r.  g. , benson , a.  j. , malbon , r. , helly , j.  c. , frenk , c.  s. , baugh , c.  m. , cole , s. , & lacey , c.  g.  2006 , mnras , 370 , 645    cole , s.  1991 , apj , 367 , 45    cole , s. , lacey , c.  g. , baugh , c.  m. , & frenk , c.  s.  2000 , mnras , 319 , 168    cole , s. , helly , j.c . ,",
    "frenk , c.s . ,",
    "parkinson , h. ,  2007 , mnras , accepted .",
    "davis , m. , efstathiou , g. , frenk , c.  s. , white , s.  d.  m.  1985 , apj , 292 , 371    efstathiou , g. , frenk , c.  s. , white , s.  d.  m. , davis , m.  1988 , mnras , 235 , 715    eke , v.  r. , cole , s. , frenk , c.  s.  1996 , mnras , 282 , 263    jenkins , a. , frenk , c.  s. , white , s.  d.  m. , colberg , j.  m. , cole , s. , evrard , a.  e. , couchman , h.  m.  p. , yoshida , n.  2001 , mnras , 321 , 372    kauffmann , g. , white , s.  d.  m.  1993 , mnras , 261 , 921    lacey , c. , cole , s.  1993 , mnras , 262 , 627    lacey , c. , cole , s.  1994 , mnras , 271 , 676    percival , w.  j. , et al .",
    "2001 , mnras , 327 , 1297    press , w.  h. , & schechter , p.  1974 , apj , 187 , 425    sheth , r.  k. , & lemson , g.  1999 , mnras , 305 , 946    sheth , r.  k. , mo , h.  j. , & tormen , g.  2001 , mnras , 323 , 1    sheth , r.  k. , tormen , g.  2002 , mnras , 329 , 61    somerville , r.  s. , & kolatt , t.  s.  1999 , mnras , 305 , 1    spergel , d.  n. , et al .",
    "2003 , apjs , 148 , 175    springel , v. , et al .",
    "2005 , nature , 435 , 629",
    "given a halo of mass @xmath4 at redshift @xmath23 , the task of the split algorithm is to take a small step , @xmath104 , to higher redshift determine the mass accreted in this interval in unresolved halos with masses less than @xmath19 and determine whether or not the halo undergoes a binary split . if the halo does split then it must determine the masses of the two fragments . in the description below we make use of the following notation .",
    "we denote minus logarithmic slope of the @xmath12 relation by @xmath105 and its values at masses @xmath4 , @xmath106 and @xmath107 by @xmath108 , @xmath109 and @xmath110 respectively .",
    "similarly we denote the values of @xmath12 at @xmath4 , @xmath106 , @xmath111 and @xmath6 by @xmath112 , @xmath113 , @xmath114 and @xmath115 respectively . with this notation",
    "the expression in equation  ( [ eq : dnp ] ) for number of fragments produced per unit interval of @xmath102 produced in a redshift step @xmath104 can be written as @xmath116 where @xmath117 @xmath118 @xmath119^{3/2 } } , \\ ] ] and @xmath120 .",
    "we have written the expression for @xmath121 in this form so that , as detailed below , we can choose the parameters @xmath122 , @xmath123 and @xmath124 such that @xmath125 for @xmath126 and @xmath127 is a simple power law .",
    "this results in several very useful properties .",
    "first , @xmath128 provides an upper limit on the expected number of resolved fragments split off the main halo in step @xmath104 .",
    "we use this to choose the step size by taking @xmath104 to be the minimum of @xmath129 and the value given by equation  ( [ eq : dz ] ) when @xmath130 ( by default , we take @xmath131 ) .",
    "the first constraint ensures that the exponent in equation  ( [ eq : cmff ] ) is small so that the equation  ( [ eq : lin ] ) is correct to first order and the second constraint ensures that multiple splittings in one timestep are negligible .    having determined @xmath104 , the next step is to evaluate @xmath132 from equation  ( [ eq : f ] ) to determine fraction of mass that is accreted in unresolved halos in this timestep .",
    "the expression defining @xmath132 can be simplified to the form @xmath133 where we have made the substitution @xmath134 and the integral @xmath135 with @xmath136 . since this integral has no dependence on @xmath4 , @xmath23 or @xmath12 it can be tabulated as a simple look - up table for any chosen value of the parameter @xmath78 . in the original galform algorithm it reduces to @xmath137 .",
    "the next step is to generate the first of three uniform random variables in the range @xmath27 to @xmath28 .",
    "if this first variable , @xmath138 , is greater than @xmath139 evaluated with the selected @xmath104 then no split occurs at this timestep and @xmath4 is just reduced to @xmath140 to account for the accreted mass . if @xmath141 we generate a second random variable @xmath142 and transform it using @xmath143 so that it is drawn from the power - law distribution @xmath144 in the range @xmath126 .",
    "finally we generate a third random variate @xmath145 and only accept @xmath102 if @xmath146 . in the case that @xmath102 is rejected we again simply reduce @xmath4 to @xmath140 , but if @xmath102 is accepted we generate two fragments with masses @xmath147 and @xmath148 .",
    "this rejection step ensures that @xmath102 is being drawn with the correct normalization from the probability distribution defined by equation  ( [ eq : dnq ] ) .    for this algorithm to work we require @xmath149 for @xmath126 .",
    "referring to equation  ( [ eq : r ] ) , in all cdm models , @xmath150 and @xmath151 and so the first term @xmath152 is necessarily less than one .",
    "also these conditions imply that the function @xmath153 is monotonically increasing and @xmath154 versus @xmath155 is concave upwards for @xmath156 .",
    "this means that @xmath153 is bounded from above by the power law @xmath157 chosen to satisfy @xmath158 for @xmath159 and @xmath160 .",
    "in other words with this choice of @xmath122 and @xmath123 the second term in equation  ( [ eq : r ] ) , @xmath161 , is less than or equal to one . finally if we choose @xmath162 then regardless of the sign of @xmath78 the last factor @xmath163 , is also less than or equal to one and so @xmath164 is always less than one as required .",
    "the merger tree produced by this algorithm has no directly imposed time / redshift resolution and comprises of only binary mergers .",
    "however , we typically rebin each merger tree onto a discrete grid of predefined redshift snapshots . with this coarser time resolution",
    "the mergers occurring between snapshots can involve three or even more halos ."
  ],
  "abstract_text": [
    "<S> we present a new monte - carlo algorithm to generate merger trees describing the formation history of dark matter halos . </S>",
    "<S> the algorithm is a modification of the algorithm of @xcite used in the galform semi - analytic galaxy formation model . as such , </S>",
    "<S> it is based on the extended press - schechter theory and so should be applicable to hierarchical models with a wide range of power spectra and cosmological models . </S>",
    "<S> it is tuned to be in accurate agreement with the conditional mass functions found in the analysis of merger trees extracted from the @xmath0cdm millennium n - body simulation . </S>",
    "<S> we present a comparison of its predictions not only with these conditional mass functions , but also with additional statistics of the millennium simulation halo merger histories . in all cases </S>",
    "<S> we find it to be in good agreement with the millennium simulation and thus it should prove to be a very useful tool for semi - analytic models of galaxy formation and for modelling hierarchical structure formation in general . </S>",
    "<S> we have made our merger tree generation code and code to navigate the trees available at http://star-www.dur.ac.uk/@xmath1cole/merger_trees .    </S>",
    "<S> cosmology : theory , cosmology : dark matter , methods : numerical </S>"
  ]
}