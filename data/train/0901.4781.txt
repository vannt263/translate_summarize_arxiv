{
  "article_text": [
    "weak gravitational lensing has been widely used as a direct probe of the large scale structure ( see reviews by @xcite ) . by measuring the systematic distortions of background galaxy images ,",
    "one can place constraints on the cosmological parameters ( @xcite ) . with accurate redshift information , the geometry and the structure growth rate of our universe can be constrained as functions of redshift separately , providing a consistency test of the gravity theory ( @xcite ) .",
    "a key issue in weak lensing is about how to measure the cosmic shear with galaxy shapes .",
    "this is difficult mainly because the signal - to - noise ratio of the measurement on one galaxy is typically only a few percent .",
    "it is therefore extremely important for any shear measurement method to carefully treat any possible systematic errors , including at least the following : the correction due to the image smearing by the point spread function ( psf , including the pixel response function ) ; the photon noise ; the pixelation effect due to the discrete nature of the ccd pixels .",
    "there have been a number of methods proposed to deal with the corrections due to the psf ( see @xcite ) .",
    "however , the photon noise and the pixelation effect remain to be treated in a more systematic way . for example , existing model fitting methods ( , @xcite ) use the variance of the noise to weight the pixels in their chi - square fittings .",
    "it is not clear to what level the noise contamination to the shear recovery can be removed in this way , especially for correlated background noise ( see , , @xcite ) . by integrating the model over the pixels , the model fitting methods essentially use linear interpolations to treat the pixelation effect",
    "this is found not accurate as we will discuss in  [ pixelation ] . indeed ,",
    "as we will discuss later in the paper , there are two types of noise : the astronomical photon noise and the `` photon counting '' shot noise . while the second type diminishes when the exposure time increases , the first type does not .",
    "we will mainly focus on the astronomical noise in this paper . for the counting shot noise , we will simply argue in  [ summary ] that its contamination to the shear recovery can be significantly suppressed by increasing the exposure time .",
    "since these issues are not specifically addressed in any previous weak lensing literatures , it is important to point them out in this paper .    in a recent work by zhang ( 2008 ) ( z08 hereafter )",
    ", a new and simple way of measuring the cosmic shear is found .",
    "its main advantages includes : 1 .",
    "it is mathematically simple ; 2 .",
    "it is free of assumptions on the morphologies of the galaxies and the psf ; 3 .",
    "it enables us to probe the shear information from galaxy substructures , thereby improving the signal - to - noise ratio .",
    "these facts encourage us to extend the method further by including a treatment of the photon noise and the pixelation effect .",
    "fortunately , we find that these two types of systematic errors can be treated in a simple and model - independent way based on the method of z08 .",
    "as will become clear later in this paper , the method we adopt to remove the noise contamination can also be considered in other shear measurement methods , and our treatment of the pixelation effect is generally useful for image processing of all purposes .",
    "the paper is organized as follows : in  [ review ] , we briefly review the shear measurement method of z08 ; in  [ systematics ] , we show how to treat the photon noise ( in  [ noise ] ) and the pixelation effect ( in  [ pixelation ] ) in weak lensing ; in  [ numerics ] , we use computer - generated mock galaxy images to test the performance of our method ; finally , we summarize and discuss remaining issues in  [ summary ] .",
    "z08 proposes a way of measuring the cosmic shear with the spatial derivatives of the galaxy surface brightness field . to do so ,",
    "let us define the surface brightness on the image plane as @xmath0 , and that on the source plane as @xmath1 , where @xmath2 and @xmath3 are the position angles on the image and source plane respectively .",
    "these quantities are related in a simple way as : @xmath4 where @xmath5 , and @xmath6 are the spatial derivatives of the lensing deflection angle .",
    "matrix @xmath7 is often expressed in terms of the convergence @xmath8 and the two shear components @xmath9 and @xmath10 . assuming the intrinsic galaxy image @xmath1 is statistically isotropic , the shear components can be simply related to the derivatives of the surface brightness field as ( @xcite ) : @xmath11 where the averages are taken over the galaxy .",
    "eq.[[shear12 ] ] is useful only when the angular resolution of the observation is infinitely high . in practice ,",
    "the observed galaxy surface brightness distribution @xmath12 is always equal to the lensed galaxy image @xmath13 convoluted with the psf , : @xmath14 where @xmath15 is the psf .",
    "z08 has shown how to modify eq.([shear12 ] ) when the psf is an isotropic gaussian function , which can be written as : @xmath16 where @xmath17 is the scale radius of the gaussian function .",
    "the new relation between the shear components and the derivatives of the surface brightness field is : @xmath18 where @xmath19    for a general psf , one can transform it into the desired isotropic gaussian form through a convolution in fourier space",
    ". the scale radius @xmath17 of the target psf should be larger than that of the original psf to avoid singularities in the convolution .",
    "furthermore , as shown in z08 , the spatial derivatives required by eq.([shear12psf ] ) can also be easily evaluated in fourier space .",
    "in this section , we introduce the basic ideas for treating the photon noise and the pixelation effect in  [ noise ] and  [ pixelation ] respectively .",
    "numerical examples are given in the next section .",
    "first of all , there are two types of photon noise : the astronomical photon noise due to the fluctuation of the background , and the `` photon counting '' shot noise due to finite exposure time .",
    "note that the first type of noise , like the source , is convoluted by the psf , while the second type of noise varies from pixel to pixel even if the pixel size is much smaller than the psf size . in the rest of the paper",
    ", we mainly deal with the astronomical noise . for the `` photon counting '' shot noise",
    ", we will simply argue in  [ summary ] that its contamination to the shear recovery can be significantly suppressed by increasing the exposure time .",
    "the presence of the photon noise makes the measurement of the cosmic shear more complicated in two ways : 1 .",
    "the observed surface brightness @xmath12 is from both the lensed source and the un - lensed foreground noise ; 2 .",
    "because of the aliasing power caused by the non - periodic boundaries of the _ noisy _ map , the measurement of the spatial derivatives of the surface brightness field can not be accurately performed in fourier space .",
    "note that simple treatments such as filtering out the noise outside of the source image do not completely fix this problem , because the noise inside the image can still bias the shear estimate .",
    "fortunately , as we show in the rest of this section , our master equation [ eq.([shear12psf ] ) ] for estimating the cosmic shear can be easily adapted to solve both problems .    in the method of z08 , to isolate the source signals in a noisy map , let us first write the total observed surface brightness @xmath12 as the sum of the contributions from the source @xmath20 and the noise @xmath21 , , @xmath22 .",
    "note that in this case , instead of @xmath12 , @xmath20 should be used in eq.([shear12psf ] ) to correctly measure the shear components .",
    "for this purpose , let us use the following relation : @xmath23 for simplicity , in this paper , we only consider the photon noise that is from the foreground or the instruments .",
    "the surface brightness distribution of the noise is therefore uncorrelated with that of the background sources . under this assumption",
    ", the cross - correlations between the source and the noise terms ( such as , , @xmath24 ) should vanish .",
    "eq.([osn ] ) therefore becomes : @xmath25 the relations in eq.([osn3 ] ) suggest an easy way of removing the contaminations from the photon noise : one can use a neighboring map of pure noise @xmath21 to estimate @xmath26 , @xmath27 , @xmath28 , @xmath29 , and subtract them from their counterparts evaluated from the noisy source map @xmath12 to get the source terms required by eq.([shear12psf ] ) . note",
    "that since the noise photons are distributed differently in each map , the above procedure does not exactly remove the noise contribution for each source image .",
    "however , the method is statistically accurate as long as the statistical properties of the photon noise are stable over a reasonably large scale . in other words , the differences in the noise distributions of two maps",
    "add statistical errors to the measured cosmic shear through this procedure , but no systematic errors .",
    "finally , the pure noise map should be a close neighbor of the source map so that they share the same point spread function .",
    "to evaluate the derivatives of the surface brightness field of a noisy map in the fourier space , we need to deal with the non - periodic boundaries appropriately to avoid aliasing powers .",
    "this can be done by gradually attenuating the noise towards the boundaries of the map .",
    "the attenuation can take an arbitrary form as long as the following criterions are satisfied : 1 .",
    "the source region is not affected ; 2 .",
    "the edges of the map should be rendered sufficiently faint ; 3 .",
    "the attenuation amplitude should not have abrupt spatial variations ; 4 . to properly remove the noise contamination , the same attenuation",
    "should also be applied to the neighboring map of pure noise .    in  [ numerics ] , we show numerical examples to support the noise treatment discussed above .",
    "modern astronomical images are commonly recorded on ccd pixels , the discrete nature of which may affect the accuracy of the cosmic shear measurements . in general , to avoid significant shear measurement errors , the pixel size should be at least a few times smaller than the scale radius ( or fwhm ) of the psf .",
    "for instance , we find that the method of z08 requires the scale radius of the psf to be roughly 3 or 4 times larger than the pixel size .",
    "this requirement is often not satisfied in space - based observations .",
    "it is therefore useful to have a method which can reconstruct continuous images from under - sampled ones .",
    "this is indeed a well - defined interpolation problem : how to reconstruct a continuous function if its value is only given at a set of discrete points . in the context of weak lensing",
    ", there is a quantitative way of testing the performance of the interpolation method , which is to check the accuracy of the shear recovery using the reconstructed images .",
    "the best method should yield the fastest convergence to an accurate image reconstruction ( or shear recovery ) as the pixel size becomes smaller .",
    "we have tested several standard 2d interpolation methods , including bilinear interpolation , bicubic interpolation , and bicubic spline interpolation ( see @xcite for details ) .",
    "although these conventional methods perform reasonably well , we find that they can all be significantly improved by interpolating the natural logarithms of the data instead of the data themselves .",
    "this is mainly due to two reasons : 1 .",
    "the values of the data have a lower bound  zero ; 2 . at large distances",
    ", the psf typically falls off exponentially . for convenience , in the rest of the paper , we call such extensions of the three classical interpolation methods their original names with the prefix `` log- '' , and always abbreviate `` bicubic spline '' to `` spline '' .",
    "the mathematical definitions of the six methods ( , bilinear , bicubic , spline , log - bilinear , log - bicubic , log - spline ) are given in the appendix . in ",
    "[ numerics ] , we show that the log - bicubic and log - spline methods are most accurate among the six . as will be shown in our numerical examples , continuous images that are reconstructed by these two interpolation methods yield negligible systematic errors in shear recovery as long as the pixel size is about smaller than the psf size ( twice its scale radius ) .",
    "note that the pixel size is _ rarely _ larger than the psf size in practice , because the pixel response function is a part of the psf .",
    "we present numerical examples to support the ideas introduced in the previous section .",
    "the general setup of our numerical simulations are given in ",
    "[ setup ] . in  [ test_noise ] and  [ test_pixelation ] , we test our treatments of the photon noise and the pixelation effect separately . finally , the overall performance of our method is shown in  [ overall ] .",
    "each of our galaxy images is placed on a @xmath30 grid , where @xmath31 is an integer ( typical chosen to be @xmath32 ) .",
    "note that such a choice facilitates the fast fourier transformation ( fft ) .",
    "each grid point is treated as the location of the center of a ccd pixel , whose side length is equal to the grid size .",
    "all sizes in our simulations are expressed in units of the grid size , , the pixel size .",
    "the form of the psf is chosen from the following two functions rotated by certain angles : @xmath33\\\\ \\nonumber & & w_b(x , y)\\propto \\exp\\left[-\\frac{1}{2r_{psf}^2}\\left(x^2 + 0.8y^2\\right)\\right]\\\\ \\nonumber & + & 0.03\\exp\\left[-\\left(\\frac{x^2}{r_{psf}^2}+0.2\\right)\\cdot\\left(\\frac{y^2}{r_{psf}^2}+0.2\\right)\\right]\\end{aligned}\\ ] ] where @xmath34 is the scale radius of the psf",
    ". a schematic view of the psf functions is shown in fig.[psfs ] .",
    "note that the additional term in @xmath35 mimics the diffraction spikes . as discussed in ",
    "[ review ] , before measuring the shear using eq.([shear12psf ] ) , the psf is always transformed into the desired isotropic gaussian form , whose scale radius @xmath17 should be slightly larger than @xmath34 defined here to avoid singularities in the transformation . note that we have reserved the greek letter @xmath17 for the scale radius of the target psf to distinguish it from @xmath34 .    )",
    "( rotated by certain angles ) .",
    "the contours mark 0.0025% , 0.025% , 0.25% , 2.5% , and 25% of the peak intensity . ]",
    "both the galaxies and the noise are treated as collections of point sources . for example , the image of a galaxy in our simulation is typically made of a few hundred or thousand points .",
    "the advantage of doing so is that one can easily lense the galaxy by displacing its point sources and modifying their amplitudes .",
    "the intensities of the point sources are distributed to the neighboring grid points of their locations according to the psf .",
    "for example , a point source of intensity @xmath36 at location @xmath37 contributes an intensity of @xmath38 to the grid point at location @xmath39 .",
    "the total intensity on a grid point is the sum of contributions from all the point sources .",
    "since everything is composed of point sources in our simulation , we will mostly call the surface brightness the flux density in the rest of the paper .",
    "there are two types of mock galaxies we use in this paper : regular disk galaxies and irregular galaxies .",
    "our regular galaxy contains a thin circular disk of an exponential profile and a co - axial de vaucouleurs - type bulge ( @xcite ) . on average ,",
    "its face - on surface brightness distribution is parameterized as : @xmath40\\ ] ] where @xmath41 is the distance to the galaxy center , @xmath42 and @xmath43 are the scale radii of the bulge and the disk respectively , and @xmath44 determines the relative brightness of the bulge with respect to the disk . in the simulation ,",
    "this profile is realized by properly and randomly placing a certain number ( typically a few hundred ) of point sources .",
    "these point sources are projected onto a randomly oriented image plane , lensed , and finally assigned to the ccd pixels according to the psf to yield the galaxy image .",
    "our irregular galaxies are generated by 2d random walks .",
    "the random walk starts from the center of the grid , and continues for a certain number of steps .",
    "each step has a fixed size and a completely random orientation in the image plane .",
    "the joint of every two adjacent steps gives the pre - lensing position of a point source of the galaxy in the image plane .",
    "the resulting irregular galaxies usually contain abundant substructures .    for numerical manageability",
    ", we always cutoff the galaxy profile at a certain radius @xmath45 , which is denoted as the scale radius of the galaxy .",
    "this is done by excluding the points that are outside of radius @xmath45 in generating our regular galaxies .",
    "for the irregular galaxies , the random walker is sent back to the origin to continue from there when it reaches the radius @xmath45 .    without loss of generality ,",
    "we set @xmath46 , @xmath47 , and @xmath48 for the regular galaxies .      as our first example",
    ", we use @xmath49 mock regular galaxies to test the treatment of photon noise discussed in  [ noise ] .",
    "each galaxy is made of @xmath50 point sources .",
    "the galaxy size @xmath45 is fixed at @xmath51 .",
    "the angle between the line - of - sight direction and the normal vector of the disk plane is randomly chosen from @xmath52 $ ] .",
    "the psf we use is @xmath53 of eq.([ws ] ) with @xmath54 ( no pixelation effect ) .",
    "the scale radius @xmath17 of the target isotropic gaussian psf is @xmath55 .",
    "the noise is made of poisson distributed point sources , the mean number density of which is roughly one per @xmath56 area .",
    "each point source of the noise is given the same intensity , the value of which can be freely adjusted to determine the ratio of the mean flux density of the noise to that of the galaxy ( within its scale radius ) .",
    "note that a separate pure noise map is generated for each noisy galaxy map for removing the noise contaminations to the shear signal .",
    "fig.[galaxymap_noise ] shows sample images of four different noise - to - galaxy flux density ratios : @xmath57 , @xmath58 , @xmath59 , @xmath60 . to avoid aliasing powers in fourier transformation ,",
    "the noise near the boundaries of the map is filtered out by a window function defined as follows : @xmath61 & \\mbox{if $ r > r_{core}$}.\\end{array } \\right.\\end{aligned}\\ ] ] where @xmath41 is the distance to the map / galaxy center , @xmath62 is the radius encircling the unaffected region , and @xmath63 determines the width of the transition area .",
    "note that the flat core of the filter should be sufficiently large to avoid affecting the galaxy images . in our simulations , we always choose @xmath64 , and @xmath65 .",
    "finally , to correct for the noise , for each galaxy map , we generate a map of pure noise to measure the noise properties required by eq.([osn3 ] ) .",
    "the same filter is also applied to the pure noise map before the fourier transformation .    in fig.[shear_regular_noise_only ]",
    ", we plot the recovered shear values for different noise - to - galaxy flux density ratios @xmath66 .",
    "the input cosmic shear @xmath67 is @xmath68 , displayed as dotted lines .",
    "the red data points with @xmath69 error bars are our main results achieved through the complete treatment of noise . for a comparison ,",
    "the blue ones show the shear values measured directly from the noisy galaxy maps using eq.([shear12psf ] ) without correcting for the noise ( but the filter given by eq.([window_noise ] ) is still applied to avoid the aliasing power in fourier transformation ) .",
    "the figure clearly demonstrates that our noise treatment works remarkably well even when the mean flux density of the noise is comparable with that of the galaxy , though we caution that the size of the error bar grows with increasing noise intensity . on the other hand ,",
    "the blue data points indicates that without a proper treatment of the noise , the measured shear values quickly drops to zero as the noise flux becomes dominant , deviating significantly from the input shear values .",
    "finally , it is worth noting that both here and in the simulations reported in the rest of the paper , the number density of the noise points is always chosen to be roughly one point per psf area ( @xmath70 ) or slightly more .",
    "this is due to two reasons : 1 . for a fixed mean noise flux density ,",
    "a higher number density of the poisson distributed noise points indeed leads to lower spatial fluctuations of the noise surface brightness field , therefore a less contamination to the shear signal , or a less challenging condition ; 2 . on the other hand",
    ", if the number density is much smaller than one point per psf area , the image turns into a collection of discrete point - like sources , causing both the nominator and the denominator of eq.([shear12psf ] ) to become small differences of large numbers , which are well known sources for numerical errors .",
    "the second point simply means it is hard to measure the shapes of sources that are much smaller than the size of the psf . in practice",
    ", we can avoid the second situation by increasing the observation / integration time .",
    ", @xmath58 , @xmath59 , @xmath60 respectively . ]",
    "error bars measured from images of different noise - to - galaxy flux density ratios @xmath66",
    ". the measurement uses @xmath49 mock regular galaxies .",
    "the dotted lines indicate the input shear values .",
    "the red data points are our main results achieved through the complete treatment of noise introduced in  [ noise ] .",
    "the blue ones show the shear values measured directly from the noisy galaxy maps using eq.([shear12psf ] ) without removing the noise contaminations . ]      when the scale radius of the psf is less than @xmath71 or @xmath72 times the pixel size , the galaxy / noise images start to look pixelated , and the shear recovery accuracy may be strongly affected by the discrete nature of the ccd pixels . to reconstruct continuous images , we use 2d interpolation methods to insert finer grid points .",
    "the finer grid size is chosen to be @xmath73 ( @xmath74 is an integer ) times smaller than the original grid size , and at least less than a quarter of the psf scale radius @xmath34 .",
    "it is worth noting that interpolation of the pixelated image , if necessary , is always the first step in our shear measurement procedure .",
    "an example of a pixelated image is shown in the up - left corner of fig.[maps_interpolation ] , for which the scale radius of the psf is @xmath59 .",
    "the high resolution images reconstructed by the three interpolation methods and their logarithmic extensions discussed in  [ pixelation ] are show in the lower half of fig.[maps_interpolation ] .",
    "the true high resolution image is on the up - right corner of the figure . by simply comparing the morphologies of the interpolated images by eye",
    ", one may already tend to conclude that the performances of the three conventional methods are improved if we interpolate the log of the data instead of the data itself .",
    "for instance , negative intensities ( denoted as blue regions in the figure ) are commonly found in the interpolated maps by the bicubic and spline methods , but absent in those by the log - bicubic or log - spline methods ; the filamentary features produced by the bilinear method become somewhat less prominent in the map processed by the log - bilinear method .        to test the interpolation methods more quantitatively",
    ", we may compare the shear values measured from the interpolated maps using eq.([shear12psf ] ) ( in the absence of noise ) .",
    "clearly , all the interpolation methods should yield the same and correct shear estimates for a given galaxy and psf if the psf scale radius is much larger than the pixel size , , in the absence of the pixelation effect . for small psf sizes , as we have seen , the continuous images interpolated by different methods look unlike each other , resulting in possibly very different shear values . moreover , since the source is sparsely sampled in this case , the original ( pixelated ) image , the interpolated image , and the measured shear values all depend on the relative positions of the pixels with respect to the source . in fig.[test_single_image ] , we show the distributions ( as histograms ) of the shear values estimated from a _ single _ galaxy that is placed at different / random locations on the grid . for simplicity and clarity , we do not include any photon noise here .",
    "the ratio of the galaxy size @xmath45 to the psf scale radius @xmath34 is fixed at @xmath75 .",
    "the ratio of the pixel size to @xmath34 is chosen to be @xmath76 , @xmath60 , @xmath77 , @xmath59 , the results of which are represented by the purple , blue , red , and black histograms respectively .",
    "the figure shows that as the pixel size decreases relative to the psf size , the shear distributions converge more rapidly to a delta function at the correct position in methods with the prefix `` log- '' , manifesting again the value of the logarithmic extensions of the three classic interpolation methods .    , @xmath60 , @xmath77 , @xmath59 respectively .",
    "each panel shows the results from a single interpolation method , whose name is indicated in the upper - left corner of the plot .",
    "all the histograms are normalized so that their peak values are one . ]    finally , let us find out which interpolation method is best suited to weak lensing .",
    "for this purpose , we test the accuracy of shear recovery with a large number of interpolated galaxy images .",
    "to make it a more convincing test , we use our morphologically rich irregular galaxies , each of which is generated by 1000 random steps .",
    "we consider three choices for the random walk step size and the galaxy scale radius @xmath45 : ( @xmath78 , @xmath79 ) , ( @xmath80 , @xmath81 ) , and ( @xmath82 , @xmath83 ) , referring to large , medium , and small galaxies respectively .",
    "the psf we use is @xmath35 .",
    "@xmath17 of the target isotropic gaussian psf is set to be @xmath84 of @xmath34 .",
    "the cosmic shear ( @xmath85 , @xmath86 ) is chosen to be ( @xmath87 , @xmath88 ) .",
    "no photon noise is included .",
    "our results are summarized in fig.[test_multi_image ] , in which we plot the measured shear values against the ratio of the pixel size to @xmath34 . in the upper , middle , and lower panels of the figure , we report the results from averaging over 10000 large , medium , and small size galaxies respectively .",
    "the dotted lines refer to the input shear values .",
    "the cyan , blue , magenta , green , red , and black data points with @xmath69 error bars are from the bilinear , bicubic , spline , log - bilinear , log - bicubic , and log - spline methods respectively . according to the figure",
    ", we can draw several conclusions :    \\1 . as a sanity check",
    ", we confirm that all the interpolation methods work well when the psf size is much larger than the pixel size ;    \\2 .",
    "log - bicubic and log - spline are the two most successful methods",
    ". both of them can correctly recover the input shear as long as @xmath34 is about larger than a half of the pixel size , regardless of the galaxy size .",
    "note that one should not expect any interpolation method to work well when @xmath89 unless the source images are sufficiently smooth over the scale of the pixel size .",
    "the pixelation effect is less important for larger galaxies .",
    "for instance , by comparing the results in the three panels of fig.[test_multi_image ] , we see that the quality of shear recovery becomes increasingly poor for galaxies of smaller sizes for a given @xmath34 .",
    "this is not surprising because the structures / shapes of large galaxies are better resolved than those of smaller ones .",
    "meanwhile , it is encouraging to note that the log - bicubic and log - spline methods perform fairly well for @xmath90 even when the galaxy size is comparable to the psf size .    .",
    "the upper , middle , and lower windows show the results from averaging over 10000 relatively large , medium , and small size galaxies respectively .",
    "the definition of the galaxy size in this example can be found in  [ test_pixelation ] .",
    "the cyan , blue , magenta , green , red , and black data points with @xmath69 error bars are the results from the bilinear , bicubic , spline , log - bilinear , log - bicubic , and log - spline interpolation methods respectively . the input shear values are shown as dotted lines . ]",
    "the purpose of this section is to test our shear measurement method under general conditions , , in the presence of both photon noise and the pixelation effect .",
    "fig.[pipeline ] shows the pipeline of the numerical procedures we take in general cases .",
    "a detailed explanation of each item in the graph has been given in ",
    "[ systematics ] .        in fig.[overall_test ]",
    ", we show the shear recovery results for both regular and irregular galaxies with different psf forms . in each panel",
    ", we use @xmath49 mock galaxies and scale them to four different sizes ( galaxy radius ranges from 2.5 to 10 times the scale radius of the psf ) to test the accuracy of shear recovery . in all panels ,",
    "the psf scale radius ( @xmath34 ) is half of the pixel size , corresponding to roughly the maximum pixelation effect that can be treated by an interpolation method .",
    "the red and black data points are from the log - bicubic and log - spline methods respectively .",
    "the input shear values are shown by dashed lines .",
    "the scale radius of the target isotropic gaussian psf is always @xmath91 . to avoid aliasing powers in fourier transformation , we use eq.([window_noise ] ) to filter the noise near the boundaries of the map . from the top to the bottom panel , the ratio of the mean flux density of the noise to that of the galaxy ( @xmath66 ) is 0.1 , 0.5 , 0.6 , and 0.2 respectively .",
    "the figure indicates that our method generally works well on galaxies of sizes that are at least a few times larger than the psf size .",
    "small discrepancies between the input shear values and the measured ones do exist when the galaxy size is comparable to the psf size .",
    "the residual systematic errors will be studied with a much larger ensemble of galaxies in another work .",
    "/@xmath35 ) as denoted at the top of each panel . for the results in each panel ,",
    "we use 10000 mock galaxies , and scale them to four different sizes ( galaxy radius equal to 2.5 , 5 , 7.5 , 10 times the psf scale radius ) to recovery the input shear values . in all panels , the psf scale radius is half of the pixel size .",
    "the red and black data points are from the log - bicubic and log - spline interpolation methods respectively .",
    "the input shear values are shown by dashed lines . from the top to the bottom panel , the ratio of the mean flux density of the noise to that of the galaxy ( @xmath66 ) is 0.1 , 0.5 , 0.6 , and 0.2 respectively . ]",
    "we have discussed how to correct for the systematic errors due to the photon noise and the pixelation effect in cosmic shear measurements .",
    "our treatment of photon noise allows us to reliably remove the noise contamination to the cosmic shear even when the noise flux density is comparable with that of the sources . in principle , our method works regardless of the brightness of the noise , though when the noise is much brighter than the sources , one needs to worry about image selections . to deal with pixelated images ,",
    "our approach is to reconstruct continuous images by interpolating the natural logarithms of the pixel readouts with either the bicubic or bicubic spline method .",
    "this technique is accurate for the purpose of shear recovery as long as the scale radius of the psf is larger than about a half of the pixel size , a condition which is almost always satisfied in practice .",
    "despite the fact that our study has been based on the shear measurement method of z08 , a part of our methodology is generally useful for other shear measurement methods , or even other astronomical measurements as well .",
    "the most obvious thing to note is that the log - bicubic and log - spline interpolation methods are accurate image reconstruction approaches not only for weak lensing , but also for all kinds of other purposes .",
    "the way we remove the noise contamination from the shear signal can in principle also be considered in other shear measurements , in particular those that are based on measuring the multipole moments of the source images ( , @xcite and its various extensions ) .",
    "so far , our discussion has neglected the `` photon counting '' shot noise , which is always present due to the finite telescope exposure time .",
    "indeed , it becomes the dominant source of photon noise for ground - based weak lensing survey because of the large sky background . unlike the astronomical photon noise that we have discussed ,",
    "the photon shot noise varies from pixel to pixel independent of the size of the psf .",
    "furthermore , the fluctuation amplitude of the shot noise is also dependent on the photon flux of the source .",
    "therefore , it is hard to cleanly remove the contamination from the photon counting shot noise in our shear measurement .",
    "we do not intend to deal with this problem in this paper .",
    "alternatively , we argue that the systematic shear measurement error due to the shot noise can be suppressed by simply increasing the telescope exposure time .",
    "more specifically , we argue that for any given tolerance level of the systematic error , there is a critical exposure time , beyond which the contamination from the shot noise is adequately suppressed . to demonstrate this statement , in fig.[poisson ] , we plot the accuracy of shear recovery under three different conditions : high , medium , and low noise level , which correspond to noise - to - source mean surface brightness ratio of 100 , 10 , and 1 , or the signal - to - noise ratio of 0.01 , 0.1 , 1 respectively . the x axis in each plot",
    "is the mean number of background noise photons recorded on each pixel , which is proportional to the exposure time .",
    "the accuracy of shear recovery is expressed in terms of the multiplicative and additive bias parameters ( commonly used by people in the weak lensing community ) , which are defined as : @xmath92 for a perfect shear measurement , one should have @xmath93 . to produce each ( @xmath74 , @xmath94 ) pair in fig.[poisson ] ,",
    "we use five different input shear values , , ( 0.04 , 0.04 ) , ( 0.02 , 0.02 ) , ( 0 , 0 ) , ( -0.02 , -0.02 ) , ( -0.04 , -0.04 ) , for ( @xmath85 , @xmath86 ) ( which are reported using red and blue colors respectively ) , and 10000 mock irregular galaxies for each input ( @xmath85 , @xmath86 ) . note that to see the dependence of the shear recovery accuracy on the exposure time more clearly , we repeatedly use the same set of galaxies for different exposure times . in all cases",
    ", we set the galaxy radius to be 7.5 times the psf radius .",
    "the later is set to be equal to the pixel size .",
    "we use log - spline as the interpolation method .",
    "the astronomical photon noise is not included , , the photon counting noise is the only photon noise in this test . according to the figure , the systematic errors due to the photon counting noise",
    "is clearly suppressed when exposure time is beyond some threshold .",
    "not surprisingly , the low noise case requires the shortest exposure time to achieve the same shear recovery accuracy level .",
    "a more comprehensive test with a much larger ensemble of galaxies will be shown in a separate paper .    ) .",
    "each data point is achieved using five different sets of ( @xmath85 , @xmath86 ) , , ( 0.04 , 0.04 ) , ( 0.02 , 0.02 ) , ( 0 , 0 ) , ( -0.02 , -0.02 ) , ( -0.04 , -0.04 ) .",
    "the red and blue data points are for @xmath85 and @xmath86 respectively .",
    "for each input shear , 10000 mock galaxies are used to recover the shear .",
    "the same galaxies are used repeatedly for different exposure times so that the dependence of the shear recovery accuracy on the exposure time can be more clearly seen .",
    "the exposure time is denoted by the mean number of background photons received per pixel ( x - axis ) .",
    "the three panels from the top to the bottom correspond to the signal - to - noise ratios ( , the ratio of the mean surface brightness of the source to that of the background noise ) of 0.01 , 0.1 , 1 respectively , referring to the high , medium , and low noise cases as denoted at the top of the panels . ]    the other sources of systematic errors that we have neglected include the high order corrections ( , @xmath95 , @xmath96 , @xmath97 ) to our master equation [ eq.([shear12psf ] ) ] , the spatial variations of the cosmic shear , etc .. these factors likely affect the measured shear values at percent levels on cosmic scales , which is important in the era of precision cosmology . for clustering lensing , the high order shear terms are more important because the shear is of order ten percent .",
    "this subject will be studied in a companion paper .",
    "this paper is a natural continuation of z08 on the methodology of cosmic shear measurement . in another paper",
    ", we will further test this method with the data from the shear testing program ( @xcite ) and the great08 program ( @xcite ) , and also present results measured with real astronomical data .",
    "jz would like to thank anthony tyson and the anonymous referee for pointing out the importance of the photon counting shot noise , which was neglected in an earlier version of this paper .",
    "jz is currently supported by the tcc fellowship of texas cosmology center of the university of texas at austin .",
    "jz was previously supported by the tac fellowship of the theoretical astrophysics center of uc berkeley , where the majority of this work was done .",
    "abazajian k. & dodelson s. , 2003 , prl , 91 , 041301    acquaviva v. , baccigalupi c. & perrotta f. , 2004 , prd , 70 , 023515    bacon d. , massey r. , refregier a. , ellis r. , 2003 , mnras , 344 , 673    bacon d. , refregier a. & ellis r. , 2000 , mnras , 318 , 625    bartelmann m. & schneider p. , 2001 ,",
    "physics reports , 340 , 291    bernstein g. & jain b. , 2004 , apj , 600 , 17    bernstein g. & jarvis m. , 2002 , aj , 123 , 583    bonnet h. & mellier y. , 1995 , a&a , 303 , 331    bridle s. , gull s. , bardeau s. , kneib j. , 2001 , in scientific n.  w. , ed . , proceedings of the yale cosmology workshop    bridle s. et al . , 2009 , annals of applied statistics , vol.3 , no.1 , 6 , arxiv : 0802.1214    brown m. , taylor a. , bacon d. , gray m. , dye s. , meisenheimer k. , wolf c. , 2003 , mnras , 341 , 100    dahle h. , 2006 , apj , 653 , 954    hamana t. et al . , 2003 , apj , 597 , 98    hannestad s. , tu h. & wong y. , 2006 , jcap , 0606 , 025    hetterscheidt m. , simon p. , schirmer m. , hildebrandt h. , schrabback t. , erben t. , schneider p. , 2007",
    ", a&a , 468 , 859    heymans c. et al . , 2005 , mnras , 361 , 160    heymans c. et al . , 2006 , mnras , 368 , 1323    hoekstra h. , franx m. , kuijken k. , squires g. , 1998 , apj , 504 , 636    hoekstra h. , 2006 , apj , 647 , 116h    hoekstra h. , yee h. & gladders m. , 2002 , apj , 577 , 595    hu w. , 2002 , prd , 66 , 083515    hu w. & jain b. , 2004 , prd , 70 , 043009    ishak m. , 2005 , mnras , 363 , 469    ishak m. , upadhye a. & spergel d. , 2006 , prd , 74 , 043513    jain b. & taylor a. , 2003 , prl , 91 , 141302    jarvis m. , bernstein g. , jain b. , fischer p. , smith d. , tyson j. , wittman d. , 2003 , apj , 125 , 1014    jarvis m. , jain b. , bernstein g. , dolney d. , 2006 , apj , 644 , 71    kaiser n. , 2000 , apj , 537 , 555    kaiser n. , squires g. & broadhurst t. , 1995 , apj , 449 , 460    kaiser n. , wilson g. & luppino g. , astro - ph/0003338    kitching t. , miller l. , heymans c. , van waerbeke l. , heavens a. , 2008 , mnras , 390 , 149 , arxiv : 0802.1528    knox l. , song y. & tyson j. , 2006 , prd , 74 , 023512    kratochvil j. , linde a. , linder e. , shmakova m. , 2004 , jcap , 0407 , 001    kuijken k. , 2006 , a&a , 456 , 827k    luppino g. & kaiser n. , 1997 , apj , 475 , 20    maoli r. , van waerbeke l. , mellier y. , schneider p. , jain b. , bernardeau f. , erben t. , 2001 , a&a , 368 , 766    massey r. , bacon d. , refregier a. , ellis r. , 2005 , mnras , 359 , 1277    massey r. et al .",
    ", 2007 , mnras , 376 , 13    massey r. & refregier a. , 2005 , mnras , 363 , 197    miller l. , kitching t. , heymans c. , heavens a. , van waerbeke l. , 2007 , mnras , 382 , 315 , arxiv : 0708.2340    nakajima r. & bernstein g. , 2007 , aj , 133 , 1763    press w. , flannery b. , teukolsky s. , vetterling w. , 1992 , _ numerical recipes _",
    ", cambridge univ .",
    "press , 2nd ed .",
    "refregier a. , 2003 , ara&a , 41 , 645    refregier a. & bacon d. , 2003 , mnras , 338 , 48    refregier a. , rhodes j. & groth e. , 2002 , apjl , 572 , l131    rhodes j. , refregier a. , collins n. , gardner j. , groth e. , hill r. , 2004 , apj , 605 , 29    rhodes j. , refregier a. & groth e. , 2000 , apj , 536 , 79    rhodes j. , refregier a. & groth e. , 2001 , apjl , 552 , l85    schimd c. et al . , 2007 , a&a , 463 , 405    schrabback t. et al . , 2007 , a&a , 468 , 823    seljak u. & zaldarriaga m. , 1999 , prl , 82 , 2636    semboloni e. et al . , 2006 , a&a , 452 , 51    simpson f. & bridle s. , 2005 , prd , 71 , 083501    song y. & knox l. , 2004 , prd , 70 , 063510    song y. , 2005 , prd , 71 , 024026    takada m. & jain b. , 2004 , mnras , 348 , 897    takada m. & white m. , 2004 , apj , 601 , l1    taylor a. , kitching t. , bacon d. , heavens a. , 2007 , mnras , 374 , 1377    tyson j. , wenk r. & valdes f. , 1990 , apjl , 349 , l1    de vaucouleurs g. , de vaucouleurs a. , corwin h. , buta r. , paturel g. , fouqu p. , 1991",
    ", _ third reference catalogue of bright galaxies _ , springer , new york    van waerbeke l. et al . , 2000 ,",
    "a&a , 358 , 30    van waerbeke l. , mellier y. & hoekstra h. , 2005 , a&a , 429 , 75    van waerbeke l. et al .",
    ", 2001 , a&a , 374 , 757    wittman d. , 2002 , _ dark matter and gravitational lensing _ , _ lnp top .",
    "courbin f. , minniti d. , springer - verlag . , astro - ph/0208063    wittman d. , tyson j. , kirkman d. , dellantonio i. , bernstein g. , 2000 , nature , 405 , 143    zhan h. , 2006 , jcap , 0608 , 008    zhang j. , hui l. & stebbins a. , 2005 , apj , 635 , 806    zhang j. , 2008 , mnras , 383 , 113",
    "in this appendix , we give the mathematical definitions of the three classic 2d interpolation methods : bilinear , bicubic , spline . for their logarithmic extensions ( , log - bilinear , log - bicubic , log - spline ) , we only have one minor point to address at the end of this section .",
    "the bilinear method is the simplest of the three .",
    "let us write the coordinates of the grid points as @xmath98 ( @xmath99 ) , and the signals as @xmath100 .",
    "suppose the point of our interest is @xmath101 , which satisfies @xmath102 and @xmath103 , the bilinear method defines @xmath104 in the following way : @xmath105 where @xmath106    the bicubic method includes higher order terms of @xmath107 and @xmath108 to achieve smoothness of the interpolated function .",
    "it requires the user to specify not only the signal @xmath100 , but also the spatial derivatives @xmath109 , @xmath110 , and @xmath111 at every grid point @xmath98 .",
    "since the spatial derivatives of the signal are usually not known a priori , we estimate them using the finite - difference method : @xmath112\\\\ \\nonumber & /&\\left[(x_{i+1}-x_{i-1})(y_{j+1}-y_{j-1})\\right]\\end{aligned}\\ ] ] the interpolated function inside each grid square is written in the following polynomial form : @xmath113 the values of the sixteen parameters @xmath114 are constrained using eq.([a_bicubic ] ) and the following three equations at the four corners of the grid square : @xmath115 where @xmath107 and @xmath108 have been defined in eq.([tu ] ) .",
    "given the values of a function @xmath116 at a set of points @xmath117 ( @xmath118 ) , the form of the function in the interval between @xmath119 and @xmath120 is written as : @xmath121 where @xmath122 and @xmath123 is the second derivative of the function @xmath124 at @xmath119 . as a consistency check , one can easily show that @xmath125 . the value of the second derivatives are specified by requiring the first derivatives evaluated from the two sides of the grid point to be equal .",
    "note that this requirement only provides @xmath126 equations , while there are @xmath127 second derivatives in total .",
    "the rest of the constraint comes from the boundary conditions on @xmath128 and @xmath129 . in this paper",
    ", we simply set @xmath130 , which yields the so - called _ natural cubic spline_.    finally , we note that the `` log '' based interpolation methods are all well defined except when the readouts of some pixels are zero .",
    "this is a very rare case in practice due to the presence of noise .",
    "however , this situation can in principle exist in simulations . to cure this problem , one can either change the zeros into tiny positive numbers , or simply avoid interpolating the regions with zeros .",
    "the second option says that if a grid square ( regarding the log - bilinear and log - bicubic methods ) or a unitary segment ( regarding the log - spline method ) contains any zero readouts in their four corners or two ends , the finer grid points within them are all set to have zero values .",
    "the rest of the grid squares / segments are interpolated independently as usual .",
    "note that in the log - spline method , this means the spline interpolations are carried out only in those nonzero segments that are isolated by the zeros .",
    "these two choices usually work similarly well .",
    "however , when there are extended regions of zero readouts , we find that the second option is better , because it avoids introducing artificial high order fluctuations in the zero regions by methods like log - bicubic or log - spline ."
  ],
  "abstract_text": [
    "<S> we propose easy ways of correcting for the systematic errors caused by the photon noise and the pixelation effect in cosmic shear measurements . </S>",
    "<S> our treatment of noise can reliably remove the noise contamination to the cosmic shear even when the flux density of the noise is comparable with those of the sources . for pixelated images </S>",
    "<S> , we find that one can accurately reconstruct their corresponding continuous images by interpolating the logarithms of the pixel readouts with either the bicubic or the bicubic spline method as long as the pixel size is about less than the scale size of the point spread function ( psf , including the pixel response function ) , a condition which is almost always satisfied in practice . </S>",
    "<S> our methodology is well defined regardless of the morphologies of the galaxies and the psf . despite that our discussion </S>",
    "<S> is based on the shear measurement method of zhang ( 2008 ) , our way of treating the noise can in principle be considered in other methods , and the interpolation method that we introduce for reconstructing continuous images from pixelated ones is generally useful for digital image processing of all purposes .    </S>",
    "<S> [ firstpage ]    cosmology : gravitational lensing - methods : data analysis - techniques : image processing : large scale structure </S>"
  ]
}