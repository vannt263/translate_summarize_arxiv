{
  "article_text": [
    "copyright 2015 american institute of physics .",
    "this is a preprint version of an article submitted to the journal of chemical physics .",
    "this article may be downloaded for personal use only .",
    "any other use requires prior permission of the author and the american institute of physics .",
    "+ http://jcp.aip.org/",
    "@xmath1department of chemistry , rutgers university , newark , usa .    @xmath2cnr - istm , institute of molecular sciences and technologies , milan , italy",
    "it is the nature of a chemist to view molecules as a collection of atoms and condensed states as a collection of molecules , and to interpret the properties of the larger aggregates in terms of their smaller building stones and the interactions between them . in the field of computational chemistry , this tendency was first expressed in a development of a range of so called atoms - in - molecule methods ( aim),@xcite which are meant to be used as a post - processing tool in order to reveal the subtle relations between structure and properties , hidden in the single quantity obtained from a supermolecular calculation .",
    "an array of aim methods based on space partitioning,@xcite density partitioning@xcite and wave function partitioning@xcite have been developed over decades and successfully applied to a range of properties as charges , energies , response properties and reactivity analysis .",
    "embedding@xcite is a more recently developed field which can be seen as taking aim a step further and instead of applying its concepts in the post processing , merge it with the electronic structure theory . in this process",
    ", the goal to seek deeper chemical understanding has been supplemented by the aspiration to increase computational efficiency .",
    "embedding has also opened the door to combining different electronic structure methods into a single calculation , building a bridge between the worlds of wave function theory and density functional theory ( dft).@xcite    subsystem dft , also referred to as frozen density embedding ( fde ) theory ( see section [ sec : subsystem_dft ] for discussion ) , is closely related to the hirshfeld aim method,@xcite as both view the total density at each point of space as a sum of subsystem densities @xmath3 where the hirshfeld method handles each atom as a separate entity , fde partitions the subsystem into molecular fragments .",
    "though eq .",
    "( [ eq : rho ] ) does not seem to imply it at first sight , the partitioning also includes the division of space .",
    "the densities of the subsystems can overlap and , while they are in principle allowed to be delocalized over all space , in practice the initial guess is based on a chemically sensible representation which usually leads to a collection of weakly overlapping densities , centered around the nuclei of the subsystems.@xcite the``cutting '' of covalent bonds is avoided , since the description of the interaction between the subsystems relies on the use of approximate nonadditive kinetic energy functionals ( nake ) , which , at this point , still struggle with strongly overlapping densities.@xcite this through - space partitioning is the key to the simplification of the computational problem in fde , which allows to take advantage of computational techniques such as nearsightedness and the use of localized basis sets . in this sense fde",
    "succeeds in combining the two goals of deeper chemical insight and computational efficiency.@xcite    most embedding methods are developed to be used for ground state calculations , though recently several have been extended to the realm of time dependent methods.@xcite the first extensions have been made for the linear response formalism of time - dependent dft ( lr - tddft),@xcite a theory developed for the calculation of excited states that has increasingly gained in popularity in the last two decades.@xcite real - time time - dependent density functional theory ( rt - tddft ) , on the other hand , has only relatively recently came into the spot light,@xcite mostly due to its role as a stepping stone into the world of nonadiabatic dynamics .",
    "in contrast to lr - tddft , rt - tddft does not rely on the linear response formalism and is intrinsically able to describe the full response of the system to an applied perturbation.@xcite with the introduction of the kohn - sham dft ( ks - dft ) formalism and the adiabatic approximation ( see section [ subsystemrttddft ] for discussion ) it reduces to a non - linear integration in time of the time dependent kohn - sham ( tdks ) equations .",
    "while this can be computationally demanding , as it requires very small time steps and long simulation times , it has the advantage of scaling as @xmath4 . while this implies that linear scaling techniques can be applied as in the case of ground state ks , one must be cautious with introducing numerical errors as they can accumulate during the long simulation process .",
    "the integration of rt - tddft in embedding methods has only started recently and , until this work , was limited to the exact embedding methods@xcite the spirit of these methods is very different from fde , as they require a precalculated total density , aiming at combining different computational methods .",
    "here we present a new formulation of subsystem rt - tddft and show ( see section [ eet ] for discussion ) that combining rt - tddft with a subsystem approach can offer a view into the process of excitation energy transfer , which can not be obtained straightforwardly from standard rt - tddft calculation.@xcite additionally , subsystem rt - tddft readily provides information about the role of coupling between the subsystems in the reproduction of optical absorption spectra , a question that has been raised before in lr - tddft applications.@xcite",
    "in this section we will review the fundamentals of subsystem dft before extending the formalism to rt - tddft . in subsystem dft",
    "the partitioning of the total system into subsystems is made at the density level [ eq .  ( [ eq : rho ] ) ] . in dft ,",
    "the density is the central quantity and is used to formulate the variational principle for the ground state energy of the system @xmath5=\\min_{\\rho \\rightarrow n}\\left ( f[\\rho ] + \\int v_{ext}(\\mathbf{r})\\rho(\\mathbf{r } ) \\right).\\ ] ] where , using levy s constrained search , @xmath6 is restricted to be @xmath7-representable , @xmath8 is the external potential due to the electron - nuclei interaction and @xmath9 $ ] is the universal functional . @xmath9 $ ] is defined as @xmath10 = t[\\rho ] + w[\\rho ] = t_s[\\rho ] + j[\\rho ] + e_{xc}[\\rho]\\ ] ] where @xmath11 $ ] is the kinetic energy and @xmath12 $ ] is the electron - electron interaction .",
    "$ ] can also be rewritten using the noninteracting kinetic energy @xmath13 $ ] , the coulomb energy @xmath14 $ ] and the exchange - correlation energy @xmath15 $ ] , defined as the difference between @xmath11 $ ] and @xmath13 $ ] and @xmath12 $ ] and @xmath14 $ ] . in the case of ks - dft , the density @xmath6 is mapped to a set of @xmath7 non - interacting electrons represented by a single slater determinant consisting out of the ks orbitals @xmath16 and is given , for closed - shell systems , by @xmath17 this allows to rewrite the energy expression as @xmath18)=\\min_{\\phi}\\left(t_s[\\{\\phi_i\\}]+ \\int v_{eff}(\\mathbf{r})\\rho(\\mathbf{r})\\right).\\ ] ] where the noninteracting kinetic energy is now expressed exactly using the ks orbitals @xmath19 = \\sum_{i=1}^{n } \\braket{\\phi_i |-\\frac{1}{2}\\nabla^2 | \\phi_i},\\ ] ] and all electron - electron interaction terms are stacked away in an _ effective _ potential @xmath20}{\\delta \\rho(\\mathbf{r } ) } + \\frac{\\delta e_{xc}[\\rho]}{\\delta \\rho(\\mathbf{r})}\\ ] ] minimizing @xmath21 $ ] with respect to the ks orbitals is thus achieved by @xmath22 -   \\sum_{ij}^n\\epsilon_{ij}\\left(\\int\\phi_i^*(\\mathbf{r})\\phi_j(\\mathbf{r})d\\mathbf{r}-\\delta_{ij}\\right)\\right]=0 , ~ \\forall k\\ ] ] which leads to the one - electron ks equations @xmath23\\phi_i(\\mathbf{r})=\\epsilon_i\\phi_i(\\mathbf{r})\\ ] ]    when the total density is decomposed into a sum of subsystem densities @xmath24 [ eq .  ( [ eq : rho ] ) ] , the total energy functional @xmath21 $ ] can be rewritten as @xmath25=e[\\{\\rho_i\\}]=\\sum_i\\int   v_{ext}(\\mathbf{r})\\rho_i(\\mathbf{r})d\\mathbf{r}+\\sum_i\\sum_j\\int\\int\\frac{\\rho_i(\\mathbf{r})\\rho_j(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r } d\\mathbf { r } ' + t_s",
    "\\left [ \\sum_i\\rho_i \\right]+e_{xc}\\left[\\sum_i\\rho_i\\right],\\ ] ] where the external potential term is additive , the coulomb repulsion term is pairwise additive and the kinetic energy and exchange correlation energy are nonadditive .",
    "the nonadditive density functionals can be rewritten as @xmath26&= \\sum_ik\\left[\\rho_i\\right ] + \\left(k\\left[\\rho\\right]-\\sum_ik\\left[\\rho_i\\right]\\right ) = \\sum_ik\\left[\\rho_i\\right ] + k^{nadd}\\left[\\{\\rho_i\\}\\right]\\end{aligned}\\ ] ] if the division into subsystem densities is done in such a way that each one is _",
    "noninteracting v_-representable , then they can be viewed as separate ks subsystems , each mapped to an effective ks potential and a set of subsystem ks orbitals @xmath27 .",
    "the additive part of the noninteracting kinetic energy functional in eq .",
    "( [ eq : k ] ) can then be expressed exactly using the subsystem orbitals @xmath28= \\sum_{i=1}^{n_i } \\braket{\\phi_i^i | -\\frac{1}{2}\\nabla^2 | \\phi_i^i}$ ] , while the nonadditive part is expressed using a kinetic energy functional @xmath29 $ ] . in the spirit of ks , all other terms in eq .",
    "( [ eq : e ] ) are gathered together in the subsystem effective potential @xmath30 after taking a functional derivative to @xmath31 @xmath32}{\\delta\\rho(\\mathbf{r } ) } + \\frac{\\delta e_{xc}[\\rho]}{\\delta \\rho(\\mathbf{r } ) } +   \\frac{\\delta\\tilde{t}_s[\\rho]}{\\delta\\rho(\\mathbf{r})}-\\frac{\\delta\\tilde{t}_s[\\rho_i]}{\\delta\\rho_i(\\mathbf{r})}\\ ] ] minimizing the energy of the total system is then replaced by a set of coupled minimizations @xmath33).\\ ] ] each of the minimizations is equivalent to @xmath34 -   \\sum_{ij}\\epsilon_{ij}^i\\left[\\int\\phi_i^{*i}(\\mathbf{r})\\phi^{i}_j(\\mathbf{r})d\\mathbf{r}-\\delta_{ij}\\right]\\right)=0\\ ] ] which leads to a set of coupled subsystem ks equations @xmath35\\phi_i^i(\\mathbf{r})=\\epsilon_i^i\\phi_i^i(\\mathbf{r})\\ ] ]    derivation of the subsystem ks equations depends on the following constraints for each subsystem @xmath36 :    1 .",
    "[ constraint1]the density is _ noninteracting pure - state v - representable _ ( @xmath37-representable ) .",
    "[ constraint2 ] @xmath38 , to insure that @xmath39 and @xmath40 .    due to constraint",
    "[ constraint2 ] , eqs .",
    "( [ eq : coupledks ] ) are solved iteratively through `` freeze - and - thaw '' cycles,@xcite where the energy is minimized with respect to subsystem @xmath36 while keeping the densities of all other subsystems frozen . at self consistency , the energy is minimized with respect to the variation of all subsystem densities and therefore also the total density .    the subsystem effective potential in eq .",
    "( [ eq : veffi ] ) can be rewritten as the ks potential of the total system plus the nonadditive kinetic energy potential @xmath41}{\\delta\\rho(\\mathbf{r})}-\\frac{\\delta\\tilde{t}_s[\\rho_i]}{\\delta\\rho_i(\\mathbf{r})}\\ ] ] where we use the notation @xmath42 to emphasize that an approximate density functional is used . in case of the exact kinetic energy",
    "functional @xmath13 $ ] the subsystem effective ks potential would reduce to the exact ks potential associated with the embedded density @xmath43 plus a constant @xmath44 where we used the relationship@xcite @xmath45}{\\delta\\rho(\\mathbf{r } ) } = \\mathrm{const } - v_{eff}^{ks}(\\mathbf{r})\\ ] ] in other words , in the limit of exact nake , fde reproduces the exact density and ks orbitals of the embedded fragment .",
    "however , in practice , approximate nake functionals are used for the nonadditive kinetic energy and the subsystem ks effective potential differs from the the exact ks potential by@xcite @xmath46}{\\delta\\rho(\\mathbf{r})}-\\frac{\\delta\\tilde{t}_s[\\rho]}{\\delta\\rho(\\mathbf{r})}+ \\frac{\\delta t_s[\\rho_i]}{\\delta\\rho_i(\\mathbf{r})}-\\frac{\\delta\\tilde{t}_s[\\rho_i]}{\\delta\\rho_i(\\mathbf{r})}\\ ] ] the performance of the approximate nake is therefore essential for the reproduction of the densities of the embedded fragment and , as a result , also the total supermolecular density .    during the freeze - and - thaw ( fat ) cycles , the density of subsystem @xmath36 is being repeatedly optimized , each time in the presence of a different frozen density constraint . at each fat cycle , the self consistency corresponding to a different ks potential @xmath47 is found .",
    "this process can be considerably sped up by updating the ks potential after each scf cycle.@xcite since the self - consistency point is well defined , both approaches lead to the same result .",
    "subsystem dft has been shown to perform well for systems where the density can be partitioned between non - covalently bonded systems , i.e. , systems interacting through electrostatics , van der waals forces and hydrogen bonds.@xcite covalently bonded fragments , as well as systems with partial charge transfer character , remain a challenge for subsystem dft until more accurate nake are developed.@xcite when applied to systems with clearly separated fragments , subsystem dft offers the advantage of providing us with a chemically sensible approximation of the density and properties of _ embedded _ systems .",
    "the embedding potential , given below , represents the difference between the ks potential of the noninteracting fragment , @xmath48 ( i.e. , evaluated with the density of the embedded fragment but not including the interaction with the environment ) , and the effective ks potential of the embedded subsystem @xmath49 . as a result",
    ", it contains the full information about the interaction and coupling between the subsystems . @xmath50",
    "the central point of the derivation of subsystem dft for the ground state is the variational principle , i.e. , minimization of the total energy of the system with respect to the density of each subsystem .",
    "in contrast to the ground state case , there is no such minimum principle for the time dependent problem and therefore no unique way to derive the time evolution of a system .",
    "a possible route is to use the stationary action principle which states that the variation of the quantum mechanical action @xmath51 , defined as : @xmath52=\\int_{t_0}^{t_1}dt \\braket{\\psi(t ) | i\\frac{\\partial}{\\partial t } - \\hat{h}(t ) | \\psi(t)}\\ ] ] should be zero . in eq .",
    "( [ eq : a ] ) , @xmath53 is the full molecular hamiltonian that includes the time - dependent applied potential and @xmath54 is the electronic wavefunction . by imposing the boundary conditions that @xmath55",
    "one recovers the time - dependent schrdinger equation @xmath56    since the introduction of the runge - gross theorem,@xcite there has been ongoing discussion whether the stationary action principle can be carried over straightforwardly to tddft . in tddft , the ( fully interacting ) quantum state @xmath54 is a functional of the time dependent density @xmath57 , making the action a density functional as well .",
    "@xmath58&=\\int_{t_0}^{t_1}dt \\braket{\\psi[\\rho](t ) | i\\frac{\\partial}{\\partial t } - \\hat{h}(t ) | \\psi[\\rho](t ) } \\\\   & = \\int_{t_0}^{t_1}dt   \\braket{\\psi[\\rho](t ) | i\\frac{\\partial}{\\partial t } - \\hat{t } - \\hat{w } | \\psi[\\rho](t ) } -   \\int_{t_0}^{t_1}dt\\int   d\\mathbf{r}\\rho(\\mathbf{r},t)v_{ext}(\\mathbf{r},t)\\end{aligned}\\ ] ] as was shown by van leeuwen,@xcite the density @xmath57 which evolves in an interacting system under the influence of an external potential @xmath59 starting from an initial state @xmath60(t_0)$ ] can be reproduced in a ks noninteracting system evolving under the action of an effective potential @xmath61 starting from an initial state @xmath62(t_0)$ ] , where @xmath62 $ ] is the single slater determinant representing the noninteracting system .",
    "@xmath63 & = \\int_{t_0}^{t_1}dt \\braket{\\phi[\\rho](t ) | i\\frac{\\partial}{\\partial t } - \\hat{h}_s(t ) | \\phi[\\rho](t ) } \\notag",
    "\\\\   & = \\int_{t_0}^{t_1}dt \\braket{\\phi[\\rho](t ) | i\\frac{\\partial}{\\partial t } - \\hat{t}_s | \\phi[\\rho](t ) } -   \\int_{t_0}^{t_1}dt\\int   d\\mathbf{r}\\rho(\\mathbf{r},t)v_s(\\mathbf{r},t)\\end{aligned}\\ ] ] the difference @xmath64 defines the time dependent exchange - correlation potential @xmath65 .",
    "the term @xmath59 contains here both the nucleus - electron interaction as well as any applied time - dependent field in the form of @xmath66 where @xmath67 represents a step function .",
    "the variation of the tddft action is unfortunately not as simple a matter as in the wave function formulation of the theory .",
    "since the action is a density functional , one needs to take the variation with respect to the density .",
    "the boundary conditions are , however , not transferable .",
    "one can still require @xmath68}{\\delta \\rho(\\mathbf{r},t)}$ ] to be zero for @xmath69 but not for @xmath70 , since a variation in @xmath6 at a time @xmath71 can and will change the quantum state @xmath62 $ ] at time @xmath70 .",
    "the ( not longer that ) stationary action principle can then be rewritten as @xmath72 - i \\braket{\\psi[\\rho](t_1 ) |",
    "\\delta \\psi[\\rho](t_1 ) } =   \\delta \\mathcal{a}_s[\\rho ] - i \\braket{\\phi[\\rho](t_1 ) | \\delta",
    "\\phi[\\rho](t_1 ) } = 0\\ ] ] the problem is circumvented in the usual spirit of ks - dft by shifting the unknown terms into the exchange - correlation potential , explicitly defined as @xmath73}{\\delta\\rho(\\mathbf{r},t ) } + i \\frac{\\braket{\\psi[\\rho](t_1 ) |",
    "\\delta \\psi[\\rho](t_1)}}{\\delta\\rho(\\mathbf{r},t)}- i   \\frac{\\braket {   \\phi[\\rho](t_1 ) |",
    "\\delta \\phi[\\rho](t_1)}}{\\delta\\rho(\\mathbf{r},t)}\\ ] ] in practical calculation , one usually resorts to the adiabatic approximation , which simplifies the time - dependent exchange - correlation potential to the ground state exchange correlation potential evaluated at the time dependent density .",
    "@xmath74=\\left.\\frac{\\delta e_{xc}[\\rho]}{\\delta \\rho}\\right|_{\\rho=\\rho(\\mathbf{r},t)}\\ ] ] as a consequence , the extra terms in eq .",
    "( [ eq : xct ] ) vanish , the density time dependence is reduced to instantaneous and causality is trivially fulfilled .",
    "the familiar one - electron time dependent ks equations ( tdks ) take the form @xmath75\\phi_i(\\mathbf{r},t)=i\\frac{\\partial}{\\partial t}\\phi_i(\\mathbf{r},t)\\ ] ] where @xmath76 are the noninteracting ks one - electron orbitals constituting the single slater determinant @xmath77(t)$ ] and yielding the time dependent density @xmath57 once a solution to the ground state coupled subsystem ks equations [ eq .",
    "( [ eq : coupledks ] ) ] has been obtained , we can define an action principle for each of the subsystems @xmath36 .",
    "each subsystem is represented by a single slater determinant @xmath78 $ ] , which is a functional of the subsystem density @xmath79 .",
    "namely , @xmath80 = & \\int_{t_0}^{t_1}dt \\braket{\\phi[\\rho_i](t ) | i\\frac{\\partial}{\\partial t } - \\hat{t}_s |   \\phi[\\rho_i](t ) } - \\int_{t_0}^{t_1}dt\\int d\\mathbf{r}\\rho_i(\\mathbf{r},t)v_{s}^{i}(\\mathbf{r},t),\\end{aligned}\\ ] ] where , in accordance with the adiabatic approximation , @xmath81 is defined as : @xmath82}{\\delta\\rho(\\mathbf{r},t ) } + \\frac{\\delta e_{xc}[\\rho]}{\\delta \\rho(\\mathbf{r},t ) }   +   \\frac{\\delta\\tilde{t}_s[\\rho]}{\\delta\\rho(\\mathbf{r},t)}-\\frac{\\delta\\tilde{t}_s[\\rho_i]}{\\delta\\rho_i(\\mathbf{r},t)}\\ ] ] and is equal at @xmath83 to the @xmath47 in eq .",
    "( [ eq : coupledks ] ) at self consistency .",
    "we note that only @xmath59 contains an explicit time dependence while the other terms depend on time through the density . in the limit case of exact nake , the sum of the subsystem actions [ eq .",
    "( [ eq : ai ] ) ] will reduce to the total ks action [ eq .",
    "( [ aq ] ) ] . taking the variation of each subsystem action allows us to obtain the subsystem tdks equations @xmath84\\phi_i^i(\\mathbf{r},t)=i\\frac{\\partial}{\\partial t}\\phi_i^i(\\mathbf{r},t)\\ ] ]    in order to reproduce the total ks action , it is imperative to integrate the subsystem tdks equations _",
    "simultaneously_. the subsystem action , as defined in eq .",
    "( [ eq : ai ] ) , represents the _ coupled _ action , since the subsystem potential @xmath85 depends on the total time dependent density @xmath86 of the system .",
    "if the applied time dependent potential to the system is sufficiently small , one can draw a parallel to the subsystem formulation of linear response tddft , where the coupled response function of the subsystem @xmath87 , is connected to the coupled response functions of all the other subsystems through a dyson - type equation ( in simplified notation)@xcite @xmath88 where @xmath89 . as in the case of subsystem formulation of linear response tddft , one can also define an equivalent to the uncoupled response of the subsystem @xmath90@xcite @xmath91 where @xmath92 is the subsystem ks response function .",
    "this is achieved by defining the uncoupled subsystem action , where the density of the other subsystems are kept frozen and eq .",
    "( [ eq : tdks ] ) is only evolved in time for the subsystem in question . as we will show in section [ sec : opt ] , examining the difference in subsystem properties between the coupled calculations and the uncoupled calculation reveals first hand information on the excitation coupling between the subsystems .",
    "it is also important to note that the embedding potential is never fully static also in the uncoupled calculations , as it depends on the total electron density which varies in time even when the other subsystems are kept frozen .",
    "the subsystem rt - tddft method was implemented into the quantum espresso package as an extension of the periodic subsystem dft@xcite using plane waves , the details of which can be found in ref .   .",
    "in this work we only report calculations involving molecular systems using the @xmath93 point sampling for the brillouin zone .",
    "all calculations have been performed using ultrasoft pseudopotentials@xcite .",
    "ultrasoft pseudopotentials can be seen as a special case of the projector augmented wave ( paw ) method@xcite which reformulates the ks equations in terms of auxiliary smooth functions @xmath94 to the true one - electron ks orbitals through a linear transformation operator @xmath95 . as a result ,",
    "the orthogonality of the original ks orbitals is replaced by the orthogonality of the pseudo functions with respect to the overlap operator @xmath96 @xmath97 and the expectation value of any local operator is given by @xmath98 the ks eigenvalue equation transforms then into a generalized eigenvalue equation @xmath99 where the transformed hamiltonian @xmath100 contains extra local and non - local pseudopotential projectors . in the time - dependent case ,",
    "also the @xmath101 operator needs to be transformed @xmath102 which leads to @xmath103 the additional operator @xmath104 depends on the velocities of the nuclei and for tddft calculations with immobile ions is identical to zero . when integrating the rt - tddft method into ehrenfest dynamics calculations with mobile atoms , explicit calculation of the @xmath105 operator is necessary.@xcite for the time propagation of eq .",
    "( [ ultratdks ] ) , we use the first - order crank - nicolson method,@xcite where the ks orbitals are calculated at each time step from @xmath106\\phi_i^{ps}(t+\\delta t ) =   \\left[\\hat{s}-\\frac{i}{2}\\hat{h}_s^{ps}\\left(t+\\frac{\\delta   t}{2}\\right)\\delta   t\\right]\\phi_i^{ps}(t).\\ ] ] since we are using plane wave basis sets , the dimension of @xmath107 and @xmath108 matrices is usually too large to allow a numerically stable inversion and eq .",
    "( [ crank ] ) is solved using the conjugated gradient square method .",
    "the advantage of the crank - nicolson method for the time propagation is the explicit norm conservation of the wave function .",
    "since we are using the first order version of the method , we forgo the predictor - corrector step and approximate @xmath109 by @xmath107 .",
    "thus , very small time steps must be used and in all calculations presented here we have used the @xmath110 attoseconds .",
    "as a first application of the novel method , we will consider the calculation of an optical spectrum between two coupled chromophores .",
    "an optical spectrum can be obtained by applying a time dependent electric field to the system such that it samples all frequencies . in order to sample all frequencies equivalently",
    ", the electric field has ideally the form of a @xmath111-function , @xmath112 .",
    "this can be done in two ways : one is adding an electric field in the form of a very narrow gaussian .",
    "the potential that is added to the periodic hamiltonian of the system and multiplied in real space with a saw function , which drops from 1 to 0 in the part of the supercell furthest away from the nuclei .",
    "the second way is particularly suited for periodic systems : it prescribes to multiply the occupied ks states by a phase@xcite @xmath113 where @xmath114 is the field . for molecular calculations ,",
    "both methods result in identical time evolution of the dipole moment provided that the gaussian pulse integrates to the field strength @xmath115 .",
    "the dipole moment is calculated at each time step using @xmath116 the oscillator strength is obtained by a fourier transformation of the time - dependent dipole moment into the frequency domain . @xmath117\\ ] ] @xmath118=-\\frac{2}{e_k}\\int \\sin(\\omega t)e^{-\\gamma t^2}[\\mu_{k}(t)-\\mu_{k}(t_0)]dt\\ ] ] where @xmath119 stands for one of the cartesian directions @xmath120 or @xmath121 and @xmath122 is a small damping factor.@xcite we choose here a gaussian damping function rather than the usual exponential as it produces cleaner spectra . as a result , the shape of the spectral bands is no longer lorentzians . in a subsystem calculation ,",
    "the field is applied to each subsystem and the total optical spectrum of the system is obtained by summing the oscillator strengths of the subsystems because @xmath123    we have calculated the optical spectra of a parallel - stacked benzene fulvene dimer ( fig .",
    "[ fig : benzene - fulvene ] ) .",
    "the dimers were constructed by placing the relaxed monomers along the z - axis with an intermolecular distance of @xmath124 , @xmath125 , @xmath126 , @xmath127 and @xmath128  .",
    "the pbe functional@xcite and the ultrasoft pseudopotentials from the gbrv library@xcite where used throughout .",
    "for all calculations , a supercell of dimensions @xmath129 a.u.@xmath130 was used with a kinetic energy cutoff of @xmath131 ry and density cutoff of @xmath132 ry .",
    "each rt - tddft calculation was run for @xmath133 femtoseconds with a time step of @xmath110 attoseconds .",
    "the simulation time was tested for convergence by performing the fourier transformation after each femtosecond until no differences in the resulting optical spectra were observed .",
    "the isolated monomers were calculated using the same supercell and cutoff . in the subsystem calculations , the lc94@xcite functional for the nonadditive kinetic energy",
    "was used throughout .",
    "[ fig : benzene - fulvene ]    table [ tab : eint ] lists the interaction energy in the dimer obtained using ks - dft and subsystem dft for the range of separation distances and the number of electrons misplaced by fde , @xmath134 defined as@xcite @xmath135 where @xmath136    .the interaction energy in the benzene - fulvene dimer calculated using ks - dft and subsystem dft and the number of misplaced electrons [ eq .   ( [ eq : deltarho ] ) ] for the different intermolecular distances [ cols=\"<,^,^,^ \" , ]",
    "we presented an extension of the subsystem dft method to real - time tddft . in the new method , the electron density is evolved in time alongside a time dependent potential as a collection of time - dependent subsystem electron densities .",
    "the implementation is such that one can choose between evolving only one of the subsystems in time while keeping the other subsystems frozen at the initial time @xmath69 ( uncoupled simulation ) or evolving all subsystems simultaneously ( coupled simulation ) .",
    "the former choice will only include the response of the excitations within the subsystem , while the latter will include all the couplings between all of the subsystems .",
    "the method was first applied to obtain optical absorption spectra of a benzene - fulvene dimer , where similar accuracy w.r.t .",
    "supramolecular dft calculations were found as for the case of ground state fde and lr - tddft fde applications . for shorter distances ,",
    "the optical absorption spectra start to diverge from the supramolecular calculations due to the known failure of nake functionals , while for intermediate and long distances the supramolecular results are reproduced with good accuracy .    the choice between performing a coupled and an uncoupled calculation presented the opportunity to examine the effect of the excitation coupling between the subsystems on the reproduction of optical absorption spectra .",
    "a clear and consistent effect is seen on the interaction induced shift and the oscillator strength when omitting the full coupling of the subsystems , for the coupled excitations .",
    "since we only examined a pair of nonidentical chromophores here , this effect is limited and we were able to confirm the previous findings@xcite that subsystem lr - tddft is able to reproduce the supramolecular results for most systems while neglecting the intersubsystem coupling .",
    "as a second application , the real - time excitation energy transfer was studied in a na@xmath0 cluster , where only one of the na@xmath137 was subjected to a periodic electric field with a frequency of a coupled excitation energy .",
    "we found that the embedding potential is fully capable of transmitting the excitation energy between the subsystems and that the rate of the excitation energy transfer coincided with the frster theory prediction .",
    "the ability to represent the real - time dynamics of excitation energy transfer ( eet ) between subsystems is an important finding of this work .",
    "the ability to generate diabatic states for eet in a way that resembles most the true experiments ( i.e. , via an applied field ) is of pivotal importance , complementing the linear - response theories .",
    "future directions towards extending the method to period systems and to the inclusion of nuclear dynamics ( ehrenfest ) are undergoing .",
    "r.  van leeuwen , n.  e. dahlen , g.  stefanucci , c .- o .",
    "almbladh , and u.  von barth , , in _ time - dependent density functional theory _ , edited by m.  a.  l. marques , c.  a. ullrich , f.  nogueira , a.  rubio , k.  burke , and e.  k.  u. gross , pages 3359 , springer , berlin , 2006 ."
  ],
  "abstract_text": [
    "<S> we present the extension of frozen density embedding ( fde ) theory to real - time time dependent density functional theory ( rt - tddft ) . </S>",
    "<S> fde a is dft - in - dft embedding method that allows to partition a larger kohn - sham system into a set of smaller , coupled kohn - sham systems . </S>",
    "<S> additional to the computational advantage , fde provides physical insight into the properties of embedded systems and the coupling interactions between them . </S>",
    "<S> the extension to rt - tddft is done straightforwardly by evolving the kohn - sham subsystems in time simultaneously , while updating the embedding potential between the systems at every time step . </S>",
    "<S> two main applications are presented : the explicit excitation energy transfer in real time between subsystems is demonstrated for the case of the na@xmath0 cluster and the effect of the embedding on optical spectra of coupled chromophores . in particular , the importance of including the full dynamic response in the embedding potential is demonstrated . </S>"
  ]
}