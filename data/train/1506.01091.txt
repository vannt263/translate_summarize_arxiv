{
  "article_text": [
    "what features of an edge - weighted tree identify it uniquely up to isomorphism , perhaps within some class of such trees ? here an _ edge - weighted tree _ is a connected , acyclic finite graph @xmath0 with vertex set @xmath8 and edge set @xmath9 which is equipped with a function @xmath10 .",
    "the value of @xmath11 for an edge @xmath12 is called the _ weight _ or the _ length _ of @xmath13 .",
    "two such trees @xmath14 and @xmath15 are isomorphic if there is a bijection @xmath16 such that :    * @xmath17 if and only if @xmath18 , * @xmath19 for all @xmath17 .",
    "the question above is , more formally , one of asking for a given class of edge - weighted trees @xmath20 about the possible sets @xmath21 and functions @xmath22 such that for all @xmath23 we have @xmath24 if and only if @xmath14 and @xmath15 are isomorphic .",
    "if the class @xmath20 consists of edge - weighted trees for which all edges have length @xmath25 ( we will call such objects _ combinatorial trees _ for the sake of emphasis ) , then determining whether two trees in @xmath20 are isomorphic is just a particular case of the standard graph isomorphism problem .",
    "the general graph isomorphism problem has been the subject of a large amount of work in combinatorics and computer science ",
    "@xcite already speaks of the `` graph isomorphism disease ''  and , in particular , there are many results on reconstructing the isomorphism type of a graph from the isomorphism types of subgraphs of various sorts ( see , for example , the review @xcite ) .",
    "there is also a substantial volume of somewhat parallel research on graph isomorphism in computational chemistry ( see , for example , @xcite for a review ) .",
    "there seems to be considerably less work on determining isomorphism ( in the obvious sense ) of edge - weighted graphs ; of course , in order for two edge - weighted graphs to be isomorphic the underlying combinatorial graphs must be isomorphic , but this does not imply that the best way for checking that two edge - weighted graphs are isomorphic proceeds by first determining whether the underlying combinatorial graphs are isomorphic and then somehow testing whether some isomorphism of the combinatorial graphs is still an isomorphism when the edge - weights are considered .",
    "we begin with a discussion of previous results that address various aspects of the problem of determining when two edge - weighted or combinatorial trees are isomorphic .",
    "a result in @xcite gives the following criterion for a bijection @xmath16 , where @xmath14 and @xmath15 are combinatorial trees , to be an isomorphism : + if @xmath26 is any sequence from @xmath27 such that @xmath28 and @xmath29 then @xmath30 .",
    "the above result is elegant , but , of course , one does not need to apply it to all possible bijections to determine whether two combinatorial trees are isomorphic : there is a much more explicit and efficient procedure , which we now describe for the sake of completeness . first of all , suppose that @xmath14 and @xmath15 have distinguished vertices @xmath31 and @xmath32 and , in addition to the requirements in the above definition of an isomorphism @xmath33 , we require that @xmath33 maps @xmath31 to @xmath32 ; that is , we have rooted trees and we require that an isomorphism maps the root of one tree to the root of the other .",
    "the presence of a root allows us to think of a combinatorial tree as a directed graph , where the head of an edge is the vertex that is closer to the root and the tail is the vertex farther from the root .",
    "the children of a vertex are the adjacent vertices that are farther from the root and , more generally , the descendants of a vertex @xmath34 are those vertices @xmath35 such that the path from the root to @xmath35 passes through @xmath34 .",
    "the subtree spanned by a vertex @xmath34 and its descendants contains no other vertices and can be thought of as a combinatorial tree rooted at @xmath34 , and we call this subtree the subtree below @xmath34 .",
    "then , two rooted , combinatorial trees @xmath14 and @xmath15 are isomorphic if the two roots have the same number of children , say @xmath36 , and there is an ordering of these children for each tree such that the subtree below the @xmath37 child of the root of @xmath14 is isomorphic ( as a rooted , combinatorial tree ) to the subtree below the @xmath37 child of the root of @xmath15 .",
    "this observation can be turned into an efficient algorithm ( see , for example , ( * ? ? ?",
    "* example 3.2 ) ) .",
    "now , two combinatorial trees are isomorphic if there is some choice of roots such the resulting rooted , combinatorial trees are isomorphic .",
    "a _ center _ of a combinatorial tree is a vertex @xmath38 such that @xmath39 where @xmath40 is the number of edges in he unique path between @xmath34 and @xmath35 for @xmath41 , and a combinatorial tree has either a unique center or two centers that are adjacent .",
    "it is therefore possible to determine if two combinatorial trees are isomorphic by rooting each of them at their various centers and checking if any two such rooted , combinatorial trees are isomorphic .    we , however , are interested in whether there are `` statistics '' of a more numerical character that can be used to decide tree isomorphism . for combinatorial trees ,",
    "one somewhat obvious possibility is the multiset of eigenvalues of some matrix associated with the tree such as the adjacency matrix or the distance matrix .",
    "unfortunately , the results of @xcite show that not only is the isomorphism type of a tree not uniquely determined by the spectrum of its adjacency matrix but for various ensembles of combinatorial trees if one picks a tree uniformly at random from those in the ensemble with @xmath1 vertices , then the probability there is another tree in the ensemble with an adjacency matrix that has the same spectrum converges to one as @xmath42 .",
    "the results of @xcite can be used to show that an analogous phenomenon is present when one considers the spectrum of the matrix of leaf - to - leaf distances .",
    "two trees have adjacency matrices with the same spectrum if and only if the characteristic polynomials of the adjacency matrices are equal . given some irreducible representation of the symmetric group on the number of letters equal to the dimension of a square matrix , the immanantal polynomial of the matrix is constructed in the same manner as the characteristic polynomial except that the determinant is replaced by a similarly defined object for which the sign character is replaced by the character of the representation .",
    "one might hope that the immanantal polynomials are more successful at deciding isomorphism of combinatorial trees , but a result of @xcite shows that if the adjacency matrices of two combinatorial trees have the same characteristic polynomials , then they have the same immanantal polynomials for every irreducible representation .",
    "we note that @xcite already contains an example of two combinatorial trees with adjacency matrices that are explicitly shown to have the same immanantal polynomial .",
    "the greedoid tutte polynomial of a combinatorial tree @xmath0 encodes for each @xmath43 and @xmath44 the number of subtrees of @xmath0 that have @xmath43 internal vertices and @xmath44 leaves .",
    "it was conjectured in @xcite that this information identifies the isomorphism type of a combinatorial tree . however , it was shown in @xcite that there are infinitely many pairs of nonisomorphic caterpillars that share the same greedoid tutte polynomial : a caterpillar is a combinatorial tree that consists of some number of internal vertices along a single path and leaves that are each adjacent to one of the internal vertices .",
    "this contrasts with the situation for rooted , combinatorial trees ; it is shown in @xcite that there is a two - variable polynomial defined for all rooted , directed graphs ( and hence , in particular , for rooted , combinatorial trees ) such that two rooted , combinatorial trees have the same polynomial if and only if they are isomorphic .",
    "the polynomial in @xcite is defined recursively , but it is not hard to see that it encodes in a compact manner the total number of vertices in the tree , the number of children of the root , the number of vertices in each of the subtrees below the children of the root , and so on .",
    "the chromatic symmetric function of a graph was introduced in @xcite .",
    "a proper coloring of a finite graph is a function @xmath45 from the vertices of the graph to @xmath46 such that adjacent vertices are assigned different values .",
    "we can introduce an equivalence relation on the proper colorings by declaring that two colorings @xmath47 and @xmath48 are equivalent if there is a bijection @xmath49 such that @xmath50 . for a graph with @xmath36 vertices , each equivalence class gives rise to a partition @xmath51 of @xmath36 by taking , for any @xmath45 in the equivalence class , @xmath52 to be the @xmath37 largest of the cardinalities @xmath53 as @xmath54 ranges over @xmath46 .",
    "the chromatic symmetric function encodes for each partition of @xmath36 the number of equivalence classes of colorings that give rise to that partition .",
    "it was conjectured in @xcite that nonisomorphic combinatorial trees have distinct chromatic symmetric functions .",
    "it was shown in @xcite that this conjecture is true for caterpillars and that paper also reports on computational results verifying that the conjecture holds for the class of trees with at most @xmath55 vertices .",
    "further work related to the conjecture for the special case of trees with a single centroid is contained in @xcite .",
    "our point of departure in this paper is the well - known fact @xcite that an edge - weighted tree can be reconstructed from its matrix of leaf - to - leaf distances ( see @xcite for an indication of the importance of this observation in the statistical reconstruction of phylogenetic trees ) .",
    "in fact , an edge - weighted tree with @xmath1 leaves can be reconstructed from the collection of total lengths of subtrees spanned by all subsets of @xmath36 leaves provided @xmath56 @xcite .",
    "we remark that the total length of the subtree spanned by a set of leaves is an important quantity in phylogenetics where it is called the phylogenetic diversity of the corresponding set of taxa @xcite .    given these results",
    ", one might imagine that the multiset of leaf - to - leaf distances suffices to identify the isomorphism type of an edge - weighted tree .",
    "this is certainly not the case .",
    "for example , consider the two combinatorial caterpillars @xmath14 and @xmath15 with @xmath57 leaves each , where @xmath14 has @xmath58 internal vertices @xmath59 in order along a path that are adjacent respectively to @xmath60 leaves , and @xmath15 has @xmath58 internal vertices @xmath61 in order along a path that are adjacent respectively to @xmath62 leaves .",
    "taking the @xmath63 pairs of distinct leaves in @xmath14 , we see that the distance @xmath64 appears @xmath65 times , the distance @xmath58 appears @xmath66 times , and the distance @xmath67 appears @xmath68 times . similarly , taking the @xmath63 pairs of distinct leaves in @xmath15",
    ", we see that the distance @xmath64 appears @xmath69 times , the distance @xmath58 appears @xmath70 times , and the distance @xmath67 appears @xmath71 times .",
    "probabilistically , we have just shown that if we pick two leaves uniformly at random without replacement from an edge - weighted tree , then the isomorphism type of the tree is not uniquely identified by the probability distribution of the distance between the two leaves .    note in this last example that if we looked at the multisets of lengths of subtrees spanned by three leaves , then we would see the length @xmath58 appearing @xmath72 times for @xmath14 and @xmath73 times for @xmath15 , and hence the probability distribution of the length of the subtree spanned by three leaves chosen uniformly at random is not the same for the two trees .    in order to proceed further",
    ", we need to introduce some more notation .",
    "write @xmath74 for the set of leaves of an edge - weighted tree @xmath0 . given a subset @xmath75 of @xmath74 ,",
    "let @xmath76 be the length of the subtree spanned by @xmath75 ; that is , @xmath76 is the sum of the lengths of the edges in the smallest connected subgraph of @xmath0 with a vertex set that contains @xmath75 .",
    "it is possible to calculate the total length of @xmath0 , that is , @xmath77 , using the following result from @xcite that extends one for the special case of @xmath58-valent trees in @xcite .",
    "write @xmath78 for the degree of an interior vertex @xmath35 of @xmath0 ( that is , @xmath79 ) .",
    "for distinct leaves @xmath80 denote by @xmath81 the set of interior vertices on the unique path in @xmath0 between @xmath82 and @xmath83 and put @xmath84 let @xmath85 be the sum of the lengths of the edges in the path between @xmath82 and @xmath83 .",
    "then , @xmath86 of course , a similar formula gives @xmath76 for any @xmath87 ; the path between a pair of leaves of the subtree is the same as the path between them in @xmath0 , the length of this path is the same in the subtree as it is in @xmath0 , but the degree of an interior vertex of the subtree can be less than its degree as an interior vertex of @xmath0 .",
    "suppose that @xmath88 and @xmath89 is a uniformly distributed random listing of @xmath74 ; that is , @xmath89 is the result of sampling the leaves of @xmath0 uniformly at random without replacement .",
    "set @xmath90 for @xmath3 ; that is , the random variable @xmath2 is the length of the subtree spanned by the first @xmath4 of the randomly chosen leaves .",
    "we write @xmath91 for the @xmath92-dimensional random vector @xmath5 and call this random vector the _ random length sequence _ of @xmath0 .    in this paper",
    "we address the following question .    can we reconstruct the edge - weighted tree @xmath0 up to isomorphism from the joint probability distribution of the random length sequence @xmath93 ?",
    "[ q : main ]    another way of framing this question is the following .",
    "write @xmath94 for the leaves of @xmath0 and let @xmath95 be the multiset with cardinality @xmath96 that results from listing the @xmath92-dimensional vectors @xmath97 as @xmath98 ranges of the permutations of @xmath99:=\\{1,\\ldots , n\\}$ ] .",
    "we stress that @xmath95 is a multiset ; that is , we do not know which increasing sequences of lengths go with which ordered listings of the leaves .",
    "can we reconstruct the edge - weighted tree @xmath0 up to isomorphism from the multiset of length sequences @xmath95 ?",
    "we end this section with some remarks about the problem of reconstructing trees from various so - called _ decks _ , as this subject has some similarities to the questions we consider . in @xcite",
    ", ulam asked whether it is possible to reconstruct the isomorphism type of a graph with at least @xmath58 vertices from the isomorphism types of the subgraphs obtained by deleting each of the vertices .",
    "this question was resolved in the affirmative for combinatorial trees in @xcite .",
    "moreover , later results established that it is not necessary to know the forests obtained by deleting every vertex .",
    "for example , it was shown in @xcite that it suffices to know the subtrees obtained by deleting leaves .",
    "this latter result was strengthened in @xcite , where it was found that it is only necessary to know which nonisomorphic forests are obtained and not what the multiplicity of each isomorphism type is , and in @xcite , where it was shown that it suffices to take only those leaves @xmath100 that are _ peripheral _ in the sense that @xmath101 along the same lines , it was established in @xcite that it is enough to take only the nonleaf vertices , provided that there are at least three of them .",
    "the line of inquiry in @xcite is the most similar to ours : an example was presented of two trees for which the respective sets of vertices may be paired up in such a way that for each pair the sizes of the trees in the forests produced by removing each element of the pair from its tree are the same , and a necessary and sufficient condition was given for a tree to be uniquely reconstructible from this sort of data , which the authors of @xcite call the _ number deck _ of the tree .",
    "we will answer question  [ q : main ] in the affirmative for a few different classes of trees .",
    "some classes will have general edge - weights and some classes will be combinatorial trees .",
    "it is clear that in the case of general edge - weights we must restrict to trees that have no vertices with degree @xmath64 because otherwise we can subdivide any edge into arbitrarily many edges with the same total length and the joint probability distribution of the random length sequence will be unchanged  see .",
    "we call such trees _ simple_. the terms irreducible or homomorphically irreducible are also used in the literature .",
    "our first result is for the the class of _ stars _ ; that is , edge - weighted trees with @xmath102 leaves that have a single interior vertex .",
    "note that such trees are simple . for any edge - weighted tree with @xmath1 leaves",
    ", @xmath103 is a constant ( the total length of the tree ) and @xmath104 is a uniformly distributed random pick from the lengths of the @xmath1 edges that are adjacent to one of the leaves .",
    "the following simple result is immediate from this observation .",
    "for @xmath102 the isomorphism type of a star is uniquely determined by the joint probability distribution of its random length sequence .",
    "[ thrm : main star ]    the simple trees with two leaves all consist of a single edge and have a random length sequence @xmath105 , where @xmath106 is the length of that edge , and so the isomorphism type of such a tree is uniquely determined by the joint probability distribution of its random length sequence .",
    "the simple trees with three leaves are stars , and it follows from that the isomorphism type of such a tree is uniquely determined by the the joint probability distribution of its random length sequence .",
    "we next consider simple , edge - weighted trees with four leaves .    for @xmath107 ,",
    "the isomorphism type of a simple , edge - weighted tree @xmath0 with @xmath1 leaves is uniquely determined by the joint probability distribution of its random length sequence .",
    "[ thrm : main n4 ]    the proof of this result is via consideration of possible cases .",
    "similar proofs could be attempted for larger numbers of leaves , but the main reason we include the result is to show how such a proof for even a small number of leaves leads to quite a few cases and because we will need the case of four leaves later .",
    "it is well - known that any simple , combinatorial tree with labeled leaves can be reconstructed from the simple , combinatorial trees spanned by each subset of four leaves ( the so - called quartets ) ( * ? ? ?",
    "* theorem  6.3.7 ) . with this and in mind",
    ", one might imagine that the isomorphism type of simple , edge - weighted tree can be determined from the joint probability distribution of @xmath108 . however , putting such a strategy into practice would seem to be rather complicated because there can be two sets of leaves @xmath109 and @xmath110 such that @xmath111 but @xmath112 , @xmath113 , and @xmath114 .",
    "one way of ruling out such annoying algebraic coincidences is to assume that the edge - weighted tree @xmath0 has _ edge - weights in general position _ , by which we mean that the sums of the lengths of any two different ( not necessarily disjoint ) subsets of edges of @xmath0 are not equal .",
    "the isomorphism type of a simple , edge - weighted tree @xmath0 with edge - weights in general position is uniquely determined by the joint probability distribution of its random length sequence .",
    "[ thrm : main generalposition ]    the last family of edge - weighted trees with general edge - weights whose elements we can identify up to isomorphism from the joint probability distributions of their random length sequences is the class of _ ultrametric _ trees . for the sake of completeness",
    ", we now define this class .",
    "recall that for leaves @xmath115 we denote by @xmath116 the distance between them ; that is , @xmath117 is the sum of the lengths of the edges on the unique path between @xmath43 and @xmath54 .",
    "the edge - weighted tree @xmath0 is ultrametric if for any leaves @xmath118 we have @xmath119 from which it follows that for any leaves @xmath118 at least two of the distances @xmath116 , @xmath120 , and @xmath121 are equal while the third is no greater than that common value .",
    "equivalently , an edge - weighted tree @xmath0 is ultrametric if , when it is thought of as a real tree ( that is , a metric space where the edges are treated as real intervals of varying lengths given by their edge - weights  see , for example , @xcite ) , then there is a ( unique ) point @xmath122 called the root ( which may be in the interior of an edge ) such that the distance from @xmath122 to a leaf is the same for all leaves .",
    "we will make use of both definitions .",
    "it is immediate from the former definition that the subtree of an ultrametric tree spanned of a subset of leaves is itself ultrametric .",
    "the isomorphism type of an ultrametric , simple , edge - weighted tree @xmath0 is uniquely determined by the joint probability distribution of its random length sequence .",
    "[ thrm : main ultrametric ]    the proof of establishes an even stronger result .",
    "namely , the isomorphism type of an ultrametric , simple , edge - weighted tree @xmath0 is uniquely determined by the minimal element of @xmath95 in the lexicographic order .",
    "[ rem : ultrametric min enough ]    we call attention to a subtle point in the statements of and .",
    "both results say that if we are given the joint probability distribution of the random length sequence of an edge - weighted tree @xmath0  information that certainly includes the number of leaves of @xmath0  and we know , a priori , that @xmath0 has a certain extra property ( edge - weights in general position or ultrametricity ) , then we can determine the isomorphism type of @xmath0 .",
    "the theorems do not , however , say whether it is possible to determine from the joint probability distribution of its random length sequence whether a simple , edge - weighted tree @xmath0 has its edge - weights in general position or is ultrametric .",
    "we do not have results that settle this question , but we say some more about it in and believe it is an interesting area for future research .",
    "[ rem : ultrametric determination ]    observe that if @xmath0 is an edge - weighted tree , @xmath123 is any vertex of @xmath0 , and @xmath38 is a constant such that @xmath124 , then @xmath125 defined by @xmath126 and @xmath127 is an ultrametric on @xmath74 that arises from suitable edge - weights on @xmath0 . the metric @xmath128 is often called the _ farris transform _ of @xmath129 ",
    "see @xcite for a review of the many appearances of this object in various areas from phylogenetics to metric geometry .",
    "it might be hoped that an affirmative answer to for general edge - weighted trees will follow from .",
    "however , we have been unable to find an argument which shows that the joint probability distribution of the random length sequence of the tree @xmath0 equipped with the new edge - weights is determined by the joint probability distribution of the random length sequence for the original edge - weights .",
    "suppose that @xmath0 is a rooted , simple combinatorial tree with root @xmath122 .",
    "we can define a partial order on @xmath8 by declaring that that @xmath130 if @xmath82 is on the unique path from @xmath122 to @xmath83 .",
    "two vertices @xmath131 have a unique greatest lower bound in this partial order that we write as @xmath132 and call the _ most recent common ancestor _ of @xmath82 and @xmath83 .",
    "the map @xmath133 defined by @xmath134 is an ultrametric on @xmath74 and hence it arises from a collection of edge - weights @xmath135 on @xmath0 .",
    "a directed edge @xmath136 in @xmath0 with @xmath130 is necessarily of the form @xmath137 and @xmath138 for some @xmath139 .",
    "if @xmath140 is the corresponding undirected edge , then @xmath141 therefore , if @xmath14 is a subtree of @xmath0 spanned by some set of leaves @xmath87 and @xmath142 is the set of directed edges of @xmath14 , then we have that the length of @xmath14 is @xmath143 the following result is immediate from and .    the isomorphism type of a simple , combinatorial tree @xmath0 is uniquely determined by the minimal element of the set @xmath95 of length sequences obtained after designating a root for @xmath0 and equipping @xmath0 with the edge - weights @xmath135 .",
    "we now turn our focus to combinatorial trees and drop the assumption of simplicity .",
    "that is , all edge - weights are equal to one and there may be vertices with degree two .",
    "we answer question  [ q : main ] in the affirmative for two families of combinatorial trees .",
    "( black vertices).,scaledwidth=40.0% ]    first , a combinatorial tree @xmath0 is a _ caterpillar _ if the deletion of the leaves along with the edges adjacent to them results in a path with @xmath144 vertices ( and hence @xmath44 edges )  see , for example , . choose some direction for the path and number from @xmath145 to @xmath44 the vertices on the path encountered successively in that direction and write @xmath146 for the number of leaves adjacent to the vertex numbered @xmath43 .",
    "note that @xmath147 and @xmath148 .",
    "two sequences @xmath149 and @xmath150 correspond to isomorphic trees if and only if @xmath151 , say , and either @xmath152 , @xmath153 or @xmath154 , @xmath153 .",
    "the isomorphism type of a caterpillar is uniquely determined by the joint probability distribution of its random length sequence .",
    "furthermore , it is possible to determine from the joint probability distribution of the random length sequence of a combinatorial tree whether the tree is a caterpillar .",
    "[ thrm : main caterpillar ]    our final results are for the classes of ( unrooted ) _ @xmath6-valent _ and _ rooted @xmath4-ary _ combinatorial trees . for @xmath155 ,",
    "a @xmath6-valent combinatorial tree is a combinatorial tree for which all vertices have degree either @xmath156 ( the internal vertices ) or @xmath25 ( the leaves ) . for @xmath155 ,",
    "a rooted @xmath4-ary combinatorial tree is a combinatorial tree for which one internal vertex ( the root ) has degree @xmath4 and the remaining internal vertices have degree @xmath156 ; the leaves , of course , have degree @xmath25 .",
    "when @xmath157 we refer to a rooted @xmath64-ary combinatorial tree as a rooted _ binary _ combinatorial tree . attaching an extra vertex via and edge to the root of a rooted @xmath4-ary tree produces a @xmath6-valent combinatorial tree .    the isomorphism type of a @xmath6-valent combinatorial tree ( respectively , a @xmath4-ary tree ) is uniquely determined by the joint probability distribution of its random length sequence .",
    "[ thrm : main kary1 ]    in fact , our proof of leads us to a stronger conclusion .",
    "fix @xmath158 .",
    "let @xmath159 be a random @xmath6-valent combinatorial tree ( respectively , a random @xmath4-ary combinatorial tree ) with @xmath1 leaves .",
    "then , the probability distribution of the isomorphism type of @xmath159 is uniquely determined by the joint probability distribution of its random length sequence .",
    "[ thrm : main kary2 ]    note that in there are two sources of randomness in the construction of the random length sequence : we first choose a realization of the random @xmath159 and then take an independent uniform random listing of the leaves to build the increasing sequence of subtrees and their lengths .",
    "the rest of the paper consists primarily of proofs of the above results in the order we have presented them . in we briefly discuss further open questions related to question  [ q : main ] .",
    "we begin by looking at question  [ q : main ] for edge - weighted trees with a small number of leaves and give a proof of that answers question  [ q : main ] in the affirmative for general , simple edge - weighted trees with @xmath161 or @xmath67 leaves .",
    "the case of for simple trees with @xmath162 leaves is trivial , as all such trees have two leaves and one edge , @xmath163 in this case , and @xmath106 is the length of the edge .    the case of @xmath164 leaves is only slightly more complicated ,",
    "as all such trees are star - shaped .",
    "thus , determining @xmath0 from @xmath93 consists of determining its three edge weights .",
    "these can be inferred easily from @xmath93 by looking at the distribution of @xmath165 , which , since @xmath166 is constant ( equal to the total length of @xmath0 ) , is distributed as a uniform random choice from the three edge weights .",
    "finally , we give a proof of in the case when @xmath160 .    for @xmath160 leaves ,",
    "there are two possible simple combinatorial trees , and hence two possibilities for the shape of @xmath0 .",
    "the first is the star - shaped tree with four edges and one interior vertex .",
    "the second is the @xmath58-valent tree with two interior vertices and one interior edge .",
    "leaves.,scaledwidth=40.0% ]    to determine which possibility @xmath0 is , we first look at the distribution of @xmath167 to find the lengths of the four edges connecting directly to the four leaves . call these edges _",
    "pendent_. if the sum of the four pendent edge lengths equals @xmath168 , then @xmath0 is star shaped and we have determined @xmath0 up to isomorphism . if not , then @xmath0 is @xmath58-valent and the difference between @xmath168 and the sum of the pendent edge lengths is the length @xmath13 of the interior edge .",
    "all that is left to determine @xmath0 up to isomorphism in this second case is determining how the pendent edges pair on each side of the interior edge .",
    "first , if the multiset of the lengths of pendent edges is of the form @xmath169 or @xmath170 , then @xmath0 is already uniquely determined .",
    "next , if the multiset is of the form @xmath171 , then we need to distinguish between the case where the leaves with pendent edges of length @xmath123 are siblings ( and thus so are the leaves with pendent edge length @xmath172 ) and the case where leaves with pendent edge lengths @xmath123 and @xmath172 are paired . in the former case the possible values of @xmath106 are @xmath173 with respective probabilities @xmath174 , whereas in the latter case the possible values of @xmath106 are @xmath175 with respective probabilities @xmath176 , and we can certainly distinguish between the two cases",
    ".    if the multiset of pendent edge lengths is of the form @xmath177 , then there are the following two possibilities :    * the two leaves with pendent edge length @xmath123 are siblings and the two leaves with pendant edge lengths @xmath172 and @xmath38 are siblings , in which case the possible values of @xmath106 are @xmath178 with respective probabilities @xmath179 ; * a leaf with pendent edge length @xmath123 is the sibling of the one with pendent edge length @xmath172 and the other leaf with pendent edge length @xmath123 is the sibling of the one with pendent edge length @xmath38 , in which case the possible values of @xmath106 are @xmath180 with respective probabilities @xmath181 .",
    "suppose without loss of generality that @xmath182 . if @xmath183 , then @xmath184 is @xmath185 for ( p1 ) and @xmath145 for ( p2 ) . if @xmath186 or @xmath187 , then @xmath188 is @xmath189 for ( p1 ) and @xmath185 for ( p2 ) . in all cases we can distinguish between ( p1 ) and ( p2 ) .    finally ,",
    "if the multiset of pendent edge lengths is of the form @xmath190 , then there are the following two possibilities :    * the leaf with pendent edge length @xmath123 is paired with the one with pendent edge length @xmath172 and the leaf with pendent edge length @xmath38 is paired with the one with pendent edge length @xmath191 , in which case the possible values of @xmath106 are @xmath192 with common probability @xmath185 ; * the leaf with pendent edge length @xmath123 is paired with the one with pendent edge length @xmath38 and the leaf with pendent edge length @xmath172 is paired with the one with pendent edge length @xmath191 , in which case the possible values of @xmath106 are @xmath193 with common probability @xmath185 ; * the leaf with pendent edge length @xmath123 is paired with the one with pendent edge length @xmath191 and the leaf with pendent edge length @xmath172 is paired with the one with pendent edge length @xmath38 , in which case the possible values of @xmath106 are @xmath194 with common probability @xmath185 ;    suppose without loss of generality that @xmath195",
    ". then possibility ( p3 ) holds if and only if @xmath196 and possibility ( p5 ) holds if and only if @xmath197 and @xmath198 , so we can distinguish between ( p3 ) , ( p4 ) and ( p5 )",
    ".    the argument in the proof of seems rather _ ad hoc _ and it does not suggest a systematic approach to obtaining the analogous result for trees with an arbitrary numbers of leaves .",
    "the number of simple combinatorial trees with @xmath1 leaves grows so rapidly with @xmath1 ( see , for example , @xcite ) that even for trees with a relatively small fixed number of leaves a case - by - case argument seems rather forbidding .",
    "nonetheless , we do conjecture that an affirmative answer to question  [ q : main ] holds more generally .",
    "recall that the edge - weights of a simple , edge - weighted tree @xmath0 are in general position if the sum of the lengths of any two distinct subset of edges of @xmath0 are not equal .    by assumption , if @xmath199 and @xmath200 are two subsets of @xmath74 such that @xmath201 , then @xmath202 .",
    "consequently , if @xmath199 and @xmath200 are two subsets of @xmath74 such that @xmath203 for @xmath204 , then @xmath205 and @xmath206 for @xmath207 .",
    "recall that @xmath89 are the successive randomly chosen leaves used in the construction of @xmath208 .    because @xmath104 is the length of the pendent edge attaching @xmath209 to the rest of @xmath0",
    ", it follows that the set @xmath210 has @xmath1 elements and @xmath211 for each @xmath212 .",
    "there are at least two leaves of @xmath0 that are siblings , and so there exist @xmath213 such that @xmath214 .",
    "fix such a pair of lengths and write @xmath215 and @xmath216 for the ( unique ) leaves of @xmath0 with pendent edges having respective lengths @xmath217 and @xmath218 .",
    "we have @xmath219 , and the event @xmath220 coincides with the event @xmath221 .    by assumption ,",
    "the set @xmath222 has @xmath223 elements and @xmath224 for each @xmath225 .",
    "index the values of @xmath226 as @xmath227 and write @xmath228 , @xmath229 , for the unique leaf of @xmath0 that is distance @xmath230 from the unique vertex of @xmath0 that is adjacent to both of the sibling leaves @xmath215 and @xmath216 .",
    "we will show that it is possible to determine the leaf - to - leaf distances @xmath231 , @xmath232 . as we recalled in the introduction",
    ", this information uniquely identifies the isomorphism type of @xmath0 .",
    "again by assumption , the set @xmath233 has @xmath234 elements and @xmath235 for each @xmath236 . for a given @xmath236",
    "there is a unique ordered pair @xmath237 , @xmath238 , and a unique @xmath239 such that @xmath240 and @xmath241 in which case the two conditional probabilities in question are both @xmath242 .",
    "moreover , every ordered pair @xmath237 , @xmath238 , corresponds to some unique @xmath236 and @xmath239 in this way .",
    "the event @xmath243 coincides with the event @xmath244 and the event @xmath245 coincides with the event @xmath246 .",
    "considering the subtree of @xmath0 spanned by @xmath247 and ignoring the vertices with degree two to produce a simple tree , the leaves @xmath248 and @xmath249 are siblings in this simple tree ( as are @xmath215 and @xmath216 ) , and the quantity @xmath13 is the distance between the vertex in the subtree to which @xmath248 and @xmath249 are adjacent and the vertex to which @xmath215 and @xmath216 are adjacent ; the lengths of the pendent edges connecting @xmath248 and @xmath249 to the rest of the subtree are @xmath250 and @xmath251 .",
    "thus , if the ordered pair @xmath237 corresponds to @xmath236 and @xmath239 , then , recalling the notation @xmath129 for the path length distance in @xmath0 , @xmath252 , @xmath253 , @xmath254 , @xmath255 , @xmath256 , and @xmath257 .",
    "therefore , the joint probability distribution the random length sequence @xmath91 uniquely determines the matrix of leaf - to - leaf distances in @xmath0 and hence the isomorphism type of @xmath0 .",
    "recall that @xmath95 is the set of sequences @xmath258 such that @xmath259 .",
    "write @xmath260 for the usual _ lexicographic _ total order on @xmath95 ( that is @xmath261 if in the first coordinate where the two sequences differ the entry of the @xmath217 is smaller than the entry of @xmath218 ) . equivalently , @xmath261 if either @xmath262 or @xmath263 and for the smallest @xmath7 such that @xmath264 we have @xmath265 . in this section",
    "we prove by showing that that the tree @xmath0 is determined up to isomorphism by the minimal element of @xmath95 .",
    "we use a similar technique ( but with a different total order ) to establish for @xmath156-valent and rooted @xmath4-ary combinatorial trees in .",
    "let @xmath266 be the minimal element of @xmath95 .",
    "write @xmath267 for an ordering of @xmath74 such that @xmath268 for @xmath269",
    ".    we will establish by induction that for @xmath270 the ultrametric real tree spanned by the leaves @xmath271 can be reconstructed from @xmath272 and , moreover , if we adopt the convention that we draw ultrametric real trees in the plane with the root at the top and leaves along the bottom , then this particular real tree can be embedded in the plane with the leaves @xmath273 in order from left to right .",
    "the claim is certainly true when @xmath274 .",
    "suppose the claim is true for @xmath275 .",
    "write @xmath276 for the ultrametric real tree spanned by @xmath271 and denote the height of @xmath276 by @xmath277 ; that is , @xmath277 is the common distance from each of the leaves of @xmath276 to the root @xmath278 of @xmath276 .",
    "we can , of course , suppose that @xmath279 .",
    "if @xmath280 , then the ultrametric real tree @xmath281 spanned by @xmath282 must consist of an arc of length @xmath283 from the root @xmath284 of @xmath281 to the leaf @xmath285 and an arc of length @xmath286 from `` new root '' @xmath284 to the `` old root '' @xmath278 . in this case",
    "we can , by the inductive hypothesis , certainly embed @xmath281 in the plane with the leaf @xmath285 to the right of the leaves @xmath273 .",
    "assume , therefore , that @xmath287 .",
    "then the ultrametric real tree @xmath281 must consist of @xmath276 and an arc of length @xmath288 joining @xmath285 to a point @xmath289 .",
    "it will suffice to show that @xmath83 must be on the arc @xmath290 $ ] that connects @xmath278 to @xmath228 because there is a unique ultrametric real tree consisting of @xmath276 and an arc of length @xmath288 joining a new leaf to a point on the arc @xmath290 $ ] ( this tree must have root @xmath278 and the point where the arc of length @xmath288 attaches to @xmath290 $ ] must be at distance @xmath291 from @xmath278 ) and , moreover , such a tree can be embedded in the plane with the new leaf to the right of the leaves @xmath271 .",
    "suppose , then , that @xmath83 is not on the arc @xmath290 $ ] .",
    "let @xmath54 be the maximum of the indices @xmath292 such that @xmath83 is on the arc connecting @xmath248 to @xmath278 .",
    "write @xmath34 for the point that is closest to @xmath293 in the subtree spanned by @xmath294 and @xmath278 .",
    "write @xmath35 for the point that is closest to @xmath293 in the subtree spanned by @xmath294 .",
    "equivalently , @xmath35 is the point in the subtree spanned by @xmath294 that is closest to @xmath34 .",
    "we may , of course , have @xmath295 ( which occurs if and only if @xmath296 ) . by the inductive hypothesis , @xmath34 and @xmath35",
    "are on the arc connecting @xmath249 to @xmath278 and @xmath297    by construction , @xmath83 is the point closest to @xmath285 in the subtree spanned by @xmath294 and @xmath278 .",
    "write @xmath298 for the point closest to @xmath285 in the subtree spanned by @xmath294 .",
    "equivalently , @xmath298 is the point in the subtree spanned by @xmath294 that is closest to @xmath83 .",
    "we have @xmath299    by the definition of @xmath54 , the points @xmath83 and @xmath34 are on the arc connecting @xmath249 to @xmath278 and @xmath300 .",
    "this implies that @xmath301 .",
    "it also implies , by ultrametricity , that @xmath302 consequently , @xmath303 this , however , contradicts the minimality of @xmath258 .    as we noted in",
    ", it is interesting to know whether it is possible to determine from the joint probability distribution of the random length sequence whether an edge - weighted tree is ultrametric .",
    "the preceding proof of contains a procedure for reconstructing @xmath0 from the minimal element of @xmath95 in the lexicographic order when @xmath0 is an ultrametric tree .",
    "if @xmath0 is an arbitrary edge - weighted tree and this procedure is applied to the minimal element of @xmath95 in the lexicographic order , then it will still produce an ultrametric tree and so a necessary condition for @xmath0 to be ultrametric is that the joint probability distribution of the random length sequence of this ultrametric tree coincides with the joint probability distribution of @xmath91 .    along the same lines ,",
    "suppose that @xmath0 is an arbitrary edge - weighted tree and , thinking of @xmath0 as a real tree , we root it at the unique point @xmath122 such that @xmath304 then @xmath122 will have @xmath4 children for some @xmath4 .",
    "let @xmath305 , @xmath306 , be the number of leaves @xmath35 in the subtree below the @xmath37 child of @xmath122 such that @xmath307 .",
    "it is clear that @xmath0 is ultrametric if and only if @xmath308 .",
    "let @xmath309 be a listing of the nonzero terms in the list @xmath310 .",
    "note for @xmath311 that @xmath312 and @xmath313 thus , the joint probability distribution of @xmath91 determines @xmath44 and the values of the elementary symmetric polynomials of degrees @xmath311 evaluated at @xmath309 , and we want to know whether @xmath314 , the value of the elementary symmetric polynomial of degree @xmath25 evaluated at @xmath309 , is @xmath1 .",
    "the elementary symmetric polynomials of degrees @xmath315 in @xmath44 real variables are algebraically independent over the reals , and so we can not expect to recover @xmath314 from the values of the other elementary symmetric polynomials . however , there are inequalities connecting the values of the various elementary symmetric polynomials that can be used to establish necessary conditions and sufficient conditions for @xmath0 to be ultrametric .",
    "for example , set @xmath316 and @xmath317 if @xmath318 and @xmath319 are positive constants such that @xmath320 and @xmath321 then , by ( * ? ? ? * theorem 77 , chapter ii ) @xmath322 thus , if @xmath323 and @xmath324 satisfy the inequalities and @xmath325 then @xmath326 when @xmath327 , and the opposite inequality hold when @xmath328 .",
    "this observation leads to necessary conditions and sufficient conditions for @xmath0 to be ultrametric .",
    "[ rem : more ultrametric determination ]    as we will see in for @xmath156-valent and rooted @xmath4-ary combinatorial trees , a somewhat similar proof argument based on the consideration of length sequences that are minimal with respect to a suitable order leads to a stronger result in that case .",
    "there we can not only determine @xmath0 from the joint probability distribution of its random length sequence , but if we have a random tree @xmath159 with a fixed number of leaves , then it is possible to determine the distribution of @xmath159 from the joint probability distribution of the random length sequence obtained by first picking a realization of @xmath159 and then independently picking a random ordering of the leaves to build a random length sequence .",
    "formally , we have some space @xmath20 of isomorphism types of trees , a corresponding space @xmath329 of possible length sequences , and a probability kernel @xmath330 from @xmath20 to @xmath329 , where , for @xmath331 , @xmath332 is the element of @xmath333 , the space of probability measures on @xmath329 , that is the joint probability distribution of the random length sequence built from @xmath0 .",
    "an affirmative answer to for a particular @xmath20 means that the map @xmath334 from @xmath20 to @xmath333 is injective . given an element @xmath330 of @xmath335 , the space of probability measures on @xmath20 , let @xmath336 be defined as usual by @xmath337 for @xmath338 .",
    "the stronger results obtained in say that , in the situations considered there , the map @xmath339 from @xmath335 to @xmath333 is injective .    one can ask if an analogous strengthening is also true for ultrametric trees . a proof along the lines of that given for does nt appear to apply immediately in this situation where the relevant space @xmath20 is uncountable rather than finite .",
    "we leave this as one of many open questions .",
    "recall that a caterpillar is a ( not necessarily simple ) combinatorial tree such that deleting the leaves of the tree results in a path consisting of @xmath144 vertices ( and hence @xmath44 edges of length @xmath25 ) .",
    "choosing one end of the path , we can label the vertices on path consecutively with @xmath340 and denote by @xmath341 the leaves that are attached to vertex @xmath342 on the path . both @xmath343 and @xmath344",
    "are non - zero , but the remaining @xmath146 may be zero .    the isomorphism types of caterpillars with @xmath1 leaves are thus seen to be in a bijective correspondence with equivalence classes of nonnegative integer sequences @xmath345 , where @xmath346 and @xmath347 , and we declare that @xmath345 and @xmath348 are equivalent .",
    "the proof of the following , which establishes the first claim in , is straightforward and we omit it .",
    "a combinatorial tree @xmath0 with @xmath1 leaves is a caterpillar with an associated path of length @xmath44 if and only if @xmath349 and @xmath350 almost surely .",
    "[ prop : det if caterpillar ]    we now turn to the proof of the main claim in .",
    "consider a box with @xmath1 tickets .",
    "each ticket has a label belonging to @xmath351 and there are @xmath146 tickets with label @xmath43 for @xmath153 .",
    "let @xmath352 be the result of drawing tickets uniformly at random from the box without replacement and noting their labels .",
    "set @xmath353 it is clear that @xmath354 has the same joint probability distribution as @xmath355 , and so it suffices to show that it is possible to determine @xmath356 from a knowledge of the joint probability distribution of @xmath357 ( that is , it is possible to determine up to a reflection the vector that gives the number of tickets with each label ) .    to begin with ,",
    "note that , as in , @xmath358 and so we can determine @xmath44 from the joint probability distribution of @xmath359 .",
    "observe next that @xmath360 and @xmath361 we can thus determine the multiset @xmath362 and , in particular , @xmath363 .",
    "for @xmath364 we have @xmath365 and so we can determine @xmath366 . if @xmath44 is even , then @xmath367 and so we can determine @xmath368 .    also , @xmath369 and , for @xmath370 , @xmath371 we can therefore determine @xmath372 for @xmath373 .",
    "we claim that we the information we have just derived suffices to determine @xmath356 .",
    "that is , if @xmath374 is a sequence with @xmath375 @xmath376 for @xmath377 , and @xmath378 for @xmath373 , then either @xmath379 for @xmath377 or @xmath380 for @xmath377 .    to see that this is so , introduce the fourier transforms @xmath381 and @xmath382 for @xmath383",
    "these are entire functions that uniquely determine @xmath384 and @xmath374 .",
    "note that @xmath385 and a similar formula holds for @xmath386 .",
    "it will thus suffice to show that either @xmath387 or @xmath388 ( equivalently , @xmath389 ) .",
    "it follows from the assumption that @xmath378 for @xmath373 that if we define @xmath390 by @xmath391 and define @xmath392 similarly , then @xmath393 for all @xmath394 and hence @xmath395 for all @xmath383 . by theorem 2.2 in @xcite ,",
    "there exist finitely supported functions @xmath396 and @xmath397 such that if we set @xmath398 and @xmath399 then @xmath400 and @xmath401    it follows from the assumption that @xmath376 for @xmath377 that @xmath402 for all @xmath383 .",
    "therefore , @xmath403 and hence @xmath404 for all @xmath383 .",
    "because the functions @xmath405 and @xmath406 are both entire , we must have either that @xmath407 for all @xmath383 or @xmath408 for all @xmath383 . if @xmath407 for all @xmath383 , then @xmath409 and @xmath410 for @xmath153 .",
    "if @xmath408 for all @xmath383 , then @xmath411 and @xmath379 for @xmath377 .",
    "we now turn our focus to the cases of @xmath6-valent and @xmath4-ary trees . recall that a _ @xmath6-valent tree _ is a tree with all vertices of degree either @xmath156 or @xmath25 . for @xmath155",
    "a _ rooted @xmath4-ary tree _ is a tree with one vertex of degree @xmath4 and the rest of degrees either @xmath412 or @xmath25 .",
    "we refer to the rooted @xmath64-ary tree as a _ rooted binary tree_. note that any @xmath4-ary tree is obtained by removing one leaf of a suitable @xmath6-valent trees .",
    "our general proof methodology for these families of trees is similar to that used in for ultrametric trees .",
    "we first define a particular class of sequences that can appear as elements of @xmath95 ( the down - split sequences ) and a total order on such sequences .",
    "we then show that the minimal down - split sequence in @xmath413 uniquely identifies @xmath0 .",
    "the idea of the proof is the same for all @xmath4 and depends on the following fact .",
    "let @xmath0 be a @xmath6-valent tree or a rooted @xmath4-ary tree and let @xmath414 be a subtree of @xmath0 .",
    "then @xmath414 is a rooted @xmath4-ary tree if and only if @xmath415 [ lem : k subtree size ]    because @xmath414 is a subtree of @xmath0 , every interior vertex of @xmath414 has degree at most @xmath156 .",
    "write @xmath416 for the number of vertices of @xmath414 of degrees @xmath417 .",
    "we need to show that @xmath418 for @xmath419 and @xmath420 , or , equivalently , that @xmath420 and @xmath421 .",
    "this is in turn equivalent to showing that @xmath422 which , by the `` handshaking identity '' @xmath423 becomes @xmath424 or , upon rearranging , @xmath425    for simplicity of notation we present the details of the proof for the case of ( unrooted ) @xmath58-valent trees and rooted binary trees ( that is , @xmath274 ) .",
    "we end in with a discussion of the extension to general @xmath4 .",
    "our proof of begins with an analysis of random length sequences for marked ( also known as planted ) @xmath58-valent trees .",
    "a _ marked @xmath58-valent tree _",
    "@xmath426 is an @xmath58-valent tree @xmath0 and a distinguished leaf @xmath35 of @xmath0 .",
    "we define the _ modified random length sequence _",
    "@xmath427 of @xmath426 to be the random length sequence @xmath93 of @xmath0 conditioned on @xmath428 .",
    "we need to distinguish some particular sequences that appear in the support of @xmath429 .    as usual , we can define a partial order on @xmath8 by declaring that @xmath82 precedes @xmath83 if @xmath430 is on the path between @xmath35 and @xmath83 , and we can extend this partial order to a total order @xmath431 such that if @xmath432 are such that @xmath298 and @xmath82 are not comparable in the partial order but @xmath433 , @xmath298 precedes @xmath83 in the partial order , and @xmath82 precedes @xmath434 in the partial order , then @xmath435 .",
    "such a total order corresponds to embedding @xmath0 in the plane and listing the elements of @xmath8 in the order they are encountered as one walks around @xmath0 starting from @xmath35 .",
    "suppose that @xmath436 is the ordered listing of @xmath74 .",
    "set @xmath437 , @xmath3 .",
    "if @xmath438 , then the subtree spanned by the @xmath4 leaves @xmath439 has @xmath440 edges and hence , by , this subtree is a binary tree .",
    "if we write @xmath441 for the vertex adjacent to the marked leaf @xmath35 , denote by @xmath442 the other two vertices adjacent to @xmath441 , and suppose that @xmath443 , then it must be the case that @xmath444 .",
    "write @xmath14 ( respectively , @xmath15 ) for the subtree of @xmath0 consisting of @xmath298 and the vertices @xmath34 such that @xmath445 ( respectively , @xmath446 ) is on the path from @xmath441 to @xmath34 .",
    "the sequence @xmath447 satisfies @xmath448 for @xmath449 .",
    "the sequence @xmath450 satisfies @xmath451 for @xmath452 .",
    "[ rem : down - split construction ]    [ def : downsplit ] a _ down - split sequence _ is an element of the class of increasing sequences of positive integers defined recursively as follows .",
    "the sequence @xmath453 is a down - split sequence .",
    "a sequence @xmath454 , @xmath455 , is down - split if @xmath456 and , setting @xmath457    * @xmath458 is down - split , * @xmath459 is down - split .",
    "the index @xmath460 is the _ splitting index _ of @xmath461 .    for @xmath462 ,",
    "the sequence @xmath463 is a down - split sequence . here",
    "@xmath464 , @xmath465 and @xmath466 .",
    "the following result is immediate from .    for every marked @xmath58-valent tree @xmath467",
    "there is at least one down - split sequence @xmath461 with @xmath468 [ lem : exist of split ]    we record the following fact for later use .    if @xmath469 is a down - split sequence then @xmath470 .",
    "[ lem : size of downsplit ]    this follows easily by induction .",
    "if @xmath461 splits at @xmath460 , then , as @xmath471 is a down - split sequence with @xmath472 , we have by the inductive hypothesis that @xmath473 and the claim follows .    [ ex : nonunique split seq ] given any down - split sequence @xmath461 , it is possible to reverse the argument in and construct a marked @xmath58-valent tree with a suitable total ordering on its vertices such that @xmath461 is the corresponding down - split sequence .",
    "however , a marked @xmath58-valent tree @xmath467 is not uniquely identified by an arbitrary down - split sequence in the support of @xmath429 , as the example in shows .     and @xmath474 with particular realizations of the random selection of leaves.,title=\"fig:\",scaledwidth=40.0% ]   and @xmath474 with particular realizations of the random selection of leaves.,title=\"fig:\",scaledwidth=40.0% ]",
    "write @xmath475 and @xmath476 for the random selections of the leaves of @xmath477 and @xmath478 .",
    "suppose that the realizations are such that @xmath479 for @xmath480 and that these leaves of the subtree @xmath481 appear in an order of the type discussed in .",
    "the corresponding realizations for the modified random length sequences are equal .",
    "the common value @xmath482 is a down - split sequence with splitting index @xmath58 .",
    "thus , two non - isomorphic marked @xmath58-valent trees can have a common down - split sequence in the supports of their modified random length sequences .",
    "note that the common down - split sequence results from taking the leaves of @xmath478 according to an order of the type described in , but this is not the case for @xmath477 .    with in mind",
    "we see that it would be useful to have a way of recognizing down - split sequences in the support of @xmath429 that result from realizations where the leaves are selected in an order that arises from a suitable total order on the vertices of @xmath0 .",
    "the key is the following total order on down - split sequences .",
    "we re - use the notation @xmath260 that was used in for the lexicographic order .",
    "define a total order @xmath260 on the set of down - split sequences of a given length recursively as follows .",
    "firstly , @xmath483 does not hold .",
    "next , let @xmath484 be down - split sequences indexed by @xmath485 with respective splitting indices @xmath460 and @xmath486 . set @xmath487 and @xmath488 declare that @xmath489 if @xmath490 or @xmath491 or @xmath492    the next result follows easily by induction .    the binary relation @xmath260 is a total order on the set of down - split sequences of a given length .",
    "the _ minimal down - split sequence _ for a marked @xmath58-valent tree @xmath467 is the minimal element ( with respect to the total order @xmath260 ) of the set @xmath493    we now proceed to establish some results that culminate in showing that @xmath467 is determined by its minimal down - split sequence .",
    "let @xmath467 be a marked @xmath58-valent tree , with modified random length sequence @xmath494 constructed from the random sequence of leaves @xmath495 with @xmath428 .",
    "denote by @xmath441 the vertex adjacent to the marked leaf @xmath35 and denote by @xmath442 the other two vertices adjacent to @xmath441 .",
    "write @xmath14 ( respectively , @xmath15 ) for the subtree of @xmath0 consisting of @xmath441 and the vertices @xmath34 such that @xmath445 ( respectively , @xmath446 ) is on the path from @xmath441 to @xmath34 . set @xmath496 then @xmath497 if and only if @xmath498 or _ vice versa_. [ lem : split subtrees ]    if @xmath499 and @xmath500 , then the subtree spanned by @xmath501 consists of the leaf @xmath35 adjoined to @xmath14 via an edge to the vertex @xmath441 .",
    "this subtree is a rooted binary tree with root @xmath441 .",
    "it follows from that @xmath497 .",
    "for the other direction , assume that @xmath502 .",
    "by , the subtree @xmath414 spanned by @xmath503 is a rooted binary tree with @xmath36 leaves .",
    "we have @xmath504 , @xmath505 , and @xmath506 .",
    "we need to show that @xmath414 consists of the leaf @xmath35 adjoined to either @xmath14 or @xmath15 via an edge to the vertex @xmath441 that is common to both @xmath14 and @xmath15 .    by the construction prior to the statement of we know that @xmath507 and so if @xmath508 , then @xmath509 and similarly with the roles of @xmath14 and @xmath15 reversed .",
    "we can rule out the possibility that @xmath510 intersects both @xmath511 and @xmath512 as follows .",
    "if @xmath513 and @xmath514 , then @xmath515 must be a proper subset of @xmath516 and @xmath517 must be a proper subset of @xmath518 .",
    "if @xmath515 is a proper , nonempty subset of @xmath516 , then @xmath414 must have a degree @xmath64 vertex that belongs to @xmath519 , and similarly for @xmath15 .",
    "however , @xmath414 is a rooted binary tree and can not have two or more vertices of degree @xmath64 .",
    "finally , we need to rule out the possibility of @xmath520 is a proper subset of @xmath516 or @xmath518 .",
    "however , if @xmath520 is a proper subset of @xmath516 , then @xmath414 would have at least one degree @xmath64 vertex in that belongs to @xmath519 as well as the degree @xmath64 vertex @xmath441 , which contradicts @xmath461 being a rooted binary tree .",
    "the same argument holds with @xmath15 in place of @xmath14 .",
    "let @xmath467 be a marked @xmath58-valent tree with modified random length sequence @xmath494 .",
    "then @xmath521 is the splitting index for the minimal down - split sequence for @xmath467 .",
    "[ cor : split subtrees ]    if @xmath460 is the splitting index of any down - split sequence @xmath461 in the support of @xmath429 , then @xmath522 by definition .",
    "thus @xmath523 and hence @xmath524 .    on the other hand ,",
    "let @xmath525 be as in the statement of .",
    "it follows from that result that @xmath526 . by the construction in",
    "if @xmath527 or the analogous one with the roles of @xmath14 and @xmath15 reversed if @xmath528 , we may construct a down - split sequence for @xmath467 that has splitting index @xmath36 . by the definition of the total order @xmath260 , the splitting index for the minimal down - split sequence for @xmath467 is at most @xmath36 .",
    "let @xmath461 be the minimal down - split sequence for a marked @xmath58-valent tree @xmath467 .",
    "there is no other marked @xmath58-valent tree for which @xmath461 is the minimal down - split sequence .",
    "[ prop : det by downsplit ]    we will prove this by induction .",
    "the claim is clearly true for the down - split sequence @xmath529 .",
    "let @xmath426 be a marked @xmath58-valent tree and @xmath461 the minimal down - split sequence for @xmath467 .",
    "define @xmath525 as in the statement of .",
    "let @xmath460 be the splitting index of @xmath461 .",
    "let @xmath94 be an ordered listing of @xmath74 such that @xmath530 for @xmath3 . by and we must either have @xmath531 and @xmath532 or the analogous conclusion with the roles of @xmath14 and @xmath15 interchanged holds ( if @xmath533 , then only one alternative is possible )",
    ". we may suppose without loss of generality that the choice of @xmath445 and @xmath446 is such that the first alternative holds .",
    "set @xmath534 by definition , @xmath535 and @xmath536 are down - split sequences . because @xmath537 , we have @xmath538 and @xmath539    we claim that @xmath535 must be the minimal down - split sequence for @xmath540 . to see this ,",
    "note that if there was a down - split sequence @xmath541 with @xmath542 such that @xmath543 then , writing @xmath544 for a positive integer @xmath36 we would have @xmath545 and , by definition of the total order @xmath260 , @xmath546 this , however , contradicts the minimality of @xmath461 .",
    "similarly , @xmath536 is the minimal down - split sequence for @xmath547 . by induction , @xmath540 and @xmath547",
    "are uniquely determined .",
    "since @xmath467 is obtained by gluing @xmath548 and @xmath547 together at the shared vertex @xmath441 and attaching the marked leaf @xmath35 to @xmath441 by an edge , we see that @xmath426 is also determined by @xmath461 .",
    "while the proof of is not in the form of an explicit reconstruction procedure , the argument clearly leads to an algorithm for building a marked @xmath58-valent tree @xmath426 from the corresponding minimal down - split sequence .",
    "namely , @xmath467 is simply the recursion tree that results from parsing @xmath461 as a down - split sequence as in , with leaves corresponding to edges that terminate in the sequence @xmath549 .",
    "-valent tree with its leaves ordered minimally and the corresponding parse tree for the minimal down - split sequence.,title=\"fig:\",scaledwidth=40.0% ] -valent tree with its leaves ordered minimally and the corresponding parse tree for the minimal down - split sequence.,title=\"fig:\",scaledwidth=40.0% ]      from we are able to easily prove for ( unmarked ) @xmath58-valent trees .",
    "let @xmath0 be a fixed ( unknown ) @xmath58-valent tree with @xmath1 leaves and let @xmath93 be its random length sequence .",
    "conditional on @xmath550 , @xmath93 is the modified random length sequence of the marked binary tree @xmath551 .",
    "thus , if @xmath552 then there must be some leaf @xmath553 such that @xmath554 let @xmath555 be the minimal element of the set @xmath556 then @xmath555 must be the minimal down - split sequence for @xmath426 for at least one leaf @xmath35 of @xmath0 . by we",
    "can reconstruct @xmath426 and hence @xmath0 from @xmath555 .",
    "the above argument can be pushed further to prove for @xmath159 a random @xmath58-valent tree .",
    "let @xmath159 be a random @xmath58-valent tree with @xmath1 leaves and random length sequence @xmath557",
    ".    given a @xmath58-valent tree @xmath0 with @xmath1 leaves , let @xmath558 be the minimal element of the set of down - split sequences of the marked @xmath58-valent trees @xmath467 as @xmath35 ranges over @xmath74 .",
    "we equip the set of @xmath58-valent tree with @xmath1 leaves with a total order that , with a slight abuse of notation , we denote by @xmath260 by declaring that @xmath559 if @xmath560 .",
    "note that if @xmath559 , then @xmath561 and @xmath562 .",
    "now , for each choice of @xmath0 we have @xmath563 and the conclusion that we can recover @xmath564 as @xmath0 ranges over the @xmath58-valent trees with @xmath1 leaves follows simply from the observation that if @xmath172 is a row vector of length @xmath565 and @xmath566 is an @xmath567 matrix that has all entries below the diagonal zero and all entries on the diagonal strictly positive , then there is a unique row vector @xmath82 of length @xmath565 such that @xmath568 .",
    "we now prove and for rooted binary trees .",
    "analogous to the objects we introduced for marked @xmath58-valent trees , we begin with a definition of a class of sequences that will appear in the support of the random length sequence of a rooted binary tree .    an _ up - split sequence _ is an element of the class of increasing sequences of nonnegative integers defined recursively as follows .",
    "the sequence @xmath569 is an up - split sequence .",
    "a sequence @xmath570 , @xmath571 , is an up - split sequence if @xmath572 and , setting @xmath573    * @xmath574 is an up - split sequence , * @xmath575 is a down - split sequence .",
    "the index @xmath460 is the _ splitting index _ of @xmath461 .",
    "suppose that @xmath0 is a rooted binary tree with root @xmath441 . in a manner similar to the construction in we",
    "can order a partial order on @xmath8 by declaring that @xmath82 precedes @xmath83 if @xmath430 is on the path between @xmath122 and @xmath83 , and we can extend this partial order to a total order @xmath431 such that if @xmath432 are such that @xmath298 and @xmath82 are not comparable in the partial order but @xmath433 , @xmath298 precedes @xmath83 in the partial order , and @xmath82 precedes @xmath434 in the partial order , then @xmath435 .",
    "suppose that @xmath576 is the ordered listing of @xmath74 .",
    "set @xmath577 and @xmath578 , @xmath3 .",
    "then @xmath579 is an up - split sequences .",
    "the leaves @xmath580 and @xmath581 respectively span the two binary subtrees @xmath14 and @xmath15 that are rooted at the two children of the root @xmath441 .",
    "the subtree spanned by @xmath441 and @xmath581 is a @xmath58-valent tree .     and",
    "a marked @xmath58-valent tree @xmath547.,scaledwidth=60.0% ]    [ ex : up - split construction ]    the following analogue of is clear from .    for every rooted binary tree @xmath0",
    ", there is at least one up - split sequence @xmath461 with @xmath582 [ lem : exist upsplit ]    the following analogue of can be established using a similar inductive proof .",
    "if @xmath570 is an up - split sequence then @xmath583 .",
    "[ lem : size of upsplit ]    define a total order @xmath584 on the set of up - split sequences of a given length recursively as follows .",
    "firstly , @xmath585 does not hold .",
    "next , let @xmath461 and @xmath342 be two up - split sequences indexed by @xmath586 with respective splitting indices @xmath460 and @xmath486 . set @xmath587 and @xmath588 declare that @xmath589 if @xmath590 or @xmath591 or @xmath592    note for up - split sequences @xmath461 and @xmath342 , that @xmath593 implies that the splitting index of @xmath461 is _ greater than or equal _ to the splitting index of @xmath342 . for down - split sequences @xmath34 and @xmath594 , @xmath595 implies that the splitting index of @xmath34 is _ less than or equal _ to the splitting index of @xmath594 .",
    "this change in the direction of the inequalities matches the switch in the definition of the splitting index from an infimum for down - split sequences to a supremum for up - split sequences .",
    "the next result follows easily by induction .",
    "the binary relation @xmath584 is a total order on the set of up - split sequences of a given length .",
    "the _ minimal up - split sequence _ for a rooted binary tree @xmath0 is the minimal element ( with respect to the total order @xmath584 ) of the set @xmath596    the up - split sequence analogues of and are the following and they are proved in essentially the same manner .    given a binary tree @xmath0 with root @xmath441 , let @xmath14 and @xmath15 be the binary subtrees rooted at the two children of @xmath441 . set @xmath597 then @xmath497 if and only if @xmath598 and @xmath599 or _ vice versa_. [ lem : upsplit subtrees ]    let @xmath0 be a rooted binary tree with random length sequence @xmath600 .",
    "then @xmath601 is the splitting index for the minimal up - split sequence for @xmath0 .",
    "[ cor : upsplit subtrees ]    the following analogue of for up - split sequences follows from and in essentially the same manner that followed from and .",
    "let @xmath461 be the minimal up - split sequence for a rooted binary tree @xmath0 .",
    "there is no other rooted binary tree for which @xmath461 is the minimal up - split sequence .",
    "[ prop : det by upsplit ]    clearly , completes the proof of . to establish in the case of @xmath159 a random rooted binary tree , we need only repeat the argument of the proof of given in for @xmath58-valent trees .",
    "the proof of the extension and to @xmath6-valent and rooted @xmath4-ary combinatorial trees for @xmath602 is very similar to the @xmath157 case and involves the introduction of suitable notion of down - split and up - split sequences along with appropriate total orders on these sets of sequences .",
    "the only difference is that both types of split sequences are now split into @xmath4 smaller sequences , instead of just two .",
    "we leave the details to the reader .",
    "the original conjecture question  [ q : main ] remains open in general , both for simple trees with arbitrary edge weights ( not in general position ) , and for combinatorial trees .",
    "an even more general question is suggested by .",
    "let @xmath159 be a random tree with probability distribution supported either on the set of simple trees with @xmath1 leaves and general edge weights or the set of combinatorial trees with @xmath1 leaves .",
    "can the probability distribution of @xmath159 be determined uniquely from the joint probability distribution of the random length sequence @xmath557 ?",
    "[ q : open general ]    even if the answer to question  [ q : open general ] is `` no '' , the answer may still be `` yes '' if the probability distribution of @xmath159 is known _ a priori _ to belong to some particular family of probability distributions .",
    "there are , of course , many families of probability models for with random trees with @xmath1 leaves that are described by a small number of parameters ( for example , conditioned galton - watson models , the various preferential attachment models ) , and perhaps the value of these parameters can be determined from the joint probability distribution of the random length sequence of a random tree that is known _ a priori _ to be distributed according to a member of one of these families .",
    "we remarked in the introduction that the focus of this paper is superficially similar to that in @xcite , where the problem of reconstructing a combinatorial tree from its number deck ( the sizes of the subtrees in the forests produced by deleting each vertex ) was studied .",
    "the lists of lists that are the number deck of some combinatorial tree are characterized in @xcite .",
    "are there more parsimonious quantities derived from the joint probability distribution of the random length sequence that still carry a lot of information about @xmath0 ?",
    "for example , how much information about @xmath0 is contained in the expectation @xmath603 , \\ldots , \\be[w_n])$ ] of the random length sequence and is it possible to characterize those vectors which can arise as the expectation of the random length sequence ?      alfred  v. aho , john  e. hopcroft , and jeffrey  d. ullman , _ the design and analysis of computer algorithms _ , addison - wesley publishing co. , reading , mass .- london - amsterdam , 1975 , second printing , addison - wesley series in computer science and information processing .",
    "mr 0413592 ( 54 # 1706 )            to3em , _ a graph reconstructor s manual _ , surveys in combinatorics , 1991 ( guildford , 1991 ) , london math . soc .",
    "lecture note ser .",
    "166 , cambridge univ . press , cambridge , 1991 , pp .",
    "mr 1161466 ( 93e:05071 )    peter buneman , _ the recovery of trees from measures of dissimilarity _ , mathematics in the archaeological and historical sciences ( f.r .",
    "hodson , d.g .",
    "kendall , and p.  tautu , eds . ) , edinburgh university press , edinburgh , 1971 , pp .",
    "387395 .",
    "steven  n. evans , _ probability and real trees _ , lecture notes in mathematics , vol .",
    "1920 , springer , berlin , 2008 , lectures from the 35th summer school on probability theory held in saint - flour , july 623 , 2005 .",
    "mr mr2351587",
    "gary gordon , eleanor mcdonnell , darren orloff , and nen yung , _ on the tutte polynomial of a tree _ , proceedings of the twenty - sixth southeastern international conference on combinatorics , graph theory and computing ( boca raton , fl , 1995 ) , vol . 108 , 1995 , pp .",
    "mr 1369283 ( 96j:05036 )              i.  krasikov and j.  schnheim , _ the reconstruction of a tree from its number deck _ , discrete math .",
    "* 53 * ( 1985 ) , 137145 , special volume on ordered sets and their applications ( larbresle , 1982 ) .",
    "mr 786484 ( 86d:05088 )        frederick  a matsen and steven  n evans , _ ubiquity of synonymity : almost all large binary trees are not uniquely identified by their spectra or their immanantal polynomials . _ ,",
    "algorithms for molecular biology : amb * 7 * ( 2011 ) , no .  1 , 1414 .    jeremy  l. martin , matthew morin , and jennifer  d. wagner , _ on distinguishing trees by their chromatic symmetric functions _ , j. combin .",
    "theory ser .",
    "a * 115 * ( 2008 ) , no .  2 , 237253 .",
    "mr 2382514 ( 2008m:05115 )"
  ],
  "abstract_text": [
    "<S> given an edge - weighted tree @xmath0 with @xmath1 leaves , sample the leaves uniformly at random without replacement and let @xmath2 , @xmath3 , be the length of the subtree spanned by the first @xmath4 leaves . </S>",
    "<S> we consider the question , `` can @xmath0 be identified ( up to isomorphism ) by the joint probability distribution of the random vector @xmath5 ? '' </S>",
    "<S> we show that if @xmath0 is known _ a priori _ to belong to one of various families of edge - weighted trees , then the answer is , `` yes . '' </S>",
    "<S> these families include the edge - weighted trees with edge - weights in general position , the ultrametric edge - weighted trees , and certain families with equal weights on all edges such as @xmath6-valent and rooted @xmath4-ary trees for @xmath7 and caterpillars . </S>"
  ]
}