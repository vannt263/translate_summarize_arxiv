{
  "article_text": [
    "solar flares are understood to involve the conversion of magnetic energy in the solar corona into the energy of particles and radiation . in particular flare energy",
    "is believed to derive from non - potential coronal magnetic fields , i.e.  that part of the magnetic field produced by currents flowing in the solar corona ( e.g.  tandberg - hanssen and emslie , 1988 ) .",
    "the origin of flare energy in coronal currents has suggested to many authors the use of a circuit analogy ( e.g.  alfvn and carlqvist 1967 ; spicer , 1982 ; somov 1992 ; melrose , 1995 ; melrose 1997 ; longcope and noonan 2000 ; khodachenko and zaitsev , 1998 ; khodachenko , haerendel and rucker , 2003 ) .",
    "it is well known that the energy of a system of @xmath0 distinct current - carrying circuits may be written ( e.g.  jackson , 1998 ) @xmath1 where @xmath2 is the self - inductance and @xmath3 is the mutual inductance , and where @xmath4 is the current density at a point @xmath5 in space , and @xmath6 is the volume of the @xmath7 circuit .",
    "although equations  ( [ eq : general_e])([eq : general_m ] ) are quite general , their utility relies on having a small number of well - defined circuits with simple geometries for which analytic expressions for @xmath8 and @xmath9 may be evaluated , and in particular for which @xmath8 and @xmath9 are independent of @xmath10 and @xmath11 .",
    "this is the situation for currents flowing in a small number of `` wire '' loops , i.e.  loops with a fixed geometry .",
    "circuit models for coronal magnetic fields adopt wire loop configurations .",
    "for example , in the flare model of melrose ( 1997 ) based on reconnection between current - carrying magnetic flux tubes , each flux tube is represented by fixed toroidal structures carrying a uniform axial current .",
    "the self - inductance of such a structure is ( e.g.  landau and lifshitz , 1960 ) @xmath12 where @xmath13 is the major radius of the toroid and @xmath14 is the minor radius .",
    "melrose ( 1997 ) also adopts the following approximate expression for the mutual inductance between two loops whose centres are separated by a distance @xmath15 and whose axes subtend an angle @xmath16 : @xmath17^{3/2}}.\\ ] ] this formula is not exact but is based on interpolation between known results .",
    "an exact formula which holds for two axially - aligned line - current loops separated by a distance @xmath15 is ( stratton , 1941 ) @xmath18,\\ ] ] where @xmath19 and where @xmath20 and @xmath21 are complete elliptic integrals .",
    "real coronal currents do not flow along simple wire loops  they are distributed in the coronal volume , and describe complicated paths .",
    "a common model for current - carrying coronal fields is the force - free model , in which the magnetic field @xmath22 satisfies @xmath23 , ( as well as @xmath24 ) where @xmath25 . in other words",
    "the current density is everywhere parallel to the magnetic field .",
    "unfortunately the force - free field equation is in general nonlinear and hence difficult to solve . a restricted set of force - free fields  linear force free fields  are easy to calculate ( e.g.  nakagawa and raadu 1972 ; chiu and hilton 1977 ; alissandrakis , 1981 ; gary , 1989 ) .",
    "for these fields @xmath26 where @xmath27 is a constant , the force - free parameter .",
    "linear force - free models for coronal magnetic fields permit detailed descriptions of current paths in the corona , although they have limitations as large scale models for solar fields ( e.g.  sturrock , 1994 ) .    in this paper",
    "the accuracies of simple circuit models for coronal magnetic field energies are tested by application to linear force - free field configurations . to our knowledge",
    "this is the first quantitative test of the accuracy of the circuit model in the solar context . for simplicity ,",
    "the comparison is limited to field configurations representing one and two magnetic loops .",
    "the order of presentation is as follows . in ",
    "2 the method is outlined , including the adopted boundary conditions (  2.1 ) , and the details of the linear force - free (  2.2 ) and circuit (  2.3 ) models . in ",
    "3 the results of the calculations for one loop (  3.1 ) and two loops (  3.2 ) are presented .",
    "finally in  4 the results are discussed .",
    "the plane @xmath28 is taken to represent the photosphere , and the half space above this plane ( @xmath29 ) represents the coronal volume .",
    "we consider simple boundary field configurations suggestive of one coronal loop : @xmath30    -b_1\\exp\\left[-\\frac{({\\bf x}-{\\bf x}_{1-})^2}{2\\sigma_1 ^ 2}\\right],\\ ] ] and two coronal loops : @xmath31    -b_1\\exp\\left[-\\frac{({\\bf x}-{\\bf x}_{1-})^2}{2\\sigma_1 ^ 2}\\right ] \\nonumber \\\\    & + & b_2\\exp\\left[-\\frac{({\\bf x}-{\\bf x}_{2+})^2}{2\\sigma_2 ^ 2}\\right ]    -b_2\\exp\\left[-\\frac{({\\bf x}-{\\bf x}_{2-})^2}{2\\sigma_2 ^ 2}\\right],\\end{aligned}\\ ] ] respectively , where @xmath32 .",
    "the positions @xmath33 and @xmath34 define the loop footpoints .",
    "it is convenient to adopt non - dimensional units in which lengths are expressed in terms of a basic length @xmath35 , and magnetic fields are expressed in terms of the peak vertical field @xmath36 at the base of loop one , e.g.   @xmath37 where bars indicate dimensionless versions of quantities .",
    "a solution to the linear force - free equations is provided by ( e.g.  alissandrakis , 1981 ) @xmath38 where @xmath39 denotes the fourier transform of @xmath40 in @xmath41 and @xmath42 ( @xmath43 and @xmath44 are the wavenumbers corresponding to @xmath41 and @xmath42 respectively ) , @xmath45 is the fourier transform of @xmath46 , @xmath47 is the force - free parameter , and @xmath48^{1/2}.\\ ] ]    equation  ( [ eq : ss_sol ] ) requires @xmath49 . since large @xmath43 and @xmath44 correspond to variation on small spatial scales , this solution is termed the `` small scale solution '' to the linear force - free field equations .",
    "of course , inversion of this solution in fourier space involves integration over all @xmath43 and @xmath44 .",
    "the small scale solution only provides a solution matching given boundary conditions @xmath46 if @xmath50 is identically zero for @xmath51 . in general this is not true , and in particular it will not be true for the boundary conditions  ( [ eq : bc1 ] ) and  ( [ eq : bc2 ] ) , for any given @xmath52 [ although @xmath50 is expected to be small for small @xmath43 and @xmath44 , and identically zero for @xmath53 provided the net flux is zero ] . in the following we effectively calculate @xmath50 for the given boundary conditions and",
    "then impose @xmath54 for @xmath51 .",
    "the physical justification for considering only the small scale solution is that it provides a linear force - free field with finite energy .",
    "following alissandrakis ( 1981 ) and gary ( 1989 ) , using parseval s theorem the energy of the linear force - free field  ( [ eq : ss_sol ] ) in the half space @xmath55 is @xmath56^{1/2}}.\\ ] ] once again this expression requires the fourier components @xmath50 to be identically zero for @xmath43 and @xmath44 such that @xmath57 .",
    "the large scale components of the field have infinite energy , and in this sense the general linear force - free boundary value problem has no physical solution ( alissandrakis , 1981 ) . in practice",
    "we use the fast fourier transform ( fft ) of the boundary field defined on an @xmath0 by @xmath0 grid over the region @xmath58 , @xmath59 .",
    "the smallest non - zero wavenumber that is determined from these ` observations ' of the field ( by analogy with magnetograph observations ) is @xmath60 .",
    "it follows that the energies determined from the discrete counterpart of  ( [ eq : e_f ] ) are finite for all @xmath0 provided @xmath61 .",
    "finally we note that the variation of  ( [ eq : e_f ] ) with @xmath62 for small values of the force - free parameter is made obvious by a binomial expansion : @xmath63 hence for small @xmath62 the non - potential component of the field scales with @xmath64 .",
    "the current in a loop in the circuit model is taken to be the axial current contained within a radius @xmath65 of the centre of a footpoint : @xmath66 using the boundary conditions  ( [ eq : bc1 ] ) or  ( [ eq : bc2 ] ) , and assuming that the footpoints are well separated . similarly @xmath67 where @xmath68 , and @xmath69 .",
    "the energy of the single loop model in the half space @xmath55 is then estimated using  ( [ eq : l ] ) : @xmath70 where @xmath71    similarly the energy of the two loop system can be expressed as @xmath72 where @xmath73 is the mutual inductance .",
    "for the general case ( loop major radii @xmath74 , @xmath75 , minor radii @xmath76 , @xmath77 , centres separated by @xmath78 , and axes oriented at an angle @xmath79 ) the non - dimensional version of the interpolating formula equation  ( [ eq : m_don ] ) from melrose ( 1997 ) may be used : @xmath80^{3/2}}.\\ ] ] for the more restricted case of line - current loops with their axes aligned ( @xmath81 ) the non - dimensional version of the exact equation  ( [ eq : stratton ] ) may be used : @xmath82,\\ ] ] where @xmath83",
    "figure  1 illustrates a single loop configuration , for the boundary conditions @xmath84 , @xmath85 , @xmath86 , and @xmath87 .",
    "( these values are adopted as nominal values . ) to construct this figure , the linear force - free field corresponding to  ( [ eq : ss_sol ] ) was calculated [ using the fft of equation  ( [ eq : bc1 ] ) ] on a @xmath88 grid corresponding to the region @xmath58 , @xmath59 , @xmath89 .",
    "field lines were traced for points at a radius @xmath90 from the positive footpoint .",
    "the free energy @xmath91 of the field can be estimated by taking the fft of the boundary field with @xmath0 gridpoints and then evaluating the integral  ( [ eq : e_f ] ) using the trapezoidal rule .",
    "we label this estimate @xmath92 .",
    "figure  2 shows how the result depends on @xmath0 , for the nominal choices of @xmath93 , @xmath94 , and @xmath62 .",
    "the upper panel plots @xmath92 versus @xmath0 , for @xmath95 . the lower panel plots @xmath96",
    "versus @xmath0 as a log - log plot .",
    "a condition for the sequence of values of @xmath92 to converge is that @xmath97 approaches unity as @xmath98 .",
    "the lower panel suggests that this is occurring , and moreover @xmath99 . for the calculations in the paper we have used @xmath100 .",
    "the estimates of @xmath92 for @xmath100 and @xmath101 differ by about @xmath102 , which suggests that @xmath100 is sufficiently accurate for present purposes .",
    "the first question to be addressed is the variation of the energy estimates with @xmath103 . to vary @xmath103 we have varied @xmath62 , while keeping @xmath94 fixed [ see equation  ( [ eq : i_1 ] ) ] .",
    "we have also chosen @xmath104 , and used the nominal values of @xmath93 and @xmath94 .",
    "the field estimate of the energy @xmath105 and the circuit estimate @xmath106 were calculated for 50 values of @xmath62 between @xmath107 and @xmath108 , with the values being equally spaced logarithmically .",
    "the results are plotted in figure  3 .",
    "the diamonds show the values of @xmath105 and the crosses show the values of @xmath106 .",
    "the vertical dashed line is @xmath109 and the horizontal dashed line is the estimate of @xmath110 , the energy of the potential component of the field .",
    "the energy estimates for the non - potential component of the field and the circuit energy estimates are generally much smaller than the energy of the potential component of the field .",
    "the energy estimates for the non - potential component of the field exhibit a @xmath111 dependence ( @xmath64 dependence ) for most of the chosen range , but increase more rapidly for large @xmath103 ( @xmath62 ) .",
    "this functional dependence is consistent with equation  ( [ eq : binomial ] ) .",
    "the field and circuit energy estimates are within a factor of two of one another for most of the chosen range , but are out by more than a factor of 10 close to the maximum value of @xmath62 .",
    "there is a simple physical interpretation for the observed dependence of the field energy on @xmath112 . for small values of the current the field associated with the current",
    "is small , and the magnetic field is dominated by the potential component .",
    "the current essentially follows the fieldlines of the potential field , i.e.  there is a fixed geometrical path for the current . in this case",
    "the self - inductance defined by equation  ( [ eq : general_l ] ) is independent of the current . for larger values of the current",
    "this is no longer the case : the field due to the current becomes comparable to the potential component of the field , and the path that the current takes then depends on the current . in particular , larger currents will tend to produce longer current paths , so the effective self - inductance will increase with current . in other words equation  ( [ eq : general_l ] ) increases with current .    another question is the dependence of energy on the geometry of the loop .",
    "the major radius @xmath113 was varied between 0.05 and 0.25 for the nominal choices of the other parameters , and figure  4 shows the results .",
    "the energy estimates @xmath105 were divided by @xmath114 [ see equation  ( [ eq : l ] ) ] to produce effective self - inductances , which are shown by diamonds .",
    "results are shown for @xmath115 and @xmath116  the effective self - inductances for the larger value of @xmath62 are slightly larger , for all values of major radius .",
    "the self - inductances @xmath117 are indicated by crosses .",
    "this figure shows that the non - potential component of the field energy varies with major radius in a manner similar to that expected from the circuit model for the chosen range of values .",
    "the inferred self - inductance increases monotonically , as expected on the basis of the increase in area under the loop .",
    "however the precise functional dependence of the inferred self - inductance is somewhat different from that expected from the simple model @xmath117 .",
    "the similar results for the different values of @xmath62 show that the inferred self - inductance is almost independent of the value of the current , as expected on the basis of the argument given above .",
    "the minor radius dependence of energy was also examined .",
    "figure  5 shows the effective self - inductance associated with the non - potential component of the magnetic field ( diamonds ) for @xmath94 between 0.01 and 0.1 , and for the nominal values of the other parameters .",
    "the values of @xmath117 are also plotted ( crosses ) .",
    "this figure shows that the variation of the magnetic field energy with @xmath94 is qualitatively consistent with the circuit model . the effective self - inductance decreases with @xmath94 , as expected from the decrease in area within within the loop as the minor radius of the loop increases .",
    "figure  6 illustrates a particular two - loop configuration , for the boundary conditions @xmath118 , @xmath119 , @xmath120 , @xmath121 , @xmath122 , @xmath123 , and @xmath87 .",
    "these choices correspond to loops with major radii @xmath124 , with a distance @xmath125 between their centres , and with axes at right angles to one another ( @xmath126 ) .",
    "there are many energy dependences which could be investigated for two - loop configurations . however ,",
    "from the point of view of the circuit model the interest is with the energy associated with the interaction between the loops , described by the mutual inductance .",
    "the interaction energy is determined in the following way .",
    "the field energy @xmath105 for the two loops is calculated .",
    "then the field energy @xmath127 for loop one is calculated ( the free energy of the small scale linear force - free field with the boundary conditions of loop one ) .",
    "similarly the field energy @xmath128 for loop two is calculated .",
    "the energy @xmath129 is the interaction energy .",
    "dividing this quantity by @xmath130 defines an effective mutual inductance @xmath131 , which may be compared with circuit estimates .",
    "first we consider a comparison with the stratton ( 1941 ) formula  ( [ eq : stratton_nd ] ) , since it is an exact expression for mutual inductance ( albeit for line currents ) .",
    "recall that it is applicable only to the case of loops with aligned axes ( @xmath81 ) .",
    "the dependence of the mutual inductance on the major radius of loop two was investigated for loop parameters @xmath132 , @xmath125 , @xmath122 , @xmath81 , @xmath123 , @xmath87 , with the major radius of loop two taking 20 values in the range @xmath133 to @xmath134 .",
    "figure  7 shows the results .",
    "the points marked by diamonds are the mutual inductances calculated for the field following the procedure outlined above .",
    "the points marked with crosses are the mutual inductances given by the formula  ( [ eq : stratton_nd ] ) .",
    "the inferred mutual inductances are qualitatively consistent with the circuit values , and a similar functional dependence is observed .",
    "next we examine the melrose ( 1997 ) interpolation formula  ( [ eq : m_12 ] ) , which is more general than the stratton ( 1941 ) formula , but is approximate .",
    "we considered a two - loop configuration with fixed parameters but with different values of @xmath79 , corresponding to a rotation of loop two with respect to loop one .",
    "specifically the values @xmath124 , @xmath125 , @xmath122 , @xmath123 , and @xmath87 were chosen , together with 21 values of @xmath79 in the range @xmath135 .",
    "figure  8 shows the results .",
    "the crosses are the circuit values .",
    "following equation  ( [ eq : m_12 ] ) the circuit model exhibits a simple cosine dependence on @xmath79 , and in particular is zero for @xmath126 , because perpendicular loops have no flux linkage .",
    "the diamonds are the values of @xmath131 determined following the procedure outlined above .",
    "the observed functional dependence is essentially cosine , and indeed the effective mutual inductance is very close to zero for @xmath126 .",
    "however , the values of @xmath131 are considerably larger than the values given by the melrose formula : the ratio of the values is close to eight over the range of @xmath79 .",
    "this figure also shows the mutual inductance obtained using the stratton ( 1941 ) formula for the special case @xmath81 as an asterisk .",
    "the stratton value is slightly larger than @xmath131 for @xmath81 , and is considerably larger than the melrose value .",
    "it is notable that the melrose value differs from the stratton value by more than an order of magnitude in this case .",
    "in this paper calculated energies of non - potential components of linear force - free fields are compared with simple circuit model estimates , for boundary conditions suggestive of one and two magnetic loops .",
    "the motivation is to test the circuit models , which are often invoked to estimate coronal magnetic field energies . in particular circuit models",
    "have been used to describe flare - related energy changes . in the melrose ( 1997 ) model , preferred magnetic configurations for flaring are identified on the basis of geometrical dependences of circuit energy estimates .    in ",
    "3.1 results for a single loop configuration are presented .",
    "an important result is the @xmath62-dependence of the energy of the non - potential component of the field . for a range of small values of the force - free parameter @xmath62 the free energy",
    "is found to be proportional to @xmath64 , or equivalently to be proportional to the square of the current in the loop , consistent with the circuit model .",
    "this result is explained mathematically in terms of the @xmath64 dependence of the free energy appearing in equation  ( [ eq : binomial ] ) for small @xmath62 . for larger values of current ( or @xmath62 ) the free energy increases more rapidly than the circuit prediction .",
    "this result is also expected for the two - loop configuration , since equation  ( [ eq : binomial ] ) applies for any boundary conditions .",
    "a simple physical interpretation of this result is as follows . for small values of @xmath62",
    "the non - potential component of the field is small compared to the potential component , and the current essentially follows the fieldlines of the potential field .",
    "hence as @xmath62 is varied the geometry of the current does not change and the inductances [ which are geometrical quantities  see equations  ( [ eq : general_l ] ) and  ( [ eq : general_m ] ) ] are constant .",
    "this situation corresponds to the free energy scaling with the square of the current ( or @xmath64 ) . for larger values of @xmath62",
    "the non - potential component of the field becomes comparable to the potential component , and influences the path of the current . in this case the geometry [ and hence the inductances as defined by equations  ( [ eq : general_l ] ) and  ( [ eq : general_m ] ) ] depend on @xmath62 , which corresponds to the free energy scaling with a higher power of @xmath62 .",
    "although demonstrated here for a class of linear force - free fields , this effect is expected to be quite general and to limit the accuracy of simple circuit models in application to any force - free field for large values of current .    in  3.1 the dependence of the free energy of the field on the geometry of the loop",
    "is also investigated ( for a modest value of @xmath62 ) .",
    "the functional dependences on minor radius and major radius are found to be qualitatively consistent with the circuit model .",
    "section  3.2 presents the results for the two - loop configuration .",
    "the interaction energy of the two loops is obtained by calculating the free energy of the loops together and then subtracting off the individual free energies of each loop .",
    "this procedure is used to calculate an effective mutual inductance @xmath131 for the field .",
    "this was then compared with simple circuit model formulae , namely an exact expression for the mutual inductance of two axially - aligned line - current loops due to stratton ( 1941 ) , and an approximate expression for the mutual inductance of oblique loops with finite cross section due to melrose ( 1997 ) .",
    "the stratton formula is found to qualitatively reproduce the observed variation of @xmath131 with the major radius of one loop .",
    "the melrose formula is compared with @xmath131 as one loop is rotated with respect to the other .",
    "the effective mutual inductance of the field reproduces the cosine dependence in the melrose formula , and in particular the inferred mutual inductance is close to zero for the case of perpendicular loops .",
    "however , the calculated values of @xmath131 are almost an order of magnitude larger than the melrose formula values .",
    "comparison with the stratton formula for the case of parallel loops confirms that , for the chosen parameters , the melrose formula underestimates the actual interaction energy .",
    "the melrose expression is an interpolation between known results , and so the discrepancy can be attributed to the approximate nature of the formula .    in this paper linear force - free fields have been used because they are straightforward to calculate .",
    "it is likely that real coronal magnetic fields involve currents that are spatially highly concentrated , and hence require a nonlinear force - free model ( or a description involving non - zero pressure forces ) . in this case circuit models may provide quite accurate energy estimates because the configuration closely resembles a set of isolated circuits . however , it is also possible that in the nonlinear case the current path sensitively depends on the value of the current , in particular for large currents , and this may limit the accuracy of simple circuit models , as discussed above .",
    "another point to note is that circuit models are really only useful if there are a small number of circuits which are easily identified . in this paper",
    "we have considered widely separated magnetic structures , which as a result have simple connectivity . in general coronal fields have a complicated topology , and it may be difficult to identify coronal current paths .",
    "circuit models appear to provide reasonably accurate free energy estimates for coronal magnetic field configurations for a range of values of the current , and also qualitatively describe various functional dependences of the free energy ( the dependence on loop major radii , the dependence on the angle between two loops , etc . ) .",
    "simple circuit models are less accurate for very large values of the current , when the current path depends on the value of the current . despite this reservation ,",
    "the results of this paper confirm the general utility of circuit models , in particular in their application to the flare phenomenon .",
    "m.s.w . acknowledges the support of an australian research council qeii fellowship .",
    "alfvn , h. and carlqvist , p. : 1967",
    ", _ sol .",
    "_ , * 1 * , 220 .",
    "alissandrakis , c.e . : 1981 , _ astron .",
    "_ , * 100 * , 197 . [",
    "[ ] chi&hil77 chiu , y.t . , and",
    "hilton , h.h .",
    "1977 , _ astrophys .",
    "j. _ , * 212 * , 873 .",
    "gary , g.a . : 1989 , _ astrophys .",
    "j.  supp .",
    "_ , * 69 * , 323 .",
    "jackson , j.d . : 1998 , _ classical electrodynamics _",
    ", 3rd ed . , john wiley , new york .",
    "khodachenko , m. , haerendel , g. , and rucker , h.o . : 2003 , _ astron .",
    "_ , * 401 * , 721 .",
    "khodachenko , m.l . and",
    "zaitsev , v.v . : 1998 , _ astron .  rep .",
    "_ , * 42 * , 265",
    ". landau , l.d . and lifshitz , e.m .",
    ": 1960 , _ electrodynamics of continuous media _ , pergamon , oxford .",
    "longcope , d.w . and",
    "noonan , e.j .",
    ": 2000 , _ astrophys .",
    "j. _ , * 542 * , 1088 .",
    "melrose , d.b . : 1995 , _ astrophys .",
    "j. _ , * 451 * , 391 .",
    "melrose , d.b . : 1997 , _ astrophys .",
    "j. _ , * 486 * , 521 .",
    "nakagawa , y. and raadu , m.a .",
    ": 1972 , _ sol .",
    "_ , * 25 * , 127 somov , b.v . : 1992 , _ physical processes in solar flares _ , kluwer , dordrecht .",
    "spicer , d.s . : 1982 , _ space sci .",
    "_ , * 31 * , 351 .",
    "sturrock , p.a . : 1994 , _ plasma physics _ , cambridge university press , cambridge stratton , j.a .",
    ": 1941 , _ electromagnetic theory _ , mcgraw - hill , new york tandberg - hanssen , e. and emslie , a.g .",
    ": 1988 , _ the physics of solar flares _ , cambridge university press , cambridge ."
  ],
  "abstract_text": [
    "<S> circuit models involving bulk currents and inductances are often used to estimate the energies of coronal magnetic field configurations , in particular configurations associated with solar flares . </S>",
    "<S> the accuracy of circuit models is tested by comparing calculated energies of linear force - free fields with specified boundary conditions with corresponding circuit estimates . </S>",
    "<S> the circuit models are found to provide reasonable ( order of magnitude ) estimates for the energies of the non - potential components of the fields , and to reproduce observed functional dependences of the energies . </S>",
    "<S> however , substantial departure from the circuit estimates is observed for large values of the force - free parameter , and this is attributed to the influence of the non - potential component of the field on the path taken by the current . </S>"
  ]
}