{
  "article_text": [
    "dyadic data are central in social science applications ranging from international relations to `` speed dating . ''",
    "a challenge with dyadic data is to account for the complex dependency structure that arises due to the connections between dyad members .",
    "for instance , in a study of international conflict , a change in leadership in one country may affect relations with all countries with which that country is paired in the data , thereby inducing a correlation between these dyadic observations .",
    "this generates a cluster of dependent observations associated with that country .",
    "as leadership changes occur in multiple countries , the correlations emanating from each of these countries will overlap into a web of interwoven clusters .",
    "we refer to such interwoven dependency in dyadic data as `` dyadic clustering . '' by ignoring the dyadic clustering , the analysis would take the dyad - level changes emanating from a single leadership change as independently informative events , rather than a single , clustered event .",
    "an analysis that only accounts for correlations in repeated observations of dyads ( whether by clustering standard errors or using dyad fixed effects ) would fail to account for such inter - dyad correlation .    statistical analysis of dyads typically estimates how dyad - level outcomes ( e.g. , whether there is open conflict between countries or the decision for one person to ask another on a date ) relate to characteristics of the individual units as well as to the dyad as a whole ( e.g. , measures of proximity between units ) .",
    "the usual approach is to regress the dyad - level outcome on unit- and dyad - level predictors . due to dyadic clustering ,",
    "the observations contributing to such an analysis are not independent .",
    "failure to account for dyadic clustering may result in significance tests or confidence intervals with sizes that are far too small relative to the true distribution of the parameters of interest .",
    "we establish sufficient conditions for the consistency of a non - parametric sandwich estimator @xcite for the variance of regression coefficients under dyadic clustering .",
    "cluster - robust sandwich estimators are common for addressing dependent data ( ( * ? ? ?",
    "8) ; @xcite ) .",
    "@xcite provide a sandwich estimator for `` multi - way '' clustering , accounting , for example , for clustering between people by geographic location and age category .",
    "we extend these methods to dyadic clustering , accounting for the fact that dyadic clustering does not decompose neatly into a few crosscutting and disjoint groups of units ; rather , each _ unit _ is the basis of its own cluster that intersects with other units clusters .",
    "2.5 ) propose a sandwich estimator for dyadic clustering that is very similar to what we propose below .",
    "their derivation is constructed through analogy to the results of @xcite .",
    "however , neither paper establishes conditions for consistency under dyadic clustering .",
    "we establish such consistency conditions .",
    "we also provide extensions to the longitudinal case and generalized linear models such as logistic regression . we evaluate performance with simulations and a reanalysis of a classic study on interstate disputes @xcite .",
    "the appendix generalizes to weighted data and generalized linear models , and the supporting information provides another illustration with a speed dating experiment @xcite .",
    "current statistical approaches to handling dyadic clustering include the use of parametric restrictions in mixed - effects models @xcite , the spatial error - lag model @xcite , or permutation inference for testing against sharp null hypotheses @xcite .",
    "these approaches have important limitations that our approach overcomes .",
    "first , mixed effects models and spatial lag models impose a parametric structure to address the clustering problem .",
    "this makes them sensitive to misspecification of the conditional mean ( that is , deviations between the data and the linearity assumption ) .",
    "our approach is robust in that it provides asymptotically valid standard errors even under such misspecification .",
    "this is valuable in itself to the extent that models are typically approximations @xcite , although readers should not take this to mean that they are free from the obligation to fit as good an approximation as possible .",
    "it is also valuable in providing a reliable benchmark to use in evaluating model specification @xcite .",
    "second , @xcite s solution of non - parametric randomization inference does not provide a procedure for obtaining valid confidence intervals , while our procedure does .",
    "third , all three of these alternatives require considerable computational power , possibly exceeding available computational resources even for data analyses that are common in international relations or network analysis .",
    "we demonstrate below that a mixed - effects or spatial error - lag approach is infeasible in a typical international relations example .",
    "in contrast , our proposed estimator is easy to compute .",
    "the variance estimation methods we develop are a natural complement to non- and semi - parametric approaches to regression with dyadic data @xcite .",
    "we work within the  agnostic \" @xcite or `` assumption lean '' @xcite regression framework developed by @xcite , @xcite , and @xcite .",
    "we begin with a cross - section of undirected dyads and derive the basic convergence results for this case .",
    "below we extend these results to repeated dyads , which covers directed dyads and longitudinal data .",
    "proofs are in the appendix .",
    "begin with a large population from which we take a random ( i.i.d . )",
    "sample of units , with the sample members indexed by @xmath0 and grouped into @xmath1 dyads .",
    "pairs of unit indices within each dyad map to dyadic indices , @xmath2 , through the index function @xmath3 , with an inverse correspondence @xmath4 , and we assume no @xmath5 type dyads . consider a linear regression of @xmath6 on a @xmath7-length column vector of regressors @xmath8 ( which includes the constant ) : @xmath9 where @xmath10 is the slope that we would obtain if we could fit this model to the entire population , allowing for possible non - linearity in the true relationship between @xmath11 $ ] and @xmath8 , and @xmath12 is the corresponding population residual.$ ] is nonlinear in @xmath8 , the population residual will itself vary in @xmath8 , which undermines inference that assumes that @xmath12 is independent of @xmath8 .",
    "the agnostic regression approach avoids such an assumption . ] to lighten notation , for the remainder of the discussion we use @xmath13 .",
    "define the sample data as @xmath14 and @xmath15 .",
    "the ordinary least squares ( ols ) estimator is @xmath16 with residual @xmath17 . since the values of @xmath18 and @xmath19",
    "are determined by the characteristics of the units @xmath20 and @xmath21 , @xmath22 and @xmath23 for dyads containing either unit @xmath20 or @xmath21 are allowed to be correlated by construction . however , by random sampling of units , @xmath24 for all dyads that do not share a member . the number of pairwise dependencies between @xmath20 and @xmath21 for which @xmath25 is @xmath26 .",
    "let the support for @xmath27 and @xmath28 be bounded in a finite interval and assume the usual rank conditions on @xmath29 @xcite .",
    "[ lemma - var ] suppose data and @xmath30 as defined above . as @xmath31 , the asymptotic distribution of @xmath32 has mean zero and variance @xmath33^{-1}\\var\\left[\\sum_{d=1}^d x_d\\epsilon_d\\right]\\e[x_dx_d']^{-1 } , \\label{varb}\\ ] ] with , @xmath34 = \\sum_{d=1}^d \\left ( \\underbrace{\\e\\{x_{d}x'_d \\var[\\epsilon_d|{\\mathbf{x}}]\\}}_{a } + \\underbrace{\\sum_{d ' \\in \\mathcal{s}(d ) } \\e\\{x_{d}x'_{d ' } \\cov[\\epsilon_d,\\epsilon_{d'}|{\\mathbf{x}}]\\}}_{b } \\right ) , \\label{varxe}\\ ] ] where @xmath35 , the set of dyads other than @xmath36 that share a member from @xmath36 .",
    "@xmath37 is the dyad - specific contribution to the variance , and @xmath38 is the contribution due to inclusion of common units in multiple dyads .",
    "note that these features of the distribution of @xmath32 establish the consistency of @xmath30 as well , which is not surprising given standard results for the consistency of ols coefficients on dependent data @xcite .",
    "given data as defined above , we examine the properties of a plug - in variance estimator that is analogous to the sandwich estimators defined for heteroskedastic or clustered data @xcite .",
    "we establish sufficient conditions for consistency of the plug - in variance estimator .",
    "we consider the cross - sectional case and repeated observations case .",
    "the appendix also contains extensions to weighted observations and generalized linear models .",
    "define the variance estimator @xmath39 under the conditions of lemma [ lemma - var ] and if @xmath27 and @xmath40 have bounded support with non - zero second moments and cross - moments , then as @xmath31 , @xmath41 [ prop1 ]    the proposition indicates that @xmath42 provides a consistent estimator to characterize the true asymptotic sampling distribution of the regression coefficients , @xmath30 .",
    "standard error estimates for @xmath30 are obtained from the square roots of the diagonals of @xmath42 .",
    "the assumption of bounded support for @xmath27 and @xmath40 merely rules out situations that are unlikely to arise in real world data anyway ( e.g. , where the mass of the data pushes out toward infinity as @xmath43 grows ) .",
    "repeated dyad observations are common in applied settings . for example , the data may include multiple observations for dyads over time .",
    "dyadic panels are very common in studies of international relations . or ,",
    "if the dyadic information is directional , then the data will contain two observations for each dyad , with one observation capturing outcomes that go in the @xmath20 to @xmath21 direction , and the other capturing outcomes that go in the @xmath21 to @xmath20 direction .",
    "this is conceptually distinct from repeated observations over time .",
    "but if there are dyadic dependences for both senders and receivers of a directed dyad , then the dependence structure for a pair of directed @xmath20-@xmath21 dyads will be the same as if we had repeated observations of an undirected @xmath20-@xmath21 dyad .",
    "the results above translate straightforwardly to the repeated dyads setting . formally",
    ", suppose that for each dyad @xmath36 observations are indexed by @xmath44 , where the @xmath45 values are fixed and finite .",
    "let @xmath46 represent the data for observation @xmath47 from dyad @xmath36 , @xmath48 and @xmath49 and @xmath50 , that is , the stacked @xmath28 vectors and @xmath27 matrices .",
    "let @xmath51 and @xmath52 denote , respectively , the population slope and ols estimator as defined above but now applied to the repeated dyads data .",
    "for the repeated dyads case , assume the same conditions as in proposition [ prop1 ] and consider the following variance estimator @xmath53 then as @xmath31 , @xmath54 - v_r \\overset{p}{\\rightarrow } 0,\\ ] ] and @xmath55 where @xmath56 ^ 2 } \\e[x_dx_d']^{-1 } \\e\\left ( \\e\\left[x_d'\\cov[\\epsilon_d|{\\mathbf{x}}]x_d\\right ] + \\sum_{d ' \\in \\mathcal{s}(d)}\\e\\left [ x_d'\\cov[\\epsilon_d , \\epsilon_{d'}|{\\mathbf{x}}]x_{d'}\\right]\\right ) \\e[x_dx_d']^{-1}.\\ ] ]    some remarks are in order when it comes to the repeated observations case .",
    "first , our analysis of the repeated observations case takes the @xmath45 values to be fixed and finite and demonstrates consistency as @xmath43 grows . in a cross - national study",
    ", this would mean that one should pay most attention to the number of countries , rather than the amount of time , that are in the data . under fixed @xmath43 and growing @xmath45 further assumptions would be required for consistency , such as serial correlation of fixed order or , more generally , strong mixing over time .",
    "second , with repeated observations , a common strategy for identifying effects is to use dyad - specific fixed effects @xcite . with fixed and finite @xmath45",
    ", this does not introduce any new complications .",
    "as in @xcite for the case of serial correlation with fixed effects , the results for dyadic clustering translate directly to centered data , and dyadic fixed - effects regression amounts to centering the data on dyad - specific means . with fixed @xmath43 and growing @xmath45 ,",
    "however , additional assumptions are needed for consistency @xcite .    for efficient computation ,",
    "we follow @xcite to perform a `` multi - way decomposition '' of the dyadic clustering structure :    we have the following algebraic equivalence , @xmath57 where @xmath58 @xmath59 @xmath60 and @xmath61 @xmath62 [ prop - decomp ]    @xmath63 is the usual asymptotically consistent cluster - robust variance estimator ( with no degress - of - freedom adjustment ) that clusters all dyads containing unit @xmath20 and assumes all other observations to be independent .",
    "@xmath64 is the same cluster robust estimator but clustering all repeated dyad observations .",
    "@xmath65 is the usual asymptotically consistent heteroskedasticity robust ( hc ) variance estimator that assumes all observations ( even within repeated dyad groupings ) are independent . to understand this decomposition , note that dyadic clustering involves clustering on each of @xmath43 units .",
    "but in summing the contributions from unit - specific clusters ( the @xmath63s ) , we double count the dyad contributions ( @xmath64 ) and add in the independent contributions ( @xmath66 ) @xmath43 times .",
    "we can correct for this by subtracting @xmath64 , which also removes the @xmath66 component , and then subtracting @xmath67 of the @xmath66 components .",
    "( the cross section cases simply sets @xmath68 ) .",
    "this decomposition shows that one can compute the dyadic cluster robust estimator using readily available robust standard error commands .",
    "our dyadic cluster robust variance estimator allows one to perform valid inference under less restrictive dependence assumptions that are used to identify random effects or spatial error lag models .",
    "our multi - way decomposition also shows that it is computationally much simpler than those alternatives .",
    "the latter point is relevant when one has many units or time periods in which case random effects and spatial error lag models , despite their restrictions , may be infeasible with current computational resources given the challenges of evaluating a likelihood with as many dependencies as emerge in a dyadic analysis .",
    "we use monte carlo simulations to evaluate the finite sample properties of the proposed estimators under the cross - sectional and repeated dyads settings . we suppose that population values obey the following , @xmath69 where @xmath70 is the @xmath71 observed outcome for the dyad that includes units @xmath20 and @xmath21 , @xmath72 , @xmath73 , @xmath74 , @xmath75 , and @xmath76 are independent draws from standard normal distributions , and the compound error , @xmath77 , is unobserved . in the cross - sectional case ,",
    "we only observe one outcome per dyad , so @xmath78 for all observations ( that is , the @xmath47 subscript is extraneous for the cross - sectional case ) . in the repeated observations case , we have two observations per dyad , so @xmath79 for all dyads .",
    "we fix @xmath80 and @xmath81 .",
    "we use ols to estimate @xmath82 and @xmath83 . in the supplemental information",
    "we show results for mixed effects models as well .",
    "the fact that @xmath72 and @xmath74 are constant across dyads that include unit @xmath20 ( same for @xmath21 ) implies non - zero intra - class correlation in both @xmath84 and @xmath85 among sets of dependent dyads , in which case ignoring the dependence structure will tend to understate the variability in @xmath82 and @xmath83 .",
    "this is the dyadic version of @xcite s problem .",
    "results from 500 simulation runs are shown in figure [ fig : sim1 ] .",
    "the @xmath86-axis shows the sample size , where we show results for samples with 20 , 50 , 100 , and 150 units ( implying 190 , 1,225 , 4,950 , and 11,175 dyads , respectively ) .",
    "the @xmath87-axis is on the scale of the standard error of the coefficients .",
    "the black diamonds plot the empirical standard standard errors for each of the sample sizes ( that is , the standard deviation of the simulation replicates of the coefficient estimates , @xmath82 and @xmath83 ) .",
    "the black box plots show the distribution of our proposed standard error estimator .",
    "the gray box plots show , in the top figures , the distribution of the `` hc2 '' heteroskedasticity robust variance estimator , which does not account for either dyadic or repeat observation clustering @xcite , and for the bottom figures , the `` cluster robust '' analog of @xcite s estimator accounting for dependence in repeated dyad observations @xcite",
    ".     goes from 20 to 150 ( implying number of dyads goes from 190 to 11,175 ) for a cross section of dyads ( top ) and repeated dyad observations ( t=2 for all dyads ) .",
    "black box plots show the distribution of standard error estimates using the proposed dyadic cluster robust estimator . in the top two figures ,",
    "gray box plots show standard error estimates from a heteroskedasticity robust estimator while in the bottom two figures , gray box plots show standard error estimates from a `` naive '' cluster - robust estimator that clusters by dyad over repeated observations ( but does not cluster by units across dyads ) .",
    ", title=\"fig:\",scaledwidth=100.0% ]   goes from 20 to 150 ( implying number of dyads goes from 190 to 11,175 ) for a cross section of dyads ( top ) and repeated dyad observations ( t=2 for all dyads ) .",
    "black box plots show the distribution of standard error estimates using the proposed dyadic cluster robust estimator . in the top two figures ,",
    "gray box plots show standard error estimates from a heteroskedasticity robust estimator while in the bottom two figures , gray box plots show standard error estimates from a `` naive '' cluster - robust estimator that clusters by dyad over repeated observations ( but does not cluster by units across dyads ) .",
    ", title=\"fig:\",scaledwidth=100.0% ]    convergence of our proposed standard errors based on @xmath42 and @xmath88 ( black box plots ) to the true standard error ( black diamonds ) is quick .",
    "the alternative estimators , which do not account for dyadic clustering , grossly understate the variability in the coefficient estimates .",
    "these results suggest that in finite samples from data generating processes that resemble our simulations , the proposed estimator is quite reliable for inference on ols coefficients so long as the sample size is on the order of 50 to 100 units .",
    "most applications in political science operate with samples of at least this size .",
    "changes to the shape of the error distributions ( e.g. , uniform or bimodal ) yield the same results .    in the supporting information , we demonstrate comparisons between mixed effects models and our `` robust '' estimator .",
    "we sought also to include a comparison to spatial error lag models , but the models failed to converge with @xmath89 .",
    "we note that in the original @xcite paper , they limited their analysis of dyadic data to small cross sections .",
    "our experience suggests that it may be infeasible to fit such models with substantially larger datasets . ] specifically , we compare ols with dyadic cluster robust standard errors to a two - way random effects model that incorporates normal random effects for each of the @xmath43 units @xcite . the data generating process captured above ( that is , expression [ eq : dgp ] with normal data ) corresponds precisely to the assumptions of a two - way normal random effects model , and so it is no surprise that we find this model to be more efficient than ols and to produce consistent standard errors .",
    "however , as discussed above , such models are sensitive to misspecification .",
    "for example , in fitting a linear approximation model to mildly non - linear data , the dyadic cluster robust standard errors continue to be consistent for the coefficients of the linear approximation .",
    "the degree of misspecification in this case is not extreme ( as illustrated in the appendix ) and resembles the kind of approximations that is common in applied work @xcite .",
    "nonetheless , the random effects standard errors are inconsistent and substantially anti - conservative . such sensitivity",
    "to misspecification is one problem for the random effects model .",
    "another problem arises when there is unobserved country - level heterogeneity that could confound estimates of the coefficients of interest .",
    "in such situations , our dyadic cluster robust estimator would be a natural complement to a fixed effects analysis , analogous to what @xcite proposes for non - dyadic repeated observation settings .",
    "the third problem arises in computational feasibility , an issue that arises in our application to which we now turn .",
    "our application is based on the classic study by @xcite on the determinants of international militarized conflicts .",
    "they study how the likelihood of a militarized dispute between states in a dyad relates to various dyad - level attributes , including an indicator of whether the two states are formal allies , the log of the ratio of an index of military capabilities , the lowest score in the dyad on a democracy index , the ratio of the value of trade and the larger gdp of the two states , an indicator of whether both states are members of a common international organization , an indicator of whether the states are geographically noncontiguous , the log of the geographic ( euclidean ) distance between the two states capitals , and an indicator of whether both states are `` minor powers '' in the international system .",
    "dyadic clustering could arise in many ways with these data , for example if a country entered into an alliance , thereby changing the joint alliance indicators , or if the military capabilities of a country changed , thereby changing the power ratios .",
    "we replicate russett and oneal s primary analysis as reported in their table a5.1 .",
    "they use annual data on 146 states in the international system paired into 1,178 dyads ( out of 10,585 possible ) and observed for as few as one and as many as ninety years between 1885 and 1991 , for a total of 39,988 observations . in their original analysis ,",
    "russett and oneal fit a gee model assuming ar(1 ) errors within dyads over time @xcite .",
    "table [ tab : russett ] shows the results of our reanalysis .",
    "columns ( 1 ) and ( 2 ) replicate the original published results . columns ( 3)-(6 ) show coefficients and various standard error estimates for a simple ( pooled ) logistic regression .",
    "there is little difference in the coefficient estimates from the gee - ar(1 ) model as compared to the simple logistic regression , so we focus on the standard error estimates .",
    "column ( 4 ) contains estimates that account only for dyad - year heteroskedasticity , column ( 5 ) also accounts for arbitrary dependence over time for each dyad , and then column ( 6 ) also accounts for dyadic clustering .",
    "accounting for the dyadic and repeated - observation clustering results in standard error estimates that are sometimes an order of magnitude larger than what we obtain when we ignore all clustering and also considerably larger than what one would estimate were one to account for repeated dyads clustering but ignore the inter - dyadic clustering .",
    "the latter result is also relevant when comparing the standard errors from the original gee - ar(1 ) model , as they resemble the estimates in column ( 5 ) . in their original analysis , russett and",
    "oneal found that all of the predictors had a statistically significant relationship to the likelihood of militarized conflict .",
    "but when one takes into account dyadic clustering , the coefficient for international organizations would fail to pass a conventional significance test ( e.g. , @xmath90 ) .",
    "& & + & & & & het . & naive cluster & dyadic cluster + predictor of militarized conflict & coef . & s.e . & coef . & robust s.e . &",
    "robust s.e . & robust s.e .",
    "+ alliances & -0.539 & 0.159 & -0.595 & 0.069 & 0.175 & 0.265 + power ratio & -0.318 & 0.043 & -0.328 & 0.020 & 0.047 & 0.070 + lower democracy & -0.061 & 0.009 & -0.064 & 0.005 & 0.010 & 0.015 + lower dependence & -52.924 & 13.405 & -67.668 & 10.734 & 17.560 & 24.749 + international organizations & -0.013 & 0.004 & -0.011 & 0.002 & 0.005 & 0.008 + noncontiguity & -0.989 & 0.168 & -1.048 & 0.074 & 0.181 & 0.185 + log distance & -0.376 & 0.065 & -0.375 & 0.026 & 0.068 & 0.102 + only minor powers & -0.647 & 0.178 & -0.618 & 0.078 & 0.188 & 0.344 + constant & -0.128 & 0.536 & -0.181 & 0.211 & 0.562 & 0.840 +   +    [ tab : russett ]    we attempted also to study how inferences might change with a random effects approach and a spatial error lag approach .",
    "the appropriate random effects model would be a three - way random effects model to account for each state in a dyad as well as the dyad as a whole over time .",
    "we attempted to fit three - way random effects logit models using the lmer package in r and the melogit function in stata .",
    "we posted the jobs to a university cluster with 24 intel xeon cores and 48 gigabytes of ram per node . in neither case",
    "did the random effects models converge .",
    "in fact , in neither case could we obtain estimates of any form after days on the cluster .",
    "for the spatial error lag model , we sought to implement both the spatial error lag model in the spdep package in r and the two - step estimator of @xcite in stata .",
    "the latter take as an input dyadic dependence information that can be produced using the spundir package in stata .",
    "the spatial error lag model in the spdep failed to produce estimates and spundir package failed to resolve within reasonable time ( a week ) while running on the same cluster .. the computational complexity is due to the fact that the model attempts to account for dependence across all countries in the dataset ( rather than small subsets , as would be the case in a typical spatial analysis ) and the fact that in this application the set of cross - section units changes over time and therefore does not allow for a stable adjacency matrix over time . ]",
    "this brings to the foreground the issue of computational complexity , by which our cluster robust estimator is much less demanding .",
    "we have established convergence properties for a non - parametric variance estimator for regression coefficients that accounts for dyadic clustering .",
    "the estimator applies no restrictions on the dependency structure beyond the dyadic clustering assumption .",
    "the estimator is robust to the regression model being misspecified for the conditional mean .",
    "such robustness is important because regression analysis typically relies on linear ( in coefficients ) approximations of unknown conditional mean functions @xcite .",
    "of course our analysis in no way excuses analysts from their responsibility to obtain as good an approximation as possible nor does a robust fix for standard errors also solve the problem of finding a good approximation . given a reasonable approximation for the conditional mean , the methods we have developed here allow for more accurate asymptotic statistical significance tests and confidence intervals .",
    "the estimator is consistent in the number of units that form the basis of dyadic pairs .",
    "simulations show that the estimator approaches the true standard error with modestly - sized samples from a reasonable data generating process .",
    "applications show that inferences can be seriously anti - conservative if one fails to account for the dyadic clustering .",
    "this estimator is a natural complement to the non - parametric and semi - parametric regression analyses that are increasingly common in the social sciences @xcite .",
    "given that we can express the estimator as the sum of simpler and easy - to - compute robust variance estimators , it could be applied to any estimator for which a cluster - robust option is available .",
    "a cost of the robust approach is efficiency .",
    "our simulations show that a two - way ( for cross - sectional data ) random effects model can be considerably more efficient and provide reliable inference when the conditional mean is correctly specified .",
    "our robust estimator could provide the basis of a test for misspecification @xcite .",
    "if there is little evidence of misspecification , the random effects estimator would be a reasonable choice given its efficiency .",
    "however , problems of computational non - convergence may make the random effects estimator infeasible  we encountered this in our application when we tried to use a three - way random effects model for dyadic panel data .",
    "of course , accounting for dynamic dyadic clustering may fail to fully account for all relevant dependencies in the data .",
    "for example , units may exhibit higher - order network effects : for example a shock to unit @xmath37 may affect unit @xmath91 through connections that run via a third unit , @xmath38 . in such cases , the methods developed here will likely yield standard errors that are too small , although they should still outperform methods that fail even to account for dyadic clustering .",
    "we have @xmath92^{-1 } \\frac{\\sqrt{n}}{d } \\sum_{d=1}^d x_d \\epsilon_d.\\ ] ] take @xmath93^{-1}$ ] first . by continuity of the inverse , the finite support of @xmath27 and @xmath40 , @xmath29 full rank , and the fact that the sum of dependent terms in this sum is @xmath94 ( * ? ? ?",
    "2.8.4 ) , we have that @xmath95^{-1 } \\overset{p}{\\rightarrow } \\e[x_d x_d']^{-1}.\\ ] ] by slutsky s theorem , @xmath32 has the same asymptotic distribution as @xmath96^{-1}\\frac{\\sqrt{n}}{d}\\sum_{d=1}^d x_d\\epsilon_d$ ] , which has mean zero and variance , @xmath33^{-1}\\var\\left[\\sum_{d=1}^d x_d\\epsilon_d\\right]\\e[x_dx_d']^{-1}. \\label{varb}\\ ] ]    then , @xmath97 & = \\sum_{d=1}^d \\sum_{d'=1}^d \\cov[x_d\\epsilon_d , x_{d'}\\epsilon_{d'}]\\nonumber \\\\ & = \\sum_{d=1}^d\\sum_{d'=1}^d \\e\\{x_{d}x'_{d ' } \\cov[\\epsilon_d,\\epsilon_{d'}|{\\mathbf{x}}]\\}\\nonumber \\\\ & = \\sum_{d=1}^d \\left ( \\underbrace{\\e\\{x_{d}x'_d \\var[\\epsilon_d|{\\mathbf{x}}]\\}}_{a } + \\underbrace{\\sum_{d ' \\in \\mathcal{s}(d ) } \\e\\{x_{d}x'_{d ' } \\cov[\\epsilon_d,\\epsilon_{d'}|{\\mathbf{x}}]\\}}_{b } \\right ) \\label{varxe}\\end{aligned}\\ ] ] where @xmath35 , the set of dyads other than @xmath36 that share a member from @xmath36 .",
    "by chebychev s inequality , two conditions are sufficient for @xmath98 as @xmath31 : ( i ) @xmath99 \\rightarrow 0 $ ] , and ( ii ) @xmath100 = \\var[n\\hat v ] \\rightarrow 0 $ ] ( * ? ? ?",
    ".    for ( i ) , consider the interior ( `` meat '' ) of @xmath42 : @xmath101 and the corresponding term for @xmath102 : @xmath103\\ } + \\sum_{d ' \\in \\mathcal{s}(d ) } \\e\\{x_{d}x'_{d ' } \\cov[\\epsilon_d,\\epsilon_{d'}|{\\mathbf{x}}]\\ } \\right).\\ ] ] we have @xmath104 = \\sum_{d=1}^d \\left ( \\e\\{x_{d}x'_d \\e [ e_d^2|{\\mathbf{x}}]\\ } + \\sum_{d ' \\in \\mathcal{s}(d ) } \\e \\{x_{d}x'_{d ' } \\e[e_d e_{d'}|{\\mathbf{x}}]\\}\\right ) \\rightarrow \\sigma\\ ] ] by consistency of @xmath30 , an implication of lemma [ lemma - var ] .",
    "lemma [ lemma - var ] also established that @xmath105^{-1}$ ] , while boundedness of @xmath27 implies uniform boundedness of @xmath96^{-1}$ ] . taking these elements together",
    ", uniform continuity implies @xmath99 \\rightarrow 0 $ ] ( cf .",
    "@xcite , thm .",
    "1 ) .    for ( ii )",
    ", we follow the strategy of @xcite , which requires showing that growth of covariance contributions due to dependent units is bounded in @xmath43 .",
    "begin by rewriting @xmath106 as @xmath107 where @xmath108 is an indicator function denoting a pair of dyads @xmath36 and @xmath109 that share a member , as defined above .",
    "we have established that @xmath110 converges in probability to a finite limit , @xmath111^{-1}$ ] , so we can treat this as @xmath112 . given bounded support , @xmath113 $ ] is of the same order as @xmath114 \\nonumber \\\\ & = n^2 d^{-4 } \\sum_{d } \\sum_{d ' } \\sum_{d '' } \\sum_{d ' '' } \\cov(i_{d , d'}x_{d}x'_{d ' } e_de_{d ' } , i_{d'',d'''}x_{d''}x'_{d ' '' } e_{d''}e_{d ' '' } ) .",
    "\\nonumber\\end{aligned}\\ ] ] to show @xmath115 \\rightarrow 0 $ ] , it is sufficient to establish that @xmath116 is at most @xmath117 . consider quadruples of dyads indexed by @xmath118 such that @xmath119 .",
    "suppose there are @xmath120 quadruples and define @xmath121 .",
    "the covariance terms take positive values when @xmath122 , which occurs at rate @xmath123 ( that is , when we have pairs of terms that are actually summed into @xmath42 ) , and we have dependence across @xmath124 and @xmath125 .",
    "then , the six distinct ways that such dependence can occur and the associated proportion of quadruples for which these occur for a sample of size @xmath43 are as follows : @xmath126 therefore the proportion of quadruples yielding a positive covariance is the proportion of cases contributing non - zero values to the sum @xmath116 .",
    "this proportion is bounded by the proportion of cases where the indicator functions are both one and the order of the proportion of dependent quadruples from across the six cases characterized above , that is @xmath127 .",
    "then @xmath115 $ ] is at most @xmath128 .",
    "consider the interior ( `` meat '' ) of @xmath88 : @xmath129 taking the second component , @xmath130 define @xmath131 then working with @xmath132 , @xmath133 , and @xmath134 as defined in the proposition , @xmath135 then @xmath136 \\nonumber \\\\   & = \\sum_{i=1}^n \\hat \\sigma_{c , i } - \\hat \\sigma_d - ( n-2 ) \\hat \\sigma_0 , \\nonumber \\end{aligned}\\ ] ] and by linear distributivity for @xmath137 @xmath138 with @xmath63 , @xmath64 , and @xmath65 as defined in the proposition .",
    "weighting is a common way to adjust for unequal probability sampling of dyadic interactions , among other applications .",
    "the extension to the weighted case is straightforward .",
    "assume weighted directed dyad observations with weights finite and fixed ; denote the weight for dyad @xmath36 as @xmath139 .",
    "define the sample data as @xmath140 and @xmath15 and the matrix of weights as @xmath141 .",
    "then the weighted least squares estimator is @xmath142    for the weighted dyads case , assume the same conditions as in proposition [ prop1 ] and consider the following variance estimator    @xmath143    then as @xmath31 , @xmath144 - v_w \\overset{p}{\\rightarrow } 0,\\ ] ] and @xmath145 where @xmath146^{-1 } \\e\\left ( \\e\\left[x_dx'_d w_{d}^{2}\\var[\\epsilon_d|{\\mathbf{x}}]\\right ] + \\sum_{d ' \\in \\mathcal{s}(d)}\\e\\left[x_dx'_{d'}w_{d}w_{d'}\\cov[\\epsilon_d , \\epsilon_{d'}|{\\mathbf{x}}]\\right]\\right ) \\e[w_{d}x_dx_d']^{-1}.\\ ] ]",
    "an implementation for generalized linear models follows the usual @xmath147-estimation results ( @xcite ; @xcite , ch .",
    "12 ) . given an estimating equation , @xmath148 , on data @xmath149 , and with parameters @xmath150 and parameter estimates",
    "@xmath151 , the sandwich approximation for the variance is @xmath152 , where @xmath153 \\text{\\hspace{1em } and \\hspace{1em}}{\\mathbf{b}}= \\e \\psi(d;\\hat \\theta)\\psi(d_i;\\hat \\theta)'.\\ ] ] for logistic regression the estimating equation is , @xmath154 where @xmath155 , the predicted probability for dyad @xmath36 .",
    "the plug - in variance estimator for logistic regression coefficients is given by @xmath156 where @xmath157 the extensions to repeated and weighted observations follow analogously .",
    "xx    angrist , joshua  d.  guido  w. imbens .",
    "`` comment on ` covariance adjustment in randomized experiments and observational studies ' by paul r. rosenbaum . ''",
    "_ statistical science _ 17(3):304307 .",
    "angrist , joshua  d.  jorn - steffen pischke .",
    "princeton , nj : princeton university press .",
    "arellano , manuel .",
    "1987 . `` computing robust standard errors for within - group estimators . '' _ oxford bulletin of economics and statistics _ 49(4):431434 .",
    "beck , nathanial , kristian  skrede gleditsch  kyle beardsley . 2006 .",
    "`` space is more than geography : using spatial ecometrics in the study of political economy . '' _ international studies quarterly _ 50:2744 .",
    "buja , andreas , richard berk , lawrence brown , edward george , emil pitkin , mikhail traskin , linda zhao  kai zhang .",
    "`` models as approximations : a conspiracy of random predictors and model violations against classical inference in regression . ''",
    "manuscript , the wharton school , university of pennsylvania , philadelphia .",
    "cameron , a. colin , jonah  b. gelbach  douglas  l. miller .",
    "`` robust inference with multi - way clustering . '' _ journal of business and economic statistics _ 29(2):238249 .",
    "chamberlain , gary .",
    "`` multivariate regression models for panel data . ''",
    "_ journal of econometrics _ 18(1):546 .",
    "conley , timothy  g. 1999 .",
    "`` gmm estimation with cross sectional dependence . '' _ journal of econometrics _ 92:145 .",
    "davidson , russell  james  g. mackinnon .",
    "oxford : oxford university press .",
    "erikson , r.  s. , p.  m. pinto  k.  t. rader .",
    "2014 . `` dyadic analysis in international relations : a cautionary tale . ''",
    "_ political analysis _ 22(4):457463 .",
    "fafchamps , marcel  flore gubert .",
    "`` the formation of risk sharing networks . '' _ journal of development economics _ 83:326350 .",
    "fisman , raymond , sheena  s iyengar , emik kamenica  itamar simonson .",
    "`` gender differences in mate selection : evidence from a speed dating experiment . '' _ quarterly journal of economics _ 121:673697 .",
    "gelman , andrew  jennifer hill .",
    "cambridge : cambridge university press .",
    "goldberger , arthur  s. 1991 . .",
    "cambridge , ma : harvard university press .",
    "green , donald  p. , soo  yeon kim  david  h. yoon .",
    "2001 . `` dirty pool . '' _ international organization _ 55(2):441468 .",
    "greene , william  h. 2008 . .",
    "upper saddle river , nj : pearson .",
    "hansen , christian  b. 2007 .",
    "`` asymptotic properties of a robust variance matrix estimator for panel data when _",
    "t _ is large . ''",
    "_ journal of econometrics _ 141:597620 .",
    "hoff , peter  d. 2005 . ``",
    "bilinear mixed - effects models for dyadic data . ''",
    "_ journal of the american statistical association _ 100(469):286295 .",
    "hubbard , alan  e. , jennifer ahern , nancy  l. fliescher , mark van  der  laan , sheri  a. lippman , nicholas jewell , tim bruckner  william  a. satariano .",
    "`` to gee or not to gee : comparing population average and mixed models for estimating the associations between neighborhood risk factors and health . '' _ epidemiology _ 21(4):467474 .",
    "huber , peter  j. 1967 .",
    "the behavior of maximum likelihood estimates under nonstandard conditions . in _ proceedings of the fifth berkeley symposium on mathematical statistics and probability_. vol .  1 pp .  221233",
    ".    kenny , david  a. , deborah  a. kashy  william  l. cook .",
    "new york , ny : guilford press .",
    "king , gary  margaret  e. roberts .",
    "`` how robust standard errors expose methodological problems they do not fix , and what to do about it . ''",
    "_ political analysis _",
    "( online early view):112 .",
    "lehmann , erich  l. 1999 . .",
    "new york : springer - verlag .",
    "liang , kung - yee  scott  l. zeger .",
    "`` longitudinal data analysis using generalized linear models . '' _ biometrika _ 73(1):1322 .",
    "lin , winston .",
    "`` agnostic notes on regression adjustments to experimental data : reexamining freedman s critique . '' _ annals of applied statistics _ 7(1):295318 .    , james  g.  halbert white .",
    "`` some heteroskedasticity - consistent covariance matrix estimators with improved finite sample properties . ''",
    "_ journal of econometrics _ 29(3):305325 .",
    "moulton , brent  r. 1986 .",
    "`` random group effects and the precision of regression estimates . '' _ journal of econometrics _ 32:385397 .",
    "neumayer , eric  thomas pluemper . 2010 .",
    "`` spatial effects in dyadic data . '' _ international organization _ 64(1):145165 .",
    "russett , bruce  m.  john  r. oneal .",
    "new york , ny : norton .",
    "stefanski , leonard  a.  dennis  d. boos .",
    "2002 . `` the calculus of m - estimation . ''",
    "_ the american statistician _ 56(1):2938 .",
    "stock , james  h.  mark  w. watson .",
    "`` heteroskedasticity - robust standard errors for fixed effects panel data regression . '' _ econometrica _ 76(1):155174 .",
    "white , halbert .",
    "1980_a_. `` a heteroskedasticity - consistent covariance matrix estimator and a direct test for heteroskedasticity . '' _ econometrica _ 48(4):817838 .",
    "white , halbert .",
    "1980_b_. `` using least squares to approximate unknown regression functions . '' _ international economic review _",
    "21(1):149170 .",
    "white , halbert .",
    "consequences and detection of misspecified nonlinear regression models . ''",
    "_ journal of the american statistical association _ 76(374):419433 .",
    "white , halbert .",
    "`` maximum likelihood estimation of misspecified models . '' _ econometrica _ 50(1 - 25 ) .",
    "white , halbert . 1984 . .",
    "new york , ny : academic press .",
    "wooldridge , jeffrey  m. 2010 . .",
    "cambridge , ma : mit press .",
    "zorn , christopher .",
    "`` generalized estimating equation models for correlated data : a review with applications . ''",
    "_ american journal of political science _ 45:470490",
    ".    cluster robust variance estimation for dyadic data + supporting information not for publication",
    "figure [ fig : norm ] and [ fig : miss ] show additional simulation results where we make comparisons to mixed effects models  specifically , to a two - way random effects model that incorporates random effects for each of @xmath43 units in the data .",
    "all random effects models were fit using the lmer package in r. in both sets of graphs , black box plots show the distribution of standard error estimates for ols coefficients using the proposed dyadic cluster robust estimator .",
    "gray box plots show standard error estimates for ols coefficients from a heteroskedasticity robust estimator .",
    "blue box plots show the distribution of standard error estimators from a two - way random effects model with a random effect for each of @xmath43 units .",
    "black diamonds show the true standard error of the ols coefficients and the blue diamonds show the true standard error of the random effects coefficients .",
    "figure [ fig : norm ] uses the same data generating process as was described in the main text , and presents the same results for ols with either the dyadic cluster robust standard error estimator or the heteroskedastic robust estimator . in addition , we have added random effects estimates . given that the data generating process conforms exactly to the assumptions of a two - way random effects model , we obtain the straightforward result that the random effects estimates are both more efficient ( the blue diamonds tend to be lower than the black ones ) and the random effects standard errors are consistent .            figure [ fig : miss ] illustrates the robustness of the dyadic cluster robust estimator relative to a random effects estimator .",
    "in this case , we induce mild misspecification by assuming that the true data generating process is @xmath158 where all parameters are set as in the main text but we also have @xmath159 .",
    "we nonetheless fit a model that includes only @xmath160 , thereby mildly misspecifying the model such that we do not account for the nonlinearity induced by the @xmath161 term .",
    "figure [ fig : miss - scatter ] shows the scatter plot of @xmath70 against @xmath160 , the linear approximation ( in red ) for one of the simulation replicates ( @xmath162 ) , and the true conditional mean ( in blue ) .",
    "such linear approximations are the norm in social science research @xcite . in this case",
    ", we see that , despite the mild misspecification , the dyadic cluster robust standard error correctly characterizes the standard error of the linear approximation coefficients ( the black box plots still zero in on the black diamonds ) .",
    "the random effects model is still more efficient ( the blue diamonds still tend to be below the black diamonds ) .",
    "but the random effects standard error estimator ( as computed in the lmer package for r ) is inconsistent and anti - conservative : the blue box plots converge to a limit that is substantially below the true standard error ( the blue diamonds ) .",
    "our second application is based on @xcite s seminal study of the determinants of mate selection in a `` speed - dating '' experiment .",
    "we replicate their primary analysis for female participants ( as reported in column 1 of their table iii ) using data from 21 dating sessions conducted by the experimenters . ]",
    "these data include 278 women paired into 3,457 female - male dyads .",
    "@xcite regress a binary indicator for whether the female subject desired contact information for a male partner on the subject s ratings of the partner s ambition , attractiveness , and intelligence based on a 10-point likert scale .",
    "the regression controls for female - subject fixed effects and weights observations contributed by each female subject by the inverse of the number of partners with which she was paired .",
    "table [ tab : fisman ] shows the results of our re - analysis .",
    ", our estimates differ slightly from those that appear in the original paper . ] again , we see that accounting for the dyadic clustering ( column 4 ) yields standard error estimates that are larger than what one would get if one ignored all clustering ( column 2 ) , although in this case there are no pronounced differences with what one gets when one only accounts for within - subject clustering ( column 3 ) .",
    "this is to be expected given that the amount of dyadic dependence in this dataset is limited : dyads were formed only _ within _ sessions that included between 5 and 22 male partners for each female subject . in addition , the female subjects are never paired with each other .",
    "the only clustering that occurs is therefore within female subjects and then for male partners that appear across multiple female subjects .",
    "the former is addressed in part by the female subject - specific fixed effects .",
    "the latter is limited by the within - session pairings .     & & het . & naive cluster & dyadic cluster + predictor of mate selection & coef . & robust s.e . & robust s.e . & robust s.e .",
    "+ ambition & 0.0192 & 0.0052 & 0.0057 & 0.0061 + attractiveness & 0.1157 & 0.0041 & 0.0051 & 0.0054 + intelligence & 0.0465 & 0.0062 & 0.0073 & 0.0074 +   +"
  ],
  "abstract_text": [
    "<S> dyadic data are common in the social sciences , although inference for such settings involves accounting for a complex clustering structure . </S>",
    "<S> many analyses in the social sciences fail to account for the fact that multiple dyads share a member , and that errors are thus likely correlated across these dyads . </S>",
    "<S> we propose a nonparametric , sandwich - type robust variance estimator for linear regression to account for such clustering in dyadic data . </S>",
    "<S> we enumerate conditions for estimator consistency . </S>",
    "<S> we also extend our results to repeated and weighted observations , including directed dyads and longitudinal data , and provide an implementation for generalized linear models such as logistic regression . </S>",
    "<S> we examine empirical performance with simulations and an application to interstate disputes .    </S>",
    "<S> cluster - robust variance estimation for dyadic data    keywords : cluster robust variance estimation , dyadic data , agnostic regression +   + word count : 5,022 ( including main text , appendix for print , captions , and references ) . </S>"
  ]
}