{
  "article_text": [
    "the goal of this work is to characterize gaussian estimates for markov chains and parabolic harnack inequality for a corresponding discrete time version of heat equation by two geometric properties on the state space    1 .",
    "large scale volume doubling property 2 .   poincar inequality .    a precise statement of this characterization",
    "is given in theorem [ t - main0 ] .",
    "the gaussian estimates mentioned are upper and lower bounds for the iterated transition probability kernel .",
    "the parabolic harnack inequality is a regularity estimate for non - negative solutions of the discrete time heat equation given by @xmath0(x)$ ] , where @xmath1 is the markov operator corresponding to the given markov chain .",
    "the hardest and most useful implication in the characterization is that the conjunction of the volume doubling property and poincar inequality implies the two sided gaussian estimates and parabolic harnack inequality .",
    "the volume doubling property and poincar inequality are concrete properties the validity of which can be verified given the geometric data on the space . also , an important consequence of this characterization is the stability of gaussian estimates and parabolic harnack inequality under quasi - isometric transformation of the underlying space .",
    "an analogous characterization is well - known for diffusions on riemannian manifolds @xcite(or more generally local dirichlet spaces @xcite ) and for discrete time markov chains on graphs @xcite .",
    "we extend the characterization of gaussian estimates for markov chain to a large family of state spaces that includes both graphs and riemannian manifolds .",
    "various applications of gaussian estimates and harnack inequalities are discussed .",
    "another motivation comes from the work of hebisch and saloff - coste @xcite on random walks on groups . by the main results of @xcite , we know that many natural translation - invariant markov chains on groups ( discrete and continuous groups ) of polynomial volume growth satisfy two - sided gaussian estimates",
    ". however the arguments in @xcite for proving gaussian lower bounds are specific to the case of translation - invariant markov chains as the authors of @xcite note `` we want to emphasize that a number of key points of the argument presented below are specific to the case of translation invariant markov chains '' . to this end",
    "they conjecture `` we have no doubt that , if @xmath2 has polynomial volume growth a corresponding gaussian lower bound holds for ( non transition - invariant ) markov chains as well .",
    "however , we have not been able to prove this result .",
    "we hope to come back to this question in the future . ''",
    "* remark 2 ) .",
    "our work validates their conjecture .",
    "a remarkable feature of our work is that the arguments we develop are robust under small perturbations of the markov kernel and the geometry of the underlying state space . in particular , we show that parabolic harnack inequality and gaussian estimates for heat kernel for symmetric markov chains is stable under quasi - isometric change of the state space and small changes in the markov kernel .",
    "we do not rely on symmetries of the space ( like group structure or transitivity ) or on algebraic properties of the kernel ( like translation invariance ) . as a consequence ,",
    "the main results are new even when the state space is @xmath3 .",
    "heat kernel estimates and harnack inequalities have been subjects of extensive research for more than fifty years . to place our results in a historical context",
    ", we will describe precisely the characterization of gaussian estimates of heat kernel and parabolic harnack inequality in the context of diffusions over manifolds developed in @xcite .",
    "we will also mention several related works , applications and other historical remarks .      for the purpose of the introduction",
    ", we describe our results in the restricted setting of weighted riemannian manifolds .",
    "let @xmath4 be a complete riemannian manifold equipped with the riemannian measure @xmath5 .",
    "a weighted riemannian manifold @xmath6 is a riemannian manifold @xmath4 equipped with a measure @xmath7 , where @xmath8 is the _ weight _ , and the associated _ weighted laplacian _ is given by @xmath9 has non - negative spectrum .",
    "note that @xmath10 depends on the riemannian metric @xmath11 and the weight @xmath12 . ] .",
    "we might sometimes consider a riemannian manifold @xmath4 as a weighted riemannian manifold equipped with riemannian measure and laplace - beltrami operator .",
    "we denote the balls centered at @xmath13 and radius @xmath14 by @xmath15 and the volume of the balls by @xmath16 .",
    "we denote the open balls by @xmath17    the _ heat kernel _ of the weighted riemannian manifold @xmath6 is the fundamental solution of a parabolic partial differential equation , the heat diffusion equation @xmath18 that is heat kernel is a function @xmath19 defined on @xmath20 such that for each @xmath21 , @xmath22 is a solution of and for any @xmath23 , @xmath24 tends to @xmath25 as @xmath26 tends to @xmath27 . in other words ,",
    "the heat kernel allows us to solve the cauchy initial value problem for .",
    "equivalently , we may view @xmath28 as the distribution at time @xmath26 of a stochastic process @xmath29 started at @xmath13 ( the diffusion driven by @xmath10 on m ) .",
    "these two viewpoints are related by the formula @xmath30 where @xmath31 is the solution of cauchy initial value problem for with initial value condition @xmath32 .",
    "the most classical example of heat kernel is the gauss - weierstrass kernel on @xmath3 equipped with the lebesgue measure , the laplacian @xmath33 and the heat kernel is given by @xmath34 we will present a well - known geometric characterization of those weighted riemannian manifolds on which the heat kernel satisfies _ two - sided gaussian bounds _ , that is having the property that there exists positive reals @xmath35 such that @xmath36 for all @xmath37 and for all @xmath38 .",
    "next , we describe harnack inequalities for @xmath6 equipped with the weighted laplacian @xmath10 .",
    "we say that @xmath6 satisfies _ elliptic harnack inequality _",
    "if there exists @xmath39 such that any non - negative harmonic function @xmath31 in a ball @xmath40 ( that is @xmath31 satisfies @xmath41 in @xmath42 ) satisfies the inequality @xmath43 the constant @xmath44 is independent @xmath13 , @xmath14 and @xmath31",
    ". an important consequence of the elliptic harnack inequality in @xmath3 for the laplacian @xmath45 is that global positive harmonic functions must be constant ( liouville property ) .",
    "j. moser @xcite proved elliptic harnack inequality for divergence form operators of the type @xmath46 where @xmath47 are bounded measurable real functions on @xmath3 satisfying @xmath48 and the uniform ellipticity condition : @xmath49 for two constants @xmath50 .",
    "this elliptic harnack inequality implies the crucial hlder continuity for solutions of the associated elliptic equation @xmath51 , a result proved earlier by e. de giorgi @xcite and j. nash @xcite ( see also @xcite ) .    an important motivation behind the hlder continuity of solutions obtained by de giorgi , nash and moser @xcite was to solve one of the famous hilbert problems .",
    "hilbert s nineteenth problem asks whether the minimizers of dirichlet integrals @xmath52 are always smooth , if @xmath53 is smooth and strictly convex , where @xmath54 is bounded .",
    "e. de giorgi and j. nash independently answered hilbert s question in the affirmative .",
    "we refer the interested reader to ( * ? ? ?",
    "* theorem 14.4.1 ) for a detailed exposition of the smoothness of the minimizers of dirichlet integrals using hlder regularity estimates of de giorgi and nash .",
    "it is a long standing open problem to characterize ( in geometric terms ) those weighted manifolds that satisfy elliptic harnack inequality .",
    "a related open question is to determine whether or not elliptic harnack inequality is preserved under quasi - isometries .",
    "however several examples of riemannian manifolds that satisfy elliptic harnack inequality are known .",
    "for instance , cheng and yau @xcite proved that there exists a constant depending only @xmath55 such that for any positive solution @xmath31 of @xmath56 in @xmath42 on a riemannian manifold @xmath4 with ricci curvature bounded from below by @xmath57 for some @xmath58 satisfies @xmath59 when @xmath60 , integrating the gradient estimate along minimal paths we immediately obtain the elliptic harnack inequality for riemannian manifolds with non - negative ricci curvature .",
    "we now describe the parabolic version of . for any @xmath61 , @xmath62 , @xmath63 , let @xmath64 be the cylinder @xmath65 let @xmath66 and @xmath67 be respectively the upper and lower sub - cylinders @xmath68 we say that @xmath6 satisfies _ parabolic harnack inequality _",
    "if there exists a constant @xmath69 such that for all @xmath61 , @xmath62 , @xmath70 and for all positive solutions of @xmath71 in @xmath64 , we have @xmath72 the constants @xmath73 appearing in the definition of @xmath74 are essentially arbitrary choices . the main difference between elliptic and parabolic harnack inequalities is that the cylinders @xmath66 and @xmath67 are disjoint in whereas in the elliptic case the infimum and supremum are taken over the same ball .",
    "j. moser attributes the first parabolic harnack inequality to hadamard and pini for operators with constant coefficients on @xmath3 . in @xcite",
    ", j. moser proved the parabolic harnack inequality for uniformly elliptic operators in divergence form as given by .",
    "as in the elliptic case , the parabolic harnack inequality implies hlder continuity of the corresponding solutions .",
    "this hlder continuity was first obtained by j. nash @xcite in the parabolic setting and moser s parabolic harnack inequality gives an alternative proof of hlder continuity .",
    "for a proof of harnack inequality using the ideas of nash , we refer the reader to the work of fabes and stroock @xcite    the gradient estimates of cheng and yau was generalized to the parabolic case by p. li and s.t .",
    "yau in @xcite .",
    "the parabolic gradient estimates in @xcite implies that complete riemannian manifolds with non - negative ricci curvature satisfy parabolic harnack inequality .",
    "in contrast to elliptic harnack inequality , there is a satisfactory description of weighted riemannian manifolds that satisfy the parabolic harnack inequality as described below .",
    "[ t - grisal ] ( @xcite ) let @xmath6 be a weighted , non - compact , complete riemannian manifold equipped with the weighted laplacian @xmath10 and let @xmath75 denote the corresponding heat kernel .",
    "the following three properties are equivalent :    a.   the parabolic harnack inequality : there exists a constant @xmath76 such that , for any ball @xmath77 , @xmath61 , @xmath63 and for any smooth positive solution @xmath31 of @xmath78 in the cylinder @xmath79 , we have @xmath80 with @xmath68 b.   two sided gaussian estimates of the heat kernel : there exists positive reals @xmath35 such that @xmath36 for all @xmath37 and for all @xmath38 .",
    "c.   the conjunction of * the volume doubling property : there exists @xmath81 such that for all @xmath61 , for all @xmath70 we have @xmath82 * the poincar inequality : there exists @xmath83,@xmath84 such that for any ball @xmath77 , @xmath61 , @xmath63 and for all @xmath85 , we have @xmath86 where @xmath87 and @xmath88 .",
    "we present examples of complete , non - compact , weighted riemannian manifolds satisfying parabolic harnack inequality and gaussian bounds on the heat kernel .",
    "we refer the reader to ( * ? ? ?",
    "* section 3.3 ) for a more extensive list of examples .    *",
    "complete riemannian manifolds with non - negative ricci curvature .",
    "the parabolic harnack inequality was first obtained in this case by li and yau using a gradient estimate @xcite .",
    "the volume doubling property follows from bishop - gromov inequality ( * ? ? ?",
    "* theorem iii.4.5 . ) and the poincar inequality follows from the work of p. buser @xcite ( see ( * ? ? ?",
    "* theorem 5.6.5 ) for a different proof ) .",
    "* convex domains and complement of convex domains in euclidean space .",
    "we refer the reader to the monograph @xcite for this and other examples in this spirit .",
    "* connected lie groups with polynomial volume growth . by a theorem of y. guivarch , we know that lie groups with polynomial volume growth satisfies volume doubling property . moreover ,",
    "lie groups with polynomial volume growth satisfy poincar inequality ( * ? ? ?",
    "* theorem 5.6.1 ) .",
    "examples include nilpotent lie groups like euclidean spaces and heisenberg group .",
    "see also ( * ? ? ?",
    "* theorem viii.2.9 ) .",
    "moreover volume doubling property and poincar inequality holds for subelliptic ` sum of squares ' operators satisfying the hrmander condition ( * ? ? ?",
    "* chapter v and viii ) under the carnot - carathodory metric .",
    "see also ( * ? ? ?",
    "* section 5.6.1 ) .",
    "* the euclidean space @xmath3 , with @xmath89 and weight @xmath90 , @xmath91 satisfies parabolic harnack inequality if and only if @xmath92 .",
    "it satisfies the elliptic harnack inequality for all @xmath93 .",
    "these examples are from @xcite . *",
    "any complete , weighted riemannian manifold with bounded geometry that is quasi - isometric to a complete , weighted riemannian manifold satisfying parabolic harnack inequality .",
    "we say a weighted riemannian manifold @xmath6 with weight @xmath12 has _ bounded geometry _ if ( a ) there exists @xmath58 such that @xmath94 ( b ) there exists @xmath95 such that @xmath96 for all @xmath38 with @xmath97 ( c ) there exists @xmath98 such that @xmath99 for all @xmath61 .",
    "this illustrates the stability of parabolic harnack inequality and two - sided gaussian estimates under quasi - isometry @xcite .",
    "the primary goal of our work is to extend theorem [ t - grisal ] in the context of discrete time markov chains on a large class of spaces that include both weighted riemannian manifolds and graphs .",
    "as mentioned before the hardest and most useful part of the theorem [ t - grisal ] is ( c ) implies ( a ) and ( b ) .",
    "the implication ( c ) implies ( a ) was proved independently by grigoryan @xcite and saloff - coste @xcite . both @xcite and @xcite observed that volume doubling is necessary to obtain ( a ) . in @xcite",
    ", saloff - coste proved that poincar inequality is also a necessary condition to prove ( a ) using an argument due to kusuoka and stroock @xcite .",
    "the proof of ( c ) implies ( a ) in @xcite is an adaptation of moser s iteration method .",
    "moser s iteration method relies on poincar inequality and a sobolev inequality .",
    "the main contribution of @xcite is to obtain a sobolev inequality using volume doubling and poincar inequality ( see also ( * ? ? ?",
    "* chapter 5 ) , @xcite ) .",
    "a. grigoryan @xcite carried out a different iteration argument that relied on an equivalent faber - krahn inequality instead of a sobolev inequality to prove ( c ) implies ( a ) . using the methods of @xcite , k.t .",
    "sturm @xcite generalized the above equivalence to diffusions on strongly local dirichlet spaces .",
    "more recently in @xcite , hebsich and saloff - coste developed an alternate approach to prove gaussian bounds and parabolic harnack inequality using ( a ) .",
    "this approach relies on an elliptic hlder regularity estimate and gaussian upper bounds to prove parabolic harnack inequality .",
    "we will use the approach outlined in @xcite in our work .",
    "aronson @xcite was the first to use parabolic harnack inequality to obtain gaussian bounds on the heat kernel in the context of divergence form uniformly elliptic operators in @xmath3 as given in .",
    "although in aronson s work , the parabolic harnack inequality was used only to obtain gaussian lower bounds , both gaussian upper and lower bounds can be easily obtained using parabolic harnack inequality .",
    "conversely nash s approach aimed at deriving harnack inequality from two - sided gaussian bounds on the heat kernel was further developed by krylov and safonov @xcite and by fabes and stroock @xcite .",
    "t. delmotte extended theorem [ t - grisal ] for discrete time markov chains on graphs , which we now describe . to precisely describe the result",
    ", we will introduce some notions concerning symmetric markov chains .",
    "let @xmath100 be a _",
    "metric measure space _ by which we mean a metric space @xmath101 equipped with a borel measure @xmath102 . recall that we denote closed ball by @xmath40 and their measure by @xmath103 .",
    "we require @xmath104 for all @xmath61 and for all @xmath105 .",
    "let @xmath106 be a markov chain with state space @xmath107 and let @xmath1 be the corresponding markov operator .",
    "further , we assume that @xmath1 has a kernel @xmath108 with respect to the measure @xmath102 , that is for each @xmath61 , we have @xmath109 satisfying @xmath110 for all @xmath111 . here",
    "@xmath112 denotes that the markov chain starts at @xmath113 .",
    "the equation represents the basic relation between the markov chain @xmath106 , corresponding markov operator @xmath1 and its kernel @xmath114 with respect to @xmath102 .",
    "we will assume that our markov chain is stochastically complete that is @xmath115 or equivalently @xmath116 for all @xmath61 .",
    "we further assume that the kernel @xmath114 satisfies @xmath117 for all @xmath61 and that @xmath114 is symmetric @xmath118 for @xmath119-almost every @xmath120 . under the symmetry assumption and the assumption @xmath117 for all @xmath61 , we define the iterated markov kernel as for the markov chain as @xmath121 for all @xmath38 and for all @xmath122 .",
    "it is easy to check that @xmath123 is the distribution of @xmath124 given that the random walk starts at @xmath113 ( see lemma [ l - kernel ] ) .",
    "the function @xmath125 is called the ` heat kernel ' for the symmetric markov chain @xmath106 driven by @xmath1 on @xmath100 .",
    "next , we introduce the laplacian and heat equation for discrete time markov chains .",
    "the laplace operator @xmath126 corresponding to the random walk driven by @xmath1 is @xmath127 the corresponding discrete time heat equation is @xmath128 for all @xmath129 , where @xmath130 denotes the difference operator and @xmath131 . note that can be rewritten as @xmath132 .",
    "therefore the ` solution ' to the heat equation can be written as @xmath133 for all @xmath61 and for all @xmath122 where @xmath32 is the initial value .",
    "note that the above equation is analogous to its continuous time counterpart .    to describe the work of t. delmotte , we consider a given graph as a metric measure space @xmath100 where @xmath107 is the vertex set of the graph , @xmath134 is the graph distance metric and @xmath102 is a measure on the set of vertices such that each vertex has positive measure . in this context @xmath135 for all @xmath38",
    "is sometimes called the _",
    "conductance_. we denote integer intervals by @xmath136 for any @xmath137 .",
    "the following theorem of t. delmotte is the analogue of theorem [ t - grisal ] for markov chains on graphs .",
    "[ t - del ] ( @xcite ) let @xmath100 be an infinite graph equipped with a measure @xmath102 on the set of vertices @xmath107 . consider a markov chain on @xmath107 with a symmetric kernel @xmath138 with respect to @xmath102 .",
    "further we assume that there exists @xmath139 such that @xmath140 for all @xmath38 .",
    "then the following properties are equivalent :    a.   the parabolic harnack inequality : there exists @xmath141,@xmath142 such that for all balls @xmath40 , @xmath61 , @xmath143 and for all non - negative functions @xmath144 that satisfies @xmath145 in @xmath146 , we have @xmath147 where @xmath148 b.   two sided gaussian bounds on the heat kernel : there exists @xmath149 such that for all @xmath38 and for all @xmath150 satisfying @xmath89 , we have @xmath151 further there exists @xmath152 such that for all @xmath38 satisfying @xmath153 and for all @xmath150 satisfying @xmath89 @xmath154 c.   the conjunction of * the volume doubling property : there exists @xmath81 such that for all @xmath61 , for all @xmath70 we have @xmath155 * the poincar inequality : there exists @xmath83,@xmath84 such that for any ball @xmath77 that satisfies @xmath61 , @xmath156 and for all @xmath157 , we have @xmath158 where @xmath87 , @xmath88 .    delmotte s strategy to prove theorem [ t - del ] is to use moser s iteration method as developed in @xcite to prove a continuous time parabolic harnack inequality . the next step is to prove estimates on the corresponding continuous time kernel obtained using parabolic harnack inequality .",
    "then a comparison between discrete and continuous time kernels provides gaussian bounds on @xmath138 which in turn yields parabolic harnack inequality for the discrete time heat equation .",
    "the comparison argument is tricky because the continuous time heat kernel has non - gaussian behavior as discovered by pang @xcite and e.b .",
    "davies @xcite .",
    "the discrete nature of space and time causes numerous other difficulties during moser iteration that were overcome successfully by delmotte .",
    "next , we state a version of our main result in a restricted setting .",
    "recall that a weighted riemannian manifold @xmath6 is a riemannian manifold @xmath4 equipped with a measure @xmath102 such that @xmath159 , where @xmath160 is the riemannian measure and @xmath161 is the _ weight function_.    [ t - main0 ] let @xmath6 be a complete non - compact , weighted riemannian manifold such that there exists @xmath58 such that @xmath94 .",
    "furthermore there exists @xmath162 such that the weight function @xmath12 satisfies @xmath163 for all @xmath38 with @xmath97 .",
    "consider a markov chain on @xmath107 with a symmetric kernel @xmath138 with respect to @xmath102 .",
    "further we assume that there exists @xmath164 such that @xmath165 for all @xmath61 and for @xmath102-almost every @xmath21 .",
    "then the following properties are equivalent :    a.   the parabolic harnack inequality : there exists @xmath141,@xmath142 such that for all balls @xmath40 , @xmath61 , @xmath143 and for all non - negative functions @xmath144 that satisfies @xmath145 in @xmath146 , we have @xmath147 where @xmath148 b.   two sided gaussian bounds on the heat kernel : there exists @xmath149 such that for all @xmath38 and for all @xmath150 satisfying @xmath89 , we have @xmath166 further there exists @xmath152 such that for all @xmath38 satisfying @xmath153 and for all @xmath150 satisfying @xmath89 @xmath167 c.   the conjunction of * the volume doubling property : there exists @xmath81 such that for all @xmath61 , for all @xmath70 we have @xmath155 * the poincar inequality : there exists @xmath83,@xmath84 such that for any ball @xmath77 , @xmath61 , @xmath156 and for all @xmath157 , we have @xmath168 where @xmath87 , @xmath88 .    the poincar inequalities presented in theorem [ t - grisal ] and theorem [ t - main0 ] are related .",
    "we will show that the poincar inequality implies ( see proposition [ p - rmtfae ] ) .",
    "a partial converse of the previous statement hold as well .",
    "consider a complete , non - compact riemannian manifold @xmath4 with non - negative ricci curvature whose unit balls have a uniform positive volume lower bound .",
    "define a markov kernel @xmath169 for all @xmath38 .",
    "although @xmath170 is a markov kernel with respect to the riemannian measure @xmath160 , @xmath171 in general .",
    "however @xmath172 is a symmetric markov kernel with respect to @xmath173 where @xmath174 denotes the volume with respect to @xmath160 . by the remark preceding this example",
    ", @xmath6 satisfy the poincar inequalities and .",
    "moreover @xmath6 satisfies volume doubling property .",
    "hence the iterated kernel @xmath175 satisfies two - sided gaussian bounds and the corresponding laplacian satisfies the parabolic harnack inequality .",
    "similarly many other examples known in the diffusion case can be extended to the discrete - markov chain case due to proposition [ p - rmtfae ] .",
    "the role of theorem [ t - main0 ] is only to illustrate our main result without introducing additional definitions .",
    "we provide an unified approach to study random walks on both discrete and continuous spaces .",
    "we prove theorem [ t - main0 ] as a corollary of a general result that also gives an alternate proof of theorem [ t - del ] .",
    "given the previous works on characterization of parabolic harnack inequality and gaussian bounds @xcite our results should not be surprising .",
    "however we encounter new difficulties that had to be resolved here and which were not present in previous works . recall that moser s iteration method for harnack inequalities",
    "relies on repeated application of a sobolev inequality@xcite .",
    "grigoryan s iteration method in @xcite uses an equivalent faber - krahn inequality that is equivalent to the sobolev inequality @xcite .",
    "the sobolev inequalities in the previous settings are of the form @xmath176 for all ` nice ' functions @xmath177 supported in @xmath40 .",
    "however for discrete time markov chains , the dirichlet form satisfies the inequality @xmath178 .",
    "this along with implies that @xmath179 for all balls @xmath40 which can happen only if the space is discrete .",
    "hence for discrete time markov chains on riemannian manifolds the sobolev inequality can not possibly be true .",
    "we prove and rely on a weaker form of the sobolev inequality which seems to be too weak to run moser s iteration directly to prove parabolic harnack inequality ( see theorem [ t - sob ] ) .",
    "instead we use moser s iteration to prove a version of the mean value inequality which in turn gives gaussian upper bounds .",
    "we adapt a method of @xcite which uses elliptic harnack inequality and gaussian upper bounds to prove gaussian lower bounds ( see chapter [ ch - glb ] ) .",
    "another difficulty that is new to our setting is explained in the beginning of section [ s - dimp ] .    in the context of diffusions on",
    "complete riemannian manifolds the sobolev inequality is equivalent to the conjunction of volume doubling property and gaussian upper bounds on the heat kernel ( * ? ? ?",
    "* theorem 5.5.6 ) . in the previous statement",
    ", we may replace sobolev inequalities with a similar but equivalent set of functional inequalities called faber - krahn inequalities both in the context of diffusions on riemannian manifolds @xcite and for random walks on graphs ( * ? ? ?",
    "* theorem 1.1 ) .",
    "we extend the above equivalences for random walks on a large class of metric measure spaces ( theorem [ t - main2 ] ) .",
    "this monograph is organized as follows . in chapter",
    "[ ch - mg ] , we present the setting of quasi - geodesic spaces satisfying certain doubling hypotheses , study its basic properties and develop techniques that would let us compare discrete and continuous spaces .    in chapter [ ch - pi ] , we introduce poincar inequalities and discuss various examples and non - examples of spaces satisfying poincar inequality .",
    "we study how these new poincar inequalities on metric measure spaces compare with the previously studied poincar inequalities on graphs and riemannian manifolds .",
    "then we show that poincar inequality is stable under quasi - isometric transformation of quasi - geodesic spaces .    in chapter [ ch - markov ]",
    ", we introduce various hypotheses on the markov chain , dirichlet forms and study their basic properties . in chapter [ ch - sob ] , we introduce and prove a sobolev inequality under the assumptions of large scale volume doubling and poincar inequality . in chapter",
    "[ ch - ehi ] , we use sobolev inequality and poincar inequality to run the moser iteration argument to prove elliptic harnack inequality .    chapter [ ch - gub ] is devoted to the proof of gaussian upper bounds using sobolev inequality .",
    "in addition , we show that sobolev inequality is equivalent to the conjunction of gaussian upper bounds on the heat kernel and large scale volume doubling property . in chapter [ ch - glb ]",
    "we prove gaussian lower bounds using elliptic harnack inequality and gaussian upper bounds .",
    "this completes the proof that large scale volume doubling property and poincar inequality implies two sided gaussian bound on the heat kernel .    in chapter [ ch - phi ]",
    ", we prove parabolic harnack inequality using gaussian bounds .",
    "moreover , we prove large scale volume doubling property and poincar inequality using parabolic harnack inequality , and thereby completing the proof of the characterization parabolic harnack inequality and gaussian bounds . in chapter",
    "[ ch - apply ] , we mention various applications of gaussian estimates and harnack inequalities . in appendix",
    "[ a - example ] , we collect various examples and supplement them with figures and discussions .",
    "let @xmath100 be a locally compact metric measure space where @xmath102 is a radon measure with full support .",
    "let @xmath180 denote the borel @xmath12-algebra on @xmath101 .",
    "let @xmath181 denote the closed ball in @xmath107 for metric @xmath134 with center @xmath13 and radius @xmath70 .",
    "let @xmath182 denote the volume of the closed ball centered at @xmath13 of radius @xmath14 .",
    "since @xmath107 is a radon measure with full support , we have that @xmath183 is finite and positive for all @xmath61 and for all @xmath63 . in this section ,",
    "we introduce some assumptions on the metric @xmath134 and measure @xmath102 and study some consequences of those assumptions .",
    "the main assumption on the metric @xmath134 of the metric measure space @xmath100 is that of quasi - geodesicity . in riemannian geometry ,",
    "the distance between two points of a manifold is defined as the infimum of lengths of curves joining them .",
    "such a relation between distance and length of curves is observed more generally in length spaces .",
    "let @xmath101 be a metric space . for @xmath38 ,",
    "a _ path _ from @xmath13 to @xmath184 is a continuous map @xmath185 \\to m$ ] such that @xmath186 and @xmath187 .",
    "we define the _ length _",
    "$ ] of a path @xmath189 is the supremum @xmath190 } \\sum_{i } d ( \\gamma(t_{i-1}),\\gamma(t_i)).\\ ] ] taken over all partition @xmath191 of @xmath192 $ ] .",
    "the length of a path is a non - negative real number or @xmath193 .",
    "the _ inner metric _ or _ length metric _ associated with metric space @xmath101 is the function @xmath194 $ ] defined by @xmath195 where the infimum is taken over all paths @xmath189 from @xmath13 to @xmath184 .",
    "@xmath101 is called a _ length space _ if @xmath196 .",
    "a metric for which @xmath197 is called an intrinsic metric .",
    "[ r - nograph]all riemannian manifolds equipped with riemannian distance are length spaces .",
    "since infimum of an empty set is @xmath193 , for points @xmath198 in different connected components of a metric space @xmath101 , we have @xmath199 .",
    "hence graphs with natural combinatorial metric are not length spaces because distinct vertices belong to different connected components under the metric topology .",
    "see ( * ? ? ?",
    "* chapter 1 ) or ( * ? ? ?",
    "* chapter 2 ) for a comprehensive introduction of length spaces .",
    "one of the goals of this work is to provide an unified approach to the study of random walks in continuous spaces like riemannian manifolds and discrete spaces like graphs . in view of remark [ r - nograph ] , we would like to consider spaces more general than length spaces to include disconnected metric spaces like graphs .",
    "quasi - geodesic spaces provides a natural setting to include both length spaces and graphs as special cases .",
    "quasi - geodesic spaces are equipped with a weak notion of geodesics called chains .",
    "we recall the following definition of chain and various notions of geodesicity as presented by tessera in @xcite .",
    "consider a metric space @xmath101 and @xmath200 .",
    "for @xmath38 , a _",
    "@xmath201-chain _ between from @xmath13 to @xmath184 , is a sequence @xmath202 in @xmath107 such that for every @xmath203 , @xmath204 .",
    "we define the _ length _ @xmath205 of a @xmath201-chain @xmath206 by setting @xmath207 define a new distance function @xmath208 $ ] as @xmath209 where @xmath189 runs over every @xmath201-chain from @xmath13 to @xmath184 .",
    "we say a metric space @xmath101 is    * @xmath201-geodesic if @xmath210 for all @xmath38 . * quasi-@xmath201-geodesic if there exists @xmath39 such that @xmath211 for all @xmath38 . * quasi - geodesic if there exists @xmath200 such that @xmath101 is quasi-@xmath201-geodesic .    we collect some simple consequences of the definitions .    *",
    "any @xmath201-geodesic space is quasi-@xmath201-geodesic .",
    "moreover @xmath201-quasi - geodesic space is @xmath212-quasi - geodesic for all @xmath213 . *",
    "any length space is @xmath201-geodesic for all @xmath200 .",
    "* graphs with natural combinatorial metric are @xmath201-geodesic if and only if @xmath214 . if @xmath215 , then @xmath216 for distinct vertices @xmath13 and @xmath184 .    the following lemma guarantees that quasi - geodesic spaces are endowed with sufficiently short chains at many length scales .",
    "[ l - chain ] let @xmath101 be a quasi-@xmath201-geodesic space for some @xmath200 .",
    "then there exists @xmath217 such that for all @xmath213 and for all @xmath38 , there exists a @xmath212-chain @xmath218 with @xmath219 .",
    "since @xmath101 is quasi-@xmath201-geodesic , there exists @xmath39 such that for all @xmath38 , there exists a @xmath201-chain @xmath220 satisfying @xmath221 .",
    "we define a smaller @xmath212-chain @xmath222 where @xmath223 .",
    "we choose @xmath224 and define @xmath225 successively by @xmath226 for @xmath227 .",
    "define @xmath228 . by the definition of @xmath225 we have that @xmath229 for all @xmath230 .",
    "therefore we have @xmath231 by triangle inequality , we have @xmath232 .",
    "therefore @xmath233 hence the choice @xmath234 satisfies the desired conclusion .      the main assumption that we recall below on the radon measure",
    "@xmath102 is the doubling property . for a metric measure space @xmath100 ,",
    "we denote volume of balls by @xmath103 .",
    "we define the following doubling hypothesis :    * we say a space @xmath100 satisfies the local volume doubling property @xmath235 , if for all @xmath63 , there exists @xmath236 such that @xmath237 for all @xmath61 .",
    "* we say a space @xmath100 satisfies the large scale doubling property @xmath238 , if there exists positive reals @xmath239 such that @xmath240 for all @xmath61 and @xmath241 . *",
    "we say a space @xmath100 satisfies the global volume doubling property @xmath242 , if there exists a constant @xmath243 such that @xmath244 for all @xmath61 and @xmath63 .",
    "the property [ doub - glob ] implies [ doub - inf ] and [ doub - loc ] . the property [ doub - loc ] is a condition local in @xmath14 but uniform in @xmath61 while [ doub - inf ] and [ doub - glob ] are uniform in both @xmath13 and @xmath14 .",
    "the property [ doub - loc ] is a very weak property of bounded geometry introduced in @xcite .",
    "since @xmath236 depends on @xmath14 , the local volume doubling property does impose too much constraint on volume growth as @xmath245 .",
    "however , we will see in lemma [ l - doub - prop ] that large scale doubling can be used to control volume of large balls .",
    "we describe some examples satisfying the above hypothesis on volume growth .",
    "every connected graph with bounded degree and equipped with the counting measure satisfies [ doub - loc ] . by bishop - gromov inequality (",
    "* theorem iii.4.5 . ) , riemannian manifolds with ricci curvature bounded from below satisfy [ doub - loc ] and riemannian manifolds with non - negative ricci curvature satisfy [ doub - glob ] .",
    "we collect some basic properties of spaces satisfying the above doubling hypothesis [ doub - loc ] and [ doub - inf ] .",
    "( ( * ? ? ?",
    "* lemma 2.1 ) ) [ l - vloc ] if @xmath100 satisfies [ doub - loc ] , then for all @xmath246 , there exists @xmath247 such that @xmath248 for all @xmath61 . in particular , for all @xmath38 , such that @xmath249 , we have @xmath250    let @xmath251 be the smallest integer such that @xmath252 . by repeated application of [ doub - loc ] , the choice @xmath253 satisfies , where the constant @xmath254 is from [ doub - loc ] .",
    "the second part follows from @xmath255 and .",
    "the large scale doubling property [ doub - inf ] along with [ doub - loc ] implies a polynomial volume growth upper bound .",
    "[ l - doub - prop ] let @xmath100 be a metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "then for all @xmath256 , there exists @xmath257 such that @xmath258 for all @xmath61 and @xmath259 .",
    "moreover this @xmath260 satisfies @xmath261 for all @xmath61 , for all @xmath262 and for all @xmath263 .",
    "furthermore @xmath264 holds for all @xmath265 , for all @xmath61 , for all @xmath266 and for all @xmath263 .",
    "let @xmath267 be constants from [ doub - inf ] .",
    "there is nothing to prove if @xmath268 .",
    "assume @xmath269 and let @xmath14 be such that @xmath270 . then by lemma [ l - vloc ] and [ doub - inf ] @xmath271 the case @xmath241 follows from [ doub - inf ] which concludes the proof of .",
    "+ let @xmath262 , @xmath272 and @xmath273 . then from , we get , @xmath274 to obtain from , note that @xmath275    the equation implies a polynomial upper bound on the volume growth . in quasi - geodesic spaces , we can reverse the inequality and obtain a polynomial lower bound for all radii small enough compared to the diameter . the property stated in following lemma",
    "is often called the reverse volume doubling property .",
    "it was known for graphs and riemannian manifolds and our proof follows similar ideas .",
    "[ l - rvd ] let @xmath100 be a quasi-@xmath201-geodesic space with the measure @xmath102 satisfying [ doub - loc ] and [ doub - inf ] .",
    "then there exists @xmath276 such that @xmath277 for all @xmath61 and for all @xmath278 , where @xmath279 denotes the diameter of @xmath100 .",
    "we first consider the case @xmath280 .",
    "let @xmath61 and let @xmath281 be chosen such that @xmath282 .",
    "let @xmath283 be a @xmath284-chain with minimal number of points @xmath285 .",
    "therefore there exists @xmath286 such that @xmath287 .",
    "+ since @xmath288 , we have @xmath289 . by lemma [ l - doub - prop ]",
    ", there exists @xmath290 such that @xmath291 therefore we obtain @xmath292 for all @xmath61 and @xmath293 .",
    "define @xmath294 and @xmath295 .",
    "then by @xmath296 for all @xmath61 and @xmath297 .",
    "the other cases follow from lemma [ l - vloc ] and by choosing @xmath298      one of the goals of this work is to develop arguments which are robust to small perturbations in the geometry of the underlying space ; for example addition of few edges in a graph or small changes in the metric of a riemannian manifold .",
    "we study properties that depends mainly on the large scale geometry of the underlying space . in this spirit ,",
    "the concept of quasi - isometry was introduced by kanai in @xcite and in the more restricted setting of groups by gromov in @xcite .",
    "informally , two metric spaces are quasi - isometric if they have the same large scale geometry . here",
    "is a precise definition :    [ d - qi - ms ] a map @xmath299 , between metric spaces is called a quasi - isometry if the following conditions are satisfied :    * there exists @xmath300 and @xmath301 such that @xmath302 for all @xmath303 .",
    "* there exists @xmath290 , such that for all @xmath304 there exists @xmath305 such that @xmath306 .",
    "we say metric spaces @xmath307 and @xmath308 are quasi - isometric if there exists a quasi - isometry @xmath299 .",
    "quasi - isometry is an equivalence relation among metric spaces .",
    "quasi - isometry is also called as _ rough - isometry _ or _ coarse quasi - isometry_. property ( i ) of definition [ d - qi - ms ] above is called _ roughly bi - lipschitz _ and ( ii ) is called _",
    "roughly surjective_.",
    "we remark that a quasi - isometry is not necessarily a continuous map .",
    "moreover , quasi - isometry is not necessarily injective and not necessarily surjective .",
    "however , we can construct a _ quasi - inverse _ @xmath309 as @xmath310 where @xmath305 is chosen so that @xmath311 where @xmath312 is given by the above definition .",
    "we now describe some well - known examples of quasi - isometry .",
    "the space @xmath313 with euclidean metric and @xmath314 with standard graph metric ( same as @xmath315 metric ) are quasi - isometric . consider a finitely generated group @xmath316 with a finite system of generator @xmath317 .",
    "for an element @xmath318 , let @xmath319 denote the smallest positive integer @xmath251 such that a product of @xmath251 elements of @xmath320 , and put @xmath321 .",
    "this @xmath322 is called the _ word norm _ of @xmath316 and defines a _ word metric _ @xmath323 .",
    "in other words , @xmath324 is the graph metric in the cayley graph of @xmath316 corresponding to the symmetric generating set @xmath320 .",
    "assume two finite generating sets @xmath317 and @xmath325 of a group @xmath316 which induces metric @xmath324 and @xmath326 respectively .",
    "then @xmath327 and @xmath328 are quasi - isometric ( see ( * ? ? ?",
    "* proposition 1.15 ) ) .",
    "therefore every finitely generated group defines a unique word metric space up to quasi - isometry and we may often view a finitely generated group up as a metric space without explicitly specifying the generating set . a large class of examples of quasi - isometry is given by the varc - milnor theorem .",
    "we refer the reader to ( * ? ? ?",
    "* theorem 1.18 ) for a proof and original references .",
    "( varc - milnor theorem ) [ t - sm ] suppose that @xmath101 is a length space and @xmath316 is a finitely generated group equipped with a word metric acting properly and cocompactly by isometries on @xmath107 .",
    "then @xmath316 is quasi - isometric to @xmath101 .",
    "the map @xmath329 is a quasi - isometry for each fixed base point @xmath330 .",
    "note that the quasi - isometry between @xmath314 and @xmath313 is a special case of theorem [ t - sm ] .",
    "we will give a general construction of _ net _ which approximates a quasi - geodesic space using a graph with combinatorial metric in next subsection .",
    "the notion of quasi - isometry was extended to metric measure spaces by couhlon and saloff - coste in @xcite which they called `` isometry at infinity '' .",
    "let @xmath331 , @xmath332 be two metric measure spaces .",
    "define @xmath333    [ d - qi - mms ] a map @xmath334 , between metric measure spaces is called a _ quasi - isometry _ if the following conditions are satisfied :    * @xmath299 is a quasi - isometry between metric spaces ; * there exists a constant @xmath39 such that @xmath335 for all @xmath305 .",
    "we say metric measure spaces @xmath336 and @xmath337 are quasi - isometric if there exists a quasi - isometry @xmath334 .",
    "quasi - isometry is an equivalence relation for metric measure spaces satisfying local volume doubling property [ doub - loc ] .",
    "the notion of large scale equivalence as defined in definition 5.5 of @xcite is more general .",
    "that is every quasi - isometry is a large scale equivalence .",
    "however a map between quasi - geodesic metric measure spaces satisfying [ doub - loc ] is a quasi - isometry if and only if it is large scale equivalence .",
    "see ( * ? ? ?",
    "* remark 5.7 ) .",
    "the arguments in this work implies that the long term behavior of natural random walks depends mainly on the large scale geometry of the quasi - geodesic space .",
    "other important examples of properties invariant under quasi - isometries are large scale doubling and poincar inequality .",
    "( see proposition [ p - qivd ] and proposition [ p - robustmms ] ) .",
    "we conclude this subsection by proving that the large scale doubling property is preserved by quasi - isometries for metric measure spaces satisfying [ doub - loc ] .",
    "it is due to couhlon and saloff - coste in @xcite .",
    "we need the following definition :    [ d - maxsep ] let @xmath101 be a metric space with @xmath338 and let @xmath339 .",
    "then a subset @xmath340 of @xmath341 is _ @xmath342-separated _ if @xmath343 whenever @xmath344 and @xmath345 are distinct points of @xmath340 , and a @xmath342-separated subset @xmath340 of @xmath341 is called maximal if it is maximal among all @xmath342-separated subsets of @xmath341 with respect to the partial order of inclusion .",
    "the existence of maximal @xmath342-separated subsets follows from zorn s lemma .",
    "the following lemma compares volume of balls between quasi - isometric metric measure spaces .",
    "[ l - qi - vc ] ( ( * ? ? ?",
    "* proposition 2.2 ) ) let @xmath346 and @xmath337 be a quasi - isometry between metric measure spaces satisfying [ doub - loc ] .",
    "then for all @xmath347 , there exists @xmath348 such that @xmath349 for all @xmath305 and for all @xmath350 .",
    "we denote balls and volumes by @xmath351 and @xmath352 respectively for @xmath332 .",
    "let @xmath353 such that @xmath354 where @xmath355 is from definition [ d - qi - ms ] .",
    "let @xmath340 be a maximal @xmath342-separated subset of @xmath40 .",
    ". hence @xmath357 by lemma [ l - vloc ] and definition [ d - qi - mms ] , we have @xmath358 for all @xmath359 .",
    "the balls @xmath360 are pairwise disjoint and hence the balls @xmath361 are pairwise disjoint . by lemma [ l - vloc ] @xmath362 combining [ qiv0],[qiv1 ] and [ qiv2 ] @xmath363",
    "the last step follows from the definition of quasi - isometry , triangle inequality and that @xmath361 are pairwise disjoint .",
    "we can choose @xmath364 large enough so that , @xmath365 for all @xmath366 .",
    "hence by lemma [ l - doub - prop ] , we have the desired lower bound on @xmath367 for all @xmath368 and by lemma [ l - vloc ] for all @xmath350 .",
    "similar argument applied to quasi - inverse @xmath369 yields @xmath370 the conclusion follows from the fact that @xmath371 is bounded uniformly for all @xmath305 .    for metric measure spaces satisfying [ doub - loc ] ,",
    "the condition [ doub - inf ] is preserved by quasi - isometries .",
    "this is the content of the following lemma .",
    "[ p - qivd ] ( ( * ? ? ?",
    "* proposition 2.3 ) ) let @xmath372 and @xmath337 be quasi - isometric spaces satisfying [ doub - loc ]",
    ". then @xmath336 satisfies [ doub - inf ] if and only if @xmath337 satisfies [ doub - inf ] .",
    "let @xmath373 be a quasi - isometry .",
    "using lemma [ l - qi - vc ] , there exists @xmath39 such that @xmath374 for all @xmath375 and @xmath376 . hence by , we have @xmath377 for all @xmath378",
    ".      one might think of @xmath314 as a graph approximation or discretization of @xmath313 .",
    "more generally , we can approximate quasi - geodesic spaces by graphs . by ( * ? ? ?",
    "* proposition 6.2 ) , a metric space is quasi - isometric to a graph if and only if it is quasi - geodesic .",
    "therefore quasi - geodesic spaces form a natural class of metric spaces that can be roughly approximated by graphs .",
    "+ we begin by recalling some standard definitions and notation from graph theory . we restrict ourselves to simple graphs .",
    "a _ graph _",
    "@xmath2 is a pair @xmath379 where @xmath174 is a set ( finite or infinite ) called the",
    "_ vertices _ of @xmath2 and @xmath380 is a subset of @xmath381 ( _ i.e._,two - element subsets of @xmath174 ) called the _",
    "edges _ of @xmath2 .",
    "a graph @xmath382 is _ countable _ ( resp . _ infinite _ ) if @xmath174 is a countable ( resp .",
    "infinite ) set .",
    "we say that @xmath170 is a neighbor of @xmath383 ( or in short @xmath384 ) , if @xmath385 .",
    "the _ degree _ of @xmath170 is the number of neighbors of @xmath170 , that is @xmath386 .",
    "a graph @xmath382 is said to have _ bounded degree _ if @xmath387 .",
    "a finite sequence @xmath388 of points in @xmath174 is called a _ path _ from @xmath389 to @xmath390 of _ length _",
    "@xmath391 , if each @xmath138 is a neighbor of @xmath392 .",
    "a graph @xmath379 is said to be _ connected _ if for all @xmath393 , there exists a path from @xmath170 to @xmath383 . for points @xmath393 of a graph @xmath379 ,",
    "let @xmath394 denote the minimum of the lengths of paths from @xmath170 to @xmath383 with @xmath395 if there exists no path from @xmath170 to @xmath383 .",
    "this makes @xmath396 an extended metric space .",
    "the graph @xmath382 is connected if and only if @xmath396 is a metric space .",
    "the extended metric @xmath397 is called _ graph metric _ or _ combinatorial metric _ of @xmath2 . notice that we can recover a graph @xmath382 from its ( extended ) metric space structure @xmath396 and vice - versa .    using the above identification",
    ", we view a connected graph as a metric space .",
    "we would like to view a connected graph as a metric measure space .",
    "this motivates the definition of weighted graph .",
    "a _ weight _",
    "@xmath398 on a graph @xmath382 is a positive function on @xmath174 . with a slight abuse of notation",
    ", @xmath285 induces a measure on @xmath174 ( also denoted by @xmath285 ) as @xmath399 for each @xmath400 .",
    "a _ weighted graph _ is a graph @xmath382 endowed with a weight @xmath285 . by the above",
    ", we will identify a weighted graph @xmath379 with weight @xmath285 as a ( possibly extended ) metric measure space @xmath401 .",
    "the definition of @xmath312-net is due to kanai in the setting of riemannian manifolds ( see @xcite ) and was extended in @xcite for weighted riemannian manifolds .",
    "[ d - net ] a @xmath312-net of a metric measure space @xmath100 is a weighted graph @xmath379 with weight @xmath285 described as follows : the vertices @xmath174 is a maximal @xmath312-separated subset of @xmath107 .",
    "the edges @xmath380 are defined by @xmath385 if and only if @xmath402 . the weight @xmath285 is defined as @xmath403",
    "let @xmath397 denote the graph metric of @xmath2 .",
    "we often alternatively view the @xmath312-net as ( extended ) metric measure space @xmath401 defined by the corresponding weighted graph .",
    "the above definition does not guarantee @xmath312-net to be a connected graph .",
    "however it is connected and countable in many situations as described in the lemma below .",
    "we collect the basic properties of nets in proposition [ p - net ] which builds on the ideas of @xcite , @xcite and @xcite .",
    "[ p - net ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and let @xmath404 .",
    "let @xmath405 be an @xmath312-net of @xmath100 with weight @xmath285 and let @xmath406 denote the corresponding extended metric measure space .",
    "then we have the following :    * the collection of balls @xmath407 is pairwise disjoint and the collection @xmath408 covers @xmath107 where @xmath409 denotes closed metric ball in @xmath101 . * bounded degree property : the graph @xmath410 is of bounded degree , that is @xmath411 .",
    "* @xmath406 satisfies [ doub - loc ] .",
    "* there exists @xmath412 such that @xmath413 for all @xmath414 .",
    "therefore @xmath2 is a connected graph and @xmath406 is a metric measure space . * the metric measure spaces @xmath100 and @xmath406 are quasi - isometric .",
    "* @xmath341 is a countable set .",
    "moreover if @xmath415 , then @xmath341 is an infinite set . *",
    "if @xmath100 satisfies [ doub - inf ] , then so does @xmath406 .",
    "* finite overlap property : define @xmath416 for each @xmath417 and @xmath418 . then @xmath419 .",
    "we denote the volume of balls in @xmath100 and @xmath406 by @xmath420 and @xmath421 respectively .",
    "\\(a ) the collection @xmath422 is pairwise disjoint because @xmath341 is @xmath312-separated .",
    "the collection @xmath423 covers @xmath107 due to the maximality of @xmath341 .",
    "+ ( b ) let @xmath424 denote the degree of a vertex @xmath170 . since @xmath422 is a disjoint collection , using lemma [ l - vloc ] @xmath425 this yields @xmath426 for all @xmath427 .",
    "+ ( c ) let @xmath414 with @xmath428 . by lemma [ l - vloc ] , we obtain @xmath429 hence we have the uniform estimate @xmath430    by the above inequality and ( b ) , we have @xmath431 for all @xmath432 and @xmath63 .",
    "this along with ( b ) yields [ doub - loc ] .",
    "+ ( d ) let @xmath414 . by triangle inequality we have @xmath433 . by lemma [ l - chain",
    "] , there exists @xmath162 and an @xmath312-chain @xmath434 in @xmath101 such that @xmath435 .",
    "since @xmath423 covers @xmath107 , for each @xmath436 we can choose @xmath437 such that @xmath438 for @xmath439 .",
    "note that @xmath440 and @xmath441 . by triangle inequality @xmath442 or equivalently @xmath443 or @xmath444 for all @xmath445 .",
    "therefore @xmath446 this implies which implies the remaining conclusions .",
    "\\(e ) it follows from ( d ) that the inclusion map @xmath447 is a quasi - isometry of metric spaces . substituting @xmath448 and @xmath449 in and using ( b ) , and lemma [ l - vloc ]",
    ", there exists @xmath39 such that @xmath450 this proves that @xmath451 is a quasi - isometry between the metric measure spaces @xmath100 and @xmath406 .",
    "+ ( f ) it follows from ( b ) and ( d ) that @xmath2 is a connected graph with bounded degree .",
    "hence @xmath341 is countable . by , we have @xmath452 . therefore if @xmath453 , we have that @xmath405 is a connected graph with infinite diameter .",
    "hence @xmath341 is infinite .",
    "+ ( g ) it follows from ( c),(e ) and proposition [ p - qivd ] .",
    "+ ( h ) the proof is similar to ( b ) . using ( a ) and lemma [ l - vloc ] , we have @xmath454 this yields the uniform bound @xmath455 .    the bounded degree property and the estimate are true for all weighted graphs @xmath456 satisfying [ doub - loc ] as shown below .",
    "[ l - g - vloc ] let @xmath456 be a metric measure space satisfying [ doub - loc ] that corresponds to a weighted graph @xmath405 with weight @xmath285 .",
    "then @xmath2 is of bounded degree and @xmath457    by [ doub - loc ] , there exists @xmath39 such that @xmath458 for all @xmath414 with @xmath428 .",
    "the above inequality shows that @xmath459 and @xmath460",
    "poincar inequalities and its many variants are functional inequalities that have been extensively studied .",
    "many results in classical theory of sobolev spaces , hlder regularity estimates for solutions of elliptic and parabolic partial differential equations , properties of harmonic functions , harnack inequalities can be generalized to spaces satisfying volume doubling and a poincar inequality . see the introduction in @xcite for a survey and references .    roughly speaking poincar inequalities control the variance of a function on a smaller ball by its dirichlet energy ( integral of the square of gradient ) on a larger ball .",
    "we start by reviewing poincar inequalities on weighted riemannian manifolds .",
    "recall that a _ weighted riemannian manifold _",
    "@xmath6 is a riemannian manifold @xmath4 equipped with a measure @xmath102 having a smooth positive density @xmath461 with respect to the riemannian measure induced by the metric @xmath11 .",
    "the above function @xmath461 with @xmath462 is called a _",
    "weight_. recall that the _ gradient _ @xmath463 of a function @xmath85 is defined as the vector field satisfying @xmath464 for all vector fields @xmath340 .",
    "the _ length of the gradient _ is denoted by @xmath465 .",
    "we denote the riemannian distance function by @xmath134 , which makes @xmath101 a length space . in a context when distance function is important , we will denote the weighted riemannian manifold @xmath6 as a metric measure space @xmath100 . as before for @xmath100 , we denote closed ball and their volumes by @xmath40 and @xmath183 respectively .",
    "we say that a complete weighted riemannian manifold @xmath4 with measure @xmath102 satisfies a poincar inequality [ poin - rm ] if there exists @xmath466 , @xmath467 such that for all @xmath468 , for all @xmath61 and for all @xmath70 , @xmath469 where @xmath470 denote the @xmath102-average of @xmath177 in @xmath40 @xmath471    the above inequality is sometimes called a weak , local , scale - invariant or @xmath472 poincar inequality but we will refrain from using such adjectives .",
    "the word _ local _ means that we are interested in average and integrals _ around some point @xmath13_. this is in contrast with",
    "_ global _ poincar inequality in which average and integrals are over the whole space @xmath107 . the poincar inequality is _ scale - invariant _ or _ uniform _ to emphasize the fact the the constants @xmath473 and @xmath364 is independent of @xmath13 or @xmath14 . for @xmath474 ,",
    "we might replace [ poin - rm ] with the _ @xmath475 poincar inequality _",
    "@xmath476 instead of @xmath472 version presented above . for spaces satisfying global doubling property ,",
    "one can always take @xmath477 in [ poin - rm ] .",
    "this is due to d. jerison by a whitney decomposition argument @xcite ( see also ( * ? ? ?",
    "* section 5.3.2 ) ) .",
    "the poincar inequality with @xmath477 is called _ strong _ poincar inequality as opposed to the _ weak _ inequality [ poin - rm ] .      to generalize the poincar inequality [ poin - rm ] to metric measure spaces",
    ", we must find a suitable definition for `` length of gradient '' .",
    "we will consider a class of random walks that spreads over different distances .",
    "therefore we define length of gradient over different scales for a metric measure space .",
    "we use the following definition due to @xcite for length of gradient at a scale @xmath478 for a function @xmath479 with @xmath480 ( denoted by @xmath481 ) .",
    "[ d - grad ] let @xmath100 be a metric measure space . for any function @xmath482",
    ", the length of gradient at a scale @xmath478 for @xmath177 is defined as the function @xmath483 for all @xmath61 .",
    "our definition of @xmath481 coincides with @xmath484 in the notation of tessera @xcite .",
    "now that we are armed with length of gradient , we define the corresponding poincar inequality .",
    "we say that a metric measure space @xmath100 satisfies a poincar inequality at scale @xmath478 , if there exists @xmath466 , @xmath485 such that for all @xmath486 , for all @xmath61 and for all @xmath487 .",
    "@xmath488 where @xmath470 denote the @xmath102-average of @xmath177 in @xmath40 @xmath471 we will denote the above inequality by @xmath489 or simply @xmath490 .    the rest of the chapter is devoted to the study of various properties and examples of the above poincar inequality [ poin - mms ] . in particular , we will show that for a weighted riemannian manifold the poincar inequality at scale @xmath478 [ poin - mms ] , generalizes the poincar inequality [ poin - rm ] under some mild hypothesis .",
    "one of the main results that we will see in this chapter is that poincar inequality [ poin - mms ] is preserved under quasi - isometries .",
    "the following simple fact will be frequently used in rest of this chapter .",
    "let @xmath100 be a metric measure space and let @xmath491 with @xmath492 .",
    "then for every function @xmath493 @xmath494 where @xmath495 is the @xmath102-average of @xmath177 in a , @xmath496 in other words , mean minimizes squared error .",
    "a poincar inequality at scale @xmath478 implies a poincar inequality at all larger scales @xmath497 with @xmath498 .",
    "[ l - largesc ] let @xmath100 be a metric measure space satisfying [ doub - loc ] and poincar inequality [ poin - mms ] at scale @xmath478 .",
    "then for all @xmath499 , @xmath100 satisfies .",
    "assume @xmath489 .",
    "then for all functions @xmath500 and for all balls @xmath40 with @xmath241 and @xmath61 , we have @xmath501 which is @xmath502 . in the last line above , we used lemma [ l - vloc ] .",
    "[ r - pscale ] a question now arises : at what scales @xmath478 does a poincar inequality @xmath503 hold ?",
    "we have a satisfactory answer for length spaces and graphs .",
    "if a graph satisfies poincar inequality at some scale , it satisfies poincar inequality at all scales @xmath504 ( see corollary [ c - scalebig1 ] ) .",
    "moreover , a graph does not satisfy poincar inequality for scales smaller than 1 because the gradient at scales smaller than @xmath505 is identically zero .",
    "if a length space satisfies poincar inequality at some scale , then it satisfies poincar inequality at all positive scales ( see corollary [ c - allscales ] ) .",
    "we will see in proposition [ p - pscale ] that if @xmath503 is satisfied at for some @xmath506 then @xmath503 is true for all @xmath507 .",
    "we analyze an example which is neither a graph nor a length space ( see example [ x - bl ] ) to show that @xmath508 is the best possible bound .",
    "we now show that the constant @xmath509 in @xmath489 is flexible .",
    "[ l - pflex ] assume the poincar inequality @xmath489 holds for a metric measure space @xmath100 .",
    "then for every @xmath510 and there exists constants @xmath511 such that the poincar inequality @xmath512 holds .",
    "the non - trivial case to check is @xmath513 .",
    "assume @xmath40 with @xmath514 .",
    "then for all functions @xmath515 , by we have @xmath516 combining the above inequality with @xmath489 yields @xmath517 hence we can choose @xmath518 and @xmath519 .",
    "since quasi - isometry between metric measure spaces satisfying [ doub - loc ] is an equivalence relation , we may expect that a quasi - isometry preserves certain invariants of such spaces .",
    "for instance , we saw in proposition [ p - qivd ] that quasi - isometry preserves the large scale doubling property . in this section , we shall see that quasi - isometry preserves poincar inequality [ poin - mms ] .",
    "the approach for proving robustness of functional inequalities can traced back to the seminal works of kanai @xcite and further developments by couhlon and saloff - coste @xcite .",
    "the idea is to show that a functional inequality on the metric measure space is equivalent to a similar functional inequality on its net .",
    "since quasi - isometry is an equivalence relation , it suffices to show that the functional inequality on graphs is preserved under quasi - isometries . to compare functional inequalities back and forth between a metric measure space and its net , we need to be able to transfer functions on metric measure space to functions on its net and vice - versa .",
    "we start by developing those tools .    as before ,",
    "let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and let @xmath406 be its @xmath312-net for some fixed @xmath404 .",
    "by proposition [ p - net ] , we have that @xmath406 is a metric measure space satisfying [ doub - loc ]",
    ". moreover the graph corresponding to @xmath406 is connected , countable with bounded degree .",
    "let @xmath520 be the maximum degree .",
    "we will denote closed balls in @xmath100 and @xmath521 by @xmath325 and @xmath522 respectively .",
    "similarly , we denote their corresponding volumes by @xmath174 and @xmath421 respectively .    given a function @xmath523 ,",
    "we a define a function @xmath524 on its net as @xmath525 for all @xmath61 .",
    "conversely , given a function @xmath526 on the net , we define @xmath527 as @xmath528 where @xmath529 is defined by @xmath530 the sum in and denominator of is a finite sum due to the finite overlap property of proposition [ p - net](h ) .",
    "moreover , there exists a constant @xmath531 such that @xmath532 is a partition of unity ( @xmath533 ) satisfying @xmath534 for all @xmath432.the above properties of the partition of unity @xmath535 can be verified using proposition [ p - net ] .",
    "we will now compare norms and gradients for the transfer of functions between metric measure space and its net .",
    "for a metric measure space @xmath100 and for all @xmath536 where @xmath491 , we denote by @xmath537 we adapt the same notation for its net by considering it as a metric measure space .",
    "[ d - disg ] for a function @xmath526 on a graph @xmath410 , we define the _ discrete gradient _ of @xmath177 at @xmath13 as @xmath538    this definition of discrete gradient was used to define poincar inequality for graphs in @xcite .",
    "we now show that our definition of @xmath539 is comparable to @xmath540 .",
    "[ l - discgrad ] let @xmath406 be a weighted graph satisfying [ doub - loc ] .",
    "then there exists @xmath39 such that @xmath541 for all functions @xmath526 and for all @xmath432 .",
    "we write the gradient as @xmath542 the conclusion immediately follows from lemma [ l - g - vloc ] .    therefore our poincar inequality @xmath543 generalizes the poincar inequality for graphs considered by delmotte @xcite . using the above lemma ,",
    "our definition of @xmath543 for graphs is equivalent to the @xmath472 version of @xmath544 for graphs in @xcite .",
    "the next lemma compares gradient of a function on net and with its metric measure space version .",
    "[ l - grad - comp - mms ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and let @xmath456 be its @xmath312-net for some @xmath404 . for all @xmath506 ,",
    "there exists positive reals @xmath545 such that for all @xmath61 , for all @xmath546 , and for all functions",
    "@xmath526 , we have @xmath547 where @xmath548 is such that @xmath549 and @xmath550 is defined as in .    using lemma [ l - vloc ] , proposition [ p - net ] ( a ) and",
    ", there exists @xmath551 such that @xmath552 for all @xmath61 and @xmath546 . for all @xmath553 , @xmath554 and @xmath555",
    ", we have @xmath556 for the last line , if @xmath557 , then by triangle inequality @xmath558 , @xmath559 and therefore @xmath560 whenever @xmath557 .",
    "let @xmath561 be the maximum degree of the net from proposition [ p - net](b ) and @xmath562 where @xmath317 is from . since @xmath563 , we have @xmath564 let @xmath565 be a path from @xmath284 to @xmath26 . for all @xmath566 , by cauchy - schwarz inequality",
    "we have @xmath567 combining , and @xmath568 for all @xmath61 and all @xmath546 .",
    "the second line follows from and the last line from @xmath569 .",
    "the following proposition shows that poincar inequalities can be transferred between a metric measure space and its net .",
    "[ p - poin - netmms ] let @xmath100 be a @xmath201-quasi - geodesic space satisfying [ doub - loc ] and let @xmath456 be its @xmath312-net for some @xmath404 .",
    "then for all @xmath570 , @xmath406 satisfies @xmath543 if and only if @xmath100 satisfies @xmath503 .    in general , we do not know if the inequality @xmath571 in the above statement is required .",
    "we believe that @xmath507 is sufficient but we are unable to prove this .",
    "suppose @xmath406 satisfies @xmath572 .",
    "let @xmath573 and let @xmath574 be defined as .",
    "let @xmath61 and @xmath241 be arbitrary .",
    "let @xmath548 be such that @xmath549 .",
    "there exists @xmath466 such that , we have @xmath575 for all @xmath576 and all functions @xmath11 . the second line above follows from , proposition [ p - net ] ( a ) and .",
    "the last line follows from @xmath577 .",
    "the first term above is bounded using jensen s inequality as @xmath578 hence by lemma [ l - vloc ] , we have @xmath579 for some @xmath580 large enough .",
    "we used lemma [ l - vloc ] and triangle inequality in second line above and proposition [ p - net](h ) and in the last line . choose @xmath581 in",
    ", so as to apply @xmath582 on @xmath456 to bound the second term in as @xmath583 for all @xmath584 satisfying @xmath384 , by jensen s inequality and triangle inequality we have @xmath585 hence for all @xmath427 , @xmath586 the third line follows from lemma [ l - vloc ] and the last line from bounded degree property of proposition [ p - net](b ) . combining , along with and proposition [ p - net](h ) gives @xmath587 combining , and yields poincar inequality @xmath588 for @xmath100 . by lemma [ l - largesc ] , we get @xmath503 for all @xmath570 .",
    "conversely , suppose that @xmath100 satisfies @xmath589 for some @xmath570 .",
    "let @xmath590 be an arbitrary function and define @xmath591 as in .",
    "denote @xmath592 be an arbitrary ball in @xmath456 where @xmath593 . then using , [ doub - loc ] and the inequality @xmath594 we have @xmath595 for all @xmath576 .",
    "using proposition [ p - net](a ) and , there exists positive reals @xmath596 such that for all @xmath597 and all functions @xmath177 , we have @xmath598 in the second step above , we fix @xmath599 and apply poincar inequality [ poin - mms ] and in the last line we apply lemma [ l - grad - comp - mms ] .",
    "let @xmath600 and @xmath601 .",
    "since @xmath602 , we have @xmath603 the last line follows from cauchy - schwarz inequality and maximum degree @xmath604 from proposition [ p - net](b ) . using this estimate",
    ", we have @xmath605 thus @xmath543 for @xmath456 follows from , and along with lemma [ l - discgrad ] .",
    "we now show that poincar inequality @xmath543 is preserved under quasi - isometry for graphs .",
    "let @xmath456 be a weighted graph .",
    "then for the closed balls in the graph , we have @xmath606 . hence by lemmas [ l - pflex ] and [ l - discgrad ] , we have the following equivalent definition of @xmath543 : a weighted graph @xmath456 satisfies @xmath543 , if there exists @xmath466 , @xmath467 such that for all @xmath607 , for all @xmath432 and for all @xmath150",
    ". @xmath608 where @xmath609 is the average of @xmath177 in @xmath610 with respect to measure @xmath285 .",
    "we will use the alternate definition for the proposition below .",
    "[ @xcite , proposition 4.2 ] [ p - graphrobust ] let @xmath611 and @xmath612 be quasi - isometric weighted graphs that satisfy [ doub - loc ]",
    ". then @xmath611 satisfies @xmath543 if and only if @xmath612 satisfies @xmath543 .",
    "we denote the balls , volume of balls and gradient of @xmath613 by @xmath614 respectively for @xmath332 .",
    "assume that @xmath611 satisfies @xmath543 .",
    "let @xmath615 be a quasi - isometry with @xmath616 for some @xmath617 .",
    "let @xmath618 and let @xmath619 denote the average of @xmath177 in @xmath620 with respect to measure @xmath621 .",
    "applying @xmath543 to the function @xmath622 , we have @xmath623 for all @xmath624 , we have @xmath625 the first line follows from the quasi - isometry condition @xmath626 and the second line from bounded degree property of lemma [ l - g - vloc ] .",
    "since @xmath451 is a quasi - isometry , there exists @xmath627 such that @xmath628 for all @xmath624 .",
    "an application of cauchy - schwarz inequality along the minimal path @xmath629 gives @xmath630 for all @xmath631 such that @xmath632 .",
    "combining , and of lemma [ l - g - vloc ] , we obtain @xmath633 since @xmath451 is a quasi - isometry , there exists @xmath634 such that @xmath635 for all @xmath636 and @xmath150 .",
    "combining this with and lemma [ l - g - vloc ] gives @xmath637 for all @xmath150 , for all @xmath61 and for all functions @xmath177 .",
    "we write , @xmath638 the second and third lines above follow from @xmath639 along with jensen s inequality .",
    "the last two lines follow from lemmas [ l - g - vloc ] and [ l - vloc ] to compare @xmath640 . by lemma [ l - g - vloc ]",
    ", we have @xmath641 for all @xmath642 and for all @xmath643 .",
    "it follows that @xmath644 an application of cauchy - schwarz inequality similar to yields @xmath645 finally by lemma [ l - g - vloc ] , @xmath646 combining , and , we have @xmath647 suppose we prove that @xmath648 then and gives @xmath649 for all @xmath305 and for all @xmath150 .",
    "thus we obtain poincar inequality for all balls centered in the image of @xmath451 .",
    "let @xmath304 .",
    "then there exists @xmath650 such that @xmath651 .",
    "it follows from that @xmath652 hence by , we have @xmath543 for @xmath612 .",
    "+ it remains to show .",
    "let @xmath653 denote the quasi - inverse such that @xmath654 is such that @xmath655 .",
    "we have by and @xmath594 that @xmath656 where @xmath657 and @xmath658 for all @xmath576 .",
    "let @xmath659 , then @xmath660 . we bound @xmath661 as @xmath662 the second line follows from jensen s inequality .",
    "the third line follows from @xmath660 and an application of cauchy - schwarz inequality similar to .",
    "the last two lines follows from bounded degree property and of lemma [ l - g - vloc ] . for the second term @xmath663",
    ", we have @xmath664 we use the fact that @xmath451 and @xmath369 are quasi - isometries .",
    "indeed , for @xmath665 big enough @xmath666 , since @xmath369 is a quasi - isometry with @xmath667 moreover @xmath668 is uniformly bounded over all @xmath669 .",
    "choose @xmath670 .",
    "the bounds on @xmath661 and @xmath663 along with the choice @xmath671 concludes the proof of .",
    "[ c - scalebig1 ] let @xmath456 be a weighted graph satisfying [ doub - loc ] and let @xmath504",
    ". then @xmath456 satisfies @xmath543 if and only if @xmath456 satisfies @xmath503 .    by lemma [ l - largesc ]",
    ", @xmath543 implies @xmath503 .",
    "+ conversely , assume @xmath456 satisfies @xmath503 .",
    "fix @xmath672 .",
    "since @xmath673 for all functions @xmath526 , @xmath456 satisfies @xmath674 .",
    "_ @xmath251-fuzz _ of a weighted graph is defined as the weighted graph @xmath675 where the edges are defined by @xmath676 if and only if @xmath677 for @xmath414 .",
    "it is straightforward to verify that the @xmath251-fuzz @xmath675 satisfies [ doub - loc ] and is quasi - isometric to @xmath456 .",
    "since @xmath456 satisfies @xmath674 , the @xmath251-fuzz @xmath675 satisfies @xmath543 .",
    "hence by proposition [ p - graphrobust ] , @xmath456 satisfies @xmath543 .",
    "as outlined at the start , the robustness of poincar inequality on graphs in proposition [ p - graphrobust ] can be transferred to arbitrary quasi - geodesic spaces using proposition [ p - poin - netmms ] .",
    "[ p - robustmms ] for @xmath332 , let @xmath331 be quasi-@xmath678-geodesic spaces satisfying [ doub - loc ] .",
    "assume @xmath336 and @xmath337 are quasi - isometric .",
    "let @xmath679 and for all @xmath680",
    ". then @xmath336 satisfies @xmath681 if and only if @xmath337 satisfies @xmath682 .",
    "it is a direct consequence of propositions [ p - poin - netmms ] and [ p - graphrobust ] .",
    "the above proposition along with the fact that length space is @xmath201-geodesic for all @xmath200 gives the following .",
    "[ c - allscales ] let @xmath100 be a length space satisfying [ doub - loc ] .",
    "then for every @xmath683 , @xmath100 satisfies @xmath681 if and only if @xmath100 satisfies @xmath682 .      in this section",
    ", we see the relationship between various poincar inequalities on a weighted riemannian manifold .",
    "we start by introducing some poincar inequalities from @xcite .",
    "we say that a complete weighted riemannian manifold @xmath4 with measure @xmath102 satisfies [ poin - inf ] if there exists @xmath684 , @xmath466 , @xmath467 such that for all @xmath468 , for all @xmath61 and for all @xmath487 , we have @xmath685 where @xmath470 denote the average of @xmath177 in @xmath40 with respect to @xmath102 .",
    "we say that a complete weighted riemannian manifold @xmath4 with measure @xmath102 satisfies [ poin - loc ] if there exists @xmath466 , @xmath467 such that for all @xmath468 , for all @xmath61 and for all @xmath686 , we have @xmath687 where @xmath470 denote the average of @xmath177 in @xmath40 with respect to @xmath102 .    it is clear that [ poin - rm ] implies [ poin - inf ] and [ poin - loc ] .",
    "the inequality [ poin - loc ] is a weak assumption .",
    "for instance , manifolds with a lower bound on ricci curvature satisfy [ poin - loc ] .",
    "inequality [ poin - inf ] is a large scale version of [ poin - rm ] .",
    "( ( * ? ? ?",
    "* proposition 6.10 ) ) [ p - robrm ] let @xmath6 be a weighted riemannian manifold satisfying [ doub - loc ] and [ poin - loc ] and let @xmath456 be its @xmath312-net for some @xmath290 . then @xmath4 with measure @xmath102 satisfies [ poin - inf ] if and only if @xmath456 satisfies @xmath543",
    "propositions [ p - robrm ] and [ p - poin - netmms ] along with corollary [ c - allscales ] gives the following    [ p - rmtfae ] let @xmath6 be a weighted riemannian manifold with riemannian distance @xmath134",
    ". denote by @xmath406 be an @xmath312-net of @xmath100 for some @xmath290 .",
    "assume @xmath100 satisfies [ doub - loc ] and [ poin - loc ] . then the following are equivalent :    * @xmath100 satisfies [ poin - inf ] . * @xmath100 satisfies [ poin - mms ] for some @xmath506 . * @xmath100 satisfies [ poin - mms ] for all @xmath506 . * @xmath406 satisfies . * @xmath406 satisfies [ poin - mms ] for some @xmath504",
    ".      a large class of examples for @xmath503 can be obtained from proposition [ p - robustmms ] and [ p - rmtfae ] .",
    "for instance , buser proved [ poin - rm ] for riemannian manifolds with non - negative ricci curvature",
    ". therefore by proposition [ p - rmtfae ] , riemannian manifolds with non - negative ricci curvature satisfy @xmath503 for all positive scales @xmath478 .",
    "the following example is from @xcite .",
    "[ x - grisal][euclidean space with radial weights ] consider @xmath688 with standard riemannian metric @xmath11 , euclidean distance @xmath134 and measure @xmath689 .",
    "it is easy to verify that @xmath690 satisfies [ doub - loc ] and [ poin - loc ] .",
    "moreover @xmath690 satisfies [ doub - inf ] if and only if @xmath92 . if @xmath89 , then @xmath690 satisfies [ poin - inf ] and therefore @xmath503 for all values of @xmath576 and @xmath506 ( see remark 3.13 in @xcite ) .",
    "however , @xmath691 does not satisfy [ poin - inf ] for @xmath692 .",
    "it can be easily seen using the test function @xmath693 . by (",
    "* theorem 7.1(i ) ) , @xmath691 satisfies [ poin - inf ] if @xmath694 .",
    "due to an unpublished result of grigoryan and saloff - coste , @xmath691 satisfies [ poin - inf ] if and only if @xmath695 .    [ x - bl ] we describe an example of quasi - geodesic space which is neither a graph , nor a length space .",
    "consider the ` broken line ' @xmath696 @xmath697\\ ] ] it is quasi-@xmath201-geodesic if and only if @xmath698 .",
    "we equip it with the euclidean distance @xmath134 and restriction of lebesgue measure @xmath102 on @xmath699 .",
    "@xmath503 is not true for @xmath700 if @xmath701 .",
    "it can be seen using the test function @xmath702 defined by @xmath703 .",
    "however , it can be shown that for @xmath700 satisfies @xmath503 for all @xmath704 .",
    "[ x - hyperb ] consider the hyperbolic @xmath705-space @xmath706 with riemannian distance @xmath707 and riemannian measure @xmath102 .",
    "@xmath708 satisfies [ doub - loc ] and [ poin - loc ] .",
    "however @xmath709 does not satisfy [ doub - loc ] because the volume of balls grows exponentially .",
    "further @xmath708 does not satisfy the poincar inequality [ poin - inf ] .",
    "another example in a similar spirit is the infinite @xmath134-regular tree @xmath710 equipped with graph distance metric and counting measure .",
    "it is easy to very that if @xmath711 , @xmath710 does not satisfy [ doub - inf ] and does not satisfy [ poin - mms ] for all @xmath347 .",
    "examples [ x - grisal ] and [ x - hyperb ] illustrates all the four possibilities that can occur with properties [ doub - inf ] and [ poin - inf ] .",
    "it is summarized in the table below .",
    ".examples of spaces in relation to the properties [ doub - inf ] and [ poin - inf ] [ cols=\"<,<,<\",options=\"header \" , ]",
    "in this chapter , we consider markov chains on metric measure space @xmath100 .",
    "let @xmath712 denote the borel @xmath12-algebra on @xmath101 .",
    "our work concerns long term behavior of a natural family of markov chains on the state space @xmath107 .",
    "we will recall some standard definitions and facts about discrete time markov chains .",
    "a _ markov transition function _ is a map @xmath713 such that @xmath714 is @xmath712-measurable function on @xmath107 for all @xmath715 and @xmath716 is a probability measure on @xmath717 for all @xmath61 .",
    "a markov transition function @xmath718 on @xmath717 is @xmath102-_symmetric _ if @xmath719 for all measurable functions @xmath720 .    for the rest of this work ,",
    "we assume that the our markov transition function is @xmath102-symmetric with respect to some measure @xmath102 .",
    "associated with a @xmath102-symmetric markov transition function @xmath718 is a _ markov operator _ @xmath1 , which is a linear operator defined by @xmath721 on the set of bounded measurable functions .",
    "the operator @xmath1 extends as a contraction operator on @xmath722 for all @xmath723 $ ] . with a slight abuse of notation",
    ", we denote this extension again by @xmath724 for each @xmath725",
    ". moreover @xmath1 is positivity preserving , _ i.e. _ if @xmath726 then @xmath727",
    ".    the @xmath705-th iteration @xmath728 of the operator @xmath1 is just the operator associated with kernel @xmath729 defined inductively by @xmath730 for all @xmath61 , for all measurable sets @xmath715 and @xmath731 .",
    "we now have the _ markov semigroup _ of linear operators @xmath732 where @xmath733 is the identity operator on @xmath734 .",
    "the chapman - kolmogorov equation is given by @xmath735 for all @xmath715 and for all @xmath736 . by fubini s theorem ,",
    "implies the semigroup property @xmath737 for all @xmath738 and @xmath739 .",
    "the operator @xmath740 is the _",
    "laplacian _ which generates the _ dirichlet form _ @xmath741 on @xmath734 with full domain @xmath742 .    for every markov transition function @xmath718 on @xmath717",
    "there exists a _",
    "markov chain _",
    "@xmath743 on some path space @xmath744 such that @xmath745 ( one can always choose the canonical path space @xmath746 and @xmath747 for @xmath748 . ) the transition function @xmath729 is then given by @xmath749 and the operator @xmath728 by @xmath750 .",
    "the @xmath102-symmetry of @xmath718 is equivalent to the _ @xmath102-reversibility _ of the markov chain : @xmath751 where @xmath752 is a measure ( not necessarily a probability measure ) defined by @xmath753 .",
    "if @xmath754 for all @xmath61 , we denote its kernel by @xmath755 , that is @xmath756 for all @xmath61 and for all @xmath715 . the kernel @xmath170 is called a _ markov kernel _ with respect to @xmath102 .",
    "the kernel @xmath757 is the radon - nikodym derivative of @xmath758 with respect to @xmath102 , that is @xmath759 for all @xmath61 and all @xmath715 .",
    "the @xmath102-symmetry of @xmath718 implies symmetry of kernel , that is @xmath760 for all @xmath119 almost every @xmath761 . by definition",
    ", we have @xmath762 for all @xmath61 .",
    "however , we assume that @xmath763 for all @xmath61 . under the assumption @xmath764",
    ", we define iteratively @xmath765(y ) = \\int_m p_{k}(x , z ) p_1(y , z ) \\mu(dz)\\ ] ] where @xmath766 and @xmath122 .",
    "the function @xmath138 for @xmath122 is called the _",
    "heat kernel_. we will show some basic properties of heat kernel defined in .",
    "[ l - kernel ] let @xmath100 be a metric measure space and let @xmath718 be a @xmath102-symmetric markov transition function satisfying @xmath767 for all @xmath61 .",
    "let @xmath768 denote the corresponding markov kernel .",
    "assume further that @xmath117 for all @xmath61 .",
    "the the kernel @xmath138 defined in satisfies    1 .",
    "@xmath769 for all @xmath122 .",
    "that is @xmath770 for all @xmath61 , for all @xmath122 and for all @xmath715 .",
    "@xmath771 for all @xmath38 and for all @xmath772 .",
    "@xmath773 for all @xmath38 and for all @xmath774 .    since @xmath775 @xmath102-almost everywhere for all @xmath61 , by induction we have that @xmath776 $ ] for all @xmath38 and for all @xmath772 . therefore by induction on @xmath251 , we have @xmath777 in the first line above we used fubini s theorem and that @xmath778 @xmath779-almost everywhere . since @xmath780 for all @xmath61 and for all @xmath122",
    ", we have @xmath781 for all @xmath122 and for all @xmath38 .    first we show ( b ) by induction .",
    "the result is obvious for @xmath782 .",
    "if @xmath772 , we have @xmath783 in the first line above , we used the induction hypothesis . by the above formula for @xmath784 it is clear that @xmath785 for all @xmath38 .",
    "now we verify ( a ) by induction . for @xmath122",
    ", we have @xmath786 for all @xmath715 . in the first line above , we used induction hypothesis , the second line follows from fubini s theorem , ( b ) and the @xmath779-a.e .",
    "symmetry of @xmath114 .",
    "the last line again follows from ( b ) .    by definition of @xmath138",
    ", we have @xmath787 for all @xmath788 .",
    "therefore ( c ) follows from repeated application of the above equality .    in light of ( iii ) above , we may alternatively define @xmath789 as the radon - nikodym derivative @xmath790 .",
    "however this alternate definition for @xmath791 makes sense only for @xmath102-almost every @xmath21 ( for a fixed value of @xmath13 ) . nevertheless , since @xmath792 and @xmath793 , it is clear that for all @xmath772 , the function @xmath794 defined in is well - defined for all @xmath61 and for all @xmath21 .",
    "hence for @xmath772 , @xmath795 is a genuine function ( as opposed to @xmath796 just being in @xmath315 ) . for @xmath797 ,",
    "@xmath138 is a genuine function on @xmath798 but @xmath799 for all @xmath61 .",
    "many questions concerning the long term behavior of the markov chain can be answered if we know @xmath138 .",
    "therefore estimates on @xmath791 for all @xmath38 and for all @xmath122 is of importance . based on the remarks above on @xmath138 , any bound on @xmath796",
    "must be understood in the @xmath102-almost everywhere sense for @xmath800 and in a point - wise sense for @xmath797 .",
    "the estimates on heat kernel gives both qualitative ( e.g. recurrence / transience , liouville property ) and quantitative ( e.g. estimates on green s function , hlder regularity ) information on the long term behavior of the markov chain . see chapter [ ch - apply ] for applications of gaussian estimates on the heat kernel .",
    "[ x - ballwalk ] let @xmath100 satisfy [ doub - loc ] and let @xmath506 .",
    "consider the natural _ ball walk _ with markov kernel @xmath251 with respect to @xmath102 defined as @xmath801 .",
    "the corresponding markov transition function @xmath802 is not necessarily @xmath102-symmetric because @xmath803 in general .",
    "consider the measure @xmath804 with @xmath805 .",
    "the markov kernel of @xmath802 with respect to @xmath806 is @xmath807 .",
    "hence @xmath802 is @xmath806-symmetric .",
    "such ball walks on compact riemannian manifolds were studied in @xcite .    a markov chain @xmath808 is said to be _ lazy _ if @xmath809 .",
    "[ x - lazy ] consider a metric measure space @xmath100 with a @xmath102-symmetric markov transition function @xmath718 .",
    "define the markov transition function @xmath810 where @xmath811 denotes the dirac measure at @xmath13 .",
    "note that @xmath812 @xmath102-symmetric and corresponds to a lazy markov chain .",
    "assume @xmath718 has a kernel @xmath170 with respect to @xmath102 .",
    "then @xmath812 has a kernel with respect to @xmath102 if and only if @xmath813 for all @xmath61 .",
    "if @xmath1 is the markov operator corresponding to @xmath718 , then @xmath814 is the markov operator corresponding to @xmath812 , where @xmath422 is the identity operator on @xmath815 . hence the corresponding laplacian operators @xmath10 and",
    "@xmath816 are related by @xmath817 .",
    "some basic properties of a symmetric markov kernel are listed without proof in the lemma below .",
    "[ l - mop ] let @xmath718 denote a @xmath102-symmetric markov transition function over a metric measure space @xmath100 and let @xmath1 be the corresponding markov operator .",
    "then @xmath1 is a contraction on all @xmath818 , that is @xmath819 for all @xmath723 $ ] and for all @xmath820 .",
    "a consequence of is the inequality @xmath821 for all @xmath822 .",
    "moreover @xmath1 is self - adjoint on @xmath734 , that is @xmath823 for all @xmath824 where @xmath825 denotes the inner product on @xmath826 .",
    "we list some elementary properties of a symmetric markov kernel below .",
    "[ l - mker ] let @xmath718 denote a @xmath102-symmetric markov transition function over a metric measure space @xmath100 and let @xmath170 be the corresponding markov kernel .",
    "then for all @xmath61 , the function @xmath827 is non - increasing .",
    "moreover we have @xmath828 for all @xmath38 and for all @xmath150 .",
    "note that the first claim follows from by @xmath829 for , we simply use cauchy - schwarz inequality to obtain @xmath830      we introduce the main assumptions on the markov chain in the following definition .",
    "[ d - compat ] for @xmath506 , a markov transition function @xmath718 on @xmath717 is said to be _",
    "@xmath831-compatible _ with @xmath100 if    * @xmath718 is @xmath102-symmetric .",
    "* there exists a kernel @xmath114 such that @xmath832 for all @xmath61 and for all @xmath715 . by ( a )",
    ", we have @xmath135 for all @xmath119-almost every @xmath761 . * there exists reals @xmath833 and @xmath834 such that @xmath835 for all @xmath61 and for @xmath102-almost every @xmath21 .",
    "* there exists @xmath139 such that @xmath836 for all @xmath61 and for @xmath102-almost every @xmath21 , where @xmath837 is defined by .",
    "the corresponding markov kernel @xmath114 is said to be _",
    "@xmath831-compatible _ with @xmath100 .",
    "if a markov transition function @xmath718 satisfies ( a),(b),(c ) above we say that @xmath718 ( respectively @xmath114 ) is _ weakly @xmath831-compatible _ with @xmath100 .",
    "similarly , we say the corresponding markov operator @xmath1 is ( weakly ) @xmath831-compatible with @xmath100 if the markov transition function @xmath718 is ( weakly ) @xmath831-compatible with @xmath100 .",
    "* let @xmath100 satisfy [ doub - loc ] and @xmath838 .",
    "if a markov kernel @xmath114 is @xmath839-compatible with @xmath100 then @xmath114 is @xmath840-compatible with @xmath100 .",
    "* the condition ( d ) in definition [ d - compat ] may seem unnatural , but is important for certain technical reasons .",
    "the proofs on caccioppoli inequality ( lemma [ l - caccio ] ) and discrete time integrated maximum principle ( proposition [ p - imp ] ) and relies crucially on laziness of walks .",
    "condition ( d ) enables us to compare the behavior of a given random walk with its lazy version as presented in example [ x - lazy ] .",
    "* there are several examples for which ( d ) is satisfied .",
    "for instance , a markov kernel on weighted graphs satisfying [ doub - loc ] is weakly @xmath831-compatible if and only if it is @xmath831-compatible .",
    "consider a markov kernel @xmath170 weakly @xmath841-compatible with a length space @xmath100 satisfying [ doub - loc ] , then @xmath170 is @xmath841 compatible .",
    "* lemmas [ l - wscompat ] and [ l - gausscompare ] show that the assumption ( d ) is not restrictive for obtaining gaussian estimates . *",
    "the condition is an analog of the uniform ellipticity condition .",
    "we record some important consequences of condition ( d ) in definition [ d - compat ] .",
    "[ l - con - d ] let @xmath100 be a metric measure space and let @xmath1 be markov operator that is @xmath831-compatible with @xmath100 .",
    "then the corresponding kernel @xmath138 satisfies @xmath842 for all @xmath38 and for all @xmath772 where @xmath843 is same as in .",
    "moreover the operator @xmath844 is positivity preserving , that is if @xmath845 satisfies @xmath726 , then @xmath846 .    since @xmath847 is a markov operator , by and lemma [ l - kernel](c ) we have @xmath848(y )    \\ge 0\\ ] ] for all @xmath122 and for all @xmath38 .",
    "this proves .    by and @xmath726 , we have @xmath849 for all @xmath61 .",
    "the following lemma shows that a large enough convolution power of a weakly compatible kernel is compatible under some mild conditions .",
    "[ l - wscompat ] let @xmath100 be a quasi-@xmath201-geodesic space satisfying [ doub - loc ] and let @xmath114 be a markov kernel weakly @xmath831-compatible with @xmath100 for some @xmath850 .",
    "then there exists @xmath617 for which @xmath390 is @xmath851-compatible with @xmath100 for all @xmath852 such that @xmath853 .    properties ( a ) and ( b ) of definition [ d - compat ] follows directly from the weak compatibility of @xmath114 .",
    "it only remains to check properties ( c ) and ( d ) .",
    "assume that @xmath114 satisfies .",
    "let @xmath38 with @xmath854 .",
    "by lemma [ l - chain ] , there exists even number @xmath617 such that for all @xmath855 , there exists a @xmath201-chain @xmath856 with @xmath857 , @xmath858 .",
    "define @xmath859 . by chapman - kolmogorov equation",
    "@xmath860 the third line above follows weakly @xmath831-compatible condition and the fourth line follows from lemma [ l - vloc ] . combining with the fact that @xmath170 is weakly @xmath831-compatible along with lemma [ l - vloc ] gives the following lower bound : for all @xmath853 and @xmath852 , there exists @xmath861 such that @xmath862 for all @xmath38 .",
    "hence by and we get @xmath863 for some @xmath864 . since @xmath1 is positivity preserving , we have @xmath865 which is condition ( d ) of definition [ d - compat ] .",
    "note that implies that @xmath390 satisfies the lower bound in condition ( c ) of definition [ d - compat ] .",
    "now we turn to the corresponding upper bound for @xmath390 . since @xmath1 is a contraction on @xmath866 , there exists @xmath466 such that @xmath867 for all @xmath38 and all @xmath868 . by triangle inequality",
    "@xmath869 if @xmath870 for all @xmath868 and for all @xmath38 .",
    "hence by lemma [ l - vloc ] we have the desired conclusion .",
    "we now justify the condition @xmath508 in the above lemma .",
    "it is to avoid pathological examples of the following kind : consider a ball walk of example [ x - ballwalk ] with @xmath701 on broken line space @xmath700 from example [ x - bl ] .",
    "it is easy to check that such a random walk never leaves a connected component .",
    "similarly , the ball walk of example [ x - ballwalk ] with @xmath871 on a graph always stays at one point .      the main property of a markov kernel that we are interested in are gaussian estimates for its iterated kernel @xmath872 .",
    "[ d - ge ] a @xmath102-symmetric markov kernel @xmath170 on @xmath100 is said to satisfy gaussian upper bound [ gue ] if there exists @xmath149 such that @xmath873 for all @xmath38 and for all @xmath150 satisfying @xmath89 .",
    "similarly , a @xmath102-symmetric markov kernel @xmath170 on a metric measure space @xmath100 is said to satisfy gaussian lower bound [ gle ] if there exists @xmath152 such that @xmath874 for all @xmath38 satisfying @xmath153 and for all @xmath150 satisfying @xmath89 .",
    "a @xmath102-symmetric markov kernel @xmath170 on a metric measure space @xmath100 is said to satisfy two sided gaussian bound if it satisfies [ gue ] and [ gle ] .",
    "the condition @xmath875 in [ gle ] is needed because @xmath876 vanishes for compatible kernels if @xmath877 for some constant @xmath878 . in many situations , the above gaussian estimates are equivalent to the following ( a priori weaker ) estimates which are easier to prove .",
    "we require the estimates in definition [ d - ge ] to hold only for large enough @xmath705 in the definition below .",
    "[ d - ge - inf ] a @xmath102-symmetric markov kernel @xmath170 on @xmath100 is said to satisfy gaussian upper bound [ gue - inf ] if there exists @xmath879 such that @xmath880 for all @xmath38 and for all @xmath150 such that @xmath881 .",
    "the conditions and are defined analogously .    under mild conditions ,",
    "we show that implies .",
    "[ l - gaussinf ] let @xmath100 be a quasi-@xmath201-geodesic space satisfying [ doub - loc ] and let @xmath114 be a markov kernel weakly @xmath831-compatible with @xmath100 for some @xmath850 .",
    "the following hold :    * if @xmath114 satisfies [ gue - inf ] , then @xmath114 satisfies [ gue ] . *",
    "if @xmath114 satisfies , then @xmath114 satisfies [ gle ] . *",
    "if @xmath114 satisfies , then @xmath114 satisfies .    note that @xmath114 satisfies .    * the gaussian upper estimate for @xmath872 where @xmath881 follows from [ gue - inf ] .",
    "if @xmath882 , we simply use that @xmath1 is a contraction in @xmath866 along with to obtain @xmath883 for all @xmath38 and for all @xmath882 .",
    "the first line above follows from triangle inequality , @xmath884 and .",
    "the second line follows from lemma [ l - vloc ] . * the gaussian lower bounds for @xmath872 where @xmath881 follows from @xmath885 .",
    "let @xmath886 .",
    "using ideas similar to the proof of lemma [ l - wscompat ] ( see ) , there exists @xmath887 such that @xmath888 for all @xmath882 and for all @xmath38 such that @xmath889 . *",
    "it is a direct consequence of ( a ) and ( b ) .",
    "[ l - gausscompare ] let @xmath100 be a quasi-@xmath201-geodesic space satisfying [ doub - loc ] and let @xmath170 be a markov kernel weakly @xmath831-compatible with @xmath100 for some @xmath850 .",
    "for some @xmath617 , if @xmath138 satisfies @xmath890 then @xmath170 satisfies @xmath891 .    by lemma [ l - gaussinf ]",
    "it suffices to show that @xmath170 satisfies @xmath892 and @xmath885 .",
    "suppose @xmath893 satisfies . for @xmath894 , there exists @xmath895 such that @xmath896 for all @xmath38 and for all @xmath897 with @xmath894 .",
    "this follows from chapman - kolmogorov equation along with the fact that the support of @xmath898 is contained in @xmath899 for all @xmath900 .",
    "since @xmath138 satisfies @xmath892 , there exists @xmath149 and @xmath901 such that @xmath902 for all @xmath38 and for all @xmath868 satisfying @xmath903 . by , and , there exists @xmath904 and @xmath905 such that @xmath906 for all @xmath38 and for all @xmath897 satisfying @xmath907 . for every @xmath908 , we have @xmath909 by and , we have that @xmath170 satisfies @xmath892 .",
    "it remains to show that @xmath170 satisfies @xmath885 .",
    "the proof is similar to above . as in",
    ", we have the complementary inequality , @xmath910 for all @xmath38 and for all @xmath897 with @xmath894 .",
    "since @xmath138 satisfies @xmath885 , there exists @xmath911 such that @xmath912 for all @xmath38 and for all @xmath868 satisfying @xmath913 and @xmath914 . by ,",
    ", there exists @xmath915 and @xmath916 such that @xmath917 for all @xmath38 and for all @xmath897 satisfying @xmath918 and @xmath919 . by interchanging @xmath184 and @xmath920 in along with yields @xmath885 for the kernel @xmath170 .",
    "we describe two examples that does not fall under the framework given by definition [ d - compat ] but nevertheless the methods developed in this work still applies .",
    "[ x - annulus ]    we consider a measured , complete , _ length _",
    "space @xmath100 satisfying @xmath921 and [ doub - loc ] .",
    "let @xmath1 be a @xmath102-symmetric markov operator whose kernel @xmath922 satisfies the following estimate : there exists @xmath466 and @xmath923 such that @xmath924 for all @xmath61 and for @xmath102-almost every @xmath21 .    in this case",
    ", it is easy to verify that the density @xmath837 is weakly @xmath925-compatible with @xmath100 .",
    "note that for all @xmath61 , there exists @xmath281 such that @xmath926 .",
    "note that by lemma [ l - vloc ] and , there exists @xmath927 such that for all @xmath38 with @xmath928 @xmath929 and for all @xmath38 with @xmath930 we have @xmath931 therefore @xmath837 is weakly @xmath925 compatible with @xmath100 .",
    "for example , it is clear that the application to liouville property will not be affected if we replace the operator @xmath1 by @xmath932 .",
    "if the underlying space satisfies volume doubling and poincar inequality we can use our main results to obtain gaussian estimates provided @xmath100 satisfies [ doub - inf ] and [ poin - mms ] . to prove the above statement ,",
    "we simply note by theorem [ t - main0 ] , lemma [ l - wscompat ] and lemma [ l - gausscompare ] that @xmath837 satisfies and by a similar argument @xmath933 satifies .",
    "[ x - twoballs ] we describe another example similar to example [ x - annulus ] .",
    "consider @xmath3 equipped with euclidean distance @xmath134 and lebesgue measure @xmath102 .",
    "let @xmath934 denote an arbitrary unit vector in @xmath3 .",
    "consider the @xmath102-symmetric random walk with the kernel @xmath935 although @xmath170 is not compatible with @xmath936 , similar to example [ x - annulus ] one can check that @xmath936 satisfies that @xmath837 and @xmath933 are @xmath937-compatible with @xmath936 and that the kernel @xmath138 satisfies .",
    "let @xmath100 be a metric measure space with a @xmath102-symmetric markov operator @xmath1 and corresponding kernel @xmath170 .",
    "recall that we defined the dirichlet form @xmath938 for @xmath939 .",
    "we define another dirichlet form @xmath940 which is the dirichlet form corresponding to the markov operator @xmath932 , that is @xmath941 for all @xmath942 .",
    "functional inequalities involving the dirichlet form ( for instance nash , sobolev , log sobolev , poincar inequalities ) can be transferred to an inequality concerning the markov semigroup , which in turn sheds light on asymptotic behavior of markov chains . for a continuous time markov semigroup @xmath943 a crucial identity to carry out",
    "this is @xmath944 ( for instance ( * ? ? ?",
    "* theorems 4.2.5 and 6.3.1 ) ) by the above definition , we have a similar identity for discrete time markov semigroup : @xmath945 for all @xmath946 .",
    "this is the main reason why we sometimes prefer @xmath947 instead of @xmath948 .",
    "the above remark motivates us to compare the dirichlet forms @xmath949 and @xmath940 .",
    "[ l - comp - dir ] consider a @xmath102-symmetric markov chain on @xmath100 with markov operator @xmath1 and dirichlet forms @xmath949 and @xmath940 defined as above .",
    "we have the following :    * @xmath950 for all @xmath946 . *",
    "assume further that @xmath1 has a strongly @xmath831-compatible kernel @xmath170 with respect to @xmath100 .",
    "then there exists a constant @xmath951 such that @xmath952 for all @xmath946 .    * note that @xmath953 hence @xmath954 * the conclusion follows from property ( d ) of definition [ d - compat ] by observing that @xmath955    the inequality @xmath952 is not true in general . consider nearest neighbor ( simple ) random walk on a finite bipartite graph .",
    "let @xmath177 be a function on the graph that assigns + 1 to one partition and -1 to other .",
    "it is easy to check that @xmath956 and therefore @xmath957 fails .      to obtain lower bounds on the heat kernel , we consider the corresponding markov process killed on exiting a ball @xmath325 ( see chapter [ ch - glb ] ) . moreover functional inequalities like nash and sobolev inequalities that we will encounter are local to balls .",
    "motivated by these considerations , we introduce markov chains killed on exiting a ball and their corresponding markov operator and kernel .",
    "let @xmath106 be a markov chain on @xmath100 driven by a @xmath102-symmetric markov operator @xmath1 with kernel @xmath114 with respect to @xmath102 .",
    "the corresponding markov chain @xmath958 that is killed on exiting a ball @xmath325 has state space @xmath959 where @xmath960 is the absorbing _ cemetery state_. the markov chain @xmath958 killed on exiting @xmath325 is defined as @xmath961 where @xmath962 is the _ lifetime _ of the process defined by @xmath963 for the killed markov chain , we consider functions @xmath964 with the ` dirichlet ' boundary condition @xmath965 .",
    "therefore , we can define corresponding quantities like markov kernel and markov operator just by restriction to @xmath325 .",
    "define the _ restricted kernel _",
    "@xmath966 , as a restriction of @xmath114 on @xmath967 .",
    "we endow @xmath325 with the measure @xmath968 which is the restriction of @xmath102 to all borel subsets of @xmath325 .",
    "we denote by @xmath969 .",
    "we define the markov operator @xmath970 with kernel @xmath971 with respect to @xmath968 as @xmath972 define the corresponding dirichlet forms @xmath973 for all @xmath974 .",
    "similar to , we define the kernel @xmath975 iteratively as @xmath976(y ) = \\int_b p^b_k(x , z ) p^b_1(y , z ) \\ , \\mu(dz)\\ ] ] for all @xmath122 and for all @xmath977 .",
    "it is easy to check that the proof of lemma [ l - kernel ] ( b),(c ) applies to the kernel @xmath971 . as before ,",
    "the function @xmath978 is well - defined for all @xmath772 .",
    "further @xmath979 for all @xmath61 .",
    "it is easy to see that @xmath980 for all @xmath38 and for all @xmath772 .",
    "the operator @xmath970 is positivity preserving , that is @xmath726 implies @xmath981 .",
    "however unlike @xmath1 , the operator @xmath970 is not necessarily conservative , that is @xmath982 in general .",
    "analogous to , we have that @xmath970 is a contraction on all @xmath983 for all @xmath984 .",
    "we also define the corresponding ` dirichlet laplacian ' @xmath985 .",
    "we will compare dirichlet forms on balls with dirichlet forms on @xmath107 below .",
    "[ l - dircomp - ball ] let @xmath974 and let @xmath986 denote an extension of @xmath177 defined by @xmath987 then    * @xmath988 .",
    "* @xmath989 .    for ( a ) ,",
    "observe that @xmath990 for ( b ) , we have @xmath991    we warn the reader of the following abuse of notation",
    ". we may consider a function @xmath974 as a function in @xmath734 using the extension given by .",
    "alternatively we may consider a function @xmath946 as a function in @xmath992 by the restriction @xmath993 .",
    "j. moser proved parabolic harnack inequalities for second - order uniformly elliptic divergence form operators in @xmath994 @xcite .",
    "this approach was successfully adapted by numerous authors .",
    "the previous versions of theorem [ t - main0 ] as given in @xcite used moser s iterative method as a crucial ingredient .",
    "along with poincar inequality and volume doubling , moser s iteration relies on repeated applications of a sobolev inequality .",
    "we recall the difficulty arising due to sobolev inequalities mentioned in the introduction .",
    "the sobolev inequalities in the previous works @xcite are of the form @xmath995 for all ` nice ' functions @xmath177 supported in @xmath40 .",
    "however along with implies that @xmath179 for all balls @xmath40 which can happen only if the space is discrete .",
    "hence for discrete time markov chains on continuous spaces the sobolev inequality fails to hold . in this chapter",
    ", we prove a weaker form of the above sobolev inequality ( see ) and study its properties . in the next two sections",
    ", we will use the sobolev inequality to run the moser s iterative method and obtain elliptic harnack inequality and gaussian upper bounds .",
    "we adapt the approach of @xcite to obtain a sobolev inequality using [ doub - inf ] and [ poin - inf ] .",
    "the main result of this chapter is the following sobolev inequality .",
    "[ t - sob ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] and poincar inequality at scale @xmath478 [ poin - mms ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 .",
    "let @xmath970 and @xmath996 denote the corresponding markov operator and dirichlet form restricted to a ball @xmath997 .",
    "then there exists @xmath998 and @xmath999 such that for all @xmath63 , for all @xmath61 , and for all @xmath974 , we have @xmath1000 where @xmath77 .    since @xmath970 is a contraction , note that implies .",
    "since we rely on the weaker sobolev inequality , our methods give an unified approach to gaussian bounds for graphs and continuous spaces .",
    "however we will encounter new difficulties due to .",
    "let @xmath1001 and @xmath1002 .",
    "we define @xmath1003 as @xmath1004      as in ( * ? ? ?",
    "* lemma 2.4 ) , we need a pseudo - poincar inequality .    [ l - pp ] under the hypotheses of theorem [ t - sob ] , there exists @xmath1005 and @xmath1006 such that @xmath1007 for all @xmath946 and for all @xmath1008 .",
    "let @xmath456 be a @xmath1009-net of @xmath100 as given in definition [ d - net ] . by proposition [ p - net](a ) ,",
    "the collection of balls @xmath1010 cover @xmath107 .",
    "therefore @xmath1011 for the first term , we use [ poin - mms ] , to obtain @xmath1012 such that @xmath1013 for all @xmath1008 and for all @xmath946 .",
    "for the second term in , we use jensen s inequality to obtain @xmath1014 for all @xmath946 and for all @xmath1015 . by",
    ", there exists @xmath1016 such that @xmath1017 for all @xmath1008 and for all @xmath1015 . by , , and , there exists @xmath1018 such that @xmath1019 for all @xmath946 .",
    "the last inequality in follows from proposition [ p - net](h ) , along with .",
    "the following lemma is a consequence of doubling hypothesis .",
    "[ l - nd ] let @xmath100 be a measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "then for all @xmath200 , there exists @xmath1020 , @xmath1021 such that @xmath1022    for all @xmath739 is supported in @xmath77 and for all @xmath265    by hlder inequality , we have @xmath1023 since @xmath177 is supported in @xmath40 and @xmath1024 we have @xmath1025 by , there exists @xmath551 and @xmath1026 such that @xmath1027 for all @xmath265 and for all @xmath1028 supported in @xmath40",
    ".    further there exists @xmath1029 such that @xmath1030 for all @xmath265 and for all @xmath1028 supported in @xmath40 .",
    "the second line follows from fubini s theorem and above follows from .",
    "the desired conclusion follows from , and .",
    "next , we show a nash inequality using the pseudo - poincar inequality and doubling hypotheses by adapting the approach of ( * ? ?",
    "* theorem 2.1 ) .",
    "[ p - nash ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] and poincar inequality at scale @xmath478 [ poin - mms ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 .",
    "let @xmath948 denote the dirichlet form corresponding to @xmath1 .",
    "then there exists @xmath998 , @xmath1031 such that @xmath1032 for all @xmath70 , for all @xmath61 , and for all @xmath946 with @xmath177 supported in @xmath40 .",
    "we start with an observation that follows directly for small values of @xmath14 .",
    "let @xmath1033 be an arbitrary constant .",
    "if @xmath1034 , by and , there exists @xmath149 such that for all functions @xmath739 supported in @xmath40 , we have @xmath1035 by hlder inequality along with and , we have @xmath1016 such that @xmath1036 for all function @xmath946 supported in @xmath40 with @xmath1037 . by and and by the choice @xmath1038",
    ", it suffices to show for the case @xmath1039 .",
    "note that @xmath1040 we use pseudo - poincar inequality ( lemma [ l - pp ] ) to bound the first term and use the @xmath831-compatibility of @xmath1 along with doubling hypotheses to bound the second term . to obtain ,",
    "we minimize the bound on right hand side of by varying @xmath284 .    by lemma [ e - pp ]",
    ", there exists @xmath1041 and @xmath684 such that @xmath1042 for all @xmath946 and for all @xmath1043 .    by and",
    ", there exists @xmath1044 and @xmath1021 such that @xmath1045 for all @xmath946 supported in @xmath40 and for all @xmath1046 . combining , , ,",
    "we obtain @xmath1047 for all @xmath946 supported in @xmath40 and for all @xmath1043 and for all @xmath241 . in order to minimize the right side of",
    ", the choice of @xmath284 ( up to a constant factor ) is @xmath1048 however , we want to choose @xmath1043 in . we will do that by showing that @xmath1049 is bounded below . for all @xmath241 ,",
    "by we have @xmath1050 for all @xmath946 .",
    "since @xmath177 is supported in @xmath40 , there exists @xmath1051 @xmath1052 for all @xmath1053 supported in @xmath40 with @xmath241 .",
    "the first line above follows from and the second line follows from and @xmath241 . by and",
    ", there exists @xmath1054 such that @xmath1055 for all @xmath61 , for all @xmath241 and for all @xmath946 supported in @xmath40 . by plugging in @xmath1056 in",
    ", there exists @xmath1038 such that @xmath1057 for all @xmath61 , for all @xmath241 and for all @xmath946 supported in @xmath40 . by",
    ", we have @xmath1058 for all @xmath946 . by , and , we obtain the desired nash inequality .    before we proceed , we restate the above nash inequality for functions defined on balls .    [ c - nash ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] and poincar inequality at scale @xmath478 [ poin - mms ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 .",
    "let @xmath970 and @xmath996 denote the corresponding markov operator and dirichlet form restricted to a ball @xmath997 .",
    "then there exists @xmath998 , @xmath1031 such that @xmath1059 for all @xmath70 , for all @xmath61 , and for all @xmath946 with @xmath177 supported in @xmath40 .",
    "we define @xmath1060 as in . since @xmath1061 on @xmath325",
    ", we have @xmath1062 . combining this observation along with @xmath1063 , lemma [ l - dircomp - ball](a ) and proposition yields .",
    "it is easy to prove nash inequality using sobolev inequality just by an application of hlder inequality @xmath1064 along with the fact that @xmath970 is a contraction on @xmath1065 .",
    "however proving using is harder .",
    "there is a direct and elementary approach using slicing of functions developed in @xcite .",
    "their approach was used by delmotte in the setting of graphs ( * ? ? ?",
    "* theorem 4.4 ) to prove a sobolev inequality .",
    "however those slicing techniques not so seem to apply directly for proving , since the ( sub - markov ) operator @xmath970 does not commute with the slicing maps @xmath1066 .",
    "it is an interesting open problem to make this approach work for our sobolev - type inequalities .      in light of the above remark",
    ", we adapt a different approach based on hardy - littlewood - sobolev theory for discrete time markov semigroups as developed in ( * ? ? ?",
    "* theorems 5 and 6 ) .",
    "our approach is to obtain an upper bound for @xmath1067 using which in turn is used to prove the sobolev inequality .    [ l - ultb ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 .",
    "let @xmath970 and @xmath996 denote the corresponding markov operator and dirichlet form restricted to a ball @xmath997 .",
    "further assume that the operators @xmath970 satisfy the nash inequality with constant @xmath1021 .",
    "there exists @xmath1068 such that @xmath1069 for all @xmath61 , for all @xmath70 and for all @xmath122 where @xmath77 .",
    "if two side gaussian estimate @xmath891 holds for @xmath138 and if we choose @xmath1070 , then the upper bound is sharp up to a constant factor .",
    "let @xmath61 , @xmath70 and @xmath77 .",
    "our first step is an upper bound for @xmath1071 .",
    "let @xmath1072 be an arbitrary function with @xmath1073 .",
    "the constants in this proof do not depend on the choice of @xmath61 , @xmath122 , @xmath63 or @xmath1072 .",
    "then by hlder inequality , @xmath1074 by and , there exists @xmath466 such that @xmath1075 by , along with lemma [ l - dircomp - ball ] and lemma [ l - comp - dir](b ) , there exists @xmath1031 such that @xmath1076 for all @xmath70 , for all @xmath61 , and for all @xmath1077 where @xmath77 .",
    "define @xmath1078 for all @xmath122 .",
    "substituting @xmath1079 in and using the fact that @xmath1080 and @xmath1081 , we obtain the following difference inequality for @xmath1082 : @xmath1083 for all @xmath122 .",
    "next , we ` solve ' the difference inequality given by .",
    "define @xmath1084 we claim that @xmath1085 for all @xmath122 .",
    "we prove by induction .",
    "the base case @xmath1086 follows from and . for the inductive step ,",
    "assume that holds for all @xmath1087 for some @xmath897 .",
    "we will show that holds for @xmath1088 .",
    "assume to the contrary that @xmath1089 by , and the induction hypothesis , we obtain @xmath1090 the second line above follows from intermediate value theorem , the third line follows from @xmath1091 and the last line follows from .",
    "the desired contradiction follows from and .",
    "using , we obtain the estimate @xmath1092 for all @xmath61 and all @xmath63 where @xmath77 . since @xmath970 is self - adjoint operator in @xmath992 , by duality we have the bound @xmath1093 using the above bound along with yields for @xmath772 . the case",
    "@xmath1086 follows from .",
    "we are ready to prove the sobolev inequality using the ultracontractivity estimate above .    for an operator @xmath1094",
    ", we define the operator @xmath1095 as @xmath1096 where @xmath1097 is defined by the taylor series @xmath1098 for @xmath1099 . by a classical estimate on coefficient of taylor series , there exists @xmath1100 such that @xmath1101 for all @xmath1102 .",
    "we use the ultracontractivity estimate to obtain sobolev inequality .",
    "the proof uses riesz - thorin and marcinkiewicz interpolation theorems which we briefly review in appendix [ a - int ] .",
    "[ p - ult2sob ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 .",
    "let @xmath970 and @xmath996 denote the corresponding markov operator and dirichlet form restricted to a ball @xmath997 .",
    "assume that there exists @xmath1068 such that @xmath1103 for all @xmath61 , for all @xmath70 and for all @xmath122 where @xmath77 .",
    "then we have the sobolev inequality .    as in the proof of nash inequality , we start by considering the case @xmath1104 . by",
    ", there exists @xmath1029 such that @xmath1105 for all balls @xmath77 with @xmath1104 . since @xmath970 is a contraction on all @xmath983 ,",
    "we have @xmath1106 applying riesz - thorin interpolation between and yields @xmath1107 for all balls @xmath77 with @xmath1104 . by choosing @xmath1108",
    ", we have for all balls @xmath40 with @xmath1104 .",
    "next we consider the case @xmath156 . since @xmath1109 it suffices to show that there exists @xmath1029 such that @xmath1110 for all balls @xmath77 with @xmath1111 .",
    "to see this , note that @xmath1112 satisfies .",
    "define @xmath1113 let @xmath1114 and @xmath1115 satisfy @xmath1116 for all @xmath1114 and @xmath1115 satisfying , we show that the operator @xmath1117 is of weak - type @xmath1118 .",
    "an application of marcinkiewicz interpolation then yields .",
    "recall that @xmath1119 . for @xmath1120 , we define operators @xmath1121 by and riesz - thorin interpolation , we obtain @xmath1122 for all balls @xmath325 , for all @xmath122 and for all @xmath1123 . for each @xmath1124",
    ", there exists @xmath1016 such that @xmath1125 for all balls @xmath325 , where @xmath383 is given by . in @xmath1126",
    "depends only on @xmath1127 but not on @xmath77 . in the second line above we use and",
    "and we used and @xmath1114 in the last line . by the same argument as above and increasing @xmath1128 if necessary",
    ", we may assume that @xmath1129 for all balls @xmath325 .",
    "let @xmath1130 satisfy @xmath1131 . for @xmath1132 ,",
    "let @xmath1133 denote the smallest positive integer such that @xmath1134 . by union bound , for each @xmath1124 and @xmath383 given by",
    ", there exists @xmath1135 such that @xmath1136 for all balls @xmath77 . in the second step above we used the definition of @xmath1137 .",
    "the third step follows from chebyshev inequality , the fourth step follows from and @xmath1138 .",
    "the last step follows from , , and the definition of @xmath1137 . by marcinkiewicz interpolation theorem and the estimates given by",
    ", there exists @xmath1139 such that @xmath1140 for all balls @xmath77 .",
    "this is precisely which we intended to prove .",
    "we record two important consequences of proposition [ p - ult2sob ] first of which is the proof of theorem [ t - sob ]    theorem [ t - sob ] follows from corollary [ c - nash ] , lemma [ l - ultb ] and proposition [ p - ult2sob ] .",
    "the next corollary shows that sobolev inequality is necessarily true under doubling hypothesis and gaussian upper bounds [ gue ] .",
    "[ c - nsob ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831 compatible with respect to @xmath102 .",
    "further assume that iterated kernel @xmath138 that satisfies [ gue ] .",
    "let @xmath970 and @xmath996 denote the corresponding markov operator and dirichlet form restricted to a ball @xmath997 .",
    "then the sobolev inequality holds .    by proposition [ p - ult2sob ]",
    "it suffices to show the ultracontractivity estimate on @xmath1141 . by [ gue ]",
    ", there exists @xmath466 such that @xmath1142 for all balls @xmath77 and for all @xmath122 .",
    "by , there exists @xmath1021 and @xmath1029 such that @xmath1143 for all balls @xmath40 and for all @xmath122 .",
    "the desired estimate follows from and .",
    "next , we show that sobolev inequality implies [ doub - inf ] under natural hypotheses .",
    "more precisely    [ p - sobvd ] let @xmath100 be a metric measure space satisfying [ doub - loc ] .",
    "let @xmath1 be @xmath831 compatible markov operator in a metric measure space @xmath100 satisfying sobolev inequality .",
    "then @xmath100 satisfies the large scale doubling property [ doub - inf ] .",
    "we need the following volume comparison lemma .",
    "[ l - vc ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and let @xmath1144",
    ". then there exists @xmath1145 such that @xmath1146 for all @xmath61 and for all @xmath1147 .",
    "let @xmath340 be a maximal @xmath497-separated subset of @xmath40 where @xmath61 and @xmath1147 .",
    "the collection of balls @xmath1148 are disjoint and hence @xmath1149 however since @xmath1150 and @xmath1147 , we have @xmath1151    by quasi-@xmath201-geodesicity and @xmath1152 , there exists @xmath466 such that for all @xmath1153 , there exists a @xmath201-chain @xmath222 @xmath201-chain from @xmath13 to @xmath920 such that @xmath1154 combining and , we obtain @xmath1155 combining , lemma [ l - vloc ] and , we obtain @xmath1156    .",
    "we adapt the argument of ( * ? ? ?",
    "* proposition 2.1 ) .",
    "however unlike in ( * ? ? ?",
    "* proposition 2.1 ) , we do not consider volumes of arbitrarily small balls .",
    "let @xmath61 and @xmath1147 be arbitrary . for @xmath1157 , define the ` tent function ' @xmath1158 by @xmath831 compatibility of @xmath1 , we have @xmath1159 . therefore by applying , we have @xmath1160 for all @xmath1147 and for all @xmath61 . combined with lemma [ l - vloc ] ,",
    "there exists @xmath466 such that @xmath1161 for all @xmath1147 and for all @xmath61 .",
    "let @xmath1162 . then by @xmath831 compatibility of @xmath1",
    ", we have @xmath1163 . hence by sobolev inequality , and lemma [ l - dircomp - ball](a )",
    ", we obtain @xmath1164    combined with lemma [ l - vc ] , there exists @xmath1029 such that @xmath1165 for all @xmath61 and for all @xmath1162 .",
    "we replace @xmath284 by @xmath1166 in and iterate to obtain @xmath1167 for all @xmath1168 . in particular",
    "if we choose @xmath1169 , we have @xmath1170 . hence by and",
    ", we have @xmath1171 for all @xmath61 and for all @xmath1162 , where @xmath1169 . by",
    ", there exists @xmath1016 such that @xmath1172 for all @xmath61 and for all @xmath1162 , where @xmath1169 . since the map @xmath1173 is bounded in @xmath1174 , by there exists @xmath1044 such that @xmath1175 for all @xmath61 and for all @xmath1162 .",
    "the above equation clearly implies [ doub - inf ] .",
    "in this chapter , we prove elliptic harnack inequality for non - negative harmonic functions . as before , we consider a metric measure space @xmath100 and a markov operator @xmath1 that is @xmath831-compatible with @xmath100 . recall that the operator @xmath1176 is the laplacian corresponding to @xmath1 .",
    "[ d - harmonic ] let @xmath1 be a markov operator on @xmath100 .",
    "a function @xmath1177 is @xmath1-harmonic in @xmath40 if @xmath1178 for all @xmath266 .",
    "similarly , we say @xmath1179 is @xmath1-subharmonic ( resp .",
    "@xmath1-superharmonic ) in @xmath40 if @xmath1180 for all @xmath266 .",
    "we say a function @xmath845 is @xmath1-harmonic ( resp .",
    "subharmonic , superharmonic ) if @xmath1181 ( resp .",
    "@xmath1182 , @xmath1183 ) .",
    "[ r - harmonic ]    a.   consider a markov operator @xmath1 that is @xmath831-compatible with @xmath100 . by",
    ", @xmath1184 depends only on @xmath177 in @xmath1185 .",
    "therefore the property that @xmath845 is @xmath1-harmonic in @xmath40 depends only on the values of @xmath177 in @xmath1186 .",
    "hence in this case it suffices to have @xmath1187 .",
    "b.   we use the term harmonic instead of @xmath1-harmonic if the markov operator @xmath1 is clear from the context .",
    "same holds for superharmonic or subharmonic functions .",
    "the main result of the chapter is the following elliptic harnack inequality .",
    "[ t - ehi ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] and poincar inequality at scale @xmath478 [ poin - mms ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 for some @xmath850 .",
    "then there exists @xmath1188 such that for all @xmath61 , for all @xmath241 and for all non - negative functions @xmath1189 that are @xmath1-harmonic in @xmath40 the following harnack inequality holds : @xmath1190    in , the sup and inf must be understood as essential sup and essential inf with respect to @xmath102 .",
    "we follow moser s iteration method @xcite to prove the elliptic harnack inequality .",
    "our approach is an adaptation of delmotte s approach except that we have to rely on a weaker version of sobolev inequality and a modified version of john - nirenberg inequality .",
    "moser s iteration relies on estimating the quantities @xmath1191 for different balls @xmath1192 and for different values of @xmath1193 . by jensen s inequality",
    ", @xmath1194 is non - decreasing function .",
    "the function @xmath1195 satisfies @xmath1196 and @xmath1197 ( * ? ? ?",
    "* lemma 14.1.4 ) . to obtain",
    ", moser s iterative method relies on establishing bounds of the form @xmath1198 for different values of @xmath1199 satisfying @xmath1200 .",
    "sobolev inequality and poincar inequality are crucial ingredients to run this iterative procedure . for a function",
    "@xmath177 that is defined on a ball @xmath325 , we denote the mean integral by @xmath1201    we start with a local version of the above elliptic harnack inequality .",
    "[ l - compharm ]",
    "let @xmath100 be a quasi-@xmath201-geodesic space satisfying [ doub - loc ] and let @xmath1 be a weakly @xmath831-compatible markov operator with @xmath100 for some @xmath507 .",
    "there exists @xmath951 and @xmath684 such that @xmath1202 for all @xmath61 , for all @xmath241 , for all @xmath1203 satisfying @xmath1204 and for all non - negative functions @xmath1205 harmonic in @xmath40 .",
    "there exists @xmath1054 and @xmath852 such that @xmath1206 for all @xmath1207 .",
    "the proof of is analogous to that of .",
    "therefore by , [ doub - loc ] weak @xmath831-compatibility of @xmath114 and triangle inequality , there exists @xmath1208 such that @xmath1209 for all @xmath1210 satisfying @xmath1204 .",
    "choose @xmath509 large enough so that @xmath1211 for all @xmath241 .",
    "note that for every harmonic function @xmath1205 in @xmath40 with @xmath241 and for all @xmath1212 , we have @xmath1213 by and , we obtain @xmath1214 for all non - negative harmonic functions @xmath31 in @xmath40 for all @xmath61 , for all @xmath1215 with @xmath241 .",
    "the choice @xmath1216 satisfies .",
    "moser @xcite , used john - nirenberg inequality to obtain an estimate of the form @xmath1217 for some @xmath1218 . an alternative approach is to use an abstract lemma of bombieri and guisti was later proposed by moser ( * ? ? ?",
    "* section 2.2.3 ) .",
    "john - nirenberg inequality is an estimate on distribution of functions of bounded mean oscillation which were introduced in @xcite .",
    "a locally integrable function @xmath1219 define is of bounded mean oscillation ( bmo ) if @xmath1220 john - nirenberg inequality states that functions of bounded mean oscillation have an exponentially decaying distribution function .    in (",
    "* theorem 5.2 ) a version of john - nirenberg inequality is shown for spaces satisfying the doubling hypothesis [ doub - glob ] .",
    "however for us , the metric measure space @xmath100 only satisfies [ doub - loc ] and [ doub - inf ] . since we do not have doubling hypothesis on arbitrarily small balls , we introduce a modified version of bmo seminorm ( bmo seminorm at scale @xmath478 ) defined as @xmath1221    our proof is motivated by the presentation in @xcite .",
    "we start by recalling the vitali covering lemma .",
    "[ l - vit ] let @xmath1222 be a family of balls with positive and uniformly bounded radii in a metric space @xmath101 .",
    "then there exists a disjoint subfamily @xmath1223 such that @xmath1224 in fact , every ball @xmath1225 meets a ball @xmath1226 with radius at least half that of @xmath325 and therefore satisfies @xmath1227 .",
    "the proof of vitali covering lemma follows from an application of zorn s lemma .",
    "we refer the reader to ( * ? ? ?",
    "* theorem 1.2 ) for a proof of lemma [ l - vit ] .",
    "a crucial ingredient in the proof of john - nirenberg inequality is the following version of caldern - zygmund decomposition lemma . since we replaced [ doub - glob ] by weaker assumptions [ doub - loc ] and [ doub - inf ] , we need some other method to control the behavior of a bmo function at small length scales .",
    "this is why we assume a local harnack inequality ( by lemma [ l - compharm ] the local harnack inequality holds for harmonic functions ) .",
    "[ l - cz ] suppose @xmath100 be a metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "let @xmath177 be a non - negative locally integrable function on @xmath1228 for some @xmath1229 .",
    "further we assume that there exists @xmath162 such that @xmath177 satisfies the local harnack inequality @xmath1230 for all @xmath1231 satisfying @xmath1232 .",
    "further , assume that @xmath1233 then there exists countable ( possibly finite ) family of disjoint balls @xmath1234 of disjoint balls centered in @xmath1235 and satisfying @xmath1236 for all @xmath1237 so that    a.   @xmath1238 for all @xmath1239 .",
    "b.   @xmath1240 for all @xmath1237 . c.   @xmath1241 for all @xmath1237 .",
    "the family of balls @xmath1242 satisfying the above conditions are called caldern - zygmund balls at level @xmath1243 .",
    "moreover if @xmath1244 , then the family caldern - zygmund balls @xmath1245 corresponding to different levels @xmath1246 may be chosen in such a way that every @xmath1247 is contained in some @xmath1248 where @xmath1249 .",
    "we denote @xmath1250 as @xmath1251 .",
    "define a maximal function @xmath1252 for all @xmath1253 .",
    "we define @xmath1254 first consider @xmath1255 . by definition for every @xmath1256",
    ", there exists a ball @xmath1257 satisfying @xmath1258 , @xmath1259 , @xmath1260 , @xmath1261 and @xmath1262 let @xmath1263 be such that @xmath1264 .",
    "then @xmath1265 .",
    "combining this with , we have @xmath1266 however since @xmath1267 , there exist smallest @xmath1268 such that @xmath1269 and @xmath1270 for all @xmath1271 .",
    "the balls @xmath1272 forms a covering of @xmath1273 . therefore by vitali covering lemma ( lemma [ l - vit ] ) , we pick a family @xmath1274 of pairwise disjoint balls @xmath1275 satisfying @xmath1276 .",
    "we now check the construction above satisfies the desired properties . by , and , there exists @xmath1277 such that @xmath1278 choosing @xmath1279 , we obtain properties ( ii ) and ( iii ) of caldern - zygmund decomposition .    it remains to verify ( i ) .",
    "if @xmath1280 , we have @xmath1281 .",
    "therefore by , we have @xmath1282 this give property ( i ) .",
    "we have now constructed the desired decomposition at level @xmath1255 .",
    "next we consider @xmath1283 .",
    "since @xmath1284 , for every @xmath1256 , we may start with exactly the same ball satisfying as before .",
    "for every @xmath1285 , we choose a ball @xmath1286 satisfying @xmath1287 , @xmath1258 , @xmath1261 , @xmath1288 and @xmath1289 as before for each ball @xmath1290 , we choose the smallest integer @xmath1291 such that @xmath1292 and @xmath1293 for @xmath1294 .",
    "note that if @xmath1256 , then @xmath1295 .",
    "as before , we apply vitali s covering lemma to the balls @xmath1296 to obtain a pairwise disjoint family of balls @xmath1297 satisfying ( i)-(iii ) with @xmath1243 replaced by @xmath1283 .",
    "let @xmath1298 .",
    "then @xmath1299 for some @xmath1256 .",
    "since @xmath1295 , we have @xmath1300 . by vitali s covering lemma",
    ", there exists @xmath1301 such that @xmath1302 .",
    "we continue this procedure to get decomposition at all levels @xmath1303 .    in the above proof",
    ", we use to obtain property ( i ) of the caldern - zygmund decomposition . typically property ( i )",
    "is proved using lebesgue differentiation theorem .",
    "however the proof of lebesgue differentiation theorem requires [ doub - glob ] .",
    "( see @xcite and ( * ? ? ?",
    "* theorem 1.8 ) )    next , we prove the john - nirenberg inequality for spaces satisfying [ doub - loc ] and [ doub - inf ] .",
    "let @xmath100 be a metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "let @xmath177 be a non - negative locally integrable function on @xmath1228 for some @xmath1304 .",
    "further we assume that there exists @xmath162 such that @xmath177 satisfies the local harnack inequality @xmath1305 for all @xmath1231 satisfying @xmath1232",
    ". then there exists @xmath927 such that @xmath1306 for all @xmath1307 .",
    "the constant @xmath364 depends only on @xmath1308 and constants associated with doubling hypotheses [ doub - loc ] and [ doub - inf ] .",
    "let @xmath1309 . without loss of generality , we assume @xmath1310 and @xmath1311 . it suffices to consider @xmath177 such that @xmath1310 and @xmath1311 as we may replace the function @xmath177 by @xmath1312 .",
    "by , there exists @xmath1313 such that @xmath1314 if @xmath1315 is the caldern - zygmund balls at level @xmath1316 where @xmath1317 , then by lemma [ l - cz ]    1 .",
    "@xmath1318 for all @xmath1319 .",
    "@xmath1320 for all @xmath1321 .",
    "@xmath1322 for all @xmath1321 .    by ( i ) and",
    ", we have @xmath1323    in order to estimate @xmath1324 , we consider caldern - zygmund decomposition at levels @xmath1325 as in lemma [ l - cz ] .",
    "we partition the family @xmath1326 as follows : first we collect those which are contained in @xmath1327 . from the remaining balls we collect those balls which are contained in @xmath1328 and so on .",
    "more precisely , we partition the caldern - zygmund balls at level @xmath1329 as @xmath1330 where @xmath1331 s are defined as @xmath1332 and so on . by ( ii ) , we have @xmath1333 in addition for each @xmath251 , we have @xmath1334 the fourth line above follows from @xmath1335 .",
    "we sum over @xmath251 and use @xmath1336 for all @xmath1337 .",
    "this implies @xmath1338 for all @xmath1337 .    in particular",
    "if @xmath1339 , we have @xmath1340    let @xmath1341 and let @xmath1342 .",
    "then we apply the caldern - zygmund decomposition at levels @xmath1343 . by and repeated application of",
    ", we obtain @xmath1344 the case @xmath1345 follows easily since @xmath1346 the choice @xmath1347 satisfies .",
    "we have the following corollary .    [ c - jn ]",
    "let @xmath100 be a metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "let @xmath177 be a non - negative locally integrable function on @xmath1228 for some @xmath1348 .",
    "further we assume that there exists @xmath162 such that @xmath177 satisfies the local harnack inequality @xmath1349 for all @xmath1350 satisfying @xmath1232 .",
    "then there exists @xmath1351 such that @xmath1352 where @xmath1309 .",
    "the constants @xmath1353 depends only on @xmath1354 and constants associated with doubling hypotheses [ doub - loc ] and [ doub - inf ] .",
    "there exists @xmath1355 such that @xmath1356 in the last line above , we fix @xmath1357 where @xmath364 is the constant from proposition [ p - jn ] . replacing @xmath177 by @xmath1358 in the above inequality and multiplying those two inequalities yields .",
    "before we dive into computations , we introduce simplifying notations and collect basic rules that mimics calculus rules in a discrete setting .",
    "let @xmath177 be a function on @xmath1359 or on @xmath107 .",
    "depending on context , we may abbreviate @xmath1360 to @xmath1361 or even @xmath177 .    * ` gradient ' @xmath1362 and the ` time derivative ' @xmath1363 * differentiation of product @xmath1364 * differentiation of square @xmath1365 * the same formulas for the ` time derivatives ' : @xmath1366 and @xmath1367 * let @xmath1368 denote the laplacian corresponding to a @xmath102-symmetric markov operator @xmath1 with kernel @xmath114 . then @xmath1369 * integration by parts : if @xmath1370 , then @xmath1371 * consider a @xmath102-symmetric markov operator with kernel @xmath114 .",
    "we define @xmath1372 corresponding to the markov operator @xmath1 as @xmath1373    we caution the reader to be aware of different uses of the symbol @xmath1374 in , and with slight change in subscript .",
    "the subscript could be a positive real number , a pair of points or a markov operator .",
    "we hope the different notations of @xmath1374 would be clear from the context .      if @xmath31 is a positive harmonic function , then we show that @xmath1375 has bounded bmo seminorm .",
    "this combined with john - nirenberg inequality yields @xmath1376 for some @xmath1218 and @xmath1377 .",
    "[ l - minplu ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] and poincar inequality at scale @xmath478 [ poin - mms ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 for some @xmath508 .",
    "let @xmath31 be a positive @xmath1-harmonic function on @xmath77 .",
    "let @xmath1378 be a non - negative function on @xmath325 satisfying @xmath1379 .",
    "there exists @xmath1018 and @xmath1380 satisfies @xmath1381 for all balls @xmath325 , for all functions @xmath31 , @xmath1378 satisfying the above requirements .",
    "define @xmath1382 . by product rule @xmath1383 using integration by parts along with @xmath1379 ,",
    "we deduce @xmath1384 combining , , we have @xmath1385 by lemma [ l - compharm ] , @xmath31 satisfies the local harnack inequality on @xmath1386 for large enough balls @xmath325 .",
    "hence there exists @xmath1387 and @xmath1380 such that @xmath1388 for all positive @xmath1-harmonic functions @xmath31 on @xmath77 , for all @xmath1389 with @xmath1204 and @xmath1039 . combining , and",
    ", we obtain @xmath1390 since @xmath778 for @xmath119-almost every @xmath1391 , we have @xmath1392 by and @xmath1393 by hlder inequality @xmath1394 combining and , we obtain with @xmath1395 .    in the next proposition ,",
    "we show that logarithm of a harmonic function has bounded mean oscillation . then using john - nirenberg inequality we prove a weak form of elliptic harnack inequality .",
    "[ p - negpos ] under the assumptions of theorem [ t - ehi ] , there exists @xmath1396 , @xmath1397 and @xmath1398 such that @xmath1399 for all @xmath1-harmonic functions @xmath31 on @xmath77 with @xmath241 and for all @xmath61",
    ".    let @xmath1377 ( its value will be determined later in the proof ) .",
    "let @xmath77 and let @xmath1400 with @xmath1401 . for any positive harmonic function @xmath31 on @xmath325 , by [ poin - inf ] there exists @xmath1402 such that @xmath1403 we used [ poin - mms ] in the first line and and @xmath1404 we choose @xmath1405 , so that @xmath1406 for all @xmath1407 .",
    "we define @xmath1378 as @xmath1408 note that for large enough @xmath14 , we have @xmath1409 .",
    "since @xmath1410 on @xmath1411 , there exists @xmath1412 @xmath1413 in the last line above we used lemma [ l - minplu ] , , definition of @xmath1378 , triangle inequality and . by hlder inequality",
    "@xmath1414    combining , and we obtain @xmath1415 for all positive harmonic functions @xmath31 on @xmath77 and for all @xmath14 sufficiently large . by lemma [ l - compharm ] , and corollary [ c - jn ] ,",
    "there exists @xmath1416 such that @xmath1417 for all sufficiently large balls @xmath325 and for all positive @xmath1-harmonic functions @xmath31 on @xmath325 .",
    "this immediately yields .      for the rest of the chapter",
    ", we will rely on [ doub - inf ] , [ doub - loc ] and the sobolev inequality to prove theorem [ t - ehi ] .",
    "we obtain various inequalities on subharmonic functions .",
    "the following elementary property of subharmonic and superharmonic functions is useful .",
    "[ l - sub ] let @xmath1 be a markov operator .",
    "a.   if @xmath177 is a non - negative function that is @xmath1-subharmonic in @xmath40 , then @xmath1418 is @xmath1-subharmonic in @xmath40 for all @xmath1419 .",
    "b.   if @xmath177 is a positive function that is @xmath1-superharmonic in @xmath40 , then @xmath1418 is @xmath1-subharmonic in @xmath40 for all @xmath1420 .    if @xmath266 , then by jensen s inequality and the fact that @xmath177 is @xmath1-subharmonic in @xmath40 @xmath1421 this proves ( a ) .",
    "we again use jensen s inequality , @xmath177 is @xmath1-superharmonic in @xmath40 and @xmath1422 to obtain @xmath1423    moser s iteration relies on repeated application of the following lemma .",
    "[ l - elel ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 for some @xmath850 .",
    "further assume that @xmath1 satisfies the sobolev inequality .",
    "there exists @xmath1018 such that @xmath1424 for all @xmath61 , for all @xmath1147 , for all @xmath1425 and for all functions @xmath31 that are non - negative and @xmath1-subharmonic on @xmath40 .",
    "define @xmath1426 note that @xmath1427 in @xmath1428 and @xmath1429 in @xmath1430 . since @xmath1431 in @xmath40 and @xmath1432 , we have @xmath1433 the above steps follows from integration by parts and product rule .",
    "we use the inequality @xmath1434 to obtain @xmath1435 since @xmath1436 for @xmath1437-almost every @xmath1438 , we have @xmath1439 where @xmath1440 . combining , and @xmath1441 the inequality @xmath1442 along with product rule implies @xmath1443 combining and , we obtain @xmath1444 by and , there exists @xmath466 such that @xmath1445 for all @xmath21 and for @xmath102-almost every @xmath281 .",
    "combined with , we have @xmath1446 we define @xmath1447 since @xmath1429 in @xmath1430 , by we have @xmath1448 for all @xmath1449 . by along with hlder inequality , we have @xmath1450 in , we used that @xmath1451 is a contraction in @xmath472 and that @xmath1452 in @xmath1430 . by sobolev inequality , lemma [ l - dircomp - ball](a ) and integration by parts @xmath1453 by using , , , @xmath1454 , @xmath1455 and , there exists @xmath1029 such that @xmath1456 this immediately yields .",
    "we modify the proof of the lemma [ l - elel ] to obtain a reverse poincar inequality for all @xmath1-harmonic functions ( not necessarily non - negative ) .",
    "the below reverse poincar inequality and its proof is essentially same as .",
    "[ l - rp ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is weakly @xmath831-compatible with respect to @xmath102 for some @xmath850 . for all @xmath1457 ,",
    "there exists @xmath1458 such that for all @xmath1-harmonic functions @xmath31 , for all @xmath61 and for all @xmath1459 @xmath1460 in particular , there exists @xmath1461 such that such that for all @xmath1-harmonic functions @xmath31 , for all @xmath61 and for all @xmath1462 @xmath1463    we repeat the steps in the proof of lemma [ l - elel ] .",
    "define @xmath1464 note that @xmath1427 in @xmath1465 and @xmath1429 in @xmath1186 .",
    "since @xmath1466 , for all @xmath1467 and for all @xmath61 we have @xmath1468 the above steps follows from integration by parts and product rule .",
    "we use the inequality @xmath1434 to obtain @xmath1469 since @xmath1436 for @xmath1437-almost every @xmath1438 , we have @xmath1470 where @xmath1471 . combining , and @xmath1472 the inequality @xmath1442 along with product rule implies @xmath1473 combining and , we obtain @xmath1474 by and , there exists @xmath466 such that @xmath1475 for all @xmath21 , for @xmath102-almost every @xmath281 and for all @xmath1476 .",
    "combined with , we have @xmath1477 for all @xmath1-harmonic functions",
    "@xmath31 , for all @xmath1476 and for all @xmath61 .",
    "since @xmath1429 in @xmath1186 the desired inequality follows from .",
    "the next lemma is a @xmath472-mean value inequality for positive @xmath1-subharmonic functions .",
    "[ l-2toinf ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 for some @xmath850 .",
    "further assume that @xmath1 satisfies the sobolev inequality .",
    "there exists @xmath466 and @xmath510 such that @xmath1478 for all @xmath61 , for all @xmath593 and for all functions @xmath31 that are non - negative and @xmath1-subharmonic on @xmath40 .",
    "define a sequence of radii iteratively by @xmath1479 , @xmath1480 for @xmath1481 . by the above definition",
    ", there exists @xmath684 such that @xmath1482 for all @xmath241 .",
    "we define the balls @xmath1483 for @xmath1484 and exponents @xmath1485 for @xmath1486 . by lemma [ l - sub ]",
    "@xmath1487 is @xmath1-subharmonic for all @xmath1486 . by applying lemma [ l - elel ] to the function @xmath1488 that is @xmath1-subharmonic in @xmath351",
    ", we obtain @xmath1489 for @xmath1490 and @xmath241 . combining the estimates in",
    ", there exists @xmath1029 such that @xmath1491 for all @xmath61 , for all @xmath241 and for all non - negative subharmonic @xmath31 in @xmath40 .",
    "there exists @xmath904 such that @xmath1492 the first line above follows from lemma [ l - sub ] , the second line follows from and , the third line follows from and the last line from and . combining and",
    ", we obtain .",
    "the next lemma is analogous to lemma [ l - elel ] and will be used for an iteration procedure .",
    "[ l - it2 ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 for some @xmath850 .",
    "further assume that @xmath1 satisfies the sobolev inequality .",
    "there exists @xmath1493 such that @xmath1494 for all @xmath61 , for all @xmath241 , for all @xmath1495 \\setminus { \\left\\ { 1/2 \\right\\}}$ ] , for all positive functions @xmath31 that are @xmath1-harmonic on @xmath40 and for all @xmath1496 with @xmath1497 .",
    "let @xmath1498 , where @xmath1496 satisfies @xmath1499 and @xmath1500 is @xmath1-harmonic in @xmath40 . by product rule @xmath1501 by integration by parts ,",
    "we obtain @xmath1502 where @xmath1503 .",
    "there exists @xmath466 such that @xmath1504 for all @xmath1495 $ ] , for all @xmath1505 with @xmath1204 and for all positive @xmath31 .",
    "the estimate is elementary and is a version of stroock - varopoulos inequality .",
    "the proof of is essentially contained in ( * ? ? ? * lemma 2.4 ) .",
    "the estimate follows from mean value theorem and the local harnack inequality given by lemma [ l - compharm ] . combining , and",
    ", we have @xmath1506 we use cauchy - schwarz inequality and @xmath1507 in the last step . by the @xmath1437-almost everywhere",
    "symmetry of @xmath114 , we have @xmath1508 combining and yields",
    ".    we do another iteration procedure between the exponents @xmath383 and @xmath1509 using lemma [ l - it2 ] .",
    "[ l - qto2 ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible to @xmath100 for some @xmath850 .",
    "further assume that @xmath1 sobolev inequality .",
    "for any fixed @xmath1510 , there exists @xmath1511 and @xmath510 such that @xmath1512 for all @xmath61 , for all @xmath593 and for all functions @xmath31 that are non - negative and @xmath1-subharmonic on @xmath40 .",
    "if @xmath1513 , then follows from jensen s inequality . hence it suffices to consider @xmath1514 .",
    "define @xmath1515 .",
    "we slightly decrease @xmath383 if necessary so that @xmath1516 for all @xmath1517 .",
    "define @xmath122 as the integer that satisfies @xmath1518 .",
    "define @xmath1519 and iteratively define @xmath1520 for @xmath1521 , where @xmath1522 .",
    "fix @xmath684 such that @xmath1523 for all @xmath241 where @xmath251 and @xmath1524 are defined as above .",
    "define @xmath1525 , @xmath1526 for @xmath1527 .",
    "define the functions @xmath1528 for @xmath445 .",
    "note that @xmath1529 in @xmath1530 and @xmath1427 in @xmath1531 .",
    "by sobolev inequality there exists @xmath1029 such that @xmath1532 for all @xmath445 . by and lemma [ l - compharm ] there",
    "exists @xmath1016 such that @xmath1533 for all @xmath1534 .",
    "therefore @xmath1535 for @xmath1536 .",
    "there exists @xmath1537 such that @xmath1538 \\int_{b_{i } } \\int_{b_{i } } p_1(y , z ) { { \\left\\vert\\kern-0.25ex   \\nabla_{yz } \\psi_i       \\kern-0.25ex\\right\\vert}}^2 u(y)^{2 q_i } \\,dy \\,dz   \\\\ \\nonumber & \\le \\frac{c_5}{s_{k - i-1}^2 } \\left [ \\left ( \\frac{2q_i}{2q_i-1 } \\right)^2 + 1   \\right ] \\int_{b_{i } }   u(z)^{2 q_i } \\,dz \\\\ & \\le \\frac{c_6}{s_{k - i-1}^2 } \\int_{b_{i } }   u(z)^{2 q_i } \\,dz.\\end{aligned}\\ ] ] in the first step above , we used product rule and the inequality @xmath1507 . in the second step we use lemma [ l - it2 ] and in the third step we use . in the last step ,",
    "we simply bound @xmath1539 by @xmath1540 .    combining , , along with @xmath1541 yields",
    "@xmath1542 for some @xmath1543 . combined with @xmath241 and",
    ", we deduce @xmath1544 for @xmath445 , for all @xmath61 , for all @xmath241 and for all @xmath1-harmonic @xmath1545 . the estimates along with jensen s inequality implies with @xmath1546 and @xmath1547 .",
    "we are now ready to prove elliptic harnack inequality .",
    "it suffices to consider the case @xmath1545 because we can replace @xmath1432 by @xmath1548 and let @xmath1549 .",
    "note that we have sobolev inequality by theorem [ t - sob ] .",
    "there exists @xmath1033 @xmath1550 for @xmath1551 such that for all @xmath61 and for all @xmath241 and for all positive functions @xmath31 that are @xmath1-harmonic on @xmath1552 @xmath1553 the first line above follows from lemma [ l-2toinf ] , the second line above follows from lemma [ l - qto2 ] and the third line follows from proposition [ p - negpos ] .",
    "the last line follows from applying lemma [ l-2toinf ] to the function @xmath1554 which is subharmonic by lemma [ l - sub](b ) . choosing @xmath1555 yields the elliptic harnack inequality .",
    "the constant @xmath1556 in is flexible .",
    "more precisely , we can slightly improve the conclusion of theorem [ t - ehi ] for @xmath201-geodesic spaces by an easy chaining .",
    "[ c - ehi ] let @xmath100 be a @xmath201-geodesic space satisfying [ doub - loc ] , [ doub - inf ] and poincar inequality [ poin - mms ] at scale @xmath478 .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 for some @xmath850 .",
    "then for all @xmath1556 , there exists @xmath1557 such that for all @xmath61 , for all @xmath241 and for all non - negative functions @xmath1189 that are @xmath1-harmonic in @xmath40 the following harnack inequality holds : @xmath1558    the above corollary is a consequence of theorem [ t - ehi ] applied repeatedly to a sequence of points in an approximate geodesic .",
    "we do not use the above corollary .",
    "the proof of corollary [ c - ehi ] is left to the reader .",
    "we present two immediate and well - known applications of elliptic harnack inequality .",
    "[ p - liov ] assume that @xmath100 is a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] and poincar inequality [ poin - mms ] at scale @xmath478 .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 for some @xmath850 .",
    "then all non - negative @xmath1-harmonic functions are constant ( strong liouville property ) .",
    "therefore all bounded harmonic functions are constant ( weak liouville property ) .",
    "let @xmath31 be a non - negative harmonic function .",
    "then @xmath1559 is a non - negative harmonic function with @xmath1560 . by elliptic harnack inequality",
    ", there exists @xmath1556 and @xmath1561 such that @xmath1562 for all large enough @xmath14 . letting @xmath245",
    ", we have @xmath1563 which implies @xmath1564 .",
    "this proves strong liouville property .",
    "the weak liouville property follows from the observation that for any bounded harmonic function @xmath478 , the function @xmath1565 is a non - negative harmonic function .",
    "the following hlder regularity - type estimate is a direct consequence of elliptic harnack inequality .",
    "our argument is an adaptation of moser s argument ( * ? ? ?",
    "* section 5 ) which uses an oscillation inequality .",
    "[ p - holder ] there exists @xmath1556 , @xmath1566 , @xmath951 and @xmath1567 such that @xmath1568 for all @xmath1569 , for all @xmath61 , for all @xmath593 and for all non - negative functions @xmath1570 that is @xmath1-harmonic on @xmath40 with @xmath1571 .",
    "let @xmath1572 be constants from from theorem [ t - ehi ] .",
    "we optionally decrease the @xmath1573 so that @xmath1574 .",
    "let @xmath77 be an arbitrary ball with @xmath241 , @xmath1571 and @xmath1569 .",
    "define a sequence of balls by @xmath1575 for @xmath1484 , where @xmath1576 .",
    "note that @xmath1577 .",
    "choose @xmath1578 so that @xmath1579 for all @xmath593 and for all @xmath1569 .",
    "let @xmath593 and let @xmath1580 . since @xmath1571 there exists @xmath466 such that @xmath1581 denote by @xmath1582 and @xmath1583 for @xmath1521 , where @xmath31 is an arbitrary non - negative function @xmath1570 that is @xmath1-harmonic on @xmath40 . by elliptic harnack inequality of theorem [ t - ehi",
    "] , we have @xmath1584 for @xmath1585 . by adding and",
    ", we obtain @xmath1586 for @xmath1585 . combining along with ,",
    "we obtain @xmath1587 since @xmath31 is @xmath1-harmonic in @xmath40 , we have @xmath1588 the above inequality along with implies .",
    "note that above result does not give hlder continuity for harmonic functions which is in contrast to ( * ? ? ?",
    "* section 5 ) .",
    "however we will see that proposition [ p - holder ] is useful .",
    "in particular , we use proposition [ p - holder ] to prove gaussian lower bounds in chapter [ ch - glb ] .",
    "the goal of this chapter is to prove the following gaussian upper bounds using sobolev inequality .",
    "the results of this chapter rely only on [ doub - loc ] , [ doub - inf ] and the sobolev inequality .",
    "we do not assume the poincar inequality [ poin - mms ] to show gaussian upper bounds .",
    "more precisely , we show    [ p - gue ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 for some @xmath850 .",
    "further assume that @xmath1 satisfies the sobolev inequality .",
    "there exists @xmath951 such that @xmath1589 for all @xmath61 and for all @xmath1590 .",
    "the first step is to obtain the following on - diagonal upper bound .",
    "[ p - diag ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 for some @xmath850 .",
    "further assume that @xmath1 satisfies the sobolev inequality .",
    "there exists @xmath1591 such that @xmath1592 for all @xmath61 and for all @xmath1590 .    a crucial ingredient in the proof of proposition [ p - diag ] is a @xmath315 to @xmath866 mean value inequality for the solutions of a heat equation .",
    "we again rely on moser s iterative method and the calculations are similar but more involved than those encountered in section [ s - mvi - el ] for harmonic functions .",
    "the lazy walk defined in example [ x - lazy ] will play an important role in this chapter . recall that for a markov operator @xmath1 , the corresponding ` lazy ' versions of markov operator and laplacian are given by @xmath1593 for @xmath1594 , we denote the integer intervals by @xmath1595 the following definition is analogous to definition [ d - harmonic ] .",
    "caloric functions are solutions to heat equation .",
    "[ d - caloric ] let @xmath1 be a markov operator on @xmath100 and let @xmath1594 .",
    "a function @xmath1596 is @xmath1-caloric ( respectively @xmath1597-caloric ) in @xmath1598 if @xmath1599 for all @xmath1600 and for all @xmath266 .",
    "similarly , we say a function @xmath1601 is @xmath1-subcaloric ( resp .",
    "@xmath1-supercaloric ) in @xmath1598 if @xmath1602 for all @xmath1600 and for all @xmath266 .",
    "analogously , we define @xmath1597-subcaloric and @xmath1597-supercaloric functions simply by replacing @xmath10 with @xmath816 in the equation above .",
    "[ r - caloric ]    a.   we can restate the above definitions using @xmath1603 and @xmath1604 .",
    "b.   consider a markov operator @xmath1 that is @xmath831-compatible with @xmath100 .",
    "similar to remark [ r - harmonic](a ) , the property that @xmath1596 is @xmath1-caloric ( or @xmath1597-caloric ) in @xmath1598 depends only on the value of @xmath31 in @xmath1605 .",
    "therefore it suffices if the function @xmath31 has a domain that satisfies @xmath1606 .",
    "although our eventual goal is to prove parabolic harnack inequality for @xmath1-caloric functions , the moser s iteration procedure is applied to @xmath1597-caloric functions .",
    "the laziness is introduced to handle certain technical difficulties that arise due to discreteness of time .",
    "another method to avoid these technical difficulties that arise due to discreteness of time is to carry out moser s iteration method for solutions of the continuous time heat equation @xmath1607 ( see ( * ? ? ?",
    "* section 2 ) for this method on graphs ) .    in continuous time case",
    "the product rule of differentiation implies @xmath1608 ; however for discrete time the analogous formula is @xmath1609 .",
    "the ` error term ' @xmath1610 due to discreteness of time is a source of difficulty in the proofs of caccioppoli inequality and an integral maximum principle for @xmath1-caloric and @xmath1-subcaloric functions .",
    "however as we shall see , this ` error term ' can be handled using a cauchy - schwarz inequality for @xmath1597-caloric and @xmath1597-subcaloric functions ( see remark [ r - error ] ) . as a result",
    ", we will primarily be concerned with @xmath1597-caloric and @xmath1597-subcaloric functions for now .",
    "the assumption ( d ) in definition [ d - compat ] will allow to compare the random walks driven by @xmath1 and @xmath1597 .    as mentioned in the beginning of chapter",
    "[ ch - sob ] , we rely on a version of sobolev inequality that is weaker than the ones assumed in previous works . this causes new difficulties for moser s iteration method which relied on a sobolev inequality .",
    "the difficulty is even more significant in the parabolic case compared to that of the elliptic case in chapter [ ch - ehi ] .",
    "this is because the difference between the strong and weak formulations of sobolev inequalities is not significant for harmonic functions . to see why this might be true ,",
    "note that if a function @xmath31 is @xmath1-harmonic in @xmath77 then @xmath1611 in @xmath1612 and therefore the weaker formulation yields an estimate that is close to that of .",
    "however the same can not be said about @xmath1-caloric functions .",
    "the following lemma and its proof is analogous to that of lemma [ l - sub ] .",
    "[ l - subcal ] let @xmath1 be a markov operator .",
    "assume that the function @xmath1613 is @xmath1-subcaloric in @xmath1598 for some @xmath61 , @xmath63 and @xmath1594 .",
    "then @xmath1614 is a @xmath1-subcaloric in @xmath1598 for all @xmath1615 .",
    "note that @xmath1616 for all @xmath1617 . the first inequality above follows from the fact that @xmath1618 is @xmath1-subcaloric in @xmath1598 and the second follows from jensen s inequality .",
    "for a function @xmath1619 and a markov operator @xmath1 on @xmath107 , we denote the function @xmath1620 @xmath1621 for all @xmath129 and for all @xmath61 .",
    "we require the following property of subcaloric functions .",
    "[ l - solres ] let @xmath100 be a metric measure space and let @xmath1 be a markov operator that is @xmath831-compatible to @xmath100 . if @xmath1596 is @xmath1597-subcaloric in @xmath1598 , then @xmath1622 is @xmath1597-subcaloric in @xmath1623 ) for all @xmath61 and for all @xmath1624 .",
    "if @xmath1625 and @xmath1596 is @xmath1597-subcaloric in @xmath1598 , then @xmath1626(y)= p \\left ( u_{k+1 } - p_l u_k \\right)(y ) \\le 0.\\ ] ] in the above equality , we used that @xmath1 and @xmath1597 commute .",
    "the inequality follows from and the fact that any markov operator is positivity preserving .",
    "we will prove the following mean value inequality in a weak form .",
    "the inequality bounds from above a weak version of @xmath866 norm on a space - time cylinder by a weak version of @xmath315 norm . our version of the mean value inequality in lemma [ l - mvi ] is weaker than the one known for graphs ( * ? ? ?",
    "* theorem 4.1 ) mainly because we rely on a weaker sobolev - type inequality .",
    "although the mean value inequality is weaker , we will obtain on - diagonal upper bounds using lemma [ l - mvi ] . using an integral maximum principle argument , we will obtain gaussian upper bounds in chapter [ ch - gub ] .",
    "[ l - mvi ] under the assumptions of proposition [ p - diag ] , there exists constants @xmath1627 such that @xmath1628 for all @xmath897 satisfying @xmath1629 , for all @xmath61 , for all non - negative functions @xmath1596 that is @xmath1597-subcaloric in @xmath1630 .",
    "the proof of lemma [ l - mvi ] relies on moser s iteration procedure .",
    "couhlon and grigoryan ( * ? ? ?",
    "* section 4 ) obtained a similar ( stronger ) mean value inequality in the graph setting using an iteration procedure .",
    "however they relied on a faber - krahn inequality that is equivalent to the sobolev inequality and therefore does not hold for discrete time markov chains on continuous spaces .    in this section ,",
    "we carry out moser s iteration procedure for subcaloric functions relying on the weaker sobolev inequality . to prove the elementary iterative step of iteration",
    ", we need the following discrete caccioppoli inequality .",
    "the proof is an adaptation ( * ? ? ?",
    "* proposition 4.5 ) .",
    "the next two lemmas together may be regarded as the parabolic version of lemma [ l - elel ] .",
    "[ l - caccio ] under the assumptions on proposition [ p - diag ] , we have @xmath1631 for all @xmath61 , for all @xmath70 , for all non - negative functions @xmath1632 satisfying @xmath1633 , for all @xmath1594 , for all @xmath1600 and for all non - negative functions @xmath1634 such that @xmath31 is @xmath1597-subcaloric in @xmath1635 .",
    "fix @xmath61 , @xmath1636 and define @xmath1637 .",
    "let @xmath1634 be such that @xmath31 is @xmath1597-subcaloric in @xmath1635 .",
    "we start with the elementary inequality @xmath1638 for all @xmath1617 , as we now show .",
    "since @xmath31 is @xmath1597-subcaloric in @xmath1635 , we have @xmath1639 for all @xmath1617 .",
    "combined with the fact that @xmath31 is non - negative , we have @xmath1640 for all @xmath1617 which can be rearranged into .",
    "let @xmath1617 .",
    "recall that @xmath1641 . using , integration by parts and @xmath1633 ,",
    "we have @xmath1642 the second term in can be handled using cauchy - schwarz inequality as @xmath1643 for the first term in , we use product rule @xmath1644 combining , and , we have @xmath1645 the right side of can be bounded using @xmath1646 as @xmath1647 using @xmath778 for @xmath1437-almost every @xmath1438 , we obtain @xmath1648 combining , and , we deduce @xmath1649 since @xmath1650 , using integration by parts we have @xmath1651 using product rule and the inequality @xmath1652 , we obtain @xmath1653 combining , , and @xmath1437-almost everywhere symmetry of @xmath114 yields .",
    "[ r - error ] recall the product rule of differentiation @xmath1609 gives rise to the ` error term ' @xmath1610 which occurs due to discreteness of time .",
    "this error term occurs in and is controlled using cauchy - schwarz inequality in .",
    "however the estimate given by is sufficient to prove caccioppoli inequality only in the presence of some laziness .",
    "a similar difficulty arises in the proof of discrete integral maximum principle and is the reason behind considering the operator @xmath1597 as opposed to @xmath1 in this section .",
    "next , we prove the elementary iterative step of moser s iteration in parabolic setting .",
    "the proof relies on caccioppoli inequality and sobolev inequality .",
    "let @xmath1654 denote the counting measure on @xmath1655 and let @xmath100 be a metric measure space .",
    "we denote the product measure on @xmath1656 by @xmath1657 . similar to",
    ", we define @xmath1658 for all @xmath1659 , for all @xmath1660 and for all functions @xmath1661 .",
    "[ l - pel ] under the assumptions of proposition [ p - diag ] , for all @xmath1662 , there exists @xmath1663 ( depending on @xmath1664 ) such that @xmath1665 for all @xmath1425 , for all @xmath61 , for all @xmath593 , for all @xmath1666 satisfying @xmath1667 and for all non - negative functions @xmath1613 such that @xmath31 is @xmath1597-subcaloric in @xmath1668 .",
    "let @xmath61 , @xmath1425 and let @xmath1669 , where @xmath1670 will be determined later .",
    "let @xmath31 be a non - negative function that is @xmath1597-subcaloric in @xmath1668 .",
    "we start by defining appropriate cut - off functions in space and time .",
    "define @xmath1637 and @xmath1632 as @xmath1671 note that @xmath1672 and @xmath1429 on @xmath1673 .",
    "define @xmath1674 and @xmath1675 as @xmath1676 since @xmath31 is non - negative and @xmath1597-subcaloric in @xmath1677 , by caccioppoli inequality ( lemma [ l - caccio ] ) and product rule , we obtain @xmath1678 for all @xmath1679 .",
    "since @xmath114 is @xmath831-compatible with @xmath100 , we have @xmath1680 we use product rule , triangle inequality , @xmath1681 and @xmath1682 to deduce @xmath1683 combining , and , there exists @xmath1029 such that @xmath1684 for all @xmath1685 . in",
    ", @xmath364 depends only on @xmath1664 and @xmath497 .",
    "adding , from @xmath1686 to @xmath1685 , yields @xmath1687 }",
    "\\int_b \\psi_\\sigma^2   u_k^2 \\,d\\mu & \\le   \\frac{c_2}{\\sigma^2 r^2 } \\sum_{k = a_0}^{a_1 } \\int_b    u_k^2 \\,d\\mu \\\\",
    "\\label{e - pel6 } \\sum_{k = a_\\sigma}^{a_1 } \\mathcal{e}(\\psi_\\sigma u_k , \\psi_\\sigma u_k ) & \\le \\frac{8 c_2}{\\sigma^2 r^2 } \\sum_{k = a_0}^{a_1 } \\int_b    u_k^2\\,d\\mu.\\end{aligned}\\ ] ] define @xmath1688 . since @xmath1429 on @xmath1673 , by @xmath1689 on @xmath1690 .",
    "combined with hlder inequality , we have @xmath1691 since @xmath970 is a contraction in @xmath992 , we have @xmath1692 by sobolev inequality , lemma [ l - dircomp - ball](a ) and , we obtain @xmath1693 by , , , , and @xmath1694 , there exists @xmath1313 such that @xmath1695 we choose @xmath1696 so that @xmath1697 for all @xmath1666 so that @xmath1698 .",
    "since @xmath1699 and @xmath1700 , we have @xmath1701 . hence by , @xmath1702 along with , we have .",
    "we carry out moser s iteration in two stages . in the first stage of the iteration",
    ", we obtain a @xmath315 to @xmath472 mean value inequality and in the second stage we show a @xmath472 to @xmath866 mean value inequality . combining the two stages yields the desired @xmath315 to @xmath866 mean value inequality .",
    "the proof relies on repeated application of the elementary iterative step given by lemma [ l - pel ] .",
    "let @xmath1703 , @xmath1704 , @xmath1705 and @xmath1706 .",
    "for the first stage of iteration , we iteratively define the quantities @xmath1707 for @xmath1708 .",
    "we define a non - increasing sequence of space - time cylinders @xmath1709 the following estimates are straightforward from definitions of @xmath1670 and @xmath1710 : there exists @xmath901 such that for all @xmath881 , we have @xmath1711    let @xmath1661 be an arbitrary non - negative function that is @xmath1597-subcaloric in @xmath1630 where @xmath907 . by lemma [ l - solres ] @xmath1712 is @xmath1597-subcaloric in @xmath1713 and therefore @xmath1597-subcaloric in @xmath1714 for all @xmath1715 .",
    "hence by applying lemma [ l - pel ] for the function @xmath1712 which is @xmath1597-subcaloric on @xmath1714 with @xmath1716 , we have @xmath1029 such that @xmath1717 for all @xmath1708",
    ". we may choose @xmath1718 in the application of lemma [ l - pel ] above due to and .",
    "by hlder inequality along with , and , there exists @xmath1016 such that @xmath1719 for all @xmath1720 , where @xmath1721 . by ,",
    "@xmath1432 , , and , there exists @xmath1722 such that @xmath1723 for all @xmath1715 .",
    "combining , , , there exists @xmath1724 such that @xmath1725 for @xmath1726 . by iterating ,",
    "we obtain @xmath1727 since @xmath1432 , by hlder inequality , and , there exists @xmath1728 such that @xmath1729 for all @xmath1730 . combining , along with yields @xmath1731 for some @xmath1732 .",
    "the inequality is a @xmath315 to @xmath472 mean value inequality and this concludes the first part of iteration .    for the second part , we define @xmath1733 , @xmath1734 and @xmath1735 . as before ,",
    "we iteratively define @xmath1736 for @xmath1737 . as before , define a non - increasing sequence of space - time cylinders by @xmath1738 for @xmath1739 .",
    "note that @xmath1740 .",
    "similar to and , there exists @xmath1741 such that for all @xmath907 , @xmath1742 for all @xmath1715 . by jensen s inequality",
    ", we have @xmath1743 \\right)^\\theta\\ ] ] for all @xmath1517 . by lemma [ l - solres ] and lemma [ l - subcal ] ,",
    "the function @xmath1744 is @xmath1597-subcaloric in @xmath1745 for all @xmath1715 .",
    "therefore by lemma [ l - pel ] for the function @xmath1744 and , there exists @xmath1746 such that @xmath1747 for @xmath1748 .",
    "iterating the inequalities , there exists @xmath1749 such that @xmath1750 there exists @xmath1751 such that , for all @xmath1752 @xmath1753 the first line above follows from , the second line follows from jensen s inequality , the third line follows from and the last line follows from the fact that @xmath1754 is bounded in @xmath1755 . by , and @xmath1733 , we have a @xmath472 to @xmath866 mean value inequality @xmath1756 combining and , we have the desired inequality .",
    "the following lemma provides a useful example of @xmath1597-caloric function .",
    "[ l - solheat ] let @xmath100 be a metric measure space .",
    "let @xmath1 be markov operator equipped with kernel @xmath1757 that is @xmath831-compatible with @xmath100 .",
    "define for all @xmath129 , the function @xmath1758 by @xmath1759 where @xmath814 as before .",
    "then for all @xmath61 , the function @xmath1760 is @xmath1597-caloric in @xmath1656 .",
    "the second equality in is a consequence of binomial theorem and lemma [ l - kernel](c ) .",
    "note that @xmath1761 therefore @xmath1762 is @xmath1597-caloric in @xmath1656 for all @xmath61 .",
    "we are ready to prove proposition [ p - diag ] using the mean value inequality .",
    "let @xmath1763 be defined as .",
    "choose @xmath1764 such that @xmath1765 for all @xmath907 .",
    "by lemma [ l - mvi ] , lemma [ l - solheat ] and @xmath1766 , there exists @xmath1767 and @xmath466 such that the @xmath1597-caloric function @xmath1762 satisfies the mean value inequality @xmath1768 for all @xmath61 and for all @xmath1769 satisfying @xmath918 .    by , we have @xmath1770 @xmath102-almost everywhere for each @xmath61 . by of lemma [ l - con - d ] and lemma [ l - mker ]",
    ", we have @xmath1771 for all @xmath61 and for all @xmath1772 . by and ,",
    "@xmath1773 for all @xmath61 , for all @xmath1774 and for all @xmath918 . combining , , and",
    ", there exists @xmath1029 such that @xmath1775 for all @xmath1776 .",
    "since @xmath1 is a contraction in @xmath866 by , lemma [ l - kernel](c ) and , there exists @xmath904 and @xmath998 such that @xmath1777 for all @xmath61 and for all @xmath1778 with @xmath89 . combining and gives the diagonal bound .",
    "we use discrete integral maximum principle and diagonal upper bound to obtain gaussian upper bounds .",
    "this approach is detailed in @xcite for graphs .",
    "a crucial assumption in @xcite is the laziness assumption for the corresponding markov chain @xmath1779 given by @xmath1780 . as explained in (",
    "* section 3 ) this laziness assumption is not too restrictive for graphs because under natural conditions the iterated operator @xmath932 corresponds to a lazy markov chain .",
    "however this fails to be true for continuous spaces .",
    "since the laziness assumption is unavoidable for discrete integral maximum principle , we consider the markov operator @xmath814 instead of @xmath1 . using discrete integral maximum principle corresponding to @xmath1597 and diagonal estimate on @xmath138 , we obtain off - diagonal estimates on @xmath1781 defined in .",
    "we rely on careful comparison between off - diagonal estimates of @xmath1781 and the markov kernel @xmath138 .",
    "the comparison arguments are new but elementary and involves stirling s approximation .",
    "our comparison arguments rely crucially on the compatibility assumption .",
    "similar comparison arguments for off - diagonal estimates was carried out in ( * ? ? ?",
    "* section 3.2 ) to compare markov chains on graphs with its corresponding continuous time version .",
    "the main technical tool to prove gaussian upper bounds is the following discrete integral maximum principle .",
    "the statement below and its proof is adapted from ( * ? ? ?",
    "* proposition 2.1 ) .",
    "[ p - imp ] suppose that @xmath1 is a markov operator that is @xmath831-compatible with a metric measure space @xmath100 .",
    "let @xmath177 be a strictly positive continuous function on @xmath1782 such that , @xmath1783 for all @xmath61 and @xmath1784 where @xmath1785 is as defined in .",
    "let @xmath1786 bounded function that is @xmath1597-caloric on @xmath1787 satisfying @xmath1788 for some @xmath1789 . then the function @xmath1790 is non - increasing in @xmath1791 .    since @xmath1792 , by @xmath1793 .",
    "therefore by continuity of @xmath1794 and boundedness of @xmath31 all the integrals @xmath1331 are finite . by product rule , and @xmath1795 , we have for all @xmath1784 @xmath1796 using integration by parts and product rule , the first term in is @xmath1797 p_1(x , y ) \\,dy \\,dx \\\\   & =   -\\frac{1}{2 }   \\int_m \\int_m   \\left[(\\nabla_{xy } u_k)^2   f_{k+1}(x ) + ( \\nabla_{xy } u_k ) u_k(x ) ( \\nabla_{xy}f_{k+1 } ) \\right ] p_1(x , y ) \\,dy \\,dx\\end{aligned}\\ ] ] in order to get the last equation we switch @xmath13 and @xmath184 and use the fact that @xmath135 for @xmath119-almost every @xmath1798 . to handle the second term in",
    ", we use @xmath1799 to obtain @xmath1800 for all @xmath1784 . substituting and in ,",
    "we deduce @xmath1801 the given condition ensures that @xmath1802 , that is @xmath1803 for all @xmath1784 .",
    "the following lemma essentially follow from ( * ? ? ?",
    "* proposition 2.5 ) .",
    "we repeat the proof for completeness .",
    "lemma [ l - weightfn ] provides a weight function @xmath177 that will be used in the application of discrete integral maximum principle .",
    "[ l - weightfn ] let @xmath100 be a metric measure space and let @xmath1 be a markov operator that is @xmath831-compatible with @xmath100 .",
    "let @xmath1804 be a 1-lipschitz function such that @xmath1805 .",
    "there exists a positive number @xmath1806 such that for all @xmath1807 , the weight function @xmath1808 satisfies @xmath1809 for all @xmath1810 , for all @xmath897 and @xmath1784 .",
    "note that @xmath1811 and @xmath1812 for all @xmath1784 . by the lipschitz condition and the hypothesis @xmath1813",
    ", we have @xmath1814 for all @xmath38 such that @xmath854 .",
    "next we use the following elementary inequality : if @xmath1815 , then @xmath1816 combining together the previous lines and , we obtain @xmath1817 next let us use another elementary fact : there exists @xmath1818 such that , for all @xmath1819 , @xmath1820 setting @xmath1821 , we obtain that @xmath1822 hence , if @xmath1823 ^ 2 $ ] , then the right hand side of the above inequality is bounded from above by @xmath1824 combining with and , we obtain @xmath1825 for all @xmath61 and for all @xmath1784 .    next , we need the following estimate on @xmath1781 defined in .",
    "the proof uses the diagonal estimate in proposition [ p - diag ] .",
    "[ l - hdiag ] under the assumptions of proposition [ p - gue ] , there exists @xmath1826 such that @xmath1827 for all @xmath1828 and for all @xmath61 where @xmath478 is as defined in .    by of lemma [ l - solheat ] , lemma [ l - kernel](c ) and vandermonde s convolution formula",
    ", we have @xmath1829 for all @xmath61 . by proposition [ p - diag ]",
    ", there exists @xmath466 such that @xmath1830 for all @xmath772 and for all @xmath61 .",
    "combined with and , we obtain @xmath1831 such that @xmath1832 for all @xmath1769 and all @xmath61 . by the above inequality",
    ", we have @xmath1833 where @xmath1834 . combining , along with implies .",
    "our next result involves repeated application of the discrete integral maximum principle .",
    "[ l - ed ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and [ doub - inf ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 for some @xmath850 .",
    "further assume that @xmath1 satisfies the sobolev inequality .",
    "define @xmath1835 for all @xmath122 and @xmath61 , where @xmath1836 and @xmath1781 is defined by .",
    "there exists @xmath1837 such that @xmath1838 for all @xmath61 and for all @xmath122 .",
    "let @xmath61 be an arbitrary point .",
    "the constants below do not depend on the choice of @xmath13 .",
    "define @xmath1839 for @xmath339 and @xmath129 .",
    "we start by estimating @xmath1840 using iteration .",
    "the iterative step is contained in the following estimate : there exists @xmath1841 such that @xmath1842 for all @xmath1843 satisfying @xmath1844 , for all @xmath897 and for all @xmath1784 .    to prove , we define @xmath1845 note that @xmath1846 is @xmath505-lipschitz with @xmath1847 . define @xmath1848 for all @xmath281 and all @xmath1774 , where @xmath1806 is the constant from lemma [ l - weightfn ] .",
    "since @xmath1849 in @xmath1850 , we have @xmath1851 by lemma [ l - weightfn ] and proposition [ p - imp ] , we have @xmath1852 for all @xmath1774 .",
    "since @xmath1853 in @xmath40 and @xmath1854 , we have @xmath1855 for all @xmath1784 and for all @xmath1856 .",
    "combining , and , we obtain .",
    "now by lemma [ l - hdiag ] and , there exists @xmath1857 such that @xmath1858 for all @xmath897 , for all @xmath1784 and for all @xmath1856 .",
    "next , we show that there exists @xmath1355 such that @xmath1859 for all @xmath1860 and for all @xmath1861 . by and",
    ", we have @xmath1862 if @xmath1863 .",
    "hence it suffices to consider the case @xmath1864 .    given any finite decreasing sequence @xmath1865 of real numbers and any finite strictly decreasing sequence @xmath1866 such that @xmath1867 and @xmath1868 , we can iterate and obtain @xmath1869 let @xmath1870 and define @xmath1871 so that @xmath1872 and @xmath1873 .",
    "let @xmath1874 ( note that @xmath1875 since @xmath1864 ) . by construction one has @xmath1868 .",
    "also , for all @xmath1876 we have @xmath1877 . since @xmath1878 , we have @xmath1879 which means @xmath1880 for all @xmath1881 .",
    "therefore @xmath1882 for all @xmath1881 . using and the identity @xmath1883",
    "we obtain @xmath1884 where @xmath1885 therefore by and , we have @xmath1886 by and , there exists @xmath1887 such that @xmath1888 for all @xmath1881 . therefore @xmath1889 thus setting @xmath1890",
    ", we obtain @xmath1891 for all @xmath1881 . therefore by , we have @xmath1892 for all @xmath1893 and for all @xmath122 satisfying @xmath1894 .",
    "we consider two cases .",
    "+ case 1 : let @xmath1895 in this case , by we have @xmath1896 case 2 : let @xmath1897 in this case we estimate @xmath1840 differently as @xmath1898 combining the two cases we have .    finally , we are ready to prove .",
    "define for @xmath1899 , @xmath1900 and @xmath1901 for all @xmath1902 and for all @xmath1903 the first term admits the estimate @xmath1904 now for the remaining terms we have @xmath1905 for all @xmath1906 and @xmath1907 . by @xmath1908",
    "combining with @xmath1909 for all @xmath1907 , provided @xmath1910 and @xmath1911 .",
    "define @xmath1912 then by , and we obtain , for all @xmath1870 @xmath1913 given @xmath617 choose @xmath342 so that @xmath1914 which by satisfies @xmath1870 . therefore by , we conclude @xmath1915 which is the desired estimate .",
    "we use lemma [ l - ed ] to prove a gaussian upper bound for @xmath1781 .",
    "[ l - hkbd ] under the assumptions of proposition [ p - gue ] , there exists positive reals @xmath1916 such that @xmath1917 for all @xmath38 and for all @xmath122 .    by triangle inequality and the inequality @xmath1507",
    ", we have @xmath1918 for all @xmath1919 , where @xmath1920 as before . by , and cauchy - schwarz inequality we have @xmath1921 for all @xmath38 , for all @xmath122 and for all @xmath1922 , where @xmath139 is from .",
    "the equality in the second line above follows from a calculation analogous to .",
    "the bound and lemma [ l - ed ] implies that there exists @xmath1923 such that @xmath1924 for all @xmath38 and for all @xmath122 .",
    "however by , there exists @xmath1925 such that @xmath1926 for all @xmath38 . combining and yields the desired gaussian upper bound .",
    "we want to convert the gaussian bounds on @xmath1781 given by lemma [ l - hkbd ] to gaussian bounds on @xmath138 . to accomplish this we need the following elementary polynomial identities .",
    "[ l - pol ] for all @xmath1927 and for all @xmath897 , we have the following polynomial identities @xmath1928 where @xmath1929 and @xmath1930    note that @xmath1931 for all @xmath1932 . to obtain , we expand @xmath1933 in using binomial expansion and the substitution @xmath1934    to show , we use binomial expansion on @xmath1935 and then use to obtain @xmath1936 the coefficient of @xmath1937 in is @xmath1938 similarly , the coefficient of @xmath1939 in is @xmath1940 this gives with @xmath1941 .    we are now prepared to prove gaussian upper bounds for @xmath138 .",
    "by lemma [ l - con - d ] there exists @xmath1927 such that @xmath1942 satisfy @xmath1943(y ) \\ge 0 , \\label{e - gu1 } \\\\",
    "v_{k}(x , y ) & : = \\left[(p - \\beta i)^{k } ( p_3(x , . ) - 2 \\beta p_2(x,\\cdot ) ) \\right](y ) \\ge 0 \\label{e - gu2}\\end{aligned}\\ ] ] for all @xmath38 and for all even non - negative integers @xmath251 .",
    "for instance @xmath1944 where @xmath843 is given by would satisfy the above requirements .",
    "using lemma [ l - kernel](c ) and of lemma [ l - pol ] , we have @xmath1945(y ) \\nonumber   \\\\ & = \\sum _ { k \\in { \\llbracket 1 , n \\rrbracket } , k \\text { odd } } \\binom{n}{k } \\beta^{n - k } u_{k-1}(x , y)\\nonumber \\\\ & \\hspace{4mm}+   \\sum _ { k \\in { \\llbracket 1 , n-1 \\rrbracket } , k \\text { odd } } \\binom{n-1}{k } \\beta^{n-1-k } v_{k-1}(x , y)\\end{aligned}\\ ] ] for all @xmath897 and for all @xmath38 . by , , lemma [ l - con - d ] and lemma [ l - pol ] , we have @xmath1946(y ) \\\\   & \\ge \\alpha   \\sum _ { k \\in { \\llbracket 1 , 2n \\rrbracket } , k \\text { odd } } \\binom { 2n}{k } \\left ( \\frac{1+\\beta}{2 } \\right)^{2n - k } \\left ( \\frac{1}{2 } \\right)^k u_{k-1}(x , y ) \\nonumber \\\\   & \\hspace{4 mm } + \\alpha \\sum_{1 \\le k \\le 2n-1 , k \\text { odd } } s_{2n , k } \\left ( \\frac{1+\\beta}{2 } \\right)^{2n-1-k } \\left ( \\frac{1}{2 } \\right)^{k+1 } v_{k-1}(x , y)\\end{aligned}\\ ] ] for all @xmath38 . define the ratio of coefficients in and as @xmath1947 for each @xmath1948 and for each @xmath1949 .",
    "if @xmath1950 , then @xmath1951 therefore @xmath1952 if and only if @xmath1953 . thus @xmath1954 reaches minimum for @xmath1955 . by stirling s approximation there",
    "exists constant @xmath1956 such that for all @xmath1957 , @xmath1958 we use the stirling s approximation to estimate @xmath1954 at @xmath1959 where @xmath1960 .",
    "there exists @xmath1054 such that @xmath1961 for all @xmath897 satisfying @xmath1962 .",
    "therefore there exists @xmath1963 such that @xmath1964 for all @xmath150 and for all @xmath1965 .",
    "similarly , @xmath1966 for all @xmath150 and for all @xmath1967 . combining , , , , , and , there exists @xmath1968 such that @xmath1969 for all @xmath897 , and for all @xmath38 . combining along with lemma [ l - hkbd ] yields the gaussian upper bound .",
    "we have shown the following equivalence    [ t - main2 ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 for some @xmath850",
    ". then the following are equivalent :    a.   sobolev inequality .",
    "b.   large scale volume doubling property [ doub - inf ] and gaussian upper bounds [ gue ] .    by corollary [ c - nsob ] , ( ii ) implies ( i ) .",
    "next , we assume the sobolev inequality . by proposition [ p - sobvd ]",
    "we have [ doub - inf ] .",
    "in addition , by proposition [ p - gue ] we have [ gue ] . this proves ( i )",
    "implies ( ii ) .",
    "in this chapter , we use elliptic harnack inequality and gaussian upper bounds to establish gaussian lower bounds . the proofs in this chapter",
    "is adapted from @xcite . in @xcite , hebisch and saloff - coste",
    "provide an alternate approach to prove parabolic harnack inequality using elliptic harnack inequality and gaussian upper bounds .",
    "this method avoids relying on the full strength of moser s iteration method in parabolic setting .",
    "although @xcite concerns diffusions on strictly local dirichlet spaces , we will see that their methods can be extended to discrete time markov chains on quasi - geodesic spaces .",
    "this extension was alluded to in @xcite where the authors say `` this route to the parabolic harnack inequality seems especially valuable in the setting of analysis on graphs which is not covered by the present strictly local dirichlet space framework .",
    "in fact , the results above originated from our desire to overcome some of the difficulties that appear in the case of graphs . this will be developed elsewhere . ''",
    "the main result of this chapter is the following gaussian lower bound .",
    "[ p - gle ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] , @xmath1970 and poincar inequality at scale @xmath478 [ poin - mms ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 for some @xmath850 .",
    "then the corresponding kernel @xmath138 satisfies gaussian lower bounds [ gle ] .    note",
    "that under the assumptions of proposition [ p - gle ] , we have gaussian upper bounds [ gue ] .",
    "this is a direct consequence of theorem [ t - sob ] and proposition [ p - gue ] .",
    "we focus on the case @xmath1971 just for simplicity .",
    "in fact , we expect these methods to work when @xmath1972 .",
    "however when the space has finite diameter , it is important to find optimal constants ( or close to optimal ) for various functional inequalities . to compute these optimal constants",
    ", one has to exploit the specific structure of the markov chain under consideration .",
    "we plan to address the finite diameter case in a sequel .",
    "the first step is to obtain lower bounds on @xmath1973 .",
    "it is well - known that gaussian upper bounds implies a matching diagonal lower bounds .",
    "we repeat the proof for convenience .",
    "[ l - dlb ] under the assumption of proposition [ p - gle ] , there exists @xmath1974 such that @xmath1975 for all @xmath61 and for all @xmath1769 satisfying @xmath89 .    by lemma",
    "[ l - con - d ] it suffices to prove the inequality for even @xmath705 , since there exists @xmath139 such that @xmath1976 for all @xmath61 and for all @xmath122 .",
    "let @xmath150 be even .",
    "by cauchy - schwarz inequality and lemma [ l - kernel](c ) , we have @xmath1977 for all @xmath1978 and for all @xmath1979",
    ".    by theorem [ t - sob ] and proposition [ p - gue ] we have [ gue ] . by [ gue ]",
    ", there exists @xmath149 @xmath1980 for all @xmath38 and @xmath1981 .",
    "there exists @xmath1982 such that for all @xmath1983 , we have @xmath1984 for all @xmath122 and for all @xmath61 .",
    "we used in the second line above and in the third line . by",
    ", there exists @xmath1985 such that @xmath1986 for all @xmath122 and for all @xmath61 .",
    "we choose @xmath1987 in and use and , to obtain @xmath1988 for all @xmath1979 and for all @xmath61 .",
    "the following lemma is a discrete time analog of ( * ? ? ?",
    "* lemma 3.7 ) , where we transfer the on - diagonal lower bound given by lemma [ l - dlb ] to on - diagonal lower bound for the ` dirichlet kernel ' @xmath1989 on a ball @xmath325 defined in .",
    "[ l - balldlb ] under the assumptions of proposition [ p - gle ] , there exists @xmath1990 and @xmath1991 such that @xmath1992 for all @xmath61 , for all @xmath150 with @xmath89 and for all @xmath1993    we abbreviate @xmath40 by @xmath325 . we denote the exit time from ball @xmath325 by @xmath1994 where @xmath1995 is the markov chain driven by the kernel @xmath138 .    by strong markov property",
    ", the dirichlet kernel @xmath1996 can be expressed in terms of @xmath138 as @xmath1997\\ ] ] for all @xmath89 and for all @xmath61 , where @xmath112 denotes that @xmath113 .",
    "if we choose @xmath1998 , by , we can rewrite as @xmath1999\\ ] ] for all @xmath89 and for all @xmath61 with @xmath77 satisfying @xmath1624 .",
    "for the first term in , by lemma [ l - dlb ] , there exists @xmath1054 such that @xmath2000 for all @xmath61 and for all @xmath2001 .",
    "we use gaussian upper bound [ gue ] to estimate the second term in .",
    "there exists @xmath2002 and such that @xmath2003 & \\le   \\sup_{l \\in { \\llbracket 2 , n-2 \\rrbracket } } \\sup_{y \\notin b(x , r ) } \\frac{c_1}{v(x,\\sqrt{l } ) } e^{- d(x , y)^2/(c_2 l ) } \\\\ & \\le   \\sup_{l \\in { \\llbracket 2 , n-2 \\rrbracket}}\\frac{c_1}{v(x,\\sqrt{l } ) } e^{- ( a^2 n)/(c_2 l ) } \\nonumber \\\\ \\nonumber & \\le \\frac{c_3}{v(x,\\sqrt{n } ) } \\sup_{l \\in { \\llbracket 2 , n-2 \\rrbracket } } ( n / l)^{\\delta/2 } e^{- ( a^2 n)/(c_2",
    "l ) } \\nonumber \\\\   & \\le   \\frac{c_4}{a^\\delta v(x,\\sqrt{n})}\\end{aligned}\\ ] ] for all @xmath61 , for all @xmath89 , for all @xmath2004 and for all @xmath77 with @xmath2005 . in the first line above we used , in the second line we used @xmath2006 and in the third line we used .",
    "clearly we can choose @xmath1998 large enough such that @xmath2007 .",
    "therefore by , and , we obtain the desired bound .",
    "our next result is a bound on the spectrum of @xmath970 or alternatively on the dirichlet laplacian @xmath2008 .",
    "the following proposition is a discrete time analog of ( * ? ? ?",
    "* theorem 2.5 ) .",
    "however unlike @xcite , we can not apply the stronger sobolev inequality .",
    "[ p - spec ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] and poincar inequality at scale @xmath478 [ poin - mms ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with respect to @xmath102 for some @xmath850 .",
    "then there exists positive reals @xmath2009 such that @xmath2010 for all @xmath61 and for all @xmath2011 satisfying @xmath1404 and @xmath2012 .",
    "we abbreviate the ball @xmath40 by @xmath325 .",
    "note that @xmath970 is a contraction in @xmath992 , that is @xmath2013 . since @xmath970 is a bounded , self - adjoint operator in @xmath992 , by ( * ? ? ?",
    "* proposition 2.13 ) we have @xmath2014 where @xmath2015 denotes the inner product in @xmath992 . therefore it suffices to show that there exists positive reals @xmath2009 such that @xmath2016 for all @xmath974 and for all @xmath77 with @xmath1404 and @xmath2017 .",
    "we prove in two steps .",
    "we start with the proof of upper bound in . with slight abuse of notation , we consider @xmath2018 using the map given by . by this identification , a function @xmath946 with @xmath2019 can be considered to be in @xmath992 .    by lemma [ l - dircomp - ball](a )",
    ", we can rewrite the upper bound in as @xmath2020 since @xmath2021 , in order to show it suffices to consider the case @xmath726 .    by and of proposition [ p - nash ] along with lemma [ l - comp - dir](b )",
    ", there exists @xmath1031 such that @xmath2022 for all @xmath61 , for all @xmath2023 and for all functions @xmath946 supported in @xmath40 . by",
    ", we have @xmath2024 for all @xmath61 , for all @xmath2023 , for all @xmath2025 and for all functions @xmath946 supported in @xmath40 .",
    "if @xmath726 , we have @xmath2026 hence by hlder inequality , and , there exists @xmath466 such that @xmath2027 for all @xmath726 with @xmath946 and @xmath2028 and @xmath1404 . combining and",
    ", we have @xmath2029 for all @xmath2025 , for all @xmath1404 , for all @xmath61 and for all @xmath946 with @xmath2028 and @xmath726 . by lemma [ l - rvd ]",
    ", there exists @xmath2025 such that @xmath2030 for all @xmath61 , for all @xmath1404 and all @xmath2031 . combining and",
    ", there exists @xmath2032 , @xmath1029 such that @xmath2033 for all @xmath61 , for all @xmath946 with @xmath2028 and @xmath726 , where @xmath14 satisfies @xmath1404 and @xmath2017 . by lemma [ l - comp - dir](a ) and , there exists @xmath2034 such that @xmath2035 for all @xmath61 , for all @xmath946 with @xmath2028 , where @xmath14 satisfies @xmath1404 and @xmath2017 . therefore by and , there exists @xmath2036 and @xmath2034 such that @xmath2037 for all @xmath974 and for all @xmath77 with @xmath1404 and @xmath2017 . by integration by parts and symmetry of @xmath114",
    "we have @xmath2038 \\,dy \\,dx \\\\ & \\le   \\int_m \\int_m p_1(x , y ) ( f(x)^2 + f(y)^2 ) \\ , dy \\ , dx = 2 { \\left\\lvertf\\right\\rvert}_2 ^ 2\\end{aligned}\\ ] ] for all @xmath946 . combining and",
    ", there exists @xmath2039 such that @xmath2040 for all @xmath61 , for all @xmath946 with @xmath2028 , where @xmath14 satisfies @xmath1404 and @xmath2017 .",
    "therefore by and lemma [ l - dircomp - ball](a ) , there exists @xmath2036 and @xmath2034 such that @xmath2041 for all @xmath974 and for all @xmath77 with @xmath1404 and @xmath2017 . combining and yields , which along with implies .",
    "[ r - fin ]    a.   a simple consequence of proposition [ p - spec ] is that there exists @xmath2042 such that @xmath2043 , \\hspace{4 mm }   { \\operatorname{spectrum}}(\\delta_{p_b } ) \\subseteq \\left [ a r^{-2 } , 2 - ar^{-2 } \\right]\\ ] ] for all @xmath61 and for all @xmath14 satisfying @xmath1404 and @xmath2012 .",
    "b.   if @xmath1970 , then for all balls @xmath77 with @xmath105 , we have @xmath2044 the case @xmath1404 is clear from proposition [ p - spec ] . the case @xmath2045 follows from @xmath2046 . c.",
    "note that if @xmath1972 , then the conclusion proposition [ p - spec ] is vacuously true as one can choose @xmath2047 .",
    "however if @xmath2048 and if we have good control of the constants in various functional inequalities , we can prove useful estimates which in turn yields applications to estimates on mixing times . we will extend the techniques developed here to finite diameter spaces elsewhere .",
    "d.   note that the condition @xmath2017 is necessary .",
    "too see this consider the case when @xmath1972 and @xmath2049 .",
    "it is clear that fails to be true because @xmath2050 .      as in (",
    "* proposition 3.5 ) , the following near diagonal estimate is an important step in obtaining gaussian lower bounds .",
    "[ p - ndlb ] under the same assumptions as in proposition [ p - gle ] , there exists positive reals @xmath2051 such that @xmath138 satisfies the lower bound @xmath2052 for all @xmath61 and for all @xmath122 satisfying @xmath772 .    from the above near diagonal lower bound",
    ", we will see that the gaussian lower bound follows by a well - established ` chaining argument ' .",
    "the idea behind the proof of proposition [ p - ndlb ] is to convert the elliptic hlder - like regularity estimate ( proposition [ p - holder ] ) into a parabolic hlder - like regularity estimate for the function @xmath2053 as follows :    [ l - crl ] under the assumptions of proposition [ p - gle ] , for all @xmath2054 and all @xmath2055 , there exists three positive reals @xmath2056 , @xmath2057 and @xmath2058 such that @xmath2059 \\frac{1 } { v(x,\\sqrt{k})}\\ ] ] for all @xmath61 , @xmath617 with @xmath2060 and for all @xmath2061 , where @xmath2062 and @xmath843 is the exponent in .",
    "the proof of lemma [ l - crl ] is long and involves many technical estimates .",
    "we will need some upper bounds on @xmath2063 and its ` time derivative ' @xmath2064 for all @xmath2065 .",
    "[ l - tech ] under the assumptions of proposition [ p - gle ] , the following estimates hold :    a.   there exists @xmath2066 such that @xmath2067 for all @xmath61 , for all @xmath122 , for all @xmath2068 , for all @xmath2055 and for all @xmath2069 .",
    "b.   there exists @xmath2070 such that @xmath2071 for all @xmath61 , for all @xmath2072 , for all @xmath2055 and for all @xmath2069 . c.   for all @xmath2073 , there exists @xmath2074 , such that for all @xmath2075 , there exists @xmath2076 such that , @xmath2077 for all @xmath61 , for all @xmath122 , for all @xmath2078 satisfying @xmath2079 and for all @xmath2069 .",
    "the first inequality follows from proposition [ p - gue ] and the inequality @xmath2080 for all @xmath2068 .    for @xmath2081",
    ", we decompose @xmath2082 such that @xmath2083 , @xmath2084 and @xmath2085 for @xmath2086 .",
    "note that , we require @xmath2087 to be even .",
    "we abbreviate @xmath2088 by @xmath325 . by cauchy - schwarz inequality and lemma [ l - dircomp - ball ] and lemma [ l - comp - dir](b )",
    "there exists @xmath1044 such that @xmath2089^{1/2 } \\\\   & \\le c_4 \\left [ \\mathcal{e}^b _ * ( p_{k_1+k_2}^b(y,\\cdot ) , p_{k_1+k_2}^b(y,\\cdot)),\\mathcal{e}^b _ * ( p_{k_3+k_4}^b(z,\\cdot),p_{k_3+k_4}^b(z,\\cdot))\\right]^{1/2}.\\end{aligned}\\ ] ] since @xmath2090 is even and @xmath2091 , by spectral decomposition and proposition [ p - gue ] there exists @xmath2092 such that @xmath2093 } ( 1 - \\lambda)^{1/2 } \\lambda^{k/10 } \\right)^2   \\sup_{y \\in b}p_{2k_2}(y , y ) \\\\",
    "\\nonumber & \\le   c_5 k^{-1 } \\sup_{y \\in b(x , a\\sqrt{k } ) } \\frac{1}{v(y,\\sqrt{k } ) }   \\\\ \\nonumber & \\le \\frac{c_5}{k v(x,\\sqrt{k } ) } \\sup_{y \\in b(x , a\\sqrt{k } ) } \\frac{v(y,(a+1)\\sqrt{k})}{v(y,\\sqrt{k})}\\\\ & \\le \\frac{c_6}{k v(x,\\sqrt{k})}\\end{aligned}\\ ] ] for all @xmath2081 , for all @xmath61 , for all @xmath2094 and for all @xmath2095 . in the last line above we used . by and",
    ", we obtain the desired bound for @xmath2081 .",
    "if @xmath2096 , we use and triangle inequality @xmath2097 to obtain .    for the proof of , we use proposition [ p - spec ] . as before we denote @xmath2098 by @xmath325 .",
    "we first consider the case where @xmath1907 is even . by proposition [ p - spec ] ,",
    "for each @xmath2099 , there exists @xmath2100 such that @xmath2101 for all @xmath61 , for all @xmath2102 , for all @xmath122 .",
    "we choose @xmath2103 in and use to obtain positive reals @xmath2104 and @xmath2105 @xmath2106 for all @xmath61 , for all @xmath2075 , for all @xmath2055 and for all @xmath122 where @xmath2107 . for all @xmath2075 ,",
    "there exists @xmath2108 such that @xmath2109 for all @xmath122 , for all @xmath2110 . combining , and ,",
    "we obtain the bound for all even @xmath2111 .",
    "for all odd @xmath2112 satisfying @xmath2113 , we use the even case and the bound @xmath2114 to obtain .",
    "the constants @xmath2115 and @xmath1710 in lemma [ l - tech ] do not depend on @xmath317 , @xmath13 and @xmath251 .",
    "one of the consequences of proposition [ p - spec ] as noted in remark [ r - fin](b ) is that @xmath2116 for all @xmath61 and for all @xmath105 .",
    "therefore @xmath2117 is invertible with inverse @xmath2118 further the inverse @xmath2119 is bounded with @xmath2120 .",
    "motivated by this remark , we define ` green s function on a ball ' @xmath2121 for all balls @xmath325 with @xmath2122 and for all @xmath2123 . by and @xmath2124 ( z )",
    "= \\left [ \\delta_{p_b}^{-1 } \\partial_k p^b(y,\\cdot)\\right ] ( z ) \\nonumber \\\\   & = \\partial_k p^b(y , z ) + \\int_b g^b(z , w)\\partial_k p^b(y , w ) \\ , dw\\end{aligned}\\ ] ] for all @xmath61 , for all @xmath2110 , for all @xmath2125 and for all @xmath772 . by and",
    "triangle inequality , we obtain @xmath2126 for all @xmath61 , for all @xmath2055 , and for all @xmath2095 . we write the right side in by splitting it into four parts as @xmath2127 where @xmath2128 are terms corresponding to the integration over the sets @xmath2129 for @xmath2130 and @xmath2131 for @xmath423 , where @xmath2132 will be chosen later .    as before , we will abbreviate @xmath2133 by @xmath325 . by lemma [ l - tech](b )",
    ", there exists @xmath927 , @xmath2134 such that @xmath2135 for all @xmath2136 , for all @xmath2137 , for all @xmath61 and for all @xmath122 satisfying @xmath772 and @xmath2138 .",
    "next , we bound @xmath2139 and @xmath2140 .",
    "we treat @xmath2140 in detail but the same estimate applies to @xmath2139 . by lemma [ l - tech](b ) , we have @xmath2141 for all @xmath772 . by lemma [ l - tech](c )",
    ", there exists @xmath2142 , @xmath2143 such that @xmath2144 for all @xmath61 , for all @xmath2145 , for all @xmath2075 , for all @xmath122 with @xmath2146 and for all @xmath2147 . for all @xmath2148 , by lemma [ l - rvd ] and",
    "there exists @xmath2149 such that @xmath2150 for all @xmath61 , for all @xmath2055 , for all @xmath2148 , for all @xmath141 and for all @xmath122 with @xmath2151 .    for all @xmath2152 ,",
    "we choose @xmath2075 and @xmath141 such that @xmath2153 given the above choice of @xmath2154 , for all @xmath2152 , for all @xmath2110 , by , , there exists @xmath2155 such that @xmath2156 for all @xmath61 and for all @xmath122 with @xmath2157 . by and , for all @xmath2158 there exists @xmath2159 and @xmath141 such that @xmath2160 for all @xmath61 and for all @xmath122 with @xmath2161 .",
    "it remains to handle @xmath423 .",
    "for the rest of the proof , we fix the choice of @xmath141 from . since @xmath2162 is only defined up to @xmath102-almost everywhere ,",
    "so is @xmath2163 .",
    "however since @xmath2164 is a genuine function for all @xmath2068 , by we can redefine @xmath2165 in as @xmath2166 for all @xmath2065 with @xmath2167 . in other words @xmath2168 can be defined as a genuine function in @xmath2169 with @xmath2170 for all @xmath2065 with @xmath2167 .",
    "further the function @xmath2171 is @xmath1-harmonic in @xmath2172 , whenever @xmath2123 , @xmath2173 and @xmath2174 .",
    "therefore for all @xmath61 , for all @xmath2055 and for all @xmath122 with @xmath2175 , for all @xmath2176 , the function @xmath2177 is @xmath1-harmonic in @xmath2178 . by the hlder - type regularity estimate for harmonic functions ( proposition [ p - holder ] ) , there exists @xmath2179 such that @xmath2180 for all @xmath61 , for all @xmath2181 , for all @xmath2055 , @xmath2176 and for all @xmath122 with @xmath2182 .",
    "following , we need to estimate @xmath2183 . for all @xmath2184 such that @xmath2185",
    ", we have @xmath2186 for the first term , by lemma [ l - tech](a ) and there exists @xmath2187 and @xmath2104 such that @xmath2188 for all @xmath2189 , for all @xmath2190 such that @xmath2191 . to obtain above",
    ", we used that the function @xmath2192 is bounded in @xmath2193 .",
    "next , we bound @xmath2194 for large values of @xmath1321 . by lemma [ l - tech](c )",
    "there exists @xmath1543 such that @xmath2195 for all @xmath122 , @xmath2055 , for all @xmath61 and for all @xmath2196 .",
    "combining , , along with lemma [ l - tech](b ) and , for each @xmath2055 and any choice of @xmath141 , there exists @xmath2197 , @xmath2198 , @xmath2199 ( depending on @xmath2200 ) and @xmath139 such that @xmath2201 for all @xmath61 , for all @xmath2181 and for all @xmath122 satisfying @xmath2202 , where @xmath2062 and @xmath843 is as in . combining and , we obtain the desired estimate .",
    "now , we are ready to prove the near diagonal lower bound using lemma [ l - crl ] and lemma [ l - balldlb ] .    by lemma [ l - balldlb ] , there exists @xmath2110 and @xmath878 such that @xmath2203 for all @xmath61 and for all @xmath122 with @xmath2204 . by lemma [ l - crl ]",
    ", there exists @xmath2205 , @xmath2206 such that @xmath2207 \\frac{1 } { v(x,\\sqrt{k})}\\ ] ] for all @xmath61 , for all @xmath122 with @xmath2060 , for all @xmath2208 where @xmath2062 .",
    "next , we choose @xmath2209 and @xmath2210 such that for all @xmath2157 , we have @xmath2211 by the above choice of @xmath2212 along with , and the triangle inequality , we have @xmath2213 for all @xmath61 and for all @xmath122 with @xmath2157 .",
    "since @xmath2214 , the above equation yields the desired near diagonal lower bound for all @xmath2215 .",
    "if @xmath2216 , then we reduce @xmath312 if necessary so that @xmath2217",
    ". hence @xmath2218 and @xmath2219 implies @xmath2220 .",
    "therefore by of lemma [ l - con - d ] and , we obtain for all @xmath2216 .",
    "the near diagonal lower bound of proposition [ p - ndlb ] can be easily upgraded to full gaussian lower bounds [ gle ] by a well - known chaining argument ( see ( * ? ? ?",
    "* theorem 5.1 ) , ( * ? ? ?",
    "* theorem 3.8 ) ) .",
    "for general quasi - geodesic spaces , we rely on the chain lemma ( lemma [ l - chain ] ) .",
    "we now prove the main result of this chapter , i.e. gaussian lower bound .    by lemma [ l - chain ]",
    "there exists @xmath1857 such that for all @xmath213 and for all @xmath38 , there exists a @xmath212-chain @xmath218 with @xmath2221 by proposition [ p - ndlb ] , there exists @xmath2222 such that @xmath2223 for all @xmath61 and for all @xmath772 . if @xmath2224 then there exists a @xmath284-chain @xmath218 between @xmath13 and @xmath184 with @xmath2225 however holds whenever @xmath2226 and @xmath2227 . if @xmath467 and @xmath2228 , we have @xmath2229 if @xmath2230 and @xmath2231 , we have @xmath2232 we fix @xmath2233 , so that , and are satisfied .",
    "we will fix @xmath467 later .",
    "we will require @xmath2234 for all @xmath2235 and for all @xmath2236 .",
    "we fix @xmath2237 , so that by we deduce @xmath2238 for all @xmath38 and @xmath122 such that @xmath2228 and @xmath2239 , where @xmath2240 is as defined in and .",
    "define @xmath2241 such that @xmath2242 satisfying @xmath2243 . consider the @xmath284-chain @xmath2244 between @xmath13 and @xmath184 where @xmath2240 are given by , . by and definition of @xmath2245 , for all @xmath2246 , for @xmath2235 we have @xmath2247 therefore by , and , there exists @xmath2248 such that for all for @xmath2235 , @xmath2246 , we have @xmath2249 for all @xmath38 , @xmath772 satisfying @xmath2228 and @xmath2226 .",
    "define @xmath2250 . by chapman - kolmogorov equation and , for all @xmath38 ,",
    "@xmath772 satisfying @xmath2228 and @xmath2226 , we obtain @xmath2251 by , , and , there exists @xmath2252 such that @xmath2253 for all @xmath38 , @xmath772 satisfying @xmath2228 and @xmath2226 .",
    "this yields [ gle ] for the case @xmath2228 .",
    "the case @xmath2218 follows from .",
    "this completes the proof of [ gle ] .",
    "in this chapter , we use the two sided gaussian estimates on the heat kernel to prove parabolic harnack inequality .",
    "moreover , we show the necessity of poincar inequality and large scale volume doubling using parabolic harnack inequality .",
    "based on ideas of nash @xcite , fabes and stroock @xcite gave a proof of parabolic harnack inequality using gaussian bounds on the heat kernel for uniformly elliptic operators on @xmath3 .",
    "this idea of using gaussian estimates on the heat kernel to prove parabolic harnack inequality was extended in various settings @xcite .",
    "delmotte @xcite introduced a discrete version of balayage formula to prove parabolic harnack inequality on graphs .",
    "we use a direct adaptation of delmotte s method to prove parabolic harnack inequality .",
    "recall that we defined caloric function as solutions to the discrete time heat equation @xmath2254 in definition [ d - caloric ] .",
    "we introduce the parabolic harnack inequality for non - negative caloric functions .",
    "[ d - phi ] let @xmath100 be a metric measure space and let @xmath1 be a markov operator on @xmath100 .",
    "let @xmath2255 and @xmath2256 .",
    "we that a @xmath102-symmetric markov operator @xmath1 ( or equivalently its heat kernel @xmath138 ) on @xmath100 satisfies the discrete - time parabolic harnack inequality @xmath2257 if there exists positive reals @xmath2258 such that for all @xmath2259 with @xmath2260 and every non - negative @xmath1-caloric function @xmath1613 on @xmath2261 we have @xmath2262 where @xmath2263    [ r - phi ]    a.   the exact values of the constants @xmath2264 and @xmath2265 are unimportant . for example , for graphs and length spaces",
    "if the parabolic harnack inequality is satisfied for one set of constants , then it is satisfied for every other set of constants . the argument in ( * ? ? ?",
    "* proposition 5.2(iv ) ) can be adapted for graphs and length spaces in the above discrete - time setting .",
    "b.   it suffices to consider the case @xmath2266 in the definition above by simply by shifting the function in the time component . c.   analogous to remark [ r - caloric](b ) ,",
    "if @xmath1 is @xmath831-compatible with @xmath100 we may only require the function @xmath31 to be defined on a smaller domain .      in this section ,",
    "we prove the following parabolic harnack inequality using two sided gaussian bounds .",
    "[ p - phi ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath138 that is weakly @xmath831-compatible with respect to @xmath102 for some @xmath508 .",
    "moreover , suppose that @xmath138 satisfies two sided gaussian estimate @xmath891 .",
    "then there exists @xmath141 such that @xmath1 satisfies the parabolic harnack inequality .",
    "first we start by verifying that gaussian lower bound implies large scale volume doubling property .",
    "[ l - gevd ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath138 that satisfies [ gle ] .",
    "then @xmath100 satisfies [ doub - inf ] .    by [ gle ]",
    "there exists @xmath152 such that @xmath2267 for all @xmath38 satisfying @xmath153 and for all @xmath150 .",
    "therefore there exists @xmath2268 such that @xmath2269 for all @xmath2270 . by the gaussian lower bound above @xmath2271 for all @xmath61 and for all @xmath2270 .",
    "therefore there exists @xmath2272 such that for all @xmath61 and for all @xmath368 , we have @xmath2273    we show the following near diagonal lower bounds as a consequence of two sided gaussian bound .    [ l - ndlb ] under the assumptions of proposition [ p - phi ] , there exists @xmath1054 , @xmath141 and @xmath2274 such that for all @xmath61 , for all @xmath2275 , for all @xmath2276 , for all @xmath122 satisfying @xmath2277 , we have @xmath2278    we abbreviate @xmath40 by @xmath325 .",
    "we denote the exit time from ball @xmath325 by @xmath2279 where @xmath106 is the markov chain on @xmath107 corresponding to the kernel @xmath138 .    by strong markov property and @xmath102-symmetry ,",
    "the dirichlet kernel @xmath2280 can be expressed in terms of @xmath138 as @xmath2281\\ ] ] for all @xmath89 and for all @xmath61 , where @xmath2282 denotes that the markov chain starts at @xmath2283 .",
    "we choose @xmath2284 , so that by @xmath2285   =   { \\mathbb{e}}_y \\left [ p_{k-\\tau}(z , x_\\tau ) { \\mathbf{1}}_{{\\llbracket 2 , k-2 \\rrbracket}}(\\tau)\\right]\\ ] ] for all @xmath2286 , for all @xmath772 , for all @xmath61 and for all @xmath2011 with @xmath2275 . combining this with and @xmath2287",
    ", we have @xmath2288 for all @xmath2286 , for all @xmath772 , for all @xmath61 and for all @xmath2011 with @xmath2289 .",
    "note that by lemma [ l - gevd ] we have [ doub - inf ] .",
    "therefore by [ gle ] , and @xmath2290 , there exists @xmath2291 and @xmath2292 such that @xmath2293 for all @xmath61 , for all @xmath2294 , for all @xmath141 , for all @xmath2286 and for all @xmath122 satisfying @xmath2295 .    for the second term in by [ gue ] , there exists @xmath466 such that @xmath2296 for all @xmath852 with @xmath2297 , for all @xmath61 , for all @xmath63 , for all @xmath141 , for all @xmath2298 and for all @xmath2299 .",
    "combined this with and @xmath2300 , there exists @xmath2301 such that for all @xmath2302 , for all @xmath61 , for all @xmath2298 , for all @xmath122 satisfying @xmath2303 , for all @xmath2304 and for all @xmath2299 , we have @xmath2305 the second line above follows from @xmath2306 and and the last line follows from the fact the function @xmath2307 is bounded in @xmath2193 . combining , and",
    ", there exists @xmath1054 and @xmath2308 such that @xmath2280 satisfies .",
    "the following lemma provides a discrete time version of balayage decomposition for the heat equation .",
    "[ l - balay ]",
    "let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath138 that is weakly @xmath831-compatible with respect to @xmath102 for some @xmath508 .",
    "then for all @xmath61 , for all @xmath1636 , for all @xmath1670 such that @xmath2309 , for all @xmath1594 , for all non - negative function @xmath2310 that is @xmath1-caloric in @xmath1598 , there exists a non - negative function @xmath2311 ( depending on @xmath31 ) such that @xmath2312 and for all @xmath2313 and for all @xmath2314 , we have @xmath2315 where @xmath77 .",
    "denote by @xmath2316 and @xmath77 .",
    "define @xmath2317 for all @xmath2318 .",
    "note that @xmath2319 is @xmath1-caloric in @xmath2320 .",
    "since @xmath1432 , by we have @xmath2321 for all @xmath2313 and by maximum principle @xmath2322 in @xmath2323 .",
    "next , we construct @xmath2324 iteratively .",
    "we assume that @xmath2312 .",
    "define @xmath2325 for all @xmath2326 .",
    "since @xmath2327 is a difference of two @xmath1-caloric functions , we have @xmath2327 is @xmath1-caloric in @xmath2328 .",
    "we repeat this construction iteratively by defining @xmath2329 for all @xmath2330 and @xmath2331 for all @xmath2332 and @xmath2333 . by the same argument as above",
    ", @xmath2334 is non - negative and caloric in @xmath2335 for all @xmath2336 .",
    "further @xmath2337 for all @xmath920 in @xmath2338 and @xmath2339 . combining , and gives .",
    "we are now ready to prove the parabolic harnack inequality .",
    "let @xmath141 be as given by lemma [ l - ndlb ] .",
    "note that for all @xmath2340 , we have @xmath2341 .",
    "moreover for all @xmath2340 , for all @xmath2342 and for all @xmath2343 we have @xmath2344 .",
    "let @xmath2345 where @xmath2346 is the constant from lemma [ l - ndlb ] . by the above remarks , and lemma [ l - balay ] , for all @xmath61 , for all @xmath2294 , for all non - negative function @xmath31 that is @xmath1-caloric in @xmath2347 where @xmath77 , there exists a non - negative function @xmath2348 supported in @xmath2349 such that @xmath2350 for all @xmath2351 .",
    "for some fixed @xmath61 and @xmath2352 , we define @xmath2353 and @xmath2354 .    by lemma [ l - gevd ]",
    "we have [ doub - inf ] . therefore by lemma [ l - ndlb ] and there exists @xmath2355 such that for all @xmath61 , for all @xmath2294 , for all @xmath2342 , for all @xmath2298 , we have @xmath2356 similarly by lemma [ l - ndlb ] for all @xmath61 , for all @xmath2294 , for all @xmath2342 , for all @xmath2357 , for all @xmath2358 we have @xmath2359    for upper bounds in @xmath2360 we simply use [ gue ] as follows . by [ gue ] and",
    ", there exists @xmath149 such that for all @xmath61 , for all @xmath2294 , for all @xmath2342 , for all @xmath2298 we have @xmath2361 similarly by [ gue ] and , there exists @xmath2362 such that for all @xmath61 , for all @xmath2294 , for all @xmath2342 , for all @xmath2357 , for all @xmath2363 and for all @xmath2364 we have @xmath2365 the last line follows from the fact that the function @xmath2366 is bounded in @xmath2193 along with .    combining the inequalities , , and along with the balayage formula for all @xmath61 , for all @xmath2294 , for all non - negative function @xmath31 that is @xmath1-caloric in @xmath2367 , we have @xmath2368 where @xmath2369 are as defined in .",
    "note that by remark [ r - phi](ii ) , we have the desired harnack inequality .      in the previous sections , we have obtain two - sided gaussian bounds on the heat kernel and parabolic harnack inequality assuming large scale volume doubling and a poincar inequality .",
    "now we show that large scale volume doubling and poincar inequality are necessary to have two - sided gaussian bounds on the heat kernel and parabolic harnack inequality .",
    "the was first proved by saloff - coste in ( * ? ? ?",
    "* theorem 3.1 ) using an argument due to kusuoka and stroock @xcite.delmotte @xcite followed the same strategy in discrete - time setting for random walk on graphs .",
    "the following is an adaptation of the argument in @xcite .",
    "[ p - phi - vd ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] .",
    "suppose that a markov operator @xmath1 has a kernel @xmath138 that is weakly @xmath831-compatible with respect to @xmath102 for some @xmath508 and there exists @xmath141 such that @xmath1 satisfies the parabolic harnack inequality .",
    "then @xmath100 satisfies [ doub - inf ] and .",
    "let @xmath61 and @xmath63 .",
    "define @xmath2370 as @xmath2371 note that @xmath31 is non - negative and @xmath31-caloric in @xmath2372 . for @xmath122 ,",
    "we choose @xmath14 such that @xmath2373 . by applying to the function @xmath31",
    ", there exists @xmath2374 such that @xmath2375 for all @xmath61 , for all @xmath122 with @xmath2157 . squaring and applying cauchy - schwarz inequality",
    "we obtain @xmath2376 for all @xmath61 and for all @xmath122 satisfying @xmath2157 .",
    "therefore @xmath2377 for all @xmath61 and for all @xmath122 satisfying @xmath2157 .",
    "next we apply to the non - negative , @xmath1-caloric function @xmath2378 on @xmath2379 where @xmath14 is chosen such that @xmath2380",
    ". then there exists @xmath2381 such that for all @xmath2157 , we have @xmath2382 for all @xmath61 , for all @xmath2161 and for all @xmath2383 . integrating over @xmath2384",
    ", we obtain @xmath2385 for all @xmath61 , for all @xmath2161 .",
    "iterating with @xmath2386 , we obtain @xmath2387 for all @xmath61 , for all @xmath2161 and for all @xmath2388 . combining , , along with @xmath2389",
    ", we obtain @xmath2390 for all @xmath2388 , for all @xmath61 and for all @xmath129 satisfying @xmath2161 .",
    "next we choose @xmath391 such that @xmath2391 so that there exists @xmath1857 such that @xmath2392 for all @xmath61 and for all @xmath129 satisfying @xmath2161 .",
    "therefore there exists @xmath2292 such that for all @xmath2393 and for all @xmath61 we have @xmath2394 this completes the proof of [ doub - inf ] .",
    "it remains to prove the poincar inequality @xmath2395 .",
    "we start by showing a near diagonal lower bound for the ` dirichlet kernel ' @xmath2396 .    by applied to the function @xmath2397 that is @xmath1-caloric on @xmath2398 , we have @xmath2399 for all @xmath2161 and for all @xmath61 .",
    "similarly by applied to the function @xmath2400 that is @xmath1-caloric on @xmath2398 , we have @xmath2401 for all @xmath2161 , for all @xmath61 and for all @xmath2402 . combining , , and there exists @xmath1054 such that",
    "for all @xmath61 and for all @xmath122 satisfying @xmath2161 , we have @xmath2403 for a ball @xmath2404 , we define a markov operator @xmath2405 for all @xmath2123 and for all functions @xmath177 on @xmath325 .",
    "note that unlike @xmath970 , the operator @xmath2406 is conservative , that is @xmath2407 for the rest of the this proof we abbreviate @xmath2408 by @xmath325 . by for all @xmath2409",
    "satisfying @xmath2161 and for all @xmath2402 , we have @xmath2410(y ) & \\ge p_b^{4k } \\left [ f- q_b^{4k}f(y)\\right](y ) \\\\   & \\ge \\int_{b(x,\\sqrt{k}/2)}\\left(f(z ) -q_b^{4k}f(y ) \\right)^2 p_b^{4k}(y , z ) \\ , dz \\nonumber \\\\ & \\ge \\frac{c_1}{v(x,\\sqrt{k})}\\int_{b(x,\\sqrt{k}/2)}\\left(f(z ) -q_b^{4k}f(y ) \\right)^2   \\ , dz \\nonumber \\\\ &",
    "\\ge \\frac{c_1}{v(x,\\sqrt{k})}\\int_{b(x,\\sqrt{k}/2)}\\left(f(z ) -f_{b(x,\\sqrt{k}/2 ) } \\right)^2   \\ , dz.\\end{aligned}\\ ] ] the first line above follows from @xmath2411 for all @xmath2412 , the third line above follows from and the last line above follows from the fact that mean minimizes square error . by along with there",
    "exists @xmath1963 such that for all @xmath61 and for all @xmath122 , we have @xmath2413(y ) \\ , dy & \\ge \\int_{b(x,\\sqrt{k}/2 ) } q_b^{4k } \\left [ f - q_b^{4k}f(y ) \\right](y ) \\ , dy \\\\   & \\ge c_2 \\int_{b(x,\\sqrt{k}/2)}\\left(f(z ) -f_{b(x,\\sqrt{k}/2 ) } \\right)^2   \\ , dz\\end{aligned}\\ ] ] where @xmath2409 .    by linearity of the operator @xmath2414",
    ", we have @xmath2415 ^ 2(y ) = \\left(q_b^{4k } f^2 \\right ) ( y ) -   \\left ( q_b^{4k}f(y)\\right)^2\\ ] ] therefore by the symmetry of the operator @xmath2406 and @xmath2416 , we have @xmath2417 ^ 2(y ) \\ , dy&= \\langle { \\mathbf{1}}_b , q_b^{4k } f^2 \\rangle_{l^2(b ) } - { \\left\\lvertq_b^{4k}f\\right\\rvert}_{l^2(b)}^2 \\nonumber \\\\   & = \\langle q_b^{4k}{\\mathbf{1}}_b ,   f^2 \\rangle_{l^2(b ) } - { \\left\\lvertq_b^{4k}f\\right\\rvert}_{l^2(b)}^2 \\nonumber \\\\   & =   { \\left\\lvertf\\right\\rvert}_{l^2(b)}^2   -   { \\left\\lvertq_b^{4k}f\\right\\rvert}_{l^2(b)}^2 \\nonumber \\\\   & = \\sum_{l=0}^{4k-1 } \\left ( { \\left\\lvertq_b^l f\\right\\rvert}_{l^2(b)}^2- { \\left\\lvertq_b^{l+1 } f\\right\\rvert}_{l^2(b)}^2 \\right).\\end{aligned}\\ ] ] the identity @xmath2418 along with the fact that @xmath2406 is a contraction in @xmath472 yields @xmath2419 for all @xmath2388 . combining and",
    ", we obtain @xmath2420 ^ 2(y )   \\,dy \\le 4 k \\left ( { \\left\\lvertf\\right\\rvert}_{l^2(b)}^2 - { \\left\\lvertq_b f\\right\\rvert}_{l^2(b)}^2 \\right ) .\\ ] ] using the inequality @xmath2421 , we have @xmath2422 combining , and , for all @xmath61 , for all @xmath122 with @xmath2161 and for all @xmath946 , we have @xmath2423 where @xmath2409",
    ". therefore there exists @xmath339,@xmath149 such that for all @xmath61 , for all @xmath2424 and for all @xmath946 , we have @xmath2425 by and , we have the desired poincar inequality @xmath2395 .",
    "we now have all the ingredients to prove our main result in a slightly weaker form .",
    "[ p - main1 ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and @xmath2426 .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 with either @xmath2427 or @xmath2428",
    ". then the following are equivalent :    a.   parabolic harnack inequality : there exists @xmath141 such that @xmath1 satisfies .",
    "b.   gaussian bounds on the heat kernel : the heat kernel @xmath138 satisfies . c.   the conjunction of large scale volume doubling property [ doub - inf ] and poincar inequality [ poin - mms ] .    the implication `` ( iii ) implies ( ii ) '' follows from theorem [ t - sob ] , proposition [ p - gue ] and proposition [ p - gle ] .",
    "( ii ) implies ( i ) follows from proposition [ p - phi ] .",
    "( i ) implies ( iii ) follows from proposition [ p - phi - vd ] and corollary [ c - allscales ] .",
    "next , we answer the question raised in remark [ r - pscale ] .",
    "[ p - pscale ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] , [ doub - inf ] , for some @xmath2429 and @xmath2426 .",
    "then @xmath100 satisfies [ poin - mms ] for all @xmath507 .    by lemma [ l - largesc ]",
    "it suffices to consider the case @xmath2430 .",
    "consider the markov chain with density @xmath2431 that is symmetric with respect to the measure @xmath2432 , where @xmath2433 by [ doub - loc ] , there exists @xmath466 such that @xmath2434 for all @xmath61 .",
    "therefore the space @xmath2435 satisfies [ doub - loc ] , [ doub - inf ] , for some @xmath2429 .",
    "moreover by , @xmath170 is weakly @xmath841-compatible with @xmath2435 . by the same argument as lemma [ l - wscompat ] , there exists @xmath2436 such that @xmath390 is @xmath2437 compatible with @xmath2435",
    ". therefore by proposition [ p - main1 ] and lemma [ l - gausscompare ] the kernel @xmath138 satisfies .",
    "the poincar inequality [ poin - mms ] for @xmath2435 then follows from propositions [ p - phi ] and [ p - phi - vd ] . an easy comparison argument using gives [ poin - mms ] for @xmath100 .",
    "the following is the main result of our work .",
    "[ t - main1 ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and @xmath2426 .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is @xmath831-compatible with @xmath100 , where @xmath2438",
    ". then the following are equivalent :    a.   parabolic harnack inequality : there exists @xmath141 such that @xmath1 satisfies . b.   gaussian bounds on the heat kernel : the heat kernel @xmath138 satisfies . c.   the conjunction of large scale volume doubling property [ doub - inf ] and poincar inequality [ poin - mms ] .",
    "combining propositions [ p - main1 ] , [ p - phi - vd ] and [ p - pscale ] yields the desired result .    as announced in the introduction",
    ", we will show theorem [ t - main0 ] and theorem [ t - del ] are covered by our results .",
    "theorem [ t - del ] is clearly a special case of theorem [ t - main1 ] .",
    "so it remains to verify theorem [ t - main0 ] .",
    "we need only to check the implication ( c ) implies ( b ) as the other implications follow as in theorem [ t - main1 ] . although @xmath114 is only weakly @xmath831-compatible to @xmath100 , by lemma [ l - wscompat ] , theorem [ t - main1 ] and lemma [ l - gausscompare ] , we have that @xmath138 satisfies .",
    "perhaps the most important application of the characterization of parabolic harnack inequality and gaussian bounds on the heat kernel is the stability under quasi - isometries .",
    "let @xmath331 be a quasi-@xmath678-geodesic metric measure spaces satisfying [ doub - loc ] and @xmath2439 , for @xmath332 .",
    "moreover we assume that @xmath2440 and @xmath337 are quasi - isometric metric measure spaces .",
    "suppose that a markov operator @xmath2441 has a kernel that is @xmath2442-compatible with @xmath331 with @xmath2443 for @xmath332 . then    a.   the kernel corresponding to @xmath2444 satisfies if and only if the kernel corresponding to @xmath2445 satisfies .",
    "b.   the operator @xmath2444 satisfies the harnack inequality for some @xmath141 if and only if @xmath2445 satisfies for some @xmath2264 .",
    "the is a direct consequence of theorem [ t - main1 ] along with stability of [ doub - inf ] given by proposition [ p - qivd ] , stability of [ poin - mms ] given by proposition [ p - robustmms ] , proposition [ p - pscale ] and lemma [ l - largesc ] .    as mentioned in the introduction",
    ", it is a long standing open problem to prove such a stability result for elliptic harnack inequality .",
    "a partial result in this direction is obtained by bass . in @xcite , bass proves stability of elliptic harnack inequality for weighted graphs under bounded perturbation of the conductances .",
    "however the weighted graphs were assumed to be transient and they satisfy certain regularity hypotheses . in @xcite , barlow introduced the _ dumbbell condition _ that is stable under bounded perturbation of weights of a weighted graph and asks if the dumbbell condition is equivalent to elliptic harnack inequality .",
    "recall that we proved an elliptic hlder regularity estimate for @xmath1-harmonic functions in proposition [ p - holder ] and we used the regularity in the proof of gaussian lower bounds ( lemma [ l - crl ] ) .",
    "there is an analogous parabolic hlder regularity estimate which follows from parabolic harnack inequality .",
    "the proof is similar , for example the proof given in ( * ? ? ?",
    "* theorem 5.4.7 ) can be adapted for the present setting .",
    "such parabolic hlder continuity estimates were first obtained by nash @xcite .",
    "let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and @xmath2426 .",
    "suppose that a markov operator @xmath1 has a kernel @xmath170 that is weakly @xmath831-compatible with @xmath100 and satisfies parabolic harnack inequality for some @xmath141 .",
    "then there exists @xmath39 , @xmath339 and @xmath139 such that for all @xmath61 , for all @xmath2424 and for any non - negative function @xmath1596 that is @xmath1-caloric in @xmath2446 , we have the regularity estimate @xmath2447    note that we do not obtain continuity , because we do not have hlder continuity estimate at arbitrarily small distances .",
    "another application of elliptic harnack inequality is liouville property for harmonic functions that was shown in proposition [ p - liov ] .",
    "next , we turn attention to application of two sides gaussian estimates .",
    "of course , the estimates given by has enough information to determine whether or not the the random walk is transient .",
    "the estimate given by ( * ? ? ? * proposition 4.3 ) can be easily generalized to metric measure spaces in which case we obtain    [ p - trans ] let @xmath100 be a quasi-@xmath201-geodesic metric measure space satisfying [ doub - loc ] and @xmath2426 .",
    "consider a @xmath102-symmetric markov operator @xmath1 that is @xmath831-compatible with @xmath100 for some @xmath850 and whose kernel @xmath138 satisfies .",
    "then the random walk corresponding to @xmath1 is transient if and only if @xmath2448 for some @xmath61 .",
    "it is easy to see that the convergence of the series in does not depend on the choice of @xmath61 .",
    "unless the space is discrete , we do not have a ` green s function ' as the green operator @xmath2449 does not have a kernel as there is ` delta mass ' singularity at the starting point .",
    "however , we may consider the off - diagonal part of the green operator given by the `` green s function '' @xmath2450 . the estimate given by (",
    "* proposition 4.3 ) can be again generalized as follows .    under the assumptions of proposition [ p - trans ]",
    ", there exists @xmath39 such that @xmath2451 for some @xmath61 and for all @xmath21 with @xmath2452 .    as noted in (",
    "* theorem 9.1 ) , the gaussian estimate is sufficient to prove law of iterated logarithm in a weak form .",
    "the proof in @xcite can be generalized for metric measure spaces .    under the assumptions of proposition [ p - trans ]",
    ", there exist @xmath39 such that for all starting points @xmath2453 @xmath2454 almost surely , where @xmath2455 is the markov chain corresponding to @xmath1 .",
    "we refer the reader to ( * ? ? ?",
    "* section 9 ) for other probabilistic applications in similar spirit .",
    "we sketch a possible application to mixing times of markov chains that will be developed elsewhere .",
    "if the space has finite diameter the techniques developed here can be used to prove upper and lower bounds on _ mixing times_. in this case @xmath102 is a finite measure on @xmath107 and can be normalized if necessary to be the stationary probability measure . roughly speaking",
    ", in this case for @xmath841-compatible markov operator on a space with diameter @xmath2456 , it takes @xmath2457 steps of the markov chain to get close to the stationary distribution @xmath102 .",
    "the poincar inequality and gaussian upper bounds can be used to obtain upper bounds on mixing time as outlined in ( * ? ? ?",
    "* lemma 2.1 and remark 1 after lemma 2.2 ) . for",
    "lower bounds on the mixing time one would need gaussian lower bounds .",
    "we plan to address these questions in a sequel and obtain results complementary to those in @xcite .",
    "we refer the reader to @xcite for other recent works in this direction .",
    "in @xcite , colding and minicozzi proved that the space of harmonic functions with polynomial volume growth with fixed rate on a manifold satisfying volume doubling and poincar inequality is finite dimensional .",
    "as a corollary , they prove a conjecture of s. t. yau on manifolds that asserts the above property for riemannian manifolds with non - negative ricci curvature .",
    "a recent surprising application of this result is an alternate proof of gromov s theorem on groups of polynomial volume growth due to kleiner @xcite .",
    "this new proof avoids the solution to hilbert s fifth problem ( montgomery - zippin - yamabe structure theory ) .",
    "to precisely state a theorem we need the following definition .",
    "[ d - poly ] for a metric measure space @xmath100 and a @xmath102-symmetric markov operator @xmath1 on @xmath107 , we define the space of @xmath1-harmonic functions with growth rate @xmath134 as the vector space @xmath2458 consisting of all @xmath1-harmonic functions @xmath31 such that there exists @xmath2459 ( depending on @xmath31 ) such that @xmath2460 for all @xmath61 .",
    "we have the following theorem that extends the result of colding and minicozzi to random walks on metric measure spaces .",
    "[ t - cm ] let @xmath100 be a quasi - geodesic metric measure spaces satisfying @xmath2426 , volume doubling hypotheses [ doub - loc ] , [ doub - inf ] and poincar inequality [ poin - mms ] .",
    "let @xmath1 be a markov operator that is @xmath831-compatible with @xmath100 .",
    "then the space of @xmath1-harmonic functions @xmath2458 with a fixed growth rate @xmath134 is finite dimensional for any @xmath2461 .",
    "the proof of colding and minicozzi s theorem in @xcite relies on three ingredients : volume doubling hypotheses [ doub - glob ] , a poincar inequality [ e - opoin ] and a reverse poincar inequality for harmonic functions .",
    "we have all the three ingredients as we showed the reverse poincar inequality in lemma [ l - rp ] .",
    "a caveat is that we have to rely on weaker versions of all the three ingredients but nevertheless we will see that theorem [ t - cm ] can be proved using the techniques introduced of @xcite .",
    "t. delmotte adapted an alternate approach due to p. li @xcite to prove a similar statement for random walks on graphs satisfying doubling and poincar inequality @xcite .",
    "the next proposition below is a slightly weaker version of ( * ? ? ?",
    "* proposition 2.5 ) .",
    "[ p - on ] let @xmath100 be a quasi - geodesic metric measure spaces satisfying @xmath2426 , volume doubling hypotheses [ doub - loc ] , [ doub - inf ] and poincar inequality [ poin - mms ] and let @xmath1 be a markov operator that is @xmath831-compatible with @xmath100 .",
    "there exists @xmath2462 such that for all @xmath418 , for all @xmath227 satisfying @xmath2463 and for all functions @xmath2464 satisfying @xmath2465 for all @xmath2466 ; @xmath2467 for all @xmath2468 ; and @xmath2469 for all @xmath2466 , we have @xmath2470 , where @xmath2471 depends on @xmath251 but does not depend on @xmath2463 or @xmath418 .    by lemma [ l - doub - prop ]",
    "there exists @xmath81 such that @xmath2472 for all @xmath2473 and for all @xmath61",
    ". moreover if we set @xmath2474 , we have @xmath2475 for all @xmath61 and for all @xmath2476 .",
    "by lemma [ l - pflex ] and , there exists constants @xmath2477 and @xmath2055 such that for all @xmath61 , for all @xmath2473 , for all functions @xmath515 , we have @xmath2478 let @xmath418 , @xmath63 , @xmath227 and @xmath2479 .",
    "define @xmath2480 where @xmath2462 will be determined later .",
    "let @xmath2481 be a @xmath2482-net of @xmath2483 .",
    "we set @xmath2484 since @xmath2485 and @xmath2486 , by , , we have @xmath2487 for all @xmath2488 and for all @xmath546 . since @xmath2489 by proposition [ p - net](a ) , and , we have @xmath2490 by and , we have @xmath2491    next we bound the overlap of the balls @xmath2492 . define @xmath2493 as the cardinality of the set @xmath2494 . if @xmath2495 , then @xmath2496 contains the disjoint balls @xmath2497 and hence @xmath2498 however by , , for all @xmath21 , for all @xmath2499 such that @xmath2500 , we have @xmath2501 by and , we have @xmath2502 by proposition [ p - net ] the balls @xmath2503 covers @xmath2483 .",
    "we now partition @xmath2483 into @xmath160 disjoint subsets @xmath2504 , where @xmath2505 .",
    "let @xmath2506 denote the finite set of points in @xmath2483 .",
    "for any function @xmath515 , we set @xmath2507 by cauchy - schwarz inequality , , , we have @xmath2508 for all @xmath2509 and for all @xmath2510 .",
    "let @xmath2511 .",
    "next , we define a map @xmath2512 , where @xmath2513 is a function from a finite set @xmath1 to another finite set @xmath2514 . with a slight abuse of notation ,",
    "we intepret the function @xmath2515 as a piecewise constant function on @xmath2483 that takes the value @xmath2516 on @xmath2517 , where @xmath2510 . for all @xmath2518 and for all @xmath2510 , we define @xmath2519 as any closest point of @xmath2514 to @xmath2520 . by definition of @xmath2514 and , for all",
    "@xmath2521 we have @xmath2522 combining the poincar inequality , and @xmath2523 , we obtain @xmath2524 for all @xmath2509 and for all @xmath2510 .",
    "hence by , and , we have @xmath2525 by the triangle inequality along with , we obtain @xmath2526 for all @xmath2527 . by and , we have for @xmath2528 @xmath2529 combining and , for all @xmath2527 we obtain @xmath2530 hence the map @xmath2531 is injective . therefore by @xmath2532 note that the value of @xmath2471 does not depend on the value of @xmath418 or @xmath14 but only on @xmath251 and the constants associated with doubling properties and poincar inequality .",
    "next , we recall the a result due to colding and minicozzi ( * ? ? ?",
    "* proposition 4.16 ) .",
    "we omit the proof as it is identical to that of ( * ? ? ?",
    "* proposition 4.16 ) .",
    "[ p-4.16 ] consider a metric measure space @xmath100 satisfying the hypotheses [ doub - loc ] , [ doub - inf ] and @xmath2426 .",
    "let @xmath1 be a markov operator that is @xmath831-compatible with @xmath100 for some @xmath2533 .",
    "suppose that @xmath2534 are linearly independent .",
    "there exists @xmath2134 , @xmath418 such that for all @xmath2535 , @xmath1457 and @xmath2536 , there exists @xmath2537 , @xmath2538 , and functions @xmath2539 in the linear span of @xmath2540 such that @xmath2541 and @xmath2542    in proposition [ p-4.16 ] , we may choose @xmath2543 as the constant in .",
    "we are now ready to prove theorem [ t - cm ] .",
    "fix @xmath2544 , @xmath2535 and @xmath418 .",
    "let @xmath2545 be as given by lemma [ l - rp ] and set @xmath2546 .",
    "let @xmath2462 be given by proposition [ p - on ] .",
    "we choose @xmath2547 such that @xmath2548 .",
    "let @xmath2549 where @xmath2471 is given by proposition [ p - on ] where @xmath251 is as defined above .",
    "suppose that @xmath2550 be linearly independent .",
    "then by proposition [ p-4.16 ] and reverse poincar inequality ( lemma [ l - rp ] ) there exists @xmath2551 and @xmath2552 such that for all @xmath2553 , we have harmonic functions @xmath2554 satisfying @xmath2555",
    "@xmath2556 @xmath2557 and @xmath2558 note that , , and @xmath2559 implies that @xmath2554 satisfy , @xmath2560 for all @xmath2561 . note that , , along with proposition [ p - on ] implies the desired contradiction .",
    "therefore @xmath2562 .",
    "similar to @xcite , we can replace the volume doubling hypotheses [ doub - loc ] , [ doub - inf ] of theorem [ t - cm ] by a weakly polynomial growth assumption on the volume growth .",
    "we end with a few directions for future work .",
    "one of the features of our work is that it provides an unified approach to gaussian estimates for discrete time markov chains on both discrete and continuous spaces .",
    "recently , there has been considerable interest in analysis and probability on fractals and fractal - like manifolds and graphs . for many natural family of fractals",
    "the heat kernel satisfies sub - gaussian estimates of the form @xmath2563 for all @xmath1819 and for all @xmath38 and @xmath2564 is a parameter ( see ( * ? ? ?",
    "* theorem 1.5(e ) ) for an early example ) . here",
    "@xmath2565 means that both inequalities @xmath2566 and @xmath2567 hold with different values of constants @xmath2568 .",
    "similar to the characterizations of gaussian estimates in @xcite there exists various characterizations for sub - gaussian estimates both in the setting of diffusions on local dirichlet spaces @xcite and for discrete time markov chains on graphs @xcite . as in the case of gaussian estimates , it is desirable to obtain characterizations of sub - gaussian estimates that are stable under quasi - isometries .",
    "this was achieved using a condition called cutoff - sobolev inequality first introduced by barlow and bass @xcite ( see also @xcite ) .",
    "our work naturally raises an analogous question for sub - gaussian estimates on markov chains .",
    "characterize sub - gaussian estimates for discrete time markov chains on quasi - geodesic metric measure spaces using geometric conditions that are stable with respect to quasi - isometries .",
    "another direction for future work is to clarify the applications to mixing times in the finite diameter case as mentioned in remark [ r - fin](b ) .    as mentioned in the introduction , we state the problem concerning the stability of the elliptic harnack inequality .",
    "is elliptic harnack inequality stable under quasi - isometries ?",
    "if so , characterize the elliptic - harnack inequality by geometric properties that are stable under quasi - isometries .",
    "we refer the reader to @xcite for partial progress and conjectures aimed at solving the above problem .",
    "in this appendix , we state riesz - thorin and marcinkiewicz interpolations theorems and refer the reader to the literature for a proof .",
    "let @xmath2569 be a linear operator between normed linear spaces .",
    "we denote the _ operator norm _ by @xmath2570 if @xmath2571 , we say the operator @xmath1094 is _",
    "bounded_. it is well known that @xmath1094 is bounded if and only if @xmath1094 is continuous .",
    "we abbreviate @xmath2572 as @xmath2573 .",
    "[ t - rt ] assume that @xmath2574 is a @xmath12-finite measure space .",
    "suppose @xmath2575 , @xmath2576 .",
    "let @xmath2577 , be a linear operator such that @xmath2578 and @xmath2579 are bounded .",
    "then @xmath2580 for all @xmath2075 where @xmath2581 and @xmath2582 .",
    "we refer the reader to @xcite for a proof of stein s interpolation theorem which in turn implies theorem [ t - rt ] .",
    "consider a @xmath12-finite measure space @xmath2583 .",
    "the distribution function of @xmath177 is defined by @xmath2584    we denote _ weak @xmath475 space _ by @xmath2585 for a measurable function @xmath177 and @xmath1123 , we define its @xmath2585 norm by @xmath2586 we say a measurable function @xmath2587 if @xmath2588 .",
    "note that @xmath2585 is not a true norm , since @xmath2589 does not satisfy triangle inequality .",
    "if @xmath2590 , then @xmath2591 .",
    "therefore @xmath2592 .",
    "it is easy to check that @xmath2593 in general .",
    "[ t - marcin ] let @xmath2594 , @xmath2595 with @xmath2596 .",
    "let @xmath1094 be a linear operator from @xmath2597 to the space of measurable functions . if @xmath1094 satisfies @xmath2598 then @xmath2599 for all @xmath2075 , where @xmath2581 , @xmath2582 and @xmath2600 depends only on @xmath2601 .",
    "we refer the reader to ( * ? ? ?",
    "* theorem 2.58 ) for a proof of theorem [ t - marcin ] .",
    "here we collect various examples discussed earlier and supplement them with more examples , comments and pictures .",
    "[ x - nongauss ] we expand upon the ball walk described in example [ x - ballwalk ] for specific metric measure spaces .",
    "if a weighted riemannian manifold satisfies two - sided gaussian estimates for its canonical diffusion , one might navely expect the same to hold for the ball walk .",
    "however this is not true in general because the measure @xmath806 of example [ x - ballwalk ] is not necessarily comparable to @xmath102 .",
    "the measure @xmath806 might fail to satisfy either [ doub - inf ] or [ poin - inf ] .",
    "recall the example @xmath2602 from example [ x - grisal ] , where @xmath2603 .",
    "note that if @xmath1566 there is a drift away from the origin and if @xmath2604 there is a drift towards the origin . if @xmath2605 one can verify that @xmath2606 is comparable to @xmath2607 .",
    "therefore the ballwalk accentuates the drift towards or away from the origin ( see figure [ f - rad ] ) .      in light of the above observation along with table [ table :",
    "example ] , theorem [ t - main0 ] and proposition [ p - rmtfae ] , if @xmath89 and @xmath2612 $ ] , then the canonical diffusion on @xmath2613 satisfies gaussian estimates but the ball walk fails to satisfy gaussian estimates because @xmath2614 does not satisfy [ doub - inf ] . in the case",
    "@xmath2615 and @xmath2616 , the canonical diffusion on @xmath2617 satisfies gaussian estimates but the ball walk fails to satisfy gaussian estimates because @xmath2618 does not satisfy [ poin - inf ] .    even when both diffusion and ball walk satisfy gaussian estimates for the transition kernels with respect to the invariant measures , the long term behavior might be different .",
    "for example , if @xmath2619 and if @xmath2620 then both diffusion and ball walk on @xmath2621 satisfy gaussian estimates for the transition kernels with respect to the invariant measures .",
    "however in this case the ball walk is recurrent but the diffusion is transient .",
    "for @xmath897 , the the ball walk on @xmath2621 is positive recurrent chain @xmath2622 , null recurrent for @xmath2623 and transient if @xmath2624 ( see ( * ? ? ?",
    "* proposition 10.1.1 ) and proposition [ p - trans ] ) . however the canonical diffusion on @xmath2621 is positive recurrent chain @xmath2625 , null recurrent for @xmath2626 and transient if @xmath2627 .",
    "[ x - complex ] consider the euclidean 2-complex in @xmath2628 formed by the hyperplanes @xmath2629 where @xmath2630 and @xmath2631 .",
    "the metric is described by the intrinsic metric and the measure is the two dimensional surface measure .",
    "dirichlet forms on such riemannian complexes have been studied in @xcite .",
    "this example satisfies both poincar inequality [ poin - mms ] for all @xmath506 and volume doubling [ doub - inf ] .",
    "the geometry of the balls depend on the center ( see figure [ f - complex ] ) .",
    "the above example can also be viewed as a _ cayley complex _",
    "@xcite corresponding to the presentation @xmath2632 more generally , consider a finitely generated and finitely presented group @xmath2633 .",
    "note that the @xmath505-skeleton of the cayley complex is the cayley graph of @xmath2634 and the @xmath1509-cells ( faces ) are in bijection with @xmath2635 .",
    "we equipp each @xmath1509-cell with the the usual euclidean metric on the regular @xmath705-gon with edges of length 1 and we endow the space with the measure obtained by equiping each two - cell with its lebesgue measure .",
    "it is easy to verify that the cayley complex is quasi - isometric to the cayley graph of @xmath2 with the quasi - isometry given by the natural embedding of the cayley graph in the cayley complex . by the stability of [ doub - inf ] and [ poin - mms ] under quasi - isometries",
    ", we have that ball walk on cayley complexes of nilpotent groups ( such groups are finitely generated and finitely presented ) satisfy two sided gaussian bounds .            given a smooth function @xmath2637 , denote by @xmath2638 a _ model manifold_. here by model manifold ,",
    "we mean @xmath2639 equipped with the riemannian metric in polar coordinates @xmath2640 by @xmath2641 where @xmath2642 is the standard metric on @xmath2643 and @xmath2644 is a smooth positive function on @xmath2645 .",
    "the necessary and sufficent conditions under which @xmath2646 can be smoothly extended to a metric on the entire space @xmath2639 is given by @xmath2647 ( see ( * ? ? ?",
    "* equation ( 4.12 ) ) ) .",
    "therefore we may choose @xmath2648 where @xmath93 for all @xmath546 and extend it smoothly satisfying the above conditions .",
    "it is known that that @xmath2638 with @xmath2648 for @xmath546 satisfies parabolic harnack inequality if and only if @xmath2649 . the riemannian measure ( in polar coordinates ) is given by @xmath2650 .",
    "one can check that the reversible measure @xmath806 for the ball walk satisfies @xmath2651 for the case @xmath2652 and @xmath2653 for the case @xmath2654 ( see @xcite ) .",
    "therefore the ball walk on the model manifold @xmath2638 with @xmath2648 for @xmath546 satisfies the parabolic harnack inequality and two - sided gaussian estimates if and only if @xmath2655 . using lemma [ l - rvd ] , it is easy to verify that @xmath2638 with @xmath2648 for @xmath546 equipped with the measure @xmath806 fails to satisfy [ doub - inf ] if @xmath2656 .",
    "therefore for the case @xmath2657 , the model manifold @xmath2638 defined above satisfies two sided gaussian estimates for diffusion but fails to satisfy two sided gaussian estimates for the ball walk .",
    "these model manifolds can also be considered as surfaces of revolution formed by the graph of the function @xmath2644 ( see ( * ? ? ?",
    "* section 5.1 ) ) .",
    "similar to example [ x - nongauss ] , the ball walk and diffusions may exhibit different behaviors in terms of null recurrence , positive recurrence and transience depending on @xmath843 and @xmath2658 .    another related class of examples given in ( * ? ? ?",
    "* section 5.2 ) are bodies of revolution . let @xmath2659 be a concave function with @xmath2660 .",
    "then the body of revolution in @xmath2661 ( with @xmath2662 ) defined by @xmath2663 where @xmath2664 above denotes the euclidean norm in @xmath2665 ( see figure [ f - revolve ] ) .",
    "note that since @xmath177 is concave , @xmath107 is a convex subset of @xmath3 . by the results of @xcite",
    ", we have that @xmath107 satisfies two - sided gaussian estimates for the heat kernel corresponding to the neumann laplacian .",
    "hence by theorem [ t - grisal ] the neumann laplacian satisfies poincar inequality in @xmath107 and satisfies volume doubling .",
    "if we set @xmath2666 for some @xmath2667 and by proposition [ p - rmtfae ] and theorem [ t - main0 ] the ball walk on @xmath107 satisfies two - sided gaussian bounds .",
    "hence by proposition [ p - trans ] the corresponding ball walk on @xmath2668 with @xmath2666 is transient if and only if @xmath2669 .",
    "r. a. adams , j. f. fournier , _ sobolev spaces _",
    "second edition .",
    "pure and applied mathematics ( amsterdam ) , 140 .",
    "elsevier / academic press , amsterdam , 2003 .",
    "xiv+305 pp . http://www.ams.org/mathscinet-getitem?mr=2424078[mr2424078 ]        d. bakry , i. gentil , m. ledoux , _ analysis and geometry of markov diffusion operators _ , grundlehren der mathematischen wissenschaften [ fundamental principles of mathematical sciences ] , 348 .",
    "springer , cham , 2014 .",
    "xx+552 http://www.ams.org/mathscinet-getitem?mr=3155209[mr3155209 ]        m. t. barlow , r. f. bass , t. kumagai , _ stability of parabolic harnack inequalities on metric measure spaces _ , j. math .",
    "japan 58 ( 2006 ) , no . 2 , 485519 .",
    "http://www.ams.org/mathscinet-getitem?mr=2228569[mr2228569 ]",
    "m. t. barlow , t. coulhon , t. kumagai , _ characterization of sub - gaussian heat kernel estimates on strongly recurrent graphs _",
    "pure appl . math . 58",
    "( 2005 ) , no .",
    "12 , 16421677 .",
    "http://www.ams.org/mathscinet-getitem?mr=2177164[mr2177164 ]",
    "m. t. barlow , a. grigoryan , t. kumagai , _ on the equivalence between parabolic harnack inequalities and heat kernel estimates _ , j. math .",
    "japan 64 ( 2012 ) , no . 4 , 10911146 .",
    "http://www.ams.org/mathscinet-getitem?mr=2998918[mr2998918 ]        d. burago , y. burago and s. ivanov , _ a course in metric geometry _ ,",
    "graduate studies in mathematics , 33 .",
    "american mathematical society , providence , ri , 2001 .",
    "http://www.ams.org/mathscinet-getitem?mr=1835418[mr1835418 ]",
    "i. chavel , _ riemannian geometry . a modern introduction _ ,",
    "second edition .",
    "cambridge studies in advanced mathematics , 98 .",
    "cambridge university press , cambridge , 2006 .",
    "xvi+471 pp .",
    "http://www.ams.org/mathscinet-getitem?mr=2229062[mr2229062 ]",
    "s. y. cheng and s. t. yau , _ differential equations on riemannian manifolds and their geometric applications _",
    "pure appl .",
    "( 1975 ) , no . 3 , 333354 . http://www.ams.org/mathscinet-getitem?mr=0385749[mr0385749 ]",
    "t. couhlon , a. grigoryan , f. zucca , _ the discrete integral maximum principle and its applications _ , tohoku math .",
    "j. ( 2 ) 57 ( 2005 ) , no . 4 , 559587 .",
    "http://www.ams.org/mathscinet-getitem?mr=2203547[mr2203547 ]",
    "e. de giorgi , _ sulla differenziabilit e lanaliticit delle estremali degli integrali multipli regolari _ , ( italian ) mem .",
    "( 3 ) 3 1957 2543 .",
    "http://www.ams.org/mathscinet-getitem?mr=0093649[mr0093649 ]",
    "p. diaconis , g. lebeau , l. michel , _ geometric analysis for the metropolis algorithm on lipschitz domains _ , invent .",
    "185 ( 2011 ) , no . 2 , 239281 .",
    "http://www.ams.org/mathscinet-getitem?mr=2819161[mr2819161 ]",
    "e. fabes , d. stroock , _ a new proof of moser s parabolic harnack inequality via the old ideas of nash _ , arch .",
    "rational mech .",
    "96 ( 1986 ) , no . 4 , 327338 .",
    "http://www.ams.org/mathscinet-getitem?mr=0855753[mr0855753 ]",
    "a. grigoryan , _ the heat equation on noncompact riemannian manifolds _ , ( russian ) mat .",
    "182 ( 1991 ) , no .",
    "1 , 5587 ; english translation in math .",
    "ussr - sb . 72 ( 1992 ) , no . 1 , 4777 .",
    "http://www.ams.org/mathscinet-getitem?mr=1098839[mr1098839 ]      a. grigoryan , l .",
    "saloff - coste , _ hitting probabilities for brownian motion on riemannian manifolds _ , j. math .",
    "pures appl .",
    "( 9 ) 81 ( 2002 ) , no .",
    "2 , 115142 . http://www.ams.org/mathscinet-getitem?mr=1994606[mr1994606 ]",
    "m. gromov , _ hyperbolic manifolds , groups and actions _",
    ", riemann surfaces and related topics : proceedings of the 1978 stony brook conference ( state univ .",
    "new york , stony brook , n.y . , 1978 ) , pp .",
    "183213 , ann . of math .",
    "stud . , 97 , princeton univ . press , princeton , n.j . ,",
    "http://www.ams.org/mathscinet-getitem?mr=0624814[mr0624814 ]",
    "m. gromov , _ metric structures for riemannian and non - riemannian spaces _ , based on the 1981 french original . with appendices by m. katz , p. pansu and s. semmes .",
    "translated from the french by sean michael bates .",
    "reprint of the 2001 english edition .",
    "modern birkhuser classics .",
    "birkhuser boston , inc . ,",
    "boston , ma , 2007 .",
    "xx+585 pp .",
    "http://www.ams.org/mathscinet-getitem?mr=2307192[mr2307192 ]",
    "p. gyrya , l. saloff - coste , _ neumann and dirichlet heat kernels in inner uniform domains _ , astrisque no . 336",
    "( 2011 ) , viii+144 pp .",
    "isbn : 9782856293065 http://www.ams.org/mathscinet-getitem?mr=2807275[mr2807275 ]          w. hebisch , l. saloff - coste , _ on the relation between elliptic and parabolic harnack inequalities _ , ann .",
    "fourier ( grenoble ) 51 ( 2001 ) , no . 5 , 14371481 .",
    "http://www.ams.org/mathscinet-getitem?mr=1860672[mr1860672 ]",
    "m. kanai , _ rough isometries , and combinatorial approximations of geometries of non - compact riemannian manifolds _ , j. math .",
    "japan 37 ( 1985 ) , no . 3 , 391413 .",
    "http://www.ams.org/mathscinet-getitem?mr=0792983[mr0792983 ]",
    "m. kanai , _ analytic inequalities , and rough isometries between non - compact riemannian manifolds _ , curvature and topology of riemannian manifolds ( katata , 1985 ) , 122137 , lecture notes in math . , 1201 , springer , berlin , 1986 .",
    "http://www.ams.org/mathscinet-getitem?mr=0859579[mr0859579 ]",
    "n. v. krylov , m. v. safonov , _ a property of the solutions of parabolic equations with measurable coefficients _ , ( russian ) izv .",
    "nauk sssr ser . mat .",
    "44 ( 1980 ) , no . 1 ,",
    "161175 , 239 .",
    "http://www.ams.org/mathscinet-getitem?mr=0563790[mr0563790 ]",
    "s. meyn , sean ; r. l. tweedie , _ markov chains and stochastic stability _ , second edition . with a prologue by peter w. glynn .",
    "cambridge university press , cambridge , 2009 .",
    "xxviii+594 pp http://www.ams.org/mathscinet-getitem?mr=2509253[mr2509253 ]    j. moser _ a new proof of de giorgi s theorem concerning the regularity problem for elliptic differential equations _",
    "pure appl . math .",
    "13 1960 457468 .",
    "http://www.ams.org/mathscinet-getitem?mr=0170091[mr0170091 ]      j. moser , _ a harnack inequality for parabolic differential equations _ , comm .",
    "pure appl .",
    "17 1964 101134 http://www.ams.org/mathscinet-getitem?mr=0159139[mr0159139 ] , correction in comm .",
    "pure appl .",
    "20 1967 231236 .",
    "http://www.ams.org/mathscinet-getitem?mr=0203268[mr0203268 ]            j. roe , _ lectures on coarse geometry _ , university lecture series , 31 .",
    "american mathematical society , providence , ri , 2003 .",
    "viii+175 pp .",
    "isbn : 0821833324 http://www.ams.org/mathscinet-getitem?mr=2007488[mr2007488 ]        l. saloff - coste , _ parabolic harnack inequality for divergence form second order differential operators _ , potential anal . 4 ( 1995 ) , no . 4 , 429467 .",
    "http://www.ams.org/mathscinet-getitem?mr=1354894[mr1354894 ]",
    "l. saloff - coste , _ lectures on finite markov chains _ , lectures on probability theory and statistics ( saint - flour , 1996 ) , 301413 , lecture notes in math .",
    ", 1665 , springer , berlin , 1997 .",
    "http://www.ams.org/mathscinet-getitem?mr=1490046[mr1490046 ]",
    "l. saloff - coste , _ aspects of sobolev - type inequalities _ , london mathematical society lecture note series , 289 .",
    "cambridge university press , cambridge , 2002 .",
    "http://www.ams.org/mathscinet-getitem?mr=1872526[mr1872526 ]",
    "l. saloff - coste , _ the heat kernel and its estimates _ , probabilistic approach to geometry , 405436 , adv . stud .",
    "pure math .",
    ", 57 , math .",
    "japan , tokyo , 2010 .",
    "http://www.ams.org/mathscinet-getitem?mr=2648271[mr2648271 ]",
    "varopoulos , l. saloff - coste , t. couhlon , _ analysis and geometry of groups _ , cambridge tracts in mathematics , 100 .",
    "cambridge university press , cambridge , 1992 .",
    "xii+156 pp ."
  ],
  "abstract_text": [
    "<S> we characterize gaussian estimates for transition probability of a discrete time markov chain in terms of geometric properties of the underlying state space . </S>",
    "<S> in particular , we show that the following are equivalent :    1 .   two sided gaussian bounds on heat kernel 2 .   </S>",
    "<S> a scale invariant parabolic harnack inequality 3 .   volume doubling property and a scale invariant poincar inequality .    </S>",
    "<S> the underlying state space is a metric measure space , a setting that includes both manifolds and graphs as special cases . </S>",
    "<S> an important feature of our work is that our techniques are robust to small perturbations of the underlying space and the markov kernel . in particular , we show the stability of the above properties under quasi - isometries . we discuss various applications and examples . </S>"
  ]
}