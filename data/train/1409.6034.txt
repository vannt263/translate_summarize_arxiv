{
  "article_text": [
    "effectively managing traffic flow to reduce congestion can improve communities by reducing travel times , reducing pollution and improving economic efficiency .",
    "transportation departments use information on current and projected travel times to adjust ramp metering and traffic lights ; travelers use projected travel times to make travel plans and to adjust departure times , transportation mode and route . estimated travel times",
    "are developed using sophisticated models of traffic flow that begin with observations on speed and density and develop estimates of road capacity based on estimates of current density and flow .    in their seminal paper , @xcite",
    "describe the theory of kinematic wave motion which they apply to modeling highway traffic flow . @xcite",
    "independently proposed a similar application .",
    "the key assumption is a relationship between traffic flow and density .",
    "a model is calibrated using the characteristics of road segments , such as the number of lanes , free - flow speed and road type .",
    "these characteristics themselves do not explain all the variation in model parameters and estimates need to be assessed using observations on current speed , density and lane configurations at sparse points throughout the network .",
    "much of the recent improvement in travel time estimation and forecasting has come from improving the estimates of network characteristics [ @xcite ] .",
    "usually , underlying traffic data is sparse .",
    "we observe specific points in a traffic network using fixed loop - sensors or at random points via gps - equipped probe vehicles .",
    "underlying road capacity might vary [ @xcite ] as drivers change speed in response to congestion , weather conditions and the behavior of other drivers , as well as the number of available lanes change due to weather conditions , traffic issues and other events . accurately estimating road capacity from sparse and noisy observations of traffic speed and density at points in the traffic network is a significant challenge and improving on these estimates will lead to better travel time forecasts .",
    "our approach develops a particle filtering and learning algorithm for estimating road capacity .",
    "we build on existing estimation methods in a number of ways :    incorporation of sequential parameter learning in order to update the model in real time .    a predictive likelihood particle filter that provides an efficient estimation strategy and is less sensitive to measurement outliers .",
    "we apply our methodology to traffic flow data from chicago s interstate i-55 highway and show how parameter learning effectively handles a dynamic environment , including shock waves .",
    "bayesian learning , which is central to our methodology , corrects for bias that results from estimation with fixed parameters .",
    "we also show that our algorithm identifies the drop in road throughput as a result of an accident .",
    "particle filtering allows for posterior estimation of the most recent state .",
    "the low computational complexity of particle filtering makes frequent updating feasible , whereas mcmc s computational cost grows linearly with the length of the data . for previous mcmc applications in transportation ,",
    "see @xcite for inferring network route flows , and @xcite for travel time reliability for ambulances using noisy gps for both path travel time and individual road segment travel time distributions .",
    "@xcite develop a dynamic bayesian network to model external intervention techniques to accommodate situations with suddenly changing traffic variables .",
    "@xcite provide a nonparametric prediction model for traffic flow trajectories , and @xcite proposes using a functional mixture prediction approach .",
    "previous work on estimating traffic flows use extensions of the kalman filter and rely heavily on gaussianity assumptions ; see @xcite .",
    "@xcite considered mixture kalman filters for traffic state estimation in the context of ramp metering control .",
    "particle filters have previously been applied to traffic flow problems ; see @xcite who use the evolution dynamics as a proposal distribution before resampling , the so - called bootstrap or sampling / importance resampling ( sir ) filter .",
    "we improve the efficiency for inference and prediction with a fully adopted filter and our approach naturally incorporates particle learning .",
    "we build on existing work on parameter learning in transportation .",
    "for example , @xcite develop a quantile regression methodology that re - estimates parameters every five minutes based on traffic flow and density measurements .",
    "@xcite propose an extended kalman filter with boundary condition estimation .",
    "the advantage of particle filtering over traditional kalman filtering is the ability to handle nonnormal posterior distributions that result , for example , from nonlinearity .",
    "section  [ sec : mixture ] shows that the distribution of uncertainty about state is a mixture at some points in time and this leads us to use particle filters , that do not rely on normality assumption .",
    "real - time estimation and short - run prediction of traffic conditions play a key role in intelligent transportation systems ( its ) .",
    "current vehicle navigation systems and traffic management systems use forecasts of traffic flow variables , such as traffic volume , travel speed or traffic density ranging from 530 minutes ahead .",
    "there are a number of real - world applications :    advanced traveler information services ( atis ) . : :    multiple studies haveshown the positive impacts of providing    information on traffic flow conditions to the public [ @xcite ] , as it    can potentially lead to congestion relief [ @xcite ] .",
    "travel    information is provided in multiple ways , for example , by    transportation system managers such as local departments of    transportation via variable message signs or radio , automakers through    in - dash navigation , technology companies through phone apps or web ,    fleet managers and transit operators .",
    "transportation planning .",
    ": :    benefits of intelligent transportation systems are studied by local    governments based on system performance data before and after its is    deployed .",
    "an accurate comparison of the benefits to travel times    requires efficient estimation of the network states .",
    "control of transportation operation .",
    ": :    for traffic control applications , weneed to efficiently estimate the    formation of traffic congestion .",
    "accurate knowledge of the current    state allows transportation system managers to provide a reasonable    forecast of traffic conditions and to improve traffic flows using such    techniques as ramp metering and speed harmonization .    the rest of the paper proceeds as follows .",
    "section  [ sec : lwr ] develops a statistical treatment for the lwr model by representing it as a nonlinear state - space model .",
    "the key input to the lwr model , the fundamental diagram ( or flux function ) , which links traffic flow and density is discussed .",
    "the parameters of the fundamental diagram need to be estimated in an online fashion .",
    "section  [ sec : analysis ] provides a particle filtering algorithm for inference and prediction that provides online real - time inference for fundamental diagram parameters and traffic density state .",
    "section  [ sec : study - capacity ] illustrates how our methodology can learn road capacity when applied to data measured during a major highway accident .",
    "section  [ sec : numerical ] illustrates our methodology with a simulation study of rush hour traffic on chicago s i-55 .",
    "finally , section  [ sec : conclusion ] concludes with directions for future research .",
    "traffic flow data is available from the illinois department of transportation ; see lake michigan interstate gateway alliance ( ) , formally the gary  chicago  milwaukee corridor ( gcm ) .",
    "the data is measured by loop - detector sensors installed on interstate highways .",
    "loop - detector is a simple presence sensor that measures when a vehicle is present and generates an on / off signal .",
    "there are over 900 loop - detector sensors that cover the chicago metropolitan area .",
    "figure  [ fig : gcm - locations ] illustrates the locations of the detectors in the region . since 2008 , argonne national laboratory has been archiving traffic flow data every five minutes from the grid of sensors .",
    "data contains averaged _ speed _ , _ flow _ and _ occupancy_. occupancy is defined as percent of time a point on the road is occupied by a vehicle and flow is the number of off - on switches .",
    "illinois uses a single loop - detector setting and speed is estimated based on the assumption of an average vehicle length .",
    "the primary variable of interest is traffic density , which is a macroscopic characteristic of traffic flow and the control variable of interest in transportation system management strategies .",
    "traffic density is defined as a number of vehicles per unit of length .",
    "densities vary between zero and jam density which corresponds to vehicles being bumper - to - bumper .",
    "typically , jam density value is around 1 vehicle per 6.5 meters per lane .",
    "another important value related to density is the critical density , denoted by the density level at which the maximum flow ( throughput ) is achieved .",
    "the maximum flow measured in vehicles per unit of time is called capacity , it is typically achieved at density level of around 1 vehicle per 32 meters .",
    "it is natural to divide the flow regimes roughly into two subcategories .",
    "density values up to 1 vehicle per 32 meters correspond to a free - flow regime , when there are no interactions between the vehicles , and vehicles travel at the desired speed .",
    "the second regime corresponds to densities above 1 vehicle per 32 meters ; at roughly this density vehicles start interacting with each other and that leads to slow downs and flow reduction .    our observed data that comes from a presence sensor is occupancy rather than density .",
    "occupancy is defined as percentage of time a point on a road segment was occupied by a vehicle , thus it varies between 0 ( empty road ) and 100 ( complete stand still ) .",
    "assuming the average vehicle length does not vary over time , the density and occupancy are related through a simple linear transformation [ @xcite ] . throughout the paper",
    "we assume a constant vehicle length for every sensor in the region and treat density and occupancy interchangeably .",
    "two other macroscopic traffic flow parameters , namely . speed and flow ,",
    "are related through the following relation : @xmath0 where @xmath1speed ( miles per hour ) , @xmath2flow ( vehicles per hour ) , @xmath3density ( vehicles per lane - mile ) .",
    "the three traffic flow parameters can change over space and time . tracking these flow parameters can be particularly challenging due to discontinuities in them that are called shock waves .",
    "a shock wave can be a platoon of vehicles moving on an otherwise empty road , thus we have a nonzero density propagating in time and space .",
    "in other cases , the shock wave corresponds to a change in the flow regime , when fast - moving vehicles reach the end of a congestion queue and need to abruptly slow down , or vice versa , when we have queue dissipation and vehicles leave a bottleneck and can revert to the desired travel speed .",
    "in section  [ sec : traffic - parameters ] we considered traffic flow as a function of location @xmath4 and time @xmath5 .",
    "the flow - density relation , which is called the _ fundamental diagram _ , allows us to calculate flow via density @xmath6 .",
    "the lwr model is a macroscopic traffic flow model .",
    "it is a combination of a conservation law defined via a partial differential equation and a fundamental diagram .",
    "the nonlinear first - order partial differential equation describes the aggregate behavior of drivers .",
    "the density @xmath7 and flow @xmath8 , which are continuous scalar functions , satisfy the equation @xmath9 derivation of the model is presented in appendix  [ app : model - derivation ] .",
    "this equation can be solved numerically by discretizing time and space . in its simplest form ,",
    "imagine a homogeneous road segment ( with no change in number of lanes and no intersections ) cut into @xmath10 cells .",
    "let @xmath11 be the density in cell @xmath12 ( in veh@xmath13 m ) and @xmath14 the exit flow of cell @xmath12 ( in veh@xmath13s ) .",
    "for a road segment , with given boundary conditions , the lwr computes the conditions inside the domain .",
    "boundary conditions can be either measured by fixed sensors such as loop detectors or estimated from gps probe data based as shown by @xcite .",
    "statistical inference is required to update the missing states , learn the parameters of interest and predict forward using the dynamics of the lwr model , based on noise and possibly partially measured boundary conditions .",
    "describes the density variations for free - flow traffic and the right part [ crosses in and dashed line in ] describes congested traffic . ]",
    "an important feature of the lwr model is the emergence of a shock wave of traffic due to the density - dependent local propagation velocities .",
    "the fundamental diagram is central to its specification .",
    "the diagram describes a functional relation between flow and density .",
    "for example , figure  [ fig : fd_measured](a ) illustrates empirical data of volume versus occupancy .",
    "the theoretical form of the so - called triangular fundamental diagram is shown in figure  [ fig : fd_measured](b ) .",
    "it has two velocities of density variations : one for free - flow traffic ( green ) and one for congested traffic ( red ) .",
    "this specification allows for an efficient godunov scheme , to solve the nonlinear evolution dynamics .",
    "we need to provide the model with an accurate assessment of the current density state vector and the parameters of the fundamental diagram .",
    "the _ fundamental diagram _ is a key input into the specification of the lwr model , which expresses the relationship between traffic density and flow .",
    "figure  [ fig : fd_measured ] motivates the choice of a so - called triangular diagram by showing the empirical flow and occupancy for a highway segment in the chicago metropolitan area .    throughout our analysis",
    "we assume a homogeneous road segment with a fundamental diagram that does not depend on time and space . by homogeneous ,",
    "we mean that the road segment has homogeneous width and number of lanes and no intersections or traffic merge / diverge sections .",
    "the analytical formula for the triangular fundamental diagram is as follows : @xmath15 where @xmath16representing the critical flow ( capacity ) , @xmath17critical density , @xmath18jam density .",
    "we denote the set of three parameters by @xmath19 .",
    "the velocity of a shock wave propagation on a road segment can be calculated using the fundamental diagram parameters , via the rankine ",
    "hugoniot relation [ @xcite ] .",
    "it determines the shock wave velocity as the velocity of the shock @xmath20 times the jump in density which equals the jump in flow in the two regions separated by the shock where @xmath21 the direction of the shock wave propagation depends on the sign of @xmath22 . here",
    "@xmath23 is a free - flow speed on a link and @xmath24 is the critical flow or capacity of the link .",
    "correspondingly , @xmath25 is called the critical density .",
    "the pair @xmath26 is the traffic flow breakdown point for a road segment .",
    "calibrating the model parameters can be done in a number of ways .",
    "the standard approach uses values from the highway capacity manual [ @xcite ] that provides a look - up table for road capacity based on road type and number of lanes .",
    "however , in practice , the parameters are not fixed and change over time . to empirically illustrate the stochastic nature of the parameters",
    ", we estimate capacity and critical density from the measurements for 242 days in 2009 , on a segment of interstate highway i-55 in chicago .",
    "holidays and weekends as well as days with unreliable measurements were excluded .",
    "figure  [ fig : phis ] plots @xmath27 and @xmath28 across the days . clearly , there is a linear relation between @xmath28 and @xmath27 .",
    "road capacity can vary from day to day and its distribution has a heavy left tail . on the other hand ( for our data set ) , the critical density @xmath27 has a relatively tight distribution around the value 0.023  veh@xmath13 m .        [",
    "fig : critical - densiti - flow ]    this nonstatic nature of the parameters motivates the need for a sequential online parameter learning algorithm .",
    "let @xmath29 denote the observed traffic density data and @xmath30 be the current history of data .",
    "let @xmath31 be a hidden state vector of traffic densities .",
    "we assume that boundary conditions @xmath32 and @xmath33 , which represent traffic states on the downstream and upstream ends of a road segment , are given , as well as an initial condition @xmath34 . in practice ,",
    "boundary conditions are measure from sensors , such as loop detectors and radars , available at both ends of a road segment , and initial conditions either assume an empty road or state of traffic measured from cameras or satellites .",
    "we denote @xmath35    the expectation conditional of the next state @xmath36 is given by the solution of the lwr model . here",
    "@xmath37 denotes unknown parameters .",
    "a numerical godunov scheme computes @xmath38 given the parameters , @xmath39 , of the triangular fundamental diagram .",
    "our model has a state - space formulation of an observation and evolution system given by @xmath40 where @xmath41 and @xmath42 are evolution and equation error , respectively , and @xmath43vector of measured traffic flow density , @xmath44lwr evolution equation calculated via godunov s schema , @xmath19 triangular fundamental diagram parameters .",
    "the observation matrix @xmath45 picks out cells with measurements available .",
    "figure  [ fig : pl ] provides the graphical model for the state evolution structure .",
    "our goal is to develop a particle filter to draw samples from the filtered posteriors @xmath46 and @xmath47 .",
    "the operator @xmath48 is the measurement model that depends on the sensor type , and in our setting we make it linear . in a simplest case @xmath49 is a projection operator , which `` removes '' nonmeasured elements from the state vector .        while we treat the parameters @xmath39 of the lwr model as static , our model",
    "can easily be extended to allow for stochastic evolutions or characteristics to govern the dynamics .",
    "the lwr model  ( [ eqn : lwr1 ] ) describes the evolution of traffic flow on a road segment with uniform topology , as shown in figure [ fig : example ] ( see appendix  [ app : model - derivation ] ) .",
    "the change in road segment characteristics ( crossing , number of lanes , speed limit , curvature , etc . ) can be modeled using a junction .",
    "the treatment of junctions requires specific efforts for physical consistency and mathematical compatibility with the link model .",
    "for uniqueness of the solution of the junction problem , different conditions have been used , for instance , maximizing the incoming flow through the junction was suggested by @xcite and @xcite . @xcite",
    "consider maximizing a concave function of the incoming flow .",
    "a formulation using internal dynamics for the junction is equivalent [ @xcite ] to the vertex models for the merge and diverge junction ; see @xcite for more details .",
    "standard finite difference schemes are too inaccurate for solving the lwr model ; @xcite showed that a first order finite difference scheme is inaccurate for calculating with a small time step .",
    "moreover , none of the second order difference schemes preserve monotonicity of the @xmath50 , and thus are not applicable .    given an initial condition @xmath51 $ ] , propagating the lwr model requires solving the associated cauchy problem .",
    "if the initial condition is piecewise constant ( which is the case for many numerical approximations ) and self - similar , this reduces to a riemann problem .",
    "godunov s scheme then solves a riemann problem between each cell .",
    "this is an initial value problem with initial conditions having a single discontinuity @xmath52 for the riemann problem , the speed of the shock wave propagation is given by the rankine ",
    "hugoniot relation ( [ eqn : r - h ] ) .",
    "heuristically , imagine at initial time @xmath53 that there are two regions in the domain with different values of thermodynamic parameters ( flow , density and speed in our case ) .",
    "the two regions are divided by a thin membrane and at the initial time the membrane is removed .",
    "the computational problem is to find the values of thermodynamic parameters at all future times .",
    "according to godunov s scheme , we calculate the iterates @xmath54 where @xmath55 is the density value at the point with coordinates @xmath56 , @xmath57 , with @xmath58 a space discretization step and @xmath59 a time discretization step .    the function @xmath60 is defined by @xmath61 typically , a virtual cell is introduced on both sides of the domain to include boundary conditions ( in and out flow ) .",
    "this leads to a left boundary @xmath62 and right boundary @xmath63 numerical stability in space and time is ensured by the courant  friedrichs  lewy type condition [ @xcite ] : @xmath64 , where @xmath65 is the maximum wave velocity present in the meshed domain at any given point in time .      when uncertainty about the traffic state gets propagated from one time step to another using godunov s scheme",
    ", the current unimodal distribution can update to a mixture distribution .",
    "for example , this happens at the location of a shock wave , when the cell on the right is in a free - flow regime and the cell on the left is in a congested regime .",
    "this can be demonstrated by a simple monte carlo experiment .",
    "consider two consecutive cells , with densities @xmath66 and @xmath67 correspondingly , both following a truncated normal distribution .",
    "assume @xmath68 and @xmath69 , where @xmath70 and @xmath71 are lower and upper bounds of a truncated normal distribution correspondingly . using a triangular fundamental diagram with @xmath72 veh@xmath13h , @xmath73  veh@xmath13 m , and @xmath74  veh@xmath13 m",
    ", we can calculate the speed of the shock wave propagation @xmath20 given by equation  [ eqn : r - h ] .",
    "we then simulate the distribution over @xmath20 , using @xmath75 samples .",
    "figure  [ fig : sigma - mixture ] shows the results of the experiment .",
    "the uncertainty over speed propagation is a bimodal mixture distribution , implying the uncertainty about the density at the future times is also a mixture .",
    "our example in section  [ sec : numerical ] shows that the behavior of uncertainty about traffic flow density state matches this bimodal shape found here .",
    "particle filtering methods are designed to provide sequential state inference from the set of filtered posteriors @xmath46 ; see , for example , @xcite .",
    "our algorithm will be based on the @xcite filter .",
    "the major difference is a fully adapted filter that resamples first using the predictive distribution and propagates forward using the conditional posterior .",
    "the fully adapted filter mitigates particle filter degeneracy , although the usual compounding of the monte carlo errors still exists [ @xcite ] .",
    "the predictive likelihood for the next observation , @xmath76 , is required to implement our particle filter . given the current state variable @xmath77 , the predictive likelihood is defined by @xmath78 propagation of states requires the conditional posterior for the next state @xmath79 .",
    "this density can be computed using the model assumptions via the system of distributions @xmath80 marginalizing out @xmath81 leads us to distributions @xmath82 for propagation of @xmath81 , we use bayes rule and the conditional posterior @xmath83 where the mean and variance @xmath84 follow the kalman recursion [ @xcite ] : @xmath85    to develop our particle filter , we now factorize the joint conditional distribution as @xmath86 the goal is to obtain the new filtering distribution @xmath87 from the current @xmath88 and to provide a particle approximation to the parameter posterior , @xmath89 .",
    "we start with a particle ( a.k.a .",
    "random histogram of draws ) filtering approximation to the joint distribution of the state and parameters , denoted by @xmath90 where @xmath91 is a dirac measure .",
    "as the number of particles increases @xmath92 , the law of large numbers guarantees that this distribution converges to the true filtered distribution @xmath93 .    for the next marginal posterior distribution , the bayes rule yields @xmath94 where the particle weights are determined by @xmath95",
    "the algorithm consists of three steps :    ( resample ) draw an index @xmath96 for @xmath97 .",
    "( propagate ) draw @xmath98 for @xmath97 .",
    "( replenish ) draw @xmath99 } ( \\phi^ { k(i ) } ) $ ] ,    where @xmath100 } ( \\cdot ) $ ] denotes the dirac measure in an interval @xmath101 $ ] .",
    "thus , we resample @xmath102 from mixture uniform distribution with support @xmath103 $ ] , @xmath97 , and equal mixing rights . the jittering parameter @xmath104 is used to calculate unique @xmath105 particles .",
    "both @xmath106 in step  2 and @xmath107 in step  3 are drawn based on resampled @xmath102 , thus the resampling creates a new set of particles @xmath108 .",
    "steps 1 and  2 of the algorithm were suggested in the auxiliary particle filter of @xcite .    it has been previously shown that particle filters suffer the degeneracy issue when the number of particles is not sufficient [ @xcite ] .",
    "however , our approach relies on predictive likelihood and is less prone to a degeneracy issue , which plagues standard sample - importance resample filters .",
    "we illustrate our methodology on a data set from an accident on i-55 . we show how quickly our approach can identify a drop in capacity ( critical flow ) due to an accident . on may 9 , 2014 ,",
    "a semi - tractor trailer caught fire ( @xcite ) at 6:40  am on interstate highway i-55 near weber road in romeoville , illinois , which is a southwest suburb of chicago .",
    "the police shut down the southbound lanes .",
    "as is commonplace , the accident was visible from the other side of the road , and the `` rubbernecking '' effect , drivers slowing down to watch an accident , caused a dramatic reduction in capacity and congestion .",
    "there are several reasons for capacity reduction during an accident . under normal conditions , an average time delay",
    "before a vehicle starts accelerating following a leader is half a second .",
    "however , during an accident there is a large difference in times that drivers took to look at the accident location before accelerating .",
    "these results were obtained by @xcite via analyzed video taken by helicopter from accident locations .",
    "most of the vehicles would accelerate at the usual rate out of the jam , and the shock wave would move backward",
    ". however , it only requires a small fraction of drivers that keep driving slowly until they reach the accident location to cause large escape times at the location of the incident and hence for the low capacity .",
    "there is also heterogeneity in acceleration delays between left lane ( closest to accident ) and right lane . on average , in the left lane , cars take longer before accelerating .",
    "figure  [ fig : accident - location](a ) shows the map location of the accident .",
    "figure  [ fig : accident - location](b ) shows two of the loop detectors located before and after the accident location from which the data was collected .",
    "the length of the road segment between two loop detectors is 845 meters and we discretized it with four cells , with each space step @xmath109 meters and used time step @xmath110 minutes .",
    "this combination of time and space step satisfies the courant  friedrichs  lewy condition so that numerical stability in space and time is ensured .",
    "further , a five minute interval was chosen since it is a standard interval over which the measured data is averaged to provide smooth input data .",
    "our initial prior on road capacity is assumed to be uniform , with @xmath111 $ ]  veh@xmath13h , and we set critical density to @xmath112  veh@xmath13 m ; both are based on empirical observations of typical ranges for those parameters as shown in figure  [ fig : critical - densiti - flow ] . to replenish the parameters ( step 3 of the algorithm )",
    ", we used @xmath113  veh@xmath13h for capacity and @xmath114  veh@xmath13 m for critical density , as there is no learning for this parameter .",
    "the value for @xmath115 is based on empirical observations , that capacity change usually does not exceed 50 veh@xmath13h within a five minute interval .",
    "we have chosen the measurement noise s standard deviation to be @xmath116 veh@xmath13 m , and standard deviation for the evolution equation error to be equal to @xmath117 veh@xmath13 m .",
    "given that we did not have access to manufacturer s specifications of the loop detectors , we use a value within the guidelines of the specification .",
    "the error for the evolution equation was chosen to be consistent with the results reported in  @xcite , where authors report that standard deviation of the lwr model forecast error is usually under 3% , but higher for congested flow when compared with observation data from motorway sensors . in our numerical example",
    ", we use 4% .    to address the problem of model identification",
    ", we utilize the relation between free - flow speed , capacity and critical density , namely , @xmath118 .",
    "based on the data measured on a typical day during off - peak hours , the free - flow speed @xmath119  m@xmath13s .",
    "our particle weights are regularized by @xmath120},\\ ] ] where @xmath121 is the p.d.f . of the normally distributed variable .",
    "the prior error standard deviation was set at @xmath122  m@xmath13s .",
    "choice of both @xmath23 and @xmath123 is based on empirical observations .    figure  [ fig : accident](a ) compares the road capacity learned by the algorithm on the day of the accident and from the previous day , which was accident free , with similar weather conditions .",
    "figure  [ fig : accident](b ) shows the measured speed by the south loop detector on both days . there is a time lag of approximately 15 minutes between traffic flow speed reverts to a normal level and capacity recovers .",
    "this time lag corresponds to three measurements ( data is reported every five minutes ) and is explained by the time it takes the algorithm to learn the capacity .    .",
    "accident data was plotted using a solid line and normal day with a dashed line . ]",
    "our algorithm captures the effect of capacity degradation as a result of the accident .",
    "we provide 95% bayes credible intervals to demonstrate that uncertainty about the estimate is larger during the normal operating mode and lower during the periods of capacity degradation and recovery . if we compare the speed plot and capacity plot in figure  [ fig : accident](a ) and ( b ) , we can see that the slope of the speed curve on an accident day is much steeper than the slope of the learned capacity curve ; it is due to the fact that there is some delay associated with the learning process . in other words",
    ", the algorithm does not learn that the flow regime has recovered instantaneously , but rather it takes three to five measurements before it learns .",
    "under normal conditions , a full - width freeway lane has a capacity of 2000 passenger vehicles per hour [ @xcite ] , with a truck being counted as 1.5 passenger cars . in illinois , the loop detectors give reliable data for the vehicle counts but not for different vehicle classes and it is hard to identify the share of trucks in the traffic flow ; consequently , the flow is measured in vehicles per hour and not in passenger car units per hour .",
    "thus , the learned capacity is around 1500 veh@xmath13h on a normal day , that is consistent with the theoretical estimate from the highway capacity manual . on the accident day",
    "we detect a reduction in capacity of up to 66% .",
    "this is similar to the results of @xcite who use helicopter images from netherlands roads to observe a 50% reduction of capacity , due to the reduction of the discharge rate at the bottleneck ( accident location ) due to rubbernecking .",
    "a larger drop in our case might be explained by regional differences in driving style .",
    "american drivers might be driving more carefully in the presence of an accident , and by the fact that a truck on fire is more `` spectacular '' than a regular vehicle crash , with people spending more time to observe .",
    "such a drop in the flow rates is remarkable given the absence of any physical obstacles .",
    "the previous example illustrates a drop in capacity due to an accident . however , we do not know if the drop size is properly estimated since the ground truth is unobserved . to demonstrate that our algorithm properly captures state and parameter dynamics",
    ", we must use simulated data with a realistic traffic flow pattern .",
    "we simulate data that mimics traffic flow on chicago s i-55 highway .",
    "figure  [ fig : week - pattern ] below shows traffic patterns on february 6th , 2009 ( friday ) and all five work days of the following week ( week of february 9th ) .",
    "several conclusions can be drawn from the traffic patterns :    a.   break down start times are different from day to day , even on the same day of the week ( fridays ) of different weeks .",
    "b.   the duration of the flow at the lowest speed is different , with wednesday being the worst and thursday the best . c.   the breakdown period is shorter than the recovery period .",
    "the latter point follows from the asymmetric shape of the triangular fundamental diagram , where the free - flow speed @xmath23 ( speed at which drivers arrive to the end of the congestion queue ) is higher than the backward wave propagation speed @xmath20 ( speed at which drivers depart from the front of the congestion queue ) .",
    "-axis corresponds to the time of the day .",
    "]    our road segment is 1.5 kilometers long and we choose a time horizon of 1600 seconds .",
    "figure  [ fig : example1 ] shows our road segment model and its discretization scheme with five internal cells and 2 boundary cells .",
    "our discretization grid cell is of length @xmath124 meters and time interval of @xmath125 seconds .",
    "the initial conditions are set to be uniform traffic density of 0.01  veh@xmath13 m .        to mimic a typical morning commute pattern , we have chosen boundary conditions so that our simulated data set begins with a free - flow traffic regime followed by a breakdown and then recovery .",
    "the breakdown starts 3 minutes into the simulation and the recovery starts at the 10 minute mark . in the left boundary cell ( cell 0 )",
    "we have a constant vehicle density followed by a drop in density to zero ; see figure  [ fig : boundary](a ) .",
    "it mimics the constant inflow of morning commuters that eventually stops . on the right boundary cell ( cell 6 )",
    "we have uncontested density at the beginning , followed by density of 0.145 veh@xmath13 m , which represents heavily congested traffic flow , and followed by a drop in density to zero ; see figure  [ fig : boundary](b ) .",
    "the right boundary condition corresponds to a location where an on - ramp merges into a highway .",
    "when the flow on the ramp is high , a bottleneck is created at the merge location .",
    "the boundary conditions are shown in figure  [ fig : boundary ] .",
    "over the course of simulation we changed the traffic flow parameters .",
    "capacity and critical density parameters used to produce simulated data are shown in figure  [ fig : parameter - learning ] .        to simulate the measured data , we compute the solution of the lwr model for the measurement cells 1 and 5 and add noise to it .",
    "we have chosen the noise standard deviation to be @xmath126 veh@xmath13 m , and standard deviation for the evolution equation error to be equal to @xmath127 veh@xmath13 m .",
    "figure  [ fig : density - cell-3 ] compares the estimated traffic density in cell 3 with the true simulated traffic density for two different scenarios . in the first scenario we used the parameter learning step of the algorithm and in the second scenario we kept capacity and critical density parameters fixed .",
    "we can see the sensitivity to parameter learning . without learning ,",
    "the density profile is shifted in a meaningful way .",
    "clearly , full bayesian parameter learning corrects this bias .    .",
    "]        to illustrate the dynamics of parameter learning , we change the lwr parameters @xmath27 and @xmath28 several times throughout the simulation , as mentioned above . in principle",
    ", we could also directly model @xmath128 with its own state evolution .",
    "figure  [ fig : parameter - learning ] shows the expected value and 95th percentile of the filtered posterior distribution of the model parameters .",
    "we can see , as expected , there is a certain delay between the underlying parameter change and the filtering algorithm captures  the change .",
    "change in capacity is picked up faster than change in critical density .    , @xmath129 , @xmath130 , @xmath131 , @xmath132 , @xmath133 .",
    "]    in section  [ sec : mixture ] we showed that the distribution over traffic density is a mixture distribution at the locations when the density in the left cell is below critical density and the density in the right cell is above .",
    "to further demonstrate this fact , figure  [ fig : mixture ] shows the distribution over density at cell 3 before and after the shock wave travels through the cell .",
    "figure  [ fig : density - cell-3 ] shows that a shock wave travels through cell 3 between @xmath134 and @xmath135 .",
    "we can see that the distribution over state is unimodal at those time steps .",
    "however , in between , it is a mixture .",
    "appendix  [ sec : kalman - recursion ] develops the projection operator @xmath136 and the necessary kalman recursions for this and the following examples .",
    "in this paper we analyze the lwr traffic flow model with application to chicago s interstate i-55 highway .",
    "we show how particle filtering and learning provides a real - time estimate of the density states .",
    "we sequentially learn the parameters of the fundamental diagram which is the central input for the lwr dynamics of traffic flow .",
    "our results have a number of important implications for transportation system management applications .",
    "in particular , a real - time assessment of model states and parameters corrects the biases in estimating the current density of states used for forecasting .",
    "our methodology quickly handles the drop in capacity due to a major traffic accident on chicago s interstate i-55 highway .",
    "we also use a calibration study to show how close a filtered state vector is to the true one .",
    "when measurements are sparse in space and the parameters are fixed , pure filtering would misestimate the current state .",
    "however , our approach corrects this by incorporating parameters  learning simultaneously .",
    "this leads to an accurate estimation of traffic density .",
    "there are a number of possible avenues for a future approach .",
    "first , the lwr model is only valid when the relationship between flow and density is time independent .",
    "second , the model does not describe traffic behavior within a queue or when particular instabilities such as stop and go traffic exist .",
    "third , the model is not realistic for free - flowing traffic , as vehicle bypassing that happens frequently in this regime is not captured .",
    "although , from a system management perspective , free - flow traffic is not an issue , extending our approach to higher order traffic flow models will lead to improvements in estimation .    developing methods to incorporate model monitoring is an important area of future research .",
    "for example , alternative models might correspond to different assumptions about the shape of the fundamental diagram .",
    "we can statistically discriminate two models using a sequential likelihood ratio ( bayes factor ) , @xmath137 , given  by @xmath138 where @xmath139 .",
    "this is simply a product of marginal predictive densities , which the particle filter approximates by @xmath140 another avenue is to extend our particle algorithm to a transportation network with simultaneous tracking of multiple segments .",
    "this will make our methodology applicable to real - life transportation networks of a large metropolitan area . within our framework , it is feasible to filter over the boundary conditions",
    ". this also applies in the case of gps probes , where inferring the boundary conditions is a hard task , since location and time of the measurement are random and one rarely observes the boundary conditions .",
    "let @xmath8 , @xmath7 and @xmath141 denote traffic flow , density and speed at position @xmath4 at time @xmath5 .",
    "kinematic wave theory establishes a relationship between density @xmath142 and flow @xmath143 , which is known as the _ fundamental diagram _ given by the functional equation @xmath144 where @xmath8 is flow .",
    "the conservation law implies that with no inflow or outflow @xmath145    combined with fundamental diagram function , we obtain the equation for @xmath7 : @xmath146 the term @xmath147 is called the wave velocity . to get a more intuitive understanding of the problem , it is convenient to use the cumulative flow @xmath148 , the number of vehicles that pass location @xmath4 by time @xmath5",
    ". then the conservation law can be derived by evaluating @xmath149 assuming that @xmath148 is smooth , @xmath150 we get the conservation law ( [ eqn : conservative - law ] ) . in practice , the function @xmath151 has discontinuity of the first kind ( first derivative ) , however , the conservation law holds in the case of discontinuities as long as @xmath148 is continuous along the shock path .",
    "the method of characteristics can be used to solve the equation ( [ eqn : conservative - law ] ) .",
    "specifically , from ( [ eqn : conservative - law ] ) @xmath7 is constant ( @xmath152 ) along a characteristic curve ( wave ) described by @xmath153 eliminating @xmath154 gives @xmath155 thus , density is constant along the straight line with slope @xmath156 ( characteristic line ) and the slope is nothing but a shock propagation speed . for a free - flow speed the shock moves forward and for jammed traffic it moves backward . in newell",
    "s case the forward shock propagation speed is @xmath23 and the backward shock propagations speed is given by @xmath20 .",
    "measurements are taken at the first and last cells of the road segment and noise is independently distributed , with covariance structure @xmath157 and @xmath158 .",
    "the operator @xmath159 and the kalman gain matrix @xmath160 are of the following form : @xmath161 this leads us to the following kalman updates : @xmath162 \\mu_{t+1 } & = & \\biggl(\\mu^f_1 + \\frac{w ( y_1-\\mu^f_1 ) } { v+w},\\mu^f_2,\\mu^f_3 , \\mu^f_4,\\mu^f_5 + \\frac{w ( y_2-\\mu^f_5 ) } { v+w } \\biggr)^t.\\end{aligned}\\ ] ] the variance of the predictive likelihood distribution is given by @xmath163"
  ],
  "abstract_text": [
    "<S> transportation departments take actions to manage traffic flow and reduce travel times based on estimated current and projected traffic conditions . </S>",
    "<S> travel time estimates and forecasts require information on traffic density which are combined with a model to project traffic flow such as the lighthill  whitham </S>",
    "<S>  richards ( lwr ) model . </S>",
    "<S> we develop a particle filtering and algorithm to estimate the current traffic density state and the lwr parameters . </S>",
    "<S> these inputs are related to the so - called fundamental diagram , which describes the relationship between traffic flow and density . </S>",
    "<S> we build on existing methodology by allowing real - time updating of the posterior uncertainty for the critical density and capacity parameters . </S>",
    "<S> our methodology is applied to traffic flow data from interstate highway i-55 in chicago . </S>",
    "<S> we provide a real - time data analysis of how to learn the drop in capacity as a result of a major traffic accident . </S>",
    "<S> our algorithm allows us to accurately assess the uncertainty of the current traffic state at shock waves , where the uncertainty is a mixture distribution . </S>",
    "<S> we show that bayesian learning can correct the estimation bias that is present in the model with fixed parameters </S>",
    "<S> .    ./style / arxiv - general.cfg </S>"
  ]
}