{
  "article_text": [
    "the study of avoiding repetition in combinatorial structures stems from a 1906 paper by axel thue @xcite , which showed that a there is an infinite word in @xmath10 that has no subword of the form @xmath11 for some finite word @xmath12 .",
    "such a word is called squarefree .    a paper by alon , grytczuk , haluszczak , and riordan @xcite introduced the generalization to edge colorings of graphs .",
    "an edge coloring of a graph is _ nonrepetitive _ if for any open path through the graph , the pattern of colors along the path is squarefree .",
    "the thue number @xmath4 is the smallest number @xmath13 for which @xmath5 can be nonrepetitively colored with @xmath13 colors .",
    "alon et al .",
    "also mentioned the possibility of studying _ vertex nonrepetitive colorings _",
    ", i.e. , vertex colorings with the same property .",
    "this notion has been further studied in papers by czerwiski and grytczuk @xcite and by bart and varj @xcite .",
    "other similar notions involving walks rather than paths have been developed by brear and klavv zar @xcite and again by bart and varj @xcite . for a more detailed survey of results regarding vertex nonrepetitive colorings ,",
    "we refer the reader to grytczuk @xcite .",
    "the many papers in this area employ various notations and terminologies ; we will stick to the original terminology of alon et al .  whenever possible .",
    "therefore , we refer to edge nonrepetitive colorings simply as nonrepetitive colorings and denote the edge coloring thue number as @xmath4 .",
    "we call a path _ square _ if it is of the form @xmath11 for some color - string @xmath12 .",
    "our goal is to study nonrepetitive colorings from the point of view of computational complexity .",
    "whatever version of @xmath4 is used , deciding whether @xmath14 is an @xmath15 problem : does there exist a @xmath13-coloring of the edges or vertices of @xmath5 such that the pattern of colors along any open path , or one of the kinds of walks , is squarefree ?",
    "such questions usually belong in the class @xmath16 , a class in the second level of the polynomial hierarchy . this class and problems known to be complete for it are described in a survey by schaefer and umans @xcite .    many of the results of papers on nonrepetitive colorings which bound the thue number of various classes of graphs  for example , alon et al.@xcite show that @xmath17 for constant @xmath18 for any graph of degree @xmath19 . on the other hand ,",
    "alon et al .  also show that for any @xmath19 there is a graph @xmath5 of maximum degree @xmath19 such that any nonrepetitive vertex coloring of @xmath5 requires at least @xmath20 colors .",
    "both these results , and many others like them , are probabilistic and thus give us little information about specific graphs .",
    "the complexity of vertex nonrepetitive colorings has recently been studied by marx and schaefer @xcite , who showed that deciding whether such a coloring is nonrepetitive is * conp*-complete . in this paper",
    "we show that the corresponding problem for edge colorings is * conp*-complete .",
    "we then show that deciding whether @xmath14 is @xmath21-complete .    finally , we turn to colorings that are nonrepetitive for bounded - length paths .",
    "let @xmath22 be the least number of colors required to color the edges of @xmath5 so that no open path contains the square of a pattern of colors of length @xmath23 , and let @xmath24 be the least number of colors required to color the vertices of @xmath5 under analogous conditions .",
    "since the number of paths of length @xmath25 is bounded by @xmath26 , for fixed @xmath27 each such problem is contained in * np*. then @xmath28 is simply graph coloring and @xmath29 is edge coloring , shown to be * np*-complete by holyer in 1981 @xcite .",
    "@xmath30 is known as the symmetric chromatic number ; the corresponding decision problem is shown to be * np*-complete by coleman and mor @xcite .",
    "we show that the decision problems corresponding to @xmath31 and @xmath32 for any @xmath33 are * np*-complete .",
    "the nonrepetitive colorability of a graph with @xmath13 colors is a rather slippery property . in the construction of a nonrepetitive coloring ,",
    "changing the color of an edge may produce a square path of arbitrary length and thus affected by colors of edges arbitrarily far away .",
    "thus the local properties of a graph can not guarantee that it is nonrepetitively colorable . on the other hand ,",
    "if a graph does not have a nonrepetitive coloring , then we must examine all of the colorings and find a square path in each , which also feels like a hard problem .",
    "thus neither direction of the reduction is easy .",
    "there are two immediately visible approaches to resolving this dilemma .",
    "perhaps we could focus on fairly sparse graphs , thus minimizing the number of paths we must make sure are nonrepetitive .",
    "but this would greatly increase the number of colorings we must consider .",
    "we thus use this approach only in determining whether a preassigned coloring is nonrepetitive . on the other hand",
    ", we could focus on graphs in which the degree of every vertex is close to the maximal degree of the graph .",
    "although this allows us to easily discard most possible colorings , the number of distinct paths grows exponentially .",
    "additionally , it becomes harder to create graphs which differ subtly in global structure in such a way that some of them are nonrepetitively colorable and others are not .    in our proof",
    ", we combine these two approaches , producing graphs that are locally dense , in the sense that the degree of most vertices is large and close to the maximal degree , but globally sparse , in the sense that long paths must traverse a number of bottlenecks with only a few connections . while a pattern of local structures , or gadgets , is common to many if not all graph - theoretic complexity proofs , in this case in particular it allows us to partially isolate each portion of the problem : once we have established that the local structure is nonrepetitively colorable in a very constrained set of ways , we can us this to determine whether the global structure is nonrepetitively colorable .",
    "we will first construct the global structure , which is similar to the well - known reduction which shows that hampath is * np*-complete .",
    "the local structure , added later , will be composed of several types of dense subgraphs .",
    "the simplest of these are the cliques of size @xmath34 , which alon et al .",
    "show to be nonrepetitively colorable with @xmath34 colors .",
    "we also use the @xmath6-dimensional hypercube graphs , which have a number of useful properties which are discussed in the next section .",
    "finally , in a number of cases we will _ saturate _ a vertex @xmath35 by adding extra vertices only joined to @xmath35 , called the _ plume _ of @xmath35 , to artificially inflate the degree .",
    "this will allow us to more effectively use the saturation lemma below .",
    "we will now prove some results about nonrepetitive colorings that will aid in the complexity proofs .",
    "let a vertex of a graph be _ saturated _ if it is of maximal degree , and let a _ diamond _ be a cycle of four vertices .",
    "suppose two opposing vertices of a diamond , @xmath36 and @xmath37 , in a graph of degree @xmath13 , are saturated and the saturating edges are not directly connected",
    ". then the graph may only be @xmath13-nonrepetitively colored if the diamond is colored with exactly two colors .",
    "let @xmath38 and @xmath39 be the colors of one path from @xmath36 to @xmath37 through the diamond .",
    "then , since @xmath36 and @xmath37 are saturated , there must be an edge of color @xmath39 at @xmath36 and an edge of color @xmath38 at @xmath37 , forming a path of colors @xmath40 . if this path is not a cycle , then the coloring is not nonrepetitive .",
    "thus , these colors must form the other half of the diamond .",
    "the nonrepetitive @xmath13-edge - coloring of a @xmath13-hypercube exists , is unique up to permutation , and has the following properties :    1 .",
    "the shortest path between any two points consists of distinct colors . 2 .",
    "any permutation of the colors of a path between two points consisting of distinct colors also colors a path between those two points , and no other sequence of distinct colors does .",
    "3 .   any path consisting of distinct colors is a shortest path between its endpoints .",
    "4 .   there are @xmath41 vertices at distance @xmath27 from a given vertex @xmath42 .",
    "the uniqueness of coloring also holds for portions of a @xmath13-hypercube whose distance from a chosen base vertex @xmath42 is at most @xmath43 , which we call the _",
    "first @xmath43 layers _ of the hypercube .",
    "we will identify the vertices of the hypercube with @xmath44 , where there is an edge between @xmath45 and @xmath46 for every @xmath27 .    without loss of generality ,",
    "let us choose the vertex @xmath42 identified with @xmath47 to be a base vertex .",
    "@xmath42 is saturated , so the coloring of the edges adjacent to it is unique up to permutation .",
    "thus the coloring of the first layer is unique .",
    "now suppose that we have colored the first @xmath43 layers . every vertex is saturated and any two adjacent edges form a diamond ( a face . )",
    "hence by the previous lemma the coloring of the @xmath43th layer determines the coloring of the @xmath48st layer . by induction ,",
    "the coloring of the first @xmath43 layers is unique , and so is the coloring of the entire hypercube .    to show that a coloring exists ,",
    "let us use the color @xmath27 for all edges for which @xmath49 changes between the two vertices .",
    "for every @xmath27 , the hypercube consists of two @xmath50-hypercubes , one in which the @xmath27th coordinate is 0 for all vertices and one in which it is 1 .",
    "therefore , if we have a path containing two edges of color @xmath27 , then we can create an alternate path with the same start and end vertices by removing these two edges and reversing @xmath49 for the vertices in between them .",
    "now suppose we have a square path .",
    "then for every dimension , there is an even number of edges in that dimension on the path , and we can remove all these edges by pairs from the path . thus the path is equivalent to the empty path , is therefore a cycle , and all open paths are squarefree .",
    "we will now use this construction to prove the rest of the properties . for ( 1 ) , suppose that we have a shortest path between two points that contains two edges of the same color .",
    "then we can remove these two edges and get a shorter path between the same two vertices .",
    "therefore the shortest path must consist of distinct colors .",
    "for ( 2 ) , clearly a permutation of the changes to variables leads to the same result .",
    "on the other hand , for any two shortest paths whose sets of colors differ , there is an @xmath27 such that @xmath49 is different between the two end vertices for one of the paths , but not for the other .",
    "thus the end vertices are different for the two paths .",
    "\\(3 ) follows directly from ( 1 ) and ( 2 ) .",
    "a path of length @xmath27 represents a change in @xmath27 members of the @xmath13-tuple .",
    "there are @xmath41 possible such changes , proving ( 4 ) .",
    "in this section , we consider several related problems in which the coloring is entirely or almost entirely predetermined , and the main difficulty of the problem is in finding whether the coloring is nonrepetitive .",
    "the proofs in this section are all related and provide a framework for the proof of the @xmath21-completeness of thue number .",
    "we first consider colorings of directed graphs .    given a directed graph @xmath5 and a coloring thereof , it is * conp*-complete to determine whether the coloring is nonrepetitive .",
    "we call this problem directed nonrepetitive coloring .",
    "we reduce from co-3sat .",
    "the reduction is similar to the standard reduction from 3sat to hampath .",
    "the edges are given a large number of colors , with 4 or fewer edges per color .",
    "in effect , we restrict possible square paths to those that go through two edges of every color , mimicking the requirement that a hamilton path must pass through every vertex .",
    "let @xmath51 be an instance of 3sat .",
    "the reduction will use two types of gadgets : a variable gadget and a clause gadget .",
    "the variable gadget consists of two sets of @xmath52 vertices , where @xmath52 is the largest number of number of instances of a literal , together with a beginning vertex @xmath53 .",
    "a path of edges goes from @xmath53 through each of the vertices in a set to @xmath54 , or a vertex @xmath18 if @xmath55 . the sets of vertices and paths going through them correspond to a true assignment and a false assignment ; thus each set signifies a literal .",
    "suppose @xmath56 has clauses numbered @xmath57 .",
    "a clause gadget for clause @xmath58 has one vertex @xmath59 , and we add an extra vertex @xmath60 and an edge from @xmath18 to @xmath61 . for each literal in @xmath58 ,",
    "we add an edge from @xmath59 to a vertex on the path corresponding to this literal and an edge from this vertex to @xmath62 or @xmath60 if @xmath63 , making sure that this is the only clause gadget that uses this vertex .    to complete the construction of the graph , we add a series of vertices @xmath64 and edges connecting @xmath65 to @xmath66 and @xmath67 to @xmath68 .",
    "we call this structure the _ snout_. we must now assign a coloring to this graph",
    ". we will use a set @xmath69 of colors .",
    "starting from the tip , we color the @xmath27th edge of the snout with @xmath70 .",
    "we color the @xmath13th edge of a path through the @xmath71-gadget by @xmath72 ; an edge going into @xmath59 by @xmath73 ; an edge leaving @xmath59 by @xmath74 ; and an edge going into @xmath60 by @xmath75 .",
    "given a satisfying assignment to @xmath56 , we can construct a square path by first traversing the snout , then taking the path through each variable gadget corresponding to the opposite of its assignment and the path through each clause gadget corresponding to a true literal , as illustrated for an example .",
    "conversely , if we have such a path , then taking the opposite of a traversed literal - path to be true gives us a satisfying assignment .",
    ", with a square path highlighted .",
    "]    now suppose that @xmath56 is unsatisfiable , and that there is a square path @xmath76 , which then can not have the form above .",
    "suppose first that the edges of @xmath76 are colored only by the colors of the variable gadgets .",
    "since the colors of the variable gadgets form the tip , but not the base of the snout , @xmath76 must consist only of the variable gadgets themselves ; but this is impossible since the variable gadgets can only be traversed in the forward direction and thus a path through them has no two edges of the same color .",
    "( * ) thus @xmath76 must contain edges from clause gadgets .",
    "since any two edges in a clause gadget that share a color also share a vertex , an open path can contain only one of such a set .",
    "thus , for every color @xmath38 that colors an edge of @xmath76 contained in a clause gadget , @xmath76 contains an edge in the snout of color @xmath38 . since @xmath68 is only the source of the two branches of the first variable gadget , one of these two branches must also be contained in the path .",
    "furthermore , since these branches share a vertex , only one of them may be contained in @xmath76 .",
    "the only other edge colored by @xmath77 is the edge at the very tip of the snout ; thus the entire snout must be contained in @xmath76 , so @xmath76 must contain a path belonging to each variable and clause gadget . as above , this defines a satisfying assignment to @xmath56 , a contradiction .",
    "clearly , this reduction runs in polynomial , in fact quadratic , time .",
    "the graph resulting from this reduction has maximum in- and out - degree 3 .",
    "each color is repeated at most four times .",
    "from this we can fairly easily show the same result for undirected graphs .",
    "given an undirected graph @xmath5 and an edge - coloring thereof , it is * conp*-complete to determine whether the coloring is nonrepetitive .",
    "we call this problem nonrepetitive coloring .    we will now modify the previous reduction to work with undirected graphs .",
    "let us add the colors @xmath78 , for @xmath79 and @xmath80 .",
    "we call these the _ direction - determining colors _ and the rest the _ original colors_. we replace every edge inside the snout with the graph in figure 2 and every edge outside the snout with the path @xmath81 for some @xmath82 .",
    "this can be done in such a way that there are no trivial repetitions , that is , no two edges of the same color are incident to the same vertex , since the maximum in- and out - degree of the directed graph is 3 . clearly , this construction retains the property that each color colors no more than four edges , since none of the direction - determining colors need color more than two edges .",
    "we will show that this modification leaves the reduction valid .    .",
    "]    if @xmath56 has a satisfying assignment , we can traverse the graph as before , choosing the right path through the snout to produce the same @xmath65s , @xmath53s , @xmath83s , and @xmath84s as in the other half of the path .",
    "now suppose that @xmath56 is unsatisfiable .",
    "suppose that the graph has a square path .",
    "clearly , this path must contain direction - determining colors .",
    "each such color is represented only once in the non - snout edges , so we can not make a square path without any snout edges .",
    "this means that the paragraph marked ( * ) in the previous proof still applies , and we are done .    we now modify the statement of the problem slightly in order to get a @xmath21-complete problem .",
    "given an undirected graph @xmath5 and a set @xmath85 of pairs @xmath86 for each edge @xmath87 , with @xmath88 a set of colors , it is @xmath89-complete to determine whether there exists a nonrepetitive coloring of @xmath5 that uses a color @xmath90 for each @xmath87 .",
    "we call this problem restricted thue number .    in our case , @xmath91 will contain at most two colors for any edge , and only one color for most edges .",
    "clearly , the problem is in @xmath89 . to prove that it is @xmath89-hard",
    ", we shall slightly modify the previous reduction , reducing from co-@xmath923sat .",
    "let @xmath93 be an instance of @xmath923sat .",
    "our graph @xmath5 will be the graph constructed for @xmath94 in theorem 2 . for each universally quantified variable , the two original edges that initially separate the variable gadget into a `` true '' and a `` false '' branch are given the sets @xmath95 and @xmath96 respectively , where @xmath70 is the color given these edges in the previous reduction .",
    "the corresponding edge in the snout is given the set @xmath97 .",
    "the rest of the edges are given singletons containing the color they were colored in the previous reduction .",
    "thus a coloring of the graph satisfying the restriction corresponds to an assignment of @xmath12 , since it forces any potentially square path to go through the specified branch of the corresponding variable gadget .",
    "this means , by the previous construction , that there is such a nonrepetitive coloring of @xmath5 iff there is an assignment to @xmath12 for which @xmath98 is unsatisfiable .",
    "this proof provides the final incarnation of the global structure which we will later harness to show that thue number is @xmath99-complete .",
    "in this section , we explore two problems in which we consider a polynomial number of possibly square paths , and therefore only the existential quantifier in the statement of the problems is over an exponentially large domain . together , the problems form a generalization of edge coloring , a problem which was shown to be * np*-complete by holyer in 1980 @xcite .    in these proofs",
    ", we employ several tricks to find graphs whose small - diameter subgraphs are restricted in the ways they can be colored nonrepetitively .",
    "these tricks will later find applications in the proof of the @xmath21-completeness of thue number .",
    "thus although this material is not directly related to the main result , it builds some machinery for its proof .",
    "still , a reader interested only in the main proof may go on to the next section .",
    "it is * np*-complete to determine whether @xmath100 .",
    "we reduce from edge coloring for cubic graphs ( graphs with 3 edges incident to every vertex ) and 3 colors , which is shown to be * np*-complete in @xcite .",
    "the reduction consists of replacing each edge of graph @xmath5 with the graph depicted in fig .  3 , which we shall call a _",
    "clam_. the vertices incident to the edge are mapped to @xmath36 and @xmath37 .",
    "we shall argue that the resulting graph @xmath101 can be 6-colored with nonrepetitive 4-paths iff @xmath5 can be 3-colored .",
    "suppose that we have such a coloring , and call the six colors @xmath102 .",
    "note first that vertices @xmath36 and @xmath37 are both saturated , since they are images of vertices of @xmath5 of degree 3 , so the outer diamond of the clam only has two colors  without loss of generality , @xmath38 and @xmath39 .",
    "now suppose that one of the inner four edges ( let us call them the _ gills _ ) is colored @xmath38 .",
    "then if the color of an edge of the inner diamond connected to this edge is @xmath18 , there is a path @xmath103 through gill , inner diamond , outer diamond , and an edge of another clam .",
    "thus the gills must be colored differently from the outer diamond , as must the inner diamond since it is adjacent to the outer one .",
    "this means that the vertex labeled @xmath42 and the one symmetric to it are saturated for the four colors other than @xmath38 and @xmath39 , and thus the inner diamond must be colored with exactly two colors ( @xmath18 and @xmath60 . )",
    "now let us add two more clams , incident to vertices @xmath104 and @xmath105 respectively , at vertex @xmath36 .",
    "suppose that the outer colors of the clams are @xmath106 and @xmath107 respectively .",
    "then to prevent square paths of the type @xmath103 from the inner diamond of clam @xmath108 to the inner diamond of clam @xmath109 , the inner diamonds of clams @xmath108 and @xmath110 must consist of the colors @xmath107 and @xmath106 respectively .",
    "but then we get square paths of the form @xmath111 from the inner diamond of clam @xmath108 to the inner diamond of clam @xmath110 .",
    "thus the outer colors of @xmath108 and @xmath110 must be @xmath112 and @xmath113 , in some order .",
    "furthermore , the inner colors of @xmath108 must be @xmath113 to prevent @xmath103-type repetitions .",
    "this forces the inner colors of @xmath110 to be @xmath114 .",
    "this means that the coloring of one clam at a vertex of @xmath5 determines the sets of colors available to the other clams ; by induction , each clam in the graph must be colored using one of these three patterns .",
    "this means that if we have a 3-coloring of @xmath5 , we can map the three colors onto the three clam - coloring patterns to produce a 2-nonrepetitive 6-coloring of @xmath101 ; conversely , with a nonrepetitive 6-coloring of @xmath101 , we can map the three clam - coloring patterns onto three colors with which we can edge - color @xmath5 .    for any natural number @xmath33 and graph @xmath5",
    ", it is * np*-complete to determine whether @xmath115 .",
    "this is a generalization of the previous reduction .",
    "however , one must view the clam not as a unified gadget , but as a combination of elements of three gadgets .",
    "the two edges incident to vertex @xmath36 belong to vertex gadget @xmath36 , and likewise for vertex @xmath37 .",
    "the edge gadget proper , then , consists of the inner diamond and the gills .",
    "we again reduce from edge coloring for cubic graphs in 3 colors .",
    "let @xmath5 be a cubic graph .",
    "we associate to @xmath5 a 3-coloring @xmath116 of the edges . as we construct the gadgets in the reduction",
    ", we will also construct a @xmath117-coloring of the edges based on @xmath116 .",
    "later , we will show that this coloring is @xmath118-nonrepetitive iff @xmath116 is a valid edge coloring , and that no other coloring of the edges is @xmath118-nonrepetitive .",
    "we shall now enumerate the elements of the reduction , which reduces @xmath5 to a graph @xmath101 .",
    "the vertex gadget consists of the first @xmath13 layers of a @xmath117-hypercube with respect to a central vertex @xmath119 . by the hypercube lemma",
    ", this has a unique nonrepetitive coloring .",
    "now let us divide the @xmath117 colors into three groups of @xmath120 , called _ red _ , _ green _ , and _ blue_. we shall use the term _ grue _ to refer to the union of the sets blue and green .",
    "the elements of the sets will be referred to as _",
    "shades_. for each of the groups , there are @xmath121 vertices whose distance from @xmath119 is @xmath13 such that the path to them from @xmath119 consists of edges of colors from that group .",
    "we identify these vertices with an analogous group from another vertex gadget ( with central vertex @xmath122 ) in order to form an edge .    in a @xmath118-nonrepetitive coloring ,",
    "the colors of the edges on either side of this connection are in the same set of @xmath120 .",
    "suppose we have a @xmath118-nonrepetitive coloring that does not have this property .",
    "then take an arbitrary path from @xmath119 to @xmath122 of length @xmath120 , say with color pattern @xmath123 . by the properties of the @xmath117-hypercube",
    ", there must be a path starting with @xmath119 of pattern @xmath124 and a path starting with @xmath122 of pattern @xmath125 .",
    "this forms a square path of length @xmath118 , which must then be a cycle .",
    "this means that the sets of colors on either side of the inter - vertex interface are the same .",
    "assume they are both red .",
    "then , since the fully - red paths from @xmath119 to @xmath122 form a @xmath120-hypercube , they can be colored nonrepetitively .",
    "we assume now that we are working with two vertices , @xmath119 and @xmath122 , that are joined by a red edge .",
    "the construction for the other two sets is analogous .",
    "it remains to add a gadget that will force the green and blue sets of one vertex to be the same as the green and blue sets of the other . to this end , we take two vertices , @xmath36 and @xmath37 , on the interface between two vertex gadgets , whose distance from each other is @xmath120 , to be two ends of a consistency gadget .",
    "the consistency gadget is a @xmath118-hypercube modified in two ways .",
    "first , every vertex whose distance from @xmath36 and @xmath37 is 2 or more has a _ plume _ of @xmath120 additional edges leading to disconnected vertices .",
    "a red edge separated by one edge from @xmath36 or @xmath37 generates a square path of length 4 , so this means all the vertices of the hypercube are effectively saturated .",
    "this implies that the hypercube is entirely grue and the plumes are red . on the other hand",
    ", the farther red plume edges do not generate such a path , since it would have to repeat a red edge followed by two or more grue edges as a path from the red interface vertices , and thus required by hypercube property ( 3 ) to stray a distance more than @xmath13 from the central vertex of the vertex gadget .",
    "next , for every path starting at @xmath36 or @xmath37 and consisting of @xmath13 edges of distinct shades of green , we remove the last edge .",
    "we then do the same for blue .",
    "we also remove all red plume edges incident to the vertices that are left unsaturated by this removal .",
    "we call the @xmath13th layer of the hypercube from either @xmath36 or @xmath37 the _ gap layer_.    this consistency gadget is uniquely @xmath118-nonrepetitively @xmath117-colorable up to isomorphism .",
    "this coloring is such that the hypercube edges are grue and colored as the restriction of a full hypercube , and the plumes are red .",
    "any diamond containing edges in the layer adjacent to the gap layer has two saturated vertices at equal distance from the vertex gadget .",
    "suppose there is an edge between two vertices that are both unsaturated due to the removal .",
    "if those two vertices both became unsaturated from the removal of edges of the same color , then the edge would have to be of that color , and thus also removed . on the other hand , an edge between two vertices that are unsaturated due to the removal of different colors would not exist by hypercube property ( 2 ) .",
    "thus any diamond that has edges in the gap layer has saturated vertices either laterally or vertically , and so by the saturation lemma the coloring is a restriction of the full hypercube .",
    "we then add a second , identical consistency gadget at vertices @xmath104 and @xmath105 whose distances from @xmath36 and @xmath37 are at least 4 .",
    "( this distance prevents a square path consisting of a red plume edge in the first consistency gadget , then some path through it , then two red edges , the same path through the second consistency gadget , and another red plume edge . )",
    "we refer to the set of colors that form the interface between two vertex gadgets as an _",
    "edge set_.    if the original graph is not 3-edge - colorable , the resulting graph is not @xmath118-nonrepetitively @xmath117-edge - colorable .    given a red edge set , suppose that another edge set of the same vertex gadget with central vertex @xmath119 , belonging to edge @xmath87 of @xmath5 , has both green and blue parts .",
    "this means that that one of its consistency gadgets will have a path to it that contains both green and blue , since if one of the consistency gadgets has an all - blue side and an all - green side , then the other one does not .",
    "thus we can find a square path consisting of :    1 .   a red plume edge that duplicates the last edge of ( 3 ) , 2 .",
    "a path of length @xmath13 in a consistency gadget of the red edge that duplicates ( 4 ) , 3 .   a path from the consistency gadget of the red edge set to @xmath119 , 4 .   a mixed blue - green path from @xmath119 to one of the blue - green edge set s consistency gadgets , and 5",
    ".   a path of length @xmath50 in this consistency gadget that duplicates the first @xmath50 edges of ( 3 ) .",
    "therefore , the edge sets can not be of mixed colors with respect to the red edge set s consistency gadget .",
    "if @xmath5 is 3-edge - colorable , then the coloring of @xmath101 which we have described is @xmath118-nonrepetitive .",
    "suppose that @xmath5 is 3-edge - colorable , and let @xmath126 be a square path in @xmath101 of length at most @xmath118 , where @xmath127 and @xmath128 are the repetitions of the pattern .",
    "the portion of @xmath76 inside a gadget @xmath129 will be called @xmath130 .",
    "clearly , @xmath76 can not be wholly inside a consistency gadget .",
    "we have also already established that @xmath76 can not be wholly outside any consistency gadgets .",
    "thus it include edges from both consistency and vertex gadgets .",
    "since a consistency gadget has distance @xmath118 between its two attachment points , @xmath76 can not have a consistency gadget in the middle . in introducing the red plumes in the consistency gadget",
    ", we also showed that the whose middle vertex of @xmath76 can not be a junction between a consistency gadget and a vertex .",
    "thus at least one half - path of @xmath76 ( without loss of generality , @xmath127 ) contains parts of both a consistency gadget @xmath131 and a vertex gadget @xmath132 with center @xmath119 .",
    "@xmath133 contains at most one of the colors that are found on a shortest path to @xmath119 from the juncture with the consistency gadget .",
    "if such a color is in @xmath133 , it must be a plume , which forces @xmath133 to be at least three edges long .",
    "suppose now that the rest of @xmath76 is contained in @xmath132 .",
    "we will show that the distance from the last vertex @xmath42 of @xmath76 to @xmath119 is greater than @xmath13 , a contradiction .",
    "if a color has both of its repetitions inside @xmath132 , these cancel each other out , so we are left with the edges that repeat @xmath133 .",
    "but since there is at least one more grue than red edge in @xmath133 , this means that our initial distance @xmath13 from @xmath119 increases by at least one .",
    "this means that @xmath76 must access either a consistency gadget or another vertex gadget . without loss of generality , assume that @xmath131 belongs to a red edge set .",
    "_ case 1 _ : @xmath76 accesses a second consistency gadget that belongs the same edge set .",
    "then there are at least four shades of red that are repeated an odd number of times in the vertex gadget portion of the path .",
    "since there is at most one red edge in each consistency gadget part of the path , nothing can repeat these edges .",
    "_ case 2 _ : @xmath76 accesses a different consistency gadget , without loss of generality from a blue edge set .",
    "then @xmath134 must contain at least @xmath120 colors that color an odd number of edges , since the distance between the two consistency gadgets is @xmath120 .",
    "this is the maximal number of distinct colors in the path we are considering , so each of the @xmath120 must be repeated in one of the two consistency gadgets .",
    "this means that one of the consistency gadgets contains a red - blue path of length at least @xmath13 .",
    "however , this must pass through edges that we have removed , so no such path exists .",
    "_ case 3 _ : @xmath76 accesses a vertex gadget @xmath135 which interfaces @xmath132 at a non - red edge set .",
    "this again means that there are @xmath120 distinct colors in @xmath134 , and the @xmath120 edges in @xmath136 and @xmath137 must repeat these . in particular",
    "this means that the edge that repeats the edge of @xmath134 adjacent to @xmath131 must be the edge of @xmath137 adjacent to @xmath132 , and so this edge must be colored a shade of red , which is a contradiction .",
    "_ case 4 _ : @xmath76 accesses a vertex gadget @xmath138 which interfaces @xmath132 at the red edge set .",
    "each time that @xmath134 or @xmath137 traverses a grue edge before the last vertex in @xmath76 that belongs to both @xmath132 and @xmath138 , another edge of the same color must be accessed , by hypercube property ( 3 ) .",
    "since there must be an even number of edges of any color , this means that unrepeated edges in the consistency gadget must be repeated by similar edges in the portion after this last crossover .",
    "also , since all but at most one shade of red has to be traversed twice within the non - consistency - gadget portion , all the red colors together bring the path to within one edge of the border of a vertex gadget .",
    "but in that case there are at least two grue edges in the consistency gadget portion , again pushing the path beyond the radius of the vertex gadget .",
    "thus there is no way for such a @xmath76 to exist .",
    "this means that the resulting graph may be @xmath118-nonrepetitively @xmath117-edge - colored iff the original graph can be 3-edge - colored .",
    "note that there is nothing special about the original graph being of degree 3 .",
    "if the original graph is regular of degree @xmath60 , then we can construct a similar new graph with a vertex gadget being a slice of a @xmath139-hypercube , a consistency gadget being a modified @xmath140-hypercube , and so on .",
    "taking into account the vertex and consistency gadgets , for an original graph with @xmath38 edges , the resulting graph of this reduction has @xmath141 edges .",
    "this means that if @xmath13 depends logarithmically on @xmath38 , then the reduction still runs in polynomial time with respect to @xmath38 .",
    "this raises questions about other versions of the problem where @xmath13 is not constant , but a sub - linear function of @xmath142 .",
    "we now proceed to the main result of the paper , showing that thue number is @xmath21-complete .",
    "we use a reduction based on that of theorem 3 , taking a graph very similar to that produced in theorem 3 and replace the edges with various gadgets depending on their function in that reduction .",
    "we also add constraint gadgets in order to force the edge gadgets that would have been colored the same in theorem 3 to still have similar patterns of colors . after we show that a nonrepetitive coloring of this graph must satisfy a large number of constraints stemming from this local structure , we can use the global structure from theorem 3 to show that an actual nonrepetitive coloring exists if and only if the ancestral instance of co-@xmath923sat is positive .",
    "while this is the idea of the proof , in reality , the local structure is not cleanly separated from the global structure : the format of the latter helps constrain the former .",
    "thue number is @xmath89-complete .",
    "given an instance @xmath143 of co-@xmath923sat , we will refer to the instance @xmath144 of restricted thue number constructed in theorem 3 .",
    "let @xmath145 be the number of colors coloring @xmath5 , @xmath146 , and let @xmath147 be the smallest integer such that @xmath148 and @xmath149 .",
    "let @xmath150 be the two colors corresponding to the universally quantified variable @xmath71",
    ". then we modify @xmath5 by introducing new colors @xmath151 and @xmath152 and replacing each edge colored by @xmath153 by three edges in series colored @xmath154 . clearly , this graph @xmath155 restricted thue number iff @xmath144 is .",
    "we construct from this graph an instance @xmath156 of thue number .",
    "let @xmath157 be the set of colors that are not @xmath158 for @xmath159 .",
    "for every edge @xmath87 of @xmath160 whose color is from @xmath157 , we add to @xmath101 a 7-hypercube @xmath161 with two opposing vertices ( @xmath162 for the one closer to the tip of the snout along a potentially square path and @xmath163 for the other one ) acting as the vertices of the edge gadget . for each color @xmath164 and for each pair",
    "@xmath165 , we also add a consistency gadget @xmath166 ( respectively @xmath167 ) .",
    "this consists of a @xmath168-clique with every vertex identified either with the central vertex of the first two layers of a 7-hypercube , called the _ plume _ emanating from this vertex , or with a vertex of an edge gadget . for each edge",
    "@xmath87 whose color is @xmath169 , two vertices of @xmath161 are identified with vertices of @xmath166 : @xmath170 for one that is distance 3 from @xmath162 and @xmath171 for one that is distance 4 from @xmath162 .",
    "it may be thought of as a sequence of strung - together hypercubes of dimensions 2 , 1 , 1 , and 3 , together with plumes that inflate the degree of some vertices . ]",
    "it may be thought of as two hypercubes of dimensions 3 and 4 together with plumes that inflate the degree of some vertices . ]    for the edges colored by subsets of @xmath172 , the choice edge in the snout becomes the gadget depicted in fig .",
    "4 , which we call a _ @xmath104-gadget _ or @xmath173 . the negative edge in the variable gadget becomes the gadget depicted in fig .",
    "5 , which we call an _ @xmath174-gadget _ or @xmath175 . in both cases ,",
    "the asterisked vertex @xmath176 is identified with a vertex of @xmath177 and @xmath162 and @xmath163 are connected to other edge gadgets .",
    "finally , the other edge becomes a _",
    "this is a 7-hypercube attached to the consistency gadget in the same way as @xmath161 , but is modified in several ways . in order to explain this , let us first label the dimensions of the hypercube @xmath180 .",
    "( this labeling will be explained later . )",
    "let @xmath181 span the distance from @xmath170 to @xmath162 , and , correspondingly , let @xmath182 span the distance from @xmath170 to @xmath163 .",
    "let us eliminate the edges @xmath182 adjacent to @xmath163 .",
    "we then nearly saturate the vertices that are separated from @xmath170 by the paths @xmath183 and @xmath184 ( call them @xmath185 and @xmath186 respectively ) with @xmath187 additional edges , but then remove the original edges corresponding to @xmath39 from both and @xmath18 and @xmath60 from @xmath185 and @xmath186 respectively .",
    "now that we have constructed a graph , we will attempt to color it nonrepetitively with @xmath13 colors , and show that it has a nonrepetitive coloring iff the instance of @xmath923sat is negative .",
    "let us call the set of colors @xmath188 and call the color of an edge @xmath87 under a hypothetical coloring @xmath116 .",
    "conversely , we denote by @xmath189 $ ] an edge of color @xmath18 if its more precise identity is irrelevant .",
    "let @xmath190 be the set of edges of color @xmath191 . then in a nonrepetitive coloring",
    ", @xmath192 must all be colored with the same 7 colors .",
    "similarly , for every @xmath27 , @xmath173 , @xmath175 , and the hypercube portion of @xmath179 must all be colored with the same 7 colors .",
    "suppose we have a nonrepetitive coloring @xmath116 .",
    "inside each consistency gadget @xmath193 , each vertex of the @xmath168-clique is saturated .",
    "let @xmath176 , @xmath35 , and @xmath0 be such vertices , and suppose that @xmath194 is the same as the color of the edge of a plume adjacent to @xmath0 .",
    "then there is an edge of color @xmath195 adjacent to @xmath35 .",
    "together with @xmath196 , these four edges then form a square path . to avoid this",
    ", the set @xmath197 of 7 colors that colors the first layer of each plume must be disjoint from the set @xmath198 of @xmath199 colors that colors the clique . by a similar argument",
    ", the second layer of every plume must also have a color in @xmath197 . according to @xcite",
    ", the coloring can be constructed in such a way that @xmath198 consists of the nonzero elements of the group @xmath200 .",
    "( from now on we will refer to just @xmath201 and @xmath202 when @xmath193 is clear from the context . )    by the same token , the edges in the edge gadgets of distance at most two from @xmath203 must be colored with colors from @xmath201 .",
    "now suppose we have an edge @xmath87 that has distance 3 from @xmath203 . if @xmath204 , then the path consisting of @xmath87 and the two edges that connect it to @xmath203 can be duplicated inside the consistency gadget , so @xmath205 .",
    "the maximum distance of an edge in any edge gadget from the closer @xmath203 is 4 .",
    "let us first consider a gadget @xmath161 , and let @xmath206 .",
    "we know that edges in the first three layers from @xmath170 have colors in @xmath201 , so they must be arranged according to the hypercube lemma .",
    "let @xmath207 be separated from @xmath170 by edges @xmath208[c_j][c_k]$ ] .",
    "let @xmath209 be the edge incident to @xmath210 that would be colored @xmath211 if @xmath161 were nonrepetitively colored by @xmath201 , and let @xmath212 be the edge incident to @xmath213 that would be colored @xmath214 .",
    "these edges are adjacent .",
    "now we have four cases , since both @xmath215 and @xmath216 can be either in @xmath201 or in @xmath202 .",
    "suppose that @xmath217 . then if it is not true that @xmath218 , and we do nt have a trivial repetition , then we have a square path of the form @xmath219[c_2]e_4e_3[c_1][c_2 ]        [ c(e_4)][c(e_3)]$ ] .",
    "so suppose that @xmath220 .",
    "but we have a square path @xmath221[c(e_4)][c_2][c_4][c_1]e_3e_4[c_2][c_4][c_1]$ ] that starts with two edges of the consistency gadget .",
    "finally , if @xmath222 but @xmath223 , we have the analogous path @xmath224[c(e_3 ) ]        [ c_2][c_3][c_1]e_4e_3[c_2][c_3][c_1]$ ] .    hence in a nonrepetitive coloring the fourth layer is also colored by @xmath201 according to the hypercube lemma .",
    "since we can prove the same thing starting from @xmath171 , this means the colorings from the two @xmath203s match , and so the entire hypercube is colored in this way .",
    "this is also valid for the @xmath178-gadget .",
    "let us start from @xmath171 .",
    "none of the removed edges has distance less than 4 from this vertex , and six have distance 4 .",
    "since none of them are joined at a vertex whose distance from @xmath171 is 4 , we can apply the previous argument to the ones that are not removed .",
    "this leaves only the edges whose hypercube distance from @xmath170 is at most 3 ; but since no removed edges have distance less than 3 from @xmath170 , this is the same as their actual distance , so we are done .",
    "if the color of the edge in @xmath225 between @xmath170 and @xmath171 is represented in the plume of @xmath226 , there is a square path of length 8 going through @xmath226 , @xmath170 , and @xmath171 .",
    "hence this must be the one color in @xmath202 that is missing from the plume .    in the other two gadgets , all the edges except the clump closest to @xmath163",
    "have distance at most 3 from the vertex @xmath176 attaching them to @xmath225 , and thus are known to have colors from @xmath201 .",
    "now , in @xmath227 we have paths @xmath228[b][ab],\\tau_1=[c][d][ac][ad ] ,        \\tau_2=[b][c][ab][ac]$ ] , @xmath229[d][ab][ad]$ ] each between @xmath230 and @xmath162 , and paths @xmath231[b][ab],\\sigma_1=[c][ac][a],\\sigma_2=        [ d][ad][a]$ ] each between @xmath230 and @xmath163 .",
    "now , vertex @xmath162 is also vertex @xmath163 of an @xmath232-gadget @xmath233 , and the color of @xmath234 in @xmath5 is @xmath235 .",
    "some path @xmath236[k_1][k_2]$ ] leads us to the vertex @xmath171 of this gadget .",
    "now , this means that we have a path @xmath237\\tau_i[k_0][k_1 ]        [ k_2][c(\\tau_i)][k_0][k_1]$ ] through the two gadgets and @xmath238 , which a nonrepetitive coloring would require to have a loop .",
    "hence in the group @xmath239 we must have @xmath240 .",
    "furthermore , since a possible @xmath241 is @xmath242 , having a loop of size 3 means that @xmath243 or @xmath244 , which contradicts the previous statement .",
    "hence we have @xmath245 , and by the same argument @xmath246 .",
    "by addition we then have the statements @xmath247 , @xmath248 , and @xmath249 .",
    "it is easy to see that we can create no more such identities using colors from @xmath250 by a similar argument , each @xmath251 must form a loop in @xmath252 , which gives us the same six identities .    by construction",
    ", the other two gadgets attached to @xmath225 are also preceded by @xmath235 edge gadgets , so each path from @xmath162 to @xmath176 in these gadgets must have one of the three sets of colors @xmath253 , @xmath254 , @xmath255 .    now , in @xmath256 , the edges whose distance from @xmath176 is at most 3 are known to be in @xmath257 .",
    "furthermore , the two paths @xmath258[c][a]$ ] and @xmath259[d ]        [ a]$ ] , if they were present starting from @xmath176 , would create a square path where an edge adjacent to some @xmath226 of @xmath227 repeats the edge between @xmath170 and @xmath176 .",
    "now , if @xmath36 is the set of colors coloring the cube in @xmath256 , it must be that @xmath260 in @xmath261 .",
    "thus it must be that @xmath262 and that the vertices of the 4-hypercube that are adjacent to @xmath176 and those that are distance 2 away are effectively saturated . hence by the saturation lemma all of the 4-hypercube , except maybe the edges adjacent to @xmath163 , is colored from @xmath263 . but to prevent a square path through @xmath252 , these last edges must also be colored from that set .",
    "we apply a slightly different argument to @xmath264 . to prevent a repetition going through @xmath226 and @xmath171 of @xmath227 , either the set @xmath265 of colors of the paths from @xmath162 to @xmath176",
    "must be @xmath266 , or the edge labeled @xmath6 must be colored @xmath39 .",
    "furthermore , if @xmath267 , to prevent a repetition going through @xmath226 and @xmath170 , the edge labeled @xmath6 must be colored @xmath18 or @xmath60 , and otherwise the edge labeled @xmath43 must be colored @xmath18 or @xmath60 .",
    "the plumes at @xmath70 and @xmath268 clearly can not contain an edge of the same color as @xmath43 , and the plumes at @xmath269 can not contain an edge of the same color as @xmath6 .",
    "thus these vertices are effectively saturated , and we can apply the saturation lemma to the faces of the cube closer to @xmath176 . furthermore ,",
    "if some @xmath270 is the same color as an edge in the square , then we have a square path of length 6 through the corresponding @xmath70 and @xmath271 .",
    "thus except for the edges adjacent to @xmath163 , we know that the paths from @xmath176 to @xmath163 must be colored from the set @xmath272 .",
    "now , by the argument above , @xmath261 must have @xmath273 , and thus so does @xmath274 .",
    "so @xmath275 in @xmath276 .",
    "then to prevent a square path through @xmath252 , the last edges of paths from @xmath176 to @xmath163 must also be colored from @xmath277 .    given a nonrepetitive coloring of @xmath101 , for every existentially quantified variable @xmath12",
    ", there is a path from @xmath162 to @xmath163 of @xmath264 that has the same pattern of colors as a path from @xmath162 to @xmath163 of either @xmath256 or @xmath227 , but not both .",
    "let us assume the coloring of @xmath227 that we have implied : we have already shown that this is unique up to permutation .",
    "we have also already shown that given this coloring , @xmath256 must have colors @xmath181 in the cube and @xmath182 in the hypercube , and that @xmath264 must have one of the zero - sum sets of 3 colors on the shorter side and one of the zero - sum sets of 4 colors on the longer side .",
    "if the shorter set is @xmath253 then clearly there is a path through the gadget that is the same as a path through @xmath256 . on the other hand ,",
    "there is not a path that is the same as a path through @xmath227 , since no path through @xmath227 ends in @xmath278 , or @xmath279 .",
    "otherwise the gadget contains either the path @xmath280 or the path @xmath281 .",
    "the removed edges in the @xmath178-gadget are all in either fourth or last position .",
    "now , the edge @xmath114 adjacent to @xmath163 is present .",
    "furthermore , the removed @xmath39-edges are preceded by the sets @xmath282 and @xmath283 , so they are not the @xmath39-edges in these paths . hence",
    ", these paths are present in @xmath227 .",
    "since the first three colors can not be a permutation of @xmath253 , there is no path that is the same as a path through @xmath256 .    if @xmath143 , then every coloring of @xmath101 has a square path .",
    "let us assume that we have a nonrepetitive coloring .",
    "it must then agree with claims 1 and 2 . from claim 1 , the path @xmath284 from @xmath162 to @xmath163 exists for all the @xmath232-gadgets .",
    "on the other hand , claim 2 tells us that a nonrepetitive coloring of a @xmath104-gadget is effectively a choice between the corresponding @xmath174-gadget and @xmath178-gadget .",
    "so by choosing a @xmath268 that satisfies @xmath56 for the choice of @xmath12 provided by the coloring , we can create a long square path analogous to the one for @xmath5 .",
    "now , assuming that @xmath285 , we construct a coloring we claim to be nonrepetitive .",
    "let @xmath286 be an assignment to the universally quantified variables such that @xmath287 is not satisfiable .",
    "we set aside 7 colors @xmath288 for each consistency gadget @xmath289 , all of them distinct .",
    "we color the @xmath232-gadgets so that for one , @xmath290 spans the distance from @xmath170 to @xmath162 and @xmath291 spans the distance from @xmath170 to @xmath163 ; for another , @xmath292 and @xmath293 ; and for the third , @xmath294 and @xmath295 .",
    "if @xmath160 has a fourth edge of that color , then we make sure that the coloring of the gadget corresponding to the edge in the snout is different from all the others , but color the fourth edge gadget in one of these three ways .    for a consistency gadget that controls a universally quantified variable @xmath296 , we color @xmath297 and @xmath298 in the way already described .",
    "we then color @xmath299 so that it contains the path @xmath300 if @xmath301 and the path @xmath302 if @xmath303 .",
    "let us set aside a set of 7 colors @xmath304 distinct from the ones enumerated so far .",
    "now we need to color the consistency gadgets , which we do using the group method in @xcite .",
    "first , we assign the elements of the subgroup of @xmath200 generated by the first three generators to the set containing each edge gadget s @xmath170 and @xmath171 , whose cardinality clearly is at most 8 .",
    "furthermore , we set the numbers of the vertices so that the sum of the colors of @xmath170 and @xmath171 within an edge gadget does not depend on the edge gadget .",
    "thus the colors of the edges between these vertices are nonzero members of this subgroup , and the edge between @xmath170 and @xmath171 is the same color for each edge gadget .",
    "we assign to these edges the colors @xmath304 , with @xmath305 being the color between @xmath170 and @xmath171 for every @xmath232- and @xmath178-gadget .    for a consistency gadget corresponding to a universally quantified variable @xmath71",
    ", we label the vertex @xmath170 of @xmath306 with 0 and the other three @xmath176-vertices with a generator of the subgroup .",
    "this ensures that all the edges that connect two @xmath176-vertices are colored differently .",
    "now , using the rest of the generators , we can find @xmath307 subgroups @xmath308 of @xmath200 isomorphic to @xmath309 , one for each nonzero element @xmath310 , by taking the generators @xmath311 to have @xmath27th digit @xmath312 if @xmath313 and 0 otherwise .",
    "we next arbitrarily assign group elements to the rest of the vertices , and hence edges .",
    "however , we assign colors to the group elements in such a way that for each set @xmath314 we take a distinct subgroup of the kind described and assign @xmath315 to the generators and @xmath316 to the elements @xmath317 , and @xmath318 , respectively .",
    "since the first three digits are zero for all elements of these sets , we have guaranteed that we can never get @xmath319 by adding together colors of edge gadgets .",
    "this coloring is nonrepetitive when restricted to a consistency gadget @xmath193 together with its edge gadgets .",
    "we have already shown that the coloring of each gadget is nonrepetitive .    a path within @xmath193 whose colors",
    "are contained in @xmath197 can not reach a vertex at a distance of more than 2 from the interface with colors in @xmath202 .",
    "on the other hand , by construction , no colors in @xmath198 are present in the edge gadgets within distance 2 of @xmath203 .",
    "thus a portion of a square path within an edge gadget must be repeated at least partially in another edge gadget .    for an @xmath232-gadget",
    ", this means that one such portion must not be at the end of a path .",
    "thus , since the path is open , it goes through the edge gadget from @xmath170 to @xmath171 , and contains an odd number of edges of each color in @xmath197 .",
    "if some such portion is repeated by sections at both the beginning and end of the path , then one of these sections must be in an @xmath232-gadget , and therefore we can splice the other section onto that one to create another open square path . thus we can build a shorter square open path by replacing each such portion with the edge between @xmath170 and @xmath171 , which we know has the same color @xmath305 for each gadget .",
    "but this substitution produces a square path entirely inside @xmath193 , which must be a loop .",
    "assume now that @xmath193 corresponds to a universally quantified variable .",
    "we have already constructed our coloring so that a path starting from one of the edges adjacent to @xmath226 and continuing to either @xmath104 or @xmath174 can not repeat .",
    "now , we did not color an edge adjacent to @xmath226 by @xmath305 , so a path from @xmath170 to @xmath171 that is repeated by edges within @xmath178 must be at least two edges long . but a path from @xmath226 in colors from @xmath198 may only be one edge long .",
    "now , the set of colors separating @xmath226 and @xmath203 is different from the set of colors separating @xmath320 and @xmath321 . therefore , we can not find a square path that traverses both .",
    "so any square path must contain at least two sections within @xmath193 .",
    "such sections , if they are each between two @xmath176-vertices , can not repeat each other since by our construction the group element leading between each pair of @xmath176-vertices is different .",
    "but such a path also can not use the plumes because any vertex in @xmath174 and @xmath104 has distance at most 4 from @xmath176 , so this together with the plumes would not be enough to repeat a path through @xmath178 containing 7 distinct colors .    in a square path ,",
    "colors in edge gadgets can not be duplicated by the same colors in consistency gadgets , except perhaps in one plume .",
    "suppose we have a square path that serves as a counterexample to this , with some sequence of colors occurring in an edge gadget @xmath322 repeated by a sequence in a consistency gadget @xmath323 .",
    "we give the name @xmath76 to this path and @xmath324 to the portion of it that goes through a gadget @xmath325 .",
    "we orient @xmath76 so that @xmath326 comes before @xmath327 ; we therefore refer to the first and second halves of @xmath76 , and to ends and beginnings of sections .",
    "we start with _ case 1 _ : @xmath322 does not belong to @xmath323 and @xmath326 is not at the beginning of @xmath76 .",
    "then the ends of @xmath326 are vertices from the set @xmath328 . by construction ,",
    "the colors of any such path form a loop in @xmath323 , so the path can not be open .    thus if @xmath322 does not belong to @xmath323 ,",
    "then @xmath326 is the beginning of @xmath76 .",
    "then the edges following @xmath326 must come either from a consistency gadget @xmath329 ( _ case 2 _ ) or another edge gadget @xmath330 ( _ case 3_. )    _ case 2 _ : in order to link the two half - paths , the first half must eventually leave @xmath329 . if it leaves early , so that an adjacent edge gadget is repeated in @xmath323 , then we are back in case 1 .",
    "if it leaves late , so that it is repeated by an edge gadget adjacent to @xmath329 , then we are also back in case 1 : if the path ended in that edge gadget , then there would be nothing to repeat the edge gadgets between @xmath329 and @xmath323 .",
    "finally , if the vertex @xmath203 at which the path leaves @xmath329 is repeated by a vertex @xmath331 at which the path leaves @xmath323 , then since we are in different consistency gadgets , the edges we traverse have different sets @xmath201 of colors , a contradiction .",
    "_ case 3 _ : if @xmath330 does not belong to @xmath323 , then it must be duplicated inside @xmath329 , since the other option is an edge gadget belonging to @xmath329 , which does not match colors .",
    "therefore , substituting @xmath330 for @xmath322 , we get case 1 and a contradiction",
    ".    so @xmath330 belongs to @xmath323 .",
    "this means that the end of @xmath326 is @xmath332 .",
    "furthermore , since @xmath333 must have odd numbers of at least three colors , and since @xmath326 is the beginning of @xmath76 and therefore all of @xmath333 is in the first half , @xmath333 can not be repeated in a plume of @xmath323 .",
    "thus @xmath323 must end with @xmath331 of an edge gadget @xmath334 which repeats @xmath332 .",
    "if @xmath333 ends with @xmath335 , then @xmath336 ends with @xmath337 and we are again in case 1 . on the other hand ,",
    "if @xmath333 ends at @xmath338 , then @xmath339 ends with @xmath340 , and so either we are back in case 1 or the path ends after @xmath339 . but",
    "that would mean that the colors of @xmath326 and @xmath336 would add up in @xmath341 to @xmath319 for some @xmath27 , which contradicts the construction .",
    "the remaining possibility , _ case 4 _ , is that @xmath322 belongs to @xmath323 .",
    "then for colors to match , the part of @xmath327 that repeats @xmath326 must be contained in a plume of @xmath323 and therefore be the end of the path .",
    "no square path in this coloring goes through a consistency gadget .    by claim 5 , colors in edge gadgets",
    "must be duplicated by colors in edge gadgets . now , suppose we have a square path @xmath76 that goes through a consistency gadget @xmath193 .",
    "we use the notation of claim 5 to denote portions of this path . on both sides of @xmath342",
    ", we have paths through edge gadgets @xmath334 and @xmath343 .",
    "we now enumerate cases once again .",
    "_ case 1 _ occurs when @xmath336 is a path between @xmath170 and @xmath171 .",
    "then there must be a subpath repeating it , which , by claim 5 , then also goes from @xmath203 to @xmath321 in an edge gadget @xmath344 of @xmath193 .",
    "we can create another square path by replacing @xmath336 and @xmath345 by single edges within @xmath193 , reducing the problem to any of the other cases .",
    "so we can assume that both @xmath336 and @xmath346 go to a @xmath332 .",
    "then if we orient the path , one subpath goes from an edge gadget to @xmath193 and the other goes from @xmath193 to an edge gadget .",
    "therefore , by claim 5 , one can not be the repetition of the other .",
    "thus @xmath76 must traverse @xmath193 twice and associated edge gadgets four times , at least three of these times passing between a @xmath203 and a @xmath332 .",
    "( the fourth time it does not have to do this since a traversal may be split between the beginning and the end of @xmath76 . )",
    "furthermore , the edge subpaths must be in two pairs , each of which has one set of colors , and at least one of the pairs must have both its subpaths continue in other edge gadgets .",
    "suppose now that @xmath193 is not associated with a universally quantified variable .",
    "_ case 2 _ occurs when the two subpaths are in the same @xmath232-gadget .",
    "since no edge in @xmath160 is adjacent to edges of one color through both incident vertices , the colors of the neighboring edge gadgets must be different and the path can not be square .",
    "in _ case 3 _ , the two subpaths are in different @xmath232-gadgets .",
    "in order for them to be colored the same , we must assume that @xmath193 controls four @xmath232-gadgets and neither of the @xmath232-gadgets traversed by the subpaths corresponds to an edge in the snout of @xmath160 .",
    "but the edges not in the snout all border different colors , so the path once again can not be square .    _",
    "case 4 _ : we are left with the possibility of @xmath347 being associated with a universally quantified variable @xmath296 .",
    "we colored @xmath347 in such a way , however , that the sets of paths within it between every pair of @xmath176-vertices are disjoint . therefore ,",
    "if we orient @xmath76 in a certain way , the second @xmath348 must be at the end of the path . by the same token",
    ", @xmath76 must begin with a section in one of the edge gadgets belonging to @xmath347 .",
    "all the @xmath162s of the edge gadgets of @xmath347 are incident to @xmath232-gadgets of colors @xmath349 and all the @xmath163s are incident to @xmath232-gadgets of colors @xmath350 .",
    "hence paths to @xmath163 can be repeated by paths to @xmath163 and paths to @xmath162 can be repeated by paths to @xmath162 . by construction ,",
    "the possible repetitions of paths between @xmath331 and @xmath332 are then    1 .   if @xmath303 , a path between @xmath162 and @xmath176 in @xmath297 with a path between @xmath162 and @xmath170 in @xmath298 2 .   if @xmath301 : 1 .   a path between @xmath162 and @xmath176 in @xmath299 with a path between @xmath162 and @xmath176 in @xmath297 and a path between @xmath162 and @xmath170 in @xmath298 2 .   a path between @xmath163 and @xmath176 in @xmath299 with a path between @xmath163 and @xmath176 in @xmath297 .",
    "in each case , therefore , there can be only one such repetition in an open path .",
    "since gadgets belonging to @xmath347 occupy both the beginning and the end of @xmath76 , there may be no traversal of consistency gadgets other than @xmath347 within @xmath76 .",
    "a path through @xmath297 can not repeat a path through @xmath298 since these paths would have to go through edge gadgets corresponding to different direction - determining colors of @xmath160 .",
    "also , a path going through @xmath162 of @xmath299 is going towards the tip of the snout , and therefore can not meet any more gadgets belonging to @xmath296 .",
    "this gives us a contradiction if @xmath162 is part of one of the square sections .",
    "thus we are left with possibility 2(b ) .",
    "this means that there must be a subpath consisting only of edge gadgets from @xmath163 of @xmath299 to some other @xmath332 of an edge gadget belonging to @xmath347 .",
    "if the path is from @xmath299 , then it must traverse an edge gadget belonging to @xmath351 , which must be repeated by an edge gadget at the tip of the snout , which @xmath76 can not reach .",
    "this restricts any potential square paths to going through a chain of edge gadgets . but",
    "this means that a square path maps to a square path in @xmath160 , which does not exist if @xmath352 .",
    "hence this is a reduction .",
    "it is easy to see that the reduction runs in polynomial time , specifically @xmath353 .",
    "we would like to thank chris umans for his mentoring and helpful suggestions at every stage of the research ; and grigori mints and yuri manin for reviewing the proofs .",
    "9 n.  alon , j.  grytczuk , m.  hauszczak , and o.  riordan .",
    "`` nonrepetitive colorings of graphs . '' in m.  kronski , j.  spencer , and a.  ruciski , editors , _ proceedings of the 10th international conference on random structures and algorithms ( rs&a-01 ) _ , volume 21 , 34 of _ random structures and algorithms _ , pages 336346 , danvers , ma , aug .",
    "610 2002 .",
    "wiley periodicals .",
    "j.  bart and p.p .",
    "`` on square - free vertex colorings of graphs . '' _ studia scientiarum mathematicarum hungarica _",
    "( to appear ) .",
    "j.  bart and p.p .",
    "`` on square - free edge colorings of graphs . '' _ ars comb . _",
    "( to appear ) .",
    "b. brear and s. klavar .",
    "`` square - free colorings of graphs . '' _ ars comb . _ 70:313 ,",
    "jan . 2004 .",
    "thomas f. coleman and jorge j. mor .",
    "`` estimation of sparse hessian matrices and graph coloring problems . '' _ math .",
    "programming _ , 28(3):243270 , 1984 . s.  czerwiski and j.  grytczuk .",
    "`` nonrepetitive colorings of graphs . ''",
    "_ electronic notes in discrete mathematics _ 28:453459 , 2007 . j.  grytczuk .",
    "`` nonrepetitive colorings of graphs  a survey . '' _ international journal of mathematics and mathematical sciences _ , 2007 .",
    "ian holyer .",
    "`` the np - completeness of edge - coloring . ''",
    "_ siam j. comput .",
    "_ 10:718720 , 1981 .",
    "dniel marx and marcus schaefer .",
    "`` the complexity of nonrepetitive coloring . '' _ depaul university technical report _",
    ", tr 07 - 007 , 2007 .",
    "marcus schaefer and christopher umans .",
    "`` completeness in the polynomial - time hierarchy : a compendium '' ( updated version ) .",
    "_ sigact news _ ,",
    "september 2002 . retrieved from <",
    "http://ovid.cs.depaul.edu / documents / phcom.ps>. marcus schaefer and christopher umans .",
    "`` completeness in the polynomial - time hierarchy : part ii '' ( updated version ) . _ sigact news _ , december 2002 . retrieved from < http://ovid.cs.depaul.edu / documents / phmeth.ps>. axel thue .",
    "`` ber unendliche zeichenreihen . ''",
    "_ norske vid .",
    "christiana 7 _ , 1 - 22 , 1906 . reprinted in nagell , t. ; selberg , a. ; selberg , s. ; and thalberg , k. ( eds . ) .",
    "_ selected mathematical papers of axel thue_. oslo , norway : universitetsforlaget , pp .",
    "139 - 158 , 1977 ."
  ],
  "abstract_text": [
    "<S> a squarefree word is a sequence @xmath0 of symbols such that there are no strings @xmath1 , and @xmath2 for which @xmath3 . </S>",
    "<S> a nonrepetitive coloring of a graph is an edge coloring in which the sequence of colors along any open path is squarefree . </S>",
    "<S> the thue number @xmath4 of a graph @xmath5 is the least @xmath6 for which the graph can be nonrepetitively colored in @xmath6 colors . a number of recent papers have shown both exact and approximation results for thue numbers of various classes of graphs . </S>",
    "<S> we show that determining whether a graph @xmath5 has @xmath7 is @xmath8-complete .    </S>",
    "<S> when we restrict to paths of length at most @xmath6 , the problem becomes * np*-complete for fixed @xmath6 . for @xmath9 , </S>",
    "<S> this is the edge coloring problem ; thus the bounded - path version can be thought of as a generalization of edge coloring . </S>"
  ]
}