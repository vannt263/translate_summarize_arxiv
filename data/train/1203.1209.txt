{
  "article_text": [
    "a classical problem in analysis is the well - known _",
    "helmholtz s inverse problem of the calculus of variations _",
    "( see @xcite , @xcite and @xcite ) : find a necessary and sufficient condition under which a ( system of ) differential equation(s ) can be written as an euler - lagrange equation and , in the affirmative case , find all the possible lagrangian formulations .",
    "+ this problem has been studied by numerous authors and has been completely solved by a. mayer @xcite and a. hirsch @xcite .",
    "the formulation that we use is due to v. volterra @xcite .",
    "precisely , let @xmath0 be a second order differential operator .",
    "then , the differential equation @xmath1 can be written as a second order euler - lagrange equation if and only if all the frechet derivatives of @xmath0 are self - adjoint . this condition is usually called _ helmholtz condition_. we refer to @xcite for a modern presentation and a complete proof of this theorem . +",
    "a more difficult problem is to deduce from this characterization a complete classification of second order differential equations admitting a variational formulation .",
    "this has been only solved in dimension three by j. douglas in his seminal paper @xcite following a previous work of d.r .",
    "davis @xcite .",
    "we refer to @xcite and @xcite for a historical survey .",
    "+ in recent years , an increasing activity has been devoted to a discrete version of the calculus of variations in the context of the geometric numerical integration .",
    "we refer to the book @xcite and the review paper @xcite for more details . in this context ,",
    "second order discrete euler - lagrange equation _ is given by : @xmath2 for a given couple of lagrangian @xmath3 and where @xmath4 is a bounded regular partition of @xmath5 associated to the step size of discretization @xmath6 .",
    "@xmath7 ( resp .",
    "@xmath8 ) is the backward ( resp .",
    "forward ) finite differences operator associated to @xmath4 .",
    "+ in this framework , we formulate the _ helmholtz inverse problem of the discrete calculus of variations _ as follows : find a necessary and sufficient condition under which a second order finite differences equation ( see definition [ defsofde ] ) can be written as a second order discrete euler - lagrange equation and , in the affirmative case , find all the possible lagrangian formulations .",
    "+ this problem has been studied by numerous authors .",
    "we refer in particular to the work of albu - opris @xcite and cracium - opris @xcite .",
    "however , in each of these papers , the structure of the proof follows a different scheme than the continuous case and does not allow to make comparisons .",
    "moreover , we enlarge these studies by taking account of non autonomous finite differences equations .",
    "in the whole paper , let us consider the following set : @xmath9 @xmath10 is a set of bounded regular partitions @xmath4 of @xmath5 . hence , for any partition @xmath11 , an integer @xmath12 and a step size of discretization @xmath13",
    "are associated .",
    "consequently , for any @xmath11 , we can also associate the following _ finite differences operators _ : @xmath14{lrcl}\\delta_- : & { \\mathbb{r}}^{n+1 } & \\longrightarrow & { \\mathbb{r}}^{n}\\\\&{\\boldsymbol{q } } & \\longmapsto & \\left ( \\dfrac{q_{p } -q_{p-1}}{h }   \\right ) _ { p=1,\\dots , n } \\end{array}}\\ ] ] and @xmath14{lrcl}\\delta_+ : & { \\mathbb{r}}^{n+1 } & \\longrightarrow & { \\mathbb{r}}^{n}\\\\&{\\boldsymbol{q } } & \\longmapsto & \\left ( \\dfrac{q_{p } -q_{p+1}}{h }   \\right ) _ { p=0,\\dots , n-1}. \\end{array}}\\ ] ] let us note that @xmath7 ( resp .",
    "@xmath15 ) is the classical backward ( resp . forward )",
    "euler approximation of the derivative operator @xmath16 .",
    "moreover , @xmath7 and @xmath15 commute and the discrete operator @xmath17 corresponds to the classical centered approximation of @xmath18 .",
    "+ let us remark that all these previous discrete elements depend on @xmath11 .",
    "for the reader s convenience , we omit this dependence in the notations .",
    "+ in this paper , we are going to be interested in the discretization of differential equations defined on real intervals @xmath19 $ ] . hence , for any reals @xmath20 , we introduce the following set : @xmath21 for any reals @xmath20 , @xmath22 is then a set of regular partitions @xmath4 of the interval @xmath19 $ ] .      in the whole paper ,",
    "let us note that we consider sufficiently smooth elements in order to make valid all the computations .",
    "the elements concerned are denoted by @xmath23 , @xmath24 , @xmath25 , @xmath26 and @xmath27 .",
    "+ in the continuous case , a second order differential equation on an interval @xmath19 $ ] is defined by @xmath28 where @xmath0 is a second order differential operator , _",
    "i.e. _ : @xmath14{lrcl}o : & a < b & \\longmapsto & { \\begin{array}[t]{lrcl}o^{a , b } : & { \\mathscr{c}}^2([a , b],{\\mathbb{r } } ) & \\longrightarrow & { \\mathscr{c}}^0([a , b],{\\mathbb{r}})\\\\&q & \\longmapsto & o^{a , b}(q )   \\end{array } } \\end{array}}\\ ] ] with : @xmath14{lrcl}o^{a , b}(q ) : & [ a , b ] & \\longrightarrow & { \\mathbb{r}}\\\\&t & \\longmapsto & o^{a , b}(q)(t ) = { \\overline{o}}\\big ( q(t),\\dot{q}(t ) , \\ddot{q}(t),t \\big ) \\end{array}}\\ ] ] where @xmath29 ( resp .",
    "@xmath30 ) is the first ( resp .",
    "second ) derivative of @xmath31 and where : @xmath32{lrcl}{\\overline{o}}:&{\\mathbb{r}}^4 & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v , w , t ) & \\longmapsto & { \\overline{o}}(x , v , w , t ) .",
    "\\end{array}}\\ ] ] hence , a second order differential equation ( independently of the interval @xmath19 $ ] ) is entirely determined by the application @xmath23 .",
    "let us give the following discrete analogous definition :    [ defsofde ] a second order finite differences equation , associated to a partition @xmath11 , is defined by @xmath33 where @xmath34 is a second order finite differences operator , _",
    "i.e. _ : @xmath14{lrcl}p : & { \\boldsymbol{t}}\\in { \\mathbb{t}}&\\longmapsto & { \\begin{array}[t]{lrcl}p^{{\\boldsymbol{t } } } : & { \\mathbb{r}^{n+1}}&\\longrightarrow & { \\mathbb{r}^{n-1}}\\\\&{\\boldsymbol{q } } & \\longmapsto & p^{{\\boldsymbol{t}}}({\\boldsymbol{q } } )   = \\big ( p^{{\\boldsymbol{t}}}_p({\\boldsymbol{q } } ) \\big)_{p=1, ... ,n-1 }   \\end{array } } \\end{array}}\\ ] ] where @xmath35 and where @xmath36{lrcl}{\\overline{p}}:&{\\mathbb{r}}^5 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v_-,v_+,w , t,\\xi ) & \\longmapsto & { \\overline{p}}(x , v_-,v_+,w , t,\\xi ) .",
    "\\end{array}}\\ ] ] a second order finite differences equation ( independently of the partition @xmath11 ) is then entirely determined by the application @xmath24 .",
    "let us consider a second order differential equation @xmath28 on an interval @xmath19 $ ] .",
    "then , a usual algebraic way in order to provide a discretization of this equation is to consider a partition @xmath37 and to define : @xmath14{lrcl}{\\overline{p}}:&{\\mathbb{r}}^5 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v_-,v_+,w , t,\\xi ) & \\longmapsto & { \\overline{o}}\\big ( x,(1-\\lambda ) v_- + \\lambda v_+,w , t \\big ) \\end{array}}\\ ] ] with @xmath38 $ ] .",
    "hence , we obtain the numerical scheme @xmath33 .",
    "the parameter @xmath39 allows to choose for example the backward ( @xmath40 ) , centered ( @xmath41 ) or forward ( @xmath42 ) approximation of the derivative @xmath16 .",
    "such a discretization of @xmath28 is said to be a _",
    "direct discretization_.    let us consider the newton s equation with friction @xmath43 defined on a real interval @xmath19 $ ] .",
    "it is a second order differential equation associated to @xmath44 .",
    "hence , considering @xmath41 and a partition @xmath37 , we obtain by direct discretization the following numerical scheme : @xmath45",
    "a continuous lagrangian system derives from a variational principle .",
    "precisely , let us consider two reals @xmath20 and the following lagrangian functional : @xmath14{lrcl}{\\mathscr{l}}^{a , b } : & { \\mathscr{c}}^2([a , b],{\\mathbb{r } } ) & \\longrightarrow & { \\mathbb{r}}\\\\&q & \\longmapsto & \\di \\int_a^b l(q,\\dot{q},t ) \\ ; dt , \\end{array}}\\ ] ] where @xmath25 is a lagrangian , _",
    "i.e. _ an application of the type : @xmath14{lrcl}l : & { \\mathbb{r}}^3 & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v , t ) & \\longmapsto & l(x , v , t ) .",
    "\\end{array}}\\ ] ] let @xmath46,{\\mathbb{r } } ) : = \\ { w \\in { \\mathscr{c}}^2([a , b],{\\mathbb{r } } ) , \\ ; w(a ) = w(b ) = 0\\}$ ] denote the set of _",
    "variations_. then , @xmath47,{\\mathbb{r}})$ ]",
    "is said to be a _",
    "critical point _ of @xmath48",
    "if for any variation @xmath49 , we have @xmath50 . a calculus of variations allows to characterize the critical points of @xmath48 as the solutions on @xmath19 $ ] of the following _ second order euler - lagrange equation _ : @xmath51 a dynamical system governed by such an euler - lagrange equation is called _ second order lagrangian system_. we refer to @xcite for more details concerning continuous lagrangian systems .",
    "+ the classical helmholtz result is the following .",
    "let @xmath0 be a second order differential operator .",
    "the second order differential equation associated can be written as a second order euler - lagrange equation if and only if @xmath0 satisfies the helmholtz condition frequently given as the self - adjointness of all the frechet derivatives of @xmath52 for any reals @xmath20 .",
    "we refer to @xcite for more details .",
    "nevertheless , the helmholtz condition can be more explicitly formulated : @xmath0 satisfies the helmholtz condition if and only if @xmath53,{\\mathbb{r } } ) , \\ ; \\dfrac{d}{dt } \\left ( \\dfrac{\\partial { \\overline{o}}}{\\partial w } ( q,\\dot{q},\\ddot{q},t ) \\right ) = \\dfrac{\\partial { \\overline{o}}}{\\partial v } ( q,\\dot{q},\\ddot{q},t).\\ ] ]      let us give the discrete analogous definitions and results of the previous section :    [ defdisclag ] a discrete lagrangian functional , associated to a partition @xmath11 , is defined by : @xmath14{lrcl}{\\mathscr{l}}^{{\\boldsymbol{t } } } : & { \\mathbb{r}^{n+1}}&\\longrightarrow & { \\mathbb{r}}\\\\&{\\boldsymbol{q } } & \\longmapsto & h \\di \\sum_{p=1}^n l_- \\big ( q_p , ( \\delta_- { \\boldsymbol{q}})_p , t_p , h \\big ) + h \\di \\sum_{p=0}^{n-1 } l_+ \\big ( q_p , ( -\\delta_+ { \\boldsymbol{q}})_p , t_p , h \\big ) , \\end{array}}\\ ] ] where @xmath3 is a couple of lagrangian , _ i.e. _ @xmath54 are applications of the type : @xmath14{lrcl}l_{\\pm } : & { \\mathbb{r}}^3 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v , t,\\xi ) & \\longmapsto & l_{\\pm } ( x , v , t,\\xi ) .",
    "\\end{array}}\\ ] ] let @xmath55 denote the set of _ discrete variations_. then , @xmath56 is said to be a _ discrete critical point _ of @xmath57",
    "if for any discrete variation @xmath58 , we have @xmath59 .    a discrete calculus of variations allows to characterize the discrete critical points of @xmath57 :    [ thmdisclag ] let @xmath3 be a couple of lagrangian and @xmath11 .",
    "let @xmath57 be the discrete lagrangian functional associated .",
    "then , @xmath56 is a discrete critical point of @xmath57 if and only if @xmath60 is solution of the following second order discrete euler - lagrange equation : @xmath61 a discrete dynamical system governed by such a discrete euler - lagrange equation is called _ second order discrete lagrangian system_.    let @xmath56 and @xmath62 .",
    "we have : @xmath63 \\\\ + h \\di \\sum_{p=0}^{n-1 } \\left [   \\frac{\\partial l_+}{\\partial x } ( \\ast \\ast_p ) w_p + \\frac{\\partial l_+}{\\partial v } ( \\ast \\ast_p ) ( -\\delta_+ { \\boldsymbol{w}})_p\\right ]   \\end{gathered}\\ ] ] where @xmath64 and @xmath65 . let us remind the following _ discrete integrations by part_. for any @xmath66 , we have : @xmath67 finally , combining and , we obtain : @xmath68 w_p,\\ ] ] which concludes the proof .",
    "let us consider an euler - lagrange equation @xmath69 defined on a real interval @xmath19 $ ] and @xmath25 the lagrangian associated .",
    "let us take for example @xmath70 and @xmath71 .",
    "considering a partition @xmath37 , we obtain that @xmath57 is a discrete version of @xmath48 and is obtained by discrete variational principle on @xmath57 .",
    "such a method leads to be called _ variational integrator _ : it is a numerical scheme for having the particularity of preserving its intrinsic lagrangian structure at the discrete level .",
    "we refer to @xcite for more details concerning the variational integrators .",
    "let us note that one can also use a centered version by taking @xmath72 .",
    "[ exnewtonsansfriction ] let us consider the newton s equation without friction @xmath73 defined on a real interval @xmath19 $ ] .",
    "it is a second order differential equation associated to @xmath74 satisfying the continuous helmholtz condition .",
    "it corresponds to with the quadratic lagrangian @xmath75 . considering a partition @xmath37 , taking @xmath70 and @xmath71",
    ", we obtain the following discrete euler - lagrange equation : @xmath76 let us note that coincides with a direct discretization .",
    "nevertheless , a direct discretization of an euler - lagrange equation do not lead necessary to a discrete euler - lagrange equation , see example [ exmarchepas ] . in this case",
    ", we say that the lagrangian structure is not preserved .",
    "firstly , it is important to note that a second order discrete euler - lagrange equation is a second order finite differences equation ( in the sense of definition [ defsofde ] ) :    [ propelhsofde ] let @xmath3 be a couple of lagrangian .",
    "then , the discrete euler - lagrange equation associated is a second order finite differences equation associated to : @xmath77{lrcl}{\\overline{p}}:&{\\mathbb{r}}^5 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v_-,v_+,w , t,\\xi ) & \\longmapsto & \\di \\sum_{i+j+k \\geq 1 } \\big [ a_{i , j , k } ( x , v_-,t,\\xi ) v^i_+ + b_{i , j , k } ( x , v_+,t,\\xi ) v^i_- \\big]w^j \\end{array}}\\ ] ] where @xmath78 and where @xmath79 where @xmath80 is the kronecker symbol .",
    "we have just to take a partition @xmath11 and to develop @xmath81 and @xmath82 in power series .",
    "we finally formulate the following discrete version of the helmholtz problem : + _ * discrete helmholtz problem for second order finite differences equations : * find a necessary and sufficient condition under which a second order finite differences equation can be written as a second order discrete euler - lagrange equation .",
    "precisely , let @xmath34 be a second order finite differences operator .",
    "our aim is to find a necessary and sufficient condition on @xmath34 under which there exists a couple of lagrangian @xmath3 such that for any @xmath11 and any @xmath56 , we have : _ @xmath83",
    "[ thmhelmdisc ] let @xmath34 be a second order finite differences operator . then , the second order finite differences equation associated can be written as a second order discrete euler - lagrange equation if and only if @xmath34 satisfies the following discrete helmholtz condition : @xmath84 where @xmath85 .",
    "see sections [ section5 ] and [ section6 ] .",
    "let us note the similarity between the classical helmholtz condition and its discrete version .",
    "it is also important to note that , similarly to the continuous case , the discrete helmholtz condition corresponds to the self - adjointness of all the frechet derivatives of @xmath86 for any @xmath87 , see section [ section5 ] .",
    "let us take the second order finite differences equation obtained in example [ exnewtonsansfriction ] .",
    "it is associated to the application @xmath88 which satisfies the discrete helmholtz condition .",
    "it is expected because is a discrete euler - lagrange equation by construction .",
    "[ exmarchepas ] let us consider the differential equation @xmath89 defined on a real interval @xmath19 $ ] .",
    "it is a second order differential equation associated to the application @xmath90 satisfying .",
    "it corresponds to associated to the lagrangian @xmath91 .",
    "let us consider @xmath37 and define @xmath92 with @xmath38 $ ] .",
    "then , we obtain by direct discretization the following second order finite differences equation : @xmath93 let @xmath34 be the second order finite differences operator associated .",
    "then , @xmath34 does not satisfy and consequently can not be written as a second order discrete euler - lagrange equation .",
    "this is an example of direct discretization of an euler - lagrange equation not leading to a discrete euler - lagrange equation .",
    "the numerical scheme does not preserve the lagrangian structure of the differential equation at the discrete level .",
    "in this section , we prove that a second order differences operator @xmath34 satisfies the discrete helmholtz condition if and only if all the frechet derivatives of @xmath94 are self - adjoint for any @xmath11 .      in this section ,",
    "we first remind the classical discrete versions of the integration by part and the leibniz formula .",
    "[ dlf ] let @xmath11 and @xmath60 , @xmath95 .",
    "then , we have : @xmath96 and @xmath97 finally , for any @xmath98 , we have : @xmath99    for any @xmath11 , let us denote @xmath100 .    [ dibp ]",
    "let @xmath11 and @xmath101 .",
    "then , we have : @xmath102 finally , we have : @xmath103      let us define the following discrete version of the self - adjointness of a frechet derivative for a differential operator :    [ defselfadjoint ] let @xmath34 be a second order finite differences operator , @xmath87 and @xmath104 .",
    "we denote by @xmath105 the frechet derivative of @xmath86 at the point @xmath60 .",
    "finally , we denote by @xmath106 the adjoint of @xmath105 defined by : @xmath14{lrcl}dp^{{\\boldsymbol{t}}}({\\boldsymbol{q}})^ * : & { \\mathbb{r}^{n+1}}&\\longrightarrow & { \\mathbb{r}}^{n-3}\\\\&{\\boldsymbol{z } } & \\longmapsto & dp^{{\\boldsymbol{t}}}({\\boldsymbol{q}})^*({\\boldsymbol{z } } ) = \\big ( dp^{{\\boldsymbol{t}}}_p({\\boldsymbol{q}})^*({\\boldsymbol{z } } ) \\big)_{p=2, ... ,n-2 } \\end{array}}\\ ] ] satisfying : @xmath107 finally , @xmath108 is said to be _ self - adjoint _ if for any @xmath109 , @xmath110 .",
    "first , a simple calculation leads to the following result :    [ propfrechderiv ] let @xmath34 be a second order finite differences operator , @xmath87 and @xmath104 .",
    "then , for any @xmath98 and any @xmath111 , we have : @xmath112 where @xmath85 .",
    "then , applying lemmas [ dlf ] and [ dibp ] in proposition [ propfrechderiv ] , we can give explicitly the adjoint of a frechet derivative :    [ propadjfrechderiv ] let @xmath34 be a second order finite differences operator , @xmath87 and @xmath104 .",
    "then , for any @xmath109 and any @xmath111 , @xmath113 is equal to : @xmath114 w_p",
    "\\\\ + \\left [ \\left(\\delta_- \\dfrac{\\partial { \\overline{p}}}{\\partial w } ( \\star ) \\right)_p - \\dfrac{\\partial { \\overline{p}}}{\\partial v_+ } ( \\star_{p-1 } ) \\right ] ( \\delta_- { \\boldsymbol{w}})_p \\\\ + \\left [ \\left ( - \\delta_+ \\dfrac{\\partial { \\overline{p}}}{\\partial w } ( \\star ) \\right)_p - \\dfrac{\\partial { \\overline{p}}}{\\partial v_- } ( \\star_{p+1 } ) \\right ] ( -\\delta_+ { \\boldsymbol{w}})_p + \\dfrac{\\partial { \\overline{p}}}{\\partial w } ( \\star_p ) ( -\\delta_+ \\circ \\delta_- { \\boldsymbol{w}})_p , \\end{array}\\ ] ] where @xmath115 .    the main result of this section is the following explicit characterization of second order finite differences operators @xmath34 whose all frechet derivatives are self - adjoint for any @xmath11 :    [ thmcaractadj ] let @xmath34 be a second order finite differences operator . then , @xmath105 is self adjoint for any @xmath11 and any @xmath56 if and only if @xmath34 satisfies the discrete helmholtz condition .",
    "indeed , let @xmath11 and @xmath56 . according to proposition [ propadjfrechderiv ] , we have @xmath105 is self adjoint if and only if the right term of is equal to for any @xmath95 and any @xmath109 .",
    "consequently , @xmath105 is self adjoint if and only for any @xmath109 , the three following equalities hold : @xmath116 if and only if for any @xmath117 : @xmath118 the proof is completed .",
    "let @xmath34 be a second order finite differences operator associated to a second order discrete euler - lagrange equation .",
    "let @xmath119 denote the associated couple of lagrangian . according to proposition [ propelhsofde ] , we have that @xmath24 satisfies . with a simple calculation",
    ", we can prove that for any @xmath11 , any @xmath56 and any @xmath98 , the three following equalities hold : @xmath120 @xmath121 @xmath122 where @xmath123 . finally , from these three equalities , we prove that @xmath34 satisfies the discrete helmholtz condition .",
    "let @xmath34 be a second order finite differences operator satisfying the discrete helmholtz condition .",
    "the proof is based on the following proposition :    [ propnececond ] let @xmath34 be a second order finite differences operator satisfying the discrete helmholtz condition .",
    "let @xmath124 be the following augmented lagrangian : @xmath14{lrcl}l_1 : & { \\mathbb{r}}^5 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v_-,v_+,w , t,\\xi ) & \\longmapsto & x \\di \\int_0 ^ 1 { \\overline{p}}(\\lambda x,\\lambda v_-,\\lambda v_+,\\lambda w , t,\\xi ) \\ ; d\\lambda \\end{array}}\\ ] ] and , for any @xmath11 , let @xmath125 denote the following augmented lagrangian functional @xmath14{lrcl}{\\mathscr{l}}^{{\\boldsymbol{t}}}_1 : & { \\mathbb{r}^{n+1}}&\\longrightarrow & { \\mathbb{r}}\\\\&{\\boldsymbol{q } } & \\longmapsto & h \\di \\sum_{p=1}^{n-1 } l_1 \\big ( q_p , ( \\delta_- { \\boldsymbol{q}})_p , ( -\\delta_+ { \\boldsymbol{q}})_p , ( -\\delta_+ \\circ \\delta_- { \\boldsymbol{q}})_p , t_p , h \\big ) .",
    "\\end{array}}\\ ] ] then ,    1 .   for any @xmath87 and any @xmath126",
    ", we have : @xmath127 2 .",
    "there exists a couple of lagrangian @xmath119 such that for any @xmath11 , any @xmath56 , we have : @xmath128    @xmath129 let @xmath11 and @xmath126 .",
    "we have : @xmath130 thus : @xmath131 as @xmath34 satisfies the discrete helmholtz condition and according to theorem [ thmcaractadj ] , @xmath132 is self - adjoint . using definition [ defselfadjoint ] ,",
    "the following equality holds : @xmath133 then , from equalities and , we have @xmath134 then , using @xmath135 and using an integration by part with respect to @xmath39 on the second integral , we obtain : @xmath136 @xmath137 since @xmath34 satisfies the discrete helmholtz condition , we have for any @xmath11 and any @xmath56 : @xmath138 where @xmath85 . as it is true for any @xmath56 , we can differentiate the previous equality with respect to @xmath139 and @xmath140 .",
    "it leads to the two following equalities holding for any @xmath11 , any @xmath56 and any @xmath117 : @xmath141 and @xmath142 finally , we have for any @xmath11 , any @xmath56 and any @xmath98 : @xmath143 hence , since equality is true for any @xmath11 , any @xmath56 and any @xmath98 , we have for any @xmath144 : @xmath145 let us define : @xmath14{lrcl}\\ell : & { \\mathbb{r}}^4 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , y , z , t,\\xi ) & \\longmapsto & { \\overline{p}}\\big ( x , y , z,\\dfrac{z - y}{\\xi},t,\\xi \\big ) .",
    "\\end{array}}\\ ] ] according to , we have : @xmath146 consequently , the variables @xmath147 and @xmath148 are separable in @xmath149 .",
    "precisely , there exist two functions @xmath150 such that : @xmath151 finally , we have for any @xmath11 , any @xmath56 and any @xmath98 : @xmath152 where : @xmath14{lrcl}l_- : & { \\mathbb{r}}^3 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v , t,\\xi ) & \\longmapsto & x \\di \\int_0 ^ 1 \\alpha(\\lambda x,\\lambda v , t,\\xi ) \\ ; d\\lambda \\end{array}}\\ ] ] and @xmath14{lrcl}l_+ : & { \\mathbb{r}}^3 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , v , t,\\xi ) & \\longmapsto & x \\di \\int_0 ^ 1 \\beta(\\lambda x,\\lambda v , t,\\xi ) \\ ; d\\lambda . \\end{array}}\\ ] ] the proof of proposition [ propnececond ] is now completed .",
    "now , from proposition [ propnececond ] , we are going to prove theorem [ thmhelmdisc ] .",
    "precisely , let us define , for any @xmath11 , the following discrete lagrangian functional : @xmath153{lrcl}{\\mathscr{l}}^{{\\boldsymbol{t } } } : & { \\mathbb{r}^{n+1}}&\\longrightarrow & { \\mathbb{r}}\\\\&{\\boldsymbol{q } } & \\longmapsto & h \\di \\sum_{p=1}^n l_- \\big ( q_p , ( \\delta_- { \\boldsymbol{q}})_p , t_p , h\\big ) + h \\di \\sum_{p=0}^{n-1 } l_+ \\big ( q_p , ( -\\delta_+ { \\boldsymbol{q}})_p , t_p , h \\big ) \\end{array}}\\ ] ] where @xmath3 is the couple of lagrangian given in the point @xmath154 of proposition [ propnececond ] . then , we have for any @xmath11 and any @xmath56 : @xmath155 where @xmath156 is defined in proposition [ propnececond ] .",
    "consequently , we have for any @xmath11 , any @xmath56 and any @xmath157 : @xmath158 however , using the same method than in the proof of theorem [ thmdisclag ] , we prove from equation that for any @xmath11 , any @xmath56 and any @xmath157 : @xmath159 w_p,\\ ] ] where @xmath64 and @xmath65 .",
    "combining equalities and , we conclude that for any @xmath11 , any @xmath56 and any @xmath109 : @xmath160 in order to finish the proof of theorem [ thmhelmdisc ] , we have just to prove that equality is still true for @xmath161 and @xmath162 .",
    "we only prove it for @xmath162 .",
    "the case @xmath161 can be proved in a similar way .",
    "+ in this way , let us take @xmath11 and @xmath56 .",
    "let us denote @xmath163 and @xmath164 where @xmath165 and @xmath166 . from equality",
    ", we have : @xmath167 where @xmath168 and @xmath169 .",
    "consequently , we have : @xmath170 the proof of theorem [ thmhelmdisc ] is completed .",
    "in this section , we are interested in the second part of the helmholtz problem both in the continuous and discrete cases .",
    "precisely , once the helmholtz condition satisfied , can we characterize all the possible ( couple of ) lagrangian leading to the same second order ( discrete ) euler - lagrange equation ?",
    "let @xmath171 , @xmath172 be two lagrangian .",
    "they are said to be _ equivalent _ if they lead to the same second order euler - lagrange equation . in this case , we denote @xmath173 .",
    "the linearity of the euler - lagrange equation with respect to its associated lagrangian implies that @xmath174 defines an equivalence relation on the set of lagrangian .",
    "+ hence , the aim is to characterize the equivalence class of @xmath175 . if a lagrangian @xmath25 belongs to the equivalence class of @xmath175 , then it",
    "it leads to a null second order euler - lagrange equation in the sense that every curves @xmath31 are solutions . in this case",
    ", @xmath25 is said to be a _",
    "null lagrangian_. we refer to @xcite for a detailed proof of the following result :    [ thmnullcont ] let @xmath25 be a lagrangian .",
    "@xmath25 is a null lagrangian if and only if there exist two functions @xmath176 and @xmath177 such that : @xmath178,{\\mathbb{r } } ) , \\ ;",
    "l(q,\\dot{q},t ) = \\dfrac{d}{dt } \\big ( f ( q , t ) \\big ) + g(t).\\ ] ]    let us note that , in the major of literature , the previous theorem is presented with @xmath179 . indeed , we have just to add an anti - derivative of @xmath180 to @xmath181",
    ". however , in the next section , we can prove the discrete version of theorem [ thmnullcont ] only with this presentation .",
    "let @xmath182 and @xmath183 be two couples of lagrangian .",
    "we say that they are _ equivalent _ if they lead to the same discrete second order euler - lagrange equation . in this case , we denote @xmath184 .",
    "the linearity of the discrete euler - lagrange equation with respect to its associated couple of lagrangian implies that @xmath174 defines an equivalence relation on the set of couple of lagrangian .",
    "if a couple of lagrangian @xmath3 belongs to the equivalence class of @xmath175 , then it leads to a null second order discrete euler - lagrange equation in the sense that every discrete curves @xmath60 are solutions . in this case",
    ", @xmath3 is said to be a _",
    "null couple of lagrangian_.      [ thmnulldisc ] let @xmath3 be a couple of lagrangian .",
    "@xmath3 is a null couple of lagrangian if and only if there exist two functions @xmath185 and @xmath186 such that for any @xmath11 , any @xmath56 and any @xmath187 : @xmath188    let us prove the sufficient condition .",
    "let us assume that equation is true and let @xmath57 denote the discrete lagrangian functional associated to @xmath3 and to a partition @xmath11 .",
    "then , we have for any @xmath11 and any @xmath56 : @xmath189 \\\\ & = & h \\di \\sum_{p=1}^n \\big [ \\delta_- \\big ( f ( { \\boldsymbol{q}},{\\boldsymbol{t}},h ) \\big)_p + g(t_p , h ) \\big]\\\\ & = & f ( q_n , t_n , h ) - f ( q_0,t_0,h ) + h \\di \\sum _ { p=1}^n g(t_p , h).\\end{aligned}\\ ] ] consequently , since the set of discrete variations is @xmath190 , every discrete curves @xmath56 are discrete critical points of @xmath57 and then the discrete euler - lagrange equation associated is null . then , @xmath3 is a null couple of lagrangian .",
    "+ now , let us prove the necessary condition .",
    "let us assume that @xmath3 is a null couple of lagrangian . then",
    ", for any @xmath11 and any @xmath56 , we have : @xmath191 then , let us define : @xmath14{lrcl}\\ell_- : & { \\mathbb{r}}^3 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x_1,x_2,t,\\xi ) & \\longmapsto & l_- \\big ( x_1,\\dfrac{x_1-x_2}{\\xi},t , \\xi \\big ) \\end{array}}\\ ] ] and @xmath14{lrcl}\\ell_+ : & { \\mathbb{r}}^3 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x_1,x_2,t,\\xi ) & \\longmapsto & l_+ \\big ( x_1,\\dfrac{x_2-x_1}{\\xi},t , \\xi \\big ) .",
    "\\end{array}}\\ ] ] since equality is true for any @xmath11 and any @xmath56 , we have for any @xmath192 : @xmath193 then , by differentiating the previous equality with respect to @xmath147 or to @xmath148 , we obtain for any @xmath194 : @xmath195 consequently , there exist two functions @xmath196 such that for any @xmath194 : @xmath197 moreover , let us denote @xmath57 the discrete lagrangian functional associated to @xmath3 and to a partition @xmath11 .",
    "then , we have for any @xmath11 and any @xmath56 : @xmath189 \\\\ & = & h \\di \\sum_{p=1}^n \\big [ \\ell_- ( q_p , q_{p-1},t_p , h ) + \\ell_+ ( q_{p-1},q_p , t_{p-1},h ) \\big ] \\\\ &",
    "= & h \\di \\sum_{p=1}^n \\big [ \\alpha ( q_p , t_p , h ) + \\beta ( q_{p-1},t_{p},h ) \\big].\\end{aligned}\\ ] ] with a discrete calculus of variations , we obtain for any @xmath11 , any @xmath56 and any @xmath62 : @xmath198 w_p.\\ ] ] since @xmath3 is a null couple of lagrangian , we have @xmath199 for any @xmath11 , any @xmath56 and any @xmath62 .",
    "consequently , for any @xmath11 and any @xmath56 , we have : @xmath200 consequently , we have for any @xmath201 : @xmath202 hence , there exists a function @xmath203 such that : @xmath204 then , according to equality , we have for any @xmath194 : @xmath205 thus , we have for any @xmath11 , any @xmath56 and any @xmath187 : @xmath206 hence , let us define : @xmath14{lrcl}f : & { \\mathbb{r}}^2 \\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(x , t,\\xi ) & \\longmapsto & \\xi \\alpha ( x , t,\\xi ) \\end{array}}\\ ] ] and @xmath14{lrcl}g : & { \\mathbb{r}}\\times { \\mathbb{r}}^+ _ * & \\longrightarrow & { \\mathbb{r}}\\\\&(t,\\xi ) & \\longmapsto & \\gamma(t-\\xi,\\xi ) .",
    "\\end{array}}\\ ] ] then , we have for any @xmath11 , any @xmath56 and any @xmath187 : @xmath207 the proof is completed .",
    "e.  hairer , c.  lubich , and g.  wanner .",
    ", volume  31 of _ springer series in computational mathematics_. springer - verlag , berlin , second edition , 2006 .",
    "structure - preserving algorithms for ordinary differential equations ."
  ],
  "abstract_text": [
    "<S> we derive the discrete version of the classical helmholtz condition . </S>",
    "<S> precisely , we state a theorem characterizing second order finite differences equations ( see definition [ defsofde ] ) admitting a lagrangian formulation . moreover , in the affirmative case , we provide the class of all possible lagrangian formulations .    * * discrete helmholtz condition ; discrete calculus of variations . </S>"
  ]
}