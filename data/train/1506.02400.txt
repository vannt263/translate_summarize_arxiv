{
  "article_text": [
    "in this paper , we present algorithms for producing 3d color prints , which are highly accurate and detailed . from a technical standpoint",
    ", we consider the problem of halftoning a signal defined on a surface for the purposes of accurate color reproduction in @xmath0d printing when using translucent materials . more specifically , we present algorithms for error - diffusion on voxel representations of surfaces , which are compatible with translucent printing materials .",
    "accurate color reproduction is important in many applications of @xmath0d printing , especially for design - prototypes or @xmath0d color copies , where a texture - mapped @xmath0d scan of an object is to be reproduced in a color - consistent way ; this includes @xmath0d portraits .",
    "while @xmath0d color printing has existed for some time using powder - binder  @xcite and layer - laminated  @xcite systems , multi - jet @xmath0d printers with sufficient materials for color printing have only recently come on the market  @xcite . in comparison to powder - based systems ,",
    "multi - jet printers produce smoother surfaces at higher resolutions , and allow more control over the internal structure of the print .",
    "in the longer term , such printers have much greater potential to reproduce complex appearance properties .",
    "in fact , multi - jet printers with fewer materials have been used to approximate desired single - tone subsurface scattering properties  @xcite , and opaque objects inside transparent shells  @xcite .",
    "unfortunately , software allowing full color printing with multi - jet printers is not yet available ; the factory software allows colors to be selected from a palette of @xmath2 and manually assigned to shells .    without accurate color reproduction ,",
    "more complex appearance characteristics are limited in their applicability and appeal .",
    "therefore , accurate color reproduction is a crucial step to fully exploiting the appearance capabilities of these printers .",
    "we provide precisely this critical building block for graphical @xmath0d printing with this paper .    however , there are substantial technical challenges in color reproduction with multi - jet printers .",
    "first , is the amount of data that must be processed . for accurate color ,",
    "the material assigned to each voxel must be controlled .",
    "modern @xmath0d printers have a resolution of more than @xmath3 million voxels per cubic centimeter .",
    "thus , prints such as those in figure [ fig : teaser ] require tens of billions of voxels ( see table [ tab : performance ] for details ) .",
    "both resolution and build volume of @xmath0d printers are expected to increase in the coming years .",
    "second , for multi - jet printers currently on the market , the colored materials are highly translucent , which means that the organization of the materials a significant distance beneath the surface , up to a few millimeters , can greatly affect the perceived color as discussed in section [ sec : prelim ] .",
    "this translucency leads to both blurring of fine - scale details in textures , and to artifacts caused by severe dot - gain if care is not taken in the material arrangement .",
    "it is therefore highly important to control material placement several layers of voxels beneath the surface , considering the transmission and scattering properties of the materials , greatly complicating the computational aspects of halftoning algorithms .",
    "while we expect less translucent materials to come on the market in the future , not only will our proposed technique also work for these materials , it will actually perform better  producing equal or larger color gamuts with less computational effort .",
    "further , employing translucent materials may have its own advantages , when we consider materials with similar translucency as observed in skin .",
    "third , while powder - binder and layer - laminated systems , like @xmath1d color printing , may combine up to @xmath0 inks at a single surface location , multi - jet printing allows exactly one material per voxel .    in this paper",
    ", we leverage the knowledge of decades of research in color imaging , color management and @xmath1d color printing , to maximize the quality and exploit the full capabilities of high - resolution multi - material 3d printers  and push their limits towards realism . to this end , we propose a geometry - adaptive error diffusion halftoning algorithm , which includes the following technical contributions :    * a traversal algorithm for voxel representations of surfaces , which maps 2d anisotropic error diffusion filters onto a surface in a consistently oriented way ( section [ sec : traversal ] ) and requires only local information to do so .",
    "* a layered halftoning algorithm , which combines the traversal algorithm with an arbitrary 2d error diffusion algorithm , and can adapt to the translucency of the materials or increase the color gamut by varying the number of layers ( section [ sec : layered ] ) .",
    "we do not attempt to approximate the full bssrdf of an object , but rather present halftoning algorithms capable of reproducing an object s albedo texture even when the printing materials are highly translucent , under non - pathological illuminaton conditions , such as a light source in contact with ( as in figure [ fig : material_translucency ] ) or inside the printed object .",
    "note that a high - quality halftone , such as those produced by our algorithms , is necessary , but not sufficient to accurately reproduce an object s color .",
    "additionally , one needs colorimetrically or spectrally accurate measurements of the object s color , which are typically not provided by common 3d scanners , and an accurate optical printer model . in section [ sec : colormanagement ] we describe a fully empirical model for our printer .",
    "a more accurate model is left for future work .",
    "* existing 3d color printing technologies .",
    "* powder - binder  @xcite and layer - laminated  @xcite systems provide full color solutions . in both cases ,",
    "cmyk inks are applied to a white base material .",
    "although these technologies are effective for color printing , they do not provide the resolution or smooth surfaces of multi - jet systems and are limited to nearly opaque materials .",
    "they therefore have less potential for future combinations of color with complex appearance properties .",
    "* appearance reproduction and multi - material fabrication . *",
    "spec2fab  @xcite is a general reducer - tuner framework for specification - driven digital fabrication , which allows textures to be replicated on a 3d print .",
    "they use an error diffusion optimization of material layerings , effectively a contone , with a uniform error filter ( error is pushed equally to all neighbors ) .",
    "although an important first step in texture - mapping for multi - material printers , it does not allow for anisotropic error diffusion filters , and the iterative optimization prohibits a streaming architecture .",
    "openfab  @xcite is a programmable fabrication pipeline for @xmath0d printers , which uses in - slice @xmath1d error diffusion dithering  @xcite .",
    "the authors observe that by dithering in @xmath0d they could avoid streaks .",
    "our approach treats the color signal where it is defined  on the surface  by mapping @xmath1d filters into the tangent space of the surface . as discussed below , this allows us to colorimetrically characterize the 3d printer in a geometry - independent way .",
    "multi - material @xmath0d printing has been used to reproduce specified subsurface scattering properties  @xcite .",
    "fabrication of directional brdfs for planar or near - planar surfaces has been done using multi - material printing  @xcite and photolithography  @xcite .",
    "given the work that has already been done using multi - material @xmath0d printing to reproduce complex appearance properties , the introduction of full color opens up tremendous possibilities for future appearance fabrication .",
    "* tone reproduction in fdm prints . * some recent work has focused on the challenging task of improving tone reproduction in fused deposition modeling ( fdm ) printing .",
    "hergel and lefebvre  @xcite optimize seam placement in multi - filament fdm prints to hide or reduce artifacts from changing filaments .",
    "reiner et al .",
    "@xcite perform a type of halftoning for fdm printers while maintain long filament paths .",
    "switching filament heads not only creates artifacts , but also increases print time .",
    "both of these methods are specific to fdm printers .",
    "* 3d halftoning . *",
    "@xmath0d halftoning has been applied to material composition using @xmath0d error diffusion filters  @xcite and @xmath0d dispersed - dot dithering  @xcite . for color and appearance reproduction , 3d error diffusion is not appropriate because material assignments closer to the surface will have a greater influence on the appearance of the object than material assignments deeper within the object .",
    "thus , a 3d error diffusion filter would have to adjust its orientation during traversal to account for this and maintain a consistent orientation with respect to the surface .",
    "an isotropic filter would produce similar artifacts as are observed with isotropic filters in 2d error diffusion .",
    "in contrast , our approach of halftoning on multiple offset surfaces within the object , in addition to the surface itself , results in a halftone that inherently accounts for the geometry of the surface . the relative influence of voxels at different depths from the surface is calibrated in an offline process and built into an international color consortium ( icc ) profile .",
    "such an offline color calibration process would be very challenging for a 3d filter , because it would require calibrating every possible surface orientation .",
    "* 2d halftoning . *",
    "generations of researchers in the field of 2d halftoning focused on finding methodologies to optimally arrange printed dots for maximizing print quality ( by preserving tone and structure and shifting quantization errors to the highest spatial frequencies possible - see section [ sec : perceptionprinting ] ) subject to technical limitations of printing systems ( e.g. the ability to accurately deposit isolated dots )  @xcite .",
    "one category of algorithms , called _ point processes _ , allow a very fast computation of the halftone screens by thresholding pixels using a precomputed threshold mask that is tiled over the 2d image .",
    "the traditional clustered - dot order dithering to create amplitude modulated screens and dispersed - dot ordered dithering  @xcite fall into this category .",
    "the latter technique was adapted to 3d printing  @xcite accounting particularly for dot placement limitations of binder - jetting systems .",
    "one drawback of dispersed - dot",
    "ordered dithering is that frequency components given by the screen period are visible resulting in cross - hatch pattern artifacts .",
    "avoiding such artifacts in point process techniques , requires large threshold masks  e.g. blue - noise masks  @xcite or green - noise masks  @xcite  which are heavily distorted if applied on surface manifolds with non - zero gaussian curvature .    a second category of algorithms , called _ neighborhood processes _",
    ", considers a local pixel neighborhood for thresholding .",
    "error - diffusion methods ( see appendix ) belong to this category and were pioneered by floyd - steinberg  @xcite . since then , the first error diffusion techniques affected by visual artifacts from low - frequency structural patterns ) were improved drastically producing visually pleasing halftones without artifacts .",
    "multiple modifications have been proposed including edge enhancement  @xcite , tone - dependent diffusion filters  @xcite , threshold modulation  @xcite structure preservation  @xcite or memory efficient processing  @xcite .",
    "a last category employs models of the human visual system to optimize halftone pattern iteratively @xcite .",
    "such methods can produce the highest halftone quality , but are in general computationally much more expensive than methods belonging to the other categories .",
    "furthermore , these methods iterate over the whole data and require substantial modifications for adapting them into a streaming architecture . since iterative methods aim to preserve local structure , their quality advantages over other methods diminish with increasing print resolution .    due to the low computational effort and high quality of 2d error diffusion achieved with small diffusion filters",
    ", we decided to adapt it to 3d color printing .",
    "one prior work addresses error diffusion on a surface  @xcite .",
    "this approach operates on meshes and traverses the vertices based on the availability of subsequent moves or neighbors to diffuse error to .",
    "while this approach could be applied to any graph structure , including voxels , it is not clear that it can be applied in a streaming architecture . to the best of our knowledge",
    ", we are the first to consider error diffusion halftoning in the context of both non - euclidean domains and highly translucent materials .",
    "moreover , we are the first to propose such a technique demonstrated to be applicable in practice to tens of billions of elements .",
    "given an arrangement of multiple non - fluorescent printing materials with similar refractive indexes within a shape @xmath4 , light propagation within this shape can be described by the steady - state radiative transfer equation  @xcite ( see supplemental material for details ) , which shows that the intensity of light traveling through the material is attenuated by absorption ( dependent on wavelength , independent of direction ) and is redistributed by scattering .",
    "thus , a fraction of light entering the print at one location may be emitted from the surface at a different location due to scattering ( see figure [ fig : material_translucency ] ) .",
    "if light travels through different materials its spectral power distribution is modulated by each material s absorption coefficients and the path length within this material .",
    "this has multiple implications for arranging translucent ( high scattering , low absorption ) printing materials colored in cyan ( c ) , magenta ( m ) , yellow ( y ) and white ( w ) for full color 3d printing .",
    "_ highest reflectance ( white point ) : _ to maximize reflectance , not only the surface must be covered with white material , but also the space beneath .",
    "a significant fraction of light travels deep into the object due to the low absorption . each non - white material with higher absorption placed into the light path would absorb light that would otherwise contribute to the albedo .",
    "there exists a minimum thickness @xmath5 of a white layer to create almost maximum reflectance , i.e. for each @xmath6 : @xmath7 , where @xmath8 and @xmath9 are spectral reflectances of white layers with thicknesses @xmath5 and @xmath10 , and @xmath11 is the maximally acceptable reflectance difference .",
    "_ lowest reflectance ( black point ) : _ to minimize reflectance , the printing material arrangement must ensure that light in the whole visible wavelength range is maximally absorbed .",
    "this can only be achieved by appropriately arranging c , m , y materials on the surface and beneath .",
    "the minimal layer thickness @xmath12 of such an arrangement for creating almost minimal reflectance ( deviating only by @xmath11 from minimum ) satisfies @xmath13 because the color materials absorption coefficients are larger than that of white ( assuming similar scattering properties of all materials ) .",
    "therefore , not all voxels in the shape addressable by the printer need to be considered .",
    "we can drastically reduce computation by filling all voxels within the shape by default with white ( maximizing reflectance of the white point ) and compute the arrangement of remaining materials only within @xmath12 of the surface .",
    "although material placement with a distance @xmath14 $ ] from the surface may impact reflectance , it affects only very bright colors which are also reproducible by color halftones in upper layers . while theoretically one could derive @xmath12 based on measurements of the material parameters , section [ sec : layered : construct ] shows how selecting a maximum distance @xmath15 from the surface allows an empirical trade - off between the number of voxels that must be addressed and the achievable gamut volume .    _ optical dot gain : _ voxels occupied by a colored material and surrounded by white material appear larger because the spectral power distribution of light traveling through both materials is modulated mostly by absorption of the colored material .",
    "this phenomenon is known in 2d printing as _ optical dot gain _",
    "the more colored voxels are stacked on top of each other aligned with the surface normal the more laterally scattered light is modulated by the colored material .",
    "thus , the colored area on the surface appears not only darker , but also larger as shown in figure [ fig : dot_gain ] .",
    "algorithms that use surface halftones to assign materials to inner voxels must consider this phenomenon to avoid dot gain artifacts particularly visible in bright areas by isolated disturbing large dots .",
    "section [ sec : layered : assign ] describes how independently halftoning layers allows to decorrelate material assignments in different layers , which greatly reduces dot gain artifacts in translucent materials .",
    "each printing system is limited in reproducing reflectances due to the small number of available printing materials . still , accurate color reproduction is possible by material arrangements creating physical errors for which the human visual system ( hvs ) is insensitive .",
    "two perceptual aspects are particularly important in printing .",
    "_ contrast perception : _ contrast sensitivity functions ( csfs ) describe the hvs s sensitivity to achromatic and chromatic contrasts as a function of spatial frequency , orientation and luminance  @xcite .",
    "the achromatic csf has bandpass and chromatic csfs have lowpass characteristics .",
    "each csf monotonically decreases for frequencies higher than 10 cycles / degree resulting in an apparent blurring of high frequency contrasts .",
    "this is used in printing by arranging printing materials in high frequency patterns ( halftones ) to create various color shades from only a few colored printing materials .",
    "_ color perception : _ retinal processing reduces the information content of a spectral stimulus to only three values  the cone responses  @xcite .",
    "therefore , different reflectance spectra viewed under the same illuminant match visually if corresponding spectral stimuli yield similar cone responses . by agreeing on the viewing illuminant ,",
    "accurate color printing is possible by material arrangements that reproduce cone responses instead of reflectances .",
    "a drawback of this _ metameric color reproduction _ is a likely mismatch between prints and originals for other illuminants .",
    "cie colorimetry provides two standardized color spaces for metameric printing ( see e.g.  @xcite ) : ciexyz , which is linearly related to cone responses ; and cielab , an opponent color space derived from ciexyz that allows simple access to color attribute predictors for lightness , chroma and hue and is perceptually more uniform .",
    "color control in metameric printing is done by _ separation_relating ciexyz or cielab values to material arrangements . since this is generally impossible for all colors due to gamut limitations of the printing system , a preceding _ gamut mapping _",
    "method must transform all colors into the device gamut aiming to minimize perceptual errors between original and reproduction  @xcite .",
    "given the resolution of current 3d printers , and expected increases in both resolution and build space , we need a streaming model for computation , wherein only localized data and computation are needed .",
    "figure [ fig : flowchart ] shows such a streaming framework , which takes as input shape and color information , and produces printer compatible data in which a single material is assigned to each voxel .",
    "the error diffusion and material assignment algorithms described in sections [ sec : traversal ] and [ sec : layered ] are our core contributions and take place in the parts colored reddish .",
    "each aspect of our framework is described briefly below .",
    "* shape @xmath16 color : * the input to our pipeline is a shape @xmath17 defined by a surface @xmath18 ( e.g. tessellated mesh ) with attached color information @xmath19 ( texture data or per - vertex colors ) , where @xmath20 is specified by an invertible transformation from ciexyz defined for an illuminant ( e.g. cied50 ) and a set of color matching functions ( cmfs ) ( e.g. cie 1931 cmfs ) .",
    "examples for @xmath20 are standard rgb color spaces  @xcite . by default",
    "we interpret rgb data as srgb .",
    "* voxelization : * the axis - aligned bounding box of our shape @xmath21 is discretized with a fixed , regular grid of voxels @xmath22 at the resolution given by the printer specification .",
    "we slice the surface and identify interior , @xmath23 , and surface voxels , @xmath24 , where a _ slice _ refers to a 2d array of voxels with a constant @xmath25-coordinate .",
    "the full slice is denoted by @xmath26 for slice @xmath27 with center @xmath25-coordinate @xmath28 , and @xmath29 denotes the surface voxels in slice @xmath27 .",
    "our voxelizer generates slices in chunks of @xmath30 slices@xmath31 for our hardware setup  depending on the number of layers and layer thickness as discussed in section [ sec : layered ] , until the object is completely sliced .",
    "each chunk proceeds through the pipeline until materials have been assigned , and printer - specific output has been generated .",
    "then the next chunk is generated .    during the voxelization process , we assign colors to the surface voxels ; abusing notation slightly , we redefine @xmath32 as a function on the surface voxels .",
    "we sample the texture data using trilinear interpolation ( mipmapping ) with the level - of - detail computed per surface voxel .",
    "this is key to avoid aliasing  while there are no viewpoint - dependent effects as in rendering , the texture map is in general non - uniform over the surface .",
    "* color management : * in this stage ,",
    "which includes gamut mapping and color separation , we map color data to printer tonal values using icc color management @xcite ( see section [ sec : colormanagement ] ) : @xmath33 , where each element of the tonal value space @xmath34 corresponds to the amount of available printing materials required to best reproduce a desired color . by function",
    "composition we attach one tonal value vector to each surface voxel : @xmath35 .",
    "* layer construction : * to account for the translucency of the materials , see figures [ fig : material_translucency ] and [ fig : dot_gain ] , we transfer the tonal values stored in the surface voxels to the interior voxels within a distance @xmath36 of the surface",
    ". see figure [ fig : layer_illustrate ] for an example .",
    "these voxels have the greatest influence on the appearance of the printed object . from these voxels",
    ", we extract a set of layers as isosurfaces of distance to the surface of the object .",
    "the number and thickness of the layers determine @xmath36 , and these are chosen as described in section [ sec : layered : construct ] .    * halftoning : * we then treat each layer as a distinct surface with tonal values , and halftone them independently using the surface traversal algorithm described in section [ sec : traversal ] and the error diffusion and material assignment algorithm described in section [ sec : layered ] .",
    "* material arrangement : * the output of the halftoning is a voxel - level material arrangement @xmath37 , where the set of materials @xmath38 is discrete and small@xmath39 in our case",
    ". we store @xmath40 per - slice , and convert it to a printer - specific format to send to the device .",
    "classical error diffusion algorithms for 2d images , e.g.  @xcite , rely on the partial ordering property of subsets of euclidean domains , to define a traversal order , eg .",
    "raster scan or serpentine scan order , in which error is never pushed to pixels that have already been halftoned .    on a surface , which has non - zero curvature and is in general not a topological disc , such a partial ordering property does not exist without introducing a seam or a singularity , a consequence of the hairy ball theorem .",
    "any traversal scheme will eventually encounter an element that has already been halftoned , requiring either a stop and restart , or a change in direction .",
    "excessive stopping and restarting can lead to poor distribution of error , and we design a traversal that avoids this .    to map anisotropic error diffusion filters on to the surface",
    "requires a local coordinate system of the tangent plane at a given point , which is fixed with the surface normal and one additional direction .",
    "mapping a filter to the surface so that it is consistently oriented for adjacent points is equivalent to parameterizing the tangent space of a surface in a consistent way , or finding smooth vector fields on a surface , which is in general an ill - posed problem and finding an optimal solution requires considering the entire surface .    instead , we propose a voxel - level traversal algorithm that maintains a consistent orientation of the filter , traverses the surface voxels in long runs allowing error to accumulate and diffuse evenly , and does so using only local information .",
    "our traversal avoids situations where voxels only distribute or obtain error during diffusion .",
    "we maintain a consistent orientation of the filter by traversing the voxels in a consistent direction , and using the traversal direction to fix a coordinate system in the tangent plane .",
    "while our traversal provides no theoretical guarantees , it performs well in practice .      as a consistent direction",
    ", we always travel clockwise or counterclockwise about a line parallel with the positive @xmath25-axis . for brevity",
    ", we describe only the counterclockwise case .",
    "note that we want to traverse counterclockwise , not about a global axis , but rather about a line through the center of the local _ connected component _ of voxels .",
    "depending on the geometry of @xmath4 , when it intersects a slice plane @xmath41 and is discretized into a voxel representation , the resulting voxels in slice @xmath27 may belong to multiple connected components .",
    "an example of a slice with multiple connected components can be seen in figure [ fig : layer_illustrate ] .",
    "if the surface normal is close to vertical ( almost parallel with the positive or negative @xmath25-axis ) , then @xmath42 will be multiple voxels wide .",
    "these surface voxels @xmath42 may enclose interior voxels in slice @xmath27 , and will be themselves enclosed by exterior or empty voxels in slice @xmath27 .",
    "figure [ fig : slice_geom ] shows a 2d cross - section of this .",
    "if we consider a part of the shape , which forms a connected component in consecutive slices , and where the surface faces almost in the negative @xmath25 direction , but slopes or curves slightly upward , we have the following situation , which is shown in 2d in figure [ fig : slice_geom ] .",
    "when projected into the @xmath43-plane , the surface voxels of @xmath42 will be located inside the surface voxels of @xmath44 .",
    "if we consider two surface voxels within the same connected component in slice @xmath27 , the innermost should be traversed first , since they are next to @xmath45 and have already received error diffused from slice @xmath46 .",
    "the outermost should be traversed last , which are next to @xmath44 .",
    "the situation is reversed for upward facing surfaces .",
    "we construct an undirected graph for traversal as follows : for each surface voxel @xmath47 , we connect it with an edge to each other surface voxel within the @xmath48 voxel window @xmath49 centered on @xmath50 .",
    "we denote this set of one - ring neighbors @xmath51 .",
    "we traverse the voxel representation of the surface slice by slice , analogous to halftoning an image row by row , by selecting the next voxel from the set of neighbors that are within the same slice , @xmath52 .",
    "error is always diffused upwards to the next slice , and to other surface voxels within the slice , which have not yet been assigned materials , as shown for a very small example ( @xmath53 ) in figure [ fig : traversal ] .",
    "one might also consider standard graph traversals , such as breadth - first or depth - first , also constrained to neighbors within the same slice , but these do not maintain a consistent direction of travel and therefore only permit symmetric error diffusion filters ( e.g. uniform , gaussian , etc . ) .    as described in section [ sec : traversal : geometry ] , the traversal winds up the surface on a slice - by - slice basis counterclockwise about a line through the center of each connected component .",
    "however , finding the center of the current connected component would require a search over all voxels in the slice to determine the connected components , find their centers , and to which connected component each surface voxel belongs .",
    "such a search would prove too expensive  essentially involving a pre - traversal .",
    "we can determine whether a potential next voxel in proper traversal order winds about the connected component in the correct direction using only two pieces of local information .",
    "the first is the surface normal .",
    "the second is the in - slice distance to the exterior of @xmath4 , or distance - to - empty , denoted by @xmath54 for voxel @xmath55 @xmath56 which can be pre - computed for each slice  see figure [ fig : slice_geom ] for an example .",
    "we use the @xmath57-norm for simplicity and efficiency , but another norm would also work .",
    "the gradient of @xmath54 always points to the interior of the connected component to which @xmath50 belongs .",
    "this is important for situations where the current slice may have multiple disconnected components , as in figure [ fig : layer_illustrate ] .",
    "this allows us to efficiently test if a potential next voxel @xmath58 continues in the same direction around the connected component by computing @xmath59 .",
    "for example , if we are traversing counterclockwise , we can rule out all neighbors of @xmath50 for which this cross - product has a negative @xmath25-component .",
    "we denote the subset of @xmath60 satisfying this direction criterion @xmath61 .",
    "referring to figure [ fig : slice_geom ] and recalling the observations of section [ sec : traversal : geometry ] we get the following additional traversal criterion . if the surface faces downward , we wish to stay as _",
    "inside_away from exterior voxels  as possible .",
    "if the surface faces upward , we wish to stay as _ outside _ as possible .",
    "hence we choose the neighbor @xmath62 for down - facing surfaces , and @xmath63 otherwise .    because the surface orientation is determined locally using the surface normal , the traversal adjusts as it traverses a slice with both up- and down - facing segments .",
    "figure [ fig : traversal_order ] shows the traversal order for such a slice .      * start point selection .",
    "* we also use the distance - to - empty , in combination with one other local quantity , to select the start point in each slice .",
    "first , potential starting voxels ( voxels in the slice , which have not yet been traversed ) are filtered based on their _ error diffusion count _ , or number of times they have had error diffused to them from previous slices .",
    "we select the subset of voxels with the largest error diffusion count , and subsequently select from this subset using the distance - to - empty . if the @xmath25-component of the surface normal is negative , the start point is the point , which maximizes the distance - to - empty .",
    "if the @xmath25-component of the surface normal is positive , the start point is the point , which minimizes the distance - to - empty ( i.e. one of outer - most points ) .",
    "once the start point and traversal direction are selected , the direction is tested to ensure it is not a dead end .",
    "if no voxel is available in that direction , the direction is reversed .",
    "this reduces the occurrence of single voxels with few neighbors to push error .    *",
    "birth and death of components . * during the slicing process , new parts of the shape are encountered , creating new connected components of voxels in a given slice . when a new component is encountered in a given slice",
    ", the surface voxels will form a disc in that slice , meaning it can be traversed like an image .",
    "we handle these cases specifically as follows . rather than spiral out , as with other downward facing surfaces , we select a global axis , @xmath64 or @xmath65 , and perform a 2d serpentine scan in this direction .",
    "this avoids situations where a long strip of voxels mostly has error pushed away from it , creating a start - up artifact noticeable for low tonal values .",
    "we also use a 2d serpentine traversal for components , which are ending in the current slice , rather than spiraling in .",
    "we detect the birth of a component when all possible starting points have an error diffusion count of @xmath66 , and the death of a component when all possible starting points have no neighbors in slice @xmath67",
    ".    * serpentine surface scan .",
    "* when we can no longer traverse in the same direction locally ( all @xmath68 have been traversed ) , we reverse direction , as in the serpentine traversal scheme from 2d error diffusion , which is shown to provide significant improvement over raster - scan traversal in images @xcite .",
    "further , when selecting a new start point , we set the traversal direction opposite the traversal direction , in which error was last diffused to the new starting voxel .",
    "once we have chosen the next voxel to traverse , we can establish a local coordinate system at the current surface voxel , with which we can align the error diffusion filter and the neighbors of the current voxel .",
    "as in image error diffusion , one non - zero filter element is aligned with the next voxel to be traversed .",
    "this gives us a direction , which together with the surface normal , gives us the necessary coordinate system for the tangent plane at each surface voxel .",
    "depending on whether the direction is clockwise or counterclockwise , we use either a left - handed or right - handed coordinate system .",
    "figure [ fig : traversal ] shows how an error diffusion filter with @xmath0 non - zero elements is mapped to the neighbors in the tangent space of a voxel as it traverses the surface voxels .",
    "this is closely related to decal mapping methods such as discrete exponential maps  @xcite , and to parallel transport on manifolds , and for large decals exponential maps provide a more general solution",
    ". however , the filters used for error diffusion are typically small enough that the neighbors can simply be projected into the tangent plane while preserving distances .",
    "we let the error diffusion filter live in the local tangent coordinate system , orthogonally project the neighbors onto the tangent space , and find the best alignment of neighbors and non - zero filter elements .",
    "we align neighbors with filter elements using symmetric closest points to avoid a single neighbor being assigned to multiple filter elements .",
    "that is , both the filter element and the neighbor must be closest to each other .      the distance to empty can be computed in time linear in the number of voxels in each slice using a distance transform  @xcite . while this means over the whole print job ,",
    "every voxel in @xmath22 must be visited , the constant hidden in the @xmath69 notation is very small and the distance transform is highly efficient .",
    "selection of the starting point requires a search over all unprocessed surface voxels , but for non - pathological cases this will only be necessary a small number of times per slice .",
    "each traversal operation requires a constant number of operations , as the number of neighbors is constant .",
    "normals can be computed in @xmath70 per slice using a signed distance field as an implicit surface definition , as described in section [ sec : layered : construct ] .",
    "thus , the total time complexity to fully process @xmath4 is linear in the total number of voxels @xmath71 with a small constant , which is very well suited to a streaming architecture .",
    "applying a halftone only to the surface voxels will result in a very low contrast print , due to the translucency of the materials .",
    "we can see this from figure [ fig : dot_gain ] , which shows how increasing the depth of color material assignment increases the contrast . in figure",
    "[ fig : layer_gamut ] , we see how increasing the depth of color assignment increases the color gamut . for this reason ,",
    "we introduce _ layered halftoning _ , in which color data is transferred from the surface to additional isosurfaces , or layers , within the object , which are then independently halftoned using the traversal scheme presented in section [ sec : traversal ] and an adaptive filter  @xcite and threshold error diffusion algorithm  @xcite .",
    "layered halftoning begins by transferring the surface tonal values @xmath72 from @xmath73 to a subset of @xmath74 within a distance @xmath36 of the surface .",
    "all interior voxels more distant from the surface are assigned a white material to maximize reflectance as explained in section [ sec : prelim ] .",
    "this requires both many distance computations and a transfer operator @xmath75 , which maps functions on @xmath73 to functions on @xmath74 .    to compute the distance field @xmath76 of voxels to the surface , we leverage the fact that we are only interested in voxels within a given distance @xmath36",
    "this allows us to construct a @xmath0d mask containing these distances at the printer resolution .",
    "the distance field @xmath77 is initialized with a large value @xmath78 .",
    "distance computation then proceeds by moving this mask over the surface voxels @xmath73 , and writing the mask value to the voxel at the corresponding offset , if that value is less than the value already there . while this approach is efficient only for relatively small distances , it has the advantage of being embarrassingly parallel and requiring only a less - than operation at each voxel .    as a transfer operator ,",
    "we simply take the tonal value @xmath79 of the nearest surface voxel @xmath80 , allowing the transfer operator to piggy - back on the distance computation at minimal extra cost , i.e. interior tonal values are assigned as @xmath81 for @xmath82 . aside from being easy to compute , this has the benefit of preserving high - frequencies in @xmath72 .",
    "figure [ fig : layer_illustrate ] shows the process of assigning srgb color values to surface voxels , converting them to tonal values , transferring the tonal values to interior voxels and applying error diffusion to get the final material assignment .",
    "note that because tonal values are pushed to the interior in 3d , interior tonal values may include surface tonal values from different slices .    although there are inevitably discontinuities in @xmath83 at the cut loci of the distance field @xmath10 ( voxels @xmath50 where multiple surface voxels are equidistant ) , we found this not to be a problem as the tonal values mostly vary smoothly without significant correlation between high frequencies in @xmath72 and high curvature of the surface . in this case",
    "we simply assign tonals in a first - come fist - served manner .",
    "similarly , although areas with varying curvature result in slight tone shifts from @xmath72 to @xmath83 , in particular for areas of high positive mean curvature , we did not find this to be a problem , even for small prints .",
    "we extract layers of voxels with tonal values from @xmath74 by defining isosurfaces of @xmath10 with which to segment @xmath74 . as isosurfaces",
    "we choose @xmath84 , where @xmath85 is the layer thickness , which we choose to be the voxel size along the dimension of minimum resolution .",
    "we use @xmath86 , where @xmath87 is an integer constant , which defines @xmath88 .",
    "ideally @xmath89 ( see section [ sec : lightscatteringabsorption ] ) to minimize reflectance for maximizing contrast .",
    "however , we make a tradeoff between computational effort and gamut volume and set @xmath90 for all prints shown in this paper .",
    "figure [ fig : layer_gamut ] shows color gamuts computed using @xmath91 with the gamut volume as a fraction of the volume of srgb .",
    "we can see how the volume increases with the number of layers .",
    "however , we found that the black point of the @xmath3-layer profile , @xmath92 , is close to the minimum black point achievable with current cmyw materials@xmath93 for a @xmath94 cube of full cmy mixture .",
    "thus , little additional gamut is likely to be gained by more layers .",
    "voxel layer @xmath95 is then defined as the set of voxels between isosurfaces @xmath95 and @xmath96 , @xmath97 where the second condition is to ensure that the layers form thin voxel approximations of isosurfaces as much as possible , and @xmath98 is the voxel window defined in section [ sec : traversal : algorithm ] .",
    "due to different resolutions along each axis , @xmath99 may be multiple voxels thick depending on the orientation . in the case of @xmath100 , this condition",
    "is replaced by @xmath101 .",
    "note that we can very efficiently compute normals for all isosurfaces , required for traversal of the error diffusion filter ( see section [ sec : traversal : algorithm ] ) : @xmath102 , @xmath103 , where @xmath104 is a signed distance field , for @xmath105 .",
    "we use finite differences to compute @xmath106 .",
    "we treat each voxel layer as a set of surface voxels , traverse them as described in section [ sec : traversal ] , and halftone them as follows .",
    "each tonal channel is halftoned independently using a standard error diffusion filter , mapped onto @xmath107 as described in section [ sec : traversal : mapping ] and in the appendix . at a given voxel @xmath103 , this results in a halftone vector @xmath108 where @xmath109 .",
    "thus , multiple materials may have a tonal value of @xmath110 indicating they should be assigned to @xmath50 .",
    "since we can only assign a single material @xmath111 to each voxel , we apply the following tie - breaking scheme .    for each tonal channel @xmath112",
    ", we maintain a tie - breaker error , @xmath113 , which is initialized to @xmath114 for all @xmath115 at the start of each slice .",
    "if at a given voxel , one or more tonal values are halftoned to @xmath110 , the tonal channel @xmath116 with the largest tie - breaker error is declared the `` winner '' and we assign the corresponding material to the voxel .",
    "we then reset @xmath117 and increment @xmath113 for all other @xmath115 .",
    "if there is no @xmath115 such that @xmath118=1 $ ] , we assign white material to the voxel .",
    "note that this tie - breaking scheme is independent of the per - tonal error diffusion , and the error diffusion does not know when a tonal is quantized to @xmath110 , but the material is not assigned .",
    "this in general leads to a slight loss of tone , but is mitigated by the large number of voxels , and it is anyway accounted for by the color management , as described in section [ sec : colormanagement ] , because we characterize the printer using targets printed with the same algorithm .",
    "note that errors are only diffused within the same layer , and each layer is halftoned independently .",
    "this has the following benefits .",
    "first , it allows different layers to be halftoned in parallel .",
    "second , it further avoids the issue of resampling a halftoned signal , which would be necessary if the halftone was performed on the surface and then transfered to the interior .",
    "this is problematic because the halftoned signal is by design high - frequent and resampling it introduces artifacts .",
    "third , we can use the threshold modulation of the halftoning algorithm  @xcite to avoid inter - layer correlations , which can create dot gain artifacts ( see section [ sec : lightscatteringabsorption ] ) .",
    "we do this by seeding the pseudo - random number generators used for the threshold modulation differently for each slice and layer .    as discussed in section [ sec : layered : construct ] , due to differences in resolution along the different axes , some interior voxels will fall in between layers , and not be directly halftoned . for these voxels",
    ", we simply assign the material of the nearest voxel that does belong to a layer .",
    "we use an objet500 connex3 from stratasys  @xcite , for which the vendor has provided an interface allowing us to specify material assignments at the printer resolution .",
    "as the connex3 allows only 3 model materials and 1 support material , we expanded the possible gamut by coloring the support material with a yellow acid dye .",
    "thus , we print with white , cyan , magenta and yellow materials .",
    "care must be taken that there are no large agglomerations of support within the object , which would weaken the structural integrity of the print . fortunately ,",
    "as our halftone is by design high - frequency , this is avoided by scaling the yellow tonal value by a constant factor between @xmath66 and @xmath110 .",
    "we found @xmath119 to provide both a chromatic yellow and structurally stable prints .",
    "our layer - based approach also allows us to prevent support from being present in the outermost layer ( the surface ) , by applying a layer and tonal dependent soft - thresholding to the tonal values . for error diffusion",
    "we use a tone - adaptive filter  @xcite and threshold modulation technique  @xcite .      specifying the color - to - tonal transformation @xmath120",
    "requires at least two icc profiles : an input profile that specifies texture - data colorimetrically and a printer profile that includes gamut mapping and color separation . generating a printer profile involves a colorimetric characterization of the printer ,",
    "i.e. we need to predict the printout s ciexyz color for each tonal value vector in @xmath121 . for this ,",
    "the tonal value space is sampled and the color of corresponding printouts is measured and used to fit a colorimetric printer model .",
    "we used a fully empirical model , which interpolates between color - measured printouts of densely sampled tonal values  for our cmyw printer we use a uniform @xmath122 sampling of the channel - wise linearized cmy tonal value cube .",
    "linearization is performed employing the broadband murray - davies model according to  @xcite .",
    "this target is printed using the algorithm described in sections [ sec : traversal ] and [ sec : layered]exactly the same algorithm as used to generate the results shown in figures [ fig : visual : objects ] and [ fig : gallery ] , without color management as the input are direct tonal values .",
    "a picture of the resulting printout is shown in figure [ fig : color_manage ] ( left ) .",
    "measuring colors of such highly translucent printing materials is a challenging problem .",
    "it can be shown that measurements made by spectrophotometers used in the graphic arts community are systematically biased towards lower reflectance due to subsurface light transport away from the detection area .",
    "for our color measurements , we used a bidirectional @xmath123 measurement geometry , an almost colorimetric dslr camera ( vora value of 0.9455  @xcite ) , diffuse broadband illumination simulating cied50 , flat fielding ( to account for optical path variations between light source , printed color patches and camera ) , and a polynomial approach to map camera rgb values to ciexyz .",
    "color errors determined by spectroradiometric measurements are within the interinstrument - variability of spectrophotometers used in graphic arts for opaque materials . for more details ,",
    "the reader is referred to  @xcite .",
    "we evaluated the effectiveness of color management as follows .",
    "we took a standard color checker and measured each of the 24 patches with a spectrophotometer .",
    "we then mapped each of these colors into our printer gamut ( 12-layers , figure [ fig : layer_gamut ] , second from right ) , and printed planar patches .",
    "we then measured the printed patches with the almost colorimetric dslr camera , and computed the ciede2000  @xcite differences to the gamut mapped colors  i.e .",
    "the colors predicted by our empirical printer model .",
    "we observed a median error of @xmath124 , a mean error of @xmath125 , and minimum and maximum errors of @xmath126 and @xmath127 . the predicted and printed colors are shown in figure [ fig : color_manage ] ( right ) .",
    "note that , even though the proposed half - toning algorithm was used to print the planar patches , this evaluates _ only the empirical printer model _ and not the halftone , which is evaluated in sections [ sec : experiments : eval ] and  [ sec : experiments : visual ] .",
    "* performance . *",
    "our non - optimized implementation supports multi - threading for some computations ( for example the transfer operator and halftoning each layer in parallel ) , but does not exploit any gpu capabilities , although several aspects would lend themselves well to gpu implementation .",
    "table [ tab : performance ] shows performance data for several prints : the number of voxels , both those assigned a material ( @xmath128 ) and in the build volume ( @xmath129 ) , computation times include the time to deliver the first chunk of slices to the printer and the total , and the print times .",
    "the results were collected on a standard desktop pc with an intel core i7 - 4770 processor and @xmath130 gb of memory .",
    "see text for a description of how we compute the tonal errors .",
    "@xmath131print job terminated after @xmath132 of slices .",
    "[ tab : performance ]    * tone preservation . *",
    "it is in general difficult to evaluate how well a 3d print reproduces the color of the input texture , due to the large change in appearance resulting from different illuminants and illumination distribution in combination with the curved surface . as discussed further in section [ sec : experiments : limits ] , the printing materials we use are highly color inconstant , meaning the perceived color changes under different illuminants .",
    "further , typically the textured model is not rendered using the reflectance properties of the printing materials . in the case of scanned objects , evaluating with respect to",
    "the original object is meaningless , since the capture systems are typically not color calibrated .    therefore , we evaluate the quality of tone preservation , rather than the similarity of perceived colors , as follows .",
    "we compute the root mean squared error ( rmse ) between material assignments @xmath133 and tonal values @xmath83 , which are given for several models in the last column of table [ tab : performance ] .",
    "first , we compute material fractions for each slice  the number of voxels assigned a given material in the slice divided by the total number of voxels @xmath134 such that @xmath135 . then we determine expected material fractions from the tonal values @xmath136 using the demichel equations  @xcite .",
    "for example , we compute the expected material fractions for cyan and white from tonal values as @xmath137 and @xmath138 respectively , where @xmath139 , @xmath140 and @xmath141 are the average tonal values over the same set of voxels .",
    "the formulas are similar for magenta and yellow .",
    "finally , we compute the errors as the difference between the expected material fraction and the actual material fraction for each tonal channel .",
    "we see that our algorithm preserves tone very well , with most errors being less than @xmath142 of the tonal value range .",
    "visual experiments were conducted to assess the structural quality of the proposed halftone method , in particular the level of graininess and the visibility of structural artifacts . for this",
    ", we generated a test surface with the following function @xmath143 where @xmath144 , @xmath145 , @xmath146 with both @xmath64 and @xmath65 ranging from @xmath147 to @xmath148 .",
    "we then applied two textures to this surface , as shown in figure [ fig : visual : objects ] ; one with smooth color gradients and one with high - frequency patches ; the colors were selected to uniformly cover the a*b*-plane of lightness l*=70 and gamut - mapped using the absolute - colorimetric intent of our icc profile .",
    "the printed surfaces were placed on a colorimetrically characterized display next to their rendered versions ( gap of approx .",
    "1.25 cm - the left / right position of rendering and print was randomly chosen for each subject ) .",
    "we used an _ eizo coloredge cg301w _ @xmath149-inch display with a resolution of @xmath150 pixels .",
    "the printed surfaces were @xmath151 , which covers @xmath152 pixels on the screen .",
    "the screen was placed horizontally and illuminated from directly above using a _ just normlicht led color viewing light m _ viewing booth at a distance of @xmath153 from the screen to provide a diffuse illumination .",
    "the illuminant used was led - simulated cied50 .",
    "a chin - rest was placed so to obtain @xmath154 pixels - per - degree ( ppd ) at the screen center ( @xmath155 distance ) and a @xmath156 viewing angle to the screen .",
    "the renderings were done to approximately match this viewing condition and the luminance level of the print .",
    "figure [ fig : visual : objects ] shows pictures taken with an almost colorimetric dslr camera of what the subjects viewed .",
    "a detailed image and diagram of the setup can be found in the supplemental material .",
    "+     30 naive subjects with normal visual acuity  tested with the snellen test  participated in the experiments ( 10 female and 20 male ; average age of 30 years ) . for each of the two textures ,",
    "a total of 10 distorted textures were created by adding zero - mean gaussian pixel - noise with standard deviations of @xmath157 ciede2000 units , simulating different levels of graininess . in a first experiment ,",
    "subjects were asked to select the rendering with the distorted texture matching the graininess of the print . in a second experiment",
    ", they had to judge the level of structural artifacts in the print  showing the noise - free rendering as reference  on a quality scale of 0 - 5 : 0 ( not visible ) , 1 ( visible but not disturbing ) , 2 ( slightly disturbing ) , 3 ( disturbing ) , 4 ( very disturbing ) , 5 ( extremely disturbing ) .    [",
    "tab : experiment ]    results of the experiments are shown in table [ tab : experiment ] . for both textures",
    ", the average perceived graininess level corresponds to a noise standard deviation smaller or equal to 2 ciede2000 units . to put this value into perspective , we computed the pixel - wise ciede2000 differences between the noise - free and distorted texture ( noise std .",
    "of 2 ciede2000 units ) using s - cielab  @xcite with a visual resolution of 60 ppd  @xcite .",
    "the 99th percentile of ciede2000 errors is 1.644 ( smooth texture ) and 1.694 ( patch texture ) .",
    "since this is only slightly above the just noticeable distance , we can conclude that the perceived graininess of the halftone is very low .",
    "the second experiment revealed that also structural artifacts do not adversely affect the perceived quality of the halftone : for both textures , average quality scores are smaller than 1.4 , i.e. artifacts are visible but not even slightly disturbing .",
    "note that there are some drying related artifacts , which are likely considered in the quality scores but independent of the halftone .",
    "+       +    figure [ fig : gallery ] shows some qualitative results demonstrating the detail and realism produced by our software using our hardware and material setup .",
    "part ( a ) shows ( left - to - right ) a head scan  @xcite with original texture rendered with diffuse shading , the same model with the texture gamut - mapped using our profile , and the resulting @xmath0d print ( @xmath158 tall ) .",
    "note how well both smooth tones and high - frequency details are reproduced .",
    "part ( b ) shows the same model printed @xmath148 tall to show the effects of scale on the prints  note how similar the features of the two prints are despite the difference in scale .",
    "part ( c ) shows a realistic - looking printed apple  @xcite .",
    "parts ( d ) and ( e ) demonstrate how well our halftoning algorithms reproduce high - frequency details in the textures",
    ". prints ( c)-(e ) were generated with an error in the icc profile , so the colors are off in absolute terms when compared to the textures . in part ( d )",
    "@xcite , the back of the ear is rendered next to the printed ear , which is about @xmath159 high .",
    "the images of the prints in parts ( a ) and ( e ) were taken under simulated cied50 , to which we color - characterized the camera .",
    "we transformed the raw rgb images to ciexyz values as described in  ( * ? ? ?",
    "3.2 ) , and transformed these values to srgb for display .",
    "all other photographs of prints were taken using automatic camera settings .",
    "our setup is limited primarily from the hardware side . with four materials",
    "we are forced to print without a black .",
    "this means we have difficulty reproducing dark colors and a lack of color constancy  a change of illuminant alters the perceived color .",
    "we measured the color inconstancy index ( cii ) between cied50 and cief11 of cyan , magenta , yellow and white , to be @xmath160 , @xmath161 , @xmath162 and @xmath163 , respectively , using cat02  @xcite for chromatic adaptation and ciede2000 for color difference  @xcite .",
    "we also have no control over the translucency , as the materials have very similar scattering and transmission properties .",
    "we can only use their translucency to create realistic looking objects , not control it to a desired level .",
    "the translucency of the materials also results in blurring of some details ; an interesting approach has been proposed to address this in a way similar to unsharp masking  @xcite .",
    "the introduction of printers with more materials , and new , more opaque materials would address these limitations , and open the possibility of combining color with desired scattering and reflective properties .",
    "a compelling open question is whether such complex appearance properties can be achieved using error diffusion - style techniques .",
    "a further limitation is due to the colored support material . during the uv - curing process , support material adjacent to model material mixes and binds with the model material .",
    "this results in a yellow tinge on some sloping and vertical surfaces .",
    "this could be overcome without additional materials by a multi - pass printing , in which the support material is cured separately from the other materials .",
    "algorithmically , our approach has the same limitations as @xmath1d error diffusion methods : for extremely low tonal values , we encounter mild start - up artifacts ",
    "materials are not placed entirely uniformly .",
    "we have found this only in extreme cases .",
    "the curvature of the surface affects the transfer of tonal values to the interior layers when the mean absolute curvature @xmath164 approaches @xmath165 , where @xmath5 is the depth of highest reflectance as discussed in section [ sec : prelim ] ; equivalently as the radius of curvature approaches @xmath5 .",
    "high negative mean curvature ( convex ) regions may darken and high - frequency texture features that coincide with high positive mean curvature ( concave ) regions will  bloom \" .",
    "we have not found this to be a major problem , although such effects show up strongest in small prints , e.g. the nose of the small ruslan print in figure [ fig : gallery ] ( b ) .",
    "we plan to address curvature - dependent effects in future work , e.g. by adjusting the tonal values according to curvature , which could be estimated using the signed distance field @xmath166 in .",
    "the surfaces used in the visual experiment also demonstrate the extent to which curvature influences the perceived color .",
    "these surfaces , shown in figure [ fig : visual : objects ] , contain both concave and convex regions with high curvature , and relatively flat regions on the periphery .",
    "in this paper , we have presented algorithms for precise and efficient control of material placement in multi - jet @xmath0d printers for the purposes of halftoning  a critical ingredient in accurate color reproduction .",
    "we have presented a layered halftone , which accounts for the high - translucency of currently available color materials , and a traversal algorithm for voxel representations of surfaces , which allows us to map @xmath1d error diffusion filters onto a surface in a consistently oriented way .",
    "this allows us to leverage decades of knowledge from @xmath1d error diffusion research .",
    "our algorithms fit within an efficient streaming architecture , preserve tone and do not produce artifacts .",
    "we have further shown how our algorithms seamlessly allow the printer s support material to be colored , thereby expanding the printer s color gamut while preserving structural stability .",
    "the @xmath0d color prints generated with our setup exhibit a high level of detail and realism .",
    "due to the ability to arbitrarily configure materials with different optical properties through an object , multi - jet printing has tremendous potential for graphical @xmath0d printing in terms of reproducing complex appearance properties .",
    "by providing the first full color capabilities for these printers , we have provided a critical building block for graphical @xmath0d printing .",
    "the introduction of more opaque color materials will allow our algorithms to print with larger color gamuts using fewer layers , resulting in a performance boost .",
    "better exploiting parallelism in our computations is a key direction for future work as printer resolutions and build volumes increase .",
    "as the number of printing materials increase , it will be important to consider printer models in characterizing the printers and computing profiles .",
    "we give a big shout - out to tejas tanksale ( tt ) for his help in generating icc profiles and conducting measurements .",
    "in addition , we thank : christoph godau for access to the equipment at the idd of tu darmstadt ; stratasys for providing the voxel - level printing interface to the printer ; pedro santos and the cultlab3d of fraunhofer igd for making the nefertiti buste available to us ; christian zeh from clariant produkte gmbh for coloring the support material ; ten24 for making the head model available , and scanlab and turbosquid for making the ruslan scan available .",
    "this work was funded by the fhg internal programs under grant no .",
    "attract 008 - 600075 .",
    "our halftoning algorithms we propose are based on error diffusion , in which after a pixel or voxel is quantized , the resulting error is distributed to nearby pixels or voxels using an error diffusion filter .",
    "thus , if a pixel with a value of @xmath126 is quantized to @xmath66 , the error is distributed to its neighbors , making it more likely that they are quantized to @xmath110 .",
    "formally , we are given an input tonal signal @xmath72 and an error signal @xmath167 , which is initialized @xmath168 .",
    "the error diffused signal is defined as @xmath169 which is then quantized using a threshold @xmath170 the resulting error is then diffused to the neighbors @xmath171 where @xmath172 is a neighbor of @xmath50 , @xmath173 is an element of the error diffusion filter diffusing error from @xmath50 to @xmath80 .    .",
    "projet 860pro .",
    "http://www.3dsystems.com/3d-printers/professional/projet-860pro .",
    "model - based color halftoning using direct binary search .  _ 14 , _  12 , 19451959 .",
    "error diffusion on meshes .",
    "_ 46 _ , 336344 .    , brunton , a. , tanksale , t. , and urban , p. 2015 . .",
    "spie / is&t electronic imaging conference ( accepted  included in supplemental material)_. san francisco .",
    "an optimum method for two - level rendition of continuous - tone pictures . in _",
    "ieee intl .",
    "conf . on comm .",
    "_ seattle , wa , 1115 .    ,",
    "kulikowski , j. , and levinson , j. 1966 .",
    "the effect of orientation on the visual resolution of gratings .",
    "_ 187 , _  2 , 427436 .",
    "courier dover publications .    , alain , b. , and ostromoukhov , v. 2009 .",
    "structure - aware error diffusion .",
    "_ 28 , _  5 , 162:1162:8 .",
    "memory efficient error diffusion .",
    "_ 12 , _  11 , 13521366 .    , levin , d. , didyk , p. , sitthi - armorn , p. , and matusik , w. 2013 .",
    "spec2fab : a reducer - tuner model for translating specifications to 3d prints .",
    "_ 32 , _  4 .",
    ", sachs , e. , patrikalakis , n.  m. , and troxel , d.  e. 2003 . a dithering algorithm for local composition control with three - dimensional printing .",
    "_ 35 , _  9 , 851867 .    .",
    ". tech . rep . ,",
    "central bureau of the cie , vienna , austria .    .",
    "vienna , austria .    ,",
    "gobbetti , e. , pintus , r. , and scopigno , r. 2008 .",
    "color enhancement for rapid prototyping . in _",
    "vast_.    \\1924 .",
    "le procd .",
    "_ 26 , _  3 , 1721 , 2627 .    ,",
    "wang , j. , pellacini , f. , tong , x. , and guo , b. 2010 .",
    "fabricating spatially - varying subsurface scattering .",
    "_ 29 , _  4 .    ,",
    "tsai , e. , dikovsky , d. , geraedts , j. , herr , h. , and oxman , n. 2014 .",
    "voxel - based fabrication through material property mapping : a design method for bitmap printing . .",
    "error - diffusion algorithm with edge enhancement .",
    "_ 8 , _  12 , 18441850 .",
    "\\2013 . , 3 ed .",
    "john wiley & sons , inc . , west",
    "sussex , england .",
    "distance transforms of sampled functions",
    ". tech . rep .",
    ", cornell university .",
    "an adaptive algorithm for spatial grey scale .",
    "_ 17 , _  1 .",
    ", fuchs , m. , matusik , w. , pfister , h. , and rusinkiewicz , s. 2010 . physical reproduction of materials with specified subsurface scattering .",
    "_ 29 , _  3 .",
    "clean color : improving multi - filament 3d prints .",
    "_ 33 , _  2 , 469478 .",
    ", 4.3.0.0 ed .",
    "http://www.color.org .",
    "\\2003 . .",
    "_ 28 , _  6 , 425435 .    , dong , y. , pellacini , f. , and tong , x. 2013 .",
    "bi - scale appearance fabrication .",
    "_ 32 , _  4 .    ,",
    "arce , g. , and gallagher , n. 1999 .",
    "digital halftoning by means of green - noise masks .  _",
    "16 , _  7 , 15751586 .",
    "crc press .    ,",
    "glasner , d. , xiong , y. , durand , f. , freeman , w. , matusik , w. , and zickler , t. 2013 .",
    "fabricating brdfs at high spatial resolution using wave optics .",
    "_ 32 , _  4 .",
    "tone - dependent error diffusion .",
    "_ 13 , _  2 , 201215",
    ".    \\1998 .",
    "fundamentals of 3d halftoning .  _",
    "1375 _ , 224239 .",
    ". 2014 . or iris .",
    "http://mcortechnologies.com/3d - printers / iris/.    \\1992 . digital halftoning technique using a blue - noise mask .",
    "_ 9 , _  11 , 19201929 .",
    "john wiley & sons .",
    "_ 359 , _  1 , 381 .",
    "\\2001 . a simple and efficient error - diffusion algorithm . in _ proc .",
    "siggraph_.    , qu , y. , wong , t .- t .",
    ", cohen - or , d. , and heng , p. 2008 .",
    "structure - aware halftoning .",
    "_ 27 , _  3 , 89 .    ,",
    "carr , n. , mech , r. , stava , o. , dachsbacher , c. , and miller , g. 2014 .",
    "dual - color mixing for fused deposition modeling printers .",
    "_ 33 , _  2 , 479486 .    \\1997 . .",
    "_ 41 _ , 643656 .    .",
    "http://www.turbosquid.com/fullpreview/index.cfm/id/777450 .    ,",
    "grimm , c. , and wyvill , b. 2006 .",
    "interactive decal compositing with discrete exponential maps .",
    "_ 25 , _  3 , 605613 .",
    "objet500 connex3 .",
    "http://www.stratasys.com/3d-printers/production-series/connex3-systems .    ,",
    "buckley , r. , and swen , s. 1999 . .",
    "is&t / sid , 7th cic_. scottsdale ariz .",
    ", 127134 .    .",
    "http://www.ten24.info/?p=1164 .",
    "http://www.turbosquid.com/3d-models/free-max-model-apple/549455 .",
    "the mit press .",
    "spatial modulation transfer in the human eye .",
    "_ 57 , _  3 , 401406 .    ,",
    "wang , s .-",
    ", ragan - kelley , j. , and matusik , w. 2013 .",
    "openfab : a programmable pipeline for multi - material fabrication .",
    "_ 32 , _  4 .",
    "measure of goodness of a set of color - scanning filters .",
    "_ 10 _ , 14991508 .",
    "\\2000 . .",
    "_ 25 , _  1 , 419 .",
    "\\2000 . , 2 ed .",
    "john wiley & sons , inc .",
    "\\1996 . .",
    "_ 27 _ , 731734 .",
    "improving mid - tone quality of variable - coefficient error diffusion using threshold modulation .",
    "_ 22 , _  3 , 437444 .",
    "given an arrangement of multiple non - fluorescent printing materials with similar refractive indexes within a shape @xmath4 , light propagation within this shape can be described by the steady - state radiative transfer equation  @xcite @xmath174 where @xmath175 is the radiant intensity at location @xmath176 propagating in direction @xmath177 for wavelength @xmath178 $ ] nm ( visible wavelength range ) , @xmath179 is the spectral absorption coefficient , @xmath180 is the spectral scattering coefficient , @xmath181 is the sphere and @xmath182 is the scattering function satisfying @xmath183 . solving the radiative transfer equation with an appropriate boundary condition at the surface gives us the radiation that is diffusely emitted from the shape .",
    "adding the radiation directly reflected from the surface due to fresnel reflection , gives us the total radiation emitted from the object s surface .",
    "shows that the intensity of radiant energy traveling through the material is attenuated by absorption ( note that @xmath184 depends on the wavelength but is independent of the traveling direction ) and is redistributed by scattering ( scaled by @xmath185 ) .",
    "thus , a fraction of light entering the print at one location may be emitted from the surface at a different location due to scattering .",
    "if light travels through different materials its spectral power distribution is modulated by each material s absorption coefficients and the path length within this material .",
    "figure [ fig : experiment_setup ] shows the physical setup we used to conduct the visual experiment .",
    "subject placed their chin on the chinrest and viewed the printed object next to a rendering of it on a color - calibrated display .",
    "the color characterization of the display was performed from the chinrest position considering the viewing booth illumination . in this way ,",
    "tristimulus values from objects placed on the display and illuminated by the viewing booth could be reproduced on the screen if viewed from the chinrest position ."
  ],
  "abstract_text": [
    "<S> accurate color reproduction is important in many applications of @xmath0d printing , from design prototypes to @xmath0d color copies or portraits . </S>",
    "<S> although full color is available via other technologies , multi - jet printers have greater potential for graphical @xmath0d printing , in terms of reproducing complex appearance properties . </S>",
    "<S> however , to date these printers can not produce full color , and doing so poses substantial technical challenges , from the shear amount of data to the translucency of the available color materials . in this paper </S>",
    "<S> , we propose an error diffusion halftoning approach to achieve full color with multi - jet printers , which operates on multiple isosurfaces or layers within the object . </S>",
    "<S> we propose a novel traversal algorithm for voxel surfaces , which allows the transfer of existing error diffusion algorithms from @xmath1d printing . </S>",
    "<S> the resulting prints faithfully reproduce colors , color gradients and fine - scale details .    </S>",
    "<S> contact : \\{alan.brunton , can.ates.arikan , philipp.urban}@igd.fraunhofer.de + web : www.cuttlefish.de </S>"
  ]
}