{
  "article_text": [
    "quantum error correction holds the promise of extending the coherence time of quantum devices by utilizing redundant encoding of information . like its classical counterpart ,",
    "quantum error correction enables reliable storage of encoded quantum states in the presence of noise by monitoring parity check violations and applying suitable recovery operations .",
    "furthermore , many quantum codes support a limited set of logical operations that can be applied to encoded states without exposing them to noise .",
    "extensive theoretical work rigorously confirmed the feasibility of large - scale fault - tolerant quantum computing for a wide range of noise models  @xcite .",
    "several families of quantum codes have been proposed as candidates for scalable fault - tolerant architectures , including concatenated codes  @xcite , surface codes  @xcite , surface codes with twists  @xcite , color codes  @xcite and turaev - viro codes  @xcite .",
    "each of these families contains an infinite sequence of codes labeled by a code distance @xmath5 .",
    "the number of physical qubits and elementary operations required to implement a single logical gate using a distance-@xmath5 code typically grows polynomially as one increases @xmath5 , whereas the probability of a logical error @xmath0 decreases exponentially , that is , @xmath6 . here",
    "@xmath7 and @xmath8 are constant coefficients depending on the chosen family of codes , the noise model , and the decoding algorithm .",
    "furthermore , the threshold theorem asserts that @xmath9 for a sufficiently small noise strength  @xcite . a problem essential for estimating the overhead associated with error correction is finding the minimum code distance that achieves the desired level of noise suppression",
    "this requires a precise knowledge of the decay rate @xmath10 since the exponential term gives the dominant contribution to @xmath0 for large code distances .",
    "the decay rate @xmath7 is also a natural figure of merit for comparing the performance of different decoding algorithms .",
    "the present paper describes a new algorithm for computing the decay rate @xmath7 in the special case of the surface code family .",
    "we report numerical results for two commonly studied noise models corresponding to noiseless and noisy syndrome readout circuits . prior to our work",
    ", several methods have been developed for computing the decay rate @xmath7 of the surface codes , most notably monte carlo simulation  @xcite and fault path counting  @xcite .",
    "monte carlo method attempts to estimate @xmath0 by generating many random error configurations and computing the fraction of trials that resulted in a logical error .",
    "this method , however , is not a viable option in the regime of small physical error rates and/or large code distances , where logical errors are extremely unlikely .",
    "fault path counting method adapted to surface codes by dennis et al  @xcite provides an upper bound on @xmath0 in the form of a weighted sum over self - avoiding walks on a suitably defined lattice .",
    "this can be translated to a lower bound on the decay rate @xmath7 , although the bound is not expected to be tight .",
    "a different version of the method , proposed by fowler  @xcite , enables exact computation of @xmath0 in the asymptotic regime of small error rates @xmath2 . in this regime the dominant contribution to @xmath0 comes from minimum - weight uncorrectable errors that span @xmath11 physical locations   must be correctable by definition of the code distance . ] . accordingly ,",
    "if the limit @xmath12 is taken for a fixed code distance @xmath5 , one can use an asymptotic formula @xmath13 , where @xmath14 is a constant coefficient .",
    "for relatively small values of @xmath5 one can compute @xmath14 by summing the probabilities of all minimum - weight uncorrectable errors , see ref .",
    "this method , however , is not well - suited for computing the decay rate @xmath7 which requires taking the limit @xmath15 for a fixed error rate @xmath2 .    here we propose a new algorithm for estimating the logical error probability @xmath0 and the decay rate @xmath7 .",
    "it enables us , for the first time , to access the regime of large code distances and moderately small error rates , which we expect to be particularly important in the context of fault - tolerance .",
    "the key ingredients of our algorithm are the splitting method and bennett s acceptance ratio method  @xcite .",
    "the splitting method is a standard tool in monte carlo simulation of rare events , see for instance ref .",
    "@xcite . to compute the quantity @xmath16 for a given physical error rate @xmath2 we choose a sufficiently dense monotonic sequence of error rates @xmath17 , where @xmath18 and @xmath19 is chosen such that @xmath20 can be computed efficiently by either the monte carlo simulation ( in which case @xmath19 must be sufficiently large ) or by the fault path counting method ( in which case @xmath19 must be sufficiently small ) .",
    "we then employ the acceptance ratio method  @xcite to estimate the quantity @xmath21 for each @xmath22 .",
    "this is accomplished through a metropolis - type subroutine for sampling uncorrectable errors from a specific probability distribution .",
    "the metropolis subroutine is the most time consuming part of our algorithm and we propose several tricks for improving its efficiency .",
    "finally , we find @xmath16 from the obvious identity @xmath23 . once @xmath16 has been computed for several choices of the code distances @xmath5 , the exponential fitting yields the decay rate @xmath4 .",
    "depending on whether the sequence @xmath17 is increasing or decreasing we shall use a term upward or downward splitting . to the best of our knowledge , the idea of using the splitting method in the context of error correction was originally proposed by wang , harrington , and preskill  @xcite , see section  iv(d ) of ref .",
    "the use of the acceptance ratio method in this context appears to be new .",
    "we begin by highlighting main features of the surface code and motivating its choice as a testing ground for the proposed algorithm .",
    "the surface code achieves fault - tolerance by repeatedly measuring syndromes of 4-qubit parity check operators on a 2d grid of physical qubits  @xcite .",
    "logical qubits are introduced by creating special defect areas in the lattice in which the pattern of syndrome measurements is altered . by choosing a suitable syndrome readout schedule one can change the location and shape of defects in a way that simulates braiding , splitting , and fusion of topological charges  . by analogy with topological quantum computation  @xcite ,",
    "this enables fault - tolerant implementation of some logical gates such as the cnot  @xcite .",
    "the code distance @xmath5 is determined by the length of the shortest loop encircling a defect or the shortest path connecting some pair of defects .",
    "the code admits efficient decoding by edmonds s minimum weight matching algorithm  @xcite , renormalization group methods  @xcite , or by the markov chain monte carlo algorithm  @xcite , and features an error threshold close to @xmath24 for the standard depolarizing noise model  @xcite .",
    "( color online ) surface code with a pair of smooth defects representing one logical qubit .",
    "physical qubits are indicated by solid circles .",
    "the codespace is defined as a common eigenspace of site and plaquette stabilizers  products of pauli @xmath25 and @xmath26 over stars ( red ) and plaquettes ( green ) .",
    "logical pauli operators @xmath27 and @xmath28 correspond to a loop encircling one of the defects and the path connecting the two defects respectively . ]    let us now describe our numerical results . we consider the standard surface code on a square lattice  @xcite with a pair of defects representing one logical qubit , see fig .",
    "[ fig : flat ] .",
    "a defect is defined as a square block of plaquettes removed from the lattice .",
    "logical pauli operators @xmath27 and @xmath28 are products of pauli @xmath26 and @xmath25 over a loop encircling one of the defects and over a path on the dual lattice connecting the two defects respectively , see fig .",
    "[ fig : flat ] .",
    "the dimensions of the lattice in our simulations were chosen such that the code distance is @xmath29 , where @xmath30 is the linear size of the defects .",
    "accordingly , each defect is separated from the external boundary of the lattice and from the other defect by distance @xmath31 , see fig .",
    "[ fig : decoding ] .",
    "simulations were performed only for @xmath32 to avoid finite size effects .",
    "we first analyze a toy error model with a noiseless syndrome readout where every qubit is subjected to independent bit - flip and phase flip - errors , each applied with probability @xmath2 ( qubits on the external boundary of the lattice may be treated specially , see section  [ sec : implement ] for details ) .",
    "once all errors have been generated , one computes the error syndrome and finds the most likely recovery operator consistent with the syndrome , see sections  [ sec : sc],[sec : ec ] . a logical loop - like or path - like",
    "error occurs if the recovery operator differs from the actual error by a logical operator @xmath27 or @xmath28 ( modulo stabilizers ) .",
    "we are interested in the logical error probability @xmath33 for both loop - like and path - like logical errors . in the chosen geometry",
    "the code distance @xmath5 can only be a multiple of four ; thus , it will be more convenient to define the decay rate @xmath7 such that @xmath34}.\\ ] ] it differs from the decay rate defined earlier by a factor of @xmath35 .",
    "the largest error rate @xmath36 such that @xmath37 for all @xmath38 is known as the error threshold . for the chosen model @xmath39 , see  @xcite . our simulations were performed only for error rates @xmath40 to avoid finite - size effects which become important for @xmath41 .",
    "the numerical results are presented in fig .",
    "[ fig : flat2345 ] .",
    "the logical error probability @xmath0 is shown as a function of @xmath2 for a few small values of @xmath30 .",
    "this provides enough data to perform the exponential fitting @xmath42 and extract the decay rate @xmath7 .",
    "the plot of @xmath7 as a function of @xmath2 is shown in fig .",
    "[ fig : flat_alpha ] .",
    "this figure also shows the estimate of @xmath7 based on the asymptotic low-@xmath2 formula @xmath43 .",
    "it is clear that the latter provides a poor approximation of @xmath7 for large and moderately small error rates , especially in the case of path - like errors .",
    "since @xmath44 , one can easily extend the function @xmath4 to the interval @xmath45 using a linear interpolation .",
    "more details on the simulation methods can be found in section  [ sec : implement ] .",
    "( color online ) _ noiseless syndrome readout . _ the decay rate @xmath4 in the exponential scaling @xmath46}$ ] for loop - like and path - like logical errors computed by the upward splitting method .",
    "the dashed line shows the estimate of @xmath4 based on the asymptotic low-@xmath2 formula @xmath47 , that is , @xmath48 . ]",
    "( color online ) _ noisy syndrome readout . _",
    "the decay rate @xmath4 for loop - like and path - like logical errors computed by the downward splitting method .",
    "the dashed lines show the estimate of @xmath4 based on the low-@xmath2 asymptotic formula @xmath49 , that is , @xmath50 , see the last line of eq .",
    "( [ fit ] ) . ]",
    "the following heuristic ansatz was used to fit the numerical data for @xmath0 : @xmath51 } p_l(p , r_0),\\label{fit } \\\\",
    "p_l(p , r_0 ) & = & \\exp { [ 2r_0 \\log{(p ) } + x(p)]},\\nonumber \\\\",
    "-\\alpha(p)&=&c + 2\\log{(p ) } + \\log { ( 1 + y(p))}. \\nonumber\\end{aligned}\\ ] ] here @xmath52 is the smallest defect size in our simulations , @xmath53 is a constant coefficient , and the functions @xmath54 , @xmath55 are low - degree polynomials such that @xmath56 .",
    "this ansatz is a slightly refined version of the exponential scaling eq .",
    "( [ alpha ] ) that attempts to reproduce the pre - exponential factor .",
    "we fit @xmath54 and @xmath55 by the second and the third degree polynomials , @xmath57 the terms proportional to @xmath58 in eq .",
    "( [ fit ] ) are chosen to reproduce the asymptotic formula @xmath59 in the limit @xmath12 .",
    "the coefficients @xmath53 , @xmath60 and @xmath61 found by fitting the numerical data are listed in table  [ table : fit ] .",
    ".coefficients in the fitting formulas eqs .",
    "( [ fit],[xy]).[table : fit ] [ cols=\"^,^,^,^,^ \" , ]     . for",
    "small code distances @xmath5 one can compute @xmath0 numerically by the monte carlo simulation ( if @xmath2 is close to the threshold ) or by the splitting method ( if @xmath2 is sufficiently below the threshold ) .",
    "the fault - path counting ( fpc ) is applicable for very small error rates .",
    "numerical data are used to estimate the decay rate @xmath7 in the fitting formula @xmath62}$ ] which is applicable for larger values of @xmath5 .",
    "[ fig : diagram ] ]    next we analyze a more realistic noise model with a noisy syndrome readout . here",
    "the syndromes of site and plaquette stabilizers are measured by applying a sequence of cnot gates which couple the respective code qubits with ancillary qubits collecting the syndrome information , see section  [ sec : noisy ] .",
    "independent depolarizing errors occur with probability @xmath2 on each qubit preparation , measurement , and cnot gate .",
    "our noise model mostly coincides with the one introduced by fowler in ref .",
    "@xcite . to enable reliable error correction , the syndrome readout is repeated @xmath5 times , where @xmath29 is the code distance .",
    "the lattice geometry is time - independent which corresponds to the logical identity gate ( fault - tolerant storage ) .",
    "once all syndromes have been generated , the most likely configuration of errors consistent with the syndrome and the corresponding recovery operator on code qubits are computed , see section  [ sec : ec ] .",
    "as before , a logical loop - like or path - like error occurs if the recovery operator differs from the actual accumulated error on code qubits by a logical operator @xmath27 or @xmath28 ( modulo stabilizers ) .",
    "we are interested in the logical error probability @xmath33 for both loop - like and path - like logical errors .",
    "more precisely , we define @xmath0 as the logical error probability divided by the total number of syndrome readout steps , which is @xmath31 in our simulations .",
    "estimates of the error threshold @xmath36 for a noisy syndrome readout vary between @xmath63 and @xmath64 , see  @xcite . to avoid finite size effects",
    ", simulations were performed only for @xmath65 ( as before , one can use linear interpolation to cover the interval between @xmath66 and @xmath36 ) .",
    "our numerical results are presented in figs .",
    "[ fig : alpha],[fig:234 ] . the fitting curves in fig .",
    "[ fig:234 ] represent the ansatz eqs .",
    "( [ fit],[xy ] ) where the coefficients @xmath53 , @xmath60 and @xmath61 are defined in table  [ table : fit ] . as before ,",
    "the numerically computed decay rate @xmath7 is compared with its estimate based on the low-@xmath2 asymptotic formula @xmath13 .",
    "the coefficient @xmath14 was found by setting @xmath67 and @xmath68 in eqs .",
    "( [ fit ] ) .",
    "we observe that the asymptotic low-@xmath2 formula significantly overestimates @xmath7 for large and moderately small error rates .",
    "more details on the simulation methods can be found in section  [ sec : noisy ] .",
    "the limiting factor in our simulations was the running time of the metropolis subroutine which grows rapidly as one increases the error rate , see section  [ sec : implement ] for details .",
    "accordingly , we were able to implement the splitting method only for sufficiently small errors rates , @xmath69 , where @xmath70",
    ". fortunately , the cutoff error rate @xmath71 was large enough to enable monte carlo computation of @xmath16 for all @xmath72 .",
    "in the case of noisy syndrome readout , we used downward splitting to access error rates @xmath69 . for noiseless syndrome readout , where asymptotic low-@xmath2 formulas for @xmath16 are readily available , we used upward splitting to access error rates @xmath69 .",
    "accordingly , in the latter case we were able to test the correctness of the splitting method by comparing the values of @xmath73 found independently by the splitting and the monte carlo methods , see fig .",
    "[ fig : flat2345 ] . for noisy syndrome readout , the correctness of the splitting method",
    "is partially confirmed by the fact that the function @xmath16 computed by the two methods has the same derivative on both sides of @xmath71 , see fig .",
    "[ fig:234 ] . a diagram illustrating the applicability region of each simulation method is shown in fig .",
    "[ fig : diagram ] .",
    "we hope that the new simulation techniques and the fitting formulas can find applications in the estimation of the fault - tolerance overhead for quantum computing architectures based on the surface code .",
    "significant progress in this direction has been recently made in refs .",
    "we hope that our results can refine estimates made in refs .",
    "@xcite by replacing the asymptotic low-@xmath2 formulas for the logical error probability with more accurate approximations , such as the one defined in eqs .",
    "( [ fit],[xy ] ) and table  [ table : fit ] .",
    "we also hope that the fitting formulas eqs .",
    "( [ fit],[xy ] ) have applicability beyond the toy noise models considered in this paper .",
    "in the rest of this paper we introduce the general idea of the splitting method , see section  [ sec : split ] , and specialize it to the surface code settings , see sections  [ sec : sc]-[sec : noisy ] .",
    "it should be emphasized that at present the splitting method is a heuristic algorithm .",
    "deriving rigorous bounds on its running time and the approximation error goes beyond the scope of this paper .",
    "nevertheless , we make first steps in this direction in section  [ sec : corr ] ( see lemmas  1 - 4 ) .",
    "some of our results such as the maximum weight matching decoding algorithm presented in section  [ sec : ec ] and a decoder - independent definition of correctability , see section  [ sec : corr ] , might be interesting on their own right .",
    "we conclude by discussing some open problems in section  [ sec : concl ] .",
    "this section provides some necessary background on the acceptance ratio method due to bennett  @xcite and the splitting method .",
    "let @xmath74 be a finite set of events , @xmath75 be a subset of failure events , and @xmath76 be a normalized probability distribution that assigns a probability @xmath77 to any event @xmath78 .",
    "our goal is to calculate the overall failure probability @xmath79 for any probability distributions @xmath80 such that @xmath81 and such that @xmath82 is known , one can use the obvious identity @xmath83 the splitting method attempts to compute @xmath84 by evaluating each ratio @xmath85 in eq .",
    "( [ sm1 ] ) separately .",
    "the method is applicable whenever the distributions @xmath86 have the following properties : + ( i ) for any event @xmath78 the probability @xmath87 can be computed efficiently .",
    "+ ( ii ) there exists an efficient randomized algorithm @xmath88 that generates samples @xmath89 drawn from the conditional probability distribution @xmath90 .",
    "+ ( iii ) the conditional distributions @xmath91 and @xmath92 have a non - negligible overlap , as quantified below .    given any function @xmath93 , we shall use the shorthand notation @xmath94 then one can easily check that @xmath95 for any constant @xmath96 and any function @xmath97 satisfying the  detailed balance \" condition @xmath98 the expectation values needed to compute the righthand side eq .  ( [ sm3 ] ) can be approximated by calling the algorithm @xmath88 to generate sufficiently many samples @xmath99 drawn from the distribution @xmath91 and using an estimate @xmath100 as was shown in  @xcite , for a fixed number of samples @xmath101 the statistical error in eq .",
    "( [ sm3 ] ) is minimized if one chooses @xmath102 while the constant @xmath103 satisfies @xmath104 in practice , both sides of eq .",
    "( [ sm7 ] ) are replaced by their @xmath101-sample approximations ( as defined in eq .",
    "( [ sm5 ] ) ) ; the resulting equation can then be solved for @xmath103 to obtain the optimal value .",
    "this choice of @xmath105 and @xmath103 guarantees that the ratio @xmath85 is estimated with a relative error @xmath106 , where @xmath107,\\ ] ] see ref .",
    "simple algebra shows that @xmath108 where @xmath109 is the total variation distance .",
    "in particular , if @xmath110 for all @xmath22 then the overall failure probability @xmath84 is estimated with a relative error @xmath111 ( in fact , since different terms in eq .",
    "( [ sm1 ] ) are computed independently , one may expect that the statistical errors accumulate in a random walk fashion ) .",
    "we consider @xmath112 physical qubits located on the edges of a square lattice @xmath113 with open boundary conditions , possibly containing one or several defects , see fig .",
    "[ fig : flat ] for an example .",
    "a defect is defined as a square block of plaquettes removed from the lattice .",
    "the sets of sites , edges , and plaquettes of the lattice are denoted @xmath114 , @xmath115 , and @xmath116 respectively . given a subset of qubits @xmath117 , let @xmath118 and @xmath119 , where @xmath120 and @xmath121 are the pauli operators @xmath122 and @xmath123 acting on the qubit @xmath124 .",
    "for any site @xmath125 and any plaquette @xmath126 let @xmath127 be the set of edges incident to @xmath128 and @xmath129 be the set of edges lying on the boundary of @xmath130 .",
    "pauli operators @xmath131 and @xmath132 are called _ stabilizers _ of the surface code . the stabilizers pairwise commute and have a common invariant subspace @xmath133 the subspace @xmath134 is used to encode logical qubits .",
    "it is well - known that @xmath135 , where @xmath136 is the first betti number of the lattice . for open boundary conditions @xmath136 coincides with the number of defects .",
    "below we only consider single and double defect geometries , @xmath137 . given a pauli error @xmath138 , the syndrome of @xmath138",
    "is defined as the set of all stabilizers anti - commuting with @xmath138 .    to describe the relationship between single - qubit errors and the corresponding syndromes it will be convenient to introduce a _ decoding graph _ @xmath139 .",
    "there will be one decoding graph for each type of pauli errors ( bit - flip and phase - flip errors ) . given a subset of edges @xmath140 , let @xmath141 be the set of vertices @xmath142 having odd number of incident edges from @xmath143 .",
    "let us start with phase errors . in this case ,",
    "the decoding graph @xmath139 is identical to the physical lattice , that is , @xmath144 and @xmath145 . by construction",
    ", a phase - flip error on any edge @xmath124 of @xmath146 creates a pair of syndromes at the two end - points of @xmath124 .",
    "more generally , given a subset of edges @xmath140 , the syndrome of the pauli error @xmath147 coincides with the set @xmath148 .",
    "let us now consider bit - flip errors .",
    "in this case the decoding graph @xmath139 loosely coincides with the dual of the physical lattice .",
    "more precisely , let @xmath149 be the set of all qubits lying on the boundary of the lattice ( either the boundary of some defect or the external boundary ) .",
    "we choose @xmath150 and @xmath145 .",
    "a bit - flip error on any edge @xmath151 creates a pair of syndromes at the two plaquettes @xmath152 adjacent to @xmath124 . in the decoding graph @xmath152",
    "are the two end - points of @xmath124 . a bit - flip error on a boundary edge @xmath153 , however , creates a syndrome only at one plaquette @xmath130 adjacent to @xmath124 . on the decoding graph",
    "@xmath124 is a `` hanging edge '' connecting vertex @xmath130 with a degree-@xmath154 vertex labeled by @xmath124 itself .",
    "more generally , given a subset of edges @xmath155 , the syndrome of a pauli error @xmath156 is @xmath157 . to deal with both types of errors on the same basis , we set @xmath158 in the case of phase - flip errors .     used in the simulations of loop - like errors ( top ) and path - like errors ( bottom ) for @xmath159 .",
    "logical chains @xmath160 are highlighted in red . in the case of path - like errors",
    "the graph contains  hanging edges \" @xmath161 such that @xmath162 is a degree-@xmath154 vertex that carries no syndrome . to avoid clutter ,",
    "a hanging edge @xmath163 is represented by a solid circle centered at @xmath128 ( the degree-@xmath154 vertex @xmath164 is not shown ) .",
    "the geometry depends on three parameters @xmath165 , where @xmath30 is the linear size of the defects , @xmath166 is the separation between the defects , and @xmath167 is the length of the buffer zone separating the defects and the external boundary of the lattice .",
    "the simulations were performed for @xmath168 .",
    "this guarantees that the code distance is @xmath29 .",
    "[ fig : decoding],height=226 ]     used in the simulations of loop - like errors ( top ) and path - like errors ( bottom ) for @xmath159 .",
    "logical chains @xmath160 are highlighted in red . in the case of path - like errors the graph contains  hanging edges \" @xmath161 such that @xmath162 is a degree-@xmath154 vertex that carries no syndrome . to avoid clutter ,",
    "a hanging edge @xmath163 is represented by a solid circle centered at @xmath128 ( the degree-@xmath154 vertex @xmath164 is not shown ) .",
    "the geometry depends on three parameters @xmath165 , where @xmath30 is the linear size of the defects , @xmath166 is the separation between the defects , and @xmath167 is the length of the buffer zone separating the defects and the external boundary of the lattice .",
    "the simulations were performed for @xmath168 .",
    "this guarantees that the code distance is @xmath29 .",
    "[ fig : decoding],height=226 ]    let @xmath169 be a logical state and @xmath138 be an unknown pauli error . we shall deal with phase - flip and bit - flip errors independently , so without loss of generality we can assume that @xmath170 or @xmath171 for some subset of edges @xmath172 in the corresponding decoding graph @xmath139 . following ref .",
    "@xcite we shall refer to the subset @xmath143 as an _ error chain_. error correction is a two - stage process that consists of a syndrome readout followed by a recovery step .",
    "a syndrome readout takes as input the corrupted state @xmath173 and performs a non - destructive eigenvalue measurement of each stabilizer .",
    "it determines the syndrome @xmath174 .",
    "we shall first consider the case when the syndrome readout circuit contains no errors .",
    "noisy syndrome readout is discussed in section  [ sec : noisy ] .",
    "a recovery step is determined by a decoding algorithm that takes as input the measured syndrome @xmath175 and returns a _ recovery chain _ @xmath176 .",
    "the corrupted state @xmath177 is then acted upon by a recovery operator @xmath178 for phase - flip correction or @xmath179 for bit - flip correction .",
    "below we shall only consider decoders that return any corrupted state to the logical subspace @xmath134 .",
    "equivalently , the recovery chain and the error chain must have the same syndrome : @xmath180 .",
    "this condition guarantees that @xmath181 commutes with all stabilizers and thus @xmath182 for any @xmath169 .",
    "error correction is successful if the restriction of @xmath181 onto @xmath134 is the identity operator .",
    "otherwise , error correction results in a logical error .",
    "below we only consider encodings of a single logical qubit with logical pauli operators @xmath183 , @xmath184 . here",
    "@xmath185 is a closed loop on the primal lattice @xmath113 encircling the ( left - most ) defect and @xmath186 is a path on the lattice dual to @xmath113 connecting the defect with the external boundary ( for the double - defect geometry @xmath186 connects the two defects with each other ) .",
    "one can easily check that @xmath28 , @xmath27 commute with all stabilizers and anti - commute with each other .",
    "the decoding graph will be equipped with a _ logical chain _",
    "@xmath187 such that @xmath188 for phase - flip errors and @xmath189 for bit - flip errors .",
    "error correction is successful iff @xmath181 commutes with the logical operators @xmath28 , @xmath27 .",
    "equivalently , @xmath190 must have even overlap with @xmath160 .",
    "the decoding graphs used to generated the data shown on fig .",
    "[ fig : flat2345 ] for @xmath159 and the corresponding logical chains @xmath160 are shown on fig .",
    "[ fig : decoding ] .",
    "here we discuss algorithms for choosing a recovery chain .",
    "this material is mostly based on ref .",
    "@xcite .",
    "let @xmath139 be the decoding graph defined above .",
    "we assume that every edge @xmath191 has some specified error rate @xmath192",
    ". we shall only consider noise models such that errors on different edges of @xmath146 are independent .",
    "an error chain @xmath140 then appears with a probability @xmath193 introduce edge weights @xmath194 such that @xmath195}=\\frac{p(e)}{1-p(e)}.\\ ] ] then @xmath196}$ ] , where @xmath197 and @xmath53 is a constant coefficient independent of @xmath143",
    ". we shall refer to @xmath198 as a _ weight _ of @xmath143 .",
    "following refs .",
    "@xcite we shall choose a recovery chain @xmath199 as the most likely error chain consistent with the observed syndrome @xmath200 .",
    "equivalently , a candidate recovery chain @xmath199 must obey @xmath201 and @xmath202 for any chain @xmath203 satisfying @xmath204 . thus decoding amounts to solving one of the following problems .    given a graph @xmath139 with non - negative edge weights @xmath205 and a subset of vertices @xmath206 .",
    "find a minimum weight chain @xmath140 satisfying @xmath207 .",
    "given a graph @xmath139 with non - negative edge weights @xmath205 and disjoint sets @xmath208 .",
    "find a minimum weight chain @xmath140 satisfying @xmath209 .    in combinatorial optimization , problem  1 is known under the name minimum weight @xmath210-join ( in our case @xmath211 ) , see ref .",
    "it can be solved in time @xmath212 for any graph @xmath146 and any real edge weights by a reduction to the minimum weight perfect matching problem and solving the latter using edmonds s blossom algorithm  @xcite or its subsequent improvements , see ref",
    ".  @xcite .",
    "our implementation of the decoder utilized the blossom  v library due to kolmogorov  @xcite .",
    "let us now show that problem  2 is equivalent to the maximum weight matching problem .",
    "indeed , for any pair of vertices @xmath213 let @xmath214 be the weighted distance between @xmath128 and @xmath164 , that is , the minimum weight of a path in @xmath146 that connects @xmath128 and @xmath164 .",
    "likewise , let @xmath215 be the weighted distance between @xmath128 and the subset @xmath210 .",
    "one can easily check that any minimum weight chain @xmath140 satisfying @xmath209 consists of disjoint minimum weight paths that connect pairs of vertices in @xmath200 and , possibly , minimum weight paths that connect a vertex in @xmath200 with a vertex in @xmath210 . hence problem  2 is equivalent to finding a ( non - perfect ) matching @xmath216 of vertices in the complete graph @xmath217 with edge weights @xmath214 that minimizes the objective function @xmath218 here the first sum runs over all pairs of vertces @xmath219 which are matched to each other in @xmath216 , while the second sum runs over unmatched vertices @xmath220 . to minimize @xmath221 define modified edge weights @xmath222 the objective function @xmath221 can now be rewritten as @xmath223 where @xmath224 is a constant that does not depend on the choice of @xmath216 .",
    "thus problem  2 is reduced to finding a maximum weight matching @xmath216 in the complete graph @xmath217 with edge weights @xmath225 .",
    "a maximum weight matching can be found in time @xmath226 using a slightly different version of edmonds s blossom algorithm  @xcite .",
    "our implementation of the decoder was based on the library lemon  @xcite which realizes a maximum weight matching algorithm due to gabov  @xcite .",
    "it is worth pointing out that the optimal matching @xmath216 can be always chosen such that pairs of vertices with @xmath227 are unmatched .",
    "such negative - weight edges can be safely removed from the graph before calling the matching algorithm .",
    "although the reduction outlined above is elementary , to the best of our knowledge it has not been used before in the context of error correction .",
    "in this section we define correctable and uncorrectable error chains and prove some technical lemmas needed for the analysis of the splitting method .",
    "let @xmath228 and @xmath229 be the sets of minimum weight chains @xmath143 satisfying @xmath207 and @xmath209 respectively , see problems  1,2 . clearly , @xmath230 .",
    "below we consider _ minimum weight decoders _",
    "( mwd ) , that is , algorithms choosing a recovery chain @xmath199 from the set @xmath229 according to some specified rule . define the parity @xmath231 of an error chain @xmath140 as @xmath232 where @xmath233 is the logical chain on the decoding graph .",
    "we will say that @xmath143 is odd ( even ) if @xmath234 ( @xmath235 ) .",
    "recall that error correction is successful if the chosen recovery chain has the same syndrome and the same parity as the actual error chain , see section  [ sec : ec ] .",
    "let @xmath140 be some fixed error chain .",
    "deciding whether a mwd corrects @xmath143 is straightforward when all chains in @xmath229 have the same parity . indeed , in this case the correctability condition @xmath236 is satisfied or not satisfied simultaneously for all @xmath237 .    in general",
    ", however , the set @xmath229 may contain both even and odd chains , see fig .",
    "[ fig : nasty ] for a simple example . in this case",
    "we will say that @xmath200 is a _ degenerate _ syndrome .",
    "deciding whether an error chain with a degenerate syndrome is corrected by a given mwd requires a detailed knowledge of the rule used for choosing a recovery chain .",
    "as was pointed out by stace and barrett  @xcite , some decoding rules can reduce the logical error probability by breaking ties in favor of chains having the largest entropy , see fig .",
    "[ fig : nasty ] .",
    "this demonstrates that the logical error probability @xmath0 is not well - defined unless the decoder s behavior for all degenerate syndromes is specified .",
    "_ example of a degenerate syndrome .",
    "_ one can easily check that any error chain @xmath143 satisfying @xmath238 has length at least @xmath239 .",
    "there is a unique even length-@xmath239 chain composed of paths @xmath240 and @xmath241 .",
    "there are @xmath242 odd length-@xmath239 chains composed of paths @xmath243 and @xmath244 .",
    "if the actual error chain has minimum length ( which is true in the limit of small error rates ) , a decoding rule that favors the pairing @xmath245 is @xmath246 times more likely to correct the error . ]    to address this difficulty we opted to work with two different notions of correctability  decoder - specific and decoder - independent . for the purposes of numerical simulations , an error chain @xmath143",
    "is called correctable iff a recovery chain @xmath199 chosen by our implementation of the decoder satisfies @xmath236 .",
    "otherwise , @xmath143 is called uncorrectable . accordingly , the logical error probability @xmath0 computed in our simulations applies only to the one specific mwd implemented as described in section  [ sec : ec ] . from a practical perspective , this is a natural approach , since an experimental realization of error correction must be based upon some specific decoder . furthermore , we expect that @xmath0 does not vary too much for different mwds because degenerate syndromes are relatively rare .",
    "the decoder - specific notion of correctability was implicitly used in most of the previous work on the subject .    from the theoretical perspective , it is more natural to work with a decoder - independent notion of correctability .",
    "the definition given below is used in the rest of this section where we make first steps towards a rigorous justification of the splitting method .",
    "let @xmath140 be an error chain with a syndrome @xmath247 .",
    "we say that @xmath143 is correctable iff @xmath248 for all @xmath237 .",
    "otherwise , @xmath143 is called uncorrectable .",
    "according to this definition , an error chain is correctable iff _ any _ mwd corrects it .",
    "note that this requirement is much stronger than the decoder - specific correctability discussed above .",
    "below we prove that the strong version of correctability can be tested efficiently in certain special cases .",
    "the following lemmas are applicable to the decoding graphs used in our simulations for noiseless syndrome readout , see fig .",
    "[ fig : decoding ] .",
    "let us first assume that @xmath158 .",
    "[ lemma:1 ] suppose the decoding graph @xmath146 is planar with the maximum vertex degree @xmath249 .",
    "suppose that the logical chain @xmath160 is a path on the dual graph",
    ". then correctability can be tested in time @xmath212 .",
    "let @xmath143 be any error chain and @xmath250 be its syndrome .",
    "choose any recovery chain @xmath251 .",
    "it can be constructed in time @xmath212 , see section  [ sec : ec ] .",
    "if @xmath252 has odd parity then @xmath143 is uncorrectable and we are done .",
    "below we assume that @xmath252 has even parity .",
    "then @xmath143 is correctable iff all chains in @xmath228 have the same parity .    a chain @xmath253 is called a cycle iff @xmath254 .",
    "let @xmath255 be the set of all cycles with odd parity .",
    "define a quantity @xmath256 the minimality of @xmath257 implies that @xmath258 .",
    "we claim that @xmath143 is uncorrectable iff @xmath259 . indeed , suppose @xmath143 is uncorrectable .",
    "then there must exist a chain @xmath260 such that @xmath257 and @xmath199 have different parity . therefore @xmath261 is an odd cycle and @xmath262 , that is , @xmath259 .",
    "conversely , assume that @xmath259",
    ". then @xmath263 for some odd cycle @xmath103 and thus @xmath264 has parity different from @xmath257 .",
    "therefore @xmath143 is uncorrectable .",
    "thus , it suffices to show that the quantity @xmath265 can be computed in time @xmath212 .",
    "define new weights @xmath266 then @xmath265 coincides with the minimum @xmath267-weight of an odd cycle , @xmath268 .",
    "let us show that @xmath265 can be expressed as the ground state energy of the ising model defined on a genus-@xmath154 graph ( i.e. a graph embeddable into a torus ) .",
    "this ground state energy can be computed in time @xmath212 using algorithms of refs .",
    "indeed , since @xmath146 is planar , it has a well - defined set of faces @xmath269 such that every edge @xmath191 has exactly two adjacent faces @xmath270 .",
    "we will write @xmath271 . for each face",
    "@xmath272 introduce ising spin @xmath273 . given a spin configuration @xmath274 ,",
    "define a chain @xmath275 such that @xmath276 includes all edges @xmath271 with @xmath277 .",
    "the standard relationship between cycles in a planar graph and cuts in the dual graph implies that @xmath276 is a cycle for any choice of @xmath278 and that any cycle @xmath253 has form @xmath276 for some spin configuration @xmath278 .    by assumption",
    ", @xmath160 is a path on the dual graph connecting some pair of faces @xmath279 .",
    "simple algebra shows that a cycle @xmath276 has odd parity iff @xmath280 .",
    "we conclude that @xmath281 , where @xmath282 is the ising - like hamiltonian on the dual graph defined as @xmath283 here @xmath284 is chosen large enough to guarantee that @xmath280 for any ground state @xmath278 . to make the interaction @xmath285 compatible with the graph structure , the edge @xmath286",
    "must be added to the dual graph @xmath287 .",
    "although the resulting graph is not planar , it is embeddable into a torus .",
    "indeed , one can first embed the primal graph @xmath146 into a sphere , create a pair of holes in the faces @xmath288 , @xmath289 , connect the two holes by a tube , and finally draw the edge @xmath286 on the tube s surface .",
    "the algorithms of refs .",
    "@xcite enable exact computation of the partition function @xmath290}$ ] in time @xmath212 for any value of the inverse temperature @xmath8 assuming that the graph of spin - spin interactions has constant genus ( see , for instance , theorem  1 of ref .",
    "the two cases @xmath259 and @xmath291 correspond to @xmath292 or @xmath293 which can be distinguished by computing @xmath294 for large enough @xmath8 .",
    "suppose now that @xmath210 is non - empty .",
    "recall that a subset of edges @xmath253 is called a _ cut _ iff one can partition vertices of the graph into two disjoint sets , @xmath295 , such that @xmath103 coincides with the set of edges connecting @xmath296 and @xmath297 .",
    "suppose the decoding graph @xmath146 is arbitrary and the logical chain @xmath160 is a cut of @xmath146 .",
    "then correctability can be tested in time @xmath212 .",
    "let @xmath143 be any error chain and @xmath298 be its syndrome .",
    "choose any recovery chain @xmath299 .",
    "it can be constructed in time @xmath212 , see section  [ sec : ec ] . if @xmath252 has odd parity then @xmath143 is uncorrectable and we are done .",
    "below we assume that @xmath252 has even parity .",
    "then @xmath143 is correctable iff all chains in @xmath229 have the same parity .    without loss of generality ,",
    "no edge @xmath124 having both end - points in @xmath210 belongs to @xmath160 .",
    "indeed , such an edge @xmath124 does not participate in the constraint @xmath201 .",
    "if @xmath124 has positive weight @xmath205 , no chain in @xmath229 contains @xmath124 and we can safely remove @xmath124 from @xmath160 without changing the parity of any @xmath300 . if @xmath124 has zero weight , @xmath229 contains both odd and even chains and the error is uncorrectable .    by assumption , @xmath295 , @xmath301 , and @xmath160 is the set of edges connecting @xmath296 and @xmath297 .",
    "below we shall often use the obvious fact that for any chain @xmath176 the overlap @xmath302 is even ( odd ) iff @xmath303 is even ( odd ) .",
    "consider two cases .",
    "+ _ case  1 : _ @xmath304 .",
    "then all chains @xmath143 satisfying @xmath209 are either even or odd depending on whether @xmath305 is even or odd .",
    "hence @xmath143 is correctable .",
    "+ _ case  2 : _ @xmath306 .",
    "define a new graph @xmath307 obtained from @xmath146 by collapsing all vertices of @xmath308 into a single vertex @xmath309 .",
    "more precisely , we replace every edge @xmath163 with @xmath310 , @xmath311 by an edge @xmath312 without changing its weight",
    ". we can regard @xmath160 as a subset of edges of @xmath313 .",
    "define @xmath314 , @xmath315 , and @xmath316 .",
    "let @xmath317 and @xmath318 be minimum weights of chains @xmath319 satisfying @xmath320 and @xmath321 respectively .",
    "note that @xmath317 and @xmath318 can be computed in time @xmath212 , see section  [ sec : ec ] .",
    "furthermore , any chain @xmath322 as above has even ( odd ) parity iff @xmath323 is even ( odd ) . on the other hand , any chain @xmath324 as above has even ( odd ) parity iff @xmath325 is odd ( even ) .",
    "hence @xmath326 iff @xmath229 contains two chains with a different parity .",
    "we conclude that @xmath143 is uncorrectable iff @xmath326 .",
    "our implementation of the splitting method involves a metropolis - type subroutine for sampling uncorrectable error chains from the chosen probability distribution .",
    "the following two lemmas are needed to prove that the corresponding markov process is ergodic .",
    "let us first assume that @xmath158 .",
    "suppose the decoding graph @xmath146 a square lattice with one smooth defect and @xmath160 is a path on the dual lattice that connects the defect to the external boundary , see fig .",
    "[ fig : decoding ] .",
    "let @xmath327 be any uncorrectable chains",
    ". then one can transform @xmath143 to @xmath328 by adding and removing single edges such that all intermediate chains are uncorrectable .",
    "let @xmath74 be the set of all edges lying on the boundary of the defect . since @xmath74 has trivial syndrome , @xmath329 , and odd parity , @xmath74 is uncorrectable by definition  1 .",
    "it suffices to prove the lemma for the special case @xmath330 .",
    "we will need the following simple observation .",
    "let @xmath206 be a subset of vertices and @xmath260 be any chain .",
    "choose any edge @xmath331 and define @xmath332 .",
    "then @xmath333 .",
    "obviously , @xmath334 .",
    "thus , @xmath335 and @xmath336 .",
    "suppose @xmath337 is not in @xmath338 .",
    "then there exists @xmath322 such that @xmath339 and @xmath340 .",
    ". then @xmath342 and @xmath343 which contradicts the minimality of @xmath199 .",
    "thus @xmath333 .",
    "let @xmath250 be the syndrome of @xmath143 .",
    "since @xmath143 is uncorrectable , there must exist a recovery chain @xmath260 such that @xmath344 is a disjoint union of loops and the number of odd loops among @xmath345 is odd .",
    "choose any edge @xmath346 and define @xmath347 , @xmath348 .",
    "the proposition above implies that @xmath349 , that is , @xmath350 is a minimum weight recovery chain for @xmath351 .",
    "furthermore , since @xmath352 , the new error chain @xmath351 is uncorrectable . by repeating this argument one can construct a sequence of uncorrectable error chains @xmath353 such that @xmath354 is obtained from @xmath355 by adding ( modulo two ) any edge from the recovery chain @xmath356 corresponding to @xmath355 .",
    "this process stops as soon as the recovery chain corresponding to @xmath357 is empty . at this step",
    "@xmath358 is a disjoint union of loops .",
    "we shall deal with the loops @xmath359 one by one such that each even loop is transformed into an empty chain ( contracted ) while each odd loop is transformed into @xmath74 .",
    "these transformations can be implemented such that at every step a loop is modified by adding ( modulo two ) a boundary of some plaquette which requires adding or removing at most three edges . at each step",
    "the syndrome consists of at most two vertices and the recovery chain consists either of a single edge or a pair of adjacent edges lying on the boundary of some plaquette .",
    "since the number of odd loops is odd , the final error chain coincides with @xmath74 .",
    "suppose now that @xmath360 .",
    "suppose the decoding graph @xmath146 is a square lattice with two rough defects and @xmath160 is a loop on the dual lattice encircling one of the defects , see fig .",
    "[ fig : decoding ] .",
    "let @xmath327 be any uncorrectable chains",
    ". then one can transform @xmath143 to @xmath328 by adding and removing single edges such that all intermediate chains are uncorrectable .    as explained in the proof of lemma  2",
    ", one can collapse all vertices @xmath361 on the boundary of each defect into a single vertex .",
    "thus we can assume that @xmath362 .",
    "let @xmath74 be a path connecting @xmath363 and @xmath364 . clearly , @xmath74 is uncorrectable .",
    "it suffices to prove the lemma for the case @xmath330 . repeating the same steps as in the proof of lemma  3 one can transform @xmath143 to a disjoint union of loops and paths connecting @xmath363 and @xmath364 , such that the number of paths is odd . applying a sequence of plaquette transformations as in the proof of lemma  3",
    "one can contract each loop and transform each path into @xmath74 .",
    "here we specialize the splitting method described in section  [ sec : split ] to the minimum weight decoding problem .",
    "let @xmath139 be the decoding graph corresponding to logical loop - like or path - like errors , see section  [ sec : ec ] . for simplicity we shall first discuss the case when all edges have the same error probability , @xmath365 , where @xmath366 is the total number of edges .",
    "we define an event as an arbitrary error chain @xmath140 .",
    "accordingly , @xmath74 coincides with the set of all subsets of @xmath367 . the subset of failure events @xmath75 consists of all uncorrectable chains such that @xmath84 is the probability of a logical loop - like or path - like error .",
    "we shall first focus on the decoder - specific definition of correctability , see section  [ sec : corr ] . testing a membership",
    "@xmath89 thus requires solving problem  1 or  2 .",
    "we choose the family of distributions @xmath86 as @xmath368 for a monotonic sequence of error rates @xmath17 with @xmath369 .",
    "the following heuristic choice of the splitting sequence was found to provide a reasonable tradeoff between the statistical error and the number of splitting steps : @xmath370 here @xmath5 is the code distance and the two signs correspond to upward and downward splitting . to motivate this choice",
    "we note that the quantity @xmath371 provides a rough estimate of the average number of edges in a random chain @xmath89 drawn from the distribution @xmath91 .",
    "since errors on different edges are independent and @xmath372 , one should expect that the random variable @xmath373 is concentrated near its mean with the standard deviation @xmath374 .",
    "therefore one can use a bound @xmath375 for all ` typical ' error chains @xmath143 . here ,",
    "for concreteness , we consider upward splitting , that is , @xmath376 .",
    "then eq .",
    "( [ steps1 ] ) implies @xmath377 for some constant @xmath378 .",
    "thus @xmath379 and the ratio @xmath85 is estimated with an error @xmath380 , see eq .",
    "( [ sm9 ] ) .    in order to sample a chain @xmath89 from the conditional distribution @xmath381 we used a metropolis - type subroutine .",
    "a single metropolis step takes as input a chain @xmath89 and outputs a new chain @xmath382 which differs from @xmath143 on at most one edge as described below .    1 .",
    "select an edge @xmath191 at random from the uniform distribution .",
    "set @xmath383 .",
    "2 .   compute @xmath384}$ ] and generate a random bit @xmath385 such that @xmath386 .",
    "3 .   if @xmath387 then stop and output @xmath143 .",
    "4 .   if @xmath388 and @xmath382 then output @xmath328 . otherwise output @xmath143 .    for",
    "any chains @xmath389 let @xmath390 be the probability that the metropolis step outputs @xmath328 if called on the input @xmath143 .",
    "one can easily check that @xmath138 obeys a detailed balance condition @xmath391 thus the metropolis step defines a reversible markov process @xmath392 such that states of @xmath392 are uncorrectable error chains , @xmath390 is the transition probability from @xmath143 to @xmath328 , and @xmath393 is a steady distribution of @xmath392 .",
    "a similar markov process @xmath88 is constructed for each distribution @xmath394 in the splitting sequence .",
    "the full metropolis subroutines involves @xmath395 metropolis steps starting from some fixed initial uncorrectable chain @xmath396 .",
    "the latter was chosen as a loop encircling a defect ( for loop - like errors ) or a path connecting the two defects ( for path - like errors ) .",
    "the sequence of uncorrectable error chains @xmath397 generated by the metropolis subroutine was used to estimate the expectations values in eq .",
    "( [ sm5 ] ) . in order for eq .",
    "( [ sm5 ] ) to hold , the number of metropolis steps must satisfy @xmath398 , where @xmath399 is the mixing time of the markov process @xmath88 . since in practice the mixing time is unknown , the number of steps @xmath216 was chosen by checking two heuristic conditions : ( i ) statistical fluctuations of the righthand side of eq .",
    "( [ sm5 ] ) are smaller than the desired precision , ( ii ) doubling @xmath216 does not change the righthand side of eq .",
    "( [ sm5 ] ) by more than the desired precision .",
    "our goal was to compute the logical error probability @xmath84 with a relative error about @xmath400 .",
    "note that @xmath84 changes by almost @xmath401 orders of magnitude in our simulations .",
    "a relative error @xmath400 is thus good enough for all practical purposes .",
    "accordingly , we aimed at estimating the expectation values in eq .",
    "( [ sm5 ] ) with a relative error around @xmath402 , where @xmath403 is the number of splitting steps .",
    "the required number of metropolis flips ( non - trivial steps ) varied in the range @xmath404 to @xmath405 depending on the geometry , lattice dimensions , and the error rate .",
    "note that some metropolis steps may require testing a membership @xmath382 , which in turn requires solution of problem  1 or problem  2 , see section  [ sec : ec ] .",
    "as the full metropolis subroutine may involve millions of steps , a natural question is whether the solution of problems  1,2 obtained at some metropolis step @xmath406 can be ` recycled ' and used at the next step @xmath407 .",
    "suppose the corresponding error chains differ on some edge @xmath124 , @xmath408 . to perform the standard reduction from problems  1,2 to the minimum ( maximum ) weight matching problem one has to construct a family of minimum weight paths on the decoding graph connecting any pair of syndrome vertices , see section  [ sec : ec ] .",
    "our implementation of the metropolis subroutine recycles minimum weight paths found for the syndrome @xmath409 and uses them to construct minimum weight paths for the syndrome @xmath410 .",
    "this yields a significant speedup since the syndromes @xmath411 and @xmath412 differ on at most two vertices .    in the case of loop - like logical errors simulations",
    "were performed only for the single - defect geometry .",
    "this is a natural simplification since the decay rate @xmath7 for loop - like errors does not depend on the number of defects , as long as separation between defects is sufficiently large . in the case of path - like logical errors simulations were performed for the double - defect geometry .",
    "the corresponding decoding graphs are shown on fig .",
    "[ fig : decoding ] .    the splitting method can be similarly applied to the minimum weight decoding problem with a decoder - independent notion of correctability , see section  [ sec : ec ] .",
    "in particular , for the decoding graphs shown on fig .  [",
    "fig : decoding ] the metropolis step can be implemented in time @xmath212 and the corresponding markov process @xmath392 is ergodic , see lemmas  1 - 4 .",
    "therefore , in these special cases the conditional distribution @xmath393 is the unique steady state of @xmath392 and our results rigorously prove correctness of the splitting method in the limit @xmath413 .",
    "here we describe the construction of the decoding graph and the implementation of the splitting method in the case when the syndrome readout circuit itself may introduce errors .",
    "the material of this section is mostly based on refs .",
    "@xcite .",
    "we begin by defining the noise model and the syndrome readout circuit .",
    "our set of elementary operations includes cnot gates , single - qubit measurements in the @xmath25- or @xmath26-basis , and preparation of single - qubit ancillary states @xmath414 and @xmath415 .",
    "the syndrome readout circuit consists of a sequence of rounds , where at each round any qubit can participate in one elementary operation or remain idle .",
    "each elementary operation can fail with a probability @xmath2 that we call an _ error rate_. more precisely , our error model , borrowed from  @xcite , is defined as follows .    *",
    "a noisy @xmath25 or @xmath26 measurement is the ideal measurement in which the outcome is flipped with probability @xmath2 . *",
    "a noisy @xmath414 or @xmath415 ancilla preparation returns the correct state with probability @xmath416 and the orthogonal state @xmath417 or @xmath418 with probability @xmath2 . *",
    "a noisy cnot gate is the ideal cnot gate followed by one of @xmath419 two - qubit pauli operators @xmath138 .",
    "we apply @xmath420 with probability @xmath416 and each individual @xmath421 with probability @xmath422 . *",
    "if a qubit remains idle during some round , it is acted upon by @xmath25 , @xmath423 or @xmath26 error with probability @xmath424 each ( `` memory error '' ) .    , height=264 ]    following refs  @xcite , we measure eigenvalues of site and plaquette stabilizers using the quantum circuit shown in fig .  [",
    "fig : readout ] . measuring a single stabilizer",
    "requires one ancillary qubit and six rounds . in the case of truncated stabilizers located near the boundary of defects , some cnot gates in the circuit of fig .",
    "[ fig : readout ] are skipped and the corresponding ancillary qubits remain idle .",
    "the ancillary qubits are located at the centers of plaquettes and at sites of the physical lattice .",
    "the syndrome readout is repeated periodically in time until enough syndrome data is collected to enable reliable error correction , see below .",
    "we assume that the rounds are scheduled such that a new set of syndrome data from every stabilizer arrives at each integer time step @xmath403 ( accordingly , each round takes @xmath425 units of time ) . for simplicity , we assume that defects are not added , changed , or annihilated during the collection of syndrome data ; that is , we are only examining storage of information in time .",
    "the error correction protocol is tailored to the chosen noise model and the syndrome readout circuit  @xcite .",
    "as before , the key ingredient in the protocol is a decoding graph @xmath139 and we again need two independent decoding graphs for dealing with phase - flip and bit - flip errors separately . for concreteness ,",
    "below we focus on bit - flip errors .",
    "the vertices of @xmath146 can be partitioned into two disjoint subsets , @xmath426 .",
    "each vertex in @xmath427 is a pair @xmath428 that represents the space - time location of a syndrome bit measured at time step @xmath403 at a plaquette @xmath2 .",
    "let @xmath206 be the set of all vertices @xmath429 such that the syndrome bits measured at the plaquette @xmath2 at time steps @xmath403 and @xmath430 are different .",
    "we shall refer to @xmath200 as a _ relative syndrome_. clearly , @xmath431 in the absence of errors .",
    "suppose now that the syndrome readout circuit contains a single _ error event _ , that is , any non - identity pauli operator applied as an error in any single elementary operation or idle step .",
    "it can be shown that a relative syndrome caused by any single error event in the circuit consists of at most two vertices , see  @xcite .",
    "we connect a pair of vertices @xmath432 by an edge iff the relative syndrome @xmath433 can be created by a single error event .",
    "some error events located near the boundary of a defect create a relative syndrome at a single vertex @xmath128 .",
    "such an error event is represented on the decoding graph by a  hanging edge \" attached to @xmath128 .",
    "each vertex @xmath434 is attached to at most one hanging edge ; the other endpoint of this hanging edge has degree one and is an element of @xmath435 .",
    "the set @xmath210 solely consists of the hanging edge endpoints that are not in @xmath436 . the decoding graph corresponding to the surface code lattice of fig .",
    "[ fig : flat ] for bit - flip errors is shown on fig .  [ fig:3d ] .",
    "to avoid clutter , we represent a hanging edge attached to some vertex @xmath434 by a solid circle centered at @xmath128 .",
    "a typical vertex of the decoding graph has @xmath239 incident edges , see fig .",
    "[ fig:3dzoom ] for detail .",
    "generally , memory errors are represented by edges oriented along the @xmath437 or @xmath438 axes , while measurement and initialization errors lead to edges oriented along the @xmath403 axis .",
    "any type of edge can be observed due to the two - qubit errors ( which occur after each of the rounds of cnot gates ) , and many of the diagonal edges can only be observed in this way .",
    "two edges of the same orientation may be created by different errors depending on their proximity to defects .",
    "the decoding graph describing phase - flip errors is constructed in a similar fashion ( hanging edges on the phase - flip decoding graph are not needed for the defects examined here ) .    by construction ,",
    "every edge @xmath124 of the decoding graph represents some set of error events @xmath439 in the syndrome readout circuit ( those that create relative syndromes at the endpoints of @xmath124 ) .",
    "the sets @xmath439 corresponding to different edges are disjoint .",
    "prior _ @xmath440 as the probability of observing an _ odd _ number of error events in @xmath439 upon execution of the circuit ( since errors add up modulo two , only the parity of the number of errors matters ) . as argued in  @xcite , knowledge of the priors significantly improves decoding success probability .",
    "edges of the decoding graph with large prior probabilities can be regarded as more noisy and should be preferred over less - noisy edges when choosing a recovery chain .",
    "the time - like edges and the diagonal edges are the most and the least noisy respectively .",
    "we estimated the priors @xmath440 by summing up the probabilities of all error events in the set @xmath439 .",
    "the priors are represented by a color scale on fig .",
    ".    any combination of error events in the circuit can be represented by an error chain @xmath140 in the decoding graph such that @xmath441 iff the set @xmath439 contains an odd number of the error events that occurred when the circuit was run . given an edge @xmath191 ,",
    "let @xmath442 be the ` projection ' of @xmath124 onto the 2d surface code lattice .",
    "more precisely , if @xmath443 for some vertices @xmath428 and @xmath444 then @xmath445 consists of the edges making up a minimum weight path between @xmath2 and @xmath446 for @xmath447 and @xmath448 otherwise . note that when @xmath449 , @xmath445 contains one edge except in some of the cases where @xmath124 is a diagonal edge .",
    "given any chain @xmath450 on the decoding graph , the corresponding accumulated 2d error chain on the surface code qubits is @xmath451 our goal is to use the syndrome information to correct the error chain @xmath452 . by construction , @xmath453 , where @xmath454 is the relative syndrome and @xmath455 is defined above .",
    "thus finding the most likely error chain consistent with a given relative syndrome @xmath200 is equivalent to solving problem  1 or  2 , see section  [ sec : ec ] .",
    "let @xmath237 be a minimum weight recovery chain constructed by the decoder .",
    "the recovery operator corresponding to @xmath199 is determined by the 2d projection @xmath456 .",
    "an error chain @xmath143 is called correctable iff @xmath457 has even overlap with the relevant logical chain @xmath160 , see section  [ sec : corr ] .",
    "equivalently , @xmath143 is correctable iff @xmath190 has even overlap with a 3d logical chain @xmath458 that includes all edges @xmath191 such that @xmath459 is not empty . in the case of bit - flip errors",
    ", @xmath460 is the set of all hanging edges located on the boundary of the left defect tube , see fig .",
    "[ fig:3d ] . for phase - flip errors ,",
    "@xmath460 can be visualized as a ` membrane ' connecting the defect tube to the external spatial boundary of the lattice ( not shown ) .",
    "let @xmath74 be the set of all error chains and @xmath75 be the set of uncorrectable chains .",
    "apart from the different definition and interpretation of the decoding graph , the implementation of the splitting method is exactly the same as described in section  [ sec : implement ] .",
    "our simulations were performed for a phenomenological noise model where errors on different edges of the decoding graph occur independently with probabilities @xmath440 . in order to evaluate the quantity @xmath16 for a given probability @xmath2",
    ", we used a family of distributions @xmath86 defined as @xmath461 where @xmath462 are the priors computed for a monotone decreasing sequence of error rates @xmath17 such that @xmath369 . the sequence @xmath17 is defined by the heuristic rule eq .",
    "( [ steps1 ] ) , where @xmath463 .",
    "simulations were performed only for defects with linear size @xmath464 , partly due to the growing running time of the metropolis subroutine and partly due to computer memory limitations ( for the double defect geometry with @xmath465 the lookup table of minimum weight paths on the decoding graph takes about 4 gb of ram ) . for path - like logical errors the decoding graph shown in fig .",
    "[ fig:3d ] is a 3d lattice with a pair of vertical defect tubes .",
    "the decoding graph corresponding to loop - like logical errors is similar to fig .",
    "[ fig:3d ] , but there is only one vertical defect tube . by combining the splitting method and the monte carlo data we were able to compute parameters of the fitting formula eqs .",
    "( [ fit],[xy ] ) which we expect to be valid for larger code distances .",
    "the decay rate @xmath4 in the exponential scaling @xmath466}$ ] is shown in fig .",
    "[ fig : alpha ] .",
    "we proposed a new algorithm for estimating the logical error probability of the surface code in the regime of large code distances and moderately small error rates .",
    "numerical results are presented for two commonly studied error models corresponding to noiseless and noisy syndrome extraction .",
    "our results demonstrate that the asymptotic formulas for the logical error probability @xmath16 valid in the limit @xmath12 tend to underestimate @xmath16 for finite error rates .",
    "a more accurate fitting formula for @xmath16 is proposed .",
    "our work certainly leaves many important questions unanswered .",
    "first , one may ask whether our simulation techniques can be extended to non - trivial logical gates , such as the cnot gate , or more complicated logical circuits such as the topological state distillation  @xcite .",
    "each of these circuits can be visualized as a network of defect tubes embedded into a 3d space - time  @xcite .",
    "we anticipate that the logical error probability @xmath0 associated with a large network of tubes can be estimated by decomposing the network into small tiles that consist of single isolated tube segments or parallel pairs of such segments .",
    "the techniques presented in this paper are applicable to each individual tile .",
    "therefore one can get a rough estimate of @xmath0 by summing up logical error probabilities associated with each tile .    from the theoretical perspective",
    ", it is desirable to derive rigorous bounds on the running time and the approximation error of the algorithm .",
    "this , in turn , requires upper bounds on the mixing time of the metropolis subroutine described in section  [ sec : implement ] .",
    "we conjecture that the mixing time scales as @xmath467 for a general distance-@xmath5 surface code with multiple defects in the limit @xmath12 .",
    "the intuition behind this conjecture is that minimum - weight uncorrectable error chains that are localized on the boundary of different defects can not be connected by a sequence of local metropolis steps without passing through intermediate high - weight uncorrectable error chains .",
    "however , if the lattice contains a single defect ( in the case of loop - like errors ) or a pair of defects ( in the case of path - like errors ) , see fig .",
    "[ fig : decoding ] , it is plausible that the mixing time is a sub - exponential function of @xmath5 .",
    "one can also explore possible generalizations of our algorithm to different noise models , such as the true circuit - based noise model , see ref .",
    "@xcite , and different stabilizer codes .",
    "finally , we expect that our fitting formula for the logical error probability can be refined by taking into account the pre - exponential factor depending on @xmath5 as was proposed in ref .",
    "@xcite .",
    "we would like to thank charles bennett , martin suchara , and rajan vadakkedathu for helpful discussions .",
    "this work was supported in part by iarpa qcs program under contract number d11pc20167 and by the darpa quest program under contract number hr0011 - 09-c-0047 .",
    "computational resources for this work were provided by ibm blue gene watson supercomputer center ."
  ],
  "abstract_text": [
    "<S> we consider the problem of calculating the logical error probability for a stabilizer quantum code subject to random pauli errors . to access the regime of large code distances where logical errors are extremely unlikely we adopt the splitting method widely used in monte carlo simulations of rare events and bennett s acceptance ratio method for estimating the free energy difference between two canonical ensembles . </S>",
    "<S> to illustrate the power of these methods in the context of error correction , we calculate the logical error probability @xmath0 for the 2d surface code on a square lattice with a pair of holes for all code distances @xmath1 and all error rates @xmath2 below the fault - tolerance threshold . </S>",
    "<S> our numerical results confirm the expected exponential decay @xmath3}$ ] and provide a simple fitting formula for the decay rate @xmath4 . </S>",
    "<S> both noiseless and noisy syndrome readout circuits are considered . </S>"
  ]
}