{
  "article_text": [
    "the solar magnetic field is an important quantity which couples the solar interior with the photosphere and atmosphere .",
    "knowledge regarding the coronal magnetic field plays a key role for eruptive phenomena , e.g. coronal mass ejection , flares and eruptive prominences .",
    "unfortunately a direct measurement of the coronal magnetic field is extremely difficult . in principle",
    "one can use the polarization of emissions from magnetic sensitive coronal line transitions to draw conclusions about the coronal magnetic field .",
    "these lines , however , are very faint so that in the past they have only occasionally been observed ( e.g. , @xcite ) . in a recent study @xcite conclude that several forbidden lines ( e.g. in fe xiii , he i , mg viii and si ix ) may be used to determine the coronal magnetic field .",
    "they further concluded that space born missions are not needed for such kind of coronal magnetometers but a high , dry mountain site . in their study",
    "they propose a focal plane instrument devoted to the @xmath0 region .",
    "these authors also point out that besides the observational part , a further major problem is the interpretation of the data . the line - of - sight integration inherent in these observations make the data analysis a badly posed inversion problem .",
    "presently , algorithms based on vector tomography are studied to find out to which extend the coronal magnetic field can be reconstructed from these observations ( maxim kramar and bernd inhester , private communication ) .    despite these promising new developments regarding the principle possibility of coronal b - field measurements we have to face the fact that currently and probably also in near future high quality direct measurements of the coronal magnetic field are not available . as an alternative to the above measurements",
    ", a number of authors have modelled the coronal magnetic field by extrapolation from more sound photospheric magnetic field observations .",
    "it is generally assumed that the magnetic pressure in the corona is much higher than the plasma pressure ( small plasma @xmath1 ) and that therefore the magnetic field is nearly force - free ( for a critical view of this assumption see @xcite ) .",
    "the extrapolation methods based on this assumption include potential field extrapolation @xcite , linear force - free field extrapolation @xcite and nonlinear force - free field extrapolation @xcite .",
    "methods for the extrapolation non force - free fields and have been developed by @xcite .",
    "potential fields can be determined directly from line - of - sight magnetogram data ( e.g. mdi on soho ) .",
    "linear force - free fields can as well be calculated from line - of - sight magnetograms , but contain a free parameter @xmath2 which has to be computed from additional data , e.g. with fitting procedures which try to match the field model with observed coronal plasma loops using data from e.g. eit @xcite or yohkoh @xcite .",
    "unfortunately potential fields and linear force - free fields do not contain free energy and are very probably a poor approximation for an active region prior to an eruption . by free energy we understand energy which can be released during an eruption .",
    "a linear force free field has more energy than a potential field .",
    "this energy can , however , not be released during an eruption related to ideal or resistive mhd - instabilities because a linear force free field can not rapidly relax to a potential field .",
    "the reason is that the magnetic helicity is strictly conserved for ideal mhd and approximately conserved for resistive processes .",
    "( the magnetic helicity is dissipated slower than the magnetic energy , see @xcite ) . a nonlinear force free field can , however , relax to a linear force free field with the same magnetic helicity . in this sense a nonlinear force free field has free energy available for an eruption .",
    "consequently investigations regarding non - linear force - free fields are essential to understand eruptive phenomena .",
    "the calculation of non linear force - free fields is complicated by the intrinsic nonlinearity of the underlying mathematical problem . from the observational point of view",
    "the non linear reconstruction is also more challenging because photospheric vector magnetograph data are required .",
    "unfortunately the transversal component of the photospheric b - field is measured with significant lower accuracy as the line of sight component .",
    "an additional problem is that the transversal magnetic field is only known with respect to an @xmath3 ambiguity and a preprocessing of the raw data is necessary to resolve this ambiguity ( one possibility is the minimum energy method by @xcite used for vector magnetogram data from ivm in hawaii . ) .",
    "several methods have been proposed to compute nonlinear force - free fields :    * a conceptionally simple method is to reformulate the force - free equations ( [ ampere - ff]-[solenoidal - ff ] ) in such way that they can be used for an upward integration of the vector magnetogram into the corona @xcite .",
    "this direct extrapolation is an ill posed problem for the elliptic equations ( [ ampere - ff]-[solenoidal - ff ] ) and consequently the method is limited to low heights . in particular",
    "one finds that an erroneous exponential growth of the magnetic field with increasing height is a typical behaviour . *",
    "an alternative approach is to use a grad - rubin method ( @xcite ) .",
    "this method uses a potential field as initial equilibrium and then progressively currents are introduced into the system and the fields are relaxed towards a force - free state .",
    "the method is especial useful for small deviations from a potential field with small values of @xmath2 and modest non linearities .",
    "the method requires an explicit calculation of the @xmath2 distribution on the photosphere . in principle",
    "the computation of @xmath2 is straight forward @xmath4 but this is inaccurate for observational data for the following reasons .",
    "first one needs the transversal component of the photospheric magnetic field which is measured with lower accuracy than the line of sight magnetic field . in a second step",
    "one has to take the horizontal derivatives ( x , y)of these inaccurate values and finally one has to divide through the normal magnetic field @xmath5 which causes additional problems where @xmath6 is small .",
    "these errors cumulate in the photospheric @xmath2 distribution . *",
    "a third possibility is to use the method of mhd relaxation @xcite .",
    "the idea is to start with a suitable magnetic field which is not in equilibrium and to relax it into a force - free state . for test configurations @xcite",
    "the mhd relaxation method converges to the exact solution , but with less accuracy than the optimization approach discussed below @xcite . * in the optimization approach @xcite a functional containing the force - free equations is minimized .",
    "the method directly uses the measured vector magnetograph data and an explicit computation of @xmath2 is not necessary .",
    "another advantage of the method is that the quality of the reconstructed magnetic field ( force - free and solenoidal condition ) is controlled automatically within the iteration procedure .",
    "a difficulty of the method is that it requires boundary conditions on all boundaries of a computational box while for observational data only the bottom boundary data are known . within this paper",
    "we are dealing with this problem and extend the optimization method accordingly .",
    "while the low @xmath1 plasma in the lower corona can be described with the non linear force - free approach , it is necessary to include plasma pressure and solar gravitation to describe regions with a finite plasma @xmath1 , e.g. helmet streamers .",
    "@xcite extended the force - free optimization with the aim to include these forces and showed that the method converges for test configurations .",
    "the difficulties regarding the lateral and top boundaries are analog to the non - linear force - free case .",
    "the non force - free reconstruction requires additional data as input , e.g. the coronal plasma density distribution from an assumed model or computed with help of tomographic methods .",
    "we outline the paper as follows . in section",
    "[ basic ] we provide the basic equations of the modified optimization method and derive the iteration equations . in section",
    "[ special ] we specify useful forms of the weighting function in the boundary regions . section [ test1 ] contains test runs regarding the non linear force - free case and section [ test2 ] consistency checks for non force - free configurations .",
    "we draw conclusions in section [ conclusions ] and give an outlook for further research .",
    "force - free coronal magnetic fields have to obey the equations @xmath7 the force - free approach is valid in the low corona where the plasma @xmath1 is small",
    ". for extended structures , e.g. helmet streamers the plasma @xmath1 increases and the force - free assumption is not valid anymore .",
    "therefore it is necessary to consider the effect of plasma pressure and gravity here and solve the magneto hydro static equations ( mhs ) .",
    "@xmath8 where @xmath9 is the magnetic field , @xmath10 the electric current density , @xmath11 the plasma pressure , @xmath12 the plasma density , @xmath13 the vacuum permeability and @xmath14 the solar gravity potential .",
    "we define the functional @xmath15 with    @xmath16 & ( \\mbox{force - free fields } ) \\\\",
    "b^{-2 } \\;\\left[(\\nabla \\times { \\bf b } ) \\times { \\bf b } - \\mu_0 ( \\nabla p + \\rho \\nabla \\psi ) \\right ] & ( \\mbox{mhs } ) \\end{array } \\right . \\\\ { \\bf \\omega_b } & = & b^{-2 } \\;\\left[(\\nabla \\cdot { \\bf b } ) \\ ; { \\bf b } \\right ] .",
    "\\label{defomega}\\end{aligned}\\ ] ]    @xmath17 is a weighting function .",
    "useful forms of the weighting function will be discussed below .",
    "for the force - free case the functional is given explicitly as @xmath18 \\ ; d^3x \\label{defl1},\\ ] ] and it is obvious that ( for @xmath19 ) the force - free equations ( [ forcefree]-[solenoidal - ff ] ) are fulfilled when l is equal zero . for the non force - free case l is given explicitly as @xmath20 \\ ; d^3x \\label{defl2},\\ ] ] and when the functional reaches ( for @xmath19 ) its minimum at @xmath21 then the mhs equations ( [ forcebal]-[solenoidal ] ) are fulfilled",
    ".    the following discussion is equivalent for the force - free and non force - free case . without weighting function",
    "@xmath22 the method has been developed by @xcite for the force - free case and by @xcite for the non force - free case .",
    "for @xmath23 the optimization method requires that the magnetic field is given on all ( 6 for a rectangular computational box ) boundaries .",
    "this causes a serious limitation of the method because such data are only available for model configurations . for the reconstruction of the coronal magnetic field",
    "it is necessary to develop a method which reconstructs the magnetic field only from photospheric vector magnetograms .",
    "vector magnetograms provide boundary conditions only for the bottom boundary of a computational box while the other five boundaries remain unknown . without a weighting function",
    "all six boundaries of the computational box have equal rights and influence the solution in the box .",
    "it is therefore important to diminish the effect of the top and lateral boundaries on the magnetic field inside the computational box .",
    "this can be done either by including a variation of b not only in the interior but also on those boundaries where b is unknown .",
    "this approach , however , is numerically difficult because it involves two types of variations .",
    "we show that it is essentially equivalent to introducing finite size boundary regions on those boundaries where b is unknown with the weighting function @xmath17 different from unity .",
    "the idea is do define an interior physical region where we want to calculate the magnetic field so that it fulfills the force - free or mhs equations .",
    "this region is in the center of the box ( including the photosphere ) with @xmath24 .",
    "the computational box additionally includes boundary layers towards the lateral and top boundary where @xmath25 decreases to @xmath26 at the computational boundary .",
    "consequently the method weights deviations from the force - free state ( or mhs - state ) less severely close to the boundary .",
    "the use of a weighting function has been proposed for the force - free case by @xcite in the conclusions but no iteration equations or test simulations have been presented .",
    "here we provide these iteration equations for the more generalized case .",
    "we carry out several tests to investigate the optimum shape of the weighting function and how the size of the boundary layer influences the quality of the reconstruction .",
    "we minimize equation ( [ defl ] ) with respect to an iteration parameter @xmath27 ( see appendix [ appendixa ] for details ) and obtain an iteration equation for the magnetic field @xmath28 @xmath29 @xmath30 @xmath31 and @xmath32 is the inward unit vector on the surface @xmath33 .",
    "the surface integral in ( [ minimize1 ] ) vanishes if the magnetic field is described on the boundaries of a computational box .",
    "inside the computational box we iterate the magnetic field with @xmath34 which insures that @xmath35 is monotonically decreasing .",
    "we compute the 3d - coronal magnetic field in a numerical box using the following steps .    * as a start configuration we use the measured normal component @xmath5 of the magnetic field to calculate a potential magnetic field in the whole box with help of a fourier representation @xcite . * for non force - free ( finite @xmath1 )",
    "configurations the plasma density distribution is described in the box .",
    "this step is unnecessary for force - free @xmath36 fields .",
    "* we use vector magnetograph data to describe the bottom boundary ( photosphere ) of the computational box . on the lateral and top boundaries the field is chosen from the potential field above .",
    "* we iterate for the magnetic field inside the computational box with ( [ iterateb ] ) using a landweber - iteration ( see e.g. @xcite )",
    ". the continuous form of ( [ iterateb ] ) guaranties a monotonically decreasing @xmath35 .",
    "this is as well ensured in the discretized form if the iteration step @xmath37 is sufficiently small .",
    "the code checks if @xmath38 after each time step .",
    "if the condition is not fulfilled , the iteration step is repeated with @xmath37 reduced by a factor of 2 .",
    "after each successful iteration step we increase @xmath37 slowly by a factor of @xmath39 to allow the time step to become as large as possible with respect to the stability condition .",
    "the iteration stops if @xmath37 falls below a limiting value , e.g. @xmath40 of the initial iteration step keeps on decreasing recurrently when the solution has converged .",
    "we never found a further improvement of l after @xmath37 has once fallen below @xmath40 of the initial iteration step . ] in the current version of the code .",
    "let us remark that the main numerics of the optimization code is similar for the method with and without a weighting function .",
    "the main problem for the optimization method without weighting function is that it requires the vector magnetic field on all six boundaries of a computational box . as only the bottom boundary",
    "is measured one has to make assumptions regarding the lateral and top boundary , e.g. assume a potential field . in general this leads to inconsistent boundary conditions ( see @xcite regarding the compatibility of photospheric vector magnetograph data . ) and consequently a bad quality of the reconstructed magnetic field .",
    "with help of the weighting function the five inconsistent boundaries are replaced by boundary layers and consequently we get more flexible boundaries around the physical domain which will adjust automatically during the iteration .",
    "the idea of introducing a boundary layer with @xmath41 is to reduce the dependence of the solution in the interior of the box from the unknown boundary conditions .",
    "since we have no measurements on these boundaries any choice of the boundary conditions is a mere guess .",
    "the aim is only to allow the solution in the interior to evolve more independently from the boundary conditions chosen .",
    "so the advantage of the boundary layer is a higher degree of independence of the solution in the interior from the chosen boundary .",
    "the price we have to pay is a higher computing time , as the magnetic field has to be iterated within the whole computational box which includes the physical domain as well as the boundary layers .",
    "we want to use the weighting function to deal with the unknown top and lateral boundaries .",
    "we define an inner _ physical _",
    "domain @xmath42 with @xmath24 and boundary layers @xmath43 where @xmath25 decreases monotonically from 1 to 0 through the outer _ numerical _ boundary layer with the thickness @xmath44 .",
    "consequently @xmath25 becomes one - dimensional in each boundary layer ( e.g. @xmath45 at the top boundary layer ) and we get @xmath46 .",
    "the surface integrals vanish on all boundaries because @xmath47 on the top and lateral boundaries and @xmath48 on the bottom boundary where the magnetic field is measured with vectormagnetographs .",
    "consequently ( [ minimize1 ] ) reduces to @xmath49    \\ ; d^3x \\\\ % \\rightarrow \\frac{1}{2 } \\ ;",
    "\\frac{d l}{d t}&=&-\\int_{v_i } \\frac{\\partial { \\bf b}}{\\partial t } \\cdot { \\bf   f } \\ ; d^3x -\\int_{v_b } \\ ; w \\ ; \\frac{\\partial { \\bf b}}{\\partial t } \\cdot { \\bf f } \\ ;",
    "d^3x \\nonumber \\\\ & & -\\int_{v_b } \\frac{\\partial w}{\\partial \\hat n}\\ ; \\frac{\\partial { \\bf b}}{\\partial t } \\cdot \\left [ \\hat n \\ ; \\times ( { \\bf \\omega_a } \\times { \\bf b } ) - \\hat n \\ ; ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\right ] d^3x \\label{minimize2}.\\end{aligned}\\ ] ] it is interesting to investigate the limit of an infinitesimally thin boundary layer @xmath50 in ( [ minimize2 ] ) .",
    "the thinner the boundary layer becomes the steeper is @xmath51 and for an infinitesimally thin boundary layer the gradient becomes infinity .",
    "the boundary layer is constructed in such way that independent from the sheet thickness @xmath44 we have @xmath52 which remains true also for @xmath50 . in the limit of @xmath50",
    "the term @xmath53 remains constant through the sheet and the integration regarding @xmath54 can be carried out explicitly .",
    "consequently only a surface integral remains as the last term in equation ( [ minimize2 ] ) .",
    "the second integral in ( [ minimize2 ] ) vanishes for @xmath50 and we get @xmath55 this exactly coincides with the non weighted case",
    ". consequently equation ( [ minimize2 ] ) is a generalization of the usual optimization equation ( [ minimize3 ] ) .    .",
    "the solid lines shows a linear profile , the dotted line a quadratic , the dashed line a cos and the dashdotted line a tanh profile .",
    "all profiles are equal one at the physical boundary , decrease monotonically within the boundary layer and reach zero at the boundary of the computational box.,height=226 ]",
    "to test our code we use a semi - analytic model active region developed by @xcite .",
    "we use the low and lou solution with @xmath56 and @xmath57 as test .",
    "the normal photospheric magnetic field is normalized to a maximum of @xmath58 gauss .",
    "figure [ box1 ] shows the normal magnetic field @xmath5 on the photosphere for this configuration .",
    "the framed region contains the physical domain .",
    "we investigate two cases , in force - free i the physical domain is approximately flux - balanced and in force - free ii not .",
    "we are interested in reconstructing an inner region ( physical domain ) of @xmath59 points and diagnose @xmath60 and @xmath61 averaged over the physical domain here .",
    "we also diagnose @xmath35 in the whole computational box .    at the lateral and top boundary",
    "we introduce an additional boundary layer of @xmath62 points and @xmath25 decreases from @xmath63 to @xmath26 in this layer .",
    "we investigate different profiles regarding the weighting function , e.g. linear , quadratic , cos and tanh ( see figure [ wprofil ] ) .",
    "we investigate how the size of the boundary layer influences the solution .",
    "table [ tab1 ] and figure [ vergleich ] show the result of our investigations .",
    ".details of runs to reconstruct force - free and non force - free magnetic fields .",
    "all configurations have been calculated for a physical domain of @xmath59 grid points .",
    "the first column specifies the profile of the boundary layer , the second column the size @xmath62 of the boundary layers , the third column the value of @xmath35 in the computational box , the fourth column the value of @xmath60 in the physical domain and the fifth column the force - free condition ( for force - free configuration ) or the force balance ( for mhs equilibria ) averaged over the physical domain .",
    "we specify the start - error and discretisation error for each configuration .",
    "[ cols= \" > , > , > , > , > \" , ]     the magnetic field lines calculated from these fields look exactly the same as for potential boundary conditions .",
    "we conclude that the influence of the lateral and top boundary conditions towards the solution in the physical domain is indeed very small .",
    "the magnetogram on the right hand side of figure [ box1 ] is obviously bad conditioned .",
    "significant parts of the magnetic flux are outside of the framed physical domain . in principle",
    "it would be better to always choose a magnetogram such that the majority of the flux is centered and the overall flux is approximately balanced but due to the limited size of vector magnetograms sometimes vector magnetograph data are not available over an entire active region .",
    "here we investigate how this influences the quality of the reconstruction .",
    "we find that the reconstruction without weighting function provides much worse results in such a case than for a well centered force - free configuration .",
    "this is obvious caused by the potential field assumed on the lateral boundary in a region of a high magnetic flux and current density .",
    "the influence of the inconsistent lateral boundary conditions on the magnetic field in the physical domain is too strong . here",
    "the method of boundary relaxation improves the quality of @xmath60 nearly by a factor of two , but the result still remains unsatisfactory . for runs with weighting function",
    "the result is basically similar as for force - free i. a large boundary layer ( now including all active parts of the magnetogram ) improves the quality of the reconstruction significantly . for the largest boundary layer @xmath64 points wide",
    "the quality of the reconstruction is approximately equal to a @xmath65 point wide boundary layer in the force - free i case .    if for observational data only parts of an active region are available as vector magnetogram data a nonlinear reconstruction of the coronal magnetic field might become difficult or impossible .",
    "one could try to get the corresponding normal component of the photospheric magnetic field from other sources , e.g. the line of sight magnetograph mdi on soho and make assumptions regarding the transversal magnetic field .",
    "the reconstructed magnetic field will then of course be influenced by these ( not observed ) assumptions .",
    "for finite @xmath1 configurations it is necessary to include pressure and gravity forces and solve the magneto hydro static equations ( [ forcebal])-([solenoidal ] ) .",
    "to test our code we use an analytic mhs equilibrium ( see @xcite section 3.1 . ) with an average plasma @xmath66 . from this analytic solution",
    "we extract a photospheric vector magnetogram and the coronal density distribution .",
    "it is convenient to use the analytic density distribution here to test our code , but one has to keep in mind that for observational data the coronal density structure has to be reconstructed with help of a tomographic inversion .",
    "corresponding observational data ( line of sight integrals of the coronal density structure ) are expected from the stereo - mission .",
    "the tomographic inversion of these data is a challenging problem on its own and we are not going to discuss it here . @xcite give an overview over the tomographic inversion algorithm .",
    "here we consider the vector magnetogram and the plasma density distribution as given .",
    "the left hand panel of figure [ vergleich2 ] shows a potential magnetic field reconstruction consistent with the normal component of the magnetic field extracted from an analytic magneto hydro static equilibrium .",
    "the comparison of the magnetic field lines of the potential field with the exact field show significant deviations . in table",
    "[ tab1 ] we diagnose @xmath35 and @xmath60 similarly as for the force - free cases and we diagnose the force balance @xmath67 here .",
    "similar as in the force - free case we find that the quality of the reconstruction is poor for an optimization without weighting function .",
    "a boundary layer of @xmath68 points together with a cos - profile of @xmath25 improves the value of functional @xmath60 by a factor of @xmath69 in the physical domain and the force balance contains the square of the force balance , see the definition [ defl2 ] .",
    "] by a factor of about @xmath70 . in the right hand panel of figure [ vergleich2 ]",
    "we compare the reconstructed field with the analytic solution and both coincide within the graphical resolution .",
    "a larger boundary layer of @xmath64 further improves the quantitative measures of the non force - free reconstruction .",
    "the influence of a weighting function acts similarly for force - free and non force - free configuration . in both cases",
    "the reconstruction result is significantly improved .",
    "in this paper we improved the optimization method for the reconstruction of non linear force - free and not force - free coronal magnetic fields .",
    "the optimization method minimizes a functional which consists of a quadratic form of the force balance and the solenoidal condition . while in previous optimization attempts the magnetic field needed to be described on all six boundaries of a computational box , our approach allows us to reconstruct the coronal magnetic field from the bottom boundary data alone .",
    "this is possible by the introduction of a boundary layer around the physical domain .",
    "the physical domain is a cubic area within which we want to reconstruct the coronal magnetic field consistent with photospheric vector magnetogram data .",
    "the boundary layer replaces the hard lateral and top boundary used previously .",
    "we showed that the limit of an infinitesimally thin boundary layer formally coincides with the original hard boundary .",
    "however , our test calculations show that a finite size weighted boundary yield much better results .",
    "we introduced a weighting function . in the physical domain",
    "the weighting function is unity .",
    "it drops monotonically in the boundary layer and reaches zero at the boundary of the computational box . at the boundary of the computational box we set the field to the value of the potential field computed from @xmath71 at the bottom boundary .",
    "this choice is not only convenient due to its mathematic simplicity , but as well physical motivated .",
    "the coronal magnetic field is approaching a potential field in quite regions and high in the corona .",
    "the current program uses a cartesian geometry and is designed to reconstruct basically isolated active regions . the photospheric magnetic field outside this active region ( and a surrounding area ) is ignored .",
    "this approach is the better justified the more the active region is isolated",
    ". often , however , active regions are not always completely isolated but magnetically connected with other active regions . to include this effect it would in principle",
    "be preferable to reconstruct the complete coronal magnetic field with vector magnetogram data on the whole photosphere as boundary .",
    "this would avoid the problems of prescribing the lateral boundaries and only the top boundary has to be chosen accordingly , similar to the source surface of potential field reconstructions .",
    "we do not expect any difficulties to apply our method to problems in spherical geometry .",
    "unfortunately the required photospheric boundary data are not available because current vector magnetographs do not observe the entire solar surface",
    ". the situation will probably significantly improved by the vector spectromagnetograph of the the solis project .",
    "it will deliver full disk vector magnetograms .",
    "we thank bernd inhester for useful discussions .",
    "this work was supported by dlr - grant 50 oc 0007 .",
    "we thank the referee thomas r. metcalf for useful remarks .",
    "@xmath74      we vary l with respect to an iteration parameter t and get @xmath76   \\ ; d^3x \\nonumber\\\\ & + & \\int_{v } \\ ; w \\ ; { \\bf \\omega_b } \\cdot   \\frac{\\partial}{\\partial t } [ ( \\nabla \\cdot { \\bf b } ) \\ ; { \\bf b } ] \\ ; d^3x \\nonumber\\\\ & - & \\int_{v } \\ ; w \\ ; ( \\omega_a^2 + \\omega_b^2 ) \\ ; { \\bf b } \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x\\end{aligned}\\ ] ] our aim is now to use vector identities and gauss law in such way that all terms contain a product with @xmath77 .",
    "this will allow us to provide explicit evolution equations for @xmath9 to minimize @xmath35 .",
    "the third term has the correct form already .",
    "we expand the first and second term @xmath78   \\ ; d^3x \\nonumber\\\\ & + & \\int_{v } \\ ; w \\ ; { \\bf \\omega_a } \\cdot \\left[(\\nabla \\times { \\bf b } ) \\times \\frac{\\partial { \\bf b}}{\\partial t}\\right ]    \\ ; d^3x \\nonumber\\\\ & + & \\int_{v } \\ ; w \\ ; { \\bf \\omega_b } \\cdot \\left [ \\left(\\nabla \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\right ) \\ ; { \\bf b } \\right ] \\ ; d^3x \\nonumber\\\\ & + & \\int_{v } \\ ; w \\ ; { \\bf \\omega_b } \\cdot \\left[(\\nabla \\cdot { \\bf b } ) \\ ; \\frac{\\partial { \\bf b}}{\\partial t } \\right ] \\ ; d^3x \\nonumber\\\\ & - & \\int_{v } \\ ; w \\ ; ( \\omega_a^2 + \\omega_b^2 ) \\ ; { \\bf b } \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x\\end{aligned}\\ ] ] the fourth and fifth term have the correct form .",
    "we apply the vector identities @xmath79 to the first and second term @xmath80 \\cdot \\frac{\\partial { \\bf b}}{\\partial t }   \\ ; d^3x \\nonumber\\\\ & - & \\int_{v } \\ ; w \\ ; ( \\omega_a^2 + \\omega_b^2 ) \\ ; { \\bf b } \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x\\end{aligned}\\ ] ] term two , four and five have the correct form .",
    "we apply @xmath81 to term 1 and @xmath82 to term 3 @xmath83   \\ ; d^3x \\nonumber\\\\ & - & \\int_{v}\\ ; w \\ ; \\nabla \\cdot \\left[({\\bf \\omega_a } \\times { \\bf b } ) \\times \\frac{\\partial { \\bf b}}{\\partial t }   \\right ]   \\ ; d^3x \\nonumber\\\\ & + & \\int_{v}\\ ; w \\ ; \\frac{\\partial { \\bf b}}{\\partial t } \\cdot ( { \\bf \\omega_a } \\times ( \\nabla \\times { \\bf b } ) \\ ;      \\ ; d^3x \\nonumber\\\\ & -&\\int_{v}\\ ; w \\ ; \\nabla ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ;   \\cdot   \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x \\nonumber\\\\ & + & \\int_{v}\\ ; w \\ ; \\nabla \\cdot \\left [ ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ; \\frac{\\partial { \\bf b}}{\\partial t } \\right ] \\ ; d^3x \\nonumber\\\\ & + & \\int_{v}\\ ; w \\ ; \\left[{\\bf \\omega_b } \\ ; ( \\nabla \\cdot { \\bf b})\\right ] \\cdot \\frac{\\partial { \\bf b}}{\\partial t }   \\ ; d^3x \\nonumber\\\\ & - & \\int_{v}\\ ; w \\ ;   ( \\omega_a^2 + \\omega_b^2 ) \\ ; { \\bf b } \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x\\end{aligned}\\ ] ] until here the derivation has been identical with the method without weighting function @xcite .",
    "now we get additional terms with respect to the weighting function .",
    "we apply @xmath84 to term 2 and 5 @xmath83   \\ ; d^3x \\nonumber\\\\ & - & \\int_{v } \\nabla \\cdot \\left[\\ ; w \\ ; ( { \\bf \\omega_a } \\times { \\bf b } ) \\times \\frac{\\partial { \\bf b}}{\\partial t } \\right ]   \\ ; d^3x \\nonumber\\\\ & + & \\int_{v }   \\left[({\\bf \\omega_a } \\times { \\bf b } ) \\times \\frac{\\partial { \\bf b}}{\\partial t } \\right ] \\cdot \\nabla w   \\ ; d^3x \\nonumber\\\\ & + & \\int_{v}\\ ; w \\ ; \\frac{\\partial { \\bf b}}{\\partial t } \\cdot ( { \\bf \\omega_a } \\times ( \\nabla \\times { \\bf b } ) ) \\ ;      \\ ; d^3x \\nonumber\\\\ & -&\\int_{v}\\ ; w \\ ; \\nabla ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ;   \\cdot   \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x \\nonumber\\\\ & + & \\int_{v } \\nabla \\cdot \\left[\\ ; w \\ ; ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ; \\frac{\\partial { \\bf b}}{\\partial t } \\right ] \\ ; d^3x \\nonumber\\\\ & -&\\int_{v } \\left [ ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ; \\frac{\\partial { \\bf b}}{\\partial t } \\right]\\cdot \\nabla w   \\ ; d^3x \\nonumber\\\\ & + & \\int_{v}\\ ; w \\ ; \\left[{\\bf \\omega_b } \\ ; ( \\nabla \\cdot { \\bf b})\\right ] \\cdot \\frac{\\partial { \\bf b}}{\\partial t }   \\ ; d^3x \\nonumber\\\\ & - & \\int_{v}\\ ; w \\ ;   ( \\omega_a^2 + \\omega_b^2 ) \\ ; { \\bf b } \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x\\end{aligned}\\ ] ] the terms 1,4,5,7,8 and 9 have the correct form . we apply gauss law to term 2 and 6 @xmath85   \\ ; d^3x \\nonumber\\\\ & - & \\int_{s } { \\bf \\hat n } \\cdot \\left[\\ ; w \\ ; ( { \\bf \\omega_a } \\times { \\bf b } ) \\times \\frac{\\partial { \\bf b}}{\\partial t }   \\right ]   \\ ; d^2x \\nonumber\\\\ & + & \\int_{v }   \\left[({\\bf \\omega_a } \\times { \\bf b } ) \\times \\frac{\\partial { \\bf b}}{\\partial t } \\right ] \\cdot \\nabla w   \\ ; d^3x \\nonumber\\\\ & + & \\int_{v } \\frac{\\partial { \\bf b}}{\\partial t } \\cdot ( \\ ; w \\ ; { \\bf \\omega_a } \\times ( \\nabla \\times { \\bf b } ) ) \\ ;      \\ ; d^3x \\nonumber\\\\ & -&\\int_{v } \\ ; w \\ ; \\nabla ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ;   \\cdot   \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x \\nonumber\\\\ & + & \\int_{s } { \\bf \\hat n }   ( \\ ; w \\ ; { \\bf \\omega_b } \\cdot { \\bf b } ) \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^2x \\nonumber\\\\ & -&\\int_{v } \\left [ ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ; \\nabla w    \\right ] \\ ; \\cdot \\frac{\\partial { \\bf b}}{\\partial t } d^3x \\nonumber\\\\ & + & \\int_{v } \\ ; w \\ ; \\left[{\\bf \\omega_b } \\ ; ( \\nabla \\cdot { \\bf b})\\right ] \\cdot \\frac{\\partial { \\bf b}}{\\partial t }   \\ ; d^3x \\nonumber\\\\ & - & \\int_{v }   \\ ; w \\ ; ( \\omega_a^2 + \\omega_b^2 ) \\ ; { \\bf b } \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x\\end{aligned}\\ ] ] now all terms except the terms 2 and 3 have the correct form .",
    "we apply @xmath86 to term 2 and 3 @xmath85   \\ ; d^3x \\nonumber\\\\ & - & \\int_{s } \\left[\\ ; w \\ ; { \\bf \\hat n } \\times ( { \\bf \\omega_a } \\times { \\bf b } ) \\right ] \\cdot   \\frac{\\partial { \\bf b}}{\\partial t }     \\ ; d^2x \\nonumber\\\\ & + & \\int_{v } \\left[\\nabla w \\times ( { \\bf \\omega_a } \\times { \\bf b } ) \\right ] \\cdot   \\frac{\\partial { \\bf b}}{\\partial t }     \\ ; d^2x \\nonumber\\\\ & + & \\int_{v } \\frac{\\partial { \\bf b}}{\\partial t } \\cdot ( { \\bf \\omega_a } \\times ( \\nabla \\times { \\bf b } ) ) \\ ;      \\ ; d^3x \\nonumber\\\\ & -&\\int_{v } \\ ; w \\ ; \\nabla ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ;   \\cdot   \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x \\nonumber\\\\ & + & \\int_{s } { \\bf \\hat n }   ( \\ ; w \\ ; { \\bf \\omega_b } \\cdot { \\bf b } ) \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^2x \\nonumber\\\\ & -&\\int_{v } \\left [ ( { \\bf \\omega_b } \\cdot { \\bf b } ) \\ ; \\nabla w    \\right ] \\ ; \\cdot \\frac{\\partial { \\bf b}}{\\partial t } d^3x \\nonumber\\\\ & + & \\int_{v } \\ ; w \\ ; \\left[{\\bf \\omega_b } \\ ; ( \\nabla \\cdot { \\bf b})\\right ] \\cdot \\frac{\\partial { \\bf b}}{\\partial t }   \\ ; d^3x \\nonumber\\\\ & - & \\int_{v } \\ ; w \\ ; ( \\omega_a^2 + \\omega_b^2 ) \\ ; { \\bf b } \\cdot \\frac{\\partial { \\bf b}}{\\partial t } \\ ; d^3x\\end{aligned}\\ ] ] now all terms have the correct form and we write them more compact @xmath87 @xmath29 @xmath30 @xmath88    aly , j.j . : 1989 , _ solar phys . _ * 120 * , 19 - 48 .",
    "amari , t. , aly , j.j . ,",
    "luciani , j.f . ,",
    "boulmezaoud , t.z .",
    ", mikic , z. : 1997 , _ solar phys . _ * 174 * , 129 .",
    "amari , t. , boulmezaoud , t. z. , and mikic , z. : 1999 , _ astron .",
    "_ , 350 , 1051 - 1059 .",
    "arnaud , j. and newkirk , jr.g . : 1987 , _ astron , astrophys .",
    "_ , 178,263 - 268 berger , m.a.:1984 , _ geophys .",
    "fluid dynamics _ , 30,79 - 104 carcedo , l. , brown , d.s . ,",
    "hood , a.w . ,",
    "neukirch , t. , wiegelmann , t. : 2003 _ solar phys .",
    "_ accepted chiu , y.t . ,",
    "hilton , h.h . : 1977 , _ astrophys .",
    "j. _ * 212 * , 821 .",
    "chodura , r. , and schlter , a. : 1981 _ j. comp .",
    "_ , 41 , 68 - 88 .",
    "gary , g. a. : 2001 , _ solar phys .",
    "_ , 203 , 71 - 86 .",
    "house , l.l.:1977 _ astrophys .",
    "j. _ , 214 .",
    "632 - 652 judge , p.g.:1998 _ astrophys .",
    "1009 - 1022 judge , p.g .",
    ", casini , r. , tomczyk , s. , edwards , d.p . and francis , e. : 2001 , _ coronal magnetometry : a feasibility study _ ,",
    "ncar / tn-466+str , ncar technical note louis , a.k . : 1989 , _ inverse und schlecht gestellte probleme _ , teubner studienbuecher isbn 3 - 519 - 02085-x .",
    "low , b.c . and",
    "lou , y.q . : 1989 _ astrophys . j. _ , 352 , 343 - 352 .",
    "metcalf , t.r . :",
    "1994 _ solar phys .",
    "_ , 155 , 235 - 242 .",
    "petrie , g.j.d .  and",
    "neukirch , t. : 2000 , _ astron .",
    "astrophys . _ * 356 * , 735 .",
    "roumeliotis , g. : 1996 , _ astrophys .",
    ", 473 , 1095 - 1103 .",
    "sakurai , t. : 1981 , _ solar phys .",
    "_ * 69 * , 343 .",
    "schmidt , h.v . : 1964 in w.n .",
    "ness ( ed . ) , _ ass - nasa symposium on the physics of solar flares _ , nasa sp-50 , p. 107 .",
    "seehafer , n. : 1978 , _ solar phys .",
    "_ , * 58 * , 215 .",
    "seehafer , n. : 1982 , _ solar phys .",
    "_ , 81 , 69 - 80 semel , m. : 1967 , _ ann .  astrophys . _ * 30 * , 513 .",
    "semel , m. : 1988 , _ astron .",
    "astrophys . _ * 198 * , 293 .",
    "wheatland , m. s. , sturrock , p. a. , and roumeliotis , g. : 2000 , _ astrophys .",
    ", 540 , 1150 - 1155 .",
    "wiegelmann , t. and neukirch , t. : 2002 _ solar phys .",
    "_ , * 208 * , 233 - 251 .",
    "wiegelmann , t. and neukirch , t. : 2003 , _ nonlinear processes in geophysics _ , * 10 * , 313 - 322 wiegelmann , t. and inhester , b. : 2003 , _ solar phys .",
    "_ , * 214 * , 287 - 312 . wu , s. t. , sun , m. t. , chang , h. m. , hagyard , m. j. , and gary , g. a. : 1990 _ astrophys . j. _ , 362 , 698 - 708"
  ],
  "abstract_text": [
    "<S> we developed a code for the reconstruction of nonlinear force - free and not force - free coronal magnetic fields . </S>",
    "<S> the 3d magnetic field is computed numerically with the help of an optimization principle . </S>",
    "<S> the force - free and non force - free codes are compiled in one program . </S>",
    "<S> the force - free approach needs photospheric vectormagnetograms as input . </S>",
    "<S> the non force - free code additional requires the line - of - sight integrated coronal density distribution in combination with a tomographic inversion code . </S>",
    "<S> previously the optimization approach has been used to compute magnetic fields using all six boundaries of a computational box . here </S>",
    "<S> we extend this method and show how the coronal magnetic field can be reconstructed only from the bottom boundary , where the boundary conditions are measured with vector magnetographs . </S>",
    "<S> the program is planed for use within the stereo mission .    </S>",
    "<S> kluwer prepress department + p.o . </S>",
    "<S> box 990 + 3300 az dordrecht + the netherlands </S>"
  ]
}