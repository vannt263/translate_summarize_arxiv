{
  "article_text": [
    "a point spread function ( psf ) is a continuous two - dimensional probability - distribution function which describes the scattering pattern of photons from a point source ( star ) .    encoding a psf as a continuous mathematical function works well for many ground - based astronomical observations due to the significant blurring caused by turbulence in the earth s atmosphere and dome / telescope seeing .",
    "ground - based psfs are typically characterized by having a lot of the power in their spatial - frequency distributions at low spatial frequencies .",
    "space - based psfs frequently have significant amounts of power at higher spatial frequencies due to the lack of blurring caused by atmospheric turbulence .",
    "adaptive optics can produce psfs with characteristics found in both uncorrected ground - based psfs and space - based psfs : low - spatial - frequency features ( e.g. , broad halos ) are frequently combined with high - spatial - frequency features ( e.g. , due to segmented mirrors ) .",
    "some psf - fitting stellar photometric reduction programs describe the psf as a combination of continuous mathematical functions and a residual matrix which contains the difference between the mathematical model of the psf and an observed ( `` true '' ) psf .",
    "this artificial breaking of the psf into analytical and discrete components is not without mathematical risk .",
    "such residuals can have small features which are described with higher spatial frequencies than are present in the actual observational data  a problem that can usually be mitigated by sampling residuals at higher spatial resolutions than the observational data .",
    "what if we dispose of the use of continuous mathematical functions to model _ any _ part of the psf and just use a matrix to describe _ all _ of the psf ? is precise and accurate stellar photometry and astrometry possible using matrix psfs with oversampled stellar image data ? if that is possible , then what extra information , if any , is required in order to do precision photometric reductions with matrix psfs on undersampled data ?",
    "this article describes how precise and accurate stellar photometry may be obtained using psfs encoded as a matrix .",
    "the following section derives the theoretical performance limits of psf - fitting stellar photometry and astrometry .",
    "some of the key features of the matphot algorithm are presented in  3 .",
    "a demonstration computer program , called @xmath0 , based on the current implementation of the matphot algorithm , is described in  4 .",
    "simulated ccd ( charge - coupled device ) stellar observations are analyzed with @xmath0 in  5 and the performance of the matphot algorithm is compared with theoretical expectations .",
    "concluding remarks are given in  6 .",
    "an appendix explains box - and - whisker plots which are used extensively in this article .",
    "a point response function , @xmath1 , is the convolution of a point spread function , @xmath2 , and a detector response function , @xmath3 : @xmath4 the psf describes the two - dimensional distribution of _ photons _ from a star _ just above the detector . _",
    "although stellar photons are distributed as a point source above the earth s atmosphere , a stellar image becomes a two - dimensional distribution as the stellar photons are scattered by atmospheric turbulence .",
    "the blurred stellar image is then further degraded by passage of the stellar photons through the combined telescope and camera optical elements ( such as mirrors , lenses , apertures , etc . ) .",
    "the psf is the convolution of all these blurring effects on the original point - source stellar image .",
    "the two - dimensional discrete ( sampled ) detector response function ( drf ) describes how the detector electronics convert stellar photons ( @xmath5 ) to electrons ( @xmath6 )  including such effects as the diffusion of electrons within the detector substrate or the reflection ( absorption ) of photons on ( in ) the gate structures of the detector electronics .",
    "the psf is a two - dimensional probability - distribution function describing the scattering pattern of a photon .",
    "the volume integral of the psf is one : @xmath7 ; photons , after all , have to be scattered _",
    "somewhere_. it is important to note that since the angular extent of a psf can be quite large , the volume integral the psf _ over any given observation _ is frequently less than one due to the limited spatial coverage of the observation .",
    "the volume integral of a prf is , by definition , one or less : @xmath8 where a value that is less than one indicates a loss of stellar photons during the detection / conversion process within the detector . while the quantum efficiency ( qe ) variations within a single detector are generally not a major problem with state - of - the - art charge - coupled devices , intrapixel qe variations can be significant with some near - infrared detector technologies currently being used in astronomical cameras ( e.g. , @xcite , @xcite ) .",
    "a perfect drf gives a prf that is a _ sampled version _ of the psf : @xmath9 where @xmath10 pixel of the prf located at ( @xmath11 ) is the volume integral of the psf over the area of the @xmath10 pixel .",
    "the actual limits of the above volume integral reflect the appropriate mapping transformation of the @xmath12 and @xmath13 coordinates onto the ccd pixel coordinate system .",
    "the @xmath14 of a prf is defined as the volume integral of the _ square _ of the _ normalized _ prf : @xmath15 physically , @xmath14 is a shape parameter which describes the `` pointiness '' of a prf ; @xmath14 values range from a maximum of one ( all of the stellar flux is found within a single pixel ) to a minimum of zero ( a flat stellar image ) .",
    "for example , cameras that are out of focus have broad psfs with @xmath14 values near zero",
    ". a normalized gaussian psf with a standard deviation of @xmath16 pixels , @xmath17 , \\label{eq : gaussian}\\ ] ] that has been _ oversampled _ with a perfect drf will have a @xmath14 value of @xmath18 a critically - sampled normalized gaussian prf has a @xmath14 of @xmath19 and any prf with a @xmath14 value greater than that value ( @xmath20@xmath21 ) can be described as being undersampled .",
    "diffraction limited optics , theoretically , give @xmath14 values that decrease ( i.e. , psfs become flatter ) with increasing photon wavelength  for a fixed pixel ( detector ) size . with real astronomical cameras ,",
    "the value of @xmath14 frequently depends on _ where the center of a star is located within the central pixel _ of the stellar image .",
    "for example , the _ hubble space telescope _ _ ( hst ) _",
    "wfpc2 planetary camera prf at a wavelength of 200 nm has an observed @xmath14 value of 0.084 if the prf is centered in the middle of a pc pixel or 0.063 if the prf is centered on a pixel corner ( table 6.5 of * ? ? ?",
    "* ) ; at 600 nm the observed @xmath14 values range from 0.066 ( pixel - centered ) to 0.054 ( corner - centered ) .",
    "the wide - field cameras of the _ hst _ wfpc2 instrument have pixels which are approximately half the angular resolution of the pc camera pixels ; stellar images on the wf cameras are undersampled and the observed range of wf camera @xmath14 values are 0.1020.120 at 200 nm and 0.0980.128 at 600 nm .    the _ effective - background area _ , @xmath22 , of a prf is defined as the _ reciprocal _ of the volume integral of the _ square _ of the prf : @xmath23^{-1 } \\ , .",
    "\\label{eq : beta}\\ ] ] alternatively , the effective - background area ( a.k.a . _ equivalent - noise area _ or _ effective solid angle _ ) of a prf is equal to the reciprocal of the product of its @xmath14 and the square of its volume : @xmath24^{-1 } \\!\\!\\!= \\,\\frac{1}{{\\mbox{v}}^{\\,2}\\,{\\mbox{$\\mathsf{sharpness}$ } } } \\ , .",
    "\\label{eq : beta2}\\ ] ] the effective - background area of a normalized gaussian prf is @xmath25 px@xmath26 , where @xmath16 is the standard deviation in pixels ; a critically - sampled normalized gaussian prf has an effective - background area of @xmath27 px .",
    "@xcite notes that numerical integration of a realistic ground - based stellar profile gives an effective - background area of @xmath28 instead of the value of @xmath29 for a normalized gaussian profile .",
    "consider a ccd observation of two overlapping stellar images .",
    "assuming that we already know the psf and the drf of the observation , a simple model of the observation will have seven parameters : two stellar intensities is , by definition , is always less than or equal to the _ measured _ stellar intensity @xmath30 . ]",
    "@xmath31 in electrons , four coordinate values , giving the stellar positions @xmath32 in pixels , and @xmath33 which is the _ observed _ background sky level . ] in electrons ( which is assumed to be the same for both stars ) .",
    "these observational parameters are not independent for overlapping stars in the presence of photon and ccd readout noise",
    ". the conservation of electron flux will require that if @xmath34 increases then @xmath35 must decrease and vice versa for a given value of @xmath33 .",
    "the most accurate photometry possible is obtained when these dependent parameters are fitted simultaneously .",
    "any reasonable model of two overlapping stellar images will be a nonlinear function when the positions and intensities are to be determined simultaneously .",
    "the technique of nonlinear least - squares fitting was developed to provide for the simultaneous determination of dependent or independent parameters of nonlinear model functions .",
    "assume that we have a calibrated ccd observation with @xmath36 pixels and that @xmath37 is the number of electrons in the @xmath10 pixel which is located at the position of @xmath38 and has a measurement error of @xmath39 electrons .",
    "let @xmath40 be an observational model of the ccd electron pixel values that has two coordinates @xmath41 and @xmath42 parameters . for notational convenience ,",
    "let the vector @xmath43 represent the coordinates @xmath38 of the @xmath44 pixel and the vector @xmath45 represent all the model parameters [ @xmath46 .",
    "the observational model of the @xmath10 pixel can thus be compactly written as follows : @xmath47 .",
    "the measure of the goodness of fit between the data and the model , called chi square , is defined as @xmath48 the theory of least - squares minimization states that the optimum value of the parameter vector @xmath45 is obtained when @xmath49 is minimized with respect to each parameter simultaneously . if @xmath50 is the optimal parameter vector , then @xmath51 is the absolute minimum of the @xmath42-dimensional manifold @xmath49 .    for some small correction parameter vector @xmath52 one can approximate @xmath53 by its taylor series expansion : @xmath54 where @xmath55_{jk } & \\equiv & \\frac{\\partial^2\\,{\\mbox{$\\chi^2({\\mbox{$\\mathbf{p}$}})$}}}{\\partial a_j \\partial a_k } \\nonumber \\\\ & \\approx & \\left[\\frac{\\partial\\,{\\mbox{$\\chi^2({\\mbox{$\\mathbf{p}$}})$}}}{\\partial a_j}\\right ] \\left[\\frac{\\partial\\,{\\mbox{$\\chi^2({\\mbox{$\\mathbf{p}$}})$}}}{\\partial a_k}\\right]\\end{aligned}\\ ] ] is the @xmath56 element of the @xmath42@xmath57@xmath42 hessian matrix @xmath58 of @xmath49 [ e.g. , @xcite ; @xcite ]",
    "the approximation for the calculation of the hessian matrix elements is frequently used whenever the computation of the second partial derivative is numerically unstable . if @xmath53 is a _ local _ minimum of @xmath59 manifold , then it can be shown that @xmath60 by solving this equation for the correction vector @xmath52 , one can determine a better parameter vector as follows : @xmath61 when the parameter vector ( @xmath45 ) is redefined to be the better parameter ( @xmath62 ) , the hessian matrix and the gradient of @xmath49 can then be recalculated to determine a new correction vector ( @xmath52 ) .",
    "this process repeats until the correction vector is sufficiently small  generally when the difference between solutions is no longer statistically significant .",
    "if the fitting process has not failed , then the optimal parameter vector ( @xmath50 ) should be very close to the true parameter vector .",
    "once the optimal parameter vector has been determined , the covariance matrix @xmath63 may then be calculated by inverting the hessian matrix @xmath58 computed with the optimal parameter vector .",
    "the standard errors ( one standard deviation ) of the fitted parameters can be estimated as follows : @xmath64_{jj } } = \\left [ \\sum_{i=1}^{n } \\frac{1}{\\sigma_i^2 } \\left ( \\frac{\\partial { \\mbox{$m_i$}}}{\\partial p_j } \\right)^2\\ , \\right]^{-1/2 } \\label{eq : errorest}\\ ] ] where @xmath65 is the standard error associated with the @xmath66 parameter ( @xmath67 ) .",
    "usage of equation ( [ eq : errorest ] ) for error estimates is based on the critical assumption that fitted model parameters are independent ( indicated by negligibly small off - diagonal elements of the covariance matrix ) .",
    "it is important to note that whenever this critical assumption is violated , the results produced by least - squares fitting may not be statistically reliable , which is to say , they may no longer be physically meaningful .      the theoretical photometric performance limits for psf - fitting ccd stellar photometry can be derived using a simple observational model consisting of a prf and a constant sky level .",
    "consider a ccd observation of single isolated star on a flat sky background .",
    "assuming one already knows the prf of the observation at the location of the star , a simple model of the observation would have just two parameters : the stellar intensity ( @xmath68 ) in electrons , and the observed background sky level ( @xmath33 ) in electrons .",
    "the observational model for the @xmath10 pixel would be @xmath69 where @xmath70 is the volume integral of the prf and @xmath71 is the value of the @xmath44 pixel of the _ normalized _ prf @xmath72 .      in the case of bright stars ,",
    "most of the electrons found in the @xmath44 pixel of the observation will come from the star and not the sky : @xmath73 the actual number of electrons found in the @xmath44 pixel will be described by a poisson distribution with a mean and variance of @xmath74 .",
    "the measurement error ( one standard deviation ) for the @xmath44 pixel would thus be @xmath75 all other noise sources ( due to , for example , the observed background sky , instrumental readout noise , flat - field calibrations errors , etc . )",
    "are assumed , in this special case , to be negligibly small .",
    "the variance of the stellar intensity measurement error of bright stars can be estimated using equations ( [ eq : errorest ] ) , ( [ eq : photmodel ] ) , and ( [ eq : bphoterr ] ) : @xmath76^{-1 } \\nonumber \\\\ & \\approx & \\frac{{\\mbox{$\\mathcal{e}$}}}{{\\mbox{v } } } \\left [ { \\mbox{$\\displaystyle \\mathop{\\int\\!\\!\\!\\int}_{\\!-\\infty}^{\\ + \\infty } $ } } \\tilde{{\\mbox{$\\psi$ } } } \\,dx\\,dy \\right]^{-1 } \\nonumber \\\\ & = & \\frac{{\\mbox{$\\mathcal{e}$}}}{{\\mbox{v } } } \\ , \\label{eq : myvarebright}\\end{aligned}\\ ] ] as expected from photon statistics .",
    "a bright isolated star with an intensity of @xmath77 photons imaged with a perfect ccd detector would have a stellar image with @xmath77 @xmath6 @xmath78 and a stellar intensity measurement error of @xmath79 @xmath6 .",
    "the same star imaged with an inefficient ccd detector with a quantum efficiency of 25% ( @xmath80 ) would have a stellar image with @xmath20@xmath81 @xmath6 which would have a poisson noise error of @xmath20@xmath82 @xmath6 .",
    "the _ measured _ stellar intensity is @xmath83 @xmath6 with an rms measurement error of @xmath84 @xmath6 which is two times larger than it would be with a perfect detector and four times larger than the poisson noise error of the _ observed _ number of electrons .    solving for _ measured",
    "_ stellar intensity @xmath85 instead of the _ observed _ stellar intensity @xmath86 enables the creation of stellar photometric reduction programs capable of dealing with intrapixel qe variations through the accurate modeling of the image formation process within the detector .",
    "while it is certainly convenient to assume that one s detector has negligible intrapixel qe variation , in the real world even nasa - grade ccd detectors , like those found in the _ hst _ wfpc2 instrument , can have peak - to - peak intrapixel sensitivity variations that are greater than 0.02 mag ( @xmath872% ) ( see figs .  5 and 6 of * ? ? ?",
    "* ) .      most of the electrons found in the @xmath44 pixel of an observation of a _ faint _ isolated star on a flat sky background will come from the sky and not from the star . in that case , the measurement error associated with @xmath44 pixel is approximately the effective - background noise level : @xmath88 where @xmath89 @xmath33 is the constant observed background sky level which is assumed to be a poisson distribution with a mean of @xmath33 electrons , and @xmath90  is the rms readout noise .    the variance of the stellar intensity measurement error of faint stars can be estimated using equations ( [ eq : errorest ] ) , ( [ eq : photmodel ] ) , ( [ eq : fphoterrirms ] ) , ( [ eq : fphoterr ] ) , ( [ eq : fphoterr_approx ] ) , and ( [ eq : beta2 ] ) : @xmath91^{-1 } \\nonumber \\\\ & \\approx & \\frac{{\\mbox{$\\sigma^2_{\\rm{rms}}$}}}{{\\mbox{v}}^{\\,2 } } \\left [ { \\mbox{$\\displaystyle \\mathop{\\int\\!\\!\\!\\int}_{\\!-\\infty}^{\\ + \\infty } $ } } \\tilde{{\\mbox{$\\psi$}}}^2 \\,dx\\,dy \\right]^{-1 } \\nonumber \\\\ & = & { \\mbox{\\boldmath$\\beta$}}\\,{\\mbox{$\\sigma^2_{\\rm{rms}}$}}\\\\ & \\approx & { \\mbox{\\boldmath$\\beta$}}\\ , \\left [ { \\mbox{$\\mathcal{b}$}}+ { \\mbox{$\\sigma^2_{\\rm{ron}}$}}\\right ] \\ , \\label{eq : myvarefaint}\\end{aligned}\\ ] ] where @xmath22 is the effective - background area of the prf . equation ( [ eq : myvarefaint ] ) agrees with equation ( 9 ) of @xcite for a perfect @xmath92 noiseless @xmath93 detector .",
    "an important additional noise source for the photometry of faint stars is the systematic error due to the uncertainty of the measurement of the background .",
    "if the sky background is assumed to be flat , then the rms measurement error of the constant sky background can be estimated using equations ( [ eq : errorest ] ) , ( [ eq : photmodel ] ) , ( [ eq : fphoterrirms ] ) , ( [ eq : fphoterr ] ) , and ( [ eq : fphoterr_approx ] ) : @xmath94^{-1/2 } \\nonumber \\\\ & = & \\frac{{\\mbox{$\\sigma_{\\rm{rms}}$}}}{\\sqrt{n } } \\\\ & \\approx & \\sqrt { \\frac{{\\mbox{$\\mathcal{b}$}}+ { \\mbox{$\\sigma^2_{\\rm{ron}}$}}}{n } } \\ .",
    "\\label{eq : sigmab}\\end{aligned}\\ ] ] given a ccd observation with no readout noise , equation ( [ eq : sigmab ] ) reduces to the value of @xmath95 expected from simple sampling statistics .",
    "the portion of the rms stellar intensity measurement error that is caused by the error in the determination of the local sky level is @xmath96 @xcite . while this error is frequently negligible for bright stars , it is generally significant for faint stars .",
    "including the uncertainty in the determination of the constant observed background sky level thus gives a more realistic estimate for the rms stellar intensity measurement error for _ faint _ stars : @xmath97 precise and accurate stellar photometry of faint stars requires an excellent determination of the observed background sky which in turn requires accurate background sky models .",
    "given a valid background sky model , small apertures will be more sensitive to background sky measurement errors than large apertures .      a realistic photometric performance model for ccd psf - fitting photometry can be created by combining the bright and faint star limits developed above .",
    "the theoretical _ upper limit _ for the photometric signal - to - noise ratio ( @xmath98 ) of ccd psf - fitting photometric algorithms is as follows : @xmath99 } } \\ . \\label{eq : practical - snr}\\end{aligned}\\ ] ] these approximations assume , for the sake of simplicity , that any noise contribution due to dark current and quantization noise is negligible .",
    "while these additional noise sources can be added to create an even more realistic performance model for stellar photometry , the assumption of low dark current and minimal quantization noise is realistic for state - of - the - art astronomical - grade ccd imagers .",
    "the resulting photometric error is approximately @xmath100 where the constant @xmath101 is an approximation for pogson s ratio @xmath102 @xcite .",
    "the cramr - rao lower bound ( crlb ) is the lower bound on the variance of _ any _ unbiased estimator .",
    "since it is physically impossible to find an unbiased estimator that beats the crlb , the crlb provides a performance benchmark against which any unbiased estimator can be compared .",
    "the cramr - rao lower bound for stellar photometry of a single isolated star imaged by a two - dimensional photon - counting detector has been derived several times in the astrophysical literature ( see , e.g. , appendix a of @xcite , @xcite , and @xcite ) .",
    "the generalization for a crowded field with overlapping stellar images is given in @xcite .",
    "the cramr - rao lower bound for the bright star limit of stellar photometry of a single isolated star is @xmath103 which is equation ( [ eq : myvarebright ] ) with a perfect detector .",
    "the crlb for the faint star limit of stellar photometry of a single isolated star is @xmath104 which is equation ( [ eq : myrmsefaint ] ) with a noiseless detector and a negligible background measurement error ( @xmath105 ) .",
    "the photometric performance model has bright and faint star limits which are the same , respectively , as the bright and faint star cramr - rao lower bounds for stellar photometry of a single isolated star on a flat sky background imaged with a perfect noiseless detector .",
    "the theoretical astrometric limits for psf - fitting ccd stellar photometry can be derived using a simple observational model consisting of a gaussian prf and a constant sky level .",
    "consider a ccd observation of single isolated star on a flat sky background .",
    "a gaussian is a good model for the psf of a ground - based ccd observation since the central core of a ground - based stellar profile is approximately gaussian @xcite . in this case",
    "the psf would have three parameters : two coordinate values giving the location ( @xmath106 ) of the star on the ccd and the standard deviation of the gaussian ( @xmath16 ) in pixels [ see equation ( [ eq : gaussian ] ) ] .",
    "an _ imperfect but uniformly flat _",
    "drf ( @xmath107 ) gives a value for the @xmath44 pixel of the prf located at @xmath108 which is equal to the product of the volume of the prf and the value of the volume integral of the psf over the area of the @xmath44 pixel : @xmath109 the actual limits of the above volume integral reflect the appropriate mapping transformation of the @xmath12 and @xmath13 coordinates onto the ccd pixel coordinate system .",
    "if the prf has been _ oversampled _ , the value of the @xmath44 pixel of the prf is approximately equal to the product of the volume of the prf and the value of the psf at the _ center of the @xmath44 pixel _ : @xmath110 where @xmath111    a simple model of the observation will require two additional parameters : the stellar intensity ( @xmath68 ) in electrons and the observed background sky level ( @xmath33 ) in electrons .",
    "the @xmath44 pixel of the observational model would be @xmath112 where @xmath70 is the volume integral of the prf and @xmath113 is the value of the @xmath44 pixel of the _ normalized _ prf @xmath114 .      in the case of bright stars ,",
    "most of the electrons found in the @xmath44 pixel of the observation will come from the star and not the sky : @xmath115 the actual number of electrons found in the @xmath44 pixel will be described by a poisson distribution with a mean and variance of @xmath74 .",
    "the measurement error ( one standard deviation ) for the @xmath44 pixel would thus be @xmath116 all other noise sources ( e.g. , due to the observed background sky , instrumental readout noise , flat - field calibrations errors , etc . )",
    "are assumed to be negligibly small .",
    "the variance of the stellar @xmath117 position measurement error of a bright isolated _ oversampled _ star can be estimated using equations ( [ eq : errorest ] ) , ( [ eq : astmodel ] ) , ( [ eq : abphoterr ] ) , and ( [ eq : gaussian ] ) : @xmath118^{-1 } \\nonumber \\\\ & \\approx & \\frac{1}{{\\mbox{$\\mathcal{e}$}}{\\mbox{v } } } \\left [ \\sum_{i=1}^{n } \\frac{1}{{\\mbox{$\\mathsf{g}$}}_i } \\left ( \\frac{\\partial}{\\partial { \\mbox{$\\mathcal{x}$ } } } { \\mbox{$\\mathsf{g}$}}_i \\right)^2\\ , \\right]^{-1 } \\nonumber \\\\ & \\approx & \\frac{{\\mbox{$\\mathcal{s}$}}^4}{{\\mbox{$\\mathcal{e}$}}{\\mbox{v } } } \\left [ { \\mbox{$\\displaystyle \\mathop{\\int\\!\\!\\!\\int}_{\\!-\\infty}^{\\ + \\infty } $ } } { \\mbox{$\\mathsf{g}$ } } ( x , y ; { \\mbox{$\\mathcal{x}$ } } , { \\mbox{$\\mathcal{y}$ } } , { \\mbox{$\\mathcal{s}$ } } ) \\,(x-{\\mbox{$\\mathcal{x}$}})^2 \\,dx\\,dy \\right]^{-1 } \\label{eq : sxbt1 } \\nonumber \\\\ & = & \\frac{{\\mbox{$\\mathcal{s}$}}^2}{{\\mbox{$\\mathcal{e}$}}{\\mbox{v } } } \\nonumber \\\\ & \\approx & \\frac{{\\mbox{$\\mathcal{l}$}}^2}{{\\mbox{$\\mathcal{e}$}}{\\mbox{v } } } \\ , , \\label{eq : sxb_cssl}\\end{aligned}\\ ] ] where @xmath119 is the _ critical - sampling scale length _ of the prf , @xmath120 , one sees that critical - sampling scale length has been designed to be a proxy for @xmath16 for _ any _ prf . ] in pixel units ( @xmath121 ) , which , unlike @xmath16 , is defined for all prfs . by definition , the critical - sampling scale length of a critically - sampled prf imaged with a perfect detector is one pixel ; @xmath122 indicates that the prf is _ oversampled _ , while @xmath123 indicates that the prf is _",
    "undersampled_.    in the special case of a critically - sampled bright star imaged with a perfect detector , one finds that the astrometric performance limit ( in pixel units ) is equal to the reciprocal of photometric error performance limit : @xmath124      let us again assume that the noise contribution from the star is negligibly small and that the variance of the measurement error of the @xmath44 pixel can be replaced with an average constant rms value .",
    "the variance of the stellar @xmath117 position measurement error of a faint isolated _ oversampled _ star can be estimated using equations ( [ eq : errorest ] ) , ( [ eq : astmodel ] ) , ( [ eq : fphoterrirms ] ) , ( [ eq : fphoterr ] ) , ( [ eq : fphoterr_approx ] ) , and ( [ eq : gaussian ] ) : @xmath125^{-1 } \\nonumber \\\\ & \\approx & \\frac{{\\mbox{$\\sigma^2_{\\rm{rms}}$}}}{{\\mbox{$\\mathcal{e}$}}^2{\\mbox{v}}^{\\,2 } } \\left [ \\sum_{i=1}^{n } \\left ( \\frac{\\partial}{\\partial { \\mbox{$\\mathcal{x}$ } } } { \\mbox{$\\mathsf{g}$}}_i \\right)^2\\ , \\right]^{-1 } \\nonumber \\\\ & \\approx & \\frac{{\\mbox{$\\sigma^2_{\\rm{rms}}$}}\\,{\\mbox{$\\mathcal{s}$}}^4}{{\\mbox{$\\mathcal{e}$}}^2{\\mbox{v}}^{\\,2 } } \\left [ { \\mbox{$\\displaystyle \\mathop{\\int\\!\\!\\!\\int}_{\\!-\\infty}^{\\ + \\infty } $ } } { \\mbox{$\\mathsf{g}$}}^2 ( x , y ; { \\mbox{$\\mathcal{x}$}},{\\mbox{$\\mathcal{y}$ } } , { \\mbox{$\\mathcal{s}$ } } ) \\,\\,(x-{\\mbox{$\\mathcal{x}$}})^2 \\,dx\\,dy \\right]^{-1 } \\nonumber \\\\ & = & 8\\pi \\,{\\mbox{$\\sigma^2_{\\rm{rms}}$}}\\frac{{\\mbox{$\\mathcal{s}$}}^4}{{\\mbox{$\\mathcal{e}$}}^2{\\mbox{v}}^{\\,2 } } \\nonumber \\\\ & \\approx & 8\\pi \\,{\\mbox{$\\sigma^2_{\\rm{rms}}$}}\\left ( \\frac{\\mathcal{l}^2}{{\\mbox{$\\mathcal{e}$}}{\\mbox{v } } } \\right)^{\\!2 } \\nonumber \\\\ & \\approx & 8\\pi \\,{\\mbox{$\\sigma^2_{\\rm{rms}}$}}\\left ( { \\mbox{$\\sigma_{\\mbox{{\\mbox{$\\mathcal{x}$}}:\\,bright}}^2$}}\\right)^2 \\\\ & \\approx & 8\\pi \\left ( { \\mbox{$\\mathcal{b}$}}+ { \\mbox{$\\sigma^2_{\\rm{ron}}$}}\\right ) \\left ( { \\mbox{$\\sigma_{\\mbox{{\\mbox{$\\mathcal{x}$}}:\\,bright}}^2$}}\\right)^2 \\label{eq : sxf_cssl_approx } \\,.\\end{aligned}\\ ] ]      a realistic performance model for ccd psf - fitting astrometry can be created by combining the bright and faint star limits developed above .",
    "the expected _ lower limit _ of the rms measurement error for the stellar @xmath117 position for a single isolated star on a flat sky can be estimated as follows : @xmath126 } \\\\ & \\approx & \\sqrt { \\frac{\\mathcal{l}^2}{{\\mbox{$\\mathcal{e}$}}{\\mbox{v } } } \\ , \\left [ 1 + 8\\pi \\left ( { \\mbox{$\\mathcal{b}$}}+ { \\mbox{$\\sigma^2_{\\rm{ron}}$}}\\right ) \\frac{\\mathcal{l}^2}{{\\mbox{$\\mathcal{e}$}}{\\mbox{v } } } \\ , \\right ] } \\ , . \\label{eq : practical - astrometric - model - x}\\end{aligned}\\ ] ] the rms stellar @xmath127 position measurement error is , by symmetry , the same as for @xmath128 : @xmath129      the cramr - rao lower bound for stellar astrometry depends not only on the signal - to - noise ratio but also on the _ size _ and _ shape _ of the detector . for well - sampled data , the size and shape of the detector can be ignored and a crlb can be found for a perfect noiseless detector with infinitely small pixels .",
    "this is called the _",
    "photonic limit_.    the determination of the crlb for astrometry becomes much more complicated with _ undersampled _ observations .",
    "astrometric precision degrades when the size of the detector is comparable to the size of the stellar image  the quality of the position estimation is then dependent on the fraction of photons falling _ outside _ of the central pixel .",
    "the worst - case scenario for stellar astrometry occurs when _ all _ of the light from a star falls within a single pixel : all one knows for sure , in that unfortunate case , is that the star is located _ somewhere _ within the central ( and only ) pixel .    the photonic limit ( pl ) for stellar astrometry of a bright well - sampled single isolated normalized gaussian star is @xmath130 @xcite .",
    "using @xmath131 as a proxy for @xmath16 , one has the generalized form for any psf : @xmath132 which is equation ( [ eq : sxb_cssl ] ) with a perfect detector .",
    "the photonic limit for stellar astrometry of a faint well - sampled single isolated normalized gaussian star is @xmath133 @xcite . using @xmath131 as a proxy for @xmath16",
    ", one has the generalized form for any psf : @xmath134 which is equation ( [ eq : sxf_cssl_approx ] ) with a perfect noiseless detector .",
    "the astrometric performance model has bright and faint star limits which are the same , respectively , as the bright and faint star photonic astrometric limits , which are the cramr - rao lower bounds for stellar astrometry of a single isolated gaussian star on a flat sky background imaged with a perfect noiseless detector with infinitely small pixels .",
    "the cramr - rao lower bound for stellar astrometry of a single isolated gaussian star on a flat sky background imaged with a perfect noiseless ccd _ with square pixels _",
    "@xcite quickly approaches the photonic limits with _",
    "well - sampled _ observations ; undersampled observations will have larger astrometric errors than predicted by the photonic limits .",
    "following @xcite and @xcite , i now compare the astrometric error of bright isolated stars with their photometric error .",
    "the ratio of the astrometric error of a bright isolated star and the critical - sampling scale length of the prf is equal to the ratio of the stellar intensity measurement error and the stellar intensity : @xmath135 for example , a bright isolated critically - sampled star with one million electrons imaged on a perfect detector ( @xmath136 , @xmath137 , and @xmath138 ) would , theoretically , have a signal - to - noise ratio of a thousand ( @xmath139 ) , a stellar intensity measurement error of @xmath140 , and an rms position error in @xmath12 of one - thousandth of a pixel @xmath141 .",
    "such astrometric accuracy may be difficult to achieve in practice under normal ground - based observing conditions even with state - of - the - art astronomical - grade ccd cameras .",
    "the astrometric error of faint isolated stars is related to their photometric error as follows : @xmath142 for example , a faint isolated critically - sampled star imaged with a perfect detector with a 20.0% intensity measurement error and a negligible background measurement error ( @xmath105 ) would , theoretically , have an astrometric error of @xmath200.283 @xmath143 $ ] px .",
    "these results suggest the following practical lower bound for astrometric errors with respect to photometric errors :    for example , a star with one - percent stellar photometry will have no better than one - percent astrometry with respect to the critical - sampling scale length .",
    "if the star is critically sampled , then the astrometric precision will be no better than 0.01 px .",
    "all of the above derivations are based on the assumption that that flat - field calibration errors are negligible .",
    "the relation between photometry and astrometry for bright isolated stars can fail with large flat - field calibration errors .",
    "a _ discrete _ point spread function is a sampled version of a continuous two - dimensional point spread function .",
    "the shape information about the photon scattering pattern of a discrete psf is typically encoded using a numerical table ( matrix ) .",
    "analytical _ psf has the shape information encoded with continuous two - dimensional mathematical functions .    in order to do accurate stellar photometry and astrometry with discrete",
    "psfs one needs to able to ( 1 ) accurately shift discrete psfs to new positions within the observational model , and ( 2 ) compute the position partial derivatives of discrete psfs .",
    "the next two subsections describe how these tasks may be accomplished using numerical analysis techniques .      building a realistic observation model",
    "requires the placement of a star at the desired location within the model ; this is done by determining the prf at required location and then multiplying it by the stellar intensity .",
    "with psfs encoded by mathematical functions , one just computes the psf at the desired location in the observational model . with discrete psfs ,",
    "one ideally takes a reference psf ( typically derived / computed for the center of a pixel ) and shifts it to the desired location using a perfect two - dimensional interpolation function . but how is this done in practice ?",
    "the sinc function , @xmath144 , is , theoretically , a perfect two - dimensional interpolation function .",
    "unfortunately , the sinc function decays with @xmath145 and never actually reaches zero .",
    "one can use a windowed interpolant in order to improve computational speed  but one must be cautious about aliasing effects caused by using a windowed function . in the case of stellar photometry and astrometry , _ aliasing effects will generally only be seen with bright stars _ since a large number of photons are required in order to adequately sample the higher spatial frequencies of the psf .",
    "the following 21-pixel - wide _ damped sinc function _ interpolant does an excellent job interpolating discrete psfs : @xmath146 ^ 2\\right ) } \\label{eq : dampedsinc}\\end{aligned}\\ ] ] @xcite .",
    "note that since the two - dimensional sinc function is separable in @xmath12 and @xmath13 , this interpolant can be coded to be computationally fast and efficient .",
    "this interpolant , from the zodiac c library written by marc buie of lowell observatory , was specifically designed for use with 32-bit floating numbers .",
    "aliasing problems due to critically - sampled or undersampled data may be overcome by using discrete psfs that are _ supersampled _ at 2 , 3 , or more times more finely than the observational data . in order to have a realistic observational model , once the supersampled discrete psf has been interpolated to the correct position , a new _ degraded _",
    "( rebinned ) version of the discrete psf must be created which has the same spatial resolution as the observational data .",
    "while the mathematics of determining the position partial derivatives of individual stars within the observational model with respect to the @xmath12 and @xmath13 direction vectors is the same regardless of how the shape information in a psf is encoded , the implementation methodology for the computation of position partial derivatives of discrete psfs is very different than the one used for analytical psfs .",
    "the position partial derivatives of discrete psfs can be determined using _ numerical differentiation techniques _ on the discrete psf .",
    "it is a standard practice in numerical analysis to approximate the first , second , or higher , derivatives of a tabulated function @xmath147 with multi - point formulae .",
    "@xcite give 18 different multi - point formulae which can be used ( with varying degrees of accuracy ) to approximate the first derivative of the tabulated function @xmath147 .",
    "the following five - point differentiation formula , @xmath148\\ , , \\label{eq : five - point}\\end{aligned}\\ ] ] ( p.  914 of * ? ? ? * ) works well with discrete psfs @xcite .",
    "this approximation takes just 4 additions and 3 multiplications which generally makes it considerably faster to compute than the traditional determination of the partial derivative of the volume integral of the psf above a ccd pixel .",
    "the concepts presented above outline the unique and fundamental features of the matphot algorithm for accurate and precise stellar photometry using discrete point spread functions .",
    "while the key features of a ccd stellar photometric reduction algorithm can be described in an article , the full implementation of such an algorithm generally exists as a complex computer program consisting of many thousands of lines of computer code .",
    "since good algorithms can be poorly implemented , it can be difficult to differentiate between a poor algorithm and a poorly - coded implementation of a good algorithm .",
    "confidence in a complex algorithm can be established by developing an implementation of the algorithm which meets theoretical performance expectations .",
    "the following subsection describes a real - world implementation of the matphot algorithm that meets the theoretical performance expectations for accurate and precise stellar photometry and astrometry which were derived in  2 .",
    "i have written a c - language computer program , called @xmath0 and support software is freely available at the official matphot website at noao :  http://www.noao.edu/staff/mighell/matphot ] , which is based on the current implementation of the matphot algorithm for precise and accurate stellar photometry using discrete point spread functions .",
    "the @xmath0 code demonstrates the precision and accuracy of the matphot algorithm by analyzing simulated ccd observations based on user - provided discrete psfs encoded as fits images @xcite .",
    "discrete psfs are shifted within the observational model using the 21-pixel - wide damped sinc interpolation function given in equation ( [ eq : dampedsinc ] ) .",
    "position partial derivatives of discrete psfs are computed using the five - point differentiation formula given in equation ( [ eq : five - point ] ) .",
    "accurate and precise stellar photometry and astrometry of _ undersampled _ ccd observations can be obtained with the @xmath0 code when it is presented with",
    "_ supersampled _",
    "discrete psfs that are sampled 2 , 3 , or more times more finely than the observational data .",
    "the @xmath0 code is based on a robust implementation of the levenberg - marquardt method of nonlinear least - squares minimization ( @xcite , @xcite , also @xcite ) . when presented with simulated observations based on a gaussian psf with a known @xmath149 value ( full - width - at - half - maximum ) value of a gaussian is equal to @xmath150 times the standard deviation , @xmath16 , of the gaussian : @xmath151 [ see equation ( [ eq : gaussian ] ) ] . ]",
    ", the @xmath0 code can analyze the observation two different ways : ( 1 ) the matphot algorithm can be used with a discrete gaussian psf , or ( 2 ) analytical techniques @xcite can be used with an analytical gaussian psf .",
    "i now demonstrate that the theoretical performance limits of  2 provide practical performance metrics for photometry and astrometry of ccd stellar observations that are analyzed with oversampled gaussian point spread functions .",
    "twenty thousand _ oversampled _ ccd stellar observations were simulated and analyzed using the @xmath0 code .",
    "the ccd detector was assumed to be perfect ( @xmath152 ) with a ccd readout noise value of @xmath153 @xmath154 .",
    "stars were simulated using an _ analytical _ gaussian psf with a @xmath155 @xmath121 located near the center of 60@xmath5760 pixels , the input stellar intensities ranged from @xmath156 to @xmath157 mag mag @xmath158 @xmath159 ( electron ) @xmath158 @xmath160 ( photon ) for a point response function volume of one @xmath161 . ] ( @xmath162 ) , and a flat background was assumed with a value of @xmath163 @xmath6 .",
    "photon and readout noise was simulated , respectively , using poisson and gaussian random noise generators and the resulting observed background sky measurement error was @xmath164 @xmath6 .",
    "the median effective - background area of the prf of these observations was @xmath165 @xmath166 .",
    "all the simulated observations were analyzed with @xmath0 using an _ analytical _ gaussian psf with @xmath167 @xmath121 .",
    "the binned absolute photometric errors are shown as black box - and - whiskers plots ( see appendix [ appendix : a ] ) on the _ top _ panel of fig .",
    "the absolute photometric error of an observation is the absolute value of the difference between the measured ( estimated ) and true ( actual ) stellar magnitude : @xmath168 .",
    "the four _ grey _ limits seen on the _ top _ panel of fig .",
    "[ fig1 ] are theoretical predictions ( derived from  2.3.4 ) for the median ( 50% cumulative fraction : grey solid curve ) , top hinge ( 75% : bottom of the grey band ) , top fence ( @xmath2098.35% : top of band ) , and 5-@xmath169 outlier ( @xmath2099.99997% : grey dashed curve ) values .",
    "if the rms photometric error is called @xmath170 , then the values of these theoretical limits are approximately equal to @xmath171 , @xmath172 , @xmath173 , and @xmath174 , respectively .",
    "if the photometric performance model is correct and @xmath0 has been coded correctly , then ( 1 ) the observed median values ( central bar in each box ) should intersect the theoretical median value , ( 2 ) most of the top whiskers should be found inside the band , and ( 3 ) most of the outliers should be found above the top of the band and all of the outliers should found below the 5-@xmath169 outlier limit .",
    "comparing the absolute photometric errors of the 20,000 simulated ccd observations with the grey theoretical limits , one sees that the photometric performance of the @xmath0 code is very well predicted by the model given in  2.3.4 .",
    "the binned total astrometric errors are shown as black box - and - whiskers plots on the _ bottom _ panel of fig .",
    "[ fig1 ] . the total astrometric error of an observation is the distance between the measured ( estimated ) and true ( actual ) position of a star : @xmath175 .",
    "the four _ grey _ limits seen on the _ bottom _ panel of fig .",
    "[ fig1 ] are theoretical predictions ( derived from  2.4.4 ) for the median ( 50% cumulative fraction : grey solid curve ) , top hinge ( 75% : bottom of the grey band ) , top fence ( @xmath2098.97% : top of band ) , and 5-@xmath169 outlier ( 99.99997% : grey dashed curve ) values .",
    "the values of these theoretical limits are approximately equal to @xmath176 , @xmath177 , @xmath178 , and @xmath179 , where @xmath180 is the rms measurement error for the stellar @xmath117 position . if the astrometric performance model is correct and @xmath0 has been coded correctly , then ( 1 ) the observed median values should intersect the theoretical median value , ( 2 ) most of the top whiskers should be found inside the band , and ( 3 ) most of the outliers should be found above the top of the band and all of the outliers should found below the 5-@xmath169 outlier limit .    comparing the total astrometric errors of the 20,000 simulated ccd observations with the grey theoretical limits , one sees that the astrometric performance of the @xmath0 code is very well predicted by the model given in  2.4.4 .",
    "figure  [ fig2 ] shows the _ relative _ stellar intensity errors and the _ relative _ @xmath117 position errors of the 20,000 stars analyzed in fig .",
    "the relative stellar intensity error is the difference between the measured ( estimated ) and true ( actual ) stellar intensity values divided by the estimated stellar intensity error : @xmath181 .",
    "the relative @xmath117 position error is the difference between the measured ( estimated ) and true ( actual ) stellar @xmath117 position values divided by the estimated @xmath117 error : @xmath182 . if @xmath0 has been coded correctly , the relative error distributions for the stellar parameters @xmath68 , @xmath117 , and @xmath127 should be _ normally _ distributed .",
    "the five _ grey _ limits seen on each panel are theoretical predictions ( based on the normal distribution ) for , from bottom to top , the bottom fence ( @xmath200.35% cumulative fraction : bottom of the bottom grey band ) , bottom hinge ( 25% : top of bottom band ) , median ( 50% : grey solid line at zero ) , top hinge ( 75% : bottom of top band ) , top fence ( @xmath2099.65% : top of top band ) values .",
    "if the relative errors for @xmath68 and @xmath117 are indeed normally distributed , then ( 1 ) the observed median values should be near zero , ( 2 ) most of the whiskers should be found inside the bands , and ( 3 ) most of the outliers should be beyond the fence values .    comparing the relative errors for @xmath68 and @xmath117 of the 20,000 simulated ccd observations with the grey theoretical limits",
    ", one sees that these errors are , as expected , normally distributed .    *",
    "the @xmath0 code works well with oversampled analytical gaussian psfs and its performance can be very well predicted with the photometric and astrometric models derived in  2 .",
    "the 20,000 simulated ccd observations analyzed in figs .",
    "[ fig1 ] and [ fig2 ] were _ reanalyzed _ with @xmath0 using an oversampled _ discrete _ gaussian psf with a @xmath149 of 3.0 @xmath121 .",
    "figure  [ fig3 ] shows the resultant absolute photometric errors and total astrometric errors .",
    "figure  [ fig4 ] shows the resultant relative errors for @xmath68 and @xmath117 .",
    "notice how similar figs .",
    "[ fig1 ] and [ fig3 ] and figs .",
    "[ fig2 ] and [ fig4 ] are to each other .    despite the very different way the shape information of the psf was encoded ( i.e. , _ discrete _ versus _ analytical _ representations )",
    ", @xmath0 produced nearly identical photometric and astrometric results .",
    "how similar are the measured stellar positions ?",
    "figure  [ fig5 ] shows the _ relative _ @xmath117 and @xmath127 position",
    "_ differences _ between the previous analytical and numerical analyses with the @xmath0 code .",
    "the _ top _",
    "panel shows the difference between the numerical @xmath117 result and the analytical @xmath117 result divided by the estimated error of the analytical result .",
    "similarly , the _ bottom _ panel shows the difference between the numerical @xmath127 result and the analytical @xmath127 result divided by the estimated error of the analytical result .",
    "the relative differences between the numerical and analytical methods are _ not _ normally distributed  observe how much smaller the values on the ordinate of fig .",
    "[ fig5 ] are compared to those of figs .",
    "[ fig2 ] and [ fig4 ] .",
    "[ fig2 ] and [ fig4 ] _ are _ normally distributed and the source of the scatter is photon noise .",
    "figure  [ fig5 ] indicates that the relative differences between the numerical and analytical methods for astrometry are less than one - fifteenth the difference due to photon noise . in other words , _ the computational noise due to the chosen analysis method ( numerical versus analytical ) is insignificant when compared to the unavoidable photon noise due to the random arrival of photons in any astronomical ccd observation . _    * the @xmath0 code works as well with oversampled discrete gaussian psfs as it does with oversampled analytical gaussian psfs .      while the volume , @xmath70 , of the prf was carefully tracked throughout the derivation of the photometric and astrometric performance models in  2 , all previous simulations have assumed a perfect detector @xmath183 .",
    "let us now check to see if the effects of a prf volume integral that is less than one has been correctly accounted for in the performance models of  2 by analyzing simulated observations imaged on a very inefficient detector @xmath184 .",
    "twenty thousand oversampled ccd stellar observations were simulated assuming a very inefficient detector with @xmath185 .",
    "stars were simulated using a discrete gaussian psf with a @xmath155 @xmath121 located near the center of 60@xmath5760 pixels , the input stellar intensities ranged from @xmath186 to @xmath157 mag ( @xmath187 to @xmath77 @xmath5 ) ; and the _ observed _ background sky level was assumed to be a constant value of @xmath188 @xmath6 ( @xmath189 @xmath5 , @xmath190 ) all other simulation parameters were the same as before .    all the simulated observations were analyzed with @xmath0 in the same way as described for the numerical experiment shown in fig .",
    "[ fig3 ]  except that the volume of the prf was set to @xmath191 in order to simulate the use of an inefficient detector which converts only @xmath2011.1% of photons to electrons .",
    "figure  [ fig6 ] shows the absolute photometric errors and total astrometric errors of this numerical experiment .",
    "the median effective - background area of prf of these observations was @xmath192 @xmath166 which is , as expected , 81 @xmath193 times larger than the median value reported in fig .",
    "[ fig3 ] .    comparing the simulation results with the grey theoretical limits",
    ", one sees that the photometric and astrometric performance of the @xmath0 code is very well predicted by the theoretical performance models given in  2 .",
    "the black dash - dot curves in each panel of fig .",
    "[ fig6 ] shows the expected median response with a perfect detector ; these curves are the same as the solid grey median curves found in fig .",
    "the _ observed _ stellar intensities and observed background sky level are nine times fainter than was seen in the numerical experiment shown in fig .",
    "[ fig3 ] and the median photometric and astrometric errors in fig .",
    "[ fig6 ] are , as expected , @xmath203 @xmath194 times larger when the inefficient detector is used .    * the @xmath0 code and the theoretical performance models work well with prfs that have volumes of less than one .",
    "twenty thousand _ undersampled _ ccd stellar observations were simulated using an analytical gaussian with a @xmath195 @xmath121 , the other simulation parameters were the same as given in  5.1.1 .",
    "the median effective - background area of prf of these observations was @xmath196 @xmath166 @xmath183 .",
    "all the simulated observations were analyzed with @xmath0 using a _",
    "discrete _ gaussian psf with @xmath195 @xmath121 .",
    "figure  [ fig7 ] shows the absolute photometric errors and total astrometric errors of this numerical experiment . while the photometric and astrometric results for stars with @xmath197 @xmath6 are fine , the results for stars brighter than that limit are seen to quickly degrade in accuracy with the brightest stars having median errors that are @xmath2040 times worse than expected .    what starts going wrong at @xmath198 @xmath6 ?",
    "figure  [ fig8 ] shows a one pixel wide slice through a pixel - centered discrete gaussian psf with @xmath199 @xmath121 that was shifted half of a pixel in @xmath200 to the right using damped sinc function given in equation ( [ eq : dampedsinc ] ) .",
    "the dashed black curve looks fine , but when expanded by a factor of 100 , one sees that _ negative side lobes have been created _ due to the fact that the nyquist - shannon sampling theorem has been violated .",
    "doing a sinc interpolation ( damped or otherwise ) on undersampled data is never a good idea  the `` ringing '' seen in fig .",
    "[ fig8 ] is a classic signature of an edge that is too sharp to be adequately expressed with the limited spatial information contained in an undersampled observation .",
    "the biggest negative side lobe of the shifted psf has a value of about @xmath2010.0006 .",
    "although that may seem to be a small value compared to the total volume integral of one , it is actually quite disastrous because _ negative psf values have no physical meaning_.    it is now clear what has gone wrong for stars with @xmath202 @xmath6 . at stellar intensity values",
    "greater than 17,000 electrons , the intensity - scaled undersampled psf models can have negative side lobes that are larger than the rms observed background sky noise level @xmath203@xmath2010.0006@xmath204 . at stellar intensity values",
    "greater than 167,000 electrons , the observational models have physically nonsensical _ negative sky values_.    * aliasing ( ringing ) effects will generally only be seen with bright stars since a large number of photons are required in order to adequately sample the higher spatial frequencies of a psf .",
    "* fitting undersampled observations of bright stars with undersampled psfs results in poor photometry and astrometry .",
    "a supersampled psf is a psf with pixels that have greater spatial resolution ( higher spatial frequencies ) than the actual pixels in the observational data .",
    "for example , a 2@xmath572 supersampled psf uses 4 pixels to describe every physical pixel of the ccd observation ; each supersampled pixel has twice the spatial resolution of the actual pixels in the observation .",
    "twenty thousand _ undersampled _ ccd stellar observations were simulated using an analytical gaussian with a @xmath195 @xmath121 ; the other simulation parameters were the same as before .",
    "all the simulated observations were analyzed with @xmath0 using a 2@xmath572 _ supersampled _ discrete gaussian psf with @xmath195 @xmath121 ( @xmath205 @xmath166 ; @xmath206 ) .",
    "figure  [ fig9 ] shows the absolute photometric errors and total astrometric errors of this numerical experiment . by providing @xmath0 with extra information , in the form of a supersampled psf ,",
    "the nyquist - shannon sampling theorem was no longer violated and excellent photometry and astrometry was done with this undersampled data set .",
    "figure  [ fig10 ] shows the relative errors for @xmath68 and @xmath117 .",
    "the relative stellar intensity errors are normally distributed .",
    "however , the relative @xmath117 position errors are almost , but not quite , normally distributed .",
    "the @xmath0 code is accurately measuring the stellar positions ( i.e. , the median difference , @xmath207 , values are zero ) but the rms position error estimates ( @xmath180 ) are slightly _ underestimated _ ( the top and bottom whiskers for @xmath208 @xmath6 are seen to extend beyond the grey bands ) . the same effect is seen with @xmath127 . using a higher - resolution supersampled psf ( 3@xmath573 , 4@xmath574 , @xmath209 ) does not eliminate the small underestimation by @xmath0 of position errors .",
    "_ the position errors estimated by @xmath0 are close to the photonic limit , but the actual errors  for undersampled observations  are close to the astrometric crlb with square ccd pixels _ @xcite .",
    "* accurate and precise ccd stellar photometry and astrometry may be obtained with undersampled ccd observations if supersampled psfs are used during the psf - fitting process .",
    "let us now investigate what happens when critically - sampled data is fit with a critically - sampled psf .",
    "twenty thousand _ critically - sampled _",
    "ccd stellar observations were simulated using an analytical gaussian with a @xmath210 @xmath121 ; the other simulation parameters were the same as before .",
    "all the simulated observations were analyzed with @xmath0 using a _ critically - sampled _ discrete gaussian psf with @xmath210 @xmath121 ( @xmath211 @xmath166 ; @xmath206 ) .",
    "figure  [ fig11 ] shows the absolute photometric errors and total astrometric errors of this numerical experiment .",
    "figure  [ fig12 ] shows the relative errors for @xmath68 and @xmath117 .",
    "looking carefully at figs .",
    "[ fig11 ] and [ fig12 ] , one sees that the photometric and astrometric performance is well matched to the theoretical expectations except for the brightest three bins ( @xmath212 @xmath6 ) .",
    "twenty thousand _ critically - sampled _",
    "ccd stellar observations were simulated using an analytical gaussian with a @xmath210 @xmath121 ; the other simulation parameters were the same as before .",
    "all the simulated observations were analyzed with @xmath0 using a 2@xmath572 _ supersampled _ discrete gaussian psf with @xmath210 @xmath121 ( @xmath211 @xmath166 ; @xmath206 ) .",
    "figure  [ fig13 ] shows the absolute photometric errors and total astrometric errors of this numerical experiment .",
    "figure  [ fig14 ] shows the relative errors for @xmath68 and @xmath117 .",
    "the photometric and astrometric performance is well matched to the theoretical expectations for all stellar intensities .",
    "comparing fig .",
    "[ fig7 ] with fig .",
    "[ fig9 ] and fig .",
    "[ fig11 ] with fig .",
    "[ fig13 ] , one sees that one can obtain excellent stellar photometry and astrometry with the matphot algorithm for all stellar intensities  even if the observational data is undersampled  as long as the discrete psfs used to do the model fitting are sampled finely enough to have sufficient spatial frequency coverage such that the nyquist - shannon sampling theorem is not violated .    comparing fig .",
    "[ fig3 ] with fig .",
    "[ fig11 ] , one sees that the breakpoint for the matphot algorithm between undersampled and oversampled data is @xmath213 @xmath166 or , in terms of a gaussian full - width - at half maximum , @xmath214 @xmath121 .    *",
    "if a discrete psf is close to being critically sampled , then one should use a supersampled discrete psf which is oversampled in terms of supersampled pixels @xmath215 .",
    "in other words , _ if the equivalent - background area is less than 21 square pixels ( @xmath216 @xmath166 ; gaussians : @xmath217 @xmath121 ) , then one should use a supersampled discrete psf which has an equivalent - background area of at least 21 square supersampled pixels ( @xmath218 @xmath219 ; gaussians : @xmath220 @xmath221 ) . _      let us now investigate the photometric and astrometric performance of the matphot algorithm with an ugly ( realistic ) space - based psf .",
    "figure  [ fig15 ] shows a simulated _ next generation space telescope _ ( _ ngst _ ) @xmath222-band ccd stellar observation .",
    "this simulated observation used a 2@xmath572 supersampled psf which was based on a 8-meter trw - concept @xmath223 diffraction - limited primary mirror with 1/13 wave rms errors at @xmath223 ; the original version of the psf was kindly provided by john krist ( stsci ) . the six - sided `` snowflake '' pattern seen in fig .",
    "[ fig15 ] is mainly due to fact that the primary mirror is composed of segmented hexagonal - shaped mirrors .",
    "observers will note that this psf is very similar to optical psfs seen with the 10-m telescopes at the w. m. keck observatory .",
    "the 6.5-m _ james webb space telescope _",
    "( _ jwst _ ) is likely to have similar looking near - infrared psfs once it achieves first light in @xmath202011 .    the _ ngst _ psf is so complicated that it is unlikely that it could be represented adequately with a continuous analytical mathematical function .",
    "space - based observations frequently have high spatial frequencies which make them ideal candidates for photometric and astrometric analysis using discrete psfs .",
    "twenty thousand ccd stellar observations were simulated using the simulated @xmath222-band _ ngst _",
    "2@xmath572 supersampled psf described above ; the other simulation parameters were the same as before .",
    "all the simulated observations were analyzed with @xmath0 with the psf used to create the simulated observations .    figure  [ fig16 ] shows the absolute photometric errors and total astrometric errors of this numerical experiment .",
    "figure  [ fig17 ] shows the relative errors for @xmath68 and @xmath117 .",
    "the photometric and astrometric performance is well matched to the theoretical expectations for all stellar intensities .",
    "although only gaussian psfs were used in previous numerical experiments , the excellent fit seen in the top panel of fig .",
    "[ fig16 ] between the theoretical photometric performance model (  2.3.4 ) and actual @xmath0 measurements using such an ugly discrete psf is not surprising once one remembers that the theoretical photometric performance model was derived from an abstract point response function .",
    "the development of the theoretical astrometric performance model , however , required differentiation of the point response function which i assumed to be an oversampled analytical gaussian function .",
    "the analytical gaussian bright star astrometric limit was transformed to the general form by assuming that the gaussian - specific @xmath224 term could be replaced with the more general @xmath225 term , which , by definition , can be computed for any prf .",
    "the same assumption was then used to derive the general faint star astrometric limit .",
    "the excellent fit seen in the bottom panel of fig .",
    "[ fig16 ] indicates that this bold assumption is not only useful but practical .",
    "many numerical experiments with very ugly discrete psfs have shown that the theoretical astrometric performance model of  2.4.4 works well with ugly discrete point response functions .",
    "if the matphot algorithm is optimally extracting photometric and astrometric information from a stellar observation , _ and _ @xmath0 has been correctly coded , _ and _ the ccd observation has been properly calibrated , _ and _ the prf used in the observational model is correct , _ and _ accurate estimates of the measurements errors for each pixel have been made , _ then _ one expects that the @xmath59 goodness - of - fit value reported by @xmath0 to be distributed as a @xmath59 distribution with the number of degrees of freedom equal to the difference between the number of pixels in the observation and the number of free parameters .",
    "figure [ fig18 ] shows that this prediction about the precision and accuracy of the matphot algorithm has been verified : the cumulative distribution of the @xmath59 reported by @xmath0 ( _ thin black curve _ ) is seen to lie on top of the cumulative @xmath59 distribution of for 3596 [ @xmath226 @xmath227 pixels @xmath201 4 free parameters @xmath228 , @xmath117 , @xmath127 , and @xmath229 degrees of freedom ( _ thick grey curve _ ) .",
    "* the @xmath0 code works well with ugly discrete psfs and its performance can be well predicted using the general theoretical photometric and astrometric performance models given in  2 . *",
    "the @xmath59 goodness - of - fit value reported by @xmath0 is a statistically reliable measure of the quality of a photometric and astrometric reduction of a stellar observation obtained with the matphot algorithm using ugly discrete psfs .",
    "let us now investigate the photometric and astrometric performance of the matphot algorithm with an ugly psf and an ugly detector .",
    "suppose one has a detector where every pixel has been divided up into 16 square regions called `` subpixels '' .",
    "let us call the first row and first column of subpixels `` gate structures '' which are optically inactive with 0% qe . the remaining 9 subpixels are the optically active part of the pixel with a 100% qe .",
    "by definition , such a pixel would have a very large intrapixel qe variation with only 56.25% of the total pixel area being capable of converting photons to electrons .",
    "a few extra lines of code were added to the @xmath0 program to simulate the image formation process with such an ugly detector .",
    "the new version of @xmath0 is called @xmath230 and was designed specifically for use with 4@xmath574 supersampled psfs .    ten thousand ccd stellar observations of @xmath231 mag stars ( @xmath20@xmath232 @xmath5 ) were simulated and analyzed with @xmath230 using a 4@xmath574 supersampled version of the simulated @xmath222-band _ ngst _ psf described above .",
    "the _ observed _ background level was assumed to be a constant value of @xmath233 @xmath6 ( @xmath189 @xmath5 , @xmath234 ) and all other simulation parameters were the same as before .",
    "the measured prf volume of these simulated observations was @xmath235 which is consistent with the expected value of 0.5625 from the physical structure of a single pixel .",
    "the median and semiquartile range of the effective - background area @xmath236 of these observations was , respectively , 28.10 and 4.82 @xmath237 .",
    "the median critical - sampling scale length of these observations was @xmath238 @xmath121  indicating that these observations were _ undersampled _ , as expected .",
    "the optically inactive gate structures of the pixel cause the observed number of electrons in each stellar image to be significantly less than the number of photons which fell on the detector . _",
    "the total amount of loss was dependent on where the center of the star fell within the central pixel of the stellar image .",
    "_ figure  [ fig19 ] shows that stars centered in the middle of the active area of a pixel suffered a @xmath2040% loss ( @xmath239 mag ) while those centered on gate structures _ ( grey points ) _ lost up to 47% ( @xmath240 mag ) .",
    "although this numerical experiment may seem to be very artificial , large intrapixel sensitivity variations can be found in cameras currently installed on the _ hubble space telescope_. @xcite reported peak - to - peak variations of 0.39 mag at the @xmath241 band ( f110w ) and 0.22 mag at the @xmath242 band ( f160w ) of the nic3 camera of the _ hst _ nicmos instrument .",
    "the peak - to - peak variation of @xmath200.2 mag at f160w with nic 3 was independently confirmed by @xcite .",
    "the mean _ observed _ stellar magnitude for these @xmath231 mag stars was @xmath243 mag .",
    "the photometric performance model predicts an rms measurement error of @xmath244 mag for these bright stars . with an average loss of 44% and an rms measurement error that is _ ten times larger _ than expected from photon statistics , the observed stellar magnitudes were neither precise or accurate .",
    "figure [ fig20 ] shows that @xmath230 was able to do an excellent job in recovering the true stellar magnitude of the 10,000 @xmath231 mag stars  despite being presented with a worst - case scenario of undersampled observations with an ugly psf imaged on an ugly detector with a very large intrapixel qe variation .",
    "the mean _ measured _ stellar magnitude reported by @xmath230 was @xmath245 mag and the mean rms error estimated by @xmath230 was @xmath246 mag .",
    "the photometric performance of @xmath230 is fully consistent with theoretical expectations  which were derived for an ideal detector with no intrapixel qe variation .",
    "twenty thousand ccd stellar observations were simulated and analyzed with @xmath230 using the same 4@xmath574 supersampled version of the simulated @xmath222-band _ ngst _ psf .",
    "the input stellar intensities ranged from @xmath156 to @xmath157 mag ( @xmath247 to @xmath77 @xmath5 ) .",
    "the observed background level was assumed to be a constant value of @xmath233 @xmath6 ( @xmath189 @xmath5 , @xmath234 ) and all other simulation parameters were the same as before .",
    "the median and semiquartile range of the effective - background area @xmath236 of these observations was , respectively , 28.04 and 4.77 @xmath237 .",
    "figure  [ fig21 ] shows the absolute photometric errors and total astrometric errors of this numerical experiment . comparing the simulation results with the grey theoretical limits",
    ", one sees that the photometric and astrometric performance of the @xmath230 code is well predicted by the theoretical performance models given in  2 .    *",
    "excellent stellar photometry and astrometry is possible with ugly psfs imaged onto ugly detectors as long as the image formation process _ within the detector _ is accurately modeled by the photometric reduction code .",
    "after developing theoretical photometric and astrometric performance model for point spread function ( psf)-fitting stellar photometry , i described the unique features of the matphot algorithm for accurate and precise stellar photometry and astrometry using discrete point spread functions .",
    "i conducted numerical experiments with the @xmath0 implementation of the matphot algorithm and demonstrated that the computational noise due to the chosen analysis method ( numerical versus analytical ) is insignificant when compared to the unavoidable photon noise due to the random arrival photons in any astronomical ccd observation .",
    "the matphot algorithm was specifically designed for use with space - based stellar observations where psfs of space - based cameras frequently have significant amounts of power at higher spatial frequencies .",
    "using simulated _ ngst _ ccd observations , i demonstrated millipixel relative astrometry and millimag photometry is possible with very complicated space - based discrete psfs .",
    "the careful reader will observe that i have not discussed _ how _ a discrete psf is derived .",
    "the matphot algorithm will optimally determine the brightness and position of a star in a ccd observation when provided with the correct psf and drf  functions which need to be determined _ beforehand _ through calibration procedures .",
    "photometric and astrometric accuracy and precision degrades if either the psf or drf is poorly known .",
    "psf reconstruction ( calibration ) is a complicated topic in its own right and has been the subject of many articles , instrumentation reports , and entire workshops .",
    "the challenges of psf reconstruction are many .",
    "an astronomer may be faced with trying to derive a psf from an observation    * with a variable psf within the field of view , * that has too few bright stars , * that might be undersampled , * that might be poorly dithered , * that might be poorly flat - fielded , * that exhibits significant charge transfer efficiency variations , * that has variable charge diffusion within the ccd substrate , * with significant photon loss due to charge leakage , * that might not actually be linear below the 1% level .    while many of these problems can be overcome by the proper design of instruments or experiments , their solution is beyond the scope of this article which has sought to determine the practical limits of psf - fitting stellar photometry .",
    "the analysis presented in this article has assumed that psfs are perfectly known  a situation that is rarely , if ever , physically possible .",
    "the _ cores _ of observationally based psfs are generally much better determined than the broad _ wings _ due to simple photon statistics",
    ". the effect of large instrumental calibration errors can also be significant .",
    "for example , flat - field limitations can dramatically impact the achievable levels of photometric and astrometric precision .",
    "an investigation based on theory of the effect of psf errors and flat - field calibration error on the limits of psf - fitting stellar photometry would be very difficult .",
    "an investigation based on numerical experiments , however , might be a much more tractable proposition . in any case ,",
    "a through investigation of the effects of calibration errors on the limits of psf - fitting stellar photometry is best left to another article .",
    "i would like to thank the anonymous referee whose careful reading and insightful comments have improved this article .",
    "special thanks are due to ian roederer who checked all of the mathematical proofs in an early draft of the manuscript .",
    "jessica moy has my heartfelt thanks for cheerfully helping me acquire copies of many articles in technical journals that are not available in the noao library collection .",
    "i would also like to thank the following people for providing stimulating conversations , encouragement , and support during the extensive research and development effort behind the creation of the matphot algorithm and and its various software implementations : joseph bredekamp , susan hoban , dot appleman , taft armandroff , nick buchholz , marc buie , harvey butcher , julian christou , chuck claver , lindsey davis , michele de le pea , mike fitzpatrick , ken freeman , dan golombek , richard green , steve howell , george jacoby , buell jannuzi , stuart jefferies , ivan king , john krist , todd lauer , john mackenty , john mather , mike merrill , dave monet , mark morris , jeremy mould , jan noordam , john norris , sudhakar prasad , the late alex rogers , steve ridgway , pat seitzer , james schombert , donald west , and sidney wolff .",
    "this research has been supported in part by the following organizations , institutions , and research grants ( in reverse chronological order ) : national aeronautics and space administration ( nasa ) , interagency order no .",
    "s-13811-g , which was awarded by the applied information systems research program ( nra 01-oss-01 ) of nasa s science mission directorate , interagency order no .",
    "s-67046-f which was awarded the long - term space astrophysics program ( nra 95-oss-16 ) of nasa s office of space science , center for adaptive optics ( cfao ) , institute for pure and applied mathematics ( ipam ) , kitt peak national observatory , national optical astronomy observatory , association of universities for research in astronomy inc .",
    "( aura ) , national science foundation , mount stromlo and siding spring observatories , australian national university , the netherlands foundation for astronomical research ( astron ) , and the netherlands organization for the advancement of pure research ( zwo ) , and the kapteyn astronomical institute of groningen .    99    abramowitz , m. , & stegun , i. 1964 , handbook of mathematical functions with formulas , graphs , and mathematical tables , applied mathematics series , 55 , eds .",
    "m.  abromowitz and i.  stegun ( washington , d.c .",
    ": nbs )    arfken , g.  b. 1970 , mathematical methods for physicists , 2nd ed .",
    ", ( new york : academic press )    biretta , j. , et al .",
    "2001 , wfpc2 instrument handbook , version 6.0 ( baltimore : stsci )    hook , r.n . , & fruchter , a.s .",
    "2000 , in asp conf .",
    "216 , astronomical data analysis software and systems ix , eds .",
    "n. manset , c. veillet , and d. crabtree ( san francisco : asp ) , 521    irwin , m.j .",
    "1985 , mnras , 214 , 575    , p. , greenfield , p. , & jedrzejewski , r. 1992 , a&a , 253 , 329    king , i.r . 1971 ,",
    "pasp , 83 , 199    king , i.r .",
    "1983 , pasp , 95 , 163    lauer , t.r . 1999 ,",
    "pasp , 111 , 1434    levenberg , k. 1944 , q.  app .",
    ", 2 , 164    marquardt , d. 1963 , j.  siam , 11 , 431    mighell , k.  j. 1989 , mnras , 238 , 807    mighell , k.  j. 1999 , in asp conf . ser .",
    "172 , astronomical data analysis software and systems viii , eds.d .",
    "m.  mehringer , r.  l.  plante , and d.  a.  roberts ( san francisco : asp ) , 317    mighell , k.  j. 2002 , in proceedings of spie , vol .  4847 , astronomical data analysis ii , eds .",
    "starck and f.  d.  murtagh ( bellingham , wa : spie ) , 207    pogson , n. 1856 , mnras , 17 , 12 , m.  a.  c , jakobsen , p. , colina , l. , lelievre , g. , macchetto , f. , nieto , j.  l. , & di serego alighieri , s. 1989 , a&a , 215 , 195 press , w.  h. , flannery , b.  p. , teukolsky , s.  a. , & vetterrling w.  t. 1986 , numerical recipes .",
    "the art of scientific computing ( cambridge : cambridge university press )    tukey , j. w. 1977 , exploratory data analysis , ( reading , ma : addison - wesley )    wells , d.  c. , greisen , e.  w. , & harten , r.  h. 1981 , a&as , 44 , 363    winick , k.  a. 1986 , josa a , 3 , 1809",
    "a box - and - whisker plot ( a.k.a . _ box plot _ ) is a graphical method of showing a data distribution .",
    "a box is drawn showing the inner quartile range of the data which , by definition , includes half of all the data values ( see fig .",
    "[ figa1 ] ) .",
    "median _ of the data is shown with a bar inside the box .",
    "the bottom end of the box is the lower quartile ( 25% ) of the data ; @xcite , the creator of the box - and - whiskers plot , calls this value the _ lower hinge _ , @xmath248 , value .",
    "the top end of the box is the upper quartile ( 75% ) of the data which is called the _ upper hinge _ , @xmath249 , value .",
    "the _ step _",
    "value is 1.5 times the inner quartile range : @xmath250 .",
    "the _ top fence _",
    "value is the sum of the upper hinge and step values : @xmath251 . the _ bottom fence _",
    "value is the difference between the lower hinge and step values : @xmath252 .",
    "the _ top whisker _ is drawn from the upper hinge value to the largest data value that is less than or equal to the top fence value : @xmath253 .",
    "similarly , the _ bottom whisker _ is drawn from the lower hinge value to the smallest data value that is greater than or equal to the bottom fence value : @xmath254 .",
    "data values that are greater than the top fence value or less than the bottom fence value are called _ outliers _ and are plotted at their appropriate value beyond the whiskers . for a normal distribution , which is a gaussian distribution with a mean of zero and a standard deviation of one ,",
    "the bottom fence , bottom hinge , median , top hinge and top fence values are , respectively , @xmath2012.6980 ( 0.35% cumulative fraction ) , @xmath2010.6745 ( 25% ) , zero ( 50% ) , 0.6745 ( 75% ) , 2.6980 ( 99.65% ) .",
    "figure  [ figa1 ] shows a data set of 1000 normal deviates .",
    "the histogram of the data with 0.1-wide bins is shown with thin black lines .",
    "the cumulative fraction distribution of the data is shown as a thick gray curve .",
    "the box - and - whisker plot of the data is shown with thick black lines below the histogram ; arrows show the relationship between various box values and the cumulative fraction distribution .",
    "the mean and standard deviation of this data set are , @xmath2010.0341 and 0.9739 , respectively . the bottom fence , bottom whisker , bottom hinge , median , top hinge , top whisker , and top fence values of this data set are , respectively , @xmath2012.5511 ( 0.25% cumulative fraction ) , @xmath2012.4940 ( 0.30% ) , @xmath2010.6522 ( 25.10% ) , @xmath2010.0231 ( 50.00% ) , 0.6137 ( 75.10% ) , 2.4580 ( 99.50% ) , 2.5126 ( 99.57% ) .",
    "the seven outlier values of this data set , @xmath2012.9500 , @xmath2012.6320 , 2.5390 , 2.7150 , 2.7430 , 2.8270 , 2.8530 , are plotted in fig .  [ figa1 ] as diamonds beyond the whiskers ."
  ],
  "abstract_text": [
    "<S> the key features of the matphot algorithm for precise and accurate stellar photometry and astrometry using discrete point spread functions are described . a discrete point spread function ( psf ) </S>",
    "<S> is a sampled version of a continuous psf which describes the two - dimensional probability distribution of photons from a point source ( star ) just above the detector . </S>",
    "<S> the shape information about the photon scattering pattern of a discrete psf is typically encoded using a numerical table ( matrix ) or a fits image file . </S>",
    "<S> discrete psfs are shifted within an observational model using a 21-pixel - wide damped sinc function and position partial derivatives are computed using a five - point numerical differentiation formula . </S>",
    "<S> precise and accurate stellar photometry and astrometry is achieved with undersampled ccd observations by using supersampled discrete psfs that are sampled 2 , 3 , or more times more finely than the observational data . </S>",
    "<S> the precision and accuracy of the matphot algorithm is demonstrated by using the c - language @xmath0 code to analyze simulated ccd stellar observations ; measured performance is compared with a theoretical performance model . </S>",
    "<S> detailed analysis of simulated _ next generation space telescope  _ observations demonstrate that millipixel relative astrometry and millimag photometric precision is achievable with complicated space - based discrete psfs .    </S>",
    "<S> [ firstpage ]    techniques : image processing , photometric  astrometry  instrumentation : detectors  methods : analytical , data analysis , numerical , statistical </S>"
  ]
}