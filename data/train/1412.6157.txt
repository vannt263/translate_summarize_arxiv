{
  "article_text": [
    "in this work , we study the diffusion of epidemics over an undirected graph @xmath0 with edge set @xmath1 and node set @xmath2 .",
    "the order of @xmath3 , denoted @xmath4 , is the cardinality of @xmath2 , whereas the size of @xmath3 is the cardinality of @xmath1 , denoted @xmath5 .",
    "connectivity of the graph @xmath3 is conveniently encoded in the @xmath6 adjacency matrix @xmath7 .",
    "we are interested in the case of networks that can be naturally partitioned into @xmath8 communities : they are represented by a node set partition @xmath9 , i.e. , a sequence of mutually disjoint nonempty subsets of @xmath2 , called cells , whose union is @xmath2 .",
    "the epidemic model adopted in the rest of the paper is a continuous - time markovian individual - based ( sis ) model . in the sis model",
    "a node can be repeatedly infected , recover and yet be infected again .",
    "the viral state of a node @xmath10 , at time @xmath11 , is thus described by a bernoulli random variable @xmath12 , where we set @xmath13 if @xmath10 is healthy and @xmath14 if @xmath10 is infected . .",
    "each node becomes infected following a poisson process with rate @xmath15 .",
    "also , @xmath10 recovers following a poisson process with rate @xmath16 .",
    "we further assume that infection and curing processes are independent  @xcite .",
    "the ratio @xmath17 is called the _ effective spreading rate_.    recently , also non markovian types of epidemic spread were introduced in the literature , by choosing other than the exponential interaction time for infection and/or curing ( see @xcite ) . however , this seems to complicate the analysis considerably and .",
    "compared to the homogeneous case where the infection rate is the same for all pairs of nodes , in our model we consider two infection rates : the _ intra - community _ infection rate @xmath15 for infecting individuals in the same community and the _ inter - community _ infection rate @xmath18 i.e. , the rate at which individuals among different communities get infected .",
    "as described in  @xcite , the sis process developing on a graph with @xmath4 nodes is modeled as a continuous - time markov process with @xmath19 states .",
    "the dynamics of the nodal infection probability is obtained by the corresponding kolmogorov differential equations , but the resulting dynamical system consists of @xmath19 linear differential equations , not a viable approach for large networks . .",
    "in this work we consider the first - order mean - field approximation nimfa , proposed by van mieghem et al . in  @xcite .",
    "nimfa replaces the original @xmath19 linear differential equations by @xmath4 non - linear differential equations ; they represent the time - change of the infection probability of a node .",
    "as typical in first - order approximations of sis dynamics , the only approximation required by nimfa is that the infectious state of two nodes in the network are uncorrelated , i.e. , @xmath20 .      for a network with finite order @xmath4 , the exact sis markov process will always converge towards its absorbing state , .    .",
    "for this reason the literature is mainly concerned with establishing the value of the epidemic threshold , being a key parameter behind immunization strategies related to the network protection against viral infection .    for an sis process on graphs",
    ", @xmath21 depends on the spectral radius @xmath22 of the adjacency matrix @xmath7 @xcite .",
    "nimfa determines the epidemic threshold for the effective spreading rate as @xmath23 , where the superscript ( 1 ) refers to the first - order mean - field approximation @xcite .",
    "as already observed in @xcite , the presence of communities generates a strong mixing effect at local level ( e.g. , the rate of infection inside a community tends to be homogeneous ) as opposed to the much lower speed of mixing ( i.e. , much larger inhomogeneity ) within the whole population . in @xcite",
    "a complete graph represents the internal structure of each community .",
    "such assumption appears natural for small community orders , for example , because the members of a small community usually know each other , as they may be friends , relatives , members of a common club , employees of the same department , etc .",
    "moreover , given two connected communities , all of their nodes are mutually linked .    in this work , instead , more precisely we consider an _ equitable partition _ of the graph .",
    "first of all this means that all nodes belonging to the same community have the same internal degree : formally the subgraph @xmath24 of @xmath25 induced by @xmath26 is regular for all @xmath10 s ( recall that @xmath9 is a partition of the node set @xmath2 , which is assumed to be given a priori ) .",
    "furthermore , for any two subgraphs @xmath27 , each node in @xmath24 .",
    "the macroscopic structure of such a network can be described by the _ quotient graph _ @xmath28 , an oriented graph ( possibly ) featuring loops and multiple edges .",
    "the nodes of the quotient graph are the cells @xmath29 in @xmath3 .",
    "that does not require any structural condition inside .",
    "such network structure can be observed , e.g. , in the architecture of some computer networks where clusters of clients connect to single routers , whereas the routers network has a connectivity structure with nodes degree constrained by the number of ports .",
    "also , graphs representing multi - layer networks may be characterized using equitable and almost equitable partitions @xcite .",
    "thus , a relation between the epidemic threshold and the spectral properties of the corresponding quotient matrix is obtained .    in sec .",
    "[ almeq ] we finally extend our investigations to the case of almost equitable partitions .",
    "we consider the special case of almost equitable partitions obtained by perturbing an equitable one , i.e. , by adding / deleting a certain set of edges from an equitable partition .",
    "thus , we relax the assumption that the internal structure of each community is regular . even in this case",
    "we obtain a lower bound for the epidemic threshold .",
    "thus , node @xmath10 obeys a following differential equation  @xcite @xmath30 in the time - derivative of the infection probability of node @xmath10 consists of two competing processes :    1 .   while healthy with probability @xmath31 , all infected neighbors , whose average number is @xmath32 , infect node @xmath10 at rate @xmath15 .",
    "while node @xmath10 is infected with probability @xmath33 , it is cured at rate @xmath16 .",
    "@xmath34 where @xmath35 , @xmath36 is the diagonal matrix with elements @xmath37 and @xmath38 is the all - one vector . from , considering @xmath39 , we can write @xmath40    , @xmath41 with @xmath22 spectral radius of @xmath7 .",
    "this critical value separates the absorbing phase from the endemic phase .",
    "we shall prove this , in thm [ thresh ] , by studying the stability of the equilibrium points of , that are solutions of the equation @xmath42 to this aim we shall adapt the results in @xcite to our individual - based sis model .",
    "let us denote by @xmath43 the right hand side of , i.e. , can be re - written as a vector - valued differential equation @xmath44 where @xmath45^n\\rightarrow \\mathbb{r}^n$ ] is a @xmath46 function .",
    "let @xmath47 be the vector of all zero components , one can easily check that @xmath48 is an equilibrium point of the system ( [ f ] ) , i.e. @xmath49 . also , the following holds    [ thresh ] if @xmath50 then @xmath48 is a globally asymptotically stable equilibrium of ( [ mat2 ] ) .",
    "+ if @xmath51 , @xmath48 is unstable and there exists another equilibrium point @xmath52 that is globally asymptotically stable in @xmath53",
    ".    we can rewrite the system in the following form ( see @xcite ) @xmath54 where @xmath55 is the jacobian matrix of @xmath43 at @xmath48 and @xmath56 is a column vector whose @xmath10-th component is @xmath57 .",
    "from ( [ mat2 ] ) we have@xmath58 that is @xmath59 .",
    "@xmath60 in particular , let @xmath61 , since the spectral radius of @xmath7 is positive we have @xmath62 now we can apply ( * ? ? ?",
    "3.1 ) to the system and assert that when @xmath63 , i.e. , @xmath50 , @xmath48 is a globally asymptotically stable equilibrium of .",
    "conversely , if @xmath64 , i.e. @xmath51 , there exists another equilibrium point @xmath52 . @xmath48 and @xmath52 are the only equilibrium points in @xmath65 and @xmath52 is globally asymptotically stable in @xmath53 .",
    "finally , since @xmath66 , we have @xmath64 .",
    "@xmath48 is an unstable equilibrium point in @xmath67 .",
    "[ [ sec : equi ] ]    the original definition of equitable partition is due to schwenk @xcite .",
    "[ def : eqpart ] let @xmath0 be a graph .",
    "the partition @xmath9 of the node set @xmath2 is called _ equitable _ if , there is an integer @xmath68 such that @xmath69 independently of @xmath70 .",
    "we shall identify the set of all nodes in @xmath26 the @xmath10-th _ community _ of the whole population .",
    "in particular , each @xmath26 induces a subgraph of @xmath3 that is necessarily regular .",
    "[ rem1 ] we use the notation @xmath71 and @xmath72 to denote the least common multiple and greatest common divisor , respectively .",
    "we can observe that the partition of a graph is equitable if and only if @xmath73 where @xmath74 is an integer satisfying @xmath75 and @xmath76 the number of nodes in @xmath26 , for all @xmath77 .",
    "an equitable partition generates the _ quotient graph _ @xmath28 , which is a _ multigraph _ with cells as vertices and @xmath68 edges between @xmath26 and @xmath78 . for the sake of explanation , in the following we will identify @xmath28 ( simple ) graph having the same cells",
    "vertex set , and where an edge exists between @xmath26 and @xmath78 if at least one exists in the original multigraph .",
    "we shall denote by @xmath79 the adjacency matrix of the graph @xmath28 .",
    "[ rem2 ] in @xcite when each community has a clique structure , i.e , @xmath80 for all @xmath81 .",
    "moreover all nodes belonging to two linked communities @xmath10 and @xmath82 are connected , @xmath83 . by considering the theory of equitable partition",
    ", we generalize the cited work and consider any kind of regular graph to represent the internal structure of each community .",
    "moreover , unlike before , if two communities @xmath10 and @xmath82 are connected , each node in community @xmath10 is connected with      for any , @xmath84 implies @xmath85 , i.e. , each node in @xmath26 is connected with every node inside @xmath78 .",
    "we can explicitly write the adjacency matrix @xmath7 in a block form .",
    "let @xmath86 be the adjacency matrix of the subgraph induced by @xmath26 and @xmath87 is an all ones @xmath88 matrix ; then @xmath89    .",
    "such a matrix is the _ quotient matrix _ of the equitable partition . @xmath90 and",
    "@xmath7 have the same spectral radii . as a consequence",
    ", we can compute its spectral radius in order to estimate the epidemic threshold , instead of computing    the quotient matrix @xmath90 can be defined for any equitable partition : in view of the internal structure of a graph with an equitable partition , it is natural to consider the cell - wise average value of a function on the node set , that is to say the projection of the node space into the subspace of cell - wise constant functions .",
    "[ def : proj ] let @xmath0 a graph .",
    "let @xmath91 be any partition of the node set @xmath2 , let us consider the @xmath92 matrix @xmath93 , where @xmath94 the _ quotient matrix _ of @xmath3 ( with respect to the given partition ) is @xmath95    observe that by definition @xmath96 .    in the case of the example in sec .",
    "[ subset : example ] the form of @xmath90 is rather simple : @xmath97 and @xmath98 hence we obtain that @xmath99 where @xmath100 is the internal degree of the subgraph induced by @xmath26 .    in the case of general equitable partitions ,",
    "the expression for @xmath90 writes @xmath101    there exists a close relationship between the spectral properties of @xmath90 and that of @xmath7 .",
    "being the order of @xmath90 smaller of that of @xmath7 , a result in @xcite basically shows that @xmath102 ,    [ cor ] let @xmath0 a graph .",
    "let @xmath91 be an equitable partition of the node set @xmath2 .",
    "the adjacency matrix @xmath7 and the quotient matrix @xmath90 have the same spectral radius , i.e. @xmath103    .        we can write @xmath105 , where @xmath106 and @xmath107 .",
    "@xmath108 @xmath109 @xmath110    in applications , when designing or controlling a network , this value can be adopted to determine a safety region @xmath111 for the effective spreading rate that guarantees the extinction of epidemics .    .",
    "in fact , smaller values of the effective spreading rate @xmath112 , namely @xmath113 , correspond , in the exact stochastic model , to a region where the decay towards the healthy state decreases exponentially fast in time .",
    "let @xmath114 be the average value of the infection probabilities at time @xmath11 of nodes in @xmath115 . then starting from ,",
    "we can write a new system of differential equations @xmath116    now let us denote by @xmath117 the solution of , where @xmath118 and consider the case where @xmath119 i.e. , @xmath120 for all @xmath121 .",
    "then , from , we can easily see that the identically zero function @xmath122 is the unique solution of with initial conditions .",
    "indeed @xmath123 means that for all @xmath124 , @xmath125 for all @xmath126 , @xmath127 .",
    "basically we have shown that the following subset of @xmath65 @xmath128^n | p_1= \\ldots = p_{k_1}= \\overline{p}_1 ,   p_{k_1 + 1}= \\ldots = p_{k_1 + k_2}= \\overline{p_2 } , \\right .",
    "\\nonumber\\\\   \\left .",
    "\\ldots ,   p_{(k_1+ .. k_{n-1}+1)}= \\ldots = p_{n } = \\overline{p}_n\\right\\}\\end{aligned}\\ ] ] is a positively invariant set for the system .",
    "this allows us to reduce the system of @xmath4 differential equations and describe the time - change of the infection probabilities by a system of @xmath8 equations involving the matrix @xmath90 .",
    "indeed , let us consider @xmath129 and @xmath130 , we can write @xmath131 hence , based on thm . 2.1 in @xcite , we observe that @xmath132 this relation in our case brings @xmath133 where the last equality holds because @xmath90 is symmetric .",
    "we can rewrite ( [ eq : red_sys_1 ] ) as @xmath134 where @xmath135 .",
    "the matrix representation of is the following @xmath136 where @xmath137 .",
    "it is immediate to observe that @xmath138 .",
    "[ corsteady ] when @xmath139 the non - zero steady - state @xmath140 of the system belongs to @xmath141 .    moreover ,",
    "since @xmath52 is a globally asymptotically stable equilibrium in @xmath142 , the trajectories starting outside @xmath143 will approach those starting in @xmath144 .",
    "the same holds clearly for trajectories starting in @xmath67 and in @xmath143 when @xmath145 .",
    "numerical experiments in fig .",
    "[ fig : averaged ] depict this fact .",
    "[ [ section ] ]    we focus now on the steady - state of system .",
    "@xmath146    now let @xmath147 and @xmath148 ; relying on the estimate @xmath149 we can express the steady - state average fraction of infected nodes @xmath150 by    @xmath151      in fig .  [",
    "fig : fig11 ] we provide an example of a graph which has an equitable partition with respect to @xmath152 , @xmath153 , @xmath154 , @xmath155 .",
    "the corresponding quotient matrix reads @xmath156      in figures  [ fig : fig2 ] and  [ fig : fig3 ] .",
    "of independent poisson processes for both the infection of healthy nodes and the recovery of infected ones .",
    "we observe that , as expected , nimfa provides an upper bound to the dynamics of the infection probabilities . also , in fig .",
    "[ fig : fig2 ] we observe that the dynamics for the communities that are initially healthy is characterized by a unique maximum for the infection probability , which decreases afterwards .",
    "the communities initially infected , conversely , show a monotonic decrease of the infection probability .    :",
    "simulation versus numerical solutions of ( [ eq : red_sys_3 ] ) ; @xmath157 , with @xmath158 and @xmath159 , . at time @xmath160 the only infected node is node @xmath161.,scaledwidth=75.0% ]    : simulation versus numerical solutions of ( [ eq : red_sys_3 ] ) ; @xmath162 , with @xmath163 and @xmath164 , ; initial conditions as in fig .",
    "[ fig : fig2].,scaledwidth=75.0% ]    a network with eighty nodes partitioned into four communities ; each community is a complete graph and all nodes belonging to two linked communities are connected ( see remark  [ rem2 ] ) .",
    "the agreement between nimfa and simulations improves compared to fig .",
    "[ fig : fig3 ] .",
    "this is expected , because the accuracy of nimfa is known to increase with network order @xmath4 , under the assumption that the nodes degree also increases with the number of nodes .",
    "conversely , it is less accurate , e.g. , in lattice graphs or regular graphs with fixed degree not depending on @xmath4  @xcite .",
    "( -168,120)a )    ( -162,120)b )    ( -220,160)a)(-220,70)b )     ( -120,80)(-1,1)45 @xmath165",
    "[ de : aep ] the partition @xmath9 is called _ almost equitable _ if with @xmath166 , there is an integer @xmath68 such that for all @xmath70 , it holds @xmath167 independently of @xmath70 .",
    "ideally we can think of a network @xmath168 whose node set has an almost equitable partition as a network @xmath3 with equitable partition where links between nodes in one or more communities have been added or removed .    to this aim , let us consider two graphs @xmath0 and @xmath169 with the same partition @xmath170 , but different edge sets @xmath171 , and assume @xmath3 to have an equitable partition but @xmath168 to have merely an almost equitable partition .",
    "then if @xmath172 and @xmath7 are the adjacency matrices of @xmath168 and @xmath3 respectively it holds @xmath173 where @xmath174 ; the dimension of @xmath175 is @xmath176 for @xmath81 , as before @xmath76 is the order of @xmath24 and @xmath8 is the number of the communities .    the theorem of weyl can be applied to @xmath177 and then it yields @xmath178    -communities network .",
    "each community has @xmath179 nodes , whose internal structure is a initially a ring ; the perturbation graph is obtained by adding in each of them the same increasing number of links . the spectral radius of the adjacency matrix @xmath172 is compared to the upper bound as a function of the links added in each community.,scaledwidth=55.0% ]    [ propprop ] let @xmath0 and @xmath169 be two graphs and consider a partition @xmath170 of the set of vertices @xmath2 ; we shall denote by @xmath180 and @xmath181 the subgraph of @xmath3 and @xmath168 induced by the cell @xmath26 , respectively , for @xmath182 .",
    "assume this partition to be equitable for @xmath3 and almost equitable for @xmath168 .",
    "let @xmath183 with @xmath184 ( i.e. , the edge sets can only differ within cells ) and denote by @xmath185 the adjacency matrix corresponding to a graph with @xmath186 as edge set .",
    "finally , let us denote by @xmath187 the graph with edge set @xmath188 and whose node set is simply the set of endpoints of its edges ( i.e. , no further isolated nodes ) .    1 .",
    "if @xmath189 denotes the maximal degree in @xmath187 , @xmath190 , then @xmath191 where @xmath192 is the number of edges added to @xmath24 , i.e. , @xmath193 , and @xmath76 is the number of nodes in @xmath26 .",
    "2 .   if additionally @xmath194 is connected for each @xmath190 , then @xmath195    where @xmath196 is the number of nodes of @xmath187 .",
    "\\(1 ) by assumption , @xmath185 is a diagonal block matrix whose blocks @xmath175 are the adjacency matrices of the induced subgraphs @xmath187 .",
    "thus , @xmath197 is the maximum of all spectral radii @xmath198 . on the other hand",
    ", one has by  ( * ? ? ?",
    "* ( 3.45 ) ) that @xmath199 and the claim follows .",
    "+ ( 2 ) by gershgorin s theorem , the spectral radius of an adjacency matrix is never larger than the graph s maximal degree , i.e. , @xmath200 . by assumption",
    ", there exists a permutation of the vertices in @xmath26 such that the matrix @xmath175 has the form @xmath201 where @xmath202 is the adjacency matrix of a connected graph with @xmath203 nodes ( i.e. , the block @xmath202 has dimension @xmath204 ) .",
    "now , we deduce from  ( * ? ? ? * art .",
    "50 ) that @xmath205 and since @xmath206 , the statement follows .    by using estimate and proposition  [ propprop ] in the first and the second term on the right hand side of  , respectively , we deduce @xmath207 the inequality in ( [ upperalmost ] ) gives us a lower bound for the epidemic threshold in the case of a graph whose partition of nodes set is almost equitable .",
    "actually @xmath208    now let us consider the case where we remove edges , inside the communities , in a network whose set nodes has an equitable partition , thus because the spectral radius of an adjacency matrix is monotonically non increasing under the deletion of edges , we have @xmath209 whence @xmath210",
    "the bounds developed so far support the design of community networks with safety region for the effective spreading rate , that guarantees the extinction of epidemics .",
    "e.g. if we consider some @xmath24 , @xmath211 , it is possible to connect them such in a way to form a graph @xmath169 with an almost equitable partition .",
    "now , any subgraph obtained from @xmath168 , by removing edges inside the communities , will have smaller spectral radius than @xmath168 , and consequently a larger epidemic threshold .",
    "thus the lower bound in still holds .",
    "because the quotient matrix @xmath90 has the same spectral radius of @xmath7 , of @xmath22 and , consequently , of @xmath212 , since the order of @xmath90 is smaller than that of @xmath7 .    that it is possible to reduce the number of equations representing the time - change of infection probabilities using the quotient matrix @xmath90 , when all nodes belonging to the same community have the same initial conditions .",
    "after proving the existence of a positively invariant set for the original system of @xmath4 differential equations , we have shown that the non - zero steady - state infection probabilities .",
    "finally , we have also considered the case when the partition is almost equitable ."
  ],
  "abstract_text": [
    "<S> we study the diffusion of epidemics on networks that are partitioned into local communities . </S>",
    "<S> the gross structure of hierarchical networks of this kind can be described by a _ </S>",
    "<S> quotient graph_. the rationale of this approach is that individuals infect in community models the nodal infection probability is thus expected to depend mainly on the interaction of a few , large interconnected clusters . in this work , we describe the epidemic process as a continuous - time ( sis ) model the spectral radius of this smaller quotient graph ( which only captures the macroscopic structure of the community network ) is all we need to know in order to decide whether the overall healthy - state defines a or an unstable equilibrium .    </S>",
    "<S> associated with the evolution of the process on the quotient graph . </S>",
    "<S> our investigations are based on the graph - theoretical notion of _ equitable partition _ and of its recent and rather flexible generalization , that of _ almost equitable partition_.    susceptible - infected - susceptible model , hierarchical networks , graph spectra , equitable and almost partitions </S>"
  ]
}