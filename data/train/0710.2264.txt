{
  "article_text": [
    "reaction networks commonly appear in physical , chemical and biological systems , where reactions may take place in the bulk or on a surface .",
    "when the surface or bulk systems are macroscopic , the populations of reactive species are typically large and the law of large numbers applies .",
    "thus , fluctuations in the concentrations of the reactants and in the reaction rates become negligible . as a result",
    ", these reaction networks can be analyzed using rate equation models , which account for the average concentrations and ignore fluctuations .    in some cases",
    ", the system is partitioned into small domains , such that the reactants can not diffuse between them .",
    "the populations of reactive species in each domain become small and their fluctuations can not be ignored . as a consequence ,",
    "rate equations fail and the simulation of these reactions requires stochastic methods such as direct integration of the master equation @xcite .",
    "the master equation takes into account the discrete nature of the reactants as well as the fluctuations .",
    "it is expressed in terms of the probabilities of having a given set of population sizes of the reactive species in a given domain . in certain cases , such as radioactive decay ,",
    "an analytical solution based on generating functions is available @xcite . in other cases ,",
    "numerical methods are required . for simple reaction networks that involve few reactive species , numerical integration of the master equation",
    "is useful and efficient @xcite .",
    "however , as the number of reactive species increases , the number of variables in the master equation quickly proliferates @xcite , making the direct integraion infeasible .    here",
    "we focus on networks in which reactions take place between pairs of species , and the reaction products may be reactive or non - reactive . such networks may be described by graphs : each reactive species is represented by a node ; the reaction between a pair of species is represented by an edge that connects the corresponding nodes . typically , these networks are sparse , namely most pairs of species do not react with each other . for such sparse networks ,",
    "the recently introduced multiplane method provides a dramatic reduction in the number of equations @xcite .",
    "the method is based on breaking the network into a set of maximal fully connected subnetworks ( maximal cliques ) .",
    "it involves an approximation , in which the correlations between pairs of species that react with each other are maintained , while the correlations between non - reacting pairs are neglected .",
    "the result is a set of lower dimensional master equations , one for each clique , with suitable couplings between them . for sparse networks , the cliques are typically small and mostly consist of two or three nodes .",
    "this method thus enables the simulation of large networks much beyond the point where the master equation becomes infeasible .",
    "the multiplane method has already been used in the simulation of complex chemical networks on dust grains in interstellar clouds @xcite , where rate equations fail @xcite , while direct integration of the master equation is impractical @xcite .",
    "the multiplane method is also required for the simulation of genetic networks in cells , where the master equation @xcite and monte carlo simulations @xcite are not applicable for large networks .    in this paper",
    "we analyze the multiplane method and examine its validity .",
    "this is done by comparing the results with the complete master equation .",
    "the comparison is done both for the probability distributions and for the first and second moments , which represent the population sizes of reactants and reaction rates , respectively .",
    "it is shown that the multiplane method provides accurate results for both the population sizes and reaction rates .",
    "for concreteness , we use below the terminology of surface reactions . in this context , the small domains are taken to be dust grains ( assumed to be spherical , for simplicity ) , and the reactants are atoms or molecules that enter the system as incoming flux from the surrounding gas phase ( below we use the words atoms and molecules interchangeably ) .",
    "the reactants and reaction products leave the system by thermal desorption .",
    "the reactions that take place on a grain are driven by diffusion of reactants on its surface until they encounter each other and react . in spite of this specific terminology , the multiplane method can be adapted to other contexts , such as reactions in a solution , protein interactions in a living cell and birth - death processes in population dynamics . here",
    "we focus on the calculation of steady - state solutions and thus do not expand on birth - death processes which may exhibit absorbing states .",
    "the paper is organized as follows . in sec .",
    "[ rate_master ] we briefly review the rate equation and master equation methods , presenting them for a simple reaction network . in sec . [ the_method ] we describe the multiplane method . in sec .",
    "[ simulations ] we test the performance of the multiplane method .",
    "an analysis of the method in the limits of small and large grains is presented in sec .",
    "[ analysis ] . in sec .",
    "[ complex ] we show how to apply the method to more complex networks . in sec .",
    "[ applications ] we briefly describe its applications in interstellar chemistry and in genetic networks .",
    "the main findings are summarized and discussed in sec .",
    "[ summary ] .",
    "consider a small grain , exposed to fluxes of three different atomic species , denoted by @xmath0 , @xmath1 and @xmath2 .",
    "the adsorbed atoms on the grain reside in adsorption sites .",
    "the number of sites , @xmath3 , is proportional to the surface area of the grain .",
    "the incoming flux of @xmath4 , @xmath5 , is given by @xmath6 ( s@xmath7 ) atoms per site .",
    "thus , the flux of atoms per grain is @xmath8 ( s@xmath7 ) .",
    "the adsorbed atoms may desorb due to thermal excitations .",
    "the desorption rate of the @xmath4 species from the grain is denoted by @xmath9 ( s@xmath7 ) .",
    "while residing on the grain , the atoms diffuse on the surface via hopping between adjacent sites .",
    "the hopping rate of @xmath4 atoms is given by @xmath10 ( hops s@xmath7 ) .",
    "it is convenient to define the sweeping rate @xmath11 , which is approximately the inverse of the time it takes an adsorbed @xmath4 atom to visit nearly all the adsorption sites on the grain surface @xcite .",
    "a more accurate expression for @xmath12 in the case of spherical grains appears in ref .",
    "@xcite , where it is shown to be reduced by a logarithmic factor .",
    "the diffusion process enables adsorbed atoms to encounter each other and react .",
    "here we consider a simple reaction network that includes the reactions @xmath13 and @xmath14 , where the @xmath15 and @xmath16 molecules are the reaction products .",
    "the graph that illustrates this network is shown in fig . [ fig1](a ) .",
    "the rate equations that describe the network of fig . [ fig1](a ) .",
    "take the form    @xmath17    where @xmath18 is the average population size of @xmath4 atoms on a grain .",
    "the first terms on the right hand side of eq .",
    "( [ eq : rate3species ] ) represent the incoming fluxes of @xmath4 atoms .",
    "the second terms represent the desorption of @xmath4 atoms , which is proportional to the @xmath4 population on the grain .",
    "the remaining terms account for the reactions between adsorbed atoms .",
    "the production rates of @xmath15 and @xmath16 molecules per grain ( in units of s@xmath7 ) are given by @xmath19 and @xmath20 .",
    "for simplicity , we assume that non - reactive product species desorb into the gas phase immediately upon formation .    for large grains , eqs .",
    "( [ eq : rate3species ] ) account correctly for the reaction rates .",
    "however , in the limit of small grains , some of the average population sizes , @xmath18 , may become small . in this case",
    "the discrete nature of the adsorbed atoms and molecules becomes important and the fluctuations can not be ignored . as a result , the reaction rates obtained from the rate equations ( [ eq : rate3species ] ) are incorrect and stochastic methods are needed .",
    "we also consider a related network , shown in fig .",
    "[ fig1](b ) , in which @xmath2 is the product of the reaction between @xmath0 and @xmath1 ( namely , @xmath2 and @xmath15 are the same species )",
    ". the rate equations that describe this system are the same as in eq .",
    "( [ eq : rate3species ] ) except that in the third equation one needs to add the term @xmath21 .",
    "the production rate of @xmath16 is still given by @xmath22 defined above .",
    "the dynamical variables of the master equation are the probabilities @xmath23 of having a population of @xmath24 atoms of species @xmath4 on the grain .",
    "it takes the form    @xmath25 } \\nonumber \\\\ & + & \\sum_{i=1}^{3}{w_i[(n_i + 1)p(\\dots , n_i+1,\\dots ) -   n_ip(n_1,n_2,n_3 ) ] }   \\\\ & + & ( a_1 + a_2)[(n_1 + 1)(n_2 + 1)p(n_1 + 1,n_2 + 1,n_3 ) -   n_1n_2p(n_1,n_2,n_3 ) ] \\nonumber \\\\ & + & ( a_1 + a_3)[(n_1 + 1)(n_3 + 1)p(n_1 + 1,n_2,n_3 + 1 ) -   n_1n_3p(n_1,n_2,n_3 ) ] , \\nonumber \\label{eq : master3species}\\end{aligned}\\ ] ]    where @xmath26 . the first term in eq .",
    "( [ eq : master3species ] ) describes the effect of the incoming flux .",
    "the probability @xmath27 increases when an @xmath4 atom is adsorbed on a grain that already has @xmath28 adsorbed @xmath4 atoms .",
    "this probability decreases when an @xmath4 atom is adsorbed on a grain that includes @xmath24 atoms of species @xmath4 .",
    "the second term accounts for the desorption process .",
    "the third and fourth terms describe the reactions that take place on the grain .    in numerical simulations",
    "the master equation is truncated in order to keep the number of equations finite . a convenient way to achieve",
    "this is to assign upper cutoffs on the population sizes of the reactive species , @xmath29 , @xmath30 , where @xmath31 is the number of reactive species .    in the network of fig .",
    "[ fig1](a ) , the average population size of @xmath4 on a grain is given by the first moment    @xmath32    the production rates per grain of @xmath15 and @xmath16 molecules can be obtained from the mixed second moments of @xmath23 , according to @xmath33 and @xmath34 , where    @xmath35    in a network of @xmath31 reactive species , the number of equations to be solved is    @xmath36    the truncated master equation is valid if the probability to have a population larger than the assigned cutoff is negligible . note that @xmath37 grows exponentially with the number of reactive species .",
    "this limits the applicability of the master equation to simple networks , making it impractical in the case of complex networks which involve many reactive species @xcite .",
    "the recently introduced multiplane method provides a dramatic reduction in the number of equations @xcite .",
    "it thus enables efficient simulations of complex reaction networks . below",
    "we describe the method using the network of fig . [",
    "fig1](a ) .",
    "note that in this network the species @xmath0 participates in both reactions . since the species @xmath1 and @xmath2 do not react with each other",
    ", one may assume that for a given population size of @xmath0 , their population sizes are almost conditionally independent . under this assumption",
    ", the probability distribution of the population sizes can be approximated by @xcite    @xmath38    where @xmath39 is the conditional probability that there will be @xmath24 atoms of species @xmath4 given that there are @xmath40 atoms of species @xmath0 on the grain .    in order to derive the multiplane equations , we first insert eq .",
    "( [ eq : conditional ] ) into the master eq .",
    "( [ eq : master3species ] ) , and trace over the population size of @xmath2 . using the fact that @xmath41 and that @xmath42 , one obtains    @xmath43 +   f_2[p(n_1,n_2 - 1 ) - p(n_1,n_2 ) ] \\nonumber \\\\ & + & w_1[(n_1 + 1)p(n_1 + 1,n_2 ) - n_1p(n_1,n_2 ) ] \\nonumber \\\\ & + & w_2[(n_2 + 1)p(n_1,n_2 + 1 ) - n_1p(n_1,n_2 ) ] \\nonumber \\\\ & + & ( a_1 + a_2)[(n_1 + 1)(n_2 + 1)p(n_1 + 1,n_2 + 1 ) -   n_1n_2p(n_1,n_2 ) ]   \\nonumber \\\\ & + & ( a_1 + a_3)[(n_1 + 1 ) { \\langle n_{3 } \\rangle } _ { n_1 + 1}p(n_1 + 1,n_2 ) -   n_1 { \\langle n_{3 } \\rangle } _ { n_1}p(n_1,n_2 ) ] , \\label{eq : mp3species1}\\end{aligned}\\ ] ]    where @xmath44 . a similar procedure , tracing over the population size of @xmath1 , leads to the equation    @xmath45 +   f_3[p(n_1,n_3 - 1 ) - p(n_1,n_3 ) ] \\nonumber \\\\ & + & w_1[(n_1 + 1)p(n_1 + 1,n_3 ) - n_1p(n_1,n_3 ) ] \\nonumber \\\\ & + & w_3[(n_3 + 1)p(n_1,n_3 + 1 ) - n_1p(n_1,n_3 ) ] \\nonumber \\\\ & + & ( a_1 + a_3 ) [ ( n_1 + 1)(n_3 + 1)p(n_1 + 1,n_3 + 1 ) - n_1n_3p(n_1,n_3 ) ]   \\nonumber\\\\ & + & ( a_1 + a_2 ) [ ( n_1 + 1 ) { \\langle n_{2 } \\rangle } _ { n_1 + 1}p(n_1 + 1,n_3 ) - n_1 { \\langle n_{2 } \\rangle } _ { n_1}p(n_1,n_3 ) ] .",
    "\\label{eq : mp3species2}\\end{aligned}\\ ] ]    these are , in fact , two master equations , one for @xmath46 and the other for @xmath47 .",
    "these two master equations are coupled through the conditional averages @xmath48 where @xmath49 .",
    "the conditional average , which is evaluated in each one of these master equations is then used , essentially as a rate constant , in the other master equation .",
    "the multiplane equations are solved by direct numerical integration using standard steppers such as runge - kutta . at each time step , the probability distributions @xmath46 and @xmath47 are updated .",
    "the conditional averages @xmath48 are then evaluated and used in the next time step .    the number of equations is significantly reduced as we replace the three - dimensional set of equations for @xmath23 by two - dimensional sets for @xmath46 , and @xmath47 .",
    "the number of equations in the three - dimensional set is given by eq .",
    "( [ eq : numofequations ] ) with @xmath50 .",
    "the number of equations in each one of the two dimensional sets is @xmath51 , @xmath52 .",
    "the multiplane method enables one to calculate the average population sizes @xmath18 of all the species , as well as the reaction rates , expressed in terms of the second moments @xmath53 .",
    "consider , for example , the population size @xmath54 of the @xmath0 species .",
    "it can be expressed in two ways , namely    @xmath55    where @xmath56 or @xmath57 . in the first case @xmath18",
    "is evaluated from @xmath46 , and in the second case it is evaluated from @xmath47 .",
    "a nice property of the multiplane method is that the results are identical , as can be seen from eq .",
    "( [ eq : conditional ] ) .",
    "the difference is merely in the order in which @xmath58 and @xmath59 are traced out .",
    "the multiplane method also provides the reaction rates .",
    "for example , the production rate of the @xmath15 species [ fig . [ fig1](a ) ] is given by    @xmath60    note that in the derivation of the multiplane equations , certain dependencies were neglected .",
    "still , the dependence between all pairs of species that react with each other are maintained through the conditional averages , @xmath61 .",
    "these conditional averages are essential in order to maintain the desired correlations .",
    "if the conditional moments @xmath61 , in the multiplane equations ( [ eq : mp3species1 ] ) and ( [ eq : mp3species2 ] ) , are replaced by @xmath18 for @xmath52 , these equations are reduced , by proper summations , to the rate equations ( [ eq : rate3species ] ) . in this case",
    "all the correlations are lost .",
    "to examine the multiplane method we have performed simulations of the reaction networks shown in fig .",
    "the results were compared to those obtained from the complete master equation . in fig .",
    "[ fig2](a ) we present the average population sizes of the @xmath0 ( circles ) , @xmath1 ( squares ) and @xmath2 ( triangles ) species on a grain vs. the number of adsorption sites , @xmath3 , for the network of fig .",
    "[ fig1](a ) , obtained from the multiplane equations under steady state conditions . in the simulations throughout the paper , we chose to use the parameters @xmath62 , @xmath63 , @xmath64 , @xmath65 , @xmath66 , and @xmath67 ( s@xmath7 ) .",
    "this choice reflects the mobilities and desorption rates in the network of h , o and oh that appears in interstellar grain chemistry @xcite .",
    "the production rates of @xmath15 ( @xmath68 ) and @xmath16 ( @xmath69 ) molecules on a grain , vs. @xmath3 , obtained from the multiplane equations , are shown in fig . [ fig2](b ) .",
    "the results are in excellent agreement with the master equation ( solid lines ) .",
    "the rate equations ( dashed lines ) provide accurate results for large grains , but for small grains they show significant deviations .",
    "we have preformed extensive simulations of this system , using a wide range of parameters , and found that the consistency of the multiplane method and the complete master equation is always maintained . in the simulations presented above the fluxes were @xmath70 , and @xmath71 .",
    "note that with the parameters specified above , the incoming flux of @xmath0 atoms is much larger than the fluxes of @xmath1 and @xmath2 .",
    "it is often the case in chemical networks that there exists a dominant species , which is more abundant and more reactive than the other species ( such as hydrogen in interstellar grain chemistry ) .",
    "one could speculate that the dominance of @xmath0 is the reason for the remarkable agreement between the multiplane results and the master equation results . in order to show that this is not the case , and that the multiplane equations are generically applicable , we examine some other parameters . in particular",
    ", we consider the case in which the flux of @xmath0 is much lower than the fluxes of @xmath1 and @xmath2 , namely @xmath72 and @xmath73 .",
    "the population sizes and reaction rates obtained for this choice of fluxes are shown in fig . [ fig3](a ) and ( b ) , respectively .",
    "clearly , the excellent agreement between the multiplane method and the master equation is maintained in this case as well as in all other sets of parameters that we have examined .",
    "it turns out that the multiplane method applies even when one of the species in one clique is a product of a reaction that is included in another clique . to demonstrate this fact we consider the network of fig .",
    "[ fig1](b ) in which @xmath2 is the product of the reaction between @xmath0 and @xmath1 .",
    "this feature may give rise to some sort of correlation between the population sizes of @xmath1 and @xmath2 .",
    "the question is whether such correlations may reduce the applicability of the multiplane method .",
    "the multiplane equations describing the network of fig . [ fig1](b ) are the same as eqs .",
    "( [ eq : mp3species1 ] ) and ( [ eq : mp3species2 ] ) , except that in the last term of the second equation , @xmath74 is replaced by @xmath75 . in fig",
    "[ fig4](a ) we present the population sizes of the @xmath0 ( circles ) , @xmath1 ( triangles ) and @xmath2 ( squares ) species on a grain vs. @xmath3 under steady state conditions , obtained from the multiplane method for the network of fig .",
    "[ fig1](b ) .",
    "the production rates of the @xmath2 ( + ) and @xmath16 ( @xmath69 ) species are shown in fig . [ fig4](b ) . even in this case , the multiplane results are in perfect agreement with the master equation ( solid lines ) .",
    "the rate equations ( dashed lines ) are accurate for large grains but deviate for small grains .",
    "here we chose @xmath76 , @xmath77 and @xmath78 , namely @xmath2 molecules are not accreted from the gas phase , and are produced only on the grain .    figs .",
    "[ fig2 ] - [ fig4 ] demonstrate the usefulness of the multiplane method for the simulation of reaction networks on small grains .",
    "in particular , it is shown that the multiplane equations provide accurate results for the population sizes of reactants , given by the first moments @xmath18 , @xmath79 , and for the reaction rates , expressed in terms of the second moments , @xmath80 and @xmath81 .",
    "the multiplane method only includes the marginal probability distributions , @xmath46 and @xmath47 .",
    "however , using eq .",
    "( [ eq : conditional ] ) one can construct an approximation of the complete probability distribution , @xmath23 .",
    "this approximation takes the form    @xmath82    where the marginal probability distributions @xmath46 , @xmath47 and @xmath83 on the right hand side are those obtained from the multiplane method . in order to examine the accuracy of this approximation",
    ", we introduce the _ deviation distance _ ,    @xmath84    which is evaluated under steady - state conditions of the master equation and the multiplane equations , where @xmath23 is the distribution obtained from the master equation .",
    "we have evaluated @xmath85 for a range of grain sizes between @xmath86 and @xmath87 .",
    "it was found that in all cases @xmath88 .",
    "more explicitly , it varies between @xmath89 to @xmath90 .",
    "this indicates that the reconstructed probability distribution @xmath91 provides a very good approximation of @xmath23 .",
    "while the second moments which involve pairs of species in the same clique account for their reaction rate , such moments for species from different cliques have no direct physical interpretation . still , they can be used as an additional test for the accuracy of @xmath91 . clearly , one may not expect the multiplane method to provide accurate results for such moments because the corresponding correlations are neglected . in fig .",
    "[ fig5](a ) we show the moment @xmath92 vs. grain size as obtained from the multiplane equations for the reaction network of fig .",
    "[ fig1](a ) ( + ) .",
    "surprisingly , the results are in agreement with those of the master equation ( solid line ) . the corresponding rate equation results for @xmath93 , are also shown ( dashed line ) . in fig",
    "[ fig5](b ) we show the moment @xmath92 vs. grain size , as obtained from the multiplane equations ( + ) for the network of in fig .",
    "[ fig1](b ) . in this network , the species @xmath2 is the result of the reaction between @xmath0 and @xmath1 , enhancing the correlations between them . indeed ,",
    "the results of the multiplane method deviate from the master equation results ( solid line ) in the regime of small grains . however , for large grains the results of the multiplane method and the master equation coincide and agree with those of the rate equations ( dashed line ) . in general",
    ", we find that for higher moments of the form @xmath94 , @xmath95 , that involve species from more than one clique , the multiplane method is not reliable in the limit of small grains . for large grains",
    "the multiplane and master equation results coincide .",
    "consider the probability distribution @xmath23 in the limit of small grains , where the average population sizes satisfy @xmath96 for @xmath97 . in this limit",
    ", @xmath98 can be expressed by @xmath99 , where @xmath100 is a constant that depends on the parameters and @xmath101 is proportional to the grain size , @xmath3 . in this case , @xmath102 is the highest probability while @xmath103 , @xmath104 and @xmath105 are of order @xmath106 .",
    "the probability @xmath107 of having a pair of @xmath1 and @xmath2 atoms reside simultaneously on the grain is of order @xmath108 .",
    "the probabilities @xmath109 and @xmath110 , of having pairs of atoms of species that react with each other reside simultaneously on the grain , are reduced due to the reactions and go like @xmath111 . under these circumstances , the average population sizes satisfy    @xmath112    while the second moments that determine the reaction rates satisfy    @xmath113    using these relations , one can show that in the limit of small grains , to first order in @xmath106 , the population sizes of @xmath1 and @xmath2 are statistically independent , namely    @xmath114    to show this relation , one needs to examine three states of @xmath115 , namely @xmath116 , @xmath117 and @xmath118 . in all other cases",
    ", @xmath119 goes like the quadratic or a higher degree of @xmath106 . as an example , we show that @xmath120 , to leading order in @xmath106 . to this end , we evaluate the left hand side    @xmath121    and the right hand side    @xmath122   \\left [ 1 - p(n_3=1 ) + \\mathcal{o}(\\epsilon^2 ) \\right ]   \\nonumber \\\\ & = & p(0,0,0 ) + p(1,0,0 ) + \\mathcal{o}(\\epsilon^2 ) .",
    "\\label{eq : expansion_small}\\end{aligned}\\ ] ]    clearly , the relation ( [ eq : small_conditional ] ) is satisfied .",
    "this result justifies the applicability of eq .",
    "( [ eq : conditional ] ) in the limit of small grains .",
    "the calculation of mixed second moments for pairs of species that belong to different cliques , such as @xmath92 involves probabilities such as @xmath123 for states in which species that do not react with each other reside simultaneously on the grain .",
    "it can be shown that these probabilities do not satisfy the relation of eq .",
    "( [ eq : small_conditional ] ) .",
    "this result is consistent with the fact that the multiplane method does not provide accurate results for this moment , as already observed in fig . [",
    "fig5](b ) .",
    "these results further support the conclusion that the multiplane method is suitable for the calculation of moments confined to a single clique and is unsuitable for moments that combine different cliques . to test this conclusion in detail",
    "we define the ratio    @xmath124    which is equal to 1 where the multiplane method is accurate and deviates from 1 elsewhere . in fig .",
    "[ fig6](a ) we display the forty highest probabilities , @xmath23 , obtained from the master equation for the network of fig . [ fig1](b ) in descending order .",
    "the results are for a small grain of @xmath125 adsorption sites , for which the population sizes of adsorbed species are exceedingly small .",
    "the probabilities drop off very rapidly , implying that the first and second moments are indeed dominated by the few highest probabilities . in fig .",
    "[ fig6](b ) we show the parameter @xmath126 , for the same set of probabilities .",
    "it is confirmed that the multiplane method is valid only for the largest probabilities . beyond the first few entries , @xmath126 begins to fluctuate . in fig .",
    "[ fig6](c ) we show an enlarged plot of @xmath126 , including the first 17 probabilities . in this graph",
    "the probabilities are labeled .",
    "it is found that for those probabilities associated with states in which only species from a single clique reside simultaneously on a grain , the multiplane method is in excellent agreement with the master equation . for states",
    "in which species from different cliques reside simultaneously on the grain , significant deviations are obtained . the first significant deviation between the multiplane method and the master equation is found for the probability @xmath107 , in agreement with the previous analysis .",
    "the analysis above shows that the multiplane method is valid in the limit of small grains . in this limit",
    ", the probability distribution is dominated be a few high probabilities associated with small population sizes of the reactive species .",
    "these dominant probabilities satisfy the approximation of eq .",
    "( [ eq : conditional ] ) .",
    "therefore , the population sizes and reaction rates obtained from the multiplane method and the master equation are in excellent agreement .",
    "the applicability of the multiplane method in the limit of large grains is not surprising because in this limit even the rate equations provide accurate results .",
    "as shown above , the rate equations can be derrived from the multiplane equations by removing the conditions from the conditional averages .",
    "the accuracy of the rate equations shows that in the limit of large grains the correlations are negligible and the probability distribution @xmath23 can be factorized into a product of probabilities of single - species .",
    "therefore , the multiplane method provides accurate results for any desired moments of the probability distribution .",
    "for sparse reaction networks with fluctuations , the multiplane method was found to provide a dramatic reduction in the number of equations compared to the master equation .",
    "the method provides accurate results for the populations of reactive species and for the reaction rates .",
    "the method was presented for simple networks which include only three species . however , the generalization to more complex networks is straightforward . consider the network shown in fig .",
    "the probability distribution of the population sizes of the reactive species in this network is @xmath127 . to derive the multiplane equations one first needs to split the network into maximal cliques , or maximal fully - connected subgraphs . for the network of fig .",
    "[ fig7 ] these cliques are : @xmath128 , @xmath129 , @xmath130 , @xmath131 and @xmath132 .",
    "the next step is to write down the master equation for the marginal probability distribution associated with each clique .",
    "this can be done using either the top - down approach , which is straightforward but tedious , or the bottom - up approach .    in the top - down approach , the master equation for the marginal probability distribution associated with a given clique",
    "is obtained by tracing over all the species that do not belong to this clique .",
    "this procedure is repeated for each one of the maximal cliques .    in the bottom - up approach , the master equation for the internal reactions in each clique",
    "is constructed first .",
    "then , the coupling terms between cliques , which include the conditional averages are added one by one .",
    "these terms account for reactions between species , such as @xmath133 , which belong to the clique and species , such as @xmath134 , which do not belong to the clique . in the master equation",
    ", the reaction between @xmath133 and @xmath134 is described by terms of the form @xmath135 . in the multiplane equation for the given clique ,",
    "@xmath136 is replaced by @xmath137 and @xmath138 is replaced by the marginal probability distribution for the clique . for example , the resulting equation for the clique @xmath139 is    @xmath140 \\nonumber \\\\ & + & f_2 [ p(n_1,n_2 - 1 ) - p(n_1,n_2 ) ] \\nonumber \\\\ & + & w_1 [ ( n_1 + 1 ) p(n_1 + 1,n_2 ) - n_1 p(n_1,n_2 ) ] \\nonumber \\\\ & + & w_2 [ ( n_2 + 1 ) p(n_1,n_2 + 1 ) - n_2 p(n_1,n_2 ) ] \\nonumber \\\\ & + & ( a_1 + a_2 )   [ ( n_1 + 1)(n_2 + 1)p(n_1 + 1,n_2 + 1 ) - n_1n_2 p(n_1,n_2 ) ] \\nonumber \\\\ & + & a_1 [ ( n_1 + 2)(n_1 + 1)p(n_1 + 2,n_2 ) - n_1(n_1 - 1)p(n_1,n_2 ) ] \\\\ & + & \\sum_{i=3}^{7}{(a_1 + a_i)[(n_1 + 1 )   \\langle n_i \\rangle _ { n_1 + 1}p(n_1 + 1,n_2 )   - n_1 \\langle n_i \\rangle _ { n_1}p(n_1,n_2 ) ] } , \\nonumber\\end{aligned}\\ ] ]    where eq . ( [ eq : conditional ] ) is used in order to justify the replacement of @xmath141 by @xmath142 .",
    "we find it instructive to carry out the procedure for the clique @xmath143 as well . in this clique ,",
    "the species @xmath0 and @xmath144 are both correlated with @xmath16 . when tracing over @xmath16 one must maintain both correlations , giving rise to the conditional average @xmath145 .",
    "the resulting equation takes the form :    @xmath146 \\nonumber \\\\ &",
    "+ & \\sum_{i=1,6,7 }   w_i [ ( n_i + 1 ) p(\\dots , n_i+1,\\dots ) - n_i p(n_1,n_6,n_7 ) ] \\\\ & + & ( a_1 + a_6 )   [ ( n_1 + 1)(n_6 + 1)p(n_1 + 1,n_6 + 1,n_7 ) -   n_1n_6 p(n_1,n_6,n_7 ) ] \\nonumber \\\\ & + & ( a_1 + a_7 )   [ ( n_1 + 1)(n_7 + 1)p(n_1 + 1,n_6,n_7 + 1 ) -   n_1n_7 p(n_1,n_6,n_7 ) ] \\nonumber \\\\ & + & ( a_6 + a_7 )   [ ( n_6 + 1)(n_7 + 1)p(n_1,n_6 + 1,n_7 + 1 ) -   n_6n_7 p(n_1,n_6,n_7 ) ] \\nonumber \\\\ & + & \\sum_{i=1,6 } a_i   [ ( n_i + 2)(n_i + 1)p(\\dots , n_i+2,\\dots ) -   n_i(n_i - 1)p(n_1,n_6,n_7 ) ] \\nonumber \\\\ & + & \\sum_{i=2}^{4}{(a_1 + a_i ) [ ( n_1 + 1 ) \\langle n_i \\rangle _ { n_1 + 1}p(n_1 + 1,n_6,n_7 )   - n_1 \\langle n_i \\rangle _ { n_1}p(n_1,n_6,n_7 ) ] } \\nonumber \\\\ & + & ( a_1 + a_5 )   [ ( n_1 + 1 ) \\langle n_5 \\rangle _ { n_1 + 1 , n_6 } p(n_1 + 1,n_6,n_7 )    -   n_1 \\langle n_5 \\rangle _ { n_1 , n_6 } p(n_1,n_6,n_7 ) ] \\nonumber \\\\ & + & ( a_5 + a_6 )   [ ( n_6 + 1 ) \\langle n_5 \\rangle _ { n_1 , n_6 + 1 } p(n_1,n_6 + 1,n_7 )    -   n_6 \\langle n_5 \\rangle _ { n_1 , n_6 } p(n_1,n_6,n_7 ) ] .",
    "\\nonumber\\end{aligned}\\ ] ]    this network has been simulated using both the multiplane method and the complete master equation .",
    "the results were found to be in excellent agreement @xcite .",
    "stochastic simulations are of great importance in a wide range of physical systems . below",
    "we present two examples of current research areas in which the multiplane method is expected to be useful .",
    "the chemistry of interstellar clouds includes gas - phase reactions as well as grain - surface reactions @xcite . due to the microscopic size of the grains , and the low flux",
    ", the population sizes of reactive species on the grains may be small and exhibit strong fluctuations . under",
    "these conditions rate equations are not suitable for the simulation of grain - surface chemistry @xcite . to account correctly for the reaction rates , stochastic methods such as direct integration of the master equation @xcite or monte carlo simulations @xcite are required .",
    "the master equation is more suitable for grain chemistry because it consists of differential equations , which can be easily coupled to the rate equations of gas phase chemistry .",
    "furthermore , the master equation provides the probability distribution from which the reaction rates can be evaluated directly , unlike monte carlo methods that require to accumulate large sets of data and to perform ensemble or temporal averages . for simple networks",
    "the master equation is efficient and provides accurate results .",
    "however , for complex networks , the master equation becomes infeasible . in this case",
    ", the multiplane method provides efficient stochastic simulations .",
    "consider the network of fig .",
    "[ fig7 ] . using the following substitutions",
    "@xmath147 , this network coincides with the reaction network that leads to methanol production on grains in molecular clouds @xcite .",
    "current experimental effort is aimed at the evaluation of the relevant rate constants for the surface diffusion , reaction and desorption of the species involved in this network @xcite .",
    "these experiments include infra - red spectroscopy as well as temperature - programmed desorption runs using a mass spectrometer to detect the desorbed molecules .",
    "the resulting parameters , inserted into the multiplane equations , will enable to evaluate the reaction rates in interstellar environments and to compare the results with observations .",
    "the multiplane method for this network provides a reduction in the number of equations from about one million , using the master equation , to about one thousand equations . for more complex networks",
    "the master equation becomes infeasible while the multiplane method remains efficient .",
    "another important field in which the multiplane method is expected to be useful is the study of genetic regulatory networks in cells .",
    "these networks describe the transcription of mrnas from genes and their translation into proteins .",
    "the regulation is performed at the transcriptional level ( by transcription factors that bind to the promoter site of the regulated gene ) , at the post - trancriptional level ( e.g. , by small non - coding rnas ) and at the post - translational level ( e.g. , by protein - protein interactions ) .",
    "analysis of these networks revealed modular structure .",
    "in particular , modules or motifs which perform specific functions and repeatedly appear in different parts of the network were identified @xcite .",
    "common examples of such motifs are the autorepressor  @xcite and different versions of the feed forward loop  @xcite .",
    "other modules such as the genetic switch  @xcite and the mixed - feedback loop  @xcite also appear , but are not as common .",
    "genetic networks often exhibit strong fluctuations due to the fact that some of the transcription factors appear in low copy numbers .",
    "moreover , the transcriptional regulation is typically performed by a small number of transcription factors which bind and unbind to the promoter site at a fast rate .",
    "this gives rise to strong fluctuations in the transcription rate of the regulated gene .",
    "some modules , such as the autorepressor , the genetic switch and the mixed - feedback loop include positive or negative feedback mechanisms , which tend to enhance the role of fluctuations .",
    "in particular , the dynamics of the genetic switch system was studied extensively using both deterministic and stochastic methods @xcite .",
    "it was found that fluctuations play a crucial role in this system . while the analysis of small modules such as the genetic switch can be done using the master equation",
    ", it quickly becomes infeasible when larger networks are considered .",
    "the implementation of the multiplane method in this context is expected to provide a broader perspective on the role of fluctuations in genetic networks .",
    "recently , such fluctuations at the level of single cells were measured experimentally using the green fluorescent protein @xcite .",
    "such measurements are also expected to provide the effective rate constants of the relevant processes in the cell .",
    "we have shown that the multiplane method provides efficient simulations of complex reaction networks with fluctuations , for which the rate equations fail and the master equation is infeasible .",
    "the multiplane equations are obtained by breaking the network into maximal cliques and writing down the set of master equations for the marginal probability distributions of these cliques , with a suitable coupling between them . for typical sparse networks ,",
    "the method provides a dramatic reduction in the number of equations .",
    "we found that the multiplane results for the first and second moments , which account for population sizes and reaction rates , respectively , are in excellent agreement with those of the complete master equation .",
    "it also accounts correctly for higher moments which involve species from the same clique .",
    "however , the method does not account correctly for second and higher moments which include species from different cliques .",
    "the numerical results are complemented by an asymptotic analysis of the small and large grain limits .",
    "a more rigorous analysis shows that the multiplane method is asymptotically exact in both limits @xcite .",
    "it is performed in a more general setting , in which the maximal cliques may be broken into smaller cliques .",
    "in particular , one may break the entire network into cliques of two species each .",
    "it is shown that even in this case , in the limits of small and large grains , the method still provides exact results for all the first moments and for those second moments that involve species in the same clique .",
    "a related approach , based on moment equations , also provides efficient stochastic simulations of reaction networks @xcite . in this approach ,",
    "one constructs differential equations for the first and second moments of the probability distribution .",
    "the number of equations is further reduced to one equation for each reactive species ( node ) and one equation for each reaction ( edge ) .",
    "thus , for typical sparse networks the complexity of the stochastic simulation becomes comparable to that of the rate equations . in applications such as interstellar chemistry ,",
    "in which the main objective is to calculate the reaction rates , the moment equations are advantageous .",
    "however , in systems such as genetic networks , in which the probability distribution itself is of interest , the multiplane method is required .",
    "and @xmath1 and the other consists of @xmath0 and @xmath2 .",
    "( a ) the reaction products , @xmath15 and @xmath16 are non - reactive ; ( b ) the product of the reaction between @xmath0 and @xmath1 is the reactive specie @xmath2 . ,",
    "width=432 ]     ( circles ) , @xmath1 ( triangles ) and @xmath2 ( squares ) species per grain vs. the number of adsorption sites , @xmath3 , on the grain , obtained from the multiplane equations , for the network shown in fig .",
    "[ fig1](a ) .",
    "the results are in perfect agreement with the master equation ( solid lines ) and the rate equations ( dashed lines ) ; ( b ) the production rates of @xmath15 ( + ) and @xmath16 ( @xmath69 ) molecules per grain vs. @xmath3 , obtained from the multiplane equations .",
    "the results are in perfect agreement with the master equation ( solid lines ) . for small grains , the rate equation results ( dashed lines ) for the reaction rates exhibit large deviations . here",
    ", @xmath0 is the dominant species .",
    ", width=480 ]     for the network of fig .",
    "[ fig1](a ) .",
    "the multiplane results ( symbols ) are in perfect agreement with the master equation ( solid lines ) .",
    "the rate equation results ( dashed lines ) deviate significantly for small grains . here",
    "the species @xmath0 is dominated by @xmath1 and @xmath2 . , width=480 ]    , for the network of fig .",
    "[ fig1](b ) in which @xmath2 is the reaction product of @xmath0 and @xmath1 .",
    "the multiplane results ( symbols ) are in perfect agreement with the master equation ( solid lines ) . the rate equations ( dashed lines )",
    "are also shown .",
    ", width=480 ]     of @xmath23 vs. @xmath3 , obtained from the multiplane method ( + ) for the network shown in fig .",
    "[ fig1](a ) .",
    "this moment is not related to any reaction rate , thus the multiplane method is not designed to approximate it well .",
    "still , it turns out that the results are in good agreement with the master equation ( solid line ) .",
    "the rate equation results for the corresponding term , @xmath93 , are also shown ( dashed line ) ; ( b ) the moment , @xmath92 , vs. @xmath3 for the network shown in fig . [ fig1](b ) .",
    "the multiplane results ( + ) deviate from those of the master equation ( solid line ) in the limit of small grains . for large grains",
    "the multiplane results coincide with the master equation and with the corresponding term , @xmath93 , of the rate equations ( dashed line ) . , width=432 ]    , obtained from the master equation , arranged in descending order from the largest ( left ) to the smallest ( right ) for a small grain with @xmath125 adsorption sites . here",
    "we show the forty largest probabilities ; ( b ) the ratio parameter , @xmath126 , defined in eq .",
    "( [ eq : eta ] ) , between the probabilities obtained from the multiplane equations and the corresponding probabilities obtained from the master equation .",
    "the ratio is unity for the first few probabilities and then it fluctuates for the the rest ; ( c ) an enlargement of the first seventeen probabilities displayed in ( b ) .",
    "standing out are @xmath107 and @xmath149 , for which the multiplane equations and the master equation differ .",
    "these probabilities have no significant effect on the production rates and population sizes , but are expressed when computing other moments .",
    ", width=432 ]"
  ],
  "abstract_text": [
    "<S> reaction networks in the bulk and on surfaces are widespread in physical , chemical and biological systems . in macroscopic systems , which include large populations of reactive species , stochastic fluctuations are negligible and the reaction rates can be evaluated using rate equations . however , many physical systems are partitioned into microscopic domains , where the number of molecules in each domain is small and fluctuations are strong . under these conditions , </S>",
    "<S> the simulation of reaction networks requires stochastic methods such as direct integration of the master equation . </S>",
    "<S> however , direct integration of the master equation is infeasible for complex networks , because the number of equations proliferates as the number of reactive species increases . </S>",
    "<S> recently , the multiplane method , which provides a dramatic reduction in the number of equations , was introduced [ a. lipshtat and o. biham , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> 93 , 170601 ( 2004 ) ] . </S>",
    "<S> the reduction is achieved by breaking the network into a set of maximal fully connected sub - networks ( maximal cliques ) . </S>",
    "<S> lower - dimensional master equations are constructed for the marginal probability distributions associated with the cliques , with suitable couplings between them . in this paper </S>",
    "<S> we test the multiplane method and examine its applicability . </S>",
    "<S> we show that the method is accurate in the limit of small domains , where fluctuations are strong . </S>",
    "<S> it thus provides an efficient framework for the stochastic simulation of complex reaction networks with strong fluctuations , for which rate equations fail and direct integration of the master equation is infeasible . </S>",
    "<S> the method also applies in the case of large domains , where it converges to the rate equation results . </S>"
  ]
}