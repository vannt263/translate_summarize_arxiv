{
  "article_text": [
    "the potential flow of ideal fluid of infinite depth with free surface can be efficiently described through the time - dependent conformal mapping @xmath0 of the lower complex half - plane @xmath1 of the auxiliary complex variable @xmath2 into the area @xmath3 @xmath4 occupied by the fluid @xcite , where @xmath5 is the coordinate of the free surface , @xmath6 is the time , @xmath7 and @xmath8 are the horizontal and vertical physical coordinates , respectively . here",
    "the real line @xmath9 is mapped into the line @xmath5 representing the free surface of the fluid ( see fig . 1 of ref .",
    "@xcite for the schematic of the conformal mapping zwdef ) .",
    "@xcite used this conformal transformation extensively , both analytically and numerically , to reveal the structures of complex singularities of stokes wave which is the fully nonlinear periodic gravity wave propagating with the constant velocity @xmath10  @xcite .",
    "nonlinearity of stokes wave increases with the increase of @xmath11 where @xmath12 is the stokes wave height which is defined as the vertical distance from the crest to the trough of stokes wave .",
    "we use scaled units at which without the loss of generality the spatial period is @xmath13 and @xmath14 for the linear gravity waves similar to ref .",
    "@xcite . in a stokes wave @xmath15 and the limit",
    "@xmath16 corresponds to the linear gravity wave .",
    "the stokes wave of the greatest height @xmath17 ( also known as the limiting stokes wave ) has an angle of @xmath18 radians at the crest , corresponding to a singularity @xmath19  @xcite .",
    "the non - limiting stokes waves describe ocean swell and the slow time evolution of the stokes wave toward its limiting form is one of the possible routes to wave - breaking and whitecapping in full wave dynamics .",
    "wave - breaking and whitecapping carry away significant part of energy and momenta of gravity waves  @xcite . here",
    "slow approach means the time scale which is much larger than the temporal period of the gravity wave of the same spatial period as for the given stokes wave .",
    "formation of limiting stokes wave is also considered to be a probable final stage of evolution of a freak ( or rogue ) waves in the ocean resulting in formation of approximate limiting stokes wave for a limited period of time with following wave breaking and disintegration of the wave or whitecapping and attenuation of the freak wave into wave of regular amplitude @xcite .",
    "thus the approach of non - limiting stokes wave to the limiting stokes wave has both significant theoretical and practical interests .",
    "it was studied in details in refs .",
    "@xcite how the complex singularity in @xmath20 plane approaches the real line ( corresponds to the fluid s free surface ) from above during the transition from non - limiting stokes wave to the limiting stokes . describing such transition is a numerically challenging task because in a stokes wave the distance @xmath21 between the lowest branch points to the real line approaches zero , which implies slow decay of the fourier coefficients : @xmath22 where @xmath23 is the fourier wavenumber . here ,",
    "similar to refs .",
    "@xcite we separated @xmath24 into a @xmath25-periodic part @xmath26 and a non - periodic part @xmath20 by introducing @xmath27 such that @xmath28 while @xmath29 and @xmath30 . ref .",
    "@xcite used up to @xmath31 fourier modes for @xmath32 on the uniform grid which allowed to obtain the stokes wave with @xmath33 ( the maximal fourier mode @xmath34 resolved in these simulations corresponds to @xmath35 ) .",
    "conformal mappings can be used for improving efficiency of simulations for the general periodic 1d system defined on the real line if such system allows analytic continuation to the strip containing the real axis ( see e.g. @xcite for review ) .",
    "assume that @xmath21 is the vertical distance from the real line to the complex singularity closest to the real line .",
    "thus @xmath21 defines the thickness of the strip of analyticity in the direction where the singularity is nearest to the real line ( stokes wave is a special case because the thickness of strip is determined by the distance @xmath21 in the upper complex half - plane @xmath36 while the thickness is infinite below the real line ) .",
    "then the ft for the system scales as in eq .",
    "the idea is to find a conformal transformation from @xmath20 to the new complex variable which makes the strip of analyticity thicker , i.e. to push all complex singularities of the system to the distance @xmath37 from the real line .",
    "then ft in the new conformal variable scales as @xmath38 for @xmath39 i.e. decays faster than in eq .",
    "expspectral speeding up numerical convergence .",
    "a similar idea can be applied to the nonperiodic systems holomorphic in a closed ellipse around the segment of the real line ( with foci corresponding to the two ends of that segment ) with e.g. rational spectral interpolants used instead of ft @xcite . in all such cases the spectral numerical methods including ft methods are highly efficient and typically having exponential convergence with the number of grid points @xmath40 used for the spectral collocation as exemplified by eq .",
    "expspectral if we use @xmath41 for the estimate of the numerical error .",
    "however exploiting such idea for the dynamics of the ideal fluid with free surface on infinite depth has previously met with obstacles because the water waves dynamics require to work with function holomorphic in the entire lower complex half plane instead of the strip . in other words , only singularities in the upper complex half - plane @xmath36 are allowed for the dynamics of the ideal fluid . in this paper",
    "we overcome that obstacle by the proper choice of the conformal map .",
    "we focus on problems periodic in @xmath7 variable ( with period @xmath25 ) in the reference frame moving with the constant velocity @xmath10 .",
    "the transformation zwdef becomes independent of time : @xmath42 which parametrically defines the stokes wave as @xmath43 in physical coordinates with @xmath44 and @xmath45 being horizontal and vertical physical coordinates , respectively .",
    "the main results of this paper is that we found a new conformal map @xmath46},\\ ] ] which we demonstrate to be consistent with the fluid dynamics .",
    "we show below the extreme efficiency of equation qnewdef for simulations of stokes wave . here",
    "@xmath47 is the new complex coordinate and @xmath48 is the arbitrary positive constant which we adjust to optimize performance of simulations . for the general time - dependent problems @xmath48 would become time - dependent to account for the vertical motion of nearest singularities as well as both @xmath20 and @xmath47",
    "can be translated in the horizontal direction with time to account for the horizontal motion of singularities .",
    "however such generalization to time - dependent problems is beyond the scope of this paper",
    ".    figs .",
    "[ fig : w - and - q ] and [ fig : transform ] show schematically that the new conformal map qnewdef zooms at the real line into the neighborhood of @xmath49 among all points on the real line @xmath50 that point @xmath51 is the closest to the lowest singularity ( branch cut ) of the strongly nonlinear stokes wave which is located at @xmath52 .",
    "then the uniform grid in the new variable @xmath47 corresponds to the highly nonuniform grid in the physical coordinates with the grid points concentrating at the neighborhood of the singularity as seen in fig .",
    "[ fig : transform ] .",
    "the substitution of @xmath53   into equation qnewdef immediately reveals that the lowest singularity of stokes wave is located at @xmath54 in @xmath47 plane .",
    "it means that the free parameter @xmath48 of the transformation qnewdef allows to change the position of the singularity in the complex @xmath47 plane .",
    "here it is assumed that @xmath55 .",
    "then ft in @xmath47 variable decay as @xmath56 which is much faster than expspectral for @xmath57 it makes the new conformal map qnewdef highly efficient .",
    "equation qnewdef has its own singularities at @xmath58 which approach the real line with the decrease of @xmath59 as schematically shown in fig .",
    "[ fig : w - and - q ] . balancing the contribution of singularities of stokes wave and @xmath60 ( i.e. setting them to have the same distance to the real axis in @xmath47 plane ) one obtains the optimal value @xmath61 which ensures the fastest possible convergence of fourier modes as @xmath62    e.g. , the simulation of ref .",
    "@xcite with @xmath63 and @xmath33 required running 64 cores computer cluster for @xmath64 months .",
    "in contrast , the simulations described in section [ sec : results ] ( they use the new conformal map qnewdef ) allowed to achieve the same precision for the numerical grid with @xmath65 fourier modes which takes a few minutes on the desktop computer . respectively , by increasing @xmath66 ( according to equation vc1p2 , one has to choose @xmath67 to reach the same precision as on the uniform grid ) we were able to study stokes waves with significantly smaller values of @xmath21 ( down to @xmath68 ) than in ref . @xcite .",
    "the new conformal map qnewdef and its inverse provide the mapping between half - strips in @xmath20 and @xmath47 lower complex planes as shown in fig .",
    "[ fig : singularities ] by shaded areas .",
    "these areas extend all way down in the complex planes and correspond to the area occupied by fluid with the exception of the singularity points of the conformal map as detailed in section [ sec : coordinatenonuniform ] .",
    "these exceptional points result in the extra constant terms found in section [ sec : projectorshilberttransformationq ] to ensure the exact solution of euler equation through the conformal map .",
    "the paper is organized as follows . in section [ sec : coordinatenonuniform ] we discuss the properties of the conformal map qnewdef in complex plane and corresponding discretization . in secton",
    "[ sec : stokeswave ] we introduce the closed equation for stokes wave in new @xmath47 variable . in section",
    "[ sec : projectorshilberttransformationq ] we analyze how to work with the projectors and hilbert transformation in the new variable @xmath47 . in section [ sec : stokeswavecomputation ] we describe the numerical algorithm used for obtaining the stokes waves in the limit of the complex singularity approaching the real line .",
    "section [ sec : results ] demonstrates the high efficiency of the new conformal map qnewdef and analyzes the results on the computed stokes waves .",
    "section [ sec : generalizedconformalmap ] provides a generalization of the conformal map qnewdef to adaptively resolve multiple singularities . in section",
    "[ sec : conclusion ] the main results of the paper are discussed .",
    "the conformal transformation qnewdef is @xmath25-periodic in @xmath20 .",
    "inverting equation qnewdef at the real line @xmath69 we obtain that @xmath70}\\ ] ] which is @xmath25-periodic in @xmath47 . also the real line @xmath71 maps into the real line @xmath72 .",
    "recalling that we assume @xmath25 periodicity of eq .",
    "zwdef3 for stokes wave , we conclude that it is sufficient to consider the conformal transformations qnewdef and unewdef between half - strip @xmath73 , @xmath74 and @xmath75 , @xmath76 in @xmath20 and @xmath47 , respectively . here",
    "@xmath25-periodicity is ensured by the limits @xmath77 for @xmath78    if we assume that @xmath79 then equation qnewdef is reduced to @xmath80 which implies that taking numerical step @xmath81 in @xmath47 space for @xmath47 near 0 is equivalent to taking the numerical step @xmath82 in @xmath83 space .",
    "it ensures that the uniform grid in @xmath47 space is highly concentrated near @xmath84 in @xmath83 space , with a `` density '' of grid points @xmath85 near @xmath84 .",
    "it allows to use much less grid points on the uniform grid in @xmath47 space in comparison with the uniform grid in @xmath83 space ( the uniform grid was used previously in many simulations , see e.g. refs .",
    "@xcite ) to archive the same precision of a numerical solution . to make these arguments precise we use the jacobian @xmath86 of the transformation qnewdef is given by @xmath87 then for a general value of @xmath47 , the steps @xmath88 and @xmath89 are related as @xmath90 fig .",
    "[ fig : transform ] shows @xmath91 and @xmath86 for @xmath92 with dots representing @xmath93 points of discrete grids both in @xmath83 and @xmath47 spaces separated by @xmath89 and @xmath88 , respectively .",
    "the branch point singularity of stokes wave , located at @xmath53 in @xmath20 plane , corresponds to @xmath94 in @xmath47 plane in accordance with the eq .",
    "qnewdef where@xmath95}\\ ] ] which implies that @xmath96 as schematically shown in fig .",
    "[ fig : singularities ] .",
    "thus @xmath97 is located significantly higher in @xmath47 plane compared to @xmath21 in @xmath20 plane providing the quantitative explantation of much quicker decay of fourier spectrum qft in @xmath47 variable compared to eq .",
    "expspectral . however , the asymptotic qft is valid provided @xmath94 is closer to the real axis than the other parts of the mapping of the stokes wave branch cut @xmath98 into @xmath47 plane . in particular ,",
    "a one part @xmath99 of stokes wave branch cut is mapped into @xmath100 and another part @xmath101 is mapped into two branch cuts @xmath102 by @xmath25 periodicity in @xmath47 as sketched by vertical lines in fig .",
    "[ fig : singularities ] . here",
    "the branch points @xmath103 correspond to the singularities of the conformal map unewdef in @xmath47 space .",
    "these singularities are obtained from the jacobian qjacobian which is nonsingular for any value @xmath104 but reaches zero ( i.e. the singularity of @xmath105 ) at @xmath106 for @xmath107 eq .",
    "quzero reduces in the strip @xmath108 to @xmath109 the locations @xmath110 and @xmath111 of stokes wave singularities in @xmath47 space are shown schematically in fig .",
    "[ fig : singularities ] .",
    "we note that the singularities @xmath112 are located in @xmath113 but they are invisible for any function @xmath114 which is @xmath25 periodic because the jumps at the corresponding branch cut @xmath115 are identically zero , see also refs . @xcite for somewhat similar discussion . because of that we show points @xmath116 by filled circles for the transformation in right panel of fig .",
    "[ fig : w - and - q ] but do not show @xmath116 in right panel of fig . [",
    "fig : singularities ] . if instead of a stokes wave",
    "one would consider a function @xmath117 with the branch cut of finite extent then the end point of the mapping of that branch cut into @xmath47 plane would be not @xmath118 but other point located higher above the real axis .",
    "however we do not consider such functions in this paper .",
    "the singularity @xmath110 dominates the asymptotic of stokes wave ft in @xmath47 variable provided @xmath119 .",
    "thus the best convergence of ft ( faster decays of fourier harmonics at large @xmath120 occurs for @xmath121 which together with eqs .",
    "qcdefser and quzeroser give the optimal choice of the parameter @xmath122 given by eq .",
    "loptimal and valid for @xmath123 for @xmath122 both singularities of stokes wave in @xmath47 space are located at a distance @xmath124 from the real axis ensuring the ft asymptotic vc1p2 .",
    "the closed equation for stokes wave has the following form    @xmath125    which is defined on the real line @xmath71 for the function @xmath45 which is the imaginary part of eq .",
    "stokes_wave2 was derived in ref .",
    "@xcite and later was independently obtained from results of ref .",
    "@xcite in ref .",
    "@xcite from the exact euler equations of free surface hydrodynamics .",
    "see also ref .",
    "@xcite for somewhat similar equation . here",
    "@xmath126 is the positive - definite linear operator defined by @xmath127 and @xmath128 is the hilbert transform , @xmath129 with @xmath130 designating a cauchy principal value of integral and subscript in @xmath83 means that both the hilbert transform and @xmath131 are defined for the variable @xmath83 .",
    "the hilbert operator @xmath128 is a multiplication operator on the fourier coefficients : @xmath132 where @xmath133 are the fourier coefficients ( harmonics ) : @xmath134 of the periodic function @xmath135 represented through the fourier series @xmath136 here @xmath137 for @xmath138 and @xmath139 , respectively .    after solving eq .",
    "stokes_wave2 numerically as described in refs .",
    "@xcite , we recover the real part @xmath44 of eq .",
    "zwdef2 from @xmath45 as @xmath140 which follows from the analyticity of @xmath141 zwdef3 in @xmath142 ( see a derivation of eq .",
    "xytransform e.g. in ref .",
    "then stokes wave solution is represented in the parametric form @xmath143    eq . stokes_wave2 was derived in ref .",
    "@xcite under the assumption that @xmath144{\\mbox{d}}u=0,\\ ] ] meaning that the mean elevation of the free surface is set to zero .",
    "equation yxucondition reflects a conservation of the total mass of fluid .    in this paper instead of solving eq .",
    "stokes_wave2 in @xmath83-variable , we transform it into @xmath47-variable using unewdef",
    ". then we solve the resulting equation numerically in a more efficient way using the procedure described in section [ sec : stokeswavecomputation ] .",
    "we express @xmath83 through @xmath47 as given by eq .",
    "unewdef , and obtain from eqs .",
    "stokes_wave2 and qjacobian that @xmath145 where the operators @xmath146 and @xmath147 now act in @xmath47 space with @xmath86 given by eq .",
    "here and below we abuse notation and use the same symbol @xmath8 for both functions of @xmath83 and @xmath47 ( in other words , we assume that @xmath148 and remove @xmath149 sign ) . the comparison of eqs .",
    "stokes_wave2 and stokes_wave2q together with eqs .",
    "hilbertdef and hilbertdefq reveals that we simply replaced @xmath128 by @xmath150 , where the explicit expression for a constant is not important for solving eq .",
    "stokes_wave2q because it includes derivatives over @xmath47 thus removing this constant .",
    "the justification of the validity of this nontrivial replacement is provided in section [ sec : projectorshilberttransformationq ] .",
    "we also note by comparison of the definitions of @xmath131 and @xmath151 above in this section that ft of @xmath151 has the same meaning of the multiplication on @xmath152 but this time in fourier space of @xmath47 .",
    "because the jacobian @xmath86 is nonzero for any real values @xmath153,$ ] one immediately obtains from equation stokes_wave2q a more compact expression @xmath154 which we use for simulations .",
    "the mean level zero condition yxucondition is transformed to @xmath155dq=0\\ ] ] in the @xmath47 variable .",
    "in this section we justify the use of the operator @xmath151 in eqs .",
    "stokes_wave2q and stokes_wave2q2 .",
    "it is convenient to introduce the operators @xmath156 which are the projector operators of a general periodic function into a functions analytic in @xmath157 and @xmath158 correspondingly . to understand the action of these projector operators , we introduce the splitting of a general @xmath25 periodic function @xmath159 with the fourier series fkseries as @xmath160 where @xmath161 is the analytical ( holomorphic ) function in @xmath162 and @xmath163 is the analytical function in @xmath142 as well as @xmath164 is the zero fourier harmonic defined through eq .",
    "ffourier as @xmath165 . together with the property @xmath166\\ ] ] which follows from eq .",
    "hfk we obtain that @xmath167 i.e. the functions which are holomorphic in @xmath142 and @xmath162 , respectively .",
    "here we use the notation @xmath168 , @xmath169 and @xmath128 for the projectors and hilbert transform in @xmath83 space .",
    "similarly , we introduce projector operators @xmath170 , @xmath171 and hilbert transform @xmath172 in the @xmath47-variable .",
    "we can use two approaches to determine the form of projectors @xmath168 , @xmath169 in the @xmath47 space .",
    "the first approach is to analyze how fourier series transforms as we make a change of variables from @xmath83 to @xmath47 .",
    "the second approach is to use definition of these operators through complex contour integrals and see how these integrals transform as we make a change of variables from @xmath83 to @xmath47 . in this paper",
    "we focus on the second approach as well as we provide the expressions only for @xmath170 and @xmath172 .",
    "the expression for @xmath171 can be derived in a similar way but it is not need for the computation of stokes wave .    using the sokhotskii - plemelj theorem",
    "( see e.g. @xcite ) @xmath173 where @xmath174 means @xmath175 , we rewrite eq .",
    "projectordef as follows @xmath176 we now use @xmath25 periodicity of @xmath159 to reduce eq .",
    "puminus into the integral over one period @xmath177 using equations unewdef and qjacobian we transform eq .",
    "puminusperiod to @xmath47-variable as follows @xmath178dq'}{\\tan{\\frac{q'+{\\mbox{i}}0}{2}}-\\tan{\\frac{q   } { 2}}}\\frac{1}{\\cos^2{\\frac{q'}{2}}\\ , \\left(1+l^2\\tan^2{\\frac{q'}{2}}\\right ) } .\\end{aligned}\\ ] ]    similar to eq .",
    "fpm0 we write @xmath114 in @xmath47 space as follows @xmath179 where @xmath180 is analytic function in @xmath162 and @xmath181 is the analytical function in @xmath142 and @xmath182 is the zero fourier harmonic @xmath183    we evaluate integrals in eq .",
    "puminusperiodq using fpm0q by closing complex contours in @xmath184 for @xmath185 and @xmath113 for @xmath186 respectively as shown in fig .",
    "[ fig : contour ] . for @xmath182",
    "it can be done in both ways giving the same result .",
    "the zeros of the denominator are located at @xmath187 and @xmath188 .",
    "we calculate the residues to obtain : @xmath189}{\\frac{{\\mbox{i}}}{l}-\\tan{\\frac{q   } { 2}}}\\frac{1 } {   { \\mbox{i}}l}=\\frac{1}{2}f^{+,q}\\left(2\\arctan{\\frac{{\\mbox{i}}}{l}}\\right ) ,   \\\\ & \\hat p_u^{-}f^{-,q}(q)=\\frac{2\\pi{\\mbox{i}}}{4\\pi { \\mbox{i } } } \\frac{f^{-,q}(q)\\left [ 1+l^2\\tan{\\frac{q}{2}}\\tan{\\frac{q } { 2}}\\right ] } { \\frac{1}{2\\cos^2{\\frac{q}{2}}}}\\frac{1}{\\cos^2{\\frac{q}{2}}\\ , \\left(1+l^2\\tan^2{\\frac{q}{2}}\\right ) } \\\\&+\\frac{2\\pi{\\mbox{i}}}{4\\pi { \\mbox{i } } } \\frac{f^{-,q}(-2\\arctan{\\frac{{\\mbox{i}}}{l}})\\left [ 1+l^2\\frac{-{\\mbox{i}}}{l}\\tan{\\frac{q   } { 2}}\\right ] } { \\frac{-{\\mbox{i}}}{l}-\\tan{\\frac{q   } { 2}}}\\frac{1 } {   -{\\mbox{i}}l}=f^{-,q}(q)-\\frac{1}{2}f^{-,q}\\left(-2\\arctan{\\frac{{\\mbox{i}}}{l}}\\right ) ,   \\\\",
    "& \\hat p_u^{-}f_{0,q}=\\frac{1}{2}f_{0,q}. \\end{split}\\ ] ] using equations fpm0q and puplusperiodq2b yields : @xmath190 defining the projector @xmath191 in @xmath47 space similar to eq .",
    "pfm as @xmath192 we obtain from eq .",
    "pminusq3 that @xmath193 where @xmath194 is the constant .",
    "we define @xmath172 through a relation similar to eq .",
    "projectordef in @xmath47 space @xmath195 and we obtain from eq .",
    "pminusq3a and projectordefq that @xmath196 thus the operators @xmath197 and @xmath198 in @xmath83 and @xmath47 spaces are the same except for the shift by a constant @xmath199 and @xmath200 respectively .",
    "these constants result from the singularities quzero of the conformal map unewdef .",
    "the explicit expression for @xmath199 is calculated from the values of @xmath201 as follows .",
    "we notice that for stokes wave @xmath45 is an even real function , @xmath202 which implies that @xmath203 in @xmath47 variable . by taking @xmath204",
    "we obtain that @xmath205 .",
    "the analytical continuation of @xmath201 from the real line @xmath72 into the complex value @xmath206 is trivially done by plugging the complex value of @xmath47 into the series fminus reducing eq .",
    "cdef to @xmath207 for the even real function @xmath208 for more general non - even solution of eq .",
    "stokes_wave2q2 ( corresponds to higher order progressive waves , which have more than one different peaks per @xmath25 spatial period @xcite ) we generally obtain nonzero value of @xmath199 by a similar procedure as follows .",
    "we recover @xmath209 from @xmath201 using the identity @xmath210 which follows from the condition that @xmath159 is the real - valued function . here",
    "@xmath211 means the complex conjugation of the function @xmath114 for real values of @xmath47 , i.e. @xmath212 for complex values of @xmath213 for eq .",
    "fminus it implies that @xmath214 then @xmath199 results from the analytical continuation of @xmath201 and @xmath215 from the real line into @xmath206 together with eqs .",
    "cdef and fpm1 .",
    "note that we do not need the explicit value for @xmath199 to solve eqs .",
    "stokes_wave2q and stokes_wave2q2 because they both include derivatives over @xmath47 which removes @xmath199 .",
    "however , to obtain @xmath44 one generally needs the value of @xmath199 ( which produces only a trivial shift in the horizontal direction ) . using eqs .",
    "unewdef , hfpmq , cdef , we transform eq .",
    "xytransform into the variable @xmath47 as follows @xmath216 we conclude that this section has justified the derivation of eqs .",
    "stokes_wave2q and stokes_wave2q2 from eq .",
    "we solve eq . stokes_wave2q2 numerically using the generalized petviashvili method ( gpm ) @xcite and the newton conjugate gradient method proposed in refs .",
    "these numerical methods are similar to the numerical solution of eq . in refs .",
    "@xcite . for both methods @xmath217",
    "is expanded in cosine fourier series and the operator @xmath151 kqdef is evaluated numerically using fast fourier transform ( fft ) on the uniform grid with @xmath66 points discretization of the interval @xmath218 .    as alternative to solving eq .",
    "stokes_wave2q2 , we also numerically solved the equivalent equation @xmath219,\\ ] ] which is the analog of equation @xmath220,\\ ] ] derived in ref .",
    "stokes_wave3 is equivalent to eq .",
    "stokes_wave2 and is obtained by applying the projector operator @xmath221 projectordef to equation stokes_wave2 together with the condition yxucondition . in a similar way .",
    "stokes_wave3q is obtained by applying the projector operator @xmath222 projectordefq to equation stokes_wave2q2 together with the condition mean_levelq .    solving eq .",
    "stokes_wave3q numerically instead of eq .",
    "stokes_wave2q2 typically provides 1 - 2 extra digits of accuracy in stokes wave height @xmath12 as well as in the accuracy of the solution spectrum and @xmath21 .",
    "the extra cost is however that we have to solve eq .",
    "stokes_wave3q for the complex - valued function @xmath223 instead of the real valued function @xmath224 in eq .",
    "stokes_wave2q2 which doubles memory requirements and the number of numerical operations .",
    "after we obtain a numerical solution for @xmath225 we use it to determine the value of @xmath21 via one of three numerical methods : ( i ) the first method uses a least squares fit of fourier spectrum of a solution @xmath226 to the asymptotic series described in eq .",
    "( 41 ) of ref .",
    "working in @xmath83 variable this method allows one to obtain @xmath21 with the absolute accuracy about @xmath227 in double precision ( dp ) using 7 - 12 terms in the series of eq .",
    "( 41 ) of ref .",
    "while working in @xmath47 variable , the second singularity quzero located at @xmath228 introduces a contribution to the fourier spectrum of the same order as the main singularity qcdef ( located at @xmath229 ) if the parameter @xmath48 is chosen close to @xmath230 loptimal , so we typically can get only 1 - 2 digits of precision in @xmath21 . in order to obtain @xmath21 with higher accuracy",
    "one needs to remap the solution via fourier interpolation to a uniform grid for the new variable @xmath231 with the larger value of the parameter @xmath232 ( we found that a factor 8 or 16 is typically enough to obtain @xmath21 with maximum possible accuracy in dp ) .",
    "this pushes the second singularity much further away from the real line compared to the first one so that the main contribution to the tail of fourier spectrum in @xmath231 space comes from the first singularity ( at a distance @xmath233 from the real line ) which will allow us to find @xmath234 ( and consequently @xmath21 ) using the same fitting procedure as in @xmath83 space . using this approach for solutions in @xmath47 space",
    "we were able to recover @xmath21 with absolute accuracy about @xmath235 in dp .",
    "we typically used it for solution with @xmath236 fourier harmonics since fourier interpolation procedure uses @xmath237 operations and becomes slow for larger @xmath66 .",
    "\\(ii ) the second method is described in section 6.1 a of ref .",
    "@xcite and based on the compatibility of the series expansions at points @xmath238 in the axillary space @xmath239 $ ] ( which implies that @xmath240)$ ] with the equation stokes_wave2 of stokes wave .",
    "current realization of this algorithm also requires pad approximation of the solution in the axillary space @xmath241 ( described in section 4 of ref .",
    "@xcite ) for calculation of coefficients of series expansion at the point @xmath242 $ ] .",
    "this method is so far the most accurate but requires @xmath243 operations ( @xmath244 is the number of poles ) for finding pad approximation of a solution thus slow for large @xmath66 . we typically used that method for @xmath245 where the the small value of @xmath21 required us to use quadruple ( quad ) precision with 32 digits accuracy both to obtain @xmath226 and recover @xmath246 the absolute accuracy for @xmath21 in this method was @xmath247    \\(iii ) the third method is described in section 4.3 of ref .",
    "@xcite and uses nonlinear fit of the crest of a solution to a series ( 4.13 ) in ref .",
    "one can work in either @xmath47 space to find @xmath248 or @xmath83 space to find directly @xmath21 .",
    "the method was used as the substitute of the method ( ii ) for the smallest values @xmath249 we achieved , where pad approximation become computationally challenging taking more computer time than the calculation of @xmath226 itself .",
    "the absolute accuracy of that method for @xmath21 is @xmath250 to summarize , we used the first two methods for finding @xmath21 for solution with @xmath251 in dp , the second method for solutions with with @xmath252 in quad precision and the third method for solution with @xmath253 ( with @xmath254 ) .",
    "we also performed a multiprecision simulations with a variable precision arithmetics with @xmath255 digits for selected values of parameters as described in the next section .",
    "previous results summarized in fig . 2 of ref .",
    "@xcite ( they are also reproduced in the left part of the curve of fig .",
    "[ fig : methods ] ) showed a nontrivial dependence of the stokes wave speed @xmath10 on the height @xmath12 with @xmath12 monotonically approaching the maximum value @xmath256 and @xmath10 approaching a finite value non - monotonically while oscillating with an amplitude that decreases approximately two orders in magnitude every half of such oscillation . computing stokes wave solutions in @xmath83 space as in ref .",
    "@xcite allowed to resolve about 1.5 of such oscillations ( see fig .  [",
    "fig : methods ] ) while implementing the approach described in this paper ( solving in @xmath47 space ) allowed to resolve about 3.5 of such oscillations .",
    "one example of the numerical solution ( corresponds to the most extreme wave of ref .",
    "@xcite ) is given in the introduction .",
    "another example of a less steep wave solution for @xmath257 computed using double precision resulting in @xmath258 and @xmath259 is given in fig .",
    "[ fig : wave ] in variables @xmath83 ( left panel ) and @xmath47 ( right panel ) with the corresponding spectra of @xmath260 and @xmath261 showed in fig .",
    "[ fig : spectra ] ( both spectra have only negative components of @xmath23 since both @xmath141 and @xmath261 are holomorphic in @xmath142 ) . here @xmath262 on a uniform grid and @xmath263 on a nonuniform grid with @xmath264 .",
    "it demonstrates that for this particular case one needs 64 times less fourier harmonics in @xmath47 space compared to the @xmath83 space in order to resolve the solution up to dp round - off error .",
    "the speed up factor could be roughly estimated as @xmath265 that becomes significant as we go to lower values of @xmath21 .",
    "high precision and range of our simulation parameters allow to reveal the asymptotic behavior of stokes wave as it approaches the limiting form as well as make a comparison with the theory of stokes wave .",
    "we start by analyzing the dependencies of wave speed @xmath10 and height @xmath12 on the parameter @xmath266 for the obtained family of stokes waves , where @xmath267\\ ] ] is the distance to the singularity of a stokes wave solution to the real line in the axillary space @xmath239 $ ] .",
    "notice , that for the highly nonlinear stokes waves @xmath268 and @xmath269 , while for the almost linear stokes waves @xmath270 and @xmath271 .",
    "[ fig : ch_vs_xc ] shows @xmath272 and @xmath273 vs. @xmath266 for computed stokes waves in the log - log scale together with the corresponding fitting curves . here",
    "@xmath274 and @xmath275 are the speed and the scaled height of the limiting stokes waves , respectively .",
    "we use the numerical values @xmath276 and @xmath277 found by i.s .",
    "gandzha and v. p. lukomsky in ref .",
    "@xcite with the claimed accuracy in 11 digits .",
    "comparable accuracy was also achieved in ref .",
    "it is seen from fig .",
    "[ fig : ch_vs_xc ] that @xmath272 experiences oscillations with their envelope being the excellent fit to the linear law @xmath278 fig .",
    "[ fig : ch_vs_xc ] . shows that the dependence of @xmath279 on @xmath266 at the leading order fits well to the the power law @xmath280 while experiencing small oscillations with the vanishing amplitude as @xmath281 the scaling hmaxhscaling was proposed in ref .",
    "@xcite from simulations and can be extracted at the leading order from the analytical stokes wave solution of section 8 of ref .",
    "@xcite . using the scaling hmaxhscaling we fit the simulation data into the model @xmath282 where the constant @xmath283 accounts for the accuracy in the numerical value of @xmath284 and @xmath285 is the another fitting parameter . using the smallest values of @xmath286 achieved in simulations",
    ", we obtained from that fit the estimate @xmath287 i.e. @xmath288 which is consistent with 11 digits accuracy of @xmath284 .",
    "the highest wave that we computed in qp has @xmath289 ( for @xmath290 ) which provides the best lower bound @xmath291 from our simulations . that lower bound is within @xmath292 from @xmath293 which is more than 3 orders in magnitude of improvement",
    "compare with the simulations of ref .",
    "@xcite .    to focus on the corrections beyond the leading order scalings climcscaling and hmaxhscaling , we plot @xmath294 and @xmath295 vs. @xmath266 in fig .",
    "[ fig : ch2_vs_xc ] . it seen on left panel",
    "that the simulation data for @xmath296 are well fit onto the sin - log model    @xmath297.\\ ] ]    here we used the data points from the left - most 1.5 oscillations to find the fitting values @xmath298 and @xmath299 .",
    "the points from the steepest waves are the most sensitive to the value of @xmath274 on this plot . adjusting the value @xmath274 and observing the changes in the plot while assuming that in the limit @xmath300 the proposed sin - log model is valid we estimated that @xmath301 which is again consistent with 11 digits accuracy of @xmath302",
    ".    one can compare eq .",
    "climmodel with the expression@xmath303 which was obtained by m.s .",
    "longuet - higgins and m.j.h . fox in ref .",
    "@xcite by matched asymptotic expansions . here @xmath304 and @xmath47 is the particle speed at the wave crest in a frame of reference moving with the phase speed @xmath10 . to find @xmath47 we notice that the complex velocity @xmath305 is given by @xmath306 , where @xmath307 and @xmath308 are the horizonal and vertical velocities in physical coordinates in the rest frame and @xmath309 is complex potential which for stokes wave is given by @xmath310 ( see e.g. the appendix b of ref.@xcite ) .",
    "it implies using the analytic solution of section 8 of ref .",
    "@xcite that @xmath311 where @xmath312 is the constant",
    ". then it is seen that eqs .",
    "climmodel and longuet - higginsfox2 are consistent if we additionally notice that @xmath313 which is within the accuracy of the numerical value @xmath314 in the parameter fit of eq .",
    "in addition , the coefficient @xmath315 in right - hand side of eq . longuet - higginsfox2 is the numerical approximation of ref .",
    "@xcite for @xmath316 . thus fig .",
    "[ fig : ch2_vs_xc ] reproduces 3 oscillations of eq .",
    "longuet - higginsfox2 .",
    "the definition of the stokes wave height results in @xmath317 , where @xmath318 .",
    "then the analytical stokes wave solutuon of section 8 of ref .",
    "@xcite implies that the next correction beyond the leading order model hmaxamodel is given by @xmath319 where @xmath320 is the value of @xmath321 for the limiting stokes wave ( we approximate it by the most extreme wave in our simulations ) . to check the accuracy of eq",
    "hmaxamodel2 we divided it by @xmath322 and compared the right - hand side with the left - hand side on right panel of fig .",
    "[ fig : ch3_vs_xc ] showing excellent agreement . oscillations both in @xmath323 ( as seen on left panel of fig .",
    "[ fig : ch2_vs_xc ] ) and in @xmath324 are comparable in amplitude both contributing to that agreement . inspired by the model climmodel",
    ", we fit the data @xmath325 to the following model @xmath326 $ ] , where @xmath327 are unknown constants . using the data only from the large oscillation at the smallest @xmath266 on right panel of fig .",
    "[ fig : ch3_vs_xc ] , we obtained that @xmath328 .",
    "this model fit is shown on right panel of fig .",
    "[ fig : ch3_vs_xc ] by the solid curve .",
    "notice , that @xmath329 .",
    "we expect that if the suggested models are correct then @xmath330 should be equal to @xmath331 as @xmath332 .",
    "it is also instructive to relate the physical variables @xmath333 and @xmath334 directly bypassing the use of @xmath266 . via eq .",
    "hmaxamodel we approximate @xmath266 at the leading order through @xmath335 we plug in that approximation into eq .",
    "climmodel to obtain at the leading order that @xmath336-(3\\omega_1/2)\\ln{a}+\\varphi_1\\right ] .\\end{aligned}\\ ] ] left panel of fig .",
    "[ fig : ch3_vs_xc ] shows @xmath337 vs. @xmath338 together with the model @xmath339+\\varphi_3].$ ] the fitting constants of the model are @xmath340 and @xmath341 being consistent with the leading order expression hclim .",
    "assume that we aim to approximate a general @xmath25 periodic function @xmath342 which has multiple complex singularities in its analytical continuation into the complex plane @xmath343 example of such function is higher order progressive waves , which have more than one different peaks per @xmath25 spatial period @xcite .",
    "we would like to efficiently approximate @xmath159 thought the fourier series in the new variable @xmath344 a generalization of the conformal transformation qnewdef to take into account these multiple complex singularities of the function @xmath159 is given by @xmath345},\\end{aligned}\\ ] ] where @xmath346 , @xmath347 and @xmath348 are real constants .",
    "a condition @xmath349 ensures that @xmath350 the jacobian of eq .",
    "eqn : qucomposite given by @xmath351 ^ 2}{l_j^2}\\right ) } \\ ] ] is positive - definite .",
    "it ensures that eq .",
    "eqn : qucomposite is one - to - one map between @xmath218 and @xmath352 .    consider an analytical continuation of @xmath353 into the complex plane @xmath354 and choose @xmath355 complex singularities of @xmath356 which are closest to the segment @xmath352 of the real line @xmath71 .",
    "then @xmath357 can be chosen either close or equal to the projections of the positions of complex singularities of @xmath356 into the real line @xmath358 similar to the case @xmath359 described in previous sections , the constants @xmath360 can be chosen to move the complex singularities of @xmath114 further away from the real line of @xmath47 compared with locations of singularities of @xmath356 .",
    "then the uniform grid in @xmath47 corresponds to the nonuniform grid in @xmath83 concentrating at neighborhoods of each @xmath361 singularities of @xmath356 thus greatly improving the approximation of @xmath159 by ft in @xmath47 .",
    "the constants @xmath347 can be either chosen equals , @xmath362 or nonequal ( to provide stronger weights for most dangerous complex singularities ) . note that @xmath363 can be chosen the same for several values of @xmath364 ( but with different values of @xmath365 thus simultaneously resolving several singularities ( or several segments of the vertical branch cut ) located along the same vertical line in @xmath20 plane .",
    "another transformation @xmath91 to resolve multiple singularities is given by a generalization of eq .",
    "unewdef as follows @xmath366},\\end{aligned}\\ ] ] which is explicit expression for @xmath367 but implicit for the inverse @xmath368 here @xmath346 , @xmath369 and @xmath370 are real constants .",
    "a condition @xmath371 ensures that @xmath350 similar to eq .",
    "eqn : qucomposite , eq .",
    "eqn : uqcomposite has a strictly positive jacobian which ensures one - to - one map between @xmath218 and @xmath352 .",
    "in conclusion , we found the new transformation qnewdef which allows to move the lowest complex singularity @xmath53 of the function @xmath159 away from the real line thus greatly improving the efficiency of ft of that function in the new variable @xmath47 .",
    "number of fourier modes needed to reach the same precision of approximation of @xmath372 in @xmath47 variable is reduced by the factor @xmath373 for @xmath374 compare with ft in @xmath83 .",
    "we showed that the new transformation qnewdef is consistent with the dynamics of two dimensional euler equation with free surface .",
    "we demonstrated the effciency of eq .",
    "qnewdef for simulations of stokes wave by improving the numerical performance in many orders of magnitude .",
    "it allows to reveal the details of the oscillatory behaviour of the parameters of stokes wave as it approaches the limiting wave .",
    "we suggested the generalizations eqn : qucomposite and eqn : uqcomposite of eq .",
    "qnewdef to resolve multiple singularities .",
    "a.  i. dyachenko , e.  a. kuznetsov , m.  spector , and v.  e. zakharov , analytical description of the free surface dynamics of an ideal fluid ( canonical formalism and conformal mapping ) , phys.lett.a * 221 * , 7379 ( 1996 ) .",
    "v.  e. zakharov , a.  i. dyachenko , and o.  a. vasiliev , new method for numerical simulation of nonstationary potential flow of incompressible fluid with a free surface , european journal of mechanics b / fluids * 21 * , 283291 ( 2002 ) .",
    "d.  pelinovsky and y.  stepanyants , convergence of petviashvili s iteration method for numerical approximation of stationary solutions of nonlinear wave equations , siam j. numer .",
    "42 * , 11101127 ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> a new highly efficient method is developed for computation of traveling periodic waves ( stokes waves ) on the free surface of deep water . </S>",
    "<S> a convergence of numerical approximation is determined by the complex singularites above the free surface for the analytical continuation of the travelling wave into the complex plane . </S>",
    "<S> an auxiliary conformal mapping is introduced which moves singularities away from the free surface thus dramatically speeding up numerical convergence by adapting the numerical grid for resolving singularities while being consistent with the fluid dynamics . </S>",
    "<S> the efficiency of that conformal mapping is demonstrated for stokes wave approaching the limiting stokes wave ( the wave of the greatest height ) which significantly expands the family of numerically accessible solutions . </S>",
    "<S> it allows to provide a detailed study of the oscillatory approach of these solutions to the limiting wave . </S>",
    "<S> generalizations of the conformal mapping to resolve multiple singularities are also introduced . </S>"
  ]
}