{
  "article_text": [
    "the excursion set theory initially introduced by bond et al .",
    "@xcite provides a self - consistent mathematical framework to infer the properties of the halo mass distribution from the statistics of the initial density field .",
    "the formalism generalizes the original press - schechter idea @xcite by formulating the halo mass counting problem as one of stochastic calculus .",
    "the starting point is the realization that at any location in space the linear matter density fluctuation field performs a random walk as function of a filtering scale @xmath0 . in average",
    ", this scale naturally defines a mass scale @xmath1 , where @xmath2 is the mean matter density and @xmath3 the enclosed spatial volume . by counting the number of trajectories which first - cross a collapse threshold it is then possible to compute the fraction of mass elements in halos @xmath4 and",
    "consequently derive the halo mass function @xmath5 .",
    "the requirement of first - crossing is key to solving the so called `` cloud - in - cloud '' problem affecting the original press - schechter result .",
    "in fact , the first - crossing condition guarantees that in the small scale limit ( @xmath6 ) and independently of the properties of the random walks the fraction of mass into collapsed objects always tends to unity .",
    "the excursion set is analytically solvable in the case of uncorrelated ( markov ) random walks for which the evaluation of the first - crossing distribution is reduced to solving a standard diffusion problem .",
    "however , uncorrelated random walks are generated by a special filtering of the linear density field which corresponds to a non - physical halo mass definition .",
    "in contrast any filtering which specifies a physically meaningful mass generates correlated random walks for which @xmath4 can be inferred only through a numerical computation .",
    "this has represented a major limitation since monte carlo simulations are computationally expensive and moreover do not provide the same level of physical insight of analytic solutions . the seminal work by maggiore & riotto @xcite has made a major step forward in this direction .",
    "using the path - integral formulation of the excursion set theory the authors have shown that the first - crossing distribution of correlated random walks can be computed as a perturbative expansion about the markovian solution . using this methodology",
    "it has been possible to derive analytical formulae for the halo mass function under different halo collapse model assumptions as well as gaussian and non - gaussian ( ng ) initial conditions @xcite .    in a series of papers @xcite",
    "we have used this formalism to evaluate the imprint of the non - spherical collapse of halos on the mass function .",
    "to this end we have introduced an effective stochastic diffusive drifting barrier ( ddb ) model which parametrizes the main features of the ellipsoidal collapse of halos .",
    "accounting for such effects can reproduce the halo mass function from n - body simulations with remarkable accuracy both for gaussian and non - gaussian initial conditions .    here",
    ", we extend the work presented @xcite to derive a more accurate expression of the contribution to the halo mass function of the primordial bispectrum expanded in the large scale limit to next - to - leading order and compute the leading order contribution of the primordial trispectrum .",
    "the paper is organized as follows . in section  [ seci ]",
    "we review the path - integral formulation of the excursion set and its application to gaussian and non - gaussian initial conditions in the case of the ddb model . in section  [ secii ]",
    "we evaluate a lower limit on the interval validity of the bispectrum expansion at next - to - leading order . in section  [ seciii ] and  [ seciv ]",
    "compute the bispectrum and trispectrum contribution to the mass function respectively .",
    "finally , we present our conclusion in section  [ secv ] .",
    "here , we briefly review the main features of the path - integral formulation of the excursion set theory . first , let us introduce the variance of the linear density field @xmath7 filtered on a scale @xmath0 : @xmath8 where @xmath9 is the linear matter power spectrum and @xmath10 is the fourier transform of the filter function in real space , @xmath11 .",
    "as already mentioned , by selecting a volume @xmath12 the filter naturally associates a mass to the enclosed region , @xmath1 .",
    "thus we have a one - to - one relation between @xmath0 ( or @xmath13 ) and @xmath14 .    in the excursion set theory",
    "the filtered density field @xmath15 at any random point in space performs a random walk as function of @xmath0 , @xmath13 or equivalently @xmath14 which plays the role of a pseudo - time variable .",
    "the random walks start at @xmath16 with @xmath17 , since in the large scale limit ( @xmath18 ) we have @xmath19 and the matter density distribution tends toward homogeneity , i.e. @xmath20 .",
    "we are interested in counting trajectories that at a given value of @xmath14 cross for the first time a collapse density threshold @xmath21 such that @xmath22 .",
    "this threshold encodes all informations on the gravitational collapse of halos . in order to model features of the non - spherical collapse ,",
    "the absorbing barrier @xmath21 is promoted to a stochastic variable ( see e.g. @xcite ) also performing a random walk as function of @xmath14 ( i.e.  @xmath0 or @xmath13 ) .",
    "in such a case it is convenient to introduce @xmath23 , which performs a random walk starting at @xmath24 with barrier crossing at @xmath25 .",
    "our goal is to compute the probability distribution @xmath26 of trajectories starting at @xmath27 which reach the value @xmath28 at @xmath14 without ever touching the barrier @xmath25 .",
    "this can be computed as a path - integral over the ensemble of the random trajectories ( see @xcite for a detailed derivation ) .",
    "let us discretize the pseudo - time variable @xmath14 in equally spaced steps , @xmath29 , such that @xmath30 with @xmath31 .",
    "the probability distribution of trajectories starting at @xmath27 and ending in @xmath32 at @xmath33 and that have never crossed the barrier before is given by @xmath34 where @xmath35 where the brackets @xmath36 refer to an ensemble average of the random walks and the averaged quantity is the explonential of @xmath37 which is the partition function of the system written in terms of the @xmath38-point connected correlation functions @xmath39 of the random walks .",
    "thus , the the properties of the stochastic system are entirely determined by the connected correlators .",
    "once these are specified then eq .  ( [ piepsilon ] ) can be integrated in the continuous limit to finally obtain the first - crossing distribution @xmath40,\\ ] ] and the halo mass function is given by @xmath41 where @xmath42 is the so called `` multiplicity '' function .",
    "let us consider a gaussian density field smoothed with a top - hat filter in real space .",
    "on average the density field is homogeneous , thus implying that @xmath43 .",
    "therefore , due to the gaussian nature of the field the only non - vanishing connected correlator is the 2-point function @xmath44 , while all higher - order connected correlators identically vanish .",
    "maggiore & riotto @xcite have shown that for standard cosmological scenarios with cold dark matter power spectra , the 2-point function smoothed with a sharp - x is well approximated by @xmath45 , where the first term corresponds to markov random walks generated by a sharp - k filter and the second term is well approximated by @xmath46 with a nearly constant amplitude @xmath47 .",
    "thus , the pseudo - time correlations induced by the filter function can be treated as small correction about the markovian case and the mass function obtained using a perturbative expansion of the partition function in the path - integral in powers of @xmath48 .    concerning the barrier random walks , in @xcite",
    "we have introduced a stochastic model with linear drift and gaussian diffusion characterized by @xmath49 and @xmath50 , where @xmath51 is the linearly extrapolated critical spherical collapse density , @xmath52 is the average linear rate of deviation from the spherical collapse prediction and @xmath53 is the amplitude of the scatter about the average .",
    "can be biased by the underlying assumption of the excursion set approach ( see @xcite for an extension of the formalism to random walks around density peaks ) . ] in such a case the non - vanishing connected correlators of the @xmath28 variable are @xmath54 substituting these expressions in eq .",
    "( [ partition ] ) and performing a double expansion in @xmath48 and @xmath52 we have derived the gaussian multiplicity function @xmath55 where @xmath56 is the markovian contribution and @xmath57 is the filter correction to first order in @xmath48 and up to second order in @xmath52 which read as @xmath58 and @xmath59 with @xmath60,\\ ] ] @xmath61,\\ ] ] @xmath62,\\ ] ] where @xmath63 and @xmath64 .",
    "equation  ( [ beta2 ] ) includes a term @xmath65 which was missing in the original derivation presented in @xcite . as we explain in appendix  [ app",
    "] this is due to having neglected a factor @xmath66 in the computation of the probability @xmath67 and which enters the calculation of the memory - of - memory term to first order in @xmath48 .      in the case of non - gaussian initial conditions",
    "the higher - order connect correlators of the linear density field are non - vanishing .",
    "let us consider the case of primordial non - gaussianity sourced by a bispectrum term , hence in addition to eq .",
    "( [ yave ] ) and ( [ yvar ] ) , the partition function contains the contribution of a non - vanishing 3-point connected correlation function @xmath68 with @xmath69)\\\\ & \\times\\tilde{w}(k_j , r_j[s_j])\\tilde{w}(k_k , r_k[s_k])\\mathcal{m}(k_i)\\mathcal{m}(k_j)\\mathcal{m}(k_j)\\times\\\\ & \\times\\langle\\zeta(\\textbf{k}_i)\\zeta(\\textbf{k}_j)\\zeta(\\textbf{k}_k)\\rangle_c , \\end{split}\\ ] ] where @xmath70 is the fourier transform of the sharp - x filter , @xmath71 , @xmath72 is the hubble constant , @xmath73 the matter density , @xmath74 the transfer function and @xmath75 is the curvature perturbation with @xmath76 where @xmath77 is the so called `` reduced '' bispectrum .    by expanding eq .",
    "( [ densitymark ] ) in powers of the amplitude of the reduced bispectrum ( usually parametrized by the coefficient @xmath78 ) , we obtain to first - order in @xmath78 the non - gaussian part of the first - crossing distribution @xmath79 where @xmath80 is the continuous limit of @xmath81 where @xmath82 is the gaussian markovian probability density distribution .",
    "( [ fng ] ) can be evaluated provided we have an analytical expression for the primordial bispectrum . in @xcite",
    "we have used the standard approach of considering a triple taylor series of the primordial bispectrum in the large scale limit . in the next section",
    "we will study in detail the range of validity of such an expansion and infer the relevant contribution to the non - gaussian halo mass function .",
    "let us expand the bispectrum eq .",
    "( [ 3pts ] ) in a triple taylor series around @xmath83 ( for convenience we set @xmath84 ) : @xmath85 where @xmath86    we expect the signature of primordial non - gaussianity to be stronger at large scales ( @xmath19 ) where the evolution of the density field remains linear .",
    "hence , the leading order contribution to the halo mass function is given by the lowest order term of the bispectrum expansion .",
    "this corresponds to having @xmath87 which gives the leading order term @xmath88 that can be computed numerically using eq .",
    "( [ 3pts ] ) for a given type of primordial ng .",
    "it is convenient to introduce the normalized skewness @xmath89 . in @xcite",
    "we have provided fitting formula for @xmath90 and its derivatives accurate to a few percent for local and equilateral non - gaussianity .",
    "the next - to - leading order contribution is given by three terms corresponding to the case @xmath91 .",
    "hence , up to next - to - leading order the primordial bispectrum reads as @xmath92 since @xmath93 we can collect the terms in @xmath94 , moreover by computing @xmath95 , @xmath96 and @xmath97 as derivatives of eq .  ( [ 3pts ] ) one can notice that @xmath98 and introducing @xmath99 we can rewrite eq .",
    "( [ expg3 ] ) as @xmath100 we can now derive a lower limit , @xmath101 , on the value of @xmath102 for which such an expansion remains valid .",
    "this is obtained by imposing the next - to - leading order term to be smaller than the leading one .",
    "we find @xmath103,\\ ] ] using the fitting formulae for @xmath90 and @xmath104 derived in @xcite we find that to good approximation @xmath105 with @xmath106 and @xmath107 for local and equilateral ng respectively .",
    "having inferred a lower limit on the interval validity of the bispectrum expansion up to next - to - leading order we can infer a more accurate estimate of its contribution to the multiplicity function . given the bispectrum expansion eq .",
    "( [ bispdec ] ) we can split eq .",
    "( [ fng ] ) as @xmath108 as shown in @xcite the leading order term is given by @xmath109 where @xmath110 is the probability distribution of the gaussian random walks in the case of the diffusing drifting barrier model given by eq .",
    "( 8) in @xcite .",
    "the integral can be computed analytically to finally obtain the leading order contribution to the multiplicity function @xcite :    @xmath111+\\\\ + \\dfrac{ds_3(\\sigma)}{d\\log\\sigma}\\biggl[\\dfrac{a}{\\sigma^2}\\delta_c^2 - 1 + 3 a\\beta \\delta_c+4 a\\beta^2\\sigma^2\\biggr ] \\biggr\\ } + \\dfrac{2}{3}a^3\\beta^3\\sigma^4 e^{-2a\\beta \\delta_c}\\text{erfc}\\biggl[\\sqrt{\\dfrac{a}{2\\sigma^2}}(\\delta_c-\\beta\\sigma^2)\\biggr]\\biggl\\ { 4 s_3(\\sigma)+\\dfrac{ds_3(\\sigma)}{d\\log\\sigma}\\biggr\\ }   \\end{split}\\ ] ]    on the other hand let us detail more the derivation of the next - to - leading order term which differs from that of @xcite . in such a case we have from eq .",
    "( [ fng ] ) that @xmath112 where we have decomposed the sum in eq .",
    "( [ fng ] ) and kept only the terms up to @xmath113 .",
    "in fact , as shown in @xcite the integral in @xmath114 of the terms with @xmath115 vanishes since the integrands are total derivatives .",
    "furthermore it is easy to show that @xmath116 , thus @xmath117 , \\end{split}\\ ] ] where the sum is bounded from below due to the fact that @xmath118 .",
    "the multiple integral in the above expression can be computed by part and using the fact that @xmath119 obeys the chapman - kolmogorov equation @xmath120 we have @xmath121 .",
    "\\end{split}\\ ] ] where @xmath122 and @xmath123 are given by eq .",
    "( 3.20 ) and ( 3.21 ) in @xcite respectively . in the continuous limit and",
    "taking into account that the bispectrum expansion up to next - to - leading order is valid in the range @xmath124 we have @xmath125 .",
    "finally , we obtain the first - crossing distribution to next - to - leading order which reads as @xmath126+s u_3\\frac{\\partial}{\\partial s}\\frac{\\partial^2 i_{nl}^{\\alpha}}{dy_{c}^2}\\right\\}\\ ] ] with @xmath127\\times\\\\ & \\times\\left\\{-2 a \\beta+a^2\\beta^2 \\delta_c+a\\frac{\\delta_c}{s_i}\\left[-3 + 2 a \\beta \\delta_c+a\\frac{\\delta_c^2}{s_i}\\right]\\right\\}\\times\\\\ & \\times\\left\\{e^{-\\frac{a}{2}\\beta^2(s - s_i)}+\\frac{\\beta}{2}\\sqrt{\\pi\\,a(s - s_i)}\\text{erfc}\\left[-\\beta\\sqrt{\\frac{a}{2}(s - s_i)}\\right]\\right\\ } \\end{split}\\ ] ] and @xmath128\\right\\}\\times\\\\ & \\times\\left\\{\\frac{e^{-\\frac{a}{2}\\beta^2(s - s_i)}}{2\\sqrt{s - s_i}}\\left[1-\\frac{1}{\\alpha}+\\frac{1}{\\alpha}\\frac{s_i}{s - s_i}+\\frac{1}{\\alpha}a\\beta^2\\frac{s+s_i}{\\sqrt{s - s_i}}\\right]+\\right.\\\\ & \\left.+\\sqrt{\\frac{a\\pi}{2}}\\beta\\left(1-\\frac{1}{\\alpha}\\right)\\text{erfc}\\left[-\\beta\\sqrt{\\frac{a}{2}(s - s_i)}\\right]\\right\\}. \\end{split}\\ ] ]    [ cols=\"^,^ \" , ]     to this purpose we set the ddb model parameters to their gaussian value . ] and plot in fig .",
    "[ fig4 ] the contribution of the bispectrum ( red dash line ) , trispectrum ( blue dot line ) and their sum ( black solid line ) to the multiplicity function for values of primordial non - gaussian amplitude which are consistent with cosmic microwave background ( cmb ) limits @xcite . in particular , we set @xmath129 , @xmath130 and consider @xmath131 ( bottom panel ) and @xmath132 ( top panel ) respectively .",
    "we can see that even for @xmath132 and @xmath130 the trispectrum signal exceeds that of the bispectrum only in a very limited low - mass range .",
    "in contrast , for @xmath131 and @xmath130 the trispectrum contribution to the non - gaussian multiplicity function remains very small compared to that of the bispectrum .",
    "this suggests that within current cmb limits , a violation of the suyama - yamaguci inequality will be hardly detectable solely using the halo mass function .",
    "it is possible that measurements of the galaxy bias may be more informative as investigated in @xcite . on the other hand constraints on the halo mass function from cluster counts",
    "may still be a useful probe when used in combination with estimates of the halo bias from the clustering of massive clusters . as shown in @xcite for the case of primordial bispectrum",
    ", these tests can provide improved constraints on primordial non - gaussianity from the upcoming generation of cosmic structure surveys .",
    "the halo mass function carries an imprint of the statistics of the primordial density field as well as the properties of the halo collapse process .",
    "the path - integral formulation of the excursion set theory provides a powerful and self - consistent mathematical framework to account for these effects on the halo mass function . here",
    ", we have extended a previous analysis @xcite and performed a more accurate derivation of the contribution of the primordial bispectrum expanded in the large scale limit to next - to - leading order for the diffusive drifting barrier model introduced in @xcite .",
    "we have shown that the next - to - leading order term of the primordial bispectrum decomposition contributes to no more than @xmath133 of the non - gaussian mass function .",
    "thus , for all practical purposes it can be neglected .",
    "we have also derived an analytic formula for the trispectrum contribution . as in the case of the bispectrum ,",
    "the multiplicity function depends on terms which couple the parameters encoding the ellipsoidal collapse of halos with the primordial four - point correlation function .",
    "also in this case we find that in the spherical collapse limit the trispectrum contribution reduces to the functional form derived in the press - schechter formalism using the edgeworth expansion .",
    "however , in order to reproduce n - body simulation results the latter requires two ad - hoc prescriptions .",
    "first , the non - gaussian prediction is rescaled by a gaussian simulation calibrated multiplicity function , such as to account for the imprints of the ellipsoidal collapse .",
    "thus , implicitly assuming that the effect of the non - spherical collapse of halos on the mass function is independent of the amplitude of primordial non - gaussianity .",
    "a good modelling of the collapse parameters is even more relevant for primordial trispectrum terms which act at low masses where the simple spherical collapse is not valid since qualitatively the trispectrum signature on the halo mass function can be mimic by a higher value of @xmath52 . in principle , the later can probe multi - field inflation by testing the validity of the suyama - yamaguchi inequality .",
    "however , assuming values of @xmath78 and @xmath134 consistent with current cmb limits , we find that bispectrum contribution is always the dominant ng signal .",
    "it is possible that tests of the scale dependent halo bias can be more informative regarding the trispectrum signature .",
    "in such a case , it will be interesting to investigate , in the context of the peak background split , how the mass filtering corrections and the coupling between non - spherical collapse parameters and primordial non - gaussian amplitudes alter the linear halo bias prediction .",
    "we thank james g. bartlett for his support and his advices .",
    "we also thank ruben van drongelen and koenraad schalm for useful discussions .",
    "i. achitouv is supported by a scholarship of the ` ministre de leducation nationale , de la recherche et de la technologie ' ( menrt ) .",
    "the research leading to these results has received funding from the european research council under the european community s seventh framework programme ( fp7/2007 - 2013 grant agreement no .",
    "279954 ) .      here",
    ", we derive the finite correction to the probability distribution of the random walks starting and ending at the barrier , @xmath135 which enters the calculation of the memory - of - memory term due to the non - markovian filter corrections ( see eq .  ( 11 ) in @xcite ) . following the derivation presented in @xcite",
    "let us consider the chapman - kolmogorov equation : @xmath136 with @xmath137 expanding in taylor series the left - hand - side of eq .",
    "( [ chapkol ] ) in powers of @xmath138 and the right - hand - side in powers of @xmath139 we obtain      it is worth noticing that the markovian probability distribution starting at the barrier value @xmath141 vanishes in @xmath142 while for @xmath143 the first finite corrections to the probability distribution function is in @xmath138 . at order one in @xmath138 for @xmath144",
    ", this equation gives @xmath145 which has the same form of than the fokker - planck equation associated with the markovian solution for the ddb model in the continuous limit whose solution for a barrier at a generic point @xmath146 is given by eq .",
    "( 3.11 ) in @xcite . in such case for @xmath143 the drifting term stay in factor of gaussian minus anti - gaussian .",
    "therefore we can assume that      the value of the constant @xmath148 can be evaluating using the path - integral eq .",
    "( [ piepsilon ] ) for @xmath149 with @xmath150 and the explicit form of @xmath151 given by eq .",
    "( a3 ) in @xcite .",
    "thus , equating eq .",
    "( [ barrtobarr ] ) on the left - hand - side to the result of the integral over @xmath82 on the right - hand - side we obtain : @xmath152 .    99 j. r. bond , s. cole , g. efstathiou & g. kaiser , astrophys .",
    "j. * 379 * , 440 ( 1991 ) w. h. press & p. schechter , astrophys .",
    "j. * 187 * , 425 ( 1974 ) m. maggiore & a. riotto , astrophys .",
    "j. * 711 * , 907 ( 2010 ) m. maggiore & a. riotto , astrophys .",
    "j. * 717 * , 515 ( 2010 ) m. maggiore & a. riotto , astrophys . j. * 717 * , 526 ( 2010 ) a. de simone , m. maggiore & a. riotto , mont . not .",
    "* 412 * , 2587 ( 2011 ) p.s .",
    "corasaniti and i.e. achitouv , phys .",
    "lett . * 106 * , 241302 ( 2011 ) p.s .",
    "corasaniti and i.e. achitouv , phys .",
    "d * 84 * , 023009 ( 2011 ) i.e. achitouv and p.s .",
    "corasaniti , jcap * 02 * , 002 ( 2012 ) e. audit , r. teyssier & j .-",
    "alimi , astron . & astrophys . *",
    "325 * , 439 ( 1997 ) r.k .",
    "sheth , h. j. mo & g. tormen , mont . not .",
    "* 323 * , 1 ( 2001 ) a. paranjape , r.k .",
    "sheth , arxiv:1206.3506 a. pillepich , c. porciani , o. hahn , mont . not .",
    "soc . * 402 * , 191 ( 2008 ) m. sasali , j. valiviita , d. wands , phys .",
    "d * 74 * , 103003 ( 2006 ) k. enqvist , t. takahashi , jcap 09 , 012 ( 2008 ) m. maggiore , a. riotto , mont . not .",
    "soc . , * 405 * , 1244 ( 2010 ) d.h .",
    "lyth , d. wands , phys . lett .",
    "b 524 , 5 ( 2002 ) m. , lo verde , a. miller , s. shandera , l. verde , jcap 04 , 014 ( 2008 ) t. suyama , m. yamaguchi , phys . rev .",
    "d * 77 * , 023505 ( 2008 ) s. yokoyama , n. sugiyama , s. zaroubi , j. silk , mont . not .",
    "soc . , * 417 * , 1074 ( 2011 ) m. biagetti , v. desjacques , a. riotto , arxiv:1208.1616 j. smidt et al . , phys .",
    "d * 81 * , 123007 ( 2010 ) a. pillepich , c. porciani , t.h .",
    "reiprich , mont . not .",
    "soc . , * 422 * , 44 ( 2012 )"
  ],
  "abstract_text": [
    "<S> the high - mass end of the halo mass function is a sensitive probe of primordial non - gaussianity ( ng ) . in a recent study @xcite </S>",
    "<S> we have computed the ng halo mass function in the context of the excursion set theory and shown that the primordial ng imprint is coupled to that induced by the non - linear collapse of dark matter halos . </S>",
    "<S> we also found an excellent agreement with n - body simulation results . here , we perform a more accurate computation which accounts for the interval validity of the bispectrum expansion to next - to - leading order and extend the calculation to the case of a non - vanishing primordial trispectrum . </S>"
  ]
}