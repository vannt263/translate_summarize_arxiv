{
  "article_text": [
    "a critical factor in the performance of rf linac free - electron lasers ( fels ) is the amplitude and phase uniformity of the high - power microwave pulses used to drive the electron gun and linac .",
    "amplitude non - uniformity contributes to an energy spread among the electron bunches and a loss of laser efficiency due to frequency pulling .",
    "phase irregularities in the rf waveform result in variations in the arrival time of the electron bunches , which reduces laser gain due to a loss of synchronism between the electron bunches and the circulating optical pulses in the laser .",
    "for example , a phase excursion of at delays the electron bunches by , which is the full width of a typical optical pulse , leading to reduced laser gain and reduced laser power .",
    "electron bunch synchronization is also of particular importance for the operation of optical storage cavity - based compton x - ray sources , such as the system currently under development at the university of hawaii@xcite .",
    "incoming electron bunches must be synchronized to the circulation time of laser pulses in the storage cavity , and any loss of beam synchronism in the scattering region will lead to reduced x - ray flux .",
    "a high power itt triton 2960 klystron is used to power the mkv fel s linac ; it amplifies low phase noise , low - level microwave pulses to the power level required for the acceleration of a relativistic electron beam .",
    "the accelerating potential of the klystron amplifier is responsible for the device s gain and takes the form of a pulse .",
    "uniformity of the klystron gain requires careful regulation of the pulse amplitude over its duration .",
    "this pulse results in a high voltage dc potential applied to the klystron , discharged through activation of a hydrogen thyratron switch via an lc resonant pulse forming network ( pfn ) .",
    "tuning the pfn resonant circuit allows the high voltage impulse through the thyratron to exhibit a flat - top required for uniform amplification of the rf pulse .",
    "but the `` flat top '' duration and quality of regulation are limited by the number of lumped elements in the pfn circuit .",
    "additionally , the complex gain of the klystron is affected by the time - dependence of the high voltage applied through the pfn , so the tuning procedure must be carried out based on the shape of the rf pulse waveform post - amplification . typically , only the amplitude of the rf pulse is optimized ( i.e. flattened ) with this tuning procedure , while realistically a phase shift of several degrees is still present over the output rf pulse duration .",
    "further optimization of the rf pulse amplitude and phase could be , and has been achieved by increasing the number of lumped elements in the pfn filter .",
    "tuning , however , is still a cumbersome and dangerous procedure .",
    "the existing mk3 pfn consists of eight sections of high voltage inductors and capacitors submerged in a large tank of dielectric oil and is unable to accommodate any further filter complexity within the present design .",
    "another approach to this regulation problem is the use of active feedback to provide a correction signal to either the high voltage pulse or input rf pulse .",
    "the most straightforward approach is to regulate the amplitude and phase of the input rf signal to compensate for any non - uniformity in the complex transfer function of the klystron .",
    "such a feedback loop requires fast measurement of the amplitude and/or phase of the high power rf output and a means to feed this signal back to an amplitude / phase modulator on the rf source .",
    "unfortunately , the long distances between components in the lab leads to latencies and long phase delays ( hundreds of ) .",
    "while the cable delays could in principle be reduced , ultimately the system latency is limited by the e - beam propagation delay in the klystron itself .",
    "these effects make a high bandwidth and stable feedback loop impractical in this system .",
    "alternatively , given the good pulse to pulse repeatability of the high power rf system , and slow drift in the amplitude and phase perturbations observed in the output rf pulse , a compensation scheme can be applied .",
    "this compensation is not applied in real time to each pulse as in conventional feedback , but rather , is applied to subsequent pulses , which is termed feed - forward .",
    "the rf pulse amplitude and phase are measured in real time and the data are used to compute correction waveforms . using arbitrary waveform generators ,",
    "the corrections are applied to amplitude and phase modulators acting on the klystron input rf pulse .",
    "subsequent measurements of the amplitude and phase are performed on the compensated high power rf pulse and allow iterative correction of any residual error .",
    "similar , but independent , feed - forward compensation systems have been implemented at several other accelerator facilities@xcite . only recently",
    ", however , has direct quadrature demodulation been used to measure the amplitude and phase of the rf waveform to be compensated@xcite .",
    "the present paper reports what we believe is the first application of a feed - forward system using the quadrature demodulation technique to the operation of an fel and the diagnostics necessary to operate an inverse - compton source .",
    "not only can the amplitude and phase of the rf pulse be normalized to remove the ripples observed in the rf and electron beam systems , but custom waveforms may be sculpted to optimize the performance of the free - electron laser and optical storage cavity - based x - ray source .",
    "the measurement apparatus has also served as a versatile tool for diagnostics and analysis of signals related to the electron beam and rf power system .",
    "this paper describes the design and performance of the feed - forward stabilization system developed and currently operated at uh .",
    "section  [ sec : analytictech ] gives an analytic description of the demodulation techniques used to construct the feed - forward error signal , while section  [ sec : implementation ] reviews the hardware and software used to implement this solution .",
    "section  [ sec : results ] describes the performance of the feed - forward phase compensation and the later addition of amplitude compensation capabilities .",
    "finally , planned future improvements to the system are presented in section  [ sec : future ] .",
    "[ sec : directconversion ] the phase and amplitude of the rf waveform to be corrected are reconstructed using direct quadrature demodulation ( iq demodulation ) .",
    "the received rf signal is written as @xmath0 , where @xmath1 and @xmath2 are the amplitude and phase modulation components and @xmath3 is the rf carrier frequency .",
    "the signal is split , with one of the replicas delayed in phase by , giving @xmath4 .",
    "the two split signals are then separately mixed ( multiplied ) with an unmodulated reference signal @xmath5 at the rf frequency @xmath6 giving :    @xmath7    a low - pass filter removes the second harmonic @xmath8 , component yielding the in - phase and quadrature signals :    @xmath9    now the amplitude and phase are reconstructed using : @xmath10    the reconstructed amplitude and phase error signals from ( [ eqn : defamp ] ) and ( [ eqn : defphase ] ) are used to drive separate arbitrary waveform generators for the amplitude and phase feed - forward signals , respectively . in the present compensation scheme , each correction signal is programmed to be directly proportional to the error signal and then shifted by a fixed time delay .",
    "the proportionality constant and time delay are chosen empirically to minimize the fluctuations in subsequent pulses .",
    "figure  [ fig : sysoverview ] shows the major components of the amplitude and phase compensation system .",
    "the rf signal chain for the mkv fel consists of the components in the first row of the block diagram .",
    "an hp8616a klystron - based , microwave signal generator is used as the master oscillator for the entire rf system .",
    "the hp8616a includes a voltage controlled pin diode attenuator that can be used to apply amplitude modulation from an external source .",
    "the cw signal is then chopped into pulses at using a pin diode switch .",
    "next , a slac - designed voltage controlled phase modulator is used to apply a compensating phase modulation to the pulses .",
    "the modulator is capable of producing a phase shift with a control signal .",
    "the modulated rf pulses are finally amplified by the itt klystron and the resulting @xmath11 pulses are delivered to the linac via an evacuated copper waveguide . a directional coupler at the input to the linac",
    "is used to sample the rf pulses for feed - forward .",
    "the overall modulation bandwidth of this system is limited by the high power klystron to approximately .",
    "the signal chassis contains the hardware necessary to demodulate the sampled rf pulses for analysis as described in section  [ sec : directconversion ] .",
    "a hittite microwave digital attenuator provides up to attenuation for calibration of input signal amplitude , while a second slac phase modulator is used to vary the absolute phase by up to for calibration purposes .",
    "both of these devices are controlled from a control pc connected via usb .",
    "a mini - circuits zx10q-2 - 34-s+ hybrid splitter is used to divide the signal into two components of equal amplitude with a phase difference between them .",
    "next , the split signals are separately mixed in minicircuits zem-4300 + double - balanced mixers with a phase reference to produce the in - phase and quadrature signals .",
    "the reference signal is derived from an unmodulated output of the hp8616a and divided with a power splitter .",
    "this hardware is assembled in a 19  inch rackmount chassis ( see figure  [ fig : chassisphoto ] ) with associated power supplies and other standard components .",
    "the pulse waveforms for the in - phase and quadrature signals are sampled using a rigol ds1102e , 8-bit precision oscilloscope .",
    "the resulting 600 waveform samples at intervals over are then transmitted over usb to a control pc running linux .",
    "the control software , described in section  [ sec : software ] , derives compensation waveforms from the digitized in - phase and quadrature data .",
    "two berkeley nucleonics bnc645 14-bit , arbitrary waveform generators ( awgs ) are programmed with the calculated compensation waveforms via usb , which are then applied to the amplitude and phase modulators for feed - forward to subsequent rf pulses .",
    "the oscilloscope , awg s , and pin diode switch are all synchronized with a common trigger signal .",
    ", width=323 ]      the feed - forward system is controlled from a pc running linux in the fel control room .",
    "the instrumentation is directly connected to the pc via usb cables .",
    "the control software is written in the python programming language with a graphical user interface ( gui ) utilizing the wxpython@xcite , and matplotlib@xcite toolkits .",
    "the layout of this gui is shown in figure  [ fig : gui ] .",
    "the oscilloscopes and arbitrary waveform generator are both compliant with the usbtmc interface standard , which allows for familiar gpib style control via a modern usb connection .",
    ", width=322 ]    the control software uses a modular design to facilitate future maintenance and upgrades .",
    "the gui provides a user friendly subset of commands for day - to - day use of the system .",
    "a command line interface ( cli ) provides more comprehensive access to all system functionality .",
    "the cli allows scripts to automate common measurement and calibration tasks .",
    "these high - level interfaces are based on a low - level software module that provides programatic control over all functions of the system .",
    "additional command line programs allow for offline analysis of captured data .",
    "the feed - forward system allows the compensation of the rf phase based on an rf measurement made at any point in the accelerator system . for example",
    ", the rf waveform sampled at the linac feed point may be used to derive a feed - forward compensation correcting the waveform at that point . ultimately , it is the phase of the actual electron bunches that must be compensated , so the signal from one of several beam position monitors will eventually be sampled and corrected .",
    "strip - line and image current beam position monitors ( bpms ) provide a signal proportional to electron beam current at several positions along the beam - line and have sufficient bandwidth to resolve the bunch repetition rate of the beam current .",
    "the system was initially commissioned with only phase compensation capability for rf pulses measured at the accelerator input port .",
    "the compensation waveform is simply a scaled and time shifted copy of the measured phase waveform .",
    "the appropriate delay was determined empirically by shifting the compensation waveform in increments to minimize residual ripple in the measured phase .",
    "the phase ripple was also minimized for a scale factor corresponding to a negative unity gain through the system ( a requirement of feed - forward systems ) .",
    "the empirically optimized scale factor corresponds to the measured gain of the slac phase shifter .",
    "figure [ fig : pmwaveform ] shows the effect of the phase compensation system on a window in flat - top region of the rf pulse waveform .",
    "these data show that the phase ripple is reduced from @xmath12 to @xmath13 within the measurement window , an 80% reduction .",
    "this measured phase ripple is limited by the @xmath14 phase resolution imposed by the quantization error of the 8-bit oscilloscope used for waveform sampling .    , width=324 ]    this system has proven useful not only for feed - forward compensation , but also as a general purpose measurement tool for rf diagnostics . beyond the linac drive system ,",
    "the bunch repetition rate is present in every part of the system .",
    "the ability to easily measure rf amplitude and phase modulations yields a very useful diagnostic for understanding the micro - pulse structure of the electron beam and free - electron laser .",
    "the system has been successfully demonstrated with alternate rf sources such as beam position monitors and fast photodetectors .",
    "it may even be possible to use these signals for feed - forward compensation of the rf waveform to control the structure of these alternate source signals .",
    "laser performance is evaluated using the spectrogram , or frequency vs. time plot , as a fundamental diagnostic of the performance of the free - electron laser .",
    "the spectrograms in figure [ fig : spectrogram ] show both the temporal and spectral evolution of fel pulses .",
    "these data are the result of capturing the laser pulse waveform after filtering by a scanning monochromator .",
    "since this measurement involves a slow spectral scan of the laser , the spectrogram comprises a record of the laser performance over many independent pulses .",
    "random variations in the electron beam energy are evident from the horizontal bands seen in the image .",
    "figure  [ fig : comparepowerandspectrum ] shows the projection of the two spectrograms onto their spectral and temporal axes .",
    "these data clearly show a change in laser performance with phase compensation activated .",
    "when compensation is applied the laser pulse turns on sooner , and the duration is extended by 67% , while the fwhm spectral width sharpens by 20% .    without phase compensation ( figure  [ fig : spectrogram]a )",
    "there are two distinct peaks in the spectrogram , with the laser initially starting at a longer wavelength then lasing more strongly at a shorter wavelength . with phase compensation",
    "( figure  [ fig : spectrogram]b ) , the instantaneous spectrum is substantially narrower and is pulled continuously towards longer wavelengths .",
    "this wavelength pulling agrees in both sign and magnitude with the frequency pulling phenomenon predicted by fel theory@xcite , and is likely disrupted in figure  [ fig : spectrogram]a due to the presence of phase perturbations in the electron beam . with our system",
    ", it should be possible to deliberately introduce a phase slew that compensates the frequency pulling effect , thus producing fel macro - pulses better suited for use in the optical storage cavity - based x - ray source .",
    "in addition , the technique of `` dynamic desynchronism''@xcite can be implemented using our system to improve laser turn - on time and stability .",
    "to evaluate the intrinsic effectiveness of the compensation , we performed numerical simulations of the mkv fel driven by electron pulse trains of constant energy subject to the phase perturbations depicted in figure  [ fig : pmwaveform ] and by electron pulses with no phase perturbation .",
    "these simulations are based on a one - dimensional numerical integration of the coupled maxwell - lorentz equations of motion describing the fel interaction , in which the transverse profiles of the electron and optical beams are incorporated analytically@xcite .",
    "the present simulations were modified from earlier published studies by allowing the arrival time of the electron bunches to vary in accordance with the phase variations measured by the feed - forward system , which is an appropriate measure since the emission time of the electron bunches is primarily determined by the phase of the rf wave in the thermionic microwave gun .",
    "the remaining simulation parameters describing the electron beam , optical beam and fel undulator were consistent with those of the mkv fel@xcite .",
    "the fundamental indicator of laser performance in an rf linac fel is the cavity detuning curve of laser energy versus cavity length , which quantifies the mode locking efficiency of the picosecond laser pulses by the ghz - rate electron bunches .",
    "figure  [ fig : detuning ] displays the simulated cavity detuning curves corresponding to the uncompensated and compensated phase perturbations in figure  [ fig : pmwaveform ] , together with the detuning curve for an electron beam with no perturbation ( perfect timing ) .",
    "the detuning curve for the uncompensated laser reveals significant degradation of laser energy compared to the phase - compensated detuning curve .",
    "the phase - compensated curve is more sharply peaked and displays the fundamental , asymmetric shape of the fel detuning curve due to refractive effects in the electron beam@xcite , and yields essentially the same shape and width as the detuning curve for the perfect beam , with less than a 10% reduction in pulse energy .",
    "these results indicate that the phase compensation achieved with the present system @xmath15 is sufficient to recover essentially optimum laser performance .",
    ", width=324 ]    to complete the numerical studies , we simulated the temporal evolution of the laser power and wavelength during the rf pulse for both the uncompensated and phase - compensated electron beams at the cavity lengths corresponding to maximum laser energy in figure  [ fig : detuning ] .",
    "the graph of laser power in figure  [ fig : simpower ] shows that the phase - compensated laser turns on substantially sooner than the uncompensated laser , as we observed empirically in figure  [ fig : comparepowerandspectrum]a .",
    "the graph of laser wavelength in figure  [ fig : simfreq ] shows that frequency - pulling towards longer wavelengths , which is significantly disrupted in the uncompensated laser , is recovered in the phase - compensated laser , as we observed empirically in figure  [ fig : spectrogram]b .",
    "these experimental and numerical results indicate that phase - compensation is an important capability for all future fel operation .    ,",
    "width=324 ]    , width=324 ]      while phase compensation has notably improved laser performance , significant ripple is still present in the amplitude driving the linac , causing an effective energy spread in the electron pulse train .",
    "the subsequent addition of amplitude compensation capability has demonstrated a significant reduction in the energy spread of the electron beam , and should be able to correct e - beam perturbations introduced by beam loading in the electron gun , resulting in a more uniform electron beam current . since the hardware was designed to capture the complex i / q signal ( see section [ sec : directconversion ] ) , the modifications necessary to include amplitude compensation involved upgrading the software to derive a feed - forward signal from the measured amplitude .",
    "an additional independent bnc model 645 arbitrary waveform generator is programmed with the amplitude compensation waveform in the same manner as the phase compensation awg . the awg output",
    "is then fed to the pin diode amplitude modulator in the hp8616 microwave source .",
    "additional controls added to the graphical user interface allow for optimization of the compensation delay and gain , and the target rf power level .    , width=324 ]    figure  [ fig : amresult ] shows the rf waveform phase and amplitude measured at the linac input port with phase and amplitude compensation turned on and off .",
    "the phase ripple is reduced to , an improvement of 83% , basically the same result as seen with phase compensation alone .",
    "the amplitude ripple is now also reduced by 63% corresponding to an 85% reduction in rf power ripple .",
    "the magnitude of both the residual amplitude and phase ripples are consistent with the theoretical performance limit of the system set by the use of an 8-bit oscilloscope .",
    "the resulting e - beam with phase and amplitude compensation exhibited greatly reduced energy spread .",
    "figure  [ fig : pamspectrum ] compares the measured electron beam spectrum for amplitude and phase compensation , phase compensation only , and no compensation .",
    "phase compensation alone provides a 28% reduction in the beam energy spread while both amplitude and phase decrease spectral width by 57% to an energy spread of 0.3% for a electron beam .",
    "consistent with this reduction in energy spread , we also observed significantly improved focal spot performance at the mini - beta position of our e - beam chicane , which should greatly improve x - ray efficiency in our inverse compton system .    , width=324 ]",
    "the preliminary results presented above have demonstrated that amplitude and phase compensation dramatically improve the quality of the electron beam and enhance laser performance of the mkv fel at the university of hawaii .",
    "a more sophisticated compensation algorithm should be capable of further reducing the residual phase and amplitude ripples in the rf signal .",
    "the present algorithm produces the compensation waveform by simply scaling and shifting the measured error waveform .",
    "this technique relies on the assumption that the feed - forward bandwidth is infinite ( i.e. the impulse response @xmath16 ) . by measuring the actual transfer function of the system",
    ", a more accurate compensation waveform can be constructed through deconvolution of the error waveform and the system impulse response .    proposed enhancements to",
    "the control software will allow for self - adaptive iterative compensation@xcite that we expect will reduce the effects of systematic errors due to nonlinearities in the feed - forward loop .",
    "while we have achieved good performance with a single iteration , this approach will also aid in the transition to a completely automated system .",
    "the resolution of the measured amplitude , and thus the compensation effectiveness , are presently limited by the 8-bit dynamic range of the available digital oscilloscope .",
    "performance could likely be improved by upgrading to higher resolution waveform sampling electronics .",
    "laser performance may be further enhanced through compensation based on measurements of the actual electron beam current and phase waveforms as mentioned in section  [ sec : phasecomp ] .",
    "while the amplitude and phase of the rf drive to the linac may be compensated with a simple linear correction model , the situation for the electron beam is more complex .",
    "the phase and energy spread of electron bunches exiting the linac are affected by the amplitude of the accelerating field , not only its phase .",
    "implementation of a compensation scheme using the electron bunch phase measured by a strip - line bpm will require careful studies of the accelerator transfer function and the deconvolution of sampled beam data .",
    "the hardware described in this paper is sufficient to meet the needs of such a system with the future work focused primarily on software development .",
    "the feed - forward amplitude and phase compensation system recently implemented on the mkv fel at the university of hawaii has proven very effective in reducing the amplitude and phase ripples on the accelerator rf drive and electron beam .",
    "flat phase is essential to the efficient operation of the free - electron laser and an 80% improvement has been realized .",
    "these performance enhancements are important steps to maximizing the peak power and pulse length of the fel used to pump the storage cavity and will enhance the x - ray production rate in our inverse compton system .",
    "the reduced energy spread of electron beam should also reduce the spectral width of the x - ray beam , further increasing the spectral brightness . while a more sophisticated compensation algorithm may result in further reduction of the amplitude and phase ripple ,",
    "the principal performance limitation is the use of 8-bit waveform sampling .",
    "however , even with the dynamic range limited by the oscilloscope we have been able to achieve a phase ripple that simulations show is near optimal for laser operation .",
    "14ifxundefined [ 1 ] ifx#1 ifnum [ 1 ]",
    "# 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty _ _ , @noop ph.d .",
    "thesis ,   ( ) link:\\doibase 10.1016/0168 - 9002(93)91045-o [ * * ,   ( ) ] link:\\doibase 10.1016/0168 - 9002(95)01317 - 2 [ * * ,   ( ) ] ,   link:\\doibase 10.1016/s0168 - 9002(98)00045-x [ * * ,   ( ) ] link:\\doibase 10.1016/j.nima.2012.03.004 [ * * ,   ( ) ] in  @noop _ _  ( ,  )  pp .   in  @noop",
    "_ _  ( ,  )  pp .",
    "@noop `` , '' @noop * * , ( ) , @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) ,   in  @noop _ _ ,  vol .",
    "( ,  )  pp ."
  ],
  "abstract_text": [
    "<S> an amplitude and phase compensation system has been developed and tested at the university of hawaii for the optimization of the rf drive system to the mark  v free - electron laser . </S>",
    "<S> temporal uniformity of the rf drive is essential to the generation of an electron beam suitable for optimal free - electron laser performance and the operation of an inverse compton scattering x - ray source . </S>",
    "<S> the design of the rf measurement and compensation system is described in detail and the results of rf phase compensation are presented . </S>",
    "<S> performance of the free - electron laser was evaluated by comparing the measured effects of phase compensation with the results of a computer simulation . </S>",
    "<S> finally , preliminary results are presented for the effects of amplitude compensation on the performance of the complete system . </S>"
  ]
}