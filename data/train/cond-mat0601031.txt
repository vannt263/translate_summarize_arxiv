{
  "article_text": [
    "plane waves expansions with periodic boundary conditions have been proven to be a very effective way to exploit the translational symmetry of infinite crystal solids , in order to calculate the properties of the bulk , by performing the simulations in one of its primitive cells only  @xcite .",
    "the use of plane waves is motivated by several facts .",
    "first , the translational symmetry of the potentials involved in the calculations is naturally and easily accounted for in reciprocal space , through the fourier expansion .",
    "second , very efficient and fast algorithms exist ( like fftw@xcite ) that allow us to calculate the fourier transforms very efficiently .",
    "third the expansion in plane waves is exact , since they form a complete set , and it is only limited in practice by one parameter , namely , the maximum value of the momentum , that determines the size of the chosen set .",
    "fourth , in many cases , the use of born - von karmn periodic boundary conditions supplies a conceptually easy ( though artificial ) way to get rid of the dependence of the properties of a specific sample on its surface and shape , allowing us to concentrate on the bulk properties of the system in the thermodynamic limit.@xcite    however , mainly in the last decade , increasing interest has been developed in systems at the nano - scale , like tubes , wires , quantum - dots , biomolecules , etc . , whose physical dimensionality is , for all practical purposes , less than three.@xcite these systems are still 3-dimensional ( 3d ) , but their quantum properties are those of a confined system in one or more directions , and those of a periodic extended system in the remaining directions .",
    "other classes of systems with the same kind of reduced periodicity are the classes of the polymers , and of the solids with defects .    throughout this paper",
    "we call nd - periodic a 3d object , that can be considered infinite and periodic in @xmath0 dimensions , being finite in the remaining @xmath1 dimensions . in order to simulate this kind of systems ,",
    "a commonly adopted approach is the supercell approximation.@xcite    in the supercell approximation the physical system is treated as a fully 3d - periodic one , but a new unit cell ( the supercell ) is built in such a way that some extra empty space separates the periodic replica along the direction(s ) in which the system is to be considered as finite .",
    "this method makes possible to retain all the advantages of plane waves expansions and periodic boundary conditions . yet",
    "the use of a supercell to simulate objects that are not infinite and periodic in all the directions , leads to artifacts , even if a very large portion of vacuum is interposed between the replica of the system in the non - periodic dimensions .",
    "in fact , the straightforward application of the supercell method generates in any case fake images of the original system , that can mutually interact in several ways , affecting the results of the simulation .",
    "it is well known that the response function of an overall neutral solid of molecules is not equal , in general , to the response of the isolated molecule , and converges very slowly to it , when the amount of vacuum in the supercell is progressively increased.@xcite    for instance , the presence of higher order multipoles can make undesired images interact via the long range part of the coulomb potential . in the dynamic regime , multipoles are always generated by the oscillations of the charge density even in systems whose unit cell does not carry any multipole in its ground state .",
    "this is the case , for example , when we investigate the response of a system in presence of an external oscillating electric field .",
    "things go worse when the unit cell carries a net charge , since the total charge of the infinite system represented by the supercell is actually infinite , while the charges at the surfaces of a finite , though very large system always generate a finite polarisation field .",
    "this situation is usually normalised in the calculation by the introduction of a suitable compensating positive background charge .",
    "another common situation in which the electrostatics is known to modify the ground state properties of the system occurs when a layered system is studied , and an infinite array of planes is considered instead of a single slab , being in fact equivalent to an effective chain of capacitors.@xcite    these issues become particularly evident in all the approaches that imply the calculation of non - local operators or response functions , because , in these cases , two supercells may effectively interact even if their charge densities do not overlap at all .",
    "this is the case , for example , of the many - body perturbation theory calculations ( mbpt ) , and , in particular , of the self - energy calculations at the gw level.@xcite    however we are usually still interested in the dispersion relations of the elementary excitations of the system along its periodic directions , and those are ideally dealt with using a plane waves approach .",
    "therefore , the ideal path to keep the advantages of the supercell formulation in plane waves , and to gain a description of systems with reduced periodicity free of spurious effects is to develop a technique to cut the coulomb interaction off out of a desired region .",
    "this problem is not new and has been addressed now for a very long time and in different fields ( condensed matter , classical fields , astrophysics , biology , etc ) .",
    "several different approaches have been proposed in the past to solve it , however a complete review of them is beyond the scope of this paper .",
    "the aim of the present work is to focus on the widely used supercell schemes to show how the image interaction influences both the electronic ground state properties and the dynamical screening in the excited state of 0d- , 1d- , 2d - periodic systems , and to propose an exact method to avoid the undesired interaction of the replicas in the non - periodic directions .",
    "the paper is organised as follows : in sec .",
    "[ sect-3d ] the basics of the plane wave method for solids are reviewed , in sec .",
    "[ sect - nd ] the new method is outlined , in sec .",
    "[ sect - singular ] the treatment of the singularities is explained , in sec .  [ sect - results ]",
    "some applications of the proposed technique are discussed .",
    "the main problem of electrostatics we are facing here can be reduced to the problem of finding solutions to the poisson equation for a given charge distribution @xmath2 , and given boundary conditions @xmath3 in a finite system the potential is usually required to be zero at infinity . in a periodic system this condition is meaningless , since the system itself extends to infinity .",
    "nevertheless the general solution of eq .",
    "( [ poissoneq ] ) in both cases is known in the form of the convolution @xmath4 that it is referred from now on as the hartree potential .",
    "it might seem that the most immediate way to build the solution potential for a given charge distribution is to compute the integral in real space , but problems immediately arise for infinite systems .",
    "in fact , the density can be reduced to an infinite sum over delta charge distributions @xmath5 , @xmath6 and the integral in eq .",
    "( [ defhartree ] ) becomes an infinite sum as well , but this sum is in general only conditionally , and not absolutely convergent.@xcite the sum of eq .",
    "( [ 1dcoulombsum ] ) a potential that is determined up to a constant for a neutral cell with zero dipole moment , while the corresponding sum for the electric field is absolutely convergent . a neutral cell with a non null dipole moment , on the opposite , gives a divergent potential , and an electric field that is determined up to an unknown constant electric field ( the sum for the electric field is conditionally convergent in this case ) .",
    "even if , in principle , the surface terms have to be always taken into account , in practice they are only relevant when we want to calculate energy differences between states with different total charge . these terms can be neglected in the case of a neutral cell whose lowest nonzero multipole is quadrupole@xcite . as in the present work we are interested in macroscopic properties of the periodic system ,",
    "those surface effects are never considered in the discussion that follows .",
    "however this sample - shape effects play an important role for the analysis of different spectroscopies as , for example , infrared and nuclear magnetic resonance .    a major source of computational problems is the fact that the sum in eq .",
    "( [ 1dcoulombsum ] ) is very slowly converging when it is summed in real space , and this fact has historically motivated the need for reciprocal space methods to calculate it .",
    "it was ewald who first discovered that , by means of an integral transform , the sum can be split in two terms , and that if one is summed in real , while the other in reciprocal space , both of them are rapidly converging.@xcite the point of splitting is determined by an arbitrary parameter .",
    "let us now focus on methods of calculating the sum in eq .",
    "( [ 1dcoulombsum ] ) purely based on the reciprocal space .",
    "if we consider a periodic distribution of charges with density @xmath2 such that @xmath7 , with @xmath8 , and @xmath9 , it turns out that the reciprocal space expression for a potential like @xmath10 in a 3d - periodic system , can be written as @xmath11 where we have used the convolution theorem to transform the real space convolution of the density and the coulomb potential into the product of their reciprocal space counterparts .",
    "here @xmath12 are the multiples of the primitive reciprocal space vectors @xmath13 , and @xmath14 is the fourier transform of the long range interaction @xmath15 , evaluated at the point @xmath16 . for the coulomb potential",
    "it is @xmath17    fourier transforming expression ( [ defhartreereciproc ] ) back into real space we have , for a unit cell of volume @xmath18 , @xmath19    at the singular point @xmath20 the potential @xmath21 is undefined , but , since the value at @xmath22 corresponds to the average value of @xmath21 in real space , it can be chosen to be any number , corresponding to the arbitrariness in the choice of the static gauge ( a constant ) for the potential .",
    "observe that the same expression can be adopted in the case of a charged unit cell , but this time , the arbitrary choice of @xmath23 in @xmath22 corresponds to the use of a uniform background neutralising charge .",
    "it has been shown@xcite that the slab capacitance effect mentioned in the introduction actually is a problem that can not be solved by just adding more vacuum to the supercell .",
    "this has initially led to the development of corrections to ewald s original method@xcite , and then to rigorous extensions in 2d and 1d.@xcite the basic idea is to restrict the sum in reciprocal space to the reciprocal vectors that actually correspond to the periodic directions of the system .",
    "these approach are in general of order @xmath24@xcite , but they have been recently refined to order @xmath25.@xcite another class of techniques , developed so far for finite systems , is based on the expansion of the interaction into a series of multipoles ( fast multipole method).@xcite with this technique it is possible to evaluate effective boundary conditions for the poisson s equations at the cell s boundary , so that the use of a supercell is not required at all , making it computationally very efficient for finite@xcite and extended systems@xcite .",
    "other known methods , tipically used in molecular dynamics simulations , are the multipole - correction method@xcite , and the particle - mesh method@xcite , whose review is beyond the scope of the present work , and we refer the reader to the original works for details .    differently from what happens for the ewald sum , the method that we propose to evaluate the sum in eq .",
    "( [ 1dcoulombsum ] ) entirely relies on the fourier space and amounts to screening the unit cell from the undesired effect of ( some of ) its periodic images .",
    "the basic expression is eq .",
    "( [ defhartreereciproc ] ) , whose accuracy is only limited by the maximum value @xmath26 of the reciprocal space vectors in the sum . since there is no splitting between real and reciprocal space , no convergence parameters are required .",
    "our goal is to transform the 3d - periodic fourier representation of the hartree potential of eq .",
    "( [ defhartreereciproc ] ) into the modified one @xmath27 such that all the interactions among the undesired periodic replica of the system disappear .",
    "the present method is a generalisation of the method proposed by jarvis _",
    "et al._@xcite for the case of a finite system .    in order to build this representation ,",
    "we want to : 1 ) define a screening region @xmath28 around each charge in the system , out of which there is no coulomb interaction ; 2 ) calculate the fourier transform of the desired effective interaction @xmath29 that equals the coulomb potential in @xmath30 , and is @xmath31 outside @xmath30    @xmath32    finally we must 3 ) modify the density @xmath2 in such a way that the effective density is still 3d - periodic , so that the convolution theorem can be still applied , but densities belonging to undesired images are not close enough to interact through @xmath29 .",
    "the choice of the region @xmath30 for step 1 ) is suggested by symmetry considerations , and it is a sphere ( or radius @xmath33 ) for finite systems , an infinite cylinder ( of radius @xmath33 ) for 1d - periodic systems , and an infinite slab ( of thickness @xmath34 ) for 2d - periodic systems .",
    "step 2 ) means that we have to calculate the modified fourier integral @xmath35 still we have to avoid that two neighbouring images interact by taking them far away enough from each other .",
    "then step 3 ) means that we have to build a suitable supercell , and re - define the density in it .",
    "let us examine first step 2 ) , i.e. the cutoff coulomb interaction in reciprocal space .",
    "we know the expression of the potential when it is cutoff in a sphere.@xcite it is @xmath36.\\ ] ] the limit @xmath37 converges to the bare coulomb term in the sense of a distribution , while , since @xmath38 , there is no particular difficulty in the origin .",
    "this scheme has been successfully used in many applications@xcite .",
    "the 1d - periodic case applies to systems with infinite extent in the @xmath39 direction , and finite in the @xmath40 and @xmath41 directions .",
    "the effective coulomb interaction is then defined in real space to be @xmath31 out of a cylinder of radius @xmath33 having its axis parallel to the @xmath39 direction . by performing the fourier transformation",
    "we get the following expression for the cutoff coulomb potential in cylindrical coordinates:@xcite @xmath42,\\end{gathered}\\ ] ] where @xmath43 and @xmath44 are the ordinary and modified cylindrical bessel functions , and @xmath45 .",
    "it is easy to realise that , since the @xmath44 functions damp the oscillations of the @xmath43 functions very quickly , for all practical purposes this cutoff function only acts on the very first smaller values of @xmath46 , while the unscreened @xmath47 behaviour is almost unchanged for the larger values .",
    "unfortunately , while the @xmath48 functions have a constant value for @xmath49 , and the whole cutoff is well defined for @xmath50 , the @xmath51 function diverges logarithmically for @xmath52 .",
    "since , on the other hand , @xmath53 for small @xmath54 , @xmath55 this means that the limit @xmath56 does not exist for this cutoff function , and the whole @xmath57 plane is ill - defined .",
    "we will come back to the treatment of the singularities in the next section .",
    "we notice that this logarithmic divergence is the common dependence one would get for the electrostatic potential of a uniformly charged 1d wire@xcite .",
    "it is expected that bringing charge neutrality in place would cancel this divergence ( see below ) .",
    "the 2d - periodic case , with finite extent in the @xmath41 direction , is calculated in a similar manner .",
    "the effective coulomb interaction is defined in real space to be @xmath31 out of a slab of thickness @xmath34 symmetric with respect to the @xmath58 plane . in cartesian",
    "coordinates we get @xmath59,\\end{aligned}\\ ] ] where @xmath60 .    in the limit @xmath37",
    "the unscreened potential @xmath47 is recovered .",
    "similarly to the case of 1d , the limit @xmath61 does not exist , since for @xmath62 , the cutoff has a finite value , while it diverges in the limit @xmath63 @xmath64    so far we havent committed to a precise value of the cutoff length @xmath33 .",
    "this value has to be chosen , for each dimensionality , in such a way that it avoids the interaction of any two neighbour images of the unit cell in the non - periodic dimension .    in order to fix the values of @xmath33",
    "we must choose the size of the supercell .",
    "this leads us to the step 3 ) of our procedure .",
    "we recall that even once the long range interaction is cutoff out of some region around each component of the system , this is not sufficient yet to avoid the interaction among undesired images .",
    "the charge density has to be modified , or , equivalently , the supercell has to be built in such a way that two neighbouring densities along every non periodic direction do not interact via the cutoff interaction .",
    "it is easy to see how this could happen in the simple case of a 2d square cell of length @xmath65 : if both @xmath66 and @xmath67 belongs to the cell , then @xmath68 , and @xmath69 ( see the schematic drawing in fig .",
    "[ fig - pad_all ] ) .",
    "if a supercell is built that is smaller than @xmath70 , there could be residual interaction , and the cutoff would no longer lead to the exact removal of the undesired interactions .",
    "let us call @xmath71 the unit cell of the system we are working on , and @xmath72 the set of all the cells in the system .",
    "if the system is nd - periodic this set only includes the periodic images of @xmath71 in the @xmath0 periodic directions .",
    "let us call @xmath73 the set of all the non - physical images of the system , i.e. those in the non - periodic directions",
    ". then @xmath74 . obviously , if the system is 3d - periodic @xmath75 , and @xmath76 .",
    "in general we want to allow the interaction of the electrons in @xmath71 with the electrons in all the cells @xmath77 , but not with those @xmath78 . to obtain this",
    "we define the supercell @xmath79 such that , @xmath80 @xmath81 ( see fig .",
    "[ fig - pad_all ] for a simplified 2d sketch ) .",
    "the new density @xmath82 is such that @xmath83 the size @xmath84 of the super - cell in the non - periodic directions depends on the periodic dimensionality of the system . in order to completely avoid any interaction , even in the case the density of the system",
    "is not zero at the cell border , it has to be @xmath85 actually , since the required super - cell is quite large , a compromise between speed and accuracy can be achieved in the computation , using parallelepiped super - cell with @xmath86 for all the cases .",
    "this approximation rests on the fact that the charge density is usually contained in a region smaller than the cell in the non - periodic directions , so that the spurious interactions are , in fact , avoided , even with a smaller cell .",
    "therefore , on the basis of this approximation , we can choose the value of the cutoff length @xmath33 always as half the smallest primitive vector in the non - periodic dimension .",
    "the main point in the procedure of eliminating the divergences in all the cases of interest is to observe that our final goal is usually not to obtain the expression of the hartree potential _",
    "alone _ , because all the physical quantities depend on the total potential , i.e. on the sum of the electronic and the ionic potential .",
    "when this sum is considered we can exploit the fact that each potential is defined up to an arbitrary additive constant , and choose the constants consistently for the two potentials .",
    "since we know in advance that the sum must be finite , we can include , so to speak , all the infinities into these constants , provided that we find a method to separate out the long range part of both potentials on the same footing .    in what follows",
    "we show how charge neutrality can be exploited to obtain the",
    "_ exact cancellations _ when operating with the cutoff expression of sec .",
    "[ sect - nd ] in fourier space .",
    "the total potential of the system is built in the following way : we separate out first short and long range contributions to the ionic potential by adding and subtracting a gaussian charge density @xmath87 .",
    "the potential generated by this density is @xmath88 .",
    "the ionic potential is then written as @xmath89 where @xmath90 is chosen so that @xmath91 is localised within a sphere of radius @xmath92 , smaller than the cell size .",
    "the expression of the ionic potential in reciprocal space is @xmath93\\ ] ] which , for @xmath22 gives a finite contribution from the first term , and a divergent contribution from the second term @xmath94 the first is the contribution of the localised charge , and is easily computed , since the integrand is zero for @xmath95 .",
    "the second term is cancelled by the corresponding @xmath22 term in the electronic hartree potential , due to the charge neutrality of the system .",
    "this trivially solves the problem of the divergences in 3d - periodic systems .",
    "now let us consider a 1d - periodic system .",
    "the hartree term alone in real space is given by @xmath96 invoking the charge neutrality along the chain axis , we have that the difference between electron and ionic densities satisfies @xmath97    \\mathrm{d}y\\mathrm{d}z = 0.\\ ] ] unfortunately , the cutoff function in eq .",
    "( [ 1dcutoff ] ) is divergent for @xmath57 .",
    "so the effective potential results in an undetermined @xmath98 form .",
    "however , we can work out an analytical expression for it by defining first a finite cylindrical cutoff , but then bringing the size of the cylinder to infinity . this way , as a first step",
    ", we get a new cutoff interaction in a _",
    "finite _ cylinder of radius @xmath33 , and length @xmath99 , assuming that @xmath99 is much larger than the cell size in the periodic direction . in this case",
    "the modified finite cutoff potential includes a term @xmath100 which , in turn gives , for the particular plane @xmath57 , @xmath101 the effective potential is now split into two terms , but only the second one depends on @xmath99 .",
    "the second step is achieved by going to the limit @xmath102 , to obtain the exact infinite cutoff . by calculating this limit , we notice that only the second term in the right hand side of eq .",
    "( [ cyl - finite ] ) diverges .",
    "this term is the one that can be dropped due to charge neutrality ( in fact it has the same form for the ionic and electronic charge densities ) .",
    "thus , for the cancellation to be effective in a practical implementation , we have to treat on the same way both the ionic and hartree coulomb contributions .",
    "of course the first term in the right hand side eq .",
    "( [ cyl - finite ] ) has always to be taken into account , affecting both the long and the short range part of the cutoff potentials .    following this procedure , we are able to get a considerable computational advantage , compared , e.g. , to the method originally proposed by spataru _ et al._,@xcite since our cutoff is just an analytical function of the reciprocal space coordinates , and the evaluation of an integral for every value of @xmath103 is not needed . the cutoff proposed in ref .",
    "is actually a particular case of our cutoff , obtained by using the finite cylinder for all the components of the @xmath104 vectors : in this case the quadrature in eq .",
    "( [ cyl - finite ] ) has to be evaluated for each @xmath105 , @xmath106 , and @xmath107 , and a convergence study in @xmath99 is mandatory ( see discussion in sec .",
    "[ static - pol - section ] , and fig .",
    "[ fig - pol ] ) .    in the 1d - periodic case ,",
    "the @xmath22 value is now well defined , and it turns out to be @xmath108 @xmath109    the analogous result for the 2d - periodic cutoff is obtained by imposing finite cutoff sizes @xmath110 ( much larger than the cell size ) , in the periodic directions @xmath39 and @xmath40 , and dropping the @xmath99-dependent part before passing to the limit @xmath111 .",
    "the constant @xmath112 is the ratio @xmath113 between the in - plane lattice vectors .",
    "@xmath114\\label{pla - finite } \\\\    + 8h\\log\\left(\\frac{(\\alpha+\\sqrt{1+\\alpha^2})(1+\\sqrt{1+\\alpha^2})}{\\alpha}\\right)\\frac{\\sin(g_z r)}{g_z}.\\end{gathered}\\ ] ] the @xmath22 value is @xmath115    to summarise , the divergences can be cancelled also in 1d - periodic and 2d - periodic systems provided that 1 ) we apply the cutoff function to both the ionic and the electronic potentials , 2 ) we separate out the infinite contribution as shown above , and 3 ) we properly account for the short range contributions as stated in table [ tabcutoff ] .",
    "the analytical results of the present work are condensed in tab .",
    "[ tabcutoff ] : all the possible values for the cutoff functions are listed there as a quick reference for the reader .",
    "@xmath116 + @xmath117 & & @xmath118 $ ] + @xmath31 & & @xmath119 + @xmath105 & @xmath120 & 1d - periodic @xmath121 + @xmath117 & any &    .reference table summarising the results of the cutoff work for charge - neutral systems : finite systems ( 0d ) , one - dimensional systems ( 1d ) and two - dimensional systems ( 2d ) .",
    "the complete reciprocal space expression of the hartree potential is provided . for the 1d case , @xmath33 stands for the radius of the cylindrical cutoff whereas in the 0d case",
    "is the radius of the spherical cutoff . in 2d",
    "stands for half the thickness of the slab cutoff ( see text for details ) .",
    "[ tabcutoff ] [ cols= \" > \" , ]      + @xmath31 & @xmath117 & @xmath122 + @xmath31 & @xmath31 & @xmath123 + @xmath124 & @xmath107 & 2d - periodic @xmath125 + @xmath117 & any & @xmath126 $ ] + @xmath31 & @xmath117 & @xmath127}$ ] + @xmath31 & @xmath31 & @xmath128 +",
    "the scheme illustrated above has been implemented both in the real space time - dependent dft code octopus@xcite , and in the plane wave many - body - perturbation - theory ( mbpt ) code self@xcite .",
    "the tests have been performed on the prototypical cases of infinite chains of atoms along the @xmath39 axis .",
    "the comparisons are performed between the 3d - periodic calculation ( physically corresponding to a crystal of chains ) , and the 1d - periodic case ( corresponding to the isolated chain ) both in the usual supercell approach , and within our exact screening method .",
    "the discussion for the 2d cases follows the same path as for the 1d case , while results for the finite systems have already been reported in the literature.@xcite we addressed different properties to see the impact of the cutoff at each level of calculation , from the ground state to excited state and quasiparticle dynamics .",
    "all the calculations have been done with the real - space implementation of dft in the octopus@xcite code .",
    "we have used non - local norm - conserving pseudopotentials@xcite to describe the electron - ion interaction and the local - density approximation ( lda)@xcite to describe exchange - correlation effects .",
    "the particular choice of exchange - correlation or ionic - pseudopotential does not matter here as we want to assert the impact of the coulomb cutoff and this is independent of those quantities .",
    "moreover , we have used a grid of 0.38 a.u . for si and na .    in this case",
    "the footprint of the interaction of neighbouring chains in the @xmath40 and @xmath41 direction is the dispersion of the bands in the corresponding direction of the brillouin zone .",
    "however it is known that , if the supercell is large enough , the bands along the @xmath129 direction are unchanged .",
    "this is in apparent contradiction with the fact that the radial ionic potential for a wire ( that asymptotically goes like @xmath130 as a function of the distance @xmath131 from the axis of the wire ) is completely different from the crystal potential .",
    "the answer to this contradiction is clear if we perform a cutoff calculation .",
    "in fact the overall effect on the occupied states turns out to be cancelled by the hartree potential , i.e. by the electron screening of the ionic potential , but two different scenarios are visible as soon as the proper cutoff is used .",
    "c +   +   +    .[fig - sipot ]    in fig .",
    "[ fig - sipot ] ( top ) it is shown the ionic potential , the hartree potential , and their sum for a si atom in a parallelepiped supercell with side lengths of 2.5 , 11 , and 11 a.u . respectively in the @xmath39 , @xmath40 and @xmath41 directions .",
    "no cutoff is used here .",
    "the ionic potential is roughly behaving like @xmath132 in the area not too close to the nucleus ( where the pseudopotential takes over ) .",
    "the total potential , on the other hand , falls off rapidly to an almost constant value at around 4 a.u . from the nuclear position , by effect of the electron screening .",
    "[ fig - sipot ] ( bottom ) shows the results when the cutoff is applied ( the radius of the cylinder is @xmath133  a.u .",
    "such that there is zero interaction between cells ) .",
    "the ionic potential now behaves like it is expected for a potential of a chain , i.e. diverges logarithmically , and is clearly different from the latter case .",
    "nevertheless the sum of the ionic and hartree potential is basically the same as for the 3d - periodic system .    in the static case",
    "the two band structure are then expected , and are found to be the same , confirming that , as far as static calculations are performed , the supercell approximation is good , provided that the supercell is large enough ( see fig .  [ fig - sibands ] ) . in static calculations , then , the use of our cutoff only has the effect of allowing us to eventually use a smaller supercell , what provides clear computational savings . in the case of the si - chain",
    "a full 3d calculation would need of a cell size of 38 a.u . whereas the cutoff calculation would give the same result with a cell size of 19  a.u .",
    "of course , when more delocalized states are considered , like higher energy unoccupied states , larger differences are observed with respect to the supercell calculation .    in fig .",
    "[ fig - nabands ] a na chain with lattice constant 7.5 a.u .",
    "is considered in a cell of 7.5x19x19 a.u . , and",
    "the effect of the cutoff on the occupied and unoccupied stated is shown .",
    "as expected , the occupied states are not affected by the use of the cutoff , since the density of the system within the cutoff radius is unchanged , and the corresponding band is the same as it is found for an ordinary 3d supercell calculation with the same cell size .",
    "however there is a clear effect on the bands corresponding to unoccupied states , and the effect is larger the higher is the energy of the states .",
    "in fact the high energy states , and the states in the continuum are more delocalized , and therefore the effect of the boundary conditions is more sensible .",
    "after the successful analysis of the ground state properties with the cutoff scheme , we have applied the modified coulomb potential to calculate the static polarisability of an infinite chain in the random phase approximation ( rpa ) . as a test case we have considered a chain made of hydrogen atoms , two atoms per cell at a distance of 2 a.u .",
    "the lattice parameter was 4.5 a.u .",
    "for this system we have also calculated excited state properties in many - body perturbation theory , in particular the quasiparticle gap in hedin s gw approximation @xcite and the optical absorption spectra in the bethe - salpeter framework@xcite ( see subsections below ) .",
    "all these calculations have been performed in the code self.@xcite the polarisability for the monomer , _",
    "i.e. a finite system _ , in the rpa approximation including local field effects is defined as @xmath134 where @xmath135 is the interacting polarisation function that is solution of the dyson like equation @xmath136 and @xmath137 is the non interacting polarisation function obtained by the adler - wiser expression.@xcite v(*q*+*g * ) are the fourier components of the coulomb interaction . note that the expression of @xmath112 in eq .",
    "[ alpha ] is also valid for calculations in finite systems , in the supercell approximation , and the dependence from the wave - vector @xmath138 is due to the representation in reciprocal space .    in the top panel of fig .",
    "[ fig - pol ] we compare the values of the calculated polarisability @xmath112 for different supercell sizes .",
    "@xmath112 is calculated both using the bare coulomb @xmath139 and the modified cutoff potential of eq.([1dcutoff ] ) ( the radius of the cutoff is always set to half the inter - chain distance ) .",
    "the lattice constant along the chain axis is kept fixed . using the cutoff",
    "the static polarisability already converges to the asymptotic value with an inter - chain distance of 25 a.u . , while without the cutoff the convergence is much slower , and the exact value is approximated to the same accuracy for much larger cell sizes ( beyond the calculations shown in the top of fig .",
    "[ fig - pol ] ) .",
    "we must stress that the treatment of the divergences in this case is different with respect to the case of the hartree and ionic potential cancellation for ground - state calculations ( i.e. charge neutrality ) .",
    "in fact , while in the calculation for the hartree and ionic potential the diverging terms are simply dropped by virtue of the neutralising positive background , here the @xmath99-dependence in eq .",
    "( [ cyl - finite ] ) can be removed only for the head component by virtue of the vanishing limit @xmath140 , while for the other @xmath57 components we have to resort to the expression of the finite cylindrical cutoff as in eq.([cyl - finite ] ) .",
    "a finite version of the 1d cutoff has been recently applied to nanotube calculations.@xcite this cutoff was obtained by numerically truncating the coulomb interaction along the axis of the nanotube , in addition to the radial truncation .",
    "therefore the effective interaction is limited to a finite cylinder , whose size can be up to a hundred times the unit cell size , depending on the density of the k - point sampling along the axis.@xcite the cutoff axial length has to be larger than the expected bound exciton length .",
    "c +   +   +    in the bottom part of fig.[fig - pol ] we compare the results obtained with our analytical cutoff ( eq .  ( [ 1dcutoff ] ) ) with its finite special case as proposed in ref .  .",
    "we observe that the value of the static polarisability calculated with the finite cutoff oscillates around an asymptotic value , for increasing axial cutoff lengths .",
    "the asymptotic value exactly coincides with the value that is obtained with our cutoff .",
    "we stress that we also resort to the finite form of the cutoff only for the diverging of components of the potential , thus we note that there is a clear numerical advantage in using our expression , since the cutoff is analytical for all values except at @xmath57 , and the corresponding quadrature has to be numerically evaluated for these points only . in the inset of the bottom part of fig .",
    "[ fig - pol ] it is also shown the convergences of the polarisability obtained with our cutoff with respect to the k - points sampling . the sampling is unidimensional along the axial direction . observe that the calculation using our cutoff is already converged for a sampling of 20 k - points .",
    "in the upper axis it is also indicated the corresponding maximum allowed value of the finite cutoff length in the axial direction that has been used to calculate the @xmath57 components .",
    "finite size effects turn out to be relevant also for many - body perturbation theory calculations . for the same test system ( linear h@xmath141-chain ) , in the next two subsections ,",
    "we consider the performance of our cutoff potential for the calculation of the quasiparticle energies in gw@xcite approximation and in the absorption spectra in the bethe - salpeter framework.@xcite      in the gw approximation , the non - local energy - dependent electronic self - energy @xmath142 plays a role similar to that of the exchange - correlation potential of dft .",
    "@xmath142 is approximated by the convolution of the one electron green s function and the dynamically screened coulomb interaction @xmath143 .",
    "we first calculate the ground state electronic properties using the dft code abinit.@xcite these calculation are performed in lda@xcite , and pseudopotentials@xcite approximation .",
    "an energy cutoff of 30 hartree has been used to get converged results .",
    "the lda eigenvalues and eigenfunctions are then used to construct the rpa screened coulomb interaction @xmath143 , and the gw self - energy .",
    "the inverse dielectric matrix @xmath144 has been calculated using the plasmon - pole approximation @xcite and the quasiparticle energies have been calculated at the first order of perturbation theory in @xmath145.@xcite dividing the self - energy in an exchange @xmath146 and a correlation @xmath147 parts ( @xmath148 ) , we get the following representation for the self - energy in a plane - waves basis set : @xmath149 and @xmath150 } { \\bigg\\}}\\end{gathered}\\ ] ] where @xmath151 and the integral in the frequency domain in eq.([selfenergy ] ) has been analytically solved considering the dielectric matrix in the plasmon pole mode : ( @xmath152 ) .    in order to eliminate the spurious interaction between different supercells , leaving the bare coulomb interaction unchanged along the chain direction ,",
    "we just introduce the expression of eq.([1dcutoff ] ) in the construction of @xmath146 and @xmath147 , and also in the calculation of @xmath153 .",
    "as we did for the calculation of the static polarisability , the divergences appearing in the components @xmath154 can not be fully removed and for such components we resort to the finite version of the cutoff potential eq.([cyl - finite ] ) .    in fig .",
    "[ fig - gwgap ] the convergence of the quasiparticle gap at the @xmath155 point is calculated for different supercell sizes in the gw approximation . a cutoff radius of 8.0 a.u .",
    "has been used .",
    "when the cutoff potential is used , 60 k points in the axis direction has been necessary to get converged results . in the inset of fig .",
    "[ fig - gwgap ] we show the behaviour of the quasiparticle gap in function of the cutoff radius .",
    "we observe that for @xmath156  a.u .",
    "a plateau is reached , and , for @xmath157  a.u .",
    ", a small oscillation appears due to interaction between the tails of the charge density of the system with its image in the neighbour cell . differently from the dft - lda , calculation for neutral systems , where the supercell approximation turns out to be good , as we have discussed above",
    ", we can see that the convergence of the gw quasiparticle correction turns out to be extremely slow with respect to the size of the supercell and huge supercells are needed in order to get converged results .",
    "this is due to the fact that in the gw calculation the addition of an electron ( or a hole ) to the system induces charge oscillation in the periodic images too .",
    "it is important to note that the slow convergence is caused by the correlation part of the self - energy ( eq.([selfenergy ] ) ) , while the exchange part is rapidly convergent with respect to the cell size .",
    "the use of the cutoff coulomb potential really improves drastically the convergence as it is evident from fig.[fig - gwgap ] .",
    "notice that still at 38  a.u .",
    "inter - chain distance the gw gap is underestimated by about 0.5  ev . a similar trend",
    "( but with smaller variations ) has been found by onida _",
    "@xcite , for a finite system ( sodium tetramer ) using the cutoff potential of eq.([0dcutoff ] ) .",
    "clearly there is a strong dimensionality dependence of the self - energy correction .",
    "the non - monotonic behaviour versus dimensionality of the self - energy correction has also been pointed out in ref .   where the gap - correction was shown to have a strong component of the surface polarisation .",
    "starting from the quasiparticle energies we have calculated the optical absorption spectra including electron - hole interactions solving the bethe - salpeter equation @xcite .",
    "the basis set to describe the exciton state is composed by product states of the occupied and unoccupied lda single particle states and the coupled electron - hole excited states @xmath158 , where @xmath159 is the ground state of the system .",
    "@xmath160 is the probability amplitude of finding an excited electron in the state @xmath161 and a hole in @xmath162 , and it satisfies the equation @xmath163 @xmath164 is the excitation energy of the state @xmath165 and @xmath44 the interaction kernel that includes an unscreened exchange repulsive term @xmath166 and a screened electron - hole interaction @xmath167 ( direct term ) . in plane wave basis such terms read @xmath168 @xmath169 the screened potential has been treated in static rpa approximation ( dynamical effects in the screening have been neglected as it is usually done in present bethe - salpeter calculations@xcite ) .",
    "the quasiparticle energies entering in the diagonal part of the hamiltonian in eq .",
    "( [ eq - bse ] ) are obtained applying a scissor operator to the lda energies , because in the studied test case the main difference between the quasiparticle and lda band structure consists of a rigid energy shift of energy bands . from the solution of the bethe - salpeter equation ( eq.[eq - bse ] ) it is possible to calculate the macroscopic dielectric function ,",
    "in particular the imaginary part reads @xmath170 where the summation runs over all the vertical excitations from the ground state @xmath159 to the excited state @xmath165 , @xmath164 is the corresponding excitation energy , @xmath171 is the velocity operator and @xmath172 is the polarisation vector . as in the case of gw calculation , in order to isolate the chain , we substitute the cutoff potential of eq.([1dcutoff ] ) both in the exchange term eq.([exchange ] ) and in the direct term of the bethe - salpeter equation eq.([direct ] ) , as well as for the rpa dielectric matrix present in eq.([direct ] ) .    in the top part of fig .",
    "[ fig - bse ] we show the calculated spectra for different cell sizes together with the non - interacting spectrum , and the spectrum obtained using the cutoff coulomb potential for an inter - chain distance larger than 20 a.u . and cylindrical cutoff radius of 8 a.u .",
    "the scissor operator applied in this calculation is the same for all the volumes and correspond to the converged gw gap .",
    "c +   +    as it is known , the electron - hole interaction modifies both the shape and the energy of the main absorption peak .",
    "this effect is related to the the slow evolution of the polarisability per @xmath173 unit@xcite .",
    "furthermore , the present results clearly illustrate that the spectrum calculated without the cutoff slowly converges towards the exact result .",
    "this is highlighted in the bottom panel of fig .",
    "[ fig - bse ] where we show the dependency of the exciton binding energy on the supercell volume , the binding energy being defined as the energy difference between the excitonic peak and the optical gap .",
    "we observe that the effect of the inter - chain interaction consists in reducing the binding energy with respect to its value in the isolated system .",
    "this value is slowly approached as the inter - chain distance increases , while , once the cutoff is applied to the coulomb potential , the limit is reached as soon as the densities of the system and its periodical images do not interact .",
    "if we consider the convergence of the quasiparticle gap and of the binding energy with respect to the cell volume we notice that , if a cutoff is not used , the position of the absorption peak is controlled by the convergence of the bethe - salpeter equation solution , which , in turn , depends on the ( slower ) convergence of the gw energies .",
    "it is clear from fig .",
    "[ fig - gwgap ] that the use of the cutoff allows us to considerably speed up this bottleneck .",
    "c +    the use of our cutoff also has an important effect on the brillouin zone sampling . in fig .",
    "[ fig - epsilon ] we show the value of @xmath174 in the @xmath175 plane for a supercell corresponding to an inter - chain distance of 25 a.u . when the cutoff potential is used ( bottom panel )",
    "the screening is smaller , compared to the case of the bare potential ( top panel ) .",
    "looking at the direction perpendicular to the chain ( the chain axis is along the @xmath39 direction ) we see that the dielectric matrix is approximately constant , and this fact allows us to sample the brillouin zone only in the direction of the chain axis . for both the gw and bethe - salpeter calculations a three dimensional sampling of the brillouin zone",
    "is needed to get converged results when no cutoff is used , while a simple one - dimensional sampling can be adopted when the interaction is cutoff .",
    "an infinite system is an artifact that allows us to exploit the powerful symmetry properties of an ideal system to approximate the properties of a finite one that is too large to be simulated at once . in order to use the valuable supercell approximation for systems that are periodic in less than three dimensions some cutoff technique",
    "is required .",
    "the technique presented here provides a recipe to build the supercell , and a truncated coulomb potential in fourier space in such a way that the interactions to all the undesired images of the system are cancelled .",
    "this technique is exact for the given supercell sizes , and can be in most cases well approximated using supercells whose length is the double of the system size in the non - periodic dimensions .",
    "the method is very easily implemented in all available codes that use the supercell scheme , and is independent on the adopted basis set .",
    "we have tested it both in a real space code for lda band - structure calculation of an atomic chain , and a plane wave code , for the static polarisability in rpa approximation , gw quasiparticle correction , and photo - absorption spectra in the bethe - salpeter scheme , showing that the convergence with respect the vacuum needed to isolate the system from its images is greatly enhanced , and the sampling of the brillouin zone is heavily reduced , being only necessary along the periodic directions of the system .",
    "this research was supported by eu research and training network",
    " exciting \" ( contract hprn - ct-2002 - 00317 ) , ec 6th framework network of excellence nanoquanta ( nmp4-ct-2004 - 500198 ) and spanish mec .",
    "ar acknowledges the foundation under the bessel research award ( 2005 ) .",
    "we thank dr .",
    "alberto castro , dr . miguel a.l marques , and heiko appel for helpful discussions and friendly collaboration .",
    "m.  l. cohen , solid stat .",
    "commun . * 92 * , 45 ( 1994 ) ; phys . scri . * 1 * , 5 ( 1982 ) .",
    "j. ihm , a. zunger and m.  l. cohen , j. phys .",
    "* c 12 * , 4409 ( 1979 ) . w.  e. pickett , comput .",
    "phys . rep .",
    "* 9 * , 115 ( 1989 ) ; m.  c. payne , m.  p. teter , d.  c. allan , t.  a. arias and .",
    "d. joannopoulos , rev .",
    "* 64 * , 1045 ( 1992 ) .",
    "see for example : a.p .",
    "alivisatos , science * 271 * , 933 ( 1996 ) ; _ carbon nanotubes : synthesis , structure , properties , and applications _ , m.s .",
    "dresselhaus , g. dresselhaus , and ph .",
    "avouris ( editors ) , springer verlag ( 2001 ) ; _ encyclopedia of nanoscience and nanotechnology _ and handbook of nanostructured biomaterials and their applications in nanobiotechnology , h.  s. nalwa ( editor ) , american scientific publishers ( 2005 ) ; _ quantum computing and quantum communication _ , g. burkard ,",
    "h - a . engel , and d. loss , http://theorie5.physik.unibas.ch/qcomp/qcomp.html    the maximum value of the size of the cutoff axial length @xmath99 both in ref .   and in eq .",
    "( [ cyl - finite ] ) is @xmath176 , where @xmath177 is the spacing of the k - point grid in the direction of the cylinder axis .",
    "l. hedin , phys . rev . * 139 * , 796 ( 1965 ) ; l. hedin and s. lundqvist , solid state phys * 23 * , 1 ( 1969 ) ; f. aryasetiawan and o. gunnarson , rep",
    ". prog . phys .",
    "* 61 * , 237 ( 1998 ) ; w.  g. aulbur , l. jnsson and j.w .",
    "wilkins , solid state physics * 54 * , 1 ( 1999 ) .",
    "s.albrecht , l. reining , r. del  sole and g. onida , phys .",
    "lett . * 80 * , 4510 ( 1998 ) ; l.  x.  benedict , e.l .",
    "shirley , r.  b. bohn , _ ibid . _ * 80 * , 4514 ( 1998 ) ; m. rohlfing and s.g .",
    "louie , _ ibid . _ * 81 * , 2312 ( 1998 ) ; pys . rev . *",
    "b 62 * , 4927 ( 2000 )        r.  w. godby , r.  j. needs , phys .",
    "lett . * 62 * , 1169 ( 1989 ) . to get converged inverse dielectric matrix",
    "we have used unoccupied bands up to 28 ev in the electron - hole energies , and a number of @xmath46 vectors until @xmath179 in the inversion of the matrix ."
  ],
  "abstract_text": [
    "<S> we present a new reciprocal space analytical method to cutoff the long range interactions in supercell calculations for systems that are infinite and periodic in 1 or 2 dimensions , extending previous works for finite systems . </S>",
    "<S> the proposed cutoffs are functions in fourier space , that are used as a multiplicative factor to screen the bare coulomb interaction . </S>",
    "<S> the functions are analytic everywhere but in a sub - domain of the fourier space that depends on the periodic dimensionality . we show that the divergences that lead to the non - analytical behaviour can be exactly cancelled when both the ionic and the hartree potential are properly screened . </S>",
    "<S> this technique is exact , fast , and very easy to implement in already existing supercell codes . to illustrate the performance of the new scheme , we apply it to the case of the coulomb interaction in systems with reduced periodicity ( as one - dimensional chains and layers ) . for those test cases </S>",
    "<S> we address the impact of the cutoff in different relevant quantities for ground and excited state properties , namely : the convergence of the ground state properties , the static polarisability of the system , the quasiparticle corrections in the gw scheme and in the binding energy of the excitonic states in the bethe - salpeter equation . </S>",
    "<S> the results are very promising . </S>"
  ]
}