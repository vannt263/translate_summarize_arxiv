{
  "article_text": [
    "we consider multiple hypothesis testing where the underlying tests are dependent .",
    "such testing problems arise in many applications , in particular , in the fields of genomics and genome - wide association studies @xcite , but also in astronomy and other fields @xcite .",
    "popular multiple - testing procedures include the bonferroni  holm method @xcite which strongly controls the family - wise error rate ( fwer ) , and the benjamini  yekutieli procedure @xcite which controls the false discovery rate ( fdr ) , both under arbitrary dependence structures between test statistics .",
    "if test statistics are strongly dependent , these procedures have low power to detect true positives .",
    "the reasons for this loss of power are well known : loosely speaking , many strongly dependent test - statistics carry only the information equivalent to fewer `` effective '' tests . hence , instead of correcting among many multiple tests , one would in principle only need to correct for the smaller number of `` effective '' tests .",
    "moreover , when controlling some error measure of false positives , an oracle would only need to adjust among the tests corresponding to true negatives .",
    "in large - scale sparse multiple testing situations , this latter issue is usually less important since the number of true positives is typically small , and the number of true negatives is close to the overall number of tests .",
    "the dependence among tests can be taken into account by using the permutation - based westfall  young method @xcite , already used widely in practice ( e.g. , ) . under the assumption of subset - pivotality",
    "( see section [ secsinglestepwy ] for a definition ) , this method strongly controls the fwer under any kind of dependence structure @xcite .    in this paper",
    "we show that the westfall  young permutation method is an optimal procedure in the following sense .",
    "we introduce a single - step oracle multiple testing procedure , by defining a single threshold such that all hypotheses with @xmath0-values below this threshold are rejected ( see section [ secsinglestep ] ) .",
    "the oracle threshold is the largest threshold that still guarantees the desired level of the testing procedure .",
    "the oracle threshold is unknown in practice if the dependence among test statistics and the set of true null hypotheses are unknown .",
    "we show that the single - step westfall ",
    "young threshold approximates the oracle threshold for a broad class of testing problems with a  block - dependence and sparsity structure among the tests , when the number of tests tends to infinity .",
    "our notion of asymptotic optimality relative to an oracle threshold is on a general level and for any specified test statistic .",
    "the power of a multiple testing procedure depends also on the data generating distribution and the chosen individual test(s ) : we do not discuss this aspect here . instead , our goal is to analyze optimality once the individual tests have been specified .",
    "our optimality result has an immediate consequence for large - scale multiple testing : it is not possible to improve on the power of the westfall  young permutation method while still controlling the fwer when considering single - step multiple testing procedures for a large number of tests and assuming only a block - dependence and sparsity structure among the tests ( and no additional modeling assumptions about the dependence or clustering / grouping ) .",
    "hence , in such situations , there is no need to consider ad - hoc proposals that are sometimes used in practice , at least when taking the viewpoint that multiple testing adjusted @xmath0-values should be as model free as possible .",
    "there is a small but growing literature on optimality in multiple testing under dependence .",
    "sun and cai @xcite studied and proposed optimal decision procedures in a two - state hidden markov model , while genovese et al .",
    "@xcite and roeder and wasserman @xcite looked at the intriguing possibility of incorporating prior information by @xmath0-value weighting .",
    "the effect of correlation between test statistics on the level of fdr control was studied in benjamini and yekutieli @xcite and benjamini et al . @xcite",
    "; see also blanchard and roquain @xcite for fdr control under dependence .",
    "furthermore , clarke and hall @xcite discuss the effect of dependence and clustering when using `` wrong '' methods based on independence assumptions for controlling the ( generalized ) fwer and fdr .",
    "the effect of dependence on the power of higher criticism was examined in hall and jin @xcite .",
    "another viewpoint is given by efron @xcite , who proposed a novel empirical choice of an appropriate null distribution for large - scale significance testing .",
    "we do not propose new methodology in this manuscript but study instead the asymptotic optimality of the widely used westfall  young permutation method @xcite for dependent test statistics .",
    "after introducing some notation , we define our notion of a single - step oracle threshold and describe the westfall  young permutation method .",
    "let @xmath1 be a data matrix containing @xmath2 independent realizations of an @xmath3-dimensional random variable @xmath4 with distribution @xmath5 and possibly some additional deterministic response variables @xmath6 .",
    "_ prototype of data matrix @xmath1 .",
    "_ to make this more concrete , consider the following setting that fits the examples described in section [ secexamples ] .",
    "let @xmath6 be a deterministic variable , and allow the distribution of @xmath7 to depend on @xmath6 . for each value @xmath8 , @xmath9 , we observe an independent sample @xmath10 of @xmath11 .",
    "we then define @xmath1 to be an @xmath12-dimensional matrix by setting @xmath13 for @xmath9 and @xmath14 for @xmath15 and @xmath9 .",
    "thus , the first row of @xmath1 contains the @xmath6-variables , and the @xmath16th column of @xmath1 corresponds to the @xmath16th data sample  @xmath17 .    based on @xmath1 , we want to test @xmath3 null hypotheses @xmath18 , @xmath15 , concerning the @xmath3 components @xmath19 of @xmath20 . for concrete examples ,",
    "see section [ secexamples ] .",
    "let @xmath21 be the indices of the true null hypotheses , and let @xmath22 be the indices of the true alternative hypotheses , that is , @xmath23 .",
    "let @xmath24 be a distribution under the complete null hypothesis , that is , @xmath25 .",
    "we denote the class of all distributions under the complete null hypothesis by @xmath26 .",
    "suppose that the same test is applied for all hypotheses , and let @xmath27 $ ] be the set of possible @xmath0-values this test can take .",
    "thus , @xmath28 $ ] for @xmath29-tests and related approaches , while @xmath30 is discrete for permutation tests and rank - based tests .",
    "let @xmath31 , @xmath15 , be the @xmath0-values for the @xmath3 hypotheses , based on the chosen test and the data @xmath1 .",
    "suppose that we knew the true set of null hypotheses @xmath32 and the distribution of @xmath33 under @xmath5 ( which is of course not true in practice ) .",
    "then we could define the following single - step oracle multiple testing procedure : reject @xmath18 if @xmath34 , where @xmath35 is the @xmath36-quantile of @xmath37 under @xmath5 .",
    "@xmath38 throughout , we define the maximum of the empty set to be zero , corresponding to a threshold @xmath35 that leads to zero rejections .",
    "this oracle procedure controls the fwer at level @xmath36 , since , by definition , @xmath39 and it is optimal in the sense that values @xmath40 with @xmath41 no longer control the fwer at level @xmath36 .      the westfall  young permutation method is based on the idea that under the complete null hypothesis , the distribution of @xmath1 is invariant under a certain group of transformations  @xmath42 , that is , for every @xmath43 , @xmath44 and @xmath1 have the same distribution under @xmath45 .",
    "romano and wolf @xcite refer to this as the `` randomization hypothesis . '' in the sequel , @xmath42 is the collection of all permutations  @xmath46 of @xmath47 , so that the number of elements @xmath48 equals @xmath49 .    _ prototype permutation group @xmath42 acting on the prototype data matrix @xmath1 . _ in the examples in section [ secexamples ]",
    ", @xmath1 is a prototype data matrix as described in section [ secnotation ] .",
    "the prototype permutation @xmath50 leads to a matrix @xmath44 obtained by permuting the _ first _ row of @xmath1 ( i.e. , permuting the @xmath6-variables ) .",
    "for all examples in section  [ secexamples ] , under the complete null hypothesis @xmath51 , the distribution of @xmath44 is then identical to the distribution of @xmath1 for all @xmath43 , so that the randomization hypothesis is satisfied .",
    "we suppress the dependence of @xmath52 on the sample size @xmath2 for notational simplicity .",
    "the single - step westfall  young critical value is a random variable , defined as follows : @xmath53 where @xmath54 denotes the indicator function , and @xmath55 represents the permutation distribution @xmath56 for any function @xmath57 mapping @xmath1 into @xmath58 .",
    "in other words , @xmath59 is the @xmath36-quantile of the permutation distribution of @xmath60 .",
    "our main result ( theorem  [ thoptimal ] ) shows that under some conditions , the westfall  young threshold @xmath61 approaches the oracle threshold @xmath35 .",
    "it is easy to see that the westfall  young permutation method provides weak control of the fwer , that is , control of the fwer under the complete null hypothesis . under the assumption of subset - pivotality",
    ", it also provides strong control of the fwer @xcite , that is , control of the fwer under any set @xmath32 of true null hypotheses .",
    "subset - pivotality means that the distribution of @xmath62 is identical under the restrictions @xmath63 and @xmath64 for all possible subsets @xmath65 of true null hypotheses .",
    "subset - pivotality is not a necessary condition for strong control ; see , for example , romano and wolf @xcite , westfall and troendle @xcite and goeman and solari @xcite .",
    "we consider the framework where the number of hypotheses @xmath3 tends to infinity .",
    "this framework is suitable for high - dimensional settings arising , for example , in microarray experiments or genome - wide association studies .",
    "( a1 ) block - independence : the @xmath0-values of all true null hypotheses adhere to a block - independence structure that is preserved under permutations in @xmath42 .",
    "specifically , there exists a partition @xmath66 of @xmath67 such that for any pair of permutations @xmath68 , @xmath69 , b=1, ",
    ",b_m , are mutually independent under @xmath5 . here , the number of blocks is denoted by @xmath70 .",
    "[ we assume without loss of generality that @xmath71 for all @xmath72 , meaning that there is at least one true null hypothesis in each block ; otherwise , the condition would be required only for blocks with @xmath73 . ]",
    "sparsity : the number of alternative hypotheses that are true under  @xmath5 is small compared to the number of blocks , that is , @xmath74 as @xmath75 .",
    "block - size : the maximum size of a block , @xmath76 , is of smaller order than the square root of the number of blocks , that is , @xmath77 as @xmath75 .",
    "let @xmath78 be a random permutation taken uniformly from @xmath79",
    ". under  @xmath5 , the joint distribution of @xmath80 is identical to the joint distribution of @xmath81 .",
    "let @xmath55 be the permutation distribution in ( [ eqpstar ] ) .",
    "there exists a constant @xmath82 such that for @xmath83 and all @xmath1 , @xmath84    the @xmath0-values corresponding to true null hypotheses are uniformly distributed ; that is , for all @xmath85 and @xmath86 , we have @xmath87 .",
    "a sufficient condition for the block - independence assumption ( a1 ) is that for every fixed pair of permutations @xmath88 the blocks of random variables @xmath89 are mutually independent for @xmath90 .",
    "this condition is implied by block - independence of the @xmath3 last rows of the prototype @xmath1 for the examples discussed in section [ secexamples ] and for the prototype @xmath42 as in section [ secsinglestepwy ] .",
    "the block - independence assumption captures an essential characteristic of large - scale testing problems : a test statistic is often strongly correlated with a number of other test statistics but not at all with the remaining tests .",
    "the sparsity assumption ( a2 ) is appropriate in many contexts .",
    "most genome - wide association studies , for example , aim to discover just a few locations on the genome that are associated with prevalence of a certain disease @xcite .",
    "furthermore , assumption ( a3 ) requiring that the range of ( block- ) dependence is not too large , which seems reasonable in genomic applications : for example , when having many different groups of genes ( e.g. , pathways ) , each of them not too large in cardinality , a block - dependence structure seems appropriate .",
    "we now consider assumptions ( b1)(b3 ) , supposing that we work with a  prototype data matrix @xmath1 and a prototype permutation group @xmath91 as described in sections [ secnotation ] and [ secsinglestepwy ] .",
    "assumption ( b1 ) is satisfied if each @xmath0-value  @xmath31 only depends on the @xmath92st and @xmath93th rows of @xmath1 .",
    "moreover , subset - pivotality is satisfied in this setting .",
    "assumption ( b3 ) is satisfied for any test with valid type",
    "i error control .",
    "assumption ( b2 ) is fulfilled with @xmath94 if for all @xmath1 @xmath95 where @xmath96 is the probability with respect to a random permutation @xmath78 taken uniformly from @xmath79 , so that the left - hand side of ( [ eqcondprob ] ) equals @xmath97 in  ( [ eqt1 ] ) .",
    "note that assumptions ( b1 ) and ( b3 ) together imply that @xmath98 where the probability @xmath99 is with respect to a random draw of the data  @xmath1 , and a random permutation @xmath78 taken uniformly from @xmath79 .",
    "thus , assumption  ( b2 ) holds if ( [ eqtest ] ) is true for all @xmath15 when conditioned on the observed data .",
    "section [ secexamples ] discusses three concrete examples that satisfy assumptions   and subset - pivotality .    for our theorems in section [ secmainresult ] , it would be sufficient if ( [ eqt1 ] ) were holding only with probability converging to 1 when sampling a random  @xmath1 , but we leave a deterministic bound since it is easier notationally , the extension is direct and we are mostly interested in rank - based and conditional tests for which the deterministic bound holds .",
    "we now give three examples that satisfy assump - tions  , as well as subset - pivotality . as in section [ secnotation ] , let @xmath6 be a  deterministic scalar class variable and @xmath100 an @xmath3-dimensional vector of random variables , where the distribution of @xmath7 can depend on  @xmath6 . let the prototype data matrix @xmath1 and the prototype group of permutations @xmath42 be defined as in sections [ secnotation ] and [ secsinglestepwy ] , respectively . in all examples ,",
    "we work with tests with valid type i error control , and each @xmath0-value @xmath31 only depends on the @xmath92st and @xmath93th rows of @xmath1 . hence , assumptions  ( b1 ) ,  ( b3 ) and  subset - pivotality are satisfied , and we focus on assumption ( b2 ) in the remainder .    for the examples in sections [ seclocationshift ] and [ secmarginal ] , we assume that there exists a @xmath101 and an @xmath3-dimensional random variable @xmath102 such that @xmath103 we omit the dependence of @xmath7 on @xmath6 in the following for notational simplicity .",
    "we consider two - sample testing problems for location shifts , similar to example 5 of romano and wolf @xcite .",
    "using the notation in ( [ eqxy ] ) , @xmath104 is a binary class variable , and the marginal distributions of @xmath105 are assumed to have a median of zero .",
    "we are interested in testing the null hypotheses @xmath106 versus the corresponding two - sided alternatives , @xmath107 we now discuss location - shift tests that satisfy assumption ( b2 ) .",
    "first , note that all permutation tests satisfy ( b2 ) with @xmath94 , since the @xmath0-values in a permutation test are defined to fulfill @xmath108 for all @xmath86 .",
    "permutation tests are often recommended in biomedical research @xcite and other large scale location - shift testing applications due to their robustness with respect to the underlying distributions .",
    "for example , one can use the wilcoxon test .",
    "another example is a `` permutation @xmath29-test '' : choose the @xmath0-value @xmath31 as the proportion of permutations for which the absolute value of the @xmath29-test statistic is larger than or equal to the observed absolute value of the @xmath29-test statistic for @xmath18 . then condition ( b2 )",
    "is fulfilled with @xmath94 with the added advantage that inference is exact , and the type i error is guaranteed even if the distributional gaussian assumption for the @xmath29-test is not fulfilled @xcite .",
    "computationally , such a `` permutation @xmath29-test '' procedure seems to involve two rounds of permutations : one for the computation of the marginal @xmath0-value and one for the westfall  young method ; see ( [ eqpstar ] ) .",
    "however , the computation of the marginal permutation @xmath0-value can be inferred from the permutations in the westfall  young method , as in meinshausen @xcite , and just a single round of permutations is thus necessary .",
    "suppose that we have a continuous variable  @xmath6 in formula ( [ eqxy ] ) .",
    "based on the observed data , we want to test the null hypotheses of no association between variable @xmath109 and @xmath6 , that is , @xmath110 versus the corresponding two - sided alternatives .",
    "a special case is the test for linear marginal association , where the functions @xmath111 for @xmath15 are assumed to be of the form @xmath112 , and the test of no linear marginal association is based on the null hypotheses @xmath113    rank - based correlation test like spearman s or kendall s correlation coefficient are examples of tests that fulfill assumption ( b2 ) .",
    "alternatively , a  `` permutation correlation - test '' could be used , analogous to the `` permutation @xmath29-test '' described in section [ seclocationshift ] .",
    "contingency tables are our final example .",
    "let @xmath114 be a class variable with @xmath115 distinct values .",
    "likewise , assume that the random variable @xmath20 is discrete and that each component of @xmath20 can take @xmath116 distinct values , @xmath117 .",
    "as an example , in many genome - wide association studies , the variables of interest are single nucleotide polymorphisms ( snps ) .",
    "each snp @xmath118 ( denoted by @xmath109 ) can take three distinct values , in general , and it is of interest to see whether there is a relation between the occurrence rate of these categories and a category of a person s health status @xmath6 @xcite .",
    "based on the observed data , we want to test the null hypothesis for @xmath15 that the distribution of @xmath109 does not depend on @xmath6 , @xmath119 the available data for hypothesis @xmath18 is contained in the @xmath92st and rows of  @xmath1 .",
    "these data can be summarized in a contingency table and fisher s exact test can be used .",
    "since the test is conditional on the marginal distributions , we have that @xmath120 for a random permutation @xmath121 and ( b2 ) is fulfilled with @xmath94 .",
    "we now look at the properties of the westfall  young permutation method and show asymptotic optimality in the sense that , with probability converging to 1 as the number of tests increases , the estimated westfall  young threshold @xmath59 is at least as large as the optimal oracle threshold @xmath122 , where @xmath123 can be arbitrarily small .",
    "this implies that the power of the westfall  young permutation method approaches the power of the oracle test , while providing strong control of the fwer under subset - pivotality @xcite .",
    "all proofs are given in section [ secproofs ] .",
    "[ thoptimal ] assume and .",
    "then for any @xmath124 and any @xmath125 @xmath126    we note that the sample size @xmath2 can be fixed and does not need to tend to infinity .",
    "however , if the range of @xmath0-values @xmath30 is discrete , the sample size must increase with @xmath3 to avoid a trivial result where the oracle threshold vanishes ; see also theorem [ thoptimaldiscrete ] where this is made explicit for the wilcoxon test in the location - shift model of section [ seclocationshift ] .",
    "theorem [ thoptimal ] implies that the actual level of the westfall  young procedure converges to the desired level ( up to possible discretization effects ; see section [ sectiondiscrete ] ) . to appreciate the statement in theorem [ thoptimal ] in terms of power gain ,",
    "consider a simple example .",
    "assume that the @xmath3 hypotheses form @xmath127 blocks .",
    "in the most extreme scenario , test statistics are perfectly dependent within each block . in such a scenario , the oracle threshold ( [ eqoracle ] ) for each individual @xmath0-value is then @xmath128{1-\\alpha } , \\ ] ] which is larger than , but very closely approximated by @xmath129 for large values of  @xmath127 .",
    "thus , when controlling the fwer at level @xmath36 , hypotheses can be rejected when their @xmath0-values are less than @xmath130{1-\\alpha}$ ] and certainly when their @xmath0-values are less than @xmath129 . however , the value of @xmath127 and the block - dependence structure between hypotheses are unknown in practice . with a  bonferroni correction for the fwer at level @xmath36",
    ", hypotheses can be rejected when their @xmath0-values are less than @xmath131 . if @xmath132 , the power loss compared to the procedure with the oracle threshold is substantial , since the bonferroni method is really controlling at an effective level of size @xmath133 instead of @xmath36 .",
    "theorem [ thoptimal ] , in contrast , implies that the effective level under the westfall  young procedure converges to the desired level ( up to possible discretization effects ) .",
    "we showed in the last section that the westfall  young permutation method is asymptotically equivalent to the oracle threshold under the made assumptions . in this section",
    "we look in more detail at the difference between the nominal and effective levels of the oracle multiple testing procedure . controlling at nominal level  @xmath36 , the effective oracle level is defined as @xmath134 by definition , @xmath135 is less than or equal to @xmath36 .",
    "we now examine under which assumptions the effective level @xmath135 can be replaced by the nominal level @xmath36 . as a concrete example , we work with the following assumptions :    the test is a two - sample wilcoxon test with equal sample sizes @xmath136 , applied to a location - shift model as defined in section [ seclocationshift ] .",
    "block - size : the maximum size of a block satisfies @xmath137 as .    the restriction to equal sample sizes in ( w ) is only for technical simplicity .",
    "we then obtain the following result about the discretization error .",
    "[ thoptimaldiscrete ] assume .",
    "then the oracle critical value @xmath35 is strictly positive when @xmath138 when assuming in addition and , then the results of theorem [ thoptimal ] hold , and , for any @xmath139 , we have @xmath140 as @xmath141 such that @xmath142 .",
    "the first result in theorem [ thoptimaldiscrete ] says that the oracle critical value for the test defined in ( w ) is nontrivial , even when the number of tests grows almost exponentially with sample size .",
    "hence , in this setting the result from theorem [ thoptimal ] still applies in a nontrivial way .",
    "the second result in theorem [ thoptimaldiscrete ] gives sufficient criteria for the effective oracle level @xmath135 to converge to @xmath36 .",
    "it is conceivable that this result can also be obtained under a milder assumption than ( a3@xmath143 ) , but this requires a detailed study of the wilcoxon @xmath0-values , and we leave this for future work .",
    "the main takeaway message is that discreteness of the @xmath0-values does not change the optimality result fundamentally .",
    "the power of the westfall  young procedure has already been examined empirically in several studies .",
    "westfall et al .",
    "@xcite includes a comparison with the bonferroni ",
    "holm method , reporting a gain in power when using the westfall  young procedure .",
    "its focus is on `` genetic effects in association studies , '' including genotype ( snp - type ) analysis and also gene expression microarray analysis .",
    "becker and knapp @xcite apply the westfall  young permutation procedure and report substantial gain in power over bonferroni correction in the context of haplotype analysis .",
    "yekutieli and benjamini @xcite and reiner et al .",
    "@xcite discuss the gain of resampling in terms of power , although their focus is mainly on fdr controlling methods .",
    "also dudoit et al .",
    "@xcite and ge et al .",
    "@xcite report that resampling - based methods such as the westfall  young permutation procedure have clear advantages in terms of power .    here , we look at a few simulated examples to study the finite - sample properties and compare with the asymptotic results of theorem [ thoptimal ] .",
    "data for a two - sample location - shift model as in section [ seclocationshift ] with @xmath3 hypotheses and equal sample sizes of @xmath144 are generated from a multivariate gaussian distribution with unit variances and ( i ) a toeplitz correlation matrix with correlations @xmath145 for some @xmath146 and @xmath147 and ( ii )  a  block covariance model , where correlations within all blocks ( of size  50 each ) are set to the same @xmath148 and to 0 outside of each block .",
    "ten alternative hypotheses are picked at random from the first 100 components by applying a shift of 0.75 whereas all remaining @xmath149 null - hypotheses correspond to no shift .",
    "( left panel ) to @xmath150 ( right panel ) and the correlation parameter is varied as @xmath151 in the toeplitz model and @xmath152 in the block model .",
    "the results are shown for the bonferroni correction ( single - step and corresponding step - down bonferroni  holm ; light color ) ; the oracle procedure ( single - step and step - down ; gray color ) and the westfall  young permutation procedure ( single - step and step - down ; dark color ) . ]    we use a two - sided wilcoxon test .",
    "the power over 250 simulations of the single - step and step - down methods of the bonferroni - correction , the oracle procedure and the westfall  young permutation procedure are shown in figure [ figtoeplitz ] for level @xmath153 .",
    "the step - down version of the bonferroni correction is the bonferroni ",
    "holm procedure @xcite and the step - down version of the westfall  young procedure is given in westfall and young @xcite .",
    "the oracle threshold ( both single - step and step - down ) is approximated on a separate set of 1000 simulations , and the westfall  young method is using 1000 permutations for each simulation .",
    "the following main results emerge : the westfall  young method is very close in power to the oracle procedure for all values of @xmath3 in the block model , giving support to the asymptotic results of theorem [ thoptimal ] . moreover , the westfall  young and the oracle procedures are also very similar in the toeplitz model , indicating that theorem [ thoptimal ] may be generalized beyond block - independence models .",
    "the power gains of the westfall  young procedure , compared to bonferroni ",
    "holm , are substantial ; between 20% and 250% for the considered scenarios , where the largest gains are achieved in settings with a large number of hypotheses and high correlations .",
    "finally , the difference between step - down and single - step methods is very small in these sparse high - dimensional settings for all three multiple testing methods .",
    "it might be unexpected that the power of the westfall  young is slightly larger than the oracle procedure for two settings with very high correlations .",
    "this is due to the finite number of simulations when approximating the oracle threshold , a finite number of permutations in the westfall  young procedure and a finite number of simulation runs .",
    "the family - wise error rate is between 0.03 and 0.04 for both oracle and westfall  young procedures and below 0.02 for the bonferroni correction in the toeplitz model .",
    "the nominal level of @xmath153 is exceeded sometimes in the block model ( again for the reason that we use only a finite number of simulations ) , where both the oracle and westfall  young procedures attain a family - wise error rate between 0.04 and 0.07 in all settings .",
    "the computational cost of the westfall  young procedures scales approximately linearly with the number @xmath3 of hypotheses . when using 1000 permutations , computing the westfall  young threshold takes about 1.4 seconds per hypotheses on a 3 ghz cpu . for the largest setting of @xmath150 hypotheses ,",
    "the threshold could thus be computed in just over 2 minutes .",
    "it seems as if this computational cost is acceptable , even for very large - scale testing problems .",
    "we considered asymptotic optimality of large - scale multiple testing under dependence within a nonparametric framework .",
    "we showed that , under certain assumptions , the westfall  young permutation method is asymptotically optimal in the following sense : with probability converging to 1 as the number of tests increases , the westfall  young critical value for multiple testing at nominal level @xmath36 is greater than or equal to the unknown oracle threshold at level @xmath154 for any @xmath123 .",
    "this implies that the actual level of the westfall  young procedure converges to the effective oracle level @xmath135 . to investigate the possible impact of discrete @xmath0-values",
    ", we studied a specific example and provided sufficient conditions that ensure that @xmath135 converges to @xmath36.=-1    we gave several examples that satisfy subset - pivotality and our assumptions ( b1)(b3 ) [ while assumptions ( a1)(a3 ) are about the unknown data - generating distribution ] .",
    "most of these examples involve rank - based or permutation tests .",
    "these tests are appropriate for very high - dimensional testing problems .",
    "if the number of tests is in the thousands or even millions , extreme tail probabilities are required to claim significance , and these tail probabilities are more trustworthy under a nonparametric than a parametric test",
    ".    if the hypotheses are strongly dependent , the gain in power of the westfall  young method compared to a simple bonferroni correction can be very substantial .",
    "this is a well known , empirical fact , and we have established here that this improvement is also optimal in the asymptotic framework we considered .",
    "our theoretical results could be expanded to include step - down procedures like bonferroni ",
    "holm @xcite and the step - down westfall",
    " young method @xcite .",
    "the distinction between single - step and step - down procedures is very marginal though in our sparse high - dimensional framework , as reported in section [ secempirical ] , since the number of rejected hypotheses is orders of magnitudes smaller than the total number of hypotheses .",
    "after introducing some additional notation in section [ secnotationproofs ] , the proof of theorem [ thoptimal ] is in section [ sectionproof1 ] and the proof of theorem [ thoptimaldiscrete ] is in section  [ sectionproof2 ] .      let @xmath155 be the minimum @xmath0-value over all true null hypotheses in the @xmath156th block : @xmath157 and let @xmath158 denote the probability under @xmath5 that @xmath155 is less than or equal to a constant @xmath159 $ ] , that is , @xmath160 throughout , we denote the expected value , the variance and the covariance under @xmath5 by @xmath161 , @xmath162 and @xmath163 , respectively .",
    "let @xmath164 and @xmath165 .",
    "let @xmath166 and @xmath167 .",
    "then writing expression ( [ eqthoptimal ] ) in terms of @xmath168 and @xmath169 is equivalent to @xmath170 by definition , @xmath171 we thus have to show that @xmath172 as @xmath75 .",
    "first , we show in lemma [ lemmachati ] that there exists an @xmath173 such that @xmath174 for all @xmath175 and for all @xmath1 .",
    "this result is mainly due to the sparsity assumption  ( a2 ) .",
    "second , we show in lemma [ lemmaapproxpermutationallsimple ] that @xmath176 theorem [ thoptimal ] follows by combining these two results .    [ lemmachati ]",
    "let @xmath124 , @xmath125 , and assume and  .",
    "then there exists an @xmath173 such that @xmath177 for all @xmath175 and for all @xmath1 .",
    "note that @xmath178 by definition . using the union bound",
    ", we have , for all @xmath86 and all @xmath1 , @xmath179\\\\[-8pt ] & & { } + \\sum_{j \\in i'(p_m ) } p^ * \\bigl(p_j(w ) \\le s\\bigr).\\nonumber\\end{aligned}\\ ] ] hence , we only need to show that there exists an @xmath173 such that @xmath180 for all @xmath175 and all @xmath1 . by assumption ( b2 ) with constant @xmath181 , @xmath182\\\\[-8pt ] & = & r \\frac{|i'(p_m)|}{b } b c_{m , n}(\\alpha).\\nonumber\\end{aligned}\\ ] ] since @xmath183 as @xmath75 by assumption ( a2 ) , and @xmath184 is bounded above by @xmath185 under assumptions ( a1 ) and ( b3 ) ( see lemma  [ lemmasumpib ] ) , we can choose a @xmath186 such that the right - hand side of ( [ eqlastline ] ) is bounded above by @xmath187 for all @xmath175 .",
    "this proves the claim in ( [ eqtoshownew ] ) and completes the proof .",
    "[ lemmaapproxpermutationallsimple ] let @xmath188 and @xmath123 and assume and .",
    "then @xmath189    let @xmath190 .",
    "the statement in the lemma is equivalent to showing that there exists an @xmath173 such that @xmath191 for all @xmath175 . by definition , @xmath192\\\\[-8pt ] & = & \\frac{1}{|\\mathcal{g}| } \\sum_{g \\in\\mathcal g } r(g , w),\\nonumber\\end{aligned}\\ ] ] where @xmath193 ( we suppress the dependence on @xmath194 and @xmath36 for notational simplicity . )    let @xmath78 be a random permutation , chosen uniformly in @xmath42 , and let @xmath92 denote the identity permutation .",
    "then , by assumption ( b1 ) , it follows that @xmath195 by definition of @xmath35 [ see ( [ eqoracle ] ) ] , @xmath196 hence , the desired result ( [ eqts2 ] ) follows from a markov inequality as soon as one can show that the variance of ( [ eqpstareq ] ) vanishes as @xmath75 , that is , if @xmath197 as @xmath75 .",
    "let @xmath198 be two random permutations , drawn independently and uniformly from @xmath79 .",
    "then @xmath199 hence , in order to show ( [ eqpstarvar ] ) , we only need to show that @xmath200 define @xmath201 so that @xmath202 .",
    "we then need to prove that , as @xmath75 , @xmath203 using assumption ( a1 ) , the left - hand side in ( [ eqts3 ] ) can be written as @xmath204 ^ 2 .\\ ] ] note that @xmath205 and @xmath206 ^ 2 $ ] are bounded between @xmath207 and @xmath92 . for sequences of numbers",
    "@xmath208 and @xmath209 that are bounded between @xmath207 and @xmath92 , the following inequality holds : @xmath210 ^ 2    & & \\qquad= o(b^{-1})\\nonumber\\end{aligned}\\ ] ] as @xmath75 .",
    "conditional on @xmath1 , @xmath211 where @xmath212 is the proportion of all permutations @xmath50 for which @xmath213 or , equivalently , @xmath214 thus , the random proportion @xmath212 is a function of @xmath1 .",
    "denote its distribution by  @xmath215 .",
    "using lemma [ lemmasupportf ] , the support of @xmath215 is contained in the interval @xmath216 $ ] under assumptions ( a1 ) , ( b1 ) and ( b2 ) .",
    "hence , using lemma [ lemmavar ] , it follows that @xmath217 ^ 2 \\\\ & \\le & \\bigl ( \\log\\{1/(1-\\alpha)\\}\\alpha{r}^2 m_b b^{-1}\\bigr)^2.\\end{aligned}\\ ] ] since @xmath218 under assumption ( a3 ) , claim ( [ eqts4 ] ) follows .",
    "[ lemmasumpib ] under assumptions and , we have @xmath219    let @xmath220 and @xmath221 .",
    "then @xmath222 where the inequality follows from the definition of @xmath223 , and the equality follows from assumption ( b3 ) and the fact that @xmath178 . summing ( [ eqpibc ] ) over @xmath72 yields the first inequality of ( [ eqboundsumpib ] ) .    to prove the second inequality of ( [ eqboundsumpib ] ) , note that assumption ( a1 ) and the definition of @xmath35",
    "imply that @xmath224\\le\\alpha.\\ ] ] the maximum of @xmath225 under constraint ( [ eqconstraint ] ) is obtained when @xmath226 this implies @xmath227 for all @xmath72 , so that @xmath228 and this is bounded above by @xmath185 for all values of @xmath127 .",
    "[ lemmasupportf ] assume and .",
    "let @xmath215 be the distribution of  @xmath212 , where @xmath212 is defined in ( [ eqdefmub ] ) .",
    "then @xmath229 .\\ ] ]    using assumption ( b2 ) with constant @xmath181 and the union bound , it holds that @xmath230 since @xmath231 , the support of @xmath215 is thus in the interval @xmath232 $ ] .",
    "hence , the proof is complete if we show that @xmath233 to see that ( [ equpperboundc ] ) holds , we first show that @xmath234 the first inequality in ( [ equpperboundc2 ] ) follows directly from the definition of @xmath35 ; see ( [ eqoracle ] ) . to prove the second inequality , note that assumption ( a1 ) implies that @xmath235 by assumption ( b1 ) and the law of iterated expectations , @xmath236\\\\[-8pt ] & = & e_{m } \\bigl\\ { p_{m , g}\\bigl\\ { p^{(b ) } ( gw ) > c_{m , n}(\\alpha)|w\\bigr\\ } \\bigr\\}.\\nonumber\\end{aligned}\\ ] ] by assumption ( b2 )",
    ", the conditional probability within each block satisfies @xmath237 where @xmath221 .",
    "since the right - hand side of ( [ eqpmg ] ) does not depend on  @xmath1 , the same bound holds for ( [ eqpmpbw ] ) , where we also take the expectation over  @xmath1 . using this result in ( [ eqindep ] )",
    ", the second inequality in ( [ equpperboundc2 ] ) follows .",
    "finally ,  ( [ equpperboundc2 ] ) implies @xmath238 since @xmath239 for all values of @xmath127 , it follows that @xmath240 .",
    "this proves ( [ equpperboundc ] ) and completes the proof .",
    "[ lemmavar ] let @xmath241 be a real - valued random variable with support @xmath242 \\subset[0,1]$ ] .",
    "suppose that the distribution of the two random variables @xmath243 and @xmath244 , conditional on @xmath245 , is given by @xmath246 then @xmath247 .    by the assumption that @xmath243 and @xmath244 are bernoulli conditional on @xmath241",
    ", it follows that @xmath248 . combining this with the law of iterated expectation and the fact that @xmath243 and @xmath244 are conditionally independent given @xmath241",
    ", we obtain @xmath249 moreover , we have @xmath250 and similarly @xmath251 .",
    "hence , @xmath252 finally , @xmath253 by the assumption on the support of @xmath241 .",
    "first , note that ( w ) implies ( b1)(b3 ) . using the union bound and assumption ( b3 )",
    ", it holds for any @xmath86 that @xmath254 is an upper bound for @xmath255 .",
    "hence , @xmath256\\\\[-8pt ] & \\ge & \\max\\ { s \\in s_n \\dvtx m s \\le\\alpha\\}.\\nonumber\\end{aligned}\\ ] ] this implies that the oracle critical value is larger than zero if the set @xmath257 is nonempty , which is the case if @xmath258 .",
    "the smallest possible two - sided wilcoxon @xmath0-value is @xmath259 .",
    "hence , it is sufficient to require that @xmath260 , or equivalently , that @xmath261 .",
    "note that ( a3@xmath143 ) implies ( a3 ) .",
    "hence , under assumptions ( w ) , ( a1 ) , ( a2 ) and ( a3@xmath143 ) , the result in theorem [ thoptimal ] applies .",
    "let @xmath124 .",
    "we will now show that under assumptions ( w ) , ( a1 ) and  ( a3@xmath143 ) , @xmath262 as @xmath141 such that @xmath142 , where @xmath135 was defined in ( [ eqalpha- ] ) .",
    "define @xmath263 . using the definition of @xmath135 and assumption  ( a1 )",
    ", we have @xmath264 \\\\ & = & 1-\\prod_{b=1}^b [ 1-\\pi_b\\{c^+_{m , n}(\\alpha)\\ } + \\pi_b\\ { c^+_{m , n}(\\alpha)\\ } - \\pi_b\\{c_{m , n}(\\alpha)\\ } ] .\\nonumber\\end{aligned}\\ ] ]    define the function @xmath265 \\to{\\mathbb{r}}$ ] by @xmath266,\\end{aligned}\\ ] ] so that the right - hand side of ( [ eqstart ] ) equals @xmath267 , where @xmath268 for @xmath72 . a first - order taylor expansion of @xmath267 around @xmath269 yields @xmath270 where @xmath271 . for all @xmath72",
    ", we have @xmath272\\\\ & = & - \\frac{1-g_{m , n}(0)}{1-\\pi_b\\{c^+_{m , n}(\\alpha)\\ } } \\ge- \\frac { 1-g_{m , n}(0)}{1-m_b c^+_{m , n}(\\alpha)},\\end{aligned}\\ ] ] where the inequality follows from @xmath273 for @xmath72 , by the union bound and assumption ( b3 ) . plugging this into ( [ eqtaylor ] ) yields @xmath274\\\\[-8pt ] &",
    "= & g_{m , n}(0 ) \\biggl ( 1 + \\frac{\\sum_{b=1}^b w_b}{1-m_b c^+_{m , n}(\\alpha)}\\biggr ) - \\frac{\\sum_{b=1}^b w_b}{1-m_b c^+_{m , n}(\\alpha ) } + r.\\nonumber\\end{aligned}\\ ] ] the definition of @xmath275 implies that @xmath276 for all @xmath3 and @xmath2 .",
    "hence , if @xmath277 as @xmath141 such that @xmath278 , then the right - hand side of ( [ eqtaylor2 ] ) converges to @xmath36 and the proof is complete .",
    "we first consider @xmath279 . by definition , there is no value @xmath280 such that @xmath281 .",
    "hence , @xmath282 where the inequality follows from the union bound , and the last equality is due to assumption ( b3 ) .",
    "this implies @xmath283 similarly , we have @xmath284 note that @xmath285 by lemma [ lemmasumpib ] and @xmath286 ( and hence @xmath287 ) by assumption ( a3@xmath143 ) . hence , in order to prove ( [ eqtwothingstoshow ] ) , it suffices to show that @xmath288 let the ordered @xmath0-values in @xmath30 , based on a two - sided wilcoxon test with equal sample sizes @xmath289 in both classes , be denoted by @xmath290 , where @xmath291 .",
    "it is well known that @xmath292 and @xmath293 , where @xmath294 is the number of integer partitions of @xmath118 such that neither the number of parts nor the part magnitudes exceed @xmath2  @xcite .",
    "let @xmath295 satisfy @xmath296 .",
    "then @xmath297 this ratio converges to 1 if @xmath298 .",
    "recall that @xmath299 [ see ( [ eqcmnge ] ) ] .",
    "hence , @xmath300 since @xmath301 as @xmath302 such that @xmath303 , we have that under these conditions @xmath298 and @xmath304 .",
    "thus ( [ eqratioconv ] ) holds and hence implies ( [ eqtwothingstoshow ] ) , which completes the proof .",
    "we would like to thank two referees for constructive comments ."
  ],
  "abstract_text": [
    "<S> test statistics are often strongly dependent in large - scale multiple testing applications . </S>",
    "<S> most corrections for multiplicity are unduly conservative for correlated test statistics , resulting in a loss of power to detect true positives . we show that the westfall  young permutation method has asymptotically optimal power for a broad class of testing problems with a block - dependence and sparsity structure among the tests , when the number of tests tends to infinity .    ,     +    .    . </S>"
  ]
}