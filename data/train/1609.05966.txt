{
  "article_text": [
    "the future power system will be modernized with advanced metering infrastructure , bilateral information communication network , and intelligent monitoring and control system to enable a smarter operation  @xcite .",
    "the transformation to the smart grid is expected to facilitate the deep integration of renewable energy , improve the reliability and stability of the power transmission and distribution system , and increase the efficiency of power generation and energy consumption .",
    "demand response program is a core subsystem of the smart grid , which can be employed as a resource option for system operators and planners to balance the power supply and demand .",
    "the demand side control of responsive loads has attracted considerable attention in recent years  @xcite .",
    "an intelligent load control scheme should deliver a reliable power resource to the grid , while maintaining a satisfactory level of power usage to the end - user .",
    "one of the greatest technical challenges of engaging responsive loads to provide grid services is to develop control schemes that can balance the aforementioned two objectives  @xcite .",
    "to achieve such an objective , a hierarchical load control structure via aggregators is suggested to better integrate the demand - side resources into the power system operation and control  @xcite .    in the hierarchical scheme",
    ", the aggregator performs as an interface between the loads and the system operator .",
    "it aggregates the flexibility of responsive loads and offers it to the system operator . in the meantime",
    ", it receives dispatch signals from the system operator , and execute appropriate control to the loads to track the dispatch signal .",
    "therefore , an aggregate flexibility model is fundamentally important to the design of a reliable and effective demand response program . it should be detailed enough to capture the individual constraints while simple enough to facilitate control and optimization tasks . among various modeling options for the adjustable loads such as thermostatically controlled loads ( tcls )",
    ", the average thermal battery model  @xcite aims to quantify the aggregate flexibility , which is the set of the aggregate power profiles that are admissible to the load group .",
    "it offers a simple and compact model to the system operator for the provision of various ancillary services .",
    "apart from the adjustable loads , deferrable loads such as pools and plug - in vehicles ( pevs ) can also provide significant power flexibility by shifting their power demands to different time periods .",
    "however , different from the adjustable loads , it is more difficult to characterize the flexibility of deferrable loads due to the heterogeneity in their time constraints .    in this paper , we focus on modeling the aggregate flexibility for control and planning of a large number of deferrable loads .",
    "there is an ongoing effort on the characterization of the aggregate flexibility of deferrable loads  @xcite .",
    "an empirical model based on the statistics of the simulation results was proposed in  @xcite .",
    "a necessary characterization was obtained in  @xcite and further improved in  @xcite . for a group of deferrable loads with homogeneous power , arrival time , and departure time ,",
    "a majorization type exact characterization was reported in  @xcite . with heterogeneous departure times and energy requirements ,",
    "a tractable sufficient and necessary condition was obtained in  @xcite , and was further utilized to implement the associated energy service market  @xcite . despite these efforts , a sufficient characterization of the aggregate flexibility for general heterogeneous deferrable loads remains a challenge .    to address this issue",
    ", we propose a novel geometric approach to extract the aggregate flexibility of heterogeneous deferrable loads .",
    "geometrically , the aggregate flexibility modeling amounts to computing the minkowski sum of multiple polytopes , of which each polytope represents the flexibility of individual load .",
    "however , calculating the minkowski sum of polytopes under facet representation is generally np - hard  @xcite .",
    "interestingly , we are able to show that for a group of loads with general heterogeneity , the exact aggregate flexibility can be characterized analytically .",
    "but the problem remains in the sense that there are generally exponentially many inequalities with respect to the number of loads and the length of the time horizons , which can be intractable when the load population size or the number of steps in the considered time horizon is large .",
    "therefore , a tractable characterization of the aggregate flexibility is desired .    for deferrable loads with heterogeneous arrival and departure times , the constraint sets are polytopes that are contained in different subspaces .",
    "alternative to the original definition of the minkowski sum , we find it beneficial to regard it as a projection operation . from the latter perspective",
    ", the aggregate flexibility is considered as the projection of a higher dimensional polytope to the subspace representing the aggregate power of the deferrable loads .",
    "therefore , instead of approximating the minkowski sum directly by its definition , we turn to approximating the associated projection operation . to this end , we formulate an optimization problem which approximates the projection of a full dimensional polytope via finding the maximum homothet of a given polytope , i.e. , the dilation and translate of that polytope .",
    "the optimization problem can be solved very efficiently by solving an equivalent linear program .",
    "furthermore , we propose a `` divide and conquer '' strategy which enables efficient and parallel computation of the aggregate flexibility of the load group .",
    "the scheduling policy for each individual load is derived simultaneously along the aggregation process .",
    "finally , we apply our model to the pev energy arbitrage problem , where given predicted day - ahead energy prices , the optimal power profile consumed by the load group is calculated to minimize the total energy cost .",
    "the simulation results demonstrate that our approach is very effective at characterizing the feasible aggregate power flexibility set , and facilitating finding the optimal power profile .",
    "there are several closely - related literature on characterizing flexibility of flexible loads . in our previous work",
    "@xcite , a geometric approach was proposed to optimally extract the aggregate flexibility of heterogeneous tcls based on the given individual physical models .",
    "the simulation demonstrated accurate characterization of the aggregate flexibility which was very close to the exact one .",
    "however , this approach can not be applied to the deferrable loads directly .",
    "similar to  @xcite which sought a special class of polytopes to facilitate fast calculation of minkowski sum , the authors in  @xcite proposed to characterize the power flexibility using zonotopes .",
    "different from  @xcite , this method could deal with the time heterogeneity as appeared in the deferrable loads .",
    "in addition , both approaches extracted the flexibility of _ individual _ load . * * in comparison , the approach proposed in this paper is a _ batch _ processing method : it directly approximates the aggregate flexibility of a group of loads , which could mitigate the losses caused by the individual approximation as emphasized in  @xcite .",
    "* notation * : the facet representation of a polytope @xmath0 is a bounded solution set of a system of finite linear inequalities @xcite : @xmath1 , where throughout this paper @xmath2 ( or @xmath3 , @xmath4 ,  @xmath5 ) means elementwise inequality . a polytope @xmath0 is called full dimensional , if it contains an interior point in @xmath6 .",
    "given a full dimensional polytope @xmath7 in @xmath6 , a scale factor @xmath8 , and a translate factor @xmath9 , the set @xmath10 is called a homothet of @xmath11 .",
    "we use @xmath12 to denote the minkowski sum of multiple sets , and @xmath13 of two sets .",
    "we use @xmath14 to represent the @xmath15 dimensional column vector of all ones , @xmath16 the @xmath15 dimensional identity matrix , and @xmath17 the indicator function of the set @xmath18 .",
    "the bold @xmath19 denotes the column vector of all @xmath20 s with appropriate dimension . for two column vectors",
    "@xmath21 and @xmath22 , we write @xmath23 for the column vector @xmath24^{t}$ ] where no confusion shall arise .",
    "we consider the problem of charging a group of @xmath25 pevs .",
    "the energy state of each pev can be described by a discrete time difference equation on a finite time horizon @xmath26 $ ] , @xmath27 where @xmath28 is the state of charge ( soc ) with initial condition @xmath29 , and @xmath30 $ ] with @xmath31 is the charging power supplied to the vehicle during @xmath32 .",
    "let @xmath33 denote the time interval @xmath32 , where without loss of generality , we will assume the time unit @xmath34 hour in the sequel .",
    "moreover , the pev must be charged during a time window @xmath35 where @xmath36 is its arrival time , @xmath37 is its departure time , and @xmath38 .. at the deadline @xmath37 , the pev is supposed to be charged with an soc @xmath39 $ ] , where we assume that @xmath40 .",
    "the load is called deferrable if @xmath41 .",
    "a charging power profile @xmath42^{t}$ ] is called admissible if the load is only charged within @xmath43 and its soc at @xmath44 is within @xmath45 $ ] .",
    "we differentiate the @xmath46 pev ( @xmath47 ) by using a superscript @xmath48 on the variables introduced above .",
    "the charging task of the @xmath46 pev is determined by @xmath49 .",
    "let @xmath50 be the set of all the admissible power profiles of the @xmath46 load .",
    "it can be described as , @xmath51,\\forall t\\in\\mathbb{a}^{i},\\\\ u_{t}^{i}=0,\\forall i\\in\\mathrm{\\mathbb{t}}\\backslash\\mathbb{\\mathbb{a}}^{i}\\mbox { and } { \\bf 1}_{m}^{t}u^{i}\\in[\\underline{e}^{i},\\bar{e}^{i } ] \\end{array}\\right\\ } \\label{eq : pi}\\ ] ]    it is straightforward to see that each @xmath50 is a convex polytope .",
    "in addition , we say @xmath50 is of codimension @xmath52 if its affine hull is a @xmath53 dimensional subspace of @xmath6 .    in the smart grid ,",
    "the aggregator is responsible for procuring a generation profile from the whole market to service a group of loads .",
    "we define the generation profile that meets the charging requirements of all pevs as follows .    a generation profile @xmath21 is called _ adequate _ if there exists a decomposition @xmath54 , such that @xmath55 is an admissible power profile for the @xmath46 load , i.e. , @xmath56 .",
    "we call the set of all the adequate generation profiles the _ aggregate flexibility _ of the load group",
    ". it can be defined as the minkowski sum of the admissible power sets of each load , @xmath57    it is straightforward to show that @xmath7 is also a convex polytope whose codimension is to be determined by the parameters @xmath58 of the deferrable loads .",
    "the numerical complexity of the existing algorithms for calculating the minkowski sum is rather expensive ( see  @xcite for some numerical results ) . in general , calculating @xmath59 when @xmath60 and @xmath61 are polytopes specified by their facets is np - hard  @xcite .",
    "however , for the particular problem of pev charging , it is possible to characterize the exact aggregate flexibility @xmath7 analytically .",
    "such characterization is built on the results from the matrix feasibility problem and from the network flow theory , both of which are intrinsically connected with the pev charging problem .",
    "[ thm : iff]consider a group of pevs or deferrable loads with heterogeneous parameters @xmath62 , @xmath63 .",
    "then the set @xmath7 of adequate generation profiles consists of those @xmath64^{t}$ ] which satisfy @xmath65 for all subsets @xmath66 and @xmath67 , where @xmath68 and @xmath69 are the complement sets of @xmath70 and @xmath71 in @xmath72 and @xmath73 , respectively .",
    "we first interpret the characterization of @xmath7 as a matrix feasibility problem . by definition ,",
    "if a generation profile @xmath21 is adequate , then there exists a decomposition @xmath54 such that @xmath55 completes the @xmath46 pev s charging task .",
    "this is equivalent to the existence of a @xmath74 matrix @xmath75 , the @xmath46 row of which is an admissible power profile of the @xmath46 pev .",
    "the matrix @xmath75 will be referred to as the charging matrix .",
    "given @xmath76 , let @xmath77 denote the set of all such charging matrices .",
    "these matrices have special structures : the columns indexed by @xmath78 in the @xmath46 row are the free positions which can be filled with a real number in @xmath79 $ ] , while the rest of the positions in this row are forbidden positions that can only be filled with @xmath20 s .",
    "moreover , @xmath80 , it has the @xmath81 column sum @xmath82 and the @xmath46 row sum in the interval @xmath83 $ ] .",
    "clearly , the non - emptiness of the set gives the condition for being an adequate generation profiles , i.e , @xmath84    furthermore , the condition for @xmath85 can be derived by applying  ( * ? ? ?",
    "* theorem 2.7 ) to the matrix case . by the definition in  @xcite ,",
    "partitions @xmath86 and @xmath87 of a sequence are said to be orthogonal , if @xmath88 , @xmath89 and @xmath90 . for a matrix ,",
    "clearly the rows and columns constitute such orthogonal partitions .",
    "this is the only condition required by  ( * ? ? ?",
    "* theorem 2.7 ) .",
    "then by a direct calculation of the summation on the right hand side of  ( * ? ? ?",
    "* ( 2.8 ) ) , we can obtain  ( [ eq : fullhetero ] ) .",
    "this completes the proof .    in general , there are @xmath91 inequalities in  ( [ eq : fullhetero ] ) , which will be intractable if @xmath25 is several thousand .",
    "when the pevs are fully homogeneous , i.e. , they share the same set of parameters @xmath58 , the above result reduces to the well - known majorization condition @xcite , which consists of only @xmath92 inequalities . in the linear algebra literature ,",
    "studies on the matrix feasibility problem are also focused on finding tractable conditions under limited heterogeneities in the parameters . adapted to the pev charging scenario , if the arrival time @xmath36 and the charging rate @xmath93 are homogeneous , @xmath94 , and under certain monotonicity condition on @xmath21 , the number of inequalities in  ( [ eq : fullhetero ] )",
    "can be significantly reduced @xcite .",
    "the author in  @xcite obtained a simple majorization type result under a special monotonicity condition on @xmath21 . under this condition , the charging rate @xmath93 can be relaxed to be heterogeneous both among different pevs and at different time instances .",
    "note that theorem  [ thm : iff ] also applies to the case where the charging rate takes integer values ( see  ( * ? ? ?",
    "* remark ( 2.19 ) ) ) .",
    "since the condition  ( [ eq : fullhetero ] ) is very difficult to check in practice , the goal of this paper is to find a sufficient approximation of it using much fewer inequalities that does not depend on @xmath25 .",
    "the direct approximation from  ( [ eq : fullhetero ] ) could be difficult .",
    "however , it is possible to start with the definition  ( [ eq : p_af ] ) . an interesting perspective is to view the minkowski sum as a projection operation .",
    "clearly , from  ( [ eq : p_af ] ) , we see that @xmath7 is the projection of a higher dimensional polytope @xmath95 onto the @xmath21 subspace , i.e. @xmath96 where @xmath97 @xmath98 and @xmath99 is the projection onto the @xmath21 subspace .",
    "in fact , the minkowski sum of two sets is often calculated via projection .",
    "note that the number of the facets of the polytope @xmath95 is of @xmath100 , as compared to @xmath101 of its projection .",
    "the relation ( [ eq : prj ] ) inspires us to approximate @xmath7 based on only the expression of @xmath95 .",
    "the specific approximation method will be described in the next section .",
    "we will first present our method in a general setting of computing the maximum homothet of a polytope included in a polytopic projection , and then apply it to the pev charging scenario .",
    "our approximation method is inspired by  @xcite , where the ellipsoidal approximation of a polytopic projection is addressed resorting to the robust optimization technique  @xcite .",
    "given full dimensional polytopes @xmath102\\leq c\\},\\end{aligned}\\ ] ] we want to find its maximum homothet of @xmath11 contained in the projection of @xmath95 onto the @xmath21 subspace .",
    "it can be formulated as the following optimization problem @xmath103    to facilitate the later formulation of the optimization problems as linear programs , we perform a change of variables @xmath104 and @xmath105 .",
    "thus problem ( [ eq : opp ] ) is equivalent to finding the minimum homothet of @xmath106 that contains @xmath11 , i.e. @xmath107    furthermore , since orthogonal projection is a linear operation , we have @xmath108 where @xmath109 $ ] is the lift of the vector @xmath110 in @xmath111 by setting the additional dimensions to @xmath19 .",
    "hence , @xmath112 for some @xmath113 implies the constraint in ( [ eq : opp1 ] ) .",
    "therefore , it is sufficient to pose a more restrictive constraint to obtain a suboptimal solution , and we have @xmath114 where the constraint can be expressed as @xmath115\\leq sc+b\\tilde{r}\\right\\ } .\\ ] ]    by applying the farkas s lemma ( see the appendix [ subsec : farkaslemma ] ) , the above optimization problem can be transformed into the following linear programming problem , @xmath116,\\\\   & gh\\leq b\\left[\\begin{array}{c } r\\\\ -\\bar{u}_{0 } \\end{array}\\right]+sc .",
    "\\end{array}\\label{eq : opp3}\\ ] ]    before proceed , we illustrate the formulation ( [ eq : opp2 ] ) using a simple example borrowed from  @xcite .",
    "[ exa : test]let @xmath95 be given by @xmath117 , and @xmath118 .",
    "the polytope @xmath95 is plotted in fig .",
    "[ fig : example ] .",
    "we solve the problem ( [ eq : opp3 ] ) to find a sufficient approximation of @xmath119 , and obtain @xmath120 , @xmath121 , @xmath122 .",
    "the corresponding scale factor is @xmath123 , and translate factor is @xmath124 . from these data",
    "we can have that @xmath125^{t}\\subset\\tilde{\\mathcal{p}}$ ] .",
    "this corresponds to the fact that the longest horizontal line segment that is contained in @xmath95 is at @xmath126 .",
    "the approximation of the projection of @xmath95 via problem ( [ eq : opp2 ] ) . ]    clearly , the formulation of problem  ( [ eq : opp2 ] ) is very conservative .",
    "it actually requires the homothet of the polytope @xmath11 be entirely contained in @xmath95 .",
    "it amounts to each time fixing @xmath127 , and then measuring the cross section of @xmath95 .",
    "however , for approximating the projection of @xmath95 , we only need @xmath128 where @xmath129 is a function of @xmath21 , while in problem ( [ eq : opp2 ] ) @xmath21 is determined by @xmath129 .",
    "the relation ( [ eq : dependence ] ) can be interpreted in the context of the adjustable robust optimization problem  @xcite , where @xmath21 is the so called non - adjustable variable , and @xmath129 is the adjustable variable . the function @xmath130 is called the decision rule .",
    "solving  ( [ eq : opp2 ] ) over all possible choices of @xmath130 is intractable . an efficient way to overcome",
    "this is to restrict the choice of @xmath130 to be the affine decision rules , @xmath131 where @xmath132 , and @xmath133 . using ( [ eq : decision ] ) in problem ( [ eq : opp2 ] ) and by some manipulation , we can obtain @xmath134u\\leq b\\left[\\begin{array}{c } r\\\\ -v \\end{array}\\right]+sc\\right\\ } .",
    "\\end{array}\\label{eq : oppapp}\\ ] ]    using the farkas s lemma , problem ( [ eq : oppapp ] ) can be solved by the following linear programming    @xmath135,\\\\   & gh\\leq b\\left[\\begin{array}{c } r\\\\ -v \\end{array}\\right]+sc . \\end{array}\\ ] ]    we test the above formulation by computing the approximation of the polytopic projection in example [ exa : test ] .",
    "we solve the problem ( app ) and obtain @xmath136 , @xmath137 .",
    "this corresponds to the interval @xmath138 $ ] , which is exactly @xmath119 .    in general",
    ", the problem ( app ) gives a suboptimal solution for the approximation of @xmath119 with respective to @xmath11 . a possible way to reduce",
    "the conservativeness is to employ the quadratic decision rule or other nonlinear decision rules as reported in  @xcite .      in this subsection",
    ", the polytopic projection approximation developed in the above section will be employed to aggregate the pevs flexibility .",
    "we will discuss several issues including the choice of the nominal model @xmath11 , the preprocessing of the charging constraints , and the strategy for parallel computation .",
    "finally , the explicit formulae for the flexibility model and the corresponding scheduling policy are derived .",
    "intuitively , one can choose the nominal polytope @xmath11 to be of the similar form of  ( [ eq : pi ] ) , and the parameters can be taken as the mean values of the pev group . more generally , we can define the virtual battery model as follows .",
    "the set @xmath139 is called a @xmath15-horizon discrete time virtual battery with parameters @xmath140 , if @xmath141\\}.\\ ] ] @xmath139 is called a sufficient battery if @xmath142 .",
    "conceptually , the virtual battery model mimics the charging / discharging dynamics of a battery .",
    "we can regard @xmath21 as the power draw of the battery , @xmath143 and @xmath144 as its discharging / charging power limits , and @xmath145 and @xmath146 as the energy capacity limits .",
    "geometrically , it is a polytope in @xmath6 with @xmath147 facets , which is computationally very efficient when posed as the constraint in various optimization problems .",
    "note that the original high - dimensional polytope @xmath95 defined in  ( [ eq : ptilde ] ) contains equality constraints , which is not full dimensional .",
    "therefore , first we have to remove the equalities by substituting the variables . for simplicity , assume that @xmath40 .",
    "more explicitly , let @xmath148 be the @xmath46 pev s charging profile at time @xmath149 , @xmath89 , and @xmath150 , @xmath82 be the generation profile at time @xmath149 .",
    "the overall charging constraints of the pev group can be written as follows @xmath151 which is a polytope in @xmath152 , and the coordinate is designated to be @xmath153 .",
    "we first need to eliminate the equality constraints containing @xmath154 , i.e. , the first line of  ( [ eq : original ] ) .",
    "to standardize the elimination process , define @xmath155 , which is the index set of the pevs that can be charged at time @xmath149 . without loss of generality , assume that @xmath156 , @xmath150 , and we substitute @xmath157 , @xmath150 in  ( [ eq : original ] ) , where @xmath158 is the first pev in the set @xmath159 .",
    "let @xmath160 be the set of time instants at which the substitution of @xmath148 is made .",
    "further , we remove the coordinate @xmath161 and obtain , @xmath162 where the new coordinate becomes @xmath163 with @xmath164 and @xmath165_{t\\in\\mathbb{a}^{i}\\backslash s_{i}}$ ] , @xmath63 .",
    "clearly , @xmath166 has a dimension @xmath167 , and there are a number of @xmath168 linear inequalities in ( [ eq : eliminated ] ) .",
    "we denote it by the matrix form , @xmath169\\leq c,\\label{eq : bm}\\ ] ] where note that @xmath170 is a sparse matrix and has the structure , @xmath171.\\ ] ]      for a fixed time horizon @xmath15 , both the number of the decision variables and the number of inequality constraints of problem  ( app ) increase linearly with @xmath172 .",
    "when the number of pevs to be aggregated is too large , solving problem  ( app ) would be intractable . to address the increasing numerical complexity",
    ", we propose to divide the pevs into small groups , and solve problem  ( app ) for each group with respect to the same nominal model @xmath11 . denoting the solutions of problem  ( app ) for the @xmath173 group by @xmath174 , the aggregate flexibility of the @xmath173 group",
    "is given by @xmath175 .",
    "then the flexibility of the overall pev group can be calculated directly based on the following lemma .    [",
    "lem : mksksumscale]let @xmath11 be a polytope , and @xmath176 , @xmath177 be non - negative scalars",
    ". then @xmath178 .",
    "the above result can be easily verified .",
    "a more general proof for the convex body can be found in  ( * ? ? ? * remark 1.1.1 ) ) .    by this `` divide and conquer '' strategy",
    ", the original highly complex optimization problem can be solved very efficiently in a parallel fashion . however , this increases the conservativeness of the approximation , which is a result of the trade - off between the tractability and the optimality .    in case",
    "that different nominal models @xmath179 are used for each group , we can perform the aggregation again over the obtained groups . repeating this after several stages , we can arrive one virtual battery model for the overall pev group .",
    "even though we have to spread the computation over time in different stages , in practice this process terminates soon since the number of stages is of order @xmath180 when @xmath181 pevs / groups are processed at each run of problem  ( app ) .      combining the above development",
    ", the following explicit formulae for designing the sufficient virtual battery can be derived . the scheduling policy for each individual pevs",
    "can also be obtained . without loss of generality ,",
    "these results are stated for the case where only one stage aggregation is executed .",
    "the formulae for multi - stage aggregation can be obtained analogously .",
    "for convenience , let us denote the solutions of the problem ( app ) by the output of the function @xmath182 where @xmath183 is the high - dimensional polytope associated with the @xmath173 group of pevs , and @xmath11 is a given nominal model parameterized by @xmath184 .",
    "the proof of the following theorem can be found in the appendix [ subsec : proof - of - theorem ] .",
    "[ thm : suffvb]suppose @xmath185 , @xmath186 .",
    "then @xmath187 is a sufficient battery parameterized by    @xmath188    where @xmath189 , @xmath190 and @xmath191 , @xmath192 .",
    "furthermore , @xmath193 the scheduling policy is given by @xmath194 where @xmath195 denotes the charging profiles of the number of @xmath196 pevs in the @xmath173 group .",
    "the maximum and the minimum charging rates of the designed virtual battery model . ]    aggregate charging profile versus the price . ]",
    "in this section , we consider coordination of a group of 1000 pevs for energy arbitrage .",
    "the considered time horizon is 24 hours , and the price is taken as the day - ahead energy market locational marginal pricing ( lmp )  @xcite .",
    "the parameters of pevs are randomly generated by their types and the corresponding probability distributions ( see  @xcite for more details ) .",
    "since most of the pevs arrive during the afternoon to midnight and leave during the next 12 hours , we choose to simulate from 12:00 noon to the same time on the next day .",
    "in addition , we assume a @xmath197 total charging energy flexibility around the nominal energy requirement .",
    "the ( app ) problem is solved using the glpk linear programming solver  @xcite interfaced with yalmip  @xcite . at the first stage ,",
    "we randomly divide the 1000 pevs into 100 groups , where each group contains 10 pevs .",
    "the aggregate flexibility approximation is thus solved for 10 pevs in one group .",
    "this number is chosen according to the numerical efficiency of the solver .",
    "the parameters of the nominal battery model @xmath11 for each group are chosen as the average values of the group .",
    "for those groups having the same minimum arrival time and maximum departure time , we take the average values between them and approximate their flexibilities using the same nominal model . for example , by setting the elements in the charging matrix @xmath75 by their maximum values , the upper charging limits @xmath144 for the nominal battery model are calculated as the column averages of @xmath75 .",
    "since these groups share the same nominal model , their approximated aggregated flexibilities can be calculated very easily based on lemma  [ lem : mksksumscale ] . in our simulation , after the first stage , the 100 groups are merged into 22 collections which are represented by polytopes of different codimensions",
    ". then we repeat the process in the first stage to approximate the flexibility of these 22 collections , where each time we aggregate 11 collections .",
    "finally a sufficient battery model @xmath198 is obtained for the characterization of the aggregate flexibility of the entire loads group .",
    "the dynamic charging limits of the obtained battery model are illustrated in fig .",
    "[ fig : bounds ] .",
    "the total charging energy bounds are obtained as @xmath199 mwh and @xmath200 mwh , which lies in the true aggregate energy consumption interval @xmath201 $ ] mwh . from fig .",
    "[ fig : bounds ] , we can see that around the midnight ( the @xmath202 hour ) , the charging flexibility of the pevs are the largest in terms of the difference of the charging rate bounds . denoting the energy price by @xmath203 , and the planned energy by @xmath204 , the energy arbitrage problem can be formulated as a linear programming problem as follows , @xmath205    clearly , the above optimization problem can be solved much more efficiently than directly optimizing the power profiles subject to the constraints of 1000 pevs .",
    "we plot the obtained power profiles against the price changes in fig .",
    "[ fig : planing ] .",
    "it can be observed that most of the energy demand are consumed during @xmath206  @xmath207 to @xmath208  @xmath209 in the morning , when the prices are at its lowest .",
    "the same curve of the planned power is also plotted in fig .  [",
    "fig : bounds ] ( the dotted line ) , where note we assume that the time discretization unit is @xmath210 hour .",
    "we see that the planned charging rate lies in the charging bounds of @xmath198 , and almost always matches the maximum / minimum bound . using this charging profile ,",
    "the total energy being charged to the pevs is @xmath211 mwh which lies in the interval @xmath212 .",
    "hence , it is adequate and the charging requirement of individual pev can be guaranteed by using the scheduling policy ( [ eq : schdplcy ] ) .",
    "we choose the immediate charging policy as the baseline and use it to compare with the obtained optimal charging profile in fig .",
    "[ fig : bounds ] . to ensure a fair comparison",
    ", we impose an additional constraint that the total energies consumed by both profiles are the same .",
    "the total energy cost for the baseline charging profile is @xmath213 , while the cost for the optimal charging profile is @xmath214 , which reduces the baseline cost by about @xmath215 .",
    "this paper proposed a novel polytopic projection approximation method for extracting the aggregate flexibility of a group of heterogeneous deferrable loads .",
    "the aggregate flexibility of the entire load group could be extracted parallelly and in multiple stages by solving a number of linear programming problems .",
    "the scheduling policy for individual load was simultaneously derived from the aggregation process .",
    "finally , a pev energy arbitrage problem was solved to demonstrate the effectiveness of our approach at characterizing the feasible aggregate power flexibility set , and facilitating finding the optimal power profile .",
    "our future work includes studying the performances of using other decision rules such as the quadratic decision rule and the nonlinear decision rule , and as compared to the method using zonotopes .",
    "in addition , it is interesting to consider a probabilistic description of the aggregate flexibility as in practice the uncertainty of the loads parameters must be considered to reduce the risk of over - estimating or under - estimating the aggregated flexibility .      for the sake of completeness , we restate the following version of farkas s lemma as used in  @xcite , which will be used to derive our algorithm for approximating the polytopic projection . its proof can be found in  @xcite .",
    "[ lem : farkas](farkas lemma ) suppose that the system of inequalities @xmath216 @xmath217 has a solution and that every solution satisfies @xmath218 @xmath219 .",
    "then there exists @xmath220 , @xmath221 , such that @xmath222 and @xmath223 .",
    "\\(1 ) sufficient battery : since @xmath224 is the solution of the app problem , we have @xmath225 , where @xmath226 and @xmath227 .",
    "let @xmath228 and it can be shown that , @xmath229 where @xmath230 , and the last equality is derived by using lemma  [ lem : mksksumscale ] . since @xmath231",
    "we see @xmath198 is sufficient .",
    "now suppose @xmath232 , then @xmath233 .",
    "denoting @xmath11 by its facet representation , we have @xmath234 , where @xmath235^{t},\\\\ h= & ( \\bar{u},-\\underline{u},\\bar{e},-\\underline{e}),\\end{aligned}\\ ] ] and then parameters of @xmath198 can be obtained from @xmath236",
    "\\(2 ) scheduling policy : given a generation profile @xmath21 in @xmath198 , we can decompose it into the individual admissible power profile @xmath166 through two steps .",
    "first , we decompose it into the generation profiles for each groups : @xmath237 , by part ( 1 ) we know @xmath238 and further more @xmath239    denoting the generation profile for the @xmath173 group by @xmath240 and hence , @xmath241 which is the aggregate flexibility extracted from the @xmath173 group .",
    "it can be further decomposed into each pevs in the @xmath173 group .",
    "now we need to use the linear decision rule in ( [ eq : decision ] ) .",
    "note that the decision rule ( [ eq : decision ] ) is applied in ( [ eq : oppapp ] ) which actually maps from @xmath11 to @xmath242 , while the decomposition mapping we need is actually from @xmath243 to @xmath244 .",
    "the mappings between these four polytopes form a commutative diagram ( see below ) .",
    "observe that the linear ratio of the decomposition mapping does not change , and only the translate vector needs to be calculated .",
    "therefore , assume that the decomposition takes the form @xmath245 where @xmath246 is the translate vector to be determined .        from the above commutative diagram , we must have @xmath247 , @xmath248 solve the above equality and we will have @xmath249 and the overall scheduling policy ( [ eq : schdplcy ] ) follows from the composition of @xmath250 and @xmath251 .",
    "j.  bhatt , v.  shah , and o.  jani , `` an instrumentation engineer s review on smart grid : critical applications and parameters , '' _ renewable and sustainable energy reviews _ , vol .",
    "12171239 , dec . 2014 .",
    "d.  s. callaway , `` tapping the energy storage potential in electric loads to deliver load following and regulation with application to wind energy , '' _ energy conversion and management _ , vol .",
    "50 , no .  5 , pp .",
    "1389 1400 , may 2009 .",
    "m.  henk , j.  richter - gebert , and g.  m. ziegler , `` basic properties of convex polytopes , '' in _ handbook of discrete and computational geometry _",
    ", j.  e. goodman and j.  orourke , eds.1em plus 0.5em minus 0.4emboca raton , fl , usa : crc press , inc . , 1997 , ch .",
    "243270 .",
    "d.  hershkowitz , a.  j. hoffman , and h.  schneider , `` on the existence of sequences and matrices with prescribed partial sums of elements , '' _ linear algebra and its applications _ , vol .",
    "265 , pp . 7192 ,",
    "m.  kamgarpour , c.  ellen , s.  soudjani , s.  gerwinn , j.  mathieu , n.  mullner , a.  abate , d.  callaway , m.  franzle , and j.  lygeros , `` modeling options for demand side participation of thermostatically controlled loads , '' in _ bulk power system dynamics and control - ix optimization , security and control of the emerging power grid , irep symposium _ , aug .",
    "2013 , pp . 115 .",
    "s.  koch , j.  mathieu , and d.  callaway , `` modeling and control of aggregated heterogeneous thermostatically controlled loads for ancillary services , '' in _",
    "17th power system computation conference _ , stockholm , sweden , august 2011 .",
    "j.  liu , s.  li , w.  zhang , j.  l. mathieu , and g.  rizzoni , `` planning and control of electric vehicles using dynamic energy capacity models , '' in _ the 52nd ieee annual conference on decision and control _ , dec .",
    "2013 , pp . 379384 .",
    "a.  nayyar , j.  taylor , a.  subramanian , k.  poolla , and p.  varaiya , `` aggregate flexibility of a collection of loads , '' in _ the 52nd ieee annual conference on decision and control _ , dec .",
    "2013 , pp . 56005607 ."
  ],
  "abstract_text": [
    "<S> aggregation of a large number of responsive loads presents great power flexibility for demand response . an effective control and coordination scheme of flexible loads requires an accurate and tractable model that captures their aggregate flexibility . </S>",
    "<S> this paper proposes a novel approach to extract the aggregate flexibility of deferrable loads with heterogeneous parameters using polytopic projection approximation . </S>",
    "<S> first , an exact characterization of their aggregate flexibility is derived analytically , which in general contains exponentially many inequality constraints with respect to the number of loads . in order to have a tractable solution </S>",
    "<S> , we develop a numerical algorithm that gives a sufficient approximation of the exact aggregate flexibility . </S>",
    "<S> geometrically , the flexibility of each individual load is a polytope , and their aggregation is the minkowski sum of these polytopes . </S>",
    "<S> our method originates from an alternative interpretation of the minkowski sum as projection . </S>",
    "<S> the aggregate flexibility can be viewed as the projection of a high - dimensional polytope onto the subspace representing the aggregate power . </S>",
    "<S> we formulate a robust optimization problem to optimally approximate the polytopic projection with respect to the homothet of a given polytope . to enable efficient and parallel computation of the aggregate flexibility for a large number of loads , a muti - stage aggregation strategy is proposed . </S>",
    "<S> the scheduling policy for individual loads is also derived . </S>",
    "<S> finally , an energy arbitrage problem is solved to demonstrate the effectiveness of the proposed method . </S>"
  ]
}