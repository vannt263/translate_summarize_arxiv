{
  "article_text": [
    "providing a quantitative description of non - equilibrium dynamics of bose - einstein condensates ( becs ) at finite temperature is an ongoing challenge @xcite .",
    "classical field methods have been a popular tool to describe finite temperature becs , utilizing the tractability of the gross - pitaevskii equation ( gpe ) to simulate the dynamics of many highly occupied modes of the system @xcite .",
    "these highly occupied _ coherent _ modes are treated with a classical field approximation , enabling the dynamics of these modes to be treated nonperturbatively .",
    "these methods have been used to treat of both equilibrium and non - equilibrium systems in a range of finite temperature systems @xcite .    introducing coupling between the coherent region and the remaining _ incoherent _ reservoir results in a stochastic gpe , which includes damping and noise terms from the reservoir interaction .",
    "such a description has been derived microscopically @xcite , allowing for these methods to provide an ab initio description of non - equilibrium dynamics .",
    "there are now numerous examples in the literature of the application of stochastic gpes to a range of systems , including vortex decay @xcite , soliton decay @xcite , defect formation across phase transitions @xcite , spinor condensates @xcite , polariton condensates @xcite , equilibrium properties @xcite , and low dimensional systems @xcite .",
    "currently , most applications of stochastic gpes have only included growth processes , where collisions between two incoherent region atoms lead to a change in population of the coherent region .",
    "the damping term that arises from this process is similar to that of the damped gpe @xcite , and is relatively simple to implement numerically . in the stochastic projected gpe ( spgpe ) of gardiner _",
    "_ there are scattering reservoir processes , where a collision between coherent and incoherent atoms results in energy change with no population transfer .",
    "these scattering terms have been recently implemented in ref .",
    "@xcite , showing a dominant effect on highly non - equilibirum dynamics .    in this paper",
    ", we present a numerical method for evolving the spgpe , including the scattering terms . numerically solving the spgpe involves two major technical challenges : ( i ) all moderately occupied coherent modes play an important role in finite temperature non - equilibrium dynamics . thus all modes beneath a well - chosen cutoff must be propagated accurately .",
    "( ii ) the deterministic term arising from the reservoir interaction is non - local , while the noise is multiplicative and spatially correlated .",
    "thus accurately and efficiently implementing the scattering terms is a challenge .",
    "previous work has shown how a spectral approach @xcite can be used within the pgpe formalism to precisely implement the energy cutoff , and provide a means for accurate evolution of all low energy coherent modes for a bose gas with both contact @xcite and dipolar interactions @xcite . in this work",
    "we extend these methods for the pgpe , providing a numerical method for evolving the full spgpe that evaluates the scattering terms , while still propagating all coherent modes accurately .",
    "we thus give a complete spectral - galerkin method for the spgpe .",
    "this paper is organized as follows : in the rest of this section we briefly review the spgpe formalism . in sec .",
    "[ sec : formalalgorithm ] we outline our spectral approach , and outline the equations for the mode amplitudes we need to evaluate to solve the spgpe . in sec .",
    "[ matrixelements ] we present our algorithm for evaluating the scattering terms using a gauss - hermite quadrature approach . in sec .",
    "[ accuracy ] we characterize the accuracy of our approach , with results demonstrating the convergence with quadrature grid size and evolution time step size .",
    "we present an example of the usage of the spgpe , showing the evolution of a random initial state to equilibrium .",
    "we briefly outline the key formalism of the spgpe relevant to our work ( see refs .",
    "@xcite for full details ) .",
    "here we consider a system of bosons confined in a three - dimensional trapping potential , described by the dimensionless single - particle hamiltonian @xmath0 where @xmath1 , and @xmath2 is the dominant contribution to the single particle hamiltonian and defines our c - field basis , any time dependent perturbation potential is included in @xmath3 , and @xmath4 is the relative trap frequency in each direction @xmath5 .",
    "note that we work in dimensionless units throughout this paper , using harmonic oscillator units of length @xmath6 , energy @xmath7 , and time @xmath8 , where @xmath9 is the particle mass , and @xmath10 is a chosen reference frequency .",
    "in our c - field approach we divide the modes of our system into two subspaces according to their occupation , which we refer to as the _ coherent _ ( * c * ) and _ incoherent _ ( * i * ) regions @xcite .",
    "the low energy * c *  region contains highly occupied modes , which are dominated by classical fluctuations . in this case , we may use a classical field approximation to treat these highly occupied modes @xcite .",
    "the remaining * i *  region contains sparsely occupied modes , and plays the role of a thermal reservoir .",
    "the spgpe is a stochastic equation of motion for the * c*-field , which accounts for the reservoir interactions from the * i *  region . treating the * i *  region semi - classically and assuming spatially constant reservoir interaction rates @xcite , the evolution equation is given in stratonovich ( s ) form by @xcite @xmath11 with @xmath12 where the evolution of the c - field is formally restricted to the * c *  region by the projector operator @xmath13 where @xmath14 are eigenstates of the single - particle hamiltonian satisfying @xmath15 , and the summation includes all modes the * c *  region defined as @xmath16 where @xmath17 is the single - particle energy cutoff defining the * c *  region .",
    "the first term of the spgpe ( [ spgpeh ] ) describes the hamiltonian evolution , where @xmath18 is the hamiltonian evolution operator for the * c *  region , where the dimensionless nonlinearity constant is @xmath19 , where @xmath20 is the s - wave scattering length . on its own eq .",
    "( [ spgpeh ] ) is the pgpe , a nonlinear schrndiger equation for the * c*-field as an isolated microcanonical system @xcite .",
    "the remaining terms in the spgpe account for distinct reservoir interactions .",
    "( [ spgpeg ] ) describes the growth reservoir interaction , where two * i*-region atoms collide leading to population growth of the * c*-region .",
    "the rate of this process is set by @xmath21 @xcite , and the gaussian complex noise has the non - vanishing correlation @xmath22 where @xmath23 is a delta function in the * c *  region .",
    "( [ spgpee ] ) describes the number conserving scattering reservoir interaction where energy and momentum are transferred between the * c *  and * i *  regions , without population transfer .",
    "this process is described by the effective potential @xmath24 where @xmath25 , the * c*-field current is @xmath26 and @xmath27 the real scattering noise @xmath28 has the non - zero correlation @xmath29 where the correlation is anti - diagonal in @xmath30-space so can be easily sampled numerically [ see sec .",
    "[ sec : noise ] ] .      by neglecting the growth terms in the spgpe ( [ spgpe ] ) ,",
    "we arrive at the scattering spgpe @xmath31 in this work we are concerned with developing a method for evaluating the terms involved with the scattering processes . since including the growth terms is a relatively simple extension of the pgpe algorithm @xcite , we will consider only the scattering spgpe only from here onwards .",
    "we use the single - particle eigenstates as our spectral basis , so we write the c - field as @xmath32 where @xmath33 are time dependent complex amplitudes and @xmath34 represents all quantum numbers required to specify a single - particle state .",
    "this choice is convenient because it allows us to efficiently implement the projection by restricting the spectral modes [ as indicated in eq .",
    "( [ cfsumdmls ] ) ] to the set indicated in eq .",
    "( [ sumrestrict ] ) defining the * c *  region .",
    "we exploit that @xmath35 is diagonal in the spectral basis and use a galerkin approach @xcite , where we project the scattering spgpe ( [ scattspgpe ] ) onto the spectral basis .",
    "this leads to a system of equations for the evolution of the amplitudes , i.e. @xmath36 dt + db_n,\\label{dcn}\\ ] ] where @xmath37 are the nonlinear matrix elements of the two - body interaction , scattering effective potential , and scattering noise terms respectively .",
    "we introduce the functions @xmath38 later [ see sec .  [",
    "sec : noise_matrixelements ] ] , and @xmath39 is the standard real wiener process satisfying @xmath40    there are two main steps in solving this equation : ( i ) time - evolution to step this equation forward in time [ see sec .",
    "[ stochevo ] ] ; and ( ii ) evaluating the non - linear matrix elements ( [ gn])-([bnm ] ) at each time step [ see sec .",
    "[ matrixelements ] ] .",
    "because the noise associated with the scattering reservoir interaction is multiplicative , we use the _ weak vector semi - implicit euler algorithm _ @xcite to evolve our stochastic equations forward in time . as this algorithm",
    "is extensively discussed in the literature we briefly review the algorithm here .",
    "equation ( [ dcn ] ) is of the general form @xmath41 where @xmath42 $ ] , we use the notation @xmath43 to represent the dependence of matrix elements on the full field ( @xmath44 ) , and the noise matrix elements depends on the wiener process @xmath39 .",
    "the solution is propagated to a set of discrete times @xmath45 , where @xmath46 is the step size , and we denote that solution at time @xmath47 as @xmath48 . using this solution , the solution at the next time - step is computed as @xmath49 , where @xmath50 with @xmath51 note formally @xmath52 , however in practice we sample @xmath53 as a real gaussian distributed random variable of variance @xmath46 [ c.f .",
    "( [ deltaw ] ) ] .",
    "here we give a full description of our algorithm to efficiently and accurately evaluate the scattering spgpe matrix elements in the harmonic oscillator basis .",
    "this expands on the brief overview of our method presented in ref .",
    "@xcite .",
    "we firstly discuss some important properties of our single - particle basis used in this work .",
    "the eigenstates of the basis hamiltonian ( @xmath35 ) are separable into one dimensional basis states , that is , @xmath54 where @xmath55 are eigenstates of the dimensionless 1d harmonic - oscillator hamiltonian @xmath56   \\phi^{\\lambda_x}_\\alpha ( x ) =   \\varepsilon_\\alpha   \\phi^{\\lambda_x}_\\alpha ( x),\\ ] ] where the harmonic - oscillator states take the form @xmath57 where the normalization constant is @xmath58^{-1/2}$ ] , and @xmath59 is a hermite polynomial of degree @xmath60 , defined by the recurrence relation @xmath61 with @xmath62 and @xmath63 .",
    "the eigenvalue is the single - particle energy given by @xmath64 , where @xmath60 is a non - negative integer ( we use greek subscripts to denote 1d eigenstates ) .",
    "the * c *  region is defined by the region containing all modes below the single - particle energy cutoff @xmath65 so that within the * c *  region there exist @xmath66 distinct 1d eigenstates in each direction , and @xmath67 total 3d basis states in the * c *  region .    for this work",
    "we will consider a spherically symmetric system ( @xmath68 ) , to avoid cumbersome notation involving @xmath69 .",
    "however the work presented in this paper can be easily generalized for any trap anisotropy , by retaining the general form of eq .",
    "( [ basisstates ] ) .",
    "thus we drop any reference to @xmath69 , and consider a system with @xmath70 modes in the * c *  region in each direction .",
    "step operators allow us to represent certain operators _ exactly _ in the spectral basis .",
    "the step operators are defined as @xmath71 we then find that the matrix representation of the step operators in the spectral basis is @xmath72 and similarly , @xmath73 for our purposes , this allows us to differentiate in the spectral basis exactly , since @xmath74 this 1d procedure is applied in the same manner to include @xmath75 and @xmath76 .",
    "it is important that we can apply the derivative operator exactly in the spectral basis , since we need to evaluate the c - field current ( [ current ] ) to evaluate the scattering effective potential term .    for a further discussion on the use of step operators to calculate observables , see ref .",
    "@xcite .      here",
    "we briefly review our scheme for numerically integrating the nonlinear contact interaction term ( [ gn ] ) using gauss - hermite quadrature , which is described in complete detail in ref .",
    "this algorithm calculates the nonlinear interaction term exactly for a harmonically trapped system , and is required to integrate the scattering spgpe ( [ scattspgpe ] ) .",
    "firstly , using ( [ cfsumdmls ] ) and the form of the basis states ( [ basisstates ] ) , we can write the c - field as @xmath77 where @xmath78 is a polynomial of maximum degree @xmath79 in each independent coordinate due to the energy cutoff .",
    "the interaction term ( [ gn ] ) is forth order in the field , so we can write it in the form @xmath80 where @xmath81 is a polynomial of maximum degree @xmath82 in each coordinate .",
    "we evaluate ( [ gnpoly ] ) using gauss - hermite quadrature .",
    "the general form of the @xmath83 point quadrature rule is @xmath84 where @xmath85 is a gaussian weight function , and @xmath86 and @xmath87 are the quadrature weights and roots . the gauss - hermite quadrature is exact if @xmath88 is a polynomial of maximum degree @xmath89 .",
    "since the exponential in ( [ gnpoly ] ) takes the form of the appropriate weight function for gauss - hermite quadrature , we can evaluate the interaction matrix element _ exactly _ by @xmath90 using a three - dimensional spatial grid with @xmath91 points in each direction , where the @xmath92 and @xmath93 are the @xmath91 roots and weights of the one - dimensional gauss - hermite quadrature with weight function @xmath94 .      to compute the effective potential matrix elements ( [ bnm ] ) ,",
    "we adapt the scheme developed for evaluating the dipolar interaction term in the pgpe  @xcite . here",
    "the calculation involves the fourier transform of the current ( [ current ] ) , whose momentum space form is then fourier transformed to form the effective potential ( [ ve ] ) . as we are using a nonuniform quadrature grid to represent the c - field , we follow ref .",
    "@xcite in using an auxiliary harmonic - oscillator basis to perform the fourier transforms .",
    "firstly we calculate the c - field current density ( [ current ] ) by @xmath95 where the index @xmath96 represents each spatial dimension with corresponding unit vector @xmath97 , and @xmath98 where eq .",
    "( [ current_component ] ) can be calculated exactly using step operators [ see section [ stepops ] ] . now using similar arguments to section [ interactionterm ]",
    ", each component of the current can be written in the form @xmath99 where @xmath100 is polynomial of maximum degree @xmath91 in each coordinate ( due to the projector ) .",
    "following ref .",
    "@xcite , we introduce a set of auxiliary harmonic - oscillator states , @xmath101 where the exponential argument is chosen to match eq .",
    "( [ jpoly ] ) .",
    "these states are eigenstates of the harmonic oscillator hamiltonian , with a trapping potential twice as tight as that defining the spectral basis ( [ ho1d ] ) . noting this , the auxiliary states are related to the spectral basis modes by @xmath102 .    due to the same exponential factor",
    ", we can represent each component of the current [ i.e. ( [ current_component ] ) ] as @xmath103 where @xmath104 is a set of @xmath105 auxiliary basis coefficients for each component of @xmath106 .",
    "since the auxiliary oscillator states form an orthonormal basis , we can evaluate these basis coefficients by @xmath107 where @xmath108 is a polynomial of maximum degree @xmath109 in each spatial dimension .",
    "we can use the same gauss - hermite quadrature to integrate ( [ dspectral ] ) as we used for the nonlinear interaction term ( [ gnpoly ] ) , as the weight function and maximum polynomial degree are both @xmath110 .",
    "thus eq .",
    "( [ dspectral ] ) can be calculated exactly for each component of the current , by @xmath111 where the quadrature roots @xmath92 , and weights @xmath93 , are the same as used in ( [ gnquad ] ) .",
    "to evaluate the effective potential ( [ ve ] ) , we must fourier transform each component of the current .",
    "since the harmonic - oscillator states are eigenstates of the fourier transform operator , @xmath112 we can efficiently evaluate the fourier transform with knowledge of auxiliary basis amplitudes of the current @xmath113 by @xmath114 thus ( [ jknumeric ] ) will represent the fourier transform of the current on the quadrature grid exactly .",
    "we can now evaluate the scattering effective potential term ( [ ve ] ) by evaluating @xmath115 and computing the inverse fourier transform of eq .",
    "( [ jkint ] ) . to compute the inverse fourier transform",
    ", we expand @xmath116 in the auxiliary basis @xmath117 where @xmath118 we integrate ( [ fbasis ] ) using a gauss - hermite quadrature , via @xmath119 where @xmath120 here the quadrature roots @xmath121 and weights @xmath122 are found from the weight function @xmath123 .",
    "since in general @xmath124 can not be represented exactly in the oscillator basis , our quadrature rule ( [ fbasis ] ) , and thus eq .  ( [ vmaux ] ) , are approximations .",
    "hence the number of @xmath30-grid quadrature points required is somewhat arbitrary [ see sec .  [ kspace_grids ] ] .",
    "we investigate how the accuracy of the scattering matrix element depends on the number of quadrature points in sec .",
    "[ accuracy ] .    from the form of eq .",
    "( [ vmaux ] ) , we see that the effective potential matrix elements we require ( [ sn ] ) are of the form @xmath125 where @xmath126 where @xmath127 represents the _ c_-field and is given by eq .",
    "( [ qpoly ] ) .",
    "although our expression for @xmath128 is approximate , once in this form , @xmath129 takes the form of a polynomial of degree @xmath130 in each coordinate .",
    "thus we can integrate eq .",
    "( [ sint ] ) exactly using the same gauss - hermite quadrature sum as for eq .",
    "( [ gnquad ] ) , i.e. using a three - dimensional spatial grid with @xmath91 points in each direction , where the @xmath92 and @xmath93 are the @xmath91 roots and weights corresponding to the weight function @xmath131 .",
    "a noise with the necessary correlations ( [ scattnoisecorr ] ) can be constructed as @xmath132 here we have made use of the fourier transformed modes @xmath133 .",
    "the phase factors arising in fourier transforming the modes generates the antidiagonal delta - function we require , since @xmath134 where we have used eq .",
    "( [ deltafuncc ] ) .      to implement the noise in our galerkin approach",
    ", we need to evaluate the matrix elements corresponding to eq .",
    "( [ bnm ] ) .",
    "this means we need to project the noise in position space onto our spectral basis . since numerically we form the correct scattering noise correlation in fourier space [ see eq .",
    "( [ noiseexp ] ) ] , we need to compute @xmath135 where the @xmath136 are real gaussian distributed random variables [ see eq .",
    "( [ dw1])-([dw2 ] ) ] , and where @xmath137 where @xmath138 where the @xmath139 are the fourier transformed basis states .",
    "thus to evaluate the scattering noise matrix elements ( [ bnm ] ) , we must apply @xmath140 to the gaussian distributed random variables .",
    "we now outline how we evaluate the scattering noise matrix elements .",
    "firstly , we can represent eq .",
    "( [ theta_noise ] ) in the form @xmath141 where @xmath142 in order to compute the inverse fourier transform of eq .",
    "( [ dwe_spec ] ) to form @xmath143 , we use a similar process as in sec .",
    "[ sec : algorithm_scattpot ] . here",
    "we do not need to use the auxiliary basis states necessary for computing @xmath144 , since the exponential term in eq .",
    "( [ dwe_spec ] ) matches that of the standard basis states .",
    "thus , we can calculate @xmath145 using the expansion of @xmath145 in the standard spectral basis @xmath146 where @xmath147 eq .",
    "( [ zeta_sum ] ) is approximate [ c.f .",
    "( [ vmaux ] ) ] since we can not represent @xmath148 as a polynomial .",
    "we evaluate the integral using a gauss - hermite quadrature    @xmath149 where @xmath150 where the quadrature roots @xmath151 and weights @xmath152 correspond to the weight function @xmath153 .",
    "since our gauss - hermite quadrature is approximate , the number of @xmath30 points is again somewhat arbitrary here .",
    "see sec .",
    "[ accuracy ] for further discussion .    finally ,",
    "since the matrix elements we require ( [ bnm ] ) are third order in the field , they can be cast in the form @xmath154 where @xmath155 where @xmath127 represents the c - field and is given by eq .",
    "( [ qpoly ] ) , so @xmath156 is a polynomial of degree @xmath157 in each coordinate .",
    "thus we can evaluate eq .",
    "( [ bnmintegral ] ) using a gauss - hermite quadrature @xmath158 this quadrature is exact using a three - dimensional grid with @xmath159 quadrature points in each coordinate , where the grid points @xmath160 and quadrature weights @xmath161 correspond to the weight function @xmath162 .      here",
    "we give a summary of our algorithm for calculating the scattering spgpe matrix elements .",
    "we split our summary into two sections , first dealing with the deterministic terms followed by the noise term .",
    "for each euler step , the procedure for calculating these matrix elements is as follows :    * we firstly transform the c - field from the spectral to spatial representation via @xmath165 where @xmath166 , @xmath167 are the quadrature points associated with the weight function @xmath110 , and @xmath168 are the precomputed transformation matrices .",
    "these are the one - dimensional basis states evaluated at the quadrature grid points @xmath169 * differentiate the field + @xmath170 + where the derivative operators are given by eq .",
    "( [ eq : diff_basis ] ) , and the @xmath171 are the identity operators . * transform the differentiated fields to position space + @xmath172 + so we can then form the position space current current via eq .",
    "( [ currentsum ] ) , where we have @xmath173 .\\end{aligned}\\ ] ] * the weighted position space current is constructed for each component of @xmath174 + @xmath175 + where @xmath176 are the quadrature weights associated with the weight function @xmath110 . * we compute the fourier transform of each component of the current by + @xmath177 + here the precomputed transformation matrix is @xmath178 where the @xmath30-space quadrature grid is based on the weight function @xmath179 . eq .",
    "( [ wtransf ] ) combines both steps of the fourier transform into one operation [ @xmath180 , and @xmath181 . * in fourier space we form the projection of the current onto @xmath182 .",
    "we then premultiply with the quadrature weights to form @xmath183 * inverse transforming takes us back to position space . and computes the effective potential @xmath184 : @xmath185 * we combine the two - body interaction and scattering effective potential terms into a single integrand ( since the quadrature sum has the same weight function for both cases ) , @xmath186\\psi({\\mathbf{x}}_{\\bm s } )    \\label{fintegrand } .",
    "\\end{aligned}\\ ] ] * inverse transforming @xmath187 completes the integration of eq .",
    "( [ gn ] ) and eq .",
    "( [ sn ] ) , giving the required matrix elements @xmath188",
    "to implement the noise , we generate @xmath190 at the start of each euler step . then for each iteration of eq .",
    "( [ sie ] ) , we perform the following steps :    * we transform the random variables to fourier space via @xmath191 where the precomputed transformation matrices are the fourier transformed basis states @xmath192 where the tilde notation implies the @xmath30-space quadrature grid is based on the weight function @xmath193 .",
    "* we form the appropriate correlation function in @xmath30-space , and then compute the inverse fourier transform : @xmath194 where @xmath195 where the hat notation implies the position space quadrature grid is based on the weight function @xmath162 . *",
    "we now need to transform the _",
    "c_-field to position space , onto the grid based on the three - field weight function : @xmath196 where now the precomputed transformation matrices are @xmath197 * we form the appropriate integrand of @xmath189 , @xmath198 * the inverse transform of @xmath199 completes the required integration @xmath200",
    "in this section , we discuss how we can control the accuracy of our algorithm , and quantify the accuracy of our approach of both spatial and temporal integration using various measures .",
    "both the deterministic and noise terms involve @xmath30-space integrals which are evaluated as approximate quadrature sums [ evaluating eq .",
    "( [ phielement ] ) , and eq .  ( [ fnoise ] ) respectively ] . to control the accuracy of these steps , we can vary the size of the appropriate @xmath30-space quadrature grid .    for a given @xmath17 , the transform to momentum space",
    "is exactly invertible @xmath201 $ ] if the quadrature grid sizes are chosen by @xmath202 , @xmath203 , where @xmath204 .",
    "we choose an even number of @xmath30-grid points to avoid a quadrature point at @xmath205 where both the deterministic and noise terms are singular .",
    "to investigate the effect of the @xmath30-grid on the accuracy of our method , we vary the number of @xmath30 quadrature points used by @xmath206 where @xmath207 is the total number of quadrature grid points , and @xmath208 is the number of quadrature points added to the reference value @xmath209 .",
    "( [ kquadgridcheck_pot ] ) refers to the number of quadrature points used to evaluate the deterministic term , i.e. the quadrature points are based on the weight function @xmath123 [ see eq .",
    "( [ tquad ] ) ] .",
    "( [ kquadgridcheck_noise ] ) refers to the quadrature grid for evaluating the noise term , i.e. the quadrature points are based on the weight function @xmath210 [ see eq .",
    "( [ upoly ] ) ] . for the remainder of this section",
    "we associate @xmath208 and @xmath211 with the quadrature grid for the deterministic and noise terms respectively .",
    "a gaussian wave function undergoing radial breathing provides a rare example where we can analytically calculate @xmath128 for a case where @xmath212 .",
    "here we consider the gaussian wave function @xmath213 which corresponds to a radial breathing oscillation .",
    "this wave function has a non - zero current density , given by @xmath214 from which we find [ using eq .",
    "( [ ve ] ) ] the radially symmetric potential @xmath215 where @xmath216,\\ ] ] with @xmath217 .",
    "the potential is most significant at @xmath218 , where @xmath219 to quantify the accuracy of our numerical evaluation of @xmath128 , we use the relative error measure @xmath220 in fig .  [",
    "fig : errorve ] we plot @xmath221 as a function of @xmath208 , for the gaussian wave function [ eq .  ( [ gausswf ] ) ] , with @xmath222 and @xmath223 .",
    "we show the relative error for @xmath184 evaluated with @xmath224 and @xmath225 , corresponding to @xmath226 and @xmath227 respectively . in both cases",
    "@xmath221 rapidly converges with @xmath208 .",
    "we see that in general our algorithm does not become increasingly accurate with @xmath208 , with no gain in accuracy for @xmath228 .",
    "however in general we see good accuracy , with @xmath229 for all @xmath208 .     with varying @xmath208",
    "[ see ( [ delta_ve ] ) ] , for a gaussian wave function with @xmath230 . @xmath224 @xmath225 .",
    "the two curves correspond to @xmath224 ( red squares ) , and @xmath225 ( blue circles ) . ]      here we test the accuracy of calculating the matrix elements [ eqs .",
    "( [ gn])-([bnm ] ) ] for a randomized state @xmath231 .",
    "a high energy randomized state will test the accuracy of both low energy modes and modes near the cutoff , thus will be a useful test for the suitability of our algorithm to finite temperature non - equilibrium dynamics .",
    "we use a random state of the form @xmath232 where @xmath233 and @xmath234 , are normally distributed gaussian random variables with zero mean and unit variance . for the results in this section , we use a cutoff of @xmath224 so @xmath226 .",
    "we renormalize our initial field so that @xmath235 , and use scattering reservoir parameters of @xmath236 .",
    "we first consider @xmath237 , the scattering potential matrix elements given by eq .",
    "( [ sn ] ) . to test the accuracy of our method",
    "we calculate the relative error of the matrix elements , given by @xmath238 where @xmath239 is the scattering matrix element calculated with a @xmath30-space quadrature grid specified by @xmath208 , and @xmath240 is a more accurate matrix element calculation . we calculate @xmath241 using a @xmath30-space quadrature grid with @xmath242 quadrature points .    in fig .",
    "[ fig : snbnconv ] we show @xmath243 for some representative cases of @xmath244 .",
    "we see @xmath245 is smaller for lower - order matrix elements .",
    "in general , @xmath245 decreases with @xmath208 for all basis coefficients .",
    "( or @xmath211 ) is varied .",
    "the error in the scattering potential matrix elements @xmath243 ( red squares ) , and scattering noise matrix elements @xmath246 ( blue circles ) , are shown for various single - particle basis states .",
    "all cases correspond to @xmath224 . ]",
    "we now test the accuracy of the scattering noise matrix elements @xmath247 [ see eq .",
    "( [ bnm ] ) ] . here",
    "we quantify the error with the measure @xmath248 where @xmath249 are the scattering noise matrix elements calculated with a @xmath30-space quadrature grid specified by @xmath211 , where the quadrature weight function is that appropriate to the noise term . here",
    "the reference @xmath250 is calculated using a @xmath30-space quadrature grid with @xmath251 points .    in fig .",
    "[ fig : snbnconv ] we plot @xmath246 for various @xmath244 , finding a smaller error with increasing grid size .",
    "the noise term is generally less accurate than the deterministic term , with @xmath252 over an order of magnitude larger than @xmath245 for low - order matrix elements . for higher - order matrix elements",
    ", it becomes hard to distinguish between the accuracy of the noise and deterministic term , with both having a similar error .    ) ] , for @xmath224 ( red squares ) and @xmath225 ( blue circles ) .",
    "top : @xmath253 , showing the effect of the @xmath30-space quadrature grid corresponding to the potential term , with @xmath254 .",
    "bottom : @xmath255 , showing the effect of the @xmath30-space quadrature grid corresponding to the noise term , with @xmath256 .",
    "]      finally we consider the combination of all nonlinear matrix elements , @xmath257 .",
    "to evaluate @xmath258 , we use a nonlinearity constant of @xmath259 .",
    "we use the relative error measure @xmath260 where @xmath261 are the approximate matrix elements calculated by our algorithm , and @xmath262 are more accurately calculated matrix elements .",
    "@xmath263 includes both the deterministic and noise terms from the scattering processes , so we can measure the combined effect of these terms on the accuracy of our algorithm .",
    "since both the deterministic and noise terms have independent quadrature grids which affect the accuracy , we use two different measures of @xmath263 .",
    "we refer to @xmath263 when we determine @xmath264 with a quadrature grid of @xmath242 for the deterministic term , and @xmath254 for the noise term .",
    "secondly , we refer to @xmath265 when we determine @xmath264 with a quadrature grid of @xmath256 for the deterministic term , and @xmath266 for the noise term .",
    "these two different measures allow us to examine the effect each @xmath30-space quadrature grid we employ has on the accuracy of the combined matrix elements .    in fig .",
    "[ fig : fnconv ] we show results for @xmath263 with varying @xmath208 , and @xmath265 with varying @xmath211 .",
    "we see excellent accuracy for all @xmath208 in both measures , with the relative error reducing with increasing grid size in either case .",
    "since @xmath263 is weighted by the size of each matrix element , a large relative error in small matrix elements has only a small effect on @xmath263 .",
    "thus the larger error seen in high energy matrix elements in fig .",
    "[ fig : snbnconv ] has a minimal effect on @xmath263 . for larger @xmath17 we see a smaller error , with little change in the rate of convergence .      in this section we present evolution convergence results for our algorithm for the scattering spgpe . to test the evolution of our algorithm , we propagate an initial random state given by eq .",
    "( [ randinit ] ) , with an energy cutoff of @xmath224 , and we normalize our c - field to @xmath267 @xmath268 atoms , so the nonlinearity constant is @xmath269 .",
    "we choose reservoir parameters of @xmath270 , and evolve our initial state with the scattering spgpe using the semi - implicit euler algorithm for one trap cycle with a final time of @xmath271 .    in the following sections , we will test the accuracy of our evolution by examining the dependence on time step size @xmath46 , and on both @xmath208 and @xmath211 . as the spgpe is a stochastic equation of motion ,",
    "we look at ensemble averages of 500 trajectories for each parameter @xmath272 considered .",
    "we consider a unique initial condition for each trajectory .    ) and energy ( @xmath273 ) convergence with step size @xmath46 . the relative error is determined after @xmath274 , where @xmath46 corresponds to 6400 , 3200 , 1600 , 800 , and 400 time steps in order of increasing @xmath46 .",
    "simulation results ( red squares ) are fitted by the labeled power laws . ]      in this section we consider the case @xmath275 , and examine the convergence with @xmath46 . to quantify our accuracy , we use the following measures : @xmath276 @xmath277 @xmath278 @xmath279 where @xmath280 is the change in normalization , @xmath273 is the relative change in energy , where the c - field energy is given by @xmath281 @xmath282 is the relative change in individual mode amplitudes , and @xmath283 is the relative difference of all mode amplitudes .",
    "quantities with a subscript ` a ' denote that quantity is calculated from a more accurate simulation , and angle brackets represent an ensemble average . since the scattering spgpe is formally number conserving , @xmath280 provides an immediate indication of accuracy without needing a more accurate simulation .    .",
    "@xmath282 represent the error in individual modes [ see eq .",
    "( [ deltac ] ) ] .",
    "@xmath283 represents the error over all * c*-region modes [ see eq .",
    "( [ deltax])].simulation results ( red squares ) are fitted by the labeled power laws . ]    to test the convergence with @xmath46 , we perform 500 simulations with a time step of @xmath284 , i.e. use 12800 steps in the evolution time of 1 trap period ( @xmath271 ) .",
    "simulations with a step size @xmath285 are our accurate simulations for considering the convergence tests .",
    "each simulation with step size @xmath285 has a different random initial condition .",
    "to understand the effects of @xmath46 on convergence we repeat the spgpe simulation for each trajectory using an identical initial state , while reducing the time step size to @xmath286 , for @xmath287 . to test stochastic convergence for each trajectory , we use the identical noise as for the accurate simulation .",
    "the first two measures of numerical accuracy [ ( [ deltan ] ) and ( [ deltae ] ) ] represent measures of weak convergence @xcite .",
    "these two measures show for an ensemble of simulations at a given time step @xmath46 , the difference between the average number and energy , and their more accurate respective value .",
    "[ fig : ne_tconv ] shows @xmath280 and @xmath273 , where we observe good convergence with @xmath46 .",
    "the relative errors are at the level of less than 1% for all time steps considered",
    ".    -space quadrature grid size , for simulations with fixed @xmath288 .",
    "red squares : accuracy with varying @xmath289 for fixed @xmath290 , where the accurate simulations have @xmath291 .",
    "blue circles : accuracy with varying @xmath292 for fixed @xmath293 , where the accurate simulations have @xmath294    the final two measures of error [ ( [ deltac ] ) and ( [ deltax ] ) ] show the root mean squared difference of the mode amplitudes from our simulations with an accurate value . as these are the solutions to the scattering spgpe , these measures determine stochastic convergence in the strong sense @xcite .",
    "@xmath282 shows the relative error in the individual mode amplitudes . in fig .",
    "[ fig : cf_tconv ] we show @xmath282 for the basis - states @xmath295 , and @xmath296 . in all cases",
    "we see convergence faster than @xmath297 , as we reduce @xmath46 .",
    "the error increases for higher - order modes with quite large relative error in the @xmath296 state , which is near the cutoff .",
    "to give an idea of the effect all modes have on the accuracy of a simulation we calculate @xmath283 , which takes into account the relative error of each mode . in fig .",
    "[ fig : cf_tconv ] we see @xmath298 , with accuracy of greater greater than 1% for the smaller time steps .",
    "we see that the larger error in @xmath282 for high energy modes has little effect on @xmath283 , since @xmath283 depends on the size of each element .",
    "figs [ fig : ne_tconv ] and [ fig : cf_tconv ] show that all measures of accuracy converge at least as fast as the strong vector semi - implicit euler method of ref .",
    "@xcite , which converges as @xmath299 with decreasing @xmath46 for both strong and weak measures of convergence . in principle",
    "it is possible to generate higher order algorithms , but this task becomes rapidly complex with increasing desired accuracy , requiring the sampling of many additional auxiliary noise terms  @xcite . here",
    "we find quite fast convergence using the weak semi - implicit euler method , suggesting that the noise is commutative , in which case the strong and weak methods are equivalent .      in this section",
    "we investigate the effect that the @xmath30-space quadrature grid has on the convergence of our algorithm .",
    "we consider the measures @xmath300 , and @xmath283 , for fixed @xmath288 , i.e. 800 integration steps .",
    "for each trajectory ( as described above ) , we evolve the scattering spgpe with the same initial conditions and same noise , while varying @xmath208 and @xmath211 independently .",
    "firstly we consider the case of varying @xmath208 with fixed @xmath254 , where we plot @xmath300 , and @xmath283 calculated after @xmath271 in fig .",
    "[ fig : dnkconv ] ( red squares ) . to calculate these measures of accuracy",
    ", we use an accurate value based on simulations with @xmath291 .",
    "varying @xmath208 has no effect on @xmath280 , while @xmath273 and @xmath283 both converge rapidly .",
    "the case of varying @xmath211 with fixed @xmath256 is shown in fig .",
    "[ fig : dnkconv ] ( blue circles ) , where we see @xmath300 , and @xmath283 behave in a similar manner . in all cases for either varying @xmath208 or @xmath211 ,",
    "the accuracy is very good even for the cases @xmath256 and @xmath301 , consistent with fig .",
    "[ fig : fnconv ] .",
    "the good accuracy for all @xmath30-space quadrature grid sizes shown in fig .  [ fig : dnkconv ] means that increasing @xmath208 or @xmath211 has only a minor benefit on the accuracy of our algorithm for calculating the spgpe matrix elements .",
    "the most significant gains arise from controlling the time step size @xmath46 .",
    "plane ) , for the spgpe evolution of an initial random state with @xmath302 , @xmath303 . the initial random state at @xmath304 evolves into equilibrium , where we show the final state after 10 trap cycles of evolution .",
    "]      having characterized the accuracy of our algorithm , we now look at a practical example of using the spgpe . here",
    "we evolve a random initial state into thermal equilibrium with the spgpe , and examine some thermodynamic quantities which are commonly of interest in c - field calculations .    as in sec .",
    "[ sec : propconv ] we use a randomized initial state for each trajectory given by eq .",
    "( [ randinit ] ) , with normalization @xmath305 @xmath268 atoms , and use an energy cutoff of @xmath224 .",
    "we evolve the scattering spgpe for 10 trap cycles using @xmath306 integration steps per trap cycle , and set @xmath307 . to visualize our simulations , we look at the column density given by @xmath308 in fig .  [",
    "fig : density ] we show the column density and phase ( slice through @xmath309 ) of our initial random state . at @xmath310",
    "once equilibrium has been reached , we see phase coherence has developed over regions of finite c - field density .",
    "fluctuations in the density are caused by both the scattering noise and from fluctuations arising from pgpe evolution , and are characteristic of a finite temperature equilibrium state .    ) and system width ( @xmath311 ) averaged over 100 trajectories , showing the evolution of a random initial state to thermal equilibrium .",
    "( red curves ) spgpe simulations for @xmath302 , with @xmath312 ( dashed ) and @xmath303 ( solid ) .",
    "( blue curves ) spgpe simulations for @xmath313 , with @xmath312 ( dashed ) and @xmath303 ( solid ) . ]    the images in fig .",
    "[ fig : density ] highlight that individual trajectories of the spgpe can be thought of as showing the corresponding dynamics of a single experimental run @xcite .",
    "however when calculating thermodynamics quantities or correlation functions , we must calculate ensemble averages .",
    "[ fig : rand2equilb ] shows the c - field energy ( @xmath314 ) , and system width ( @xmath315 ) , where we calculate these quantities as an ensemble average over 100 trajectories of scattering spgpe evolution .",
    "results are shown for two different reservoir temperatures of @xmath313 and @xmath302 .",
    "for each temperature we consider reservoir interaction amplitudes of @xmath312 and @xmath303 .",
    "we see the high energy of the random initial state rapidly decreases as the system evolves towards equilibrium .",
    "note the decay time decreases with larger @xmath316 , and the final equilibrium energy increases with @xmath317 .",
    "the evolution of the system width @xmath311 follows a similar trend to the energy .",
    "the large spread of density in the initial state [ see fig .  [",
    "fig : density ] ] decreases as a well defined bose - einstein condensate emerges as equilibrium is attained .",
    "the equilibrium system width increases with temperature , due to an increased thermal density contained in the c - field .",
    "the results in fig .",
    "[ fig : rand2equilb ] show that for a given temperature , the equilibrium reached is independent of @xmath316 .",
    "this is an important result to verify , as it gives a good test of the implementation of the noise @xcite .",
    "we have presented a method to numerically solve the spgpe for a finite temperature bose gas in a three - dimensional harmonic trap .",
    "our algorithm allows us to accurately and efficiently implement the terms for the scattering reservoir interaction , while maintaining a consistent implementation of the projector via a spectral approach .",
    "we have extensively tested the accuracy of our evaluation of matrix elements associated the deterministic and noise terms , steps which are not exact within our gauss - hermite integration scheme .",
    "we have shown how the accuracy of these terms can be controlled with increasing order of @xmath30-space quadrature grid . while this leads to increased accuracy , for the systems considered in this paper our procedure showed good accuracy for all grid sizes considered .",
    "however care should be taken when implementing this algorithm in any novel system , to ensure similar convergence of matrix elements is achieved .",
    "we presented convergence rates with respect to time - step size used in our weak semi - implicit euler implementation . for all measures considered",
    "the weak semi - implicit euler method exhibits rapid convergence ( faster than @xmath299 ) , in both the strong and weak sense , although the precise rate depends on the observable in question .",
    "the algorithm converges more rapidly than the strong semi - implicit algorithm , indicating that the scattering noise may be commutative  @xcite .",
    "we found that the choice of time step is more important to the accuracy of spgpe evolution than the @xmath30-space quadrature grid size .",
    "finally we demonstrated typical usage of the spgpe by examining the evolution of a random initial state to thermal equilibrium .",
    "the thermodynamic equilibrium results are found to to be independent of @xmath316 , as must hold for a physically consistent implementation of the reservoir interaction .",
    "we acknowledge the use of the university of otago vulcan cluster , and the victoria university of wellington sci - fac hpc facility .",
    "sjr thanks victoria university of wellington where this work commenced for their hospitality .",
    "this work was supported by the university of otago ( sjr ) , the marsden fund of new zealand ( pbb , asb ) , and a rutherford discovery fellowship , administered by the royal society of new zealand ( asb ) .",
    "59ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase    10.1080/00018730802564254 [ * * ,   ( ) ] link:\\doibase 10.1088/0953 - 4075/41/20/203002 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.87.160402 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.66.051602 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.87.210404 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.72.063608 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.96.060404 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.96.020404 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.78.063601 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.79.023602 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.79.033611 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.79.033626 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.80.053624 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.81.013610 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.84.023608 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevlett.78.768 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physreva.81.023630 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.84.023637 [ * * ,   ( ) ] @noop `` , ''   ( ) link:\\doibase 10.1103/physrevlett.104.174101 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.84.043640 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.77.033616 [ * * , ( ) ] link:\\doibase    10.1038/nature07334 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.104.160404 [ * * ,   ( ) ] @noop * * ( ) link:\\doibase    10.1103/physrevlett.110.215302 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.86.023601 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.86.033602 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.86.053616 [ * * ,   ( ) ] link:\\doibase    10.1007/s11467 - 013 - 0350 - 8 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.79.165302 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.87.063611 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physreva.65.013603 [ * * , ( ) ] link:\\doibase 10.1103/physreva.73.053603 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.74.053617 [ * * ,   ( ) ] link:\\doibase 10.1134/s1054660x09040057 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.83.043619 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.84.023613 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.86.013627 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.86.033610 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.85.031604 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.57.4057 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.89.260402 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.65.023603 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.67.033610 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.87.063630 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.86.053634 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.67.046706 [ * * ,   ( ) ] link:\\doibase 10.1137/030601211 [ * * , ( ) ] link:\\doibase 10.1103/physreve.78.026704 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.80.016703 [ * * ,   ( ) ] @noop _ _ ,  ed .",
    "( ,  ,  ) @noop _ _ ,  ed .",
    "( ,  , ) http://www.sciencedirect.com/science/article/pii/002199919190077x \" [ * * ,   ( ) ] http://www.sciencedirect.com/science/article/pii/s0021999196956387 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we present a method for solving the stochastic projected gross - pitaevskii equation ( spgpe ) for a three - dimensional bose gas in a harmonic - oscillator trapping potential . </S>",
    "<S> the spgpe contains the challenge of both accurately evolving all modes in the low energy classical region of the system , and evaluating terms from the number - conserving scattering reservoir process . </S>",
    "<S> we give an accurate and efficient procedure for evaluating the scattering terms using a hermite - polynomial based spectral - galerkin representation , which allows us to precisely implement the low energy mode restriction . </S>",
    "<S> stochastic integration is performed using the weak semi - implicit euler method . </S>",
    "<S> we extensively characterize the accuracy of our method , finding a faster than expected rate of stochastic convergence </S>",
    "<S> . physical consistency of the algorithm is demonstrated by considering thermalization of initially random states . </S>"
  ]
}