{
  "article_text": [
    "the spherical mean radon transform and related inversion formulae are important , in particular , for solving problems of thermo- and photo - acoustic tomography ( tat / pat ) @xcite . in these modalities a region of interest ( roi )  within a human body",
    "is subjected to a very short electromagnetic ( em ) pulse which causes thermoelastic expansion of the tissues and generates an outgoing acoustic wave .",
    "the resulting acoustic pressure is measured by the detectors placed on a surface surrounding roi .",
    "the initial pressure distribution @xmath0 is not uniform : tumors absorb much more em  energy than healthy tissue and thus generate a much stronger signal .",
    "hence , by recovering @xmath0 one obtains valuable medical information .    under certain simplifying assumptions the problem of finding the initial pressure can be re - stated as that of inverting the spherical mean radon transform in 3d over spheres with centers lying at the measuring surface .",
    "a similar problem in 2d arises when instead of usual point - like detectors one measures the acoustic pressure with linear detectors @xcite .",
    "a detailed discussion of the solvability , range conditions , and inversion techniques for the spherical mean transform in 2d and 3d can be found in @xcite and references therein .    in the present paper",
    "we derive explicit inversion formulae for the spherical ( or , in 2d , circular ) mean transform for certain measurement surfaces with special symmetries . in general , such explicit formulae play an important role in inverse problems : they provide an important theoretical insight and , in some cases , they serve as a starting point for the development of efficient reconstruction algorithms .",
    "for example , a very popular filtration / backprojection ( fbp ) algorithm ( see , for example , @xcite ) is obtained as a result of discretization of one of the explicit inversion formulae for the 2d radon transform .",
    "for the spherical mean radon transform the inversion formulae of the filtration / backprojection type are known only for special types of the acquisition surfaces . in particular , several different formulae for the spherical measuring surface",
    "have been found in @xcite ( in 3d ) , in @xcite ( in odd dimensions ) , in @xcite ( in even dimensions ) , and in @xcite ( in arbitrary dimensions ) . a general family containing as particular cases all the above - mentioned formulae for a sphere ,",
    "was derived in @xcite .",
    "the so - called `` universal '' backprojection formula  @xcite ( already mentioned above ) holds not only for a spherical measuring surface , but also for a the surface of an infinite cylinder and for a plane @xcite ( both in 3d ) .",
    "other formulae for the planar acquisition are also known @xcite .",
    "the existence of the fbp - type formulae for these three types of surfaces ( and the absence of such formulae for other smooth surfaces ) can be explained by certain symmetries common to a sphere , a plane , and a cylinder , as discussed in @xcite",
    ".    for other measuring surfaces there exist certain numerical techniques for solving the problems tat / pat ( see @xcite and references therein ) ; but the inversion formulae for such surfaces are not known .",
    "( the notable exception is the explicit general solution obtained in @xcite for any closed surface ; however , this solution is given in terms of functions of the wave operator rather than in a form of a closed form integro - differential expression ) . in the present paper",
    "we derive explicit fbp - type inversion formulae for the spherical mean transform with the centers lying on the surfaces of certain polyhedra ( in 3d ) or on the boundaries of certain polygons ( for circular mean transform in 2d ) .",
    "the paper is organized as follows . in section  [",
    "s : formula ] we provide a formal description of the problem and supply some introductory information .",
    "next , in section  [ s : wave ] we explicitly solve the time reversal problem for the wave equation in a cube or a square ( in 2d ) by means of the double layer wave potentials .",
    "such a solution is possible due to certain symmetries of these regions .",
    "next , in section  [ s : means ] , from the explicit solution of the wave equation we derive fbp - type formulae for the inversion of the spherical ( circular ) mean transform with centers on the boundary of a cube ( a square ) .",
    "the present inversion formulae have an interesting property of being insensitive to acoustic sources lying outside of the region surrounded by the acquisition surface , as discussed in section  [ s : exterior ] .",
    "numerical examples of image reconstructions obtained using our formulae are provided in section  [ s : numerics ] .",
    "finally , in section  [ s : others ] we apply the same methods to some other domains possessing the necessary symmetries . in 2d",
    "these include a rectangle and three types of triangles : an equilateral and a right isosceles triangles , and a triangle with the angles @xmath1 and @xmath2 .",
    "in 3d our formulae extend to cuboids , right prisms whose base is one of the three triangles mentioned above , and a pyramid whose side faces are equal right isosceles triangles .",
    "throughout the paper we assume that the source of the acoustic pressure is supported within a bounded region @xmath3 , the detectors are placed on the boundary @xmath4 and the speed of sound is constant and equal to @xmath5 in the whole space @xmath6 the time - dependent acoustic pressure @xmath7 satisfies the wave equation @xmath8 where initial pressure @xmath0 is supported within @xmath9 the detectors measure the values @xmath10 of the pressure on the boundary:@xmath11 our goal is to reconstruct @xmath0 from measurements @xmath12    when the measurements are done using conventional point - like acoustic detectors , the above problem has to be solved in 3d setting .",
    "however , when the so - called line detectors are utilized @xcite , the 3d problem reduces to a set of similar 2d inverse problems for the wave equation , so from the practical point of view both 2d and 3d cases are of interest .    in the 3d case",
    "the measurements need only be done during the time interval @xmath13,$ ] since the signal vanishes after @xmath14 due to the huygens principle @xcite . in the 2d case ,",
    "the values of @xmath10 in the whole interval @xmath15 are needed for the theoretically exact reconstruction , and we will assume that these values are known .",
    "( however , if @xmath10 is known for all @xmath16 $ ] , the remaining values for the time interval @xmath17 can be explicitly reconstructed , see @xcite and the discussion at the end of the next section ) .",
    "the problem of finding @xmath0 can also be re - formulated in terms of inverting the spherical mean transform .",
    "indeed , in 3d the solution to the initial value problem ( [ e : wave_eq ] ) can be written in the form of the kirchhoff formula@xmath18 where @xmath19 are the spherical means of @xmath0@xmath20 and where @xmath21 is the unit sphere in 3d .",
    "thus , using ( [ e : wavedata ] ) one can relate the spherical means @xmath22 to @xmath23:@xmath24 and , taking into account that @xmath25 solve for @xmath22@xmath26 now the problem is reduced to finding function @xmath0 from its spherical means @xmath22 with centers on @xmath27    similarly , in 2d , one can introduce the circular means @xmath28@xmath29 now solution of ( [ e : wave_eq ] ) can be expressed through @xmath30 by the formula@xmath31 and , in particular,@xmath32 the integral in the right hand side of the latter equation is the well known abel transform whose inversion formula is also well known . thus , circular means @xmath33 can be found from @xmath10 by the following formula@xmath34 which again leads to the problem of reconstructing @xmath0 from its cylindrical means @xmath35 ( since @xmath33 vanish for @xmath36 the knowledge of @xmath10 in the time interval @xmath16 $ ] is sufficient to reconstruct @xmath33 using the latter formula ; moreover , values of @xmath10 for @xmath37 can now be recovered from @xmath33 by equation ( [ e : abel ] ) . )",
    "it is well known that the initial pressure @xmath0 can be found by the time reversal , i.e. by solving the wave equation back in time . in particular , in the 3d case , since solution to ( [ e : wave_eq ] ) vanishes within @xmath3 after @xmath38 due to the huygens principle , one can solve the following initial - boundary - value problem backwards in time : @xmath39,\\quad x\\in\\omega\\subset\\mathbb{r}% ^{3},\\\\ u(x , t)=0,\\quad u_{t}(x , t)=0,\\\\ u(y , t)=p(y ,",
    "t),\\quad y\\in\\partial\\omega,\\\\ t=\\mathrm{diam}\\omega .",
    "\\end{cases } \\label{e:3dbackwards}%\\ ] ]    function @xmath0 we seek to recover equals @xmath40 at the moment @xmath41:@xmath42    in 2d the solution to the wave equation does not vanish in a finite time , and therefore the initial condition should be replaced by the condition of the decrease at @xmath43 @xmath44 as in 3d , @xmath0 is found using formula ( [ e : terminal ] ) .",
    "the above initial - boundary - value problems can be solved numerically using , for example , finite difference methods ( e.g. @xcite ) . for certain acquisition surfaces methods based on eigenfunction expansion",
    "can also be very effective @xcite .",
    "our goal , however , is to obtain an explicit filtration / backprojection type formula for the solution .",
    "if the existing detectors could measure ( in addition to the pressure ) the normal derivative of the pressure , such an explicit analytic solution could have been represented , using the green s formula , in the form of the double- and single- layer potentials .",
    "unfortunately , the normal derivative is not known .",
    "still , explicit representations of the solution of the wave equation by means of the double layer potential are possible for surfaces with certain symmetries , such as , for example , a sphere , a cylinder , and a plane .",
    "in fact , the so - called `` universal backprojection formula '' @xcite for these surfaces can be interpreted as evaluation of a certain double layer potential .    in the next section",
    "we find explicit inversion formulae for the case when @xmath3 is a cube ( in 3d ) or a square ( in 2d ) .",
    "first , we obtain explicit solutions for the problems ( [ e:3dbackwards ] ) and ( [ e : back2d ] ) in the form of the double layer potentials .",
    "these formulae allow us to reconstruct @xmath0 from the measured values of the pressure @xmath45 in section  [ s : means ] they also will be used to derive explicit filtration / backprojection time formulae for recovering @xmath0 from its spherical ( circular ) means in these domains .",
    "in 3d , the retarded free space green s function @xmath46 is given by the following formula  @xcite@xmath47 it solves the equation@xmath48 subject to the radiation condition as @xmath49 we will need the advanced green s function @xmath50@xmath51 that solves ( [ e:3dgreen ] ) back in time and satisfies the radiation condition as @xmath52    the double- and single- layer potentials are frequently used in the theory of partial differential equations ( see e.g. @xcite ) .",
    "the wave potentials that solve the time dependent wave equation , were introduced in @xcite ( see also @xcite ) .",
    "we summarize below some of the basic properties of the wave potentials that will be needed for further use .",
    "( here we sacrifice generality for simplicity and discuss only the properties that will be used later in the text ) .    given a plane @xmath53 and a function @xmath54 , @xmath55 which is continuous , twice differentiable in time and compactly supported in both variables",
    ", we introduce the ( advanced )  single layer potential @xmath56 and the double - layer potential @xmath57 with the density @xmath54 as follows:@xmath58 where @xmath59 is the normal to @xmath53 , and @xmath60 is the standard area element .",
    "note that both @xmath56 and @xmath57 satisfy the wave equation for all @xmath61 outside @xmath53 ; both potentials describe waves propagating ( backwards in time ) away from the support of @xmath62 and they satisfy the radiation condition at infinity as @xmath52 also , @xmath63 for all @xmath64 and due to the standard jump conditions @xcite@xmath65 since @xmath66 vanishes for positive values of @xmath67 equation ( [ e : double3d ] ) implies that if @xmath54 vanishes for @xmath68 then so does @xmath69 finally , since @xmath59 is constant , using ( [ e:3dgreenf ] ) @xmath57 can be re - written as follows@xmath70 we notice that , due to ( [ e : dontmatter ] ) , ( for a planar surface only ) , @xmath71    in 2d , the advanced free space green s function @xmath72 has the following form @xcite : @xmath73{cc}% \\frac{1}{2\\pi\\sqrt{t^{2}-x^{2 } } } , & |x|<|t|,t<0,\\\\ 0 , & \\mathrm{otherwise}% \\end{array } \\right .   .\\",
    "] ] further , for a given straight line @xmath74 and for a continuous , twice differentiable in time , compactly supported in both variables function @xmath75 @xmath76 we define the single - layer potential @xmath56 with the density @xmath77 @xmath78 now , instead of dealing directly with @xmath79 ( which would lead to strongly singular integrals ) , we define the double layer potential @xmath57 by means of ( [ e : doublesingle ] ) and ( [ e : single2d ] ) : @xmath80 where @xmath59 is the normal to @xmath74 , and @xmath81 is the standard arc length . as before , @xmath57 satisfies the wave equation ( now in 2d ) for all @xmath61 outside @xmath74 and it describes an outgoing wave propagating ( backwards in time ) away from the support of @xmath82 also , @xmath63 for all @xmath83 and@xmath84      an explicit solution to the initial - boundary - value problem ( [ e:3dbackwards ] ) for the case when @xmath3 is a cube can be obtained using the double layer potentials , as described below .    without loss of generality",
    "let us assume that @xmath85 , and boundary @xmath86 consists of six faces @xmath87 @xmath88 : @xmath89 in this case the wave leaves @xmath3 after time @xmath90 .",
    "let us assume that @xmath91 and that the face @xmath92 lies in the plane @xmath93 first .",
    "we will solve the initial - boundary - value problem with non - zero boundary conditions on face @xmath92 only:@xmath39,\\quad x\\in\\omega\\subset\\mathbb{r}% ^{3},\\\\ u(x , t)=0,\\quad u_{t}(x , t)=0,\\\\ \\lim_{\\varepsilon\\rightarrow0,\\varepsilon>0}u(y-\\varepsilon n_{1}% , t)=p(y , t),\\quad",
    "y\\in s_{1},\\\\ u(y , t)=0,\\quad y\\in\\bigcup\\limits_{j=2}^{6}s_{j } , \\end{cases } \\label{e : oneface3d}%\\ ] ] where @xmath94 is the exterior normal to @xmath95 the solution procedure we are about to outline will apply as well to the other faces @xmath87 @xmath96 , and the solution of problem ( [ e:3dbackwards ] ) will then be readily obtained as the sum of the solutions corresponding to each face .    to simplify the presentation",
    "let us introduce an operator @xmath97 that extends any function @xmath98 defined in the open square @xmath99 to a function @xmath100 defined in @xmath101 by means of odd reflections .",
    "in detail , if @xmath102 then @xmath103 coincides with @xmath104 within @xmath105 further , for any point @xmath106 lying in an open square @xmath107 with the side @xmath108 and centered at @xmath109 @xmath110 is defined by the following formula : @xmath111 finally , on the boundary of each square @xmath107 we define function @xmath100 to be zero .",
    "let us denote by @xmath112 the plane containing @xmath92 , and introduce plane @xmath113 parallel to @xmath112 and passing through the point @xmath114 we equip both planes with the same normal @xmath94 coinciding with the exterior normal to face @xmath95 we introduce function @xmath115 i.e. we replicate the boundary values of @xmath40 on face @xmath95 now , for @xmath116,$ ] we define the double - layer potentials @xmath117 and @xmath118 with the density @xmath119 supported on planes @xmath112 and @xmath113:@xmath120{c}% v_{1}^{a}(x , t)=\\frac{1}{2\\pi}\\operatorname{div}\\int\\limits_{\\mathbb{r}^{2}% } \\frac{n_{1}}{|(a , y_{2},y_{3})-x|}p_{1}^{\\mathrm{repl}}(y_{2},y_{3}% , t+|(a , y_{2},y_{3})-x|)dy_{2}dy_{3},\\\\ v_{1}^{b}(x , t)=\\frac{1}{2\\pi}\\operatorname{div}\\int\\limits_{\\mathbb{r}^{2}% } \\frac{n_{1}}{|(-3a , y_{2},y_{3})-x|}p_{1}^{\\mathrm{repl}}(y_{2},y_{3}% , t+|(-3a , y_{2},y_{3})-x|)dy_{2}dy_{3}. \\end{array } \\label{e : doublelayers}%\\ ] ] note that since @xmath121 is finitely supported in @xmath122 $ ] in the time variable , the integrands in the above expressions vanish for large values of @xmath123 or @xmath124 and therefore the integration is actually performed over bounded subsets of @xmath101 lying within the ball @xmath125 in order to make expressions ( [ e : doublelayers ] ) simpler , we will abuse notation by writing @xmath126 for @xmath127 or @xmath128 instead of @xmath129@xmath130 where @xmath60 is the standard area element , and @xmath131 means either @xmath132 or @xmath133    the combined potential @xmath134 has some interesting properties .",
    "let us denote by @xmath135 the face of cube @xmath3 opposite to @xmath95 we notice that planes @xmath112 and @xmath113 are symmetric with respect to @xmath135 , and , due to the choice of the normals , potential @xmath136 vanishes on @xmath137 next , due to the oddness of @xmath138 potential @xmath136 vanishes on the other four faces @xmath139 of the cube @xmath140 ) .",
    "finally , since @xmath141 is smaller than the distance between @xmath112 and @xmath113 , potential @xmath142 equals 0 on @xmath112 for all @xmath143 therefore , @xmath144 thus , potential @xmath136 solves initial - boundary - value problem ( [ e : oneface3d ] ) . for brevity",
    ", we will re - write the expression for @xmath136 in the following form@xmath145    in order to obtain the desired solution to ( [ e:3dbackwards ] ) , we replicate the boundary values on the faces @xmath146@xmath147 next , we introduce planes @xmath148 @xmath149 with normals @xmath150 and define double layer potentials @xmath151 with the densities @xmath152 on @xmath148 @xmath149:@xmath153 the sum of these potentials @xmath154 @xmath155 solves the initial - boundary - value problem ( [ e:3dbackwards ] ) , and , therefore , @xmath0 equals to @xmath156@xmath157 interestingly , while each of the potentials @xmath158 solves the wave equation in the sense of distributions ( due to the discontinuities in the edges of @xmath159 the sum @xmath160 of these potentials solves the wave equation in the classical sense ( if @xmath161 thus , we have proven the following    the @xmath162 initial condition @xmath0 of the initial - boundary - value problem ( [ e : wave_eq ] ) in the case @xmath163 can be reconstructed from the boundary values @xmath10 ( defined by ( [ e : wavedata ] ) ) by formulae ( [ e:3dwaveinversion ] ) and ( [ e : repldata3d ] ) .",
    "formula ( [ e:3dwaveinversion ] ) closely resembles the so - called `` universal backprojection formula '' @xcite especially the version applicable to the measurements done over an infinite plane .",
    "however , in the present case the measurements are performed over a bounded surface ( that of the cube ) , and the exact reconstruction at any point @xmath61 is obtained by integration over a bounded set @xmath164      a similar technique can be used to find the explicit solution to the initial - boundary - value problem ( [ e : back2d ] ) in the case when @xmath3 is a square .",
    "the geometry of the problem is actually easier , thanks to the lower dimensionality of the problem .",
    "however , in 2d the huygens principle does not hold and the solution will result from the integration over unbounded sets .",
    "we will assume that @xmath3 is a square @xmath99 , @xmath92 is the side of @xmath3 corresponding to @xmath165 and @xmath135 is the side contained by the line @xmath166    first , let us find solution @xmath167 to the following initial - boundary - value problem : @xmath39,\\quad x\\in\\omega\\subset\\mathbb{r}% ^{2},\\\\ u(x ,",
    "t)=0,\\quad u_{t}(x , t)=0,\\\\ \\lim\\limits_{\\varepsilon\\rightarrow0,\\varepsilon>0}u(y-\\varepsilon n , t)=p(y , t)\\eta(t , t),\\quad y\\in s_{1},\\\\ u(y , t)=0,\\quad y\\in s_{j},\\quad j=2,3,4 , \\end{cases } \\label{e : truncated2d}%\\ ] ] where @xmath168 is a @xmath169 cut - off function equal 1 for @xmath170 $ ] and vanishing with all the derivatives at @xmath171 we introduce operator @xmath172 that extends a function @xmath173 defined in the interval @xmath174 to a function @xmath175 defined on @xmath176 by means of odd reflections . in detail , within the interval @xmath177 function @xmath103 coincides with @xmath178  for any @xmath179 @xmath180 there is a unique integer @xmath181 such that @xmath182 we define @xmath183 finally , at the odd integer points @xmath103 vanishes : @xmath184 @xmath185    let us call @xmath186 the straight line containing @xmath95 introduce the family of lines @xmath187 consisting of all straight lines parallel to @xmath186 , and passing through the points @xmath188 @xmath189 .",
    "( obviously , @xmath190 the exterior normal @xmath94 to the side @xmath92 of the square will be used as the normal to all the lines in @xmath187 .",
    "let us define function @xmath191 by replicating values of @xmath192 for @xmath193@xmath194 we will abuse notation by writing @xmath195 instead of the more accurate @xmath196 further , let us introduce the double layer potential @xmath197 with the density @xmath198 supported on all lines in the family @xmath199 defined by the formula@xmath200 note that in the above formula the integration in @xmath201 is actually performed over a bounded subset of @xmath187 due to the finite support of @xmath202 in the second variable .",
    "potential @xmath197 satisfies the wave equation in @xmath9 since @xmath121 is odd with respect to the straight lines containing all sides of @xmath4 @xmath203 vanishes on @xmath204 however , @xmath197 is not continuous across @xmath95 the jump is such that@xmath205.\\ ] ] therefore , @xmath197 solves the problem ( [ e : truncated2d ] ) .",
    "the next step is to obtain a solution @xmath206 of the following boundary problem:@xmath207,\\quad x\\in\\omega \\subset\\mathbb{r}^{2},\\\\ u^{t}(x , t)=0,\\quad u_{t}^{t}(x , t)=0,\\\\ u^{t}(y , t)=p(y , t)\\eta(t , t),\\quad y\\in\\partial\\omega . \\end{cases } \\label{e : truncated2dall}%\\ ] ] this can be achieved by defining functions @xmath208 and families of parallel lines @xmath209 with normals @xmath150 @xmath210 and by introducing the corresponding double layer potentials @xmath211 in a fashion similar to our definition of @xmath212 and @xmath213 now each @xmath214 satisfies the boundary problem with the inhomogeneous conditions on the side @xmath215 and the homogeneous conditions on the other three sides of the square . in turn , the sum of these potentials @xmath216@xmath217 solves ( [ e : truncated2dall ] ) .",
    "it is known @xcite that , as @xmath141 grows to infinity , @xmath218 converges uniformly to @xmath0:@xmath219 the latter formula is very similar to the explicit inversion formula for measurements done from an infinite line @xcite .",
    "formula ( [ e : finalwave2d ] ) can also be re - written using the green s function @xmath220 to illustrate its connection to the surface potentials:@xmath221    the @xmath162 initial condition @xmath0 of the initial - boundary - value problem ( [ e : wave_eq ] ) in the case @xmath222 can be reconstructed from the boundary values @xmath10 ( defined by ( [ e : wavedata ] ) ) by formulae ( [ e : finalwave2d ] ) .",
    "in 3d , in order to reconstruct @xmath0 from its spherical means @xmath22 with centers on @xmath4 we introduce replicated spherical means @xmath223 defined as follows@xmath224 since the replication operator @xmath97 is invariant with respect to the time variable , from ( [ e:3daverages ] ) we conclude that@xmath225 now formula for reconstructing @xmath0 from spherical averages in 3d is obtained by substituting ( [ e : replaver ] ) into ( [ e:3dwaveinversion]):@xmath226 we thus have proven    in 3d , a @xmath162 function @xmath0 supported within the cube @xmath3 can be reconstructed from its spherical means @xmath22 with centers on @xmath86 by the formula ( [ e:3dmeaninversion ] ) , where @xmath223 is defined by ( [ e : replaverdef ] ) .    formula ( [ e:3dmeaninversion ] ) has a form of the filtration by differentiation , followed by the backprojection , followed by the divergence operator .",
    "it is similar to the inversion formula obtained by the author @xcite for the inversion of the spherical means with centers on a sphere ( in 3d ) . in the latter case",
    "the integration is over the surface of a sphere , and no replication of the data is needed .      in this section",
    "we derive an explicit inversion formula for finding @xmath0 from the values of its circular means with the centers lying on the boundary of a square .",
    "the starting point for the derivation is equation ( [ e : finalwave2d ] ) that reconstructs the sought function from the boundary values of the solution of the wave equation ; we re - write it in the following form @xmath227   \\right\\vert _ { s=|x - y|}dl(y)\\nonumber\\\\ &   = \\frac{1}{\\pi}\\sum_{j=1}^{4}\\int\\limits_{\\phi_{j}}n_{j}\\cdot(x - y)\\hat { p}_{j}^{\\mathrm{repl}}(y,|x - y|)dl(y ) \\label{e:2deq2}%\\end{aligned}\\ ] ] where@xmath228 first , we will express @xmath229 in terms of the circular averages @xmath35 let us apply the extension operator to @xmath33 and define @xmath230 as follows:@xmath231 function @xmath232 is related to @xmath233 in the same way as @xmath234 is related to @xmath235:@xmath236 where we integrated by parts twice , and used the fact that @xmath237 for all @xmath238 now one can compute the derivative needed in ( [ e:2dder]):@xmath239 by substituting the above equation into ( [ e:2dder ] ) , interchanging the integration order , and noticing that @xmath240 for @xmath241 one obtains the following expression for @xmath242@xmath243   dr\\nonumber\\\\ &   = \\lim_{t\\rightarrow\\infty}\\int\\limits_{0}^{2\\sqrt{2}a}\\frac{\\partial } { \\partial r}\\left (   \\frac{\\partial}{r\\partial r}m_{j}^{\\mathrm{repl}% } ( y , r)\\right )   \\left [   \\ln\\left (   \\sqrt{t^{2}-s^{2}}+\\sqrt{t^{2}-r^{2}% } \\right )   -\\frac{1}{2}\\ln\\left (   |r^{2}-s^{2}|\\right )   \\right ]   dr\\nonumber\\\\ &   = -\\frac{1}{2}\\int\\limits_{0}^{2\\sqrt{2}a}\\ln\\left (   |r^{2}-s^{2}|\\right ) \\frac{\\partial}{\\partial r}\\left (   \\frac{\\partial}{r\\partial r}m_{j}% ^{\\mathrm{repl}}(y , r)\\right )   dr\\nonumber\\\\ &   + \\lim_{t\\rightarrow\\infty}\\int\\limits_{0}^{2\\sqrt{2}a}\\frac{\\partial } { \\partial r}\\left (   \\frac{\\partial}{r\\partial r}m_{j}^{\\mathrm{repl}% } ( y , r)\\right )   \\ln\\left (   \\sqrt{t^{2}-s^{2}}+\\sqrt{t^{2}-r^{2}}\\right )   dr \\label{e:2deq1}%\\end{aligned}\\ ] ] the last integral in ( [ e:2deq1 ] ) vanishes:@xmath244 where we integrated by parts and used the finite support of @xmath245 in @xmath246 now ( [ e:2deq1 ] ) can be re - written in the following form@xmath247 where `` pv '' indicates that the integral is understood in the principal value sense . substitution of the latter expression for @xmath248 into ( [ e:2deq2 ] ) yields the following sequence of equivalent reconstruction formulae for @xmath0 : @xmath249   dl(y ) .",
    "\\label{e:2dmean3}%\\end{aligned}\\ ] ] thus , the following statement holds :    in 2d , a @xmath162 function @xmath0 supported within the square @xmath3 can be reconstructed from its circular means @xmath33 with centers on @xmath86 by the formula ( [ e:2dmean3 ] ) ( or , equivalently , by formulae ( [ e:2dmean1 ] ) or ( [ e:2dmean2 ] ) ) , where @xmath250 is defined by ( [ e:2drepl ] ) .    formula ( [ e:2dmean3 ] ) closely resembles formula 8.19 @xcite that reconstructs a function from its circular means centered on a circle .",
    "the drawback of formulae ( [ e:2dmean1])-([e:2dmean3 ] ) is that the integration has to be done over an unbounded set @xmath251 however , by analyzing the expression in parentheses in ( [ e:2dmean1 ] ) one can notice that the integrand of the outer integral decreases as @xmath252 for large values of @xmath238 moreover , for values of @xmath253 the integrand is infinitely smooth .",
    "therefore , by integrating over a subset @xmath254 containing all points @xmath255 such that @xmath256 one correctly reconstructs the singularities of @xmath257 and obtains a good quantitative approximation to @xmath258 this conclusion is supported by the numerical evidence presented in the next section .",
    "the time reversal reconstruction methods in tat / pat ( i.e. methods based on the numerical solution of the wave equation backwards in time ) have the following interesting property .",
    "if the support of the initial perturbation @xmath0 has a part lying outside the region enclosed by the acquisition surface @xmath86 , the time reversal still correctly reconstructs the part of @xmath0 lying within @xmath3 . in other words , the exterior sources do not affect the reconstruction within @xmath3 @xcite .",
    "since reconstruction methods based on the expansions in the series of the eigenfunctions of the dirichlet laplacian on @xmath3 @xcite are theoretically equivalent to the time reversal , they also inherit the insensitivity to the exterior sources . on the other hand , all previously known filtration / backprojection - type inversion formulae for the spherical mean transform do not have this property : in the presence of an exterior source",
    "the reconstruction within @xmath3  will be incorrect .",
    "the present inversion formulae ( and their generalizations in the following sections ) are based on the explicit solution of the wave equation ( by means of double layer potentials ) .",
    "thus , they inherit from the time reversal methods the insensitivity to the exterior sources . a numerical example demonstrating accurate reconstruction in the presence of an exterior source",
    "is presented in the next section .",
    "an example illustrating reconstruction of a function from its spherical means with centers lying on the surface of a cube is presented in figure  [ f:3drec ] . as a phantom we used a set of 25 characteristic functions of balls of various radii supported within the cube @xmath259 .",
    "the centers of all the balls lied in the plane @xmath260 the cross section of our phantom by the latter plane is shown in figure  [ f:3drec](a ) .",
    "the part ( b ) of this figure demonstrates the cross section of the image reconstructed on the grid of size @xmath261 using formula  ( [ e:3dmeaninversion ] ) .",
    "the simulated detectors ( i.e. the centers of the integration spheres ) were placed on the uniform cartesian @xmath262 grids on each of the faces of the cube ; there were 257 integration spheres for each detector with the radii varying uniformly from @xmath41 to @xmath263 our algorithm was based on a straightforward discretization of equation ( [ e:3dmeaninversion ] ) , where finite differences were used to compute the derivatives .    in order to illustrate the reconstruction in the presence of exterior sources we added to the phantom shown in figure  [ f:3drec](a ) a ball of radius 0.08 located at the position ( 1.1,0,0 ) , and computed",
    "the spherical means corresponding to this extended set of sources .",
    "the size and location of this additional ball were chosen so that all the spherical means used for the reconstruction still vanished when the radii exceeded @xmath263 the result of the reconstruction computed using formula  ( [ e:3dmeaninversion ] ) is shown in figure  [ f:3drec](c ) .",
    "the resulting image may seem indistinguishable from the one in figure  [ f:3drec](b ) ; in fact , the difference is about 4% in the @xmath264 norm .",
    "( in the absence of the discretization error the images would exactly coincide ) .    in figure  [ f:2drec ]",
    "we demonstrate the reconstruction of a function in 2d from its circular means centered on the boundary of a square @xmath265 using a modified formula  ( [ e:2dmean1 ] ) , with the integration restricted to the subset @xmath254 of @xmath266 contained within the disk of radius @xmath267 centered at the origin .",
    "( all the points @xmath201 satisfying the condition @xmath268 are contained in @xmath269 the main goal of this experiment was to evaluate the effect of truncating the integration region . to this end",
    "we took care to eliminate other sources of error .",
    "in particular , as a phantom we chose a smooth function shown in figure  [ f:2drec](a ) . moreover , our implementation of formula  ( [ e:2dmean1 ] ) used a spectrally accurate algorithm for computing the hilbert transform and a higher order polynomial interpolation during the backprojection .",
    "( the hilbert transform arises since fraction @xmath270 in [ e:2dmean1 ] can be re - written as @xmath271 the reconstructed function is shown in in figure  [ f:2drec](b ) .",
    "the image is almost identical to the phantom ; the relative reconstruction error in this example equals @xmath272 in the @xmath264 norm . in other words ,",
    "the truncation error is negligible for most practical applications , if all the points @xmath201 satisfying the condition @xmath268 are included in the truncated domain .",
    "the inversion formulae introduced in this paper for a cube ( in 3d ) and a square ( in 2d ) are based on the explicit representations of a solution of the wave equation by double - layer potentials . in general ,",
    "double layer potentials are frequently used to solve dirichlet problems for various pde s in the interior and/or exterior of bounded regions .",
    "usually such formulations lead to boundary integral equations for the potential densities that have to be solved numerically .",
    "however , as explained in the previous sections , if the detectors ( centers of spherical means ) are located on the boundary of a cube ( or , in 2d , a square ) , the solution of the wave equation can be represented by the double layer potentials supported on certain periodic planes , with certain periodic densities . due to the symmetries in these geometries ,",
    "the potentials vanish on the planes , and the jump conditions relate the densities directly to the known boundary values , thus providing the desired explicit reconstruction formulae .",
    "this approach can be extended to obtain explicit reconstruction formulae for the measurements made from the boundaries of certain polygons ( in 2d ) and polyhedra in ( 3d ) possessing sufficient symmetries .",
    "these formulae will be similar to the present formulae for the square and the cube , but the planes supporting the potentials and the replication procedure defining the densities will be different in each case .    before extending the inversion formulae to these new domains ,",
    "let us provide an alternative description of the replication procedure for a square and a cube  such that it would be easier to generalize to other geometries .",
    "we start with a square , in 2d .",
    "our goal is , again , to find the solution @xmath206 of the initial - bouindary - value problem ( [ e : truncated2dall ] ) provided the boundary values of @xmath40 are known . to this end , let us construct a tesselation of the plane @xmath101 by squares of the size @xmath273 one of which coincide with @xmath274 in each square we define @xmath275 to equal @xmath276 ( in some local coordinates ) .",
    "the signs are chosen so as to be different in any two adjacent squares .",
    "the local coordinates are defined in such a way that the function in any two adjacent squares is odd with respect to the joint side of these two squares .",
    "the resulting function @xmath277 is continuous in @xmath61 everywhere except the boundary of each square . at each point of the boundary it has a jump equal to",
    "a doubled negative limiting value of @xmath278 as @xmath61 approaches the boundary from the inside .",
    "now we define the double layer potential supported on all lines containing the boundary of the squares , with the density equal to the jump in @xmath279 this new procedure leads to the same double layer potentials as were described in section  [ s:2drev ] , with the densities equal @xmath280 on each family of lines @xmath209 .",
    "the rest of the reconstructing procedure is the same .",
    "similarly , in order to obtain the double layer potential for a solution of the wave equation in a cube @xmath281 , we tessellate the plane with shifted versions of @xmath3 . in each shifted cube",
    "we define @xmath277 as a reflected version of @xmath167 with a sign opposite to the sign used in the neighboring cubes .",
    "the local coordinates in each cube are defined in such a way that @xmath277 is odd with respect to each side of each cube .",
    "now we define the double layer potentials supported on all planes that contain all faces of all cubes , with the density equal to the jump of @xmath277 across the cube faces .",
    "this new procedure produces the same set of the double layer potentials as was utilized in the section  [ s:3drev ] , and it leads to the same reconstruction formulae . although the double layer potential described above is supported on an unbounded set , only a bounded subset of it is actually used to reconstruct the image within @xmath3 , due to the finite speed of sound .",
    "one obvious extension of the present inversion formulae is to rectangular domains in 2d and to cuboids in 3d .",
    "all the symmetries needed for the double layer potentials to form an explicit solution remain in place in these cases , and all the reconstruction formulae ( for the wave equation and for the spherical / circular means ) remain the same , with a proper re - definition of integration lines and planes .      in 2d , the inversion formulae presented in sections  [ s:2drev ] and [ s:2dmeans ] can be generalized to certain triangular domains .",
    "namely , a equilateral triangle , a right isosceles triangle , and a triangle with the angles @xmath282 and @xmath2 can be used to tessellate the plane while preserving the necessary symmetries .",
    "the corresponding tesselations are shown in figure  [ f:2drepl ] .    in each of the three cases shown in the figure ,",
    "the sides of the triangular fundamental domain @xmath3 are marked by different types of lines ( solid , dashed , and dotted ones ) so that the orientation of the local coordinates in each of the triangles is clear from the picture .",
    "signs `` + '' and `` - '' indicate the choice of @xmath40 or @xmath283 in each triangle .",
    "clearly , the resulting @xmath277 is odd with respect to all lines containing all sides of all the triangles .",
    "therefore , if one defines the double layer potential with the density supported on these lines and equal to the jump of @xmath277 across the corresponding face , the value of this potential will vanish on all the triangle sides , and , due to the jump condition , this potential will solve the initial - boundary - value problem for the wave equation in @xmath9 therefore , the analog of the formula  ( [ e : finalwave2d ] ) is valid with the corresponding re - definition of @xmath284 and with @xmath3 being one of the above mentioned triangles .",
    "this , in turn , allows us to obtain the analog of the inversion formulae ( [ e:2dmean1 ] ) - ( [ e:2dmean3 ] ) for the reconstruction from circular means , by defining @xmath285 in a similar fashion .",
    "as it is the case for the square domain , the latter formulae are exact if the integration is done over the unbounded graph . however , due to the fast decrease of the expression in the parentheses in  ( [ e:2dmean1 ] ) one can hope that the integration over the region containing all points @xmath201 satisfying the condition @xmath256 will produce an accurate approximation to @xmath258     by odd reflections to a cube , width=576,height=115 ]      in addition to cuboids , the techniques of the previous sections can also be used to find explicit solutions and inversion formulae in 3d for some other domains .",
    "in particular , one can derive explicit inversion formulae for reconstructing a function from its spherical means centered on the surface of a right prism of height @xmath286 , whose base is one of the triangles discussed in the previous section . as before , it may be easier to start with finding the explicit solution to the wave equation @xmath167 whose values on the boundary of the prism are known . in order to obtain such a solution",
    ", we replicate @xmath167 in the directions parallel to the base of the prism , according to the schemes in figure  [ f:2drepl ] .",
    "then we replicate the resulting slab of height @xmath286 in the odd fashion with respect to the planes containing the bases of the prism , until @xmath167 is extended to function @xmath277 defined in the whole @xmath287 in @xmath288 further , we define the double layer potential with the density supported on planes containing the faces of all the replicated prisms , and equal to the jumps of @xmath167 across the replicated faces .",
    "this double layer potential vanishes on all the faces , and , due to the jump condition , provides a solution to the initial - boundary - value problem for the wave equation in 3d .",
    "this results in an explicit formula analogous to  ( [ e:3dwaveinversion ] ) . in order to obtain the analog of the formula  ( [ e:3dmeaninversion ] ) it is enough to define @xmath289 according to the replication procedure described above . due to the huygens principle , the integration is actually performed over the subset of the replicated faces satisfying",
    "the condition @xmath290 both formulae ( for the spherical means and for the wave equation ) are exact in this case .",
    "finally , the present method can be extended to the triangular pyramid @xmath3 whose vertices have coordinates @xmath291 and @xmath292 ( this region can also be described as a pyramid whose side faces are equal right isosceles triangles . ) again , starting with the solution @xmath167 of the wave equation in @xmath293 we define @xmath277 as follows .",
    "first , we reflect @xmath167 in odd fashion with respect to the vertical faces of @xmath3 to extend @xmath40 to a rectangular pyramid ( see figure  [ f : pyramid ] ) .",
    "then we reflect ( oddly ) the pyramid with respect to its triangular faces to obtain six pyramids ( only four are shown in the figure ) to form a cube .",
    "then the cube is used to tessellate the whole space .",
    "as before , we define the double layer potential by the jumps of the resulting function @xmath277 across all the replicated faces .",
    "the symmetries of such an object guarantee that the potential vanishes on all the faces , and the jump conditions yield the required limiting values as one approaches the boundary of @xmath3 from the inside .",
    "thus , one obtains the exact solution to the initial - boundary - value problem corresponding to the time reversal of the wave equation . by implementing a similar replication procedure to define @xmath294",
    "one obtains an analog of the inversion formula  ( [ e:3dmeaninversion ] ) for reconstructing a function from its spherical means centered on the surface of @xmath9    it is worth noting that , similarly to the formulae for a cube and a square , all the formulae discussed in the present and previous sections also have the property of being insensitive to sources lying outside of the domain surrounded by the acquisition surface .",
    "by utilizing the double layer wave potentials we found explicit solutions to the initial - boundary - value problems for the wave equation in certain 2d and 3d domains . in problems of tat / pat this yields explicit expressions for the result of the time reversal , and thus explicitly reconstructs the initial pressure distribution @xmath258 further , by formulating the problem in terms of spherical ( circular ) means , we obtain from the solutions to the wave equations explicit closed - form inversion formulae of filtration / backprojection type for the corresponding domains . in 2d , we presented inversion formulae for a square ( or a rectangle ) , and we outlined their generalization for an equilateral triangle , right isosceles triangle , and a triangle with the angles @xmath295 and @xmath2 . in 3d , we derived formulae for a cube ( with immediate extension to a cuboid ) , and we discussed their generalization to right prisms whose bases are one of the three above - mentioned triangles , and to a pyramid whose side faces are equal right isosceles triangles .    in all cases",
    "the formulae for the inversion of the wave equation data are in the form of the double layer potentials supported on a series of planes , with the densities whose values equal to the known boundary values replicated according to the procedures described in the text .",
    "the formulae for inverting the spherical ( or circular ) means easily follow from the ones for the wave data . in the 3d case , due to the huygens principle the integration in all the formulae",
    "is restricted to a bounded subset of the planes . in 2d , in order to obtain the exact reconstruction one has to integrate over an unbounded domain .",
    "however , our numerical experiments suggest that for a sufficiently accurate reconstruction it is enough to integrate over a bounded subset containing all points @xmath201 satisfying the condition @xmath296    finally , all the presented inversion formulae remain exact within the domain even in the presence of sources located outside the domain .",
    "( in order to observe this phenomenon in 3d one may need to extend the measurement time ( or the radii of the spherical means ) to make sure that the signal vanishes after the observation time ) .",
    "interestingly , although the time reversal and some series methods also have this property , the present formulae are the only known explicit fbp - type inversion formulae that exhibit such behavior .",
    "m.  agranovsky and p.  kuchment , uniqueness of reconstruction and an inversion procedure for thermoacoustic and photoacoustic tomography with variable sound speed , _ inverse problems _ * 23 * ( 2007 ) , 20892102 .",
    "g. ambartsoumian and s. patch .",
    "thermoacoustic tomography : numerical results .",
    "proceedings of spie 6437 , _ photons plus ultrasound : imaging and sensing 2007 : the eighth conference on biomedical thermoacoustics , optoacoustics , and acousto - optics _ , alexander a. oraevsky , lihong v. wang , editors , 64371b . 2007 .",
    "p. burgholzer , j. bauer - marschallinger , h. grn , m. haltmeier , and g. paltauf , temporal back - projection algorithms for photoacoustic tomography with integrating line detectors , _ inverse problems _ * 23 * ( 7 ) s65s80 .",
    "t. ha - duong , on retarded potential boundary integral equations and their discretization , in m. ainsworth et al ( editors ) _ topics in computational wave propagation : direct and inverse problems _",
    ", _ _ lecture notes in computational science and engineering , * 31*. springer - verlag , berlin , ( 2003 ) 301336 .",
    "p. kuchment , generalized transforms of radon type and their applications , in g. olafsson and e. t. quinto ( editors ) , _ the radon transform , inverse problems , and tomography , _ proc . symp .",
    "appl . math . *",
    "63 * , ams , providence , ri ( 2006 ) 67  91 .",
    "g. paltauf , r. nuster , m. haltmeier and p. burgholzer .",
    "experimental evaluation of reconstruction algorithms for limited view photoacoustic tomography with line detectors .",
    "_ inverse problems _ * 23 * ( 2007 ) s81s94 ."
  ],
  "abstract_text": [
    "<S> we present explicit filtration / backprojection - type formulae for the inversion of the spherical ( circular ) mean transform with the centers lying on the boundary of some polyhedra ( or polygons , in 2d ) . </S>",
    "<S> the formulae are derived using the double layer potentials for the wave equation , for the domains with certain symmetries . </S>",
    "<S> the formulae are valid for a rectangle and certain triangles in 2d , and for a cuboid , certain right prisms and a certain pyramid in 3d . </S>",
    "<S> all the present inversion formulae yield exact reconstruction within the domain surrounded by the acquisition surface even in the presence of exterior sources . </S>"
  ]
}