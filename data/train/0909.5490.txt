{
  "article_text": [
    "total energy pseudopotential methods have taken pride of place in the first principles simulation of condensed matter in recent years due to their efficient use of computing resources and their suitability for structural optimisation @xcite .",
    "however , the charge density resulting from a pseudopotential calculation is incorrect in the region near the atomic nuclei - it does not include core states , and the valence states have the wrong structure . in order to obtain accurate values for any quantity that depends on the true charge density , such as hyperfine interactions or x - ray structure factors",
    ", we must obtain the correct electron charge density from the pseudopotential calculation .",
    "other methods are available that calculate the states of all the electrons in the system ( full - potential linear augmented plane wave ( flapw)@xcite , projector augmented plane wave ( paw)@xcite , linear muffin tin orbital ( lmto)@xcite , kkr green function @xcite and tight binding @xcite ) , but these methods tend to be more computationally expensive , not as well suited to structural optimisation , or are less accurate than pseudopotential methods .    in view of this",
    "it is desirable to extend the pseudopotential method by adding an extra step after the pseudo - system has been solved , ie to choose an atom for which we require the core and correct valence states , and _ reconstruct _ these correct states .",
    "it would be hoped that solving for one atom with different boundary conditions on a sphere surrounding it would be fairly straightforward . however , a number of difficulties quickly present themselves .",
    "the purpose of this paper is to describe and validate a new procedure for carrying out this _ core reconstruction _ that makes essentially the same _ physical _ approximations as the flapw method , and so can be expected to provide the same accuracy .",
    "this problem has been addressed by several previous workers . in their paper gardner and holzworth @xcite",
    "reconstruct the correct states for isolated si and ru atoms from the pseudo - atom , by applying direct integration , effectively ` inverting ' the pseudopotential .",
    "they obtain good results , showing that this reconstruction approach is at least possible .",
    "however , reconstructing the states of an atom in a lattice is considerably more complex . for this case",
    "the valence states form a continuum , so the reconstruction must be fitted into the band structure of the lattice , and in addition to this the potential is not spherically symmetric .",
    "vack and imunek @xcite describe a method for reconstructing the states for a pseudo - atom within a lattice .",
    "their method relies on direct integration and assumes the charge density , boundary conditions and self - consistent potential are spherically symmetric , although the core states are allowed to relax .",
    "the errors in the resulting eigenfunctions are fairly large , although they do obtain the correct nodal form for the eigenstates .",
    "kuzmiak et al@xcite perform a pseudopotential calculation , and orthogonalise the resultant pseudo - states to the original core states .",
    "this would work for the original formulation of pseudopotential methods , where the pseudopotential is defined in this way , but for modern norm - conserving pseudopotentials this does not give the correct solution to the problem and the errors present are difficult to control or even quantify .",
    "the most complete solution to the problem presented so far is that due to meyer et al @xcite . in their method",
    "the correct states are reconstructed by direct integration . in order to decouple the radial wave equations for the reconstruction calculation they make the assumption of spherical symmetry of the self consistent potential , but asymmetric boundary conditions for the valence states are allowed . within their scheme the core is still frozen .    in this paper",
    "a new method for performing this kind of core reconstruction is described that does not make any of the assumptions of previous approaches .",
    "the method presented here follows a different path to achieving the reconstruction , does not require spherical averaging of the self - consistent potential , provides an aspherical charge density , and does not assume a frozen core .",
    "the first step is to carry out a plane - wave pseudopotential calculation for the system of interest , and construct the single particle green function for the valence electrons present in this system .",
    "this green function is then used to create an _ embedding potential _ , as described by inglesfield @xcite . an all - electron localised atomic calculation",
    "is then carried out in a space containing the core region of the atom of interest , with the embedding potential taking into account the rest of the atoms in the lattice .",
    "effectively the system that is solved for is one all - electron atom in a lattice of pseudo - atoms .",
    "this approach preserves the full generality and flexibility of the pseudopotential method .",
    "in addition , the all - electron calculation is carried out only for the atom(s ) of interest , so computational effort can be applied sparingly .    in the next section a brief description",
    "is given of the embedding approach , how it is applied in this case , and how it relies on an accurate knowledge of the green function for the substrate system .",
    "appendix  [ sec : appa ] gives a more complete description of the method and its properties .",
    "in section [ sec : green ] we describe how the spectral representation can be efficiently applied in order to construct an accurate green function , and how the incompleteness of the available set of states introduces a significant error that must be corrected . combining the results of these two sections we",
    "then obtain the embedding potential from the green function and perform a localised calculation using the embedding terms to take into account the rest of the lattice , as described in section [ sec : reconstruction ] .",
    "section [ sec : results ] gives the results of a reconstruction carried out for bulk fcc aluminium , and the convergence of the method is discussed .",
    "rydberg atomic units are used throughout the paper .",
    "is the substrate region , region @xmath0 is the embedded region , and the all - electron states are reconstructed from a knowledge of the pseudo - states on the surface @xmath1 . ]",
    "an embedding method can be thought of as solving for a system in a sub - domain of space , denoted region @xmath0 in what follows , where the influence of the system outside of this sub - domain ( region @xmath2 ) is taken into account from a previous solution , and is _ not _ recalculated .",
    "this is shown in fig .",
    "[ fig1 ] for the core reconstruction case considered here .",
    "the embedding surface , @xmath3 , separates regions @xmath0 and @xmath2 .",
    "region @xmath0 is a sphere of radius @xmath4 enclosing the core region of the atom where the pseudo - states are incorrect and region @xmath2 is the remainder of the lattice of pseudo - atoms .",
    "it is implicitly assumed throughout this work that norm - conserving pseudopotentials are used , so that wavefunctions between core regions are correct .",
    "the embedding surface @xmath1 is assumed to be in such a region ; it follows that core regions do not overlap , hence @xmath5 where @xmath6 is the largest pseudopotential core radius .    using inglesfield s method @xcite an ` embedding potential '",
    "is obtained from the substrate system , and added to the hamiltonian for the embedded region .",
    "this embedding potential ensures that the states of the system in the embedded region satisfy the correct boundary conditions .",
    "inglesfield s method has the advantage that it requires knowledge of the properties of the substrate system only on the surface separating the embedded and substrate regions . in appendix",
    "[ sec : appa ] a brief description of the derivation of the embedding method is given , followed by two expressions for the embedding potential in terms of the green function for the substrate system , one of which has not appeared in the literature before .    within a continuum",
    "the hamiltonian of the embedded system takes the form @xmath7 \\label{eq1}\\ ] ] where @xmath8 is the embedded hamiltonian that yields the states with correct boundary conditions , @xmath9 is the normal hamiltonian for the embedded region , and @xmath10 is the embedding potential .",
    "it should be understood at this point that @xmath11 acting on a function denotes the integration over the surface @xmath1 , as described in appendix[sec : appa ] .",
    "equation ( [ eq1 ] ) , when solved in region @xmath0 , will give the correct solution for the system represented by regions @xmath0 and @xmath2 , with region @xmath2 represented entirely through the embedding potential term . the embedding potential required in equation ( eq.([eq1 ] ) ) is given by the operator @xmath12 where @xmath13 is the matrix representation of the green function on the surface @xmath1 in terms of a set of basis functions orthonormal over the surface , and the derivative is the normal derivative of @xmath13 outward from the surface and with respect to the second spatial variable of the green function .",
    "a derivation of eqs .",
    "( [ eq1 ] ) and ( [ eq2 ] ) is given in appendix  [ sec : appa ] .",
    "the embedding method of the previous section is to be applied with the substrate system represented by the results of a plane - wave pseudopotential calculation , hence the green function on the embedding surface must be obtained from the bloch states expanded in plane - waves .",
    "the natural way of constructing this green function is via the spectral representation , and a finding good approximation to this spectral representation is the concern of this section .    for the periodic system the states",
    "are characterised by two quantum numbers , the discrete band index @xmath14 and the continuous crystal momentum @xmath15 , so the spectral representation takes the form @xmath16 where @xmath17 is a bloch state , @xmath18 is its eigenenergy and @xmath19 is complex in general . for the periodic lattice both",
    "the total number of states and the number of states within a given energy interval ( in a band ) is infinite , but any numerical calculation can only provide states at a finite number of @xmath20-points , and for a finite number of bands @xcite . in view of these restrictions",
    "the approximation of the spectral representation falls naturally into two parts - approximating the brillouin zone integral from a finite number of @xmath15-points , and approximating the infinite band sum .",
    "it should be noted that although it is well established that green function methods and the spectral representation can be defined within a limited basis set @xcite , the embedding method can not be applied in this way since it relies on the properties of the green function in real space @xcite .",
    "the simplest way to apply the defining equations for the embedding potential is to expand the green function in a set of basis functions that are orthogonal over the embedding surface . for the core reconstruction considered here",
    "the embedding surface is a sphere centred on the atomic site of interest , hence a natural set of basis states are the spherical harmonics .",
    "first the kohn - sham wavefunctions are expanded on the surface @xmath1 , @xmath21 where @xmath22 , the combined index of the spherical harmonic @xmath23 , and @xmath24 are the expansion coefficients of the eigenstates in the plane - wave representation .",
    "the expansion coefficients @xmath25 can be found using the identity @xcite @xmath26 hence @xmath27 from these a ` spectral function ' @xmath28 $ ] can be defined , where @xmath29 are the expansion coefficients for the green function .",
    "this spectral function is given by the equation @xmath30 and is related to the green function by the convolution integral @xmath31 in eq .",
    "( [ eq3 ] ) the integral on the right hand side reduces to the surface integral @xmath32 due to the delta function , hence evaluation of the spectral representation reduces to the evaluation of a surface integral in @xmath20-space and a singular convolution integral in energy space .",
    "the surface integral is carried out using the linear analytic tetrahedron method @xcite , which results in a spectral function that has the correct analytic structure in that it is continuous in energy .",
    "only the irreducible wedge need be sampled with the symmetry of the crystal used to complete the rest of the integral @xcite .    in order to evaluate eq .",
    "( [ eq4 ] ) the singular integral itself must be approximated from a sampling of the function at a finite number of energy values . here",
    "the spectral function is interpolated between consecutive energy values , and the contribution to the integral from each of these ranges calculated .",
    "we use a polynomial interpolation , so the integrals can be evaluated analytically @xcite .",
    "this results in an approximation to the green function that can be evaluated for complex @xmath19 and which has the analytic properties appropriate for a continuum of states ; it is essentially a generalisation of the approach used by kuzmiak et al @xcite to complex energies .",
    "an alternative application of the linear analytic tetrahedron method to the calculation of green functions is given lambin and vigneron @xcite where eq.([eq2.1 ] ) is evaluated for each tetrahedron analytically , within the linear interpolation scheme .",
    "although this approach is more direct and introduces none of the errors due to approximating eq.([eq4 ] ) , it requires the interpolation to be applied to all tetrahedra , whereas the surface integral in eq .",
    "( [ eq5 ] ) requires only a sub - set of tetrahedra to be considered for each energy .",
    "in addition to this the surface integral and convolution route allows a greater flexibility in the degree of approximation applied , as discussed below .",
    "so far the evaluation of the green function takes into account the continuum nature of the band states , but for the spectral representation to describe a real space green function the set of states used in eq .",
    "( [ eq2.1 ] ) must be complete .",
    "we have found that in order to obtain accurate green functions using the spectral representation , we must include the complete set of @xmath33 states associated with the plane - wave basis set ( for further discussion see trail@xcite ) .",
    "@xmath33 is the number of plane - waves in the basis set , determined by the plane - wave energy cut - off , and these states will be obtained by direct matrix diagonalisation of the kohn - sham hamiltonian .",
    "this set of states is still not complete in real space , hence we must consider the errors introduced by not including the energy bands that are not available in a finite plane - wave calculation . in what follows",
    "we refer to the spectral representation that includes only the @xmath33 lowest energy bands as the _ incomplete spectral representation_. it is important to realise that we mean the states are incomplete in real space , they are , of course , complete in the sub - space spanned by the plane - wave basis set .",
    "it is not immediately apparent that this incompleteness will have a significant effect , and it could be hoped that the ` missing ' high energy states are so far above the energies of interest ( ie at or below the fermi energy ) that any error introduced by their absence will be negligible .",
    "this is only partly true , and the properties of the error introduced by incompleteness are derived in appendix[sec : appb ] for a free electron gas .",
    "correcting for this incompleteness not only speeds convergence with respect to @xmath34 , it also ensures that the approximation of the green function has the correct analytic form . we follow james and woodley @xcite and approximate the high energy states ` missing ' from the incomplete spectral representation by free electron states .",
    "the plane - wave basis set used to represent the lowest @xmath33 bands is described by @xmath35 , where @xmath36 are reciprocal lattice vectors and @xmath37 is the standard plane - wave cut - off energy .",
    "consequently , the free electron states required to ` top up ' the incomplete spectral representation are those described in the reduced zone scheme by @xmath38 and @xmath20 in the first brillouin zone .    in order to calculate the required correction",
    "we calculate an incomplete spectral representation for free electrons with exactly the same basis as for the pseudopotential states , and subtract this from the analytic free electron green function .",
    "this yields the approximation @xmath39 where the first term on the right hand side is the incomplete spectral representation of the pseudo - states , the second is the incomplete spectral representation of free electron states and the final term the complete spectral representation for free electron states ( ie the analytic free electron green function ) . in terms of the spectral function , @xmath40 , and the convolution integral used to transform this into the spectral representation , eq .",
    "( [ eq4 ] ) becomes @xmath41 where @xmath42 is now a green function with the correct analytic form , @xmath19 is complex and @xmath43 is real . @xmath44 and @xmath45 are the spectral functions associated with the pseudo - states and the free space states respectively , calculated with @xmath33 basis functions . the last term , @xmath46 , is the analytic free space green function given by @xcite @xmath47 where @xmath48 is the spherical bessel function of the first kind , @xmath49 is the spherical hankel function of the first kind and @xmath50 , where @xmath51 is the average potential within the unit cell . in practice",
    "the specific value of @xmath51 is not critical since the error term varies only slowly with the green function energy , as discussed in appendix  [ sec : appb ] .",
    "the normal derivative of the green function can be obtained by taking the radial derivative of the green function , and eq .",
    "( [ eq2 ] ) directly applied to give the embedding potential ( a factor of @xmath52 must be included to normalise the spherical harmonics over the embedding sphere ) .",
    "( [ eqa10 ] ) was not used due to problems with small errors in the green function introducing anomalous poles at the bottom of the lowest band .",
    "in this section we describe the all - electron calculation carried out in the region near the nucleus , using the embedding potential described above .",
    "the normal density functional framework is used , with the kohn - sham hamiltonian extended by the addition of the embedding terms .",
    "since these extra terms are functions of energy the eigenvalue solution of the hamiltonian is not simple , hence the charge density is obtained directly from the hamiltonian via the green function method as described by williams et al @xcite .",
    "the method employed in the all - electron calculation is similar to that used by other workers ( eg trioni et al @xcite ) , but generalised so as not to require any particular symmetry of the charge density or self - consistent potential , and to include core electrons .",
    "each basis function is a product of a radial function and a spherical harmonic , with the radial part defined as an augmented plane - wave for @xmath53 ( region @xmath54 ) and a spherical bessel function for @xmath55 ( region @xmath56 ) , where @xmath57 is a parameter of the calculation .",
    "these are chosen since linearised augmented plane waves ( lapw ) orbitals describe the all - electron valence states well near the nucleus , and in the region nearer the embedding radius the spherical bessel functions provide the flexibility required to satisfy the boundary conditions .    the basis functions in region @xmath54 are found by solving the dirac equation using numerical integration in the spherical part of the kohn - sham potential .",
    "the method used is that described by koelling and harmon @xcite , where the dirac equation is approximated in the form of a schrdinger equation which does not include spin - orbit interaction but takes other relativistic effects into account .",
    "a solution is found at a fixed ` pivot ' energy , @xmath58 , and the resultant radial functions are denoted @xmath59 .",
    "the energy derivative of these functions are also obtained and orthogonalised to the associated @xmath59 , and these orthogonalised energy derivatives are denoted @xmath60 ( see krasovskii @xcite , or takeda and kbler @xcite ) . in @xmath56",
    "the radial basis functions used are spherical bessel functions of the first kind , defined as @xmath61 where @xmath62 .",
    "the index @xmath63 is chosen to take integer values , to give a set of functions , and @xmath64 is a parameter of the calculation ( larger than @xmath4 to allow sufficient flexibility for the basis function to satisfy arbitrary boundary conditions )",
    ". the radial parts of the basis functions , @xmath65 are therefore @xmath66 parameters @xmath67 and @xmath68 are chosen to ensure @xmath69 is continuous in amplitude and derivative at the @xmath70 boundary .",
    "typically @xmath4 is chosen to be half the distance between nearest neighbour atoms in the lattice , @xmath71 and @xmath72 to give a good description of the valence electrons .",
    "for @xmath63 the range @xmath73 is typical .",
    "the embedded hamiltonian matrix is then expanded in terms of these basis functions , for a kohn - sham potential given by @xmath74 where @xmath22 , the index of the spherical harmonic .",
    "we write hamiltonian matrix , @xmath75 , as the sum of @xmath76 parts , @xmath77 with @xmath78 the contribution from region @xmath56 , @xmath79 the contribution from region @xmath54 , and @xmath80 the contribution from the embedding terms at the surface @xmath81 .",
    "integrating over region @xmath56 results in @xmath82   \\delta_{ll ' } \\nonumber\\\\ + \\sum_{l '' } s^l_{l'l '' } \\int_s^{r_s}r^2dr   \\left [ j_l(g_ir)v_{l''}(r)j_{l'}(g_jr ) \\right],\\end{aligned}\\ ] ] where @xmath83 are gaunt coefficients . for region",
    "@xmath54 we find a sum of spherical and aspherical terms @xmath84\\delta_{ll ' } \\nonumber\\\\ & & + \\sum_{l''\\neq0 } s^l_{l'l '' } \\int_0^{s}r^2dr \\chi_{il}(r ) v_{l''}(r ) \\chi_{jl'}(r)\\end{aligned}\\ ] ] where @xmath58 is the ` pivot ' energy at which @xmath59 is calculated , and the bra - ket s denote integration over region @xmath54 only .",
    "the integrals in the above expressions are carried out analytically or numerically as appropriate .",
    "taking the normal derivative and embedding potential terms in eq .",
    "( [ eq1 ] ) we obtain the contribution from the embedding terms , @xmath80 , as @xmath85    in addition to the hamiltonian matrix the overlap matrix of the basis functions , @xmath86 , is also required .",
    "this is given by @xmath87\\delta_{ll'}\\end{aligned}\\ ] ] where the first integral on the right hand side can be performed analytically @xcite and the second numerically .",
    "the green function of the embedded system is obtained directly by matrix inversion , @xmath88 where @xmath75 is the embedded hamiltonian described above . to obtain the local density of states , @xmath89",
    ", we apply the identity @xcite @xmath90 by filling all states to the fermi energy ( which is obtained from the original pseudopotential calculation using the linear analytic tetrahedron method ) we can obtain the valence charge density .",
    "unfortunately the number of points required to evaluate the charge density by integrating the local density of states is fairly high , due to its fine structure .",
    "this can be avoided be taking advantage of cauchy s theorem @xcite and the analytic properties of the green function .",
    "we choose a contour @xmath91 from some energy below the lowest eigenvalue , following a half circle into the positive complex plane and terminating on the real axis at the fermi energy , so the charge density expanded in spherical harmonics is given by @xmath92 where the @xmath93 are evaluated at the complex energies on the contour . in this equation @xmath94 is a gaunt coefficient , and is zero for @xmath95 or @xmath96 , so a @xmath97 hamiltonian matrix will result in a charge density containing components @xmath98 .",
    "it is due to the basis functions being complex that this expression does not simply involve the imaginary part of the green function matrix . as the imaginary part of the energy increases the green function becomes smoother and more featureless , hence a more sparse sampling is sufficient to approximate this integral accurately .",
    "gaussian integration @xcite is used to perform the integral along contour @xmath91 , and converged integrals are typically obtained for around @xmath99 points on the contour .",
    "the core states could be obtained by finding the discrete states of the embedded hamiltonian , but this would be cumbersome ( see appendix[sec : appa ] ) .",
    "core states are therefore obtained using the kohn - sham potential within the embedding sphere , and a constant potential outside of the sphere .",
    "this gives accurate results as the core states are strongly localised within the core region , so the potential outside of the embedding sphere is largely irrelevant .",
    "only the spherically symmetric part of the potential is used to obtain the states , and the constant potential outside the sphere is taken to be continuous with the spherical part .",
    "this spherically symmetric approximation has been used by many workers ( eg blaha et al @xcite ; methfessel and frota - pess @xcite ) , and can easily be extended to included aspherical effects perturbatively as described by ehmann and fhnle @xcite , sternheimer @xcite and lauer et al @xcite . to obtain the core charge density",
    "a fully relativistic treatment is used , solving the dirac equation within the embedding region .",
    "this approach allows the construction of core - states that are self - consistent within the embedded system , however the influence of core relaxation on the substrate system ( and so on the embedding potential ) is not considered .",
    "essentially we are assuming that the original pseudopotential approximation is valid , and that the valence pseudo - states are accurate outside of the core region . in order to go beyond this assumption",
    "it should be possible to obtain a new pseudopotential from the embedded core states and to iterate to full self - consistency , but this has not been implemented .",
    "similar considerations are discussed by blchl @xcite . it should be noted that for the embedding method applied here the core states are truly localised , since we are embedding an all - electron atom at one site within a lattice of pseudo - atoms .",
    "the kohn - sham potential , @xmath100 , is calculated from the total charge density via the local density approximation ( lda ) , and takes the form @xmath101 a sum of the nuclear potential , the hartree potential , and the exchange - correlation potential respectively .",
    "the nuclear potential is assumed to be that of a point charge centred at the nucleus , and the hartree potential , @xmath102 r'^2 dr ' \\nonumber\\\\ & & + \\frac{4\\pi}{2l+1 } r^l \\int_r^{r_s } \\left [ \\frac{1}{r'^{l+1 } } \\rho_{l}(r ' ) \\right ] r'^2 dr ' \\nonumber\\\\ & & + a_{l}r^l , \\label{eq8}\\end{aligned}\\ ] ] is obtained from poisson s equation .",
    "the constants @xmath103 are defined by the boundary condition that the kohn - sham potential , @xmath104 , be equal to the self - consistent potential of the original pseudopotential calculation on the embedding sphere .",
    "the lda is used to obtain the exchange - correlation potential from the charge density using the perdew and zunger parameterisation @xcite of the results of ceperly and alder @xcite ( this was also used in the original pseudopotential calculation ) .",
    "@xmath105 is a non - linear function of the charge density , so @xmath106 can not be directly obtained from @xmath107 .",
    "however , deviations from a spherical density are expected to be small , so we expand the exchange - correlation potential as a taylor series @xmath108 with @xmath109 the spherical part of the charge density .",
    "a truncation to linear order is sufficiently accurate ( the quadratic terms are negligible for the systems considered to date ) and can be applied directly .",
    "convergence to self - consistency is achieved , with instabilities controlled and convergence speed increased by applying broyden mixing @xcite .",
    "in order to test the effectiveness of the embedding method for core reconstruction we examine aluminium in the fcc structure .",
    "we begin by giving an example of the calculated embedding potentials , and some concrete evidence that the approximations made can give an accurate embedding potential .",
    "the initial self - consistent plane - wave calculation is carried using the lda , a plane - wave cut - off of @xmath110 ev and 60 @xmath15-points within the fcc irreducible wedge .",
    "these parameters are more than adequate to obtain effectively perfect convergence , so we can attribute any errors in the reconstruction to the embedding method .",
    "a kerker @xcite pseudopotential is used with a core radius @xmath111 , small enough for the core regions not to overlap .",
    "the resulting self - consistent potential is then used to obtain the full set of eigenstates by matrix diagonalisation for a plane - wave basis set @xmath112 , and at the @xmath15-points required to carry out the brillouin zone integral using the linear analytic tetrahedron method .",
    "these states are then used to construct the embedding potential , with the embedded sphere taken as the ` touching sphere ' radius , @xmath113 .",
    "the convergence behaviour of the embedding potential depends on the number of plane - waves in the basis , @xmath33 , the number of @xmath20-points in the irreducible wedge of the fcc brillouin zone , @xmath114 , and the spacing of energy points ( @xmath115 ) used to sample the spectral function , @xmath40 ( see eq .",
    "( [ eq4 ] ) ) .        fig .",
    "[ fig2 ] shows the @xmath116 matrix element for the imaginary part of the energy equal to @xmath117 ev .",
    "results are shown for @xmath118 ev and @xmath119 ev with linear interpolation of the spectral function , and for both @xmath120 and @xmath121 @xmath15-points in the irreducible wedge of the brillouin zone .",
    "there is very little discernable difference between the two results , @xmath122 for both the real and imaginary parts , hence we consider @xmath121 @xmath15-points as effectively converged .",
    "using @xmath123 @xmath15-points results in larger errors ( @xmath124 ) , but was found to be adequate for performing an accurate reconstruction , as discussed below .",
    "the difference between @xmath118 and @xmath110 ev is even smaller ( @xmath125 ) , and comparing @xmath119 ev to @xmath117 ev again gives a difference of @xmath126 .",
    "the other matrix elements show a similar convergence behaviour .",
    "embedding potentials for use in the reconstructions were therefore calculated with @xmath118 ev , @xmath119 ev and @xmath120 @xmath15-points , for energies required on the contour of integration ( eq .",
    "( [ eq6.1 ] ) ) .",
    "reconstructions were performed for @xmath127 , @xmath128 , @xmath129 bessel functions in the basis ( eq .",
    "( [ eq6 ] ) ) , and 16 points along the contour of integration .",
    "these provided the total charge density within the radius @xmath4 , the density of states within the embedded region , the self consistent potential and the core eigenstates .      before reconstructing the all - electron charge density ,",
    "we carry out a reconstruction in which no core states are included and the core and nucleus are described by a pseudopotential , the same kerker pseudopotential used in the original plane - wave calculations .",
    "this provides a stringent test of the accuracy and reliability of the entire embedding approach , since for a successful implementation the resulting valence charge density should be the same as the original plane - wave charge density throughout the embedding sphere .",
    "the fermi energy used within the reconstruction is obtained from the original plane - wave calculation , hence the total valence charge within the embedding sphere will be different from the plane - wave calculation , and the size of this difference provides a first indication of how accurate the reconstruction is .",
    "the original plane - wave calculation has @xmath130 electrons within the embedding sphere , whereas the reconstruction gives @xmath131 - an error of @xmath132 % .",
    "this close agreement suggests a successful reconstruction , however this is a fairly gross measure of success since it takes no account of the structure of the electron states within the embedding sphere and compares only the spherical part of the charge density .",
    ".errors in charge density for each reconstruction .",
    "pseudo refers to the reconstruction performed using a pseudopotential to represent core states , and all - electron refers to the full all - electron reconstruction .",
    "the pseudopotential core radius is @xmath111 , and the embedding sphere radius is @xmath133 .",
    "[ cols= \" < ,",
    "< , > , > \" , ]     a more demanding measure of the accuracy of the reconstruction is to compare the charge density and/or self consistent potential of the original pseudopotential calculation with the reconstruction .",
    "the error in the charge density is quantified as the peak error and the @xmath134 factor @xcite defined as @xmath135 and the errors over the whole embedding region are given in table [ tab1 ] .",
    "we also give the error within the shell between the core radius of the pseudopotential and the embedding sphere , which will allow comparison with the all - electron results .",
    "[ fig3]a shows a contour plot of @xmath136 , for both the original plane - wave and reconstructed charge density .",
    "these are taken in the @xmath137 plane , with the embedded atom at the centre and the square shown just enclosing the embedding sphere .",
    "there is excellent agreement between the original and reconstructed densities , again demonstrating a successful reconstruction .",
    "the total valence charge within the embedding sphere is @xmath138 electrons for the all - electron reconstruction , which again agrees very well with the original plane - wave result .",
    "as above we also compare the charge density of the original pseudopotential calculation with the reconstruction .",
    "for a successful reconstruction , the original pseudopotential charge density should agree with the reconstructed charge density for @xmath139 .",
    "[ fig3]b shows @xmath140 along a line in the @xmath141 $ ] direction for both the original plane - wave and all - electron reconstruction calculations , with the reconstructed atom at the origin .",
    "agreement between the two results is excellent in the region @xmath142 .",
    "the errors between @xmath6 and @xmath4 are given in table  [ tab1 ] , and these are similar to those of the pseudopotential reconstruction over the same region .    as well as the charge density ,",
    "errors in the self - consistent potential have also been considered .",
    "the reconstructed potential should agree with the original ( plane - wave ) potential outside of the core radius .",
    "the r - factor is smaller than for the charge density ( @xmath143 ) , largely due to the fact that the reconstructed and original self consistent potential are forced to agree at the embedding sphere .",
    "another quantity whose accuracy is important is the density of states ( dos ) .",
    "since there is a @xmath144 correspondence between the all - electron valence and pseudo - states , the eigenvalues are equal and the pseudopotential is norm conserving , then a successful reconstruction should yield an identical dos to the original results .",
    "the dos within @xmath4 is calculated from the plane - wave results by applying the tetrahedron method to obtain the local density of states , and integrating this over the volume contained by the embedding sphere . for the reconstructed dos a self consistent calculation",
    "is carried out , and the embedded green function obtained along a contour parallel to the real axis , with an imaginary energy of @xmath117 ev .",
    "the ldos is taken from the imaginary part of this green function , and integrated over the volume of the embedding sphere , hence the reconstructed dos is smoothed by a lorentzian of width @xmath117 ev , small enough for the fine structure to be apparent . in fig .",
    "[ fig4 ] the dos within the embedding sphere is shown , for pseudo and all - electron reconstructed states .",
    "agreement is excellent , with a maximum error of @xmath145 % .    )",
    "density of states within the embedding sphere .",
    "fermi energy is @xmath146 . ]",
    "the results given above for the all - electron reconstruction were reproduced for a number of different parameters of the embedding potential and reconstruction calculation to assess the convergence of the reconstructed results . in what follows",
    "we define a charge density as ` well converged ' when the associated @xmath134 value is less than @xmath147 % .",
    "first we consider the reconstruction calculation itself .",
    "convergence was easily achieved with respect to the parameters of the reconstruction calculation , that is , the number of basis functions in eq .",
    "( [ eq6 ] ) and the number of points on the contour integral in eq .",
    "( [ eq6.1 ] ) . the critical source of error in the reconstruction was found to be the number of spherical harmonics used in the basis , @xmath148 .",
    "a large enough value must be chosen for the green function within the reconstruction calculation to be converged , and so to provide an accurate valence charge density . for @xmath127 and @xmath149 ,",
    "@xmath150 % and @xmath151 % respectively , and although this represents an improvement in the reconstruction the difference between these two results very small .",
    "it should also be noted that the error introduced by a low @xmath148 is largely in the higher order aspherical components of the charge density - the lowest order terms present for aluminium ( @xmath152 ) are very well converged for @xmath127 .",
    "second we consider the convergence of the reconstruction with respect to the parameters of the embedding potential calculation .",
    "these are the number of @xmath153-points at which the ` band - structure ' is calculated , @xmath114 ; the plane - wave cut - off energy used in the calculations , @xmath37 ; and the interpolation of the spectral function applied in eq .",
    "( [ eq4 ] ) . in general",
    "it was found that the reconstructed charge density was well converged provided the embedding potential was well converged , as discussed at the beginning of this section .",
    "the two main points of interest are the convergence with respect to @xmath114 , and the sampling of the spectral function used to carry out the convolution integral .",
    "reconstructions were performed for the smallest four @xmath114 allowed within the linear analytic tetrahedron method , @xmath154 , @xmath123 , @xmath120 and @xmath121 in the irreducible wedge . for these , @xmath134 takes the values @xmath155 , @xmath156 , @xmath157 and @xmath158 % respectively , and there is no discernable difference between the charge densities for @xmath159 and @xmath121 , suggesting that convergence has been achieved for @xmath123 @xmath15-points .",
    "this results is significant since the embedding potential itself was not found to be particularly well converged for @xmath123 @xmath15-points .",
    "turning to the convolution integral , it was found that by sampling at energy intervals of @xmath160 ev below @xmath161 ev and @xmath162 ev above in eq.([eq4 ] ) , the reconstructed results are indistinguishable from those obtained by sampling at @xmath117 ev intervals throughout the energy range - @xmath134 takes the value @xmath163 % for the more sparse sampling and @xmath164 % for the finer sampling , and this difference is negligible .",
    "this coarse sampling reduces the number of points required from @xmath165 to @xmath166 , significantly reducing the computational effort required to construct the embedding potential . with this sampling ,",
    "if , for example , the energy cut - off is increased from @xmath167 ev to @xmath168 ev the computational requirements are increased only by a factor of @xmath169 , no matter how many bands are included in the calculation .",
    "so far we have not justified using a linear interpolation of the spectral function in order to carry out the convolution integral in sec .",
    "[ sec : green ] .",
    "when reconstruction results are compared for a linear and cubic interpolation , and for a range of sampling intervals , it is found that in the useful range ( ie a fine enough sampling for accurate results ) cubic interpolation gives results only marginally better , or even slightly worse than linear interpolation .",
    "this is probably due to the spectral function not being well approximated by a polynomial , so a higher order interpolation can give worse results than a low order method @xcite",
    ". it would be desirable to find a better interpolating function , but the diverse analytic structure due to van hove singularities , and the requirement that an integral of the form eq .",
    "( [ eq4 ] ) must be solved analytically , makes this a non - trivial task .",
    "a general method has been described for taking the results of a pseudopotential calculation for a given system and obtaining the correct all - electron charge density in the core region of a single atom .",
    "the reconstruction method provides correctly relaxed core states ( they are not frozen to the isolated atom core states ) and is in principle applicable to any system that can be analysed with plane - wave pseudopotential methods .    the embedding potential method derived by inglesfield @xcite is used , and a new analytic expression for the embedding potential is given here .",
    "past applications of the embedding potential method have generally been limited to models where the embedding potential is that of free space , or an arbitrary model embedding potential .",
    "this is essentially due to the difficulty of obtaining an accurate real space green function for a realistic system - the handful of cases where a green function ( and so embedding potential ) have been obtained from _ ab initio _ calculations rely on the properties of electron structure calculations that themselves employ a green function ( for example see thisjssen and inglesfield@xcite , miller et al@xcite , inglesfield@xcite , crampin et al@xcite or ishida@xcite ) .",
    "it has been found that in order to construct an accurate real space green function ( and so embedding potential ) using the spectral representation a complete set of eigenstates must be included , and here this has been taken into account by a linear interpolation of the band structure in @xmath20-space and approximating the infinite number of high energy bands that are not available as plane - wave states .",
    "this results in an approximation that will converge to the correct form and is accurate for a realisable number of bands and @xmath20-points .    using this embedding method a localised all - electron atomic calculation",
    "is carried out that does not require any assumption of spherical symmetry in the potential necessary for previous solutions to this problem , and in essence makes the same physical and mathematical approximations as state of the art all - electron density - functional methods such as the flapw method .",
    "results of tests for aluminium are good - the original pseudopotential results can be reconstructed with negligible error , and the all - electron results are as accurate .",
    "in addition to this the reconstruction accurately reproduces the density of states of the original substrate system .",
    "the major computational cost of performing a reconstruction lies not in the reconstruction itself , but in the calculation of the full set of states ( ie band - structure ) required to obtain an accurate real space green function . for larger systems",
    "the computational cost of obtaining the embedding potential from these states and performing the reconstruction calculation are not expected to increase significantly , but the cost of performing the matrix diagonalisation used to obtain the full set of states could become prohibitive , scaling as @xmath170",
    ". it would be advantageous to calculate the real space green function more efficiently , and it may be possible to achieve this by applying iterative diagonalisation methods . provided a full set of states of the self - consistent potential can be obtained , we expect the method presented here to be applicable to any system .    in a future paper @xcite this method will be applied to the all - electron reconstruction of the core region for bulk si , with the resulting charge density compared with accurate experimental measurements of the structure factors and the results of flapw calculations .",
    "this work has been supported by united kingdom engineering and physical sciences research council .",
    "we thank s. crampin and j. e. inglesfield for helpful discussions .",
    "here we give a brief derivation of the embedding potential method of inglesfield @xcite .",
    "this is presented to shed some light on the properties of the method , specifically the requirement that the embedding potential be an analytic function defined even where no states exist in the substrate system .",
    "a slightly different route is taken in the derivation of the embedding potential itself , which yields the same expressions found previously@xcite , together with a new expression .",
    "[ fig1 ] shows the regions @xmath0 , where the new embedded states are obtained , and region @xmath2 , the original substrate .",
    "although the diagram shows the surface @xmath1 as a sphere , this derivation also applies to any other surface .",
    "we proceed by finding the expectation value of the energy of a trial function defined in @xmath2 as the solution of the schrdinger equation for the substrate at some energy @xmath171 , @xmath172 , and in @xmath0 as a trial function @xmath173 .",
    "this energy is then expressed in a form that is dependent only on @xmath174 within region @xmath0 and the substrate green function on the surface , @xmath1 .",
    "the variational principle is then applied to obtain a schrdinger equation which gives a solution in region @xmath0 that correctly matches onto the solution in region @xmath2 .",
    "this is a normal schrdinger equation defined in @xmath0 only and with the addition of terms that are non - zero only at the surface @xmath3 .",
    "the equation for @xmath172 in @xmath2 is @xmath175 hence the expectation value of the energy is given by    @xmath176    where @xmath177 is the hamiltonian and the spatial variable is suppressed .",
    "the surface integral in the numerator is a consequence of the discontinuity in the trial function at @xmath1 and green s theorem , and can be interpreted as the contribution to the kinetic energy from this discontinuity .",
    "this expression has been used to apply the variational method to trial functions with discontinuities at a surface @xcite , but an additional condition @xmath178 is chosen here .",
    "it should be noted that no reduction in generality is introduced by requiring this condition to be satisfied since the solution in @xmath2 is not explicitly described at any point in the derivation .    in order to carry out a calculation localised to region @xmath0 all explicit dependence of @xmath19 on @xmath179",
    "must be removed .",
    "first we remove the integral of @xmath179 over region @xmath2 using the expression @xcite @xmath180 \\label{eqa3}\\ ] ] which is an aspherical generalisation of the similar expression that describes the transferability of norm - conserving pseudopotentials @xcite .",
    "this leaves the energy @xmath19 dependent on @xmath179 only through the normal derivative at the surface .",
    "we express this normal derivative in terms of @xmath179 on the surface @xmath1 as @xcite @xmath181 the function @xmath182 is the embedding potential , and by inserting eq.([eqa2],[eqa3],[eqa4 ] ) into eq .",
    "( [ eqa1 ] ) we obtain the energy of the entire system expressed entirely in terms of the trial function @xmath174 in region @xmath0 .",
    "the fact that an expression of the form eq .",
    "( [ eqa4 ] ) exists is the heart of the embedding method .",
    "the condition that @xmath19 is stationary with respect to small changes @xmath183 gives the equation @xmath184 for @xmath174 .",
    "this takes the form of a normal schrdinger equation with three additional terms - the derivative term and the two surface integrals on the left hand side .",
    "these extra terms take the form of a non - local potential that acts only at the surface @xmath1 .    in deriving eq .",
    "( [ eqa5 ] ) the energy @xmath19 has not been minimised with respect to variations in @xmath171 , hence @xmath171 still appears in the effective schrdinger equation as a free parameter . as a consequence of this the energy derivative term is present , a first order correction to the energy at which the embedding potential is evaluated .",
    "this _ embedded schrdinger equation _ will give the @xmath174 in region @xmath0 that is continuous with a solution in region @xmath2 of energy @xmath171 such that the combined trial function has the lowest expectation value of energy .",
    "if the expectation value of the energy is further minimised with respect to @xmath171 , then the combined trial function will be the eigenfunction of the complete system of eigenenergy @xmath185 @xcite . in practice",
    "this requires the eigenenergy of the solution to be known before the equation can be directly solved , or iterative methods to be applied .    within a continuum eq .",
    "( [ eqa5 ] ) takes a simpler form as the energy of the state required can be chosen from the outset , and the first order correction is zero . in this case the embedded hamiltonian for a state of energy @xmath19 can be written @xmath7 \\label{eqa6}\\ ] ] where @xmath8 is the embedded hamiltonian that yields the states with correct boundary conditions , and @xmath9 is the normal hamiltonian for region @xmath0",
    ". the notation has been modified at this point such that @xmath186 acting on a function denotes the integration over the surface @xmath1 , as in eq.([eqa5 ] ) .      in the above discussion",
    "the embedding potential , @xmath10 , is defined only implicitly with no explicit form given ( or proof that any such operator exists ) .",
    "we now derive general forms for the embedding potential in terms of the single particle green function in region @xmath2 .",
    "we start with the defining equation for the green function in region @xmath2 , @xmath187 multiplying this by @xmath179 , and the schrdinger equation for @xmath179 by @xmath188 , subtracting the two , integrating over region @xmath2 and applying green s theorem gives @xcite @xmath189 where the surface integrals are represented as matrix multiplications .",
    "this implies a representation of the spatial dependence in terms of a set of basis functions which are orthonormal over the surface @xmath1 ; @xmath13 denotes this representation .",
    "it is straightforward to show that for this representation the matrix product corresponds to the integration over the surface @xmath190 .",
    "the prime indicates that the normal derivative of the green function is taken with respect to the second spatial variable .",
    "the embedding potential required for the embedded schrdinger equation ( eq .  ( [ eqa6 ] ) )",
    "is the operator that gives the normal derivative of a wavefunction on @xmath1 in terms of its value on @xmath1 , or @xmath191 where @xmath10 is the matrix representation of the embedding potential operator .",
    "equations ( [ eqa7 ] ) and ( [ eqa8 ] ) lead immediately to the expression @xmath192 this general expression for @xmath10 is the same as that originally derived by green function matching techniques @xcite and for von neumann boundary conditions reduces to the definition given by inglesfield in his original paper .",
    "a second expression may be obtained by taking the normal derivative of eq .",
    "( [ eqa7 ] ) with respect to the @xmath193 spatial variable , and rearranging this to give @xmath194 which is an alternative and equally valid expression to eq.([eqa9 ] ) for the embedding potential in terms of a green function satisfying arbitrary boundary conditions on @xmath1 .",
    "for dirichlet boundary conditions ( @xmath195 for @xmath196 or @xmath197 @xmath198 @xmath1 ) this reduces to the form given by fisher @xcite .",
    "finally , we note that at first glance the defining equation ( [ eqa8 ] ) appears to suggest that the embedding potential can be defined in terms of the eigenstates of the substrate system . however , this is not the case as eq .",
    "( [ eqa8 ] ) must be true for all energies in order to apply the variational principle , even where there are no substrate eigenstates .",
    "in addition to this the eigenstates of the embedded system are complex in the presence of a continuum of substrate states , hence the embedding potential must be an analytic function ( for further discussion see trail@xcite ) .",
    "in order to assess the properties of the error introduced by lack of completeness of the spectral representation , the free electron case is examined .",
    "since the high energy bloch states should be essentially free in character , it seems reasonable that this should give an indication of the error introduced by applying the incomplete spectral representation to a real system .",
    "we calculate the error as the contribution to the green function from states of energy greater than some maximum value , @xmath199 , using an extended zone scheme and an expansion in spherical harmonics .",
    "the free electron green function is spherically symmetric , this is also the case for the error , so both matrices are diagonal and independent of the @xmath200 index . in what follows only one index",
    "is shown , the @xmath200 index is suppressed and the error term is denoted @xmath201 .",
    "the @xmath40 matrix for free space is given by the imaginary part of the green function for a free electron , or @xmath202 where @xmath203 and is real @xcite . from this the error in the green function , @xmath201 , can be calculated by applying the convolution integral ( eq .",
    "( [ eq4 ] ) ) to the high energy states to give @xmath204 where the radial variables have been set equal to the embedding sphere radius , @xmath4 . for @xmath205 ( true for all @xmath206",
    "we are interested in ) a taylor expansion can be used to give the series @xmath207 where @xmath208 these integrals can be carried out analytically by repeated integration by parts , to give solutions of the form @xmath209 where the second term is small for @xmath210 .    since we also require the normal derivative of the green function at the surface ( see sec .",
    "[ sec : embedding ] ) , the error in this is derived in the same way . we denote the coefficients of the normal derivative series expansion by @xmath211 , and find @xmath212 \\frac{1}{k_0^{2n+1 } } & \\nonumber\\\\ & + o\\left ( \\frac{1}{k_0^{2n+2 } } \\right)+ \\delta_{n,0 } \\left\\ { \\begin{array}{ll } -1/2 r_s^2 & r ' = r_s+0^{+ } \\\\ \\ 1/2 r_s^2 & r ' = r_s+0^{- } \\end{array } \\right .   & \\label{eqb2}\\end{aligned}\\ ] ] where @xmath213 and the last term on the right hand side is a step function whose value depends on which side we take the limit of @xmath214 in eq .  ( [ eqb1 ] ) .",
    "this step function is the source of the cusp necessary for the correct analytic form of a green function , and will not be present in the incomplete spectral representation .    for reasonable values of @xmath215",
    "we find that the errors in both @xmath13 and @xmath216 are nearly constant in @xmath206 , so for convenience we examine the errors at @xmath217 and @xmath218 .",
    "[ fig5]a shows the real part of the analytic green function and its normal derivative , as a function of real @xmath19 and for @xmath218 . alongside this , in fig.[fig5]b ,",
    "the error in the green function and its normal derivative are shown as a function of @xmath215 , and at @xmath219 .",
    "these are obtained by evaluating @xmath220 and @xmath221 analytically .",
    "it is apparent that the errors are significant and that convergence with respect to the energy cut - off is slow . for",
    "the normal derivative the error does not converge to zero with increasing @xmath215 due to the step function in eq .",
    "( [ eqb2 ] ) .",
    "for @xmath222 the errors show a similar behaviour .",
    "m. c. payne , m. p. teter , d. c. allan , t. a. arias and j. d. joannopoulos , rev .",
    "phys . * 64 * , 4 1045 ( 1992 ) . g. j. hill , j. m. keartland , m. j. r. hoch and h. haas , phys .  rev .",
    "b * 58 * , 13614 ( 1998 ) .",
    "p. e. blchl , phys .",
    "b * 50 * , 17953 ( 1994 ) .",
    "s. a. turzhevsky , d. l. novikov , v. a. gubanov and a. j. freeman , phys .",
    "b * 50 * , 3200 ( 1994 ) .",
    "t. huhne , c. zecha , h. ebert , p. h. dederichs and r. zeller , phys .",
    "b * 58 * , 10236 ( 1998 ) . c. m. goringe , d. r. bowler and e. hernndez , rep .",
    ".  phys . * 60 * , 1447 ( 1997 ) .",
    "j. r. gardner and n. a. w. holzwarth , phys.rev .",
    "b * 33 * , 10 7139 ( 1986 ) . j. vack and a. imunek , j.phys.:condens .",
    "matter * 6 * , 3025 ( 1994 ) .",
    "v. kuzmiak , j.zavadil and k. nsk , phys .",
    "sol.(b ) * 168 * , 547 ( 1991 ) .",
    "b. meyer , k. hummler , c. elssser and m. fhnle , j.phys . : condens .",
    "matter * 7 * , 9201 ( 1995 ) .",
    "j. e. inglesfield , j.phys .",
    "c * 14 * , 3795 ( 1981 ) .",
    "a. r. williams , p. j. feibelman and n. d. lang , phys .",
    "b * 26 * , 10 5433 ( 1982 ) .",
    "a. j. fisher j.phys .",
    "c * 21 * , 3229 ( 1988 ) .",
    "m. morse and h. feshbach , _ methods of theoretical physics _ ( plenum press , new york , 1953 ) .",
    "g. lehman and m. taut , phys .",
    "sol.(b ) * 54 * , 469 ( 1972 ) .",
    "o. jepson and o. k. anderson , solid  statecommun .",
    "* 9 * , 1763 ( 1971 ) .",
    "a. h. macdonald , s. h. vosko and p.t .",
    "coleridge , j.phys .",
    "c * 12 * , 2991 ( 1978 ) .",
    "j. rath and a. j. freeman , phys .",
    "b * 11 * , 6 2109 ( 1975 ) .",
    "s. kaprzyk and p. e. mijnarends , j.phys .",
    "c * 19 * , 1283 ( 1986 ) .",
    "j. r. trail , _ core reconstruction in pseudopotential calculations _ , phd thesis , university of bath , 1998 .",
    "p. j. davis and p. rabinowitz , _ numerical integration _",
    "( academic press , new york , 1967 ) .",
    "lambin and j. p. vigneron , phys .",
    "b * 29 * , 6 3430 ( 1984 ) .",
    "r. james and s. m. woodley , solid  statecommun .",
    "* 97 * , 11 935 ( 1996 ) .",
    "m. abramowitz and i. a. stegun , _ handbook of mathematical functions _ ( u.s . government printing office , washington d.c . , 1964 ) .",
    "m. i. trioni , g. p. brivio , s. crampin and j. e. inglesfield , phys .",
    "b * 53 * , 12 8052 ( 1996 ) .",
    "d. d. koelling and b. n. harmon , j.phys .",
    "c * 10 * , 3107 ( 1977 ) .",
    "e. e. krasovskii , phys .  rev .",
    "b * 56 * , 20 12866 ( 1997 ) . t. takeda and j. kbler , j.phys .",
    "f * 9 * , 4 661 ( 1979 ) .",
    "e. n. economou , _",
    "green s functions in quantum physics _ ( springer - verlag , berlin , 1990 ) w. h. press , s. a. teukolsky , w. t. vetterling and b. p. flannery , _ numerical recipes _",
    "( cambridge university press , cambridge , 1994 ) .",
    "p. blaha , k. schwarz and p. h. dederichs , phys.rev .",
    "b * 37 * , 2792 ( 1988 ) .",
    "m. s. methfessel and s. frota - pess , j.phys . :  condens .",
    "matter * 2 * , 149 ( 1990 ) .",
    "j. ehmann and m. fhnle , phys .",
    "b * 55 * , 12 7478 ( 1997 ) .",
    "r. m. sternheimer , z. naturforsch * 41a * , 24 ( 1986 ) . s. lauer , v. r. marathe and a. trautwein , phys.rev .",
    "a * 19 * , 5 1852 ( 1979 ) .",
    "j. p. perdew and a. zunger , phys .",
    "b * 23 * , 10 5048 ( 1981 ) .",
    "d. m. ceperly and b. j. alder , phys .",
    "* 45 * , 566 ( 1980 ) . c. g. broyden , math",
    ".  comput . * 19 * , 577 ( 1965 ) .",
    "d. d. johnson , phys .",
    "b * 38 * , 18 12807 ( 1988 ) .",
    "g. p. kerker , j.phys .",
    "c * 13 * , l189 ( 1980 ) . j. m. thisjssen and j. e. inglesfield , europhys . lett .",
    "* 23 * , 65 ( 1994 ) .",
    "n. c. miller , p. m. lee and j. e. inglesfield , phil .  mag . * 51 * , 209 ( 1985 ) .",
    "j. e. inglesfield , j.  phys .",
    "f * 11 * , l287 ( 1981 ) .",
    "s. crampin , j. b. a. n. van hoof , m. nekovee , j. e. inglesfield , j. phys . :",
    "matter * 4 * 1475 ( 1992 ) .",
    "h. ishida , surf .",
    "science * 388 * , 71 ( 1997 ) .",
    "j. r. trail and d. m. bird , phys .",
    "b * 60 * , 7875 ( 1999 ) .",
    "a. j. fisher , j.phys . :  condens .  matter * 2 * , 6079 ( 1990 ) .",
    "k. r. brownstein , j.math .",
    "36 * , 1 76 ( 1995 ) .",
    "g. b. bachelet , d. r. hamann and m. schlter , phys .",
    "b * 26 * , 8 4199 ( 1982 ) .",
    "f. garcia - moliner and j. rubio , j.phys .",
    "c * 2 * , 1789 ( 1969 ) .",
    "j. e. inglesfield , j.phys .",
    "c * 4 * , l14 ( 1971 ) ."
  ],
  "abstract_text": [
    "<S> a new method is presented for obtaining all - electron results from a pseudopotential calculation . </S>",
    "<S> this is achieved by carrying out a localised calculation in the region of an atomic nucleus using the embedding potential method of inglesfield [ j.phys .  </S>",
    "<S> c * 14 * , 3795 ( 1981 ) ] . in this method </S>",
    "<S> the core region is _ reconstructed _ , and none of the simplifying approximations ( such as spherical symmetry of the charge density / potential or frozen core electrons ) that previous solutions to this problem have required are made . </S>",
    "<S> the embedding method requires an accurate real space green function , and an analysis of the errors introduced in constructing this from a set of numerical eigenstates is given . </S>",
    "<S> results are presented for an all - electron reconstruction of bulk aluminium , for both the charge density and the density of states . </S>"
  ]
}