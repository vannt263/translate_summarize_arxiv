{
  "article_text": [
    "constraint - preserving boundary conditions is an active research topic in numerical relativity . during the first half of this decade ,",
    "many conditions have been proposed , adapted in each case to some specific 3 + 1 evolution formalism : fritelli - reula  @xcite , kst  @xcite , bssn - nor  @xcite , or z4  @xcite .",
    "the focus changed suddenly after 2005 by the impact of a breakthrough : the first long term binary - black - hole simulation , which was achieved in a generalized - harmonic formalism  @xcite .",
    "a series of constraint - preserving boundary conditions proposals in this framework started then  @xcite , and continues today  @xcite .",
    "we will retake in this paper the 3 + 1 approach to constraint - preserving boundary conditions , following the way opened very recently for the bssn case  @xcite .",
    "more specifically , we will revisit the z4 case , not just because of its intrinsic relevance , but also for its relationship with other 3 + 1 formulations ( bssn , kst , see refs .",
    "@xcite for details ) . also , the close relationship between the z4 and the generalized - harmonic formulations suggest that our results could provide a different perspective in this other context .",
    "this was actually what happened with the current constraint - damping terms : first derived in the z4 context  @xcite and then applied successfully in generalized - harmonic simulations  @xcite .",
    "our results are both at the theoretical and the numerical level . in section",
    "ii , we consider the first - order z4 formalism in normal coordinates ( zero shift ) for the harmonic slicing case . this case was known to be symmetric - hyperbolic for a particular choice of the parameter which controls the ordering of space derivatives  @xcite .",
    "we extend this result to a range of this ordering parameter , by providing explicitly a positive - definite energy estimate .",
    "then we use this estimate for deriving algebraic constraint - preserving boundary conditions both for the energy and the normal momentum components .    in section iii",
    "we consider the dynamical evolution of constraint violations ( subsidiary system ) .",
    "following standard methods  @xcite , we transform algebraic boundary conditions of the subsidiary system into derivative boundary conditions for the main system . we introduce a new basis of dynamical fields in order to revise the constraint - preserving conditions proposed in refs .",
    "@xcite for the z4 formalism , including also a new coupling parameter which affects the propagation speeds of the ( modified ) incoming modes . in the case of the energy constraint",
    ", we get a closed subsystem for the principal part , allowing an analytical stability study at the continuum level which is presented in appendix b.    a simple numerical implementation of the proposed conditions is given in section iv , where we test the stability in the linear regime , by considering small random - noise perturbations aroun flat space ( robust stability test ) .",
    "the results show the numerical stability of the proposed boundary conditions in this regime for many different combinations of the parameters .",
    "the space discretization scheme is the simplest one with the summation - by - parts ( sbp ) property  @xcite . in this way we avoid masking the effect of our conditions ( at the continuum level ) with the effect of more advanced space - discretization algorithms , like fdoc  @xcite devised to reduce the high frequency noise level in long - term simulations , which has recently been applied to the black - hole case  @xcite . for a comparison ,",
    "we run also with periodic boundary conditions , where the noise level keeps constant .",
    "the proposed boundary conditions produce instead a very effective decreasing of ( the cumulated effect of ) energy and momentum constraint violations . in the case of cartesian - like grids",
    ", we also compare the standard a la olsson treatment  @xcite , with a modified numerical implementation which does not use the corner and vertex points , avoiding in this way some stability issues and providing much cleaner evidence of constraint preservation .    in section",
    "v , we test the non - linear regime with the gowdy waves  @xcite metric , one of the standard numerical relativity code tests , as we have done recently for the energy constraint case  @xcite .",
    "we endorse in this way some recent claims ( by winicour and others ) that the current code cross - comparison efforts  @xcite should be extended to the boundaries treatment .",
    "a convergence test is performed against this exact strong - field solution , showing the expected convergence rate ( second order for our simple sbp method ) .",
    "testing the proposed boundary conditions results into a stable and constraint - preserving behavior , in the sense that energy and momentum constraint violations remain similar or even smaller than the corresponding effects with exact ( periodic or reflection ) boundary conditions for the gowdy metric .",
    "we will consider here the z4 evolution system : @xmath0 more specifically , we will consider the first - order version in normal coordinates , as described in refs .",
    "@xcite . for further convenience",
    ", we will recombine the basic first - order fields @xmath1 in the following way : @xmath2 so that the new basis is @xmath3 .",
    "note that the vector @xmath4 can be recovered easily as @xmath5    with this new choice of basic dynamical fields , the principal part of the evolution system gets a very simple form in the harmonic slicing case : @xmath6 where the dots stand for non - principal contributions , and we have noted for short @xmath7\\,,\\ ] ] where @xmath8 is a space - derivatives ordering parameter and round brackets denote index symmetrization .",
    "the first - order version of the z4 system is known to be symmetric - hyperbolic in normal coordinates with harmonic slicing , at least for the usual ordering @xmath9  @xcite .",
    "it follows from ( [ evol a]-[evol e ] ) that this result can be extended to the following range of the ordering parameter @xmath10 which covers the symmetric ordering case ( @xmath11 ) .",
    "the corresponding symmetrizer , or energy estimate , can be written as : @xmath12 where we have noted for short @xmath13 allowing for ( [ evol a]-[evol e ] ) , we get @xmath14 and the divergence theorem can be used in order to complete the proof . the positivity proof for @xmath15 for the interval ( [ range ] )",
    "is given in appendix a.      we can consider now some specific space surface , in order to identify the constraint modes by looking at the evolution equations for @xmath16 and @xmath4 in the system ( [ evol a]-[evol e ] ) .",
    "it follows from ( [ evol b ] , [ evol c ] ) that the energy - constraint modes are given by the pair @xmath17 with propagation speed @xmath18 ( the index @xmath19 meaning the projection along the unit normal @xmath20 ) . also , allowing for ( [ zfrom mu],[evol e ] ) , we can easily recover the evolution equation for @xmath4 , namely @xmath21 so that we can identify the momentum - constraint modes with the three pairs , with propagation speed @xmath18 , @xmath22 note that , allowing for ( [ pimu a ] ) , the normal component @xmath23 does correspond with the transverse - trace component of the extrinsic curvature @xmath24 .",
    "we give for completeness the remaining modes , the fully tangent ones , with propagation speed @xmath18 , @xmath25 ( capital indices denote a projection tangent to the surface ) , and the standing modes ( zero propagation speed ) : @xmath26      we can take advantage of the positive - definite energy estimate ( [ eestimate ] ) in order to derive suitable algebraic boundary conditions .",
    "we can integrate ( [ div term ] ) in space and , by applying the divergence theorem , we get a positivity condition for the boundary terms , namely @xmath27 where @xmath28 stands for the boundary surface ( @xmath29 being here its outward normal ) .",
    "the contribution of the fully tangent modes ( [ transverse pairs ] ) , independent of the energy and momentum sectors , is given by @xmath30\\,,\\ ] ] so that the contribution of these modes to the boundary term in ( [ bound term ] ) will be non - negative if we impose the standard algebraic boundary - conditions : @xmath31 the case @xmath32 corresponding to maximal dissipation .",
    "a less strict condition is obtained by adding an inhomogeneous term , namely @xmath33 this can cause some growth of the energy estimate but , provided that the array @xmath34 consists of prescribed spacetime functions , the growth rate can be bounded in a suitable way so that a well - posed system can still be obtained ( see for instance refs .",
    "@xcite ) .",
    "this simple strategy , when applied to the energy and momentum modes ( [ energy pair ] , [ momentum pairs ] ) is not compatible with constraint preservation in the generic case ( see also ref .",
    "@xcite ) . for the energy sector ,",
    "constraint preservation is obtained only for the extreme case : @xmath35 which will reflect energy - constraint violations back into the evolution domain .",
    "these conditions would be then of a limited practical use in realistic simulations",
    ".    a different approach can be obtained by realizing that the contribution to the boundary term in ( [ bound term ] ) would have the right sign if one uses the following logical gate condition : @xmath36 ( @xmath16-gate in ref .",
    "it is clear that the boundary condition ( [ thetagate ] ) preserves the energy constraint , as it modifies just the @xmath16 values , by setting them to zero when the condition is fulfilled , without affecting any other dynamical field .",
    "the same strategy can work for normal components of the momentum modes ( [ momentum pairs ] ) , at least for the symmetric choice of the ordering parameter .",
    "allowing for ( [ lambda ] ) , one has @xmath37 so that a constraint - preserving ( reflection ) condition can be obtained in the extreme case as well . in the logical gate approach , the contribution of the modes ( [ znmode ] ) to the boundary term in ( [ bound term ] ) will have the right sign if one uses the condition ( case @xmath11 only ) : @xmath38 which clearly preserves the normal component of the momentum constraint .    for the tangent momentum modes @xmath39 ( tangent to the boundary surface ) ,",
    "however , the contribution in ( [ bound term ] ) will be @xmath40 where @xmath41 is inhomogeneous in @xmath42 for any value of the ordering parameter .",
    "moreover , the inhomogeneous terms are not prescribed functions , but rather some combinations of dynamical fields . a different strategy",
    "must then be devised in this case , as we will see below .",
    "the time evolution of the energy - momentum constraints can be easily derived by taking the divergence of the z4 field equations ( [ z4 ] ) , that is @xmath43 we can write down the second order equation ( [ wavez ] ) as a first order system and impose then maximally dissipative boundary conditions on ( the first derivatives of ) the @xmath44 components . in this way",
    ", the boundaries will behave as one - way membranes for constraint - violating modes , at least for the ones propagating along the normal direction @xmath20 .",
    "the procedure can be illustrated with the energy - constraint , that is the time component of ( [ wavez ] ) : @xmath45 a first - order version can be obtained as usual by considering first - order derivatives as independent quantities , namely @xmath46 we can write then ( [ thetasub ] ) as the following first - order symmetric - hyperbolic system @xmath47    boundary conditions for ( the incoming modes of ) the subsidiary system can be enforced then in the standard way .",
    "we will consider here for simplicity the maximal dissipation condition , that is ( we assume that the boundary is on the right ) : @xmath48 now we can use it as a tool for setting up boundary conditions for the energy modes of the main evolution system .",
    "one can for instance enforce directly ( [ thetabound ] ) , as in ref .",
    "@xcite .",
    "we will rather use ( [ thetabound ] ) as a tool for getting ( derivative ) boundary conditions for the incoming energy mode of the evolution system ( [ evol a ] - [ evol e ] ) . to do this",
    ", we can use the evolution equation ( [ evol b ] ) for transforming ( [ thetabound ] ) into a convenient version of the energy constraint , namely : @xmath49 we can now use ( [ energy constraint ] ) in order to modify the evolution equation of the incoming energy mode @xmath50 , that is : @xmath51 the whole process is equivalent to the simple replacement : @xmath52 where @xmath53 is the solution of the advection equation ( [ thetabound ] ) .",
    "the choice @xmath54 corresponds to the standard recipe  @xcite of trading space normal derivatives by time derivatives , in the incoming modes .",
    "this implies that the modified mode gets zero propagation speed along the given direction @xmath55 . in this case , allowing for ( [ e- modif ] ) , the time derivative of @xmath50 would actually vanish , modulo non - principal terms ; this amounts to freezing the incoming modes to their initial values ( maximal dissipation on the right - hand - side ) , which is a current practice in some numerical relativity codes .",
    "note however that constraint preservation requires using the right non - principal terms , that can be deduced from the full expression ( [ e- repl ] ) .",
    "the choice @xmath56 would imply instead that the modified mode gets the same positive speed ( @xmath57 ) than the outgoing one @xmath58 .",
    "we show in appendix b that this choice will lead to a weakly - hyperbolic ( ill - posed ) boundary system .",
    "our results confirm that @xmath54 is actually a safe choice  @xcite , although other values in the interval @xmath59 lead also to a strongly hyperbolic system with non - negative speeds for all energy modes ( see appendix b for details ) .",
    "the same method can be applied to the momentum constraint modes , although in a less straightforward way . let us start from the evolution equation ( [ evol z ] ) for @xmath4 , and",
    "take one extra time derivative .",
    "we get in this way @xmath60 which , after some cross - derivatives cancellations , leads to the space components of ( the principal part of ) the covariant equation ( [ wavez ] ) .    a first - order version of ( [ zsub ] )",
    "can be obtained again by considering first - order derivatives as independent quantities . for the time derivative we will take the obvious choice @xmath61 the treatment of space derivatives , however , is complicated by the fact that we are dealing with a first - order formulation , so that there are additional ordering constraints to be allowed for . following refs .",
    "@xcite , we will define for further convenience @xmath62}- \\partial_{[\\,k}\\,d_{i ] }   - ( 1-\\zeta)\\,\\gamma^{rs}\\,\\partial_{[\\,r}\\,d_{k]\\,is }   + ( 1+\\zeta)\\,\\gamma^{rs}\\,\\partial_{[\\,r}\\,d_{i]\\,ks}\\,,\\ ] ] where we have noted for short @xmath63 .",
    "a closer look to ( [ zkiexplicit ] ) shows that @xmath64 is just the space derivative of @xmath4 , modulo ordering constraints . in the notation of this paper : @xmath65 }      + ( 1+\\zeta)~[\\,\\partial_r\\,{\\mu_{(ki)}}^r+\\partial_{(k}\\ , z_{i)}\\ , ]      + \\cdots\\ ] ]    we can write now ( [ zsub ] ) in the first - order form @xmath66 which is a symmetric - hyperbolic first - order version of the momentum - constraint evolution system ( other versions could be obtained by playing with the ordering constraints in a different way ) . the vanishing of the incoming modes of this subsidiary system can be enforced now in the same way as for the energy constraint , namely : @xmath67 this is obviously a maximal dissipation constraint - preserving condition for the subsidiary system , which can be used for to get a derivative boundary condition for the main evolution system , as we did for the energy modes in the preceding subsection . to be more specific",
    ", we can use the evolution equation ( [ evol z ] ) for transforming ( [ zbound ] ) into a convenient version of the momentum constraint , that is @xmath68     + \\cdots \\label{momentum constraint}\\end{aligned}\\ ] ] and use it for modifying the evolution equation of the incoming momentum modes @xmath69 , namely : @xmath70 which amounts to the following replacement : @xmath71 where @xmath72 is the solution of the advection - like equation ( [ zbound ] ) .    the choice @xmath54 would imply again that the modified modes get zero propagation speeds along the normal direction , whereas the choice @xmath73 would imply instead that the modified modes get the same positive speed ( @xmath57 ) than the outgoing ones @xmath74 .",
    "this result requires the extra ordering terms in ( [ zkiexplicit ] ) : this was actually the reason for including them .",
    "note that we can consider different values of the coupling parameter for the energy modes ( @xmath75 ) , and even for the normal and tangent momentum modes ( @xmath76 , respectively ) .    for any value @xmath77",
    ", the modified modes can be computed consistently from inside .",
    "the momentum system however is too complicated for a full hyperbolicity analysis , like the one we provide in appendix b for the energy sector .",
    "part of the complication comes from the coupling with the non - constraint modes , which require their own boundary conditions .",
    "let us remember at this point that the boundary conditions presented in this section are derivative , not algebraic .",
    "this means that , even in the symmetric hyperbolic cases , proving well - posedness is by no means trivial .",
    "for that reason , we will rather follow the approach of ref .",
    "@xcite , focusing in the stability of small perturbations around smooth solutions , which can be tested numerically .",
    "we start in the following section , by performing a robust stability test in order to check the numerical stability of high - frequency perturbations around the minkowsky metric . as a full set of boundary conditions",
    "is required , even in this weak - field test , we supplement our conditions for the constraint - related modes with the freezing of the initial values of the incoming non - constraint modes ( maximal dissipation on the right - hand - side ) .",
    "let us test now the stability and performance of the proposed conditions in the linear weak - field regime , by considering a small perturbation of minkowski space - time , which is generated by taking random data both in the extrinsic curvature and in the constraint - violation quantities @xmath78 .",
    "in this way the initial data violate the energy - momentum constraints , but preserve all ordering constraints .",
    "the level of the random noise will be of the order @xmath79 , small enough to make sure that we will keep in the linear regime during the whole simulation ( robust stability test , see ref .",
    "@xcite for details ) .",
    "we will use the standard method of lines  @xcite as a finite difference algorithm , so that space and time discretization will be treated separately .",
    "the time evolution will be dealt with a third - order runge - kutta algorithm .",
    "the time step @xmath80 is kept small enough to avoid an excess of numerical dissipation that could distort our results in long runs .    for space discretization",
    ", we will consider a three - dimensional rectangular grid , evenly - spaced along every space direction , with a space resolution @xmath81 .",
    "we will use there the simplest centered , second - order - accurate , discretization scheme . at the points next to the boundary , where we can not use the required three - points stencil",
    ", we will switch to the standard first - order upwind ( outgoing ) scheme .",
    "this combination is the simplest one with the summation - by - parts ( sbp ) property  @xcite . in this way",
    "we expect that the theoretical properties derived from symmetric - hyperbolicity will show up in the simulations in a more transparent way .",
    "for the same reason , we avoid adding extra viscosity terms that could mask the effect of our conditions ( at the continuum level ) with the dissipative effects of the discretization algorithm . just to make sure",
    ", we run also with periodic boundary conditions , where the noise level keeps constant : any decrease of the constraint - violation level will then be due to the proposed conditions , not to the discretization scheme .",
    "let us be more specific about the boundary treatment . at boundary points ,",
    "we use the first - order upwind algorithm in order to get a prediction for every dynamical field .",
    "once we have got this prediction , we perform the characteristic decomposition along the direction normal to the boundary .",
    "the predicted values for the outgoing modes , for which the upwind algorithm is known to be stable , will be kept ( this includes the standing modes , with zero characteristic speed ) .",
    "the ( unstable ) incoming modes will be replaced instead by the values arising from our boundary conditions , as described in the preceding section .",
    "we start with simulations in which the proposed conditions are applied just to the @xmath82 face , whereas we keep periodic boundary conditions along the @xmath83 and @xmath84 directions . in this way we can detect instabilities which are inherent to the proposed boundary conditions on smooth boundaries ( no corners ) , allowing at the same time for some non - trivial dynamics along at least one tangent direction .",
    ", with just one face open ( periodic boundaries are implemented along the transverse directions ) .",
    "the fully periodic boundaries result ( dashed lines ) is also included for comparison .",
    "we see some growing mode onset in the @xmath85 case , whereas the constraint - preserving @xmath86 case ( continuous line ) is very efficient at reducing the initial noise level.,width=377,height=226 ]    we plot in fig .",
    "[ robusttheta ] the maximum norm of the energy - constraint - violating quantity @xmath16 for two different choices of the coupling parameter of the energy mode : @xmath87 .",
    "we can see that , after @xmath88 crossing times , the case @xmath89 starts showing the effect of the linear modes predicted by our hyperbolicity analysis in appendix b , by departing from the maximal dissipation pattern of decay .",
    "we plot for comparison the results obtained by applying periodic boundary conditions , so we can see how , for the choice @xmath90 , the proposed constraint - preserving conditions are extremely effective at draining out energy constraint violations .",
    "the rate of decay is actually the same as the one obtained by applying maximal dissipation conditions on the right - hand - side also to the energy modes , as expected from the analysis given in the previous section .",
    "in what follows , we will fix @xmath90 for this coupling parameter .",
    "components ( left and right panels , respectively ) . in both cases , the periodic boundaries results ( dashed lines )",
    "are included for comparison .",
    "the initial noise in the momentum constraint gets reduced very efficiently in both the @xmath91 and the @xmath11 cases , although there is a slight difference , more visible in the longitudinal case ( left panel).,title=\"fig:\",width=302,height=226 ]   components ( left and right panels , respectively ) . in both cases , the periodic boundaries results ( dashed lines )",
    "are included for comparison .",
    "the initial noise in the momentum constraint gets reduced very efficiently in both the @xmath91 and the @xmath11 cases , although there is a slight difference , more visible in the longitudinal case ( left panel).,title=\"fig:\",width=302,height=226 ]    we plot in fig .",
    "[ robust1 ] both the maximum norm of the longitudinal ( left panel ) and transverse components ( right panel ) of the momentum - constraint - violating vector @xmath4 for the choice @xmath92 of the coupling parameter of the momentum modes .",
    "we include again for comparison the results obtained by applying periodic boundary conditions , so we can see how the proposed constraint - preserving conditions are very effective at draining out energy constraint violations .",
    "the @xmath93 plots are slightly , sensitive to the ordering parameter @xmath94 . in the @xmath91 case , the rate of decay is actually the same as the one obtained by applying instead maximal dissipation conditions on the right - hand .- side for the momentum modes .",
    "the results are qualitatively the same for other components of @xmath4 and for other parameter combinations @xmath95 .",
    "( left panel ) , and @xmath93 ( right panel ) .",
    "the proposed boundary conditions are applied here to all faces , including corners and vertices .",
    "some amount of numerical dissipation has been added , so that the periodic boundaries plots ( dashed lines ) get a visible negative slope .",
    "the choice @xmath86 for the energy modes is still clearly stable ( left panel ) .",
    "the choice @xmath91 for the momentum modes ( right panel ) shows a growing mode onset . for comparison , a plot with the maximal dissipation results is also included in the right panel ( bottom line).,title=\"fig:\",width=302,height=226 ]   ( left panel ) , and @xmath93 ( right panel ) .",
    "the proposed boundary conditions are applied here to all faces , including corners and vertices .",
    "some amount of numerical dissipation has been added , so that the periodic boundaries plots ( dashed lines ) get a visible negative slope .",
    "the choice @xmath86 for the energy modes is still clearly stable ( left panel ) .",
    "the choice @xmath91 for the momentum modes ( right panel ) shows a growing mode onset . for comparison , a plot with the maximal dissipation results",
    "is also included in the right panel ( bottom line).,title=\"fig:\",width=302,height=226 ]    in order to perform a full test for cartesian - like grids , including corner and vertex points , we will repeat the same simulations , but this time with the proposed boundary conditions applied to all faces , not just to the @xmath82 ones . a standard treatment of corner points a la olsson  @xcite , like the one presented in previous works  @xcite , results into numerical instability issues .",
    "a simple cure is to add some extra dissipation at the interior points , at the price of masking the theoretical results , et the continuum level , with the numerical viscosity effects , as shown in fig .",
    "[ robustolsson ] .",
    "we can see there that opening all faces makes the effects to appear much faster . the expected instability of the @xmath85 choice of the energy coupling parameter , which was just an onset in fig .",
    "[ robusttheta ] , shows up manifestly here ( left panel ) .",
    "also , a growing mode onset is clearly visible for the choice @xmath91 of the momentum - constraint coupling parameter ( right panel ) .",
    "the case @xmath11 looks stable , although no strong conclusion can be drawn because of the added numerical dissipation .",
    "maximal dissipation results are also shown for comparison in the right panel ( bottom line ) .",
    "[ 0.3 ]     we will present here an alternative numerical treatment . at boundary points , tangent derivatives are computed at the next - to - last layer .",
    "the corresponding stencil is shown in fig .",
    "[ stencil ] . in this way",
    "the corner points are not required .",
    "this avoids the reported code stability issues , even without adding extra numerical dissipation terms .",
    "note that transverse derivatives are still computed using the standard three - point sbp algorithm , like in the smooth boundaries case .",
    "as every space derivative can be considered separately ( we are dealing with a first - order system ) the sbp property should still follow for our modified scheme . the price for the shift of the transverse derivatives to the next - to - last layer is getting just first - order accuracy at the boundary , but the longitudinal derivatives there were yet only first - order accurate anyway .     ( left panel ) , and @xmath93 ( right panel ) .",
    "the proposed boundary conditions are applied to all faces .",
    "corner points are avoided in the way shown in fig .",
    "[ stencil ] .",
    "no extra numerical dissipation has been added , so that the periodic boundaries plots ( dashed lines ) keep flat .",
    "the absence of extra dissipation clarifies the features shown in the previous figure.,title=\"fig:\",width=302,height=226 ]    ( left panel ) , and @xmath93 ( right panel ) .",
    "the proposed boundary conditions are applied to all faces .",
    "corner points are avoided in the way shown in fig .",
    "[ stencil ] .",
    "no extra numerical dissipation has been added , so that the periodic boundaries plots ( dashed lines ) keep flat .",
    "the absence of extra dissipation clarifies the features shown in the previous figure.,title=\"fig:\",width=302,height=226 ]    this discretization variant allows getting stable results , at least for the value @xmath11 of the ordering parameter .",
    "we plot in fig .",
    "[ robust3d ] the maximum norm of the constraint - violation quantities @xmath78 .",
    "we can see there that removing the extra numerical dissipation makes the features more transparent .",
    "the instability of the @xmath85 choice of the energy coupling parameter , appears now instantly .",
    "the downfall rate in the stable case @xmath86 , increased as the constraint violations are drained out in all three directions now , can be seen in a more unambiguous way . concerning the momentum constraint ( right panel ) , the standard @xmath91 ordering shows now clearly its unstable behavior , which was masked by the added dissipation in the standard treatment ( see fig .",
    "[ robustolsson ] ) . the centered ordering choice @xmath11 recovers instead the manifest stable behavior shown in single - face simulations ( see fig .",
    "[ robust1 ] ) , close to the maximal dissipation case ( left panel , bottom line ) .",
    "our results show the numerical stability of the proposed boundary conditions in the linear regime for suitable combinations of the coupling and/or ordering parameters .",
    "the proposed boundary conditions produce instead a very effective decreasing of ( the cumulated effect of ) energy and momentum constraint violations which compares with the one obtained by applying maximal dissipation boundary conditions to ( the right - hand - side of ) the constraint related modes .",
    "although the results of the preceding are encouraging , let us remark that we were just testing the linear regime around minkowsky spacetime .",
    "this is not enough , as high - frequency instabilities can appear in generic , strong field , situations ( see for instance ref .",
    "@xcite ) . in order to test the strong field regime",
    ", we will consider the gowdy solution  @xcite , which describes a space - time containing plane polarized gravitational waves .",
    "this is one of the test cases that is used in numerical code cross - comparison with periodic boundary conditions  @xcite .",
    "one of the advantages is that it allows for periodic and/or reflecting boundary conditions , which can be applied to the modes which are not in the energy - momentum constraint sector .",
    "a first proposal for this selective testing of the constraint - related modes has been presented recently  @xcite .",
    "the gowdy line element can be written as @xmath96 where the quantities @xmath97 and @xmath98 are functions of @xmath99 and @xmath82 only and periodic in @xmath82 , that is  @xcite , @xmath100\\end{aligned}\\ ] ] so that the lapse function @xmath101 is constant in space at any time @xmath102 at which @xmath103 vanishes .",
    "let us now perform the following time coordinate transformation @xmath104 so that the expanding line element ( [ gowdy_line ] ) is seen in the new time coordinate @xmath105 as collapsing towards the @xmath106 singularity , which is approached only in the limit @xmath107 .",
    "this singularity avoidance property of the @xmath105 coordinate follows from the fact that the resulting slicing by @xmath108 surfaces is harmonic @xcite .",
    "we will launch our simulations in normal coordinates , starting with a constant lapse @xmath109 at @xmath110 ( @xmath111 ) .",
    "the discretization is performed like in the preceding section , but with a space resolution @xmath112 . allowing for the fact that the only non - trivial space dependence in the metric is through @xmath113",
    ", the numerical grid is fitted to the range @xmath114 . in this way",
    ", the exact solution admits either periodic or reflection boundary conditions .",
    "we can use these exact boundary conditions as a comparison with the constraint - preserving ones that we are going to test . as the gowdy metric components depend on just one coordinate",
    ", we will apply here the proposed constraint - preserving conditions only to the @xmath82 faces , keeping periodic boundary conditions along the transverse directions .",
    "also , like in the preceding section , we show the results for the @xmath115 coupling parameters combination , although other choices of @xmath95 lead to similar results .",
    "is plotted at @xmath116 for two different resolutions ( left panel ) .",
    "we see second - order convergence in the interior region , decreasing up to first - order at points causally connected to the boundary , as expected from our sbp algorithm .",
    "we plot in the right panel the relative error of the @xmath117 metric component , evolved up to @xmath118 .",
    "the boundary - induced accuracy reduction is not even visible yet .",
    ", title=\"fig:\",width=302,height=226 ]   is plotted at @xmath116 for two different resolutions ( left panel ) .",
    "we see second - order convergence in the interior region , decreasing up to first - order at points causally connected to the boundary , as expected from our sbp algorithm .",
    "we plot in the right panel the relative error of the @xmath117 metric component , evolved up to @xmath118 .",
    "the boundary - induced accuracy reduction is not even visible yet .",
    ", title=\"fig:\",width=302,height=226 ]    we start with a simple convergence test . as we know the exact solution ( [ gowdy_line ] )",
    ", we can directly compute the relative error of every simulation .",
    "then , only two different resolutions are required for checking convergence .",
    "we will take @xmath119 and @xmath112 for our gowdy wave simulations .",
    "we plot in fig .",
    "[ gowdy conv ] the energy - constraint - violation quantity @xmath16 at some early time @xmath116 ( left panel ) .",
    "we see the expected second - order accuracy at the interior points which are yet causally disconnected with the boundaries .",
    "we see just first - order accuracy at the boundary , plus a smooth transition zone .",
    "this accuracy reduction at boundaries is inherent to simple sbp algorithms , which require a lower - order discretization at boundary points  @xcite .",
    "one could keep instead the accuracy level of the interior points by using more accurate predictions for boundary values , but at the price of loosing the sbp property . in our test case , however , this issue is not affecting the metric components , even at a much later time @xmath118 , as we can see in the right panel of fig .",
    "[ gowdy conv ] .     and @xmath120",
    "profiles are plotted as indicators of the accumulated error due to energy - momentum constraint violations .",
    "reflection boundaries results are also plot for comparison ( continuous lines ) .",
    "dotted lines correspond to the proposed boundary conditions , whereas dashed lines correspond to the same conditions with the extra damping terms discussed in this section , with @xmath121.,title=\"fig:\",width=302,height=226 ]   and @xmath120 profiles are plotted as indicators of the accumulated error due to energy - momentum constraint violations .",
    "reflection boundaries results are also plot for comparison ( continuous lines ) .",
    "dotted lines correspond to the proposed boundary conditions , whereas dashed lines correspond to the same conditions with the extra damping terms discussed in this section , with @xmath121.,title=\"fig:\",width=302,height=226 ]    we show in fig .",
    "[ gwperiodic ] the results of the @xmath112 resolution simulation for the boundary profiles of @xmath16 and @xmath4 , indicating the accumulated amount of energy and momentum constraint violations ( left and right panels , respectively ) .",
    "we apply in both cases the proposed boundary conditions at the @xmath82 faces to the constraint - related modes , while keeping exact ( reflection ) boundary conditions for the other modes .",
    "we can see that the constraint - preserving conditions result , in this strong - field test , into an accumulated amount of constraint violations ( dotted lines ) that is similar or even slightly better than the one produced by the interior points treatment , which can be seen in simulations with ( exact ) reflection boundaries for all faces ( continuous lines ) .",
    "note that the reflection conditions anchor @xmath120 to zero at the boundary points , which is always more accurate in this test , although not very useful in more realistic cases .",
    "these results confirm that the proposed boundary conditions are indeed constraint - preserving , in the sense that their contribution to energy and momentum constraint violations keeps within the limits of the truncation error of the discretization algorithms , even in this strong field scenario .",
    "this good behavior can be further improved by introducing constraint - damping terms in the evolution equations for the boundary quantities ( [ thetabound ] , [ zbound ] ) that is @xmath122 the resulting values can then be used in the replacements ( [ e- repl ] ) and ( [ m- repl ] ) , respectively .",
    "we have included the corresponding results in fig .",
    "[ gwperiodic ] ( dashed lines ) .",
    "the amount of both energy and constraint violations becomes even lower than the one for the ( exact ) reflection boundaries simulations even for a small value @xmath121 of the damping parameter .",
    "the effect is specially visible in the energy constraint case ( left panel ) .",
    "the work presented in this paper revises and improves the previous results for the z4 case  @xcite in many different ways .    on the theoretical side ,",
    "we have proposed a new symmetrizer , which extends the parametric domain for symmetric hyperbolicity from the single value @xmath91 to the interval @xmath123 .",
    "we have identified in the process a new basis for the dynamical field space ( [ pimu a]-[pimu d ] ) which allows a clear - cut separation between the constraint - related modes and the remaining ones .",
    "regarding the boundary treatment , we have also generalized the way in which boundary conditions can by used for modifying the incoming modes , by introducing a new parameter @xmath124 which , at least for the momentum constraint modes , can depart from the standard value @xmath54 without affecting the stability of the results .    on the numerical side",
    ", the use of the new basis definitely improves the stability of the previous z4 results . in the single face case , where we use periodic boundary conditions along transverse directions",
    ", we see that the linear modes previously reported in the robust stability test  @xcite for the symmetric ordering case ( @xmath11 ) no longer show up .",
    "moreover , we have devised a simple finite - differences stencil for the prediction step at the boundaries which avoids the corner and vertex points even in cartesian - like grids , providing an interesting alternative to the standard ( olsson ) corners treatment .",
    "the proposed boundary conditions have been also tested in a strong field scenario , the gowdy waves metric  @xcite , so that the effect of non - trivial metric coefficients can be seen in the simulation results .",
    "the convergence test in this non - linear regime provides strong evidence of numerical stability for some suitable parameter combinations .",
    "our simulations actually confirm that the proposed boundary conditions are constraint - preserving : the accumulated amount of energy - momentum constraint violations is similar or even better than the one generated by either periodic or reflection conditions , which are exact in the gowdy waves case .",
    "now it remains the question of how these interesting results can be extended to other 3 + 1 evolution formalisms and/or gauge conditions .",
    "let us remember that all our symmetric hyperbolicity results apply as usual just to the harmonic slicing , not to the 1+log class of slicing conditions which are customary in bssn black - hole simulations .",
    "there is no problem , however , in extending the proposed boundary conditions to this case : in our new basis the gauge sector is clearly separated from the constraint - related one , so that one can keep using the replacements ( [ e- repl ] , [ m- repl ] ) even in this non - harmonic case .",
    "the shift , however , introduces new couplings and would require a detailed case - by - case investigation : even the strong hyperbolicity of the system can depend on the specific choice of shift condition .",
    "concerning the extension from the z4 to the bssn formalism , the momentum constraint treatment can be derived from the simple condition  @xcite @xmath125 which relates the additional bssn quantity @xmath126 with the space vector @xmath4 .",
    "the replacement ( [ m- repl ] ) can then be used for getting a suitable boundary condition in this context .",
    "the case of the energy constraint is more challenging , as the bssn formalism does not contain any supplementary quantity analogous to @xmath16 .",
    "one could follow , however , the line recently proposed in  @xcite : a slight modification of the original bssn equations allows to include the new quantity @xmath16 , so that the correspondence with the z4 formalism is complete .",
    "the replacement ( [ e- repl ] ) can then be used directly in such context .",
    "a major challenge is posed by the fact that most bssn implementations are of second order in space .",
    "this has some advantages in this context , as the ordering constraints do not show up and this removes the main source of ambiguities in the constraint - violations evolution system . as a result ,",
    "the boundary conditions ( [ thetabound ] , [ zbound ] ) become simply advection equations so that we can expect a more effective constraint - violation draining rate . the problem , however , is that second - order implementations do not have the algebraic characteristic decomposition which is crucial in the first - order ones .",
    "the boundaries treatment takes quite different approaches in second - order formalisms , although the evolution equations for the constraint - related quantities @xmath127 are still of first order in the z4 case , even at the continuum level , and this suggests that the results presented here can be still helpful in this case .",
    "we are currently working in this direction .",
    "this work has been jointly supported by european union feder funds and by the spanish ministry of science and education ( projects fpa2007 - 60220 , csd2007 - 00042 and eci2007 - 29029-e ) . c.  bona - casas acknowledges the support of the spanish ministry of science , under the fpu/2006 - 02226 fellowship .",
    "we have derived in section ii an generalized energy estimate for the z4 system , namely : @xmath128 where we noted @xmath129    in order to check the positivity of ( [ ae ] ) , let us consider the decomposition of the three - index tensor @xmath130 into its symmetric and antisymmetric parts , that is @xmath131 allowing for the identities , @xmath132 the rank - three terms contribution to @xmath133 can the be written as @xmath134 ( the dots stand for lower - rank components ) .",
    "it follows that a necessary condition for positivity is @xmath135",
    ".    we can now rewrite ( [ ae ] ) as @xmath136 allowing for ( [ amut ] ) , which implies in turn @xmath137 we see that we can rewrite again ( [ aebis ] ) as @xmath138 where @xmath139 it follows from the final expression ( [ aefinal ] ) that the energy estimate is positive definite in the whole interval @xmath140 note that for @xmath91 , that is @xmath141 , we recover the estimate given in ref .",
    "we can analyze the hyperbolicity of the boundary evolution system , by considering the characteristic matrix along a generic oblique direction @xmath142 , which is related to the normal direction @xmath29 by @xmath143 where we have taken @xmath144 the strong hyperbolicity requirement amounts to demand that the characteristic matrix is fully diagonalizable and has real eigenvalues ( propagation speeds ) for any value of the angle @xmath145 .    in order to compute the characteristic matrix",
    ", we will consider the standard form of ( the principal part of ) the evolution system as follows @xmath146 where @xmath147 stands for the array of dynamical fields and @xmath148 is the array of fluxes along the direction @xmath142 .",
    "we will restrict ourselves here to the energy - modes subsystem , which consists in the fields @xmath149 the index @xmath150 meaning here a projection along the direction orthogonal both to @xmath29 and @xmath151 .",
    "it is clear that the two components @xmath152 are eigenvectors of the characteristic matrix with zero propagation speed .",
    "the non - trivial fluxes are then : @xmath153 where we have allowed for the modified evolution equation ( [ e- modif ] ) .",
    "we can see that the one of the characteristic speeds is zero and the other two are be given by the solutions of @xmath154 which has real distinct solutions for @xmath155 .",
    "the degenerate case @xmath156 is not diagonalizable .",
    "it follows that the boundary evolution subsystem given by the above fluxes is strongly hyperbolic for @xmath155 and weakly hyperbolic for @xmath156 ."
  ],
  "abstract_text": [
    "<S> a set of energy - momentum constraint - preserving boundary conditions is proposed for the first - order z4 case . </S>",
    "<S> the stability of a simple numerical implementation is tested in the linear regime ( robust stability test ) , both with the standard corner and vertex treatment and with a modified finite - differences stencil for boundary points which avoids corners and vertices even in cartesian - like grids . moreover , </S>",
    "<S> the proposed boundary conditions are tested in a strong field scenario , the gowdy waves metric , showing the expected rate of convergence . </S>",
    "<S> the accumulated amount of energy - momentum constraint violations is similar or even smaller than the one generated by either periodic or reflection conditions , which are exact in the gowdy waves case . as a side theoretical result </S>",
    "<S> , a new symmetrizer is explicitly given , which extends the parametric domain of symmetric hyperbolicity for the z4 formalism . </S>",
    "<S> the application of these results to first - order bssn - like formalisms is also considered .    . </S>"
  ]
}