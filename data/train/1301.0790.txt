{
  "article_text": [
    "a sudoku is a square consisting of a 9@xmath09 grid which is partly pre - populated by numbers between 1 and 9 called the givens .",
    "the problem consists of finding numbers between 1 and 9 for all unpopulated cells , such that each row , each column and each block consists of exactly the numbers @xmath1 .",
    "the blocks of a sudoku partition the sudoku square into subsquares of size 3@xmath03 .",
    "each sudoku consists of 9 rows , 9 columns and 9 blocks .",
    "in @xcite we introduced a mathematical model for this sudoku puzzle and called it the generalized sudoku problem . as we are concerned throughout this paper with duality , we call it in section [ s : pp ] the primal problem .",
    "we introduce a dual problem in section [ s : dp ] and show the relation between the primal and the dual .",
    "this relation will be established using a necessary solution condition developed in @xcite and can be interpreted as a duality result .",
    "but the primal and the dual problem defined in this way do not allow to describe duality results considering duality gaps . therefore we introduce in section [ s : opt ] primal and dual optimization problems and show how they replace the original problems . in section [ s :",
    "dual ] we prove a weak and a strong duality property between the primal and the dual optimization problem .",
    "the primal and the dual problem are of a type , which is often called constraint satisfaction problem or csp . for a description of general csps with examples , solution techniques and applications",
    "see the survey article of dechter and rossi @xcite .",
    "duality statements are standard properties of linear and nonlinear programs .",
    "an overview with several examples and applications can be found in the book of boyd and vandenberghe @xcite .",
    "the linear case has been treated by dantzig and thapa @xcite .",
    "finally , we collect some basic terms and notations .",
    "let @xmath2 denote the set of integers .",
    "let the @xmath3-times cartesian product of any set be indicated by a superscript @xmath3 , i.e. , @xmath4 denote the @xmath3-times cartesian product of @xmath2 .",
    "the vectors @xmath5 respectively @xmath6 denote the zero respectively one vector , consisting of zeros respectively ones in each component . the number of components of these vectors is often indicated by an index .",
    "each vector is considered to be a column vector .",
    "@xmath7 denotes the identity matrix .",
    "the transpose of a vector or a matrix is indicated by a superscript @xmath8 .",
    "the sign function is denoted by @xmath9 .",
    "we consider the sum over an empty index set to be zero .",
    "the brackets with index @xmath10_{i}$ ] denote the @xmath11 component of a vector contained in the brackets .",
    "the symbol @xmath12 denotes the number of elements ( cardinality ) of a finite set .",
    "we replicate here the definition of the generalized sudoku problem as introduced in @xcite and call it this time the primal problem .",
    "let @xmath3 be an integer with @xmath13 .",
    "we define the sum @xmath14 and define a matrix @xmath15 with @xmath16 rows and @xmath3 columns inductively . for @xmath17 , let @xmath18 denote the empty matrix , i.e. , a matrix without entries . assume the matrix @xmath19 had been defined with @xmath20 rows and @xmath21 columns",
    ". then we set    @xmath22    we extend the matrix @xmath15 to a matrix @xmath23 with @xmath24 rows and @xmath25 columns .",
    "the matrix @xmath23 consists in the  main diagonal \" of @xmath3 matrices @xmath15 and the remaining values are set to zero .",
    "the matrix @xmath23 depends on the value @xmath3 , but we do not state this dependence explicitly .    given the set @xmath26 , let @xmath27 be any permutation on this set , i.e. , @xmath28 be a permutation .",
    "we extend the notion of permutation to the matrix @xmath23 , i.e. , we define @xmath29 , where @xmath30 denotes the @xmath31 column of @xmath23 for @xmath32 . given a permutation @xmath27 on @xmath33 , we define the matrix @xmath34 , i.e. , we interchange the columns of @xmath23 according to the permutation @xmath27 .    [",
    "d : nonzero ] let @xmath35 .",
    "for any point @xmath36 we write @xmath37 if each component of @xmath38 is nonzero , i.e. , if @xmath39 for @xmath40 .",
    "this definition should not be confused with the expression @xmath41 , where only one component of @xmath38 has to be nonzero .",
    "given is @xmath42 , some permutations @xmath43 , @xmath44 , @xmath45 on @xmath33 , some @xmath46 , an index set @xmath47 , and givens @xmath48 with @xmath49 for @xmath50 .",
    "let @xmath51 be the @xmath52 matrix , which consists of the rows @xmath53 of the identity matrix @xmath54 , i.e. , the @xmath55 component of the @xmath56 row of @xmath51 is equal to @xmath57 ( and zero otherwise ) . in other words",
    "@xmath51 is defined by @xmath58_l = x_{i_l}$ ] for each @xmath59 and @xmath60 .",
    "the vector of ones @xmath61 is mapped to the vector of ones @xmath62 by @xmath51 , i.e. , @xmath63 .",
    "define @xmath64 .    now , we are in position to state the primal problem .",
    "@xmath65    we restrict ourselves to this mathematical model and do not refer directly to the classical sudoku puzzle . in particular , we will not investigate the relation of this model to the sudoku puzzle in detail .",
    "this had been described in @xcite already .",
    "another problem modeling sudoku had been introduced by kaibel and koch @xcite .",
    "their linear model consisted of 0 - 1-variables and contained equality constraints . the same type of problem had been considered by provan @xcite",
    ". both did not consider duality properties .",
    "we introduce the dual problem .",
    "@xmath66    the last condition @xmath67 can be reformulated using a componentwise description @xmath68_{i_l } = 2 g_{i_l } - ( n+1 ) \\mbox { for } l=1 , \\ldots , k.\\ ] ]    the dual problem is closely related to the generalized sign function introduced in @xcite .",
    "the generalized sign function is based on the classical sign function and is also denoted by @xmath9 .    [ d : sgn ] let @xmath35 . for any point @xmath36 with @xmath69",
    "we define the generalized sign function @xmath70 by @xmath71    we continue with some preparing lemmas .",
    "[ l:31 ] let @xmath27 be a permutation on @xmath72 and let @xmath59 , such that @xmath73 for @xmath74 and @xmath75 .",
    "then @xmath76 satisfies @xmath77 and @xmath78 .",
    "the property @xmath77 follows from @xmath75 and the definition of @xmath9 . using ( * ? ? ?",
    "* theorem 5.1 ) and the equation @xmath79 we obtain @xmath80 which is the desired result .",
    "[ l:32 ] let @xmath27 be a permutation on @xmath33 and let @xmath81 be a point in @xmath82",
    ". then @xmath83_i \\le n-1 $ ] for @xmath74 .",
    "we divide the proof of this lemma into three steps .",
    "first we prove it for the matrix @xmath15 , then for @xmath23 and , finally , for @xmath84 .",
    "the first claim reads as @xmath85_i \\le n-1 $ ] for @xmath86 and @xmath87 .",
    "we prove this claim by induction on @xmath42 and start with @xmath88 .",
    "consider @xmath89_i = [ ( + 1 -1)^t \\lambda ] _ i =   \\begin{cases } \\lambda ,   & \\mbox{if } i=1   \\\\ - \\lambda , & \\mbox{if } i=2   \\end{cases}\\ ] ] for @xmath90 and @xmath91 .",
    "the induction claim is true for @xmath88 .",
    "assume the induction claim had been proved for @xmath21 .",
    "consider @xmath92_i =    \\begin{cases } \\sum\\limits_{j=1}^{n-1 } \\lambda_j , & \\mbox{if } i=1 \\\\ - \\lambda_{i-1 } + [ a(n-1)^t ( \\lambda_n , \\ldots , \\lambda_{s(n)})^t]_{i-1 } ,   & \\mbox{if } 2 \\le i \\le n    \\end{cases}\\ ] ] for @xmath93 and @xmath87 .",
    "the first expression satisfies @xmath94 for @xmath95 . using @xmath96 and the induction hypothesis , @xmath97_{i-1 } \\\\ & \\le 1 + ( n-2 ) \\\\ & = n-1\\end{aligned}\\ ] ] for @xmath93 and @xmath98 .",
    "this shows the induction claim .",
    "we extend this claim to the matrix @xmath23 , which contains the matrices @xmath15 in the diagonal .",
    "let @xmath99 and let @xmath100 .",
    "there exists some @xmath101 , such that @xmath102_i = [ a(n)^t ( \\lambda_{(j-1)n+1 } , \\ldots , \\lambda_{j \\cdot n})^t]_i\\ ] ] and this term satisfies the desired inequality .",
    "the matrix @xmath103 is a permutation of the rows of @xmath104 and this completes the proof of the lemma .    [ l:33 ] let @xmath27 be a permutation on @xmath72 and let @xmath81 be a point in @xmath82 , such that @xmath78 .",
    "then @xmath105 satisfies @xmath106 , @xmath73 for @xmath74 and @xmath75 .",
    "the point @xmath107 consists of integer components , since all defining variables consist of integer components .",
    "using lemma [ l:32 ] , @xmath108 satisfies @xmath109_i \\le n-1\\ ] ] for @xmath74 . adding @xmath110 , yields @xmath111_i \\le 2 n\\ ] ] for @xmath74 and this shows @xmath73 for @xmath74 .    using the equation @xmath112",
    ", we obtain @xmath113 which completes the proof .",
    "usually duality results are stated in the following sense : if there exists a primal feasible point and a dual feasible point and the optimal values are equal , then the primal feasible point solves the primal problem and the dual feasible point solves the dual problem .    sometimes duality results are stated in another way in the literature ( compare chvtal ( * ? ? ?",
    "* theorem 5.1 ) ) : if the primal problem is solvable , then the dual problem is solvable and the optimal values are equal .",
    "the relation between the primal problem and the dual problem is examined in the next theorem and the formulation is of the second type . if the primal problem is solvable , then the dual problem is solvable and there exists an explicit formula for the dual solution .",
    "an analogous statement holds for the dual problem .",
    "[ t:31 ] the following statements hold : + ( i ) if @xmath107 solves @xmath114 , then @xmath115 solves @xmath116 .",
    "+ ( ii ) if @xmath81 solves @xmath116 , then @xmath117 solves @xmath114 .",
    "\\(i ) assume @xmath118 solves @xmath114 .",
    "then @xmath73 for @xmath74 , @xmath119 for @xmath120 and @xmath121 .",
    "let @xmath122 , then @xmath77 and @xmath123 for @xmath120 , by lemma [ l:31 ] . using ( * ? ? ? * theorem 5.2 ) , @xmath124",
    "i.e. , @xmath81 solves @xmath116 .",
    "+ ( ii ) assume @xmath81 solves @xmath116 .",
    "then @xmath77 , @xmath123 for @xmath120 and @xmath125 .",
    "let @xmath126 then @xmath106 , @xmath73 for @xmath74 and @xmath119 for @xmath120 by lemma [ l:33 ] .",
    "the equation @xmath127 completes , that @xmath107 solves @xmath114 .",
    "we illustrate theorem [ t:31 ] ( i ) with a sudoku of size @xmath128 , i.e. , @xmath129 . the solution @xmath107 is depicted in fig . [ fig1 ] . at this moment it does not matter how the original problem had been formulated and where the givens had been located .",
    "the point @xmath130 consists of the values @xmath131 and is the corresponding dual solution .",
    "this dual point describes the comparison of the values in two cells in the same row in fig .",
    "the first component @xmath132 of @xmath81 describes , that the content of cell 1 in row 1 ( which is a @xmath133 ) is smaller than the content of cell 2 in row 1 ( which is a @xmath134 ) .",
    "sudoku ]    this example can also be used to illustrate statement ( ii ) of theorem [ t:31 ] . defining @xmath81 by the series of @xmath135s and @xmath132s in the example , the point @xmath136",
    "is depicted in fig .",
    "[ fig1 ] .",
    "the primal and the dual problem as introduced in section [ s : pp ] and [ s : dp ] are constraint satisfaction problems and do not possess an objective function .",
    "therefore it is not possible to state properties involving duality gaps for these problems . in the next section",
    "we replace these problems by two optimization problems and derive duality results for these optimization problems .",
    "we introduce the primal and the dual optimization problems , which are equivalent to the primal respectively dual problem .",
    "the primal optimization problem will consist of points , which have undefined components , reflecting empty cells in a sudoku puzzle .",
    "we describe these empty cells by the token @xmath137 and we define @xmath138 .",
    "when we allow points to possess infinity components , we have to extend several classic notations .",
    "the addition of two numbers , where one or both may be infinity , is defined as @xmath139 for @xmath140 .",
    "we define the product @xmath141 and @xmath142 for each @xmath140 , @xmath143 .",
    "based on this extended definition of addition and multiplication , we extend implicitly the matrix multiplication to matrices and vectors with possible infinity components .",
    "the token @xmath137 is different to any number , i.e. , @xmath144 and @xmath145 for each @xmath140 . in particular",
    ", @xmath137 is unequal to zero .",
    "this extension reflects the meaning of @xmath137 as an undefined state .",
    "something defined and something undefined creates an undefined result and something undefined is different to anything defined .",
    "the token @xmath137 has nothing to do with the commonly understanding of  infinitely large \" .",
    "it is just a placeholder for  nothing \" , i.e. , an empty cell in the sudoku square .    in a classical sudoku puzzle",
    "the term @xmath146 with @xmath147 ( i.e. some of the components of @xmath107 may be unknown ) describes points where each two known values in the same row , the same column or the same block are distinct .",
    "we continue with the primal feasible set @xmath148    it is easy to construct examples , where @xmath149 is empty and examples where @xmath149 is nonempty .",
    "we define the primal objective function by @xmath150 for each @xmath151 .",
    "the primal objective function is bounded from below by @xmath152 .",
    "the primal optimization problem is defined by @xmath153    the relevance of the primal optimization problem is the equivalence to the original primal problem and the possible definition of solution methods for the generalized sudoku problem .",
    "a common strategy for solving a sudoku puzzle creates points contained in the feasible set of the primal optimization problem .",
    "these points consist of unpopulated cells and distinct values in the populated cells of each row , column and block .",
    "this type of solution algorithm had been proposed by crook @xcite .",
    "his algorithm defines in each step a new feasible point with a lower value in the objective function until a solution is reached . by definition of the primal optimization problem",
    "the condition lower value of the objective function means the new point contains at least one more populated cell .",
    "the primal optimal ( minimal ) value @xmath154 of this optimization problem is denoted by @xmath155 and satisfies @xmath156 .",
    "a point @xmath157 with @xmath158 is called a solution of the primal optimization problem .",
    "[ t:41 ] if @xmath159 , then @xmath160 is solvable .",
    "the primal objective function @xmath161 is bounded from below by zero and attains only integer values .",
    "the primal optimal value @xmath162 if and only if one ( or each ) solution @xmath163 of @xmath160 satisfies @xmath164 for @xmath165 .",
    "we describe the relation between the primal problem and the primal optimization problem .",
    "this relation follows in a straightforward manner from the definitions of the corresponding problems .",
    "[ t:42 ] let @xmath166 .",
    "the following statements are equivalent : + ( i ) @xmath107 solves @xmath114 .",
    "+ ( ii ) @xmath107 solves @xmath160 and the primal optimal value @xmath162 .",
    "we proceed with the dual optimization problem .",
    "the dual feasible set is denoted by @xmath167 by a special choice of @xmath45 it is possible to construct examples , where @xmath168 .",
    "if the primal problem is a classical ( solvable ) sudoku puzzle , then the dual feasible set @xmath169 is nonempty .",
    "the dual objective function is defined by @xmath170_l = 2 g_{i_l } - ( n+1 ) \\ } - k\\ ] ] for each @xmath171 .",
    "the dual objective function is bounded from above by @xmath152 .",
    "the dual optimization problem is given by @xmath172 the dual optimal ( maximal ) value @xmath173 is denoted by @xmath174 and satisfies @xmath175 .",
    "a point @xmath176 with @xmath177 is called a solution of the dual optimization problem .",
    "[ t:43 ] if @xmath178 , then @xmath179 is solvable .",
    "the dual objective function @xmath180 is bounded from above by zero and attains only integer values .",
    "it is possible to characterize dual feasible points in terms of a primal property .",
    "[ t:44 ] let @xmath106 , such that @xmath119 for @xmath120 and let @xmath115 .",
    "then @xmath176 .",
    "this follows from lemma [ l:31 ] .",
    "[ t:45 ] let @xmath77 and @xmath106 , such that @xmath117 .",
    "the following statements are equivalent : + ( i ) @xmath176 .",
    "+ ( ii ) @xmath119 for @xmath120 .    ",
    "( i ) @xmath181 ( ii ) \" this direction follows from lemma [ l:33 ] . + ",
    "( ii ) @xmath181 ( i ) \" using the assumptions @xmath182 for @xmath120 , i.e. , @xmath176 .    the dual optimal value @xmath183 if and only if one ( or each ) solution @xmath81 of @xmath179 satisfies @xmath184 .",
    "we describe the relation between the dual problem and the dual optimization problem .",
    "this relation follows in a straightforward manner from the definitions of the corresponding problems .",
    "[ t:46 ] let @xmath171 .",
    "the following statements are equivalent : +",
    "( i ) @xmath81 solves @xmath116 .",
    "+ ( ii ) @xmath81 solves @xmath179 and the dual optimal value @xmath183 .",
    "in this section we collect the classical duality statements for the generalized sudoku problem , namely weak duality , duality gap and strong duality .",
    "we start with the weak duality statement .      we know from the definition of the primal and the dual optimization problem , that the dual objective function is bounded from above by zero and the primal objective function is bounded from below by zero .",
    "this shows ( i ) and implies ( ii ) .",
    "[ t:53 ] let @xmath159 and @xmath178 .",
    "the following statements are equivalent : + ( i ) @xmath192 .",
    "+ ( ii ) there exists a solution @xmath163 of @xmath160 , such that @xmath164 for @xmath74 .",
    "+ ( iii ) there exists a solution @xmath81 of @xmath179 , such that @xmath184 .    assume ( i ) holds . by theorems [ t:41 ] and [ t:43 ]",
    "@xmath160 and @xmath179 are solvable .",
    "let @xmath107 be a solution of @xmath160 and let @xmath81 be a solution of @xmath179 . by theorem ( i ) and [ t:52 ] , @xmath189 and @xmath190 , i.e. , ( ii ) and ( iii ) hold .",
    "+  ( ii ) @xmath181 ( i ) \" let @xmath163 be a solution of @xmath160 , such that @xmath164 for @xmath74 .",
    "this implies @xmath193 , hence @xmath107 solves @xmath114 by theorem [ t:42 ] .",
    "define @xmath194 , then @xmath81 solves @xmath116 by theorem [ t:31 ] ( i ) . by theorem [ t:46 ]",
    ", @xmath81 solves @xmath179 with @xmath190 . +  ( iii ) @xmath181 ( i ) \" let @xmath81 be a solution of @xmath179 , such that @xmath184 .",
    "this implies @xmath190 , hence @xmath81 solves @xmath116 by theorem [ t:46 ] .",
    "define @xmath117 , then @xmath107 solves @xmath114 by theorem [ t:31 ] ( ii ) . by theorem [ t:42 ]",
    ", @xmath107 solves @xmath160 with @xmath189 .",
    "it is possible to express the preceding theorem in terms of the original problems @xmath114 and @xmath116 .",
    "the strong duality result states , there does not exist a duality gap between @xmath160 and @xmath179 if and only if the primal problem @xmath114 is solvable respectively if and only if the dual problem @xmath116 is solvable .      s. boyd and l. vandenberghe , _ convex optimization _ , cambridge university press , cambridge , seventh printing , 2009 .",
    "v. chvtal , _ linear programming _ , freeman , new york , 1983 .",
    "crook , a pencil - and - paper algorithm for solving sudoku puzzles , _ notices amer .",
    "_ 56 ( 2009 ) , 460 - 468 .",
    "dantzig and m.n .",
    "thapa , _ linear programming 2 : theory and extensions _ , springer , new york , 2003 .",
    "r. dechter and f. rossi , constraint satisfaction , in : l. nadel ( ed . ) , _ encyclopedia of cognitive science _ ,",
    "1 , nature publ . group , london , 2003 , 793 - 800 .",
    "t. fischer , a necessary solution condition for sudoku , arxiv:1210.6343 [ math.co ] , 2012 . v. kaibel and t. koch , mathematik fr den volkssport , _ mitteilungen der dmv _ 14 ( 2006 ) , 93 - 96 . j.s .",
    "provan , sudoku : strategy versus structure , _ amer . math .",
    "monthly _ 116 ( 2009 ) , 702 - 707 ."
  ],
  "abstract_text": [
    "<S> we consider a mathematical model for the classical sudoku puzzle , which we call the primal problem and introduce a corresponding dual problem . both problems are constraint satisfaction models and a duality relation between them </S>",
    "<S> is proved . </S>",
    "<S> based on these models , we introduce a primal and a dual optimization problem and show weak and strong duality properties . </S>"
  ]
}