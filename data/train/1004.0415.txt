{
  "article_text": [
    "an _ extension _ @xmath0 of a metric space @xmath1 is a metric space with @xmath2 and @xmath3 , and is said to be _ tight _ if there is no other extension @xmath4 of @xmath1 with @xmath5 .",
    "isbell  @xcite and dress  @xcite independently found that there exists a _ universal _ tight extension with property that it contains every tight extension as a subspace .",
    "the universal tight extension is realized by the set of minimal elements of the polyhedron @xmath8 in @xmath9 , which is called the _ injective hull _ or the _",
    "tight span_. the tight span reflects , in geometric way , several hidden combinatorial properties of @xmath6 .",
    "for example , @xmath6 is a tree metric if and only if its tight span is a tree ( one - dimensional contractible complex ) ; see ( * ? ? ? * theorem 8) .",
    "this property reinterprets the classical _ tree metric theorem _",
    "@xcite , and has a significance in the phylogenetic tree reconstruction in the biological sciences .",
    "tight spans also arise in quite different contexts , including the _",
    "@xmath10-server problem _ in computer sciences  @xcite and the _ multicommodity flows problems _ in combinatorial optimization  @xcite . in applications",
    "to both areas , the geometry of tight spans and the above - mentioned universality play crucial roles .",
    "the goal of this paper is to develop an analogous theory of tight spans for directed distances and metrics .",
    "a _ directed distance _",
    "@xmath11 on a set @xmath12 is a nonnegative real - valued function @xmath13 having zero diagonals @xmath14 @xmath15 .",
    "a directed distance @xmath11 is said to be a _ directed metric _ if it satisfies the triangle inequalities @xmath16 @xmath17 . in both definitions",
    ", we do not impose the symmetric condition @xmath18 .",
    "a pair @xmath0 of a set @xmath12 and its directed metric @xmath11 is called a _ directed metric space_. we can define the concept of tight extensions in the same way .",
    "the motivation for our theory comes from the following natural questions :    * _ does there exist the universal tight extension ? _ * _ if exists , does its geometry characterize a class of combinatorial distances , related to directed versions of tree metrics ? _ * _ are there reasonable applications to the study of multicommodity flows in directed networks ? _",
    "the main contribution of this paper answers these questions affirmatively . in particular a directed analogue of the tight span does exist .",
    "furthermore we newly introduce another natural class of extensions , called _ cyclically tight extensions .",
    "_ interestingly , it has an unexpected connection to the theory of _ tropical polytopes _ , developed by develin and sturmfels  @xcite .",
    "in fact , we show that the tropical polytope generated by the distance matrix of @xmath6 has the universal embedding property for cyclically tight extensions . in section  [ sec : tightspans ] , for a directed distance @xmath6 , we define a directed analogue @xmath19 of the tight span ( the _ directed tight span _ ) as the set of minimal points in an unbounded polyhedron @xmath20 associated with @xmath6 .",
    "the tropical polytope is the projection @xmath21 of the set @xmath22 of minimal points in another polyhedron associated with @xmath6 .",
    "we introduce a well - behaved _ section _ , a subset in @xmath22 projected bijectively into @xmath21 , called a _ balanced section_. we endow @xmath19 , @xmath22 , and any balanced section @xmath23 with a directed analogue of the @xmath24-metric .",
    "we investigate the behaviors of these directed metric spaces , which is placed in the main body of section  [ sec : tightspans ] .",
    "then we prove the universal embedding properties that every tight extension of a metric @xmath6 is isometrically embedded into the tight span @xmath19 , and every cyclically tight extension is isometrically embedded into a balanced section of @xmath22 ( theorem  [ thm : extension ] ) .    in section  [ sec : dim1 ]",
    ", as an application of the embedding property and the dimension criteria , we prove that some classes of distances realized by _ oriented trees _ can be characterized by one - dimensionality of tight spans and tropical polytopes ( theorems  [ thm : path ] and [ thm : tree ] ) . in particular , we prove the following directed version of the tree metric theorem : _ a directed metric @xmath6 is a directed tree metric if and only if the tropical rank of @xmath7 is at most @xmath25 _ ( corollary  [ cor : treemetric ] ) .",
    "this complements the argument in ( * ? ? ?",
    "* section 5 ) .    in section  [ sec : multiflows ]",
    ", we briefly sketch how tight spans and tropical polytopes are applied to the study of directed multicommodity flow problems .",
    "we prove that the linear programming dual to multicommodity flow problems reduces to _ facility location problems _ on tight spans and tropical polytopes ( theorems  [ thm : tdual ] and [ thm : qdual ] ) .",
    "further study of this approach will be given in the next paper  @xcite .",
    "[ [ notation . ] ] notation .",
    "+ + + + + + + + +    the sets of real numbers and nonnegative real numbers are denoted by @xmath26 and @xmath27 , respectively . for a set @xmath28",
    ", the sets of functions from @xmath28 to @xmath26 and from @xmath28 to @xmath29 are denoted by @xmath30 and @xmath31 , respectively . for a subset @xmath32 , the characteristic function @xmath33 is defined by @xmath34 for @xmath35 and @xmath36 for @xmath37 .",
    "we particularly denote by @xmath38 the all - one function @xmath39 in @xmath30 .",
    "the singleton set @xmath40 is often denoted by @xmath41 , such as @xmath42 instead of @xmath43 . for @xmath44 ,",
    "@xmath45 means @xmath46 for each @xmath47 , and @xmath48 means @xmath49 for each @xmath47 . for @xmath50",
    ", @xmath51 is a point in @xmath52 defined by @xmath53 for @xmath47 . for a set @xmath54 in @xmath52 , a point @xmath55 in @xmath54",
    "is said to be _ minimal _ if there is no other point @xmath56 with @xmath57 .    in this paper , a directed metric ( distance )",
    "is often simply called a metric ( distance ) . a metric ( distance ) in the ordinary sense is particularly called an _ undirected metric _",
    "( _ undirected distance _ ) .",
    "we use the terminology of undirected metrics in an analogous way ( we do not know any reference including a systematic treatment for directed metrics ) . for two",
    "directed metric spaces @xmath0 and @xmath58 , an _",
    "isometric embedding _ from @xmath0 to @xmath58 is a map @xmath59 satisfying @xmath60 for all ( ordered ) pairs @xmath61 . for a directed metric @xmath11 on @xmath12 , and two subsets @xmath62 , let @xmath63 denote the minimum distance from @xmath64 to @xmath65 : @xmath66 in our theory ,",
    "the following directed metric @xmath67 on @xmath52 is particularly important : @xmath68    for an directed or undirected graph @xmath69 , its vertex set and edge set are denoted by @xmath70 and @xmath71 , respectively .",
    "if directed , an edge with tail @xmath72 and head @xmath73 is denoted by @xmath74 .",
    "if undirected , we do not distinguish @xmath74 and @xmath75 .",
    "in this section , we introduce and study the tight span and the tropical polytope of a directed distance .",
    "let @xmath6 be a directed distance on a finite set @xmath76 .",
    "let @xmath77 and @xmath78 be copies of @xmath76 . for an element @xmath79 , the corresponding elements in @xmath77 and @xmath78 are denoted by @xmath80 and @xmath81 , respectively .",
    "we denote @xmath82 by @xmath83 . for a point @xmath84 , the restrictions of @xmath55 to @xmath77 and @xmath78",
    "are denoted by @xmath85 and @xmath86 , respectively , i.e. , @xmath87 .",
    "we define the following polyhedral sets : @xmath88 we call @xmath19 the _ directed tight span _ , or simply , the _ tight span_. the polyhedron @xmath89 has the linearity space @xmath90 . the natural projection of vector @xmath91 to @xmath92",
    "is denoted by @xmath93 .",
    "the projection @xmath21 of @xmath22 coincides with the _ tropical polytope _ generated by @xmath76 by @xmath76 matrix @xmath94 ; see develin and sturmfels  @xcite .",
    "we note the following relation : @xmath95 here the arrow means the projection . in the inclusions , @xmath96 is a subcomplex of @xmath19 , and @xmath19 is a subcomplex of @xmath20 .",
    "a subset @xmath97 is called a _ section _ if the projection @xmath98 is bijective .",
    "a subset @xmath99 is said to be _ balanced _ if there is no pair @xmath100 of points in @xmath23 such that @xmath101 or @xmath102 .",
    "we are mainly interested in balanced sections .",
    "we metrize these subsets as follows .",
    "let @xmath103 be a directed metric on @xmath104 defined as @xmath105 as subspaces of @xmath106 , we obtain directed metric spaces @xmath107 , @xmath108 , @xmath109 , and @xmath110 for any balanced section @xmath97 .",
    "figure  [ fig : qmu ] illustrates those subsets for all - one distance @xmath6 on a 3-set @xmath111 . in this case , @xmath112 ( accidentally ) , @xmath22 is the union of three infinite strips with a common side , @xmath113 is a _ folder _ consisting of three triangles , and @xmath21 is a star of three leaves .",
    "here @xmath114 is a vector in @xmath104 consisting of the @xmath41-th column and the @xmath41-th row of @xmath6 ; see section  [ subsec : embedding ] for definition .",
    "the rest of this section is organized as follows . in the next section  [ subsec : basic ] ,",
    "we present basic properties of these polyhedral sets . in section  [ subsec :",
    "nonexpansive ] , we prove the existence of certain _ nonexpansive retractions _ among them .",
    "this is the most substantial part of this section . in section  [ subsec : embedding ] , we show that @xmath115 , and any balanced section are _ geodesic _ in the _ directed _ sense .",
    "also we show that distance @xmath6 is _ embedded into _ them . in section  [ subsec :",
    "extension ] , we introduce notions of tight extensions and cyclically tight extensions of a directed metric space @xmath1 , and prove that @xmath19 and @xmath113 have the universal embedding properties for tight extensions and cyclically tight extensions , respectively . in section  [ subsec : dimension ] , we present dimension criteria for @xmath19 and @xmath21 . in the sequel ,",
    "@xmath6 is supposed to be a distance on a finite set @xmath76 , without noted .      here",
    "we briefly summarize some fundamental properties of @xmath19 , @xmath22 , and @xmath113 .",
    "for a point @xmath84 , we denote by @xmath116 the bipartite graph with bipartition @xmath117 and edge set @xmath118 .",
    "the minimality of @xmath55 can be rephrased in terms of @xmath116 as follows .",
    "[ lem : minimality ]    * a point @xmath55 in @xmath20 belongs to @xmath19 if and only if @xmath116 has no isolated vertices @xmath119 with @xmath120 . *",
    "a point @xmath55 in @xmath121 belongs to @xmath22 if and only if @xmath116 has no isolated vertices .",
    "the next lemma says that the projections of @xmath19 and of @xmath22 to @xmath122 ( or @xmath123 ) are isometries .",
    "so we can consider @xmath124 , @xmath125 , and @xmath113 in @xmath126 .",
    "[ lem : mutual ]    * @xmath127 for @xmath128 and for @xmath129 . * for @xmath129 , @xmath101 if and only if @xmath130 .    ( 1 ) .",
    "suppose @xmath131 for @xmath132 .",
    "by lemma  [ lem : minimality ] , there is @xmath133 such that @xmath134 .",
    "hence , @xmath135 . thus @xmath136 .",
    "similarly @xmath137 .",
    "suppose @xmath101 . if @xmath138 for some @xmath139 , then there is @xmath140 with @xmath141 , and @xmath142 ; a contradiction to @xmath143 .",
    "next we study the local structure of @xmath19 .",
    "for a point @xmath144 , let @xmath145 denote the face of @xmath19 that contains @xmath55 in its relative interior .",
    "suppose that @xmath116 has @xmath10 ( bipartite ) components having no vertices @xmath146 with @xmath147 .",
    "let @xmath148 be bipartitions of these components .",
    "then the affine span of @xmath145 is given by @xmath149 therefore the dimension of @xmath145 is given as follows ; compare ( * ? ? ?",
    "* proposition 17 ) .",
    "[ lem : dim ] for a point @xmath144 , the dimension of @xmath145 is equal to the number of connected components of @xmath116 having no vertex @xmath41 with @xmath150 .",
    "we end this subsection with a seemingly obvious lemma .",
    "[ lem : section ] for any balanced set @xmath151 , there exists a balanced section @xmath152 containing @xmath65 . if @xmath153 , then there exists a balanced section @xmath154 containing @xmath65 .",
    "let @xmath65 be a balanced set in @xmath22 .",
    "by zorn s lemma , we can take an inclusion - maximal balanced set @xmath152 containing @xmath65 .",
    "we show that @xmath23 is a section .",
    "suppose not .",
    "then there is @xmath155 with @xmath156 .",
    "let @xmath157 .",
    "for each point @xmath158 , let @xmath159 be the set of points @xmath55 in @xmath160 such that @xmath161 is balanced",
    ". then @xmath159 is a closed segment in @xmath160 ; see below .",
    "we claim :    * for every balanced pair @xmath162 , the intersection @xmath163 is nonempty .",
    "suppose true .",
    "by helly property of segments on a line , the intersection @xmath164 is nonempty .",
    "take any point @xmath165",
    ". then @xmath166 is balanced , which contradicts the maximality of @xmath65 .",
    "so we show ( @xmath167 ) . in the following , for @xmath168",
    "we simply denote @xmath169 and @xmath170 by @xmath171 and @xmath172 , respectively .",
    "@xmath159 is indeed a segment given by @xmath173 , where @xmath174 and @xmath175 .",
    "this follows from : @xmath176 is balanced @xmath177 @xmath178 and @xmath179 @xmath177 @xmath180 and @xmath181 ( lemma  [ lem : mutual ]  ( 2 ) ) .",
    "therefore , if @xmath182 , then either @xmath183 or @xmath184 holds , and this implies @xmath185 or @xmath186 , i.e. , @xmath187 is not balanced .    for the latter part , by the same helly idea , it suffices to show that @xmath188 is nonempty , and @xmath189 is nonempty if @xmath190 . as @xmath191 is given by @xmath192 , it is nonempty by @xmath193 .",
    "moreover , if @xmath194 , then either @xmath195 or @xmath196 holds ; both cases are impossible by @xmath197 .",
    "the goal of this subsection is to show the existence of several _ nonexpansive retractions _ from @xmath20 to @xmath19 , from @xmath19 to @xmath96 , and from @xmath22 to any balanced section . at the first glance , they are seemingly technical lemmas",
    ". however it will turn out that many important properties can be easily derived from them .",
    "the first retraction lemma is about @xmath198 , which is a natural extension of ( * ? ? ?",
    "* ( 1.9 ) ) .",
    "[ lem : nonexpansive ] there exists a map @xmath199 such that    * @xmath200 for @xmath201 ( and thus @xmath202 for @xmath144 ) , and * @xmath203 for @xmath204 .",
    "the property ( 2 ) says that this map @xmath205 does not expand the distance of any pair of points in @xmath20 .",
    "a map between metric spaces with this property is said to be _",
    "nonexpansive_. in a directed metric space @xmath0 , there is another notion of nonexpansiveness . by a _ cycle _ in @xmath12 we mean a cyclic permutation @xmath206 of ( possibly repeated ) points @xmath207 .",
    "for a cycle @xmath208 , the _ length _ @xmath209 is defined by @xmath210 for a map @xmath211 , let @xmath212 denote the cycle @xmath213 . then there is a retraction from @xmath19 to @xmath96 not expanding the length of every cycle .    [",
    "lem : cyclic_nonexpansive ] there exists a map @xmath214 such that    1 .",
    "@xmath215 for @xmath216 , and 2 .",
    "@xmath217 for every cycle @xmath218 in @xmath19 .",
    "we call a map with property ( 2 ) _ cyclically nonexpansive_. any nonexpansive map is cyclically nonexpansive , and the converse is not true in general .",
    "two notions coincide in undirected metric spaces .",
    "let @xmath97 be a balanced section .",
    "for any point @xmath143 , there uniquely exists @xmath219 with @xmath220 . from this correspondence ,",
    "we obtain a retraction @xmath221 .",
    "again @xmath222 is cyclically nonexpansive .",
    "[ lem : balanced ] let @xmath97 be a balanced section .",
    "* @xmath223 for every cycle @xmath218 in @xmath22 , and * subset @xmath224 is balanced if and only if @xmath225 holds for every cycle @xmath218 in @xmath226 .",
    "we give a remark concerning the continuity of these maps .",
    "recall that any nonexpansive map between undirected metric spaces is always continuous ( with respect to the metric topology ) .",
    "[ rem : continuity ] one can see that map @xmath227 defines a norm @xmath228 in @xmath104 .",
    "the corresponding distance @xmath229 equals to @xmath230 .",
    "therefore any cyclically nonexpansive retraction is nonexpansive in this metric , and is continuous with respect to the topology induced by this norm . since any norm in @xmath231 defines the same topology , it is continuous with respect to the euclidean topology . as a consequence , all @xmath232 are contractible ( the contractibility of tropical polytopes was shown in @xcite ) .",
    "in particular , any balanced section is a continuous section .",
    "the rest of this subsection is devoted to proving three lemmas . for a nonzero vector @xmath91 and a nonnegative real @xmath233 ,",
    "let @xmath234 : p_{\\mu } \\to p_{\\mu}$ ] be the map defined by @xmath235(p ) = p + v   \\max \\",
    "{ \\epsilon \\in [ 0,\\alpha ] \\mid p + \\epsilon v \\in p_{\\mu}\\ } \\quad ( p \\in p_{\\mu}).\\ ] ] this map moves each point in @xmath20 toward direction @xmath236 in same speed as much as possible within time @xmath237 . let @xmath238 : = \\lim_{\\alpha \\rightarrow \\infty } \\phi[v,\\alpha]$ ] , which is well - defined if @xmath236 has a negative component . by definition ,",
    "@xmath238 $ ] is identity on the set of points @xmath55 such that the tangent cone of @xmath20 at @xmath55 does not contain @xmath236 .",
    "we will construct required retractions as the composition of @xmath238 $ ] for several vectors @xmath236 .",
    "[ [ proof - of - lemmalemnonexpansive . ] ] proof of lemma  [ lem : nonexpansive ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for @xmath79 , let @xmath239 \\circ \\phi[-\\11_{s^r}]$ ] .",
    "let @xmath240 and let @xmath241 .",
    "we remark that the map @xmath242 $ ] decreases the @xmath119-th component of each point @xmath55 as much as possible , or equivalently , until ( @xmath167 ) @xmath147 or there appears an edge covering @xmath119 in @xmath116 ( lemma  [ lem : minimality ]  ( 1 ) ) . from this",
    ", we see that @xmath205 is a retraction from @xmath243 to @xmath19 with property ( 1 ) .",
    "so it suffices to show that @xmath244 is nonexpansive for @xmath79 .",
    "take @xmath245 .",
    "it suffices to compare their @xmath80- and @xmath81-components . by ( @xmath167 )",
    "we have @xmath246 and @xmath247 .",
    "thus @xmath248 and @xmath249 .",
    "consequently we have @xmath250 .",
    "this proof method is a direct adaptation of that of ( * ? ? ?",
    "* ( 1.9 ) ) .",
    "[ [ proof - of - lemmalemcyclic_nonexpansive . ] ] proof of lemma  [ lem : cyclic_nonexpansive ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    by lemma  [ lem : minimality ] , any point @xmath251 has isolated vertices in @xmath116 . since @xmath252",
    ", the set @xmath253 of isolated vertices in @xmath116 belongs to either @xmath77 or @xmath78 .",
    "if @xmath254 , then @xmath255 for small @xmath256 , and if @xmath257 , then @xmath258 for small @xmath256 . on the other hand , if @xmath259 , then @xmath260 and @xmath261 for any nonempty proper subset @xmath262 .",
    "define @xmath263 $ ] and @xmath264 $ ] for a nonempty proper subset @xmath262",
    ". then both @xmath265 and @xmath266 are identity on @xmath96 .",
    "order all nonempty proper subsets @xmath267 @xmath268 of @xmath76 such that @xmath269 implies @xmath270 .",
    "consider point @xmath144 whose @xmath116 has nonempty set @xmath253 of isolated vertices in @xmath77 .",
    "apply all maps @xmath271 ( @xmath272 ) to @xmath55 according to the ordering of subsets @xmath273 . in a step @xmath274 , point @xmath55 moves if and only if @xmath275 .",
    "if moves , then it moves until some @xmath276 is covered by edges .",
    "so the set @xmath253 of isolated vertices decreases . by the definition of the ordering",
    ", there is a step @xmath277 such that @xmath278 .",
    "therefore , after the procedure , @xmath116 has no isolated vertex , i.e. , @xmath259 .",
    "motivated by this , let us define @xmath279 and @xmath280 . by the argument above",
    ", @xmath281 is a retraction from @xmath124 to @xmath282 .",
    "so it suffices to verify that @xmath265 is cyclically nonexpansive for each @xmath262 .",
    "take any cycle @xmath283 in @xmath19 . for @xmath233 , let @xmath284",
    "define function @xmath285 by @xmath286 for @xmath287 , which is piecewise linear continuous .",
    "we show that @xmath288 is nonincreasing .",
    "it suffices to verify that the right derivative of @xmath288 at @xmath289 is nonpositive .",
    "let @xmath290 be the set of indices @xmath274 such that @xmath291 for every @xmath256 .",
    "for a small @xmath292 , let @xmath293 .",
    "then @xmath294 if @xmath295 , and @xmath296 otherwise .",
    "we show @xmath297 .",
    "we may assume that there are indices @xmath298 such that @xmath299 and @xmath300 , where the indices are taken modulo @xmath301 .",
    "for @xmath302 , we have @xmath303 .",
    "consider @xmath304 .",
    "since @xmath305 , there is an edge @xmath306 in @xmath307 connecting @xmath308 and @xmath78 .",
    "then @xmath309 , where we use @xmath310 by @xmath311 and @xmath312 ( since @xmath80 is isolated in @xmath313 ) . by lemma  [ lem :",
    "mutual ] and @xmath314 , we have @xmath315 next consider @xmath316 . by lemma  [ lem :",
    "mutual ] again , we have @xmath317 thus @xmath318 consequently we obtain @xmath319 .",
    "[ [ proof - of - lemmalembalanced . ] ] proof of lemma  [ lem : balanced ] .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    it suffices to show ( 1 - 2 ) for one particular balanced section @xmath23 .",
    "let @xmath320 be a cycle in @xmath125 .",
    "since any translation of @xmath23 preserves @xmath103-distances among points in @xmath23 , we may assume ( @xmath321 ) @xmath322 for any point @xmath55 in @xmath218 .",
    "we use the same idea as above . for @xmath233 , let @xmath323 be a map defined by @xmath324   \\mid p^c + \\epsilon \\11 \\leq ( \\varphi_{r}(p))^c   \\}.\\ ] ] then @xmath325 . let @xmath290 be the set of indices @xmath274 with @xmath326 for every @xmath327",
    ". for a small @xmath328 , let @xmath329 .",
    "it suffices to show @xmath297 .",
    "we may assume that there are indices @xmath298 such that @xmath299 and @xmath300 , where the indices are taken modulo @xmath301 .",
    "for @xmath302 , we have @xmath303",
    ". then @xmath330 . here",
    "the last equality follows from @xmath331 by the assumption ( @xmath321 ) and the balancedness of @xmath23 ( and lemma  [ lem : mutual ]  ( 2 ) ) .",
    "moreover , we have ( @xmath332 ) @xmath333 .",
    "hence we have @xmath297 . here the last inequality in ( @xmath332 ) holds strictly if and only if @xmath334 , i.e. , @xmath335 is not balanced .",
    "consequently we have the claim ( 1 - 2 ) .      a _ path _",
    "@xmath54 in @xmath104 is the image of a continuous map @xmath336 \\to \\rr^{s^{cr}}$ ] ( with respect to the euclidean topology ) .",
    "its _ length from @xmath337 to @xmath338 _ is defined by @xmath339 where the supreme is taken over all @xmath340 and @xmath341 .",
    "any segment @xmath342 $ ] has the length @xmath343 from @xmath55 to @xmath344 since @xmath345 for @xmath346 $ ] .",
    "a subset @xmath23 in @xmath104 is said to be _ geodesic _ if for each pair @xmath347 there exists a path in @xmath23 of length @xmath343 from @xmath55 to @xmath344 .",
    "[ prop : geodesic ] @xmath19 , @xmath22 , @xmath348 , and any balanced section @xmath97 are all geodesic .",
    "we show a general statement :    * for @xmath349 , suppose that @xmath350 is geodesic and there is a cyclically nonexpansive retraction @xmath351 from @xmath350 to @xmath23 .",
    "then @xmath23 is also geodesic .    for @xmath347 , take a path @xmath54 connecting @xmath55 and @xmath344 in @xmath350 of length @xmath343 from @xmath55 to @xmath344 .",
    "suppose that @xmath54 is the image of @xmath336 \\to r'$ ] with @xmath352 .",
    "the image @xmath353 of the cyclically nonexpansive retraction @xmath351 is also a path in @xmath23 connecting @xmath55 and @xmath344 ; see remark  [ rem : continuity ] .",
    "we show that @xmath353 has length @xmath343 from @xmath55 to @xmath344 . for @xmath354 and @xmath340 , consider cycle @xmath355 . then @xmath217 .",
    "since @xmath356 , we have @xmath357 thus @xmath353 has the length @xmath343 from @xmath55 to @xmath344 , and @xmath23 is geodesic . since @xmath20 is geodesic by convexity , lemmas  [ lem : nonexpansive ] , [ lem : cyclic_nonexpansive ] , and [ lem : balanced ] imply that @xmath19 , @xmath113 , and any balanced section in @xmath113 are geodesic .",
    "next we show that an arbitrary balanced section @xmath23 in @xmath22 is geodesic .",
    "take any balanced section @xmath350 in @xmath358 .",
    "then the restriction of @xmath359 to @xmath23 is a bijection , and the inverse map is given by @xmath360 . for @xmath347 ,",
    "take a path @xmath361 connecting @xmath362 and @xmath363 of length @xmath364 from @xmath362 to @xmath363 . consider the image @xmath365 , which is a path connecting @xmath55 and @xmath344 . by lemma  [ lem : balanced ] , @xmath366 plus the length of @xmath365 from @xmath55 to @xmath344 is equal to @xmath367 plus the length @xmath364 of @xmath54 from @xmath362 to @xmath363 . since @xmath368 , the length of @xmath365 from @xmath55 to @xmath344 coincides with @xmath343 .",
    "thus @xmath23 is geodesic .",
    "finally , we show that @xmath22 is geodesic .",
    "take a pair @xmath100 in @xmath22 .",
    "if @xmath161 is balanced , then take a balanced section containing @xmath100 and apply the argument above .",
    "so suppose that @xmath161 is not balanced .",
    "then we can take a point @xmath369 such that @xmath370 is balanced , @xmath371 , and @xmath372 .",
    "take a path @xmath373",
    "connecting @xmath374 of length @xmath375 from @xmath55 to @xmath376 . consider path @xmath377",
    "\\subseteq q_{\\mu}$ ] , which connects @xmath55 and @xmath344 with length @xmath343 from @xmath55 to @xmath344 .",
    "next we show that @xmath6 is realized by @xmath103-distances among a certain subsets in @xmath19 , @xmath113 , and any balanced section @xmath23 in @xmath113 .",
    "further we denote by @xmath378 , @xmath379 , and @xmath380 , the set of points @xmath55 with @xmath381 in @xmath19 , @xmath348 , and @xmath23 , respectively . for each @xmath79 , we define three vectors @xmath382 by @xmath383 both @xmath384 and @xmath385 belong to @xmath378 . in particular @xmath384 and @xmath385",
    "are unique maximal points in @xmath378 with respect the coordinates in @xmath77 and in @xmath78 , respectively . now",
    "the embedding properties of @xmath19 and @xmath113 are summarized as follows :    [ prop : embedding ] the following properties hold :    * @xmath386 for each @xmath79 and any balanced section @xmath387 .",
    "* @xmath388 for @xmath144 and @xmath79 . * @xmath389 for all @xmath390 . *",
    "if @xmath6 is a directed metric , then @xmath391 for each @xmath79 .",
    "the property ( 2 ) means that the coordinate @xmath392 ( resp .",
    "@xmath393 ) is the @xmath103-distance from @xmath378 to @xmath55 ( resp .",
    "@xmath55 to @xmath378 ) .",
    "the point @xmath394 plays a role of an _ entrance _ of @xmath378 ; every point can enter @xmath378 through @xmath394 .",
    "the point @xmath395 is an _ exit _ of @xmath378 .",
    "the property ( 3 ) means that distance @xmath6 can be realized by @xmath103-distances among @xmath378 . by ( 4 ) ,",
    "if @xmath6 is a metric , then each @xmath378 is a single point , and @xmath1 is isometrically embedded into @xmath396 , @xmath397 , and @xmath110 by the map @xmath398 .",
    "let @xmath55 be a point in @xmath378 .",
    "by @xmath381 , if @xmath147 , then @xmath119 is incident to @xmath80 or @xmath81 in @xmath116 .",
    "thus @xmath116 has no isolated vertex , which implies @xmath259 .",
    "moreover , for any @xmath256 , the point @xmath399 has a negative coordinate in @xmath80 or @xmath81 .",
    "thus @xmath400 .",
    "this means that every section in @xmath113 contains @xmath378 .",
    "since every @xmath401 satisfies @xmath402 , we have @xmath403 .",
    "thus , it follows that @xmath404 .",
    "conversely we have @xmath405 for all @xmath133 , which implies @xmath406 ( by lemma  [ lem : mutual ]  ( 1 ) ) .",
    "( 3 ) . since @xmath407 for all @xmath408 and @xmath409 for all @xmath401",
    ", we have @xmath410 .",
    "conversely , by ( 2 ) , @xmath411 .",
    "take @xmath408 . for each @xmath412",
    ", we have @xmath413 and @xmath414 . since @xmath415 holds for some @xmath119",
    ", we have @xmath416 , where we use the triangle inequality for the last inequality .",
    "thus @xmath417 , and similarly @xmath418 .",
    "[ rem : tmu_s ] @xmath378 is also contractible since it is a retract of @xmath419 by @xmath205 in lemma  [ lem : nonexpansive ] .",
    "the goal of this section is to show that the tight span and ( a fiber of ) the tropical polytope have universal embedding properties for metric extensions .",
    "let @xmath1 be a directed metric space .",
    "a directed metric space @xmath0 is called an _ extension _ of @xmath1 if @xmath2 and @xmath420 for @xmath390 .",
    "an extension @xmath0 is said to be _ tight _ if there is no extension @xmath4 with @xmath5 and @xmath421 .",
    "an extension @xmath0 is said to be _ cyclically tight _ if there is no extension @xmath4 of @xmath1 such that @xmath422 for all cycles @xmath218 in @xmath12 and @xmath423 for some cycle @xmath424 . for convention",
    ", we also use the notions of extension and tightness for metric functions , such as `` @xmath11 is a cyclically tight extension of @xmath6 . ''    by proposition  [ prop : embedding ]  ( 3 - 4 ) , @xmath396 , @xmath109 , and @xmath110 for any balanced section @xmath154 are all extensions of @xmath1 . for an extension @xmath0 of @xmath1 and @xmath425",
    ", we define vector @xmath426 by @xmath427 the main result of this section is the following :    [ thm : extension ] let @xmath1 be a directed metric space , and @xmath0 its extension .",
    "* @xmath11 is tight if and only if there exists an isometric embedding @xmath428 such that @xmath429 for @xmath79 .",
    "* @xmath11 is cyclically tight if and only if there exists an isometric embedding @xmath430 such that @xmath429 for @xmath79 and @xmath431 is balanced .",
    "moreover , if tight , then such an isometric embedding @xmath432 coincides with @xmath433 @xmath15 .",
    "in particular , ( 1 ) says that @xmath107 is a unique inclusion - maximal tight extension of @xmath1 .",
    "( 2 ) says that @xmath96 plays a role of the tight span with respect to the cyclic tightness .",
    "in contrast to tight extensions , there are many maximal cyclically tight extensions , which correspond to balanced sections in @xmath282 .",
    "suppose that @xmath11 is tight .",
    "define @xmath434 by @xmath435 @xmath15 .",
    "then @xmath436 for @xmath79 . by triangle inequality , we have @xmath437 . by tightness",
    ", we have @xmath438 . since @xmath439",
    ", each @xmath435 belongs to @xmath20 .",
    "furthermore each @xmath440 belongs to @xmath19 . consider a nonexpansive retraction @xmath205 in lemma  [ lem : nonexpansive ] . by proposition",
    "[ prop : embedding ]  ( 2 ) , @xmath441 . by tightness , @xmath442 and thus @xmath443 for @xmath425 .",
    "we next show the if part .",
    "let @xmath444 be an isometric embedding . by proposition  [ prop : embedding ]  ( 2 )",
    ", we have @xmath445 for @xmath79 .",
    "thus @xmath435 for @xmath425 .",
    "take a tight extension @xmath446 on @xmath12 with @xmath5 .",
    "each @xmath447 belongs to @xmath243 as above .",
    "since @xmath448 and @xmath449 is minimal in @xmath243 , we have @xmath450 .",
    "consequently @xmath451 , and therefore @xmath11 is tight .",
    "suppose that @xmath11 is cyclically tight .",
    "since @xmath11 is tight , by ( 1 ) it suffices to show that @xmath452 is balanced and is a subset in @xmath96 . by lemma  [ lem : balanced ] , @xmath452 is necessarily balanced .",
    "we verify @xmath453 for each @xmath425 .",
    "suppose that @xmath454 has an isolated vertex @xmath132 ( or @xmath139 ) . by the construction of map @xmath351 in lemma  [ lem : cyclic_nonexpansive ] , @xmath455 strictly decreases . a contradiction to the cyclic tightness of @xmath11 .",
    "we next show the if part .",
    "we show that @xmath11 is cyclically tight .",
    "take a cyclically tight extension @xmath446 on @xmath12 such that @xmath422 for every cycle in @xmath12 . by lemma  [ lem : balanced",
    "] , it suffices to show @xmath456 for @xmath425 .",
    "since @xmath457 for all @xmath390 and @xmath425 , we have @xmath458 , that is @xmath459 . in particular , for an edge @xmath460 in @xmath454 , we have @xmath461 , and hence @xmath462 . therefore , for two edges @xmath460 and @xmath463 in @xmath454",
    ", we have ( @xmath167 ) @xmath464 .",
    "since @xmath454 has no isolated vertex , it follows from ( @xmath167 ) that @xmath465 .",
    "two directed metrics @xmath466 on the same set @xmath12 are said to be _ congruent _ if @xmath467 for each cycle @xmath218 in @xmath12 .",
    "then @xmath11 and @xmath446 are congruent if and only if there is @xmath468 such that @xmath469 this is a simple consequence of the well - known fact in the network flow theory that any circulation in a directed network is the sum of the incidence vectors of cycles ; see @xcite .",
    "the tropical polytope @xmath470 describes all congruence classes of cyclically tight extensions .",
    "this establishes a role of tropical polytopes in metric extensions . for map",
    "@xmath471 , let @xmath472 be the map obtained by projecting @xmath473 to @xmath21 .    [ prop : congruent ] let @xmath1 be a directed metric space , and let @xmath474 .    * two cyclically tight extensions @xmath466 of @xmath6 on @xmath12 are congruent if and only if @xmath456 for each @xmath425 . *",
    "a directed metric @xmath11 on @xmath12 is congruent to a cyclically tight extension of @xmath6 if and only if there exists an isometric embedding @xmath471 such that @xmath475 for @xmath79 and @xmath431 is balanced .",
    "the if part immediately follows from the previous theorem and lemma  [ lem : balanced ] ; take a balanced section @xmath23 containing @xmath452 , and apply @xmath222 to @xmath476 .",
    "observe that @xmath456 if and only if @xmath477 for all @xmath390 .",
    "therefore , @xmath478 implies @xmath479 for some @xmath390 .",
    "this proves the only - if part .",
    "we first show the if part .",
    "take any balanced section @xmath23 in @xmath96 ( with help of lemma  [ lem : section ] ) .",
    "consider @xmath480 .",
    "the corresponding metric @xmath446 on @xmath12 defined as @xmath481 is a cyclically tight extension of @xmath6 . by lemma  [ lem : balanced ] , @xmath11 and @xmath446 are congruent .",
    "next we show the only - if part .",
    "suppose that @xmath11 is congruent to a cyclically tight extension @xmath446 of @xmath6 .",
    "then there is @xmath482 such that @xmath483 for @xmath61 .",
    "let @xmath434 be a map defined by @xmath484 let @xmath485 be the metric on @xmath12 defined as @xmath486 .",
    "we claim @xmath487 .",
    "indeed , we have @xmath488 ( by triangle inequality ) .",
    "if @xmath431 is not balanced , then there is a cycle @xmath218 in @xmath12 such that @xmath489 .",
    "this is a contradiction to @xmath490 .",
    "thus @xmath431 is balanced and @xmath491 holds .      here we present matching - type criteria for dimensions of tight span @xmath19 and tropical polytope @xmath470 . for tropical polytopes ,",
    "such a criterion has already been given by @xcite .",
    "for two @xmath301-element subsets @xmath492 and @xmath493 , let @xmath494 be the complete bipartite graph with the bipartition @xmath495 .",
    "a _ matching _ is a subset of edges which have no common vertices .",
    "a matching @xmath496 is said to _ perfect _ if all vertices are covered by @xmath496 . for a matching @xmath496 ,",
    "let @xmath497 .",
    "we consider the following maximum matching problems :    mt : : :    maximize @xmath498 over all matchings @xmath496 in    @xmath494 .",
    "pmt : : :    maximize @xmath498 over all perfect matchings    @xmath496 in @xmath494 .",
    "since @xmath6 is nonnegative , the maximum values of two problems are same .",
    "our interest is how the maximum is attained .    for a positive integer @xmath301 ,",
    "the following two conditions are equivalent :    * @xmath499 .",
    "* there exist two @xmath301-element subsets @xmath492 and @xmath493 such that the maximum of mt is uniquely attained by a perfect matching @xmath496 .",
    "[ thm : dim ]    [ thm : trop_dim ] for a positive integer @xmath301 , the following two conditions are equivalent :    * @xmath500 .",
    "* there exist two @xmath301-element subsets @xmath492 and @xmath493 such that the maximum of pmt is uniquely attained .    in @xcite , the maximum integer @xmath301 with property ( b )",
    "is called the _ tropical rank _ of ( the distance matrix of ) @xmath501 .",
    "we give a proof sketch of theorem  [ thm : dim ] ; this proof method has already been established in @xcite and ( * ? ? ?",
    "* appendix ) .",
    "\\(a ) @xmath502 ( b ) .",
    "since @xmath499 , there exists @xmath144 such that @xmath116 has @xmath301 components having no vertex @xmath41 with @xmath150 ( lemma  [ lem : dim ] ) .",
    "let @xmath496 be a set of @xmath301 edges obtained from each of the @xmath301 components , and let @xmath492 and @xmath493 be the sets of vertices of @xmath496 . by construction",
    ", @xmath496 is a perfect matching of @xmath494 .",
    "then @xmath503 .",
    "take any matching @xmath504 in @xmath494",
    ". then @xmath505 by @xmath506 .",
    "so the equality is attained exactly when @xmath507 .",
    "\\(b ) @xmath502 ( a ) . with help of the bipartite matching theory  (",
    "* part ii ) and the strict complementary slackness theorem in linear programming , there is a positive vector @xmath508 such that @xmath509 for @xmath510 and @xmath511 otherwise .",
    "therefore , by the same argument in lemma  [ lem : dim ] , the set @xmath512 of minimal elements of polyhedron @xmath513 has dimension at least @xmath301 .",
    "any @xmath514 can be extended to @xmath515 so that @xmath201 . then decrease @xmath516 for @xmath517 so that @xmath144 .",
    "therefore the projection of @xmath19 to @xmath518 includes @xmath512 .",
    "this implies @xmath519 .",
    "a _ tree metric _ is a metric that can be represented as the graph metric of some tree . the _ tree metric theorem _",
    "@xcite says that an undirected metric @xmath6 on a set @xmath76 is a tree metric if and only if it satisfies the _ four point condition _ : @xmath520 see also ( * ? ? ?",
    "* chapter 7 ) .",
    "dress  @xcite interpreted the four point condition as a criterion for one - dimensionality of the undirected tight span of @xmath6 , and derived the tree metric theorem from the embedding property ; see also @xcite .",
    "in this section , we apply this idea to our directed versions of tight spans , and derive combinatorial characterizations of classes of distances realized by oriented trees .",
    "oriented tree _ is a directed graph whose underlying undirected graph is a tree . for an oriented tree @xmath521 and a nonnegative edge - length @xmath522 ,",
    "we define a directed metric @xmath523 on @xmath524 as follows . for two vertices @xmath525 , let @xmath526 $ ] denote the set of edges forming a unique path connecting @xmath527 in the underlying undirected tree , and let @xmath528 $ ] be the set of edges in",
    "@xmath526 $ ] whose direction is the same as the direction from @xmath72 to @xmath73 ; in particular @xmath526 = \\vec p[x , y ] \\cup \\vec p[y , x]$ ] ( disjoint union ) .",
    "then let @xmath529 \\}$ ] .",
    "for a distance @xmath6 on @xmath76 , an _ oriented - tree realization _",
    "@xmath530 consists of an oriented tree @xmath531 , a positive edge - length @xmath532 , and a family @xmath533 of subtrees in @xmath531 such that @xmath534 where a _ subtree _ is a subgraph whose underlying undirected graph is connected , and @xmath535 denotes the shortest distance from @xmath536 to @xmath537 .",
    "a _ directed path _ is an oriented tree each of whose vertices has at most one leaving edge and at most one entering edge .",
    "the main results in this section are the following :    [ thm : path ] for a directed distance @xmath6 on @xmath76 , the following conditions are equivalent :    * @xmath6 has an oriented - tree realization @xmath538 so that @xmath531 is a directed path .",
    "* @xmath539 . * for @xmath540 ( not necessarily distinct ) , we have @xmath541    [ thm : tree ] for a directed distance @xmath6 on @xmath76 , the following conditions are equivalent :    * @xmath6 has an oriented - tree realization @xmath538 so that each subtree @xmath536 is a directed path .",
    "* @xmath542 . * for @xmath543 ( not necessarily distinct ) , we have @xmath544 & & \\leq   \\max \\left\\ {     \\begin{array}{cc }   \\mu(x , v ) + \\mu(y , u ) + \\mu(z , w ) , & \\mu(x , v ) + \\mu(y , w ) + \\mu(z , u ) , \\\\",
    "\\mu(x , w ) + \\mu(y , u ) + \\mu(z , v ) , & \\mu(x , w ) + \\mu(y , v ) + \\mu(z , u ) , \\\\ \\mu(x , u ) + \\mu(y , w ) + \\mu(z , v ) \\end{array } \\right\\ } , \\\\\\end{aligned}\\ ] ]",
    "i.e. , the tropical rank of @xmath7 is at most @xmath25 .    in both theorems ,",
    "( b ) @xmath177 ( c ) follows from dimension criteria ( theorems  [ thm : dim ] and [ thm : trop_dim ] ) .",
    "we prove ( b ) @xmath502 ( a ) from embedding property ( proposition  [ prop : embedding ] ) .",
    "suppose first @xmath539 .",
    "then @xmath19 is a tree since @xmath19 is contractible ( remark  [ rem : continuity ] ) .",
    "recall ( [ eqn : coordinate ] ) . for each face ( segment )",
    "@xmath545 $ ] in @xmath19 , there are @xmath546 such that either @xmath547 or @xmath548 .",
    "therefore subspace @xmath549 , d_{\\infty})$ ] is isometric to the segment in @xmath550 .",
    "then an oriented - tree realization @xmath530 is obtained by the following way .",
    "the underlying undirected tree of @xmath531 is the @xmath551-skeleton graph of @xmath19 .",
    "we orient each undirected edge @xmath552 as @xmath553 when @xmath554 ( and @xmath555 ) .",
    "the edge - length @xmath556 is given by @xmath557 .",
    "consider @xmath378 , which is also the union of segments and is contractible ( remark  [ rem : tmu_s ] ) .",
    "let @xmath536 be its corresponding subgraph in @xmath531 , which is a subtree . by proposition  [ prop : geodesic ] ,",
    "the restriction of @xmath396 to the set of the vertices of @xmath19 is isometric to @xmath558 . by proposition  [ prop : embedding ]",
    "( 3 ) , @xmath6 is realized by @xmath559 .",
    "next we verify that @xmath521 is a directed path .",
    "suppose to the contrary that there is a vertex having two entering edges or two leaving edges .",
    "then there exists @xmath390 such that the unique path joining @xmath536 and @xmath537 passes through these two edges .",
    "then both @xmath560 and @xmath561 are positive .",
    "this contradicts ( c ) for the case @xmath562 .",
    "next suppose @xmath563 .",
    "consider the following section @xmath564 : @xmath565 then @xmath23 is balanced since it consists of points @xmath55 such that @xmath86 has a zero component .",
    "also @xmath23 is a subcomplex ( the union of faces ) of @xmath19 .",
    "therefore @xmath23 is also a tree each of whose segments is isometric to a segment in @xmath550 .",
    "similarly , from the @xmath551-skeleton of @xmath23 we obtain an oriented - tree realization @xmath566 of @xmath6 .",
    "we verify that each subtree @xmath536 is a directed path .",
    "suppose to the contrary that there is a vertex @xmath236 in @xmath536 such that @xmath236 has two entering edges or two leaving edges in @xmath536 .",
    "then we can take a point @xmath55 in @xmath378 such that @xmath567 or @xmath568 , which contradicts @xmath569 ( proposition  [ prop : embedding ]  ( 2 ) ) .",
    "next we show ( a ) @xmath502 ( b ) or ( c ) .",
    "suppose that @xmath6 is realized by @xmath530 .",
    "it suffices to consider the case where each @xmath536 is a single vertex . indeed , suppose that @xmath536 is a directed path of tail @xmath570 and head @xmath571 .",
    "let @xmath572 , and let @xmath573 and @xmath574 be subtrees consisting of singletons @xmath570 and @xmath571 , respectively .",
    "consider the new distance @xmath575 on @xmath576 by @xmath577 for @xmath578 .",
    "then the distance matrix of @xmath6 is obtained by deleting the @xmath579-th row and the @xmath580-th column from @xmath575 .",
    "namely @xmath6 is a submatrix of @xmath575 . by dimension criteria , @xmath581 and @xmath582 .",
    "so suppose that each @xmath536 is a single vertex ; in particular @xmath6 is a metric .",
    "we first show ( a ) @xmath502 ( c ) in the first theorem . now @xmath6 can be regarded as @xmath583-distances among points @xmath584 in the real line @xmath26 .",
    "namely @xmath585 for @xmath390 .",
    "take any @xmath540 .",
    "we verify the condition in ( c ) . if @xmath586 , then @xmath587 and @xmath588 .",
    "so we may assume that @xmath589 and @xmath590 .",
    "it suffices to consider three cases ( i ) @xmath591 , ( ii ) @xmath592 , and ( iii ) @xmath593 .",
    "( i ) implies @xmath594 .",
    "both ( ii ) and ( iii ) imply @xmath595 .",
    "finally we show ( a ) @xmath502 ( b ) in the second theorem ; we use an alternative approach to avoid case disjunctions .",
    "we claim :    * @xmath6 is congruent to some tree metric @xmath11 .",
    "suppose that ( @xmath167 ) is true .",
    "then there is @xmath596 such that @xmath597 @xmath598 .",
    "one can easily see that @xmath599 is a translation of @xmath125 .",
    "it is known that the dimension of the tropical polytope spanned by a tree metric is at most @xmath551  ( * ? ? ? * theorem 28 ) .",
    "therefore @xmath600 is also at most @xmath551 .",
    "we show the claim ( @xmath167 ) .",
    "now @xmath6 is realized by @xmath530 with each subtree @xmath536 being a single vertex @xmath601 . for an edge @xmath602 in @xmath531 ,",
    "let @xmath603 be the ordered bipartition of @xmath76 such that @xmath41 belongs to @xmath604 if and only if @xmath601 belongs to the connected component of @xmath605 containing the tail of @xmath602 .",
    "let @xmath606 be a directed metric on @xmath76 defined by @xmath607 by construction , we have @xmath608 then one can easily see that @xmath606 is congruent to @xmath609 . here",
    "@xmath610 coincides with the _ split metric _ of _ split _ ( bipartition ) @xmath611 .",
    "so @xmath6 is congruent to a nonnegative sum of split metrics for the pairwise _ compatible _ family of splits @xmath612 , which is just a tree metric ; see @xcite .",
    "a directed metric @xmath6 is called a _ directed tree metric _ if it has an oriented - tree realization @xmath530 such that each subtree @xmath536 is a single vertex . for a directed metric @xmath6 , let @xmath613 denote the metric obtained by transposing @xmath6 , i.e. , @xmath614 .",
    "the following corollary sharpens  ( * ? ? ?",
    "* theorem 28 ) , and includes a nonnegative version of  ( * ? ? ?",
    "* theorem 5 ) .",
    "[ cor : treemetric ] for a directed metric @xmath6 on @xmath76 , the following conditions are equivalent :    * @xmath6 is a directed tree metric .",
    "* @xmath6 is congruent to a tree metric . * @xmath615 satisfies the four point condition and @xmath616 holds for every triple @xmath617 .",
    "* the tropical rank of @xmath7 is at most @xmath25 .    in the proof of ( b ) @xmath502 ( a ) in the previous theorems ,",
    "if @xmath6 is a metric , then we can take @xmath536 as a single vertex since @xmath378 is a single point @xmath114 ( proposition  [ prop : embedding ]  ( 4 ) ) .",
    "so we obtain ( a ) @xmath502 ( b ) @xmath502 ( d ) @xmath502 ( a ) from the proof above .",
    "we verify ( b ) @xmath177 ( c ) .",
    "decompose @xmath6 as @xmath618 .",
    "then the second condition in ( c ) is rephrased as @xmath619 for every cycle @xmath218 consisting of three elements .",
    "one can easily see that this is equivalent to @xmath619 for every cycle @xmath218 , i.e. , @xmath6 is congruent to @xmath620 . from this fact and the tree metric theorem ,",
    "we obtain ( b ) @xmath177 ( c ) .",
    "originally our directed version of tight spans was motivated by the multicommodity flow theory in combinatorial optimization ; see ( * ? ? ?",
    "* section 17 ) and ( * ? ? ? * part vii ) . in this section , we briefly sketch how tight spans and tropical polytopes are applied to the study of multicommodity flows in directed networks ; see @xcite for applications of undirected tight spans to multicommodity flows in undirected networks .    by a _ network _ we mean a quadruple @xmath621 consisting of a directed graph @xmath622 , a specified vertex subset @xmath2 , and a nonnegative integer - valued edge - capacity @xmath623 .",
    "we call a vertex in @xmath76 a _ terminal_. a directed path @xmath54 in @xmath622 is called an _ @xmath76-path _ if @xmath54 connects distinct terminals in @xmath76 .",
    "a _ multiflow _ ( _ multicommodity flow _ ) is a pair @xmath624 of a set @xmath625 of @xmath76-paths and a nonnegative flow - value function @xmath626 satisfying the capacity constraint : @xmath627 let @xmath628 be a nonnegative weight defined on the set of all ordered pairs on terminals . for a multiflow @xmath629 ,",
    "its _ flow - value _ @xmath630 is defined by @xmath631 , where @xmath632 and @xmath633 denotes the starting vertex and the end vertex of @xmath54 , respectively .",
    "namely @xmath560 represents a value of a unit @xmath634-flow .",
    "the @xmath6-weighted maximum multiflow problem is formulated as follows .",
    "mcf : : :    maximize @xmath635 over all multiflows    @xmath636 in @xmath621    this is one of fundamental problems in operations research , and has a wide range of practical applications ; see  ( * ? ? ?",
    "* section 17.1 ) .",
    "we regard @xmath6 as a directed distance on @xmath76 . for a simplicity",
    ", we assume that _",
    "@xmath6 is a metric_. as is well - known in the multiflow theory @xcite , an lp - dual to ( mcf ) is a linear optimization over metrics : @xmath637 here recall notions in section  [ subsec : extension ] .",
    "this is nothing but a linear optimization over all extensions of @xmath1 . _",
    "since @xmath638 is nonnegative , the minimum is always attained by a tight extension .",
    "_ by theorem  [ thm : extension ]  ( 1 ) , possible candidates @xmath11 for optimum are isometrically embedded into @xmath107 .",
    "so the problem reduces to be an optimization over isometric embeddings @xmath432 .",
    "thus we have the following min - max relation sharpening the lp - duality .",
    "[ thm : tdual ] let @xmath621 be a network and let @xmath6 be a directed metric on @xmath76 .",
    "the following min - max relation holds : @xmath639 & & = \\min \\left\\ {   \\sum_{xy \\in e } c(xy)d_{\\infty}(\\rho(x ) , \\rho(y ) )   \\bigmid   \\rho : v \\to t_\\mu,\\ \\rho(s ) = \\mu_s\\ ( s \\in s ) \\right\\}. \\nonumber\\end{aligned}\\ ] ]    we give two interpretations of this minimization problem in rhs of ( [ eqn : min - max ] ) below .",
    "the first is a _ facility location _ on @xmath19 .",
    "there are facilities at points @xmath114 @xmath640 in @xmath19 .",
    "we are going to locate new facilities @xmath641 at points @xmath449 in @xmath19 . here",
    "facilities communicate with each other , and have the _ communication cost _ , which is a monotone function of their distances @xmath642 .",
    "the objective is to find a location of the minimum communication cost . in the literature of the location theory  @xcite , the undirected version of this problem",
    "is known as _",
    "multifacility location problem_. the second interpretation comes from electrical circuits .",
    "we associate each vertex @xmath72 with a @xmath19-valued _ potential _ @xmath449 .",
    "the objective is to minimize the _ energy _ , a function of _ potential differences _",
    "@xmath642 measured in @xmath396 , under the _ boundary condition _",
    "@xmath429 .",
    "suppose the case where network @xmath621 is _ eulerian _",
    ", i.e. , for each vertex @xmath72 , the sum of capacities over all edges entering @xmath72 is equal to the sum of capacities over all edges leaving @xmath72 . in this case ,",
    "capacity function @xmath638 is decomposed into the characteristic vectors of ( possibly repeated ) cycles @xmath643 in @xmath622 . for any metric @xmath11 on @xmath12 , the objective value in ( [ eqn : lp - dual ] )",
    "is given by @xmath644 therefore , _ the minimum of @xmath645 is always attained by a cyclically tight extension .",
    "_ moreover two congruent metrics have the same objective value . by theorem  [ thm : extension ]",
    "( 2 ) and proposition  [ prop : congruent ]  ( 2 ) , any metric @xmath11 congruent to a cyclically tight extension is isometrically embedded into @xmath108 .",
    "thus we have the following min - max relation :    [ thm : qdual ] let @xmath621 be an eulerian network and let @xmath6 be a directed metric on @xmath76 .",
    "then the following min - max relation holds : @xmath646 & & = \\min \\left\\ {   \\sum_{xy \\in e } c(xy)d_{\\infty}(\\rho(x ) , \\rho(y ) ) \\bigmid   \\rho : v \\to q_{\\mu},\\ \\bar",
    "\\rho(s ) = \\bar \\mu_s\\ ( s \\in s ) \\right\\}. \\nonumber\\end{aligned}\\ ] ]    here we can take @xmath432 so that @xmath431 lies on any fixed balanced section @xmath97 .",
    "so the rhs in ( [ eqn : min - max_eulerian ] ) is essentially a facility location problem on the tropical polytope @xmath21 .    in the single commodity maximum flow problem ,",
    "a classic theorem by ford - fulkerson says that the maximum flow value is equal to the minimum value of cut capacity , and there always exists an _ integral _ maximum flow , i.e. , a maximum flow whose flow - value function is integer - valued ; see @xcite .",
    "such a _ combinatorial min - max theorem _ and an _ integrality theorem _ are closely related to the geometry of tight spans and tropical polytopes .",
    "this issue , however , is beyond the scope of the paper .",
    "so we will discuss it in the next paper  @xcite .",
    "the first author is supported by a grant - in - aid for scientific research from the ministry of education , culture , sports , science and technology of japan .",
    "the second author is supported by nanzan university pache research subsidy i - a-2 for the 2008 academic year .",
    "p. buneman , a note on the metric properties of trees , _ journal of combinatorial theory , series b _ * 17 * ( 1974 ) , 4850 . m. chrobak and l. l. larmore , generosity helps or an 11-competitive algorithm for three servers , _ journal of algorithms _ * 16 * ( 1994 ) , 234263 .",
    "m. develin , f. santos , and b. sturmfels , on the rank of a tropical matrix , in : j. e. goodman , j. pach and e. welzl ( eds . ) , _ combinatorial and computational geometry _ ,",
    "mathematical sciences research institute publications , 52 .",
    "cambridge university press , cambridge , 2005 , 213242",
    ".      a. w. m. dress , trees , tight extensions of metric spaces , and the cohomological dimension of certain groups : a note on combinatorial properties of metric spaces , _ advances in mathematics _",
    "* 53 * ( 1984 ) , 321402 ."
  ],
  "abstract_text": [
    "<S> an extension @xmath0 of a metric space @xmath1 is a metric space with @xmath2 and @xmath3 , and is said to be tight if there is no other extension @xmath4 of @xmath1 with @xmath5 . </S>",
    "<S> isbell and dress independently found that every tight extension is isometrically embedded into a certain metrized polyhedral complex associated with @xmath1 , called the tight span . </S>",
    "<S> this paper develops an analogous theory for directed metrics , which are `` not necessarily symmetric '' distance functions satisfying the triangle inequality . </S>",
    "<S> we introduce a directed version of the tight span and show that it has such a universal embedding property for tight extensions . </S>",
    "<S> also we newly introduce another natural class of extensions , called cyclically tight extensions , and show that ( a fiber of ) the tropical polytope , introduced by develin and sturmfels , has a universal embedding property for cyclically tight extensions . as an application , we prove the following directed version of tree metric theorem : directed metric @xmath6 is a directed tree metric if and only if the tropical rank of @xmath7 is at most two . </S>",
    "<S> also we describe how tight spans and tropical polytopes are applied to the study in multicommodity flows in directed networks . </S>"
  ]
}