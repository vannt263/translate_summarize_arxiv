{
  "article_text": [
    "let @xmath0 denote the set of permutations of @xmath1 , written in one - line notation , and suppose @xmath2 and @xmath3 .",
    "we say a subsequence of @xmath4 has _ type _",
    "@xmath5 whenever it has all of the same pairwise comparisons as @xmath5 .",
    "for example , the subsequence 2869 of the permutation 214538769 has type 1324 .",
    "we say @xmath4 _ avoids _",
    "@xmath5 whenever @xmath4 contains no subsequence of type @xmath5 .",
    "for example , the permutation 214538769 avoids 312 and 2413 , but it has 2586 as a subsequence so it does not avoid 1243 . if @xmath4 avoids @xmath5 then @xmath5 is sometimes called a _ pattern _ or a _ forbidden subsequence _ and @xmath4 is sometimes called a _ restricted permutation _ or a _ pattern - avoiding permutation_. in this paper we will be interested in permutations which avoid several patterns , so for any set @xmath6 of permutations we write @xmath7 to denote the elements of @xmath0 which avoid every pattern in @xmath6 and we write @xmath8 to denote the set of all permutations ( including the empty permutation ) which avoid every pattern in @xmath6 . when @xmath9 we often write @xmath10 and @xmath11 .",
    "several authors @xcite have shown that generating functions for @xmath12 with respect to the number of subsequences of type @xmath13 , for various collections of values of @xmath14 , can be expressed as continued fractions .",
    "the most general result along these lines , which appears as ( * ? ? ?",
    "* theorem 1 ) , states that @xmath15 here @xmath16 is the number of subsequences of type @xmath13 in @xmath4 . generating functions for @xmath12 have also been found to be expressible in terms of chebyshev polynomials of the second kind @xcite .",
    "one result along these lines , which appears as ( * ? ? ?",
    "* theorem 2 ) , ( * ? ? ?",
    "* theorem 3.1 ) , and ( * ? ? ?",
    "* theorem 3.6 , second case ) , states that @xmath17 here @xmath18 is the @xmath19th chebyshev polynomial of the second kind , which may be defined by @xmath20 .",
    "another result along these lines , which appears as ( * ? ? ?",
    "* theorem 3 ) , states that @xmath21 here the sum on the left is over all permutations in @xmath12 which contain exactly @xmath22 subsequences of type @xmath13 , the quantity @xmath23 is the length of @xmath4 , and the sum on the right is over all sequences @xmath24 of nonnegative integers such that @xmath25 . for other results involving @xmath12 and continued fractions or chebyshev polynomials ,",
    "see @xcite and the references therein .",
    "permutations which avoid 1243 and 2143 are known to have many properties which are analogous to properties of permutations which avoid 132 .",
    "for instance , it is well known that @xmath26 for all @xmath27 , where @xmath28 is the @xmath19th catalan number , which may be defined by @xmath29 and @xmath30 ( the catalan number @xmath28 may also be defined by @xmath31 . ) as a result , for all @xmath27 , the set @xmath32 is in bijection with the set of _ catalan paths_. these are the lattice paths from @xmath33 to @xmath34 which contain only east @xmath35 and north @xmath36 steps and which do not pass below the line @xmath37 .",
    "kremer ( * ? ? ?",
    "* corollary 9 ) has shown that @xmath38 for all @xmath39 , where @xmath40 is the @xmath19th schrder number , which may be defined by @xmath41 and @xmath42 as a result , for all @xmath27 , the set @xmath43 is in bijection with the set @xmath44 of _ schrder paths_. these are the lattice paths from @xmath33 to @xmath34 which contain only east @xmath35 , north @xmath36 , and diagonal @xmath45 steps and which do not pass below the line @xmath37 .",
    "we write @xmath46 to denote the set of all schrder paths ( including the empty path ) . in view of this relationship",
    ", we refer to permutations which avoid 1243 and 2143 as _ schrder permutations_. ( for more information on pattern - avoiding permutations counted by the schrder numbers , see @xcite . for generalizations of some of these results ,",
    "see @xcite . for a partial list of other combinatorial objects counted by the schrder numbers ,",
    "see @xcite . )    motivated by the parallels between @xmath12 and @xmath47 , in this paper we prove analogues of ( [ eqn : introcf ] ) , ( [ eqn : introcheby ] ) , ( [ eqn : intro12kr ] ) , and several similar results for @xmath47 .",
    "we begin with some results concerning @xmath47 and continued fractions .",
    "we first define statistics @xmath48 , @xmath49 , on @xmath46 and @xmath47 . on @xmath47 ,",
    "the statistic @xmath48 is simply the number of subsequences of type @xmath13 . on @xmath46 ,",
    "the statistic @xmath48 is a sum of binomial coefficients over east and diagonal steps .",
    "we then give a combinatorial definition of a bijection @xmath50 with the property that @xmath51 for all @xmath49 and all @xmath52 .",
    "using @xmath53 and a result of flajolet ( * ? ? ? * theorem 1 ) , we prove the following analogue of ( [ eqn : introcf ] ) .",
    "@xmath54 by specializing the @xmath55s in ( [ eqn : introscf ] ) , we obtain continued fraction expansions for several other statistics on @xmath47 .",
    "in particular , we show that for all @xmath49 , @xmath56 here the continued fraction on the right has @xmath57 denominators .",
    "following @xcite , we then define a _",
    "schrder continued fraction _ to be a continued fraction of the form @xmath58 where @xmath59 is a finite monic monomial in a given set of variables for all @xmath60 .",
    "we prove that the multivariate generating function for a countable family of statistics on @xmath47 can be expressed as a schrder continued fraction if and only if each statistic is a ( possibly infinite ) linear combination of the @xmath48s and each @xmath48 appears in only finitely many of these linear combinations .",
    "this result is an analogue of ( * ? ? ?",
    "* theorem 2 ) .",
    "we then turn our attention to analogues of ( [ eqn : introcheby ] ) and ( [ eqn : intro12kr ] ) . for any @xmath61 and any @xmath62 we give the generating function for @xmath63 in terms of the generating function for @xmath64 . using this result ,",
    "we show that @xmath65 and @xmath66 for all @xmath49 .",
    "both of these results are analogues of ( [ eqn : introcheby ] ) .",
    "we then use @xmath53 and some well - known results concerning lattice paths to show that @xmath67 here the sum on the left is over all permutations in @xmath47 which contain exactly @xmath22 subsequences of type @xmath68 and the sum on the right is over all sequences @xmath69 and @xmath70 of nonnegative integers such that @xmath71 this result is an analogue of ( [ eqn : intro12kr ] ) .    in the next two sections of the paper we give enumerations and generating functions for various sets of permutations in @xmath47 .",
    "for instance , we show that @xmath72 and @xmath73 for all @xmath74 . here",
    "@xmath75 , @xmath76 for all @xmath74 , and @xmath77 for all @xmath61 .",
    "setting @xmath78 in ( [ eqn : intro231gf ] ) and ( [ eqn : intro321gf ] ) , we find that @xmath79 ) and ( [ eqn : intro321 ] ) .",
    "we also show that @xmath80 where the sum on the left is over all permutations in @xmath47 which contain exactly one subsequence of type @xmath81 .",
    "it is an open problem to give the sum @xmath82 in closed form when it is over all permutations in @xmath47 which contain exactly @xmath22 subsequences of type @xmath81 , where @xmath83 .",
    "we conclude the paper by collecting several open problems related to this work .",
    "in this section we define a family of statistics on schrder paths .",
    "we then recall the first - return product on schrder paths and describe the behavior of our statistics with respect to this product .",
    "we begin by recalling the height of an east or diagonal step in a schrder path .",
    "let @xmath4 denote a schrder path , let @xmath84 denote a step in @xmath4 which is either east or diagonal , and let @xmath85 denote the coordinates of the left - most point in @xmath4 .",
    "we define the _ height _ of @xmath84 , written @xmath86 , by setting @xmath87 .",
    "we now define our family of statistics on schrder paths .    for any schrder path @xmath4 and any positive integer @xmath14",
    "we write @xmath88 where the sum on the right is over all east and diagonal steps in @xmath4 . here",
    "we take @xmath89 whenever @xmath90 or @xmath91 . for notational convenience we set @xmath92 for any schrder path @xmath4 .",
    "[ exmp : schroderpath ] let @xmath4 denote the schrder path given in figure 1 , so that @xmath4 is given by @xmath93",
    ". then @xmath94 , @xmath95 , @xmath96 , @xmath97 , @xmath98 , @xmath99 , and @xmath100 for all @xmath101 .    .",
    "]    before we recall the first - return product for schrder paths , we make an observation regarding those paths in @xmath44 which begin with a diagonal step .",
    "[ prop : pathnrecurrence ]    1 .   for all @xmath39 ,",
    "the map @xmath102 is a bijection between @xmath103 and the set of schrder paths in @xmath44 which begin with a diagonal step .",
    "@xmath104 for all @xmath52 .",
    "@xmath105 for all @xmath61 and all @xmath52 .",
    "\\(i ) this is immediate .",
    "( ii),(iii ) from ( [ eqn : skpath ] ) we find that for all @xmath49 , @xmath106 & = & { { 0 } \\choose { k-1 } } + \\tau_k(\\pi).\\end{aligned}\\ ] ] now ( ii ) and ( iii ) follow .",
    "we now define the first - return product on schrder paths .    for any schrder paths @xmath107 and @xmath108 we write @xmath109    [ prop : pathinirecurrence ] let @xmath110 and @xmath19 denote positive integers such that @xmath111 . then the following hold .    1 .",
    "the map @xmath112 is a bijection between @xmath113 and the set of schrder paths in @xmath44 which begin with a north step and first touch the line @xmath37 at @xmath114 .",
    "2 .   for all @xmath49 , all @xmath115 , and",
    "all @xmath116 we have @xmath117    \\(i ) this is immediate .",
    "\\(ii ) fix @xmath49 . using ( [ eqn : skpath ] ) we have @xmath118 & = & { { 0}\\choose{k-1 } } + \\sum_{s \\in \\pi_1 } { { ht(s)}\\choose{k-1 } } + \\sum_{s \\in \\pi_1 } { { ht(s)}\\choose{k-2 } } + { { 0 } \\choose { k-2 } } + { { 0 } \\choose { k-1 } } + \\sum_{s \\in \\pi_2 } { { ht(s)}\\choose{k-1 } } \\\\[2.5ex ] & = & \\tau_k(\\pi_1 ) + \\tau_{k-1}(\\pi_1 ) + \\tau_k(\\pi_2),\\end{aligned}\\ ] ] as desired .",
    "in this section we define a natural family of statistics on schrder permutations which is analogous to the family of statistics we have defined on schrder paths .",
    "we then describe a `` product '' on schrder permutations which behaves nicely with respect to our statistics .",
    "this product is analogous to the first - return product for schrder paths given in the previous section .",
    "we begin with our family of statistics .    for any positive integer @xmath14 and any permutation @xmath4 , we write @xmath16 to denote the number of increasing subsequences of length @xmath14 which",
    "are contained in @xmath4 .",
    "for notational convenience we set @xmath92 for any permutation @xmath4 .",
    "observe that for any permutation @xmath4 , the quantity @xmath119 is the length of @xmath4 ; we sometimes write @xmath23 to denote this quantity .    if @xmath120 then @xmath121 , @xmath122 , @xmath123 , @xmath124 , @xmath125 , and @xmath100 for all @xmath126 .    observe that we have now defined @xmath16 when @xmath4 is a schrder permutation and when @xmath4 is a schrder path .",
    "this will not cause confusion , however , since it will always be clear from the context which definition is intended .    before we describe our product for schrder permutations",
    ", we make an observation regarding those schrder permutations whose largest element appears first .",
    "[ prop : permnrecurrence ]    1 .   for all @xmath39 ,",
    "the map @xmath127 is a bijection between @xmath128 and the set of permutations in @xmath129 which begin with @xmath19 .",
    "@xmath130 for all @xmath39 and all @xmath131 .",
    "@xmath132 for all @xmath61 , all @xmath39 , and all @xmath131 .",
    "\\(i ) it is clear that the given map is one - to - one and that if @xmath133 is a permutation in @xmath129 then @xmath131 , so it is sufficient to show that if @xmath131 then @xmath133 avoids @xmath134 and @xmath135 . to this end , suppose @xmath131 .",
    "since @xmath4 avoids @xmath134 and @xmath135 , in any pattern of either type in @xmath133 the @xmath19 must play the role of the 4 .",
    "but this is impossible , since the @xmath19 is the left - most element of @xmath133 , but 4 is not the left - most element of 1243 or 2143 . therefore @xmath133 avoids 1243 and 2143 .",
    "\\(ii ) this is immediate , since @xmath119 is the length of @xmath4 for any permutation @xmath4 .",
    "\\(iii ) since @xmath19 is both the largest and the left - most element in @xmath133 , it can not participate in an increasing subsequence of length two or more .",
    "therefore any such subsequence in @xmath133 is contained in @xmath4 , and ( iii ) follows .",
    "we now describe our product for schrder permutations .",
    "to do so , we first set some notation .",
    "let @xmath107 and @xmath108 denote nonempty schrder permutations .",
    "we write @xmath136 to denote the sequence obtained by adding @xmath137 to every entry in @xmath107 and then replacing @xmath138 ( the smallest entry in the resulting sequence ) with the left - most entry of @xmath108 .",
    "we observe that @xmath136 has type @xmath107 .",
    "we write @xmath139 to denote the sequence obtained from @xmath108 by removing its left - most element .",
    "[ defn : permstar ] for any nonempty schrder permutations @xmath107 and @xmath108 , we write @xmath140 where @xmath141 and @xmath136 and @xmath139 are the sequences described in the previous paragraph .    if @xmath142 and @xmath143 then @xmath144 , @xmath145 , and @xmath146 .",
    "[ prop : perminirecurrence ] let @xmath110 and @xmath19 denote positive integers such that @xmath147 . then the following hold .    1 .",
    "the map @xmath148 is a bijection between @xmath149 and the set of permutations in @xmath129 for which @xmath150 .",
    "2 .   for all @xmath49 , all @xmath151 , and",
    "all @xmath152 we have @xmath153    \\(i ) it is routine to verify that if @xmath151 and @xmath152 then @xmath154 , so it is sufficient to show that the given map is a bijection .",
    "we do this by describing its inverse .",
    "suppose @xmath155 and @xmath150 .",
    "let @xmath156 denote the type of the subsequence @xmath157 of @xmath4 and let @xmath158 denote the permutation of @xmath159 which appears in @xmath4 .",
    "since @xmath155 and @xmath4 contains subsequences of type @xmath156 and @xmath158 we find that @xmath160 and @xmath161 .",
    "we now show that the map @xmath162 is the inverse of the map @xmath163 .",
    "it is clear from the construction of @xmath164 that @xmath165 and @xmath166 , so it remains to show that @xmath167 . to this end , observe that since @xmath4 avoids 1243 and 2143 and has @xmath150 , exactly one of @xmath159 appears to the left of @xmath19 in @xmath4 .",
    "( if two or more of @xmath168 appeared to the left of @xmath19 then two of these elements , together with @xmath19 and some element to the right of @xmath19 , would form a subsequence of type 1243 or 2143 . ) therefore , the remaining elements among @xmath168 are exactly those elements which appear to the right of @xmath19 .",
    "it follows that @xmath167 .",
    "therefore the map @xmath162 is the inverse of the map @xmath163 , so the latter is a bijection , as desired .",
    "\\(ii ) let @xmath136 be as in the paragraph above definition [ defn : permstar ] .",
    "observe that since @xmath136 consists of exactly those elements of @xmath164 which are to the left of @xmath19 , there is a one - to - one correspondence between increasing subsequences of length @xmath169 in @xmath136 and increasing subsequences of length @xmath14 in @xmath164 which involve @xmath19 .",
    "since @xmath136 and @xmath107 have the same type , there are @xmath170 of these subsequences .",
    "now observe that if an increasing subsequence of length @xmath14 in @xmath164 does not involve @xmath19 , and involves an element of @xmath136 other than the smallest element , then it is entirely contained in @xmath136 . similarly , observe that if an increasing subsequence of length @xmath14 in @xmath164 involves an element of @xmath108 other than the left - most element , then it is entirely contained in @xmath108 .",
    "therefore every increasing subsequence of length @xmath14 in @xmath164 which does not involve @xmath19 is an increasing subsequence of length @xmath14 in @xmath136 or in @xmath108 .",
    "since @xmath136 and @xmath107 have the same type , there are @xmath171 of these subsequences .",
    "now ( ii ) follows .",
    "although the results we have given in this section are sufficient for our current purposes , we remark that there are more general results along the same lines .",
    "for example , following @xcite and @xcite , let @xmath172 ( @xmath74 ) denote the set of all permutations in @xmath173 which end with @xmath174 .",
    "observe that @xmath175 and @xmath176 .",
    "then there are natural analogues of all of the results in this section for @xmath177 , where @xmath178 .",
    "comparing propositions [ prop : permnrecurrence ] and [ prop : perminirecurrence ] with propositions [ prop : pathnrecurrence ] and [ prop : pathinirecurrence ] respectively , we see that for all @xmath27 there exists a bijection @xmath179 such that @xmath180 for all @xmath181 .",
    "so far , we have only seen how to compute this bijection recursively . in this section",
    "we use techniques of bandlow and killpatrick @xcite and bandlow , egge , and killpatrick @xcite to compute this bijection directly .    to define our bijection",
    ", we first need to introduce some notation . for all @xmath27 and all @xmath110 such that @xmath147",
    ", we write @xmath182 to denote the map from @xmath0 to @xmath0 which acts by interchanging the elements in positions @xmath110 and @xmath183 of the given permutation . for example , @xmath184 and @xmath185 .",
    "we apply these maps from right to left , so that @xmath186 .",
    "suppose @xmath181 .",
    "we now describe how to construct the image @xmath187 of @xmath4 under our bijection @xmath53 . to illustrate the procedure , we give a running example in which the schrder path @xmath4 is given by @xmath188 , which is illustrated in figure 2 below .",
    "used in the running example . ]    to begin , label each upper triangle ( i.e. each triangle whose vertices have coordinates of the form @xmath189 , @xmath190 , @xmath191 ) which is below @xmath4 and above the line @xmath37 with an @xmath182 , where @xmath110 is the @xmath192-coordinate of the upper right corner of the triangle . in figure 3",
    "below we have labeled the appropriate triangles for @xmath4 with the subscripts for the @xmath182s .     with triangles labeled .",
    "]    now let @xmath193 denote the sequence of @xmath182s which begins with the @xmath182 furthest up and to the right and extends diagonally to the lower left , immediately above the line @xmath37 , proceeding until it reaches a north step .",
    "let @xmath194 denote the sequence of @xmath182s which begins immediately to the left of the beginning of @xmath193 and extends diagonally to the lower left , immediately above @xmath193 , until it reaches a north step .",
    "construct @xmath195 in this fashion until all of the @xmath182s above and to the left of @xmath193 have been read .",
    "repeat this process with the part of the path below the last east step before the north step which ended @xmath193 . in this way we obtain a sequence @xmath196 of maps on @xmath0 . in figure 4",
    "below we have indicated the sequences @xmath197 , and @xmath198 for our example path @xmath4 .     with @xmath193 , @xmath199 , @xmath200 , and @xmath198 indicated . ]    in this example we have @xmath201 and @xmath202 .",
    "we this set - up in mind , we can now define @xmath187 .",
    "[ defn : varphi ] for any schrder path @xmath4 , let @xmath203 denote the maps determined as in the discussion above .",
    "then we write @xmath204    summarizing our running example , we have the following .    [ exmp : running ] let @xmath4 denote the schrder path in figure 2 above , so that @xmath4 is given by @xmath188 .",
    "then @xmath205 , and @xmath206 .",
    "let @xmath4 denote the schrder path given by @xmath207 .",
    "then @xmath208 , @xmath209 , @xmath210 , @xmath211 , and @xmath212 .",
    "let @xmath4 denote the schrder path given by @xmath213 .",
    "then @xmath214 , @xmath215 , @xmath216 , @xmath217 , @xmath218 , and @xmath219 .",
    "our goal for the remainder of this section is to show that the map @xmath53 is a bijection which preserves the statistics @xmath48 for all @xmath49 . to do this",
    ", we first consider the value of @xmath53 on a schrder path which begins with a diagonal step .    for all @xmath27 and all @xmath181 we have [ prop :",
    "varphid ] @xmath220    observe that by the construction of @xmath221 no @xmath222 will appear in @xmath223 .",
    "therefore the left - most element of @xmath224 will not be moved by @xmath223 .",
    "now the result follows .",
    "next we consider the value of @xmath53 on a product of two schrder paths .    for all schrder paths @xmath107 and @xmath108 we have @xmath225    in the construction of @xmath226 , let @xmath227 denote the strings of @xmath182s constructed from triangles below @xmath108 , and observe that the next string constructed will be @xmath228 , where @xmath107 ends at @xmath229 . now let @xmath230 denote the remaining strings and let @xmath231 denote the left - most element of @xmath232 .",
    "then we have @xmath233 & = & \\sigma_k \\ldots \\sigma_{j+2 } s_i s_{i-1 } \\ldots s_1 ( n+1,n,\\ldots , n - i+1 , a , \\tilde{\\varphi(\\pi_2 ) } ) \\\\[2ex ] & = & \\sigma_k \\ldots \\sigma_{j+2 } ( n , n-1 , \\ldots , n - i+1 , a , n+1 , \\tilde{\\varphi(\\pi_2 ) } ) \\\\[2ex ] & = & \\tilde{\\varphi(\\pi_1 ) } , n+1 , \\tilde{\\varphi(\\pi_2 ) } \\\\[2ex ] & = & \\varphi(\\pi_1 ) * \\varphi(\\pi_2),\\end{aligned}\\ ] ] as desired .",
    "we now show that @xmath53 is a bijection from @xmath44 to @xmath43 .",
    "[ prop : varphibijection ]    1 .   for all @xmath52 , we have @xmath234 .",
    "2 .   for all @xmath27",
    "the map @xmath235 is a bijection .",
    "\\(i ) observe that @xmath236 , @xmath237 , and @xmath238 , so ( i ) holds for all @xmath239 and all @xmath240 .",
    "arguing by induction , suppose ( i ) holds for all @xmath241 , where @xmath242 , and fix @xmath181 .",
    "if @xmath4 begins with a diagonal step then @xmath243 and",
    "by ( [ eqn : varphid ] ) we have @xmath244 . if @xmath4 does not begin with a diagonal step then by proposition [ prop :",
    "pathinirecurrence](i ) there exist @xmath115 and @xmath116 , where @xmath111 , such that @xmath245 .",
    "then by ( [ eqn : varphistar ] ) we have @xmath246 . now",
    "( i ) follows .",
    "\\(ii ) first observe that by ( i ) and since @xmath247 for all @xmath27 , it is sufficient to show that @xmath53 is surjective . to do this , we argue by induction on @xmath19 .",
    "it is routine to verify that @xmath53 is surjective for @xmath248 and @xmath249 , so suppose by induction that @xmath53 is surjective for @xmath250 and fix @xmath251 . if @xmath252 then by proposition [ prop : permnrecurrence](i ) there exists @xmath253 such that @xmath254 . by induction there",
    "exists @xmath255 such that @xmath256 .",
    "we now have @xmath257 & = & \\pi",
    ". \\\\ \\end{array}\\ ] ] if @xmath258 then there exists @xmath110 , @xmath147 , such that @xmath259 . by proposition [ prop : perminirecurrence](i ) there exist @xmath151 and @xmath260 such that @xmath245 . by induction there exist @xmath261 and @xmath262 such that @xmath256 and @xmath263 .",
    "we now have @xmath264 & = & \\pi .",
    "\\end{array}\\ ] ] it follows that @xmath53 is surjective , as desired .    we now show that @xmath53 preserves the statistics @xmath48 for all @xmath49 .",
    "[ prop : varphitau ] for any @xmath49 and any schrder path @xmath4 we have @xmath265    suppose @xmath181 ; we argue by induction on @xmath19 .",
    "the cases @xmath248 and @xmath249 are routine to verify , so suppose the result holds for all @xmath241 , where @xmath266 , and fix @xmath181 . if @xmath4 begins with a diagonal step then @xmath267 for some @xmath268 and we have @xmath269 & = & \\tau_k(n+1 , \\varphi(\\pi_1 ) ) & & \\hbox{(by ( \\ref{eqn : varphid } ) ) } \\\\[2ex ] & = & \\delta_{k1 } + \\tau_k(\\varphi(\\pi_1 ) ) & & \\hbox{(by proposition \\ref{prop : permnrecurrence}(ii),(iii ) ) } \\\\[2ex ] & = & \\delta_{k1 } + \\tau_k(\\pi_1 ) & & \\hbox{(by induction ) } \\\\[2ex ] & = & \\tau_k(d,\\pi_1 ) & & \\hbox{(by proposition \\ref{prop : pathnrecurrence}(ii),(iii ) ) } \\\\[2ex ] & = & \\tau_k(\\pi ) .",
    "\\end{array}\\ ] ] if @xmath4 does not begin with a diagonal step then @xmath245 for some @xmath115 and @xmath116 and we have @xmath270 & = & \\tau_k(\\varphi(\\pi_1 ) * \\varphi(\\pi_2 ) ) & & \\hbox{(by ( \\ref{eqn : varphistar } ) ) } \\\\[2ex ] & = & \\tau_k(\\varphi(\\pi_1 ) ) + \\tau_{k-1}(\\varphi(\\pi_1 ) ) + \\tau_k(\\varphi(\\pi_2 ) ) & & \\hbox{(by ( \\ref{eqn : tauperm } ) ) } \\\\[2ex ] & = & \\tau_k(\\pi_1 ) + \\tau_{k-1}(\\pi_1 ) + \\tau_k(\\pi_2 ) & & \\hbox{(by induction ) } \\\\[2ex ] & = & \\tau_k(\\pi_1 * \\pi_2 ) & & \\hbox{(by ( \\ref{eqn : taupath } ) ) } \\\\[2ex ] \\end{array}\\ ] ] as desired .    in view of proposition",
    "[ prop : varphitau ] , the map @xmath53 also relates the schrder paths of height at most @xmath271 with schrder permutations which avoid @xmath13 . in particular",
    ", we have the following result .",
    "[ cor : varphiheight ] fix @xmath61 and let @xmath272 denote the set of schrder paths in @xmath44 which do not cross the line @xmath273",
    ". then the restriction of @xmath53 to @xmath272 is a bijection between @xmath272 and @xmath274 .",
    "observe that @xmath251 avoids @xmath13 if and only if @xmath100 . by ( [ eqn : varphitau ] ) this occurs if and only if @xmath275 , which occurs if and only if @xmath276 does not cross the line @xmath273 .    for all @xmath27 , let @xmath277 denote the set of all schrder paths from @xmath33 to @xmath34 which contain no diagonal steps .",
    "( such paths are sometimes called _ catalan paths _ , because @xmath278 is the well - known catalan number @xmath31 for all @xmath27 . ) in @xcite krattenthaler gives a bijection @xmath279 such that @xmath280 for all @xmath49 , all @xmath27 , and all @xmath281 .",
    "krattenthaler s bijection @xmath282 is closely related to our bijection @xmath53 .",
    "for any permutation @xmath4 , let @xmath283 denote the sequence obtained by adding one to every entry in @xmath4 .",
    "observe that the map @xmath284 given by @xmath285 for all @xmath281 is a bijection between @xmath32 and the set of permutations in @xmath43 which begin with 1 .",
    "the bijections @xmath282 and @xmath53 are related in that @xmath286 for all @xmath27 and all @xmath281 .",
    "in this section we will encounter several continued fractions , for which we will use the following notation .    for any given expressions @xmath287 @xmath288 and @xmath289 @xmath288 we write @xmath290 to denote the infinite continued fraction @xmath291 we use the corresponding notation for finite continued fractions .",
    "several authors @xcite have described how to express the generating function for @xmath32 with respect to various @xmath48 ( @xmath49 ) as a continued fraction .",
    "the most general of these results is the following , which appears explicitly as ( * ? ? ?",
    "* theorem 1 ) .",
    "a special case of this result appears as ( * ? ? ?",
    "* theorem 1 ) , the result is implicit in ( * ? ? ?",
    "* proposition 2.3 ) , and it can be proved by modifying slightly the techniques of ( * ? ? ?",
    "* corollary 7 ) and ( * ? ? ?",
    "* theorem 1 ) .",
    "[ thm:132cf ] ( brndn , claesson , and steingrmsson ( * ? ? ?",
    "* theorem 1 ) ) for all @xmath292 , let @xmath55 denote an indeterminate",
    ". then we have @xmath293    in the same paper , brndn , claesson , and steingrmsson define a _",
    "catalan continued fraction _ to be a continued fraction of the form @xmath294 where for all @xmath60 , the expression @xmath59 is a monic monomial in a given set of variables .",
    "roughly speaking , brndn , claesson , and steingrmsson show ( * ? ? ?",
    "* theorem 2 ) that the multivariate generating function for @xmath12 with respect to a given countable family of statistics may be expressed as a catalan continued fraction if and only if each statistic in the family is a ( possibly infinite ) linear combination of the @xmath48s and each @xmath48 appears in only finitely many of these linear combinations .    in this section",
    "we prove analogues of these results for permutations which avoid 1243 and 2143 .",
    "we begin by adapting krattenthaler s approach in @xcite , using our bijection @xmath53 and a result of flajolet to express the generating function for @xmath47 with respect to @xmath48 , @xmath49 , as a continued fraction . for convenience ,",
    "we first recall the relevant specialization of flajolet s result .",
    "[ thm : flajolet ] ( flajolet ( * ? ? ? * theorem 1 ) ) for all @xmath292 , let @xmath55 denote an indeterminate .",
    "then we have @xmath295    combining @xmath53 with theorem [ thm : flajolet ] , we obtain the following analogue of theorem [ thm:132cf ] .",
    "[ thm : contfrac ] for all @xmath292 , let @xmath55 denote an indeterminate .",
    "then we have @xmath296    this is immediate from theorem [ thm : flajolet ] , in view of propositions [ prop : varphibijection ] and [ prop : varphitau ] .    using ( [ eqn : contfrac ] )",
    ", we can express the generating function for @xmath297 as a ( finite ) continued fraction .",
    "[ cor:12k ] for all @xmath49 we have @xmath298    in ( [ eqn : contfrac ] ) set @xmath299 , @xmath300 and @xmath301 for all @xmath302 .",
    "curiously , as we prove in proposition [ prop : sporadfrac ] , the continued fraction on the right side of ( [ eqn:12gf ] ) is also equal to the generating function for @xmath303 .    using ( [ eqn : contfrac ] )",
    ", we can also express the generating function for @xmath47 with respect to the total number of increasing subsequences as a continued fraction .",
    "for any permutation @xmath4 , let @xmath304 denote the number of nonempty increasing subsequences in @xmath4",
    ". then @xmath305    in ( [ eqn : contfrac ] ) , set @xmath306 and @xmath307 for all @xmath308 and use the fact that @xmath309    by specializing the @xmath55s in ( [ eqn : contfrac ] ) in various ways , one can obtain continued fractions of many other interesting forms . as an example , we have the following result .    for any permutation @xmath4 ,",
    "let @xmath304 denote the length of @xmath4 plus the number of noninversions in @xmath4 . then @xmath310    in ( [ eqn : contfrac ] ) , set @xmath311 and @xmath312 for all @xmath313 and use the fact that @xmath314 .",
    "we now turn our attention to the question of which statistics on @xmath47 have generating functions which can be expressed as continued fractions like the one in ( [ eqn : contfrac ] ) .",
    "we begin by specifying which continued fractions we wish to consider .    by a _ schrder continued fraction _ we mean a continued fraction of the form @xmath315 in which @xmath59 is a monic monomial in a given set of variables for all @xmath60 .",
    "observe that if @xmath316 are ( possibly infinite ) linear combinations of the @xmath48s with the property that each @xmath48 appears in only finitely many @xmath317 , then by specializing the @xmath55s appropriately in ( [ eqn : contfrac ] ) we can express the generating function @xmath318 as a schrder continued fraction .",
    "for instance , when only @xmath319 is present , we have the following corollary of theorem [ thm : e1 ] .",
    "let @xmath320 denote nonnegative integers and let @xmath321 denote the statistic @xmath322 on @xmath47",
    ". then @xmath323    in ( [ eqn : contfrac ] ) set @xmath324 and @xmath325 for all @xmath308 to obtain @xmath326 now the result follows from the fact that @xmath327 for all @xmath61 .    modifying the proof of (",
    "* theorem 2 ) slightly , we now show that linear combinations of the @xmath48s are the only statistics on @xmath47 whose generating functions can be expressed as schrder continued fractions . in order to do this , we first set some notation .",
    "let @xmath328 denote the ring of matrices with integer entries whose rows and columns are indexed by the positive integers , and which have the property that in any row only finitely many entries are nonzero .",
    "then each element of @xmath328 corresponds to an infinite family of statistics on @xmath47 .",
    "[ defn : agf ] for all @xmath329 and all @xmath39 , let @xmath330 denote the linear combination of the @xmath48s whose coefficients appear in the @xmath19th column of @xmath331 .",
    "that is , @xmath332 for all @xmath329 and all @xmath39 .",
    "since each element of @xmath328 corresponds to a family of statistics on @xmath47 , each element also has an associated multivariate generating function .",
    "[ defn : acf ] for all @xmath292 , let @xmath333 denote an indeterminate . for all @xmath329 , we write @xmath334 to denote the generating function given by @xmath335    we also associate with each element of @xmath328 a schrder continued fraction .    for all @xmath292 , let @xmath333 denote an indeterminate . for all @xmath329 ,",
    "we write @xmath336 to denote the continued fraction given by @xmath337    we now give our analogue of ( * ? ? ?",
    "* theorem 2 ) .",
    "although the proof is nearly identical to the proof of ( * ? ? ?",
    "* theorem 2 ) , we include it here for completeness .",
    "[ thm : bcs ] let @xmath338 denote the matrix in @xmath328 which satisfies @xmath339 .",
    "( here we use the convention that @xmath89 whenever @xmath91 . )",
    "then for all @xmath329 , @xmath340 and @xmath341 in particular , the set of schrder continued fractions is exactly the set of generating functions for countable families of statistics on @xmath47 in which each statistic is a ( possibly infinite ) linear combination of the @xmath48s and each @xmath48 appears in only finitely many statistics .",
    "to prove ( [ eqn : facba ] ) , we apply ( [ eqn : contfrac ] ) with @xmath342 for all @xmath292 .",
    "we have @xmath343 & = & { \\displaystyle \\sum_{\\pi \\in \\fs(1243 , 2143 ) } \\prod\\limits_{k \\ge 1 } x_k^{\\tau_k(\\pi ) } } & & \\hbox{(by ( \\ref{eqn : contfrac } ) ) } \\\\[2ex ] & = & { \\displaystyle \\sum_{\\pi \\in \\fs(1243 , 2143 ) } \\prod\\limits_{k \\ge 1 } \\left ( \\prod\\limits_{j \\ge 1 } q_j^{a_{kj}}\\right)^{\\tau_k(\\pi ) } } & & \\\\[4ex ] & = & { \\displaystyle \\sum_{\\pi \\in \\fs(1243 , 2143 ) } \\prod\\limits_{j \\ge 1 } q_j^{\\sum\\limits_{k\\ge 1 } a_{kj } \\tau_k(\\pi ) } } & & \\\\[4ex ] & = & { \\displaystyle f_a({\\bf q } ) } & & \\hbox{(by ( \\ref{eqn : tauan } ) and ( \\ref{eqn : agf } ) ) , }     \\end{array}\\ ] ] as desired . to prove ( [ eqn : cafb-1a ] ) , observe that @xmath344 so @xmath345",
    ". therefore we may replace @xmath331 with @xmath346 in ( [ eqn : facba ] ) to obtain ( [ eqn : cafb-1a ] ) .",
    "* remark * there is a result for finite schrder continued fractions which is analogous to theorem [ thm : bcs ] .",
    "specifically , fix @xmath61 and let @xmath347 denote the ring of @xmath169 by @xmath169 matrices with integer entries . if we replace @xmath328 with @xmath347 and @xmath47 with @xmath348 in definitions [ defn",
    ": agf ] and [ defn : agf ] then the resulting analogue of theorem [ thm : bcs ] follows by an argument almost identical to the proof of theorem [ thm : bcs ] .",
    "in this section we will be interested in connections between pattern - avoiding permutations and chebyshev polynomials of the second kind .",
    "we begin by recalling these polynomials .    for all @xmath349 ,",
    "we write @xmath18 to denote the",
    "_ @xmath19th chebyshev polynomial of the second kind _ , which is defined by @xmath350 and @xmath20 for @xmath27 .",
    "these polynomials satisfy @xmath351    we will find it useful to reformulate the recurrence in ( [ eqn : unrecurrence ] ) as follows .    for all @xmath39 , @xmath352    this is immediate from ( [ eqn : unrecurrence ] ) .",
    "chebyshev polynomials of the second kind have been found to have close connections with @xmath12 ; see , for instance , @xcite .",
    "two such connections are given in the following results .",
    "[ thm : c1 ] ( krattenthaler ( * ? ? ?",
    "* theorem 2 ) , mansour and vainshtein ( * ? ? ?",
    "* theorem 3.1 ) , chow and west ( * ? ? ? * theorem 3.6 , second case ) ) for all @xmath49 we have @xmath353    [ thm : c2 ] ( krattenthaler ( * ? ? ?",
    "* theorem 3 ) , mansour and vainshtein ( * ? ?",
    "? * theorems 3.1 and 4.1 ) ) let @xmath354 , @xmath355 , and @xmath61 satisfy @xmath356 .",
    "then the generating function for the number of 132-avoiding permutations which contain exactly @xmath22 subsequences of type @xmath13 is given by @xmath357 where the sum on the left is over all sequences @xmath24 of nonnegative integers such that @xmath358    in this section we prove analogues of theorems [ thm : c1 ] and [ thm : c2 ] for @xmath129 .",
    "we begin with an analogue of theorem [ thm : c1 ] .",
    "[ thm : e1 ] for all @xmath49 we have @xmath359 and @xmath360    before pressing on to the proof of theorem [ thm : e1 ] , we observe that when we set @xmath78 in ( [ eqn : e112k ] ) and ( [ eqn : e121k ] ) we find that @xmath361 and @xmath362 these generating functions were originally found by west ( * ? ? ?",
    "* example 9 and table 1 ) , using generating trees .",
    "our next result is the key to our proof of theorem [ thm : e1 ] . to state it , we first set some notation .",
    "for any set @xmath6 of permutations , let @xmath363 denote the set of permutations obtained by appending the smallest possible positive integer to each permutation in @xmath6 .    if @xmath364 then @xmath365 .",
    "[ thm : pik ] let @xmath6 denote a nonempty set of permutations and set @xmath366 and @xmath367 then @xmath368    arguing as in the proof of proposition [ prop : permnrecurrence](i ) , we find that for all @xmath27 the map @xmath369 is a bijection between @xmath370 and the set of all permutations in @xmath371 which begin with @xmath372 .",
    "arguing as in the proof of proposition [ prop : perminirecurrence](i ) , we find that for all @xmath110 and all @xmath19 such that @xmath147 , the map @xmath373 is a bijection between @xmath374 and the set of permutations in @xmath370 for which @xmath150 .",
    "combining these two bijections , we find that @xmath375 solving this last equation for @xmath376 , we obtain ( [ eqn : qp ] ) .",
    "as we show next , if @xmath377 is a rational function then @xmath376 has a simple form .",
    "[ cor : ratpik ] let @xmath6 denote a nonempty set of permutations .",
    "if @xmath378 then @xmath379    by ( [ eqn : qp ] ) we have @xmath380 & = & 1 + x \\frac{g(x)}{(1-x)g(x ) - x f(x)},\\end{aligned}\\ ] ] as desired .",
    "using corollary [ cor : ratpik ] it is now routine to prove theorem [ thm : e1 ] .",
    "_ proof of theorem [ thm : e1 ] .",
    "_ we argue by induction on @xmath14 .",
    "it is routine to verify that ( [ eqn : e112k ] ) holds for @xmath381 and @xmath382 , so we assume ( [ eqn : e112k ] ) holds for @xmath271 and @xmath169 .",
    "then by corollary [ cor : ratpik ] and ( [ eqn : qnunrecurrence ] ) we have @xmath383 & = & 1 + \\frac{\\sqrt{x } u_{k-2}\\left(\\frac{1-x}{2 \\sqrt{x}}\\right)}{u_{k-1}\\left ( \\frac{1-x}{2 \\sqrt{x}}\\right)},\\end{aligned}\\ ] ] as desired . the proof of ( [ eqn : e121k ] ) is similar to the proof of ( [ eqn : e112k ] ) .",
    "@xmath384    we now have a corollary of theorem [ thm : e1 ] involving the continued fraction which appears in ( [ eqn:12gf ] ) .    [",
    "prop : sporadfrac ] for all @xmath61 we have @xmath385    this is immediate from theorem [ thm : e1 ] and corollary [ cor:12k ] .",
    "next we turn our attention to our analogue of theorem [ thm : c2 ] .",
    "[ thm : e2 ] fix @xmath354 , @xmath61 , and @xmath386 such that @xmath387 .",
    "then we have @xmath388 here the sum on the left is over all permutations in @xmath47 which contain exactly @xmath22 subsequences of type @xmath68 .",
    "the sum on the right is over all sequences @xmath69 and @xmath70 of nonnegative integers such that @xmath389 throughout we adopt the convention that @xmath390 and @xmath391 for any integer @xmath231 .    to prove this theorem",
    ", we first need to set some notation and prove some preliminary results .",
    "we begin with a certain matrix .    for all @xmath392 , we write @xmath393 to denote the @xmath394 by @xmath394 tridiagonal matrix given by @xmath395    the matrix @xmath393 is closely related to generating functions for various sets of schrder paths . to describe this relationship",
    ", we let @xmath396 denote the set of lattice paths involving only east @xmath35 , north @xmath36 , and diagonal @xmath45 steps which begin at a point at height @xmath22 , end at a point at height @xmath84 , and do not cross the lines @xmath397 and @xmath37 . for any such path @xmath4 which begins at @xmath398 and ends at @xmath399 , we write @xmath400 .",
    "the next lemma summarizes the relationship between @xmath393 and the generating function for @xmath396 with respect to @xmath401 .",
    "[ lem : pathheightgf ] for all @xmath392 and all @xmath22 and @xmath84 such that @xmath402 we have @xmath403 here @xmath404 is the identity matrix of the appropriate size and @xmath405 is the minor of @xmath406 in which the @xmath84th row and @xmath22th column have been deleted .",
    "for the sake of brevity we omit the proof of lemma [ lem : pathheightgf ] .",
    "an outline of this proof can be obtained by modifying slightly the outline of the proof of ( * ? ? ?",
    "* theorem a2 ) .",
    "the matrix @xmath393 is also closely connected with chebyshev polynomials of the second kind . in particular , we have the following result .",
    "[ lem : qkdet ] for all @xmath392 , @xmath407    we argue by induction on @xmath14 .",
    "it is routine to verify that the result holds for @xmath408 and @xmath381 , so we assume the result holds for @xmath271 and @xmath169 . by expanding @xmath409 along the bottom row",
    ", one can show that @xmath410 satisfies ( [ eqn : qnunrecurrence ] ) . by our induction assumption",
    "we find the result holds for @xmath14 , as desired .    as a warm - up for our proof of theorem [ thm : e2 ] , we use lemmas [ lem : pathheightgf ] and [ lem : qkdet ] to give another proof of ( [ eqn : e112k ] ) .    _ another proof of ( [ eqn : e112k ] ) . _",
    "first observe that if @xmath411 is the generating function on the left side of ( [ eqn : e112k ] ) and @xmath412 is the generating function for schrder paths from @xmath33 to @xmath34 which do not exceed height @xmath271 , then in view of ( [ eqn : varphitau ] ) we have @xmath413 .",
    "combining lemmas [ lem : pathheightgf ] and [ lem : qkdet ] we find that @xmath414 . now",
    "( [ eqn : e112k ] ) follows .",
    "@xmath384    we now prove theorem [ thm : e2 ] .",
    "_ proof of theorem [ thm : e2 ] .",
    "_ first observe that if @xmath411 is the generating function on the left side of ( [ eqn:12krgf ] ) and @xmath412 is the generating function for the set of schrder paths from @xmath33 to @xmath34 for which @xmath415 , then in view of ( [ eqn : varphitau ] ) we have @xmath416 . with this in mind , we find @xmath412 .    to compute @xmath412 , we observe that any schrder path @xmath4 with @xmath415 can be constructed by the following procedure in exactly one way .    1",
    ".   choose @xmath69 and @xmath70 such that ( [ eqn : rcondition ] ) holds .",
    "construct a sequence of east and diagonal steps which contains exactly @xmath417 east steps at height @xmath418 and @xmath59 diagonal steps at height @xmath418 for @xmath419 and which satisfies both of the following",
    "the step immediately preceeding a step at height @xmath420 is either an east step at height @xmath421 or less , or a diagonal step at height @xmath420 or less .",
    "all steps after the last east step at height @xmath420 are at height @xmath422 or less .",
    "2 .   after each east step at height @xmath169 except the last , insert an ( possibly empty ) upside - down schrder path of height at most @xmath271 .",
    "3 .   before the first step insert a path from height 0 to height @xmath271 which does not exceed height @xmath271 .",
    "4 .   after the last step insert a path from height @xmath271 to height 0 which does not exceed height @xmath271 .    since the choice at each step is independent of the choices at the other steps , and since every sequence of choices results in a path of the type desired , @xmath412 is the product of the generating functions for each step .    to compute the generating function for step 1 ,",
    "suppose we have fixed @xmath69 and @xmath70 ; then each of the resulting partial paths will have generating function @xmath423 . to count these paths ,",
    "we construct them from the top down .",
    "that is , we first arrange the @xmath424 diagonal steps at height @xmath425 ; there is one way to do this .",
    "we then place the @xmath426 east steps at height @xmath425 so that one of these steps occurs after all of the diagonal steps .",
    "there are @xmath427 ways to do this .",
    "we then place the @xmath428 diagonal steps at height @xmath429 so that none of these steps immediately follows a diagonal step at height @xmath425 .",
    "there are @xmath430 ways to do this . proceeding in this fashion ,",
    "we find that the generating function for step 1 is @xmath431 where the sum is over all sequences @xmath69 and @xmath70 of nonnegative integers which satisfy ( [ eqn : rcondition ] ) . using lemmas [ lem : pathheightgf ] and [ lem : qkdet ] , we find that the generating function for step 2 is equal to @xmath432 and the generating functions for steps 3 and 4 are both equal to @xmath433 taking the product of @xmath192 , the quantities in ( [ eqn : step1 ] ) and ( [ eqn : step2 ] ) , and the square of the quantity in ( [ eqn : step34 ] ) , we obtain ( [ eqn:12krgf ] ) , as desired .",
    "@xmath384    the following special case of theorem [ thm : e2 ] is of particular interest .",
    "[ cor:12k1gf ] for all @xmath61 we have @xmath434 here the sum on the left is over all permutations in @xmath47 which contain exactly one subsequence of type @xmath13 .",
    "set @xmath435 in theorem [ thm : e2 ] .",
    "in section [ sec : chebyshev ] we used theorem [ thm : pik ] to obtain generating functions for @xmath436 , where @xmath437 . in this section",
    "we use theorem [ thm : pik ] to obtain generating functions for @xmath438 for other interesting choices of @xmath5 ; in some cases we give explicit enumerations .",
    "we begin with @xmath439 .",
    "[ prop:231 ] for all @xmath440 , @xmath441    we first prove ( [ eqn:231gf ] ) .",
    "let @xmath442 denote the generating function on the left side of ( [ eqn:231gf ] ) . observe that if @xmath443 then @xmath444 , @xmath445 , or @xmath446 .",
    "therefore we may partition @xmath447 into the following four sets : @xmath448 @xmath449 @xmath450 @xmath451 the generating function for @xmath452 is @xmath453 .",
    "the map from @xmath454 which carries @xmath4 to @xmath455 is a bijection between @xmath454 and the set of permutations in @xmath456 which have length @xmath19 , so the generating function for @xmath456 is @xmath457 .",
    "now observe that if @xmath458 and @xmath443 has @xmath459 then @xmath460 .",
    "it follows that the map from @xmath461 to @xmath462 which carries @xmath4 to @xmath463 , where @xmath283 is the sequence obtained from @xmath4 by adding one to every entry , is a bijection between @xmath461 and the set of permutations in @xmath464 which have length @xmath19 . by (",
    "* proposition 9 ) , the generating function for @xmath465 is @xmath466 , so the generating function for @xmath464 is @xmath467 . finally , the map from @xmath454 to @xmath462 which carries @xmath4 to @xmath468 is a bijection between @xmath454 and the set of permutations in @xmath469 which have length @xmath19 .",
    "therefore the generating function for @xmath469 is @xmath470 .",
    "combine these observations to find that @xmath471 solve this equation for @xmath442 to obtain ( [ eqn:231gf ] ) .",
    "line ( [ eqn:231 ] ) is immediate from ( [ eqn:231gf ] ) .    combining proposition [ prop:231 ] with theorem [ thm : pik ] and arguing as in the proof of theorem [ thm : e1 ] , we find the generating function for @xmath472 for any @xmath473 .",
    "set @xmath474 and @xmath475 then for all @xmath74 we have @xmath476    next we consider @xmath477 .",
    "we begin with a lemma concerning which products @xmath164 avoid 321 .",
    "[ lem:321 ] fix @xmath110 and @xmath19 such that @xmath478 , fix @xmath479 , and fix @xmath480 .",
    "then @xmath481 if and only if all of the following hold .    1",
    ".   at least one of @xmath107 and @xmath108 begins with 1 . 2 .",
    "the entries @xmath482 are in increasing order in @xmath107 .",
    "3 .   the entries @xmath483 are in increasing order in @xmath108 .",
    "( @xmath484 ) suppose @xmath481 .",
    "if ( i ) does not hold then the entries @xmath485 form a subsequence of type 321 in @xmath164 . if ( ii ) does not hold then the smallest entry to the right of @xmath19 , together with two of the entries among @xmath482 which are in decreasing order , form a subsequence of type 321 in @xmath164 .",
    "if ( iii ) does not hold then the @xmath19 , together with two of the entries among @xmath483 which are in decreasing order , form a subsequence of type 321 in @xmath164 .",
    "since we have a contradiction in each case , we find ( i),(ii ) , and ( iii ) hold .",
    "( @xmath486 ) by proposition [ prop : perminirecurrence](i ) , the permutation @xmath164 avoids 1243 and 2143 .",
    "now observe that by ( i)(iii ) , one of the following holds .    1 .",
    "there exists @xmath14 , @xmath487 , such that @xmath488 2 .",
    "there exists @xmath14 , @xmath489 , such that @xmath490    it is routine to verify that in either case , @xmath164 avoids 321",
    ". therefore @xmath481 , as desired .",
    "we can now enumerate @xmath491 .",
    "[ prop:321 ] for all @xmath39 we have @xmath492    we first prove ( [ eqn:321gf ] ) .",
    "let @xmath442 denote the generating function on the left side of ( [ eqn:321gf ] ) .",
    "by lemma [ lem:321 ] , we may partition @xmath447 into the following four sets : @xmath493 @xmath494 @xmath495 @xmath496 observe that @xmath452 consists of exactly those permutations of the form @xmath497 , so the generating function for @xmath452 is @xmath498 .",
    "observe that the map from @xmath499 to @xmath491 which carries @xmath4 to @xmath468 is a bijection from @xmath499 to the set of permutations in @xmath456 which have length @xmath19 , so the generating function for @xmath456 is @xmath500 .",
    "observe that if @xmath245 and @xmath501 then @xmath107 has the form @xmath502 and @xmath108 has the form @xmath503 for some @xmath14 , @xmath504 .",
    "it follows that the generating function for @xmath464 is @xmath505 .",
    "finally , observe that if @xmath245 and @xmath506 then @xmath108 has the form @xmath507 and there exists @xmath14 , @xmath508 , such that @xmath107 has the form @xmath509 .",
    "it follows that the generating function for @xmath469 is @xmath510 .",
    "combine these observations to find that @xmath511 solve this equation for @xmath442 to obtain ( [ eqn:321gf ] ) .",
    "line ( [ eqn:321 ] ) is immediate from ( [ eqn:321gf ] ) .    combining proposition [ prop:321 ] with theorem [ thm : pik ] and arguing as in the proof of theorem [ thm : e1 ] , we find the generating function for @xmath512 for any @xmath473 .    for all @xmath61 , set @xmath513 then for all @xmath74 we have @xmath514    at the end of section [ sec : permproducts ] we remarked that the results of that section can be generalized to @xmath177 , where @xmath172 is the set of all permutations in @xmath173 which end with @xmath515 . our results in this section",
    "build almost exclusively on the results of section [ sec : permproducts ] , so they can also be generalized to @xmath177 .",
    "in section [ sec : avoidenum ] we used theorem [ thm : pik ] to obtain generating functions for @xmath516 for various @xmath5 ; these results are elaborations on theorem [ thm : e1 ] . in this section",
    "we prove an analogue of theorem [ thm : pik ] for permutations in @xmath129 which contain a given pattern @xmath5 exactly once .",
    "we then use this result to prove several results which elaborate on theorem [ thm : e2 ] .",
    "we begin by setting some notation .",
    "fix a nonempty permutation @xmath517 and set @xmath518 .",
    "we write @xmath519 to denote the generating function for those permutations in @xmath47 which contain exactly one subsequence of type @xmath520 .",
    "we write @xmath521 to denote the generating function for those permutations in @xmath47 which avoid @xmath520 .",
    "we write @xmath522 to denote the generating function for those permutations in @xmath47 which avoid @xmath523 and contain exactly one subsequence of type @xmath520 .",
    "our analogue of theorem [ thm : pik ] is the following result , which gives @xmath524 in terms of @xmath522 and @xmath521 .",
    "[ thm : pik1 ] fix a nonempty permutation @xmath517 and set @xmath518 .",
    "then @xmath525    observe that we may partition the set of permutations in @xmath47 which contain exactly one subsequence of type @xmath523 into the following three subsets .",
    "@xmath526 @xmath527 @xmath528 the generating function for @xmath452 is @xmath529 , the generating function for @xmath456 is @xmath530 , and the generating function for @xmath464 is @xmath531 .",
    "combine these observations to find that @xmath532 solve this last equation for @xmath524 and use theorem [ thm : pik ] to eliminate @xmath533 . simplify the result to obtain ( [ eqn : pik1 ] ) .",
    "theorem [ thm : pik1 ] is particularly useful when @xmath534 ; next we describe for which @xmath520 this occurs .",
    "[ prop : g = j ] fix a permutation @xmath517 such that @xmath535 . then @xmath534 if and only if the last entry of @xmath520 is @xmath536 .",
    "( @xmath484 ) suppose @xmath534 and observe that this implies that if @xmath4 contains exactly one subsequence of type @xmath520 then @xmath4 avoids @xmath537 . however , if the last entry of @xmath520 is not @xmath536 then @xmath537 itself contains exactly one subsequence of type @xmath520 and does not avoid @xmath537 .",
    "this contradiction implies that the last entry of @xmath520 is @xmath536 .",
    "( @xmath486 ) suppose the last entry of @xmath520 is @xmath536 .",
    "if @xmath4 contains @xmath520 and @xmath538 then @xmath4 contains at least two subsequences of type @xmath520 .",
    "therefore if @xmath4 contains exactly one subsequence of type @xmath520 then it avoids @xmath538 ; it follows that @xmath534 .",
    "using theorem [ thm : pik1 ] and proposition [ prop : g = j ] , one can compute @xmath539 for several infinite families of permutations .",
    "nevertheless , we content ourselves here with computing @xmath540 and @xmath541 .",
    "we begin by computing @xmath540 , which amounts to giving another proof of corollary [ cor:12k1gf ] .",
    "_ another proof of corollary [ cor:12k1gf ] _ we argue by induction on @xmath14 . to prove the result for @xmath382 , set @xmath542 in ( [ eqn : pik1 ] ) and observe that @xmath543 and @xmath544 .",
    "now suppose the result holds for @xmath545 .",
    "using ( [ eqn : pik1 ] ) , proposition [ prop : g = j ] , ( [ eqn : e112k ] ) , and ( [ eqn : qnunrecurrence ] ) we find @xmath546 & = & \\frac{x}{\\left(\\frac{1-x}{\\sqrt{x } } u_{k-2}\\left(\\frac{1-x}{2\\sqrt{x}}\\right ) - u_{k-3}\\left(\\frac{1-x}{2\\sqrt{x}}\\right)\\right)^2 } \\\\[3ex ] & = & \\frac{x}{\\left(u_{k-1}\\left(\\frac{1-x}{2\\sqrt{x}}\\right)\\right)^2},\\end{aligned}\\ ] ] as desired .",
    "we now compute @xmath541 .    for all",
    "@xmath74 we have @xmath547    first observe that the only permutations in @xmath47 which contain exactly one subsequence of type 21 and do not contain a subsequence of type 213 are 21 and 132 , so @xmath548 .",
    "now the result follows from ( [ eqn : pik1 ] ) , proposition [ prop : g = j ] , and ( [ eqn : qnunrecurrence ] ) by induction on @xmath14 .    we conclude this section by showing that in a certain sense , there is no analogue of @xmath53 which behaves as nicely with respect to @xmath81 as @xmath53 does with respect to @xmath13 .",
    "[ cor : no213kbijection ] there is no bijection @xmath549 such that for every @xmath181 , the quantity @xmath16 is equal to the number of subsequences of type @xmath81 in @xmath550 .",
    "if such a bijection existed then we would have @xmath551 for all @xmath74 , which contradicts ( [ eqn : g12k ] ) and ( [ eqn : g213k ] ) .",
    "we remark that one can also prove corollary [ cor : no213kbijection ] by observing that if such a bijection existed , then there would be the same number of permutations in @xmath552 which contain exactly one subsequence of type 123 as there are containing exactly one subsequence of type 213 . however , there are 6 of the former ( 2314 , 1423 , 2341 , 1342 , 4123 , 3124 ) and only 5 of the latter ( 3241 , 2413 , 1324 , 3142 , 4213 )",
    ". as this example illustrates , subsequences of type @xmath81 are more plentiful in @xmath129 than subsequences of type @xmath13 .",
    "we conclude with some open problems suggested by the results in this paper .    1 .   in view of ( [ eqn : e112k ] ) , ( [ eqn : e121k ] ) and corollary [ cor : varphiheight ] , there exists a bijection @xmath553 such that for all @xmath61 , the schrder path @xmath4 has height @xmath271 or less if and only if @xmath554 avoids @xmath81 . give a combinatorial description of such a bijection . then give a combinatorial description of the statistic @xmath555 , where @xmath556 for all @xmath155 .",
    "alternatively , give a bijection @xmath557 such that for all @xmath392 and any permutation @xmath155 , we have that @xmath4 avoids @xmath13 if and only if @xmath550 avoids @xmath81 .",
    "2 .   for any permutation @xmath155 let @xmath558 denote the generating function given by @xmath559 then the case of theorem [ thm : pik ] in which @xmath560 amounts to a recurrence relation giving @xmath561 in terms of @xmath558 . find similar relations for @xmath562 in terms of @xmath563 and @xmath564 and for @xmath565 in terms of @xmath558 . alternatively , find an analogue of ( * ? ? ?",
    "* theorem 2.1 ) for @xmath47 .",
    "3 .   give a combinatorial proof of the fact that @xmath566 4 .",
    "give a combinatorial proof of the fact that @xmath567 5 .",
    "for @xmath74 and @xmath83 , find the generating function for the number of permutations in @xmath129 which contain exactly @xmath22 subsequences of type @xmath81 ."
  ],
  "abstract_text": [
    "<S> several authors have examined connections between permutations which avoid 132 , continued fractions , and chebyshev polynomials of the second kind . in this paper </S>",
    "<S> we prove analogues of some of these results for permutations which avoid 1243 and 2143 . using tools developed to prove these analogues , we give enumerations and generating functions for permutations which avoid 1243 , 2143 , and certain additional patterns . </S>",
    "<S> we also give generating functions for permutations which avoid 1243 and 2143 and contain certain additional patterns exactly once . in all cases </S>",
    "<S> we express these generating functions in terms of chebyshev polynomials of the second kind .    </S>",
    "<S> _ keywords : _ restricted permutation ; pattern - avoiding permutation ; forbidden subsequence ; continued fraction ; chebyshev polynomial </S>"
  ]
}