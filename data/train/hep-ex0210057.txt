{
  "article_text": [
    "geant4 is a tool kit developed by a collaboration of physicists and computer professionals in the high energy physics ( hep ) field for simulation of the passage of particles through matter .",
    "the motivation for the development of the beam tools is to extend the geant4 applications to accelerator physics .",
    "the beam tools are a set of c++ classes designed to facilitate the simulation of accelerator elements such as r.f .",
    "cavities , magnets , absorbers .",
    "these elements are constructed from the standard geant4 solid volumes such as boxes , tubes , trapezoids , or spheres .",
    "a variety of visualization packages are available within the geant4 framework to produce an image of the simulated apparatus .",
    "the pictures shown in this article were created with open inventor  @xcite , which allows direct manipulation of the objects on the screen , plus perspective rendering via the use of light .",
    "although there are many computer programs for beam physics simulations , geant4 is ideal to model a beam through a material or to integrate a beam line with a complex detector .",
    "there are many such examples in the current international high energy physics programs .",
    "geant4 is the object oriented c++ version of the geant3 tool kit for detector simulation developed at cern .",
    "it is currently being used in many fields , such us hep , space exploration , and medicine .    as a tool kit",
    ", geant4 provides a set of libraries , a ` main ` function , and a family of initialization and action classes to be implemented by the user .",
    "these classes are singlets , and their associated objects are constructed in ` main ` .",
    "the objects contain the information related to the geometry of the apparatus , the fields , the beam , and actions taken by the user at different times during the simulation .",
    "the geant4 library classes start with the ` g4 ` prefix .",
    "the example described in this section , called ` mucool ` , uses only some of the many available user classes .",
    "the detector and field geometry , properties , and location are implemented in the constructor and methods of the ` mucoolconstruct ` user class , which inherits from ` g4vuserdetectorconstruction ` . in",
    "the ` construct ( ) ` method the user does the initialization of the electromagnetic field and the equation of motion .",
    "there are a variety of runge - kutta steppers to select from , which perform the integration to different levels of accuracy .",
    "next comes the detector description , which involves the construction of solid , logical , and physical volume objects .",
    "they contain information about the detector geometry , properties , and position , respectively .",
    "many solid types , or shapes , are available .",
    "for example , cubic ( box ) or cylindric shapes ( tube ) , are constructed as :    .... g4box(const g4string & pname , g4double px , g4double py , g4double pz ) ; g4tubs(const g4string & pname , g4double prmin , g4double prmax ,          g4double pdz , g4double psphi , g4double pdphi ) ; ....    where a name and half side lengths are provided for the box .",
    "inner , outer radii , half length , and azimuthal coverage are the arguments of a cylinder ( tube ) . a logical volume is constructed from a pointer to a solid , and a given material :    .... g4logicalvolume(g4vsolid * psolid , g4material * pmaterial ,                  const g4string & name ) ....    the physical volume , or placed version of the detector is constructed as :    .... g4pvplacement(g4rotationmatrix * prot , const g4threevector & tlate ,                 const g4string & pname , g4logicalvolume * plogical ,                 g4vphysicalvolume * pmother , g4bool pmany , g4int pcopyno ) ; ....    where the rotation and translation are performed with respect to the center of its `` mother '' volume ( container ) .",
    "pointers to the associated logical volume , and the copy number complete the list of arguments .      geant4 allows the user to select among a variety of physics processes which may occur during the interaction of the incident particles with the material of the simulated apparatus .",
    "there are electromagnetic , hadronic and other interactions available like : `` electromagnetic '' , `` hadronic '' , `` transportation '' , `` decay '' , `` optical '' , `` photolepton_hadron '' , `` parameterisation '' .",
    "the different types of particles and processes are created in the constructor and methods of the ` mucoolphysicslist ` user class , which inherits from ` g4vuserphysicslist ` .      the user constructs incident particles , interaction verteces , or a beam by typing code in the constructor and methods of the ` mucoolprimarygeneratoraction ` user class , which inherits from ` g4vuserprimarygeneratoraction ` .",
    "the ` mucoolsteppingaction ` user action class inherits from ` g4usersteppingaction ` .",
    "it allows to perform actions at the end of each step during the integration of the equation of motion .",
    "actions may include killing a particle under certain conditions , retrieving information for diagnostics , and others .",
    "the ` mucooltrackingaction ` user action class inherits from ` g4usertrackingaction ` .",
    "for example , particles may be killed here based on their dynamic or kinematic properties .",
    "the ` mucooleventaction ` user action class inherits from ` g4usereventaction ` .",
    "it includes actions performed at the beginning or the end of an event , that is immediately before or after a particle is processed through the simulated apparatus .",
    "this section is devoted to explain how to simulate accelerator elements using the beam tools .",
    "brief descriptions of each class and constructor are included .",
    "the beam tools provide a set of classes to simulate realistic solenoids .",
    "these are btsheet , btsolenoid , btsolenoidlogicvol and btsolenoidphysvol .    *",
    "the ` btsheet ` class inherits from ` g4magneticfield ` .",
    "the class objects are field maps produced by an infinitesimally thin solenoidal current sheet .",
    "the class data members are all the parameters necessary to generate analytically a magnetic field in @xmath0-@xmath1 space ( there is @xmath2 symmetry ) .",
    "no geometric volumes or materials are associated with the ` btsheet ` objects . `",
    "getfieldvalue ` is a concrete method of ` btsheet ` inherited from ` g4field ` , through ` g4magneticfield ` .",
    "it returns the field value at a given point in space and time . *",
    "the ` btsolenoid ` class inherits from ` g4magneticfield ` .",
    "the class objects are field maps in the form of a grid in @xmath0-@xmath1 space , which are generated by a set of ` btsheet ` .",
    "the sheets and the ` btspline1d ` objects , containing the spline fits of @xmath3 and @xmath4 versus @xmath1 for each @xmath0 in the field grid , are data members of ` btsolenoid ` .",
    "no geometric volumes or materials are associated with ` btsolenoid ` .",
    "the field at a point in space and time is accessed through a ` getfieldvalue ` method , which performs a linear interpolation in @xmath0 of the spline fit objects . *",
    "the ` btsolenoidlogicvol ` class defines the material and physical size of the coil system which is represented by the set of current sheets .",
    "a ` btsolenoid ` must first be constructed from a list of current ` btsheets ` .",
    "the ` btsolenoid ` object is a data member of ` btsolenoidlogicvol ` .",
    "the ` btsolenoidlogicvol ` class constructor creates ` g4tubs ` solid volumes and associated logical volumes for the coil system , the shielding , and the empty cylindric regions inside them .",
    "only the logical volumes are constructed here .",
    "no physical placement of a magnet object is done . *",
    "the ` btsolenoidphysvol ` class is the placed version of the ` btsolenoidlogicvol ` .",
    "it contains the associated ` btsolenoid ` object as a data member , as well as the pointers to the physical volumes of its logical constituents .",
    "figure  [ fig : sheets ] shows a group of four solenoidal copper coil systems modeled with four infinitesimally thin sheets equally spaced in radius .",
    "-4 cm = 2.6 in    -8.6 cm = 2.6 in    1.2 cm [ fig : solenoid ]      the beam tools also allow to simulate generic field maps using the ` btmagfieldmap ` and ` btmagfieldmapplacement ` classes .    * ` btmagfieldmap ` class inherits from ` g4magneticfield ` .",
    "the constructor reads the map information from an ` ascii ` file containing the value of the field at a set of nodes of a grid .",
    "no geometric objects are associated with the field .",
    "the field at a point in space and time is accessed through a ` getfieldvalue ` method , as in the case of the solenoid . *",
    "the ` btmagfieldmapplacement ` class is a placed ` btmagfieldmap ` object .",
    "only the field is placed because there is no coil or support system associated with it .",
    "this section explains how to simulate realistic r.f .",
    "systems using pill box cavities .",
    "the beam tools package provides the classes : ` btacceldevice ` , ` btpillbox ` , ` btrfcavitylogicvol ` , ` btrfwindowlogicvol ` , and ` btlinacphysvol ` .    * ` btacceldevice.hh ` class is abstract .",
    "all accelerator device classes are derived from this class , which inherits from g4electromagneticfield . *",
    "the ` btpillbox ` class inherits from ` btacceldevice ` and represents single @xmath5 pill box field objects .",
    "no solid is associated with ` btpillbox ` . the time dependent electric field is computed using a simple bessel function .",
    "it is accessed through a ` getfieldvalue ` method .",
    "the field is given by : + @xmath6 + where @xmath7 is the cavity peak voltage , @xmath8 the wave frequency , @xmath9 the synchronous phase , and @xmath10 the bessel functions evaluated at @xmath11 .",
    "* the ` btrfmap ` class also inherits from btacceldevice .",
    "the class objects are electromagnetic field maps which represent an r.f . cavity . in this way , complex r.f .",
    "fields can be measured or generated and later included in the simulation .",
    "the field map , in the form of a grid , is read in the ` btrfmap ` constructor from an ` ascii ` file .",
    "the ` btrfmap ` object is a field , with no associated solid .",
    "a ` getfieldvalue ` method retrieves the field value at a point in space and time . *",
    "the ` btrfcavitylogicvol ` class constructor creates solid and logical volumes associated with the r.f . field classes . in the case of a map",
    ", a vacuum cylinder ring represents its limits .",
    "in addition to geometric and material parameters of the cavity , the class contains field and accelerator device information . *",
    "the ` btrfwindowlogicvol ` class is used with ` btcavitylogicvol ` to create the geometry and logical volume of r.f .",
    "cavity windows , including the support structure , which may be placed to close the cavity iris at the end cups . *",
    "the ` btlinacphysvol ` class is a placed linac object .",
    "a linac is a set of contiguous r.f .",
    "cavities , including the field , the support and conductor material , and windows .",
    "the ` btlinacphysvol ` constructor is overloaded .",
    "one version places a linac of pill box cavities and the other places field maps .",
    "[ fig : berywin ] shows a pill box cavity ( in red ) with windows .",
    "it also shows a cooling channel where solenoids are embedded in large low frequency cavities .",
    "since the beam circulates inside the solenoid , the cavity is represented by a field map ( in red ) restricted to a cylindric volume with radius slightly smaller than the inner radii of the magnets .",
    "-4 cm = 2.6 in    -9 cm = 2.6 in    1.5 cm [ fig : detailview ]      one of the critical elements of an accelerator simulation is the `` r.f .",
    "tuning '' .",
    "each cavity must be operated at the selected synchronous phase at an instant coincident with the passage of the beam .",
    "wave must be therefore synchronized with the beam , more specifically , with the region of beam phase space that the user needs to manipulate .",
    "for this , there is the concept of a reference particle , defined as the particle with velocity equal to the phase velocity of the r.f . wave . if the kinematic and dynamic variables of the reference particle are set to values which are coincident with the mean values of the corresponding variables for the beam , the r.f .",
    "system should affect the mean beam properties in a similar way it affects the reference particle .",
    "the beam tools allow the use of a `` reference particle '' to tune the r.f .",
    "system before processing the beam .",
    "the time instants the particle goes through the phase center of each cavity are calculated and used to adjust each cavity phase to provide the proper kick , at the selected synchronous phase .",
    "the beam tools provide a set of classes to simulate blocks of material in the path of the beam .",
    "the constructors create the solid , logical , and physical volumes in a single step .",
    "they are all derived from the abstract class of absorber objects ` btabsobj ` .    * ` btcylindricvessel ` is a system with a central cylindric rim , and two end cup rims with thin windows of radius equal to the inner radius of the vessel .",
    "the material is the same for the vessel walls and windows , and the window thickness is constant .",
    "the vessel is filled with an absorber material . *",
    "two classes are available to simulate absorber lenses : + ` btparaboliclense ` and ` btcylindriclense ` .",
    "the first one is a class of parabolic objects with uniform density , and the second a cylinder object with the density decreasing parabolically as a function of radius . from the point of view of the physics effect on the beam ,",
    "both objects are almost equivalent .",
    "the ` btparaboliclense ` is built as a set of short cylinders .",
    "the radius is maximum for the central cylinder and reduces symmetrically following a parabolic equation for the others in both sides .",
    "the ` btcylindriclense ` object is built from concentric cylinder rings of the same length , different radius , and different densities to mimic a real lens .    the gray cylinder in fig .",
    "[ fig : unitback ] is a schematic representation of a liquid hydrogen vessel with aluminum walls and windows .",
    "figure  [ fig : unitback ] also shows a set of six parabolic lenses in the center of a complex magnetic system .",
    "the lenses are placed to mitigate the effect of the decrease in @xmath12 at large radii in a magnetic field flip region , using an emittance exchange mechanism .",
    "-4 cm = 2.6 in    -9.5 cm = 2.6 in    1.5 cm [ fig : paraflip ]    wedge absorbers are also useful in some cases .",
    "they can be easily constructed using the geant4 trapezoid shape ` g4trap ` .",
    "the neutrino beam in a neutrino factory would be the product of the decay of a low emittance muon beam .",
    "muons would be the result of pion decay , and pions would be the product of the interaction of an intense proton beam with a carbon or mercury target .",
    "thus the challenge in the design and construction of a neutrino source is the muon cooling section , aimed to reduce the transverse phase space by a factor of ten , to a transverse emittance of approximately @xmath131  cm .",
    "the ionization cooling technique uses a combination of linacs and light absorbers to reduce the transverse emittance of the beam , while keeping the longitudinal motion under control .",
    "there are two competing terms contributing to the change of transverse emittance @xmath14 along the channel .",
    "one is a cooling term , associated with the process of energy loss , and the other is a heating term related to multiple scattering .      the double flip cooling channel is a system consisting of three homogeneous solenoids with two field - flip sections .",
    "the first flip occurs at a relatively small magnetic field ,",
    "b=3  t , to keep the longitudinal motion under control .",
    "the field is then increased adiabatically from -3 to -7  t , and a second field flip performed at b=7  t. figure  [ fig : unitside ] shows a side view of a lattice unit cell , consisting of a six 201  mhz pill box cavities linac and one liquid hydrogen absorber , inside a solenoid .",
    "details on the design and performance of this channel are available in ref .",
    "@xcite .",
    "the helical channel cools both in the transverse and longitudinal directions .",
    "the lattice is based on a long solenoid with the addition of a rotating transverse dipole field , lithium hydride wedge absorbers , and 201  mhz r.f .",
    "figure  [ fig : heliside ] shows a side view of the helical channel , including the wedge absorbers , idealistic ( thin ) r.f .",
    "cavities , and the trajectory of the reference particle .",
    "the design details and performance of this channel are described in ref .",
    "@xcite .",
    "this is a design based on 44/88 mhz r.f .",
    "technology . a unit cell",
    "is composed of four solenoids embedded in four r.f .",
    "cavities , followed by a liquid hydrogen absorber .",
    "figure  [ fig : berywin ] shows a unit cell of the low frequency channel , including the solenoids , the absorber , and the relevant section of the r.f .",
    "field map ( inside the magnets ) .",
    "more information about this channel may be found in ref .",
    "@xcite .      among other simulations performed with the beam tools for geant4 we may cite : the _ alternate solenoid channel ( sfofo ) _",
    "@xcite , and a _ high frequency buncher / phase rotator _",
    "scheme for the neutrino factory  @xcite .",
    "-4 cm = 2.6 in    -9.3 cm = 2.6 in    2.2 cm [ fig : heliside ]",
    "the beam physics tools for geant4 are used in numerous accelerator studies , reported in conference proceedings and proposals .",
    "geant4 is especially suited to systems where accelerators , shielding , and detectors must be studied jointly with a simulation .",
    "the beam tool libraries , a software reference manual , and a user s guide , are available from the fermilab geant4 web page  @xcite .",
    "we thank mark fishler , for contributing the data cards and and spline fit classes , jeff kallenbach for helping with visualization issues , and walter brown for providing c++ consultancy .",
    "we are also grateful to the geant4 collaboration for answering our questions .",
    "in particular , we thank j.  apostolakis , m.  asai , g.  cosmo , m.  maire , l.  urban , and v.  grichine .              `` pseudo - realistic geant4 simulation of a 44/88 mhz cooling channel for the neutrino factory '' , v.  d.  elvira , h.  li , p.  spentzouris .",
    "mucool note @xmath15230 , 12/10/01 ."
  ],
  "abstract_text": [
    "<S> geant4 is a tool kit developed by a collaboration of physicists and computer professionals in the high energy physics field for simulation of the passage of particles through matter . </S>",
    "<S> the motivation for the development of the beam tools is to extend the geant4 applications to accelerator physics . </S>",
    "<S> although there are many computer programs for beam physics simulations , geant4 is ideal to model a beam going through material or a system with a beam line integrated to a complex detector . </S>",
    "<S> there are many examples in the current international high energy physics programs , such as studies related to a future neutrino factory , a linear collider , and a very large hadron collider . </S>"
  ]
}