{
  "article_text": [
    "a polygon @xmath6 is called rational if all angles of @xmath7 are rational multiples of @xmath8 .",
    "let @xmath9 denote the number of ( cylinders of ) periodic billiard trajectories of euclidean length at most @xmath10 .",
    "it is a theorem of h.  masur @xcite that there exist constants @xmath11 and @xmath12 such that for @xmath13 , @xmath14 a natural question is whether ( [ eq : masur ] ) can be converted to an asymptotic formula as @xmath15 .    a well known construction associates a `` translation surface '' @xmath16 to each rational polygon @xmath7 .",
    "essentially the algorithm `` unfolds '' the billiard trajectories , by reflecting the polygon instead of reflecting the trajectory .",
    "more precisely , let @xmath17 denote the group generated by reflections in the sides of the polygon @xmath7 . since @xmath7 is rational",
    ", @xmath18 is finite .",
    "the `` translation surface '' consists of @xmath18 copies of @xmath7 , with each copy glued to each of its mirror images along the reflecting side .",
    "for example , if @xmath7 is the unit square , then @xmath16 is the torus @xmath19 , and if @xmath7 is the isosceles triangle with angles @xmath20 , @xmath20 , @xmath21 , and @xmath5 is even , then @xmath16 is the regular @xmath5-gon with opposite sides identified .",
    "a translation surface can be defined in one of the following equivalent ways :    1 .",
    "[ transsurfdefn - polygons ] a union of polygons @xmath22 where each @xmath23 , and the @xmath24 are glued along parallel sides , such that each side is glued to exactly one other , and the total angle in each vertex is an integer multiple of @xmath25 .",
    "2 .   an orientable surface with a flat metric and isolated conical singularities that has trivial rotational holonomy .",
    "( note that trivial rotational holonomy means in particular that parallel transport of a vector along a small loop going around a conical point brings a vector back to itself .",
    "this implies that all cone angles are integer multiples of @xmath25 . )",
    "a pair @xmath26 , where @xmath27 is an ( orientable ) riemann surface , and @xmath28 is a holomorphic 1-form on @xmath27 .",
    "( note that away from the zeroes of @xmath28 , there is a local coordinate @xmath29 such that @xmath30 , and this coordinate is unique up to translation .",
    "then one can define the metric on @xmath27 as @xmath31 .",
    "this metric is flat , with conical singularities appearing at the zeroes of @xmath28 .",
    "the term `` translation surface '' comes from the fact that away from the cone points the surface can be covered by charts so that the transition functions are translations ( @xmath32 ) .",
    "if @xmath33 is an @xmath5-tuple of positive integers such that the sum of the @xmath34 is even , we denote by @xmath35 the moduli space of translation surfaces @xmath26 such that the multiplicities of the zeroes of @xmath28 are given by @xmath36 ( or equivalently such that the orders of the conical singularities are @xmath37 ) .",
    "( actually , for technical reasons , the singularities of @xmath26 should be labeled ; thus , an element of @xmath35 is a tuple @xmath38 , where @xmath39 are the singularities of  @xmath27 , and the multiplicity of  @xmath40 is  @xmath34 . ) the moduli space of translation surfaces is naturally stratified by the spaces @xmath35 ; each is called a _",
    "stratum_.    by construction , billiard trajectories on @xmath7 correspond to `` straight lines '' on @xmath16 , which are geodesics not passing through singularities .",
    "it is easy to see that any such geodesic is part of a family of freely homotopic parallel geodesics of the same length .",
    "such a family is called a cylinder .",
    "let @xmath41 denote the number of cylinders on @xmath16 of length at most @xmath10 .",
    "( by the length of a cylinder we mean the length of any of the closed geodesics that comprise it ) .",
    "there is an action of @xmath0 on the moduli space of translation surfaces that preserves the stratification . for our purpose",
    ", it is easiest to see this using definition ( [ transsurfdefn - polygons ] ) : since @xmath0 acts on @xmath42 , for @xmath43 , we can define @xmath44 , where all identifications between the sides of the polygons for @xmath45 are the same as for @xmath16 .",
    "this action generalizes the action of @xmath0 on the space of flat tori @xmath46 .",
    "we can visualize this as a composition of `` the usual linear action '' with `` cut and paste . ''",
    "we note that `` cut and paste '' is an isometry on the surface ( and in fact preserves the horizontal and vertical directions as well ) .",
    "note that if @xmath16 is a union of triangles , and @xmath47 is a large element of @xmath0 then @xmath45 is a union of long and thin triangles .",
    "we may if we wish `` cut and paste '' @xmath45 and retriangulate to try to present @xmath45 as a union of triangles with bounded side lengths .      for @xmath48 ,",
    "let @xmath49 denote the stabilizer of @xmath16 .",
    "the group @xmath50 is called the _ veech group _ of @xmath16 . if @xmath50 is a lattice in @xmath0 then @xmath16 is called a _",
    "veech surface_. it is a theorem of veech @xcite that if @xmath16 is a veech surface , then there exists @xmath51 such that @xmath52 as @xmath15 .",
    "one has the formula @xcite , ( reproduced in @xcite ) @xmath53 where @xmath54 , @xmath55 , and @xmath56 .",
    "the left hand side counts ( cylinders ) of closed geodesics in an annulus , and the right hand side is an integral over part of the @xmath0 orbit of @xmath16 .",
    "thus , the @xmath0 action can be used to count closed geodesics ( and thus periodic billiard trajectories ) .",
    "a closer examination of ( [ eq : count ] ) shows that the integral is over large circles inside the @xmath0 orbit .",
    "these large circles can be approximated by horocycles , which are orbits of @xmath57 .",
    "thus the ergodic properties of the action of @xmath58 play a key role .",
    "ratner s theorem @xcite is the classification of the invariant measures for the action of a unipotent subgroup on the homogeneous space @xmath59 , where @xmath60 is a lie group and @xmath61 is a lattice in @xmath60 .",
    "an important question is whether a similar theorem holds for the @xmath2-action on a stratum @xmath35 .",
    "one can also ask this question when one restricts the action to any @xmath0 invariant submanifold of a stratum . in this paper",
    ", we will classify the @xmath2-invariant measures on a certain family of @xmath0-invariant manifolds .",
    "another result in this direction was obtained by mcmullen @xcite who , in genus @xmath62 , classified the measures invariant under all of @xmath0 .",
    "we say that a translation surface @xmath16 is a branched cover of a translation surface @xmath27 if the covering map @xmath8 respects the translation structure ( i.e. if we identify @xmath63 and @xmath64 where the @xmath65 are riemann surfaces and the @xmath66 are holomorphic 1-forms on @xmath65 then we require that @xmath67 is holomorphic and @xmath68 . )    now let @xmath69 be a veech surface .",
    "then the @xmath0 orbit of @xmath27 is a closed subset @xmath70 of @xmath35 .",
    "let @xmath71 be another stratum , and let @xmath72 denote the set of all translations surfaces @xmath73 that are branched covers of @xmath74 .",
    "we will always assume that @xmath75 is such that @xmath72 is not - empty .",
    "then @xmath72 is @xmath0 invariant .",
    "there are two types of veech surfaces : arithmetic and non - arithmetic .",
    "a surface @xmath76 is an arithmetic veech surface if and only if @xmath27 is a ( holomorphic ) branched cover of a torus , @xmath28 is the pullback by the covering map of the standard differential @xmath77 on the torus , and the branch points project to points of finite order ( under the additive group of the torus ) .",
    "equivalently ( see @xcite ) @xmath16 is an arithmetic veech surface if and only if @xmath50 is commensurable to @xmath78 .",
    "all other veech surfaces are called non - arithmetic ( and their veech groups , which are always non - uniform lattices , are non - arithmetic lattices in @xmath0 ) . the case where @xmath27 is arithmetic was analyzed in @xcite .    in this paper , we assume that @xmath27 is not arithmetic , which implies that the genus of @xmath27 is greater then 1 . then considering the euler characteristic , it is easy to see that the degree of @xmath8 is determined by @xmath70 and @xmath75 .",
    "this implies that @xmath72 is closed .",
    "( in the case where the genus of @xmath27 is 1 , one also has to fix the degree of the cover ; see @xcite for the details . )",
    "the main result of this paper is a classification of the @xmath2-invariant ergodic measures on @xmath72 .",
    "this allows us to prove asymptotic formulas of the form ( [ eq : asymp ] ) for @xmath79 ( see theorem  [ theorem : branched : cover : count ] ) . in particular we prove the following :    [ theorem : triangle : count ] let @xmath80 be a triangle with angles @xmath81 where @xmath4 , @xmath5 odd .",
    "then , as @xmath15 , @xmath82    the fact that the surface @xmath83 associated to @xmath80 is not veech but is a branched cover of degree 2 of a veech surface is due to p.  hubert and t.  schmidt ( see proposition 4 in @xcite and its proof ) .",
    "we should also note that if @xmath84 then the veech group of @xmath83 is infinitely generated ( see @xcite ) .",
    "however , the veech group of @xmath83 plays no direct role in our analysis .",
    "here is an outline of the paper .",
    "section  [ measclasssect ] states our main theorem .",
    "section  [ preliminariessect ] establishes notation and presents a few basic lemmas .",
    "section  [ shearingsect ] explains  shearing , \" the foundation of our study of invariant measures .",
    "section  [ mainpfsect ] proves our main theorem ( [ theorem : classification ] ) that classifies @xmath2-invariant measures .",
    "section  [ countabilitysection ] proves that there are only countably many closed orbits of a certain type .",
    "section  [ avgcirclesect ] uses our main theorem ( and the countability result of  [ countabilitysection ] ) to prove that large circles in @xmath0-orbits become uniformly distributed with respect to certain natural measures .",
    "section  [ application ] applies the equidistribution result of  [ avgcirclesect ] to derive asymptotic estimates for the number of periodic trajectories in branched covers of veech surfaces .",
    "let @xmath85 . let @xmath27 be a veech surface , which means that @xmath86 is a lattice in  @xmath87 . here , we use @xmath27 to also denote the isometry class of  @xmath27 ; this is a single point in the moduli space . for @xmath88 , we define @xmath89 to be the natural fiber bundle over @xmath90 whose fiber over @xmath27 is @xmath91 .",
    "thus , a point of  @xmath89 is represented by @xmath92 , where @xmath93 and @xmath94 . in other words ,",
    "a point in @xmath89 represents a surface in @xmath95 together with @xmath96 marked points on @xmath97 .",
    "we note that the space @xmath72 parameterizing branched covers is itself a finite branched cover of the space @xmath89 for a suitable @xmath96 .",
    "( the covering map just maps @xmath98 to the surface in @xmath70 it covers , and notes the locations of the branch points . )",
    "thus , to classify the @xmath2-invariant measures on @xmath72 it is enough to classify @xmath2-invariant measures on @xmath89 ( see  [ fincovclassify ] ) .",
    "if @xmath27 is a torus , then @xmath89 can be identified with the homogeneous space @xmath99 .",
    "in this situation , a special case of ratner s theorem @xcite classifies all the ergodic @xmath2-invariant probability measures on  @xmath89 .",
    "we generalize this to allow @xmath27 to be any veech surface . the proof is based heavily on ideas of ratner @xcite and margulis - tomanov @xcite .",
    "an introduction to these ideas can be found in @xcite .",
    "let @xmath100 be the singular set of  @xmath27 .",
    "then for @xmath101 , @xmath102 is the singular set of @xmath103 .",
    "let @xmath104 , and let @xmath105 denote the set @xmath106 where @xmath101 and @xmath107 .",
    "then @xmath108 is isomorphic to the natural fiber bundle over @xmath109 whose fiber over @xmath27 is @xmath110 .",
    "we have a natural embedding of  @xmath42 in the space @xmath111 of smooth vector fields on  @xmath112 , so , for each @xmath113 and @xmath114 , we have a trajectory @xmath115 in  @xmath112 that is defined for @xmath116 in a certain open interval containing  @xmath117 ( until the trajectory hits the singular set ) .",
    "we are interested only in the forward trajectory , that is , for @xmath118 . by including the singular points of  @xmath27",
    ", we extend @xmath119 to a continuous curve @xmath120 in  @xmath27 that is defined for @xmath116 in a closed interval ( and for all points in  @xmath27 ) :    * let @xmath121 for all @xmath113 and @xmath122 ; and * if @xmath123 and @xmath116 is in the closure of the domain of @xmath119 , let @xmath124    then each @xmath113 defines a function @xmath125 , defined by @xmath126 , where @xmath127 is a dense , open subset of  @xmath27 . note that @xmath128 is a local isometry ( hence continuous ) . on the other hand , @xmath128 is usually not invertible , because a singular point will typically have several preimages .",
    "in addition , @xmath128 is usually not uniformly continuous , because of branch cuts .    for @xmath129",
    ", we have a continuous map @xmath130 ( where @xmath131 is a certain subset of  @xmath89 ) , defined by @xmath132 ( thus , @xmath133 does not change the surface  @xmath27 , but moves the marked points in the directions specified by  @xmath134 . )",
    "let @xmath135 be the pseudosemigroup generated by @xmath136 .",
    "( the prefix  pseudo \" simply refers to the fact that these maps are not defined on the entire space @xmath89 , but only on a subset . )",
    "although the maps in @xmath135 may not be one - to - one , they are always finite - to - one .    for @xmath129 ,",
    "let @xmath137 be the restriction of  @xmath133 to @xmath138 .",
    "then @xmath137 is a diffeomorphism ( and local isometry ) from a dense open subset of  @xmath139 to a dense open subset of  @xmath139 .",
    "let @xmath140 be the pseudogroup that is generated by @xmath141 .",
    "we remark that @xmath140 is transitive on  @xmath142 .",
    "note that each of @xmath143 and @xmath144 is normalized by the action of @xmath145 on  @xmath89 , so we have corresponding semidirect products @xmath146 and @xmath147 .",
    "let @xmath148 and @xmath149 note that , for @xmath150 , we have @xmath151 on the intersection of their domains , so @xmath152 is a pseudosemigroup .",
    "also , @xmath152 commutes with the action of @xmath2 .",
    "let @xmath153 be an ergodic @xmath2-invariant probability measure on  @xmath89 .",
    "the projection of  @xmath153 to @xmath154 is @xmath2-invariant , so it must be either lebesgue measure or the arc - length on a closed @xmath2-orbit @xcite .",
    "the interesting case is when the projection is lebesgue .",
    "a weak statement of our results is simply to say that , in this case , some horizontal translate of  @xmath153 must be @xmath87-invariant :    [ theorem : u->g ] suppose @xmath153 is any ergodic @xmath2-invariant probability measure on @xmath89 , such that the projection of  @xmath153 to @xmath154 is lebesgue",
    ". then there exists @xmath155 , such that @xmath156 is @xmath87-invariant ( and the domain of  @xmath157 has full measure ) .    to obtain a more precise description of the @xmath2-invariant measures , one need only describe the @xmath87-invariant measures on @xmath89 .",
    "[ remark : beforethm ]    1 .",
    "[ remark : beforethm - gamma = g ] it is easy to see that the @xmath87-invariant probability measures on  @xmath89 are in natural one - to - one correspondence with the @xmath61-invariant probability measures on  @xmath91 ( cf . , e.g. , ( * ? ?",
    "* pf .  of cor .",
    "[ remark : beforethm - nosing ] it is the @xmath61-invariant measures on @xmath158 that are the most important to understand , because it is easy to see that every ergodic measure on @xmath91 arises from the following construction .",
    "choose some @xmath159 and some probability measure  @xmath160 on @xmath161 that is invariant under a finite - index subgroup of  @xmath61 .",
    "the corresponding measure on @xmath162 is invariant under a finite - index subgroup  @xmath163 of  @xmath61 . by averaging over @xmath164 ,",
    "this yields a @xmath61-invariant measure supported on the subset @xmath165 of @xmath91 .",
    "we will show that every ergodic measure is carried by a nice subspace of  @xmath91 .",
    "in particular , any ergodic measure carried by @xmath158 is the lebesgue measure on a flat submanifold of @xmath158 .",
    "the natural lebesgue measure on the diagonal @xmath166 of @xmath167 is a @xmath61-invariant probability measure on @xmath167 .",
    "note that @xmath168 is a @xmath87-invariant subspace of @xmath169 , and that the pseudogroup @xmath170 of diffeomorphisms it generates is transitive on  @xmath18 .",
    "[ theorem : gammainvt ] suppose @xmath153 is an ergodic @xmath61-invariant probability measure on @xmath91",
    ". then there exist    * a point @xmath171 , and * a @xmath87-invariant linear subspace  @xmath172 of @xmath173 ,    such that    1 .   the orbit @xmath174 of  @xmath175 under @xmath176 is a closed subset of  @xmath91 whose dimension is @xmath177 , 2 .",
    "[ theorem : gammainvt - finiteindex ] some finite - index subgroup of  @xmath61 fixes @xmath174 setwise , and 3 .",
    "@xmath153 is the @xmath174-invariant lebesgue measure on @xmath178 .    1 .   conversely ,",
    "if @xmath172 is @xmath87-invariant , @xmath174 is closed , and some finite - index subgroup of  @xmath61 fixes @xmath174 , then the @xmath176-invariant lebesgue measure on @xmath178 is a @xmath61-invariant probability measure .",
    "however , it may not be ergodic .",
    "we wish to emphasize that conclusion  [ theorem : gammainvt]([theorem : gammainvt - finiteindex ] ) implies the set @xmath178 is a finite union of translates of @xmath174 .",
    "the theorem can be stated in the following equivalent form ( see  [ remark : beforethm]([remark : beforethm - gamma = g ] ) ) :    theorem : gammainvt    [ theorem : ginvtmeas ] suppose @xmath153 is an ergodic @xmath87-invariant probability measure on @xmath142",
    ". then there exist    * a point @xmath179 and * a @xmath87-invariant linear subspace  @xmath172 of @xmath173 ,    such that    1 .   the orbit @xmath180 of  @xmath175 under @xmath181 is a closed subset of  @xmath89 whose dimension is @xmath182 , and 2 .",
    "@xmath153 is the @xmath183-invariant lebesgue measure on this orbit .",
    "this results in the following explicit version of theorem  [ theorem : u->g ] :    [ theorem : classification ] suppose @xmath153 is an ergodic @xmath2-invariant probability measure on @xmath142",
    ". then there exist    * a point @xmath179 , * a @xmath87-invariant subspace  @xmath172 of @xmath173 , and * some @xmath184 ,    such that    1 .",
    "@xmath185 , 2 .",
    "the orbit @xmath180 of  @xmath175 under @xmath181 is a closed subset of  @xmath89 whose dimension is @xmath186 , and 3 .",
    "@xmath187 is the @xmath188-invariant lebesgue measure on this orbit .",
    "we will give an application to counting the number of periodic trajectories on  @xmath27 ( see   [ application ] ) .",
    "theorems  [ theorem : u->g ] , [ theorem : gammainvt ] , and  [ theorem : ginvtmeas ] have been stated only for expository purposes  they are not a part of the logical development .",
    "we prove only theorem  [ theorem : classification ] , and the interested reader can easily derive the other theorems as corollaries .",
    "our results imply that the closure of every @xmath61-orbit in  @xmath91 is of a nice geometric form .",
    "since @xmath189 is a @xmath61-invariant finite set , it suffices to describe the orbits of points in @xmath190 :    corollary : gorbit    [ corollary : gammaorbit ] suppose @xmath191 . then there exists a @xmath87-invariant linear subspace  @xmath172 of @xmath173 , such that    1 .   the orbit @xmath174 of  @xmath175 under @xmath176 is a closed subset of  @xmath91 ( and its dimension is @xmath177 ) , 2 .",
    "some finite - index subgroup of  @xmath61 fixes @xmath174 setwise , and 3 .",
    "@xmath178 is the closure of the @xmath61-orbit of  @xmath175 .",
    "we collect all the notation in this section .",
    "some of this repeats the definitions given in the previous sections .",
    "[ prelimnotation ]    * let @xmath192 .",
    "* there is a natural action of  @xmath87 on the moduli space of translation surfaces .",
    "we can visualize this as a composition of `` the usual linear action '' with `` cut and paste . ''",
    "we note that `` cut and paste '' is an isometry on the surface ( and in fact preserves the horizontal and vertical directions as well ) .",
    "* let @xmath27 be a veech surface , which means that @xmath193 is a lattice in  @xmath87 . here",
    ", we use @xmath27 to also denote the isometry class of  @xmath27 ; this is a single point in the moduli space .",
    "* let @xmath88 .",
    "* we define @xmath89 to be the natural fiber bundle over @xmath194 whose fiber over @xmath195 is @xmath91 .",
    "thus , a point of  @xmath89 is represented by @xmath92 , where @xmath196 and @xmath94 . *",
    "the metric on @xmath89 is defined by @xmath197 , [ ( m '' , ( q_i)_{i=1}^k ] \\bigr ) \\\\        & \\hskip0.5 in = \\min_{\\begin{matrix }        g \\in g , \\\\",
    "g m ' = m ''        \\end{matrix } }        \\left ( \\|g - \\operatorname{id}\\| + \\sum_{i=1}^k d_{m''}(g p_i , q_i ) \\right ) .",
    "\\end{aligned}\\ ] ] * note that @xmath89 is @xmath87-equivariantly homeomorphic to @xmath198 , where * * @xmath61 acts on @xmath87 by right multiplication , * * @xmath61 acts on  @xmath91 componentwise , and * * @xmath87 acts on @xmath89 via @xmath199 .",
    "* let @xmath100 be the singular set of  @xmath27 .",
    "* let @xmath104 .",
    "* let @xmath200 .",
    "* any @xmath129 naturally defines a vector field on  @xmath139 . by taking the time - one map of the corresponding flow ( where it is defined ) , we obtain a diffeomorphism @xmath137 between two dense open subsets of  @xmath139 .",
    "the collection @xmath201 generates a transitive pseudogroup @xmath140 of local diffeomorphisms of  @xmath142 .",
    "+ we extend @xmath137 to a ( continuous ) transformation @xmath133 that is defined on a slightly larger subset of  @xmath202 , by letting @xmath203 if the limit exists .",
    "( see  [ measclasssect ] for a more concrete definition of @xmath133 , in terms of the flow corresponding to  @xmath134 . )",
    "we let @xmath144 be the pseudosemigroup generated by these maps .",
    "+ because the action of @xmath87 on @xmath89 normalizes @xmath140 and @xmath140 , we have semidirect products @xmath204 and @xmath205 .",
    "note that @xmath204 is transitive on @xmath142 .",
    "+ it is important to note that , because of the singularities and resulting branch cuts , @xmath137 is usually not uniformly continuous ( even though it is a local isometry ) .",
    "furthermore , @xmath206 is not a uniformly continuous function of  @xmath134 .",
    "see figure  [ fig : opposite ] . abusing notation , we may sometimes write @xmath207 instead of @xmath208 .",
    "* let @xmath209 , where @xmath210 .",
    "* let @xmath211 , where @xmath212 .",
    "* let @xmath213 , where @xmath214 .",
    "* let @xmath153 be a @xmath2-invariant probability measure on @xmath89 , such that @xmath153 projects to the lebesgue measure on @xmath215 .",
    "* let @xmath216 and @xmath217 .",
    "then @xmath152 is a pseudosemigroup .",
    "* let @xmath218 and @xmath219 * for @xmath220 , we define @xmath221 by @xmath222 .",
    "thus , @xmath223 * the set @xmath224 is @xmath2-invariant .",
    "thus , it is either null or conull",
    ". let us assume it is conull .",
    "( if not , then by ergodicity , there exists @xmath225 such that @xmath156 is supported on @xmath226 . so @xmath156 can be described by a construction similar to remark  [ remark : beforethm]([remark : beforethm - nosing ] ) .",
    "the conclusion of theorem  [ theorem : classification ] is therefore obtained by induction on  @xmath96 . ) + note that @xmath227 acts on  @xmath228 , by @xmath229 .",
    "therefore , the group @xmath230 acts on @xmath228 .",
    "* let @xmath231 note that @xmath232 acts on @xmath233 , but we do not yet know that @xmath233 is conull . * let @xmath234 . because @xmath227 acts on @xmath228 , we know that @xmath235 is a closed subgroup of @xmath227 .",
    "* let @xmath236 .",
    "equivalently , @xmath237 * let @xmath238 .",
    "note that @xmath172 is a @xmath87-invariant subspace of  @xmath173 , so @xmath239 is a pseudosemigroup .",
    "* let @xmath240 .",
    "* let @xmath241 . by permuting coordinates",
    ", we may assume @xmath242 .",
    "* let @xmath243 ( the first @xmath244 coordinates ) be the natural projection .",
    "* for @xmath245 , we use @xmath246 to denote the fiber measure of  @xmath153 over the point @xmath247 of  @xmath248 .",
    "the following is obtained by applying the pointwise ergodic theorem to the action of  @xmath2 on  @xmath89 .",
    "[ unifgeneric ] for any @xmath249 , there is a  uniformly generic set \" @xmath250 in  @xmath89 , such that    1 .",
    "@xmath251 , 2 .   for every @xmath252 and every compact subset @xmath253 of  @xmath89 , with @xmath254 , there exists @xmath255 ,",
    "such that , for all @xmath256 and all @xmath257 , we have @xmath258 \\mid d(u^s \\omega , k ) < \\epsilon \\,\\ } > ( 1 - \\epsilon ) ( 2l ) , \\ ] ] where @xmath259 is the lebesgue measure on  @xmath260 .",
    "[ simultaneous ] suppose a lie group  @xmath60 acts continuously on a borel subset  @xmath27 of a locally compact metric space .",
    "if    * @xmath2 is a one - parameter , normal subgroup of  @xmath60 , and * @xmath153 is an ergodic @xmath2-invariant probability measure on  @xmath27 ,    then    1 .",
    "[ simultaneous - conull ] there is a @xmath2-invariant , borel subset  @xmath261 of  @xmath27 , such that 1 .",
    "@xmath262 , and 2 .",
    "@xmath263 for all @xmath264 , + and 2 .",
    "[ simultaneous - cpct ] for any @xmath252 , there is a compact subset  @xmath253 of  @xmath27 , such that 1 .",
    "@xmath254 , and 2 .",
    "@xmath265 for all @xmath266 .",
    "ratner s argument in ( * ? ? ?",
    "2.2 ) shows , for each @xmath267 , that there is a neighborhood  @xmath268 of  @xmath269 in @xmath270 and a conull @xmath2-invariant subset  @xmath271 of  @xmath27 , such that @xmath272 for the reader s convenience , we sketch the proof of this fact . because @xmath269 normalizes  @xmath2 but does not belong to @xmath273 , we know that @xmath274 is @xmath2-invariant and ergodic , but is not equal to  @xmath153 . therefore @xmath274 and @xmath153 are mutually singular , which implies there is a compact subset  @xmath275 of  @xmath27 , such that @xmath276 and @xmath277 . by continuity and compactness",
    ", there are open neighborhoods @xmath278 and @xmath279 of  @xmath275 , and a symmetric neighborhood @xmath280 of  @xmath281 in  @xmath60 , such that @xmath282 and @xmath283 . from the pointwise ergodic theorem ,",
    "we know there is a conull @xmath2-invariant subset  @xmath271 of  @xmath27 , such that the @xmath2-orbit of every point in  @xmath271 spends 99% of its life in @xmath284 .",
    "now suppose there exists @xmath285 , such that @xmath286 .",
    "then there exists @xmath287 , @xmath288 , and @xmath289 , such that @xmath290 and @xmath291 both belong to @xmath284 .",
    "this implies that @xmath292 and @xmath293 both belong to  @xmath279 .",
    "this contradicts the fact that @xmath294 .",
    "( [ simultaneous - conull ] ) cover @xmath295 with countably many balls @xmath296 , and let @xmath297 .",
    "( [ simultaneous - cpct ] ) let @xmath253 be any compact subset of  @xmath261 with @xmath254 .",
    "[ kms : uniqerg ] for a.e .",
    "@xmath113 , the foliation by orbits of @xmath298 is uniquely ergodic on  @xmath112 .",
    "[ uniqerghoriz ] suppose @xmath153 is a @xmath2-invariant probability measure on @xmath228 whose projection to @xmath154 is lebesgue .    if @xmath153 is @xmath227-invariant , then @xmath153 is the lebesgue measure .",
    "theorem  [ kms : uniqerg ] implies that the foliation by orbits of @xmath227 is uniquely ergodic on  @xmath299 , for a.e",
    ".  @xmath101 .",
    "thus , almost every fiber of  @xmath153 over @xmath154 is the lebesgue measure .",
    "in this section , we prove the crucial fact that the direction of fastest transverse divergence between two nearby @xmath2-orbits is always along the stabilizer of  @xmath153 .",
    "the analogous statement for unipotent flows is a cornerstone of the proof of ratner s theorem ( * ? ? ?",
    "3.3 ) , ( * ? ? ?",
    "7.5 ) , ( * ? ? ?",
    "5.2.4@xmath300 ) .    [ divnotn ]    * for any @xmath101",
    ", we may write @xmath301 with @xmath302 . for a sequence @xmath303",
    ", we have @xmath304 if and only if @xmath305 . *",
    "suppose @xmath306 , say .",
    "for @xmath220 with @xmath307 , let * * @xmath308 , * * @xmath309 , and * * @xmath310 .",
    "+ note that @xmath311 if @xmath312 .",
    "* suppose @xmath313 and @xmath314 are two sequences in a metric space . if @xmath315 , we may write @xmath316 .    [ ugucalc ] a simple calculation shows that @xmath317 for a sequence @xmath304 , we denote @xmath318 , and @xmath319 .",
    "then @xmath320 if @xmath321 ( and @xmath322 ) .",
    "(  shearing \" ) let us discuss the action of  @xmath2 on  @xmath173 . for any @xmath323 and @xmath129 , we have @xmath324 assume , now that @xmath325 there is some @xmath326 , such that @xmath327",
    ". then @xmath328 thus , under the @xmath2-flow , @xmath329 and  @xmath330 move apart along a leaf of the @xmath227-foliation .",
    "in other words , the direction in which two nearby points move apart fastest is along  @xmath227 .",
    "we use the notation of ( [ divnotn ] ) to state the main result of this section .",
    "[ divstab ] for every @xmath249 , there is a compact subset @xmath250 of  @xmath228 , with @xmath331 , such that , if    * @xmath332 are convergent sequences in @xmath250 , * @xmath333 for some @xmath334 and @xmath335 , * @xmath304 and @xmath336 , * @xmath337 with @xmath338 and * @xmath339 converges ,    then @xmath340 .",
    "define @xmath341 \\to a \\operatorname{horiz}$ ] by @xmath342 where , letting @xmath343 and @xmath344 , we have @xmath345 it is clear that @xmath346 is continuous",
    ". we will show @xmath347 for all  @xmath116 .",
    "then @xmath348 as desired .",
    "let @xmath250 be a uniformly generic set for the action of  @xmath2 on @xmath89 with @xmath331 ( see  [ unifgeneric ] ) . by passing to a subset",
    ", we may assume that @xmath349 and that @xmath250 is compact .",
    "for any @xmath252 , we know , from lemma  [ simultaneous ] ( with @xmath350 ) , that there is a compact subset  @xmath253 of  @xmath228 , such that @xmath351 and @xmath352 , for all @xmath353 .    when @xmath5 is large , the definition of  @xmath250 implies that @xmath354 for all but  @xmath355% of the values of  @xmath356 in the interval @xmath357 $ ] ( or longer intervals ) ( see  [ unifgeneric ] ) .",
    "note that the jacobian of  @xmath358 is uniformly bounded on @xmath359 $ ] .",
    "more precisely , @xmath360 , so @xmath361 .",
    "therefore , @xmath362 for all but @xmath363% of the values of  @xmath356 in the interval @xmath364 $ ] .",
    "thus , ( [ divstabpf - uclose ] ) and ( [ divstabpf - uclose ] ) hold _ simultaneously _ for all but @xmath365% of the values of  @xmath356 in the interval @xmath364 $ ] .",
    "let @xmath366 .",
    "because @xmath367 , we know that translating @xmath368 by a vector in  @xmath227 can not move it into  @xmath100 . hence @xmath369 for any compact subset  @xmath370 of @xmath227",
    ". therefore , if @xmath5  is sufficiently large , and , for convenience , we let @xmath371 , then    * @xmath372 has no singularities in @xmath373 so * @xmath374 has no singularities in @xmath375    this implies that @xmath376 therefore @xmath377 when ( [ divstabpf - uclose ] ) and ( [ divstabpf - uclose ] ) hold simultaneously , we conclude that @xmath378 from the definition of  @xmath253 , we conclude that @xmath379 . that is , @xmath380 belongs to @xmath381 for all but @xmath365% of the values of  @xmath116 in @xmath382 $ ] .",
    "because @xmath355 is arbitrary , @xmath346  is continuous , and @xmath381 is closed subgroup , we conclude that @xmath383 must actually belong to the stabilizer for all values of  @xmath116 , as desired .",
    "we assume the notation of ( [ prelimnotation ] ) .",
    "recall , in particular , that @xmath153 is carried by @xmath228 , and that the group @xmath384 acts on @xmath228 .",
    "[ fibersonhoriz ] almost every fiber of  @xmath153 over @xmath385 is supported on finitely many orbits of @xmath386 .",
    "because @xmath153 is an ergodic probability measure , it suffices to show that almost every fiber is supported on countably many such orbits . for @xmath250 as in proposition  [ divstab ] , we know @xmath387 is conull , so it suffices to show , for each @xmath249 , that each fiber of @xmath250 is contained in the union of countably many orbits of @xmath386 .",
    "suppose not .",
    "( this will lead to a contradiction . ) because any uncountable set contains one if its accumulation points , there exist @xmath388 and a sequence @xmath313 in  @xmath97 , such that    * @xmath389 , * @xmath390 , * @xmath391 , and * @xmath392 .    because @xmath390 and @xmath391 , we may write @xmath393 for some @xmath394 with @xmath395 . by assumption , we know @xmath396 , so @xmath397 is a nonzero element of @xmath398 .",
    "because @xmath399 and proposition  [ divstab ] implies that @xmath400 converges to an element of @xmath401 , we conclude that @xmath402 is nontrivial .",
    "this contradicts the definition of  @xmath235 .",
    "[ finfiboverxd ] after restricting to an appropriate conull subset  @xmath403 of @xmath228 , each fiber of  @xmath404 is finite .    we know",
    ", from proposition  [ fibersonhoriz ] , that almost every fiber of  @xmath404 is carried by only finitely many orbits of  @xmath405 .",
    "( from theorem  [ kms : uniqerg ] , we may assume that each of these is an embedded copy of @xmath386 . ) letting @xmath406 we may define a measurable function @xmath407 $ ] by @xmath408 .",
    "this function is essentially @xmath2-invariant , so it must be essentially constant . because this is true for all  @xmath244 , we conclude that  @xmath404 is carried by a single point in each orbit of @xmath386 .",
    "since there are only finitely many such orbits to consider , we conclude that a.e .",
    "fiber consists of a finite number of atoms , as desired .",
    "[ ainvt ] we may assume @xmath153 is @xmath409-invariant .    choose @xmath250 as in proposition  [ divstab ] , with @xmath410 . from corollary  [ uniqerghoriz ] , we know that @xmath153 projects to the lebesgue measure on @xmath385 .",
    "furthermore , by passing to a conull subset , we may assume @xmath250 has finite fibers over @xmath385 ( see  [ finfiboverxd ] ) .",
    "thus , it is easy to see that there exist @xmath411 , @xmath412 , and @xmath413 , such that @xmath414 , @xmath415 , and @xmath395 . then , in the notation of ( [ divnotn ] ) , with @xmath416 , and choosing @xmath417 appropriately , we have @xmath418 ( cf .",
    "pf .  of [ fibersonhoriz ] to see that @xmath419 )",
    ". we conclude , from proposition  [ divstab ] , that the identity component of @xmath420 is nontrivial . because the identity component of @xmath421 is trivial ( by definition of  @xmath235 ) , we conclude that @xmath422 contains a one - parameter subgroup that is not contained in  @xmath227 .",
    "any such subgroup is conjugate to  @xmath409 ( via an element of  @xmath227 ) .",
    "thus , by replacing @xmath153 with a translate under  @xmath227 , we may assume @xmath153 is @xmath409-invariant .",
    "@xmath233 is conull .    by passing to a quotient",
    ", we may assume @xmath423 .",
    "for each nonzero vector @xmath424 , let @xmath425 note that @xmath426 .",
    "suppose there is a subset  @xmath427 of positive measure in  @xmath87 , such that @xmath428 for @xmath429 .",
    "then the pointwise ergodic theorem implies , for a.e .",
    "@xmath430 , that we have @xmath431 for all  @xmath432 in a non - null subset  @xmath433 of  @xmath2 . furthermore , because @xmath153 is @xmath2-invariant , we may assume @xmath434 for all @xmath435 .",
    "therefore @xmath436 for all @xmath435 .",
    "this contradicts the fact that , because @xmath437 is countable whenever @xmath438 , we have @xmath439 for all but countably many choices of the line  @xmath440 .",
    "[ allinvvert ] there is a conull subset @xmath261 of  @xmath233 , such that @xmath441 for all @xmath442 .",
    "let @xmath261 be a generic set for for the action of  @xmath409 on  @xmath233 ; thus , @xmath261 is conull and , for each @xmath442 , @xmath443 given @xmath444 , such that @xmath445 with @xmath446 and @xmath447 , we wish to show @xmath448 .    choose a sequence @xmath449 , such that @xmath450 and @xmath451 each belong to  @xmath250 . because @xmath452 and @xmath453 is the foliation that is contracted by  @xmath454 , we know that @xmath455 .",
    "furthermore , because @xmath409 acts on the lie algebra of  @xmath456 with twice the weight that it acts on the lie algebra of  @xmath457 , we see that @xmath458 .",
    "thus , letting @xmath356 be within a constant multiple of @xmath459 , we see , in the notation of ( [ divnotn ] ) , with @xmath460 and @xmath461 , that @xmath462 , but @xmath463 . thus , proposition  [ divstab ] asserts that @xmath464 converges to a nontrivial element of @xmath465 . since @xmath466 is a scalar multiple of @xmath467 ,",
    "we conclude that @xmath468 .",
    "therefore @xmath469 , so @xmath448 .",
    "we require the following entropy estimate .",
    "[ entlem ] suppose @xmath172 is a closed connected subgroup of  @xmath453 that is normalized by  @xmath470 , and let @xmath471 be the jacobian of  @xmath472 on  @xmath172 .    1",
    ".   [ entlem - inv- > ] if @xmath153 is @xmath172-invariant , then @xmath473 .",
    "[ entlem - gmininw ] if there is a conull , borel subset  @xmath261 of @xmath89 , such that @xmath474 , for every @xmath442 , then @xmath475 .",
    "[ entlem - equal ] if the hypotheses of ( [ entlem - gmininw ] ) are satisfied , and equality holds in its conclusion , then @xmath153  is @xmath172-invariant .",
    "[ vyinvt ] @xmath153 is @xmath476-invariant .    from lemma  [ entlem]([entlem - inv- > ] ) , with @xmath472 in the role of  @xmath477 , we have @xmath478 from proposition  [ allinvvert ] and lemma  [ entlem]([entlem - gmininw ] ) , we have @xmath479 combining these two inequalities with the facts that    * @xmath480 and * @xmath481 ,    we have @xmath482 thus , we must have equality throughout , so the desired conclusion follows from lemma  [ entlem]([entlem - equal ] ) .",
    "@xmath153 is the lebesgue measure on a single orbit on @xmath142 of the pseudogroup @xmath483 .",
    "we know :    * @xmath2 preserves  @xmath153 ( by assumption ) , * @xmath235 preserves  @xmath153 ( by definition ) , * @xmath409 preserves  @xmath153 ( see  [ ainvt ] ) , and * @xmath476 preserves  @xmath153 ( see  [ vyinvt ] ) .",
    "therefore , @xmath153 is preserved by the pseudogroup @xmath484 generated by these maps .",
    "because    * this pseudogroup is transitive on the quotient @xmath485 , and * @xmath153 has finite fibers over @xmath485 ( see  [ finfiboverxd ] ) ,    this implies that some orbit of the pseudogroup has positive measure . by ergodicity of  @xmath2 , then this orbit is conull .    to obtain the conclusions of theorem  [ theorem : classification ] , we let @xmath238 . then @xmath153 is supported on the @xmath486-orbit of some point @xmath487 in  @xmath89 . note that , by choosing @xmath177 to be minimal , we can guarantee that whenever @xmath40 is a singular point of  @xmath27 , the subspace @xmath172 projects to  @xmath117 in the @xmath488 coordinate of  @xmath173 .",
    "therefore , the dimension of the orbit is equal to the dimension of the pseudosemigroup .",
    "for our application , we need the following analogue of ( * ? ? ? * cor .",
    "a(2 ) ) .",
    "[ prop : countable ] the set of subspaces @xmath172 occurring in theorem  [ theorem : classification ] is countable . for each such @xmath172 ,",
    "the set of closed orbits of @xmath489 is countable .",
    "[ lemma : ws : countable ] the set of @xmath87-invariant subspaces @xmath172 of @xmath173 such that there exists @xmath171 with @xmath490 closed is countable .",
    "let @xmath491 be the dimension of @xmath172 .",
    "after possibly renumbering the factors , we may assume that @xmath492 then if we denote elements of @xmath173 by @xmath493 where each @xmath494 , then @xmath172 is given by the following equations : for @xmath495 , @xmath496    recall that the linear holonomy map @xmath497 is given by @xmath498 , where @xmath499 is the holomorphic @xmath500-form that determines the flat structure on @xmath27 .",
    "let @xmath501 denote the image of @xmath502 , and let @xmath503 denote the set of real numbers @xmath504 such that there exist nonzero @xmath505 , @xmath506 with @xmath507 .",
    "then @xmath503 is clearly a countable set .",
    "we will show that each @xmath508 belongs to @xmath509 .",
    "let @xmath510 denote projection onto the first @xmath511 factors .",
    "note that the intersection of @xmath512 with each fiber of @xmath404 is finite .",
    "now pick @xmath244 , @xmath513 , and @xmath514 , @xmath495 .",
    "we may assume that @xmath515 .",
    "choose @xmath516 such that @xmath40 and @xmath517 are non - singular .",
    "let @xmath518 be any element of @xmath519 with @xmath520 .",
    "we represent @xmath518 by a piecewise linear closed curve on @xmath27 beginning and ending at @xmath40 and not passing through any singularities ; we will also denote this representative by @xmath518 .",
    "we obtain a closed curve @xmath521 by keeping @xmath522 fixed for @xmath523 , @xmath524 .",
    "because @xmath512 is a branched cover of @xmath525 , @xmath526 lifts to a closed curve @xmath527 in @xmath512 .",
    "let @xmath528 denote the projection of @xmath527 to the @xmath529 factor .",
    "we wish to calculate @xmath530 , so let us describe @xmath528 more precisely .",
    "the curve @xmath518 is a collection of segments connecting points @xmath531 , with @xmath532 , @xmath533 .",
    "then @xmath528 is a collection of segments connecting the points @xmath534 , with @xmath535 . by perturbing the @xmath536 ,",
    "we can make sure that @xmath528 is well defined and is not passing through any singularities .    by construction",
    ", the endpoint @xmath537 of @xmath528 belongs to the finite set @xmath538 . after replacing @xmath518 by an integer multiple",
    ", we may assume that @xmath528 is closed .",
    "but , in view of the explicit description of @xmath528 , @xmath539 , so @xmath540 .",
    "in the rest of this section we will abuse notation by writing @xmath541 for @xmath542 .",
    "[ lemma : periodic : countable ] let @xmath27 be a veech surface , and let @xmath61 be the veech group of @xmath27 .",
    "a point @xmath175 is called a periodic point if the @xmath61 orbit of @xmath175 is finite .",
    "then the set of periodic points is countable .    when @xmath27 is non - arithmetic , which is the only case that we need to discuss , it is proven in @xcite that the number of periodic points is countable ( in fact , _ finite _ ) .",
    "the following generalization of this statement also follows from the results of @xcite , but we include a short proof of as a warm up to the proof of proposition  [ prop : countable ] .",
    "it is clearly enough to show that for each @xmath543 , the set @xmath544 of points of period @xmath5 is countable . to do this",
    "it is enough to show that for each point @xmath545 , there exists a neighborhood @xmath2 of @xmath175 that does not contain any other points of @xmath544 .",
    "suppose the last statement is false .",
    "then there exists a sequence of points @xmath546 such that @xmath547 .",
    "we may assume after passing to a subsequence that the @xmath517 approach @xmath175 from some given direction @xmath134 ( i.e. that @xmath548 ) .",
    "let @xmath163 denote the intersection of all the index @xmath5 subgroups of @xmath61 . then , since @xmath61 is finitely generated , @xmath163 is of finite index in @xmath61 and for each @xmath549 , and all @xmath514 , @xmath550 .",
    "then each element of @xmath163 must fix @xmath134 .",
    "this contradicts the fact that @xmath163 , being a finite index subgroup of @xmath61 , is zariski dense in @xmath87 .",
    "it remains to prove the following assertion : let @xmath551 be an @xmath87-invariant subspace",
    ". then the set @xmath552 of closed orbits of @xmath553 is countable .",
    "we triangulate @xmath27 , with the vertices at the singular points .",
    "this yields a cell decomposition of @xmath91 in which the cells @xmath554 of maximal dimension are products of triangles .",
    "let @xmath555 denote the interior of @xmath556 , and let @xmath190 denote the union of the @xmath555 .",
    "for @xmath171 , let @xmath557 denote the distance between @xmath175 and the complement of @xmath190 ( i.e. the distance to the boundary of the cell containing @xmath175 ) .",
    "let @xmath558 , and let @xmath559 be any @xmath87-invariant complement to @xmath172 .",
    "we may assume that @xmath172 is given by the equations ( [ eq : w ] ) .",
    "in view of lemma  [ lemma : periodic : countable ] we may also also assume that @xmath172 has dense projection onto any of the @xmath42 factors ( i.e. for a fixed @xmath514 , not all @xmath508 are @xmath117 ) .",
    "then , for any @xmath560 , @xmath561 is dense in @xmath512 .",
    "let @xmath562 be an @xmath563-tuple of non - negative integers , and let @xmath564 denote the set of of @xmath560 such that @xmath565 has exactly @xmath566 connected components",
    ".    now suppose @xmath552 is uncountable .",
    "then there exist @xmath562 such that @xmath564 is uncountable . then by compactness , there exist @xmath512 in @xmath564 such that for every @xmath567 there exists @xmath568 such that the hausdorff distance between @xmath512 and @xmath569 is less then @xmath355 . let @xmath570 be the minimum over @xmath244 of the minimal distance between connected components of @xmath565 .",
    "let @xmath571 , and number all the connected components of the intersection of @xmath512 with the interiors of the cells as @xmath572 , @xmath573 .",
    "let @xmath574 denote the generators of @xmath61 .",
    "we may choose a point @xmath40 in each @xmath572 such that for all @xmath514 , @xmath575 , @xmath576 is in the interior of some component @xmath577 , where @xmath578 depends on @xmath244 and @xmath514 .",
    "let @xmath579 .",
    "now choose @xmath252 so that :    * @xmath580 .",
    "* for any @xmath244 , @xmath581 , we have @xmath582 . * for each @xmath244 , @xmath581 and each @xmath514 , @xmath583 , we have @xmath584",
    ".    now choose @xmath585 so that the hausdorff distance between @xmath569 and @xmath512 is less then @xmath355 .",
    "note that if @xmath586 with @xmath587 there exists a unique @xmath588 , such that @xmath589 and @xmath590 .",
    "also @xmath591 does not depend on the choice of @xmath592 , and @xmath593 .",
    "furthermore @xmath594 since @xmath512 and @xmath569 can not share a point in @xmath190 .",
    "let @xmath456 denote the finite set @xmath595 .",
    "we now claim that each generator @xmath596 preserves the set @xmath456 .",
    "indeed consider the points @xmath597 and @xmath598 .",
    "since both @xmath512 and @xmath569 are @xmath61-invariant , we must have @xmath599 and @xmath600 . by construction , @xmath601 , and @xmath602 .",
    "recall that @xmath603 is the only vector in @xmath559 of norm at most @xmath604 such that @xmath605 .",
    "but @xmath606 , and @xmath607 .",
    "also @xmath608 , since @xmath559 is @xmath87-invariant .",
    "thus @xmath609 .",
    "we have proved that for each generator @xmath596 , we have @xmath610 .",
    "this immediately implies that @xmath611 .",
    "then a finite index subgroup of @xmath61 will fix a single vector in @xmath456 , which contradicts the fact that @xmath61 is zariski dense in @xmath87 .",
    "let @xmath612 denote the haar measure on @xmath613 .",
    "for @xmath614 and @xmath123 , let @xmath615 where @xmath616 is the atomic probability measure supported at @xmath617 , and @xmath618 .",
    "then each @xmath619 is a probability measure on @xmath89 .",
    "we can think of @xmath619 as the measure supported on a circle of radius @xmath116 inside the @xmath87-orbit through @xmath617 . in this section",
    "we prove the following theorem :    [ theorem : largecircles ] suppose @xmath620 .",
    "then there exists a @xmath87-invariant subspace  @xmath172 of @xmath173 such that    1 .",
    "the @xmath621 orbit through @xmath617 is closed , and 2 .",
    "@xmath622 , where @xmath153 is lebesgue measure on this orbit .",
    "[ remark : largecircles ] if @xmath623 , then @xmath153 is the lebesgue measure on  @xmath89 .",
    "[ lemma : circles : unipotent ] suppose @xmath624 .",
    "then there is a subsequence @xmath625 such that the measures @xmath626 converge to a probability measure @xmath627 that is invariant under the unipotent element @xmath628 of @xmath87 .",
    "it follows from ( * ? ? ?",
    "* corollary  5.3 ) that there is a subsequence @xmath625 such that the measures @xmath626 converge to a probability measure @xmath627 .",
    "we can find @xmath629 such that @xmath630 converges to @xmath432 .",
    "( recall that @xmath631 is the @xmath632 matrix representing rotation by @xmath633 ) .",
    "now the measures @xmath634 are @xmath630 invariant , hence @xmath627 is @xmath432 invariant .",
    "assume @xmath627 is not the lebesgue measure on  @xmath89 .",
    "note that we do not know at this point whether @xmath627 is ergodic .",
    "however , standard results ( using @xmath432-invariance ) imply that @xmath627 projects to lebesgue measure in @xmath154 .    for convenience ,",
    "if @xmath635 and @xmath636 , let @xmath637    by theorem  [ theorem : classification ] , and by proposition  [ prop : countable ] , there exists a @xmath87-invariant proper subspace  @xmath172 of  @xmath173 and an orbit @xmath512 of @xmath621 , such that @xmath638 we will show that this implies that @xmath639 . in that case , the entire @xmath87-orbit of @xmath617 lies in @xmath512 , so @xmath640 .",
    "furthermore , we show that as long as @xmath172 was chosen as small as possible , @xmath627 must be lebesgue measure on @xmath512 .      we choose @xmath172 to be of minimal dimension . from the structure of the @xmath87-invariant subspaces on @xmath173",
    ", we see that @xmath641 , @xmath642 , and after renumbering the factors , we can make sure that @xmath643 thus , @xmath644 is complementary to @xmath172 , and @xmath645 is complementary to @xmath646 in  @xmath227 .",
    "[ lemma : support : in : interval ] there exists @xmath252 and a box @xmath647 \\times \\dots \\times [ \\alpha_k , \\beta_k ] \\subset \\operatorname{horiz}\\ ] ] such that @xmath648 .",
    "let @xmath649 be the ( unique ) orbit of @xmath650 that is open and dense in  @xmath512 .",
    "( in other words , @xmath649 consists of the elements in  @xmath512 of which as few coordinates as possible are singular points . ) note that @xmath651 by the minimality of @xmath177 , we see that @xmath652 .",
    "hence @xmath653 . by combining this with ( [ lemma : support : in : intervalpf - winvt ] ) and the fact that @xmath654 , we conclude that there is a box @xmath655 , such that @xmath656 .",
    "since @xmath657 , then @xmath658 , as desired .    as in the previous sections ,",
    "let @xmath659 be the natural projection onto the first @xmath511 coordinates . for @xmath660 ,",
    "we let @xmath661 .",
    "note that @xmath662 is a finite set .",
    "we claim that @xmath663 to see this , note that , because @xmath172 is a proper subspace of @xmath173 , we have @xmath664 . hence , by induction on  @xmath96 , we may assume there is a @xmath87-invariant subspace  @xmath665 of  @xmath666 , such that the projection of  @xmath627 to  @xmath385 is the lebesgue measure on the @xmath667 orbit  @xmath668 through @xmath669 .",
    "then @xmath670 is conull for  @xmath627 , so @xmath671 from the minimality of @xmath177 , we conclude that @xmath672 .",
    "therefore @xmath673 , which establishes the claim .",
    "[ assumexnotino ] we may assume @xmath674 .",
    "( otherwise , from the fact that @xmath512 is a branched cover of  @xmath385 ( and lemma  [ fincovclassify ] below ) , we would immediately conclude that @xmath627 is the lebesgue measure on  @xmath512 , as desired . )",
    "this will lead to a contradiction .      for @xmath675 ,",
    "@xmath676 let @xmath677    [ lemma : trig : polynomial ] suppose @xmath678 , where @xmath679 is as defined in lemma  [ lemma : support : in : interval ] .",
    "suppose also that @xmath249 , @xmath680 , @xmath681 , and @xmath682 .",
    "then there exists @xmath683 depending only on @xmath684 such that for any @xmath685 and any @xmath686 with @xmath687 we have @xmath688 where @xmath689 .",
    "if we write @xmath690 , with @xmath494 , and also write @xmath691 then the condition ( [ eq : far : from : hor ] ) implies that there exists at least one @xmath514 , @xmath692 with @xmath693 .",
    "the rest of the argument will take place in the @xmath529 factor ( see figure  [ fig : boxes ] ) .",
    "we note that the components of the map @xmath694 are trigonometric polynomials of degree @xmath500 .",
    "in other words , the path @xmath695 parametrizes an ellipse .",
    "let @xmath696 .",
    "then if @xmath685 and @xmath697 then @xmath698 . thus , the ellipse @xmath695 leaves @xmath699 .",
    "then in view of the dimensions of the boxes , the portion of the ellipse in @xmath700 is at most @xmath701 times the portion of the ellipse in @xmath699 .",
    "[ lemma : neighborhoods ] for any @xmath702 , there exists @xmath703 and a compact subset @xmath427 of @xmath385 with @xmath704 , such that    1",
    ".   @xmath705 does not contain any singular points , other than perhaps points in  @xmath512 , and 2 .",
    "[ lemma : neighborhoods - unique ] for each @xmath706 , there is a unique @xmath707 , such that @xmath708 .    for @xmath660 ,",
    "let @xmath709 be the surface corresponding to  @xmath29 ( so we may write @xmath710 as @xmath711 ) . let @xmath712 denote the singular set of @xmath709 .",
    "for any @xmath702 on the fixed surface @xmath709 , there exist only finitely many horizontal trajectories of length at most @xmath713 connecting points of @xmath714 to points of @xmath714 .",
    "therefore we can find a large compact subset @xmath427 of @xmath385 such that for any @xmath715 , @xmath709 has no horizontal trajectories of length at most @xmath716 connecting points of @xmath714 to other points of @xmath714 . since @xmath627 projects to lebesgue measure on @xmath385 ( see  [ projtolebonxd ] ) , we may choose @xmath427 so that @xmath717 .",
    "now we can choose @xmath703 by compactness .",
    "note that , because @xmath718 , we have @xmath719 . therefore @xmath720 .      because @xmath721 ( see  [ assumexnotino ] ) , we may choose @xmath249 so that @xmath722 .",
    "we may also assume that on the surface corresponding to  @xmath617 , the distance between any two singular points is at least @xmath723 .",
    "let @xmath679 , @xmath724 $ ] and @xmath355 be as in lemma  [ lemma : support : in : interval ] .",
    "choose @xmath725 so that for all @xmath726 , we have @xmath724 \\subset [ -l_1 , l_1]$ ] .",
    "let @xmath727 . now choose @xmath728 and @xmath703 so that lemma  [ lemma : neighborhoods ] holds . finally , choose @xmath729 .",
    "assume @xmath730 .",
    "we will abuse notation by writing @xmath541 for @xmath731 .",
    "we claim that if @xmath732 , with @xmath733 , then ( [ eq : far : from : hor ] ) holds .",
    "indeed , we have then @xmath734 so @xmath735 also , @xmath736 therefore @xmath737    now let @xmath738 suppose @xmath739 .",
    "let @xmath740 be the unique element of @xmath741 with @xmath742 , and let @xmath743 note that @xmath744 , so we may let @xmath745 be the component of  @xmath746 that contains  @xmath633 . by ( the proof of ) lemma  [ lemma : trig : polynomial ] , @xmath747 .",
    "we claim that if @xmath748 , then @xmath749 is disjoint from  @xmath750 . to see this , note that if @xmath751 , then there exist @xmath752 , such that , letting @xmath753 we have @xmath754 and @xmath755 now if @xmath748 , then @xmath756 , so @xmath757 . lemma  [ lemma : neighborhoods]([lemma : neighborhoods - unique ] ) therefore implies that @xmath758 , so @xmath759 .",
    "since each point of @xmath760 is contained in a unique interval , the circle is covered at most twice by the intervals @xmath745 .",
    "it follows that @xmath761 .",
    "equivalently , this means that @xmath762 since this holds for all sufficiently large @xmath116 , we get @xmath763 since @xmath627 projects to lebesgue measure , we know that @xmath764 . hence @xmath765 .",
    "this contradicts lemma  [ lemma : support : in : interval ] .",
    "[ corollary : gorbit ] suppose @xmath620 .",
    "then there exists a @xmath87-invariant subspace  @xmath172 of @xmath173 , such that the closure of @xmath766 is @xmath767 .",
    "let @xmath172 be as in the conclusion of theorem  [ theorem : largecircles ] .",
    "because @xmath768 is closed and @xmath87-invariant , it contains the closure of @xmath766 . on the other hand ,",
    "the support of @xmath619 is a subset of @xmath766 , so @xmath766 is dense in the support of @xmath769 ; that is , @xmath766 is dense in @xmath770 .",
    "corollary  [ corollary : gammaorbit ] ( stated at the end of   [ measclasssect ] ) follows from ( [ corollary : gorbit ] ) by a standard argument ( inducing the action of @xmath61 to an action of",
    "@xmath87 ) .",
    "we now give the general setup for the counting problems we are considering . for additional background and more detailed definitions , see the introduction to @xcite .",
    "[ notation : counting ]    * let @xmath16 be a translation surface .",
    "a _ saddle connection _ on @xmath16 is a straight line segment connecting two singularities .",
    "since a saddle connection has a well defined length and direction , each saddle connection is associated with a non - zero vector in @xmath42 .",
    "let @xmath771 denote the set of vectors in @xmath42 that are associated to saddle connections in @xmath16 .",
    "_ regular _ closed geodesic on @xmath16 , we mean a closed geodesic that does not pass through singularities . * as mentioned in the introduction , any regular closed geodesic is part of a family of freely homotopic parallel closed geodesics of the same length .",
    "such a family is called a _",
    "cylinder_. all the geodesics comprising a cylinder have the same length and direction ; thus we can associate to a cylinder a non - zero vector in @xmath42 .",
    "note that each boundary component of a cylinder is a union of saddle connections .",
    "let @xmath772 denote the set ( with multiplicity ) of vectors in @xmath42 that are associated to cylinders in @xmath16 .",
    "in particular , if @xmath16 is a standard torus , then @xmath773 is the set of primitive vectors in @xmath774 . * for any @xmath775 , let @xmath776 denote the ball in  @xmath42 of radius  @xmath10 centered at  @xmath117 .",
    "* let @xmath777 be a subset of @xmath778 with multiplicity ; i.e. a set of vectors with positive weights .",
    "the weights are usually positive integers ( e.g. , we may consider saddle connections with multiplicity ) , but need not be ( e.g. , we may weight each cylinder by the reciprocal of its area ) . *",
    "let @xmath779 denote the cardinality ( with weights ) of @xmath780 .",
    "we are interested in the asymptotics of @xmath779 as @xmath15 .",
    "if @xmath781 , we will denote @xmath779 by @xmath782 , and if @xmath783 then , as in the introduction , we will denote @xmath779 simply by @xmath41 .",
    "* recall from the introduction that @xmath71 denotes a _ stratum _ of translation surfaces .",
    "* let @xmath784 denote the subset of @xmath71 consisting of the surfaces of area @xmath500 ( where area is taken using the associated translation metric ) .",
    "* as in  [ avgcirclesect ] , let @xmath612 denote the haar measure on @xmath785 . * for @xmath786 and @xmath123 , let @xmath787 where @xmath788 is the atomic probability measure supported at @xmath16 , and @xmath618 .",
    "then @xmath789 is a probability measure on @xmath784 . *",
    "finally , for a bounded compactly supported function @xmath790 , let @xmath791 the function @xmath792 is called the _ siegel - veech _ transform of @xmath793 .",
    "we now summarize the relevant results from @xcite , @xcite and @xcite that will be used in  [ tribillsect ] .",
    "[ theorem : counting : ems : em ] let @xmath794 be a translation surface , and suppose the following hold ( using notation  [ notation : counting ] ) :    1 .",
    "[ ( a ) ] @xmath795 varies linearly under the @xmath0 action ; i.e. , for all @xmath796 and all @xmath797 , we have @xmath798 .",
    "[ ( b ) ] there exists a constant @xmath370 , such that for all @xmath799 , we have @xmath800 .",
    "[ ( c ) ] as @xmath801 , the measures @xmath789 converge to an @xmath0-invariant ( probability ) measure @xmath153 .",
    "[ ( d ) ] let @xmath802 denote the characteristic function of the trapezoid whose vertices are at @xmath803 , @xmath804 , @xmath805 and @xmath806 .",
    "let @xmath807 denote the closure of the @xmath0 orbit of @xmath16 .",
    "then for any @xmath252 and any compact subset @xmath253 of @xmath784 , there exist continuous functions @xmath808 and @xmath809 such that for all @xmath810 , we have @xmath811    then , the following hold :    1 .   [",
    "( i ) ] there exists a constant @xmath812 , such that as @xmath813 , @xmath814 2 .",
    "[ ( ii ) ] we have the siegel - veech formula : there exists a constant @xmath815 such that for any continuous compactly supported @xmath816 , @xmath817 3 .   [ ( iii ) ] the constant @xmath815 in ( [ ( i ) ] ) is the same as the constant @xmath815 in ( [ ( ii ) ] ) .    conclusion  ( [ ( ii ) ] ) depends only on assumptions  ( [ ( a ) ] ) and ( some version of )  ( [ ( b ) ] ) .",
    "it was proved by w. veech in @xcite , where this approach to counting on translation surfaces was originated .",
    "the proof is reproduced in ( * ? ? ? * theorem 2.2 ) .",
    "assumption ( [ ( b ) ] ) may be replaced by :    1 .   [ ( b ) ] there exist constants @xmath818 and @xmath819 such that for all @xmath794 , @xmath820 , where @xmath821 is the length of the shortest saddle connection on @xmath16 .",
    "in fact , ( [ ( b ) ] ) is used in the proof of theorem  [ theorem : counting : ems : em ] instead of ( [ ( b ) ] ) .",
    "the assertion that ( [ ( b ) ] ) implies ( [ ( b ) ] ) follows from ( * ? ? ?",
    "* theorem 5.1 ) .",
    "it follows from ( [ ( b ) ] ) and ( * ? ? ?",
    "* theorem 5.2 ) that any limit measure of the probability measures @xmath789 must be a probability measure ( see ( * ? ? ?",
    "* corollary  5.3 ) ) .",
    "thus , the measure @xmath153 of ( [ ( c ) ] ) is automatically a probability measure .",
    "the assertion ( [ ( d ) ] ) is a technical assumption needed since the siegel - veech transform @xmath822 may not be continuous even if @xmath793 is .",
    "let @xmath157 be the characteristic function of the trapezoid as in ( [ ( d ) ] ) .",
    "we have the following lemma from calculus ( cf .",
    "* lemma 3.4 ) ) : for any @xmath113 , @xmath823 if we multiply both sides of ( [ eq : calculus ] ) by @xmath824 and sum over all @xmath825 , we get , under assumption ( [ ( a ) ] ) , @xmath826 or equivalently , @xmath827 ( the fact that we only have approximate equality and not equality in ( [ eq : count : integral ] ) does not affect the asymptotics . see @xcite for the details ) .",
    "the assumption ( [ ( c ) ] ) means that for any bounded continuous function @xmath828 on @xmath784 , @xmath829 we would like to apply ( [ eq : circles : bounded : func ] ) to @xmath830 , which is neither bounded nor continuous . the fact that @xmath830 is not continuous",
    "is handled by assumption ( [ ( d ) ] ) .",
    "to handle the fact that @xmath830 is not bounded , we decompose @xmath831 , where @xmath832 is bounded and @xmath833 is supported outside of a large compact set . then the contribution of @xmath833 can be shown to be negligible using ( * ? ?",
    "* theorem 5.2 ) , in view of assumption ( [ ( b ) ] ) .",
    "the details of this argument are given in @xcite .",
    "now applying ( [ eq : circles : bounded : func ] ) with @xmath834 and substituting into ( [ eq : count : integral ] ) , we get @xmath835 by iterating ( replacing @xmath10 with @xmath836 ) , and summing the resulting geometric series , we get @xmath837 this implies ( [ ( i ) ] ) .",
    "now by ( [ eq : siegel : veech : general ] ) , @xmath838 this , together with ( [ eq : temp : asymp ] ) , implies ( [ ( iii ) ] ) .    as a corollary of theorem  [ theorem : counting : ems : em ] and theorem  [ theorem : largecircles ] we have the following :    [ theorem : branched : cover : count ] suppose @xmath16 is a branched cover of a veech surface @xmath27 .",
    "let @xmath41 denote the number of cylinders of periodic trajectories in @xmath16 of length at most @xmath10 .",
    "then there exists a constant @xmath51 such that as @xmath15 , @xmath839    we use theorem  [ theorem : counting : ems : em ] , with @xmath840 .",
    "assumption ( [ ( a ) ] ) clearly holds , and ( [ ( b ) ] ) also holds since the boundary of every cylinder contains a saddle connection .",
    "now let @xmath841 be the connected component of @xmath72 that contains  @xmath16 ( where @xmath72 is as in the introduction ) .",
    "since @xmath842 and @xmath841 is closed and @xmath0-invariant , the support of any of the measures @xmath789 is contained in @xmath841 . also , since @xmath841 is a branched cover of the space @xmath89 , a measure classification theorem on @xmath89 automatically yields a measure classification theorem on @xmath841 ( see lemma  [ fincovclassify ] below ) . thus assumption ( [ ( c ) ] ) of theorem  [ theorem :",
    "counting : ems : em ] follows from theorem  [ theorem : largecircles ] .    finally",
    ", in our setting ( [ ( d ) ] ) is automatically satisfied , since the orbit closure @xmath807 is a proper submanifold of @xmath784 , the measure @xmath153 is lebesgue measure on @xmath807 , and ( after intersecting with any compact set ) the set of discontinuities of @xmath830 is contained in a finite union of submanifolds of positive codimension in @xmath807 . thus theorem  [ theorem : branched : cover : count ] follows from ( [ ( i ) ] ) of theorem  [ theorem : counting : ems : em ] .",
    "[ fincovclassify ] suppose @xmath172 is a @xmath87-invariant subspace of  @xmath173 , @xmath512  is a closed orbit of @xmath239 in  @xmath89 , and @xmath807 is a ( connected ) branched cover of  @xmath512 , such that the action of  @xmath87 on  @xmath512 lifts to  @xmath807 .    if @xmath160 is any @xmath432-invariant probability measure on  @xmath807 that projects to the lebesgue measure on  @xmath512 , then @xmath160 is the lebesgue measure on  @xmath807 .",
    "let @xmath153 and @xmath843 be the lebesgue measures on @xmath512 and @xmath807 , respectively . then , because it projects to  @xmath153 , the measure @xmath160 must be absolutely continuous with respect to  @xmath843 ; thus , we may write @xmath844 , for some borel function  @xmath793 on  @xmath807 .",
    "it is not difficult to see that @xmath843 is ergodic for  @xmath87 , so ( by decay of matrix coefficients ( * ? ? ?",
    "* thm .  2.4.2 ,",
    "p.  29 ) , or by the the mautner phenomenon ( * ? ?",
    "2.2.15 , p.  21 ) ) it is ergodic for  @xmath432 .",
    "this implies that @xmath793  is constant .",
    "so @xmath845 ( up to a normalizing scalar multiple ) .",
    "let @xmath4 be an odd integer . as in the introduction , let @xmath846 and let @xmath83 denote the corresponding translation surface . in the rest of this section , we complete the proof of theorem  [ theorem : triangle : count ] by computing the constant @xmath815 in theorem  [ theorem : branched : cover : count ] for the case of the surface @xmath83 .",
    "our general strategy is to use ( [ ( ii ) ] ) and ( [ ( iii ) ] ) of theorem  [ theorem : counting : ems : em ] . to pass from  @xmath83 to  @xmath80 ,",
    "note that @xmath847 , and since @xmath83 consists of @xmath848 triangles , @xmath849 .",
    "the surface @xmath83 can be drawn as in figure  [ fig : pentagons ] .",
    "as shown in @xcite and as one can see from the figure , @xmath83 is a double cover of a surface @xmath850 consisting of a double @xmath5-gon with opposite sides identified . the surface @xmath850 is a veech surface ( see @xcite ) , but @xmath83 is not ( see @xcite ) .",
    "most of the information in this section comes from @xcite .",
    "let @xmath851 ( realized with the two equal sides having length @xmath500 , and one of the equal sides horizontal ) .",
    "then the surface corresponding to @xmath852 can easily be seen to be ( isomorphic to ) @xmath850 .",
    "the cylinder decomposition in the vertical direction consists of @xmath853 cylinders @xmath854 , and for @xmath855 , we have : @xmath856 ( the closed trajectories in the cylinder @xmath854 have length @xmath857 ) . since for all @xmath855 , @xmath858",
    ", the unipotent @xmath859 belongs to the veech group @xmath860 of @xmath850 . note that @xmath861 the unipotent @xmath862 , together with the rotation by @xmath3 generate @xmath860 .",
    "it is shown in @xcite that @xmath863 where @xmath864 denotes the poincar volume on the hyperbolic plane @xmath865 .",
    "the following lemma is from @xcite :    [ lemma : gj ] suppose @xmath866 is a lattice , and suppose that @xmath61 intersects non - trivially the stabilizer @xmath867 in @xmath0 of @xmath740 .",
    "( the above condition is equivalent to the discreteness of the orbit @xmath868 . )",
    "let @xmath869 be either of the two generators of @xmath870 .",
    "let @xmath776 denote the ball in @xmath42 of radius @xmath10 centered at the origin .",
    "then , as @xmath871 , @xmath872 where @xmath873 is any vector perpendicular to @xmath740",
    ".    we also record the following trivial consequence ( of the existence of the asymptotics ) :    suppose @xmath740 is as in lemma  [ lemma : gj ] , and suppose @xmath874 is a scalar multiple of @xmath740 . then , as @xmath15 .",
    "@xmath875    we now apply lemma  [ lemma : gj ] with @xmath876 , @xmath877 , @xmath878 , @xmath879 , and using ( [ eq : move : perp ] ) we get that the number of cylinders in the ball of radius @xmath10 that are in the orbit of the cylinder @xmath880 is asymptotic to @xmath881 we now use ( [ eq : trivial ] ) to see that for @xmath855 , the number of cylinders in the ball of radius @xmath10 that are in the @xmath860 orbit of @xmath854 is asymptotic to @xmath882 ( in the above , we used the identity @xmath883 ) . since every cylinder is in the orbit of some @xmath854 , we get ( after summing over @xmath514 ) , @xmath884 using the identity ( * ? ? ?",
    "* lemma 6.3 ) @xmath885 and using the expressions ( [ eq : heights : widths ] ) , we get @xmath886 since @xmath887 we have @xmath888 this is the formula in @xcite .",
    "it is useful for the sequel to compare the result of ( [ eq : count : j : one : orbit ] ) with the result of the corresponding siegel - veech formula .",
    "let @xmath889 denote the orbit of @xmath850 .",
    "this is a closed submanifold of the stratum , which is also called a teichmller curve . for @xmath855 , define @xmath890 by the formula @xmath891 ( where @xmath796 ) .",
    "let @xmath892 denote the characteristic function of the @xmath355-ball in @xmath42 centered at the origin , and for @xmath893 , define the siegel - veech transform @xmath894 .",
    "[ lemma : disjoint : cusps ] if @xmath355 is sufficiently small , then @xmath895 takes on only the values @xmath117 and @xmath500 ; we have @xmath896 if and only if @xmath27 has a cylinder decomposition such that the @xmath529 cylinder from the left has height at most  @xmath355 . given @xmath27 ,",
    "such a cylinder decomposition is unique if it exists .",
    "this is straightforward .",
    "( the uniqueness of the decomposition follows from the fact , proved by veech @xcite , that @xmath897 has only one cusp . )",
    "let @xmath160 denote the normalized @xmath0 invariant measure on @xmath898 .",
    "then , we have the siegel - veech formula : @xmath899 we now apply theorem  [ theorem : counting : ems : em ] with @xmath900 , and @xmath901 . the validity of assumption ( [ ( c ) ] ) can be deduced from the mixing property of the geodesic flow , see @xcite for a general proof in variable negative curvature , or @xcite for a simplified exposition in the constant curvature case .",
    "we obtain that @xmath902 where @xmath903 is as in ( [ eq : xn : v1:siegel : veech ] ) . comparing with ( [ eq : count : j : one : orbit ] ) , we see that @xmath904 substituting into ( [ eq : xn : v1:siegel : veech ] ) we get @xmath905    it is possible to prove ( [ eq : measure : small : v1 ] ) directly , and thus to compute the asymptotics in ( [ eq : count : one : orbit ] ) without using lemma  [ lemma : gj ] .",
    "we chose this indirect derivation of ( [ eq : measure : small : v1 ] ) to minimize the amount of computation .",
    "we now return to our surface @xmath83 , which is a branched cover of @xmath850 ( see figure  [ fig : pentagons ] ) .",
    "@xmath850 is a union of two @xmath5-gons , and the two branch points @xmath175 and @xmath906 are at the centers of the @xmath5-gons .",
    "we now wish to apply theorem  [ theorem : largecircles ] to the point @xmath907 .",
    "it is important to note that @xmath850 is hyperelliptic , and that our two branch points are interchanged by the hyperelliptic involution .",
    "since the hyperelliptic involution commutes with the @xmath0 action , this it true for any point in the orbit of @xmath908 .",
    "thus , the @xmath0 orbit of @xmath908 is _ not _ dense in the space @xmath909 , and indeed we have in theorem  [ theorem : largecircles ] a proper @xmath910 of real dimension @xmath62 .",
    "let @xmath713 denote the subspace @xmath911 .",
    "the above argument shows that @xmath912 .",
    "but since we know that @xmath83 is not veech , @xmath913",
    ". hence @xmath914 and @xmath915 .",
    "let @xmath916 .",
    "then @xmath917 consists of points of the form @xmath918 where @xmath893 , @xmath919 , @xmath920 and @xmath592 and @xmath921 are interchanged by the hyperelliptic involution of @xmath27 . by theorem  [ theorem : largecircles ] ,",
    "@xmath922 where @xmath153 is lebesgue measure on @xmath512 .",
    "now let @xmath923 denote the orbit closure @xmath924 . since @xmath83 is a double cover of @xmath850 , branched over @xmath175 and @xmath906 , for any @xmath796",
    ", @xmath925 is a double cover of @xmath926 branched over @xmath927 and @xmath928 , and @xmath929 .",
    "thus , in particular , every surface in @xmath923 is a double cover of a surface in @xmath898 .",
    "thus we have a natural map @xmath930 that maps each surface @xmath931 to the surface in @xmath898 of which it is a double cover , and notes the locations of the branch points . now in view of ( [ eq : marked : points ] ) and lemma  [ fincovclassify ] , @xmath932 where @xmath933 is normalized lebesgue measure on @xmath923 .",
    "hence , by theorem  [ theorem : counting : ems : em ] , we have a quadratic asymptotic formula @xmath934 with the constant @xmath815 given by @xmath935 where as above , @xmath936 is the characteristic function of the ball of radius @xmath355 centered at the origin , and @xmath937 .",
    "let @xmath740 be some periodic direction for @xmath83 , hence for @xmath850 .",
    "we may use an element @xmath518 of the veech group @xmath860 of @xmath850 to map @xmath740 to the vertical direction . note that @xmath938 is a double cover of @xmath939 . in the vertical direction",
    ", @xmath850 has the cylinder decomposition @xmath940 described above .",
    "[ lemma : cyl : decomp ] for any @xmath941 , the branch points of @xmath938 will project to two points in the same cylinder , say @xmath942 .",
    "the cylinder decomposition of @xmath938 in the vertical direction is the following :    1 .",
    "[ lemma : cyl : decomp - nobranch ] for each @xmath943 , there are two cylinders on @xmath938 of the same length as @xmath854 ( one on each `` sheet '' ) .",
    "[ lemma : cyl : decomp - branch ] on @xmath938 there are two cylinders of the same length as @xmath942 and two cylinders of twice the length of @xmath942 .    the fact that both branch points project to the same cylinder of @xmath850 follows from the fact that each cylinder of @xmath850 is preserved by the hyperelliptic involution @xmath944 of @xmath850 ( since different cylinders have different lengths ) and the fact that the branch points are interchanged by @xmath944 . from figure",
    "[ fig : pentagons ] , the cover @xmath83 is determined by two slits ( drawn as the thick lines in the figure ) , which are interchanged by @xmath944 . since @xmath944 commutes with the @xmath0 action , the cover @xmath938 of @xmath850 is also determined by two slits , which are interchanged by @xmath944 . for each cylinder @xmath854 of @xmath850 , let @xmath945 denote the closed trajectory in the center of @xmath854 .",
    "note that for any @xmath514 , @xmath945 is mapped to itself under @xmath944 .",
    "also , since @xmath944 exchanges the slits , we see that @xmath945 intersects each slit the same number of times .",
    "thus , @xmath945 breaks up into two closed paths of the same length when lifted from @xmath850 to @xmath938 .",
    "this proves ( [ lemma : cyl : decomp - nobranch ] ) and the first assertion of ( [ lemma : cyl : decomp - branch ] ) .",
    "it is easy to see that the closed vertical trajectories on @xmath942 between the boundary of @xmath942 and one of the branch points double in length when lifted from @xmath850 to @xmath938 .",
    "this proves the second assertion of ( [ lemma : cyl : decomp - branch ] ) .",
    "[ cor : descent ] the function @xmath946 is constant on the fibers of @xmath947 ( a.e . ) , and thus descends to a function @xmath948 . the latter function , for @xmath355 sufficiently small , is given ( a.e . ) by the formula @xmath949 where for @xmath855 , @xmath950 is as in lemma  [ lemma : disjoint : cusps ] , and @xmath96 is such that @xmath592 ( and @xmath921 ) belong to the @xmath951 cylinder from the left in the unique cylinder decomposition that contains a cylinder of height at most @xmath355 .",
    "choose a fundamental domain for  @xmath860 in the upper half plane .",
    "since @xmath850 has a vertical cylinder decomposition , we may assume that the cusp of the fundamental domain approaches  @xmath952 , rather than approaching a point on the real axis .",
    "this means that as @xmath157 goes to infinity in the fundamental domain , the unique short cylinder decomposition of @xmath953 is the image under  @xmath157 of the vertical cylinder decomposition of  @xmath850 .",
    "we first prove that ( [ cor : descent : eqn ] ) is correct for all @xmath27 in the @xmath0 orbit of  @xmath83 . to do this , let @xmath796 , and write @xmath954 ,",
    "where @xmath941 , and @xmath157 is in the fundamental domain .",
    "note that @xmath955 is zero unless @xmath27 has a short cylinder .",
    "thus , if @xmath954 , and @xmath157 is in a compact part of the fundamental domain , then ( in view of lemma  [ lemma : cyl : decomp ] ) , we have @xmath956 . therefore , we may assume that @xmath157 is in the cusp , and hence the unique short cylinder decomposition of @xmath957 is the image , under the linear action of  @xmath157 , of the vertical cylinder decomposition of @xmath938 .",
    "then it is clear from lemma  [ lemma : cyl : decomp ] that ( [ cor : descent : eqn ] ) holds for @xmath958 .    to complete the proof , note that both sides of ( [ cor : descent : eqn ] ) are continuous off a closed set of measure  @xmath117 , namely , the set where a branch point projects to an edge of a cylinder ( in a cylinder decomposition containing a cylinder of height at most  @xmath355 ) .",
    "then use the fact that the @xmath0 orbit of  @xmath83 is dense .",
    "the analogue of the first assertion of corollary  [ cor : descent ] fails in the context of @xcite , in part since there we are dealing with covers of high degree .",
    "this is responsible for most of the combinatorial complexity of the argument in @xcite .    in view of corollary  [ cor :",
    "descent ] , ( [ eq : c : tilde : o ] ) becomes @xmath959 where @xmath960 is lebesgue measure on the translation surface @xmath27 , and @xmath944 denotes the hyperelliptic involution . performing the integral over @xmath27 , we get @xmath961 where @xmath962 and @xmath963 ( so that @xmath964 denotes the relative area of the @xmath951 cylinder from the left in any cylinder decomposition ) .",
    "now , using ( [ eq : measure : small : v1 ] ) , we get @xmath965 since the second term in the parenthesis is independent of @xmath96 , and @xmath966 , this can be rewritten as @xmath967 the first term in the parenthesis is in view of ( [ eq : count : veech : prelim ] ) twice the limit of @xmath968 .",
    "the second term in the parenthesis is , since @xmath969 , equal to @xmath970 in view of ( [ eq : count : veech : final ] ) , we get @xmath971 simplifying , we get @xmath972 alternatively , @xmath973 to pass from  @xmath83 to  @xmath80 , note that @xmath847 , and since @xmath83 consists of @xmath848 triangles , @xmath849 .",
    "this research was partially supported by grants from the national science foundation ( dms-0244542 and dms-0100438 ) , the packard foundation , and an epsrc advanced research fellowship .",
    "the authors are grateful to the swiss federal technical institute ( eth ) of zurich , the university of chicago , the newton institute ( cambridge , england ) , and the american institute of mathematics for their hospitality , and to kariane calta , franois ledrappier , howard masur , martin schmoll , and anonymous referees for helpful comments on a preliminary version of the manuscript .",
    "a.  eskin , h.  masur , and a.  zorich .",
    "moduli spaces of abelian differentials : the principal boundary , counting problems , and the siegel - veech constants .",
    "hautes tudes sci .",
    "* 97 * ( 2003 ) , 61179 .",
    "h.  masur .",
    "lower bounds for the number of saddle connections and closed trajectories of a quadratic differential . in _ holomorphic functions and moduli _ ,",
    ", d.  drasin , ed . , springer - verlag : new york , 1988 , pp ."
  ],
  "abstract_text": [
    "<S> there is a natural action of @xmath0 on the moduli space of translation surfaces , and this yields an action of the unipotent subgroup @xmath1 . </S>",
    "<S> we classify the @xmath2-invariant ergodic measures on certain special submanifolds of the moduli space . </S>",
    "<S> ( each submanifold is the @xmath0-orbit of the set of branched covers of a fixed veech surface . ) for the @xmath2-action on these submanifolds , this is an analogue of ratner s theorem on unipotent flows . </S>",
    "<S> the result yields an asymptotic estimate of the number of periodic trajectories for billiards in a certain family of non - veech rational triangles , namely , the isosceles triangles in which exactly one angle is @xmath3 , with @xmath4 and @xmath5  odd . </S>"
  ]
}