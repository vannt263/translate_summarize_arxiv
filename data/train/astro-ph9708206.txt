{
  "article_text": [
    "the mk classification system was first proposed in its current form in 1943 by morgan , keenan & kellman ( 1943 ) , and has since undergone a number of revisions ( e.g.  keenan & mcneil ( 1976 ) , morgan , abt & tapscott ( 1978 ) ) .",
    "mk classification is the only widely used system for stellar spectral classification . over its history",
    "it has contributed towards a number of important developments in astronomy , such as the further development of the now - famous hr diagram ( hertzprung 1911 , russell 1914 ) and the identification of anomalous stars .",
    "currently , mk classification is largely used as a tool in the preliminary analysis of unusual stars , and in selecting stellar samples for further study .",
    "an often - stated advantage of the mk system is that its classifications , often based upon the visual inspection of spectra , are static because they are based on a set of standards .",
    "however , a given spectrum may be classified differently by different people , and any one person may also classify a given spectrum differently at different times .",
    "these problems of subjectivity could be partially alleviated through the use of automated classifiers ( von hippel et  al .",
    "1994 , bailer - jones et  al.1997a ) .",
    "automated classifiers could also produce quantitative errors associated with their classifications .",
    "another problem with the mk system is that it lacks a well - defined metallicity parameter , whereas metallicity variations are known to have a significant effect on the appearance of high ( @xmath5 1 ) resolution spectra .",
    "this limits the system to classifications of bright , nearby stars which show only limited metallicity variations .",
    "attempts to extend and revise mk classification ( e.g.  corbally , gray & garrison 1994 ) may well prove valuable , but as our understanding of stellar spectra grows , particularly from computational work with model atmospheres and synthetic spectra , it becomes increasingly desirable to obtain reliable physical parameterizations of stars .",
    "any classification system is a compromise between retaining the full information in the spectrum and the need for a compact summary of it .",
    "the optimal ` summary ' is of course given by the physical parameters .",
    "advances in computational power and data storage since the inception of mk classification mean that it is now practicable to process and store large numbers of spectra .",
    "the development of fast , automated classifiers will mean that it is feasible to ` classify ' large numbers of stellar spectra in terms of their physical parameters and to re - classify them rapidly whenever stellar models are improved .",
    "physical parameters should be obtained from an original spectrum , rather than an empirical classification , as the latter may well disregard certain spectral features which later turn out to be important .",
    "one of the advantages of the mk classification system is that it is an empirical system based on unchanging standards , whereas any direct parameterization of a spectrum depends upon the quality of stellar models and will change as these improve .",
    "mk classifications could remain as useful labels giving a rough ` feel ' for a spectrum , and the work of von hippel et  al .",
    "( 1994 ) and bailer - jones et  al .",
    "( 1997a ) has shown that reliable automated mk classification is possible . in this paper",
    "we demonstrate how we extend our automated techniques to the determination of physical parameters directly from an observed spectrum .",
    "the observational stellar spectra used in this project were taken from objective prism plates obtained in the michigan spectral survey ( houk 1994 ) .",
    "this was an objective prism survey of the whole southern sky ( @xmath6 ) from the curtis schmidt telescope at the cerro tololo interamerican observatory in chile .",
    "we were loaned 100 of these plates by houk , which we digitized using the apm facility in cambridge .",
    "the output from the apm is an optical density .",
    "cawson et  al .",
    "( 1987 ) showed that the optical density calculated by the apm is , to a good approximation , linearly related to the incident intensity on the photographic plate for the typical range of optical density encountered for this type of extraction .",
    "once scanned , the digitized plates were reduced and the spectra extracted off - line .",
    "this yielded a set of over 5000 spectra over the approximate spectral range 38005200  at a resolution of @xmath53 .",
    "this data set covers a wide range of spectral types ( b2m7 ) for luminosity classes iii , iv and v. the michigan spectral survey was designed to be a re - classification of the henry draper stars . in keeping with previous usage , we shall refer to our set of 5000 spectra from this survey as the mhd ( michigan henry draper ) spectra .",
    "further details of this data set and the spectral extraction technique are discussed in bailer - jones , irwin & von hippel ( 1997b ) .",
    "these spectra have been used in a related project to automate mk stellar classification using a neural network ( bailer - jones et  al .",
    "a neural network is a software device which can be trained to give a non - linear parameterized mapping between a number of inputs ( e.g.  a complete stellar spectrum ) and one or more outputs ( e.g.  parameters such as  or mk spectral type ) .",
    "figure  [ typnetarch.p3 ] shows a neural network architecture with a single output .",
    "each node in the input layer holds a value , @xmath7 . in our application",
    "the vector of inputs , @xmath8 , is a stellar spectrum and the output is the effective temperature , .",
    "each of the input nodes connects to every node in the next layer of nodes , the ` hidden ' layer , and each of these connections has a weight , @xmath9 , associated with it .",
    "the @xmath10 node in the hidden layer forms a weighted sum of its inputs , given by @xmath11 .",
    "it then passes this sum through a non - linear sigmoid transfer function to give the final output from this node , @xmath12 , where @xmath13 is some constant .",
    "these outputs from the nodes in the hidden layer then serve as the inputs to the node in the output layer , which performs the same processing .",
    "the output from this final node is the network output .",
    "the non - linearity of the sigmoid function means that the network output is a non - linear function of the inputs .",
    "it can be shown that neural networks can model functions of arbitrary complexity ( e.g.  bishop ( 1995 ) and references therein ) .",
    "neural networks are therefore useful in a wide range of data modelling applications .",
    "the key to producing the desired output from the network when it is presented with a certain input is to set the network parameters  the weights  to their correct values .",
    "this is known as ` training ' the network and requires a set of input data for which the associated ideal outputs ( the ` target outputs ' ) are known .",
    "training takes place as follows .",
    "the weights are initially set with random values over a small range .",
    "thus when a spectrum is fed into the network , the output will also be random . by comparing this output with what it should be ( the target output )",
    ", we can adjust the weights to give an output which is closer to the target value .",
    "this is repeated for each input / output pair in the training data set .",
    "the network is trained iteratively by successive passes of the training data through the network , and on each pass the weights are perturbed towards their optimal values .",
    "specifically , the network training is performed by minimizing the error function @xmath14 , where @xmath15 is the network output for a given input spectrum and @xmath16 is the target output for that spectrum .",
    "thus we can think of training a neural network as an @xmath17-dimensional minimization problem in which we want to find those values of the @xmath17 network weights which minimize @xmath18 .",
    "once the weights have been found they are fixed and the neural network can be applied to any number of new inputs for which the outputs are not known . training the neural network is simply the process of interpolating the multi - dimensional training data in order to produce an input - output mapping characteristic of the problem represented by these data .",
    "the output from a neural network is some non - linear function of all of the network inputs . in our particular application",
    "this means that the values of physical stellar parameters which the neural network gives at its output are based on the appearance of the whole spectrum : we do not have to tell the network in advance which spectral lines are relevant . based only upon the training data ,",
    "the neural network will learn which wavelengths are more significant than others in determining the correct spectral parameters , and will express this by assigning appropriate values to the network weights .",
    "neural networks have been applied in a number of areas of astronomy , as reviewed by storrie - lombardi & lahav ( 1994 ) and miller ( 1993 ) .",
    "further theoretical details of neural networks can be found in , for example , hertz , krogh & palmer ( 1991 ) , bishop ( 1995 ) , lahav et  al .",
    "( 1996 ) and bailer - jones ( 1996 ) .",
    "in the following sections , theoretical stellar spectra of given physical parameters ( such as  and ) are generated and processed to the same ` flux ' and dispersion scales as the observed mhd spectra described in the previous section .",
    "a neural network is trained on these synthetic spectra with their physical parameters as the network target outputs .",
    "once trained , the neural network is used to give physical parameters for the mhd stars .",
    "this provides a means of rapidly and easily obtaining physical parameters for a large number of spectra without calibration via the mk system .",
    "however , a statistical comparison of these physical parameters with the known mk classifications of the mhd stars provides a calibration between the mk system and physical stellar parameters .",
    "training the network is very quick ( @xmath19 seconds on a sun sparc 10 ) , and applying it is even faster , so it is not prohibitive to re - train the network as improved models are obtained .",
    "the synthetic spectra were created using the  program written by gray ( gray & corbally 1994 , gray & arlt 1996 ) .",
    "this program computes a synthetic spectrum under the assumption of local thermodynamic equilibrium ( lte ) using a model stellar atmosphere .",
    "we used the fully blanketed models calculated by kurucz ( 1979 , 1992 ) .",
    "the model atmosphere is a tabulation of temperature and pressure at a range of ` mass depths ' in the stellar photosphere , calculated on the basis of a variety of sources of opacity .",
    "these model atmospheres are characterized by four parameters : metallicity , ; microturbulence velocity , ; surface gravity , ; effective temperature , .",
    "each spectrum is uniquely labelled by these four parameters . to calculate the spectrum emergent from the model atmosphere ,",
    "also requires a table of atomic and molecular species which lists their relative abundances , masses , and ionization energies ( or disassociation energies for molecules ) .",
    "is also given a line list , listing , for each line in the spectrum , the atomic or ionic species producing the line , the energy of the two bound electron energy levels involved in the transition , the oscillator strength of the transition and a damping factor . from these ,  calculates the densities of electrons , atoms and ions at different layers in the atmosphere , from which it determines the atmospheric opacity as a function of optical depth and wavelength using a number of different opacity sources ( rayleigh scattering , electron scattering , bound - free opacities etc . ) .",
    "under the assumption of lte , the source function , @xmath20 , is equal to the plank function , and the latter can be computed directly from the temperatures tabulated in the model atmosphere . using the source function and opacities ,",
    "calculates the synthetic spectrum in small wavelength portions .",
    "this is done by calculating the continuum and line absorption strengths at each wavelength and evaluating a voigt broadening profile for the lines using van der waals , natural , and quadratic stark broadening .",
    "more details of  can be found in gray & corbally ( 1994 ) .",
    ".synthetic spectra generated and used for network training .",
    "a spectrum was generated at each of the four metallicities ,  = @xmath21 , @xmath22 , @xmath23 and @xmath24 , yielding a set of 155 spectra per metallicity .",
    "the microturbulence velocity , , was fixed at @xmath25 .",
    "the temperature steps above are the finest steps in which kurucz s model atmospheres are available .",
    "the gaps at high temperature represent unstable model atmospheres which blow apart due to high radiative fluxes ( kurucz 1992 )",
    ".  takes about one hour ( on a sun sparc 10 ) to calculate a synthetic spectrum in 0.02  steps over the range 37905200 . [",
    "cols=\">,^,^,^,^,^,^ \" , ]     [ caltab ]    it is important to realise that the mk spectral type parameter is not a continuous variable .",
    "it is a set of discrete classes , each of which does not correspond to a single unique temperature .",
    "there is , therefore , a cosmic scatter of temperature about the median calibration value , , and this intrinsic scatter will make a significant contribution to 68 ( other contributions are discussed below ) .",
    "the important point is that 68  is _ not _ a measure of the error with which  has been determined .",
    "the error in  itself is given by the standard error in the median , which is smaller than 68by a factor of @xmath26 ( @xmath27 ) for large @xmath17 .",
    "this error for f5 dwarfs , for example , is @xmath28k .",
    "almost all of the values of  in table  [ caltab ] have standard errors in the median of less than 50k .",
    "this is about as small as can be meaningfully reported . in comparison ,",
    "jones , gimore & wyse ( 1996 ) used a broad band photometric index , @xmath29 , to determine temperature .",
    "they showed that an error in this index of @xmath30 gives rise to a temperature error of 120240k ( depending upon the spectral type ) .",
    "an error of @xmath31 ( which is about the limit of the photometry ) would yield errors of 4797k .",
    "cosmic scatter is not the only factor contributing to 68 .",
    "another source of error is the simplifying assumptions used in generating the atmospheric models and synthetic spectra , notably the assumption of lte and the absence of certain atoms and molecules .",
    "additionally , the synthetic spectra do not display variances in other stellar properties which will show cosmic variance , such as the relative abundances of atomic and molecular species or .",
    "these will produce variations in the mhd spectra which are ` unexpected ' by a network trained on the synthetic spectra .",
    "another source of error is likely to derive from the neglect of line formation mechanisms in the chromosphere .    whilst we made efforts to process the synthetic spectra into the same format as the mhd spectra",
    ", they still differ in the possibly important respect that the synthetic spectra are on a linear flux scale , whereas the mhd spectra are on a non - linear flux scale .",
    "this difference could be removed by flux calibrating the photographic plates ( e.g.  by identifying spectrophotometric standards on the plates ) .",
    "a final problem could be that the synthetic spectra have an unrealistically high s / n .",
    "this could lead the networks to lock onto certain weak features in the synthetic spectra that can not be used as a source of class discrimination in the lower s / n mhd spectra .",
    "one way around this would be to add random noise to the synthetic spectra and use each synthetic spectrum several times in the training set with different random noise added in each case .",
    "nonetheless , the narrow distribution of residuals about the median calibrations demonstrate that these potential problems have only a small effect on our technique and on the resulting calibration shown in figure  [ calsp03 ] and table  [ caltab ] .",
    "it is apparent from figures  [ tsyn03 ] and  [ tsyn05 ] that , when the metallicity of the synthetic spectra is decreased , the neural networks give _ systematically _ lower effective temperatures for stars of a given spectral type .",
    "the calibration results from training neural networks on synthetic spectra of  = @xmath21 and of  = @xmath23 confirm this trend .",
    "an explanation of this will be discussed shortly .",
    "this is an important result because it demonstrates that the network is sensitive to metallicity , and that in principle this sensitivity can be exploited to give metallicity calibrations for the mhd spectra .",
    "how this could be done will be discussed later .",
    "the best agreement between our neural network calibrations and the literature calibrations was obtained when the networks were trained on  = @xmath22 spectra .",
    "the literature calibrations are of course based on the same original mk standard spectra ; hence the metallicity at which an agreement is achieved tells us something about the mean metallicity of the mhd stars and the mk system in general . that this comes out to  = @xmath22 is not surprising , as it is well known that  = @xmath22 for the local disk ( see , for example , wyse & gilmore , 1995 , and references therein to earlier work ) .",
    "if the distances to the mhd stars are calculated and plotted as a histogram , the giants and dwarfs show a peak in the distribution at @xmath32 and @xmath33 respectively ( bailer - jones 1996 ) . for many of the stars , which are at high galactic latitudes , these distances are approximately distances out of the galactic plane .",
    "the mhd stars are therefore primarily galactic thin disk stars .",
    "the thin disk has exponential scale heights of @xmath34 and @xmath35 for the young and old stars respectively ( gilmore & wyse 1985 ) . fitting a gaussian to the distribution of stars plotted against [ fe / h ] ,",
    "gilmore and wyse ( 1985 ) reported a mean abundance @xmath36 } } = 0.0 $ ] and @xmath37 } } = 0.15 $ ] for the young thin disk , and @xmath36 } } = -0.3 $ ] and @xmath37 } } = 0.2 $ ] for the old thin disk .",
    "( as  uses standard relative abundances ,  @xmath38 [ fe / h ] for disk stars . )",
    "it is therefore plausible that the mhd spectra have an average metallicity of @xmath22 .",
    "it is certainly unlikely to be as high as 0.0 or as low as @xmath23 or @xmath24 . by comparison ,",
    "the metallicity fit for the galactic thick disk ( scale height  @xmath39 ) is @xmath36 } } = -0.6 $ ] and @xmath37 } } = 0.3 $ ] , and for the galactic extreme spheroid ( scale height  @xmath40 ) it is @xmath36 } } = -1.5 $ ] and @xmath37 } } = 0.5 $ ] .",
    "why do the  calibrations change with metallicity ?",
    "the strength of the metal lines in a synthetic spectrum increases with increasing metallicity , as can be seen from figure  [ metal ] .",
    "however , at a fixed metallicity , the apparent number and strength of the metal lines also generally increases as  decreases .",
    "suppose a network is trained on metal rich stars and gives the  of a certain mhd star as @xmath41 .",
    "a neural network trained on metal weak stars would assign this mhd star a temperature _ lower _ than @xmath41 , because this mhd spectrum is closer in appearance to a cooler star in the set of metal weak spectra .",
    "in other words , because the neural networks are trained on synthetic spectra of a single metallicity , they are not entirely able to distinguish metallicity features from temperature ones when attempting to classify mhd spectra .",
    "we tried to solve this problem by training a network on a set of spectra of all four metallicities ( a total of 620 spectra ) , with the hope that the networks could marginalize over metallicity effects .",
    "but this gave even poorer calibrations , both in terms of poorer agreement with the published calibration and a poorer spt correlation .",
    "this confusion of temperature effects with metallicity ones is not just a problem for neural networks .",
    "there is a real correlation between metallicity and temperature . at lower temperatures",
    "there is less excitation and ionization of the metals , and hence more metal lines in the spectrum .",
    "although the  value of the mhd star is constant , it is difficult for the neural network to isolate those features which vary only with metallicity and not with temperature .",
    "thus simply training a neural network on whole spectra with a range of metallicities is unlikely to help , because , rather than permitting the network to ` ignore ' metallicity effects , this is more likely to mislead it .",
    "it is clearly essential that metallicity effects are considered when attempting to obtain  calibrations for spectra .",
    "if the metallicity of the observed spectrum could be determined first , then it could be used as an extra input to a network along with the spectrum .",
    "if this network were trained on synthetic spectra with a range of metallicities , then we could imagine that the additional metallicity information would permit an appropriate determination .",
    "a more suitable alternative would be to have a series of networks , each trained on spectra of a single metallicity , and then to use the network with the appropriate metallicity to evaluate : this is more or less what we did earlier by selecting that metallicity which gave the best agreement with existing mk calibrations .",
    "the drawback with these approaches is that they require the metallicity to be known in advance .",
    "jones , wyse & gilmore ( 1995 ) and jones  et  al .",
    "( 1996 ) describe a method of determining metallicities from relatively low s / n ratio ( 1020 ) spectra , although at a higher resolution than the mhd spectra .",
    "they use spectroscopic indices calibrated by synthetic spectra to measure [ fe / h ] and avoid confusion with temperature by using an independent photometric measure of .    despite the confusion between temperature and metallicity , figures",
    "[ tsyn03 ] and  [ tsyn05 ] nonetheless show that metallicity produces a _",
    "systematic _ rather than a _ random _ effect on the spt correlation . in principal , therefore , this metallicity signature can be exploited by the neural networks to obtain metallicities for the mhd stars .",
    "the question is how to do it .",
    "one solution may to be to determine  and  simultaneously , e.g.  by using a neural network with two outputs .",
    "a direct approach to determining metallicity independently of temperature may work by identifying only those spectral regions which are most sensitive to metallicity and least sensitive to temperature , such as certain iron lines in late - type stars ( keenan & mcneil 1976 ) . with only these regions as inputs to a neural network , the ` noise ' caused by temperature variations is greatly reduced , making it more likely that the neural network could recognise metallicity features .",
    "this is an area for future work .",
    "we have shown that neural networks trained on synthetic spectra provide low - error predictions for the effective temperature , , of a star based on the star s optical spectrum . by applying these neural networks to spectra with exisiting mk classifications , we have obtained a calibration between the mk spectral type parameter and . this calibration shows a good agreement with a number of calibrations from the literature .",
    "the calibration was obtained statistically from a number of optical spectra at each spectral type with a resolution of @xmath38 2@xmath42 .",
    "the precision of this calibration is largely limited by the cosmic scatter in temperature for a given mk class and by limitations of the stellar models .",
    "it has also been shown that metallicity effects have to be considered when trying to determine .",
    "further work is required before neural networks can be used to accurately quantify metallicities . in particular , further processing of the synthetic spectra into the format of the mhd spectra ( e.g.  by the addition of noise and calibration of the flux scale ) may be required .",
    "our work nonetheless demonstrates that our networks are sensitive to metallicity .",
    "we would like to thank nancy houk for kindly loaning us her plate material .",
    "we are grateful to richard gray for the use of his spectral synthesis program and his effort in converting the code to operate on our computer system .",
    "we would also like to thank robert kurucz for the use of his model atmospheres .",
    "houk n. , 1994 , in corbally c.j . , gray r.o . ,",
    "garrison r.f .",
    ", eds , astronomical society of the pacific conference series 60 , the mk process at 50 years .",
    "astronomical society of the pacific , san francisco , p.  285"
  ],
  "abstract_text": [
    "<S> we present a technique which employs artificial neural networks to produce physical parameters for stellar spectra . </S>",
    "<S> a neural network is trained on a set of synthetic optical stellar spectra to give physical parameters ( e.g.  , , ) . </S>",
    "<S> the network is then used to produce physical parameters for real , observed spectra .    </S>",
    "<S> our neural networks are trained on a set of 155 synthetic spectra , generated using the  program written by gray ( gray & corbally 1994 , gray & arlt 1996 ) . </S>",
    "<S> once trained , the neural network is used to yield  for over 5000 b  </S>",
    "<S> k spectra extracted from a set of photographic objective prism plates ( bailer - jones , irwin & von hippel 1997a ) . using the mk classifications for these spectra assigned by houk ( 1975 , 1978 , 1982 , 1988 ) , </S>",
    "<S> we have produced a temperature calibration of the mk system based on this set of 5000 spectra . </S>",
    "<S> it is demonstrated through the metallicity dependence of the derived temperature calibration that the neural networks are sensitive to the metallicity signature in the real spectra . with further work </S>",
    "<S> it is likely that neural networks will be able to yield reliable metallicity measurements for stellar spectra .    </S>",
    "<S> pos@xmath0 pos@xmath1 pos@xmath2 pos@xmath3    68@xmath4    methods : data analysis , numerical - stars : fundamental parameters </S>"
  ]
}