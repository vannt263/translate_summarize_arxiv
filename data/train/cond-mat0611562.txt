{
  "article_text": [
    "electron transport in atomic - scale devices is an important research area where both fundamental physics and technological opportunities are simultaneously addressed.@xcite examples of novel structures include molecules in self - assembled monolayers ( sam),@xcite carbon nanotube based components,@xcite nanowires,@xcite and single - molecule junctions.@xcite also conventional lithography - based semiconductor electronics is rapidly being pushed towards the scale where atomic features become important .",
    "for example , the transistor gate oxide is now only a few atomic layers thick.@xcite    the interaction between electrons and nuclear vibrations plays an important role for the electron transport at the nanometer scale,@xcite and is being addressed experimentally in ultimate atomic - sized systems.@xcite effects on the electronic current due to energy dissipation from electron - phonon ( e - ph ) interactions are relevant , not only because they affect device characteristics , induce chemical reactions,@xcite and ultimately control the stability ; these may also be used for spectroscopy to deduce structural information  such as the bonding configuration in a nanoscale junction  which is typically not accessible by other techniques simultaneously with transport measurements .",
    "the signatures of e - ph interaction have been observed in a variety of nanosystems . in the late 1990s",
    "inelastic electron tunneling spectroscopy ( iets ) on single molecules was successfully demonstrated using a scanning tunneling microscope ( stm).@xcite later , in the quantum dot regime , measurements on a single c@xmath0 transistor showed features indicating a strong coupling between center - of - mass motion of the molecule and single - electron hopping.@xcite point contact spectroscopy has also revealed phonon signals in the high - conductance regime , e.g. , in atomic wires@xcite and individual molecules.@xcite most recently , inelastic measurements have also been reported on sams of alkyl- and @xmath1-conjugated molecular wires.@xcite these developments show the need for fully atomistic _ quantitative _ theories to accurately model structural , vibrational , and transport properties of nanoscale systems .    the density functional theory ( dft ) approach offers an atomistic description of total energy properties of nanosystems without system specific adjustable parameters .",
    "furthermore , in combination with the nonequilibrium green s function ( negf ) method@xcite it has recently become a popular approach to quantum transport in atomic structures.@xcite from the comparison with experimental data it has been established that total energy properties such as atomic structure and vibrations in general are well described by dft with the local or gradient approximations for exchange and correlation.@xcite however , while transport properties may also be calculated from dft this is not rigorously justified.@xcite on the other hand such an approach can serve as a good starting point for more sophisticated approaches correcting for errors in , e.g. , the excitation spectrum , such as time - dependent dft,@xcite the gw approximation,@xcite or self - interaction corrected dft.@xcite in weakly coupled molecular conductors electron - electron interaction effects play a significant role . while some coulomb blockade effects have been described using spin - density functional theory,@xcite the correlation effects are more complicated to treat . in this direction",
    "the addition of a hubbard - like term on top of the dft hamiltonian has been used.@xcite these more advanced developments often come at the price of limitations to the size of the systems that feasibly can be handled .",
    "it is therefore interesting to investigate to what extent the conventional dft - negf can be used to model various transport properties .    in this paper",
    "we present a scheme for including the effects of e - ph interaction into one such dft - negf method for electronic transport .",
    "specifically , we describe in detail our implementation of methods based on a combination of the siesta@xcite and the transiesta@xcite dft computer codes .",
    "siesta provides the fundamental implementation of kohn - sham dft in an atomic basis set for systems described in a supercell representation ( periodic boundary conditions ) .",
    "transiesta , on the other hand , uses the siesta framework to solve self - consistently the kohn - sham dft equations for the nonequilibrium electron density in the presence of a current flow , taking into account the full atomistic structure of both device and electrodes ( no periodicity in the transport direction ) .",
    "we describe how the siesta and transiesta methods have been extended for inelastic transport analysis , which involves the calculation of ( i ) relaxed geometries , ( ii ) vibrational frequencies , ( iii ) e - ph couplings , and ( iv ) inelastic current - voltage characteristics up to the level of the self - consistent born approximation ( scba ) .",
    "we also describe approximations leading to a lowest order expansion ( loe ) of the scba expressions , which vastly simplifies the computational burden.@xcite    while there have already been many studies devoted to transport with e - ph interaction based on model hamiltonians emphasizing various aspects of the transport,@xcite there has only been a handful based on a complete first - principles description of all aspects of the e - ph transport problem ( described below ) . by this distinction",
    "we intend to emphasize approaches where structural , vibrational , and transport properties are derived from the knowledge of the elemental constituents only , i.e. , without any system - dependent adjustable parameters .",
    "so far these have almost entirely been based on dft for the electronic structure .    in the tunneling regime",
    "the atomic resolution of the stm has been used to investigate spatial variations of the inelastic tunneling process through adsorbed molecules on metallic surfaces .",
    "corresponding inelastic stm images were simulated theoretically by lorente and persson with dft and the tersoff - hamann approach.@xcite also controlled conformational changes , molecular motion , and surface chemistry induced by the inelastic tunnel current in stm have been addressed.@xcite    more recently the regime where an atomic - scale conductor is more strongly coupled to both electrodes has also been investigated .",
    "based on a self - consistent tight - binding procedure with parameters obtained from dft,@xcite pecchia considered vibrational effects in octanethiols bonded to gold electrodes using negf and the born approximation ( ba ) for the e - ph interaction.@xcite solomon further used this method to simulate the experimental iets spectra of wang @xcite sergueev studied a 1,4-benzenedithiolate molecule contacted by two aluminum leads.@xcite this study addressed the bias dependence of the vibrational modes and e - ph couplings , but not the inelastic current itself . while the vibrational spectrum was found to be almost unchanged , a significant change in the e - ph couplings was found at high bias voltages ( @xmath2 0.5 v ) .",
    "chen studied inelastic scattering and local heating in an atomic gold contact , a thiol - bonded benzene , and alkanethiols.@xcite the inelastic signals were calculated using a golden - rule - type of expression and the dft scattering states where calculated using jellium electrodes.@xcite however , contrary to experiments and most calculations on molecules  for example refs.they predict conductance decreases by the phonons for alkanethiols .",
    "jiang used a related golden - rule approach for molecular systems.@xcite troisi suggested a simplified approach from which iets signals can be calculated approximately based on ab initio calculations for an isolated cluster and neglecting the electrodes.@xcite this scheme was shown to be suitable for the off - resonance regime , i.e. , when the molecular levels are far away from the fermi level .",
    "their results compare well with experiments by kushmerick @xcite during the development of the scheme presented here , we studied the same molecular systems with similar results.@xcite we also used it to model inelastic effects that can be observed in atomic gold wires.@xcite    the paper is organized as follows . in sec .",
    "[ sec : electronicstructuremethods ] we communicate our first - principles approach to obtain a hamiltonian description of a vibrating atomic - scale device bridging two metallic contacts , such as schematically shown in fig .",
    "[ fig : twogenericunitcells ] .",
    "specifically we describe the use of siesta to calculate vibrational modes and e - ph couplings .",
    "section  [ sec : transport ] addresses the negf formalism used to calculate the inelastic electron transport in steady state as well as the scba and loe schemes for the e - ph interaction .",
    "electrode self - energies are obtained using the transiesta scheme .",
    "we further discuss local heating effects and how various broadening mechanisms of the inelastic signal can be addressed .",
    "the main steps of the method presented in sec .",
    "[ sec : electronicstructuremethods ] and [ sec : transport ] , and how these depend on each other , are schematically clarified in fig .",
    "[ fig : flowdiagram ] . in sec .",
    "[ sec : atomicgoldwires ] and [ sec : hydrocarbonmolecules ] we illustrate our approach by corroborating and extending our previous studies of atomic gold wires and hydrocarbon molecules .",
    "section  [ sec : atomicgoldwires ] gives results for an extensive set of calculations for atomic gold wires of varying length and strain conditions . from these calculations we identify a number of physical effects , e.g. ,",
    "the evolution of a vibrational selection rule that becomes more pronounced the longer the wire is .",
    "section  [ sec : hydrocarbonmolecules ] illustrates that our method is applicable to a wide range of systems , here exemplified by different hydrocarbon molecules between gold surfaces .",
    "both applications also underline the usefulness of the loe scheme , which we validate by a comparison the full scba calculation . finally in sec .",
    "[ sec : conclusions ] we provide a summary of the paper and an outlook .",
    "in this section we describe our first - principles method to obtain a hamiltonian description of a vibrating atomic - scale device bridging to two metallic contacts .",
    "the framework is the density functional theory ( dft ) and its numerical implementation in the computer code siesta.@xcite     and possibly some additional atom layers to come closer to a representation of bulk electrodes .",
    "the dynamic atoms are a relevant subset of the device atoms for which we determine the vibrations .",
    "( b ) in the transport setup we apply the transiesta scheme where the central region @xmath3 is coupled to fully atomistic semi - infinite electrodes via self - energies , thereby removing periodicity along the transport direction ( the periodic bcs are retained in the transverse plane ) . ]          the physical situations which we typically want to describe can schematically be represented as a central device region @xmath3 which is coupled to semi - infinite electrodes to the left ( @xmath4 ) and right ( @xmath5 ) .",
    "this generic setup is shown in fig .",
    "[ fig : twogenericunitcells](b ) .",
    "we assume that the whole system under consideration can be described by the following hamiltonian    [ eq : vibham ] @xmath6    where @xmath7 and @xmath8 are the electron and phonon creation operators , respectively . here",
    "@xmath9 is the single - particle mean - field hamiltonian describing electrons moving in a static arrangement of the atomic nuclei , @xmath10 is the hamiltonian of free uncoupled phonons ( oscillators ) , and @xmath11 is the e - ph coupling within the harmonic approximation . for simplicity ,",
    "we present in this paper a formulation for spin - independent problems .",
    "the generalization to include spin - polarization is straightforward .    the hamiltonian eq .",
    "( [ eq : vibham ] ) naturally arises from the adiabatic approximation of born - oppenheimer in which the timescales of electronic and vibrational dynamics are separated.@xcite since the electrons move on a much shorter timescale than the heavy nuclei , the adiabatic approximation states that the electronic hamiltonian depends parametrically on the nuclear coordinates , i.e. , that @xmath12 where @xmath13 is a displacement variable around the equilibrium configuration @xmath14 . next , limiting ourselves to small displacements we can expand the electronic hamiltonian to lowest order in @xmath15 @xmath16 where index @xmath17 runs over all dynamic nuclei and @xmath18 over spatial directions .",
    "imposing a transformation into normal mode coordinates ( and the usual canonical quantization of position and momentum operators ) we can rewrite eq .  (",
    "[ eq : bo - expansion ] ) into @xmath19 where @xmath20 is the mass of ion @xmath17 and @xmath21 is the ionic displacement vector of normal mode @xmath22 with frequency @xmath23 normalized according to @xmath24 . from eq .",
    "( [ eq : hamexpansionnormcoord ] ) we identify the e - ph coupling matrix elements of eq .",
    "( [ eq : ephcouplinghamiltonian ] ) as @xmath25 in the following sections we describe how we determine the detailed geometry , the vibrational modes , and the e - ph couplings from dft .",
    "in our numerical approach we use the siesta implementation of dft.@xcite this code treats exchange and correlation within the local density approximation ( lda ) or the generalized gradient approximation ( gga ) .",
    "the core electrons are described with pseudopotentials .",
    "the main reason why siesta is particularly suitable starting point for transport calculations is that the valence electrons are described in a localized basis set that allows for an unambiguous partitioning of the system into leads and device , cf .",
    "[ fig : twogenericunitcells](b ) , thereby making it possible to calculate the flux of electrons ( the necessity of this partitioning for transport calculations is discussed further in sec .",
    "[ sec : transport ] ) .",
    "the basis orbitals @xmath26 are strictly localized approximations to atomic orbitals with a given cutoff radius and centered at the positions of the nuclei of the structure .",
    "importantly , this local electronic basis is nonorthogonal with overlap matrix elements @xmath27 .    in this tight - binding like basis",
    "we use the kohn - sham hamiltonian from siesta as the mean - field hamiltonian in eq .",
    "( [ eq : mfhamiltonian ] ) .",
    "we initially construct a periodic supercell [ fig .",
    "[ fig : twogenericunitcells](a ) ] , and use it as an approximation to the full transport setup [ fig .",
    "[ fig : twogenericunitcells](b ) ] for relaxing the device atoms , and to obtain vibrational frequencies and e - ph couplings .",
    "we note that this step leads to a determination of the quantities in equilibrium . in principle , these could also be calculated under nonequilibrium conditions by retaining the full transport structure of fig .",
    "[ fig : twogenericunitcells](b ) .",
    "recently , sergueev showed this to be important for relatively high voltages ( @xmath28).@xcite however , for the low - bias regime considered in this paper the equilibrium calculation is sufficient .",
    "a fairly accurate relaxation is an important prerequisite for the subsequent calculation of vibrational modes .",
    "the atoms in the device region are therefore typically relaxed until the forces acting on the dynamic atoms all are smaller than @xmath29 ev /  . compared with other error sources in the calculations little is gained by lowering this criteria .",
    "[ sec : geomopt ]      the starting point for our description of the nuclear vibrations is the born - oppenheimer total energy surface @xmath30 ( bos ) and its derivatives with respect to the nuclear coordinates . for a thorough review on phonons from dft",
    "we refer the reader to the paper by baroni @xcite from the bos we define the matrix of interatomic force constants ( usually called the hessian or dynamic matrix ) as @xmath31 where @xmath32 denotes the full set of nuclear coordinates , and @xmath33 the coordinates of nucleus @xmath17 with mass @xmath20 ( not to be confused with the e - ph coupling elements @xmath34 ) . within the harmonic approximation we can write the time - dependent displacement variable as @xmath35 inserting eq .",
    "( [ eq : defhessian ] ) and ( [ eq : tddisplvar ] ) into newton s second law of motion @xmath36 we have @xmath37 introducing boldface notation also for matrices we can rewrite eq .",
    "( [ eq : eigenproblem ] ) to the following ordinary eigenvalue problem @xmath38 where the mass - scaled matrix of interatomic force constants is @xmath39 and @xmath40 .",
    "thus , the vibrational frequency @xmath23 and mode @xmath41 belong to the eigensolution @xmath42 to eq .",
    "( [ eq : eigenproblemmatrixform ] ) where we normalize the vectors as @xmath24 .     and pt@xmath43 , acetylene @xmath44 , ethylene @xmath45 , and ethane @xmath46 ) .",
    "the results obtained directly from siesta are shown together with those of our scheme ( typical / accurate ) based on the correction eq .",
    "( [ eq : correctedfcmatrix ] ) .",
    "the different calculational settings are described in the text . for comparison",
    "the experimentally measured values of the frequencies are also given.@xcite to indicate the accuracy of the calculations the numerical values for the zero - frequency modes ( translation / rotation ) are included , where negative values correspond to imaginary frequencies . ]     versus mode index @xmath22 . ]",
    "atomic forces @xmath47 are directly obtained by siesta along with the total energy calculation.@xcite this allows us to approximate the dynamic matrix by finite differences ( `` frozen phonons '' ) , either by @xmath48 or , numerically more accurately , by @xmath49 where the bar denotes the finite difference approximation . the quantities in eq .",
    "( [ eq : hessianplusminus ] ) and ( [ eq : hessiandiff ] ) are thus readily determined .",
    "typically we use a finite displacement of the dynamic atoms in each spatial direction of @xmath50  .",
    "while the siesta calculations for @xmath51 are generally straightforward , we have observed that siesta has difficulties in estimating the change in force on the atom _ that is being displaced_. this problem relates to the so - called egg - box effect , i.e. , the movement of basis orbitals ( which follows the nuclear positions ) with respect to the real space integration grid.@xcite as a result , phonons can not be accurately obtained directly from @xmath51 . to circumvent this technicality",
    "we impose momentum conservation ( in each direction @xmath52 ) via @xmath53 , which then determines the diagonal elements according to @xmath54 where the @xmath55-sum runs over all atoms in the supercell .",
    "finally , since @xmath56 we apply a numerical symmetrization of the force constants in the dynamic region . as a check",
    "we always verify that the frequencies calculated from the dynamic matrices with forward , backward , and combined displacements [ eq .  ( [ eq : hessianplusminus ] ) and ( [ eq : hessiandiff ] ) ] are roughly the same , indicating that the harmonic approximation is not violated with the given displacement amplitude @xmath57 .    the eigenvalues @xmath58",
    "corresponding to the symmetric matrix @xmath59 are real numbers . some of these may however become negative leading to imaginary frequencies @xmath60 , indicating that the atomic configuration @xmath61 is in fact not describing a true energy minimum of the bos .",
    "we shall denote such imaginary phonon frequencies by negative values in fig .",
    "[ fig : comparison_simplemolecules ] and [ fig : etotvslength ] .    a comparison between calculated and experimentally measured vibrational frequencies for some simple molecules is shown in fig .",
    "[ fig : comparison_simplemolecules ] .",
    "specifically we include both the frequencies obtained directly with siesta ( from @xmath51 ) as well as those of our scheme based on the correction eq .",
    "( [ eq : correctedfcmatrix ] ) . in the calculations for the dimers the important settings correspond to either a 200 ry cutoff for the real space grid integration and a single - zeta plus polarization ( szp ) basis set ( siesta / typical ) , or a 400 ry cutoff and a double - zeta plus polarization ( dzp ) basis set ( accurate ) .",
    "for the hydrocarbon molecules the settings are 200 ry cutoff and dzp basis set . in all calculations",
    "the displacement amplitude is @xmath62  .",
    "the figure illustrates that our scheme presented above leads to a quite accurate description of the vibrational frequencies .",
    "we thus see no need to resort to a frequency scaling which is sometimes invoked in dft calculations .",
    "further , the figure shows that the use of momentum conservation for correcting elements in the siesta dynamic matrix improves the calculation , in particular the determination of low frequency modes ( including the zero - frequency rotation / translation modes of isolated molecules ) .    as an illustration of the convergence of the phonon energies with respect to some important dft settings for larger systems , we show in fig .",
    "[ fig : calcsettings ] the calculated phonon energies for two different sizes of the dynamic region of a four atom gold wire ( shown in the insets ) .",
    "we obtain almost identical frequencies by increasing the real space integration grid cutoff from 200 ry to 300 ry , by using a dzp basis set instead of a szp , or by changing the finite displacements @xmath57 from 0.02  to 0.01  .",
    "we expect the overall accuracy of these calculations to be representative not only for isolated molecules but also for larger periodic systems as well as systems involving other elements .      in order to compute the e - ph coupling matrices @xmath63 we have modified siesta to output the kohn - sham hamiltonian matrices @xmath64 for each of the displaced configurations .    the complicated part of the e - ph couplings in eq .",
    "( [ eq : ephcouplingmatrixelements ] ) is the evaluation of matrix elements of gradients of the hamiltonian operator . rewriting this part as @xmath65 where @xmath66 represents the change in basis orbitals with displacements , and using the identity @xmath67 where @xmath68 is the overlap matrix , we arrive at a form suitable for numerical evaluation    @xmath69    the first term on the right hand side in eq .",
    "( [ eq : derivhamiltonianoperator ] ) can be approximated by finite differences of hamiltonian matrices .",
    "the factors @xmath70 and @xmath71 are derivatives of the orbital overlaps , which we readily determine from finite differences via six separate runs that include both the original structure as well as the whole structure displaced by @xmath72 along each spatial direction .",
    "we note that with the calculation of @xmath70 and @xmath71 we avoid the further approximations for the e - ph couplings proposed by head  gordon and tully@xcite which we have used previously.@xcite    in some cases , if one works with a relatively small supercell , the calculated fermi energy may change slightly between the displaced configurations of a given system . since the real physical systems are essentially infinite , such shifts in the fermi energy are artificial finite - size effects . to compensate for this we choose to measure all energies with respect to the fermi energy of the relaxed structure @xmath73 , i.e. , to shift the displaced hamiltonians according to @xmath74 \\mathbf{s}(q_{i\\nu}).\\nonumber\\\\\\end{aligned}\\ ] ] the finite difference approximation to the first term in eq .",
    "( [ eq : derivhamiltonianoperator])the derivative of the hamiltonian matrix  may thus be written as @xmath75\\mathbf s^0\\big\\},\\nonumber\\\\\\end{aligned}\\ ] ] thereby completing the necessary steps to evaluate the e - ph coupling matrix elements .",
    "in this section we describe how the negf formalism is used to calculate the stationary electron transport through a region in space with an e - ph interaction .",
    "the basic ideas go back to the seminal work by caroli @xcite but we shall use the later formulation by meir and wingreen.@xcite    the starting point in the negf approach is a formal partitioning of the system into a central device region ( where interactions may exist ) and noninteracting leads .",
    "this partitioning was sketched in fig .",
    "[ fig : twogenericunitcells](b ) .",
    "the e - ph interaction is treated with diagrammatic perturbation theory .",
    "below we describe the scba as well as further approximations leading to the computationally inexpensive loe scheme .",
    "in addition , we discuss local heating effects and how various broadening mechanisms of the inelastic signal are addressed .      the physical system of interest sketched in fig .",
    "[ fig : twogenericunitcells](b ) is infinite and _ non_-periodic . for",
    "this setup let us initially consider the electronic and vibronic problems separately and return later to the treatment of their mutual interaction .",
    "the use of a local basis in siesta allows us to partition the ( bare ) electronic hamiltonian @xmath76 and overlap matrix @xmath77 into @xmath78 in which the direct couplings and overlaps between leads @xmath4 and @xmath5 are strictly zero ( provided that the central region is sufficiently large ) .    in a similar fashion ,",
    "since interatomic forces are short ranged , the mass scaled dynamic matrix @xmath59 [ eq .  ( [ eq : defhessian ] ) ] can be partitioned into @xmath79 where the direct coupling between leads @xmath4 and @xmath5 is neglected .",
    "the infinite dimensionality of the electronic and vibrational problem can effectively be addressed with the use of green s function techniques . for the electronic part",
    "we define the retarded electronic single - particle green s function @xmath80 as the inverse of @xmath81 $ ] where @xmath82 .",
    "it is then possible to write its representation in the device region @xmath3 as @xmath83^{-1},\\qquad\\end{aligned}\\ ] ] where the self - energy due to the coupling to the left lead is @xmath84 and similarly for the right lead . here",
    ", @xmath85 is the retarded electronic `` surface '' green s function of lead @xmath86 which can be calculated effectively for periodic structures by recursive techniques.@xcite the quantities @xmath87 are directly available from transiesta.@xcite note that green s functions calculated without the e - ph interaction are denoted with a superscript `` 0 '' .",
    "similarly , for the vibrational part we can define the retarded phonon green s function @xmath88 as the inverse of @xmath89 $ ] , and write its representation in the device region @xmath3 as @xmath90^{-1},\\nonumber\\\\\\end{aligned}\\ ] ] where the self - energies due to the coupling to the left and right regions are @xmath91 and @xmath92 , respectively . here",
    ", @xmath93 is the retarded phonon `` surface '' green s function which again can be calculated by the recursion techniques mentioned above .",
    "note that the boldface matrix notation used for both electronic and vibrational quantities refers to different vector spaces : indices in the electronic case refer to the basis orbitals and in the phonon case to real space coordinates .",
    "in addition , the electronic problem is treated directly in a nonorthogonal basis .",
    "the validity of the nonorthogonal formulation has been discussed for the elastic scattering problem in refs .   and",
    "more recently including interactions in ref .  .",
    "since we are interested in the interaction of the electronic current with vibrations localized in the device region , we invoke the _ ansatz _ that  to a first approximation  we can disregard the phonon lead self - energies @xmath94 and only describe the device region by @xmath95^{-1 } , \\label{eq : phonongfapprox}\\end{aligned}\\ ] ] which in terms of the eigensolutions @xmath96 to eq .",
    "( [ eq : eigenproblemmatrixform ] ) can be written in a spectral representation @xmath97 where the free phonon green s functions are@xcite @xmath98,\\end{aligned}\\ ] ] with @xmath99 being the expectation value of the occupation in mode @xmath22 .",
    "the lesser and greater green s functions stated above are used in sec .",
    "[ sec : scba ] ( transformed into energy domain via @xmath100 ) .",
    "the validity of the approximation eq .",
    "( [ eq : phonongfapprox ] ) can be investigated by calculating the correct phonon green s function according to eq .",
    "( [ eq : phononretgreensfctwithlrselfenergies ] ) , and then project the corresponding local density of states ( per energy via @xmath101 ) onto each eigenmode @xmath102 of the dynamic region ( with fixed electrodes ) , i.e. , to determine @xmath103,\\end{aligned}\\ ] ] satisfying the sum rule @xmath104 if the mode @xmath102 is a true localized modes for the extended system , then the projection @xmath105 resembles a sharp resonance around the phonon energy @xmath106 . in practice",
    ", @xmath107 are not exact eigenmodes of the extended system , and the resonances hence acquire finite widths .",
    "this broadening characterizes the damping ( within the harmonic approximation ) of the modes by the coupling to the electrodes .",
    "if the broadening is small compared with the phonon energy ( weak coupling to the bulk ) , then the projection can be described by a lorentzian @xmath108 where @xmath109 is the half width half max ( hwhm ) value that transforms in time domain into an exponential decay of the phonon population with an average lifetime @xmath110 .",
    "we will return to the question of a finite phonon lifetime in sec .",
    "[ sec : broadening - mechanisms ] and [ sec : phononlifetimediscussion ] .",
    "[ sec : introphonondosprojection ]      our transport calculations are based on negf techniques and in particular the meir - wingreen formulation.@xcite the steady - state ( spin - degenerate ) electrical current @xmath111 and the power transfer @xmath112 _ to _ the device from lead @xmath86 can generally be expressed as @xmath113,\\qquad \\label{eq : tintegrant}\\end{aligned}\\ ] ] where @xmath114 is the electronic particle number operator of lead @xmath115 , @xmath116 the full lesser ( greater ) green s function in the device region @xmath3 ( including all relevant interactions ) , and @xmath117 the lesser ( greater ) self - energy that represents the rate of electrons scattering into ( out of ) the states in the device region @xmath3 .",
    "we assume that the leads are unaffected by the nonequilibrium conditions in the device ( this may be tested by increasing the device region )",
    ". we can then use the fluctuation ",
    "dissipation theorem to write the lead self - energies as@xcite @xmath118 \\mathbf\\gamma_\\alpha(\\varepsilon)\\\\    \\end{array}\\right.,\\end{aligned}\\ ] ] where @xmath119 $ ] is the fermi - dirac distribution , @xmath120 the chemical potential of lead @xmath115 , and @xmath121=i[\\mathbf\\sigma^>_\\alpha(\\varepsilon ) -\\mathbf\\sigma^{<}_\\alpha(\\varepsilon)],\\end{aligned}\\ ] ] describes the broadening of the device states by the coupling to the lead .",
    "the lesser and greater green s functions are generally related to the retarded and advanced ones via the keldysh equation @xmath122 where @xmath123 is the sum of all self - energy contributions ( leads , interactions , etc . ) .",
    "further , in steady - state situations time reversal symmetry relates the advanced green s function to the retarded one via @xmath124.@xcite      if we consider a two - terminal setup with no interactions in the device region @xmath3 , then the current expression simply reduces to the landauer - bttiker formula where eq .  ( [ eq : tintegrant ] ) becomes @xmath125\\nonumber\\\\ & & \\times\\,\\textrm{tr } [      \\mathbf\\gamma_l(\\varepsilon)\\mathbf g^{0,r}_d(\\varepsilon )      \\mathbf\\gamma_r(\\varepsilon)\\mathbf g^{0,a}_d(\\varepsilon)].\\end{aligned}\\ ] ]    transiesta allows one to calculate the transmission function @xmath126 under finite bias conditions , i.e. , with an electrostatic voltage drop over the device and different chemical potentials of the two leads . due to the electrostatic self - consistency",
    ", this implies that the lead self - energies , e.g. ,  @xmath127 , and hamiltonian @xmath128 depend parametrically on the external bias voltage @xmath129 .",
    "these charging and polarization effects caused by the electrostatic voltage drop@xcite are fully treated in transiesta at finite bias .",
    "although it is relatively straightforward to include these effects , it is computationally demanding for the inelastic calculation presented below .",
    "we have therefore neglected the voltage dependence and used the zero - bias self - energies and hamiltonian in our inelastic calculations in the low - bias regime . in the case of metallic leads and a small applied bias ( of the order of vibrational energies )",
    "we expect this approximation to be accurate .",
    "however , sufficiently large biases have been shown to influence the atomic structure@xcite as well as the e - ph couplings.@xcite      let us turn to the problem of the e - ph coupling . in order to use eq .",
    "( [ eq : meirwingreencurrent ] ) and ( [ eq : power ] ) we need the full green s functions @xmath130 taking the e - ph interaction into account . our approach is the scba where the phonon self - energy to the electronic system is described by the diagrams shown in fig .",
    "[ fig : diagrams].@xcite we note that in this work we ignore the phonon renormalization ( pair bubble diagram ) by the e - ph coupling .",
    "\\(a )   ( b )     we write the phonon self - energies from mode @xmath22 as @xcite @xmath131\\nonumber\\\\              & & \\quad-\\frac i2 \\mathcal h_{\\varepsilon'}\\{\\mathbf              \\sigma^{>}_{\\mathrm{ph},\\lambda}(\\varepsilon ' )              -\\mathbf \\sigma^{<}_{\\mathrm{ph},\\lambda}(\\varepsilon')\\}(\\varepsilon),\\qquad\\label{eq : sigmaret}\\end{aligned}\\ ] ] where the retarded self - energy has been written in terms of the lesser and greater self - energies using the kramers - kronig relation @xmath132 .",
    "the functional @xmath133 represents the hilbert transform described in app .",
    "[ sec : hilbert ] .",
    "the hartree diagram fig .",
    "[ fig : diagrams](a ) does not contribute to the lesser and greater phonon self - energies ; this is because energy conservation implies that the wiggly line corresponds to a factor @xmath134.@xcite it does , however , lead to constant term for the retarded self - energy which can be understood as a static phonon - induced change in the mean - field electronic potential.@xcite from eq .",
    "( [ eq : sigmaret ] ) we note that our retarded self - energy has the limiting behavior @xmath135 .",
    "this is also the limits of the fock diagram fig .",
    "[ fig : diagrams](b ) if one calculates it directly with the langreth rules.@xcite we therefore conclude that eq .",
    "( [ eq : sigmaret ] ) gives exactly the fock diagram .",
    "ignoring the hartree term is reasonable since its small static potential shift might be screened ( at least partially ) if it had been included on the level of the dft self - consistency loop .",
    "further , the hartree diagram does not lead to a signal at the phonon threshold voltage .",
    "the full device green s functions @xmath136 are related to @xmath137 , @xmath138 , and @xmath139 via the dyson and keldysh equations @xcite @xmath140\\mathbf g_d^{a}(\\varepsilon).\\label{eq : glessgreat}\\qquad\\end{aligned}\\ ] ] the coupled nonlinear eqs .",
    "( [ eq : sigmalessgreat])([eq : glessgreat ] ) have to be solved iteratively subject to some constraint on the mode population @xmath141 appearing in @xmath142 , cf .",
    "( [ eq:92:phgf0-lessergreater ] ) . for weak e - ph coupling",
    "we thus approximate the mode occupation @xmath141 by the steady - state solution to a rate equation describing the heating of the device @xmath143 , \\label{eq : rateequation}\\end{aligned}\\ ] ] where @xmath144 $ ] is the bose - einstein distribution , @xmath145 the power dissipated into mode @xmath22 by the electrons , and @xmath146 a damping parameter related to the average lifetime of the phonon , e.g. , by coupling to bulk vibrations .    in steady state",
    "the power transferred by electrons from the leads into to the device must balance the power transferred from the device electrons to the phonons , i.e. , @xmath147 from the particle conservation condition@xcite @xmath148=0,\\end{aligned}\\ ] ] we can define the quantity @xmath145 as @xmath149,\\nonumber\\end{aligned}\\ ] ] which consequently obeys eq .",
    "( [ eq : powerbalance ] ) .",
    "we note that in this way we basically define @xmath150 quantities from a single equation for @xmath151 only ; different definitions could in principle also fulfill the power balance . however , to lowest order in the e - ph coupling our definition eq .",
    "( [ eq : plambda - def ] ) is unambiguously the power transferred to mode @xmath22 .    from eq .",
    "( [ eq : rateequation ] ) we can identify two regimes , ( i ) the externally damped limit ( @xmath152 much larger than electron - hole ( e - h ) pair damping @xmath153 ) where the populations are fixed according to the bose - einstein distribution @xmath154 , and ( ii ) the externally undamped limit ( @xmath155 and hence from eq .",
    "( [ eq : rateequation ] ) that @xmath156 ) where the populations vary with bias such that no power is dissipated in the device , i.e. , @xmath157 .",
    "it is instructive to note that @xmath145 includes both phonon emission and absorption processes , which is the reason why a steady - state solution always exists .",
    "[ sec : dampingregimes ]    a typical situation that come close to the externally undamped limit is when the device vibrations fall outside the phonon band of the bulk electrodes , i.e. , when there is a significant mass difference between the device atoms and the electrode atoms . in this case",
    "the vibrations can not couple directly ( resonantly ) to the bulk , and the damping , e.g. , by anharmonic means , is likely to be much smaller than the coupling to the electrons .",
    "one important example is the hydrogen molecule clamped between platinum contacts.@xcite    to solve the scba equations eqs .",
    "( [ eq : sigmalessgreat])([eq : rateequation ] ) , we have developed an implementation in the programming language python where the green s functions and self - energies are sampled on a finite energy grid .",
    "the main technical challenges are discussed in app .",
    "[ sec : scbaappendix ] .",
    "finally we note that with the phonon self - energies eqs .",
    "( [ eq : sigmalessgreat])([eq : sigmaret ] ) the current is conserved .",
    "this can be proven using the identity eq .",
    "( [ eq : traceidentity]).@xcite      the solution of the scba equations is a daunting numerical task for systems consisting of more than a handful of atoms . however , for systems where the e - ph coupling is weak and the density of states ( dos ) varies slowly with energy , we have previously derived the loe approximation.@xcite here we elaborate on these results .    the main computational burden of the scba originates from the numerical integration over energy needed in the evaluation of the current and power expressions eqs .",
    "( [ eq : meirwingreencurrent])([eq : power ] ) .",
    "the loe approximation assumes that the retarded and advanced single - particle green s functions @xmath158 and lead self - energies @xmath159 are energy _",
    "independent_. we can then expand the current and power expressions to the lowest order ( second ) in e - ph couplings @xmath160 and perform the energy integrations analytically .",
    "these integrals consist of products of fermi - dirac functions and their hilbert transforms .",
    "the loe thus retains the pauli exclusion principle for fermionic particles , which is necessary to model the blocking of phonon emission processes at low bias .    in the loe approximation ,",
    "the total power dissipated into the phonon system @xmath161 can , after lengthy derivations , be written as @xcite @xmath162\\gamma_\\textrm{e - h}^\\lambda      + \\gamma_\\textrm{em}^\\lambda(v , t)\\right\\},\\\\ \\label{eq : electronholepairrate }      \\gamma_\\textrm{e - h}^\\lambda&=&\\frac{\\hbar\\omega_\\lambda}{\\pi\\hbar }          \\mathrm{tr}\\left[\\mathbf{m}^\\lambda\\mathbf{a}\\mathbf{m}^\\lambda\\mathbf{a}\\right],\\\\      \\gamma_\\textrm{em}^\\lambda&=&\\frac {          \\hbar\\omega_\\lambda[\\cosh\\!\\big(\\frac{e v}{\\text{k}_\\text{b}t}\\!\\big)\\!-\\!1]\\coth\\!\\big(\\frac{\\hbar\\omega_\\lambda}{2\\text{k}_\\text{b}t}\\!\\big)\\ !          -{ev}\\sinh\\!\\big(\\frac{e v}{\\text{k}_\\text{b}t}\\!\\big)\\ ! }          { \\pi \\hbar[\\cosh\\!\\big ( \\frac{\\hbar \\omega_\\lambda}{\\text{k}_\\text{b}t}\\!\\big)-\\cosh\\!\\big ( \\frac{e v}{\\text{k}_\\text{b}t } \\!\\big)]}\\nonumber\\\\ & & \\times         \\mathrm{tr}\\left[\\mathbf{m}^\\lambda \\mathbf{a}_l\\mathbf{m}^\\lambda\\mathbf{a}_r\\right ] , \\label{eq : effectiveemissionrate}\\end{aligned}\\ ] ] where the bose - einstein distribution @xmath163 appears in eq .",
    "( [ eq : powerlambda ] ) due to the integration of fermi - dirac functions describing the electrons in the contacts .",
    "here @xmath164 , @xmath165 , and @xmath166 are the noninteracting retarded green s function , the broadening by contact @xmath86 , and the spectral function at @xmath167 , respectively .",
    "for convenience we have also defined the quantities @xmath168 such that @xmath169 .    the first term in eq .",
    "( [ eq : powerlambda ] ) describes the equilibrium energy exchange between the vibrational and electronic degrees of freedom ( e - h pair damping @xmath153 of the vibrations ) ; it tend to drive the phonon system towards the bose - einstein distribution .",
    "the second term appears in nonequilibrium and is related to an effective emission rate @xmath170 of vibrational quanta under finite bias . at low temperatures ( @xmath171 )",
    "this rate is given as @xmath172,\\nonumber\\\\\\end{aligned}\\ ] ] where @xmath173 is the step function ; i.e. , the net emission of phonons above the threshold grows linearly with the bias voltage .",
    "furthermore , since @xmath174\\geq 0 $ ] , we find that @xmath175 \\geq 2 \\,\\mathrm{tr}\\left[\\mathbf{m}^\\lambda\\mathbf{a}_l \\mathbf{m}^\\lambda\\mathbf{a}_r \\right].\\end{aligned}\\ ] ] we can use this inequality to derive an upper bound on the phonon occupation by solving the steady - state condition @xmath176 [ cf .",
    "eq .  ( [ eq : rateequation ] ) with no external damping ]",
    ". it simply becomes@xcite @xmath177    to provide an intuitive understanding of eqs .",
    "( [ eq.power])([eq:occupationbound ] ) consider the following arguments : the energy phase space available for phonon emission and absorption processes is limited by the pauli principle , as sketched in fig .",
    "[ fig : loephasefig ] .",
    "we divide the electronic phase space in two , corresponding to scattering states incoming from either the left or the right contact . without e - ph scattering these states",
    "are assumed to be populated up to the fermi level @xmath167 ( we take @xmath178 and @xmath171 ) . within this picture phonon emission",
    "can only take place from a populated state originating in the left contact to an empty state originating in the right contact , see fig .",
    "[ fig : loephasefig](a ) .",
    "similarly , phonon absorption can be described by three different processes sketched in fig .",
    "[ fig : loephasefig](b)(d ) , again corresponding to scattering from populated initial states to empty final states .",
    "the scattering rates for these processes are proportional to the energy window in which they can take place . denoting the scattering rate per energy as @xmath179 , where @xmath86 ( @xmath180 ) indicates the propagation direction of the initial ( final ) scattering state , we can write the spontaneous plus stimulated emission power as @xmath181 and the absorption power as @xmath182 @xmath183 $ ] . the net power transfer from the electronic system to the phonon mode",
    "@xmath22 is therefore @xmath184\\nonumber\\\\ & &   + \\hbar \\omega_\\lambda   \\ , ( ev-\\hbar \\omega_\\lambda ) \\ , \\frac{d\\gamma_{lr}}{d\\varepsilon}.\\end{aligned}\\ ] ] a comparison with eq .",
    "( [ eq : powerlambda ] ) reveals that the term proportional to the occupation @xmath141 is bias independent due to a cancelation of phonon absorption by stimulated emission .",
    "furthermore , the upper bound in eq .",
    "( [ eq : occupationbound ] ) is directly motivated by equating eq .",
    "( [ eq : simplepowerargument ] ) to zero ( steady state ) and by ignoring scattering processes with initial and final states propagating in the same direction ( @xmath185 ) .",
    "in addition , a steady - state solution to eq .",
    "( [ eq : rateequation ] ) always exists because the phonon emission rate is always smaller than the total phonon absorption rate , and that emission processes are restricted to a smaller energy window than absorption processes .",
    "the loe approximation , which above was applied to the power , also allows us to write the current through the device @xmath186",
    "as@xcite    @xmath187   \\nonumber \\\\ & & + { \\sum\\limits_{\\lambda}^ { } } { \\cal i}^\\mathrm{sym}_\\lambda(v , t , \\langle n_\\lambda\\rangle ) \\ ,     \\mathrm{tr}\\left [       \\mathbf{g}^\\dag \\mathbf{\\gamma}_l \\mathbf{g } \\left\\ {       \\mathbf{m}^\\lambda \\mathbf{a}_r   \\mathbf{m}^\\lambda +         \\frac{i}{2}\\left ( \\mathbf{\\gamma}_r \\mathbf{g}^\\dag \\mathbf{m}^\\lambda \\mathbf{a } \\mathbf{m}^\\lambda - \\mathrm{h.c.}\\right )         \\right\\ }     \\right ]   \\nonumber \\\\   & & + { \\sum\\limits_{\\lambda}^ { } } { \\cal i}^\\mathrm{asym}_\\lambda(v , t)\\ ,    \\mathrm{tr}\\left [           \\mathbf{g}^\\dag \\mathbf{\\gamma}_l \\mathbf{g } \\left\\ {             \\mathbf{\\gamma}_r \\mathbf{g}^\\dag \\mathbf{m}^\\lambda             \\left ( \\mathbf{a}_r-\\mathbf{a}_l \\right ) \\mathbf{m}^\\lambda +             \\mathrm{h.c . }             \\right\\ }      \\right ] ,   \\label{eq : current1 } \\\\",
    "{ \\cal i } ^\\mathrm{sym}_\\lambda & = &        \\frac{e } { \\pi \\hbar } { \\left ( { 2 e v } \\langle n_\\lambda \\rangle +        \\frac{\\hbar \\omega_\\lambda-{e v}}{e^{\\frac{\\hbar \\omega_\\lambda - e v}{\\text{k}_\\text{b}t}}-1}-        \\frac{{\\hbar \\omega_\\lambda}+{e v}}{e^{\\frac{\\hbar \\omega_\\lambda+e v}{\\text{k}_\\text{b}t}}-1 } \\right ) } , \\label{eq : currentnormal } \\\\   { \\cal i}^{\\mathrm{asym}}_\\lambda&= &      \\frac{e}{\\hbar}{\\int\\limits_{-\\infty}^{\\infty } } \\frac{d\\varepsilon}{2\\pi } \\left[n_\\textrm{f}(\\varepsilon ) -n_\\textrm{f}(\\varepsilon - e v)\\right ] \\ ,      { \\cal h}_{\\varepsilon ' } \\{{n_\\textrm{f}(\\varepsilon'+\\hbar \\omega_\\lambda )      -n_\\textrm{f}(\\varepsilon'-\\hbar \\omega_\\lambda)}\\}(\\varepsilon ) ,     \\label{eq : currenthilbert}\\end{aligned}\\ ] ]    where the bias is defined via @xmath188 , and @xmath189 is the spin - degenerate conductance quantum .",
    "this expression is current conserving , i.e. , calculating the current at the left and right contacts give the same result .    the loe expression for the current eq .  ( [ eq : current1 ] )",
    "contains three terms , ( i ) the landauer - bttiker term corresponding to the elastic conductance , ( ii ) the `` symmetric '' term corresponding to symmetric conductance steps at the vibrational energies , and ( iii ) the `` asymmetric '' term corresponding to peaks and dips in the conductance which are asymmetric with voltage inversion , see fig .",
    "[ fig : loeshape ] . for geometrically symmetric junctions",
    ", it can be shown that the asymmetric term vanishes exactly .",
    "even for geometrically asymmetric systems we typically find that it is a very small contribution compared with the symmetric term .",
    "furthermore , the sign of the conductance step for the symmetric term in general shows an increase ( decrease ) in the conductance for low ( high ) conducting systems , e.g. , vibrations usually help electrons through molecules while they backscatter electrons in atomic wires .",
    "this is discussed further for a one - level model in ref .  .",
    "the loe approximation is computationally simple and can be applied to systems of considerable size . although the approximation is not strictly valid for systems with energy - dependent dos , comparison with the full scba calculations shows good agreement even for systems that have a slowly varying dos ( on the scale of vibrational energies ) , e.g. , the organic molecules connected to gold electrodes described below in sec .",
    "[ sec : hydrocarbonmolecules ] .",
    "the loe approximation will certainly fail when sharp resonances ( compared to the vibrational energies ) are present within the order of phonon energies of the fermi energy .",
    "however , in this case coulomb blockade physics is also expected , which thus makes any dft mean - field approach ( including ours ) questionable .    ) and",
    "( [ eq : currenthilbert ] ) giving symmetric and asymmetric phonon contributions to the conductance in the loe , respectively .",
    "the differential conductance @xmath190 and the second derivative @xmath191 are shown ( in arbitrary units ) for one phonon mode for three different temperatures ( a ) @xmath192 , ( b ) @xmath193 , and ( c ) @xmath194 . ]",
    "the width of the experimentally measured phonon signal in the conductance is a combination of ( at least ) three broadening mechanisms , namely the intrinsic ones from a finite temperature and a finite phonon lifetime , as well as the one related to the modulation voltage used in lock - in measurements ( to improve the signal - to - noise ratio ) of the second derivative of the current with respect to the bias .",
    "these contributions do not add up trivially .",
    "however , as we show below , one can provide estimates for each of the different contributions which thus help to understand what effect is the dominant one .    as can be seen in fig .",
    "[ fig : loeshape ] , the electronic temperature gives rise to a broadening of the vibrational signal . from eq .",
    "( [ eq : currentnormal ] ) the full width half max ( fwhm ) in the second derivative of the current can be shown to be approximately @xmath195.@xcite    the effects of a finite phonon lifetime @xmath196 is to a first approximation described by a convolution of the free phonon green s functions with a lorentzian with a hwhm width of @xmath197 .",
    "consequently , this convolution propagates to the phonon self - energies eq .",
    "( [ eq : scbaselfenergies ] ) and to the inelastic loe corrections to the current , cf .",
    "( [ eq : currentnormal ] ) and ( [ eq : currenthilbert ] ) .",
    "the fwhm broadening in the second derivative of the current is thus @xmath198 .",
    "the intrinsic linewidth of the phonon signal has also been discussed in a simple scba model by galperin @xcite    the broadening from the lock - in technique for measurements of the first or second derivatives of the current can be estimated in the following way . with a small harmonic modulation signal ( with amplitude @xmath199 ) applied on top of the bias voltage one can measure derivatives of the current . as shown in app .",
    "[ sec : ddilockin ] the fwhm width induced by the lock - in measurement technique is @xmath200 and @xmath201 for the first and second derivatives of the current , respectively ( neglecting intrinsic broadening ) . in other words , if @xmath191 is a @xmath202-function , the experimentally measured fwhm width will be either @xmath200 or @xmath203 , depending on whether the lock - in measurement is on the first or second harmonic .",
    "is defined as the distance between the plane in each electrode containing the second - outermost au(100 ) layer . ]    since the discovery in the late 1990s that gold can form free - standing wires of single atoms @xcite the mechanical , chemical , and electrical properties of these atomic - scale systems have been extensively studied.@xcite for this reason we illustrate in this section our method described in sec .",
    "[ sec : electronicstructuremethods ] and [ sec : transport ] by applying it to model inelastic scattering in atomic gold wires .",
    "we compare directly the results of our theoretical developments with the high - quality experimental data by agrat and co - workers.@xcite they used a cryogenic stm to first create an atomic gold wire between the tip and the substrate surface , and then to measure the conductance against the displacement of the tip . from the length of the observed conductance plateau around g@xmath204the signature that an atomic wire has been formed ",
    "it was possible to determine the approximate size as well as the level of strain of the created wire . under these conditions",
    "agrat  then used point - contact spectroscopy to show that the conductance of an atomic gold wire decreases a few percent around a particular tip - substrate voltage ( symmetric around zero bias ) presumably coinciding with the natural frequency of a certain vibrational mode of the wire . with this inelastic spectroscopy method",
    "they could further characterize the conductance drop as a function of wire length and strain .    to simulate these experiments , we study wires containing different number of atoms and under varying stretching conditions .",
    "the generic supercells used in the siesta calculations are illustrated in fig .",
    "[ fig : structures ] and consist of 3 to 7 gold atoms bridging pyramidal bases connected to stacked au(100 ) layers .",
    "we use a @xmath205 supercell size in the plane transverse to the transport direction and define the electrode separation @xmath4 , as indicated on fig .",
    "[ fig : structures ] , as the distance between the plane in each electrode containing the second - outermost au(100 ) layer .",
    "the face - centered cubic ( fcc ) lattice constant for the bulk gold atoms is taken to be @xmath206  .",
    " in a high quality plane - wave dft calculation and @xmath207  in a siesta calculation with our present dft settings .",
    "the experimental value is @xmath208  . ]",
    "we generally use ( unless otherwise specified ) the perdew - burke - ernzerhof version of the gga for the exchange - correlation functional,@xcite a split - valence single-@xmath209 plus polarization ( szp ) basis set with a confining energy of 0.01 ry ( nine orbitals corresponding to the @xmath210 and @xmath211 states of the free au atom ) , a cutoff energy of 200 ry for the real space grid integration , and the @xmath212-point approximation for the sampling of the three - dimensional brillouin zone . the interaction between the valence electrons and the ionic cores",
    "are described by a standard norm - conserving troullier - martins pseudopotential@xcite generated from a relativistic atomic calculation ( including core correction ) .",
    "we have found that these settings yield a reasonable compromise between accuracy and computational cost .",
    "-point ( colored open symbols ) as well as with a @xmath213 @xmath214-point sampling of the two - dimensional brillouin zone perpendicular to the transport direction ( black stars ) . ]      for a given electrode separation @xmath4 the first calculational step is to relax the geometry to obtain a local energy minimum configuration @xmath61 . with the settings described above we relax both the outermost electrode layers , the pyramidal bases , and the wire atoms until all forces acting each of these atoms are smaller than @xmath215 ev /  .",
    "figure  [ fig : etotvslength](a ) shows the relative differences in the kohn - sham total energy ( cohesive energy ) as the wires are elongated .",
    "we also show the numerical derivatives of these binding energy curves as a measure of the forces acting on the wire .",
    "the breaking force , defined as the energy slope of the last segment before breaking , is found be of the order 1 ev /  @xmath216 nn . this agrees well with the experimental results which have shown the break force for atomic gold wires to be close to 1.5 nn.@xcite    in fig .",
    "[ fig : etotvslength](b ) we summarize the geometrical findings of the relaxation procedure by plotting the wire bond lengths and bond angles as a function of electrode separation @xmath4 .",
    "the figure shows that the short wires containing 3 or 4 atoms adopt a linear structure over a wide range of electrode separations .",
    "the longer wires , on the other hand , are generally found to have a zigzag geometry only approaching a linear form when they are stretched close to the breaking point.@xcite    from the plot of the bond lengths between nearest neighbors in the wire one notices that the 4 and 6 atom wires have a more pronounced tendency to dimerize than the wires with an odd number ( due to left / right symmetry of the structures only wires with an even number of atoms should be able to dimerize ) . in three test calculations with a @xmath217 @xmath214-point sampling of the three dimensional brillouin zone",
    "we generally achieve very similar atomic arrangements as compared to the @xmath212-point only . however , these calculations , which are indicated with black crosses in fig .",
    "[ fig : etotvslength](b ) , seem to reduce the dimerization tendency somewhat .",
    "we calculate the vibrational frequencies and modes as described in sec .",
    "[ sec : vibmodes ] . with @xmath218",
    "vibrating atoms we thus find @xmath150 modes for a given structure .",
    "the phonon spectrum for the wire is plotted in fig .",
    "[ fig : etotvslength](c ) , where negative values indicate modes with imaginary frequency implying the breaking of an unstable wire .",
    "the general trend is that the phonon energies diminish as the wires are elongated .",
    "this can be understood by considering that the effective `` springs '' between ions in the wires are softened as the bonds are stretched , which in turn result in lower energies .    in the results to follow",
    "we generally take the wire and pyramidal base atoms as the dynamic region ( as indicated in fig .",
    "[ fig : generictransportsetup ] ) , i.e.  these atoms are allowed to vibrate . for the 3- to 7-atom wires this leave us with 33 to 45 vibrational modes .",
    "the corresponding e - ph couplings are calculated in a slightly larger device region containing also the outermost surface layer .",
    "this inclusion of an extra layer is necessary to represent the vibrational modulation of the hopping between the pyramidal base atoms and the first surface layers .",
    "  is coupled to semi - infinite electrodes . as indicated on the figure the vibrational region",
    "is taken to include the atoms in the pyramidal bases and the wire itself , whereas the device region ( describing the e - ph couplings ) includes also the outermost surface layers . ]    in order to determine the transport properties of the wire geometries described above , we construct from the supercells shown in fig .",
    "[ fig : structures ] new wire geometries which are coupled to semi - infinite electrodes as schematically illustrated in fig .",
    "[ fig : twogenericunitcells](b ) .",
    "the resulting setup is shown in fig .",
    "[ fig : generictransportsetup ] for the case of a 7-atom long gold wire . as",
    "indicated on this figure we consider the device subspace to include the top - most surface layer , the pyramidal bases , and the wire itself .    the elastic transmission evaluated at the fermi energy @xmath167",
    "is calculated using transiesta described in ref .  .",
    "the results are shown in fig .  [",
    "fig : etotvslength](d ) both for the @xmath212-point ( open symbols ) as well as with a @xmath213 @xmath214-point sampling of the two - dimensional brillouin zone perpendicular to the transport direction ( black stars ) . in correspondence with previous work ,",
    "e.g. ,  refs .  , we find that the total transmission is close to unity , except for the very stretched configurations where the transmission goes down somewhat . from fig .",
    "[ fig : etotvslength](d ) one observes a reasonable agreement between the @xmath212-point and the @xmath214-point sampled transmissions , particularly when the transmission is close to one .",
    "worst are the discrepancies for the 4 and 6 atom wires , which also are the cases where the transmission deviates most from unity .",
    "we subscribe these signatures to the so - called odd - even behavior in the conductance of metallic atomic wires , in which perfect transmission is expected only for an odd number of atoms in a chain . for an even number of atoms",
    "the conductance should be lower.@xcite further , the observed dimerization is also expected to reduce the conductance ( the peierls instability for infinite metallic wires results in the opening of a band gap at the fermi energy ) .",
    "we also note that on an energy scale of the typical phonon energies the transmission function is to a very good approximation a constant around the fermi energy .",
    "having determined the vibrational frequencies , the e - ph couplings , and the elastic transmission properties , we are in position to calculate the inelastic current as described in sec .  [ sec : calculationofcurrent ] .",
    "k in a reduced device region for the 7-atom wire shown in fig .",
    "[ fig : generictransportsetup ] .",
    "the small variation in elastic conductance with bias ( dotted curve ) relates to a weak energy dependence of the elastic transmission function at the @xmath212-point around @xmath167 .",
    "the full scba calculation ( circles ) follows this trend and shows on top of it symmetric drops characteristic for phonon scattering .",
    "the loe calculation ( line ) does not include the elastic variation but gives basically the same predictions for the inelastic signals as the scba with the elastic background signal subtracted ( dashed curve ) .",
    "this illustrates the agreement between the loe and scba approaches for the inelastic contribution . ]",
    "we start out by showing that the loe and scba approaches essentially predict the same inelastic signals for atomic gold wires , thereby reducing the computational expense in the detailed analysis to follow . for this purpose",
    "only we consider a computationally reduced problem where the device and dynamic atoms regions are minimized as compared with those generally adopted in this section",
    ". we will thus simply allow the wire atoms to vibrate and take the device space as the wire plus pyramidal bases only .",
    "compared with the electronic structure and phonon energies the thermal energy typically sets the smallest energy scale for variations in the green s functions etc . instead of using the experimentally relevant temperature of @xmath219 k ( or even less ) we further simplify the calculations by taking @xmath220 k for the moment since this requires fewer points on the energy grid , cf .",
    "[ sec : scbaappendix ] .",
    "the differential conductances as resulting from evaluating eq .",
    "( [ eq : meirwingreencurrent ] ) with and without scba phonon self - energies as well as evaluating the loe expression eq .",
    "( [ eq : current1 ] ) are shown in fig .",
    "[ fig : scbavsloeforauwires ] .",
    "the dotted curve is the purely elastic result ( no phonon self - energy ) and the circles the full scba ( including all vibrational modes in the externally damped limit @xmath221 of sec .",
    "[ sec : dampingregimes ] ) .",
    "the red line corresponds to the loe .",
    "the elastic conductance displays a slight variation with bias that relates to the weak energy dependence in the zero - bias transmission function at the @xmath212-point .",
    "the full scba calculation clearly shows two symmetric conductance drops which are due to inelastic scattering against vibrations ( we will return later to a discussion of the physics ) . the loe calculation does not include the elastic variation but gives basically the same predictions for the inelastic signals",
    "this is clear from a comparison with the scba where the elastic background signal has been subtracted ( dashed curve ) .",
    "based on a number of such tests , and the fact that the e - ph couplings are weak ( or more precisely , that the inelastic signal is a small change in conductance of the order 1 - 2 % ) , we conclude that the approximations leading to the loe expressions are valid in the case of atomic gold wires . to appreciate this fact",
    ", we note that the scba curves in fig .",
    "[ fig : scbavsloeforauwires ] required approximately 40 cpu - hours in a parallel job running on 4 processors whereas the loe results only required a few seconds on one processor .",
    "the loe approach is thus justified for a full analysis of the 3- to 7-atom gold wires .",
    "figure  [ fig : loecalculationsforau ] shows the calculated differential conductance of the 3- to 7-atom wires under different electrode separations @xmath4 and in the externally damped limit .",
    "the device region and dynamic atoms are here as indicated in fig .",
    "[ fig : generictransportsetup ] , and the temperature of the leads is @xmath219 k. the curves display symmetric drops at voltages corresponding to particular phonon energies . the dominant inelastic signal moves towards lower energies and increase in magnitude as the wires are elongated .",
    "furthermore , sometimes also a secondary feature is found below 5 mev , e.g. , figs .",
    "[ fig : scbavsloeforauwires ] and [ fig : loecalculationsforau ] .",
    "these observations are also characteristic for the experiments,@xcite and in agreement with previous calculations.@xcite    to extract the general trends on how the inelastic signal depends on details in the atomic arrangement we present in fig .",
    "[ fig : inelasticsignalsvsl ] our calculated data in different forms . in these plots",
    "we represent each phonon mode by a dot with an area proportional to the corresponding conductance drop .",
    "the abscissa corresponds to the electrode separation whereas the ordinate is used to highlight certain properties of the vibrational modes . in this way ,",
    "[ fig : inelasticsignalsvsl](a ) illustrates the mode frequency change with electrode separation . from a linear fit to the strongest signals we predict a frequency shift of @xmath222 mev /  for the 5-atom wire falling off to @xmath223 mev /  for the 7-atom long wire .",
    "further , to understand the nature of the modes that influence the electronic transport we can try to quantify some important characteristics . as it has previously been shown , longitudinal modes with an alternating bond length ( abl ) character are expected to be the dominating ones.@xcite to measure the longitudinal part of a given vibrational mode @xmath102 we define a sum over @xmath224-components @xmath225 where @xmath17 runs over all dynamic atoms ( the upper bound is due to the eigenmodes normalization @xmath226 ) .",
    "this quantity is shown in fig .",
    "[ fig : inelasticsignalsvsl](b ) .",
    "the plot clearly expresses that the modes with the largest signals ( large dot area ) also have a strong longitudinal component .",
    "further , to show that these modes also have abl character , we also define a sum @xmath227 where @xmath17 and @xmath228 are nearest neighbor atoms in the chain .",
    "this second quantity is shown in fig .",
    "[ fig : inelasticsignalsvsl](c ) , from which we learn that the important modes also have the largest abl measure ( the absolute scale is irrelevant ) .",
    "another important aspect is whether the modes are really localized in the wire or not .",
    "remember that our approach assumes that atoms outside the dynamic region are fixed .",
    "therefore , if we have eigenvectors with significant amplitude near the boundary of the dynamic region , this assumption does not seem to be valid ( most likely the eigenvector is not a true eigenvector of the real system ) .",
    "in other words , we want to make sure that the modes which are responsible for the inelastic scattering are sufficiently localized `` deep '' inside the dynamic region . to show this we calculate @xmath229 where @xmath17 runs over the 3 to 7 wire atoms .",
    "this quantity is represented in fig .",
    "[ fig : inelasticsignalsvsl](d ) and confirms that indeed the important modes are localized in the chain ; particularly for the 5- , 6- , and 7-atom wires the localization is almost perfect .    in conclusion , from the results presented in fig .",
    "[ fig : inelasticsignalsvsl ] , we learn that the inelastic signal in the conductance is effectively described by a simple selection rule in which longitudinal vibrational modes with abl mode character  localized in the wire  are the main cause of the inelastic scattering .",
    "we are further able to quantify the frequency down - shift and signal increase with strain",
    ".       corresponds to the important abl - mode for a 7-atom wire ( @xmath230 ) . by fitting the calculated points with a lorentzian we extract a full - width half max ( fwhm ) broadening of @xmath231ev and a frequency shift of @xmath232ev .",
    "the inset shows the calculated total density of states for bulk au ( full line ) , as well as a decomposition in the direction of the transport ( dashed red curve ) and in the transverse direction ( dotted blue curve ) . ]    from fig .",
    "[ fig : inelasticsignalsvsl](d ) we get a hint about the damping of the modes from the coupling to bulk phonons .",
    "if a mode is localized `` deep '' inside the dynamic region this coupling is negligible and the mode is expected to have a long life - time , i.e. , to be weakly damped by the coupling to the bulk . as discussed in sec .",
    "[ sec : introphonondosprojection ] we can estimate this damping from the width of the phonon density of states projected onto the mode vector .    as an illustration of this approach , we calculate the damping of the dominating abl mode according to eq .",
    "( [ eq : lorentzbroadening ] ) in the case of the 7-atom wire with electrode separation @xmath230  .",
    "this mode , shown in fig .",
    "[ fig : s29.20-ablmode](a ) , has a localization quantity ( as defined above ) of value 0.987 , i.e. , it is 98.7% localized in the wire .",
    "we begin by determining the dynamic matrix of the whole wire supercell [ fig .",
    "[ fig : structures](e ) ] as described in sec .",
    "[ sec : vibmodes ] . to describe the bulk properties of gold we pick the intra - layer and inter - layer elements ( inside the slab ) in the dynamic matrix along the transport direction , and use recursive techniques to calculate bulk and surface phonon green s functions .",
    "because of periodicity in the transverse plane  which gives rise to artificial sharp resonances in the spectrum  we broaden the phonon green s functions by taking @xmath233 mev .",
    "this approach leads to the total phonon density of states ( full black line ) shown in the inset of fig .",
    "[ fig : s29.20-ablmode ] .",
    "this shape compares reasonably well with other calculations and experiments.@xcite the inset also shows the phonon density of states decomposed in the direction of the transport ( dashed red curve ) as well as in the transverse directions ( dotted blue curve ) ; the observed isotropy that is expected for bulk is actually quite satisfactory . finally , we calculate the projected phonon density of states @xmath234 for the abl mode of interest according to eq .",
    "( [ eq : lorentzbroadening ] ) .",
    "this projection on a discrete energy grid is shown in fig .",
    "[ fig : s29.20-ablmode ] ( open circles ) . by fitting a lorentzian to the calculated data points we obtain a fwhm of @xmath235ev and a shift in frequency by @xmath236ev . based on these calculations",
    "we thus estimate the phonon damping to be of the order @xmath237ev .",
    "in fact , this is rather a lower bound , since we have not included anharmonic contributions etc.@xcite however , compared with the phonon energy we see that indeed @xmath238 , and thus that the use of free phonon green s functions in the scba self - energy eq .",
    "( [ eq : sigmalessgreat ] ) is justified .",
    "let us next investigate the implications of a finite phonon lifetime on the local heating .",
    "this is done by solving the rate equation eq .",
    "( [ eq : rateequation ] ) for the mode occupation at a fixed bias voltage . for instance , the inelastic conductance characteristics ( including heating ) for our 7-atom wire are shown in fig .",
    "[ fig : theoryvsexperiment ] for different values of the phonon damping @xmath239 ( smooth colored lines ) . as seen in the figure , and as we have shown previously,@xcite the effect of the heating is to introduce a slope in the conductance beyond the phonon threshold voltage .",
    "this is because the nonequilibrium mode occupation increases the number of scattering events of the traversing electrons .",
    "consequently the conductance goes down as the bias ( and hence the occupation level ) increases .",
    "the smaller the damping , the more the mode occupation is driven out of equilibrium , i.e. , to a larger average excitation level . in the extreme case of no damping @xmath240 ( dotted curve ) [ the externally undamped limit in ref .  ] , the local heating is maximal .",
    "on the other hand , a sufficiently large damping may effectively prevent phonon heating [ the externally damped limit in ref .  ] . from fig .",
    "[ fig : theoryvsexperiment ] we see that with a phonon damping as large as 200 @xmath241ev/@xmath242 the slope has vanished .",
    "figure  [ fig : theoryvsexperiment ] also compares our theoretical results to the original experimental measurements by agrat @xcite ( noisy curves ) .",
    "the four experimental characteristics ( aligned with the calculated zero - bias conductance ) corresponds to a presumably 7-atom long gold wire under different states of strain recorded at low temperatures @xmath219 k. from this plot it is clear that theory and experiment are in excellent agreement with respect to the position of the phonon signal and the magnitude of the dominant drop .",
    "one also notices the indication of a secondary phonon feature below 5 mev in all curves .",
    "but what is particularly interesting is that the measured conductance slopes beyond the threshold seem to agree well with a phonon damping of the order 5 - 50 @xmath241ev , which is further quite reasonable according to our estimate above .",
    "the only feature which is not perfectly reproduced is the experimental width of phonon signal lineshape  as seen from the derivative of the conductance @xmath243 in the lower part of the figure  which is somewhat wider than the calculated ones ( which for comparison also includes the instrumental lock - in broadening corresponding @xmath244 mev ) .",
    " using different values for the external damping as indicated in the upper right corner of the plot ( in units of @xmath245ev@xmath246 ) .",
    "the dashed curve is the calculated result in the externally undamped limit ( @xmath247 ) .",
    "the lower plot is the numerical derivative of the conductance , where the experimental curves have been offset by multiples of g@xmath204/v for clarity .",
    "note the indication of a secondary phonon feature below 5 mev in all curves .",
    "the temperature is @xmath219 k and the lock - in modulation voltage @xmath244 mev ( in both theory and experiment ) . ]",
    "the general method described in sec .",
    "[ sec : electronicstructuremethods ] and [ sec : transport ] is applicable to many other systems than atomic gold wires .",
    "examples of systems where it is interesting to apply this method include wires and contacts of other metals as well as individual molecules .",
    "in fact , we have already used the present method to study conjugated and saturated hydrocarbon molecules in between gold surfaces , see ref .  .",
    "the purpose of this section is to illustrate that our method is general enough to apply to many systems ; especially that the loe approximation is likely to be valid for a range of systems where , at first glance , it is not expected to work .",
    "we start with a brief description of our previous results@xcite motivated by the recent experiments by kushmerick @xcite they measured the inelastic scattering signal through three different molecules ( c11 , opv , and ope ) connected to gold electrodes by means of a cryogenic crossed - wire tunnel junction setup .",
    "since the number of molecules present in the experimentally realized junctions is unknown it is advantageous to look at the inelastic electron tunneling spectroscopy ( iets ) signal defined as @xmath248 which  if the current @xmath17 simply scales with the number of molecules  is independent of the number of molecules in the junction .            in ref .",
    ", we used the present loe method to model the iets spectra for each of these three molecules .",
    "as an example , fig .",
    "[ fig : ope - loe ] shows the calculated and measured iets spectrum in the case of the conjugated ope molecule [ inset of fig .",
    "[ fig : ope - opv](b ) ] .",
    "it is seen that our theory reproduces the positions and relative heights of the inelastic scattering peaks .",
    "the three main peaks are given by four types of vibrations ; one type is affecting the c  s stretch whereas the other three involve the distortion of the c backbone of the molecule . in our calculation the region of dynamic atoms includes 54 atoms corresponding to 162 vibrational modes ( 18 au surface atoms and 36 atoms in the molecule ) .",
    "we thus see that the iets spectrum must be related to certain selection rules that describe why only a few vibrational modes affect the current .",
    "these selection rules may be understood from studying the electron scattering states and the symmetry of the e - ph interaction.@xcite for the other two molecules ( opv and c11 ) we found a similar good agreement with the experiments by kushmerick however , the transmission @xmath249 through these three molecules is actually varying significantly with energy , since the electron conduction process involves states around the fermi energy that lie in the gap between the molecular levels .",
    "for instance , in an energy window of 0.4 ev this variation is of the order @xmath250 for the ope molecule . accordingly",
    "the use of the loe approximation might seem inappropriate for these systems . with a detailed comparison between loe and full scba calculations ( including this energy dependence ) we can nevertheless show that the loe approximation provides effectively the same prediction for the iets spectrum .",
    "this comparison is found in fig .",
    "[ fig : ope - opv ] .",
    "since the scba is computationally expensive it is not realistic to use the same high accuracy as for loe calculations .",
    "we therefore reduce the device subspace and the region of dynamic atoms to include only the molecule .",
    "furthermore we use a smaller szp basis set describing the ope ( opv ) molecule reducing the device subspace to 264 ( 280 ) atomic orbitals . finally we include only the 5 ( 3 ) most important vibrational modes ( selected from a loe calculation ) . with these simplifications we calculated the current for 81 ( 61 ) bias points using an average of 9 ( 8) iterations to converge the scba on an energy grid of approximately 500 points .",
    "these scba calculations required 40 ( 18 ) hours on 10 pentium-4 processors working in parallel . for comparison , the corresponding loe calculations can be performed in less than 1 minute on a single pentium-4 processor .",
    "the results shown in fig .  [ fig : ope - opv ] reveal that the loe approximation captures the inelastic scattering signal with a very satisfactory accuracy .",
    "the main discrepancy between loe and scba is directly related to the elastic part of the transport which can easily be corrected for without solving the full scba equations , cf .",
    "[ sec : inelastictransmission ] .",
    "we have thus used our implementation of scba to justify that the simpler loe scheme can actually be applied for the iets spectra of the hydrocarbon molecules .",
    "this is not a trivial result because the energy variation in the transmission around the fermi energy for these systems seems to violate one of the fundamental assumptions of the loe .",
    "in this paper we have presented a first - principles method for calculating the effects of vibrations and e - ph couplings in the electronic transport properties of an atomic - scale device .",
    "our implementation that extends the siesta implementation of kohn - sham dft and the transiesta scheme for elastic transport is described in detail , highlighting the important computational steps for the complete analysis .",
    "the inelastic transport problem is addressed using the negf formalism with the e - ph interaction treated up to the level of scba .",
    "we also describe the computationally simple loe scheme . as illustrations of the methodology",
    "we have applied it to model the phonon signals in the conductance of atomic gold wires and hydrocarbon molecules between gold surfaces . in both cases",
    "the comparison with experimental results is very satisfactory . while we expect our method to be successful for a wide range of nanoscale systems , there are also some important aspects where further research and development may lead to improvements .",
    "we therefore close this paper with an outlook of some of the challenges we believe are important .",
    "while we have argued that the vibrations for the systems considered here are reasonably well described by free phonon green s functions , there might also be situations where the phonon system has to be treated beyond free dynamics , e.g. , by including self - energies from e - h pair damping , anharmonic phonon - phonon couplings ( inside the device ) , and resonant phonon - phonon couplings ( between device and electrodes ) . and",
    "as we have shown in this work , these precise damping conditions of the phonons are governing the device heating .",
    "another issue is the bias - induced changes in geometry and e - ph couplings .",
    "further development along these lines might thus lead to a better understanding of transport in the high - bias regime . on the more technical side , it would be interesting to extend the present scheme to describe the interplay between e - ph couplings and other delicate effects such as spin - polarized currents , spin - orbit couplings , etc .",
    "for instance , phonon heating could mediate an important effective interaction between the two spin channels .    in conclusion",
    ", the present paper contributes to the evolving understanding of phonon scattering and local heating in nanoscale systems .",
    "these effects are important to elucidate the structural properties from the electronic transport characteristics and ultimately for the stability of devices .",
    "during the development of our scheme many people contributed directly or indirectly to our work . in particular , we are grateful to n.  lorente for many invaluable discussions , and thank j.  c.  cuevas , h.  ness and t.  todorov for useful comments .",
    "the authors are thankful to n.  agrat , d.  djukic , and j.  m.  van ruitenbeek for many stimulating discussions on their respective experiments of phonon scattering in atomic - scale contacts .",
    "m.p .  would like to thank s.  datta for his insight into heating aspects in quantum transport .",
    "thanks t.  novotn for guidance in our early numerical implementation of the hilbert transform .",
    "this work , as a part of the european science foundation eurocores programme sasmec , was partially supported by funds from the snf and the ec 6th framework programme .",
    "computational resources were provided by the danish center for scientific computing ( dcsc ) .",
    "the purpose of this appendix is to discuss efficient numerical ways to approximate the hilbert transform of a continuous function @xmath251 , here defined as @xmath252 where @xmath253 denotes the cauchy principal value integral .",
    "we approximate the function @xmath251 by a linear interpolation @xmath254 to the values @xmath255 known at the discrete grid points @xmath256 .",
    "this we can write in the following way @xmath257 where the kernel function associated with the linear interpolation is @xmath258\\nonumber\\\\ & & + \\frac{x_{i+1}-x}{x_{i+1}-x_{i}}[\\theta(x_{i+1}-x)-\\theta(x_{i}-x)].\\qquad\\end{aligned}\\ ] ] on this form",
    "we implicitly assume that the function falls off to zero at the ends of the grid , i.e. , that the function has finite support .",
    "we can then approximate the hilbert transform of @xmath251 by the hilbert transform of @xmath254 , i.e. , @xmath259 where we have identified a transformation kernel @xmath260.\\end{aligned}\\ ] ] having determined the matrix @xmath261 corresponding to a given grid @xmath256 , the hilbert transform amounts to a matrix - vector product operation . with @xmath218 grid",
    "points this scales as @xmath262 .",
    "a typical situation is that of an equidistant grid @xmath263 ( for all @xmath264 ) , where a more effective algorithm can be devised . in this case",
    "we can write @xmath265 , and the kernel function , that becomes a function of the index difference @xmath266 only , reduces to @xmath267.\\end{aligned}\\ ] ] the hilbert transform @xmath268 has then taken the form of a discrete convolution which effectively can be calculated with the fast fourier transform ( fft ) algorithm .",
    "this scales only as @xmath269 .",
    "calculating the current numerically using the scba is highly nontrivial for large systems .",
    "this appendix discusses our solutions to the main difficulties encountered within the scba .",
    "we exemplify the size and scope of the calculations , e.g. , the sizes of matrices and the energy grid , with values taken from the scba calculation presented in sec .",
    "[ sec : hydrocarbonmolecules ] on the ope molecule .",
    "the current and power expressions eq .  ( [ eq : meirwingreencurrent ] ) and ( [ eq : power ] ) are integrated numerically using a third order polynomial interpolation . since the inelastic signal is typically small , the current has to be determined with a high accuracy , which implies a fine resolution of the energy grid for the integration .",
    "further , the range of this grid has to include not only the bias window but also additional energies due to the nonlocal character ( in energy ) of the hilbert transform , cf .",
    "( [ eq : sigmaret ] ) .",
    "these limitations make a nonuniform grid preferable .",
    "we thus construct a dense grid around each of the important energies @xmath270 and a coarser one elsewhere .",
    "the resolution of the fine grid is determined by the temperature and should have a point separation around @xmath271 . for the ope molecule we found it adequate at @xmath272 k to use a fine grid with @xmath273 mev and a coarse grid with @xmath274 mev spanning the energy range @xmath275 $ ] ev . with a nonuniform grid the necessary number of energy points",
    "may thus be reduced .",
    "the solution of the scba approximation requires substantial amounts of cpu time and memory . analyzing the memory requirements we find that we need to retain @xmath276 and @xmath277 in memory .",
    "each of these matrices requires a memory allocation of @xmath278 bytes , where @xmath279 is the number of grid points , and @xmath280 the size of the electronic basis . for the ope calculation in sec .",
    "[ sec : hydrocarbonmolecules ] each matrix takes up 500 megabytes of memory ( 500 energy points @xmath281 @xmath282 matrix size @xmath281 16 bytes / complex number ) .",
    "in addition to the demanding memory requirement , significant computational time ( 400 cpu hours in total ) is needed .",
    "the computationally heaviest part is the calculation of eq .",
    "( [ eq : sigmalessgreat ] ) , which we rewrite as @xmath283 \\mathbf{m}_\\lambda.\\nonumber\\end{aligned}\\ ] ] from this equation we see that the cpu time scales as @xmath284 [ since each matrix multiplication scales as @xmath285 , where @xmath286 is the number of vibrational modes and @xmath287 the number of iterations needed for self - consistency of the scba .",
    "we have overcome the memory and computational requirements by a parallelization of our computer code by dividing the energy grid over the available processors .",
    "the only significant complication is the evaluation of eq .",
    "( [ eq.mpnphsig ] ) , where quantities couple across the energy division . to overcome this",
    ", we first redistribute the green s functions @xmath288 over the processors by changing from energy division to matrix indices division",
    ". then the energy - shifted green s functions can be added for each matrix index .",
    "next we transform the outcome back to energy division and carry out the matrix multiplications with @xmath289 .",
    "we have implemented this procedure efficiently in a way that lets the necessary communication occur while other calculations are running , i.e. , while the lesser part of the equation is being communicated between processors , the matrix multiplications for the greater part are being computed and vice versa . in practice , this parallelization works very well and the computation time scales almost linearly with the number of processors .",
    "as discussed in sec .  [ sec : broadening - mechanisms ] the lock - in technique for measuring the differential conductance ( and derivatives ) introduces a broadening of the intrinsic current - voltage characteristics due to a finite modulation voltage .",
    "the basic idea is to measure the frequency components of the current at multiples of the applied harmonic modulation , since these relates to the derivatives of the current .",
    "following hansma,@xcite we can analytically write the frequency components as the following averages over an oscillation period @xmath290 \\cos(\\omega t ) \\ , { d}t    \\nonumber        \\\\ & = & \\frac{2}{\\pi } \\int\\limits_{-1}^{1 }       \\frac{{{d}}i\\left(v+a x \\right)}{{{d}}v } \\ , \\sqrt{1-x^2 }    \\ , { { d}}x , \\label{eq.dilockin}\\end{aligned}\\ ] ] and @xmath291 \\cos(2 \\omega t ) \\ , { { d}}t    \\nonumber        \\\\ & = & \\frac{8}{3 \\pi } \\int\\limits_{-1}^{1 }       \\frac{{{d}}^2i \\left(v+a x \\right)}{{{d}}v^2 } \\ , \\left(1-x^2\\right)^{3/2 }    \\ , { { d}}x,\\end{aligned}\\ ] ] where the modulation amplitude is @xmath292 .",
    "the partial integrations carried out above show that the components @xmath293 and @xmath294 are convolutions of the exact first and second derivatives of the current with certain functions proportional to @xmath295 and @xmath296 , respectively .",
    "if we assume that the inelastic signal has no intrinsic width , the inelastic conductance change is proportional to a step function @xmath297 and the second derivative to a delta function @xmath298 . with these functional forms",
    "the integrals can be evaluated , leading to a modulation broadening of the first ( second ) derivative of approximately 2.45 @xmath299 ( 1.72 @xmath300 ."
  ],
  "abstract_text": [
    "<S> we describe a first - principles method for calculating electronic structure , vibrational modes and frequencies , electron - phonon couplings , and inelastic electron transport properties of an atomic - scale device bridging two metallic contacts under nonequilibrium conditions . </S>",
    "<S> the method extends the density - functional codes siesta and transiesta that use atomic basis sets . </S>",
    "<S> the inelastic conductance characteristics are calculated using the nonequilibrium green s function formalism , and the electron - phonon interaction is addressed with perturbation theory up to the level of the self - consistent born approximation . while these calculations often are computationally demanding , we show how they can be approximated by a simple and efficient lowest order expansion . </S>",
    "<S> our method also addresses effects of energy dissipation and local heating of the junction via detailed calculations of the power flow . </S>",
    "<S> we demonstrate the developed procedures by considering inelastic transport through atomic gold wires of various lengths , thereby extending the results presented in [ frederiksen  phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 93 * , 256601 ( 2004 ) ] . to illustrate that the method applies more generally to molecular devices </S>",
    "<S> , we also calculate the inelastic current through different hydrocarbon molecules between gold electrodes . </S>",
    "<S> both for the wires and the molecules our theory is in quantitative agreement with experiments , and characterizes the system - specific mode selectivity and local heating . </S>"
  ]
}