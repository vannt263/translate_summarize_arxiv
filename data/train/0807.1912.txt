{
  "article_text": [
    "the murchison widefield array ( mwa ) is an 80 - 300 mhz synthesis array that is being built in western australia , with construction to be completed in 2010 .",
    "the shire of murchison has a quiet radio environment , making it an excellent site for this and other radio facilities @xcite .",
    "each of the 512 antennas will be a @xmath0 tile of dipoles .",
    "an analogue beamformer at each antenna combines the signals from the 16 dipoles , producing an electronically steerable primary beam with a width of approximately 25@xmath1 at 150 mhz .",
    "when the signals from all antennas are combined , the array will have a synthesized beam with a width of approximately 4.5@xmath2 at 150 mhz .",
    "the main science goals of the mwa are the detection of redshifted 21 cm emission from the epoch of reionization ( eor ) @xcite , transient detection ( for example @xcite ) , and remote heliospheric sensing @xcite .",
    "a schematic of two mwa antenna tiles is shown in fig . [",
    "plot : schematic ] .    to make a map of the sky using radio interferometry , one typically builds up an estimate of the 2d fourier transform of the sky",
    ", then applies a fourier transform to obtain the image .",
    "this is known as synthesis imaging , and a good overview of the subject is given in @xcite .",
    "the measured data that are used to build up the fourier interference pattern are spatial cross - correlations  or visibilities  that are obtained by correlating voltage streams collected by many pairs of antennas .",
    "the visibilities lie in the uvw coordinate frame , where @xmath3 is the component of the antenna separation vector ( or _ baseline _ vector ) in the direction of the field center ( in units of wavelengths ) , and @xmath4 and @xmath5 are orthogonal coordinates in the plane normal to @xmath3 ( aligned with the corresponding image coordinate axes , @xmath6 and @xmath7 ) .",
    "this situation is not naturally a 2d fourier transform . for small images ,",
    "@xmath3 is multiplied by a term that is approximately zero and the 2d nature holds . for large fields",
    "this is not the case , but the problem can still be reduced to 2d transforms ( a good overview is given in @xcite ) .",
    "post processing typically involves calibrating the visibilities , gridding them onto the uv - plane to form a regularly sampled interference pattern , and then applying a 2d fft to form an image .",
    "techniques such as self - calibration can then be used in an attempt to improve the calibration by iterating back and forth between the visibilities and the image .    for a number of reasons ,",
    "mwa visibilities can not be processed in this way .",
    "many of these effects are common to all low frequency arrays , and are described in detail in @xcite and @xcite .",
    "each antenna has a different direction - dependent response over the field of view , which can not simply be divided out .",
    "these response patterns may also change significantly over the course of an observation .",
    "furthermore , the ionosphere causes direction - dependent phase shifts that effectively change the position and polarization state of sources during an observation .",
    "these effects mean that we can not make a fully calibrated interference pattern in the standard way .",
    "what we can do is use the measured visibilities to iteratively fit ionospheric phase shifts and antenna gains towards many bright catalogue sources , and store these fits to aid deconvolution and resampling processes after the images have been made .",
    "these measurements are the focus of this paper , but before they are discussed some of these challenges will be reviewed more closely .     grid of crossed dipoles ( _ vertical planar bowtie structures _ ) .",
    "the main response lobes are steered electronically by beam - formers ( _ bf _ ) to establish the instrument field of view .",
    "bf output signals are sampled at baseband and filtered digitally in receiver electronics ( _ rx _ ) and correlated to provide cross - power spectra .",
    "in addition to compact objects ( e.g. , quasars and pulsars ) , the mwa sky includes foreground emission from the galaxy , which is chiefly synchrotron emission that is linearly polarized and traces turbulent and ordered magnetic fields in the interstellar medium ( @xmath8 ) .",
    "magnetized plasma from solar coronal mass ejections or other activity move outward through the heliosphere .",
    "this medium and the earth ionosphere induce primarily refractive shifts in source positions ( higher order distortions in the observing passband are small due to the limited extent of the array ) and time - variable faraday rotation of polarization along different lines of sight .",
    "the calibration scheme described here enables polarization - sensitive imaging of the diffuse galactic and compact source populations and assembly of a sky model .",
    "knowledge of the compact background sources is `` confusion limited '' ( i.e. , constrained by multiplicity of sources within one instrument resolution element and contamination of each image pixel by sidelobes of distant sources ) .",
    "confusion increases with image sensitivity and the size of a resolution element ..",
    ",width=294 ]    unlike the radio sky at higher frequencies , which appears sparsely populated at the sensitivity levels of modern instruments , the sky to be observed by the mwa is full of sources .",
    "the high density of sources and large angular resolution of the array will result in images that are confusion limited , with significant flux coming from background galaxies in each synthesized beam , as well as from the sidelobes of other sources in the primary beam of each antenna .",
    "the sky is also quite complex .",
    "there is significant emission on many angular size scales , from compact extragalactic sources and pulsars to diffuse galactic synchrotron radiation @xcite .",
    "the latter experiences faraday rotation and depolarization in the ionized interstellar medium , and as a result exhibits a strong linearly polarized component that is highly dependent on position and frequency @xcite .",
    "this polarized all - sky signal is at least a few orders of magnitude brighter than the unpolarized eor signal , and a fully - polarized calibration formalism , such as the hamaker - bregman - sault measurement equation @xcite , is required to reduce contamination from the spatially structured , linearly polarized emission from the galaxy .",
    "if the raw interferometer data are stored for offline processing , iterative calibration and deconvolution algorithms can be used to address many of the problems described below ( see , for example , @xcite and @xcite ) .",
    "however , it is impractical to store the 19 gb s@xmath9 data stream coming from the mwa correlator , antennas lead to @xmath10 different cross - correlation measurements .",
    "they are made in a correlator for 4 different polarization products and up to 3072 different frequency channels every 0.5 seconds . each visibility",
    "is represented by 3 real bytes and 3 imaginary bytes , which leads to @xmath11 gb / s . ] and the mwa will store images .",
    "this means that much of the calibration must take place in real time , before or during the imaging process . at the heart of the calibration system for",
    "the mwa is the calibrator measurement loop ( cml ) , which measures apparent angular offsets induced by the ionosphere and the system gain toward known compact astronomical sources across the sky .",
    "these measurements are used to fit models of the ionosphere and instrument response , and support subtraction of strong sources that limits sidelobe contamination during calibration . as in @xcite and @xcite , measuring and subtracting the contribution of each source",
    "is carried out sequentially , so that the stronger sources are removed before measurements of weaker sources are made . in this paper",
    "we do not consider multivariate fits of parameters for all of the calibrator sources simultaneously , as described in @xcite , but we will discuss it briefly in section [ discussion ] .",
    "estimation of calibration parameters is greatly over constrained due to the large number of antenna pairs ( @xmath12 ) . on the other hand , the wide - field nature of the instrument and real - time computing requirement pose",
    "challenges , the most important of which are listed below .    1",
    ".   _ direction - dependent gain and polarization response_. each mwa receiving element is a @xmath0 array of fixed crossed dipoles ( fig .",
    "[ plot : schematic ] ) .",
    "the phased beams are steered with an analogue beamformer , which will typically be updated every 5 to 10 minutes to compensate for rotation of the earth .",
    "the common approach of assuming that the polarized receptors are orthogonal over the field of view with a small amount of direction - dependent leakage can not be used .",
    "the direction - dependent instrumental polarization of the antenna beams will be significant , and it will be measured along with the direction - dependent gain using many calibrator sources spread over the entire sky .",
    "these measurements will be repeated as the field of interest moves across the antenna beams .",
    "confusion_. since the mwa s",
    "primary beams cover such a large section of the sky , each field mapped by the mwa will contain hundreds of relatively bright sources . to calibrate the array , we require accurate flux density measurements of known sources .",
    "such measurements can be corrupted by faint sources within the synthesized beam of the array ( `` confusion '' ) as well as the sidelobes of brighter sources outside the synthesized beam ( `` sidelobe contamination '' ) .",
    "+ confusion and sidelobe contamination can arise from both compact and large - scale sources such as extragalactic radio galaxies and galactic synchrotron emission respectively .",
    "the galactic synchrotron , in particular , has a polarized component and structure on many spatial scales .",
    "since the interferometer baselines will respond to large - scale structure differently depending on their length and orientation , calibration of data that includes bright resolved sources such as the sun or galactic plane must be performed carefully .",
    "3 .   _ ionosphere_. the 3-dimensional ionosphere can significantly perturb the waves coming from celestial sources .",
    "the maximum antenna separation of the mwa is short enough that , for a given source and during normal ionospheric conditions , all of the antennas have approximately the same line of sight through the ionosphere .",
    "this assumption will be used throughout . under these conditions",
    "there will be no defocusing and the ionosphere can be described by a two - dimensional phase screen that makes sources appear to move away from their true positions .",
    "( faraday rotation of incident polarization is a second ramification , but this will be considered in a future paper .",
    "we limit consideration here to ionospheric calibration using unpolarized sources , which can not be used to calibrate polarization position angles @xcite , @xcite . )",
    "4 .   _ real - time data reduction_. the real - time nature of the mwa means that compute - intensive processes need to avoided where possible .",
    "unfortunately , this means that many of the promising techniques currently being investigated , such as iterative self - calibration and deconvolution algorithms @xcite , and some wide - field imaging algorithms @xcite , can not currently be implemented in real time .",
    "they either can not be used at all or need to be approximated .",
    "calibration occurs in a back - end known as the real - time system ( rts ) , which consists of a visibility integrator ( time and frequency ) , the cml , and an imaging pipeline .",
    "these tasks run sequentially , and as mentioned later the processing load is split over frequency .",
    "the imaging pipeline incorporates gridding , imaging ffts , correction for ionospheric and wide - field distortion of the sky , stokes conversion of images , and astronomical coordinate conversion .",
    "mwa primary science drivers require that the time and frequency resolution are sufficient to ensure that stationary signals from sources throughout the antenna field of view are coherent for the highest frequencies and longest antenna separations , where interference fringe phases vary most rapidly with time .",
    "most of the key elements of the real - time calibration system have been coded and are regularly tested with simulated data , as described in section [ examples ] . to date , the tests have focused on unpolarized cosmic signals , but the response of the instrument polarizes the signals during reception , and the processing employs the fully - polarized description discussed in the ensuing chapters . apart from tolerance testing  to determine optimal bandwidths , number of calibrators , etc .  and algorithm development for real - time operation , the main piece of outstanding work is the incorporation of polarized calibrators into the system to fully constrain primary beam models and the faraday rotation component of the ionosphere .    while the discussion and examples given below focus on the mwa , the techniques are applicable to other low - frequency array projects , such as the ska molonglo prototype ( skamp ) , the long wavelength array ( lwa ) , and the low frequency array ( lofar ) . that said ,",
    "the instantaneous synthesized beam of the mwa does make it particularly well suited to this type of processing .",
    "we will not go into specific details on how the techniques can be optimized , which at any rate will be different for the different arrays , and refer to papers such as @xcite for an overview of the power of large-@xmath13 radio arrays .",
    "after outlining the assumptions and mathematical model in the next section , the steps in the cml are discussed in more detail in section [ the calibrator measurement loop ] , followed by a discussion on algorithm convergence and performance .",
    "we then finish with an analysis of peeling simulated mwa data in section [ examples ] .",
    "in @xcite , hamaker presents a matrix version of self - calibration that leads to a straightforward procedure for estimating each antennas polarized response to a calibrator source . in this and the next section , the mathematical formalism described in @xcite",
    "is used to build up the planned implementation for the mwa . as in @xcite ,",
    "bold uppercase variables will represent matrices , bold lowercase variables will represent column vectors and a dagger ( @xmath14 ) will denote a hermitian transpose .",
    "the input to the cml is a new set of visibilities , measured every @xmath15 seconds and averaged into @xmath16 frequency channels of width @xmath17 hz . for the mwa , the data from the correlator are averaged over @xmath18 seconds and @xmath19 khz , with @xmath20 , and then sent straight to the cml .",
    "the cadence time is set to 8 seconds in order to oversample the time - varying ionosphere , which fluctuates on timescales shorter than a minute .",
    "suppose that the visibilities can be approximated by the superposition of @xmath21 unresolved calibrator sources that suffer negligible smearing over @xmath17 and @xmath15,% causes less than a percent of decorrelation on the longest baselines for sources at the edge of the map .",
    "the effect in the image is a broadening of those sources by less than 0.01% .",
    "the integration time causes a few 10s of percent of decorrelation on the longest baselines , and these will be processed at a faster cadence ( 2 seconds ) to reduce this decorrelation down to the percent level .",
    "one should note , however , that the majority of baselines are very short ( baseline density goes as the reciprocal of baseline length squared outside a densely - packed core ) , and most baselines suffer far less decorrelation . ] and some additive noise from various sources including thermal system noise , confusion from sources such as background radio galaxies , and sidelobes of extended emission and weak point sources . consider the contribution of one of these calibrator sources , @xmath22 , to the visibility measured by antennas @xmath23 and @xmath24 in the band centered at @xmath25 hz .",
    "let the column vector , @xmath26 , contain the response of the two orthogonal polarized components of receiving system @xmath23 ( in instrumental polarization coordinates ) .",
    "it is equal to the product of a @xmath27 jones matrix , @xmath28 , which contains the complex voltage gain of each polarized receptor to each polarized component of the calibrator signal ( including all instrumental effects ) , and the incident @xmath29 signal vector ( in sky polarization coordinates ) , @xmath30 .",
    "the incident radiation can be described by a @xmath27 covariance matrix , which contains the flux density of the four polarization products , @xmath31 , where angle brackets denote the expectation value . in the absence of any ionospheric effects , and",
    "if the jones matrices are constant over the time interval in which the expectation values are estimated , the visibility matrix measured by baseline @xmath32 is    @xmath33    define @xmath34 to be the expected position of source @xmath22 , and @xmath35 to be the apparent position of the refracted source , where @xmath36 is a small error in the position estimate and a prime will be used to indicate that a variable has been disturbed by the ionosphere .",
    "these position vectors can be expressed as phase shifts , @xmath37 , where @xmath38 is given by the dot product of the baseline vector and the calibrator position vector : @xmath39 .",
    "the model for the ionospherically disturbed visibility matrix of baseline @xmath32 is the superposition of the contributions from each of the strong sources ,    @xmath40    where @xmath41 contains the noise ( thermal and confusion ) in each polarization product .",
    "the negative sign in the exponent follows the convention adopted in @xcite , which is also the convention used by software packages such as fftw ( a negative exponent is used when transforming from a real plane to an complex plane ) .",
    "the general approach chosen for the cml is similar to the peeling approach suggested in @xcite and discussed in @xcite .",
    "we track a few hundred strong points sources , making continual measurements of antenna primary beams and the refractive effect of the ionosphere in each source direction . for this",
    ", we need a list of strong radio sources with known positions and fluxes , which we get from the existing catalogues of the southern sky , such as @xcite and @xcite .",
    "however , some bootstrapping will be required for the fluxes , since no catalogue covers the entire mwa frequency range .",
    "at least initially , we will only use unresolved point sources as calibrators , since each can be described by a single fourier component .",
    "the molonglo reference catalogue ( mrc ) contains 7347 sources with flux densities of or above 1 jy at 408 mhz in the declination range @xmath42 = -85@xmath1 to + 18.5@xmath1 @xcite . of these , about 90% show no clear evidence of departure from point sources for the mrc beam of @xmath43 .",
    "the calibrator that contributes the most power to the visibilities is selected , which will typically be much stronger than the superposition of the sidelobes from other sources .",
    "a model - dependent phase ramp is fit to the visibilities to estimate the ionospheric refraction in the source direction , and then least squares estimates of the direction dependent antenna gains are made .",
    "these estimates are used to create models of the contribution to the visibilities , which are subtracted .",
    "this process is then repeated for the rest of the strong calibrators .",
    "after this , one will typically make further ionospheric refraction and primary beam measurements without source subtraction .    the natural dimension over which to parallelize the processing is frequency .",
    "the imaging pipeline and much of the calibration system can be run independently for different frequency channels , and one can think of the mwa real - time computer as a system of essentially independent threads that each take a subset of the channels ( say 10 consecutive 40 khz channels ) to process with the cml ( each thread running on its own compute node ) .    to help isolate ionospheric refraction phase shifts from instrument phase shifts , the threads will be loosely coupled so that the whole 32 mhz band can be used for the ionospheric phase measurements . while the amount of data passed between threads is small , ) need to be generated in each compute node , each providing the information for a different observing frequency . for each source",
    ", a central node needs to gather a few 10s of bytes from each compute node and send two fitted coefficients back . ]",
    "the sources will need to be synchronized across threads .",
    "this is shown schematically in fig .",
    "[ plot : calibrationdataflowdiagram_fig3 ] .",
    "there is also the potential for pan - frequency averaging during the antenna gain measurements .",
    "+    let the number of consecutive frequency channels processed as a group be @xmath44 , so that each of the @xmath45 nodes hold a @xmath46 hz sub - band .",
    "the flow of the cml in this framework is as follows .    *",
    "_ ranking _ : initial antenna primary beam models are used with a catalogue to rank the calibrators by expected received power given the current location of the source and the pointing direction of the antenna .",
    "the catalogue will be generated during the commissioning of the array , and the sources will be regularly surveyed to check for time variability .",
    "the sequential nature of the peeling and the need for synchronization across the full 32 mhz band mean that the different beam shapes at different frequencies need to be taken into account when ranking sources",
    ". the ranking will be updated at a rate given by the motion of sources through the antenna beams , for instance when the antenna beams are updated . *",
    "_ initial source subtraction _ : an estimate of the calibrator summation in ( [ eqn : vis ] ) is made for each visibility and subtracted from it ( `` pre - peeling '' ) .",
    "the sum is over all of the calibrators to be peeled and the idea is to remove as much sidelobe power from the visibility set as possible .",
    "these estimates will usually be made from data measured @xmath15 seconds earlier , and provided that the ionosphere has not moved a source more than a synthesized beam in this time , most of the power will be removed .",
    "the strong source measurements will be less vulnerable to the subtraction errors of other sources , so they are made first and then peeled properly before the weak source measurements are made . * _ loop",
    "_ : each thread proceeds down the ranked calibrator list , at each step performing the following tasks .",
    "these tasks will be elaborated on in sections [ rotate visibilities and sum over frequency ] through [ source subtraction ] .",
    "rotate visibilities and sum over frequency _ : add back into the visibility set the contribution from the current calibrator that was subtracted during the initial source subtraction step . set the phase center of the visibilities to the estimated calibrator position and average across the @xmath44 frequency channels , as shown in section [ rotate visibilities and sum over frequency ] .",
    "for the mwa , some of the longer baselines will be stored with integration times shorter than @xmath15 .",
    "these will also be averaged together at this stage .",
    "the averaged visibilities are saved as a new visibility set with reduced thermal noise .",
    "averaging at this point also substantially reduces the number of computing operations performed by the cml .",
    "ionospheric refraction measurements _ : each node creates intermediate sums for the quantities described in section [ ionospheric refraction measurements ] .",
    "these sums are gathered from each of the nodes to constrain the pan - frequency ionospheric refraction measurement . for isoplanatic patch sizes of @xmath47 and image sizes of @xmath48 , we would need at least 50 or 60 sources in the field of view to describe the phase variation of each patch .",
    "optimally , we would like to oversample these variations by a factor of at least a few .",
    "after the fit , the parameters are broadcast back to the nodes and the phase center of each averaged visibility set is shifted to this new position .",
    "this is shown by green lines in fig .",
    "[ plot : calibrationdataflowdiagram_fig3 ] .",
    "_ instrumental gain measurements _ : each node then performs the least squares optimization for the polarized voltage gain of each antenna , as described in section [ instrumental gain measurements ] .",
    "if a higher signal - to - noise ratio is required , the data from each sub - band can be gathered together for a full - band fit .",
    "this is shown by red lines in fig .",
    "[ plot : calibrationdataflowdiagram_fig3 ] .",
    "4 .   _ source subtraction _ : if the gain and ionosphere measurements pass a set of goodness - of - fit tests , they are used to peel the source from the full resolution visibility set , thus correcting the initial source subtraction that was based on old data . otherwise the initial source subtraction is repeated . if there are more calibrators in the list , loop back to step 1 .      at the start of the loop for calibrator @xmath22 ,",
    "the visibilities have had all of the other calibrators peeled off  stronger ones modeled using the current data , weaker ones modeled using less recent data .",
    "we will use @xmath49 to designate the peeled visibility matrix for frequency channel @xmath50 .",
    "all of the matrices in the sub - band are rotated to be phase centered at the location of the calibrator and summed across frequency ,    @xmath51    where the superscript @xmath52 indicates an average over @xmath44 frequency channels , @xmath53 is the product of any undesirable baseline dependent multiplicative factors , such as bandpass shape and decorrelation , and @xmath54 is the central frequency .",
    "as before , the prime indicates that there is an apparent phase shift due to the ionosphere .",
    "the error term @xmath55 contains a rotated version of the noise , @xmath41 , and residual sidelobes due to errors in the calibrator source subtraction .",
    "the averaged and peeled visibilities given in ( [ eqn : rotated vis ] ) contain the four instrumental polarization products for calibrator @xmath22 , with some added noise .",
    "these are the data that will be used to fit an ionospheric phase ramp , as described in @xcite .",
    "since the visibilities are dominated by flux from a single direction , they can be converted to stokes parameters , and only the stokes i visibilities will be considered .",
    "flux densities of calibrator sources are expected to vary smoothly with frequency , and these variations will be catalogued . for the purposes of combining phase data from across the entire observing band , they are divided out so that @xmath56 can be replaced with @xmath57 .",
    "the instrument jones matrices will also vary with frequency , but they are expected to vary in time on scales of minutes , and are assumed to be constant on the ionospheric phase time scales of 10s of seconds . to deal with these variations , equations ( [ eqn : response ] ) and ( [ eqn : rotated vis ] ) show that an estimate , @xmath58 , of the sky visibility matrix for source @xmath22 , can be made using the visibilities calibrated with a recent gain solution    @xmath59    since",
    "the visibilities are phased towards the source , the sky @xmath6 and @xmath7 coordinates for it should be zero , and there should be no phase ramp .",
    "suppose though that , as indicated in ( [ eqn : rotated vis ] ) and ( [ eqn : calibrated response ] ) , the ionosphere adds a relative phase shift that appears to move the calibrator slightly in the @xmath6 and @xmath7 directions , and that the offsets are @xmath60 and @xmath61 respectively , where @xmath62 is the wavelength associated with frequency @xmath54 . equation ( [ eqn : calibrated response ] ) becomes    @xmath63    where @xmath64 and @xmath65 are components of the baseline vector introduced in section [ introduction ] , and the expansion only holds when @xmath66 .",
    "erickson found the root - mean - square displacement of sources observed with the clark lake tpt telescope at 74 mhz to be about 1@xmath2.1 , @xcite .",
    "erickson only considered relatively long - period fluctuations ( @xmath671 hr ) , and we anticipate the variations for 8-second periods to be much less than this , with root - mean - square displacements of several arcseconds or less . for arcminute deviations , the expansion in ( [ eqn : ionospheric approx ] ) breaks down on the long mwa baselines ,",
    "so only short baselines are used for the initial fits .",
    "we then track the short - period deviations .",
    "each visibility contains the sum of components from thousands of cosmic sources , with different strengths and random phases , and this sum , along with additive thermal noise from the receiving system , is expected to be very close to normally distributed .",
    "this does indeed appear to be the case for the simulated visibilities discussed section [ examples ] , with and without source peeling .",
    "if the noise is independent with variance @xmath68 , and @xmath69 and @xmath70 are the real and imaginary operators respectively , the least squares solutions for @xmath71 , @xmath72 and @xmath73 in ( [ eqn : ionospheric approx ] ) are    @xmath74    where    @xmath75    the sums on the right - hand side of ( [ eqn : bob s solution ] ) can be partially generated in each compute node , and then @xmath76 and @xmath77 generated after the partial sums have been gathered together .      if a sufficiently reliable ionospheric refraction measurement has been made , then the phase center of the averaged visibility set",
    "can be moved to the new position , and ( [ eqn : rotated vis ] ) can be corrected :    @xmath78    to estimate the gain of an antenna towards calibrator @xmath22 , a similar approach to those described in @xcite and @xcite will be taken , where one uses all of the visibilities that were measured with an antenna to constrain a simple model of its gain . however",
    ", a matrix form from @xcite will be followed here .",
    "this is a matrix least - squares problem in which one searches for the matrices @xmath79 that minimize    @xmath80    where @xmath81 is the number of antenna tiles , @xmath82 is the squared frobenius norm of a matrix @xmath83 , equal to the trace of @xmath84 , and @xmath85 is a model of the measured visibility matrix for source @xmath22 . in early investigations solutions to ( [ eqn : voltage amplitude model 1 ] )",
    "were unstable when there were significant sidelobes from other sources , and rearranging ( [ eqn : voltage amplitude model 1 ] ) had more robust solutions :    @xmath86    for each antenna ( [ eqn : voltage amplitude model 2 ] ) has the analytic solution    @xmath87    equation ( [ eqn : jones matrix solution ] ) can be used to estimate a new set of jones matrices for each calibrator ( or to update matrices that are restricted to moving more slowly ) .",
    "once the matrices have converged they can be left to track slow changes in the gain for each calibrator .",
    "finally , it is worth pointing out that often , much of the information in the jones matrices is known .",
    "for example , the transformation from the sky polarization coordinates to instrumental polarization coordinates may be known to high precision . if this is the case , it is straightforward to modify ( [ eqn : voltage amplitude model 2 ] ) so that the other matrices absorb the known information , leaving only the unknown quantities for the fit",
    ".      the dynamic range of power levels expected from the hundred or so strongest calibrators will be many orders of magnitude .",
    "this is the driving factor behind the sequential approach discussed above ; stronger sources are subtracted before measurements are made for the weaker sources .",
    "a preliminary investigation along the lines of @xcite indicates that the deepest we will be able to peel or clean is to a sidelobe noise floor of several hundred mjy . at this point",
    ", all remaining point sources will be less than 5 sigma above the noise .",
    "this suggests that there should be on the order of a few hundred calibrators available , if we peel as deeply as possible .",
    "the subtraction step is straightforward , since all of the cml sources have had their apparent positions measured , as described in section [ ionospheric refraction measurements ] , and have been calibrated using the antenna gain models given in ( [ eqn : jones matrix solution ] ) . before peeling , however , the models need to be multiplied by the complex @xmath53 factors . these were divided out when averaging to a central frequency in section [ rotate visibilities and sum over frequency ] .",
    "it may be that subtracting 100% of each source is not optimal , since noise in each measurement is added back into the visibilities .",
    "some modifications that work more like the clean algorithm ( see @xcite ) are being considered , and will be tested soon .",
    "the relatively short cadence time of the rts means we need to make compromises when designing real - time peeling process .",
    "one of these compromises will be the number of sources peeled every 8 seconds .",
    "several methods for calibrating antenna gains are compared in @xcite .",
    "these are alternatives to the technique discussed in section [ instrumental gain measurements ] . the number of complex multiplications required by most of the techniques scales as @xmath88 , where @xmath81 is the number of antennas ( or , more generally , the number of receivers being correlated to form visibilities ) .",
    "the technique that required the fewest computations was the logarithmic least squares ( logls ) algorithm , which scaled as @xmath89 .",
    "the numbers given in @xcite for a single polarization version are @xmath90 multiplications with an additional @xmath91 for weighting .",
    "how does this compare to the algorithm discussed in section [ instrumental gain measurements ] ? in our application",
    "we measure two polarizations , so if we consider each antenna as 2 polarized receptors the number of multiplications for the logls algorithm is @xmath92 .",
    "there will probably be another factor of 2 since correlations between the receptors on the same antenna will most likely need to be considered .",
    "the number of complex multiplications used to determine the calibration solutions in section [ instrumental gain measurements ] is @xmath93 , with an additional @xmath94 for weighting .",
    "this efficiency appears to be about as high as one might reasonably expect to achieve .",
    "we are not just dealing with a single source , however .",
    "the cml needs to pre - peel all of the calibrator sources , and then , for each source , unpeel , rotate all of the visibilities , solve for the ionospheric offset , solve for the antenna gains , and peel .",
    "table [ tbl : flops ] shows the approximate number of floating - point operations used in each of these steps .",
    "these numbers were obtained by listing the main operations in the inner loops of the routines and multiplying each by our best estimate of the associated floating - point operations .",
    "these numbers are not exact ; they are provided as a rough indication of where processing time will be spent . also , the number of sources processed by each of the routines need not be the same .",
    "for example , we might peel and make gain measurements for 50 sources , but make ionospheric measurements on a few hundred more ( which requires only the third and fourth rows ) .",
    ".approximate floating - point operations required for each source in the cml ( with 512 antenna tiles and a single frequency channel ) . [ cols=\"^,^\",options=\"header \" , ]     [ tbl : flops ]    while the algorithm scales well , there is still on the order of 180 million floating - point operations required during each 8 second calibration cycle . for the whole array ,",
    "some of the rows in the table need to be multiplied by the number of frequency channels ( 768 ) , while others need to be multiplied by the number of frequency sub - bands ( @xmath95 ) .",
    "they also need to be multiplied by the number of sources , as discussed in the previous paragraph .",
    "we anticipate a few trillion floating - point operations for the cml over the 8 seconds . this does not include various overheads such as memory access that will increase the number of operations by a factor of a few .",
    "each ionospheric refraction measurement can use data from every baseline , polarization and frequency . that is over 1.5 gigasamples for a single 2d offset . for sources that are only used for ionospheric measurements ,",
    "all of the processing listed in table [ tbl : flops ] will be reduced if we only use a subset of the visibilities .",
    "most of the baselines are short , and many of those will be redundant . furthermore , long baselines do not see as much of the extended galactic structure as short baselines , and they measure the apparent offset with higher angular resolution .",
    "initial investigations suggest that we may be able to ignore more than 99% of the short baselines for the stronger sources .",
    "since the tile gains are changing slowly , we do not necessarily need to make measurements for every source every 8 seconds .",
    "this can be exploited by making measurements for the strongest sources every 8 seconds , and cycling through subsets of the other sources .",
    "this way we still have gain measurements distributed across the sky every few minutes when we make fits for the tile beams , but we only run the full peel algorithm on 20 or 30 sources at a time .    rather than solving for direction - dependent parameters sequentially , one could fit for all of the calibrator sources simultaneously .",
    "in fact , the peeling algorithm is really just a robust and efficient method for reducing the number of unknowns and finding the multivariate solutions .",
    "one can also reduce the degrees of freedom by changing the fit parameters to quantities that do not change ( or change slowly ) with time or frequency , and solve using multiple snapshots , as discussed in detail in @xcite . for the mwa",
    ", we hope to be able to use slowly varying direction - dependent dipole gains and phases to describe the primary beam of each tile .",
    "once we have high quality measurements of our tile beams in the field , we will look more closely at fitting these dipole parameters directly .",
    "however , source subtraction will then be based on these dipole fits , not on direct tile gain measurements .",
    "one of the primary challenges in the search for a signature from the eor is that of foreground subtraction .",
    "at best the signal will be several orders of magnitude weaker than the galactic foreground and it is important that we understand the nature of the residuals from the calibration and peeling process .",
    "one of the drawbacks of peeling strong sources in real time and then averaging the resulting images together is that any residuals are also averaged into the mix .",
    "all of the calibration data will be stored in a database for use in offline processing , and peeling errors can be assessed and reduced at that stage . however ,",
    "if there is any concern that residuals from the peeling process might mimic the eor signal then peeling can be used for calibration only , and images formed from unpeeled visibilities .",
    "there is significant effort going into techniques for removing foregrounds during offline processing .",
    "these include techniques that exploit spectral differences in the foregrounds and the eor signature ( see for example @xcite and the discussion and references in @xcite ) , and the rotation measure synthesis techniques discussed in @xcite & @xcite .",
    "direction - dependent deconvolution techniques such as the one described in @xcite will also be essential for imaging .      of concern for any telescope operating at mwa frequencies is radio frequency interference ( rfi ) .",
    "even though the murchison site is extremely radio quiet @xcite , the array will still have to deal with some rfi .",
    "this includes communication and military satellite signals , reflections of fm radio broadcasts , and natural interference such as lightning .",
    "due to the low spectral occupancy of the rfi , the high quality polyphase filter banks used to isolate frequencies , and the campaign - mode operation of the array , we will adopt the traditional strategy of flagging and ignoring contaminated data before imaging .",
    "missing frequency or time samples can be accounted for in the weighting of the various least - squares algorithms .",
    "to test the cml , we generate simulated visibilities using maps , the mit array performance simulator @xcite .",
    "briefly , maps models all physical processes of a radio interferometer from the ionosphere , through the analog beamforming in the array tiles to time and frequency averaging in a correlator .",
    "maps uses polarized receptors and a polarized model sky to generate model visibilities in linear or circular polarization products .",
    "the model sky includes a large - scale diffuse component , based on @xcite with additional polarized flux , plus a catalog of southern point sources based on @xcite and @xcite .",
    "the tile beams for mwa simulations consist of 16 dual polarization receptors in a 4x4 array .",
    "receptors can have non - equal complex gains , which allows us to include realistic differences in the tile primary beams that we might expect due to the analog parts of the system . in the examples that follow ,",
    "complex gaussian noise was added to the gain of each receptor .",
    "mwa s synthesized beam has modest resolution , which allows us to use a very realistic full - sky model as an input to maps by simultaneously including large - scale diffuse structure and thousands of point sources . as such , the simulations show a large range of correlated power depending on baseline length .",
    "maps also implements a model ionosphere to change the relative path length for each baseline in each look direction .",
    "the model uses the international reference ionosphere @xcite for large scale structure , and a kolmogorov spectrum to add turbulence at smaller scales .",
    "the turbulent power was a set fraction of the total power ",
    "about 2%  and was repeated over the sky in patches of about 1 square degree .",
    "phase variations due to traveling ionospheric disturbances are not included in these simulations , but they have recently been added to maps . finally , 200k thermal noise was added to the visibilities . in this paper , while the description is fully polarized and there is significant instrumental polarization , we only use unpolarized input since testing of the maps software with polarized input is incomplete .",
    "polarized sources will be needed to fully describe the polarized response of each antenna and the faraday rotation state of the ionosphere @xcite , @xcite .",
    "@xmath96{fig3.png } &    \\includegraphics[width=5.8cm]{fig5.png } & \\includegraphics[width=5.8cm]{fig6.png } \\\\",
    "\\end{array}$ ]    maps was used to generate a series of visibility sets at a local sidereal time at the mwa site of 16.5 hours , with the antenna beams pointed at the zenith .",
    "[ plot : images ] shows three images created after the cml had converged .",
    "the only difference in the processing of each image is the number of sources that were peeled .",
    "[ plot : images]a shows the case for no peeling , where a few strong point sources dominate the image .",
    "there is also a slight hint of diffuse galactic structure in the lower left .",
    "as background radio sources are peeled , weaker sources and the diffuse galactic foreground become apparent . in fig . [",
    "plot : images]c all of the stronger sources have been analyzed and peeled , and the galactic center and its wavy sidelobes completely dominate .",
    "[ plot : convergence with npeel]a shows the image noise rms as a function of the number of sources being peeled ( in one of the instrument polarizations ) .",
    "the solid curve is from the simulations described above , the points are for images generated using the point sources only ( no galactic emission or ionosphere ) . after the first few strong sources are peeled away , the image rms becomes dominated by the galaxy . to reduce the image rms beyond this point , more sophisticated foreground subtraction algorithms need to be employed , such as those discussed in section [ discussion ]",
    "( one should note that eor observations will not be made in a field that contains the galactic center ) .",
    "[ plot : convergence with npeel]b shows the rms of the tile gain error towards the strongest calibrator as a function of the number of sources being peeled . here",
    "the curve and the points converge at the same rate , indicating that for this source the algorithm is not limited by the ionosphere or the galactic emission . in these examples ,",
    "we have weighted down visibilities from short baselines , since they see all of the galactic emission ( fourier components of angular features larger than the reciprocal of the baseline length cancel destructively , so we give more weight to the longer baselines ) .",
    "+    also of importance is how quickly convergence is achieved . at the end of each iteration ( for the mwa , each successive iteration",
    "is associated with a new set of visibilities , i.e. , they occur 8 seconds apart ) , the new solutions are used to update the old solutions .",
    "since the data are noisy , a weighted average of new and old solutions are used to set the weights for the next iteration . in these simulations ,",
    "the weights used for each source were based on the estimated contribution of the source to the visibilities . in other words ,",
    "strong sources are updated quickly ( the strongest being allowed to update by 50% with each iteration ) , while weak sources are adapted more slowly , some by only a few percent each time . fig . [",
    "plot : convergence with niter ] shows the mean gain errors for the 5 strongest sources , normalized by the gain towards each source .",
    "the errors are reduced until convergence is limited by a local minimum in the minimization process .",
    "the relative errors appear to converge to the same level , which has not been investigated .",
    "+    the properties and limits of the convergence shown in fig . [",
    "plot : convergence with niter ] is of the utmost importance . in the current simulations ,",
    "typically a few tens of calibrators converge well , but some weaker sources can be significantly affected by sidelobes and converge to local minima of ( [ eqn : voltage amplitude model 2 ] ) .",
    "a quantitative analysis of the situation is currently underway , and several options are being tested .",
    "these include investigations of the calibration bandwidth ( sidelobes of distant sources will decorrelate more as the bandwidth of the sub - bands is increased ) , large pre - peels ( approximate subtraction of extra catalogue sources helps reduce the size of local minima ) , and incorporating all - sky ionospheric and primary beam models to improve peels for weak sources .",
    "the primary beam fits are seen to work better when the calibrators are not just ranked by their apparent flux density , but also their position in the beams , so that a larger fraction of them lie in the structured antenna sidelobes .",
    "we have described a general approach for making measurements of strong point sources that can be used in the calibration process of wide - field , low - frequency radio arrays .",
    "this approach has been adopted for the mwa , and there is an ongoing effort to develop the required software , as well as to understand the benefits and limitations of the approach .",
    "we have used simulated visibility data to show that the peeling algorithm works well in situations that are of major concern for future radio telescopes : crowded fields , strong galactic emission , and ionospheric refraction .",
    "the algorithm exhibits fast convergence , which is important since sources will be moving in and out of antenna sidelobes and the algorithm needs to be able to keep up with the antenna gain and phase changes , as well as changes in the ionosphere .",
    "critical parts of the process are shown to be computationally efficient , and parts of the system lend themselves to significant levels of optimization .    the next step is a detailed analysis of the convergence properties of the algorithms , and a series of tolerance tests to investigate how the algorithms will behave in the various conditions we expect to encounter .",
    "this includes observations of weak emission that is masked by significant polarized diffuse foregrounds , high dynamic range observations close to the sun , and observations in the presence of severe ionospheric conditions , such as during activation and recombination of the ionosphere . as data from the initial deployment of antennas become available in late 2008 and early 2009",
    ", we will get a clearer picture of how harmful phenomena such as source variability ( due to ionospheric scintillation , for instance ) and dipole mutual coupling ( which will affect our tile beam models ) can be , and these can be worked into the tolerance tests .",
    "we would like to acknowledge the international mwa collaboration for its continued input and support of this work .",
    "j. d. bowman , d. g. barnes , f. h. briggs , b. e. corey , m. j. lynch , n. d. r. bhat , r. j. cappallo , s. s. doeleman , b. j. fanous , d. herne , j. n. hewitt , c. johnson , j. c. kasper , j. kocz , e. kratzenberg , c. j. lonsdale , m. f. morales , d. oberoi , j. e. salah , b. stansby , j. stevens , g. torr , r. wayth , r. l. webster , and s. b. wyithe ,  field deployment of prototype antenna tiles for the mileura widefield array low frequency demonstrator , \" _ astron . j. _ , vol . 133 , no .",
    "15051518 , apr . , 2007 .",
    "j. d. bowman , m. f. morales , and j. n. hewitt ,  the sensitivity of first - generation epoch of reionization observatories and their potential for differentiating theoretical power spectra , \" _ astrophys .",
    "20 - 26 , feb . 2006 .",
    "n. d. r. bhat , r. b. wayth , h. s. knight , j. d. bowman , d. oberoi , d. g. barnes , f. h. briggs , r. j. cappallo , d. herne , j. kocz , c. j. lonsdale , m. j. lynch , b. stansby , j. stevens , g. toor , r. l. webster , and s. b. wyithe ,  detection of crab giant pulses using the mileura widefield array low frequency demonstrator field prototype system , \" _ astrophys . j. _ ,",
    "1 , pp . 618627 , aug . 2007 .",
    "j. e. salah , c. j. lonsdale , d. oberoi , r. j. cappallo , and j. c. kasper ,  space weather capabilities of low frequency radio arrays , \" in _ proc .",
    "spie : solar physics and space weather instrumentation _ , san diego , 2005 , vol . 5901 ,",
    "124134 .",
    "t. j. cornwell , k. golap , and s. bhatnagar , `` w projection : a new algorithm for wide field imaging with radio synthesis arrays '' , in _ asp conf .",
    "series : astronomical data analysis software and systems xiv _",
    ", san francisco : astronomical society of the pacific , 2005 , vol . 347 , pp .",
    "8690 .",
    "m. h. wieringa , a. g. de bruyn , d. jansen , w. n. brouw , and p. katgert ,  small scale polarization structure in the diffuse galactic emission at 325 mhz , \" _ astron . and astrophys .",
    "268 , pp . 215229 , 1993 .",
    "r. j. sault , j. p. hamaker , and j. d. bregman ,  understanding radio polarimetry .",
    "ii . instrumental calibration of an interferometer array , \" _ astron .",
    "_ , vol . 117 , pp .",
    "149159 , may , 1996 .",
    "r. j. nijboer and j. e. noordam , ",
    "lofar calibration , \" in _ asp conf .",
    "series : astronomical data analysis software and systems xvi _",
    ", san francisco : astronomical society of the pacific , 2007 , vol . 376 , pp . 237240 .            c. j. lonsdale , s. s. doeleman , and d. oberoi ,  efficient imaging strategies for next - generation radio arrays , `` _ experimental astron .",
    "13 , pp . 345 - 362 , june , 2004 .",
    "dynamic range and polarimetric fidelity , '' _ astron .",
    "515543 , 2000 .",
    "t. mauch , t. murphy , h. j. buttery , j. curran , r. w. hunstead , b. piestrzynski , j. g. robertson , and e. m. sadler ,  sumss : a wide - field radio imaging survey of the southern sky - ii . the source catalogue , \" _ mon . not .",
    "4 , pp . 11171130 , july , 2003 .",
    "d. h. rogstad .",
    "( 2005 , august ) . _ the sumple algorithm for aligning arrays of receiving radio antennas : coherence achieved with less hardware and lower combining loss_. jet propulsion laboratory : ca .",
    "[ online ] .",
    "available : http://ipnpr.jpl.nasa.gov/progress_report/42-162/162b.pdf          m. f. morales , j. d. bowman , and j. n hewitt , `` improving foreground subtraction in statistical observations of 21 cm emission from the epoch of reionization , '' _ astrophys .",
    "767 - 773 , sep .",
    "2006            a. de oliveira - costa , m. tegmark , b. m. gaensler , j. jonas , t. l. landecker , and p. reich ,  a model of diffuse galactic radio emission from 10 mhz to 100 ghz , \" _ mon . not .",
    "_ , in press , 2008 ."
  ],
  "abstract_text": [
    "<S> the interferometric technique known as peeling addresses many of the challenges faced when observing with low - frequency radio arrays , and is a promising tool for the associated calibration systems . </S>",
    "<S> we investigate a real - time peeling implementation for next - generation radio interferometers such as the murchison widefield array ( mwa ) . </S>",
    "<S> the mwa is being built in australia and will observe the radio sky between 80 and 300 mhz . </S>",
    "<S> the data rate produced by the correlator is just over 19 gb / s ( a few peta - bytes / day ) . </S>",
    "<S> it is impractical to store data generated at this rate , and software is currently being developed to calibrate and form images in real time . </S>",
    "<S> the software will run on - site on a high - throughput real - time computing cluster at several tera - flops , and a complete cycle of calibration and imaging will be completed every 8 seconds . </S>",
    "<S> various properties of the implementation are investigated using simulated data . </S>",
    "<S> the algorithm is seen to work in the presence of strong galactic emission and with various ionospheric conditions . </S>",
    "<S> it is also shown to scale well as the number of antennas increases , which is essential for many upcoming instruments . </S>",
    "<S> lessons from mwa pipeline development and processing of simulated data may be applied to future low - frequency fixed dipole arrays . </S>"
  ]
}