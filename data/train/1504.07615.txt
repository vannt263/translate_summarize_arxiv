{
  "article_text": [
    "wireless networks consisting of energy harvesting nodes continue to gain significance in the area of green communications @xcite . these networks _",
    "harvest _ energy from external sources in an intermittent fashion , and consequently require careful management of the available energy .",
    "there is considerable recent research on energy management for energy harvesting networks .",
    "reference @xcite considers an energy harvesting transmitter with energy and data arrivals , and an infinite size battery to store the harvested energy , and shows the optimality of a piecewise constant power policy for minimization of completion time of a file transfer . in @xcite , the throughput maximization problem is solved when the energy storage capacity of the battery is limited .",
    "it is shown that the transmission power policy is again piecewise constant , changing only when the battery is full or depleted .",
    "extension of the model in @xcite to fading channels is studied in @xcite where a directional water - filling algorithm is shown to yield the optimum transmission policy .",
    "reference @xcite also considers throughput maximization for a fading channel under the same assumption .",
    "the impact of degradation and imperfections of energy storage on the throughput maximizing policies is studied in @xcite . the single user channel with an energy harvesting transmitter and an energy harvesting receiver is considered in @xcite , and decoding and sampling strategies for energy harvesting receivers is considered in @xcite .",
    "various multi - user energy harvesting networks have also been studied to date ; including multiple access , broadcast , and interference channels with energy harvesting nodes @xcite .",
    "in addition to these multi - user setups , variations of the energy harvesting relay channel are studied in @xcite , including multiple energy harvesting relays @xcite .    in this work ,",
    "we study the simplest network setup that embodies a cooperative communication scenario with two - directional information flow , with the goal of identifying design insights unique to such scenarios .",
    "this leads to the investigation of bi - directional communication with energy harvesting nodes .",
    "specifically , we study the so - called separated two - way relay channel with energy harvesting nodes .",
    "the channel is separated in the sense that the users can not hear each other directly , i.e. , communication is only possible through the relay .",
    "this model is relevant and of interest for peer - to - peer communications , or for any scenario where a pair of nodes exchange information , and avails the relay node to implement strategies to convey both messages simultaneously .",
    "the two - way relay channel ( twrc ) with conventional ( non - energy - harvesting ) nodes is studied with various relaying strategies such as amplify - and - forward , decode - and - forward , compress - and - forward @xcite , and compute - and - forward@xcite in half - duplex @xcite and full - duplex @xcite models .",
    "it is observed that different relaying schemes outperform the others for different ranges of transmit powers .    in this paper , we identify transmission power policies for the energy harvesting two - way relay channel ( eh - twrc ) which maximize the sum - throughput .",
    "the energy harvesting relay can perform amplify - and - forward , decode - and - forward , compress - and - forward , or compute - and - forward relaying .",
    "due to intermittent energy availability , the channel calls for relaying strategies that adapt to varying transmit powers . for this purpose ,",
    "we introduce a relay that can dynamically change its relaying strategy , resulting in what we term hybrid relaying strategies .",
    "we derive the properties of the optimal offline transmission policy , where energy arrivals are known non - causally , with the goal of gaining insights into its structure .",
    "next , we show that an iterative generalized directional water - filling algorithm solves the sum - throughput maximization problem for all relaying strategies .",
    "we next find the optimal online transmission policy by formulating and solving a dynamic program , where the energy states of the nodes are known causally .",
    "we compute optimal policies for different relaying strategies and provide numerical comparisons of their sum - throughputs .",
    "our contribution includes generalization of directional water - filling @xcite to an interactive communication scenario with multiple energy harvesting terminals in the offline setting , as well as the identification of optimal policies in the online setting .",
    "the interactive communication scenario considered in this paper is the catalyst that can drastically change the resulting power allocation algorithms in the energy harvesting setting .",
    "the two - way relay channel is the simplest multi terminal network model that demonstrates this interaction , and hence is the model considered .",
    "we observe that the relaying strategy has a significant impact on the optimum transmission policy , i.e. , transmit powers and phase durations , and that hybrid relaying can provide a notable throughput improvement for the eh - twrc .",
    "the remainder of the paper is organized as follows .",
    "the system model is described in section  [ sect_model ] . in section  [ sect_hybrid ] ,",
    "a hybrid relaying scheme where the relay can alter its strategy depending on the instantaneous powers is introduced . in section  [ sect_properties ] , the sum - throughput maximization problem is presented for an eh - twrc , and is divided into subproblems that can be solved separately . in section  [ sect_identify ] ,",
    "the iterative generalized directional water - filling algorithm is proposed to find an optimal policy for the eh - twrc .",
    "the online policy based on dynamic programming is provided in section  [ sect_online ] .",
    "numerical results are presented in section  [ sect_numerical ] .",
    "the paper is concluded in section  [ sect_conclusion ] .",
    "we consider an additive white gaussian noise ( awgn ) two - way relay channel with two source nodes , @xmath0 and @xmath1 , that convey independent messages to each other through a relay node @xmath2 .",
    "the two source nodes can not hear each other directly , hence all messages are sent through the relay .",
    "the channels to and from a source node are reciprocal , with power gains @xmath3 between nodes @xmath0 and @xmath2 and @xmath4 between nodes @xmath1 and @xmath2 .",
    "we consider the delay limited scenario , where the relay forwards messages as soon as they are received , and thus has no data buffer .",
    "the channel model is shown in figure  [ fig_model ] .    , @xmath5 .",
    "]    all nodes @xmath0 , @xmath1 and @xmath2 are powered by energy harvesting .",
    "node @xmath6 , @xmath5 , harvests @xmath7 units of energy at time @xmath8 , and stores it in a battery of energy storage capacity @xmath9 .",
    "any energy in excess of the storage capacity of the battery is lost .",
    "the initial charge of the batteries are represented with @xmath10 , with @xmath11 by definition .",
    "the time between the @xmath12th and @xmath13th energy arrivals , referred to as the @xmath12th epoch in the sequel , is denoted by @xmath14 .",
    "we remark that the model does not require all nodes to harvest energy packets simultaneously ; but rather indicates that epochs are constructed as the intervals between any two energy arrivals .",
    "a node that is not receiving any energy at the @xmath12th harvest is set to have @xmath15 .",
    "the energy harvesting model is depicted in figure  [ fig_energy_model ] .",
    "we consider a transmission session of @xmath16 epochs , with length @xmath17 , for which the energy harvesting profile consists of @xmath18 and @xmath8 for @xmath5 and @xmath19 . in epoch @xmath12",
    ", @xmath19 , node @xmath6 , @xmath5 , allocates an average power @xmath20 for transmission , i.e. , a total energy of @xmath21 is consumed for transmitting .",
    "since the energy available to each node is limited by the energy harvested and stored in the respective battery , the energy harvesting profile determines the feasibility of @xmath20 for each node .",
    "specifically , the transmission powers satisfy @xmath22 where @xmath23 is the energy available to node @xmath24 at the beginning of epoch @xmath12 , which evolves as @xmath25 in this work , similar to references @xcite , the energy harvesting profile is known non - causally by all nodes , so that offline optimal policies and performance limits of the network can be found . ] . the communication overhead for conveying energy arrival information and power allocation decisions is considered to be negligible compared to the amount of data transferred in each epoch .",
    "we consider the problem of finding the power policy which maximizes the sum - throughput of the system under different relaying strategies such as decode - and - forward , compute - and - forward , compress - and - forward and amplify - and - forward . in the next subsection",
    ", we present the rate regions for these relaying strategies .",
    "we focus on a two - phase communication scheme , consisting of a multiple access phase from nodes @xmath0 and @xmath1 to @xmath2 and a broadcast phase from @xmath2 to @xmath0 and @xmath1 .",
    "this is referred to as multiple access broadcast ( mabc ) in @xcite .",
    "its three phase counterpart , time division broadcast ( tdbc ) @xcite , can be shown to perform no better than mabc in the absence of a direct channel between @xmath0 and @xmath1 , and is therefore omitted . for half - duplex nodes ,",
    "the rates achievable with decode - and - forward , compress - and - forward , amplify - and - forward and compute - and - forward relaying schemes are derived in @xcite .",
    "these works consider nodes that are constrained by their instantaneous transmit powers , and do not consider total consumed energy , which depends on the duration of multiple access and broadcast phases . since our model is energy - constrained , we revise the results of these work by scaling transmit powers with phase duration , thereby replacing instantaneous transmit powers with average transmit powers @xmath20 .",
    "we denote the set of rate pairs achievable with average transmit powers @xmath26 , @xmath27 and @xmath28 and multiple access phase duration @xmath29 as @xmath30 in the half - duplex case .",
    "the duration of the broadcast phase is @xmath31 . for full - duplex nodes , due to simultaneous multiple access and broadcast phases",
    ", there is no need for the time sharing factor @xmath29 ; we use @xmath32 to denote the achievable set of rate pairs . in this case",
    ", the full - duplex nodes can remove the self - interference term form the received signal , as in @xcite .",
    "we use a subscript to denote the relaying strategy where necessary .     at @xmath33 .",
    "amplify - and - forward rates remain just below compress - and - forward and thus are not visible . ]    * decode - and - forward : * in this scheme , the relay decodes the messages of both source nodes in the multiple access phase , and transmits a function of the two messages in the broadcast phase .",
    "nodes @xmath0 and @xmath1 use the broadcast message along with their own messages to find the ones intended for them . for half - duplex nodes , the rate region @xmath34 in epoch @xmath12 is defined by at each node .",
    "this is done by first scaling @xmath3 and @xmath4 to establish unit variance noise at nodes @xmath0 and @xmath1 , and subsequently scaling the transmit power , available energy and battery capacity at nodes @xmath0 and @xmath1 to yield a unit variance noise at @xmath2 . ]    [ eqn_rates_hd_mabc ] @xmath35    where @xmath36 . with full - duplex radios ,",
    "the two phases take place simultaneously , achieving instantaneous rates @xmath37 which are found by substituting @xmath38 in ( [ eqn_rates_hd_mabc ] ) .",
    "* compress - and - forward : * in this scheme , the relay transmits a compressed version of its received signal in the broadcast phase .",
    "the instantaneous rates @xmath39 , @xmath40 , for the mabc half - duplex case satisfy    [ eqn_rates_hd_cf ] @xmath41    for some @xmath42 and @xmath43 , where @xmath44 .",
    "the full - duplex rates @xmath45 are @xcite @xmath46 where @xmath47 , and    [ eqn_rates_fd_cf_sigmas ] @xmath48    * amplify - and - forward : * in this scheme , the relay broadcasts a scaled version of its received signal .",
    "since this is performed on a symbol - by - symbol basis , the time allocated for multiple access and broadcast phases are equal .",
    "the rate regions @xmath49 are found as    [ eqn_rates_fd_af ] @xmath50    by substituting @xmath51 for the half - duplex case and @xmath52 for the full - duplex case .",
    "* compute - and - forward ( lattice forwarding ) : * in this scheme , nested lattice codes are used at the source nodes , and the relay decodes and broadcasts a function of the two messages received from the sources .",
    "each source then calculates the intended message using the side information of its own @xcite .",
    "the rate region @xmath53 achievable with this scheme for an mabc half - duplex relay consists of rates satisfying    [ eqn_rates_hd_lf ] @xmath54    where @xmath55 and @xmath56 .",
    "the full - duplex rate region @xmath57 can be evaluated by substituting @xmath38 in ( [ eqn_rates_hd_lf ] ) . in reference",
    "@xcite , it is shown that this strategy achieves within @xmath58 bits of twrc capacity in each epoch .     at @xmath33 .",
    "amplify - and - forward rates remain just below compress - and - forward and thus are barely visible . ]    it can be observed that the compute - and - forward rates are not jointly concave in transmit powers @xmath20 , @xmath5 .",
    "this implies that time sharing between two sets of transmit powers @xmath59 and @xmath60 with parameter @xmath61 , consuming average powers @xmath62 , @xmath5 , can yield rates @xmath63 . to include rates achievable as such",
    ", we concavify the rate region by extending @xmath57 to include all time - sharing combinations with average power @xmath59 , i.e. , @xmath64 which we refer to as the concavified rate region .",
    "this extends to the half - duplex relaying region @xmath65 by time sharing among @xmath66 as well . with a slight abuse of notation",
    ", we will denote the concavified regions with @xmath57 and @xmath53 in the sequel .",
    "we note that all rates in the concavified region are achievable via time - sharing within an epoch , while the average powers within said epoch , and hence energy constraints , hold by definition .",
    "a formal proof of this concavification follows ( * ? ? ?",
    "1 ) closely . in the sequel",
    ", we use the concavified region , though we do not reiterate the required time - sharing for clarity of exposition .",
    "since we are interested in maximizing sum - throughput , we compare the maximum achievable sum - rates for full- and half - duplex nodes employing the relaying strategies above in figures  [ fig_comp1_fd ] and [ fig_comp1_hd ] , respectively . in these evaluations ,",
    "a symmetric channel model normalized to yield @xmath67 , and a fixed relay power of @xmath33 is considered .",
    "it can be observed that different schemes may outperform based on the instantaneous transmit power , and thus the selection of the correct relaying scheme is of importance in an energy harvesting setting where transmit powers are likely to change throughout the transmission .",
    "in section  [ sub_model_rates ] , it is observed that depending on the transmit powers , either one of the relaying strategies may yield the best instantaneous sum - rate . due to the intrinsic variability of harvested energy ,",
    "transmit powers may change significantly throughout the transmission period based on the energy availability of nodes .",
    "consequently , a dynamic relay that chooses its relaying strategy based on instantaneous transmit powers of the nodes can potentially improve system throughput .",
    "another benefit of switching between relaying strategies is achieving time - sharing rates across strategies , e.g. , switching between decode - and - forward and compute - and - forward strategies within an epoch , which can outperform both individual strategies with the same average power .",
    "an example of the benefits of time - sharing in a two - way relay channel is reference @xcite , where time - sharing between different operation modes is considered . in @xcite , a fixed relaying strategy",
    "is employed with different nodes transmitting at a time ; while here we allow time - sharing between different relaying strategies .    the rates achievable with a hybrid strategy switching between the four relaying schemes in figures  [ fig_comp1_fd ] and [ fig_comp1_hd ] consist of the convex hull of the union of rate pairs achievable by the individual schemes .",
    "the rate region for the hybrid scheme is expressed as @xmath68 where @xmath69 , @xmath70 , @xmath71 and @xmath72 are the rate regions given in section  [ sub_model_rates ] with decode - and - forward , compute - and - forward , compress - and - forward and amplify - and - forward , respectively .    for the purpose of demonstration",
    ", we present the chosen relaying scheme that maximizes the instantaneous sum - rate for a half - duplex channel with fixed relay transmit power , @xmath73 , in figure  [ fig_sims_hybrid ] .",
    "it can be observed that while decode - and - forward or compute - and - forward alone are chosen at the extremes , a time - sharing of the two strategies is favored in between . in this figure ,",
    "the regions where the hybrid scheme uses time - sharing are shown in two shades of blue .",
    "we note that for these channel parameters , the remaining relaying schemes under - perform these two for any choice of transmit powers .     at @xmath33 .",
    "the labels `` over d&f '' and `` over lf '' denote which of the two strategies is better by itself in that region . ]    with these observations , we conclude that policies with hybrid relaying strategies can instantaneously surpass the sum - rates resulting from individual relaying schemes for a considerable set of power vectors .",
    "furthermore , time - sharing between relaying strategies may strictly outperform the best relaying strategy alone .",
    "numerical results on the performance of optimal hybrid schemes in comparison with individual schemes are presented in section  [ sect_numerical ] .",
    "we consider the problem of sum - throughput maximization for a session of @xmath16 epochs .",
    "since achievable rates are either jointly concave in transmit powers or can be concavified by the use of time sharing as in ( [ eqn_model_concavify ] ) , it follows that the optimal transmit powers remain constant within each epoch , as noted in ( * ? ? ?",
    "* lemma 2 ) .",
    "the power policy of the network consists of the power vectors @xmath74 , where @xmath75 , @xmath5 , and in the case of half - duplex relaying , the time sharing parameters @xmath66 , @xmath19 .",
    "for the set of feasible power policies , we first present the following proposition , which is the multi - user extension of ( * ? ? ? * lemma 2 ) :    [ lem_overflow ] there exists optimal average transmit powers @xmath76 that do not yield a battery overflow at any of the nodes throughout the communication session .",
    "let @xmath74 be a vector of transmit powers yielding battery overflows , i.e. , @xmath77 for some @xmath24 and @xmath12 .",
    "for each battery overflow of amount @xmath78 at node @xmath6 at the end of epoch @xmath12 , let @xmath79 .",
    "for the remaining powers , let @xmath80 . the power policy defined by @xmath81",
    "does not overflow the battery at any time , and satisfies @xmath82 for all @xmath24 and @xmath12 .",
    "note that nodes consuming powers @xmath83 can achieve any rate pair that is achievable with less power , i.e. ,    [ eqn_prop_nondiminishing ] @xmath84    for full - duplex and half - duplex nodes with @xmath85 , respectively .",
    "therefore , the sum - rate obtained by @xmath81 at any epoch @xmath12 is no less than that of @xmath74 .",
    "hence , for any policy with battery overflows , we can find a policy performing at least as good without overflows .",
    "we remark that even though ( [ eqn_prop_nondiminishing ] ) does not hold immediately , e.g. , for the amplify - and - forward rates in ( [ eqn_rates_fd_af ] ) , it holds by definition for the concavified rates in ( [ eqn_model_concavify ] ) . by choosing @xmath86 and @xmath87 in ( [ eqn_model_concavify ] )",
    ", a portion of the allocated power @xmath20 can equivalently be discarded at the node .",
    "consequently , proposition  [ lem_overflow ] applies to all concavified relaying schemes presented in section  [ sub_model_rates ] .    as a consequence of proposition  [ lem_overflow ]",
    ", we will restrict the feasible set of policies to those that do not overflow the battery without loss of generality . in epoch @xmath12 ,",
    "the nodes choose transmit powers @xmath59 , a time sharing parameter @xmath66 , and a rate pair @xmath88 in the case of half - duplex radios .",
    "the objective is to maximize the sum - throughput of the twrc within @xmath16 epochs , where the transmit powers are constrained by harvested energy and the rates are constrained by the rate region .",
    "we express the eh - twrc sum - throughput maximization problem    [ eqn_model_prob_hd ] @xmath89    for half - duplex nodes , where @xmath75 , @xmath5 , @xmath90 , @xmath91 , and @xmath92 . here , ( [ eqn_model_hd_capacity ] ) is due to proposition  [ lem_overflow ] , and ( [ eqn_model_hd_causality ] ) is equivalent to ( [ eqn_model_constraint ] ) given ( [ eqn_model_hd_capacity ] ) .",
    "while the rates are a function of the powers of the nodes and the time sharing parameters @xmath93 , this dependency is now deferred to ( [ eqn_model_hd_c1 ] ) , which is the constraint that ensures the rates are selected from the achievable region dictated by the power and time sharing parameters . the energy causality constraints given in ( [ eqn_model_hd_causality ] )",
    "ensure that the energy consumed by a node is not greater than the energy harvested up to that epoch .",
    "the no - overflow constraints given in ( [ eqn_model_hd_capacity ] ) ensure that the battery capacity is not exceeded .",
    "any power policy @xmath74 satisfying both ( [ eqn_model_hd_causality ] ) and ( [ eqn_model_hd_capacity ] ) for all @xmath24 and @xmath12 is considered a feasible power power policy .",
    "the problem for full - duplex nodes is attained by replacing ( [ eqn_model_hd_c1 ] ) with @xmath94 and omitting the time - sharing variables @xmath66 , @xmath19 .",
    "we next show that ( [ eqn_model_prob_hd ] ) can be decomposed by separating the maximization over @xmath95 , @xmath96 , and @xmath97 , @xmath19 , and the maximization over @xmath98 , @xmath99 , @xmath66 , @xmath19 , as    [ eqn_model_prob_hd2 ] @xmath100    note that only the constraints in ( [ eqn_model_hd2_c1 ] ) pertain to the parameters of the second maximization .",
    "next , we observe that the constraints in ( [ eqn_model_hd2_c1 ] ) are separable in @xmath12 , and the objective is a linear function of @xmath98 and @xmath99 . hence , the second maximization can be carried out separately for each @xmath12 , i.e. , in an epoch - by - epoch fashion , yielding the separated problem    [ eqn_model_prob_norate ] @xmath101    where @xmath102 is the solution to    [ eqn_model_prob_hd_inner ] @xmath103    within a single epoch @xmath104 with fixed powers @xmath105 .",
    "this implies that the optimal transmit rates within each epoch are the sum - rate maximizing rates for the given transmit powers within that epoch .",
    "thus , we refer to the function @xmath102 as the _ maximum epoch sum - rate_. for full - duplex nodes , the maximum epoch sum - rate is found by solving    [ eqn_model_prob_fd_inner ] @xmath106    instead , and the power policy optimization is identical to ( [ eqn_model_prob_norate ] ) .",
    "we next show a property of policies that solve the problem in ( [ eqn_model_prob_hd ] ) .",
    "[ lem_depleted_batteries ] there exists an optimal policy which depletes the batteries of all nodes at the end of transmission .",
    "let @xmath107 be a transmission policy which leaves energy @xmath108 in the battery of node @xmath24 at the end of transmission .",
    "consider the transmission policy @xmath109 which has @xmath110 , and equals the original policy elsewhere .",
    "hence , this policy expends the remaining energy in the battery of @xmath6 in the last epoch , depleting the batteries .",
    "we have @xmath111 for @xmath112 and @xmath113 , for @xmath91 , due to ( [ eqn_prop_nondiminishing ] ) .",
    "therefore , the sum - throughput of the new policy can not be lower than that of the original policy .",
    "now that we have formulated the problem and identified some necessary properties of the optimal policy , we next find the optimal power policy for the eh - twrc .",
    "we establish this using a generalization of the directional water - filling algorithm in @xcite , which gives the optimal policy for a single transmitter fading channel . in this section",
    ", we show the optimality of the generalized directional water - filling algorithm and verify its convergence .      to find the optimal policy , we first find the maximum epoch sum - rate by solving ( [ eqn_model_prob_hd_inner ] ) and ( [ eqn_model_prob_fd_inner ] ) for half - duplex and full - duplex nodes , respectively . the following property of @xmath102 can be immediately observed for any relaying scheme .",
    "[ lem_sumrate_convex ] the maximum epoch sum - rate @xmath102 is jointly concave in transmit powers @xmath114 , @xmath115 , and @xmath116 .",
    "proof follows from the concavity of objectives ( [ eqn_model_hd_inner_objective ] ) and ( [ eqn_model_fd_inner_objective ] ) , and the convexity of constraint sets ( [ eqn_model_hd_inner_c1 ] ) and ( [ eqn_model_fd_inner_c1 ] ) .",
    "let @xmath117 and @xmath118 denote two feasible rate pairs , and @xmath29 and @xmath119 their time - sharing parameters for transmit powers @xmath120 and @xmath121 , respectively .",
    "let @xmath122 , @xmath91 , @xmath123 , and @xmath124 , @xmath5 denote the convex combination of the policies with parameter @xmath125 . then , for all relaying schemes , @xmath126 or @xmath127 follows either from the definition of the rate region , or from ( [ eqn_model_concavify ] ) .    as a consequence of lemma",
    "[ lem_sumrate_convex ] , ( [ eqn_model_prob_norate ] ) is a convex program .",
    "we next provide the _ iterative generalized directional water - filling algorithm _ to compute the optimal power policy . consider the power allocation problem in ( [ eqn_model_prob_norate ] ) for an arbitrary relaying scheme with the maximum epoch sum - rate @xmath128 . here",
    ", the constraints in ( [ eqn_model_prob_norate_causality ] ) and ( [ eqn_model_prob_norate_capacity ] ) are separable among @xmath5 .",
    "hence , a block coordinate descent algorithm , i.e. , alternating maximization , can be employed @xcite . in each iteration , the power allocation problem for node @xmath6 , @xmath5 , given by    [ eqn_kkt ] @xmath129    is solved while keeping the remaining power levels @xmath130 , @xmath131 , constant .",
    "this is a convex single user problem , and the solution satisfies the kkt stationarity conditions and complementary slackness conditions @xcite    [ eqn_rates_gidwf_iter ] @xmath132    for all @xmath19 where @xmath133 , @xmath134 and @xmath135 are the lagrange multipliers for energy causality , battery capacity and transmit power non - negativity constraints , respectively .",
    "hence , the optimal transmit power policy for @xmath6 , i.e. , @xmath136 , is the solution to @xmath137 for all @xmath138 which follows from ( [ eqn_iterative_stationarity ] ) .",
    "note that due to ( [ eqn_iterative_cs1 ] ) and ( [ eqn_iterative_cs2 ] ) , the lagrange multipliers are nonzero only when the respective constraints are met with equality .",
    "we argue that the solution to ( [ eqn_water - level2 ] ) can be interpreted as a generalization of the directional water - filling algorithm @xcite similar to the case in @xcite . in @xcite ,",
    "optimal transmit powers are found by treating the available energy in each epoch as water , and letting water levels equalize by flowing in the forward direction only .",
    "the associated algorithm is termed directional water - filling . here",
    ", we instead define the _ generalized water levels _ for @xmath6 as @xmath139 the following properties of @xmath140 are readily observed for the optimal policy : ( a ) while @xmath141 , the water levels remain constant among epochs unless the battery is empty or full , increasing only when the battery is empty , and decreasing only when the battery is full , and ( b ) if a positive solution to @xmath142 does not exist , then @xmath143 and @xmath135 .",
    "these properties imply that the optimal policy can be found by performing directional water - filling using the generalized water levels in ( [ eqn_water - level ] ) , and calculating the corresponding transmit powers @xmath20 .",
    "water flow is only in the forward direction and the corresponding energy flow is bounded by @xmath9 for node @xmath6 .",
    "hence , the flow between two neighboring epochs stops when water levels in ( [ eqn_water - level ] ) are equalized or when the total energy flow reaches @xmath9 .",
    "the initial water levels are found by substituting the initial transmit powers @xmath144 in ( [ eqn_water - level ] ) .",
    "this algorithm yields transmit powers that satisfy the two properties above by construction .",
    "an example of generalized directional water - filling is depicted in figure  [ fig_wf ] .     with @xmath145 epochs .",
    "note that the battery of the node is full at the end of the 5th epoch , preventing further energy flow into the 6th epoch . ]",
    "the _ iterative _ generalized directional water - filling ( igdwf ) algorithm employs generalized directional water - filling sequentially for each user until all power levels @xmath136 , @xmath5 , converge , i.e. , alternating maximization .",
    "although optimization is carried on separately for a single user at each iteration , the transmit powers of all users interact through the generalized water levels in ( [ eqn_water - level ] ) .",
    "starting from the initial values @xmath146 , the @xmath147th iteration of the algorithm , optimizing @xmath148 for @xmath149 , is given in algorithm  [ alg_1 ] .",
    "at each iteration of the igdwf algorithm , the water flow out of each of the @xmath16 epochs can be found using a binary search .",
    "this requires updating at most @xmath16 water levels following each epoch .",
    "hence , the computational complexity of each iteration is @xmath150 , i.e. , quadratic in the number of epochs .",
    "\\1 ) let @xmath149 , @xmath151 , @xmath152 for @xmath153 , @xmath154 , @xmath138 .",
    "\\2 ) * for * @xmath155 , * do *     find the set @xmath156",
    "@xmath157 ,     * if * @xmath158 and @xmath159 , * then *     assign @xmath160 ,     find @xmath161 and assign @xmath162 ,     @xmath163 , @xmath164     such that @xmath165 is minimized .     * end for *    \\3 ) repeat 2 until @xmath166 or @xmath167 for all @xmath12 .      for the alternating maximization in section  [ sub_solution ] to converge to an optimal policy , it is sufficient that the feasible set is the intersection of convex constraints that are separable among @xmath5 , and the continuously differentiable objective yields a unique maximum in each iteration ( * ? ? ?",
    "2.7.1 ) . in this case , the objective in ( [ eqn_model_prob_norate_objective ] ) is concave and continuously differentiable for all relaying strategies , with compute - and - forward satisfying this condition after the concavification in ( [ eqn_model_concavify ] ) .",
    "the feasible set ( [ eqn_model_prob_norate_causality])-([eqn_model_prob_norate_capacity ] ) is separable among @xmath5 as well .",
    "however , the objective does not necessarily yield a unique maximum at each iteration since it is not strictly concave in transmit powers . to overcome this , we introduce the unconstrained variables @xmath168 for @xmath5 , and modify the objective in ( [ eqn_iterative_objective ] ) as @xmath169 where @xmath170 , @xmath5 are arbitrarily small parameters . the objective in ( [ eqn_new_objective ] )",
    "is maximized by a unique @xmath136 in each iteration with @xmath171 or @xmath172 .",
    "the iterations optimizing @xmath173 trivially yield the unique solution @xmath174 .",
    "therefore , the problem now satisfies the convergence property for alternating maximization , and converges to the global maximum of ( [ eqn_model_prob_norate ] ) ( * ? ? ?",
    "2.7.2 ) .    note that through ( [ eqn_new_objective ] ) and the arbitrarily small @xmath175 , we essentially introduce _ resistance _ to the iterative algorithm .",
    "that is , if the original objective in ( [ eqn_model_prob_norate_objective ] ) yields multiple solutions for some @xmath24 , the objective in ( [ eqn_new_objective ] ) has a unique solution that is closest to the previous value of @xmath136 .",
    "consequently , if there exists more than one optimal solution to ( [ eqn_kkt ] ) at one of the iterations for some @xmath24 , the power policy @xmath136 that is closest to the previous one is chosen .",
    "this is ensured by choosing the flow amount @xmath176 which minimizes @xmath177 in step  2 of algorithm  [ alg_1 ] .",
    "the power allocation policy we have considered so far is an offline policy , in the sense that the energy harvest amounts and times are known to all nodes in advance .",
    "although the offline approach is useful for predictable energy harvesting scenarios @xcite and as a benchmark , it is also meaningful to develop policies that only rely on past and current energy states , i.e. , causal information only .",
    "we refer to such transmission policies as _ online _ policies .",
    "recent efforts that consider online algorithms for energy harvesting nodes in various channel models include @xcite .",
    "building upon the previous work , in this section , we find the optimal online policy for power allocation in the two - way relay channel .",
    "the epoch length @xmath178 indicates that no energy will be harvested for a duration of @xmath178 after the @xmath12th energy arrival .",
    "therefore , in the online problem , the epoch lengths are not known by the nodes causally .",
    "instead , we divide the transmission period into time slots of length @xmath179 , and recalculate transmit powers at the beginning of each time slot .",
    "we assume that each energy harvest takes place at the beginning of some time slot .",
    "note that with smaller @xmath179 , this model gets arbitrarily close to the general model in section  [ sect_model ] .",
    "we assume that harvests @xmath18 in time slot @xmath12 are independent and identically distributed . in time slot @xmath12 , nodes @xmath0 , @xmath1 and @xmath2 have access to previous energy harvests @xmath180 , @xmath181 and @xmath182 .",
    "the nodes decide on transmit powers @xmath20 , @xmath181 through _ actions _",
    "@xmath183 where @xmath184 denotes all energy arrivals prior to , and including , time slot @xmath12 .",
    "each time slot with transmit powers @xmath185 contribute to the additive objective through the sum - rate function @xmath186 in ( [ eqn_model_prob_hd_inner ] ) and ( [ eqn_model_prob_fd_inner ] ) for full - duplex and half - duplex modes , respectively .",
    "we consider the problem of finding the optimal set of actions for this setting , which can be formulated as the following dynamic program @xcite : @xmath187.\\end{aligned}\\ ] ] here @xmath16 is the number of time slots and @xmath188 $ ] denotes the conditional expectation over remaining energy harvests @xmath189 given the previous harvests as @xmath190 .",
    "note that the dynamic program outlined by ( [ eqn_online_bellman1 ] ) is computationally difficult due to the dimension of the problem .",
    "however , for the case of i.i.d .",
    "energy harvests that we consider , it can be simplified by restricting to actions that only utilize current battery state .",
    "this is due to the expectation in ( [ eqn_online_bellman1 ] ) being independent of past energy harvests .",
    "this implies simplifying the actions in ( [ eqn_online_action1 ] ) as    [ eqn_online_action2 ] @xmath191    where @xmath192 is the battery state of @xmath6 at the beginning of slot @xmath12 .",
    "the solution to ( [ eqn_online_bellman1 ] ) and ( [ eqn_online_action2 ] ) provides the optimal online power policy for finite horizon , which we compare with the offline policy in section  [ sect_numerical ] .    to further simplify the problem",
    ", we additionally consider the infinite horizon problem where the optimal actions are time - invariant .",
    "we formulate this as a discounted dynamic program with the bellman equation @xmath193,\\end{aligned}\\ ] ] where @xmath194 for all @xmath12 and the expectation is over @xmath195 , @xmath5 .",
    "this equation can be solved with value iteration @xcite .",
    "namely , starting from arbitrary initial actions , all actions @xmath196 are updated as the arguments that maximize ( [ eqn_online_bellman2 ] ) , and value functions @xmath197 are updated as in ( [ eqn_online_bellman2 ] ) , until all actions converge to some @xmath198 . here , the _ discount factor _",
    "@xmath199 ensures that the values @xmath197 remain bounded @xcite .",
    "the resulting actions yield an online policy that is optimal under the action restrictions in ( [ eqn_online_action2 ] ) and infinite transmission assumption .",
    "hence , we refer to this policy as the optimal online policy for an infinite horizon .",
    "each value iteration step requires @xmath200 value updates , where @xmath201 is the number of transmit power values after discretization .",
    "hence , the running time of the finite horizon algorithm is @xmath202 for @xmath16 epochs , and storing the optimal policy requires @xmath202 space . on the other hand ,",
    "the optimal policy is time - invariant for the infinite horizon case , and requires only @xmath203 space .",
    "in this section , we demonstrate the optimal policies for the two - way relay channel and compare the performance of the schemes in section  [ sub_model_rates ] and section  [ sect_hybrid ] in the eh setting . in simulations , energy arrivals to node @xmath6 are generated independently from a uniform distribution over @xmath204 $ ] for @xmath5 , with unit epoch lengths @xmath205  s. the noise density is @xmath206  w / hz at all nodes and the bandwidth is @xmath207  mhz .",
    "examples for the optimal transmit power policies found using the algorithm described in section  [ sect_identify ] are shown in figures  [ fig_subgradient_fd2][fig_giwftunnel_df ] for decode - and - forward relaying . in each figure ,",
    "cumulative energy consumed by the nodes for transmission are plotted , the derivative of which yields the average transmit powers of the nodes in each epoch . in the figures",
    ", @xmath0&@xmath1 stands for the total cumulative energy of the nodes @xmath0 and @xmath1 , and mac fraction represents the fraction of the multiple access phase , i.e. , @xmath66 .",
    "we remark that concavified sum - rate functions are used for the simulations , and average transmit powers are shown in the plots for clarity .",
    "pairs of staircases , shown in red and green , represent energy causality and battery capacity constraints on the cumulative power , which is referred to as the feasible energy tunnel @xcite .",
    "a feasible policy remains between these two constraints throughout the transmission period .",
    "figures  [ fig_subgradient_fd2 ] and [ fig_subgradient_fd1 ] are plotted for full - duplex nodes while figures  [ fig_subgradient_hd2 ] and [ fig_giwftunnel_df ] are plotted for half - duplex nodes .",
    "both scenarios are considered for an asymmetric eh - twrc with @xmath208 in figures  [ fig_subgradient_fd2 ] and [ fig_subgradient_hd2 ] , and for a symmetric eh - twrc with @xmath209 in figures  [ fig_subgradient_fd1 ] and [ fig_giwftunnel_df ] .",
    "+     +     +     +    we remark that unlike previous work with simpler channel models , e.g. , @xcite , the optimal cumulative energy or sum - power policy is not necessarily the shortest path that traverses the feasible tunnel .",
    "figure  [ fig_subgradient_fd2 ] shows a setting with @xmath210  mj and @xmath211  mj , i.e. , the relay is energy deprived compared to @xmath0 and @xmath1 .",
    "hence , energy efficiency is critical for the relay while this is not necessarily the case for the remaining nodes that are relatively energy - rich .",
    "this results in the optimal policy being largely dictated by the relay .",
    "note that in figure  [ fig_subgradient_fd2 ] , the relay follows a cumulative energy that resembles the shortest path through the feasible energy tunnel , while for @xmath0 and @xmath1 this is not the case .",
    "in contrast , in figure  [ fig_subgradient_fd1 ] , the multiple access phase is more likely to be limiting because the sum - rate with equal transmit powers at all nodes is limited by the sum - rate constraint of the multiple access phase , see ( [ eqn_rates_hd_mabc_sum ] ) .",
    "thus , the total cumulative energy , denoted with @xmath0&@xmath1 in figure  [ fig_subgradient_fd1](a ) , follows the shortest path within the tunnel , similar to the optimal policy for the multiple access channel in @xcite . however , broadcast powers do not yield binding constraints , implying that contrary to the energy harvesting models previously studied , e.g. , @xcite , the optimal policy for the eh - twrc is not necessarily unique .    comparing figures  [ fig_subgradient_hd2 ] and [ fig_giwftunnel_df ] , which show optimal policies for the half - duplex model , we observe that the time division parameters @xmath66 play an important role in helping energy deprived nodes . by properly selecting @xmath66 ,",
    "the effect of unbalanced energy harvests at the sources and the relay can be mitigated .",
    "however , this still does not imply the shortest path is optimal for each node .",
    "this is due to the interplay of transmit powers though the joint rate function in the objective .",
    "hence , whenever the transmit power changes for one user due to a full battery or an empty battery , the transmit powers of other users are affected as well .",
    "examples to this phenomena can be found in figure  [ fig_subgradient_hd2 ] , at @xmath212  s , where the energy depletion in @xmath2 is observed to affect the transmit powers of @xmath0 and @xmath1 , and in figure  [ fig_giwftunnel_df ] , at @xmath213  s , where the energy depletion in @xmath0 and @xmath1 is observed to affect the transmit power of @xmath2 .",
    "similar results were observed for compress - and - forward , compute - and - forward , and amplify - and - forward relaying through simulations .",
    "we observed that identical energy harvesting profiles and channel parameters yield transmit powers that only differ slightly among relaying schemes .",
    "however , the multiple access phase fractions , @xmath93 , differ notably among relaying schemes in order to achieve matching multiple access and broadcast rates within each epoch . due to the similarity of the transmit power policies , to avoid repetition , we omit the plots for these schemes .",
    "next , we compare the performance of the optimal offline and online policies with upper and lower bounds for a decode - and - forward relay .",
    "we obtain a non - energy - harvesting upper bound by providing the total energy harvested by each node at the beginning of the transmission without a battery restriction .",
    "we also present two nave  transmit power policies , namely the hasty policy and the constant power policy , as lower bounds .",
    "the former policy , also referred to as the spend - as - you - get algorithm @xcite , consumes all harvested energy immediately within the same epoch .",
    "the latter policy chooses the average harvest rate at each node as the desired transmit power , and transmits with this power whenever possible . for both nave  policies , the phase fraction parameters",
    "@xmath66 that maximize the instantaneous sum - rate for the given transmit powers are chosen within each epoch .",
    "we consider a half - duplex eh - twrc with @xmath214  db , and choose the energy harvests for node @xmath6 to be independent and uniformly distributed over @xmath204 $ ] where @xmath215  mj and @xmath216  mj are the peak harvest rates .",
    "the infinite horizon online policy is found using a discount factor of @xmath217 .",
    "the sum - throughput values resulting from these policies with a half - duplex relay in @xmath218 epochs , averaged over @xmath219 independently generated scenarios , are plotted in figure  [ fig_comparison ] . in the figure , the peak harvest rate for node @xmath0 , @xmath220 , is varied in order to evaluate the performance of the policies at different harvesting rate scenarios .",
    "we observe that the optimal online policy , found for a horizon of @xmath221 epochs , as well as its infinite horizon counterpart perform notably better than the nave  policies .    .",
    "the compress - and - forward and amplify - and - forward strategies and omitted since they perform notably worse than those in the plot . ]",
    "finally , we compare the sum - throughput resulting from decode - and - forward , compute - and - forward , compress - and - forward , amplify - and - forward , and hybrid strategies in an eh - twrc .",
    "the same parameters as in figure  [ fig_comparison ] are used in simulations .",
    "the sum - throughput values obtained over a duration of @xmath218 epochs are plotted in figure  [ fig_sims_hybrid_rates ] .",
    "we observe that for low and high transmit powers , either decode - and - forward or compute - and - forward outperforms the other , respectively , while they both exceed the sum - throughput values of compress - and - forward and amplify - and - forward relaying .",
    "however , as expected , the hybrid strategy outperforms all single - strategy approaches , since it performs at least as good as the best one in each epoch .",
    "in this paper , we considered the sum - throughput maximization problem in a two - way relay channel where all nodes are energy harvesting with limited battery storage , i.e. , finite battery .",
    "we considered decode - and - forward , compress - and - forward , compute - and - forward and amplify - and - forward relaying strategies with full - duplex and half - duplex radios . noticing that the best relaying strategy depends on instantaneous transmit powers , we proposed a hybrid relaying scheme that switches between relaying strategies based on instantaneous transmit powers .",
    "we solved the sum - throughput maximization problem for the eh - twrc using an iterative generalized directional water - filling algorithm . for cases where offline information about energy harvests is not available , we formulated dynamic programs which yield optimal online transmit power policies .",
    "simulation results confirmed the benefit of the hybrid strategy over individual relaying strategies , and the improvement in sum - throughput with optimal power policies over nave power policies .",
    "the online policies found via dynamic programming also proved to perform better than their nave alternatives .",
    "it was observed that in a two - way channel with energy harvesting nodes , either of the communication phases , i.e. , broadcast or multiple access phases , can be limiting , impacting the optimal transmit powers in the non - limiting phase as well .",
    "thus , the jointly optimal policies were observed not to be the throughput maximizers for each individual node , or the sum - throughput maximizers for a subset of nodes - a fundamental departure in the structure of optimal policies in previous work @xcite .",
    "we remark that the offline throughput maximization problem for the full - duplex and half - duplex cases when decode - and - forward relaying is used can also be solved using the subgradient descent algorithm as shown in @xcite .",
    "future directions for this channel model include optimal offline and online power policies for more involved models with data arrivals at the sources , data buffers at the relay , or a direct channel between sources .",
    "k.  tutuncuoglu , b.  varan , and a.  yener .",
    "optimum transmission policies for energy harvesting two - way relay channels . in _",
    "icc workshop on green broadband access : energy efficient wireless and wired network solutions _ , june 2013 .",
    "h.  liu , f.  sun , c.  thai , e.  de  carvalho , and p.  popovski .",
    "optimizing completion time and energy consumption in a bidirectional relay network . in _",
    "ieee international symposium on wireless communication systems , iswcs _ , august 2012 .",
    "m.  b. khuzani , h.  e. saffar , e.  h.  m. alian , and p.  mitran . on optimal online power policies for energy harvesting with finite - state markov channels . in _",
    "ieee international symposium on information theory , isit _ , july 2013 .",
    "m.  gorlatova , a.  bernstein , and g.  zussman .",
    "performance evaluation of resource allocation policies for energy harvesting devices . in _ international symposium on modeling and optimization in mobile , ad - hoc and wireless networks , wiopt _ , may 2011 .",
    "k.  tutuncuoglu , b.  varan , and a.  yener .",
    "energy harvesting two - way half - duplex relay channel with decode - and - forward relaying : optimum power policies . in _",
    "ieee international conference on digital signal processing , dsp _ , july 2013 ."
  ],
  "abstract_text": [
    "<S> in this paper , we study the two - way relay channel with energy harvesting nodes . </S>",
    "<S> in particular , we find transmission policies that maximize the sum - throughput for two - way relay channels when the relay does not employ a data buffer . </S>",
    "<S> the relay can perform decode - and - forward , compress - and - forward , compute - and - forward or amplify - and - forward relaying . furthermore </S>",
    "<S> , we consider throughput improvement by dynamically choosing relaying strategies , resulting in hybrid relaying strategies . </S>",
    "<S> we show that an iterative generalized directional water - filling algorithm solves the offline throughput maximization problem , with the achievable sum - rate from an individual or hybrid relaying scheme . </S>",
    "<S> in addition to the optimum offline policy , we obtain the optimum online policy via dynamic programming . </S>",
    "<S> we provide numerical results for each relaying scheme to support the analytic findings , pointing out to the advantage of adapting the instantaneous relaying strategy to the available harvested energy .    </S>",
    "<S> energy harvesting nodes , two - way relay channel , decode / compute / compress / amplify - and - forward , hybrid relaying strategies , throughput maximization . </S>"
  ]
}