{
  "article_text": [
    "since its discovery in 1945 by purcell , torrey and pound , nuclear magnetic resonance ( nmr ) has become a powerful physical tool to study molecules and matter in a variety of domains extending from biology and chemistry to solid physics and quantum mechanics @xcite .",
    "nmr involves the manipulation of nuclear spins via its interaction with a magnetic field , and is therefore a domain where techniques of quantum control can be applied ( see @xcite and references therein ) .",
    "such an approach has many potential applications ranging from the improvement of the resolution and sensitivity of nmr spectroscopy experiments @xcite to quantum computing @xcite .",
    "the control technology developed over the past fifty years allows the use of sophisticated control fields for spectroscopy and also permits the implementation of complex quantum algorithms @xcite .    in this context , some challenging control problems are raised by the experimental constraints of nmr experiments .",
    "roughly speaking , the measured signal is the magnetization of a sample which is produced by a large number of spin systems .",
    "one usually assumes in simple models that the static magnetic field is the same across the sample , i.e. the field is perfectly homogeneous with respect to the different spins .",
    "this is not always true in practice since for technical reasons it is difficult to generate homogeneous fields .",
    "even in the situation where the magnetic field is uniform on a macroscopic scale , the interaction between the different atoms ( or between a spin and its environment ) induces a chemical shift on the frequency transition of a given spin .",
    "this leads classically to an unwanted rotation of each individual spin around a fixed axis which is not taken into account in the simplest model of spin 1/2 particles .",
    "the shift being different for each spin , the rotation is different for each spin .",
    "note that this effect is useful in nmr spectroscopy since it encodes in a sense some informations about the structure of the molecules .",
    "the consequences are negative from a control point of view since this phenomenon decreases the efficiency of the control field .",
    "the objective is therefore to find controls able to bring the system towards a given target state in a sufficiently robust way with respect to inhomogeneities of the transition frequency .",
    "this problem has been solved numerically in different works @xcite leading to very efficient but complicated solutions . in particular , no insight into the control mechanism is gained from this approach and no optimality result has been proven .",
    "note that some related works have been done in the control of molecular dynamics by laser fields @xcite by using monotonically convergent algorithms @xcite .    in this paper",
    ", we propose to revisit this problem by using techniques of geometric optimal control theory @xcite .",
    "geometric optimal control is a vast domain based on the application of the pontryagin maximum principle ( pmp ) where the idea is to use the methods of differential geometry and hamiltonian dynamics to solve the optimal control problems @xcite .",
    "this geometric framework leads to a global analysis of the control problem which completes and guides the numerical computations .",
    "some geometric results on the optimal control of spin systems have been first obtained by n. khaneja and his co - workers @xcite .",
    "recently , the time - optimal control of dissipative spin 1/2 particles has been solved theoretically @xcite and implemented experimentally @xcite . in this work we study the simultaneous control of two non - interacting spins with different resonance frequencies .",
    "more precisely , we consider as an example the problem to simultaneously invert the magnetization vectors initially aligned along the @xmath0- axis defined by the direction of the static magnetic field .    using an appropriate rotating frame , we show that we can always consider the symmetric case where the two transition frequencies are opposed .",
    "in this situation , the time - optimal solution for inverting the two spins by the same transverse radiofrequency ( rf ) control fields is a bang - bang pulse sequence in a frame rotating at the rf frequency .",
    "the remarkable point is that the co - rotating component of the applied rf field is the same as the one used to invert only one spin with one non - resonant control field in the laboratory frame @xcite .",
    "we finally implement experimentally the optimal solution by using techniques of nmr .",
    "the paper is organized as follows . in sec .",
    "[ sec2 ] , we recall the tools to control one spin in minimum time with a transverse magnetic field which is not in resonance with the frequency of the spin . in sec .",
    "[ sec3 ] , we establish that this control field is also the optimal solution to simultaneously invert two spins .",
    "an experimental illustration is given in sec .",
    "a summary of the different results obtained is presented in sec .",
    "we consider the control of a spin 1/2 particle whose dynamics is governed by the bloch equation : @xmath1 where @xmath2 is the magnetization vector and @xmath3 the chemical shift offset .",
    "the dynamics is controlled through only one magnetic field along the @xmath4- axis which satisfies the constraint @xmath5 .",
    "we introduce normalized coordinates @xmath6 where @xmath7 is the thermal equilibrium point , a normalized control field @xmath8 which satisfies the constraint @xmath9 and a normalized time @xmath10 . dividing the previous system by @xmath11",
    ", we get that the evolution of the normalized coordinates is given by the following equations : @xmath12 where @xmath13 is the normalized offset given by @xmath14 .",
    "the complete description of the time - optimal control problem of a spin 1/2 particle by a non - resonant magnetic field is done in ref .",
    "@xcite . in this section ,",
    "we give only a brief summary of the results of this paper which will be used in our study .",
    "the reader is referred to @xcite for the different proofs of these results .",
    "note that when the spin is controlled by two magnetic fields , respectively along the @xmath4 and @xmath15 directions , then the system is equivalent to a two - level quantum system in the rotating wave approximation @xcite .",
    "this means that a unitary transformation can be used to remove the drift term depending on @xmath13 . in this case , the optimal control field is a @xmath16-pulse .    the problem we consider belongs to a general class of optimal control problems for which powerful mathematical tools have been developed @xcite .",
    "they correspond to systems on a two - dimensional manifold ( here the bloch sphere ) controlled by a single field .",
    "the evolution of the system is ruled by the following set of differential equations : @xmath17 where @xmath18 is the two - dimensional state vector and @xmath19 the control field which satisfies the constraint @xmath20 with , here , @xmath21 .",
    "the time - optimal control problem is solved by the application of the pontryagin maximum principle ( pmp ) which is formulated using the pseudo - hamiltonian @xmath22 where @xmath23 is the adjoint state and @xmath24 a negative constant such that @xmath23 and @xmath25 are not simultaneously equal to 0 .",
    "the pontryagin maximum principle states that the optimal trajectories are solutions of the equations @xmath26 introducing the switching function @xmath27 given by @xmath28 one deduces using the second equation of ( [ eqpont ] ) that the optimal synthesis is composed of concatenation of arcs @xmath29 , @xmath30 and @xmath31 .",
    "@xmath29 and @xmath30 are regular arcs corresponding respectively to @xmath32=\\pm 1 $ ] or to the control fields @xmath33 .",
    "a switching from @xmath34 to @xmath35 or from @xmath35 to @xmath34 occurs at @xmath36 when the function @xmath27 takes the value zero and when this zero is isolated .",
    "singular arcs @xmath37 are characterized by the fact that @xmath27 vanishes on an interval @xmath38 $ ] . in this case , differentiating two times @xmath27 with respect to time and imposing that the derivatives are zero , one obtains that the singular arcs are located in the set @xmath39)(\\vec{x})=0\\}.\\ ] ] we recall that the commutator @xmath40 $ ] of two vector fields @xmath41 and @xmath42 is defined by : @xmath43=\\nabla f\\cdot g - f\\cdot \\nabla g\\ ] ] where @xmath44 is the gradient of a function .",
    "the singular control field @xmath45 can be calculated as a feedback control , i.e. as a function of the coordinates by imposing that the second derivative of @xmath27 with respect to time is equal to 0 : @xmath46+u_{s}[f,[g , f]]=0.\\ ] ] the optimal solution can follow the singular lines if the control field is admissible , i.e. if @xmath47 .",
    "since the two - dimensional manifold of our control problem is the bloch sphere , the adapted coordinates are the spherical ones : @xmath48 which leads to the following system : @xmath49 the pseudo - hamiltonian @xmath50 has the form : @xmath51 and the switching function is given by @xmath52 . since @xmath53= \\left(\\begin{array}{c } 0 \\\\ -\\delta\\,\\cos\\,\\phi \\\\ \\delta\\,\\sin\\,\\phi\\,\\cot\\,\\theta \\end{array}\\right)\\ ] ] one deduces that @xmath54 is the set @xmath55 i.e. the singular locus is the equator of the bloch sphere . the time - optimal control problem is solved in @xcite .",
    "it has been shown that the optimal solution reaching the south pole from the north pole is the succession of different bang pulses , i.e. of pulses of maximum intensity @xmath56 .",
    "the number of bangs is at most equal to 2 if @xmath57 and can be larger if @xmath58 .",
    "the singular extremals play no role for this spin inversion .",
    "an example of an optimal pulse sequence and the corresponding trajectory is displayed in figs .",
    "[ fig1 ] and [ fig2 ] .",
    "the optimal trajectory is not smooth at switching points where the value of the control field changes .",
    "the switching times can analytically be determined using the material of ref .",
    "@xcite . in the case of fig .",
    "[ fig1 ] , the optimal solution is a type-2-trajectory described by proposition 5 of @xcite . these times can also be computed numerically by solving a shooting equation .",
    "more precisely , this means that one has to determine the initial adjoint state @xmath59 such that the corresponding hamiltonian trajectory @xmath60 with initial conditions @xmath61 goes to the target @xmath62 at time @xmath63 .",
    "this condition can be expressed as the determination of the roots of the equation @xmath64-\\vec{x}_{f}$ ] which can be solved if one has a sufficiently good approximation of @xmath65 by a standard newton - type algorithm .",
    "note that the control field is determined along the trajectory by computing the switching function @xmath27 .    at this point",
    ", we can extend the previous discussion as a first step towards the simultaneous inversion of two spins .",
    "we analyze the dynamics in a rotating frame by using the rotating wave approximation ( rwa ) where the offsets of the two spins are symmetric and given by @xmath66 .",
    "the rf field is assumed to be at the rotating frame frequency . as a consequence of the symmetries of the problem",
    ", one sees that if @xmath67 , the co - rotating component of the applied rf field , steers the spin with offset @xmath13 from the north pole to the south pole then the same field will also invert the other spin .",
    "the trajectories of the two spins in the @xmath15- and @xmath0- directions will be the same , while it will be opposite along the @xmath4- axis .",
    "note that this solution is not the unique solution and a family of solutions satisfying the same requirement can be determined .",
    "consider the set of control fields defined by @xmath68 where @xmath69 $ ] . if we consider the following rotation @xmath70 of angle @xmath71 along the @xmath0- axis : @xmath72 then the new system in the coordinates @xmath73 is controlled by a single field @xmath67 along the @xmath74- direction .",
    "it is also straightforward to see that this solution is the optimal one for the inversion control of two symmetric spins by one control field .",
    "the question that we ask now is whether this simple solution is the optimal solution of the simultaneous inversion of two spins when two control fields are considered .",
    "we consider two different spin 1/2 particles with the offsets @xmath75 and @xmath76 .",
    "using the same normalization as in sec .",
    "[ sec2 ] and the rwa , one arrives to the following equations : @xmath77 where the coordinates @xmath78 and @xmath79 are respectively associated to the first and second spins @xmath80 and @xmath81 . the parameters @xmath82 and @xmath83 are the offsets of the spins @xmath80 and @xmath81 with respect to the frequency of the rotating frame .",
    "the rf field is here also at the rotating frame frequency .",
    "we assume that the two spins have the same equilibrium point @xmath84 .",
    "as mentioned below , two magnetic fields along the @xmath4- and @xmath15- directions are taken into account in this problem .",
    "they satisfy the constraints @xmath85 . using a rotating frame that rotates at frequency @xmath86",
    ", it is straightforward to transform this system into a symmetric one where the frequencies of the two spins are opposite .",
    "this is the case analyzed below .",
    "we introduce the spherical coordinates for the two spins and we get : @xmath87 where @xmath88 since the radial coordinates @xmath89 play a trivial role in this problem , we omit them in the following equations .",
    "we apply the pmp to this system in the time - optimal case and we obtain the following pseudo - hamiltonian @xmath90 where @xmath23 is the adjoint vector of coordinates @xmath91 . in the normal case , the optimization condition leads to the following optimal controls : @xmath92 where @xmath93 and @xmath94 are not simultaneously equal to 0 .",
    "the singular case occurs when @xmath95 , which defines the switching surface @xmath96 . in the two - control problems , singular trajectories are the trajectories which lie on @xmath96 .",
    "we assume in this paper that these controls do not play any role in our problem .",
    "this is expected since singular extremals are not generically optimal for a two - control problem @xcite .",
    "we get the normal hamiltonian @xmath97 by replacing the control fields by their expressions : @xmath98 the normal extremals will be given by the hamiltonian trajectories of @xmath97 .",
    "the next step of our study will consists in the analysis of this hamiltonian flow .    for that purpose",
    ", we introduce the following canonical transformation on the @xmath99- coordinates : @xmath100 which is defined through the generating function : @xmath101 with the transformation : @xmath102 this leads to @xmath103 the hamiltonian @xmath97 expressed in the new set of coordinates does not depend of @xmath104 , so @xmath105 is a constant of the motion . since at the initial time in the north pole , @xmath106 , one deduces that @xmath107 .",
    "one finally arrives at @xmath108^{1/2}.\\end{aligned}\\ ] ] care has to be taken with the use of these coordinates on the poles of the sphere . on a pole",
    ", we have @xmath109 and @xmath110 but the product @xmath111 remains finite . in this paper ,",
    "spherical coordinates are only used to describe the geometric properties of the extremals and to highlight their symmetries .",
    "all the numerical computations are done in cartesian coordinates .",
    "note also the symmetric role played by @xmath112 and @xmath113 in the hamiltonian @xmath97 .",
    "this symmetry will be used in the proof below .",
    "we first analyze the characteristics of the extremal trajectories which are solutions of the control problem .",
    "in particular , if the inversion is realized by an extremal trajectory then the following relations are satisfied : @xmath114 , p_{\\theta_a}(t)=p_{\\theta_b}(t)~\\textrm{and}~\\theta_a(t)=\\theta_b(t),\\ ] ] where @xmath63 is the control duration .    to show this property ,",
    "we assume that the south pole is reached by the extremal . in this case , the final point satisfies by definition : @xmath115 using the hamiltonian @xmath97 , we obtain : @xmath116 where @xmath117 we consider that @xmath118 which is always possible by a judicious choice of the initial adjoint vector @xmath65 .",
    "this implies that @xmath119 since @xmath120 at a pole .",
    "using the fact that @xmath97 is a constant of motion , one deduces at the final point that @xmath121 .",
    "( [ eqder ] ) , one finally arrives at @xmath122 if @xmath123 then @xmath124 , which is not possible from our hypothesis .",
    "we have therefore @xmath125 and using the hamiltonian equations , we then obtain that @xmath126 and @xmath127 for any time @xmath128 since at time @xmath129 we have @xmath130 and @xmath125 .",
    "we also get that @xmath131 , i.e. @xmath132 . in the new",
    "coordinates @xmath133 and @xmath134 such that @xmath135 and @xmath136 , the sum of the new azimuthal angles is zero and we obtain the following symmetry on the trajectory : @xmath137 for any @xmath138 $ ] . in these coordinates ,",
    "the two control fields are given by @xmath139 from this symmetry , we have @xmath140 and thus @xmath141 . since @xmath142 , this leads to @xmath143 where @xmath144 is a bang - bang pulse of amplitude @xmath56 .",
    "we therefore recover the case of sec .",
    "[ sec2 ] of the optimal control of one spin system .     hz and @xmath145 hz . panel ( b ) : plots of the corresponding optimal trajectories for @xmath146 ( solid black line ) and @xmath147 ( red dashed line ) .",
    "the experimentally measured trajectories are presented by open circles .",
    "panel ( c ) : plot of the optimal trajectory for @xmath148 , together with the experimental representations ( open circles ) .",
    "[ fig1],height=432 ]",
    "here we demonstrate the inversion for the case where the symmetric offsets @xmath149 are four times larger than the maximum radiofrequency ( rf ) amplitude using the techniques of nuclear magnetic resonance . the optimal pulse ( a bang - bang pulse )",
    "is shown in fig .",
    "[ fig1 ] and implemented on a bruker avance 600mhz spectrometer with linearized amplifiers .",
    "the experiment was performed using the two distinct proton spin signals of methyl acetate ( dissolved in deuterated chloroform ) .",
    "the two resonances , one from the @xmath150och@xmath151 moiety and the other from the @xmath150oocch@xmath151 moiety , were separated by 966 hz in the @xmath152h nmr spectrum .",
    "the irradiation frequency was positioned in the center of the two peaks , i.e. @xmath153 , resulting in offsets of @xmath154 hz for the two resonances .",
    "the maximum rf amplitude was chosen to be @xmath155 hz and the duration of the optimal inversion pulse shown in fig .",
    "[ fig1 ] is @xmath156=6.409 ms . at room temperature ( 298k ) , the experimentally measured relaxation time constants of the two spins are @xmath157 s , @xmath158 ms , which have a negligible effect during the much shorter pulse duration @xmath156 .",
    "the @xmath4 and @xmath15 components of the bloch vectors , @xmath159 and @xmath160 were measured experimentally by interrupting the optimal pulse shape after the time @xmath128 and measuring the amplitude and phase of the signal after fourier transformation of the resulting free induction decay ( fid ) . in order to measure the @xmath0 component of the bloch vectors , the experiments were repeated with the addition of a pulsed magnetic field gradient ( of duration about 0.2 ms with sine shape ) , followed by a @xmath161 hard pulse . a reasonable match between simulated and experimentally determined trajectories",
    "for example , fig .",
    "[ fig1 ] shows the simulated and experimental trajectories of @xmath146 , @xmath147 and @xmath148 as a function of time .",
    "[ fig2 ] shows the projections of the simulated and experimental trajectories of both bloch vectors .",
    "hz , in the @xmath162- and @xmath163- plane are shown in ( a ) and ( b ) , respectively .",
    "the simulated trajectories of the two spins are plotted in black solid line and red dashed line .",
    "the experimentally measured trajectories of the two magnetization vectors are represented by open and filled circles.[fig2],title=\"fig:\",height=192 ]   hz , in the @xmath162- and @xmath163- plane are shown in ( a ) and ( b ) , respectively .",
    "the simulated trajectories of the two spins are plotted in black solid line and red dashed line .",
    "the experimentally measured trajectories of the two magnetization vectors are represented by open and filled circles.[fig2],title=\"fig:\",height=192 ]",
    "in this last section , we give a brief overview of the results obtained in this paper .",
    "the four relevant cases for the simultaneous inversion of two spins are the following .    1 .   two control fields along the @xmath4- and @xmath15- directions and one offset @xmath3 :",
    "the optimal solution is a @xmath16- pulse @xcite .",
    "2 .   one control field and one offset @xmath3 : the optimal solution is a bang - bang pulse sequence with a number of switching depending upon the ratio @xmath164 @xcite .",
    "3 .   one control field and two offsets @xmath3 and @xmath165 : the optimal solution is the same as in ( 2 ) .",
    "4 .   two control fields and two offsets @xmath3 and @xmath165 :",
    "the optimal solution is also the same as in ( 2 ) .    *",
    "aknowledgment . * + s.j.g . acknowledges support from the dfg ( gi 203/6 - 1 ) , sfb 631 .",
    "s. j. g. and m. b. thank the fonds der chemischen industrie .",
    "experiments were performed at the bavarian nmr center at tu mnchen and we thank dr .",
    "r. marx for helpful discussions and for suggesting the test sample .",
    "m. h. levitt , _ spin dynamics : basics of nuclear magnetic resonance _ ( john wiley and sons , new york - london - sydney , 2008 ) ; r. r. ernst , g. bodenhausen and a. wokaun , _ principles of nuclear magnetic resonance in one and two dimensions _ ( international series of monographs on chemistry , oxford university press , oxford , 1990 )    l. m. k. vandersypen and i. l. chuang , rev . mod .",
    "phys . * 76 * , 1037 ( 2005 ) ; n. c. nielsen , c. kehlet , s. j. glaser and n. khaneja , in encyclopedia of magnetic resonance , ed .",
    "r. k. harris and r. wasylishen , john wiley , chichester ( 2010 ) .",
    "d. g. cory , a. f. fahmy , and t. f. havel , proc .",
    "usa * 94 * , 1634(1997 ) ; n.a .",
    "gershenfeld and i.l .",
    "chuang , science * 275 * , 350 ( 1997 ) .",
    "m. a. nielsen and i. l. chuang , _ quantum computation and quantum information _",
    "( cambridge university press , cambridge , 2000 ) .",
    "n. khaneja , r. brockett and s. j. glaser , phys .",
    "a * 63 * , 032308 ( 2001 ) ; n. khaneja , s. j. glaser and r. brockett , phys .",
    "a * 65 * , 032301 ( 2002 ) ; h. yuan and n. khaneja , phys .",
    "a * 72 * , 040301(r ) ( 2005 )      d. sugny , c. kontz and h.r .",
    "jauslin , phys .",
    "a * 76 * , 023419 ( 2007 ) ; b. bonnard and d. sugny , siam j. on control and optimization , * 48 * , 1289 ( 2009 ) ; b. bonnard , m. chyba and d. sugny , ieee transactions on automatic control , * 54 * , 11 , 2598 ( 2009 )    t. e. skinner , t. o. reiss , b. luy , n. khaneja and s. j. glaser , j. magn",
    ". reson . * 163 * , 8 ( 2003 ) ; t. e. skinner , t. o. reiss , b. luy , n. khaneja and s. j. glaser , j. magn . reson . * 167 * , 68 ( 2004 ) ; k. kobzar , t. e. skinner , n. khaneja , s. j. glaser and b. luy , j. magn . reson . * 170 * , 236 ( 2004 ) ; t. e. skinner , t. o. reiss , b. luy , n. khaneja and s. j. glaser , j. magn",
    ". reson . * 172 * , 17 ( 2005 ) ; t. e. skinner , k. kobzar , b. luy , r. bendall , w. bermel , n. khaneja and s. j. glaser , j. magn .",
    "reson . * 179 * , 241 ( 2006 ) ; n. i. gershenzon , k. kobzar , b. luy , s. j. glaser and t. e. skinner , j. magn .",
    "reson . * 188 * , 330 ( 2007 ) ; k. kobzar , t. e. skinner , n. khaneja , s. j. glaser and b. luy , j. magn . reson . * 194 * , 58 ( 2008 ) .",
    "g. turinici and h. rabitz , phys .",
    "a * 70 * , 063412 ( 2004 ) ; h. rabitz and g. turinici , phys .",
    "a * 75 * , 043409 ( 2007 ) ; k. sundermann , h. rabitz and r. de vivie - riedle , phys . rev .",
    "a * 62 * , 013409 ( 2000 ) .",
    "w. zhu , j. botina and h. rabitz , j. chem .",
    "* 108 * , 1953 ( 1998 ) ; w. zhu and h. rabitz , j. chem .",
    "phys . * 110 * , 7142 ( 1999 ) ; d. sugny , c. kontz , m. ndong , y. justum , g. dive and m. desouter - lecomte , phys .",
    "a * 74 * , 043419 ( 2006 ) ; d. sugny , m. ndong , d. lauvergnat , y. justum and m. desouter - lecomte , j. photochem . photobiol .",
    "a * 190 * , 359 ( 2007 ) ; m. ndong , l. bomble , d. sugny , y. justum and m. desouter - lecomte , phys . rev .",
    "a * 76 * , 043424 ( 2007 ) ."
  ],
  "abstract_text": [
    "<S> we analyze the simultaneous time - optimal control of two - spin systems . </S>",
    "<S> the two non coupled spins which differ in the value of their chemical offsets are controlled by the same magnetic fields . </S>",
    "<S> using an appropriate rotating frame , we restrict the study to the case of opposite shifts . </S>",
    "<S> we then show that the optimal solution of the inversion problem in a rotating frame is composed of a pulse sequence of maximum intensity and is similar to the optimal solution for inverting only one spin by using a non - resonant control field in the laboratory frame . </S>",
    "<S> an example is implemented experimentally using techniques of nuclear magnetic resonance . </S>"
  ]
}