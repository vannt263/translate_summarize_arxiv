{
  "article_text": [
    "let @xmath1 be a sequence of i.i.d .",
    "random variables in @xmath0 with distribution @xmath2 , and consider an empirical process based on this sequence : @xmath3,\\ ] ] where @xmath4 is a borel subset of @xmath0 and @xmath5 is an empirical distribution .",
    "if sets @xmath4 are chosen as unbounded rectangles @xmath6 = ( -\\infty , x_1]\\times\\cdots\\times(-\\infty , x_d]$ ] , then we obtain more common form of empirical processes indexed by points @xmath7 and denoted @xmath8 , but most of the time we will be using the function - parametric version of empirical process , @xmath9 , \\qquad\\phi\\in l_2(f ) .\\ ] ] as we know ( see , e.g. , @xcite , chapter  2 ) , on properly restricted class of functions @xmath10 , the empirical processes @xmath11 converge to function - parametric brownian bridge @xmath12 . if the distribution @xmath2 is uniform on @xmath13^d$ ] , then @xmath12 becomes a standard brownian bridge , which we denote @xmath14 .",
    "we recall exact definitions in the next section .    in this paper ,",
    "we show that from a certain type of transformation of @xmath11 a unified approach to distribution free testing of hypothesis about @xmath2 is emerging . the approach can be used regardless of whether the hypothesis is simple or parametric , or whether @xmath2 is one - dimensional or multidimensional , and also whether @xmath2 is continuous or discrete .",
    "the last point is demonstrated in @xcite and also in corollary  [ discrete ] , section  [ sec3.1 ] .",
    "we also believe that the approach is simple to implement : on - going research shows that parametric families with , multidimensional parameters , as say , family with 9 parameters , in one of the examples in @xcite , can be studied without noticeable numerical difficulties .    the structure of the transformation in question is the following :",
    "let @xmath15 be a unitary operator of a certain type , acting on @xmath16 , and consider a transformed process @xmath17 the explicit description of the operators we propose to use we defer to section  [ sec3 ] , where we show that the processes so obtained will have very desirable asymptotic properties while being one - to - one transformations of @xmath11 and , therefore , containing the same amount of `` statistical information '' . as a preliminary illustration of one type of results of this form ,",
    "let us formulate the following proposition .",
    "it is a particular case of theorem  [ thm : main1 ] of section  [ sec3.1 ] .",
    "[ notag ] suppose @xmath2 is an absolutely continuous distribution on @xmath13^d$ ] ( different from uniform distribution ) , which has a.e .",
    "positive density @xmath18 .",
    "the process @xmath19^d\\}$ ] with the differential @xmath20^d } \\sqrt{f(y ) } \\,\\mathrm{d}y } \\int_{[0,1]^d}\\frac{1}{\\sqrt{f(y ) } } v_f(\\mathrm{d}y ) \\,\\mathrm{d}x\\ ] ] is the standard brownian bridge .",
    "for goodness of fit theory on @xmath0 , this means that with help of a single stochastic integral above , the asymptotic situation of testing a simple null hypothesis @xmath2 can be transformed into the situation of testing the uniform distribution . in other words ,",
    "transformation ( [ unif ] ) from empirical process @xmath11 possesses the same convenience for asymptotic statistical inference as the uniform empirical process in @xmath13^d$ ] .    as the first step toward ( [ idea ] ) , in section  [ sec2 ] below we will find that there are many more different brownian bridges than is commonly realized .",
    "we will also see , within the same framework , that although their distributions remain mutually singular , the boundary between brownian bridges and brownian motion is somewhat blurred and unitary operators can easily be used to transform brownian bridges into a version of bridges , which are `` almost '' brownian motion .",
    "this is described in section  [ sec3.2 ] .",
    "let us now briefly outline the situation with distribution free goodness of fit testing in @xmath0 .",
    "if @xmath2 is a continuous distribution in @xmath21 , and @xmath22 is the uniform empirical process , then , since @xcite , we know that @xmath11 can be transformed to @xmath22 as @xmath23 or , in function - parametric setting , for @xmath24)$ ] @xmath25 where @xmath26 .",
    "it is good to note that this operator , from @xmath27)$ ] to @xmath16 , is also a unitary operator , that is , @xmath28 } \\phi^2(t ) \\,\\mathrm{d}t , \\ ] ] although there is little tradition of using this terminology , because in this situation it looks inconsequential .",
    "an analog of time transformation @xmath29 exists in @xmath0 as well and is called the rosenblatt transformation , @xcite . in , say , three - dimensional space , in obvious notation , it has the form @xmath30 .",
    "for some reason , and maybe because dealing with conditional distributions is often awkward , the transformation is rarely used .",
    "it also fails to lead to distribution free testing , when @xmath2 depends on a finite - dimensional parameter ( cf .",
    "section  [ sec3.3 ] ) .",
    "a unitary operator , very different in its nature from time transformation , was introduced for the empirical processes in @xmath31-dimensional time in @xcite and @xcite and , in two - sample problem , in @xcite . in its origin",
    "it is connected with the innovation problem for curves in hilbert spaces , @xcite , and the theory of innovation martingales ; see , for example , @xcite , section  7.4 . in its simplest form , it is an operator from @xmath32 onto @xmath16 and the result was a one - to - one transformation from brownian bridge @xmath12 to brownian motion @xmath33 .",
    "it extends to the case of parametric hypothesis in @xmath0 .",
    "we comment further on it in section  [ sec3.2 ] .",
    "the approach of this paper seems to us closest to the geometric argument behind k. pearson s chi - square statistic , @xcite ; see also retrospective historic account in @xcite .",
    "the idea itself is very simple and it is somewhat strange that it was not discovered before . in the case of one given @xmath2 ,",
    "the operators involved will map @xmath34 in @xmath35 and subsequently transform one brownian bridge , @xmath12 , into another brownian bridge , @xmath36 , with @xmath37 of our choice .",
    "just as fisher @xcite and @xcite has extended chi - square theory to the parametric case , our approach as we said , also extends to the case of parametric families ; see section  [ sec3.3 ] .",
    "next , in section  [ sec2 ] , as we said , we present a somewhat broader definition of brownian bridges as projected brownian motions . in section  [ sec3 ] , we present the main results .",
    "the case of a simple hypothesis , which also serves as an illustration of the whole approach , is treated in section  [ sec3.1 ] , the transformation to `` almost '' brownian motion is shown in section  [ sec3.2 ] , while the case of parametric hypotheses is considered in section  [ sec3.3 ] . in section  [ sec3.4 ] , we discuss the problem of uniqueness of the proposed transformations . in the last section  [ sec4 ]",
    ", we illustrate the rate of convergence of transformed empirical processes to their distribution free limits through the rate of convergence of the two classical goodness of fit statistics based on these processes : kolmogorov  smirnov statistic and omega - square statistic .",
    "consider @xmath39 , a function parametric @xmath2-brownian motion , which is a linear functional in @xmath40 and for each @xmath40 is a gaussian random variable with mean @xmath41 and variance @xmath42 this implies that the covariance between @xmath43 and @xmath44 is @xmath45 as far as we are not considering trajectories of @xmath43 in @xmath46 , we need only to know that @xmath40 is indeed square integrable with respect to @xmath2 .",
    "for the theory of @xmath43 as linear functionals on @xmath16 and reproducing kernel hilbert spaces , where they live , we refer , for example , to @xcite or the monograph @xcite .    let @xmath47 denote the function - parametric @xmath2-brownian bridge , defined as a linear transformation of @xmath33 : @xmath48 here , we used @xmath49 for the function identically equal to @xmath50 .",
    "this transformation has a particular structure , which is important for what follows .",
    "namely , we have the following lemma .",
    "[ lem : project ] equality ( [ bvm ] ) represents @xmath12 as an orthogonal projection of @xmath33 parallel to the function @xmath49 .",
    "this statement was initially proved as early as @xcite .",
    "we show its proof here for readers convenience .",
    "proof of lemma  [ lem : project ] to shorten notation , denote the right - hand side of ( [ bvm ] ) by @xmath51 , so that ( [ bvm ] ) takes the form @xmath52 . then it is easy to see that @xmath53 or @xmath54 , so that @xmath55 is indeed a projector .",
    "besides , @xmath56 , which , in usual terminology ( see , e.g. , @xcite , section  1.10 , and @xcite ) , means that the linear functional @xmath57 and the function @xmath49 are orthogonal .    substituting the indicator function @xmath58}$ ] , from ( [ bvm ] ) we obtain @xmath59 which represents trajectories of @xmath60 as projection of trajectories of @xmath33 .",
    "it also leads to the definition of @xmath12 as the gaussian process in @xmath61 with mean @xmath41 and variance @xmath62 ( or covariance @xmath63 )",
    ".    we can now replace @xmath49 with any other function @xmath38 of unit @xmath16-norm .",
    "this will lead to the process @xmath64 which certainly is again a projection of @xmath33 parallel to @xmath38 and , therefore , also could be called brownian bridge .",
    "however , it does not satisfy the second definition of a bridge .",
    "this is more visible in point - parametric version @xmath65 and the variance of @xmath66 is of a different form : @xmath67 ^ 2 = f(x ) - \\biggl[\\int_{y\\leq x } q(y ) \\,\\mathrm{d}f(y)\\biggr]^2 , \\ ] ] so that if @xmath68 , the second term is not square of the first . therefore , even in one - dimensional case , with @xmath2 being just uniform distribution on interval @xmath13 $ ] , the distribution of @xmath69 ^ 2 \\,\\mathrm{d}f(x)$ ] is not omega - square distribution unless @xmath70 @xmath2-a.e .",
    "we call @xmath71 a slightly longish name of a _ @xmath38-projected @xmath2-brownian motion_. the processes @xmath66 arise naturally as weak limits in certain statistical problems and they will be useful in this paper .",
    "we stress again , that the definition of @xmath66 involves two objects  a distribution @xmath2 and a function @xmath72 .",
    "when @xmath2 is uniform distribution on @xmath13^d$ ] we call @xmath66 a @xmath38-projected standard brownian motion ( or simply @xmath38-projected brownian motion ) and use , most of the time , notation @xmath73 without index @xmath2 . in the case of general @xmath2 , we would still call @xmath74 a brownian bridge and often omit @xmath49 from notation .",
    "obviously @xmath75 is just a standard brownian bridge @xmath14 .",
    "we formulate the lemma below for convenience of reference later on .",
    "[ lem : newbridge ] suppose distribution @xmath2 is supported on the unit cube @xmath13^d$ ] and has a.e .",
    "positive density @xmath18 .",
    "suppose @xmath76 is standard brownian motion on @xmath13^d$ ] and @xmath12 is defined as in ( [ bvm ] ) and ( [ fbridge ] ) .",
    "then @xmath77 is @xmath38-projected standard brownian motion with @xmath78 , @xmath79^d } \\sqrt{f(y ) } w(\\mathrm{d}y),\\ ] ] or , for @xmath80^d)$ ] , @xmath81 conversely , if @xmath82 is @xmath38-projected standard brownian motion , then @xmath83 is @xmath2-brownian bridge , as defined in ( [ fbridge ] ) , with @xmath84 .    the first statement of the lemma follows from the connection ( [ fbridge ] ) between @xmath12 and @xmath33 .",
    "indeed , substitute the normalized differential of @xmath12 , @xmath85 in the definition of @xmath86 to obtain @xmath87 and note that @xmath88 is the standard brownian motion ",
    "it obviously is @xmath41-mean gaussian process with independent increments and @xmath89 ^ 2= \\int_{y\\leq x } \\frac{1}{f ( y ) } f(\\mathrm{d}y ) = x.\\ ] ] note also that we can write @xmath90 as @xmath91^d } \\sqrt{f(y ) } w(\\mathrm{d}y).\\ ] ]    note , that the normalization @xmath92 by @xmath93 does not help to standardize @xmath94  in ( [ extra1 ] ) we still have linear functional @xmath95 , and thus , the dependence on @xmath2 in @xmath82 is still present .",
    "this was well understood for a very long time , and it is quite unexpected that using one extra stochastic integral ( see proposition  [ notag ] ) , the standardization becomes possible .",
    "the normalization by @xmath96 used in the lemma is a particular form of the more general mapping .",
    "namely , let @xmath37 be another distribution on @xmath0 , which is absolutely continuous with respect to @xmath2",
    ". then the function @xmath97 belongs to @xmath16 .",
    "and moreover , if @xmath98 , then @xmath99 and @xmath100 .",
    "if distributions @xmath37 and @xmath2 are equivalent ( mutually absolutely continuous ) , then the inverse is also true : if @xmath101 then @xmath102 , and the norm is preserved .",
    "this , in particular , means that re - normalization of @xmath2-brownian motion into @xmath37-brownian motion is straightforward : if @xmath43 is an @xmath2-brownian motion in @xmath101 , then @xmath103 is a @xmath37-brownian motion in @xmath104 .",
    "this , we repeat , does not extend to @xmath66 and @xmath12  the distribution of , say , @xmath105 depends on both @xmath2 and @xmath37 . the first theorem in section  [ sec3 ] below shows , however , that a simple isomorphism exists .    to describe one more object we consider in this paper , complement @xmath49 by a sequence of orthonormal functions @xmath106 , which are also orthogonal to @xmath49 , and consider the process @xmath107 similar to what we said about @xmath12 , the process @xmath108 is the orthogonal projection of @xmath33 parallel to the functions @xmath109 .",
    "we still call @xmath108 a @xmath38-projected @xmath2-brownian motion",
    ". it may be that notation @xmath110 is used again , but when @xmath38 is a vector function , there is no other `` more traditional '' notion to be confused with @xmath111 ; so we skip @xmath38 as an upper index .",
    "the role of the process @xmath111 becomes clear when we examine asymptotic behavior of the parametric empirical process .",
    "consider the problem of testing parametric hypothesis that the distribution function of @xmath112s belongs to a given family of distribution functions @xmath113 , depending on a finite - dimensional parameter @xmath114 .",
    "the value of this parameter is not prescribed by the hypothesis and has to be estimated using the sample @xmath115 .",
    "denote @xmath116\\ ] ] the parametric empirical process ( indexed by sets ) .",
    "( note that , in presence of @xmath114 and @xmath117 , one can skip index @xmath2 in notation . ) as has been known since kac _",
    "et al_. @xcite and later durbin @xcite and other work , the asymptotic behavior of empirical processes with estimated parameters is different from that of @xmath11 , and in particular , its limit distribution depends not only on the true value of the parameter but also on the score function .",
    "however , we can say more .",
    "namely , under usual and mild assumptions ( see , e.g. , @xcite , chapter  3 , and see the modern exposition in @xcite , section  5 ) , the mle @xmath118 possesses an asymptotic representation @xmath119 where we denote by @xmath120 and @xmath121 the hypothetical density and the vector of its derivative with respect to parameter @xmath114 and denote @xmath122 the fisher information matrix .",
    "consequently , the parametric empirical process has asymptotic expansion @xmath123\\\\[-8pt ] & = & v_n(b , \\theta ) - \\int_{b } \\beta_f^t(y ) f_{\\theta } ( \\mathrm{d}y ) \\int _ { y\\in{\\mathbb{r}^d } } \\beta_f(y)v_n(\\mathrm{d}y,\\theta ) + \\mathrm{o}_p(1),\\nonumber\\end{aligned}\\ ] ] where @xmath124 as shown in @xcite ( see also @xcite , section  2.2 ) , the main part of this expansion represents @xmath125 as the orthogonal projection of @xmath126 parallel to the normalized score function @xmath127 and , therefore , the limit in distribution of @xmath128 can be written ( in function - parametric form ) as @xmath129 at the same time , the score function @xmath127 is orthogonal to the function @xmath49 and its coordinates are orthonormal and will play the role of functions @xmath106 above .",
    "therefore , substituting representation ( [ bvm ] ) of @xmath12 through @xmath33 , we see that the limit in distribution of the process @xmath130 is @xmath111 .",
    "it is well known that the actual weak convergence statement in function - parametric set - up requires some restriction on the underlying class of functions @xmath40 , but these restrictions are well understood and we refer readers to @xcite . for an earlier proof in skorohod space , see @xcite and @xcite , while for the proof in @xmath16 see @xcite .",
    "the main geometric idea in this paper can be described as follows .",
    "when testing for fixed distribution @xmath2 , the corresponding empirical processes will converge to @xmath12 , which is an orthogonal projection of the brownian motion .",
    "when testing for a different @xmath37 , there will be convergence to @xmath36 , which is also an orthogonal projections of brownian motion .",
    "however , we will see that if @xmath37 and @xmath2 are equivalent ; these projections can be `` rotated '' to each other .",
    "the unitary operators involved in this rotation form a group , transient on the class of all brownian bridges with all @xmath37 equivalent to the @xmath2 . in other words , the problem of testing @xmath2 can be mapped to the problem of testing @xmath37 and vice versa , and these , seemingly distinct problems are not distinct problems , but form one equivalence class .",
    "therefore , one representative of each equivalence class is sufficient , and we propose a form of such representative . since the processes @xmath111 and @xmath131 are both orthogonal projections as well , the idea of unitary transformation extends to the parametric classes of distributions .",
    "although the following theorem  [ thm : main1 ] is generalized by theorem  [ thm : main2 ] , by starting with the case of one fixed @xmath2 and giving an independent proof we hope to make the overall presentation more transparent .",
    "consider an operator on @xmath16 @xmath132 where @xmath133 is identity operator and @xmath134 is the function defined in ( [ l ] ) , while the function @xmath49 identically equals 1 .",
    "below we will also need the linear subspace @xmath135 , generated by functions @xmath49 and @xmath134 and functions @xmath136 and @xmath137 , which are parts of @xmath134 and @xmath49 , orthogonal to @xmath49 and @xmath134 , respectively , @xmath138 it is clear that @xmath139 form two orthonormal bases of @xmath140 .    the operator @xmath15 has the following properties .",
    "[ lem : koperat ] operator @xmath15 is a ( self - adjoint ) unitary operator on @xmath16 , @xmath141 , such that @xmath142 coordinate representation of this operator is @xmath143 where @xmath144 is the projection operator on the subspace of @xmath16 orthogonal to @xmath140 .    the reader can easily verify the lemma .",
    "part ( i ) is needed just below , part ( ii ) will be useful to draw similarity with section  [ sec3.3 ] . below .",
    "note that one could use a similar unitary operator , with @xmath145 replaced by @xmath146 .",
    "we chose the present form only because the norm @xmath147 is a well - known object ",
    "the hellinger distance between distributions @xmath2 and @xmath37 . to what extent",
    "the choice of @xmath15 is unique is discussed in section  [ sec3.4 ] .",
    "note also that @xmath148    [ thm : main1 ] suppose distribution @xmath37 is absolutely continuous with respect to distribution @xmath2 ( and different from @xmath2 ) . if @xmath12 is @xmath2-brownian bridge , then the process with differential @xmath149\\\\[-8pt ] & & { } - \\int _ { y\\in{\\mathbb{r}^d } } l(y ) v_f(\\mathrm{d}y ) \\frac{1 } { 1- \\int_{y\\in{\\mathbb{r}^d } } l(y ) \\,\\mathrm{d}f(y ) } \\bigl[l^2(x ) - l(x)\\bigr ] f(x ) \\,\\mathrm{d}x \\nonumber\\end{aligned}\\ ] ] is @xmath37-brownian bridge .",
    "if distributions @xmath37 and @xmath2 are equivalent , that is , if @xmath150 is positive @xmath2-a.e .",
    ", then ( [ g - to - f ] ) is one - to - one .",
    "if @xmath2 is an absolutely continuous distribution on the unit cube @xmath13^d$ ] and its density @xmath18 is positive a.e .",
    ", while @xmath37 is uniform on this cube , then @xmath151 and we obtain the transformation of @xmath2-brownian bridge into the standard brownian bridge , already given in proposition  [ notag ] .",
    "it was interesting to realize that @xmath36 in ( [ g - to - f ] ) remains @xmath37-brownian bridge even if @xmath152 can be @xmath41 on a set of positive probability @xmath2 .",
    "proof of theorem  [ thm : main1 ] as we know , for any function @xmath98 , under our conditions , @xmath153 . since @xmath154 ,",
    "the function - parametric form of ( [ g - to - f ] ) is @xmath155 we need to show that the covariance operator of @xmath36 is that of @xmath37-brownian bridge . for this",
    "it is sufficient to consider the variance of @xmath156 , @xmath157 ^ 2 = e\\bigl[v_f(k \\phi)\\bigr]^2 = \\|k \\phi\\|^2_f - \\bigl [ \\langle k \\phi , q_0\\rangle_f\\bigr]^2 .\\ ] ] however , @xmath158 and , using ( [ hellinger1 ] ) , we obtain @xmath159 therefore , @xmath157 ^ 2 = \\| \\psi\\|^2_g - \\bigl[\\langle\\psi , q_0\\rangle_g\\bigr]^2 , \\ ] ] which is the expression for the variance of @xmath37-brownian motion .",
    "although any distribution @xmath2 in @xmath0 can be mapped to a distribution on the unit cube , in some cases this mapping may involve unpleasant technicalities .",
    "corollary  [ cor : g - bridge ] helps to make this mapping very simple , and actually unnecessary , in a wide class of situations .",
    "the idea is that @xmath12 can be transformed into @xmath36 , and for this @xmath37 the mapping to the unit cube will be immediate .",
    "namely , choose @xmath31 densities @xmath160 on @xmath21 , and let @xmath161 denote @xmath162 .",
    "then @xmath163 is direct @xmath31-dimensional analogue of kolmogorov time transformation @xmath164 on the real line .",
    "it seems clearer to give the formulation of the next statement for rectangles rather than for general borel sets @xmath4 .",
    "[ cor : g - bridge ] suppose @xmath160 are such that the distribution @xmath37 with density @xmath165 is absolutely continuous with respect to @xmath2 .",
    "suppose the points @xmath166^d$ ] and @xmath7 are connected as in ( [ time ] ) . if @xmath12 is @xmath2-brownian bridge and @xmath36 is its transformation ( [ g - to - f ] ) , then the process @xmath14 , @xmath167 is a standard brownian bridge on @xmath13^d$ ] .",
    "it is now clear that there is no need to perform the time transformation ( [ time ] ) , because it is obvious how to choose test statistics from @xmath36 , which are invariant under this transformation .",
    "for example , for @xmath37 as in ( [ time ] ) , the statistics @xmath168 have distributions independent from @xmath37 and , hence , from the initial distribution @xmath2 . on the other hand ,",
    "the class of distributions @xmath2 for which the product distribution @xmath37 exists , and then there are infinitely many of them , is broad : any distribution which has rectangular support , whether bounded or unbounded , is such a distribution .",
    "equivalently , if the copula function corresponding to @xmath2 has positive density on @xmath13^d$ ] , then @xmath37 exists ( see , e.g. , @xcite and @xcite for such examples ) and one can choose @xmath169 as marginal densities of @xmath2 .",
    "as an immediate consequence of theorem  [ thm : main1 ] for finite @xmath170 , we have the following weak convergence statement .",
    "consider the process @xmath171\\\\[-8pt ] & & { } - \\int_{y\\in{\\mathbb{r}^d } } l(y ) v_{nf}(\\mathrm{d}y ) \\frac{1 } { 1- \\int_{y\\in{\\mathbb{r}^d } } l(y ) \\,\\mathrm{d}f(y ) } \\biggl[g(x ) - \\int_{y\\leq x }",
    "l(y ) \\,\\mathrm{d}f(y ) \\biggr ] . \\nonumber\\end{aligned}\\ ] ]    [ cor : finite n ]",
    "let @xmath36 be the point - parametric @xmath37-brownian bridge defined in ( [ g - to - f ] ) .",
    "then , as @xmath172 , @xmath173    in other words , the limit distribution of @xmath174 under @xmath2 is the same as the limit distribution of empirical process @xmath175 under @xmath37 .",
    "if @xmath2 has a rectangular support , then , as noted above , @xmath37 of product form exists .",
    "then , using ( [ time ] ) , @xmath174 can further be transformed into a process , which under @xmath2 , converges in distribution to the standard brownian bridge @xmath14 . in other words ,",
    "construction of asymptotically distribution free test statistics from @xmath174 becomes obvious , cf .",
    "( [ df - stat ] ) .    for the proof of this corollary , note that the weak convergence statement for the first integral in ( [ g2f - n ] ) as a process in @xmath61 easily follows from , say theorem  2.5.2 of @xcite , as it can be viewed as statement for function - parametric process indexed by functions @xmath176}(y)$ ] , which certainly satisfy the conditions of that theorem .",
    "convergence of the second integral , with respect to @xmath11 , is also clear , while the rest is a fixed deterministic function .",
    "our last corollary in this section uses the fact that in theorem  [ thm : main1 ] we did not need absolute continuity of @xmath37 and @xmath2 with respect to lebesgue measure , but only absolute continuity of @xmath37 with respect to @xmath2 .",
    "therefore , we can consider discrete distributions with infinitely many positive probabilities .",
    "suppose @xmath177 is a countable collection of points of , say , @xmath0 , and @xmath2 is a ( discrete ) probability distribution on @xmath178 with probabilities @xmath179 .",
    "suppose @xmath37 is another distribution on @xmath177 with probabilities @xmath180 .",
    "definition of @xmath12 and @xmath33 , as gaussian processes with prescribed covariance , carries out to the case of discrete @xmath2 without change .",
    "the differential @xmath181 will now be a jump of @xmath12 at @xmath182 and will be @xmath41 at any other @xmath61 .",
    "thus , we obtain the following statement . it can be viewed as an extension of theorem  1 , ( ii ) , of @xcite for @xmath183 . in its form",
    ", it is no different from ( [ g - to - f ] ) but for the fact that @xmath2 discrete .",
    "[ discrete ] for @xmath184 , let @xmath185 .",
    "if @xmath12 is @xmath2-brownian bridge ( on @xmath186 ) , then the process @xmath187\\\\[-8pt ] & & { } - \\int_{y\\in \\mathcal{x } } l(y ) v_f(\\mathrm{d}y ) \\frac{1 } { 1-\\int_{y\\in\\mathcal { x } } l(y ) \\,\\mathrm{d}f(y ) } \\int _ { y\\in b\\cap \\mathcal{x } } \\bigl(\\mathrm{d}g(y ) - l(y )",
    "\\,\\mathrm{d}f(y)\\bigr ) \\nonumber\\end{aligned}\\ ] ] is @xmath37-brownian bridge .",
    "weak convergence statement in discrete case is very simple : with no possibility of misunderstanding , denote the transformation in ( [ disc ] ) applied to @xmath11 again by @xmath174 . for any functional , or statistic ,",
    "@xmath188 based on this @xmath189 , which has the property that for arbitrary small @xmath190 there is a finite collection of points @xmath191 , and a functional @xmath192 , which depends only on @xmath193 and is such that @xmath194 for all sufficiently large @xmath170 , then @xmath195      consider one more form of unitary transformations , applied to a brownian bridge .",
    "it takes somewhat unusual form and seems important in its own right .",
    "in particular , it shows how blurred the difference between brownian motions and brownian bridges can become and , using some freedom of speech , that `` a brownian motion can be also a brownian bridge '' .",
    "let the distribution @xmath2 be supported on @xmath13^d$ ] and have there a.e .",
    "positive density @xmath18 .",
    "let @xmath196 be a fixed subset of @xmath13^d$ ] and let @xmath197 denote the square root of a density concentrated on @xmath196 , that is , @xmath198 if @xmath199 , and @xmath200 .",
    "it is appropriate to think about @xmath196 as a `` small '' set , although there will be no formal requirement on this . as we know",
    "( see lemma [ lem : newbridge ] in section  [ sec2 ] ) , the process with the differential @xmath201 is the @xmath202-projected standard brownian motion . at the same time , the process with the differential @xmath203 is the @xmath204-projected standard brownian motion , cf .",
    "( [ extra ] ) , and satisfies orthogonality condition @xmath205 in other words , the distribution @xmath2 is , in the both cases , just uniform distribution on @xmath13^d$ ] , but the processes are projected parallel to different functions .",
    "what we want to do now is to rotate @xmath82 to @xmath206 .",
    "since @xmath207 and @xmath208 are now defined on @xmath27^d)$ ] , for our rotation we need to use operator @xmath209 which is ( self - adjoint ) unitary operator on @xmath27^d)$ ] and maps @xmath204 to @xmath210 .",
    "( here and in the proof below , in inner products and norms in @xmath27^d)$ ] we skip the index @xmath2 . )",
    "the result , the process @xmath211 is what we consider in the next statement .",
    "although a general principle here remains the same , we believe it is more convenient to formulate it as a theorem and give the proof .",
    "[ cor : nine ] choose @xmath212 to be a density on @xmath196 . with above assumption on @xmath2 ,",
    "the process with differential @xmath213 is a standard brownian motion on @xmath13^d\\setminus a$ ] , while @xmath214    in other words , @xmath206 is @xmath204-projected standard brownian motion .",
    "proof of theorem  [ cor : nine ] the last equality follows from definition of @xmath206 . using the process @xmath82 , see lemma  [ lem : newbridge ] , we easily see that the function - parametric form of the process @xmath206 is @xmath215 now note that from the definition of @xmath82 in ( [ extra1 ] ) it easily follows that for @xmath216^d)$ ] @xmath217 also note that @xmath218 which will somewhat simplify notations below .",
    "thus , we obtain @xmath219 or @xmath220 , \\end{aligned}\\ ] ] and after simplifications within the square brackets we finally obtain @xmath221 which proves the claim : restriction @xmath222^d\\setminus a$ ] is equivalent to restriction that @xmath40 is orthogonal to all @xmath204 with given @xmath196 , in which case we obtain the variance of just brownian motion , while if @xmath223 the variance of @xmath224 is @xmath41 .",
    "if we choose @xmath225 as the uniform density on @xmath196 , @xmath226 , with @xmath227 , then the process @xmath206 , or rather the finite @xmath170-version of the process , is certainly @xmath228 which integrates to @xmath41 on @xmath196 .",
    "this , however , should not be perceived as a `` loss of observations on @xmath196 '' : the integral with respect to @xmath11 over @xmath196 enters the differential of @xmath229 at all @xmath230 .",
    "if we choose @xmath231 as the conditional density of @xmath2 given @xmath196 , @xmath232 , then @xmath233 is another asymptotically brownian motion on @xmath13^d\\setminus a$ ] . in this version integration over @xmath196 , where @xmath18 may happen to be numerically small ,",
    "is replaced by @xmath234 .",
    "the latter is simpler to calculate and may have better convergence properties than the integral @xmath235 ( cf . figures  [ fig : normedmotion ] and [ fig : motion ] of section  [ sec4 ] ) .    a one - to - one transformation , of a different nature , of a brownian bridge to a brownian motion was earlier suggested in @xcite and @xcite .",
    "it is interesting to compare that transformation with the present one . for this",
    "we need a so called scanning family of subsets @xmath236 , of @xmath13^d$ ] , which is increasing , @xmath237 for @xmath238 , and such that @xmath239 and @xmath240 is continuous in @xmath241 .",
    "then , with @xmath82 as above , the process @xmath242 is not only a gaussian martingale in @xmath241 , but also has independent increments in @xmath243 , so that @xmath244 is a brownian motion in @xmath245^d$ ] .",
    "the latter expression is a multidimensional extension of the classical situation for @xmath246 and @xmath247 on @xmath13 $ ] , when the @xmath248 is the standard brownian bridge . indeed , from the above we obtain the well - known representation of @xmath249 as a gaussian semimartingale @xmath250 where @xmath251 is brownian motion .",
    "in statistical context , see its use in @xcite and @xcite , section  1 ; see also @xcite , chapter  6 . the inverse of this representation , @xmath252 was used for statistical purpose as early as @xcite .",
    "the transformation of theorem  [ cor : nine ] is simpler ; for @xmath253\\subseteq[0,1]$ ] it takes the form @xmath254 and represents a brownian bridge on @xmath255 $ ] and brownian motion on @xmath256 $ ] .",
    "although in last three displays the same process @xmath14 is transformed and the same , in distribution , process is obtained on @xmath256 $ ] as a result , the transformations are very different .",
    "we extend now the results for the case of fixed @xmath2 to the parametric case .",
    "namely , along with distribution @xmath257 and its orthonormal score function @xmath127 , consider now another distribution @xmath37 together with orthonormal vector @xmath258 , with coordinates in @xmath259 , of the same dimension as @xmath127 .",
    "one may think about this vector @xmath260 as a score function of a more or less fictitious parametric family to which @xmath37 belongs .",
    "let us augment both score functions by a function identically equal  1 .",
    "if @xmath37 is absolutely continuous with respect to @xmath2 , then the vector @xmath261 is orthonormal in @xmath16 .",
    "use notation @xmath262 for a subspace of functions @xmath263 where we recall , @xmath264 and @xmath265 , are coordinate functions of @xmath127 . in the subspace @xmath262 ,",
    "consider two bases .",
    "one , the @xmath266 basis , has coordinate functions @xmath267 for @xmath268 while @xmath269 , is any orthonormal sequence , which complements @xmath270 to a basis in @xmath271 . the other , @xmath206 basis , has coordinate functions @xmath272 , and @xmath273 , can be any orthonormal sequence , which complements @xmath274 to a basis in @xmath275 .",
    "let @xmath276 be the unitary operator in @xmath277 , defined as @xmath278 where @xmath279 is projector on the orthogonal complement of @xmath271 to @xmath16 . for convenience ,",
    "let us single out three short statements as a lemma .",
    "[ lem : lemsec4 ] the operator @xmath276 is unitary on @xmath280 .",
    "it maps basis @xmath206 into basis @xmath266 while it maps any function , orthogonal to @xmath262 to itself : @xmath281 for a function @xmath40 consider its projection parallel to functions @xmath282 , @xmath283 then @xmath284    in other words , according to ( ii ) , the processes @xmath111 and @xmath33 coincide on the subspace of functions orthogonal to @xmath282 . both ( i ) and ( ii ) can be easily checked .",
    "for example , the last equality follows from the definition of @xmath111 in section  [ sec2 ] .",
    "[ thm : main2 ] if @xmath111 is @xmath38-projected @xmath2-brownian motion and @xmath37 is absolutely continuous with respect to @xmath2 , then @xmath285 or , more explicitly , @xmath286 is @xmath287-projected @xmath37-brownian motion .",
    "if @xmath37 and @xmath2 are equivalent , then this transformation is one - to - one .    from the point of view of this theorem , testing of various parametric families with square integrable score functions of the same dimension and equivalent @xmath257 and @xmath288 , is not a multitude of various unconnected testing problems ; since these testing problems can be mapped into one another they can be glued in equivalence classes .",
    "one representative from each class is , therefore , sufficient to use and this makes the testing asymptotically distribution - free .",
    "proof of theorem  [ thm : main2 ] first , we prove that @xmath289 is @xmath287-projected @xmath37-brownian motion in @xmath290 , and then we show that explicit expression of the right - hand side is that given in ( [ main2 ] ) .",
    "consider @xmath291 the second equality here uses part ( i ) of the lemma .",
    "the last display in part ( ii ) shows that we need to consider projection of the latter function parallel to @xmath292 . in taking this projection ,",
    "the sum @xmath293 will be annihilated , so that the projection is @xmath294 therefore , again using ( ii ) , @xmath295 the first difference in ( [ project ] ) is orthogonal to the second sum .",
    "therefore , @xmath296 for @xmath297 , the latter expression is equal to @xmath298 which is the variance of @xmath289 .",
    "to arrive now at the explicit form ( [ main2 ] ) of @xmath289 , rewrite ( [ project ] ) as @xmath299 and use orthogonality of @xmath12 to @xmath292 .",
    "weak convergence result , which follows from our theorem , is easy to formulate in function - parametric as well as set - parametric versions , but it is somewhat more convenient for application to consider , again , the point - parametric version of the parametric empirical process , where the family of functions @xmath290 is chosen as a family of indicator functions , @xmath300}(y)$ ] , indexed by  @xmath61",
    ". then transformation in ( [ main2 ] ) applied to @xmath301 leads to the process @xmath302\\\\[-8pt ] & & { } - \\sum_{i=\\kappa+1}^{2\\kappa+1 } \\int_{y\\in{\\mathbb{r}^d } } a_i(y ) v_n(\\mathrm{d}y,\\hat{\\theta}_n ) \\int_{y\\leq x } \\bigl(a_i(y ) - b_i(y ) \\bigr ) \\,\\mathrm{d}f(y ) .",
    "\\nonumber\\end{aligned}\\ ] ] weak convergence of the process @xmath303 was considered in a very large number of publications ; among the first we know of are @xcite and much later , but still long ago , @xcite .",
    "certain ( incomplete ) review is given in @xcite , chapter  3.5 ; convergence of @xmath304 on countably many square integrable functions was studied in @xcite . based on this , we take the weak convergence of the first integral in ( [ param - finite - n ] ) as a process in @xmath61 as given , as well as convergence of integrals from @xmath305 with respect to @xmath303 .",
    "their joint weak convergence is obvious and this leads to the statement @xmath306 if @xmath257 in our parametric family have rectangular support in @xmath0 then , as we already mentioned , the product distribution @xmath37 exists and we can proceed as in corollary  [ cor : finite n ] .",
    "however , one point here needs some remark .",
    "the most natural choice of @xmath37 will be a product of the marginal distributions of @xmath257 and , therefore , @xmath307 will depend on @xmath114 as well .",
    "all functions , @xmath308 , which participate in the transformation , will also depend on @xmath114 .",
    "the latter is true even if one chooses one common @xmath37 for all @xmath257 , simply because @xmath257 and , therefore , @xmath309 as well , depend on  @xmath114 .",
    "hence , in ( [ param - finite - n ] ) the functions @xmath310 will have to be used .",
    "this , however , creates only a minor problem : in simple continuity assumptions on @xmath311 and @xmath312 in @xmath114 , similar , for example , to bracketing assumptions in @xcite , one can see that the difference between transformation produced by @xmath313 and @xmath314 is asymptotically small and , therefore , ( [ empirical wc ] ) is still true",
    ".    more interesting and specific to this paper is the problem of practical implementation and convenience of transformation ( [ main2 ] ) .",
    "start by noting that the operator @xmath276 is an extension of the operator @xmath15 of ( [ unitary ] ) to the parametric case .",
    "moreover , the former can be expressed by the latter .",
    "to show this , assume first @xmath315 and denote @xmath316 a unitary operator on @xmath16 with the same properties as in lemma  [ lem : koperat ] , only with @xmath134 and @xmath49 replaced by general @xmath317 and @xmath165 , respectively .",
    "thus , @xmath318 of ( [ unitary ] ) .",
    "now assume @xmath319 .",
    "recall that @xmath320 maps function @xmath134 to function @xmath49 and maps any function , orthogonal to @xmath134 and @xmath49 , to itself . consider the image of the function @xmath321 , @xmath322 since @xmath134 and @xmath321 are orthogonal by construction , then so are their images @xmath49 and @xmath323 . now consider operator @xmath324 .",
    "the product @xmath325 is another form of the operator @xmath276 . indeed , as a product of unitary operators , @xmath276 is a unitary operator , and it maps any functions @xmath326 , which are orthogonal to @xmath327 , to itself , while it maps @xmath134 into @xmath49 and @xmath321 into @xmath328 : @xmath329 and @xmath330 since @xmath331 and @xmath332 are orthonormal and orthogonal to @xmath134 and @xmath321 , it follws that @xmath333 and @xmath334 also will be orthonormal and orthogonal to @xmath49 and @xmath328 , which is what is required from @xmath335 and @xmath336 .",
    "this procedure can be iterated in @xmath337 , and so forth .",
    "hence , it follows that transformation ( [ main2 ] ) can be carried out as a sequence of @xmath338 just @xmath339-dimensional transformations .",
    "this was tried recently in @xcite with applications to testing independence in contingency tables , and demonstrated that the coding is simple and the calculations quick . in one of numerical examples ,",
    "the author considered @xmath340 tables with , therefore , @xmath341 marginal probabilities to estimate .",
    "at the same time , comparison of the representation ( [ iterat ] ) with the coordinate form used in lemma  [ lem : lemsec4 ] rises the question of uniqueness of @xmath276 , which is good to clarify .    to this end , consider the orthogonal decomposition of @xmath16 , which uses the basis @xmath206 : @xmath342 where the subspace @xmath343 is generated by the functions @xmath344 , and @xmath345 is generated by the remaining part of the basis @xmath206 , and @xmath346 is the orthogonal complement of their sum to @xmath16 .",
    "similarly , consider orthogonal decomposition which uses the basis @xmath266 : @xmath347 then what the operator @xmath276 , defined in ( [ coordwise ] ) , does is the following : it maps unitarily subspace @xmath348 onto @xmath349 , while leaves @xmath350 unperturbed",
    ". however , let @xmath351 be a unitary operator , which can be decomposed into direct sum @xmath352 of unitary operators , of which @xmath353 , @xmath354 and @xmath355 are invariant subspaces , respectively .",
    "then , for any such operator , the process @xmath356 is also a @xmath37-brownian motion .",
    "moreover , if @xmath357 is a similar unitary operator with invariant subspaces @xmath358 , @xmath359 and @xmath360 , then @xmath361 is again a projected @xmath37-brownian motion .",
    "this makes nonuniqueness of ( [ coordwise ] ) an obvious and , basically , trivial fact",
    ".    however , in practical problems we will not be in need to use @xmath351 and @xmath357 in so much generality .",
    "indeed , there does not seem to be a reason to `` rotate '' @xmath326 and therefore we can agree to choose @xmath362 as the identity operator on @xmath350 .",
    "given `` target '' score functions , that is , given @xmath363 , and the score functions @xmath364 of the hypothetical parametric family , it does not seem useful to `` rotate '' any of them and one can agree to the rule that each @xmath365 is mapped onto @xmath366 for all @xmath367 .",
    "this will uniquely define the image of @xmath368 as @xmath369 .",
    "moreover , for each @xmath40 , the decomposition of @xmath370 into its parts in the corresponding subspaces is unique , and , in particular , @xmath371 does not depend on the choice of @xmath372 , although the choice of these latter functions is not unique .",
    "more specifically , with the matrix @xmath373 the coordinate functions of the vector @xmath374 are orthogonal to coordinates of @xmath375 and , therefore , the vector @xmath376 has to be a linear transformation of the latter : @xmath377 .\\ ] ] this linear transformation @xmath378 renders the coordinates of @xmath379 mutually orthogonal and normalized .",
    "however , the @xmath378 is not defined uniquely .",
    "therefore , although with our agreement , the vector @xmath380=(l,\\dots,\\mathit{lr}_\\kappa)^t - c(q_0,\\dots , q_\\kappa)^t\\ ] ] remains the same for any choice of operator @xmath276 with properties as in lemma  [ lem : lemsec4 ] , nonuniqueness of @xmath378 makes the multiple choice of @xmath381 possible .",
    "apart from simplicity in numerical calculations , the advantage of the representation ( [ iterat ] ) is that it offers a unique `` canonical '' form of transformation .",
    "then there is no need to be interested in the form of @xmath381 , as they do not enter in our transformation @xmath382 explicitly .",
    "let @xmath383 denote the process obtained as transformation ( [ unif ] ) applied to empirical process @xmath11 : @xmath384^d } \\sqrt { f(y ) } \\,\\mathrm{d}y}\\int_{[0,1]^d } \\frac{1}{\\sqrt{f(y ) } } v_{nf}(\\mathrm{d}y).\\ ] ] the choice of @xmath246 suggested itself by the fact that the limit distributions of statistics below are known and , therefore , one can easily judge how quick is the convergence .     for the beta distributions , with",
    "bell - shaped and j - shaped densities , described in the text .",
    "we used 10000 simulations of samples of size @xmath385 .",
    "the third is the graph of kolmogorov distribution , which is their limit in @xmath170 . ]    in figure  [ fig : contin ] , two distribution functions of the statistic @xmath386 are shown , for sample size @xmath385 .",
    "it is not easy to distinguish them , although the statistics are based on samples from quite different beta distributions : with a bell - shaped ( parameters 3 and 3 ) and j - shaped ( parameters 0.8 and 1.5 ) beta densities , respectively .",
    "the third graph is that of the kolmogorov distribution function , which is the limiting distribution of the @xmath387 .",
    "if @xmath383 were a sort of an empirical process , like , say @xmath388 with some @xmath389 , the distribution of its supremum will again be that of @xmath390 and some doubts would remain whether @xmath383 behaves as a uniform empirical process or an empirical process based on some other distribution .",
    "however , our @xmath383 is not an empirical process at all  it is a difference between some weighted version of an empirical process and some deterministic function times a linear functional from the former .",
    "-statistics for the same underlying beta distributions as above .",
    "we used 10000 simulations of samples of reduced size @xmath391 .",
    "the lowest is the graph of @xmath392 distribution , which is their limit in @xmath170 . ]",
    "[ fig : omega ]    now , on figure [ fig : omega ] , we show distribution functions of the omega - square statistic @xmath393 ^ 2 \\,\\mathrm{d}t .\\ ] ] these distribution functions can not converge to the omega - square distribution unless @xmath383 indeed behaves as the uniform empirical process .",
    "but it seems that they do .",
    "although the differences are now visible , note that the integral was calculated merely as a darboux sum with not too fine step , and that the sample size was only @xmath391 .",
    "it is interesting to have some indication of how quickly the processes of theorem  [ cor : nine ] converge to brownian motion .",
    "the point of particular interest was whether division by @xmath202 , as in ( [ bm21 ] ) , spoils the convergence , and if so , by how much . for this comparison we used still another version of @xmath229 ,",
    "which one obtains by integrating @xmath210 with respect to the process ( [ bm2 ] ) . for one - dimensional time",
    ", it leads to @xmath394 which certainly converges as quickly as empirical process @xmath11 .",
    "figure  [ fig : normedmotion ] shows the graphs of distribution function of k - s statistic from the process ( [ bm21 ] ) , @xmath395 obtained for two different beta distributions ( described above ) along with the distribution function of supremum of a standard brownian motion .",
    "we see that the discrepancy between pre - limiting distribution , for @xmath385 , and the limit exists , but is very small , especially if we consider convergence of quantiles .     from the process ( [ bm21 ] ) for the same underlying beta distributions , as above . again ,",
    "10000 simulations of samples of size @xmath385 .",
    "the third is the graph of the distribution of @xmath396 , which is the limit distribution for the first two . ]    ) for the same underlying beta distributions as above , and with 10000 simulations of samples of size @xmath385 . ]",
    "the last figure  [ fig : motion ] shows distribution functions of k - s statistic from the process ( [ bm3 ] ) normalized by @xmath397 for samples from the same underlying distributions as in figure  [ fig : normedmotion ] . with respect to the previous figure",
    ", there is some improvement , but not by much .",
    "i want to thank the colleagues with whom i had possibility to discuss the topic of this paper , most notably professor p. greenwood , as well as professor n. henze and professor h.l .",
    "i also thank the associate editor and the referee for the high quality of their reading and comments ."
  ],
  "abstract_text": [
    "<S> the main message in this paper is that there are surprisingly many different brownian bridges , some of them  familiar , some of them  less familiar . </S>",
    "<S> many of these brownian bridges are very close to brownian motions . </S>",
    "<S> somewhat loosely speaking , we show that all the bridges can be conveniently mapped onto each other , and hence , to one `` standard '' bridge .    </S>",
    "<S> the paper shows that , a consequence of this , we obtain a unified theory of distribution free testing in @xmath0 , both for discrete and continuous cases , and for simple and parametric hypothesis .    </S>",
    "<S> ./style / arxiv - general.cfg </S>"
  ]
}