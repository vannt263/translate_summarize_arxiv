{
  "article_text": [
    "during the last years , we have witnessed an increasing interest in the optical properties of metallic nanoparticles .",
    "research in the area of plasmonic nanoelectronics explores the behavior of electromagnetic fields which are confined over dimensions smaller than the wavelength .",
    "this field confinement is induced by interactions between electromagnetic waves and conduction electrons at the interfaces of metallic nanostructures .",
    "these plasmonic interactions can be used to manipulate light beyond the classical diffraction limit , giving rise to an emerging wide range of interesting novel applications in sensing and waveguiding , amongst other applications @xcite . additionally , at optical frequencies , metallic nanostructures can be characterized by localized surface ",
    "plasmon resonances ( lsprs ) that support a strong enhancement in the directivity of spontaneous emission of light by single fluorescent molecules or other point - like emitters of light .",
    "this enhancement in the emission of light is a fundamental aspect that has recently originated an intensive promising research work on the design and the experimental construction and testing of nanoantennas [ 37 ] . as a consequence of this novel research area pioneered in recent years , numerical techniques for providing accurate simulation and analysis of problems involving plasmonic nanostructures",
    "are indispensably required to exploit the growing range of applications relying on optical plasmonic properties .",
    "the behavior of nanoparticles at optical frequencies can be well modeled by classical electrodynamics [ 1 ] . nevertheless ,",
    "in electromagnetic optics , the penetration of fields into metals must be considered and therefore sie ( surface integral equation ) formulations for penetrable scatterers are a suitable choice for simulating the optical responses of isolated plasmonic nanoparticles or composite structures consisting of multiple nanoparticles .",
    "surface integral equation techniques based on the method of moments ( mom ) have demonstrated to provide very accurate simulation results in many different problems involving real plasmonic objects [ 811 ] . in spite of being a classical approach , the sie ",
    "mom method delivers accurate predictive results for particle and surface feature sizes down to @xmath0  nm , a distance below which quantum non - local phenomena become non - negligible [ 11 ] .",
    "although not yet widely employed in optics , the sie ",
    "mom approach brings important advantages over volumetric approaches such as the discrete - dipole approximation ( dda ) [ 12 ] , the finite difference in time domain ( fdtd ) method [ 13 ] , and the frequency - domain finite - element ( fem ) methods [ 14 ] .",
    "such advantages include the fact that the sie ",
    "mom approach requires discretizations of the material boundary surfaces only , thus generally reducing the number of unknowns with respect to integral formulations based on volumetric mesh modeling .",
    "additionally , absorbing boundary conditions and surrounding empty space need not to be parametrized , resulting in a significantly easier mesh modeling .",
    "finally , the sie  mom methods are less prone to be affected by instabilities due to abrupt and spatially rapid variations of the permittivity [ 11 ] , as commonly occurs in the case of plasmonic problems .",
    "there are many known factors that determine the final accuracy and the total runtime when simulating with the sie ",
    "mom approach .",
    "however , two of them are of special interest when solving this type of problems : the sie  mom formulation , and the iterative numerical solver .",
    "previous studies have concentrated on assessing which sie formulations are more suitable for different types of electromagnetic scattering and radiation problems in terms of both runtime and accuracy [ 1520 ] , including problems involving plasmonic structures [ 20 ] .",
    "nevertheless , there is a general lack of publications that focus explicitly on the role of the iterative solver .",
    "addressing this lack of results would certainly be relevant as the selected iterative solver has a strong impact on the total simulation runtime and memory consumption .",
    "this impact is particularly important when dealing with real - world plasmonic problems , because they usually require performing massive batches of large - scale simulations for different varying parameters such as optical wavelength , illumination beam , and relative permittivity .",
    "a comparative study of the performance of some well - known sie formulations was first released in [ 15 ] for non - plasmonic conducting and dielectric objects .",
    "later on [ 16 ] , this was also done for perfect electric conductor ( pec ) bodies . a similar study for dielectric objects , but using acceleration algorithms for mom , was carried out in [ 17 ] .",
    "a comparative study applying the sie  mom approach to left - handed metamaterials ( lhm s ) was reported in [ 18 ] ; and , later on , this was done using acceleration algorithms [ 19 ] .",
    "the foremost published comparison of five widespread sie formulations in the interesting context of plasmonic media was accomplished in [ 20 ] .",
    "all the above - mentioned publications also include iterative - performance studies . however , these studies are only focused on a single iterative solver .",
    "the iterative - performance study carried out in [ 15 ] was realized using only as iterative solver the ordinary ( without restarts ) version of the generalized minimal residual method ( gmres ) [ 21 ] .",
    "a restarted gmres with fixed restart parameter was chosen in @xcite , whereas another iterative solver called bicgstab [ 22 ] was used for all the analyses published in @xcite .    as detailed in 1.2.5 of [ 23 ] , the algorithmic performance and the memory complexities of each iterative solver may vary significantly depending on the considered type of engineering problem . as a consequence , in order to optimize the performance and memory usage for a given class of problems , there are no general selection rules for the solver and an investigation should be required to compare iterative solutions provided by various algorithms .",
    "this kind of important study was left out in all the iterative - performance analyses reported in the aforesaid publications [ 1520 ] , as these papers perform comparative analyses by only varying the sie formulation for a fixed iterative solver . in the present work",
    ", we extend to multiple iterative solvers some comparative multiple - sie single - solver results published in [ 20 ] for plasmonic scatterers .",
    "furthermore , a memory complexity analysis not included in the previously mentioned reference is presented in this paper .",
    "moreover , the nanoscatterers used for obtaining the results in [ 20 ] consist only of spheres simulated at a single operating frequency .",
    "the selection of spheres as targets is well justified by the availability of the mie s series analytical reference results [ 24 ] ; however , in the present paper we also analyze the iterative performance results when dealing with more elaborate geometries , such as a real plasmonic nanoantenna .",
    "in addition to the study of the iterative performance , we also check , following a procedure similar to that in [ 20 ] , the accuracy of each sie formulation when the mom linear system is solved by different iterative techniques .",
    "the sie formulations considered for the iterative performance comparison in this paper include tangential equations only ( combined tangential formulation , known as ctf , and poggio - miller - chang - harrington - wu - tsai formulation , named by the acronym pmchwt ) , normal equations only ( combined normal formulation , cnf , and modified normal mller formulation , mnmf ) and both normal and tangential equations ( electric and magnetic current combined - field integral equation , jmcfie ) .",
    "a detailed description of these five formulations can be found in @xcite .",
    "the four studied iterative methods , based on krylov subspaces , used for solving linear systems of equations are the following : gmres ( generalized minimum residual method ) , tfqmr ( transpose free quasi - minimal residual method ) , cgs ( conjugate gradients squared method ) and bicgstab ( bi - conjugate gradients stabilized method ) .",
    "thorough explanations for all these solvers can be found in [ 22 ] . in the particular case of gmres , in addition to the iterative performance , we analyze the influence of the restart parameter on the memory consumption as well .",
    "the rest of this paper is organized as follows .",
    "the sie formulations considered in the study are described in section 2 .",
    "next , in section 3 , a concise overview on krylov iterative methods applied to sie formulations is given .",
    "we present in section 4 a comparative study of numerical results for the considered sie formulations .",
    "first , in subsection 4.1 , representative sets of near and far field outcomes obtained employing each sie formulation are compared with the analytical results provided by the mie s series , in order to determine the level of accuracy for each formulation .",
    "then , in subsection 4.2 , the iterative performance of each linear solver is assessed by measuring the runtime to solve the mom system and the total number of required matrix - vector multiplications for different plasmonic geometries .",
    "finally , section 5 concludes the paper with a summary .",
    "in the analysis of the scattered field produced by an impinging electromagnetic wave on a penetrable object , both tangential and normal boundary conditions are typically imposed for the electric and magnetic fields at the interface of the object .",
    "these boundary conditions establish the normal electric field integral equation ( n  efie ) , the normal magnetic field integral equation ( n  mfie ) , the tangential electric field integral equation ( t  efie ) and the tangential magnetic field integral equation ( t  mfie ) .",
    "the following linear combinations of the aforementioned formulations are known to provide stable sets of sie formulations @xcite : @xmath1 in the preceding equations , we employ the same sign conventions as in [ 23 ] .",
    "@xmath2 is the intrinsic impedance in region @xmath3 for @xmath4 . @xmath5 and @xmath6 are the outer and inner regions of the scatterer , respectively .",
    "different values can be assigned to the complex scalar parameters @xmath7 for @xmath8 in order to obtain valid stable formulations .",
    "the expressions for all the identities involved in eq .",
    "( 1 ) are the following : @xmath9 in eqs .",
    "( 2 ) , @xmath10 and @xmath11 denote the , a - priori unknown , induced equivalent surface currents ( electric and magnetic currents respectively ) on the interface between @xmath5 and @xmath6 . @xmath10 and @xmath11 are vector functions of an arbitrary surface point @xmath12 , which is defined approaching the surface from @xmath5 .",
    "vector @xmath13 is the unit normal to the surface , pointing towards exterior region @xmath5",
    ". vectors @xmath14 and @xmath15 respectively represent the incident electric and magnetic fields at surface point @xmath12 . @xmath16 and @xmath17",
    "are used to denote integro - differential operators defined as @xmath18{g_i}({\\bf{r}},{\\bf{r'}})\\,\\,ds ' } , \\\\",
    "{ k_i}{\\bf{x}}({\\bf{r } } ) = \\dashint_s { { \\bf{x}}({\\bf{r ' } } ) \\times \\nabla { g_i}({\\bf{r}},{\\bf{r'}})\\,\\;ds ' } .",
    "\\end{array } \\label{eq:3 } \\ ] ] the symbol @xmath19 is used in the definition of @xmath17 for indicating that the integration is taken as a cauchy principal value integral .",
    "the integration surface @xmath20 refers to the separation interface between @xmath5 and @xmath6 .",
    "the term @xmath21 in ( 3 ) refers to the scalar green s function .    a generalization of the sie ",
    "mom formulation for the analysis of _ multiple _ plasmonic media can be looked up in [ 9 ] , or a different alternative approach can be found in [ 25 ] .",
    "the discretization of the unknown currents into basis functions and the generation of the mom linear system can be consulted , for example , in @xcite .",
    "the comparative study included in the following sections considers the five widespread formulations defined for the parameters @xmath7 in table  1 .    0.2 in    .parameters for obtaining five well - documented surface integral equation formulations .",
    "[ cols=\"^,^,^,^,^\",options=\"header \" , ]     [ tab:1 ]",
    "the adequate choice of the iterative method to solve plasmonic problems involving a high number of unknowns is fully supported by the fact that mom - based accelerating techniques such as the fast multipole method ( fmm ) and the multilevel fast multipole algorithm ( mlfma) are usually employed for problems involving hundreds of thousands of unknowns . unlike pure mom , these mom - based accelerating techniques accept a controllable error in the solution [ 23 ] . in the fmm and mlfma algorithms , the direct inversion of the mom matrix is not feasible , even on modern parallel computers ; and , for this reason , iterative solvers are indispensable to find the initially unknown vector .",
    "even when using a pure mom code , without fmm and mlfma accelerations , an iterative solver usually provides faster convergence than a direct solver such as lu matrix factorization .",
    "in fact , the computational complexity of pure mom with a direct solver is @xmath22 , where @xmath23 is the number of unknowns .",
    "this complexity can be easily lowered to @xmath24 by simply switching from a direct to an iterative solver [ 26 ] .",
    "krylov iterative solvers are among the most popular in computational electromagnetics , because of their ability to deliver good rates of convergence and to efficiently handle very large problems [ 16 ] .",
    "this kind of methods look for the vector solution @xmath25 of the system @xmath26 in the krylov space @xmath27 , where @xmath28 represents a number of iteration in the solver .",
    "@xmath29 is a suitable space from which one can construct approximate solutions of the linear system of equations , since it is closely related to @xmath30@xcite .",
    "when any programmed krylov method is called , a tolerance value @xmath31 is inputted to the code . in practice , the solver does not run until an exact solution is found , but rather terminate at iteration @xmath32 if a certain criterion has been satisfied for the estimated solution @xmath33 .",
    "one typical criterion is to terminate the algorithm after the following inequality is met : @xmath34 the term @xmath35 is called relative residual .",
    "typical values for the tolerance are @xmath36 for double precision ( 64 bits ) entries in @xmath37 and @xmath38 , and @xmath39 for single precision ( 32 bits ) entries . however , for mom - based simulations involving tens of millions of unknowns , the tolerance must be raised to values as high as about @xmath40 [ 27 ] .",
    "this increase in @xmath31 is needed because the condition number of the mom system typically worsens as the number of unknowns lifts and the number of iterations to achieve @xmath31 would be impracticable to reach .    the krylov method gmres ( generalized minimum residual method ) , developed by y. saad and h. schultz in 1986 [ 21 ] , is known to be the optimal iterative solver in the sense that it minimizes the number of iterations required to converge satisfying ( 4 ) [ 16 ] .",
    "nevertheless , the optimality of gmres comes at a price .",
    "the memory cost of applying the method increases with the iterations , and it may sometimes become prohibitive for solving certain problems . as an attempt to limit this cost , there exist restarted versions of gmres in which , after a given number _",
    "r _ of iterations ( _ r _ is known as the restart parameter ) , the approximate solution for the next steps is computed form the previously generated krylov subspace .",
    "then this existent krylov subspace is completely erased from the memory , and a new space is constructed from the latest residual . in a restarted gmres , each ordinary iteration",
    "is called internal iteration , whereas a set of _ r _ ( _ r _ denotes again the restart value ) internal iterations is called external iteration . summarizing the storage costs ,",
    "the number of additional floats or doubles over the baseline memory requirements in mom / fmm / mlfma that gmres requires in memory can be easily estimated from the following analytical results [ 28 ] : @xmath41 where _ n _ is the number of complex unknowns and @xmath42 is the number of iterations required to achieve ( 4 ) in the unrestarted ordinary gmres . for a restarted gmres ,",
    "@xmath42 is computed from the restart parameter _",
    "r _ as @xmath43 , with @xmath44 the total number of internal iterations .",
    "in addition to the restarted versions of gmres , other non - optimal iterative solvers attempt to preserve the favorable convergence properties of gmres while introducing a negligible overuse in ram usage . for this paper , we consider complex versions of iterative krylov solvers based on different versions of the so - called lanczos biorthogonalization algorithm [ 22 ] : tfqmr ( transpose free quasi - minimal residual method ) , cgs ( conjugate gradients squared method ) and bicgstab ( bi - conjugate gradients stabilized method ) .",
    "the analysis of the accuracy and the iterative performance of the five sie formulations described in section 2 is carried out in this section for representative problems involving plasmonic materials .",
    "error and iterative performance results were obtained for the krylov solvers described in section 3 .",
    "the error analyses are summarized in subsection 4.1 .",
    "then , in subsection 4.2 , we present iterative performance analyses that not only include spheres as scatterers , but also real models of plasmonic nanoantennas .",
    "the gmres solver with a fixed restart was the only solver considered in [ 20 ] , whereas our results for plasmonic problems cover the following important cases : three additional solvers ( tfqmr , cgs and bicgstab ) , the ordinary gmres without restarts , and the restarted gmres including a set of different restart parameters not considered in the aforesaid reference .",
    "furthermore , the results in [ 20 ] cover up to 36,000 unknowns . in contrast",
    ", we have extended the comparative results up to around 100,000 unknowns .",
    "some quantitative results presented in this paper regarding the iterative performance and the accuracy differ from their counterparts in [ 20 ] even though there is a general agreement among those main qualitative results that are common to both papers due to two major reasons : i ) we employed a gaussian quadrature rule , described in [ 29 ] , consisting of 7 points per triangle for numerical integration , whereas in [ 20 ] a 3-point rule was used ; ii ) unlike the simulations in [ 20 ] , we employed a diagonal preconditioner described in [ 29 ] together with the preconditioning technique in [ 30 ] .",
    "a diagonal preconditioner and the technique in [ 30 ] are straightforward to implement in any existing mom code without adding significant computational complexity . moreover , in 10.2.4 of [ 29 ] is stated that experimental results show that the 7-point quadrature rule is preferable to the 3-point rule , as it provides superior precision for mom problems , which strengthens our choice for this integration technique .",
    "this paper also describes the numerical precision and meshes employed for the discretization , not clearly stated in some of the aforementioned literature , in order to allow a full reproducibility of our results by the scientific community .",
    "double - precision floating - point c calculations were used for all the results in this paper , and we employed the so - called `` frontal '' mesh type in the free software gmsh [ 31 ] .",
    "the `` frontal '' type was selected because it provides triangles with good aspect ratios , namely , triangles which do not have small internal angles .",
    "this triangle feature is required in mom to obtain accurate results , as explained in 8.7.4.1 of [ 29 ] .",
    "for all the studied iterative solvers , the maximum number of external iterations was unlimited with the exception of the unrestarted gmres , where the number of iterations is limited to the number of unknowns , and the relative residue tolerance for stopping each method was set to 10@xmath45 , in accordance with the traditionally used tolerance value which can be found , for instance in @xcite .",
    "the main graphical representations of the results in this paper were obtained with a pure mom implementation , as in [ 20 ] .",
    "however , some figures in this paper include mlfma results whenever a `` mlfma vs. pure mom '' comparison is relevant .",
    "the mlfma implementation used for the present work was configured with the same mlfma parameters described in [ 32 ] .",
    "our computational implementation of the mom / mlfma - sie method consists of a regular c code involving double - precision floating - point calculations . for the accurate evaluation of the singular integrals ,",
    "we have used all the proper analytical extraction techniques explained in [ 29 ] . in order to model the mom currents ,",
    "we have employed the well - known rao - wilton - glisson ( rwg ) basis functions [ 29 ] . the galerkin s method was assumed for this work , meaning that the mom testing functions are the same as the basis functions .",
    "all our simulations were carried out on a computer with two intel xeon processors e5 - 2690v2 running the 64-bit operating system windows 8.1 professional .",
    "the code was not parallelized by hand , but automatically parallelized using the source - to - source compiler parallware [ 33 ] to be run with 20 threads executed on half of the cores . the aforementioned model of the processors and",
    "the number of threads have no influence on any comparative result , but only determine the absolute quantitative runtime outcomes in subsection 4.2 .",
    "regarding the automatic parallelization , parallware is a parallelizing tool that automatically extracts the parallelism implicit in the source code of a sequential simulation program written in the regular c programming language .",
    "in addition , parallware automatically generates an optimized parallel - equivalent program written in c and annotated with openmp [ 34 ] compiler pragmas .",
    "a comparative analysis of the accuracy was carried out employing the five selected mom - based sie formulations and the four solvers . the same sphere with radius @xmath46 employed in 3.3 of [ 20 ] was used in this section as a representative example for evaluating the accuracy of each considered iterative solver .",
    "this sphere is illuminated by a plane wave , with incidence direction @xmath47 and polarization @xmath48 , at the operating optical wavelength @xmath49 the following plasmonic materials were chosen for the sphere composition : gold ( @xmath50 , at the simulation frequency ) , silver ( @xmath51 ) and aluminum ( @xmath52 ) .",
    "the values of the complex relative dielectric permittivity for each material have been extracted from [ 20 ] .",
    "the normalized root mean square ( rms ) error with respect to the mie s series results was calculated using the following expression : @xmath53 where @xmath54 is the magnitude of the scattered electric far field obtained in the simulation for @xmath23 different observation values .",
    "@xmath55 is the reference field provided by the mie s series . for far - field patterns ,",
    "the error was calculated using @xmath56 equispaced angular values for the variable @xmath57 on plane xz .",
    "the near - field patterns comprise a mesh with resolution @xmath58 points .",
    "this mesh was created on plane xz over a centered square of side length @xmath59 , with @xmath60 the sphere radius .",
    "we found no significant differences in the comparative error variation among the three considered plasmonic materials .",
    "we did not either encounter any effect of the chosen iterative solver on the normalized rms error , as all the four solvers yielded identical error levels .",
    "these results in this section complete the important findings published in @xcite , extending the error analysis to multiple iterative solvers .",
    "1 shows the error versus the number of unknowns for each sie formulation when the sphere is made of gold .",
    "the variation on the number of unknowns was achieved by varying the maximum side length @xmath61 of the triangles in the geometry mesh , according to the rule @xmath62    : ( left ) far field ; ( right ) near field .",
    "error values were found to be identical among the four considered iterative solvers . ]    in terms of accuracy , the pmchwt has clearly shown to be the most reliable formulation in plasmonics .",
    "this statement is in full agreement with the results in [ 20 ] .",
    "the mnmf formulation has an error level comparable to the pmchwt in most cases ; however its far - field error level becomes unstable and starts to grow for high numbers of unknowns .",
    "this anomalous behavior in mnmf might be ascribed to the singularity extraction techniques involved in the mnmf implementation [ 29 ] .",
    "the ctf formulation exhibits a near - field error similar to the pmchwt , but in the far field its error level is notably worse . given that both pmchwt and ctf combine tangential equations only , the accuracy provided by the pmchwt highlights the actual importance of the combination scalar parameters on the obtained level of accuracy .    as a graphical reference , fig .",
    "2 shows far and near - field reference values obtained from the mie s series for the sphere with radius @xmath46 .",
    "pmchwt far - field values simulated with two very different numbers of unknowns ( mesh sizes ) are represented in fig . 2 in order to allow for visual assessment of the real importance of taking into account the error variations shown in fig . 1 .",
    "with the purpose of assessing the iterative performance of the five studied sie formulations , we initially simulated the @xmath46 radius gold sphere , using mom solved iteratively .",
    "we employed four well - known iterative solvers for linear systems of equations [ 22 ] : tfqmr , cgs , bicgstab and gmres an unrestarted gmres version , plus three more gmres versions with restart parameters 30 , 60 and 90. in fig .",
    "3 , we analyze the influence of the gmres restart parameter on the memory cost .",
    "this analysis is used to justify our elections for the mentioned restart values .",
    "3 shows on the left the memory usage required by pure mom and also by mlfma , as a function of the number of unknowns .",
    "these curves on the left are independent of the particular chosen solver . then , on the right of fig .",
    "3 , the ram overuse introduced by gmres is represented for the restart values 30 , 60 and 90 , and for the unrestarted version .    as inferred from fig .",
    "3 , the percentage ram overuse may be negligible when using pure mom together with unrestarted gmres , but is noticeably worse in the mlfma case . in other words , even if the available ram allows a mlfma simulation , the election of the unrestarted gmres for the solver may make this simulation unfeasible . the maximum gmes restart considered in the present work , _ _",
    "r__=90 , was selected to bound the total ram consumption increase in mlfma to around 1% of the total ram usage in every non - gmres krylov iterative solver .",
    "measurements of the iterative performance of the formulations and solvers are shown on the left of fig .",
    "4 , where the runtime for iteratively solving the mom system has been taken from the fastest iterative solver for each formulation . for this particular comparison ,",
    "unrestarted gmres was not considered , in order to make a fair comparison among formulations .",
    "indeed , for every formulation , gmres is optimal ; and , as a consequence , it outperforms all other krylov methods in terms of iterative performance .",
    "however , as show above , unrestarted gmres should be only used when memory requirements are not a concern .",
    "4 also includes on the right , for comparison purposes , the time required to fill in the full mom matrix before the iterative solver begins .",
    "the time for filling the mom matrix is slightly smaller with the pmchwt and the ctf because , in these formulations , it is possible to avoid the integration of the green s function gradient which appears in operator @xmath16 in eq .",
    "this simplification on the integral requires employing the two - dimensional version of the divergence theorem , which can not be invoked for the formulations that involve normal equations , due to the vector product by @xmath13 .    as shown in fig .",
    "4 , the restarted gmres(90 ) solver is the best choice for all the formulations , except for the tangential formulations pmchwt and ctf , where tfqmr provides the best iterative behavior .",
    "another important comment on fig .",
    "4 is that the mnmf formulation provides the best performance when solved iteratively .",
    "radius gold sphere : ( left ) runtime for iteratively solving the mom system when the iterative method with the fastest convergence is chosen for each sie formulation ; ( right ) total runtime for filling in the mom matrix . ]",
    "since , as discussed above in subsection 4.1 , the pmchwt provides the best accuracy when dealing with plasmonic problems , we chose to represent in fig .",
    "5 the iterative performance of this formulation for each solver , including gmres without restart .",
    "even though important previous works such as @xcite indicate that the pmchwt is unfit to be solved by an iterative method , the scenario considered in this paper is different and not directly comparable to @xcite .",
    "the recently introduced preconditioning scheme in @xcite , not yet available at the time of the report in @xcite , was considered for the simulations in this work , as justified above .    as can be seen in the graphical results ,",
    "cgs and tfqmr are the best choices for the pmchwt , if unrestarted gmres is excluded owing to memory requirements .",
    "5 also shows that the number of matrix - vector multiplications ( mvms ) required by each iterative solver is proportional to the runtime .",
    "it is worth stating that all the solvers require two mvms in each iteration , except for gmres ( all versions ) , which requires only one mvm per internal iteration .",
    "the number of mvms is thus a machine - independent parameter that can be easily used to compare the total processing time associated with each one of the formulations and solvers .",
    "let us note that for the formulations other than the pmchwt all the solvers display a similar iterative behavior , as seen in fig .",
    "6 .",
    "7 shows the relative residual as a function of the number of mvms ( matrix - vector multiplications ) for the pmchwt formulation for 57,000 unknowns other mesh sizes exhibit an analogous behavior. as expected , gmres without restart exhibits the fastest residual decay .",
    "regarding data from the cgs and bicgstab solvers in fig .",
    "7 , it can be noted that the time - dependent residual variances are very high .",
    "a similar erratic residual evolution can be also observed in the iterative solvers included in commercial codes like feko ; nonetheless , the important fact is that the time - averaged minimum residual is reduced . as a matter of fact",
    ", it must be clear from fig . 7",
    "that , for instance , both tfqmr ( non - erratic ) and cgs ( erratic in this scenario ) exhibit a similar time - averaged minimum residual evolution and they converge at a similar rate .    returning to fig .",
    "7 , it is clear that for the cases where memory - expensive unrestarted gmres is not an option , tfqmr and cgs provide a better convergence than gmres(90 ) in the pmchwt , for the residue tolerance of 10@xmath45 ; however , this will not be the case if a higher residual error is defined to achieve convergence .",
    "this observation regarding the pmchwt formulation is particularly important because , when programming a single sie formulation in a mom code , the pmchwt is generally chosen as the preferred formulation due to the following reasons : 1 ) it is the easiest to implement , as it does not require using the normal vector directions ; and 2 ) it is employed in commercially available software like feko [ 35 ] and in publications about simulating plasmonic bodies such as [ 8 ] .        in order to extract valid general conclusions about the iterative runtimes",
    ", we also analyzed spheres made of silver and aluminum and we tested more elaborated geometries at different optical frequencies , such as a nanoantenna made of aluminum .",
    "these general conclusions must be understood as valid under the simulation parameters justified at the beginning of section 4 .",
    "the use of alternative preconditioners would certainly be an important point to consider in order to obtain more general conclusions ; however , these preconditioners would have required a noticeably extended explanation out of the scope of this paper . likewise ,",
    "despite the fact that higher - order basis functions are not indispensably required to perform accurate plasmonic simulations @xcite , we understand that they could be interesting for further research .",
    "additionally , sharp edges and corners are not considered in the present work when extracting general conclusions .",
    "it is well known that sharp edges and corners are not typically found in real plasmonic structures chemically generated in a laboratory setup @xcite ; however we believe that additional research should be pursued in the future regarding plasmonic edges in both experimental and theoretical realms . finally , following a similar approach used in the literature @xcite",
    ", we have only represented the most relevant cases when dealing with qualitative conclusions .",
    "the results corresponding to the spheres made of silver and aluminum , as well as simulations varying the nanoantenna plasmonic composition , are not shown for the sake of simplicity , as these results have proved to be qualitatively equivalent to the shown ones .    the considered real plasmonic yagi - uda nanoantenna for the emission of light at @xmath63 , whose emitted near field pattern obtained with our code is represented in fig .",
    "8 , has been designed in [ 5 ] .",
    "see this reference for a detailed description of the antenna dimensions , which have been optimized for high optical directivity at the operating frequency .",
    "the optical antenna is made of aluminum ( @xmath64 at the simulation frequency ) , and it enhances the emission of a single fluorescent chemical molecule modeled as a classical hertzian dipole along direction @xmath65 , 4  nm above the feed element . in our particular simulation , the _ equivalent _ dipole has length 8 nm and its electric current is 1 na .    .",
    "the represented near - field magnitudes were obtained with the pmchwt formulation for a mesh size @xmath66 . ]    as inferred from fig .",
    "9 , iterative performance in the nanoantenna problem is similar to that previously presented for the mie scattering problem when the sphere was simulated .",
    "the absolute runtimes versus the number of unknowns vary when compared to the mie scattering , but the qualitative differences among the four iterative solvers remain very similar , which allows extracting some general conclusions for a wide variety of tests involving plasmonic media .",
    "these conclusions are summarized in the next section .",
    "is simulated : ( left ) time for solving the mom system ; ( right ) number of matrix - vector multiplications . ]",
    "four well - documented iterative solvers have been applied to five widespread mom - sie approaches in the analysis of nanostructures made of plasmonic materials . in order to increase the reproducibility of the results in this paper , we have provided in - depth details about all the parameters involved in our code implementation ( numerical integration rule , mesh type , computational precision , etc . ) , and we have explained the reasons and convenience for the election of such parameters . these thorough explanations on code implementation are usually not described in detail , and they affect the reproducibility of results in previous papers about iterative solvers in computational electromagnetics .",
    "our observations are summarized as follows :    1 .   in the case where memory requirements are not an impediment according to eq .",
    "( 5 ) , then the best election for all the formulations is always gmres without restart .",
    "whenever accuracy is required in the results , then the best choice is to use the pmchwt formulation , because this formulation has the smallest error in all the analyzed plasmonic problems ; however , the pmchwt has a poor iterative performance .",
    "if the pmchwt is chosen and unrestarted gmres can not be applied due to memory requirements , then the best iterative solvers are tfqmr and cgs , because they may provide a much better performance , for the standard double - precision residue tolerance of 10@xmath45 , than the rest of the analyzed solvers .",
    "tfqmr and cgs are also the best choices for the ctf formulation ( although in this case the effect is less noticeable ) .",
    "the fastest convergence in plasmonics belongs to the mnmf and jmcfie formulations . for these formulations ,",
    "importantly , however , the choice of the iterative solver has a small impact on the total runtime .",
    "5 .   for a given fixed residual tolerance and iterative solver",
    ", the choice of the sie formulation has a direct impact on the simulation error and also an impact on the runtime .",
    "nonetheless , for a fixed residual tolerance and sie formulation , the choice of the iterative solver has a negligible impact on the simulation error but , in general , a relevant impact on the total runtime .    in this paper",
    ", we did not only confirm conclusions in items 1 and 2 above also approached in @xcite and @xcite respectively but we have also extended our analysis to extract the remaining conclusions on the list above .",
    "these novel conclusions , together with the quantified results in the presented figures , are relevant contributions from this work to the know - how literature of computational electromagnetics in the context of plasmonic problems .",
    "the authors especially thank the company _ appentra solutions , _ developers of the automatic parallelizing source - to - source compiler _ parallware _ ( www.appentra.com ) , for assisting us in the analysis and parallelization of some parts of our c codes .",
    "this work is partially supported by the spanish national research and development program under project tec2011 - 28683-c02 - 02 , by the spanish government under project tactica , by the european regional development fund ( erdf ) , and by the galician regional government under agreement for funding atlanttic ( atlantic research center for information and communication technologies ) .",
    "barsan v , lungu rp .",
    "trends in electromagnetism - from fundamentals to applications .",
    "intech ; 2012 .",
    "chapter 7 , fast preconditioned krylov methods for boundary integral equations in electromagnetic scattering ; p. 155176 .",
    "ergl  , grel l. comparison of integral - equation formulations for the fast and accurate solution of scattering problems involving dielectric objects with the multilevel fast multipole algorithm .",
    "ieee trans antenn propag .",
    "2009;57:176187 .",
    "arajo mg , taboada jm , sols dm , rivero j , landesa l , obelleiro f. comparison of surface integral equation formulations for electromagnetic analysis of plasmonic nanoscatterers . opt express .",
    "2012;20:91619171 .",
    "gomez - sousa h , rubios - lopez o , martinez - lorenzo ja .",
    "junction modeling for piecewise non - homogeneous geometries involving arbitrary materials .",
    "2014 international symposium on antennas and propagation ; 2014 july 6 - 11 , memphis , tennessee , usa . ieee antennas and propagation society ( ap - s ) ; 2014 .",
    "p. 21962197 .",
    "taboada jm , arajo mg , brtolo jm , landesa l , obelleiro f , rodrguez jl .",
    "mlfma - fft parallel algorithm for the solution of large - scale problems in electromagnetics .",
    "progr in electromag research",
    ". 2010;105:1530 .",
    "landesa l , arajo mg , taboada jm , bote l , obelleiro f. improving condition number and convergence of the surface integral - equation method of moments for penetrable bodies . opt express .",
    "2012;20:1723717249 .",
    "the appentra team .",
    "parallware : automatic parallelization of sequential codes [ computer software ] . a corua ( spain ) : appentra solutions sl ; 2015 .",
    "available from : http://www.appentra.com/products/parallware/      em software & systems - s.a .",
    "( pty ) ltd .",
    "modelling of dielectric materials in feko .",
    "technical report ; 2005 [ cited 2015 sep 7 ] .",
    "available from : https://www.feko.info/about-us/quarterly/feko_quarterly_mar_2005.pdf"
  ],
  "abstract_text": [
    "<S> the electromagnetic behavior of plasmonic structures can be predicted after discretizing and solving a linear system of equations , derived from a continuous surface integral equation ( sie ) and the appropriate boundary conditions , using a method of moments ( mom ) methodology . in realistic large - scale optical problems , a direct inversion of the sie  </S>",
    "<S> mom matrix can not be performed due to its large size , and an iterative solver must be used instead . </S>",
    "<S> this paper investigates the performance of four iterative solvers ( gmres , tfqmr , cgs , and bicgstab ) for five different sie  </S>",
    "<S> mom formulations ( pmchwt , jmcfie , ctf , cnf , and mnmf ) . </S>",
    "<S> moreover , under this plasmonic context , a set of suggested guidelines are provided to choose a suitable sie formulation and iterative solver depending on the desired simulation error and available runtime resources .    </S>",
    "<S> electromagnetic optics ; plasmonic nanostructures ; computational electromagnetics ; surface integral equations ; method of moments ; iterative solvers </S>"
  ]
}