{
  "article_text": [
    "measurement of particle positions from images is important in many fields , including dusty plasmas @xcite , colloids @xcite , fluid mechanics @xcite , biology @xcite , and computer vision @xcite .",
    "particle positions are generally estimated as the center of a bright spot of an image .",
    "velocities can also be calculated from images ; two common methods for this are particle - tracking - velocimetry ( ptv ) and particle - image - velocimetry ( piv ) .",
    "to measure particle positions , an experimenter begins with a bit - map image . as an example , in fig .",
    "[ experiment images ] we present portions of single video frame from a dusty plasma experiment .",
    "each bright spot represents an @xmath0 diameter polymer microsphere illuminated by a @xmath1 helium - neon laser sheet and imaged by a video camera with a nikon 105 mm micro lens and a bandpass optical filter to eliminate unwanted light .",
    "the lens was focused to generate a sharp image .",
    "the experimental setup is similar to fig .  2 of @xcite .",
    "figure  [ experiment images](a ) and a magnified view fig .",
    "[ experiment images](b ) show portions of a video frame recorded by a cooled 14-bit digital camera ( pco1600 ) with a @xmath2 pixel width and a linear response .",
    "it was operated at 30 frames per second with an exposure time of 30 msec . we should mention that experimental images of particles will differ , depending on many factors including the type of camera . to illustrate this point , we present in fig .  [ experiment images](c ) an enlarged view of a bright spot in a frame recorded by an analog camera with a nonlinear response corresponding to gamma = 0.6 .",
    "( some cameras are nonlinear with an output intensity proportional to the input luminance to the power gamma ) .    in the images in fig .",
    "[ experiment images ] , particles fill several pixels",
    ". this spot size may be due , in part , to diffraction by the particle as well as camera properties such as diffraction by the camera aperture @xcite and imperfect lens focusing .",
    "the spot size can not be explained merely by geometrical optics , because the small particle size and magnification would result in an image smaller than one pixel on the camera detector .",
    "images have random noise in each pixel .",
    "this can arise because of fluctuations in the camera s sensor and its electronics .",
    "noise in the experimental image of fig .",
    "[ experiment images](a ) is shown in fig .",
    "[ histogram ] as a histogram of the pixel intensity .",
    "the most prominent feature is the noise peak , corresponding to a large number of pixels that are relatively dark .",
    "this noise peak has an average value that we term the `` background intensity , '' @xmath3 .",
    "the noise peak generally depends only on the camera and the sensor temperature .    after recording a bit - map image , the experimenter",
    "will then use a computer algorithm to measure the particle position .",
    "there are several methods to do this , including the moment method @xcite , which we will study in this paper .",
    "other methods include fitting a bright spot in the image to a gaussian @xcite or polynomial @xcite , and simpler methods such as choosing the centroid as the particle center @xcite . in the moment method ,",
    "the calculated particle position is @xmath4 where @xmath5 is the position and @xmath6 is the intensity of a pixel @xmath7 .",
    "the result of eq .",
    "( [ 1stold ] ) is sometimes called the `` center of mass '' @xcite . when the particle fills more than one pixel , this calculation yields an estimate of the particle position with sub - pixel accuracy .",
    "because of the efficiency and accuracy of the moment method , it is widely used when analyzing large quantities of data , as might be produced for example when using a video camera .",
    "fitting methods , which are more computationally expensive , are often used as well @xcite .",
    "the centroid method is similar to the moment method except that the intensity @xmath6 of each pixel is replaced with a constant @xcite .",
    "one application of particle position measurements is the calculation of particle velocities using ptv .",
    "a velocity can be calculated by subtracting the positions of the same particle in two different frames and dividing by the time interval between frames .",
    "this method differs from piv @xcite , where velocities are calculated at regular gridpoints , not for specific particles .",
    "errors in the calculated particle position arise from multiple sources , including random noise in each pixel and also from the finite spatial resolution of the pixels on a camera sensor .",
    "when an image is recorded by sampling it with a finite number of pixels , some information about the intensity profile is lost , and this can cause a type of systematic error known as pixel locking or peak locking .",
    "the total error in the calculated position will be due to a combination of these effects , not just random noise or pixel locking by itself .    in this paper",
    ", we seek to minimize the total error , and doing this will require that we understand the contribution of pixel locking .",
    "our goal is to aid the experimenter in making optimal choices , in both hardware and software , to minimize the total error .",
    "pixel locking , also known as peak locking , is an artifact where calculated particle positions tend to be concentrated at certain favored locations relative to pixel edges , such as the center or edges of a pixel .",
    "it is different from random errors , which do not result in favored positions for particles . to understand pixel locking ,",
    "consider a particle whose image fills only a single pixel . in this case , the sum in eq .",
    "( [ 1stold ] ) would have only a single term , and the position would be assigned to the exact center of that pixel . if the particle s image instead fills two pixels with equal intensity , the position will be assigned to the midpoint of a pixel edge .",
    "the pixel center and midpoints of pixel edges are examples of favored positions that are found to occur even when the particle s image fills several pixels @xcite .",
    "the scientific literature for pixel locking includes many papers where piv is used to measure velocities . in the early 1990s ,",
    "the piv method was tested to demonstrate their sub - pixel accuracy for particles flowing along with a fluid @xcite . for specific applications of piv",
    ", pixel locking has been studied by other authors as well @xcite . in comparison to piv ,",
    "the literature for ptv includes fewer studies of pixel locking , e.g. @xcite . because of this , some users of ptv , including until recently the authors of this paper , were unaware of pixel locking and the problems it can cause .",
    "in addition to ptv , computer vision is another important area where pixel locking is recognized as a problem in measuring positions @xcite .    to detect pixel locking",
    ", we use sub - pixel maps as a diagnostic tool .",
    "a sub - pixel map shows all the calculated particle positions relative to pixel edges , and it is drawn in a small box having the size of one pixel . to prepare a sub - pixel map , we begin with a graph of calculated positions of @xmath8 particles , as illustrated in fig .",
    "[ sub - pixel map](a ) , then plot the fraction parts of these positions in the small box , yielding the sub - pixel map in fig .",
    "[ sub - pixel map](b ) . in fig .",
    "[ sub - pixel map](c ) we present an actual sub - pixel map calculated from a bit - map image by an analog camera in a dusty plasma experiment .",
    "the signature of pixel locking can be identified in general by concentrations of calculated particle positions at favored positions .",
    "these favored positions can vary , depending on both hardware and software , but they commonly include the center or edges of a pixel , as in fig .",
    "[ sub - pixel map](c ) .",
    "sub - pixel maps are therefore very useful for detecting pixel locking .",
    "other authors have used similar graphs , where the calculated positions have been binned and plotted as a histogram @xcite .",
    "the algorithm we optimize in this paper , the moment method , has two main steps .",
    "the first step is the selection of pixels that belong to each particle in the image .",
    "the second step is the calculation of position as an intensity - weighted moment of pixel positions .    in the first step ,",
    "the selection of pixels , the user begins by choosing a threshold @xmath9 .",
    "the gray - scale image is replaced by a black - and - white image , where pixels brighter than @xmath9 become black , and all others become white .",
    "the choice of the threshold is important for several reasons @xcite , as we will discuss later .",
    "next , the boundaries for individual particle images are determined .",
    "there are several algorithms for selecting boundaries .",
    "we have examined several codes that use the moment method , and we found that the only difference is the algorithm for selecting boundaries .",
    "we will consider three algorithms , which we distinguish by the corresponding codes we will test .",
    "all three of these codes are well tested , and they generate reliable results from experimental images . in one algorithm , the boundary is selected to be a polygon that encloses only contiguous pixels brighter than the threshold , fig .",
    "[ boundaries](a ) .",
    "this algorithm is used in the freely available imagej @xcite code .",
    "the other two algorithms select a boundary that is a rectangle . in code a , the boundary is the smallest rectangle that encloses all the contiguous pixels above the threshold @xcite , fig .",
    "[ boundaries](b ) . in code",
    "k , the boundary is the smallest rectangle that encloses a special curved contour @xcite .",
    "this curved contour is produced by a 2d contour - plotting routine , and it is drawn not as line segments around pixel edges but rather as a curve passing through various pixels . within a pixel ,",
    "the pixel center is assigned the value of the original pixel intensity , but other points within a pixel are assumed to have other intensities , which are calculated by 2d interpolation using four surrounding pixel centers .",
    "then , the contour - plotting routine draws a curve by joining all points , with sub - pixel spacing , where the assumed intensity is equal to the threshold , as shown in fig .",
    "[ boundaries](c ) with a dash line . in both codes",
    "a and k , but not imagej , the boundary can enclose some pixels that are less intense than the threshold .    in the second step , which is the same in all three codes we test ,",
    "the particle positions are calculated as the moment , i.e. , as the intensity - weighted position of pixels .",
    "the moment can be calculated @xcite using eq .",
    "( [ 1stold ] ) . however , we will find it better to use a generalized form of the calculated particle position , @xmath10 where the baseline value @xmath11 will be explained later .",
    "note that the calculated particle position depends on the selection of pixels that are included in the summation in eq .",
    "( [ 1stold ] ) or eq .",
    "( [ 1stnew ] ) .",
    "to test methods of measuring particle positions , we calculate position errors as compared to true positions in synthetic images . for this purpose",
    "we can not use actual experimental images because the true position is generally not known .",
    "synthetic images allow us to vary the intensity and the size of a bright spot to find how errors depend on these parameters .",
    "units used in this paper are pixel units for all distances including @xmath5 , @xmath12 , spot size and errors .",
    "intensities , including signal and noise , are specified in intensity value units , i.e. , a dimensionless integer ranging , for example , from 0 to @xmath13 for a 14-bit camera .",
    "we prepare synthetic images that resemble an experimental image like fig .",
    "[ synthetic images](a ) .",
    "the synthetic images have a size of @xmath14 pixels , with one bright spot per image .",
    "these images have three major attributes that we compute : the spot s true position , the spatial profile of the signal , and the noise .",
    "first , the bright spot s true position is located near the image center , but displaced in the @xmath15 and @xmath16 directions by a fraction of a pixel .",
    "this is done using random numbers with a uniform distribution ( between 0 and 1 ) so that the true positions are random and uniformly - distributed relative to pixel edges .",
    "using these random positions avoids any sampling bias .",
    "second , like other authors @xcite , we model the signal s spatial profile as a gaussian @xmath17,\\ ] ] characterized by the spot radius @xmath18 and the peak intensity @xmath19 .",
    "( this gaussian is intended to approximate the actual spatial profile , which depends on factors such as the particle size , the camera s gamma , and lens defocusing . ) to imitate the collection of light onto a square pixel , we integrate this smooth profile over each pixel s area .",
    "this yields the value @xmath20 of the signal in pixel @xmath7 , @xmath21 where @xmath22 and @xmath23 are the coordinates of pixel @xmath7 .",
    "equation  ( [ pixel intensity ] ) combined with eq .",
    "( [ gaussian ] ) can be evaluated efficiently using the error function _",
    "erf_. ( after this step , each bright spot has the same total signal intensity @xmath24 , which was typically 37707 corresponding to the brightest spot in the experimental image fig .  [ experiment images](a ) .",
    "in the experiment , not every bright spot has the same total signal intensity because some particles are levitated slightly above or below the brightest part of the horizontal laser sheet . )",
    "third , we calculate a noise value @xmath25 which is different for each pixel @xmath7 . to simulate the experiment ,",
    "@xmath25 is chosen as a random intensity from the noise distribution of our digital camera , fig .",
    "[ histogram ] , which is centered at an average intensity @xmath3 = 384 .",
    "finally , the intensity @xmath6 in each pixel is calculated as the sum of the intensities of the signal and noise or a saturation value @xmath26 , whichever is smaller , @xmath27.\\ ] ] we use @xmath28 to simulate the saturation intensity of a real camera with 14-bit resolution . finally , we round @xmath6 to an integer because cameras produce integer values for the intensity of each pixel .",
    "the result of this calculation is a tiff image like fig .",
    "[ synthetic images](b ) or [ synthetic images](c ) .",
    "here we only consider bright spots that are circular , as in eq .",
    "( [ gaussian ] ) .",
    "although we do not simulate them here , we note that non - circular bright spots can be analyzed using the moment method , and they do occur in some experiments .",
    "elliptical particles arise when using analog video cameras with a limited horizontal resolution , or when particles move rapidly during the exposure time .",
    "the latter effect can be diminished by rastering a laser beam rather than dispersing it into a constant sheet .",
    "defocusing a lens can result in non - circular spots , as in sec .",
    "vii .      in this paper , we are mainly interested in errors in calculated particle positions .",
    "in addition to errors in particle position , the experimenter may also be concerned with errors in velocities and other quantities computed from particle positions , as discussed in the appendix .    to characterize the error in calculated particle positions , we use two diagnostics .",
    "first , we calculate sub - pixel maps , as described in sec .",
    "ii . examining these sub - pixel maps qualitatively will reveal pixel locking , which is one source of error .",
    "second , we characterize the total error , including both random errors and pixel locking , as the root - mean - square ( rms ) difference of true and calculated positions , i.e. , the rms error @xmath29^\\frac{1}{2},\\ ] ] where @xmath30 and @xmath8 are the index and total number , respectively , of bright spots . while we can calculate the total error using eq .",
    "( [ rms ] ) , we can not separately calculate the contributions from random errors and pixel locking .    to achieve good statistics , we prepared over 370  000 synthetic images , each with one bright spot .",
    "we used @xmath8 = 5000 when calculating the rms error , and @xmath8   =  100  000 when calculating sub - pixel maps .",
    "all of these images have different random true positions for their bright spots , and the noise in each pixel is different in all images .",
    "to find a procedure for calculating position with minimal total error , we will test three different codes , and we will vary parameters corresponding to software and hardware adjustments that an experimenter can make .",
    "we will now list these adjustments . the experimenter can choose to focus the camera lens sharply , or defocus it to make the bright spots in the image appear larger and fill more pixels .",
    "as a second parameter , the experimenter can adjust the image intensity by varying the camera aperture , exposure time or illumination brightness .",
    "after recording images with the camera , the experimenter will then use software . here , we test three moment method codes , as explained in sec .  iii .",
    "after choosing a code , the experimenter can usually adjust two parameters in that code : the threshold used in the first step , and the baseline ( if any ) that is subtracted in the second step , as in eq .",
    "( [ 1stnew ] ) .",
    "thus , we are motivated to analyze the impact of the following four parameters that the experimenter must choose : focus , intensity , threshold , and baseline .",
    "we do this by varying the values of @xmath18 ( keeping the total signal intensity @xmath24 as constant , as explained later ) , @xmath19 , @xmath9 , and @xmath11 , respectively .",
    "we will vary each of these four parameters in sec .  v. we will also compare results from the three different codes .",
    "the outcome of this analysis will be a practical procedure , presented in sec .",
    "vi , that the experimenter can use to minimize errors in calculated positions .",
    "the first parameter we vary is the threshold .",
    "the experimenter will first choose a coarse range of threshold so that it is not so low that noise is wrongly identified as particles and not so high that fainter particles are overlooked .",
    "then , within this coarse range , a fine adjustment can be made to reduce error . here , we consider the fine adjustment .    our results in fig .",
    "[ threshold ] show that the total error generally increases with threshold , and it also depends on the choice of a code .",
    "we calculate the total error as the rms error , using @xmath8 = 5000 images and eq .",
    "( [ rms ] ) . recall that the total error includes both random and pixel - locking errors .",
    "the total error generally increases with the threshold because raising the threshold can eliminate pixels that have useful signal .",
    "the total error exhibits not only a general increase with threshold , but also an oscillation .",
    "this is seen in fig .",
    "[ threshold ] , where there are several oscillations superimposed on the general trend .",
    "we can not dismiss these oscillations as mere statistical fluctuations because we achieved good statistics by using 5000 particle positions . to identify the cause of these oscillations",
    ", we tested how the boundaries that are selected in the first step depend on the threshold .",
    "the result of this test is shown in fig .",
    "[ boundary effect ] as a table of the boundaries selected by imagej . when the threshold is increased slightly so that the boundary shrinks by one pixel , there is a discrete jump in the calculated particle position . as the threshold increases , there is a sequence of jumps , as the boundary becomes smaller , one pixel at a time .",
    "these jumps , in aggregate for many particles , lead to oscillations in the rms error as the threshold is varied , which is the phenomenon we term the `` boundary effect '' .    to identify the role of pixel locking in the total error",
    ", we examine sub - pixel maps in fig .",
    "[ 4sub - pixel maps ] , which reveal the importance of the threshold . for imagej",
    ", we provide sub - pixel maps , fig .",
    "[ 4sub - pixel maps](a ) and [ 4sub - pixel maps](b ) , that correspond to the two thresholds that yielded the minimum and maximum rms errors , respectively , in fig .",
    "[ threshold ] .",
    "we note that the signature of pixel locking is weaker , i.e. , the sub - pixel map is more uniform , for the case of the low threshold , fig .",
    "[ 4sub - pixel maps](a ) , that yields the lowest total error .",
    "conversely , the signature of pixel locking is stronger , i.e. , the sub - pixel map has strongly non - uniform features , for the higher threshold , fig .",
    "[ 4sub - pixel maps](b ) . in general , reducing the threshold will reduce pixel locking .",
    "other codes exhibit the same trend , but with a different appearance for the sub - pixel maps , as in fig .",
    "[ 4sub - pixel maps](c ) and [ 4sub - pixel maps](d ) .      to simulate an experimenter s slight defocusing of a camera lens",
    ", we varied the spot radius @xmath18 in fig .",
    "[ radius ] .",
    "we used the gaussian profile of eq .",
    "( [ gaussian ] ) , keeping the spot s total signal intensity ( @xmath24 summed over all pixels ) constant . in this way we mimic an experiment where a particle scatters the same finite number of photons into a camera lens regardless of how the lens is focused .",
    "( we did not simulate the ring - shaped bright spot that can occur for extreme defocusing . )",
    "defocusing can happen when an experimenter purposefully chooses to defocus the lens for example to avoid saturating pixels ; in other cases , defocusing is not intentional but instead simply unavoidable because particles are at different depths , as for example in colloidal suspensions @xcite and 3d dusty plasma suspensions @xcite .    defocusing a lens during the experiment can actually be desirable . by distributing the signal over a larger number of pixels ,",
    "the impact of a single pixel in the calculation of the particle s position is less , so that pixel locking becomes weaker . on the other hand",
    ", defocusing can reduce the signal in each pixel , so that the signal - to - noise ratio ( snr ) in each pixel becomes worse . in other words",
    ", there can be a trade - off : defocusing can improve pixel locking at the expense of making random errors worse . in our results below we investigate this effect .",
    "we should mention that when discussing defocusing , we always refer to the experimenter s adjustment to the hardware when recording an image . unlike some other methods @xcite , here we do not blur an image in software after it has been recorded by the hardware .",
    "the result in fig .  [ radius ] reveals three ranges of the spot radius , where the second range is the most desirable . in the first range , with small spot radii ( @xmath31 )",
    ", the total error diminishes with radius because the spot includes a saturated pixel .",
    "saturated pixels are undesirable because they introduce wrong information for intensity into eq .",
    "( [ 1stnew ] ) . in the second range , with slightly larger spot radii ( @xmath32 ) ,",
    "the total error is smallest . in the third range , with large spot radii ( @xmath33 ) ,",
    "the total error generally increases with @xmath18 because the trade - off results in the undesirable outcome of the worsened snr in each pixel having a stronger effect than the improved pixel locking due to defocusing .",
    "the optimal spot radius is somewhere in the second range , which for our parameters is approximately 0.8 - 2.0 .",
    "we should emphasize , however , that this range will vary depending on the experiment due to different cameras ( with different noise levels , sensitivities and saturation levels ) , particle size , illumination , and working distance between particles and lens .",
    "if the camera had a higher noise level , the errors in this third range would be larger and the experimenter would be unable to use much defocusing .",
    "on the other hand , if the illumination were brighter , then the entire curve in fig .",
    "[ radius ] would shift toward larger spot radii and the experimenter would be able to use more defocusing .    in fig .",
    "[ radius ] we also note an oscillation , superimposed on the general trend , for @xmath34 . we attribute this oscillation , which was observed previously in experiments by kding and melzer @xcite , to a boundary effect similar to the one described above .      to simulate adjusting the illumination brightness , the exposure time , or the camera aperture , we varied @xmath19 in fig .",
    "[ intensity ] . as a result ,",
    "the total signal intensity @xmath24 is varied , while @xmath18 is kept constant .",
    "we note that imagej yields the smallest total error .",
    "the trend that would be expected for random errors only is a downward slope as the intensity is increased , due to an improving snr in each pixel .",
    "this trend is indeed observed fig .",
    "[ intensity ] , but only for some of the data , as indicated by solid curves .",
    "the opposite trend is also observed in fig .",
    "[ intensity ] , as indicated by dashed curves ; since this trend is opposite to what is expected for random errors only , we attribute it to pixel locking .",
    "we term this particular effect of pixel locking the `` pedestal effect . ''",
    "the pedestal effect is the result of a non - optimal choice of the baseline . to illustrate this effect , in fig .  [ pedestal ]",
    "we have sketched the cross section of a bright spot .",
    "the portion of this cross section that lies within the boundary , defined by the threshold , is shown shaded .",
    "this portion is divided in fig .  [ pedestal ] into two parts , above and below the threshold .",
    "we term the part below the threshold the `` pedestal , '' fig .",
    "[ pedestal ] .",
    "the contribution of the pedestal to the moment in eq .",
    "( [ 1stnew ] ) can be large , or small , depending on whether @xmath11 is small or large , respectively . in the extreme case of a very large pedestal that dominates the calculation of the particle position ,",
    "the calculated particle position will often fall near a pixel edge or midpoint , as it does in the case of a centroid , thereby contributing to severe pixel locking .",
    "we term this tendency toward severe pixel locking the `` pedestal effect . ''",
    "below , we will determine the best choice of @xmath11 in order to reduce the pedestal effect and the pixel - locking errors that it introduces to the calculated particle positions .    to test the effect of the baseline that is chosen , in fig .",
    "[ new intensity ] we present the total error , calculated as the rms error , for three different baseline values . from fig .",
    "[ new intensity ] , we see that the total error is reduced by using a larger baseline value .",
    "the best choice is @xmath35 , because this results in the smallest total error .",
    "it also minimizes pixel locking ; the downward slope in fig .",
    "[ new intensity ] indicates that random errors dominate .",
    "thus , we conclude that in the second step , when using eq .",
    "( [ 1stnew ] ) , the baseline should be chosen to be the same as the threshold that was used in the first step .",
    "this can be done most simply by subtracting the same threshold for every pixel in the image . alternatively",
    ", a different baseline level @xmath36 for each pixel could be subtracted in eq .",
    "( [ 1stnew ] ) , to account for a different background level for each pixel .",
    "the latter method is useful because it allows the experimenter to eliminate optical reflections due to room lights , for example .",
    "the experimenter can calculate all the @xmath36 baseline values for the pixels as follows .",
    "first , the experimenter will use the camera to record a `` dark - field '' image , with the illumination turned off so that particles are not visible . to improve the statistics ,",
    "the experimenter can record a series of dark - field images and average them , pixel - by - pixel , to reduce the effect of random noise .",
    "this will yield an intensity @xmath37 for each pixel .",
    "second , the baseline for each pixel will be calculated as @xmath38 here , @xmath3 can be calculated as the average of @xmath37 for pixels in the image .    with an optimal choice of both threshold and baseline",
    ", one can achieve a sub - pixel map that shows no evidence of pixel locking , as seen in fig .",
    "[ 2sub - pixel maps](a ) .",
    "this map was prepared using imagej , with a baseline equal to the threshold .",
    "this choice of a baseline minimizes the total error , as we learned above .",
    "the reason that choosing @xmath39 minimizes the total error is now clear : it greatly reduces pixel locking , so that mainly errors from random noise remain . to further demonstrate the usefulness of choosing a baseline equal to the threshold , compare fig .",
    "[ 4sub - pixel maps](a ) to fig .",
    "[ 2sub - pixel maps](a ) .",
    "the former figure , which was prepared similarly except with no baseline subtraction , reveals some pixel locking , while the latter does not .",
    "an experimenter , when attempting to choose optimal parameters , will be unable to calculate the rms error , as we have done in fig .",
    "[ new intensity ] , for example .",
    "this is because the true positions of particles are generally unknown .",
    "the experimenter can , however , calculate sub - pixel maps , such as fig .",
    "[ 2sub - pixel maps ] , because these require only calculated positions .",
    "comparing fig .",
    "[ 2sub - pixel maps](a ) and [ 2sub - pixel maps](b ) , which were both calculated with @xmath39 , but with a different @xmath9 , we see that the signature of pixel locking depends on the threshold .",
    "we now find our best result by varying the threshold , in fig .",
    "[ new threshold ] , to minimize the rms error .",
    "the threshold is the last parameter to choose , assuming that the experimenter has already : ( 1 ) established the illumination level , ( 2 ) chosen a camera with a given noise level , ( 3 ) defocused the camera lens to avoid saturating pixels , and ( 4 ) planned to use a baseline @xmath39 . noting that the rms error in fig .",
    "[ new threshold ] has several minima , we identify an optimal threshold by choosing the lowest minimum .",
    "this yields our best result , an rms error of 0.017 .",
    "these same parameters also virtually eliminate the signature of pixel locking in fig .",
    "[ 2sub - pixel maps](a ) .",
    "an experimenter can identify an optimal @xmath9 similarly , but without calculating the rms error , by examining sub - pixel maps for various values of @xmath9 , and among the maps with weak pixel - locking signatures , choosing the one with the lowest value of @xmath9 .",
    "we present here a practical procedure for using the moment method that minimizes the total error , including both random errors and pixel locking .",
    "this practical procedure includes first the use of hardware to record images and then the use of software to analyze them .",
    "our software uses the moment method with baseline subtraction as we tested above ; there are also other well - tested analysis methods that experimenters may wish to consider @xcite .    for the hardware that produces the image",
    ", one will choose a camera and make adjustments to the intensity and lens focusing . choosing a camera with low noise",
    "will not only reduce random errors ; it will also allow the use of a lower threshold which can improve pixel locking . in using the camera , the optimal choices of intensity and lens defocusing must be considered together .",
    "the intensity can be varied , for example , by adjusting the camera aperture , exposure time , or illumination level . to achieve a high snr in each pixel ,",
    "we adjust the intensity upward as high as possible without saturating pixels .",
    "another way to improve snr is pixel binning , which also increase frame rate , but at the expense of spatial resolution @xcite . if additional intensity is available but pixels are saturated , the experimenter can defocus the lens to avoid saturating the brightest pixels .",
    "defocusing the lens helps reduce pixel locking , but it can increase random errors by reducing the snr in each pixel ; therefore , defocusing beyond a certain point actually worsens the total error .",
    "the optimal lens defocusing will depend on parameters such as intensity , camera noise level , and number of camera bits , which vary from one experiment to another .",
    "for the parameters we simulated ( see fig .  [ radius ] ) we found that the optimal spot radius was in the range 0.8 - 2.0 , measured as the gaussian half - width . for other parameters",
    ", we can offer this general guidance : the optimal lens defocusing will be determined by the need to achieve an adequate snr in each pixel .",
    "noisier cameras or weaker illumination will require less defocusing , while low - noise cameras and brighter illumination will allow more defocusing .",
    "the lens should generally be defocused at least enough to avoid saturating pixels",
    ".    for the image analysis software , there are usually three important choices .",
    "first , we prefer a code that has as its first step the selection of a boundary that includes only contiguous pixels above a threshold .",
    "the freely available imagej code selects such a boundary .",
    "second , if the boundary is selected as described above in the first step , then in the second step , using eq .",
    "( [ 1stnew ] ) , the baseline should be chosen equal to the threshold , in order to reduce pixel locking .",
    "this can be done either by subtracting the same baseline value from every pixel in a single step , or by using eq .",
    "( [ diffbase ] ) with dark - field images if the experimenter wishes to remove the effect of optical reflections for example .",
    "third , the threshold should be chosen in a two - part process .",
    "to start , the experimenter should count the number of particles that are identified , and then choose a coarse range as explained in sec .",
    "v  a. next , within this coarse range , sub - pixel maps should be calculated for various thresholds . in order to reduce both random and pixel - locking errors",
    ", the user should choose the lowest threshold that has a weak signature of pixel locking .",
    "the moment method can achieve very low errors in particle position measurement when it is used optimally .",
    "for the case we simulated , an rms error as small as 0.017 is achievable by making optimal choices in the software .",
    "even smaller errors could be attained if the intensity were brighter or the camera had less noise .",
    "readers who wish to perform tests similar to ours may use our codes and images @xcite .",
    "to demonstrate the practical procedure above , we used it in an experiment .",
    "the results presented above , based on synthetic images , indicate that both total errors and pixel locking will be reduced if we follow the practical procedure . using experimental images",
    ", one can detect the signature of pixel locking using sub - pixel maps .",
    "we describe next the hardware and software components of our experimental test .    for the hardware ,",
    "the experiment was similar to the one for fig .",
    "[ experiment images](a ) , including using the same 14-bit camera , except that we improved the experimental method by slightly defocusing the lens . a cropped portion of the @xmath40 pixels image fig .",
    "[ new exp images](a ) and a magnified view fig .",
    "[ new exp images](b ) show that a bright spot fills more pixels than in fig .",
    "[ experiment images](b ) where the lens was sharply focused . due to defocusing",
    ", the spots are slightly noncircular . additionally , we binned @xmath41 pixels . as a result of these changes ,",
    "the total intensity of a bright spot is typically 39240 , as compared to 21000 ( with a maximum of 37707 ) for fig .",
    "[ experiment images](a ) , and the noise peak is shifted to a lower intensity .",
    "a further possible improvement in the hardware is using a more powerful laser , and we plan to do that in future experiments .    for the software , we used imagej to identify particles from 100 experimental images .",
    "we excluded any identified particles that filled only one single pixel .",
    "first , we chose a coarse range for the threshold by counting the number of identified particles as a function of the threshold , fig .",
    "[ number vs threshold ] .",
    "we looked for a nearly flat portion , which is from 325 to 925 here , and we chose that as the coarse range .",
    "next , we calculated particle positions using eq .",
    "( [ 1stnew ] ) , along with eq .",
    "( [ diffbase ] ) to calculate @xmath36 using an average of 2000 dark - field images .",
    "we repeated these calculations of particle positions for various thresholds , each time preparing a sub - pixel map .",
    "finally , we will examine these sub - pixel maps to choose the lowest threshold that has a weak signature of pixel locking .    in fig .",
    "[ 8sub - pixel maps ] , we present the sub - pixel map that results from following our practical procedure in panel ( a ) . examining this sub - pixel map , we see that it has no obvious signature of pixel locking when viewed in its entirety . to search for signatures , we zoom into the lower left corner , fig .",
    "[ 8sub - pixel maps](b)-(h ) .",
    "there , we can identify an artifact of pixel locking : a concentration of calculated positions on pixel edges .",
    "our practical procedure requires choosing the lowest threshold with a weak signature of pixel locking . for our results in fig .",
    "[ 8sub - pixel maps ] , thresholds in the range 325 - 425 have no identifiable signature , leading us to choose 325 .",
    "we conclude that the signature of pixel locking is vastly improved by using our practical procedure .",
    "this conclusion is based on a comparison of the sub - pixel maps in fig .",
    "[ 8sub - pixel maps](a ) and fig .",
    "[ sub - pixel map](c ) .",
    "the latter was prepared for a similar experiment but a different camera , illumination , and analysis method .",
    "the signature of pixel locking is profound in fig .",
    "[ sub - pixel map](c ) , but it is virtually undetectable in fig .  [ 8sub - pixel maps](a)-(c ) .",
    "we thank o.  arp and u.  konopka for providing codes and helpful discussions .",
    "we also thank r.  mutel , v.  nosenko , a.  piel , t.  sheridan , and e.  thomas   jr . for helpful discussions . this work was supported by nasa and the u.s .",
    "department of energy .",
    "errors in the calculated particle positions can introduce errors in other quantities that are calculated from the positions . in ptv ,",
    "velocities are calculated as @xmath42 , as discussed in sec .",
    "i. pixel locking can affect the velocity calculation greatly in experiments .",
    "for example , if pixel locking is so severe that most calculated positions are located only at pixel centers , then almost all particle velocities calculated in ptv will be quantized as an integer number of pixel widths per frame .",
    "these errors in calculating velocities can propagate to other calculations .",
    "velocity distribution functions @xmath43 can be badly affected , with noticeable peaks @xcite that are signatures of pixel locking .",
    "however , we have found that wave spectra and velocity correlation functions are not affected so badly .",
    "while it is beyond the scope of this paper to completely characterize the errors in @xmath44 or @xmath43 , we can discuss the contributions to the total error in @xmath44 .",
    "for ptv , the rms error , @xmath45 , has two contributions , @xmath46 arising from the errors in position , and @xmath47 arising from correlations in the two errors .",
    "if the calculated position had random errors only , the correlation @xmath48 would be zero and the rms error in @xmath44 would be minimized when the rms error in @xmath15 is minimized . however , pixel - locking errors can have correlations , which will vary depending on the velocities , and these will affect @xmath49 in a way that is difficult to predict .    aside from these quantities , which are calculated from velocities ,",
    "experimenters often calculate other quantities from the position itself .",
    "the mean - square displacement ( msd ) , which is used to measure diffusion , is calculated from position .",
    "particle position errors can cause the msd to be exaggerated significantly at small times when the displacement is small , but not at large times when the displacement is large @xcite .",
    "another use of particle positions is the study of structure @xcite .",
    "while we have not analyzed the sensitivity of structural analysis methods to particle position errors , we expect that calculations that are sensitive to small changes in interparticle distances , such as voronoi maps for detecting defects , will be more affected than correlation functions that use data over a wide range of distances .",
    "w.  s.  rasband , computer code imagej version 1.34 ( u.  s.  national institutes of health , bethesda , maryland , 2006 ) http://rsb.info.nih.gov / ij/. the `` center of mass '' is displaced 1/2 pixel in both directions , as compared to our definition .",
    "a.  stein , a.  huertas , and l.  matthies , `` attenuating stereo pixel - locking via affine window adaptation , '' presented at the ieee international conference on robotics and automation , may , 2006 .",
    "d.  nehab , s.  rusinkiewiez , and j.  davis , `` improved sub - pixel stereo correspondences through symmetric refinement , '' presented at the tenth ieee international conference on computer vision , 2005 .",
    "see epaps document no . for codes and sample images used in this paper .",
    "this document can be reached through a direct link in the online article s html reference section or via the epaps homepage ( http://www.aip.org/pubservs/epaps.html ) ."
  ],
  "abstract_text": [
    "<S> the moment method is an image analysis technique for sub - pixel estimation of particle positions . </S>",
    "<S> the total error in the calculated particle position includes effects of pixel locking and random noise in each pixel . </S>",
    "<S> pixel locking , also known as peak locking , is an artifact where calculated particle positions are concentrated at certain locations relative to pixel edges . </S>",
    "<S> we report simulations to gain an understanding of the sources of error and their dependence on parameters the experimenter can control . </S>",
    "<S> we suggest an algorithm , and we find optimal parameters an experimenter can use to minimize total error and pixel locking . simulating a dusty plasma experiment , we find that a sub - pixel accuracy of 0.017 pixel or better can be attained . </S>",
    "<S> these results are also useful for improving particle position measurement and particle tracking velocimetry ( ptv ) using video microscopy , in fields including colloids , biology , and fluid mechanics . </S>"
  ]
}