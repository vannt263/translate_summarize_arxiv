{
  "article_text": [
    "our objective is to accurately and precisely measure the quality factor @xmath0 , and resonant frequency @xmath1 of a microwave resonator , using complex transmission coefficient data as a function of frequency .",
    "accurate @xmath0 and @xmath2 measurements are needed for high precision cavity perturbation measurements of surface impedance , dielectric constant , magnetic permeability , etc . under realistic experimental conditions ,",
    "corruption of the data occurs because of cross - talk between the transmission lines and between coupling structures , the separation between the coupling ports and measurement device , and noise .",
    "although there are many methods discussed in the literature for measuring @xmath0 and resonant frequency , we are aware of no treatment of these different methods which quantitatively compares their accuracy or precision under real measurement conditions . in practice , the @xmath0 can vary from 10@xmath3 to 10@xmath4 in superconducting cavity perturbation experiments , so that a @xmath0 determination must be robust over many orders of magnitude of @xmath0 . also , it must be possible to accurately determine @xmath0 and @xmath2 in the presence of modest amounts of noise .",
    "in this paper we will determine the best methods of evaluating complex transmission coefficient data , i.e. the most precise , accurate , robust in @xmath0 , and robust in the presence of noise .",
    "many different methods have been introduced to measure the quality factor and resonant frequency of microwave cavities over the past fifty years .",
    "smith chart methods have been used to determine half power points which can be used in conjunction with the value of the resonant frequency to deduce the quality factor of the cavity.@xcite@xmath5@xcite in the decay method for determining the quality factor , the fields in the cavity are allowed to build up to equilibrium , the input power is turned off , and the exponential decrease in the power leaving the cavity is measured and fit to determine the quality factor of the cavity.@xcite    cavity stabilization methods put the cavity in a feedback loop to stabilize an oscillator at the resonant frequency of the cavity.@xcite@xmath5@xcite for one port cavities , reflection measurements provide a determination of the half power points and also determine the coupling constant , allowing one to calculate the unloaded @xmath0.@xcite@xmath5@xcite in more recent years , complex transmission coefficient data vs. frequency is found from vector measurements of transmitted signals through the cavity.@xcite@xmath5@xcite methods which use this type of data to determine @xmath0 and @xmath2 are the subject of this paper .",
    "we have selected seven different methods for determining @xmath2 and @xmath0 from complex transmission coefficient data .",
    "we have collected sets of typical data from realistic measurement situations to test all of the @xmath0 and @xmath2 determination methods .",
    "we have also created data and added noise to it to measure the accuracy of the methods . in this paper",
    "we consider only random errors and not systematic errors , such as vibrations of the cavity which artificially broaden the resonance.@xcite@xmath5@xcite after comparing all of the different methods , we find that the nonlinear least squares fit to the phase vs. frequency and the nonlinear least squares fit of the magnitude of the transmission coefficient to the lorentzian curve are the best methods for determining the resonant frequency and quality factor .",
    "the phase vs. frequency fit is the most precise and accurate over many decades of @xmath0 values if the signal - to - noise ratio ( snr ) is high ( snr 65 ) , however the lorentzian fit is more robust for noisier data",
    ". some of the methods discussed here rely on a circle fit to the complex transmission coefficient data as a step to finding @xmath2 and @xmath0 .",
    "we find that by adjusting this fitting we can improve the determination of the quality factor and resonant frequency , particularly for noisy data .    in section ii of this paper ,",
    "the simple lumped element model for a microwave resonator is reviewed and developed . a description of our particular experimental setup",
    "is then given , although the results of this paper apply to any transmission resonator .",
    "we then discuss the data collected and generated for use in the method comparison in section iii .",
    "section iv outlines all of the methods that are studied in this paper . it should be noted that each method is tested using exactly the same data .",
    "the results of the comparison are presented and discussed in section v. possible improvements for some of the methods follow in section vi , and the concluding remarks of the paper are made in the final section .",
    "to set the stage for our discussion of the different methods of determining    @xmath0 and resonant frequency , we briefly review the simple lumped - element model of an electromagnetic resonator . as a model for an ideal resonator",
    ", we use the series rlc circuit ( see inset of fig .",
    "[ lorentzian ] ) , defining @xmath6 as the resonant frequency @xmath2.@xcite the quality factor is defined as 2@xmath7 times the ratio of the total energy stored in the resonator to the energy dissipated per cycle.@xcite for the lumped element model in fig .",
    "[ lorentzian ] , the quality factor @xmath0 is @xmath8 .",
    "the resonator is coupled to transmission lines of impedance @xmath9 by the mutual inductances @xmath10 and @xmath11 . the complex transmission coefficient , @xmath12 ( ratio of the voltage transmitted to the incident voltage ) , as a function of driving frequency @xmath13 , is given in the limit of weak coupling by:@xcite @xmath14 the additional assumption that @xmath13 @xmath15 @xmath2 near resonance simplifies the frequency dependence in the denominator resulting in : @xmath16 where @xmath17 is the maximum of the transmission coefficient which occurs at the peak of the resonance : @xmath18 here @xmath19 is the resistance in the circuit model and this expression again is valid in the weak coupling limit . on the far right side of eq .",
    "( [ 2 ] ) , @xmath20 and @xmath21 are the coupling coefficients on ports 1 and 2 , respectively,@xcite@xmath22@xcite where @xmath23 , with @xmath24 . the magnitude of the complex transmission coefficient is : @xmath25 the plot of @xmath26 vs. frequency forms a lorentzian curve with the resonant frequency located at the position of the maximum magnitude ( fig . [ lorentzian ] ) .",
    "a numerical investigation of @xmath26 with and without the simplified denominator assumption leading to eq .",
    "( [ 1 ] ) , shows that even for a relatively low @xmath0 ( @xmath27100 ) , the difference between the magnitudes is less than half a percent of the magnitude using eq .",
    "( [ 0 ] ) . for larger q",
    "the difference is much smaller , so we take this assumption as valid .",
    "all of the analysis methods treated in this paper make use of the simplified denominator assumption , as well as all the data we create to test the methods .",
    "the plot of the imaginary part of @xmath12 ( eq . ( [ 1]))versus the real part ( with frequency as a parameter ) , forms a circle in canonical position with its center on the real axis ( fig . [ circles ] ) .",
    "the circle intersects the real axis at two points , at the origin and at the location of the resonant frequency .",
    "important alterations to the data occur when we take into account several aspects of the real measurement situation .",
    "the first modification arises when considering the cross talk between the cables and/or the coupling structures .",
    "this introduces a complex translation @xmath28 , of the center of the circle away from its place on the real axis.@xcite@xmath22@xcite@xmath22@xcite secondly , a phase shift @xmath29 is introduced because the coupling ports of the resonator do not necessarily coincide with the plane of the measurement .",
    "this effect rotates the circle around the origin ( fig .",
    "[ circles]).@xcite@xmath22@xcite@xmath22@xcite the corrected complex transmission coefficient , @xmath30 , is then given by : @xmath31 it should be noted that the order in which the translation and rotation are performed is unique.@xcite    any method of determining @xmath0 and @xmath2 from complex transmission data must effectively deal with the corruption of the data represented by eq . ( [ 4 ] ) .",
    "in addition , the method used to determine @xmath2 and @xmath0 must give accurate and precise results even in the presence of noise .",
    "this is necessary since , in typical measurements , @xmath0 ranges over several orders of magnitude causing the signal - to - noise ratio ( snr , defined in section iii .",
    "c. ) during a single data run to vary significantly .",
    "further corruption of the data can occur if there are nearby resonances present , particularly those with lower @xmath0 .",
    "this introduces a background variation onto the circles shown in fig .",
    "[ circles ] and may interfere with the determination of @xmath2 and @xmath0 . in this paper",
    "we consider only single isolated resonances and refer the reader to an existing treatment of multiple resonances.@xcite",
    "in this section we discuss the data we use for making quantitative comparisons of each method .",
    "the data is selected to be representative of that encountered in real measurement situations .",
    "each trace consists of 801 frequency points , each of which have an associated real and imaginary part of @xmath12 .",
    "two types of data have been used for comparing the methods ; measured data and generated data .",
    "the measured data is collected with the network analyzer and cavity described below .",
    "the generated data is constructed to look like the measured data , but the underlying @xmath0 and resonant frequency are known exactly .",
    "all of the methods discussed in the next section are tested using exactly the same data .",
    "complex transmission coefficient vs. frequency data is collected using a superconducting cylindrical niobium cavity submerged in liquid helium at 4.2 k. microwave coupling to the cavity is achieved using magnetic loops located at the end of 0.086  coaxial cables .",
    "the loops are introduced into the cavity with controllable position and orientation .",
    "the coaxial cables come out of the cryogenic dewar and are then connected to an hp8510c vector network analyzer.@xcite the cavity design@xcite has recently been modified to allow top - loading of the samples into the cavity .",
    "a sample is introduced into the center of the cavity on the end of a    sapphire rod .",
    "the temperature of the sample can be varied by heating the rod , with a minimal perturbation to the superconducting nb walls .",
    "the quality factor of the cavity resonator in the te@xmath32 mode can range from about 2 @xmath33 10@xmath3 to 1 @xmath33 10@xmath4 , with a resonant frequency of approximately 9.6 ghz . in a typical run with a superconducting crystal , where the temperature varies from 4.2 k to 200 k ,",
    "@xmath2 decreases by about 10 mhz and @xmath0 changes from about 1 @xmath33 10@xmath3 to 4 @xmath33 10@xmath4 .",
    "for accurate measurement of the electrodynamic properties of samples , it is important to be able to resolve frequency shifts of the cavity as small as 1 hz at low temperatures .",
    "one hundred @xmath12 vs. frequency traces were taken using the network analyzer held at a fixed power and with constant coupling to the cavity .",
    "one such data set was made with the source power at @xmath3415 dbm ( snr @xmath35 368 , @xmath36 9.600242 ghz , @xmath0 @xmath35 6.39 @xmath33 10@xmath37 ) , another set was taken with the source power at @xmath3410 dbm ( snr @xmath35 108 , @xmath36 9.599754 ghz , @xmath0 @xmath35 6.46 @xmath33 10@xmath37 ) , a third data set was taken with the source power at @xmath343 dbm ( snr @xmath35 49 , @xmath36 9.599754 ghz , @xmath0 @xmath35 6.50 @xmath33 10@xmath37 ) .",
    "( the approximate values for @xmath2 and @xmath0 are obtained from the phase vs. frequency averages discussed below )      to collect data with a systematic variation of signal - to - noise ratio , we took single traces at a series of different input powers .",
    "a power - ramped data set was taken in a cavity where controllable parameters , such as temperature and coupling , were fixed , the only thing that changed was the microwave power input to the cavity .",
    "an @xmath12 vs. frequency trace was taken for powers ranging from @xmath3818 dbm to @xmath3415 dbm , in steps of 0.5 dbm .",
    "this corresponds to a change in the signal - to - noise ratio from about 5 to 168 ( @xmath36 9.603938 ghz , @xmath0 @xmath35 8.71 @xmath33 10@xmath37 ) .      to check the accuracy of all the methods , we generated data with known characteristics , and added a controlled amount of noise to simulate the measured data .",
    "the data was created using the real and imaginary parts of an ideal @xmath12 as a function of frequency eq .",
    "( [ 1 ] ) ; @xmath39 where @xmath17 is the diameter of the circle being generated ( see fig . [ circles ] ) , @xmath0 is the quality factor , and @xmath2 is the resonant frequency , which are all fixed .",
    "the frequency @xmath13 , is incremented around the resonant frequency to create the circle .",
    "there are 400 equally spaced frequency points before and after the resonant frequency , totaling 801 data points .",
    "the total span of the generated data is about four 3db bandwidths for all q values .    to simulate measured data ,",
    "noise was added to the data using gaussian distributed random numbers@xcite that were scaled to be a fixed fraction of the radius , @xmath40 of the circle described by the data in the complex @xmath12 plane .",
    "the noisy data was then translated and rotated to mimic the effect of cross talk in the cables and coupling structures , and delay ( eq .",
    "( [ 4 ] ) ) .",
    "a power ramp was simulated by varying the amplitude of the noise added to the circles .",
    "a total of 78 @xmath12 vs. frequency traces were created with a variation of the signal - to - noise ratio from about 1 to 2000 ( @xmath2 @xmath41 9.600 ghz , @xmath0 @xmath41 1.00 @xmath33 10@xmath37 , @xmath42 0.1972,@xmath430.0877 , @xmath44 0.2 , @xmath45/17 )      data with different fixed @xmath0 values were created using the above real and imaginary expressions for @xmath12 .",
    "groups of data were created with 100 traces each using : @xmath0 = 10@xmath46 , 10@xmath4 , 10@xmath47 , 10@xmath48 ( @xmath2 = 9.600 ghz and snr @xmath35 65 for all sets ) .",
    "they include fixed noise amplitude , and were each rotated and translated equal amounts to simulate measured data .",
    "( @xmath42 0.01 , @xmath49 0.015 , @xmath44 0.2 , @xmath45/19 )      the signal - to - noise ratio was found for all data sets by first determining the radius @xmath50 , and center @xmath51 of the circle when plotting the imaginary part of the complex transmission coefficient vs. the real part ( fig . [ circles ] ) .",
    "next , the distance to each data point @xmath52 ( @xmath53 1 to 801 ) from the center is calculated from : @xmath54 the signal - to - noise ratio is defined as : @xmath55 in the case of generated data , where the center and radius of the circle are known , the snr is very well defined .",
    "however , the snr values are approximate for the measured data because of uncertainties in the determination of the center and radius of the circles .",
    "in this section we summarize the basic principles of the leading methods for determining the @xmath0 and resonant frequency from complex transmission coefficient vs. frequency data .",
    "further details on implementing these particular methods can be found in the cited references . because we believe that this is the first published description of the inverse mapping technique",
    ", we shall discuss it in more detail than the other methods .",
    "the resonance curve area and snortland techniques are not widely known , hence a brief review of these methods is also included .",
    "the first three methods take the data as it appears and determine the @xmath0 from the estimated bandwidth of the resonance .",
    "the last four methods make an attempt to first correct the data for rotation and translation ( eq .",
    "( [ 4 ] ) ) , then determine @xmath2 and @xmath0 of the data in canonical position .",
    "the 3 db method uses the @xmath26 vs. frequency data ( fig .",
    "[ lorentzian ] ) , where @xmath56 .",
    "the frequency at maximum magnitude is used as the resonant frequency , @xmath2 .",
    "the half power points @xmath57 are determined on either side of the resonant frequency and the difference of those frequency positions is the bandwidth @xmath58 .",
    "the quality factor is then given by : @xmath59 because this method relies solely on the discrete data , not a fit , it tends to give poor results as the signal - to - noise ratio decreases .      for this method , the @xmath26 vs. frequency data is fit to a lorentzian curve ( eq .",
    "( [ 3 ] ) and fig",
    ". [ lorentzian ] ) using a nonlinear least squares fit.@xcite the resonant frequency @xmath2 , bandwidth @xmath60 , constant background @xmath61 , slope on the background @xmath62 , skew @xmath63 , and maximum magnitude @xmath64 are used as fitting parameters for the lorentzian : @xmath65    the least squares fit is iterated until the change in chi squared is less than 1 part in 10@xmath4 .",
    "the @xmath0 is then calculated using the values of @xmath2 and @xmath60 from the final fit parameters : @xmath66 .",
    "this method is substantially more robust in the presence of noise than the 3 db method . for purposes of comparison with other methods",
    ", we shall use the simple expressions for @xmath2 and @xmath0 given above , rather than the values modified by the skew parameter .      in an attempt to use all of the data , but to minimize the effects of noise in the determination of @xmath0 , the resonance curve area ( rca ) method was developed.@xcite in this approach the area under the @xmath67 curve is integrated to arrive at a determination of @xmath0 . in detail",
    ", the rca method uses the magnitude data squared , @xmath68 , versus frequency and fits it to a lorentzian peak ( same form as fig .",
    "[ lorentzian ] ) : @xmath69 using the resonant frequency , @xmath2 , and the maximum magnitude squared , @xmath70 , as fitting parameters .",
    "the bandwidth @xmath71 is a parameter in the lorentzian fit , but is not allowed to vary .",
    "this method iterates the lorentzian fit until chi squared changes by less than 1 part in 10@xmath47 .",
    "next , using the fit values from the lorentzian , the squared magnitude @xmath72 is found at two points @xmath73 @xmath74 @xmath75 on the tails of the lorentzian far from the resonant frequency .",
    "the area under the data , @xmath76 , from @xmath2 @xmath38 @xmath75 to @xmath2 @xmath34 @xmath75 ( symmetric positions on either side of the resonant frequency ) is found using the trapezoidal rule:@xcite @xmath77 here @xmath78 indicates the magnitude squared data point at the frequency @xmath79 , and @xmath80 is the frequency step between consecutive data points .",
    "the quality factor is subsequently computed from the area as follows:@xcite @xmath81    this @xmath0 is compared to the previously determined one . if @xmath0 changes by more than 1 part in 10@xmath47 , the lorentzian fit is repeated using as initial guesses for @xmath2 and @xmath70 , the values of @xmath2 and @xmath70 from the previous lorentzian fit , but the fixed value of the bandwidth becomes @xmath82 . with the new returned parameters from the fit , @xmath0 is again computed by eqs .",
    "( [ integral ] ) and ( [ 12 ] ) and compared to the previous one , and the cycle continues until convergence on @xmath0 is achieved .",
    "this method is claimed to be more robust against noise because it uses all of the data in the integral given in eq .",
    "( [ integral]).@xcite    all of the above methods assume a simple lorentzian - like appearance of the @xmath26 vs. frequency data .",
    "however , the translation and rotation of the data described by eq .",
    "( [ 4 ] ) can significantly alter the appearance of @xmath26 vs. frequency .",
    "in addition , other nearby resonant modes can dramatically alter the appearance of @xmath26.@xcite for these reasons , it is necessary , in general , to correct the measured @xmath12 data to remove the effects of cross - talk , delay , and nearby resonant modes .",
    "the remaining methods in the section all address these issues before attempting to calculate the @xmath0 and resonant frequency .        the inverse mapping technique , as well as all subsequent methods in this section , make use of the complex @xmath12 data and fit a circle to the plot of @xmath83 vs. @xmath84 ( fig . [ circles ] ) .",
    "the details of fits of complex @xmath12 data to a circle have been discussed before by several authors.@xcite@xmath22@xcite the data is fit to a circle using a linearized least - squares algorithm . in the circle fit ,",
    "the data is weighted by first locating the point midway between the first and last data point ; this is the reference point @xmath85 ( see fig .",
    "[ circles ] ) .",
    "next , the distance from the reference point to each data point @xmath86 is calculated .",
    "a weight is then assigned to each data point ( @xmath87 @xmath41 1 to 801 ) as : @xmath88 ^2    \\label{13}\\ ] ] this gives the points closer to the resonant frequency a heavier weight than those further away .",
    "the circle fit determines the center and radius of a circle which is a best fit to the data .",
    "we now know the center and radius of the circle which has suffered translation and rotation , as described by eq .",
    "( [ 4 ] ) . rather than un - rotating and translating the circle back into canonical position",
    ", this method uses the angular progression of the measured points around the circle ( as seen from the center ) as a function of frequency to extract the @xmath0 and resonant frequency.@xcite three data points are selected from the circle , one randomly chosen near the resonant frequency ( @xmath89 ) , and two others ( @xmath90 and @xmath91 ) randomly selected but approximately 1 bandwidth above and below the resonant frequency ( see fig . [ taberg ] ( b ) ) .",
    "figure [ taberg ] ( a ) shows the complex frequency plane with the measurement frequency axis ( @xmath92 ) and the pole of interest at a position @xmath93 - @xmath94 .",
    "the conformal mapping defined by : @xmath95 maps the imaginary frequency axis into a circle in canonical position in the @xmath12 plane ( this mapping is obtained from eq .",
    "( [ 1 ] ) by rotating the frequency plane by @xmath96 ) . under this transformation , a line passing through the pole in the complex frequency plane ( such as the line connecting the pole and @xmath97 in fig . [ circles ] ( a ) ) will map into a line of equal but opposite slope through the origin in the @xmath12 plane.@xcite in addition , because the magnitudes of the slopes are preserved , the angles between points @xmath90 and @xmath89 ( @xmath98 ) , and points @xmath89 and @xmath91 ( @xmath99 ) , in the @xmath12 plane ( fig .",
    "[ taberg ] ( b ) ) are exactly the same as those subtended from the pole in the complex frequency plane ( fig .",
    "[ taberg ] ( a)).@xcite the angles subtended by these three points , as seen from the center of the circle in the @xmath12 plane , define circles in the complex frequency plane which represent the possible locations of the resonance pole ( dashed circles in fig .",
    "[ taberg ] ( a)).@xcite@xmath22@xcite the intersection of these two circles off of the imaginary frequency axis uniquely locates the resonance pole .",
    "the resonant frequency and @xmath0 are directly calculated from the pole position in the complex frequency plane as @xmath2 and @xmath100 .",
    "this procedure is repeated many times by again choosing three data points as described above , and the results for @xmath0 and resonant frequency are averaged .",
    "we find that the fit of the complex @xmath12 data to a circle is critically important for the quality of all subsequent determinations of @xmath0 and @xmath2 .",
    "hence we experimented with different ways of weighting the data to accomplish the circle fit .",
    "the modified inverse mapping technique is identical to the previous inverse mapping , except for a difference in the weighting schemes for the fit of the data to a circle ( fig .",
    "[ circles ] ) . here",
    "the weighting on each data point , known as the standard weighting , is : @xmath101    \\label{15}\\ ] ] and is the square root of the weighting in eq .",
    "( [ 13 ] ) . other kinds of weighting will be discussed in section vi .      in the phase vs. frequency",
    "fit,@xcite the complex transmission data is first fit to a circle as discussed above for the inverse mapping technique .",
    "in addition , an estimate is made of the rotation angle of the circle .",
    "the circle is then rotated and translated so that its center lies at the origin of the @xmath12 plane ( rather than canonical position ) , and an estimation of the resonant frequency is found from the intersection of the circle with the positive real axis ( see fig .",
    "[ phase ] inset ) .",
    "the phase angle of every data point with respect to the positive real axis is then calculated .",
    "next the phase as a function of frequency ( fig . [ phase ] ) , obtained from the ratio of the two parts of eq .",
    "( [ 5 ] ) , is fit to this form using a nonlinear least - squares fit:@xcite",
    "@xmath102\\ ] ]    in this equation @xmath103 , the angle at which the resonant frequency occurs , @xmath2 , and @xmath0 are determined from the fit.@xcite a weighting is used in the fit to emphasize data near the resonant frequency and discount the noisier data far from the resonance which shows little phase variation .",
    "again we find that the quality of this fit is sensitive to the method of fitting the original @xmath12 data to a circle .",
    "as will be shown below , the main weakness of the inverse mapping and phase versus frequency methods is in the initial circle fit of the complex @xmath12 data . to analyze the frequency dependence of the data , or to bring the circle back into canonical position for further analysis , the center and rotation angle ( eq . [ 4 ] )",
    "must be known to very high precision .",
    "the snortland method makes use of internal self - consistency checks on the data to make fine adjustments to the center and rotation angle parameters , thus improving the accuracy of any subsequent determination of the resonant frequency and @xmath0 .",
    "the snortland method@xcite starts with a standard circle fit and phase vs. frequency fit ( fig .",
    "[ phase ] ) as discussed above .",
    "a self - consistency check is made on the @xmath12 data vs. frequency by making use of the variation of the stored energy in the resonator as the frequency is scanned through resonance . as the resonant frequency is approached from below , the current densities in the resonator increase . beyond the resonant frequency they decrease again .",
    "hence a sweep through the resonance is equivalent to an increase and decrease of stored energy in the cavity and power dissipated in the sample . in general",
    ", there is a slight nonlinear dependence of the sample resistance and inductance on resonator current @xmath104 .",
    "this leads to a resonant frequency and quality factor which are current - level dependent .",
    "the generalized expression for a resonator with current - dependent resonant frequency and @xmath0 is@xcite    @xmath105    where @xmath106 and @xmath107 are the resonant frequency and @xmath0 at the point of maximum current in the resonator , @xmath108 .",
    "the @xmath0 and resonant frequency are therefore determined at every frequency point on the resonance curve as@xcite    @xmath109}\\ ] ]    @xmath110/2q_{\\max } ] } \\ ] ]    if it is assumed that the response of the resonator is non - hysteretic as a function of power , then the up and down  power ramps  must give consistent values for the @xmath0 and resonant frequency at each current level . if the data is corrupted by a rotation in the @xmath12 plane , the slight nonlinear response of @xmath0 and @xmath2 with respect to field strength causes the plots of @xmath0 and @xmath2 vs. the current level to trace out hysteresis curves.@xcite by adjusting the rotation phase angle and @xmath107 parameters , one can make the two legs of the @xmath111 and @xmath112 curves coincide , thereby determining the resonant frequency and @xmath0 more precisely.@xcite    in practice , the resonant frequency is determined from a fit to the non - linear inductance as a function of resonator current @xmath104 through @xmath113 so that @xmath114 .",
    "@xmath107 is determined by making the two legs of the @xmath112 curve overlap .",
    "the resulting determination of resonant frequency and quality factor are @xmath106 and @xmath107 , respectively .",
    "the values of @xmath0 and @xmath2 obtained by each method for a group of data ( e.g. fixed power or fixed @xmath0 ) are averaged and their standard deviations are determined .",
    "these results are used to compare the methods .",
    "the accuracy of each method is determined using the generated data since , in those cases , the true values for @xmath0 and @xmath2 are known .",
    "the most accurate method is simply the one that yields an average ( @xmath115 , @xmath116)closest to the actual value ( @xmath117 , @xmath118 ) .",
    "the standard deviations ( @xmath119 , @xmath120 ) for the measured data are used as a measure of precision for the methods .",
    "the smaller the standard deviation returned , the more precise the method . to determine the most robust method over a wide dynamic range of @xmath0 and noise , both accuracy and precision are considered .",
    "hence the algorithm that is both accurate and precise over varying @xmath0 or noise is deemed the most robust .",
    "figures [ fop10 ] and [ qp10 ] show the values of @xmath2 and @xmath0 respectively , resulting from the lorentzian fit ( b ) , the modified inverse mapping technique ( e ) , and the phase vs. frequency fit ( f ) , for the @xmath3410 dbm ( snr @xmath35 108 ) fixed power run . for @xmath2 ,",
    "all three methods return values that are very close to each other .",
    "this is verified by the ratios of @xmath121 for those methods shown in table [ precision table ] , which shows the normalized ratio ( normalized to the lowest number ) of the standard deviation of @xmath2 and @xmath0 to their average ( @xmath121 , @xmath122 ) returned by each method on identical data . the difference in @xmath2 from trace to trace , seen in fig .",
    "[ fop10 ] is due entirely to the particular noise distribution on that @xmath123 trace . on the other hand ,",
    "the determinations of @xmath0 are very different for the three methods . from fig .",
    "[ qp10 ] , we see that the phase vs. frequency fit is more precise in finding @xmath0 than both the lorentzian fit and the modified inverse mapping technique ( see also table [ precision table ] ) . thus the fixed power data identifies the phase vs. frequency fit as the best .",
    "figures [ foprmp ] and [ qprmp ] show the results for @xmath2 and @xmath0 respectively , from the same methods , for the measured power - ramped data sets .",
    "the data are plotted vs. the signal - to - noise ratio ( snr ) discussed in section iii .",
    "as the snr decreases , the determination of @xmath2 becomes less precise , but as in the case of fixed power , all of the methods return similar ratios for @xmath121 as confirmed by table [ precision table ] .",
    "the determination of @xmath0 also becomes less precise as the snr decreases tending to overestimate its value for noisier data .",
    "but , from fig .",
    "[ qprmp ] , we see that while the modified inverse mapping technique and phase vs. frequency fit give systematically increasing values of @xmath0 as the snr decreases , the lorentzian fit simply jumps around the average value .",
    "this implies that for a low snr , the lorentzian fit is a more precise method .",
    "table [ precision table ] confirms this statement by showing that the lorentzian fit has the smallest ratio of @xmath122 .",
    "we thus conclude that over a wide dynamic range of snr the lorentzian fit is superior , although the phase vs. frequency fit is not significantly worse .    from figures [ foprmp ] and [ qprmp ]",
    ", we see that the @xmath2 determination does not degrade nearly as much as the @xmath0 determination as snr decreases . here , @xmath121 changes by a factor of 2 , while @xmath122 changes by a factor of 300 as snr decreases from 100 to 3 , so the precision in the determination @xmath2 is much greater than that of @xmath0 . the trend of decreasing @xmath0 as the snr increases beyond a value of about 50 in fig .",
    "[ qprmp ] is most likely due to the non - linear resistance of the superconducting walls in the cavity .",
    "an analysis of generated data power - ramps does not show a decreasing @xmath0 at high snr .",
    "the most precise methods over different fixed powers are the nonlinear least squares fit to the phase vs. frequency ( f ) and the lorentzian nonlinear least squares fit ( b ) ( table [ precision table ] ) .",
    "they consistently give the smallest ratios of their standard deviation to their average for both @xmath0 and @xmath2 compared to all other methods . at high power ( snr 350 )",
    "the phase vs. frequency fit is precise to about 3 parts in 10@xmath124 for the resonant frequency and to 3 parts in 10@xmath47 for the quality factor , when averaged over about 75 traces .",
    "when looking at the generated data with snr @xmath35 65 , the most accurate method for the determination of the resonant frequency is the phase vs. frequency fit , because it returns an average closest to the true value , or as in table [ accuracy table ] , it has the smallest ratio of the difference between the average and the known value divided by the known value ( @xmath125 , @xmath126 ) .",
    "the value returned for the resonant frequency is accurate to about 8 parts in 10@xmath127 for @xmath0 = 10@xmath4 , and 1 part in 10@xmath128 for @xmath0 = 10@xmath48 when averaged over 100 traces . for the quality factor ,",
    "the phase vs. frequency fit ( f ) is most accurate ( table [ accuracy table ] ) , with accuracy to about 1 part in 10@xmath129 for @xmath0 = 10@xmath4 , and 1 part in 10@xmath47 for @xmath0 = 10@xmath48 when averaged over 100 traces .",
    "the method most robust in noise is the lorentzian fit ( see the power ramp columns of both tables ) .",
    "it provided values for @xmath2 and @xmath0 that were the most precise and accurate as the signal - to - noise ratio decreased ( particularly for snr 10 ) . over several decades of @xmath0 , the most robust method for the determination of @xmath2",
    "is the phase vs. frequency fit , which is precise to about 1 part in 10@xmath48 when @xmath0 = 10@xmath46 , and to about 1 part in 10@xmath127 when @xmath0 = 10@xmath48 , averaged over 100 traces with snr @xmath35 65 . for the determination of @xmath0 ,",
    "the phase vs. frequency ( f ) is also the most robust , providing precision to 2 parts in 10@xmath4 when @xmath0 = 10@xmath46 to 10@xmath48 averaged over 100 traces .",
    "the first three methods discussed above ( 3db , lorentzian fit , and rca method ) can be improved by correcting the data for rotation and translation in the complex @xmath12 plane . all of the remaining methods can be improved by carefully examining the validity of the circle fit .",
    "we have observed that by modifying the weighting we can improve the fit to the circle for noisy data , and thereby improve the determination of @xmath0 and @xmath2 .",
    "for instance , fig .",
    "[ weighting ] shows that the standard weighting ( the weighting from the modified inverse mapping technique ) systematically overestimates the radius of the circle for noisy data .",
    "below we discuss several ways to improve these fits .    by introducing a radial weighting",
    ", we can improve the circle fit substantially ( an example is shown in fig .",
    "[ weighting ] ) . for the radial weighting , we first do the standard weighting to extract an estimate for the center of the circle @xmath51 ,",
    "which is not strongly corrupted by noise . the radial weighting on each point ( @xmath53 1 to 801 )",
    "is then defined as : @xmath130 which reduces the influence of noisy data points well outside the circle .",
    "figure [ radwsnr ] shows a plot of the calculated radius versus the signal - to - noise ratio for the generated power - ramped data set .",
    "the figure shows plots of the calculated radius using four different weightings : @xmath131 ( eq .",
    "( [ 15 ] ) ) , @xmath132 ( eq . (",
    "[ 17 ] ) ) , @xmath133 , and @xmath134 . from this plot , it is clear that above a snr of about 30 all of the weightings give very similar radius values .",
    "however , below that value we see that the radius from the @xmath133 weighting agrees best with the true radius of 0.2 .",
    "therefore , by improving the circle fit with a similar weighting scheme , we hope to extract even higher precision and better accuracy from these methods at lower signal - to - noise ratio .",
    "in addition to errors in the fit radius of the circle at low snr , there can also be errors in the fit center of the circle .",
    "figure [ centerror ] shows the normalized error , @xmath135 : @xmath136 in the calculation of the center of the circle from weightings : @xmath131 , @xmath132 , @xmath133 , and @xmath134 , vs. the snr in log scaling . here",
    "@xmath137 is the true center of the circle and @xmath138 is the calculated center from the circle fit . from fig .",
    "[ centerror ] , we see that the calculation of the center of the circle is accurate to within 1% for snr @xmath35 20 and above using any weighting .",
    "however , below snr = 10 , all of the weightings give degraded fits .",
    "the inset ( b ) of fig .",
    "[ centerror ] shows the angle @xmath139 vs. snr , where @xmath139 is the angle between the vector connecting the true and calculated centers , and the vector connecting the true center to the position of the resonant frequency . from this figure",
    "we see that the angle between these vectors approaches @xmath7 as snr decreases , which means that the fit center migrates in the direction away from the resonant frequency as the data becomes noisy .",
    "this indicates that the points on the side of the circle opposite from the resonant frequency have a combined weight larger than those points around the resonant frequency , and thus the center is calculated closer to those points .    for data with snr greater that about 10 , all weightings give similar results for the circle fits . for data with snr",
    "less than 10 , the best circle fit would make an estimate of the radius of the circle by using the square root radial weighting , and an estimate of the center by weighting data near the resonant frequency more heavily .",
    "a further refinement of the inverse mapping method would be to fit the data with an arbitrary number of poles and zeroes to take account of multiple resonances in the frequency spectrum.@xcite    the snortland method was originally developed to analyze non - linear resonances.@xcite our use of it for linear low - power resonances was preliminary , and the results probably do not reflect its ultimate performance .",
    "further development of this method on linear resonances has the potential to produce results superior to those obtained with the phase vs. frequency method at high snr .",
    "we find that the phase versus frequency fit and the lorentzian nonlinear least squares fit are the most reliable procedures for estimating @xmath2 and @xmath0 from complex transmission data .",
    "the lorentzian fit of @xmath140 vs. frequency is surprisingly precise , but suffers from poor accuracy relative to vector methods , except for very noisy data .",
    "however , a major advantage of vector data is that it allows one to perform corrections to remove cross talk , delay , and nearby resonances , thus significantly improving the quality of subsequent fits . for the fixed - power measured data sets , the phase vs. frequency fit has the highest precision and accuracy in the determination of @xmath2 and @xmath0 making it the best method overall .",
    "all of these methods are good for snr greater than about 10 . below this value ,",
    "all methods of determining @xmath0 and resonant frequency from complex transmission coefficient data degrade dramatically . concerning robustness , the phase vs. frequency fit does well for a dynamic range of @xmath0 , while the lorentzian fit does well in the power - ramp ( snr = 1 to 2000 ) .",
    "we also find that significant improvements can be made to the determination of resonant frequency and @xmath0 in noisy situations when careful attention is paid to the circle fitting procedure of the complex @xmath12 data .",
    "further development of the inverse mapping and snortland methods can greatly improve the accuracy and precision of resonant frequency and q determination in realistic measurement situations .",
    "we thank a. schwartz and b. j. feenstra for their critical reading of the manuscript , and h. j. snortland and r. c. taber for many enlightening discussions .",
    "this work is supported by the national science foundation through grant number dmr-9624021 , and the maryland center for superconductivity research .",
    ".measurements of relative precision of the seven methods used to determine @xmath2 and @xmath0 from complex transmission data . tabulated",
    "are ratios of the standard deviation to the average values for both resonant frequency ( @xmath141 ) and quality factor ( @xmath142 ) normalized to the best value ( given in parentheses ) , for snr @xmath35 49 , 368 , and ramped from 5 to 168 .",
    "all entries are based on measured data .",
    "[ precision table ] [ cols= \" < , < , < , < , < , < , < \" , ]     c. g. montgomery , technique of microwave measurements , mit rad .",
    "series , vol .",
    "11 ( mcgraw - hill , inc . 1947 ) .",
    "l. malter , and g. r. brewer , j. appl .",
    "* 20 * , 918 ( 1949 ) .",
    "e. l. ginzton , _ microwave measurements _ , ( mcgraw - hill inc . 1957 )",
    ". m. sucher , and j. fox , _ handbook of microwave measurements _ , vol .",
    "ii , 3rd ed .",
    "( john wiley & sons , inc . 1963 ) , chap",
    "d. kajfez , and e. j. hwan , ieee trans .",
    "microwave theory tech .",
    ", * mtt-32 * , 666 ( 1984 ) .",
    "e. sun , and s. chao , ieee trans .",
    "microwave theory tech .",
    "* 43 * , 1983 ( 1995 ) .",
    "m. b. barmatz , nasa tech brief , * 19 * , no .",
    "12 , item # 16 , ( dec . 1995 ) .",
    "h. padamsee , j. knobloch , and t. hays , _ rf superconductivity for accelerators _ , ( john wiley & sons , inc .",
    "a. f. harvey , _ microwave engineering _ , ( academic press 1963 ) .",
    "s. r. stein , and j. p. turneaure , electronics letters , * 8 * , 321 ( 1972 ) .",
    "o. klein , s. donovan , m. dressel , and g. grner , international journal of infrared and millimeter waves , * 14 * , 2423 ( 1993);s .",
    "donovan , o. klein , m. dressel , k. holczer , and g. grner , international journal of infrared and millimeter waves , * 14 * , 2459 ( 1993);m .",
    "dressel , o. klein , s. donovan , and g. grner , international journal of infrared and millimeter waves , * 14 * , 2489 ( 1993 ) a. n. luiten , a. g. mann , and d. g. blair , meas .",
    "technol . ,",
    "* 7 * , 949 ( 1996 ) . j. e. aitken , proc .",
    "iee , * 123 * , 855 ( 1976 ) .",
    "j. r. ashley , and f. m. palka , the microwave journal , 35 ( june 1971 ) .",
    "k. watanabe , and i. takao , rev .",
    "instrum . ,",
    "* 44 * , 1625 ( 1973 ) .",
    "v. subramanian , and j. sobhanadri , rev .",
    "instrum . ,",
    "* 65 * , 453 ( 1994 ) .",
    "m. c. sanchez , e. martin , j. m. zamarro , iee proceedings , * 136 * , 147 ( 1989 ) .",
    "e. k. moser , and k. naishadham , ieee trans .",
    "superconductivity , * 7 * , 2018 ( 1997 ) .",
    "z. ma , ph .",
    "d. thesis , ( ginzton labs report no .",
    "5298 ) , stanford university , ( 1995 ) .",
    "k. leong , j. mazierska , and j. krupka , 1997 ieee mtt - s proceedings .",
    "j. snortland , ph .",
    "d. thesis , ( ginzton labs report no",
    ". 5552 ) , stanford university , ( 1997 ) .",
    "see also http://loki.stanford.edu/vger.html .",
    "we used vger version 2.37 for the analysis performed in this paper .",
    "j. mao , ph .",
    "d. thesis , university of maryland , ( 1995 ) .",
    "s. sridhar , and w. l. kennedy , rev .",
    "instrum . ,",
    "* 59 * , 531 ( 1988 ) . w. h. press , b. p. flannery , s. a. teukolsky , w. t. vetterling , _ numerical recipes _ , ( cambridge university press 1989 ) , pp .",
    "105 , 202 - 203 , 523 - 528 .",
    "p. r. bevington , _ data reduction and error analysis for the physical sciences _ , ( mcgraw - hill , inc .",
    "1969 ) , pp .",
    "237 - 240 .",
    "t. miura , t. takahashi , and m. kobayashi , ieice trans . electron .",
    ", * e77-c * , 900 ( 1994 ) .",
    "f. gao , m. v. klein , j. kruse , and m. feng , ieee trans .",
    "microwave theory tech .",
    ", * 44 * , 944 ( 1996 ) .",
    "r. c. taber , hewlett - packard laboratories , private communication .",
    "r. v. churchill , and j. w. brown , _ complex variables and applications _ , 5th ed .",
    "( mcgraw - hill , inc . , new york )",
    "the mapping defined by eq .",
    "( [ 14 ] ) maps lines of slope @xmath143 through the pole in the frequency plane to lines of slope @xmath144 through the origin in the @xmath12 plane .",
    "note the mapping defined by eq ( [ 14 ] ) is not conformal at the pole because it is not analytic there , however it is an isogonal mapping at that point .",
    "see reference 29 .",
    "m. h. richardson and d. l. formenti , proc .",
    "international modal analysis conference , 167 ( 1982 ) .",
    "the factor of 2 in front of the @xmath145 comes from the difference in angle subtended as seen from the origin vs. the center of the circle for a circle in canonical position in the @xmath12 plane ( fig ."
  ],
  "abstract_text": [
    "<S> precise microwave measurements of sample conductivity , dielectric , and magnetic properties are routinely performed with cavity perturbation measurements . </S>",
    "<S> these methods require the accurate determination of quality factor and resonant frequency of microwave resonators . </S>",
    "<S> seven different methods to determine the resonant frequency and quality factor from complex transmission coefficient data are discussed and compared to find which is most accurate and precise when tested using identical data . </S>",
    "<S> we find that the nonlinear least - squares fit to the phase vs. frequency is the most accurate and precise when the signal - to - noise ratio is greater than 65 . </S>",
    "<S> for noisier data , the nonlinear least squares fit to a lorentzian curve is more accurate and precise . </S>",
    "<S> the results are general and can be applied to the analysis of many kinds of resonant phenomena . </S>"
  ]
}