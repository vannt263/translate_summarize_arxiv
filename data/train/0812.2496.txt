{
  "article_text": [
    "high precision doppler surveys provide the best estimates to date of the frequency of gas giant planets around solar - type stars in the sun s neighborhood of the galaxy .",
    "cumming et al .",
    "( 2008 ) analyzed 8 years of hires spectrometer data from the keck planet search effort , begun in 1996 , taking into account the detection threshold for each star .",
    "cumming et al .",
    "( 2008 ) estimated that 17% to 20% of solar - type stars have planets with masses of 0.3 @xmath1 ( i.e. , saturn - mass ) and above , orbiting within 20 au . considering that this estimate is based on an extrapolation to longer period orbits from detections of planets with orbital periods of 2000 days or less ,",
    "this frequency estimate may well be a lower bound , if the frequency of gas giant planets continues to increase with orbital period : the frequency of gas giant planets with orbital periods less than 300 days is only 1/5 that of planets with orbital periods between 300 days and 2000 days .",
    "gas giant planets are thought to form primarily with orbital periods greater than 2000 days , so there may well be an as yet unseen extensive population of gas giant planets with orbital periods greater than 2000 days that have not suffered inward migration .",
    "such planets would have formed in regions with relatively short - lived outer disks ( e.g. , orion , carina ) , while planets formed in regions with relatively long - lived outer disks ( e.g. , taurus , ophiuchus ) would have migrated inward ( boss 2005 ; eisner et al .",
    "2008 ) .    given this high frequency of gas giant planets , it is clear that there must be at least one efficient mechanism for gas giant planet formation .",
    "two such mechanisms have been proposed , core accretion ( e.g. , mizuno 1980 ) and disk instability ( e.g. , boss 1997 ) , and both appear to be necessary to explain the entire range of planets detected to date .",
    "core accretion is the preferred mechanism for giant planets with very large inferred core masses , such as hd 149026b , which appears to have a core mass of @xmath2 70 @xmath3 and a gaseous envelope of @xmath2 40 @xmath3 ( sato et al .",
    "on the other hand , disk instability would seem to be the preferred mechanism for forming gas giants in very low metallicity systems , such as the m4 pulsar planet , where the metallicity [ fe / h ] = -1.5 ( sigurdsson et al . 2003 ) .",
    "disk instability is also able to form gas giants around m dwarf stars ( boss 2006b ) , unlike core accretion ( laughlin et al .",
    "2004 ; ida & lin 2005 ) .",
    "both doppler and microlensing searches have detected gas giants in orbit around m dwarfs , most recently a 3 @xmath1 planet in the ogle-2005-blh-071l microlensing event ( dong et al .",
    "microlensing has detected a jupiter / saturn analog system ( gaudi et al .",
    "2008 ) around an m dwarf that is consistent with photoevaporative gas loss from an outer gas giant formed by disk instability in a region of massive star formation ( boss 2006b , c ) .",
    "doppler searches have detected numerous hot super - earths , accompanied by outer gas giant planets ( e.g. , hd 181433b and hd 47186b [ bouchy et al .",
    "2008 ] and hd 40307bcd [ mayor et al . 2008 ] ) , a situation similar to that of our solar system and consistent with the `` best of both worlds '' scenario ( boss 1997 ) , where rocky planets form by collisional accumulation inside the orbits of gas giants formed by disk instability .    in spite of this observational evidence",
    ", theoretical work on disk instability is split between those whose studies are either supportive ( e.g. , boss 1997 , 2000 , 2001 , 2005 , 2006a , b , c , 2007 , 2008 ; mayer et al .",
    "2002 , 2004 , 2007 ) or dismissive ( e.g. , pickett et al . 2000 ; cai et al . 2006 , 2008 ; boley et al . 2006 , 2007a , b ; rafikov 2005 , 2007 ; stamatellos & whitworth 2008 ) of disk instability being able to form giant planets .",
    "this divergence appears to be the result of a variety of modeling issues ( nelson 2006 ; boss 2007 ) , such as numerical spatial resolution , gravitational potential solver accuracy , artificial viscosity , stellar irradiation , radiative transfer , and spurious numerical heating .",
    "a combination of joint code test cases ( e.g. , boss 2007 ) and rigorous testing is needed to try to resolve these differences .",
    "boley et al . ( 2006 , 2007b ) presented the results of a series of tests of their radiative hydrodynamics code on a `` toy problem '' ( a plane - parallel grey atmosphere ) with sufficient assumptions to permit an analytical solution for the vertical temperature and radiative flux profiles .",
    "this toy problem is well - suited to their cylindrical coordinate code , as their vertical cylindrical coordinate can be used to simulate a plane - parallel atmosphere .",
    "however , the boley et al . ( 2006 , 2007b ) test cases are unsuitable for a code based on spherical coordinates ( boss 2008 ) , as is the situation for the boss & myhill ( 1992 ) code used in boss ( 1997 , 2000 , 2001 , 2005 , 2006a , b , c , 2007 , 2008 ) .",
    "boley et al . ( 2006 ) `` ... challenge all researchers who publish radiative hydrodynamics simulations to perform similar tests or to develop tests of their own and publish the results . ''",
    "this purpose of this paper is to address this challenge by the latter route , as the former route is precluded .",
    "two analytical solutions for radiative transfer in spherical coordinates are first derived and then used to test extensively the spherically symmetric ( one dimensional , @xmath4 ) and azimuthally symmetric ( two dimensional , @xmath4 , @xmath0 ) versions of the boss & myhill ( 1992 ) three dimensional code ( @xmath4 , @xmath0 , @xmath5 ) , the same code that has been used in all of the author s radiative hydrodynamics models of disk instability .",
    "the new test calculations were performed with either the spherically symmetric or axisymmetric versions of the code that solves the three dimensional equations of hydrodynamics and radiative transfer , as well as the poisson equation for the gravitational potential .",
    "this code has been used in all of the author s previous studies of disk instability , and is second - order - accurate in both space and time ( boss & myhill 1992 ) .    for the spherically symmetric tests ( r models ) ,",
    "the equations are solved on a spherical coordinate grid with @xmath6 . the radial grid ( @xmath4 ) is uniformly spaced with @xmath7 au between 0 and 20 au .",
    "the gravitational potential of the spherical cloud is obtained by the tridiagonal matrix inversion technique .",
    "the boundary conditions are chosen at both 0 and 20 au to absorb radial velocity perturbations , though we shall see that in the new test cases , the velocities are assumed to be zero , so the hydrodynamics boundary conditions are irrelevant for testing the radiative transfer routines .",
    "for the axisymmetric tests ( t models ) , the equations are solved on a spherical coordinate grid with @xmath6 and @xmath8 for @xmath9 .",
    "symmetry through the midplane is assumed for @xmath10 . the radial grid ( @xmath4 ) is uniformly spaced with @xmath11 au between 4 and 20 au , the same configuration as is typically assumed in the boss disk instability models .",
    "the poisson equation for the disk s gravitational potential is solved by a spherical harmonic expansion ( @xmath12 ) including terms up to @xmath13 .",
    "because of the axisymmetric assumption , terms with @xmath14 are dropped , reducing the solution to an expansion in legendre polynomials .",
    "the boundary conditions are chosen at both 4 and 20 au to absorb radial velocity perturbations , though as noted above , this is irrelevant for the radiative transfer .",
    "boley et al . ( 2006 , 2007b ) developed test problems based on the approach taken by hubeny ( 1990 ) in deriving simplified analytical models for the vertical structure of accretion disks .",
    "hubeny ( 1990 ) studied one dimensional , plane - parallel atmospheres in hydrostatic equilibrium ( i.e. , at rest ) , with grey opacities and eddington approximation radiative transfer , while neglecting convection and external radiation .",
    "boley et al . ( 2007b ) made similar assumptions for testing their flux - limited diffusion approximation numerical models , while also assuming constant vertical gravity , constant opacity , and constant density .",
    "we will make similar approximations here .",
    "all of the author s disk instability models since boss ( 2001 ) have employed radiative transfer in the diffusion approximation , through the solution of the equation determining the evolution of the specific internal energy @xmath15",
    "@xmath16,\\ ] ]    where @xmath17 is the total gas and dust mass density , @xmath18 is time , @xmath19 is the velocity of the gas and dust ( considered to be a single fluid ) , @xmath20 is the gas pressure , @xmath21 is the rosseland mean opacity , @xmath22 is the stefan - boltzmann constant , and @xmath23 is the gas and dust temperature . the energy equation is solved explicitly in conservation law form , as are the other hydrodynamic equations . boss ( 2008 ) tested a flux - limiter for the diffusion approximation but found little difference between disk instability models with and without the flux - limiter .",
    "the author s diffusion approximation code is derived from a code that handles radiation transfer in the eddington approximation ( boss 1984 ; boss & myhill 1992 ) . in the eddington approximation code ,",
    "the energy equation is    @xmath24    where @xmath25 is the rate of change of internal energy due to radiative transfer .",
    "the definition of @xmath25 depends on the optical depth as    @xmath26    @xmath27    where @xmath28 is the mean intensity , @xmath29 is the planck function ( @xmath30 ) , @xmath31 is the optical depth , and @xmath32 is a surface value ( @xmath33 ) . the energy equation is solved along with the mean intensity equation for @xmath28 , given by    @xmath34    in the diffusion approximation , @xmath35 . hence in both the eddington and diffusion approximations ,",
    "@xmath25 is effectively given by    @xmath36    in optically thick regions .    in terms of the net flux vector @xmath37 , @xmath25 is given by    @xmath38    in optically thick regions ( boss 1984 ) , and so    @xmath39    because @xmath40 , where @xmath41 is the radiative flux , one also finds    @xmath42    we seek a solution that decouples the radiative transfer from the hydrodynamics . as in hubeny ( 1990 ) , we assume that the test cloud or disk is at rest ( @xmath43 ) . with this assumption ,",
    "the energy equation becomes    @xmath44    where @xmath45 is a heating term constant in time . in steady state ,",
    "then , the heating term must equal @xmath46 , so that    @xmath47      assuming the spherically symmetric test cloud has constant , uniform density @xmath17 and constant , uniform opacity @xmath21 , then    @xmath48    the following radial temperature distribution is consistent with @xmath45 constant in both space ( inside the disk ) and time    @xmath49    where @xmath50 and @xmath51 are arbitrary constants . with this solution for @xmath52",
    ", one finds that    @xmath53    in optically thick regions , the radiative flux @xmath41 is    @xmath54    given the above temperature profile , @xmath41 is equivalent to a scalar field @xmath55 in the radial direction that is given by    @xmath56    in optically thick regions .",
    "the radiative flux in optically thick regions is calculated in the numerical code using    @xmath42    the radius @xmath51 is defined to be the edge of the optically thick region , where @xmath57 , and outside of which @xmath58 , i.e. , the cloud is assumed to be embedded in a thermal bath at a temperature of @xmath59 k , as is commonly assumed in the boss disk instability models . the envelope density ( @xmath60 )",
    "is taken to be a factor of @xmath61 times smaller than in the optically thick region ( @xmath62 ) , ensuring its optical thinness .",
    "the heating term @xmath63 for @xmath60 , so that the radiative flux in the optically thin region must fall off with distance as @xmath64 , i.e. ,    @xmath65    for @xmath60 .",
    "because the numerical code uses @xmath25 rather than @xmath41 to calculate radiative transfer , there is no convenient expression for @xmath41 in optically thin regions that can be compared to the analytical value above . in practice",
    ", the boss disk instability models assume the presence of a thermal bath in the low optical depth regions , so the inability to compare the numerical radiative flux with the analytical value in low optical depth regions is not a problem .      for a disk where the height is proportional to the radial distance and with constant , uniform density @xmath17 and constant , uniform opacity @xmath21 , then    @xmath66    the following vertical ( i.e. , @xmath0 ) temperature distribution is consistent with @xmath45 constant in time    @xmath67    for @xmath68 , where @xmath50 and @xmath69 are arbitrary constants .",
    "with this solution for @xmath70 , one finds that @xmath45 varies inside the disk as    @xmath71    for @xmath68 , with @xmath63 for @xmath72 .",
    "note that @xmath73 only for @xmath74 , restricting the disk thickness about the midplane to @xmath75 .",
    "note that @xmath76 corresponds to the @xmath77 axis , the rotational and symmetry axis , whereas @xmath78 corresponds to the equatorial plane ( midplane ) of the disk .",
    "the calculations all assume symmetry above and below the midplane , so that only the time evolution of the upper half of the disk is calculated .    in optically thick regions ,",
    "the radiative flux @xmath41 is equivalent to a scalar field @xmath79 in the vertical direction ( @xmath80 ) that is given by    @xmath81    with the sign chosen to correspond to the @xmath0 coordinate , which increases _ downward _ in the disk .",
    "the radiative flux in optically thick regions is calculated in the numerical code using    @xmath82    the angle @xmath69 is defined to be the upper edge of the optically thick disk , outside of which @xmath83 , i.e. , the disk is once again assumed to be embedded in a thermal bath at a temperature of @xmath84 k. the envelope density ( @xmath72 ) is taken to be a factor of @xmath61 times smaller than in the optically thick region ( @xmath68 ) .",
    "we now present the results of two set of models that test the boss code against these two analytical solutions .",
    "the codes used are identical to the radiative hydrodynamics codes used in the boss disk instability models , with the exceptions being that in order to match the assumptions of the analytical solutions , the codes are restricted to either spherical symmetry or axisymmetry , the density ( @xmath85 g @xmath86 ) and opacity ( @xmath87 @xmath88 g@xmath89 ) are held constant , and the velocities are all set equal to zero , so that there is no advection of energy , only heating by the @xmath45 term and transport by the radiative transfer term @xmath25 .",
    "all other aspects of the boss codes are retained , e.g. , the specific internal energy and pressure subroutines and the subroutine that updates the temperature based on the specific internal energy .",
    "model r+50 was calculated with diffusion approximation radiative transfer .",
    "this model was started with the analytical solution for the initial temperature profile , but with a 50% temperature perturbation between 4 and 5 au , as shown in figure 1 .",
    "figures 1 , 3 , and 5 show the resulting time evolution of the numerical radial temperature profile for model r+50 , while figures 2 , 4 , and 6 show the corresponding evolution of the radiative flux , compared in each case to the steady state , analytical profiles ( solid lines ) .",
    "these figures show the expected behavior in response to the initial temperature perturbation : extra radiative energy flows both inwards and outwards ( figure 2 ) as the cloud attempts to dispel the thermal perturbation .",
    "the perturbation extends across the entire radial extent of the cloud ( figure 3 ) , while the radiative flux begins to return to the steady state value ( figure 4 ) . within a few myr",
    ", the steady state solution is attained once again , and the code holds this solution indefinitely in time ( figures 5 and 6 ) .",
    "the numerical temperature profile at 14 myr ( figure 5 ) is very close to the steady state value , but slightly higher in the optically thick regions inside @xmath90 10 au . the deviations from steady state are less than 1% .",
    "similarly , the radiative flux relaxes to very close to the analytical values , except at the center and just inside @xmath90 10 au , where a few cells drop noticeably below the analytical solution . to the extent that these few numerical values differ from the analytical values , they err on the side of higher temperatures and lower radiative fluxes , i.e.",
    ", they err on the side of discouraging cooling of the optically thick regions .",
    "models were also calculated with eddington approximation radiative transfer and flux - limited diffusion approximation radiative transfer ( boss 2008 ) , testing their ability to maintain the analytical solution .",
    "the results for these models were identical to those for models with the diffusion approximation , in the latter case because the flux - limiter was never triggered by the radiative fluxes in the optically thick regions . in all cases , the code maintains the steady state solution to the same degree that is exhibited by model r+50 in figures 5 and 6 .",
    "models were also calculated for a cloud with the opacity lowered by a factor of 100 , i.e. , @xmath91 @xmath88 g@xmath89 . as a result ,",
    "the central optical depth dropped from @xmath92 in model r+50 to @xmath93 .",
    "the lower optical depth model was calculated with the eddington approximation code , and it maintained a temperature profile that was only slightly higher than the analytical profile throughout most of disk , again erring on the side of a slightly hotter disk .",
    "models were also calculated with 1% and 10% perturbations to the temperature , which behaved similarly to model r+50 except for their relaxation to the steady state value occurring faster in time , as would be expected .",
    "a model was also calculated with a negative temperature perturbation , i.e. , a cloud with the temperature reduced by 50% from 4 to 5 au .",
    "this cloud also relaxed back to the steady state solution within a few myr , as in model r+50 .",
    "interestingly , in this model the relaxed solution was again slightly hotter than the steady state solution ( by less than 1% ) , showing that the code relaxes to this solution independently of being approached from hotter or cooler temperatures than the steady state solution .",
    "this result implies that the radiative transfer routines , while accurate to a high degree , do result in a slight overestimate of cloud temperatures and an underestimate of the radiative fluxes , which errs on the side of discouraging disk instability s ability to produce self - gravitating clumps .",
    "model t+50 was also calculated with diffusion approximation radiative transfer ( eddington approximation radiative transfer becomes punitively slow in multiple dimensions , because of the need to iterate on the solution of the mean intensity equation ) .",
    "model t+50 was started with the analytical solution for the initial temperature profile for a disk with @xmath94 degrees ( 6.9 degrees above the midplane ) , but with a 50% temperature perturbation between the midplane and an angle of 0.7 degrees above the midplane , as shown in figure 7 .",
    "[ note that because of the small variation with vertical height , the vertical temperature profile appears to be almost constant when plotted on the scale of the applied temperature perturbation . ]",
    "figures 7 , 9 , and 11 show the resulting time evolution of the numerical vertical temperature profile for model t+50 , while figures 8 , 10 , and 12 show the corresponding evolution of the radiative flux , compared in each case to the steady state , analytical profiles ( solid lines ) .",
    "once again , these figures show the expected behavior in response to the initial temperature perturbation : the upward radiative flux increases drastically in order to cool the midplane ( figure 8) , raising the temperature of the entire disk ( figure 9 ) .",
    "the radiative flux then begins to return to the steady state values ( figure 10 ) , and by 1.9 myr the disk has relaxed back to the analytical solution ( figure 11 and 12 ) .",
    "the exception is a single grid point at the surface of the disk , where the flux is slightly lower than the steady state value ( figure 12 ) , again implying an error on the side of slightly lower radiative cooling .    by way of comparison , the boley et al .",
    "( 2006 ) code also errs on the side of vertical disk temperatures being hotter than in the analytical solution ( their figure 17 ) , though the differences are significantly larger than occur in the present models .",
    "the boley et al .",
    "( 2007b ) code , however , does a better job of maintaining the analytical solutions .    a model like t+50",
    "was also run starting with a 10% initial temperature perturbation .",
    "again , the model relaxed to the analytical solutions as shown in figures 11 and 12 , only faster .",
    "figures 7 through 12 all depict the response of the disk at a radial distance of 7.87 au , as that is the typical distance where clumps form in the boss disk instability models .",
    "the behavior of the disk relaxation process at other radial distances is identical to that at 7.87 au , except that it occurs faster at smaller radii and slower at larger radii , again as would be expected , given the larger vertical optical depths at greater radii , as the disk thickness increases proportionately .",
    "the primary motivation for this paper was to answer the challenge issued by boley et al .",
    "( 2006 ) for other workers with radiative hydrodynamics codes `` ... to develop tests of their own and publish the results . ''",
    "the new test results show that the boss & myhill ( 1992 ) radiative hydrodynamics code does a superb job of relaxing to and maintaining the analytical solutions for a spherical cloud or an axisymmetric disk derived here .",
    "this excellent performance is independent of whether the eddington approximation , diffusion approximation , or flux - limited diffusion approximation is employed for the cloud , as well as of the optical depth assumed . considering that typical disk instability calculations with the diffusion approximation last for only @xmath95 yr",
    ", the fact that these models show that the radiative transfer scheme is highly accurate over time scales of at least @xmath96 yr is reassuring for the mechanism of giant planet formation by disk instability .    these models presented here test only the radiative transfer routines and other thermodynamical aspects of the boss codes , not the coupling between these processes and the hydrodynamics that occurs in full disk instability models . ideally , one would test the full radiative hydrodynamics codes against analytical solutions . in the absence of such solutions",
    ", one can test the codes with respect to their ability to represent convective motions , which do involve a coupling of hydrodynamics and thermodynamics . boss ( 2004 ) analyzed in detail the convective stability of his disk instability models , and found a good agreement between where transient , convective - like upwellings and downwellings occurred and where the schwarzschild criterion for convection was met .",
    "boley et al . ( 2007b ) presented the results of several tests for convection in their codes , finding that convection occurred when it should have and did not occur when it should not have .",
    "convection and convective - like motions thus appear to be appropriately modeled by both the boss and boley et al",
    ". codes .",
    "boss & myhill ( 1992 ) described a variety of other tests to which the code has been subjected , including the standard nonisothermal test case for protostellar collapse ( tested on two different codes by myhill & boss 1993 ) , whose results have since been confirmed by whitehouse & bate ( 2006 ) .",
    "further tests of the boss & myhill ( 1992 ) code have been presented as follows : spatial resolution ( boss 2000 , 2005 ) ; gravitational potential solver ( boss 2000 , 2001 , 2005 ) , artificial viscosity ( boss 2006a ) ; and radiative transfer ( boss 2001 , 2007 , 2008 ) . given the ongoing theoretical debate over the viability of disk instability for giant planet formation , it will continue to be important for other workers to conduct their own tests of these key numerical issues .",
    "the @xmath4 analytical solution was derived while i was a lecturer at the winter school on exoplanets at the theoretical institute for advanced research in astrophysics ( tiara ) of the national tsing hua university , in hsinchu , taiwan .",
    "i thank the acting director of tiara , ronald taam , for making possible my visit to tiara .",
    "the @xmath0 analytical solution was derived in part while i was a visitor at the royal observatory , edinburgh and at st andrews university in scotland .",
    "i thank ken rice and ian bonnell for making those visits possible , and the referee for prompting me to investigate this second test case as well as for other good advice .",
    "i also thank sandy keiser for computer systems support at dtm .",
    "this research was supported in part by nasa planetary geology and geophysics grant nnx07ap46 g , nasa origins of solar systems grant nng05gi10 g , and is contributed in part to nasa astrobiology institute grant ncc2 - 1056 ."
  ],
  "abstract_text": [
    "<S> the disk instability mechanism for giant planet formation is based on the formation of clumps in a marginally - gravitationally unstable protoplanetary disk , which must lose thermal energy through a combination of convection and radiative cooling if they are to survive and contract to become giant protoplanets . </S>",
    "<S> while there is good observational support for forming at least some giant planets by disk instability , the mechanism has become theoretically contentious , with different three dimensional radiative hydrodynamics codes often yielding different results . </S>",
    "<S> rigorous code testing is required to make further progress . here </S>",
    "<S> we present two new analytical solutions for radiative transfer in spherical coordinates , suitable for testing the code employed in all of the boss disk instability calculations . </S>",
    "<S> the testing shows that the boss code radiative transfer routines do an excellent job of relaxing to and maintaining the analytical results for the radial temperature and radiative flux profiles for a spherical cloud with high or moderate optical depths , including the transition from optically thick to optically thin regions . </S>",
    "<S> these radial test results are independent of whether the eddington approximation , diffusion approximation , or flux - limited diffusion approximation routines are employed . </S>",
    "<S> the boss code does an equally excellent job of relaxing to and maintaining the analytical results for the vertical ( @xmath0 ) temperature and radiative flux profiles for a disk with a height proportional to the radial distance . </S>",
    "<S> these tests strongly support the disk instability mechanism for forming giant planets . </S>"
  ]
}