{
  "article_text": [
    "in many applications one needs to integrate exact expressions involving several unspecified functions of multiple independent variables .",
    "the  homotopy operator \" presented in this paper performs that task .",
    "indeed , we give a formula based on a homotopy that integrates one - dimensional ( 1d ) expressions , or inverts a total divergence in two dimensions ( 2d ) or three - dimensions ( 3d ) .",
    "the formulas are derived using a principle of the calculus of variations and are written in the language of standard calculus .",
    "the concept of homotopy , contributed to poincar , is certainly familiar to differential geometers and algebraic topologists @xcite .",
    "briefly , a homotopy is a continuous map , @xmath0 : @xmath1 \\longrightarrow y$ ] between two functions @xmath2 and @xmath3 ( both are maps from a space @xmath4 to a space @xmath5 such that @xmath6 and @xmath7 for example , @xmath8 is a homotopy .",
    "if @xmath9 then @xmath10 expresses a scaling of @xmath2 with a parameter @xmath11 the homotopy operator used in this paper is more elaborate for it integrates an expression with respect to an auxiliary variable @xmath12 from @xmath13 to @xmath14 .",
    "homotopy operators presumably first appeared in the inverse problem of the calculus of variations in works by volterra @xcite .",
    "they also appear in the proof of the converse of the poincar lemma , which states that closed differential @xmath15-forms are exact @xcite , but only on domains with certain topological assumptions such as a star - shaped domain @xcite . once the domain is appropriately restricted , the proof of the converse of poincar s lemma requires the construction of a homotopy operator .",
    "more generally , the construction of suitable homotopy operators is the key to exactness proofs for many complexes such as the de rham complex and the bi - variational complex @xcite .",
    "one method to investigate the complete integrability @xcite of a system of partial differential equations ( pdes ) is to determine whether the system has infinitely many conservation laws . while developing a method for computing conservation laws of nonlinear pdes in @xmath16 dimensions @xcite , the authors needed a technique to symbolically integrate expressions involving unspecified functions .",
    "_ mathematica _ s integrate function often failed to integrate such integrands , in particular , when transcendental functions were present .",
    "the computation of conservation laws of nonlinear pdes in multiple space variables , requires a tool to invert total divergences @xcite . the homotopy operator used in the proof of the exactness of the ( bi-)variational complex @xcite can do the required integrations .",
    "the homotopy operator in @xcite has since been translated into the language of standard calculus and written into a more efficient algorithmic form @xcite .",
    "although the homotopy operator for one variable does not appear in work by kruskal _",
    "et al_.  @xcite , it takes only one extra step to derive it .",
    "taking that step , it also became clear how to generalize the formula to cover multiple variables .",
    "the calculus - based form given in @xcite makes the homotopy operator easy to apply by researchers not familiar with differential forms .",
    "however , two issues must be addressed before the homotopy operator becomes a ready - to - use tool .",
    "the first issue relates to the inversion of a total divergence , @xmath17 , which does not have a unique answer . in analogy with standard integration with @xmath18 , where the result is up to an arbitrary constant , @xmath17",
    "is defined up to curl terms .",
    "the homotopy operator will produce a particular choice for the curl terms @xcite , often creating very large vectors .",
    "hence , we discuss an algorithm to remove the unwanted curl terms .",
    "secondly , the homotopy operator fails to work on expressions involving terms of degree zero . a solution to this problem",
    "is also presented in this paper , thereby extending the applicability of the homotopy operator .    with applications in mind",
    "far beyond the computation of conservation laws , the homotopy operator has its own _ mathematica _ code , homotopyintegrator.m @xcite .",
    "to our knowledge , homotopyintegrator.m is currently the only full - fledged implementation of the homotopy operator in _",
    "mathematica_. in collaboration with hereman @xcite , deconinck and nivala @xcite have recently developed similar code in _",
    "maple_. although applicable to exact as well as non - exact expressions , their code is restricted to the 1d case . starting from version 9 of _ maple _ , the homotopy operator is now part of the kernel of _ maple _ to broaden the scope of its integrate function .",
    "anderson @xcite and cheviakov @xcite offer implementations of the homotopy operator in _ maple _",
    ", not as stand - alone tools but as a component of broader software packages .",
    "the multi - dimensional homotopy operator is an essential tool for the symbolic computation of fluxes of conservation laws of nonlinear pdes involving multiple space variables .",
    "most of such systems are not completely integrable for they only have a finite number of conservation laws @xcite . as an application ,",
    "we compute a conservation law of the @xmath19dimensional zakharov - kuznetsov equation @xcite , which describes ion - acoustic solitons in magnetized plasmas .",
    "recently , we developed the _",
    "package conservationlawsmd.m @xcite that automates the computation of polynomial conservation laws of nonlinear polynomial pdes involving multiple space variables and time .",
    "the multi - dimensional homotopy operator is a key tool in that package .",
    "operations are carried out on differential functions , @xmath20 where @xmath21 denotes the dependent variable @xmath22 and its partial derivatives ( up to order @xmath23 with respect to independent variable @xmath24 although we allow variable coefficients , the differential functions should not contain terms that are functions of @xmath25 only . for simplicity of notation in the examples , we will denote @xmath26 etc .  by @xmath27 etc .",
    "we consider only 1d , 2d , and 3d cases .",
    "therefore , the independent space variable , @xmath28 will have at most three components .",
    "thus , @xmath25 represents @xmath29 , @xmath30 and @xmath31 in 1d , 2d , and 3d problems , respectively .",
    "partial derivatives are denoted by @xmath32 .",
    "for example , @xmath33 is written as @xmath34    for simplicity , we often abbreviate @xmath35 by @xmath36 the notation @xmath37 $ ] means that in @xmath38 one replaces @xmath2 by @xmath39 , @xmath40 by @xmath41 , and so on for all derivatives of @xmath42 where @xmath12 is an auxiliary parameter .",
    "for example , if @xmath43 then @xmath37 =   \\lambda^3 x u^2 v_x + \\lambda^2 u_x v_{2x } \\sin \\lambda w.$ ]    two additional operators are needed before the homotopy operator can be defined .",
    "the total derivative operator allows one to algorithmically compute derivatives of differential functions based on the chain rule of differentiation .    with @xmath44 , the 1d total derivative operator",
    "@xmath45 acting on @xmath46 is defined as @xmath47 where @xmath48 is the order of @xmath38 in component @xmath49 and @xmath50 the partial derivative , @xmath51 acts on any @xmath29 that appears explicitly in @xmath38 , but not on @xmath49 or any partial derivatives of @xmath52 the total derivative operators in 2d and 3d are defined analogously .",
    "for example , the 3d total derivative operator with respect to @xmath29 is @xmath53 where @xmath48 , @xmath54 and @xmath55 are the orders of @xmath38 for component @xmath49 with respect to @xmath29 , @xmath56 , and @xmath57 , respectively    obviously , @xmath58 and @xmath59 can be defined analogously .",
    "note that for the 3d case , @xmath60 is the maximum order for derivatives on @xmath61    the euler operator , also known as the variational derivative , is one of the most important tools in the calculus of variations .",
    "the euler operator for the 1d case where @xmath62 is @xmath63 @xmath64 the 2d and 3d euler operators ( variational derivatives ) are defined analogously .",
    "for example , in the 2d case where @xmath65 and @xmath66 , the euler operator is defined as @xmath67    in this paper we use the euler operators to test if differential functions are exact .",
    "let @xmath68 be a differential function of order @xmath69 when @xmath44 , @xmath38 is called _ exact _ if there exists a differential function @xmath70 such that @xmath71 . when @xmath72 or @xmath73 , @xmath38 is _ exact _ if there exists a differential vector function @xmath74 such that @xmath75 in the 2d case , @xmath76 and @xmath77 the definition of @xmath78 in 3d is analogous .",
    "[ zeroeulerexact ] a differential function @xmath66 is exact if and only if @xmath79 here , @xmath80 is the vector @xmath81 which has @xmath82 components matching the number of components of @xmath83    a proof for theorem [ zeroeulerexact ] is given in @xcite .",
    "in this section we show how to compute @xmath84 when @xmath38 is exact . direct integration by parts is cumbersome and prone to errors if @xmath38 contains high - order derivatives of several dependent variables .",
    "the 1d homotopy operator provides an alternate method for integrating exact differential functions ( with one independent variable ) and multiple dependent variables , often eliminating the need for integration by parts .",
    "[ onedhomotopyoperator ] let @xmath85 be the independent variable and @xmath62 be an exact differential function , i.e.  there exist a function @xmath86 such that @xmath87 thus , @xmath86 is the integral of @xmath36 the 1d homotopy operator is defined as @xmath88\\,\\frac{d \\lambda}{\\lambda},\\ ] ] where @xmath89 the integrand , @xmath90 is defined as @xmath91 where @xmath48 is the order of @xmath38 in dependent variable @xmath49 with respect to @xmath29 .",
    "the usual homotopy operator with @xmath92 applies when ( [ 1dhomotopy ] ) converges .",
    "however , due to a possible singularity at @xmath93 ( [ 1dhomotopy ] ) might diverge for @xmath94 this can occur with rational as well as irrational integrands . in such cases , one can take @xmath95 or , alternatively , evaluate the indefinite integral and let @xmath96 as shown in @xcite , the homotopy operator with appropriately selected limits remains a valid tool for integrating non - polynomial functions .    in the next section",
    "we prove that @xmath97 for now , we illustrate the application of the homotopy operator formulas ( [ 1dhomotopy ] ) and ( [ 1dintegrand ] ) with an example .",
    "let @xmath98 and take @xmath99 applying the euler operator ( [ zeroeulerscalarux1d ] ) separately for @xmath100 and @xmath101 with @xmath102 and @xmath103 one readily verifies that @xmath104 and @xmath105 thus , @xmath38 is exact . to find @xmath106 , using ( [ 1dintegrand ] ) , first compute the integrands , @xmath107 where @xmath108 is the identity operator .",
    "next , sum the integrands , replace @xmath109 and @xmath110 with @xmath111 , and @xmath112 respectively , divide by @xmath113 and integrate with respect to @xmath11 in detail , @xmath114\\,\\frac{d \\lambda}{\\lambda }   \\nonumber \\\\   & = & \\int_0 ^ 1 ( 2 \\lambda x u^2 + 2 \\lambda u_x v_{2x }       - 3 \\lambda^2 v_x^3 ) \\,d",
    "\\lambda   \\nonumber \\\\   & = & \\left .",
    "( \\lambda^2 x u^2 + \\lambda^2 u_x v_{2x }       - \\lambda^3 v_x^3 ) \\right|_{0}^{1 }   \\nonumber \\\\   & = & x u^2 + u_x v_{2x } - v_x^3.\\end{aligned}\\ ] ] clearly , @xmath115 here @xmath92 was used since ( [ 1dhomotopy ] ) converged for @xmath94    for polynomial differential expressions , ( [ 1dhomotopy ] ) replaces integration by parts ( in @xmath116 with a few differentiations following by a standard integration ( of a polynomial ) with respect to an auxiliary parameter @xmath11 the second example illustrates the integration of a rational differential function where ( [ 1dhomotopy ] ) diverges for @xmath94    let @xmath98 and take @xmath117 using ( [ 1dintegrand ] ) , @xmath118 and @xmath119 evaluation of ( [ 1dhomotopy ] ) gives @xmath120 obviously , @xmath121 would cause the integral to diverge . instead ,",
    "take @xmath95 so that @xmath122 alternatively , when a singularity occurs at @xmath123 , one could compute the indefinite integral and let @xmath96 in either case , @xmath115",
    "the 1d homotopy operator in definition [ onedhomotopyoperator ] is an expanded version of the one ( in terms of higher - euler operators ) given in @xcite .",
    "although they give the same result @xcite , the expanded homotopy operator formula is computationally more efficient for two reasons : the number of times that the total derivative is applied is significantly smaller and the combinatorial coefficients have been eliminated .    to prove that the homotopy operator ( [ 1dhomotopy ] ) does indeed integrate an exact differential expression , some extra definitions and theorems are needed .",
    "we first define a _ degree operator _",
    ", @xmath124 application of @xmath125 to a differential function yields that function multiplied by its degree ; hence its name .",
    "[ moperatordefn ] let @xmath44 be the independent variable .",
    "the degree operator @xmath125 acting on a differential function @xmath62 is defined @xcite as @xmath126 where @xmath38 has order @xmath48 in @xmath49 with respect to @xmath29 .    the next example shows how the degree operator works .",
    "[ moperatorexpl ] let @xmath127 and @xmath128 , where @xmath129 , @xmath130 , and @xmath131 are nonzero rational numbers . using ( [ moperator ] ) , @xmath132 note that the total degree of @xmath38 has become a factor .",
    "compare this with @xmath133 @xmath134 is a nonzero rational ) in 1d calculus .",
    "it is trivial to prove that @xmath125 is a linear operator .",
    "less straightforward is finding the kernel @xmath135 of @xmath124 for what follows , we need the notion of homogeneity .",
    "a differential function @xmath136 is called _ homogeneous _ of degree @xmath129 in @xmath2 ( and its derivatives ) if @xmath37 = \\lambda^p f.$ ]    note the analogy with the definition of a homogeneous function of several variables .",
    "for example for the two - variables case , @xmath137 is called homogeneous of degree @xmath129 if @xmath138 examples are @xmath139 of degree 2 and @xmath140 of degree @xmath141 @xmath142 and @xmath143 are constants ) .",
    "[ theoremkernelm ] if @xmath144 where @xmath145 and @xmath146 are homogeneous differential functions of the same degree ( so , @xmath38 is of degree @xmath147 then @xmath148    suppose that @xmath15 and @xmath149 are homogeneous differential functions of degree @xmath150 obviously , @xmath151 and @xmath152 hence , @xmath153    conversely , one could ask  which differential functions are in the kernel of the degree operator ? \" for simplicity , consider the case where @xmath154 any @xmath155 must satisfy @xmath156 or explicitly , @xmath157 the jet variables @xmath158 and @xmath159 are independent .",
    "hence , ( [ monf ] ) is a linear first - order pde which can be solved with the method of the characteristics . solving the first - order system of odes , @xmath160 where @xmath161 parameterizes the characteristic curves , yields @xmath162 where the @xmath163 are arbitrary constants .",
    "the first equation in ( [ solchareqs ] ) determines @xmath164 using it to eliminate @xmath161 from the remaining equations of ( [ solchareqs ] ) , yields @xmath165 where @xmath166 and @xmath167 are arbitrary constants .",
    "thus , the general solution of ( [ monf ] ) is @xmath168 where the functional form of @xmath38 is arbitrary .    by construction , @xmath169 is exact .",
    "furthermore , @xmath170 by theorem [ theoremkernelm ] . given @xmath171",
    "not necessarily rational , one can _ a priori _ test whether or not @xmath172 indeed , applying the replacement rules , @xmath173 to @xmath38 should yield an expression which is independent of @xmath174 and @xmath175 applying the replacement rules to @xmath38 in ( [ examplekernelmtest ] ) gives @xmath176 which only depends on @xmath177    the argument above can be extended to any differential function @xmath38 no matter which jet variables are present .",
    "the above  kernel test \" can be performed on exact as well as non - exact differential functions .",
    "next , the inverse of the degree operator will be derived , which requires the use of a homotopy @xcite . to avoid a potentially diverging integral at @xmath13 ,",
    "the homotopy is defined on @xmath178 $ ] . to begin with ,",
    "consider only differential functions with one term , e.g. , @xmath179 , @xmath180 , @xmath181 or take @xmath38 in example [ moperatorexpl ] .",
    "[ inversemtheorem ] let @xmath182 be any single term differential function in 1d and let @xmath183 where @xmath184 then , @xmath185\\,\\frac{d \\lambda}{\\lambda}.\\ ] ]    if @xmath186 has order @xmath48 in @xmath49 with respect to @xmath29 , then @xmath187 $ ] also has order @xmath48 in @xmath49 . furthermore , using the chain rule , @xmath188   = \\sum_{j=1}^n \\sum_{i=0}^{m_1^j } \\frac{{\\partial}g[\\lambda { \\mathbf}{u}]}{{\\partial}\\lambda u^j_{ix } } \\frac{d \\lambda u^j_{ix}}{d \\lambda }   = \\frac{1}{\\lambda } \\sum_{j=1}^n \\sum_{i=0}^{m_1^j } u^j_{ix } \\frac{{\\partial}g[\\lambda { \\mathbf}{u}]}{{\\partial}u^j_{ix } } = \\frac{1}{\\lambda } { { \\ensuremath{\\mathcal{m } } } } g[\\lambda { \\mathbf}{u}],\\ ] ] by the definition of @xmath124 integrate both sides of ( [ dlambdaofg ] ) with respect to @xmath12 yields @xmath189\\,d \\lambda & = & \\int_{\\lambda_0}^1 { { \\ensuremath{\\mathcal{m } } } } \\frac{g[\\lambda { \\mathbf}{u}]}{\\lambda}\\,d \\lambda ,   \\nonumber \\\\   \\left .",
    "{ g \\left [ \\lambda { \\mathbf}{u } \\right ] } \\right|_{\\lambda_0}^{1 } & = & { { \\ensuremath{\\mathcal{m } } } } \\int_{\\lambda_0}^1 g[\\lambda { \\mathbf}{u}]\\,\\frac{d \\lambda}{\\lambda } ,   \\nonumber \\\\",
    "g(x , { \\mathbf}{u}^{(m)}(x ) ) - g[\\lambda_0 { \\mathbf}{u } ] & = & { { \\ensuremath{\\mathcal{m } } } } \\int_{\\lambda_0}^1 g[\\lambda { \\mathbf}{u}]\\,\\frac{d \\lambda}{\\lambda}.\\end{aligned}\\ ] ] to get ( [ inversemthm ] ) , @xmath190 $ ] must be @xmath191 this will affect the choice of @xmath192 indeed , using ( [ moperator ] ) , @xmath193   = \\sum_{j=1}^n \\sum_{i=0}^{m_1^j } \\lambda_0 u_{ix}^j \\frac{{\\partial}f[\\lambda_0 { \\mathbf}{u}]}{{\\partial}(\\lambda_0 u_{ix}^j ) }   = \\lambda_0 \\sum_{j=1}^n \\sum_{i=0}^{m_1^j } u_{ix}^j \\frac{{\\partial}f[\\lambda_0 { \\mathbf}{u}]}{{\\partial}(\\lambda_0 u_{ix}^j)}.\\ ] ] depending on the form of @xmath194 there are two choices for @xmath195 that make @xmath190 = 0.$ ]    1 .   if @xmath190 $ ] in ( [ evaluategoflambdau ] ) is an expression in fractional form where @xmath195 is a factor in the _ denominator _ , then let @xmath95 to get @xmath190 = 0.$ ] the integral on the right - hand side of ( [ laststepminverse ] ) will then converge for @xmath95 .",
    "2 .   for all other cases ,",
    "provided @xmath195 does not drop out of ( [ evaluategoflambdau ] ) after simplification , set @xmath92 to get @xmath190 = 0.$ ] in the simplest case , when @xmath38 ( and therefore also @xmath196 is a homogeneous _ monomial _ of degree @xmath129 , then @xmath187 $ ] has as factor @xmath197 and , consequently , @xmath190 = 0 $ ] for @xmath198    with @xmath190 = 0 $ ] , apply @xmath199 to both sides of ( [ laststepminverse ] ) to get ( [ inversemthm ] ) .",
    "note that theorem [ inversemtheorem ] excludes the case where @xmath200 if @xmath201 , then @xmath202 and theorem [ inversemtheorem ] becomes trivial . in view of theorem [ theoremkernelm ]",
    ", the homotopy operator can not be applied to expressions of degree @xmath191 in particular , the homotopy operator would incorrectly handle integrands involving ratios of polynomial or irrational differential functions of like degree . in section [ seckerm ] , we provide a method to overcome this shortcoming of the homotopy operator .    to show",
    "that ( [ inversemthm ] ) does indeed invert the @xmath125 operator , in the next example we apply @xmath199 to the result of example [ moperatorexpl ] .",
    "let @xmath203 and @xmath204 @xmath205 .",
    "then , @xmath206 as with all polynomial integrands , we took @xmath92 as the lower limit of the homotopy integral .",
    "note that ( [ minverseresult ] ) is identical to @xmath38 given in example [ moperatorexpl ] .",
    "let @xmath207 , where each @xmath208 is a single - term differential function ( not necessarily a monomial ) .",
    "theorem [ inversemtheorem ] holds for @xmath38 provided that @xmath209 for @xmath210    next , we establish the commutation of the degree operator ( and its inverse ) with the total derivative operator .",
    "[ mdcommute1d ] @xmath211 and @xmath212 .    a proof is given in @xcite",
    ".    now follows the key theorem for this section which states that the 1d homotopy operator does indeed integrate an exact differential function .",
    "[ homotopy1dtheorem ] let @xmath62 be exact , i.e.  @xmath213 for some differential function @xmath214 then @xmath215    the proof for the scalar case @xmath216 in @xcite can be generalized to the vector case .",
    "indeed , first consider a fixed component @xmath49 of @xmath2 and multiply @xmath217 by @xmath49 to restore the degree .",
    "subsequently , split off @xmath218 this yields @xmath219 next , integrate the last term by parts and split off @xmath220 continue this process until @xmath221 is split off . continuing with ( [ proofhomotopyuxp1 ] )",
    ", the computations proceed as follows : @xmath222 @xmath223 @xmath224 @xmath225 now , sum ( [ proofhomotopyuxp5 ] ) over all components @xmath49 to get @xmath226 since @xmath38 is exact , by theorem [ zeroeulerexact ] @xmath227 for @xmath228 which implies that @xmath229 hence , @xmath230 apply @xmath199 to both sides and replace @xmath231 by @xmath232 using lemma [ mdcommute1d ] .",
    "thus , @xmath233 apply @xmath18 to both sides of ( [ expressionf ] ) and use ( [ inversemthm ] ) to obtain @xmath234\\,\\frac{d \\lambda}{\\lambda}.\\ ] ] the right hand side of ( [ expressionf ] ) is identical to ( [ 1dhomotopy ] ) with ( [ 1dintegrand ] ) .",
    "the homotopy operator ( [ 1dhomotopy ] ) has been coded in _",
    "syntax and is part of the package homotopyintegrator.m @xcite . in extensive testing @xcite , the expanded formula ( [ 1dhomotopy ] )",
    "out performed the implementation of the homotopy operator in @xcite , dramatically reducing cpu time on complicated expressions .",
    "the code homotopyoperator.m also integrates differential expressions that _",
    "mathematica s _ integrate function fails to integrate .",
    "for example , integrate can not integrate the ( exact ) expression @xmath235 the homotopyintegrator.m code returns @xmath236 it is easy to verify that @xmath115 needless to say , one does not need the homotopy operator to integrate simple expressions like ( [ simplef ] ) for it can easily be done with pen on paper .",
    "the homotopy operator is a tool for integrating long and more complicated differential functions , in particular , those where _",
    "s integrate function fails and integration by hand becomes intractable or prone to errors .",
    "the 2d and 3d homotopy operators invert a divergence in 2d and 3d , respectively .",
    "such inversions are considerably more difficult to do by hand .",
    "the 2d and 3d homotopy operators given in this paper were developed using the technique of proof in theorem [ homotopy1dtheorem ] .",
    "therefore , the homotopy operators presented below are different from the ones in @xcite , where they were defined in terms of higher - order euler operators . like in the 1d case ,",
    "the expanded versions of multi - dimensional homotopy operators require considerably less computations @xcite .",
    "[ twodhomotopyoperator ] let @xmath237 be an exact differential function involving two independent variables @xmath238 the 2d homotopy operator is a  vector \" operator with two components , @xmath239 where @xmath240\\,\\frac{d \\lambda}{\\lambda }    \\,\\;{\\rm and}\\;\\ , { \\mathcal}{h}_{{\\mathbf}{u}(x , y)}^{(y ) } f \\!=\\ !",
    "\\int_{\\lambda_0}^1 \\left (   \\sum_{j=1}^{n }   { \\mathcal}{i}_{u^j(x , y)}^{(y ) } f \\right)[\\lambda { { \\mathbf}{u}}]\\,\\frac{d \\lambda}{\\lambda}.\\ ] ] the @xmath29-integrand , @xmath241 , is given by @xmath242 with combinatorial coefficient @xmath243 defined as @xmath244 similarly , the @xmath56-integrand , @xmath245 is defined as @xmath246 where @xmath247    [ threedhomotopyoperator ] let @xmath248 be a differential function of three independent variables where @xmath249 the homotopy operator in 3d is a three - component ( vector ) operator , @xmath250 where the @xmath29-component is given by @xmath251\\,\\frac{d \\lambda}{\\lambda}.\\ ] ] the @xmath56- and @xmath57-components are defined analogously .",
    "the @xmath29-integrand is given by @xmath252 with combinatorial coefficient @xmath253 defined as @xmath254 as one might expect , the integrands @xmath255 and @xmath256 are defined analogously .",
    "based on cyclic permutations , they have combinatorial coefficients @xmath257 and @xmath258 , respectively .",
    "the homotopy with @xmath92 is used , except when singularities at @xmath123 occur .",
    "[ homotopy2d3dtheorem ] let @xmath68 be exact , i.e.   @xmath259 for some @xmath260 then , in the 2d case , @xmath261 analogously , in 3d , @xmath262    the very lengthy proof is similar to that of theorem [ homotopy1dtheorem ] . it does not add much to the understanding of the theory",
    "nevertheless , details can be found in ( * ? ? ?",
    "* appendix a ) .",
    "the following 2d example demonstrates how ( [ 2dhomotopy ] ) works .",
    "[ 2dhomotopyexample ] with @xmath263 and @xmath264 let @xmath265 using ( [ integrand2dx ] ) , compute @xmath266 likewise , using ( [ integrand2dy ] ) , compute @xmath267 then , using ( [ 2dhomotopy ] ) , compute @xmath268\\,\\frac{d \\lambda}{\\lambda } \\nonumber \\\\   & = & \\int_0 ^ 1 \\left ( 3 \\lambda^2 u^2 u_{2y } + 3 u_x \\sin \\lambda v + 3 \\lambda u_x v \\cos \\lambda v - 2 \\lambda^2 u_y v v_{xy } \\right .",
    "\\nonumber \\\\   & & \\left .   - 2 \\lambda^2 u_y v_x v_y - 2 \\lambda^2 u_{2y } v v_x \\right)\\ , d \\lambda \\nonumber \\\\   & = & u^2 u_{2y } + 3 u_x \\sin v - \\tfrac{2}{3 } u_y v v_{xy } - \\tfrac{2}{3 } u_y v_x v_y - \\tfrac{2}{3 } u_{2y } v v_x ,   \\nonumber \\\\   { \\mathcal}{h}_{{\\mathbf}{u}(x , y)}^{(y ) }",
    "f   & = & \\int_0 ^ 1 \\left (   { \\mathcal}{i}_{u(x , y)}^{(y ) } f + { \\mathcal}{i}_{v(x , y)}^{(y ) } f \\right ) [ \\lambda { \\mathbf}{u}]\\,\\frac{d \\lambda}{\\lambda } \\nonumber \\\\   & = & \\int_0 ^ 1 \\!\\ ! \\left ( v_y \\cos \\lambda u - \\lambda u v_y \\sin \\lambda u - 4 \\lambda^2 u_y v_x^2 + 2 \\lambda^2 u_y v v_{2x } + 2 \\lambda^2 u_{xy } v v_x \\right)\\,d \\lambda \\nonumber \\\\   & = & \\tfrac{2}{3 } u_y v v_{2x } + \\tfrac{2}{3 } u_{xy } v v_x - \\tfrac{4}{3 } u_y v_x^2 + v_y \\cos u.\\end{aligned}\\ ] ] thus , the homotopy operator gives the vector @xmath269    obviously , there are infinitely many choices for @xmath270 because the addition to @xmath270 of a 2d `` curl vector , '' @xmath271 where @xmath272 is an arbitrary differential expression , will produce an identical divergence .",
    "indeed , @xmath273 the same happens in 3d where a curl vector , @xmath274 involves three arbitrary differential functions @xmath275 and @xmath276 often a concise result can be obtained for ( [ homotopyresult2dexample ] ) by removing undesirable curl terms .",
    "this is the subject of the next section .",
    "the homotopy operator acting on an exact multi - dimensional differential function returns an @xmath270 which includes a curl vector .",
    "although the homotopy operator consistently leads to a particular choice for the curl vector , @xmath270 can be of unmanageable size due to the presence of dozens , if not hundreds , of unwanted terms . removing the curl terms makes @xmath270 shorter .",
    "there are several methods for removing curl vectors .",
    "doing so by hand requires educated guess work . ideally , one could modify the integrand of the homotopy operator so that the least number of curl terms would be generated .",
    "we are currently investigating this strategy .",
    "for now , we propose a simple , yet effective algorithm that uses only linear algebra .    to remove the curl terms from ( [ homotopyresult2dexample ] ) , first attach undetermined coefficients , @xmath277 , to the terms of ( [ homotopyresult2dexample ] ) and call the new vector @xmath278 doing so , @xmath279 next , compute @xmath280 since @xmath270 in ( [ homotopyresult2dexample ] ) and @xmath281 in ( [ veccurlconstants ] )",
    "should differ only by a curl vector , their divergences must be identical . thus , @xmath282 in ( [ 2dexampledivergence ] ) .",
    "gathering like terms in ( [ 2dexampledivergence ] ) and ( [ divwithconstants ] ) leads to the linear system @xmath283 to find the undetermined coefficients that will produce a @xmath281 without curl terms , first solve for the @xmath284 that appear only in equations with non - zero right - hand sides . in ( [ systemforexample ] ) , clearly @xmath285 , @xmath286 , and @xmath287",
    "the next variable to solve is @xmath288 since it appears in equations with non - zero right hand sides .",
    "coefficients @xmath289 through @xmath290 appear in equations with zero right - hand sides ; these equations are solved last . solving ( [ systemforexample ] ) in this order",
    "yields @xmath291 where @xmath290 is arbitrary . set @xmath292 to eliminate as many terms as possible in ( [ veccurlconstants ] ) .",
    "substitute ( [ solutionexample ] ) with @xmath292 into ( [ veccurlconstants ] ) , to get @xmath293 by construction , @xmath294 but ( [ finalftilde ] ) is free of curl terms .",
    "it follows from ( [ mf ] ) , that the 1d homotopy operator in definition [ onedhomotopyoperator ] , will not work when @xmath295 ( or for that matter any term of it ) belongs to @xmath296 indeed , if @xmath170 , in particular when @xmath38 satisfies the conditions of theorem [ theoremkernelm ] , then @xmath297 , where @xmath298 is an arbitrary constant .",
    "thus , the homotopy operator would return @xmath299 in fact @xmath13 for it ignores constants of integration .",
    "the next two examples ( in 1d ) demonstrate a problem that occurs when some terms of @xmath38 belong to @xmath300 while others do not .",
    "[ degree0example1d ] let @xmath203 and @xmath301 then , @xmath302 obviously , @xmath38 is of degree zero .",
    "hence , @xmath170 by theorem [ theoremkernelm ] . therefore ,",
    "trying to integrate @xmath38 with the homotopy operator will fail . indeed , using ( [ 1dintegrand ] ) for @xmath303 and @xmath304 , respectively , yields @xmath305 clearly , @xmath306 and ( [ 1dhomotopy ] ) gives @xmath13 instead of @xmath307    furthermore ,",
    "if @xmath38 is the sum of monomial , rational , or irrational terms ( and fractions thereof ) where any of these terms are in @xmath308 then the homotopy operator will return an incorrect result .",
    "indeed , the homotopy operator would correctly integrate the terms not in @xmath308 but annihilate the terms in @xmath296 the following example highlights this situation .",
    "[ degree0examplemultiterm ] let @xmath203 and @xmath309 then , @xmath310 is exact by construction . applying the degree operator to @xmath194 term by term , gives @xmath311 because the last two terms of ( [ exampleftroubleterms ] ) are annihilated by @xmath312 the homotopy operator will incorrectly integrate @xmath36 one would obtain @xmath313 instead of @xmath309    a method to overcome these shortcomings will now be proposed .",
    "a coordinate for the `` jet '' space where @xmath35 resides is given by @xmath314 which has origin @xmath315 by shifting the coordinate away from @xmath80 , @xmath38 can be taken out of @xmath296 it suffices to shift one of the variables that appear in the denominator of the term in @xmath300 . after integrating , the shift must be undone to put the integral at the origin .",
    "the following examples illustrate the procedure .",
    "returning to example [ degree0example1d ] , where @xmath316 since @xmath317 appears in the denominator , replace @xmath317 with @xmath318 to get @xmath319 then use the homotopy operator to integrate @xmath320 using ( [ 1dintegrand ] ) , first compute @xmath321 next , using ( [ 1dhomotopy ] ) , compute @xmath322\\,\\frac{d \\lambda}{\\lambda } = - \\int_0 ^ 1 \\frac{u_x v_0}{(\\lambda v - v_0)^2}\\,d \\lambda   \\nonumber \\\\   & = & \\left .",
    "{ \\frac{u_x v_0}{v ( \\lambda v - v_0 ) } } \\right|_{0}^{1 } = \\frac{u_x}{v - v_0}. \\nonumber\\end{aligned}\\ ] ] finally , remove the shift by replacing @xmath317 with @xmath323 ( or simply set @xmath324 to get @xmath325    to integrate @xmath38 from example [ degree0examplemultiterm ] , the shift only needs to be applied to the last two terms of ( [ exampleftroubleterms ] ) because these are in @xmath296 therefore , we will apply the homotopy operator to @xmath326 where @xmath100 has been replaced by @xmath327 in the last two terms .",
    "note that it suffices to shift just one of the two variables in the denominator .",
    "keeping the number of shifts to a minimum leads to a simpler integrand for the integration over @xmath11 the integrands for the homotopy operator are @xmath328 the first terms in each integrand have not been shifted .",
    "however , the second terms have been shifted . applying ( [ 1dhomotopy ] ) , @xmath329 finally , setting @xmath330 yields the desired result",
    ", @xmath309    similar difficulties might occur with functions in fractional form involving multiple independent variables .",
    "again , a shift of a coordinate in the denominator will solve the problem .",
    "however , the complexity of the integration over @xmath12 increases rapidly when there are multiple independent variables ( with shifts ) .",
    "implementation of the 2d and 3d homotopy operators ( in definitions [ twodhomotopyoperator ] and [ threedhomotopyoperator ] ) requires the same amount of care .",
    "a discussion of the kernel of the homotopy operator , including an alternate strategy for dealing with the integration of homogeneous expressions can be found in @xcite .",
    "this section covers the application of the homotopy operator to the computation of conservation laws of nonlinear pdes .",
    "we developed a _",
    "mathematica _ package , conservationlawsmd.m @xcite , that automates these computations for nonlinear polynomial pdes with a maximum of three space variables in addition to time .    a conservation law for a given pde with independent variables @xmath331 and @xmath25 is defined as @xmath332 where @xmath333 is the _ conserved density _",
    ", @xmath334 is the _ associated flux_. @xmath335 is the total derivative with respect to @xmath331 and @xmath78 is the total divergence with respect to @xmath24 ( [ genconlaw ] ) is satisfied on solutions of the given pde @xcite .",
    "a conservation law is found by first computing the density , @xmath336 followed by the computation of the flux @xmath337 the latter will require the use of the homotopy operator .    following the approach by hereman _",
    "et al_.   @xcite , a candidate density is built as a linear combination ( with undetermined coefficients ) of differential terms which are invariant under the scaling symmetry of the given pde .",
    "once the form of @xmath338 is determined , one computes @xmath339 and removes all time - derivatives using the pde . by ( [ genconlaw ] )",
    ", @xmath339 must be a divergence .",
    "thus , using theorem [ zeroeulerexact ] , one requires that @xmath340 where @xmath341 is the euler operator .",
    "this leads to a linear system for the undetermined coefficients .",
    "substituting its solution into the candidate for @xmath338 gives the actual density .",
    "finally , the flux @xmath342 is computed with the homotopy operator .    to illustrate the method , we compute a conservation law for the @xmath19 dimensional zakharov - kuznetsov ( zk ) equation @xcite which describes ion - acoustic solitons in magnetized plasmas .",
    "after re - scaling , the pde takes the form @xmath343 where @xmath344 and @xmath345 are parameters and @xmath346 is the laplacian .",
    "it is easy to verify that ( [ zkequation ] ) is invariant under the scaling ( dilation ) symmetry , @xmath347 this scaling symmetry can be computed as follows .",
    "assume that ( [ zkequation ] ) scales uniformly under @xmath348 with undetermined ( rational ) exponents @xmath349 and @xmath350 applying the chain rule to ( [ zkequation ] ) yields @xmath351 one obtains ( [ zkequation ] ) in the new variables @xmath352 up to the common factor @xmath353 if @xmath354 setting @xmath355 one gets @xmath356 and @xmath357 which determines ( [ zkscalingsymmetry ] ) .",
    "a more algorithmic method for computing scaling symmetries can be found in @xcite .",
    "the scaling symmetry carries over to conservation laws and therefore can be used to construct densities @xcite .",
    "indeed , since ( [ genconlaw ] ) holds on solutions of ( [ zkequation ] ) , both @xmath338 and @xmath358 must obey the scaling symmetry ( [ zkscalingsymmetry ] ) of given pde .",
    "for example , ( [ zkequation ] ) is a conservation law itself , with @xmath359 expressing conservation of mass .",
    "it is straightforward to verify that @xmath360 also are a density - flux pair of ( [ zkequation ] ) ; the corresponding conservation law expresses conservation of momentum .",
    "note that the densities in ( [ zkrank2conlaw ] ) and ( [ zkrank4conlaw ] ) scale with @xmath361 and @xmath362 respectively . for brevity",
    ", we say that @xmath363 has _ rank _",
    "@xmath364 @xmath365 has rank @xmath366 the fluxes @xmath367 and @xmath368 have ranks @xmath369 and @xmath370 as a whole , the conservation laws ( [ genconlaw ] ) with @xmath371 and @xmath372 have ranks @xmath373 and @xmath374 respectively .    we will construct a third density , @xmath375 which has rank @xmath376 i.e.  each monomial in @xmath377 depends on @xmath100 and its derivatives so that every term scales with @xmath378 first , construct the list @xmath379 containing powers of the dependent variable of rank 6 or less .",
    "second , bring all terms in @xmath380 with a rank less that 6 up to rank 6 by applying @xmath45 and @xmath381 considering all possible combinations of derivations yields @xmath382 third , remove all terms from @xmath383 that are divergences ( because they belong to the flux ) .",
    "for example , @xmath384 = @xmath385 .",
    "this leaves @xmath386 fourth , find terms that are divergence - equivalent and remove all but the lowest order term .",
    "two or more terms are divergence - equivalent when a linear combination of the terms is a divergence .",
    "for example , @xmath387 and @xmath388 are divergence - equivalent since @xmath389 consequently , @xmath388 can be removed from @xmath390 doing so , @xmath391 if divergences and divergence - equivalent terms were not removed , they would lead to trivial and equivalent conservation laws , respectively .    now , form a candidate density by linearly combining the terms in @xmath383 with undetermined coefficients @xmath392 @xmath393 all , part , or none of the candidate density may be an actual density for ( [ zkequation ] ) . indeed , the candidate density may be trivial or a linear combination of two or more independent densities .",
    "computation of the undetermined coefficients will reveal the nature of the candidate density .    with ( [ zkrank6candidate ] ) , compute @xmath394 using ( [ zkequation ] ) , replace @xmath395 with @xmath396 set @xmath397 to get @xmath398 since ( [ zkrepldtrhorank6 ] ) must be a divergence , use ( [ zeroeulerscalarux2d ] ) and require @xmath399 it follows from ( [ zeroeulerdtrhorank6 ] ) that @xmath400 before solving the system it is necessary to check for potential compatibility conditions on the parameters @xmath344 and @xmath401 this",
    "is done by setting each @xmath402 , one at a time , and algebraically eliminating the other undetermined coefficients .",
    "see , e.g. , @xcite for details about computing compatibility conditions .",
    "it turns out that there are no compatibility conditions for ( [ zkrank6undetsystem ] ) and the solution is @xmath403 where @xmath404 is arbitrary . substitute ( [ zkrank6undetsoln ] ) into ( [ zkrank6candidate ] ) and set @xmath405 to get @xmath406      after substitution of ( [ zkrank6undetsoln ] ) and @xmath405 into ( [ zkrepldtrhorank6 ] ) , @xmath407 since @xmath408 the flux @xmath409 can be computed with the 2d homotopy operator which inverts divergences . using ( [ 2dhomotopy ] ) ,",
    "the integrands are @xmath410 and @xmath411 the 2d homotopy operator formulas in ( [ 2dhomotopy ] ) yield @xmath412\\,\\frac{d \\lambda}{\\lambda }   \\nonumber \\\\   & = & \\int_0 ^ 1 \\left ( 3 \\alpha \\lambda^3 u^4   + \\beta \\lambda^2 \\left ( 9 u^2 ( u_{2x } + \\tfrac{2}{3 } u_{2y } ) - 6   u ( 3 u_x^2 + u_y^2 ) \\right ) \\right .",
    "\\nonumber \\\\   & & { } + \\tfrac{\\beta^2}{\\alpha } \\lambda \\left ( 6 u_{2x}^2 + 5 u_{xy}^2 + \\tfrac{3}{2 } u_{2y}^2 + \\tfrac{3}{2 } u ( u_{2x2y } + u_{4y } ) - u_x ( 12 u_{3x } + 7 u_{x2y } ) \\right .   \\nonumber \\\\   & & \\left .",
    "\\left . { } - u_y ( 3 u_{3y } + 8 u_{2xy } ) + \\tfrac{5}{2 } u_{2x } u_{2y } \\right ) \\right)\\,d \\lambda   \\nonumber \\\\   & = & \\tfrac{3}{4 } \\alpha u^4   + \\beta \\left ( 3 u^2 ( u_{2x } + \\tfrac{2}{3 } u_{2y } ) - 2   u ( 3 u_x^2 + u_y^2 ) \\right )   \\nonumber \\\\   & & { } + \\tfrac{\\beta^2}{\\alpha } \\left ( 3 u_{2x}^2 + \\tfrac{5}{2 } u_{xy}^2 + \\tfrac{3}{4 } u_{2y}^2 + \\tfrac{3}{4 } u ( u_{2x2y } + u_{4y } ) - u_x ( 6 u_{3x } + \\tfrac{7}{2 } u_{x2y } ) \\right .",
    "\\nonumber \\\\   & & \\left . { }   - u_y ( \\tfrac{3}{2 } u_{3y } + 4 u_{2xy } ) + \\tfrac{5}{4 } u_{2x } u_{2y } \\right ) , \\nonumber \\\\ { \\mathcal}{h}_{{\\mathbf}{u}(x , y)}^{(y ) } e & = & \\int_0 ^ 1 \\left ( { \\mathcal}{i}_{u(x , y)}^{(x ) } e \\right ) [ \\lambda { \\mathbf}{u}]\\,\\frac{d \\lambda}{\\lambda }   \\nonumber \\\\   & = & \\int_0 ^ 1 \\left ( 3 \\lambda^2 \\beta   u ( u u_{xy } - 4 u_x u_y ) - \\tfrac{\\beta^2}{2 \\alpha } \\lambda \\left ( 3 u ( u_{3xy } + u_{x3y } ) + u_x ( 3 u_{3y } + 13 u_{2xy } ) \\right .",
    "\\nonumber \\\\   & & \\left . \\left . { } + u_y ( 5 u_{3x } + 15 u_{x2y } ) - \\tfrac{9}{2 } u_{2y } ( u_{2x } + u_{xy } ) \\right ) \\right)\\,d",
    "\\lambda   \\nonumber \\\\   & = &   \\beta   u ( u u_{xy } - 4 u_x u_y ) - \\tfrac{\\beta^2}{4 \\alpha } \\left ( 3 u ( u_{3xy } + u_{x3y } ) + u_x ( 13 u_{2xy } + 3 u_{3y } ) \\right .",
    "\\nonumber \\\\   & & \\left .",
    "{ } + 5 u_y ( u_{3x } + 3 u_{x2y } )   - 9 u_{xy } ( u_{2x } + u_{2y } ) \\right ) .",
    "\\nonumber\\end{aligned}\\ ] ] the flux @xmath413 has a curl term , @xmath414 with @xmath415 after removing @xmath416 with the technique in section [ secremovecurl ] , the density - flux pair reads @xmath417 there is one additional density - flux pair @xcite with explicit dependence on @xmath29 and @xmath418 @xmath419 which expresses the conservation of center of mass .",
    "no other density - flux pairs than the four reported above could be found @xcite with conservationlawsmd.m .",
    "zakharov and kuznetsov @xcite found three ",
    "integrals of motion \" which are identical to ( [ zkrank2conlaw ] ) , ( [ zkrank4conlaw ] ) , and ( [ zkrank1conlaw ] ) .",
    "without mention of fluxes , infeld @xcite reports the densities in ( [ zkrank4conlaw ] ) and ( [ zkrank6conlaw ] ) and states that another constant of motion exists , but only for the zk equation in 3d .",
    "et al_.  @xcite claimed that there are only four conservation laws for the zk equation , but gave different results .",
    "shivamoggi computed conservation laws for the potential zk equation , @xmath420 derived from ( [ zkequation ] ) with @xmath421 by setting @xmath422 followed by an integration with respect to @xmath423 doing so , he produced four nonlocal conservation laws for ( [ zkequation ] ) .",
    "the densities for the potential zk equation reported in @xcite are correct but the fluxes for three of the four conservation laws are incorrect due to typographical errors @xcite .    in summary , the existence of only four conservation laws confirms that ( [ zkequation ] ) is not completely integrable .",
    "this material is based in part upon research supported by the national science foundation ( nsf ) under grant no .",
    "any opinions , findings , and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of nsf .",
    "wh is grateful for the hospitality and support of the department of mathematics and statistics of the university of canterbury ( christchurch , new zealand ) during his sabbatical visit in fall 2007 .",
    "m. hickman ( university of canterbury ) and b. deconinck ( university of washington ) are thanked for sharing their insights about the scope and limitations of homotopy operators .",
    "w. hereman , p. j. adams , h. l. eklund , m. s. hickman , and b. m. herbst , _ direct methods and symbolic software for conservation laws of nonlinear equations _ , in _ advances in nonlinear waves and symbolic computation _ , z. yan , ed . , nova science publishers , new york , 2009 , pp .",
    "19 - 79 .",
    "w. hereman , m. colagrosso , r. sayers , a. ringler , b. deconinck , m. nivala , and m. s. hickman , _ continuous and discrete homotopy operators and the computation of conservation laws _ , in _ differential equations with symbolic computation _ ,",
    "d. wang and z. zheng , eds .",
    ", birkhuser verlag , basel , 2005 , pp .",
    "249 - 285 .",
    "m. d. kruskal , r. m. miura , c. s. gardner , and n. j. zabusky , _ korteweg - de vries equation and generalizations v. uniqueness and nonexistence of polynomial conservation laws _ , j. math .",
    "11 ( 1970 ) , pp .",
    "952 - 960 .",
    "l. d. poole and w. hereman , homotopyintegrator.m : a _ mathematica _",
    "package for the application of the homotopy method for ( i ) integration by parts of expressions involving unspecified functions of one variable and ( ii ) the inversion of a total divergence involving unspecified functions of two or three independent variables , ( 2009 ) ; software available at http://inside.mines.edu/@xmath424whereman under scientific software .",
    "b. deconinck , and m. nivala , intsum , maple software for the symbolic integration and summation of expressions that may or may not be exact , ( 2005 ) ; software available at http://www.amath.washington.edu/@xmath424bernard/software/intsum .",
    "l. d. poole and w. hereman , conservationlawsmd.m : a _ mathematica _ package for the symbolic computation of conservation laws of nonlinear partial differential equations in multiple space variables , ( 2009 ) ; software available at http://inside.mines.edu/@xmath424whereman under scientific software ."
  ],
  "abstract_text": [
    "<S> using standard calculus , explicit formulas for one- , two- and three - dimensional homotopy operators are presented . </S>",
    "<S> a derivation of the one - dimensional homotopy operator is given . </S>",
    "<S> a similar methodology can be used to derive the multi - dimensional versions . </S>",
    "<S> the calculus - based formulas for the homotopy operators are easy to implement in computer algebra systems such as _ mathematica _ , _ maple _ , and reduce . </S>",
    "<S> several examples illustrate the use , scope , and limitations of the homotopy operators . the homotopy operator can be applied to the symbolic computation of conservation laws of nonlinear partial differential equations ( pdes ) . </S>",
    "<S> conservation laws provide insight into the physical and mathematical properties of the pde . </S>",
    "<S> for instance , the existence of infinitely many conservation laws establishes the complete integrability of a nonlinear pde .    </S>",
    "<S> homotopy operator , exact differential function , euler operator , total divergence , conservation law , complete integrability .    </S>",
    "<S> primary : 37j35 , 37k40 , 35q51 ; secondary : 68w30 , 47j35 , 70h06 . </S>"
  ]
}