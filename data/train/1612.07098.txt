{
  "article_text": [
    "here , we derive the heisenberg equations of motion used in the main part of the paper starting from a continuous - mode treatment of the circuit shown in fig .  [",
    "fig : appendixcircuit ] .",
    "a similar derivation is given also in many other works , e.g. , in ref .",
    "we consider explicitly the microwave circuit shown in fig .",
    "[ fig : appendixcircuit ] , but this is not the only possible realization of our system .",
    "for example , the electromagnetic environment could also consists of two @xmath123-type resonators , connected by the josephson junction .",
    "the total lagrangian of the system can be decomposed as @xmath124 the left - hand side lagrangian splits into @xmath125 , where the transmission - line part reads @xmath126 here @xmath127 is the magnetic flux of node @xmath128 and @xmath129 is the corresponding voltage .",
    "this amounts to defining the magnetic flux ( time integrated voltage ) of the left - hand side transmission line with respect to @xmath130 .",
    "the left - hand side oscillator part is @xmath131 similarly for the oscillator @xmath36 and the right - hand side transmission line ( with the value @xmath132 ) .",
    "the josephson junction is described by the potential - energy term , @xmath133 here @xmath5 is the josephson coupling energy and @xmath134 is the flux quantum .",
    "the above lagrangian leads to the left - hand side hamiltonian @xmath135 where @xmath136 and @xmath137 .    for convenience",
    ", we can do a shift in the momentum variable and neglect the terms @xmath138 .",
    "this does not change the hamiltonian equations @xmath139 provided that @xmath140 is a constant .",
    "standard quantization means @xmath141 and @xmath142 with @xmath143=i\\hbar$ ] . defining the normalized phase , @xmath144 , we have equivalently @xmath145=i2e$ ] .",
    "the heisenberg equations of motion in the transmission line are ( @xmath146 ) @xmath147\\\\ \\hat{\\dot { q}}_i(t ) & = & \\frac{i}{\\hbar}\\left[\\hat h,\\hat q_i \\right].\\end{aligned}\\ ] ] these give us @xmath148 in the continuum limit @xmath149 , the two equation lead to the klein - gordon equation , @xmath150 we can then establish a solution in the free space ( @xmath151 ) @xmath152,\\ ] ] where @xmath153 and @xmath154 . here",
    ", the operator @xmath155 creates and the operator @xmath156 annihilates an incoming ( outgoing ) propagating photon of frequency @xmath157 .",
    "we have the commutation relations @xmath158=\\delta(\\omega-\\omega'),\\ ] ] and similarly for the out - operators .",
    "the same derivation also applies for the propagating fields on the right - hand side transmission line .",
    "if only frequencies close to the resonance frequency @xmath159 are relevant , we can replace the factor @xmath160 in eq .",
    "( [ appendixeq : propagatingfield ] ) by @xmath161 .",
    "we have then @xmath162.\\ ] ] here , we have also formally extendend the integration over frequencies to @xmath163 , even though negative frequencies are not actually defined here .",
    "this mathematical redfeintion does not change results , when frequencies well below @xmath159 have negligible contribution , but makes the use of fourier transformations formally more clear . within this",
    "we write @xmath164,\\end{aligned}\\ ] ] where @xmath165 and @xmath166 .",
    "we have then commutation relations @xmath167=\\delta(t - t')$ ] .",
    "the inverse transformation has the form @xmath168 .",
    "similarly for the out - field operators .",
    "we introduce now the resonator creation and annihilation operators , @xmath169 here for a free resonator the choice @xmath170 diagonalizes the resonator hamiltonian , and in this case @xmath171 @xmath172 .",
    "the resonance frequency has then the form @xmath173 .",
    "however , at this point we do not fix @xmath174 to this value , since the resonator capacitance will be normalized by the coupling capacitance @xmath175 , as derived below .",
    "the form of eq .",
    "( [ eq : phi ] ) , however , stays the same , calculated with the renormalized capacitance .    at the resonator boundary ( @xmath176 ) the heisenberg equations of motion give",
    "@xmath177 the derivative with respect to @xmath178 corresponds to the continuum limit @xmath149 .",
    "a solution for the latter equation is @xmath179 + { \\rm h.c.}=\\sqrt{\\frac{\\hbar } { 2\\omega_{a}z_{0}}}\\left[\\hat a_{\\rm   in}(t)-\\hat a_{\\rm   out}(t)\\right]+ { \\rm h.c.}\\end{aligned}\\ ] ] to proceed we now make an important observation . in eq .",
    "( [ eq : resonatorboundary1 ] ) , the operator @xmath180 is characterized by relative size @xmath181 , whereas the time derivative of the phase @xmath182 by size @xmath159 . here , it is always the former term that will dominate ( high cut - off frequency ) , and we can neglect the time derivative of the phase operator . in this limit",
    "we get @xmath183 to derive this we have used @xmath184.\\ ] ]    at the junction , the effective hamiltonian to be used in the heisenberg equations of motion has the form @xmath185+\\hat h_{\\rm j}+i\\frac{1}{c_a}\\hat q_1\\sqrt{\\frac{\\hbar}{2z_{lc}}}\\left [ \\hat a^\\dagger -\\hat a   \\right]=   \\\\ = & & \\hbar\\left [   \\frac{z_{lc}}{4l_a}\\left(\\hat a+\\hat a^\\dagger\\right)^2 - \\frac{1}{4z_{lc}c_a}\\left(\\hat a-\\hat a^\\dagger\\right)^2   \\right]+\\hat h_{\\rm j}+i\\frac{1}{c_a}\\left [ c_{\\rm s}\\hat{\\dot{\\phi}}(t,0 ) -i\\frac{c_{\\rm s}}{c_a}\\sqrt{\\frac{\\hbar}{2z_{lc}}}(\\hat a^\\dagger-\\hat a ) \\right]\\sqrt{\\frac{\\hbar}{2z_{lc}}}\\left [ \\hat a^\\dagger -\\hat a   \\right ] , \\nonumber\\end{aligned}\\ ] ] where we used heisenberg eq .",
    "( [ eq : resonatorboundary1 ] ) to eliminate @xmath186 .",
    "the last term inside the second parentheses contributes to the effective capacitance of the resonator , changing it to @xmath187 . more rigorously : the choice @xmath188 leads to the quadratic resonator part @xmath189 . using the relation @xmath190,\\ ] ] the heisenberg equations",
    "take the form @xmath191 + \\frac{i}{\\hbar}\\left [ \\hat h_{\\rm j } , \\hat a \\right ] .\\end{aligned}\\ ] ] using @xmath192 and defining @xmath193 one arrives in the equation of motion @xmath194 .\\end{aligned}\\ ] ] we would like to express the boundary condition and the equation of motion in a form used often in the literature .",
    "we do this by redefining the phase of the operators @xmath195 and @xmath196 , which leads to @xmath197\\\\ \\hat a_{\\rm in}(t)+\\hat a_{\\rm out}(t)&=&\\sqrt{\\gamma_a}\\hat a(t).\\end{aligned}\\ ] ] similar heisenberg equations can also be derived for the right - hand side transmission - line operators .",
    "in this section , we derive the single - to - multi - photon scattering matrix given in the main part of the article .",
    "we also show how to linearize this problem and straightforwardly derive general results for the conversion probability .",
    "the linearization is possible in the case of a single incoming photon or weak coherent drive ( @xmath198 ) .      in the rotating - wave approximation ,",
    "the coupling hamiltonian between the two cavities has the form @xmath199 the heisenberg equations of motion for the cavity fields are then @xmath200      for the present problem , we prefer to work with the fourier - transformed heisenberg equations of motion .",
    "the results derived using this method agree with the linearization technique introduced in the next section .",
    "starting from the definitions @xmath201 we get for the heisenberg equations @xmath202 where we have defined @xmath203 in these equations , the in - field @xmath204 [ @xmath205 can be changed to out - field @xmath206 [ -@xmath207 with simultaneous change @xmath208 in @xmath209 ( obtained by using the resonator boundary conditions ) .",
    "our goal is to determine the amplitude ( scattering matrix ) @xmath210 with the help of resonator boundary conditions and heisenberg equations of motion .",
    "we first consider in detail the case @xmath211 and then describe the generalization to arbitrary @xmath0 . here",
    ", we evaluate the scattering element @xmath212 \\right\\vert 0 \\right\\rangle.\\end{aligned}\\ ] ] since the out fields of different modes ( by definition ) need to commute , we must have @xmath213 therefore , @xmath214 we then get @xmath215 \\right\\vert 0 \\right\\rangle , \\end{aligned}\\ ] ] where in the second form we used eq .  ( [ eq : heienberg1 ] ) . as the first term ( inside the square brackets )",
    "again gives no contribution , we must have @xmath216 we continue by exploiting the heisenberg equation @xmath217 the factor 2 comes from the factor @xmath0 in the boundary condition . when applying @xmath36 to the ground state we obtain zero [ since @xmath218 and the ground state has no incoming or outgoing photons ] . therefore ,",
    "@xmath219 in order to evaluate application by @xmath220 , we again make use of the heisenberg equation  ( [ eq : general1 ] ) . consider first the term not proportional to @xmath221 , i.e. , another multiplication by @xmath222 .",
    "using @xmath223 we get for this term ( we name it @xmath224 ) , @xmath225 \\delta(\\omega_k+\\omega_{\\rm j}-{p_1}-{p_2 } ) \\\\ & = & \\bar a_0\\delta(\\omega_k+\\omega_{\\rm j}-{p_1}-{p_2 } ) .",
    "\\label{eq : bara}\\end{aligned}\\ ] ] the two terms inside the square brackets of eq .",
    "( [ eq : generalization1 ] ) are equal .",
    "this is the leading - order solution in @xmath226 .",
    "the second contribution to @xmath227 accounts for the non - perturbative limit .",
    "we need to evaluate @xmath228 here we have defined @xmath229 in the second form we have also inserted identity operator @xmath230 between @xmath231 and @xmath36 .",
    "a crucial step here is based on the observation : only insertion @xmath232 gives nonzero contribution .",
    "similar property has also been used to evaluate scattering properties on a two - level system  @xcite and is possible due to photon - number conservation ( here of the specific form @xmath233 ) .",
    "( [ eq : othercontribution ] ) becomes then a product of two amplitudes .",
    "the left - hand side amplitude is proportional to @xmath227 and the right - hand side amplitude measures scattering of single incoming photon from side @xmath36 .",
    "single incoming photon from side @xmath36 has no change but to reflect at the junction in a way described by the solution for @xmath234 .",
    "this solution is derived in section  [ sec : uncoupledmodes ] ) , where we get @xmath235 therefore , the term in eq .",
    "( [ eq : othercontribution ] ) can be rewritten in the form @xmath236 we then continue by evaluating the integration @xmath237 explicitly , which is done over the function @xmath238 let us mark @xmath239 ( which is ideally zero ) .",
    "an analytical integration is possible and leads to the relation @xmath240 this means @xmath241 where in the last formwe went back to the original definition of @xmath242 .",
    "the amplitude @xmath224 was was derived above , @xmath243 for the ideal case @xmath244 and @xmath245 we get @xmath246    to find the multiplication probability , we evaluate the photon number on side @xmath36 .",
    "this means evaluating @xmath247 the trick here is to insert a single-@xmath36-side - photon state in between the two operators ( based on the same observation as made when calculating eq .",
    "[ [ eq : othercontribution ] ) ] , @xmath248 which means that the photon number has the form @xmath249 here @xmath250 was defined to be the same as @xmath224 but without the delta - function , eq .",
    "( [ eq : bara ] ) .",
    "the intgration is over a product of two lorenzian functions and can again be performed analytically .",
    "for the ideal case @xmath244 and @xmath245 we get @xmath251 which is the final result .",
    "let us discuss now how the previous derivation is modified in the case of general @xmath0 .",
    "in this situation , eq .",
    "( [ eq : general2 ] ) gets generalized to @xmath252 identical contributions , leading to the leading - order amplitude @xmath253    eq .  ( [ eq : general1 ] ) includes a factor @xmath0 instead of the factor 2 . applying this equation to solve eq .",
    "( [ eq : generalization2 ] ) , we get a higher - order contribution in @xmath254 only when the last of the creations by @xmath255 is replaced by @xmath256 . the other terms ( on the right - hand side of this )",
    "contribute with the zeroth - order term , @xmath257 .",
    "this leads to the general form of the function @xmath258    eq .",
    "( [ eq : othercontribution ] ) is then again a product of two amplitudes .",
    "the left - hand side amplitude is proportional to @xmath227 and the right - hand side amplitude measures scattering of @xmath259 incoming photons from side @xmath36 .",
    "the ( left - hand side ) factor @xmath227 has now been evaluated with repect to final state @xmath260 .",
    "again , @xmath259 incoming photon from side @xmath36 has no change but to reflect at the junction in a way described by the solution for @xmath234 .",
    "we can then evaluate the ( right - hand side ) expectation value @xmath261 by using the relation between @xmath262 and @xmath263 obtained for @xmath264 ( section  [ sec : uncoupledmodes ] ) , which gives @xmath265 and @xmath266 in the ( left - hand side ) matrix element corresponding to amplitude @xmath227 .",
    "the last step is then to evaluate the integral @xmath267 the evaluation can again be done analytically and gives the result @xmath268 this leads us to the result in the ideal case @xmath245 , @xmath269 , @xmath270 in the more general form we have @xmath271    the photon number on side @xmath36 is evaluated similarly as in the case @xmath211 , by inserting a state @xmath272 between the oprators in the expectation value of eq .",
    "( [ eq : generalisationprobability0 ] ) .",
    "the result for the photon number on side @xmath36 for general @xmath0 agrees with the result from the linearization method described below .",
    "if we are only interested in the probability of multiplication , and not in the exact form of the frequency correlations , we can solve the problem straightforwardly with proper linearization approach .",
    "the results derived here agree with the scattering - matrix approach introduced in section  [ sec : scatteringmatrix ] , which is also able to capture the frequency correlations .",
    "consider first the case @xmath274 ( @xmath273 ) , i.e. , when resonator @xmath37 is decoupled from resonator @xmath36 .",
    "considering incoming radiation from the transmission line @xmath37 , we only need to solve the equation @xmath275 a fourier transformation gives @xmath276 the solution for the resonator field is then @xmath277 whereas the out - field has the form @xmath278 similar relations are also valid for the propagating fields in the transmission line @xmath36 .",
    "this result states that all incoming radiation will be reflected with a specific phase shift . at resonance ( @xmath279 )",
    "we have @xmath280 , which means that in the relation @xmath281 the contribution from the cavity is exactly twice the incoming field . on the other hand , in the case @xmath282",
    ", we aim for the opposite situation , where these two contributions cancel each other and there will be no reflection .",
    "note that in the original definition of the annihilation and creation operators we have a minus sign difference between the in- and out - fields ( see sec .",
    "[ sec : heisenberg ] ) .",
    "this means that we actually have a `` @xmath283-shift '' in the amplitude when @xmath279 . in our system",
    ", the phase shift plays no role on the described effects .",
    "however , this can play an important role in other systems , for example in a microwave reflection on a transmon qubit connected to two semi - infinite transmission lines  [ ] .",
    "we consider now the case @xmath282 but @xmath77 , which also allows for straightforward analytical solution .",
    "after fourier transformation our equations get the form @xmath284 a solution is @xmath285=\\sqrt{\\gamma_b}\\hat b_{\\rm in}(\\omega)+\\frac{\\bar\\epsilon\\sqrt{\\gamma_a}\\hat a_{\\rm in}(\\omega-\\omega_{\\rm j})}{i(\\omega_a-\\omega+\\omega_{\\rm j})+\\frac{\\gamma_a}{2}}.\\ ] ] we assume now that there is no input from side @xmath36 . in this case",
    ", the outgoing photon flux to side @xmath36 can be deduced from @xmath286 where make use of the fact that for a single - photon input only @xmath287 contributes . for the following formulas , we make the shift @xmath288 .",
    "we then obtain the transmission probability @xmath289 when @xmath279 and @xmath290 , we obtain @xmath291 where @xmath292 .",
    "perfect conversion occurs when @xmath293 .",
    "this demonstartes that a josephson junction can also be used for bare frequency conversion ( @xmath77 ) .",
    "when @xmath279 and @xmath294 ( describing the effect of bias voltage offset ) , we obtain @xmath295 we see that voltage offset decreases the conversion probability . in the case",
    "@xmath293 we have @xmath296 .",
    "consider photon multiplication by a factor @xmath297 .",
    "we make now an important observation : in the case of single incoming photon , the resonators can be analytically treated as two - level systems .",
    "the reason is that when the photon number of resonator @xmath36 drops from @xmath0 to @xmath259 , there is no way for the resonator @xmath37 to be repopulated : the remaining @xmath259 photons in resonator @xmath36 will inevitable be dissipated in the transmission line @xmath36 .",
    "the effective decay rate of the excited state of the two - level system @xmath36 is then the one from the state @xmath0 to the state @xmath259 , that is @xmath298 .",
    "similarly , the effective coupling between the two - level systems is @xmath299 .",
    "the final equations of motion are linear and the above solution is valid .",
    "the photon multiplication probability is then @xmath300 where @xmath301 is evaluated using the decay @xmath298 . in the ideal case @xmath279 , @xmath290 we get @xmath302    for a general bias voltage offset @xmath108 ( see above ) we get @xmath303 in the case @xmath293 we have @xmath304 .",
    "the input bandwidth of the multiplier can be deduced by setting @xmath305 and @xmath294 .",
    "this gives @xmath306 in the case @xmath307 we get @xmath308 where we defined @xmath309 and assumed @xmath310 .",
    "the limiting cases are @xmath311 for @xmath77 and @xmath312 for large @xmath0 . the full width at half maximum changes here from @xmath109 ( @xmath77 ) to @xmath313 ( @xmath314 ) .",
    "in this section , we generalize the hamiltonian of the josephson junction to also to account for multi - photon populations in the resonator @xmath37 , and show how to model the resulting resonator dynamics within density - matrix formalism in the case of an incoming coherent state . after this",
    "additional numerical results on photon multiplication properties in alternative parameter regimes are shown .",
    "the general form of the josephson hamiltonian can be deduced from the following form of the matrix elements between resonator fock states , @xmath315 where @xmath316 is the laguerre polynomial . we apply this for the josephson hamiltonian @xmath317 $ ] assuming @xmath318 and using the rotating - wave approximation .",
    "this gives @xmath319 where the @xmath320 refers to the fock state @xmath0 of resonator @xmath26 and @xmath321      a coherent state as an input state appears as a complex number in the heisenberg equations for averages . from these equations",
    "we can then deduce the equivalent lindblad - type master equation .",
    "for example , if we assume an incoming coherent state in the transmission line @xmath37 and write @xmath322 , by taking expectation value over the initial ( product ) state ( in the far past ) , we get the equations of motion for the expectation values @xmath323 similarly , we can construct equations of motion for averages of operators @xmath324 , @xmath325 , and so on .    from equations of motion for averages , we can deduce the equivalent lindblad - type master equation . in this formulation , we have a total hamiltonian @xmath326 , where the incoming radiation from side @xmath37 takes the form of a classical drive , @xmath327 the final equation of motion has the form @xmath328+{\\cal l}_a[\\hat \\rho]+{\\cal l}_b[\\hat \\rho],\\ ] ] where @xmath329 is the full two - oscillator density matrix and the lindblad super - operator @xmath330 describes decay of field of the oscillator @xmath37 to the left - hand side transmission line , defined as @xmath331=\\frac{\\gamma_a}{2}\\left ( 2\\hat a \\rho \\hat a^\\dagger -\\hat a^\\dagger \\hat a \\rho-\\rho\\hat a^\\dagger \\hat a \\right),\\ ] ] and similarly for @xmath332 $ ] .       for @xmath74 as a function of cavity decay rate @xmath65 and average input photon number @xmath66 when biased at the photon - tripling resonance ( @xmath67 ) .",
    "we have @xmath333 and @xmath334 .",
    "( b ) : the average number of created photons in the same simulation .",
    ", title=\"fig : \" ]   for @xmath74 as a function of cavity decay rate @xmath65 and average input photon number @xmath66 when biased at the photon - tripling resonance ( @xmath67 ) .",
    "we have @xmath333 and @xmath334 .",
    "( b ) : the average number of created photons in the same simulation .",
    ", title=\"fig : \" ] ( -30 , 165)@xmath335 ( -265 , 165)@xmath336 ( -215 , 180)*(b ) * ( -445 , 180)*(a ) * ( -470 , 65 ) ( -170 , -10)decay rate ( @xmath72 ) ( -405 , -10)decay rate ( @xmath72 )    here , we analyze further numerical results obtained by using the master - equation approach . we consider first replotting the data of fig .  2 in the main part of the article , in the supplemental material shown as fig .",
    "[ fig : figurenumber1](a ) , in a way where the actual number of created photons is explicit , see fig .",
    "[ fig : figurenumber1](b ) .",
    "in detail , we find that two input photons and three times larger second - stage bandwidth ( @xmath337 ) produce on average @xmath338 photons .",
    "the outgoing wavepacket has in a good approximation the same form as the incoming one ( not plotted ) .",
    "we can then estimate the effect of a third multiplication within the same plot by using the input @xmath339 . using the same bandwidth",
    "raises the average photon beyond @xmath340 .    in fig .",
    "[ fig : figurenumber2](a ) , we plot the multiplication efficiency by reducing @xmath341 and keeping @xmath342 .",
    "we find that the multiplication efficiency gets better for larger input numbers , which is naturally a very positive result .",
    "however , to achieve @xmath90 , the tradeoff is that here we need larger @xmath5 , and this increases the emission without input roughly by a factor @xmath343 , see section  [ sec : emissionwithoutinput ] .",
    "furthermore , by increasing @xmath344 and keeping @xmath345 , we find even better multiplication efficiency ( not plotted ) and at the same time reduced spurious emission if compared to @xmath345 and @xmath342 .",
    "understanding physics in this ( experimentally more challenging ) parameter range is very interesting for further theoretical work .     for @xmath345 and @xmath342 as a function of cavity decay rate @xmath65 and average input photon number @xmath66 when biased at the photon - tripling resonance ( @xmath67 ) .",
    "we have @xmath333 and @xmath346 .",
    "the multiplication of higher photon numbers is better than for @xmath74 .",
    "the tradeoff of is stronger emission without input .",
    "( b ) : the multiplication factor when the resonator coupling @xmath41 is tuned away from @xmath73 for @xmath74 .",
    "the maximal efficiency is here close to @xmath90 also for increased photon number , but can be enhanced by properly tuning @xmath41 ( @xmath5 ) .",
    ", title=\"fig : \" ]   for @xmath345 and @xmath342 as a function of cavity decay rate @xmath65 and average input photon number @xmath66 when biased at the photon - tripling resonance ( @xmath67 ) .",
    "we have @xmath333 and @xmath346 .",
    "the multiplication of higher photon numbers is better than for @xmath74 .",
    "the tradeoff of is stronger emission without input .",
    "( b ) : the multiplication factor when the resonator coupling @xmath41 is tuned away from @xmath73 for @xmath74 .",
    "the maximal efficiency is here close to @xmath90 also for increased photon number , but can be enhanced by properly tuning @xmath41 ( @xmath5 ) .",
    ", title=\"fig : \" ] ( -225 , 180)*(b ) * ( -455 , 180)*(a ) * ( -45 , 170)@xmath336 ( -280 , 170)@xmath336 ( -480 , 65 ) ( -185 , -10)coupling ( @xmath347 ) ( -420 , -10)decay rate ( @xmath72 )    in fig .  [ fig : figurenumber2](b ) , we study the the multiplication efficiency as a function of resonator coupling @xmath347 .",
    "the simulations are made again with @xmath348 .",
    "we modify @xmath349 around the optimal value 1 , which corresponds to @xmath350 .",
    "bandwidths are kept constant , so we are basically tuning only @xmath5 .",
    "we see that the optimal value for @xmath351 stays surprisingly close to @xmath352 also for increased photon numbers . here , slight increase of @xmath351 can be used to slighty increase the multiplication efficiency for larger average photon numbers .",
    "our photo multiplier can be transformed into a single photon detector by placing a quantum limited ( phase preserving ) amplifier at the output of the photo - multiplier .",
    "the output of a phase - preserving quantum limited amplifier is the scaled husimi @xmath353 function of its input  @xcite : @xmath354 when the amplifier gain @xmath355 is large , so that commutators at the output can be neglected , @xmath356 directly describes the classical probability density to observe a classical complex amplitude @xmath357 at the output .    for a single - photon input of the photomultiplier with gain @xmath0",
    "we get a @xmath0 photon fock state at the input of the amplifier , with a husimi function @xmath358 independent of the phase of @xmath357 . in order to read the output of the photo - multiplier",
    "we detect ( or calculate ) the output power @xmath359 .",
    "we suppose here that the amplifier has the same bandwidth as the photo - multiplier , @xmath109 , or that it has a wider bandwidth but only the output power in the output bandwidth of the photo - multiplier is considered . in order to make the following calculations independent of the gain of the amplifier",
    ", we consider the average input photon number per bandwidth @xmath360 , calculated from the classical output amplitude  @xmath357 .",
    "the distribution @xmath361 of measured effective photon number @xmath362 for @xmath0 photon input to the amplifier is : @xmath363    in order to discriminate between a photon and no - photon , we set a threshold @xmath80 , with lower powers being interpreted as no click  and higher powers as click .",
    "the probability to get a false click during an inverse bandwidth is : @xmath364 and the probability to miss a @xmath0-photon fock state at the input of the amplifier is @xmath365 the resulting dark - count probability and the probability of missed photon as a function of chosen threshold are plotted in the main part of the article , in fig .",
    "in this section , we decribe in more detail our theory that estimates the effect of finite temperature to conversion probability and photon emission rate in the absence of input radiation ( spontaneous emission ) .",
    "we assume that the voltage fluctuations manifest themselves by a low - frequency drifting of the junction voltage . to study the effect of the fluctuations , we first solve the steady state conversion for @xmath366 ( keeping @xmath40 ) .",
    "such a conversion is described by a lorentzian , eq .",
    "( [ eq : transmissiongeneral ] ) , relating the incoming and outgoing photon fluxes , @xmath367 where @xmath368 .",
    "on the other hand , the probability distribution of the values for fluctuating voltage , which we call @xmath369 , is in a good aproximation a lorentzian with linewidth @xmath370 , where @xmath371 is the low - frequency impedance , @xmath372 this can be derived , for example , by applying the so - called @xmath373-theory for a low - ohmic environment  @xcite .        the result of eqs .",
    "( [ eq : transmission1]-[eq : transmission2 ] ) implies that any photon number @xmath0 can be generated from a single - photon input by correctly tuning @xmath78 .",
    "however , terms beyond the rotating - wave approximation have been neglected and need to be considered carefully .",
    "it turns out that strong higher - order processes practically demand strong couplings @xmath375 , as expected . in a typical experiment",
    "we have @xmath376 and multi - photon emission is weak  @xcite .",
    "presently , values @xmath377 and slightly beyond can be achieved , for example , by building resonators from high kinetic inductance materials or josephson junction arrays  @xcite .    if we consider the experimentally feasible situation @xmath102 and choose @xmath378 , for a reflectionless multiplication with @xmath0 we need a josephson coupling energy @xmath379 where @xmath380 accounts for the renormalization of @xmath5 .",
    "we see that the value for @xmath5 increases rapidly with  @xmath0 , the first right - hand side numbers being @xmath381 . two important effects increase with @xmath5 due to non - rwa terms : ( i ) emission without incoming radiation and ( ii ) reflection of incoming radiation .",
    "the most dangerous effect from terms beyond the rotating - wave approximation is the emission without incoming microwave radiation . assuming that this effect is weak",
    ", we can estimate the photon flux density by using the perturbative method developed in refs .",
    "this gives for the photon flux density @xmath382}{2\\omega}p\\left [ \\hbar(\\pm\\omega_{\\rm j}-\\omega )   \\right].\\ ] ] here the probability density @xmath373 has the form  @xcite @xmath383 where the phase - correlation function depends on the impedance seen by the tunnel junction , @xmath384 , as @xmath385\\hat \\phi_0(0)\\right\\rangle\\\\ \\left\\langle\\hat \\phi_0(t)\\hat \\phi_0(t')\\right\\rangle&= & 2\\int_{-\\infty}^{\\infty } \\frac{d\\omega}{\\omega }   \\frac { { \\rm re}[z_{\\rm t}(\\omega ) ] } { r_{\\rm q}}\\frac{e^{-i\\omega(t - t')}}{1-e^{-\\beta\\hbar\\omega}}.\\end{aligned}\\ ] ] the two signs in eq .",
    "( [ eq : peflux1 ] ) correspond to forward ( + ) and backward ( - ) cooper - pair tunneling events .",
    "this is an optimal way of determining emission flux in the weak perturbation limit , i.e. , when the emission rate is much smaller than the resonator decay rates .",
    "similarly , the photon flux in the presence of a coherent input can be deduced to be @xmath386}{2\\omega}p\\left [ \\hbar(\\pm\\omega_{\\rm j}-\\omega+m\\omega_0 )   \\right ] \\vert j_m ( a ) \\vert^2 .\\ ] ] photons can be absorbed from ( @xmath387 ) or emitted into ( @xmath388 ) the drive beam .",
    "the dimensionless amplitude @xmath37 characterizes phase fluctuations induced by the drive at frequency @xmath389 .",
    "this function will only be used here to visualize the strentgh of the conversion rate versus the emission without input rate .    as environmental ( tunnel ) impedance we consider an impedance with lorentzian resonance at frequency @xmath4 @xmath390= \\frac{1}{c}\\frac{\\gamma_b}{1 + 4(\\omega-\\omega_b)^2\\gamma_b^2}\\approx \\frac{\\pi}{2 c}\\delta(\\omega-\\omega_b).\\ ] ] at zero temperature and in the limit @xmath391 this leds to  @xcite @xmath392 we have defined here @xmath393 .",
    "the connection to the previously used parameters is @xmath394    for a finite linewidth of the mode , the resulting @xmath373-function broadens accordingly , @xmath395 similarly , we will superpose this ( real part of the ) impedance by another lorentzian peak , this time at frequency @xmath159 , describing resonator @xmath37 .    using above formulas",
    ", we can derive first a rough estimate for the photon flux density in the absence of input radiation , which implies its tendency as a function of resonator parameters .",
    "an accurate estimate for the photon flux density has to be done by evaluating the photon flux density numerically .    )",
    "using @xmath396 , @xmath397 , @xmath398 , and emission photon flux density in the absence of input radiation [ bottom , eq .",
    "( [ eq : peflux1 ] ) ] , with ( right ) and without ( left ) an anti - resonance ( ar ) .",
    "we use the same normalization in all the plots .",
    "we consider the case of producing @xmath399  ghz photons from a single @xmath400  ghz photon with @xmath401  ghz , and an ar at @xmath402  ghz .",
    "the presence of the ar does not affect to conversion , but reduces the emission without input roughly by an order of magnitude .",
    "the total photon flux , presented in the main part of the article , is the integrated flux density between @xmath403  ghz .",
    "we assume a temperature @xmath88  mk and a add the resonator impedances to ohmic resistance @xmath404  @xmath87 with cut - off defined by @xmath405  pf . ]",
    "the first observation we make is that the emission rate is proportional to @xmath406 , which implies that we should minimize @xmath5 to minimize spurious emission .",
    "this occurs when @xmath407 and @xmath408 ( keeping @xmath73 ) .",
    "this is probably close to the most optimal situation when all terms beyond the rotating - wave approximation are accounted for .",
    "however , when studying barely the spontaneous emission rates , from eq .",
    "( [ eq : petheory ] ) we learn that @xmath373 is actually proportional to @xmath409 , which cancels the same term appearing in the formula for @xmath410 .",
    "furthermore , if we assume that the leakage process involves emission of one photon to resonator @xmath36 and one photon to frequency @xmath411 , we get an additional proportionality to @xmath412 .",
    "this implies for the total photon flux at frequency @xmath4 ( within certain bandwidth ) behaves as @xmath413 assuming that at frequency @xmath411 the impedance contributes with a real number @xmath414 , and using the approximation @xmath415 in this region , where @xmath416 , we obtain the photon flux @xmath417 eq .",
    "( [ eq : estimate ] ) is an estimate how the decay rate behaves as a function of couplings @xmath418 and decays @xmath109 .",
    "the impedance @xmath414 at frequency @xmath411 depends on the realization .",
    "the equation implies that having @xmath419 , the rate vanishes completely .",
    "this is not true , because the energy @xmath420 can also be dissipated in the form of two photons at other frequencies .",
    "we , therefore , have to rely on numerical simulations .    to analyze the effect of anti - resonances , which can used to reduce emission without input , we modify the impedance @xmath421 $ ] to @xmath422\\rightarrow { \\rm re}[z_{\\rm t}(\\omega)]\\times\\left[1- e^{(\\omega-\\omega_{\\rm ar})^2/2\\delta^2 } \\right].\\end{aligned}\\ ] ] in the numerical simulations we use width @xmath423  ghz . in the case of producing @xmath424  ghz photons from a single @xmath425  ghz photon",
    "we have @xmath426  ghz and we use an anti - resonance at @xmath427  ghz . in the case of producing @xmath399  ghz photons from a single @xmath400",
    "ghz photon we have @xmath401  ghz and we use an anti - resonance at @xmath428  ghz . in the case of producing @xmath429  ghz photons from a single @xmath338  ghz photon",
    "we have @xmath430  ghz .",
    "here we need to use two anti - resonances , the first one at @xmath431  ghz and the second one at @xmath432  ghz .    at the same time , we verify that the perturbative result for the conversion rate is not changed due to anti - resonances in the environmental impedance .",
    "an example of the obained photon flux densities is shown in fig .",
    "[ fig : emission1 ] ."
  ],
  "abstract_text": [
    "<S> the interaction between propagating microwave fields and cooper - pair tunneling across a dc voltage - biased josephson junction can be highly nonlinear . </S>",
    "<S> we show theoretically that this nonlinearity can be used to convert an incoming single microwave photon into an outgoing @xmath0-photon fock state in a different mode . in this process the coulomb energy released by cooper - pair tunneling is transferred to the outgoing fock state , providing energy gain . </S>",
    "<S> the conversion can be made reflectionless ( impedance - matched ) so that all incoming photons are converted to @xmath0-photon states . </S>",
    "<S> with realistic parameters multiplication ratios @xmath1 can be reached . by cascading two to three such multiplication stages , the outgoing fock - states can be sufficiently large to accurately discriminate them from vacuum with linear post - amplification and classical power measurement , implying that our scheme can be used as single - photon detector for itinerant microwave photons without dead time .    </S>",
    "<S> _ introduction _ : the ability to measure light at the single or few - photon level is a key ingredient of most quantum systems in the optical or the microwave domain . in the optical domain , </S>",
    "<S> single - photon detectors ( spd ) based on avalanche photo diodes or superconducting nanowires are available and allow to work with very low average photon rates . </S>",
    "<S> they are the workhorse of most quantum optics experiments and fundamental research methods , such as quantum state tomography  [ ] . </S>",
    "<S> together with the creation of nonclassical light they can also be used for quantum communication  [ ] and optical quantum computing  [ ] .    in the microwave domain , </S>",
    "<S> inspite of important theoretical and experimental developments  [ ] a true spd of itinerant microwaves has not yet been realized . </S>",
    "<S> instead readout of quantum devices relies on linear parametric amplifiers with noise levels very close to the standard quantum limit of @xmath2photons . </S>",
    "<S> they have allowed for the development of the field of circuit quantum electrodynamics  [ ] . </S>",
    "<S> however their use for fields with photon rates less than 1 photon @xmath3 bandwidth implies averaging over long times in order to beat the small signal to noise ratio . a true microwave spd would therefore allow for a host of new possibilites .    </S>",
    "<S> we propose building such a device based on inelastic charge tunneling  [ ] . </S>",
    "<S> the technological progress in microwave control and detection schemes based on linear amplifiers has allowed not to only address charge transport but also the associated generation of quantum microwaves  [ ] . </S>",
    "<S> it has been demonstrated that a josephson junction , embedded in a superconducting microwave circuit , exhibits a very non - linear light - charge interaction . </S>",
    "<S> this is a diverse source of unconventional optoelectronic phenomena , such as production of antibunched photons  [ ] , nonclassical photon pairs  [ ] , multi - photon fock states  [ ] , and cavity squeezing and multi - stability  [ ] , without an external microwave drive .     and @xmath4 , and a josephson junction with coupling energy @xmath5 . </S>",
    "<S> when impedance matched , an incoming photon of frequency @xmath6 deterministically converts into @xmath0 outgoing photons of average frequency @xmath7 . </S>",
    "<S> ( b ) : the energy diagram of photon tripling with slight frequency down - conversion . </S>",
    "<S> energy is absorbed from the cooper - pair tunneling event , @xmath8 . </S>",
    "<S> generally , it is possible to up - convert ( @xmath9 ) and down - convert ( @xmath10 ) incoming microwave photons . ]    in this paper , we show theoretically how inelastic cooper - pair tunneling across a voltage - biased josephson junction multiplies propagating microwave photons . </S>",
    "<S> we consider the microwave circuit depicted in fig .  </S>",
    "<S> [ fig : figure1 ] , including two resonators connected by a josephson junction . incoming photons from the left - hand side transmission line interact with the josephson junction , which creates a reflected field to the left and a converted field to the right of the josephson junction . </S>",
    "<S> we find an impedance matched situation , where a single incoming photon deterministically converts into an outgoing multi - photon fock state . </S>",
    "<S> the coulomb energy released in the simultaneous cooper - pair tunneling event , @xmath11 , is absorbed by the creation of @xmath0 photons , @xmath12 and therefore allows for energy gain in this conversion process , i.e. the outgoing photons can have an average frequency close to the incoming one or even higher .    </S>",
    "<S> we find that in an experimentally feasible setup several photons can be created from a single - photon input . </S>",
    "<S> an efficient photon - number amplification is also possible for a multi - photon input , allowing for cascaded amplification in a setup similar to a photomultiplier tube in the optical domain . </S>",
    "<S> we show that it is realistic to create enough photons in two or three multiplication stages for a single microwave photon to be detected with a high fidelity via subsequent linear detection . </S>",
    "<S> this scheme of microwave photodetection is qualitatively different from other recent proposals , including single - photon absorption in a phase - qubit type system  [ ] , in a lambda - type system  [ ] , or in a driven three - level system  [ ] . here </S>",
    "<S> , the photodetection occurs through direct field amplification and does not include transitions in an artificial atom . the device is then expected to detect photons without any dark time , work with large detection bandwidths and also up to very high microwave frequencies , limited only by the superconducting energy gap .    </S>",
    "<S> _ model : _ the semi - infinite transmission lines ( tl ) are connected to two resonators ( see fig .  [ </S>",
    "<S> fig : figure1 ] ) , which impose boundary conditions  [ ] @xmath13 the photon annihilation ( creation ) operator @xmath14 corresponds to the standard description of the local field in the left - hand side resonator and @xmath15 in the right - hand side resonator . </S>",
    "<S> we have @xmath16=1 $ ] and @xmath17=1 $ ] , other cavity commutators vanish . the operator @xmath18 annihilates ( creates ) an incoming left - hand side tl photon at time @xmath19 . </S>",
    "<S> we have @xmath20=\\delta(t - t')$ ] and similarly for the out - field operators @xmath21 and operators @xmath22 . </S>",
    "<S> these are connected to operators of fixed frequencies as @xmath23 , which satisfy @xmath24=\\delta(\\omega-\\omega')$ ]  [ ] . </S>",
    "<S> the decay rate @xmath25 of the cavity field in the corresponding tl defines the bandwidth of the resonator @xmath26 .    </S>",
    "<S> the field operators additionally follow the heisenberg equations of motion  [ ] @xmath27   - \\frac{\\gamma_a}{2}\\hat a(t)+\\sqrt{\\gamma_a}\\hat a_{\\rm in}(t)\\\\ \\dot{\\hat b}(t)&= &   \\frac{i}{\\hbar}\\left[h_0+h_{\\rm j } , \\hat b(t)\\right ]   - \\frac{\\gamma_b}{2}\\hat </S>",
    "<S> b(t)+\\sqrt{\\gamma_b}\\hat b_{\\rm in}(t).\\end{aligned}\\ ] ] here @xmath28 is the resonator hamiltonian . </S>",
    "<S> the interaction between them is provided by the josephson hamiltonian , @xmath29,\\ ] ] where the josephson frequency @xmath30 accounts for the dc voltage bias and the dimensionless coupling @xmath31 compares the characteristic impedance of the resonator @xmath26 to the resistance quantum @xmath32 .    </S>",
    "<S> _ single - photon input : _ for a single - photon input at frequency @xmath33 , and for voltage bias @xmath34 , we can simplify the josephson hamiltonian by taking the rotating - wave approximation ( the effect of neglected terms is analyzed below in the section `` imperfections '' ) , @xmath35 this creates @xmath0 photons to oscillator @xmath36 from a single photon in oscillator @xmath37 , and vice versa . </S>",
    "<S> the amplitude of this process is @xmath38 here , we can straightforwardly solve the @xmath0-photon scattering element analytically . </S>",
    "<S> using an input - output approach similar to developed in ref .  </S>",
    "<S> [ ] , we obtain  [ ] @xmath39 the expectation value is taken with respect to the vacuum and , for simplicity , we assume @xmath40 ( more general formula is given in the supplemental material ) . the normalized and dimensionless amplitude @xmath41 has the form @xmath42 and the functions @xmath43 , @xmath44 , describe the effect of the resonator bandwidths . </S>",
    "<S> we find that the created @xmath0-photon state is entangled in frequency : it is the superposition of all possible out - field frequency combinations that sum up to @xmath45 . </S>",
    "<S> this type of correlations are nonclassical and , for example , can violate a bell inequality for the position and time  [ ] . by fourier transforming one obtains the shape of the multi - photon fock state in the time domain  [ ] . in case of a two - photon state one gets @xmath46 . for a narrow input frequency but wide @xmath47 </S>",
    "<S> the output is highly bunched .    </S>",
    "<S> the average number of outwards propagating photons on side @xmath36 can be solved analytically by using the scattering matrix or by a direct linearization of the problem  [ ] . </S>",
    "<S> we get ( assuming @xmath40 ) @xmath48 one sees that when @xmath49 or @xmath50 , the incoming field is totally reflected ( @xmath51 ) . when @xmath52 , the incoming photon is perfectly converted ( @xmath53 ) . </S>",
    "<S> this reflectionless multiplication corresponds to @xmath54 this central result states that , irrespective of the resonator quality factors , one can always achieve a perfect photon multiplication if @xmath5 is chosen correctly . </S>",
    "<S> this is an important result for an experimental realization , since when the josephson junction is realized in a squid geometry , the josephson coupling can be tuned externally to the optimal value via an applied magnetic field .    </S>",
    "<S> _ multi - photon input _ : we now assess whether several multiplication stages can be cascaded . for this </S>",
    "<S> we determine how the multiplier handles input signals with higher photon numbers , generated by preceding stages .    for a multi - photon input </S>",
    "<S> the hamiltonian under the rotating - wave approximation is generalized to  [ ] @xmath55 where @xmath56 and @xmath57 is the generalized laguerre polynomial . </S>",
    "<S> the hamiltonian of eq .  </S>",
    "<S> ( [ eq : interactionhamiltonian ] ) is obtained within the approximation @xmath58 , which is exact if @xmath59 ( single - photon input ) , whereas for @xmath60 corrections are essential  [ ] .    to simplify the problem , we approximate the secondary input by an appropriate coherent - state pulse . </S>",
    "<S> this allows for a master - equation type model for the dynamics of the resonator fields  [ ] . to qualitatively describe the bunching of converted photons in the time domain ( see `` single - photon input '' ) , we choose a coherent - state pulse with the waveform @xmath61 . \\end{aligned}\\ ] ] the pulse has on average @xmath62 photons and at time @xmath63 the peak of the wavepacket reaches the resonator  @xmath37 . </S>",
    "<S> the width is defined by the primary - input cavity @xmath36 decay , @xmath64 .     as a function of cavity decay rate @xmath65 and average input photon number @xmath66 when biased at the photon - tripling resonance ( @xmath67 ) . </S>",
    "<S> we consider an incoming coherent pulse of width @xmath68 with waveform of eq .  </S>",
    "<S> ( [ eq : coherentpulse ] ) . </S>",
    "<S> the perfect conversion occurs in the limit @xmath69 , where @xmath70 . </S>",
    "<S> , title=\"fig : \" ] ( -45 , 160)@xmath71 ( -237 , 59 ) ( -180 , -10)decay rate ( @xmath72 )    in fig .  </S>",
    "<S> [ fig : figure2 ] , we plot the photon - number multiplication @xmath71 as a function of identical ( second - state ) resonator bandwidths @xmath65 and the incoming photon number @xmath66 , in the case @xmath67 , @xmath73 ( reflectionless single - photon multiplication ) , and @xmath74 . </S>",
    "<S> the output photon number approaches @xmath75 when @xmath76 . </S>",
    "<S> we observe that increasing @xmath66 decreases the multiplication efficiency @xmath71 . in a linear system ( @xmath77 ) </S>",
    "<S> this is a constant for fixed @xmath72 . </S>",
    "<S> this reflects the fact that in the non - linear case the impedance matching depends on the photon numbers of the oscillators . </S>",
    "<S> increase in the decay rate @xmath65 increases amplification efficiency , since faster decay keeps the average cavity photon numbers closer to zero . </S>",
    "<S> we find practically a linear dependence between the number of incoming photons @xmath66 and secondary bandwidth @xmath72 , when the multiplication efficiency is kept constant ( solid contour lines ) . in additional simulations </S>",
    "<S> we find that tuning @xmath78 to higher values can increase the multiplication efficiency of high photon number pulses  [ ] . </S>",
    "<S> we expect that this increase is even more pronounced for fock states actually produced by previous stages </S>",
    "<S> . the multiplication efficiency can also be increased by decreasing the impedance of the input resonator ( @xmath79 )  [ ] , the tradeoff being higher rate for emission without input ( see `` imperfections '' ) . the estimate shown in fig .  </S>",
    "<S> [ fig : figure2 ] is therefore rather cautious .    </S>",
    "<S> we also find that the width of the outgoing pulse is approximately defined by @xmath68 . </S>",
    "<S> we conclude that a cascaded photon multiplication is most efficient when the bandwidth of subsequent amplification stages is gradually increased .    _ </S>",
    "<S> single - photon detection : _ this photomultiplier can be transformed into a single - photon detector by placing a quantum - limited ( phase - preserving ) amplifier at the output of the photomultiplier and measuring the instantaneous output power within the output bandwidth of the photomultiplier . in fig .  </S>",
    "<S> [ fig : darkrate ] , we plot the resulting dark - count probability and the probability of missed photons as a function of chosen threshold @xmath80 of photons per bandwidth and multiplication factor @xmath0  [ ] . </S>",
    "<S> we find that already for a multiplication ratio of @xmath81 we can obtain a quantum efficiency of approximately 0.9 for a dark count rate of @xmath82bandwidth . </S>",
    "<S> much lower dark - count rates for this photon number can be obtained if lower quantum efficiencies are sufficient . unlike existing designs  [ ] , such an amplifier can detect another photon immediately after a previous detection event . </S>",
    "<S> we also expect it to be able to resolve photon numbers , even though the efficiency will decrease with photon number .     </S>",
    "<S> photomultiplier . </S>",
    "<S> the error rates are plotted as a function of threshold @xmath80 of photons per bandwidth . the black line labeled </S>",
    "<S> @xmath83 indicates the dark - count probability ( false click ) within an inverse bandwidth . </S>",
    "<S> the lines labeled @xmath84 with @xmath85 show the probability of a @xmath84 state not triggering a click . ]    _ imperfections : _ the main degrading effects for single - photon detection are ( i ) reflection induced by junction voltage fluctuations and ( ii ) emission in the absence of input ( due to processes neglected in the rotating - wave approximation ) . </S>",
    "<S> the former effect can be estimated via quasistatic voltage fluctuations and the latter using a perturbative approach developed in refs .  </S>",
    "<S> [ ] .    </S>",
    "<S> the charge transport as well as finite temperature induce low - frequency voltage fluctuations in the biasing circuitry . for </S>",
    "<S> a low - ohmic tl the effect temperature is usually dominating  [ ] . for a @xmath86@xmath87 tl at @xmath88mk the fluctuations broaden the emission spectrum by @xmath89mhz .    the average induced single - photon reflection probability ( when @xmath90 , @xmath40 , and @xmath91 ) is estimated to be @xmath92  [ ] . therefore , to minimize the reflection due to low - frequency noise in the voltage </S>",
    "<S> , the resonator bandwidths should satisfy @xmath93 . </S>",
    "<S> the reflection decreases with increasing @xmath0 due to widening of the effective multi - photon resonance condition .    when biased @xmath94 , such as in the case of photon doubling with frequency down - conversion , radiation at the out resonance frequency @xmath95 without input photons can only arise from upward thermal fluctuations of the junction voltage . </S>",
    "<S> an example is creating @xmath96ghz photons from a single @xmath97ghz photon , where we find that even resonator bandwidths up to @xmath98mhz result in weak spurious emission rates ( @xmath99 with @xmath100mhz ) .    ) at out - frequency @xmath4 within bandwidth 1  </S>",
    "<S> ghz as a function of resonator bandwidths @xmath101 with ( solid lines ) and without ( dashed lines ) an anti - resonance ( ar ) in the impedance seen by the junction . </S>",
    "<S> we consider the case @xmath102 and a thermal broadening @xmath100mhz . for more details </S>",
    "<S> see  [ ] . ]    </S>",
    "<S> when biased @xmath103 , no thermal energy is needed to create radiation to @xmath7 , since zero - point fluctuations allow for spontaneous emission of one photon to oscillator @xmath36 and another photon to mode at @xmath104 of the relevant electromagnetic environment . </S>",
    "<S> we find that the rate of this process is approximately @xmath105 $ ]  [ ] . </S>",
    "<S> therefore , by increasing dimensionless coupling @xmath106 , we decrease spontaneous emission . </S>",
    "<S> however , values much higher than @xmath107 are experimentally challenging and therefore our analysis concentrates on the feasible case @xmath102 . the rates of these spontaneous emission events are also proportional to the real parts of the impedance at @xmath4 and @xmath108 , and can therefore be reduced by engineering an anti - resonance in the impedance at @xmath108 , as demonstrated below .    in fig .  </S>",
    "<S> [ fig : spontaneous ] , we plot the photon flux due to spontaneous emission in units of @xmath109 in several situations with @xmath110 . </S>",
    "<S> one scheme for cascaded photon multiplication is to perform two or three consecutive photon triplings , each with slight frequency down - conversion . </S>",
    "<S> an estimate for flux of spontaneous emission in each multiplication step is the process @xmath111 . </S>",
    "<S> we find that with single anti - resonance , the probability for spurious emission per bandwidth can be kept below @xmath112 ( @xmath113 ) when @xmath114mhz ( @xmath115mhz ) . </S>",
    "<S> an alternative cascasion scheme is to start with up - converting photon doubling and continue with two down - converting photon triplings . </S>",
    "<S> ( numerical analysis shows that photon tripling with up - conversion is rather noisy and should be avoided . ) in the considered case of strong up - conversion ( @xmath116ghz ) , the setup produces single photons spontaneously with probability @xmath117 per inverse bandwidth up to @xmath118mhz ( obtained using two anti - resonances ) . </S>",
    "<S> the following photon tripling can be made with stronger down - conversion ( here @xmath119ghz ) and thereby with lower noise . </S>",
    "<S> the cycle ends with another photon tripling ( @xmath120ghz ) . according to results presented in section `` multi - photon input '' , </S>",
    "<S> the two latter multiplications should be done with an increased bandwidth , such as @xmath121mhz for initial multiplication with @xmath122mhz . </S>",
    "<S> the most undesirable spontaneous emission is at the first amplification stage since it is followed by other amplifications . </S>",
    "<S> spontaneous emission at subsequent stages likely stays below the threshold of the power detection . keeping the first rate below the dark - count rate originating in the power detection </S>",
    "<S> , we achieve a situation where the dark - count rate is not limited by spontaneous emission .    </S>",
    "<S> _ summary : _ we have shown that inelastic cooper - pair tunneling can convert propagating single microwave photons to multi - photon fock states . in comparison to photon - number doubling in parametric down conversion  [ ] , the important difference , here , is that the energy absorbed from charge transport provides energy gain to the conversion process . </S>",
    "<S> the resulting fock states are frequency and time - bin entangled , an outcome which could be very relevant for quantum - information applications .    </S>",
    "<S> further , we have shown that it is possible to detect single propagating microwave photon through cascaded multiplication , followed by linear amplification and instantaneous power detection . </S>",
    "<S> this scheme for microwave photodetection allows detecting another photon immediately after the previous detection event . </S>",
    "<S> as the cut - off frequency in our scheme is limited , in principle , only by the superconduting energy gap , we expect that the photon multiplication can be realizable in a very broadband frequency range , extending from a few ghz up to a few 100ghz , depending on the material used . </S>",
    "<S> using a similar device backwards provides an engineered bath where multi - photon absorption is dominant . </S>",
    "<S> this is useful , for example , for cat codes  [ ] which encode a error - protected logical qubit in superpositions of coherent states .    </S>",
    "<S> jl and mm acknowledge financial support from dfg grant no .  </S>",
    "<S> ma 6334/3 - 1 . </S>",
    "<S> dh , sj , and mh acknowledge financial support from grenoble nanosciences foundation and from the european research council under the european union s seventh framework programme ( fp7/2007 - 2013 ) / erc grant agreement no 278203  wiqojo . </S>",
    "<S> gj acknowledges financial support from the swedish research council and the knut and alice wallenberg foundation </S>",
    "<S> .    99    a. i. lvovsky and m. g. raymer , rev . </S>",
    "<S> mod . </S>",
    "<S> phys . * 81 * , 299 ( 2009 ) .    </S>",
    "<S> d. f. walls and g.  j. milburn , _ quantum optics _ ( springer , berlin , 2008 ) .    </S>",
    "<S> n. gisin , g. ribordy , w. tittel , and h. zbinden , rev . </S>",
    "<S> mod . </S>",
    "<S> phys . * 74 * , 145 ( 2002 ) .    </S>",
    "<S> n. c. menicucci , p. van loock . </S>",
    "<S> m. gu , c. weedbrook , t. c. ralph , and m. a. nielsen , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 97 * , 110501 ( 2006 ) .    </S>",
    "<S> p. kok , w. j. munro , k. nemoto , t. c. ralph , j. p. dowling , and g. j. milburn , rev . </S>",
    "<S> mod . </S>",
    "<S> phys . * 79 * , 135 ( 2007 ) .    </S>",
    "<S> g. romero , j. j. garcia - ripoll , and e. solano , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 102 * , 173602 ( 2009 ) .    </S>",
    "<S> y .- f . </S>",
    "<S> chen , h. s. sendelbach , l. maurer , s. t. merkel , e , j. pritchett , f. k. wilhelm , and r. mcdermott , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 107 * , 217401 ( 2011 ) .    </S>",
    "<S> l. c. g. govia , e. j. pritchett , s. t. merkel , d. pineau , and f. wilhelm , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 86 * , 032311 ( 2012 ) .    </S>",
    "<S> s. r. sathyamoorthy , l. tornberg , a. f. kockum , b. q. baragiola , j. combes , c. m. wilson , t. m. stace , and g. johansson , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 112 * , 093601 ( 2014 ) .    </S>",
    "<S> k. koshino , k. inomata , z. lin , y. nakamura , and t. yamamoto , phys . </S>",
    "<S> rev . a * 91 * , 043805 ( 2015 ) .    </S>",
    "<S> k. inomata , z. lin , k. koshino , w. d. oliver , j .- s . </S>",
    "<S> tsai , t. yamamoto , y. nakamura , nature comm . * 7 * , 12303 ( 2016 ) .    </S>",
    "<S> o. kyriienko and a. s. sorensen , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . </S>",
    "<S> * 117 * , 140503 ( 2016 ) </S>",
    "<S> .    j.  clarke and f.  k.  wilhelm , nature ( london ) * 453 * , 1031 ( 2008 ) .    </S>",
    "<S> r.  j.  schoelkopf and s.  m.  girvin , nature ( london ) * 451 * , 664 ( 2008 ) .    </S>",
    "<S> m.  h.  devoret and r.  j.  schoelkopf , science * 339 * , 1169 ( 2013 ) .    </S>",
    "<S> g .- l .  </S>",
    "<S> ingold and yu .  </S>",
    "<S> v.  nazarov , in _ single charge tunneling : coulomb blockade phenomena in nanostructures _ , edited by h.  grabert and m.  h.  devoret ( plenum , new york , 1992 ) , p.21 .    </S>",
    "<S> m.  h.  devoret , d.  esteve , h.  grabert , g .- </S>",
    "<S> l .  </S>",
    "<S> ingold , h.  pothier , and c.  urbina , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 64 * , 1824 ( 1990 ) .    </S>",
    "<S> s. m. girvin , l. i. glazman , m. jonson , d. r. penn , and m. d. stiles , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 64 * , 3183 ( 1990 ) .    </S>",
    "<S> t.  holst , d.  esteve , c.  urbina , and m.  h.  devoret , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 73 * , 3455 ( 1994 ) .    </S>",
    "<S> j. leppkangas , e. thuneberg , r. lindell , and p. hakonen , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 74 * 054504 ( 2006 ) .    </S>",
    "<S> m.  hofheinz , f.  portier , q.  baudouin , p.  joyez , d.  vion , p.  bertet , p.  roche , and d.  esteve , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * </S>",
    "<S> 106 * , 217005 ( 2011 ) .    </S>",
    "<S> j .- c . </S>",
    "<S> forgues , c. lupien , and b. reulet , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 114 * , 130403 ( 2015 ) .    </S>",
    "<S> o .- p . </S>",
    "<S> saira , m. zgirski , k. l. viitanen , d. s. golubev , j. p. pekola , phys . </S>",
    "<S> rev . applied * 6 * , 024005 ( 2016 ) .    c. w. j. beenakker and h. schomerus , phys . </S>",
    "<S> rev . </S>",
    "<S> lett .  * 93 * 096801 ( 2004 ) .    </S>",
    "<S> j.  leppkangas , g.  johansson , m.  marthaler , and m. fogelstrm , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 110 * , 267004 ( 2013 ) .    </S>",
    "<S> j.  leppkangas , g.  johansson , m.  marthaler , and m. fogelstrm , new j.  phys .  </S>",
    "<S> * 16 * , 015015 ( 2014 ) .    </S>",
    "<S> m. trif and p. simon , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 92 * , 014503 ( 2015 ) .    </S>",
    "<S> o. parlavecchio , c. altimiras , j .- </S>",
    "<S> r . </S>",
    "<S> souquet , p. simon , i. safi , p. joyez , d. vion , p. roche , d. esteve , and f. portier , phys . </S>",
    "<S> rev . </S>",
    "<S> lett .  * 114 * 126801 ( 2015 ) .    </S>",
    "<S> f. qassemi , a. l. grimsmo , b. reulet , and a. blais , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 116 * 043602 ( 2009 ) .    </S>",
    "<S> f.  hassler and d.  otten , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 92 * , 195417 ( 2015 ) .    </S>",
    "<S> a. cottet , t. kontos , and b. doucot , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 91 * , 205417 ( 2015 ) </S>",
    "<S> .    j. jin , m. marthaler and g. schn , phys . rev . </S>",
    "<S> b * 91 * , 085421 ( 2015 ) .    </S>",
    "<S> j. jin , m. marthaler , p. q. jin , d. golubev and g schn new j. phys . * </S>",
    "<S> 15 * , 025044 ( 2013 ) .    </S>",
    "<S> j .- r . </S>",
    "<S> souquet , m.j . </S>",
    "<S> woolley , j. gabelli , p. simon , a. a. clerk , nature communications * 5 * , 5562 ( 2014 ) .    </S>",
    "<S> j.  leppkangas , m. fogelstrm , m.  marthaler , and g.  johansson , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 93 * 014506 ( 2016 ) .    </S>",
    "<S> j.  leppkangas , m. fogelstrm , a.  grimm , m.  hofheinz , m.  marthaler , and g.  johansson , phys . </S>",
    "<S> rev . </S>",
    "<S> lett .  * 115 * 027004 ( 2015 ) .    </S>",
    "<S> s. dambach , b. kubala , v. gramich , and j. ankerhold , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 92 * , 054508 ( 2015 ) .    </S>",
    "<S> j .- r . </S>",
    "<S> souquet and a. a. clerk , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 93 * , 060301(r ) ( 2016 ) .    </S>",
    "<S> m. marthaler , j. leppkangas , and j. h. cole , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 83 * , 180505(r ) ( 2011 ) .    a.  d.  armour , m.  p.  blencowe , e.  bahimi , a.  j.  rimberg , phys . </S>",
    "<S> rev . </S>",
    "<S> lett .  * 111 * 247001 ( 2013 ) .    </S>",
    "<S> v.  gramich , b.  kubala , s.  rocher , j.  ankerhold , phys . </S>",
    "<S> rev . </S>",
    "<S> lett .  * 111 * 247002 ( 2013 ) .    </S>",
    "<S> see the supplemental material for details .    </S>",
    "<S> r. loudon , _ the quantum theory of light _ ( oxford university , new york , 2010 ) .    s. fan s , s. e. kocabas , and j .- </S>",
    "<S> t . </S>",
    "<S> shen , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 82 * 063821 ( 2010 ) </S>",
    "<S> .    j. d. franson , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 62 * , 2205 ( 1989 ) .    </S>",
    "<S> a.  wnsche , quantum opt .  </S>",
    "<S> * 3 * , 359 ( 1991 ) .    </S>",
    "<S> n. ofek , a. petrenko , r. heeres , p. reinhold , z. leghtas , b. vlastakis , y. liu , l. frunzio , s. m. girvin , l. jiang , m. mirrahimi , m. h. devoret , and r. j. schoelkopf , nature * 536 * , 441 ( 2016 ) .    </S>",
    "<S> b. peropadre , j. lindkvist , i .- </S>",
    "<S> c . hoi , c. m. wilson , j. j. carcia - ripoll , p. delsing , and g. johansson , new j.  phys .  * 15 * , 035009 ( 2013 ) .    </S>",
    "<S> m. s. kim , phys . </S>",
    "<S> rev . </S>",
    "<S> a * 56 * , 3175 ( 1997 ) .    </S>",
    "<S> c. altimiras , o. parlavecchio , p. joyez , d. vion , p. roche , and f. portier , appl . </S>",
    "<S> phys . </S>",
    "<S> lett * 103 * , 212603 ( 2013 ) .    * supplemental material *    the supplemental material is organized as follows . in section  [ sec : heisenberg ] , we derive the heisenberg equations of motion used in the main part of the article . in section  [ sec : scatteringmatrix0 ] , we derive analytical expressions for the single - to - multiphoton scattering matrix and , by properly linearizing the problem , for the conversion probability . in section  [ sec : multiphotoninput ] , we derive the hamiltonian used in the case of a multi - photon input and establish the master - equation approach applicable for the specific case of a coherent - state input . also additional numerical results on photon multiplication properties </S>",
    "<S> are shown . in section  [ sec : </S>",
    "<S> postamplification ] , we discuss how multi - photon fock states can be detected using linear measurement . in section  [ sec : imperfections ] , we estimate the effect of finite temperature to conversion probability and photon emission rate in the absence of input radiation . </S>"
  ]
}