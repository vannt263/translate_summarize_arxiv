{
  "article_text": [
    "sinusitis , a disorder characterized by nasal inflammation , is one of the most commonly diagnosed diseases in the united states , affecting approximately @xmath1 of the adult population annually  @xcite .",
    "functional endoscopic sinus surgery ( fess ) is a minimally invasive surgical procedure used to relieve symptoms of chronic sinusitis .",
    "it is estimated that around @xmath2 endoscopic interventions are performed annually in the united states  @xcite .",
    "the sinuses are small , composed of delicate cartilage and surrounded by critical structures , such as the carotid artery and optic nerves .",
    "approximately @xmath3@xmath4 of endoscopic sinus procedures result in complications classified as minor , and about @xmath5 result in major complications  @xcite .",
    "the use of an accurate navigation system during fess can help reduce the rate of complications , and enhance patient safety , surgical efficiency , and outcome .",
    "the popularity of fess and its need for enhanced navigation have resulted in several video - ct registration algorithms .",
    "direct methods , such as that described in  @xcite , optimize over a similarity metric to match images obtained from endoscopic video and images rendered from ct data .",
    "tracker - based methods use optical or magnetic trackers to track the position of the endoscope relative to the patient .",
    "methods described in  @xcite track image features and reconstruct scaled 3d points from video using structure from motion ( sfm ) .",
    "these points are then registered to a pre - operative model shape extracted from ct .",
    "the standard algorithm for such registrations is the iterative closest point ( icp ) algorithm  @xcite .",
    "icp is a two - step algorithm , which first finds matches between two sets of points , and then computes the transformation that aligns these matches .",
    "these two steps are repeated until convergence .",
    "several variants of icp have been introduced , such as trimmed icp , which improves robustness in the presence of outliers  @xcite .",
    "@xcite presents a variant of trimmed icp that accounts for scale .",
    "probability - based variants with anisotropic noise models have also been introduced .",
    "for instance , the iterative most likely point ( imlp ) algorithm  @xcite incorporates a generalized noise model into both the registration and the correspondence steps .",
    "however , most of these algorithms are limited by the paucity of reliable , high - accuracy video features , resulting in sparse sfm reconstructions .",
    "this can cause registration algorithms to converge to inaccurate solutions .",
    "therefore , state of the art experimental navigation systems report registration errors of over @xmath0 mm , with commercial tracker - based systems reporting errors around @xmath6 mm .",
    "this hinders reliable navigation within the sinuses , where the thickness of the boundaries is generally less than @xmath0 mm , going as low as @xmath7 mm where the roof of the sinuses separates it from the brain , and @xmath8 mm where the lateral lamella separates it from the olfactory system  @xcite . by comparison",
    ", ct images can have resolutions of @xmath7 mm or less and , ideally , a navigation system should be as accurate as the underlying ct .",
    "we present the video iterative most likely oriented point ( v - imlop ) algorithm , which extends the imlp framework  @xcite by registering additional features . more specifically , while most algorithms rely solely on 3d point sets , v - imlop also uses oriented 2d contours to compute a registration .",
    "v - imlop uses two types of image features for video - ct registration : 3d point features up to scale , and 2d oriented point features representing occluding surface contours .",
    "the registration incorporates a probabilistic framework by modeling the uncertainty of these features .",
    "the uncertainty of each 3d point is modeled by a 3d anisotropic gaussian distribution , while the position and orientation uncertainties of a point on a 2d contour are modeled by a 2d anisotropic gaussian and von mises distributions  @xcite respectively .",
    "v - imlop consists of two main phases , correspondence and registration . in the correspondence phase ,",
    "a match for each data feature , @xmath9 , is computed by selecting the model point , @xmath10 that maximizes the probability of having generated @xmath11 .",
    "the choice of @xmath12 forms the _ match likelihood function _ ( mlf ) . assuming zero - mean uncertainty and independence of the features in each measurement , and given a 3d point feature , @xmath13 , and a current registration estimate , @xmath14 $ ] , the mlf is defined as    [ eq:3d_likelihood ] f_(&| , , s , ) = + & e^-(-s-)(-s- ) ,    where @xmath15 is a similarity transform .",
    "@xmath16 is the 3d position on the model shape that is assumed to be in correspondence with the transformed 3d data point @xmath17 .",
    "@xmath18 is the covariance matrix of 3d positional uncertainty for the non - transformed 3d data point , and @xmath19 is the covariance of the transformed 3d data point . maximizing eq .",
    "[ eq:3d_likelihood ] simplifies to computing the model point , @xmath16 , that minimizes the negative log likelihood , simplified as @xmath20 next , we define the mlf for an oriented 2d contour feature , @xmath21 :    [ eq:2d_likelihood ] f _ ( _ & | _ , _ , , s , ) = + & e^ _ _ - ( _ -_)(_- _ ) ,    where @xmath22 is the covariance matrix of 2d positional uncertainty for @xmath23 , and @xmath24 is the concentration parameter of 2d orientational uncertainty for @xmath25 .",
    "@xmath26 is the positional component of the model point , @xmath16 , which has been projected onto the 2d image plane of the video using a perspective projection .",
    "the normalized orientation component , @xmath27 , of @xmath16 is similarly a projection onto the video image plane , but done by orthographic projection to avoid division by zero depth since the 3d model orientations of occluding contours are parallel to the image plane .",
    "both @xmath26 and @xmath27 are scaled to convert from metric to pixel units .",
    "as before , maximizing eq .  [ eq:2d_likelihood ] with respect to @xmath28 can be reduced to minimizing a contour match error function .",
    "however , we must ensure that only visible model contours are projected onto the video image planes as potential matches . to achieve this",
    ", we use the estimated camera positions to compute the occluding contours and render the model .",
    "the z - buffers from rendering are then used to determine the subset , @xmath29 , of occluding contours that are visible to each video image .",
    "therefore , the contour match error for the @xmath30th video frame reduces to computing @xmath31 from the set @xmath32 that minimizes the projected contour match error function : @xmath33 an upper bound on the match orientation error is also imposed to prevent matches of widely differing orientation . in the registration phase ,",
    "we determine an updated pose for the data points by computing the similarity transform , @xmath15 , that minimizes the total match error : @xmath34}\\big ( \\frac{1}{2 } \\sum_{i=1}^{n_{\\mathrm{sfm } } } \\dsfmi^t\\mathbf{r\\sigma^{-1}_{\\mathrm{sfm}i}r^t}\\dsfmi + \\frac{1}{2 } \\sum_{j=1}^{n_{\\mathrm{cam}}}\\sum_{i=1}^{n_{\\mathrm{ctr}j } } \\dctrji\\mathbf{\\sigma^{-1}_{\\mathrm{2d}ji}}\\dctrji \\nonumber \\\\ %      & - \\sum_{j=1}^{n_{\\mathrm{cam}}}\\sum_{i=1}^{n_{\\mathrm{ctr}j } } \\kappa_{ji } \\frac{\\mathbf{s}\\mathrm{p}_{\\mathrm{xy}}(\\mathbf{r}_{\\mathrm{cam}j}\\mathbf{r^t}\\mathbf{\\hat{y}}_{\\mathrm{3dn}ji})^t}{\\|\\mathbf{s}\\mathrm{p}_{\\mathrm{xy}}(\\mathbf{r}_{\\mathrm{cam}j}\\mathbf{r^t}\\mathbf{\\hat{y}}_{\\mathrm{3dn}ji})\\| } \\mathbf{\\hat{x}}_{\\mathrm{2dn}ji } \\big ) , %    \\mathbf{t } = \\argmin_{[s,\\mathbf{r , t]}}\\big(\\sum_{i=1}^{n_{\\mathrm{sfm } } } c_{\\mathrm{sfm}i } + \\sum_{i=1}^{n_{\\mathrm{cam}}}\\sum_{i=1}^{n_{\\mathrm{ctr}j } } ( c_{\\mathrm{ctrp}ji } + c_{\\mathrm{ctrn}ji})\\big ) ,      \\mathbf{t } = \\argmin_{[s,\\mathbf{r , t]}}\\left(\\sum_{i=1}^{n_{\\mathrm{3d } } } c_{\\mathrm{3d}i } + \\sum_{j=1}^{n_{\\mathrm{cam}}}\\sum_{i=1}^{n_{\\mathrm{ctr}j } } c_{\\mathrm{2d}ji}\\right),\\end{aligned}\\ ] ] where @xmath35 is the number of 3d data points , @xmath36 is the number of video images , and @xmath37 is the number of contour features in the @xmath30th video image . the correspondence and registration phases are repeated until convergence .",
    "outlier rejection is performed between these phases .",
    "a fraction of 3d feature pairs with highest match error are first removed , followed by chi - square tests to identify further outliers satisfying the following inequality : @xmath38 where @xmath39 is the average square match distance of the current 3d inliers and @xmath40 is the inverse cdf function of a chi - square distribution with 3 degrees of freedom evaluated at probability @xmath41  @xcite .",
    "similar chi - square tests are used to reject outlying 2d contour features , with independent tests for position and orientation using the normal approximation to the von mises distribution  @xcite .",
    "an upper limit on the percent of contour outliers per video frame is also enforced .",
    "an anatomical constraint on the optimization prevents the estimated camera positions from leaving the interior feasible region of the sinus cavity .",
    "it is enforced by computing the nearest point on the mesh surface to the optical center of each estimated camera .",
    "if the surface normal points away from the camera , then the interior boundary has been crossed and the registration is backed up by fractional amounts of the most recent change until a valid pose is re - acquired .      in this section , we explain how we obtain the data required for v - imlop .",
    "the 3d data points are computed using sfm on endoscopic video sequences of about @xmath42 frames  @xcite .",
    "our initial scale estimate is obtained by tracking the endoscope using an electromagnetic tracker and scaling the 3d points to match the magnitude of the endoscope trajectory . since v - imlop optimizes over scale , inaccuracies in this estimate",
    "do not greatly affect registration accuracy .",
    "our optimization is constrained by user - defined upper and lower bounds on scale to ensure that an unrealistic scale is not computed in the initial iterations when misalignment of @xmath43 and @xmath44 may be very large .",
    "each patient also has a pre - operative ct , which is deformably registered to a hand - segmented template ct created from a dataset of @xmath45 head cts  @xcite .",
    "the model shape is thereby automatically generated by deforming the template meshes to patient space  @xcite . occluding contours in video are computed once using the method described in  @xcite , because this method learns boundaries that naturally separate objects , and mimics depth - based occluding contours with high accuracy ( fig .",
    "[ fig : contours_overlay](a ) ) .",
    "contour normals are computed by computing gradients on smoothed video frames , and assigning to each contour point the negative gradient at that point . for the model shape , occluding contours relative to each camera pose are computed during every iteration of v - imlop by locating all visible edges in the triangular mesh where one face bordering the edge is oriented towards the camera , and the other away from the camera , thereby forming an occluding edge ( fig .  [",
    "fig : contours_overlay](a ) ) .",
    "the measurement noise parameters ( @xmath18 , @xmath46 , and @xmath24 ) are user defined and do not change during registration .",
    "equal influence is granted to the 3d and 2d feature sets regardless of the feature set sizes by normalizing the user - defined 3d covariances ( @xmath18 ) by factor @xmath47 , where @xmath35 and @xmath48 are the total number of 3d and 2d features , and @xmath49 is the initial trim ratio for 3d outliers .",
    "( a ) ( left ) mesh contours in red , ( right ) video contours in white .",
    "( b ) ( left ) overlay of ct data on the simulated image ; ( right ) red arrows show path of the endoscope with respect to the ct , red dots show registered sfm reconstruction.,title=\"fig : \" ] + ( a )    ( a ) ( left ) mesh contours in red , ( right ) video contours in white .",
    "( b ) ( left ) overlay of ct data on the simulated image ; ( right ) red arrows show path of the endoscope with respect to the ct , red dots show registered sfm reconstruction.,title=\"fig : \" ] + ( b )      we experiment with two approaches to initialize the registration .",
    "first , to develop a baseline , we manually set the camera pose by localizing the anatomy near the targeted field - of - view for each image .",
    "this allows us to investigate the sensitivity of v - imlop to the starting pose towards achieving correct convergence .",
    "next , we relax this constraint by observing in - situ endoscopic trajectories during interventions , and isolating areas - of - interest through which the surgeon commonly inserts the endoscope",
    ". then , we evenly sample _ canonical camera poses _ throughout these regions , and store them in our template ct space . through deformable registration of the template to each patient ct  @xcite",
    ", we transform each canonical camera pose to serve as a candidate initialization from which we spawn a v - imlop registration process .",
    "we also slightly vary the initial scale . finally , we select the solution yielding the minimum contour error . the residual surface error between the data points and model surface after the final transformation does not reflect failures in registration well , since sfm reconstructions are sparse , and therefore do not guarantee a unique registration .",
    "icp and other similar methods suffer from this drawback , which causes them to often converge to solutions regardless of starting pose .",
    "contour error , however , is a better indicator of performance . in a case where the 3d points align well",
    "but the camera pose is wrong , the projected mesh contours will not align with the video contours .",
    "in order to quantitatively analyze our method , we evaluated our algorithm on simulated data generated in gazebo  @xcite .",
    "we used images collected from patients to texture the inside of a sinus mesh extracted from patient ct ( fig .",
    "[ fig : contours_overlay](b ) ) .",
    "we inserted this model in a simulation with a virtual endoscope , which was navigated within the sinus cavity with physical constraints enforced by enabling collision detection in gazebo .",
    "we computed sfm on a sequence of @xmath42 consecutive simulated endoscopic images , and registered the resulting @xmath50 data points to the 3d mesh used for simulation ( fig .",
    "[ fig : contours_overlay](b ) ) . using the simulated pose of the endoscope as ground truth",
    ", we evaluated the accuracy of the method .",
    "the mean positional error for the @xmath42 simulated video frames was @xmath7 mm , and orientation error was @xmath51 .",
    "we also randomly sampled @xmath52 3d points from the mesh visible to the virtual cameras for @xmath53 frames .",
    "we added random noise to the 3d points with std .",
    "@xmath7 mm and @xmath54 mm in the parallel and orthogonal directions relative to the virtual optical axes to simulate noisy sfm data , and also to the camera poses with uniform random sampling in @xmath55$]mm and degrees of translational and rotational errors , respectively , to simulate error in the computed extrinsic parameters .",
    "contour noise was modeled using an isotropic noise model with @xmath56pixel@xmath57 , @xmath58 .",
    "the simulated data was randomly misaligned from the mesh in the interval @xmath59$]mm and degrees .",
    "registration was assessed using the center points of every mesh triangle visible to the middle virtual camera frame at the ground truth pose to compute a mean tre . using v - imlop to register this data back to the mesh",
    ", we achieved a tre of 0.2 mm .",
    "alignment between occluding contours from ct mesh projected onto the video frame ( green ) and occluding contours from video ( white ) is better using v - imlop ( c ) than both trimmed icp ( a ) and v - imlop without contours ( b).,title=\"fig : \" ] + ( a )    alignment between occluding contours from ct mesh projected onto the video frame ( green ) and occluding contours from video ( white ) is better using v - imlop ( c ) than both trimmed icp ( a ) and v - imlop without contours ( b).,title=\"fig : \" ] + ( b )    alignment between occluding contours from ct mesh projected onto the video frame ( green ) and occluding contours from video ( white ) is better using v - imlop ( c ) than both trimmed icp ( a ) and v - imlop without contours ( b).,title=\"fig : \" ] + ( c )    ( top ) registration accuracy , demonstrated through reprojection error , degrades as the initial pose is offset further from the true pose ; ( bottom ) since contour error increases as registration error worsens , it may be used as an indicator for registration confidence . ]",
    "( top ) registration accuracy , demonstrated through reprojection error , degrades as the initial pose is offset further from the true pose ; ( bottom ) since contour error increases as registration error worsens , it may be used as an indicator for registration confidence . ]",
    "( top ) registration accuracy , demonstrated through reprojection error , degrades as the initial pose is offset further from the true pose ; ( bottom ) since contour error increases as registration error worsens , it may be used as an indicator for registration confidence . ]",
    "( top ) registration accuracy , demonstrated through reprojection error , degrades as the initial pose is offset further from the true pose ; ( bottom ) since contour error increases as registration error worsens , it may be used as an indicator for registration confidence . ]",
    "( top ) registration accuracy , demonstrated through reprojection error , degrades as the initial pose is offset further from the true pose ; ( bottom ) since contour error increases as registration error worsens , it may be used as an indicator for registration confidence . ]    ( top ) registration accuracy , demonstrated through reprojection error , degrades as the initial pose is offset further from the true pose ; ( bottom ) since contour error increases as registration error worsens , it may be used as an indicator for registration confidence . ]",
    "registration results using v - imlop with degrading initializations ( left to right ) show that the final registration and contour error also degrade , indicated by the alignment of model contours ( green ) and video contours ( white ) .",
    "]    registration results using v - imlop with degrading initializations ( left to right ) show that the final registration and contour error also degrade , indicated by the alignment of model contours ( green ) and video contours ( white ) . ]",
    "registration results using v - imlop with degrading initializations ( left to right ) show that the final registration and contour error also degrade , indicated by the alignment of model contours ( green ) and video contours ( white ) . ]",
    "registration results using v - imlop with degrading initializations ( left to right ) show that the final registration and contour error also degrade , indicated by the alignment of model contours ( green ) and video contours ( white ) . ]",
    "we also tested our algorithm on in - vivo data collected from outpatients enrolled in an irb - approved study .",
    "we tested our method with manual initializations on @xmath60 non - overlapping video sequences from two patients , showing differing anatomy .",
    "we used an isotropic noise model with @xmath61mm@xmath57 , @xmath62pixel@xmath57 , @xmath58 .",
    "@xmath63 sequences contained approximately @xmath42 images and @xmath0 sequence contained @xmath64 , resulting in a total of @xmath65 images . results from registration show that v - imlop produces better alignment of model contours with the corresponding video frame ( fig .",
    "[ fig : comparison ] ) .",
    "since it is difficult to isolate a target in in - vivo data , we did not compute tre .",
    "the mean residual error over all sequences is @xmath66 mm , and the mean contour error is @xmath67pixels ( @xmath68pixels for inliers ) .",
    "we also show through an analysis of perturbing our manual initializations that our approach is robust to rough pose and scale initializations , and capable of indicating _ failure _ when a camera pose initialization is too far away from the true target anatomy .",
    "we ran this test on @xmath69 perturbations from @xmath6 sequences ( @xmath70 images ) .",
    "the average residual error for the @xmath71 candidate initializations resulting in successful registrations was @xmath72 mm .",
    "the right - most image in fig .",
    "[ fig : auto - init ] is a failure case , and corresponds to the data point with the highest contour error in fig .",
    "[ fig : auto_error ] .",
    "therefore , we have constructed an automated initialization procedure combining empirical endoscopic trajectories with ct registration to define realistic starting poses from which registration can succeed , or return failure with confidence .",
    "finally , under the guidance of a surgeon , we identify sequences with more erectile and less erectile tissue for each patient .",
    "this separation is important because structures in the sinuses that contain erectile tissue undergo regular deformation resulting in modified anatomy , and therefore , registration errors .",
    "errors in regions of the sinuses containing more erectile tissue are @xmath73 mm for 3d points residual error and @xmath74pixels ( @xmath75pixels for inliers ) contour error . whereas , errors in regions containing less erectile tissue are @xmath76 mm for 3d points residual error and @xmath77pixels ( @xmath78pixels for inliers ) contour error .",
    "overall error is better in less erectile tissue , as expected .",
    "we present a novel approach for video - ct registration that optimizes over 3d points as well as oriented 2d contours .",
    "our method demonstrates capability to produce sub - millimeter results even with sub - optimal initializations and in the presence of erectile tissue . we are currently working on optimizing our code , and expanding our data set to thoroughly test our method on more outpatients and surgical cases . in the future",
    ", we hope to fully automate the initialization , and further improve our method in the presence of erectile tissue by accounting for deformation .",
    "this work was funded by nih r01-eb015530 and nsf grfp .",
    "18 slavin , r.g .",
    ", spector , s.l . ,",
    "bernstein , i.l . ,",
    "kaliner , m.a . ,",
    "kennedy , d.w .",
    ", virant , f.s . ,",
    "wald , e.r .",
    "khan , d.a .",
    ", blessing - moore , j. , lang , d.m . , nicklas , r.a . , oppenheimer , j.j . ,",
    "portnoy , j.m . ,",
    "schuller , d.e .",
    ", tilles , s.a . , borish , l. , nathan , r.a . ,",
    "smart , b.a .",
    ", vandewalker , m.l . :",
    "the diagnosis and management of sinusitis : a practice parameter update .",
    "116(6 , supplement ) , s13s47 ( 2005 )      dalziel , kim ; stein , ken ; round , ali ; garside , ruth ; royle , p. : endoscopic sinus surgery for the excision of nasal polyps : a systematic review of safety and effectiveness .",
    "american journal of rhinology .",
    "20(5 ) , 506519 ( 2006 )    otake , y. , leonard , s. , reiter , a. , rajan , p. , siewerdsen , j.h . , gallia , g.l . ,",
    "ishii , m. , taylor , r.h . ,",
    "hager , g.d .",
    ": rendering - based video - ct registration with physical constraints for image - guided endoscopic sinus surgery .",
    "spie 9415 , mi : igprim , 94150a ( 2015 )      leonard , s. , reiter , a. , sinha , a. , ishii , m. , taylor , r.h . , hager , g.d .",
    ": image - based navigation for functional endoscopic sinus surgery using structure from motion .",
    "spie 9784 , mi : ip , 97840v ( 2016 )                avants , b.b . ,",
    "tustison , n.j .",
    ", song , g. , cook , p.a . ,",
    "klein , a. , gee , j.c . : a reproducible evaluation of \\{ants } similarity metric performance in brain image registration .",
    "54(3 ) , 20332044 ( 2011 ) .",
    "sinha , a. , leonard , s. , reiter , a. , ishii , m. , taylor , r.h . ,",
    "hager , g.d .",
    ": automatic segmentation and statistical shape modeling of the paranasal sinuses to estimate natural variations .",
    "spie 9784 , mi : ip , 97840d ( 2016 )"
  ],
  "abstract_text": [
    "<S> functional endoscopic sinus surgery ( fess ) is a surgical procedure used to treat acute cases of sinusitis and other sinus diseases . </S>",
    "<S> fess is fast becoming the preferred choice of treatment due to its minimally invasive nature . however , </S>",
    "<S> due to the limited field of view of the endoscope , surgeons rely on navigation systems to guide them within the nasal cavity . </S>",
    "<S> state of the art navigation systems report registration accuracy of over @xmath0 mm , which is large compared to the size of the nasal airways . </S>",
    "<S> we present an anatomically constrained video - ct registration algorithm that incorporates multiple video features . </S>",
    "<S> our algorithm is robust in the presence of outliers . </S>",
    "<S> we also test our algorithm on simulated and in - vivo data , and test its accuracy against degrading initializations . </S>"
  ]
}