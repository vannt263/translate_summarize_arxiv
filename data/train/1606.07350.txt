{
  "article_text": [
    "evolutionary , or explicit , phylogenetic networks are graphical models that model reticulate evolutionary histories @xcite .",
    "such evolutionary histories arise when processes such as horizontal gene transfer or hybridization occur .",
    "research into mathematical properties , complexity results , and algorithmic techniques has exploded recently , as evident by the publication of three recent books on the subject @xcite .",
    "a main premise behind the use of phylogenetic networks is that when a single tree is not sufficient to model the evolutionary history of a set of sequences or characters , a phylogenetic network that encompasses several trees is used . for example , the phylogenetic network in fig .",
    "[ fig : net](a ) depicts an evolutionary history that involves hybridization between taxon d and the most recent common ancestor ( mrca ) of taxa b and c.     with one reticulation node ( a ) and two trees it displays ( b , c).[fig : net],width=240 ]    central to research on phylogenetic networks has been the notion of trees _ displayed _ by a phylogenetic network .",
    "we say that a phylogenetic network displays a tree if the tree can be obtain be removing a set of  reticulation edges \" of the network .",
    "[ fig : net ] shows the two trees displayed by the network given in the figure . given a phylogenetic network @xmath0 ,",
    "we denote by @xmath1 the set of all trees displayed by @xmath0 .",
    "when incongruence in the gene trees inferred on different genomic regions across a genome alignment is assumed to be caused only by reticulation ( e.g. , hybridization ) , then the observed gene trees are taken to be a subset of the set of trees displayed by the ( unknown ) phylogenetic network for the set of genomes .",
    "this is why the set @xmath1 has played a fundamental role in most results established for phylogenetic networks .",
    "examples of the prominent use of @xmath1 include : ( 1 ) parsimonious phylogenetic networks that fit the evolution of a sequence of sequences under the infinite sites model @xcite ; ( 2 ) extending the maximum parsimony and maximum likelihood criteria from trees to networks @xcite ; ( 3 ) inferring minimal networks from sets of gene trees @xcite ; ( 4 ) establishing identifiability results related to networks @xcite ; ( 5 ) establishing complexity results related to networks @xcite ; and ( 6 ) identifying special trees within the network @xcite .",
    "one of the evolutionary phenomena that has been extensively documented in recent analyses and targeted for computational developments is _ deep coalescence _ , or _",
    "incomplete lineage sorting _ @xcite .",
    "this phenomenon amounts to gene tree incongruence due to population effects ( e.g. , the size of an ancestral population or the time between two divergence events ) .",
    "when this phenomenon is present in a reticulate evolutionary history , a major challenge faces all the aforementioned works : the set of trees displayed by a network is no longer adequate to fully capture gene evolution within the network . to resolve this issue , we define the set of parental trees of a phylogenetic network to supplant the set of displayed trees .",
    "based on this set , we make three contributions .",
    "first , we extend the concept of anomaly zone to phylogenetic networks and establish results based on this concept .",
    "it is important to note here that sols - lemus _ et al .",
    "_ @xcite recently discussed the issue of anomaly in the presence of reticulation where they focused on the  species tree \" inside the network . here , we define the anomaly zone in terms of the whole set of parental trees and do not designate a species tree inside the network .",
    "second , we address the problem of inferring a backbone tree inside the network that could serve as a starting tree for network searches and/or provide information on a potential species tree despite reticulation . as in the first contribution",
    ", the work here differs from that of @xcite in focusing on all trees displayed by a network , rather than just a designate species tree .",
    "third , we propose a novel clustering - based approach to phylogenetic network inference from gene trees by which the gene trees are first clustered , parental trees are inferred from the clusters , and then the parental trees are combined into a phylogenetic network .",
    "gori _ et al .",
    "_ @xcite recently studied the performance of various combinations of dissimilarity measures and clustering techniques in clustering gene trees .",
    "our work differs from that of @xcite in that our focus is on phylogenetic network inference via clustering .",
    "we believe our work will open up new venues for research into computational methods and mathematical results for reticulate evolutionary histories .",
    "we focus here on binary evolutionary ( or , explicit ) phylogenetic networks @xcite .",
    "the topology of a phylogenetic network @xmath0 is a rooted directed acyclic graph @xmath2 such that @xmath3 contains a unique node with in - degree @xmath4 and out - degree @xmath5 ( the root ) and each of the other nodes has either in - degree @xmath6 and out - degree @xmath5 ( an internal tree node ) , an in - degree @xmath6 and out - degree @xmath4 ( an external tree node , or leaf ) , or in - degree @xmath5 and out - degree @xmath6 ( a reticulation node ) .",
    "the phylogenetic network has branch lengths @xmath7 , such that @xmath8 denotes the length , in coalescent units ( in coalescent units , the length of an edge in number of generations is divided by twice the size of the effective population size of the population associated with that edge , and is a standard unit used in coalescent theory ) , of branch @xmath9 in @xmath0 .    as we discussed in the background section and illustrated in fig .",
    "[ fig : net ] , the notion of trees displayed by a network has played a central role in analyzing and inferring networks .",
    "let @xmath0 be a phylogenetic network .",
    "a tree @xmath10 is displayed by @xmath0 if it can be obtained by removing for each reticulation node one of the edges incident into it followed by repeatedly applying forced contractions until no nodes of in- and out - degree @xmath6 remain .",
    "we denote by @xmath1 the set of all trees displayed by @xmath0 .",
    "[ fig : net ] shows a phylogenetic network @xmath0 along with @xmath1 .",
    "let us consider tracing the evolution of a recombination - free genomic region of four individuals @xmath11 , @xmath9 , @xmath12 , and @xmath13 , sampled from the four taxa a , b , c and d within the branches of the phylogenetic network @xmath0 of fig .",
    "[ fig : net ] .",
    "if @xmath9 and @xmath12 coalesce at the most recent common ancestor ( mrca ) of b and c , and no events such as deep coalescence or duplication / loss occur anywhere in the phylogenetic network , then the genealogy of the genomic region is one of the two trees in the set @xmath1 .",
    "this is precisely the reason why much attention has been given to the set @xmath1 , as discussed in the background section .",
    "however , let us now consider a scenario where @xmath9 and @xmath12 did not coalesce at the mrca of b and c. one potential outcome in terms of the resulting genealogy for @xmath11 , @xmath9 , @xmath12 , and @xmath13 is illustrated in fig .",
    "[ fig : dc](a ) .",
    "the probability that @xmath9 and @xmath12 fail to coalesce at the mrca of b and c has to do with the quantity @xmath14 in the figure : the smaller it is , the more likely it is that @xmath9 and @xmath12 would fail to coalesce @xcite .",
    "( shown in fig .",
    "[ fig : net ] ) capture this scenario .",
    "the length in coalescent units of the branch between the reticulation node and the mrca of b and c is @xmath14 .",
    "( b ) an abstract representation of the network , assuming both reticulation edges have the same length @xmath15 .",
    "[ fig : dc],width=211 ]    interestingly , for the scenario illustrated in fig .",
    "[ fig : dc](a ) , neither of the two trees in the set @xmath1 can capture the shown genealogy .",
    "this brings us to define the set of parental trees inside a phylogenetic network to appropriately represent the network as a mixture of trees that adequately model the evolution of genes in the presence of deep coalescence .",
    "@xcite gave an algorithm for the simple task of converting a phylogenetic network @xmath0 to a multi - labeled tree , or mul - tree , @xmath16 .",
    "proceeding from the leaves of the network toward the root , the algorithm creates two copies of each subtree rooted at a reticulation node , attaches them to the two parents of the reticulation node , and deletes the two reticulation edges .",
    "[ fig : net2](a ) for an illustration .",
    "notice that multiple leaves could be labeled with the same taxon name , and hence the mul - tree naming .",
    "due to page limitations , we provide the pseudo - code of the algorithm in the appendix .",
    "as phylogenomic analyses are increasingly involving multiple individuals per species , we provide a general definition that applies to cases with multiple individuals per species .",
    "let @xmath17 be the set of species and @xmath18 denote the number of genomes sampled from species @xmath19 .",
    "let @xmath16 be a mul - tree .",
    "we denote by @xmath20 a tree obtained from @xmath16 by retaining , for each taxon @xmath19 , @xmath21 or fewer leaves labeled by @xmath22 and deleting the remaining leaves labeled by @xmath22 , followed by repeatedly applying forced contractions until no nodes of in- and out - degree @xmath6 remain .",
    "let @xmath0 be a phylogenetic network on set @xmath17 of taxa and @xmath16 be its mul - tree .",
    "a parental tree inside @xmath0 is a tree @xmath10 such that @xmath23 .",
    "we denote by @xmath24 the set of all parental trees inside @xmath0 .",
    "[ fig : net2 ] shows the set @xmath24 for the phylogenetic network in fig .",
    "[ fig : net ] .     in fig .",
    "[ fig : net](a ) .",
    "the set @xmath24 consists of the four trees in ( b)(e ) , assuming one individual is sampled per species .",
    "[ fig : net2],width=432 ]    the genealogy shown in fig .",
    "[ fig : dc](a ) can be captured by the parental tree in fig .",
    "[ fig : net2](d ) . indeed ,",
    "_ et al . _",
    "@xcite gave mass and density functions for gene trees on phylogenetic networks in terms of the set of parental trees inside the network . while it is obvious that @xmath25 , the two sets can differ significantly in terms of their properties .",
    "for example , if @xmath0 has @xmath26 reticulation nodes , then @xmath27 .",
    "however , @xmath28 could be much larger than @xmath29 , as it is a function of the numbers of leaves under the reticulation nodes as well as the numbers of individuals sampled per species .      given a species tree topology @xmath0 and its branch lengths @xmath7 , the gene tree topology @xmath30 can be viewed as a discrete random variable whose mass function @xmath31 was derived in @xcite . in the case of phylogenetic networks , we also associate with every pair of edges @xmath32 and @xmath33 that are incident into the same reticulation node @xmath34 nonnegative real values @xmath35 and @xmath36 such that @xmath37 @xcite . these quantities , which we call inheritance probabilities , indicate the proportions of lineages in hybrid populations that trace each of the two parents of that population . in this case , the phylogenetic network s topology @xmath0 and branch lengths @xmath7 , along with the inheritance probabilities @xmath38 , are sufficient to describe the mass function of gene trees @xmath39 under the multispecies network coalescent @xcite .",
    "in this section we describe the three main contributions of this work .",
    "first , we extend the concept of anomaly zones @xcite to phylogenetic networks and establish conditions for their existence .",
    "second , we address the question of whether it is possible , from an inference perspective , to obtain a tree that can be augmented into the correct network by adding reticulation edges between pairs of the tree s edges .",
    "third , we propose a clustering approach to network inference by clustering the gene trees , inferring parental trees , and then combining the parental trees into a network .",
    "these results have direct implications not only on understanding the relationships between trees and networks , but also the practical task of developing computational methods for network inference .",
    "in a seminal paper , degnan and rosenberg @xcite showed that the branch lengths of a species tree could be set such that the most likely gene tree disagrees with the species tree .",
    "such a gene tree is called an _ anomalous gene tree _ and the set of all branch length settings that result in an anomalous gene tree is the _ anomaly zone_.    we now provide what , to the best of our knowledge , is the first definition of anomaly zones for phylogenetic networks .",
    "note that in @xcite , sols - lemus _ et al .",
    "_ discussed anomalous gene trees in the presence of ils and gene flow . however , in their work , the anomaly was still defined with respect to a designated species tree ( they viewed the phylogenetic network as a species tree with additional horizontal edge between pairs of its branches ) . here , we do not designate any of the parental trees of the network as a species tree ; instead , we define the anomaly zone directly in terms of the entire set .",
    "let @xmath0 be a phylogenetic network , @xmath7 be its branch lengths , and @xmath38 be the inheritance probabilities associated with its reticulation edges .",
    "we say gene tree topology @xmath40 is anomalous for @xmath41 if @xmath42 a phylogenetic network @xmath0 is said to produce anomalies if there exists branch lengths @xmath7 and inheritance probabilities @xmath38 such that there exists an anomalous gene tree @xmath40 for @xmath41 .",
    "the anomaly zone for a phylogenetic network @xmath0 is a set of @xmath43 values for which @xmath0 produces anomalies .",
    "degnan and rosenberg @xcite showed that three - taxon and symmetric four - taxon species trees have no anomaly zones , but that non - symmetric four - taxon trees and all species trees with five or more taxa have anomaly zones .",
    "one practical implication of these results was that the simple approach of sampling a very large number of loci , building gene trees and taking the most frequent gene tree as the species tree ( an approach dubbed  the democratic vote \" method ) does not always work .",
    "since the multispecies coalescent is a special case of the multispecies network coalescent , it immediately follows that any phylogenetic network with @xmath44 leaves produces anomalies .",
    "we now show that three - taxon phylogenetic networks do not produce anomalies , but that symmetric phylogenetic networks with @xmath45 leaves could produce anomalies .",
    "note that according to @xcite , 3-taxon networks could still generate anomalous gene trees .",
    "the seeming discrepancy between the two results is due to to the fact that here we define the anomaly zone in terms of all the parental trees inside the network and not just one designate species tree .",
    "( proof is in the appendix . )",
    "consider now the symmetric phylogenetic network @xmath0 in fig .",
    "[ fig : dc](b ) and whose set of parental trees in given in fig .",
    "[ fig : net2 ] .",
    "the four gene trees that are identical to the parental trees of the network are @xmath46 , @xmath47 , @xmath48 and @xmath49 .",
    "we plotted the most probable gene tree of this network when @xmath22 and @xmath14 are both small in fig .",
    "[ fig:4taxaspecialprob ] , in which yellow region and orange region stand for the anomaly zone of this network , and blue region is where the most probable gene tree be the backbone tree .",
    "this figure shows the existence of anomaly zone of the network in fig .",
    "[ fig : dc](b ) ( where @xmath15 is set to @xmath4 ) , which means that symmetric phylogenetic networks with @xmath45 leaves could produce anomalies .",
    "( b ) ( with @xmath50 ) with @xmath51 ( left ) and @xmath52 ( right ) .",
    "the y - axis is branch length @xmath14 .",
    "the x - axis is branch length @xmath22 .",
    "blue : gene tree @xmath47 in both panels , and gene tree @xmath46 additionally in the left panel ; yellow : gene tree @xmath53 ; orange : gene trees @xmath54 and @xmath55 ; brown : gene trees @xmath48 and @xmath49 .",
    "[ fig:4taxaspecialprob],title=\"fig:\",scaledwidth=40.0% ] ( b ) ( with @xmath50 ) with @xmath51 ( left ) and @xmath52 ( right ) .",
    "the y - axis is branch length @xmath14 .",
    "the x - axis is branch length @xmath22 .",
    "blue : gene tree @xmath47 in both panels , and gene tree @xmath46 additionally in the left panel ; yellow : gene tree @xmath53 ; orange : gene trees @xmath54 and @xmath55 ; brown : gene trees @xmath48 and @xmath49 .",
    "[ fig:4taxaspecialprob],title=\"fig:\",scaledwidth=40.0% ]      a very important question in the area of phylogenetic network inference is whether there exists a tree that can be augmented into the network by adding reticulation edges between pairs of the tree s edges . here",
    ", we refer to such a tree as the network s _",
    "backbone tree_. a biological significance of this tree lies in its potential designation as the species tree ( e.g. , see the species tree underlying the phylogenetic network of mosquitos in @xcite ) .    francis and steel @xcite recently introduced the notion of _ tree - based networks _ to capture those networks that can be obtained by augmenting a backbone tree ( they called it the  base tree \" ) .",
    "we now show that even if a network is tree - based , it is not necessarily the case that the most likely gene tree is its base , a result that is related to the anomalous gene trees discussed above .",
    "let us consider again the network of fig .",
    "[ fig : dc](b ) .",
    "this network is tree - based and each of the two trees in fig . [",
    "fig : net ] could serve as its base ( indeed , the same network is drawn in fig .",
    "[ fig : net ] in a way that clearly demonstrates that it is tree - based ) .",
    "the probabilities of all 15 gene trees under this phylogenetic network are given in table [ tab : table1 ] in the appendix .",
    "while there are 15 possible gene tree topologies on taxa @xmath11 , @xmath9 , @xmath12 , and @xmath13 , as branch length @xmath22 in the network tends to infinity , the probability of seven of the 15 gene tree topologies converges to @xmath4 and only eight gene trees have non - zero mass : @xmath46 , @xmath47 , @xmath48 , @xmath49 , @xmath56 , @xmath57 , @xmath54 , and @xmath55 .",
    "the probabilities in this case are given in table [ tab : table1x ] in the appendix and visualized as a function of varying branch length @xmath14 for two different settings of @xmath58 in fig .",
    "[ fig:4taxa_chart ] in the appendix .",
    "when @xmath51 and @xmath59 , which is equivalent to @xmath60 , the most likely gene tree given @xmath0 is not one of its base trees ( that is , the network can not be obtained by a adding a single reticulation edge to the most likely gene tree ) .",
    "this also demonstrates that if we defined anomalies in terms of the set @xmath1 instead of set @xmath24 , the phylogenetic network would still produce anomalous gene trees .",
    "given that the most likely gene tree is not necessarily a backbone of the phylogenetic network , we now turn our attention to three recent methods whose goal is to infer a species tree despite horizontal gene transfer .",
    "it is very important to point out upfront that the assumptions of these methods do not necessarily match the scenarios we investigate here , but our goal is to assess how well they do at recovering a backbone tree inside the network of fig .",
    "[ fig : dc](b ) . in @xcite ,",
    "_ showed that astral - ii @xcite performed best among species tree inference methods in terms of recovering the species tree in the presence of reticulation ( under a specific model of horizontal gene transfer ) .",
    "they further proved that the method is statistically consistent in terms of recovering the species tree under the same model . in @xcite , steel _ et al .",
    "_ showed that triplet - based approaches to species tree inference are consistent in terms of inferring a species tree in the presence of horizontal gene transfer ( also under a specific model ) .",
    "this technique was implemented as the  primordial tree \" in dendroscope @xcite .",
    "both astral - ii and the primordial tree method in dendroscope take gene trees as input .",
    "the method of daskalakis and roch @xcite takes as input gene trees with branch length and compute the distance between every two taxa @xmath61 and @xmath34 as the median of the gene - tree distances between @xmath61 and @xmath34 over all gene trees in the data set ( given a gene tree with branch lengths , the gene - tree distance between two leaves is the sum of the branch lengths on the simple path between the two leaves ) .",
    "we simulated gene tree data sets under the phylogenetic network of fig .",
    "[ fig : dc](b ) using ms @xcite while varying branch length @xmath14 to take on values from the set @xmath62 ( @xmath15 was set to @xmath4 and @xmath22 was set to @xmath63 so as to rule out deep coalescence involving the two branches incident with the root ) .",
    "data sets with @xmath64 , @xmath65 , @xmath66 and @xmath67 gene trees were generated , and for each configuration of branch length @xmath14 and number of gene trees , 100 data sets were simulated .",
    "the accuracy of each method for a setting of branch length @xmath14 and number of gene trees is the fraction , out of the 100 data sets , of times that the method returned one of the two trees displayed by the network .",
    "the results for all three methods on the simulated data are shown in fig .",
    "[ methods : perf ] ."
  ],
  "abstract_text": [
    "<S> phylogenetic networks model reticulate evolutionary histories . </S>",
    "<S> the last two decades have seen an increased interest in establishing mathematical results and developing computational methods for inferring and analyzing these networks . a salient concept underlying a great majority of these developments </S>",
    "<S> has been the notion that a network displays a set of trees and those trees can be used to infer , analyze , and study the network . in this paper , we show that in the presence of coalescence effects , the set of displayed trees is not sufficient to capture the network . </S>",
    "<S> we formally define the set of parental trees of a network and make three contributions based on this definition . </S>",
    "<S> first , we extend the notion of anomaly zone to phylogenetic networks and report on anomaly results for different networks . </S>",
    "<S> second , we demonstrate how coalescence events could negatively affect the ability to infer a species tree that could be augmented into the correct network . </S>",
    "<S> third , we demonstrate how a phylogenetic network can be viewed as a mixture model that lends itself to a novel inference approach via gene tree clustering . </S>",
    "<S> our results demonstrate the limitations of focusing on the set of trees displayed by a network when analyzing and inferring the network . </S>",
    "<S> our findings can form the basis for achieving higher accuracy when inferring phylogenetic networks and open up new venues for research in this area , including new problem formulations based on the notion of a network s parental trees . </S>"
  ]
}