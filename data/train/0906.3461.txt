{
  "article_text": [
    "sensor networks  @xcite can be described as a collection of wireless devices with limited computational abilities which are , due to their ad - hoc communication manner , vulnerable to misbehavior and malfunction .",
    "it is therefore necessary to support them with a simple , _ computationally friendly _ protection system .    due to the limitations of sensor networks",
    ", there has been an on - going interest in providing them with a protection solution that would fulfill several basic criteria .",
    "the first criterion is the ability of self - learning and self - tuning .",
    "because maintenance of ad hoc networks by a human operator is expected to be sporadic , they have to have a built - in _ autonomous _",
    "mechanism for identifying user behavior that could be potentially damaging to them .",
    "this learning mechanism should itself minimize the need for a human intervention , therefore it should be self - tuning to the maximum extent .",
    "it must also be computationally conservative and meet the usual condition of high detection rate .",
    "the second criterion is the ability to undertake an action against one or several misbehaving users .",
    "this should be understood in a wider context of co - operating wireless devices acting in collusion in order to suppress or minimize the adverse impact of such misbehavior .",
    "such a co - operation should have a low message complexity because both the bandwidth and the battery life are of scarce nature .",
    "the third and last criterion requires that the protection system does not itself introduce new weaknesses to the systems that it should protect .",
    "an emerging solution that could facilitate implementation of the above criteria are artificial immune systems ( ais ) .",
    "ais are based on principles adapted from the human immune system ( his )  @xcite ; the basic ability of his is an efficient detection of potentially harmful foreign agents ( viruses , bacteria , etc . ) .",
    "the goal of ais , in our setting , is the identification of nodes with behavior that could possibly negatively impact the stated mission of the sensor network .",
    "one of the key design challenges of ais is to define a suitable set of efficient genes .",
    "genes form a basis for deciding whether a node misbehaves . they can be characterized as measures that describe a network s performance from a node s viewpoint . given their purpose , they must be easy to compute and robust against deception .",
    "misbehavior in wireless sensor networks can take upon different forms : packet dropping , modification of data structures important for routing , modification of packets , skewing of the network s topology or creating ficticious nodes ( see  @xcite for a more complete list ) .",
    "the reason for sensors ( possibly fully controlled by an attacker ) to execute any form of misbehavior can range from the desire to save battery power to making a given wireless sensor network non - functional .",
    "malfunction can also be considered a type of unwanted behavior .",
    "the human immune system is a rather complex mechanism able to protect humans against an amazing set of extraneous attacks .",
    "this system is remarkably efficient , most of the time , in discriminating between _ self _ and _ non - self _ antigens .",
    "a non - self antigen is anything that can initiate an immune response ; examples are a virus , bacteria , or splinter .",
    "the opposite to non - self antigens are self antigens ; self antigens are human organism s own cells .",
    "the process of t - cells maturation in thymus is used as an inspiration for learning in ais .",
    "the maturation of t - cells ( detectors ) in thymus is a result of a pseudo - random process . after a t - cell",
    "is created ( see fig .  [",
    "fig : det_gen ] ) , it undergoes a censoring process called _ negative selection_. during negative selection t - cells that bind self are destroyed .",
    "remaining t - cells are introduced into the body .",
    "the recognition of non - self is then done by simply comparing t - cells that survived negative selection with a suspected non - self .",
    "this process is depicted in fig .",
    "[ fig : non_self_det ] .",
    "it is possible that the self set is incomplete , while a t - cell matures ( tolerization period ) in the thymus .",
    "this could lead to producing t - cells that should have been removed from the thymus and can cause an autoimmune reaction , i.e. it leads to _",
    "false positives_.    a deficiency of the negative selection process is that alone it is not sufficient for assessing the damage that a non - self antigen could cause .",
    "for example , many bacteria that enter our body are not harmful , therefore an immune reaction is not necessary .",
    "t - cells , actors of the adaptive immune system , require co - stimulation from the innate immune system in order to start acting .",
    "the innate immune system is able to recognize the presence of harmful non - self antigens and tissue damage , and signal this to certain actors of the adaptive immune system .",
    "the random - generate - and - test approach for producing t - cells ( detectors ) described above is analyzed in  @xcite .",
    "in general , the number of candidate detectors to the self set size needs to be exponential ( if a matching rule with fixed matching probability is used ) .",
    "another problem is a consistent underfitting of the non - self set ; there exist `` holes '' in the non - self set that are undetectable . in theory , for some matching rules",
    ", the number of holes can be very unfavorable  @xcite . in practical terms , the effect of holes depends on the characteristics of the non - self set , representation and matching rule  @xcite .",
    "the advantage of this algorithm is its _ simplicity _ and good experimental results in cases when the number of detectors to be produced is fixed and small  @xcite .",
    "a review of other approaches to detector computation can be found in  @xcite .",
    "a sensor network can be defined in graph theoretic framework as follows : a sensor network is a net @xmath0 where @xmath1 are the set of nodes and edges at time @xmath2 , respectively .",
    "nodes correspond to sensors that wish to communicate with each other .",
    "an edge between two nodes @xmath3 and @xmath4 is said to exist when @xmath3 is within the radio transmission range of @xmath4 and vice versa .",
    "the imposed symmetry of edges is a usual assumption of many mainstream protocols .",
    "the change in the cardinality of sets @xmath1 can be caused by switching on / off one of the sensors , failure , malfunction , removal , signal propagation , link reliability and other factors .",
    "data exchange in a point - to - point ( uni - cast ) scenario usually proceeds as follows : a user initiated data exchange leads to a route query at the network layer of the osi stack .",
    "a routing protocol at that layer attempts to find a route to the data exchange destination .",
    "this request may result in a path of non - unit length .",
    "this means that a data packet in order to reach the destination has to rely on successive forwarding by intermediate nodes on the path .",
    "an example of an on - demand routing protocol often used in sensor networks is dsr  @xcite .",
    "route search in this protocol is started only when a route to a destination is needed .",
    "this is done by flooding the network with rreq control packets .",
    "the destination node or an intermediate node that knows a route to the destination will reply with a rrep control packet .",
    "this rrep follows the route back to the source node and updates routing tables at each node that it traverses .",
    "a rerr packet is sent to the connection originator when a node finds out that the next node on the forwarding path is not replaying .    at the mac layer of the osi protocol stack , the medium reservation is often contention based . in order to transmit a data packet , the ieee 802.11 mac protocol uses carrier sensing with an rts - cts - data - ack handshake .",
    "should the medium not be available or the handshake fails , an exponential back - off algorithm is used .",
    "this is combined with a mechanism that makes it easier for neighboring nodes to estimate transmission durations .",
    "this is done by exchange of duration values and their subsequent storing in a data structure known as network allocation vector ( nav ) . with the goal to save battery power ,",
    "researchers suggested , a sleep - wake - up schedule for nodes would be appropriate .",
    "this means that nodes do not listen continuously to the medium , but switch themselves off and wake up again after a predetermined period of time .",
    "such a sleep and wake - up schedule is similarly to duration values exchanged among nodes .",
    "an example of a mac protocol , designed specifically for sensor networks , that uses such a schedule is the s - mac  @xcite . a sleep and wake - up schedule",
    "can severely limit operation of a node in _ promiscuous mode_. in promiscuous mode , a node listens to the on - going traffic in the neighborhood and collects information from the overheard packets .",
    "this technique is used e.g. in dsr for improved propagation of routing information .",
    "movement of nodes can be modeled by means of a mobility model .",
    "a well - known mobility model is the _ random waypoint model _  @xcite . in this model ,",
    "nodes move from the current position to a new randomly generated position at a predetermined speed . after reaching the new destination",
    "a new random position is computed .",
    "nodes pause at the current position for a time period @xmath2 before moving to the new random position .    for more information on sensor networks ,",
    "we refer the reader to  @xcite .",
    "motivated by the positive results reported in  @xcite we have undertaken a detailed performance study of ais with focus on sensor networks .",
    "the general conclusions that can be drawn from the study presented in this document are :    1 .  given the ranges of input parameters that we used and considering the computational capabilities of current sensor devices , we conclude that ais based misbehavior detection offers a decent detection rate .    2 .",
    "one of the main challenges in designing well performing ais for sensor networks is the set of `` genes '' .",
    "this is similar to observations made in  @xcite .    3 .",
    "our results suggest that to increase the detection performance , an ais should benefit from information available at all layers of the osi protocol stack ; this includes also detection performance with regards to a simplistic flavor of misbehavior such as packet dropping .",
    "this supports ideas shortly discussed in  @xcite where the authors suggest that information available at the application layer deserves more attention .",
    "we observed that somewhat surprisingly a gene based purely on the mac layer significantly contributed to the overall detection performance .",
    "this gene poses less limitations when a mac protocol with a sleep - wake - up schedule such as the s - mac  @xcite is used .",
    "it is desirable to use genes that are _ `` complementary '' _ with respect to each other .",
    "we demonstrated that two genes , one that measures correct forwarding of data packets , and the other one that indirectly measures the medium contention , have exactly this property .",
    "we only used a single instance of learning and detection mechanism per node .",
    "this is different from approach used in  @xcite , where one instance was used for each of @xmath5 possible neighbors .",
    "our performance results show that the approach in  @xcite may not be feasible for sensor networks .",
    "it may allow for an easy sybil attack and , in general , @xmath6 instances might be necessary , where @xmath7 is the total number of sensors in the network . instead , we suggest that flagging a node as misbehaving should , if possible , be based on detection at several nodes .",
    "7 .  only less than 5% detectors were used in detecting misbehavior .",
    "this suggests that many of the detectors do not comply with constraints imposed by the communications protocols ; this is an important fact when designing ais for sensor networks because the memory capacity at sensors is expected to be very limited .",
    "the data traffic properties seem not to impact the performance .",
    "this is demonstrated by similar detection performance , when data traffic is modeled as constant bit rate and poisson distributed data packet stream , respectively .",
    "we were unable to distinguish between nodes that misbehave ( e.g. deliberately drop data packets ) and nodes with a behavior resembling a misbehavior ( e.g. drop data packets due to medium contention ) .",
    "this motivates the use of danger signals as described in  @xcite .",
    "the approach applied in  @xcite does , however , not completely fit sensor networks since these might implement only a simplified version of the transport layer .",
    "in our approach , each node produces and maintains its own set of detectors .",
    "this means that we applied a direct one - to - one mapping between a human body with a thymus and a node .",
    "we represent self , non - self and detector strings as bit - strings .",
    "the matching rule employed is the _ r - contiguous bits matching rule_. two bit - strings of equal length match under the r - contiguous matching rule if there exists a substring of length @xmath8 at position @xmath9 in each of them and these substrings are identical .",
    "detectors are produced by the process shown in fig .",
    "[ fig : det_gen ] , i.e. by means of negative selection when detectors are created randomly and tested against a set of self strings .",
    "each antigen consists of several genes .",
    "_ genes _ are performance measures that a node can acquire locally without the help from another node . in practical terms",
    "this means that an antigen consists of @xmath10 genes ; each of them encodes a performance measure , averaged in our case over a time window .",
    "an antigen is then created by concatenating the @xmath10 genes .    when choosing the correct genes , the choice is limited due to the simplified osi protocol stack of sensors . for example",
    ", mica2 sensors  @xcite using the tinyos operating system do not guarantee any end - to - end connection reliability ( transport layer ) , leaving only data traffic at the lower layers for consideration .",
    "let us assume that the routing protocol finds for a connection the path @xmath11 from the source node @xmath12 to the destination node @xmath13 , where @xmath14 and @xmath15 .",
    "we have used the following _ genes _ to capture certain aspects of mac and routing layer traffic information ( we averaged over a time period ( window size ) of 500 seconds ) :    1 .   *",
    "mac layer : * 2 .",
    "ratio of complete mac layer handshakes between nodes @xmath16 and @xmath17 and rts packets sent by @xmath16 to @xmath17 .",
    "if there is no traffic between two nodes this ratio is set to @xmath18 ( a large number ) .",
    "this ratio is averaged over a time period .",
    "a complete handshake is defined as a completed sequence of rts , cts , data , ack packets between @xmath16 and @xmath17 .",
    "3 .   ratio of data packets sent from @xmath16 to @xmath17 and then subsequently forwarded by @xmath17 to @xmath19 . if there is no traffic between two nodes this ratio is set to @xmath18 ( a large number ) .",
    "this ratio is computed by @xmath16 in promiscuous mode and , as in the previous case , averaged over a time period .",
    "this gene was adapted from the watchdog idea in  @xcite .",
    "time delay that a data packet spends at @xmath17 before being forwarded to @xmath19 .",
    "the time delay is observed by @xmath16 in promiscuous mode . if there is no traffic between two nodes the time delay",
    "is set to zero .",
    "this measure is averaged over a time period .",
    "this gene is a quantitative extension of the previous gene .",
    "* routing layer : * 6 .   the same ratio as in # 2 but computed separately for rerr routing packets",
    ". 7 .   the same delay as in # 3 but computed separately for rerr routing packets .",
    "the gene # 1 can be characterized as mac layer quality oriented  _ it indirectly measures the medium contention level_. the remaining genes are watchdog oriented .",
    "this means that they more strictly fit a certain kind of misbehavior .",
    "the gene # 2 can help detect whether packets get correctly forwarded ; the gene # 3 can help detect whether forwarding of packets does not get intentionally delayed . as we will show later , in the particular type of misbehavior ( packet dropping ) that we applied ,",
    "the first two genes come out as `` the strongest '' .",
    "the disadvantage of the watchdog based genes is that due to limited battery power , nodes could operate using a sleep - wake - up schedule similar to the one used in the s - mac .",
    "this would mean that the node @xmath16 has to stay awake until the node @xmath17 ( monitored node ) correctly transmits to @xmath19 .",
    "the consequence would be a longer wake - up time and possible restrictions in publishing sleep - wake - up schedules .",
    "in  @xcite the authors applied a different a set of genes , based only on the dsr routing protocol .",
    "the observed set of events was the following : a = rreq sent , b = rrep sent , c = rerr sent , d = data sent and ip source address is not of the monitored ( neighboring ) node , e = rreq received , f = rrep received , g = rerr received , h = data received and the ip destination address is not of the monitored node .",
    "the events d and h take into consideration that the source and destination nodes of a connection might appear as misbehaving as they seem to `` deliberately '' create and delete data packets .",
    "then the set of their four genes is as follows :",
    "number of e over a time period .",
    "2 .   number of ( e*(a or b ) ) over a time period .",
    "number of h over a time period .",
    "4 .   number of ( h*d ) over a time period .",
    "the time period ( window size ) in their case was 10s ; * is the kleene star operator ( zero or more occurrences of any event(s ) are possible ) .",
    "similar to our watchdog genes , these genes impose additional requirements on mac protocols such as the s - mac .",
    "their dependence on the operation in promiscuous mode is , however , more pronounced as a node has to continuously observe packet events at all monitored nodes .",
    "the research in the area of what and to what extent can be or should be locally measured at a node , is independent of the learning mechanism used ( negative selection in both cases ) .",
    "performance of an ais can partly depend on the ordering and the number of used genes .",
    "since longer antigens ( consisting of more genes ) indirectly imply more candidate detectors , the number of genes should be carefully considered .",
    "given @xmath10 genes , it is possible to order them in @xmath20 different ways . in our experience ,",
    "the rules for ordering genes and the number of genes can be summed up as follows :    1 )  keep the number of genes small . in our experiments",
    ", we show that with respect to the learning mechanism used and the expected deployment ( sensor networks ) , 2 - 3 genes are enough for detecting a basic type of misbehavior .",
    "2 )  order genes either randomly or use a predetermined fixed order . defining a utility relation between genes , and ordering genes with respect to it can , in general , lead to problems that are considered intractable .",
    "our results however suggest , it is important to understand relations between different genes , since genes are able to complement each other ; this can lead to their increased mutual strength . on the other hand",
    ", random ordering adds to robustness of the underlying ais . for an attacker ,",
    "it is namely more difficult to deceive , since he does not know how genes are being used .",
    "it is currently an open question , how to impose a balanced solution .",
    "3 )  genes can not be considered in isolation .",
    "our experiments show , when a detector matched an antigen under the @xmath8-contiguous matching rule , usually this match spanned over several genes .",
    "this motivates design of matching rules that would not limit matching to a few neighboring genes , offer more flexibility but still require that a gene remains a partly atomic unit .      learning and detection",
    "is done by applying the mechanisms shown in figs .",
    "[ fig : det_gen ] and  [ fig : non_self_det ] .",
    "the detection itself is very straightforward . in the learning phase , a misbehavior - free period ( see  @xcite on possibilities for circumventing this problem ) is necessary so that nodes get a chance to learn what is the normal behavior . when implementing the learning phase , the designer gets to choose from two possibilities :    1 )  learning and detection at a node get implemented for each neighboring node separately",
    "this means that different antigens have to get computed for each neighboring node , detector computation is different for each neighboring node and , subsequently , detection is different for each neighboring node .",
    "the advantage of this approach is that the node is able to directly determine which neighboring node misbehaves ; the disadvantage is that @xmath5 instances ( @xmath5 is the number of neighbors or node degree ) of the negative selection mechanism have to get executed ; this can be computationally prohibitive for sensor networks as @xmath5 can , in general , be equal to the total number of sensor .",
    "this allows for an easy sybil attack  @xcite in which a neighbor would create several identities ; the node would then be unable to recognize that these identities belong to the same neighbor .",
    "this approach was used in  @xcite .",
    "2 )  learning and detection at a node get implemented in a single instance for all neighboring nodes .",
    "this means a node is able to recognize anomaly ( misbehavior ) but it may be unable to determine which one from the @xmath5 neighboring nodes misbehaves .",
    "this implies that nodes would have to cooperate when detecting a misbehaving node , exchange anomaly information and be able to draw a conclusion from the obtained information .",
    "an argument for this approach is that in order to detect nodes that misbehave in collusion , it might be necessary to rely to some extent on information exchange among nodes , thus making this a natural solution to the problem .",
    "we have used this approach ; a post - processing phase ( using the list of misbehaving nodes ) was necessary to determine whether a node was correctly flagged as misbehaving or not .",
    "we find the second approach to be more suited for wireless sensor networks .",
    "it is namely less computationally demanding .",
    "we are unable , at this time , to estimate the frequency of a complete detector set computation .",
    "both approaches can be classified within the four - layer architecture ( fig .",
    "[ fig : arch ] ) that we introduced in  @xcite .",
    "the lowermost layer , data collection and preprocessing , corresponds to genes computation and antigen construction .",
    "the learning layer corresponds to the negative selection process .",
    "the next layer , local and co - operative detection , suggests , an ais should benefit from both local and cooperative detection .",
    "both our setup and the setup described in  @xcite only apply _ local _ detection .",
    "the uppermost layer , local and co - operative response , implies , an ais should also have the capability to undertake an action against one or several misbehaving nodes ; this should be understood in a wider context of co - operating wireless devices acting in collusion in order to suppress or minimize the adverse impact of such misbehavior .",
    "to our best knowledge , there is currently no ais implementation for sensor networks taking advantage of this layer .",
    "_ which @xmath8 is the correct one ? _",
    "an interesting technical problem is to tune the @xmath8 parameter for the @xmath8-contiguous matching rule so that the underlying ais offers good detection and false positives rates .",
    "one possibility is a lengthy simulation study such as this one . through multiparameter simulation",
    "we were to able to show that @xmath21 offers the best performance for our setup . in  @xcite",
    "we experimented with the idea of `` growing '' and `` shrinking '' detectors ; this idea was motivated by  @xcite .",
    "the initial @xmath22 for a growing detector can be chosen as @xmath23 , where @xmath24 is the detector length .",
    "the goal is to find the smallest @xmath8 such that a candidate detector does not match any self antigen .",
    "this means , initially , a larger ( more specific ) @xmath8 is chosen ; the smallest @xmath8 that fulfills the above condition can be found through binary search . for shrinking detectors",
    ", the approach is reciprocal .",
    "our goal was to show that such growing or shrinking detectors would offer a better detection or false positives rate .",
    "short of proving this in a statistically significant manner , we observed that the growing detectors can be used for self tuning the @xmath8 parameter .",
    "the average @xmath8 value was close to the @xmath8 determined through simulation ( the setup in that case was different from the one described in this document ) .",
    "our experiments show that only a small number of detectors get ever used ( less than 5% ) .",
    "the reason is , they get produced in a random way , not considering structure of the protocols .",
    "for example , a detector that is able to detect whether i ) data packets got correctly transmitted and ii ) 100% of all mac layers handshakes were incomplete is superfluous as this case should never happen . in  @xcite ,",
    "the authors conclude : _",
    "`` ... uniform coverage of non - self space is not only unnecessary , it is impractical ; non - self space is too big''_. application driven knowledge can be used to set up a rule based system that would exclude infeasible detectors ; see  @xcite for a rule based system aimed at improved coverage of the non - self set . in  @xcite , it is suggested that unused detectors should get deleted and the lifetime of useful detectors should be extended .      in a companion paper  @xcite , we have reviewed different types of misbehavior at the mac , network and transport layers of the osi protocol stack .",
    "we note that solutions to many of these attacks have been already proposed ; these are however specific to a given attack . additionally , due to the limitations of sensor networks , these solutions can not be directly transfered .    the appeal of ais based misbehavior detection rests on its simplicity and applicability in an environment that is extremely computationally and bandwidth limited .",
    "misbehavior in sensor networks does not have to be executed by sensors themselves ; one or several computationally more powerful platforms ( laptops ) can be used for the attack . on the other hand , a protection using such more advanced computational platforms is , due to e.g. the need to supply them continuously with electric power , harder to imagine .",
    "it would also create a point of special interest for the possible attackers .",
    "the purpose of our experiments was to show that ais are a viable approach for detecting misbehavior in sensor networks .",
    "furthermore , we wanted to cast light on internal performance of an ais designed to protect sensor networks .",
    "one of our central goals was to provide an in - depth analysis of relative usefulness of genes .",
    "_ definitions of input and output parameters : _ the input parameters for our experiments were : @xmath8 parameter for the @xmath8-contiguous matching rule , the ( desired ) number of detectors and misbehavior level .",
    "misbehavior was modeled as random packet dropping at selected nodes .",
    "+ the performance ( output ) measures were arithmetic averages and 95% confidence intervals @xmath25 of detection rate , number of false positives , real time to compute detectors , data traffic rate at nodes , number of iterations to compute detectors ( number of random tries ) , number of non - valid detectors , number of different ( unique ) antigens in a run or a time window , and number of matches for each gene .",
    "the detection rate @xmath26 is defined as @xmath27 , where @xmath28 is the number of detected non - self strings and @xmath29 is the total number of non - self strings . a false positive in our definition",
    "is a string that is not self but can still be a result of anomaly that is identical with the effects of a misbehavior .",
    "a non - valid detector is a candidate detector that matches a self string and must therefore be removed .",
    "the number of matches for each gene was evaluated using the @xmath8-contiguous matching rule ; we considered two cases : i ) two bit - strings get matched from the left to the right and the first such a match will get reported ( matching gets interrupted ) , ii ) two bit - strings get matched from the left to the right and all possible matches will get reported .",
    "the time complexity of these two approaches is @xmath30 and @xmath31 , respectivelly ; @xmath32 , where @xmath24 is the bitstring length .",
    "the first approach is exactly what we used when computing the real time necessary for negative selection , the second approach was used when our goal was to evaluate relative usefulness of each gene .",
    "* scenario description : * we wanted to capture `` self '' and `` non - self '' packet traffic in a large enough synthetic static sensor network and test whether using an ais we are able to recognize non - self , i.e. misbehavior .",
    "the topology of this network was determined by making a _ snapshot _ of 1,718 mobile nodes ( each with 100 m radio radius ) moving in a square area of 2,900m@xmath332,950 m as prescribed by the random waypoint mobility model ; see figure  [ fig : topo](a ) .",
    "the motivation in using this movement model and then creating a snapshot are the results in our previous paper  @xcite that deals with structural robustness of sensor network .",
    "our preference was to use a slightly bigger network than it might be necessary , rather than using a network with unknown properties .",
    "the computational overhead is negligible ; simulation real time mainly depends on the number of events that require processing .",
    "idle nodes increase memory requirements , but memory availability at computers was in our case not a bottleneck .",
    "we chose source and destination pairs for each connection so that several alternative independent routes exist ; the idea was to benefit from route repair and route acquisition mechanisms of the dsr routing protocol , so that the added value of ais based misbehavior detection is obvious .",
    "we used 10 cbr ( constant bit rate ) connections .",
    "the connections were chosen so that their length is @xmath347 hops and so that these connections share some common intermediate nodes ; see figure  [ fig : topo](b ) . for each packet received or sent by a node",
    "we have captured the following information : ip header type ( udp , 802.11 or dsr in this case ) , mac frame type ( rts , cts , data , ack in the case of 802.11 ) , current simulation clock , node address , next hop destination address , data packet source and destination address and packet size .    _",
    "encoding of self and non - self antigens : _ each of the five genes was transformed in a 10-bit signature where each bit defines an interval of a gene specific value range .",
    "we created self and non - self antigen strings by concatenation of the defined genes .",
    "each self and non - self antigen has therefore a size of 50 bits .",
    "the interval representation was chosen in order to avoid carry - bits ( the gray coding is an alternative solution ) .",
    "_ constructing the self and non - self sets : _ we have randomly chosen 28 non - overlapping 500-second windows in our 4-hour simulation . in each 500-second window self and non - self antigens",
    "are computed for each node .",
    "this was repeated 20 times for independent glomosim runs .    _",
    "misbehavior modeling : _ misbehavior is modeled as random data packet dropping ( implemented at the network layer ) ; data packets include both data packets from the transport layer as well as routing protocol packets . that should get dropped will simply not be inserted into the ip queue ) ; we have randomly chosen 236 nodes and these were forced to drop @xmath35 of data packets .",
    "however , there were only 3 - 10 nodes with misbehavior and with a _ statistically significant _ number of packets for forwarding in each simulation run ; see constraint c2 in section  [ sec : eval ] .",
    "_ detection : _ a neighboring node gets flagged as misbehaving , if a detector from the detector set matches an antigen .",
    "since we used a single learning phase , we had to complement this process with some routing information analysis .",
    "this allowed us to determine , which one from the neighboring nodes is actually the misbehaving one . in the future",
    ", we plan to rely on co - operative detection in order to replace such a post - analysis .",
    "_ simulation phases : _ the experiment was done in four phases .    1 .",
    "20 independent glomosim runs were done for one of @xmath35 misbehavior levels and `` normal '' traffic .",
    "normal means that no misbehavior took place .",
    "2 .   self and non - self antigen computation ( encoding ) .",
    "the 20 `` normal '' traffic runs were used to compute detectors . given the 28 windows and 20 runs , the sample size was 20@xmath3328 = 560 , i.e. detectors at each node were discriminated against 560 self antigens .",
    "4 .   using the runs with @xmath35 misbehavior levels ,",
    "the process shown in fig .",
    "[ fig : non_self_det ] was used for detection ; we restricted ourselves to nodes that had in both the normal and misbehavior traffic at least a certain number of data packets to forward ( packet threshold ) .",
    "the experiment was then repeated with different @xmath8 , desired number of detectors and misbehavior level .",
    "the parameters for this experiment are summarized in fig .",
    "[ fig : exp - parameters2 ] .",
    "the injection rate and packet sizes were chosen in order to comply with usual data rates of sensors ( e.g. 38.4kbps for mica2 ; see  @xcite ) .",
    "we chose the glomosim simulator  @xcite over other options ( most notably ns2 ) because of its better scaling characteristics  @xcite and our familiarity with the tool .",
    "when evaluating our results we define two additional constraints :    1 .",
    "we define a node to be detected as misbehaving if it gets flagged in at least 14 out of the 28 possible windows .",
    "this notion indirectly defines the time until a node is pronounced to be misbehaving .",
    "we call this a _ window threshold_. 2",
    ".   a node @xmath16 has to forward in average at least @xmath5 packets over the 20 runs in both the `` normal '' and misbehavior cases in order to be included into our statistics .",
    "this constraint was set in order to make the detection process more reliable .",
    "it is dubious to flag a neighboring node of @xmath16 as misbehaving , if it is based on `` normal '' runs or runs with misbehavior , in which node @xmath16 had no data packets to forward ( he was not on a routing path ) .",
    "we call this a _ packet threshold _ ; @xmath5 was in our simulations chosen from @xmath36 .",
    "_ example : _ for a fixed set of input parameters , a node forwarded in the `` normal '' runs in average 1,250 packets and in the misbehavior runs ( with e.g. level 30% ) 750 packets .",
    "the node @xmath16 would be considered for misbehavior detection if @xmath37 , but not if @xmath38 . in other words ,",
    "a node has to get a chance to learn what is `` normal '' and then to use this knowledge on a non - empty packet stream .",
    "the results related to computation of detectors are shown in figure  [ fig:300 m ] . in our experiments",
    "we have considered the desired number of detectors to be max .",
    "4,000 ; over this threshold the computational requirements might be too high for current sensor devices .",
    "we remind the reader , each time the @xmath8 parameter is incremented by @xmath39 , the number of detectors should double in order to make these two cases comparable .",
    "figure  [ fig:300m](a ) shows the real time needed to compute the desired set of detectors .",
    "we can see the real time necessary increases proportionally with the desired number of detectors ; this complies with the theoretical results presented in  @xcite .",
    "figure  [ fig:300m](b ) shows the percentage of non - valid detectors , i.e. candidate detectors that were found to match a self string ( see figure  [ fig : det_gen ] ) .",
    "this result points to where the optimal operation point of an ais might lie with respect to the choice of @xmath8 parameter and the choice of a fixed number of detectors to compute .",
    "we remind the reader , the larger is the @xmath8 parameter the smaller is the probability that a detector will match a self string .",
    "therefore overhead connected to choosing the @xmath8 parameter prohibitively small should be considered when designing an ais .",
    "figure  [ fig:300m](c ) shows the total number of generate - and - test tries needed for computation of detector set of a fixed size ; the 95% confidence interval is less than @xmath40 .    in figure",
    "[ fig : perform](a ) we show the dependence of detection ratio on the packet threshold .",
    "we conclude that except for some extremely low threshold values ( not shown ) the detection rate stays constant .",
    "this figure also shows that when misbehavior level was set very low , i.e. 10% , the ais struggled to detect misbehaving nodes .",
    "this is partly a result of our coarse encoding with only 10 different levels .    at the 30 and 50% misbehaving levels the detection rate stays solid at about 70 - 85% .",
    "the range of the 95% confidence interval of detection rate is 3.8 - 19.8% .",
    "the fact that the detection rate did not get closer to 100% suggests , either the implemented genes are not sufficient , detection should be extended to protocols at other layers of the osi protocol stack , a different ordering of genes should have been applied or our ten level encoding was too coarse .",
    "it also implicates that watchdog based genes ( though they perfectly fit the implemented misbehavior ) should not be used in isolation , and in general , that the choice of genes has to be very careful",
    ". figure  [ fig : perform](b ) shows the impact of @xmath8 on detection rate . when @xmath41 the ais performs well , for @xmath42 the detection rate decreases .",
    "this is caused by the inadequate numbers of detectors used at higher levels of @xmath8 ( we limited ourselves to max .",
    "4,000 detectors ) .    figure  [ fig : perform](c ) shows the number of false positives .",
    "we remind that in our definition false positives are both nodes that do not drop any packets and nodes that drop packets due to other reasons than misbehavior .    in a separate experiment we studied whether the 4-hour ( 560 samples ) simulation time was enough to capture the diversity of the self behavior .",
    "this was done by trying to detect misbehavior in 20 independent misbehavior - free glomosim runs ( different from those used to compute detectors ) .",
    "we report that we did not observe a single case of an autoimmune reaction .      in fig .",
    "[ fig : det_used1](a ) we show the total number of runs in which a node was identified as misbehaving . the steep decline for values @xmath43 ( in this and other figures ) documents that in these cases it was necessary to produce a higher number of detectors in order to cover the non - self antigen space .",
    "the higher the @xmath8 , the higher is the specificity of a detector , this means that it is able to match a smaller set of non - self antigens .    in fig .",
    "[ fig : det_used1](b ) and ( c ) we show the number of detectors that got matched during the detection phase ( see fig .",
    "[ fig : non_self_det ] ) . fig .",
    "( b ) shows the number of detectors matched per run , fig .",
    "( c ) shows the number of detectors matched per window .",
    "( b ) is an upper estimate on the number of unique detectors needed in a single run .",
    "given that the total number of detectors was 2,000 , there were less than 5% detectors that would get used in the detection phase .",
    "the tight confidence intervals only for @xmath44 . ] for the number of unique detectors matched per window ( see fig .",
    "( c ) ) is a direct consequence of the small variability of antigens as shown in fig .",
    "[ fig : det_used2](a ) .    fig .",
    "[ fig : det_used2](a ) shows the number of unique antigens that were subject to classification into self or non - self .",
    "the average for @xmath45 is about 1.5 .",
    "this fact does not directly imply that the variability of the data traffic would be inadequate .",
    "it is rather a direct consequence of our choice of genes and their encoding ( we only used 10 value levels for encoding ) .",
    "[ fig : det_used2](b ) shows the number of matches between a detector and an antigen in the following way .",
    "when a detector under the @xmath8-contiguous matching rule matches only a single gene within an antigen , we would increment the `` single '' counter .",
    "otherwise , we would increment the `` multiple '' counter .",
    "it is obvious that with increasing @xmath8 , it gets more and more probable that a detector would match more than a single gene .",
    "the interesting fact is that the detection rate for both @xmath46 and @xmath47 is about 80% ( see fig .",
    "[ fig : perform](a ) ) and that the rate of non - valid detectors is very different ( see fig .",
    "[ fig:300m](b ) ) .",
    "this means that an interaction between genes has positively affected the later performance measure , without sacrificing on the former one .",
    "this leads to a conlusion that genes should not be considered in isolation .    fig .",
    "[ fig : det_used2](c ) shows the performance of gene # 1 .",
    "the number of matches shows that this gene contributed to the overall detection performance of our ais .",
    "[ fig : det_used3](a - c ) sum up performance of the five genes for different values of @xmath8 .",
    "again , an interesting fact is the contribution of gene # 1 to the overall detection performance .",
    "the usefulness of gene # 2 was largely expected as this gene was tailored for the kind of misbehavior that we implemented .",
    "the other three genes came out as marginally useful .",
    "the importance of the somewhat surprising performance of gene # 1 is that it can be computed in a simplistic way and does not require continuous operation of a node .      in an additional experiment",
    ", we examined the impact of data traffic pattern on the performance .",
    "we used two different data traffic models : the constant bit rate ( cbr ) and a poisson distributed data traffic . in many scenarios ,",
    "sensors are expected to take measurements in constant intervals and , subsequently , send them out for processing .",
    "this would create a constant bit rate traffic .",
    "poisson distributed traffic could be a result of sensors taking measurements in an event - driven fashion .",
    "for example , a sensor would take a measurement only when a target object ( e.g. a person ) happens to be in its vicinity .",
    "the setup for this experiment was similar to that presented in fig .",
    "[ fig : exp - parameters2 ] with the additional fact that the data traffic model would now become an input parameter . with the goal to reduce complexity of the experimental setup , we fixed @xmath47 and we only considered cases with @xmath48 and @xmath49 detectors . in order to match the cbr traffic rate , the poisson distributed data traffic model had a mean arrival expectation of @xmath39 packet per second ( @xmath50 ) .",
    "as in the case with cbr , we computed the detection rate and the rate of false positives with the associated arithmetic averages and @xmath51 confidence intervals .    the results based on these two traffic models were similar , actually , we could not find the difference between them to be statistically significant .",
    "this points out that the detection process is robust against some variation in data traffic .",
    "this conclusion also reflects positively on the usefulness of the used genes .",
    "more importantly , it helped disperse our worries that the results presented in this experimental study could be unacceptably data traffic dependent .",
    "in  @xcite the authors introduced an ais based misbehavior detection system for ad hoc wireless networks .",
    "they used glomosim for simulating data traffic , their setup was an area of 800@xmath33600 m with 40 mobile nodes ( speed 1 m / s ) of which 5 - 20 are misbehaving ; the routing protocol was dsr .",
    "four genes were used to capture local behavior at the network layer .",
    "the misbehavior implemented is a subset of misbehavior introduced in this paper ; their observed detection rate is about 55% .",
    "additionally , a co - stimulation in the form of a danger signal was used in order to inform nodes on a forwarding path about misbehavior , thus propagating information about misbehaving nodes around the network .    in  @xcite",
    "the authors describe an ais able to detect anomalies at the transport layer of the osi protocol stack ; only a wired tcp / ip network is considered .",
    "self is defined as normal pairwise connections .",
    "each detector is represented as a 49-bit string .",
    "the pattern matching is based on r - contiguous bits with a fixed @xmath52 .",
    "@xcite discusses a network intrusion system that aims at detecting misbehavior by capturing tcp packet headers .",
    "they report that their ais is unsuitable for detecting anomalies in communication networks .",
    "this result is questioned in  @xcite where it is stated that this is due to the choice of problem representation and due to the choice of matching threshold @xmath8 for @xmath8-contiguous bits matching .    to overcome the deficiencies of the generate - and - test approach a different approach",
    "is outlined in  @xcite .",
    "several signals each having a different function are employed in order to detect a specific misbehavior in sensor wireless networks .",
    "unfortunately , no performance analysis was presented and the properties of these signals were not evaluated with respect to their misuse .",
    "the main discerning factor between our work and works shortly discussed above is that we carefully considered hardware parameters of current sensor devices , the set of input parameters was designed in order to target specifically sensor networks and our simulation setup reflects structural qualities of such networks with regards to existence of multiple independent routing paths . in comparison to  @xcite we showed that in case of static sensor networks it is reasonable to expect the detection rate to be above 80% .",
    "although we answered some basic question on the suitability and feasibility of ais for detecting misbehavior in sensor networks a few questions remain open .",
    "the key question in the design of ais is the quantity , quality and ordering of genes that are used for measuring behavior at nodes . to answer this question a detailed formal analysis of communications protocols",
    "will be needed .",
    "the set of genes should be as `` complete '' as possible with respect to any possible misbehavior .",
    "the choice of genes should impose a high degree of sensor network s survivability defined as _the capability of a system to fulfill its mission in a timely manner , even in the presence of attacks , failures or accidents _",
    "it is therefore of paramount importance that the sensor network s mission is clearly defined and achievable under normal operating conditions .",
    "we showed the influence and usefulness of certain genes in order to detect misbehavior and the impact of the @xmath8 parameter on the detection process .",
    "in general , the results in fig .  [",
    "fig : det_used3 ] show that gene # 1 and # 2 obtained of all genes the best results , with gene # 2 showing always the best results .",
    "the contribution of gene # 1 suggests that observing the mac layer and the ratio of complete handshakes to the number of rts packets sent is useful for the implemented misbehaviour .",
    "gene # 2 fits perfectly for the implemented misbehavior .",
    "it therefore comes as no surprise that this gene showed the best results in the detection process .",
    "the question which remains open is whether the two genes are still as useful when exposed to different attack patterns .",
    "it is currently unclear whether genes that performed well with negative selection , will also be appropriate for generating different flavors of signals as suggested within the _ danger theory _",
    "it is our opinion that any set of genes , whether used with negative selection or for generating any such a signal , should aim at capturing intrinsic properties of the interaction among different components of a given sensor network .",
    "this contradicts approaches applied in  @xcite where the genes are closely coupled with a given protocol .",
    "the reason for this statement is the _ combined performance _ of gene # 1 and # 2 .",
    "their interaction can be understood as follows : data packet dropping implies less medium contention since there are less data packets to get forwarded .",
    "less data packets to forward on the other hand implies easier access to the medium , i.e. the number of complete mac handshakes should increase .",
    "this is an interesting _ complementary _ relationship since in order to deceive these two genes , a misbehaving node has to appear to be correctly forwarding data packets and , at the same time , he should not significantly modify the `` game '' of medium access .",
    "it is improbable that the misbehaving node _ alone _ would be able to estimate the impact of dropped packets on the contention level .",
    "therefore , he lacks an important feedback mechanism that would allow him to keep the contention level unchanged . for that",
    ", he would need to act in collusion with other nodes .",
    "the property of complementarity moves the burden of excessive communication from normally behaving nodes to misbehaving nodes , thus , exploiting the ad hoc ( local ) nature of sensor networks .",
    "our results thus imply , _ a `` good '' mixture of genes should be able to capture interactions that a node is unable to influence when acting alone . _",
    "it is an open question whether there exist other useful properties of genes , other than complementarity .",
    "we conclude that the random - generate - and - test process , with no knowledge of the used protocols and their behavior , creates many detectors which might show to be superfluous in detecting misbehavior .",
    "a process with some basic knowledge of protocol limitations might lead to improved quality of detectors .    in",
    "@xcite the authors stated that the random - generate - and - test process _",
    "`` is innefficient , since a vast number of randomly generated detectors need to be discarded , before the required number of the suitable ones are obtained '' . _",
    "our results show that at @xmath21 , the rate of discarded detectors is less than @xmath53 .",
    "hence , at least in our setting we could not confirm the above statement .",
    "a disturbing fact is , however , that the size of the self set in our setting was probably too small in order to justify the use of negative selection .",
    "a counter - balancing argument is here the realistic setup of our simulations and a decent detection rate .",
    "we would like to point out that the fisher iris and biomedical data sets , used in  @xcite to argue about the apropriateness of negative selection for anomaly detection , could be very different from data sets generated by our simulations .",
    "our experiments show that anomaly ( misbehavior ) data sets based on sensor networks could be in general very sparse .",
    "this effect can be due to the limiting nature of communications protocols .",
    "since the fisher iris and biomedical data sets were in  @xcite not evaluated with respect to some basic properties e.g. degree of clustering , it is hard to compare our results with the results presented therein .    in order to understand the effects of misbehavior better ( e.g. the propagation of certain adverse effects )",
    ", we currently develop a general framework for ais to be used within the jist / swans network simulator  @xcite .",
    "this work was supported by the german research foundation ( dfg ) under the grant no .",
    "sz 51/24 - 2 ( survivable ad hoc networks  sane ) ."
  ],
  "abstract_text": [
    "<S> a sensor network is a collection of wireless devices that are able to monitor physical or environmental conditions . these devices ( nodes ) </S>",
    "<S> are expected to operate autonomously , be battery powered and have very limited computational capabilities . </S>",
    "<S> this makes the task of protecting a sensor network against misbehavior or possible malfunction a challenging problem . in this document </S>",
    "<S> we discuss performance of artificial immune systems ( ais ) when used as the mechanism for detecting misbehavior .    </S>",
    "<S> we show that ( i ) mechanism of the ais have to be carefully applied in order to avoid security weaknesses , ( ii ) the choice of genes and their interaction have a profound influence on the performance of the ais , ( iii ) randomly created detectors do not comply with limitations imposed by communications protocols and ( iv ) the data traffic pattern seems not to impact significantly the overall performance .    </S>",
    "<S> we identified a specific mac layer based gene that showed to be especially useful for detection ; genes measure a network s performance from a node s viewpoint . </S>",
    "<S> furthermore , we identified an interesting complementarity property of genes ; this property exploits the local nature of sensor networks and moves the burden of excessive communication from normally behaving nodes to misbehaving nodes . </S>",
    "<S> these results have a direct impact on the design of ais for sensor networks and on engineering of sensor networks .    </S>",
    "<S> = 1.0    sensor networks , ad hoc wireless networks , artificial immune systems , misbehavior . </S>"
  ]
}