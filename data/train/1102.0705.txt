{
  "article_text": [
    "hybrid systems are those systems involving both continuous evolutions and discrete transitions .",
    "how to design correct ( desired ) hybrid systems is a grand challenge in computer science and control theory . from a computer scientist",
    "s point of view , the main concern on hybrid systems up to now is to verify so - called safety properties .",
    "a safety property claims that some unsafe state is never reachable from any initial state along with any trajectory of the system .      directly computing",
    "the reachable set is a natural way to address this issue .",
    "as we know , there are two well - developed techniques for computing reachable set so far , that is , techniques based on model - checking @xcite and the decision procedure of tarski algebra @xcite , respectively .",
    "however , the former technique requires the decidability and therefore can only be applied to some simple hybrid systems , e.g. timed automata @xcite , multirate automata @xcite , rectangular automata @xcite , and so on . comparably speaking",
    ", the latter technique has a wider scope of applications .",
    "for example , in @xcite how to compute reachable sets for three classes of special linear hybrid systems are investigated . however , this technique heavily depends on whether the explicit solutions of the considered differential equations are or can be reduced to polynomials .",
    "so , this approach can not be applied to general linear hybrid systems , let alone nonlinear systems .    to deal with more complicated systems , recently , a deductive method has been established and successfully applied in practice @xcite , which can be seen as a generalization of the so - called floyd - hoare - naur inductive assertion method .",
    "inductive assertion method is thought to be the dominant method for the verification of sequential programs . to generalize the inductive method to hybrid systems ,",
    "a logic similar to hoare logic which can deal with continuous dynamics is necessary .",
    "for example , differential - algebraic dynamic logic @xcite due to platzer was invented by extending dynamic logic with continuous statements .",
    "recently , liu et al @xcite had another effort by extending hoare logic to hybrid systems for the same purpose .    the most challenging part of the inductive method is how to discover invariants of hybrid systems .",
    "an invariant is a property that holds at all reachable states from any initial state that satisfies this property .",
    "if we can get invariants that are strong enough to imply the safety property to be verified , then we succeed in safety verification without solving differential equations , while differential equations have to be exactly solved or approximated in the methods via directly computing reachable sets . in particular , if the term expressions of a hybrid system are or can be reduced to polynomials , the so - called _ inductive invariants _ @xcite can be effectively generated using the constraint - based approach @xcite .",
    "the key issue in generating inductive invariants of a hybrid system is to deal with continuous dynamics , i.e. to generate continuous invariant of the continuous evolution at each location ( mode ) of the hybrid system . a location ( mode ) of a hybrid system is usually represented by a _ continuous dynamical system with domain and initial condition _ ( cdswdi for short ) of the form @xmath0 , where @xmath1 is a vector field",
    ", @xmath2 is a domain restriction of continuous evolution , and @xmath3 is a set of initial states . a property @xmath4 is called a _ continuous invariant _ ( ci for short ) of @xmath5 , if it is always satisfied along any trajectory whose starting point satisfies @xmath6 , as long as the trajectory still remains in domain @xmath2 . for @xmath4 to be a ci of @xmath5 , the more complex the forms of @xmath2 , @xmath7 , @xmath6 and @xmath4 are , the more intricate constraints should be induced accordingly .",
    "a global ( discrete ) inductive invariant of a hybrid system consists of a set of cis such that : the initial condition of the initial location ( mode ) entails the ci of the initial location , and if there is a discrete transition between two locations of the system , then the ci at the pre - location implies the ci at the post - location w.r.t .",
    "the discrete transition .",
    "there are many methods , e.g. @xcite , for certifying and generating global inductive invariants of a system by using the global inductiveness .",
    "therefore in this paper we only focus on how to generate ci at a single location ( mode ) , i.e. a cdswdi .      in the literature",
    ", lots of efforts have been made towards algebraic or semi - algebraic continuous invariants generation for polynomial dynamical systems , even though ci may have different synonyms .",
    "the generation of algebraic invariants , i.e. sets defined by polynomial equations are usually based on the theory of ideals in polynomial ring . in @xcite , to handle continuous differential equations , two strong continuous consecution conditions are imposed on the predefined templates , and then the two conditions are encoded as ideal membership statements . the work in @xcite showed that the set of algebraic invariants of a linear system , which forms a polynomial ideal , is computable .",
    "the above two approaches both use _ grbner bases _ computation .",
    "an efficient technique that computes algebraic invariants as the greatest fixed point of a monotone operator over _ pseudo ideals _ was presented in @xcite .    as for the polynomial inequality case , to guarantee that @xmath8 is a ci of a pds @xmath5 , it is useful to analyze the direction of @xmath7 with regard to the set @xmath8 . in @xcite ,",
    "the authors proposed the notion _ barrier certificates _ for safety verification of hybrid systems .",
    "a polynomial @xmath9 could be a barrier certificate if the unsafe region is included in @xmath10 , and at any point in @xmath11 , @xmath7 points ( strictly ) inwards the set @xmath8 .",
    "such polynomial barrier certificates can be effectively computed using sum of squares decomposition and semi - definite programming . in @xcite a similar idea is adopted and by reducing the conditions of ci to semi - algebraic constraints , invariants that are boolean combinations of polynomial equations and inequalities can be generated .",
    "unfortunately , the approaches in @xcite were discovered in @xcite to have certain problems with their soundness , if at the boundary of a ci , @xmath7 is not strictly inward the invariant set . in @xcite",
    "the authors proposed the notion of _ differential invariant _ and the principle of differential induction .",
    "basically , @xmath8 is a differential invariant of @xmath5 if at any point in @xmath2 , the directional derivative of @xmath9 in the direction of @xmath7 is non - negative .",
    "such requirement is strong , but provide a sound and effective way of generating complex semi - algebraic continuous invariants .",
    "the problem of checking inductiveness for continuous dynamical systems was considered in @xcite and @xcite . therein various sound checking rules are presented , which are also complete for classes of continuous invariants , e.g. linear , quadratic , convex and smooth invariants .",
    "the authors even proposed a sound and relatively complete rule using higher order _ lie derivatives _ , which is quite similar to ours .",
    "however , in their relatively complete rule there are infinitely many candidate tests and thus is computationally infeasible .",
    "our work in this paper actually resolves this problem and completes the gap left open in @xcite    the relative completeness of our method means that for a given pds , if there is an sai of the predefined template , then our method can indeed discover one sai using this template .",
    "thus , there are two advantages with our approach comparing with the well - established approaches : firstly , more general sais can be generated ; secondly , a by - product of the completeness of our approach is that whether a given semi - algebraic set is really an sai of a given pds is decidable .",
    "this is quite useful in the interplay of discrete invariant generation ( global ) and ci generation ( local ) .",
    "the rest of this paper is organized as follows .",
    "section [ sec : prelim ] presents some basic notions and fundamental theories on algebraic geometry and dynamical system .",
    "section [ sec : di ] gives a formal definition of the sai generation problem . in section [ sec : fund ] , we prove the fundamental results based on which our method is developed .",
    "section [ sec : idea ] illustrates the basic idea of our approach in simple cases . how to apply our approach to general cases is investigated in section [ sec : aig ] .",
    "two case studies are given in section [ sec : case ] .",
    "section [ sec : con ] concludes this paper with a discussion of future work .",
    "in this section , we will recall some basic notions .",
    "let @xmath12 be an algebraic field and @xmath13 $ ] denote the polynomial ring with coefficients in @xmath12 . in this paper , @xmath12 will be taken as the rational number field @xmath14 . customarily , let @xmath15 denote the @xmath16-tuple @xmath17 with @xmath18 , and a polynomial in @xmath19 $ ] ( @xmath20 $ ] for short )",
    "may be written as @xmath21 or @xmath9 simply . a parametric polynomial @xmath22\\ ] ] is called a _ template _ , where @xmath15 are variables taking values from @xmath23 and @xmath24 are coefficient parameters taking values from @xmath25 .",
    "given @xmath26 , we call the polynomial @xmath27 resulted by substituting @xmath28 for @xmath24 in @xmath29 an _ instantiation _ of @xmath29 .",
    "in what follows , we recall the theory of polynomial ideal ( refer to @xcite ) .",
    "a subset @xmath30 $ ] is called an _ ideal _ if    1 .",
    "2 .   if @xmath32 , then @xmath33 .",
    "3 .   if @xmath34 and @xmath35 $ ] , then @xmath36 .",
    "it is easy to check that if @xmath37 $ ] , then @xmath38 .",
    "\\,h_i \\in \\mathbb{k}[{\\mathbf{x}}]\\}\\ ] ] is an ideal . in general",
    ", we say an ideal @xmath39 is _ generated _ by polynomials @xmath40 $ ] if @xmath41 , and @xmath42 is called a set of _ generators _ of @xmath39 .",
    "every ideal @xmath30 $ ] has a finite generating set .",
    "that is , @xmath43 for some @xmath44 $ ] .    for its proof",
    ", please refer to @xcite . based upon this result",
    ", it is easy to see that    [ acc ] for any ascending chain @xmath45 of ideals in polynomial ring @xmath46 $ ] , there must be @xmath47 such that for all @xmath48 , @xmath49 .",
    "an atomic polynomial formula over variables @xmath50 is @xmath51 , where @xmath9 is a polynomial in @xmath52 $ ] and @xmath53 .",
    "a quantifier free polynomial formula is a boolean combination of atomic polynomial formulas using connectives @xmath54 etc .",
    "[ dfn : sas ] a subset @xmath55 of @xmath56 is called a semi - algebraic set , if there is a quantifier free polynomial formula @xmath4 s.t .",
    "@xmath57    we will use the @xmath58 to denote the semi - algebraic set defined by a quantifier free polynomial formula @xmath4 .",
    "it is easy to check that any semi - algebraic set can be transformed into the form @xmath59    note that semi - algebraic sets are closed under basic set operations , since    * @xmath60 ; * @xmath61 ; * @xmath62 ; * @xmath63 ,    where @xmath64 and @xmath65 stand for the complement and subtraction operation of sets respectively .",
    "we recall the theory of continuous dynamical systems in the following .",
    "please refer to @xcite for details .",
    "an autonomous _ continuous dynamical system _ ( cds ) is modeled by first - order ordinary differential equations @xmath66 where @xmath67 and @xmath7 is a vector function from @xmath68 to @xmath68 , which is also called a _ vector field _ in @xmath68 .    if @xmath7 satisfies the _ local lipschitz condition _ , then given @xmath69",
    ", there exists a unique solution @xmath70 of ( [ eq : ode ] ) defined on @xmath71 with @xmath72 s.t .",
    "@xmath73 when @xmath74 is clear from the context , we just write @xmath70 as @xmath75 . based upon this , we shall use the following useful notions for our discussion in the sequel .",
    "suppose @xmath70 is the solution to ( [ eq : ode ] ) defined on @xmath76 with @xmath72 , as stated above .",
    "then    * @xmath70 ( @xmath75 for short ) defined on @xmath77 is called the trajectory of ( [ eq : ode ] ) starting from @xmath74 ; * @xmath78 ( @xmath79 for short ) defined on @xmath80 , resulted by substituting @xmath81 for @xmath82 in @xmath70 , is called the inverse trajectory of ( [ eq : ode ] ) starting from @xmath74 .",
    "in this paper , we focus on vector fields defined by polynomials .",
    "[ def : plvf ] suppose @xmath83 in ( [ eq : ode ] ) .",
    "if for all @xmath84 , @xmath85 is a polynomial in @xmath86 $ ] , then @xmath7 is called a polynomial vector field , denoted by @xmath87 $ ] .",
    "obviously polynomial vector fields satisfy the local lipschitz condition .",
    "let @xmath9 be a polynomial in ring @xmath88 $ ] , which is a scalar function .",
    "then the gradient of @xmath9 : @xmath89 is a vector of polynomials with dimension @xmath90 . thus the inner product of a polynomial vector field @xmath7 and the gradient of a polynomial @xmath9 is still a polynomial , if @xmath87 $ ] and @xmath18 ( in the rest of the paper , this will be assumed implicitly ) .",
    "therefore we can inductively define the _ lie derivatives _ of @xmath9 along @xmath7 , @xmath91 , for @xmath92 , as follows :    * @xmath93 , * @xmath94 ) , for @xmath95 ,    where @xmath96 is the inner product of two vectors , that is , @xmath97 for @xmath98 and @xmath99 .",
    "[ eg : lie - derv ] suppose @xmath100 and @xmath101 , then @xmath102    for a parametric polynomial @xmath29 , we can define the lie derivatives of @xmath9 along @xmath7 similarly if the gradient of @xmath29 is taken as @xmath103 , and all @xmath104 are still parametric polynomials .",
    "given a polynomial vector field , we can make use of lie derivatives to investigate the tendency of its trajectory in terms of a polynomial @xmath9 ( as an energy function ) .",
    "to capture this , look at example [ eg : lie - derv ] shown in i of figure [ fig : intu - lie ] .    in i of figure [ fig : intu - lie ] ,",
    "arrow @xmath105 denote the corresponding evolution direction according to the vector field @xmath100 , and we could imagine the points on the parabola @xmath101 with zero energy , and the points in white area have positive energy , i.e. , @xmath106 .",
    "arrow @xmath107 is the gradient @xmath108 of @xmath109 , which infers that the trajectory starting at @xmath110 will enter white area immediately if the angle , between @xmath108 and the evolution direction at @xmath110 , is less than @xmath111 , that is , the 1-order lie derivative is positive .",
    "thus the 1-order lie derivative @xmath112 of @xmath9 along @xmath7 ( the inner product of @xmath108 and @xmath113 ) predicts that there is some positive @xmath114 such that the trajectory starting at @xmath110 ( curve @xmath115 ) has the property @xmath116 for all @xmath117 .",
    "however , if the angle between gradient and evolution direction is @xmath111 or the gradient is zero - vector , then 1-order lie derivative is zero and it is impossible to predict trajectory tendency by means of 1-order lie derivative . in this case",
    ", we resort to nonzero higher order lie derivatives . for this purpose , we introduce the _ pointwise rank _ of @xmath9 with respect to @xmath7 as the function @xmath118 defined by @xmath119 if such @xmath120 exists , otherwise @xmath121 .",
    "[ eg : rank ] let @xmath122 and @xmath123 , then @xmath124 here , @xmath125 , @xmath126 , etc .",
    "look at ii of figure [ fig : intu - lie ] . at point @xmath127 on curve @xmath128 ,",
    "the gradient of @xmath129 is @xmath130 ( arrow @xmath107 ) and the evolution direction is @xmath131 ( arrow b ) , so their inner product is zero .",
    "thus it is impossible to predict the tendency ( in terms of curve @xmath128 ) of trajectory starting from @xmath127 via its 1-order lie derivative . by a simple computation , its 2-order lie",
    "derivative is @xmath132 .",
    "hence @xmath133 . in the sequel",
    ", we shall show how to use such high order lie derivatives to analyze the trajectory tendency .         for analyzing trajectory tendency by high order lie derivatives ,",
    "we need the following fact .",
    "[ trans ] given polynomial functions @xmath9 and @xmath7 , then @xmath74 is on the boundary @xmath134 iff @xmath135 .",
    "suppose @xmath136 , then it follows that    1 .   if @xmath137 and @xmath138 , then @xmath139 2 .",
    "if @xmath137 and @xmath140 , then @xmath141 3 .   if @xmath142 , then @xmath143    polynomial functions are analytic , so @xmath7 is analytic and thus @xmath75 is analytic in a small interval @xmath76 containing zero @xcite .",
    "besides , @xmath9 is analytic , so the taylor expansion of @xmath144 at @xmath145 @xmath146 converges in another small interval @xmath147 containing zero @xcite",
    ". then the conclusion of proposition [ trans ] follows immediately from formula ( [ eqn : taylor ] ) by case analysis on the sign of @xmath148 .",
    "based on this proposition , we introduce the notion of _ transverse set _ to indicate the tendency of the trajectories of a considered polynomial vector field in terms of the first nonzero lie derivative of a underlying polynomial as follows .",
    "[ trans - def ] given a polynomial @xmath9 and a polynomial vector field @xmath149 , the transverse set of @xmath7 over the domain @xmath150 is @xmath151    intuitively , if @xmath152 , then either @xmath15 is not in @xmath150 or @xmath15 is on the boundary of @xmath150 such that the trajectory @xmath75 starting with @xmath15 will exit @xmath150 immediately .",
    "a hybrid system consists of a set of cdss , a set of jumps between these cdss , and a set of initial states .",
    "the cdss in a hybrid system are a little different from the standard ones , as normally they are equipped with a domain and a set of initial states , in the form @xmath153 , where @xmath2 is used to force some jumps outgoing the mode to happen , that is , a hybrid system can stay within a mode only if the domain of the current mode holds , and @xmath6 is a subset of @xmath2 , standing for the set of initial states .",
    "obviously , a cds can be seen as a special cdswdi by letting @xmath154 .",
    "the goal of this paper is to present a complete method for automatically discovering sais of pdss , based on which , as we discussed in the introduction , we can finally verify polynomial hybrid systems .",
    "the notion of _ continuous invariant _ of cdswdi is quite similar to the one of positive invariant set of cds @xcite .",
    "informally , a continuous invariant @xmath155 of a cdwdi @xmath153 is a superset of @xmath6 such that all continuous evolutions starting from @xmath6 keep within @xmath155 if they are within @xmath2 . here",
    ", we give a formal definition of ci adapted from @xcite as follows :    [ dfn : inv ] given a cdswdi @xmath153 with @xmath156 and @xmath157 that is local lipschitz continuous , a set @xmath158 is called a _ continuous invariant _ of @xmath159 , iff    1 .",
    "@xmath160 ; and 2 .   for all @xmath161 , and for any @xmath162 , @xmath163 .",
    "{ \\mathbf{x}}({\\mathbf{x}}_0;t)\\in h ) \\rightarrow ( \\forall t \\in [ 0,t ] . { \\mathbf{x}}({\\mathbf{x}}_0;t)\\in p).\\ ] ]    regarding definition [ dfn : inv ] , we would like to give the following remarks .    1",
    ".   continuous invariant in definition [ dfn : inv ] is more general than standard positive invariant set of continuous dynamical systems .",
    "however , if @xmath154 and @xmath164 , then the two notions coincide . 2 .",
    "one may have noticed that in definition [ dfn : inv ] , a continuous invariant set @xmath155 is not necessarily a subset of domain @xmath2 .",
    "in fact , any @xmath155 satisfying @xmath165 is continuous invariant of @xmath153 .",
    "this seems weird at first sight , because such continuous invariant sets are useless if we only concern the cdswdi in isolation .",
    "but it would be quite useful in the verification of the hybrid system if we assume that the continuous invariant of a mode always holds if the hybrid system does not stay within the mode .",
    "[ dfn : pds ] a cdswdi @xmath153 is called a polynomial dynamical system with semi - algebraic domain and initial states ( pds ) , if @xmath2 and @xmath6 are semi - algebraic sets and @xmath7 is a polynomial vector field in @xmath166 $ ] .    a continuous invariant of a pds",
    "is called a _",
    "semi - algebraic invariant _ ( sai ) if it is a semi - algebraic set .",
    "in the subsequent sections , we will present a sound and complete method to automatically discover sais for a pds .",
    "the set @xmath167 in definition [ trans - def ] plays a crucial role in our theory .",
    "first of all , we have    [ comp - trans ] the set @xmath167 is a semi - algebraic set if @xmath9 is a polynomial and @xmath7 is a polynomial vector field , and hence it is computable .    to prove this theorem , it suffices to show @xmath168 is computable for each @xmath169 .",
    "however , @xmath168 may be infinite for some @xmath170 .",
    "thus , it seems that we have to compute @xmath171 infinite times for such @xmath15 to determine if @xmath152 .",
    "fortunately , we can find a uniform upper bound on @xmath168 for all @xmath15 with @xmath168 being finite .",
    "[ rank ] if @xmath9 and @xmath7 are polynomial functions , then there is an integer @xmath47 such that for all @xmath172 , @xmath173 implies @xmath174 .",
    "later on , such an @xmath47 is called the _ rank _ of @xmath9 and @xmath7 , denoted by @xmath175 .",
    "let @xmath176 for @xmath177 .",
    "note that the sequence @xmath178 is decreasing .",
    "we will show that there is an @xmath47 such that @xmath179 for all @xmath180 .",
    "since @xmath9 and @xmath7 are polynomial functions , all @xmath181 must be polynomials for any @xmath182 .",
    "we consider the polynomial ideal @xmath39 generated by @xmath183 .",
    ". then @xmath185 . by theorem [ acc ] ,",
    "there is @xmath120 such that @xmath186 .",
    "thus for all @xmath187 , there are @xmath188 $ ] for @xmath189 such that @xmath190 for all @xmath172 .",
    "fix @xmath187 .",
    "if @xmath191 , then @xmath192 since all @xmath193 for @xmath189 as @xmath191 . let @xmath194 .",
    "then @xmath179 for all @xmath180 .",
    "thus , if @xmath195 then @xmath121 .",
    "therefore , @xmath173 implies @xmath174 .",
    "now , it suffices to compute the values @xmath196 to determine whether @xmath197 is infinite . therefore if @xmath175 is computable then @xmath167 is computable too .",
    "it is desirable to get an expression of @xmath175 for given @xmath9 and @xmath7 .",
    "however , we did not find it yet .",
    "nevertheless , a computable upper bound for @xmath175 can indeed be found effectively according to the following theorem .",
    "[ fp ] if @xmath198 then @xmath199 , for all @xmath200 .",
    "we prove this theorem by induction .",
    "assume this conclusion is true for all @xmath201 with @xmath202 . especially , @xmath203 .",
    "then there are @xmath204 $ ] for @xmath205 such that @xmath206 by the definition of lie derivative and equation ( [ induction ] ) , it follows that @xmath207 by induction hypothesis , @xmath208 is in @xmath209 .",
    "so @xmath210 by induction , the theorem follows immediately .",
    "let @xmath211 be the minimal @xmath212 satisfying the condition of theorem  [ fp ] in the sequel .",
    "then @xmath213 .",
    "look at example [ eg : rank ] , where @xmath214 .",
    "now , applying above two theorems we can prove theorem [ comp - trans ] .    since @xmath213 , @xmath215",
    "therefore , @xmath167 is computable as @xmath211 is computable according to theorem [ fp ] . given @xmath9 and @xmath7 , let @xmath216 for @xmath217 , @xmath218 and @xmath219 by theorem [ rank ] and @xmath213 , we have another equivalence @xmath220    in fact , @xmath221 here is a particular semi - algebraic system , and so @xmath222 is a union of semi - algebraic systems .",
    "thus @xmath167 is actually a semi - algebraic set .    in the sai generation",
    ", it actually makes use of parametric polynomials @xmath29 with parameter @xmath223 @xmath224 .",
    "the following theorem indicates theorem  [ rank ] still holds after substituting @xmath29 for @xmath21 .",
    "[ para - rank ] given polynomial functions @xmath29 and @xmath7 , there is an integer @xmath47 such that @xmath225 implies @xmath226 for all @xmath172 and all @xmath26 .",
    "this proof is quite close to the one of theorem [ rank ] .",
    "the difference , between the proof of this theorem and the one of theorem [ rank ] , lies in the settings of polynomials . here",
    ", we consider polynomials @xmath9 and @xmath7 in the polynomial ring @xmath227 $ ] .",
    "similarly , we also introduce the rank function on polynomials with parameters , still denoted by @xmath175 .",
    "accordingly , let @xmath228 denote the upper bound computed by a similarity of theorem  [ fp ] .",
    "given a polynomial vector field @xmath149 with a semi - algebraic domain @xmath2 and initial condition @xmath6 , our task is to find a semi - algebraic set @xmath155 such that @xmath155 is an sai of @xmath159 .",
    "first of all , we illustrate our idea by showing how to compute an sai of the simple form @xmath229 for a simple domain @xmath230 . for convenience",
    ", we will simply write the dynamical system @xmath231 as @xmath232 .",
    "notice that @xmath155 is an sai of @xmath232 only if @xmath233 .",
    "it is evident that if @xmath234 is in the interior of @xmath235 , then the trajectory @xmath75 starting at @xmath234 will remain in the interior within adequately small @xmath236 .",
    "therefore , the condition of continuous invariant could be violated only at the points on the boundary @xmath237 of @xmath238 .",
    "thus by definition [ trans - def ] and proposition [ trans ] , @xmath8 is an invariant of @xmath239 if and only if it meets @xmath233 and @xmath240 i.e. @xmath241    by equivalences ( [ trans - eqv ] ) , the formula ( [ inv ] ) is equivalent to @xmath242 i.e. @xmath243    let @xmath244 denote the formula ( [ equiv ] ) .",
    "according to this equivalence , we obtain the sufficient and necessary condition for being sai as follows .",
    "[ thm : crit ] given a polynomial @xmath9 , @xmath245 is an sai of system @xmath239 if and only if the formula @xmath246 is true for all @xmath172 .",
    "now , we are ready to present a constraint based approach to generate polynomial continuous invariants .",
    "the basic idea is as follows :    1 .",
    "first , set a parametric polynomial @xmath9 as @xmath247 such a parametric polynomial is called a _ template _ conventionally .",
    "there are @xmath248 many terms and accordingly @xmath82 many parameters @xmath249 . for simplicity ,",
    "let @xmath24 denote such a @xmath82-tuple @xmath250 .",
    "then we appy the quantifier elimination ( qe for short ) to the formula @xmath251 .",
    "if the output is _ false _ , then there is no polynomial continuous invariant of degree @xmath252 for @xmath253 .",
    "otherwise , it will give us a constraint on @xmath24 , denoted by @xmath254 .",
    "in fact , @xmath254 is a union of semi - algebraic systems ( refer to @xcite ) .",
    "3 .   let @xmath255 be the set of solutions to @xmath254 .",
    "now , using a tool like discoverer @xcite to pick a @xmath256 and then @xmath257 is an invariant of @xmath253 by theorem [ thm : crit ] .",
    "* note that in real applications , one usually picks up the specific terms with nonzero coefficients .",
    "a simplified template could make the resulted polynomial satisfy special conditions and also reduce the complexity of the searching process .",
    "* in the above step iii , if the dimension of @xmath255 equals @xmath82 , then we can easily select a rational sample point @xmath28 from @xmath255 and the obtained @xmath257 is an sai in @xmath68 ; otherwise when it is difficult ( or impossible ) to get a rational instantiation for @xmath24 , we can always compute an algebraic sample point @xmath256 , that is , @xmath28 is itself defined by polynomial equations .",
    "it is easy to show that in the latter case , @xmath257 is also an sai in @xmath258 .",
    "again , we make use of example [ eg : rank ] to demonstrate above method .",
    "that is , @xmath259 . here",
    ", we take @xmath260 as the domain and @xmath261 as the initial states . apply procedure ( i - iii ) , we have :    1 .   set a template @xmath262 where @xmath263 .",
    "then we have @xmath264 .",
    "2 .   compute the corresponding formula @xmath265 where @xmath266 then we implement quantifier elimination on formula @xmath267 .",
    "we get the constraint on @xmath268 is @xmath269 3 .   just pick @xmath270 , and then @xmath271 is an invariant for @xmath272 .",
    "the grey part of the picture iii is the intersection of this invariant and domain @xmath2 .",
    "now , we consider how to automatically discover sais of a pds in general case .",
    "given a pds @xmath159 with @xmath273 and @xmath274 $ ] , where @xmath275 and @xmath276 .",
    "the procedure for automatically generating sais with a general template @xmath277 for @xmath159 , is essentially the same as the steps ( i - iii ) depicted in the previous section .",
    "however , we must sophisticatedly handle the complex combination due to the complicated boundaries . in",
    "what follows , we will first establish the necessary and sufficient conditions for general cis of a cdswdi by some topological analysis",
    ". then we show for sais of a pds , these conditions can be encoded equivalently into first order polynomial formulas .      first of all , we study a necessary and sufficient condition like formula ( [ inv ] ) for @xmath155 being an invariant of @xmath159 . to analyze the evolution tendency of trajectories dominated by a locally lipschitz continuous vector field @xmath157 in terms of a subset @xmath107 of @xmath56 , we need the following notions and notations .",
    "@xmath278    intuitively , @xmath279 means that the trajectory starting from @xmath74 enters @xmath107 immediately and keeps inside @xmath107 for some time ; @xmath280 means that the trajectory through @xmath74 reaches @xmath74 from the interior of @xmath107 .",
    "analogous to @xmath281 and @xmath282 , we introduce another two notations @xmath283 and @xmath284 .",
    "@xmath285 where @xmath64 stands for the complement of @xmath107 in @xmath56 .",
    "intuitively , @xmath286 means that the trajectory starting at @xmath74 leaves @xmath107 immediately and keep outside @xmath107 for some time in future ; @xmath287 means that the trajectory passing through @xmath74 reaches @xmath74 from the outside of @xmath107 .",
    "based on the above notations , we have    [ thm : topo ] given a cdswdi @xmath159 with @xmath288 , @xmath289 and locally lipschitz continuous @xmath157 , a subset @xmath155 of @xmath56 is a ci of @xmath159 if and only if    1 .",
    "@xmath290 ; 2 .",
    "@xmath291 ; 3 .",
    "@xmath292 .",
    "first of all , the proof about condition 1 is trivial . in what follows ,",
    "we focus on the proofs about conditions 2 and 3 .    ",
    "@xmath293 \" suppose @xmath155 is not a ci of @xmath159 . according to definition [ dfn : inv ] , there exists @xmath294 , @xmath295 and @xmath296 $ ] s.t .",
    "@xmath297.\\,{\\mathbf{x}}(t)\\in h \\quad\\mbox{and}\\quad { \\mathbf{x}}(t_1)\\notin p.\\ ] ] it is not difficult to check that the set @xmath298.\\,{\\mathbf{x}}(t)\\in p\\}\\ ] ] is not empty , and is a right - open or right - closed interval @xmath299 with @xmath300 . if @xmath301 $ ] , then @xmath302 .",
    "thus @xmath303 , but @xmath304 , otherwise @xmath305 could not be the right end point of @xmath306 .",
    "so 2 is violated .    if @xmath307 , then @xmath308 and @xmath309 .",
    "furthermore , @xmath310 , i.e. @xmath311 which is equivalent to @xmath312 let @xmath313",
    ". then @xmath314 .",
    "thus we get @xmath315 i.e. @xmath316.\\ , { \\mathbf{x}}({\\mathbf{x}}_0';-t)\\in p\\cap h.\\ ] ] this means @xmath317 besides , @xmath318 so 3 is violated by @xmath319 .",
    " @xmath320 \" if 2 does not hold , then there exists @xmath321 , @xmath322 and @xmath323 such that @xmath324 and @xmath325 . by definition [ dfn : inv ] , @xmath155 could not be a ci .",
    "if 3 does not hold , then there exists @xmath326 this means there exists @xmath327 such that @xmath328 i.e. @xmath329 thus @xmath330 i.e. @xmath331 let @xmath332 .",
    "then @xmath333 .",
    "thus we get @xmath334 furthermore , @xmath335 thus the trajectory starting from @xmath336 violates the condition of definition [ dfn : inv ] , so @xmath155 could not be a ci either .      given a pds @xmath159 and an sai @xmath155 , to encode the conditions in theorem [ thm : topo ] as polynomial formulas , it is sufficient to show that @xmath337 , @xmath338 , @xmath339 and @xmath340 are all semi - algebraic sets . by the structure of @xmath2 ,",
    "it is natural to consider the relation between @xmath337 and @xmath341 . through a careful analysis , we establish the following crucial equality :    [ thm : dcp - inward ] for a semi - algebraic set @xmath2 defined by formula ( [ for : dom ] ) and a polynomial vector field @xmath7 , we have @xmath342    to prove theorem [ thm : dcp - inward ] , we need the following two lemmas , wherein @xmath276 .",
    "[ lm : atm ] for any atomic polynomial formula @xmath343 and polynomial vector field @xmath7 , and for any @xmath344 , we have either @xmath345 or @xmath346 .",
    "polynomial functions are analytic , so @xmath7 is analytic and thus @xmath70 ( @xmath75 for short ) is analytic in a small interval @xmath76 containing @xmath347 .",
    "besides , @xmath9 is analytic , so the taylor expansion of @xmath144 at @xmath145 @xmath348 converges in @xmath76",
    ". then the proof proceeds by case analysis on the sign of @xmath148 :    * if @xmath349 , then @xmath350 , so @xmath351 and @xmath352 ; * if @xmath353 , then @xmath354 , so @xmath351 and @xmath355 ; * if @xmath356 , then @xmath357 , so @xmath358 and @xmath352",
    ".    then we can see that for all @xmath344 , either @xmath359 or @xmath360 .",
    "[ lm : conjunct ] for any semi - algebraic set @xmath361 , and polynomial vector field , we have    1 .",
    "@xmath362 ; 2 .   for any @xmath344 , either @xmath363 or @xmath364 .    1 .",
    " @xmath365 \" trivial . +",
    " @xmath366 \" for any @xmath367 , there exist positive @xmath368 such that for all @xmath369 and any @xmath370 , @xmath371 .",
    "let @xmath372 .",
    "then for any @xmath373 , @xmath374 .",
    "thus @xmath375 .",
    "if @xmath376 , then there exists @xmath377 $ ] such that @xmath378 . by lemma [ lm : atm ] ,",
    "thus there exists @xmath380 s.t . for all @xmath381 , @xmath382 .",
    "then for all @xmath381 , @xmath383 , i.e. @xmath384 .",
    "this means @xmath385 .",
    "now we are ready to prove theorem [ thm : dcp - inward ] as follows .    ",
    "@xmath366 \" trivial .",
    " @xmath365 \" if @xmath386 , then for all @xmath387 $ ] , @xmath388 . by lemma [ lm : conjunct ] , for all @xmath389 $ ] , @xmath390 , where @xmath391 .",
    "thus there exist positive @xmath392 s.t .",
    "for all @xmath387 $ ] and any @xmath393 , @xmath394 .",
    "let @xmath395 .",
    "then for all @xmath373 , @xmath396 , or equivalently , @xmath397 .",
    "this means @xmath398 and @xmath399 .",
    "based on theorem [ thm : dcp - inward ] , in order to show @xmath337 is a semi - algebraic set for any semi - algebraic set @xmath2 , it is sufficient to show that @xmath400 is a semi - algebraic set for any polynomial @xmath9 , where @xmath401 .",
    "in fact , we have proved in lemma [ lm : atm ] the following result .",
    "[ lm : gamma+0 ] for any polynomial @xmath9 and polynomial vector field @xmath7 , @xmath402 where @xmath403    next , we show @xmath404 and @xmath405 are semi - algebraic sets .",
    "we will do so in a more general way for parametric polynomials @xmath29 . in their proofs , we need the fundamental results about lie derivatives shown in section [ sec : fund ] . in the sequel",
    "we adopt the convention that @xmath406 , where @xmath407 is a polynomial formula .",
    "[ lm : gamma-0 ] given @xmath408 and polynomial vector field @xmath7 , for any @xmath409 we have @xmath410 where @xmath411     @xmath365 \" this is trivial by definition of pointwise rank in section [ sec : prelim ] .",
    " @xmath366 \" if @xmath412 , then by definition of pointwise rank we have @xmath413 . by the similarity of theorem [ rank ] with parameters in polynomial @xmath9",
    ", we get @xmath414 . thus @xmath415    [ lm : gamma+ ] given @xmath408 and polynomial vector field @xmath7 , for any @xmath409 we have @xmath416 where @xmath417 @xmath418",
    " @xmath366 \" if @xmath419 , then by definition of pointwise rank , we have @xmath420 thus @xmath421 .     @xmath365 \" if @xmath421 , then by definition of pointwise rank we know @xmath74 satisfies @xmath422 by the similarity of theorem [ rank ] with parameters in polynomial @xmath9 , we have @xmath423 .",
    "thus @xmath424 satisfy @xmath425 .",
    "this means @xmath419 .    based on lemma [ lm : gamma+0 ] , [ lm : gamma-0 ] and [ lm : gamma+ ] we have    [ lm : in - atm ] for any polynomial @xmath9 and vector field @xmath7 , @xmath426 where @xmath427 and @xmath428 are defined in ( [ eqn : phi0 ] ) and ( [ eqn : psi+ ] ) respectively .",
    "therefore , @xmath337 can be translated into a polynomial formula . by a similar argument , we are able to prove that    [ coro : dcp - ivin ] for a semi - algebraic set @xmath2 defined by formula ( [ for : dom ] ) and a polynomial vector field @xmath7 , we have @xmath429    accordingly ,    [ coro : semi - ivin - atm ] for any polynomial @xmath9 and vector field @xmath7 , @xmath430    where @xmath431    now we are able to present our main result of automatic sai generation for pds .",
    "[ thm : main ] a semi - algebraic set + @xmath432 with @xmath433 is a continuous invariant of the pds @xmath434 with @xmath435 if and only if @xmath436 satisfy @xmath437 where @xmath438 with @xmath439 and @xmath440 .",
    "this theorem is a direct consequence of theorem [ thm : topo ] , [ thm : dcp - inward ] , [ lm : in - atm ] , [ coro : dcp - ivin ] and [ coro : semi - ivin - atm ] .",
    "note that @xmath441 and @xmath442 are trivially  true \" when @xmath2 is the whole space @xmath68 .    compared to related work ,",
    "e.g @xcite , our method for sai generation based on theorem [ thm : main ] has the following two features :    1 .",
    "given a pds ( with arbitrary semi - algebraic domain and initial states ) , we consider arbitrary semi - algebraic sets as invariants , which are of complicated forms and may be neither open nor closed .",
    "2 .   our criterion for checking semi - algebraic invariants for pds is sound and complete ; our method for automatically generating semi - algebraic invariants is sound , and complete w.r.t to the predefined template .",
    "now we demonstrate how our approach can be used to generate a general sai by the following example .",
    "let @xmath443 with @xmath444 and @xmath445 .",
    "take a template : @xmath446 . by theorem [ thm : main ]",
    ", @xmath447 is an sai of @xmath153 iff @xmath76 satisfies the following two formulas @xmath448 for all @xmath449 , where @xmath450    by applying quantifier elimination to this formula , we get @xmath451 .",
    "let @xmath270 and @xmath452 , and it results that @xmath453 is an sai for this pds , which is shown in iv of figure [ fig : inv ] .    note that in the above example , the generated sai is a general semi - algebraic set that is a union of two simple semi - algebraic sets , which is neither closed nor open .",
    "in this section , we show that our method presented above can be used to generate continuous invariants for some real systems .",
    "in @xcite , the authors use _ hcsp _ @xcite to formally model the _",
    "chinese train control system at level 3 ( ctcs-3 ) _",
    "they also propose a calculus of hcsp for the purpose of verifying safety properties of ctcs-3 .",
    "for this calculus to work , effective techniques for dealing with continuous dynamics must be incorporated .",
    "consider the following fragment of the hcsp model of ctcs-3 : @xmath454 process @xmath455 models the running of a train , with @xmath456 representing its position , velocity and acceleration ( @xmath268 is a constant ) respectively .",
    "once @xmath457 exceeds the speed limit @xmath458 of the current segment , @xmath459 for emergency brake is set to _ true _ and the train starts braking immediately , expressed by the subprocess @xmath460 .    the safety property needs to be verified about @xmath461 can be stated as @xmath462 which means whenever the train s speed exceeds certain limit , it must execute the emergency brake process .    to verify this property , i.e. to check that @xmath463 is indeed an invariant of @xmath455 , according to the calculus in @xcite",
    ", it amounts to check that @xmath464 is a continuous invariant of the pds @xmath153 , where @xmath465 , @xmath466 and @xmath467 with @xmath468 . according to our method ,",
    "this can be further reduced to the checking of the validity of @xmath469 which is obvious .",
    "perhaps this example seems a bit trivial , for the continuous dynamics is an affine system and the required invariant coincides with the domain .",
    "what we want to stress here is the completeness of our criterion for checking continuous invariants compared to others .",
    "for example , the principle given in @xcite requires the directional derivative of an invariant in the direction of the vector field to have the same sign in the domain . as a result",
    ", it may fail to generate the above invariant @xmath470 , because @xmath471 is @xmath472 when @xmath473 .",
    "we consider the following two - aircraft flight dynamics from @xcite : @xmath474\\,.\\ ] ] system ( [ eqn : flight ] ) has 8 variables : @xmath475 and @xmath476 represent the positions of aircraft 1 and 2 respectively , and @xmath477 and @xmath478 represent their velocities .",
    "the parameters @xmath479 and @xmath480 denote the angular speed of the two aircrafts .",
    "we shall apply our method to generating special invariants of form @xmath11 for pds @xmath153 with @xmath481 and @xmath7 defined in ( [ eqn : flight ] ) . for simplicity , we take @xmath6 to be a singleton @xmath482 .    in order to determine candidates for invariants of @xmath153 , we enumerate parametric polynomials @xmath408 by the degree of @xmath9 and the number of variables appearing in it . for example , we can choose the linear template @xmath483 .    according to theorem [ thm : main ] ,",
    "it is easy to check that @xmath484 is an invariant of @xmath153 if and only if @xmath24 satisfies    * @xmath485 ; and * @xmath486 .    for the template defined above",
    ", we can get @xmath487 . by applying quantifier elimination to the corresponding constraint",
    ", we get @xmath488 thus we can obtain the following invariants by assigning suitable values to @xmath489s :    * @xmath490 ; * @xmath491 ; * @xmath492 .",
    "if we use the quadratic template @xmath493 , we can also get @xmath487 , and the constraint for @xmath24 is @xmath494 let @xmath495 and we obtain an invariant @xmath496    using arbitrary semi - algebraic templates , we can generate invariants beyond polynomial equations for @xmath153 , at the cost of heavier computation .",
    "in this paper , we present a sound and complete criterion for checking sais for pdss , as well as a relatively complete method for automatic sai generation using templates .",
    "our approach is based on the computable algebraic - geometry theory .",
    "our work in this paper actually completes the gap left open in @xcite .",
    "compared with the related work , more invariants can be generated through our approach .",
    "this is demonstrated by simple examples and case studies .    in the future",
    ", we will concentrate on the following problems .",
    "firstly , we believe that our method can be applied to generate invariance sets for stability analysis , controller synthesis and so on in control theory , in particular for construction of lyapunov functions . secondly , we will consider how to extend the approach to more general dynamical systems whose vector fields are functions beyond polynomials . since our approach makes use of first - order quantifier elimination which is with doubly exponential cost @xcite , how to improve the efficiency of our approach will be our main future work .",
    "for instance of linear templates , it is helpful to reduce the complexity via linear programming ."
  ],
  "abstract_text": [
    "<S> in this paper , we consider an extended concept of invariant for polynomial dynamical system ( pds ) with domain and initial condition , and establish a sound and complete criterion for checking semi - algebraic invariants ( sai ) for such pdss . </S>",
    "<S> the main idea is encoding relevant dynamical properties as conditions on the high order lie derivatives of polynomials occurring in the sai . </S>",
    "<S> a direct consequence of this criterion is a relatively complete method of sai generation based on template assumption and semi - algebraic constraint solving . </S>",
    "<S> relative completeness means if there is an sai in the form of a predefined template , then our method can indeed find one using this template . </S>"
  ]
}