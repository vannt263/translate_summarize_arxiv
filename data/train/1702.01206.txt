{
  "article_text": [
    "in the field of hydrogeology , many interesting concepts are related to finding the lag between two time series .",
    "for example , it is often hypothesized that for a seepage lake there is a significant time lag between net precipitation ( precipitation minus water loss through evaporation and runoff ) and the water levels over time , while such a lag for a drainage lake is often nonexistent or insignificant .",
    "seepage lakes are hydraulically isolated from surface water features and primarily fed by groundwater and direct precipitation .",
    "drainage lakes are typically connected to a network of streams and rivers ( wisconsin department of natural resources , 2009 ) .",
    "another example , which is our motivating example , is the relationship between precipitation and water levels of a shallow well in an unconfined aquifer versus water levels in a relatively deeper well in a semi - confined aquifer .",
    "this relationship is particularly important to water resource managers and groundwater modelers who need to accurately quantify groundwater recharge into aquifers , for developing water - supply - plans for sustainable use of aquifers .",
    "groundwater recharge , defined as entry of water into the saturated zone , is influenced by a wide variety of factors including vegetation , topography , geology , climate , and soils ( dripps , 2003 , dripps , hunt and anderson 2006 ) .",
    "groundwater recharge , which is a small percentage of the precipitation that eventually reaches the water table , is one of the most difficult parameters to quantify .",
    "this is because processes such as evaporation , transpiration and infiltration through unsaturated subsurface must first be estimated to determine the amount of water lost after a rainfall event .",
    "often times , groundwater models are developed by estimating the groundwater recharge using empirical relationships or as a percentage of precipitation .",
    "it is a common practice to use groundwater recharge as a calibration parameter , meaning the recharge value that provides the best calibration to the model is selected as representative for the watershed simulated . for temporal simulations , the lag time between a rainfall event and groundwater recharge into deeper aquifers are often ignored .",
    "although the underlying hydrogeological theory supports the existence of above time lags between time series , evidence based on empirical data for such lags have been typically assessed using visual inspection ( e.g. westoff _ et al _ , 2010 in a different hydrogeological context ) or cross - correlations ( levanon _ et al _ , 2016 ) in hydrogeological literature .",
    "cross - correlation method is essentially a parametric method , where certain parameters has to be estimated under the transfer - function - model framework and certain assumptions ( such as joint bivariate stationarity of the two time series ) has to be met ( see chapter 14 , wei 2006 ) .",
    "also diagnostic checking for model adequacy ( such as whether the noise series and the input series are independent - see again chapter 14 , wei 2006 for the definition of the noise series and input series referred to ) has to be done before cross - correlograms are plotted , although such checking are rarely done in practice . in this paper , we propose a non - parametric method to quantify the time lag using a simple adaptation of the visibility graph algorithm ( vga ) , which is an algorithm that converts a time series into a graph and was developed by physicists and seen mainly only within the physics literature so far ( lacasa , 2008 , lacasa and luque , 2010 , nunez _ et al _ 2012 ) . the method that we propose may be summarized as follows .    in the proposed method",
    ", we consider one of the time series ( e.g. water levels observed in a well ) as a reference time series and create time shifted copies of the other time series of interest ( e.g. precipitation ) .",
    "we then use vga to convert all the time series ( original , copies and the reference ) to graphs and their corresponding adjacency matrices , and compare the copies of the latter time series with that of the reference .",
    "the ` distance measure ' that is used for the comparisons is the usual @xmath0 metric distance ( based on the frobenius norm ) between two matrices .",
    "we identify the copy of the latter time series for which this distance is minimized compared to the reference , and we define the time shift corresponding to this copy as the time lag between the orginal two time series .",
    "more details about vga and our adaptation to the time lag problem is provided in the next section using mathematical notation . in section 3",
    "we present results from simulations conducted to essentially identify an appropriate sample size and also to assess the performance of the method when values are missing .",
    "section 4 illustrates the application of the proposed method to real hydrogeologic datasets , where we also present a strategy to assess the uncertainty related to the lag estimated . finally in the last section",
    ", we make our concluding remarks .",
    "let us denote the two hydrogeological time series that we are interested in , namely precipitation and water levels , by @xmath1 and @xmath2 ( or simply @xmath3 and @xmath4 ) , respectively .",
    "in order to find the time lag between the two time series , as a first step we fix one of the series , say @xmath4 , and obtain time - shifted copies of the other series , @xmath5 the key step in our methodology is the conversion of all the above time series into graphs based on the visibility graph algorithm .",
    "graphs are mathematical constructs that are used to study relationships among various objects . in graph models",
    "the objects of interest are modeled as nodes or vertices and the relationships among the objects are modeled using edges or lines connecting the vertices .",
    "+     etc .",
    "denote the time points as well as the corresponding nodes in the visibility graph.,width=624,height=360 ]    visibility graph algorithm ( lacasa , 2008 , lacasa and luque , 2010 , nunez _ et al _ 2012 ) is a relatively novel method that extends usefulness of the techniques and focus of mathematical graph theory to characterize time series .",
    "it has been shown that the visibility graph inherits several properties of the time series , and its study reveals nontrivial information about the time series itself .",
    "figure 1 top panel illustrates how the visibility algorithm works .",
    "the time series plotted in the upper panel is an approximate sine series ; specifically , a sine series with gaussian white noise added .",
    "the values at 24 time points are plotted as vertical bars .",
    "one may imagine these vertical bars as , for example , buildings along a straight line in a city landscape ( i.e. a city block ) .",
    "each node in the associated visibility graph ( shown in the bottom panel ) corresponds to each time point in the series .",
    "so , the graph in figure 1 has 24 nodes .",
    "we draw a link or an edge between a pair of nodes , say @xmath6 and @xmath7 , if the visual line of sight from the top of the building ( vertical bar ) situated at @xmath6 towards the top of the building / bar at @xmath7 is not blocked by any intermediate buildings - that is , if we were to draw a line from the top of the vertical bar at @xmath6 to the top of the vertical bar at @xmath7 , it should not intersect any intermediate vertical bars . visibility lines corresponding to the edges in the graph are plotted as dotted lines in the figure in the upper panel . for example , there is no edge between @xmath8 and @xmath9 since the line of sight ( not shown ) between the top points of the vertical bars at these two time points is blocked by the vertical bar at @xmath10 . on the other hand , there is an edge between @xmath11 and @xmath10 since the corresponding visibility line ( shown as a dotted line ) does not intersect the vertical bar at @xmath8 .",
    "+ more formally , the following visibility criteria can be established : two arbitrary data values ( @xmath12 , @xmath13 ) and ( @xmath14 ) will have visibility , and consequently will become two connected nodes of the associated graph , if any other data ( @xmath15 ) placed between them fulfills : @xmath16    this simple intuitive idea has been proven useful practically because of certain nice features exhibited by the graphs generated by this algorithm .",
    "first of all they are connected , since each node is connected to at least its neighbors .",
    "secondly , there is no directionality between the edges , so that the graph obtained is undirected . in addition , the visibility graph is invariant under rescaling of the horizontal and vertical axes and under horizontal and vertical translations . in other words ,",
    "the graph is invariant under affine transformations of the original time series data .",
    "+ in mathematical notation any graph with @xmath17 nodes could be represented by its @xmath18 adjacency matrix @xmath19 which consists of @xmath20 s and @xmath21 s .",
    "the @xmath22 element of @xmath19 is @xmath21 if there is an edge connecting the @xmath23 and the @xmath24 node , @xmath20 otherwise .",
    "two graphs , @xmath25 and @xmath26 , can be be compared by the metric `` distance '' , @xmath27 between their corresponding adjacency matrices , @xmath28 and @xmath28 . here ,",
    "@xmath29 , called the frobenius norm of a matrix , is the square root of the sum of the squares of the elements of the matrix ; that is , the square root of the trace of the product of the matrix with itself . + our proposed method to assess the time lag between the two hydrogeological time series @xmath3 and @xmath4 using the visibility graph approach is as follows : convert the @xmath4 time series into a visibility graph and obtain its corresponding adjacency matrix , @xmath30 .",
    "consider time - shifted copies of the @xmath3 time series , @xmath31 , each shifted in time by a lag from the set @xmath32 .",
    "convert these time - shifted copies of @xmath3 into their visibility graphs and obtain the corresponding adjacency matrices @xmath33 .",
    "we determine the copy @xmath34 for which the frobenius norm @xmath35 is minimized .",
    "the time lag between the two original hydrogeological series is then taken as @xmath36 .",
    "+        we further illustrate our method using the plots in figure 2 . the time series in the top panel",
    ", @xmath37 is an approximately a series of values based on the sine function obtained using the following r codes : + `",
    "n ` @xmath38 ` 50 ` + ` ts.a ` @xmath38 ` 100*sin(2*pi*(80/1000)*n ) + rnorm(n , 0 , 25 ) ` + the time series , @xmath39 , plotted in the middle panel of figure 2 is derived from @xmath37 as follows : + ` ts.b ` @xmath38 ` ( 1/3)*c(ts.a[3:n ] , ts.a[1:2 ] ) + rnorm(n , 0 , 5 ) ` + that is , @xmath39 is derived by shifting @xmath37 to the left by two units , by reducing the amplitude to one - third that of @xmath37 , and adding some gaussian noise . in other words ,",
    "@xmath37 and @xmath39 have roughly the same shape although their amplitudes are different and one is shifted by two time units relative to the other as seen in the figure .",
    "one may think of @xmath37 and @xmath39 as two time series one affecting the other ( since , @xmath39 is shifted to the left , physically we would think of @xmath39 affecting @xmath37 ) ; e.g. @xmath39 as precipitation and @xmath37 as water levels .",
    "physically , water levels and precipitation never take negative values ; so , if one really wants to think of @xmath37 and @xmath39 as water levels and precipitation , one could think of them as mean - subtracted and scaled appropriately .",
    "we considered time - shifted copies of @xmath39 with time - shifts from the following set : @xmath40 vga was applied and adjacency matrices for the corresponding graphs were obtained .",
    "distance - measure based on the frobenius norm for the time - shifted copies of @xmath39 compared to the reference @xmath37 , are plotted in the bottom panel of figure 2 .",
    "the distance - measure is minimized at 2 , which was the lag that we set _ a priori_. thus , in this illustrative example , the lag was correctly identified by the method that we proposed .",
    "we conducted monte carlo simulations to assess the performance of the vga - based method as we varied some of the parameters of the two time series @xmath37 and @xmath39 considered in the previous section .",
    "the parameters that we considered were _ a _ ) the ratio of the amplitudes between the two simulated series @xmath37 and @xmath39 , _ b _ ) the variance for the noise term `` rnorm(n , 0 , * ) ` ' in the series @xmath37 ( indicated by @xmath41 ) and _ c _ ) the variance for the noise term `` rnorm(n , 0 , * ) ` ' in the series @xmath39 . for each simulation scenario considered in this section ( that is , for each set of the above parameters ) , 1000 pairs of @xmath37 and @xmath39 were generated , and for each pair time lag was assessed based on the proposed method and compared with the lag that was set _ a priori_. the performance of the method was assessed based on the percentage of times that the _ a priori _ lag was correctly identified .",
    "the _ a priori _ lags that we considered for each scenario were @xmath42 and @xmath43 ; we assumed that in typical examples from physical sciences , @xmath44 will be a small lag and @xmath43 will be a very large lag .",
    "the reason for considering the ratio of amplitudes was that even if two physical time series ( especially , hydrogeological time series ) are roughly of the same shape with only a lag between them , their amplitudes ( i.e. roughly their sizes ) are often vastly different . for @xmath37 and @xmath39 used in the introductory illustrative example , the ratio of their amplitudes was @xmath45 .",
    "one of the questions that was addressed in our simulations was whether our method was still good if we changed this ratio drastically , e.g. to @xmath46 .",
    "another question that we thought should be addressed is that whether the proposed method works only for nice periodic time series such as the ` sine series ' .",
    "increasing the variance for the noise term in @xmath37 makes it less like a sine series. finally , increasing the variance of the noise term in @xmath39 makes the shape of @xmath39 quite different from that of @xmath37 , and by doing so in our simulations we also addressed the performance of the method in such scenarios .",
    ".performance of the method when the ratio of amplitudes between @xmath37 and @xmath39 was @xmath45 , the noise term in @xmath37 was @xmath47 and the noise term for @xmath39 was @xmath48 .",
    "[ cols=\"<,^,^,^,^\",options=\"header \" , ]     the performance of the proposed method with both locf and mean imputation was near perfect when only @xmath49 of the values",
    "( that is , 9 out of 180 ) were missing .",
    "this was true regardless of whether the values were missing for only one time series or for both , and also true across all _ a priori _ set lags , 2 , 5 , 10 and 15 .",
    "when @xmath50 of the values ( that is , 18 out of 180 ) were missing for only one time series , the method did very well under both locf and mean imputation for all lags .",
    "when @xmath50 of the values were missing for both time series , the performance was still very good when the lags were large ( 10 or 15 ) ; when the lags were small ( 2 or 5 ) , the performance with both imputation methods was still good but not as good as when the lags were large .",
    "for example , when @xmath50 values were missing and when the lag was 2 , the performance with locf was @xmath51 and @xmath52 , respectively , depending on whether the values were missing for only one time series or both ; the corresponding values for lag 10 , on the other hand , were even better : @xmath53 and @xmath51 .    with @xmath54 missing values ( 27 out of 180 ) , the performance was still good ( that is , in the range @xmath55 ) with locf and mean imputation , for lags 2 , 5 , and 10 , irrespective of whether it was missing for only one or for both time series ( although , of course , if it was missing only for one time series , it was better ) . however , when the _ a priori _ set lag was 15 , the performance with locf was weak ( @xmath56 ) , when @xmath54 values were missing for both time series ; it was still good ( @xmath57 ) with locf when only one time series had @xmath54 missing values , and with mean imputation also ( @xmath52 and @xmath53 ) .",
    "with @xmath58 missing values the method worked well under both types of imputations and for all lags , only when one time series had missing values .",
    "when both time series had @xmath58 missing values , the performance of locf was not good with small lags ( @xmath56 for lag 2 and @xmath59 for lag 5 ) and got worse for larger lags ( @xmath60 for lag 10 and @xmath61 for lag 15 ) .",
    "the performance with mean imputation was slightly better ( @xmath62 and @xmath63 , for lags 2 , 5 , 10 and 15 , respectively ) but still not quite up to the mark .    in summary , based on the above simulation results , we consider it quite safe to use the proposed method in conjunction with either of the imputation methods if it is only @xmath49 values missing for only one time series or for both .",
    "with @xmath64-@xmath54 values missing , the imputation methods give good results only if it is missing for one time series ; if it is missing for both , then it is not very safe to say that imputations will work , but still reasonably safe . with about @xmath58 of the values missing for both time series ,",
    "it is definitely not recommended to use the proposed method with either of the imputations although it may be somewhat acceptable if it is missing for only one time series .",
    "also , in general , we observed that the performance with mean imputation was slightly better except for one or two scenarios .",
    "if the statistical practitioner has a preference of one method over the other , it may still be recommended to use both for the proposed method , at least as a sensitivity analysis .",
    "finally , we emphasize again the point made in the beginning of the section , that if large chunks of data are missing at a stretch then the imputation methods wo nt work ; in such cases , it is better to focus the analysis on other chunks of data with no or very sparse missing values .",
    "in this section , we present the results from an application of the proposed method on real hydrogeological time series",
    ". in southwest florida , two of the shallow aquifers that are tapped for water supply are the unconfined water table aquifer and the semi - confined lower tamiami aquifer .",
    "these aquifers are considered as sources of limited supply and regulated by the south florida water management district ( sfwmd , 2015a ) .",
    "water table aquifer is generally less than 50 feet thick and consists of less permeable unconsolidated sediments at the upper portion and relatively permeable limestone at the basal portion .",
    "the water table aquifer is hydraulically separated from the lower tamiami aquifer by about 15 to 30 feet of confining beds that consists of low permeable strata ( bonita springs marl member and caloosahatchee clay member ) .",
    "the top of lower tamiami aquifer is generally between 60 and 80 feet below land surface .",
    "this aquifer extends to 100 to 150 feet below grade and generally consists of sandy , biogenic limestone and calcareous sandstone ( sfwmd , 2015b ) .",
    "this aquifer is one of the primary sources of public water supply in southwest florida . to understand the lag responses of rainfall in these shallow aquifers are important for water management . for this study , in order to determine the lag responses within these two aquifers due to rainfall events , we utilized daily water level data recorded in the water table aquifer and lower tamiami aquifer .",
    "it is relevant to note that data collected in shorter frequencies ( e.g. hourly ) are ideal for `` lag '' related studies .",
    "hourly water level data was available from the water table aquifer well as well as the lower tamiami aquifer in the study area ; however , precipitation data was available only on a daily basis . in order to have both water level data and precipitation in the same time interval , we averaged the water levels to a daily average .",
    "the daily - averaged data was used solely for illustration of the statistical technique presented in this paper .",
    "data was available from july 1st , 2010 till june 29th 2016 , but water level data were missing for the following time intervals : january 5th , 2011 to april 8th , 2012 , july 10th , 2012 to october 1st , 2012 , april 2nd , 2013 to september 30th , 2013 , and finally between april 2nd , 2014 to june 29th , 2014 .",
    "complete data was available between june 30th , 2014 and june 29th , 2016 ( 731 days ) ; we analyzed this data for our illustration since this was the largest available time period with no missing data .",
    "the water level and precipitation data that were analyzed are graphically presented on figure 3 .",
    "vga method was applied to all the times series plotted in figure 3 , and frobenius distance between the corresponding pairs of adjacency matrices are plotted in figure 4 . for both unconfined water table aquifer and",
    "semi - confined lower tamiami aquifer , the frobenius distance is minimized at lag 2 .",
    "this makes hydrogeological sense since , although one aquifer is a bit deeper than the other , considering the difference in total depths between the wells is roughly only about 40 feet , the water level response in the relatively deeper well may be observed in a matter of hours . in figure 4 , for both plots , we note that although the frobenius distnace for lag 1 is not the minimum it is close to the minimum compared to that of the other lags .",
    "thus , in order to check whether the minimum was attained at lag 2 just due to chance , we need to quantify the uncertainty regarding the estimate . since naive resampling strategies like bootstrap would create independent samples ( that is , with autocorrelations near zero ) , we used the following subsampling strategy that would preserve the original autocorrelations .",
    "we set a time - window - size , say 100 , and use the consecutive data points for water levels and precipitation in that window , and apply the proposed method to this sub - sampled data , as we did for the original data .",
    "first we place the left end of the window on the first time point of the original data , conduct the analysis , find the lag , and then move the window one unit to the right and repeat the analysis .",
    "we continue this process iteratively until the right end of the window touches the final time point for the original data . thus",
    ", with a window - size of 100 , and with a time series of length 731 , we will have 631 iterations , and for each iteration , we will have a lag between the pair of time series under consideration , so that we will have 631 lags at the end .",
    "the histograms for the 631 lags obtained using this iterative process are plotted in the top panel of figure 5 .",
    "the highest frequency for the lower tamiami aquifer is at lag 2 consistent with our finding for the original time series with 731 points .",
    "however , interestingly , the highest frequency for the water table aquifer was at lag 1 , although the frequency for lag 2 is almost as high .",
    "now the question arises whether this reversal was due to the size of the window ( 100 ) , which is quite smaller than the length of the original series ( 731 ) .",
    "so , we repeated the analysis with a window - size of 365 ( that is , 366 iterations ) .",
    "the results of the second iterative analysis are shown in the bottom panel of figure 5 ; in this case , the highest frequency for both aquifers is at lag 2 .",
    "we repeated the analysis using a window size of 50 ( 681 iterations ) and 25 ( 706 iterations ) ; in these analyses , only lag 2 appeared for all windows , so that the histogram will look like a single bar at 2 ( of height 50 or 25 , respectively ) , and no bars at any other lags .",
    "since this is simple enough to convey without a histogram , we did nt plot the histograms for window - sizes 50 and 25 . based on these results , and on hydrogeological sense",
    ", we would conclude that on the average , the water levels rise and fall 2 days after a corresponding fluctuation in precipitation , for both the aquifers .",
    "the analysis presented in this section suggests that it is critical to quantify the uncertainty prior to making conclusions and that the selected window size can influence the conclusions .",
    "quantifying time lags between two time series data , where one affects the other , is important for modelers of many physical phenomena , especially in hydrogeology .",
    "we propose an approach based on a simple extension of the visibility graph algorithm .",
    "we conducted simulations to assess the performance of the proposed method under different scenarios , and determined that the method worked well under reasonable settings .",
    "based on simulations we were also able to recommend sample size necessary to conduct the proposed analysis , and the maximum percentage of missing values under which the method will still work reasonably well with imputations .",
    "we also illustrated the method by applying it real data of water levels from aquifers and precipitation levels , and emphasized the importance of quantifying the uncertainty related to estimate of the lag .",
    "25    dripps , w.r . ( 2003 ) , the spatial and temporal variability of ground water recharge . ph.d .",
    ", department of geology and geophysics , university of wisconsin  madison .",
    "dripps , w.r . , hunt , r.j . and anderson , m.p .",
    "( 2006 ) , estimating recharge rates with analytic element models and parameter estimation .",
    "ground water , 44 : 4755 .",
    "lacasa , l. , luque , b. , ballesteros , f. , luque , j. , and nuno , j.c .",
    "( 2008 ) from time series to complex networks : the visibilty graph .",
    "usa 105 , 13 , 4972 - 4975 .",
    "lacasa , l. , luque .",
    "b. ( 2010 ) mapping time series to networks : a brief overview of visibility algorithms .",
    "computer science research and technology vol 3 ( edited by nova publisher ) , isbn : 978 - 1 - 61122 - 074 - 2 .",
    "levanon , e. , shalev , e. , yechieli y , gvirtzman h. ( 2016 ) fluctuations of fresh - saline water interface and of water table induced by sea tides in unconfined aquifers .",
    "advances in water resources , volume 96 , 34 - 42 nunez , a. , lacasa , l. , luque , b. ( 2012 ) visibility algorithms : a short review .",
    "graph theory ( edited by intech ) , isbn 979 - 953 - 307 - 303 - 2 .",
    "south florida water management district ( sfwmd ) ( 2015a ) , water use permit applicant s handbook , part b. south florida water management district ( sfwmd ) ( 2015b ) , tech pub ws-35 , hydrogeologic unit mapping update for the lower west coast water supply planning area wei , w.w.s . , ( 2006 ) time series analysis : univariate and multivariate methods ( 2nd edition ) .",
    "westoff , m.c . ,",
    "bogaard , t.a . ,",
    "savenije , h.h.g .",
    "( 2010 ) quantifying the effect of in - stream rock clasts on the retardation of heat along a stream advances in water resources , volume 33 , issue 11 , 1417 - 1425 wisconsin department of natural resources , pub - fh-800 2009 ,",
    " wisconsin lakes \""
  ],
  "abstract_text": [
    "<S> estimating the time lag between two hydrogeologic time series ( e.g. precipitation and water levels in an aquifer ) is of significance for a hydrogeologist - modeler . in this paper , we present a method to quantify such lags by adapting the visibility graph algorithm , which converts time series into a mathematical graph . </S>",
    "<S> we present simulation results to assess the performance of the method . </S>",
    "<S> we also illustrate the utility of our approach using a real world hydrogeologic dataset .    </S>",
    "<S> time series , visibility graph algorithm , hydrogeology , aquifer water level , precipitation </S>"
  ]
}