{
  "article_text": [
    "the derivation of the conditional mean and variance of the number of photons in the signal field conditioned on @xmath30 photons being detected in the idler field is described in this appendix .    to calculate the conditional mean and variance",
    ", we need to evaluate the sums defined by @xmath72 where @xmath73 and @xmath74 are the probability distributions given in the text in eq .",
    "( [ eq - pngn ] ) and eq .",
    "( [ eq - pmu ] ) respectively .",
    "the simplest case is that of @xmath75 . performing the summation over @xmath4 by recognizing the negative binomial series",
    ", we find @xmath76 where we have defined @xmath77 and @xmath78 for simplicity .",
    "next , using the identity for gauss hypergeometric series , @xmath79 , where @xmath80 is the beta function , we express @xmath81 as @xmath82 where @xmath83 is shorthand for the @xmath84th - order partial derivative with respect to @xmath85 .",
    "we follow an analogous procedure for the case when @xmath86 , where the primary difference is that the summations over @xmath28 are now derivatives of the negative binomial series .",
    "the resulting sum @xmath87 is given by @xmath88,\\ ] ] with @xmath89 .",
    "the sum @xmath90 is similarly given by @xmath91 ,      \\end{split}\\ ] ] where @xmath92 is defined for simplicity .    the conditional mean and variance can be expressed in terms of these sums as @xmath93 and @xmath94 . substituting into these equations and simplifying , we find the general form for the conditional mean and variance to be @xmath95 + where @xmath96 . by setting @xmath97",
    "it is not difficult to recover the single - mode results of eq .",
    "( [ eq - condmean ] ) and eq .",
    "( [ eq - condvar ] ) shown in the text .",
    "furthermore , the single - mode and multimode expressions for @xmath53 can be easily found from these results ."
  ],
  "abstract_text": [
    "<S> a technique for conditionally creating single- or multimode photon - number states is analyzed using bayesian theory . </S>",
    "<S> we consider the heralded @xmath0-photon states created from the photons produced by an unseeded optical parametric amplifier when the heralding detector is the time - multiplexed photon - number - resolving detector recently demonstrated by fitch , _ et al_.  [ phys . </S>",
    "<S> rev . </S>",
    "<S> a * 68 * , 043814 ( 2003 ) . ] and simultaneously by achilles , _ </S>",
    "<S> et al_.  [ opt </S>",
    "<S> . lett . </S>",
    "<S> * 28 * , 2387 ( 2003 ) . ] . </S>",
    "<S> we find that even with significant loss in the heralding detector , fields with sub - poissonian photon - number distributions can be created . </S>",
    "<S> we also show that heralded multimode fields created using this technique are more robust against detector loss than are single - mode fields .    </S>",
    "<S> a fock state of the electromagnetic field contains a definite number of photons and hence displays no intensity fluctuations . </S>",
    "<S> in contrast , the distribution of the intensities of a classical field of light has a variance at least as large as its mean  @xcite . </S>",
    "<S> thus , fock states and other states with sub - poissonian photon - number statistics are of interest not only because of their fundamentally nonclassical nature but also because of their potential to make radiometric measurements with greater accuracy than possible using classical states of light . </S>",
    "<S> research in fock state generation is also motivated by its applications in quantum information science  @xcite including the areas of quantum cryptography  @xcite and quantum computing  @xcite .    </S>",
    "<S> unfortunately , it can be experimentally challenging to produce light fields that contain definite numbers of photons . </S>",
    "<S> several theoretical proposals aimed at creating fock states `` on demand '' have been offered  @xcite , but they involve trapped atoms in high - q cavities and to the best of our knowledge only single - photon states have been created in the laboratory  @xcite . </S>",
    "<S> several stochastic sources of one- and two - photon states have been experimentally demonstrated using various processes including atomic and molecular fluorescence  @xcite , coulomb blockade for electrons  @xcite and action in a micromaser  @xcite . </S>",
    "<S> in addition , a particularly simple method of generating single - photon states using the photon pairs created in the process of spontaneous parametric down - conversion was first demonstrated by hong and mandel  @xcite . in their experiment </S>",
    "<S> , they used the single - photon detection of one photon of the pair to `` herald '' the presence of the other photon of the pair . </S>",
    "<S> this heralding scheme is generalizable to create multiphoton states of light . in an unseeded optical parametric amplifier ( opa ) , pump photons interact nonlinearly with a noncentrosymmetric crystal to produce multiple pairs of less energetic photons termed the signal and idler through the process of parametric down - conversion ( pdc ) . </S>",
    "<S> in general , the number of photons found in the signal and idler fields is random and known to obey thermal statistics , which can be characterized by the gain @xmath1 of the opa . </S>",
    "<S> but since the emission of every signal photon requires the simultaneous emission of an idler photon , if one knows the number of photons in the idler field then the number in the signal field is determined with complete certainty . </S>",
    "<S> thus , in principle , by allowing transmission of the signal field only when the idler field is found to contain @xmath2 photons , the signal field will be guaranteed to also contain exactly @xmath2 photons . </S>",
    "<S> this idea was considered by holmes _ </S>",
    "<S> et al . _  </S>",
    "<S> @xcite for ideal photon - number - resolving detection .    </S>",
    "<S> however , the photon - number - resolving detection needed to create heralded multiphoton states is not trivial to implement and is an area of active research . </S>",
    "<S> photon - number - resolving detection has been achieved using superconducting transition - edge sensors  @xcite , visible light counters  @xcite , charge integration photon detectors  @xcite , and by time - multiplexed detection involving only commercially available apds  @xcite . in the present work , </S>",
    "<S> we show that , in particular , the photon - number resolution achieved using time - multiplexed detectors ( tmds ) , as first conceived by fitch _ et al . _  </S>",
    "<S> @xcite and independently by achilles _ </S>",
    "<S> et al . _  </S>",
    "<S> @xcite , is well - suited for creating heralded fields with near - definite numbers of photons even in the presence of significant detector loss . </S>",
    "<S> this technique has been demonstrated experimentally for two - photon states  @xcite but has not yet been analyzed in a comprehensive fashion for states containing greater numbers of photons .     </S>",
    "<S> ( a ) scheme to produce heralded fields containing a definite number of photons . an unseeded optical parametric amplifier ( opa ) produces photon pairs through the process of parametric down - conversion ( pdc ) . </S>",
    "<S> when a time - multiplexed photon - number - resolving detector ( shown in ( b ) ) detects @xmath3 photons in the idler field , it heralds the presence of @xmath4 photons in the signal field with probability @xmath5 . ]    </S>",
    "<S> a schematic of the proposed heralding technique is shown in fig .  </S>",
    "<S> [ fig - setup ] . as mentioned above , the source of photon pairs is the output of an unseeded opa and the heralding detector is a tmd . </S>",
    "<S> the tmd provides photon - number resolution by first randomly splitting the incoming state into many pathways that are separated in time from one another , i.e.  they are separated into time bins . </S>",
    "<S> the number of photons in the incoming field can be estimated to be equal to the total number of photons detected by two avalanche photodiodes ( apds ) . </S>",
    "<S> any errors in this estimation will introduce uncertainty into the number of photons contained in the heralded state . </S>",
    "<S> undercounting is the main source of errors in tmds . </S>",
    "<S> the two primary mechanisms for undercounting errors are losses and inadequate splitting of the incoming beam . </S>",
    "<S> losses in the detection system stemming both from the beam splitters and from inefficiencies in detectors themselves can be quite significant and must be included in the analysis . </S>",
    "<S> inadequate splitting occurs because of the finite number of times the incoming beam is split . </S>",
    "<S> hence , a chance exists that two or more photons will occupy the same time bin resulting in an undercounting error at the apds , which can perform only on / off detection . </S>",
    "<S> more quantitatively , a system containing @xmath6 beam splitters will have @xmath7 different time bins . </S>",
    "<S> if the number of incoming photons @xmath0 is much less than @xmath8 , the probability of undercounting due to imperfect splitting will be small . </S>",
    "<S> however , when @xmath0 is comparable to @xmath8 , we must account for splitting errors . using a standard urn model  @xcite </S>",
    "<S> , we can calculate the conditional probability of detecting @xmath2 photons given that the incoming field has @xmath0 photons in it . </S>",
    "<S> this probability is given by the expression @xmath9^n,\\ ] ] where @xmath10 is the single - photon detection efficiency . </S>",
    "<S> it is not difficult to verify that in the limit @xmath11 and @xmath12 detection errors due to imperfect splitting are negligible and that @xmath13 , which is the expected distribution for an ideal photon - number - resolving detector subject to a loss of @xmath14 per photon . </S>",
    "<S> we note that detector dark counts are a source of overcounting errors . </S>",
    "<S> however , in the present analysis , we do not include the effect of detector dark counts , since often they can be rendered neglible through detector gating or by use of detectors with intrinsically low dark count rates ( commercially available apd dark count rates can be as low as 5 dark counts per second ) .    </S>",
    "<S> the response of the detection system is shown in fig .  </S>",
    "<S> [ fig - pnn ] for a system comprised of five beam splitters ( m=32 ) for three different scenarios . for no loss in the tmd ( @xmath15 ) and few enough incident photons </S>",
    "<S> , the detector will accurately measure the number of photons in the field , i.e.  the initial slope of the mean of the probability distribution is linear with unity slope . </S>",
    "<S> once the number of incident photons increases and becomes comparable to the maximum number of photons @xmath8 the system can count , undercounting will become very likely and the detection system will saturate . as the loss in the system increases ( @xmath10 decreases ) , </S>",
    "<S> two effects are seen : ( 1 ) the initial slope decreases and is given roughly by @xmath10 and ( 2 ) the error in the estimate increases as seen by the increase in the vertical spread of the distribution in the plot .     </S>",
    "<S> regions where there is a significant probability of detecting @xmath2 photons conditioned on @xmath0 photons being incident on the tmd for three different single - photon detection efficiencies ( @xmath16 1.0 , 0.66 , 0.33 ) . </S>",
    "<S> the mean number of photons detected given @xmath0 photons input into the detection system are plotted using the solid ( @xmath17 ) , dotted ( @xmath18 ) and dashed ( @xmath19 ) lines . </S>",
    "<S> the shaded regions are within one standard deviation of the means . ]    as we already mentioned , in a heralding system any error in the detection of the number of photons in the heralding field will directly lead to an uncertainty in the number of the photons in the heralded field . </S>",
    "<S> if this uncertainty , as determined by the variance of the number photons estimated to be in the heralding field , becomes larger than the mean number of photons in the heralded field , the state can , in principle , be produced by classical means . </S>",
    "<S> however , since the source of the photon pairs is an opa , we can use this _ a priori _ information about its photon emission statistics to improve our estimation through the use of bayesian theory .    </S>",
    "<S> the probability that an opa characterized by gain @xmath1 will emit @xmath20 pairs of photons is given by @xmath21 , where @xmath22 is the state containing @xmath20 photons in both the signal and idler fields and @xmath23 is the state emitted by the opa , which is given by @xmath24 @xcite . as a notational device </S>",
    "<S> , we will identify the signal field with the heralded field and the idler field with the heralding field . </S>",
    "<S> it can be shown that the resulting photon - number distribution for either the signal or idler field obey bose - einstein statistics and is given by @xmath25 we can calculate the resulting mixed state of the signal field given that @xmath3 photons are detected in the idler field . </S>",
    "<S> the density matrix is given by @xmath26 where @xmath27 is a fock state of the signal field with @xmath28 photons in it . </S>",
    "<S> the function @xmath29 is the probability that the signal field has @xmath28 photons in it given that @xmath30 photons are detected in the idler field . according to bayes theorem , it is given by the expression @xmath31    </S>",
    "<S> we estimate the number of photons in the signal field using maximum - likelihood estimation . </S>",
    "<S> the maximum - likelihood estimate of the number of photons in the signal field given @xmath30 photons detected in the idler field is found using @xmath32 where the @xmath33 function returns the value of @xmath34 that maximizes @xmath29 .     </S>",
    "<S> comparison of the photon - number statistics for a typical heralded field with @xmath35 ( in blue ) and a poisson - distributed field with a mean photon number of 5 ( in gray ) . </S>",
    "<S> the heralded field , for the case in which @xmath18 and @xmath36 , is conditioned on the detection of 4 photons in the idler field by the tmd . ]    in fig .  </S>",
    "<S> [ fig - psig4 ] we show the photon - number statistics for a heralded field estimated to have @xmath35 photons in it and compare it to a classical coherent state that has poisson statistics with a mean number of photons equal to 5 . from the figure it is clear that the photon - number distribution of the heralded state is much narrower than the distribution for the comparable classical coherent state . </S>",
    "<S> the width of the heralded field distribution is exactly the error in the maximum - likelihood estimate and is found using the mean squared error , i.e.  @xmath37 . </S>",
    "<S> figure  [ fig - relerr ] compares the ratio of the spreads of the heralded fields to their classical counterparts for different numbers of photons in the heralding field for various values of the single - photon detection efficiency @xmath10 and the opa gain @xmath1 . </S>",
    "<S> when this ratio is equal to unity , the heralded field has as much uncertainty in its number of photons as a poissonian field . </S>",
    "<S> the smaller the ratio is , the closer the heralded field is to a fock state . </S>",
    "<S> the quality of the heralded state degrades as the loss increases and the gain of the opa increases , as can be seen by noting that the ratio increases in these cases .     </S>",
    "<S> uncertainty in the number of photons in a heralded field when @xmath30 photons are detected in the heralding field normalized to the uncertainty in a comparable poisson - distributed field with mean number of photons @xmath38 for various detection efficiencies ( @xmath39 ) and opa gains ( @xmath40 ) . ]    to gain further insight into the behavior of the heralded state , we consider the mean number of photons in the heralded field . </S>",
    "<S> although the mean number of photons can not be an estimator of the number of photons in the heralded field , since it can take non - integer values , it is useful parameter that characterizes the field and can be analytically calculated . </S>",
    "<S> the mean number of photons in the signal field conditioned on @xmath30 photons being detected in the idler field can be expressed in the following remarkably simple form ( see appendix ) @xmath41 similarly , the conditional variance of the number of photons in the signal field can be expressed by @xmath42 where in both equations we have introduced the quantity @xmath43\\right\\}^{-1}$ ] for notational convenience . </S>",
    "<S> an ideal system would produce fock states with definite photon number so that @xmath44 would vanish . </S>",
    "<S> we note that @xmath45 can not vanish since that requires @xmath10 to vanish , which is not a physically meaningful situation . </S>",
    "<S> thus , @xmath44 goes to zero only in the limit in which @xmath46 . </S>",
    "<S> also in this limit the conditional mean @xmath47 , which is consistent with the expected behavior of an ideal heralding system .    </S>",
    "<S> two cases exist in which @xmath45 approaches unity . </S>",
    "<S> the first case occurs in the low gain limit . </S>",
    "<S> irrespective of the system loss @xmath10 , @xmath45 can be made arbitrarily close to one for small enough gain since @xmath48 . </S>",
    "<S> intuitively , this limit is easily understood . when the gain is small enough </S>",
    "<S> , it is much more likely for the source to produce @xmath28 photon pairs and the detector to count @xmath30 of them than it is for the source to produce @xmath49 pairs and the detector to still detect only @xmath30 . </S>",
    "<S> more quantitatively , there exists a gain such that the ratio @xmath50 . </S>",
    "<S> this statement is easily verified by noting that @xmath51 and can be made large for small enough @xmath1 . </S>",
    "<S> the second case in which @xmath45 goes to one occurs when @xmath52 and @xmath17 . in this limit </S>",
    "<S> the tmd behaves like an ideal photon number resolving detector and the system achieves perfect heralding .    </S>",
    "<S> although these limiting cases are useful in providing insight into the behavior of the system , they are often not viable experimentally . </S>",
    "<S> if the gain is too low , the rate at which the heralded states are produced becomes impractically small . </S>",
    "<S> furthermore in many cases @xmath8 can not be too large , if for no other reason than that the loss incurred by adding splitters can become excessive . to treat the problem more generally , we calculate mandel s @xmath53 parameter defined by @xmath54  @xcite . </S>",
    "<S> mandel s </S>",
    "<S> @xmath53 parameter is useful for characterizing the nature of the photon - number distribution of a field . </S>",
    "<S> the @xmath53 parameter is bounded below by @xmath55 . in the limit in which @xmath56 , </S>",
    "<S> the heralded field is in a fock state . for @xmath57 , </S>",
    "<S> the field has poissonian photon - number statistics ; for positive and negative @xmath53 the field has super- and sub - poissonian statistics respectively . </S>",
    "<S> we use this parameter as a merit function describing the quality of the heralded states produced using the technique .     </S>",
    "<S> mandel s @xmath53 parameter versus the gain of the opa and the single - photon detection efficiency of the time - multiplexed detector ( tmd ) for the case where @xmath58 , i.e. , the heralded field is a single - mode field estimated to contain 5 photons . </S>",
    "<S> the colored regions are labeled with the number of detected idler photons needed to herald the presence of 5 photons in the signal field . </S>",
    "<S> the white contours are lines of constant @xmath59 , the probability of creating the heralded state . </S>",
    "<S> the tmd is assumed to contain 5 beam splitters ( m=32 ) ]    in practice , it is useful to know the tmd and opa parameters necessary to produce a state that contains an estimated @xmath38 photons and a certain value of the @xmath53 parameter . to this end , we calculate @xmath53 at constant @xmath38 versus the parameters @xmath10 and @xmath1 . </S>",
    "<S> figure  [ fig - q5 ] shows the result of the calculation for a heralding detector comprised of five beam splitters for the case when @xmath58 . to calculate @xmath53 for constant @xmath38 </S>",
    "<S> it is necessary to invert eq  ( [ eq - nml ] ) to find the appropriate value of @xmath30 to be substituted into eqs  ( [ eq - condmean ] ) and ( [ eq - condvar ] ) . for certain values of the gain and detector efficiencies , </S>",
    "<S> eq  ( [ eq - nml ] ) can not be inverted , i.e.  there is no integer number of detected photons @xmath3 that correspond to a signal field in which @xmath58 . in these instances , a signal field estimated to contain five photons is not possible to produce and is marked by the gray regions in the plot . </S>",
    "<S> also , the gray bands divide the space into regions corresponding to the number of detected idler photons that herald the presence of 5 photons in the signal field . </S>",
    "<S> the figure confirms that the losses as well as the opa gain should be kept as small as possible . </S>",
    "<S> in addition , the efficiency with which the heralded states are created is important . </S>",
    "<S> the white contour lines overlaid on the plot show the probability with which the heralded state is successfully created , which is denoted by @xmath60 . </S>",
    "<S> this probability is calculated from the sum @xmath61 where @xmath3 is obtained from the inversion of eq .  </S>",
    "<S> ( [ eq - nml ] ) for different values of @xmath1 and @xmath10 . </S>",
    "<S> the discrete jumps seen in the contour lines are due to the fact the @xmath3 can take only integer values . </S>",
    "<S> we see that it is possible to create nearly ideal fock states even with significant detector loss ; however , the efficiency of the creation of the heralded states is sacrificed .    up to this point , we have considered only single - mode states produced by an opa . </S>",
    "<S> although the single - mode limit can be reached , e.g.  by both spatially and frequency filtering  @xcite , the photons emitted by a free - space opa are generally multimodal in nature and can be approximately described by a multimode thermal distribution  @xcite . </S>",
    "<S> the probability that the opa will emit @xmath20 pairs of photons distributed among any @xmath62 modes is given by @xmath63 where @xmath1 is the parameter characterizing the gain per mode of the opa . </S>",
    "<S> we have assumed that each mode is equally likely to be occupied . </S>",
    "<S> the multimode thermal distribution has a variance of @xmath64 . </S>",
    "<S> since when @xmath65 is held constant , the variance decreases with increasing number of modes , it is reasonable to expect that we may be able to create multimode fields containing near - definite numbers of photons under more relaxed conditions than by restricting ourselves to single - mode states .     </S>",
    "<S> mandel s @xmath53 parameter versus gain of the opa and the single - photon detection efficiency of the tmd for the case where @xmath35 and @xmath66 , i.e.  the signal field is estimated to contain 5 photons spread between 5 modes . </S>",
    "<S> the colored regions are labeled with the number of detected idler photons needed to herald the presence of 5 photons in the signal field . </S>",
    "<S> the white contours are lines of constant @xmath67 , the probability of creating the heralding state . ]    in fig .  </S>",
    "<S> [ fig - q5a ] we plot the @xmath53 parameter under the same conditions as in fig .  </S>",
    "<S> [ fig - q5 ] but now assuming that we are interested in the multimode output of the opa ( see appendix for calculation details ) . </S>",
    "<S> we take @xmath68 as an example , which is typical value for a free space opa  @xcite . when comparing fig .  </S>",
    "<S> [ fig - q5 ] and fig .  [ fig - q5a ] , we see that the multimode case is more tolerant of loss in the heralding detector than the single mode case . for example , if we require a heralded state preparation rate of @xmath69 , the heralded output of the opa is sub - poissonian so long as @xmath70 , but in the single - mode case we have the more stringent requirement that @xmath71 .    in conclusion </S>",
    "<S> , we have shown that it is possible to create multiphoton heralded states with highly non - classical photon - number distributions using a tmd as the heralding detector . </S>",
    "<S> we calculated mandel s @xmath53 parameter as a function of the detector loss and the opa gain to characterize the quality of the heralded state . even in the presence of significant loss </S>",
    "<S> , we found that it is possible to produce states with highly sub - poissonian photon - number distributions at reasonable efficiencies . </S>",
    "<S> in addition , for situations where a single - mode output is not required , we showed that the full multimode output of an opa can provide less uncertainty in the number of photons in the field than the single - mode output . </S>",
    "<S> since the tmds involve only commercially available apds and fibers , the technique we have presented here can be a particularly simple way to create states of light containing nearly definite numbers of photons .    </S>",
    "<S> the authors would like to thank christine silberhorn and gerd leuchs for helpful discussions . </S>",
    "<S> this work was supported by the us army research office through a muri grant . </S>",
    "<S> kwc thanks the support from the croucher foundation . </S>"
  ]
}