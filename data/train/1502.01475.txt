{
  "article_text": [
    "image segmentation is a fundamental problem in computer vision . despite many years of research @xcite",
    ", general - purpose image segmentation is still a very challenging task because segmentation is inherently ill - posed . to improve the results of image segmentation ,",
    "much attention has been paid to constrained image segmentation @xcite , where certain constraints are initially provided for image segmentation . in this paper , we focus on constrained image segmentation using pairwise constraints , which can be derived from the initial labels of selected pixels . in general , there exist two types of pairwise constraints : must - link constraint denotes a pair of pixels belonging to the same image region , while cannot - link constraint denotes a pair of pixels belonging to two different image regions . in previous work",
    "@xcite , such weak supervisory information has been widely used to improve the performance of machine learning and pattern recognition @xcite in many challenging tasks .",
    "the main challenge in constrained image segmentation is how to effectively exploit a limited number of pairwise constraints for image segmentation .",
    "a sound solution is to perform pairwise constraint propagation to generate more pairwise constraints .",
    "although many pairwise constraint propagation methods @xcite have been developed for constrained clustering @xcite , they mostly have a polynomial time complexity and thus are not much suitable for segmentation of images even with a moderate size ( e.g. @xmath1 pixels ) , which is actually equivalent to clustering with a large data size ( i.e. @xmath2 ) . for constrained image segmentation , we need to develop more efficient pairwise constraint propagation methods , instead of directly utilizing the existing methods like @xcite . here",
    ", it is worth noting that even the simple assignment operation incurs a large time cost of @xmath3 if we perform pairwise constraint propagation over all the pixels , since the number of all possible pairwise constraints is @xmath4 .",
    "the unique choice is to propagate the initial pairwise constraints _ only to a selected subset of pixels _ , but not across the whole image .",
    "fortunately , the local homogeneousness of a natural image provides kind of supports for this choice , i.e. , a selected subset of pixels may approximate the whole image ( such downsampling is widely used in image processing ) .",
    "more importantly , the selectively propagated constraints over a selected subset of pixels are enough for achieving a good quality of image segmentation , as verified by our later experimental results . hence , in this paper , we develop a selective constraint propagation ( scp ) method for constrained image segmentation , whichpropagates the initial pairwise constraints only to a selected subset of pixels ( _ the first meaning _ of our selective constraint propagation ) .",
    "although there exist different sampling methods in statistics , we only consider random sampling for efficiency purposes , i.e. , the subset of pixels used for selective constraint propagation are selected randomly from the whole image . in this paper , we formulate our selective constraint propagation as a graph - based learning problem which can be efficiently solved based on the label propagation technique @xcite . to further speed up our algorithm",
    ", we also discard those less important propagated constraints during iteration of graph - based learning , which is _ the second meaning _ of our selective constraint propagation . to the best of our knowledge ,",
    "we have made the first attempt to develop a selective constraint propagation method for constrained image segmentation .",
    "finally , the selectively propagated constraints obtained by our selective constraint propagation are exploited to adjust the original weight matrix based on optimization techniques , in order to ensure that the new weight matrix is as consistent as possible with the selectively propagated constraints . in this paper",
    ", we formulate such weight adjustment as an _",
    "problem @xcite , which can be solved efficiently due to the limited number of selectively propagated constraints .",
    "the obtained new weight matrix is then applied to normalized cuts @xcite for image segmentation .",
    "the flowchart of our selective constraint propagation for constrained image segmentation is illustrated in figure  [ fig.1 ] .",
    "although our selective constraint propagation method is originally designed for constrained image segmentation , it can be readily extended to other challenging tasks ( e.g. , semantic image segmentation and multi - face tracking ) where only a limited number of pairwise constraints are provided initially .",
    "it should be noted that the present work is distinctly different from previous work on constrained image segmentation @xcite . in @xcite ,",
    "only linear equality constraints ( analogous to must - link constraints ) are exploited for image segmentation based on normalized cuts . in @xcite , although more types of constraints are exploited for image segmentation , the linear inequality constraints analogous to cannot - link constraints are completely ignored just as @xcite .",
    "in contrast , our selective constraint propagation method exploits both must - link and cannot - link constraints for normalized cuts .",
    "more notably , as shown in our later experiments , our method _ obviously outperforms _",
    "@xcite due to extra consideration of cannot - link constraints for image segmentation .",
    "the remainder of this paper is organized as follows . in section 2",
    ", we develop a selective constraint propagation method which propagates the initial pairwise constraints only to a selected subset of pixels . in section 3 ,",
    "the selectively propagated constraints are further exploited to adjust the original weight matrix based on @xmath0-minimization for normalized cuts .",
    "finally , sections 4 and 5 give the experimental results and conclusions , respectively .",
    "this section presents our selective constraint propagation ( scp ) in detail .",
    "we first give our problem formulation for propagating the initial pairwise constraints only to a selected subset of pixels from a graph - based learning viewpoint , and then develop an efficient scp algorithm based on the label propagation technique @xcite .      in this paper ,",
    "our goal is to propagate the initial pairwise constraints to a selected subset of pixels for constrained image segmentation . to this end",
    ", we need to first select a subset of pixels for our selective constraint propagation .",
    "although there exist different sampling methods in statistics , we only consider random sampling for efficiency purposes , i.e. , the subset of pixels are selected randomly from the whole image . in the following , the problem formulation for selective constraint propagation over the selected subset of pixels is elaborated from a graph - based learning viewpoint .",
    "let @xmath5 denote the set of initial must - link constraints and @xmath6 denote the set of initial cannot - link constraints , where @xmath7 is the region label assigned to pixel @xmath8 and @xmath9 is the total number of pixels within an image .",
    "the set of constrained pixels is thus denoted as @xmath10 with @xmath11 .",
    "moreover , we randomly select a subset of pixels @xmath12 with @xmath13 , and then form the final selected subset of pixels used for our selective constraint propagation as @xmath14 with @xmath15 .    in this paper",
    ", we construct a @xmath16-nearest neighbors ( @xmath16-nn ) graph over all the pixels so that the normalized cuts for image segmentation can be performed efficiently over this @xmath16-nn graph .",
    "let its weight matrix be @xmath17 .",
    "we define the weight matrix @xmath18 over the selected subset of pixels @xmath19 as : @xmath20 where @xmath21 denotes the @xmath8-th member of @xmath19 .",
    "the normalized laplacian matrix is then given by @xmath22 where @xmath23 is an identity matrix and @xmath24 is a diagonal matrix with its @xmath8-th diagonal entry being the sum of the @xmath8-th row of @xmath25 .",
    "moreover , for convenience , we represent the two sets of initial pairwise constraints @xmath26 and @xmath27 using a single matrix @xmath28 as follows : @xmath29    based on the above notations , the problem of selective constraint propagation over the selected subset of pixels @xmath19 can be formulated from a graph - based learning viewpoint : @xmath30 where @xmath31 and @xmath32 denote the positive regularization parameters , @xmath33 denotes the frobenius norm of a matrix , and @xmath34 denotes the trace of a matrix . here , it is worth noting that the above problem formulation actually imposes both _ vertical and horizontal _ constraint propagation upon the initial matrix @xmath35 .",
    "that is , each column ( or row ) of @xmath35 can be regraded as the initial configuration of a _ two - class label propagation _",
    "problem , which is formulated just the same as @xcite .",
    "moreover , in this paper , we assume that the vertical and horizontal constraint propagation have the same importance for constrained image segmentation .",
    "the objective function given by eq .",
    "( [ eq : intracp ] ) is further discussed as follows .",
    "the first and second terms are related to the _ vertical _ constraint propagation , while the third and fourth terms are related to the _ horizontal _ constraint propagation .",
    "the fifth term then ensures that the solutions of these types of constraint propagation are as approximate as possible .",
    "let @xmath36 and @xmath37 be the best solutions of vertical and horizontal constraint propagation , respectively .",
    "the best solution of our selective constraint propagation is defined as : @xmath38 as for the second and fourth terms , they are known as laplacian regularization @xcite , which means that @xmath39 and @xmath40 should not change too much between similar pixels . such laplacian regularization has been widely used for different graph - based learning problems in the literature .    to apply our selective constraint propagation ( scp ) to constrained image segmentation",
    ", we have to concern the following key problem : _ how to solve eq .",
    "( [ eq : intracp ] ) efficiently_. fortunately , due to the problem formulation from a graph - based learning viewpoint , we can develop an efficient scp algorithm using the label propagation technique @xcite based on @xmath16-nn graph over @xmath19 .",
    "the proposed scp algorithm will be elaborated in the next subsection .",
    "let @xmath41 denote the objective function in eq .",
    "( [ eq : intracp ] ) . the alternate optimization technique can be adopted to solve @xmath42 as follows : 1 ) fix @xmath43 , and perform the vertical propagation by @xmath44 ; 2 ) fix @xmath45 , and perform the horizontal propagation by @xmath46 .    *",
    "vertical propagation : * when @xmath40 is fixed at @xmath37 , the solution of @xmath47 can be found by solving @xmath48 which is actually equivalent to @xmath49 where @xmath50 and @xmath51 . since @xmath52 is positive definite , the above linear equation has a solution : @xmath53 however , this analytical solution is not efficient at all for constrained image segmentation , since the matrix inverse incurs a large time cost of @xmath54 . in fact , this solution can also be _ efficiently found using the label propagation technique _",
    "@xcite based on @xmath16-nn graph over @xmath19 ( see the scp algorithm outlined below ) .",
    "* horizontal propagation : * when @xmath39 is fixed at @xmath36 , the solution of @xmath55 can be found by solving @xmath56 which is actually equivalent to @xmath57 this linear equation can also be efficiently solved using the label propagation technique @xcite based on @xmath16-nn graph , similar to what we do for eq .",
    "( [ eq : lev ] ) .    since the wight matrix @xmath25 over @xmath19",
    "is derived from the original weight matrix @xmath58 of the @xmath16-nn graph constructed over all the pixels according to eq .",
    "( [ eq : knnwt ] ) , @xmath25 can be regarded as the weight matrix of a @xmath16-nn graph constructed over @xmath19 .",
    "hence , we can adopt the label propagation technique @xcite to efficiently solve both eq .",
    "( [ eq : lev ] ) and eq .",
    "( [ eq : leh ] ) .",
    "moreover , to speed up our selective constraint propagation , we also discard those less important propagated constraints during both vertical and horizontal propagation .",
    "that is , the two matrices @xmath39 and @xmath40 are forced to become sparser and thus less computation load is needed during iteration .",
    "the complete scp algorithm is outlined as follows :    ( 1 ) : :    compute @xmath59 , where @xmath60 is given by    eq .",
    "( [ eq : lap ] ) ; ( 2 ) : :    initialize @xmath61 , @xmath62 , and    @xmath63 ; ( 3 ) : :    discard those less important propagated constraints with    @xmath64 during the vertical propagation , where    we set @xmath65 in this paper ; ( 4 ) : :    @xmath66 , where @xmath67    and @xmath68 ; ( 5 ) : :    iterate steps ( 3)(4 ) for the vertical propagation until convergence    at @xmath36 ; ( 6 ) : :    discard those less important propagated constraints with    @xmath69 during the horizontal propagation ; ( 7 ) : :    @xmath70 ; ( 8) : :    iterate steps ( 6)(7 ) for the horizontal propagation until until    convergence at @xmath37 ; ( 9 ) : :    iterate steps ( 3)(8 ) until the stopping condition is satisfied , and    output the solution @xmath71 .    similar to @xcite , the iteration in step ( 4 ) converges to @xmath72 , which is equal to the solution ( [ eq : lp ] ) given that @xmath73 and @xmath59 . moreover , in our later experiments , we find that the iterations in steps ( 5 ) , ( 8) and ( 9 ) generally converge in very limited steps ( @xmath7410 ) . finally , based on @xmath16-nn graph , our scp algorithm has a time cost of @xmath75 ( @xmath76 ) .",
    "hence , it can be considered to provide an efficient solution ( note that even a simple assignment operation on @xmath77 incurs a time cost of @xmath78 ) .",
    "in this section , we discuss how to exploit the selectively propagated constraints stored in the output @xmath77 of our scp algorithm for image segmentation based on normalized cuts .",
    "the basic idea is to adjust the original weight matrix @xmath25 over the selected subset of pixels @xmath19 using these selectively propagated constraints .",
    "the problem of such weight adjustment for normalized cuts can be formulated as : @xmath79 where @xmath80 is the new weight matrix over @xmath19 , and @xmath81 is the regularization parameter .",
    "it is worth noting that the new weight matrix @xmath82 is actually derived as a _ nonnegative fusion _ of @xmath77 and @xmath25 by solving the above @xmath0-minimization problem .",
    "more notably , the _ @xmath0-norm regularization _",
    "term @xmath83 can force the new weight matrix @xmath82 not only to approach @xmath25 but also to become as sparse as @xmath25 , given that @xmath25 can be regarded as the weight matrix ( thus sparse ) of a @xmath16-nn graph constructed over @xmath19 .",
    "the problem given by eq .",
    "( [ eq : wtadjust ] ) can be solved based on some basic @xmath0-minimization techniques @xcite .",
    "in fact , it has an explicit solution : @xmath84 where @xmath85 is a soft - thresholding function . here",
    ", we directly define @xmath86 as : @xmath87 where @xmath88 and @xmath89 . since the @xmath0-minimization problem given by eq .",
    "( [ eq : wtadjust ] ) is limited to @xmath19 , finding the best new weight matrix @xmath90 incurs a time cost of @xmath78 ( @xmath76 ) .",
    "once we have found the best new weight matrix @xmath91 over the selected subset of pixels @xmath19 , we can derive the new weight matrix @xmath92 over all the pixels from the original weight matrix @xmath17 of the @xmath16-nn graph as : @xmath93 where @xmath94 denotes the @xmath95-th member of @xmath19 .",
    "this new weight matrix @xmath96 over all the pixels is then applied to normalized cuts for image segmentation .",
    "the full algorithm for constrained image segmentation can be summarized as follows :    ( 1 ) : :    generate the selectively propagated constraints using our scp    algorithm proposed in section  2 ; ( 2 ) : :    adjust the original weight matrix by exploiting the selectively    propagated constraints according to eq .",
    "( [ eq : wtbest ] ) ; ( 3 ) : :    perform normalized cuts with the adjusted new weight matrix for image    segmentation .    as we have mentioned , steps ( 1 ) and ( 2 ) incur a time cost of @xmath75 and @xmath78 ( @xmath76 ) , respectively .",
    "moreover , since the adjusted new weight matrix @xmath96 is very sparse , step ( 3 ) can be performed efficiently . here",
    ", it is worth noting that the most time - consuming component of normalized cuts ( i.e. , eigenvalue decomposition ) has a linear time cost when the weight matrix is very sparse . in summary , our algorithm runs very efficiently for constrained image segmentation .",
    "in this section , our algorithm is evaluated in the task of constrained image segmentation .",
    "we first describe the experimental setup , including information of the feature extraction and the implementation details .",
    "moreover , we compare our algorithm with other closely related methods .      for segmentation evaluation ,",
    "we select 50 images from the berkeley segmentation database @xcite ( along with ground truth segmentations ) , and some sample images are shown in figures [ fig.2 ] and [ fig.4 ] .",
    "it can be observed that these selected images generally have _ confusing backgrounds _ , such as the penguin and kangaroo images .",
    "furthermore , we consider a 6-dimensional vector of color and texture features for each pixel of an image just as @xcite .",
    "the three color features are the coordinates in the l*a*b * color space , which are smoothed to avoid over - segmentation arising from local color variations due to texture .",
    "the three texture features are contrast , anisotropy , and polarity , which are extracted at an automatically selected scale .",
    "the segmentation results are measured by the adjusted rand ( ar ) index @xcite which takes values between -1 and 1 , and a higher ar score indicates that a higher percentage of pixel pairs in a test segmentation have the same relationship ( joined or separated ) as in each ground truth segmentation .",
    "we do not consider the original rand index @xcite for segmentation evaluation , since there exists a problem with this measure @xcite . in the following , our normalized cuts with selective constraint propagation ( ncuts_scp )",
    "is compared with three closely related methods : normalized cuts with linear equality constraints ( ncuts_lec ) @xcite , normalized cuts with spectral learning ( ncuts_sl ) @xcite , and standard normalized cuts ( ncuts ) @xcite . here",
    ", we do not make comparison to other constraint propagation methods @xcite , since they have a polynomial time complexity and are not suitable for image segmentation .",
    "0.14 cm    .the average segmentation results achieved by our ncuts_scp algorithm with a varied number ( i.e. @xmath97 ) of pixels being selected randomly . [",
    "cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     we further illustrate the selectively propagated constraints obtained by our ncuts_scp algorithm with @xmath98 in figure  [ fig.3 ] . here ,",
    "to explicitly represent the selectively propagated constraints , we need to infer the labels of @xmath97 randomly selected pixels from them .",
    "in fact , this inference can be done by simple voting according to the output of our scp with the initial set of labeled pixels being regarded as the voters .",
    "once we have inferred the labels of @xmath97 randomly selected pixels , we can show them out by marking the pixels within object and background by blue ` o ' and yellow ` x ' , respectively . from figure  [ fig.3 ]",
    ", we find that the selectively propagated constraints obtained by our ncuts_scp algorithm are mostly consistent with the ground truth segmentation .",
    "the comparison between different image segmentation methods is listed table  [ table.2 ] . meanwhile , this comparison is also illustrated in figures [ fig.2 ] and [ fig.4 ] . here , the segmentation results are evaluated by both ar index and running time averaged over all the images . in particular , we collect the running time by running all the algorithms ( matlab code ) on a computer with 3ghz cpu and 32 gb ram .",
    "the immediate observation is that our ncuts_scp algorithm significantly outperforms the other three methods in terms of ar index . since our ncuts_scp algorithm incurs a time cost comparable to closely related methods , it is preferred for constrained image segmentation by an _",
    "overall consideration_. in addition , it can be clearly observed that ncuts_scp , ncuts_lec , and ncuts_sl lead to better results than the standard ncuts due to the use of constraints for image segmentation .",
    "in this paper , we have investigated the challenging problem of pairwise constraint propagation in constrained image segmentation . considering the local homogeneousness of a natural image , we choose to perform pairwise constraint propagation only over a selected subset of pixels .",
    "moreover , we solve such selective constraint propagation problem by developing an efficient graph - based learning algorithm .",
    "finally , the selectively propagated constraints are used to adjust the weight matrix based on @xmath0-minimization for image segmentation .",
    "the experimental results have shown the promising performance of the proposed algorithm for constrained image segmentation . for future work",
    ", we will extend the proposed algorithm to other challenging tasks such as semantic segmentation and multi - face tracking .",
    "s.  hoi , w.  liu , m.  lyu , and w .- y . ma . learning distance metrics with contextual constraints for image retrieval . in _ proc .",
    "ieee conference on computer vision and pattern recognition _ ,",
    "pages 20722078 , 2006 .",
    "d.  klein , s.  kamvar , and c.  manning . from instance - level constraints to space - level constraints : making the most of prior knowledge in data clustering . in _ proc .",
    "international conference on machine learning _ , pages 307314 , 2002 .",
    "z.  li , j.  liu , and x.  tang . pairwise constraint propagation by semidefinite programming for semi - supervised classification . in _ proc .",
    "international conference on machine learning _ , pages 576583 , 2008 .",
    "d.  martin , c.  fowlkes , d.  tal , and j.  malik .",
    "a database of human segmented natural images and its application to evaluating segmentation algorithms and measuring ecological statistics . in _ proc .",
    "cvpr _ , volume  2 , pages 416423 , 2001 .",
    "e.  xing , a.  ng , m.  jordan , and s.  russell .",
    "distance metric learning with application to clustering with side - information . in _ advances in neural information processing systems 15",
    "_ , pages 505512 , 2003 ."
  ],
  "abstract_text": [
    "<S> this paper presents a novel selective constraint propagation method for constrained image segmentation . in the literature </S>",
    "<S> , many pairwise constraint propagation methods have been developed to exploit pairwise constraints for cluster analysis . however , since most of these methods have a polynomial time complexity , they are not much suitable for segmentation of images even with a moderate size , which is actually equivalent to cluster analysis with a large data size . considering the local homogeneousness of a natural image </S>",
    "<S> , we choose to perform pairwise constraint propagation only over a selected subset of pixels , but not over the whole image . </S>",
    "<S> such a selective constraint propagation problem is then solved by an efficient graph - based learning algorithm . to further speed up our selective constraint propagation </S>",
    "<S> , we also discard those less important propagated constraints during graph - based learning . finally , the selectively propagated constraints are exploited based on @xmath0-minimization for normalized cuts over the whole image . </S>",
    "<S> the experimental results demonstrate the promising performance of the proposed method for segmentation with selectively propagated constraints . </S>"
  ]
}