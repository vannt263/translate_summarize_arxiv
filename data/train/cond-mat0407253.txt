{
  "article_text": [
    "the study of random graphs , initiated more than four decades ago , has been since an issue of major interest in probability theory and in statistical mechanics .",
    "examples of random graphs abound @xcite , from the original erds - renyi model @xcite , where edges are chosen independently of each other between pairs of a set of @xmath0 vertices ( with a fixed probability of @xmath1 ) , to the scale - free graphs with power law degree distribution @xcite , only introduced in recent times .",
    "an interesting and useful distribution is the one that generates random @xmath2-regular graphs @xcite .",
    "these are uniformly drawn from the set of all graphs over @xmath0 vertices , each restricted to have degree @xmath2 .",
    "random regular graphs can be easily generated when @xmath0 is large ( and @xmath2 finite ) @xcite , and an instance of @xmath3-regular graph is symbolized in figure  [ figtree ] . around a randomly picked up vertex called _ root _ the graph looks like a regular tree .",
    "the probability that there exists a _ circuit _ ( a self - avoiding closed path ) of length @xmath4 going through the root vanishes when @xmath0 is sent to infinity and @xmath4 is kept finite .",
    "finite - length loops may be present in the graph , but not in extensive number . ]",
    "@xcite .",
    "the purpose of this article is to reach some quantitative understanding of the presence of long circuits in random graphs .",
    "our motivation is at least two - fold .",
    "first , improving our knowledge on circuits in random graphs would certainly have positive fall - out on the understanding of equilibrium properties of models of interacting variables living on these graphs .",
    "for instance , frustration in spin systems emerge from the presence of circuits with odd length .",
    "the number of these circuits is therefore directly related to the amount of glassiness present in the system at low temperature . from the dynamical point of view too , the properties of models of interacting or communicating agents e.g. routers , ... strongly depend on the topological properties of the underlying graph , and particularly upon feedbacks resulting from the presence of circuits .",
    "these `` practical '' incentives , together with purely academic motivations have led to recent studies on the distributions of unicyclic components @xcite and cycles @xcite in random graphs .",
    "secondly , the absence of short circuits in random graphs or , equivalently , the observation that random graphs essentially exhibit a local tree - like structure is crucial to the analytical treatment of spin models on random graphs with some common techniques , e.g. the replica or cavity methods .",
    "these models are characterized by ( realistic ) strong interactions between spins , in contrast to usual mean - field systems , e.g. curie - weiss or sherrington  kirkpatrick models . yet , the absence of short - ranged loops in random graphs make them , around any vertex ( root ) , locally similar to a tree surrounded by a remote bulk . because of that one conjectures that the free - energy of a spin model on a random graph is equal to the one on the tree with self - consistent boundary conditions requiring that appropriate properties ( for example the magnetization for the ising model ) are identical on the leaves and at the root vertex @xcite .",
    "one of the goals of this note is to point out that this procedure _  la _ bethe amounts to make assumptions on the large - scale structure of random graphs , _",
    "i.e. _ on the distribution of long loops .    we will first discuss _ loops _ , and compute their number in the thermodynamic limit by analyzing the partition function of the ising model .",
    "next we will compute the number of circuits by discussing the @xmath5 limit of the @xmath6 ferromagnetic model .",
    "for gathering information about the finite @xmath0 behavior of the number of loops ( or of the loop entropy ) we will use an effective counting algorithm .",
    "we will end this note with a discussion of our findings and of the ( many ) open issues .",
    "in this section , we enumerate long loops in random graphs from the study of associated statistical mechanics models .",
    "we will give our _ ad hoc _ definition of a _ loop _ in the following section .",
    "let us consider for example ising spins @xmath7 on vertices @xmath8 of the graph of figure  [ figtree ] , and ferromagnetic couplings @xmath9 on edges @xmath10 . to calculate the partition function @xmath11 of the ising model at inverse temperature @xmath12 on the graph of figure  [ figtree ]",
    ", we consider the leaves of the uncovered local tree _",
    "i.e. _ vertices at distance @xmath13 from the root ( in figure  [ figtree ] the maximum drawn distance is @xmath14 ) @xcite . at sufficiently large @xmath12 ,",
    "a spontaneous , say , positive magnetization @xmath15 is expected to be present in the bulk . as a result",
    ", the spins attached to the leaves will feel an external field @xmath16 .",
    "integrating these spins out will in turn produce an external field @xmath17 acting on spins at distance @xmath18 from the root , with @xcite @xmath19\\ .\\ ] ] after repeated iterations of this procedure , the field at the root reaches a stationary value , @xmath20 , from which we can derive the magnetization @xmath21 $ ] and the free - energy density @xmath22 the critical inverse temperature is the smallest value of @xmath12 for which @xmath20 is non zero _ i.e. _ @xmath23 .    as is well known , the high temperature expansion of the partition function @xmath24 of the ising model can be written as a sum over closed paths going through each vertex an even number of times and each edge at most once @xcite .",
    "each path is given a weight @xmath25 depending upon its length @xmath4 . in the following",
    "we will refer to such paths as _",
    "loops_. gathering all loops with the same weight _",
    "i.e. _ same length , we obtain @xmath26 where @xmath27 is the number of loops of length @xmath4 that can be drawn on the graph .",
    "it is a sensible assumption that this multiplicity exhibits an exponential growth with the graph size , @xmath28\\ , \\ ] ] where @xmath29 is the intensive length of the loops , and @xmath30 is the entropy of loops having length @xmath29 .",
    "we stress here that @xmath31 corresponds to @xmath32 .",
    "knowledge of the entropy @xmath30 will provide us with information about large - scale loops _",
    "i.e. _ with lengths of the order of @xmath0",
    ". insertion of the above scaling hypothesis for @xmath27 in the partition function @xmath24 , and use of the laplace method yield @xmath33   \\label{g - sig}\\ ] ] in the infinite @xmath0 limit is self - averaging ( as is known and true ) but that also @xmath30 enjoys the same property . ] . in other words ,",
    "the free - energy density @xmath34 is essentially the legendre transform of the loop entropy @xmath35 .",
    ".4 in a2.6 in b + .2 in .2 in    we show in figure  [ figpaire ] our results for the loop entropy .",
    "the entropy departs from @xmath36 with a slope equal to @xmath37 from ( [ g - sig ] ) .",
    "its maximum is reached in @xmath38 , that is , for loops going through half of the edges .",
    "the left part of the entropy curve ( @xmath39 ) is parametrized by inverse temperatures @xmath12 going from @xmath40 ( @xmath41 ",
    "the para / ferro transition takes place when extensive loops start contributing to partition function @xmath24 ) to @xmath42 ( top of the curve  at zero temperature , @xmath24 is dominated by the most numerous paths ) .",
    "the right part of the entropy curve ( @xmath43 ) is obtained when @xmath44 , that is , for inverse temperatures with an imaginary part equal to @xmath45 allowing to transform the hyperbolic tangent of @xmath12 into the cotangent of its real part .",
    "this is done by considering a real @xmath46 , the stationary field @xmath20 for this temperature , and the transformation @xmath47 , @xmath48 .    _",
    "the case of even degree . _ for even @xmath2 @xmath30 is left unchanged under the transformation @xmath49 .",
    "the right part of the entropy curve is thus the mirror symmetric of the left part with respect to @xmath50 ( figure  [ figpaire]a ) .",
    "this results from a duality between long and short extensive loops .",
    "let @xmath51 be the full loop ( all edges occupied , which is allowed for even @xmath2 ) .",
    "then , for any loop @xmath52 with length @xmath53 , @xmath54 ( that is @xmath55 without the edges belonging to @xmath52 ) is a loop with length @xmath56 .",
    "notice that the largest loop is @xmath57 , with length @xmath58 .",
    "_ the case of odd degree .",
    "_ here duality does not hold and there is no simple transformation rule for @xmath29 and @xmath30 .",
    "an explicit calculation gives the entropy curve shown in figure  [ figpaire]b .",
    "the maximal length @xmath59 is reached with an infinite slope , and corresponds to a finite entropy @xmath60 . for odd degrees @xmath2 ,",
    "indeed , loops can not occupy all edges since the number of incoming edges onto each vertex is even .",
    "the longest loops have one free edge per vertex : these act as defects , the positions of which can be chosen with some freedom , giving rise to a finite entropy .",
    "the larger is @xmath2 , the smaller is the ratio @xmath61 : intuitively , the frustration coming from the parity of @xmath2 is less and less important as @xmath2 increases indicate that the replica symmetric solution is correct in this range of ( complex - valued ) temperature @xcite . ] .",
    "the iteration procedure can be applied to calculate the free - energy of other short - range models and then derive the entropies corresponding to large - scale diagrams generated through high temperature expansions .",
    "for instance the ferromagnetic @xmath6 model with @xmath62 gives information on circuits _",
    "i.e _ loops with vertices having degree 2 at most @xcite .",
    "a spin @xmath63 is submitted to two fields @xmath64 conjugated to the magnetization @xmath65 and its squared value limit . ] .",
    "the iteration equations for these fields read @xmath66 inserting the fixed point values for the fields in the expression of the free - energy per spin component , @xmath67   - \\frac{c}{2\\beta } \\ln \\big [ ( 1+h_2)^2 + \\beta h_1 ^ 2 \\big ] \\ , \\ ] ] yields ( for an alternative derivation , see @xcite ) , @xmath68 + \\frac{c}{2\\beta } \\ln \\big [ ( c-1)\\beta\\big ] \\ .\\ ] ] the entropy of circuits , @xmath69 is obtained through @xmath70 $ ] .",
    "results are shown in figure  [ figpaire ] .",
    "the maximal entropy , @xmath71 , is reached in @xmath72 .",
    "the rightmost point , with coordinates @xmath73 corresponds to hamiltonian cycles .",
    "expression ( [ mc ] ) coincides with the output of rigorous calculations @xcite , which shows the exactness of the replica symmetric hypothesis for the @xmath74 model @xcite .",
    "note the similarity of the entropy curves for loops on odd @xmath2-regular graphs and circuits ( figure  [ figpaire ] ) .",
    "in the two cases the slopes at minimal and maximal lengths are respectively finite and infinite , see the discussion above .",
    "let @xmath75 and @xmath27 be in all the rest of this note the number of circuits of length @xmath4 in a random , @xmath2-regular graph . for finite @xmath4 , @xmath27 is asymptotically poisson - distributed when @xmath76 @xcite , @xmath77   = \\frac1{m ! } \\left [   \\frac{\\left(c-1\\right)^l}{2l } \\right]^{m } \\exp\\left\\{-   \\frac{\\left(c-1\\right)^l}{2l } \\right\\}\\ .\\ ] ] the above identity holds indeed for circuit - length @xmath78 .",
    "the expected number of circuits of intensive length @xmath79 is therefore , for @xmath80 , @xmath81 with @xmath82 and @xmath83 .",
    "note that this value of @xmath84 coincides with expression ( [ mc ] ) at the first order in @xmath29 .",
    "to study what happens at finite @xmath0 we have implemented a fast algorithm for finding all circuits in a given graph  @xcite .",
    "it is important that we explicitly _ find _ , not only count , all the circuits so that by our method we can in principle give all interesting characterizations .    in our enumeration",
    "we first generate a random graph and then count the circuits .",
    "we average this outcome over a number of samples .",
    "we describe the algorithm for enumeration in next section .    to generate a fixed connectivity random graph we start by assuming that each site has @xmath2 connections that connect it to @xmath2 different sites : we allow no self - connections and no double edges . at the beginning , all connections are free .",
    "two of the connections are extracted and matched together .",
    "we continue filling them up ( we use a table that we resize at each step to keep the process effective ) till all connections are set or we are stuck because there are two left connections that both belong to the same site or that belong to two sites that are already connected . to be sure not to introduce any systematic bias in this case we just discard the full graph and restart the procedure from scratch .      for enumerating circuits we have implemented and used an algorithm introduced by johnson  @xcite .",
    "the algorithm finds all elementary circuits of a graph .",
    "the computer time needed for this task is bounded by @xmath85 , where @xmath0 is the number of vertices of the graph , @xmath86 the number of edges and @xmath87 the total number of circuits in the graph : indeed one proves that the time used between the output of two consecutive circuits is bound by @xmath88 ( and that this is true also for time elapse before the output of the first circuit and after the output of the last one ) .",
    "the memory needed by the algorithm is bounded by @xmath88 .",
    "let us just sketch the crucial steps of the procedure .",
    "one first orders the vertices in some lexicographic sequence , and labels them with integers ranging from @xmath89 to @xmath90 .",
    "the search is started from a _ root _",
    "vertex @xmath91 , in the subgraph induced by @xmath91 and by vertices after @xmath91 : one of the crucial performance issues is that all vertices that become roots are the smallest vertex in at least one elementary circuit .",
    "the input to the procedure is the adjacency structure @xmath92 for each vertex @xmath93 , that represents the graph : it contains @xmath94 if and only if @xmath95 , where @xmath96 is the set of edges of the graph .",
    "we _ block _ a vertex @xmath93 when it is added to a path beginning in @xmath91 .",
    "we build elementary paths starting from @xmath91 .",
    "the vertices of the current trial paths are loaded on a stack .",
    "a procedure adds the vertex to the path , if appropriate , and appends the vertex to the stack : the vertex is deleted from the stack when returning from this procedure .",
    "the ingenious part of the algorithm is in keeping a vertex _ blocked _ as long as possible , to minimize the execution time .",
    "this has to be done while keeping the procedure correct : the basic rule that has to be satisfied to guarantee that all circuits are found ( only once ) is that if it exists a path from the vertex @xmath93 to @xmath91 that does not intersect the path loaded on the stack , then @xmath93 has to be free ( i.e. it can not be in a _ blocked _ state ) .",
    "one uses a list to keep the information needed to satisfy this constraint while staying time effective .",
    "some details about performances are as follows : on an intel xeon @xmath97 @xmath98 processor our implementation takes of the order of @xmath99 seconds for finding all circuits of a @xmath100 graph ( they are @xmath101 ) , @xmath102 for @xmath103 ( @xmath104 circuits ) and @xmath105 for @xmath106 ( with @xmath107 circuits ) .    in order to test the results of our code",
    "we have also implemented a `` quick and dirty '' backtracking procedure to count hamiltonian circuits .",
    "since our procedure crucially depends on the quality of the random number generator we have also checked that different ( high quality ) random number generators lead to statistically compatible answers .      thanks to our algorithm and implementation",
    "we have been able to enumerate of the order of @xmath108 circuits ( a large number ) .    for small @xmath2 values",
    "we can study larger graphs ( we have analyzed graphs with up to @xmath109 vertices in the @xmath110 case and up to @xmath111 vertices for @xmath112 , and averaged our results over samples ranging from @xmath113 to @xmath114 random graphs ) .",
    "typically we find for example of the order of @xmath115 million circuits on a @xmath116 , @xmath110 graph , one billion circuits on a @xmath117 , @xmath118 graph and @xmath119 billion circuits on a @xmath120 , @xmath112 graph .",
    "for each value of @xmath0 , we average over of the order of @xmath114 samples for all the @xmath110 enumerations , and @xmath113 graphs for @xmath121 .    in figure  [ figallc3 ]",
    "we plot the theoretical results obtained in the ( replica symmetric ) calculation of section 2.2 for @xmath110 , together with results obtained by finite enumeration on finite lattices with @xmath0 vertices .",
    "numerical data from finite graphs are very slowly approaching the theoretical , infinite volume data .",
    "we try in the following to analyze the quality of this asymptotic agreement of the two sets of data .    at first we know that @xmath122 as @xmath123 where @xmath124 is the average number of circuits of length @xmath125 . with our numerical data",
    "we can not work really close to @xmath41 , since for finite @xmath0 we have a value @xmath126 that goes to zero as @xmath127 : finite size effects appear as a flattening of @xmath128 when @xmath29 becomes very close to the minimum allowed value ( see figure [ figallc3 ] ) .",
    "one can easily see by eye that the slope is very similar to the asymptotic slope in the small @xmath29 region where we are relatively safe from finite size effects .",
    "we have fitted a linear behavior ( that is indeed clear in the data ) for example for @xmath29 in the range @xmath129 for @xmath110 .    using this approach we find for @xmath2 from 3 to 6 slopes about @xmath130 smaller than the theoretical prediction ( on the larger graphs we can study ) : for @xmath110 we find @xmath131 versus a theoretical @xmath132 ; for @xmath133 we find @xmath134 versus @xmath135 ; for @xmath118 we find @xmath136 versus @xmath137 ; for @xmath112 we find @xmath138 versus @xmath139 .",
    "finite size effect can be drastically reduced if we compare directly different @xmath2 value ( since we are using graphs of a size that is limited by the same criterion for each @xmath2 value ) .",
    "for example the ratio of the slope of @xmath2 and @xmath140 is @xmath141 for @xmath110 versus a theoretical @xmath142 , @xmath143 versus @xmath144 for @xmath133 and @xmath145 versus @xmath146 for @xmath118 .",
    "this really remarkable agreement gives us confidence that we have a good control over finite size effects .",
    "equation ( [ form ] ) tells us that the difference between the measured circuit entropy @xmath147 and the asymptotic value given by formula ( [ mc ] ) , once multiplied by @xmath0 , behaves as @xmath148 for vanishing small values of @xmath29 , with @xmath149 .",
    "it is therefore independent of @xmath2 , with a logarithmic dependence upon the graph size @xmath0 . to check how equation ( [ mc1 ] ) applies to finite values of @xmath29",
    ", we look first in figure  [ figallcl05 ] at the number of circuits with @xmath150 , for different values of @xmath0 and @xmath2 ( we have harvested our most precise data at @xmath110 ) .",
    "data indeed show only a very weak dependence upon @xmath2 , and this dependence becomes weaker with increasing @xmath2 .",
    "data for @xmath118 are already indistinguishable from the ones for @xmath112 .    in figure  [ figallcl1 ]",
    ", we show the same quantity for @xmath151 _ i.e. _ for hamiltonian circuits , that pass through all vertices of the random graph .",
    "as far as the scaling with @xmath2 is concerned figure  [ figallcl1 ] shows that the scaling of hamiltonian circuits is excellent already at @xmath110 .",
    "we will come back later about the fact that scaling property of hamiltonian circuits turn out to be very different from the ones of all other finite @xmath29 , less dense circuits .    inspired by the result obtained for small circuits ( [ form]),([mc1 ] )",
    "we look for the following fit for the circuit entropy for finite values of @xmath29 , @xmath152 in figure  [ figfit ] we show our results for @xmath110 , @xmath150 .",
    "the quality of the best fit to data with sizes @xmath153 only is excellent , and is very good agreement with all data with @xmath154 .",
    "the two parameter fit is clearly superior to power law fits .",
    "we find that with very good accuracy ( surely better than one percent ) @xmath155 i.e. that even at finite @xmath29 the relation ( [ mc1 ] ) gives the correct leading corrections .",
    "this result tells us that for all @xmath29 values ( maybe excluding @xmath151 , see later ) we have that the average number of circuits of reduced length @xmath29 equals @xmath156 where @xmath157 is a bounded function of @xmath29 . for @xmath158 , we find values close to @xmath159 e.g. @xmath160 in the case of @xmath150 . here",
    "precision is not as good since this is a sub - leading correction .",
    "what is clear from our data is that sub - leading corrections to the circuit entropy are of the order of @xmath161 as encoded in formula ( [ mc2 ] ) .    as we have said above the case of hamiltonian circuits ( @xmath151 )",
    "is exceptional .",
    "finite size transient effects are very strong ; this is intuitively expected since these circuits fill the graph and are deeply affected by its finite size .",
    "we show in figure  [ fignofit ] the analogous of figure  [ figfit ] but for @xmath151 .",
    "it is clear that the structure of finite size effects is completely different . on the contrary",
    "we have already explained that we find exactly the same behavior for all intermediate @xmath29 values : the case @xmath151 appears as isolated .",
    "to sum up , the absence of small loops in random graphs allows one to argue that the free - energy of a spin model defined on the graph is equal to the one on a regular tree with a self - consistent external field at boundary ( leaves ) . in turn , this free - energy fully determines the distribution of large - scale loops in the random graph .",
    "we stress that the whole complexity of this cavity procedure is actually hidden in the assumption of self - consistency for the field(s ) @xcite . assumptions corresponding to broken symmetry in the replica framework",
    "@xcite may be necessary for models with random interactions .",
    "anyhow , the salient feature of the above standard approach is that it predicts global thermodynamical quantities from local considerations about the graph only .",
    "we have added to our exact computation , valid in the @xmath162 limit , results from exact enumeration at finite @xmath0 .",
    "thanks to them we have been able to determine precisely the behavior of the leading corrections to the thermodynamical behavior ( at least for circuits with @xmath163 : we have found that hamiltonian circuits have stronger finite size corrections and a peculiar finite @xmath0 behavior",
    ".    it would be very interesting to characterize properties or quantities that can adequately be described by a local procedure @xcite .",
    "the question is however well beyond the scope of the present paper , which only shows that large loops are ( remarkably ) among those ones .",
    "we are grateful to g. parisi for insights about the validity of replica symmetry for the ising model with complex temperature .",
    "we also thank s. cocco , a. montanari for interesting discussions .",
    "thanks the les houches summer school and the smc - infm center in rome for the hospitality in august and september 2003 respectively .",
    "thanks the `` laboratoire de physique thorique '' of ens in paris for a visiting professorship during may - june 2004 .",
    "wormald _ models of random regular graphs _ in _ surveys in combinatorics _ , edited by j.d .",
    "lamb and d.a .",
    "preece , london mathematical society lecture note series * 276 * pp .",
    "239298 ( cambridge university press , cambridge , uk , 1999 )"
  ],
  "abstract_text": [
    "<S> we compute the number of circuits and of loops with multiple crossings in random regular graphs . </S>",
    "<S> we discuss the importance of this issue for the validity of the cavity approach . on the one side we obtain analytic results for the infinite volume limit in agreement with existing exact results . on the other side </S>",
    "<S> we implement a counting algorithm , enumerate circuits at finite @xmath0 and draw some general conclusions about the finite @xmath0 behavior of the circuits . </S>"
  ]
}