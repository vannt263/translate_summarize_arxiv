{
  "article_text": [
    "the issue of finite - size corrections in quantum - monte - carlo ( qmc ) calculations has recently been attracting considerable attention.@xcite as qmc calculations of solids need to be carried out within a supercell , the coulomb interaction is typically replaced by the so - called ewald interaction that is compatible with the supercell geometry.@xcite this , in turn , is equivalent to dealing with an infinite system with a periodically repeated exchange - correlation ( xc ) hole . in other words",
    ", using the ewald interaction includes the spurious effective interaction of an electron with its periodically repeated xc hole .",
    "one solution to this drawback - the real - space solution - is to use qmc data at length scales smaller than the supercell size where qmc is expected to be accurate and substitute the missing terms implicitly or explicitly .",
    "e.g. , the model periodic coulomb - interaction ( mpc ) method@xcite deals with the periodically repeated xc hole by using the bare coulomb term within the supercell and assuming that beyond the supercell an electron only feels the hartree potential with no further correlations .",
    "this represents a good approximation in a bulk solid , where the xc hole decays rapidly .",
    "in contrast , chiesa _",
    "al._@xcite traced the ewald error back to an integration error and then added back the missing contribution , yielding a momentum - space solution .    in a recent paper,@xcite the spherically - averaged structure factor @xmath0 was introduced in order to analyze and reduce coulomb finite - size effects .",
    "this ( @xmath0 ) represents a natural quantity to study finite size errors : on the one hand , it is a simple one - dimensional function which via integration yields the interaction energy and , on the other hand , it naturally orders the qmc data according to length scale . although qmc can , in principle , model correlations well at short length scales , it is bound to fail at larger scales due to the fact that finite simulation cells must be used .",
    "so far we have only touched on the issue of finite - size corrections for the interaction energy .",
    "the information to evaluate this is contained in the spherical average of the diagonal terms of the two - particle density matrix ( the two particle density ) and hence @xmath0 , which contains the same information , suffices .",
    "however , other quantities may be computed using qmc which also suffer from finite - size errors .",
    "e.g. chiesa _ al._@xcite also deal with corrections to the finite - size errors in the kinetic energy but since the kinetic energy needs information that goes beyond the diagonal terms of the density matrix such an analysis is beyond the scope of this paper which is based solely on the information in @xmath0 .",
    "similarly , finite - size corrections to the momentum distribution@xcite can not readily be done using just @xmath0 .",
    "the aim of this paper is to show that modelling @xmath0 with the mpc ansatz yields a momentum - resolved mpc .",
    "this allows for an intuitive analysis of finite - size errors and for an improvement of mpc whenever mpc fails , such as in surface - like systems .",
    "first of all , in section ii we discuss @xmath0 in the context of qmc and apply the mpc ansatz , thereby showing that via integration over @xmath1 our method exactly maps onto mpc . in section iii ,",
    "we first look at a non - interacting uniform electron gas in order to ( i ) see how mpc breaks down in this case and ( ii ) learn how to overcome the limitation of mpc by using our hybrid analysis .",
    "we also report diffusion monte carlo ( dmc ) calculations of the structure factor of an interacting uniform electron gas , which yields an intuitive understanding of the mpc in interacting systems .",
    "this then leads us to an easy way to understand the existing difficulties that arise in the case of a slab geometry,@xcite and we propose a simple method to address this difficult problem .",
    "we round off the paper with a summary and conclusions .",
    "we use atomic units throughout ( @xmath2 ) .",
    "the interaction energy @xmath3 of an arbitrary system of many interacting electrons can be expressed as follows @xmath4 where @xmath5 represents the hartree energy ( which in the case of an infinite jellium model is exactly cancelled by the presence of the positive background ) @xmath6 and @xmath7 represents the so - called xc interaction energy corresponding to the attractive interaction between each electron and its own xc hole : @xmath8 here , @xmath9 is the electron density and @xmath10 represents the xc - hole density of an electron at @xmath11 . for brevity , we shall also define a _ reduced _ electron density @xmath12 , which represents the electron density at @xmath13 seen by a given electron at @xmath11 in the presence of ( hence , reduced by ) its xc hole : @xmath14 where @xmath15 is the so - called two - particle density.@xcite note that @xmath16 .",
    "the only periodic solution of poisson s equation for a periodic array of charges is the so - called ewald interaction , which is of the coulomb form @xmath17 only in the limit of an infinitely large simulation cell .",
    "however , while the hartree energy is given correctly by this ewald interaction , the part of the electron - electron energy coming from the interaction of electrons with their own xc hole yields a spurious contribution that is due to the interaction of an electron with its periodically repeated xc hole .",
    "this drawback was solved in ref .   by replacing the ewald interaction by a model periodic coulomb interaction that yields an interaction energy consisting of the sum of two terms : the hartree energy @xmath18 calculated with the ewald interaction , and the beyond - hartree xc - energy @xmath7 calculated with a cutoff coulomb interaction using the minimum image convention , i.e. , translating coordinates of electron pairs such that @xmath19 lies within the simulation cell .",
    "hence , the mpc interaction energy @xmath3 is obtained by simply replacing the true _ reduced _ electron density @xmath12 of eq .",
    "( [ reduced ] ) by the mpc _ reduced _ electron density @xmath20 of the form displayed in fig .",
    "1 by the thick solid line marked `` mpc '' .     seen by an electron at @xmath11 , as a function of @xmath21 . in the absence of exchange and correlation",
    ", this would equal the electron density @xmath22 ( thin solid line ) which in the case of a uniform electron gas would be constant . in the presence of exchange and correlation , the true _ reduced _ electron density @xmath12 is of the form represented by the thick line marked `` true '' , which for a supercell geometry ( of linear dimension @xmath23 ) becomes the _ reduced _ ewald density represented by the thick dotted line marked  ewald \" .",
    "the mpc interaction energy @xmath3 is obtained by using a cutoff _ reduced _ electron density ( thick solid line marked `` mpc '' ) that coincides with ( i ) the _ reduced _ ewald electron density within the simulation cell and ( ii ) the electron density @xmath22 beyond the simulation cell.,scaledwidth=48.0% ]      starting with the xc - hole density @xmath10 at @xmath13 around an electron at @xmath11 , one finds the following momentum - resolved form of the xc interaction energy of eq .",
    "( [ eq3]):@xcite @xmath24 where @xmath0 is the spherical average of the diagonal structure factor @xmath25 :  @xcite @xmath26 and @xmath21 .",
    "equation  ( [ eq4 ] ) represents a general expression for the xc interaction energy , which is formally exact not only for homogeneous media but also for an arbitrary inhomogeneous many - electron system .      when performing mc sampling on a function @xmath27 such as the coulomb potential @xmath28 , what we are actually calculating is @xmath29 where the minimum image convention is used . in conjunction with eq .",
    "( [ nxcdef ] ) , this yields the mc sampling of the spherically averaged structure factor of eq .",
    "( [ sf_base_eq ] ) : @xmath30 here @xmath31 being the hartree contribution : @xmath32 where again the minimum image convention is being employed , i.e. , the integrals are carried out over the simulation cell ( sc ) .",
    "the densities @xmath9 here are standard mc electron densities .      if one applies the mpc ansatz in the calculation of the spherically averaged structure factor @xmath0 , by simply assuming ( as in fig .",
    "1 ) that beyond the supercell correlations are only due to variations in the density , then eq .  ( [ eq4 ] )",
    "yields exactly the mpc interaction energy of ref .  .",
    "this can be seen by introducing eq .",
    "( [ sf_base_eq ] ) into eq .",
    "( [ eq4 ] ) and performing the @xmath1 integration .",
    "hence , the momentum - space based method of ref .",
    "reduces , under the mpc ansatz , to what we may call a momentum - resolved mpc .",
    "the mpc ansatz implies a finite extent of the xc hole , which in turn results in a quadratic behavior of @xmath0 as @xmath33 . in the case of finite systems",
    "( e.g. , atoms , molecules , and clusters ) and bulk solids , this quadratic behavior of the structure factor is qualitatively correct because of the short range of the xc hole in those systems .",
    "hence , in those systems , as long as the simulation cell is sufficiently large for the spherically averaged structure factor at the cutoff momentum @xmath34 to already be in or close to the asymptotic low-@xmath1 behavior , the mpc ansatz yields accurate results : since in those systems the true @xmath0 is an essentially quadratic function as @xmath33 , constrained by @xmath35 , and the same constraints hold for @xmath36 , only higher - order terms contribute to any residual error .",
    "there are some caveats , however .",
    "the non - interacting uniform electron gas as well as semi - infinite systems contain a linear contribution to @xmath0 at @xmath33 ( due to the presence of a xc hole that is not negligible even at large distances ) , which causes the failure of the mpc scheme .",
    "nevertheless , in the framework of our momentum - resolved approach there is room for improvement over mpc , since one has flexibility to go beyond the mpc ansatz by replacing the low-@xmath1 structure factor @xmath36 by its known correct value .",
    "the non - interacting ( hartree - fock ) uniform electron gas was dealt with extensively in ref .  . here",
    "we briefly discuss this system , with the aim of now introducing a correction term .",
    "the exact hartree - fock ( hf ) structure factor @xmath0 of a uniform electron gas , which is easily derived analytically,@xcite is shown in fig .",
    "[ f2 ] ( dashed - dotted red line ) together with the result we obtain by using the mpc ansatz ( solid black line ) .",
    "this figure clearly shows that the mpc result is in qualitative error at low @xmath1 , due to the fact that the actual hf structure factor does not exhibit a quadratic behavior in the limit as @xmath33 but a linear behavior instead . our momentum - resolved technique , however , has room for improvement , by going beyond the mpc ansatz .     of a non - interacting ( hartree - fock )",
    "uniform electron gas with an electron - density parameter @xmath37 and 54 electrons in a face - centered - cubic ( fcc ) simulation cell .",
    "the exact hf structure factor @xmath0 is represented by a dashed - dotted red line and the mpc result by a solid black line .",
    "these two curves are also plotted in the inset , but now together with eq .",
    "( [ smod2 ] ) ( nearly atop the exact hf structure factor ) , represented by a blue dotted line , and the modelling of eq .",
    "( [ smod1 ] ) ( nearly atop the mpc hf structure factor ) , represented by a green dashed line .",
    "the difference between the corresponding integrals represents the correction to the mpc hf data .",
    "the vertical line indicates the cutoff @xmath38.,scaledwidth=48.0% ]    beyond a system - size dependent momentum cutoff @xmath38 ( i.e. , at @xmath39 ) , the qmc electron correlation and hence structure factor are expected to be accurate .",
    "the momentum cutoff @xmath38 should be of the order of the inverse of the characteristic length @xmath23 of the supercell . a simple way to model a correction proceeds as follows : after choosing an appropriate cutoff @xmath38 ( vertical line of fig .  [ f2 ] ) , we model the _ corrected _ hf structure factor as a straight line between @xmath35 and @xmath40 and the mpc structure factor as a quadratic curve between the same points .",
    "the correction to mpc is then given by the area between these two curves . the dotted blue line and the dashed green line of fig .  [ f2 ]",
    "illustrate this modelling .",
    "more realistic models are of course feasible .",
    "e.g. , one could take into account derivatives of @xmath0 at @xmath41 or @xmath42 , etc .",
    "hence , as long as we are interested in the xc interaction energy @xmath7 , there is no need to actually evaluate the spherically averaged structure factor for all @xmath1 .",
    "in fact , if we assume that @xmath38 is already in the asymptotic regime one can base the entire correction on the value of @xmath38 and the asymptotic form of the structure factor .",
    "let us assume the mpc structure factor below @xmath38 is of the form @xmath43 while the true functional dependence ( in the asymptotic region ) ought to be @xmath44 @xmath45 coming from the linear term in the hf @xmath0.@xcite at the cutoff , both should of course coincide : @xmath46 as should their derivatives : @xmath47 which yields @xmath48 and @xmath49 .    in this model ,",
    "the _ corrected _ structure factor @xmath0 only differs from the mpc structure factor at momenta between zero and @xmath38 , so the correction in @xmath7 can easily be evaluated using eq .",
    "( [ eq4 ] ) ; it turns out to be : @xmath50 with @xmath51 , we immediately get that the mpc error scales as @xmath52 .",
    "we now also see how limiting the constraint of a finite cutoff when using an mpc like analysis actually is : the quadratic model hf structure factor of eq .",
    "( [ smod1 ] ) ( see the dashed green line of fig .  [ f2 ] ) and the actual mpc hf structure factor ( solid black lines of fig .",
    "[ f2 ] ) are nearly identical and quite different from the exact hf structure factor ( dashed - dotted red line and dotted blue line of fig .",
    "this is despite the model mpc hf structure factor only using the asymptotic quadratic shape and the value of the mpc hf structure factor at the cutoff where it ought to coincide with the exact hf structure factor .    as pointed out above , so far this represents a crude way of devising the finite - size correction to the mpc result .",
    "more complex functional forms can be chosen , by using the structure factor or even its derivatives at @xmath41 or @xmath53 to estimate the corresponding parameters .",
    "analytic integration would then yield a more accurate correction term .      in ref .",
    ", variational monte carlo ( vmc ) calculations of the structure factor @xmath0 and the xc interaction energy @xmath7 of an interacting uniform electron gas were reported . here",
    "we report dmc calculations of these quantities , as obtained by following the hellmann - feynman sampling introduced in ref .  .",
    "of an interacting uniform electron gas of @xmath37 ( in an fcc simulation cell with @xmath54=18 , 54 , 102 , and 178 , @xmath54 being the number of electrons ) , at the mpc level . the thick dotted blue line marked ",
    "asymptotic \" represents the true structure factor of a uniform electron gas at @xmath33 : @xmath55.@xcite the vertical lines represent the cutoff @xmath56 for @xmath54=18 , 54 , 102 , and 178.,scaledwidth=48.0% ]    figure  [ f3 ] exhibits the dmc structure factor @xmath0 of an interacting uniform electron gas of @xmath37 , as obtained by following the mpc _ ansatz _ for various values of @xmath54 ( the number of electrons in the simulation cell ) . as pointed out in ref .  , the _ true _ interacting structure factor @xmath0 is quadratic at @xmath33.@xcite fig .",
    "[ f3 ] shows that our mpc dmc structure factor nicely reproduces this low-@xmath1 limit ( thick dotted blue line marked  asymptotic \" ) .",
    "the mpc dmc structure factor of fig .",
    "[ f3 ] could be improved by using at low wavevectors the structure factor that one can obtain numerically in the random - phase approximation ( rpa ) , which is known to be accurate in the low-@xmath1 regime .",
    "it is well known that in the case of a semi - infinite electron gas the correct behavior of the structure factor @xmath0 at low @xmath1 consists of a linear term accounting for the surface contribution that is augmented by the usual quadratic bulk term . for a finite simulation cell of width @xmath57 and surface area @xmath58 ,",
    "one finds ( in the long - wavelength limit @xmath33):@xcite @xmath59 where now @xmath60 \\label{alpha}\\ ] ] and @xmath61 here , @xmath62 represents the usual bulk term,@xcite and @xmath45 follows from eqs .",
    "( 2.13 ) and ( 3.34 ) of ref .  ,",
    "@xmath63 being the surface - plasmon energy .",
    "as the system gets larger ( @xmath64 ) the relative surface contribution shrinks , as expected . nonetheless , surface energies , which have no contribution from the bulk part of the structure factor , are entirely dominated by the _ linear _",
    "surface - contribution @xmath65 .",
    "the mpc ansatz will never yield the linear term of eq .",
    "( [ linear ] ) . in order to solve this shortcoming",
    ", one can perform a simple analysis similar to the one leading to eq .",
    "( [ hfcorr ] ) , now employing the linear surface term of eq .",
    "( [ alpha ] ) .",
    "this would yield an mpc error that scales as @xmath66 .",
    "however , for this to make sense one needs a well defined cutoff @xmath38 below which the quadratic mpc behavior should be replaced by the correct linear behavior of eq .",
    "( [ linear ] ) and above which the mpc structure factor is essentially exact . nevertheless , in the case of realistic calculations  @xcite of surface energies where the surface area needs to be varied for a fixed slab width and vice versa , finding a well - defined cutoff @xmath38 might not be possible , so that one would need to explore more complex functional forms of the structure factor involving the mpc structure factor itself and possibly its derivatives at one or more values of @xmath1 , such as @xmath42 . in conjunction with the known surface contribution @xmath45 of eq .",
    "( [ alpha ] ) , such schemes could correct significantly the existing mpc surface calculations .",
    "an interesting observation is that any correction to the structure factor implies a correction @xmath67 to the coulomb potential @xmath68 : for @xmath69 , @xmath70 is given by evaluating the kernel @xmath71 entering eq .",
    "( [ sf_base_eq ] ) .",
    "instead , sampling the quantity @xmath72 gives @xmath73 , the finite - size corrected structure factor .",
    "this will differ from @xmath70 only between @xmath41 and @xmath42 ; the fraction in eq .",
    "( [ dker ] ) is therefore well - defined .",
    "but the integral of the kernel , @xmath74 , is precisely the implied coulomb potential @xmath75 . changing the kernel thus changes the implicit coulomb potential : @xmath76 this is a short - range correction in the sense that when performing the mc run @xmath77 is effectively restricted to within the simulation cell . on the other hand ,",
    "the @xmath1 in the integral is smaller than @xmath38 , which is inversely proportional to the simulation - cell size , and so @xmath78 entering the @xmath79 function in eq .",
    "( [ vcor ] ) is generally below @xmath80 .    in the case of the model of eqs .",
    "( [ smod1 ] ) and ( [ smod2 ] ) we get , for example , @xmath81 \\over{-1+\\alpha{2k^2\\over k_f}-\\alpha { k^3\\over k^2_f } } } \\right )   \\sin(ku).\\ ] ] @xmath82 must then also be evaluated using @xmath83 , as it is used in @xmath0 via @xmath84 .",
    "in contrast , @xmath18 continues to be the standard ewald hartree energy .",
    "first of all , we have demonstrated that modelling the spherically averaged structure factor @xmath0 with the mpc ansatz ( momentum - resolved mpc ) yields exactly , after integration , the mpc interaction energy of ref .  .",
    "this allows us to see explicitly that in the case of solids and finite systems mpc improves convergence considerably ( over the more traditional ewald scheme ) , due to the fact that for such systems mpc yields the correct quadratic behavior of @xmath0 as @xmath33 .",
    "we also see explicitly how the mpc ansatz breaks down in the case of the non - interacting uniform electron gas and , in general , in the case of all systems exhibiting a similar pathology , i.e. , an _ extended _ xc hole ( at surfaces , for example ) , where the leading term of @xmath0 at @xmath41 is proportional to @xmath1 .    as the explicit @xmath1 dependence of @xmath0 at low wave vectors",
    "can usually be known , one can look at qmc systems at different length scales separately enabling us to analyze the xc interaction energy at different length scales and to derive a correction term . on integration , this term yields a correction to qmc calculations that are based on the model periodic - coulomb interaction mpc .",
    "100 l. m. fraser , w. m. c. foulkes , g. rajagopal , r. j. needs , s. d. kenny , and a. j. williamson , phys .",
    "b * 53 * , 1814 ( 1996 ) ; a. j. williamson , g. rajagopal , r. j. needs , l. m. fraser , w. m. c foulkes , y. wang , and m .- y.chou , phys .",
    "b * 55 * , r4851 ( 1997 )",
    ". s. chiesa , d. m. ceperley , r. m. martin , and m. holzmann , phys .",
    "lett . * 97 * , 076404 ( 2006 ) .",
    "m. holzmann , b. bernu , c. pierleoni , j. mcminis , d. m. ceperley , v. olevano , and l. delle site , phys .",
    "107 * , 110402 ( 2011 ) ; m. holzmann , b. bernu , v. olevano , r. m. martin , and d. m. ceperley , phys . rev .",
    "b * 79 * , 041308(r ) ( 2009 ) .",
    "r. gaudoin and j. m. pitarke , phys .",
    "b * 75 * , 155105 ( 2007 )",
    ". n. d. drummond , r. j. needs , a. sorouri , w. m. c. foulkes , phys .",
    "b * 78 * , 125106 ( 2008 ) .",
    "w. m. c. foulkes , l. mitas , r. j. needs , and g. rajagopal , rev .",
    "phys . * 73 * , 33 ( 2001 ) .",
    "b. wood , w. m. c. foulkes , m. d. towler , n. d. drummond , j. phys . :",
    "matter * 16 * , 891 ( 2004 ) .",
    "b. wood , n. d. m. hine , w. m. c. foulkes , and p. garcia - gonzalez , phys .",
    "b * 76 * , 035403 ( 2007 ) .",
    "d. pines and p. nozieres , _ the theory of quantum liquids _ ( addison - wesley , reading , ma , 1989 ) .",
    "note that only the spherically averaged xc hole enters here , which is due to the fact that the coulomb interaction is spherically symmetrical and , hence , the angular information of the xc hole drops out even for inhomogeneous systems . using the hf xc - hole ( i.e. , the exact exchange - hole ) density entering eq .",
    "( [ sf_base_eq ] ) in the limit of an infinitely large supercell , and performing the real and reciprocal space integrals , yields @xmath80 at @xmath85 and @xmath86 at @xmath87 , where @xmath88 represents the magnitude of the fermi wavevector .",
    "r. gaudoin and j. m. pitarke , phys . rev",
    "* 99 * , 126406 ( 2007 )",
    ". the true structure factor of a uniform electron gas at @xmath33 is @xmath55 ; here , @xmath89 represents the bulk - plasmon energy , @xmath90 being the electron density .",
    "d. langreth and j. p. perdew , phys . rev .",
    "b * 15 * 2884 ( 1977 ) ."
  ],
  "abstract_text": [
    "<S> extended solids are frequently simulated as finite systems with periodic boundary conditions , which due to the long - range nature of the coulomb interaction may lead to slowly decaying finite - size errors . in the case of quantum - monte - carlo simulations , which are based on real space , both real - space and momentum - space solutions to this problem </S>",
    "<S> exist . here , we describe a hybrid method which using real - space data models the spherically averaged structure factor in momentum space . </S>",
    "<S> we show that ( i ) by integration our hybrid method exactly maps onto the real - space model periodic coulomb - interaction ( mpc ) method and ( ii ) therefore our method combines the best of both worlds ( real - space and momentum - space ) . </S>",
    "<S> one can use known momentum - resolved behavior to improve convergence where mpc fails ( e.g. , at surface - like systems ) . </S>",
    "<S> in contrast to pure momentum - space methods , our method only deals with a simple single - valued function and , hence , better lends itself to interpolation with exact small - momentum data as no directional information is needed . by virtue of integration </S>",
    "<S> , the resulting finite - size corrections can be written as an addition to mpc . </S>"
  ]
}