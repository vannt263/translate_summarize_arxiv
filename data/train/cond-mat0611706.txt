{
  "article_text": [
    "a flow chart illustrating how we use a series of magnetic field images to reconstruct current density and electric field in the sample , and finally power input.,height=432 ]    developing high - temperature superconducting films to carry high current densities with low dissipation has proved to be an enormous challenge , resulting in composite materials that are inhomogeneous down to the atomic scale.@xcite for characterizing inhomogeneous current flow , magnetic imaging has emerged as an important tool . by measuring the magnetic field in a plane above a film s surface , one can invert the biot - savart law to reconstruct a two - dimensional map of current density , @xmath6 , in the film , as described in section  [ j_method].@xcite such a measurement can be obtained by various methods including magneto - optical imaging,@xcite ,",
    "scanning hall probe microscopy@xcite , and scanning superconducting quantum interference device ( squid ) microscopy.@xcite    other imaging techniques , such as scanning potentiometry,@xcite scanning laser microscopy,@xcite and scanning electron microscopy@xcite can map out the electric field , @xmath7 , that arises from vortex movement or other changes in local supercurrent density . in these techniques , to generate measurable electric fields , the superconductor is biased with a current @xmath8 slightly greater than the dc critical current @xmath9at which vortices start to flow . in principle , such measurements could be combined with magnetic imaging of the same sample , and together , @xmath6 and @xmath7 would provide a complete , spatially - resolved electrical characterization of the material , including the local critical current density @xmath10 , and the local power input , which can be calculated as @xmath11 .    in this work , we demonstrate that for @xmath12 , time - resolved magnetic imaging can simultaneously determine both @xmath6 and @xmath7 in a superconducting film .",
    "figure  [ fig : flow ] summarizes the operations involved .",
    "the instantaneous magnetic field @xmath13 determines @xmath6 , while the time rate of change of @xmath13 is related to @xmath7 through faraday s law , @xmath14 this relation only constrains the inductive portion of electric field , @xmath15 . to reconstruct the remaining electrostatic part , @xmath16",
    ", we must impose the additional restrictions that @xmath12 , as discussed in section  [ e ] , and that @xmath7 is parallel to @xmath6 , discussed in section  [ ep ] . however , many important applications that are not accessible to techniques operating above @xmath9do lie within these restrictions , such as ac losses in superconducting films .",
    "faraday s law has been applied previously to derive ac loss from a critical state model of magnetic fields in a homogeneous , infinitely long superconducting wire.@xcite in the present work , this method is reformulated to allow for the inhomogeneity of a real conductor revealed by our magnetic images .",
    "the method also applies to the case of magnetization decay due to flux creep , which was recently analyzed using magneto - optic images.@xcite    here , we use a cryogenic scanning hall probe microscope ( shpm ) to obtain a series of images of @xmath17 , the component of magnetic field perpendicular to the sample surface , as it evolves with time .",
    "the microscope is described in ref .   and",
    "further information is given in section  [ apparatus ] .    to analyze ac losses ,",
    "we image a strip of the high - temperature superconductor yba@xmath2cu@xmath3o@xmath4 ( ybco ) , described in section  [ sample ] .",
    "we apply an ac current to the strip at 400  hz , a typical operating frequency for applications,@xcite and must image the magnetic response faster than this .",
    "our scan speed  a few pixels per second  is slow in comparison , so instead of acquiring an entire sequence of images within one cycle of applied current , we obtain an average response over many cycles , as explained in section  [ daq ] , with 25  @xmath5s time resolution .",
    "section  [ b ] presents this time series of magnetic images , which are then transformed into images of current and electric field in sections  [ j ] and [ e ] .",
    "these quantities are combined in sections  [ power ] and [ ej ] to yield maps of dissipation and superconducting characteristics .",
    "the apparatus is described in ref .  ,",
    "but essential experimental details and notable modifications are included here .",
    "the instrument generates magnetic images by rastering a hall sensor above the sample surface , measuring magnetic field at each pixel .",
    "the sensor s hall resistance is approximately proportional to @xmath17 , the component of magnetic field perpendicular to the sample surface , with a field resolution of @xmath18  g/@xmath19 .",
    "the scanning stage , based on stepper motors driving micrometers , offers a @xmath20  cm scan area for aligning to samples and macroscopic features , and can zoom in for 200  nm positioning resolution .",
    "however , the image resolution is limited by the sensor : first , its lithographic size leads to averaging of the field over 500  nm .",
    "second , though its tip remains in contact with the sample during scanning , the sensor s slight tilt lifts the sensitive area 1  @xmath5 m above the sample surface .",
    "these factors yield 1  @xmath5 m spatial resolution .",
    "the sensitive area is coated with a grounded gold gate to screen electric fields , followed by an insulating aluminum oxide layer to isolate the gate from sample voltages.@xcite the oxide is also intended to provide protection against mechanical wear .",
    "the ybco film studied is 180  nm thick , grown epitaxially by pulsed laser deposition ( pld ) on a srtio@xmath3 [ 001 ] substrate .",
    "photolithographic patterning followed by argon ion milling removes parts of the film , leaving a bridge as shown in fig .",
    "[ bjep](a ) .",
    "the substrate is held in vacuum , attached to the microscope s copper coldfinger by a thin layer of low - temperature varnish .",
    "the coldfinger is cooled by a continuous flow of liquid helium .",
    "the film s @xmath21(defined by the maximum in @xmath22 ) is measured in this cryostat to be 90  k. for imaging , the film s coldfinger is held at 40  k while the hall sensor is held at 54  k. however , the current return lead ( to the right of the segment imaged ) is narrower than the bridge ( 32  @xmath5 m versus 50  @xmath5 m ) , and a magnetic scan ( not shown ) indicates that the applied current of 0.75  arms exceeds its critical current .",
    "the consequent dissipation in the return lead may heat the sample several degrees above 40  k.      the images shown in fig .",
    "[ bjep](c)(j ) are all derived from one scan as described in ref .  .",
    "a 402.7  hz ac current is applied continuously to the sample .",
    "the sensor rasters over a 100 by 150  @xmath5 m area with 0.5  @xmath5 m pixel spacing .",
    "it pauses at each pixel and records the waveforms @xmath23 and @xmath24 for approximately 80 cycles of applied current .",
    "these cycles are overlaid and averaged .",
    "values from the averaged waveforms are collated into images by their phase within the cycle .",
    "the complete set of images is presented as the movie ` bje.avi ` in the supplemental material.@xcite the images correspond to 100 time slices over the cycle of applied current , each representing the average magnetic field over a 25  @xmath5s interval .",
    "( color online ) cross sections of the data in fig .",
    "the sections are taken along the @xmath25 axis at the location of the dashed yellow line in fig .",
    "[ bjep](c ) .",
    "the vertical dashed green lines mark the boundary between data and background fit .",
    "successive frames in the current cycle are overlaid ; their colors and labels match the frame labels in fig .",
    "[ bjep].,width=325 ]    this work is primarily concerned with deriving quantities of interest from time - resolved magnetic images , but it is worth first examining the images directly . from them , we extract a great deal of qualitative information that shapes the assumptions under which further quantities are derived .",
    "figure  [ bjep](c)(j ) are selected from a larger set of frames , and represent one half - cycle of ac applied current .",
    "initially , the maximum current @xmath8=1.07 a is applied and flux has penetrated , somewhat inhomogeneously , into both edges of the strip .",
    "@xmath8 is apparently below the critical current , @xmath26 , as a central flux - free region separates the two flux fronts .",
    "this condition is necessary for our calculation of electric field , as explained in section  [ e ] .    by ( f ) ,",
    "the applied current is reduced to zero , and vortices remain trapped in the edge regions .",
    "flux of the opposite sign starts to enter at the edges .",
    "we then see this opposite flux erase and replace the trapped flux as negative current is applied .",
    "the succeeding half of the cycle approximately repeats the @xmath27 , @xmath0 , and @xmath1 configurations shown , but with opposite signs .",
    "the boundary of the data is shown as a dashed green box in ( c ) .",
    "the surrounding background is calculated with a critical state model for a thin superconducting strip.@xcite the main purpose of this background is to better match the boundaries of the image for the fourier transformations described in section  [ j_method ] .",
    "the good agreement between the model and the data also shows that much of the strip s response can be ascribed to critical state behavior , though deviations , such as spatial inhomogeneity in pinning strength , are evident .",
    "the model is fit to the entire set of frames at once .",
    "the free parameters are the height of the sensor above the sample plane , 1.2  @xmath5 m , the sensor tilt , 3@xmath28about the @xmath29 axis , the strip s critical current , 1.13  a , the hall coefficient , 0.10  @xmath30/g , and the amplitude , 7.2  oe  rms , of an applied field proportional to the applied current , explained below .",
    "the hall coefficient s fit value is consistent with the calibrated value of 0.11  @xmath30/g .",
    "the @xmath25 position and tilt of the strip about the @xmath31 axis are also allowed to vary , and the tilt is zeroed by rotating the image .",
    "these parameters are constrained to be constant over time ; the only change in the calculation from frame to frame is the ( known ) applied current .    adding the small , uniform applied field that varies with the applied current improves the fit , and is suggested by the sample geometry in fig .",
    "[ bjep](a ) , where the current returns to the right and below the bridge .",
    "positive returning current generates a negative field at the section of bridge imaged , which accords with the sign of the field added to the calculation .",
    "furthermore , the vertical segment of the return lead should add a negative @xmath32 , which is not accounted for by the calculation , and which does explain why the disparity between the data and the calculation is largest toward the lower right corner of the boundary .",
    "the biot - savart law describes the magnetic field @xmath13 generated by a current distribution @xmath6 , @xmath33 several authors have tackled the problem of inverting this relation to obtain a planar current distribution @xmath34 from a planar magnetic measurement @xmath35.@xcite we tried two of these existing methods : regularization@xcite and conjugate - gradient.@xcite the conjugate - gradient method produces current distributions dominated by unphysical artifacts .",
    "further testing with simulated data suggests that this occurs when the current distribution extends outside the image boundaries , as in our images , which encompass only a section of the superconducting strip .",
    "we met with greater success using the regularization method with generalized cross - validation ( gcv ) , described in detail in ref .   and summarized here . taking the @xmath31 component of eq .",
    "[ biot - savart ] and fourier transforming in @xmath29 and @xmath25 , we find an algebraic relation between the fourier transformed quantities @xmath36 , @xmath37 , and @xmath38 : @xmath39 we assume that @xmath40 , current flowing perpendicular to the plane of the film , is insignificant .",
    "we also ignore any @xmath31 dependence of the in - plane components of current , approximately solving for the current density averaged over the film thickness .",
    "these are reasonable approximations in our film s geometry ; its thickness , 180  nm , is smaller than its effective london penetration depth , @xmath41  nm.@xcite the specific kernel that we use to relate @xmath42 and @xmath43 to @xmath17 is that of a film of 180  nm thickness.@xcite    we now reduce @xmath42 and @xmath43 to a single unknown by noting that @xmath6 must be nearly divergence - free at the operating frequency of 400  hz ( the resonant frequency , @xmath44 , of a piece of strip like that imaged would be @xmath45  ghz ) .",
    "this allows us to derive both @xmath42 and @xmath43 from the local magnetization @xmath46,@xcite where @xmath47 in fourier space , @xmath48 eqs .",
    "[ bj_eq ] and [ gj_eq ] yield @xmath49 thus our basic procedure is to fourier transform @xmath17 , solve for @xmath50 , fourier transform back to the real space @xmath46 , and use eq .",
    "[ jg_eq ] to obtain @xmath42 and @xmath43 .",
    "the first difficulty arises from the factor @xmath51 in eq .",
    "[ gb_eq ] .",
    "spurious high spatial frequencies ( with wavelength greater than @xmath31 , the measurement height ) in the magnetic data are exponentially amplified in the inverted current .",
    "while scanning hall probe microscopy enjoys lower noise and smaller @xmath31 than magneto - optical imaging,@xcite noise in our images can still dominate the reconstructed @xmath0 .",
    "the method of regularization compensates by suppressing high frequencies ( smoothing ) , and gcv determines an optimal amount of regularization from the data itself . in practice , we used gcv as a guide to choose a regularization parameter ( @xmath52 as described in ref .  )",
    "that we held fixed across the set of frames .",
    "similarly , differentiating @xmath53 to find the components of @xmath0 amplifies high - frequency noise , so we use savitsky - golay smoothing to extract the derivatives .",
    "the smoothing is quadratic with a frame size of 2.5  @xmath5 m ( 5 pixels ) .",
    "the second difficulty is that the fourier transform of @xmath27 assumes periodicity in the vertical and horizontal directions , and mismatches between the left and right , and top and bottom boundaries of the @xmath27 image lead to artifacts dominating the image once it has been transformed , manipulated , and transformed back .",
    "a common solution is to window the data , bringing its boundaries smoothly to zero .",
    "this discards a large portion of each image , however .    instead",
    ", we rotate the original data ( 2.3@xmath28 about the @xmath31 axis ) so that the bridge runs horizontally , then center it on a larger area ( a square 256 @xmath5 m on a side ) in order to move the edge effects away from the data .",
    "we fill in the background with a calculated @xmath27 as described in section  [ b ] . only after calculating @xmath6 and @xmath15 ( described in section  [ ei ] )",
    "do we crop the images back to the original dimensions ( plus the margin seen in fig .",
    "[ bjep](c ) ) . finally , before fourier transforming",
    ", we mirror the images top - to - bottom in order to better match the top and bottom edges without going to the much larger area necessary to allow the field to die off , which would be more computationally cumbersome .",
    "while these preparations remove artifacts associated with edge mismatch , we do observe a spurious bump in the reconstructed current at the boundary between data and fit , seen clearly in the cross section of @xmath42 in fig .",
    "[ fig : cut ] .",
    "however , this artifact is about ten times smaller than our signal , and appears to be confined to the boundary .",
    "the results largely agree with our expectations for a superconducting strip .",
    "the reconstructed current flows within the strip approximately in the @xmath29 direction . at the maximum applied current ( fig .",
    "[ bjep](c ) ) , the current density @xmath54 in the edge regions of flux penetration should equal the critical current density , according to the critical state model .",
    "@xmath0 then dips down ( but is not zero ) in the vortex - free central region , as expected from the demagnetization effect of the strip geometry.@xcite this separation into edge and central regions is clearest in the cross section of @xmath42 , fig .",
    "[ fig : cut](c ) .",
    "@xmath0 averaged over the edge regions is 12 ma/@xmath55 , which accords with macroscopic transport measurements of @xmath10on a similar film ( 9 ma/@xmath55 at 44  k).@xcite we expect transport , which is sensitive to the weakest point in a superconductor , to yield a lower value than the spatially averaged @xmath10 .",
    "the cross section of @xmath42 also shows more current on the @xmath56 side , indicative of the applied field ( described in section  [ b ] ) modifying the symmetric distribution one would expect for an applied current .",
    "while the cross sections vary along the length of the strip , this asymmetry is typical .",
    "@xmath43 , plotted on the same color scale as @xmath42 , is smaller , but highlights where the current reroutes around apparent weak spots in the film .",
    "spots producing the largest @xmath43 are marked with arrows in fig .",
    "[ bjep](i ) .",
    "these features in @xmath43 correspond to bumps in the streamlines overlaid on @xmath42 where the current spreads around these defects . in the following sections , we show that these are also spots of high electric field and dissipation .",
    "we relate electric field to the magnetic field we measure via faraday s law , @xmath14 taking the @xmath31 component , @xmath57 this only defines @xmath7 up to the gradient of a scalar .",
    "we therefore use the helmholtz decomposition to separate the electric field into a divergence - free inductive portion , @xmath15 , and a curl - free electrostatic portion , @xmath16 ( following the notation of ref .  ) , @xmath58    @xmath59 where @xmath60 is a scalar potential and @xmath61 , the charge density .",
    "our measurements determine @xmath15 through eq .",
    "[ ecurl ] , but do not determine @xmath16 without further constraints , as described in section  [ ep ] .    to illustrate : if we apply a dc current @xmath62 to our strip , flux flow or other resistive behavior generates an @xmath16 , but we would see little time variation of the magnetic field when averaging over length scales greater than the intervortex spacing .",
    "in contrast , for @xmath12 , the voltage and electric field ( both @xmath15 and @xmath16 ) are zero in the steady state .",
    "we therefore remain below @xmath9of our superconducting strip in order to minimize unmeasurable portions of @xmath16 .",
    "furthermore , below @xmath9 , even in a dynamic state , @xmath16 remains zero for a strip that is uniform in @xmath29 with no hall effect . in this case",
    ", symmetry dictates that @xmath63 , @xmath64 , and @xmath65 , thus @xmath66 .",
    "then @xmath16 is uniform , and zero below @xmath9 .",
    "thus all of the behavior we expect from a model strip will be contained in @xmath15 .      to reconstruct the divergence - free @xmath15",
    ", we proceed as for @xmath6 , solving for a potential function @xmath67 where @xmath68 in which case eq .",
    "[ ecurl ] becomes a poisson equation for @xmath67 : @xmath69    we are interested in the electric field in the sample plane ( @xmath70 ) rather than the measurement plane . we therefore need @xmath71 , which we obtain from the current distribution via the biot - savart law .",
    "@xmath17 at any height is easily computed by rearranging eq .",
    "[ gb_eq ] to obtain @xmath36 in terms of @xmath50 , the magnetization function from which @xmath6 is derived : @xmath72    it is also easiest to solve the poisson equation in fourier space , where eq .  [ poisson ] becomes @xmath73 and , combining eqs .",
    "[ bg_eq ] and [ poisson_fft_eq ] , @xmath74    to approximate the time derivative of @xmath50 , we compute twice the final number of frames ( 200 frames spaced by 12.5  @xmath5s , but each still averages a 25  @xmath5s interval ) and take the differences between successive even frames",
    ". we can then calculate simultaneous electric field and current at the times of the odd frames .",
    "once we have solved for @xmath75 and transformed back to real space , we use savitsky - golay smoothing , as with @xmath0 , to extract the partial derivatives corresponding to @xmath76 and @xmath77 .",
    "finally , eq .  [ ecurl ] only defines @xmath76 and @xmath77 up to constants . setting the constants",
    "is equivalent to finding a field - free point , to which norris devoted much care.@xcite we set the zeros based on the edges of the uncropped images , as far from inhomogeneities in the data as possible . for the @xmath76 zero we use the mean of the two pixels at the vertical center of the strip ( where we expect no @xmath1 , as norris pointed out ) on the left and right edges .",
    "we set the @xmath77 zero to the mean of the four corners .",
    "this mean is zero for an ideal strip , and minimally affected by fields originating toward the center of the image .",
    "as the applied current decreases over the half cycle shown , @xmath76 remains approximately zero ( white ) in a central region of the strip .",
    "outside of this region it becomes negative ( blue ) , continuing past the strip edges .",
    "this is also visible in the cross sections of @xmath76 in fig .",
    "[ fig : cut ] .",
    "this behavior accords with our expectations for vortices moving into the edges of the film",
    ". the central region shrinks , tracking the flux front as vortices enter .",
    "although vortices and current from the previous half cycle are present inside the central region , the vortices remain pinned and therefore do not generate an electric field .",
    "the central region is not completely field - free , however .",
    "interestingly , the field it does display  about 10 times smaller than the edge fields  is maximal and opposite to the current when @xmath78 , a point where our critical state model would dictate @xmath79 .",
    "such a field would arise , though , from a relaxation of @xmath10 , i.e. flux creep in which the vortices continue to move into the strip even as the current momentarily stops ramping .",
    "it leads to a ( temporary ) negative power input to the film , discussed in section  [ power ] .    such movement while @xmath78 is also visible in the full set of magnetic images .",
    "while the magnetic field evidence alone is subject to errors in phase relative to the applied current , the electric field confirms that the relaxation is real .",
    "such relaxation is the focus of ref .  .",
    "finally , the cross sections of @xmath76 reveal an unexpected negative tilt , @xmath80 , both in the central and outer regions , which is an error that arises from the tilt of the hall sensor , as shown in section  [ err ] .",
    "we established in section  [ e ] that for a uniform superconducting strip with no hall effect below @xmath9 , @xmath81 , even with an ac current .",
    "indeed , the @xmath15 that we observe contains all the features we expect from a uniform strip , as discussed in section  [ ei_discussion ] .",
    "our images , however , also reveal inhomogeneity , which could produce a non - zero @xmath16 .    here",
    "we show that in spite of this inhomogeneity , we expect the total electric field @xmath7 to remain approximately parallel to @xmath6 locally , which proves sufficient to reconstruct @xmath16 as the field that compensates for any component of @xmath15 perpendicular to @xmath6 .",
    "our method is inspired by ref .  , but we do not make the additional and incorrect assumption that the component of @xmath16 parallel to @xmath6 is zero.@xcite we also describe a rather different route to @xmath7 and @xmath16 in section  [ curlej ] .",
    "first we must justify that in our experiment , @xmath7 is parallel to @xmath6 , emphasizing that this will not be true for all materials .",
    "for example , a material can have an intrinsic hall effect .",
    "however , macroscopic transport measurements indicate that for ybco in the superconducting state , the hall effect is insignificant ; the component of @xmath7 perpendicular to @xmath6 is at most 1000 times smaller than the parallel component.@xcite    another violation of @xmath82 could arise from a feature such as a grain boundary , whose orientation prevents vortices from moving perpendicular to @xmath6 .",
    "more generally , any gradient in superfluid condensate energy density will exert a force on vortices .",
    "we show here , however , that at least on lengths scales greater than the image resolution of 1  @xmath5 m , we can rule out the presence of gradients strong enough to compete with the pinning forces that occur on the scale of the coherence length , @xmath83  nm . we put an upper bound on such a gradient in our material by assuming that the gradients in pinning strength that we observe stem entirely from changes in condensate energy density .",
    "we take @xmath0 ( the magnitude of the current density ) at maximum applied current as a map of @xmath10near the edges of the strip ( as discussed in section  [ j_discussion ] ) .",
    "the magnitude of the pinning force per length for a single vortex is @xmath84 from which we estimate the depth of the vortex pinning potential as @xmath85 .",
    "the line energy of the vortex will be @xmath86 , from the ratio of the calculated depairing current to the measured @xmath10.@xcite thus the gradient of @xmath87 yields a gradient of line energy , i.e. a force @xmath88 , whose magnitude we compare to @xmath87 .",
    "we find that @xmath89 averages 2000 over the edge regions of the strip with a minimum of 200 .",
    "this analysis suggests that in our material , the lorentz force from the current at @xmath10 , along with pinning forces , dominate other forces felt by vortices , so that vortices move perpendicular to @xmath6 and generate @xmath7 parallel to @xmath6 .",
    "however , we do not claim to rule out every possible materials effect , e.g. effects that average out below our resolution of 1  @xmath5 m .          starting with @xmath15 and @xmath6 , reconstructed in sections  [ ei ] and [ j ] , and the constraint that @xmath90 is parallel to @xmath6",
    ", we can solve for @xmath16 .",
    "the component of @xmath16 perpendicular to @xmath6 must cancel that of @xmath15 : @xmath91 where @xmath92 is calculated by subtracting from @xmath93 its projection onto @xmath6 .",
    "having obtained @xmath94 , we construct @xmath95 , the component of @xmath16 parallel to @xmath6 , to satisfy @xmath96 which follows from the definition of @xmath16 . the @xmath31 component of eq .",
    "[ curlep_eq ] tells us that at each point , @xmath97 or more explicitly , @xmath98 which is a linear , first - order partial differential equation for @xmath99 .",
    "we tried two approaches to solving this equation for @xmath95 . in the first ,",
    "we start with a trial solution , @xmath100 , composed of the known @xmath94 and @xmath101 .",
    "we calculate its curl @xmath102 , which will be zero for the true @xmath16 . from the curl ,",
    "we reconstruct a divergence - free field @xmath103 following the same procedure we used to reconstruct @xmath15 from @xmath17 , described in section  [ ei ] .",
    "the reconstruction preserves @xmath104 , so @xmath105 is curl - free , as desired .",
    "however , @xmath106 does not preserve @xmath94 .",
    "so we construct a new trial @xmath100 consisting of the components @xmath107 and @xmath94 , and iterate .",
    "the true @xmath16 would remain unchanged by such a procedure . in practice , however , we found that the procedure misconverged to an @xmath100 with larger curl than the initial trial .",
    "we therefore attempted a more direct integration of eq .",
    "[ curlep ] : @xmath108 where the integral is taken along a path @xmath109 that remains perpendicular to @xmath6 at each point along its length , and starts at some @xmath110 such that @xmath111 .",
    "the result , constructed from many such paths , is shown in fig .",
    "[ ep_fig ] .",
    "the initial data ( @xmath6 and @xmath15 ) is taken from frame h in fig .",
    "[ bjep ] , then cropped to the area of the strip . for starting points , we set @xmath111 along the horizontal line shown in fig .",
    "[ ep_fig](d ) . in practice , to ensure coverage of every pixel , we start a path at each pixel and work back to the zero line . for efficiency , we skip pixels that have been covered by previous paths .",
    "@xmath94 , shown in fig .",
    "[ ep_fig](a)(b ) , represents the starting data from which we calculate @xmath112 .",
    "integration gives us @xmath95 , which we add ( as vector components ) to @xmath94 to obtain ( d)(e ) .",
    "the method is far from perfect , as evinced by the non - zero @xmath113 in ( f ) .",
    "however , in comparison to ( c ) , the curl is suppressed at all but the highest points .",
    "this is clear in the cross sections through ( c ) and ( f ) shown in ( i ) .",
    "so the result of the procedure , ( d)(e ) , is closer to , but still short of , the true , curl - free @xmath16 .",
    "finally , we note that this method gives us no information about @xmath16 outside the sample , where @xmath114 . however , outside the strip the charge density @xmath115 .",
    "then @xmath116 where @xmath60 obeys laplace s equation , @xmath117 , with a neumann boundary condition given by @xmath16 in the strip .",
    "figure  [ p_fig](c)(j ) shows the total electric field , @xmath118 , for the set of frames from fig .",
    "the complete set of frames is assembled into the movie ` ep.avi ` in the supplemental material.@xcite our sample clearly deviates from a uniform strip , in which @xmath119 .",
    "@xmath16 is comparable in magnitude to @xmath15 , but much more inhomogeneous , contributing most at the spots identified by arrows in fig .",
    "[ bjep](i ) as weak points of the superconductor .",
    "thus we demonstrate reconstruction of the total electric field from our time - resolved magnetic images .",
    "we reiterate that this analysis is restricted to materials in which @xmath7 is parallel to @xmath6 , and in which we can identify a field - free kernel .",
    "armed with @xmath6 and @xmath7 , we calculate @xmath120 , the local power input to the film , resolved in time and space . the results are shown in the third row of fig .",
    "[ p_fig ] .",
    "the largest features are the positive edge regions where vortices move in as the current sweeps .",
    "we note that the instantaneous power shown arises from both dissipation and reactance . these are not easily separated ( e.g. by the relative phase of @xmath0 and @xmath1 ) because of the nonlinear relationship between @xmath0 and @xmath1 .",
    "we can relate our local measurements to macroscopic transport measurements by integrating over space , shown in fig .",
    "[ p_fig](k ) .",
    "each frame of the 50-frame set covering the central portion of the current cycle is summed and normalized by the length of strip imaged to obtain power per unit length , then plotted at its time within the cycle of applied current .",
    "these points are repeated in the first and fourth quarters of the cycle ( in which @xmath0 and @xmath1 repeat with opposite signs ) .",
    "we note that when integrating over the entire sample ( which we only do imperfectly by integrating over the image area ) , we expect no contribution to the power from the electrostatic field , @xmath16 , which , exerting a conservative force , can not do work . indeed , dropping @xmath16 from the calculation shown in ( k ) does not change the result significantly .",
    "the power input rises as the magnitude of current increases , but then falls back to become negative as the current reaches its peak .",
    "an inductive response with zero resistance would be zero at the peak . instead , as discussed in section  [ ei_discussion ] , this negative contribution ( @xmath1 opposite @xmath0 ) arises from relaxation of @xmath10 .",
    "as the applied current decreases back to zero , we do not recover much power , as we would in a dissipation - free inductor , because the vortex movement is irreversible  the vortices remain pinned .    when integrating over time , any inductive contributions to the instantaneous power input cancel , leaving the sum of dissipation over one cycle , shown in fig .",
    "[ p_fig](m ) . as in the instantaneous power ,",
    "the edge contributions dominate . integrating this image over space , or equivalently integrating the power in ( k ) over time",
    ", we obtain the energy dissipation per length of conductor , @xmath121  j / cm / cycle . for comparison , a calculation from the critical state model using the applied @xmath8 ( 1.07  a peak ) and fit value of @xmath9(1.13  a ) yields @xmath122  j / cm / cycle.@xcite factors in the lower measured value may include suppression of high spatial frequencies in the reconstructed quantities due to regularization ( see section  [ j_method ] ) and cropping of the image , which may exclude some pixels near the edges of the strip .",
    "this energy dissipation translates to an average power of @xmath123  w / cm , which , given the applied sample current of 0.75  arms , implies a voltage of 6.9  nvrms between the voltage taps , which are spaced by 260  @xmath5 m .",
    "we have not attempted to verify the presence of this small but perhaps measurable voltage .",
    "( color online ) @xmath1 , the magnitude of the projection of the total electric field onto @xmath6 , is plotted against the magnitude of @xmath6 .",
    "values for one column of pixels are overlaid .",
    "the color of a set of points indicates its position on the bridge within the column of colored pixels in the inset , which is an image of the magnitude of @xmath0 at maximum applied current .",
    "the values for one pixel are highlighted in black and the pixel location is marked in the inset.,width=325 ]    ( a ) the magnitude of @xmath0 at maximum applied current compared to @xmath124 extracted from @xmath1@xmath0 curves for various electric field criteria @xmath125 , shown in ( b)(d ) .",
    "all are on the same color scale , shown in ( b ) .",
    "pixels that did not reach @xmath125 are white . though ( b)(d ) show more scatter , areas of low @xmath124 generally match those of low @xmath0 in ( a).,width=240 ]    over the cycle of applied current , each location in the film experiences a range of current densities and electric field strengths . by plotting @xmath1 against @xmath0 for each pixel , we obtain a local characterization of the material . for example , the @xmath1@xmath0 curve has often been used to test models of the flux pinning mechanism.@xcite    figure  [ fig : ej ] shows @xmath1@xmath0 curves for one column of pixels at the locations indicated in the inset .",
    "one curve is highlighted , illustrating a plausible @xmath1@xmath0 relation for a superconducting film . while the points at low @xmath0 display several @xmath5v / cm of scatter , there is a clear upturn at @xmath126  ma/@xmath55 .",
    "this value is consistent with the 12  ma/@xmath55 we observe in the edge regions of the strip at maximum applied current , and with 9  ma/@xmath55 from transport measurements of a similar film at 44  k , as discussed in section  [ j_discussion].@xcite however , as in section  [ power ] , we caution that the electric field we measure arises from both dissipation and reactance , and in comparing our data with a purely dissipative dc @xmath1@xmath0 curve , we ignore reactance .",
    "although many of the curves seem reasonable , they deviate significantly between pixels , with upturns at current densities ranging from 14 to 2  ma/@xmath55 .",
    "these deviations are mapped out in fig .",
    "[ jc ] for various electric field criteria , @xmath125 .",
    "the value of each pixel is the lowest @xmath0 for which @xmath125 is exceeded .",
    "if @xmath125 is not exceeded , the pixel is plotted as white .",
    "if we use fig .",
    "[ jc](a ) , which shows @xmath0 at maximum applied current , as an estimate of @xmath10 , it seems that many of the curves hit @xmath125 at erroneously low @xmath0 .",
    "however , the spatial variation at least partially reflects genuine inhomogeneity of the material , because the points of low @xmath124 along the edges of ( b)(d ) correlate with low points in ( a ) .",
    "throughout the paper we have tried to point out physical assumptions and where they may break down .",
    "even if our assumptions hold , however , the reconstruction procedure can introduce errors and amplify uncertainties .",
    "the magnitudes of these effects are difficult to predict analytically because of the many complex numerical transformations involved . instead , we estimate the errors by executing the procedure on simulated data , for which we know exact solutions to compare to the reconstructed quantities . figure  [ err_fig ] compares cross sections from the resultant exact and reconstructed images .",
    "we generate the data with the same critical state model used for the background of the magnetic images , as described in section  [ b].@xcite the parameters are the same , with the applied current ( -0.02  a ) corresponding to fig .",
    "[ bjep](f ) .",
    "we choose this frame because it includes regions of zero current , which present a worst case for reconstructing @xmath16 , as described below .    as the input to the reconstruction procedure",
    ", we calculate an image of the magnetic field in the measurement plane ( z=1.2  @xmath5 m ) .",
    "this is identical to the background of fig .",
    "[ bjep](f ) , but extends over the entire image area . as in the background , we account for the sensor s tilt ( 3@xmath28about the @xmath29 axis ) , which adds a small portion of @xmath127 to the measured `` @xmath17 . ''",
    "we then add normally distributed noise within the measurement region ( the subset of the image defined by the dashed green box in fig .",
    "[ bjep](c ) ) .",
    "the amplitude of the noise matches that observed in the real data outside the strip .",
    "using the reconstruction procedure , we obtain @xmath42 , @xmath43 , and @xmath71 , shown in the first column of fig .",
    "[ err_fig ] .",
    "the reconstructed @xmath42 smooths the sharp corners of the true @xmath42 .",
    "it also displays 0.03  ma/@xmath55  rms of noise , as does the reconstructed @xmath43 .",
    "the only variation as a function of @xmath29 comes from the noise added to @xmath27 ; the exact values of all @xmath25 components ( and @xmath128 ) are zero .    to reconstruct @xmath7",
    ", we similarly calculate @xmath27 for applied currents corresponding to 12.5  @xmath5s before and after fig .",
    "[ bjep](f ) . from each @xmath27 image",
    "we reconstruct @xmath71 , and subtract to approximate @xmath129 , shown in fig .",
    "[ err_fig](k ) .",
    "we then follow the reconstruction procedure for @xmath15 ( as in section  [ ei ] ) and @xmath16 ( section  [ ep ] ) .",
    "we see in fig .",
    "[ err_fig](e ) that an erroneous negative slope is present in the residual of the reconstructed @xmath76 .",
    "this error can be traced to the small portion of @xmath127 in @xmath27 , which is not accounted for by the reconstruction procedure . in principle , the procedure could be adapted to assume a specified linear combination of @xmath130 and @xmath17 , though relations such as eq .",
    "[ gb_eq ] would become more complicated .",
    "one could also calculate an approximate @xmath130 from the reconstructed @xmath42 , subtract it from the measured @xmath27 , then iterate , reconstructing a more accurate @xmath42 and @xmath17 each iteration .",
    "this procedure has been successfully applied to removing in - plane field components from magneto - optic images.@xcite both procedures require precise knowledge of the sensor tilt .",
    "although small compared to the error in @xmath76 , other errors are worth noting .",
    "for one , we compare the @xmath25 components of the inductive electric field and total electric field ( fig .",
    "[ err_fig](h ) versus ( i ) ) .",
    "the addition of @xmath131 suppresses @xmath132 ( from about @xmath133 to @xmath134  @xmath5v / cm ) everywhere except near @xmath135  @xmath5 m , where @xmath132 fluctuates with @xmath29 by 0.1  @xmath5v / cm rms over the image . at these locations , @xmath0 is approximately zero , making the direction of @xmath6 completely uncertain , which renders eqs .",
    "[ eiep][integral_ep ] inaccurate . furthermore",
    ", such errors may scale up with the larger @xmath136 present in the real data .",
    "thus we must admit @xmath137 uncertainty in @xmath136 near regions in which @xmath0 drops below its noise level , 0.03  ma/@xmath55 .",
    "more generally , we point out that this error analysis is performed for a homogeneous model , which may not account for some features of real , inhomogeneous systems .      where there are large uncertainties in @xmath16",
    ", one can use an alternative route to reconstructing @xmath7 that bypasses @xmath16 .",
    "this method starts with @xmath139 , to which @xmath16 ( which is curl free by definition ) does not contribute .",
    "as in section  [ ep ] , we assume @xmath7 is parallel to @xmath6 , in which case we can write @xmath140 and describe @xmath7 via the scalar @xmath141 ( the local resistivity ) .",
    "swapping sides and taking the curl , we have @xmath142 taking the @xmath31 component and applying faraday s law ( eq .  [ ecurl ] ) to the right - hand side , @xmath143 to proceed , we assume that the spatial dependence of @xmath141 arises solely from its dependence on @xmath0 , i.e. that the @xmath1@xmath0 relation is constant over the single - pixel scale at which we solve this equation .",
    "then , @xmath144 + \\rho ( \\partial_x j_y - \\partial_y jx ) = -\\partial_t b_z\\ ] ] which we can write in a standard form @xmath145 where @xmath146 are known .",
    "the solution to this differential equation is@xcite @xmath147 where @xmath148 .",
    "we use the boundary condition @xmath149 .",
    "so the ingredients are the reconstructed @xmath150 and @xmath6 , along with its spatial derivatives .",
    "these quantities are arranged by time ; we re - sort them by @xmath0 .",
    "then the integrals with respect to @xmath0 are calculated by the trapezoid method .",
    "applying eq .",
    "[ solution ] at each pixel , we obtain @xmath151 and therefore @xmath152 at each point .",
    "we could then reconstruct @xmath153 if desired .    in practice ,",
    "our results are dominated by noise . in our images ,",
    "the spatial derivatives of @xmath0 are of order @xmath154  ma/@xmath155 while their uncertainties ( based on the 0.03  ma/@xmath55 uncertainty in @xmath0 ) are several orders of magnitude larger .",
    "this method may be effective , however , for other samples or measurement techniques .",
    "we have shown that time - resolved magnetic imaging of a superconducting thin film yields a complete characterization of its electromagnetic properties , including distributions of current flow , electric field , power , and local @xmath1@xmath0 relations .",
    "we also point out the physical assumptions and requirements behind the mathematical transformations .",
    "the technique is compatible with various methods of magnetic imaging .",
    "it requires time resolution commensurate with the sample conditions being studied , but this capability is not limited to scanning hall probe microscopes .",
    "magneto - optics can use high - speed frame grabbing or a phase - locked short pulse technique to acquire similar data sets ( albeit in a different pixel sequence).@xcite alternatively , the average response can be acquired from each pixel in succession , as is done here , at the expense of longer total acquisition time .    an applied field , @xmath156 , can be substituted for our applied current , and its time dependence need not be sinusoidal .",
    "for example , the analysis is applicable to the transient response following a change in applied current or field , as in ref .  .",
    "however , by demonstrating the technique on a superconducting strip carrying an applied current at 400  hz , a realistic operating frequency for power applications,@xcite we point out that an important use of this work is the characterization of material inhomogeneity and its effect on ac losses",
    ". such imaging may also provide an efficient method for measuring the effects of complex sample geometries.@xcite    as mentioned in section  [ ej ] , @xmath1@xmath0 curves give insight into the flux pinning mechanism.@xcite by resolving the variation in @xmath1 versus @xmath0 with position and time , this analysis may allow one to dissect the behavior of a heterogeneous sample , correlating pinning dynamics with materials properties .",
    "one may also examine correlations with quantities , such as magnetic field strength , that vary with space or time , fully accounting for the heterogeneous self - field experienced by different parts of the sample .",
    "we gratefully acknowledge several contributions : the hall sensor was fabricated by janice wynn guikema using gaas / algaas heterostructures grown by david kisker .",
    "joseph sulpizio and hung - tao chou grew the sensor s oxide layer .",
    "the ybco film was grown by george daniels .",
    "christian jooss lent useful advice and experience .",
    "this work was supported by the air force office of scientific research through a multi - university research initiative ( muri ) ."
  ],
  "abstract_text": [
    "<S> various local probes have been applied to understanding current flow through superconducting films , which are often surprisingly inhomogeneous . here </S>",
    "<S> we show that magnetic imaging allows quantitative reconstruction of both current density , @xmath0 , and electric field , @xmath1 , resolved in time and space , in a film carrying subcritical ac current . </S>",
    "<S> current reconstruction entails inversion of the biot - savart law , while electric fields are reconstructed using faraday s law . </S>",
    "<S> we describe the corresponding numerical procedures , largely adapting existing work to the case of a strip carrying ac current , but including new methods of obtaining the complete electric field from the inductive portion determined by faraday s law . </S>",
    "<S> we also delineate the physical requirements behind the mathematical transformations . </S>",
    "<S> we then apply the procedures to images of a strip of yba@xmath2cu@xmath3o@xmath4 carrying an ac current at 400  hz . </S>",
    "<S> our scanning hall probe microscope produces a time - series of magnetic images of the strip with 1  @xmath5 m spatial resolution and 25  @xmath5s time resolution . combining the reconstructed @xmath0 and @xmath1 </S>",
    "<S> , we obtain a complete characterization including local critical current density , @xmath1@xmath0 curves , and power losses . </S>",
    "<S> this analysis has a range of applications from fundamental studies of vortex dynamics to practical coated conductor development . </S>"
  ]
}