{
  "article_text": [
    "the aim of this article is to prove the finiteness of an intriguing invariant of finite abelian groups , called _",
    "phylogenetic complexity_. the invariant was introduced in a seminal paper by sturmfels and sullivant @xcite , where it appeared in relation to phylogenetic models . in short , to a markov process encoded by an abelian group @xmath0 on a tree @xmath1 one associates a toric variety @xmath2 , of particular relevance in algebraic statistics @xcite .",
    "the setting above is known as a _ group  based model_.    we do not describe the relations to phylogenetics in this paper , referring the interested reader to @xcite . instead , in precise , purely mathematical language we present a natural construction of _ a family of lattice polytopes @xmath3 _ associated to any finite abelian group @xmath0  definition [ def : pgn ] .",
    "these polytopes should be considered as the simpliest combinatorial objects encoding the group action .",
    "associating to interesting combinatorial objects a polytope and investigating its properties is nowadays a well - developed and powerful tool on the edge of combinatorics and toric geometry @xcite .",
    "however , our knowledge of properties of the polytopes @xmath3 associated to such basic objects as finite abelian groups is still very limited",
    ". this may be even more surprising , as for various groups @xmath0 , these polytopes relate not only to phylogenetics , but also mathematical physics through conformal blocks and moduli spaces @xcite .",
    "phylogenetic complexity governs the degrees of generators of the ideal of the variety @xmath2 .",
    "using the language of toric geometry , one is interested in the generators of integral relations among the vertices of @xmath3 .",
    "for the introduction to toric geometry we refer the reader to @xcite .",
    "the objects that encode the group action and correspond to vertices of @xmath3 are called _ flows_.    [ def : flow ] let @xmath0 be a finite abelian group and @xmath4 .",
    "a flow is a sequence of @xmath5 elements of @xmath0 summing up to @xmath6 , the neutral element of @xmath0 .",
    "the set of flows is equipped with a group structure via the coordinatewise action .",
    "the group of flows @xmath7 is ( non - canonically ) isomorphic to @xmath8 .",
    "hence , in our article we study possible relations among @xmath5-tuples of elements of @xmath0 summing up to @xmath9 .",
    "let @xmath10 and @xmath11 be two matrices or",
    "_ tables _ of the same size , whose rows are flows",
    ". these two tables are _ compatible _ if and only if , for each @xmath12 , the @xmath13-th column of @xmath10 and the @xmath13-th column of @xmath11 are the same multisets  cf .",
    "example [ ex : rel ] .",
    "compatible tables correspond to binomials in the ideal @xmath14 , where @xmath15 is a star ( also called a claw - tree )  the unique tree with one inner vertex and @xmath5 leaves .",
    "let @xmath1 be a tree , let @xmath15 be the star with @xmath5 leaves , and let @xmath16 be the maximal degree of a generator in a minimal generating set of @xmath17 .",
    "let @xmath18 .",
    "we define the phylogenetic complexity @xmath19 of @xmath0 to be @xmath20 .",
    "the main theorem of the present article is the following :    [ thm : main ]    for any finite abelian group @xmath0 , the phylogenetic complexity @xmath19 is finite .",
    "let us present the state of the art in the following table .",
    "[ cols= \" < , < , < , < , < \" , ]     a lot of the related results concern finiteness . for equivariant models ( which include the class of models described in this article ) the finiteness result on set - theoretic level was proved in @xcite",
    ". hence , our paper can be regarded as a stronger result , but for a smaller class .",
    "obtaining finiteness result on an ideal - theoretic level for equivariant models would be a major achievement , far extending the results of @xcite . however , this is beyond any of the methods described in this paper , where we focus on group - based models .",
    "finiteness plays also an increasingly important role in the context of toric varieties ; cf .",
    "@xcite .",
    "finally , we would like to mention the reduction that we use from the very beginning , previously obtained by sturmfels and sullivant @xcite .",
    "although , in general , one is interested in arbitrary trees , it is enough to consider claw - trees .",
    "this is due to the construction of toric fiber products @xcite .",
    "the structure of the article is as follows . in section [ sec : notation ] we describe the basic notation .",
    "in particular , we recall how one encodes binomials in @xmath14 as special pairs of tables with group elements .",
    "section [ sec : proof ] contains the main result .",
    "first , in subsection [ subs : sketch ] , we present the sketch of the proof , without any technical details and then the complete proof in subsection [ subs : proof ] .",
    "we hope that some of the ideas of the paper can be made effective .",
    "in particular , in future work we plan to prove ( * ? ? ? * conjecture 30 ) .",
    "this section records definitions and notation needed in the rest of the paper .",
    "+ let @xmath0 be a finite abelian group and @xmath21 . in definition [ def : flow ]",
    ", we introduced the most important algebro - combinatorial objects in our setting : @xmath5-tuples of group elements summing to @xmath9 , called _",
    "flows_. from the point of view of toric geometry and phylogenetics , flows correspond to _ monomials _ parameterizing our variety @xmath22 @xcite .",
    "relations among flows  described by _",
    "compatible _ tables  encode the binomials in @xmath23 .",
    "it is a standard approach in toric geometry to represent the parameterizing monomials by their exponents , as points in a lattice .",
    "the polytope , that is the convex hull of such points , captures the geometry of the parameterized variety . for the sake of completeness we present the polytopes corresponding to @xmath22 .",
    "[ def : pgn ] consider the lattice @xmath24 with a basis corresponding to elements of @xmath0 .",
    "consider @xmath25 with the basis @xmath26 indexed by pairs @xmath27\\times g$ ] .",
    "we define an injective map of sets : @xmath28 by @xmath29 .",
    "the image of this map defines the vertices of the polytope @xmath3 .    for @xmath30 and @xmath31",
    ", we have four flows : @xmath32    hence , the polytope @xmath33 has the following four vertices corresponding to the flows above : @xmath34 where @xmath35 corresponds to @xmath36 and @xmath37 corresponds to @xmath38 .    a more sophisticated example is presented in ( * ? ? ?",
    "* example 4.1 ) .",
    "binomials may be identified with a pair of tables of the same size @xmath10 and @xmath11 of elements of @xmath0 , regarded up to row permutation .",
    "each row of such tables has to be a flow .",
    "the identification is as follows .",
    "every binomial is a pair of monomials ; the variables in such monomials correspond to flows , given by a collection of @xmath5 elements in @xmath0 . every monomial is viewed as a table , whose rows are the variables appearing in the monomial ; the number of rows of the corresponding table is the degree of the monomial .",
    "consequently , a binomial is identified with the pair of tables encoding the two monomials respectively . +",
    "a binomial belongs to @xmath39 if and only if the two tables are _ compatible _ , i.e.  for each @xmath13 , the @xmath13-th column of @xmath10 and the @xmath13-th column of @xmath11 are equal as multisets .",
    "+ in order to generate a binomial  represented by a pair of tables @xmath10 , @xmath11  by binomials of degree at most @xmath40 we are allowed to select a subset of rows in @xmath10 of cardinality at most @xmath40 and replace it with a compatible set of rows , repeating this procedure until both tables are equal .",
    "[ ex : rel ]    for @xmath30 and @xmath41 consider the following two compatible tables : @xmath42 note that the red subtable of @xmath10 is compatible with the table @xmath43 hence , we may _ exchange _ them obtaining : @xmath44    note that @xmath10 and @xmath45 are _",
    "compatible_. now , the brown subtable of @xmath45 is compatible with the table @xmath46 finally , we exchange them obtaining @xmath11 .",
    "hence we have a sequence of tables @xmath47 .",
    "more specifically , we started from a degree three binomial given by the pair @xmath48 and we generated it using degree two binomials , called _",
    "quadratic moves _ ; see also example [ exquadmove ] .    in what follows , _ quadratic moves _",
    ", i.e.  binomials of degree two will play a crucial role .",
    "first , let us give the precise definition and an illustrative example .",
    "[ def : qm ]    let @xmath1 be a table  whose rows are flows  of elements of @xmath0 ; let @xmath49 and @xmath50 be two rows of @xmath1 . for any subsequence @xmath51 of @xmath49 , we define two rows @xmath52 and @xmath53 whose elements are the following :    1 .",
    "@xmath54 if @xmath55 , otherwise @xmath56 ; 2 .",
    "@xmath57 if @xmath55 , otherwise @xmath58 .",
    "the transformation of @xmath49 and @xmath50 into @xmath52 and @xmath53 described above is a _ quadratic move _ if @xmath59 ; in other words , if the differences sum up to @xmath6 .",
    "we note that this condition is equivalent to the fact that @xmath52 and @xmath53 are flows .    to illustrate the definition of quadratic moves , we consider the following example , to be compared with example [ ex : rel ] .    [ exquadmove ]    let @xmath60 .",
    "let @xmath1 be the following @xmath61 table of elements in @xmath62 : @xmath63 the two rows @xmath64 and @xmath65 are flows , since their elements sum up to the @xmath36 .",
    "we exchange the red subsequence of elements in the first row with the blue subsequence of elements in the second row . the rows @xmath66 and @xmath67 , corresponding to the chosen ( red ) subsequence as in definition [ def : qm ] , are the two rows of the following table :    @xmath68 this is a quadratic move , since @xmath66 and @xmath67 are still flows .",
    "hence , the table @xmath1 is transformed into the table @xmath69 by the quadratic move above . note that quadratic moves preserve , up to permutation , each column of a table .",
    "in particular , @xmath1 and @xmath69 are two compatible tables , i.e. their columns are the same as multisets .",
    "the aim of this section is to use the combinatorics of tables to prove finiteness of the phylogenetic complexity of a group - based model for any finite abelian group @xmath0 .      before going into technical details ,",
    "let us present here the basic ideas of theorem [ finite phylo ] .",
    "the general strategy is to prove that the function @xmath70 is eventually constant for large @xmath5 .",
    "hence , we start with two compatible @xmath71 tables @xmath10 and @xmath11 for large @xmath5 and we want to transform @xmath10 to @xmath11 .",
    "the main objective is the proof of lemma [ two columns with same rows ] : _ one can transform @xmath10 and @xmath11 , independently , using quadratic moves , in such a way that there exist two columns @xmath72 , @xmath73 on which both tables exactly agree . _",
    "once this aim is achieved , the induction becomes clear  the precise argument is presented in the last paragraph of the proof of theorem [ finite phylo ] .",
    "the most involved part is to show lemma [ two columns with same rows ] .",
    "first , we pass to subtables . for a table @xmath1 , we denoted by @xmath74 the subtable containing all rows , but only those columns where a given element @xmath75 is one of the ( possibly many ) most frequent group elements .",
    "this is not a severe restriction  cf .",
    "remark [ most freq .",
    "such a ` reference ' element @xmath76 is crucial throughout the proof .",
    "note also that , due to compatibility , the indices of columns of the subtables @xmath77 and @xmath78 are the same , as the most frequent elements of any @xmath13-th column in @xmath10 and @xmath11 coincide . in particular ,",
    "@xmath77 and @xmath78 are compatible ( although their rows do not have to be flows any more ) . in the proof",
    ", it is shown that it is easier to move elements that are _ frequent _ in a table , than those that are _ rare _ ; the latter ones are called _",
    "dots_. a precise definition , independent on the choice of @xmath10 or @xmath11 , of frequent and rare elements is given in definition [ def : dots ] . +",
    "equipped with these definitions , it is enough to prove lemma [ two columns not containing dots in same row ] : _ one can transform @xmath10 and @xmath11 , independently , using quadratic moves , in such a way that there exist two columns @xmath72 , @xmath73 such that any row in @xmath10 or @xmath11 contains at most one dot in columns @xmath72 and @xmath73 .",
    "_ indeed , once the above statement is proven , as the tables are considered up to row permutations , we can make all dots in both columns in @xmath10 exactly equal to corresponding dots in @xmath11 .",
    "then lemma [ two columns with same rows ] follows as the entries that are not dots can also be adjusted  details are in the proof of the lemma .",
    "hence , the hard part of the proof of theorem [ finite phylo ] lies in the proof of lemma [ two columns not containing dots in same row ] . here",
    "the ideas are as follows .",
    "first , ( as we passed from @xmath1 to a subtable @xmath74 where a given element is one of most frequent in every column ) we will be passing to thinner and thinner subtables .",
    "however , due to technical reasons , we must also allow their horizontal subdivisions , which motivate the following definition .    given any table @xmath1",
    ", we define a _ vertical stripe _ to be :    * a choice of some number of consecutive columns of @xmath1 , * a subdivision of rows into parts in the chosen columns .",
    "less formally , a vertical stripe is a collection of disjoint subtables in the same columns , that cover all rows of @xmath1",
    ".    two examples of vertical stripes are presented in figure ( [ fig : em ] ) .",
    "one consists of the whole colored part , where the subdivision into three subtables is given by two thick white horizontal stripes .",
    "the second stripe is the yellow one with the subdivision into nine subtables .",
    "we would like to find a vertical stripe with ( at least ) two columns that has at most one dot in each row .",
    "instead , we consider more general subtables that make vertical stripes : each subtable has @xmath79 columns with at most @xmath80 dots in each row .",
    "further , we need to control how many distinct elements @xmath81 of @xmath0 appear as dots in the subtable .",
    "these subtables do not have to contain all rows , but appear in collections that form a vertical stripe , i.e.  the collection covers all rows .",
    "+ @xmath82 the table above pictures the subdivision algorithm deviced in lemma [ two columns with same rows ] for @xmath77 and @xmath78 .",
    "we start with a vertical stripe  here represented by the colored part of the table .",
    "it consists of three subtables , divided by two large horizontal white stripes . in each of the subtables",
    ", we fix the same partition of columns into @xmath83 vertical and three horizontal parts ( given numbers are just examples ) .",
    "the new , finer horizontal subdivision is depicted with thin white stripes . in each horizontal part , we discard at most one of the subtables  these are the red squares .",
    "the yellow part drawn in the center of the picture is a vertical stripe , consisting of subtables that are not discarded in any of the horizontal parts .",
    "+    the main point is that , for large @xmath79 , we may decrease @xmath80 or @xmath81 by subdividing each subtable into @xmath84 small subtables : columns are divided into @xmath85 parts and rows into @xmath86 parts . in particular , we have @xmath87 vertical parts , each consisting of @xmath86 small subtables stacked one under another .",
    "after quadratic moves , we may assume that each small subtable in almost all of the @xmath87 vertical parts either has smaller number of dots in each row ( decreasing @xmath80 ) or smaller number of distinct group elements corresponding to dots ( decreasing @xmath81 ) .",
    "as @xmath87 is always much greater than the number of horizontal subdivisions ( which is always some power of @xmath86 ) we are able to choose a whole vertical stripe ( with much smaller number of columns ) such that in each subtable @xmath80 or @xmath81 has been decreased .",
    "further , we are able to do it in parallel in @xmath77 and @xmath78  details are in the proof of lemma [ two columns not containing dots in same row ] . + we hope this discussion could shed some light on definition [ good table ] .",
    "we mention here a technical remark : since we work with vertical stripes , once we focus on one subtable , we have to make sure we _ do not _ change the structure of other subtables .",
    "this feature is reflected in ( ii ) of definition [ good table ] , where we restrict to quadratic moves that only modify a small part of the table .",
    "we are finally able to list the main steps towards the proof of lemma [ two columns not containing dots in same row ] :    1 .   bound the number of dots in each row ( lemma [ dots in each row ] ) ; 2 .",
    "prove that we may always subdivide a subtable , as described above , decreasing @xmath80 or @xmath81 ( lemma [ gen coloring ] ) ; 3 .",
    "show that the subdivision process can be done in parallel in @xmath10 and @xmath11 ( lemma [ two columns not containing dots in same row ] ) .",
    "we start from the definition of frequent elements in a given table @xmath1 with respect to a function @xmath88 .",
    "let @xmath89 be a function of the cardinality of the group @xmath0 .",
    "we assume @xmath90 .",
    "[ def : dots ]    the set of @xmath89-_frequent elements _ , or frequent elements , in a given @xmath71 table @xmath1 is defined by    @xmath91    note that if an element is frequent , then there exists a row , where it appears at least @xmath89 times .",
    "the elements @xmath75 that are not in @xmath92 are called _ dots _ @xmath93 .",
    "the frequent elements have a key role in allowing quadratic moves in the table .",
    "let us start with three basic  yet useful ",
    "lemmas .",
    "[ lem : move ]    let @xmath94 be flows .",
    "let @xmath95 be a subset of indices and suppose @xmath96 .",
    "there exists a ( non - empty ) subset @xmath97 such that a quadratic move of @xmath98 and @xmath99 on @xmath100 can be performed .",
    "since we have @xmath86 differences , possibly repeated , of the form @xmath101 for @xmath102 , we may find a non - empty subset @xmath100 , such that @xmath103 .",
    "[ dots in each row ]    let @xmath1 be a given table of elements of @xmath0 , then we may assume that each row in @xmath1 has at most @xmath104 dots .",
    "note that there exists a row containing at most @xmath105 dots . assuming the contrary",
    ", we would have at least @xmath106 dots in @xmath1 .",
    "this would imply that there would be a dot in @xmath107  a contradiction .",
    "let us consider a row @xmath108 with the largest number of dots .",
    "if @xmath108 contains at most @xmath104 dots , this finishes the proof .",
    "otherwise , we pick a row @xmath109 with the smallest number of dots ; they are at most @xmath105 .",
    "now , there exist @xmath86 dots of @xmath108 in the same columns as @xmath86 elements of @xmath109 which are in @xmath107 . exchanging a subset of them we decrease the number of rows with the largest number of dots . repeating the process ,",
    "we obtain @xmath1 with all rows with at most @xmath104 dots .",
    "[ counting of zeros ]    let @xmath110 .",
    "for any @xmath111 , there exists @xmath112 such that in any @xmath113-table @xmath1 of size @xmath71 , whose columns contain at least @xmath114 zeros each , there exists a row with at least @xmath115 zeros .    setting @xmath116",
    "we may conclude by double counting zeros column and row - wise .",
    "[ most freq .",
    "let @xmath1 be a @xmath71 table whose entries are elements of @xmath0 .",
    "in each column @xmath117 , we select the elements that appear a maximal number of times ; these elements are the _ most frequent elements _ in @xmath117 . among all the columns , we select those where a _ reference _ element @xmath75 appears as one of the most frequent elements",
    "+ this is not a severe restriction , as @xmath5 is very large and we would restrict to a subtable with at least @xmath118 columns , for some @xmath75 .",
    "such a reference element @xmath76 will be important throughout the proof .    we now introduce a crucial property @xmath119 for our inductive proof .",
    "[ good table ]    let @xmath120 , let @xmath1 be a @xmath71 table whose entries are elements of @xmath0 , and @xmath121 a @xmath122-subtable of @xmath1 .",
    "moreover , let us assume that the following holds :    * @xmath75 is one of the most frequent elements in every column of @xmath1 ; * there are at most @xmath80 dots in every row of @xmath121 ; * there exists a subset @xmath123 of cardinality @xmath81 , such that each dot of @xmath121 belongs to @xmath124 .",
    "we say that the property @xmath125 holds for the pair @xmath126 if    1 .",
    "@xmath127 and @xmath128 , or 2 .",
    "@xmath129 and we can transform @xmath1 into another table @xmath69 ( transforming @xmath121 into @xmath130 ) such that : + we may subdivide the first @xmath131 columns of @xmath130 into @xmath87 consecutive subtables @xmath132 , each consisting of @xmath133 columns and @xmath134 rows that satisfy : ( 1 ) @xmath135 : each of the @xmath132 s _ except one _ has the property @xmath136 .",
    "( 2 ) @xmath137 : for every @xmath132 _ except one _ we can subdivide the rows into @xmath86 parts @xmath138 , such that for every @xmath139 either @xmath140 or @xmath141 holds .",
    "further , the transformation may only use quadratic moves that do not change dots that are in the columns of @xmath121 and in rows outside @xmath121 ( i.e.  it can not move dots in the same vertical stripe , but outside @xmath121 ) .",
    "condition ( a ) in definition [ good table ] is not restrictive , according to remark [ most freq .",
    ", as we will be applying the definition to subtables of @xmath10 and @xmath11 for which @xmath76 is one of the most frequent elements in each column .",
    "in the next lemma , we show that one can transform and divide @xmath121 into smaller subtables decreasing either @xmath80 or @xmath81 , provided @xmath79 is sufficiently large .",
    "this is achieved with special quadratic moves .",
    "[ gen coloring ]    for every @xmath142 , for every @xmath79 sufficiently large , for every pair @xmath126 satisfying the assumptions in definition [ good table ] , the property @xmath125 holds .",
    "the proof is by induction on @xmath80 . for @xmath127",
    "the claim is true for @xmath128 by definition [ good table ] .",
    "let us assume that the claim is true for @xmath80 .",
    "we show the statement for @xmath143 .",
    "+ if @xmath144 , let us set @xmath145 , where @xmath146 is an integer such that the property @xmath147 holds for arbitrary pairs of tables and subtables in the last two arguments ( satisfying assumptions in definition [ good table ] ) .",
    "let us fix an arbitrary pair of tables @xmath126 satisfying assumptions in definition [ good table ] . by definition [ good table ] , each row of @xmath121 has at most @xmath143 dots .",
    "we fix a partition of @xmath121 into equal - sized subtables @xmath148 , each consisting of @xmath149 consecutive columns .",
    "if all @xmath148s contain only rows with strictly less than @xmath143 dots , we are done . otherwise , we choose a subtable @xmath150 with a maximal number of rows containing @xmath143 dots .",
    "every @xmath148 has at most as many rows with @xmath143 dots as @xmath150 .",
    "hence , for any subtable @xmath148 different from @xmath150 we can pair each row of @xmath148 with @xmath143 dots with a row of @xmath148 without any dots ( the latter corresponding to a row of @xmath150 with @xmath143 dots ) .",
    "the structure of @xmath1 is as follows :    @xmath151 \\matrix[mymatrix ] ( m )   {   \\bullet & \\bullet & \\bullet & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots \\\\    &   &   &   &   &   &   &   &    &    &   &   \\\\ \\bullet & \\bullet & \\bullet & \\ldots & \\ldots   & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\ \\ldots & \\ldots & \\ldots & \\bullet & \\bullet & \\bullet   & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\ \\ldots & \\ldots & \\ldots & \\bullet & \\bullet & \\bullet    & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\ \\vspace{1mm}\\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots   & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots \\\\ \\vspace{1mm}\\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots   & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots \\\\ \\vspace{1mm}\\\\ \\bullet & \\bullet & \\bullet & \\ldots & \\ldots & \\ldots   & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots \\\\      } ;        {      \\draw[mymatrixbrace ] ( $ ( m.north west)!(m-5 - 1.south west)!(m.south",
    "west)-({0.5em},0)$ )          -- node[left=2pt ] { $ q$ }           ( $ ( m.north west)!(m-1 - 1.north west)!(m.south west)-({0.5em},0)$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.north west)!(m-11 - 1.south west)!(m.south",
    "west)-({0.5em},0)$ )          -- node[left=2pt ] { $ t\\setminus q$ }           ( $ ( m.north west)!(m-6 - 1.north west)!(m.south west)-({0.5em},0)$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 3.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ q_{i_0}$ }           ( $ ( m.south west)!(m-1 - 1.south west)!(m.south east)-(0,{0.2em})$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 6.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ q_j$ }           ( $ ( m.south west)!(m-1 - 4.south west)!(m.south east)-(0,{0.2em})$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 9.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ q\\setminus ( q_{i_0 } \\cup q_j)$ }           ( $ ( m.south west)!(m-1 - 7.south west)!(m.south east)-(0,{0.2em})$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 12.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ t\\setminus q$ }           ( $ ( m.south west)!(m-1 - 10.south west)!(m.south east)-(0,{0.2em})$ ) ; } \\end{tikzpicture}\\ ] ]    the arrows below describe the pairing between a row with @xmath143 dots with a row without any dots in the subtable @xmath148 . + @xmath152 \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots \\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\ \\bullet & \\ldots & \\bullet & \\bullet & \\ldots & \\ldots\\\\ \\bullet & \\bullet & \\ldots   & \\ldots   & \\bullet & \\ldots \\\\",
    "\\rowops   \\swap{3}{4 }   \\swap{2}{5 } \\end{gmatrix}\\ ] ]    for each such pair , we make a quadratic move reducing the number of dots that a row of @xmath148 may have . hence , by induction , for any @xmath153 the property @xmath154 holds , as @xmath155 .",
    "thus @xmath156 holds by definition [ good table ] .",
    "if @xmath157 , we proceed by induction on @xmath81 .    if @xmath135 , let us set @xmath145 as before .",
    "first , suppose there is only one vertical part @xmath150 which contains rows with @xmath143 dots .",
    "since all the other parts @xmath148 s have rows with at most @xmath80 dots , by induction they satisfy @xmath158 , hence we may conclude in this case .",
    "otherwise , as long as there are two parts @xmath150 and @xmath159 with rows @xmath49 and @xmath50 respectively with @xmath143 dots , we proceed as follows .",
    "let us fix one dot in @xmath49 and one in @xmath50 .",
    "let @xmath160 and @xmath161 be the elements of the rows @xmath49 and @xmath50 in the same columns as the chosen dots .",
    "@xmath151 \\matrix[mymatrix ] ( m )   { \\bullet & \\bullet & \\bullet & \\bullet & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots \\\\ \\bullet & \\bullet & \\bullet & \\color{red}{\\bullet } & g_i & \\ldots & \\ldots & \\ldots & g_j   & \\ldots & \\ldots & g_j & g_j & \\ldots & \\ldots \\\\ \\ldots & \\ldots   & \\ldots & \\ldots   & \\ldots & \\ldots & \\ldots & \\ldots   & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots & g_j & \\color{red}{\\bullet } & \\bullet & \\bullet & \\bullet & \\ldots & \\ldots & g_i & \\ldots & \\ldots & g_i & g_i \\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\ \\vspace{1 mm } \\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\ \\vspace{1 mm } \\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots\\\\      } ;      {      \\draw[mymatrixbrace ] ( $ ( m.north west)!(m-4 - 1.south west)!(m.south west)-({0.5em},0)$ )          -- node[left=2pt ] { $ q$ }           ( $ ( m.north west)!(m-1 - 1.north west)!(m.south west)-({0.5em},0)$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.north west)!(m-9 - 1.south west)!(m.south west)-({0.5em},0)$ )          -- node[left=2pt ] { $ t\\setminus q$ }           ( $ ( m.north west)!(m-5 - 1.north west)!(m.south west)-({0.5em},0)$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 4.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ q_{i_0}$ }           ( $ ( m.south west)!(m-1 - 1.south west)!(m.south east)-(0,{0.2em})$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 8.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ q_{j_0}$ }           ( $ ( m.south west)!(m-1 - 5.south west)!(m.south east)-(0,{0.2em})$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 11.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ q\\setminus ( q_{i_0}\\cup q_{j_0})$ }           ( $ ( m.south west)!(m-1 - 9.south west)!(m.south east)-(0,{0.2em})$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 15.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ t\\setminus q$ }           ( $ ( m.south west)!(m-1 - 12.south west)!(m.south east)-(0,{0.2em})$ ) ; } \\end{tikzpicture}\\ ] ]    as @xmath160 is not a dot , there has to exist a row @xmath162 of @xmath1 with more than @xmath89 copies of @xmath160 .",
    "we make a quadratic move between @xmath50 and @xmath162 not involving the @xmath163 columns of dots in @xmath150 and @xmath159 in the rows @xmath49 and @xmath50 .",
    "this procedure allows us to put at least @xmath164 copies of @xmath160 in the row @xmath50 , without moving dots in @xmath121  we need to subtract @xmath86 by lemma [ lem : move ] and @xmath165 to avoid the dots .",
    "now , we can make the same quadratic move for @xmath161 and @xmath49 .",
    "the result of these moves is in the table above , where the red bullets @xmath166 are the chosen dots .",
    "+ after performing these quadratic moves , if there is a column @xmath167 containing @xmath161 and @xmath160 in rows @xmath49 and @xmath50 , then we make a quadratic move , exchanging the chosen dots and the elements of @xmath167 . otherwise , applying lemma [ counting of zeros ] for @xmath168 to a subtable of @xmath1 of columns containing @xmath160 in the row @xmath50 , we may find a row @xmath162 containing at least @xmath169 copies of @xmath76 , as long as @xmath170 .",
    "then we move some copies of @xmath76 to the row @xmath49 by lemma [ lem : move ] .",
    "analogously for @xmath161 , we may move some copies of @xmath76 to the row @xmath50 . here",
    "are depicted in red the copies of @xmath76 and in blue the quadratic move putting those copies of @xmath76 in @xmath49 and @xmath50 respectively .",
    "+ @xmath171 c } \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & { \\color{red } g } & { \\color{red } g } & { \\color{red } g } & { \\color{red } g }   & r_t\\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\color{blue}{\\downarrow } & \\color{blue}{\\downarrow } & \\color{blue}{\\downarrow } & \\color{blue}{\\downarrow } &   \\\\ { \\color{red } \\bullet } & g_i & g_j   & g_j & \\ldots & g_j & \\ldots & \\ldots & \\ldots & \\ldots & r_i\\\\ \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots & \\ldots &   \\\\ g_j & { \\color{red } \\bullet } & \\ldots & \\ldots & \\ldots & \\ldots & g_i & g_i & \\ldots   & g_i   & r_j\\\\ \\ldots & \\ldots & \\color{blue}{\\uparrow } & \\color{blue}{\\uparrow } & \\color{blue}{\\uparrow } & \\color{blue}{\\uparrow } & \\ldots & \\ldots & \\ldots & \\ldots &   \\\\ \\ldots & \\ldots & { \\color{red } g } & { \\color{red } g } & { \\color{red } g } & { \\color{red } g } & \\ldots & \\ldots & \\ldots & \\ldots & r_{t'}\\\\ \\end{block } \\end{blockarray}\\ ] ]    applying the blue quadratic move above , we obtain a column @xmath117 that has @xmath76 in @xmath49 and @xmath160 in @xmath50 . in the same way",
    ", we obtain a column @xmath72 that has @xmath76 in @xmath50 and @xmath161 in @xmath49 .",
    "now , we perform a quadratic move in the subtable below , exchanging the chosen dots :    @xmath172    thus , we reduce the number of dots in both rows .",
    "this concludes the case @xmath135 .",
    "+ assume @xmath173 .",
    "let us set @xmath145 , where @xmath146 is such that both of the properties @xmath174 and @xmath175 hold .",
    "suppose that there is only one @xmath150 such that there exists a row with @xmath143 dots corresponding to @xmath81 distinct group elements .",
    "then the rows of every other part @xmath148 can be partitioned into at most @xmath176 parts @xmath177 , such that    * all the rows in @xmath178 have at most @xmath80 dots ; * all the dots in @xmath177 for @xmath179 correspond to at most @xmath180 distinct group elements .",
    "we conclude by induction in the case when there is only one part @xmath150 .",
    "we will reduce every other case to this one .",
    "assume that there are two parts @xmath150 and @xmath159 such that there exist rows @xmath49 and @xmath50 with @xmath143 dots corresponding to @xmath81 distinct group elements .",
    "as both rows @xmath49 and @xmath50 contain dots corresponding to the same @xmath81 elements of the group @xmath0 , we can choose one dot in each row corresponding to the same element .",
    "now , repeating the procedure described in the case @xmath135 , we reduce the number of dots in @xmath49 and @xmath50 .",
    "this concludes the proof .    by lemma [ gen coloring ] for any @xmath181 we set @xmath182 such that for all @xmath183 the property @xmath184 holds .",
    "[ two columns not containing dots in same row ]    let @xmath10 and @xmath11 be two compatible tables with at least @xmath185 columns .",
    "then , we may transform them using quadratic moves into two tables @xmath45 and @xmath186 such that the following holds : there exists @xmath139 such that no row in @xmath45 nor in @xmath186 has a dot in both the @xmath139-th and the @xmath187-st columns .",
    "let us restrict @xmath10 and @xmath11 to the subtables @xmath188 and @xmath189 containing all rows and those columns that have @xmath76 as the most frequent element .",
    "by lemma [ dots in each row ] , we may assume that the upper bound on the number of dots in @xmath188 and @xmath189 in each row is @xmath190 . by remark [ most freq .",
    "and the assumption on the size of @xmath10 and @xmath11 , we can assume that @xmath188 and @xmath189 have at least @xmath191 columns .",
    "hence , in particular , the properties @xmath192 and @xmath193 hold . in the rest of the proof we transform both tables @xmath77 and @xmath78 using quadratic moves , at each step passing to a smaller vertical stripe such that each subtable in it satisfies the property @xmath119 with smaller and smaller @xmath80 or @xmath81 . + we apply the following algorithm , which is depicted in figure ( [ fig : em ] ) .",
    "the starting point of the @xmath13-th step of the algorithm are two compatible tables with corresponding distinguished @xmath194 consecutive columns forming a vertical stripe . in the @xmath13-th step ,",
    "the vertical stripe has at most @xmath195 parts ( subtables ) . in the table",
    "@xmath188 the parts are @xmath196 . for a given part @xmath196 ,",
    "let @xmath197 be the maximal number of dots that a row may have .",
    "let @xmath198 be the number of distinct group elements correspoding to dots of @xmath196",
    ". then @xmath199 holds .",
    "likewise the parts @xmath200 of @xmath189 satisfy @xmath201 .",
    "let us subdivide the @xmath202 columns into @xmath203 parts , subdividing each @xmath196 into parts @xmath204 , as in definition [ good table ] .",
    "now , the algorithm transforms @xmath204 using definition [ good table ] .",
    "hence , we obtain a subdivision of rows of @xmath204 into at most @xmath176 parts @xmath205 . here",
    "are the parts of @xmath188 highlighted in blue , where the left and right brackets select horizontal parts and the bottom bracket selects vertical parts :    @xmath151 \\matrix[mymatrix ] ( m )   { \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots   \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ \\ldots & \\ldots & \\ldots   & \\ldots   & \\ldots \\\\ } ;        {      \\draw[mymatrixbrace ] ( $ ( m.north west)!(m-7 - 1.south west)!(m.south west)-({0.5em},0)$ )          -- node[left=2pt ] { $ \\color{blue}{t'_{0,j}}$ }           ( $ (",
    "m.north west)!(m-1 - 1.north west)!(m.south west)-({0.5em},0)$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.north east)!(m-1 - 1.north east)!(m.south east)+({0.5em},0)$ )          -- node[right=2pt ] { $ \\color{blue}{t'_{0,j , a , b}}$ }           ( $ ( m.north east)!(m-3 - 1.south east)!(m.south east)+({0.5em},0)$ ) ; }      {      \\draw[mymatrixbrace ] ( $ ( m.south west)!(m-1 - 2.south east)!(m.south east)-(0,{0.2em})$ )          -- node[below=2pt ] { $ \\color{blue}{t'_{0,j , a}}$ }           ( $ ( m.south west)!(m-1 - 1.south west)!(m.south east)-(0,{0.2em})$ ) ; }       \\end{tikzpicture}\\ ] ]    for each @xmath139 , for every @xmath206 _ except one _ and for every @xmath207 the subtable @xmath205 satisfies either the property @xmath208 or @xmath209 . as each of the @xmath210 horizontal parts in @xmath77",
    "can exclude one @xmath204 , and each of the @xmath210 horizontal parts in @xmath78 can exclude one @xmath211 we may find an index @xmath212 such that :    1 .",
    "@xmath213 or @xmath214    and    1 .",
    "@xmath215 or @xmath216    hold for every @xmath139 and every @xmath207 .",
    "( less formally , since the number of vertical stripes is much larger than the number of discarded subtables in each subdivision , we can choose two corresponding vertical stripes in both of the tables .",
    "this is pictured in figure ( [ fig : em2 ] ) . )",
    "the choice of the @xmath212-th vertical stripe and the subdivisions @xmath217 , @xmath218 are the output of the @xmath13-th step of the algorithm and the input of the @xmath219-th step .",
    "the algorithm terminates when we reach @xmath127 .",
    "the procedure terminates in a finite number of steps as at each step either @xmath80 or @xmath81 decreases .",
    "moreover , at every step of the algorithm , we have collections of subtables satisfying property @xmath119 .",
    "this implies that , at the last step , @xmath128 .",
    "thus the algorithm provides the desired pairs of columns .",
    "@xmath220    [ two columns with same rows ]    let @xmath10 and @xmath11 be two compatible tables with @xmath5 columns , for @xmath5 sufficiently large .",
    "then we can transform @xmath10 and @xmath11 using quadratic moves such that the following holds : there exists @xmath139 such that the @xmath139-th and @xmath187-st columns in @xmath10 equal respectively the @xmath139-th and @xmath187-st columns in @xmath11 .",
    "we restrict to subtables @xmath188 and @xmath189 where @xmath76 is the most frequent element , as in remark [ most freq .",
    "el . ] . by lemma [",
    "two columns not containing dots in same row ] , we may assume that in every row of the @xmath188 and @xmath189 we have only one dot in the first two columns .",
    "now , we can permute rows in such a way that the dots are equal in the corresponding entries . the elements in the rows which are not dots are not necessarily the same in each row .",
    "we show that given any pair of elements @xmath221 in the first column and in the rows @xmath222 respectively , we can exchange them .",
    "since @xmath160 and @xmath161 are in @xmath223 , we can find two rows , say @xmath224 and @xmath162 respectively , such that we have at least @xmath89 copies of @xmath160 and @xmath89 copies of @xmath161 in @xmath224 and @xmath162 respectively  see the table below . by lemma [",
    "lem : move ] , we can move at least @xmath225 copies of @xmath160 to the row @xmath50 and at least @xmath225 copies of @xmath161 to @xmath49 ; here we subtract two because we are avoiding the first two columns . if there is a column @xmath167 containing @xmath160 and @xmath161 in its @xmath139-th and @xmath13-th rows respectively",
    ", then we exchange them by a quadratic move on the column @xmath167 and the first column .",
    "otherwise , we proceed as follows .",
    "we restrict to a subtable containing columns where the row @xmath50 has @xmath160 as its entries . by lemma [ counting of zeros ] for @xmath168 , in this subtable we may find @xmath86 copies of @xmath76 in some row @xmath162",
    ". then we move some copies of @xmath76 to the row @xmath49 applying lemma [ lem : move ] .",
    "analogously for @xmath161 , we may move some copies of @xmath76 to the row @xmath50 . here",
    "are depicted in red the copies of @xmath76 and in blue the quadratic moves putting those copies of @xmath76 in @xmath49 and @xmath50 respectively .",
    "@xmath226 now , we perform a quadratic move exchanging @xmath160 and @xmath161 in a suitable subtable of @xmath77 :    @xmath227 such moves allow to adjust all elements in the first two columns that are _ not _ dots .",
    "this concludes the proof .",
    "[ finite phylo ]    for any finite abelian group @xmath0 , the phylogenetic complexity @xmath19 of @xmath0 is finite .",
    "let @xmath0 be a finite abelian group .",
    "fix @xmath228 . once @xmath229 is fixed , the phylogenetic complexity @xmath230 is finite by the hilbert basis theorem .",
    "assume @xmath231 .",
    "we will show that @xmath232 .",
    "this implies that they are equal .",
    "+ let @xmath233 be a binomial in @xmath14 identified with a compatible pair of @xmath71 tables @xmath10 and @xmath11 , as described in section 2 . by lemma [ two columns with same rows ] , we may assume there exist two columns @xmath234 in @xmath10 and their corresponding columns @xmath235 in @xmath11 , for some @xmath236 , such that , for each row , @xmath72 has the same entries as @xmath237 , and @xmath73 has the same entries as @xmath238 .",
    "note that in lemma [ two columns with same rows ] we use quadratic moves to transform two given tables @xmath10 and @xmath11 into a pair of tables such that they satisfy the condition on columns above .",
    "+ now , summing coordinatewise the columns @xmath72 and @xmath73 in @xmath10 , the columns @xmath237 and @xmath238 in @xmath11 , we obtain a new pair of tables @xmath239 and @xmath240 with @xmath241 columns .",
    "the pair @xmath242 is identified with a binomial @xmath243 . by definition",
    ", this binomial is generated by binomials of degree at most @xmath244 .",
    "hence , we may transform @xmath239 into @xmath240 by exchanging in every step at most @xmath244 rows .",
    "each of such steps lifts to an exchange among at most @xmath244 rows in tables @xmath10 and @xmath11 . after applying all the steps",
    ", the resulting tables @xmath45 and @xmath186 still do not have to be equal .",
    "however , they only differ possibly on the columns @xmath72 and @xmath73 . without loss of generality",
    "we may assume @xmath245 .",
    "thus the tables @xmath45 and @xmath186 are as follows :    @xmath246    where columns _ different _ from the first two are identical .",
    "suppose there exists @xmath247 such that @xmath248 ( and @xmath249 ) .",
    "then @xmath250 , since the the @xmath247-th rows of @xmath45 and @xmath186 are identical except in the first two columns and , moreover , every row is a flow . on the other hand",
    ", there exists @xmath80 such that @xmath251 and @xmath252 .",
    "thus we make a quadratic move between @xmath253 and @xmath254 .",
    "this concludes the proof .",
    "in this last section , we collect some well - known open questions regarding group - based models for the convenience of the reader .",
    "we start from the central conjecture in this context .",
    "we are grateful to seth sullivant for noticing that this is equivalent to @xmath258 being constant , apart from the case when @xmath260 and @xmath31 , when the associated variety is the whole projective space .",
    "conjecture [ con : constant ] also implies the following .",
    "yet another direction would be trying to find combinatorial analogs of @xmath263modules presented in @xcite .",
    "we have not pursued this approach , however we present some similarities .",
    "first , in the class of equivariant models one can apply such techniques to prove finiteness on the set  theoretic level @xcite .",
    "second , one of the properties of equivariant models  a flattening  is mimicked for group  based models ( on the algebra level though , but not on the level of varieties ) .",
    "this is the addition of two group elements that turns a flow of length @xmath264 to a flow of length @xmath5 .",
    "the latter was a crucial property that allowed us to obtain the result : generation using the ` simple ' equations ( in our case , quadratic moves ) and induced equations for smaller @xmath5 .",
    "it would be very desirable to introduce a general setting for polytopes and toric varieties , which would still allow to obtain finiteness results on the ideal - theoretic level .",
    "* acknowledgements . *",
    "+ the first author was supported by polish national science centre grant no .",
    "2015/19/d / st1/01180 and the foundation for polish science ( fnp ) .",
    "the second author acknowledges fundings from the doctoral programme network at aalto university ."
  ],
  "abstract_text": [
    "<S> we prove that the phylogenetic complexity  </S>",
    "<S> an invariant introduced by sturmfels and sullivant  of any finite abelian group is finite . </S>"
  ]
}