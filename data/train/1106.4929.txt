{
  "article_text": [
    "when a dynamical system is complex enough , it becomes no longer feasible  or indeed , interesting  to describe every possible trajectory .",
    "a first step is then to study what a ` typical trajectory ' does . for hamiltonian dynamics , statistical mechanics provides us with powerful techniques to compute some properties of such typical trajectories , but for generic dynamics we must in most cases resort to simulations .",
    "there are many situations in which the trajectories that matter are not the typical ones , but rather ` rare ' ones reached from exceptional initial conditions , or particularly infrequently .",
    "consider the following examples :    @xmath0 planetary systems are in general chaotic , and the different sets of present conditions , falling within the range of observational error , may lead to widely varying inferences about the past and future . because we do not expect that an observed system has been created recently , or will be destroyed immediately",
    ", we must understand how this comes about , and we are naturally led to a statistical study of the trajectories .",
    "@xmath0 molecular dynamics is in many cases characterized by long periods of vibrations around a local metastable configuration , punctuated by relatively rapid but infrequent ` activation ' events , leading to a major rearrangement . because they are the essential steps of chemical transformations , it is of the greatest importance to be able to simulate such events in an accelerated way , without having to wait for them to happen spontaneously .",
    "there is a vast literature on this subject .",
    "@xmath0 in a similar fashion , supercooled liquids and glasses are characterized by vibrational dynamics , with events localized in time _ and space _ where the transformations take place .",
    "these ` dynamic heterogeneities ' are the analogues of reaction paths in chemical systems .",
    "@xmath0 it has long be known that , in a liquid undergoing fully developed turbulence , due to the presence of abnormally large fluctuations of velocities , the dynamics are intermittent . the natural question is which dynamic features are responsible for this .",
    "@xmath0 in the sea there have been reports of ( ` rogue ' ) waves of exceptionally large amplitudes .",
    "they are rare , but much more common than one would expect from a gaussian distribution .",
    "the subject is of obvious interest , and is still very much open .",
    "@xmath0 transport of energy or particles across a sample is facilitated by exceptional ` ballistic ' trajectories , or hindered by situations resembling traffic jams .",
    "@xmath0 when a system is subject to external forcing , the power injected ( or the entropy production ) during a given time is a quantity that depends on the particular trajectory it is following .",
    "the second law of thermodynamics sets limits on the expectation value of these quantities , but does not limit the extent of the ( rare ) fluctuations .",
    "thus , one may extract work from a system while lowering the total entropy , but the probability of this goes down exponentially with its size , and with the interval of time .",
    "all of these problems may be studied by simulating repeatedly , or for long times , the true dynamics . however , as one may imagine , this procedure soon becomes unfeasible .",
    "there are basically two types of methods to generate in a controlled way rare events .",
    "the _ path - sampling _ method amounts to monte carlo dynamics in trajectory space , correctly designed to weigh each trajectory with the desired bias .",
    "a second strategy works directly in configuration space : one introduces a population of copies of the initial system and relies on a mixture including the original dynamics , supplemented with a ` darwinian pressure '  again , in a controlled way to favor the exploration of atypical trajectories . in this review",
    "we concentrate on the second class .",
    "the paper is organized as follows .",
    "the population dynamics with cloning is introduced in section [ pd ] , where it is shown how it can be used to compute the large deviation function ( or rather its legendre transform ) of extensive observables of the trajectories of a diffusive dynamics with drift and a multiplicative ( cloning ) term . the relative weight of the drift and cloning terms is analyzed in section [ bias ] , where it is shown how a change of bases can help in adjusting their relative contribution .",
    "then a series of examples from different contexts follows .",
    "purely stochastic systems are studied in sections [ transport ] and [ sec : activity ] , where the large deviations of , respectively , the current in interacting particle systems and the dynamical activity in kinetically constrained models are analyzed .",
    "sections [ chaos ] and [ gallavotti - cohen ] consider examples of deterministic dynamics , such as the standard map and the hamiltonian fermi - pasta - ulam model , for which trajectory with large or small lyapunov exponent are studied , or the sinai billiard , for which the symmetry associated with the fluctuation theorem is easily verified .",
    "the last section [ planets ] suggests how the numerical method of cloning could be used also in the study of the stability of planetary systems .",
    "to fix ideas , consider a noisy dynamics for a vector @xmath1 whose components evolve as : @xmath2 with @xmath3 a noise which for simplicity we shall suppose is gaussian and white , with variance @xmath4 .",
    "the probability of a trajectory up to time @xmath5 is found by writing @xmath6 : @xmath7 \\propto   e^{-\\sum_i \\int_o^t dt ' \\;\\frac { ( { \\dot x}_i - f_i ) ^2}{4t_i } }     \\label{do}\\ ] ] as an example , we wish to calculate the probability that a certain quantity @xmath8 $ ] takes a _ time - averaged _",
    "value @xmath9 : @xmath10   p [   { \\bf   x}(t ) ]    \\delta \\left\\ { \\int_o^t   dt ' \\ ;   a({\\bf x } ) -t { \\cal{a}}_o\\right\\ }             \\label{tr}\\ ] ] it is more practical to compute the laplace transform : @xmath11   p [   { \\bf   x}(t ) ]   e^ { \\left\\ { \\alpha \\int_o^t   dt ' \\ ;   a({\\bf x } ) \\right\\ } }    \\nonumber \\\\ & & \\qquad      \\propto   \\int d [   { \\bf   x } ] e^{-\\sum_i \\int_o^t dt ' \\ ; \\frac { ( { \\dot x}_i - f_i ) ^2}{4t_i } + \\alpha \\int_o^t   dt ' \\ ;   a({\\bf x } ) }        \\label{cu }    \\end{aligned}\\ ] ]    in particular , for large times @xmath12 becomes a peaked function @xmath13 , with @xmath14 the large deviation function given by the legendre transform  @xcite : @xmath15\\ ] ] the last of equations ( [ cu ] ) may be interpreted as a sum over paths with a modified weight , and may be simulated with path sampling methods .",
    "the strategy we describe in this paper is instead to notice that eq .",
    "( [ cu ] ) may be interpreted as describing the following dynamics :    * consider a population of infinitely many non - interacting clones of the system @xmath16 satisfying the original dynamics @xmath17 @xmath18@xmath19 .",
    "the noise of each clone is independent from the others .",
    "* at each time interval @xmath20 , each clone is either killed or replicated , so that it is replaced on average by @xmath21 clones .",
    "this population dynamics is such that the average cloning or pruning rate of clones yields at large times @xmath22 . in practice",
    ", we do not simulate infinitely many clones of the initial system and we explain in the following how to adapt the dynamics to work with a large , but finite , _ fixed _ number of clones ( typically in the hundreds ) .",
    "we shall see how this simple idea , originally applied in the context of diffusion monte carlo @xcite , may be adapted to a number of different problems .",
    "the actual specific form of the population dynamics involved depends on the nature of the problem ( continuous or discrete state space , continuous or discrete time , etc ) : we shall specify this in each example below .",
    "similar strategies to simulate rare events have been advocated in other context with great success , see for example @xcite .",
    "we have mentioned so far large deviations of a quantity of the form : @xmath23 = \\int_o^t dt ' \\ ; a({\\bf x}(t ' ) ) \\label{f}\\ ] ] in many cases , the functionals @xmath24 depend also on the time - derivatives @xmath25 , and even are functions that are non - local in time . in these cases ,",
    "the cloning rate at time @xmath5 depends as well on the configurations at time @xmath26 .",
    "the algorithms presented in this review give not only access to large deviations of the observable @xmath24 but also allow one to compute the average of any observable among the corresponding , atypical , histories weighted by @xmath27 , allowing to answer questions such as _ `` what happens with the vorticity of a fluid at a time and place where energy dissipation is unusually large ? ''",
    "_    the average of an observable @xmath28 at the final time @xmath5 @xmath29 is recovered from the corresponding average among the clones at that time .",
    "the averages at intermediate times ( for @xmath30 ) @xmath31 may also be recovered by attaching to each clone at time @xmath32 the observed value of @xmath33 , and then constructing the average @xmath34 among the clones which have survived until the final time @xmath5 . in the large time limit @xmath35 , this average is not sensitive to the precise value of @xmath32 and a better sampling is achieved by attaching to each clone the average value of @xmath28 around time @xmath32  @xcite .",
    "equation ( [ cu ] ) is nothing but the path - integral representation of the equation :    @xmath36    with @xmath37 the probability distribution , and : @xmath38 the three terms in @xmath39 correspond to _ diffusion , drift _ , and _ cloning _ , respectively .",
    "the technique of _ dynamic importance sampling _ can always be used to reshuffle the importance of drift and cloning .",
    "it is implemented by making a change of basis : @xmath40 with : @xmath41 + \\alpha a   { }      \\label{modi1}\\end{aligned}\\ ] ] in general , there is not an optimal choice for the field @xmath42 .",
    "we will see examples later in different contexts .",
    "another way to understand ( [ modi ] ) is to consider the dynamics ( [ cu ] ) with a modified large deviation function : @xmath43 writing @xmath44 and expressing @xmath45 in terms of the equation of motion , we recover the result ( [ modi ] ) , ( [ modi1 ] ) .",
    "alternatively , we may of course always consider the modified dynamics as the original one with a cloning rate @xmath46 .",
    "trajectories are thus reweighted according to initial and final configurations .",
    "the many - time expectation with respect to the original dynamics @xmath47 for @xmath48 , starting from a distribution @xmath49 , corresponds to averages with the modified dynamics of @xmath50 , starting from a distribution @xmath51 .",
    "it is important to realize that this is _ not _ the usual monte - carlo importance sampling technique used in equilibrium simulations , which consists simply of modifying the energy in the sampling protocol @xmath52 ( for some suitably chosen @xmath53 ) , and compensating by calculating averages as follows : @xmath54 where @xmath55 stands for average using a monte carlo scheme with energy @xmath56 .",
    "with such a technique , one can not calculate many - time correlation functions , or trajectory probabilities , since the dynamics are unrelated to the original ones ; as one can see easily for the case @xmath57 where the modified dynamics are simple diffusion , unlike the original ones . in out of equilibrium situations",
    ", we do not have an explicit expression for the stationary distribution , and there is no simple way to modify the dynamics in order that they remain probability conserving and have a biased measure , i.e. there is no analog of ( [ is ] ) .",
    "it sometimes happens that we are interested in calculating the moments of an _ instantaneous _ quantity .",
    "consider for example the case of navier - stokes equations for driven turbulence .",
    "a set of quantities that characterize intermittency are the so - called longitudinal - structure functions @xcite @xmath58 in order to compute these moments efficiently , we put , in the notation of the previous paragraphs : @xmath59 we may run several parallel simulations of fully developed turbulence in the stationary state , each with its own realization of stochastic stirring , and supplement this with a cloning / pruning rate equal to the time - derivative of ( [ ff ] ) , which may be expressed in terms of the instantaneous velocities using the navier - stokes equations .",
    "the total average cloning rate yields , for large times , @xmath60 .",
    "perhaps more interestingly , the configurations that dominate the modified dynamics are the ones that contribute to @xmath60 , and are continuously being sampled . to the best of our knowledge , this strategy has not been implemented yet .",
    "we now describe large deviations in non - equilibrium stochastic models of transport . in such models the main observables ( e.g. the current , the density , etc . )",
    "are functions of the sample path of a markov chain in a high - dimensional state space .",
    "imagine a discretization in space of the noisy dynamics ( [ un ] ) , so that the phase space is given by a finite set of configurations .",
    "if we assume that also time is discretized then the dynamics can be described by a markov chain @xmath61 with @xmath62 .",
    "the evolution is specified by a transition probability matrix whose elements are @xmath63 and by an initial distribution @xmath64 .",
    "we consider a functional @xmath65 $ ] which is the sum of the local contributions to the current , an additive function of the transitions along the trajectory up to time @xmath5 : @xmath66 note that @xmath67 is , unlike the example in the introduction , a function of the position at _ two _ successive times .",
    "for instance if one considers particles diffusing on a one dimensional lattice and chooses @xmath68 to be @xmath69 depending on whether particles jump to the right or the left , @xmath24 is the time - integrated current flowing through the system from left to right .",
    "the partition function ( [ cu ] ) is given by @xmath70 just as in the previous section , we replace the initial evolution , given by a transition matrix @xmath71 , by a new evolution , given by a matrix @xmath72 .",
    "we may decompose this as a probability conserving transition matrix @xcite : @xmath73 and a cloning factor @xmath74 we then have @xmath75 the convenient way to simulate ( [ multi ] ) is to consider a cloning step of average factor @xmath76 followed by an evolution step with the transition matrix @xmath77 .",
    "the former may by implemented by substituting a given configuration by a number @xmath78 of equal clones , with expectation value of the number equal to @xmath76 , while the latter is a transition with probability @xmath77 .",
    "all in all , @xmath79 - the number of clones of in a configuration @xmath80 at time @xmath81 - evolves as @xmath82    this yields immediately that @xmath22 is given by the ratio between the average total population at time @xmath5 and the population at time @xmath83 ( at initial time every individual or clone has type distribution @xmath84 ) @xmath85 to cope with possible extinction or explosion of the initial population one works with increments @xcite @xmath86 this allows to keep the population size constant during a simulation ( with a uniform sampling after the cloning with average factor @xmath87 ) and the @xmath22 will be given by the products of all renormalization factors .",
    "there are many ways of implementing the diffusion monte carlo dynamics described by and , which have been extensively discussed in the literature  @xcite .",
    "for instance , one may choose to run the clones _ sequentially _ , rather than _ simultaneously _ , and use any cloning events as the starting point of new simulations  @xcite .",
    "this makes the algorithm easier to parallelize by reducing the overhead but the total number of clones is then harder to control .",
    "the exclusion process on a lattice consists of particles which jump to their neighboring sites at a given rate , conditioned to the fact that the arrival site is empty .",
    "the large deviations of the total particle currents of a periodic chain of @xmath88 sites with total asymmetry ( tasep ) was considered in @xcite : in this case only jumps to the right are allowed .",
    "the technique described above amounts to running various independent copies of the chain , but cloning a copy in configuration @xmath80 with an average rate proportional to @xmath89 \\label{crist}\\ ] ] the numerical results obtained for @xmath22 were compared to the analytic ones of ref .",
    "@xcite finding an excellent agreement with a very modest numerical effort .",
    "moreover the algorithm allowed to probe the configurations of the system which are responsible for anomalous small value of the current , the _ shocks _ , and , in the case of a moving shock , to follow the evolution of the second class particle which set the front of the shock .",
    "sites , @xmath90 and density @xmath91 .",
    "time evolution of a single clone .",
    "the shock is dense and does not advance .",
    "note the logarithmic scale on the @xmath92-axis . ]    in figure [ cinco ] we show a space - time diagram of the system with @xmath93 particles , density @xmath91 and @xmath90 .",
    "the simulation was done with @xmath94 clones , each of them initialized with random ( uniform ) occupancy numbers , such that the configuration had density @xmath91 .",
    "as predicted by the theory @xcite for this value of the density , the shock does not drift , although different initial conditions lead to different shock positions .",
    "figure [ uno ] shows the case @xmath95 , and density @xmath96 : we see that the shock has a net drift to the right , again as predicted by the theory .",
    "sites , @xmath95 and density @xmath96 .",
    "the shock drifts to the right . ]",
    "let us note here that the configuration corresponds to the end of the time - interval ; but one could have sampled one at an intermediate time as explained just below eq ( [ intermediate ] ) .",
    "the cloning algorithm has been applied for transport models such as the asymmetric exclusion process and the kipnis - marchioro - presutti model  @xcite and to study symmetries in fluctuations far from equilibrium  @xcite .",
    "such studies are useful as a test for the predictions of fluctuating hydrodynamics  @xcite , but also to probe the limits of the cloning method itself , when insufficient clone number may yield misleading results ( a test criterion has been devised in @xcite ) .",
    "many systems have dynamics that are naturally defined in continuous time .",
    "for instance , spin flips in the ising model , that takes the system from a configuration @xmath80 to another one @xmath92 , can occur at any time with a given rate @xmath97 .",
    "to simulate such systems , one can discretize time and the choose a small time step @xmath98 , ( transition probability writing @xmath99 ) .",
    "one then distinguishes between time steps during which a configuration change occurs ( with probability , say , @xmath100 ) and those where nothing happens ( with probability @xmath101 ) . doing this in the algorithm described in the previous sections , one arrives in the limit @xmath102 at a continuous time version of the cloning algorithm .",
    "one can however also work directly with continuous time simulations .",
    "each configuration @xmath80 has a total escape rate @xmath103 , which is the rate at which the system jumps from configuration @xmath80 to any other configuration .",
    "one can choose a time interval @xmath20 from an exponential clock , with probability @xmath104 $ ] , update the time @xmath105 , and then decide which configuration changes to make .",
    "going from @xmath80 to @xmath92 then occurs with _ probability _ @xmath106 .",
    "for traditional monte carlo algorithms , this method has two advantages .",
    "first , one does not have to decide which @xmath98 to use and the algorithm makes no discretization error .",
    "second , there are no rejection events which can slow down severely discrete time simulations .",
    "however all this comes at the cost of having to generate two random numbers per configuration change ( one for the time at which the change occurs , one for the target configuration ) while discrete time monte carlo only needs one .    when simulating rare events , the continuous time method is more cumbersome to implement but overcomes the problem of diversity of time scales typically met in these simulations .",
    "for instance , depending on the value of the bias @xmath107 , the tasep presented above explores trajectories where the average time between two events ranges from order @xmath108 ( in a traffic jam , only the leading particle can jump forward ) to order @xmath109 ( when all particles can jump forward ) . when working with continuous time , the adjustment of the time - step is automatic . in other systems , such as the kinetically constrained models presented in section  [ sec : activity ] ,",
    "the situation is even worse .",
    "a typical trajectory can explore successive configurations where the waiting times may change by a factor of the order of the system size .",
    "in such case , a discrete time algorithm with a time step small enough to resolve the rapid configuration changes will have a prohibitively large number of rejection events when visiting the slow configurations .",
    "to work directly in continuous time , as exposed in  @xcite , the idea is to write the dynamical partition function as a sum over allowed values of @xmath24 ( cfr eq ( [ f ] ) ) : @xmath110 where @xmath111 is the probability density of being in configuration @xmath80 at time @xmath5 , and having observed a value @xmath24 of the dynamical observable .",
    "the quantity @xmath112 is its laplace transform . as in ( [ questa ] )",
    ", we can choose @xmath24 to be the sum of contributions @xmath113 occurring at each configuration change .",
    "for instance , taking @xmath114 ( resp .",
    "@xmath115 ) each time a particle jumps to the right ( resp . left ) in a 1d particle system corresponds to @xmath24 being the total particle flux flowing through the system from right to left .",
    "we can also consider the case where @xmath24 depends on the time average of some observable @xmath116 , as in the introduction ( see  @xcite ) : @xmath117 where @xmath118 is the sequence of visited configurations of a given history presenting @xmath119 changes of configurations .",
    "@xmath116 can for instance be the magnetization of the configuration @xmath80 of a spin system and one is then looking for trajectories that have atypical _ time average _ of the magnetization .    from the equation of evolution obeyed by @xmath111 ,",
    "one obtains the evolution of  @xmath112 : @xmath120 which is of the form @xmath121 where @xmath122 is the vector of components @xmath112 .",
    "just as in eq ( [ eq2 ] ) , the modified operator of evolution @xmath39 does not conserve probability if @xmath123 .",
    "we have to proceed as in the steps leading to ( [ just ] ) and split the evolution in two contributions , one conserving probability and the other a purely cloning term . to do so we introduce the modified transition rates @xmath124 and the corresponding escape rate @xmath125 .",
    "we can then rewrite   as @xmath126   \\hat p(x,\\alpha , t)}_{\\text{cloning } } \\label{eq : evolhatpclone}\\end{aligned}\\ ] ]    the first part is a modified dynamics of rates @xmath127 while the second part corresponds to cloning at rate @xmath128 .",
    "the method is then the same as for discrete time dynamics ( section  [ subsec : discretetimecloning ] ) : one takes a large number of copies of the system , each of them evolving in continuous time ( i ) through the modified rates @xmath127 and ( ii ) subjected to a cloning probability @xmath129\\delta t}$ ] on each time interval @xmath130 where the configuration does not change from @xmath80  @xcite .",
    "one can rescale the total clone population to keep its size constant , storing as previously the overall cloning factor .",
    "the dynamical partition function is then recovered from those factors as in   and the corresponding dynamical free energy @xmath131 is : @xmath132 we provide in appendix  [ appendix - pseudo - code ] an example pseudo - code for the practical implementation of the algorithm .      , @xmath107 conjugated to the total current flowing through the system .",
    "system size is 400 , with 200 particles , in periodic boundary conditions , with an asymmetry @xmath133    exclusion processes ( such as the tasep studied above ) are interesting transport models in which the cloning algorithms can be used and in particular compared to analytical results for the cumulant generating function @xmath134  @xcite , including finite size effects  @xcite . in fig .",
    "[ fig : asepprofile ] , we present an example of a mean profile at non - zero @xmath107 for the asymmetric exclusion process ( compared to the tasep , particles can jump to the left and to the right with respective rates @xmath135 and @xmath136 ) .",
    "the parameter @xmath107 is conjugated to the particle flux through the system .",
    "we observe on fig .",
    "[ fig : asepprofile ] that , to minimize the overall current , the system develops an asymmetric profile , where only the front particles can jump easily .",
    "driven systems may reach a non - equilibrium _ steady state _ , characterized by a non - zero current the probability distribution of which can be studied as described in the previous section .",
    "another class of non - equilibrium systems is given by glassy systems .",
    "in the most simple cases , these systems are out of equilibrium not because they are driven but because their dynamics is so slow that a macroscopic system never reaches boltzmann equilibrium ( or any other steady state ) , despite the fact that the microscopic dynamics satisfy detailed balance . in this context",
    ", it can be interesting to study trajectories of atypical mobility , for instance to detect trajectories that are ` faster ' or slower than average , i.e. the dynamic heterogeneity . to quantify this , one introduces the _ dynamical activity _  @xcite ( also termed traffic  @xcite ) , which provides a good description of dynamical heterogeneity in glass models , as we now discuss .    on a time window @xmath137",
    "$ ] the dynamical activity @xmath119 of a stochastic process is the number of configuration changes undergone by the system , and is thus a random variable that depends on the system s trajectory .",
    "kinetically constrained models ( kcms ) , such as the fredrickson - andersen  @xcite or the kob - andersen@xcite models are such that static ( one - time ) properties are trivial in the most simple cases , while their dynamical properties ( _ e.g. _ two- or more times correlations ) share common features with generic glassy phenomena ( see  @xcite for reviews on kcms ) .",
    "they lend themselves rather easily for the study of their activity @xmath119 , and for the analysis of the results .",
    "let us focus for simplicity on the one - dimensional fredrickson - andersen ( fa ) model .",
    "it consists in a 1d lattice of @xmath138 sites .",
    "each site is either excited ( low density , active ) or unexcited ( high density , inactive ) .",
    "the sites may flip from inactive to active ( at rate @xmath139 ) , and from active to inactive ( at rate @xmath140 ) .",
    "these transitions are allowed on a given site provided at least one of the neighboring sites is active .",
    "this is the _ kinetic constraint _ , introduced as a way to mimic the facilitated dynamics of molecular glasses , whereby active regions enhance activity in their neighborhood .",
    "clearly , for small values of @xmath139 , the dynamics becomes very slow .",
    "it was observed in  @xcite that the fa model presents `` dynamical coexistence '' of active and inactive regions in space - time ( see fig .",
    "[ fig : spacetime - bubbles ] ) , very similar to the phase coexistence of liquid and solid at the coexistence point in a first order static phase transition    if one forgets that one direction in fig .",
    "[ fig : spacetime - bubbles ] is the time .",
    "the activity @xmath119 of a configuration is defined as the number of active sites . in practice",
    ", one may weight the trajectories followed by the system by a factor @xmath141 , to favor active ( @xmath142 ) or inactive ( @xmath143 ) histories ( in this section we take the convention @xmath144 to follow the notation in the literature on kcms ) .",
    "if the observed coexistence disappears for @xmath145 ( that is , if there is a dynamical phase transition ) , it means that the system indeed sits on a first - order dynamical coexistence point at @xmath146 .",
    "the continuous time cloning algorithm  @xcite exposed in section  [ subsec : continuous - time - cloning ] enables us to compute numerically the dynamical partition function @xmath147 for this system and other kcms  @xcite the average is taken on histories of duration @xmath5 , in the large @xmath5 limit , at fixed system size @xmath138 .",
    "the non - analyticities of the dynamical free energy @xmath148 in the large - size limit , signal the existence of a dynamical phase transition .",
    "( left ) and the density of occupied sites @xmath149 ( right ) for histories weighted by @xmath150 . as the system size increases ,",
    "@xmath151 approaches its singular limit where @xmath152 is zero for @xmath143 . in the same limit",
    ", the density @xmath149 displays a discontinuity at @xmath146 , indicating a first order dynamical transition . ]      as shown in  @xcite , several kcms display a phase transition , in the large system size limit , between an active phase ( @xmath153 ) where the dynamical free energy @xmath154 is finite , and an inactive phase ( @xmath143 ) where is identically zero ( see fig .  [",
    "fig : numerics_fa ] , left , for the 1d fa model ) .",
    "the mean density of active sites ( see appendix  [ appendix - pseudo - code ] for details on the practical computation of such a weighted mean ) @xmath155 ( here @xmath156 is the activity at site @xmath157 ) also characterizes this transition ( fig .",
    "[ fig : numerics_fa ] , right ) : it remains finite in the active phase @xmath153 ( a finite fraction of sites is active ) while it goes to zero in the inactive phase ( only a finite number of sites remains inactive ) .",
    "several other glass formers display the same phenomenology ( see  @xcite for a review ) , representative of dynamical heterogeneities , that is , of the coexistence in the system of regions with high and low dynamical activity .",
    "an interesting question is to determine whether molecular models of glasses , such as lennard jones mixtures , also present such a dynamical phase transition . a conceptual difficulty that arises is to find a physically relevant measure of the mobility , that generalizes the concept of dynamical activity to this context . in  @xcite",
    ", the activity was defined as the number of events where particles move sufficiently far in a given time - interval , thus averaging out short - scale vibrations , whereas in @xcite , the activity was taken to be a time - average of the modulus of the forces , in a continuous version of the model . in both approaches , numerical results support the existence of a phase transition at some critical value @xmath158 . an open issue is to characterize the inactive phase and to determine whether the effective finite - size critical transition parameter @xmath159 goes to @xmath83 as @xmath138 goes to infinity or not ( that is to say : does the standard dynamics at @xmath146 lie exactly at the critical point ? ) .",
    "more generically , the phase transitions are also present in @xmath135-spin models  @xcite and in trap models  @xcite , where numerical approach support analytical results .",
    "these results are in favor of a generic link between glassiness and dynamical phase coexistence , whose precise nature remains to be understood .",
    "as explained in the previous section , large deviation theory plays nowadays an important role in non - equilibrium statistical physics to study and quantify dynamical phase transitions .",
    "the first studies of large deviations of dynamical observables were however inspired by another field , that of dynamical systems .",
    "it was argued in the 70s , following the seminal works of sinai , ruelle , bowen and others  @xcite that quantitative studies of dynamical systems should rely on a construction analogous to statistical mechanics of trajectory space , where the quantities playing the role of energy functionals for the trajectories are functions of the lyapunov exponents .",
    "this line of thought was very successful in terms of formalism and theory , but progress was severely hampered by the difficulty of computing anything in all but the most schematic systems . indeed ,",
    "many of the examples studied very low dimensional systems  mostly maps of the interval , with notable exception of the lorenz gas  @xcite .",
    "as we show in the two following sections , the development of recent methods to compute the fluctuations of lyapunov exponents can fill this gap and hopefully lead to new insights in the field of dynamical systems of _ many _ bodies .    for sake of concreteness",
    ", we will focus on hamiltonian dynamics but one should keep in mind that the method is much more general and can be applied , for instance , to dissipative systems .",
    "we consider a system with @xmath160 degrees of freedom whose dynamics is given by @xmath161;\\quad\\mbox{with }    \\begin{cases }      { \\bf x}=(q_1,\\dots , q_n , p_1,\\dots , p_n)&\\\\      { \\bf f}=(\\frac{\\partial h}{\\partial p_1},\\dots,\\frac{\\partial h}{\\partial p_n},-\\frac{\\partial h}{\\partial { q_1}},\\dots,-\\frac{\\partial h}{\\partial { q_n } } ) &     \\end{cases}\\ ] ] as usual to quantify the chaoticity of a trajectory we introduce the lyapunov exponents .",
    "we consider an infinitesimal perturbation @xmath162 whose dynamics reads @xmath163}{\\partial x_j}\\ ] ]    the evolution of the norm of such a perturbation is given by @xmath164 introducing the normalized tangent vectors @xmath165 whose evolutions are given by @xmath166 equation can be recast as @xmath167 and finally solved to yield @xmath168 v_j(t ' ) { { \\rm{d } t}}'}\\ ] ] the largest lyapunov exponent is then given by @xmath169 , where the finite time lyapunov exponent @xmath170 is @xmath171 v_j(t')\\big\\}\\ ] ] more generally , the exponential expansion of @xmath172-dimensional volume elements , rather that vectors @xmath173 , yields in a similar way the sum of the first @xmath172 lyapunov exponents .    to characterize the fluctuations of chaoticity amounts to sampling the distribution of @xmath170",
    "@xmath174 one can understand that the exponent is generically extensive in time , as in usual thermodynamic systems : one cuts a long trajectory of duration @xmath5 in many segments of duration @xmath20 much larger than the typical correlation time @xmath175 .",
    "each segment can thus be considered independent of the others and the probability that the total trajectory has an exponent @xmath176 is @xmath177 the exponent of each term of the r.h.s . is the sum of @xmath178 terms of order one and is thus of order @xmath5 . at large times , @xmath179 , the distribution @xmath180 concentrates around its typical value , and the scaling law ( [ eqn : ldfpi ] ) is thus verified .",
    "this scaling breaks down in the presence of diverging correlation times , a signature of dynamical phase transitions .    as in statistical mechanics ,",
    "the derivation of the entropy @xmath181 is difficult and one rather works in a `` canonical '' ensemble by introducing a dynamical partition function @xmath182 where the average @xmath183 is made with respect to @xmath180 , i.e. over initial conditions , noise realizations , etc .",
    "@xmath131 plays the role of @xmath184 in statistical mechanics , where @xmath24 is a free energy , and is called topological pressure .    from the definition of the finite time lyapunov exponent , one sees that the computation of @xmath22 amounts to the large deviation computation presented in the introduction , with the observable @xmath185 now given by @xmath186    let us now make a point that will be valid for all deterministic systems",
    ". in such cases , the only source of fluctuations are the initial conditions .",
    "if the system is chaotic enough , this should not be very important but , for example , in the case of mixed system , starting from a regular island or a chaotic region yields a very different result , because trajectories do not take from one to the other . in this review",
    "we consider a shortcut to this problem which consists of adding a small amount of stochastic noise , so that the dynamics effectively samples the whole trajectory space ( for a discussion of the low noise limit see @xcite ) .",
    "we thus consider a slightly different set of equations @xmath187    the algorithm presented in the introduction of this paper can now be applied to our noisy hamiltonian dynamics .",
    "we consider a population of @xmath188 clones in phase space of positions and momenta @xmath189 and @xmath190 . to each clone",
    "we associate a normalized tangent vector @xmath191 .",
    "we then choose a time step @xmath192 and a noise intensity @xmath193 and run the simulation over a large time @xmath194 . at @xmath195 , the @xmath188 copies of the system start from an arbitrary initial configuration ( the noise ensures the ergodicity of the algorithm ) .",
    "at each time step @xmath196 , we do the following  @xcite :    * for each clone * * @xmath197 evolve with the noisy hamiltonian dynamics ( [ eqn : hamequabruit ] ) , * * @xmath191 evolves according to the linearized dynamics @xmath198 * * @xmath191 is then renormalized to unity and we store the renormalization factor @xmath199 . * each clone of the system is then pruned or replicated , with its rate @xmath200 . to do so",
    ", we pull a random number @xmath193 uniformly between 0 and 1 and we compute is the largest integer smaller than @xmath80 ] @xmath202 , * * if @xmath203 , the clone is deleted * * if @xmath204 , we create @xmath205 copies of the clone * the total population is now composed of @xmath206 clones , instead of the initial @xmath207 ones .",
    "we then store @xmath208 , * * if @xmath209 , we copy @xmath210 clones , chosen at random , * * if @xmath211 , we delete @xmath212 clones , chosen at random , + finally , we end up again with @xmath213 clones .    the dynamical partition function",
    "is then obtained from @xmath214 through @xmath215 while the topological pressure is given by @xmath216 let us now illustrate this algorithm , called `` lyapunov weighted dynamics '' , with a low dimensional system ( the standard map ) and a large dimensional one ( a fpu chain of 1024 particles ) .    * .",
    "phase space trajectories of the standard map are shown in light red whereas the trajectories localized by the lyapunov weighted dynamics appear in dark blue . ]    * .",
    "phase space trajectories of the standard map are shown in light red whereas the trajectories localized by the lyapunov weighted dynamics appear in dark blue . ]",
    "@xmath217    @xmath218      the standard map is defined by the dynamics @xmath219 with @xmath220\\times[-1,1]$ ] .",
    "it is one of the traditional models used to study transition to chaos .",
    "it goes from an integrable system when @xmath221 to a more and more chaotic one when @xmath172 increases . in figure",
    "[ fig : standardmap1 ] we show the typical trajectories that are localized by the lyapunov weighted dynamics for very small bias ( @xmath222 ) .",
    "one sees that as soon as the system is biased in favor of integrable trajectories ( @xmath223 ) , the dynamics localizes on integrable islands , whereas a tiny bias favoring chaotic trajectories ( @xmath224 ) detects the chaotic layers surrounding these islands .",
    "( red crosses ) and average lyapunov exponent @xmath225 ( blue squares ) as a function of the bias @xmath107 .",
    "the discontinuity at @xmath226 of @xmath227 is the signature of a phase coexistence between chaotic and integrable trajectories in space time . ]",
    "computing the topological pressure ( figure  [ fig : standardmap2 ] ) shows that the system lies at a critical point where chaotic and integrable trajectories coexist in phase space , in the manner of a first order phase transition .      beyond the computation of dynamical free energies ( or topological pressure ) , the algorithm can be used to sample trajectories of atypical chaoticity .",
    "let us show here on a high - dimensional system , with 2048 degrees of freedom , which are the trajectories that realize large deviations of the chaoticity in anharmonic chains of oscillators .",
    "we consider the following hamiltonian @xmath228\\ ] ] where @xmath229 .",
    "this system , studied in the 50s by fermi , pasta , tsingou and ulam , corresponds to @xmath88 particles connected by anharmonic springs .",
    "the limit @xmath230 corresponds to an integrable case : the springs are harmonic and the fourier modes correspond to @xmath88 independent harmonic oscillators or frequencies @xmath231 there has been continuous interest in this model ( for a review see  @xcite ) because of its rich phenomenology , and in particular , there has been some recent studies of the ( gaussian ) fluctuations of its lyapunov exponent @xcite .",
    "as soon as @xmath232 is non - zero , the dynamics are chaotic . however , starting from well chosen initial conditions , the model admits long - lived solitonic modes , related to the korteweg - de  vries modified equation  @xcite .",
    "similarly , a modulational instability leads to short - lived chaotic breathers  @xcite , when energy is injected in high - frequency modes .",
    "if one runs an equilibrium simulation of the anharmonic chain , one typically observes a mixture of short - lived localized structures ( solitons , breathers ) and a phonon bath ( figure [ fig : fpuequilibre ] ) .",
    "when applying the lyapunov weighted dynamics , we add a small stochastic noise to the system , taking care that the noise conserves the total energy and momentum and thus preventing a slow , unphysical drift in these quantities .    ) * .",
    "time - line of each of the 128 particles around their [ arbitrary ] equilibrium positions .",
    "we see a superposition of localized breathers , ballistic solitons and small fluctuations . ]",
    "if one biases the system in favor of regular trajectories , the phonons and breathers completely disappear and we observe a long - lived gas of solitons , propagating ballistically ( see figure  [ fpuregular ] ) . in this case , it is important to set the center of mass velocity to zero , because otherwise the system can eliminate completely chaoticity by concentrating all its energy on the center of mass motion .    ) .",
    "* simulation at fixed energy ( @xmath233 ) with fixed boundary conditions , starting from microcanonical equilibrium .",
    "the figure shows the time - line of each particles around its [ arbitrary ] equilibrium position .",
    "several solitons are ballistically propagating from one end of the system to the other , where it elastically bounce of fixed boundary condition .",
    "the lyapunov exponent of this trajectory is equal to half the average one . ]    on the other extreme , a bias in favor of chaotic trajectories localizes long - lived chaotic breathers ( see figure [ fpubreathern128 ] ) .",
    "we used periodic boundary conditions for this simulation to reduce the interactions between the wandering breather and the boundaries of the system .",
    "note that running the same simulation in a much larger system ( n=1024 ) shows that the breathers are much more localized than the solitons ( figure [ fpubreathern1024 ] ) .    )",
    "* this simulation is realized at fixed energy and total momentum ( energy density @xmath233 ) with periodic boundary conditions .",
    "the gray level represent the total energy of each particles . starting from an equilibrium configuration ,",
    "the dynamics reveals a chaotic breathers whose lyapunov exponent is three time larger than the average one . ]",
    "interestingly , the values of the bias @xmath107 we have to use here are not of order one .",
    "indeed , as @xmath88 increases , the distribution of the largest lyapunov exponent becomes more and more peaked .",
    "let us assume for instance that @xmath181 is extensive with some power of the system size , so that one can write @xmath234\\ ] ] with @xmath235 of order 1 in both @xmath5 and @xmath88 . from the expression @xmath236\\ ] ]",
    "one sees that the integral is dominated by a value @xmath237 such that : @xmath238 when @xmath239 , @xmath237 satisfies @xmath240 and is thus the typical value of the lyapunov exponent . one",
    "should thus use a bias that scales as @xmath241 to observe large deviations of the lyapunov exponents . similarly , to access the dynamical free energy , one has to compute the exponent @xmath242 and define @xmath243 such a calculation , which , as far as we know , has not been done so far , would tell if the fpu chain lies at a critical point where breathers , solitons and phonons coexist in a first order phase transition manner .",
    "the computation of the dynamical free energy for large dimensional systems is now achievable numerically and is one of the exciting goal that are facing us .    )",
    "this simulation is realized at fixed energy and total momentum ( energy density @xmath233 ) with periodic boundary conditions .",
    "the gray level represent the total energy of each particles . ]",
    "when a system is subjected to an external drive , the total energy absorbed ( and the resulting entropy production ) , are quantities that fluctuate depending on the initial microscopic configuration of the system and on the thermal bath , if there is one .",
    "work and entropy production are important quantities , because they concern the state of the system and are the subject of the second law of thermodynamics .",
    "the second law as such concerns only average quantities , and not the fluctuations .",
    "it was only relatively recently realized that a wider framework  based on considering the effect of time - reversal on the dynamics  allows to derive a set of relations that are obeyed by the fluctuations ",
    "well beyond the linear regime  and yields the second law constraints as particular cases .    _",
    "i ) _ the _ transient _ fluctuation theorem relates , in the same context , the probability of a given work @xmath244 , and that of its opposite : @xmath245 @xcite .    _",
    "ii ) _ the jarzynski relation states that the average of @xmath246 over all processes starting from an equilibrium distribution at temperature @xmath247 is _ one _ @xcite .",
    "both are very general , model - independent results , and were later shown to be particular cases of the more general relation , crooks relation .",
    "_ iii ) _ the _ stationary _ fluctuation theorem involves the same relation for the work as the transient version , in a stationary ( non - equilibrium ) situation , and is valid only in the limit of large times .",
    "the particular case in which the dynamics is deterministic ( the gallavotti - cohen theorem @xcite ) deserves special attention : the theorem is non trivial because the nature of the stationary distribution is then dependent upon the ergodicity properties of the system .",
    "these conditions involve not only chaoticity properties of the attractor , as one would expect from any problem in ergodic theory , but also the fact that attractor and repellor sets are sufficiently intertwined : large deviation trajectories that commute between them generate the reversals in entropy production @xcite .",
    "systems with macroscopic , _ hydrodynamic _ degrees of freedom may have extremely large fluctuations when subjected to strong forcing , due to excitation of macroscopic structures @xcite .",
    "the typical example is the ( rayleigh - bnard ) convection of a fluid between a hot @xmath248 lower plate and a colder @xmath249 top plate @xcite .",
    "the heat is transported by fluid currents that have macroscopic fluctuations , enormous compared with @xmath250 . the fluctuation theorem as such involves the temperatures @xmath251 that are irrelevant for these fluctuations . the only way in which the appearance of a fluctuation relation for the hydrodynamic modes may be justified , is to invoke the existence of a large _ effective temperature _ , related to the macroscopic fluctuations .",
    "bonetto and gallavotti @xcite have conjectured that this could be justified by considering the restricted space in which the macroscopic takes place .",
    "these questions are very much open , and in order to make progress it would be useful to simulate the limits beyond which the fluctuation theorem ceases to hold rigorously , because that is where new concepts may arise .",
    "these are the limits in which large deviations are particularly hard to observe , if one has to wait for them to happen spontaneously .",
    "the method of cloning has been shown to work efficiently in the verification of the gallavotti - cohen theorem on a simple chaotic system given by the sinai billiard .",
    "this system consists of a particle moving inside a billiard as in figure [ tres ] , with periodic boundary conditions .",
    "it is under the action of a force field @xmath252 , and is subject to a deterministic thermostat that keeps the velocity modulus constant @xmath253 . between bounces , the equations of motion",
    "are : @xmath254    .",
    "we also show an example of trajectory for the external field @xmath255 . ]",
    "we wish to calculate the fluctuations of the dissipated power @xmath256 and thus the dynamical partition function @xmath257 the fluctuation theorem arises from the symmetry @xmath258 with @xmath259 . therefore with reference to the notation of the first section we have now @xmath260 as in the previous section , the dynamics is deterministic , and hence to allow different clones to diversify , we introduce a small stochastic noise , ( cfr paragraph leading to equation ) and check the stability of results in the limit of small noise .",
    "we evolve the system for macroscopic intervals @xmath261 , and clone at time @xmath262 with a factor @xmath263 before each deterministic step of time @xmath261 , clones are given random kicks of variance @xmath264 in position and/or velocity direction .",
    "the time - interval @xmath261 and the noise intensity @xmath264 are chosen so that twin clones have a chance to separate during time @xmath261 , and this depends on the chaotic properties of the system . in the present case",
    ", @xmath265 allows for a few collisions , which guarantees clone diversity for @xmath266 .    in fig .",
    "[ cuatro ] we show the results of @xmath131 for @xmath267 , and for @xmath268 with @xmath233 and @xmath269 , both corresponding to very large current deviations ( in the figure @xmath107 is called @xmath176 ) .     vs.  @xmath176 for the driven lorentz gas .",
    "data for @xmath270 , @xmath271 and noise intensity @xmath272 .",
    "the gallavotti - cohen theorem implies the symmetry around @xmath273 .",
    "the continuous lines represents a polynomial fit , quadratic for @xmath233 ( gaussian behavior ) , 4-th order for @xmath269 . ]",
    "planetary systems are the epitome of deterministic systems . with their relatively small number of interacting bodies",
    ", they could easily be considered the systems that are further from statistical treatment . and",
    "yet , statistical analysis of orbits becomes necessary : when we discover a planetary system we find that many amongst the observationally allowed configurations are only stable in the immediate past or future @xcite .",
    "since we do not expect that just by chance we came across a system that has just ejected ( or will soon eject ) a planet , we tend to favor amongst configurations compatible within error with the data , those that have an unusually high level of stability .    on a related line",
    ", it has been shown @xcite that just considering a shift in the earth s present position of the order of one hundred meters , the fate of mercury may change dramatically , in some cases leading its orbit to intersect the one of venus . consider for example the study by laskar @xcite . in a first calculation , he integrated the orbit of mercury starting from different configurations , obtained by displacing the position of the earth by about @xmath274 _ meters_. the orbits obtained this way were qualitatively similar , and yet different .",
    "next , he repeated the calculation but making a few clones of the trajectories , and choosing the one with largest eccentricity .",
    "after a few such steps , he reached orbits with great eccentricities , that could cross the orbit of venus .",
    "we recognize here a strategy that is very close to the one we are describing here , for the particular cases @xmath226 and @xmath275 , respectively .",
    "the small displacements are in fact playing the role of our noise .    indeed , if at each cloning step we had cloned or killed configurations in a fraction proportional to @xmath107 times the eccentricity change during the corresponding time interval ( cfr .",
    "section 3 : the eccentricity plays here the role of @xmath42 described there ) we would have obtained the full probability distribution of , say , the eccentricity at each time .",
    "denote @xmath276 the total number of clones at time @xmath5 obtained without normalizing the clone population , or keeping track of the normalizations if they were done .",
    "@xmath276 is the laplace transform of the probability @xmath277 : @xmath278 just as in the example of sinai s billiard , because the system is chaotic , the displacements ( or the noise level ) , may be essentially negligible  for example , compatible with all other external sources of displacements which we have neglected  and yet yield all the variety of trajectories",
    ".    it would be very interesting to see these methods applied to studying in detail the possible future and past evolution of planetary systems , with a large deviation statistical analysis .",
    "many interesting questions concerning the self - organization of the stability of our solar system could be investigated this way .",
    "in this appendix we provide an example pseudo - code for the cloning of a system described by a configuration ` conf ` , evolving with markov dynamics in continuous time ( see section  [ subsec : continuous - time - cloning ] ) .",
    "the dynamics of each clone consists in a succession of ( i ) poissonian waiting times ( sampled with the function ` random.poisson ` ) between jumps ( ii ) change of configuration , or `` jumps '' ( performed by ` evolve ( ) ` ) and ( iii ) cloning , keeping the total number of clone constant .",
    "the way in which the weighted average of a time - extensive observable ` obs ` is computed is also explicited : a value of ` obs ` is attached to each clone and copied / pruned with it .    ....",
    "# parameter conjugated to the observable f n=500               # number of clones time=0              # initial time tmax=1000           # maximum simulation time cloning=0           # logarithm of the global cloning factor                      # at the end the ldf is given by cloning / time   conf.init ( )         # initialization of the clones :                     #    conf[1 ] to conf[n ] are set to given configurations escaperate.init",
    "( )   # initialization of the alpha - dependent escape rates obs.init ( )          # initialize an observable obs that we want to average                      # over weighted histories        while t < tmax do    ( c , t)=next(jumptime )     # returns the first clone c to jump , and its jumptime t    conf[c].evolve ( )         # evolves the configurations clone c                            # note that the observable obs is evolved accordingly    deltat = random.poisson(escaperate[c ] )                            # determines the time interval until the next jump    jumptime[c]+=deltat      # updates the jumptime    k = conf[c].clfact(deltat ) # yields the cloning factor                             #   k = e^(deltat*(deltaescaperate[c]+alpha*a[c ] ) )    cloning+=log((n+k-1)/n ) # updates the log of the global cloning factor        cases      k=0 : # clone c is suppressed , i.e. replaced by another one chosen at random        do newc = random.integer(n ) while newc==c        conf[c]=conf[newc ]        obs[c]=obs[newc ]        jumptime[c]=jumptime[newc ]      k=1 : # nothing is done      k>1 : # k-1 copies of c have to be done ; then , among the total n+k-1            # resulting clones , k-1 of them are pruned so as to keep n constant        indices = randomarray(n , k )           # puts in indices   k-1 * different * random integers between 1 and nclones+k-1            # ( both included ) ; only those less or equal than n will be replaced by c        for newc in indices do :           if newc<=n do :              conf[newc]=conf[c ]              obs[newc]=obs[c ]              jumptime[newc]=jumptime[c ]"
  ],
  "abstract_text": [
    "<S> atypical , rare trajectories of dynamical systems are important : they are often the paths for chemical reactions , the haven of ( relative ) stability of planetary systems , the rogue waves that are detected in oil platforms , the structures that are responsible for intermittency in a turbulent liquid , the active regions that allow a supercooled liquid to flow ... simulating them in an efficient , accelerated way , is in fact quite simple .    </S>",
    "<S> in this paper we review a computational technique to study such rare events in both stochastic and hamiltonian systems . </S>",
    "<S> the method is based on the evolution of a family of copies of the system which are replicated or killed in such a way as to favor the realization of the atypical trajectories . </S>",
    "<S> we illustrate this with various examples . </S>"
  ]
}