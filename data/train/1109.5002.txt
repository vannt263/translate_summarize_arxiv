{
  "article_text": [
    "we introduce a new efficient algorithm for the _ phylogenetic tree reconstruction _ ( ptr ) problem which rigorously accounts for insertions and deletions .",
    "_ _ phylogenetic background.__a _ phylogenetic tree _ or _",
    "phylogeny _ is a tree representing the speciation history of a group of organisms .",
    "the leaves of the tree are typically existing species .",
    "the root corresponds to their _ most recent common ancestor _",
    "each branching in the tree indicates a speciation event .",
    "it is common to assume that dna evolves according to a markovian substitution process on this phylogeny .",
    "under such a model , a _ gene _ is a sequence in @xmath0 . along each edge of the tree",
    ", each site independently mutates according to a markov rate matrix .",
    "the length of a branch is a measure of the amount of substitution along that branch .",
    "the precise definition of a branch length depends on the model of evolution . for roughly",
    "constant mutation rates , one can think of the branch length as proportional to the amount of time elapsed along a branch .",
    "the ptr problem consists of estimating a phylogeny from the genes observed at its leaves .",
    "we denote the leaves of a tree by @xmath1 = \\{1,\\ldots , n\\}$ ] and their sequences by @xmath2 .",
    "the model of sequence evolution above is simplistic : it ignores many mutational events that dna undergoes through evolution . at the gene level ,",
    "the most important omissions are insertions and deletions of sites , also called _ indels_. stochastic models taking indels into account have long been known  @xcite , but they are not widely used in practice ( or in theory ) because of their complexity . instead , most practical algorithms take a two - phase approach :    _ multiple sequence alignment . _",
    "site @xmath3 of sequence @xmath4 and site @xmath5 of sequence @xmath6 are said to be _ homologous _ if they descend from the same site @xmath7 of a common ancestor @xmath8 ( not necessarily the mrca ) _ only through substitutions_. in the _ multiple sequence alignment _",
    "( msa ) problem , we seek roughly to uncover the homology relation between @xmath2 .",
    "typically , the output is represented by a matrix @xmath9 of @xmath10 aligned sequences of equal length with values in @xmath11 .",
    "each column of the matrix corresponds to homologous sites .",
    "the state @xmath12 is called a _ gap _ and is used to account for insertions and deletions .",
    "for instance , if sequence @xmath13 does not have a site corresponding to @xmath7 in @xmath8 above , then a gap is aligned with positions @xmath3 of @xmath4 and @xmath5 of @xmath6 ( which belong to the same column ) .",
    "_ phylogenetic tree reconstruction . _ the matrix @xmath9 is then cleaned up by removing all columns containing gaps .",
    "let @xmath14 be this new matrix .",
    "a standard ptr algorithm is then applied to @xmath14 .",
    "note that substitutions alone suffice to explain @xmath14 .",
    "traditionally , most of the research on phylogenetic methods has focused on the second phase .",
    "in fact , current theoretical analyses of ptr assume that the msa problem has been solved _",
    "perfectly_. this has been a long - standing assumption in evolutionary biology .",
    "but this simplification is increasingly being questioned in the phylogenetic literature , where it has been argued that alignment heuristics often create systematic biases that affect analysis  @xcite .",
    "much recent empirical work has been devoted to the proper joint estimation of alignments and phylogenies @xcite . here",
    "we give the first analysis of an efficient , provably consistent ptr algorithm in the presence of indels .",
    "our new algorithm suggests that a rough alignment suffices for an accurate tree reconstruction ( bypassing the computationally difficult multiple alignment problem ) .",
    "_ _ theoretical properties of ptr.__in addition to computational efficiency , an important theoretical criterion in designing a ptr algorithm is the so - called _ sequence - length requirement _ ( slr ) .",
    "at a minimum , a reconstruction algorithm should be _ consistent _ , that is , assuming a model of sequence evolution , the output should be guaranteed to converge on the true tree as the sequence length @xmath15 ( the number of _ samples _ ) goes to @xmath16 @xcite . beyond consistency ,",
    "the sequence - length requirement ( or convergence rate ) of a ptr algorithm is the sequence length required for guaranteed high - probability reconstruction .",
    "the slr is typically given as an asymptotic function of @xmath10 , the number of leaves of the tree . of course",
    ", it also depends on the substitution parameters .",
    "a classical result due to erds et al .",
    "@xcite states that , for general trees under the assumption that all branch lengths are bounded by constants , the so - called short quartet method ( sqm ) has @xmath17-slr .",
    "the sqm is a particular ptr algorithm based on estimating evolutionary distances between the leaf taxa , that is , the sum of the branch lengths between species .",
    "such algorithms are known as _ distance - based methods_. the basic theoretical result behind distance - based methods is the following : the collection of pairwise evolutionary distances between all species forms a special metric on the leaves known as an additive metric ; under mild regularity assumptions , such a metric _ characterizes _ the underlying phylogeny interpreted as an edge - weighted tree , that is , there is a one - to - one correspondence between additive metrics and phylogenies ; moreover , the mapping between them can be computed efficiently @xcite .    _ _ a new approach.__in the classical theoretical setting above where the msa problem is assumed perfectly solved ( we refer to this setting below as the essw framework ) , the evolutionary distance between two species is measured using the hamming distance ( or a state - dependent generalization ) between their respective sequences .",
    "it can be shown that after a proper correction for multiple substitutions ( which depends on the model used ) the expectation of the quantity obtained does satisfy the additive metric property and can therefore serve as the basis for a distance - based ptr algorithm .    moving beyond the essw framework ,",
    "it is tempting to account for indels by simply using edit distance instead of the hamming distance .",
    "recall that the _ edit distance _ or _",
    "levenshtein distance _ between two strings is given by the minimum number of operations needed to transform one string into the other , where an operation is an insertion , deletion or substitution of a single character .",
    "however , no analytical expression is known for the expectation of edit distance under standard indel models and computing such an expression appears difficult ( if at all possible ) . an alternative idea is to compute the _ maximum likelihood estimator _ for the time elapsed between two species given their sequences .",
    "but this involves solving a nonconvex optimization problem and the likelihood is only known to be efficiently computable under a rather unrealistic assumption known as reversibility  @xcite ( see below ) .",
    "we use a different approach .",
    "we divide the sequences into quantile blocks ( the first @xmath18 , the second @xmath18 , etc . ) .",
    "we show that by appropriately choosing @xmath19 above we can make sure that the blocks in different sequences essentially `` match '' each other , that is , they are made of mostly homologous sites .",
    "we then compare the state frequencies in matching blocks and build an additive metric out of this statistic . as we show below",
    ", this is in fact a natural generalization of the hamming estimator of the essw framework .",
    "however , unlike the hamming distance which can easily be analyzed through standard concentration inequalities , proving rigorously that our approach works involves several new technical difficulties .",
    "our analysis relies on a branching process analysis of the site displacements .",
    "we give a quick proof sketch after the formal statement of our results in section  [ secresult ] .",
    "the results described here were first announced without proof in the special case of ultrametric trees under the cfn model with inverse logarithmic indel rates  @xcite . here",
    "we give full proofs of stronger results , including extensions to bounded - rate trees under gtr models .",
    "_ _ related work.__for more background on models of molecular evolution and phylogenetics , see , for example ,  @xcite . following the seminal results of  @xcite ,",
    "there has been much work on sequence - length requirement , including @xcite .",
    "the multiple sequence alignment problem as a combinatorial optimization problem ( finding the best alignment under a given pairwise scoring function ) is known to be np - hard  @xcite .",
    "most heuristics used in practice , such as  @xcite , mafft  @xcite and muscle  @xcite , use the idea of a guide tree , that is , they first construct a very rough phylogenetic tree from the data ( using , e.g. , edit distance as a measure of evolutionary distance ) , and then recursively construct local alignments produced by `` aligning alignments . ''    to our knowledge , little theoretical",
    "work has been dedicated to the joint estimation of alignments and phylogenies , with the exception of thatte  @xcite who gave consistency results for the reversible case in the limit where the deletion - to - insertion ratio tends to 1 .",
    "however , no sequence - length requirement is obtained in  @xcite . in recent related work",
    ", the problem of reconstructing ancestral sequences in the presence of indels was considered  @xcite .",
    "a _ phylogeny _ is represented by a binary tree @xmath20 , whose leaves @xmath21 correspond to extant species , and whose bifurcations denote evolutionary events whereby two new species are generated from an ancestor .",
    "the root of the phylogeny , denoted by @xmath22 , represents the common ancestor of all the species in the phylogeny , and we assume that all edges of @xmath23 are directed away from @xmath22 ; so , if @xmath24 is a branch of the phylogeny , @xmath8 is the _ parent _ of @xmath25 and @xmath25 is the _ child _ of @xmath8 .",
    "moreover , if @xmath26 is in the subtree of @xmath23 rooted at @xmath8 , we call @xmath26 a _ descendant _ of @xmath8 and @xmath8 an _ ancestor _ of @xmath26 .    along each branch of the phylogeny , the genetic material of the parent species is subject to modifications that produce the genetic material of its child species .",
    "a  common biological assumption is that the genetic material of each species @xmath8 can be represented by a binary sequence @xmath27 of length @xmath28 over a finite alphabet  for ease of presentation , we work with a binary alphabet @xmath29 ( but see section  [ secextensions ] for extensions to richer alphabets)and that the changes to which @xmath30 is subjected along the branch @xmath24 are described by a markov process .",
    "in particular , the markov property implies that , given the sequence @xmath30 of @xmath8 , the sequence @xmath31 is independent of the sequences of the species outside the subtree of @xmath23 rooted at @xmath8 .",
    "a simplifying assumption commonly used in phylogenetics is that all species have sequences of the same length and , moreover , that every _ site _",
    ", that is , every coordinate , in their sequences evolves independently from every other site .",
    "in particular , it is assumed that , along each branch @xmath24 of the phylogeny , every site @xmath32 of the sequence @xmath30 is flipped with probability @xmath33 to the value @xmath34 independently from the other sites .",
    "this model is known as the cavender ",
    "neyman ( cfn ) model .",
    "a simple generalization to @xmath35 is known as the jukes  cantor ( jc ) model ( see , e.g. ,  @xcite ) .      in this paper",
    ", we consider a more general evolutionary process that accounts for the possibility of insertions and deletions .",
    "our model is similar to the original tkf91 model  @xcite , except that we do not enforce reversibility . in our model ,",
    "every edge @xmath24 of the phylogeny is characterized by a quadruple of parameters @xmath36 , where @xmath37 is the evolutionary time between the species @xmath8 and @xmath25 , and @xmath38 , @xmath39 and @xmath40 are , respectively , the _ substitution _ , _ deletion _ and _ insertion _ rates .",
    "the markov process by which the sequence at @xmath25 is obtained from the sequence at @xmath8 is defined below ( see , e.g. ,  @xcite for background on continuous - time markov processes ) .",
    "[ defevolutionaryprocessbranch ] given an edge @xmath24 , with parameters @xmath41 , the sequence @xmath31 at @xmath25 is obtained from the sequence @xmath30 at @xmath8 according to the following markov process :    1 .",
    "intialize @xmath42 , @xmath43 and @xmath44 ( where @xmath45 is the remaining time on the edge @xmath46 ) .",
    "while @xmath47 : * ( _ timing of next event _ ) let @xmath48 , @xmath49 be exponential random variables with rate @xmath40 , @xmath50 exponential random variables with rate @xmath39 and @xmath51 exponential random variables with rate @xmath38 ; suppose that these random variables are mutually independent and let @xmath52 be their minimum ; * if @xmath53 , the process ends at @xmath54 ; otherwise : * * ( _ insertion _ ) if @xmath55 , insert a new site whose value is chosen uniformly at random from @xmath56 between the sites @xmath57 and @xmath58 of @xmath31 ; * * ( _ deletion _ ) if @xmath59 , delete the site @xmath60 from @xmath31 ; * * ( _ substitution _ ) and if @xmath61 , replace @xmath60 by @xmath62 ; + ( if @xmath63 , then @xmath57 is undefined and , if @xmath64 , then @xmath65 is undefined . ) * ( _ remaining time _ ) update @xmath31 according to these changes , and update @xmath66 to reflect the new sequence length ; set the remaining time @xmath67 .    in words ,",
    "the evolutionary process defined above assumes that every site of the sequence @xmath30 of the parent species is , independently from the other sites , subjected to a sequence of evolutionary events that flip its value ; these events are distributed according to a poisson point process of intensity @xmath38 in the time interval @xmath68 $ ] .",
    "however , the site may get deleted and therefore not be inherited by the sequence of the node @xmath25 ; this is determined by whether an exponential random variable of rate @xmath39 is smaller than @xmath37 .",
    "while each site of the parental sequence @xmath30 is subjected to this process , new sites are introduced in the space between existing sites at rate  @xmath40 , and each of these sites follows a similar process for the remaining time .",
    "in essence , insertion and deletion events are governed by an independent branching process for each ancestral site .",
    "note further that the order of the sites , as described above , also plays a role .",
    "unlike  @xcite , we do not use an `` immortal link '' and we do not assume that the length process is at stationarity .",
    "our techniques can also be applied to the @xmath69 model without much modifications .",
    "we leave the details to the reader .",
    "given the evolutionary process on a branch of the phylogeny , the evolutionary process on the whole phylogeny is defined as follows .",
    "[ defevolutionaryprocess ] suppose that every site of the sequence @xmath70 at the root of the phylogeny is chosen to be @xmath71 or @xmath72 uniformly at random .",
    "recursively , if @xmath30 is the sequence at node @xmath8 and @xmath24 is an edge of the phylogeny , the sequence @xmath31 at node @xmath25 is obtained from the sequence @xmath30 by an application of the evolutionary process on a branch described by definition  [ defevolutionaryprocessbranch ] .    for ease of exposition",
    ", we first present our proof in the special case where the substitution , insertion and deletion rates are the same on all edges of the phylogeny .    under the ultrametric assumption ,",
    "the leaves of the phylogeny are contemporaneous , that is , there exists @xmath73 such that for each @xmath74 the sum of evolutionary times @xmath37 on the branches between @xmath8 and the root is @xmath73 .",
    "[ defmolecularclock ] under the molecular clock assumption , we assume that the ultrametric assumption holds .",
    "moreover , there exist @xmath75 , @xmath76 and @xmath77 such that @xmath78 , @xmath79 and @xmath80 , for all @xmath81.=-1    we discuss a more general case in section  [ secextensions ] .      in the sequel , we label the leaves of the phylogeny with the positive integers @xmath72 , @xmath82 , so that @xmath83 , and the root @xmath22 of the phylogeny with @xmath71 .        we begin with a consistency result . here",
    "we consider a completely general phylogeny , that is , neither the ultrametric nor the molecular clock assumptions need hold .",
    "[ thmconsistency ] assume that @xmath84 , for all @xmath81 .",
    "then there exists a procedure returning the correct tree from the sequences at the leaves , with probability of failure approaching @xmath71 as the sequence length at the root of the tree goes to @xmath16 .",
    "our main result is the following .",
    "for simplicity we first work under the symmetric two - state case and assume that the molecular clock assumption holds .",
    "[ thmmain ] consider the two - state model under the molecular clock assumption .",
    "assume further that there exist constants @xmath85 independent of @xmath10 , such that @xmath86 moreover , assume that @xmath87 where @xmath75 , @xmath77 and @xmath76 are bounded between constants ( independent of @xmath10 ) @xmath88 , @xmath89 and @xmath90 , respectively .",
    "under the assumptions above , for all @xmath91 there exists @xmath92 such that there exists a polynomial - time algorithm solving the phylogenetic reconstruction problem ( i.e. , returning the correct tree ) with probability of failure @xmath93 , if the root sequence has length @xmath94 .",
    ", that is , that the indel rates are negligible .",
    "here we show that this assumption can be relaxed ( at the cost of longer sequences ) . ]",
    "our assumption that all branch lengths @xmath37 , @xmath81 , satisfy @xmath95 is standard in the sequence - length requirement literature following the seminal work of  @xcite .      in section  [ secextensions ]",
    "we derive the following extension .",
    "let @xmath96 be a reversible @xmath97 rate matrix with stationary distribution @xmath98 .",
    "( larger alphabets are also possible . )",
    "the gtr sequence evolution process is identical to the one described in definition  [ defevolutionaryprocessbranch ] except that the substitution process is a continuous - time markov process with rate matrix @xmath99 .",
    "[ thmmain2 ] consider the gtr model with rate matrix @xmath96 under the ultrametric assumption ( but not necessarily the molecular clock assumption ) .",
    "assume further that there exist constants @xmath100 independent of @xmath10 , such that @xmath101 moreover , assume that @xmath102 where @xmath77 and @xmath76 are bounded between constants ( independent of @xmath10 ) @xmath89 and @xmath90 , respectively .",
    "we refer to the conditions above as the _ bounded - rates assumption_. under the assumptions above , for all @xmath91 there exists @xmath92 such that there exists a polynomial - time algorithm solving the phylogenetic reconstruction problem ( i.e. , returning the correct tree ) with probability of failure @xmath93 , if the root sequence has length @xmath94 .",
    "consider the two - state , molecular clock case . as we noted before , unlike the classical setting where the hamming distance can be analyzed through standard concentration inequalities , proving rigorously that our approach works involves several new technical difficulties .",
    "the proof goes through the following steps :    _ expectations .",
    "_ we first compute expectations of block statistics , which involve analyzing a continuous - time markov process .",
    "we use these calculations to define an appropriate additive metric based on correlations between blocks .    _ sequence length and site displacements .",
    "_ we give bounds on how much sequence lengths vary across the tree through a moment - generating function argument . using our bounds on the sequence length process",
    ", we bound the worst - case displacements of the sites .",
    "namely , we show that , under our assumptions , all sites move by at most @xmath103 .    _",
    "sequence partitioning . _",
    "we divide each sequence in blocks of size roughly @xmath104 for @xmath105 , where @xmath15 is the sequence length at the root . from our bounds on site displacements",
    ", it follows that the blocks roughly match across different sequences .",
    "in particular , we bound the number of homologous sites between matching blocks with high probability and show that the expected correlation between these blocks is approximately correct .",
    "_ concentration .",
    "_ finally , we show that our estimates are concentrated .",
    "the concentration argument proceeds by conditioning on the indel process satisfying the high - probability conditions in the previous points .",
    "the crux of our result is the proper estimation of an additive metric .",
    "with such an estimation procedure in hand , we can use a standard distance - based approach to recover the phylogeny .",
    "the rest of the paper is organized as follows .",
    "the evolutionary distance forming the basis of our approach is presented in section  [ secmetric ] .",
    "we describe our full distance estimator in section  [ secestimation ] and prove its concentration in the same section .",
    "extensions are described in section  [ secextensions ] .",
    "consider the two - state , molecular clock case . in this section ,",
    "we show how to define an appropriate notion of `` evolutionary distance '' between two species .",
    "although such distances have been widely used in prior phylogenetic work and have been defined for a variety of models @xcite , to our knowledge our definition is the first that applies to models with indels .",
    "we begin by reviewing the standard definition in the indel - free case and then adapt it to the presence of indels .",
    "our estimation procedure is discussed in section  [ secestimation ] .",
    "suppose first that @xmath106 , that is , _ there is no indel_. in that case , the sequence length remains fixed at @xmath15 and the alignment problem is trivial .",
    "underlying all distance - based approaches is the following basic definition .",
    "[ defadditive ] a phylogeny is naturally equipped with a so - called additive metric on the leaves @xmath107 defined as @xmath108 where @xmath109 is the set of edges on the path between @xmath110 and @xmath111 in @xmath23 and where @xmath112 is a nonnegative function of the parameters on @xmath46 ( in our case , @xmath37 , @xmath38 , @xmath40 and  @xmath39 ) .",
    "for instance , a common choice for @xmath112 would be @xmath113 in which case @xmath114 is the expected number of substitutions per site between @xmath110 and @xmath111 .",
    "often @xmath114 is referred to as the `` evolutionary distance '' between species @xmath110 and @xmath111 .",
    "additive metrics are characterized by the following four - point condition : for all , @xmath115 moreover , assuming @xmath116 for all @xmath117 , it is well known that there exists a one - to - one correspondence between @xmath118 and @xmath23 as a weigthed tree with edge weights @xmath119 .",
    "we will discuss algorithms for constructing @xmath23 from @xmath118 in section  [ secalgo ] .",
    "for more background on tree - based metrics , see  @xcite .",
    "definition  [ defadditive ] implies that phylogenies can be reconstructed by computing @xmath114 for all pairs of leaves @xmath120 .",
    "assume we seek to estimate the evolutionary distance between species @xmath110 and @xmath111 using their respective sequences .",
    "in a first attempt , one might try the ( normalized ) hamming distance between @xmath121 and @xmath122 .",
    "however , the expected hamming distance ( in other words , the probability of disagreement between a site of @xmath110 and  @xmath111 ) does not form an additive metric as defined in definition  [ defadditive ] . instead , it is well known that an appropriate estimator is obtained by `` correcting '' the hamming distance for `` multiple '' substitutions . denoting by @xmath123 the hamming distance between @xmath124 and @xmath125",
    ", a markov chain calculation shows that @xmath126)$ ] , with the choice @xmath113 ( see , e.g. ,  @xcite ) . in a distance - based reconstruction procedure , one first estimates @xmath118 with @xmath127 and then applies one of the algorithms discussed in section [ secalgo ] below .",
    "the sequence - length requirement of such a method can be derived by using concentration results for @xmath128 @xcite .      to simplify the presentation , we assume throughout that @xmath129 .",
    "the case @xmath130 follows from the same argument .    in the presence of indels ,",
    "the estimator ( [ eqhamming ] ) based on the hamming distance is difficult to apply .",
    "one has to first align the sequences , which can not be done perfectly and causes biases as well as correlations that are hard to analyze .",
    "alternatively , one could try a different string distance such as edit distance .",
    "however , computing the expectation of edit distance under indel models appears difficult .",
    "we use a different approach involving correlations between state frequencies .",
    "we will eventually apply the estimator to large sub - blocks of the sequences ( see section  [ secestimation ] ) , but we first describe it for the full sequence for clarity . for a node @xmath8 ,",
    "let @xmath28 be the ( random ) length of the sequence at @xmath8 and @xmath131 , the number of @xmath71 s in the sequence at @xmath8 .",
    "then , our distance estimator is=-1 @xmath132=0 we now analyze the expectation of this quantity . for @xmath133 , we let @xmath134 be the deviation of @xmath131 from its expected value ( conditioned on the sequence length ) .",
    "suppose @xmath23 is made of a single edge from the root @xmath135 to a leaf @xmath110 with parameters @xmath136 .",
    "assume first that the original sequence length is @xmath137 .",
    "let @xmath138 be the length of the sequence at @xmath110 .",
    "then @xmath138 is a continuous - time branching process and , by markov chain calculations ( @xcite , section iii.5 ) , its moment - generating function is @xmath139 = \\frac{{\\mu}(s-1 ) - e^{({\\mu}-{\\lambda})t}({\\lambda}s - { \\mu } ) } { { \\lambda}(s-1 ) - e^{({\\mu}-{\\lambda})t}({\\lambda}s - { \\mu})}.\\ ] ] by differentiating @xmath140 we derive @xmath141 = e^{-({\\mu}-{\\lambda})t}\\ ] ] and @xmath142 = \\frac{{\\mu}+{\\lambda}}{{\\mu}-{\\lambda}}\\bigl[e^{-({\\mu}-{\\lambda})t } - e^{-2({\\mu}-{\\lambda})t}\\bigr].\\ ] ] let @xmath143 be the number of `` new '' sites at @xmath110 , that is , excluding the original site if it survived .",
    "( we ignore the substitutions for the time being . )",
    "the probability that the original site survives is @xmath144 .",
    "then , @xmath145 = { \\mathbb{e}}[k_a - { \\mathbh{1}}\\{\\mbox{original site survives}\\ } ] = e^{-({\\mu}-{\\lambda})t } - e^{-{\\mu}t}\\ ] ] by linearity of expectation .",
    "we now take into account substitutions .",
    "assume that the original sequence length at @xmath135 is a random variable @xmath146 and that the sequence at @xmath135 is i.i.d .",
    "uniform . denote by @xmath147 the number of @xmath71 s at @xmath135 . the probability that a site in @xmath135",
    ", that is still surviving in @xmath110 , has flipped its value is @xmath148\\\\ & = & \\sum_{j=0}^{+\\infty } e^{-{\\eta}t } \\frac{({\\eta}t)^{2j+1}}{(2j+1)!}\\\\ & = & e^{-{\\eta}t}\\sinh{\\eta}t\\\\ & = & \\frac{1 - e^{-2{\\eta}t}}{2}.\\end{aligned}\\ ] ] also , note that a new site created along the path between @xmath135 and @xmath110 has equal chance of being @xmath71 or @xmath72 _ at the end of the path_. then we have the following lemma .",
    "[ lem1 ] the following holds : @xmath149 = e^{-(2{\\eta}+{\\mu } ) t } { \\delta}_r.\\vadjust{\\goodbreak}\\ ] ]    we have @xmath150 & = & { \\mathbb{e}}\\bigl[\\bigl(z_a - \\tfrac{1}{2 } k_a\\bigr ) | k_r , z_r\\bigr]\\nonumber\\\\ & = & z_r e^{-{\\mu}t } ( 1-p ) + ( k_r - z_r ) e^{-{\\mu}t } p\\nonumber\\\\ & & { } + k_r \\bigl(e^{-({\\mu}-{\\lambda})t } - e^{-{\\mu}t}\\bigr ) \\tfrac{1}{2 } - k_r e^{-({\\mu}-{\\lambda})t } \\tfrac{1}{2}\\\\ & = & z_r ( 1- 2p ) e^{-{\\mu}t } - \\tfrac{1}{2 } k_r ( 1 - 2p ) e^{-{\\mu}t}\\nonumber\\\\ & = & e^{-2{\\eta}t } e^{-{\\mu}t } { \\delta}_r,\\nonumber\\end{aligned}\\ ] ] where on the first two lines :    the first term is the number of original @xmath71 s surviving in state @xmath71 ;    the second term is the number of original @xmath72 s surviving in state @xmath71 ;    the third term is the number of new sites surviving in state @xmath71 ( where recall that new sites are uniformly chosen in @xmath151 ) ;    the fourth term is half the sequence length at @xmath110 given the length at  @xmath135 .      consider now a `` fork '' tree , that is , a root @xmath135 from which emanates a single edge @xmath152 which in turn branches into two edges @xmath153 and @xmath154 ( see figure  [ figfork ] below ) . for @xmath155 ,",
    "we denote the parameters of edge @xmath156 by @xmath157 .",
    "our goal is to compute @xmath158 $ ] assuming that the sequence length at the root is @xmath159 .",
    "we use ( [ eqsingle ] ) , the markov property and the fact that @xmath131 conditioned on @xmath28 is a binomial with parameters @xmath160 and @xmath28 .",
    "we get the following lemma .",
    "[ lem2 ] the following holds : @xmath161 = e^{-(2{\\eta}_a+{\\mu}_a ) t_a } e^{-(2{\\eta}_b+{\\mu}_b ) t_b } e^{-({\\mu}_u - { \\lambda}_u)t_u } \\frac{k_r}{4}.\\ ] ]    we have @xmath162 & = & { \\mathbb{e}}[{\\delta}_a { \\delta}_b]\\\\ & = & { \\mathbb{e}}[{\\mathbb{e}}[{\\delta}_a { \\delta}_b | k_u , z_u]]\\\\ & = & { \\mathbb{e}}[{\\mathbb{e}}[{\\delta}_a | k_u , z_u]{\\mathbb{e}}[{\\delta}_b | k_u , z_u]]\\\\ & = & e^{-2{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-2{\\eta}_b t_b } e^{-{\\mu}_b t_b } { \\mathbb{e}}[{\\delta}_u^2]\\\\ & = & e^{-2{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-2{\\eta}_b t_b } e^{-{\\mu}_b t_b } { \\mathbb{e}}[{\\mathbb{e}}[{\\delta}_u^2 | k_u]]\\\\ & = & e^{-2{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-2{\\eta}_b t_b } e^{-{\\mu}_b t_b } { \\mathbb{e}}\\biggl[\\frac{k_u}{4}\\biggr]\\\\ & = & e^{-2{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-2{\\eta}_b t_b } e^{-{\\mu}_b t_b } \\frac{e^{-({\\mu}_u - { \\lambda}_u)t_u } k_r}{4},\\end{aligned}\\ ] ] where we used ( [ eqgrowth ] ) and lemma  [ lem1 ] .",
    "we specialize the previous result to the molecular clock assumption .",
    "that is , we assume , for @xmath155 , that @xmath163 , @xmath164 and @xmath165 .",
    "note that by construction @xmath166 ( assuming species @xmath110 and @xmath111 are contemporary ) . we denote @xmath167 and @xmath168 . denoting @xmath169 , we then get the following lemma .",
    "[ lem3 ] the following holds : @xmath161 = e^{-(4{\\eta}+{\\mu}+{\\lambda})t } \\kappa.\\ ] ]    letting @xmath170 we get that @xmath171 = 2\\beta t,\\ ] ] which is the evolutionary distance between @xmath110 and @xmath111 with the choice @xmath172 . therefore , we define the following estimator : @xmath173",
    "we now show how to estimate the evolutionary distance between two species by decomposing the sequences into large blocks which serve as roughly independent samples .",
    "we use the following notation : @xmath174 , @xmath175 , @xmath176 , @xmath177 and @xmath178 .",
    "we show in section  [ secalgo ] that the time elapsed between the root and the leaves is bounded by @xmath179 . hence",
    ", under our assumptions @xmath180\\\\[-8pt ] & \\leq & m_t \\leq e^{(\\bar{{\\lambda } } { g^2}/{f } ) \\log_2 n } \\leq e^{(\\bar{{\\lambda}}+\\bar{{\\mu } } ) ( { g^2}/{f } ) \\log_2",
    "n } \\equiv\\upsilon_n,\\nonumber \\\\ \\label{eqboundd } \\upsilon_n^{-1 } & \\leq & e^{-(\\bar{{\\mu } } { g^2}/{f } ) \\log_2 n } \\leq d_t \\leq1\\end{aligned}\\ ] ] and @xmath181\\\\[-8pt ] & = & e^{(\\bar{{\\lambda } } { g^2}/{f } ) \\log_2 n } - 1 \\leq\\upsilon_n,\\nonumber\\end{aligned}\\ ] ] where we used that the function @xmath182 is nonnegative and decreasing since its derivative is @xmath183 note that the bounds above are polynomials in @xmath10 with exponents depending only on @xmath184 , @xmath185 , @xmath186 and @xmath187 . in particular",
    ", we will ultimately take sequence lengths @xmath159 of the form @xmath188 with @xmath189 chosen much larger than the exponent in @xmath190 .",
    "we call polynomials in @xmath10 ( such as @xmath190 ) which have an exponent not depending on @xmath189 , _ small polynomials_. as a result , the following notation will be useful . for a function @xmath191 of @xmath159",
    ", we use @xmath192 to denote a function smaller or equal to @xmath191 _ up to a small polynomial factor_. ( the latter will be used similarly to the big - o notation . )",
    "recall the following standard concentration inequalities ( see , e.g. ,  @xcite ) .",
    "[ lemmachernoff ] let @xmath193 be independent @xmath56-random variables such that , for @xmath194 , @xmath195 = p_i$ ] where @xmath196 .",
    "then , for @xmath197 , @xmath198 = \\sum_{i=1}^m p_i$ ] , @xmath199 and @xmath200 , @xmath201 < e^{-m \\delta_-^2/2}\\ ] ] and @xmath202 < e^{-c(u ) m \\delta_-^2},\\ ] ] where @xmath203/u^2 $ ] .",
    "we first show that the sequence length is concentrated .",
    "let @xmath23 be single channel consisting of edge @xmath204 .",
    "let @xmath159 be the length at  @xmath135 .",
    "[ lemmalengthconcentration ] for all @xmath205 and @xmath206 with @xmath207 large enough , with probability at least @xmath208 , @xmath209 where the small polynomial factor in @xmath210 depends on @xmath211 as well .",
    "[ remblocks ] although we stated lemma  [ lemmalengthconcentration ] for the full sequence , it will also be needed for `` half - sequences '' and `` blocks . '' in particular , we use the previous lemma to track the position of sites . in that context",
    ", one should think of @xmath159 as the position of a site in @xmath135 and @xmath138 as its position in @xmath110 .",
    "then we can use @xmath212 for the full sequence length at @xmath135 ( see section  [ secpartition ] ) .",
    "proof of lemma  [ lemmalengthconcentration ] we think of @xmath138 as @xmath213 where @xmath214 is the number of sites generated by a single site of the sequence at @xmath135 . intuitively , @xmath214 is the number of sites that were inserted between the sites @xmath215 and @xmath216 of the sequence at @xmath135 , plus the site at position @xmath215 itself , if it survived .",
    "clearly the variables @xmath217 are mutually independent .    using ( [ eqgrowth ] )",
    "we obtain that @xmath218 = k_r m_t.\\ ] ] for @xmath219 , by markov s inequality , we have @xmath220 \\leq s^{-k_r(m_t + { \\varepsilon } ) } { \\mathbb{e}}[s^{k_{a } } ] = \\bigl(s^{-(m_t + { \\varepsilon } ) } { \\mathbb{e}}[s^{k_{a,1}}]\\bigr)^{k_r}.\\ ] ] we take @xmath221 for @xmath222 to be determined .",
    "we have @xmath223 & = & \\frac{{\\mu}(s-1 ) - e^{({\\mu}-{\\lambda})t}({\\lambda}s - { \\mu } ) } { { \\lambda}(s-1 ) - e^{({\\mu}-{\\lambda})t}({\\lambda}s - { \\mu } ) } = \\frac{({\\mu}- { \\lambda}m_t^{-1})c { \\varepsilon}+ { \\delta}m_t^{-1 } } { { \\lambda}(1 - m_t^{-1})c { \\varepsilon}+ { \\delta}m_t^{-1}}\\\\ & = & \\frac{{\\delta}^{-1}({\\mu}m_t - { \\lambda})c { \\varepsilon}+ 1 } { { \\delta}^{-1}{\\lambda}(m_t - 1)c { \\varepsilon}+ 1 } = \\frac{1 - ( { \\lambda}^{-1 } { \\mu}\\gamma_t - 1 ) c { \\varepsilon}}{1 - \\gamma _ t c { \\varepsilon}}\\\\ & = & [ 1 - ( { \\lambda}^{-1 } { \\mu}\\gamma_t - 1 ) c { \\varepsilon } ] \\sum_{\\iota= 0}^{+\\infty } [ \\gamma_t c { \\varepsilon}]^\\iota,\\end{aligned}\\ ] ] whenever @xmath224 . hence , if @xmath225 is bounded away from @xmath72 ( independently of @xmath10 ) , we have , using ( [ eqboundgamma ] ) , @xmath223 & = & [ 1 - ( { \\lambda}^{-1 } { \\mu}\\gamma_t - 1 ) c { \\varepsilon } ] [ 1 + \\gamma_t c { \\varepsilon}+ ( \\gamma_t c { \\varepsilon})^2 + o((\\upsilon_n c { \\varepsilon})^3)]\\\\ & = & 1 + m_t ( c{\\varepsilon } ) + m_t \\gamma_t ( c{\\varepsilon})^2 + o((\\upsilon_n c { \\varepsilon})^3).\\end{aligned}\\ ] ] moreover , using the binomial series and ( [ eqboundm ] ) , and assuming @xmath226 @xmath227^\\iota\\\\ & \\leq & 1 - ( m_t + { \\varepsilon } ) ( c{\\varepsilon } ) + \\frac{(m_t+{\\varepsilon})(m_t + { \\varepsilon}+ 1)}{2 } ( c{\\varepsilon})^2\\\\ & & { } + \\sum_{\\iota=3}^{+\\infty } ( m_t + { \\varepsilon}+ 1)^\\iota[c { \\varepsilon}]^\\iota\\\\ & = & 1 - ( m_t + { \\varepsilon } ) ( c{\\varepsilon } ) + \\frac{(m_t+{\\varepsilon})(m_t + { \\varepsilon}+ 1)}{2 } ( c{\\varepsilon})^2\\\\ & & { } + o((\\upsilon_n c { \\varepsilon})^3),\\end{aligned}\\ ] ] whenever @xmath228 is small and @xmath225 is bounded away from @xmath72 ( independently from  @xmath10 ) . therefore , @xmath229 & = & 1 - { \\varepsilon}(c{\\varepsilon})+ m_t\\gamma_t(c{\\varepsilon})^2 + \\frac{(m_t+{\\varepsilon})(m_t + { \\varepsilon}+ 1)}{2 } ( c{\\varepsilon})^2\\\\ & & { } - ( m_t + { \\varepsilon})m_t ( c{\\varepsilon})^2 + o((\\upsilon_n c { \\varepsilon})^3).\\end{aligned}\\ ] ] note that the second term on the right - hand side depends on @xmath230 whereas the remaining terms depend on @xmath231 . taking @xmath232 with @xmath233 small enough and @xmath234 large enough , using ( [ eqmarkov ] ) with the choice @xmath235 we get that @xmath236 & \\leq & { \\mathbb{p}}[k_a \\geq k_r m_t + k_r { \\varepsilon}]\\\\[-2pt ] & \\leq & \\biggl(1 - \\frac{o(\\log\\widehat{k}_r)}{k_r}\\biggr)^{k_r}\\\\[-2pt ] & \\leq & { \\widehat{k}_r}^{-\\gamma}.\\end{aligned}\\ ] ] note that our choice of @xmath228 satisfies @xmath225 for @xmath159 a large enough polynomial of  @xmath10 ( compared to the small polynomial @xmath190 ) .",
    "a similar inequality holds for the other direction .",
    "now let @xmath23 be the fork channel consisting of nodes @xmath135 , @xmath8 , @xmath110 and @xmath111 as in figure  [ figfork ] .",
    "assume that @xmath110 and @xmath111 are contemporary , call @xmath237 the time separating them from @xmath8 and denote by @xmath238 the number of sites in @xmath110 and @xmath111 that are jointly surviving from @xmath8 .",
    "these are the sites that produce correlation between the sequences at @xmath110 and @xmath111 .",
    "all other sites are essentially noise .",
    "we bound the large deviations of  @xmath238 .",
    "[ lemsurviving ] condition on the sequence length at @xmath8 being @xmath239 . then , for all @xmath205 and all @xmath240 with @xmath207 large enough , with conditional probability at least @xmath241 , @xmath242 where the small polynomial factor in @xmath243 depends on @xmath211 as well .",
    "each site in @xmath8 survives in @xmath110 with probability @xmath244 .",
    "the same holds for @xmath111 independently .",
    "the result then follows from chernoff s bound .",
    "we have @xmath245 & \\leq & { \\mathbb{p}}\\biggl [ { s_{ab } } < k_u d_t^2 - c \\sqrt{\\frac{\\upsilon_n^2 \\log\\widehat { k}_u}{k_u } } \\cdot k_u d_t^2 \\biggr]\\\\ & \\leq & \\exp ( - c^2 \\upsilon_n^2 d_t^2 \\log\\widehat{k}_u ) \\\\ & \\leq & \\widehat{k}_u^{-\\gamma}\\end{aligned}\\ ] ] for @xmath246 large enough , where we used ( [ eqboundd ] ) .",
    "the other direction is similar .      from lemma  [ lemmalengthconcentration ]",
    ", it follows that the sites of the root sequence ( or of an internal sequence ) remain fairly close to their expected position at the leaves .",
    "we take advantage of this fact by dividing each sequence into blocks of size asymptotically larger than the typical displacement implied by lemma  [ lemmalengthconcentration ] . as a result , matching blocks in different sequences share a significant fraction of sites",
    ". moreover , distinct blocks are roughly independent .",
    "we estimate the evolutionary distance between two leaves by comparing the site frequencies in matching blocks . this requires some care as we show next .",
    "consider the fork channel .",
    "we seek to estimate the evolutionary distance @xmath247 between @xmath110 and @xmath111 ( normalized by the sequence length at @xmath8 ) .",
    "let @xmath248 be some _ deterministic _ length ( to be determined ) , and consider the first @xmath248 sites in the sequences @xmath124 and @xmath125 at the nodes @xmath110 and @xmath111 , respectively .",
    "if the sequence at @xmath110 or @xmath111 has length smaller than @xmath248 , we declare that our distance estimate @xmath249 ( see below ) is @xmath16 .",
    "we divide the leaf sequences into @xmath250 blocks of length @xmath251 where @xmath252 , for some @xmath253 to be determined later and @xmath254 .",
    "we let @xmath255 . for all @xmath256",
    ", we define the @xmath215th _ block _ @xmath257 of @xmath110 to be the subsequence of @xmath124 ranging from position @xmath258 to position @xmath259 .",
    "we let @xmath260 be the number of zeros inside @xmath257 and define the _ block deviations _",
    "@xmath261 for all @xmath262 , and similarly for the sequence at @xmath111 .    using the above notation",
    "we define our distance estimator next .",
    "assume that @xmath250 is even .",
    "otherwise , we can just drop the last block in the above partition .",
    "our estimator is @xmath263 notice that in our summation above we skipped every other block in our sequence partition to avoid overlapping sites and hence , decrease potential correlations between the terms in the estimator . in the rest of this section",
    ", we analyze the properties of @xmath249 . to do this it is helpful to consider the sequence at @xmath8 and the events that happened in the channels defined by the edges @xmath264 and @xmath265 .",
    "let us choose @xmath266 to be the largest integer satisfying @xmath267 suppose that the sequence @xmath30 at node @xmath8 is not shorter than @xmath268 , and define the @xmath215th _ ancestral block _",
    "@xmath269 of @xmath8 to be the subsequence of @xmath270 ranging from position @xmath271 to position @xmath272 , for all @xmath273 . given lemma  [ lemmalengthconcentration ] ,",
    "the choice of @xmath266 in ( [ eqellu ] ) is such that the blocks of @xmath8 and the corresponding blocks at @xmath110 and @xmath111 roughly align .",
    "in order to use the expected evolutionary distance as computed in lemma  [ lem3 ] , we define an `` interior '' ancestral block which is guaranteed with high probability to remain entirely `` inside '' the corresponding leaf block .",
    "let @xmath274 , where the small polynomial factor is the maximum of those in the proofs of lemma  [ lemmalengthconcentration ] and lemma  [ lemsurviving ] for a given choice of @xmath211 . [ the @xmath275 in @xmath276",
    "is needed only when ( [ eqellu ] ) is a strict inequality .",
    "see the proof of lemma  [ lemprobabilityofgoodevent1 ] below .",
    "] we define the @xmath215th ( _ ancestral _ ) _ interior block _ @xmath277 of @xmath8 to be the subsequence of @xmath269 ranging from position @xmath278 of @xmath30 to position @xmath279 .",
    "notice that @xmath280 , while @xmath281 .",
    "therefore , for @xmath282 , where @xmath283 is sufficiently large , @xmath284 so that the sequence @xmath277 is well defined .    also , for all @xmath285",
    ", we define @xmath286 , @xmath287 to be the position of the left - most ( resp .",
    ", right - most ) site in the sequence @xmath124 descending from the site at position @xmath278 ( resp . , @xmath279 of @xmath30 ) .",
    "similarly , we define @xmath288 and @xmath289 . given this notation , we define the following `` good '' event @xmath290\\\\[-8pt ] & & \\hspace*{139.7pt } i \\ell- 2m_t\\delta_u",
    "< y'_{a , i},y'_{b , i } < i \\ell \\}.\\nonumber\\end{aligned}\\ ] ] intuitively , when the event @xmath291 holds , all surviving descendants of the interior block @xmath277 are located inside the blocks @xmath257 and @xmath292 , respectively ( and the blocks remain large enough ) .    to argue about block independence , we also define the _ exterior block _ @xmath293 of @xmath8 to be the subsequence of @xmath269 ranging from position @xmath294 of @xmath30 to position @xmath295 with corresponding positions @xmath296 , @xmath297 , @xmath298 and @xmath299 and good event @xmath300 defined similarly as above , that is , @xmath301    we define @xmath302 we show that this event holds with high probability , conditioned on the sequence length     the descendants of the interior blocks of @xmath303 fall inside the corresponding blocks of @xmath304 ; the descendants of the exterior blocks of @xmath303 contain all surviving sites inside the corresponding blocks of @xmath305 ; the windows of uncertainty have length @xmath306 . ]    @xmath28 at @xmath8 being at least @xmath307 .",
    "figure  [ figgoodevent ] shows the structure of the indel process in the case that the event @xmath308 holds .",
    "[ lemprobabilityofgoodevent1 ] conditioned on the event @xmath309 , we have @xmath310 \\ge1- { 16 l \\biggl(\\frac{1}{k_u'}\\biggr)^{\\gamma}}.\\ ] ]    it follows from lemma  [ lemmalengthconcentration ] that the left - most descendant of the site at position @xmath278 of @xmath30 is located inside the sequence of node @xmath110 at position at least @xmath311 with probability @xmath312 . the other bounds",
    "follow similarly . taking a union bound over",
    "all @xmath215 s establishes the result .",
    "let @xmath313 be the number of common sites in the blocks @xmath257 and @xmath314 that are jointly surviving from @xmath8 .",
    "similarly , we define @xmath315 and @xmath316 where , for @xmath317 , @xmath318 ( resp . ,",
    "@xmath319 ) denotes the subsequence of @xmath320 ranging from position @xmath321 ( resp .",
    ", @xmath322 ) to position @xmath323 ( resp . , @xmath324 ) .",
    "we define a good event for @xmath313 as @xmath325    [ lemprobabilityofgoodevent2 ] conditioned on the event @xmath309 , we have @xmath326 \\ge1- { 18 l \\biggl(\\frac{1}{k_u'}\\biggr)^{\\gamma}}.\\ ] ]    we bound @xmath327 & = & { \\mathbb{p}}[{{\\mathcal{e}}}_2^c\\cap{{\\mathcal{e}}}_1 ] + { \\mathbb{p}}[{{\\mathcal{e}}}_2^c\\cap{{\\mathcal{e}}}_1^c ] \\leq { \\mathbb{p}}[{{\\mathcal{e}}}_2^c\\cap{{\\mathcal{e}}}_1 ] + { \\mathbb{p}}[{{\\mathcal{e}}}_1^c]\\\\ & \\leq & { \\mathbb{p}}[{{\\mathcal{e}}}_2^c\\cap{{\\mathcal{e}}}_1 ] + 16 l \\biggl(\\frac { 1}{k_u'}\\biggr)^{\\gamma}.\\end{aligned}\\ ] ] by construction , under @xmath328 we have @xmath329 so that @xmath330 & \\leq & { \\mathbb{p}}[\\exists i , { s_{ab , i } } ' \\leq\\ell_u d_t^2 - 3 m_t \\delta_u]\\\\ & & { } + { \\mathbb{p}}[\\exists i , { s_{ab , i } } '' \\geq\\ell_u d_t^2 + 3 m_t \\delta_u]\\\\ & \\leq & { \\mathbb{p}}\\bigl[\\exists i , { s_{ab , i } } ' \\leq(\\ell_u - 2\\delta_u + 1 ) d_t^2 - { \\mathcal{s}}_n\\bigl(\\sqrt{k_u'\\log k_u'}\\bigr ) \\bigr]\\\\ & & { } + { \\mathbb{p}}\\bigl[\\exists i , { s_{ab , i } } '' \\geq(\\ell_u + 2\\delta_u+1)d_t^2 + { \\mathcal{s}}_n\\bigl(\\sqrt{k_u'\\log k_u'}\\bigr ) \\bigr]\\\\ & \\leq & { 2 l \\biggl(\\frac{1}{k_u'}\\biggr)^{\\gamma}}\\end{aligned}\\ ] ] by lemma  [ lemsurviving ] , where we also used the fact that @xmath331 .",
    "we are now ready to analyze the behavior of our estimate @xmath249 . in this subsection",
    "we compute the expectation and variance of @xmath249 .",
    "we denote by @xmath332 a realization of the indel process ( but not of the substitution process ) on the paths between @xmath8 and @xmath333 .",
    "we denote by @xmath334 the event that @xmath335 , @xmath328 and @xmath336 are satisfied .",
    "suppose that @xmath282 ( defined in section  [ secpartition ] ) .",
    "[ lemindependence ] conditioning on @xmath332 and @xmath334 , the @xmath337 are mutually independent .",
    "observe that when @xmath338 the ancestral blocks @xmath269 are well defined .",
    "assuming that @xmath339 , the interior blocks @xmath277 are also well defined and disjoint . hence , for a fixed @xmath332 under @xmath334 , for all @xmath340 , both @xmath341 and @xmath342 depend on the subsequence of @xmath30 ranging from position @xmath343 to position @xmath344 . in this case , for @xmath345 , different @xmath346 s are functions of different subsequences of @xmath30 .",
    "observe that , since the root sequence is i.i.d .",
    "uniform and the insertions above @xmath8 are also i.i.d .",
    "uniform , the state of every site in @xmath30 is uniform and independent from the other sites .",
    "it follows from the above observations that @xmath347 are mutually independent .",
    "[ lemexpectation ] we have @xmath348 = \\tfrac{1}{4 } e^{-4{\\eta}t } e^{-2{\\mu}t } \\ell_u \\pm { \\mathcal{s}}_n\\bigl(\\sqrt{k_0 \\log k_0}\\bigr).\\ ] ]    let @xmath349 be the contribution to @xmath341 from those common sites between @xmath110 and @xmath111 that are jointly surviving from @xmath8 .",
    "let @xmath350 , and similarly for @xmath111 .",
    "then @xmath351 & = & { \\mathbb{e}}[({\\delta}_{a , i}^{\\mathrm{s}}+{\\delta}_{a , i}^{{\\mathrm{ns } } } ) ( { \\delta}_{b , i}^{\\mathrm{s}}+{\\delta}_{b , i}^{{\\mathrm{ns } } } ) | { \\mathcal{i}},{{\\mathcal{e}}}]\\\\ & = & { \\mathbb{e}}[{\\delta}_{a , i}^{\\mathrm{s}}{\\delta}_{b , i}^{\\mathrm{s}}| { \\mathcal{i}},{{\\mathcal{e}}}],\\end{aligned}\\ ] ] since the contribution from @xmath352 and @xmath353 is independent and averages to @xmath71 .",
    "write @xmath349 as a sum over the jointly surviving sites , that is , @xmath354 where @xmath355 is @xmath72 if the corresponding site of @xmath110 is @xmath71 .",
    "note that the terms in parentheses have zero expectation given @xmath332 and @xmath334 .",
    "then , @xmath356 = \\sum_{j=1}^{{s_{ab , i } } } { \\mathbb{e}}\\biggl[\\biggl(z_{a , i}^{(j ) } - \\frac { 1}{2}\\biggr)\\biggl(z_{b , i}^{(j ) } - \\frac{1}{2}\\biggr ) \\big| { \\mathcal{i}},{{\\mathcal{e}}}\\biggr]\\ ] ] by independence of the sites .",
    "we compute the expectation above .",
    "we have @xmath357 & = & { \\mathbb{e}}\\biggl[\\biggl(z_{a , i}^{(j)}z_{b , i}^{(j ) } - \\frac { 1}{2}z_{a , i}^{(j ) } - \\frac{1}{2}z_{b , i}^{(j ) } + \\frac{1}{4 } \\biggr ) \\big| { \\mathcal{i}},{{\\mathcal{e}}}\\biggr]\\\\ & = & { \\mathbb{e}}\\bigl[z_{a , i}^{(j)}z_{b , i}^{(j ) } | { \\mathcal{i}},{{\\mathcal{e}}}\\bigr ] - \\frac{1}{4}\\\\ & = & \\frac{1}{2}\\frac{1+e^{-4{\\eta}t}}{2 } - \\frac{1}{4}\\\\ & = & \\frac{1}{4}e^{-4{\\eta}t}.\\end{aligned}\\ ] ] therefore , @xmath356 = \\tfrac{1}{4}e^{-4{\\eta}t } { s_{ab , i}}.\\ ] ] the result then follows from the definition of @xmath336 .",
    "[ lemvariance ] we have @xmath358 \\le\\tfrac { 3}{16 } \\ell^2.\\ ] ]    by cauchy ",
    "schwarz we have @xmath359 & \\leq & ( { \\mathbb{e}}[{\\delta}_{a , i}^4 | { \\mathcal{i}},{{\\mathcal{e } } } ] { \\mathbb{e}}[{\\delta}_{b , i}^4 | { \\mathcal{i}},{{\\mathcal{e}}}])^{1/2}\\\\ & = & \\bigl(\\tfrac{1}{16}(3\\ell^2 - 2\\ell ) \\cdot \\tfrac{1}{16}(3\\ell^2 - 2\\ell)\\bigr)^{1/2}\\\\ & \\leq & \\tfrac{3}{16 } \\ell^2,\\end{aligned}\\ ] ] where we used the fact that the length of the sequences @xmath257 and @xmath314 is deterministically @xmath251 , and the number of zeros in @xmath257 and @xmath314 follows a binomial distribution with @xmath360 trials and probability @xmath160 .",
    "[ lemexpectation - variance ] we have @xmath361 = \\tfrac{1}{4 } e^{-(4{\\eta}+ { \\mu}+ { \\lambda } ) t } \\ell \\pm { \\mathcal{s}}_n\\bigl(\\sqrt{k_0 \\log k_0 } \\bigr)\\ ] ] and @xmath362 \\le\\frac{3}{8 } { 1 \\over\\lfloor k_0^{1-\\zeta } \\rfloor } \\ell^2.\\ ] ] in particular , the standard deviation @xmath363 = o\\bigl(k_0^{({3\\zeta- 1})/{2}}\\bigr ) = o\\bigl(\\sqrt{k_0}\\bigr)\\ ] ] for @xmath105 small enough .    from lemma  [ lemindependence ] , the @xmath364 terms in @xmath249 are mutually independent .",
    "the proof then follows from lemmas  [ lemexpectation ] and [ lemvariance ] and the definition of @xmath266 .",
    "we now show that our distance estimate is concentrated . for notational convenience ,",
    "we denote by @xmath365 the probability measure induced by conditioning on the event @xmath335 .",
    "recall that the event @xmath366 is contained in .",
    "[ lemdistanceconcentration1 ] let @xmath367 be such that @xmath368 , and @xmath369 for @xmath105 small enough .",
    "then for @xmath248 large enough @xmath370 \\leq o\\biggl(\\frac{1}{k_0^{\\beta}}\\biggr).\\ ] ]    we use chebyshev s inequality .",
    "we first condition on @xmath371 . recalling that @xmath252 , note that @xmath372\\\\[-2pt ] & & \\qquad \\leq{\\mathbb{p}}_u^*\\biggl[{\\widetilde{{\\mathcal{d}}}}(a , b ) > \\frac{\\ell}{4}e^{-(4{\\eta}+ { \\mu}+ { \\lambda } ) t } + \\frac{\\ell}{4}\\frac{1}{k_0^{\\alpha } } \\big| { \\mathcal{i}},{{\\mathcal{e}}}\\biggr]\\\\[-2pt ] & & \\qquad \\leq{\\mathbb{p}}_u^*\\biggl[{\\widetilde{{\\mathcal{d}}}}(a , b ) > { \\mathbb{e}}[{\\widetilde{{\\mathcal{d}}}}(a , b ) | { \\mathcal{i}},{{\\mathcal{e } } } ] - { \\mathcal{s}}_n\\bigl(\\sqrt{k_0 \\log k_0 } \\bigr ) + \\frac{\\ell}{4}\\frac{1}{k_0^{\\alpha } } \\big| { \\mathcal{i}},{{\\mathcal{e}}}\\biggr]\\\\[-2pt ] & & \\qquad \\leq\\frac{{3}\\ell^2 /({8}{\\lfloor k_0^{1-\\zeta } \\rfloor } ) } { ( { \\ell}/({4}{k_0^{\\alpha } } ) - { \\mathcal{s}}_n(\\sqrt{k_0 \\log k_0 } ) ) ^2}\\\\[-2pt ] & & \\qquad = o\\biggl(\\frac{1}{k_0^{1-\\zeta-2\\alpha}}\\biggr).\\end{aligned}\\ ] ] the other direction is similar . taking expectation over @xmath332 , we have @xmath373 \\leq o\\biggl(\\frac{1}{k_0^{\\beta}}\\biggr).\\ ] ] choose @xmath205 in lemmas  [ lemmalengthconcentration ] and  [ lemsurviving ] large enough so that @xmath374 then , from lemmas  [ lemprobabilityofgoodevent1 ] and  [ lemprobabilityofgoodevent2 ] , we have @xmath375\\\\[-2pt ] & & \\qquad \\leq { \\mathbb{p}}_u^*\\biggl[\\biggl|\\frac{4}{\\ell}{\\widetilde{{\\mathcal{d}}}}(a , b ) - e^{-(4{\\eta}+ { \\mu}+ { \\lambda } ) t } \\biggr| > \\frac{1}{k_0^{\\alpha } } \\big| { { \\mathcal{e}}}\\biggr]{\\mathbb{p}}_u^*[{{\\mathcal{e } } } ] + { \\mathbb{p}}_u^*[{{\\mathcal{e}}}^c]\\\\[-2pt ] & & \\qquad \\leq o\\biggl(\\frac{1}{k_0^{\\beta}}\\biggr).\\end{aligned}\\ ] ]    the proofs of theorems  [ thmconsistency ] and  [ thmmain ] are given in the next section .",
    "we are ready to prove our main result in the molecular clock case .",
    "we postpone the more general case to the next section . a last bit of notation : for a pair of leaves @xmath376 $ ] , we denote by @xmath377 the time between @xmath110 , @xmath111 and their most recent common ancestor .",
    "proof of theorem  [ thmmain ] we first give a bound on the diameter of the tree .",
    "let @xmath378 ( resp . ,",
    "@xmath73 ) be the length of the shortest ( resp . , longest ) path between the root and a leaf in graph distance . because the number of leaves is @xmath10 we must have @xmath379 and @xmath380 .",
    "since all leaves are contemporaneous it must be that @xmath381 . combining these constraints",
    "gives that the diameter @xmath382 satisfies @xmath383 given our bound on the diameter of the tree , it follows that the time from the root @xmath135 of the tree to any leaf is at most @xmath384 .",
    "suppose that the length @xmath159 at the root of the tree satisfies @xmath385 , where @xmath386 is the minimum integer satisfying @xmath387 where the small polynomial factor is taken to be the one used in lemma  [ lemmalengthconcentration ] .",
    "lemma  [ lemmalengthconcentration ] and a union bound then imply that with probability at least @xmath388 for all nodes @xmath8 @xmath389    [ lemalldistances ] for all @xmath390 , @xmath391 , there exists @xmath392 with @xmath207 large enough so that if the sequence length at the root is @xmath393 , then @xmath394 , \\biggl|\\frac{4}{\\ell}{\\widetilde{{\\mathcal{d}}}}(a , b ) - e^{-(4{\\eta}+ { \\mu}+ { \\lambda } ) t_{ab } } \\biggr| \\leq\\frac{1}{n^{\\alpha ' } } \\biggr ] = 1-o\\biggl({1 \\over n^{\\beta'}}\\biggr).\\ ] ]    this follows from lemma  [ lemdistanceconcentration1 ] and our observation above that , if @xmath395 , with probability at least @xmath396 , then @xmath397 for all nodes  @xmath8 .",
    "given our bound on the diameter of the tree , it follows that for all pairs of leaves @xmath110 , @xmath111 and small @xmath219",
    "@xmath398 therefore , choosing @xmath399 large enough in lemma  [ lemalldistances ] , we get that all distances can be estimated within a small @xmath228 simultaneously with probability going to  @xmath72 .    using the standard buneman algorithm",
    ", we can recover the tree efficiently ( see , e.g. ,  @xcite ) .",
    "the proof of theorem  [ thmconsistency ] for the molecular clock case builds on the proof of theorem  [ thmmain ] by treating @xmath10 as a constant and letting the sequence length at the root of the tree go to infinity .",
    "proof of theorem  [ thmconsistency ] we can restate lemma  [ lemalldistances ] in the following form , where the failure probability is expressed more cleanly in terms of the sequence length at the root of the tree .",
    "the proof of the lemma is essentially the same .",
    "[ lemalldistancesrestated ] for all @xmath390 , there exists @xmath400 for @xmath207 large enough such that if the sequence length at the root is @xmath401 , then @xmath402 , \\biggl|\\frac{4}{\\ell}{\\widetilde{{\\mathcal{d}}}}(a , b ) - e^{-(4{\\eta}+ { \\mu}+ { \\lambda } ) t_{ab } } \\biggr| \\leq\\frac{1}{n^{\\alpha ' } } \\biggr]\\\\ & & \\qquad=1- o(n \\cdot k_r^{-\\gamma})-o(n^2 \\cdot k_r^{-\\beta}).\\end{aligned}\\ ] ]    repeating the proof of theorem  [ thmmain ] above , it follows that the algorithm fails to reconstruct the phylogeny with probability @xmath403 .",
    "letting @xmath404 concludes the proof of theorem  [ thmconsistency ] .",
    "we briefly discuss how our results can be extended to gtr models . for background on gtr models , see , for example , @xcite .",
    "let @xmath96 be a reversible @xmath97 rate matrix with stationary distribution @xmath98 .",
    "our new sequence evolution process is identical to the one described in definition  [ defevolutionaryprocessbranch ] except that the substitution process is a continuous - time markov process with rate matrix @xmath99 .",
    "the rate matrix @xmath96 has 4 nonnegative eigenvalues . for convenience , we assume that the largest negative eigenvalue is @xmath405 .",
    "we denote by @xmath406 the corresponding eigenvector which we assume is normalized as @xmath407 we now perform the following transformation of the state space . for a node",
    "@xmath8 , let @xmath408 be the transformed sequence at @xmath8 where @xmath409 ( resp .",
    ", @xmath410 ) if the state at site @xmath215 is @xmath411 ( resp . ,",
    "@xmath412 ) .",
    "note that , under stationarity , the expectation of the state at site @xmath215 is @xmath71 by orthogonality of @xmath98 and @xmath406 .",
    "then our distance estimator is @xmath413 in particular , in the two - state cfn case , we have @xmath414 and we obtain the same estimate as before , up to a constant .",
    "we now analyze the expectation of this quantity . for @xmath133 ,",
    "we let @xmath415    [ lem1prime ] the following holds : @xmath416 = e^{-({\\eta}+{\\mu } ) t } { \\delta}_r.\\ ] ]    [ remnormalize ] note that this formula is slightly different than that in lemma  [ lem1 ] because of the normalization implied by requiring @xmath96 to have second eigenvalue @xmath405 .",
    "proof of lemma  [ lem1prime ] the sites created after @xmath135 contribute @xmath71 in expectation .",
    "of course , so do the deleted sites .",
    "the fraction of sites that survive is @xmath144 .",
    "suppose site @xmath215 survives , then note that @xmath417 = \\sum_{s'}(e^{{\\eta}t q})_{s s ' } w_{s ' } = e^{-{\\eta}t } w_s.\\ ] ] summing over all sites of @xmath135 we get @xmath418 = e^{-({\\eta}+{\\mu } ) t } { \\delta}_r\\ ] ] as claimed .",
    "consider now a `` fork '' tree , that is , a root @xmath135 from which emanates a single edge @xmath152 which in turn branches into two edges @xmath153 and @xmath154 . for @xmath155 ,",
    "we denote the parameters of edge @xmath156 by @xmath157 .",
    "our goal is to compute @xmath158 $ ] assuming that the sequence length at the root is @xmath15 .",
    "the proof is similar to lemma  [ lem2 ] .",
    "[ lem2prime ] the following holds : @xmath161 = e^{-({\\eta}_a+{\\mu}_a ) t_a } e^{-({\\eta}_b+{\\mu}_b ) t_b } e^{-({\\mu}_u - { \\lambda}_u)t_u } k.\\ ] ] note that remark  [ remnormalize ] also applies here .",
    "we have @xmath162 & = & { \\mathbb{e}}[{\\delta}_a { \\delta}_b]\\\\ & = & { \\mathbb{e}}[{\\mathbb{e}}[{\\delta}_a { \\delta}_b | { \\sigma}_u ] ] \\\\ & = & { \\mathbb{e}}[{\\mathbb{e}}[{\\delta}_a | { \\sigma}_u]{\\mathbb{e}}[{\\delta}_b | { \\sigma}_u]]\\\\ & = & e^{-{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-{\\eta}_b t_b } e^{-{\\mu}_b t_b } { \\mathbb{e}}[{\\delta}_u^2]\\\\ & = & e^{-{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-{\\eta}_b t_b } e^{-{\\mu}_b t_b } { \\mathbb{e}}[{\\mathbb{e}}[{\\delta}_u^2 | k_u]]\\\\ & = & e^{-{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-{\\eta}_b t_b } e^{-{\\mu}_b t_b } { \\mathbb{e}}[{\\operatorname{var}}[{\\delta}_u | k_u ] ] \\\\ & = & e^{-{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-{\\eta}_b t_b } e^{-{\\mu}_b t_b } { \\mathbb{e}}[k_u { \\operatorname{var}}[{\\sigma}_u^1]]\\\\ & = & e^{-{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-{\\eta}_b t_b } e^{-{\\mu}_b t_b } { \\mathbb{e}}[k_u { \\mathbb{e}}[({\\sigma}_u^1)^2]]\\\\ & = & e^{-{\\eta}_a t_a } e^{-{\\mu}_a t_a } e^{-{\\eta}_b t_b } e^{-{\\mu}_b t_b } e^{-({\\mu}_u - { \\lambda}_u)t_u } k\\end{aligned}\\ ] ] by lemma  [ lem1prime ] .    from the previous lemmas",
    ", one can adapt the proofs above to the gtr case .",
    "using lemma  [ lem2prime ] , we can get rid of the molecular clock assumption . consider again the fork tree , but assume that each edge is in fact a path .",
    "an adaptation of lemma  [ lem2prime ] gives the following lemma .",
    "[ lem3prime ] the following holds : @xmath419}{\\sqrt{{\\mathbb{e}}[k_a ] { \\mathbb{e}}[k_b]}}\\biggr ) = \\sum_{e\\in{\\mathrm{p}}(a , b)}({\\eta}_e+{\\mu}_e/2+{\\lambda}_e/2 ) t_e.\\ ] ] note that remark  [ remnormalize ] also applies here .    note that @xmath420 ) = \\sum_{e\\in{\\mathrm{p}}(r , a ) } ( { \\mu}_e - { \\lambda}_e)t_e\\ ] ] and similarly for @xmath111 . a variant of lemma  [ lem2prime ] gives @xmath421 ) = \\sum_{e\\in{\\mathrm{p}}(a , b)}({\\eta}_e+{\\mu}_e ) t_e + \\sum_{e\\in{\\mathrm{p}}(r , u ) } ( { \\mu}_e - { \\lambda}_e)t_e.\\ ] ] the result follows by subtracting the previous expressions .    the expression in lemma  [ lem3prime ] provides the additive metric needed to extend our results to nonclock bounded - rates case .",
    "we have shown how to reconstruct phylogenies under the bounded - rates , gtr model with indels .",
    "our efficient algorithm requires polynomial - length sequences at the root .",
    "a natural open problem arises from this work : can our results be extended to general trees with bounded branch lengths , as opposed to the bounded - rates model ?",
    "the key difference between the two models is that the former may have a linear diameter whereas the latter has logarithmic diameter . to extend our results",
    ", one would need to deal with far away leaves that are almost uncorrelated but for which our block structure does not apply ."
  ],
  "abstract_text": [
    "<S> we present an efficient phylogenetic reconstruction algorithm allowing insertions and deletions which provably achieves a sequence - length requirement ( or sample complexity ) growing polynomially in the number of taxa . </S>",
    "<S> our algorithm is distance - based , that is , it relies on pairwise sequence comparisons . </S>",
    "<S> more importantly , our approach largely bypasses the difficult problem of multiple sequence alignment .    .    . </S>"
  ]
}