{
  "article_text": [
    "numerical relativity has become a field of intense activity and considerable progress has been made during the last decade .",
    "the possible detection of gravitational waves by the second - generation enhanced detectors ( advanced ligo @xcite , advanced virgo @xcite and kagra @xcite ) represents a major incentive for the development of numerical simulations able to provide accurate gravitational waveforms from astrophysical sources .",
    "many current numerical relativity codes use the so - called bssn formulation of einstein equations , originally proposed by nakamura _ et.al .",
    "_  @xcite and subsequently modified by shibata and nakamura  @xcite and baumgarte and shapiro  @xcite .",
    "the stability properties of the bssn formulation are a result of the  conformal connection functions \" , which are introduced as new independent variables . in combination with certain gauge conditions  in particular the  1+log \" slicing condition  @xcite and the  gamma - driver condition \"  @xcite  the bssn formulation has allowed for accurate and stable simulations of strong - field spacetimes , including black holes and neutron stars .",
    "recently , other conformal and traceless decompositions of the einstein equations , based on the z4 system  @xcite , have been proposed by bernuzzi and hilditch  @xcite , the so - called z4c formulation , and also by alic _ et.al .",
    "_  @xcite , the ccz4 formulation .",
    "unlike the bssn formulation , both the z4c and ccz4 systems incorporate the constraint damping scheme developed by gundlach _ et.al .",
    "_  @xcite that allows for the dynamical control of the constraint violations by means of constraint damping terms .",
    "the z4c system discards non - damping non - principal terms , breaking the 4-covariance , but allowing the evolution equations to take a form that is very similar to bssn .",
    "the ccz4 system , on the other hand , retains all damping terms and maintains the 4-covariance .",
    "nevertheless , the ccz4 system as presented initially in  @xcite suffers from numerical instabilities that develop in black hole spacetimes unless the 4-covariance is broken .",
    "this issue was addressed by alic _ et.al .",
    "_  @xcite , who prescribed a modification for the damping parameter that removes the instabilities when using the fully covariant version of the ccz4 system in the evolution of black holes .",
    "both conformal decompositions of the z4 system have been tested extensively  @xcite .",
    "numerical results show that , in non - vacuum simulations , violations of the hamiltonian constraint can be as much as 1 to 3 orders of magnitude smaller than those in the bssn formulation .",
    "both the bssn and the ccz4 or z4c formulations in their original form are developed under the assumption of cartesian coordinates ; in particular they assume that the determinant of the conformal metric is equal to one . in the case of the bssn formulation ,",
    "this issue was resolved by @xcite , who introduced a covariant formulation of the bssn equations that is well - suited for curvilinear coordinate systems by adopting a reference - metric framework  @xcite .",
    "this approach allows , for example , for implementations in spherical polar coordinates , which is of great interest since many astrophysical phenomena are symmetric with respect to the rotation axis ( e.g. , accretion disks ) or are such that spherical coordinates adapt better to their geometry ( e.g. , gravitational collapse ) .",
    "the singularities associated with curvilinear coordinate systems , however , are a known source of numerical problems . for instance",
    ", one problem arises because of the presence of terms in the evolution equations that diverge like @xmath0 near the origin @xmath1 .",
    "several methods have been proposed to deal with the singular terms that appear in curvilinear coordinates .",
    "cordero - carrin _ et.al .",
    "_  @xcite recently adopted a partially implicit runge - kutta ( pirk ) method to evolve hyperbolic , wave - like equations in the fully constrained formulation of the einstein equations ( see @xcite ) .",
    "montero and cordero - carrin @xcite , assuming spherical symmetry , applied a second - order pirk method to the bssn equations and obtained stable numerical simulations of vacuum and non - vacuum spacetimes without the need for a regularization algorithm at the origin .",
    "this approach has been successfully implemented in 3d without any symmetry assumption by  @xcite and more recently by  @xcite who reported the first successful implementation of relativistic hydrodynamics coupled to dynamical spacetimes in spherical polar coordinates with no symmetry assumptions .",
    "the purpose of this paper is threefold .",
    "we first generalize the covariant and conformal z4 system using a reference - metric approach . we refer to this new system as  fully covariant and conformal z4 \" or fccz4 for short .",
    "this approach allows us to write the evolution equations in a fully covariant form suitable for spherical polar and other curvilinear coordinates .",
    "second , we implement the fccz4 system in spherical polar coordinates under the assumption of spherical symmetry , and show that using the pirk scheme we obtain robust and stable numerical evolutions of both vacuum and non - vacuum spacetimes .",
    "third , we show that the fccz4 formulation with the pirk scheme can handle spacetimes containing black holes without the appearance of any instability and without the need for the modification prescribed by alic _ et.al .",
    "_  @xcite .",
    "finally , we compare results obtained with the bssn and the fccz4 formulations . confirming earlier results",
    ", we find that , for certain choices of free parameters , fccz4 can significantly reduce constraint violations , in particular for neutron - star spacetimes . for black - hole simulations , however , the advantages of fccz4 over bssn are less evident .",
    "we also discuss implications of the presence of free and dimensional damping parameters in the fccz4 formalism .",
    "the paper is organized as follows .",
    "section  [ section : form ] describes the fccz4 evolution equations . in section  [ fcccz4-spherical ]",
    "we write the fccz4 equations in spherical coordinates under the assumption of spherical symmetry . section  [ section : implementation ] describes the numerical implementation and section  [ section : results ] shows results from a number of numerical experiments , namely a pure gauge wave , the evolution of a single black hole , the evolution of a spherical relativistic star in equilibrium , the so - called migration test , and the gravitational collapse of a spherical relativistic star leading to the formation of a black hole .",
    "we summarize and discuss the respective advantages and disadvantages of fccz4 and bssn in section  [ section : summary ] . throughout this article",
    "we will use gravitational units @xmath2 .",
    "greek indices denote spacetime indices ( 0 to 3 ) , while latin indices denote space indices only ( 1 to 3 ) .",
    "the z4 constraint damped system  @xcite in its 4-dimensional covariant form replaces the einstein equations by @xmath3= 8\\pi \\left(t_{\\mu\\nu}-\\frac{1}{2}g_{\\mu \\nu}t\\right),\\quad\\end{aligned}\\ ] ] where @xmath4 is the ricci tensor of the 4-dimensional spacetime @xmath5 with metric @xmath6 , @xmath7 the covariant derivative associated with metric @xmath6 , @xmath8 the stress - energy tensor and @xmath9 its trace .",
    "the above equation reduces to einstein s equations when the additional 4-vector @xmath10 vanishes .",
    "the two arbitrary constants @xmath11 and @xmath12 serve as constraint damping coefficients . while @xmath12 is dimensionless , @xmath11 has units of inverse length .    in the 3 + 1 decomposition",
    "we assume that the spacetime @xmath5 can be foliated by a family of spatial slices @xmath13 that coincide with level surfaces of a coordinate time @xmath14 .",
    "we denote the future - pointing unit normal on @xmath13 with @xmath15 and write the line element as @xmath16 where @xmath17 is the lapse function , @xmath18 the shift vector , and @xmath19 the spatial metric induced on @xmath13 . in terms of the lapse and shift , the normal vector @xmath15 can be expressed as @xmath20    as in the bssn formulation we adopt a conformal decomposition of the spatial metric @xmath21 where @xmath22 is the conformal factor and @xmath23 the conformally related metric .",
    "we will refer to the connection coefficients associated with @xmath23 as @xmath24 . instead of determining the conformal factor by fixing the determinant of the conformal metric , @xmath25 to unity ,",
    "as is suitable for cartesian coordinates , we adopt @xmath26 where @xmath27 is the determinant of @xmath19 . in order to determine the conformal factor we then impose brown s  lagrangian \" condition @xmath28    we denote the conformally rescaled extrinsic curvature as @xmath29 where @xmath30 is the physical extrinsic curvature and @xmath31 its trace .",
    "we next introduce a reference metric @xmath32 with corresponding reference connection @xmath33 .",
    "we then define the difference between the connections associated with the conformally related and the reference metric as @xmath34 and note that , unlike the individual connections , these objects transform as a tensor field .    in the z4 system ,",
    "the hamiltonian and momentum constraints result in equations for the four - vector @xmath10 . in a 3 + 1 decomposition , these equations can be written as evolution equations for the projection of the @xmath35 along the normal @xmath15 , which , following convention , we define as @xmath36 and the spatial projection of @xmath10 , @xmath37 here @xmath38 now denotes a spatial vector whose index can be raised with the ( inverse ) spatial metric , @xmath39 .",
    "defining @xmath40 where @xmath41 denotes the lie derivative along the shift vector @xmath42 , the fully covariant and conformal z4 system in a reference - metric approach ( fccz4 ) is then given by the following set of evolution equations : @xmath43^{\\text{tf}},\\label{eq9}\\\\ \\partial_{\\bot}\\phi&=&\\frac{1}{6}\\mathcal{\\bar d}_{i}\\beta^{i}-\\frac{1}{6}\\alpha k,\\label{eq10}\\\\ \\partial_{\\bot}k&=&e^{-4\\phi}\\bigl[\\alpha\\bigl(\\bar r-8\\mathcal{\\bar d}^{i}\\phi\\mathcal{\\bar d}_{i}\\phi-8\\mathcal{\\bar d}^{2}\\phi\\bigl)\\nonumber\\\\ & & -\\bigl(2\\mathcal{\\bar d}^{i}\\alpha\\mathcal{\\bar d}_{i}\\phi+\\mathcal{\\bar d}^{2}\\alpha\\bigl)\\bigl]+\\alpha(k^{2}-2\\theta k)\\nonumber\\\\ & & + 2\\alpha\\mathcal{d}_{i}z^{i}-3\\alpha\\kappa_{1}(1+\\kappa_{2})\\theta\\nonumber\\\\ & & + 4\\pi\\alpha(s-3e),\\label{eq11}\\\\ \\partial_{\\bot}\\theta&=&\\frac{1}{2}\\alpha\\bigl[e^{-4\\phi}\\bigl(\\bar r-8\\mathcal{\\bar d}^{i}\\phi\\mathcal{\\bar d}_{i}\\phi-8\\mathcal{\\bar d}^{2}\\phi\\bigl)\\nonumber\\\\ & & -\\bar a^{ij}\\bar a_{ij}+\\frac{2}{3}k^{2}-2\\theta k+2\\mathcal{d}_{i}z^{i}\\bigl]\\nonumber\\\\ & & -z^{i}\\partial_{i}\\alpha-\\alpha\\kappa_{1}(2+\\kappa_{2})\\theta-8\\pi\\alpha e,\\label{eq12}\\\\ \\partial_{\\bot}\\tilde\\lambda^{i}&=&\\bar\\gamma^{jk}\\mathcal{\\hat d}_{j}\\mathcal{\\hat d}_{k}\\beta^{i}+\\frac{2}{3}\\delta\\gamma^{i}\\mathcal{\\bar d}_{j}\\beta^{j}+\\frac{1}{3}\\mathcal{\\bar d}^{i}\\mathcal{\\bar d}_{j}\\beta^{j}\\nonumber\\\\ & & -2\\bar a^{jk}\\bigl(\\delta^{i}_{\\,\\,j}\\partial_{k}\\alpha-6\\alpha\\delta^{i}_{\\,\\,j}\\partial_{k}\\phi-\\alpha\\delta\\gamma^{i}_{jk}\\bigl)\\nonumber\\\\ & & - \\frac{4}{3}\\alpha\\bar\\gamma^{ij}\\partial_{j}k+2\\bar\\gamma^{ki}\\bigl(\\alpha\\partial_{k}\\theta-\\theta\\partial_{k}\\alpha-\\frac{2}{3}\\alpha k z_{k}\\bigl)\\nonumber\\\\ & & -2\\alpha\\kappa_{1}\\bar\\gamma^{ij}z_{j}-16\\pi\\alpha\\bar\\gamma^{ij}s_{j}.\\label{eq13}\\end{aligned}\\ ] ] here the superscript tf denotes the trace - free part of a tensor , @xmath11 and @xmath12 are the damping coefficients introduced by  @xcite , and @xmath44 , @xmath45 and @xmath46 denote the covariant derivatives built from the connection associated with the reference metric @xmath47 , the physical metric @xmath19 and the conformal metric @xmath48 , respectively .",
    "we have also defined @xmath49 where @xmath50 the vector @xmath51 plays the role of the `` conformal connection functions '' in the original ccz4 system ; its evolution equation ( [ eq13 ] ) involves the evolution equation for the variables @xmath38 .",
    "the matter sources @xmath52 , @xmath53 , @xmath54 and @xmath55 denote the density , momentum density , stress , and the trace of the stress as observed by a normal observer , respectively : @xmath56    in eq .",
    "( [ eq9 ] ) , we compute the ricci tensor @xmath57 associated with @xmath48 from @xmath58 here we compute the @xmath59 from their definition ( [ eq6 ] ) . given @xmath59 , and values for @xmath60 , the vectors @xmath38 , which are not evolved independently , can be determined from ( [ def_lambda ] ) .    unless stated otherwise we fix the gauge freedom by imposing the so called  non - advective 1+log `` condition for the lapse  @xcite @xmath61 and a variation of the ' ' gamma - driver \" condition for the shift vector  @xcite @xmath62    finally , when @xmath63 , the evolution equations ( [ eq8])-([eq13 ] ) imply that the hamiltonian and momentum constraints hold in the form @xmath64 where @xmath65 is the trace of @xmath57",
    ".    in cartesian coordinates , when @xmath66 and @xmath67 , the above equations reduce to the ccz4 equations of @xcite , except that we have set their coefficients @xmath68 to unity .",
    "under the assumption of spherical symmetry , the space line element can be written in spherical coordinates ( @xmath70 ) as @xmath71,\\ ] ] where @xmath72 is the solid angle element , and @xmath73 and @xmath74 are the metric functions . since the evolution equations for the conformally related metric and the conformal factor , eqs .",
    "( [ eq8 ] ) and ( [ eq10 ] ) , take the exact from as their counterparts in the bssn formulation , their spherically symmetric versions also remain unchanged @xmath75 ( see @xcite for the bssn system in spherical symmetry . ) here @xmath76 and @xmath77 to impose the lagrangian condition ( [ lagrange ] ) on the time evolution of the determinant of the conformal metric .",
    "the covariant derivative of the shift vector can be written as @xmath78 and we have defined @xmath79 note that the quantity @xmath80 is evolved in eq .",
    "( [ eq28 ] ) instead of the conformal factor @xmath81 itself .",
    "the evolution equation for the trace of the extrinsic curvature @xmath82 is @xmath83 while for @xmath84 we have @xmath85 here we defined @xmath86 and @xmath87 .",
    "the divergence of the @xmath88 vector with respect to the physical metric is @xmath89    in spherical symmetry , the evolution equation ( [ eq9 ] ) for the independent component of the traceless part of the conformal extrinsic curvature , @xmath90 , reduces to @xmath91 where @xmath92 is the mixed radial component of the physical , spatial ricci tensor .",
    "the covariant derivative of the @xmath93 is @xmath94\\label{38}.\\end{gathered}\\ ] ]    from the definition ( [ def_lambda ] ) we have @xmath95 where @xmath96.\\ ] ] the evolution equation for @xmath97 in spherical symmetry can then be derived from eq .",
    "( [ eq13 ] ) , @xmath98\\\\ & + \\frac{2}{a}\\biggl(\\alpha\\partial_{r}\\theta-\\theta\\partial_{r}\\alpha-\\frac{2}{3}\\alpha kz_{r}\\biggl)\\\\ & + \\frac{2}{a}\\biggl(\\frac{2}{3}z_{r}\\mathcal{\\bar d}_{m}\\beta^{m}-z_{r}\\partial_{r}\\beta^{r}\\biggl)-\\frac{2}{a}\\kappa_{1}z_{r}. \\end{split}\\ ] ]    the hamiltonian and momentum constrains are given by the following two equations that we compute to monitor the accuracy of the numerical evolutions : @xmath99    the gauge condition for the lapse and the shift are the same as in eqs .",
    "( [ eq14]-[eq16 ] ) , but taking only the radial component for the shift and the vector @xmath100 , and replacing @xmath51 by @xmath101 as in the evolution equation ( [ eq39 ] ) .",
    "the general relativistic hydrodynamics equations , expressed through the conservation equation for the stress - energy tensor @xmath102 and the continuity equation , are @xmath103 where @xmath104 is the rest - mass density and @xmath105 the 4-velocity of the fluid .",
    "following @xcite , we write the equations of general relativistic hydrodynamics in a conservative form in spherical symmetry . we define the fluid 3-velocity as seen by a normal observer as @xmath106 and the lorentz factor between the fluid and the normal observer as @xmath107 we also define the fluid density , momentum density and energy density , all as observed by a normal observer , as @xmath108 where @xmath109 is the specific enthalpy and @xmath110 the pressure .",
    "we then assemble these variables into a vector @xmath111 of conserved fluid variables @xmath112 defining corresponding fluxes , @xmath113 , as @xmath114,\\end{aligned}\\ ] ] we can cast the equations of hydrodynamics ( [ hydro eqs ] ) in conservative form @xmath115 here @xmath116 is a vector of source terms given by @xmath117.\\end{aligned}\\ ] ] to close the system of equations , we choose a gamma - law equation of state ( eos ) @xmath118 where @xmath119 is the adiabatic index and @xmath120 is the specific internal energy .",
    "we have implemented the fccz4 system under the assumption of spherical symmetry in the 1d - code described in montero and cordero - carrin @xcite .",
    "this code solves the einstein equations coupled to the general relativistic hydrodynamics equations .",
    "the einstein equations are solved using either the bssn or the fccz4 formalisms .",
    "we employ a second - order pirk method to integrate the evolution equations in time . writing a system of pdes as follows",
    "u_t = _ 1 ( u , v ) , + v_t = _ 2 ( u ) + _ 3 ( u , v ) , [ e : system ]    where @xmath121 , @xmath122 and @xmath123 represent general non - linear differential operators , the second - order pirk method takes the following form :    u^(1 ) = u^n + t l_1 ( u^n , v^n ) , + v^(1 ) = v^n + t ,    u^n+1 = , + v^n+1 = v^n + ,    where we denote by @xmath124 , @xmath125 and @xmath126 the corresponding discrete operators . in particular , we note that @xmath124 and @xmath126 will be treated in an explicit way , whereas the @xmath125 operator will contain the singular terms appearing in the sources of the equations and , therefore , will be treated partially implicitly .    in the first stage ,",
    "@xmath127 is evolved explicitly ; the updated value @xmath128 is used in the evaluation of the @xmath125 operator for the computation of @xmath129 .",
    "once all the values of the first stage are obtained , @xmath127 is evolved explicitly ( using the values of the variables of the previous time - step and previous stage ) , and the updated value @xmath130 is used in the evaluation of the @xmath125 operator for the computation of @xmath131 .",
    "the precise evolution algorithm we use in the code is as follows :    * firstly , the hydrodynamic conserved quantities , the conformal metric components @xmath132 and @xmath133 , the conformal factor @xmath81 or the quantity @xmath80 , the lapse function @xmath17 , and the radial component of the shift vector @xmath134 , are evolved explicitly ( as @xmath127 is evolved in the previous pirk scheme ) . * secondly , the traceless part of the extrinsic curvature , @xmath135 , the trace of the extrinsic curvature , @xmath82 , and the projection of the four - vector @xmath136 along the normal direction , @xmath84 , are evolved partially implicitly , using updated values of @xmath17 , @xmath132 , @xmath133 and @xmath80 .",
    "* next , the quantity @xmath137 is evolved partially implicitly using the updated values of @xmath17 , @xmath132 , @xmath133 , @xmath134 , @xmath80 , @xmath135 , @xmath82 and @xmath84 . *",
    "finally , @xmath138 is evolved partially implicitly using the updated values of @xmath139 .",
    "we note that the matter source terms are always included in the explicitly treated parts . in appendix",
    "[ appendix ] , we give the exact form of the source terms included in each operator .      the spatial domain for our computations is defined as @xmath140 , where @xmath141 refers to the location of the outer boundary .",
    "we use a cell - centered grid to avoid the origin from coinciding with a grid point . at the origin",
    "we impose boundary conditions derived from the assumption of spherical symmetry , while at the outer boundary we impose sommerfeld boundary conditions for the spacetime variables  @xcite .",
    "we compute derivatives in the spacetime evolution using a fourth - order centered finite difference approximation on a uniform grid except for the advection terms ( i.e.  terms of the form @xmath142 ) , for which we adopt a fourth - order upwind scheme .",
    "we also use fourth - order kreiss - oliger dissipation @xcite to avoid high frequency noise appearing near the outer boundary .    for the equations of hydrodynamics we implement a high resolution shock capturing scheme ( hrsc ) that consist of a second - order slope limiter reconstruction scheme ( mc limiter ) to obtain the left and right states of the primitive variables at each cell interface , and the hlle approximate riemann solver  @xcite .",
    "we add a low density atmosphere to handle vacuum regions ; more specifically we treat the atmosphere as a perfect fluid with rest - mass density several orders of magnitude smaller than that of the bulk matter .",
    "further details of our implementation can be found in @xcite .",
    "we now describe several numerical experiments with the fccz4 formalism . for each one we will describe the initial data for the gravitational field and hydrodynamics quantities in the corresponding section ;",
    "in addition we always impose @xmath143 and @xmath144 at the initial time @xmath145 .",
    "we first consider the propagation of a pure gauge pulse .",
    "following @xcite we choose as initial data @xmath146,\\label{eq48}\\end{aligned}\\ ] ] with @xmath147 and @xmath148 .",
    "the quantity @xmath149 is the length scale of the test . in this test",
    ", we employ zero shift and harmonic slicing .",
    "the slicing condition is suitably written for the fccz4 formulation by introducing the @xmath84 variable in the evolution equation for the lapse function , @xmath150    we choose a grid resolution of @xmath151 ( except for the convergence test described at the end of this section ) and a time step of @xmath152 , where @xmath153 is the courant factor . among our first observations is that the fccz4 formalism requires a smaller courant factor than the bssn formalism , confirming similar findings by @xcite ; we found stable evolution for @xmath154 for fccz4 , and @xmath155 for bssn .      +        in fig .",
    "[ fig : graf1 ] we show the hamiltonian constraint at four different times ( @xmath156 ) for evolutions performed with the bssn and the fccz4 formulations . following  @xcite and",
    "@xcite we also compare different choices for the damping parameters @xmath157 and @xmath158 for the fccz4 system . for the bssn system ,",
    "the violations of the hamiltonian constraint settle down to approximately @xmath159 close to the origin at @xmath1 , and do not decrease with time after that ( recall that we do not employ any regularization scheme at the origin ) .",
    "as shown in fig .",
    "[ fig : graf1 ] , the behavior for the fccz4 system is different . here , the constraint violations propagate toward the outer boundary ; close to the origin , the constraint violations end up being approximately three order of magnitude smaller than for the bssn system .",
    "we also note that the constraint violations decrease with increasing values of the damping parameter @xmath160 .",
    "however , one should handle this parameter with precaution as we observed that taking larger values for @xmath160 ( e.g. @xmath161 ) reduces the propagation of the hamiltonian constraint violation considerably and leads to over - damping effects : a  pulse \" remains near the origin .        in fig .",
    "[ fig : graf2 ] we plot the l2-norm , which is normalized by the total number of grid points of the hamiltonian constraint for bssn and fccz4 as a function of time for different values of the parameters @xmath160 and @xmath162 .",
    "the largest violations occur at @xmath163 when the ingoing pulse reaches the origin and reflects ( see fig .",
    "[ fig : graf1 ] ) . for any value of the damping parameters the l2-norm of the hamiltonian constraint is two orders of magnitude smaller for fccz4 than for bssn at the same time .    at times",
    "@xmath164 , different choices of the damping parameters lead to different evolution of the l2-norm .",
    "the undamped fccz4 system ( @xmath165 ) does not show any improvement in the constraint violation with respect to bssn .",
    "increasing @xmath160 while keeping @xmath166 , we obtain constraint violations which are 1 to 3 orders of magnitude smaller than with bssn .",
    "choosing @xmath167 and @xmath168 further improves the results . with @xmath169 and @xmath170",
    ", we find a larger violation of the constraint than with @xmath171 .",
    "overall , we find that these results for the @xmath162 parameter are similar to those reported by  @xcite for simulations of binary neutron stars .",
    "we also performed three simulations with different resolutions @xmath172 to test the convergence of the code .",
    "we show in fig .",
    "[ fig : graf3 ] the rescaled hamiltonian constraint at @xmath173 for the particular choice of damping parameters @xmath174 and @xmath175 , demonstrating that the expected second - order convergence of our pirk time - evolution scheme is achieved .",
    "for three different resolutions @xmath176 , rescaled by the factors corresponding to second - order convergence.,scaledwidth=111.0% ]      we next evolve a single schwarzschild black hole given by wormhole initial data and follow the coordinate evolution to the trumpet geometry . we show that we are able to evolve spacetimes containing singularities without breaking the original covariance of the z4 formulation .",
    "we use the gauge conditions given by equations ( [ eq14])-([eq16 ] ) , for which the evolution settles down to a maximally sliced trumpet @xcite .",
    "the computational domain has a resolution of @xmath177 , @xmath178 and we use @xmath179 grid points to place the outer boundary sufficiently far away from the  puncture \" at @xmath180 .        in fig .",
    "[ fig : graf4 ] we plot the time evolution of the apparent horizon ( ah ) mass ( defined as @xmath181 , where @xmath182 is the proper area of the horizon ) for bssn and fccz4 .",
    "the upper panel shows this quantity from the onset of the numerical simulation , while the lower panel shows the ah mass only during the stationary phase when the wormhole topology has settled to the trumpet topology .",
    "we neither display the ah mass for the fccz4 system with @xmath165 nor with @xmath183 , @xmath166 because of the appearance of numerical instabilities ( see fig .",
    "[ fig : graf5 ] ) . for higher values of @xmath160 and @xmath162",
    "we obtain stable black hole evolutions . in these cases ,",
    "the difference between the ah mass for bssn and fccz4 is less than 0.005% at the end of the simulation ( @xmath184 ) , while the error with respect to the initial adm mass is @xmath185% .",
    "we note , however , that the black hole mass continues to drift for the ccz4 formulation , while it remains constant after an initial transition for the bssn formulation . for the ccz4 formulation",
    "similar results for the bh mass were obtained by  @xcite , who report errors in the range 0.1 - 2.8% .",
    "in contrast , the error is smaller for the z4c formulation , around 0.03% of the initial adm mass ( see also @xcite ) .    in fig .",
    "[ fig : graf5 ] we plot the l2-norm of the hamiltonian constraint violations .",
    "the upper panel displays the l2-norm evolution in the whole computational domain while in the lower panel we plot the l2-norm evolution only in the region outside the ah .",
    "clearly , the larger violation of the hamiltonian constraint takes place due to the finite differencing close to the puncture , for both formulations of the einstein equations .",
    "however , the l2-norm of the hamiltonian constraint violation computed outside the ah shows that there are some differences between the two formulations which also depend on the values for the damping coefficients .",
    "we observe that the numerical evolutions develop instabilities for @xmath166 and @xmath186 .",
    "selecting @xmath187 and @xmath167 ( light blue dashed line ) leads to an over - damped behavior that is responsible for the exponential growth of the constraint violation at late times .",
    "we find that @xmath166 with @xmath187 or @xmath188 give the best results , leading to constraint violations that are comparable to those achieved with bssn .",
    "our numerical experiments with black hole initial data indicate that choosing the damping parameter @xmath162 different from zero does not help in reducing violations of the hamiltonian constraint .",
    "we therefore choose @xmath189 for the remainder of the paper .     in the evolution . _",
    "lower panel : _ same quantity but computed outside the ah.,title=\"fig:\",scaledwidth=111.0% ]   in the evolution .",
    "_ lower panel : _ same quantity but computed outside the ah.,title=\"fig:\",scaledwidth=111.0% ]       and bssn .",
    "_ lower panel : _ the l1 norm between the evolved rest - mass density and the initial density as a function of time , rescaled for three different resolutions @xmath190 for the fccz4 system.,title=\"fig:\",scaledwidth=111.0% ]   and bssn .",
    "_ lower panel : _ the l1 norm between the evolved rest - mass density and the initial density as a function of time , rescaled for three different resolutions @xmath190 for the fccz4 system.,title=\"fig:\",scaledwidth=111.0% ]    in this section we turn to non - vacuum spacetimes and describe results for the coupled system formed by the einstein equations and the equations of general relativistic hydrodynamics .",
    "we construct spherically symmetric initial data by solving the tolman - oppenheimer - volkoff ( tov ) equations for a polytropic equation of state @xmath191 where @xmath82 is the polytropic constant and @xmath192 the polytropic index , and evolve these data with the gamma - law equation of state ( [ eos1 ] ) with @xmath193 . throughout the remainder of the paper we will adopt @xmath194 .",
    "we also adopt code units in which @xmath195 ; we then choose @xmath196 in these units .",
    "in this section we consider a star with a central density of @xmath197 .",
    "solving the tov equations then results in star of gravitational mass @xmath198 , baryon rest - mass @xmath199 and radius @xmath200 km .",
    "we evolve these initial data with @xmath201 grid - points and a grid resolution of @xmath202 ( so that the interior of the star is covered by approximately 200 grid - points ) until a final time @xmath203 ( corresponding to 45 light crossing times ) .",
    "we investigate the effect of the damping parameter @xmath160 during the time evolution of the tov solution and explore the parameter space choosing @xmath204 in our code units , or @xmath205 . in the upper panel of fig .",
    "[ fig : graf6 ] , we show the time evolution of the normalized central rest - mass density of the star .",
    "this figure shows the distinctive periodic radial oscillations which are triggered by finite - difference errors .",
    "these oscillations behave differently depending on the evolution formalism and the choices of the damping parameters in fccz4 .",
    "we find that the amplitude of the oscillations is reduced when the damping parameter is increased ( compare the red dashed line and the green dashed line ) .",
    "choosing too large a value , @xmath206 , causes overdamping effects which lead to a drift in the central rest - mass density and a growth in the l2-norm of the hamiltonian constraint ( see fig .  [",
    "fig : graf7 ] ) . for smaller values of @xmath207 (",
    "i.e.  @xmath208 or 0.098 ) the secular drift in the central density at late times is very similar for fccz4 and bssn .",
    "we observe that the amplitude of the oscillations decreases slightly faster for the fccz4 system than for bssn , indicating that bssn has a slightly smaller numerical viscosity .",
    "the fourier transform of the time evolution of the central rest - mass density for the fccz4 formulation , with @xmath209 , agrees well with the fundamental frequency and the radial normal mode frequencies obtained with linear perturbation techniques @xcite .",
    "the relative error is less than 0.1% for the fundamental mode and less than 0.4% for the first three overtones .",
    "we also performed a convergence test of the fccz4 implementation for the stable spherical star . in the lower panel of fig .",
    "[ fig : graf6 ] we show three different curves corresponding to three different resolutions for the l1-norm of the difference between the evolved rest - mass density and the initial value of the density inside the star .",
    "these findings again demonstrate second - order convergence , as expected .",
    "( in our code units).,scaledwidth=111.0% ]    finally , in fig",
    ".  [ fig : graf7 ] we plot the l2-norm of the hamiltonian constraint and we find that the constraint violations for fccz4 are several orders of magnitude ( at least two ) smaller than for bssn .",
    "the influence of the damping parameter @xmath210 is not significant in the range @xmath211 , but for larger values , e.g.  @xmath212 , we find an exponential growth in the l2-norm . at a reference time @xmath213 ,",
    "the l2-norm is roughly one order of magnitude larger than with @xmath214 , but still two orders of magnitude smaller than for bssn .",
    "our next test of fccz4 is the so - called migration test of an unstable relativistic star in hydrostatic equilibrium  @xcite . for this test",
    "we choose as initial data a tov solution on the unstable branch , meaning with a density larger than that of the maximum mass configuration .",
    "depending on the initial perturbation , this unstable model may either collapse to a black hole , or perform initially large oscillations about a stable tov configuration with smaller central density .",
    "as in section [ sec : stabletov ] we adopt @xmath194 and @xmath196 ( in our code units ) , but we now choose a central rest - mass density of @xmath215 . the resulting star has a gravitational mass @xmath216 , a baryon rest - mass @xmath217 , and a radius @xmath218 km .",
    "we evolve these data with @xmath201 grid - points and a resolution @xmath219 .",
    "( in our code units).,title=\"fig:\",scaledwidth=111.0% ]   ( in our code units).,title=\"fig:\",scaledwidth=111.0% ]    in an ideal gas , the gravitational binding energy is gradually converted into internal energy via shock heating .",
    "therefore , the high - amplitude oscillations around the new equilibrium configuration are damped and the heated stable equilibrium model approaches a central density slightly smaller than the rest - mass density of a zero temperature star of the same rest - mass ( @xmath220 ) .",
    "this is shown in the upper panel of fig .",
    "[ fig : grafm1 ] , which displays the evolution of the normalized central density .",
    "after the star has migrated to the stable branch , it undergoes a series of strong expansions and contractions around the new stable configuration . during the contraction phase , shock waves are formed inside the star .",
    "when these shock waves reach the surface , small amounts of mass are expelled from the object .",
    "taking @xmath206 , fccz4 and bssn provide very similar results for the evolution of the central density .",
    "however , with @xmath221 , or @xmath222 , differences become visible at late times .",
    "the oscillations become more damped for these values of the damping parameter ( slightly more for the undamped fccz4 with @xmath223 ) , and a phase lag appears in the oscillations . nevertheless , the differences are not significant .",
    "the lower panel of fig .",
    "[ fig : grafm1 ] shows that for the higher value of the damping parameter , the l2 norm of the hamiltonian constraint is reduced by two orders of magnitude with respect to bssn , while for the other values of @xmath210 the reduction is approximately three orders of magnitude .",
    "another difference between bssn and fccz4 is that for the latter , the violations slightly decrease with time while they remain constant for bssn .",
    "we take this as an indication that the numerical viscosity is slightly smaller in bssn , consistent with our findings in section [ sec : stabletov ] .",
    "we obtain the smallest constraint violations for the smallest value of @xmath210 , but this value also leads to the strongest damping of the oscillations .      the last numerical experiment is the gravitational collapse of a marginally stable spherical relativistic star to a black hole . as before we adopt a polytropic start with @xmath196 and @xmath194 as initial data , but we now consider a star with central rest - mass density @xmath224 .",
    "this initial model has a gravitational mass @xmath225 and a baryon rest - mass @xmath226 . at @xmath145",
    "we artificially decrease the pressure by 0.5% in order to induce the collapse .",
    "we perform this test with a spatial resolution of @xmath227 and @xmath228 , which places the outer boundary at @xmath229 .     until @xmath230 ( in our code units).,title=\"fig:\",scaledwidth=111.0% ]   until @xmath230 ( in our code units).,title=\"fig:\",scaledwidth=110.0% ]    in fig .  [",
    "fig : grafc1 ] , we plot the evolution of the normalized central density and the mass of the ah after it forms at a time @xmath231 .",
    "we find that @xmath231 depends slightly on the formulation used , and , for fccz4 , on the coefficient @xmath207 : for bssn , we found @xmath232 , while for fccz4 with @xmath208 we found @xmath233 ( all in our code units ) .",
    "increasing @xmath207 slightly reduces @xmath231 , as shown in fig .",
    "[ fig : grafc1 ] .",
    "this behavior is again consistent with our observations in section [ sec : stabletov ] and [ sec : migration ] , and suggests that the numerical viscosity of the bssn scheme is slightly smaller than that of fccz4 .",
    "it also suggests that the numerical viscosity of fccz4 decreases with increasing @xmath207 . for @xmath234 ( not shown in fig .",
    "[ fig : grafc1 ] ) , @xmath231 agrees well with that of bssn , although this choice of @xmath210 leads to non - negligible over - damped results ( an important drift for the black hole mass appears ) .    in the lower panel of fig .",
    "[ fig : grafc1 ] we show the horizon mass as a function of time , as obtained with the different evolution schemes .",
    "the difference between the initial adm mass of the system and the mass of the ah at @xmath230 for the bssn formulation is about 0.5% .",
    "we find a slightly higher deviation , around 1.6 - 1.7% for fccz4 with @xmath235 and 1% for @xmath236 .     when an apparent horizon forms for the bssn formulation.,scaledwidth=111.0% ]    finally , in fig .",
    "[ fig : grafc2 ] we show the l2-norm of the hamiltonian constraint violation computed in the region outside the ah .",
    "as expected , the constraint violations obtained with the fccz4 formulation are smaller than those obtained with the bssn formulation .",
    "the difference in the constraint violations between the two formulations is at most three orders of magnitude when we take @xmath237 ( green dashed line in fig .",
    "[ fig : grafc2 ] ) . increasing the value of @xmath160",
    "does not reduce the l2-norm further .",
    "instead it increases again and approaches a value similar to that obtained with bssn .",
    "in this paper we generalize the covariant and conformal z4 system @xcite of the einstein equations originally proposed by alic et al .",
    "@xcite using a reference - metric approach  @xcite ( see @xcite for the derivation of the bssn system using the same approach ) .",
    "the resulting system , which we refer to as fccz4 , allows us to write the evolution equations in a fully covariant form suitable for curvilinear coordinate systems . as a first step",
    ", we implement the fccz4 system in spherical coordinates under the assumption of spherical symmetry .",
    "we adopt a pirk scheme for the time evolution and obtain stable evolutions  without regularization of the equations  for both vacuum and non - vacuum spacetimes .    the cc4z formalism of @xcite shares some properties with a similar approach , z4c , developed by @xcite . in agreement with @xcite ,",
    "we find that using sommerfeld outer boundary conditions is as accurate as it is for the bssn system . unlike in the z4c formalism",
    ", we therefore find stable evolutions even without implementing constraint preserving boundary conditions  @xcite . unlike reported in @xcite",
    ", we did not need to introduce a third parameter @xmath68 in order to obtain stable evolutions for black - hole spacetimes ( see @xcite for an alternative modification of the equations ) .",
    "we performed a number of tests to compare the accuracy of the fccz4 formulation with that of the bssn system .",
    "as in previous experiments with z4c and ccz4 , we find that constraint violations in neutron - star spacetimes are significantly smaller in fccz4 than in bssn , often by 2 or 3 orders of magnitude .",
    "we find similar improvements for the pure gauge - wave test .",
    "this test also demonstrates that fccz4 can reduce errors introduced by the coordinate singularities in spherical polar coordinates , even though this effect was less visible in our other simulations .",
    "we note , however , that these results depend on the choices for the free parameters @xmath11 and @xmath12 .",
    "poor choices may introduce over - damping , thereby increasing errors , or may make the code unstable .",
    "we also note that our findings suggest that the fccz4 scheme introduces a slightly larger numerical viscosity than the bssn scheme .    for black - hole spacetimes",
    ", we find that , even for the best choices for the free parameters , fccz4 reduces the constraint violations only very moderately , and only at late times . at least for the resolutions that we employed in our tests , bssn was slightly more accurate in computing the black hole mass ( compare @xcite ) .",
    "we found that choosing @xmath162 different from zero did not lead to significant improvements ; in fact , poor choices may lead to over - damping effects . on the other hand",
    ", the damping parameter @xmath160 plays an important role in the reduction of the violations of the constraints .",
    "increasing the value of this parameter tends to reduce constraint violations ( except in the migration test ) but may also introduce a damping that is too large , thereby making the code unstable and causing it to crash . for all examples considered in this paper",
    "we have been able to find suitable choices for @xmath11 , but for more general applications it may be difficult to identify an optimal choice for this parameter . since @xmath11 has units of inverse length , its optimal choice depends on typical length - scales in the simulation . for a single black hole , for example , a good choice appears to be @xmath238 . in simulations of black hole binaries with unequal masses , on the other hand , it may be hard to find a single parameter @xmath11 that is well - suited for both black holes .",
    "similar issues may arise in other mixed systems , e.g.  black hole - neutron star binaries or black holes surrounded by accretion disks .",
    "an optimal choice of @xmath11 for the matter component , for example , might lead to over - damping for the black hole .",
    "should this issue indeed prove to be a problem , a possible solution might be to allow @xmath11 to take different values in different regions of the spacetime .    in a future project we will implement the fccz4 formalism in three spatial dimensions without any symmetry assumptions , and",
    "we plan to explore the issues discussed above with that code .",
    "nsg thanks the max - planck - institut fr astrophysik for its hospitality during the development of part of this project .",
    "pm thanks sebastiano bernuzzi and david hilditch for helpful discussions .",
    "twb gratefully acknowledges support from the alexander - von - humboldt foundation .",
    "this work was supported in part by the spanish micinn ( aya 2010 - 21097-c03 - 01 ) , by the generalitat valenciana ( prometeo-2009 - 103 ) , by the deutsche forschungsgesellschaft ( dfg ) through its transregional center sfb / tr 7 `` gravitational wave astronomy '' , and by nsf grant phy-1063240 to bowdoin college .",
    "the evolution eqs .  ( [ eq28])-([eq30 ] ) , ( [ eq33 ] ) , ( [ eq34 ] ) , ( [ eq36 ] ) , ( [ eq39 ] ) ( [ eq14])-([eq16 ] ) ,",
    "are evolved using a second - order pirk method , described in sec .",
    "iii . in this appendix",
    "we provide a complete listing of the source terms included in the explicit or partially implicit operators .",
    "firstly , the hydrodynamic conserved quantities and the spacetime fields @xmath132 , @xmath133 , @xmath80 , @xmath17 and @xmath134 , are evolved explicitly , i.e. , all the source terms of the evolution equations of these variables are included in the @xmath124 operator of the second - order pirk method .",
    "secondly , @xmath135 , @xmath82 and @xmath84 are evolved partially implicitly , using updated values of @xmath17 , @xmath132 and @xmath133 ; more specifically , the corresponding @xmath125 and @xmath126 operators associated with the evolution equations for @xmath135 , @xmath82 and @xmath84 are : @xmath239 next , @xmath137 is evolved partially implicitly , using updated values of @xmath17 , @xmath132 , @xmath133 , @xmath134 , @xmath81 , @xmath135 , @xmath82 and @xmath84 ; more specifically , the corresponding @xmath125 and @xmath126 operators associated with the evolution equation for @xmath137 are : @xmath240 + 2\\alpha a_{a}\\bar{\\lambda}^{r}\\nonumber\\\\ & - \\bar{\\lambda}^{r}\\partial_{r}\\beta^{r } + \\frac{2\\sigma}{3}\\bar{\\lambda}^{r}\\hat{\\nabla}_m\\beta^{m } \\nonumber \\\\ & + \\frac{2}{a}\\biggl(\\alpha\\partial_{r}\\theta-\\theta\\partial_{r}\\alpha-\\frac{2}{3}\\alpha kz_{r}\\biggl)\\nonumber\\\\ & \\frac{2}{a}\\biggl(\\frac{2}{3}z_{r}\\mathcal{\\bar d}_{m}\\beta^{m}-z_{r}\\partial_{r}\\beta^{r}\\biggl)-\\frac{2}{a}\\kappa_{1}z_{r } , \\\\",
    "l_{3(\\tilde{\\lambda}^{r } ) } & = \\beta^{r}\\partial_{r}\\tilde{\\lambda}^{r } - 8\\pi j_{r } \\frac{\\xi \\alpha}{a}.\\end{aligned}\\ ] ] finally , @xmath138 is evolved partially implicitly , using updated values of @xmath137 , i.e. , @xmath241 and @xmath242 .",
    "99 g. m. harry , advanced ligo : the next generation of gravitational wave detectors , 2010 class .",
    "quantum grav .",
    "27 084006 .",
    " advanced virgo baseline design ,  the virgo collaboration , vir-0027a-09 ( 2009 ) ; available from https://pub3.ego-gw.it/itf/tds/ y. aso , y. michimura1 , k. somiya2 , m. ando , o. miyakawa , t. sekiguchi , d. tatsumi , h. yamamoto , and ( the kagra collaboration ) , phys",
    "d * 88 * , 043007 ( 2013 ) t. nakamura , k. oohara and y. kojima , prog .",
    ". suppl . *",
    "90 * , 1 ( 1987 ) .",
    "m. shibata and t. nakamura , phys .",
    "d * 52 * , 5428 ( 1995 ) .",
    "t. w. baumgarte and s. l. shapiro , phys .",
    "d * 59 * , 024007 ( 1998 ) . c. bona , j. mass , e. seidel and j. stela , phys .",
    "d * 56 * , 3405 ( 1997 ) .",
    "m. alcubierre , b. brgmann , p. diener , m. koppitz , d. pollney , e. seidel and r. takahashi , phys .",
    "d * 67 * , 084023 ( 2003 ) . c. bona , t. ledvinka ,",
    "c. palenzuela and m. zacek , phys .",
    "d * 67 * , 104005 ( 2003 ) .",
    "s. bernuzzi and d. hilditch , phys .",
    "d * 81 * , 084003 ( 2010 ) .",
    "d. alic , c. bona - casas , c. bona , l. rezzolla , and c. palenzuela , phys .",
    "d * 85 * , 064040 ( 2012 ) .",
    "d. alic , w. kastaun and l. rezzolla , phys .",
    "d * 88 * , 064049 ( 2013 ) . c. gundlach , j. m. martin - garcia , g. calabrese and i. hinder , classical quantum gravity * 22 * , 3767 ( 2005 ) . m. ruiz , d. hilditch and s. bernuzzi , phys . rev .",
    "d * 83 * , 024025 ( 2011 ) .",
    "a. weyhausen , s. bernuzzi and d. hilditch , phys .",
    "d * 85 * , 024038 ( 2012 ) .",
    "d. hilditch , s. bernuzzi , m. thierfelder , z. cao , w. tichy and b. brgmann , phys .",
    "d * 88 * , 084057 ( 2013 ) .",
    "w. kastaun , f. galeazzi , d. alic , l. rezzolla and j. a. font , phys .",
    "d rapid comm . *",
    "88 * , 021501 ( 2013 ) .",
    "e. gourgoulhon , lectures given at the general relativity trimester held at the institut henri poincare , arxiv : gr - qc/0703035 . j. d. brown , phys . rev . lett . * 96 * , 111101 ( 2006 ) .",
    "e. gourgoulhon , _ 3 + 1 formalism in general relativity _",
    "( springer , 2012 ) .",
    "s. bonazzola , e. gourgoulhon , p. grandclment and j. novak , phys .",
    "d * 70 * , 104007 ( 2004 ) .",
    "i. cordero - carrin , p. cerd - durn and j. m. ibez , phys .",
    "d * 85 * , 044023 ( 2012 ) .",
    "p. j. montero and i. cordero - carrin , phys .",
    "d * 85 * , 124037/1 ( 2012 ) .",
    "t. w. baumgarte , p. j. montero , i. cordero - carrin and e. mller , phys .",
    "d * 87 * , 044026 ( 2013 ) . p. j. montero , t. w. baumgarte , and e. mller , submitted , arxiv:1309.7808 .",
    "m. alcubierre and m. d. mendez , gen .",
    ". grav . * 43 * , 2769 ( 2011 ) .",
    "f. banyuls , j.  a. font , j.  m. ibnez , j.  m. mart and j.  a. miralles , astrophys .",
    "j. * 476 * , 221 ( 1997 ) .",
    "kreiss and j. oliger , in _",
    "methods for the approximate solution of the time dependent problems _ , edited by garp publ .",
    "( geneva , 1973 ) .",
    "a. harten , p. d. lax and b. & van leer , siam rev .",
    "* 25 * , 35 ( 1983 ) .",
    "b. einfeldt , siam j. numer .",
    "25 * , 294 ( 1988 ) .",
    "m. hannam , s. husa , n.  .",
    "murchadha , b. brgmann , j. a. gonzlez and u. sperhake , j. phys .",
    ". ser . * 66 * , 01247 ( 2007 ) .",
    "t. w. baumgarte and s. g. naculich , phys .",
    "d * 75 * , 067502 ( 2007 ) .",
    "j. a. font , t. goodale , s. iyer , m. miller , l. rezzolla , e. seidel , n. stergioulas , w. suen and m. tobias , phys .",
    "d * 65 * , 084024 ( 2002 ) .",
    "m. ruiz , d. hilditch and s. bernuzzi , phys .",
    "d * 83 * , 024025 ( 2011 ) ."
  ],
  "abstract_text": [
    "<S> we adopt a reference - metric approach to generalize a covariant and conformal version of the z4 system of the einstein equations . </S>",
    "<S> we refer to the resulting system as  fully covariant and conformal \" , or fccz4 for short , since it is well suited for curvilinear as well as cartesian coordinates . </S>",
    "<S> we implement this fccz4 formalism in spherical polar coordinates under the assumption of spherical symmetry using a partially - implicit runge - kutta ( pirk ) method and show that our code can evolve both vacuum and non - vacuum spacetimes without encountering instabilities . </S>",
    "<S> our method does not require regularization of the equations to handle coordinate singularities , nor does it depend on constraint - preserving outer boundary conditions , nor does it need any modifications of the equations for evolutions of black holes . </S>",
    "<S> we perform several tests and compare the performance of the fccz4 system , for different choices of certain free parameters , with that of bssn . confirming earlier results we find </S>",
    "<S> that , for an optimal choice of these parameters , and for neutron - star spacetimes , the violations of the hamiltonian constraint can be between 1 and 3 orders of magnitude smaller in the fccz4 system than in the bssn formulation . </S>",
    "<S> for black - hole spacetimes , on the other hand , any advantages of fccz4 over bssn are less evident . </S>"
  ]
}