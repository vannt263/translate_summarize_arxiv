{
  "article_text": [
    "markov chains are versatile dynamical systems that model a broad spectrum of physical , biological , and engineering systems . along with the broad range of its applications ,",
    "one of the main advantages of markov chains is that some of them can be easily handled and cast as time - invariant , linear systems @xcite .    in this paper , we focus on continuous - time , discrete - state , homogeneous , irreducible markov chains with a finite number of states .",
    "the probability of being in any state is governed by a linear set of ordinary differential equations ( odes ) , where individual odes correspond to each state of the system , describing all possible transitions in and out of such states .",
    "this set of odes is commonly referred to as forward kolmogorov equation or chemical master equation and might have large dimensions even for simple systems .",
    "hence , obtaining a solution for such a system might be analytically intractable and computationally demanding .    provided that one is interested only in some states or a combination of states of the markov chain , it is possible to obtain a reduced order model via the balanced realisation of the linear system that describes the probability of being in such states .",
    "the reduced model has a smaller number of coupled differential equations , yet approximates the output of the full model with an error bound proportional to the sum of the hankel singular values neglected to obtain the reduced model @xcite . since chemical reaction networks in a homogeneous media with a low number of molecules , and in thermodynamic equilibrium can be described as markov chains , it is possible to apply our methodology to this class of systems .",
    "there exist alternative approaches to obtain reduced order models from the cme .",
    "for instance , the finite state projection method obtains the probability density function in prescribed subsets of the state space and for a specific time point @xcite . from this method",
    ", it is also possible to obtain a linear set of odes that can , in general , be further reduced via the methodology we use in this paper .",
    "other approaches make use of krylov subspaces to approximate the solution of the exponential matrix that generates the solutions of the markov chain @xcite .",
    "additionally , when the species can be classified by its behaviour into stochastic or deterministic , @xcite propose a methodology in which the cme can be solved directly and efficiently , when the number of species with stochastic behaviour is low . in this direction , works like @xcite avail of a time scale separation to estimate the solution of the fast - varying species ; and use this estimation to approximate the trajectories of the slow - varying species . on a different perspective , @xcite analysed methods to approximate the solution of selected states of the cme , when such solutions can be expressed as the product of two probability density functions : one that describes probabilities of states of interest and a second that depends on the rest of states .",
    "this later probability distribution can be approximated by its mean , for instance , so as to yield an approximated probability density function for those probabilities of interest .",
    "however , this approach might yield coarse results if the underlying assumptions are crude .    as an alternative ,",
    "when the analytical or computational treatment of the markov chain is infeasible , it is common to opt for numerical simulations of the stochastic system and analyse the outcome statistically .",
    "@xcite , and @xcite , among many others , provide surveys of simulation methods of stochastic reaction networks",
    ". however , these methods might require large computational times to yield accurate results .",
    "a different way to reduce the cmes is to consider subsystems that focus on features of interest . in the chemical context",
    ", @xcite showed as a proof - of - concept that the simple reaction @xmath2[k_2 ] } { \\ensuremath{s}}_2 } \\ce{->[k_3 ] } { \\ensuremath{s}}_3}$ ] can only be accurately represented by @xmath3 } { \\ensuremath{s}}_3}$ ] under special conditions on the parameters @xmath4 , which render the dynamics of the species @xmath5 irrelevant for the behaviour of @xmath6 .",
    "this study highlights the shortcomings of neglecting species within a stochastic reaction network . in this paper",
    ", we adopt a different approach and overcome these difficulties by deriving a reduced - order model .",
    "such reduced - order model accurately approximates the dynamics of the underlying markov chain for selected states of any chain with any kind of reaction propensities .",
    "there exist , however , exact approaches that abridge specific topologies of reaction networks .",
    "for instance , in @xcite different classes of monomolecular reaction networks are exactly represented as reactions characterised by delay distributions . in turn , works like @xcite are committed to obtain exact analytical solutions of stochastic chemical reaction networks with linear and nonlinear reactions .",
    "importantly , once a reduced ode set via balanced realisation is obtained , one can avail of the results in @xcite to derive a closed - form expression for approximation of the cme solution .",
    "we illustrate our methodology with the analysis of a reversible , stochastic reaction whose cme has @xmath0 states . in contrast ,",
    "an adequate reduced order model has only @xmath1 states and yield an @xmath7 gain of the approximation error of @xmath8 .",
    "later , we obtain a reduced order model that approximates the catalysed conversion of a substrate to a product , even in cases in which a stochastic michaelis - menten approximation fails to obtain accurate results @xcite .",
    "for such a system , the simulation of the reduced model may be several orders of magnitude faster than the simulation of the cme . however , there exist an initial cost in computational time to derive the reduced order model .",
    "hence , obtaining the model reduction is profitable when the lower - dimensional ode set is used repeatedly .",
    "finally , we derive a model that approximates the probability of having predefined ranges of product molecules , in the same catalytic substrate conversion .",
    "consider a discrete and finite set of states @xmath9 \\right \\}\\end{aligned}\\ ] ] and let the system s state at time @xmath10 be denoted by @xmath11 .",
    "moreover , we consider that the transition from one state to another can be modelled by a time - homogeneous markov chain , i.e. , the next state , @xmath12 , only depends on the current state , @xmath13(@xmath14 ) , independently of @xmath10 .",
    "we use @xmath15\\subset \\mathbb r$ ] to denote the probability , @xmath16 , of the system s state to be @xmath17 at time @xmath10 .",
    "this notation and the markov property add up to @xmath18 we gather the probabilities for every state in the column vector @xmath19 let us denote the transition probability from state @xmath20 to state @xmath21 at time @xmath22 by @xmath23 $ ] .",
    "that is to say , @xmath24 the time - homogeneity property of the markov chain implies @xmath25 in matrix form , known as _ chapman - kolmogorov equation _ , is @xmath26^{{w}\\times{w } } : \\mathbf{q}({\\ensuremath{\\mathnormal{t}}}+\\tau ) = \\mathbf{q}({\\ensuremath{\\mathnormal{t } } } ) \\mathbf { q}(\\tau )   = \\mathbf{q}(\\tau ) \\mathbf { q}({\\ensuremath{\\mathnormal{t } } } ) .",
    "\\label{eq : semigroup}\\end{aligned}\\ ] ] this matrix gathers all the transition probabilities as a function of time and , by consequence , its columns add to one for all @xmath10 . additionally , if the markov chain is _ irreducible _ , @xmath27 has a simple eigenvalue @xmath28 , and @xmath29 .",
    "this is consequence of the perron - frobenius theorem as described in ( * ? ? ?",
    "6 ) , for example . in the rest of this paper , we will deal with finite , irreducible , homogeneous , continuous - time , discrete - state markov chains exclusively .",
    "our main interest is to determine the time - dependent probabilities of being in any state of the chain . to this end , we consider the _ infinitesimal generator _ of the markov chain defined as @xmath30 the elements of the matrix above are @xmath31 where it can be shown that the elements @xmath32 satisfy @xmath33 the last relationship above shows that every column of @xmath34 adds up to zero , provided each column of @xmath35 add up to one .",
    "it is well - known that @xmath34 is the generator of the positive semigroup that governs the evolution of @xmath36(@xmath14 ) ( see ( * ? ? ?",
    "5.6 ) , for instance ) : @xmath37 under our assumptions , the markov chain is irreducible and with a finite number of states .",
    "hence , @xmath27 has a unique frobenius eigenvalue with algebraic multiplicity one @xcite .",
    "the simple perron - frobenius eigenvalue of the stochastic matrix @xmath27 in is 1 .",
    "now , let @xmath38 and @xmath39 be the right perron - frobenius eigenvector and eigenvalues of @xmath27 , then the eigenvalues of @xmath34 satisfy @xmath40 that is , @xmath34 preserves the configuration of the eigenvalues of @xmath41 , upon shifting one unit to the left and rescaling .",
    "this implies that @xmath34 has a zero eigenvalue and the rest of its eigenvalues have negative real part , as confirmed by analysing the gershgorin circles of the columns of @xmath34 .",
    "note that the dimension of @xmath42 , @xmath43 , might be large as it represents all the configurations of a system with @xmath44 characteristics . in the population and biochemical context",
    ", @xmath44 represents the number of species , whereas @xmath43 is the number of all the possible combination of species population counts . in the following section , we model a stochastic chemical reaction network with the markov chains described above .",
    "now , let us consider @xmath44 species in a homogeneous medium and in thermodynamic equilibrium and a set of @xmath45 reactions represented by @xmath46 } \\sum_{i=1}^{n}\\beta_{ij } s_i}.\\label{eq : reac}\\ ] ] let the entries of the stoichiometric matrix @xmath47 be @xmath48 furthermore , let us consider a vector comprised of the number of molecules , @xmath49 , for every species , @xmath50 : @xmath51 the finite set @xmath52 above was defined in and contains , at least , all the possible combinations of the species molecular numbers in the reaction network .",
    "consider that the @xmath21@xmath53  reaction is the only reaction happening within the interval @xmath54 $ ] .",
    "hence the number of molecules at time @xmath55 is @xmath56 where @xmath57 represents the @xmath21@xmath53  column of @xmath58 .",
    "this reaction network may be modelled by the continuous - time , discrete - state jump markov process described in section [ sec : march ] .",
    "the states of the markov chain are the elements in @xmath59 . in turn",
    ", the vector @xmath60 in gathers the time - dependent probabilities of being in every state , whose time evolution is governed by .",
    "additionally , the stochastic behaviour of thermally stable and spatially homogeneous reaction networks has been described@xcite , where the transition rates between states of the system are shown in table [ tb : prope ] .",
    ".reactions and their propensity function .",
    "the symbol @xmath61 denotes the number of molecules of the species @xmath50 .",
    "the symbol @xmath62 denotes the propensity of reaction @xmath21 . [ cols=\"<,<\",options=\"header \" , ]     to construct the matrix @xmath34 in , we have to evaluate the probabilities transition rate for all states @xmath63 and arrange them as the entries of @xmath34 as follows @xmath64 in the next section , we present a methodology used to obtain reduced order models , which are capable of reproducing the dynamical behaviour of a linear system with a smaller number of odes .      in this section",
    ", we present an overview of a methodology used for obtaining lower dimensional models via balanced realisation .",
    "the literature on this topic is vast and we refer the interested reader to @xcite for a deeper presentation of this type of model reduction .",
    "let us consider a linear system of the form    [ eq : linode ] @xmath65    we will assume that all the eigenvalues of @xmath66 have negative real part , i.e. stable , and that is both controllable and observable .",
    "_ controllability _ is the property of which ensures that it is possible to steer the state of the system from any initial condition @xmath67 to any desired state at a specific time , by the application of an adequate forcing function @xmath68 . in turn",
    ", _ observability _ refers to the capability of computing @xmath67 given the knowledge of @xmath68 and @xmath69 for all previous time .",
    "these two properties hold when the ( observability and controllability ) matrices below are full rank@xcite .",
    "@xmath70 when is simultaneously stable , observable , and controllable there exist unique , symmetric , positive - definite matrices @xmath71 and @xmath72 which are solution of the following lyapunov equations    [ eq : gram ] @xmath73    the singular values of the product of @xmath71 and @xmath72 are known as the hankel singular values , @xmath74 , of the system . when @xmath75 where @xmath76 , the system is lyapunov balanced @xcite .",
    "if the original system is not stable nor represented by its minimal realisation ( i.e.   simultaneously observable and controllable ) , we suggest the transformation in @xcite to obtain its lyapunov balanced form .",
    "an advantage of having a balanced realisation is that the magnitude of the singular values @xmath74 decays quickly as @xmath21 increases .",
    "there are several techniques that avail of this observation to derive reduced order models , depending on the required characteristics of such a reduced model @xcite .",
    "let us denote the coordinates of the balanced realisation of by @xmath77 and , accordingly , we mark with a tilde the matrices related to the balanced realisation .",
    "one of the simplest approaches to obtain a reduced order model is to partition @xmath78 in , to obtain @xmath79 this separation also induces the partition @xmath80 , where @xmath81 and @xmath82 . by neglecting the states associated to the small hankel singular values , @xmath83 ,",
    "the truncated model becomes @xcite    [ eq : odebalred ] @xmath84    this model is known to preserve the most important eigenvalues of the original system .",
    "however , some other properties such as steady state are slightly modified .",
    "when such a property is of interest , _ model reduction by residualisation _ is more suitable @xcite . both of these methods",
    "are already included in languages such as phyton and matlab , where the balanced realisation of a linear system is in the function _",
    "balreal _ and the model reduction via truncation and residualisation is in _ modred_. it is also important to mention , that the @xmath7 gain of the approximation error for both model reduction methods above are as follows @xmath85 where @xmath86 is the output of the reduced model .",
    "please , refer to appendix [ sec : app ] for a derivation of such an error bound . in the forthcoming section , we build upon the material in this section to obtain a reduced order model of the representation of a continuous - time , discrete - state , homogeneous , irreducible markov chain .",
    "in this section we are interested in the probability of being in some ( linear combination of ) states @xmath87 of the markov chain . as noted in equation , the vector @xmath60 evolves according to the linear ode    [ eq : odey ] @xmath88    also , as was mentioned in section [ sec : march ] , the infinitesimal generator @xmath34 of an irreducible markov chain with finite states has the properties :    [ eq : properties ] @xmath89    without loss of generality , we will assume that the system is both controllable and observable .",
    "should it lack these two properties , there always exist a transformation that obtains the observable and controllable subspace of ; namely , the kalman decomposition @xcite . to consider a reduced model that does not have a zero eigenvalue ,",
    "let @xmath34 be partitioned as follows : @xmath90 also we consider the following similarity transformation    [ eq : trans ] @xmath91    by differentiating the last equation above and using the expressions in , we get @xmath92 the solution for the first state is the unitary step function , that is @xmath93 . by substituting this solution in the ode above ,",
    "we have    [ eq : odestable ] @xmath94    where    [ eq : modstable ] @xmath95    the spectrum of @xmath66 in has all the eigenvalues of @xmath34 , except for the zero eigenvalue . to see this ,",
    "recall that the trace of a matrix is the sum of its eigenvalues . as arises from a similarity transformation applied to",
    ", we have that @xmath96 under our assumptions , @xmath34 has only one zero eigenvalue and , hence , the spectrum of @xmath66 is composed by the nonzero eigenvalues of @xmath34 .",
    "all these eigenvalues have negative real part .",
    "although the triplet @xmath97 in might not be a minimal realisation , it is always possible to obtain a model which is both controllable and observable via its kalman decomposition @xcite .",
    "in fact , the command _ balreal _ of matlab s control system toolbox will obtain the controllable and observable system before obtaining the balanced realisation ; hence , is not absolutely necessary to test for these properties separately , when using this software .",
    "thus for stable systems we can perform the model balancing described in section [ sec : balanced ] in order to obtain a reduced - order model of the form .    up to now",
    ", we had considered that the number of states , @xmath43 , of the markov chain is finite . however ,",
    "when considering chemical reaction networks , it is possible to use of the finite state projection ( fsp ) method @xcite , to obtain an ode set analogous to with the most representative , finite number of states . due to its approximate nature , the set of odes obtained via the fsp might not present the properties in .",
    "hence the change of variables in would no longer be necessary and balanced model reduction can be applied directly to the fsp - reduced set of odes .",
    "although the lower - dimensional model can be used for obtaining an approximated numerical solution for the probabilities of interest , we would like to remark that one may use the results in @xcite to derive closed - form expressions for these probabilities . in the following section , we study some case studies to show the applicability of these methods .",
    "in this section , we show the derivation and application of reduced order models , through different examples .",
    "we will first analyse , in section [ sec : monomolec ] , one monomolecular reaction and obtain an accurate approximation for the probability of having the conversion of all the molecules from the first species to the second one .",
    "later , in section [ sec : smm ] , we derive reduced order models capable of approximating a catalytic conversion of a substrate even in cases in which the stochastic michaelis - menten can not yield accurate results @xcite .",
    "finally , in section [ sec : range ] we revisit the catalytic substrate conversion to derive the probability of having ranges of product molecules . in all case studies , we used a 3.2 ghz quad - core intel xeon computer with 16 gb of ram .",
    "our script was coded in matlab r2012b .",
    "let us consider the reversible reaction @xmath98[{\\ensuremath{k_{\\mathrm{b } } } } ] } { \\ensuremath{s}}_2},\\ ] ] along with the vector composed of species molecular number @xmath99 .",
    "furthermore , consider an initial number of molecules @xmath100 .",
    "note that in the reaction above the number of molecules remains constant and equal to the initial @xmath101 molecules .",
    "hence the set of @xmath52 has @xmath102 elements and may be ordered as follows @xmath103 now , we are interested in the time - dependent probability of having @xmath101 molecules of @xmath5 , i.e. , to be in state @xmath104 . with this formulation ,",
    "the matrix @xmath34 in is shown in equation on page .",
    "@xmath105    in turn @xmath106 and @xmath107 are given by    [ eq : defpc ] @xmath108    with the definitions for @xmath34 , @xmath106 , and @xmath107 in and , respectively , and by choosing the parameters @xmath109 $ ] , we implemented the model in in matlab 2012b and obtained its balanced realisation with the command _",
    "balreal_. figure [ fig : hsv ] shows the first @xmath110 hankel singular values of the balanced realisation s grammian .",
    "we observe that the first ten singular values have a large norm in comparison to the rest . by using the command _",
    "modred _ , we obtained the reduced order model with different number of states ; hence , achieving different degrees of approximation .",
    "we depict the impact of the number of states on the error of approximation , in figure [ fig : compreduction ] .",
    "there , we note that a very coarse approximation is achieved when we try to approximate the full model with @xmath0 states with a model of only @xmath111 state ( see the lower panel of figure [ fig : compreduction]**(a ) * * ) . in turn ,",
    "when the reduced order model has @xmath1 states , the error of approximation is of order @xmath112 , as depicted in the lower panel of figure [ fig : compreduction]**(c)**. furthermore , if the reduced model has @xmath113 states , the approximation error might already range in the order of the integration error , as suggested by the irregular fluctuations shown in the lower panel of figure [ fig : compreduction]**(d)**.        to finalise this section , we note that @xmath7 gain of the approximation error is @xmath114 and @xmath115 , for the reduced models with @xmath111 , @xmath116 , @xmath1 , and @xmath113 states , respectively .",
    "these bounds were obtained by evaluating expression .",
    "we note that this is a theoretical bound and does not account for numerical errors during the integration or computation of the hankel singular values .    in the forthcoming section ,",
    "we obtain reduced order models for a catalytic substrate conversion , and asses the computational burden required to obtain the reduced order model .",
    "in addition , we benchmark the time required for simulating the reduced order model against both the computational load required to simulate the full order model and the stochastic simulation algorithm ( ssa ) .      in this section ,",
    "we consider the reaction network @xmath117[{\\ensuremath{k_{\\mathrm{b } 1 } } } ] } c } \\ce{->[{\\ensuremath{k_{\\mathrm{f } 2 } } } ] } p+e},\\end{aligned}\\ ] ] which represents conversion of a substrate , @xmath118 , to a product , @xmath119 , mediated by a catalytic agent , @xmath120 , which binds to the substrate to form the complex @xmath121 . in the deterministic case ,",
    "it is common practice to approximate the mass - action - based reaction network in via the reaction @xmath122 } p},\\end{aligned}\\ ] ] with nonlinear reaction rate    [ eq : vmm ] @xmath123 ) = \\frac{v_{max}}{k_m + [ s]}[s],\\end{aligned}\\ ] ] where @xmath124 $ ] stands for concentration of the argument and @xmath125_t,\\\\      k_m : { & = } \\frac{{\\ensuremath{k_{\\mathrm{b } 1 } } } + { \\ensuremath{k_{\\mathrm{f } 2}}}}{{\\ensuremath{k_{\\mathrm{f } 1}}}},\\\\      [ e]_t    : { & = } [ e]({\\ensuremath{\\mathnormal{t } } } ) + [ c]({\\ensuremath{\\mathnormal{t } } } ) ,   \\quad \\textnormal{for any } { \\ensuremath{\\mathnormal{t}}}\\geq 0 .",
    "\\end{aligned}\\ ] ]    it has been shown that the dynamics of can be reasonably approximated by when @xcite @xmath126_t",
    "< < s(0 ) + k_m.\\end{aligned}\\ ] ]    however , for cases in which the reactions in are better described by a stochastic model , it is still possible to represent the dynamics of @xmath118 and @xmath119 with a reaction of the form by using the propensity @xmath127 where now @xmath118 represents the number of molecules of the substrate and @xmath128 , @xmath129 , and @xmath130 are as in , while the kinetic constants are those of the stochastic model .",
    "this representation is valid under the condition , as is also true for the deterministic case@xcite .",
    "additionally , the case when @xmath131 in which a nonlinear propensity function can be used to represent via was considered in @xcite . there , the condition @xmath132 induces a time - scale separation which is further used to abridge the reaction network . in the following , we will refer to the representation of the reaction network via with the propensity in or that in @xcite as _ stochastic michaelis - menten _ representation .",
    "we now obtain a reduced order model that approximates the probability of being in selected states of the underlying markov chain .",
    "we derive this reduced model by means of the procedure described in section [ sec : orderred ] .",
    "in contrast to the approaches in @xcite and references therein , we do not assume any particular relation among the parameters and initial conditions , so our methodology is more widely applicable .",
    "another difference from the approaches in @xcite is that they prove the applicability of ssa algorithms with the stochastic michaelis - menten propensity .",
    "in contrast , we derive a dynamical system that approximates the solution of the cme with an _ a priori _ error bound given by .",
    "we recall that in the limit , the probability distribution obtained from the ssa trajectories will converge to the solution of the cme .",
    "however , depending on the kinetic parameters and network analysed , the ssa might require large computational times to provide results with the desired accuracy .",
    "it is noteworthy that even when can be represented by , one can still obtain a reduced model via the balanced model reduction described in the section [ sec : orderred ] , as we do not assume any relationship among the parameters and initial conditions .    to exemplify the concepts above",
    ", we depict in figure [ fig : reductionmm ] a comparison of    the solution of the cme of with propensities shown in table [ tb : prope ] ;    the solution of the cme of the stochastic michaelis - menten in with the nonlinear propensity in ; and    the solution of the reduced model described in section [ sec : orderred ] for the last state of the markov chain , which represents total conversion of the substrate to product .",
    "the parameters used are @xmath133,1~[\\mathrm s ^{-1}],1~[\\mathrm s ^{-1}]\\}$ ] and 10 initial molecules of substrate . with these parameters ,",
    "the method proposed in @xcite would not yield accurate results , as the condition is not fulfilled ( @xmath134 ) .",
    "the only difference between the upper and lower panels in figure [ fig : reductionmm ] is the number of initial molecules considered for the enzyme . in the upper panel we considered 1 molecule of the enzyme",
    ", hence condition is fulfilled , and the stochastic michaelis - menten representation may be used to approximate the full model . moreover , one can use the stochastic michaelis - menten to derive a reduced model via balanced realisation , as compared in the upper panel of the upper panel of figure [ fig : reductionmm ] * ( c)*. there , we approximated the stochastic michaelis - menten model of @xmath135 states with a reduced order model with @xmath136 states ; the @xmath7 gain of the approximation error is less than @xmath137 as given by . in contrast ,",
    "when we consider @xmath1 molecules of enzyme initially , condition is violated ( as @xmath138 ) and the stochastic michaelis - menten model does not reproduce the dynamics of the full reaction network in , as depicted in the lower panels of figure [ fig : reductionmm ] .",
    "we note , however , that we can still obtain a reduced model via balanced realisation that accurately approximates the dynamics of the full model ( cfr .",
    "figure [ fig : reductionmm]**(c ) * * lower ) .",
    "there we approximated the full model with @xmath139 states by a reduced model of @xmath136 states , whose approximation error @xmath7 gain is less that @xmath140 .",
    "now we focus on the time required to simulate the cme and the time required to simulate the reduced order model . to compute the latter ,",
    "we need to apply some state transformations to the cme to derive a balanced realisation that can be further truncated .",
    "once the reduced model is obtained , the time required for its numerical solution is significantly smaller compared to the time required for the numerical solution of the full cme . to illustrate this reduction on the computational time",
    ", we obtained the cme of the reaction network with an equal number of molecules for the substrate and enzyme and zero molecules for the rest of the species , in the initial state ; later , we obtained the reduced order model via balanced realisation , which represents the state of total conversion of the substrate to the product ; and compared the time required for obtaining the numerical solution of the full cme ( @xmath141 ) and the reduced model ( @xmath142 ) by the expression @xmath143 we depict the results of this assessment in figure [ fig : performance ] .",
    "there we observe that as the number of molecules for @xmath120 and @xmath118 in the initial state increase , the savings on the computational time required to obtain the numerical solution of the lower - order model also increases .",
    "we note that for the comparison in we did not account for the time required to obtain the reduced order model .        to finalise this section , we compare the computational time required by    the derivation of the reduced model via balanced realisation plus the simulation of the reduced model ; and    the time required by the fsp @xcite for each time point .",
    "we note that the fsp obtains an approximated probability vector with a desired error bound ( @xmath144 ) for _ one specific time point _ ; hence , if one is interested in the transient response of the probability distribution , one has to implement such an algorithm for every time step of interest .",
    "in contrast , once one obtains the reduced model via balanced realisation it is possible to use the lower - dimensional system for any number of time points .",
    "these results are summarised in figure [ fig : fspvsbalreal ] , where the panels @xmath145 , @xmath146 , and @xmath147 consider @xmath1 , @xmath110 , and @xmath148 initial molecules for @xmath120 and @xmath118 , respectively , and zero molecules for the rest of the species .",
    "the remaining parameter values are identical to those of figure [ fig : reductionmm ] . we note that for the fsp the 1-norm of the error bound is less than a predefined @xmath144 for the specific time points of interest ( discrete signal ) , whereas the @xmath7 gain of the approximation error ( continuous signal ) , obtained with the reduced model via balanced realisation , satisfies the bound given by .",
    "as the nature of both error signals is different , is difficult to perform a fair comparison of the methods accuracy . in the forthcoming section ,",
    "we obtain a reduced order model that approximates the probability of having a certain range of @xmath119 molecules .          up to now",
    ", we have obtained reduced models that approximate the probability of being in one state of the markov chain . in this section ,",
    "we revisit the reaction network in by obtaining the probability of having a certain number of molecules within predefined ranges . here",
    "we consider the following parameter definitions : @xmath149 , @xmath150 initial molecules of substrate , @xmath150 initial molecules of enzyme , and zero initial molecules for the rest of the species . by denoting the number of @xmath119 molecules with @xmath151",
    ", we can formulate our problem as approximating the following probabilities @xmath152 to derive the cme , one needs to obtain and label all the possible combinations of species molecular counts @xmath17 and organise them in the set @xmath52 in",
    ". then we have to evaluate the infinitesimal generator @xmath34 as in with the corresponding reaction propensities of ( see table [ tb : prope ] ) . to obtain an expression for @xmath69 , we need to define the matrix @xmath107 in so that the product of the first row of @xmath107 by the vector @xmath60 yield the sum of the probability of all the states @xmath17 such that @xmath151 is within the range @xmath153 $ ] .",
    "the next two rows of @xmath107 are defined likewise , but accounting for the ranges @xmath151 described in the second and third entries of .",
    "the cme for this system , parameters , and initial number of molecules has @xmath154 states . by applying the model reduction technique in section [ sec : orderred ] , we can approximate the probabilities in by a dynamical system with @xmath155 states , whose output is depicted in figure [ fig : intervals ] . the @xmath7 gain of the approximation error is less than @xmath156 , as estimated by .",
    "in this paper we addressed the order reduction of the infinitesimal generator of a homogeneous , continuous - time , finite and discrete state - space markov chain via the reduction of its balanced realisation .",
    "although the application range of these dynamical systems is broad , here we focus on its use on stochastic chemical reaction networks , without loss of generality . in this context , the infinitesimal generator of the markov chain that describes the probability of having a particular species molecular count is a large set of odes .    to reduce the order of the infinitesimal generator of a markov chain , we used an alternative coordinate system to represent the chemical master equation ( cme ) .",
    "this representation , denoted as lyapunov balanced realisation , has interesting property that the states are organized in decreasing order according to the probabilities of interest .",
    "hence , an accurate approximation can be obtained , for example , by neglecting the last states of the lyapunov balanced model , as discussed in section [ sec : orderred ] .",
    "although one may focus on particular states of the markov chain , it is also possible to account for marginal probability distributions such as in the case study in section [ sec : range ] , or even mean values , by properly defining the matrix @xmath107 in .    in many cases ,",
    "only selected states of the markov chain might be of practical relevance .",
    "for instance , this is the case when facing limited or inexact measurement data , or when only a few states are relevant for downstream signalling in biochemical reactions . also , in imaging analysis of chemical reaction networks , obtaining the exact count of intracellular protein reporters might be challenging due to limited resolution .",
    "hence , the validation of the mathematical model that describes the process under observation should yield the probability of having an specific range of molecules count of the observed species .",
    "we presented this procedure in section [ sec : range ] , for a very simple reaction network .",
    "even in such a simple case , the associated markov chain presented approximately 5000 distinct states of the system .",
    "this highlights how simulation of a system , even in the simplest cases , might imply a computationally intensive task . to alleviate such a burden , the model reduction via balanced realisation used in this paper yields lower - dimensional ode sets",
    ", whose numerical solution might be several orders of magnitude quicker than the numerical solution of the original cme .",
    "moreover , the method used to derive the lower dimensional model provides an upper bound on the approximation error , depending on the number of states neglected to derive the approximation .    of note , the processes required for deriving the reduced order model itself might take longer computations times compared to the mere simulation of the cme",
    "nevertheless , the numerical solution of the reduced model might be obtained orders of magnitude faster , depending on the number of molecules of the system , as shown in figure [ fig : performance ] .",
    "hence , there will be real savings on the computational time when the reduced model is repeatedly utilised , for instance when adopting different initial probability distributions .",
    "we would like to stress that to obtain a reduced order model , we have to fix kinetic parameters and to define which are the states of interest .",
    "should we require to modify either of them , a new reduced model has to be derived .",
    "likewise , all methods that require computational calculations , such as the fsp , ssa , and numerical solution of the cme will require numeric values for the parameters and , moreover , specific numerical values for the initial probability distribution .",
    "when either of them are modified , a new numerical solution has to be obtained",
    ". additionally , the reduction and simulation of the cme might be orders of magnitude faster than the application of the fsp method , as suggested by the example analysed in section [ sec : smm ] .",
    "another possible use for the reduced model is to derive closed - form expressions of its solution ( see @xcite , for instance ) , thereby avoiding the need for numerical solution of the reduced ode set .",
    "when the number of states of the markov chain to reduce is so large that using only one computer is unfeasible , we suggest the use of parallel algorithms to obtain the model reduction by truncation ( see e.g. @xcite )    it is important to note that the reduced order model might lack some properties of the full model .",
    "for instance , the infinitesimal generator of the markov chains studied here describes a positive system : the value of the probabilities will be always positive .",
    "however , the reduced order model obtained by truncation used in this paper will not , in general , preserve such a property .",
    "this implies that if most of the states of the balanced realisation are neglected to obtain the reduced model , there is a risk of having small , negative values for the approximated probabilities .",
    "an example of such phenomenon can be observed on the upper panels of figure [ fig : compreduction]**(a , b)**. this suggests the existence of a trade - off on the order and the accuracy of the reduced - order model . as a rule of thumb",
    ", a good approximation can be obtained by neglecting those states associated to hankel singular values which are three orders of magnitudes smaller than the largest one .",
    "if the possibility of small , negative values for the probability can not be afforded for the application of the reduced order model , there are other model order reduction methods that preserve the positivity of the original model , such as the recent works @xcite .",
    "however , it is equally important to note that these approaches are not generally applicable ; are more time consuming ; and have larger error bounds .    along this paper",
    ", we have considered that the set @xmath52 in has all the possible states of the markov chain under consideration . however , when the number of states is prohibitively large , it is possible to consider a truncation of the set @xmath52 ; thereby , obtaining smaller master equations .",
    "this truncation has two implications :    the master equation derived from the truncated @xmath52 will not capture the full probability density function of the markov chain , but will only focus on the probability of being in those states of interest as characterised in @xcite ; and    the set of odes arising from the truncated @xmath52 will not have the properties in .",
    "hence the change of coordinates in is not necessary , and balanced model reduction can be applied directly to the set of odes obtained from the truncated @xmath52 .",
    "this , in turn , implies that those methods that depend on the truncation of the set @xmath52 to derive approximated probability distributions , such as @xcite , do not antagonise with the model reduction via balanced realisation used in this paper , as both approaches can be complementary .",
    "here , we provide some definitions and the derivation of the approximation error bound that arises from the model reduction via balanced realisation described in section [ sec : orderred ] . the material of this section is based on the refs .",
    "@xcite .    first , to asses the size of the error of approximation ,",
    "let us define the @xmath7 norm of a real , time - dependent vector @xmath68 as @xmath157 when @xmath158 , one obtains the norm of the truncated signal @xmath159 . to increase readability",
    ", we will not explicitly show the upper limit of integration in the norm s subscript .",
    "now , in the frequency domain , the linear ode becomes the following algebraic equation @xmath160 where @xmath161 is the complex frequency variable that arises from the laplace transform of , and @xmath162 the complex matrix @xmath163 is denoted as the _ transfer function _ of the system and characterises its input - output behaviour .",
    "the @xmath164 norm of the complex matrix @xmath163 is defined as @xmath165 here @xmath166 denotes the largest eigenvalue of the argument . in turn , the @xmath167 norm of @xmath163 , for analytic matrices on the open right half - plane , is @xmath168 when @xmath169 in belongs to the banach space endowed of the norm @xmath170 , theorem 4.4 in @xcite states that @xmath171    in order to relate the frequency - domain norms with the time - domain norms , we note that the laplace transform used to obtain the transfer function of is an isomeric isomorphism between the @xmath170 space in the frequency - domain and the @xmath7 space in the time - domain .",
    "thus , from , we can infer that @xmath172      let @xmath173 be a stable rational transfer function with hankel singular values @xmath174 and let @xmath175 be obtained by truncating or residualising the balanced realization of @xmath173 to the first @xmath176 states .",
    "then @xmath177                          k.  burrage , m.  hegland , s.  macnamara , and r.  b. sidje , `` a krylov - based finite state projection algorithm for solving the chemical master equation arising in the discrete modelling of biological systems , '' in _ proceedings of the markov 150th anniversary conference_.1em plus 0.5em minus 0.4emboson books , raleigh , nc , 2006 , pp . 2138 .",
    "s.  menz , j.  c. latorre , c.  schtte , and w.  huisinga , `` hybrid stochastic ",
    "deterministic solution of the chemical master equation , '' _ multiscale modeling & simulation _ , vol .",
    "10 , no .  4 , pp . 12321262 , 2012 .",
    "m.  barrio , k.  burrage , p.  burrage , a.  leier , and t.  marquez - lago , `` computational approaches for modelling intrinsic noise and delays in genetic regulatory networks , '' in _ handbook of research on computational methodologies in gene regulatory networks _ , s.  das , d.  caragea , s.  welch , and w.  h. hsu , eds.1em plus 0.5em minus 0.4emhershey pa : igi global , 2010 , pp",
    ". 169197 .",
    "j.  m. bada , p.  benner , r.  mayo , and e.  s. quintana - ort , `` parallel algorithms for balanced truncation model reduction of sparse systems , '' in _ applied parallel computing .",
    "state of the art in scientific computing_.1em plus 0.5em minus 0.4emspringer , 2006 , pp .",
    "267275 .",
    "c.  grussler and t.  damm , `` a symmetry approach for balanced truncation of positive linear systems , '' in _ decision and control ( cdc ) , 2012 ieee 51st annual conference on_.1em plus 0.5em minus 0.4emieee , 2012 , pp ."
  ],
  "abstract_text": [
    "<S> we consider a markov process in continuous time with a finite number of discrete states . </S>",
    "<S> the time - dependent probabilities of being in any state of the markov chain are governed by a set of ordinary differential equations , whose dimension might be large even for trivial systems . here , we derive a reduced ode set that accurately approximates the probabilities of subspaces of interest with a known error bound . our methodology is based on model reduction by balanced truncation and can be considerably more computationally efficient than the finite state projection algorithm ( fsp ) when used for obtaining transient responses . </S>",
    "<S> we show the applicability of our method by analysing stochastic chemical reactions . </S>",
    "<S> first , we obtain a reduced order model for the infinitesimal generator of a markov chain that models a reversible , monomolecular reaction . </S>",
    "<S> in such an example , we obtain an approximation of the output of a model with @xmath0 states by a reduced model with @xmath1 states . </S>",
    "<S> later , we obtain a reduced order model for a catalytic conversion of substrate to a product ; and compare its dynamics with a stochastic michaelis - menten representation . for this example </S>",
    "<S> , we highlight the savings on the computational load obtained by means of the reduced - order model . </S>",
    "<S> finally , we revisit the substrate catalytic conversion by obtaining a lower - order model that approximates the probability of having predefined ranges of product molecules . </S>"
  ]
}