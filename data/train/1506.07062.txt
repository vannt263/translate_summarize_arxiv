{
  "article_text": [
    "diffusion weighted magnetic resonance imaging ( dw - mri ) is a non - invasive technique for the characterization of biological tissue microstructure @xcite . in brain white matter ,",
    "water molecules diffuse predominantly along axonal fibers .",
    "this results in an observable macroscopic orientation dependence in the dw signal , that is measured by scanning the tissue in multiple orientations and gradient strengths . to model the angular anistropy of the diffusion profile , diffusion tensor imaging ( dti ) @xcite is widely used , but this has the limitation that only a single fiber direction can be estimated per voxel @xcite .",
    "it is estimated in @xcite that more complex fiber configurations occur in approximately 90% of the white matter voxels . to overcome this ,",
    "high angular resolution diffusion imaging ( hardi ) techniques are used , that can describe more complex ( crossing ) fiber configurations .",
    "an overview of hardi techniques can be found in @xcite .",
    "here we use the method of constrained spherical deconvolution ( csd ) @xcite , that from the initial diffusion data constructs a fiber orientation distribution ( fod ) , which models the distribution of fibers along different directions .",
    "tractography methods are often used in the dw - mri pipeline to provide insight in the structural connectivity of the white matter bundles . independently of the model used for interpreting the dw - mri data , noise originating from the scanner , acquisition artifacts and",
    "partial volume effects @xcite are likely to result in spurious ( aberrant ) fibers in the tractography output . to improve the data on which the tractography is performed",
    ", different regularization methods can be used .",
    "methods exist that apply filtering for the reduction of noise directly on the dw - mri data @xcite , other methods aim to regularize the dti tensor fields @xcite . on hardi data the regularization can be performed on individual voxels @xcite or in combination with the local spatial information @xcite .",
    "we introduce two new strategies based on the same underlying principle to improve fiber alignment in tractography results , in order to have more reliable information on the structural connectivity of brain .",
    "first we perform contextual regularization to the fod obtained with csd , see fig .",
    "[ fig : csdenhpipeline]a , and secondly we introduce a fiber to bundle coherence ( fbc ) measure that can be applied to any fiber bundle to classify and remove spurious fibers , see fig . [",
    "fig : csdenhpipeline]b .",
    "both approaches are based on a partial differential equation ( pde ) framework introduced in @xcite , where the fokker - planck equation of a stochastic process for enhancement of elongated structures is considered .",
    "these type of pde - based enhancement methods have been widely used for the processing of 2d - images . in this framework ,",
    "images are represented in the extended space of positions and orientations via a stable invertible orientation score @xcite , that associates to every location an orientation distribution of the local image features ( lines and contours ) . then , the stochastic processes for contour completion @xcite and contour enhancement @xcite ( see fig . [",
    "fig : kernelvis]a ) on this extended space @xmath0 induce crossing preserving completion and enhancement of lines @xcite .",
    ", projected on the xy - plane . *",
    "b. * the contour enhancement kernel arises from the accumulation of infinitely many sample paths .",
    "the gray - scale contours indicate the marginal of the kernel , obtained by integration over @xmath1 , the red glyphs are polar graphs representing the kernel at each grid point . * c. * the contour enhancement kernel oriented in the positive @xmath2-direction in @xmath3 can be visualized on a grid with glyphs that in this case are spherical graphs.,scaledwidth=95.0% ]    the dw - mri data that we use is naturally defined on the coupled space @xmath3 of 3d positions and orientations . as in the 2d case ,",
    "crossing preserving enhancement of line structures is required , for which we use the 3d extension of the 2d stochastic process for contour enhancement , introduced in @xcite .",
    "the linear pde corresponding to this stochastic process can be solved by convolution of the initial condition with the kernel of the pde .",
    "this kernel is also a function on the position - orientation space and can be seen as a transition distribution from the origin ( in position and orientation ) to neighboring elements . from the stochastic point of view , the kernels arise as limits of the accumulation of infinitely many sample paths drawn from the stochastic process , illustrated in fig .",
    "[ fig : kernelvis]a . for mathematical details of the underlying stochastic processes of the pdes , see @xcite .",
    "the general idea needed for this article is sketched in fig .",
    "[ fig : kernelvis ] . in figs .",
    "[ fig : kernelvis]b and [ fig : kernelvis]c we show the contour enhancement kernel using glyph visualization on a grid , each glyph being a polar ( red , 2d ) or spherical ( blue , 3d ) graph plot where in every orientation the ( spherical ) radius is proportional to the value of the kernel .",
    "this type of visualization is used throughout the paper for functions defined on the space of positions and orientations .",
    "recently , many authors @xcite demonstrated the advantages of contextual processing of dw - mri data .",
    "the general rationale behind contextual processing is to include alignment of local orientations and their surroundings ( i.e. the context ) on the coupled space of positions and orientations . for this alignment of local orientations , roto - translations",
    "are needed , which imposes a non - euclidean structure in the pde - based processing as we explain in section [ se : enhancement ] .",
    "more details on the embedding of @xmath4 in the roto - translation group @xmath5 can be found in @xcite .",
    "this demonstrates how either the completion or enhancement pdes can be used to extrapolate dti information to increase the angular resolution and resolve some fiber crossings .",
    "this idea was shown to be promising in clinical experiments @xcite , but in some cases extreme parameters had to be set to obtain clear maxima at crossings ( where dti data is inadequate ) . therefore in this paper",
    "we introduce and test the combination of csd with contextual enhancements .",
    "the method proposed in @xcite uses an advection - diffusion equation ( that we called contour completion above ) to improve hardi data to obtain connectivity measures . in our work",
    "we rely on a purely diffusive process , contour enhancement , which in contrast to contour completion does not suffer from singularities @xcite and is less sensitive to small perturbations of the initial conditions .",
    "this property makes the enhancement process more suited to be combined with the sharp angular distributions produced by csd . as the methods mentioned above still result in broad angular distributions , they need to be combined with some sharpening method . to this end , a geometric morphological sharpening based on erosions was presented in @xcite .",
    "another related method presented in @xcite is the so - called fiber continuity model in which purely spatial regularization is considered in combination with spherical deconvolution as alternative to the non - negativity constraint in the classical csd @xcite . in section [",
    "se : enhancement ] we demonstrate the importance of including also an angular regularization term .      the first contribution of this article is to study the combination of the widely used csd method with a regularization induced by the enhancement pde acting on the fod . since the fod obtained with csd consists of sharp angular profiles , it is well - suited as an initial condition for the enhancement pde , that typically has a smoothing effect on the orientation distributions .",
    "the contextual regularization method reduces non - aligned crossings in the fod , allowing for a better alignment of fibers when tracking is applied on the enhanced fod .",
    "we show that this method is therefore useful to reduce the number of false positive fibers , but mainly to find more true positives in the tractography output .",
    "although in this paper we compare to the classical csd method , the pde enhancements can also be applied to extensions of this method @xcite .",
    "the second contribution of this article is to introduce the fiber to bundle coherence ( fbc ) measure .",
    "the motivation for this measure is that , especially probabilistic , tracking methods typically produce spurious fibers that should be removed from the tractography .",
    "in contrast to the first approach , this method serves as a post - processing tool . for the computation of the fbc",
    "we regard the fiber bundle as a set of oriented points , by considering for every fiber point also the local tangent to the fiber .",
    "we construct a density using the enhancement pde with an initial condition that is a sum of superposed @xmath6-distributions at every oriented point in the bundle .",
    "the construction of such a density from tracks relates to track density imaging @xcite and track orientation density imaging @xcite , though here the use of the contour enhancement kernels , fig . [ fig : kernelvis ] , allows to use a sparse set of fiber tracks .",
    "the fbc , a measure for spuriousness of fibers , is computed by efficient integration of this fiber - based density .",
    "fibers that are most spurious according to the fbc can be removed from the tractography , resulting in a better aligned fiber bundle .",
    "complementary to the first method , this fbc measure has the purpose to remove false positives in a tractography .",
    "section [ se : methods ] covers theory of the individual parts of the pipeline as outlined in fig .",
    "[ fig : csdenhpipeline ] , consisting of csd , pde enhancements , tractography and coherence quantification in sections [ se : csd]-[se : coherence ] , respectively . in section",
    "[ se : results ] we provide extensive validation of the combination of csd and pde enhancements and the fbc , using three experiments :    1 .",
    "first we use the tractometer evaluation system @xcite on the isbi 2013 hardi reconstruction challenge dataset @xcite , a digital phantom with known ground truth , to demonstrate how contour enhancement improves both the local fod reconstruction and the global connectivity of fiber bundles compared to csd , see section [ se : hardirecon ] .",
    "2 .   in section [",
    "se : evaluationdwmri ] we show on a human dw - mri dataset , containing different crossing bundles , that csd combined with enhancements yields an fod that is more robust with respect to the @xmath7-value and the number of gradient directions used in the acquisition .",
    "furthermore , we make a comparison with earlier work involving erosions and nonlinear diffusion of fods directly applied to a dti - model @xcite , that was based on the same data . we show that with our method the glyphs are sharper at the locations where bundles cross .",
    "3 .   finally in section [ se : orexperiment ] , we show an experiment with clinical data in which we reconstruct the optic radiation ( or ) to determine the position of the tip of the meyer s loop , that is of interest in epilepsy surgery planning @xcite .",
    "accurate estimation of this position is difficult due to the presence of spurious fibers in the reconstruction of the or .",
    "we show that both the fod enhancement and the fbc measure , see fig .",
    "[ fig : csdenhpipeline ] , and in particular the combination of the two allow for a more stable determination of the tip of the meyer s loop . here ` more stable ' means less variation with respect to stochastic realizations in the probabilistic tractography results .",
    "conclusions and a discussion can be found in section [ se : conclusions ] .",
    "in this paper it is assumed that we have hardi data as input , from which we derive an fod @xmath8 that models the orientation of fibers in each voxel , i.e. @xmath9 .",
    "for this we use csd @xcite , concisely described in section [ se : csd ] , as it gives sharp angular profiles and is able to distinguish multiple fiber directions within a voxel .",
    "then we use the enhancement pde for diffusion of the fod @xmath8 , coupling spatial and angular information .",
    "the combination of csd and such enhancement is a powerful method to obtain an enhanced fod in which the coherence inherent in the data is included , providing a more coherent input for the tractography .",
    "the enhancement technique is explained in section [ se : enhancement ] .",
    "we use the mrtrix algorithm @xcite for both deterministic and probabilistic tractography to estimate the structural connectivity in the brain . in the deterministic tractography ,",
    "fiber tracks are obtained by integrating a directional field , given an initial position and direction .",
    "the directional field is given by the locally maximal orientations in the glyphs .",
    "in contrast to deterministic tractography , the probabilistic tractography method of mrtrix samples the orientations from the entire fod and does not use just the maxima .",
    "more difficult paths can be reconstructed than with deterministic tracking , but typically also many spurious fibers are produced due to the probabilistic sampling .",
    "both the deterministic and the probabilistic method are explained in more detail in section [ se : tractography ] .    in section [ se : coherence ]",
    "we introduce our new technique to quantify the coherence of fibers with respect to all the fibers in a bundle , based on the same pde theory as employed for the contextual enhancement in section [ se : enhancement ] .",
    "we explain how the kernel of the enhancement pde is used to construct a tractography - based density , how the fbc is computed and how this measure is able to classify spurious fibers in a tractography .",
    "in csd it is assumed that at each voxel position @xmath10 the measured signal @xmath11 can be represented by a spherical convolution of the fod @xmath12 with a response function @xmath13 , that is estimated from the data @xcite .",
    "since the spherical deconvolution to determine the fod is ill - posed , a non - negativity constraint is included as in @xcite .",
    "then , given the signal @xmath14 for a sample of orientations @xmath15 , the solution of csd is found by iteratively solving the minimization problem :    @xmath16    for @xmath17 , with @xmath18 the maximum number of iterations . here",
    "@xmath19 is aligned with and symmetric around the @xmath2-axis , the convolution @xmath20 is the usual @xmath21 spherical convolution @xcite , @xmath22 is the jacobian of the surface measure in orientation @xmath23 and @xmath24 is a parameter to influence the trade - off between the data driven term and regularization term .",
    "the linear operator @xmath25 in the regularization term gives the non - negativity constraint and is defined by :    @xmath26    where @xmath27 is the heaviside function and @xmath28 is a threshold equal to a fixed factor @xmath29 times the mean of @xmath30 . the initial function @xmath31 for the iteration",
    "is computed by taking only the data driven term of eq .",
    "( [ eq : contcsd ] ) .",
    "the iteration stops when successive iterations yield the same result , typically after 5 to 10 iterations @xcite . throughout the paper ,",
    "we call @xmath8 the fod obtained by    @xmath32    in practice csd is performed using spherical harmonics with a maximal spherical harmonic order of @xmath33 ( @xmath34 ) as discussed in @xcite .",
    "improvements to the original csd exist to modify and improve the response function , either by recursive calibration or auto - calibration @xcite , by using multiple acquisition shells @xcite or by including anatomical data @xcite .",
    "the latter two methods aim to reduce the partial volume effects , where csd is likely to produce spurious fiber orientations .",
    "these partial volume effects can occur when in a voxel multiple tissues or multiple bundles with different orientation are present .",
    "here we use the classical csd as it is the basic technique available in several neuroimaging packages .",
    "however , we stress that our method is not restricted to this type of csd . in any case , our method aims to reduce non - aligned crossings in the fod , also the ones induced by partial volume effects , as we will show in several experiments in this paper .",
    "further improvement of the methodology can be expected when including recently extended and more elaborate csd techniques @xcite , but this is left for future work .      to improve alignment of neighboring glyphs of the fod @xmath8 , recall the glyph field visualization in figs .",
    "[ fig : csdenhpipeline ] and [ fig : kernelvis]c , we apply contextual enhancements . before we specify the pde we consider for this enhancement , we first need to express the notion of alignment in mathematical terms . to this end , let us consider fig .",
    "[ fig : coupling ] , where it is shown that the notion of alignment can not be supported by a decoupled , flat cartesian product @xmath35 with the combined euclidean distance .",
    "it is clear that the green bar at @xmath36 is better aligned with the gray bar at @xmath37 than the orange bar at @xmath38 , even though the distances in the space @xmath35 are equal , i.e. @xmath39 .",
    "this means that in order to appropriately describe the concept of alignment , we must consider more than just the amount of spatial displacement and the amount of change in orientation .",
    "coupling these two types of motion ( via rigid body motions ) is a solution to this problem @xcite .",
    "the coupling follows very naturally by expressing the motion of an oriented particle @xmath40 in terms of a moving frame of reference determined by its orientation .",
    "that is , spatial movement along the orientation @xmath41 should be much cheaper than spatial movement in the plane orthogonal to @xmath41 .",
    "this creates a natural anisotropy for spatial movement . for angular motion",
    "we need isotropy .",
    "this extra structure can be obtained by embedding the space of positions and orientations in the rigid body motion group .",
    "this means that an element @xmath42 is identified with the rigid body motion @xmath43 , where @xmath44 is _ any _ rotation matrix such that @xmath45 , with @xmath46 pointing to the north pole .",
    "we denote this space of coupled positions and orientations by @xmath3 , so we have @xmath47 the group @xmath3 is equipped with the following ( non - commutative ) group product :    @xmath48    this product moves oriented elements in a shift - twist fashion , rather than by a rotation followed by an independent translation . due to this shift - twist group product in eq .",
    "( [ eq : groupproduct ] ) , we automatically express motion of oriented particles in terms of a moving frame in @xmath3 , which makes this space well - suited for the application of our contextual enhancements .",
    "nevertheless , in the remainder of this article this space can still be regarded as the cartesian 5d space @xmath35 , where we secured the coupling of positions and orientations via our specific choice of differential operators and diffusions that are applied .",
    "is better aligned with @xmath36 than with @xmath38 , even though spatial and angular distances are equal .",
    "formally we can say that the sub - riemannian distance on @xmath49 @xcite is smaller between @xmath37 and @xmath36.,scaledwidth=60.0% ]        to improve alignment of fod glyphs , we use a particular diffusion process called contour enhancement that uses both spatial and angular diffusion in the extended space of positions and orientations @xcite . given a structure ( think of a fiber bundle ) in this space , see fig .",
    "[ fig : r3s2diff ] , we apply spatial diffusion only in the direction of the structure , not in the spatial plane perpendicular to it .",
    "angular diffusion is applied in the plane tangent to @xmath21 at the point @xmath41 .",
    "this diffusion process enhances elongated structures , while preserving crossing structures , and is given by a fokker - planck type of system , a linear diffusion equation on @xmath3 . for @xmath50 , @xmath51 , @xmath15 this system",
    "can be expressed as : @xmath52 here @xmath53 is a scale space representation in @xmath54 @xcite .",
    "the symbol @xmath55 denotes the gradient with respect to the spatial variables and @xmath56 is the laplace - beltrami operator on the sphere .",
    "parameters @xmath57 and @xmath58 are related to the amount of spatial and angular diffusion , respectivly .",
    "parameter @xmath59 is the diffusion time of the contour enhancement process .",
    "it can be seen as a brownian motion process , recall fig .",
    "[ fig : kernelvis]a , where particles are allowed to spatially move back and forth in the direction they are heading , or change their direction , but are not allowed to step aside ( comparable to the movement of a car ) .",
    "we refer to the solution of eq .",
    "( [ eq : contenh ] ) as the enhanced fod .",
    "it can be obtained via a finite difference scheme @xcite , or via a convolution with a kernel @xmath60 :    @xmath61    a basic approximation to the exact green s function of the contour enhancement pde is known @xcite and can be written as the product of green s functions @xmath62 in the following way :    @xmath63    with @xmath64 , @xmath65 , @xmath66 .",
    "the @xmath0 kernels are given by    @xmath67    with    @xmath68    to avoid numerical errors , we use the estimate @xmath69 for @xmath70 .",
    "this approximation is easy to use and allows for efficient implementation @xcite .    from the approximation kernel in eq .",
    "( [ eq : kernr3s2 ] ) it can be seen that problems could occur when either @xmath71 or @xmath72 . to this end , a necessary and sufficient condition for the existence of a smooth solution kernel for the evolution process in eq .",
    "( [ eq : contenh ] ) is given by the hrmander requirement @xcite .",
    "this condition applies to more general situations than the one here , see e.g. @xcite , but for the specific case of contour enhancement the requirement is satisfied iff @xmath73 . setting @xmath72 would result in a singular non - smooth kernel , which has numerical disadvantages .",
    "more importantly , apart from this theoretical issue the need for both spatial and angular diffusion can also be argued from a practical point of view , as is illustrated in fig .",
    "[ fig : motivationd44 ] .",
    "we use an artificial example in which a curved fiber bundle is present , shown in the left figure . when the input is diffused with @xmath72 as in the middle of fig .",
    "[ fig : motivationd44 ] , the peaks stay distinct and point in the wrong direction . on the other hand , when @xmath58 as in the right figure , due to the angular diffusion the peak is redirected and the glyphs lie better aligned with the fiber bundle .",
    "hence @xmath58 is needed to ensure the crucial interaction between different orientations .",
    "finally we recall the relation between tikhonov regularization and diffusion , see e.g. ( * ? ? ?",
    "* thm 2 ) , which allows us to connect diffusion with @xmath72 with the fiber continuity model in @xcite .",
    "this model does not suffer from the inconvenience of considering only spatial regularization , as they represent the fod in a truncated spherical harmonic basis . when the enhancements are used in combination with probabilistic tractography",
    ", we first apply a standard sharpening deconvolution transform to the fod as described in @xcite , to maintain the sharpness of the fod .    , @xmath72 .",
    "( right ) contour enhancement with @xmath74 .",
    "fiber propagation with @xmath72 leads to crossing artefacts rather than smooth fiber enhancement . ]      as the next step in the pipeline we use the mrtrix tractography algorithm @xcite , as implemented in http://www.brain.org.au/software/index.html#mrtrix , version 0.2.12 .",
    "it allows us to perform deterministic and probabilistic fiber tracking on spherical harmonic representations of the ( enhanced ) fod . to have a fair comparison between trackings on the fod and the enhanced fod",
    ", we use the parameter settings as explained next .",
    "* in the deterministic tracking of mrtrix , seed points are randomly selected from a seed region .",
    "the initial direction is sampled randomly and every next step follows the direction of the most aligned fod maximum .",
    "if this maximum is below a threshold value , the fiber terminates . this threshold ( cutoff )",
    "is set to 10% of the maximal angular response of the fod .",
    "there is no constraint on the maximal curvature of the fibers . to prevent that fibers have an initial direction that is not aligned with the fiber bundle",
    ", we force the initial direction to be approximately in the direction of the maximal fod peak , by setting the initial cutoff to 0.9 .",
    "the step size is set to @xmath75th of the voxel size as is suggested in @xcite .",
    "tracks proceed in both directions from the seed point and terminate either when they hit the boundary of the volume or mask ( if applicable ) , or due to the threshold stopping criterion . * in the probabilistic case , starting from the seed region , every next step follows a direction randomly sampled from the fod . here",
    "we set the minimal radius of curvature to @xmath76 mm , the default value in the mrtrix algorithm .",
    "optionally , a target region of interest is used to select only those fibers that cross this region .",
    "we base our choice for deterministic tractography or probabilistic tractography on the application .",
    "if only a seed region is specified , as in sections [ se : hardirecon ] and [ se : evaluationdwmri ] , we use deterministic tractography . in this case",
    "there is too much freedom in the probabilistic algorithm and",
    "the streamlines show a lot of spurious behavior . here",
    ", a probabilistic approach could make sense if extreme amounts of tracks are used for track density methods . as we do not pursue these methods here",
    ", we prefer to use deterministic tractography .",
    "if both a seed region and an end region are specified , as in the optic radiation application in section [ se : orexperiment ] , we prefer to use probabilistic tractography .",
    "it is known that deterministic tractography in this case provides only a few of the possible pathways from the seed to the end region , whereas reconstructions with probabilistic tractography are much fuller .",
    "probabilistic tractography results typically contain many false positive fibers .",
    "streamlines that are anatomically implausible can be removed with scoring methods @xcite or by imposing anatomical constraints .",
    "even when using these methods , the filtered tractography output can still contain fibers that deviate from the fiber bundle and are likely to be spurious . in the next section ,",
    "we propose a coherence measure for fibers in a fiber bundle in order to classify these spurious fibers .      in this section",
    "we introduce our second contribution of the paper , a _ fiber to bundle coherence _ ( fbc ) measure to quantify the coherence of each fiber with respect to all other fibers in the bundle , recall fig .",
    "[ fig : csdenhpipeline]b . a spurious fiber , as schematically shown in fig . [ fig : spurfibschematic ] ,",
    "is isolated from or poorly aligned with the bulk of the tracks and is therefore unlikely to represent the underlying brain structure .",
    "fibers with low coherence , i.e. a low fbc , can then be classified as spurious .    to classify a fiber as spurious",
    ", we first construct a density by regarding each fiber as a superposition of @xmath6-distributions in @xmath3 and convolving this distribution with the kernel in eq .",
    "( [ eq : kernr3s2 ] ) .",
    "this density is independent of the underlying data and is based purely on the collection of fibers @xmath77 .",
    "integration of this density along a part of length @xmath78 of a fiber gives a local measure for the coherence of that part .",
    "next we explain the mathematical techniques that support the idea in fig .",
    "[ fig : spurfibschematic ] .",
    "we denote the fibers from a tractography output by @xmath79 , @xmath80 , @xmath81 , with @xmath82 the arc length parameter , @xmath83 the total length of fiber @xmath84 and @xmath85 the number of fibers .",
    "now let @xmath86 be the tangent of the fiber , so that @xmath87 forms a curve ( fiber ) in @xmath35 . by construction ,",
    "@xmath88 points in the forward direction of the fiber .",
    "since in dw - mri data antipodal orientations are identified , we also consider @xmath89 .",
    "the complete fiber bundle is defined as @xmath90 .",
    "a discrete formulation of a fiber @xmath84 with @xmath91 points is given by :    @xmath92    this way there are @xmath93 elements in @xmath77 .",
    "now we regard every point @xmath94 as a @xmath6-distribution in @xmath3 centered around @xmath95 . a density for the entire bundle",
    "is then constructed as follows : @xmath96 with index @xmath97 running over points within a fiber , @xmath84 running over all fibers and @xmath98 taking care of including forward and backward orientations .",
    "we use the same evolution process as in eq .",
    "( [ eq : contenh ] ) in which @xmath99 now serves as initial condition , to create a diffused density @xmath100 :    @xmath101    we solve the system in ( [ eq : contenhf ] ) by convolution with the corresponding kernel , recall fig . [ fig : kernelvis ] , and call this the _ local _ fbc ( lfbc ) :",
    "@xmath102    with the shift - twist convolution as given in eq . (",
    "[ eq : shifttwistconv ] ) .",
    "this is illustrated in fig .",
    "[ fig : spurfibschematic ] in the 2d case .",
    "we can now define the fbc for fiber @xmath103 with respect to the bundle @xmath77 as the integral of this density along the fiber :    @xmath104    this results in a global property of the fiber , but spurious fibers often only locally deviate from the bundle as in fig .",
    "[ fig : spurfibschematic ] . to this end",
    ", we compute for each fiber the minimum of such integrals along the fiber over intervals of length @xmath78 :    @xmath105 } \\frac{1}{\\alpha } \\int_a^{a+\\alpha } { \\text{lfbc}}(\\gamma_i(s),\\gamma ) \\ ; { \\mathrm{d}}s.\\ ] ]    the parameter @xmath78 defines the scale over which spuriousness of fibers can be detected and is much smaller than the average fiber length .",
    "our primary interest is not the @xmath106 value itself , but rather how it compares to the average coherence of fibers in the bundle , so finally we define the _ relative _ fiber to bundle coherence ( rfbc ) as :    @xmath107    here @xmath108 is the _ average _ fiber to bundle coherence indicating the overall coherence of the @xmath85 fibers in the bundle @xmath77 , defined as    @xmath109    to summarize , the @xmath110 of a fiber @xmath103 in a bundle @xmath77 is a measure for how well aligned the least aligned part of @xmath103 is , compared to the average coherence of the total bundle .    in practice , we evaluate the convolution in eq .",
    "( [ eq : ptconvf ] ) only in the fiber points .",
    "we compute the @xmath111 , the diffused density in the oriented point @xmath112 , recall the notation in ( [ eq : notationgamma ] ) , as follows :    @xmath113    where @xmath114 is any rotation matrix such that @xmath115 , index @xmath116 sums the contributions along a fiber , index @xmath97 runs over all the fibers and @xmath98 as before .",
    "the @xmath106 can then be computed as follows :    @xmath117 } \\frac{1}{\\alpha } \\sum_{k = a+1}^{a + \\alpha } { \\text{lfbc}}(\\gamma_i^k,\\gamma),\\ ] ]    where @xmath118 in this discrete case , so the lfbc is summed along short intervals of the fiber .",
    "likewise , the afbc can be computed as    @xmath119    we apply this method in section [ se : orexperiment ] for quantifying the coherence of tractography results of the optic radiation and classifying the spurious fibers .",
    "in this section we extensively test the performance of our csd enhancement method ( a ) and the fbc method ( b ) , recall fig . [",
    "fig : csdenhpipeline ] and sections [ se : enhancement ] and [ se : coherence ] , in three different experiments :    * we use the hardi reconstruction challenge dataset @xcite , which is artificial data with known ground truth , to quantitatively evaluate the csd enhancement method ( a ) on deterministic tractography in section [ se : hardirecon ] . * in section [",
    "se : evaluationdwmri ] we show on dw - mri human brain data that the enhancement ( a ) have a positive effect on deterministic tractography , for different acquisition protocols of the data .",
    "furthermore , on this dw - mri dataset and on the phantom dataset we compare our method to previous work @xcite , where a dti - based fod is used in combination with nonlinear pde flow .",
    "* in the third and last experiment , we reconstruct the optic radiation in human clinical data , see section [ se : orexperiment ] .",
    "we include an extensive evaluation of our methods , the enhancement of the fod ( a ) and the use of the fbc to classify and remove spurious fibers ( b ) , and the combination of both methods .",
    "we show that the reproducibility of the probabilistic tractography has increased , resulting in a more stable localization of the tip of the meyer s loop .    for all datasets mathematica @xcite",
    "was used to perform the contour enhancement algorithm and the csd , which in practice produces the same results as the mrtrix csd implementation when the same deconvolution kernel is used .",
    "mrtrix software @xcite was used to perform fiber tractography .",
    "the coherence quantification was implemented in c++ . in section [",
    "se : hardirecon ] we make use of the tractometer @xcite ( http://www.tractometer.org/ ) to evaluate tractography results .",
    "visualization was done in either the fibernavigator ( https://github.com/scilus/fibernavigator,@xcite ) , mathematica , or the open source vist / e tool ( eindhoven university of technology , imaging science & technology group , http://bmia.bmt.tue .",
    "nl / software / viste/[http://bmia.bmt.tue .",
    "nl / software / viste/ ] ) .",
    "+      the following experiment is performed on a digital phantom dataset that was designed for the isbi 2013 reconstruction challenge @xcite .",
    "it is used in combination with the tractometer @xcite , as a benchmark to compare different reconstruction and tracking methods .",
    "the phantom is inspired by the numerical fiber generator @xcite and the code to reproduce it is freely available as part of the python package phantomas ( http://www.emmanuelcaruyer.com/phantomas.php ) .",
    "this synthetic dataset is of size @xmath120 voxels with a resolution of @xmath121 mm@xmath122 .",
    "it consists of @xmath123 simulated white matter bundles , designed to resemble challenging branching , kissing and crossing structures at angles between @xmath124 and @xmath125 degrees , with various curvature and bundle diameters ranging from @xmath126 to @xmath127 .",
    "an image indicating the ground truth fiber configuration is shown in the centre of fig .",
    "[ fig : isbifull ] .",
    "the idea behind the signal simulation is that every voxel is subdivided into multiple sub - voxels , each one with its own attenuation profile .",
    "the final signal arrives from integrating the contribution of all the sub - voxels .",
    "then , it is possible to combine multiple compartment types in every voxel with added rician noise .",
    "this allows for modelling complex configurations as well as taking into account partial volume effects .",
    "while the numerical fiber generator uses a tensor - like model to simulate the signal in the sub - voxels , phantomas uses a charmed - based model @xcite .",
    "the charmed model based on the sderman - jnsson cylinder model @xcite captures well the non - gaussian behaviour of the diffusion signal for large b - values .",
    "the main reason why we selected the isbi phantom is that it is linked with the tractometer that allows for performing quantitative evaluations of the tractography results , using global metrics as demonstrated in the subsequent experiments .    for the experiments presented in this section we used 64 uniformly distributed gradient directions using a @xmath7-value of @xmath128 with different signal to noise ratios ( snrs ) .",
    "we use spherical harmonics in csd with maximal order 8 , resulting in @xmath129 estimated coefficients on each position .",
    "we then enhance the resulting fod functions using our contour enhancement algorithm with varying parameters . from the evolutions described in eq .",
    "( [ eq : contenh ] ) we see by a basic rescaling argument that it is sufficient to vary @xmath130 and the ratio @xmath131 . the larger this ratio , the more preference the spatial diffusion gets over the angular diffusion , resulting in elongated kernels ( visualized by thin glyphs ) .",
    "a smaller ratio @xmath132 is better suited in regions where the curvature of bundles is higher ( visualized by thicker glyphs ) .",
    "the higher the diffusion time @xmath130 , the more context is taken into account .",
    "when @xmath130 is too large , fiber bundles with high curvature can be damaged or false positives could be created . taking this into consideration ,",
    "we choose our parameters as follows : we fix spatial diffusivity parameter @xmath133 , we take the angular diffusivity parameter @xmath134 and diffusion times @xmath135 $ ] .",
    "( top ) and @xmath136 .",
    "the colors correspond to the direction of the fibers .",
    "the dataset consists of crossing , branching and kissing fiber bundles .",
    "the tractography on enhanced csd results in better aligned fibers and a fuller reconstruction of the bundles .",
    "the ground truth configuration of the bundles is depicted in the center . ]",
    "tractography results for the entire dataset are shown in fig .",
    "[ fig : isbifull ] .",
    "we can recognize the positive effect of the enhancements on deterministic tractography : we see less dropouts , better aligned fibers and better continuation of fibers at crossings .",
    "an extensive quantification of the performance of our method is done at the voxel level using the fods and at the macroscopic level using tractography in sections [ se : localmetrics ] and [ se : globalmetrics ] , respectively .",
    "both sections support the results summarized in fig .",
    "[ fig : isbiresults ] .",
    "we compare reconstructed fods locally with the ground truth using only the orientation of the peaks .",
    "let @xmath137 be the set of voxels @xmath138 in the white matter mask , then we denote the ground truth number of peaks in a voxel @xmath138 by @xmath139 and the orientations corresponding to the peaks by @xmath140 , @xmath141 .",
    "maxima of the constructed fod are found by evaluating the fods on a @xmath142 order icosahedron tessellation with @xmath143 antipodally symmetric points , giving an angular resolution of less than @xmath76 degree .",
    "maxima are taken into account only if it exceeds a threshold of @xmath144 , the same value we use as threshold in the tractography .",
    "let @xmath145 be the set of peak orientations in voxel @xmath138 estimated from the fod .",
    "the average angular error in degrees can then be computed by :    @xmath146    in the top row of fig .",
    "[ fig : isbiresults ] we show the effects contour enhancement for different ratios of @xmath147 and @xmath148 upon variation of the diffusion time .",
    "the results are given for substantially low snr levels @xmath149 , @xmath150 and @xmath151 and @xmath152 .",
    "these snrs are computed w.r.t . the non - dw image .",
    "specifically , if the b=0 intensity is 1 then the standard deviation of the rician noise distribution is 1/snr . in all cases a clear improvement",
    "is found compared to csd without enhancements and the more noise , the more the angular error is decreased .",
    "higher diffusion times give better results and around @xmath153 the angular error is almost stable .",
    "it can also be seen that the combination of csd with enhancements at lower snrs gives lower angular errors than just csd for the higher snrs .",
    "there is no significant difference in the fods between the different @xmath148 values . even though it is visible that more angular diffusion leads to fatter glyphs , for the orientation of the peaks the precise value of @xmath148 is not of great importance : the angular errors for @xmath154 are slightly smaller , but there is not much difference with the higher values of @xmath148 . +     and four different snrs as we increase the diffusion time @xmath130 .",
    "the top row shows the average angular error of the fod peaks , the rows below show the average bundle coverage ( abc ) , connection to seed ratio ( csr ) and the valid connection to connection ratio ( vccr ) , computed from the tractography results . ]      at the macroscopic level we are interested in the impact of the enhanced local reconstruction on the quality of the global connectivity .",
    "the deterministic mrtrix tractography is used as described in section [ se : tractography ] , with seeds randomly selected in the white matter mask .",
    "the tracks have a minimum length of @xmath149 mm and new seed points are chosen until 10000 streamlines are selected . for every fod",
    ", the tractography is repeated five times with the same settings , to average out the variability in the tracking algorithm output .",
    "we then use the tractometer @xcite to perform a fiber tracking analysis based on the ground truth and the five results are averaged .",
    "the tractometer outputs values for various metrics , from which we use the valid connections ( vc ) , invalid connections ( ic ) and no connections ( nc ) .",
    "they indicate the percentage of tracks that correctly connect , incorrectly connect or do not connect gray matter areas in the dataset , respectively .",
    "we also use the average bundle coverage ( abc ) , the percentage of voxels in a bundle that is crossed by a valid streamline , averaged over all bundles .",
    "we combine the ( vc ) , ( ic ) and ( nc ) in two metrics introduced in @xcite :    * connection to seed ratio ( csr ) , which represents the probability that a generated fiber actually connects two gray matter areas , computed as @xmath155nc . * valid connection to connection ratio ( vccr ) , the probability that a connecting fiber is correct , computed as vc/(vc+ic ) .",
    "the results for the abc , csr and vccr with the same enhancement parameters and snrs as for the local metric are given in fig .",
    "[ fig : isbiresults ] .",
    "similar remarks hold for the global metrics as for the angular error .",
    "for all three metrics and all snrs the enhancements lead to an improvement compared to csd , the only exception being the abc for @xmath156 and @xmath157 . furthermore , as the snr decreases , the larger diffusion times are beneficial and the more significant the improvement is .",
    "the best results are obtained for @xmath154 .",
    "we expect that truncation of the spherical harmonics already introduces some angular smoothing of the fods on this artificial dataset , explaining the small effect of @xmath148 in the experiments . furthermore , we see that the diffusion time @xmath130 truly acts as a regularization parameter , resulting in a robustness for the metrics with respect to the snrs : the higher the diffusion time , the smaller the differences in the metrics between the different snrs .    seeding from the white matter voxels can lead to an over - representation of the number of fibers in longer fiber bundles with respect to the shorter bundles @xcite .",
    "the longer bundles thereby have a larger contribution to the global metrics than the shorter bundles , which could lead to an overestimation of the fiber bundles .",
    "as proposed in @xcite , we compared the global metrics when seeding from the gray / white matter interface for csd and one specific set of enhancement parameters .",
    "the global metrics for that seeding strategy were slightly lower for csd and comparable when including enhancements .",
    "for the sake of comparing our enhancement method with csd , we therefore believe it is fair to use seeding from the white matter mask .    the convincing improvement in the global metrics is supported by fig . [ fig : prtscrns ] , that shows a selection of the fiber bundles in the dataset . it can be seen that after enhancements , there are more valid connections in the green bundle and less wrong exits in the red bundle , leading to a higher ( vccr ) and a better bundle coverage .",
    "the glyphs in the top row show that the enhancements improve alignment of glyphs , especially at the boundary of the fiber bundles , where the original csd result tends to suffer from partial volume effects .     and the parameters used for the enhancements are @xmath158 , @xmath159 , @xmath160 . the ground truth image with the same viewpoint as the bottom figures is depicted on the left .",
    "]      in this experiment we consider a dw - mri dataset of a part of a human brain , previously used in @xcite .",
    "the study was approved by the local ethical commitee of maastricht university , and informed written consent was obtained from the subject .",
    "although the dataset consists of only 10 axial slices , the corpus callosum , corona radiata and superior longitudinal fasciculus are ( partly ) present in the data . we show that the combination of csd and enhancement is well - suited for different combinations of the @xmath7-value and the number of gradient directions used in the acquisition .",
    "furthermore , we make a qualitative comparison with the dti - based method of @xcite on this dataset and conclude with a brief quantitative comparison with this method on the dataset of [ se : hardirecon ] .",
    "the acquisition was performed on a 3 t siemens allegra scanner , with fov 208x208 mm and voxel size 2x2x2 mm . during the data acquisition ,",
    "a brain region consisting of 10 axial slices was scanned with the following combinations of @xmath7-values and @xmath161 , the number of orientations : @xmath162 s / mm@xmath163 with @xmath164 , @xmath162 s / mm@xmath163 with @xmath165 and @xmath166 s / mm@xmath163 with @xmath164 .",
    "we use again csd with spherical harmonics up to order 8 .",
    "the higher @xmath7-value is obtained by using a stronger gradient pulse , making the acquisition more sensitive to detail in the tissue structure , but also inducing a lower snr .",
    "increasing the number of gradient directions gives a better angular resolution .",
    "we use deterministic tractography , with three seed regions manually selected in the middle of the corpus callosum , corona radiata and superior longitudinal fasciculus .    in the right column of fig .",
    "[ fig : trackingcomparison ] we show that after enhancements , the fod allows for a more coherent reconstruction of the three bundles . especially in the region where the three bundles come together",
    ", it can be seen that the fibers have a better propagation through the crossings . moreover , the fods after enhancements are very similar to each other , visible in the glyph visualization , leading to three tractography results supporting similar fiber bundles .",
    "this is an improvement with respect to csd without enhancement , shown in the left column of fig .",
    "[ fig : trackingcomparison ] .",
    "there we find more noisy fods with more variation between the different protocols .",
    "this is also reflected in the tractography results , that contain more spurious fibers than after the enhancements .",
    "we conclude , just like in the first experiment on the phantom data , that applying enhancements induces more robust tractography also on real dw - mri data , in this case in the sense that it is less sensitive to the acquisition parameters @xmath7 and @xmath161 .    , @xmath157 , @xmath160 .",
    "all three bundles are more apparent after enhancements and more fibers pass the crossings . ]      in the next experiment we compare the performance of our combination of csd with enhancements with the method in @xcite which proposed to combine dti with _ non - linear _ pde - based enhancement obtained from successively applying erosions and diffusions .",
    "let us briefly describe this method , for details we refer to @xcite , and an implementation of the pde enhancements can be found in the hardi package for mathematica available at ( http://bmia.bmt.tue.nl/people/rduits/hardialgorithms.zip ) .",
    "first an fod on positions and orientations that we call @xmath167 was constructed via a transformation of the tensor field @xmath168 fitted to the data @xcite , according to the following definition @xcite :    @xmath169    this fod is then sharpened with pde erosions , a type of morphological enhancement adapted from @xcite , on @xmath3 and regularized with nonlinear diffusions to find crossing structures from dti .    previously in @xcite , the same dataset as in fig .",
    "[ fig : trackingcomparison ] for acquisition parameters @xmath170 s / mm@xmath163 and @xmath164 was processed .",
    "here we compare the fod obtained with csd , that we call @xmath171 here , with @xmath167 in the top and bottom figures , respectively , of fig .",
    "[ fig : glyphcomparison ] . unlike dti , which is limited by the gaussian assumption of the diffusion profile",
    ", csd can estimate multiple fiber orientations within a voxel .",
    "furthermore , we see that the large glyphs in the centrum semiovale in the bottom figure are not apparent in @xmath171 . applying ( linear )",
    "enhancements , as explained in section [ se : enhancement ] , to @xmath171 gives the second figure , and the approach in @xcite using erosions/(nonlinear ) enhancements applied to @xmath167 gives the second figure from below .",
    "it can be seen that also the enhanced dti glyphs supports multiple fiber directions within voxels via extrapolation @xcite , but at the cost of high regularization .",
    "another noticeable difference is the fact that the glyphs in the csd case are slimmer and crossings are more clearly defined . whether two separate maxima are visible at a crossing is less dependent on the diffusion parameters in the pde diffusion .    .",
    "erosions and nonlinear diffusions for the dti - based method are done with parameters as in @xcite .",
    "the tractographies corresponding to the two methods are shown in the middle .",
    "outliers such as the red fiber , indicated by the arrow , occur due to the use of high regularization coefficients . ]    besides the visual comparison of the fod glyphs , we provide deterministic tractography results for both procedures in the middle of fig .",
    "[ fig : glyphcomparison ] . it can be observed that both methods produce reasonable results , although the one obtained from the enhanced dti dataset seems oversmoothed and outliers ( indicated with the yellow arrow ) can occur .",
    "this is due to the extreme diffusion parameters needed to perform the fod extrapolation .",
    "we find that visually the combination of csd and linear enhancements yields better tractography than dti combined with erosions and nonlinear enhancements .    to provide a more quantitative and complete comparison of dti , dti and nonlinear enhancements , csd and csd with linear enhancements , we also include results of the experiment in section [ se : hardirecon ] for the dti methods , see table [ tab : isbiresults ] .",
    "we heuristically determined good parameter settings for the nonlinear enhancement of dti : erosions ( * ? ? ? * eq .",
    "( 59 ) ) with @xmath172 , @xmath173 , @xmath174 and diffusion ( * ? ? ?",
    "* eq . ( 55 ) ) with @xmath175 , @xmath158 , @xmath159 and @xmath176 .",
    "in table [ tab : isbiresults ] is shown that applying enhancements for contextual regularization of the fod is beneficial for both dti and csd .",
    "the lower the snr , the more evident the improvements become .",
    "furthermore , we see that in terms of the local metric , the angular error @xmath177 of the peak orientations , the dti methods can compete with the csd based methods",
    ". however , the global metrics are significantly higher for csd based methods .",
    "the quantitative results on the phantom data in table [ tab : isbiresults ] are in line with the qualitative comparison on real data in fig .",
    "[ fig : glyphcomparison ] .",
    ".for two snr values , the results are shown for the dti method described in section [ se : evaluationdwmri ] , with or without nonlinear enhancements .",
    "we compare with csd and a specific instance of enhanced csd with parameters @xmath178 , @xmath179 .",
    "for local metric @xmath177 lower is better , for the other metrics higher is better . in boldface",
    "are the best results for the dti and csd methods . + [ cols=\"<,<,<,<,<\",options=\"header \" , ]     [ tab : isbiresults ]      the optic radiation ( or ) is a white matter fiber bundle connecting the primary visual cortex and the lateral geniculate nucleus ( lgn ) , see fig .",
    "[ fig : prtscrn_or ] .",
    "the most anterior part of the or is called the meyer s loop ( ml ) , of which the exact location is of interest for treatment of temporal lobe epilepsy @xcite . during neurosurgery ,",
    "a part of the temporal lobe is resected . to ensure that the or remains intact to prevent visual field defect , it is crucial to know the distance from the tip of the meyer s loop to the temporal pole ( ml - tp ) @xcite , which shows large interpatient variability @xcite .",
    "we use dw - mri scans of four subjects , performed on a 3.0 t philips achieva mr scanner , with @xmath170 s / mm@xmath163 , @xmath180 and a spatial resolution of 2x2x2 mm .",
    "all subjects gave written informed consent ; the study was approved by the medical ethics committee of maastricht university medical center ( n 43386.068 ) .",
    "the data is acquired from healthy volunteers , and ground - truth ml - tp distance is not known . therefore accuracy of this measure of our methods can not be checked , instead we focus on consistency and reproducibility .",
    "we apply csd to the data to construct the fod , with spherical harmonics up to order 6 requiring the estimation of 28 coefficients ( as 32 directions are insufficient to estimate the 45 coefficients when a spherical harmonic order 8 is used , when not using super - resolution as in @xcite ) .",
    "we seed from the lgn and include all fibers that reach the primary visual cortex .",
    "both regions of interest are selected manually on a t1-weighted image .",
    "we use probabilistic fiber tracking as described in section [ se : tractography ] .",
    "we demonstrate the effect of the enhancement of csd and the use of the fbc measure in sections [ se : methoda ] and [ se : methodb ] , respectively , in this relevant clinical setting . a quantitative comparison of the four methods csd ( o ) , csd + enhancement ( a ) , csd + fbc ( b ) and csd + enhancement + fbc ( a+b ) is provided in section [ se :",
    "quantitativeor ] .",
    "we show that the enhancement and/or the removal of spurious fibers , but in particular the combination of both methods , allows for a more stable computation of the ml - tp distance than the original tractography result .      in this section ,",
    "we apply the pde enhancement ( step a ) to the csd fod as before , with parameter settings @xmath178 , @xmath181 and @xmath182 . after the enhancement we apply the sharpening deconvolution transform @xcite and probabilistic tractography with 10000 streamlines .",
    "we compare the results of the tractography on the subjects both before and after the enhancement in fig .",
    "[ fig : or4subjects ] .",
    "we see that the tracking on enhanced data generally shows less spurious fibers , and has a better pronounced tip of the meyer s loop . however , the optic radiation is a highly curved structure , where the advantage of the enhancement of elongated structures can not be fully exploited . to further reduce the spurious fibers ,",
    "we explore our other approach in the next section .      in this section",
    ", we apply probabilistic tractography on subject 1 , with 20000 streamlines and including state of the art data scoring as in @xcite ( only relying on the data term , i.e. @xmath183 in ( * ? ? ?",
    "* eq.(11 ) ) ) , see fig .",
    "[ fig : orcomparison ] .    the kernel parameters for the coherence quantification ( step b )",
    "are set to @xmath178 , @xmath184 and @xmath185 for the convolution @xcite .",
    "let @xmath77 be the set of the 1000 most anterior fibers in a tractography of the or , that roughly form the meyer s loop .",
    "we compute the lfbc and subsequently the rfbc for all the fibers in @xmath77 .",
    "then we take @xmath186 , the rfbc corresponding to the `` central '' fiber , in the sense that it is most coherent with the fiber bundle .",
    "we define the filtered set @xmath187 as    @xmath188    this means the parameter @xmath189 acts as a threshold parameter and can be set such that fibers with a high spuriousness are removed .",
    "the fiber point in @xmath187 that is closest to the temporal pole defines the ml - tp distance .",
    "we repeat the probabilistic tractography five times with the same settings on the same data , to qualitatively compare different stochastic realizations of the tractography method .",
    "the original or reconstructions are shown in the top row of fig .",
    "[ fig : orcomparison ] .",
    "we observe that due to the presence of spurious fibers , the tip of the meyer s loop ( indicated by the orange spheres ) is estimated at different locations .",
    "when we set the threshold @xmath190 , removing in these cases between @xmath150% and @xmath33% of the most spurious fibers , we obtain the results as shown in the bottom row of fig .",
    "[ fig : orcomparison ] .",
    "it can be seen that the resulting fiber bundles are very similar to each other , demonstrating less variation in the localization of the tip .      to support our claims of the two previous sections , we test the effect of our methods on the stability of the ml - tp distance under different stochastic realizations .",
    "here we perform probabilistic tractography with 10000 fibers ten times with the same settings , for each of the four subjects and each of the four methods ( csd , csd + enh , csd + fbc and csd + enh + fbc ) .",
    "the fbc measure is computed from the 1000 most anterior fibers as in the previous experiment and the threshold is set to @xmath191 .",
    "we compare the mean ml - tp distance and sample standard deviation determined from the tracking results of each of the methods .",
    "the results are summarized in the boxplots in fig .",
    "[ fig : mltp_distances ] .",
    "the figure strongly supports the application of the enhancements methods . for subjects 1 - 3",
    "the ml - tp distance shows much less variation when including the fbc .",
    "for all subjects also ( csd + enh ) gives more stable results than just csd .",
    "moreover , in all cases the combination ( csd + enh + fbc ) outperforms csd and for all but subject 1 the combined method ( csd + enh + fbc ) also gives better results than the enhancement or fbc individually .",
    "it should be remarked that higher up the graph indicates a larger resection if used for pre - surgical evaluation , which is not necessarily positive .",
    "however , we prefer to have a stable and reproducible method that can be used with a safety margin , then a method that is more conservative , but shows large variations .",
    "we have proposed two new tools to improve alignment of fibers in tractography results : ( a ) the combination of csd with contextual pde enhancements and ( b ) a fiber to bundle coherence measure to classify spurious fibers .",
    "both approaches rely on the same contextual processing via pdes on the space of coupled positions and orientations .",
    "we validate our methodology with a variety of experiments on synthetic and human data .    in the first experiment we consider a digital phantom @xcite that simulates dw - mri data of a challenging configuration of multiple neural - like fiber bundles for different noise levels , see fig .",
    "[ fig : isbifull ] .",
    "the combination of csd with enhancements and subsequent deterministic tracking was extensively tested for varying enhancement parameters , see fig .",
    "[ fig : isbiresults ] .",
    "the enhanced fod peaks were compared with the ground truth fiber orientations , showing for all snrs that the maxima of the enhanced fod coincide better with the ground truth peaks than without application of enhancement . also , this improvement is particularly high for very low snr values . to quantitatively evaluate the impact of the enhancement on the tractographies we used the tractometer evaluation system @xcite .",
    "the results , shown in fig . [ fig : isbiresults ] confirm the benefit , for all the metrics considered , of including the enhancement .",
    "also an improved stability of the metrics with respect to different enhancement parameters is observed .",
    "furthermore , we found that data with a lower snr requires more regularization , obtained by choosing a higher diffusion time @xmath130 in the enhancement .",
    "these quantitative evaluations of local and global metrics are supported by the qualitative results in figs .",
    "[ fig : isbifull ] and [ fig : prtscrns ] , where we saw that after enhancement fibers are better aligned and propagate better through crossings .",
    "the second experiment is performed on human data of a representative area of the brain with crossing fiber bundles .",
    "we evaluate our combination of csd and enhancement for three different ( single - shell ) acquisition protocols , corresponding to different @xmath7-values and number of gradient directions .",
    "we observed , see fig .",
    "[ fig : trackingcomparison ] , that whereas tractography on csd without enhancement showed notable differences between the three acquisition protocols , tractography after our enhancement lead to a qualitatively similar reconstruction in all cases .",
    "this implies that the application of enhancement in the processing pipeline makes the tractography results less dependent on the scanning protocol used .",
    "we use the same dataset and the phantom dataset to compare our method qualitatively and quantitatively with previous work @xcite in which sharpening methods and nonlinear enhancement pdes are applied to dti .",
    "we observed qualitatively on real data in fig .",
    "[ fig : glyphcomparison ] and quantitatively in table [ tab : isbiresults ] the advantage of csd , that allows to use linear enhancements with less extreme regularization parameters than with the dti based method , resulting in a more reliable tractography .    for our second approach to improve fiber alignment , we introduced a fiber to bundle coherence measure that can be used for detecting and filtering spurious fibers .",
    "the fiber to bundle coherence ( fbc ) is computed from a tractography based density that we constructed using the same pde foundation as in the first method . as an application we considered the reconstruction of the optic radiation , a fiber bundle of which the position of the anterior extent ( the meyer s loop ) is of interest for temporal lobe resection surgery .",
    "accurate and stable localization of the tip of the meyer s loop is difficult due to the presence of spurious fibers , as shown in fig .",
    "[ fig : prtscrn_or ] .",
    "we demonstrated in figs .",
    "[ fig : or4subjects ] , [ fig : orcomparison ] and [ fig : mltp_distances ] that either by enhancement of the csd fod , or by removing the most spurious fibers using the fbc measure leads to a robust probabilistic tractography .",
    "in particular , the combination of both methods in one pipeline allows for a more stable localization of the tip of the meyer s loop and a more stable determination of the meyer s loop to temporal pole distance .",
    "our experiments show that our pde enhancement methods for contextual processing are an effective and widely applicable tool to both enhance csd data and to remove spurious fibers from tractographies .",
    "while we used csd to construct an fod , the pde enhancement can be applied to an fod obtained with any other method .",
    "we have seen that both our methods improve fiber alignment in tractography results and hence provide information on structural connectivity of the brain white matter more robustly . in the future , we aim to improve this framework by using data - adaptive smoothing , for example using local gauge frames @xcite .",
    "we would like to thank dr .",
    "a. roebroeck from the faculty of psychology & neuroscience , maastricht university for providing us with the human data used in section [ se : evaluationdwmri ] .",
    "the study was approved by the local ethical commitee of maastricht university .",
    "we gratefully acknowledge academic center for epileptology kempenhaeghe & maastricht umc+ for providing us with the healthy volunteer data used in section [ se : orexperiment ] .",
    "the study was approved by the medical ethics committee of maastricht university medical center ( n 43386.068 ) .",
    "informed written consent was obtained from all subjects .",
    "the research leading to the results of this paper has received funding from the european research council under the european community s 7th framework programme ( fp7/20072014)/erc grant agreement no . 335555 .",
    "le  bihan d , breton e , lallemand d , grenier p , cabanis e , et  al .",
    "( 1986 ) mr imaging of intravoxel incoherent motions : application to diffusion and perfusion in neurologic disorders .",
    "radiology 161 : 401407 .",
    "basser pj , mattiello j , le  bihan d ( 1994 ) mr diffusion tensor spectroscopy and imaging .",
    "biophysical journal 66 : 259267 .",
    "tournier jd , mori s , leemans a ( 2011 ) diffusion tensor imaging and beyond .",
    "magnetic resonance in medicine 65 : 15321556 .",
    "jeurissen b , leemans a , tournier jd , jones dk , sijbers j ( 2013 ) investigating the prevalence of complex fiber configurations in white matter tissue with diffusion magnetic resonance imaging .",
    "human brain mapping 34 : 27472766 .",
    "descoteaux m , poupon c ( 2012 ) diffusion - weighted mri . in : comprehensive biomedical physics .",
    "tournier jd , calamante f , connelly a ( 2012 ) mrtrix : diffusion tractography in crossing fiber regions . international journal of imaging systems and technology 22 : 53 - 66 .",
    "jones dk , cercignani m ( 2010 ) twenty - five pitfalls in the analysis of diffusion mri data .",
    "nmr in biomedicine 23 : 803820 .",
    "wiest - daessl n , prima s , coup p , morrissey sp , barillot c ( 2007 ) non - local means variants for denoising of diffusion - weighted and diffusion tensor mri . in : miccai ( 2 ) .",
    "springer , volume 4792 of _ lecture notes in computer science _ ,",
    "344 - 351 .",
    "coup p , yger p , prima s , hellier p , kervrann c , et  al .",
    "( 2008 ) an optimized blockwise nonlocal means denoising filter for 3-d magnetic resonance images .",
    "ieee transactions in medical imaging 27 : 425 - 441 .",
    "descoteaux m , wiest - daessl n , prima s , barillot c , deriche r ( 2008 ) impact of rician adapted non - local means filtering on hardi . in : miccai",
    "springer , volume 5242 of _ lecture notes in computer science _ ,",
    "122 - 130 .",
    "poupon c , clark ca , frouin v , rgis j , bloch i , et  al .",
    "( 2000 ) regularization of diffusion - based direction maps for the tracking of brain white matter fascicles . 12 : 184195 .",
    "coulon o , alexander dc , arridge sr ( 2001 ) a regularization scheme for diffusion tensor magnetic resonance images . in : ipmi .",
    "springer , volume 2082 of _ lecture notes in computer science _ ,",
    "tschumperl d , deriche r ( 2001 ) diffusion tensor regularization with constraints preservation . in : computer vision and pattern recognition , 2001 .",
    "cvpr 2001 .",
    "proceedings of the 2001 ieee computer society conference on .",
    "ieee , volume  1 , pp .",
    "burgeth b , didas s , weickert j ( 2009 ) a general structure tensor concept and coherence - enhancing diffusion filtering for matrix fields . in : visualization and processing of tensor fields , springer berlin heidelberg , mathematics and visualization .",
    "305 - 323 .",
    "burgeth b , breu m , pizarro l , weickert j ( 2009 ) pde - driven adaptive morphology for matrix fields . in : ssvm .",
    "springer , volume 5567 of _ lecture notes in computer science _ ,",
    "247 - 258 .",
    "tuch ds ( 2004 ) q - ball imaging . magnetic resonance in medicine 52",
    ": 13581372 .",
    "descoteaux m , angelino e , fitzgibbons s , deriche r ( 2007 ) regularized , fast , and robust analytical q - ball imaging .",
    "magnetic resonance in medicine 58 : 497510 .",
    "descoteaux m , deriche r , knosche t , anwander a ( 2009 ) deterministic and probabilistic tractography based on complex fibre orientation distributions .",
    "medical imaging , ieee transactions on 28 : 269286 .",
    "barmpoutis a , vemuri bc , howland d , forder jr ( 2008 ) extracting tractosemas from a displacement probability field for tractography in dw - mri . in : miccai ( 1 ) .",
    "springer , volume 5241 of _ lecture notes in computer science _ ,",
    "pp . 9 - 16 .",
    "goh a , lenglet c , thompson pm , vidal r ( 2009 ) estimating orientation distribution functions with probability density constraints and spatial regularity . in : miccai",
    "springer , volume 5761 of _ lecture notes in computer science _",
    "877 - 885 .",
    "schultz t ( 2012 ) towards resolving fiber crossings with higher order tensor inpainting . in : new developments in the visualization and processing of tensor fields ,",
    ". 253265 .",
    "reisert m , kiselev vg ( 2011 ) fiber continuity : an anisotropic prior for odf estimation .",
    "ieee transactions on medical imaging 30 : 1274 - 1283 .",
    "tax c , duits r , vilanova a , ter haar  romeny b , hofman p , et  al . (",
    "2014 ) evaluating contextual processing in diffusion mri : application to optic radiation reconstruction for epilepsy surgery .",
    "franken e ( 2008 ) enhancement of crossing elongated structures in images .",
    "thesis , eindhoven university of technology , department of biomedical engineering , the netherlands .",
    "duits r , franken e ( 2011 ) left - invariant diffusions on the space of positions and orientations and their application to crossing - preserving smoothing of hardi images .",
    "international journal of computer vision 92 : 231 - 264 .",
    "creusen ej , duits r , dela  haije tcj ( 2011 ) numerical schemes for linear and non - linear enhancement of dw - mri . in : ssvm .",
    "springer , volume 6667 of _ lecture notes in computer science _ ,",
    "duits r , dela  haije tcj , creusen ej , ghosh a ( 2013 ) morphological and linear scale spaces for fiber enhancement in dw - mri .",
    "journal of mathematical imaging and vision 46 : 326 - 368 .",
    "franken e , duits r ( 2009 ) crossing - preserving coherence - enhancing diffusion on invertible orientation scores .",
    "international journal of computer vision 85 : 253278 .",
    "mumford d ( 1994 ) elastica and computer vision . in : algebraic geometry and its applications , springer new york .",
    "491 - 506 .",
    "zweck jw , williams lr ( 2000 ) euclidean group invariant computation of stochastic completion fields using shiftable - twistable functions . in : journal of mathematical imaging and vision .",
    ". 100116 .",
    "sanguinetti g , citti g , sarti a ( 2010 ) a model of natural image edge co - occurrence in the rototranslation group .",
    "journal of vision 10 .",
    "august j , zucker sw ( 2003 ) sketches with curvature : the curve indicator random field and markov processes .",
    "ieee transactions on pattern analysis and machine intelligence 25 : 387 - 400 .",
    "r , van almsick m ( 2008 ) the explicit solutions of linear left - invariant second order stochastic evolution equations on the 2d euclidean motion group . quarterly of applied mathematics 66 : 2767 .",
    "momayyezsiahkal p , siddiqi k ( 2013 ) 3d stochastic completion fields for mapping connectivity in diffusion mri .",
    "ieee transactions on pattern analysis and machine intelligence 35 : 983 - 995 .",
    "citti g , sarti a ( 2006 ) a cortical based model of perceptual completion in the roto - translation space .",
    "journal of mathematical imaging and vision 24 : 307 - 326 .",
    "duits r , franken e ( 2010 ) left - invariant parabolic evolutions on se(2 ) and contour enhancement via invertible orientation scores part i : linear left - invariant diffusion equations on se(2 ) .",
    "quarterly of applied mathematics 68 : 255292 .",
    "agrachev a , boscain u , gauthier jp , rossi f ( 2009 ) the intrinsic hypoelliptic laplacian and its heat kernel on unimodular lie groups . journal of functional analysis 256 : 2621 - 2655 . prkovska v , rodrigues p , duits r , haar  romenij bt , vilanova a ( 2010 ) extrapolating fiber crossings from dti data : can we infer similar fiber crossings as in hardi ? in : miccai .",
    "workshop on computational diffusion mri .",
    "prkovska v , andorr m , villoslada p , martinez - heras e , duits r , et  al .",
    "( 2015 ) contextual diffusion image post - processing aids clinical applications . in : visualization and processing of tensors and higher order descriptors for multi - valued data .",
    "reisert m , skibbe h ( 2012 ) left - invariant diffusion on the motion group in terms of the irreducible representations of so(3 ) .",
    "computing research repository abs/1202.5414 .",
    "reisert m , skibbe h ( 2013 ) fiber continuity based spherical deconvolution in spherical harmonic domain . in : mori k , sakuma i , sato y , barillot c , navab n , editors , miccai ( 3 ) .",
    "springer , volume 8151 of _ lecture notes in computer science _ ,",
    "493 - 500 .",
    "dela  haije t , duits r , tax c ( 2014 ) sharpening fibers in diffusion weighted mri via erosion . in : westin c , vilanova a , burgeth b , editors , visualization and processing of tensors and higher order descriptors for multi - valued data , mathematics and visualization .",
    "tournier jd , yeh ch , calamante f , cho kh , connelly a , et  al .",
    "( 2008 ) resolving crossing fibres using constrained spherical deconvolution : validation using diffusion - weighted imaging phantom data .",
    "neuroimage 42 : 617 - 625 .",
    "tax c , jeurissen b , vos s , viergever m , leemans a ( 2014 ) recursive calibration of the fiber response function for spherical deconvolution of diffusion mri data .",
    "neuroimage 86 : 6780 .",
    "schultz t , groeschel s ( 2013 ) auto - calibrating spherical deconvolution based on odf sparsity . in : miccai 2013 , springer .",
    ". 663670 .",
    "jeurissen b , tournier jd , dhollander t , connelly a , sijbers j ( 2014 ) multi - tissue constrained spherical deconvolution for improved analysis of multi - shell diffusion mri data .",
    "neuroimage 103 : 411 - 426 .",
    "roine t , jeurissen b , perrone d , aelterman j , leemans a , et  al .",
    "( 2014 ) isotropic non - white matter partial volume effects in constrained spherical deconvolution .",
    "frontiers in neuroinformatics 8 .",
    "roine t , jeurissen b , perrone d , aelterman j , philips w , et  al .",
    "( 2015 ) informed constrained spherical deconvolution ( icsd ) .",
    "medical image analysis : in press .",
    "calamante f , tournier jd , jackson gd , connelly a ( 2010 ) track - density imaging ( tdi ) : super - resolution white matter imaging using whole - brain track - density mapping .",
    "neuroimage 53 : 12331243 .",
    "dhollander t , emsell l , van  hecke w , maes f , sunaert s , et  al .",
    "( 2014 ) track orientation density imaging ( todi ) and track orientation distribution ( tod ) based tractography .",
    "neuroimage 94 : 312336 .",
    "ct ma , bor a , girard g , houde jc , descoteaux m ( 2012 ) tractometer : online evaluation system for tractography . in : medical image computing and computer - assisted intervention ",
    "miccai 2012 , springer .",
    ". 699706 .",
    "ct ma , girard g , bor a , garyfallidis e , houde jc , et  al .",
    "( 2013 ) tractometer : towards validation of tractography pipelines .",
    "medical image analysis 17 : 844 - 857 .",
    "daducci a , canales - rodrguez ej , descoteaux m , garyfallidis e , gur y , et  al .",
    "( 2014 ) quantitative comparison of reconstruction methods for intra - voxel fiber recovery from diffusion mri .",
    "ransactions on medical imaging 33 : 384399 .",
    "falconer ma , serafetinides ea ( 1963 ) a follow - up study of surgery in temporal lobe epilepsy .",
    "journal of neurology , neurosurgery , and psychiatry 26 : 154 .",
    "powell h , parker g , alexander d , symms m , boulby p , et  al .",
    "( 2005 ) mr tractography predicts visual field defects following temporal lobe resection .",
    "neurology 65 : 596599 .",
    "sherbondy aj , dougherty rf , ben - shachar m , napel s , wandell ba ( 2008 ) contrack : finding the most likely pathways between brain regions using diffusion tractography .",
    "journal of vision 8 : 15.116 .",
    "meesters s ( 2013 ) diffusion weighted tractography to reconstruct the optic radiation in support of temporal lobe epilepsy surgery .",
    "master s thesis , eindhoven university of technology .",
    "tournier jd , calamante f , gadian dg , connelly a ( 2004 ) direct estimation of the fiber orientation density function from diffusion - weighted mri data using spherical deconvolution .",
    "neuroimage 23 : 1176 - 1185 .",
    "tournier jd , calamante f , connelly a ( 2007 ) robust determination of the fibre orientation distribution in diffusion mri : non - negativity constrained super - resolved spherical deconvolution .",
    "neuroimage 35 : 1459 - 1472 .",
    "driscoll j , healy d ( 1994 ) computing fourier transforms and convolutions on the 2-sphere .",
    "advances in applied mathematics 15 : 202 - 250 .",
    "tournier jd , calamante f , connelly a ( 2013 ) determination of the appropriate b value and number of gradient directions for high - angular - resolution diffusion - weighted imaging .",
    "nmr in biomedicine .",
    "duits r , burgeth b ( 2007 ) scale spaces on lie groups . in : ssvm .",
    "springer , volume 4485 of _ lecture notes in computer science _ ,",
    "pp . 300 - 312 .",
    "creusen e , duits r , vilanova a , florack l ( 2013 ) numerical schemes for linear and non - linear enhancement of dw - mri .",
    "numerical mathematics : theory , methods and applications 6 : 326 - 368 .",
    "rodrigues p , duits r , ter haar  romeny bm , vilanova a ( 2010 ) accelerated diffusion operators for enhancing dw - mri . in : proc . of the 2nd eg conference on vcbm .",
    "eurographics association , pp .",
    "hrmander l ( 1967 ) hypoelliptic second order differential equations .",
    "acta mathematica 119 : 147 - 171 .",
    "daducci a , caruyer e , descoteaux m , thiran jp ( 2013 ) . reconstruction challenge .",
    "ieee international symposium on biomedical imaging .",
    "http://hardi.epfl.ch / statis / events/2013_isbi/. ( 2014 ) mathematica .",
    "wolfram research inc .",
    ", 10.0 edition .",
    "chamberland m , whittingstall k , fortin d , mathieu d , descoteaux m ( 2014 ) real - time multi - peak tractography for instantaneous connectivity display .",
    "frontiers in neuroinformatics 8 .",
    "caruyer e , daducci a , descoteaux m , houde jc , thiran jp , et  al .",
    "( 2014 ) phantomas : a flexible software library to simulate diffusion mr phantoms .",
    "international society for magnetic resonance in medicine .",
    "close tg , tournier jd , calamante f , johnston la , mareels i , et  al .",
    "( 2009 ) a software tool to generate simulated white matter structures for the assessment of fibre - tracking algorithms .",
    "neuroimage 47 : 1288 - 1300 .",
    "assaf y , basser pj ( 2005 ) composite hindered and restricted model of diffusion ( charmed ) mr imaging of the human brain .",
    "neuroimage 27 : 4858 .",
    "sderman o , jnsson b ( 1995 ) restricted diffusion in cylindrical geometry .",
    "journal of magnetic resonance , series a 117 : 94 - 97 .",
    "girard g , whittingstall k , deriche r , descoteaux m ( 2014 ) towards quantitative connectivity analysis : reducing tractography biases .",
    "neuroimage 98 : 266 - 278 .",
    "smith re , tournier jd , calamante f , connelly a ( 2013 ) sift : spherical - deconvolution informed filtering of tractograms .",
    "neuroimage 67 : 298312 .",
    "smith re , tournier jd , calamante f , connelly a ( 2012 ) anatomically - constrained tractography : improved diffusion mri streamlines tractography through effective use of anatomical information .",
    "neuroimage 62 : 19241938 .",
    "aganj i , lenglet c , jahanshad n , yacoub e , harel n , et  al .",
    "( 2011 ) a hough transform global probabilistic approach to multiple - subject diffusion mri tractography .",
    "medical image analysis 15 : 414425 .",
    "nilsson d , starck g , ljungberg m , ribbelin s , jnsson l , et  al .",
    "( 2007 ) intersubject variability in the anterior extent of the optic radiation assessed by tractography .",
    "epilepsy research 77 : 1116 .",
    "duits r , janssen m , hannink j , sanguinetti g ( 2015 ) locally adaptive frames in the roto - translation group and their applications in medical imaging ."
  ],
  "abstract_text": [
    "<S> we propose two strategies to improve the quality of tractography results computed from diffusion weighted magnetic resonance imaging ( dw - mri ) data . </S>",
    "<S> both methods are based on the same pde framework , defined in the coupled space of positions and orientations , associated with a stochastic process describing the enhancement of elongated structures while preserving crossing structures . in the first method we use the enhancement pde for contextual regularization of a fiber orientation distribution ( fod ) that is obtained on individual voxels from high angular resolution diffusion imaging ( hardi ) data via constrained spherical deconvolution ( csd ) . </S>",
    "<S> thereby we improve the fod as input for subsequent tractography . </S>",
    "<S> secondly , we introduce the fiber to bundle coherence ( fbc ) , a measure for quantification of fiber alignment . </S>",
    "<S> the fbc is computed from a tractography result using the same pde framework and provides a criterion for removing the spurious fibers . </S>",
    "<S> we validate the proposed combination of csd and enhancement on phantom data and on human data , acquired with different scanning protocols . on the phantom data we find that pde enhancements improve both local metrics and global metrics of tractography results , compared to csd without enhancements . on the human data we show that the enhancements allow for a better reconstruction of crossing fiber bundles and they reduce the variability of the tractography output with respect to the acquisition parameters . </S>",
    "<S> finally , we show that both the enhancement of the fods and the use of the fbc measure on the tractography improve the stability with respect to different stochastic realizations of probabilistic tractography . </S>",
    "<S> this is shown in a clinical application : the reconstruction of the optic radiation for epilepsy surgery planning . </S>"
  ]
}