{
  "article_text": [
    "the effect of a treatment on an outcome is often the main parameter of interest in many scientific fields .",
    "the standard approach used to estimate it is the so called average treatment effect ( ate ) , the difference between the expected values of the response s distributions under the two treatment regimes .",
    "while intuitive and useful in many situations , it suffers from some limitations ; in particular , it becomes highly biased when the response is skewed .",
    "a further drawback of the ate is its coarseness as a summary of the distance between the expected value of the response s distributions under the two treatments .",
    "it is a matter of fact indeed that the effect of the treatment on the outcome often varies as we move from the lower to the upper tail of the outcome s distribution .",
    "this limitation of the ate has been addressed in the literature by introducing the so called quantile treatment effect ( qte ) , the difference between the response s distribution quantiles under the two treatments @xcite . in this paper",
    "we propose a more general measure of the effect of a binary treatment on a continuous outcome .",
    "we call it the _ generalized quantile treatment effect _ ( gqte ) , defined as @xmath1 where @xmath2 and @xmath3 represent the quantile functions of the outcome under the two treatment conditions and @xmath4 is an arbitrary but known function of the quantiles . for example , if @xmath5 is chosen to be the identity function , then the gqte simplifies to the qte , while if @xmath4 is the integral over the percentile @xmath6 , the gqte becomes equivalent to the ate .",
    "the gqte is a new parameter which generalizes the existing approaches for estimating a treatment effect .    to estimate and formulate inferences about the gqte we propose a bayesian approach that can accommodate both symmetric and skewed outcomes , as well as situations where the sample size under a treatment condition ( cases ) is much smaller than the sample size under the other treatment condition ( controls ) . in particular , we assume @xmath7 where @xmath8 is a monotone function and @xmath9 is assumed to be smooth .",
    "in other words , we assume that the transformed quantile ratio is a smooth function of the percentile @xmath6 .",
    "the idea of smoothly modeling the ratio of the quantiles has been first introduced by @xcite , who exploited it by proposing a nonparametric estimator of the mean difference between two populations . here",
    "we generalize their approach by permitting the comparison of any characteristic of the outcome s distributions under the two treatments .",
    "an important theoretical contribution of this paper is the derivation of a closed form expression for the model likelihood .",
    "we show that it is possible to obtain an analytically tractable form for the @xmath10 density ( the controls ) without explicitly specifying a model for it .",
    "clearly the likelihood is needed to carry out the bayesian estimation but in principle it could be employed for classic likelihood procedures as well .",
    "moreover , our proposed approach allows one to borrow strength from one sample to the other , thus improving efficiency in the estimation of the quantiles @xcite .    as an illustration",
    ", we apply our method to the comparison of the single hospitalization medical costs distribution between subjects with and without smoking attributable diseases .",
    "the data set we use is the national medical expenditures survey ( nmes ) supplemented by the adult self - administered questionnaire household survey .",
    "the paper is organized as follows . in section [ gqte ]",
    "we define the new parameter @xmath11 and illustrate some quantile - based measures that will be used in the paper . in section",
    "[ estimation ] we provide details of the estimation approach together with some special cases .",
    "we then present the results of a simulation study in section [ simstudy ] through which we conclude that under a broad set of conditions our approach performs better than other flexible methods for comparing two distributions . in section [ data_analysis ]",
    "we illustrate the results of the data analysis on the nmes data set .",
    "section [ discussion ] concludes the paper with a discussion and some final remarks .",
    "consider two positive continuous random variables @xmath12 and @xmath13 with quantile functions @xmath14 and @xmath15 , where @xmath16 for @xmath17 and @xmath18 . to compare @xmath19 and @xmath20 as flexibly as possible",
    "we introduce the generalized quantile treatment effect , which is defined as @xmath21 where @xmath4 is a known function of the quantiles .",
    "notice that no a priori assumptions are made about the admissible functions @xmath5 , thus potentially any function of the quantiles can be used . therefore , the gqte provides a general approach to compare the response s distributions under the two treatments .",
    "more precisely , by properly choosing the function @xmath4 , we can recover any specific characteristic of the outcome s distributions @xmath22 and @xmath23 and , through , their difference .",
    "the simplest case arises when @xmath24 . in this case",
    "the gqte simplifies to @xmath25 the so called ( unconditional ) qte @xcite , sometimes also named the percentile - specific effect between two populations ( see for example * ? ? ?",
    "* ; * ? ? ?",
    "a second example is obtained by choosing @xmath26 , which produces @xmath27 the extensively used ate ( see for example * ? ? ?",
    "* chapter 21 ) .",
    "these examples illustrate how the gqte reduces to the two most used parameters of interest for estimating a treatment effect , the ate and qte .",
    "however , the gqte can provide a variety of other useful measures . in appendix 1",
    "we illustrate some other interesting cases that usually are not taken into consideration in the literature .",
    "in this section we illustrate the procedure we developed for estimating the gqte .",
    "our proposed approach is sufficiently general that it can be used for any choice of @xmath4 .",
    "we assume that @xmath28 , where @xmath22 is a given probability distribution depending upon a vector of unknown parameters @xmath29 .",
    "for example , in the application presented in section [ data_analysis ] we choose @xmath22 as a mixture distribution .",
    "to borrow information from one distribution to the other , we assume that the transformed quantile ratio is a smooth function of the percentiles with @xmath30 degrees of freedom , that is @xmath31 the function @xmath32 is assumed to be monotone differentiable . it represents a kind of link function and",
    "it is used to transform the quantile ratio to account for the potential skewness of the @xmath22 and @xmath23 .",
    "the typical choice for skewed data is @xmath33 , while for symmetric data distributions the identity function is the most reasonable option .    for the sake of simplicity",
    ", we henceforth indicate the smooth function @xmath34 with reference to the corresponding design matrix @xmath35 , so that it can be written as @xmath36 , where @xmath37 is a vector of unknown parameters .",
    "more explicitly , we assume that @xmath38 , where @xmath39 are orthonormal basis functions with @xmath40 .",
    "the number of degrees of freedom @xmath30 is a further parameter that has either to be chosen or estimated from the data . in subsection [ dfselection ]",
    "we propose a simple approach for eliciting it .",
    "the basis functions are usually either splines or polynomials .",
    "the main justification for assuming is that it allows one to borrow information from both the response s distributions under the two treatment conditions when we estimate the gqte @xmath41 .",
    "assumption , in fact , implies @xmath42\\,,\\ ] ] and also @xmath43\\right\\}^{-1}\\,,\\ ] ] which , once substituted in , return @xmath44 \\big ) - g\\big ( q_1(p ) \\left\\{h^{-1}\\left[x(p,\\lambda)\\ , { \\boldsymbol}{\\beta}\\right]\\right\\}^{-1 } \\big).\\ ] ] for the special case where @xmath24 and @xmath45 , @xcite have shown that under assumption it is possible to obtain a more efficient estimator of @xmath46 than the sample mean difference and the maximum likelihood estimator assuming that @xmath47 and @xmath10 are both log - normal .",
    "notice that , since the main interest in the paper resides in the estimation of @xmath48 , for which only @xmath37 is required , @xmath29 is treated as nuisance ( see subsection [ gqte_inference ] for further details ) .",
    "in this paper we propose a bayesian approach for estimating @xmath41 for any choice of @xmath4 and @xmath32 .",
    "an interesting feature of our estimation procedure for @xmath48 , is that we only need to specify the distribution function for @xmath47 .",
    "the specification of @xmath19 together with the relationship automatically determines a distributional assumption for @xmath13 .",
    "we refer to the distribution of @xmath10 induced by @xmath22 and assumption as @xmath49 . as a last remark for this section , we want to highlight the difference between the function @xmath4 , introduced in the previous section , and @xmath32 , defined above in .",
    "they should not be confused because they have distinct roles : the former identifies the response s characteristic we want to estimate for assessing the treatment effect , while the latter has been introduced as a mechanism to attenuate the possible skewness present in the data .",
    "the steps involved in our estimation approach are summarized as follows :    1 .",
    "choose a ( possibly flexible ) density @xmath50 for @xmath47 , a smoothing function @xmath34 ( usually a spline or a polynomial ) and a value for @xmath30 ; 2 .",
    "from derive the density function of @xmath10 , that we denote as @xmath51 .",
    "note that , as proved by theorem [ theorem1 ] below , this density will depend on the model parameter @xmath37 as well as on the parameter @xmath29 through the @xmath47 density .",
    "3 .   calculate the joint likelihood @xmath52 to use for finding the posterior distribution of @xmath53 in a markov chain monte carlo ( mcmc ) algorithm .",
    "4 .   obtain the posterior distribution of any special case of the gqte .    the critical step in this sequence",
    "is represented by the calculation of the likelihood , which we now describe .",
    "consider two i.i.d .",
    "samples @xmath54 and @xmath55 drawn independently from the two populations @xmath56 and @xmath49 .",
    "we refer to the former as the cases ( or the treated ) and to the latter as the controls ( or the untreated ) .",
    "we assume that these distribution functions have densities @xmath57 and @xmath58 respectively .",
    "the likelihood function for our model is then given by @xmath59    since we did nt state any specific distributional assumption for @xmath10 , in principle we could not calculate the likelihood because we do nt have any expression for @xmath60 .",
    "two strategies are possible here . given the @xmath61 specification , one possibility is to find an expression for @xmath62 , then map it through equation to find a corresponding expression for @xmath63 , invert it to determine @xmath23 , and finally differentiate the result to get @xmath60 .",
    "apart from simple situations , usually these steps ( i.e. integration , inversion and differentiation ) need to be performed numerically .",
    "a second possibility is to replace the @xmath10 density in the likelihood with its correspondent _ density quantile function _",
    ", @xmath64 ( see * ? ? ?",
    "* ) , for which the next theorem provides a closed form expression .",
    "the proof of the theorem and two additional corollaries are available in appendix 2 , while in the next subsection we provide some further explanation on how to compute @xmath60 .",
    "[ theorem1 ] let @xmath28 , with @xmath22 having density function @xmath65 , and assume that holds .",
    "if , for every @xmath17 , the vector @xmath66 satisfies the constraint @xmath67 \\right\\ } \\leq\\frac{1}{f_1\\left(q_1(p)|{\\boldsymbol}{\\eta}\\right)q_1(p)}\\,,\\ ] ] the density quantile function @xmath68 for @xmath10 is @xmath69|{\\boldsymbol}{\\eta } \\right ) h^{-1}\\left[x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right]}{1-f_1\\left ( q_2(p)\\,h^{-1}\\left[x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right]|{\\boldsymbol}{\\eta } \\right)\\,x'(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\,q_2(p)\\left\\{\\frac{d}{d\\left ( x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right)}h^{-1}\\left[x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right]\\right\\ } } \\,.\\ ] ] the function @xmath68 is a properly defined density .    note that @xmath70 correctly depends upon both the model parameter @xmath37 and the @xmath12 parameter @xmath29 through the @xmath71 density .",
    "the motivation for the constraint comes from the need to guarantee that @xmath60 is a non - negative function . as a further remark",
    ", we observe that the term in the likelihood involving @xmath72 depends upon the observations @xmath73 through the unknown quantile function values @xmath74 .",
    "a computational drawback of our proposal is that the `` true '' values of the percentiles @xmath75 , i.e. those generated under the assumed model for @xmath10 , should be used in the calculation of the likelihood .",
    "unfortunately , these are not available , because the cumulative distribution function @xmath23 is not given explicitly and we can not find the @xmath75 corresponding to the observed data @xmath73 as @xmath76 .",
    "the approach we recommend to bypass this issue is to approximate the @xmath75 using the procedure described in @xcite , which we summarize as follows :    1 .   denoting with @xmath77",
    "the ordered observed values for @xmath10 , we look for the corresponding set of ordered @xmath78 such that @xmath79 , where @xmath80 is an estimate of @xmath3 based on the current values of the parameters @xmath37 and @xmath29 ( i.e. the values from the current mcmc draw ) .",
    "more specifically , we find the @xmath78 using the following procedure : suppose @xmath81 is the current estimate of @xmath6 for a given @xmath82 value .",
    "then , for a value of @xmath6 close to @xmath81 , @xmath83 can be approximated using the following taylor series expansion @xmath84 which , solving for @xmath6 , gives @xmath85 where @xmath86 is the quantile density function corresponding to @xmath87 and where we used the fact that @xmath88 . as a starting point for @xmath78",
    "we use @xmath89 , @xmath90 .",
    "equation is used in an iterative fashion till the given value of @xmath83 differs from @xmath82 by less than some chosen small amount ( we use @xmath91 ) .",
    "once the values of @xmath75 are available , we compute the quantities @xmath92 using equation .",
    "the critical issue in this step is the calculation of the derivative @xmath93 . in the cases we consider here ( i.e. either a polynomial or a spline basis ) , the derivative is available in closed form and",
    "so no further numerical approximation is needed .",
    "strictly speaking , the calculation of @xmath60 provided by the procedure we just described is not exact but involves a numerical approximation .",
    "we performed a detailed analysis on the goodness of this approximation and we found that the actual and approximated @xmath60 values ( and hence the overall likelihood ) were indistinguishable .",
    "we present now some special cases where an appropriate choice of the design matrix @xmath35 allows to recover an exact expression for @xmath68 belonging to a known distribution family .",
    "the proofs of these special cases are provided in appendix 3 .",
    "_ case 1 : @xmath12 is uniform and @xmath94 . _ in this case we assume that @xmath95 $ ] and choose @xmath96 .",
    "then @xmath97 and from it follows that @xmath98}\\{q_2(p)\\}\\,,\\ ] ] which corresponds to the density quantile function of a uniform random variable with parameter @xmath99 , where @xmath100 denotes the indicator function taking value @xmath101 if @xmath102 and @xmath103 otherwise .",
    "note that it correctly depends both upon the parameter @xmath104 and the @xmath12 parameter @xmath105 .",
    "_ case 2 : @xmath12 is log - normal and @xmath106 $ ] .",
    "_ we now assume @xmath107 and fix @xmath45 .",
    "it follows that @xmath108 , where @xmath109 is the quantile function of a standard normal random variable .",
    "then by we get @xmath110 ^ 2}{2(\\sigma_1-\\beta _ 1)^2}\\right\\}\\,,\\ ] ] which is the density quantile function of a @xmath111 random variable with @xmath112 and @xmath113 .",
    "note that the density quantile function of @xmath13 correctly depends both upon the parameters @xmath114 and the @xmath12 parameters @xmath115 . in this case",
    "the constraint simply requires that @xmath116 , for every @xmath117 .",
    "_ case 3 : @xmath12 is pareto and @xmath118 $ ] . _",
    "suppose @xmath119 and choose @xmath120 .",
    "in this case @xmath121 and by we get @xmath122 which represents the density quantile function of a @xmath123 random variable with @xmath124 and @xmath125 .",
    "the density quantile function of @xmath13 correctly depends both upon the parameters @xmath126 and the @xmath12 parameters @xmath127 . in this case",
    "the constraint requires that @xmath128 , for every @xmath117 .      the parameters @xmath37 and @xmath29 are assumed to be a priori independent , that is @xmath129 where @xmath130 and @xmath131 are the prior hyperparameters for @xmath37 and @xmath29 respectively .",
    "for @xmath132 we use a a multivariate normal distribution with mean equal to the ordinary least squares ( ols ) estimate of @xmath37 based on the model @xmath133 where @xmath134 , @xmath135 and variance - covariance matrix equal to @xmath136 , where @xmath137 is normally fixed at a high value to induce a weakly informative prior distribution for each @xmath138 and @xmath139 indicates the identity matrix with size @xmath140 . for the prior distribution for @xmath29 , the choice clearly depends upon the assumption made about @xmath22 , but we suggest to use conjugate priors . for an example see the application in section [ data_analysis ] .",
    "the posterior distributions of @xmath37 and @xmath29 are obtained by an mcmc simulation . in particular",
    ", we use an independent metropolis - hastings algorithm with blocking over @xmath37 and @xmath29 separately ( see * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . as the proposal distribution for @xmath37",
    "we use a @xmath140-dimensional @xmath141 distribution with mean and scale matrix chosen to match the @xmath142 ols estimate and variance from , and a small number of degrees of freedom , usually set to @xmath143 . as with the prior , the proposal distribution for @xmath29 depends upon the particular application under investigation ( see section [ data_analysis ] for an example ) .      once",
    "the @xmath142 parameters have been estimated and the convergence of the simulated chains has been assessed by conventional methods ( see * ? ? ? * , or ; * ? ? ?",
    "* ) , we can obtain the posterior distribution of the gqte for any choice of @xmath4 as we now describe .    for each iteration @xmath144 of the mcmc simulation ,",
    "a value @xmath145 for @xmath37 is available . using expressions and",
    "we can obtain @xmath146 and @xmath147 as @xmath148 \\",
    ", , \\qquad i=1,\\ldots , n_{2},\\ ] ] and @xmath149 \\right\\ } ^{-1 } \\ , , \\qquad i=1,\\ldots , n_{1},\\ ] ] where the @xmath150 are the order statistics for sample @xmath151 , while @xmath152 , @xmath153 , for @xmath154 .",
    "it then follows that the @xmath144-th iteration value for @xmath11 is given by @xmath155 where @xmath156 and @xmath147 are found by interpolating the estimated quantile functions @xmath157 and @xmath158 .",
    "the estimate of @xmath41 is finally obtained through the rao - blackwellized estimator @xmath159 where @xmath160 is the total number of iterations .",
    "since the whole posterior distribution of @xmath11 is available , standard inferential questions can be easily addressed in the usual ways .",
    "as detailed in section [ gqte ] , many interesting special cases arise from the general definition of the gqte .",
    "for example , if interest lies in estimating the qte defined in , @xmath4 corresponds to the identity function and expression becomes @xmath161 which can be evaluated for any value of @xmath162 .",
    "if the focus is on the ate , defined in , then returns the estimator @xmath163 } \\\\ - \\frac{1}{n_1}\\sum^{n_1}_{i=1}{y_{1(i ) } \\left\\ { h^{-1}\\left [ x\\left(p_{1i},\\lambda\\right)\\widehat{{\\boldsymbol}{\\beta}}^{(m ) } \\right ] \\right\\}^{-1 } } \\,.\\end{gathered}\\ ] ]    appendix 4 contains the details for some other cases . as a final remark , note that an appealing feature of this approach is that the mcmc procedure needs to be run only once to compute the difference between any measure of the treatment effect of interest in the two groups .",
    "the choice of the number of degrees of freedom @xmath30 to use in the procedure above is not trivial .",
    "many approaches can be proposed , but to keep the computational burden manageable , we propose to elicit it by minimizing an empirical version of the @xmath165 discrepancy measure @xcite @xmath166 where @xmath167 denotes the unknown true @xmath10 density .",
    "more precisely , we select @xmath30 using the following procedure : for each @xmath168 , where @xmath169 is the maximum admissible value for @xmath30 , we estimate @xmath170 , where @xmath171 is equal to the ols estimate given in and @xmath172 is estimated by using only the data @xmath173 . after replacing the true unknown density @xmath167 with a kernel density estimate of the data @xmath174 , the value of @xmath30 is chosen as that minimizing the value of over the set @xmath175 .",
    "one drawback of this approach is that it tends to select high values of @xmath30 .",
    "we provide further discussion about this issue in section [ discussion ] .",
    "in this section we report the results of a simulation study we performed to compare the finite sample properties of our method with those of other flexible approaches.the simulation indicates that often the gqte procedure has lower mean squared error and a similar bias as other flexible methods for comparing two distributions . in particular , we contrast our proposal with the smooth quantile ratio estimation ( square ) approach presented in @xcite , and the probit stick - breaking process ( psbp ) proposed in @xcite .",
    "the former is a frequentist semiparametric method while the latter is a bayesian nonparametric model .",
    "we now provide some details about these two methodologies and a justification for using them .",
    "in square it is assumed that the log quantile ratio is a smooth function of the percentile @xmath6 with @xmath30 degrees of freedom , that is @xmath176 the basic idea of smooth quantile ratio estimation is to replace the empirical quantiles with smoother versions obtained by smoothing the log - transformed ratio of the two quantile functions across percentiles .",
    "square has been proposed by @xcite as an estimator of the mean difference between two populations with the advantage of providing substantially lower mean squared error and bias than the sample mean difference or the maximum likelihood estimator for log - normal populations . to estimate @xmath177 a @xmath178-fold cross - validation approach is suggested .",
    "finite sample inference is performed by bootstrap but they also provide large sample results .    the psbp is a general nonparametric bayesian model which has been proposed by @xcite for estimating the conditional distribution of a response variable given multiple predictors .",
    "more specifically , the psbp is a prior for an uncountable collection of random distributions . like for the models belonging to the class of dependent dirichlet processes @xcite ,",
    "the psbp main idea is to allow for dependence across a family of related distributions as a function of some covariates .",
    "more explicitly , the psbp induce dependence in the weights of the stick - breaking representation @xcite by replacing the beta - distributed random variables with a probit model .",
    "this simple change greatly enhances the flexibility of the model , thus providing an extremely interesting extension within the framework of dependent priors across families of probabilities measures .",
    "we decided to compare the gqte with these two methods because they are both highly flexible and have been proved to perform well under a broad set of situations .",
    "originally the simulation also included the anova dependent dirichlet process mixtures proposed by @xcite , but we decided not to report it here because it performed poorly as compared to the psbp model .",
    "the reason for such inferior results resides in the definition of the model itself , which assumes the weights in the stick - breaking representation of the process to be fixed , i.e. the same for the response distributions under the two treatment conditions .",
    "since square produces an estimate only for the mean difference between two populations , our simulation is restricted to this specific case .",
    "we are aware that the results only provide a partial demonstration of the gqte advantages over the other methods , but we also need to stress that the ate is the most common measure used in practice for estimating the extent of a treatment effect .",
    "our simulation framework is similar to that used in @xcite and includes five scenarios , which are described in table [ tabsim1 ] under the labels a to e. in scenarios a , b and c the @xmath10 distribution is assumed to be log - normal with parameters @xmath179 and @xmath180 which approximately correspond to the sample statistics for the medical expenditures of non - diseased subjects from the nmes data set . in scenario a , the @xmath47 distribution is also log - normal but with larger values of the parameters , namely @xmath181 and @xmath182 .",
    "scenarios b and c use a different assumption for the @xmath47 distribution chosen to represent some reasonable shapes .",
    "the next two scenarios , d and e , compare the performances of the different methods using real data . in particular , in scenario d the data are randomly drawn from the distributions of nonzero medicare expenditures for cases and controls from the nmes data set .",
    "finally , scenario e assumes that both populations follow a gamma distribution with finite second moment .",
    ".simulation study ",
    "sampling mechanisms under each simulation scenario . in scenario",
    "d , @xmath183 are the empirical cumulative distribution functions of the nonzero medical expenditures for patients in the case and control groups from the nmes data set , and , in scenarios b and c , @xmath184 . moreover , in scenario b , @xmath185 , while in scenario c , @xmath186 . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     [ table_summary ]    figures [ data_summary](b ) and ( d ) show the histograms and boxplots for the cubic root transformed data .",
    "the need for such a transformation derives from the particular choice we make regarding the cases distribution ( see next subsection ) and is not a general requirement of our approach .",
    "moreover , the use of this transformation does not alter in any way the results and the conclusions we draw , hence in the following we systematically refer to the transformed data . at any rate ,",
    "note also that , even after the transformation , the outcome distributions still present heavy right tails .",
    "this conclusion motivates the use of @xmath45 .    in figure [ square_qqplot_cubic](a )",
    "we report the q - q plot for the ( cubic root transformed ) nmes data .",
    "we can identify a non - linear smooth relationship between the cases and controls medical expenditures .",
    "panel ( b ) of the same picture , which shows the quantile ratio as a function of the percentile @xmath6 , confirms these findings .          in this application",
    "we assume that @xmath187 , a particular mixture of gamma distributions with density @xmath188 where the mixing occurs over the shape parameters and where @xmath189 , the number of components , is fixed a priori .",
    "first introduced in @xcite , it has been explicitly developed as a model for right - skewed distributions and its parameterization allows to create a convenient and flexible method characterized by a single scale parameter for all the gamma components , plus the ordinary set of mixture weights .",
    "we use conjugate priors @xmath190 and @xmath191 for the shared scale parameter and the mixture weights respectively .",
    "the number of mixture components is fixed at @xmath192 , while the @xmath193 hyperparameters are set to @xmath194 and @xmath195 ( for more information on the elicitation of these priors see * ? ? ?",
    "* section  2.3 ) .",
    "the initial values of the metropolis - hastings algorithm are chosen as follows : the @xmath37 chain is started from its ols estimate , as discussed in , while for @xmath196 we first get a preliminary estimate ( with @xmath197 iterations ) using the approach described in @xcite , and then we fix their starting values to the corresponding estimated posterior averages .",
    "we run the mcmc algorithm for @xmath198 iterations plus @xmath199 iterations as burn - in .",
    "such a large number of iterations is necessary because the model , being quite complicated , has shown a slow convergence behavior of the chains .",
    "the selection procedure described in subsection [ dfselection ] for the number of degrees of freedom suggested a value of @xmath30 equal to @xmath200 , which can be considered fairly satisfactory from a visual inspection of the scatterplot ( see figure [ square_qqplot_cubic](b ) ) .",
    "the acceptance rates for the mcmc posterior simulations are relatively small , being around @xmath201 for @xmath37 , @xmath202 for @xmath193 and @xmath203 for @xmath204 . despite that",
    ", we do not consider these results as problematic since the chain is moving in a high - dimensional space ( @xmath205 dimensions ) , which necessarily slows down the convergence process .",
    "this is the main reason why we decide to run the simulation for a longer time .",
    "however , the results of the analysis presented below indicate that convergence was attained .",
    "we made other attempts with simpler ( but less flexible ) specifications of the @xmath12 distribution , which showed a more conventional behavior of the acceptance rates.=1    figure [ bsq_fit ] shows the fitted values for the estimated model .",
    "the gray dots represent the quantile ratio for the transformed data as a function of the percentile @xmath6 .",
    "the solid line illustrates the estimated posterior mean of the quantile ratio , while the dashed one represents its ols estimate ( the same line as in figure [ square_qqplot_cubic](b ) ) .",
    "the shaded area gives the credible bands for the estimated posterior means , showing a fairly low amount of uncertainty around the estimates .",
    "moreover , from the picture we can see that our model is less sensitive to extreme observations , especially in the right tails of the distributions.=1     credible intervals .",
    "the dashed line corresponds to the ols fit for the same data , as described in . ]    in figure [ est_f2 ] we report the estimated @xmath13 density .",
    "it is possible to ascertain a quite good fit . in the display , together with the @xmath206 posterior mean , we put the corresponding @xmath207 credible bands and the histogram of the data",
    ".     density .",
    "the solid line represents the estimated pointwise posterior means , while the shaded area shows the corresponding @xmath207 credible intervals .",
    "the thinner dark gray line depicts the data histogram . ]    . the solid line reports the estimated pointwise posterior means , the shaded area gives the corresponding @xmath207 credible intervals , while the dashed line shows the sample quantile differences .",
    "data are cubic - root transformed . ]",
    "we now describe the results for the gqte @xmath11 introduced in section [ estimation ] for some choices of the function @xmath4 .",
    "we start from the qte , denoted as @xmath208 in , whose estimate is shown in figure [ delta_id ] .",
    "the solid line represents the posterior mean of the medical costs qte between cases and controls and the gray area is the corresponding @xmath207 credible interval , while the dashed line portrays the sample quantile differences .",
    "we can see that the distribution of the medical expenditures for subjects with smoking attributable diseases is always above that of those without smoking - related diseases . however , a much larger variability results in estimating the difference for the very extreme quantiles . this behavior is not too surprising since the two samples become very sparse as the medical expenditures become bigger ( see the boxplots in figure  [ data_summary ] )",
    ".    figures [ delta_mu](a ) and ( b ) contain the posterior distributions of the ate and the standard deviation difference , as defined in section [ gqte ] .",
    "the sample mean and standard deviation differences are depicted in the two plots with a vertical dotted line , while the @xmath207 credible intervals are indicated using dashed lines .",
    "the ate estimated posterior mean ( on the log scale ) is equal to @xmath209 , while the estimated posterior mean of the standard deviation difference is @xmath210 .",
    "these results prove that having a smoking attributable disease has a significant negative impact on both the location and scale of the single hospitalization medical cost distribution .",
    "after re - transforming the estimated quantiles on the original scale , we get an estimated posterior mean for the ate between diseased and non - diseased subjects equal to @xmath211 .     credible interval , while the dotted line is the sample mean difference .",
    "( b ) estimated posterior distribution of the standard deviation difference between cases and controls medical expenditures ( cubic root transformed ) , as defined in section [ gqte ] .",
    "the vertical dashed lines represent the @xmath207 credible interval , while the dotted line depicts the sample standard deviation difference . ]    finally , figure [ delta_tw ] shows the impact of the treatment variable ( i.e. , having or not a smoking attributable disease ) on the tailweight functions @xmath212 , defined in , of the two populations .",
    "the tails of the medical costs distribution for the diseased subjects tend to be heavier than those of the non - diseased ones for values of @xmath6 up to approximately @xmath213 , but the situation is inverted as we move to consider higher percentiles . hence , while the fact of being affected by smoking attributable diseases tends to increase both the average and the variance of the medical expenditures distribution , we have found that the opposite occurs to the tail probabilities , that is , to the chances of incurring very high medical costs in a single hospitalization .    as a last comment , we would like to remark on the explicit choice we made to exclude the observations with null medical costs .",
    "we took this decision because the inclusion of this further feature of the data requires the extension of our approach to a two - part modeling framework @xcite , which does nt appear to be straightforward in our context .     between cases and controls , as defined in .",
    "the solid line represents the estimated pointwise posterior means , while the shaded area shows the corresponding @xmath207 credible intervals . ]",
    "in this paper we have introduced a new parameter , the gqte , for assessing the effect of a binary covariate on a response and a novel methodology to estimate it .",
    "the gqte generalizes the most common approaches available in the literature , that is , the well - known average treatment effect ( ate ) and the quantile treatment effect ( qte ) , since it allows to evaluate the effect of a treatment on any arbitrary characteristic of the outcome s distributions under the two treatment conditions .    to estimate the gqte we have proposed a bayesian procedure , where we assume that a monotone transformation of the quantile ratio is modeled as a smooth function of the percentiles",
    "this assumption allows to increase efficiency by borrowing information across the two groups .",
    "the idea of quantile ratio smoothing has first been introduced by @xcite . in the present work we extended that proposal in several ways : 1 ) we let the link between the quantile ratio and the percentiles be general and application - specific , allowing to take into account the tail heaviness of the distributions involved in the analysis ; 2 ) we derive a closed form expression for the model likelihood ; 3 ) our methodology is not limited to the mean difference between the treated and the controls , but provides a comprehensive assessment of the treatment effect ; 4 ) finally , we embed the whole estimation process within a bayesian framework allowing to make inference on the gqte @xmath48 for any choice of the function @xmath4 , and for both symmetric and highly skewed outcomes .    the gqte is a marginal measure in the sense that it provides an estimate of the treatment effect over an entire population . in the econometrics literature",
    "this kind of approach is usually termed the _ unconditional _",
    "qte @xcite in contrast with the _ conditional _ qte , where the treatment effect is determined separately for different combinations of a set of covariates @xcite .",
    "the inclusion of covariates can improve the efficiency of an estimator even when the primary goal of the analysis is a marginal effect .",
    "accordingly , methods have been proposed to extract marginal quantiles from estimates of conditional quantiles @xcite .",
    "a challenge in extending our approach along these lines is the lack of an `` iterated expectation '' result does imply @xmath214 , the same conclusion does nt hold for the conditional quantiles . ] for the quantiles ( see for example * ? ? ?",
    "* chapter 7 ) .    to further clarify our goals , we want to stress that in this paper no particular emphasis has been placed on the causality issues that naturally comes into play when the objective is the estimation of a treatment effect ( see for example * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "more precisely , our intent here is solely to provide a general measure of the effect of a binary treatment on a response variable , together with a flexible approach to estimate it .",
    "we compared the performance of our estimation approach with other highly flexible methods in a simulation study for the mean difference between two populations .",
    "our study revealed that the gqte performs generally better than the other competing estimators at least in estimating the mean difference .",
    "we have applied our methodology to the nmes data set to assess the effect of being affected by smoking attributable diseases on the single hospitalization medical costs distribution .",
    "we have found that having these diseases increases the average medical bill amount as well as its variability in the population , while it reduces the probability of incurring higher bills .",
    "our approach can be extended in various directions .",
    "the most promising research question we can see involves taking into account individual level characteristics in measuring the effect of a treatment . in our context",
    ", this would involve the estimation of a conditional version of @xmath48 , something like @xmath215 . the clear advantage of including covariates would be an increase in the efficiency of the estimates @xcite . to control for systematic differences in covariates between two populations ,",
    "a common strategy is to group units into subclasses based on covariate values , for example using propensity score matching , and then to apply our method within strata of propensity scores @xcite , as implemented for example in @xcite .",
    "currently we are considering only a binary treatment effect , so another important line of research is the extension of the methods to categorical ordinal and to continuous treatments .    a further direction for future research concerns the choice of the number of degrees of freedom @xmath30 .",
    "in this paper we adopted the simple approach of choosing @xmath30 by minimizing an empirical version of the @xmath216 distance between the @xmath10 density estimate and its kernel density estimate ( see subsection [ dfselection ] ) .",
    "more structured solutions can obviously be considered .",
    "a natural extension would allow @xmath30 to be a random quantity to be estimated together with all the other parameters using a trans - dimensional mcmc approach , like for example the reversible jump algorithm @xcite .",
    "while this solution would allow to take into account also the uncertainty connected to the a priori ignorance about the @xmath30 value , the consequence would be a dramatic increase in the computational workload of the estimation algorithm .",
    "the research of dominici was supported by award number r01es012054 ( statistical methods for population health research on chemical mixtures ) from nih / niehs , award numbers r83622 ( statistical models for estimating the health impact of air quality regulations ) and rd83241701 ( estimation of the risks to human health of pm and pm components ) from epa , award number 4909-rfa11 - 1/12 - 3 ( causal inference methods for estimating long term health effects of air quality regulations ) from hei and award number k18 hs021991 ( a translational framework for methodological rigor to improve patient centered outcomes in end of life cancer research ) from ahrq .",
    "the content is solely the responsibility of the authors and does not necessarily represent the official views of the above institutions .",
    "together with the cases presented in section [ gqte ] , many other less conventional measures of the difference between two distributions can be obtained by properly choosing the @xmath4 function in the gqte definition .",
    "for example , by choosing @xmath217 we obtain the difference between the population @xmath218-th moments @xmath219 using the fact that for a random variable @xmath220 with expected value @xmath221 , variance @xmath222 and quantile function @xmath223 it holds that ( see @xcite or @xcite ) @xmath224 ^ 2}\\,dp=\\int_0 ^ 1 { q(p)^{2 } } \\,dp - \\mu^{2 } , \\ ] ] by suitably choosing the @xmath4 function , we recover the difference between the two population variances as @xmath225-\\left[\\int_0 ^ 1{q_2(p)^2}\\,dp-\\left ( \\int_0 ^ 1{q_2(p)}\\,dp\\right)^2\\right ] \\nonumber\\\\ & = & \\left[\\int_0 ^ 1{q_1(p)^2}\\,dp-\\int_0 ^ 1{q_2(p)^2}\\,dp\\right ] -\\left[\\left(\\int_0 ^ 1{q_1(p)}\\,dp\\right)^2-\\left(\\int _ 0 ^ 1{q_2(p)}\\,dp\\right)^2\\right ] \\nonumber\\\\ & = & \\delta_{\\mu^2}-\\left(\\mu_1 ^ 2-\\mu_2 ^ 2\\right),\\end{aligned}\\ ] ]    however , the cases encompassed by the gqte include many other quantile - based indexes that are less frequently used in the literature , like the inter-@xmath6-range @xmath226 , or the skewness - ratio @xmath227/[q(0.5)-q(p)]$ ] , @xmath17 , which provide robust measures of the scale and shape of a distribution ( for a list of these indexes see * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "a quantity of particular interest to economists is the difference between inter - decile ratios , defined as @xmath228 which is commonly used to measure the inequality in a population ( see * ? ? ?",
    "the previous quantity can be easily generalized as follows @xmath229 for any @xmath230 .",
    "notice that all these indexes are obtainable from the general definition by properly choosing the function @xmath4 .    as a last example",
    ", we consider a further gqte special case that is based on the so called _ tailweight function _ defined as @xmath231 which is used to quantify the probability allocated in the tails of a distribution .",
    "one can compute the difference between the tailweight functions for two populations by choosing the logarithmic derivative of the quantile function as the @xmath4 functional in , that is @xmath232.\\end{aligned}\\ ] ] if @xmath233 , we can conclude that the treatment is causing a thickening of the @xmath47 distribution tails as compared to those of @xmath10 if @xmath233 . finally , note",
    "that , thanks to the equivariance property of the quantiles , can be written also as @xmath234 \\nonumber\\\\ & = & \\frac{d}{dp } \\delta_{\\log}(p ) \\,,\\end{aligned}\\ ] ] where @xmath235 , @xmath18 , indicates the quantile of the log - transformed data and @xmath236 denotes the parameter calculated on the quantiles of the log - transformed data .",
    "[ proof_th1 ] differentiate with respect to @xmath6 to get @xmath237+x'(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\,q_2(p)\\left\\{\\frac{d}{d\\left ( x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right)}h^{-1}\\left[x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right]\\right\\},\\ ] ] where @xmath238 denotes the so called _ quantile density function _ for the population @xmath239 , while @xmath240 corresponds to the derivative of @xmath35 , @xmath17 ( properly resized because a constant is normally included in the design matrix @xmath35 ) .",
    "apply now to both @xmath241 and @xmath242 the following relationship between the quantile density and density quantile functions ( see for example * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) @xmath243 to get the expression @xmath244 \\\\",
    "+ x'(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\,q_2(p ) \\left\\{\\frac{d}{d\\left ( x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right)}h^{-1}\\left[x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right]\\right\\},\\end{gathered}\\ ] ] and hence @xmath245}{1-f_1\\left(q_1(p)|{\\boldsymbol}{\\eta}\\right)\\,x'(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\,q_2(p)\\left\\{\\frac{d}{d\\left(x(p,\\lambda)\\,{\\boldsymbol}{\\beta } \\right)}h^{-1}\\left[x(p,\\lambda)\\,{\\boldsymbol}{\\beta}\\right]\\right\\ } } \\,.\\ ] ] finally , substituting in place of @xmath2 proves the main statement .",
    "moreover , @xmath68 is a proper density function because :    * @xmath246 , for any @xmath17 ; since @xmath247 and @xmath248 > 0 $ ] because , as assumed in , it is the ratio of two positive quantile functions , this fact can be proved by showing that the denominator of is nonnegative which is ensured by the constraint . *",
    "@xmath249 , which is true because @xmath250 by construction .",
    "a couple of immediate consequences of theorem [ theorem1 ] regard two cases that occur frequently in practice .",
    "we provide the details about these situations in the next two corollaries .",
    "let the same assumptions of theorem [ theorem1 ] hold .",
    "suppose additionally that @xmath96 .",
    "if for every @xmath17 the vector @xmath66 satisfies the constraint @xmath251 then the density quantile function @xmath252 for @xmath10 is @xmath253    let the same assumptions of theorem [ theorem1 ] hold .",
    "suppose additionally that @xmath45 .",
    "if for every @xmath17 the vector @xmath37 satisfies the constraint @xmath254 then the density quantile function @xmath252 for @xmath10 is given by @xmath255    note that in these two situations , the general constraint reduces to a linear constraint on @xmath142 .",
    "_ case 1 : @xmath12 is uniform and @xmath94 .",
    "_ here @xmath256 $ ] and @xmath96 . in this case",
    "hence the density , distribution and quantile functions of @xmath12 are respectively @xmath257}\\{y_1\\ } \\\\",
    "f_1(y_1|\\theta_1 ) & = & \\frac{y_1}{\\theta_1 } \\\\",
    "q_1(p|\\theta_1 ) & = & \\theta_1 p\\ , , \\qquad\\qquad0<p<1\\,.\\end{aligned}\\ ] ] from it follows that @xmath258}\\{q_2(p)\\,\\beta_0\\ } \\ , \\beta_0 \\\\",
    "& = & \\frac{\\beta_0}{\\theta_1}\\,\\mathbb{i}_{\\left[0,\\,\\theta _ 1/\\beta_0\\right]}\\{q_2(p)\\}\\,,\\end{aligned}\\ ] ] which is the density quantile function of a @xmath259 $ ] random variable with @xmath99 .",
    "_ case 2 : @xmath12 is log - normal and @xmath106 $ ] . _",
    "assume @xmath260 and @xmath45 .",
    "in this case @xmath261 , where @xmath109 is the quantile function of a standard normal random variable . the density , distribution and quantile functions of @xmath12 are given by @xmath262 then by it follows @xmath263 ^ 2}{2}\\right\\ } } \\ , \\exp\\left\\{\\,\\mu_1+\\sigma_1\\phi ^{-1}(p)\\right\\ } \\right ] } \\\\ & = & \\frac{1}{\\sqrt{2\\pi}(\\sigma_1-\\beta_1)}\\frac{\\exp\\left\\ { -\\frac{\\left [ \\phi^{-1}(p ) \\right]^2}{2}\\right\\}}{\\exp\\left\\{\\ , ( \\mu_1-\\beta_0)+(\\sigma_1-\\beta_1)\\phi^{-1}(p)\\right\\ } } \\\\ & = & \\frac{1}{\\sqrt{2\\pi}(\\sigma_1-\\beta_1)}\\,\\frac{\\exp\\left\\ { -\\frac{\\left [ ( \\mu_1-\\beta_0)+(\\sigma_1-\\beta_1)\\phi ^{-1}(p)-(\\mu_1-\\beta_0 ) \\right]^2}{2(\\sigma_1-\\beta_1)^2}\\right\\ } } { \\exp\\left\\{\\,(\\mu_1-\\beta_0)+(\\sigma_1-\\beta_1)\\phi ^{-1}(p)\\right\\ } } \\\\ & = & \\frac{1}{q_2(p)\\sqrt{2\\pi}(\\sigma_1-\\beta_1)}\\,\\exp\\left\\ { -\\frac{\\left [ \\log q_2(p ) -(\\mu_1-\\beta_0 ) \\right]^2}{2(\\sigma _ 1-\\beta_1)^2}\\right\\}\\,,\\end{aligned}\\ ] ] which is the density quantile function of a @xmath111 random variable with @xmath112 and @xmath113 .",
    "_ case 3 : @xmath12 is pareto and @xmath118 $ ] .",
    "_ now @xmath119 and @xmath45 . in this case @xmath121",
    ". the density , distribution and quantile functions of @xmath12 are given by @xmath264 then implies @xmath265^{-(a_{1}+1)}}{\\exp\\left\\{-\\beta_{0}-\\beta_{1}\\log(1-p)\\right\\ } \\left\\{1+a_{1}b_{1}^{a_{1}}\\left[b_{1}(1-p)^{-\\frac{1}{a_{1}}}\\right ] ^{-(a_{1}+1)}\\frac{\\beta_{1}}{1-p}b_{1}(1-p)^{-\\frac { 1}{a_{1}}}\\right\\ } } \\\\ & = & \\frac{a_{1}}{a_{1}\\beta_{1}+1}\\left(b_{1 } e^{-\\beta_{0}}\\right ) ^{-1 } ( 1-p)^ { \\frac{a_{1}\\beta_{1}+1}{a_{1}}+1 } \\\\ & = & \\frac{a_{1}}{a_{1}\\beta_{1}+1}\\left(b_{1 } e^{-\\beta_{0}}\\right ) ^{\\frac{a_{1}}{a_{1}\\beta_{1}+1 } } q_2(p)^{-\\left(\\frac { a_{1}}{a_{1}\\beta_{1}+1}+1\\right ) } \\,,\\end{aligned}\\ ] ] which is the density quantile function of a @xmath266 random variable with @xmath124 and @xmath267 .",
    "one can estimate the impact of a binary treatment on the @xmath218-th moments , denoted as @xmath268 in , by computing @xmath269 \\right\\}^r } \\\\ - \\frac{1}{n_1}\\sum^{n_1}_{i=1}{\\left [ y_{1(i ) } \\left\\ { h^{-1}\\left [ x\\left(p_{1i},\\lambda\\right)\\widehat{{\\boldsymbol}{\\beta}}^{(m ) } \\right ] \\right\\}^{-1 } \\right]^r } \\,.\\end{gathered}\\ ] ] the last expression allows to estimate the treatment effect on the population variances , defined in , which is given by @xmath270 } \\right)^2 \\right .",
    ". - \\left ( \\frac{1}{n_1}\\sum^{n_1}_{i=1}{y_{1(i ) } \\left\\ { h^{-1}\\left [ x\\left(p_{1i},\\lambda\\right)\\widehat{{\\boldsymbol}{\\beta } } ^{(m ) } \\right ] \\right\\}^{-1 } } \\right)^2 \\right\\ } \\,.\\end{gathered}\\ ] ] as a concluding example , the effect of a binary treatment on the tailweight functions of two distributions , introduced in , can be obtained by first computing the posterior draws @xmath271 \\right ) \\right\\ } , \\ ] ] and then by applying . when @xmath45 , becomes @xmath272 and the estimate of @xmath273 is @xmath274 with @xmath275 , the posterior mean estimate of @xmath37 .",
    "dominici , f. , zeger , s.  l. , parmigiani , g. , katz , j. , and christian , p. ( 2006 ) .",
    "`` estimating percentile - specific treatment effects in counterfactual models : a case - study of micronutrient supplementation , birth weight and infant mortality . ''",
    "_ journal of the royal statistical society : series c ( applied statistics ) _ , 55 : 261280 ."
  ],
  "abstract_text": [
    "<S> we propose a new general approach for estimating the effect of a binary treatment on a continuous and potentially highly skewed response variable , the _ generalized quantile treatment effect _ ( gqte ) . </S>",
    "<S> the gqte is defined as the difference between a function of the quantiles under the two treatment conditions . as such </S>",
    "<S> , it represents a generalization over the standard approaches typically used for estimating a treatment effect ( i.e. , the average treatment effect and the quantile treatment effect ) because it allows the comparison of any arbitrary characteristic of the outcome s distribution under the two treatments . following @xcite </S>",
    "<S> , we assume that a pre - specified transformation of the two quantiles is modeled as a smooth function of the percentiles . </S>",
    "<S> this assumption allows us to link the two quantile functions and thus to borrow information from one distribution to the other . </S>",
    "<S> the main theoretical contribution we provide is the analytical derivation of a closed form expression for the likelihood of the model . exploiting this result we propose a novel bayesian inferential methodology for the gqte . </S>",
    "<S> we show some finite sample properties of our approach through a simulation study which confirms that in some cases it performs better than other nonparametric methods . as an illustration </S>",
    "<S> we finally apply our methodology to the @xmath0 national medicare expenditure survey data to estimate the difference in the single hospitalization medical cost distributions between cases ( i.e. , subjects affected by smoking attributable diseases ) and controls .    </S>",
    "<S> ./style / arxiv - ba.cfg    ,    , </S>"
  ]
}