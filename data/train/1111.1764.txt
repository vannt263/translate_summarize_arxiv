{
  "article_text": [
    "kelvin - helmholtz instability ( khi ) is the name given to the primary instability that occurs when velocity shear is present within a continuous fluid or across fluid boundaries .",
    "the shear is converted into vorticity that , subject to secondary instabilities , cascades generating turbulence .",
    "the khi is one of the most important hydrodynamical instabilities and plays a significant role in various parts of astrophysics .",
    "it is believed to be responsible for additional mixing in differentially rotating stellar interiors @xcite , and to keep a finite - thickness layer of dust around the midplane of protoplanetary disks @xcite .",
    "it also contributes to convective mixing in any deep stellar interior at the stiff convective boundaries , for instance in asymptotic giant stars @xcite or novae @xcite .",
    "moreover , khi can lead to the destruction of cool gravitationally bound objects moving in a hot ambient medium @xcite such as galaxies in the intracluster medium @xcite , substellar companions engulfed by a giant star @xcite and comets entering a planetary atmosphere @xcite .",
    "khi plays a role in the interactions of the magnetopause and solar wind @xcite and has been observed in the solar corona @xcite . in order to understand these phenomena and their implications , it is therefore important to define a well - posed method to quantify how accurately khi can be modeled by different numerical techniques .",
    "verifying the correct treatment of khi has attracted increased interest following the conclusions made by @xcite including vigorous discussions of khi in lagrangian schemes .",
    "the main conclusion reached was that smoothed particle hydrodynamics ( sph ) fails to resolve khi due to a surface tension effect between the sph particles at the shear interface .",
    "however , the test was done at a sharp shear and contact discontinuity .",
    "@xcite attempted to address the problem with khi growth from a sharp contact discontinuity in @xcite by adding an artificial thermal conductivity to sph .",
    "a prescription achieving a similar end by adding a diffusion motivated by a subgrid turbulence model to sph was proposed by @xcite . in a case where traditional sph largely fails to reproduce khi at a sharp interface , @xcite demonstrated that using a godunov - sph formulation with zeroth and first order consistency that growth of khi can be obtained . using a voronoi - mesh based scheme @xcite showed improvement over sph in a sharp contact discontinuity khi test , but compared the compressible solution to the growth rate for an incompressible flow and did not perform a convergence study . with the arepo voronoi - mesh godunov code",
    "@xcite ran a sharp contact discontinuity khi test and pointed out the difference seen in the secondary instabilities developed when the mesh was given a motion following the flow ( a quasi - lagrangian motion ) or kept fixed . in @xcite the same code",
    "is used for a extended discussion , with both a sharp contact discontinuity khi test and a smooth transition test , but comparing both of the compressible results to the growth rate for an incompressible sharp contact continuity initial test .",
    "@xcite pointed out the zeroth - order inconsistency in sph , and designed a kernel to minimize these effects , achieving better qualitative results on a sharp contact discontinuity khi test .",
    "zeroth - order inconsistency is the inability of sph interpolation to reproduce a constant function at any finite resolution @xcite .",
    "a quantitative analysis of the growth of khi from a sharp contact discontinuity was performed by @xcite with sph and grid - based godunov codes . with a focus on sph",
    ", @xcite argued that a sharp contact discontinuity khi test is not ideal , and propose an alternative sph smoothing kernel which yields improved results .",
    "@xcite compared qualitatively a grid based method and sph using both a cubic and quintic kernel on a sharp contact discontinuity khi test , finding that the choice of a quintic kernel improved the sph results significantly .",
    "one of the only well posed convergence tests for khi was done in @xcite , but that was in a study of galilean invariance restricted to fixed - mesh schemes .",
    "the test by is a well posed problem influenced by @xcite , but the evaluation of the sph result was done by comparison to an analytic solution for a sharp transition initial condition and incompressible flow in an infinite domain , not for the problem posed with a softened transition in compressible flow in a finite periodic domain .",
    "the commonly used solution for the khi growth rate in numerical tests is for a sharp transition at the shear interface @xcite .",
    "however , for numerical approximations the interface should be smoothed to yield an initial value problem with finite spatial derivatives , as argued by @xcite . for a sharp interface ,",
    "the initial approximation of the derivatives across the interface does not converge with resolution . to obtain convergence a smooth interface must be used .",
    "we pose the problem in such a way that the analytic result for the incompressible limit is known for an infinite domain , as this type of analytic result is usually used to compare numerical results .",
    "however , a difficulty with kelvin - helmholtz problems is that the unstable modes are global , so solutions in a finite periodic domain , as commonly tested , are different from than the solution in an infinite domain . to circumvent this difficulty , we perform an exhaustive convergence study to establish a fully compressible nonlinear solution with a very small and rigorously derived uncertainty .    in the following discussion",
    ", we will refer to different types of discretizations used for numerical solutions to the chosen governing equations of hydrodynamics or magnetohydrodynamics . to clarify , most fixed grid ( or structured mesh ) codes use a square eulerian grid as a basis for either a point - value ( values of the fields at grid points ) or volume - average ( average volume of the field in a grid cell ) discretization .",
    "the distinction here is that a finite - volume scheme can be arranged to solve the integral form of the governing equations , and the point - value discretization can only solve the differential form of the equations .",
    "unstructured mesh discretizations do not pose the restriction of the discretization mesh being a regular grid , however the nodes are logically connected by edges , and the mesh cells form a tessellation on the computational volume .",
    "moving - mesh voronoi tessellation discretizations have begun to appear in astrophysical applications @xcite .",
    "these are a case of an unstructured mesh , where the mesh is defined by the voronoi tessellation of a set of mesh generating points .",
    "the mesh cells may be used to define a finite - volume discretization .",
    "when the mesh generating points are allowed to move in time to make a moving - mesh discretization , the voronoi mesh will be recalculated on the new point distribution at every step yielding a new set of cells and new mesh edges connecting them .",
    "the mesh movement can be arbitrary , but a quasi - lagrangian mesh movement is a particularly good choice as this minimizes numerical errors associated with advection across the grid .",
    "it is also possible to define meshless discretizations that represent the fields on a set of points or particles without specifying a set of mesh edges to connect these points .",
    "meshless discretizations then do not form a strict tessellation of the computational volume .",
    "these discretizations are commonly used to define lagrangian methods , in the sense that the points or particles are comoving with the fluid .",
    "if finite - mass particles are used , then the particles form a partition of the total computational mass , and the form of discretization used in sph is obtained and the integral form of the governing equations can be solved . however , if the meshless points carry only field values at those points , then a point - value type discretization is obtained and the differential form of the governing equations must be solved .    in section  [ sec_setup ]",
    "we give the problem setup used and in section  [ sec_analysis ] we discuss the methods used to extract measured quantities from the results .",
    "the codes used in this paper are listed in section  [ sec_codes ] . the detailed convergence study used to generate the reference compressible solution",
    "is presented in section  [ sec_reference ] .",
    "the results and comparison from several codes with different underlying algorithms and discretizations are presented in section  [ sec_results ] .",
    "we discuss the various results and implications in section  [ sec_discussion ] .",
    "extended discussion of the sph results and analysis of extra experiments is in section  [ sec_sph ] . in section  [ sec_secondary ]",
    "we discuss secondary instabilities arising from the problem setup in this work , and the difficulty of determining if they are produced in a physically meaningful manner .",
    "our conclusions are summarized in section  [ sec_conclusions ] .",
    "our motivation in choosing the initial condition is that the initial conditions are smooth , reflect as closely as possible a configuration that can be treated analytically , and can be represented easily in a wide variety of codes . in all codes , we will solve the inviscid compressible euler equations .",
    "the setup we use is chosen to be a periodic version of that used in the analysis of kelvin - helmholtz instability in @xcite : the domain is 1 unit by 1 unit in the @xmath0 and @xmath1 directions if two - dimensional , and an arbitrary thickness in the @xmath2 direction if needed for a three dimensional code .",
    "runs with resolutions of @xmath3 , @xmath4 , and @xmath5 cells , or equivalent were used in the comparison .",
    "all boundaries are periodic .",
    "the initial condition is smooth and periodic , as illustrated in figure  [ figic ] .",
    "the density is given by : @xmath6 where @xmath7 with @xmath8 , @xmath9 , and the smoothing parameter @xmath10 .",
    "the @xmath0-direction velocity is given by : @xmath11 where @xmath12 with @xmath13 , @xmath14 , and @xmath15 as in the density so that the smooth transition in density and velocity occurs over the same interval .",
    "the background shear is perturbed by adding some velocity in the @xmath1-direction with the form @xmath16 an ideal gas equation of state with @xmath17 is used .",
    "the internal energy is set such that pressure is initially uniform with value @xmath18 .",
    "the problem is run till at least time @xmath19 .",
    "analysis is done on snapshots spaced at a minimum of @xmath20 . however , in most cases the snapshots will not be spaced exactly as codes often do output or analysis on an approximate interval , e.g.  at the first time step after the specified snapshot or analysis time .",
    "the test can be run in two dimensions in a structured grid code , but for unstructured meshes or mesh free methods two dimensional and three dimensional simulations may yield slightly different results depending on how the resolution elements are arranged in the initial condition . for unstructured mesh methods and meshless methods the results will differ for a disordered node distribution and a regularly gridded one .",
    "to quantitatively describe the growth of the kelvin - helmholtz instability , we use two measurements , the amplitude of the @xmath1-velocity mode of the instability , and the maximum @xmath1-direction kinetic energy density .",
    "these two quantities are a useful pair , as the mode amplitude is a smoothed quantity and the maximum @xmath1-direction kinetic energy density is very sensitive to noise in the computed velocity field .    as a loose guide , the analysis of @xcite treats a non - periodic incompressible version of the problem studied in this paper .",
    "their linear perturbation theory yields growth rates for the two quantities studied in this work , in the infinite domain and incompressible flow limit .",
    "however , as we run our test in periodic boundaries with a compressible flow we must go further than their analysis .",
    "the maximum @xmath1-direction kinetic energy is the simplest of the two quantities to compute .",
    "this quantity is the maximum value of @xmath21 computed for all resolution elements ( cells , points , or particles ) in the computation volume at each time . in the non - periodic , incompressible limit",
    ", the growth of this quantity should be @xmath22 ( * ? ? ?",
    "* equation 18 ) . in practice ,",
    "the growth will start from a finite perturbation , will reflect erroneous velocities occurring both at the interface due to unbalanced pressures at the cell scale , and any velocity and density noise in the bulk flow .",
    "it is also important that the test posed here , and those commonly used in other works , are actually posed in a periodic domain with a compressible flow . to obtain a basis for comparison we use a numerical reference solution to the problem as posed and",
    "establish the uncertainty on this reference solution in a rigorous manner in section  [ sec_reference ] .    to extract the amplitude of the @xmath1-velocity mode of the instability a more involved calculation",
    "is required .",
    "we wish to define the measurement in a manner that can be made consistent across different types of discretizations .",
    "a simple fourier transform defined on a grid would be entirely appropriate for point - based finite difference schemes or pseudospectral schemes , but is somewhat less well motivated for finite - volume schemes , and inappropriate for meshless or unstructured mesh schemes . to state the analysis in a manner that is straightforward to describe for all codes , which treats all results in the same manner we use a discrete convolution . for the case of a uniform grid this amplitude @xmath23",
    "is given by : @xmath24 where @xmath25 ranges over all grid points or cell centers ( @xmath26 total grid points or cell centers ) and the positions @xmath27 are grid points or cell centers .",
    "this expression can be used in two or three dimensions .",
    "the mode amplitude @xmath23 is calculated at each time snapshot .    for sph simulations ,",
    "each particle needs a different weighting in the sums as the particle density varies . in the case of variable smoothing length sph where the smoothing length is set to encompass a fixed number of neighbors",
    ", we can use the smoothing length @xmath28 for particle @xmath25 to do this weighting . in the following formulas @xmath29 is the number of dimensions the simulation",
    "is run in .",
    "@xmath30 the quantities @xmath31 and @xmath32 are defined for each particle @xmath33 , from the position @xmath27 and the @xmath1-velocity @xmath34 of that particle .",
    "an advantage of the definition used here is that we can directly analyze the sph particle values as simulated without introducing an additional interpolation to a fixed grid .",
    "this feature follows over to a unstructured mesh or meshless code .    for an unstructured mesh code , or a meshless code that defines quadrature volumes for the points",
    "the appropriate general form would be : @xmath35 where @xmath36 is the area or volume of cell or the quadrature volume for point @xmath25 and the positions are the cell centers or point positions .",
    "for an infinite domain with incompressible flow , the growth of the velocity mode @xmath23 should be @xmath37 ( * ? ? ? * eq .",
    "the growth rate for a kelvin - helmholtz instability with these two conditions has been used before as a comparison for results obtained in periodic domains with a compressible flow , but the two problems are formally different , and depending on the parameters the growth rates may vary .",
    "again , to circumvent this difficulty , we compare results to the numerical solution of the test problem specified , and establish the uncertainty on this reference solution in a rigorous manner in section  [ sec_reference ] .",
    "[ cols=\"<,<,<\",options=\"header \" , ]     in this paper , we compare the results from six codes to the reference solution , which itself is produced with the pencil code .",
    "the pencil code is a fixed eulerian mesh , non - conservative , finite - difference , mhd code that uses sixth order centered spatial derivatives and a third order runge - kutta time - stepping scheme , being primarily designed for weakly compressible turbulent hydromagnetic flows . for the problem in question , in order to keep the reynolds number low at the grid scale while keeping the integral and intermediate scales nearly inviscid , explicit sixth - order hyperdiffusion and hyperviscosity are added to the mass and momentum equations as specified in .",
    "the other codes , enzo , athena , ndspmhd and phurbas are introduced below .",
    "enzo is a three - dimensional , eulerian adaptive mesh refinement hybrid ( hydrodynamics + n - body ) grid - based code @xcite . for this problem the euler equations",
    "are solved using a third - order piecewise parabolic method ( ppm ) with the two - shock approximate riemann solver .",
    "time - stepping is constrained by a courant condition for the gas with a courant factor c=0.4 .",
    "the run - time ppm diffusion , flattening , and steepening parameters were set to zero .",
    "enzo version 1.5 was used .",
    "athena is a three dimensional eulerian grid code that ( among other algorithms ) implements a higher order godunov method for hydrodynamics @xcite .",
    "specifically , we have used the third - order cell reconstructions with the hllc approximate riemann solver and the unsplit corner - transport - upwind ( ctu ) second order time integration algorithm .",
    "otherwise the options used were as specified in the two - dimensional test problem supplied with the code , with a courant number @xmath38 .",
    "we used athena version 4.1 obtained from the project website .",
    "ndspmhd is a one , two , and three dimensional reference implementation of sph and a platform for experimentation @xcite .",
    "we obtained ndspmhd version 1.0.1 from the author s website .",
    "ndspmhd was run on this problem in two dimensions , using both the cubic and quintic kernel options .",
    "the cubic kernel is the conventional choice for sph , whereas the quintic kernel delivers higher accuracy at the cost of computational expense .",
    "@xcite describes the ndspmhd implementation of sph as converging as higher order kernels are used .",
    "that is , the result on the test problem shown here should converge with the combination of using more particles and using a higher order kernel .",
    "ndspmhd also supports the artificial thermal conductivity described in @xcite .",
    "the results of sph simulations may depend strongly on the initial particle distribution used . to generate the initial condition , we relaxed a set of equal mass particles to an approximate equilibrium with an artificially imposed pressure field which produced the required density profile .",
    "the particles settle into a roughly hexagonal grid , although with dislocations required to produce the spatially varying density .",
    "the number of particles used at each resolution matched the number of cells or points used for the grid code ( @xmath39 , @xmath40 , @xmath41 ) .",
    "otherwise , the code was run with the default parameters used in test 6 of the ndspmhd examples package .",
    "phurbas is a meshless , adaptive , lagrangian code for magnetohydrodynamics @xcite .",
    "phurbas uses third order least square fits to derive spatial derivatives , and a second order scheme for time integration .",
    "stabilization is achieved through an artificial bulk viscosity .",
    "it is run here in three dimensions , using volumes with height @xmath42 , @xmath43 , and @xmath44 in thickness in the @xmath2-direction .",
    "phurbas does not use a grid , so instead we use spatially constant resolution and set the resolution parameter @xmath45 to the cell size used in the grid codes . to produce the initial particle distribution",
    ", we first used a tiling procedure as in @xcite and then further relaxed the distribution to one that would arise naturally in a shearing flow by running the problem to @xmath19 and restarting the test with the initial condition defined on resulting particle distribution .",
    "because the disordered particle distribution is inherently three dimensional , the results at a given resolution can not be strictly compared to the two - dimensional runs performed in other codes here .",
    "output at time @xmath19.,width=188 ]    to produce a solution to the full nonlinear , periodic , compressible case as run in this work , we performed an extensive convergence study with the pencil code .",
    "this convergence study allows us to establish not only a very high quality reference solution , but also a notion of the uncertainty in this reference solution .",
    "the importance of the unusual step of establishing the uncertainty of the reference result is that we can then assert with confidence that the differences seen between other lower quality results and this reference result are overwhelmingly due to errors in the lower quality solutions . in the results in section  [ sec_results ] the pencil code",
    "is shown to be well suited to the smooth , subsonic problem posed here .",
    "we use grids of @xmath3 , @xmath46 , @xmath47 , @xmath48 , @xmath49 , and @xmath50 points , specified so that every second grid coordinate overlaps on successive refinements , and with the time stepping scheme in the pencil code modified to provide outputs at exact @xmath51 time unit intervals .",
    "this set of outputs enables a resolution study at each output time for the convergence of the mode amplitude .",
    "establishing the empirical rate of convergence of the mode amplitude @xmath23 allows a richardson extrapolation based estimate of the uncertainty in the most resolved measurement .",
    "hence , we are able to make comparisons of the results from other codes to the highest resolution pencil code result while knowing in a rigorous manner that the errors in this reference result are negligible .    first , we can calculate the empirical rate of convergence @xmath29 of the mode amplitudes defined by equations  [ eqmodebegin]-[eqmodeend ] for a set of three results with a refinement ratio of 2 between each resolution as @xmath52 where @xmath53 is the value of the mode amplitude on the coarsest grid and @xmath54 , @xmath55 are the values on the medium and finest grid respectively ( * ? ? ?",
    "* equation  5.10.6.1 ) .",
    "this rate of convergence tells us how fast the series of values from each resolution is converging towards the correct result .",
    "once we have identified the convergence rate of the series of results , we can apply a generalized form of richardson extrapolation to estimate the converged result , and hence derive an indication of the uncertainty in our highest resolution result .",
    "this indication of uncertainty is the grid convergence index ( gci , * ? ? ?",
    "* ) , a uniform method of reporting the uncertainty on such a convergence study given as @xmath56 from ( * ? ? ?",
    "* equation  5.6.1 ) .",
    "the value of the safety factor @xmath57 we use is @xmath58 .",
    "this value is that suggested by ( * ? ? ?",
    "* section  5.9 ) as being appropriate when the rate of convergence is explicitly determined with a convergence study as in this work .    a density plot at time @xmath19 from the highest resolution ( @xmath59 ) calculation is shown in figure  [ figpencilkhrho4096 ] .",
    "the results of evaluating equation [ eqorder ] for each set of three resolutions is shown in figure [ empiricalorderplot ] .",
    "this figure shows that the convergence rate settles at approximately @xmath60 for most of the time interval @xmath61 when the highest resolution results are considered . using the observed rate of convergence at each time",
    ", we can assign the uncertainty on the result with equation  [ eqgci ] , which is shown in figure  [ pencilrefsolplot ] .",
    "the high resolution results used are necessary to establish a well behaved convergence in figure  [ empiricalorderplot ] , which means that the uncertainty is only well known when the uncertainty itself is very small . to demonstrate more explicitly the convergence behavior , and the magnitude of the changes between successive resolutions we have plotted the differences in the @xmath1-velocity values between successive resolutions in one quadrant of the domain in figure  [ fig_refvydiff ] .",
    "the greatest changes between successive resolutions are localized to the density change interface , and show not suggestion of the presence of secondary instabilities .",
    "a similar plot for the density is shown in figure  [ fig_refrhodiff ] , again showing no suggestion of secondary instabilities .",
    "the simulations are identified by a two letter prefix as outlined in table [ prefixtable ] and the resolution ( @xmath62 @xmath40 , @xmath41 ) .",
    "results for the @xmath1-velocity unstable mode amplitude itself , and the growth of that quantity for all codes are plotted in figure  [ fig7.pdf ] .",
    "figure  [ allenergyplot ] gives the results for all codes for the minimal @xmath1-direction kinetic energy .",
    "the following two subsections discuss these two measured quantities .",
    "in interpreting the @xmath1-velocity unstable mode amplitude ( figure  [ fig7.pdf ] ) it is important to note that a relative comparison of the solution quality of the codes can not be made exactly . for the unstructured mesh and meshless methods , the code performance in two dimensions and three dimensions",
    "is expected to differ notably as the possible arrangements of cells and particles differs .",
    "a strict comparison between phurbas and the other codes can not be drawn as phurbas was run in three dimensions not two .",
    "for eulerian grid codes , the problem is grid - aligned , and performance will differ as it is rotated against the grid . with these caveats , we proceed to comment on the results obtained .",
    "the results for the growth of the @xmath1-velocity unstable mode amplitude in the pencil code , enzo , and athena are very similar at the level of this comparison . here , the main difference is a variation between the codes of the growth rate at the lowest resolution .",
    "reassuringly , the @xmath39 resolution mode amplitude growth curves from the two piecewise parabolic method variations used in enzo and athena resemble each other more than they do the result from the pencil code .",
    "these results demonstrate that the pencil code reference result is reasonable .    for phurbas",
    "unstable mode amplitudes converge with increasing resolution from below the reference value , but at the @xmath41 resolution the growth rate at late times exceeds the reference value for the growth rate while the amplitude stays below the reference value . in comparing the absolute values from phurbas to the other codes",
    "one shall to remember that the phurbas simulation is in three dimensions with a unstructured particle distribution .",
    "however , at low resolutions the results for the growth rates are definitely lower than that obtained in the grid codes . as the resolution",
    "is increased a definite convergence towards the reference result is observed .    from the mode amplitude plotted for ndspmhd in , and notwithstanding the aforementioned limitations to making comparisons in two dimensions ,",
    "it is clear that the cubic - kernel sph is the least accurate method for the problem studied in this work .",
    "the result given here is however for a single initial arrangement of sph particles .",
    "results with sph do depend , and in this problem depend strongly , on the initial particle arrangement . in general , the ndspmhd simulations show value and growth rates for the @xmath1-velocity unstable mode amplitude which are too small . at the lowest resolution ( @xmath39 )",
    "the simulation with artificial thermal conductivity ( ne ) gives a slightly improved result over the simulation without that addition ( nc ) , but the dependence is minimal and more so at the higher resolutions .",
    "the cubic - kernel sph results do not depend strongly on the use of a thermal conductivity term unlike the sharp transition khi test specified by @xcite .",
    "this is demonstrated by the nc simulation where the thermal conductivity was turned off , yielding results very similar to the ne simulation .",
    "this illustrates that the artificial conductivity is not so much a patch for correcting kelvin - helmholtz in sph , but for ensuring that contact discontinuities stay well resolved .",
    "quintic kernel sph , labeled as simulation no , uses a larger number of neighbors and has smaller zeroth - order sph inconsistencies .",
    "this gives a more accurate result than cubic - kernel sph for the same number of particles .",
    "the pair of ndspmhd results nc and no demonstrate that sph converges in a limit that is a combination of increasing particle number and neighbor number .",
    "the importance of using the quintic kernel over simply increasing the number of sph neighbor particles is to avoid particle clumping , which would effectively lower the resolution , undermining the intent of a convergence study @xcite . unlike in we do not see sph starting at a acceptable growth rate at low resolutions and converging to a lower growth late at high resolution .",
    "we observe a much less surprising behavior wherein the growth rate at low resolutions is too low , and the solution appears to improve with increasing resolution , though the absolute error is significant .",
    "-direction kinetic energy in all codes.,width=302 ]    the behavior of the maximum @xmath1-direction kinetic energy is qualitatively different from the mode amplitude as this measurement tracks the maximal value , not a smooth average .",
    "maximum @xmath1-direction specific kinetic energy histories are shown for all simulations in figure  [ allenergyplot ] . here the velocity noise in sph resulting from pressure force errors can be seen clearly in the overview figure , while all other codes behave in a roughly similar manner .",
    "the convergence study does not establish an uncertainty on the maximum @xmath1-direction kinetic energy , but the highest resolution pencil code result plotted as the reference curve can be taken as a useful indicator of the correct nonlinear solution .    in pencil ,",
    "enzo , athena , and phurbas , at late times at low resolution , when the unstable velocity mode value is low , the maximum @xmath1-direction kinetic energy is also low .",
    "this is the opposite of the situation found in ndspmhd , where at late times at low resolution the unstable velocity mode value is low , but the maximum @xmath1-direction kinetic energy is too high .    at lower resolutions in phurbas",
    "the influence of velocity noise at the interface can be clearly seen . at early times",
    "the maximum @xmath1-direction kinetic energy is too high and the unstable mode amplitude is too low",
    ". pencil does not suffer from this to the same extent .",
    "enzo and athena have the best initial behavior at the interface as they are finite - volume schemes and hence the initial pressure equilibrium is well represented across the interface .",
    "the initial maximum kinetic energy and the initial mode amplitude are both to low at low resolution in these codes .",
    "the resolution dependence of the velocity noise is illustrated for the cubic - kernel sph with artificial conductivity ( ne ) . neglecting the artificial conductivity yields virtually the same result as shown in figure  [ allenergyplot ] ( simulation nc ) .",
    "quintic kernel sph , with smaller zeroth - order inconsistency errors than cubic - kernel sph , does show smaller velocity noise , but it is still very large ( simulation no ) .",
    "we show gray scale slices of the density field at @xmath19 in figure  [ figendrho512 ] .",
    "all the images have the same limits on the grey scale between density of @xmath63 and @xmath64 , the density extremes in the highest resolution result in the pencil code convergence study .",
    "the results for pencil , enzo , and athena are largely similar , as at high resolution these codes agree well with each other and with the reference result .",
    "though the result with phurbas strongly resembles the reference result although it clearly shows more diffusion .",
    "the sph results from ndspmhd ( only ne and no shown ) reflect the slow growth of the unstable @xmath1-velocity mode already discussed . the simulation no result using quintic - kernel sph shows less diffusion than simulation ne using cubic - kernel sph . especially in simulation",
    "ne , secondary features of a filamentary appearance can be seen along the interface , and these are less apparent in the simulation no result .",
    "the quintic kernel result ( no ) overall shows better agreement with the reference than the cubic kernel result ( ne ) .",
    "overall , the grid based codes pencil code , athena , and enzo had very similar performance .",
    "for these codes , the test problem in this work ( run to @xmath19 ) confirms their correctness .",
    "this shows that the test as outlined here can be used to discriminate among numerical schemes . in this test",
    ", we demonstrated that phurbas and ndspmhd , while both using meshless lagrangian schemes , give significantly different convergence behaviors .",
    "though phurbas was run in three dimensions , and ndspmhd in two , the strikingly different qualitative behavior bears some explanation .",
    "a primary observation is that phurbas differs from ndspmhd in that phurbas uses a third order accurate and consistent spatial discretization , while ndspmhd uses an sph discretization which has zeroth - order inconsistency .",
    "this issue is sufficiently complex that it is discussed in a separate section ( section  [ sec_sph ] ) .",
    "we also note that no code developed obvious signs of secondary instabilities in the solution by time @xmath19 , in agreement with the findings of the convergence study performed on the reference result .",
    "how , and when , secondary instabilities may arise in a khi test such as this is discussed in section  [ sec_secondary ] .",
    "the results for the maximal @xmath1-direction kinetic energy in section  [ sec_ydirener ] show significant noise appearing in the velocity in the sph simulations ne , nc , and no .",
    "this section is devoted to exploring the source and behavior of this noise .",
    "it has been argued that maintaining particle order is vital to achieving good results with sph @xcite .",
    "particle ordering in sph can be expressed as a condition that the lagrangian of the system of particles is minimized ( * ? ? ?",
    "* section 2.5 ) . to seek this minimum",
    ", the particles must have some re - meshing motion in addition to the pure fluid motions ( * ? ? ?",
    "* section 5.2 ) .",
    "these re - meshing motions mean that in sph one always has some motions which are not physical , but purely related to the sph particles attempting to relax to an ordered state ( * ? ? ?",
    "* section 5.2 ) .",
    "these re - meshing motions are also shown in the post - shock state in ( * ? ? ?",
    "* figure 10 ) .",
    "the re - meshing motions are provided by the linear errors in the sph pressure forces , which are in turn a result of the zeroth - order inconsistency of sph interpolation .",
    "that is , the zeroth - order inconsistency in sph interpolation provides a linear error in the pressure force which causes two particles which approach each other to repel .",
    "re - meshing motions created by this repulsion are in turn damped by the artificial viscosity to encourage the particle distribution to relax . in this way , both the zeroth - order inconsistency in the pressure estimate is vital to maintaining particle order and the artificial viscosity can not simply be disabled .",
    "further , though more advanced artificial viscosities can be designed , the identification of the particle velocity with the fluid velocity means that the need for motions preserving particle order will necessarily corrupt to some degree the fluid velocity itself .",
    "the root cause that creates this situation is the zeroth - order inconsistency in sph interpolation , so the parameter which we vary is the one which varies this error , the choice of sph smoothing kernel . as the change from the cubic kernel to the quintic kernel decreases the size of the zeroth order inconsistency , the re - meshing pressure forces are smaller , and the resulting velocities are smaller .",
    "consequently , the level of @xmath1-direction kinetic energy noise seen in the simulation no is smaller than that seen in the simulation ne .",
    "recently @xcite and @xcite have connected zeroth - order inconsistency in sph to poor results for related khi test problems , and @xcite has demonstrated the connection in the context of low mach number turbulence . in this work",
    "we have demonstrated this connection by first showing that on a smooth test problem the artificial conduction of @xcite does not significantly affect the results .",
    "then , we have demonstrated that when the quintic kernel is used , with smaller inconsistency errors than the cubic kernel , the test results improve significantly .",
    "the size of the inconsistency errors are reflected in the maximal @xmath1-direction specific kinetic energy statistic , as pressure gradient errors dive spurious particle motion .",
    "finally , phurbas , while being meshless and lagrangian like sph , uses a third - order consistent interpolation .",
    "the consequence of this for the test in this paper is that it performs much better than sph , as the pressure forces are accurate enough to keep the velocity and density noise much smaller than in sph .",
    "hence , phurbas has a qualitatively different behavior on this test , and convergence does not depend on varying the number of neighboring particles used in the interpolation .    to demonstrate that the velocity noise behavior seen in this work is general",
    ", we have run a series of additional tests .",
    "the first test is a version of the khi setup in section  [ sec_setup ] with a uniform density of 1.0 . for sph ,",
    "this is a particularly simple choice as a uniform hexagonal close packed grid of particles is the unique relaxed distribution in two dimensions .",
    "hence , initially the setup does not suffer from any velocity noise .",
    "figure  [ sphisorho ] shows that regardless of this initially relaxed distribution , the maximal @xmath1-direction kinetic energy still reflects the growth of the velocity noise .",
    "again , as in the previous tests the noise grows sooner at higher resolutions .",
    "we note that the velocity noise in the highest resolution quintic kernel case of our isodensity test appears to be triggered by the growth of the primary khi instability .",
    "to simplify the setup further , we remove the @xmath1-direction velocity perturbation from the initial condition , yielding a smooth unperturbed shear flow . for the maximum @xmath1-direction specific kinetic energy measurement ,",
    "the trivial analytic solution for this problem is a value of zero for all times .",
    "figure  [ sphshear ] , upper panel , shows that in the this setup , run with the cubic kernel , the maximal @xmath1-direction kinetic energy grows to the same level as before in the isodensity khi test , although it takes longer .",
    "this growth happens at earlier times for higher resolutions .",
    "figure  [ sphshear ] , lower panel , displays the same behavior for the quintic kernel , although the timescales involved are longer .",
    "these simulations are stopped abruptly when they succumb to particle pairing instability ( * ? ? ?",
    "* section 5.4 ) and two particles approach within @xmath65 length units . some recent proposed modifications to sph reduce or eliminate this instability for large kernels @xcite . with each kernel choice , the time interval until the velocity noise jumps is shorter as the number of particles is increased , but for a given number of particles the time interval until the velocity noise jumps is longer if the quintic kernel is used .",
    "that is , the results converge towards to analytic solution as the zeroth - order inconsistency in the sph interpolation is reduced .",
    "we have shown that given a convergence test stated in a well posed manner , all the methods tested appear to converge towards the correct result for the growth of the primary instability .",
    "recent discussion of kelvin - helmholtz tests has broadened to include secondary instabilities .",
    "@xcite shows secondary instabilities developing from a similar initial condition .",
    "the reference solution we compute shows no indication of these structures .",
    "@xcite suggested that their moving - mesh code is able to resolve secondary khi billows which can not be resolved in their fixed - mesh code because it was too diffusive .",
    "though the solution in a fixed mesh and moving mesh code should not be expected to by equivalent at any finite resolution , that a given code does not develop secondary kelvin - helmholtz instabilities is not simply a function of the diffusivity of the code , it is also a dependent on the seeding of such instabilities .    in general , we can categorize the possibilities for why our reference case and the tests done at lower resolutions in this work do not show the development of any secondary instabilities in three cases :    1 .",
    "the secondary billows should grow physically , either due to the nature of the initial perturbation fed into the problem or the interaction between some combination of the initial perturbation and modes of the instability directly seeded by the initial perturbation . in this case",
    "the secondary billows should eventually show up at some resolution in any convergent code , but should arise at a particular location and time .",
    "the secondary billows grow due to the balance of numerical perturbations and numerical diffusion . in this case",
    "the billows seen at some time should disappear at some resolution in any convergent scheme as the significant power in the numerical perturbations should eventually move to spatial scales too small to seed the secondary instability efficiently .",
    "3 .   the slight differences between the setup of @xcite and our setup mean the difference between seeing physical growth of secondary billows and failing to produce them .    in the first case ,",
    "developing the secondary instabilities is merely a matter of using a sufficiently large resolution . at lower resolutions",
    "a resolution study should still suggest a significant uncertainty or change between simulations of different resolution as the secondary billows are damped less and less . in the second case ,",
    "the resolution necessary to make the secondary billows disappear may be quite large , as a numerical mechanism introducing noise at a small scale may still have significant power at larger wavelengths depending on the spatial correlation of the mechanism introducing the noise .",
    "however , the resolution study performed with the pencil code to much higher resolution shows no indication that these modes grow .",
    "the third case can not be ruled out explicitly , as @xcite does not specify the exact details of the setup used .",
    "however , we can show that for our problem that secondary instabilities that do develop are of a purely numerical origin .",
    "this strongly suggests that the secondary billows seen in @xcite are a numerical artifact , so the observation that a fixed grid codes does not develop these on the same problem does not imply that the fixed grid code is too diffusive to support the modes .    to demonstrate how numerical effects can seed secondary khi",
    "we have performed a test with athena .",
    "we ran the khi test at resolutions of @xmath66 , @xmath67 and @xmath59 until @xmath68 . in figure  [ figatt30 ] the density in a region centered on a single primary khi billow is shown at time @xmath69 .",
    "secondary khi billows can be seen growing in the @xmath66 case , and this pattern is successively suppressed at the higher resolutions , suggesting it is an artifact of the finite resolution and is converging away . however , in the @xmath67 resolution , a different set of secondary instabilities can be seen growing at much shorter wavelengths in the central winding of the primary billow . as the resolution",
    "is increased , the numerical seeding of the secondary instabilities changes , and the secondary modes which are excited change .",
    "figure  [ figatt32 ] shows the same region at time @xmath70 . by this point , the secondary instabilities in the @xmath59 resolution simulation have become apparent .",
    "surprisingly , a new set of secondary billows has appeared on the outer winding of the primary billow .",
    "we can not reach well justified conclusions about a particular mode of the secondary instability from this study as we can not reproduce the same instability at two different resolutions .",
    "though the growth of secondary instabilities is likely a physical reality at the reynolds numbers involved in astrophysical problems , relying on numerical effects to seed them will not result in a true physical model of the phenomena as the seeding , and hence growth of these instabilities , will be inherently dependent on parameters such as resolution . models relying on numerically seeded instabilities , even if the presence of the instability is physical , make it difficult to seperate numerical effects from physical behavior , which is turn makes it difficult to come to strong conclusions about the effect of the instability",
    ". conclusions about the instability must consist of a measurement and some manner of characterization of the error in that measurement . in order to characterize the error in the model of the instability , a convergence study must be performed . to perform this convergence study ,",
    "a fixed seeding of the instability must be possible across all resolutions .",
    "if the seeding is a numerical effect caused by the finite resolution , it will not be fixed between two resolutions .",
    "hence , the tests in this work do not show that any code used can not , at any of the the resolutions tested , resolve secondary kelvin - helmholtz instabilities as these have not been seeded in a controlled way or even in an avoidable manner .    from the results of the convergence study in section  [ sec_reference ] we propose that if a code develops secondary kelvin - helmholtz billows in this test by @xmath19 , it is due to the growth of numerical perturbations .",
    "the less rigorous study performed with athena suggests that the same conclusion should hold to at least @xmath71 . in the limit of infinite resolution",
    ", any convergent code should reproduce the correct result .",
    "however , if at finite resolution a code shows a tendency to produce secondary instabilities , then the scheme can be improved by adding a diffusive operator to damp the noise leading to the the instability . particularly with respect to moving - mesh tessellation codes ,",
    "kelvin - helmholtz tests are not the only place where behavior suggests that some additional numerical diffusion should be used to damp grid scale noise .",
    "development of secondary kelvin - helmholtz instability after @xmath19 is likely due to the presence of spurious noise in the solution .",
    "for example , in the preparation of this work , we discovered that the evolution of the test problem here differed greatly at high resolution ( @xmath59 ) between enzo versions 1.5 and 2.0 . in enzo 2.0 , a bug existed that caused slightly incorrect pressure reconstructions .",
    "this caused small sound waves to launch from the interface , and propagate though the periodic domain interacting with themselves and forming small short - wavelength perturbations .",
    "the discovery of this bug was fortuitous however , because it demonstrates again how artificial , numerical perturbations can give rise to secondary kelvin - helmholtz in this test problem if they are able to overwhelm the dissipation of the scheme .",
    "the underlying cause of the tendency of many schemes to develop secondary khi in this test problem is that the shear interface becomes increasingly steep as it stretches in the primary khi billow .",
    "eventually , the width of the interface approaches the grid scale and it become susceptible to numerically seeded secondary instabilities .",
    "this behavior is also commonly seen in the initial evolution of grid - aligned sharp transition versions of the khi test .",
    "two examples are ( * ? ? ?",
    "* figure 13 ) and ( * ? ? ? * figure 8 , upper right panel ) .",
    "we suggest then that even fixed - grid finite volume godunov schemes may be improved in pathological cases of unresolved shear interfaces by the addition of a diffusive flux .",
    "this flux should be chosen to spread the interface over enough grid cells to suppress the numerically seeded instabilities .",
    "another lesson to be derived here is a cautionary one .",
    "not all new instabilities seen as resolution is increased when solving the discretized euler equations are physically real .",
    "new numerical instabilities can reveal themselves as resolution is increased , as the flow can enter into new regimes where it is more sensitive to the inevitable numerical noise in a method . in the high resolution",
    "set of athena simulations , this can be seen in the magnitude of the density gradients . in figure [ figatrhograd30 ]",
    "the density gradient in a slice through a primary billow at time @xmath72 in the three athena simulations used in this section is plotted , calculated with a four point second - order finite difference stencil .",
    "as the resolution is increased , the maximum gradient achieved increases .",
    "mathematically , when solving the euler equations , this behavior arises because the modified equations that are actually solved by the method change as resolution is increased - the diffusive effects become smaller .",
    "one route around this difficulty can be to solve the navier - stokes or boltzmann equations instead with a fixed viscosity or particle mean free path . since these equations have a physical scale where diffusion dominates dynamics , the reliable elimination of numerically generated instabilities for arbitrarily long run times can be obtained by fixing the physical diffusive scale and reducing the grid scale far below the diffusive scale .",
    "the same point illustrates how the transition to turbulence and mixing must be studied when the euler equations are used . to produce the secondary instabilities that break up the flow , the nonlinear interaction or modes or seeding of secondary instabilities",
    "must be done on a controlled manner .",
    "this job can not be left to the numerical noise , or the time and manner in that the flow breaks up will be a reflection of numerical issues and not of physical reality .    finally , we suggest that it is possible to produce a controlled test of the growth of secondary billows from definite perturbations , similar to the study performed by @xcite in an incompressible flow",
    ". such a setup could be useful in determining the appropriate and minimal diffusion to add to a scheme to suppress the numerical seeding of secondary instabilities in given conditions .",
    "we have constructed a reference solution with a well characterized uncertainty , along with defining a general manner in that the test can be analyzed .",
    "this methodology was applied to example codes from the major families of numerical techniques used in astrophysics .",
    "all codes tested showed convergence towards the reference result when the resolution was increased in the appropriate manner . for sph , the use of an artificial thermal conductivity does not significantly effect the results , but using a higher - order kernel ( and hence a larger number of neighbors ) does improve the results .",
    "we conclude then that the fundamental reason for poor performance of sph in khi is the zeroth - order inconsistency of sph interpolation .",
    "visually , to time @xmath19 in the test problem there are no secondary instabilities that arise in the reference solution . by examining the relative behavior of different types of code",
    ", we argue that the presence of secondary instability on this test is caused by having a numerical diffusion that is very low compared to the grid noise in the method .",
    "hence , we propose that it is advantageous in some methods , particularly moving - mesh tessellation methods , but also in fixed - grid godunov schemes , to include an extra diffusion operator to smooth the solution such that grid noise does not drive small scale instabilities .",
    "we are indebted to the authors of ndspmhd , athena , enzo and the pencil code for making the codes freely available to us .",
    "the sph visualizations were created with splash @xcite .",
    "we thank the anonymous referee for constructive comments that significantly improved the organization of the paper .",
    "we thank daniel price for feedback on a draft of this manuscript , and suggesting the use of fully relaxed sph initial conditions and the iso - density special case .",
    "we thank mordecai - mark  mac  low for his support and useful discussions .",
    "we thank paul duffel for useful discussions about moving - mesh schemes .",
    "j - c.p .",
    "thanks orsola de  marco and falk herwig for their support .",
    "this work has been supported by national science foundation ( nsf ) grants ast-0835734 and ast-0607111 . w.l .",
    "gratefully acknowledges partial financial support from the nsf under grant no .",
    "ast-1009802 . w.l .  completed co - writing this work at the jet propulsion labratory , california institute of technology , under a contract with the national aeronautics and space administration .",
    "this work used the extreme science and engineering discovery environment ( xsede ) , which is supported by national science foundation grant number oci-1053575 .",
    "this work used computer time provided partially by westgrid and compute canada ."
  ],
  "abstract_text": [
    "<S> recently , there has been a significant level of discussion of the correct treatment of kelvin - helmholtz instability in the astrophysical community . </S>",
    "<S> this discussion relies largely on how the khi test is posed and analyzed . </S>",
    "<S> we pose a stringent test of the initial growth of the instability . </S>",
    "<S> the goal is to provide a rigorous methodology for verifying a code on two dimensional kelvin - helmholtz instability . </S>",
    "<S> we ran the problem in the pencil code , athena , enzo , ndspmhd , and phurbas . </S>",
    "<S> a strict comparison , judgment , or ranking , between codes is beyond the scope of this work , though this work provides the mathematical framework needed for such a study . </S>",
    "<S> nonetheless , how the test is posed circumvents the issues raised by tests starting from a sharp contact discontinuity yet it still shows the poor performance of smoothed particle hydrodynamics . </S>",
    "<S> we then comment on the connection between this behavior to the underlying lack of zeroth - order consistency in smoothed particle hydrodynamics interpolation . </S>",
    "<S> we comment on the tendency of some methods , particularly those with very low numerical diffusion , to produce secondary kelvin - helmholtz billows on similar tests . </S>",
    "<S> though the lack of a fixed , physical diffusive scale in the euler equations lies at the root of the issue , we suggest that in some methods an extra diffusion operator should be used to damp the growth of instabilities arising from grid noise . </S>",
    "<S> this statement applies particularly to moving - mesh tessellation codes , but also to fixed - grid godunov schemes . </S>"
  ]
}