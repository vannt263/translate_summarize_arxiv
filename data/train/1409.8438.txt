{
  "article_text": [
    "mean - field models in statistical mechanics usually have very compact solutions , which can be fully worked out in an analytical form , as a function of order parameters that solve simple self - consistency equations .",
    "in particular , the clustering property implies that connected correlations are weak enough within a pure state to allow for the computation of any correlation in terms of local fields , i.e. , magnetizations and pairwise correlations ( for models with 2-body interactions at most ) .    in spin - glass models",
    "the situation becomes definitely more complicated by the presence of a number of coexisting states , which is divergent in the thermodynamical limit for any temperature below the critical one , @xmath0 .",
    "although correlations are still relatively simple within a state , the hierarchical structure of these states generates highly non - trivial correlations among local fields .",
    "the order parameter in spin - glass models is the probability distribution @xmath1 of the overlap @xmath2 between two copies of the system ( to be better defined in the following ) , where the subindex @xmath3 denotes a particular realization of the disorer ( a sample ) . the so - called replica symmetry breaking ( rsb ) solution to mean - field spin - glass models @xcite provides a self - consistency equation for the disorder - averaged @xmath4 .",
    "although this is a partial differential equation , i.e. , much more complicated than usual mean - field self - consistency equations , it can be solved with high accuracy @xcite . in this way",
    "one can obtain precise results for many observables , such as the average free - energy , depending only on the average overlap distribution @xmath4 ,    however , even though @xmath4 encodes a lot of information about the system , translating a thorough knowledge of this function into physical results may be a non - trivial task .",
    "let us consider a concrete example : suppose we want to understand whether a given model is well described within a given mean - field approximation .",
    "we can run monte carlo simulations for this model , take measurements of physical observables and compare them with the mean - field predictions .",
    "for example , one may be interested in studying local magnetizations , but this requires computing local fields that have non - trivial correlations in the rsb solution .",
    "how to compute them efficiently is one the aims of the present paper .",
    "a second , and more relevant , example consists in the study of sample - to - sample fluctuations and finite - size effects .",
    "the main aim of this paper is showing how one can use a full knowledge of the @xmath4 in order to generate explicitly different disorder realizations @xmath1 in the thermodynamical limit and , then , how to introduce finite - size corrections so the analytical results can be directly compared to monte carlo simulations .",
    "this is of great practical importance since the rsb solution can only be proven to hold for large spatial dimension ( @xmath5 ) . in the experimentally relevant @xmath6",
    "system analytical methods are of only limited usefulness and monte carlo simulation emerges as a fundamental tool . of course , the ( necessarily ) finite - size and finite - statistics results from a simulation will , at a glance , look very different from the analytical thermodynamical limit prediction , whether the system obeys rsb theory or not .",
    "in this situation , being able to extend the rsb prediction to finite sizes in a quantitative way is a major help .",
    "the paper is organized as follows . in section  [ sec : tree ]",
    "we provide an extended introduction , summarizing what is known about the branching tree of states in mean - field spin glasses . in section  [ sec : generation ] we show how to generate one of these trees , while in section  [ sec : cavity ] we explain how the cavity method can be exploited to reweight the trees and compute the , eventually unknown , correct branching factors . finally in section  [ sec : test ] we perform some tests to check our numerical implementation and in section  [ sec : application ] we provide a practical application of the whole procedure to the problem of counting peaks in single - sample @xmath1 .",
    "the appendix discusses several technical improvements to the basic algorithm described in the text .",
    "in this section we summarize the main results about the branching tree of states in mean - field spin glasses , in order to provide a self - contained introduction and to fix our notation .",
    "most of the material in this section is well known in the literature , but not always accessible in a concise way , so we think it may be of use to a general reader that is not very familiar with the intricacies of the rsb theory . for a more detailed account and derivations",
    ", we refer the reader to refs .",
    "@xcite .",
    "we start by considering the sherrington - kirkpatrick ( sk ) model @xcite @xmath7 where the quenched couplings @xmath8 are independent , identically distributed ( i.i.d . )",
    "random variables taken from a symmetric distribution with variance @xmath9 . since this system has a quenched disorder , we have to consider first the thermal average @xmath10 for a fixed choice of the @xmath11 and then the average over all the possible disorder realizations , denoted with an overline , @xmath12 .",
    "even though this is a mean - field model ( its finite - dimensional counterpart , the edwards - anderson model  @xcite , considers only short - range interactions ) , it has proven to be very complex .",
    "indeed , even though the model was solved by parisi in the early 1980s  @xcite using the _ replica symmetry breaking _ ( rsb ) method , a rigorous proof has been obtained only recently by talagrand  @xcite .",
    "the rsb picture for the sk spin glass describes a system that experiences a second - order spin - glass transition at a temperature @xmath13 . below @xmath0",
    "a very complex spin - glass phase appears , characterized by the existence of infinitely many relevant equilibrium states , unrelated to one another by simple symmetries and separated by very high free - energy barriers .",
    "in other words , the configuration space of the system contains an infinity of free - energy valleys @xmath14 , all with the same free energy per spin in the thermodynamical limit : @xmath15 in the thermodynamical limit the barriers between valleys are infinitely high and ergodicity breaks down .",
    "the expectation values of intensive physical quantities will fluctuate from one valley to another , but not within each valley .",
    "for this reason , the free - energy valleys are identified with the _ pure states _ of the system .",
    "we can then introduce restricted averages @xmath16 .",
    "for instance , we can define the average local magnetization for each state as @xmath17 and , in general , decompose the thermal average of an observable @xmath18 as @xmath19 where the @xmath20 are the probabilities or statistical weights of each pure state , related to the free - energy fluctuations .",
    "indeed , for each state we can decompose the free energy as @xmath21 where the intensive fluctuation is @xmath22 .",
    "then @xmath23 notice that this decomposition into pure states can be done also for simple systems .",
    "for instance , in a ferromagnet we would have @xmath24 the difference is that in a spin glass we have to deal with an infinite set of states , which are not related by simple symmetries and thus can not be selected macroscopically by turning on an external field .",
    "these difficulties notwithstanding , it is possible to describe the structure of the space of states in the system .",
    "we start by introducing a notion of distance between two states , given by their overlap , @xmath25 in principle , we will have infinitely many possible values of the @xmath26 , which can be characterized by a probability distribution @xmath27 where the subindex @xmath3 reminds us that we are considering a single sample .",
    "if we average over the disorder , we obtain @xmath28 as we shall see , this averaged function @xmath29 is going to determine the whole structure of the low - temperature phase , including its fluctuations ( it is important to notice that the @xmath30 do fluctuate , even in the thermodynamical limit  @xcite ) .        the study of such a complicated phase is made manageable by the observation that the geometry of the space of equilibrium states is ultrametric and thus can be organized in a hierarchical tree  @xcite . in order to understand what this means ,",
    "let us consider a simplified example where @xmath29 is discrete and the overlap can only take four different values @xmath31 ( this is equivalent to the solution with @xmath32 rsb steps ) .",
    "we can see a schematic representation of such a tree in figure  [ fig : arbol ] .",
    "the ultrametric structure of the @xmath26 means that we can represent the spin - glass phase as a taxonomic tree of states , where the overlap between @xmath33 and @xmath34 depends only on their closest common ancestor .",
    "the first consequence of this is that the self - overlap is state - independent , @xmath35 a second consequence is that we can group the states in clusters ( states with overlap @xmath36 ) and superclusters ( states with overlap @xmath37 ) .",
    "therefore , we can make the decomposition of eq .",
    "( [ eq : decomposed - average ] ) in terms of clusters @xmath38 : @xmath39    of course , the real tree of states of a mean - field spin glass is more complicated than the representation in figure  [ fig : arbol ] : the real function @xmath29 is continuous , so there are infinitely many overlap levels ( the tree branches out at any value of @xmath2 from @xmath40 up to @xmath41 ) and , moreover , there are infinitely many branches at any level .",
    "notice , however , that the ultrametric structure preserves the decomposition of  ( [ eq : cluster - average ] ) , which now can be made arbitrarily for any value of @xmath2 ( the only intrinsic decomposition being that at the state level , i.e. , at @xmath42 ) .    in keeping with the tree metaphor , throughout the paper we shall also refer to the clusters of states at an arbitrary level @xmath2 ( including their subclusters ) as the ` branches ' and to the states as the ` leaves ' .",
    "the analytical study of this infinite tree was first performed by mzard , parisi and virasoro ( see  @xcite ) and then formalized in terms of ruelle s probability cascades  @xcite .",
    "for instance , the probability distributions for the weights at any level @xmath2 can be written as  @xcite : @xmath43 notice how the sample - averaged function @xmath29 controls the fluctuations .",
    "these weights have an immediate physical meaning , but they are cumbersome to handle , because they are not independent ( @xmath44 .",
    "however , we can obtain a simpler representation of the tree statistics by going back to the free - energy fluctuations , as defined in  ( [ eq : w - f ] ) . indeed , as it turns out , the @xmath45 are independent variables  @xcite @xmath46 in fact , we can perform the analogous operation at any level of @xmath2 : @xmath47 again , we see that this construction is universal , in the sense that everything is encoded in the function @xmath29 .    our aim in this study is the explicit generation of trees of states for mean - field spin glasses .",
    "naturally , since we can not deal numerically with infinite trees , we will need to introduce two approximations :    1 .",
    "discretize the function @xmath29 .",
    "this is not a very delicate step as long as we keep the correct @xmath48 : the branching levels are arbitrary and we just have to keep a sufficient number of branching steps to represent the @xmath29 function faithfully . in keeping with the usual nomenclature",
    ", we shall occasionally refer to a tree with @xmath49 branching levels as a solution with @xmath49 rsb steps .",
    "2 .   we have to _ prune _ the tree in order to have a finite number of states .",
    "this second step seems dangerous , but it can be controlled quite easily  @xcite . in particular , it is easy to see that the total number of states with @xmath50 increases as @xmath51 . therefore , if we study the system with resolution @xmath52 , neglecting all the states with @xmath53 , we are losing a total probability of @xmath54 . in the following section",
    "we describe how to generate an explicit realization of this pruned tree .",
    "rsb steps . at each step",
    "we generate new branches of the tree and discard all the branches ( clusters of states ) with weight @xmath55 smaller than a cutoff @xmath52 ( represented with red dotted lines in the figure ) .",
    "the other branches are kept and used to generate new subclusters , which are in turn pruned .",
    "the process is iterated until we reach the highest value of the overlap , which defines the classification of the system in pure states .",
    "since the weight of a state is always smaller than the weight of the branch that leads to it , this process is equivalent to discarding all the states with weight @xmath56 .",
    "the tree pruned in such a way will lose a total probability of @xmath54 .",
    "[ fig : arbol - podado ] ]",
    "in the previous section we saw how one can achieve a mathematical description of the tree of states independently for any given level ( i.e. , at any value of @xmath57 ) .",
    "however , in this study we are not interested in the statistics of isolated levels of the tree , but in the explicit generation of its whole structure , i.e. , the whole set of @xmath58 . to this end",
    ", we shall construct an iterative representation of the tree , starting with the trunk and branching out step by step down to the individual states . at each step",
    ", we shall have a collection of clusters of states with weights @xmath55 .",
    "we shall then discard all the clusters with weight @xmath59 ( this is stricter than discarding all the states with @xmath56 ) and then , for each cluster , generate its subclusters . at each step",
    "we shall keep the whole structure of the tree ( i.e. , the lists of ancestors for each subcluster ) . figure  [ fig : arbol - podado ]",
    "shows a schematic representation of such a pruned tree .    in this section",
    "we explain how such a construction can be attempted , starting with the simplest case where @xmath2 can only take two different values ( one step of rsb ) and then generalizing to @xmath49 rsb steps and to the continuous limit .",
    "our algorithm is based on a description of the tree along the lines sketched in the previous section , see  @xcite for a different approach to the construction of random recursive trees .",
    "let us start by considering the construction of the pruned tree in the 1-rsb case , where the overlap can only take two values .",
    "@xmath60 where it is assumed that the parameter @xmath61 is less that one and @xmath62 is just the inverse of the function @xmath29 of eq .",
    "( [ eq : x ] ) .",
    "we have , then , a very simple tree @xmath63    the weights can be constructed in the following way .",
    "remembering  ( [ eq : probf ] ) , we consider a poisson point process with a probability @xmath64 $ ] .",
    "more precisely we extract numbers on the line where the probability of finding a point in the interval @xmath65 $ ] is given by @xmath66 { \\mathrm{d}}f\\ , .\\ ] ] if we label these points with an index @xmath33 we can set @xmath67 the weights generated in this way have the correct probability distribution",
    ". a few comments are in order :    * the construction is consistent , i.e. , @xmath68 and @xmath69 . *",
    "the distribution is stochastically stable : if we set @xmath70 , where the @xmath71 are identically independent distributed variables , the probability distribution of the @xmath72 is the same ( apart from a variation of @xmath73 ) and the probability distribution of the @xmath74 s does not change . *",
    "if we prune the tree and we consider only the states such that @xmath75 , we have that @xmath76 with @xmath77 . * the parameters @xmath73 and @xmath34 are irrelevant from the numerical point of view .",
    "they are introduced only for later use and for the physical interpretation ( remember section  [ sec : tree ] ) . * if we consider a process where the @xmath45 are restricted in the interval @xmath78 $ ] ( which is simpler to generate numerically ) the probability distribution of the @xmath20 converges to the right one in the limit @xmath79 . *",
    "the @xmath20 can be easily generated numerically .",
    "one extracts @xmath80 numbers @xmath81 with a a flat distribution in the interval @xmath82 $ ] .",
    "then we set @xmath83 and @xmath84 the ratio of the largest to the smaller value of the @xmath74 s is of order @xmath80",
    ". the parameter @xmath80 ( fixing the maximum number of descendants for each node ) plays the same role as @xmath52 with @xmath85      now consider a tree with two steps of rsb , that is , when @xmath62 has two discontinuities .",
    "we have @xmath86    in this case we can simply generalize the previous equations and we can label the states by a pair of indices @xmath87 ( cluster ) and @xmath88 ( state within each cluster ) .",
    "we now have @xmath89 where @xmath90 is a shorthand notation for @xmath91 .",
    "the weights are given by @xmath92 with @xmath93 where the @xmath94 are generated with a density @xmath95 and the @xmath96 are generated with a density @xmath97 .",
    "the construction is quite simple and it can be generalized to any number of levels , adding a new term and a new index to the free energy at each step .",
    "however , the limit where the number @xmath49 of levels goes to infinity is mathematically complicated .",
    "in fact , the mere existence of such a limit ( proved by ruelle  @xcite ) is non - trivial .",
    "it is already not evident in the two - step case that , in the limit where @xmath98 , the dependence on @xmath99 disappears and we recover the one - step formulae .    in any case , from a numerical point of view the most serious problem is that the number of random free energies goes as @xmath100 , which rapidly explodes , even noticing that in the limit @xmath101 we can take @xmath102 .    to put it in another way , as discussed in section  2 we can define the weight of a cluster @xmath87 as the sum of the weights of all its states , @xmath103 but notice that now we can not know the value of this weight just from the set of @xmath94 without having also the @xmath96 : two clusters with the same value of @xmath94 may end up with different weights at the end of the process and , therefore",
    ", we can not discard any cluster until we have generated the whole tree down to the states .",
    "the states with the largest weight may not belong to the clusters with the lowest @xmath104 .",
    "we need to find a different decomposition of the state free energy so that the relationship  ( [ eq : weight - f ] ) can be applied at each step in the construction of the tree and the @xmath104 for each cluster can be understood as a `` cluster free energy '' in the sense of  ( [ eq : probf ] ) .",
    "we present here an alternative way to generate the weights that does not suffer from these shortcomings .",
    "let us consider a tree discretized for @xmath105 values of @xmath2 , from @xmath106 to @xmath107 .",
    "we start by generating all the clusters at level @xmath106 following equation  ( [ onestep ] ) , with @xmath108 .",
    "this gives us a set of cluster weights @xmath109 .",
    "the next step is generating a set of weights @xmath110 at level @xmath99 , with the constraint that each @xmath109 must be the sum of the weights of its subclusters .",
    "that is , we parameterize the @xmath110 as @xmath111 where the @xmath112 satisfy the constraint : @xmath113 finally , we write @xmath114 now the @xmath96 have a slightly different interpretation to the ones in the previous section .",
    "the most important difference is that the new quantities are not independent , since they are constrained to belong to the same cluster @xmath87 .",
    "the probability distribution of the @xmath96 can be found in the literature , see eq .",
    "( 14 ) in  @xcite : @xmath115 in this equation , we have defined @xmath116 , @xmath117 .",
    "let us now see how we can construct a numerical method to generate these @xmath96 according to  ( [ eq : ph ] ) .",
    "the first step , as already discussed in section  [ sec : onestep ] is to consider a maximum number @xmath80 of subclusters .",
    "then , we order the @xmath96 so that @xmath118 is the lowest and we rewrite  ( [ eq : ph ] ) as @xmath119 c(\\{g\\ } ) , \\label{eq : subclusters}\\ ] ] where we have used a single index @xmath120 for the @xmath121 to lighten the notation and @xmath122^{m_1}.\\ ] ] in order to discuss this equation , let us first assume @xmath123 and let us define @xmath124 . we then find that the density of the @xmath125 for @xmath126 is cutoff at @xmath127 , while the density of @xmath128 has a cutoff at @xmath129",
    "therefore , for small @xmath130 the quantity @xmath131 will be of order @xmath132 aside from events that have probability @xmath130 .",
    "let us now discuss the delicate point of how to generate these @xmath80 values of @xmath125 in the correct way using a monte - carlo - like algorithm ( i.e. , through repeated random suggestions until one is accepted with a given probability ) .",
    "we start by considering the case where we put @xmath123 .    1 .",
    "we generate the @xmath133 free energies for @xmath126 in the region @xmath134 $ ] with a probability proportional to @xmath135 .",
    "we generate @xmath136 in the region @xmath134 $ ] with a probability proportional to @xmath137 .",
    "3 .   we need that @xmath136 be the smallest one , i.e. , @xmath138",
    ". if @xmath136 is not the smallest we go back to point 1 and we repeat until success .    in order to estimate the goodness of the algorithm we have to know the probability that the suggestion is accepted .",
    "the condition can be written also as @xmath139 , where @xmath140 .",
    "the probability of this event is @xmath141 .",
    "now , for large @xmath80 we have that @xmath142 ( the minimum of @xmath80 variables does not fluctuate when @xmath80 goes to infinity ) .",
    "we conclude that the acceptance probability goes to zero as @xmath143 , where @xmath144 is less that one .",
    "we have to take care now of the factor @xmath145 .",
    "it is evident that @xmath146 .",
    "we can thus interpret @xmath147 as a probability .",
    "therefore , in order to take @xmath148 into account we only accept the suggestion of the previous three steps with a probability @xmath147 . in this case",
    "the acceptance rate will be greater that @xmath149 .",
    "the strategy works and there is a slowing factor of the algorithm due to the rejection that increases as a power of @xmath80 less that one .    in the limit @xmath150 , the average value of the acceptance of the first step goes to 1 , the acceptance of the second one @xmath149 and the distribution becomes concentrated on the case where one of the @xmath112 is one and the others are zero , thus recovering the 1rsb process .    obviously ,",
    "once we have the subclusters at level @xmath99 we can iterate the same construction until we reach level @xmath107 .",
    "this new algorithm is more complicated than the one in section  3.2 , but has the considerable advantage that now we can perform a preemptive pruning of the tree at each step to avoid the the explosion of terms in the limit @xmath151 .",
    "we simply discard all the subclusters that have a weight less that @xmath52 ( i.e. , those with @xmath152 ) . in this way",
    "we eventually generate consistently all the states that have weight greater than @xmath52 . at each step we are considering a fixed number @xmath80 of descendants ,",
    "most of which will be pruned . in this way",
    "the complexity is of order @xmath153 and diverges only in a linear way when @xmath130 goes to zero .",
    "the error on the final results is also a monomial in the control parameters @xmath80 , @xmath130 and @xmath154 ( its precise form depends on the observables ) , so that we have reached our goal of generating the hierarchical tree in a polynomial time .",
    "however , there is still ample space for improvements , which will be described in  [ sec : tricks ] . at the end of the day",
    "the computational complexity can be reduced just to @xmath155 or , in other words , to the number of leaves , which is clearly the best achievable .",
    "finally , we must keep in mind that this method describes the generation of a single tree ( sample ) . in order to obtain physically meaningful results we have to generate many trees in order to perform the average over the disorder .",
    "so far we have seen how , starting from a known function @xmath62 we can generate the complete tree of states , which in itself already gives us a lot of information on the spin - glass phase ( see section  [ sec : application ] ) . in this section",
    "we show how to exploit this tree to compute more sophisticated physical quantities employing a cavity approach  @xcite and how we can use this cavity step in order to reweight the tree .",
    "this in principle allows us to compute the , initially unknown , correct @xmath62 .",
    "let us start from a nearly infinite system ( of size @xmath156 ) with @xmath49 steps of rsb and let us add a new spin @xmath157 to the system .",
    "we assume that connected correlation functions inside a state are negligible among generic points ( cluster decomposition property ) .",
    "we define the effective magnetic field on the new spin in a state @xmath33 as @xmath158 for later uses we assume that the @xmath159 are i.i.d .",
    "random variables with zero average and variance @xmath9 .",
    "let us consider a given system of size @xmath156 with weight values @xmath20 ( that are ordered in a decreasing way ) .",
    "it is well known @xcite that one can solve the model using the cavity approach where the properties of the system with @xmath160 variables are related to those of the system with @xmath156 variables through the following recursive relations @xmath161 where @xmath162 is the magnetization of the new spin , @xmath20 and @xmath163 are the unnormalized weights of state @xmath33 respectively in the @xmath156 variables and @xmath160 variables systems . as usual",
    ", we are assuming a one - to - one correspondence between states for low energy in the two systems .",
    "it is evident that the overlaps @xmath164 have changes only of order @xmath9 . in principle",
    ", the probability distribution of the @xmath165 might be different from the probability distribution of the @xmath20 .",
    "moreover , the @xmath20 depend on the @xmath166 , so that the @xmath165 and the @xmath166 may be correlated . however , this does not happen if we start from the previously presented distribution of the @xmath20 . in order to understand this , let us first notice that the @xmath166 are random gaussian variables with zero averages and covariances @xmath167 we do not need to know the values of the @xmath168 .",
    "the only information we need is @xmath169 it is worth noticing at this stage we can forget the value of @xmath156 .",
    "fortunately stochastic stability implies that the probability distribution of the @xmath165 ( ordered ) is the same of that of the @xmath20 and that the @xmath166 are uncorrelated to the @xmath165 @xcite .",
    "we can now impose the self - consistent condition that if we take two states @xmath33 and @xmath170 that have overlap @xmath2 , then the average overlap of the new spin will be also @xmath2 : @xmath171 the result should not change if we add further conditions on the values of the @xmath20 .",
    "we can now proceed in two different directions :    * we evaluate the l.h.s . of eq .",
    "( [ cavity ] ) in an analytic way . in the case of a finite number of steps ,",
    "we can write an explicit expression in terms of nested integrals @xcite that collapses to the solution of a parabolic differential equation in the @xmath101 limit . * in the same way that it has been done  @xcite in the one - step ( and sometimes in the two - step ) rsb on the bethe lattice we can impose equation ( [ cavity ] ) by evaluating the l.h.s . by generating both the trees and the @xmath166 numerically and computing the average over different distributions .    here",
    "we will follow this second approach .",
    "our motivations are the following :    * we believe that such a cavity computation may be useful to understand the physical meaning of full rsb .",
    "* this full rsb cavity computation may be a first step towards the full rsb cavity computation in the bethe lattice , where a replica computation is not available .",
    "* we plan to compute the loops corrections to mean field theory using the cavity approach .",
    "the computation of the loop expansion is a longstanding problem and in spite of the great progresses done in the replica approach , we do not know the infrared behavior of the one loop corrections .",
    "this long alternative cavity approach may be a viable tool to overcoming this difficulty .",
    "let us discuss the numerical implementation of the previous approach .",
    "we start by generating the @xmath20 as discussed in section  [ sec : generation ] .",
    "the generation of the @xmath166 , following  ( [ eq : h ] ) , is trivial .",
    "we can extract a gaussian random variable for each piece of the branch and add the different terms .",
    "that is , each state @xmath33 will have an associated cavity field @xmath166 @xmath172 the first term , @xmath173 is actually common to the whole tree and is extracted from a gaussian distribution with variance @xmath174 . then each of the @xmath175 is extracted from a gaussian distribution with variance @xmath176 and is common to all the states along the same branch .",
    "the last piece , @xmath177 , is individual for each state .",
    "the main problem comes from pruning , which is not stable to the reweighting .",
    "if the initial tree was pruned at a level @xmath52 , this will not happen after the reweighting",
    ". some of the @xmath165 will be smaller than @xmath52 and some states in the region with @xmath165 near to @xmath52 will be missing . only the part of the tree that is far form the boundary ( in a log scale ) will remain accurate under the pruning .    at the end of the day we get the equation : @xmath178 where @xmath179 can be chosen arbitrarely .",
    "the simplest choice @xmath180 is however not good , because it is dominated by the many states of small weigth ; in order to concentrate the measure on the high @xmath74 states we use @xmath181 but other different choices are possible .",
    "we also notice that a smoothing over the @xmath2 values is also necessary , since we can not impose numerically a strict delta function .",
    "the computation in the zero - temperature limit is quite similar : @xmath182 the self - consistency equation becomes ( with an appropriate choice of the function @xmath183 ) : @xmath184 in order for the previous equation to be dominated by the region where an accurate evaluation of the modified energies is available we must have that @xmath185 should be very small .",
    "the value of @xmath186 should be tuned as function of the details of the simulation and of the value of the cutoff energy @xmath187 ; systematic errors decreases with increasing @xmath186 , but statistical errors increase , so a compromise is needed .",
    "we have described how to generate the whole tree knowing @xmath62 . in section  [ sec : cavity ]",
    "we also described how we can use a reweighting method to refine our values for the @xmath164 ( and , thus , for the overlaps @xmath188 at the predefined branching levels @xmath189 ) . in this section",
    "we test the consistency of this program .",
    "we check that the correct @xmath62 for the chosen working temperature is stable and also that the tree it produces has the expected structure .",
    "finally , we explore the dependence of the result on parameters such as @xmath52 . throughout this section ,",
    "we use the large-@xmath80 modification of the program , as described in  [ sec : tricks ] .",
    "let us start by considering the model at @xmath190 , close to the critical point @xmath13",
    ". in these conditions , @xmath62 is linear with very good approximation .",
    "this linearity simplifies matters because we only need two parameters to fix the whole @xmath62 function : @xmath191 and @xmath192 . in order to calculate @xmath62 from the trees ,",
    "the steps would be    1 .",
    "find the correct @xmath193 for a fixed @xmath194 ( i.e. , the fixed point for the iterative method described in section  [ sec : cavity ] ) and compute the free energy @xmath195 .",
    "2 .   minimize @xmath195 to find the correct @xmath194 .",
    "the first step is the more interesting one , since it will let us explore the properties of the numerical tree and its dependence on the parameters @xmath49 and @xmath52 .",
    "therefore , in the following we are going to work with the known @xmath196 ( this value has been computed with a pad resummation technique and is accurate to six significant figures  @xcite ) .       along the iterative reweighting of the tree at @xmath190 ,",
    "starting with @xmath197 in a linear ( _ top _ ) and a logarithmic ( _ bottom _ ) scale .",
    "we use @xmath198 , @xmath199 and @xmath200  @xcite .",
    "the approach to the correct value @xmath201 ( horizontal line ) is very slow.[fig : q23],title=\"fig : \" ]   along the iterative reweighting of the tree at @xmath190 , starting with @xmath197 in a linear ( _ top _ ) and a logarithmic ( _ bottom _ ) scale .",
    "we use @xmath198 , @xmath199 and @xmath200  @xcite .",
    "the approach to the correct value @xmath201 ( horizontal line ) is very slow.[fig : q23],title=\"fig : \" ]    for this first example , we are going to work with @xmath199 , so we are going to keep @xmath202 of the probability .",
    "also , since @xmath62 is linear , a relatively small value of @xmath198 should be sufficient . in the next sections we shall examine the effect of varying these parameters .",
    "we are going to denote by @xmath203 the value of @xmath188 at iteration @xmath204 . in order to kick off the computation",
    "we start with @xmath205 . in each iteration",
    "we generate and average over @xmath206 trees ( with the parameters described above , this takes only about 2 min per iteration on a single cpu ) . the result for @xmath207",
    "can is shown in figure  [ fig : q23 ] .    , but now we consider several values of @xmath208 to try to find the stable one ( we use , from bottom to top , @xmath209 ) . a few steps",
    "are enough to know whether our @xmath208 is above or below the correct one .",
    "once we find a good @xmath208 , convergence is very fast : with @xmath210 we obtain @xmath211 , to be compared to @xmath201  @xcite .",
    "[ fig : q],title=\"fig : \" ] , but now we consider several values of @xmath208 to try to find the stable one ( we use , from bottom to top , @xmath209 ) .",
    "a few steps are enough to know whether our @xmath208 is above or below the correct one .",
    "once we find a good @xmath208 , convergence is very fast : with @xmath210 we obtain @xmath211 , to be compared to @xmath201  @xcite .",
    "[ fig : q],title=\"fig : \" ]    from the figure , we can see right away that this is not a workable method : the convergence of @xmath207 is very slow ( logarithmic ) . at the same time",
    ", the monotonic behavior of @xmath207 suggests an alternative approach : start several simulations with different values of @xmath208 and find the stable one .",
    "we have followed this method in figure  [ fig : q ] .",
    "we show several simulations , with values of @xmath208 in increments of @xmath212 . in each case , we have taken @xmath213 steps , although clearly only a few are necessary to know whether we are above or below the stable @xmath193 .",
    "this new approach does work : with an ( easy to find ) good starting value of @xmath210 we obtain @xmath211 , remarkably close to the exact value of @xmath201 ( see fig .  [",
    "fig : q ] ) . finally ,",
    "although we have concentrated on @xmath193 , the whole @xmath62 converges to the right one .",
    "we have seen that the reweighting method is able to find the correct @xmath62 .",
    "we still have to test whether this @xmath62 , in turn , generates a tree with the properties expected in the rsb theory . to this end",
    ", we consider the computation of the spin - glass susceptibility  @xcite @xmath214 this quantity diverges for @xmath215 so , in the denominator , @xmath216 in terms of the trees , this equation can be written as @xmath217 where @xmath218 has been defined in section  [ sec : cavity ] and we remind the reader that the disorder average translates into an average over different realizations of the tree .    ,",
    "defined in  ( [ eq : x ] ) , which must be @xmath219 if the spin - glass susceptibility  ( [ eq : chisg ] ) is to diverge . starting with @xmath210 we obtain @xmath220.[fig :",
    "x ] ]    we can see the evolution of @xmath221 for three different values of @xmath208 in figure  [ fig : x ] .",
    "for @xmath210 we obtain @xmath220 , which is remarkably precise given the complicated structure of  ( [ eq : x ] ) .",
    "we have seen that the numerical method described in this paper is able to generate stable trees with the correct structure .",
    "thus far , we have worked with fixed values of @xmath198 and @xmath199 for the numerical parameters that determine the degree of discretization of the tree and the extent of its pruning , respectively . in this section",
    "we examine the effect of varying these quantities .",
    "let us start by considering the dependence on @xmath49 , the number of rsb steps ( or of different values of @xmath2 ) .",
    "we have carried out simulations for @xmath49 ranging from @xmath222 to @xmath198 . in each case , we have used @xmath210 as our starting value and we have performed 200 reweighting steps , to ensure that the final values are stable .",
    "we report in table  [ tab : k ] the resulting estimates for @xmath193 and @xmath221 ( the latter are also plotted in figure  [ fig : rep - k ] ) .",
    "as we can see , the convergence to the right values is very smooth in @xmath49 and can be controlled .",
    "in particular , it is clear that the value @xmath198 that we have been using thus far is more than adequate .",
    "rll @xmath49 & & + 2 & 0.16487(9 ) & 1.0101(7 ) + 4 & 0.16696(14 ) & 1.0049(7 ) + 8 & 0.1685(3 ) & 1.0020(7 ) + 12 & 0.1694(3 ) & 1.0009(7 ) + 16 & 0.1688(6 ) & 1.0007(7 ) + 20 & 0.1696(3 ) & 0.9999(6 ) + @xmath223 & @xmath224 & @xmath225 +     with the numbre @xmath49 of rsb steps , starting with @xmath208 .",
    "we take 200 reweighting steps , after which the estimate of @xmath62 is stable .",
    "the value converges smoothly and quickly to the expectation @xmath219 .",
    "[ fig : rep - k ] ]    cll @xmath52 & @xmath226 & @xmath227 + @xmath228 & 0.1668(5 ) & 1.0047(6 ) + @xmath229 & 0.1682(4 ) & 1.0011(6 ) + @xmath230 & 0.1696(3 ) & 0.9990(6 ) + @xmath231 & 0.1689(5 ) & 1.0005(6 ) + @xmath232 & 0.1696(3 ) & 0.9999(6 ) + @xmath233 & @xmath224 & @xmath225 +     with the pruning factor @xmath52 , starting with @xmath208 .",
    "we take 200 reweighting steps , after which the estimate of @xmath62 is stable .",
    "the value converges to the correct one ( horizontal line ) for moderate values of this parameter .",
    "[ fig : qmax - eps ] ]    in table  [ tab : epsilon ] and figure  [ fig : qmax - eps ] we report the same quantities for simulations with different values of @xmath52 .",
    "as we can see , even relatively coarse prunings produce rather accurate trees .    in summary ,",
    "the dependence of the algorithm s accuracy on the numerical parameters @xmath52 and @xmath49 is smooth and could be controlled in an eventual computation where the correct @xmath62 were unknown .",
    "for the sherrington - kirkpatrick ( data from  @xcite ) and the edwards - anderson ( data from  @xcite ) models .",
    "since the critical parameters of the two systems are different , we choose temperatures such that the @xmath29 are similar for small @xmath2 ( @xmath234 for sk and @xmath235 for ea ) .",
    "[ fig : pq],title=\"fig : \" ]   for the sherrington - kirkpatrick ( data from  @xcite ) and the edwards - anderson ( data from  @xcite ) models .",
    "since the critical parameters of the two systems are different , we choose temperatures such that the @xmath29 are similar for small @xmath2 ( @xmath234 for sk and @xmath235 for ea ) .",
    "[ fig : pq],title=\"fig : \" ]    we have a consistent method to generate the tree of states . in the previous section we have seen how it can be used to compute @xmath62 for the sk model in a self - consistent manner .",
    "however , this is not our ultimate goal ( there already are good methods to achieve this ) .",
    "instead , we would like to use the detailed information contained in the tree to deepen our understanding of the spin - glass phase . in this section",
    "we give an example of a simple application with physical relevance .",
    "we have been working from the outset with the mean - field sherrington - kirkpatrick model .",
    "it has been a longstanding debate in the community whether the @xmath6 version of the model ( the edwards - anderson spin glass ) has a similar behavior .",
    "the edwards - anderson spin glass is defined in a similar way as  ( [ eq : hsk ] ) , @xmath236 but now the interaction are only between nearest neighbors ( as denoted by the angle brackets in the sum ) and the @xmath8 are @xmath237 with @xmath238 probability .    like the sk model ,",
    "the ea spin glass system experiences a second - order phase transition  @xcite , in this case at temperature @xmath239  @xcite .",
    "however , the details of its low - temperature phase are still disputed . in particular ,",
    "a basic question is whether the @xmath4 in @xmath6 is still non - trivial , as in the rsb picture , or whether there is only one state with @xmath42 , so the @xmath4 is reduced to a single delta , as proposed by the droplet picture  @xcite .    thus far",
    ", most numerical simulations ( see , e.g. ,  @xcite for a detailed investigation ) seem to point to the first option .",
    "we can see an example of this in figure  [ fig : pq ] : both for the ea and sk cases , the value of @xmath240 does not seem to evolve with the system size . for ea",
    "we use data generated with the janus computer  @xcite in  @xcite . for sk",
    "we use data from the simulations reported in  @xcite .     with the system size @xmath156 for the ea ( @xmath235 ) and sk ( @xmath234 ) models .",
    "[ fig : delta_sem ] ]    however , it has been argued that this approach is too naive , because the @xmath4 may be in a preasymptotic regime ( as suggested by the strong evolution of the peak ) . as a consequence ,",
    "several recent works have taken a more detailed approach , based on the study of the single - sample @xmath1  @xcite .",
    "in particular , yucesoy _ et al . _  @xcite",
    "propose studying the following quantity @xmath241.\\ ] ] as we have seen in section  [ sec : tree ] , @xmath242 when @xmath243 for any finite @xmath106 in the sk model ( because there are always states with @xmath244 ) , while for a droplet system @xmath130 should go to zero for large system sizes .",
    "if we represent this quantity ( figure  [ fig : delta_sem ] ) we can see that @xmath130 grows much more slowly with @xmath156 in the ea model than in the sk one ( even though it does not seem to go to zero , as predicted by the droplet model ) .",
    "unfortunately , the larger statistical error in the largest size available for ea , @xmath245 , makes it difficult to draw any direct conclusion from this figure .",
    "since , as we saw in section  [ sec : tree ] , the sample - averaged @xmath4 controls the statistics of the fluctuations , we have compared the two systems for temperatures where the @xmath29 are similar ( see figure  [ fig : pq ] ) .",
    "it has been proposed in  @xcite that the reason for the slower growth of @xmath130 in ea is simply the slower evolution of the main peak , @xmath246 , in this system .",
    "indeed , @xmath247 with @xmath248 for sk but @xmath249 for ea  @xcite ( the slower growth of the peak for ea can be seen graphically in figure  [ fig : pq ] ) .",
    "now , if the individual peaks in the @xmath1 grew at the same rate , this would explain the apparent different behavior of @xmath130 in the two models .",
    "we can use the numerical trees to explore this suggestion in detail .",
    "let us go back and consider the expression of @xmath1 in terms of the trees ( in the thermodynamical limit ) @xmath250 where the lack of a disorder average signifies that we are considering a single realization of the tree ( which would translate into a single sample in a more physical language ) .",
    "now , we can introduce a very simple model for the finite - size evolution of this @xmath30 .",
    "we are going to consider that , for finite @xmath156 , the delta functions are smoothed to have a finite width @xmath251 , independent of @xmath2 ( a similar approach was followed in  @xcite in a slightly different context ) .",
    "in addition , their position is shifted as @xmath252 where @xmath253 is a gaussian random variable with standard deviation @xmath251 .",
    "the value of @xmath251 should go to zero as a power of @xmath156 @xmath254 where @xmath255 is a constant .",
    "now , since we are assuming that @xmath251 is independent of @xmath2 , we can use the self - averaging peak at @xmath42 to fix @xmath256 and @xmath255 .",
    "we see immediately that @xmath257 , since @xmath258 should be constant for large @xmath156 . in order to fix",
    "@xmath259 we only need to consider  ( [ eq : pj2 ] ) @xmath260 where @xmath261 is the weight of the delta function at @xmath42 ( so @xmath262 in the notation we have used in previous sections )",
    ". we can know @xmath263 from the exact solution in the thermodynamical limit and we can get @xmath255 from a fit to numerical data for finite @xmath156 . for @xmath234",
    "the values are @xmath264  @xcite and @xmath265 ( from a fit to the data in  @xcite ) .     and cumulative probability @xmath266 for the sk model at @xmath234 .",
    "we show the result of a monte carlo simulation at finite @xmath156 together with the ` synthetic ' functions generated from the smoothed trees ( the latter have much smaller statistical errors , which we do not show in the figure ) . using the very simple smoothing procedure described in this section ,",
    "we obtain a very accurate @xmath267 for small @xmath2 .",
    "[ fig : p_n4096],title=\"fig : \" ]   and cumulative probability @xmath266 for the sk model at @xmath234 .",
    "we show the result of a monte carlo simulation at finite @xmath156 together with the ` synthetic ' functions generated from the smoothed trees ( the latter have much smaller statistical errors , which we do not show in the figure ) . using the very simple smoothing procedure described in this section ,",
    "we obtain a very accurate @xmath267 for small @xmath2 .",
    "[ fig : p_n4096],title=\"fig : \" ]     as a function of @xmath106 for several values of @xmath268 and @xmath269 at @xmath234 . for @xmath270",
    "we include the results for @xmath271 .",
    "for the smaller sizes we do not include the last value , since the value of @xmath272 in that case would be too small and , therefore , even for @xmath273 we @xmath274 , which is clearly a preasymptotic effect . for large system size",
    ", the @xmath130 generated from the trees is very accurate . as in figure",
    "[ fig : p_n4096 ] , the statistical errors in the curves computed from the trees are one order of magnitude smaller . [",
    "fig : delta_n4096],title=\"fig : \" ] +   as a function of @xmath106 for several values of @xmath268 and @xmath269 at @xmath234 . for @xmath270",
    "we include the results for @xmath271 .",
    "for the smaller sizes we do not include the last value , since the value of @xmath272 in that case would be too small and , therefore , even for @xmath273 we @xmath274 , which is clearly a preasymptotic effect . for large system size",
    ", the @xmath130 generated from the trees is very accurate . as in figure",
    "[ fig : p_n4096 ] , the statistical errors in the curves computed from the trees are one order of magnitude smaller . [",
    "fig : delta_n4096],title=\"fig : \" ] +   as a function of @xmath106 for several values of @xmath268 and @xmath269 at @xmath234 . for @xmath270",
    "we include the results for @xmath271 .",
    "for the smaller sizes we do not include the last value , since the value of @xmath272 in that case would be too small and , therefore , even for @xmath273 we @xmath274 , which is clearly a preasymptotic effect . for large system size",
    ", the @xmath130 generated from the trees is very accurate . as in figure",
    "[ fig : p_n4096 ] , the statistical errors in the curves computed from the trees are one order of magnitude smaller . [",
    "fig : delta_n4096],title=\"fig : \" ]    with this information , we are in a position to generate ` synthetic ' @xmath1 for finite @xmath156 from our numerical trees . in particular , we take the following steps    1 .   input the exact solution for @xmath62 at @xmath234 from  @xcite , and generate @xmath275 trees .",
    "there is no need to consider the reweighting iterations , since we are already starting from the correct @xmath62 .",
    "2 .   for each tree , knowing the values of @xmath20 and @xmath26 , we can construct the corresponding @xmath30 in the thermodynamical limit with  ( [ eq : pj2 ] ) .",
    "3 .   for each tree",
    ", construct the finite-@xmath156 version of @xmath30 using @xmath276 , as obtained above .",
    "since we are only interested in relatively big peaks and @xmath277 , a relatively coarse pruning suffices ( we use @xmath278 , we have checked that @xmath279 would have yielded compatible results ) . since",
    "now the @xmath62 is not linear , we need a finer discretization , so we use @xmath280 .",
    "we generate @xmath281 trees .",
    "notice that when generating the finite-@xmath156 @xmath30 the only adjustable parameters are @xmath186 and @xmath255 , which we have fixed _ a priori_.",
    "let us now look at the numerical results . in order to test our smoothing procedure",
    ", we are first going to check whether the average of the smoothed @xmath282 reproduces the sample - averaged @xmath283 computed in monte carlo simulations .",
    "we show the result for our largest available system , @xmath270 , in figure  [ fig : p_n4096 ] .",
    "as we can see , the @xmath284 is remarkably accurate for small @xmath2 , even if it deviates close to @xmath193 ( this was to be expected , in particular our simple smoothing model does not represent well the shift in the peak s position with growing @xmath156 ) .",
    "more interestingly , the cumulative probability @xmath29 is very accurate ( this is a better - behaved function , which avoids the singularity at @xmath42 ) .",
    "we are finally in a position to generate @xmath285 from the trees .",
    "the result for @xmath286 and @xmath287 is shown in figure  [ fig : delta_n4096 ] .",
    "as we can see , for the larger system size the agreement between the ` synthetic ' @xmath130 generated from the trees and the one computed in mc simulations is excellent for a wide range of @xmath268 .",
    "the agreement is not as good for the smaller @xmath156 , which was to be expected .",
    "this analysis already explains the slower growth of @xmath130 in ea compared to sk , simply because @xmath288 for the latter and @xmath289 for the former .",
    "reference  @xcite goes a little farther and attempts to introduce a scaling ansatz for @xmath130 that could be used to compare the results in ea and sk .     for ea and sk ( results from  @xcite).,title=\"fig : \" ]   for ea and sk ( results from  @xcite).,title=\"fig : \" ]    indeed",
    ", @xmath290 is just the probability of finding a peak with weight @xmath291 . in the ( very rough ) assumption",
    "that there is only one relevant peak in @xmath244 , we can integrate in  ( [ eq : prob - w ] ) to estimate @xmath292^{-x(q_0 ) } = [ \\mathcal a n^\\lambda /\\kappa]^{-x(q_0)}.\\ ] ] this is a very simplified scaling , but could be used to compare ea and sk on equal grounds . in particular , for ea , as for sk , we could estimate @xmath255 from the scaling of @xmath293 , as in  ( [ eq : a ] ) .",
    "unfortunately , for ea we do not know the value of @xmath263 , so the best we can do is assume that @xmath294 .",
    "in  @xcite it was found that this scaling works reasonably well for the range of simulated system sizes ( we reproduce the result of  @xcite in figure  [ fig : delta - scaling ] ) .",
    "the investigation of this scaling in  @xcite was limited to the range of @xmath156 accessible to mc simulation . however , with the trees we have in principle access to much higher values of @xmath156 . in figure",
    "[ fig : delta - asintotico ] we show the same scaling plot including both mc data up to @xmath270 and the results from the smoothed trees up to @xmath295 . , but at some point the rough pruning that we have used will show its effects . ] as we can see , the more precise results of the trees show that the scaling of  ( [ eq : delta - scaling ] ) , while a good first approximation , reveals its flaws once more data are considered .     for sk using both monte carlo data ( for @xmath296 and @xmath287 ) and the smoothed trees ( continuous lines , for values of @xmath156 growing from top to bottom in geometric progression : @xmath297 ) .",
    "as we saw in figure  [ fig : delta_n4096 ] , the values of @xmath130 for @xmath298 obtained in monte carlo simulation coincide with those from the trees .",
    "the larger system sizes achievable with the tree computation reveal the limitations of the scaling in  ( [ eq : delta - scaling ] ) .",
    "[ fig : delta - asintotico ] ]    we finally note that  @xcite pointed out that the scaling suggested in  @xcite failed once the temperature was changed .",
    "this is probably because  @xcite failed to take into account the factor @xmath263 in  ( [ eq : a ] ) , which is obviously temperature - dependent . in any case , it is clear that the scaling of @xmath130 is quite complicated and a more detailed study ( or larger numerical simulations ) is needed to draw any quantitative conclusions from it . on a more qualitative level , however , the assumption that the main difference between sk and ea is due to the slower growth of the sample - averaged @xmath4 in the latter seems well justified .",
    "we have presented an efficient algorithm for the generation of the tree of states in mean - field spin glasses , once the @xmath62 is given . complemented with the cavity method",
    "this algorithm can also determine self - consistently the correct @xmath62 , although the convergence to such a solution seems to be rather slow .",
    "the generation of many different tree of states , one for each sample , allows one to study analytically sample - to - sample fluctuations in mean - field spin glasses . as an application ,",
    "we have studied the problem of peak counting in single - sample @xmath1 , showing that our analytical results coincide with monte carlo measurements in the sk model .",
    "the method presented herein has potential to permit cavity computations in cases where the replica approach has not been fully successful , for instance , in the computation of loop corrections to the mean - field theory .",
    "here we will discuss some tricks that can be used to improve the speed of the algorithm in the limit of small @xmath130 .",
    "the approach of the previous sections was to consider the case where replica symmetry was broken at @xmath49 steps . although we are interested to study the limit where @xmath49 goes to infinity , an algorithm that takes a linear time in @xmath49 is rather good , indeed many of the artifacts due to a finite value of @xmath49 go to zero as @xmath299 when @xmath300 . however , here we would like to discuss how to construct an algorithm that works directly in the limit @xmath300 .",
    "we have not used this algorithm in the numerical computations of this paper , because we do not need it for our aims , however we would like to present it , both for its elegance and for using it in future applications .    for the convenience of the reader we shall see how to obtain the new algorithm by subsequent improvements of the one presented in the main text .",
    "as we have done before , we first discuss the improvements in the case where the weighting factor is @xmath123 and later on we see how to keep track of the presence of this factor .",
    "we have seen that the first phase of the algorithm consists in generating @xmath133 free energies @xmath302 .",
    "we then evaluated their minimum and performed an acceptance test on it ( which is nearly always accepted ) in order to generate the @xmath303 .",
    "we finally had to discard many of them ( apart from the largest ones ) because they violated the inequality @xmath304 and they would be eventually pruned .",
    "it would certainly be better to generate directly the lowest free energies in order in the interval @xmath305 $ ] , in such a way that we do not need to generate quantities that we do not use .",
    "indeed , in the limit where @xmath80 goes to infinity the distribution probability of the @xmath125 becomes proportional to @xmath306 .",
    "the proportionality factor ( @xmath307 ) is irrelevant , since it may absorbed in a shift of the @xmath125 .",
    "we can thus generate the @xmath125 from a poisson process with density @xmath306 .",
    "this result is particularly handy because it is easy to extract directly ordered variables generated with a poisson process . in this way",
    "we obtain gumbel type distributions .",
    "looking back at the formulae of the main text , we can use the well know result ( that can be easily proved ) that the ordered @xmath308 ( @xmath309 ) can be directly generated in the following way .",
    "if we denote by @xmath310 random independent random numbers , equidistributed in the interval @xmath82 $ ] , the @xmath308 can be obtained as @xmath311    let us consider the distribution of @xmath312 . in principle its probability distribution can reach down to @xmath313 . however , it is strongly cutoff at large negative values .",
    "more precisely , a random number generator on a computer has minimum value @xmath314 ( @xmath315 for a typical 32-bit generator and @xmath316 for a typical 64-bit generator ) .",
    "it is evident that @xmath317 the constant @xmath183 is not large : for typical random generators @xmath318 ( 32 bits ) and @xmath319 ( 64 bits ) .    now we reproduce the probability distribution of the main text by going through the following steps :    * we propose a value of @xmath320 according to the previous distribution , i.e. , @xmath321 .",
    "* we accept the proposed value for @xmath312 with probability @xmath322 .",
    "the probability is less than 1 by construction ( as it should be ) . for small @xmath130",
    "it is also very near to 1 in most of the cases , so that the acceptance factor is near 1 .",
    "we repeat this construction up to the moment that a value of @xmath312 is accepted .",
    "* once we have generated @xmath312 in this way , we finally set @xmath323 * if @xmath324 ( this happens with probability @xmath325 ) we stop and no branching happens at this level . on the contrary if @xmath326 , a branch is present .",
    "we generate the other @xmath308 and stop as soon as @xmath327 .",
    "the average number of accepted @xmath308 is of order @xmath328 .",
    "one can prove that this construction is equivalent to the one considered in the main text .",
    "it has the advantage that the computation can be done directly in the limit @xmath301 .",
    "we now have to cope with the factor @xmath148 .",
    "we have to accept the proposed branching with a probability that is proportional to @xmath148 and if the proposed branching is not accepted we have to go through the previous procedure again .    in principle",
    "the values of @xmath148 may be very large , but its probability is strongly cutoff at large values . in the real simulations , as far as a very large value of @xmath148 is very unlikely , we can accept the proposed configuration with a probability given by @xmath329 , where @xmath330 is greater that the maximum value of @xmath148 in the simulation .",
    "the value of @xmath330 depends on the details of the simulation and it can be found by trial and error . in this way we can dispose of the parameter @xmath80 .",
    "we are now in the situation where we can consider directly the limit @xmath332 , by avoiding to do computations in the case where the proposed change is rejected .",
    "let us first consider the case where @xmath123 we notice that at a given level there can be bifurcations ( or higher - order branching ) in the tree only if the condition @xmath333 is satisfied .",
    "this happens with probability @xmath334 .",
    "therefore in the limit where @xmath335 the distance @xmath336 of the values of @xmath337 where we have a branching on the tree is an exponentially distributed random variable with average @xmath338 .    in this way we can directly compute the position of the next branching , extract the value of @xmath339 from a flat distribution in the interval @xmath340 $ ] and proceed as before . in this way",
    "we generate the tree directly in the continuous limit where @xmath341 .",
    "the final algorithm depends only on the parameter @xmath52 , which has a clear physical meaning .",
    "we now have to cope with the factor @xmath148 .",
    "there are two possibilities .",
    "* we could proceed as before : we accept the proposed branching with a probability that is proportional to @xmath148 , i.e. , @xmath329 .",
    "* we simply forget the factor @xmath148 in the generation of the tree . in the computation of the observable we have to introduce an additional factor when we average over the trees . for any given tree @xmath342",
    ", we define a probability @xmath343 that is the product of all the @xmath148 computed at the branches of the tree .",
    "we also have to consider this additional factor when we compute the value of an observable .",
    "in other words , if the algorithm produces a sequence of trees @xmath344 for @xmath345 , the expectation value of a quantity @xmath346 is given @xmath347 the quantity @xmath348 fluctuates from one tree to another but it should remain of @xmath349 , so that this second approach should be viable .    we notice that in the region where @xmath194 is small the quantity @xmath148 becomes equal to 1 plus corrections in @xmath194 . in the sherrington kirkpatrick model",
    "this happens near the critical temperature . for similar reasons , in",
    "the low - temperature region @xmath148 becomes equal to 1 plus corrections proportional to the temperature .",
    "the quantity @xmath348 is the product of a finite number of terms so it also becomes equal to one in this limit .",
    "it may be interesting to consider the zero - temperature limit of the previous construction .",
    "the function @xmath350 usually has a limit when @xmath2 goes to zero .",
    "we can thus define @xmath351 in the sk model @xmath352 behaves qualitatively as @xmath353 .",
    "the quantities @xmath125 have the meaning of free - energy differences multiplied by a factor @xmath34 and therefore they are expected to be proportional to @xmath34 . if we write @xmath354 , we have that @xmath355 . in the zero - temperature limit",
    "free - energy differences become energy differences , so that the rescaled @xmath356 are themselves energy differences .",
    "let us discuss the construction of the tree in the region of @xmath357 in such a way that the maximum value of @xmath358 ( @xmath359 ) is finite .",
    "our aim it to reconstruct the energy of the low - energy states in the zero - temperature limit , if they are observed with resolution @xmath2 . in order to make the whole computation possible we consider only states that have a finite energy difference from the ground state . at the end of the day",
    "we obtain the same formula as before after the rescaling .",
    "when we prune the tree at low temperature , the value @xmath360 corresponds to considering only the states that have an energy @xmath361 ( in order to simplify the notation we set the ground state energy to zero , i.e. , all the energies are energy differences with the ground state ) .",
    "the total number of leaves is of order @xmath362 .",
    "it is evident that the computation becomes very long for large values of @xmath359 or @xmath187 .",
    "fortunately , in the zero - temperature limit the annoying factor @xmath148 becomes equal to 1 with probability 1 .",
    "indeed , not only is the exponent in the definition of @xmath148 small , but also the terms @xmath363 are exponentially small with probability 1 .",
    "the possibility of neglecting @xmath148 is a great simplification .",
    "the final rules are rather simple and they are exposed below .    *",
    "the root of the tree has @xmath364 and @xmath365 . *",
    "if we start from a branching point with energy @xmath366 and level @xmath358 ( or from the root ) , the probability distribution of the level of the next branching ( @xmath367 ) is given by @xmath368 where @xmath369 .",
    "if we find that for @xmath370 no branching is present .",
    "* the energies of the branches after the branching will be @xmath371 while it is obvious that @xmath372 with probability one , we will keep the @xmath373 with @xmath374 only if they satisfy the relation @xmath375 .    as in sec .",
    "[ sec : generation ] , this explains the generation of the tree from a known @xmath352 .",
    "the reweighting ( and refining of @xmath358 itself ) would then proceed as explained at the end of sec .",
    "[ sec : cavity ] .",
    "we thank the janus collaboration for allowing us to use their ea data and a. billoire and e. marinari for giving us access to their sk @xmath1 . the research leading to these results",
    "has received funding from the european union s seventh framework programme ( fp7/2007 - 2013 ) , erc grant agreement 247328 and from the italian research ministry through the firb project no .",
    "dy acknowledges support from mineco ( spain ) , contract no .",
    "fis2012 - 35719-c02 .",
    "aizenman m , sims r and starr s  l 2007 mean - field spin glass models from the cavity rost perspective _ prospects in mathematical physics _",
    "( _ contemp . math .",
    "_ no 437 ) ( providence , ri : amer .",
    "( _ preprint _ )            parisi g 2003 glasses , replicas and all that _ slow relaxations and nonequilibrium dynamics in condensed matter : les houches session lxxvii , 1 - 26 july , 2002 _ eds barrat",
    "j - l , feigelman m  v , kurchan j and dalibard j ( berlin : springer )        alvarez  baos r , cruz a , fernandez l  a , gil - narvion j  m , gordillo - guerrero a , guidetti m , maiorano a , mantovani f , marinari e , martin - mayor v , monforte - garcia j , muoz  sudupe a , navarro d , parisi g , perez - gaviro s , ruiz - lorenzo j  j , schifano s  f , seoane b , tarancon a , tripiccione r and yllanes d ( janus collaboration ) 2010 _ j. stat .",
    "mech . _ * 2010 * p06026 ( _ preprint _ )          baity - jesi m , baos r  a , cruz a , fernandez l  a , gil - narvion j  m , gordillo - guerrero a , iniguez d , maiorano a , mantovani f , marinari e , martin - mayor v , monforte - garcia j , muoz  sudupe a , navarro d , parisi g , perez - gaviro s , pivanti m , ricci - tersenghi f , ruiz - lorenzo j  j , schifano s  f , seoane b , tarancon a , tripiccione r and yllanes d ( janus collaboration ) 2013 _ phys .",
    "b _ * 88 * 224416 ( _ preprint _ )      bray a  j and moore m  a 1987 scaling theory of the ordered phase of spin glasses _ heidelberg colloquium on glassy dynamics _ ( _ lecture notes in physics _ no 275 ) ed van hemmen j",
    "l and morgenstern i ( berlin : springer )        belletti f , guidetti m , maiorano a , mantovani f , schifano s  f , tripiccione r , cotallo m , perez - gaviro s , sciretti d , velasco j  l , cruz a , navarro d , tarancon a , fernandez l  a , martin - mayor v , muoz - sudupe a , yllanes d , gordillo - guerrero a , ruiz - lorenzo j  j , marinari e , parisi g , rossi m and zanier g ( janus collaboration ) 2009 _ computing in science and engineering _ * 11 * 48    baity - jesi m , baos r  a , cruz a , fernandez l  a , gil - narvion j  m , gordillo - guerrero a , guidetti m , iniguez d , maiorano a , mantovani f , marinari e , martin - mayor v , monforte - garcia j , munoz  sudupe a , navarro d , parisi g , pivanti m , perez - gaviro s , ricci - tersenghi f , ruiz - lorenzo j  j , schifano s  f , seoane b , tarancon a , tellez p , tripiccione r and yllanes d 2012 _ eur . phys .",
    "j. special topics _ * 210 * 33 ( _ preprint _ )      belletti f , cotallo m , cruz a , fernandez l  a , gordillo - guerrero a , guidetti m , maiorano a , mantovani f , marinari e , martin - mayor v , sudupe a  m , navarro d , parisi g , perez - gaviro s , ruiz - lorenzo j  j , schifano s  f , sciretti d , tarancon a , tripiccione r , velasco j  l and yllanes d ( janus collaboration ) 2008 _ phys .",
    "lett . _ * 101 * 157201 ( _ preprint _ )    alvarez  baos r , cruz a , fernandez l  a , gil - narvion j  m , gordillo - guerrero a , guidetti m , maiorano a , mantovani f , marinari e , martin - mayor v , monforte - garcia j , muoz  sudupe a , navarro d , parisi g , perez - gaviro s , ruiz - lorenzo j  j , schifano s  f , seoane b , tarancon a ,",
    "tripiccione r and yllanes d ( janus collaboration ) 2010 _ phys .",
    "lett . _ * 105 * 177202 ( _ preprint _ )    baos r  a , cruz a , fernandez l  a , gil - narvion j  m , gordillo - guerrero a , guidetti m , iiguez d , maiorano a , mantovani f , marinari e , martin - mayor v , monforte - garcia j , muoz sudupe a , navarro d , parisi g , perez - gaviro s , ricci - tersenghi f , ruiz - lorenzo j  j , schifano s  f , seoane b , tarancn a , tripiccione r and yllanes d 2011 _ phys . rev .",
    "b _ * 84*(17 ) 174209 ( _ preprint _ ) http://link.aps.org/doi/10.1103/physrevb.84.174209"
  ],
  "abstract_text": [
    "<S> we present a numerical method to generate explicit realizations of the tree of states in mean - field spin glasses . </S>",
    "<S> the resulting study illuminates the physical meaning of the full replica symmetry breaking solution and provides detailed information on the structure of the spin - glass phase . </S>",
    "<S> a cavity approach ensures that the method is self - consistent and permits the evaluation of sophisticated observables , such as correlation functions . </S>",
    "<S> we include an example application to the study of finite - size effects in single - sample overlap probability distributions , a topic that has attracted considerable interest recently . </S>"
  ]
}