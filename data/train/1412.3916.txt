{
  "article_text": [
    "molecular simulations allow the dynamics of a system to be followed at atomistic resolution and thus can be used as virtual microscopes to investigate chemical reactions and conformational transitions in molecular systems @xcite .",
    "the time scale that can be simulated with current computers and algorithms is on the order of a microsecond for a system of a few tens of thousands of atoms modeled with a typical atomistic empirical force field . even though recently developed _",
    "ad hoc _ hardware allowed for a sudden jump in this scale @xcite , many relevant processes are still out of range for atomistic molecular dynamics ( md ) .",
    "a lot of effort has been made in the last decades to tackle or , at least , to alleviate this issue by means of modified algorithms known as enhanced sampling techniques . among these",
    ", a class of methods is based on the idea of biasing a few , carefully selected collective degrees of freedom , known as collective variables ( cvs ) @xcite .",
    "biased enhanced - sampling simulations require these descriptors to be computed on the fly at every simulation time step .",
    "the cost of computing the cvs can in principle slow down the calculation .",
    "this is particularly true for expensive cvs , such as steinhardt order parameters @xcite , path cvs @xcite , template - based cvs @xcite , property maps @xcite , social permutation - invariant coordinates @xcite , sketch maps @xcite and debye - hckel energy @xcite , just to mention a few .",
    "the calculation of the cvs and of the resulting biasing forces can be done in dedicated routines of md software or can be implemented in external plugins @xcite .",
    "it is very difficult to optimize the calculation of the cvs for several reasons .",
    "first , they sometime involve long - range exchange of information that makes them difficult to be compatible with domain - decomposition algorithms .",
    "second , because their definition is highly system dependent , routines implementing these schemes should be flexible , thus paying an unavoidable price in terms of efficiency . on the opposite side ,",
    "the calculation of physical force fields is becoming faster and faster thanks to the use of massively parallel and optimized software @xcite and hardware @xcite .",
    "the overall consequence of this trend is that the calculation of cvs can be expected to become a relevant bottleneck in enhanced sampling simulations , particularly in the context of massively parallel or gpu - accelerated md .",
    "we here introduce a scheme based on multiple time step integration ( mts ) in its reference system propagator algorithm ( respa ) formulation @xcite .",
    "more precisely , mts is used here to split the integration of biasing forces and physical forces .",
    "the underlying principle is that often the former have a smoother dependence on atomic positions , thus change at a lower rate and can be integrated with a larger time step .",
    "this splitting allows for a substantial increase in the computational efficiency of biased sampling methods .",
    "furthermore , we introduce a theoretical framework so as to assess the unavoidable time - step discretization errors .",
    "this is done by extending the concept of _ effective energy",
    "_ @xcite so as to take into account the effect of biasing forces separately .",
    "this scheme allows artifacts that could be hidden when observing total - energy conservation to be highlighted . in the method section",
    "we introduce the methodology , first reviewing the mts integration then introducing the scheme to assess sampling accuracy .",
    "we then present numerical tests of our algorithm on a one - dimensional model , on alanine dipeptide and on a large protein / rna complex , using cvs of increasing complexity . in the latter case",
    "we show that the use of mts can greatly improve the performance without introducing significant errors .",
    "we consider here a system of @xmath0 atoms evolving accordingly to biased hamilton equations in the form : @xmath1 here @xmath2 , @xmath3 , and @xmath4 are respectively coordinates , momenta , and mass of @xmath5-th atom ; @xmath6 is the physical potential , typically obtained evaluating an empirical force field ( see , e.g. , ref .",
    "@xcite ) ; @xmath7 is a biasing potential , which depends on the atomic positions only through @xmath8 collective variables @xmath9 .",
    "the choice of the time step @xmath10 for the integration of the equations of motion is dictated by the fastest frequencies of the system , which depend on the atomic masses and on the functional form of @xmath11 .",
    "in reversible mts integration forces are typically split in a fast - changing part and slow - changing part , so that different integration time steps can be used for the two parts @xcite . ideally , the slow - changing part is the most computationally expensive one .",
    "we remark here that cvs are often smoother functions of atomic coordinates than the stiffest force - field terms . as an example , cvs used for isomerization processes such as torsional angles are typically slower when compared with bond fluctuations .",
    "biasing forces are thus good candidates for the time - reversible mts scheme itemized below :    1 .",
    "integrate momenta according to biasing force @xmath12 for a single time step of length @xmath13 .",
    "2 .   integrate momenta and positions according to the physical forces @xmath14 for @xmath15 times , with time step @xmath10 .",
    "3 .   integrate momenta according to biasing force @xmath12 for a single time step of length @xmath13 .",
    "here @xmath10 is the inner time step and @xmath15 is the order of the mts scheme , so that biasing forces and , as a consequence , cvs are only evaluated with a time step @xmath16 .",
    "this algorithm can be straightforwardly integrated in existing codes .",
    "indeed , it is sufficient to apply the biasing forces every @xmath15 steps scaling them by a factor @xmath15 so as to take correctly into account the transferred momentum . in the intermediate @xmath17 steps , cvs",
    "do not need to be computed .",
    "the algorithm is by construction symplectic and reversible , as long as the underlying integrator for the hamilton equations is symplectic and reversible .",
    "we note that a too large outer time step @xmath16 can lead to the well - known occurrence of resonances @xcite and thus to significant systematic errors .",
    "several possible solutions have been recently proposed to tackle this issue.@xcite these recent improvements could be easily coupled with the presented algorithm and might decrease the systematic errors .",
    "we also observe that so - called multigrators @xcite do not suffer from resonances because they are based on splitting in two equations of motion both having the same stationary distribution and thus can be used with arbitrarily large @xmath15 .",
    "such an approach is not suitable in the context discussed here .",
    "however , we notice that in typical situations even small values of @xmath15 are already enough to largely decrease the effective computational cost of cv calculation .",
    "finally , we observe that mts has been also employed in ref .",
    "@xcite with a different purpose , i.e. to allow for a large time step for the physical force - field to be combined with a short time step for the integration of the cvs .      in order to provide results free from systematic errors ,",
    "enhanced sampling methods should be paired with integration of the equations of motion able to correctly sample the target statistical ensemble , which is typically the isothermal or the isobaric one . in general , the errors in the stationary distribution depends in a non - trivial way on the integration algorithm and on the details of the underlying potential ( see , e.g. , ref .",
    "@xcite ) so that it is very useful to have error indicators that can be used in practical simulations .",
    "for example in microcanonical simulations it is customary to check energy conservation .",
    "a similar procedure can be used e.g. with the nos - hoover thermostat @xcite , where a conserved energy can be defined , and has been generalized to stochastic simulations through the definition of an _ effective energy _",
    "the effective energy represents the total energy of the extended system ( physical system plus thermostat ) , and its drift has been interpreted as the work performed by the integrator on the system @xcite .",
    "we here extend this idea to mts biased simulation .",
    "furthermore , we show how it is possible to compute separately the portion of energy drift due to biasing forces alone .",
    "this makes it possible to assess the accuracy with which biasing forces are integrated , thus providing a safe framework that can be used to choose @xmath15 in practical cases .",
    "we also notice that this approach to assess integration accuracy is not limited to mts calculations , but can be used also in single time step biased calculations ( @xmath18 ) to verify that the biasing forces are compatible with the chosen @xmath10 .",
    "effective energy drift@xcite was introduced as a direct measure of the detailed balance violation :    @xmath19    here @xmath20 is the hamiltonian , @xmath21 the effective energy , @xmath22 denotes the state of the system ( positions and momenta ) at time @xmath23 , @xmath24 the thermal energy , and @xmath25 the probability of choosing @xmath26 as coordinates at the next step provided the system is in @xmath27 at the present step .",
    "we here use the notation @xmath28 to denote the reversal of the velocities , so that strictly speaking the drift measures _ generalized _ detailed balance violation @xcite .",
    "the effective energy is then conventionally initialized to zero and computed as a sum over time    @xmath29    assuming integration is performed using velocity verlet @xcite , eq .",
    "[ eq : delta - h - tilde ] can be rewritten as @xcite @xmath30 where @xmath31 is the total force ( physical plus bias ) acting on _ _ i-__th atom . here",
    "@xmath32 represents the change in the physical potential , and @xmath33 the change in the bias potential .",
    "we remark that this expression is exact , except for numerical roundoff , when equations of motions are integrated using velocity verlet and when system is thermostated using a scheme that exactly preserves detailed balance .",
    "any thermostating procedure could then be used , provided it is implemented on top of velocity verlet ( see , e.g. , appendix e in ref.@xcite ) , and provided the integration of the thermostat is accurate .",
    "one can make some considerations about eq .",
    "[ eq : h - drift ] :    1 .",
    "the first term represents a numerical path integral of the forces with trapezoidal rule .",
    "therefore , in the limit of small @xmath10 , its value tends to compensate the second term .",
    "the second and third terms are exact differentials , therefore they contribute to fluctuations of the effective energy and not to its drift . in the limit of small @xmath10 , the third term can be neglected with respect to the second one .",
    "no assumption has been made about the protocol used to evaluate such forces , which in principle could differ from the actual gradient of the potential energy .",
    "for instance , if @xmath34 is computed as an approximate estimate of the actual force , the effective energy drift will still measure exactly the violation of detailed balance for the correct hamiltonian .",
    "thus , the effective energy drift will be smaller if better estimates of the forces are used .",
    "4 .   the first and second terms are linear in the force and in the potential energy , so that they can be split in a contribution coming from the physical forces and a contribution coming from the biasing forces .",
    "is particularly important in this context .",
    "indeed , one can consider the mts algorithm as the application of artificially modified forces .",
    "namely , biasing forces are neglected on some steps and augmented by a factor @xmath15 on other steps .",
    "the forces that should be used in evaluating eq .",
    "[ eq : h - drift ] are thus the artificially modified forces , whereas the potential @xmath35 should be the correct one . provided the artificially modified forces are used in a symplectic integrator such as velocity verlet , the effective energy drift can be used to check detailed - balance violations and , thus , to detect sampling errors .",
    "based on these considerations , we define an approximated bias effective energy drift as @xmath36 here @xmath37 denotes the biasing potential and @xmath38 the biasing force on @xmath5-th atom .",
    "we notice that here only the change in the biasing potential @xmath39 is considered .",
    "the bias effective energy drift is therefore equal to the difference between the actual increment of bias potential and the estimate of that increment through a numerical path integration of the biasing force .",
    "we underline here that in a mts framework @xmath10 is the inner time step and not the one used to compute the bias potential .",
    "however , the biasing force @xmath40 is only contributing at steps that are multiple of the mts factor @xmath15 .",
    "in other words , in eq .",
    "[ eq : bias - drift ] the biasing force is scaled by a factor @xmath15 and the increment in position is considered for the inner step . if the coordinates on which the biasing force is acting were evolved at constant velocity in the inner integration step ( i.e. if the physical potential did not affect them ) then this expression would be equal to a numerical path integral of the forces .",
    "discrepancies from this behavior are caused by the unavoidable interplay between the cv dynamics and the microscopic one and can be ultimately ascribed to resonance effects .",
    "the goal of our procedure is indeed to highlight these effects and quantify them .",
    "we remark here that , whereas eq .",
    "[ eq : h - drift ] is exact and can be derived just enforcing detailed balance , the expression in eq .",
    "[ eq : bias - drift ] is approximate .",
    "a few comments can be made comparing these two expressions .",
    "first , we notice that the last term of eq .",
    "[ eq : h - drift ] has been neglected in eq .",
    "[ eq : bias - drift ] . more precisely , since our goal is to track any violation of detailed balance that is due to the bias",
    ", an additional term @xmath41 should have been included in eq .",
    "[ eq : bias - drift ] .",
    "as we will show in the numerical examples , this term is negligible in practical situations .",
    "moreover , by construction it does not contribute to the overall effective energy drift , but only to its fluctuations . as a consequence ,",
    "the calculation of @xmath42 only requires the knowledge of the biasing force .",
    "this allows in principle to implement it efficiently also in external plugins @xcite that do not have access to physical forces computed in the md software .",
    "moreover , we observe that eq .",
    "[ eq : bias - drift ] can be straightforwardly parallelized , also when domain decomposition algorithms are employed , and requires the reduction of a single scalar number thus with a minimal impact on the performance .",
    "once the change in effective energy per time step has been computed with eq .",
    "[ eq : bias - drift ] , the effective energy can be computed as @xmath43",
    "the model 1d potential is shown . unbiased potential @xmath11 ( solid ) and total potential @xmath35 ( dashed ) , as defined in eqs .",
    "[ eq:1d - u ] and [ eq:1d - v ] .",
    "notice that the barriers is decreased by a factor 10 in the biased potential . ]    as a first example we discuss a simple one dimensional toy model of a single particle confined into a double well potential .",
    "all quantities are here expressed in arbitrary units , and we assume the thermal energy @xmath44 and particle mass @xmath45 .",
    "we consider a potential energy :    @xmath46    where @xmath47 and @xmath48 . as shown in fig .",
    "[ fig : potential ] such potential has two stable minima which are separated by a barrier of several @xmath24 .",
    "transitions are accelerated by means of an umbrella potential @xcite in the form @xmath49 using a negative fraction of the potential energy as bias potential is convenient because , as it is evident from fig . [",
    "fig : potential ] , it lowers the barriers keeping the system confined into the interesting regions of phase space .",
    "moreover , this choice is consistent with the expected bias potential obtained in the long - time limit in a well - tempered metadynamics simulation @xcite .",
    "bias effective energy drift as a function of time ( left panel ) for different values of the multiple time step order @xmath15 , as indicated .",
    "notice that the line corresponding to @xmath18 has been shifted downward by 100 @xmath24 for clarity .",
    "time derivative of bias effective energy as a function of kullbackleibler divergence @xmath50 ( right panel ) for @xmath15 ranging from 1 to 8 , as indicated . both the drift and the @xmath50 are growing monotonically with @xmath15 . ]    the system",
    "is then evolved according to a langevin equation :    @xmath51    with friction @xmath52 .",
    "equations are integrated with the scheme proposed in ref .",
    "@xcite , using an inner time step @xmath53 .",
    "mts is implemented by scaling the biasing force @xmath54 by a factor @xmath15 and by applying it every @xmath15-th step .",
    "the bias effective energy drift is then computed and shown in fig .",
    "[ fig : drift ] for @xmath18 , 2 , 3 , 4 , and 5 .",
    "notice that the bias effective energy is clearly drifting for @xmath55 , and that its drift is growing with @xmath15 .",
    "this is in agreement with the intuitive observation that a larger time step would make the path integral of the forces more and more different from the corresponding potential , as it can be seen in eq .",
    "[ eq : bias - drift ] .",
    "we observe that the actual value of the drift also depends on the langevin thermostat and that the drift could be reduced by decreasing the friction @xmath56 or by integrating the thermostat in the outer time step ( see figs .",
    "s1 , s2 , and s3 ) .",
    "however this 1d model is meant to mimic a dimensional reduction of a finer grain model .",
    "thus friction should not be considered as a tunable parameter but as an actual part of the model which depends on how coupled is the biased cv with the other microscopic degrees of freedom .",
    "we also compute the difference between the observed distribution and the theoretical one using the kullback - leibler divergence @xmath57 , where @xmath58 is the theoretical distribution and @xmath59 is the empirical histogram , both computed with a bin size of 0.01 . in fig . [",
    "fig : drift ] we show the relationship between the slope of the effective energy drift and the kullback - leibler divergence .",
    "the results clearly show that the effective - energy drift is a good proxy for the sampling error , and can be used in situations where a reference result does not exist so as to simplify the choice of @xmath15 and to allow errors to be detected .    in the three panels neglected terms @xmath60 ( see eq .",
    "[ eq : alpha ] ) for the bias effective energy are shown as a function of time for selected choices of the multiple time step order @xmath61 , as indicated .",
    "although for @xmath62 there are spikes on the order of a few @xmath63 , this term does not present any significant drift . ]    to verify that the neglect of terms related to forces defined in eq .",
    "[ eq : alpha ] is not affecting the overall effective energy drift , we compute it explicitly . figure  [ fig : alpha_term ] shows that such a force term only contributes to fluctuations and not to the overall drift .",
    "the tests on this one - dimensional potential were performed using langevin dynamics .",
    "the idea of defining an effective energy drift in a stochastic equation of motion is relatively new.@xcite however , the theoretical considerations discussed in this paper apply to any thermostating procedure , including deterministic ones . as it can be appreciated in fig .",
    "s4 , the drift computed using eq .",
    "[ eq : bias - drift ] is close to the one obtained by monitoring the total energy conservation with a conventional nos - hoover thermostat.@xcite      as a second test , we study the free energy surface ( fes ) of the alanine dipeptide with umbrella sampling simulations , using different values for the multiple time step order @xmath15 .",
    "alanine dipeptide in water is a standard model system for many theoretical and computational studies of biomolecules @xcite , and is known to exhibit multiple minima on the fes computed as a function of the @xmath64 torsional angles ( see fig .",
    "[ fig : fig3 ] ) .",
    "the terminally blocked alanine peptide ( sequence ace - ala - nme ) was solvated with 542 tip3p @xcite water molecules in a rhombic dodecahedral box , whose dimensions were chosen to ensure a minimum distance to the box boundaries of 10  .",
    "molecular dynamics simulations were performed with the amber99sb @xcite force field using gromacs 4.6 @xcite in combination with an in house version of plumed 2 @xcite .",
    "long range electrostatic forces were treated using particle - mesh ewald summation @xcite , and the equations of motion were integrated with time step @xmath652 fs .",
    "all simulations were performed in the canonical ensemble ( @xmath66k ) with stochastic velocity rescaling @xcite , and bond lengths were constrained using the lincs algorithm @xcite .",
    "free energy surfaces of alanine dipeptide projected onto the @xmath64 dihedral angles obtained from umbrella sampling simulations .",
    "the reference fes ( top left panel ) is compared with results obtained using different stride values of the multiple time step order @xmath15 , as labeled . ]",
    "we first performed a 100 ns well - tempered metadynamics simulation @xcite using the @xmath64 angles as collective variables .",
    "the gaussian width was set to 0.35 rad , and the deposition interval was 3.2 ps with a starting gaussian height of 0.4 kj / mol and a bias factor of 10 , corresponding to an enhancement in the cv temperature of @xmath67 k. we then used the obtained bias potential to perform an umbrella sampling ( us ) refinement as in ref.@xcite . a reference free energy landscape was obtained by running a 500ns us simulation with single time step ( @xmath18 ) .",
    "we then performed a set of 100 ns us simulations using different multiple time step orders @xmath15 , and compared the results with the reference simulation . as for the 1d double - well case , the accuracy on the reconstructed free energy surface decreases for increasing values of @xmath15 ( fig .",
    "[ fig : fig3 ] ) .",
    "the discrepancy is noticeable around the free energy maxima , but much less pronounced in the relevant low - free - energy regions .",
    "the agreement between the reference and the mts simulation with stride @xmath15 was quantified by calculating the deviation    @xmath68    where @xmath69 and @xmath70 are the free energy differences between the region @xmath71 $ ] and the region @xmath72 $ ] for the reference and the mts simulation , respectively . as a measure of the error , we additionally computed the deviation from the reference free - energy landscape as    @xmath73^{2}d\\phi d\\psi\\right)^{\\frac{1}{2}}\\ ] ]    where @xmath74 is the region in dihedral space such that @xmath75 kj / mol and a is the corresponding area .",
    "note that @xmath74 includes all the minima as well as the transition states .",
    "the value of @xmath76 is chosen so as to align the averages of @xmath77 and @xmath78 over @xmath74 . as shown in fig .",
    "[ fig : fig4]a , both @xmath79 and @xmath80 slowly grow with @xmath15 . notably , for @xmath81 , the error on the free energy estimate is comparable with the statistical fluctuations obtained with @xmath18 . the sampling error introduced by the multiple time step can be effectively monitored by considering the bias effective energy drift ( fig .",
    "[ fig : fig4]b ) .",
    "this is particularly convenient in real - case scenarios , where one does not have a reference simulation to compare with .",
    "two different estimates of the sampling error in umbrella sampling simulations of alanine dipeptide , namely free - energy difference between two regions ( @xmath82 , circles ) and average error ( @xmath80 , squares ) . left : sampling error vs multiple time step order .",
    "right : sampling error vs time derivative of bias effective energy drift . ]      as a third and more realistic test case we consider the calculation of the free - energy landscape using metadynamics on a protein / rna complex .",
    "the nonstructural protein 3 from the hepatitis c virus ( ns3 hcv ) is a motor protein that unwinds and translocates the double and single stranded nucleic acids in the 3 @xmath83 5 direction hydrolyzing atp @xcite .",
    "here we compute the free - energy profile of the ns3 helicase complexed with a single stranded rna , performing a short well - tempered metadynamics .",
    "we use here as a collective variable the debye - hckel approximation to the electrostatic component of protein / rna interaction defined as in ref .",
    "@xcite @xmath84 where @xmath85 is the water dielectric constant , @xmath86 is the charge of atom @xmath5 , @xmath87 is the vector connecting atoms @xmath5 and @xmath88 and @xmath89 is the screening length . here",
    "atom indexes @xmath5 and @xmath88 run over the protein and rna respectively .",
    "although we do not characterize protein / rna binding in this application , this is a prototype setup for the study of complexes of charged molecules ( e.g. nucleic acids , charged ligands , etc ) .",
    "all the simulation parameters were the same as for alanine dipeptide , but simulations were performed in the npt ensemble using a parrinello - rahman barostat with an isotropic pressure coupling of 1 bar @xcite and the amber99sb - ildn * force field @xcite with parmbsc0 and @xmath90 corrections @xcite . the system was prepared starting from the crystal structure of the complex between the protein and an ssrna of 6 nucleotides by appleby et al .",
    "@xcite ( pdb : 3o8c ) .",
    "the simulation box contains 100012 atoms , and includes 31058 water molecules and nacl 0.1 m ( 70 na^+^ and 62 cl^-^ ions ) .",
    "the biased cv ( @xmath91 ) was computed using a nominal ionic strength of 0.1 m .",
    "protein and rna here contain respectively @xmath92 and @xmath93 atoms , so that the cost of evaluating the cv is relevant .",
    "bias was deposited with a gaussian width of 0.25 kj / mol , a bias factor of 2 , an initial gaussian height of 0.1 kj / mol and a deposition pace of 0.12 ps .",
    "the low value of the bias factor was chosen to avoid the complex to dissociate resulting in a difficult - to - converge free - energy landscape .",
    "we performed well - tempered metadynamics simulations of 3 ns length testing different values for the multiple time step order ( @xmath941,2,3,6 ) .",
    "we notice that it is very difficult to obtain a converged free - energy landscape with these very short simulations .",
    "however , as it can be seen in fig .",
    "[ fig : fes - ns3 ] , the free - energy landscape obtained after 3 ns is very consistent across simulations performed with values of @xmath15=1 and 2 . on the contrary , with @xmath95",
    "we obtain a clear systematic error in the computed landscape .",
    "remarkably , the calculation with @xmath96 leads again to a relatively small error . the particularly bad case of @xmath95 could be related to resonance effects between the biased cv and the internal degrees of freedom of the system .",
    "also in this case one can compute the bias effective energy drift for different choices of @xmath15 .",
    "it is worth noting that two extra contributions have to be included here in order to compute the effective energy properly , one to take into account the out of equilibrium nature of metadynamics ( see appendix a ) and another one to take into account the change in the cell volume due to the barostat at every time step ( see appendix b ) . as it can be appreciated in fig .",
    "[ fig : drift - ns3 ] , the drift is clearly increasing with @xmath15 .",
    "already at @xmath95 a drift of several tens of kj / mol / ns can be observed .",
    "we notice that electrostatic interaction is not a smooth function of the atomic coordinates .",
    "indeed , in standard md codes , only its long range tail is sometime integrated using a larger time step .",
    "thus , a large drift for @xmath95 can be expected here .",
    "notably , the drift at @xmath97 is much smaller , consistently with the fact that no systematic error is observed in fig .",
    "[ fig : fes - ns3 ] .",
    "this suggest that effective energy conservation is a sufficient criterion to assess the integration with our mts scheme .    this application can be considered as an example of a realistic system .",
    "performance that can be obtained with this setup are shown in figure [ tab : performance ] . as it can be seen for a highly expensive",
    "cv the performance gain can be large .",
    "notably , the contribution to the total calculation time of the calculation of the cvs scales inversely with the mts order @xmath15 . even for @xmath97",
    "the gain is significant .",
    "free - energy profile as a function of the @xmath91 collective variable ( see eq . [ eq : g - dh ] ) as obtained from a well - tempered metadynamics performed on the protein / rna complex .",
    "results from different values of the mts order @xmath15 are shown . ]",
    "bias effective energy as a function of time as obtained from a well - tempered metadynamics simulation biasing the @xmath91 collective variable performed on the protein / rna complex .",
    "results for different values of the mts order @xmath15 are shown as indicated .",
    "energies are in kj / mol . ]",
    "performance measured on the metadynamics calculation on a protein / rna complex for different multiple time step orders @xmath15 ( squares ) , estimated on a gpu - based linux workstation ( cpu : 12 cores intel e5 - 2620 ; gpu : 1 geforce gtx titan ) .",
    "a linear fit is also shown ( dashed line ) .",
    "both force - field calculation and cv calculation were parallelized on 12 threads using openmp .",
    "performance without metadynamics is indicated as a horizontal dotted line . ]",
    "we presented a scheme based on reversible multiple time step to integrate physical forces and biasing forces using different strides .",
    "this can be convenient when biasing collective variables ( cvs ) that are smooth and computationally expensive , since it allows the cvs to be computed every few steps .",
    "the implementation is straightforward , since it just requires biasing forces to be scaled by a factor @xmath15 equal to the stride used for their calculation .",
    "the accuracy of the algorithm is discussed in detail on a one dimensional model and on alanine dipeptide in explicit solvent .",
    "additionally , a protein / rna complex has been used as a model for a realistic application .",
    "although in this case it is difficult to converge a free - energy landscape within a short simulation , the impact of the introduced algorithm on performance is clear .",
    "a multiple time step order @xmath97 has been shown to provide a remarkable speed up without significantly affecting the accuracy of the calculation .",
    "we stress that the case of electrostatic interaction is particularly difficult since this cv is not a smooth function of the atomic coordinates . in the alanine dipeptide , where cvs that are smooth functions of the coordinates were employed , values up to @xmath98 where shown to introduce no significant error . in practical applications ,",
    "different cvs could require different values of @xmath15 and thus the performance gain could be different . to help the users in this choice",
    ", we introduced here a theoretical framework for assessing the accuracy of the explored ensemble .",
    "this formalism is very powerful in that it allows an energy drift to be defined that includes selected portions of the potential energy .",
    "we here used it to isolate the contribution to the effective energy drift given by the biasing force from the contribution given by the physical forces .",
    "this decomposition allows one to focus the assessment to the relevant portion of the potential - energy function , thus avoiding relevant errors to be masked by e.g. solvent fluctuations . in this manner , although sampling errors are not corrected , it is easy to detect improper choice of @xmath15 . even though it is not possible to define a universal relationship between the drift and the error , it is clear that the effective energy is a powerful tool to validate mts simulations .",
    "finally , we observe that this check can in principle be used also with a single time step integration scheme ( @xmath18 ) since , also in this case , the forces added by enhanced sampling techniques could be too stiff to be integrated with a conventional time step .",
    "the discussed algorithm has been implemented in a locally modified version of the plumed plugin and is available on request .",
    "it will be publicly available in the next plumed release .",
    "the effective energy drift provides a rigorous way to asses the validity of detailed balance .",
    "however , there are a number of relevant situations where detailed balance is by construction violated during the simulation , e.g. all non equilibrium free - energy techniques @xcite . as an example , in steered molecular dynamics @xcite the work can be used to compute free energies @xcite or to reweight the obtained conformations @xcite .",
    "however , for the sake of validating the integration of the equations of motion , one can limit the analysis to the portion of work performed by the integrator . in case of steered molecular dynamics the work accumulated by moving the restraint should be removed from the effective energy drift . in a similar fashion , in metadynamics @xcite the sum of the height of the accumulated gaussians should be subtracted from the effective energy drift .",
    "in the case of variable cell simulations @xcite an additional contribution related to cell change should be added to the effective energy drift .",
    "additionally , attention should be paid when computing the increment of positions @xmath99 when particles cross the boundaries .",
    "equation [ eq : bias - drift ] should be replaced with    @xmath100+\\delta v\\label{eq : npt}\\ ] ]    where @xmath101 is the matrix of lattice vectors ( as rows ) , @xmath102 are the scaled coordinates of @xmath5-th atom , @xmath103 are the scaled biasing forces on @xmath5-th atom , and @xmath104 is related to the bias contribution to the virial tensor . the first term in eq .",
    "[ eq : npt ] is defined in terms of scaled coordinates and forces so as to allow the distance vector @xmath105 to be evaluated with the minimal image convention when the cell is modified .",
    "this term reduces to the first term in eq .",
    "[ eq : bias - drift ] when the cell matrix is constant .",
    "the second term is only present for variable cell simulations .",
    "michele ceriotti is acknowledged for carefully reading the manuscript and providing useful suggestions .",
    "alessandro laio is also acknowledged for useful discussions .",
    "the research leading to these results has received funding from the european research council under the european unions seventh framework programme ( fp/2007 - 2013 ) / erc grant agreement n. 306662 , s - rna - s .",
    "figures showing the dependence of the bias effective energy drift on the friction coefficient @xmath56 for the 1d model . figure showing the effective energy drift for the 1d model using a nos - hoover thermostat .",
    "allen ,  m.  p. ; tildesley ,  d.  j. _ computer simulation of liquids _ ; oxford university press : new york , 1987 frenkel ,  d. ; smit ,  b. _ understanding molecular simulation _ ,",
    "2nd ed . ; academic press : london , 2002 tuckerman ,  m.  e. _ statistical mechanics : theory and molecular simulation _ ; oxford graduate texts ; oxford university press : new york , 2010 dror ,  r.  o. ; young ,  c. ; shaw ,  d.  e. in _ encyclopedia of parallel computing _ ; padua ,  d. , ed . ; springer , 2011 ; pp 6071 torrie ,  g.  m. ; valleau ,  j.  p. _ j. comput .",
    "phys . _ * 1977 * , _ 23 _ , 187199 darve ,  e. ; pohorille ,  a. _ j. chem . phys . _ * 2001 * , _ 115 _ , 91699183 laio ,  a. ; parrinello ,  m. _ proc . natl .",
    "* 2002 * , _ 99 _ , 1256212566 maragliano ,  l. ; vanden - eijnden ,  e. _ chem . phys .",
    "_ * 2006 * , _ 426 _ , 168175 marsili ,  s. ; barducci ,  a. ; chelli ,  r. ; procacci ,  p. ; schettino ,  v. _ j. phys . chem",
    "* 2006 * , _ 110 _ , 1401114013 barducci ,  a. ; bussi ,  g. ; parrinello ,  m. _ phys .",
    "lett . _ * 2008 * , _ 100 _ , 020603 abrams ,  j.  b. ; tuckerman ,  m.  e. _ j. phys .",
    "b _ * 2008 * , _ 112 _ , 1574215757 laio ,  a. ; gervasio ,  f.  l. _ rep .",
    "phys . _ * 2008 * , _ 71 _ , 126601126623 barducci ,  a. ; bonomi ,  m. ; parrinello ,  m. _ wiley interdiscip .",
    "sci . _ * 2011 * , _ 1 _ , 826843 abrams ,  c. ; bussi ,  g. _ entropy _ * 2014 * , _ 16 _ , 163199 dellago ,  c. ; hummer ,  g. _ entropy _ * 2014 * , _ 16 _ , 4161 steinhardt ,  p.  j. ; nelson ,  d.  r. ; ronchetti ,  m. _ phys .",
    "b _ * 1983 * , _ 28 _ , 784805 trudu ,  f. ; donadio ,  d. ; parrinello ,  m. _ phys .",
    "_ * 2006 * , _ 97 _ , 105701 branduardi ,  d. ; gervasio ,  f.  l. ; parrinello ,  m. _ j. chem . phys . _ * 2007 * , _ 126 _ , 054103 pietrucci ,  f. ; laio ,  a. _ j. chem .",
    "theory comput . _",
    "* 2009 * , _ 5 _ , 21972201 spiwok ,  v. ; krlov ,  b. _ j. chem . phys . _ * 2011 * , _ 135 _ , 224504 pietrucci ,  f. ; andreoni ,  w. _ phys . rev .",
    "lett . _ * 2011 * , _ 107 _ , 085504 tribello ,  g.  a. ; ceriotti ,  m. ; parrinello ,  m. _ proc .",
    "usa _ * 2012 * , _ 109 _ , 51965201 do ,  t.  n. ; carloni ,  p. ; varani ,  g. ; bussi ,  g. _ j. chem .",
    "theory comput .",
    "_ * 2013 * , _ 9 _ , 17201730 bonomi ,  m. ; branduardi ,  d. ; bussi ,  g. ; camilloni ,  c. ; provasi ,  d. ; raiteri ,  p. ; donadio ,  d. ; marinelli ,  f. ; pietrucci ,  f. ; broglia ,  r.  a. ; parrinello ,  m. _ comput .",
    "commun . _ * 2009 * , _ 180 _ , 19611972 fiorin ,  g. ; klein ,  m.  l. ; hnin ,  j. _ mol .",
    "phys . _ * 2013 * , _ 111 _ , 33453362 tribello ,  g.  a. ; bonomi ,  m. ; branduardi ,  d. ; camilloni ,  c. ; bussi ,  g. _ comput .",
    "commun . _ * 2014 * , _ 185 _ , 604613 plimpton ,  s. _ j. comput .",
    "phys . _ * 1995 * , _ 117 _ , 119 van der  spoel ,  d. ; lindahl ,  e. ; hess ,  b. ; groenhof ,  g. ; mark ,  a.  e. ; berendsen ,  h. j.  c. _ j. comput . chem . _ * 2005 * , _ 26 _ , 17011718 phillips ,  j.  c. ; braun ,  r. ; wang ,  w. ; gumbart ,  j. ; tajkhorshid ,  e. ; villa ,  e. ; chipot ,  c. ; skeel ,  r.  d. ; kal ,  l. ; schulten ,  k. _ j. comput . chem . _ * 2005 * , _ 26 _ , 1781802 tuckerman ,  m. ; berne ,  b.  j. ; martyna ,  g.  j. _ j. chem .",
    "phys . _ * 1992 * , _ 97 _ , 19902001 sexton ,  j.  c. ; weingarten ,  d.  h. _ nucl . phys .",
    "b _ * 1992 * , _ 380 _ , 665677 bussi ,  g. ; donadio ,  d. ; parrinello ,  m. _ j. chem .",
    "phys . _ * 2007 * , _ 126 _ , 014101 bussi ,  g. ; parrinello ,  m. _ phys . rev .",
    "e _ * 2007 * , _ 75 _ , 056707 cornell ,  w.  d. ; cieplak ,  p. ; bayly ,  c.  i. ; gould ,  i.  r. ; merz ,  k.  m. ; ferguson ,  d.  m. ; spellmeyer ,  d.  c. ; fox ,  t. ; caldwell ,  j.  w. ; kollman ,  p.  a. _ j. am . chem .",
    "_ * 1995 * , _ 117 _ , 51795197 biesiadecki ,  j.  j. ; skeel ,  r.  d. _ j. comput .",
    "* 1993 * , _ 109 _ , 318328 morrone ,  j.  a. ; markland ,  t.  e. ; ceriotti ,  m. ; berne ,  b.  j. _ j. chem .",
    "phys . _ * 2011 * , _ 134 _ , 014103 leimkuhler ,  b. ; margul ,  d.  t. ; tuckerman ,  m.  e. _ mol . phys .",
    "_ * 2013 * , _ 111 _ , 35793594 lippert ,  r.  a. ; predescu ,  c. ; ierardi ,  d.  j. ; mackenzie ,  k.  m. ; eastwood ,  m.  p. ; dror ,  r.  o. ; shaw ,  d.  e. _ j. chem .",
    "phys . _ * 2013 * , _ 139 _ , 164106 leimkuhler ,  b. ; matthews ,  c. _ amrx appl .",
    ". express _ * 2013 * , _ 2013 _ , 3456 nos ,  s. _ j. chem .",
    "_ * 1984 * , _ 81 _ , 511519 hoover ,  w.  g. _ phys . rev",
    ". a _ * 1985 * , _ 31 _ , 16951697 sivak ,  d.  a. ; chodera ,  j.  d. ; crooks ,  g.  e. _ phys . rev .",
    "x _ * 2013 * , _ 3 _ , 011007 gardiner ,  c.  w. _ handbook of stochastic methods _ , 3rd ed . ;",
    "springer : berlin , 2003 rossky ,  p.  j. ; karplus ,  m. ; rahman ,  a. _ biopolymers _ * 1979 * , _ 18 _ , 825854 jorgensen ,  w.  l. ; chandrasekhar ,  j. ; madura ,  j.  f. ; impey ,  r.  w. ; klein ,  m.  l. _ j. chem .",
    "* 1983 * , _ 79 _ , 926935 hornak ,  v. ; abel ,  r. ; okur ,  a. ; strockbine ,  b. ; roitberg ,  a. ; simmerling ,  c. _ proteins _ * 2006 * , _ 65 _ , 712725 hess ,  b. ; kutzner ,  c. ; van der  spoel ,  d. ; lindahl ,  e. _ j. chem .",
    "theory comput .",
    "_ * 2008 * , _ 4 _ , 435447 darden ,  t. ; york ,  d. ; pedersen ,  l. _ j. chem .",
    "* 1993 * , _ 98 _ , 1008910092 hess ,  b. _ j. chem .",
    "theory comput .",
    "_ * 2008 * , _ 4 _ , 116122 babin ,  v. ; roland ,  c. ; darden ,  t.  a. ; sagui ,  c. _ j. chem .",
    "_ * 2006 * , _ 125 _ , 204909 ding ,  s.  c. ; pyle ,  a.  m. _ methods enzymol . _ * 2012 * , _ 511 _ , 131147 parrinello ,  m. ; rahman ,  a. _ j. appl .",
    "phys . _ * 1981 * , _ 52 _ , 71827190 best ,  r.  b. ; hummer ,  g. _ j. phys .",
    "b _ * 2009 * , _ 113 _ , 90049015 lindorff - larsen ,  k. ; piana ,  s. ; palmo ,  k. ; maragakis ,  p. ; klepeis ,  j.  l. ; dror ,  r.  o. ; shaw ,  d.  e. _ proteins _ * 2010 * , _ 78 _ , 19501958 prez ,  a. ; marchn ,  i. ; svozil ,  d. ; sponer ,  j. ; cheatham  iii ,  t.  e. ; laughton ,  c.  a. ; orozco ,  m. _ biophys . j. _ * 2007 * , _ 92 _ , 38173829 zgarbov ,  m. ; otyepka ,  m. ; poner ,  j. ; mldek ,  a. ; banv s ,  p. ; cheatham ,  t.  e. ; jureka ,  p. _ j. chem .",
    "theory comput . _ * 2011 * , _ 7 _ , 28862902 appleby ,  t.  c. ; robert ,  a. ; fedorova ,  o. ; pyle ,  a.  m. ; wang ,  r. ; liu ,  x. ; brendza ,  k.  m. ; somoza ,  j.  r. _ j. mol .",
    "biol . _ * 2011 * , _ 405 _ , 11391153 grubmuller ,  h. ; heymann ,  b. ; tavan ,  p. _ science _ * 1996 * , _ 271 _ , 997999 jarzynski ,  c. _ phys . rev .",
    "lett . _ * 1997 * , _ 78 _ , 26902693 colizzi ,  f. ; bussi ,  g. _ j. am .",
    "soc . _ * 2012 * , _ 134 _ , 51735179 andersen ,  h.  c. _ j. chem . phys .",
    "_ * 1980 * , _ 72 _ , 23842393"
  ],
  "abstract_text": [
    "<S> many recently introduced enhanced sampling techniques are based on biasing coarse descriptors ( collective variables ) of a molecular system on the fly . </S>",
    "<S> sometimes the calculation of such collective variables is expensive and becomes a bottleneck in molecular dynamics simulations . </S>",
    "<S> an algorithm to treat smooth biasing forces within a multiple time step framework is here discussed . </S>",
    "<S> the implementation is simple and allows a speed up when expensive collective variables are employed . </S>",
    "<S> the gain can be substantial when using massively parallel or gpu - based molecular dynamics software . </S>",
    "<S> moreover , a theoretical framework to assess the sampling accuracy is introduced , which can be used to assess the choice of the integration time step in both single and multiple time step biased simulations . </S>"
  ]
}