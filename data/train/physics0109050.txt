{
  "article_text": [
    "over the last few decades advances in techniques , models and computer power have made simulation methods  @xcite an indispensable aid to research in condensed matter , molecular physics and chemistry , and in materials science . by emulating the conditions under which experiments are carried out and the interactions between the components of the system as closely as possible",
    ", simulations can often provide information that is not directly attainable from the experiments themselves , and can help to interpret the empirical observations .",
    "there are two large groups of simulation methods that are capable of taking thermal effects into account , namely the monte carlo  ( mc ) and the molecular dynamics  ( md ) methods . in this work",
    "it is the latter that will be of interest .",
    "conventional md consists of numerically integrating the classical equations of motion for an ensemble of atoms representative of the system of interest .",
    "assuming ergodicity , a sufficiently long trajectory will sample the whole of the accessible phase space under the conditions of the simulation , and a time average over such a trajectory of any property of the simulated system will provide an estimate of the value of that property in the real system under the same conditions .",
    "the classical equations of motion conserve the total energy , so this procedure simulates the system of interest in the _ microcanonical _ ( constant number of particles , n , constant volume , v , and constant energy , e , or nve ) ensemble .",
    "however , experiments are most frequently conducted under conditions of constant temperature , and sometimes also constant pressure , conditions which correspond to the _ canonical _ ( nvt ) or _ isothermal - isobaric _ ( npt ) ensembles respectively .",
    "it would therefore be desirable to have md methods that were capable of sampling these ensembles also . in a seminal paper , andersen",
    "@xcite proposed two different methods for conducting md simulations in the canonical and iso - shape isobaric - isoenthalpic ( nph , where h is the enthalpy ) ensembles , methods which could be combined to perform simulations sampling the isothermal - isobaric ensemble .",
    "nvt  md method involved a series of stochastic _ collisions _ which changed the velocity of a randomly chosen atom in the system to one generated from a maxwell - boltzmann distribution of velocities at the desired temperature .",
    "such a series of collisions changes the total energy of the system so that it fluctuates around its equilibrium value as prescribed by the canonical ensemble . as for the constant - pressure ( _ isobaric - isoenthalpic _ or nph ) ensemble ,",
    "andersen showed that it could be sampled by incorporating the volume as a new degree of freedom in the classical equations of motion , with a fictitious mass and velocity associated to it .",
    "andersen s idea of extending the dynamics of a physical system by including fictitious degrees of freedom has proved to be extremely powerful .",
    "andersen himself@xcite postulated that using this method it might be possible to perform nvt dynamics in a non - stochastic fashion .",
    "indeed , such a method was put forward by nos  @xcite , and later modified by hoover  @xcite .",
    "the same idea was to be used by parrinello and rahman  @xcite for flexible - cell ( as opposed to iso - shape ) constant - pressure md , and by car and parrinello  @xcite , who combined in an ingenious way the classical dynamics of ions with the fictitious dynamics of the electronic orbitals expanded in a plane - wave basis set , within a density functional theory description of the electronic structure .",
    "this was done in such a way that as the ions moved , the electronic orbitals followed adiabatically , so that the system remained in the ground state , or sufficiently close to it , allowing car and parrinello to carry out _ ab initio _",
    "md for the first time .",
    "although the extended dynamics approach has proved very useful for sampling ensembles beyond the microcanonical one , over time a number of shortcommings have been detected , both with the nos - hoover method for nvt sampling and the parrinello - rahman method for nph simulations .",
    "the method originally proposed by nos involved a time transformation , as a result of which the phase space is not sampled at regular time intervals . while this in itself does not pose a problem for the calculation of thermal averages of time - independent quantities , it severely complicates the calculation of time - correlation functions .",
    "it is possible to transform the equations of motion back to real time  @xcite using a non - canonical  @xcite transformation , but then the hamiltonian structure is lost , i.e. the equations that result can not be derived from a hamiltonian . although the lack of hamiltonian structure in the nos - hoover equations poses no practical difficulties ( both iterative  @xcite and explicit  @xcite integrators can be derived for these equations ) , it is undesirable from a formal point of view , not least because the usual machinery of statistical mechanics is not directly applicable to non - hamiltonian systems ( see the recent work of tuckerman and coworkers  @xcite concerning this point ) .",
    "recently , bond , leimkuhler and laird  @xcite have shown that it is possible to obtain nvt sampling ( subject to the usual assumption of ergodicity ) starting from nos s original hamiltonian , but acted upon by a poincar transformation .",
    "the transformation is canonical , and therefore preserves the form of the equations of motion ; thus , all the recent developments in integration schemes for hamiltonian systems  @xcite ( see below ) can be used to solve numerically the resulting equations of motion .",
    "furthermore , the poincar transformation is chosen in such a way that the sampling of the phase space takes place at regular time intervals .",
    "thus , the scheme of bond _ et al . _",
    "@xcite overcomes the negative aspects associated with the nos - hoover method .",
    "concerning the constant - pressure schemes , parrinello and rahman formulated their method taking as extended variables the cartesian components of the simulation cell vectors , and constructing a fictitious kinetic energy term from their squared velocities .",
    "as noted by cleveland  @xcite and by wentzcovitch  @xcite , this choice leads to equations of motion that are not invariant under transformations between equivalent cells ( modular transformations ) , leading to unphysical symmetry breaking effects .",
    "an added difficulty is that the fictitious dynamics based on this choice of variables results in spurious cell rotations , which complicate the analysis of the results .",
    "numerous proposals to overcome these difficulties have appeared in the literature  @xcite , but here i am going to focus on the method proposed by souza and martins  @xcite , which uses as fictitious dynamical variables the components of the cell metric tensor . the metric tensor is independent of the cell orientation , and by phrasing the dynamics in terms of it , spurious cell rotations simply do not appear .",
    "furthermore , the fictitious kinetic energy associated with the metric tensor can easily be constructed such that it is invariant with respect to modular transformations .",
    "important advances have also been achieved in the understanding and design of integrators for dynamical systems  @xcite .",
    "classical hamiltonian dynamics is time reversible ( if the hamiltonian is an even function of the momenta ) and symplectic , i.e. it preserves the sum of areas spanned by the vector products @xmath0 , the area element around the point @xmath1 .",
    "it is desirable that numerical integrators for hamiltonian equations of motion respect the symmetries underlying hamiltonian dynamics , such as time reversibility and symplecticness , as then one can be more confident that the discrete - time solution will resemble more closely the exact solution .",
    "thus considerable efforts have been devoted to the development of integrators which comply with these requirements , and modern simulation techniques should take advantage of the progress achieved in this field .",
    "constant - pressure algorithms such as the method of parrinello - rahman and its variants sample the isobaric - isoenthalpic ensemble . however , this ensemble is not very common , nor indeed is it very convenient .",
    "in many circumstances it is desirable to have control over the average temperature , and it is therefore preferable to perform a simulation which samples the isothermal - isobaric ensemble .",
    "this can be achieved by combining one of the constant - pressure algorithms with a nos - type thermostat .",
    "the purpose of this paper is to describe how the metric - tensor based scheme of souza and martins  @xcite for constant - pressure simulations can be combined with the nos - poincar scheme of bond _ et al . _",
    "@xcite to provide an extended hamiltonian for isothermal - isobaric md simulations with full - cell flexibility , incorporating the advantages of both methods over the original schemes of nos - hoover and parrinello - rahman .",
    "similar schemes have been recently presented by sergi _",
    "et al . _",
    "@xcite and by sturgeon and laird  @xcite , but only in the case of isotropic cell fluctuations .",
    "it is shown how the equations of motion that result in the present scheme can be integrated numerically using the _ generalised leap - frog _",
    "method  @xcite , leading to a symplectic , highly stable algorithm .",
    "this npt md algorithm is then illustrated with a series of realistic test cases , namely npt simulations of diamond and crystalline silicon .",
    "the structure of the paper is as follows : in section  [ sec : methodology ] the necessary background on the metric - tensor constant - pressure and nos - poincar isothermal formalisms is reviewed , both schemes are then combined , and a recipe for integrating the resulting equations of motion numerically is provided .",
    "the methodology is then applied to the test cases in section  [ sec : applications ] , and the conclusions are summarized in section  [ sec : conclusions ] .",
    "classical lagrangian and hamiltonian mechanics@xcite provide elegant theoretical frameworks in which to set up equations of motion for the system under study , using the variables or coordinates most convenient in each situation .",
    "the _ generalized leap - frog _ integration scheme that will be used below is most readily applied to hamiltonian equations , and therefore the hamiltonian formulation of classical mechanics will be used in what follows , although the lagrangian treatment is of course totally equivalent .",
    "when considering a system in which both the volume and shape of the simulation cell are allowed to evolve in time , it is helpful to take into account the covariant / contravariant character of the dynamical variables .",
    "therefore , in the following , the covariant or contravariant character of the different variables that will be used shall be indicated by means of a subindex or superindex , respectively .",
    "let us now review the set of dynamical variables which will be used to specify the state of the system .",
    "firstly , it will be most convenient to use _ lattice coordinates _ , @xmath2 , which give the position of atom _",
    "i _ relative to the simulation cell . the dynamics of atoms is then fully accounted for by considering the momenta @xmath3 , conjugate to @xmath2 .",
    "lattice coordinates are related to the usual cartesian ones , @xmath4 , through @xmath5 where @xmath6 is a @xmath7 matrix formed by the simulation cell vectors @xmath8 in columns . since the cell vectors @xmath9 are linearly independent , matrix @xmath6 can be inverted , and its inverse , @xmath10 , has row @xmath11 equal to @xmath12 , the reciprocal vector of @xmath9 in the following sense : @xmath13 the calculation of interatomic distances when atom positions are specified in terms of lattice coordinates is given by : @xmath14 where @xmath15 is the metric tensor , with elements @xmath16 the volume of the simulation cell is also given by the metric tensor as @xmath17 .",
    "the set of vectors @xmath12 also define a metric tensor , @xmath18 , which is reciprocal to the previous one .",
    "souza and martins@xcite have shown that the metric tensor constitutes a very convenient dynamical variable for constant - pressure md simulations .",
    "firstly , @xmath15 is invariant under cell rotations ; the orientation of the cell is irrelevant , and thus spurious cell rotations do not appear during the dynamics .",
    "secondly , it is easy to set up a fictitious kinetic energy term associated with the metric tensor ( see below ) which is invariant under modular transformations@xcite ( i.e. transformations between the different possible cells compatible with the periodicity of the system ) .",
    "this avoids artificial symmetry breaking effects .",
    "thus , spurious cell rotations and symmetry breaking effects , which appeared in the original parrinello - rahman@xcite constant - pressure algorithm , are naturally avoided in this formalism . following souza and martins , each metric tensor component",
    "@xmath19 has a conjugate momentum @xmath20 , and the fictitious kinetic energy term associated to the dynamics of the metric tensor is @xmath21 where the sum over repeated indices is implied . here",
    "@xmath22 is a fictitious mass , but the total effective mass is @xmath23 , which varies with the cell volume . while it would be possible to use a constant fictitious mass , this form has the particularity of reducing the kinetic energy expression in eq .",
    "( [ eq : metric_k ] ) to the same form as in andersen s constant - pressure scheme in the case of iso - shape cell fluctuations .    in the case of hydrostatic external pressure ,",
    "the potential energy term associated to the metric dynamics is simply @xmath24 souza and martins went on to show that the case of an anisotropic external stress can also be contemplated , if a potential energy term of the form @xmath25 is included , where @xmath26 are the components of the external stress in contravariant lattice coordinates .",
    "the combined dynamics of atoms and metric tensor described so far conserves the enthalpy ( the generalized enthalpy of thurston@xcite , in the case of constant anisotropic external stress ) , and samples the isobaric - isoenthalpic ( nph ) ensemble .",
    "it is therefore desirable to combine the dynamics of the extended system of atoms and metric tensor with a device that enables sampling of the isobaric - isothermal ( npt ) ensemble .",
    "souza and martins used stochastic langevin dynamics in the examples reported in their work .",
    "a different strategy will be pursued here , which consists of coupling the dynamics of atoms and metric tensor with a nos thermostat , as described in what follows .",
    "canonical ( nvt ) md simulations have been usually undertaken by means of the so called nos - hoover method .",
    "recently , however , bond _ et al . _",
    "@xcite have provided an alternative scheme , which also samples the nvt ensemble , but has the additional advantage of being hamiltonian in structure , thereby permitting the use of symplectic numerical integrators .",
    "this is achieved by performing a poincar transformation on the original nos hamiltonian , @xmath27 , which results in @xmath28 where @xmath29 is a suitably chosen constant , and @xmath27 is given by ( in cartesian coordinates ) @xmath30 here @xmath31 is the position variable of the thermostat , a strictly positive quantity , @xmath32 its conjugate momentum , @xmath33 is the number of degrees of freedom of the physical system ( i.e. excluding extended or fictitious dynamical variables ) , @xmath34 is boltzmann s constant , and @xmath35 is the temperature of the thermostat .",
    "bond and coworkers have demonstrated that , under the assumption of ergodicity , the nos - poincar hamiltonian generates dynamics that sample the canonical ensemble , as desired .",
    "recently , sturgeon and laird@xcite have extended the nos - poincar hamiltonian with an andersen barostat , which implements iso - shape cell fluctuations , thereby sampling the isothermal - isobaric ( npt ) ensemble appropriate for non - crystalline systems . for crystalline solids , however , it is necessary to allow fluctuations of the cell shape as well as of its volume , which can be done by means of the metric tensor dynamics described above .",
    "the scheme presented here can therefore be regarded as a generalization of the method reported by sturgeon and laird to full - cell dynamics npt md simulations .    by combining the nos - poincar hamiltonian [ eq .  ( [ eq : nose - poincare ] ) ] of bond and coworkers@xcite with the metric tensor constant - pressure scheme of souza and martins@xcite , one arrives at the following hamiltonian : @xmath36 \\nonumber .",
    "\\label{eq : npthamiltonian}\\end{aligned}\\ ] ] in this equation , lower case labels _ p _ and _ q _ refer to atomic momenta and position variables of the physical system of interest , while labels in upper case refer to fictitious degrees of freedom ( thermostat or barostat ) .",
    "latin indices label atoms , always appear first and are always used as subindices , while greek indices label components of tensors , and if used as subindices appear after the atom label .",
    "sums over atoms , as in the atomic kinetic energy term , are written out explicitly ; otherwise the summation over repeated indices of tensorial quantities is implied .",
    "thus , @xmath37 is the covariant @xmath11 component of the momentum of atom _",
    "i _ , while @xmath38 is the mixed ( contravariant - covariant ) component of the second - rank tensor @xmath39 formed by the momenta associated to the components of the metric tensor * g*. the constant @xmath29 is to be chosen so that @xmath40 has a value of zero .    using the standard rules of classical mechanics@xcite , and with the help of the relations @xmath41 and @xmath42 , it is straight forward to obtain the following equations of motion :    @xmath43   \\\\ %     \\tag{\\theequation d } \\\\",
    "\\dot{s } & = & s \\ , \\frac{p_s}{m_s } \\\\",
    "%   \\tag{\\theequation e } \\\\",
    "\\dot{p}_s & = & \\sum_i \\frac{p_{i\\alpha}\\ : p_i^\\alpha}{m_i\\ , s^2 } -       g\\ , k_b t_{ext } - \\delta h   % \\tag{\\theequation } % \\end{align } \\label{eq : nptequations}\\end{aligned}\\ ] ]    where the dot indicates a time derivative , and @xmath44    let us now turn to the question of how to obtain a numerical scheme to integrate these equations of motion . of the different schemes that are possible",
    ", i have chosen to use the _ generalized leap - frog scheme _",
    "( glf)@xcite , which is simple , and since the system is hamiltonian@xcite , the numerical procedure that results from applying the glf to eqs .",
    "( [ eq : nptequations ] ) is symplectic and time - reversible@xcite .",
    "let us briefly recall how the glf works : let @xmath45 represent position and momentum variables respectively .",
    "the eqs .",
    "( [ eq : nptequations ] ) can be generally put in the form @xmath46 the glf scheme consists of first propagating the momentum variables half a time - step forward from the initial point in phase space : @xmath47/2 , \\label{eq : first - step}\\end{aligned}\\ ] ] where @xmath48 is the time step . note that the new momenta appear on both sides of the equation , which can lead ( and in general , does lead ) to implicit equations for the updated momentum variables .",
    "next , the position variables are updated a full time - step : @xmath49 + \\right . \\\\ & &         \\left .",
    "g[p(t+1/2\\ : \\delta t ) , q(t + \\delta t)]\\right\\}/2 . \\nonumber\\end{aligned}\\ ] ] again , due to the fact that @xmath50 appears on both sides , in the general case one obtains an implicit equation , like for the momentum variables at half step .",
    "once @xmath50 has been obtained , new forces can be calculated , and thus it is possible to bring up the momenta to full step : @xmath51/2.\\end{aligned}\\ ] ] the scheme can then be iterated by setting @xmath52 and returning to eq .",
    "( [ eq : first - step ] ) .",
    "applying the glf to the npt equations of motion  ( [ eq : nptequations ] ) leads to the following numerical scheme :    @xmath53   \\\\ %    \\tag{\\theequation b } \\\\ p_{s,1/2 } & = & p_{s,0 } + \\frac{1}{2}\\delta t \\left [     \\sum_i\\frac{p_{i\\alpha,1/2 } \\ : p_{i,1/2}^\\alpha}{m_i\\ , s^2_0 }    - g\\ , k_b t_{ext } \\ : - \\right .",
    "\\nonumber \\\\    & & \\hspace{3.0 cm } \\left .   \\delta",
    "h({\\bf q}_0 , { \\bf g}_0 , s_0 , { \\bf p}_{1/2 } ,       { \\bf p}_{g,1/2 } , p_{s,1/2 } )   \\right ] \\\\ % \\tag{\\theequation c } \\\\",
    "s_1 & = & s_0 + \\frac{1}{2 } \\delta t \\left ( s_0 \\frac{p_{s,1/2}}{m_s } +             s_1 \\frac{p_{s,1/2}}{m_s}\\right ) \\\\",
    "% \\tag{\\theequation d } \\\\",
    "g_{\\alpha\\beta,1 } & = & g_{\\alpha\\beta,0 } + \\frac{1}{2 } \\delta t     \\left ( s_0 \\frac{g_{\\beta\\lambda,0 } \\ : p^{\\lambda\\mu}_{1/2 } \\ :          g_{\\mu\\alpha,0}}{m_g \\ : \\det { \\bf g}_0 } +    s_1 \\frac{g_{\\beta\\lambda,1 } \\ : p^{\\lambda\\mu}_{1/2 } \\ :                g_{\\mu\\alpha,1}}{m_g \\ : \\det { \\bf g}_1 } \\right ) \\\\",
    "%   \\tag{\\theequation e}\\\\ q_{i,1}^\\alpha & = & q_{i,0}^\\alpha + \\frac{1}{2}\\delta t         \\left(\\frac{p_{i,1/2}^\\alpha}{m_i \\ : s_0 } +              \\frac{p_{i,1/2}^\\alpha}{m_i \\ : s_1}\\right ) \\\\",
    "% \\tag{\\theequation f } \\\\ p_{s,1 } & = & p_{s,1/2 } + \\frac{1}{2 } \\delta t \\left [    \\sum_i \\frac{p_{i\\alpha,1/2 } \\ : p_{i,1/2}^\\alpha}{m_i \\ :            s^2_1 } - g\\ , k_b t_{ext } \\ : - \\right .",
    "\\nonumber \\\\           & & \\hspace{3.0 cm } \\left .           \\delta",
    "h({\\bf q}_1 , { \\bf g}_1 , s_1,{\\bf p}_{1/2 } ,          { \\bf p}_{g,1/2 } , p_{s,1/2 } ) \\right ] \\\\ % \\tag{\\theequation g } \\\\ p^{\\alpha\\beta}_1 & = & p^{\\alpha\\beta}_{1/2 } - \\frac{1}{2 } \\delta t \\",
    ":   s_1 \\left [ \\frac{\\partial { \\cal u}}{\\partial g_{\\alpha\\beta,1 } }   -\\sum_i\\frac{p_{i,1/2}^\\alpha \\",
    ": p_{i,1/2}^\\beta}{2 \\ , m_i \\ : s^2_1 }   + \\frac{p^{\\beta\\lambda}_{1/2 } \\ : g_{\\lambda\\mu,1 } \\ :    p^{\\mu\\alpha}_{1/2}}{m_g\\ : \\det{\\bf g}_1 } \\right .",
    "\\nonumber \\\\            & & \\hspace{3.0 cm } \\left .",
    "+ \\left(\\frac{1}{2}{\\cal p}_{ext } \\ , \\sqrt{\\det { \\bf g}_1 } -    \\frac{p^\\lambda_{\\ \\mu,1/2 } \\ : p_{\\ \\lambda,1/2}^\\mu }    { 2 \\ , m_g \\ : \\det{\\bf g}_1}\\right ) g^{\\beta\\alpha}_1 +      \\frac{1}{2 } \\sigma_{ext}^{\\beta\\alpha}\\right ] \\\\",
    "%    \\tag{\\theequation h } \\\\",
    "p_{i\\alpha,1 } & = & p_{i\\alpha,1/2 } - \\frac{1}{2 } \\delta t \\ :       s_1 \\frac{\\partial { \\cal u}}{\\partial q_{i,1}^\\alpha } %     \\tag{\\theequation i } % \\end{align } \\label{eq : numericalnpt}\\end{aligned}\\ ] ]    in these equations , subindices of 0 , 1/2 and 1 indicate that the corresponding dynamical variable should be taken at zero , half or full time step from the initial point in phase space .",
    "( [ eq : numericalnpt]a - c ) propagate the momenta forward in time by half a time step ; eqs .",
    "( [ eq : numericalnpt]d - f ) advance the position variables the whole length of the time step , and finally eqs .",
    "( [ eq : numericalnpt]g - i ) complete the updating of the momenta to full time - step .",
    "the order in which eqs .",
    "( [ eq : numericalnpt ] ) are written corresponds to the order in which they must be implemented in a computer code . note that",
    ", as indicated above , some of the equations are implicit . in particular , eq .",
    "( [ eq : numericalnpt]b ) is implicit in the metric tensor momenta at half time step , and must be solved iteratively .",
    "this is also the case for the metric tensor components themselves , in eq .",
    "( [ eq : numericalnpt]e ) .",
    "two strategies can be adopted for solving these equations : a newton - raphson@xcite procedure can be easily applied , but a simple iterative scheme seems to work equally well and is even simpler to program . in the example applications reported below , the iterative scheme was used .",
    "this consisted of using as initial guess for the half - step metric - tensor momenta in eq .",
    "( [ eq : numericalnpt]b ) ( @xmath54 ) their values at the start of the molecular dynamics time step ( i.e.  @xmath55 ) .",
    "the resulting values for @xmath54 are then fed again into eq .",
    "( [ eq : numericalnpt]b ) , thus obtaining a new estimate for the correct values at half - step .",
    "this procedure is iterated until the absolute values of the differences of @xmath54 found in two successive iterations of the procedure differ by less than @xmath56 . since , for a sufficiently small time step , the values of @xmath55 are close to those of @xmath54 , this procedure converges very rapidly , requiring only a few iterations .",
    "exactly the same procedure was followed for solving eq .",
    "( [ eq : numericalnpt]e ) .",
    "it should be emphasized that the implicit nature of eqs .",
    "( [ eq : numericalnpt]b ) and  ( [ eq : numericalnpt]e ) does not have any significant impact on performance ; the iterative procedure is very fast , and does not require re - evaluation of the energy , force or stress ; however , because of the fact that a convergence criterion must be used , the exact time - reversibility of the equations of motion [ eqs .",
    "( [ eq : nptequations ] ) ] is lost in the numerical scheme of eqs .",
    "( [ eq : numericalnpt ] ) .",
    "nevertheless , the use of a strict convergence criterion makes the scheme time - reversible within numerical accuracy .",
    "equation  ( [ eq : numericalnpt]c ) also deserves attention ; it is quadratic in @xmath57 , and care must be taken to choose the right root and avoid numerical cancellation errors@xcite .",
    "equations  ( [ eq : numericalnpt ] ) are quite simple to incorporate into existing md codes .",
    "the only additional information required from what is conventionally computed in an md program are the derivatives of the potential energy with respect to the metric tensor components , @xmath58 .",
    "these can be obtained taking into account that inter atomic distances depend on the components of the metric tensor , as indicated in eq .",
    "( [ eq : distance ] ) .",
    "however , if the program already computes the derivatives @xmath59 , where @xmath60 are the components of the cartesian strain tensor , this information can be converted into the required derivatives in a straight forward fashion , as the strain and metric tensors are related through@xcite @xmath61,\\end{aligned}\\ ] ] where @xmath62 is the inverse of the undistorted cell matrix , and * 1 * is the unit matrix .",
    "then , by simple application of the chain rule , one obtains the following relation : @xmath63 where again summation over repeated indices is implied .",
    "the metric tensor nos - poincar npt method described in section  [ sec : methodology ] has been implemented in a computer program which performs md simulations of systems described with a tight binding@xcite  ( tb ) total energy model . in this section , after a brief description of the model used , i will report the results of tests of the methodology and some examples of applications directed at demonstrating its usefulness .",
    "the npt algorithm described in this paper applies equally well to any atomistic model from which forces and stresses , as well as the total energy , can be obtained , and therefore any such models can be used in conjunction with it .",
    "atomistic models can be broadly classified into three groups , namely _ empirical potential _ methods , _ semi - empirical _ total energy methods and _ first principles _ or _ ab initio _ total energy methods .",
    "each group of methods has its strengths and weaknesses ; for example , empirical potential methods are computationally cheap , but _",
    "ad hoc _ in nature , and therefore of limited reliability and transferability .",
    "first principles methods , on the other hand , rest on firm theoretical grounds , but are orders of magnitude more demanding computationally than empirical potentials",
    ". added difficulties here are the bad scaling of the computational cost with the size of the system under study ( usually , for electronic structure methods the cost scales as @xmath64 or worse , where @xmath65 is the number of atoms , although considerable progress towards linear - scaling methods@xcite has been achieved in recent years ) , and , of specific relevance to constant - pressure simulations , the accuracy of the total energy and its derivatives depends on the volume of the simulation cell , unless highly converged integrations over the irreducible cell of the reciprocal lattice are used@xcite .    in the applications that follow ,",
    "i have chosen to use an approximate tight binding  ( tb ) model@xcite , which corresponds to the group of semi - empirical methods discussed above .",
    "this choice is motivated by several considerations .",
    "being in between the extremes of empirical potentials and first principles methods , it shares some of the advantages ( but also some of the disadvantages ) of both .",
    "its computational demands are very modest ; it is based on a quantum treatment of the valence electrons , even if at a rather simplified level , and therefore it incorporates the essential features of the quantum nature of the chemical bond . in spite of their simplicity ,",
    "there exist tb models which are capable of surprising accuracy in their predictions .",
    "in particular , the applications reported below have been carried out using a tb model due to porezag and coworkers@xcite .",
    "it goes beyond conventional tb models in that it incorporates the non - orthogonality of the basis set , which is usually assumed to be orthogonal , is constructed on the basis of density functional calculations employing the same basis set , and the range of the hopping integrals extends beyond the nearest neighbor distance , which is the range used in most tb models .",
    "additional details on this model can be found in the paper by porezag _",
    "et al._@xcite .",
    "= 8.5 cm      to illustrate the stability and accuracy of the integration scheme embodied in eqs .",
    "( [ eq : numericalnpt]a - i ) , a simulation of diamond at 0  gpa external pressure and a temperature of 1000  k was performed .",
    "this is well below the debye temperature of diamond ( 2340  k ) , and therefore it is strictly speaking not justified to perform a classical md simulation at this temperature . nevertheless the aim here is to test the methodology , and not to extract any conclusions on the physics of diamond at 1000  k. the starting configuration of the system consisted of  54 atoms at their equilibrium positions in a cell of edge length 14.33  bohr ( 7.58   ) , with the edges forming @xmath66  angles .",
    "initial velocities were chosen randomly from the maxwell - boltzmann distribution at the desired temperature , and modified to eliminate any translation of the center of mass .",
    "the fictitious mass of the nos thermostat was chosen to be equal to the mass of a carbon atom , while for the barostat a mass of 10  au was used .",
    "both thermostat and barostat were assigned zero initial momenta , and the value of @xmath67 at zero time fixes the value of @xmath29 .    the total energy of the system [ @xmath68 in eq .",
    "( [ eq : npthamiltonian ] ) ] was calculated using the tb  model of porezag and coworkers  @xcite described above .",
    "the generalized eigenvalue equation that results for each system configuration according to this model was solved using direct diagonalisation , and a set of  4 reciprocal lattice vectors chosen according to the monkhorst - pack scheme  @xcite were used , which were sufficient to converge the total energy better than 0.04  mev / atom .",
    "the length of the time step was set to 1  fs , and the simulation was run for a total of 10  ps .",
    "= 8.5 cm    in fig .",
    "( [ fig : energies ] ) the different terms contributing to @xmath67 [ eq .  ( [ eq : npthamiltonian ] ) ]",
    "have been plotted as a function of time for the first 0.5  ps of the simulation . the _ physical energy _ is the sum of the kinetic and potential energy terms , calculated from the atomic momenta and from @xmath68 , respectively .",
    "the thermostat and barostat contributions include both the kinetic and potential energy terms associated to each of these fictitious degrees of freedom ( the barostat energy has been scaled by a factor of 100 so that it can be appreciated on the graph ) .",
    "note that , as expected , the total energy of the atoms ( their kinetic plus potential energy , the physical energy ) , is not conserved , contrary to what would happen in a conventional microcanonical ( nve )  md simulation . in the present case , it is @xmath67 that is the conserved quantity , and as can be seen from fig .",
    "( [ fig : energies ] ) , this is indeed approximately conserved by the numerical scheme of eqs .",
    "( [ eq : numericalnpt]a - i ) . to judge how well @xmath67",
    "is conserved during the dynamics , it has been plotted in fig .",
    "( [ fig : hnpt ] ) for the whole length of the simulation . except at the very first stages of the calculation , the deviations of @xmath67 from its mean value are smaller than 0.0005  hartree , and its standard deviation has been computed to be 0.00015  hartree .",
    "no drift is observed during the trajectory ; simulations of up to 50  ps ( see below ) were also carried out , and again , no appreciable drift was observed , testifying to the stability of the method .",
    "= 8.5 cm    figs .",
    "( [ fig : cell - axis ] ) and  ( [ fig : cell - angles ] ) illustrate the time evolution of the super - cell edge lengths and angles during the first 5  ps of the simulation , respectively .",
    "the edges start at time zero having equal lengths , corresponding to that of a 54-atom cell at 0  k , but as the simulation proceeds each cell parameter evolves separately . note how the average values of the moduli of the cell vectors settle at a higher value than the 0  k one , namely at 14.41  bohr ( obtained by averaging over the whole length of the simulation ) .",
    "this is due to the thermal expansion of diamond from 0 to 1000  k , though it should be emphasized that one must not expect an accurate estimation of the thermal expansion in this case , partly because of the complete neglect of quantum effects , which , as indicated above , are important below the debye temperature .",
    "the cell angles also evolve independently shortly after the start of the simulation , but contrary to what happens with the cell vector moduli , which evolve to a different mean value , the cell angles oscillate around their initial value of  @xmath66 , with their instantaneous values remaining within @xmath69 , indicating that , although the cell expands due to the thermal motion of the atoms at 1000  k , it does not change its shape .",
    "= 8.5 cm    fig .",
    "( [ fig : volume ] ) illustrates the time evolution of the cell volume and the internal pressure during the first 5  ps of the simulation .",
    "as expected , these two magnitudes display opposite behavior , in the sense that when the volume is lowest , the internal pressure is highest , and vice versa .",
    "like the cell vector moduli [ fig .",
    "( [ fig : cell - axis ] ) ] , the volume expands from the 0  k value to a slightly larger value appropriate to the temperature of the simulation , around which its value oscillates .",
    "the internal pressure , on the other hand , oscillates around 0  gpa , the value fixed for the external pressure in this simulation . at the end of the trajectory , the thermal averages of the internal pressure and the temperature of the system were computed to be 0.2  gpa and 999.7  k respectively , in good agreement with the imposed external values .",
    "= 8.5 cm      silicon has a smaller debye temperature than diamond , c.a .",
    "640  k , and i will therefore use classical md to study its thermal expansion above this temperature .",
    "a series of npt simulations at 0  gpa external pressure and different temperatures have been carried out .",
    "the total length of the simulation was 50  ps , using a time step of 1  fs .",
    "the external temperature of the simulation was varied in steps of 50  k between 700 and 1600  k , and at each such temperatures a simulation was conducted . in all of them the value of @xmath67 was accurately conserved , and no appreciable drift in its value was observed .",
    "the variation of the silicon cell parameter with temperature is illustrated in fig .",
    "( [ fig : cell_vs_t ] ) .",
    "qualitatively , two approximately linear behaviors can be observed , between 700 and 1150  k , and from 1150 to 1600  k , with the second range of temperatures having a slightly lower slope . as can be seen ,",
    "the behavior is not very smooth , indicating that there is still a degree of statistical noise in the thermal averages of the cell parameter computed from these simulations .",
    "i will dwell on the possible causes of this below .",
    "= 8.5 cm    in principle , from the data shown in fig .",
    "( [ fig : cell_vs_t ] ) it would be possible to calculate the thermal expansion coefficient , @xmath11 , of silicon in the range of temperatures considered , but the statistical inaccuracies present in the data make this a difficult task .",
    "the experimental value at 1000  k is @xmath70 , while from the data in the figure one can estimate a value of @xmath71 at this temperature .",
    "the thermal expansion coefficient is extremely sensitive , and given the statistical uncertainties present in the results , the calculated value can only be considered a rather crude estimate of the value predicted by the tb model used ; a more accurate estimate could be closer to the experimental value .",
    "it is instructive to consider the possible causes of the poor statistics observed in fig .",
    "( [ fig : cell_vs_t ] ) .",
    "it is certainly not due to inadequate conservation of @xmath67 , which is sufficiently well conserved throughout all the simulations .",
    "a more likely explanation is that the dynamics generated is not sampling the npt ensemble with sufficient efficiency .",
    "inefficient sampling can occur because some degrees of freedom do not easily exchange energy with the rest of the system , a situation which takes place when there are largely different frequencies present .",
    "( [ fig : volume ] ) lends some weight to this consideration .",
    "there it can be seen that the volume is oscillating quasi - harmonically with a single dominant frequency . the internal pressure , however , has two dominant frequencies : a high one , reflecting the thermal vibrations of the atoms , and a lower one , with the same frequency as the volume",
    ". sampling efficiency could be increased by reducing the difference between the high frequency oscillations in the internal pressure and the frequency of the volume motion , which can be achieved using a lower barostat fictitious mass .",
    "it should be pointed out that , formally at least , the npt ensemble is sampled independently of the values used for the masses of the fictitious degrees of freedom , provided the dynamics is ergodic . the sampling efficiency , however , does depend on the values chosen , and therefore this choice must be made with care .      in this final example , the capability of the method to cope with the simulation of systems subjected to non - hydrostatic external pressures will be illustrated .",
    "again , a 64  atom silicon supercell in the diamond structure was used as test case .",
    "the external temperature was fixed at 1000  k , and a series of simulations were performed applying an external stress in the @xmath72 $ ] direction , varying from -5 to 5  gpa in steps of 1  gpa . in the sign convention used here",
    "a positive sign indicates a compressive pressure .",
    "= 8.5 cm    in fig .",
    "( [ fig : pressure ] ) the variation of the cell axis as a function of the applied stress is shown .",
    "the supercell length in the direction of the applied stress has a negative slope , and it starts at an expanded value , larger than the equilibrium value at the same temperature and zero stress , reaching a value below this when the applied stress is compressive .",
    "the other two cell lengths have positive , though smaller , slopes , expanding as the first dimension is compressed .",
    "both @xmath73 and @xmath74 show nearly identical behavior , as expected , given the symmetry of the system .",
    "this figure illustrates how the elastic constants of materials ( in this case the poisson ratio ) could be evaluated at finite temperatures using this methodology .",
    "in this paper i have presented a stable , symplectic algorithm for integrating the hamiltonian equations of motion resulting from the combination of the souza and martins  @xcite metric tensor - based constant - pressure scheme and the nos - poincar thermostat scheme of bond and coworkers  @xcite .",
    "the dynamics generated by these equations samples the isothermal - isobaric ( npt ) ensemble with full - cell flexibility .",
    "conditions of non - hydrostatic external pressure can also be simulated .",
    "the numerical scheme advocated here is easy to implement in existing molecular dynamics codes .",
    "the capabilities of this methodology have been illustrated with a series of numerical experiments in carbon and silicon in the diamond structure , using a tight binding model .",
    "the adjective _ canonical _ is used here in two different contexts , referring to the canonical or nvt ensemble of statistical mechanics , or referring to a transformation which leaves invariant the form of the equations of motion .",
    "the meaning should be clear by context ."
  ],
  "abstract_text": [
    "<S> an extended hamiltonian approach to conduct isothermal - isobaric molecular dynamics simulations with full cell flexibility is presented . </S>",
    "<S> the components of the metric tensor are used as the fictitious degrees of freedom for the cell , thus avoiding the problem of spurious cell rotations and artificial symmetry breaking effects present in the original parrinello - rahman scheme . </S>",
    "<S> this is complemented by the nos - poincar approach for isothermal sampling . </S>",
    "<S> the combination of these two approaches leads to equations of motion that are hamiltonian in structure , and which can therefore be solved numerically using recently developed powerful symplectic integrators . </S>",
    "<S> one such integrator , the generalised leap - frog , is employed to provide a numerical algorithm for integrating the isothermal - isobaric equations of motion obtained . </S>"
  ]
}