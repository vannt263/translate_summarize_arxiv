{
  "article_text": [
    "it is widely advocated that future power grids should facilitate the integration of a significant amount of renewable energy sources .",
    "prominent examples of renewable sources are wind and solar .",
    "these differ substantially from traditional sources in terms of two important qualitative features :    * intrinsically distributed . *",
    "the power generated by these sources is typically proportional to the surface occupied by the corresponding generators .",
    "for instance , the solar power reaching ground is of the order of @xmath0 kwh per day per square meter .",
    "the wind power at ground level is of the order of @xmath1 kwh per day per square meter @xcite .",
    "these constraints on renewable power generation have important engineering implications . if a significant part of energy generation is to be covered by renewables , generation is argued to be distributed over large geographical areas .",
    "* intermittent*. the output of renewable sources varies with time and locations because of exogenous factors . for instance , in the case of wind and solar energy , the power output is ultimately determined by meteorological conditions .",
    "one can roughly distinguish two sources of variability : _ predictable variability _",
    ", e.g. related to the day - night cycle , or to seasonal differences ; _ unpredictable variability _ , which is most conveniently modeled as a random process .",
    "several ideas have been put forth to meet the challenges posed by intermittent production .",
    "the first one is to leverage geographically distributed production .",
    "the output of distinct generators is likely to be independent or weakly dependent over large distances and therefore the total production of a large number of well separated generators should stay approximately constant , by a law - of - large - number effect .",
    "this averaging effect should be enhanced by the integration of different types of generators .",
    "the second approach is to use energy storage to take advantage of over - production at favorable times , and cope with shortages at unfavorable times . finally , a third idea is ` demand response ' , which aims at scheduling in optimal ways some time - insensitive energy demands . in several cases ,",
    "this can be abstracted as some special form of energy storage ( for instance , when energy is demanded for interior heating , deferring a demand is equivalent to exploiting the energy stored as hot air inside the building ) .",
    "these approaches hedge against the energy source variability by averaging over location , or by averaging over time .",
    "each of them requires specific infrastructures : a power grid with sufficient transmission capacity in the first case , and sufficient energy storage infrastructure in the second one .",
    "further , these two directions are in fact intimately related . with current technologies ,",
    "it is unlikely that centralized energy storage can provide effective time averaging of say wind power production , in a renewables - dominated scenario . in a more realistic scheme",
    ", storage is distributed at the consumer level , for instance leveraging electric car batteries ( a scenario known as vehicle - to - grid or v2 g ) .",
    "distributed storage implies , in turn , substantial changes of the demand on the transmission system .",
    "the use of storage devices to average out intermittent renewables production is well established .",
    "a substantial research effort has been devoted to its design , analysis and optimization ( see , for instance , @xcite ) . in this line of work , a large renewable power generator",
    "is typically coupled with a storage system in order to average out its power production .",
    "proper sizing , response time , and efficiency of the storage system are the key concerns .    if , however , we assume that storage will be mainly distributed , the key design questions change . it is easy to understand that both storage and transmission capacity will have a significant effect on the ability of the network to average out the energy source variability",
    ". for example , shortfalls at a node can be compensated by either withdrawals from local storage or extracting power from the rest of the network , or a combination of both .",
    "the main goal of this paper is to understand the optimal way of utilizing simultaneously these two resources and to quantify the impact of these two resources on performance .",
    "our contributions are :    * a simple model capturing key features of the problem ; * a linear - quadratic(lq ) based methodology for the systematic design of control strategies ; * a proof of optimality of the lq control strategies in simple network topologies such as the 1-d and 2-d grids and in certain asymptotic regimes . * a quantification of how the performance depends on key parameters such as storage and transmission capacities .",
    "the reader interested in getting an overview of the conclusions without the technical details can read sections [ sec : model ] and [ sec : discussion ] only .",
    "some details are omitted and deferred to the journal version of this paper .",
    "the power grid is modeled as a weighted graph @xmath2 with vertices ( buses or nodes ) @xmath3 , edges ( lines ) @xmath4 .",
    "time is slotted and will be indexed by @xmath5 . in slot @xmath6 , at each node @xmath7 a quantity of energy @xmath8 is generated from a renewable source , and a demand of a quantity @xmath9 is received . for our purposes , these quantities only enter the analysis through the net generation @xmath10 .",
    "let @xmath11 be the vector of @xmath12 s .",
    "we will assume that @xmath13 is a stationary process .    in order to average the variability in the energy supply ,",
    "the system makes use of storage and transmission .",
    "storage is fully distributed : each node @xmath14 has a device that can store energy , with capacity @xmath15 .",
    "we assume that stored energy can be fully recovered when needed ( i.e. , no losses ) . at each time slot @xmath6",
    ", one can transfer an amount of energy @xmath16 to storage at node @xmath17 . if we denote by @xmath18{0pt}{0pt}}_{i}(t)$ ] the amount of stored energy at node @xmath17 just before the beginning of time slot @xmath6 , then : @xmath19{0pt}{0pt}}_i(0 ) = 0 , \\qquad { \\rule[-1ex]{0pt}{0pt}}_i(t+1 ) = { \\rule[-1ex]{0pt}{0pt}}_i(t ) + \\y_i(t)\\ ] ] where @xmath16 is chosen under the constraint that @xmath18{0pt}{0pt}}_i(t+1 ) \\in [ 0,s_i]$ ] .",
    "we will also assume the availability at each node of a fast generation source ( such as a spinning reserve or backup generator ) which allows covering up of shortfalls .",
    "let @xmath20 be the energy obtained from such a source at node i at time slot @xmath6 .",
    "we will use the convention that @xmath20 negative means that energy is consumed from the fast generation source , and positive means energy is dumped .",
    "the cost of using fast generation energy sources is reflected in the steady - state performance measure : @xmath21 the net amount of energy injection at node @xmath17 at time slot @xmath6 is : @xmath22 these injections have to be distributed across the transmission network , and the ability of the network to distribute the injections and hence to average the random energy sources over space is limited by the transmission capacity of the network . to understand this constraint , we need to relate the injections to the power flows on the transmission lines . to this end",
    ", we adopt a ` dc power flow ' approximation model @xcite .",
    "each edge in the network corresponds to a transmission line which is purely inductive , i.e. with susceptance @xmath23 , where @xmath24 .",
    "hence , the network is lossless .",
    "node @xmath7 is at voltage @xmath25 , with all the voltages assumed to have the same magnitude , taken to be @xmath26 ( by an appropriate choice of units ) .",
    "let @xmath27 denote the ( complex ) voltage at node @xmath17 in time slot @xmath6 . if @xmath28 is the electric current from @xmath17 to @xmath29 , the corresponding power flow is then @xmath30=\\re [ j b_{ik } ( 1 - e^{j(\\phi_i(t)- \\phi_k(t ) ) } ) ] = b_{ik } \\sin(\\phi_i(t ) - \\phi_k(t))$ ] , where @xmath31 $ ] denotes the real part of a complex number .",
    "the dc flow approximation replaces @xmath32 by @xmath33 in the above expression .",
    "this is usually a good approximation since the phase angles at neighboring nodes are typically maintained close to each other to ensure that the generators at the two ends remain in step .",
    "this leads to the following relation between angles and power flow @xmath34 . in matrix notation",
    ", we have @xmath35 where @xmath36 is the vector of all power flows , @xmath37 and @xmath38 is a @xmath39 matrix .",
    "@xmath40 if @xmath41 for some @xmath29 , @xmath42 if @xmath43 for some @xmath29 , and @xmath44 otherwise .",
    "energy conservation at node @xmath17 also yields @xmath45 where @xmath46 is an @xmath47 diagonal matrix . expressing @xmath36 in terms of @xmath48 ,",
    "we get @xmath49 where @xmath50 is a @xmath51 symmetric matrix where @xmath52 if @xmath53 , @xmath54 if @xmath55 and @xmath56 otherwise . in graph theory",
    ", @xmath57 is called the graph laplacian matrix . in power engineering ,",
    "it is simply the imaginary part of the bus admittance matrix of the network .",
    "note that if @xmath58 for all edges @xmath59 , then @xmath60 is positive semidefinite .",
    "if the network is connected ( which we assume throughout ) , it has only one eigenvector with eigenvalue @xmath56 , namely the vector @xmath61 everywhere ( hereafter we will denote this as the vector @xmath62 ) .",
    "this fits the physical fact that if all phases are rotated by the same amount , the powers in the network are not changed .    with an abuse of notation ,",
    "we denote by @xmath63 the matrix such that @xmath64 , and @xmath63 is equal to the inverse of @xmath57 on the subspace orthogonal to @xmath62 . here",
    "@xmath65 is arbitrary , and all of our results are independent of this choice ( conceptually , one can think of @xmath66 as very large ) .",
    "explicitly , let @xmath67 be the eigenvalue decomposition of @xmath57 , where @xmath68 is a diagonal matrix with non - negative entries . define @xmath69 to be the diagonal matrix with @xmath70 if @xmath71 and @xmath72 otherwise . then @xmath73 .    since the total power injection in the network adds up to zero",
    "( which must be true by energy conservation ) , we can invert and obtain @xmath74 plugging this into , we have @xmath75    there is a capacity limit @xmath76 on the power flow along each edge @xmath59 ; this capacity limit depends on the voltage magnitudes and the maximum allowable phase differences between adjacent nodes , as well as possible thermal line limits .",
    "we will measure violations of this limit by defining @xmath77    we are now ready to state the design problem :    _ for the dynamic system defined by equations ( [ eq : storage_evo ] ) and ( [ eq : flowconstruction ] ) , design a control strategy which , given the past and present random renewable supplies and the storage states , @xmath78{0pt}{0pt}}(t));\\ , ( \\z(t-1),{\\rule[-1ex]{0pt}{0pt}}(t-1 ) ) ,   \\dots , \\big \\}\\ ] ] choose the vector of energies @xmath79 to put in storage and the vector of fast generations @xmath80 such that the sum @xmath81 , cf .",
    "( [ eq : fast ] ) and ( [ eq : flow_vio ] ) , is minimized . _",
    "in this section , we propose a design methodology that is based on linear - quadratic ( lq ) control theory .      the difficulty of the control problem defined above stems from both the nonlinearity of the dynamics due to the hard storage limits and the piecewise linearity of the cost functions giving rise to the performance parameters . instead of attacking the problem directly , we consider a surrogate lq problem where the hard storage limits are removed and the cost functions are quadratic : @xmath82 with performance parameters : @xmath83 the process @xmath84 can be interpreted as the deviation of a virtual storage level process from the midpoint @xmath85 , where the virtual storage level process is no longer hard - limited but evolves linearly .",
    "instead , we penalize the deviation through a quadratic cost function in the additional performance parameters @xmath86 .",
    "the virtual processes @xmath87 , @xmath88 , @xmath89 , @xmath90 and @xmath91 are connected to the actual processes @xmath18{0pt}{0pt}}(t)$ ] , @xmath36 , @xmath80 , @xmath79 and @xmath11 via the mapping ( where @xmath92^b_a : = \\max(\\min(x , b),a)$ ] for @xmath93 ) : @xmath94{0pt}{0pt}}_i(t ) & = \\left [ \\ , b_i(t ) + s_i/2 \\ , \\right ] _",
    "0^{s_i}\\ , , \\label{eq : bmapping}\\\\ \\y_i(t ) & = { \\rule[-1ex]{0pt}{0pt}}_i(t+1 ) - { \\rule[-1ex]{0pt}{0pt}}_i(t)\\ , , \\label{eq : cbi}\\\\ \\w_i(t ) & = w_i(t ) + y_i(t ) - \\y_i(t)\\ , .\\label{eq : wi}\\end{aligned}\\ ] ] in particular , once we solve for the optimal control in the surrogate lq problem , ( [ eq : cbi ] ) and ( [ eq : wi ] ) tell us what control to use in the actual system .",
    "notice that the actual fast generation control provides the fast generation in the virtual system plus an additional term that keeps the actual storage level process within the hard limit .",
    "note also @xmath95 hence the performance parameters @xmath96 , @xmath97 can be estimated from the corresponding ones for the virtual processes .",
    "now we turn to solving the surrogate lq problem .",
    "first we formulate it in standard state - space form . for simplicity",
    ", we will assume @xmath98 is an i.i.d .",
    "process ( over time )",
    ". with memory can be in principle studied within the same framework , by introducing a linear state space model for @xmath91 and correspondingly augmenting the state space of the control problem .",
    "] hence @xmath99^t$ ] is the state of the system . also , @xmath100^t$ ] is the control and @xmath101^t$ ] is the observation vector available to the controller .",
    "then @xmath102 where @xmath103 and @xmath104 and @xmath105 .",
    "we are interested in trading off between the performance parameters @xmath106 and @xmath107 s .",
    "therefore we introduce weights @xmath108 s , @xmath109 s , @xmath110 s and define the lagrangian @xmath111 where @xmath112 and @xmath113 .",
    "we will let @xmath114 .",
    "we will also assume that @xmath115 = { \\mathbf}{i}$ ] , since if not , then we can define @xmath116^t$ ] , where @xmath117 is the symmetrical square root of @xmath118 .",
    "an _ admissible control policy _ is a mapping @xmath119 .",
    "the surrogate lq problem is defined as the problem of finding the mapping that minimizes the stationary cost @xmath120 .",
    "notice that the energy production - minus - consumption @xmath91 plays the role both in the evolution equation ( [ eq : state ] ) and the observation ( [ eq : observer ] ) .",
    "the case of correlated noise has been considered and solved for general correlation structure in @xcite .",
    "let @xmath121 = [ { \\mathbf}{i } \\ , 0 ] ^t$ ] , @xmath122^t$ ] and @xmath123^t$ ] .",
    "adapting the general result in @xcite to our special case , we have    [ lem : lqg ] the optimal linear controller for the system in and and the cost function in is given by @xmath124 where , letting @xmath125 and @xmath126 : @xmath127 \\nonumber \\\\   & = & \\left [ \\begin{array}{c } 0 \\\\ \\left",
    "[ i-\\delta(\\nabla^t\\gamma\\nabla)^{-1}\\delta\\eta\\right]^{-1}\\oz \\end{array } \\right ] , \\label{eq : ubar}\\end{aligned}\\ ] ] and @xmath128 is given by the algebraic riccati equation @xmath129 where @xmath130 , @xmath131 , and @xmath132 where @xmath133 satisfies the algebraic riccati equation @xmath134 , and @xmath135 .",
    "note that the optimal linear controller has a deterministic time - invariant component @xmath136^t$ ] and an observation - dependent control @xmath137 it is intuitive that @xmath138 , since otherwise the storage process has a non - zero drift and will become unstable .",
    "the deterministic component @xmath139 for the fast generation can be seen to be the solution of a _ static optimal power flow problem _ with deterministic net renewable generation @xmath140 and cost function given by : @xmath141 on the other hand , the observation - dependent control is obtained by solving the lq problem with the net generations shifted to zero - mean .",
    "thus , the lq design methodology naturally decomposes the control problem into a static optimal power flow problem and a dynamic problem of minimizing variances .",
    "notice that it might be also convenient to consider more general surrogate costs in which a generic quadratic function of the means @xmath142 , @xmath143 is added to the second moment lagrangian ( [ eq : cost ] ) .",
    "lemma [ lem : lqg ] gives an expression for the optimal linear controller .",
    "however , it is difficult in general to solve analytically the riccati equation . to gain further insight",
    ", we consider the case of transitive networks .",
    "an automorphism of a graph @xmath144 is a one - to - one mapping @xmath145 such that for any edge @xmath146 , we have @xmath147 . a graph is called _ transitive _ if for any two vertices @xmath148 and @xmath149 , there is some automorphism @xmath150 such that @xmath151 . intuitively , a graph is transitive if it looks the same from the perspective of any of the vertices .",
    "given an electric network , we say the network is transitive if it has a transitive graph structure , every bus has the same associated storage , every line has the same capacity and inductance , and @xmath152 is i.i.d . across the network .",
    "without loss of generality , we will assume @xmath153 , @xmath154 , @xmath155 , @xmath156=\\mu , \\var[z_i(t ) ] = \\sigma^2 $ ] .",
    "since the graph is transitive , it is natural to take the cost matrices as @xmath157 and @xmath158 .",
    "moreover , it can be seen from eq .",
    "that @xmath159 . since the mean net production is the same at each node , the static optimal power flow problem is trivial with the mean flows being zero .",
    "we are left with the dynamic variance minimizing problem .",
    "recall that @xmath160 is the eigenvalue decomposition of @xmath57 . since @xmath161 , the singular value decomposition of @xmath38",
    "is given by @xmath162 for some orthogonal matrix @xmath163 .",
    "the basic observation is that , with these choices of @xmath164 and @xmath165 , the riccati equations diagonalize in the bases given by the columns of @xmath166 ( for vectors indexed by vertices ) and columns of @xmath163 ( for vectors indexed by edges ) .    a full justification of the diagonal ansatz amounts to rewriting the riccati equations in the new basis .",
    "for the sake of space we limit ourselves to deriving the optimal diagonal control .",
    "we rewrite the linear relation from @xmath167 to @xmath168 as @xmath169 substituting in eq .",
    "( [ eq : state ] ) , we get @xmath170 denoting as above by @xmath171 , @xmath172 , @xmath139 the average quantities , it is easy to see that , in a transitive network , we can take @xmath173 , @xmath174 and hence @xmath175 . in words , since all nodes are equivalent , there is no average power flow ( @xmath173 ) , the average overproduction is dumped locally ( @xmath174 ) , and the average storage level is kept constant ( @xmath175 ) .",
    "we work in the basis in which @xmath176 is diagonal .",
    "we will index singular values by @xmath177 hence @xmath178 ( omitting hereafter the singular value @xmath179 since the relevant quantities have vanishing projection along this direction . ) in the examples treated in the next sections , @xmath180 will be a fourier variable . since the optimal filter is diagonal in this basis , we write @xmath181 , @xmath182 and @xmath183 , @xmath184 .",
    "we let @xmath185 , @xmath186 , @xmath187 , @xmath188 denote the components of @xmath189 , @xmath190 , @xmath191 , @xmath192 along in the same basis . from eqs .",
    "( [ eq : filteredevol1 ] ) to ( [ eq : filteredevol3 ] ) , we get the scalar equations @xmath193 we will denote by @xmath194 , @xmath195 , @xmath196 the stationary variances of @xmath185 , @xmath187 , @xmath188 . from the above ,",
    "we obtain @xmath197\\ , \\sigma^2\\ , , \\label{eq : varfilter2}\\\\ \\sigma_w^2(\\theta ) & = \\left[p^2+\\frac{h^2q^2}{1-(1-k)^2}\\right]\\ , \\sigma^2\\ , .",
    "\\label{eq : varfilter3 } \\ ] ] ( we omit here the argument @xmath180 on the right hand side . )    in order to find @xmath198 , we minimize the lagrangian ( [ eq : cost ] ) . using parseval s identity ,",
    "this decomposes over @xmath180 , and we can therefore separately minimize for each @xmath177 @xmath199 a lengthy but straightforward calculus exercise yields the following expressions .    [ cols= \" < ,",
    "< , < , < , < , < , < \" , ]     consider a transitive network .",
    "the optimal linear control scheme is given , in fourier domain @xmath177 , by @xmath200 where @xmath201 is given by @xmath202    it is useful to point out a few analytical properties of these filters : @xmath203 @xmath204\\le \\beta\\le 1/\\xi$ ] with @xmath205 the maximum degree in @xmath2 ; @xmath206 @xmath207 is monotone decreasing as a function of @xmath208 , with @xmath209 as @xmath210 and @xmath211 as @xmath212 ; @xmath213 @xmath214 is such that @xmath215 . in particular , it is monotone increasing as a function of @xmath208 , with @xmath216 as @xmath210 and @xmath217 as @xmath212 ; @xmath218 @xmath219 .    consider a transitive network , and assume that the optimal lq control is applied .",
    "the variances are given as follows in terms of @xmath220 , given in eq .",
    "( [ eq : optfilter2 ] ) : @xmath221",
    "for the rest of the paper , we focus on two specific network topologies : the infinite one - dimensional grid ( line network ) and the infinite two - dimensional grid .",
    "we will assume that the net generations are independent across time and position , with common expectation @xmath222 , and we will place weak assumptions on the distributions ( to be specified precisely later in section [ sec : subgaussian ] . ) we will focus on the regime when the achieved cost is small . in section [ sec : performance ]",
    "we will evaluate the performance of the lq scheme on these topologies . in section [ sec : lower ] .",
    "we will derive lower bounds on the performance of any schemes on these topologies to show that the lq scheme is optimal in the small cost regime . as a result , we characterize explicitly the asymptotic performance in this regime .",
    "the results are summarized in table [ table : summary_results ] .",
    "although the i.i.d .",
    "assumption simplifies significantly our derivations , we expect that the qualitative features of our results should not change for a significantly broader class of processes @xmath223 .",
    "in particular , we expect our results to generalize under the weaker assumption that @xmath152 is stationary but close to independent beyond a time scale @xmath224 .",
    "the parameter @xmath225 , the mean of the net generation at each node , can be thought of as a measure of the amount of _ over - provisioning_. let us first consider that case of a one - dimensional grid and assume that @xmath225 is vanishing or negligible . in other words , the average production balances the average load .",
    "our results imply that a dramatic improvement is achieved by a joint use of storage and transmission resources .",
    "consider first the case @xmath226 .",
    "the network then reduces to a collection of isolated nodes , each with storage @xmath227 .",
    "it can be shown that the optimal cost decreases only slowly with the storage size @xmath227 , namely as @xmath228 .",
    "similarly , when there is only transmission but no storage , the optimal cost decreases only slowly with transmission capacity @xmath229 , like @xmath230 . on the other hand , with both storage and transmission , the optimal costs decreases _ exponentially _ with @xmath231 .",
    "consider now positive over - provisioning @xmath232 .",
    "when there is no storage , the only way to drive the cost significantly down is at the expense of increasing the amount of over - provisioning beyond @xmath233 .",
    "the same performance can be achieved with a storage @xmath227 equalling to this amount of over - provisioning and with the actual amount of over - provisioning exponentially smaller .",
    "the 2-d grid provides significantly superior performance than the 1-d grid .",
    "for example , the cost exponentially decreases with the transmission capacity @xmath229 even without over - provisioning and without storage .",
    "the increased connectivity in a 2-d grid allows much more spatial averaging of the random net generations than in the 1-d grid . in order to understand the fundamental reason for this difference ,",
    "consider the case of vanishing over - provisioning @xmath234 and vanishing storage @xmath235 ( also see figure [ fig:1d_2d_cut ] ) .",
    "consider first a 1-d grid .",
    "the aggregate net generation inside a segment of @xmath236 nodes has variance @xmath237 and hence this quantity is of the order of  @xmath238 .",
    "this random fluctuation has to be compensated by power delivered from the rest of the grid , but this power can only be delivered through the two links , one at each end of the segment and each of capacity c. hence , successful compensation requires @xmath239 .",
    "one can think of @xmath240 as the _ spatial scale _ over which averaging of the random generations is taking place . beyond this spatial scale",
    ", the fluctuations will have to be compensated by fast generation .",
    "this fluctuation is of the order of @xmath241 per node .",
    "note that a limit on the spatial scale of averaging translates to a large fast generation cost .",
    "in contrast , in the 2-d grid , @xmath203 the net generation , and @xmath206 the total link capacity connecting an @xmath242 box to the rest of the grid , both scale up linearly in @xmath236 .",
    "this facilitates averaging over a very large spatial scale @xmath236 , resulting in a much lower fast generation cost .",
    "there is an interesting parallelism between the results for the 1-d grid with storage and the 2-d grid without storage .",
    "if we set @xmath243 , the results are in fact identical .",
    "one can think of storage as providing an additional dimension for averaging : time ( section [ subsec : perflim_withstorage ] formalizes this ) .",
    "thus , _ a one dimensional grid with storage behaves similarly to a two - dimensional grid without storage . _",
    "in this section we evaluate the performances of the lq scheme on the 1-d and 2-d grids .",
    "both are examples of transitive graphs and hence we will follow the formulation in section [ subsec : transitive_networks ] .",
    "for these two examples , the operator @xmath57 is in fact invariant to spatial shifts so the @xmath180-domain which diagonalizes the operator is simply the ( spatial ) fourier domain .    for simplicity , in this section",
    ", we consider the case where @xmath152 are gaussian . in the next section",
    "we show how all our results immediately generalize to a much larger and more realistic class of distributions .",
    "suppose that @xmath244 iid across nodes and time .",
    "it follows that @xmath245 are gaussian , and using eq .",
    ", we get the following estimates @xmath246 here @xmath247 is the tail of the gaussian distribution @xmath248 , where @xmath249 the gaussian density and @xmath250 is the gaussian distribution .    in order to evaluate performances analytically and to obtain interpretable expressions , we will focus on two specific regimes . in the first one , no storage is available but large transmission capacity exists . in the second , large storage and transmission capacities are available .      in order to recover the performance when there is no storage , we let @xmath251 , implying @xmath252 by the definition of cost function ( [ eq : lagrangian ] ) . in this limit",
    "we have @xmath210 , cf .",
    "( [ eq : betadef ] ) . using the explicit formulae for the various kernels , cf .",
    "( [ eq : optfilter1 ] ) to ( [ eq : optfilter3 ] ) , we get : @xmath253 substituting in eqs .",
    "( [ eq : filteredevol1 ] ) to ( [ eq : filteredevol2 ] ) we obtain the following prescription for the controlled variables ( in matrix notation ) @xmath254 while the flow and storage satisfy @xmath255 the interpretation of these equations is quite clear .",
    "no storage is retained ( @xmath256 ) and hence no energy is transferred to storage .",
    "the matrix @xmath257 can be interpreted a low - pass filter and hence @xmath258 is a smoothing of @xmath91 whereby the smoothing takes place on a length scale @xmath259 .",
    "the wasted energy is obtained by averaging underproduction over regions of this size .    finally , using eqs .",
    "( [ eq : optsigmaf ] ) and ( [ eq : optsigmaw ] ) , we obtain the following results for the variances in fourier space @xmath260      ( -80,338)@xmath261 ( -80,328)@xmath262    in this case @xmath263 $ ] , and @xmath264 ( the laplacian @xmath57 is diagonalized via fourier transform ) . the form of the optimal filter @xmath265 is shown in figure [ fig:1dnostorage ] .",
    "the parseval integrals can be computed exactly but we shall limit ourselves to stating without proof their asymptotic behavior for small @xmath266 .    for the one - dimensional grid , in absence of storage , as @xmath267 ,",
    "the optimal lq control yields variances @xmath268    using these formulae and the equations ( [ eq : epsilon ] ) for the performance parameters , we get the following achievability result .    [ thm:1dnostorage ] for the one - dimensional grid , in absence of storage , the optimal lq control with lagrange parameter @xmath269 yields , in the limit @xmath270 , @xmath271 : @xmath272    the choice of @xmath266 given here is dictated by approximately minimizing the cost . in words ,",
    "the cost is exponentially small in the product of the capacity , and overprovisioning @xmath273 .",
    "this is achieved by averaging over a length scale @xmath274 that grows only linearly in @xmath229 and @xmath275 .",
    "note that the extent of averaging is limited by the transmission capacity @xmath229 : the larger the extent of averaging , the larger the amount of power which has to be transported across the network .",
    "optimal filters @xmath265 for two different values of @xmath259 are displayed in figure [ fig:1dnostorage ] .      in this case @xmath276",
    "^ 2 $ ] , and @xmath277 .",
    "again , we evaluate parseval s integral as @xmath267 , and present the result .    for the two - dimensional grid , in absence of storage , as @xmath267 ,",
    "the optimal lq control yields variances @xmath278    using these formulae and the equations ( [ eq : epsilon ] ) for the performance parameters , and approximately optimizing over @xmath266 , we obtain the following achievability result .",
    "[ thm:2d_nos_largemu ] for the two - dimensional grid , in absence of storage , the optimal lq control with lagrange parameter @xmath279 yields , in the limit @xmath270 , @xmath280 : @xmath281    notice the striking difference with respect to the one - dimensional case , cf . theorem [ thm:1dnostorage ] .",
    "the cost goes exponentially to @xmath56 , but now overprovisioning plays a significantly smaller role .",
    "for instance , if we fix the link capacity @xmath229 to be the same , the exponents in eq .",
    "( [ eq:1dnostorage ] ) are matched if @xmath282 , i.e. an exponentially smaller overprovisioning is sufficient .      in this section",
    "we consider the case in which storage is available .",
    "again we focus on the regime where the optimal cost is small . within our lq formulation",
    "we want therefore to penalize @xmath283 much more than @xmath284 and @xmath285 .",
    "this corresponds to the asymptotics @xmath267 , @xmath286 ( the ratio @xmath287 need not to be fixed ) .",
    "it turns out that the relevant behavior is obtained by considering @xmath288 and hence @xmath212 .",
    "the linear filters are given in this regime by @xmath289 using these filters we obtain @xmath290      the variances are obtained by parseval s identity , integrating @xmath291 over @xmath292 $ ] .",
    "the form of the optimal filters @xmath265 and @xmath293 is presented in figure [ fig:1dstorage ] .",
    "we obtain the following asymptotic results .    consider a one - dimensional grid , subject to the lq optimal control . for @xmath267 and @xmath294 @xmath295 where @xmath296 is the integral ( here @xmath297 ) @xmath298    using eqs .",
    "( [ eq : epsilon ] ) to estimate the total cost @xmath299 and minimizing it over @xmath266 we obtain the following",
    ".    [ thm:1dstorage ] consider a one - dimensional grid and assume @xmath300 .",
    "the optimal lq scheme achieves the following performance : @xmath301 under the further assumption @xmath302 ( in the first case ) and @xmath303 ( in the second ) . in the first case",
    "the claimed behavior is achieved by @xmath304 , and @xmath305 . in the second by letting @xmath304 , and @xmath306 .",
    "this theorem points at a striking threshold phenomenon . if overprovisioning is extremely small , or vanishing , then the cost is exponentially small in @xmath231 . on the other hand , even a modest overprovisioning changes",
    "this behavior leading to a decrease that is exponential in @xmath307 ( barring exponential factors ) .",
    "overprovisioning also reduces dramatically the effective averaging length scale @xmath259 .",
    "it also instructive to compare the second case in theorem [ thm:1dstorage ] with its analogue in the case of no storage , cf .",
    "( [ eq:1dnostorage ] ) : storage seem to replace overprovisioning .",
    "as done in the previous cases , the variances of @xmath308 , @xmath309 , @xmath310 are obtained by integrating @xmath311 over @xmath312 ^ 2 $ ] .",
    "consider a two - dimensional grid , subject to the lq optimal control .",
    "for @xmath267 and @xmath313 , we have @xmath314 where @xmath315 is the constant defined as per eq .",
    "( [ eq : omegadef ] ) , and @xmath316 , @xmath317 are strictly positive and bounded for @xmath287 bounded .",
    "further , as @xmath318 @xmath319 , @xmath320 , where @xmath321 ^ 2 } \\frac{1}{|\\alpha(\\theta)|}\\ ; \\de\\theta$ ] .    minimizing the total outage over @xmath322 , we obtain :    [ thm:2dstorage ] assume @xmath300 and @xmath323 .",
    "the optimal cost for scheme a memory - one linear scheme on the two - dimensional grid network then behaves as follows @xmath324 here @xmath325 is a function which is strictly positive and bounded for @xmath326 bounded away from @xmath56 and @xmath327 . in particular , @xmath328 as @xmath329 , and @xmath330 as @xmath331 ( @xmath332 ) .",
    "the claimed behavior is achieved by selecting @xmath333 , and @xmath266 as follows .",
    "if @xmath334 then @xmath335 . if instead @xmath336 , then @xmath337 , for suitable functions @xmath338 ( in the first case , we also assume @xmath270 . )    the functions @xmath339 in the last statement can be characterized analytically , but we omit such characterization for the sake of brevity . as seen by comparing with theorem [ thm:1dstorage ] , the greater connectivity implied by a two dimensional grid leads to a faster decay of the cost .",
    "we find that our results from section [ sec : performance ] immediately generalize to a much broader class of distributions for @xmath152 than gaussian .    to define this class , first we provide the definition of _ sub - gaussian _ random variables .",
    "( see , for instance , @xcite for more details . )",
    "a random variable @xmath340 is _ sub - gaussian _ with tail parameter @xmath341 if , for any @xmath342 , @xmath343    two important examples of sub - gaussian random variables are :    1 .   gaussian random variables with variance @xmath344 are sub - gaussian with tail parameter @xmath345 .",
    "2 .   random variables with bounded support on @xmath346 $ ] are sub - gaussian with tail parameter @xmath347 .",
    "notice that the tail parameter is always an upper bound on the variance @xmath344 , namely @xmath348 ( this follows by taylor expansion of eq .",
    "( [ eq : subgaussiandef ] ) for small @xmath349 ) .",
    "we will consider the class of distributions for the net production @xmath152 to be sub - gaussian with tail parameter of the same order as the variance .",
    "more precisely :    fix constant @xmath350 . let @xmath351 be the class of distributions such that the sub - gaussian tail parameter @xmath341 and the standard deviation @xmath344 satisfy : @xmath352    this is a natural class of distributions for modeling renewable power production .",
    "the power generated by wind turbines , for example , are bounded between @xmath56 and a upper power limit , with significant probability that the power is near @xmath56 or capped at the upper limit .",
    "hence , it is of bounded support with the range comparable to the standard deviation .",
    "it is sub - gaussian with tail parameter of the same order as the variance .",
    "we will now argue that all the results we derived in section [ sec : performance ] for gaussian net productions extend to this class of distribution .",
    "the only fact we used to connect variances with the costs , where we used the gaussianity assumption , is eq .  .",
    "this equation implies that @xmath96 decreases exponentially with @xmath353 , and @xmath97 decreases exponentially with @xmath354 and with @xmath355 , which in turns leads to theorems [ thm:1dnostorage ] , [ thm:2d_nos_largemu ] , [ thm:1dstorage ] , [ thm:2dstorage ] .",
    "we will show that these exponential dependencies hold for distributions in @xmath351 as well , and a similar versions of these theorems hold for these distributions .",
    "first we need some elementary properties of sub - gaussian random variables .",
    "the first property follows by elementary manipulations with moment generating functions .",
    "[ lemma : combiningsubgauss ] assume @xmath356 and @xmath357 to be independent random variables with tail parameters @xmath358 and @xmath359 .",
    "then , for any @xmath360 , @xmath361 is sub - gaussian with tail parameter @xmath362 .",
    "notice that by this lemma , the parameters of sub - gaussian random variables behave exactly as variances ( as far as linear operations are involved ) . in particular , it implies that the class @xmath351 is closed under linear operations .",
    "the second property is a well known consequence of markov inequality , and shows that the tail of a sub - gaussian random variable is dominated by the tail of a gaussian with the same parameter .",
    "[ lemma : gaussiantails ] if @xmath340 is a sub - gaussian random variable with parameter @xmath341 , then , for any @xmath363 @xmath364 .",
    "now suppose the net productions @xmath152 s have distributions in @xmath351 .",
    "the lq scheme developed in section [ sec : lqg_design ] implies that the controlled variables @xmath84 , @xmath365 , @xmath366 are linear functions of the net productions @xmath152 , and hence it follows that @xmath84 , @xmath365 , @xmath366 are in @xmath351 .",
    "now , if we let @xmath367 be the flow at edge @xmath59 at steady - state , with sub - gaussian tail parameter @xmath368 , then @xmath369 here , as in eq .  , @xmath370 is the complementary cumulative distribution function of the standard gaussian random variable : @xmath371 .",
    "similarly , one can show that : @xmath372    thus , @xmath96 decreases exponentially with @xmath353 , and @xmath97 decreases exponentially with @xmath354 and with @xmath355 , as in the gaussian case , except for an additional factor of @xmath373 in the exponent .",
    "this means that analogues of theorems [ thm:1dnostorage ] , [ thm:2d_nos_largemu ] , [ thm:1dstorage ] , [ thm:2dstorage ] also hold for distributions in @xmath351 with an additional factor of @xmath373 in the exponent of @xmath374 .",
    "note that all these exponents are proportional to @xmath375 , where @xmath344 is the variance of the gaussian distributed @xmath152 .",
    "therefore , equivalently , one can say that the performance under a sub - gaussian distributed @xmath152 with tail parameter @xmath341 is at least as good as if @xmath152 were gaussian with variance @xmath341 .",
    "in this section , we prove general lower bounds on the outage @xmath376 of _ any scheme _ , on the 1-d and 2-d grids .",
    "our proofs use cutset type arguments . throughout this section",
    ", we will assume the @xmath152 to be i.i.d .",
    "random variables , with @xmath377 , with the exception of the case of a one - dimensional grid without storage , cf .",
    "theorem  [ thm:1dnostoragelb ] . in this case",
    ", we will make the weaker assumption that the @xmath152 are i.i.d .",
    "sub - gaussian .",
    "[ thm:1dnostoragelb ] consider a one - dimensional grid without storage , and assume the net productions @xmath152 to be i.i.d .",
    "sub - gaussian random variables in the class @xmath351 .",
    "( in particular this assumption holds if @xmath377 . )    there exist finite constants @xmath378 dependent only on @xmath379 , such that the following happens . for @xmath380 and @xmath381 , we have @xmath382    consider a segment of length @xmath383 .",
    "let @xmath384 be the event that the segment has net demand at least @xmath385 .",
    "then we have @xmath386 \\geq \\const_3 \\exp\\big\\ { -\\frac{\\const_4 ( 3c+\\ell\\mu)^2}{2\\sigma^2 \\ell } \\big\\}\\ , , \\end{aligned}\\ ] ] for some @xmath387 .",
    "( this inequality is immediate for @xmath377 and follows from lemma [ lemma : tail ] proved in the appendix for general random variables in @xmath351 . )",
    "if @xmath384 occurs at some time @xmath6 , this leads to a shortfall of at least @xmath229 in the segment of length @xmath383 .",
    "this shortfall contributes either to @xmath97 or to @xmath388 , yielding @xmath389 choosing @xmath390 , we obtain the result .    note that the lower bound is tight both for @xmath391 ( by theorem [ thm:1dnostorage ] ) and @xmath392 ( by a simple generalization of the same theorem that we omit ) .",
    "we prove a lower bound almost matching the upper bound proved in theorem [ thm:2d_nos_largemu ] .",
    "there exists @xmath393 such that , for @xmath394 , @xmath395    follows from a single node cutset bound .",
    "we next make a conjecture in probability theory , which , if true , leads to a significantly stronger lower bound for small @xmath225 . for any set of vertices @xmath396 of the two - dimensional grid , we denote by @xmath397 the _ boundary _ of @xmath396 , i.e. , the set of edges in the grid that have one endpoint in @xmath396 and the other in @xmath398 .",
    "there exists @xmath399 such that the following occurs for all @xmath400 .",
    "let @xmath401 be a collection of i.i.d .",
    "@xmath402 random variables indexed by @xmath403 .",
    "then @xmath404 \\geq \\delta l \\log l \\ , .",
    "\\label{eq : conj_symmetric}\\end{aligned}\\ ] ] [ conj : large_sum_symmetric ]    it is not hard to see that this conjecture implies a tight lower bound .",
    "consider the two - dimensional grid without storage , and assume conjecture [ conj : large_sum_symmetric ] .",
    "then there exists @xmath405 such that for any @xmath406 and @xmath407 we have @xmath408 [ theorem:2d_conly_usingconj ]    consider a square of side @xmath383 .",
    "conjecture [ conj : large_sum_symmetric ] yields that we can find a subset of vertices in the square with a boundary capacity no more than @xmath409 , but with a net demand of at least @xmath410 .",
    "this yields @xmath411 choosing @xmath412 with an appropriate choice of @xmath379 , we obtain the result .",
    "our conjecture was arrived at based on a heuristic divide - and - conquer argument .",
    "we validated our conjecture numerically as follows : we obtain a lower bound to the left hand side of eq .",
    ", by maximizing over a restricted class of subsets @xmath413 , consisting of subsets that can be formed by dividing the square into two using an oriented path ( each step on such a path is either upwards or to the right ) .",
    "it is easy to see that if @xmath414 , then @xmath415 .",
    "define @xmath416 where @xmath413 is implicitly a function of @xmath236 .",
    "the advantage of considering this quantity is that @xmath417 can be computed using a simple dynamic program of quadratic complexity .",
    "numerical evidence , plotted in figure [ fig : conj_test ] , suggests that @xmath418 = \\omega(l \\log l)$ ] , which implies our conjecture .",
    "[ fig : conj_test ] ( -150,0)@xmath236 ( log scale ) ( -270,100)@xmath419}{l}$ ]        our approach involves mapping the time evolution of a control scheme in a one - dimensional grid , to a feasible ( one - time ) flow in a two - dimensional grid .",
    "one of the dimensions represents ` space ' in the original grid , whereas the other dimension represents time .",
    "consider the one - dimensional grid , with vertex set @xmath420 .",
    "we construct a two - dimensional ` space - time ' grid @xmath421 consisting of copies of each @xmath422 , one for each time @xmath423 : define @xmath424 .",
    "the edge set @xmath425 consists of ` space - edges ' @xmath426 and ` time - edges ' @xmath427 .",
    "@xmath428 edges are undirected .",
    "denote by @xmath429 the capacity of @xmath430 .",
    "we define @xmath431 for @xmath432 and @xmath433 for @xmath434 .",
    "given a control scheme for the 1-d grid with storage , we define the flows in the space - time grid as @xmath435{0pt}{0pt}}_v(t+1 ) - s/2 \\qquad",
    "\\mbox{for } e = ( ( v , t ) , ( v , t+1 ) ) \\in \\et\\end{aligned}\\ ] ] notice that these flows are not subject to kirchoff constraints , but the following energy balance equation is satisfied at each node @xmath436 , @xmath437 we use performance parameters as before ( this definition applies to finite networks and must be suitably modified for infinite graphs ) : @xmath438 notice that @xmath439 is unchanged , and @xmath440 , in our mapping from the 1-d grid with storage to the 2-d space - time grid .",
    "our first theorem provides a rigorous lower bound which is almost tight for the case @xmath441 ( cf .",
    "theorem [ thm:1dstorage ] ) .",
    "it is proved by considering a rectangular region in the space - time grid of side @xmath442 in space and @xmath443 in time .",
    "suppose @xmath444 , @xmath445 .",
    "there exists @xmath405 such that @xmath446 [ theorem:1d_cs_largemu_lb ]    consider a segment of length @xmath447 and a sequence of @xmath448 consecutive time slots .",
    "( rounding errors are easily dealt with . )",
    "the number of nodes in the corresponding region @xmath449 in the space - time grid is @xmath450 the cut , i.e. , the connection between @xmath449 and the rest of the grid , is of size @xmath451 .",
    "the net generation inside @xmath449 is @xmath452 .",
    "now @xmath453 by assumption , implying @xmath454 .",
    "let @xmath384 be the event that the net generation inside @xmath449 is at least @xmath455 .",
    "we have @xmath456 \\geq \\exp\\left(-   \\frac{\\const_1(\\max(c , s))^2}{\\sigma^2 n}\\right ) \\geq \\exp\\left(- \\frac{\\const_1cs}{\\sigma^2}\\right)\\ ] ] for some @xmath457 .",
    "moreover , @xmath384 leads to a shortfall of at least @xmath458 over @xmath459 nodes in the space - time grid .",
    "it follows that @xmath460 which yields the result , using @xmath461 .",
    "next we provide a sharp lower bound for small @xmath225 using conjecture [ conj : large_sum_symmetric ] .",
    "recall theorem [ theorem:2d_conly_usingconj ] and notice that its proof does not make any use of kirchoff flow constraints ( encoded in eq .",
    "( [ eq : nablaphi ] ) ) .",
    "thus , the same result holds for a 2-d space - time grid .",
    "we immediately obtain the following result , suggesting that the upper bound in theorem [ thm:1dstorage ] for small @xmath462 is tight .",
    "there exists @xmath463 such that the following occurs if we assume that conjecture [ conj : large_sum_symmetric ] is valid .",
    "consider the one - dimensional grid with parameters @xmath464 , and @xmath465 .",
    "we have @xmath466    we remark that the requirement @xmath467 can be relaxed if we assume a generalization of conjecture [ conj : large_sum_symmetric ] to rectangular regions in the two - dimensional grid .",
    "[ theorem:2d_cs_lb ] there exists a constant @xmath405 such that on the two - dimensional grid , @xmath468    the theorem is proved by considering a single node , using a cutset type argument , similar to the proof of theorem [ theorem:1d_cs_largemu_lb ] .",
    "it implies that the upper bound in theorem [ thm:2dstorage ] is tight up to constants in the exponent .",
    "this work was partially supported by nsf grants ccf-0743978 , ccf-0915145 and ccf-0830796 .",
    "[ lemma : tail ] let @xmath469 be a collection of i.i.d .",
    "sub - gaussian random variables in @xmath351 with @xmath470 , @xmath471 .      by scaling , we will assume , without loss of generality , @xmath479 . throughout the proof @xmath480",
    "denote constants depending uniquely on @xmath475 .",
    "we will use the same symbol even if the constants have to be redefined in the course of the proof .    for any @xmath342 ,",
    "let @xmath481 , @xmath482 denote probability and expectation with respect to the measure defined implicitly by @xmath483 for all measurable functions @xmath484 . notice that this measure is well defined for all @xmath349 by sub - gaussianity .",
    "let @xmath485 .",
    "then @xmath486 is continuous , monotone increasing with @xmath487 , @xmath488 , @xmath489 . bounding these quantities by sub - gaussianity",
    ", it follows that , for @xmath490 , we have @xmath491 , and hence @xmath492 define @xmath493 .",
    "notice that @xmath494 and that @xmath495 ( the inverse function of @xmath496 ) is well defined on the interval @xmath497 .",
    "define @xmath498 by taylor expansion , we get @xmath499 . proceeding as above ,",
    "it is not hard to prove that @xmath500 for all @xmath501 for some finite constants @xmath502 ( eventually different from above ) .",
    "finally , for @xmath503 we define @xmath504 combining the above , we have @xmath505 for all @xmath506 $ ] , and therefore @xmath507\\ , .\\end{aligned}\\ ] ] now , for @xmath508 $ ] , let @xmath509 be the event that @xmath510 .",
    "take @xmath511 and define @xmath512 . by cauchy - schwarz inequality",
    "@xmath513 the proof is completed by noting that @xmath514 for all @xmath515 , by berry - esseen central limit theorem ( note indeed that , under @xmath481 , @xmath356,  ,@xmath516 have mean @xmath266 , variance lower bounded by @xmath517 and @xmath518 ) .",
    "m.  korpaas , a.  holen , and r.  hildrum , `` operation and sizing of energy storage for wind power plants in a market system , '' _ international journal of electrical power and energy systems _ , vol .  25 , no .  8 , pp . 599606 , october 2003 .",
    "p.  brown , j.  p. lopes , and m.  matos , `` optimization of pumped storage capacity in an isolated power system with large renewable penetration , '' _ ieee transactions on power systems _ , vol .",
    "23 , no .",
    "2 , pp . 523  531 , may 2008 .",
    "r.  vershynin , `` introduction to the non - asymptotic theory of random matrices , '' in _ compressed sensing , theory and applications _ , y.  eldar and g.  kutyniok , eds.1em plus 0.5em minus 0.4emcambridge university press , 2012 , pp ."
  ],
  "abstract_text": [
    "<S> one of the most important challenges in the integration of renewable energy sources into the power grid lies in their ` intermittent ' nature . </S>",
    "<S> the power output of sources like wind and solar varies with time and location due to factors that can not be controlled by the provider . </S>",
    "<S> two strategies have been proposed to hedge against this variability : 1 ) use energy storage systems to effectively average the produced power over time ; 2 ) exploit distributed generation to effectively average production over location . </S>",
    "<S> we introduce a network model to study the optimal use of storage and transmission resources in the presence of random energy sources . </S>",
    "<S> we propose a linear - quadratic based methodology to design control strategies , and we show that these strategies are asymptotically optimal for some simple network topologies . for these topologies , the dependence of optimal performance on storage and transmission capacity is explicitly quantified . </S>"
  ]
}