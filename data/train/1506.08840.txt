{
  "article_text": [
    "the comparison and analysis of geometric shapes plays an important role in medical imaging @xcite , biology @xcite as well as many other fields @xcite . spaces of geometric shapes are inherently nonlinear . to make standard methods of statistical analysis applicable , one can linearize the space locally around each shape .",
    "this can be achieved by introducing a riemannian structure , which is able to describe jointly the global nonlinearity of the space as well as its local linearity .    over the past decade",
    ", riemannian shape analysis has become an active area of research in pure and applied mathematics . driven by applications ,",
    "a variety of spaces , equipped with different riemannian metrics , have been used to represent geometrical shapes and their attributes .",
    "ideally , the particular choice of metric should be dictated by the data at hand rather than by mathematical or numerical convenience .",
    "this leads to the task of developing efficient numerical methods for the statistical analysis of shapes for general and flexible classes of metrics .",
    "the topic of this paper are second order sobolev metrics on the space of regular , planar curves .",
    "this space and its quotients by translations , rotations , scalings , and reparametrizations are important and widely used spaces in shape analysis .",
    "second order sobolev metrics are mathematically well - behaved : the geodesic equation is globally well - posed , any two curves in the same connected component can be connected by a minimizing geodesic , the metric completion consists of all @xmath0-immersions , and the metric extends to a strong riemannian metric on the metric completion @xcite .",
    "we provide the first numerical implementation of the initial and boundary value problems for geodesics with respect to these metrics and apply them to medical data .",
    "our implementation allows us to compute karcher means , principal components , and clusters of curves in reasonable time .",
    "the parameters in the metric can be chosen freely because we do not rely on transforms which exist only for special choices of parameters @xcite .",
    "we are also able to factor out the action of the finite - dimensional translation and rotation groups .",
    "we illustrate the behaviour of the metrics in two medical applications . in sect .",
    "[ hela ] we use images of hela cell nuclei from @xcite and compute the mean shape of the nucleus and the principal modes of shape variation ; in sect .",
    "[ cardiac ] we use traces of cardiac image sequences from @xcite and compare the mean shape of patients with tetralogy of fallot with the mean shape of a control group .",
    "the paper is structured as follows : sect .",
    "[ math ] contains the definition of second order sobolev metrics and some relevant mathematical background .",
    "section [ disc ] describes our discretization of the geodesic equation and the riemannian energy functional .",
    "finally , in sect .  [ app ] , we apply the metrics to medical imaging data .",
    "in this article we center our attention on the space of smooth , regular curves with values in @xmath1 , @xmath2 where @xmath3 stands for _ immersion_. as an open subset of the frchet space @xmath4 , it is a frchet manifold .",
    "its tangent space , @xmath5 , at any curve @xmath6 is the vector space @xmath4 .",
    "we denote the euclidean inner product on @xmath7 by @xmath8 .",
    "moreover , for any fixed curve @xmath6 , we denote differentiation and integration with respect to arc length by @xmath9 and @xmath10 respectively .",
    "[ def : sobolev_metric ] a second order sobolev metric on @xmath11 is given by @xmath12 where @xmath13 , @xmath14 , and @xmath15 are tangent vectors .",
    "the metric @xmath16 is invariant with respect to translations , rotations , and reparametrizations by diffeomorphisms of @xmath17 , but not with respect to scalings .",
    "it can be made scale - invariant by introducing weights that depend on the length @xmath18 of the curve @xmath6 .",
    "a scale - invariant metric is given by @xmath19 depending on the application , it can be desirable to factor out some of these isometry groups .",
    "for example , we consider the hela cell nuclei in sect .",
    "[ hela ] as curves modulo translations and rotations . for the traces of cardiac images in sect .",
    "[ cardiac ] , however , both the absolute position of the curve and its orientation have intrinsic meaning and should therefore not be factored out .",
    "the constants @xmath20 and @xmath21 in the definition of the metric determine the relative weight of the @xmath22- , @xmath23- , and @xmath0-parts . their choice is a non - trivial and important task , and it should , in each application , be informed by the data at hand .",
    "the influence of different parameter values on geodesics and karcher means can be seen in fig .",
    "[ fig : cat2cow_constants ] and fig .",
    "[ fig : karcher_constants ] .     in the first row",
    "is increased by a factor 10 in the second and a factor 100 in the third row.,title=\"fig:\",scaledwidth=95.0% ]   in the first row is increased by a factor 10 in the second and a factor 100 in the third row.,title=\"fig:\",scaledwidth=95.0% ]   in the first row is increased by a factor 10 in the second and a factor 100 in the third row.,title=\"fig:\",scaledwidth=95.0% ]     of the metric used in the first figure is increased by a factor 10 in the second and by a factor 100 in the third figure.,title=\"fig : \" ]   of the metric used in the first figure is increased by a factor 10 in the second and by a factor 100 in the third figure.,title=\"fig : \" ]   of the metric used in the first figure is increased by a factor 10 in the second and by a factor 100 in the third figure.,title=\"fig : \" ]    sobolev metrics have natural generalizations to manifold - valued curves , embedded surfaces , and more generally spaces of immersions of a compact manifold @xmath24 into a riemannian manifold @xmath25 ; see @xcite for details and @xcite for a general overview .",
    "deformations of curves can be seen as smooth paths @xmath26\\to\\on{imm}(s^1,\\mathbb r^d)$ ] .",
    "their velocity is @xmath27 , the subscript @xmath28 denoting differentiation .",
    "the length of a path of curves @xmath6 is @xmath29 the distance between two curves in @xmath30 ( with respect to the metric @xmath16 ) is the infimum of the lengths of all paths connecting these curves .",
    "@xmath31 geodesics are locally distance - minimizing paths .",
    "geodesics can be described by a partial differential equation , called the geodesic equation .",
    "it is the first order condition for minima of the energy @xmath32 recently , some local and global existence results for geodesics of sobolev metrics were shown in @xcite .",
    "since they provide the theoretical underpinnings for the numerical methods presented in this paper , we summarize them here .",
    "let @xmath13 and @xmath14 .",
    "the geodesic equation of the metric @xmath16 , written in terms of the momentum @xmath33 , is given by @xmath34 given any initial condition @xmath35 , the solution of the geodesic equation exists for all time .",
    "if , however , @xmath36 and @xmath37 , then @xmath16 is a first order sobolev metric .",
    "its geodesic equation is locally , but not globally , well - posed .",
    "closely related are elastic metrics @xcite , which in the planar case are given by @xmath38 here @xmath39 are constants and @xmath40 denote the unit tangent and normal vectors to @xmath6 .",
    "two special cases deserve to be highlighted : for @xmath41 , @xmath42 @xcite and @xmath43 @xcite there exist nonlinear transforms , the square root velocity transform and the basic mapping , that greatly simplify numerics .",
    "both of these metrics have been applied to a variety of problems in shape analysis .",
    "we note that the elastic metric with @xmath43 corresponds to a first order sobolev metric as in def .",
    "[ def : sobolev_metric ] with @xmath44 and @xmath45 .",
    "as it has no @xmath22-part , it is a riemannian metric only on the space of curves modulo translations .",
    "we propose to represent paths of curves as tensor product b - splines @xmath46 of degree @xmath47 in time ( @xmath28 ) and @xmath48 in space ( @xmath49 ) , respectively , using @xmath50 and @xmath51 basis functions and controls @xmath52 .",
    "the spatial basis functions @xmath53 are defined on the uniform knot sequence @xmath54 , @xmath55 , and satisfy periodic boundary conditions .",
    "the time basis functions @xmath56 are defined using uniform knots on the interior of the interval @xmath57 $ ] and with full multiplicity on the boundary .",
    "full multiplicity of the boundary knots ensures that fixing the initial and final curves is equivalent to fixing the control points @xmath58 and @xmath59 . regarding smoothness , we have @xmath60)$ ] and @xmath61)$ ] .",
    "the proposed discretization scheme is independent of the special form of the metric , and can be applied equally to the scale - invariant versions as well as to the family of elastic metrics .      to evaluate the energy on discretized paths , we use gaussian quadrature on each interval between subsequent knots .",
    "the resulting discretized energy @xmath62 is minimized over all discrete paths with fixed initial and final control points @xmath58 and @xmath59 .",
    "this is a finite - dimensional , nonlinear , unconstrained .",
    "all smooth paths violating this condition have infinite energy because of the completeness of the metric . by approximation ,",
    "spline paths violating this condition have very high energy and will , in practice , be avoided during optimization . ]",
    "optimization problem .",
    "we solved this problem using either matlab s ` fminunc ` function with gradients computed by finite differences , or using ampl @xcite and the ipopt solver @xcite with gradients computed by automatic differentiation . by classical approximation results",
    "@xcite , the discrete energy of discrete paths converges to the continuous energy of smooth paths as the number of control points tends to infinity .",
    "hence we expect to obtain close approximations of geodesics .",
    "establishing rigorous convergence results for our discretization will be the subject of future work .",
    "the karcher mean @xmath63 of a set @xmath64 of curves is the minimizer of @xmath65 it can be calculated by a gradient descent on @xmath66 . letting @xmath67 denote the riemannian logarithm , the gradient of @xmath68 with respect to @xmath16 is @xcite @xmath69      to calculate the karcher mean by gradient descent",
    ", one has to repeatedly solve the geodesic equation .",
    "to this aim , we use the time - discrete variational geodesic calculus @xcite . given three curves @xmath70 ,",
    "one defines the discrete energy @xmath71 a 3-tuple @xmath72 is a discrete geodesic if it is a minimizer of the discrete energy @xmath73 with fixed endpoints @xmath74 .",
    "the discrete exponential map is defined as follows :",
    "@xmath75 , if @xmath72 is a discrete geodesic , in other words , if @xmath76 . to find @xmath77",
    ", we differentiate the discrete energy @xmath73 with respect to @xmath78 and solve the resulting system of nonlinear equations , @xmath79 we use the solver ` fsolve ` in matlab to solve this system of equations .",
    "this procedure is repeated depending on the desired time - resolution .",
    "while the convergence results in @xcite do not apply to our setting , we found good experimental agreement with the solutions of the boundary value problem .",
    "in our first example we want to characterize nuclear shape variation in hela cells .",
    "we use fluorescence microscope images of hela cell nuclei ( 87 images in total ) .",
    "the acquisition of the cells is described in @xcite .",
    "a similar study on this dataset was performed using the lddmm framework in @xcite ; applying intrinsically defined sobolev metrics to the same problem will provide a complimentary point of view .    to extract the boundary of the nucleus , we apply a thresholding method @xcite to obtain a binary image and then fit  using least squares  a spline with @xmath80 and @xmath81 to the longest 4-connected component of the thresholded image .",
    "then we reparametrize the boundary to approximately constant speed .",
    "the remaining degree of freedom is the starting point of the parametrization ; when computing minimizing geodesics , we minimize over this parameter as well .",
    "the shapes of cell nuclei are thus represented by curves modulo translations , rotations , and constant shifts of the parametrisation , i.e. the two curves @xmath6 and @xmath82 are considered equivalent .",
    "examples of the extracted curves are depicted in fig .",
    "[ hela_fig_1 ] .    [ cols=\"^,^ \" , ]     the parameters @xmath83 , @xmath84 , and @xmath21 of the riemannian metric are chosen as follows : we compute the average @xmath22- , @xmath23- and @xmath0-contributions @xmath85 , @xmath86 , @xmath87 to the energy of linear paths between each pair of curves in the dataset .",
    "as the @xmath22- and @xmath0-contributions scale differently , we rescale all curves such that @xmath88",
    ". then we choose constants @xmath83 , @xmath84 , and @xmath21 such that @xmath89 resulting in an average length @xmath90 and @xmath91 , @xmath92 , and @xmath93 .    ; the bold curve is the mean .",
    "one can see four different characteristic deformations of the cell : bending , stretching along the long axis , stretching along the short axis , and a combination of stretching with partial bending.,scaledwidth=75.0% ]    the average shape of the nucleus can be captured by the karcher mean @xmath63 . to compute the karcher mean of the 87 nuclei , we use a conjugate gradient method on the riemannian manifold of curves , as implemented in the manopt library @xcite , to solve the minimization problem .",
    "we obtain convergence in @xmath94 steps ; the final value of the objective function is @xmath95 and the norm of the gradient is @xmath96 .",
    "the mean shape can be seen in fig .",
    "[ hela_fig_1 ] .    having computed the mean @xmath63 , we represent each nuclear shape @xmath97 by the initial velocity @xmath98 of the minimal geodesic connecting @xmath99 and @xmath97 .",
    "we perform principal component analysis with respect to the inner product @xmath100 on the set of initial velocities @xmath101 .",
    "the first four eigenvalues are @xmath102 and @xmath103 , and they explain @xmath104 , and @xmath105 of the total variance .",
    "geodesics from the mean in the directions of the first four principal directions can be seen in fig .",
    "[ hela_fig_2 ] .",
    "[ hela_fig_5 ] shows the data projected to the subspace spanned by the first two eigenvectors .",
    "finally , we sample from a normal distribution with the same covariance matrix as the data and project the sampled velocities @xmath106 back to the space of curves using the exponential map @xmath107 ; some examples can be seen in fig .",
    "[ hela_fig_1 ] .          in our second application",
    "we study curves that are obtained from images of the cardiac cycle .",
    "more precisely , we consider a sequence of 30 cardiac images , taken at equispaced time points along the cardiac cycle . each image is projected to a barycentric subspace of dimension two , yielding a closed curve in the two - dimensional space of barycentric",
    "coordinates . after normalizing the coordinates (",
    "3 ) we obtain a closed , plane curve  with the curve parameter representing time  to which we can apply the methods presented in sect .  [ math ] .",
    "details regarding the acquisition and projection of the images can be found in @xcite ; barycentric subspaces on manifolds are described in @xcite .",
    "the data consists of 10 cardiac cycles of patients with tetralogy of fallot and 9 patients from a control group .",
    "each cardiac cycle is originally represented by three - dimensional homogeneous coordinates @xmath108 , sampled at 30 time points .",
    "we project the homogeneous coordinates onto the plane @xmath109 and choose a two - dimensional coordinate system for this plane .",
    "then we use spline interpolation with degree @xmath110 and @xmath111 control points to reconstruct the planar curves from the data points ; see fig .",
    "[ fig : splinefit ] .     with @xmath111 control points is used.,title=\"fig : \" ]   with @xmath111 control points",
    "is used.,title=\"fig : \" ]   with @xmath111 control points is used.,title=\"fig : \" ]    the parameters @xmath83 , @xmath84 , and @xmath21 in the metric are chosen similarly to sect .",
    "[ hela ] ; however , the scale of the curves is not changed and we use equal weighting between the @xmath22- , @xmath23- and @xmath0-parts of the average energy for linear paths .",
    "this leads to parameters @xmath112 , @xmath113 , and @xmath114 . to see",
    "if the metric structure derived from the sobolev metric enables us to distinguish between diseased patients and the control group , we compute all 171 pairwise distances between the 19 curves ; this takes about 15 minutes on a 2 ghz single core processor .",
    "multi - dimensional scaling of the distance matrix shows that the metric separates healthy and diseased patients quite well ( fig .",
    "[ distancematrix]a ) .",
    "indeed , a cluster analysis based on the distance matrix recovers exactly  with exception of one outlier ( patient 4 )  the subgroups of healthy and diseased patients ( fig .",
    "[ distancematrix]b ) .",
    "the karcher means of the healthy and diseased subgroups as well as of the entire population are depicted in fig .",
    "[ cardiackarcher ] .",
    "the mean was computed using a gradient descent method as described in sect .",
    "[ karcher ] with a threshold of @xmath115 for the norm of the gradient .",
    "the average distance from the mean for the diseased group is @xmath116 with a variance of @xmath117 , and for the control group the distance is @xmath118 with a variance of @xmath119 .    to investigate the variability of the observed data , we performe principal component analysis on the initial velocities of the minimal geodesics connecting curves to the respective means ( c.f .",
    "[ hela ] ) .",
    "[ cardiackarcher2 ] shows the initial velocities projected to the subspace spanned by the first two principal directions . within the healthy and sick subgroups ,",
    "less then @xmath120 of the principal components are needed to explain @xmath121 of the shape variation .",
    "if , in contrast , principal components are analyzed for the entire dataset based on the global karcher mean , then @xmath122 of the principal components are needed to explain @xmath121 of the shape variation .",
    "in this article we numerically solved the initial and boundary value problems for geodesics on the space of regular curves under second order sobolev metrics .",
    "we analyzed two medical datasets using our approach .",
    "in future work we plan to prove rigorous convergence results for our discretizations , further investigate the impact of the constants in the metric , and treat unparametrized curves .",
    "michael  v. boland and robert  f. murphy .",
    "a neural network classifier capable of recognizing the patterns of all major subcellular structures in fluorescence microscope images of hela cells .",
    ", 17(12):12131223 , 2001 .",
    "kristin mcleod , maxime sermesant , philipp beerbaum , and xavier pennec .",
    "patio - temporal tensor decomposition of a polyaffine motion model for a better analysis of pathological left ventricular dynamics .",
    ", 2015 .",
    "gustavo  k. rohde , wei wang , tao peng , and robert  f. murphy .",
    "deformation - based nonlinear dimension reduction : applications to nuclear morphometry . in _",
    "5th ieee int .",
    "symposium on biomedical imaging : from nano to macro _ ,",
    "pages 500503 , 2008 .",
    "catalina tobon - gomez , mathieu de  craene , kristin mcleod , lennart tautz , wenzhe shi , anja hennemuth , adityo prakosa , hengui wang , gerald carr - white , sergio kapetanakis , albert lutz , vernon rasche , tobias schaeffter , constantin butakoff , oskar friman , tommaso mansi , maxime sermesant , xiahai zhuang , sbastien ourselin , hans  otto peitgen , xavier pennec , reza razavi , daniel rueckert , alejandro  f. frangi , and kawal rhode . .",
    ", 17(6):632648 , 2013 ."
  ],
  "abstract_text": [
    "<S> in the recent years , riemannian shape analysis of curves and surfaces has found several applications in medical image analysis . in this paper </S>",
    "<S> we present a numerical discretization of second order sobolev metrics on the space of regular curves in euclidean space . </S>",
    "<S> this class of metrics has several desirable mathematical properties . </S>",
    "<S> we propose numerical solutions for the initial and boundary value problems of finding geodesics . </S>",
    "<S> these two methods are combined in a riemannian gradient - based optimization scheme to compute the karcher mean . </S>",
    "<S> we apply this to a study of the shape variation in hela cell nuclei and cycles of cardiac deformations , by computing means and principal modes of variations . </S>"
  ]
}