{
  "article_text": [
    "the reaction - diffusion master equation ( rdme ) is a commonly used mesoscopic model in the field of computational systems biology and it is a natural extension of the classical well - mixed markov - process formalism for reaction kinetics @xcite . having a long history in the study of fluctuations in chemical reaction systems @xcite ,",
    "recently it has been successfully applied to study diverse biological phenomena such as yeast polarization @xcite , pattern formation in _",
    "@xcite , and noisy oscillations of hes1 in embryonic stem cells @xcite .    in the rdme framework ,",
    "spatial heterogeneity is modeled by dividing space into voxels in a computational mesh , where molecules are assumed to be well mixed inside each voxel . in individual voxels",
    ", reactions are simulated using the stochastic simulation algorithm ( ssa ) @xcite , while diffusion is accounted for through discrete jumps of molecules between voxels .",
    "discrete diffusion and well - mixed ssa are combined in the next subvolume method ( nsm ) @xcite , an efficient kinetic monte carlo method . for moderate mesh resolutions , simulations of the rdme",
    "are typically orders of magnitude faster than microscopic particle - tracking models , such as the popular green s function reaction dynamics ( gfrd ) algorithm @xcite .",
    "this contributes to the popularity of the method for applications where the system of interest needs to be studied on the minute to hour timescales that are typical for cellular events like gene expression , signaling and cell division .",
    "the rdme underlies software for spatial stochastic simulation such as mesord @xcite , urdme @xcite , pyurdme ( www.pyurdme.org ) , and steps @xcite .    despite the proven usefulness of the rdme  and the extensive work put into speeding up simulations using approximate @xcite and hybrid @xcite methods , as well as extending it to include additional transport phenomena @xcite and to simulate it on complex geometries @xcite  its fundamental numerical properties and",
    "its ability to approximate microscopic particle tracking models at high mesh resolution remains poorly understood . in order to discuss the accuracy of the rdme on small length- and timescales , we need to specify a fine - scaled alternative as our gold standard .",
    "a microscale model often utilized for that purpose is the smoluchowski model , in which particles are modeled by hard spheres that diffuse according to brownian motion , and reactions are modeled by a partially absorbing boundary condition at the surface of the spheres .",
    "this model has a long history in chemical physics , going back to ideas by smoluchowski @xcite . in systems",
    "biology , the smoluchowski model is being popularized through software packages such as e - cell @xcite and smoldyn @xcite .",
    "this paper is concerned with the accuracy of the rdme when viewed as an approximation to the smoluchowski model .",
    "the principal way in which the mesoscale and the microscale are connected is through the mesoscopic bimolecular reaction constant .",
    "a classical result by collins and kimball @xcite provides effective rates in terms of the microscopic , intrinsic , reaction parameters of the smoluchowski model .",
    "when scaled by the volume of the voxels , they can be used as approximate mesoscale reaction rates in the rdme for simulations in 3d .",
    "the same constant was derived more recently from first principle physics by gillespie @xcite .",
    "the constant is valid when voxels are large in comparison to the molecules .",
    "since , in the conventional implementation , reactions occur only between molecules occupying the same voxel , the average time until molecules react diverges with vanishing size of the voxels @xcite .",
    "a consequence is a lower bound on the size of the voxels , below which no mesoscopic reaction rate can be chosen so that the average reaction times match in the rdme and smoluchowski models @xcite .    in previous work @xcite we analyzed the scenario of a single , irreversible , bimolecular reaction on a cartesian mesh . for the case of perfect absorption",
    ", we obtained analytical lower limits on the mesh size in both 2d and 3d . above those limits , it is theoretically possible to construct a mesoscopic rate such that the mean binding time in the two models match .",
    "below that critical mesh size , no such rate can be constructed .",
    "hence , in the presence of bimolecular reactions , a fundamental limitation of the rdme results from the inherent bound on the accuracy to which we can represent diffusion . as a direct consequence of our previous analysis , we also obtained mesoscopic reaction rates which ensure that the mean binding time in the rdme matches that of the smoluchowski model for an irreversible bimolecular reaction .    in this paper",
    "we extend our previous analysis .",
    "first , we study the case of reversible reactions , and ask whether there are additional constraints on the admissible mesh sizes compared to the irreversible case .",
    "we derive a critical voxel size under the following three assumptions : the average time until a reaction fires should match between mesoscopic and microscopic models , the steady state levels should match , and the mesoscopic dissociation rate should be smaller than or equal to the intrinsic dissociation rate . the last condition is necessary for the dissociation to make physical sense , and if we are to match not only equilibrium distributions but also transient solutions .",
    "the result establishes the previously obtained critical voxel sizes  in the perfectly absorbing , irreversible , case  as a fundamental lower limit for the more general reversible case .",
    "importantly , this means that there will be a non - trivial lower limit for the mesh size , independent of the intrinsic microscopic reaction parameters .",
    "we also study the accuracy of our reaction rates as compared to the smoluchowski model , and show good agreement , both at steady state and during the transient phase , between mesoscopic and microscopic simulations as the mesh size approaches the critical lower limit .",
    "in particular , we show how the multiscale propensities can provide a better mesoscopic approximation to a diffusion limited model of a mapk cascade , compared to the widely used propensities of collins and kimball @xcite .",
    "it has not previously been possible to accurately simulate this model with a fully local rdme , although it has been simulated successfully with a non - local extension of the rdme @xcite , and using a hybrid microscale - mesoscale method @xcite .    for simplicity",
    "we have chosen not to write out units explicitly .",
    "we are using si units throughout .",
    "a system of @xmath0 molecules of @xmath1 different chemical species , diffusing and reacting inside a finite reaction volume , can be modeled at several different scales , and the accuracy of the different models depends on the properties of the system . in this section",
    "we briefly review the microscopic smoluchowski model and the mesoscopic rdme model , and discuss previous work on connecting the two models .",
    "several microscopic models have been proposed and studied in some detail @xcite .",
    "we have chosen to focus on the smoluchowski model , given the extensive attention it has received for instance in @xcite . in the smoluchowski framework , molecules are modeled as hard spheres .",
    "the radii of the spheres are referred to as the reaction radius of the molecules .",
    "the smoluchowski equation , extended with a robin boundary condition at the sum of the reaction radii , determines the probability of a reaction occurring between colliding molecules .",
    "let @xmath2 and @xmath3 be the positions of two molecules .",
    "consider their relative position @xmath4 .",
    "the governing equation is given by @xmath5 where @xmath6 is the probability distribution function ( pdf ) of the relative position @xmath7 at time @xmath8 , given the relative position @xmath9 at time @xmath10 , and where @xmath11 is the sum of the diffusion constants of the molecules .",
    "the boundary condition is given by @xmath12 where @xmath13 here @xmath14 is the sum of the reaction radii of the molecules , and @xmath15 is the microscopic , intrinsic , reaction rate .",
    "the initial condition is @xmath16 .    to update a pair of molecules we solve for @xmath6 , and then sample the new relative position at time @xmath8 .",
    "single molecules are updated by sampling from a normal distribution in all directions .",
    "the time until a dissociation is sampled from an exponential distribution , and the resulting products are placed at a distance equal to @xmath14 .",
    "a system of @xmath0 molecules becomes an @xmath0-body problem , and a direct solution is generally unattainable .",
    "instead we can simulate the system with the green s function reaction dynamics ( gfrd ) algorithm @xcite .",
    "the core of the algorithm is a reduction of the problem to a collection of single- and two - body systems , accomplished through an appropriate restriction of the time step of the algorithm . in @xcite",
    "the gfrd algorithm was extended to include complex boundaries , and in @xcite improvements were suggested with the aim of making the algorithm more flexible and efficient .",
    "the gfrd algorithm is efficient for dilute systems where the free space between molecules allows for an efficient grouping in pairs while using a relatively large time step , and the computational benefit over brute - force bd methods can be orders of magnitude .",
    "if the system contains some species that are present in higher copy numbers , or if a very high spatial resolution is not required , the mesoscopic rdme can in turn be orders of magnitude faster than gfrd .",
    "the rdme extends the classical well - mixed markov - process model @xcite to the spatial case by introducing a discretization of the domain into @xmath17 non - overlapping voxels @xcite .",
    "molecules are point particles and the state of the system is the discrete number of molecules of each of the species in each of the voxels . a common choice for the discretization is a uniform cartesian lattice , where each voxel is a square with area @xmath18 ( 2d ) , or a cube with volume @xmath19 ( 3d ) .",
    "simulations can also be conducted on unstructured triangular and tetrahedral meshes for better geometric flexibility @xcite .",
    "the rdme is the forward kolmogorov equation , governing the time evolution of the probability density of the system .    for brevity of notation , we write @xmath20 for the probability that the system can be found in state @xmath21 at time @xmath8 , conditioned on the initial condition @xmath22 at time @xmath23 . for a general reaction - diffusion system",
    ", the rdme can be written as    @xmath24    where @xmath25 denotes the @xmath26-th row and @xmath27 denotes the @xmath28-th column of the @xmath29 state matrix @xmath21 where @xmath1 is the number of chemical species .",
    "the functions @xmath30 define the propensities of the @xmath31 chemical reactions , @xmath32 are stoichiometry vectors associated with the reactions . @xmath33 and",
    "@xmath32 have the same meaning as for a well mixed system but are now defined for each of the voxels .",
    "@xmath34 are propensities for the diffusion jump events , and @xmath35 are stoichiometry vectors for diffusion events .",
    "@xmath35 has only two non - zero entries , corresponding to the removal of one molecule of species @xmath36 in voxel @xmath26 and the addition of a molecule in voxel @xmath28 .",
    "the rdme is too high - dimensional to permit a direct solution .",
    "instead realizations of the stochastic process are sampled , using algorithms similar to the ssa but optimized for reaction - diffusion systems @xcite .",
    "the propensity functions for the diffusion jumps , @xmath37 , are selected to provide a consistent and local discretization of the diffusion equation , or equivalently the fokker - planck equation for brownian motion @xcite . for a uniform cartesian grid ,",
    "a finite difference discretization results in diffusion jumps with propensities @xmath38 where @xmath39 is the diffusion coefficient of @xmath40 and @xmath41 is non - zero only for adjacent voxels . for a triangular or tetrahedral unstructured mesh , finite element or finite volume discretizations",
    "result in propensities that account for the shape and size of each voxel @xcite .",
    "with this model of diffusion , setting reactions aside , the solution of the rdme will , with vanishing voxel sizes , converge in probability to brownian motion .",
    "in the case of mass action kinetics , the propensity functions @xmath33 for bimolecular reactions take the form @xmath42 we will refer to @xmath43 as the _ mesoscopic association rate_. in practical modeling work , @xmath43 is often obtained by fitting the model to some phenotypic experimental observation , or provided directly as a macroscopic or mesoscopic model parameter obtained from experiments . if the association rate is instead given in terms of the microscopic reaction rate , @xmath15 , a result of collins and kimball @xcite provides the effective rate , @xmath44 , of the system , which can be used for mesoscale simulations in 3d through @xmath45 , where @xmath46    gillespie derives the same relation by applying classical results from gas kinetics , and calls it the diffusional propensity function @xcite . from gillespie s physically rigorous derivation it is possible to relate the intrinsic reaction rate @xmath15 to fundamental physical constants .",
    "a natural question , given model parameters and a mesh size , is how well a mesoscopic simulation can capture the microscale dynamics .",
    "it has been shown that the solution of the rdme diverges with respect to the smoluchowski model @xcite . due to the point particle assumption",
    ", bimolecular reactions occur with successively lower probability , to eventually vanish in the limit of small voxels .",
    "this means that there is a lower bound on the voxel size , below which bimolecular reactions can not be accurately simulated in the rdme .",
    "there is also an upper bound on the voxel size , above which the reaction - diffusion dynamics will be insufficiently resolved .",
    "the question of how to choose the voxel size for sufficient accuracy has not yet been satisfactorily answered , but some attempts at establishing lower bounds on the voxel size have been made .",
    "a trivial bound on the voxel size follows from physical arguments @xcite ; the voxels must be large enough for the reacting molecules to remain dilute and well mixed inside the voxel .",
    "this condition translates to @xmath47    apart from physical common sense , the above condition is an explicit assumption in the derivation of .",
    "only if this assumption is valid can the rate constant be expected to provide an accurate simulation with respect to the smoluchowski model .",
    "unfortunately , condition offers little guidance on how to choose the mesh size in practice .",
    "the reaction constant depends on the microscopic parameters but not on the spatial discretization . by allowing the rate to depend on the mesh , and by matching certain properties of the microscopic model , it is possible to derive alternative forms for @xmath43 that perform better than for diffusion limited systems and for fine meshes @xcite",
    ". those approaches also yield constants in 2d , where no expression based on a physical derivation is available . in @xcite",
    "the rates are derived by matching the mean equilibration time of a reversible reaction on a spherical discretization .",
    "these rates are then used on cartesian lattices .",
    "let @xmath48 be the mean binding time for two molecules in the smoluchowski model in dimension @xmath49 . in the case of a single irreversible association reaction on a uniform cartesian discretization of a square or cube of side length @xmath50 , hellander et al .",
    "@xcite showed that if the mesoscopic propensity @xmath43 is chosen as @xmath51 , where @xmath52 } & d=2\\\\ \\frac{(l / h)^3}{\\micromrtd(\\krmi)-1.5164l^3/(6dh ) } & d=3 , \\end{array}\\right .",
    "\\label{eq : ourcorr}\\end{aligned}\\ ] ] then the mean binding time on the mesoscopic scale will match the mean binding time in the smoluchowski model . for @xmath53 ,",
    "this is possible down to @xmath54 in 3d , and @xmath55 in 2d .",
    "below @xmath56 , the matching of the mean binding time will not be possible in the perfectly absorbing case . for simple geometries , such as a disk or a sphere",
    ", @xmath57 can be obtained analytically . for other geometries , provided that @xmath58 , the analytical result for a disk or a sphere with matching volume provides an excellent approximation .",
    "the analytical lower bounds on the voxel sizes are obtained by considering the extreme case of @xmath59 and using the above mentioned approximation for @xmath57 . in @xcite , based on another assumption not involving the microscopic smoluchowski model , erban and chapman arrived at an expression in 3d that is similar to and that establishes the same critical mesh size .    in",
    "what follows , we set out to expand on this theory with the aim of an improved understanding of the range of the mesh sizes for which the rdme will accurately approximate the smoluchowski model .",
    "in particular , we derive critical mesh sizes for more realistic kinetics like reversible bimolecular reactions , and we show that under mild assumptions , the rates are effectively independent of @xmath50 .",
    "we also obtain error estimates that provide a way to estimate the needed mesh resolution to achieve a certain accuracy in the rebinding time distributions .",
    "the case of a single irreversible reaction was studied in @xcite .",
    "the analysis provided analytical lower bounds on the mesh size in 2d and 3d only for the case of @xmath60 , and reaction rates for matching mean association times .",
    "the reaction rates depended on the size @xmath50 of the domain .",
    "as reactions occur locally in space , that dependence is not intuitive .    in this section",
    "we expand on that theory .",
    "first we show that the reaction rates are independent of the size of the domain , under the assumption that the domain is much larger than the molecules . from this",
    "follows analytical lower bounds on the mesh size for the case of an irreversible reaction with @xmath61 .",
    "second , we study a reversible reaction on a square or cubical domain and proceed to derive mesoscopic reaction rates under the following three assumptions : the average reaction time should match between mesoscopic and microscopic models , the steady state levels should match , and the intrinsic dissociation rate should be larger than or equal to the mesoscopic dissociation rate . under these assumptions",
    "we derive a lower bound on the mesh size independent of the reaction rates .",
    "we also show how the multiscale mesoscopic reaction rates behave in the limit of small voxels as well as in the limit of large voxels , effectively connecting the microscopic and mesoscopic scales .",
    "finally , we provide error estimates that relate the mesh size to the error in rebinding - time distributions , and show that the mean mesoscopic rebinding time approaches the mean microscopic rebinding time , as the mesoscopic mesh size approaches the lower bound .",
    "the analytical expressions for the lower bounds on the voxel size @xmath62 derived in @xcite are valid for the case of irreversible reactions with perfect absorption . in this section",
    "we assume @xmath63 , to obtain analytical expressions for the lower bounds in the general case of @xmath64 .",
    "we show that the reaction rates are independent of the size @xmath50 of the domain , thus depending on local parameters only .",
    "let @xmath65 be the mesoscopic reaction rate in dimension @xmath49 , and assume that @xmath63 .",
    "then @xmath66 where @xmath67 , and @xmath68 where @xmath69 let",
    "@xmath70 then @xmath65 is a well - defined reaction rate only for @xmath71 , and @xmath72    in @xcite , the reaction rate @xmath65 was derived under the assumption that @xmath73 .",
    "this effectively implies that @xmath63 , since we have adopted the basic assumption .",
    "let @xmath57 and @xmath74 be the mean association times for uniformly distributed particles in dimension @xmath49 . while individual voxels may be too small for the collins and kimball approximation to be valid , the system as a whole may be well - mixed and dilute . thus , if we assume that @xmath63 we can approximate the global mean reaction time @xmath75 by @xmath76 which , when inserted into , yields @xmath77 with @xmath44 defined by , we obtain @xmath78 as in .",
    "thus , for large enough domains , the effect of the outer boundary is small in 3d , and the reaction rates are defined by local parameters only .    the situation in 2d is more complicated . in @xcite",
    "they derive @xmath79 for a disk . assuming @xmath63",
    ", this will provide an excellent estimate of @xmath79 in the case of a square .",
    "thus @xmath80l^2}{\\krmi},\\end{aligned}\\ ] ] where @xmath81 yields @xmath82    for @xmath83 we have @xmath84 , and @xmath85 .",
    "we then get @xmath86 by noting that @xmath87 we find that we can rewrite to obtain also in the case of @xmath88 .",
    "consequently , for @xmath63 , the reaction rate defined by @xmath89 is approximately independent of the global parameter @xmath50",
    ".    now follows by noting that @xmath90 holds if and only if @xmath91 and then solving @xmath92 for @xmath62 .      in this section",
    "we extend the analysis to the reversible case .",
    "we limit our considerations to the conventional rdme , thus allowing reactions only between molecules occupying the same voxel .",
    "the system consists of one @xmath93-molecule and one @xmath94-molecule , diffusing on a cartesian lattice consisting of @xmath0 voxels of width @xmath62 , with periodic boundary conditions .",
    "the molecules react reversibly through the reaction @xmath95    henceforth we assume that @xmath15 , the microscopic association rate , and @xmath96 , the microscopic dissociation rate , are given model parameters , and that @xmath43 is defined by .    it remains to define @xmath97",
    ". a plausible approach would be to match the steady - state levels of the species at the mesoscopic and microscopic scales . for a system of one @xmath93- and one @xmath94-molecule , the steady state",
    "is governed by the ratio of the average time the molecules are unbound to the total time .",
    "thus , to match the steady state at the different scales , we choose @xmath97 such that @xmath98 where @xmath99 and @xmath100 are the respective times until an @xmath93- and a @xmath94-molecule rebind , given that they have just dissociated .",
    "the quantities @xmath101 and @xmath102 are the average times until a @xmath103-molecule dissociates ( thus @xmath104 and @xmath105 ) .",
    "we can compute @xmath99 analytically by expressing it in terms of the mean binding time @xmath74 .",
    "we note that the rebinding time is given by @xmath106 when the molecules have reached the same voxel , the system is in the same state as immediately following a dissociation .",
    "thus , by subtracting from the total mean binding time the time it takes to reach the same voxel , we are left with the average rebinding time .",
    "expressions for @xmath74 are given in @xcite , and inserting them into yields @xmath107    unfortunately @xmath100 is not easily computed by analytical means ( for general geometries ) , but by noting that similarly as in the mesoscopic case , @xmath108 we obtain the estimate @xmath109 for @xmath63 .",
    "the argument is the same as for the mesoscopic case ; @xmath110 represents the time until two molecules are in contact for the first time . by subtracting that time from the total time for the two molecules",
    "to react given a uniform initial distribution , we are left with the rebinding time . by using and in it follows that @xmath111 which , after some simplifications , results in @xmath112 when rearranged , can be recognized as the detailed balance condition .",
    "maintaining this relation between the rate constants is sufficient to ensure that the equilibrium values of @xmath93 and @xmath94 are the same in the two models .",
    "however , though we can match the mean association time as well as the equilibrium values for a given voxel size , we may have a mesoscopic dissociation rate that is faster than the microscopic dissociation rate . that would result in more dissociation events on the microscopic scale , and since the microscopic scale is assumed to be more fine - grained , this is unphysical",
    ". this can be seen by considering that the inverse of the mesoscopic dissociation rate is a combination of the expected time for a complex to break apart and the time for the products to become well - mixed by diffusion inside a voxel .",
    "the mesoscopic dissociation rate thus includes the possibility of fast microscopic rebinding events that occur before the molecules have become well - mixed .",
    "thus , while matching the mean association time and the equilibrium values of the molecules , we may end up with incorrect transient dynamics due to too fast dissociations on the mesoscopic scale .",
    "the intrinsic microscopic dissociation rate is therefore an upper bound on the mesoscopic rate . as a consequence we want to determine for",
    "what size of @xmath113 we can match the mean binding times while satisfying @xmath114    the condition @xmath115 is satisfied if and only if the inequality @xmath116 holds for @xmath117 as defined in .",
    "let @xmath118 then @xmath119 is the smallest @xmath62 for which we can satisfy @xmath120 as well as @xmath121 , and we have @xmath122    we obtain @xmath119 by using in : @xmath123 which holds if and only if @xmath124 however , from we have @xmath125 thus we find that is equivalent to @xmath126 since @xmath127 is excluded by the condition @xmath128 as shown in . since @xmath129 and @xmath130 ( we do not consider the case @xmath131 here ) , follows .",
    "we now observe that @xmath132 , and that , immediately from and , it follows that @xmath133 .",
    "the last equality is an immediate consequence of , and we obtain .    in figure",
    "[ fig : hstar_vs_hstarinf ] we show how @xmath119 relates to @xmath134 .",
    "the bound @xmath134 for the irreversible case in 2d depends on @xmath15 , and decreases with decreasing @xmath15 . however , in order to satisfy , we must have @xmath135 , shown as the red dashed line in the figure above .",
    "for large @xmath15 , @xmath136 . by , @xmath137 for all @xmath15 , @xmath138",
    "the remaining parameters are given by @xmath139 and @xmath140 . ]      in this section we investigate the behavior of the reaction rate @xmath141 in some limit cases .",
    "we would expect @xmath78 to behave similarly to @xmath44 for large voxels . in the limit of small voxels ,",
    "it is of interest to see how the mesoscopic reaction rates relate to the microscopic reaction rates .    for @xmath142",
    "we have @xmath143 also , as @xmath144 , with @xmath145 constant and @xmath146 , we have @xmath147 in the limit of @xmath148 we obtain @xmath149 in 3d , implies that @xmath150 as @xmath148 .",
    "[ coll : limits ]    since @xmath151 , follows immediately . by noting that @xmath152 we get from some straightforward algebra .",
    "we obtain immediately from .",
    "finally , follows from the fact that @xmath153 as @xmath154 or @xmath155 .    in words , as we approach the critical mesh size @xmath56 in the mesoscopic model , the mesoscopic rates approach the microscopic , intrinsic rates .",
    "for large voxels in 3d , we note that @xmath78 , as expected , approaches @xmath44 .    as an immediate consequence we have    for @xmath156 and @xmath157 ,",
    "the following holds : @xmath158    the first approximation is proven in corollary [ coll : limits ] . using @xmath159 in",
    "we obtain @xmath160 . from and it then follows that @xmath161 .    for @xmath162 , we match the mean association time , dissociation time , and the mean rebinding time . for any @xmath113 below @xmath56 , we can not simultaneously match both the association and dissociation times .",
    "consequently the rebinding dynamics will be less accurately captured on the mesoscopic scale for @xmath163 than for @xmath162 .    in figure",
    "[ fig : limits3d ] we illustrate these limits in 3d for different values of the intrinsic reaction rate @xmath15 .",
    "the more diffusion limited the reaction is , the larger the discrepancy between @xmath78 and @xmath44 becomes .      given a system with known intrinsic reaction rates",
    ", we would ideally want to know how to choose the mesh size for sufficiently accurate mesoscopic simulations .",
    "while solving this is hard for a general system , we can choose the mesh size such that we limit the relative error in the average rebinding times .",
    "we do not guarantee an accurate mesoscopic solution by doing so , but if the error in the average rebinding time is large , and we have fine - grained dynamics that we wish to capture , we may have to reduce the voxel size to decrease the error .",
    "now consider a reversible reaction , with intrinsic reaction rates given by @xmath15 and @xmath96 .",
    "for a given error tolerance @xmath164 , the following holds : @xmath165 where @xmath166^{-1}\\quad ( 3d)\\\\ \\sqrt{\\pi}\\exp\\left [ -\\frac{2\\pi\\diffconst}{\\krmi}\\left(1-(1-\\epsilon)^{-1}\\right)+\\frac{3 + 2\\pi\\calphatwo}{4}\\right]\\sigma.\\quad ( 2d ) \\end{cases}\\end{aligned}\\ ] ] furthermore , for @xmath167 , we have @xmath168    in 2d we have @xmath169 in 3d , we obtain @xmath170 as @xmath171 for all @xmath62 , it holds that @xmath172 in 3d .",
    "assume that @xmath173 holds .",
    "using we obtain @xmath174 from we know that @xmath175 , and thus becomes @xmath176 some straightforward algebra now yields @xmath177 by inserting @xmath178 , for @xmath88 and @xmath179 , into and solving for @xmath62 , we obtain .",
    "we obtain by noting that @xmath180 and @xmath181 , and using that in , together with the observation that @xmath182 .    as an immediate consequence of we",
    "we get - from , and by noting that @xmath183 as @xmath184 finally we get immediately from and - .",
    "we see that as the reactions become very diffusion limited , the difference between the mesoscopic and microscopic reaction rates can grow large , since @xmath185 as @xmath60 .",
    "the less diffusion limited a reaction is , the closer the reaction rates will be ( and the difference is bounded ) .",
    "this makes intuitive sense , since less diffusion - limited reactions mean that the system is more well - mixed ; thus the system can be accurately simulated on a coarser mesh .    in section [ sec :",
    "mapk_example ] we demonstrate how this theory can be applied to increase the understanding of the behavior of a relevant biological system .",
    "in this section we present two numerical examples that will demonstrate the scope of validity of the mesoscopic reaction rates derived above . in the first example we consider the rebinding time of a pair of molecules .",
    "we compute the distributions and compare mesoscopic results for varying @xmath62 to microscopic simulations .    in the second example we study a model proposed by takahashi et al . in @xcite .",
    "it was shown to have fine - grained dynamics , captured at the microscale but not at the deterministic level ; we will simulate it at the mesoscopic scale , and show that as the mesh size @xmath113 approaches @xmath56 , the mesoscopic and microscopic scales agree .",
    "consider one molecule of species @xmath93 and one molecule of species @xmath94 , subject to a reversible reaction @xmath186 in a cubic domain of width @xmath50 .",
    "we showed in section [ sec : limits ] that for @xmath157 the mean rebinding time at the mesoscopic scale will agree with the mean rebinding time at the microscopic scale . this does not , however , automatically guarantee that this particular choice of mesh size will yield the best agreement between the distributions of the rebinding times at the different scales .    in figure",
    "[ fig : rebind - dist-3d-2d ] we plot the distribution of the rebinding times for different mesh sizes , and compare to the distribution obtained by simulations at the microscopic scale .",
    "for @xmath162 we get a distribution that matches the microscopic results well for @xmath187 . for other values of @xmath62",
    ", we get a distribution shifted relative to the microscopic distribution . for @xmath188 ,",
    "the microscopic simulations behave differently than the mesoscopic ones , regardless of mesh size .",
    "this is due to the fact that at this timescale the spatial resolution is coarser than the temporal resolution , thus being the limiting factor for the accuracy . during a time @xmath8 ,",
    "a molecule diffuses an average distance proportional to @xmath189 in each direction .",
    "thus , for @xmath188 , the distance the molecule diffuses is less than the size @xmath113 of a voxel .",
    "on the mesoscopic scale , the distribution of the rebinding time is approximately exponential at short time scales ( time scales smaller than the time it takes for a molecule to diffuse on average the distance of a voxel . ) that gives the first plateau in figure 3 . at",
    "longer time scales the diffusion causes the rebinding time not to be exponential . in this region",
    "the mesoscopic simulations behave similar to the microscopic . at longer time scales ,",
    "the distribution is again approximately exponential ; once the molecules have become approximately well - mixed in the enclosing volume the assumption of an exponential reaction rate is quite accurate .",
    "this is seen as the second plateau in figure 3 .    in figure",
    "[ fig : rebind - dist-3d ] we plot the mean rebinding time as a function of @xmath62 , and show that for @xmath157 the mean rebinding times match between the different scales .",
    "an example of when small errors in the transient dynamics of bimolecular equilibration processes can have a large impact on the system s dynamics was given in @xcite to illustrate the need of the microscale resolution provided by the gfrd algorithm .",
    "the model considered is two steps of the omnipresent mitogen activated phospatase kinase ( mapk ) cascade . here",
    ", a transcription factor @xmath190 is phosphorylated in two steps by a kinase @xmath191 and dephosphorylated by a phosphatase @xmath192 :    @xmath193    during the phosphorylation and dephosphorylation steps , the kinase and phosphatase turns into an inactivated form @xmath194 and @xmath195 .",
    "this can model e.g. a conformation change due to conversion of atp to adp , resulting in the need to reactivate the enzymes before proceeding with the next reaction .",
    "if the timescale for this reactivation step is short and the system very diffusion limited , rapid rebinding of @xmath191 to the newly phosphorylated molecules can have a big impact on the overall system dynamics , as illustrated and discussed from a biological perspective in @xcite .",
    "numerically , this means that the system is very challenging to simulate with lattice based methods , due to the need for very fine spatial resolution in order to resolve the rebindings on the fast timescale .",
    "this was noted by fange et al . in @xcite , where length scale dependent rates were derived based on the ansatz that the equilibration time should match on the two scales for a spherical discretization .",
    "they managed to resolve the microscale dynamics of the model by using these propensities in combination with extending the rdme to allow for reaction events between molecules occupying neighboring voxels as well as molecules occupying the same voxel .",
    "without that extension they were not able to resolve the microscale dynamics ; below we show that with reaction rates as defined in and we are able to resolve the microscale dynamics without considering a non - local extension of the rdme .    in figure",
    "[ fig : mapk_new ] we show the results obtained when simulating this model using our local rates for different mesh resolutions . as can be seen , when @xmath62 is close to @xmath56",
    ", we obtain a good approximation of the results of the gfrd algorithm from @xcite . in the figure",
    ", we show the time @xmath196 until half - activation ( i.e. the time to reach half the steady state level of @xmath197 ) for varying diffusion constants , making the system range from reaction limited to diffusion limited .",
    "as can be seen , for large values of @xmath11 , as expected , the rates proposed here and the rates of collins and kimball give similar results , but for the strongly diffusion limited cases , our rates result in a much better agreement with the microscale model .",
    "notably , for small @xmath11 we obtain comparable accuracy to using @xmath198 with @xmath199 for @xmath200 , resulting in simulations that run approximately sixteen times faster , due to the @xmath201 scaling of the computational time .    in figure",
    "[ fig : upper_h]a we have computed the upper bound on @xmath62 obtained by requiring that the relative error in the average rebinding time is bounded by @xmath202 .",
    "as expected , we can see that for the less diffusion limited cases , when @xmath203 is larger , we can choose the voxel size larger and still obtain accurate results . as @xmath11 becomes even larger , the well - mixed assumption will be satisfied , and the system can be simulated at a much coarser scale . for smaller values of @xmath11",
    "the restriction on @xmath62 is quite severe , and we are required to approach @xmath56 in order to accurately simulate the system .",
    "this has an implication for the computational complexity of the simulations ; a small @xmath11 makes the system less stiff , meaning it becomes less computationally challenging , but also forces us to choose a smaller voxel size , while a large @xmath11 makes the system more stiff , but at the same time allows for a larger voxel size . in figure",
    "[ fig : upper_h]b we have computed the maximum error in the average rebinding time , as a function of @xmath11 but independent of the size @xmath204 of the voxels .",
    "we compare the results of mesoscopic simulations using both our proposed multiscale reaction rates ( hhp ) , as well as the classical rates by collins and kimball ( ck ) , for different sizes of the mesh .",
    "as we can see , for coarser meshes , while capturing the qualitative behavior , we are still not reproducing the microscopic gfrd results accurately .",
    "as we refine the mesh and approach @xmath157 , we approach the microscopic results .",
    "the parameters are chosen as in @xcite . ]",
    "as we have seen , by taking a multiscale approach and deriving reaction constants by matching certain statistics of the smoluchowski model , more accurate simulations can be obtained compared to the classical approach using rates from collins and kimball .",
    "an important reason why this is possible is that we start out with a given discretization of space , and then derive scale - dependent multiscale propensities ( discretization - first ) , while the ck - rate was not derived with a mesh in mind , and hence the propensity depends only the volume of the voxels and not their shapes . as a consequence , we can better approximate binding times for bimolecular reactions that need high spatiotemporal resolution .    while it is important to be able to accurately resolve the reaction kinetics of a given diffusion limited system , it may also be important to accurately resolve complex geometries and external and internal boundaries , modeling for example cell membranes . in this case ,",
    "uniform cartesian grids have distinct drawbacks compared to unstructured triangular and tetrahedral discretizations in that they require more voxels in order to resolve the boundaries @xcite resulting in unnecessarily long computational time . while we expect fundamental limits for a triangular and tetrahedral discretization to be close to the ones obtained herein for cartesian grids , whether it will be possible to extend the approaches taken here to obtain sharp estimates and reaction rates also for unstructured meshes has yet to be seen .",
    "another approach to the problem of making an rdme - type model approximate a microscopic model is taken in @xcite , where a mesoscale model is constructed by discretizing the doi model @xcite .",
    "this approach seems more directly amenable to be used on general grids , but it has not yet been applied to the smoluchowski model , and except for the case of irreversible , perfect absorption @xcite , the relationship between the doi and smoluchowski models is not well understood .",
    "we have illustrated in numerical examples that by using the propensities proposed here it is possible to accurately simulate the mapk system discussed in @xcite on the mesoscale using a purely local rdme implementation , and we have shown theoretically why @xmath56 is the optimal mesh size .",
    "the same system has previously been successfully simulated with an rdme - type model by fange et al .",
    "@xcite , using another set of multiscale propensities and by relying on a non - local implementation of the rdme in which molecules occupying adjacent voxels are allowed to react .",
    "relying on neighbor interactions leads to an increased computational cost due to the increased number of updates in each step of the kinetic monte carlo algorithm and hence we should expect the propensities derived here to provide a computational speed advantage for comparable accuracy .    although more efficient than a non - local implementation , the simulations herein require a uniformly fine mesh and hence expensive simulations for systems that require very high spatial resolution . unless there are species in the model present in high copy numbers which would cause microscopic simulation to become very time consuming , it is not unlikely that an efficient implementation of e.g. gfrd is more efficient than the purely mesoscopic simulation . with this in mind , for very diffusion limited systems with multiscale properties , a compelling approach is the use of hybrid methods . such a method , blending the rdme and gfrd algorithms ,",
    "has previously been proposed by the present authors @xcite , in which it was demonstrated that an accurate hybrid simulation of the mapk model @xcite can yield accurate results with only a small part of the system simulated on the microscopic scale . however , there are outstanding challenges in making such hybrid methods easy to use by practitioners .",
    "dynamic and adaptive partitioning of the system into microscopic and mesoscopic parts according to accuracy requirements is needed both for computational efficiency and for robustness of the simulator . in this paper",
    "we advance the fundamental theoretical understanding of the rdme when viewed as an approximation to the smoluchowski model , something that is a prerequisite to develop adaptivity criteria for hybrid methods .",
    "the authors thank per ltstedt for constructive comments on the manuscript .",
    "this work was funded by nsf award dms-1001012 , nigms of the nih under award r01-gm113241 , institute of collaborative biotechnologies award w911nf-09 - 0001 from the u.s .",
    "army research office , nibib of the nih under award r01-eb014877 , and u.s .",
    "doe award de- sc0008975 .",
    "the content of this paper is solely the responsibility of the authors and does not necessarily represent the official views of these agencies .",
    "m.  sturrock , a.  hellander , a.  marsavinos , and m.  chaplain .",
    "spatial stochastic modeling of the hes1 pathway : intrinsic noise can explain heterogeneity in embryonic stem cell differentiation . ,",
    "10(80):20120988 , 2013 .                                      m.  tomita , k.  hashimoto , k.  takahashi , t.  s. shimizu , y.  matsuzaki , f.  miyoshi , k.  saito , s.  tanida , k.  yugi , j.  c. venter , and c.  a. hutchison .",
    "e - cell : software environment for whole - cell simulation . , 15(1):7284 , 1999"
  ],
  "abstract_text": [
    "<S> the mesoscopic reaction - diffusion master equation ( rdme ) is a popular modeling framework , frequently applied to stochastic reaction - diffusion kinetics in systems biology . </S>",
    "<S> the rdme is derived from assumptions about the underlying physical properties of the system , and it may produce unphysical results for models where those assumptions fail . </S>",
    "<S> in that case , other more comprehensive models are better suited , such as hard - sphere brownian dynamics ( bd ) . </S>",
    "<S> although the rdme is a model in its own right , and not inferred from any specific microscale model , it proves useful to attempt to approximate a microscale model by a specific choice of mesoscopic reaction rates . in this paper </S>",
    "<S> we derive mesoscopic scale - dependent reaction rates by matching certain statistics of the rdme solution to statistics of the solution of a widely used microscopic bd model : the smoluchowski model with a robin boundary condition at the reaction radius of two molecules . </S>",
    "<S> we also establish fundamental limits on the range of mesh resolutions for which this approach yields accurate results , and show both theoretically and in numerical examples that as we approach the lower fundamental limit , the mesoscopic dynamics approach the microscopic dynamics . </S>",
    "<S> we show that for mesh sizes below the fundamental lower limit , results are less accurate . </S>",
    "<S> thus , the lower limit determines the mesh size for which we obtain the most accurate results . </S>"
  ]
}