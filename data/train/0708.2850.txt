{
  "article_text": [
    "we are interested in designing efficient numerical schemes for the strong approximation of linear stratonovich stochastic differential equations of the form @xmath0 where @xmath1 , @xmath2 , @xmath3 is a @xmath4-dimensional wiener process and @xmath5 and @xmath6 are given @xmath7 coefficient matrices .",
    "we call ` @xmath8 ' the linear _ drift _ vector field and ` @xmath9 ' for @xmath10 the linear _ diffusion _ vector fields",
    ". we can express the stochastic differential equation   more succinctly in the form @xmath11 where @xmath12 and @xmath13 .",
    "the solution of the integral equation for @xmath14 is known as the _",
    "neumann series _ , _ peano  baker series _ , _ feynman  dyson path ordered exponential _ or _ chen - fleiss series _ @xmath15 the flow - map or fundamental solution matrix @xmath16 maps the initial data @xmath17 to the solution @xmath18 at time @xmath19 .",
    "it satisfies an analogous matrix valued stochastic differential equation to   with the @xmath7 identity matrix as initial data .",
    "the logarithm of the neumann expansion for the flow - map is the _",
    "magnus expansion_. we can thus write the solution to the stochastic differential equation   in the form @xmath20 where @xmath21 see magnus  @xcite , kunita  @xcite , azencott  @xcite , ben arous  @xcite , strichartz  @xcite , castell  @xcite , burrage  @xcite , burrage and burrage  @xcite and baudoin  @xcite for the derivation and convergence of the original and also stochastic magnus expansion ; iserles , munthe  kaas , nrsett and zanna  @xcite for a deterministic review ; lyons  @xcite and sipilinen  @xcite for extensions to rough signals ; lyons and victoir  @xcite for a recent application to probabilistic methods for solving partial differential equations ; and sussmann  @xcite for a related product expansion .    in the case when the coefficient matrices @xmath22 , @xmath23 are constant and non - commutative , the solution to the linear problem   is non - trivial and given by the neumann series or stochastic taylor expansion ( see kloeden and platen  @xcite ) @xmath24 where @xmath25 here @xmath26 is the set of all combinations of multi - indices @xmath27 of length @xmath28 with @xmath29 for @xmath30",
    ". there are some special non - commutative cases when we can write down an explicit analytical solution .",
    "for example the stochastic differential equation @xmath31 with the identity matrix as initial data has the explicit analytical solution @xmath32 .",
    "however in general we can not express the neumann solution series   in such a closed form .",
    "classical numerical schemes such as the euler - maruyama and milstein methods correspond to truncating the stochastic taylor expansion to generate global strong order @xmath33 and order @xmath34 schemes , respectively .",
    "stochastic runge  kutta numerical methods have also been derived  see kloeden and platen  @xcite and talay  @xcite . at the linear level , the neumann , stochastic taylor and runge  kutta type methods are equivalent . in the stochastic context ,",
    "magnus integrators have been considered by castell and gaines  @xcite , burrage  @xcite , burrage and burrage  @xcite and misawa  @xcite .",
    "we present numerical schemes based on truncated neumann and magnus expansions .",
    "higher order multiple stratonovich integrals are approximated across each time - step by their expectations conditioned on the increments of the wiener processes on suitable subdivisions ( see newton  @xcite and gaines and lyons  @xcite ) . what is new in this paper is that we :    1 .",
    "prove the strong convergence of the truncated stochastic magnus expansion for small stepsize ; 2 .",
    "derive uniformly accurate higher order stochastic integrators based on the magnus expansion in the case of commuting linear diffusion vector fields ; 3 .   prove the maximal rate of convergence for arbitrary multi - dimensional stochastic integrals approximated by their conditional expectations ; 4 .",
    "derive explicit formulae for the relation between error and computational costs for methods of arbitrary order in the case of general nonlinear , non - commuting governing vector fields .",
    "our results can be extended to nonlinear stochastic differential equations with analogous conditions on the governing nonlinear vector fields , where the exponential lie series ( replacing the magnus expansion ) can be evaluated using the castell  gaines approach .    in the first half of this paper ,",
    "sections 25 , we focus on proving the convergence of the truncated magnus expansion and establishing magnus integrators that are more accurate than neumann ( stochastic taylor ) schemes of the same order",
    ". the numerical schemes we present belong to the important class of _ asymptotically efficient _ schemes introduced by newton  @xcite .",
    "such schemes have the optimal minimum leading error coefficient among all schemes that depend on increments of the underlying wiener process only .",
    "castell and gaines  @xcite prove that the order @xmath33 magnus integrator driven by a @xmath4-dimensional wiener process and a modified order @xmath34 magnus integrator driven by a @xmath34-dimensional wiener process are asymptotically efficient .",
    "we extend this result of castell and gaines to an arbitrary number of driving wiener processes .",
    "we prove that if we assume the linear diffusion vector fields commute , then an analogously modified order @xmath34 magnus integrator and a new order  @xmath35 magnus integrator are globally more accurate than their corresponding neumann integrators .",
    "there are several potential sources of cost contributing to the overall computational effort of a stochastic numerical integration scheme .",
    "the main ones are the efforts associated with :    * evaluation : computing ( and combining ) the individual terms and special functions such as the matrix exponential ; * quadrature : the accurate representation of multiple stratonovich integrals .",
    "there are usually fewer terms in the magnus expansion compared to the neumann expansion to the same order , but there is the additional computational expense of computing the matrix exponential .",
    "when the cost of computing the matrix exponential is not significant , due to their superior accuracy we expect magnus integrators to be preferable to classical stochastic numerical integrators . this will be the case for systems that are small ( see moler and van loan  @xcite and iserles and zanna  @xcite ) or for large systems when we only have to compute the exponential of a large sparse matrix times given vector data for which we can use krylov subspace methods ( see moler and van loan  @xcite and sidje  @xcite ) .",
    "magnus integrators are also preferable when using higher order integrators ( applied to non - sparse systems of any size ) when high accuracies are required .",
    "this is because in this scenario , quadrature computational cost dominates integrator effort .    in the second half of this paper , sections 68 , we focus on the quadrature cost associated with approximating multiple stratonovich integrals to a degree of accuracy commensurate with the order of the numerical method implemented .",
    "our conclusions apply generally to the case of nonlinear , non - commuting governing vector fields .",
    "the governing set of vector fields and driving path process @xmath3 generate the unique solution process @xmath1 to the stochastic differential equation  . for a scalar driving wiener process",
    "@xmath36 the it map @xmath37 is continuous in the topology of uniform convergence . for a @xmath4-dimensional driving processes with @xmath38",
    "the universal limit theorem implies that the it map @xmath39 is continuous in the @xmath40-variation topology , in particular for @xmath41 ( see lyons  @xcite , lyons and qian  @xcite and malliavin  @xcite ) .",
    "since wiener paths with @xmath38 have finite @xmath40-variation for @xmath42 , approximations to @xmath14 constructed using successively refined approximations to the driving path will only converge to the correct solution @xmath14 if we include information about the lvy chordal areas of the driving path ( the @xmath43-norm of the @xmath44-variation of a wiener process is finite though ) . hence if we want to implement a scheme using adaptive stepsize we should consider order  @xmath34 or higher pathwise stochastic numerical methods ( see gaines and lyons  @xcite ) .",
    "however simulating multiple stratonovich integrals accurately is costly ! for classical accounts of this limitation on applying higher order pathwise stochastic numerical schemes see kloeden and platen  @xcite , milstein  @xcite and schurz  @xcite and for more recent results see gaines and lyons  @xcite , wiktorsson  @xcite , cruzeiro , malliavin and thalmaier  @xcite , stump and hill  @xcite and giles  @xcite .    taking a leaf from gaines and lyons",
    "@xcite we consider whether it is computationally cheaper to collect a set of sample data over a given time interval and then evaluate the solution ( conditioned on that sample data ) , than it is to evaluate the solution frequently , say at every sample time .",
    "the resounding result here is that of clark and cameron  @xcite who prove that when the multiple stratonovich integral @xmath45 is approximated by its expectation conditioned on intervening sample points , the maximal rate of @xmath43-convergence is of order @xmath46 where @xmath47 is the integration steplength and @xmath48 is the sampling rate .",
    "we extend this result to multiple stratonovich integrals @xmath49 of arbitrary order approximated by their expectation conditioned on intervening information sampled at the rate @xmath48 .",
    "indeed we prove that the maximal rate of convergence is @xmath50 when @xmath51 are non - zero indices ( and an improved rate of convergence if some of them are zero ) . in practice the key information",
    "is how the accuracy achieved scales with the effort required to produce it on the global interval of integration say @xmath52 $ ] where @xmath53 .",
    "we derive an explicit formula for the relation between the global error and the computational effort required to achieve it for a multiple stratonovich integral of arbitrary order when the indices @xmath51 are distinct .",
    "this allows us to infer the effectiveness of strong methods of arbitrary order for systems with non - commuting vector fields . for a given computational effort which method delivers the best accuracy",
    "the answer not only relies on methods that are more accurate at a given order .",
    "it also is influenced by three regimes for the stepsize that are distinguished as follows . in the first large stepsize regime",
    "the evaluation effort is greater than the quadrature effort ; higher order methods produce superior performance for given effort .",
    "quadrature effort exceeds evaluation effort in the second smaller stepsize regime .",
    "we show that in this regime when @xmath54 , or when @xmath55 and the order of the method @xmath56 , then the global error scales with the computational effort with an exponent of @xmath57 . here more accurate higher order methods still produce superior performance for given effort ; but not at an increasing rate as the stepsize is decreased .",
    "however when @xmath55 for strong methods with @xmath58 the global error verses computational effort exponent is worse than @xmath57 and this distinguishes the third very small stepsize regime .",
    "the greater exponent means that eventually lower order methods will deliver greater accuracy for a given effort .",
    "we have chosen to approximate higher order integrals over a given time step by their expectations conditioned on the increments of the wiener processes on suitable subdivisions .",
    "this is important for adaptive time - step schemes ( gaines and lyons  @xcite ) and filtering problems where the driving processes ( say @xmath59 and @xmath60 ) are observed signals .",
    "however it should be noted that wiktorsson  @xcite has provided a practical method for efficiently sampling the set of multiple stratonovich multiple integrals @xmath61 across a given time - step associated with a @xmath4-dimensional driving process ( see gilsing and shardlow  @xcite for a practical implementation ) .",
    "wiktorsson simulates the tail distribution in a truncated karhunen  loeve fourier series approximation of these integrals which produces a convergence rate of order @xmath62 where @xmath48 is analogously the number of required independent normally distributed samples .",
    "other potential sources of computational effort might be path generation and memory access .",
    "path generation effort depends on the application context .",
    "this cost is at worst proportional to the quadrature effort where we could subsume it .",
    "memory access efforts depend on the processing and access memory environment . to reveal higher order methods ( which typically require more path information ) in the best light possible",
    ", we have ignored this effect .",
    "our paper is outlined as follows .",
    "we start in section 2 by proving that the exponential of every truncation of the magnus series converges to the solution of our linear stochastic differential equation  . in section  3",
    "we define the strong error measures we use and how to compute them . using these",
    ", we explicitly compare the local and then global errors for the magnus and neumann integrators in section  4 and thus establish our stated results for uniformly accurate magnus integrators . in section  5 we show that when the linear diffusion vector fields do not commute we can not expect the corresponding order  @xmath34 magnus integrator to in general be globally more accurate than the order  @xmath34 neumann integrator .",
    "we then turn our attention in section  6 to the method of approximating multiple stratonovich integrals by their conditional expectations .",
    "we prove the maximal rate of convergence for an arbitrary multiple stratonovich integral in section  6 .",
    "we then use this result in section  7 to show how the global error scales with the computational effort for numerical schemes of arbitrary order .",
    "the shuffle algebra of multiple stratonovich integrals generated by integration by parts allows for different representions and therefore bases for the solution of a stochastic differential equation .",
    "some choices of basis representation are more efficiently approximated than others and we investigate in section  8 the impact of this choice . in section  9 we present numerical experiments that reflect our theoretical results . to illustrate the superior accuracy of the uniformly accurate magnus methods we apply them to a stochastic riccati differential system that can be reformulated as a linear system which has commuting diffusion vector fields . since for the linear system",
    "expensive matrix - matrix multiplications can be achieved independent of the path , the neumann method performs better than an explicit runge  kutta type method applied directly to the nonlinear riccati system .",
    "we also numerically solve an explicit linear system with governing linear vector fields that do not commute for two and also three driving wiener processes  magnus integrators also exhibit superior accuracy in practice in these cases also .",
    "lastly in section  10 , we outline how to extend our results to nonlinear stochastic differential equations and propose further extensions and applications .",
    "we consider here the case when the stochastic differential equation   is driven by @xmath4 wiener processes with constant coefficient matrices @xmath22 , @xmath63 .",
    "the neumann expansion has the form shown in  .",
    "we construct the magnus expansion by taking the logarithm of this neumann series as in  . in appendix  [ theapp ]",
    "we explicitly give the neumann and magnus expansions up to terms with @xmath43-norm of order @xmath35 .",
    "let @xmath64 denote the truncated magnus series @xmath65 where @xmath66 denotes the finite set of multi - indices @xmath67 for which @xmath68 is of order up to and including @xmath69 .",
    "note that here @xmath70 is a half - integer index , @xmath71 .",
    "the terms @xmath72 are linear combinations of finitely many ( more precisely exactly length @xmath67 ) products of the @xmath73 , @xmath63 .",
    "let @xmath74 denote the cardinality of @xmath66 .",
    "[ th : conv ] for any @xmath75 , the exponential of the truncated magnus series , @xmath76 , is square - integrable .",
    "further , if @xmath77 is the solution of the stochastic differential equation  , there exists a constant @xmath78 such that @xmath79    first we show that @xmath80 . using the expression for @xmath64",
    ", we see that for any number @xmath81 , @xmath82 is a sum of @xmath83 terms , each of which is a @xmath81-multiple product of terms @xmath84 .",
    "it follows that @xmath85 note that the maximum of the operator norm @xmath86 of the coefficient matrices is taken over a finite set .",
    "repeated application of the product rule reveals that the product @xmath87 , where @xmath88 and @xmath89 are multi - indices of length @xmath90 and @xmath91 , is a linear combination of @xmath92 multiple stratonovich integrals . since @xmath93 for @xmath94 , each term ` @xmath95 ' in is thus the sum of at most @xmath96 stratonovich integrals @xmath97 .",
    "we also note that @xmath98 .    from equation ( 5.2.34 ) in kloeden and platen  @xcite , every multiple stratonovich integral @xmath99 can be expressed as a finite sum of at most @xmath100 multiple it integrals @xmath101 with @xmath102 .",
    "further , from remark 5.2.8 in kloeden and platen  @xcite , @xmath103 , where @xmath104 and @xmath105 denote the number of zeros in @xmath106 and @xmath107 , respectively . from lemma 5.7.3 in kloeden and platen  @xcite , @xmath108 noting that @xmath109 and @xmath110 , it follows that for @xmath75 , we have @xmath111 . since the right hand side of equation consists of @xmath112 stratonovich integrals @xmath97 , we conclude that , @xmath113 hence @xmath114 is square - integrable .",
    "second we prove  .",
    "let @xmath115 denote neumann series solution   truncated to included terms of order up to and including @xmath69 .",
    "we have @xmath116 we know @xmath117 ( see gihman and skorohod  @xcite or arnold  @xcite ) .",
    "furthermore , for any order @xmath70 , @xmath115 corresponds to the truncated taylor expansion involving terms of order up to and including @xmath69 .",
    "hence @xmath115 is a strong approximation to @xmath77 to that order with the remainder consisting of @xmath118 terms ( see proposition 5.9.1 in kloeden and platen  @xcite ) .",
    "it follows from the definition of the magnus series as the logarithm of the flow - map neumann series , that the terms of order up to and including @xmath69 in @xmath119 correspond with @xmath115 ; the error consists of @xmath118 terms .",
    "convergence of approximations based on truncations of the stochastic taylor expansion has been studied in kloeden and platen  @xcite , see propositions 5.10.1 , 5.10.2 , and 10.6.3 .",
    "ben arous  @xcite and castell  @xcite prove the remainder of the exponential of any truncation of the magnus series is bounded in probability as @xmath120 ( in the full nonlinear case ) .",
    "burrage  @xcite shows that the first terms up to and including order @xmath35 magnus expansion coincide with the terms in the taylor expansion of the same order .",
    "our result holds for any order in @xmath43 for sufficiently small @xmath121 .",
    "a more detailed analysis is needed to establish results concerning the convergence radius .",
    "similar arguments can be used to study the non - constant coefficient case with suitable conditions on the coefficient matrices ( see proposition 5.10.1 in kloeden and platen  @xcite for the corresponding result for the taylor expansion ) .    note that above and in subsequent sections , one may equally consider a stochastic differential equation starting at time @xmath122 with square - integrable @xmath123-measurable initial data @xmath17 . here",
    "@xmath124 denotes the underlying filtration .",
    "suppose @xmath125 and @xmath126 are the exact and approximate flow - maps across the interval @xmath127 $ ] , respectively ; both satisfying the usual flow - map semi - group property : composition of flow - maps across successive intervals generates the flow - map across the union of those intervals .",
    "we call the difference between the exact and approximate flow - maps @xmath128 the _ local flow remainder_. for an approximation @xmath129 across the interval @xmath127 $ ] the local remainder is thus @xmath130 .",
    "our goal here is to see how the leading order terms in the local remainders accumulate , contributing to the global error .",
    "we define the _ strong global error _ associated with an approximate solution @xmath131 to the stochastic differential equation   over the global interval of integration @xmath52 $ ] as @xmath132 .",
    "the global error can be decomposed additively into two components , the global truncation error due to truncation of higher order terms , and the global quadrature error due to the approximation of multiple stratonovich integrals retained in the approximation . if @xmath52=\\cup_{n=0}^{n-1}[t_n , t_{n+1}]$ ] where @xmath133 then for small stepsize @xmath134 we have @xmath135    the local flow remainder has the following form in the case of constant coefficients @xmath73 , @xmath10 , ( see for example the integrators in appendix  [ theapp ] ) : @xmath136 here @xmath67 is a multi - index and the terms @xmath72 represent products or commutations of the constant matrices @xmath73 .",
    "the @xmath137 represent stratonovich integrals ( or linear combinations , of the same order , of products of integrals including permutations of @xmath67 ) .",
    "the global error @xmath138 at leading order in the stepsize is thus @xmath139 hence in the global truncation error we distinguish between the _ diagonal sum _ consisting of the the first sum on the right - hand side above , and the _ off - diagonal sum _",
    "consisting of the second sum above with @xmath140 .",
    "suppose we include in our integrator all terms with local @xmath43-norm up to and including @xmath141 .",
    "the leading terms @xmath84 in @xmath142 thus have @xmath43-norm @xmath143 .",
    "those with zero expectation will contribute to the diagonal sum , generating @xmath141 terms in the global error , consistent with a global order @xmath144 integrator .",
    "however those with with non - zero expectation contribute to the off - diagonal double sum .",
    "they will generate @xmath145 terms in the global error .",
    "we must thus either include them in the integrator , or more cheaply , only include their expectations  the corresponding terms @xmath146 of order @xmath147 in @xmath142 will then have zero expectation and only contribute through the diagonal sum  see for example milstein  @xcite .",
    "this also guarantees the next order term in the global error estimate  , whose largest term has the upper bound @xmath148 , only involves higher order contributions to the leading @xmath141 error .",
    "note that high order integrators may include multiple stratonovich integral terms .",
    "we approximate these multiple integrals by their conditional expectations to the local order of approximation @xmath147 of the numerical method .",
    "hence terms in the _ integrator _ of the form @xmath84 are in fact approximated by @xmath149 , their expectation conditioned on intervening path information @xmath150 ( see section  [ sec : quadrature ] for more details ) .",
    "this generates terms of the form @xmath151 in the local flow remainder , which have zero expectation and hence contribute to the global error through the diagonal sum generating @xmath141 terms .",
    "our goal is to identify a class magnus integrators that are more accurate than neumann ( stochastic taylor ) integrators of the same order for any governing set of linear vector fields ( for the integrators of order @xmath34 and @xmath35 we assume the diffusion vector fields commute ) .",
    "we thus compare the local accuracy of the neumann and magnus integrators through the leading terms of their remainders .",
    "we consider the case of constant coefficient matrices @xmath73 , @xmath63 .    the local flow remainder of a neumann integrator @xmath152 is simply given by the terms not included in the flow - map neumann approximation .",
    "suppose @xmath153 is the truncated magnus expansion and that @xmath154 is the corresponding remainder , i.e.  @xmath155 .",
    "then the local flow remainder @xmath156 associated with the magnus approximation is @xmath157 hence the local flow remainder of a magnus integrator @xmath156 is the truncated magnus expansion remainder @xmath154 , and higher order terms @xmath158 that can contribute to the global error at leading order through their expectations . for the integrators considered in this section these higher order terms do not contribute in this way",
    ", however for the order  @xmath34 integrator we consider in the next section they do .",
    "when the linear diffusion vector fields commute so that @xmath159=0 $ ] for all @xmath160 , we define the order  @xmath34 and order @xmath35 _ uniformly accurate magnus integrators _ by @xmath161\\bigr)\\,,\\ ] ] and @xmath162 + \\tfrac{h^2}{12}[a_i,[a_i , a_0]]\\bigr)\\,.\\ ] ]    by _ uniformly _ we mean for any given set of governing linear vector fields ( or equivalently coefficient matrices @xmath73 , @xmath63 ) for which the diffusion vector fields commute , and for any initial data @xmath17 .",
    "[ th : uls ] for any initial condition @xmath17 and sufficiently small fixed stepsize @xmath163 , the order  @xmath33 magnus integrator is globally more accurate in @xmath43 than the order  @xmath33 neumann integrator .",
    "if in addition we assume the linear diffusion vector fields commute so that @xmath159=0 $ ] for all @xmath164 , then the order  @xmath34 and @xmath35 _ uniformly accurate magnus integrators _ are globally more accurate in @xmath43 than the corresponding neumann integrators . in other words , if @xmath165 denotes the global error of the order  @xmath33 magnus integrator or the uniformly accurate magnus integrators of order  @xmath34 or order @xmath35 , respectively , and @xmath166 is the global error of the neumann integrators of the corresponding order , then at each of those orders , @xmath167    let @xmath168 and @xmath169 denote the local flow remainders corresponding to the magnus and neumann approximations across the interval @xmath127 $ ] with @xmath133 .",
    "a direct calculation reveals that @xmath170 where if we set @xmath171 then @xmath172 we now show explicitly in each of the three cases of the theorem that at leading order : @xmath168 and @xmath173 are uncorrelated and hence @xmath174 is positive semi - definite .",
    "this implies that the local remainder for the neumann expansion is larger than that of the magnus expansion .",
    "hereafter assume the indices @xmath175 .",
    "for the _ order  @xmath33 integrators _ we have to leading order ( see the form of the expansions in appendix  a ) @xmath176\\,,\\ ] ] and @xmath177 which are uncorrelated by direct inspection .",
    "we henceforth assume @xmath159=0 $ ] for all @xmath178 .",
    "for the _ uniformly accurate order  @xmath34 integrator _ we have to leading order ( again see appendix  a ) @xmath179\\,,\\ ] ] and @xmath180 which again , by direct inspection are uncorrelated .    for the _ uniformly accurate order @xmath35 integrator _ the local flow remainders are @xmath181 and @xmath182\\\\ & \\;+\\sum_{i < j}\\tfrac16\\bigl(j_0j_ij_j-3(j_{i0j}+j_{j0i})\\bigr ) [ a_j,[a_i , a_0]]\\,.\\end{aligned}\\ ] ]",
    "consequently we have @xmath183 first we note that the terms in @xmath173 of the form @xmath184 , for which at least three of the indices distinct , are uncorrelated with any terms in @xmath168 .",
    "we thus focus on the terms of this form with at most two distinct indices , namely @xmath185 and other remaining terms in @xmath173 .",
    "since @xmath186\\equiv h(j_i^2-h)/6 $ ] and @xmath187\\equiv h j_i j_j/6 $ ] for @xmath188 the following conditional expectations are immediate @xmath189=&\\;0\\,,\\\\",
    "\\mathbb e\\bigl[(j_{iiii}-\\tfrac18h^2)(j_i^2j_0-h^2 - 6j_{i0i})|j_i\\bigr ] = & \\;0\\,,\\\\ \\mathbb e\\bigl[(j_{ii}j_{jj}-\\tfrac14h^2)(j_i^2j_0-h^2 - 6j_{i0i})|j_i , j_j\\bigr ] = & \\;0\\,,\\\\ \\mathbb e\\bigl[\\bigl(j_0j_ij_j+3(j_{i0j}-j_{j0i})\\bigr ) \\bigl(j_0j_ij_j-3(j_{i0j}+j_{j0i})\\bigr)|j_i ,",
    "j_j\\bigr]=&\\;0\\,,\\\\ \\mathbb e\\bigl[(j_{ii}j_{jj}-\\tfrac14h^2 ) \\bigl(j_0j_ij_j-3(j_{i0j}+j_{j0i})\\bigr)|j_i , j_j\\bigr]=&\\;0\\,,\\\\",
    "\\mathbb e\\bigl[j_{iii}j_j\\bigl(j_0j_ij_j-3(j_{i0j}+j_{j0i})\\bigr)|j_i , j_j\\bigr]=&\\;0\\,.\\end{aligned}\\ ] ] hence the expectations of the terms shown are also zero . secondly , direct computation of the following expectations reveals @xmath190 hence @xmath168 and @xmath173 are uncorrelated .",
    "the corresponding global comparison results   now follow directly in each of the three cases above using that the local errors accumulate and contribute to the global error as diagonal terms in the standard manner described in detail at the end of section  [ sec : globalerror ] .",
    "note that we include the terms @xmath191 $ ] in the order  @xmath34 uniformly accurate magnus integrator .",
    "these terms appear at leading order in the global remainder where they would otherwise generate a non - positive definite contribution to @xmath174 in  .",
    "note that the magnus integrator @xmath192 is an order  @xmath34 integrator without the terms @xmath191 $ ] .",
    "however they are cheap to compute and including them in the integrator guarantees global superior accuracy independent of the set of governing coefficient matrices .",
    "what happens when the linear diffusion vector fields do not commute , i.e.  we have @xmath159\\neq0 $ ] for non - zero indices @xmath188 ?",
    "hereafter assume @xmath193 .",
    "consider the case of order  @xmath34 integrators .",
    "the local flow remainders are @xmath194 and @xmath195 + \\sum_{i\\neq j}\\bigl(j_{iij}-\\tfrac{1}{2}j_ij_{ij } + \\tfrac{1}{12}j_i^2j_j\\bigr)[a_i,[a_i , a_j]]\\\\ & \\;+\\sum_{i < j < k } \\bigl((j_{ijk}+\\tfrac12 j_jj_{ki}+\\tfrac12 j_kj_{ij } -\\tfrac23 j_ij_jj_k)[a_i,[a_j , a_k]]\\\\ & \\;\\qquad\\qquad+(j_{jik}+\\tfrac12 j_ij_{kj}+\\tfrac12 j_kj_{ji } -\\tfrac23 j_ij_jj_k)[a_j,[a_i , a_k]]\\bigr)\\,.\\end{aligned}\\ ] ]",
    "computing @xmath174 in   gives @xmath196 where @xmath197 and in addition we have that @xmath198 .",
    "here @xmath199 consist of @xmath7 diagonal blocks of the form @xmath200 and @xmath201 where @xmath202 and @xmath203 again , @xmath204 is positive semi - definite with eigenvalues @xmath205 .",
    "however @xmath206 has eigenvalues @xmath207 , where the final three values are approximations to the roots of @xmath208 .",
    "the eigenvalues of @xmath206 and @xmath204 , respectively , are multiple eigenvalues for the matrices @xmath209 and @xmath210 , respectively .",
    "this implies that there are certain matrix combinations and initial conditions , for which the order  @xmath34 taylor approximation is more accurate in the mean - square sense than the magnus approximation .",
    "however , the two negative values are small in absolute value compared to the positive eigenvalues . for the majority of systems",
    ", one can thus expect the magnus aproximation to be more accurate ( as already observed by sipilinen  @xcite , burrage  @xcite and burrage and burrage  @xcite ) .",
    "for any given linear system of stochastic differential equations , the scheme that is more accurate can be identified using the results above .    in this case",
    "there are terms from @xmath158 in magnus remainder expression   that appear at leading order in the local flow remainder .",
    "these terms are of the form @xmath211+a_j[a_i,[a_i , a_j]]\\bigr)h^2 $ ] .",
    "they make a negative definite contribution to global error , though this can be negated by including them as cheaply computable terms in the magnus integrator ( indeed we recommend doing so ) .",
    "we start by emphasizing that there are two inherent scales :    * _ quadrature scale _ @xmath212 on which the discrete wiener paths are generated ; * _ evaluation scale _ @xmath47 on which the stochastic differential equation is advanced .",
    "the idea is to approximate multiple stratonovich integrals by their corresponding expectations conditioned on the @xmath213-algebra representing intervening knowledge of the wiener paths ( clark and cameron  @xcite ; newton  @xcite ; gaines and lyons  @xcite ) .",
    "hence we approximate @xmath214 by @xmath215 where @xmath216 with @xmath217 , and @xmath218 , i.e.  @xmath48 is the number of wiener increments .",
    "we extend the result of clark and cameron  @xcite on the maximum rate of convergence to arbitrary order multiple stratonovich integrals .",
    "[ lem : quaderr ] suppose at least two of the indices in the multi - index @xmath219 are distinct .",
    "define @xmath220 let @xmath221 denote the number of zeros in @xmath67 , and @xmath222 .",
    "then the @xmath43 error in the multiple stratonovich integral approximation @xmath215 is @xmath223    for any @xmath224 , we write for brevity @xmath225 we define @xmath226 as the multi - index obtained by deleting the last @xmath81 indices , that is @xmath227 .",
    "we set @xmath228 , where @xmath229 .",
    "then @xmath230 thus we have @xmath231    we prove the assertion by induction over @xmath28 . for @xmath232 ,",
    "the first two terms in the sum   are zero and @xmath233 here we have used that fact that @xmath232 , @xmath234 and thus @xmath235 .",
    "assume now that @xmath236 .",
    "we will investigate the order of each of the three types of terms in separately .",
    "if at least two indices in @xmath226 are distinct , then by induction hypothesis @xmath237 and since @xmath238 and @xmath239 , we have for each @xmath240 , @xmath241 note that we have @xmath242 if all indices in @xmath226 are equal , then @xmath243 .",
    "for the second term in we have for each @xmath240 , @xmath244 note that in the second of these cases @xmath245    for the third term we have @xmath246 again , note that we have @xmath247    equality holds in at least one of to . to see this we distinguish the case when the last two indices are equal , @xmath248 , and the case when the last two indices are distinct , @xmath249 . if @xmath248 , then @xmath250 since in this case at least two indices in @xmath251 are distinct , equality holds for @xmath252 in  .",
    "if @xmath253 , then @xmath254 and thus equality holds for @xmath255 in  . hence the lemma follows .",
    "note that each multiple stratonovich integral @xmath214 can be thought of as an @xmath28-dimensional topologically conical volume in @xmath256-space .",
    "the surface of the conical volume is _ panelled _ with each panel distinguished by a double stratonovich integral term involving two consecutive indices from @xmath67 .",
    "the edges between the panels are distinguished by a triple integral and so forth .",
    "the conditional expectation approximation @xmath257 can also be decomposed in this way . in the @xmath43-error estimate for this approximation ,",
    "the leading terms are given by sums over the panels which also confirm the estimate  .",
    "approximations of multiple stratonovich integrals constructed using their conditional expectations are intimately linked to those constructed using paths @xmath258 that are approximated by piecewise linear interpolations of the intervening sample points .",
    "the difference between the two approaches are asymptotically smaller terms . for more details",
    "see wong and zakai  @xcite , kloeden and platen  @xcite , hofmann and mller - gronbach  @xcite and gyngy and michaletzky  @xcite .",
    "we examine in detail the stepsize / accuracy regimes for which higher order stochastic integrators are feasible and also when they become less efficient than lower order schemes . in any strong simulation",
    "there are two principle sources of computational effort .",
    "firstly there is evaluation effort @xmath259 associated with evaluating the vector fields , their compositions and any functions such as the matrix exponential .",
    "secondly there is the quadrature effort @xmath260 associated with approximating multiple stochastic integrals to an accuracy commensurate with the order of the method . for a numerical approximation of order @xmath144 the computational evaluation effort measured in flops over @xmath261 evaluation steps is @xmath262 here @xmath40 is the size of the system , @xmath263 represents the number of scalar - matrix multiplications and matrix - matrix additions for the order @xmath144 truncated magnus expansion , and @xmath264 is the effort required to compute the matrix exponential . note that if we implement an order @xmath33 method there is no quadrature effort . hence since @xmath265 we have @xmath266 .",
    "suppose we are required to simulate @xmath267 with all the indices distinct with a global error of order @xmath268 ; naturally @xmath269 and @xmath270 .",
    "[ lem : quadscaling ] the quadrature effort @xmath271 measured in flops required to approximate @xmath272 with a global error of order @xmath268 when all the indices are distinct and non - zero , is to leading order in @xmath47 : @xmath273 where @xmath274 since we stipulate the global error associated with the multiple integral approximation to be @xmath275 , we have @xmath276    the quadrature effort required to construct @xmath277 , which is a @xmath278-multiple sum , over @xmath52 $ ] is @xmath279 with @xmath261 . using lemma  [ lem : quaderr ] to achieve a global accuracy of order @xmath268 and therefore local @xmath43-norm of order @xmath147 for this integral , requires that @xmath280 .",
    ".slopes of the logarithm of the global error @xmath281 verses the logarithm of the quadrature effort @xmath271 , i.e.  the exponent @xmath282 , for different values of @xmath283 and @xmath144 when @xmath284 has distinct non - zero indices . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     in table  7.1 we quote values for the exponent @xmath282 for different values of @xmath144 and @xmath283 in the case when all the distinct indices @xmath285 are non - zero .",
    "suppose we are given a stochastic differential equation driven by a @xmath4-dimensional wiener process with non - commuting governing vector fields . to successfully implement a strong numerical method of order @xmath144 we must guarantee that the global error associated with each multiple integral present in the integrator that is approximated by its conditional expectation is also of order @xmath144 .",
    "if we implement a numerical method of order @xmath286 , we will _ in general _ be required to simulate multiple stratonovich integrals with distinct indices of length @xmath283 with @xmath287 .",
    "we will also have to simulate multiple integrals with repeated indices of length @xmath288 .",
    "these integrals will require the same or fewer quadrature points than those with distinct indices as we can take advantage of the repeated indices  see section  [ sec : effquadbasis ] for more details .",
    "such integrals therefore represent lower order corrections to the quadrature effort . similarly multiple integrals with distinct indices that involve a zero index have index length that is one less than similar order multiple integrals with distinct non - zero indices .",
    "hence they will also represent lower order corrections to the quadrature effort .    to examine the scaling exponent in the relation between the global error @xmath281 and the quadrature effort @xmath260 , which is the sum total of the efforts required to approximate all the required multiple integrals to order @xmath268 , we use table  7.1 as a guide for the dominant scalings . for methods of order @xmath286 , if @xmath54 and we implement a method of order @xmath289 , then the dominant exponent is @xmath57 . similarly if @xmath290 then order @xmath34 and @xmath35 methods also invoke a dominant scaling exponent of @xmath57 for the integrals of length @xmath291 and @xmath292 .",
    "if @xmath293 then methods of order @xmath34 and @xmath35 have the same scaling exponent of @xmath57 , however the method of order @xmath44 involves multiple integrals with three indices which are all distinct and the dominant scaling exponent for them is @xmath294 .",
    "if we implement a method of order @xmath295 then we will be required to simulate multiple stratonovich integrals with distinct indices of length @xmath283 with @xmath296 .",
    "we must also simulate higher order multiple integrals with indices of length @xmath297 involving repetitions with @xmath298 ; these may be cheaper to simulate than multiple integrals of the same length with distinct indices ( again see section  [ sec : effquadbasis ] ) .",
    "when @xmath54 the dominant scaling exponent is @xmath57 for all orders . for @xmath55",
    "the dominant scaling exponent is _ at best _",
    "@xmath57 , and so forth .",
    "lastly , we give an estimate for the critical stepsize @xmath299 below which the quadrature effort dominates the evaluation effort .",
    "since @xmath300 minimizes @xmath301 we have the following estimate .",
    "[ lem : hcr ] for the case of general non - commuting governing vector fields and a numerical approximation of order @xmath144 , we have @xmath302 if and only if @xmath303 where the critical stepsize @xmath304 where @xmath305 .    in practice",
    "when we implement numerical methods for stochastic differential equations driven by a @xmath4-dimensional wiener process we expect that for @xmath303 the evaluation effort dominates the compuational cost . in this scenario integrators of order @xmath144",
    "scale like their deterministic counterparts .",
    "consider what we might expect to see in a log - log plot of global error verses computational cost . as a function of increasing computational cost we expect the global error for each method to fan out with slope @xmath306 , with higher order methods providing superior accuracy for a given effort .",
    "however once the quadrature effort starts to dominate , the scaling exponents described above take over .",
    "when @xmath54 for example and all methods dress themselves with the scaling exponent @xmath57 , then we expect to see parallel graphs with higher order methods still providing superior accuracy for a given cost",
    ". however higher order methods that assume a scaling exponent worse than @xmath57 will eventually re - intersect the graphs of their lower order counterparts and past that regime should not be used .",
    "note that in the case when all the diffusion vector fields commute , methods of order  @xmath34 do not involve any quadrature effort and hence @xmath307 .",
    "using lemma  [ lem : quaderr ] , we can by analogy with the arguments in the proof of lemma  [ lem : quadscaling ] , determine the dominant scaling exponents for methods of order @xmath308 .",
    "for example the @xmath43-error associated with approximating @xmath309 by its expectation conditioned on intervening information is of order @xmath310 .",
    "hence we need only choose @xmath311 to achieve to achieve a global error of order @xmath35 . in this case",
    "the dominant scaling exponent is @xmath312 .",
    "however the @xmath43-error associated with approximating @xmath313 for @xmath188 is of order @xmath314 whereas for @xmath315 and @xmath316 it is of order @xmath317 . for the case of diffusing vector fields",
    "we do not need to simulate @xmath313 , and so for a method of order @xmath44 the dominant scaling exponent is still @xmath312 .",
    "however more generally the effort associated with approximating @xmath313 dominates the effort associated with the other two integrals .",
    "when multiple stratonovich integrals contain repeated indices , are they as cheap to compute as the corresponding lower dimensional integrals with an equal number of distinct indices ( none of them repeated ) ?",
    "let @xmath318 denote the multi - index with @xmath40 copies of the index @xmath319 .",
    "repeated integration by parts yields the formulae    [ eq : parts ] @xmath320    the first relation   suggests that any integral of the form @xmath321 can always be approximated by a single sum .",
    "this last statement is true for @xmath322 . if we assume it is true for @xmath323 and apply the relation   we establish by induction that @xmath321 can be approximated by a single sum .",
    "a similar induction argument using   then also establishes that any integral of the form @xmath324 can also be approximated by a single sum .",
    "hence in both cases the quadrature effort is proportional to @xmath325 .",
    "implicit in the relations   is the natural underlying shuffle algebra created by integration by parts ( see gaines  @xcite , kawksi  @xcite and munthe  kaas and wright  @xcite ) .",
    "two further results are of interest .",
    "firstly we remark that by integration by parts we have the following two shuffle product results :    [ eq : shuff ] @xmath326    if we replace @xmath327 by @xmath328 in   and and then by @xmath329 in   and , respectively , we obtain the linear system of equations @xmath330 by direct inspection the coefficient matrix on the left - hand side has rank @xmath331 and so all the multiple stratonovich integrals @xmath332 , @xmath333 , @xmath334 and @xmath335 can be expressed in terms of @xmath336 and @xmath337 and products of lower order integrals , all of which can be approximated by single sums ( note that @xmath338 ) .    now consider the set of multiple stratonovich integrals @xmath339 where we exclude the elements @xmath340 and @xmath341 which we know can be approximated by single sums from  . by considering the shuffle relations generated by products of the form : @xmath342 , @xmath343 , @xmath344 and @xmath345 and substituting in the @xmath346 elements with indices from ` @xmath347 ' we obtain an linear system of equations analogous to   with @xmath348 equations for the @xmath349 unknowns in @xmath350 .",
    "however direct calculation shows that the corresponding coefficient matrix has rank @xmath351 . in particular ,",
    "all of the multiple integrals in @xmath350 can be expressed in terms of @xmath340 , @xmath341 and @xmath352 .",
    "hence the set of multiple integrals with indices from ` @xmath347 ' can not all be approximated by single sums , but in fact require a double sum to approximate @xmath352",
    ".    for simplicity assume @xmath353 .",
    "consider numerical schemes of increasing order @xmath144 .",
    "if @xmath354 all the necessary multiple integrals can be approximated by single sums  at the highest order in this range indices involving permutations of @xmath355 and @xmath356 are included for which the corresponding integrals can be approximated by single sums . for methods of order @xmath357",
    "we require at least double sums to approximate the necessary multiple integrals .    when @xmath54 , for methods of order @xmath358 the integrals involved can be approximated by single sums , but for @xmath359 integrals involving indices with permutations of @xmath360 are included which can only be approximated by double sums .",
    "if there were no drift vector field then for @xmath361 the necessary multiple integrals can all be approximated by single sums , but for @xmath362 we need to include multiple integrals involving indices with permutations of @xmath363 which require approximation by double sums .",
    "we can in principle extend these results to higher values @xmath144 , however methods of order @xmath364 for @xmath365 are not commonly implemented !",
    "our first application is for stochastic riccati differential systems  some classes of which can be reformulated as linear systems ( see freiling  @xcite and schiff and shnider  @xcite ) .",
    "such systems arise in stochastic linear - quadratic optimal control problems , for example , mean - variance hedging in finance ( see bobrovnytska and schweizer  @xcite and kohlmann and tang  @xcite)though often these are backward problems ( which we intend to investigate in a separate study ) . consider for example riccati equations of the form @xmath366 if @xmath367 satisfies the linear stochastic differential system  , with @xmath368 then @xmath369 solves the riccati equation above .",
    "we consider here a riccati problem with two additive wiener processes , @xmath59 and @xmath60 , and coefficient matrices @xmath370 and @xmath371 all other coefficient matrices are zero .",
    "the initial data is the @xmath372 identity matrix , i.e.  @xmath373 and therefore @xmath374 and @xmath375 also .",
    "we found higham  @xcite a very useful starting point for our matlab simulations .",
    "note that for this example the coefficient matrices @xmath376 and @xmath377 are upper right block triangular and therefore nilpotent of degree @xmath44 , and also that @xmath378 and @xmath379 are identically zero so that in particular @xmath380=0 $ ] .",
    "the number of terms in each integrator at either order  @xmath34 or @xmath35 is roughly equal , and so for a given stepsize the uniformly accurate magnus integrators should be more expensive to compute due to the cost of computing the @xmath381 matrix exponential  we used a @xmath382 pad approximation with scaling to compute the matrix exponential .",
    "see moler and van loan  @xcite and also iserles and zanna  @xcite , the computational cost is roughly @xmath383 times the system size cubed .",
    "also note the order @xmath34 integrators do not involve quadrature effort whilst the order @xmath35 integrators involve the quadrature effort associated with approximating @xmath384 and @xmath385 .",
    "for comparison , we use a nonlinear runge  kutta type order @xmath35 scheme for the case of two additive noise terms ( from kloeden and platen  @xcite ) applied directly to the original riccati equation : @xmath386 where @xmath387 and @xmath388 .    in figure  [ globalerrorriccati ]",
    "we show how the global error scales with stepsize and also cpu clocktime for this riccati problem .",
    "note that as anticipated , for the same step size ( compare respective plot points starting from the left ) , the order @xmath34 magnus integrator is more expensive to compute and more accurate than the order @xmath34 neumann integrator .",
    "now compare the order @xmath35 integrators . for the nonlinear scheme",
    ", we must evaluate @xmath389 five times per step per path costing @xmath390 flops  here",
    "@xmath391 refers to the size of the original riccati system . for the neumann and magnus integrators the evaluation costs are @xmath392 and @xmath393 flops ,",
    "respectively ( directly counting from the schemes ) .",
    "hence for large stepsize we expect the neumann integrator to be cheapest and the magnus and nonlinear runge  kutta integrators to be more expensive .",
    "however for much smaller stepsizes the quadrature effort should start to dominate .",
    "the efforts of all the order @xmath35 integrators will not be much different and the magnus integrator then outperforms the other two due to its superior accuracy .    .",
    "the magnus integrators of order  @xmath34 and @xmath35 shown are the uniformly accurate magnus integrators from section  [ globalcomparison].,title=\"fig:\",width=340,height=188 ] .",
    "the magnus integrators of order  @xmath34 and @xmath35 shown are the uniformly accurate magnus integrators from section  [ globalcomparison].,title=\"fig:\",width=340,height=188 ]       with @xmath44 driving wiener processes .",
    "the error corresponding to the largest step size takes the shortest time to compute.,title=\"fig:\",width=340,height=188 ]   with @xmath44 driving wiener processes .",
    "the error corresponding to the largest step size takes the shortest time to compute.,title=\"fig:\",width=340,height=188 ]     with @xmath44 driving wiener processes.,width=340,height=188 ]     with @xmath394 driving wiener processes .",
    "the error corresponding to the largest step size takes the shortest time to compute.,title=\"fig:\",width=340,height=188 ]   with @xmath394 driving wiener processes .",
    "the error corresponding to the largest step size takes the shortest time to compute.,title=\"fig:\",width=340,height=188 ]    our second numerical example is for a homogeneous and constant coefficient linear problem involving two wiener processes with coefficient matrices @xmath395 where the @xmath396 , @xmath397 are given in   and do _ not commute _ , and initial data @xmath398 . in figure  [ globalerror ] we show how the error scales with stepsize and cpu clocktime . we see that the superior accuracy of the magnus integrators is achieved for the same computational cost . note that in the case",
    "@xmath289 we have @xmath399 . for the case",
    "when @xmath400 , when computational cost is dominated by quadrature effort , the relation between the global error @xmath401 and computational cost @xmath271 is , ignoring @xmath259 and taking the logarithm , @xmath402 for the order @xmath33 magnus method the computational cost @xmath271 is given solely by the evaluation effort and therefore we have @xmath403 further note that @xmath404 and @xmath405 are strictly order one , and that @xmath406 , @xmath391 , @xmath407 and @xmath408 ( counting directly from the inegration scheme ) .",
    "in addition @xmath409 flops using the @xmath382 pad approximation with scaling . substituting these values into the difference of these last two estimates reveals that @xmath410 which is in good agreement with the difference shown in figure  [ globalerror ] .    also for this example",
    ", we have shown @xmath411 confidence intervals in figure  [ fig : confidence ] for the global errors of the uniformly accurate magnus integrators of orders  @xmath34 and @xmath35 .",
    "the confidence intervals become narrower as the stepsize decreases and order of the method increases , as expected  see kloeden and platen  @xcite .    in figure",
    "[ globalerror3 ] we consider a linear stochastic differential system driven by _",
    "three _ independent scalar wiener processes , with the same vector fields as in the linear system with two wiener processes just considered but with an additional linear diffusion vector field characterized by the coefficient matrix @xmath412 which does not commute with @xmath413 , @xmath376 or @xmath377 .",
    "using table  7.1 we would expect to see for small stepsizes for the order @xmath34 and @xmath35 magnus and neumann methods , that the global error scales with the computational effort with exponent @xmath57 .",
    "this can be seen in figure  [ globalerror3 ] .",
    "our results can be extended to nonlinear stochastic differential equations . consider a stochastic differential system governed by @xmath414 nonlinear autonomous vector fields @xmath415instead of the linear vector fields ` @xmath416 ' in  and driven by a @xmath4-dimensional wiener process @xmath3 .",
    "if we take the logarithm of the stochastic taylor series for the flow - map we obtain the exponential lie series ( see chen  @xcite and strichartz  @xcite ) @xmath417+\\cdots\\,.\\ ] ] here @xmath418 $ ] is the lie  jacobi bracket on the lie algebra of vectors fields defined on @xmath419 . the solution @xmath77 of the system at time @xmath19 is given by @xmath420 ( see for example ben arous  @xcite or castell and gaines  @xcite ) . across the interval",
    "@xmath127 $ ] let @xmath421 denote the exponential lie series truncated to a given order , with multiple integrals approximated by their expectations conditioned on intervening sample points .",
    "then @xmath422 is an approximation to the exact solution @xmath423 at the end point of the interval .",
    "the truncated and conditioned exponential lie series @xmath421 is itself an ordinary vector field .",
    "hence to compute @xmath129 we solve the ordinary differential system @xmath424 with @xmath425 across the interval @xmath426 $ ] ( see castell and gaines  @xcite ) . if we use a sufficiently accurate ordinary differential integrator commensurate with the order of the truncation of the exponential lie series then @xmath427 to that order .",
    "hence the order  @xmath33 exponential lie series integrator is more accurate than the euler ",
    "maruyama method .",
    "further in the case of commuting diffusion vector fields , the uniformly accurate exponential lie series integrators of order @xmath34 and @xmath35 are more accurate than the stochastic taylor approximations of the corresponding order .",
    "this generalization is discussed in malham and wiese  @xcite . an important future investigation to justify the viability of these schemes",
    "would be the relation between global error and computational cost , which must take into account the additional computational effort associated with the ordinary differential solver .",
    "an important application for our results that we have in mind for the future are large order problems driven by a large number of wiener processes .",
    "high - dimensional problems occur in many financial applications , for example in portfolio optimization or risk management and in the context of option pricing when high - dimensional models are used , for example for the pricing of interest rate options or rainbow options .",
    "large order problems also arise when numerically solving stochastic parabolic partial differential equation driven by a multiplicative noise term which is white noise in time and spatially smooth ( see for example lord and shardlow  @xcite ) . here",
    "we think of projecting the system onto a finite spatial basis set which results in a large system of coupled ordinary stochastic differential equations each driven by a multiplicative noise term .",
    "the high dimension @xmath4 of the driving wiener process will now be an important factor in the computational cost for order  @xmath428 as for example we will need to simulate @xmath429 multiple integrals @xmath430 ; though the results of wiktorsson  @xcite suggest this can be improved upon .",
    "krylov subspace methods for computing large matrix exponentials would be important for efficient implementation of our methods for this case ( see moler and van loan  @xcite and sidje  @xcite ) .",
    "lastly , extensions of our work that we also intend to investigate further are : ( 1 ) implementing a variable step scheme following gaines and lyons  @xcite , lamba , mattingly and stuart  @xcite , burrage and burrage  @xcite and burrage , burrage and tian  @xcite  by using analytic expressions for the local truncation errors ( see aparicio , malham and oliver  @xcite ) ; ( 2 ) pricing path - dependent options ; ( 3 ) deriving strong symplectic numerical methods ( see milstein , repin and tretyakov  @xcite ) ; and ( 4 ) constructing numerical methods based on the nonlinear magnus expansions of casas and iserles  @xcite .",
    "we thank kevin and pamela burrage , sandy davie , terry lyons , per - christian moan , nigel newton , tony shardlow , josef teichmann and michael tretyakov for stimulating discussions . the research in this paper",
    "was supported by the epsrc first grant number gr / s22134/01 .",
    "a significant portion of this paper was completed while sjam was visiting the isaac newton institute in the spring of 2007 .",
    "we would also like to thank the anonymous referees for their very helpful comments and suggestions .",
    "we present neumann and magnus integrators up to global order @xmath35 in the case of a @xmath4-dimensional wiener process @xmath431 , and with constant coefficient matrices @xmath413 and @xmath73 , @xmath10 .",
    "the neumann expansion for the solution of the stochastic differential equation   over an interval @xmath127 $ ] , where @xmath133 , is @xmath432 where ( the indices @xmath433 run over the values @xmath434 ) @xmath435 the corresponding approximation using the magnus expansion is @xmath436 where , with @xmath437 $ ] as the matrix commutator , @xmath438\\,,\\\\ s_{3/2}=&\\;\\sum_{i}\\tfrac12(j_{i0}-j_{0i})[a_0,a_i ] + \\sum_{i\\neq j}(j_{iij}-\\tfrac{1}{2}j_ij_{ij } + \\tfrac{1}{12}j_i^2j_j)[a_i,[a_i , a_j]]\\\\ & \\;+\\sum_{i < j < k }   \\bigl((j_{ijk}+\\tfrac12 j_jj_{ki}+\\tfrac12 j_kj_{ij } -\\tfrac23 j_ij_jj_k)[a_i,[a_j , a_k]]\\\\ & \\;\\qquad\\qquad+(j_{jik}+\\tfrac12 j_ij_{kj}+\\tfrac12 j_kj_{ji } -\\tfrac23 j_ij_jj_k)[a_j,[a_i , a_k]]\\bigr)\\\\ & \\;+\\sum_{i}(j_{ii0}-\\tfrac{1}{2}j_ij_{i0 } + \\tfrac{1}{12}j_i^2j_0)[a_i,[a_i , a_0]]\\,.\\end{aligned}\\ ] ] to obtain a numerical scheme of global order @xmath144 using the neumann or magnus expansion , we must use all the terms up to and including @xmath439 or @xmath440 , respectively .",
    "leading order terms of order @xmath441 with non - zero expectation can be replaced by their expectations ( as detailed at the end of section  [ sec : globalerror ] ) .",
    "further , extending these solution series to the non - homogeneous and/or the non - constant coefficient case is straightforward .                                , _ the ordinary differential equation approach to asymptotically efficient schemes for solution of stochastic differential equations _ , ann .",
    "h. poincar probab .",
    ", 32(2 ) ( 1996 ) , pp .",
    "231250 .",
    "j.  m.  c. clark and r.  j. cameron , _ the maximum rate of convergence of discrete approximations for stochastic differential equations _",
    ", in lecture notes in control and information sciences , vol .  25 , 1980 , pp .",
    "162171 .",
    "h.  schurz , _ a brief introduction to numerical analysis of ( ordinary ) stochastic differential equations without tears _ , in handbook of stochastic analysis and applications , v.  lakshmikantham and d.  kannan , eds .",
    ", marcel dekker , 2002 , pp .  237359 .",
    "h.  j. sussmann , _ product expansions of exponential lie series and the discretization of stochastic differential equations _ , in stochastic differential systems , stochastic control theory , and applications , w.  fleming and j.  lions , eds . , springer i m a series , vol .",
    "10 , 1988 , pp .",
    "563582 .",
    "d.  talay , _ simulation and numerical analysis of stochastic differential systems _ , in probabilistic methods in applied physics , p.  kree and w.  wedig , eds . ,",
    "lecture notes in physics , vol . 451 , 1995 , chap .",
    "3 , pp .  63106 ."
  ],
  "abstract_text": [
    "<S> we present numerical schemes for the strong solution of linear stochastic differential equations driven by an arbitrary number of wiener processes . </S>",
    "<S> these schemes are based on the neumann ( stochastic taylor ) and magnus expansions . </S>",
    "<S> firstly , we consider the case when the governing linear diffusion vector fields commute with each other , but not with the linear drift vector field . we prove that numerical methods based on the magnus expansion are more accurate in the mean - square sense than corresponding stochastic taylor integration schemes . </S>",
    "<S> secondly , we derive the maximal rate of convergence for arbitrary multi - dimensional stochastic integrals approximated by their conditional expectations . </S>",
    "<S> consequently , for general nonlinear stochastic differential equations with non - commuting vector fields , we deduce explicit formulae for the relation between error and computational costs for methods of arbitrary order . </S>",
    "<S> thirdly , we consider the consequences in two numerical studies , one of which is an application arising in stochastic linear - quadratic optimal control .    </S>",
    "<S> [ firstpage ]    linear stochastic differential equations , strong numerical methods , magnus expansion , stochastic linear - quadratic control    60h10 , 60h35 , 93e20 </S>"
  ]
}