{
  "article_text": [
    "one of the most fundamental questions in evolutionary biology is the spread of a mutant with fitness @xmath0 into a wild type population with fitness @xmath1 . in a non - structured population ( _ i.e. , _ for a population at dimension @xmath2 )",
    ", the answer to this question was found by kimura@xcite nearly 50 years ago as a good approximate solution of the fisher - wright or the moran model of population genetics , and better solutions of the moran model have been proposed recently@xcite . for geographically structured populations however , the question is far from settled and only some specific information , such as the fixation probability , has received partial answers in a field that is now called evolutionary graph dynamics@xcite . for geographically structured populations where the main ingredients of the competing populations , _",
    "i.e. , _ the fitness , the carrying capacity and the diffusion of individuals , are independent of the space , the evolutionary dynamics has been mostly investigated through the stochastic fisher kolmogorov petrovsky , piscounov ( sfkpp ) equation @xmath3 where @xmath4 is the local relative density of the mutant with respect to the local carrying capacity , @xmath5 is the diffusion coefficient of individuals , @xmath6 is proportional to the relative excess fitness of mutants ; the last term is a noise term that captures the local genetic drift , where @xmath7 is related to the local carrying capacity and @xmath8 is a white noise .",
    "the problem that has attracted most attention is that of the front propagation : if at the initial time , one half of space is filled only with the mutant type and the other half only with the wild type , then the dynamics of the problem can be reduced to the dynamics of the front separating the two types .",
    "the deterministic part of the equation ( fkpp ) was proposed by fisher@xcite and kolmogorov , petrovsky , piscounov@xcite ; it has found applications in many areas of science ranging from ecology and epidemiology@xcite to chemical kinetics@xcite and particle physics@xcite .",
    "the properties of the fkpp equation have been widely investigated@xcite .",
    "specifically , this equation allows for traveling wave solutions and it is known that a stable solution of the fkpp is a wave front connecting the two regions @xmath9 and @xmath10 with velocity @xmath11 and width @xmath12 .",
    "the fkpp equation however is not well adapted to evolutionary population dynamics at small selection pressure , which is one of the relevant limits of population genetics@xcite .",
    "the fkpp equation describes quantities ( individuals , molecules , ... ) that at the fundamental level are discrete ; the noise associated with this discreteness can play an important role in the dynamics of the front , specifically at small selection pressures .",
    "this problem was tackled phenomenologically by adding either a cutoff @xcite or alternatively a noise term to the equation .",
    "the form of the noise in the sfkpp was proposed by doering et al.@xcite .",
    "the sfkpp proposed by doering et al . has now become a major mathematical tool for the investigation of fisher waves .",
    "it has specifically been used by hallatschek and korolev@xcite to investigate the properties of the front at small selection pressure , where they revealed the marked difference of the solutions with respect to the deterministic equation .",
    "the sfkpp equation however is phenomenological and can not be derived rigorously from a microscopic , individual based model of population genetics .",
    "firstly , individual based models such as the moran model are governed by discrete master equations and can be approximated by a fokker - planck equation , or their equivalent stochastic differential equation , only in the limit of large system size , _",
    "i.e. , _ large local carrying capacity@xcite . the local carrying capacity however does not appear explicitly in the sfkpp equation and it is difficult to assess the precision of the focker - planck approximation solely from this equation .",
    "secondly , and more importantly , the noise term @xmath13 in sfkpp is purely local .",
    "this noise term is rigorous only for a 0 dimensional system , where the equivalence between the fokker - planck approximation and the stochastic differential equation can be shown . for a spatially extended system ,",
    "the noise term should also include fluctuations arising from adjacent lattice cells . to our knowledge , however , a rigorous derivation has not yet been achieved ( see mathematical details [ subsec : noisesfkpp ] ) .",
    "the problem of noise arising from adjacent cells was also noted by korolev et al.@xcite .",
    "finally , in an evolutionary model , both the diffusion coefficient and the noise amplitude are the result of the same phenomenon of individuals replacing each other randomly and they should be linked through an einstein like relation .",
    "the aim of the present article is to study the dynamics of the front between mutant and wild type individuals directly from the individual based , stochastic moran model of population genetics . for this model",
    ", the master equation can be stated without ambiguity or approximation .",
    "we show that the mean field approximation of the master equation gives rise to a partial differential equation that differs from the fkpp equation and its predictions at high selection pressure .",
    "going beyond mean field , we then derive the exact equations for the evolution of the various moments of the front for a one dimensional system and solve it at small selection pressure .",
    "in this approach , the noise term is not restricted to be only local .",
    "we show , in agreement with @xcite that even for a neutral model ( _ i.e. , @xmath14 _ ) , the front is well defined and the displacement of the front can be mapped into a brownian motion at large times , the convergence time to this state is shown to be in @xmath15 .",
    "the front drift and its velocity can then be derived at small selection pressure by a perturbatiion approach where we can show , in contrast to the fkpp predictions , that the speed of the front is linear in the excess relative fitness @xmath16 .",
    "finally , we show that the _ effective _ local population size which controls the noise amplitude , and the diffusion coefficient are both determined by the dispersal kernel of individuals and can not be chosen as independent parameters .",
    "this article is organized as follow .",
    "section [ sec : the-1d - system ] is devoted to the generalization of the moran model to population geographically structured into demes / islands , where the dynamics of the front can be deduced from the internal population dynamics of the islands and their exchanges .",
    "we demonstrate in subsection [ subsec : mean - field - approximation . ]",
    "how an fkpp - like equation emerges from the mean field approximation of the master equation and show how it differs from the classical fkpp equation .",
    "the following subsections of section [ sec : the-1d - system ] are devoted to full stochastic treatments of the dynamics of the front .",
    "section [ sec : microscopic model . ] goes beyond the island model and considers general migration kernels between individuals that are no longer grouped into demes . solving the master equation of the model shows how the island size and migration number between neighboring islands of section [ sec : the-1d - system ] are related through the dispersal kernel .",
    "the approach allows for the determination of the effective population size and therefore the noise amplitude .",
    "the final section is devoted to discussion and conclusions .",
    "the fundamental model of population genetics for non structured populations@xcite was formulated by fisher and wright@xcite .",
    "a continuous time version , which is also more mathematically tractable , was proposed by moran@xcite .",
    "the extension of the moran model to geographically extended populations was formulated by kimura@xcite and maruyama@xcite and in more recent terminology is referred to as evolutionary dynamics on graphs @xcite .",
    "the model is also widely used in ecology , specifically in the framework of the neutral theory of biodiversity@xcite .    in this model ,",
    "populations , formed of wild type individuals with fitness 1 and mutants with fitness @xmath0 are structured into cells ( or demes or islands ) each containing @xmath17 individuals .",
    "when an individual dies in one island , it is immediately replaced by the progeny of another , therefore keeping the number of individuals in each island always equal to @xmath17 .",
    "the replacement probability is weighted by the fitness of the individuals ; moreover , the progeny stems from a local parent with probability @xmath18 or a parent from a neighboring island with probability @xmath19 ( figure [ fig : moranspace ] ) .",
    "these three parameters , @xmath17 , @xmath16 and @xmath19 are the only ingredients of this generic model .    ]",
    "let us consider an infinitely extended one - dimensional collection of islands and call @xmath20 the number of mutant individuals on island @xmath21 .",
    "we use the vector @xmath22 as a shorthand notation for the collection of these numbers @xmath23 .",
    "the transition probability densities for the number of mutants on island @xmath21 to increase / decrease by one individual is@xcite : @xmath24\\label{eq : rateup}\\\\ w_{i}^{-}(\\mathbf{n } ) & = & \\frac{\\mu}{n}n_{i}\\left[(n - n_{i})-\\frac{m}{2}n''_{i}\\right]\\label{eq : ratedown}\\end{aligned}\\ ] ] where @xmath25 is the death rate of individuals and @xmath26 the rate of increase ( [ eq : rateup ] ) for example is the probability density per unit of time that one wild type individual dies ( @xmath27 ) multiplied by the probability that it is replaced by a mutant , either from a local parent ( @xmath28 ) or a neighboring parent ( @xmath29 ) , and multiplied by the fitness of the mutant @xmath30 .",
    "the fitness can be seen as an increase in the death rate of the wild type individuals , or a higher replacement probability / decreased death rate for the mutants .",
    "the probability @xmath31 of observing the state @xmath22 at time @xmath32 obeys the master equation @xmath33 where @xmath34 and @xmath35 are shorthand notations for states @xmath36 . without loss of generality",
    "( see mathematical details [ subsec : choice - of - initial ] ) , the initial condition we use throughout this article is that of an initial sharp front @xmath37      the mean field approximation for @xmath38 , the average number of individuals on island @xmath21 , is obtained by neglecting fluctuations ( _ i.e. , _ by setting @xmath39 ) @xmath40 taking the space continuum limit by setting @xmath41 , @xmath42 , we obtain the partial differential equation @xmath43\\frac{\\partial^{2}u}{\\partial x^{2}}+\\mu su(1-u)\\label{eq : meanfield}\\ ] ] where the length @xmath44 is the spatial extension of an island and @xmath45 is the diffusion coefficient .",
    "we observe that the mean field equation of the spatial moran model is different from the fkpp equation in the diffusion term .",
    "fisher himself , in his original article@xcite , had stressed that using a simple diffusion term is an oversimplification of basic population genetics processes .",
    "the modification of the diffusion term has important consequences both on the speed of the propagation front and on its width .",
    "the minimum speed of the propagating wave in the equation ( [ eq : meanfield ] ) is now ( see mathematical details [ subsec : meanfieldspeed ] ) @xmath46 which scales as @xmath16 for high value of the excess fitness , in contrast to the scaling in @xmath47 in the fkpp equation .",
    "numerical resolutions of eq.([eq : meanfield ] ) ( figure [ fig : frontspeed ] ) show that @xmath48 computed above is an excellent estimator of the speed of the front .    )",
    "( red squares ) are solved numerically for @xmath49 @xmath50 and the front speed is extracted for various values of the excess relative fitness @xmath16 .",
    "solid curves represent the theoretical values : fkpp @xmath51 ; moran @xmath52 .",
    "inset : width of the front as a function of @xmath16 .",
    "black circle : fkpp ; red square : moran .",
    "solid curves represent , for fkpp ( black ) @xmath53 ; for moran ( red ) @xmath54 ( eq . [ eq : meanwidth ] ) .",
    "[ fig : frontspeed ] ]    furthermore , the width of the front does not scale as @xmath55 as in the case of the fkpp equation , but is well approximated by @xmath56 where @xmath57 is a small correction ( see mathematical details [ subsec : meanfieldspeed ] ) . specifically , for large @xmath16 , the width converges to a constant @xmath58 .",
    "a phenomenological argument can be used to understand these modifications to the fkpp equation .",
    "it is well known@xcite that the dynamics of a pulled front is governed by the behavior at small @xmath59 . in these regions , the mean field equation ( [ eq : meanfield ] )",
    "can indeed be approximated by an fkpp equation , with the effective diffusion coefficient @xmath60 .",
    "we observe that the spatial moran model differs significantly from the prediction of fkpp equation at high fitness @xmath16",
    ". we will show below that the same is true at low fitness .",
    "this difference was first noted by hallatschek and korolev@xcite in their study of the sfkpp equation .",
    "let us now come back to the full stochastic treatment of the propagating front .",
    "the temporal evolution of local population moments can be extracted from the master equation ( [ eq : masterequation ] ) ( see appendix [ subsec : moment - computation - algebra . ] ) : @xmath61 the most important _ global _ quantities are the front displacement @xmath62 and its width @xmath63 .",
    "these global quantities can be measured in terms of local populations by @xmath64\\label{eq : displacement}\\\\ b(t ) & = & \\frac{1}{n^{2}}\\sum_{i=-\\infty}^{+\\infty}n_{i}(t)\\left[n - n_{i}(t)\\right]\\label{eq : width}\\end{aligned}\\ ] ] the width @xmath63 weights the region where the mutant population is different from either @xmath65 or @xmath17 , and in the continuous limit , can be expressed as @xmath66 where @xmath42 .",
    "note that these quantities are always finite , as the sums involve only a finite number of non - zero terms .",
    "we restrict this paper to the computation of the first moments of these quantities , namely @xmath67 , @xmath68 and @xmath69 , where @xmath70 stands for ensemble average .",
    "the computation of these quantities implies the computation of the second moments @xmath71 the width of the front is then @xmath72 and the variance of its displacement is @xmath73 for the neutral front ( @xmath14 ) , self consistent , exact equations without any moment closure approximation can be derived directly for the global quantities . at small selection pressures",
    "@xmath74 , they can be recovered through a first order perturbation analysis .      for a one dimensional system where mutants and wild type have the same fitness ( @xmath14 )",
    ", we will show that the front separating these two populations can be envisioned as a well defined object that performs a brownian motion and whose width fluctuates around an equilibrium value : @xmath75 and for large times , @xmath76 and @xmath77 .    to obtain the above quantities , we sum over local fluctuations @xmath78 there are different contributions to @xmath79 : one is the _ local _ demographic noise @xmath80 , which appears in the sfkpp equation ; the other term , @xmath81 , is the demographic noise due to adjacent cells and can not _ a priori _ be neglected__. _ _ in the extreme case where @xmath82 and therefore @xmath83 , the _ local _ demographic noise is exactly zero , but the stochasticity of the system remains the same , as we will see below .",
    "from now on , we will measure time in generation time units , _",
    "i.e. , _ set @xmath84 . by summing over the first moments , we find trivially that the mean front position stays at its initial value @xmath85 the second moments on the other hand obey a set of linear differential equations @xmath86 where @xmath87 , @xmath88 and the coefficients @xmath89 depend on the initial conditions : @xmath90 the parameters @xmath91 and @xmath92 measure the relative contribution to the demographic noise of local versus adjacent cells .",
    "the parameter @xmath92 can be neglected with respect to @xmath91 only in the limit of small migration probability @xmath93 .    for an initially sharp front",
    "( eq . [ eq : sharpfront ] ) , @xmath94 .",
    "we stress that we can assume this condition without loss of generality ( see appendix [ subsec : choice - of - initial ] )    the above system ( [ eq : z0],[eq : zk ] ) can be solved@xcite exactly . in the laplace space",
    "where @xmath95 , the solution is particularly simple , @xmath96 where @xmath97 . by taking the inverse laplace",
    "transform the exact solution of @xmath98 can be found as a combination of modified bessel functions@xcite . in this article , we are mostly concerned with the large time limit , which can be deduced from the expansion of @xmath99 around @xmath100 : @xmath101 where @xmath102 .",
    "the above approximation is valid for @xmath103 ; a uniform large time approximation for all @xmath104 can also be found in terms of combinations of @xmath105 functions@xcite , but is not needed here .",
    "as @xmath106 and @xmath75 , eq.([eq : bt ] ) implies that    @xmath107 the front therefore reaches a finite width @xmath108 and the equilibrium value is reached as @xmath109 .",
    "figure [ fig : frontwidth]a shows the perfect agreement of these results with numerical simulations .",
    "the above equilibrium value of the width is also in agreement with the value found from the sfkpp equation@xcite @xmath110 if the amplitude of the noise term is interpreted as @xmath111 . as noted by hallatschek and korolev@xcite , genetic drift alone",
    "can maintain a finite front width at @xmath14 in one dimension .",
    "moreover , numerical simulations of the discrete model show that the width distribution probability of the front has an exponential tail ( figure [ fig : frontwidth]b )    ) computed from numerical simulations of the master equation ( [ eq : masterequation ] ) by a gillespie algorithm comprising @xmath112 sites ( islands ) for four sets of parameters @xmath113 : black circles @xmath114 ( @xmath115 ) ; green squares @xmath116 ( @xmath117 ) ; red diamonds @xmath118 ( @xmath119 ) ; blue triangles @xmath120 ( @xmath121 ) .",
    "( a ) average front @xmath69 computed over @xmath122 stochastically generated @xmath63 , for @xmath123 $ ] .",
    "dotted black curves : numerical simulations ; solid red curves : theoretical prediction @xmath124 ( eq[eq : znt ] ) .",
    "( b ) probability distribution of the width @xmath125 after equilibrium has been reached ( @xmath126\\times10^{5}$ ] , sampling time@xmath127 ) for the same parameters as in panel a. symbols : numerical simulations ; solid curves : exponential fits of the data @xmath128 after the peak of the distribution has been reached[fig : frontwidth ] ]    note that the width @xmath125 defined above as @xmath129 weights the regions with populations @xmath130 , but contains no information about their spatial distribution . a spatially wide front",
    "composed for example of alternating @xmath131 and @xmath132 islands will have @xmath133 .",
    "the shape of the front can be characterized more precisely by using the moving frame of the front as the reference frame and computing the mean relative mutant number @xmath134 and their weight @xmath135 in this frame @xmath136}\\right\\rangle \\label{eq : nui}\\\\ \\beta_{i } & = & \\nu_{i}(1-\\nu_{i})\\label{eq : betai}\\end{aligned}\\ ] ] where @xmath137 $ ] is the integer part of the front displacement given by the relation ( [ eq : displacement ] ) .",
    "these quantities are difficult analytically but are readily computed by numerical simulation , as shown in figure [ fig : mean - front - shape ] . as it can be observed , the mean front shape @xmath135 , which is a function of @xmath17 and @xmath19 ( figure [ fig : mean - front - shape]a ) is spatially extended and decreases slowly as a function of @xmath21 , the distance to the center of the front ( fig .",
    "[ fig : mean - front - shape]c ) .",
    "the width @xmath138 computed above remains however a good indicator of the mean front shape , and all @xmath135 curves can be superimposed when the normalized index @xmath139 is used(fig .",
    "[ fig : mean - front - shape]b ) .",
    "[ eq : betai ] ) as a function of distance to the center of the front @xmath21 , in the moving reference frame .",
    "numerical simulations schemes are the same as in figure [ fig : frontwidth ] , with @xmath140 .",
    "[ fig : mean - front - shape ] in each sampled stochastic realization , the displacement is computed from the relation ( [ eq : displacement ] ) and the mutant population numbers in each site @xmath21 in a window of 1000 - 2000 sites around _ this _ position are recorded .",
    "the mean front shape @xmath134 ( eq.[eq : nui ] ) is computed on approximately @xmath141 samples .",
    "( a ) @xmath135 as a function of @xmath21 for various @xmath142 ) parameters : @xmath114 black , @xmath116 green , @xmath118 red , ( 40,0.2 ) blue .",
    "( b ) same as in panel ( a ) , but the @xmath143 axis for each curved is normalized by the corresponding equilibrium width @xmath144 .",
    "( c ) the long tail of the front @xmath135 ( solid curves ) , where the parameters are the same as in panel ( a ) . the dashed lines represent the function @xmath145 as visual guides . ]    the variance of the position of the front @xmath146 can be extracted by similar methods from equation ( [ eq : vartiancedef ] ) : @xmath147 as @xmath98 can be computed exactly , the temporal evolution of the variance can also be computed exactly .",
    "the result is particularly simple for large times @xmath148 @xmath149 the surprising result is that for large times , the diffusion of the front is _ independent _ of its width .",
    "the figure [ fig : variance ] shows the agreement of this expression with numerical solutions .    ) by a gillespie algorithm , for various values of the migration parameter @xmath19=0.05,0.1,0.15,0.25 and @xmath150 .",
    "dashed lines : the theoretical values of @xmath76 ( eq . [ eq : variance ] ) for corresponding @xmath19 . the numerical simulations comprised @xmath112 sites and the variance was computed over @xmath151 stochastically generated @xmath62 , for @xmath123$].[fig : variance ] ]      for a non - zero excess relative fitness , the moment closure does not hold and the front characteristics can no longer be derived exactly .",
    "it is however possible to derive the front speed to the first order of the perturbation @xmath16 .    for @xmath152 the position of the front",
    "is given by @xmath153 at small selection pressures @xmath74 , on expanding the above expression to the first order of perturbation , we find , in the limit of large time @xmath154 note that at small @xmath16 , the front speed scales as the selection _ pressure _ @xmath155 . even for @xmath82",
    "when the front width @xmath156 , the front acquires a non - zero speed ( figure [ fig : speed - s ] ) .",
    "the above computation of the position of the front at @xmath152 , which is a first order moment , requires the knowledge of second order moments @xmath157 at @xmath14 .",
    "the same line of argument shows that computing the variance of the position and width of the front for @xmath152 , which are second order moments , necessitates the computation of third order statistical quantities .",
    "even though computation of higher momenta is theoretically possible in the neutral case @xmath14 , their effective computation remains extremely tedious .",
    "figure [ fig : speed - s ] shows the result of stochastic based numerical simulations for a wide range of @xmath16 and the agreement with expression ( [ eq : dudt ] ) at small selection pressure .",
    "it can be observed that the mean field approximation becomes correct only at very high excess relative fitness @xmath16 and local population size @xmath17 .",
    "fluctuations modify significantly the prediction of the fkpp model .",
    "( panel ( a ) ) and width @xmath125 ( panel b ) of the front as a function of excess relative fitness @xmath16 for @xmath158 and @xmath150 , @xmath159,@xmath160 , and @xmath161 .",
    "solid lines in panel ( a ) represent the first order theoretical expression @xmath162 for @xmath163 . dashed green lines represent the mean field values @xmath164 and @xmath165 .",
    "[ fig : speed - s ] ]",
    "in the sfkpp description of the mutant wave ( eq.[eq : fkpp ] ) the diffusion coefficient @xmath5 and the amplitude of the noise @xmath7 are considered independent parameters .",
    "the same is true for the island model of the preceding section where the population size of the island @xmath17 and the migration probability @xmath19 between neighboring islands were considered independent .",
    "however , at the individual level of evolution , both migration and genetic drift are the result of the same phenomenon of individuals replacing each other .",
    "these two parameters must therefore be linked through an einstein - like relation and can not be independent .",
    "there is a level of arbitrariness in the island model in the manner in which individuals are grouped together and _ _ deme size @xmath17 is chosen . as the amount of fluctuations",
    "is critically controlled by @xmath17 , the grouping process is crucial .",
    "this arbitrariness also impacts on the migration probability .",
    "the very existence of a unique migration rate between nearest neighbor islands can be brought into question .",
    "consider for example the low migration limit ( @xmath93 ) of the island model : two individuals physically far apart from each other but grouped into the same island will have a higher probability of replacing each other than two close individuals belonging to neighboring islands",
    ".     dies , it is replaced by the progeny of its @xmath166th neighbor with probability @xmath167 .",
    "( b ) individuals are grouped into demes of population size @xmath168 . in the classical scheme of sfkpp ( figure [ fig : moranspace ] ) ,",
    "the detailed migration kernel @xmath167 is replaced by a single number @xmath169 of migration between neighboring demes .",
    "[ fig : population_continuous ] ]    a more rigorous approach to this problem would be to consider a `` microscopic '' model where individuals are uniformly distributed in space and not arbitrarily grouped into demes / islands . in this microscopic model ,",
    "migration / replacement is not restricted to nearest neighbors ( figure [ fig : population_continuous]a ) : when an individual dies at site @xmath21 , it has a probability @xmath170 of being replaced by the progeny of an individual at site @xmath171 .",
    "solving exactly this strictly individual model then leads us to choose the _ effective _ population size of each deme , which is used in the stepping stone approach ( figure [ fig : population_continuous]b ) and derive the exact relation between the diffusion coefficient and the noise amplitude , both of which are a function of the dispersal kernel @xmath170 .    in this evolutionary graph approach ,",
    "each site contains exactly one individual ( either wild type or mutant ) @xmath172 ; the transition probability densities for the number of mutants on site @xmath21 to increase / decrease by one individual is a simple generalization of equations ( [ eq : rateup],[eq : ratedown ] ) .",
    "thus : @xmath173 where @xmath170 is the probability that the progeny of an individual at site @xmath171 replaces an individual at site @xmath21 . in the literature of plants ,",
    "the migration probability @xmath170 is known as the dispersal kernel and can be measured precisely in the field@xcite . in the following",
    ", we will consider dispersal kernels that depend only on the distance between two sites , @xmath174 , @xmath175 .",
    "following the same steps as in subsection [ subsec : mean - field - approximation . ] , it is straightforward to deduce the mean field approximation of the corresponding master equation . for a migration probability that depends only on the distance between two sites ,",
    "the mean field approximation is exactly the same as expression ( [ eq : meanfield ] ) , where @xmath44 here is the inter - individual distance ( lattice size ) , @xmath25 the death rate and the diffusion coefficient @xmath176 is given in terms of mean dispersal distance .    from now on and to avoid confusion , we will refer to all quantities derived in the island approximation ( the macroscopic view ) of section [ sec : the-1d - system ] by the super script @xmath177 .",
    "the diffusion coefficient of the mean field approximation derived in subsection [ subsec : mean - field - approximation . ]",
    "( relation [ eq : meanfield ] ) , for example , is @xmath178 for a 1d system , the patch extension @xmath179 ( figure [ fig : population_continuous]b ) ; comparing expression ( [ eq : d_contpop ] ) and ( [ eq : dstar ] ) therefore leads to @xmath180 we observe here that the deme size @xmath168 and the migration probability between demes @xmath169 are indeed linked through equation ( [ eq : n*-m*-relation ] ) .",
    "the relation ( [ eq : n*-m*-relation ] ) is not sufficient to determine the _ effective _ population size @xmath168 of islands . to address this issue , we need to solve exactly the full stochastic model .",
    "we restrict the computation here to the neutral case @xmath14 , the derivations for @xmath181 following precisely the steps developed previously .",
    "the computational approach is similar to subsection [ subsec : stochastic - characterization ] .",
    "as before , the displacement of the front is defined as @xmath182\\label{eq : displacement - microscopic}\\ ] ] and @xmath183 therefore , for the neutral front @xmath14 , @xmath184 and @xmath75 .",
    "the second order moments are also defined as before @xmath185 and we note that @xmath186 the equations governing @xmath187 for the rescaled time @xmath84 are @xmath188 where the @xmath89 are defined by the initial condition @xmath189 note that equation ( [ eq : dz0-b ] ) implies that @xmath190 this is due to the fact that @xmath191 and therefore @xmath192 .    for an initially sharp front @xmath193 which will be used here , @xmath194    for simplicity ,",
    "we further restrict the solution of equations ( [ eq : dz0-b]-[eq : dzp - b ] ) to the generic geometric dispersal kernel @xmath195 where the parameter @xmath196 controls the dispersal length @xmath197 : @xmath198 the case @xmath199 , @xmath200 of the preceding section is obtained when @xmath201 .",
    "note that in the framework of the moran model used here , a dead individual can not replace itself , hence @xmath202 .",
    "moreover , for the geometric dispersal kernel , relation ( [ eq : cp ] ) becomes @xmath203 it is straightforward to check that again all @xmath187 converge as @xmath204 to the same value @xmath205 where @xmath206 is defined in ( [ eq : kappa2 ] ) and @xmath207@xmath208 .",
    "we observe that the stationary value of @xmath209 is given by a quantity similar to the variance of the dispersal kernel .",
    "figure [ fig : zp ] shows the agreement between these results and individual based numerical simulation of the same system .",
    "[ eq : zp - b ] ) in the neutral moran model with geometric seed dispersal kernel ( eq . [ eq : dispersal - kernel ] ) for @xmath210 .",
    "( inset ) same data but convergence to the limiting value @xmath211 is shown ; the gray dashed line is @xmath204 .",
    "time is measured in units of generation time ( @xmath212 . for the numerical simulation , a lattice of 4096 individuals is used and the result is averaged over @xmath213 trials .",
    "[ fig : zp ] ]    the width of the front can no longer be measured as in relation ( [ eq : width ] ) by @xmath214 which is always @xmath65 .",
    "other analog metrics such as @xmath215 can be used to characterize the front .",
    "it is straightforward to show that @xmath216 figure [ fig : y1 ] shows the excellent agreement between the theoretical results and the numerical simulations .",
    "( eq . [ eq : yp ] ) in the neutral moran model with geometric seed dispersal kernel ( eq . [ eq : dispersal - kernel ] ) for increasing value of @xmath2170.25,0.33,0.4,0.5,0.55,0.6,0.66 and 0.75 .",
    "( b ) same data but convergence to the limiting value @xmath218 is shown ; the gray dashed line is @xmath204 .",
    "time is measured in units of generation time ( @xmath212 . the numerical simulation parameters are identical to figure [ fig : zp ] . [ fig : y1 ] ]    the variance of the front displacement @xmath219 can be computed by methods analogous to the previous section : @xmath220 where the @xmath221 are the transition rates ( [ eq : rateupgen],[eq : ratedowngen ] ) and @xmath222 is defined by relation [ eq : cp ] ) . for the geometric kernel @xmath167 ( eq . [ eq : dispersal - kernel ] ) , using the long term solution ( [ eq : zp - mk ] ) leads to @xmath223      we now group individuals virtually into islands of size @xmath168 and establish the condition under which the results obtained by the sfkpp / islands model are valid .",
    "a patch of population size @xmath168 is a virtual packing of individuals into a deme , which we refer to by its index @xmath224 ( figure [ fig : population_continuous]b ) .",
    "the number of mutants in patch @xmath224 is @xmath225 where @xmath226 and @xmath227 .",
    "note that we have @xmath168 possible choices for grouping individuals , as we can set @xmath228 , where @xmath229 , 1 , ... , @xmath230 .",
    "we define the displacement and the width of the ( macroscopic ) front as in subsection [ subsec : stochastic - characterization ] ( definitions [ eq : displacement],[eq : width ] ) @xmath231\\label{eq : displacement - group}\\\\ b^{\\star}(t ) & = & \\frac{1}{n^{\\star2}}\\sum_{q=-\\infty}^{+\\infty}n_{q}^{\\star}(t)\\left[n^{\\star}-n_{q}^{\\star}(t)\\right]\\label{eq : width - group}\\end{aligned}\\ ] ] we compute the statistical properties of these quantities by taking into account the detailed migration kernel ( subsection [ subsec : group ] ) and compare them to the results obtained in subsection [ subsec : stochastic - characterization ] where migrations were approximated by a single migration probability @xmath169 between neighboring demes .    the macroscopic displacement @xmath232 ( relation [ eq : displacement - group ] ) is easily related to the microscopic displacement @xmath233 ( relation [ eq : displacement - microscopic ] ) : @xmath234\\\\   & = & \\frac{1}{n^{\\star}}\\sum_{i=-\\infty}^{\\infty}\\left[n_{i}(t)-n_{i}(0)\\right]\\\\   & = & \\frac{1}{n^{\\star}}u\\end{aligned}\\ ] ] and therefore @xmath235 .",
    "the variance of the microscopic displacement @xmath236 is given by relation ( [ eq : var - mk ] ) , and hence , for long times , @xmath237 comparing this expression to the relation @xmath238 of the island model ( section [ sec : the-1d - system ] ) where @xmath169 is the migration probability between demes , we see that we must have @xmath239 the above relation is a confirmation of relation ( [ eq : n*-m*-relation ] ) , which we obtained by a mean field approximation .",
    "we can also compute , at small selection pressure @xmath155 , the speed of the front that we find to be @xmath240 . comparing this result to the speed @xmath241",
    "( eq . [ eq : dudt ] ) of the island model leads again to the same relation between @xmath169 and @xmath168 as relation ( [ eq : mstar ] ) .",
    "the macroscopic width of the front ( relation [ eq : width - group ] ) can also be computed in terms of microscopic quantities ( see appendix [ subsec : relation - between - microscopic ] ) @xmath242 where @xmath243 are the microscopic front width ( defined by relation [ eq : yp ] ) . for large times , relations ( [ eq : ypzp ] ) and ( [ eq : zp - mk ] ) lead to @xmath244\\label{eq : b*}\\ ] ] the above relation is in perfect agreement with numerical simulations . comparing the above relation to the width of the front @xmath245 of the island model ( relation [ eq : beq ] ) and using relation ( [ eq : mstar ] ) for @xmath169 , we find that we must have @xmath246 the above result determines the effective population size in terms of the dispersal kernel .",
    "more precisely , @xmath247 we note that @xmath169 is weakly dependent on @xmath196 over its whole range of variation [ 0 , 1 ] , whereas @xmath168 diverges as the dispersion characteristic length when @xmath248 .",
    "in this article , we have used the formalism of the spatial moran model to study the propagation of mutants in a one dimensional geographically extended population .",
    "the propagation of the mutant wave has usually been studied in the framework of the sfkpp equation ( [ eq : fkpp ] ) .",
    "the sfkpp equation however is a phenomenological approach and its derivation from the fundamental models of population genetics such as wright - fisher or moran is not obvious .",
    "the deterministic fisher equation for the dynamics of the proportion @xmath249 of a mutant in a non - structured population is @xmath250 . for geographically structured populations",
    ", it seemed natural@xcite to add a spatial diffusion term and generalize simply this equation to @xmath251 , where @xmath4 is the _ local _ proportion of the mutant . on the other hand , since the time of fisher and wright , it was obvious that genetic drift is an important factor at small selection pressure . for _ large _ non - structured ( @xmath252 populations , kimura tackled this problem by using a fokker - planck approximation of the master equations governing the wf or moran models .",
    "the stochastic differential equation associated with the kimura equation is @xmath253 .",
    "it then seemed natural to unite the two approaches and propose the sfkpp equation ( [ eq : fkpp ] ) .",
    "we see here that many assumptions were made in this process : ( i ) the form of the diffusion term may be different ; ( ii ) @xmath4 is a local relative density and the noise term of sfkpp would be a good approximation only if the number of individuals in each patch where @xmath59 has been computed is large enough ; ( iii ) the noise term @xmath254 itself was obtained for a non - structured population and it is far from obvious that it should be the same for an extended population and not involve the spatial derivative of @xmath59 .",
    "the individual based approached that we develop in this article is intended to overcome these problems and to ground the sfkpp approach on a firmer basis .",
    "using an explicit spatial island model , we have shown first that the diffusion term is indeed different from the fkpp equation ( relation [ eq : meanfield ] ) and this difference has important consequences on the speed and width of the front for large selection pressures ( relation [ eq : speed_meanfield],[eq : meanfield - width ] ) .    for small selection pressures , we derive the parameters of the front ( speed , diffusion coefficient and width ) without any assumption on the size of the local population and without neglecting the non - local noise .",
    "these results are in agreement with the predictions of sfkpp equation at small selection pressure as developed by @xcite .    finally , by taking into account the explicit migration kernel",
    ", we establish the relation between the amplitude of the diffusion and that of the noise ; this approach also allows us to define the effective size of the local population @xmath17 , which is the crucial parameter controlling the noise as a function of the dispersal length .",
    "individual based models have the same level of complexity as their equivalent stochastic differential equation approach .",
    "we believe that the formalism developed in this article is a step forward in the search for a better understanding of natural populations and the dynamics of mutant waves .",
    "we are grateful to erik geissler for the critical reading of the manuscript and fruitful discussions .",
    "the argument for the phenomenological noise term used by doering et al .",
    "can be rephrased as follows in the framework of population genetics . for a non - structured population ( a population at @xmath252 , in an ecosystem with carrying capacity of @xmath17 individuals formed of wild type individuals with fitness @xmath1 and mutants with fitness @xmath0 ,",
    "the transition rates for the one - step moran process is @xcite @xmath255 where @xmath256 is the number of mutants .",
    "the probability @xmath257 of observing @xmath256 mutants at time @xmath32 is governed by the master equation associated with these rates @xmath258 for a _ large _ ecosystem ( @xmath259 ) at small selection pressure @xmath260 ) , the above master equation can be approximated by a fokker - plank equation called the kimura equation@xcite @xmath261}{\\partial u}+\\frac{1}{n}\\frac{\\partial^{2}\\left[u(1-u)p\\right]}{\\partial u^{2}}\\ ] ] where @xmath262 and time is measured in units of @xmath263 .",
    "the above diffusion equation is equivalent to a stochastic differential equation for the density @xmath59@xcite : @xmath264 the origin of the noise is the genetic drift due to the size of the system .    for a spatially extended system , the doering et al .",
    "phenomenological approach to derive the sfkpp consists in adding a ( spatial ) diffusion term @xmath265 to the stochastic equation [ eq : stodif-1 ] , but conserving the same _ local _ noise term , and neglecting fluctuations from adjacent cells .",
    "the rules of moment computations are fairly standard ( see for example @xcite ) , but we give them here for self - consistency .",
    "various moments can be extracted directly from the master equation @xmath266 by multiplying it by some operator and then making the change of variable @xmath267 or @xmath268 .",
    "consider for example @xmath269 after replacing @xmath270 by its value from equation [ eq : master ] , the first term on the r.h.s .",
    "of the above equation reads : @xmath271 changing the variable @xmath272 implies @xmath273 and @xmath274and @xmath275 computing now the second term and grouping all the terms , we get @xmath276 for the neutral case @xmath14 we have @xmath277 and @xmath278 so finally @xmath279    [ [ front-speed-and-width-in-the-mean-field-approximation.subsecmeanfieldspeed ] ] front speed and width in the mean field approximation.[subsec : meanfieldspeed ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    the minimum speed of propagating front of the equation @xmath43\\frac{\\partial^{2}u}{\\partial x^{2}}+\\mu su(1-u)\\label{eq : meanfield2}\\ ] ] is obtained by following the original fisher@xcite approach . for a propagating front , on setting @xmath280 and then setting @xmath281",
    ", we get the equation for @xmath282 : @xmath283g\\frac{dg}{du}-vg+\\mu su(1-u)=0.\\label{eq : gu}\\ ] ] setting @xmath284 as the slope of the curve at the origin @xmath10 , the equation for @xmath104 is @xmath285 which has a solution only for @xmath286    the width @xmath287 of the front can be computed following the same approach . setting @xmath288 , exchanging the derivation on @xmath32 and integration on @xmath143 , and performing integration by parts on the propagating front , we get @xmath289 the shape of the front @xmath282 is not known .",
    "however , @xmath282 is a smooth function , @xmath290 and its slope at both ends , @xmath284 and @xmath291 are known and determined from equation ( [ eq : gu ] ) .",
    "approximating then @xmath282 by a third order polynomial that respects these constraints @xmath292 leads to : @xmath293 where @xmath294      the definition of various moments we use in this article such as relations ( [ eq : displacement]-[eq : zp ] ) ensures that the infinite sums over sites contain only a finite number of non - zero terms ; it avoids the problem of spurious effects due to manipulation of divergent series . however",
    ", the initial front may not need to be sharp , but only finite .",
    "consider the discrete function @xmath295 where the position @xmath65 corresponds the to middle of the initial front .",
    "we can redefine the moments as @xmath296 the differential equations we derived throughout this article remain invariant under this definition of the moments , the only difference being that the initial values of these moments are non - zero .",
    "[ [ relation-between-microscopic-and-macroscopic-front-width.subsecrelation-between-microscopic ] ] relation between microscopic and macroscopic front width.[subsec : relation - between - microscopic ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    by definition , @xmath297 where @xmath298is defined by relation ( [ eq : n * ] ) , @xmath226 and @xmath227 .",
    "note that we have @xmath168 possible choices for grouping individuals , as we can set @xmath228 , where @xmath229 , 1 , ... , @xmath230 . as @xmath299 the first term in the above sum is zero and @xmath191 . rearranging the indices in the second term , we have @xmath300    note that for an unrestricted sum @xmath301 however , the problem with expression ( [ eq : seq ] ) is that we are missing the terms @xmath302 , where @xmath21 is in one cell and @xmath303 in another one .",
    "in fact , for each cell , we are missing @xmath304 terms of the form @xmath302 connecting two neighboring cells .",
    "we now use our freedom to choose the grouping @xmath305 : we use @xmath168 different choices of @xmath305 and sum all of them .",
    "a term missing in one choice of @xmath305 will be recovered in another . as the result",
    "must not depend on the choice of @xmath305 , we have @xmath306 the index manipulation is clearer when performed manually on a few simple examples such as @xmath307 or 3 .",
    "all numerical simulations are written in c++ , and data analysis is performed by the high level language julia@xcite .",
    "numerical simulation of the island model ( section [ sec : the-1d - system ] ) is performed by a gillespie algorithm by computing the jump probabilities from the transition rates ( [ eq : rateup],[eq : ratedown ] ) . for the generalized migration kernel of section [ sec : microscopic model . ] , the gillespie approach is too cumbersome and a direct approach has been used : the index of an individual is chosen at random and it is replaced by the value of another individual chosen according to the kernel @xmath167 ."
  ],
  "abstract_text": [
    "<S> the propagation of a beneficial mutation in a spatially extended population is usually studied using the phenomenological stochastic fisher - kolmogorov ( sfkpp ) equation . </S>",
    "<S> we derive here an individual based , stochastic model founded on the spatial moran process where fluctuations are treated exactly . at high selection pressure , </S>",
    "<S> the results of this model are different from the classical fkpp . at small selection pressure </S>",
    "<S> , the front behavior can be mapped into a brownian motion with drift , the properties of which can be derived from microscopic parameters of the moran model . </S>",
    "<S> finally , we show that the diffusion coefficient and the noise amplitude of sfkpp are not independent parameters but are both determined by the dispersal kernel of individuals . </S>"
  ]
}