{
  "article_text": [
    "given two metric spaces @xmath0 , @xmath1 , and a mapping @xmath2 , we denote the lipschitz constant of @xmath3 by @xmath4 .",
    "if @xmath3 is injective then the ( bi - lipschitz ) distortion of @xmath3 is defined as @xmath5 . the smallest distortion with which @xmath6 embeds into @xmath7",
    "is denoted @xmath8 , i.e. @xmath9 .",
    "when @xmath10 for some @xmath11 we use the shorter notation @xmath12 .",
    "the parameter @xmath13 is known in the literature as the euclidean distortion of @xmath6 .",
    "the ubiquitous problem of embedding metric spaces into  simpler \" spaces occurs in various aspects of functional analysis , riemannian geometry , group theory , and computer science . in most cases low distortion embeddings",
    "are used to  simplify \" a geometric object by representing it as a subset of a better understood geometry . in other cases ,",
    "embeddings are used to characterize important invariants such as various notions of dimensionality in metric spaces , and superreflexivity , type and cotype of normed spaces .",
    "more recently , striking applications of bi - lipschitz embeddings were found in computer science , where the information obtained from concrete geometric representations of finite spaces is used to design efficient approximation algorithms and data structures .",
    "the present paper is devoted to the study of the euclidean ( and @xmath14 ) distortion of trees . in what follows by a _",
    "metric tree _ we mean the shortest path metric induced on the vertices of a weighted graph - theoretical tree @xmath15 . in fact , all of our results will hold true for arbitrary subsets of metric trees , which are characterized among all metric spaces by the well known four point condition : for every four points @xmath16 two of the three numbers @xmath17 are the same , and that number is at least as large as the third ( see  @xcite ) .",
    "but , because our statements are asymptotic in nature , this does not increase the generality of our results , since gupta @xcite proved that any finite subset of a metric tree is bi - lipschitz equivalent to a metric tree with distortion at most @xmath18 .",
    "the @xmath19-tree corresponding to a tree @xmath20 is the one - dimensional simplicial complex induced by @xmath20 , i.e. the path metric obtained by replacing each edge in @xmath20 by an interval whose length is the weight of the edge .",
    "the @xmath19-tree corresponding to @xmath20 will be denoted @xmath21 . in what follows , when we refer to an @xmath19-tree we mean an @xmath19-tree corresponding to some metric tree .",
    "we will see later that for every metric tree @xmath20 and every @xmath11 , @xmath22 has the same order of magnitude as @xmath23 , so in most cases the distinction between metric trees and @xmath19-trees will not be important , though in a few instances we will need to distinguish the two notions .",
    "let @xmath24 denote the complete binary tree of depth @xmath25 ( with unit edge weights )",
    ". in a famous paper  @xcite bourgain proved that the euclidean distortion of @xmath24 is @xmath26 .",
    "moreover , he showed that a banach space @xmath7 is superreflexive ( i.e. admits an equivalent uniformly convex norm ) if and only if @xmath27 .",
    "this remarkable characterization of a linear property of banach spaces in terms of their metric structure sparked a considerable amount of work on problems of a similar flavor ( see the introduction of  @xcite for more information on this topic ) . among the corollaries of bourgain s work",
    "is the following dichotomy : for a banach space @xmath7 either @xmath28 for all @xmath25 , or there exists @xmath29 such that @xmath30 ( similar phenomena are known to hold in a few other cases  see  @xcite ) .",
    "moreover , bourgain used his theorem to solve a question posed by gromov , showing that the hyperbolic plane does not admit a bi - lipschitz embedding into hilbert space .",
    "similar applications of bourgain s theorem to prove that certain metric spaces do not embed into hilbert space were obtained by benjamini and schramm  @xcite in the case of graphs with positive cheeger constant , and by leuzinger  @xcite in the case of certain tits buildings .",
    "the bi - lipschitz structure of trees has been studied extensively .",
    "trees are the  building blocks \" of hyperbolic geometry , and embeddings of certain non - positively curved spaces into products of trees are used in several contexts ( see for example  @xcite ) .",
    "similar results ( known as  probabilistic embeddings into trees \" ) are a powerful tool in computer science ( see for example  @xcite ) .",
    "we refer to  @xcite for other results on the lipschitz structure of trees . in spite of these applications , and",
    "the vast amount of work on trees in the lipschitz category , the following natural problem remained open : when does an infinite metric tree embed with finite distortion into hilbert space ?",
    "one of the main results of this paper is the following answer to this question .",
    "[ thm : local ] let @xmath15 be an infinite metric tree",
    ". then the following conditions are equivalent .",
    "1 .   @xmath31 .",
    "2 .   @xmath32 .",
    "3 .   for every @xmath33 , @xmath34 .    in other words ,",
    "a metric tree admits a bi - lipschitz embedding into hilbert space if and only if it does not bi - lipschitzly contain arbitrarily large complete binary trees .",
    "thus there is a unique obstruction to a tree being non - euclidean .",
    "unique obstruction \" results are known only in very few cases : as we mentioned above , bourgain  @xcite proved that complete binary trees are the unique obstruction to a banach space being superreflexive ; bourgain , milman and wolfson  @xcite showed that hamming cubes are the unique obstruction to a metric space having non - trivial type ; mendel and naor  @xcite showed that @xmath35 integer grids are the unique obstruction to a metric space having finite cotype ; thomassen  @xcite proved that certain transient graphs must contain transient trees , and benjamini and schramm  @xcite proved that a graph with positive cheeger constant must contain a tree with positive cheeger constant .",
    "another result in the spirit of theorem  [ thm : local ] is the tree szemeredi theorem of furstenberg and weiss  @xcite : a subset of positive density in the infinite complete binary tree must contain arbitrarily large copies of complete binary trees .",
    "it is not surprising that the theorem  [ thm : local ] is a  local \" result , in the sense that it deals with finite subsets of the metric tree @xmath20 .",
    "indeed , it is well known that a metric space embeds into hilbert space if and only if all of its finite subsets do .",
    "it is thus natural to expect characterizations in the spirit of theorem  [ thm : local ] to be local .",
    "let us say that a metric space @xmath6 is _ finitely representable in a metric space @xmath7 _ if there exists a constant @xmath36 such that for every finite subset @xmath37 we have @xmath38 ( this is an obvious adaptation of standard terminology from banach space theory ) .",
    "thus , denoting by @xmath39 the infinite unweighted complete binary tree , theorem  [ thm : local ] can be rephrased as follows : a metric tree @xmath20 admits a bi - lipschitz embedding into hilbert space if and only if @xmath39 is not finitely representable in @xmath20 .",
    "the following section contains optimal quantitative versions of this result , and explains the ingredients of its proof .",
    "quantitative bounds on the euclidean distortion of trees were obtained in  @xcite . in particular , matouek proved in  @xcite that for any @xmath40-point metric tree @xmath20 we have @xmath41 .",
    "this result can not be improved due to bourgain s lower bound for the complete binary tree .",
    "gupta , krauthgamer and lee @xcite obtained upper bounds on the euclidean distortion of trees in terms of their doubling constant ; in particular , they showed that every doubling tree admits a bi - lipschitz embedding into a finite - dimensional euclidean space .",
    "we present a new simpler proof of this fact in section [ sec : doubling ] , where we also recall the definition of the doubling constant .",
    "we shall now state an optimal quantitative version of theorem  [ thm : local ] . given a metric space @xmath0 , @xmath42 and @xmath43 ,",
    "we denote @xmath44 in what follows we write @xmath45 to mean @xmath46 . if @xmath47 and @xmath48 then we write @xmath49 .",
    "[ thm : quantitative - local ] let @xmath20 be an arbitrary metric tree . then for every @xmath43 , @xmath50    the lower bound in theorem  [ thm : quantitative - local ] is simply bourgain s lower bound , and is therefore optimal . somewhat surprisingly , the upper bound in theorem  [ thm : quantitative - local ] can not be improved .",
    "the construction of a family of trees exhibiting this , which we call the cantor trees , is presented in section  [ sec : cantor ] .",
    "it follows that in order to obtain tight bounds on the euclidean distortion of a given metric tree @xmath20 we need an invariant which is more refined than the size of the biggest binary tree contained in @xmath20 .",
    "this is achieved via the following definition .",
    "let @xmath51 be a markov chain on a state space @xmath52 .",
    "given an integer @xmath53 we denote by @xmath54 the process which equals @xmath55 for time @xmath56 , and evolves independently ( with respect to the same transition probabilities ) for time @xmath57 .",
    "observe that for @xmath58 , @xmath59 and @xmath55 evolve independently for all @xmath60 .",
    "[ def : markov ] let @xmath61 be a metric space and @xmath62 .",
    "we shall say that @xmath61 is _",
    "markov @xmath63-convex _ with constant @xmath64 if for every markov chain @xmath51 on a state space @xmath52 , and every @xmath65 , we have for every @xmath66 , @xmath67}{2^{kp } } \\le \\pi^p \\sum_{t=1}^{2^m}{\\mathbb e}[d(f(x_t),f(x_{t-1}))^p].\\end{aligned}\\ ] ] the least constant @xmath64 above is called the markov @xmath63-convexity constant of @xmath6 , and is denoted @xmath68 .",
    "we shall say that @xmath6 is markov @xmath63-convex if @xmath69 .    to understand this notion , recall that the chains @xmath70 and @xmath71 run together for the first @xmath72 steps , and then evolve independently for the remaining @xmath73 steps .",
    "thus the left hand side in   is measuring the sum , over many `` dyadic scales '' @xmath74 of the average of the @xmath63th power of the normalized `` drift '' of the chain in @xmath6 with respect to scale @xmath25 .",
    "we will say that @xmath6 has _ non - trivial markov convexity _ if @xmath6 is markov @xmath63-convex for some @xmath75 .",
    "we note that @xmath76 is markov @xmath77-convex .",
    "more generally , the name comes from the fact that if @xmath6 is a banach space which admits an equivalent uniformly convex norm whose modulus of convexity is of power type @xmath63 , then @xmath6 is also markov @xmath63-convex .",
    "these results are proved in section  [ sec : banach ] .    in bourgain",
    "s paper @xcite there is an implicit `` non - linear '' notion of uniform convexity related to the presence of complete binary trees .",
    "for the results in this paper , we require the above `` markov variant , '' analogous to ball s notion of markov type  @xcite .",
    "the search for poincar - type inequalities on metric spaces which are analogs of classical banach space invariants have been fruitfully investigated by several authors  we refer to the papers  @xcite for a discussion of this research direction , to which definition  [ def : markov ] belongs .",
    "the following theorem shows that markov convexity determines the euclidean distortion of a tree , up to universal factors .",
    "[ thm : formula ] let @xmath20 be a metric tree",
    ". then @xmath78 .",
    "recall that @xmath21 denotes the @xmath19-tree corresponding to @xmath20 .",
    "see remark [ rem : rtree ] for a discussion of why we have to pass to @xmath79-trees in theorem  [ thm : formula ] .",
    "we also obtain a combinatorial way to compute the euclidean distortion of any tree .",
    "let @xmath15 be a metric tree , and let @xmath80 be an edge coloring .",
    "we call @xmath81 a monotone coloring if all of its color classes are paths contained in a root - leaf path ( such paths are called monotone paths in what follows ) . for @xmath82 , the coloring @xmath81 is called @xmath83-strong",
    "if it is monotone and for every @xmath84 at least half of the length of the path joining @xmath85 and @xmath86 can be covered by color classes of length at least @xmath87 .",
    "we define @xmath88 to be the largest @xmath83 for which @xmath20 admits a @xmath83-strong coloring .",
    "the following theorem shows that @xmath88 determines the euclidean distortion of @xmath20 .",
    "[ thm : star ] let @xmath20 be a metric tree",
    ". then @xmath89    the upper bound on @xmath90 in theorem  [ thm : star ] continues a theme that also appeared in  @xcite : certain edge colorings can be used to construct embeddings into @xmath76 . specifically , our proof draws on ideas from matouek s embedding  @xcite .",
    "but , matouek s argument requires colorings with a small number of colors , the existence of which depends only on the topology of @xmath20 and does not take into account the edge lengths . our argument for the upper bound , which is contained in theorem  [ thm : matousek ] , builds on matouek s proof while taking the metric into consideration , and is therefore more involved .    the lower bound on @xmath90 in theorem  [ thm : star ] goes through theorem  [ thm : formula ]",
    "we construct a special coloring of @xmath20 , and show that if the coloring is not @xmath83-strong , then we can construct a markov chain on @xmath20 which wanders too quickly for @xmath20 to have a small markov 2-convexity constant .",
    "this is done by locating a special type of subtree of @xmath20 , which we call a weak prototype  see section  [ sec : def weak ] for the definition , where it is shown that weak prototypes can not have good markov convexity properties .",
    "this `` reconstruction paradigm '' is inspired by a result of  @xcite which shows that if a certain procedure fails to produce a good coloring , then the tree under consideration must have a large doubling constant .",
    "our approach is able to pick out significantly more delicate sub - structures ( e.g. embedded complete binary trees or the aforementioned `` weak prototypes '' ) .",
    "a key difficulty that arises in our setting involves choosing the  scale \" at which the required weak prototype embeds into @xmath20 .",
    "scale selection \" argument is a central part of our proof of theorem  [ thm : quantitative - local ] , theorem  [ thm : formula ] , and theorem  [ thm : star]we refer to section  [ sec : binary ] and section  [ sec : dist formula ] for the details .",
    "we remark that all of our results can be applied to compute the @xmath14 distortion of trees .",
    "namely , we show that for every @xmath91 and every metric tree @xmath20 , @xmath92 and @xmath93^{\\min\\left\\{\\frac{1}{p},\\frac12\\right\\}},\\end{aligned}\\ ] ] where the implied constants may depend only on @xmath63 ; see theorem  [ thm : markov main ] .    the use of markov convexity as a metric invariant , and thus a tool for proving distortion lower bounds , is not limited to the case of trees . in section  [ sec : lower distortion ] we investigate classes of spaces which can be shown not to embed into @xmath76 by analyzing their markov convexity . in particular , we prove a lower bound on the euclidean distortion of balls of finitely generated groups ( equipped with the word metric ) which admit a bounded non - constant harmonic function .",
    "we also bound from below the euclidean distortion of the lamplighter group over the cycle ( see section  [ sec : lower distortion ] for the definition ) . in a future paper ,",
    "which will be devoted to embeddings of the lamplighter group , we use the methods of  @xcite to show that this group has markov type @xmath77 in the sense of ball  @xcite . thus",
    ", markov convexity is the only known invariant which demonstrates that this group does not well - embed into hilbert space .    our results , specifically theorem  [ thm : star ] , have algorithmic implications . given an @xmath40-point metric space @xmath6 , the problem of efficiently computing its distortion in a class of metric spaces up to a small factor has attracted a lot of attention in recent years , and is known as the  relative embedding \" problem .",
    "we refer to  @xcite and the references therein for a discussion of this topic , and also for some hardness results .",
    "the euclidean distortion of an @xmath40-point metric space can be computed in polynomial time , since this problem can be cast as a semidefinite program  @xcite .",
    "hence theorem  [ thm : star ] yields a polynomial time algorithm for estimating the parameter @xmath94 up to a constant factor for any tree @xmath20 . in conjunction with  , this gives a polynomial time algorithm which computes the @xmath14 distortion of any tree up to a universal constant factor .",
    "note that it not known whether the @xmath14 distortion of a general finite metric space can be approximated efficiently .",
    "we end this introduction by stating some interesting open problems that arise from our work",
    ".    * problem 1 . * in section  [ sec : banach ] we show that every @xmath63-uniformly convex banach space is markov @xmath63-convex .",
    "we also show that if @xmath6 is a banach lattice which is markov @xmath63-convex then it is also @xmath95-uniformly convex for every @xmath96 .",
    "the relation between markov @xmath63-convexity and uniform @xmath63-convexity for general banach spaces is unclear .",
    "* problem 2 . * one corollary of our results is that if a metric tree is not markov @xmath63-convex for any @xmath97 then it contains arbitrarily large complete binary trees with distortion arbitrarily close to @xmath98 .",
    "it is possible that this holds true for arbitrary metric spaces , and not just metric trees .",
    "if this is the case , then it would correspond to known results in banach space theory , and would complement the existing theory of metric type and cotype .",
    "* problem 3 .",
    "* it would be interesting to investigate other",
    " unique obstruction \" results of the type described here .",
    "in particular , can one classify the obstructions to a planar graph being embeddable in @xmath76 ?",
    "another interesting generalization would be to classify the subsets of @xmath99the hyperbolic plane  which embed into @xmath76 ; it seems plausible that complete binary trees are the only obstruction in this case , just as for tree metrics . in a similar vein",
    ", it might be the case that the only subsets of a product of trees which do not admit a bi - lipschitz embedding into @xmath76 are those that contain arbitrarily large bi - lipschitz copies of complete binary trees .",
    "if true , then in combination with the result of  @xcite , this would imply the same result for the hyperbolic plane .",
    "* problem 4 . * in section  [ sec : lower distortion ] we give lower bounds on the euclidean distortion of the lamplighter group over the @xmath40-cycle .",
    "we do not know what is the correct asymptotic behavior of this distortion .",
    "it is also unknown whether or not these groups embed into @xmath100 with uniformly bounded distortion .",
    "the purpose of this section is to prove the following theorem which , when combined with bourgain s lower bound for binary trees  @xcite , implies theorem  [ thm : local ] and theorem  [ thm : quantitative - local ] .    [ thm : upper - binary ] let @xmath20 be an arbitrary metric tree and @xmath11 . then for every @xmath43 , @xmath101    in section  [ sec : cantor ] we will show that the asymptotic dependence on @xmath102 in the upper bound of theorem  [ thm : upper - binary ] can not be improved .",
    "we begin with some definitions and notation .",
    "let @xmath103 be a _",
    "finite _ graph - theoretic tree with positive edge lengths @xmath104 , and let @xmath105 be the induced path metric on @xmath106 .",
    "we also fix some arbitrary root @xmath107 .",
    "a _ monotone path _ in @xmath20 is a connected subset ( also called a _ segment _ in what follows ) of some root - leaf path . by an _ edge - coloring of @xmath20",
    "_ , we mean a map @xmath108 .",
    "we say that the coloring is _ monotone _ if for every @xmath109 the color class @xmath110 is a monotone path .",
    "for @xmath84 we let @xmath111 denote the unique path from @xmath85 to @xmath86 , and set @xmath112 .",
    "given an edge coloring @xmath80 , @xmath113 , and @xmath84 , we write @xmath114 we also set @xmath115 .",
    "finally , given @xmath84 we let @xmath116 denote the _ least common ancestor _ of @xmath85 and @xmath86 in @xmath20 .    [ def : epsilon strong ] we say that a coloring @xmath80 is @xmath117-good if it is monotone , and for every @xmath118 , the unique path from @xmath85 to @xmath86 contains a monochromatic segment of length at least @xmath119 .",
    "we define @xmath120 to be the largest @xmath121 for which @xmath20 admits an @xmath121-good coloring .",
    "the following simple lemma will not be used in the proof of theorem  [ thm : upper - binary ] , but we include it since it illustrates the relation between colorings and embeddings , and it will be used eventually in section [ sec : doubling ] .",
    "[ claim : color ] for every weighted tree @xmath20 and @xmath11 , @xmath122    fix @xmath123 and let @xmath80 be an @xmath121-good coloring .",
    "let @xmath124 be the standard basis of @xmath125 .",
    "define @xmath126 by @xmath127 ( recall that @xmath128 is the distance that the segment colored @xmath25 contributes to the path joining @xmath86 to the root ) .",
    "fix @xmath84 and write @xmath129 . the fact that the coloring @xmath81 is monotone implies that @xmath130 .",
    "thus @xmath131 on the other hand , since @xmath81 is @xmath121-good , there are @xmath132 such that @xmath133 and @xmath134 .",
    "it follows that @xmath135^p+[\\ell_b^\\chi(v , w)]^p\\right)^{1/p}\\ge \\frac{{\\varepsilon}}{2^{1/p } } [ d_t(u , w)+d_t(v , w)]= \\frac{{\\varepsilon}}{2^{1/p}}d_t(u , v).\\ ] ]    to get tighter control on the euclidean distortion of trees we introduce the notion of @xmath83-strong colorings .",
    "[ def : delta strong ] we say that a coloring @xmath80 is @xmath83-strong if it is monotone , and for every @xmath136 @xmath137 in words , we demand that at least half of the shortest path joining @xmath85 and @xmath86 is covered by color classes of length at least @xmath138 . as",
    "before , we define @xmath88 to be the largest @xmath83 for which @xmath20 admits an @xmath83-strong coloring .",
    "the notions of @xmath83-strong colorings and @xmath121-good colorings are related via the following simple lemma .",
    "[ lem : relation ] every weighted tree @xmath20 satisfies @xmath139 .",
    "let @xmath81 be an @xmath121-good coloring of @xmath20",
    ". we will prove that it is also @xmath140-strong .",
    "in fact , we shall show that for every @xmath141 $ ] and @xmath84 , the total length of the monochromatic segments of length at least @xmath142 on the path @xmath143 satisfies @xmath144 choosing @xmath145 in  , and using the fact that @xmath146 , we deduce that @xmath81 is @xmath140-strong .",
    "the proof of   is by induction on @xmath147 .",
    "if @xmath147 is minimal then @xmath143 is an edge , and hence monochromatic , so that the assertion holds trivially . in general , since the coloring @xmath81 is @xmath121-good , there are two vertices on the path @xmath143 such that the segment @xmath148 is monochromatic and @xmath149 . without loss of generality",
    "we assume that @xmath150 .",
    "if @xmath151 then there is nothing to prove , so assume that @xmath152 .",
    "denoting @xmath153 , @xmath154 and @xmath155 , we apply the inductive hypothesis to the paths joining @xmath85 and @xmath156 and @xmath157 and @xmath86 , to get that @xmath158 where in   we used the concavity of the function @xmath159 , in   we used the fact that @xmath160 , and in   we used the elementary inequality @xmath161 , which is valid for every @xmath162 $ ] .    in @xcite",
    ", matouek proves that if @xmath81 is a monotone edge - coloring of @xmath20 such that every root - leaf path contains at most @xmath163 distinct color classes , then @xmath164 .",
    "clearly any such coloring is @xmath165-strong .",
    "the next theorem generalizes matouek s result along these lines .",
    "we suggest that the reader skip this rather technical proof upon a first reading .",
    "in particular , the much simpler lemma  [ claim : color ] suffices for the proof of theorem [ thm : local ] , although it does not give the optimal quantitative bounds of theorem [ thm : quantitative - local ] .",
    "[ thm : matousek ] for every weighted tree @xmath15 and @xmath11 , @xmath166^{\\min\\left\\{\\frac{1}{p},\\frac12\\right\\}}.\\ ] ]    we may assume that @xmath167 , since if @xmath168 the required result follows by embedding @xmath20 into @xmath169 .",
    "fix @xmath170 and let @xmath80 be a @xmath83-strong coloring .",
    "let @xmath124 be as in lemma  [ claim : color ] . for @xmath171",
    "we denote by @xmath172 the sequence of color classes encountered on the path from the root to @xmath86 .",
    "we shall denote by @xmath173 the distance that the color class @xmath174 contributes to the path from the root to @xmath86 , i.e. @xmath175 now let @xmath176 and define @xmath177 by @xmath178^{1/p}[s_i(v)]^{(p-1)/p } e_{k_i(v)}.\\ ] ]    we will break the proof the proof of the fact that @xmath3 satisfies the required distortion bound into several claims .    [",
    "claim : use delta strong ] for all @xmath171 and @xmath179 , @xmath180    this is where the fact that @xmath81 is a @xmath83-strong coloring comes in .",
    "indeed , @xmath181    [ claim : flip ] @xmath182^{1/p}$ ] .    we need to show that for every edge @xmath183 , @xmath184^{1/p}$ ] .",
    "assume that @xmath86 is further than @xmath85 from the root of @xmath20 .",
    "in this case @xmath185 and @xmath186 .",
    "if @xmath187 then we denote for the sake of simplicity @xmath188 . with this notation",
    "we have that @xmath189^{1/p}[s_i(u)]^{(p-1)/p}-[d_i(v)]^{1/p}[s_i(v)]^{(p-1)/p}\\right|^p\\\\ & = & \\sum_{i=1}^{m_v-1 } d_i(v)\\left|[s_i(u)]^{(p-1)/p}-[s_i(v)]^{(p-1)/p}\\right|^p+\\\\&\\phantom{\\le } & \\left|[d_{m_v}(u)]^{1/p}[s_{m_v}(u)]^{(p-1)/p}-[d_{m_v}(v)]^{1/p}[s_{m_v}(v)]^{(p-1)/p } \\right|^p.\\end{aligned}\\ ] ] note that by our definitions , @xmath190 and @xmath191 .",
    "thus @xmath192^{(p-1)/p}-[s_i(v)]^{(p-1)/p}\\right|^p+\\left|d_{m_v}(u)-d_{m_v}(v)\\right|^p\\\\&\\le & \\sum_{i=1}^{m_v-1 } d_i(v)\\left|[s_i(u)]^{(p-1)/p}-[s_i(v)]^{(p-1)/p}\\right|^p+[d_t(u , v)]^p.\\end{aligned}\\ ] ]    observe that for all @xmath193 , @xmath194 .",
    "thus @xmath195^{(p-1)/p}-[s_i(v)]^{(p-1)/p}\\right|\\le \\frac{|s_i(u)-s_i(v)|}{[s_i(v)]^{1/p}},\\end{aligned}\\ ] ] where we used the elementary inequality @xmath196 , which is valid for all @xmath197 and @xmath198 .",
    "observe that for every @xmath199 , @xmath200    thus , combining   and   we see that @xmath201^{(p-1)/p}-[s_i(v)]^{(p-1)/p}\\right|^p&\\le&\\nonumber \\sum_{i=1}^{m_v-1 } d_i(v)\\cdot \\frac{|s_i(u)-s_i(v)|^p}{s_i(v)}\\\\&\\le&\\nonumber [ d_t(u , v)]^p\\cdot\\sum_{\\substack{i\\in\\{1,\\ldots , m_v-1\\}\\\\s_i(u)\\neq s_i(v ) } } \\frac{d_i(v)}{s_i(v)}\\\\ & \\le & 4[d_t(u , v)]^p\\cdot\\sum_{\\substack{i\\in\\{1,\\ldots , m_v-1\\}\\\\s_i(u)\\neq s_i(v ) } } \\frac{d_i(v)}{\\sum_{j = i}^{m_v } d_j(v)},\\end{aligned}\\ ] ] where in the last line we used claim  [ claim : use delta strong ] .    observe that for every @xmath202 , @xmath203 thus @xmath204 let @xmath205 be the smallest integer in @xmath206 such that @xmath207 . then by the definition of @xmath208 , @xmath209 it follows that @xmath210 plugging this bound into  , and using   and  , we get that @xmath211^{1/p}\\cdot d_t(u , v)\\le \\left[5\\log(3/\\delta)\\right]^{1/p}\\cdot d_t(u , v).\\ ] ]    our final claim bounds @xmath212 .",
    "[ claim : f inverse ] the embedding @xmath3 is invertible , and @xmath213 .",
    "fix @xmath84 , @xmath214 , and let @xmath215 be the integer satisfying @xmath216 and @xmath217 .",
    "it follows that @xmath218 , and we may assume without loss of generality that @xmath219 . with this notation",
    "( see figure  [ figure : tree - matousek ] below ) , @xmath220    [ figure : tree - matousek ]    on the other hand , @xmath221^{1/p}[s_j(u)]^{(p-1)/p}-[d_j(v)]^{1/p}[s_j(v)]^{(p-1)/p}\\right|^p+\\\\&\\phantom{\\le } & \\sum_{i = j+1}^{m_u}d_i(u)[s_i(u)]^{p-1}+\\sum_{i = j+1}^{m_v}d_i(v)[s_i(v)]^{p-1}.\\end{aligned}\\ ] ] using claim  [ claim : use delta strong ] we see that @xmath222^{p-1}&\\ge&\\nonumber\\frac{1}{4^{p-1}}\\sum_{i = j+1}^{m_u } d_i(u)\\left(\\sum_{h = i}^{m_u } d_h(u)\\right)^{p-1}\\\\\\nonumber&\\ge & \\frac{1}{4^{p-1}}\\sum_{i = j+1}^{m_u}\\int_{d_{i+1}(u)+\\cdots + d_{m_u}(u)}^{d_{i}(u)+\\cdots + d_{m_u}(u ) } t^{p-1}dt\\\\\\nonumber & = & \\frac{1}{4^{p-1 } } \\int_0^{d_{j+1}(u)+\\cdots+ d_{m_u}(u)}t^{p-1}dt\\\\&=&\\frac{1}{p4^{p-1}}\\cdot\\left(\\sum_{i = j+1}^{m_u } d_i(u)\\right)^{p}.\\end{aligned}\\ ] ] similarly , @xmath223^{p-1}\\ge",
    "\\frac{1}{p4^{p-1}}\\cdot\\left(\\sum_{i = j+1}^{m_v } d_i(v)\\right)^{p}.\\end{aligned}\\ ] ]    we now consider two cases :    * case 1 . * @xmath224 . in this case , using   we see that @xmath225^p&\\le & 3^p\\left(\\sum_{i = j+1}^{m_u}d_i(u)+\\sum_{i = j+1}^{m_v } d_i(v)\\right)^p\\\\&\\le & 3^p\\cdot 2^{p-1 } \\left(\\sum_{i = j+1}^{m_u}d_i(u)\\right)^p+ 3^p\\cdot 2^{p-1}\\left(\\sum_{i = j+1}^{m_v}d_i(v)\\right)^p\\\\&\\le & p4^{p-1}\\cdot 3^p\\cdot 2^{p-1}\\|f(u)-f(v)\\|_p^p,\\end{aligned}\\ ] ] where in the last inequality we plugged the bounds   and   into  .",
    "thus we get that @xmath226 as required .",
    "* case 2 . * @xmath227 . in this case",
    "we observe that @xmath228 and similarly @xmath229 thus @xmath230^{1/p}[s_j(u)]^{(p-1)/p}-[d_j(v)]^{1/p}[s_j(v)]^{(p-1)/p}\\ge \\left(1-\\frac{\\delta}{2}\\right)^{(p-1)/p}d_j(u)-\\\\&\\phantom{\\le}&\\left(1-\\frac{\\delta}{2}\\right)^{(p-1)/p}d_j(v)\\cdot \\left(1+\\frac{d_j(u)-d_j(v)}{(2-\\delta)d_j(v)}\\right)^{(p-1)/p}\\\\ & \\ge&\\left(1-\\frac{\\delta}{2}\\right)^{(p-1)/p}d_j(u)-\\left(1-\\frac{\\delta}{2}\\right)^{(p-1)/p}d_j(v)\\cdot \\left(1+\\frac{d_j(u)-d_j(v)}{(2-\\delta)d_j(v)}\\right)\\\\&= & \\left(1-\\frac{\\delta}{2}\\right)^{(p-1)/p}\\cdot\\frac{1-\\delta}{2-\\delta}\\cdot [ d_j(u)-d_j(v)]\\\\ & \\ge&\\frac{d_j(u)-d_j(v)}{4}.\\end{aligned}\\ ] ] where we used the fact that @xmath231 .",
    "using   and the bounds   and  , it follows that @xmath232^p+\\frac{1}{p4^{p-1}}\\cdot\\left(\\sum_{i = j+1}^{m_u } d_i(u)\\right)^{p}+\\frac{1}{p4^{p-1}}\\cdot\\left(\\sum_{i = j+1}^{m_v } d_i(v)\\right)^{p}\\\\&\\ge&\\frac{1}{p4^p\\cdot 3^{p-1}}\\left(d_j(u)-d_j(v)+\\sum_{i = j+1}^{m_u}d_i(u)+\\sum_{i = j+1}^{m_v } d_i(v)\\right)^p\\\\ & \\ge & \\frac{1}{24^{p}}\\cdot[d_t(u , v)]^p.\\end{aligned}\\ ] ]    claim  [ claim : f inverse ] , together with claim  [ claim : flip ] , concludes the proof of theorem  [ thm : matousek ] .",
    "the following theorem , in conjunction with theorem  [ thm : matousek ] and lemma  [ lem : relation ] , implies theorem  [ thm : upper - binary ] . if one is concerned with simply giving _ some _ upper bound on @xmath22 in terms of @xmath102 , then it suffices to combine the following theorem with lemma [ claim : color ] .",
    "[ thm : upperb ] for every weighted tree @xmath15 and every @xmath43 , @xmath233    we start by introducing some notation . for a vertex @xmath171",
    "we denote by @xmath234 the set of all children of @xmath86 in @xmath20 .",
    "given @xmath235 we denote by @xmath236 the subtree rooted at @xmath85 . we also let @xmath237 denote the tree @xmath238 , i.e. @xmath237 is @xmath239 plus the  incoming \" edge @xmath240 .    recall that @xmath241 is the complete binary tree of height @xmath25 .",
    "let @xmath242 be the root of @xmath24 , and define an auxiliary tree @xmath243 by @xmath244 ( i.e. @xmath243 is @xmath24 with an extra incoming edge ) .",
    "given a connected subtree @xmath245 of @xmath20 rooted at @xmath246 , we shall say that @xmath245 _ admits a copy of @xmath243 at scale @xmath215 _ if there exits a one - to - one mapping @xmath247 such that    1 .",
    "@xmath248 2 .",
    "@xmath249 and @xmath250 ( thus in particular @xmath251 ) .",
    "we define @xmath252 or @xmath253 if no such @xmath25 exists .",
    "we shall now define a function @xmath254 and a coloring @xmath80 .",
    "these mappings will be constructed by induction as follows .",
    "we start by setting @xmath255 .",
    "assume inductively that the construction is done so that whenever @xmath171 is such that @xmath256 is defined , if @xmath85 is a vertex on the path @xmath257 then @xmath258 has already been defined , and for every edge @xmath259 incident with @xmath86 , @xmath260 has been defined .",
    "let @xmath171 be a vertex closest to the root @xmath261 for which @xmath256 hasnt yet been defined .",
    "then , by our assumption , for every @xmath262 , @xmath260 has been defined , and for every vertex @xmath85 other than @xmath86 lying on the path @xmath257 , @xmath258 has been defined .",
    "let @xmath263 denote the set of _ breakpoints _ of @xmath81 in @xmath257 , i.e. the set of vertices on @xmath257 for which the incoming and outgoing edges have distinct colors ( for convenience , in what follows we shall also consider the root @xmath261 as a breakpoint of @xmath81 ) .",
    "we define @xmath264 having defined @xmath256 we choose one of its children @xmath265 for which @xmath266 letting @xmath85 be the father of @xmath86 on the path @xmath257 , we set @xmath267 , and we assign arbitrary new ( i.e. which havent been used before ) distinct colors to each of the edges @xmath268 . in other words ,",
    "given the  scale \" @xmath269 we order the children of @xmath86 according to the size of the copy of @xmath243 which they admit beneath them at scale @xmath215 .",
    "we then continue coloring with the color @xmath270 the path @xmath257 along the edge joining @xmath86 and its child which admits the largest @xmath243 at scale @xmath215 , and color the remaining edges incident with @xmath86 by arbitrary distinct new colors .",
    "this definition clearly results in a monotone coloring @xmath81 . to motivate this somewhat complicated construction",
    ", we shall now prove some of the crucial properties of @xmath81 and @xmath271 which will be used later .",
    "[ claim : g ] let @xmath272 be any monotone path in @xmath20 , and let @xmath273 be the sequence of breakpoints along @xmath272 ordered down the tree ( i.e. in increasing distance from the root ) .",
    "assume that @xmath274 satisfies for every @xmath275 , @xmath276 , and assume also that @xmath277 .",
    "then there exists a subsequence of the indices @xmath278 such that    1 .   @xmath279 .",
    "2 .   for every @xmath280",
    "we have @xmath281 .",
    "3 .   for every @xmath282",
    "we have @xmath283",
    ".    we shall show that if @xmath284 is such that @xmath285 then there exists an index @xmath286 with @xmath287 and @xmath288 .",
    "assuming this fact for the moment , we conclude the proof as follows .",
    "let @xmath289 be the smallest integer in @xmath290 such that @xmath291 . then @xmath292 .",
    "assuming we defined @xmath293 , if @xmath294 we stop the construction , and otherwise we let @xmath295 be the smallest integer bigger than @xmath296 such that @xmath297 . since @xmath298 , we know that @xmath299 . thus @xmath300 ( because we are assuming that @xmath301 ) .",
    "so , there exists @xmath302 such that @xmath303 and @xmath304 .",
    "since by construction @xmath305 we deduce that @xmath306 and @xmath307 this construction terminates after @xmath25 steps , in which case we have that @xmath308 since @xmath309 , this implies the required result .    it remains to show that if @xmath284 is such that @xmath285 then there exists @xmath310 with @xmath287 and @xmath311 .",
    "we first claim that for every @xmath284 there is a breakpoint @xmath312 with @xmath313 and @xmath314 . indeed ,",
    "if @xmath315 then there is nothing to prove , so assume that @xmath316 . by the definition of @xmath271 there exists a breakpoint @xmath317 such that @xmath318 thus necessarily @xmath319 and @xmath320 . if @xmath321 then we are done by taking @xmath322",
    "otherwise , continuing in this manner we find a breakpoint @xmath323 with @xmath324 and @xmath325 .",
    "this procedure terminates when we find a sequence @xmath326 with @xmath327 , @xmath328 , and for every @xmath329 , @xmath330 and @xmath331 . thus @xmath332    now , assume that @xmath333 .",
    "let @xmath334 be the largest integer in @xmath335 such that @xmath336 ( such an integer @xmath334 exists since @xmath337 ) .",
    "then @xmath338 . by the previous argument",
    "there is a break point @xmath339 with @xmath313 and @xmath340 .",
    "this implies that @xmath341 for some @xmath342 , and @xmath343 .",
    "we proved that as long as @xmath344 satisfies @xmath345 , there are @xmath346 such that @xmath347 , @xmath348 , and @xmath349 , @xmath350 .",
    "thus , by the definition of @xmath271 , @xmath351 it follows that either @xmath352 or @xmath287 , as required .    to conclude the proof of theorem  [ thm : upperb ]",
    "we may assume that @xmath353 , since otherwise the assertion of theorem  [ thm : upperb ] is trivial .",
    "fix @xmath354 . by the definition of @xmath120 ,",
    "the coloring @xmath81 constructed above is not @xmath121-good .",
    "thus , there exist two vertices @xmath84 such that the path @xmath143 does not contain a monochromatic segment of length at least @xmath355 .",
    "we may assume without loss of generality that @xmath85 is an ancestor of @xmath86 , and let @xmath273 be the sequence of breakpoints along this path , enumerated down the tree ( i.e. from @xmath85 to @xmath86 , not necessarily including @xmath85 or @xmath86 ) .",
    "denoting @xmath155 we have that @xmath356 for all @xmath357 .",
    "fix @xmath274 such that @xmath358 .",
    "this choice implies that @xmath359 and @xmath360 . by claim  [ claim : g ]",
    "there is an integer @xmath361 ( using the upper bound on @xmath121 ) and a sequence of breakpoints @xmath362 on the path @xmath143 ( ordered down the tree ) such that @xmath363 and for @xmath364 , @xmath365 .",
    "the proof of theorem  [ thm : upperb ] will be complete once we show that @xmath366 .",
    "for @xmath367 let @xmath368 be the child of @xmath369 along the path @xmath143 .",
    "we will prove by reverse induction on @xmath364 that @xmath370 , implying the required result .",
    "the base case is true , i.e. @xmath371 , since the pair @xmath372 constitutes a copy of @xmath373 at scale @xmath215 .    assuming that @xmath370 we shall prove that @xmath374 .",
    "since @xmath375 was a breakpoint , the construction of @xmath81 implies that there must be a child @xmath376 of @xmath375 , _ other than @xmath368 _ , for which @xmath377 .",
    "thus , there exist one to one mappings @xmath378 such that @xmath379 , @xmath380 , @xmath381 , @xmath382 , and @xmath383 .",
    "thinking of @xmath384 as two disjoint copies of @xmath385 , joined at the root @xmath386 , we may  glue \" @xmath3 and @xmath387 to an embedding @xmath388 of @xmath384 by setting @xmath389 . since @xmath390 , this results in an embedding at scale @xmath215 of @xmath384 into @xmath391 , as required ( see figure  [ figure : gluing ] ) .",
    "we recall that the _ doubling constant @xmath392 _ of a metric space @xmath6 is the infimal value of @xmath393 for which every ball in @xmath6 can be covered by @xmath393 balls of half the radius . if @xmath394 is a @xmath83-separated set in @xmath6 , then a standard observation is that @xmath395 .",
    "this section is devoted to a simpler proof of the following theorem of gupta , krauthgamer , and lee originally proved in @xcite .",
    "( we stress that the only results we need for this section are lemma [ claim : color ] and theorem [ thm : upperb ] . )",
    "[ thm : gkl ] a tree metric @xmath20 embeds into a finite - dimensional euclidean space if and only if @xmath396 . in other words , every doubling tree @xmath20 admits a @xmath397-embedding into @xmath398 with @xmath399 depending only on @xmath400 .",
    "let @xmath401 be a weighted , rooted tree .",
    "note that the  only if \" part of theorem  [ thm : gkl ] is trivial . in order to prove the remaining implication we need a coloring notion weaker than @xmath117-good .",
    "let @xmath108 be a coloring of the edges of @xmath20 which is _ not necessarily monotone .",
    "_ we will say that @xmath81 is _",
    "@xmath117-reasonable _ if the following holds for every @xmath136 .",
    "let @xmath402 , and recall that @xmath403 denote the paths from @xmath404 to @xmath85 and @xmath86 , respectively .",
    "then there should exist a color @xmath405 for which @xmath406    since a reasonable coloring is not necessarily monotone , it is possible to construct such colorings where @xmath407 is finite even though @xmath20 might be infinite .",
    "the number of colors used , i.e. @xmath408 , controls the dimension of the embedding from lemma [ claim : color ] .",
    "[ claim : color2 ] let @xmath401 be a weighted tree , and suppose that @xmath20 admits an @xmath117-reasonable coloring for some @xmath409 .",
    "then @xmath20 embeds in @xmath398 ( equipped , e.g. with the @xmath76 norm ) with distortion @xmath410 , and @xmath411 .",
    "let @xmath412 be an @xmath117-reasonable coloring of @xmath20 .",
    "we use the embedding @xmath413 of lemma [ claim : color ] .",
    "in particular , it is easy to check that the definition of the embedding does not require @xmath81 to be monotone .",
    "observe that @xmath414 lies naturally in @xmath415 , and thus we may assume that @xmath416 with @xmath411 .    from the proof of lemma [ claim",
    ": color ] , we conclude that @xmath417 , and thus we need only consider @xmath418 .",
    "but it is easy to see that condition suffices to obtain a similar lower bound in equation of lemma [ claim : color ] .",
    "we note that the dependence of @xmath25 on @xmath408 in the above lemma can be improved to @xmath419 using a `` nearly - orthogonal '' set of vectors instead of the orthonormal set @xmath420 .",
    "we refer to @xcite for details .",
    "now , clearly @xmath421 since @xmath422 , hence @xmath423 using theorem [ thm : upperb ] . in light of lemma [",
    "claim : color2 ] and the preceding remark , the following result completes the proof of theorem [ thm : gkl ] .",
    "( note that we can assume @xmath20 finite by compactness ",
    "a tree embeds into a finite - dimensional euclidean space if and only if every finite subset embeds with uniformly bounded distortion ) .",
    "let @xmath401 be a finite , weighted tree .",
    "if @xmath20 admits an @xmath117-good coloring , then it also admits an @xmath424-reasonable coloring with only @xmath425 colors .",
    "we will say that a monotone coloring @xmath412 is _ regular _ if the following holds : for every maximal monochromatic segment @xmath426 ( with edges ordered down the tree ) , and for every @xmath427 , we have @xmath428 .    if a finite tree @xmath20 admits an @xmath117-good coloring , then @xmath20 admits an @xmath424-good regular coloring .",
    "let @xmath401 be a rooted tree , and let @xmath429 be an @xmath117-good coloring of @xmath20 .",
    "suppose that some monochromatic segment @xmath426 violates the regularity condition .",
    "let @xmath430 $ ] be the smallest index for which @xmath431 .",
    "we derive a new coloring @xmath432 by coloring the edges @xmath433 with a new unused color @xmath405 , i.e. @xmath434 if @xmath435 for some @xmath436 and @xmath437 otherwise .",
    "continue this process inductively until the resulting coloring @xmath438 is regular .",
    "this process terminates because @xmath20 is finite .",
    "it remains to show that @xmath439 is @xmath424-good .    to this end , let @xmath440 be a maximal monochromatic segment according to @xmath441 , and let @xmath442 be the maximal monochromatic segments of @xmath334 according to @xmath439 , ordered down the tree . by construction , we have @xmath443 hence @xmath444 .",
    "it follows that @xmath439 is a regular @xmath445-good coloring of @xmath20 .",
    "let @xmath20 be a rooted tree , and let @xmath108 be an @xmath117-good coloring of @xmath20 .",
    "using the preceding lemma , we may assume that @xmath81 is regular .",
    "let @xmath446 be the set of color classes .",
    "we will think of segments @xmath447 sometimes as a subset of edges and sometimes a subset of vertices ( the endpoints and internal vertices of the segments ) , depending on the context . in everything that follows",
    ", we will assume that for @xmath448 , we have @xmath449 .",
    "this is without loss of generality by applying arbitrarily small perturbations to @xmath20 .",
    "( alternatively , we could fix a total order on segments of equal diameter , but this would add unnecessary notation to the proof . )    for every segment @xmath447 , we define @xmath450 as the vertex of @xmath334 which is closest to the root . for every @xmath451 and @xmath452",
    "we define a relative length function @xmath453 where we take @xmath447 , and we set @xmath454 in case the maximum is empty . in words , this is how long the segment @xmath447 `` looks '' from @xmath455 , where the `` view '' is restricted to a ball of radius @xmath456 .",
    "it is important to note that even when @xmath457 , one might have @xmath458 since @xmath20 is not necessarily an @xmath79-tree .",
    "now we define carefully a _ directed _ graph @xmath459 . the adjacency relationship on @xmath460",
    "will be the key in producing an @xmath461)-reasonable coloring .",
    "we put @xmath462 for some constant @xmath463 to be chosen later .",
    "observe , in particular , that @xmath464 .",
    "we will argue that the undirected graph @xmath465 which results from ignoring the edge directions in @xmath460 has its chromatic number bounded solely by a function of @xmath400 .",
    "we accomplish this with the following sequence of lemmas .",
    "( this step is non - trivial since @xmath465 does not have bounded degree . )    [ lem : color2 ] for every @xmath447 , the out - degree is bounded , i.e. @xmath466    fix @xmath447 . for every @xmath467 with @xmath468 , let @xmath469 be the node achieving the maximum in . if the maximum does not exist then @xmath470 , hence @xmath471 . by definition ,",
    "furthermore , @xmath473 .",
    "it follows that the set @xmath474 is @xmath475-separated .",
    "since @xmath476 , the doubling property implies that @xmath477    for any undirected graph @xmath478 and @xmath479 , we define @xmath480 to be the set of neighbors of @xmath86 in @xmath481 , we let @xmath482 and @xmath483 for @xmath484 . the next result is well - known .",
    "[ lem : chrom ] let @xmath485 be any finite , undirected graph .",
    "let @xmath486 and let @xmath487 be a permutation .",
    "we denote @xmath488 . if , for every @xmath489 , we have @xmath490 then the chromatic number of @xmath481 is at most @xmath491 .",
    "the proof follows by inductively coloring the elements @xmath492 in order .",
    "if we have a palette of @xmath491 colors , then since @xmath493 , we can always choose a new color for @xmath494 that does nt conflict with any already colored vertex in @xmath495 .    if @xmath465 is the undirected version of @xmath460 , then the chromatic number of @xmath465 is bounded by @xmath496 .",
    "let @xmath497 be any permutation for which @xmath498 for @xmath499 ( i.e. the diameters of the segments decrease monotonically ) . then combining lemmas [ lem : color2 ] and the fact that @xmath464 shows that for @xmath489",
    ", @xmath500 applying lemma [ lem : chrom ] completes the proof .",
    "now let @xmath501 $ ] be a proper coloring of @xmath465 using only @xmath502 colors .",
    "we are done as soon as we show that @xmath503 is an @xmath424-reasonable edge - coloring of @xmath20 ( where we consider @xmath503 as a coloring of @xmath504 in the obvious way ) for some choice of @xmath505 .",
    "[ lem : bigsegs ] suppose that for @xmath448 , we have @xmath506 where @xmath118 . then @xmath507 .",
    "assume that @xmath508 , and let @xmath509 be the bottom - most point of @xmath510 .",
    "then @xmath511 in this case , @xmath512 , hence if @xmath513 , we have @xmath468 , which finishes the proof of the lemma .",
    "so we may assume that @xmath514 .",
    "we claim that in this case , @xmath515 using the regularity of @xmath81 .",
    "let @xmath516 be such that @xmath517 , and for which @xmath518 is maximal . if @xmath519 , then we are done since by , we have @xmath520 , implying @xmath521 .",
    "hence we may assume that @xmath522 .",
    "in this case , since @xmath508 , there exists an edge @xmath523 with @xmath524 and @xmath525 . but",
    "this implies that @xmath526 , which contradicts the regularity of @xmath81 .",
    "it follows that @xmath527 , which again implies @xmath468 .",
    "now fix @xmath136 and @xmath402 , and suppose that @xmath528 . since @xmath81 is an @xmath117-good coloring , there exists a maximal monochromatic segment ( with respect to @xmath81 ) @xmath529 for which @xmath530 .",
    "now set @xmath531 .",
    "applying lemma [ lem : bigsegs ] , we see that for any @xmath532 with @xmath533 , we have @xmath534 .",
    "but now line of lemma [ lem : relation ] implies that segments of this length can cover at most an @xmath445-fraction of @xmath535 ( since @xmath81 is an @xmath117-good coloring ) , which is at most an @xmath536-fraction of @xmath143 .",
    "it follows that @xmath503 is a @xmath83-reasonable coloring for @xmath537 , completing the proof .",
    "in this section we study markov convexity , and show how it can be used to prove several distortion lower bounds . in particular , we will discuss the connection between markov convexity and uniform convexity in banach spaces , and we will prove that theorem  [ thm : upper - binary ] is optimal .",
    "we start by showing that hilbert space is markov @xmath77-convex .",
    "this has essentially been proved by bourgain in  @xcite .",
    "we give the following proof here because the argument is extendable to the case of @xmath538 .",
    "we refer also to  @xcite for another variant of bourgain s proof .",
    "[ lem : identity ] for every @xmath539 , @xmath540    let @xmath541 be the @xmath542-algebra of subsets of @xmath543 $ ] generated by the intervals @xmath544\\right\\}_{j=1}^{2^n}$ ] .",
    "define @xmath545\\to l_2 $ ] by @xmath546 on @xmath547 .",
    "set @xmath548 , where the expectation is with respect to the lebesgue measure on @xmath543 $ ] .",
    "in other words , for every @xmath549 and @xmath550 @xmath551 since the sequence @xmath552 is a martingale difference sequence , and @xmath553 is constant , the functions @xmath554 are orthogonal ( in the hilbert space @xmath555 )",
    ". thus @xmath556 this is precisely the required identity .    we can remove the dyadic bias from by averaging over shifts .",
    "[ cor : nodyad ] for every @xmath557 , @xmath558 where , by convention , @xmath559 for @xmath560 .",
    "first , consider the sequence of length @xmath561 , @xmath562 which is the original sequence with @xmath563 copies of @xmath564 and @xmath565 appended to the front and back , respectively .",
    "call this sequence @xmath566 .",
    "now average the equality over all @xmath567 contiguous subsequences of length @xmath568 , i.e. @xmath569 for @xmath570 . by counting terms , this yields the desired result .",
    "[ thm : hilbert has markov ] hilbert space is markov @xmath77-convex .",
    "in fact , @xmath571 .",
    "let @xmath51 be a markov chain on a state space @xmath52 , and take @xmath572 . by corollary [ cor :",
    "nodyad ] , @xmath573 where by convention we set @xmath574 for @xmath575 .",
    "observe that for every two i.i.d .",
    "random vectors @xmath576 , and every constant @xmath577 , @xmath578 . thus , using the fact that conditioned on @xmath579 the random vectors @xmath580 and @xmath581 are i.i.d .",
    ", we see that @xmath582 likewise , @xmath583 it follows that @xmath584 completing the proof .",
    "[ rem : superreflexive ]    _ the above argument can be generalized to prove that @xmath63-convex banach spaces are markov @xmath63-convex . recall that a banach space @xmath6 is said to be @xmath63-convex with constant @xmath585 ( see  @xcite ) if for every @xmath586 , @xmath587 the least such constant @xmath585 is denoted @xmath588 .",
    "_    we claim that for every banach space @xmath6 , @xmath589 indeed , repeating the argument of lemma  [ lem : identity ] , we replace the use of orthogonality by pisier s inequality  @xcite to get that ( see the argument in  @xcite for the constant used below ) , @xmath590^p{\\mathbb e}\\|{\\varphi}_m\\|_x^p\\ge { \\mathbb e}\\|{\\varphi}_0\\|_x^p+\\sum_{k=1}^m { \\mathbb e}\\|{\\varphi}_k-{\\varphi}_{k-1}\\|_x^p.\\ ] ] as in the proof of theorem  [ thm : hilbert has markov ] ( and using the notation there ) this shows that @xmath591\\sum_{t=1}^{2^m } { \\mathbb e}\\|f(x_t ) - f(x_{t-1})\\|_x^p \\ge \\\\ & & \\qquad\\qquad\\qquad \\frac12 \\sum_{k=1}^m 2^{-pk } \\sum _ { t=1}^{2^{m } } { \\mathbb e}\\|f(x_{t } ) - 2f(x_{t-2^{k-1 } } ) + f(x_{t-2^k})\\|_x^p + \\ ,",
    "\\frac12 \\frac{\\mathbb e \\|f(x_0)-f(x_{2^m})\\|_x^p}{2^{pm}}.\\end{aligned}\\ ] ]    since for every two i.i.d .",
    "random vectors @xmath592 , and every constant @xmath593 , we have that @xmath594 ( this fact follows from a straightforward interpolation argument ) , we conclude exactly as in the proof of theorem  [ thm : hilbert has markov ] .",
    "we mention some partial converses to remark [ rem : superreflexive ] .",
    "[ coro : dvoretzky ] let @xmath6 be an infinite dimensional banach space .",
    "then @xmath69 implies that @xmath6 is superreflexive and has cotype @xmath95 for every @xmath96 .",
    "let @xmath595 . by the maurey - pisier  @xcite theorem , @xmath6 contains copies of @xmath596 with distortion uniformly bounded in @xmath40 . by bourgain s embedding of trees into @xmath597  @xcite",
    ", this implies that @xmath598 . from bourgain s",
    "lower bound  @xcite , or alternatively claim  [ claim : lowertrees ] below , we deduce that @xmath599 , as required .",
    "the fact that @xmath6 is superreflexive follows from bourgain s characterization of superreflexivity  @xcite .",
    "let @xmath6 be a banach lattice with @xmath69 .",
    "then for every @xmath96 , @xmath6 admits a @xmath95-convex equivalent norm .    this is a direct consequence of a theorem of figiel  @xcite ( see  @xcite , page 100 ) which says that a banach lattice with cotype @xmath95 and non - trivial type can be renormed to be @xmath95-convex ( @xmath6 has non - trivial type since it is superreflexive ) .",
    "we can now use the discrepancy between @xmath68 and @xmath600 to prove distortion lower bounds for embeddings between the two spaces .",
    "[ lem : mcdist ] let @xmath601 be metric spaces , then for every @xmath75 , we have @xmath602    fix @xmath603 .",
    "let @xmath604 be a bi - lipschitz map , let @xmath51 be a markov chain with state space @xmath52 , and let @xmath605 .",
    "then @xmath606}{2^{kp}}\\\\ & \\leq & \\|g^{-1}\\|_{\\mathrm{lip}}^p\\cdot \\sum_{k=0}^m\\sum_{t=1}^{2^{m}}\\frac{{\\mathbb e}\\left[d_y\\left(g(f\\left(x_{t}\\right)),g(f(\\widetilde x_{t}(t-2^k)))\\right)^p\\right]}{2^{kp } } \\\\ & \\leq & \\|g^{-1}\\|_{\\mathrm{lip}}^p \\cdot \\pi^p\\cdot \\sum_{t=1}^{2^m}{\\mathbb e}[d_y(g(f(x_t)),g(f(x_{t-1})))^p ] \\\\ & \\leq & \\|g\\|_{\\mathrm{lip}}^p \\cdot \\|g^{-1}\\|_{\\mathrm{lip}}^p \\cdot \\pi^p\\cdot \\sum_{t=1}^{2^m}{\\mathbb e}[d_y(f(x_t),f(x_{t-1}))^p].\\end{aligned}\\ ] ] it follows that @xmath607 , as required .    as a warm up to the more involved lower bounds that will follow , we show how markov convexity can be used to prove bourgain s theorem for complete binary trees .",
    "[ claim : lowertrees ] for every @xmath608 , we have @xmath609    let @xmath51 be the forward random walk on @xmath610 ( which goes left / right with probability @xmath611 ) , starting from the root , with the leaves as absorbing states . then @xmath612 \\leq 2^m.\\ ] ] moreover , in the forward random walk , after splitting at time @xmath613 with probability at least @xmath611 two independent walks will accumulate distance which is at least twice the number of steps ( until a leaf is encountered ) .",
    "thus @xmath614}{2^{kp } } \\geq \\sum_{k=0}^m \\sum_{t=1}^{2^m-2^k } \\frac{1}{2^{kp } } \\cdot \\frac12 \\cdot 2^{(k+1)p } \\geq 2^{p-2}\\cdot m \\cdot 2^{m}.\\ ] ] the claim follows .",
    "since @xmath14 is markov @xmath615-convex for every @xmath616 , combining claim  [ claim : lowertrees ] with lemma [ lem : mcdist ] recovers bourgain s result  @xcite , i.e. for every @xmath617 , we have @xmath618 .    *",
    "simple random walks with positive speed .",
    "* in fact , the proof of claim  [ claim : lowertrees ] applies in more general situations where a random walk has positive speed .",
    "we consider some examples .",
    "let @xmath619 be an infinite , vertex - transitive graph of bounded degree .",
    "let @xmath51 be a simple random walk on @xmath481 starting from an arbitrary vertex .",
    "denote by @xmath620 the shortest path metric on @xmath481 .",
    "one defines the _ speed of the random walk _ as the limit @xmath621 subadditivity implies that the limit above always exists .",
    "[ lem : speed ] if the speed of the simple random walk on a vertex - transitive graph @xmath481 is at least @xmath622 , then @xmath623 , where @xmath624 denotes the ball of radius @xmath625 in @xmath481 . in particular for every @xmath616 , @xmath626    the proof is similar to that of claim [ claim : lowertrees ] .",
    "one simply observes that for two independent simple random walks @xmath627 started at the same point , we have @xmath628 in particular , for @xmath295 large enough , with constant probability we have @xmath629 .    as an application ,",
    "consider the lamplighter group over @xmath630 .",
    "this is a group with elements @xmath631 , where @xmath632 , and @xmath633 with @xmath634 for all but finitely many @xmath635 .",
    "traditionally , one imagines a lamp placed at every element of @xmath630 , where each lamp can either be on or off . in the pair",
    "@xmath631 , @xmath3 denotes the settings of all the lamps , and @xmath509 denotes the position of the lamplighter . accordingly , the generating set consists of two types of moves .    1",
    ".   the lamplighter can move to an adjacent vertex in @xmath630 , i.e. @xmath636 where @xmath637 is adjacent to @xmath509 in the standard cayley graph of @xmath630 or 2 .",
    "the lamplighter can turn on / off the lamp at @xmath509 , i.e. @xmath638 where @xmath639 for @xmath640 and @xmath641 .",
    "we will use @xmath642 to denote the associated group as well as the cayley graph with the described generators .",
    "a result of kamanovich and vershik @xcite shows that the simple random walk on @xmath642 has positive speed for @xmath643 . using remark [ rem : superreflexive ] and lemma [ lem : speed ] , we conclude :    for @xmath643 , the word metric on @xmath642 does not embed into any @xmath63-convex banach space . in particular , if @xmath644 denotes a ball of radius @xmath625 , then for @xmath616 , @xmath645    we remark that , by a theorem of varopoulos  @xcite , the simple random walk on the cayley graph of a finitely - generated group has positive speed if and only if there exists a bounded , non - constant , harmonic function on the graph .",
    "finally , we consider the finite lamplighter groups over @xmath646 which we denote by @xmath647 . in this case , the simple random walk on @xmath647 does not have positive speed , but it is still possible to prove a distortion lower bound because the markov chains in the definition of markov convexity need not be reversible . in particular , consider the chain @xmath51 defined as follows .",
    "@xmath648 where @xmath649 , i.e. all lamps are turned off . if @xmath650 , then with probability @xmath611 , we put @xmath651 , and with probability @xmath611 we put @xmath652 where @xmath653 . arguing essentially exactly as in claim [ claim : lowertrees ] for times @xmath654",
    ", we have the following .    [ prop : lampz2 ] for every @xmath75 , we have @xmath655 .",
    "in particular , @xmath656 .",
    "proposition  [ prop : lampz2 ] can also be proved by exhibiting an embedding of a complete binary tree of depth @xmath657 into @xmath658see  @xcite .      in this section",
    "we study the markov convexity properties of a special class of trees called weak prototypes .",
    "these trees will play a central role in section  [ sec : dist formula ] , where theorem  [ thm : formula ] is proved .",
    "we begin with some definitions ( we continue using here the notation of section  [ section : coloring ] ) .    in what follows , by a path metric @xmath659 we simply mean a graph theoretical path from @xmath660 to @xmath661 with edges @xmath662 and edge weights @xmath663 .",
    "the length of @xmath272 , denoted @xmath664 , is given by @xmath665 . given a monotone path @xmath272 in @xmath20 , and a set of vertices @xmath666 on @xmath272 , ordered down the tree and not necessarily containing all the vertices of @xmath20 lying on @xmath272 , we will call the path metric on @xmath666 with the edge weights @xmath667 , the path metric induced by @xmath20 on @xmath666 .    given a path metric @xmath659 and @xmath668 we shall say the path @xmath272 is @xmath669-weak if at least an @xmath121-fraction of the length of @xmath272 is composed of edges of length at most @xmath670 , i.e. @xmath671    a monotone path @xmath143 in @xmath20 will be called _ degree-@xmath77 @xmath669-weak _ if the following condition holds true .",
    "let @xmath672 be the vertices of @xmath20 on @xmath272 , ordered down the tree , who have at least two children in @xmath20 .",
    "then we require that the path metric induced by @xmath20 on @xmath673 is @xmath669-weak . in other words ,",
    "call a monotone path @xmath272 in @xmath20 a _ strait _ if every vertex on @xmath272 has exactly one child , except possibly for the initial and final vertices .",
    "then @xmath143 is degree-@xmath77 @xmath669-weak if at least an @xmath121-fraction of the length of @xmath143 is composed of maximal straits of length at most @xmath87 .",
    "[ def : weak prototype ] fix @xmath674 .",
    "a tree @xmath15 with edge lengths @xmath675 is called an @xmath669-weak prototype with height ratio @xmath625 if the following conditions are satisfied .    *",
    "every non - leaf vertex of @xmath20 has exactly one or two children . *",
    "every root - leaf path of @xmath20 is degree-@xmath77 @xmath669-weak . *",
    "if @xmath676 is the length of the shortest root - leaf path in @xmath20 and @xmath677 is the length of the longest root - leaf path in @xmath20 , then @xmath678 .",
    "first , we will prove a lower bound on the markov convexity constants of a special class of unweighted weak prototypes .",
    "later , we will show that every weak prototype can be approximated by a weak prototype satisfying these conditions .",
    "[ thm : unweightedweak ] let @xmath679 be an _ unweighted _",
    "@xmath680-weak prototype with height ratio 1 and height @xmath681 for some @xmath608 . then for every @xmath682 , we have @xmath683\\right)^{1/p}.\\ ] ]    let @xmath261 be the root of @xmath20 .",
    "let @xmath684 be the markov chain on @xmath20 defined as follows .",
    "initially , @xmath685 .",
    "if @xmath55 is a leaf node , then @xmath686 , and otherwise @xmath687 is a uniformly random child of @xmath55 .",
    "first , we have @xmath688 for every @xmath689 .",
    "thus it suffices to show that @xmath690^p}{2^{kp } } \\geq \\frac{\\varepsilon}{4 } \\left [ \\log_2 \\left(\\frac{\\varepsilon}{\\delta}\\right)-4\\right].\\ ] ]    recall that a monotone path @xmath272 in @xmath20 is a _ strait _ if every node of @xmath272 has exactly one child , except possibly for the initial and final nodes .",
    "additionally , say that a node @xmath691 is a _ branch point _ if @xmath86 has at least two children . clearly",
    "the edges of every root - leaf path partition into maximal straights with branch points at the ends ( except for the root and leaves ) .",
    "let @xmath692 be the event that the set @xmath693 contains a branch point .",
    "observe that whenever @xmath694 , we have @xmath695 \\geq \\sum_{t=0}^{2^m-1 } \\pr\\left[\\textrm{$x_t$ falls in a maximal strait of length at most $ 2^{k-1}$}\\right ] \\geq \\varepsilon 2^m,\\end{aligned}\\ ] ] since every root - leaf path of @xmath20 is degree-2 @xmath680-weak .",
    "furthermore , if @xmath696 , and @xmath697 , then @xmath698 \\geq \\frac12,\\ ] ] since upon hitting a branch point , the two chains will diverge with probability at least @xmath611 for at least @xmath699 additional steps .",
    "we conclude that when @xmath694 and @xmath696 , @xmath700^{p } \\nonumber & \\geq & \\sum_{t=0}^{2^m - 2^k } \\mathbb e\\left[d\\left(x_{t+2^k } , \\widetilde x_{t+2^k}(t)\\right)\\right]^p \\\\ & \\geq & \\sum_{t=0}^{2^m-2^k } \\frac12 \\cdot 2^{kp } \\cdot \\pr[\\mathcal b_k(t ) ] \\label{eq : exec1 } \\\\ & \\geq & 2^{kp-1 } \\cdot \\left ( \\varepsilon 2^m - 2^k \\right ) , \\label{eq : exec2}\\end{aligned}\\ ] ] where in we used , and in we used along with a correction term for boundary values of @xmath25 .",
    "therefore , @xmath701^p}{2^{kp } } & \\geq & 2^{-(m+1 ) } \\sum_{k \\geq 1 + \\log_2 ( \\delta 2^m)}^{m } \\max \\left\\{0 , \\varepsilon 2^m - 2^k\\right\\ } \\\\ &",
    "\\geq & \\frac{\\varepsilon}{4 } \\left[\\log\\left(\\frac{\\varepsilon}{\\delta}\\right ) - 4\\right].\\end{aligned}\\ ] ] the proof of theorem  [ thm : unweightedweak ] is complete .      in this section ,",
    "we show how pass from a finite tree @xmath20 to a more well - behaved tree @xmath702 such that @xmath703 for every @xmath704 .",
    "we use this transformation to prove distortion lower bounds for arbitrary weak prototypes .",
    "[ lem : rtree ] let @xmath679 be a finite , graph - theoretic metric tree , and let @xmath705 be the @xmath79-tree that results from replacing every edge of @xmath706 by a closed interval whose length is @xmath707 .",
    "then for every @xmath704 , we have @xmath708 .    fix a root @xmath261 of @xmath20 ( and , in particular , an orientation of the edges ) .",
    "let @xmath709 be an embedding of @xmath20 .",
    "let @xmath710 be a system of disjointly supported unit vectors each of whose support is also disjoint from the support of @xmath414 .",
    "denote a point @xmath711 by @xmath712 , where @xmath713 , we have @xmath714 , and @xmath715 for @xmath716 $ ] .",
    "assume that @xmath717 .",
    "we define an embedding @xmath718 by @xmath719 fix @xmath720 .",
    "if @xmath721 is not a descendant of @xmath85 or vice - versa then @xmath722 thus @xmath723 if @xmath721 is a strict descendant of @xmath85 then @xmath724 and a similar reasoning shows that @xmath725 .",
    "the case of @xmath726 is even simpler , so we have shown that @xmath727 .    on the other hand",
    ", we will now show that @xmath728 .",
    "assume first of all that @xmath721 is not a descendant of @xmath85 or vice - versa .",
    "then @xmath729^p + [ \\eta ' d_t(u',v')]^p   + \\left|\\|f(u ) - f(u')\\|_p - \\eta\\|f(u ) -   f(v)\\|_p - \\eta'\\|f(u ' ) -   f(v')\\|_p\\right|^p \\nonumber\\\\ & \\geq & [ \\eta\\ , d_t(u , v)]^p + [ \\eta ' d_t(u',v')]^p   + \\left|\\frac{d_t(u , u')}{\\|f^{-1}\\|_{\\mathrm{lip } } } - \\eta\\,d_t(u , v ) - \\eta'd_t(u',v')\\right|^p \\nonumber\\\\ & \\geq & \\frac{5}{2 } \\left [ \\frac{1}{5 } \\left(\\frac{d_t(u , u')}{\\|f^{-1}\\|_{\\mathrm{lip } } } + \\eta\\,d_t(u , v ) + \\eta'd_t(u',v')\\right)\\right]^p\\label{eq:2/5}\\\\ & \\geq & 2 \\left [ \\frac{1}{5 } \\left(\\frac{d_{t_{\\mathbb r}}\\left((u , v,\\eta),(u',v',\\eta')\\right)}{\\|f^{-1}\\|_{\\mathrm{lip}}}\\right)\\right]^p\\nonumber,\\end{aligned}\\ ] ] where in   we used the convexity of the function @xmath730 , which implies that for all @xmath731 we have @xmath732 .",
    "if @xmath721 is a strict descendant of @xmath85 then @xmath733 is given by  .",
    "denote this distance by @xmath397 , and for the sake of simplicity write @xmath734 . since @xmath735^p + [ \\eta ' d_t(u',v')]^p\\ge 2^{1-p}\\left[\\eta\\ , d_t(u",
    ", v)+\\eta ' d_t(u',v')\\right]^p,\\ ] ] we may assume that @xmath736 .",
    "in this case @xmath737 the remaining case is when @xmath726 and @xmath738 .",
    "but then @xmath739 , and the required lower bound is trivial .",
    "we have thus proved that @xmath740 , as required .    _",
    "the above lemma does _ not _ hold if we allow `` steiner '' nodes in the tree @xmath20 . to observe this ,",
    "consider the subset @xmath741 of leaves of a complete binary tree of height @xmath742 , and let @xmath261 be the root of @xmath743 .",
    "then it is not difficult to see that @xmath744 ( independent of @xmath742 ) , while @xmath745 by bourgain s theorem for @xmath743 @xcite . _",
    "we now replace any weak prototype by an `` equivalent '' prototype with height ratio 1 .",
    "[ lem : idealtrans ] let @xmath679 be any finite metric tree . then there exists a finite , unweighted metric tree @xmath746 with height @xmath681 for some @xmath608 such that @xmath747 for any @xmath748 .",
    "furthermore , if @xmath20 is an @xmath680-weak prototype with height ratio @xmath625 , then @xmath702 is an unweighted @xmath749-weak prototype with height ratio 1 .",
    "fix a root @xmath261 of @xmath20 .",
    "since @xmath20 is finite , by rescaling and paying an arbitrarily small distortion , we may assume that all edge lengths are integral .",
    "for every node @xmath750 , let @xmath751 .",
    "we now define a tree @xmath752 as follows . for every leaf @xmath753 ,",
    "define a new node @xmath754 , and create a new edge @xmath755 of length @xmath756 .",
    "thus the length of every root - leaf path in @xmath752 is exactly @xmath681 . to see that @xmath757 , let @xmath709 be an embedding of @xmath20 , and",
    "let @xmath758 be a system of disjointly supported vectors each of whose support is disjoint to @xmath414 .",
    "one can extend the embedding by defining @xmath759 so that @xmath760 .",
    "observe that if @xmath20 had height ratio @xmath625 , then the length of any root - leaf path in @xmath752 has increased by at most a factor @xmath761 over its previous length in @xmath20 .",
    "we pass from @xmath752 to @xmath762 using lemma [ lem : rtree ] , and then to @xmath702 by simply taking the vertex set of @xmath702 to be @xmath763 .",
    "we define @xmath764 as the _ unweighted _ shortest path metric on @xmath20 .",
    "then @xmath765 embeds isometrically into @xmath762 . hence @xmath766 .",
    "furthermore , every root - leaf path in @xmath702 has length precisely @xmath681 .",
    "finally , observe that if @xmath20 was @xmath680-weak with height ratio @xmath625 , then @xmath702 is an unweighted @xmath767-weak prototype ( because some root - leaf path from @xmath20 might have increased by a factor of at most @xmath761 ) with height ratio @xmath98 .",
    "the following corollary follows from theorem  [ thm : unweightedweak ] and lemma  [ lem : idealtrans ] .",
    "[ coro : weak lower ] let @xmath679 be an @xmath680-weak prototype with height ratio @xmath625 , then for any @xmath616 , @xmath768 where @xmath769 and @xmath702 is the associated unweighted prototype from lemma [ lem : idealtrans ] .",
    "the corollary follows by applying theorem [ thm : unweightedweak ] to @xmath702 and using the relationship between markov convexity and distortion from lemma [ lem : mcdist ] , along with the known markov convexity of @xmath14 spaces ( remark [ rem : superreflexive ] ) .",
    "recall that in theorem [ thm : upper - binary ] , we showed that for any tree @xmath20 and @xmath682 , we have , for every @xmath770 , @xmath771 here , we will show that this dependence on @xmath102 can not be improved by exhibiting a family @xmath772 of metric trees with @xmath773 and such that for any fixed @xmath774 , @xmath775    let @xmath20 be a rooted ( unweighted ) graph - theoretic tree . for any root leaf path @xmath776 , we define the _ downward degree sequence _ @xmath777 where @xmath778 is the number of children of @xmath86 in @xmath20 .",
    "we will say that @xmath20 is a _ spherically symmetric tree ( sst ) _",
    "if for any pair of root - leaf paths @xmath779 we have @xmath780 . clearly any such tree can be completely specified by giving the degree sequence of a root - leaf path ( see figure [ fig : sst ] ) .",
    "* definition of the cantor trees .",
    "* we now describe a family of downward degree sequences inductively . for two sequences",
    "@xmath781 we define @xmath782 as their concatenation . for every @xmath783",
    ", we use @xmath784 to denote a sequence of @xmath205 ones .",
    "now define @xmath785 and inductively @xmath786 hence the first few sequences are @xmath787 . to make these proper downward degree sequences ,",
    "we define @xmath788 to be @xmath789 except with the last element changed from @xmath77 to @xmath790 . finally , we let @xmath791 be the unique sst with downward degree sequence @xmath788 .",
    "we call these _ cantor trees _ because the patterns of @xmath77 s resemble finite approximations to the middle - thirds cantor set .",
    "it is clear that @xmath792 and that @xmath793 .",
    "the next two lemmas are somewhat less obvious .    for every @xmath794 ,",
    "the tree @xmath791 is a @xmath795-weak prototype .",
    "we need to show that every root - leaf path in @xmath791 is degree-2 @xmath795-weak .",
    "fix any such path @xmath272 .",
    "it is easy to see that the maximal straits in @xmath272 are given by consecutive sequences of @xmath98 s in the downward degree sequence of @xmath791 : a sequence of @xmath25 consecutive @xmath98 s refers to a strait of length @xmath491 .",
    "therefore for every @xmath796 , there are @xmath797 disjoint maximal straits of length @xmath798 in @xmath272 .",
    "the question becomes how small we need to choose @xmath742 before @xmath799 clearly we must have @xmath800 , hence @xmath791 is a @xmath801-weak prototype for @xmath802    combining this with theorem [ thm : unweightedweak ] yields the following .",
    "for every @xmath75 , @xmath803 .",
    "the following claim completes the proof of .",
    "[ lem : nobin ] for every fixed @xmath770 , @xmath804 as @xmath805 .",
    "the idea of the proof is simple : if the edges of @xmath743 are mapped far apart in @xmath791 , then we can use the diameter of @xmath791 to upper bound the size of @xmath742 . otherwise , if the edges are mapped close together , then essentially the entire image of @xmath743 must lie inside some copy of @xmath806 in @xmath791 .",
    "this is because there is a `` buffer '' of length @xmath807 between copies of @xmath806 in @xmath791 which contains no branch points .",
    "an edge of @xmath743 must stretch over this buffer if the image of @xmath743 spans multiple copies of @xmath806 .    for our induction",
    ", it will be easier to bound @xmath808 for a slightly different family of trees @xmath809 .",
    "let @xmath809 be the tree @xmath791 with the following two additions :    1 .",
    "we append a path @xmath810 of length @xmath811 to the root of @xmath791 .",
    "we append a path of length @xmath811 to every leaf of @xmath791 .",
    "we will use @xmath812 to refer to this family of paths .",
    "clearly @xmath813 .",
    "we may assume that @xmath794 is sufficiently large with respect to @xmath814 .",
    "let @xmath815 be a bi - lipschitz embedding of @xmath743 into @xmath809 with distortion @xmath816 .",
    "assume , for the sake of contradiction , that @xmath817 .    clearly",
    "@xmath818 since @xmath819 , we conclude that @xmath820 where @xmath821 is the set of edges in @xmath743",
    ".    we will now show that implies that @xmath822 is contained completely inside an isometric copy of @xmath823 . by induction",
    ", this will be a contradiction and finish the proof .",
    "let us consider a `` top - down '' decomposition of @xmath809 into disjoint pieces . from the root downward , we see @xmath810 , then a copy of @xmath791 , then the family of paths @xmath824 .",
    "if we also break @xmath791 into constituent pieces , we see :    1 .",
    "@xmath810 , 2 .   a copy @xmath806 , 3 .",
    "a family of paths @xmath825 of length @xmath807 connected to the leaves of ( 2 ) , 4 .   copies of @xmath806 connected to every endpoint of the paths from ( 3 ) , 5 .",
    "the family of paths @xmath824 connected to the leaves of the copies of @xmath791 from ( 4 ) .",
    "we now define a family of disjoint sub - trees of @xmath809 each of which is an isometric copy of @xmath823 . the first copy @xmath826 consists of the bottom @xmath827 nodes of @xmath810 , the copy of @xmath806 from ( 2 ) above , and the top @xmath827 nodes of each path @xmath828 ( from ( 3 ) ) .",
    "the other copies are indexed by paths @xmath828 . for each such path",
    ", we construct @xmath829 using the bottom @xmath827 nodes of @xmath63 , the copy of @xmath806 from ( 4 ) connected to the bottom of @xmath63 , and the top @xmath827 nodes of each path from @xmath824 connected to this copy of @xmath806 .",
    "we claim that there exists some @xmath830 for which @xmath831 we now prove the most difficult case ; the other cases are similar .",
    "suppose , for the sake of contradiction , there exist @xmath832 for which @xmath833 and @xmath834 for some @xmath828 . by",
    ", every edge of @xmath743 has length at most @xmath835 , hence there must be some node @xmath836 for which @xmath837 lies in the middle @xmath827 nodes of @xmath63 . in particular , @xmath838 for every @xmath839 , since @xmath840 .",
    "furthermore , @xmath841 . on the other hand , @xmath842 for @xmath843 .",
    "but we have @xmath844 let @xmath845 . since , in particular @xmath846 , the above considerations yield @xmath847 observe that the inequality @xmath848 hold as long as @xmath849 and @xmath850 , but it is easy to check that for @xmath851 , we have @xmath852 ( using ) , yielding a contradiction .",
    "this completes the proof .",
    "[ rem : rtree ] observe that the two point space @xmath853 with , say , @xmath854 is a tree metric for which @xmath855 for every @xmath75 . on the other hand , it is easy to see that @xmath856 ) = \\infty$ ] for every @xmath857 , thus in general @xmath858 for @xmath857 . for @xmath859 , the relationship is less clear , though we suspect that a similar phenomenon holds in this case .",
    "a possible example for which @xmath860 is when @xmath861 is the cantor tree @xmath791 with every maximal strait replaced by a single long edge .",
    "using techniques similar to lemma [ lem : nobin ] , one might show that @xmath862 as @xmath863 while @xmath864 .",
    "we do not pursue this line of reasoning further in the present work .",
    "in this section we will continue to use the notation of section  [ section : coloring ] . moreover ,",
    "unless explicitly stated otherwise , all paths will be assumed to be monotone .",
    "many of the concepts and definitions used in this section were introduced in section  [ sec : def weak ] , so we suggest that the reader will be familiar with section  [ sec : def weak ] before reading the present section .        before proving theorem  [ thm : markov main ] we make some observations . by lemma  [ lem : mcdist ] for every @xmath867 and every two metric spaces @xmath0 and @xmath1 , @xmath868 .",
    "since @xmath14 is @xmath869 uniformly convex , remark  [ rem : superreflexive ] implies that @xmath870 .",
    "this observation , together with theorem  [ thm : matousek ] and lemma  [ lem : rtree ] , implies that @xmath871^{\\min\\left\\{\\frac{1}{p},\\frac12\\right\\}}\\right).\\ ] ]    thus , using corollary  [ coro : weak lower ] , the proof of theorem  [ thm : markov main ] will be complete if show that if a metric tree @xmath15 does not admit any @xmath83-strong coloring then there exists a subtree of @xmath20 which is @xmath872-weak prototype with height ratio @xmath873 .",
    "it is clearly enough to prove this for small enough @xmath83 , so we assume in what follows that @xmath874 ( the proof below yields much better constants , but we chose this rough bound to simplify the ensuing exposition ) .",
    "the proof of this assertion is analogous to the proof of theorem  [ thm : upperb ] , where `` strong '' colorings replace `` good '' colorings , and weak prototypes take the place of complete binary trees . since the structure of a weak prototype is not as cleanly recursive as that of a complete binary tree , there are some inevitable added complications .",
    "the argument will be broken down into several steps .",
    "[ lem : cluster ] fix @xmath878 , @xmath82 , and denote @xmath879 .",
    "assume that @xmath84 are such that the path @xmath143 is @xmath880-weak .",
    "then at least an @xmath881-fraction of the length of @xmath143 is covered by @xmath83-clusters of length at least @xmath882 . moreover , at least an @xmath881-fraction of the length of @xmath143 is covered by edge - disjoint @xmath83-clusters of length between @xmath883 and @xmath884 .",
    "fix @xmath84 and denote @xmath885 and @xmath886 .",
    "let @xmath163 be the set of maximal @xmath83-clusters ( with respect to inclusion ) contained in @xmath272 . in what follows , for a @xmath83-cluster @xmath887 we write @xmath888 .",
    "define @xmath889 .",
    "for every @xmath890 , since @xmath891 is a maximal @xmath83-cluster , there is an edge @xmath892 which is incident with an edge in @xmath891 , such that @xmath893 .",
    "note that for every edge @xmath894 , @xmath895 .",
    "now , @xmath896 using the fact that the path @xmath272 is @xmath880-weak , we see that @xmath897 recalling that @xmath879 , we see that @xmath898 as required .",
    "the final assertion of lemma  [ lem : cluster ] is simply the fact that for any weighted path @xmath659 such that for each @xmath899 we have @xmath900 , but @xmath901 , there are indices @xmath902 such that for all @xmath903 we have @xmath904 $ ] .",
    "indeed , let @xmath905 be the first index such that @xmath906",
    ". then @xmath907 . continuing inductively as long as the length of the remaining path is at least @xmath908 we find @xmath909 such that for @xmath910 we have @xmath911 $ ] , and @xmath912 .",
    "the required result follows by replacing @xmath913 with @xmath742 , which increases the length of the final segment by at most @xmath908 .    in order to proceed",
    "we need to generalize the notions of @xmath121-good and @xmath83-strong colorings .",
    "a coloring @xmath80 will be called @xmath669-strong if it is monotone , and for every @xmath914 @xmath915 note that we can always assume that @xmath916 . using the terminology of section  [ section : coloring ]",
    ", an @xmath121-good coloring is the same as an @xmath917-strong coloring , and a @xmath83-strong coloring is the same as a @xmath918-strong coloring .",
    "thus the following lemma is a generalization of lemma  [ lem : relation ] .",
    "the proof is a slight modification of the proof of lemma  [ lem : relation ] .",
    "let @xmath922 be an @xmath669-strong coloring , and denote @xmath923 .",
    "we shall show that for every @xmath141 $ ] and @xmath84 , the total length of the monochromatic segments of length at least @xmath924 on the path @xmath143 satisfies @xmath925    there are points @xmath926 , ordered consecutively ( from @xmath85 to @xmath86 ) on the path @xmath143 , such that the color classes of length at least @xmath87 on the path @xmath143 are precisely the intervals @xmath927\\}_{j=1}^m$ ] .",
    "denote for the sake of simplicity @xmath928 and @xmath929 , and define @xmath930 by @xmath931 . since the coloring is @xmath669-strong ,",
    "we know that @xmath932 . by the definition of @xmath933",
    "we are also assured that @xmath934 .",
    "if @xmath935 then inequality   holds vacuously , so we assume that @xmath936 . arguing inductively as in the proof of lemma  [ lem : relation ] we see that @xmath937^\\theta\\cdot\\left [ d_t(b_j , a_{j+1})\\right]^{1-\\theta}\\\\ \\label{eq : jensen}&\\ge & d_t(u , v)-(m+1)\\left(\\frac{\\alpha } { \\delta } \\right)^{\\theta}\\left[d_t(u , v)\\right]^\\theta\\left(\\frac{1}{m+1}\\sum_{j=0}^m d_t(b_j , a_{j+1})\\right)^{1-\\theta}\\\\ & = & \\nonumber d_t(u , v)-(m+1)\\left(\\frac{\\alpha } { \\delta } \\right)^{\\theta}\\left[d_t(u , v)\\right]^\\theta\\left(\\frac{(1-\\beta)d_t(u , v)}{m+1}\\right)^{1-\\theta}\\\\ & = & \\nonumber\\left(1-\\left(\\frac{\\alpha}{\\delta}\\right)^\\theta(m+1)^\\theta(1-\\beta)^{1-\\theta}\\right)d_t(u , v)\\\\ & \\ge & \\label{eq : upper m } \\left(1-\\left(\\frac{\\alpha}{\\delta}\\right)^\\theta\\left(\\frac{\\beta}{\\delta}+1\\right)^\\theta(1-\\beta)^{1-\\theta}\\right)d_t(u , v)\\\\ & \\ge &   \\nonumber \\left(1-\\left(\\frac{\\alpha}{\\delta}\\right)^\\theta\\left(\\frac{2}{\\delta}\\right)^\\theta\\beta^\\theta(1-\\beta)^{1-\\theta}\\right)d_t(u , v ) \\\\",
    "\\label{eq : monotonicity } & \\ge&\\left(1-\\left(\\frac{\\alpha}{\\delta}\\right)^\\theta\\left(\\frac{2}{\\delta}\\right)^\\theta{\\varepsilon}^\\theta(1-{\\varepsilon})^{1-\\theta}\\right)d_t(u , v)\\\\ & \\ge & \\label{eq : numerical theta } \\left(1-\\left(\\frac{\\alpha}{\\delta}\\right)^\\theta\\right)d_t(u , v),\\end{aligned}\\ ] ] where in   we used the concavity of the function @xmath938 , in   we used the fact that @xmath939 , in   we used the fact that the function @xmath940 is decreasing on @xmath941 $ ] and that @xmath942 ( which follows from the definition of @xmath943 and the fact that @xmath944 ) , and in   we used the elementary inequality @xmath945 , which is equivalent to @xmath946}$ ] , and this follows from the definition of @xmath943 since @xmath947 .",
    "recall that for @xmath948 a subset @xmath949 of a metric space @xmath6 is an @xmath625-net if for every distinct @xmath950 we have @xmath951 and for every @xmath952 there is @xmath953 with @xmath954 . in what follows",
    "we shall use the following variant of this notion .",
    "[ def : upward ] let @xmath15 be a tree rooted at @xmath261 with edge weights @xmath675 . for @xmath948 we shall call a set @xmath955 an upward @xmath625-net of @xmath20 if for every @xmath950 such that @xmath509 is an ancestor of @xmath956 we have @xmath957 and for every @xmath171 there is @xmath958 such that @xmath959 .",
    "in other words , @xmath949 is an upward @xmath625-net of @xmath20 if and only if for every @xmath171 , @xmath960 is an @xmath625-net in @xmath257 .",
    "the proof is an easy induction on @xmath106 . for @xmath961",
    "the result is trivial .",
    "assume that @xmath962 and let @xmath171 be a leaf of @xmath20 .",
    "let @xmath963 be the father of @xmath86 . by the inductive hypothesis",
    "the tree @xmath964 admits an upward @xmath625-net @xmath965 .",
    "thus there exists @xmath966 such that @xmath967 . if @xmath968 define @xmath969 , which is clearly an upward @xmath625-net in @xmath20 .",
    "otherwise @xmath970 , and since @xmath971 , it follows that @xmath965 is also an upward @xmath625-net in @xmath20 .",
    "[ [ construction - of - a - special - coloring - and - the - proof - of - theoremthmmarkov - main ] ] construction of a special coloring and the proof of theorem  [ thm : markov main ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    our basic strategy is similar to the proof of theorem  [ thm : upperb ] . to emphasize the similarities between the two proofs",
    ", we will use the same notation for the weight functions and the coloring that we construct ( this will not cause any confusion since section  [ sec : binary ] can be read independently of the present section ) . as in the proof of theorem  [ thm : upperb ] we will define a weight function @xmath972 on subtrees of @xmath20 , and a  scale selector \" @xmath973 , which will be used to construct a coloring @xmath81 of @xmath20 .",
    "the fact that @xmath81 is not @xmath83-strong will be used to find an appropriate copy of a weak prototype in @xmath20 .",
    "we begin with some notation .",
    "let @xmath974 be a ( weighted ) path with initial vertex @xmath509 and final vertex @xmath956 , and let @xmath975 be an arbitrary tree with root @xmath956 ( but otherwise disjoint from @xmath974 ) .",
    "for @xmath668 and @xmath976 we define @xmath977 to be the least minimum distance from the root to a leaf in a _ subtree _ @xmath978 which satisfies the following three conditions :    1 .",
    "every non - leaf vertex of @xmath979 has exactly one or two children .",
    "let @xmath272 be a root - leaf path in @xmath979 , and let @xmath980 be the vertices on @xmath272 which are either one of the endpoints of @xmath272 or have @xmath77 children in @xmath979 .",
    "then the path @xmath981 is @xmath669-weak .",
    "3 .   every path from @xmath509 to a leaf of @xmath979 has length at most @xmath982 .",
    "next , we construct a monotone coloring @xmath80 and a  scale selector \" @xmath254 in a similar way to what was done in section  [ sec : binary ] . along the way we will also construct weight functions @xmath983 on subtrees of @xmath20 . as in section",
    "[ sec : binary ] we start by setting @xmath255 and we assume inductively that the construction is done so that whenever @xmath171 is such that @xmath256 is defined , if @xmath85 is a vertex on the path @xmath257 then @xmath258 has already been defined , and for every edge @xmath259 incident to @xmath86 , @xmath260 has been defined .    for",
    "every @xmath984 let @xmath985 be an upward @xmath986-net of @xmath20 .",
    "since @xmath985 is an upward @xmath986-net , for all @xmath987 we are assured that @xmath988 .",
    "we define @xmath989 to be the point in @xmath990 which is furthest away from @xmath404 .",
    "now let @xmath991 be such that @xmath992    take @xmath171 which is the vertex closest to the root @xmath261 for which @xmath256 hasnt yet been defined , and as in section  [ sec : binary ] we set @xmath993 recall that @xmath994 denotes the set of breakpoints of @xmath81 along the path @xmath257 , and that by the inductive hypothesis the path @xmath257 has been entirely colored .",
    "let @xmath975 be a subtree of @xmath20 rooted at @xmath86 .",
    "we shall now define @xmath995 . to this end",
    "define a subset of the path @xmath257 by @xmath996 with this notation we can define @xmath997 in   we extended the definition of @xmath998 to all subtrees of @xmath20 rooted at @xmath86 .",
    "we next choose one of the children of @xmath86 , @xmath999 , for which @xmath266 observe that @xmath1000 is defined for all the children of @xmath86 , since @xmath1001 is a subtree of @xmath20 rooted at @xmath86 ( it is the subtree rooted at @xmath1002 together with the incoming edge @xmath1003 ) .",
    "letting @xmath85 be the father of @xmath86 on the path @xmath257 , we set @xmath267 , and we assign arbitrary new ( i.e. which havent been used before ) distinct colors to each of the edges @xmath268 .    this construction yields a monotone coloring @xmath81 , a function @xmath254 , and weight function @xmath1004 defined on subtrees of @xmath20 . in particular",
    ", we note here that claim  [ claim : g ] still holds true , since its proof only used the fact that @xmath271 was defined as in  , and this formula is identical to the one used in section  [ sec : binary ] .",
    "the following lemma contains the crucial properties of the coloring @xmath81 .",
    "[ lem : crucial coloring ] assume that the above coloring @xmath81 is not @xmath83-strong .",
    "then there exists a sequence of vertices @xmath1005 , ordered down the tree , and a number @xmath976 , such that if we define @xmath1006 by @xmath1007 and @xmath1008 , then the path metric induced by @xmath20 on @xmath974 has the following properties :    1 .   for every @xmath1009",
    "the vertex @xmath1010 is a breakpoint of @xmath81 .",
    "2 .   for every @xmath1009",
    "we have @xmath1011 and @xmath1012 .",
    "3 .   the path @xmath974 is @xmath1013-weak .",
    "4 .   the length of @xmath974 satisfies @xmath1014 $ ] .      with lemma  [ lem : crucial coloring ] at hand ,",
    "the proof of theorem  [ thm : markov main ] is similar to the final step of the proof of theorem  [ thm : upperb ] .",
    "assume that @xmath1015 .",
    "let @xmath1005 be the path constructed in lemma  [ lem : crucial coloring ] , and we shall also use the same @xmath1016 obtained there . observe",
    "that using the notation in   we may assume that @xmath1017 .",
    "indeed , by adding to @xmath974 any additional breakpoint @xmath404 of @xmath81 along @xmath1018 with @xmath1019 and @xmath1020 we do not change the conclusion lemma  [ lem : crucial coloring ] .",
    "for @xmath1021 let @xmath1022 be the child of @xmath1023 along the path @xmath1024 , and denote for the sake of simplicity @xmath1025",
    ". we shall prove by induction on @xmath1026 that the subtree of @xmath20 rooted at @xmath1027 ( i.e. the tree @xmath1028 ) has a further sub - tree @xmath1029 satisfying the following properties .    1",
    ".   every path from @xmath509 to a leaf of @xmath1029 has length at most @xmath1030 .",
    "every non - leaf vertex of @xmath1029 has exactly one or two children .",
    "let @xmath272 be a path from @xmath1027 to a leaf of @xmath1029 , and let @xmath980 be the vertices on @xmath272 which are either one of the endpoints of @xmath272 or have @xmath77 children in @xmath1029 .",
    "then the path @xmath1031 is @xmath1013-weak .",
    "every root - leaf path in @xmath1029 has length at least @xmath1032 .    for @xmath1033",
    "we just take @xmath1034 to be the singleton @xmath1035 , and the fact that the required properties are satisfied is asserted in lemma  [ lem : crucial coloring ] . similarly , for @xmath1036 we let @xmath1037 be the tree consisting of the single edge @xmath1038 which satisfies the required properties due to lemma  [ lem : crucial coloring ] . assuming the existence of @xmath1029 we proceed inductively as follows .",
    "since @xmath1039 is a breakpoint of @xmath81 , the construction of @xmath81 in the proof of theorem  [ thm : upperb ] , and the fact that @xmath1040 , implies that there is a child @xmath1041 of @xmath1039 for which @xmath1042 ( recall that for @xmath963 the tree @xmath237 is the subtree rooted at @xmath85 plus the edge joining @xmath85 and its parent in @xmath20 ) .",
    "now , since @xmath1043 we also know that ( since @xmath1044 ) @xmath1045 . thus by the definition on @xmath998 in   @xmath1046 but , @xmath1029 is a subtree of @xmath1047 in which every non - leaf vertex has two children , for every path from @xmath509 to a leaf of @xmath1029 the path metric induced by @xmath20 on the vertices which are either @xmath509 , or one of the @xmath1010 , or a leaf in @xmath1029 , or have 2 children in @xmath1029 , is @xmath1013-weak , every path from @xmath509 to a leaf of @xmath1029 has length at most @xmath1048 , and the minimal distance from a root to a leaf of @xmath1029 is at least @xmath1032 .",
    "thus the definition of @xmath1049 implies that @xmath1050 .",
    "it follows that @xmath1051 , implying the existence of a subtree @xmath1052 of @xmath1053 , which has the same properties as those stated above for @xmath1029 . joining these two subtrees at @xmath1039 , and adding an edge from @xmath1054 to @xmath1039 we",
    "obtain a subtree @xmath1055 rooted at @xmath1054 with the desired properties .",
    "we recommend that the reader will follow the above construction using a drawing analogous to figure  [ figure : gluing ] .",
    "the tree @xmath752 obtained by joining the edges @xmath1056 to @xmath1057 is a subtree of @xmath20 which is a @xmath1013-weak prototype with height ratio at most @xmath1058 . as explained in the discussion following theorem  [ thm : markov main ] , this completes the proof .      since we are assuming that the coloring @xmath81 is not @xmath83-strong , lemma  [ lem : epsilon delta ] implies that @xmath81 is also not @xmath1059-strong .",
    "thus there exist two vertices @xmath84 such that more than a @xmath1060-fraction of the length of the path joining @xmath85 and @xmath86 is covered by color classes of length less than @xmath1061 .",
    "let @xmath1062 be the breakpoints of the coloring @xmath81 along the path @xmath143 , ordered from @xmath85 to @xmath86 .",
    "we also denote @xmath928 and @xmath1063 .",
    "thus @xmath1064 lemma  [ lem : cluster ] ( with @xmath1065 and @xmath1066 ) implies that there exists a sequence of indices @xmath1067 such that for every @xmath1068 we have @xmath1069 $ ] and every @xmath1070 satisfies @xmath1071 .",
    "moreover , the total length of these  long @xmath1072-clusters \" is @xmath1073 it follows in particular from   that @xmath1074 ( since @xmath1075 ) .",
    "denote @xmath1076 and recall that @xmath1077 is defined by @xmath1007 .",
    "fix @xmath1078 and apply claim  [ claim : g ] to the path @xmath1079 with @xmath1080 ( which we are allowed to do by the definition of @xmath334 ) .",
    "it follows that there exist at least two indices @xmath1081 such that @xmath1082 and @xmath1083 .",
    "now @xmath984 is given by by @xmath1084 .",
    "note that by the definition of @xmath334 this implies that @xmath1085 .",
    "for each point @xmath1086 the vertex @xmath1087 is in @xmath1088 .",
    "since @xmath1089 is @xmath986-separated , it follows that there are at most @xmath1090 possible vertices which could equal @xmath989 .",
    "thus there is a vertex @xmath1091 and a subinterval @xmath1092 of size at least @xmath1093 ( since @xmath1094 ) such that for all @xmath1095 we have @xmath1096 . note that since @xmath1097 for some @xmath1086 , we know that @xmath509 is the point in @xmath990 which is furthest from @xmath404 . since @xmath985 is an upward @xmath986-net , there is a point @xmath1098 .",
    "so , using @xmath1099 , we see that @xmath1100 .",
    "thus @xmath1101 , i.e. @xmath509 is closer to the root than @xmath85 .",
    "consider the path metric induced on the vertices @xmath1102 .",
    "for simplicity of notation we enumerate it down the tree by @xmath1005 .",
    "we bound the length of @xmath974 as follows .",
    "first , @xmath1103 . on the other hand , using   we see that @xmath1104 this also shows that the path @xmath974 is @xmath1013-weak , completing the proof of lemma  [ lem : crucial coloring ] .",
    "m.  bdoiu , j.  chuzhoy , p.  indyk , and a.  sidiropoulos .",
    "low - distortion embeddings of general metrics into the line . in _",
    "stoc05 : proceedings of the 37th annual acm symposium on theory of computing _ , pages 225233 , new york , 2005 .",
    "acm .",
    "j.  fakcharoenphol , s.  rao , and k.  talwar .",
    "a tight bound on approximating arbitrary metrics by tree metrics . in _ proceedings of the 35th annual acm symposium on theory of computing _ , pages 448455 , 2003 .",
    "a.  gupta .",
    "steiner points in tree metrics do nt ( really ) help . in _ proceedings of the twelfth annual acm - siam symposium on discrete algorithms ( washington , dc , 2001 ) _",
    ", pages 220227 , philadelphia , pa , 2001 ."
  ],
  "abstract_text": [
    "<S> we show that an infinite weighted tree admits a bi - lipschitz embedding into hilbert space if and only if it does not contain arbitrarily large complete binary trees with uniformly bounded distortion . </S>",
    "<S> we also introduce a new metric invariant called markov convexity , and show how it can be used to compute the euclidean distortion of any metric tree up to universal factors . </S>"
  ]
}