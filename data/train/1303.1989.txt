{
  "article_text": [
    "imposing constraints on a hamiltonian system is routinely done using dirac s theory  @xcite . the key point is to compute the matrix @xmath0 of the poisson brackets between two constraints ( i.e. , whose elements are @xmath1 where @xmath2 are the constraints ) and to invert this matrix . under this hypothesis",
    ", it has been shown that the following bracket , called dirac bracket , @xmath3 where @xmath4 , is a poisson bracket .",
    "the technical difficulty is to prove the jacobi identity , and this has been done by dirac in ref .",
    "@xcite , and his proof relies heavily on the invertibility of @xmath0 ( see eq .  ( 59 ) which results from eq .",
    "( 35 ) in ref .",
    "@xcite , or appendix b in ref .",
    "@xcite ) . as a consequence of the fact that @xmath5 is the inverse of @xmath0 , the constraints are casimir invariants , i.e. , @xmath6 for any observable @xmath7 .",
    "what if the matrix @xmath0 is not invertible ?",
    "this could happen for instance if there is an odd number of constraints ( since @xmath0 is antisymmetric ) or if the constraints are reducible or redundant  @xcite .",
    "the purpose of the present article is to address this question .",
    "our main result is to show that the jacobi identity is a property which results from imposing that the constraints are casimir invariants , regardless of the invertibility of @xmath0 .",
    "this result holds for canonical or non - canonical hamiltonian systems ( see refs .",
    "@xcite for an introduction to non - canonical hamiltonian systems ) .",
    "we notice that the proof we provide shows the validity of the jacobi identity everywhere in phase space , and not just on the surface defined by the constraints as found in refs .",
    "@xcite .",
    "we consider a finite dimensional hamiltonian system whose variables are denoted @xmath8 .",
    "it is given by a hamiltonian @xmath9 , a scalar function of the variables , and a poisson bracket written as @xmath10 where the poisson matrix @xmath11 is such that the bracket  ( [ eq : pb ] ) is antisymmetric and satisfies the jacobi identity [ in addition to the bilinearity and the leibnitz rule which are already ensured by the form of the bracket  ( [ eq : pb ] ) ] .",
    "we impose a set of @xmath12 constraints @xmath13 for @xmath14 which are scalar functions of the variables @xmath15 .",
    "we consider brackets of the form  ( [ eq : db ] ) with an antisymmetric matrix @xmath5 which is not necessarily the inverse of @xmath0 ( and consequently these brackets are not not poisson brackets in general ) .",
    "the matrix associated with the bracket  ( [ eq : db ] ) is given by  @xcite @xmath16 where the matrix @xmath17 has elements @xmath18 .",
    "the matrix @xmath5 is chosen such that the constraints are casimir invariants .",
    "this leads to the following condition on @xmath5  : @xmath19 where @xmath20 is the @xmath21 identity matrix and @xmath22 .",
    "a first situation is when @xmath0 is invertible , and hence a possible solution to eq .",
    "( [ eq : ford ] ) is @xmath4 .",
    "this is the main case considered in the literature , for which the jacobi identity is proved in order to ensure that the dirac bracket is a poisson bracket  @xcite .",
    "however in many instances , the matrix @xmath0 is not invertible , and , to the best of our knowledge , there is no proof of the jacobi identity in these cases which holds everywhere in phase space .",
    "there are two properties which are strongly dependent on the particular choice of matrix @xmath5 , which are @xmath23 the jacobi identity and @xmath24 the fact that the constraints are casimir invariants .",
    "the purpose of this article is to show that @xmath24 implies @xmath23 , or in other words that imposing that the constraints are casimir invariants , i.e. , eq .",
    "( [ eq : ford ] ) , is sufficient to ensure that the dirac bracket  ( [ eq : db ] ) is a poisson bracket .",
    "the proof is done in sec .",
    "[ sec : ji ] . in sec .",
    "[ sec : examples ] we illustrate the computation of the dirac bracket in cases where @xmath0 is not invertible , with two examples : a finite - dimensional hamiltonian system with an odd number of constraints , and the vlasov - poisson reduction from vlasov - maxwell equations .    before going into the proof of the jacobi identity",
    ", we would like to address two questions :    \\1 ) does the jacobi identity for the bracket  ( [ eq : db ] ) imply that the constraints are casimir invariants , i.e. , does @xmath23 implies @xmath24 ?",
    "the answer is no , and we provide a counter example below . consider a poisson matrix @xmath25 written in block form as @xmath26 where @xmath0 and @xmath27 satisfy individually the jacobi identity so that the matrix @xmath25 too .",
    "the bracket  ( [ eq : db ] ) is characterized by a matrix @xmath28 for @xmath29 . assuming that @xmath0 is invertible , we choose @xmath30 so that @xmath31 which satisfies the jacobi identity inherited from @xmath0 . in order to have the constraints as casimir invariants",
    ", @xmath32 must vanish .",
    "therefore the bracket  ( [ eq : db ] ) satisfies the jacobi identity in this case , but does not have the constraints @xmath33 ( where @xmath34 is the number of columns of @xmath0 ) as casimir invariants .",
    "\\2 ) given that eq .",
    "( [ eq : ford ] ) might have more than one solution , does it lead to different expressions for the dirac bracket ?",
    "the answer is no .",
    "we consider @xmath5 a solution of eq .",
    "( [ eq : ford ] ) .",
    "we notice that any matrix @xmath35 with @xmath36 also satisfies eq .",
    "( [ eq : ford ] ) .",
    "the dirac bracket is obtained from the dirac projector  @xcite @xmath37 , i.e. , @xmath38 . if we consider the other projector associated with @xmath39 , i.e. , @xmath40",
    ", then we show that @xmath41 where we use the identity @xmath42 .",
    "this identity ensures that the dirac bracket is unique , even if there might be more than one solution to eq .",
    "( [ eq : ford ] ) .",
    "a proof of a weak version of the jacobi identity , i.e. , the validity of the jacobi identity on the surface defined by the constraints , has been detailed , e.g. , in refs .",
    "it is based on showing that @xmath43 where @xmath44 in order to deduce that @xmath45 here we show that the jacobi identity holds everywhere in phase space , i.e. , the weak equality can be made a strong one , i.e. , @xmath46 as a consequence , even in the case where the matrix @xmath0 is not invertible , the dirac bracket  ( [ eq : db ] ) [ if it can be constructed using eq .",
    "( [ eq : ford ] ) ] is a poisson bracket .",
    "first we perform a local change of coordinates such that the new variables are the constraint functions .",
    "this can be done at least locally under the assumption of the change of coordinates . in other terms , we assume that @xmath47 for @xmath48 $ ] .",
    "we assume that @xmath25 satisfies the jacobi identity . in the variables",
    "@xmath49 the poisson matrix is expressed by blocks @xmath50 the poisson matrix associated with the bracket  ( [ eq : db ] ) is given by @xmath51 we assume that @xmath5 is chosen such that the constraints are casimir invariants of @xmath52 .",
    "this condition becomes : @xmath53    the jacobi identity for @xmath25 translates into four sets of equations @xmath54 , \\label{eq : jj1}\\\\ & & c_{jl}\\nabla_l b_{ki}-c_{il}\\nabla_l b_{kj}+b_{li}\\partial_l b_{kj}-b_{lj}\\partial_l b_{ki}+b_{kl}\\nabla_l c_{ij}\\nonumber\\\\ & & \\qquad \\qquad \\qquad + \\bar{j}_{kl}\\partial_l c_{ij}=0\\quad\\mbox { for } i , j\\in [ 1,m ] \\mbox { and } k\\in [ 1,n - m ] , \\label{eq : jj2}\\\\ & & b_{jl}\\nabla_l b_{ki}-b_{kl}\\nabla_l b_{ji}+\\bar{j}_{jl}\\partial_l b_{ki}-\\bar{j}_{kl}\\partial_l b_{ji}+c_{il}\\nabla_l \\bar{j}_{jk } \\nonumber\\\\ & & \\qquad \\qquad \\qquad -b_{li}\\partial_l \\bar{j}_{jk}=0 \\quad \\mbox { for } i\\in [ 1,m ] \\mbox { and } j , k\\in[1,n - m ] , \\label{eq : jj3}\\\\ & & b_{il}\\nabla_l \\bar{j}_{jk}+\\bar{j}_{il}\\partial_l \\bar{j}_{jk } + \\circlearrowleft_{(ijk)}=0\\quad\\mbox { for } i , j , k\\in[1,n - m ] , \\label{eq : jj4}\\end{aligned}\\ ] ] where @xmath55 designates the terms obtained by circular permutations of the indices @xmath56 , @xmath57 and @xmath58 .",
    "so when the index @xmath59 is involved with @xmath60 , the implicit sum runs from @xmath61 to @xmath34 .",
    "when it is involved with @xmath62 , the implicit sum runs from @xmath61 to @xmath63 .",
    "given eqs .",
    "( [ eq : cas1])-([eq : cas2 ] ) , the jacobi identity for @xmath52 reduces to @xmath64 the aim is to use eqs .",
    "( [ eq : jj1])-([eq : jj4 ] ) together with eq .",
    "( [ eq : cas2 ] ) in order to prove eq .",
    "( [ eq : jjstar ] ) .",
    "equation  ( [ eq : jjstar ] ) can be decomposed into three sets of terms  : @xmath65 here we notice that all indices @xmath66 , @xmath67 , @xmath68 belong to @xmath69 $ ] . using eq .",
    "( [ eq : jj4 ] ) , the @xmath70 terms can be rewritten as @xmath71 by rewriting @xmath72 using eq .",
    "( [ eq : jj3 ] ) , a cancellation is obtained from eq .",
    "( [ eq : cas2 ] ) , and the @xmath70 terms are rewritten as @xmath73 by noticing a cancellation in the terms @xmath74 in @xmath70 and @xmath75 ( using a circular permutation of the indices @xmath56 and the antisymmetry of @xmath5 ) , we obtain @xmath76    concerning the @xmath77 terms , we decompose them into two parts  : @xmath78 the second term of @xmath79 is rewritten as @xmath80 using a circular permutation of the indices @xmath56 .",
    "therefore , we have @xmath81 where we have used the antisymmetry of @xmath5 . from eq .",
    "( [ eq : jj2 ] ) , @xmath79 is rewritten as @xmath82 from eq .",
    "( [ eq : cas2 ] ) and using a circular permutation on the indices @xmath56 , the first line of the previous equation cancels with the @xmath83 terms in eq .",
    "( [ eq : st ] ) . concerning the fourth term in eq .",
    "( [ eq : u ] ) , we show that @xmath84 this property results from differentiating @xmath85 with respect to @xmath86 together with eq .",
    "( [ eq : cas2 ] ) and the antisymmetry of @xmath5 . using a circular permutation of @xmath56 these terms",
    "cancel with the @xmath87 terms of eq .",
    "( [ eq : st ] ) .    after these steps",
    ", the jacobi identity is rewritten as @xmath88 next the strategy is to get rid of the @xmath89 terms . in order to do this",
    ", we insert @xmath90 terms through a @xmath91 coefficient in the first term of the previous equation , i.e. , inserting @xmath92 . from the identity @xmath93 which is obtained by differentiating eq .",
    "( [ eq : cas2 ] ) with respect to @xmath86 ( and using the antisymmetry of @xmath5 and @xmath94 , the first term in eq .",
    "( [ eq : stu ] ) is rewritten as @xmath95 from eq .",
    "( [ eq : jj1 ] ) we replace @xmath96 by @xmath97 .",
    "the first term becomes @xmath98 from the equation @xmath99 [ see eq .",
    "( [ eq : cas2 ] ) ] we see that the previous term cancels with the second term in eq .",
    "( [ eq : stu ] ) , still using a circular permutation of the indices @xmath56 . in a similar way , the second term in eq .",
    "( [ eq : last ] ) vanishes by inserting @xmath100 .",
    "consequently , we have proved the jacobi identity for the bracket  ( [ eq : db ] ) with eqs .",
    "( [ eq : cas1])-([eq : cas2 ] ) , i.e. , @xmath101",
    "first we describe a rather trivial example in order to illustrate the method .",
    "we consider the following poisson matrix @xmath102 which corresponds to the poisson bracket @xmath103 we impose three constraints @xmath104 for @xmath105 .",
    "the associated operator @xmath17 is given by @xmath106 the matrix @xmath0 is a @xmath107 antisymmetric , so it is not invertible .",
    "its expression is @xmath108 the following matrix @xmath5 satisfies eq .",
    "( [ eq : ford ] )  : @xmath109 the solution of eq .",
    "( [ eq : ford ] ) is not unique , but all solutions lead to the same dirac bracket with poisson matrix given by eq .",
    "( [ eq : jjstar ] )  : @xmath110 which corresponds to the dirac bracket @xmath111      the second example concerns the vlasov - poisson reduction from the vlasov - maxwell equations .",
    "the field variables @xmath112 where @xmath113 , and the equations of motion are @xmath114 where @xmath115 .",
    "the poisson bracket is given by @xmath116 where @xmath117 is the functional derivative of the functional @xmath118 with respect to the field variables @xmath119 .",
    "the poisson matrix is given by ( see refs .",
    "@xcite ) @xmath120 & -\\partial_{\\bf v } f & 0\\\\ -f\\partial_{\\bf v } & 0 & \\delta({\\bf v})\\nabla \\times \\\\ 0 & -\\delta({\\bf v } ) \\nabla \\times   & 0 \\end{array}\\right),\\ ] ] where the small bracket @xmath121 $ ] is given by @xmath122=\\nabla f\\cdot \\partial_{\\bf v}g-\\partial_{\\bf v}f\\cdot \\nabla g+{\\bf b}\\cdot(\\partial_{\\bf v}f\\times\\partial_{\\bf v}g),\\ ] ] where @xmath60 ( resp .",
    "@xmath123 ) is the partial derivative operator with respect to @xmath124 ( resp .",
    "@xmath125 ) .    in order to obtain the vlasov - poisson equations from the vlasov - maxwell equations we impose the following constraints : @xmath126({\\bf x})=(\\nabla \\times { \\bf e } , { \\bf b}-{\\bf b}_0({\\bf x})),\\ ] ] where @xmath127 is a non - uniform background magnetic field .",
    "the operators @xmath17 is given by @xmath128 the operator @xmath0 is given by @xmath129 the operator @xmath0 is not invertible ; however , the dirac procedure still applies with an appropriate choice for @xmath5 given by @xmath130 so that eq .",
    "( [ eq : ford ] ) is satisfied .",
    "we notice that @xmath131 but @xmath132 .",
    "this is due to the fact that @xmath133 is a casimir invariant of @xmath25 .    as a result",
    ", the poisson operator of the vlasov - poisson equations is given by @xmath134 & -\\nabla \\delta^{-1 } \\nabla \\cdot \\partial_{\\bf v}f & 0\\\\ -\\nabla \\delta^{-1 } \\nabla \\cdot(f \\partial_{\\bf v } ) & 0 & 0\\\\ 0 & 0 & 0 \\end{array}\\right).\\ ] ] it leads to the expression of the poisson bracket  @xcite , @xmath135.\\end{aligned}\\ ] ] in the case of the constraints given by eq .",
    "( [ eq : constvm ] ) , one of the constraints , @xmath136 , is already a casimir invariant of the vlasov - maxwell bracket , and hence a first - class constraint .",
    "this kind of redundancy is a source for the non - invertibility of the matrix @xmath0 . in the present example",
    ", we eliminate this redundancy by modifying the set of constraints  ( [ eq : constvm ] ) , removing the divergence of @xmath137 , i.e. , we consider the following constraints  : @xmath138({\\bf x})=(\\nabla \\times { \\bf e } , { \\cal p}({\\bf b}-{\\bf b}_0({\\bf x}))),\\ ] ] where @xmath139 is the projector on the solenoidal part given by @xmath140 .",
    "using similar calculations as above , we find @xmath141 and @xmath0 remains unchanged and is given by eq .",
    "( [ eq : cvm ] ) . the matrix @xmath5 given by eq .",
    "( [ eq : dvm ] ) satisfies @xmath142 .",
    "we have eliminated some redundancy at the origin of the non - invertibility of @xmath0 . as we shall see below",
    ", this kind of redundancy is not an issue in the proposed approach to compute the dirac bracket .",
    "we consider an ensemble of @xmath34 constraints @xmath143 of which the first @xmath144 ones are casimir invariants of the original poisson bracket ( a particular family of first - class constraints ) .",
    "the matrix @xmath0 is written as @xmath145 where @xmath32 is assumed to be invertible . given that @xmath146 for @xmath147 are casimir invariants , @xmath148 where @xmath149 is the matrix of the derivatives of @xmath150 with respect to the phase space variables .",
    "it is straightforward to show that any matrix of the form @xmath151 satisfies eq .",
    "( [ eq : ford ] ) . therefore in the definition of the constraints",
    "there is no need to worry about possible combinations giving rise to casimir invariants of the original poisson bracket .",
    "notice that if some of the constraints are first - class but not casimir invariants , this might lead to some inconsistencies in eq .",
    "( [ eq : ford ] ) like the ones in refs .  @xcite .",
    "another case of redundancy is when one ( or several ) constraints can be obtained from the other constraints .",
    "for instance , we assume that one constraint @xmath152 is dependent of the other constraints , i.e. , @xmath153 . in this case",
    ", the usual dirac s procedure can not be carried out since the matrix @xmath0 is not invertible .",
    "this matrix is given by @xmath154 where @xmath155 and the coefficients of @xmath32 are @xmath156 for @xmath157 .",
    "in fact the vector @xmath158 where @xmath159 , belongs to the kernel of @xmath0 .",
    "we assume that @xmath32 in invertible .",
    "then the following matrix @xmath5 satisfies eq .",
    "( [ eq : ford ] ) @xmath160 where @xmath161 . here",
    "we have used the two properties , @xmath162 and @xmath163 . as a consequence this kind of redundancy",
    "is properly handled using eq .",
    "( [ eq : ford ] ) instead of the too stringent requirement that the matrix @xmath0 is invertible .    in summary the requirement for the existence of a dirac - like bracket  ( [ eq : db ] )",
    "is obtained by imposing eq .",
    "( [ eq : ford ] ) , i.e. , that the constraints are casimir invariants .",
    "it translates into @xmath164 which is a necessary and sufficient condition for the existence of a solution to eq .",
    "( [ eq : ford ] ) .",
    "indeed we denote @xmath165 the rank of @xmath0 and we rewrite it as @xmath166 where @xmath167 is an orthogonal matrix and @xmath32 is invertible . a possible antisymmetric solution to eq .",
    "( [ eq : ford ] ) is given by @xmath168 given the condition  ( [ eq : condker ] ) .",
    "if the specific choice of constraints is such that eq .",
    "( [ eq : condker ] ) is satisfied , then the dirac bracket  ( [ eq : db ] ) can be computed from eq .",
    "( [ eq : ford ] ) , and it is a poisson bracket everywhere in phase space , and not just on the surface defined by the constraints .",
    "otherwise some obstructions are present , and one should modify the set of constraints so as to reduce the kernel of @xmath0 .",
    "this work was supported by the agence nationale de la recherche ( anr gypsi ) and by the european community under the contract of association between euratom , cea , and the french research federation for fusion study .",
    "the views and opinions expressed herein do not necessarily reflect those of the european commission .",
    "cc acknowledges fruitful discussions with p.j .",
    "morrison and with the quipe de dynamique nonlinaire of the centre de physique thorique of marseille ."
  ],
  "abstract_text": [
    "<S> we consider constrained hamiltonian systems in the framework of dirac s theory . </S>",
    "<S> we show that the jacobi identity results from imposing that the constraints are casimir invariants , regardless of the fact that the matrix of poisson brackets between constraints is invertible or not . </S>",
    "<S> we point out that the proof we provide ensures the validity of the jacobi identity everywhere in phase space , and not just on the surface defined by the constraints . </S>",
    "<S> two examples are considered : a finite dimensional system with an odd number of constraints , and the vlasov - poisson reduction from vlasov - maxwell equations . </S>"
  ]
}