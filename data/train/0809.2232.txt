{
  "article_text": [
    "several fields of computational science ( nanotechnology , materials science or biochemistry just to name a few ) would greatly benefit from the possibility of performing simulations of large systems , containing hundreds of thousands of atoms .",
    "conventional electronic structure calculations require the diagonalization of matrices whose size @xmath0 is of the order of the number of electrons in the system .",
    "the @xmath1-scaling cost of this step greatly limits the range of systems which can be tackled by _",
    "ab - initio _ techniques , despite the fast - paced progress in the computational power of modern processors . based on the theoretical foundations of the nearsightedness principle of electronic matter@xcite ,",
    "several techniques have been developed in the last years to avoid the diagonalization step , by directly computing the density matrix of the system using linear scaling algorithms@xcite .",
    "one of the earliest approaches have been to compute the finite temperature density matrix , i.e. the fermi function of the system s hamiltonian , @xmath2 , by decomposing it into easier - to - compute functions of the hamiltonian@xcite , for instance chebyshev polynomials or rational functions . in a recent paper@xcite",
    "we have discussed an exact decomposition of the fermi operator which can be efficiently computed by a combination of polynomial expansion and iterative inversion techniques . in this way",
    ", we achieved an efficient scaling with @xmath3 , the width of the spectrum of the hamiltonian in units of @xmath4 .",
    "this makes the method attractive for applications to metals or low - band gap semiconductors at low electronic temperature . in this short paper",
    "we discuss a number of improvements to this scheme , which further lower the operation count , leading to a scaling @xmath5{\\delta\\epsilon}$ ] , which is , to the best of our knowledge , the lowest so far reported in literature .",
    "we will follow closely the scheme of our previous work@xcite , obtaining analytical estimates for the operation count of the different steps which compose our algorithm , so as to optimize them in order to achieve optimal performance .",
    "our decomposition scheme is based on an exact expansion of the fermi operator , which can be elegantly derived using the grand - canonical formalism@xcite . here",
    "we only report the final result , namely the fact that the finite - temperature density matrix @xmath6 can be written in terms of a sum of complex - valued matrices @xmath7@xcite : @xmath8 equation  ( [ eq : expansion ] ) is exact for any value of @xmath9 , but large values should be chosen so as to allow for simple and economical evaluation of the matrix exponential @xmath10 . here and in the rest of the paper , with no loss of generality , we use a shifted and scaled hamiltonian , i.e. we set the zero of energies at @xmath11 , and measure energy in units of @xmath12 .    the expensive step in applying eq .",
    "( [ eq : expansion ] ) is the inversion of the @xmath7 matrices . in ref.@xcite",
    "we have shown that , for large values of @xmath9 , a @xmath13 exists such that all of the matrices with @xmath14 are almost optimally conditioned , and can be easily inverted by a polynomial expansion .",
    "we have also shown how their overall contribution to the fermi operator can be computed at once , at the same cost of computing a single term , making the computational burden of the method virtually independent of @xmath9 .",
    "we will exploit this property and take often the large @xmath9 limit to derive analytical results .",
    "the remaining , low-@xmath15 matrices are more efficiently treated with an iterative newton inversion scheme@xcite .",
    "overall , the scaling in terms of matrix - matrix multiplications count , which is @xmath16 for standard chebyshev polynomials expansion@xcite , reduces to @xmath17 , and is even lower when fast polynomial summation methods@xcite are used .",
    "a first improvement over the initial formulation of our scheme can be seeked by noting that only the real part of @xmath18 enters the expression for the fermi operator , so that it can be more efficient to write @xmath19,\\text { where } \\quad { { \\ensuremath{{\\bf \\bf n}}}_{{l}}}={{\\ensuremath{{\\bf 1}}}}+ e^{{\\ensuremath{{\\bf h}}}/p}-2 e^ { { \\ensuremath{{\\bf h}}}/2p}\\cos \\pi\\frac{2{l}-1}{2p}. \\label{eq : def - enne}\\ ] ] only real matrices are involved in eq .",
    "( [ eq : def - enne ] ) , leading to substantial savings in memory requirements and computation time .",
    "the inversion of the @xmath20s is the computationally demanding part of this approach ; in fact , if one performs an analysis similar to the one we have carried out in ref.@xcite , the condition number of @xmath20 is found to be approximately @xmath21 .",
    "this is higher than @xmath22 , but decreases more rapidly with @xmath15 .",
    "the low-@xmath15 inverse matrices , which are worse conditioned , can be computed by newton inversion , whose performances are only weakly affected by high condition numbers .    moreover , we take profit of the form of eq .",
    "( [ eq : def - enne ] ) to improve the evaluation of the contribution of the high-@xmath15 matrices , which in our previous work@xcite had a computational cost scaling as @xmath23 .",
    "since we also want to set up an expansion in chebyshev polynomials for @xmath24 , we rewrite @xmath20 it in terms of an auxiliary matrix @xmath25 whose spectrum lies between @xmath26 and @xmath27 : @xmath28 here we have introduced the shifting and scaling parameters @xmath29 and @xmath30 , computed in terms of the extremal values of the hamiltonian spectrum , @xmath31 and @xmath32 .",
    "these parameters can be estimated with a lanczos procedure . alternatively ,",
    "since only a rough estimate is required , one can also perform a test calculation on a smaller , similar system , or use a matrix norm as an upper bound to the spectral radius of @xmath2 .",
    "the inverse @xmath24 can be therefore approximated as a sum of chebyshev polynomials of @xmath25 , @xmath33 , where @xmath34 is the @xmath35-th chebyshev polynomial , and the coefficients @xmath36 can be computed , by straightforward if tedious algebra , and take the values @xmath37 , \\text { where } \\quad b=\\left(e^{{\\mathrm{i}}\\pi\\frac{2{l}-1}{2p}}-z_0\\right)/\\zeta .",
    "\\label{eq : cheb - coefficients}\\ ] ] an upper bound to the error due to truncation of the chebyshev expansion can be estimated from @xmath38 .",
    "this estimate leads to a complex expression , which simplifies considerably if we assume @xmath39 . in this case , by taking the large @xmath9 limit , that the number of terms to be included in order do reach @xmath40 relative accuracy on @xmath24 reads @xmath41 this can be used as a first guess , to be refined by explicitly summing up the @xmath42 as computed from eq .",
    "( [ eq : cheb - coefficients ] ) .    at variance with the polynomial expansion of ref.@xcite",
    ", the operation count is linear with @xmath3 .",
    "this is the same scaling observed when the fermi operator is directly expanded in chebyshev polynomials@xcite .",
    "this analogy is not surprising , since the matrix powers @xmath43 entering the expansion are all independent of @xmath15 , and one could in principle obtain the whole density matrix from a single chebyshev polynomial evaluation , computing the expansion coefficients by summing over all the @xmath36s .     estimated number of required matrix - matrix multiplications needed in order to obtain @xmath40 relative accuracy on the finite temperature density matrix , as a function of the hamiltonian spectum range @xmath3 .",
    "the grid lines correspond to a scaling @xmath44{{\\delta\\epsilon}}$ ] .",
    "we also plot the operation count expected when applying the fast summation methods of ref.@xcite to the standard chebyshev polynomial expansion@xcite ( @xmath45 ) .",
    "data points correspond to a test performed on the _ ab - initio _",
    "hamiltonian for a @xmath46 alloy .",
    "details can be found in  ref.@xcite : @xmath3 for the system is @xmath47  a.u . , and we have performed density matrix calculations at different temperatures , setting the target accuracy to @xmath48 .",
    "next to each point , we also report the relative error on the band structure energy , as computed with our algorithm , taking as reference the value obtained by diagonalization at the same electronic temperature . , scaledwidth=62.4% ]    however , it is more convenient to stop the summation at @xmath49 , so as to reduce @xmath50 , and tackle the remaining terms by iterative inversion .",
    "the practical recipe is therefore to compute the coefficients @xmath51 and @xmath52 , using them to obtain @xmath53 and the contribution to the fermi operator from the `` tail '' of matrices with @xmath54 , respectively . the next step is to compute the terms up to @xmath55 by iterative inversion , a task which becomes much more efficient when a good initial guess for the inverse matrix is available .",
    "such a guess can be obtained by using a finite number of terms in the extrapolation @xmath56^i,\\text { with } \\quad   \\eta=\\cos \\frac{\\pi\\delta{l}}{p}+\\sin\\frac{\\pi\\delta{l}}{p } \\tan\\frac{\\pi\\left(2{l}-1\\right)}{2p}. \\label{eq : newt - extrapolant}\\ ] ] the simplest approximation @xmath57 is already sufficient to guarantee convergence , which is fast and almost independent of the condition number of the @xmath20 s .",
    "the number of multiplications needed to obtain a relative accuracy of @xmath40 on @xmath24 starting from @xmath58 is in fact , in the large @xmath9 limit , @xmath59 one can use @xmath60 , which has been computed with the chebyshev expansion of the tail contribution , as the initial guess for the newton iteration which gives @xmath61 .",
    "the converged @xmath62 is in turn used to evaluate @xmath63 , and so on .    the total number of matrix multiplications involved is easily obtained by combining eq .",
    "( [ eq : cheb - mult ] ) and  ( [ eq : newt - mult ] ) , @xmath64 . by minimizing this quantity the optimal value of @xmath13",
    "is readily found .",
    "the chebyshev polynomials can be computed with fast summation techniques , in which case the operation count for that part becomes @xmath65 . in fig .",
    "[ fig : scaling ] we report our theoretical estimate for @xmath66 as a function of @xmath3 .",
    "the scaling is @xmath5{{\\delta\\epsilon}}$ ] , and the crossover point with fast - summed chebyshev expansion is around @xmath67 , which is easily reached if electronic temperatures of a few hundred k are necessary . in the same figure",
    "we also report the results from some test calculations performed for the hamiltonian of a semimetallic @xmath46 alloy , together with the measured relative error on the total energy , which is always one order of magnitude smaller than the target value enforced when choosing a particular chebyshev expansion length and convergence threshold for the matrix inversion . in order to keep the scheme as simple as possible ,",
    "we have not considered the option of fine - tuning the procedure , which could further reduce the operation count .",
    "first , the operations count for newton inversion  ( [ eq : newt - mult ] ) turns out to be often overestimated , so that hand - tuning @xmath13 can save several multiplications .",
    "higher - order extrapolations are easily obtained ( see appendix  b of ref.@xcite ) , which provide a better starting point for iterative inversion . some preliminary results we obtained performing molecular dynamics with forces computed on the fly with this scheme",
    "show that the number of multiplies needed for iterative inversion can be halved if one uses the inverse _ saved from the previous timestep _ as the initial guess .",
    "in this short paper we have introduced significant improvements to an algorithm that tackles the problem of fermi operator expansion by an hybrid approach based on a combination of polynomial expansion and iterative matrix inversion , which we have presented in a recent paper . with this improved implementation ,",
    "only real - valued matrices are involved , leading to significant savings with respect to the previous , complex - valued formalism .",
    "even more important , the scaling of the operation count with the hamiltonian spectrum width is lowered from @xmath68 to @xmath69{{\\delta\\epsilon}}$ ] , which is extremely appealing for broad - spectrum or low electronic temperature problems .",
    "work in the direction of a practical , linear - scaling implementation of these ideas is in progress@xcite . beside the use of an efficient sparse - matrix algebra library",
    ", subtle issues regarding matrix truncation must be addressed , and several optimizations , such as the extrapolation of @xmath18 from previous timesteps discussed above , can be used to improve the performances of the algorithm .",
    "we would like to thank clotilde cucinotta and giacomo miceli for discussion on @xmath46 system , and luca ferraro and simone meloni for helping us in a preliminary implementation of our method in a tight binding molecular dynamics code .",
    "v.  pan , and j.  reif , `` efficient parallel solution of linear systems , '' in _",
    "stoc 85 : proceedings of the seventeenth annual acm symposium on theory of computing _ , acm press , new york , ny , usa , 1985 , p. 143",
    ", isbn 0 - 89791 - 151 - 2 ."
  ],
  "abstract_text": [
    "<S> in a recent paper we have suggested that the finite temperature density matrix can be computed efficiently by a combination of polynomial expansion and iterative inversion techniques . </S>",
    "<S> we present here significant improvements over this scheme . </S>",
    "<S> the original complex - valued formalism is turned into a purely real one . </S>",
    "<S> in addition , we use chebyshev polynomials expansion and fast summation techniques . </S>",
    "<S> this drastically reduces the scaling of the algorithm with the width of the hamiltonian spectrum , which is now of the order of the cubic root of such parameter . </S>",
    "<S> this makes our method very competitive for applications to _ ab - initio _ </S>",
    "<S> simulations , when high energy resolution is required .    </S>",
    "<S> address = computational science , department of chemistry and applied biosciences , eth zurich , usi campus , via giuseppe buffi 13 , ch-6900 lugano , switzerland , , email=michele.ceriotti@phys.chem.ethz.ch    address = computational science , department of chemistry and applied biosciences , eth zurich , usi campus , via giuseppe buffi 13 , ch-6900 lugano , switzerland    address = computational science , department of chemistry and applied biosciences , eth zurich , usi campus , via giuseppe buffi 13 , ch-6900 lugano , switzerland </S>"
  ]
}