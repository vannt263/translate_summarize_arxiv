{
  "article_text": [
    "in this paper we will show that almost all plane partitions that are constrained to lie within an @xmath0 box have a certain approximate shape , if @xmath1 , @xmath2 , and @xmath3 are large ; moreover , this limiting shape depends only on the mutual ratios of @xmath1 , @xmath2 , and @xmath3 .",
    "our proof will make use of the equivalence between such plane partitions and tilings of hexagons by rhombuses .    recall that plane partitions are a two - dimensional generalization of ordinary partitions .",
    "a _ plane partition _",
    "@xmath4 is a collection of non - negative integers @xmath5 indexed by ordered pairs of non - negative integers @xmath6 and @xmath7 , such that only finitely many of the integers @xmath5 are non - zero , and for all @xmath6 and @xmath7 we have @xmath8 and @xmath9",
    ". a more symmetrical way of looking at a plane partition is to examine the union of the unit cubes @xmath10 \\times [ j , j+1 ] \\times [ k , k+1]$ ] with @xmath11 , @xmath12 , and @xmath13 non - negative integers satisfying @xmath14 .",
    "this region is called the _ solid young diagram _ associated with the plane partition , and its volume is the sum of the @xmath5 s .",
    "we say that a plane partition @xmath4 _ fits within an @xmath0 box _ if its solid young diagram fits inside the rectangular box @xmath15 \\times [ 0,b ] \\times [ 0,c]$ ] , or equivalently , if @xmath16 for all @xmath6 and @xmath7 , and @xmath17 whenever @xmath18 or @xmath19 ; we call such a plane partition a _",
    "boxed plane partition_. plane partitions in an @xmath20 box are in one - to - one correspondence with tilings of an equi - angular hexagon of side lengths @xmath21 by rhombuses whose sides have length @xmath22 and whose angles measure @xmath23 and @xmath24 .",
    "it is not hard to write down a bijection between the plane partitions and the tilings , but the correspondence is best understood informally , as follows .",
    "the faces of the unit cubes that constitute the solid young diagram are unit squares .",
    "imagine now that we augment the solid young diagram by adjoining the three `` lower walls '' of the @xmath0 box that contains it ( namely @xmath25 \\times [ 0,c]$ ] , @xmath15 \\times \\{0\\ } \\times [ 0,c]$ ] , and @xmath15 \\times [ 0,b ] \\times \\{0\\}$ ] ) ; imagine as well that each of these walls is divided into unit squares",
    ". if we look at this augmented young diagram from a point on the line @xmath26 , certain of the unit squares are visible ( that is , unobstructed by cubes ) .",
    "these unit squares form a surface whose boundary is the non - planar hexagon whose vertices are the points @xmath27 , @xmath28 , @xmath29 , @xmath30 , @xmath31 , @xmath32 , and @xmath27 , respectively .",
    "moreover , these same unit squares , projected onto the plane @xmath33 and scaled , become rhombuses which tile the aforementioned planar hexagon . for example , the plane partition @xmath4 in a @xmath34 box defined by @xmath35 and @xmath36 corresponds to the tiling in figure  [ fig - shadedhex ] , where the points @xmath37 , @xmath38 , and @xmath39 are at the lower left , extreme right , and upper left corners of the hexagon .",
    "( the shading is meant as an aid for three - dimensional visualization , and is not necessary mathematically .",
    "the unshaded rhombuses represent part of the walls . )",
    "we will use the term _ @xmath40 hexagon _ to refer to an equi - angular hexagon of side lengths @xmath21 ( in clockwise order , with the horizontal sides having length @xmath2 ) , and the term _ lozenge _ to refer to a unit rhombus with angles of @xmath23 and @xmath24 .",
    "we will focus , without loss of generality , on those lozenges whose major axes are vertical , which we call _ vertical lozenges_. although our method in this article is to reduce facts about plane partitions to facts about tilings , one can also go in the reverse direction .",
    "for example , one can see from the three - dimensional picture that in every lozenge tiling of an @xmath40 hexagon , the number of vertical lozenges is exactly @xmath41 ( with similar formulas for the other two orientations of lozenge ) ; see @xcite for further discussion .",
    "a classical formula of macmahon @xcite asserts that there are exactly @xmath42 plane partitions that fit in an @xmath0 box , or ( equivalently ) lozenge tilings of an @xmath40 hexagon . in theorem  [ countonline ] of this article",
    ", we give a generalization that counts lozenge tilings with prescribed behavior on a given horizontal line .",
    "using theorem  [ countonline ] , we will determine the shape of a typical plane partition in an @xmath0 box ( theorem  [ heightfun ] ) .",
    "specifically , that theorem implies that if @xmath40 are large , then the solid young diagram of a random plane partition in an @xmath0 box is almost certain to differ from a particular , `` typical '' shape by an amount that is negligible compared to @xmath43 ( the total volume of the box ) .",
    "equivalently , the visible squares in the augmented young diagram of the random boxed plane partition form a surface whose maximum deviation from a particular , typical surface is almost certain to be @xmath44 .",
    "moreover , scaling @xmath40 by some factor causes the typical shape of this bounding surface to scale by the same factor .",
    "before we say what the true state of affairs is , we invite the reader to come up with a guess for what this typical shape should be .",
    "one natural way to arrive at a guess is to consider the analogous problem for ordinary ( rather than plane ) partitions . if one considers all ordinary partitions that fit inside an @xmath45 rectangle ( in the sense that their young diagrams fit inside @xmath15 \\times [ 0,b]$ ] ) , then it is not hard to show that the typical boundary of the diagram is the line @xmath46 ; that is , almost all such partitions have roughly triangular young diagrams .",
    "( one way to prove this is to apply stirling s formula to binomial coefficients and employ direct counting ; another is to use probabilistic methods , aided by a verification that if we look at the boundary of the young diagram of the partition as a lattice path , then the directions of different steps in the path are negatively correlated . )",
    "it therefore might seem plausible that the typical bounding surface for plane partitions would be a plane ( except where it coincided with the sides of the box ) , as when a box is tilted on its corner and half - filled with fluid .",
    "however , theorem  [ mainthm ] shows that that is in fact not the case .    to see what a typical boxed plane partition _ does _ look like , see figure  [ fig - random ] .",
    "this tiling was generated using the methods of @xcite and is truly random , to the extent that pseudo - random number generators can be trusted .",
    "notice that near the corners of the hexagon , the lozenges are aligned with each other , while in the middle , lozenges of different orientations are mixed together .",
    "if the bounding surface of the young diagram tended to be flat , then the central zone of mixed orientations would be an inscribed hexagon , and the densities of the three orientations of tiles would change discontinuously as one crossed into this central zone .",
    "in fact , what one observes is that the central zone is roughly circular , and that the tile densities vary continuously except near the midpoints of the sides of the original hexagon .",
    "one can in theory use our results to obtain an explicit formula for the typical shape of the bounding surface , in which one specifies the distance from a point @xmath47 on the surface to its image @xmath48 under projection onto the @xmath33 plane , as a function of @xmath48 ; however , the integral that turns up is quite messy ( albeit evaluable in closed form ) , with the result that the explicit formula is extremely lengthy and unenlightening .",
    "nevertheless , we can and do give a fairly simple formula for the tilt of the tangent plane at @xmath47 as a function of the projection @xmath48 , which would allow one to reconstruct the surface itself .",
    "in view of the correspondence between plane partitions and tilings , specifying the tilt of the tangent plane is equivalent to specifying the local densities of the three different orientations of lozenges for random tilings of an @xmath40 hexagon .",
    "our result on local densities has as a particular corollary the assertion that , in an asymptotic sense , the zone of mixed orientation ( defined as the region in which all three orientations of lozenge occur with positive density ) is precisely the interior of the ellipse inscribed in the hexagon .",
    "this behavior is analogous to what has been proved concerning domino tilings of regions called aztec diamonds ( see @xcite and @xcite ) ; these are roughly square regions , and if one tiles them randomly with dominos ( @xmath49 rectangles ) , then the zone of mixed orientation tends in the limit to the inscribed disk . however , the known results for aztec diamonds are stronger than the corresponding best known results for hexagons ( see conjecture  [ aec ] in section  [ sec - conj ] ) .",
    "to state our main theorem , we begin by setting up normalized coordinates",
    ". suppose that we are dealing with an @xmath40 hexagon , so that the side lengths are @xmath21 in clockwise order ( with the sides of length @xmath2 horizontal ) .",
    "we let @xmath40 tend to infinity together , in such a way that the three - term ratio @xmath50 ( i.e. , element of the projective plane @xmath51 ) converges to @xmath52 for some fixed positive numbers @xmath53 , @xmath54 , @xmath55 .",
    "say @xmath56 for some scaling factor @xmath57 . then we choose re - scaled coordinates for the @xmath40 hexagon so that its sides are @xmath58 , @xmath59 , and @xmath60 ( which by the hypothesis of our main theorem will be required to converge to @xmath53 , @xmath54 , and @xmath55 as @xmath1 , @xmath2 , and @xmath3 get large ) .",
    "note that @xmath61 in general are not integers .",
    "the origin of our coordinate system lies at the center of the hexagon .",
    "one can check that the sides of the hexagon lie on the lines @xmath62 , @xmath63 , @xmath64 , @xmath65 , @xmath66 , and @xmath67 , and that the inscribed ellipse is described by @xmath68 define @xmath69 to be the polynomial @xmath70 whose zero - set is the ellipse inscribed in the @xmath71 hexagon . also define @xmath72 to be the polynomial @xmath73 which will be useful shortly .",
    "there are six points at which the ellipse inscribed in the @xmath71 hexagon meets the boundary of the hexagon .",
    "the four that occur on sides of length @xmath53 or @xmath55 will be called _ singular points _ , for reasons that will be clear shortly .",
    "( recall that we have already broken the underlying symmetry of the situation by agreeing to focus on vertical lozenges . )",
    "the points of the hexagon that lie outside the inscribed ellipse form six connected components .",
    "let @xmath74 be the closure of the union of the two components containing the leftmost and rightmost points of the hexagon , minus the four singular points , and let @xmath75 be the closure of the union of the other four components , again minus the four singular points .",
    "finally , define the ( normalized ) coordinates of a vertical lozenge to be the ( normalized ) coordinates of its center .",
    "then the following theorem holds :    [ mainthm ] let @xmath76 be the interior of a smooth simple closed curve contained inside the @xmath71 hexagon , with @xmath77 . in a random tiling of an @xmath40 hexagon , as @xmath78 with @xmath79 , the expected number of vertical lozenges whose normalized coordinates lie in @xmath76 is @xmath80 times @xmath81 where @xmath82 is the area of the @xmath71 hexagon and @xmath83    in fact , our proof will give an even stronger version of theorem  [ mainthm ] , in which @xmath76 is a horizontal line segment rather than an open set ( and the double integral is replaced by a single integral ) .",
    "since we can derive the expected number of vertical lozenges whose normalized coordinates lie in @xmath76 by integrating over all horizontal cross sections ( provided that the error term is uniform for all cross sections , as we will prove in section  [ sec - analysis ] ) , this variant of the claim implies the one stated above , though it is not obviously implied by it . we have stated the result in terms of open sets because that formulation seems more natural ; the proof just happens to tell us more .",
    "the intuition behind theorem  [ mainthm ] is that @xmath84 gives the density of vertical lozenges in the normalized vicinity of @xmath85 ; the factor of @xmath80 arises simply because there are that many lozenges in a tiling of an @xmath40 hexagon .",
    "one might be tempted to go farther and think of @xmath84 as the asymptotic probability that a random tiling of the @xmath40 hexagon will have a vertical lozenge at any particular location in the normalized vicinity of @xmath85 ( see conjecture  [ cep ] in section  [ sec - conj ] ) ; however , we can not justify this interpretation rigorously , because it is conceivable that there are small - scale fluctuations in the probabilities that disappear in the double integral .",
    "( in subsection  1.3 of @xcite , it is shown that the analogous probabilities for random domino tilings do exhibit such fluctuations , although the fluctuations disappear if one distinguishes between four classes of dominos , rather than just horizontal and vertical dominos . )",
    "the formula for @xmath86 is more natural than it might appear .",
    "examination of random tilings such as the one shown in figure  [ fig - random ] leads one to conjecture that the region in which all three orientations of lozenges occur with positive density is ( asymptotically ) the interior of the ellipse inscribed in the hexagon , and the known fact that an analogous claim holds for random domino tilings of aztec diamonds ( see @xcite ) lends further support to this hypothesis .",
    "this leads one to predict that @xmath86 will be @xmath87 in @xmath75 and @xmath22 in @xmath74 , and strictly between @xmath87 and @xmath22 in the interior of the ellipse .",
    "comparison with the analogous theorem for domino tilings ( theorem  1 of @xcite ) suggests that within the inscribed ellipse , @xmath84 should be of the form @xmath88 for some quadratic polynomial @xmath89 , and the only problem is actually finding @xmath89 in terms of @xmath71 .",
    "a simple description of the polynomial @xmath89 that actually works is that its zero - set is the unique hyperbola whose asymptotes are parallel to the non - horizontal sides of the hexagon and which goes through the four points on the boundary of @xmath74 where the inscribed ellipse is tangent to the hexagon .",
    "this determines @xmath89 up to a constant factor , and that constant factor is determined ( at least in theory  in practice the calculations would be cumbersome ) by requiring that the average of @xmath84 over the entire hexagon must be @xmath90 .    an alternative way to phrase theorem  [ mainthm ] is in terms of height functions , which were introduced by thurston in @xcite as a geometrical tool for understanding tilings of regions by lozenges or dominos .",
    "a height function is a numerical representation of an individual tiling of a specified region . in the case of lozenge tilings of a hexagon",
    ", the vertices of the lozenges occur at points of a certain triangular lattice that is independent of the particular tiling chosen , and the height function simply associates a certain integer to each such vertex so as to describe the shape of the plane partition that corresponds to the tiling . given any lozenge tiling",
    ", one can assign heights @xmath91 to the points @xmath92 of the triangular lattice as follows .",
    "give the leftmost vertex of the hexagon height @xmath93 .",
    "( we choose this height so that the vertex of the bounding box farthest from the viewer , which is usually obscured from view , will have height @xmath87 . )",
    "suppose that @xmath92 and @xmath94 are adjacent lattice points , such that the edge connecting them does not bisect a lozenge .",
    "if the edge from @xmath92 to @xmath94 points directly to the right , set @xmath95 , and if it points up and to the right , or down and to the right , set @xmath96 .",
    "( if it points left , change @xmath97 to @xmath98 and vice versa . )",
    "if one traces around each lozenge in the tiling and follows this rule , then every vertex is assigned a height .",
    "it is not hard to check that the heights are well - defined , so there is a unique _ height function _ associated to the tiling . for an example , see figure  [ fig - heightfun ] .",
    "conversely , every way of assigning integer heights to the vertices of the triangular grid that assigns height @xmath93 to the leftmost vertex of the hexagon and that satisfies the edge relation must be the height function associated to some unique tiling . if one views the tiling as a three - dimensional picture of the solid young diagram of a plane partition , then the height function tells how far above a reference plane ( of the form @xmath99 ) each vertex lies .",
    "the values of the height function on the boundary of the hexagon are constrained , but all the values in the interior genuinely depend on the tiling .",
    "( it should be mentioned that height functions for lozenge tilings are implicit in the work of physicists blte and hilhorst , in the context of the two - dimensional dimer model on a hexagonal lattice ; see @xcite . )    when dealing with normalized coordinates , it is convenient to use a _ normalized height function _ :",
    "if we scale the coordinates by dividing them by @xmath57 ( as described above ) , then we also divide the height function values by @xmath57 . also , we define the average height function to be the average of the height functions associated with all possible tilings .",
    "( of course , it is not a height function itself . )",
    "we will show that almost every height function closely approximates the average height function , asymptotically :    [ heightfun ] fix @xmath100 .",
    "as @xmath78 with @xmath79 , the normalized average height function of the @xmath40 hexagon converges uniformly to the function @xmath101 with the appropriate ( piecewise linear ) boundary conditions such that @xmath102 for fixed @xmath103 , the probability that the normalized height function of a random tiling will differ anywhere by more than @xmath104 from @xmath101 is exponentially small in @xmath105 , where @xmath106 .",
    "it is not hard to deduce theorem  [ heightfun ] ( with the exception of the claim made in the last sentence ) from theorem  [ mainthm ] ; in particular , the differential equation simply results from considering how the height changes as one crosses lozenges of each orientation",
    ". we will give the proof in detail in section  [ sec - analysis ] .",
    "unfortunately , although one can recover an explicit formula for @xmath107 from the boundary values and the knowledge of @xmath108 , we can not find any simple formula for it .",
    "by contrast , proposition  17 of @xcite gives a comparatively simple asymptotic formula for the average height function for domino tilings of an aztec diamond .",
    "our methods also apply to the case of random domino tilings of aztec diamonds .",
    "formula  ( 7 ) of section  4 of @xcite is analogous to our theorem  [ countonline ] , and can be used in the same way .",
    "it turns out that the functional arrived at by applying the methods of section  [ sec - setup ] of this paper to that formula is very similar to the one we will find in section  [ sec - setup ] . after a simple change of variables , one ends up with essentially the same functional , but maximized over a slightly different class of functions .",
    "the methods of section  [ sec - analysis ] apply almost without change , and the methods of section  [ sec - typical ] can be adapted to prove proposition  17 of @xcite . this proof is shorter than the one given in @xcite ; however , in @xcite , proposition  17 comes as a corollary of a much stronger result ( theorem  1 ) , which the methods of this paper do not prove .",
    "in this section , we will prove a refinement of macmahon s formula , following methods first used by elkies et al .  in @xcite .",
    "this refinement ( proposition  [ prodformula ] ) is not strictly speaking new , since it is really nothing more than the weyl dimension formula for finite - dimensional representations of @xmath109 ( we say a few words more about this connection below ) .",
    "however , we give our own proof of this result for two reasons : first , to make this part of the proof self - contained ; and second , to illustrate an expeditious method of proof that has found applications elsewhere ( see @xcite for related formulas derived by the same method ) .",
    "proposition  [ prodformula ] is stated in terms of gelfand patterns , so we must first explain what gelfand patterns are and what they have to do with lozenge tilings .",
    "it is not hard to see that a lozenge tiling of a hexagon is determined by the locations of its vertical lozenges .",
    "a semi - strict gelfand pattern is a way to keep track of these locations .",
    "specifically , one augments the @xmath40 hexagon by adding @xmath110 vertical lozenges on the left and @xmath111 vertical lozenges on the right , forming an approximate trapezoid of upper base @xmath112 and lower base @xmath2 , with some triangular protrusions along its upper border , as in figure  [ fig - gelfand ] .",
    "one then associates with each vertical lozenge in the tiling the horizontal distance from its right corner to the left border of the trapezoid , which we call its _ trapezoidal position_. ( when we want to use the left boundary of the hexagon instead of the left boundary of the approximate trapezoid as our bench mark , we will speak of the _ hexagonal position _ of a vertical lozenge . ) for example , consider the tiling shown in figure  [ fig - shadedhex ] ; we augment it by adding @xmath113 vertical lozenges to form the tiling shown in figure  [ fig - gelfand ] .",
    "the vertical lozenges form rows , and the only restriction on their placement is that given any two adjacent vertical lozenges in the same row , there must be exactly one vertical lozenge between them in the row immediately beneath them .",
    "if we index the locations of the vertical lozenges with their trapezoidal positions ( the numbers shown in figure  [ fig - gelfand ] ) , we arrive at the following semi - strict gelfand pattern : @xmath114    in general , a _ semi - strict gelfand pattern _ is a triangular array of integers ( such as this one ) , with the property that the entries increase weakly along diagonals running down and to the right , and the entries increase strictly along diagonals running up and to the right . as discussed above , there is a simple bijection between semi - strict gelfand patterns with top row @xmath115 and lozenge tilings of an equi - angular hexagon with side lengths @xmath21 .",
    "moreover , consider the @xmath13-th horizontal line from the top in an @xmath40 hexagon , where the top edge of the hexagon corresponds to @xmath116 , so that the trapezoidal positions of the vertical lozenges on the @xmath13-th line are precisely the entries in the @xmath117-st row of the associated semi - strict gelfand pattern . if we discard all lozenges that lie above the line ( but retain all vertical lozenges that are bisected by it and all lozenges that lie below it ) , then we get a tiling of a smaller approximate trapezoid , whose upper border as before consists of triangular protrusions alternating with straight edges , except that now the protrusions need not be concentrated at the left and right portions of the border . the trapezoidal positions of the vertical lozenges in this tiling are given by the entries in the semi - strict gelfand pattern obtained from the original semi - strict gelfand pattern by deleting the first @xmath13 rows .",
    "in fact , if we limit ourselves to tilings of the @xmath40 hexagon in which the locations of the vertical lozenges that are bisected by the @xmath13-th horizontal line are specified , then each individual tiling of this kind corresponds to a _",
    "pair _ of semi - strict gelfand patterns .",
    "we have already described one of these gelfand patterns , which gives the behavior of the tiling below the cutting line ; the other , which describes the tilings above the line , comes from reflecting the hexagon through the horizontal axis ( and of course adjoining additional lozenges , as above ) .",
    "if @xmath118 , then one of the gelfand patterns will include some of the augmenting vertical lozenges described above on both sides ( a row of length @xmath119 on one side of the top of the pattern , and a row of length @xmath120 on the other ) and the other pattern will contain augmenting vertical lozenges on neither side ; if @xmath121 , then one of the gelfand patterns will contain a row of @xmath122 augmenting lozenges on one side and the other gelfand pattern will contain @xmath123 on the other side .",
    "( the case @xmath124 is symmetric to the case @xmath125 , so we do not treat it explicitly . )    in theorem  [ countonline ] , we will use the following formula to determine how many tilings have a specified distribution of vertical lozenges along a horizontal line .",
    "[ prodformula ] there are exactly @xmath126 semi - strict gelfand patterns with top row consisting of integers @xmath127 such that @xmath128 .",
    "proposition  [ prodformula ] has an explanation in terms of representation theory .",
    "gelfand and tsetlin @xcite show that semi - strict gelfand patterns form bases of representations of @xmath109 , and one can deduce proposition  [ prodformula ] from this fact using the weyl dimension formula .",
    "( the gelfand patterns in @xcite are not semi - strict , but there is an easy transformation that makes them so : replace @xmath129 in equation  ( 3 ) of @xcite with @xmath130 and then reflect the triangle through its vertical axis . ) thus , the novelty of our approach is not that one can count semi - strict gelfand patterns , but rather that one can count tilings with prescribed behavior on a horizontal line ( as in theorem  [ countonline ] ) .",
    "another proof of proposition  [ prodformula ] , and one that bypasses its representation - theoretic significance , is the article of carlitz and stanley @xcite .",
    "( that article does not deal directly with semi - strict gelfand patterns , but it is easy to deduce proposition  [ prodformula ] from the theorem proved there . )    let @xmath131 be the number of semi - strict gelfand patterns with top row @xmath132 .",
    "given any such pattern , the second row must be of the form @xmath133 with @xmath134 for all @xmath11 .",
    "therefore , @xmath135 where the modified summation operator @xmath136 is defined by @xmath137 the advantage to writing it this way is that @xmath138 whenever @xmath139 .",
    "there is a unique way to extend the definition of @xmath140 to the case @xmath141 , if we require that be true for all @xmath142 . then starting from the base relation @xmath143 , we can use to define @xmath131 for arbitrary integers @xmath132 ( not necessarily satisfying @xmath144 )",
    ".    we will prove the formula for @xmath131 by induction on @xmath145 .",
    "it is clearly true for @xmath146 .",
    "suppose that for all @xmath133 , @xmath147 then @xmath148 is a polynomial of total degree @xmath149 in @xmath133 .",
    "when we put into , we find that after each of the @xmath145 summations in , the result is still a polynomial , and the degree increases by @xmath22 each time .",
    "it is easy to check from that the coefficient of @xmath150 in @xmath148 is @xmath151 from this and it follows that the coefficient of @xmath152 in @xmath131 is @xmath153    we have therefore shown that @xmath131 and @xmath154 are polynomials in @xmath132 of the same total degree , and with the same coefficient of @xmath155 .",
    "if we can show that @xmath131 is divisible by , then they must be equal .",
    "equivalently , we just need to show that @xmath131 is skew - symmetric in @xmath132 .    for convenience ,",
    "let @xmath156 denote @xmath157 we want to show that @xmath158 is skew - symmetric in @xmath132 .    to start off , notice that for all @xmath11 , @xmath159 also , since @xmath148 is a skew - symmetric function of @xmath133 by , for @xmath160 we must have @xmath161 the relation @xmath162 follows easily from the definition of @xmath163 .",
    "from the last two relations , we see that @xmath164 vanishes if @xmath165 and @xmath166 , or if @xmath167 and @xmath168 .    to verify that @xmath169 is skew - symmetric in @xmath132 , it suffices to check that it changes sign under transpositions of adjacent @xmath170 s .",
    "we check the effect of exchanging @xmath171 with @xmath172 as follows . if we write @xmath173 ( to simplify the subscripts ) , we have @xmath174 by several applications of .",
    "all terms on the right except the second are @xmath87 , so @xmath175 thus , exchanging @xmath171 with @xmath172 introduces a minus sign whenever @xmath176 and @xmath177 .",
    "the other cases ( exchanging @xmath178 with @xmath179 or @xmath180 with @xmath181 ) are easily dealt with in a similar way .",
    "therefore , @xmath131 is skew - symmetric in @xmath132 , so as discussed above we must have @xmath182 as desired .",
    "notice that after some manipulation of the product @xmath183 proposition  [ prodformula ] implies macmahon s formula",
    ". however , our main application will be to counting tilings with prescribed behavior on horizontal lines .",
    "consider the @xmath13-th horizontal line from the top in an @xmath40 hexagon .",
    "if @xmath184 , then in every tiling there must be @xmath13 vertical lozenges on the @xmath13-th line ; if @xmath185 , then there must be @xmath186 vertical lozenges on it .",
    "( as mentioned earlier , symmetry frees us from needing to treat the case @xmath124 , so we will routinely assume @xmath187 . ) in either case , note that the number of vertical lozenges on the @xmath13-th row is @xmath188 .",
    "define the function @xmath182 as in the proof of proposition  [ prodformula ] .",
    "then we have the following formulas :    [ countonline ] suppose we require that the vertical lozenges bisected by the @xmath13-th horizontal line from the top in an @xmath40 hexagon occur at hexagonal positions @xmath189 ( and nowhere else ) , with @xmath190 . if @xmath191 , there are @xmath192 such tilings .",
    "if @xmath193 and @xmath194 , there are @xmath195 such tilings ( and a similar formula applies if @xmath196 and @xmath197 ) .    for the proof , simply notice that tilings of the parts of the hexagon above and below the @xmath13-th line correspond naturally to semi - strict gelfand patterns with certain top rows , and then apply proposition  [ prodformula ] to count them . in both cases ,",
    "the two factors correspond to the parts of the tiling that lie above and below the cutting line .",
    "we now turn to the proofs of our main theorems . as is usually done in situations such as ours , where one seeks to establish a law of large numbers for some class of combinatorial objects , we approach the problem by trying to find the individually most likely outcome ( in this case , the individually most likely behavior of the height function on a fixed horizontal line ) , and showing that outcomes that differ substantially from it are very unlikely , even considered in aggregate",
    ". we will begin in this section by setting up a functional to be maximized ; the function that maximizes it will be a simple transformation of the average height function .    our method is to focus on the locations of the vertical lozenges rather than the height function per se .",
    "the two are intimately related , because , as we move across the tiling from left to right , the ( unnormalized ) height decreases by 2 when we cross a vertical lozenge and increases by 1 when we fail to cross a vertical lozenge .",
    "thus , in determining the likely locations of vertical lozenges , we will in effect be solving for the average height function .",
    "theorem  [ countonline ] tells us that we can count tilings with prescribed behavior on horizontal lines , so we will start off by taking the logarithm of the product formula in theorem  [ countonline ] and interpreting it as a riemann sum for a double integral .",
    "in fact , it will be convenient to look first at a more general product , and then apply our analysis of it to the product appearing in theorem  [ countonline ] .",
    "fix positive integers @xmath198 and @xmath199 satisfying @xmath200 , and non - negative integers @xmath201 and @xmath202 .",
    "we will try to determine the distribution of @xmath203 satisfying @xmath204 that maximizes @xmath205 for convenience , let @xmath206 denote the @xmath11-th element of the sequence @xmath207 .",
    "set @xmath208 , @xmath209 , and @xmath210 .",
    "we will work in the limit as @xmath211 , with @xmath212 , @xmath213 , and @xmath214 tending toward definite limits . for a more convenient way to keep track of @xmath215 as we pass to the continuum limit",
    ", we define a weakly increasing function @xmath216 \\rightarrow [ 0,1]$ ] as follows .",
    "set @xmath217 for @xmath218 , and then interpolate by straight lines between these points .",
    "similarly , set @xmath219 for @xmath220 where @xmath221 , and then interpolate by straight lines . to simplify the notation later ,",
    "set @xmath222 , so that @xmath223 , @xmath224 , @xmath225 , @xmath226 , and @xmath227 .",
    "the functions @xmath228 and @xmath229 satisfy the lipschitz condition with constant 1 ; that is , @xmath230 and @xmath231 are bounded by @xmath232 .",
    "note that the derivatives @xmath233 and @xmath234 are not defined everywhere , but they are undefined only at isolated points , and where they are defined they equal either @xmath87 or @xmath22 ; when we make statements about @xmath233 and @xmath234 , we will typically ignore the points of non - differentiability . we can also derive a simple relation between @xmath233 and @xmath234 . to do so , notice that for @xmath218 , we have @xmath235 if we set @xmath236 , we find that this equation becomes @xmath237 for @xmath238 , the values of @xmath228 and @xmath229 occurring in are defined by interpolating linearly between points at which we have just shown that holds , so it must hold for all such @xmath239 .",
    "therefore , for @xmath240 , we have @xmath241 except at isolated points of non - differentiability .",
    "all other values of @xmath234 are @xmath22 , since it follows immediately from the definition of @xmath229 that for @xmath242 or @xmath243 , we have @xmath244 .",
    "we have @xmath245 , @xmath246 .",
    "( whenever we refer to @xmath247 , we consider it to take the smallest value possible , to avoid ambiguity , and we interpret @xmath248 analogously . ) when we take the logarithm and then multiply by @xmath249 , the double product @xmath250 ought to approach an integral like @xmath251 ( the factor of @xmath252 appears because @xmath253 and we rescaled by @xmath249 instead of @xmath254 . ) in the appendix , we will justify this claim rigorously , except with the function @xmath229 replaced by a nicer function @xmath255 .",
    "( the justification is not very difficult , but it is long enough that here it would be a distraction . )    the conclusion from the appendix is that @xmath256 where @xmath255 is a certain strictly increasing , continuous , piecewise linear function satisfying @xmath257 , @xmath258 , and @xmath259 . note that @xmath255 has a continuous inverse ( unlike @xmath229 , which is only weakly increasing and thus may not even have an inverse ) .    by symmetry ,",
    "the integral equals @xmath260 we can write the integral as @xmath261 since the integral being subtracted is a constant , we can ignore it .",
    "( the individual integrands are unbounded , but since the singularities are merely logarithmic they do not interfere with integrability . ) letting @xmath262 and @xmath263 , we can rewrite the part that matters as @xmath264 since @xmath265 , this integral differs by @xmath266 from @xmath267    we will now use our formula expressing @xmath234 in terms of @xmath233 . recall that @xmath268 for @xmath269 , and that @xmath244 for @xmath270 . to take advantage of this , we change variables to @xmath271 and @xmath239 ( which are different from the @xmath271 and @xmath239 used earlier in the article ) with @xmath272 and @xmath273 .",
    "then when @xmath274 we have @xmath275 and @xmath276 ; elsewhere @xmath234 is @xmath22 .",
    "thus , is equal to @xmath277 where @xmath278 is the characteristic function of @xmath279 \\cup [ 1,1+{\\rho_r}]$ ] , and where we set @xmath280 outside @xmath281 $ ] .    removing the @xmath282 from the denominator of the argument of",
    "the logarithm simply adds @xmath283 to the integral ; this quantity is a constant because the only occurrence of @xmath228 in it is through the integral @xmath284 ( and the square of this integral ) .",
    "we can also change the range of integration in to the entire plane ( since the integrand has support only in the rectangle @xmath285 \\times [ -{\\rho_l},1+{\\rho_r}]$ ] ) .",
    "thus , we have arrived at the result that , for some irrelevant constant @xmath286 , @xmath287 equals @xmath288    we can now apply this to theorem  [ countonline ] .",
    "suppose that on the @xmath13-th line from the top in the @xmath40 hexagon ( with @xmath289 ) , the vertical lozenges have hexagonal positions @xmath290 , where @xmath291 .",
    "define the function @xmath228 as above .",
    "then our analysis so far , combined with theorem  [ countonline ] , shows that if we take the logarithm of the number of tilings with the given behavior on the @xmath13-th line , and divide by @xmath292 , then we get the sum of two terms of the form ; for , theorem  [ countonline ] gives us a product of two @xmath293-expressions ( whose exact nature depends on whether @xmath13 lies between @xmath1 and @xmath3 ) , and when we take logarithms and divide by @xmath292 , we get two terms , each of which is half of a double integral ( plus negligibly small terms and irrelevant constants ) .    to put this into an appropriately general context ,",
    "define the bilinear form @xmath294 by @xmath295 for suitable functions @xmath296 and @xmath297 ( for our purposes , functions such that their derivatives exist almost everywhere , are bounded , are integrable , and have compact support ) .",
    "we will now use this notation to continue the analysis begun in the previous paragraph .    in this paragraph",
    "we will systematically omit additive constants and @xmath266 terms , since they would be a distraction . if @xmath191 , then one of the two terms derived from theorem  [ countonline ] is @xmath298 , and the other is @xmath299 , where @xmath300 is a continuous function with derivative equal to the characteristic function of @xmath301 \\cup [ 1,1+|c - k|/{n}]$ ] .",
    "if @xmath302 , then one term is @xmath303 and the other is @xmath304 , where the derivative of @xmath305 is the characteristic function of @xmath301 $ ] and that of @xmath306 is the characteristic function of @xmath307 $ ] .",
    "now a few simple algebraic manipulations bring these results to the following form .",
    "[ functionalprop ] let @xmath308 , @xmath309 , and latexmath:[${\\rho_r}=    @xmath40 hexagon with vertical lozenges at hexagonal positions @xmath215 ( and nowhere else ) along the @xmath13-th line ( where @xmath190 and @xmath311 ) , when divided by @xmath292 , equals @xmath312 where @xmath313 is any continuous function whose derivative is half the characteristic function of @xmath279 \\cup [ 1,1+{\\rho_r}]$ ] , and @xmath228 is defined ( as earlier ) by interpolating linearly between the values @xmath314 for @xmath315 .",
    "recall that we are working in the limit as @xmath316 with @xmath212 , @xmath214 , and @xmath213 converging towards fixed limits .",
    "it is easy to check that the unspecified constant in proposition  [ functionalprop ] converges as well .",
    "we would like everything to be stated in terms of the limiting values of @xmath212 , @xmath214 , and @xmath213 .",
    "replacing @xmath212 and @xmath214 in the definition of @xmath313 by their limits changes @xmath317 by only @xmath266 , and we can increase @xmath233 by @xmath266 in such a way that @xmath318 remains @xmath87 , @xmath319 becomes the limiting value of @xmath213 , and @xmath228 still satisfies the lipschitz condition .",
    "thus , we can let @xmath212 , @xmath214 , and @xmath213 denote their limiting values from now on .",
    "we have now re - framed our problem .",
    "we must find a function @xmath228 that maximizes @xmath320 , subject to certain conditions .",
    "we will look at real - valued functions @xmath228 on @xmath281 $ ] that are continuous , weakly increasing , and subject to the following constraints : @xmath321 , @xmath322 , and @xmath228 must satisfy a lipschitz condition with constant @xmath22 ( so @xmath323 where @xmath233 is defined ) . for convenience ,",
    "define @xmath324 for @xmath325 and @xmath326 for @xmath327 . call a function @xmath228 that satisfies these conditions _",
    "admissible_. clearly , the functions @xmath228 considered in this section are admissible .",
    "we will show in the next section that there is a unique admissible function @xmath228 that maximizes @xmath328 .",
    "( notice that every admissible function @xmath228 is differentiable almost everywhere , and @xmath233 is integrable and has compact support ; for a proof of the necessary facts from real analysis , see theorem  7.18 of @xcite .",
    "thus , @xmath328 makes sense for every admissible @xmath228 . )",
    "let @xmath329 be the set of admissible functions .",
    "we can topologize @xmath329 using the sup norm , @xmath330 norm , or @xmath331 norm on @xmath281 $ ] ; it is straightforward to show that they all give the same topology , and that @xmath329 is compact . in this section",
    ", we will show that @xmath332 is a continuous function on @xmath329 , so it must attain a maximum .",
    "we will show furthermore that there is a unique function @xmath333 such that @xmath328 is maximal .",
    "the proof will use several useful formulas for the bilinear form @xmath334 ( formulas to ) .",
    "these formulas are derived in @xcite ; we repeat the derivations here for completeness .",
    "one can find similar analysis in @xcite and @xcite .",
    "the formulas are stated in terms of the fourier and hilbert transforms . for sufficiently well - behaved functions @xmath296 ,",
    "define the fourier transform @xmath335 of @xmath296 by @xmath336 and the hilbert transform @xmath337 by @xmath338 ( which we make sense of by taking the cauchy principal value ) .",
    "note that the fourier transform of @xmath337 is @xmath339 , and that of @xmath340 is @xmath341 ; multiplying by @xmath342 and multiplying by @xmath343 commute with each other , so differentiation commutes with the hilbert transform .",
    "integration by parts with respect to @xmath7 in shows that @xmath344 when done with respect to @xmath6 , it also shows that @xmath345 unfortunately , hilbert transforms are not always defined . for our purposes , it is enough to note that makes sense and is true when @xmath340 and @xmath297 have compact support , and similarly that holds when @xmath296 and @xmath346 have compact support .",
    "if we set @xmath347 and apply parseval s identity to , we find that when @xmath296 has compact support , @xmath348 thus , the bilinear form @xmath294 is negative definite ( on functions of compact support ) .",
    "we can now prove easily that @xmath332 is a continuous function on @xmath329 .",
    "to do so , notice that the definition of @xmath332 and imply that @xmath349 where @xmath350 and @xmath351 .",
    "thus , since @xmath352 for all @xmath6 and @xmath353 outside some interval @xmath278 not depending on @xmath354 and @xmath355 , @xmath356 ( the second bound follows from applying the cauchy - schwartz inequality to @xmath357 . )    it is known ( see theorem  90 of @xcite ) and easy to prove ( combine parseval s identity with the formula for the fourier transform of a hilbert transform ) that @xmath358 , so the function @xmath332 is continuous on @xmath329 .",
    "because @xmath329 is compact , @xmath332 must attain a maximum on @xmath329 .",
    "now we apply the identity @xmath359 which is a form of the polarization identity for quadratic forms . because @xmath360 has compact support , implies that @xmath361 with equality if and only if @xmath362 .",
    "thus , two different admissible functions could not both maximize @xmath332 , since then their average would give an even larger value .",
    "therefore , there is a unique admissible function that maximizes @xmath332 .",
    "let @xmath363 be that function .",
    "( notice that @xmath363 depends on @xmath213 , @xmath212 , and @xmath214 , and hence on @xmath53 , @xmath54 , and @xmath55 , although our notation does not reflect this dependence . )",
    "we are now almost at the point of being able to prove that there is a function @xmath101 such that theorem  [ heightfun ] holds ( except for the part relating @xmath101 to the explicitly given function @xmath86 ) .",
    "first , we need to relate @xmath228 to the normalized average height function .",
    "assume that @xmath364 as @xmath78 for some @xmath365 satisfying @xmath366 .",
    "choose normalized coordinates for the @xmath40 hexagon so that the @xmath13-th horizontal line from the top has normalized length @xmath22 , and in particular coordinatize that line so that its left endpoint is @xmath87 and its right endpoint is @xmath22 ; equivalently , coordinatize the @xmath71 hexagon so that the horizontal line that cuts it proportionately @xmath365 of the way from its upper border has length 1 . ( the truth or falsity of theorem  [ heightfun ] is clearly unaffected by our choice of coordinates . )",
    "we can then identify the scaling factor @xmath57 with @xmath199 , to within a factor of @xmath367 . given a tiling of the @xmath40 hexagon , if we scan to the right along this line , whenever we cross a vertical lozenge the normalized height function decreases by @xmath368 , and whenever we cross a location that could hold a vertical lozenge but does not the normalized height function increases by @xmath369 .",
    "it follows that the normalized height function at location @xmath239 is given by @xmath370 plus the value at @xmath371 , since this function changes by the same amount as the normalized height function does as one moves to the right .",
    "let @xmath103 .",
    "then there exists a @xmath372 such that @xmath373 implies @xmath374 .",
    "( this claim holds for every continuous function on a compact space that takes its maximal value at a unique point . ) for @xmath199 sufficiently large , proposition  [ functionalprop ] implies that if latexmath:[$\\sup_t    every behavior within @xmath266 of @xmath363 is at least @xmath376 times as likely to occur along the @xmath13-th line as the behavior @xmath228 is . since the number of possibilities for @xmath228 is only exponential in @xmath199 , the probability that @xmath377 is exponentially small in @xmath292 ( and hence in @xmath378 ) . in other words , the probability",
    "that a random height function differs along this line from the height function obtained from @xmath363 is exponentially small in @xmath378 .",
    "it follows that the same is true without the restriction to the particular horizontal line , because of the lipschitz constraint on height functions : if we show that large deviations are unlikely on a sufficiently dense ( but finite ) set of horizontal lines , then the same holds even between them .",
    "thus , we have proved theorem  [ heightfun ] , except for the connection between @xmath101 and @xmath86 .    furthermore , the density of vertical lozenges near location @xmath239 along a given horizontal line is almost always approximately equal to @xmath379 .",
    "we can make this claim precise and justify it as follows . given a random tiling ,",
    "@xmath380 gives the number of vertical lozenges to the left of the location @xmath239 , divided by @xmath199 ( plus @xmath381 if @xmath239 is not at a vertex of the underlying triangular lattice ) .",
    "thus , the number of vertical lozenges in an interval @xmath382 $ ] is @xmath383 .",
    "we have seen that the probability that this quantity will differ by more than @xmath384 from @xmath385 is exponentially small in @xmath292 . therefore , as @xmath211 ( equivalently , @xmath386 ) , the expected value of @xmath387 is @xmath388 .",
    "thus , we get the expected number of vertical lozenges in @xmath382 $ ] , which is also equal to the expected number of vertical lozenges in @xmath389 ( up to a negligible error ) .",
    "notice that the @xmath266 error term is uniform in the choice of @xmath1 , @xmath2 , and the horizontal line , because the probability of a large deviation in height anywhere in the hexagon is small .",
    "if we take the result we have just proved for horizontal line segments and integrate it over the horizontal line segments that constitute the interior of any smooth simple closed curve , then we can conclude that theorem  [ mainthm ] holds , except for the explicit determination of @xmath86 ( which is equivalent to the explicit determination of @xmath363 , since @xmath390 ) .",
    "also , notice that our method of proof implies that @xmath101 and @xmath86 must satisfy @xmath391 as desired ( although it does not yet determine them explicitly ) .",
    "thus , all that remains to be done is to determine the maximizing function @xmath363 explicitly .",
    "we will do so in section  [ sec - typical ] .",
    "unfortunately , it is not clear how to find the admissible function @xmath363 that maximizes @xmath392 .",
    "ordinary calculus of variations techniques will not produce admissible solutions .",
    "however , we will see that techniques similar to those used in @xcite and @xcite can be used to verify that a function @xmath363 maximizes @xmath392 , if we can guess @xmath363 .",
    "( it is not clear a priori that the techniques will work , but fortunately everything works out just as one would hope . )    as we saw in section  [ sec - analysis ] , for the cases that are needed in the proof of theorem  [ mainthm ] , an explicit formula for @xmath363 is equivalent to one for @xmath86 ; since we know already what the answer should be , guessing it will not present a problem . in section  [ sec - intro ] , we tried to give some motivation by presenting a slightly simpler description of @xmath86 than the explicit formula .",
    "however , we do not know of any straightforward way to guess the answer from scratch .",
    "we arrived at it partly by analogy with the arctangent formula for random domino tilings of aztec diamonds ( theorem  1 of @xcite ) , partly on the basis of symmetry and simplicity , and partly on the basis of numerical evidence .    to avoid unnecessarily complicated notation",
    ", we will solve the problem in greater generality than is needed simply for theorem  [ mainthm ] .",
    "we will deal with the case of arbitrary @xmath213 satisfying @xmath393 , and arbitrary non - negative @xmath212 and @xmath214 ( which we assume for simplicity are strictly greater than @xmath87 ) .",
    "we will use the same notation as earlier in the paper ; for example , we set @xmath394 .",
    "of course , guessing the admissible function that maximizes the functional in general requires additional effort , but the symmetry and elegance of the general formulas are a helpful guide .",
    "we will express the maximizing function @xmath363 in terms of auxiliary functions @xmath395 and @xmath396 .",
    "define @xmath397 and @xmath398 ( note that both expressions are invariant under @xmath399 ; this observation reduces some of the work involved in verifying the claims that follow . )",
    "since the discriminant of @xmath400 is @xmath401 @xmath400 has distinct real roots @xmath402 .",
    "we can show that both roots are in @xmath281 $ ] as follows .",
    "since @xmath403 and @xmath404 are at most @xmath87 , both roots of @xmath396 lie in @xmath281 $ ] if the point at which @xmath396 achieves its maximum does .",
    "the maximum occurs when @xmath405 and this point is easily seen to lie in @xmath281 $ ] .",
    "we will specify the function @xmath363 by specifying its derivative @xmath406 , which together with the condition @xmath407 uniquely determines the function .",
    "( we will then check that the newly defined @xmath363 maximizes @xmath332 , and is thus the same as the previous @xmath363 . ) for @xmath408 define @xmath409 for @xmath410 $ ] define @xmath411 , and similarly for @xmath412 $ ] define @xmath413 .",
    "we can show that the first limit will be @xmath87 or @xmath22 if @xmath414 , and the second will be @xmath87 or @xmath22 if @xmath415 ; to verify this , it suffices to check ( using resultants , for example ) that @xmath395 and @xmath396 can not have a common root in @xmath416 , from which it follows that at @xmath417 or @xmath418 the denominator of the argument of the arccotangent vanishes without the numerator vanishing .",
    "notice that @xmath419 if @xmath420 , and @xmath421 if @xmath422 .",
    "similarly , @xmath423 if @xmath424 , and @xmath425 if @xmath426 . also ,",
    "if @xmath427 , then @xmath395 and @xmath396 both vanish at @xmath87 , and it follows that @xmath428 ; similarly , if @xmath429 then @xmath430 .    let @xmath431 \\rightarrow [ 0,1]$ ] be the unique function satisfying @xmath407 with derivative @xmath406 .",
    "we will show later in this section that @xmath432 , from which it follows that @xmath363 is an admissible function ( since the other conditions are clearly satisfied ) .",
    "( we then extend @xmath363 to a function on all of @xmath433 in the usual way , so that @xmath434 for @xmath327 and @xmath435 for @xmath436 ) we will prove that @xmath363 is the unique admissible function such that @xmath392 is maximal .    before beginning the proof , it is helpful for motivation to examine what the calculus of variations tells us about how the maximizing function should behave . for every admissible function @xmath228 we have @xmath437 where @xmath313 is any continuous function",
    "whose derivative is half the characteristic function of @xmath279 \\cup [ 1,1+{\\rho_r}]$ ] .",
    "suppose we perturb our function @xmath363 by adding to it a small bump centered at @xmath239 , which we write as @xmath438 where @xmath439 is a delta function .",
    "( we should actually perturb by a bump rather than a spike , in order to try to maintain the lipschitz constraint as long as @xmath104 is small enough ; however , treating @xmath439 as a delta function gives the right answer . ) because @xmath440 the first variation of @xmath332 is @xmath441 . by , @xmath442 thus , in order for the first variation to vanish , we must have @xmath443 . when @xmath444 this must be the case , assuming @xmath363 maximizes @xmath392",
    "however , when @xmath445 , every perturbation violates the lipschitz constraint , and we can conclude nothing .    our strategy for proving that @xmath363 maximizes @xmath392 will take advantage of the vanishing of @xmath446 ( which we will prove directly later in this section ) .",
    "to begin , for any admissible @xmath228 we write @xmath447 because @xmath448 with equality if and only if @xmath449 , in order to prove that @xmath450 , we need only show that @xmath451 to show that this is the case , we start by using , which tells us that @xmath452 thus , we want to show that @xmath453 we will prove that the integrand is everywhere non - negative , by showing that @xmath443 when @xmath408 ( the interval where @xmath444 ) , and that in the rest of @xmath416 its sign is the same as that of @xmath454 .",
    "( outside @xmath416 , @xmath455 . )",
    "in order to prove these facts , we will apply the following theorem . for a proof , see theorem  93 of @xcite .",
    "[ titchthm ] let @xmath456 be a holomorphic function on the upper half plane , such that the integrals @xmath457 exist for all @xmath458 and are bounded .",
    "then there exists a function @xmath459 on the real line such that for almost all @xmath6 , @xmath460 as @xmath461 , and the imaginary part of @xmath459 is the hilbert transform of the real part of @xmath459 .",
    "we will apply this theorem to determine the hilbert transform of @xmath462 . to prepare for the application of the theorem",
    ", we begin by defining , for @xmath408 , @xmath463 and @xmath464 ( of course , @xmath465 on @xmath466 , but this new notation will help avoid confusion soon . ) then @xmath297 extends to a unique holomorphic function on the ( open ) upper half plane .",
    "the function @xmath456 extends as well to a unique holomorphic function on the upper half plane , together with all of @xmath433 except the points @xmath467 , @xmath87 , @xmath417 , @xmath418 , @xmath22 , and @xmath468 . to see why , notice that @xmath469 has only four roots , in particular , simple roots at each of @xmath467 , @xmath87 , @xmath22 , and @xmath468 .",
    "there is always a holomorphic branch of the arccotangent of a holomorphic function on a simply - connected domain , as long as that function does not take on the values @xmath470 ; this fact gives us the analytic continuation of @xmath456 .",
    "of course , @xmath471 for all @xmath239 in the upper half plane .    for real @xmath239 ( except @xmath467 , @xmath87 , @xmath417 , @xmath418 , @xmath22 , and @xmath468 ) ,",
    "define @xmath472 ( we will use this notation to distinguish between the function @xmath459 on the real line and the function @xmath456 on the upper half plane . ) in order to apply theorem  [ titchthm ] , we must determine the real and imaginary parts of @xmath473 . outside of @xmath466",
    ", @xmath474 is piecewise constant ( in particular , constant between the points where @xmath459 is undefined ) since @xmath475 is imaginary there .",
    "the integrability of @xmath475 at @xmath476 and @xmath477 implies that @xmath473 is continuous there , which implies that @xmath478 for all @xmath479 .    to determine the behavior of @xmath474 for @xmath480",
    ", we just have to see how much it changes by at @xmath467 , @xmath87 , @xmath22 , and @xmath214 , since it is constant on @xmath481 , @xmath482 , @xmath483 , and @xmath484 .",
    "to do so , notice that if @xmath485 has a pole with residue @xmath486 at a point on the real axis , then @xmath459 changes by @xmath487 as one moves from the left of that point to its right .",
    "( to see this , integrate over a small semi - circle in the upper half plane , centered at the point . ) if @xmath488 , then @xmath489 therefore , if @xmath488 , then @xmath490 changes by @xmath491 from the left of @xmath92 to its right .    to determine the precise sign of @xmath492 when @xmath488 , we will need to know how @xmath493 behaves when analytically continued through the upper half plane .",
    "we know that it is positive on @xmath466 . if one analytically continues it along any path through the upper half plane that starts in @xmath466 and ends on the real axis to the left of @xmath417 , then the result is a negative imaginary number ( i.e. , one with argument @xmath494 ) .",
    "similarly , if the path ends to the right of @xmath418 , then the result is a positive imaginary number .",
    "thus , @xmath495 .",
    "in fact , @xmath496 , because @xmath497 it follows that @xmath490 increases by @xmath498 at @xmath467 .",
    "similarly , @xmath490 decreases by @xmath498 at @xmath468 .",
    "the analysis at @xmath87 and @xmath22 is slightly more subtle .",
    "we have @xmath499 , and @xmath500 .",
    "it turns out that @xmath501 and @xmath502 .",
    "to prove this claim , we will deal with @xmath503 .",
    "( the results about @xmath503 will be needed later , so this approach is worthwhile even though one might wish for a direct proof . )",
    "it is impossible for @xmath504 to vanish for @xmath505 , since @xmath474 is @xmath87 or @xmath22 for such @xmath239 , but @xmath473 can not be @xmath87 or @xmath22 ( since otherwise @xmath297 would have a singularity at @xmath239 , as one can see from ) .",
    "thus , the sign of @xmath504 is constant for @xmath239 in each of @xmath506 and @xmath507 .",
    "the imaginary part of the arccotangent does not depend on the branch used ( since the values of the arccotangent always differ by a multiple of @xmath4 ) . to determine the sign of the imaginary part of @xmath473",
    ", we will use the fact that for real @xmath92 with @xmath508 , @xmath509 in order to apply this formula to @xmath459 , we need to determine the sign of @xmath297 on the axis .",
    "we determined above how @xmath493 behaves .",
    "since @xmath510 we find , by combining the facts about @xmath493 with , that @xmath511 for @xmath512 , and @xmath513 for @xmath514 .    because @xmath515 is constant , we can deduce two important facts .",
    "first , we see that @xmath516 must be constant on @xmath506 and @xmath507",
    ". notice that in fact it is constant on @xmath517 $ ] and @xmath518 $ ] , because we showed earlier that it can not vanish at one of the endpoints of one of these intervals unless the interval consists only of one point .",
    "second , we see that @xmath519 for @xmath520 and @xmath521 for @xmath522 .",
    "thus , having taken a short detour , we can see that @xmath523 , and @xmath524 .",
    "it follows that @xmath490 increases by @xmath498 at @xmath87 iff @xmath422 , and decreases by @xmath498 at @xmath87 iff @xmath420 .",
    "notice that these are exactly the conditions under which @xmath525 is @xmath22 or @xmath87 , respectively .",
    "similarly , @xmath490 increases by @xmath498 at @xmath22 iff @xmath424 , and decreases by @xmath498 at @xmath22 iff @xmath426 , and these are exactly the conditions under which @xmath526 is @xmath87 or @xmath22 , respectively .",
    "the information that we have obtained determines @xmath490 , and in fact shows that @xmath527 in other words , @xmath528 .",
    "we would like to apply theorem  [ titchthm ] to conclude that the hilbert transform of @xmath529 must be @xmath503 ; for the hypotheses of the theorem to be satisfied , we need some integral estimates , in particular that the integrals @xmath530 exist for all @xmath531 and are bounded . to prove existence of the integral , we use the estimate @xmath532 as @xmath533 . to verify this estimate ,",
    "notice that as @xmath533 in the upper half plane , @xmath534 , and for such @xmath239 we have @xmath535 for some integer @xmath13 depending on @xmath239 and the branch of the arccotangent . for large @xmath239 , continuity implies that @xmath13 must be constant , and our knowledge of the behavior of @xmath456 on the real axis tells us that @xmath116 .",
    "it follows that @xmath532 , so the integrals must converge . to prove boundedness",
    ", we need only show that the integrals remain bounded as @xmath536 . to see that they do , notice that the limiting integrand has singularities , but they are only logarithmic singularities ( since @xmath485 has poles of order  @xmath22 there ) , so it is still integrable .",
    "we can now verify that @xmath432 .",
    "( this fact , which is necessary for @xmath363 to be admissible , was stated earlier , but the proof was postponed . ) to determine @xmath537 , we need to integrate @xmath406 from @xmath87 to @xmath22 .",
    "if @xmath538 denotes a semi - circle of radius @xmath539 centered at @xmath87 , lying in the upper half plane , and oriented clockwise , then for @xmath540 , cauchy s theorem implies that @xmath541 since @xmath542 , @xmath543 hence , @xmath432 .",
    "now theorem  [ titchthm ] tells us that because @xmath544 ( except where undefined ) , the imaginary part of @xmath459 is the hilbert transform of the real part , i.e. , @xmath545 to complete the proof of , we need more information about how @xmath504 behaves for @xmath546 $ ] .",
    "we know that @xmath547 for @xmath548 , by the definition of @xmath456 , so for such @xmath239 , @xmath549 if we can ensure that @xmath550 for all @xmath551 , then we will have proved",
    ".    we will deal first with the sign of @xmath454 . recall that @xmath406 is constant on @xmath506 , and is either @xmath87 or @xmath22 ( assuming @xmath552 ) .",
    "because of the lipschitz condition @xmath323 , it follows that either @xmath553 for all @xmath520 , or @xmath554 for all such @xmath239 , according as @xmath406 is @xmath87 or @xmath22 on that interval . integrating and using",
    "@xmath555 implies that @xmath556 for @xmath520 in the first case ( where @xmath557 ) , and @xmath558 in the second ( where @xmath421 ) .",
    "similarly , if @xmath559 then @xmath558 for @xmath522 , and if @xmath425 then @xmath556 for @xmath522 . therefore ,",
    "to prove , we need only prove the same inequalities as here , with @xmath454 replaced by @xmath504 .",
    "we have already shown that @xmath519 for @xmath520 , and that @xmath521 for @xmath522 .",
    "we know as well that @xmath557 if @xmath420 and @xmath421 if @xmath422 , and that similarly , @xmath423 if @xmath424 and @xmath425 if @xmath426 .",
    "( note that the only possible conditions under which @xmath417 or @xmath418 are roots of @xmath395 are @xmath427 and @xmath429 , respectively . ) these conditions , when combined with those derived in the previous paragraph , give us what we need .",
    "we conclude that for @xmath560 , we have @xmath561 iff @xmath562 . since @xmath563 , and is @xmath87 for @xmath408 , we see that for all @xmath479 ( and trivially for @xmath564 since then @xmath565 ) , @xmath566 this inequality implies , which completes our proof .",
    "thus , @xmath363 is indeed the unique admissible function such that @xmath392 is maximal .",
    "we leave to the reader the task of checking that applying this result to the specific functional arrived at in proposition  [ functionalprop ] leads to the explicit formula for @xmath86 given in theorem  [ mainthm ] .",
    "the theorems we have proved do not answer all the natural questions about the typical plane partition in a box , or about random lozenge tilings of hexagons .",
    "given a location @xmath85 in the normalized @xmath71 hexagon , we can ask whether the probability of finding a vertical lozenge near @xmath85 is given by @xmath84 . theorem  [ mainthm ]",
    "tells us that this is true if we average over all @xmath85 in some macroscopic region .",
    "however , it is conceivable that there might be small - scale fluctuations in the probabilities that would even out on a large scale .",
    "we believe that that is not the case .",
    "[ cep ] let @xmath293 be any open set in the @xmath567 hexagon containing the four points at which @xmath86 is discontinuous . as @xmath386 , the probability of finding a vertical lozenge at normalized location @xmath568 is given by @xmath569 , where the @xmath266 error bound is uniform in @xmath85 for @xmath568 .",
    "there is numerical evidence that conjecture  [ cep ] is true .",
    "also , the analogous result for random domino tilings of aztec diamonds has been proved in @xcite , and it is not hard to prove that the local statistics for the one - dimensional case described in section  [ sec - intro ] do in fact converge to i.i.d .",
    "statistics , so it is plausible that conjecture  [ cep ] is true .",
    "a similar result should also hold for higher - order statistics ( probabilities of finding configurations of several lozenges ) ; one can deduce explicit hypothetical formulas for these probabilities from the theorems and conjectures in @xcite .",
    "of course , we do not need to restrict our attention to hexagons , but can look at tilings with lozenges of any regions .",
    "hexagons do seem to involve the most elegant combinatorics and analysis , but one can prove in general that almost all tilings of large regions have normalized height functions that cluster around the solution to the problem of maximizing a certain entropy functional ; see @xcite for the details .",
    "we also conjecture an analogue of the arctic circle theorem of jockusch , propp , and shor .",
    "( see @xcite for the original proof , or @xcite for the proof of a stronger version on which our conjecture is based . )",
    "define the _ arctic region _ of a lozenge tiling to be the set of lozenges connected to the boundary by sequences of adjacent lozenges of the same orientation ( where a lozenge is said to be adjacent to another lozenge , or to the boundary , if they share an edge ) .",
    "[ aec ] fix @xmath103 .",
    "the probability that the boundary of the arctic region is more than a distance @xmath104 ( in normalized coordinates ) from the inscribed ellipse is exponentially small in the scaling factor @xmath57 .",
    "there are also several questions for which we do not even have conjectural answers .",
    "[ guess ] is there a simple way to derive the results of section  [ sec - typical ] without having to guess any formulas ?",
    "such a method would be much more pleasant than our approach",
    ". a good test case would be the following open question .",
    "[ q - analogue ] is there a @xmath570-analogue of theorem  [ mainthm ] ?",
    "of course , the non - trivial situation is when @xmath571 as @xmath386 ( although we do not know the precise relationship between @xmath570 and @xmath57 that will lead to interesting limiting behavior ) .",
    "there is a simple @xmath570-analogue of macmahon s enumeration of boxed plane partitions ( also due to macmahon ) , and a @xmath570-analogue of proposition  [ prodformula ] ( which can be established by a proof similar to that of proposition  [ prodformula ] ) .",
    "we believe that the answer to open question  [ q - analogue ] is yes , and that the same approach should work , but the guess work required is likely to be tedious .",
    "we hope that further development of these techniques will someday let one answer such questions more easily .",
    "[ space ] is there an analogue of theorem  [ mainthm ] for `` space partitions '' ( the natural generalization of plane partitions from the plane to space ) ?",
    "the answer to open question  [ space ] may well be yes , but it is extremely unlikely that similar techniques can be used to prove it .",
    "( for example , no analogue of macmahon s formula is known , and there is no reason to believe that one exists . )",
    "in section  [ sec - setup ] , we had to convert a sum to an integral .",
    "the sum was @xmath572 and we interpreted it as a riemann sum for the double integral @xmath573 for some function @xmath255 which we have not yet specified . in section  [ sec - setup ] , we claimed that the difference between the sum and the integral is @xmath266 , and that @xmath255 can be chosen so that @xmath234 and @xmath574 nowhere differ by more than @xmath575 . in this appendix , we will define @xmath255 and justify these claims .",
    "the main obstacle is that @xmath576 can be quite large ( infinite , in fact , when @xmath577 ) .",
    "we will now define a modification @xmath255 of @xmath229 designed to keep @xmath578 from being too large .",
    "we put @xmath257 and @xmath579 for @xmath580 ( so that @xmath581 ) . between these points",
    ", we will define @xmath255 so that it is a continuous , strictly increasing , piecewise linear function on @xmath281 $ ] such that @xmath574 is constant on intervals @xmath582 , @xmath574 is never smaller than @xmath583 or greater than  @xmath22 , and @xmath584 .",
    "there is no canonical way to do this ; one way that works is as follows .",
    "if @xmath585 , then set @xmath586 ( and similarly if @xmath587 set @xmath588 ) . then interpolate linearly to define @xmath255 in between the points at which we have defined it so far .",
    "notice that changing @xmath229 to @xmath255 does not change the sum , since @xmath589 .    to begin , for @xmath590",
    ", we define @xmath591 because @xmath592 , the mean value theorem implies that @xmath593 .",
    "consider small squares of side length @xmath594 , with their sides aligned with the @xmath271-  and @xmath239-axes and their upper right corners at @xmath595 , for @xmath596 .",
    "each square has area @xmath254 , and @xmath296 is bounded by @xmath597 , so we can safely remove up to @xmath598 squares from the domain of integration and the corresponding terms from the sum without changing either by more than @xmath266 .",
    "we will do so in order to restrict our attention to squares on which we can bound the partial derivatives of @xmath296 .",
    "we first remove the @xmath599 squares containing some point @xmath600 with @xmath601 .",
    "next , we remove all squares containing some point @xmath600 satisfying @xmath602 or @xmath603",
    ". we can check as follows that there are at most @xmath604 such squares .",
    "since @xmath605 is increasing and has range contained in @xmath281 $ ] , the set of all @xmath239 with @xmath603 has measure @xmath606 . also , as @xmath600 varies over each small square , @xmath607 and @xmath608 are constant . hence , in this step we are removing at most @xmath609 squares .",
    "thus , we can restrict our attention to squares containing only points @xmath600 with @xmath610 , @xmath611 , and @xmath612 .",
    "now we will estimate the difference between the sum and the integral .",
    "if we can show that on each square , @xmath296 varies by at most @xmath266 ( uniformly for all squares ) , then we will be done . to determine how much @xmath296 can vary over a square of side length @xmath594 , we compute @xmath613 the second term has absolute value at most @xmath614 ( since by assumption @xmath610 ) . to bound the first term , we start with the denominator .",
    "because @xmath615 everywhere , we have @xmath616 , so @xmath617 , and thus @xmath618 finally , since @xmath612 , we have @xmath619 the same holds for @xmath620 , of course .",
    "therefore , over one of the small squares of side length @xmath594 , @xmath296 can vary by at most @xmath266 .",
    "thus , the sum differs from the integral by at most @xmath266 .",
    "we thank tom brennan , persi diaconis , and noam elkies for useful discussions , the anonymous referee for pointing out an oversight in our proof , and valerie samn for helping with the figures .",
    "h.  cohn , n.  elkies , and j.  propp , _ local statistics for random domino tilings of the aztec diamond _ , duke math .  j.  * 85 * ( 1996 ) , 117166 , arxiv : math.co/0008243 . h.  cohn , r.  kenyon , and j.  propp , _ a variational principle for domino tilings _ , j.  amer .  math .",
    "* 14 * ( 2001 ) , 297 - 346 , arxiv : math.co/0008220 .",
    "g.  david and c.  tomei , _ the problem of the calissons _ , amer .",
    "monthly * 96 * ( 1989 ) , 429431 .",
    "i.  m.  gelfand and m.  l.  tsetlin , _ finite - dimensional representations of the group of unimodular matrices _ ( russian ) , dokl .",
    "nauk sssr * 71 * ( 1950 ) , 825828 ( reprinted in english in _",
    "izrail m.  gelfand : collected papers _ , springer - verlag , berlin , 1988 , vol .  2 , pp .",
    "653656 ) .",
    "w.  jockusch , j.  propp , and p.  shor , _ random domino tilings and the arctic circle theorem _ , preprint , 1995 , arxiv : math.co/9801068 .",
    "b.  f.  logan and l.  a.  shepp , _ a variational problem for random young tableaux _ , adv .  in math .",
    "* 26 * ( 1977 ) , 206222 ."
  ],
  "abstract_text": [
    "<S> using a calculus of variations approach , we determine the shape of a typical plane partition in a large box ( i.e. , a plane partition chosen at random according to the uniform distribution on all plane partitions whose solid young diagrams fit inside the box ) . </S>",
    "<S> equivalently , we describe the distribution of the three different orientations of lozenges in a random lozenge tiling of a large hexagon . </S>",
    "<S> we prove a generalization of the classical formula of macmahon for the number of plane partitions in a box ; for each of the possible ways in which the tilings of a region can behave when restricted to certain lines , our formula tells the number of tilings that behave in that way . </S>",
    "<S> when we take a suitable limit , this formula gives us a functional which we must maximize to determine the asymptotic behavior of a plane partition in a box . </S>",
    "<S> once the variational problem has been set up , we analyze it using a modification of the methods employed by logan and shepp and by vershik and kerov in their studies of random young tableaux . </S>"
  ]
}