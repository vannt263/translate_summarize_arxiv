{
  "article_text": [
    "following the basic prescriptions of quantum mechanics , one could potentially calculate any physical quantity . finding the solutions of the schrdinger equation , the wave functions and the associated energies",
    "is all that it is required .",
    "however , the computational cost of obtaining the solutions of many - body problems is well known to increase exponentially with the number of particles .",
    "minimizing this exponential cost by either improved algorithms or an insightful approximation is the central paradigm of condensed matter theory .",
    "many physical quantities ( observables ) are only functionals of the probability density : the square of the modulus of the wave function . some other observables , like the ground - state energy , are only functionals of the electronic density  @xcite . however , very important quantities , such as the current density or excitonic transition matrix elements , depend critically on the wave function .    in confined systems , if the hamiltonian has time reversal symmetry , a real - value wave function is well known to exists .",
    "however , as soon as periodic boundary conditions are introduced in the hamiltonian or a magnetic field is applied , the amplitude of the wave function is , in general , complex . if a wave function has a complex amplitude , both its modulus @xmath0 and its complex phase @xmath1 can depend on the many - body coordinate @xmath2 , where @xmath3 is the position of electron @xmath4 and @xmath5 is the number of electrons .",
    "in addition , for fermions , the many - body wave function must change sign when the coordinates of any pair @xmath3 , @xmath6 are interchanged in @xmath7 . in principle , if the wave function is real - valued , one only needs to determine the exact surface where the wave function is zero and changes sign ( the node ) to find the ground - state energy with diffusion monte carlo ( dmc ) methods .",
    "any error in the determination of the node results in an overestimation of the ground - state energy  @xcite .",
    "the standard dmc method  @xcite and improvements  @xcite related to it require , as an input , a trial wave function @xmath8 , where both the modulus @xmath9 and @xmath10 can be chosen to be real .",
    "the node is the surface @xmath11 in the @xmath12 dimensional many - body space where @xmath13 .",
    "the cost of a single dmc step in the standard algorithm is polynomial in the number of electrons @xmath5 , and can be reduced to almost linear if localized orbitals are used  @xcite . as a consequence ,",
    "the existence of an algorithm that finds the required node with polynomial cost in @xmath5 has been subject of controversy  @xcite .",
    "it has been argued that one of the most important problems in many - body electronic structure theory is to accurately find representations of the fermion nodes  @xcite , which could help in solving the so - called `` fermion sign problem . ''    in general , a guess of the node @xmath11 and the phase @xmath10 can be obtained from mean field or quantum chemistry methods [ such as density functional theory ( dft ) , hartree - fock , or configuration interaction ( ci ) ] . this initial trial wave function",
    "is often improved using various methods  @xcite within a variational monte carlo ( vmc ) context .",
    "this standard approach depends on the accidental accuracy of the mean field to find the node or the possibility to perform accurate ci calculations to pre - select a multideterminant expansion for @xmath14 .",
    "in addition , it can be claimed that a variational optimization of the trial wave function energy or its energy variance only improves the nodes indirectly  @xcite .    in the last two years",
    ", we have developed a method to circumvent the sign problem for the ground and low - energy eigenstates of confined systems  @xcite .",
    "this method was recently validated in real molecular systems  @xcite .",
    "we called the method self - healing diffusion monte carlo ( shdmc ) since the nodes are corrected in a dmc context ( as opposed to a vmc optimization ) and the wave function converges to nearly exact  @xcite or state - of - the - art solutions  @xcite , even starting from random .",
    "this approach is based on the proof  @xcite that by locally smoothing the discontinuities in the gradient of the fixed - node ground state @xmath15 at @xmath16 , a new trial wave function can be obtained with improved nodes .",
    "this proof enables an algorithm that systematically moves the nodal surface  @xcite @xmath17 towards that of an eigenstate .",
    "the trial wave function is self - corrected within a recursive dmc approach .",
    "if the form of trial wave function is sufficiently flexible and given sufficient statistics , the process leads to an exact eigenstate many - body wave function  @xcite .",
    "the success of the fixed - node approximation  @xcite used in the standard dmc algorithm for real wave functions is related to the quadratic dependence of the error in the fixed - node energy with the distance between @xmath11 and the exact node  @xcite @xmath18 .",
    "because the probability density goes to zero quadratically at @xmath19 , errors due to small and short wave - length departures of @xmath11 from @xmath19 do not propagate far into the nodal pocket .",
    "since the dmc energy is dominated by the average far from the node , dmc tolerates short wave - length departures of @xmath11 around @xmath19 .    however , if the amplitude of wave function is complex , one must also determine its phase @xmath10 .",
    "the ground - state energy of complex wave functions can be calculated within the fixed - phase approximation  @xcite of dmc ( fpdmc ) .",
    "but any error in the phase also results in an overestimation of the ground - state energy even if the exact nodes are provided  @xcite . for complex wave functions , moreover",
    ", the error in the phase can be more dramatic than the nodal error , since the gradient of phase @xmath20 is sampled everywhere , and in particular in the regions of large probability density ( see below and ref . ) .",
    "since ( i ) periodic or infinite systems are dominant in solid state physics , ( ii ) the ability to calculate complex - valued wave functions ( with current ) is crucial to understanding transport , ( iii ) the response of quantum systems to magnetic fields is key for basic understanding of correlated phenomena and even applications such quantum computation , ( iv ) most physical systems of interest are not confined , and ( v ) the error in the phase affects the result more than the error in the node , solving _ `` the phase problem '' _ is , perhaps , as important as solving the sign problem .    in this paper a method is derived to simultaneously obtain not only the node but also the complex amplitude of the trial wave function for lower energy eigenstates of hamiltonians with periodic boundary conditions or under applied magnetic fields .",
    "it is shown that if the phase of the wave function is a scalar function , there is a ` _ special _ ' gauge transformation of the many - body hamiltonian where the wave functions is real .",
    "these wave functions have nodes that are optimized as in original shdmc method .",
    "if the phase can only be expressed by multi - valuate function , the nodal surface may have a reduced dimensionality but there is no constraint to update the wave - function in shdmc if the nodes are removed .",
    "the method is applied and validated in a model system studied previously  @xcite where near - analytical solutions can be obtained .",
    "the scaling of the cost of this new approach is linear in the number of independent degrees of freedom of the phase .",
    "the method is a generalization of both the `` fixed - phase '' approach  @xcite and the self - healing dmc algorithms developed to circumvent the sign problem  @xcite .",
    "the amplitude of the wave function is free to adjust to the complex weight of the walkers in a recursive approach .    a study of refs . in reverse chronological order ( with increasing detail )",
    "is recommended before reading this article .",
    "studying again the seminal fixed - phase paper by ortiz , ceperley and martin ( ocm )  @xcite and the importance sampling method by ceperley and alder  @xcite is also highly encouraged .",
    "the rest of the paper is organized as follows : in section [ sc : freephase ] , the shdmc and fpdmc methods are generalized and blended into a new algorithm that optimizes the complex amplitude ( and , if there is one , the node ) of the trial wave function within a dmc approach . as in the case of shdmc , the trial wave function is adjusted recursively within a generalized dmc approach . in section [ sc : periodic ] , the generalization of shdmc is applied to a model hamiltonian with periodic boundary conditions .",
    "the results are compared with converged ci results for the same model .",
    "in section [ sc : magnetic ] , the zeeman splittings of the ground and excited states of a model system are calculated and compared with converged ci results .",
    "section [ sc : coulomb ] describes the results obtained with a realistic coulomb interaction .",
    "finally , section [ sc : conclusion ] discusses the advantages , perspectives , and possible applications of these methods for many - body problems .",
    "this section shows how one can obtain an improved trial wave function @xmath21 by applying a smoothing operator @xmath22 and an evolution operator @xmath23 ( during a small imaginary time @xmath24 ) to the trial wave function @xmath25 provided before .",
    "the limit @xmath26 is reached recursively as the iteration index @xmath27 .    following the seminal ideas of ocm  @xcite",
    ", @xmath28 can be written  @xcite as an explicit product of a complex phase and an amplitude @xmath29 .",
    "ocm chose @xmath9 to be symmetric ( bosonic like ) , real , and positive , while the phase factor @xmath30 was antisymmetric for particle exchanges .",
    "however , the symmetry of a the phase factor is arbitrary : a symmetric phase factor can be obtained as @xmath31^{1/2 }   \\ ; , \\ ] ] since both @xmath32 and its complex conjugate change sign for particle exchanges .",
    "therefore , any eigenstate can also be written as the product of a complex - symmetric phase factor @xmath33 ( like the jastrow factor ) and a real function @xmath9 where the symmetry of @xmath9 depends on whether fermions or bosons are considered .    in this work",
    "it is proved ( see subsection [ ssc : gauge ] ) that if the phase of a fernionic eigenstate is a scalar function , then @xmath9 has the same nodal structure than real functions",
    ". otherwise @xmath9 might not be zero except for @xmath34 .",
    "thus , the node of the trial wave function @xmath28 is given in any case by @xmath9 but the dimensionality of the nodal surfaces depend on the phase .",
    "the evolution for an additional imaginary time @xmath24 of @xmath32 is given by @xmath35 \\\\ = & \\ ; \\phi_t({\\bf r},\\tau ) e^ { { \\bf i } \\phi({\\bf r})}. \\label{eq : phi_tau}\\end{aligned}\\ ] ] equation ( [ eq : phi_tau ] ) includes all the time dependence of the wave function in @xmath36 , while the phase @xmath37 remains fixed  @xcite .    in eq .",
    "( [ eq : u ] ) , @xmath38 is the fixed - node evolution operator , which is a function of the fixed - node hamiltonian operator @xmath39 given by @xmath40 \\right\\ } \\ ; .\\ ] ] the second term on the right - hand side of eq .",
    "( [ eq : hfn ] ) adds an infinite potential  @xcite at the points @xmath7 with minimum distance to any point on the nodal surface @xmath41 $ ] smaller than @xmath42 .",
    "the fixed - node hamiltonian is dependent on @xmath43 since the nodes @xmath44 change from one iteration to the next .    in eq .",
    "( [ eq : hfn ] ) , the many - body hamiltonian @xmath45 is given in atomic units by @xmath46 where @xmath47 is a vector potential at point @xmath3 , @xmath48 includes the electron - electron interaction and any external potential , and @xmath49 is a _ complex _",
    "@xcite energy reference , adjusted to normalize the projected wave function , that cancels out any phase shift resulting from arbitrary gauge choices for @xmath50 ( see remarks below ) .    using eq  ( [ eq : u ] )",
    ", one can easily obtain @xmath51   = & -   e^{-{\\bf i } \\phi({\\bf r } ) }   \\hat{\\mathcal{h}}_{fn } e^{-\\tau \\hat{\\mathcal{h}}_{fn } } \\psi_t({\\bf r},\\tau^{\\prime } )   \\nonumber \\\\",
    "= & -\\left[e_l({\\bf r } , \\tau)-e_t\\right ] \\phi_t({\\bf r},\\tau )   \\end{aligned}\\ ] ] with @xmath52 \\right .",
    "\\nonumber \\\\   & \\ ; \\ ; \\ ; \\ ; \\ ; \\ ; \\ ; \\ ; \\ ; \\ ; \\ ; \\ ; \\ ; +   \\left .",
    "\\frac{{\\bf \\nabla}_j \\cdot \\left [ { \\bf a}_j   + { \\bf \\nabla_j } \\phi({\\bf r } ) \\right]}{2 } \\right\\}. \\nonumber\\end{aligned}\\ ] ] in eq .",
    "( [ eq : schrodinger ] ) , @xmath53 can be a real constant only if @xmath54 is an eigenstate of @xmath55 .",
    "in general , for an arbitrary trial wave function , @xmath53 is a complex function of @xmath7 .",
    "the real part of @xmath53 is given by the first three terms in eq .",
    "( [ eq : el ] ) , while the imaginary contribution is given by the last one .",
    "ocm s fixed - phase approximation results from considering only the real part  @xcite of @xmath56 . with little effort",
    ", one can obtain eq .",
    "( 3 ) of ocm s work assuming @xmath57=0 $ ] , which leads to a continuity - like equation for fluids .",
    "note that if @xmath10 is held fixed and @xmath58 \\ne 0 $ ] [ see eqs .",
    "( [ eq : u ] ) , ( [ eq : phi_tau ] ) , ( [ eq : schrodinger ] ) , and ( [ eq : el ] ) ] , then @xmath36 must not only change its modulus but also must be free to drift away from the real values as @xmath24 increases .",
    "if at @xmath59 an initial distribution of @xmath60 walkers @xmath61 is generated to be equal to @xmath62 , within a generalization of the importance sampling algorithm of ceperley and alder  @xcite ( see below ) , @xmath63 should evolve in imaginary time as @xmath64 clearly @xmath63 can be complex for @xmath65 if @xmath66~\\ne~0 $ ] [ see eq .",
    "( [ eq : schrodinger ] ) ] .    replacing eq .",
    "( [ eq : schrodinger ] ) into eq .",
    "( [ eq : ftau ] ) , and following a procedure almost identical to the one used in ref .",
    ", one obtains @xmath67 \\right \\ } \\nonumber \\\\ & - \\left [ e_l({\\bf r})-e_t \\right ] f({\\bf r},\\tau ) ,   \\label{eq : far - dmc}\\end{aligned}\\ ] ] where @xmath68 and @xmath69 is the complex local energy constructed using eq .",
    "( [ eq : schrodinger ] ) . to obtain eq .",
    "( [ eq : far - dmc ] ) one must to assume that @xmath70 which implies that unlike the standard dmc algorithm  @xcite , there is an error in eq .",
    "( [ eq : far - dmc ] ) when @xmath71 if @xmath72 is not an eigenstate .",
    "this is only an apparent limitation since ( i ) @xmath73 at first can be made as small as required for eq .",
    "( [ eq : approx ] ) to be valid , ( ii ) @xmath73 can be increased later as the wave function improves and converges to an eigenstate , ( iii ) the limit @xmath74 is reached by applying this free - amplitude method recursively ( see below ) , and ( iv ) @xmath24 is already limited to be small in shdmc with correlated sampling so that the weights remain close to @xmath75 ( see below ) .",
    "although eq .",
    "( [ eq : far - dmc ] ) above for @xmath63 is identical to eq .",
    "( 1 ) in ref .",
    ", it now has a slightly more _ complex _ interpretation as a stochastic process .",
    "each member of an ensemble of systems ( walker ) undergoes ( i ) a random diffusion caused by the zero - point motion and ( ii ) drifting by the trial quantum force @xmath76 [ which depends only on @xmath9 and not on the phase ] , but in variance with ref . , ( iii ) each walker carries a complex phase . in a nonbranching algorithm ,",
    "the complex weight of the walkers is multiplied by @xmath77\\delta\\tau\\}$ ] at every time step .",
    "similar to the case of the `` simple '' shdmc algorithm ( see refs .   for details ) , the weighted distribution of the walkers can be written as @xmath78 in eq .",
    "( [ eq : evoltau ] ) , @xmath79 corresponds to the position of the walker @xmath80 at step @xmath4 of @xmath81 equilibrated configurations .",
    "the _ complex _",
    "weights @xmath82 are given by @xmath83 \\tau}\\end{aligned}\\ ] ] with @xmath84 where @xmath49 in eq .",
    "( [ eq : weights ] ) is now a _ complex _",
    "energy reference periodically adjusted so that @xmath85 and @xmath24 is @xmath86 ( @xmath87 is a small number of steps and @xmath88 is a standard dmc time step ) .",
    "the trial wave function @xmath89 for the next iteration can be obtained as follows : all wave functions can be expanded in a basis as @xmath90 in eq .",
    "( [ eq : trialwf ] ) , @xmath91 represents a truncated sum , @xmath92 forms a complete orthonormal basis of the antisymmetric hilbert space  @xcite , and @xmath93 is a symmetric jastrow factor .",
    "the @xmath94 are complex coefficients to be defined [ see eq .",
    "( [ eq : lambda ] ) ] .",
    "note that the expressions  @xcite @xmath95/ ( 2 i ) +   \\pi n \\end{aligned}\\ ] ] allow the computation of all the quantities involved in @xmath96 in terms of gradients and laplacians of @xmath97 and @xmath98 . in eq .",
    "( [ eq : phaselog ] ) @xmath99 is an arbitrary integer that changes the riemann branch of the natural logarithm @xmath100 , but does not contribute to the gradient within a branch .",
    "the local energy is thus independent on the choice of @xmath99 but at the riemann cuts where , sometimes , @xmath99 has to change to make the phase continuous .",
    "however , the probability of a walker to touch the riemann cut is , in practice , zero .    from eqs .",
    "( [ eq : u ] ) , ( [ eq : ftau ] ) and ( [ eq : evoltau ] ) , one can formally obtain @xmath101 the local smoothing operator is defined as @xmath102 applying eq .",
    "( [ eq : deltaexp ] ) to both sides of eq .",
    "( [ eq : nextevol ] ) , using eq .",
    "( [ eq : evoltau ] ) , and integrating over @xmath7 , one can easily obtain @xmath103 with @xmath104 where @xmath105 normalizes the jastrow factor .",
    "@xmath106 is the standard time - step correction [ eq .",
    "( 33 ) in ref .  ] : @xmath107    note that @xmath108 includes a jastrow factor , thus eq .",
    "( [ eq : deltalambda ] ) reduces to the one used in the original `` simple '' shdmc algorithm  @xcite for @xmath109 .",
    "in addition , as suggested by umrigar  @xcite for the ground - state shdmc algorithm  @xcite , correlated sampling can be used also for walkers with complex weight .",
    "one can sample @xmath110 , which results in @xmath111 \\gamma({\\bf r}_i^j).\\end{aligned}\\ ] ] these new @xmath112 [ eq .  ( [ eq : deltalambda ] ) ] are used to construct a new trial wave function [ eq .  ( [ eq : trialwf ] ) ] recursively within dmc . equation ( [ eq : lambda ] ) can be related to the maximum - overlap method used for bosonic wave functions  @xcite .",
    "the error of @xmath113 is obtained by sampling @xmath114",
    "\\gamma({\\bf r}_i^j ) \\right|^2 .\\end{aligned}\\ ] ] the truncation of the expansion of the delta function [ eq .  ( [ eq : deltaexp ] ) ] is a key ingredient in shdmc since it decides how local is the smoothing operator @xmath22 and prevents noise to ruin the quality of the trial wave function .",
    "if the absolute value of the error of @xmath113 is larger than @xmath115 , the algorithm sets @xmath112 equal to zero [ which defines the truncation criterion used in the sums ( @xmath91 ) involved in eqs .",
    "( [ eq : trialwf ] ) , ( [ eq : deltaexp ] ) and ( [ eq : sequence ] ) ] .",
    "see ref . for a detailed theoretical justification of the truncation procedure and the algorithm used . briefly here , the coefficients @xmath116 are sampled at the end of each sub - block of @xmath87 dmc steps .",
    "statistical data is collected for number of sub - blocks @xmath117 before a wave function update . at first , @xmath117 is set to a small number and increased according to the recipe given in ref . . in short ,",
    "the algorithm detects automatically the dominance of noise when the projection of two successive sets of @xmath118 becomes small and multiplies by a factor larger than 1 the number of sub - blocks @xmath117 ( see ref . for more details ) . as a result , the total number of configurations @xmath81 sampled increases as the algorithm progresses",
    ". therefore the statistical error is reduced , and the number of basis functions retained in the expansion increases over time .",
    "thus , the smoothing operator @xmath22 tends to the delta function as @xmath117 increases , which allows the shdmc method to sample the wave function with increasing detail .",
    "the first quarter of the data in each block , following a wave function update , is discarded .    in practice ,",
    "the only difference between this new approach and the original shdmc method is the complex weight and the limitation for propagation to small @xmath24 .",
    "therefore , a nonbranching algorithm for small @xmath24 has been used ( see ref . for details ) . however , there are some formal differences on the justification of the convergence of the shdmc method that are discussed in the next subsections",
    ".      the phase @xmath10 must be continuous at any point of @xmath7 where @xmath119 .",
    "otherwise , if @xmath10 is not continuous , its gradient in the local energy will introduce an effective infinite potential at the discontinuity that will force @xmath120 . in some cases ,",
    "however , these discontinuities in the phase are not physical@xcite and they can be removed by changing the riemann sheet index @xmath99 in eq .",
    "( [ eq : phaselog ] ) . as a consequence ,",
    "the wave functions can be split into two classes . in the first class",
    "different riemann sheets of @xmath10 are _ not _ connected . in that case , one can choose as phase a single sheet of the riemann surface the phase in this class can be a continuous scalar function of @xmath7 for every @xmath7 . the real wave functions , with constant phase , are special case of this class . in the second class ,",
    "the riemann surfaces of @xmath10 for different @xmath99 are connected at the riemann cuts .",
    "thus a continuous @xmath10 can only be described by a multi - valuate function of @xmath7 .    _ eigenstates with a scalar phase : _ since @xmath121 for any scalar function @xmath122 , the magnetic field @xmath123 is invariant for the gauge transformations  @xcite @xmath124 $ ] , where @xmath122 is an arbitrary symmetric scalar function of @xmath7 and @xmath125 is an arbitrary function of @xmath24 ( independent of every @xmath3 in @xmath7 ) .",
    "if @xmath126 is selected to be an eigenstate of @xmath127 for a given gauge and if @xmath10 is a scalar function , then a change in gauge @xmath128 could be readily compensated in the phase by @xmath129 without affecting @xmath9 [ since @xmath130 and @xmath131 always appear added in eq .",
    "( [ eq : el ] ) ] .",
    "this property is particularly important , since implies that for this class of eigenstates of @xmath127 there is a ` _ special _ ' gauge where the wave function is real .",
    "note that if one sets @xmath132 in eq .",
    "( [ eq : gauge ] ) then @xmath133 .",
    "therefore , the new phase is a constant that can be chosen to be zero .",
    "the vector potential in this special gauge is a many - body object which includes the gradient of the many - body phase of the wave function in a single particle gauge .",
    "the norm @xmath134 is invariant since the effective potential in eq .",
    "( [ eq : el ] ) is invariant using eq . ( [ eq : gauge ] ) .",
    "this is expected since the expectation value of an arbitrary operator @xmath135 must be independent of the gauge choice for non - degenerate eigenstates . in particular , the nodes , which are given by @xmath134 , are also invariant to gauge transformations .",
    "since the new phase is a constant , it can be easily shown that in the special gauge , the amplitude of those eigenstates has the same structure as the trial wave function used in the fixed - node approximation for real wave functions .",
    "shdmc self adjusts to an arbitrary gauge change @xmath136 because @xmath10 is modified recursively by a change in the local energy in eq .",
    "( [ eq : el ] ) of the form @xmath137   + \\frac{1}{2 } |{\\bf \\nabla}_j \\delta\\lambda({\\bf r})|^2 \\right\\ } \\nonumber \\\\   &   - \\ ;   { \\bf i } \\sum_j^{n_e } \\left\\ {   \\frac{{\\bf \\nabla}_j   \\phi_t({\\bf r},\\tau ) } { \\phi_t({\\bf r},\\tau)}\\cdot { \\bf \\nabla_j } \\delta\\lambda({\\bf r } )    +    \\frac{1}{2}\\nabla^2_j \\delta\\lambda({\\bf r } ) \\right\\}. \\nonumber\\end{aligned}\\ ] ]    _ eigenstates with a multi - valuate phase : _ on the other hand if @xmath10 is not a scalar function then , @xmath138 and , therefore , @xmath139 can not be included in the vector potential without introducing an artificial many - body magnetic field . in that case , as pointed out timely by an anonymous referee , there might be nodes only where @xmath140 .",
    "eigenstates with this type of nodes , with reduced dimensionality , can be found in states with current , degeneracy or magnetic fields .",
    "sumarizing , the norm of the complex wave - functions of the eigenstates that have a scalar phase in @xmath7 has the same structure as the real wave function used in the fixed - node approach because there is a special gauge transformation where the wave function is real valued .",
    "this property has a formal importance since it allows extending theorems developed in the context of the fixed - node approximation . instead ,",
    "if different riemann sheets of @xmath10 are continuously connected , a continuous phase can not be described by a single scalar function .",
    "then dimensionality of the nodal surface might be smaller and limited to the cases in @xmath7 where @xmath141 .",
    "the nodes are an obstacle for dmc ; shdmc , however , converges to eigenstates regardless of the dimensionality of the nodes ( see below ) .",
    "_ convergence of shdmc to eigenstates : _ in [ ssc : gauge ] it is shown that the wave - function of any fermionic eigenstate can be factorized into an anti - symmetric real function @xmath9 , with nodes , and a symmetric phase factor ( see eq .",
    "( [ eq : phasefactorsymm ] ) ) .",
    "the dimensionality of the nodal surface depends on the phase properties .",
    "since the amplitude can not change at the node in dmc , nodes are the obstacle to overcame by shdmc .",
    "convergence is not affected if the initial trial wave function has no nodes because , in this case , the amplitude and the phase can evolve with @xmath24 everywhere .",
    "indeed , shdmc can be started from a linear combination of real and imaginary parts with different nodes .",
    "as noted by a referee , in this class of functions two particles can exchange without crossing a node .",
    "however , the convergence of shdmc is not affected in theory and it is not affected in practice .",
    "but , if the phase is a scalar function , nodes will develop as the trial wave function converges to an eigenstate . in that limit",
    ", a kink at the node should appear@xcite until the exact node is found .",
    "the convergence of the shdmc approach when the trial wave function approaches an eigenstate and shows nodes , is based on the proof  @xcite that locally smoothing the kinks of the fixed - node wave function improves the nodes .",
    "this proof can be trivially extended to a complex wave function ( when @xmath57\\ne 0 $ ]  ) , breaking the time evolution into a sequence of pure real evolution followed by an imaginary evolution .",
    "if one assumes @xmath142=0 $ ] , the present approach reduces to shdmc method , but using the effective potential of the fixed - phase hamiltonian  @xcite .",
    "thus the best nodes in @xmath143 for a given phase @xmath10 can be obtained by running shdmc in a fixed - phase stage .",
    "it is trivial to show that the phase , in turn , improves if the imaginary contribution is allowed to evolve a short time from a trial wave function with optimal nodes . in principle",
    ", a shdmc fixed - phase stage can be propagated to infinite imaginary time @xmath24 within a branching algorithm .",
    "the evolution of the phase , instead , is limited to short times [ for eq .",
    "( [ eq : approx ] ) to be valid ] . in this work , however , the real and the imaginary parts of the wave function are allowed to evolve simultaneously during a short time without any observed adverse effect on the accuracy .",
    "_ phase and nodal errors : _ note in eq .",
    "( [ eq : el ] ) that as in the fixed - phase approach  @xcite , an effective potential @xmath144 is added to @xmath48 , which depends in turn on @xmath145 and @xmath50 .",
    "thus small errors in the phase @xmath146 have a global impact [ in particular far from the node , where @xmath147 .",
    "in contrast , small errors in @xmath9 only slightly displace the node and have smaller impact on the energy  @xcite [ since the local energy is seldom sampled because @xmath148 at @xmath11 ] . for eigenstates without nodal surfaces",
    "the phase is the sole source of error .",
    "shdmc provides a method to correct both the phase and the nodal error .",
    "_ complex @xmath49 : _ note that when @xmath125 is changed in eq .",
    "( [ eq : gauge ] ) , it just changes the normalization of @xmath14 and , if complex , introduces a global phase shift ; however , @xmath125 does not affect the local energy or other observables .    for a random trial wave function @xmath150 and an arbitrary choice of gauge for @xmath50",
    ", @xmath151 will have both real and imaginary components .",
    "the average over the walkers  positions will have a real contribution , which affects the norm , and a complex contribution , which introduces a global phase shift .",
    "the average of @xmath152 only contributes to @xmath125 .",
    "the correlated sampling approach is obviously more efficient when the distribution of complex weights is centered around 1 since the error in the coefficients is minimized [ see eq .",
    "[ eq : deltalambda2 ] and use the standard expression for the variance ] .",
    "@xmath49 in eq .",
    "( [ eq : weights ] ) is thus complex . the real part of @xmath49 renormalizes the wave function ( that is , keeps the population of walkers constant ) .",
    "the imaginary part of @xmath49 removes the global phase shift [ the average complex contribution of @xmath153 that only contributes to @xmath125 ] . for a converged trial wave - function , @xmath155 .    _",
    "upper bound properties : _ the present approach should not be considered as a method to estimate the energy of the trial wave function but instead as a method to optimize the trial wave function before a final fpdmc calculation . however , since the real part of @xmath96 corresponds to the fixed - phase approximation , the real part of @xmath49 also converges to an upper bound of the ground - state energy .",
    "this upper bound can be higher than the fixed - phase approximation ( if the limit of @xmath74 is not reached or the basis @xmath92 is too small ) .",
    "therefore , a standard fpdmc calculation  @xcite ( with branching ) must be performed to obtain final values for the ground - state energy .",
    "_ known limitations and solutions : _ the present approach is inefficient when the energy of the first excited state @xmath156 of the fixed - phase hamiltonian is too close to the ground - state energy @xmath157 , since the coefficient of the excited state component of the trial wave function decays as @xmath158 $ ] . in that regime , satisfactory results can be obtained as follows : begining with a small value for @xmath117 , keep @xmath117 fixed for a number of iterations until the lower energy excitations decay and , then release @xmath117 , allowing the high energy components of the wave function to converge .",
    "moreover , the approximate excited - state wave functions can be calculated ( see ref . ) and the lowest energy linear combination can be determined with correlated function monte carlo @xcite , vmc  @xcite or directly in fpdmc using a restricted basis of low energy states . a final alternative is to run this free - amplitude shdmc method with larger @xmath159 but using a smaller basis given by a few approximated excited states .",
    "the excited states can be found as described in the next section .",
    "earlier estimates of excited state energies in the presence of magnetic fields have been made by diagonalizing a matrix of correlation functions in imaginary time  @xcite .",
    "in addition , calculations of excited states have been reported with the auxiliary field approach  @xcite . the present algorithm , in contrast ,",
    "is almost identical to the shdmc method  @xcite developed for the ground state and lower excitations of real wave functions .",
    "the only relevant difference with ref .",
    "is the complex weight of the walkers .",
    "thus the free - amplitude shdmc method described above for the ground state can be generalized in a straightforward way to study excited states as in ref . .",
    "readers are encouraged to follow a detailed theoretical justification of the excited state algorithm in ref .  .",
    "here only some key steps are described [ in particular , note eqs .",
    "( [ eq : bra ] ) and ( [ eq : xi ] ) that were omitted in ref .   and",
    "are relevant for a non - unitary jastrow factor ] .    as in the importance sampling algorithm  @xcite , the generalization given by eq .",
    "( [ eq : far - dmc ] ) requires that @xmath160 be zero only at the nodes @xmath161 of @xmath162 , being free to change both its modulus and phase elsewhere .",
    "therefore , @xmath163 can develop a projection into any lower energy state consistent with @xmath164 . to obtain an excited state ,",
    "the wave function @xmath165 must be projected in the subspace orthogonal to the ground state and any other excited state calculated before . in alternative approaches such as correlation function monte carlo  @xcite ,",
    "the orthogonality of excited states is achieved by diagonalizing a generalized eigenvalue problem .",
    "one could argue that the excited states obtained with that approach share nodal error of the ground state .",
    "one of the advantages of shdmc is that the diagonalization of a large matrix of excitations is avoided , which makes possible the consideration of a larger number of degrees of freedom .",
    "in addition , the nodes of each excitations are found independently .",
    "but in shdmc , unless special conditions are satisfied  @xcite , one must calculate lowerlying energy states before attempting the calculation of higher excited states .",
    "a projector is constructed with approximated expressions of the @xmath166 eigenstates @xmath167 calculated earlier as @xmath168 in eq .",
    "( [ eq : orthogonality ] ) is the multiplication by a jastrow . for a non - unitary @xmath169",
    "the set @xmath170 is nonorthogonal .",
    "however , the conjugate ( dual ) basis  @xcite that satisfies @xmath171 can be obtained statistically as @xmath172 with @xmath173 where @xmath174 is the trial wave function used to evaluate earlier the state @xmath175 for @xmath176 .",
    "note that the exponential involving @xmath177 moves to the denominator in eq .",
    "( [ eq : xi ] ) as compared with eq .",
    "( [ eq : lambda ] ) .",
    "since @xmath178 is real , the phase of @xmath179 must be conjugated to the phase of @xmath180 . the coefficients @xmath181 should be sampled during the final fpdmc step ( i.e. , when the final excited energy is sampled ) .",
    "the projection of the conjugate function @xmath182 onto earlier conjugate states should also be removed to obtain @xmath183 .",
    "furthermore , statistical errors in @xmath184 can be partially filtered by inverting the overlap matrix @xmath185 as @xmath186    the scalar products resulting from applying @xmath187 in eq .",
    "( [ eq : orthogonality ] ) are given by @xmath188 with @xmath189 since @xmath190    the extension of shdmc to the next excited @xmath191 can be thought of as the recursive application of the evolution operator @xmath192 , the projector @xmath193 [ eq  ( [ eq : orthogonality ] ) ] , and a smoothing operation @xmath22 [ see eq .",
    "( [ eq : deltaexp ] ) ] to a trial wave function @xmath194 [ see eq .",
    "( [ eq : shdmcexcited ] ) ] .",
    "this procedure can be derived analytically  @xcite as follows : @xmath195 replacing @xmath196 in the infinite product in the second line of eqs .",
    "( [ eq : shdmcexcited ] ) with @xmath192 in the third line generates the same projector  @xcite . in turn , we proved  @xcite that replacing @xmath197 with a large class of local smoothing operators @xmath198 has the same effect on the nodes .",
    "the fixed - node hamiltonian depends on the iteration index @xmath43 because the trial wave function , the node , @xmath49 , and the phase are different at every iteration .",
    "finally , the norm of the projected function can be fixed by adjusting @xmath49 in every iteration @xmath43 .    for states with inequivalent nodal pockets",
    ", special care must be taken within the algorithm to avoid systematic errors ( see ref .",
    "@xcite for additional details about the algorithm ) .",
    "usually periodic boundary conditions in a supercell with dimensions @xmath199 , @xmath200 and @xmath201 are set when studying crystalline systems that simulate an infinite solid . by using the bloch theorem  @xcite ,",
    "the trial wave function at @xmath202 can be written as the product of a many - body phase@xcite times a periodic part  @xcite @xmath203 as @xmath204 with @xmath205 for any @xmath4 , where @xmath206 , with @xmath207 being arbitrary integers .",
    "@xmath203 , in turn ,  @xcite can be written as a product of a multi - determinant expansion times a jastrow factor .",
    "each orbital entering each determinant in @xmath208 can be expanded in plane waves that satisfy periodic boundary conditions .",
    "the theory developed in section [ sc : freephase ] can then be applied to periodic systems by setting @xmath209 .",
    "note , however , that since @xmath203 is in general a complex function , the phase entering in @xmath96 [ see eq .",
    "[ eq : el ] ] must include both the phase of @xmath203 and the many - body bloch phase .",
    "the resulting wave function @xmath210 corresponds , in general , to a state with current , and its solution can facilitate the calculation of transport problems in a many - body context  @xcite .",
    "the many - body bloch phase component on the trial wave function is often referred to in the literature as twisted boundary conditions  @xcite .      until this new development ,",
    "the author had promised himself to halt calculations in small model systems  @xcite .",
    "those small model systems , however , while not very realistic , allow comparisons to be performed with fully converged ci calculations .",
    "in addition , they can be handled with symbolic programs like mathematica , which , while computationally very slow , are an ideal environment for developing new methods and comparing the results with nearly analytical values .",
    "therefore , small model systems provide an ideal `` workbench '' for testing new theories and algorithms . on the other hand , no method that fails in the simplest case",
    "has hopes of succeeding in a realistic calculation involving the more challenging coulomb interaction with a large number of electrons .",
    "past experience has shown , in contrast , that earlier shdmc developments tested and developed in small models  @xcite could be implemented easily in realistic cases without additional complications  @xcite . indeed , calculations using this method in qwalk  @xcite reproduced the results obtained for the triplet state of he for low magnetic fields@xcite starting from a random linear combination of determinants constructed with the hartree - fock solutions _ without _ magnetic field .",
    "all electron calculations of atomic systems with tens of electrons are currently under progress and will be published elsewhere@xcite .",
    "dmc calculations with a realistic coulomb interaction in periodic systems require a supercell large enough to prevent unphysical image interactions between periodic replicas of the electrons from dominating the result .",
    "for the purpose of testing the method , however , a model electron - electron interaction can be chosen , and the system can be made as small as required for numerical convenience . for validating the method , the hamiltonian does not need to be strictly realistic ; however , one must solve the same hamiltonian with shdmc and an established benchmark method ( ci in this case ) .",
    "the model studied in this section is related to the one considered in refs . , and and consists of two spinless electrons in a square of side @xmath75 .",
    "however , instead of the hard - wall boundary conditions used earlier , periodic boundary conditions are set .",
    "_ basis expansion : _ the ground state of the noninteracting system is degenerate .",
    "two states with zero total momentum can be constructed by placing two electrons with opposite momenta @xmath211 or @xmath212 .",
    "the basis chosen to expand the wave function is an antisymmetric combination of free - particle solutions that satisfy periodic boundary conditions , which are plane waves of the form @xmath213}\\end{aligned}\\ ] ] where @xmath214 and @xmath215 , which results in a two - body basis with 1516 functions .    the confining potential and the interaction potential selected do not mix the directions @xmath216 and @xmath217 .",
    "they are given by @xmath218 + \\cos[2 \\pi ( y_2 - y_1 ) ] )   \\right\\}.\\end{aligned}\\ ] ] the first line of eq .",
    "( [ eq : pervr ] ) corresponds to an external potential applied to electrons @xmath75 and @xmath219 .",
    "the second line plays the role of an interaction potential that depends on the difference between the electronic coordinates .",
    "the jastrow factor is set to zero to facilitate the analytical calculation of the matrix elements of @xmath48 , while the kinetic energy is a diagonal matrix .",
    "the exact diagonalization of the hamiltonian matrix is the ci result . for @xmath220 , the energy difference  @xcite between the noninteracting ground state and first excited states",
    "is @xmath221 . since the interaction energy in eq .",
    "( [ eq : pervr ] ) is of the same order of magnitude as the kinetic energy , the system is in the correlated regime .",
    "figure [ fg : rpperiodic ] shows the logarithm projection @xmath222 of the trial wave function @xmath223 onto the @xmath99 eigenstate of the full ci solution @xmath224 as a function of the recursive iteration index @xmath43 .",
    "the wave function is constrained by the basis to have a many - body bloch phase @xmath225 $ ] with @xmath226 ( that is a twist angle of @xmath227  @xcite both in the @xmath228 and @xmath229 directions ) .",
    "the initial trial wave function @xmath230 was chosen intentionally to be of poor quality to demonstrate the strength of the method .",
    "the coefficients of @xmath230 corresponded to a linear combination of the first 16 full ci eigenstates : @xmath231 , where the coefficients @xmath232 are complex numbers of modulus @xmath233 and a random phase .",
    "note that the initial trial wave function has no nodes but at the coincidental points because is a linear combination with random phase of different eigenstates of the non interacting hamiltonian with different nodes .",
    "the calculation was run for 200 walkers with @xmath234 and @xmath235 .",
    "the coefficients @xmath116 were sampled at the end of each sub - block of @xmath236 dmc steps . at first",
    "the number of sub - blocks @xmath117 sampled before a wave function update was set to @xmath237 and increased according to the recipe given in ref . and briefly in section [ sc : freephase ] .",
    "therefore , the statistical error is reduced , and the number of basis functions retained in the expansion increases over time . as a result both the statistical error and the truncation error diminish , and the wave function continues to improve .",
    "the final iteration included @xmath238 blocks .",
    "the total optimization run cost @xmath239 dmc steps .",
    "figure [ fg : rpperiodic ] shows in increasingly lighter shading the results @xmath240 corresponding to higher excited states .",
    "all the projections to the first 16 states start from the same value [ @xmath241 by construction .",
    "the algorithm , at first , increases the projection of the lower energy states at the expense of the higher ones ( thus @xmath240 approaches zero for low @xmath99 ) , while the projections with higher @xmath99 ( in lighter gray ) become smaller and their @xmath240 is increasingly negative . as the algorithm progresses further ,",
    "the projection on lower - energy excitations also starts to decay .",
    "finally , @xmath240 becomes increasingly negative for all states except the ground state , which approaches zero .",
    "as the number of recursive iterations @xmath43 increases , the projection onto highly excited states becomes negligible .",
    "the values obtained for @xmath242 are , therefore , dominated by statistical noise in the sampling . on the right side of fig .",
    "[ fg : rpperiodic ] , the convergence of the wave function is no longer limited by the initial trial wave function but by the statistical noise .",
    "statistical noise introduces a projection into higher excited states by two mechanisms : ( i ) the coefficients @xmath116 of the trial wave function expansion include random noise and ( ii ) the trial wave function develops a projection into excited states because it is truncated depending on the relative error of @xmath116 , which in turn depends on @xmath81  @xcite .",
    "accuracy can be increased only by improving the statistics ( increasing @xmath117 and @xmath81 ) .",
    "the residual projection of the trial wave function @xmath223 for iteration @xmath43 on the ci eigenstate @xmath243 is defined as @xmath244 the final value for the residual projection for the calculation in fig .",
    "[ fg : rpperiodic ] is below @xmath245 .",
    "the value obtained for the shdmc energy is -31.842(13 ) as compared with a ci value of @xmath246 .",
    "however , the shdmc wave function retains only @xmath247 coefficients in the expansion , whereas the ci has @xmath248 .",
    "the fpdmc energy obtained with this wave function was @xmath249 .",
    "the results shown in figure [ fg : rpperiodic ] demonstrate that the shdmc method with complex weights is able to correct both the phase and the nodal structure of the trial wave function .",
    "shdmc converges to the ground - state even starting from a poor quality wave function with a random phase .    ] as a function of the shdmc iteration index @xmath43 .",
    "the results correspond to two electrons in the triplet state with periodic boundary conditions and a many - body bloch phase @xmath250 $ ] with @xmath251 ( that is a twist angle of @xmath252  @xcite ) .",
    "darker symbols correspond to the projection with lower energy ci eigenstates .",
    "the initial trial wave function was a linear combination of the lowest 16 ci eigenstates with coefficients having the same modulus and a random complex phase .",
    "[ fg : rpperiodic ] ]      common electronic structure methods are based on a single - particle picture , and the band structure is given by the evolution of the energy as a function of the single - particle crystalline momentum . in this case , in contrast , the energy of many - body states is a function of the many - body bloch phase @xmath253 or the twist angle  @xcite .",
    "figure [ fg : bandstruct ] shows the many - body band structure for the ground and first excited states as a function of the global crystalline momentum @xmath254 obtained for the same system studied in fig .",
    "[ fg : rpperiodic ] .",
    "the calculations were done using the same parameters as in fig .",
    "[ fg : rpperiodic ] described above .",
    "the trial wave function for the ground state with @xmath255 started from a linear combination of the ground and first excited states of the free - particle system with @xmath256 .",
    "for @xmath257 , the initial trial wave function for the ground state was constructed using the bloch part of the converged wave function with smaller @xmath258 .",
    "the initial trial wave function for the first excited state for @xmath259 was constructed using a linear combination including @xmath260 and @xmath261 orthogonal to the ground state .",
    "the trial wave functions for the first excited states for @xmath257 were constructed using the bloch part of a converged previous calculation with the closest value of @xmath262 and using the projector @xmath193 to orthogonalize it with the ground state .",
    "ci results are shown with lines for validation of the shdmc results in dots .",
    "there is a very good agreement between the values obtained with quantum monte carlo and ci .",
    "in general , however , the monte carlo values have a higher energy than the ci values .",
    "this is due to both the error in the complex phase and the nodal error since the shdmc wave function only retains @xmath263 of the 1516 basis functions retained in the ci .",
    "the energy difference is reduced systematically as the algorithm progresses and more coefficients @xmath116 are retained in the trial wave function .",
    "( i.e. , the many - body bloch phase or twist angle ) .",
    "[ fg : bandstruct ] ]",
    "shdmc results ( dots ) obtained for ( a ) the first excited state and ( b ) the ground state of a model system compared with ci results ( lines ) as a function of the magnetic field .",
    "the system consists of two electrons in a two - dimensional square in the triplet state .",
    "the results shown correspond to the ground and first excited states with @xmath264 symmetry that transform as @xmath265 .",
    "the solution that transforms as @xmath266 can be obtained by changing the sign of @xmath267 . ]",
    "this section describes the results obtained with the generalization of shdmc ( described in section [ sc : freephase ] ) for the ground and the first excited state of a model system with an applied magnetic field .",
    "the results are compared with ci calculations in the same model used in refs . and .",
    "briefly , the lower energy eigenstates are found for two spinless electrons moving in a two - dimensional square with a side length @xmath75 and a repulsive interaction potential of the form @xmath268}\\cos{[\\alpha \\pi(y - y^{\\prime})]}$ ] with @xmath269 and @xmath270 .",
    "the many - body wave function is expanded in functions @xmath97 that are eigenstates of the noninteracting system .",
    "the basis functions in @xmath92 are linear combinations of functions of the form @xmath271 with @xmath272 . converged ci calculations",
    "were performed to obtain a nearly exact expression of the lower energy states of the system @xmath273 .",
    "the matrix elements involving the magnetic vector potential @xmath274 ( in the symmetric gauge ) were calculated analytically using the symbolic program mathematica and were included in the ci hamiltonian .",
    "the jastrow factor was set to zero in the shdmc run to facilitate a direct comparison between ci and shdmc results",
    ".    this paper reports results for the triplet case . in the absence of a magnetic field ,",
    "the triplet ground state is degenerate .",
    "its orbital symmetry corresponds to the e symmetry of the d@xmath275 group .",
    "one of the solutions with e symmetry transforms as @xmath276 and the other as @xmath277 . under an applied magnetic field ,",
    "the time reversal symmetry is broken , and the @xmath276 and @xmath277 solutions are mixed . under a magnetic field",
    ", the ground state can be expanded in a basis of functions that transform as @xmath278 .",
    "the energy of the @xmath279 solution can be obtained from the energy of @xmath280 by changing @xmath267 to @xmath281 .",
    "figure [ fg : magnetic ] shows energies of the ground state and first excited state of the model system as a function of the magnitude of the magnetic field @xmath267 ( the curl of the vector potential @xmath274 ) .",
    "the calculations were run using @xmath282 and @xmath283 and a total number of dmc steps of @xmath284 for each calculated point .",
    "the calculation for the ground state started from the noninteracting ground - state solution as a trial wave function .",
    "the result obtained for @xmath285 for the ground and first excited states compared well with the ones obtained with the same hamiltonian in the triplet case reported  @xcite in table i of ref . .",
    "note that in this case , the wave function is complex and the coefficients have the freedom to be complex .",
    "thus , in contrast with ref . , where a real wave function was enforced , here the phase was found within statistical error .    for @xmath286 ,",
    "the time reversal symmetry is broken and so is the degeneracy of the @xmath278 solutions . for higher ( lower ) magnetic fields ,",
    "the calculation began by using as the initial trial wave function the one obtained previously with a lower ( higher ) magnetic field .",
    "the excited states were obtained using the method outlined in subsection [ ssc : excited ] and described in detail in ref . .",
    "the lines show the ci results for reference .",
    "the calculation for the first excited state with @xmath287 started from a linear combination of the ground and first excited state of the noninteracting system orthogonal to the interacting ground state calculated earlier .",
    "the initial trial wave functions of the excited states for @xmath286 were taken from the previous calculations with smaller @xmath288 ( keeping the wave function orthogonal to the lower energy states with the operator @xmath289 ) . clearly , fig .",
    "[ fg : magnetic]b shows good agreement between shdmc and ci results for the first excited state .    table [ tb : magnetic ] summarizes the values obtained to construct fig .  [ fg : magnetic ] .",
    "there is an excellent agreement in the calculations obtained for the ground state using shdmc and ci .",
    "the shdmc energy values are , within error bars converged fpdmc results indicating that the remaining convergence errors in the basis are small .",
    "the agreement is less satisfactory for the excited states than in the ground state ( using the same computational time ) .",
    "it its clear that the residual projections are much larger for the excited state than for the ground .",
    "an independent way to measure the quality of the wave function is the logarithm of the variance of the modulus of the weights given by @xmath290 the variance of the weights does not deteriorate as much as the residual projection for excited states , which might signal that the differences in the wave functions originate because ci and shdmc minimize different things using a truncated basis .",
    "@xcite        .[tb : magnetic ] comparison of the excitation energies obtained for the ground and the first excited state of a model system with two spinless electrons and an applied magnetic field ( see fig .",
    "[ fg : magnetic ] ) .",
    "@xmath291 quantifies the overlap of the wave functions obtained with ci and shdmc [ see eq .",
    "( [ eq : lrp ] ) ] .",
    "@xmath292 is the variance of the modulus of the walkers  weights [ see eq .",
    "( [ eq : logvar ] ) ] . [ cols=\"^,<,^,^,^,^\",options=\"header \" , ]     table [ tb : coulomb ] displays the values obtained for the model system with coulomb interactions for the ground state and some excitations as a function of the magnetic field .",
    "the quality of the wave function is characterized by the logarithm of the variance of the modulus of weights given by eq .",
    "( [ eq : logvar ] ) .",
    "note that the variance of the weights increased when coulomb interactions are considered when compared with the case of the model interaction .",
    "this is due to the coulomb singularity and the lack of a jastrow factor .",
    "while the variance of the weights is larger in the coulomb case , the quality of the wave function improves from one shdmc recursive iteration to the next ( see below ) .",
    "figure [ fg : coulomb ] shows the evolution of the real ( a ) and the imaginary ( b ) parts of the local energy @xmath96 as a function of the dmc step for the first excited state of two electrons in a square box with an applied magnetic field of @xmath293 .",
    "the calculations started with a trial wave function with two nonzero coefficients chosen to be orthogonal to the ground state calculated earlier .",
    "it can be clearly seen in fig .",
    "[ fg : coulomb](a ) that as the shdmc algorithm progresses , the real part of the local energy is quickly reduced and stabilized at the first excited state energy . the imaginary part of the @xmath96 should be zero for an eigenstate ; otherwise , the divergence of the current is nonzero  @xcite . in shdmc",
    "this strong condition is satisfied only as the number of recursive iterations , the number of configuration sampled @xmath81 , and the size of the basis @xmath294 retained in the wave function tend to infinity . figure [ fg : coulomb](b ) , however , clearly shows that the variance of the raw data obtained for @xmath295 $ ] is reduced as the shdmc algorithm progresses .",
    "this is a clear indication of improvement of the phase of the wave function .",
    "( color online ) ( a ) average of the real part of @xmath96 obtained with 200 walkers as a function of the dmc step .",
    "the results correspond to the first excited state that transforms as @xmath296 with @xmath264 symmetry of the group @xmath297 of two electrons with coulomb interactions in a square box with an applied magnetic field  @xcite @xmath298 .",
    "( b ) average of the imaginary part of @xmath96 as a function of the dmc step for the same case .",
    "the vertical lines mark the end of the shdmc block when the wave function is updated . ]",
    "figure [ fg : variance ] shows the evolution of logarithm of the variance of the weights [ see eq .",
    "( [ eq : logvar ] ) ] as a function of the shdmc block index ( the number of wave function updates ) .",
    "the reduction in weight variance is a clear indication of convergence of the trial wave function towards an eigenstate of the hamiltonian  @xcite .    .",
    "the results correspond to the first excited state with @xmath298 and coulomb interactions ( the run shown in fig .",
    "[ fg : coulomb ] ) .",
    "[ fg : variance ] ]",
    "a method that allows the calculation of the complex amplitude of a many - body wave function has been presented and validated with model calculations .",
    "an algorithm that finds the complex wave function is essential for any study of many - body hamiltonians with periodic boundary conditions or under external magnetic fields .",
    "the method converges to nearly analytical results obtained for model systems under applied magnetic fields or periodic boundary conditions , with an accuracy limited only by statistics and the flexibility of the wave function sampled .",
    "it is found that for some eigenstates , the ones where the phase is a scalar function of @xmath7 , there is a _ special _ gauge transformation in which wave function is real .",
    "for this class of eigenstates the original proof of convergence of shdmc applies .",
    "for complex wave functions some fermionic eigenstates may not have nodes . in the latter case , as in the case of bosons@xcite , the convergence of shdmc is not affected since the wave function can evolve everywhere .",
    "this new approach goes beyond both fixed - phase dmc  @xcite and shdmc  @xcite . as in the real wave function version of shdmc ,",
    "the method is recursive and the propagation to infinite imaginary time is achieved as the number of iterations increases . as in fpdmc , the walkers evolve under an effective potential that incorporates the gradient of the phase of the trial wave function and the vector potential of the magnetic field .",
    "but in this new algorithm , in contrast to fpdmc , the complex amplitude of the wave function is free to adjust both its modulus and its phase .",
    "after each iteration , the trial wave function is improved following a short time evolution of an ensemble of walkers .",
    "these walkers follow the equation of motion of a generalized importance sampling approach . unlike previous attempts ,",
    "the walkers carry a complex weight resulting from eliminating the fixed - phase constraint in the time evolution of the mixed probability density .",
    "the modulus of the weight can be used to calculate real observables , such as the energy .",
    "the phase of the weight of the walkers is used to improve the phase of the trial wave function in the following iteration . as in earlier versions of shdmc",
    ", the modulus of the weights is also used to improve , simultaneously , the node if there is any and the phase of the trial wave function .",
    "this free amplitude shdmc method can be used to calculate not only the ground state but also low energy excitations  @xcite within a dmc context .",
    "comparisons with nearly analytical results in model systems demonstrate that the new approach converges to the many - body wave function of systems with applied magnetic fields or with periodic boundary conditions for low energy excitations .",
    "this recursive method finds a solution to `` the phase problem '' and , if there is any , finds the node at the same time .",
    "the many - body wave function can be used , in principle , to calculate any observable . however , in very large systems , when convergence with the size of the wave function basis can not be fully achieved , a standard fixed - phase calculation should be performed as a final step to obtain a more accurate energy .    _",
    "scaling and cost : _ an analysis of the minimum cost required to determine the node and the phase has to take into account the number of independent degrees of freedom of the hilbert space . arguably , no method could scale better than linear in the number of _ independent _ degrees of freedom of the problem studied ; otherwise , some degrees of freedom would be _ dependent _ from each other .",
    "a real - space expansion of the many - body wave function with fixed resolution @xmath299 is ideal for counting independent degrees of freedom .",
    "the resolution @xmath299 can be connected to the energy cutoff of the excitations in a multideterminant expansion . for a complex wave function ,",
    "each point in the many - body space @xmath7 has two independent degrees of freedom ( modulus and phase ) .",
    "if the volume of a system is proportional to the number of electrons @xmath5 , its size scales as @xmath300 ( where @xmath301 is of the order of the bohr radius @xmath302 ) . taking into account the @xmath303 permutations of identical particles , one finds @xmath304 independent degrees of freedom for each spin channel to determine the phase @xmath10 .",
    "thus , the number of independent degrees of freedom scales as @xmath305 .",
    "the node @xmath11 , if there is any , requires one less dimension ( which , if the nodal surface is not too convoluted , could reduce the number of degrees of freedom by only up to a factor @xmath306 ) . since the number of independent degrees of freedom of the phase increases exponentially with @xmath5 , for a fixed resolution @xmath299 one can not find the phase with an algorithm polynomial in @xmath5 .",
    "this generalization of the shdmc method , though tested in small systems , is targeted to be used in large systems .",
    "the numerical cost of shdmc scales linearly with the number of independent degrees of freedom of the phase per recursive step .",
    "however , the number of independent degrees of freedom ( i.e , the size of the basis expansion ) should increase exponentially with the number of electrons @xmath5 for a fixed resolution",
    ". the accuracy of shdmc is limited by the size of the basis sampled , the statistical error , and the number of recursive iterations . the number of recursive steps required increases if the product between @xmath24 and the lowest energy excitations is small .",
    "the shdmc method can be used in combination with other optimization approaches to accelerate convergence in that limit .",
    "the scaling of the cost of exact diagonalization methods such as ci is at least quadratic with the number of degrees of freedom .",
    "often a ci calculation is used to preselect a multideterminant expansion to be improved within a vmc context before a final fpdmc run .",
    "an advantage of shdmc is that it incorporates the jastrow in the sampling of the coefficients .",
    "thus shdmc might be more efficient than a ci filtering for large systems .",
    "the linear scaling of shdmc suggests that it could be the method of choice to optimize the wave function phase and nodes for calculations in periodic solids .",
    "the optimization of many - body wave functions with current in periodic boundary conditions is now possible .",
    "therefore , the new method can be used as a tool to perform transport calculations including many - body effects .",
    "the calculation of systems with an applied magnetic field is challenging , even in the case of small molecules and atoms and particularly so when the magnetic field , the many - body interactions , and the kinetic energy are of the same order of magnitude  @xcite .",
    "the calculations reported in this paper , though in a simple model , suggest that the method can be applied to the study of molecular or atomic systems in that difficult regime .",
    "our recent successful application of the ground - state algorithm for real wave functions  @xcite to molecular systems  @xcite supports the idea that this generalization of shdmc can also be useful for real ab - initio calculations beyond model systems .",
    "the implementation of the algorithm in state - of - the - art dmc codes has been done .",
    "initial results in atomic systems show that the many - body wave function improves , which is shown by a reduction of the average local energy , the energy variance and the variance of the imaginary contribution to the total energy .",
    "the author would like to thank j. mcminis for an introduction to the fixed - phase approximation and p. r. c. kent , and g. ortiz for a critical reading of the manuscript .",
    "the author also thanks m. bajdich for sharing all electron calculations in atomic systems using this method as supplemental material for the referees prior publication .",
    "research sponsored by the materials sciences & engineering division of the office of basic energy sciences u.s .",
    "department of energy .",
    "a. d. gl and c. j. umrigar , phys .",
    "b , * 72 * , 045309 ( 2005 ) ; a. d. gl , g. s .. jeon , c. j. umrigar and j. k. jain , phys . rev .",
    "b * 72 * , 205327 ( 2005 ) ; g. s. jeon , a. d. gl , c. j. umrigar , and j. k. jain , phys . rev .",
    "b * 72 * , 245312 , ( 2005 ) .",
    "the position of the cut in the complex plane of the riemann surface into sheets is arbitrary .",
    "therefore , the discontinuities in the gradient and the effective potential are no physical if they can be removed changing @xmath99 .",
    "the term `` twist angle '' was introduced  @xcite to avoid confusion with other usages of the term `` phase '' . here",
    "the term `` many - body bloch phase '' is also mentioned since the bloch theory is well understood outside the many - body field ."
  ],
  "abstract_text": [
    "<S> the self - healing diffusion monte carlo algorithm ( shdmc ) [ reboredo , hood and kent , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 79 * , 195117 ( 2009 ) ; reboredo , _ ibid . _ * 80 * , 125110 ( 2009 ) ] is extended to study the ground and excited states of magnetic and periodic systems . </S>",
    "<S> the method converges to exact eigenstates as the statistical data collected increases if the wave function is sufficiently flexible . </S>",
    "<S> it is shown that the wave functions of complex anti - symmetric eigen - states can be written as the product of an anti - symmetric real factor and a symmetric phase factor . </S>",
    "<S> the dimensionality of the nodal surface is dependent on whether phase is a scalar function or not . </S>",
    "<S> a recursive optimization algorithm is derived from the time evolution of the mixed probability density , which is given by an ensemble of electronic configurations ( walkers ) with complex weight . </S>",
    "<S> this complex weight allows the amplitude of the fixed - node wave function to move away from the trial wave function phase . </S>",
    "<S> this novel approach is both a generalization of shdmc and the fixed - phase approximation [ ortiz , ceperley and martin , phys rev . </S>",
    "<S> lett . </S>",
    "<S> * 71 * , 2777 ( 1993 ) ] . </S>",
    "<S> when used recursively it simultaneously improves the node and the phase . </S>",
    "<S> the algorithm is demonstrated to converge to nearly exact solutions of model systems with periodic boundary conditions or applied magnetic fields . </S>",
    "<S> the computational cost is proportional to the number of independent degrees of freedom of the phase . </S>",
    "<S> the method is applied to obtain low - energy excitations of hamiltonians with magnetic field or periodic boundary conditions . </S>",
    "<S> the method is used to optimize wave functions with twisted boundary conditions , which are included in a many - body bloch phase . </S>",
    "<S> the potential applications of this new method to study periodic , magnetic , and complex hamiltonians are discussed . </S>"
  ]
}