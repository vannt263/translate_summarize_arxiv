{
  "article_text": [
    "rna secondary structure provides a coarse grained model to study important features of the real molecular conformation , embedded in three - space @xcite .",
    "the key feature of these structures is that they can be inductively constructed @xcite .",
    "the recursion forms the basis for more than three decades of research resulting in what can be called the dynamic programming ( dp ) paradigm .",
    "dp methodology facilitates _ ab initio _ folding @xcite , partition function @xcite , boltzmann sampling @xcite and context - free grammars ( cfgs ) @xcite .",
    "minimum free energy ( mfe ) secondary structures can be folded in @xmath3 space and @xmath4 time complexity @xcite and their partition function is computed in @xmath5 time @xcite .",
    "stochastic folding is based on their cfg , allowing to factor in specific properties of biological structures .",
    "thermodynamic and stochastic secondary structures have been statistically analyzed in @xcite . in @xcite",
    "the secondary structure paradigm has been extended to include gap - structures .",
    "gap - structures include certain , but not all pseudoknot structures ( pk - structures )",
    ". they can be viewed as the most general class to which the dp - paradigm directly applies and their underlying grammar is multiple context - free .",
    "the approach allowed folding of gap - structures in @xmath6 time and @xmath7 space complexity and sampling in @xmath5 time .",
    "in this paper we approach the problem of cross - serial interactions of pk - structures from first principles .",
    "we employ an abstraction , that is well known to structural biology @xcite : namely , a nucleotide is not a dimensionless object but a triangle and base pairs can be abstracted as untwisted or twisted ribbons connecting two such triangles , see fig .",
    "[ f : basepair ] .",
    "this observation introduces topology as a natural language for biological structures and leads to the fatgraph model @xcite .",
    "our main result is to map a novel recursion on unicellular maps @xcite into the classic recursion derived in @xcite .",
    "i.e.  we translate a recursive procedure on fatgraphs into an enhanced version of the recursion of secondary structures .",
    "this results in the first , unambiguous , context - free grammar for pk - structures , _ rnafeatures@xmath0_. we present as a first application an @xmath8 boltzmann sampler and stochastic context - free grammar .    in the following",
    "we discuss the fatgraph modeling ansatz in detail .",
    "we then provide some background on computational linguistics in the context of rna structures , enabling us to discuss what we mean by topological language of rna .",
    "the biophysics of the canonical base pairs * a - u * , * g - c * and * g - u * implies , that the fatgraphs modeling rna structures are orientable : rna purine and pyrimidine bases are modeled as three edges for hydrogen bonding interactions : the watson - crick edge , the hoogsteen edge , and the sugar edge @xcite .",
    "a given edge of one base can potentially interact in a plane with any one of the three edges of a second base , and can do so in either cis- or trans- orientation of the glycosidic bonds .",
    "this gives rise to 12 basic geometric types with at least two h bonds connecting the bases , see fig .",
    "[ f : basepair ] . accordingly",
    ", cis - base pairs , including the canonical base pairs belong to the _ cis - watson - crick / watson - crick _ geometry .",
    "canonical base pairs induce exclusively untwisted ribbons , modeled via orientable _ fatgraphs _ , i.e.  graphs enhanced by replacing vertices by discs and edges by ribbons . gluing the sides of these ribbons produces the topological quotient space @xcite , which is a connected sum of tori . as topological genus ,",
    "@xmath9 , and orientability are the two determinants of closed surfaces , rna structures having canonical base pairs are filtered by genus alone .",
    "rna secondary structures @xcite , are exactly structures of genus zero .",
    "structures of genus @xmath10 are those exhibiting cross - serial interactions . in a sense ,",
    "topological genus measures the complexity of a biomolecule , far more subtle than the number of crossing arcs .",
    "one may think of pk - structures as _ cross - free _ drawings on a closed surface of genus @xmath11 , instead of a drawing with crossing arcs in the plane , see fig .",
    "[ f : pse ] .",
    "the term _ language of rna _ has been used in @xcite , where the authors study the aforementioned gap - structures @xcite .",
    "methods from computational linguistics have been applied to problems in dna and rna sequence analysis for decades : early work involved using regular grammars and hidden markov models ( hmms ) in order to model biological sequences .",
    "these have been used in sequence analysis @xcite , such as identifying cpg islands @xcite , gene prediction @xcite , pairwise and multiple sequence alignment @xcite , modeling dna sequencing errors @xcite , protein secondary structure prediction , and rna structural alignment @xcite .",
    "regular grammars and hmms are not well - equipped to model problems in rna folding because they can not describe the long - distance correlations of base pairs . instead , a larger class called _ context - free _ grammars ( cfg ) are used . assigning probabilities to the production rules of cfg",
    "produces a stochastic context - free grammar ( scfg ) , which , in the context of hmm , allows each state to generate not a single , but any ( fixed ) number of immediate successors .    by a _",
    "topological language of rna _",
    "we mean an unambiguous , cfg that allows us to recursively construct _ any _ pk - structure using recursions that are induced by cell - surgery on fatgraphs .",
    "the latter shall be translated into an enhancement of the classical recursion @xcite .",
    "this allows us to connect to the existing paradigm by presenting a cfg based on arc - removals and decomposition as production rules , where the cross - serial interactions are encapsulated in the labels of the arcs and nonterminal symbols , respectively .",
    "finally we discuss the above mentioned recursion of secondary structures and provide some background on topological rna structures .",
    "@xcite studied the combinatorics and folding of rna secondary structures .",
    "their diagrams are labeled graphs over the vertex set @xmath12=\\{1 , \\dots , n\\}$ ] , presented by drawing the vertices on a horizontal line and noncrossing arcs in the upper half - plane .",
    "vertices and arcs correspond to the nucleotides * a * , * g * , * u * and * c * and watson - crick ( * a - u * , * g - c * ) and wobble ( * u - g * ) base pairs , respectively .",
    "the noncrossing arcs of rna secondary structures allow for a recursive build .",
    "let @xmath13 denotes the number of rna secondary structures over @xmath14 nucleotides then we have @xcite : @xmath15 , where @xmath16 for @xmath17 .",
    "accordingly , rna secondary structures satisfy a constructive recursion .",
    "this relation constitutes the basis for the dp - recursions used for the polynomial time folding @xcite and has profound algorithmic implications .",
    "the dp - framework has ever since strongly influenced the field of rna folding @xcite .",
    "cfgs of secondary structures @xcite are utilizing the recursive nature of secondary structures @xcite .",
    "the grammar has two production rules , displayed in fig .",
    "[ f : grammar ] .",
    "its terminal symbols denote a pair of vertices forming an arc as well as an unpaired vertex and the nonterminal symbols are an arbitrary secondary structure and an irreducible structure covered by an external arc .",
    "the grammar is unambiguous , i.e.  each structure has a unique decomposition path .",
    "cross - serial interactions or pseudoknots have long been known as important structural elements @xcite in rna . depicting a contact structure as a diagram",
    ", a structure contains a pseudoknot if and only if these arcs cross .",
    "cross - serial interactions are functionally important in trnas , rnasep @xcite , telomerase rna @xcite , and ribosomal rnas @xcite .",
    "pseudoknots in plant virus rnas mimic trna structures , and _ in vitro _",
    "selection experiments have produced pseudoknotted rna families that bind to the hiv-1 reverse transcriptase @xcite .",
    "topological rna structures have been introduced in @xcite and the classification and expansion of pk - structures in terms of the topological genus of an associated fatgraph has been studied by means of matrix theory in @xcite . the computation of the genus of a fatgraph is classic @xcite and was first applied to rna structures by @xcite and @xcite .",
    "@xcite studies topological rna structures of higher genus and connects them with riemann s moduli space @xcite . in @xcite a polynomial time , loop - based folding algorithm of topological rna structures was given .",
    "the paper is organized as follows : in section  [ s : fat ] we discuss the idea behind the novel recursions .",
    "thereafter we establish the correspondence between pk - structures and blueprints with @xmath1-structures in section  [ s : bi ] .",
    "then we discuss _",
    "rnafeatures@xmath0 _ and finally detail the scfg in section  [ s : grammar ] .",
    "the contacts of nucleotides within an rna structure can be represented as a diagram whose arcs can be linearly ordered via their left end - points , i.e.  @xmath18 if and only if @xmath19 .",
    "suppose @xmath20 , then @xmath21 and @xmath22 cross iff @xmath23 holds .    in the following",
    "we shall assume that any diagram contains the arc @xmath24 ( rainbow ) , which is not accounted for as an edge of the diagram .",
    "rainbows mark the start and endpoint of the @xmath25-@xmath26 oriented backbone , thus allowing to collapse the backbone into a disc without loosing any information .",
    "the passage from diagrams to fatgraphs @xcite is obtained by `` thickening '' the edges into ( untwisted ) bands or ribbons .",
    "furthermore , each vertex is inflated into a disc as shown in fig .",
    "[ f : fat ] .",
    "this inflation reflects the fact that canonical base pairs fix a plane , see fig .  [",
    "f : basepair ] .",
    "a fatgraph , @xmath27 , can thus be viewed as a `` drawing '' on an orientable surface @xmath28 , which is obtained by identifying the sides of the ribbons .",
    "@xmath27 is a @xmath29-dimensional cell complex over its geometric realization , @xmath28 .",
    "the euler characteristic and topological genus of the surface @xmath30 are given by @xmath31 and @xmath32 , where @xmath33 , @xmath34 and @xmath35 denote the number of discs , ribbons and boundary components in @xmath30 @xcite .",
    "the equivalence of simplicial and singular homology @xcite implies that these combinatorial invariants are topological invariants .",
    "this means the genus of the surface @xmath36 provides a filtration of fatgraphs .",
    "a fatgraph can be presented by a pair of permutations @xcite .",
    "let @xmath37 $ ] denote the set of half - edges , and let @xmath38 , @xmath39 and @xmath40 be three permutations over @xmath41 , where each cycle in @xmath38 , @xmath39 and @xmath40 presents a vertex , an edge and a boundary component , respectively .",
    "a vertex of degree @xmath42 is considered as a cycle @xmath43 . in particular",
    ", @xmath39 is a fixed - point free involution since an edge consist of two half - edges and we have @xmath44 .",
    "removing the unpaired vertices from the diagram and collapsing the backbone into a disc does not change the euler characteristic .",
    "therefore , the relation between genus and number of boundary components is solely determined by the number of arcs in the upper half - plane : @xmath45 , where @xmath14 is number of arcs and @xmath35 the number of boundary components .",
    "the latter can be computed easily and allows us to obtain the genus of the diagram .",
    "mapping @xmath46 into @xmath47 , is a bijection , see fig .",
    "[ f : dual ] .",
    "@xmath48 is called the _ poincar dual _ and interchanges boundary components with vertices , preserving topological genus . by construction",
    "we shall deal only with fatgraphs over one backbone whose duals thus have one boundary component .",
    "we refer to these duals as _",
    "unicellular maps_.    a bijection is derived by chapuy in @xcite between a unicellular map of genus @xmath9 together with a distinguished trisection and a unicellular map of genus @xmath49 , together with @xmath50 labeled vertices .",
    "this is facilitated by successively slicing a vertex into three new vertices via the distinguished trisection .",
    "since the trisection can persist through finitely many slicings , say @xmath42 times , the process produces @xmath50 labeled vertices , reducing the genus of the map by exactly @xmath42 .",
    "gluing is the inverse to slicing : gluing a set of @xmath50 labeled vertices in a unicellular map increases the genus of the map by @xmath42 . by construction , both , slicing and gluing processes preserve unicellularity .    in a unicellular map we have two orders , @xmath51 and @xmath52 .",
    "the former accounts for the length of the tour of the boundary component and the latter is induced by counterclockwise rotation around a vertex , i.e.  from @xmath53 to @xmath54 .",
    "a half - edge @xmath55 is called a _ trisection _ if @xmath56 and @xmath55 is not the minimum half - edge of the vertex .",
    "a trisection marks the nontrivial order discrepancies between @xmath38 and @xmath40 .",
    "it is topologically relevant , since the number of trisections in any unicellular map having genus @xmath9 equals exactly @xmath57 @xcite . in particular",
    ", any unicellular map having genus @xmath58 , i.e.  a planar tree , has no trisections .",
    "let @xmath59 be a vertex with trisection @xmath55 .",
    "we slice as follows @xcite : let @xmath60 denote the minimum half - edge of @xmath59 , let @xmath61 denote the minimum half - edge between @xmath60 and @xmath62 ( rotating clockwise ) , that is larger than @xmath63 with respect to @xmath51 .",
    "iterating this means to further slice @xmath64 until @xmath55 becomes its minimum half - edge and we derive the mapping @xmath65 , where @xmath42 denotes the number of slicings .",
    "the new vertices @xmath66 are by construction ordered by their minimum half - edges with respect to @xmath51 .",
    "furthermore , @xmath67 is bijective .",
    "the process can be reversed , i.e. , @xmath68 , derived by successively gluing @xmath66 in the following fashion : we first glue the last three vertices @xmath69 , @xmath70 and @xmath71 obtaining a new vertex , @xmath72 , with an ( intermediate ) trisection .",
    "continuing this , by gluing the next two vertices with @xmath72 , produces a unicellular map @xmath73 together with the trisection @xmath55 .",
    "iterated slicings and selecting new trisections as needed , generates a unicellular map having genus @xmath58 , i.e.  a planar tree .    *",
    "( blueprint ) * suppose @xmath74 is a unicellular map of genus @xmath9 having @xmath75 edges together with the trisection @xmath55 .",
    "a @xmath76-blueprint is a sequence @xmath77 where @xmath78 , for @xmath79 and @xmath80 .     in the following",
    "we shall refer to the blueprint of the dual of a pk - structure simply as the blueprint of the pk - structure . in fig .",
    "[ f : path ] we display the blueprints of a matching having genus @xmath29 .",
    "note that for two unicellular maps having genus @xmath9 , the number of blueprints is not necessarily equal .",
    "furthermore , all blueprints can be constructed by considering all trisections at each step , respectively .",
    "the cost of finding all blueprints is exponential in @xmath9 , however , the genus of rna structures found in databases is typically less than @xmath81 .",
    "we establish now a bijection between unicellular maps @xmath73 together with blueprints and a particular class of labeled , planar trees .",
    "the labels will allow to recover the blueprints .",
    "note that , since some vertices may have been involved in subsequent slicing events , they are not present in the tree .    * ( @xmath1-tree ) * a @xmath1-tree , @xmath82 is a rooted , planar tree with boundary component @xmath40 , in which a vertex @xmath33 carries the label @xmath83 such that + @xmath84 @xmath85 , where @xmath86 , + @xmath84 @xmath87 , + @xmath84 @xmath88 and any vertex , whose label @xmath89 satisfies @xmath90 for @xmath91 , is minimal in @xmath40 within the set of all the vertices , having label @xmath89 where @xmath92 .",
    "we shall call the minimum vertex @xmath33 with the property @xmath92 transitional of level @xmath53 and regular , otherwise .",
    "note that a vertex can be transitional for multiple indices .",
    "[ l : welldefined ] any unicellular map , @xmath74 , together with a blueprint , @xmath93 , induces a unique @xmath1-tree , @xmath82 .",
    "suppose we are given a unicellular map @xmath74 together with a slice - path consisting of @xmath35 slicings .",
    "@xmath93 generates a planar tree , @xmath94 , whose vertices we color red if they were involved in some slicing and black , otherwise .",
    "@xmath93 furthermore specifies the sequence of slicings and each slicing reduces topological genus by at least one , whence @xmath95 .",
    "we label the black vertices by @xmath96 and each red vertex obtains a @xmath97 in its @xmath98th - coordinate if and only if it was involved in the @xmath98th - slicing .",
    "this produces a set of intermediate labels @xmath99 .",
    "we proceed by reducing the @xmath99 : starting from @xmath100 to @xmath101 , we set @xmath102 accordingly , any @xmath40-minimal vertex of a fixed slicing retains a @xmath97 iff it came from a previously sliced vertex and , as a result , irrespective of how many times the vertices were sliced , the total number of @xmath97 entries in all coordiantes of all lables equals : @xmath103 where @xmath104 is the decrease of genus in the @xmath53th slicing . as a result , we have @xmath105 .    by construction",
    ", the total number of @xmath97 entries found as @xmath98th - coordinates equals the total number of vertices obtained via the @xmath98th slicing , whence @xmath106 .",
    "finally , consider two fixed indices @xmath91 .",
    "only the label of the @xmath40-minimal vertex amongst the vertices of the @xmath53th slicing can have an entry @xmath97 as @xmath107th coordinate , whence @xmath108 and the proof of the lemma is complete . in fig .",
    "[ f : remove_label ] we illustrate the idea of the proof .",
    "having established the mapping from unicellular maps of genus @xmath9 together with blueprints into @xmath1-trees , we proceed by showing that this mapping is bijective .    [",
    "p : bi ] suppose @xmath74 is a unicellular map with genus @xmath9 and blueprint @xmath93 , then we have the bijection @xmath109    following the slice - path , @xmath93 , the fatgraph @xmath74 is sliced to the tree @xmath94 with labels @xmath110 , @xmath111 . by lemma  [ l : welldefined ] ,",
    "@xmath111 is a @xmath112-tree , whence @xmath113 is well - defined .    to show that @xmath114 is bijective , let @xmath82 be an arbitrary @xmath112-tree such that @xmath115 .",
    "we shall construct @xmath116 as follows :    let @xmath117 denote the set of vertices whose labels satisfy @xmath118 .",
    "lemma [ l : welldefined ] guarantees that the number of vertices contained in @xmath119 is odd .",
    "then we glue @xmath120 creating the trisection , @xmath121 , where @xmath122 .    by construction @xmath123 is a unicellular map with two types of vertices : those which correspond to @xmath94-vertices ( type @xmath97 ) and a unique new vertex obtained by gluing the set @xmath119 ( type @xmath29 ) .",
    "we now label the @xmath123-vertices with labels @xmath124 using the labels @xmath89 of @xmath94 as follows : for any type @xmath97 vertex we set @xmath125 for @xmath126 and @xmath127 . the unique type @xmath29 vertex obtains the label @xmath128 in fig .",
    "[ f : blueprint ] we illustrate the idea of the proof .",
    "a @xmath1-tree corresponds to a unicellular map of genus @xmath9 , together with a blueprint . as a planar tree it corresponds by poincar duality to a noncrossing matching .",
    "we call the edge - labeled poincar dual of a @xmath1-tree a @xmath1-matching , @xmath129 , whose edge - labels @xmath130 are induced by the vertex labels of the @xmath1-tree @xmath131 as follows : there are @xmath132 vertices and @xmath14 edges in a planar tree , whence a vertex corresponds uniquely to an edge ( except of the root ) . to this end",
    ", we consider the edge which connects @xmath33 to its parent , see fig .",
    "[ f : vtoe ] .",
    "note that , by construction , the root of the planar tree is never involved in slicings and accordingly labeled @xmath133 .",
    "a @xmath1-matching induces an arc - labeled secondary structure by insertion of unpaired vertices . to facilitate this",
    "we employ the index map @xmath134 , @xmath135 .",
    "we interpret @xmath136 as to specify how many unpaired vertices follow the @xmath129-vertex , @xmath53 . starting with the left - endpoint of the rainbow and we have @xmath137 such vertices .",
    "a @xmath1-structure @xmath138 is a noncrossing diagram with labeled arcs , @xmath139 , that when removing all unpaired vertices , induces a @xmath1-matching .",
    "note that slicing induces transpositions of the boundary component .",
    "thus , taking the poincar ' e dual , these transpositions permute the backbone of @xmath140 .",
    "let @xmath141 denote resulting permutation of the backbone , where @xmath142 , then @xmath143 is the induced index map for the pk - structure corresponding to the @xmath1-structure and we have the following situation , see fig .",
    "[ f : comm1 ] .",
    "we can now derive the cfg for @xmath1-structures , _ rnafeatures@xmath0_. the key issue here will be the compatibility of the arc labels with the production rules .",
    "let us briefly review the cfg for secondary structures , implied by the recursion of @xcite , i.e.  the tuple @xmath145 , where @xmath146 are sets of nonterminal symbols , terminal symbols and production rules , respectively .",
    "a production rule is a mapping from @xmath147 to @xmath148 , where the asterisk represents the kleene star operation and @xmath149 is an initial symbol .",
    "a derivation starts with the initial symbol @xmath136 , and in each step , replaces one of the nonterminal symbols by one of the productions . for secondary structures ,",
    "the grammar consists of @xmath150 , @xmath151 , and the two production rules are @xmath152 here @xmath153 is the @xmath154-production . the terminal symbols @xmath155 , @xmath156 represent pairs of vertices forming arcs and @xmath98 an unpaired vertex , respectively .",
    "the nonterminal symbol @xmath149 denotes an arbitrary structure and @xmath157 is an irreducible structure , i.e.  covered by an external arc . via the initial symbol",
    "@xmath149 this grammar is unambiguous , i.e.  each structure has a unique derivation path .",
    "we shall now extend the grammar to @xmath1-structures . to this end",
    "we introduce new nonterminals , @xmath158 and @xmath159 .",
    "the nonterminal symbols stand for sets of substructures @xmath160 , with labeled arcs @xmath130 such that @xmath161 , @xmath162 . aside from @xmath98",
    "we have new terminals @xmath163 where @xmath164 denote @xmath139-labelled arcs .",
    "we set @xmath165 if and only if the corresponding nonterminal contains a transitional arc for @xmath53 and @xmath166 , otherwise .    by construction",
    ", the @xmath167 will evolve depending on the presence of transitional arcs , that is @xmath168 may change in more than one coordinate if a transitional arc is present , or in at most one coordinate , otherwise .",
    "@xmath169 can be viewed as an indicator determining which production rule applies .",
    "_ decomposition : _ this means to decompose a nonterminal symbol @xmath170 into one left- and one right - symbol , together with consistent labelings .",
    "a labeling for @xmath171 is consistent if @xmath172 and @xmath173 .",
    "furthermore , consistency for @xmath174 means + ( a ) @xmath165 and @xmath175 implies @xmath176 , + ( b ) @xmath165 and @xmath177 implies @xmath178 and @xmath179 + ( c ) @xmath166 implies @xmath180 .",
    "+ this is a consequence of transitional arcs being induced by transitional vertices by means of poincar ' e duality and the latter being minimal in the boundary component . as a result a transitional arc needs to be placed in the left - nonterminal as long as the latter contains any arcs @xmath181 with the property @xmath182 .    as a result",
    "we have the production rule : @xmath183 satisfying @xmath184 , for @xmath185 , @xmath186 , @xmath187 . in case of @xmath165 , if @xmath175 , we have @xmath176 and @xmath188 . otherwise , if @xmath177 , the @xmath53th trans - arc is distributed to the right and we have @xmath189 and @xmath179 . finally , if @xmath166 , both , @xmath190 , see fig .",
    "[ f : grammar1 ] .",
    "_ arc - removal : _ this means to act on the nonterminal @xmath159 by removing its outer arc , @xmath181 .",
    "the key point here is to provide this arc with a label , @xmath139 consistent with the label associated with the generated nonterminals . given @xmath159 any arc - removal based production rule generates the nonterminal @xmath191 , where @xmath192 and @xmath193 .",
    "this implies for the label of the removed arc @xmath194 , @xmath162 . in case @xmath181",
    "is a trans - arc for @xmath195 , we have @xmath196 , or @xmath197 , otherwise .",
    "accordingly , we have : @xmath198    the terminal symbols @xmath199 , nonterminal symbols @xmath200 , production rules @xmath201 given by eq .  [ [ e : rule_can ] ] , eq .",
    "[ [ e : rule_rem ] ] , together with the initial condition @xmath202 with @xmath203 and @xmath165 , for @xmath187 , define the context - free grammar @xmath204 .",
    "the context - free grammar @xmath205 discussed above generates all @xmath1-structures uniquely , or equivalently , all pk - structures together with a blueprint .",
    "_ proof : _ consider a nonterminal symbol @xmath206 where the @xmath207 are positive odd integers , with @xmath203 and @xmath165 .",
    "any nonterminal symbol is uniquely generated by @xmath205 since the product of each production rule is unique .",
    "furthermore , no labeled arc with @xmath208 can be further added to the structure when @xmath209 is set to be @xmath97 .",
    "this guarantees that the trans - arc of level @xmath107 is minimal among those arcs with @xmath208 .",
    "thus the structures generated from @xmath206 are @xmath1-structures . as for its generative power , an arbitrary a @xmath1-structure ,",
    "is translated via @xmath205 into a unique sequence of terminal symbols , whence the proposition .",
    "the grammar @xmath205 for @xmath1-structure is designed based on the simple grammar for secondary structure by assigning labels to symbols .",
    "however , the latter evaluates arcs against unpaired vertices , lacking the capability of differentiating base pairs and unpaired bases in the context of specific loop types .",
    "we accordingly present a grammar for @xmath1-structures , _",
    "rnafeatures@xmath0 _ used in practice that differentiates loop types , that is an extension of the grammar _ rnafeatures _",
    "the grammar allows us to differentiate loop - types .",
    "first we have the terminal symbols @xmath210 representing the respective rna nucleotides and the endpoint of the rainbow .",
    "the nonterminal symbols are @xmath211    the nonterminal symbols are referenced via both : their semantics and their arc - label information of the class of structures it represents .",
    "@xmath212-structure are @xmath1-structures corresponding to a pk - structure of genus @xmath9 , together with a blueprint . for nonterminal symbols the @xmath213 , where @xmath214 the index @xmath215 represents the sum of the arc - labels contained in the class , such that @xmath165 if and only if the transitional arc of level @xmath53 is present .",
    "we distinguish the following classes :    * @xmath216 denotes the class that is immediately nested in the rainbow , * @xmath217 denotes the class covered by parallel arcs , while @xmath218 represents the class covered by a isolated arc , * @xmath219 represents the class containing no arcs , immediately nested in @xmath218 , while @xmath220 , @xmath221 , @xmath222 have one and @xmath223 have more than one such arc .",
    "the classes @xmath220 , @xmath221 and @xmath222 differ in the number of unpaired bases in the two intervals formed between the outer arc and the immediately nested arc .",
    "@xmath221 has the interval to the right empty and the intervals to the left non - empty , @xmath222 is defined analogously and in @xmath220 both these intervals are non - empty , * @xmath224 and @xmath225 are classes contained in a multi - loop : @xmath225 has exactly one braching and @xmath224 has at least two , * @xmath226 denotes the class consisting of a sequence of unpaired bases .",
    "the nonterminal symbols are listed in fig .",
    "[ f : nonterminals ]    * @xmath227 : here we have @xmath228 . in case of @xmath229 , the rainbow is always a transitional arc , hence @xmath230 if @xmath231 , * @xmath232 emits the signal @xmath154 of the @xmath1-structure , * @xmath233 cuts off the leftmost unpaired base and keeps all the labels as well as transitional arcs in the right nonterminal , where @xmath234 .",
    "@xmath235 , @xmath236 and @xmath237 are defined analogously , * @xmath238 decompose into two classes , distributing any labeled arcs and in particular any trans - arcs , whence @xmath239 . in case of @xmath165 ,",
    "if @xmath175 , we have @xmath176 and @xmath188 . otherwise , if @xmath177 , the @xmath53th trans - arc is distributed to the rhs and we have @xmath189 and @xmath179 . finally , if @xmath166 , both , @xmath190 .",
    "the rules @xmath240 , @xmath241 and @xmath242 are defined analogously , * @xmath243 remove a base pair @xmath244 with the arc label @xmath139 , @xmath245 , inducing the labels @xmath246 for the class produced . if @xmath247 and @xmath165 , the arc @xmath248 is a trans - arc of level @xmath53 and we set @xmath189 accordingly .",
    "the rules @xmath249 , @xmath250 , @xmath251 , @xmath252 , @xmath253 as well as @xmath254 , @xmath255 are defined analogously .",
    "we display the production rules in fig .  [",
    "f : rules ] .",
    "let @xmath149 be a structure and @xmath256 be an rna sequence .",
    "a cfg allows to assign a score to a pair @xmath257 , derived from scores assigned to the production rules encountered .",
    "namely , for each @xmath257 the cfg provides a unique parse tree and the score of @xmath258 is then computed by means of the scores of the respective production rules .",
    "scores based on a thermodynamic energy model produces the minimum free energy ( mfe ) model @xcite and a probabilistic scoring scheme derived from data bases of rna sequences and structures leads to a scfg @xmath259 . in the latter case ,",
    "sequence  structure pairs of the data set allow to assign scores to the production rules , which in turn induce a score of an arbitrary pair @xmath257 .",
    "stochastic context - free grammars ( scfg ) were developed for rna secondary structures @xcite .",
    "they have been employed for the _ ab initio _ structure prediction as well as the analysis of observables such as base pairing probabilities or loop patterns @xcite .",
    "a scfg is derived from a cfg by associating to each production rule @xmath35 a probability @xmath260 .",
    "that is , for any nonterminal @xmath261 , suppose that @xmath262 are all derivations of @xmath261 , then we have @xmath263 .",
    "let @xmath264 denotes an rna structure of genus @xmath9 and @xmath256 be a sequence . for @xmath265",
    ", @xmath266 is a secondary structure and can be parsed by _",
    "rnafeatures_. we construct the parse tree of @xmath267 and record the frequency of the production rules . in case of @xmath10 , for any @xmath264-blueprint , @xmath268",
    ", we consider the correspondence @xmath269 where @xmath270 is a @xmath1-structure and @xmath271 is the modified sequence .",
    "we construct the parse tree of _",
    "rnafeatures_@xmath0 of @xmath272 and record the frequency of the encountered production rules .",
    "if there are @xmath75 @xmath264-blueprints , the contribution of each pair @xmath272 is normalized by @xmath273 and the frequency of a production rule @xmath201 equals @xmath274 where @xmath275 is the frequency of @xmath201 being applied . after processing all structures and sequences ,",
    "the probability of a production rule is computed as the quotient of its frequency over the sum of all frequencies of its respective derivation .",
    "we next consider @xmath276 , the normalized score of an arbitrary structure , @xmath264 , over an arbitrary sequence , @xmath256 , as a function of the data set @xmath277 .",
    "we set @xmath278 , where @xmath279 is calculated by the multiplying the probabilities of the production rules in the parse tree of @xmath272 and the sum is taken over the set of all @xmath264-blueprints .",
    "the @xmath276 induce @xmath280 .",
    "using the fact that for fixed blueprint , @xmath93 , we have a bijection @xmath281 , we derive @xmath282    furthermore the scfg facilitates the sampling of structures @xmath283 with boltzmann probability , i.e. , @xmath284 .",
    "we employ _",
    "rnafeatures@xmath0 _ to boltzmann sample a @xmath1-structure @xmath285 , and reconstruct @xmath264 as well as the associated blueprint , @xmath268 : fixing @xmath264 , suppose there are @xmath75 blueprints @xmath286 , these correspond to the @xmath75 distinct @xmath1-structures @xmath287 . let @xmath288 be the collection of all such @xmath287 . in view of @xmath289 being a bijection",
    ", we have @xmath290 therefore , in view of @xmath291 and @xmath292 we have @xmath293 .    as for runtime complexity , the boltzmann sampler of secondary structures using such a scfg has runtime of @xmath3 , if structures are ranked according to the sequential order .",
    "this can be improved to @xmath294 by ranking the structures with the boustrophedon order @xcite . for fixed topological genus , the label enhancement of _",
    "rnafeatures_@xmath0 by construction increases only the number of derivations .",
    "thus the boltzmann sampler for @xmath1-structures has runtime complexity @xmath294 .",
    "rna secondary structures have been widely studied using the classic cfg implied by the recursions in @xcite . using rna sequence and structure data sets",
    ", this cfg induces a sfcg .",
    "this scfg has been applied for the _ ab initio _ prediction of rna secondary structures @xcite , calculating the likelihood of a sequence generated by the model scfg @xcite , and detecting rna genes using comparative sequence analysis @xcite .",
    "furthermore , the generation of random secondary structures according to the native distributions of certain families of rna structures is studied in @xcite in order to identify key structural motifs in biological rna secondary structures .",
    "this paper allows to extend these studies to pk - structures . to the best of our knowledge",
    "rnafeatures_@xmath0 is the first unambiguous context - free grammar for pk - structures .",
    "related work has been done by freiermuth and nebel on a cfg of certain , colored trees .",
    "these are trees that can be mapped to unicellular maps , however , not bijectively .",
    "a particular , multiple context - free grammar ( mcfg ) for pk - structures is introduced in @xcite .",
    "this grammar employs a vector of nonterminal symbols referencing a substructure with a gap .",
    "the time and space complexity for boltzmann sampling pk - structures with this grammar are @xmath7 and @xmath3 , respectively .",
    "the grammar furthermore implies a folding algorithm having relatively high computational cost @xcite : @xmath6 time and @xmath7 space complexity , using the thermodynamic model . restricting to certain types of pk - structures",
    "the time complexity can be reduced to @xmath7 time complexity @xcite . in any case , specifying the output space of the mcfg , i.e.  what types of structures the grammar actually generates is subtle , see @xcite for details .",
    "the passage from mcfg to cfg has implications for time and space complexity : an mcfg contains rules of the type @xmath295 where @xmath296 , @xmath297 are vectors of nonterminals .",
    "it requires a minimum of three loop - indices to execute these rules in the sampling or folding process .",
    "in contrast , the production rule in any cfg being in chomsky normal form can be written as @xmath298 , which requires only one loop index , reducing the time complexity by @xmath3 . as for space complexity",
    "this passage obsoletes using vectors , reducing the space complexity for @xmath299 and @xmath3 for sampling and folding , respectively .    the key idea facilitating this passage lies in mapping the information of crossing arcs into the labels of noncrossing arcs , i.e.  passing from pk - structures to @xmath1-structures .",
    "accordingly , the bijection of eq .",
    "[ e : bi ] is the crucial point .",
    "the fact that the bijection is genuinely topology - based allows _ rnafeatures_@xmath0 to extend the classic cfg of secondary structures , generating any pk - structure .    in the following we present the expectation and variance of some important parameters related to the structural features of pk - structures generated by the induced scfg of _ rnafeatures_@xmath0 .",
    "these parameters are also used to analyze boltzmann sampled secondary structures in comparison with native structures in @xcite .",
    "our scfg is trained via @xmath300 single stranded trna sequence - structure pairs , taken from the nucleic acid database ( ndb ) @xcite , considering only watson - crick and wobble base pairs . in this training set ,",
    "we find @xmath301 structures having genus @xmath58 , @xmath302 of genus @xmath97 and @xmath97 structure of genus @xmath29 .",
    "the average sequence length is @xmath303 nucleotides .",
    "we analyze the following five random variables : @xmath304 , the number of base pairs , @xmath305 , the number of stacks , @xmath306 , the average length of a stack , @xmath307 , the number of hairpin and finally @xmath308 , the average length of a hairpin loop . here a stack of length @xmath42 is the maximal sequence of parallel arcs @xmath309",
    ". a hairpin loop of length @xmath310 is a substructure , which consists of a base pair @xmath21 and the unpaired bases @xmath311 .",
    "the statistics is obtained by boltzmann sampling of @xmath312 structures over @xmath313 nucleotides via the scfg . for reference purposes we furthermore sample @xmath312 random structures over @xmath313 nucleotides , having fixed genus @xmath58 and @xmath97 , respectively , with uniform probability @xcite .",
    "we summarize in table  [ t : stat ] the respective means and variances of the above five random variables .",
    "the sampling generates @xmath314 , @xmath315 , @xmath316 structures having genus @xmath58 , @xmath97 and @xmath29 , reflecting the large quantity of genus @xmath97 structures in the training set . by construction",
    "our scfg does not recognize contributions of unpaired bases in hairpin loops , bulges and interior loops , which explains the systematic deviation in the lengths of hairpin - loops .",
    "table  [ t : stat ] shows that the boltzmann sampled structures are not random structures of either genus zero or one .",
    "the implication of the cfg to the folding of pk - structures is work in progress . though we can fold a @xmath1-structure over a given sequence @xmath256 in @xmath5 time",
    ", the bijection producing the corresponding pseudoknotted structure does systematically alter the underlying sequence .",
    "in particular , in case of pk - structures of genus one , this consists in the transposition of two subsequent intervals and is thus manageable .",
    "we gratefully acknowledge the help of kevin shinpaugh and the computational support team at vbi . many thanks to christopher l.  barrett and henning mortveit for discussions .",
    "b.  j. yoon , p.  p. vaidyanathan , structural alignment of rnas using profile - cshmms and its application to rna homology search : overview and new results .",
    ", ieee trans .",
    "( joint special issue on systems biology with ieee transactions on circuits and systems : part - i ) 53 ( 2008 ) 1025 .",
    "d.  sankoff , g.  leduc , n.  antoine , b.  paquin , b.  f. lang , c.  r. , gene order comparisons for phylogenetic inference : evolution of the mitochondrial genome , proc .",
    "usa 89 ( 1992 ) 65756579 .",
    "r.  c. penner , cell decomposition and compactification of riemann s moduli space in decorated teichmller theory , in : n.  tongring , r.  c. penner ( eds . ) , woods hole mathematics - perspectives in math and physics , world scientific , singapore , 2004 , pp . 263301 , arxiv : math .",
    "gt/0306190 .",
    "r.  giegerich , introduction to stochastic context free grammars , in : j.  gorodkin , w.  l. ruzzo ( eds . ) , rna sequence , structure , and function : computational and bioinformatic methods , 1st edition , vol .",
    "1097 , humana press , 2014 , ch .  5 , pp .",
    "85126 .",
    "d.  mathews , m.  disney , j.  childs , s.  schroeder , m.  zuker , d.  turner , incorporating chemical modification constraints into a dynamic programming algorithm for prediction of rna secondary structure , proc .",
    "usa 101 ( 2004 ) 72877292 .",
    "h.  m. berman , w.  k. olson , d.  l. beveridge , j.  westbrook , a.  gelbin , t.  demeny , a.  r. hsieh , s. h. amd  srinivasan , b.  schneider , the nucleic acid database : a comprehensive relational database of three - dimensional structures of nucleic acids , biophys .",
    "j. 63  ( 751 - 759 ) .",
    "b.  c. narayanan , j.  westbrook , s.  ghosh , a.  i. petrov , b.  sweeney , c.  l. zirbel , n.  b. leontis , h.  m. berman , the nucleic acid database : new features and capabilities , nucleic acids res .",
    "42 ( 2013 ) d11422 .                    , the unique vertex obtained by collapsing the backbone , @xmath317 the fixed - point free involution representing the ribbons , and @xmath318 .",
    "( b ) : the poincar dual interchanging boundary components by vertices , hence producing a unicellular map . ]     as well as all of its associated @xmath1-matchings induced by all possible blueprints . in the insert ,",
    "we show how the bottom two @xmath1-matchings are induced : red circles reference the first and blue circles the second slicing , respectively . ]",
    "-tree with labeled vertices to a @xmath1-matching with labeled arcs .",
    "( a ) a @xmath1-tree with labeled vertices .",
    "( b ) shifting the labels from vertices to edges .",
    "( c ) a @xmath1-matching with labeled arcs obtained from ( b ) by taking the poincar dual . ]"
  ],
  "abstract_text": [
    "<S> in this paper we introduce a novel , context - free grammar , _ rnafeatures@xmath0 _ , capable of generating any rna structure including pseudoknot structures ( pk - structure ) . </S>",
    "<S> we represent pk - structures as orientable fatgraphs , which naturally leads to a filtration by their topological genus . within this framework , </S>",
    "<S> rna secondary structures correspond to pk - structures of genus zero . </S>",
    "<S> _ rnafeatures@xmath0 _ acts on formal , arc - labeled rna secondary structures , called @xmath1-structures . </S>",
    "<S> @xmath1-structures correspond one - to - one to pk - structures together with some additional information . </S>",
    "<S> this information consists of the specific rearrangement of the backbone , by which a pk - structure can be made cross - free . </S>",
    "<S> _ rnafeatures@xmath0 _ is an extension of the grammar for secondary structures and employs an enhancement by labelings of the symbols as well as the production rules . </S>",
    "<S> we discuss how to use _ </S>",
    "<S> rnafeatures@xmath0 _ to obtain a stochastic context - free grammar for pk - structures , using data of rna sequences and structures . </S>",
    "<S> the induced grammar facilitates fast boltzmann sampling and statistical analysis . as a first application </S>",
    "<S> , we present an @xmath2 runtime algorithm which samples pk - structures based on ninety trna sequences and structures from the nucleic acid database ( ndb ) .    rna pseudoknot structure , context - free grammar , topological rna structure , fatgraph , stochastic context - free grammar </S>"
  ]
}