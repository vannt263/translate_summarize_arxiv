{
  "article_text": [
    "recently , baker and norine  @xcite proved a graph theoretic analogue of the classical riemann - roch theorem for curves in algebraic geometry .",
    "the proof is combinatorial and makes use of chip - firing games  @xcite and parking functions on graphs .",
    "several papers later extended the results of baker and norine to tropical curves  @xcite .",
    "the question treated in this paper is to characterize those lattices which admit a riemann - roch theorem for the corresponding analogue of the rank - function defined by baker and norine .",
    "let @xmath2 be a finite connected ( multi-)graph with the set of vertices @xmath3 and the set of edges @xmath4 .",
    "we suppose that @xmath0 does not have loops .",
    "the chip - firing game is the following game played on the set of vertices of @xmath0 : at the initial configuration of the game , each vertex of the graph is assigned an integer number of chips .",
    "a vertex can have a positive number of chips in its possession or can be assigned a negative number meaning that the vertex is in debt with the amount described by the absolute value of that number . at each step of the chip - firing game , a vertex in the graph can decide to _ fire _ : firing means the vertex gives one chip along each edge incident with it , to its neighbours .",
    "thus , after the firing made by a vertex @xmath5 of degree @xmath6 , the integer assigned to @xmath5 decreases by @xmath6 , while the integer associated to each vertex @xmath7 connected by @xmath8 ( parallel ) edges to @xmath5 increases by @xmath8 .",
    "the objective of the vertices of the graph is to come up with a configuration in which no vertex is in debt , i.e. , a configuration in which all the integers associated to vertices become non - negative",
    ".    * problem .",
    "* _ given an intial configuration , is there a finite sequence of chip - firings such that eventually each vertex has a non - negative number of chips ? _",
    "let @xmath9 , degree of @xmath10 , be the total number of chips present in the game , i.e. , the sum of the integers associated to the vertices of the graph .",
    "it is clear that degree remains unchanged through each step of the game , thus , a necessary condition for a positive answer to the above question is to have a non - negative degree .      to",
    "each given chip - firing configuration @xmath10 , baker and norine associate a rank @xmath11 as follows .",
    "the rank of @xmath10 is @xmath12 if there is no way to obtain a configuration in which all the vertices have non - negative weights . and",
    "otherwise , @xmath11 is the maximum non - negative integer @xmath13 such that removing any set of @xmath13 chips from the game ( in an arbitrary way ) , the obtained configuration can be still transformed via a sequence of chip - firings to a configuration where no vertex is in debt . in particular , note that @xmath14 iff there is a sequence of chip - firings which results in a configuration with non - negative number of chips at each vertex .",
    "the main theorem of  @xcite is a duality theorem for the rank function @xmath15 .",
    "let @xmath16 be the _",
    "canonical _ configuration defined as follows : @xmath16 is the configuration of chips in which every vertex @xmath5 of degree @xmath6 is assigned @xmath17 chips .",
    "given a chip - firing configuration @xmath10 , the configuration @xmath18 is defined as follows : a vertex @xmath5 of degree @xmath6 is assigned @xmath19 chips in @xmath18 if @xmath5 is assigned @xmath20 chips in @xmath10 .",
    "recall that the genus @xmath21 of a connected graph @xmath0 with @xmath22 vertices and @xmath23 edges is @xmath24 .",
    "[ bano07 ] for every configuration @xmath10 , we have @xmath25    the existing proof of the riemann - roch theorem for graphs ( and its extension to metric graphs and tropical curves  @xcite ) is based on a family of specific configurations which are called reduced .",
    "we refer to  @xcite for more details , explaining the origin of the name given to this theorem in its connections with the riemann - roch theorem for algebraic curves .    here",
    "we just cite some direct consequences of the above theorem for the chip - firing game .    *",
    "if a configuration @xmath10 contains more than @xmath21 chips , there is a sequence of chip - firings which produces a configuration where no vertex is in debt ( more generally , one has @xmath26 ) .",
    "* @xmath27 ( note that @xmath28 ) .",
    "recall that a lattice is a discrete subgroup of the abelian group @xmath29 for some integer @xmath30 ( e.g. , the lattice @xmath31 ) , and the rank of a lattice is its rank considered as a free abelian group .",
    "a sub - lattice of @xmath32 is called integral in this paper .",
    "let @xmath2 be a given undirected connected ( multi-)graph and @xmath33 .",
    "the _ laplacian _ of @xmath0 is the matrix @xmath34 , where @xmath35 is the diagonal matrix whose @xmath36th entry is the degree of @xmath37 , and @xmath38 is the _ adjacency matrix _ of @xmath0 whose @xmath39th entry is the number of edges between @xmath37 and @xmath40 .",
    "it is well - known and easy to verify that @xmath41 is symmetric , has rank @xmath30 , and that the kernel of @xmath41 is spanned by the vector whose entries are all equal to @xmath42 , c.f .",
    "@xcite .",
    "the _ laplacian lattice _ @xmath43 of @xmath0 is defined as the image of @xmath44 under the linear map defined by @xmath41 , i.e. , @xmath45 , c.f .",
    ", @xcite . since @xmath0 is a connected graph",
    ", @xmath43 is a sub - lattice of the root lattice @xmath1 of full - rank equal to @xmath30 , where @xmath46 is the lattice defined as follows : @xmath47 note that @xmath1 is a discrete sub - group of the hyperplane @xmath48 of @xmath49 and has rank @xmath30 .    to each configuration @xmath10 , it is straightforward to associate a point @xmath50 in @xmath44 : @xmath50 is the vector with coordinates equal to the number of chips given to the vertices of @xmath0 . for a sequence of chip - firings on @xmath10 resulting in another configuration @xmath51 ,",
    "it is easy to see that there exists a vector @xmath52 such that @xmath53 .",
    "conversely , if @xmath54 for a vector @xmath52 , then there is a sequence of chip - firings transforming @xmath10 to @xmath51 . using this equivalence ,",
    "it is possible to transform the chip - firing game and the statement of the riemann - roch theorem to a statement about @xmath44 and the laplacian lattice @xmath55 .",
    "laplacian of graphs and their spectral theory have been well studied .",
    "the laplacian captures information about the geometry and combinatorics of the graph @xmath0 , for example , it provides bounds on the expansion of @xmath0 ( we refer to the survey  @xcite ) or on the quasi - randomness properties of the graph , see  @xcite .",
    "the famous matrix tree theorem states that _ the cardinality of the ( finite ) picard group @xmath56 is the number of spanning trees of @xmath0_.      let @xmath57 be a sub - lattice of @xmath1 of full - rank ( e.g. , @xmath58 ) .",
    "define an equivalence relation @xmath59 on the set of points of @xmath60 as follows : @xmath61 if and only if @xmath62 .",
    "this equivalence relation is referred to as _ linear equivalence _ and the equivalence classes are denoted by @xmath63 .",
    "we say that a point @xmath4 in @xmath44 is _ effective _ or _ non - negative _ , if all the coordinates are non - negative . for a point @xmath64 ,",
    "the linear system associated to @xmath35 is the set @xmath65 of all effective points linearly equivalent to @xmath35 : @xmath66    the _ rank _ of an integral point @xmath67 , denoted by @xmath68 , is defined by setting @xmath69 , if @xmath70 , and then declaring that for each integer @xmath71 , @xmath72 if and only if @xmath73 for all effective integral points @xmath4 of degree @xmath74 .",
    "observe that @xmath68 is well - defined and only depends on the linear equivalence class of @xmath35 .",
    "note that @xmath68 can be defined as follows : @xmath75 obviously , @xmath76 is a trivial upper bound for @xmath68 .      the main aim of this paper is to provide a characterization of the sub - lattices of @xmath1 which admit a riemann - roch theorem with respect to the rank - function defined above . in the mean - while",
    ", our approach provides a geometric proof of the theorem of baker and norine , theorem  [ bano07 ] .",
    "we show that riemann - roch theory associated to a full rank sub - lattice @xmath57 of @xmath1 is related to the study of the voronoi diagram of the lattice @xmath57 in the hyperplane @xmath77 under a certain simplicial distance function .",
    "the whole theory is then captured by the corresponding critical points of this simplicial distance function .",
    "we associate two geometric invariants to each such sub - lattice of @xmath1 , the _",
    "min- _ and the _ max - genus _ , denoted respectively by @xmath78 and @xmath79 .",
    "two main characteristic properties for a given sub - lattice of @xmath1 are then defined .",
    "the first one is what we call _ reflection invariance _ , and one of our results here is a weak riemann - roch theorem for reflection - invariant sub - lattices of @xmath1 of full - rank @xmath30 .    [ rrineq_theo ] let @xmath57 be a reflection invariant sub - lattice of @xmath1 of rank @xmath30 .",
    "there exists a point @xmath80 , called _",
    "canonical _ , such that for every point @xmath81 , we have @xmath82    the second characteristic property is called _ uniformity _ and simply means @xmath83 .",
    "it is straightforward to derive a riemann - roch theorem for uniform reflection - invariant sub - lattices of @xmath1 of rank @xmath30 from theorem  [ rrineq_theo ] above .",
    "[ rr_theo ] let @xmath57 be a uniform reflection invariant sub - lattice of @xmath1 .",
    "then there exists a point @xmath80 , called _",
    "canonical _ , such that for every point @xmath81 , we have @xmath84 where @xmath85 .",
    "we then show that laplacian lattices of undirected connected graphs are uniform and reflection invariant , obtaining a geometric proof of the riemann - roch theorem for graphs . as a consequence of our results ,",
    "we provide an explicit description of the voronoi diagram of lattices generated by laplacian of connected graphs and discuss some duality concerning the arrangement of simplices defined by the points of the laplacian lattice .    in the case of the laplacian lattices of connected regular digraphs , we also provide a slightly stronger statement than theorem  [ rrineq_theo ] above .",
    "the above results also provide a characterization of full - rank sub - lattices of @xmath1 for which a riemann - roch formula holds , indeed , these are exactly those lattices which have the uniformity and the reflection - invariance properties . we conjecture that any such lattice is the laplacian lattice of an oriented multi - graph ( as we will see , there are examples of such lattices which are not the laplacian lattice of any unoriented multi - graph ) .",
    "the paper is structured as follows .",
    "sections  [ sec : prel ] and  [ app : theo - dom ] provide the preliminaries .",
    "this includes the definition of a geometric region in @xmath49 associated to a given lattice , called the sigma - region , some results on the shape of this region in terms of the extremal points , and the definition of the min- and max - genus . in section",
    "[ sec : voronoi ] , we provide the geometric terminology we need in the following sections for the proof of our main results .",
    "this is done in terms of a certain kind of voronoi diagram , and in particular , some main properties of the voronoi diagram of sub - lattices of @xmath1 under a certain simplicial distance function are provided in this section .",
    "the proof of our riemann - roch theorem is provided in section  [ sec : r - r - theo ] .",
    "most of the geometric terminology introduced in the first sections will be needed to define an involution on the set of extremal points of the sigma - region , the proof of the riemann - roch theorem is then a direct consequence of this and the definition of the min- and max - genus .",
    "it is helpful to note that the main ingredients used directly in the proof of theorems  [ rrineq_theo ] and  [ rr_theo ] are the results of section  [ sec : prel ] and lemma  [ crit_lem ] ( and its corollary  [ cor : crit ] ) .",
    "the results of the first sections are then used in treating the examples in section  [ sec : examples ] , specially for the laplacian lattices .",
    "we derive in this section a new proof of the main theorem of  @xcite , the riemann - roch theorem for graphs .",
    "our work raises questions on the classification of sub - lattices of @xmath1 with reflection invariance and/or uniformity properties . in section  [ sec : examples ] , we present a complete answer for sub - lattices of @xmath86 . finally , some algorithmic questions are discussed in section  [ sec : algo ] , e.g. , we show that it is computationally hard to decide if the rank function is non - negative at a given point for a general sub - lattice of @xmath1 .",
    "this is interesting since in the case of laplacian lattices of graphs , the problem of deciding if the rank function is non - negative can be solved in polynomial time .",
    "as we said , in what follows we will assume that @xmath57 is an integral sub - lattice in @xmath77 of full - rank , i.e. , a sub - lattice of @xmath1 .",
    "but indeed , what we are going to present also works in the more general setting of full rank sub - lattices of @xmath77 , though the invariants and rank function defined for these lattices are not integer .",
    "we will say a few words on this and some other results in the concluding section .",
    "a point of @xmath49 with integer coordinates is called an _",
    "integral point_. by a lattice @xmath57 , we mean a discrete subgroup of @xmath77 of maximum rank .",
    "recall that @xmath77 is the set of all points of @xmath49 such that the sum of their coordinates is zero .",
    "the elements of @xmath57 are called _",
    "lattice points_. the positive cone in @xmath49 consists of all the points with non - negative coordinates . we can define a partial order in @xmath49 as follows : @xmath87 if and only if @xmath88 is in the positive cone , i.e. , if each coordinate of @xmath88 is non - negative . in this case",
    "we say @xmath89 _ dominates _ @xmath90 . also we write @xmath91 if all the coordinates of @xmath88 are strictly positive .    for a point @xmath92 ,",
    "we denote by @xmath93 and @xmath94 the negative and positive parts of @xmath5 respectively .",
    "for a point @xmath95 , we define the degree of @xmath96 as @xmath97 . for each @xmath98 , by @xmath99 we denote the hyperplane consisting of points of degree @xmath98 , i.e. , @xmath100 by @xmath101 , we denote the projection from @xmath49 onto @xmath99 along @xmath102 . in particular",
    ", @xmath103 is the projection onto @xmath77 .",
    "finally for an integral point @xmath67 , by @xmath104 we denote the set of all neighbours of @xmath35 in @xmath44 , which consists of all the points of @xmath44 which have distance at most one to @xmath35 in @xmath105 norm .    in the following , to simplify the presentation , we will use the convention of tropical arithmetic , briefly recalled below .",
    "( this is so only a matter of notation ) .",
    "the tropical semiring @xmath106 is defined as follows : as a set this is just the real numbers @xmath107 .",
    "however , one redefines the basic arithmetic operations of addition and multiplication of real numbers as follows : @xmath108 in words , the tropical sum of two numbers is their minimum , and the tropical product of two numbers is their sum .",
    "we can extend the tropical sum and the tropical product to vectors by doing the operations coordinate - wise .",
    "all through this section @xmath57 will denote a full rank ( integral ) sub - lattice of @xmath77 .",
    "every point @xmath35 in @xmath44 defines two `` orthogonal '' cones in @xmath49 , denoted by @xmath109 and @xmath110 , as follows : @xmath111 is the set of all points in @xmath49 which are dominated by @xmath35 . in other words",
    "@xmath112    similarly @xmath113 is the set of points in @xmath49 that dominate @xmath35 . in other words ,",
    "@xmath114    for a cone @xmath10 in @xmath49 , we denote by @xmath115 and @xmath116 , the set of integral and rational points of the cone respectively . when there is no risk of confusion , we sometimes drop @xmath117 ( resp .",
    "@xmath118 ) and only refer to @xmath10 as the set of integral points ( resp .",
    "rational points ) of the cone @xmath10 .",
    "the _ sigma - region _ of the lattice @xmath57 is , roughly speaking , the set of integral points of @xmath44 that are not contained in the cone @xmath119 for any point @xmath120 .",
    "more precisely :    the sigma - region of @xmath57 , denoted by @xmath121 , is defined as follows : @xmath122    the following lemma shows the relation between the sigma - region and the rank of an integral point as defined in the previous section .",
    "[ ranksig_lem ]    * for a point @xmath35 in @xmath60 , @xmath69 if and only if @xmath123 is a point in @xmath121 . *",
    "more generally , @xmath124 is the distance of @xmath123 to @xmath121 in the @xmath125 norm , i.e. , @xmath126 .    .",
    "all the black points belong to the sigma - region .",
    "the integral points in the grey part are out of the sigma - region . ]    before presenting the proof of lemma  [ ranksig_lem ] , we need the following simple observation .    [ observ - r - trick ] @xmath127 , we have @xmath128 if and only if @xmath129 .",
    "we shall usually use this observation without sometimes mentioning it explicitly .",
    "* recall that @xmath69 means that @xmath70 .",
    "this in turn means that @xmath130 for any @xmath96 in @xmath57 , or equivalently @xmath131 for any point @xmath132 in @xmath57 ( because @xmath133 ) .",
    "we infer that @xmath123 is a point of @xmath121 .",
    "conversely , if @xmath123 belongs to @xmath121 , then @xmath131 for any point @xmath132 in @xmath57 , or equivalently @xmath130 for any @xmath96 in @xmath57 ( because @xmath133 ) .",
    "this implies that @xmath70 and hence @xmath69 .",
    "* let @xmath134 be a point in @xmath121 which has minimum @xmath125 distance from @xmath123 , and define @xmath135 . write @xmath136 , where @xmath137 and @xmath138 are respectively the positive and the negative parts of @xmath139 .",
    "we first claim that @xmath139 is an effective integral point , i.e. , @xmath140 . for",
    "the sake of a contradiction , let us assume the contrary , i.e. , assume that @xmath141 . since @xmath142 is contained in @xmath121 , and because @xmath143 , the point @xmath144 has to be in @xmath121 .",
    "also @xmath145 ( because @xmath146 and @xmath147 ) .",
    "we obtain @xmath148 , which is a contradiction by the choice of @xmath134 .",
    "therefore , we have @xmath149    lemma  [ ranksig_lem ] shows the importance of understanding the geometry of the sigma - region for the study of the rank function .",
    "this will be our aim in the rest of this section and in section  [ sec : voronoi ] .",
    "but we need to introduce another definition before we proceed .",
    "apparently , it is easier to work with a `` continuous '' and `` closed '' version of the sigma - region .",
    "@xmath150 is the set of points in @xmath151 that are not dominated by any point in @xmath57 .",
    "@xmath152 by @xmath153 we denote the topological closure of @xmath150 in @xmath154 .",
    "one advantage of this definition is that it can be used to define the same riemann - roch machinery for any full dimensional sub - lattice of @xmath77 .",
    "indeed for such a sub - lattice @xmath57 , it is quite straightforward to associate a real - valued rank function to any point of @xmath49 ( c.f .",
    "lemma  [ ranksig_lem ] ) .",
    "the main theorems of the paper can be proved in this more general setting .",
    "as all the examples of interest for us are integral lattices , we have restricted the presentation to sub - lattices of @xmath1 .",
    "we say that a point @xmath155 is an _",
    "point if it is a local minimum of the degree function .",
    "in other words    the set of extremal points of @xmath57 denoted by @xmath156 is defined as follows :    @xmath157    recall that for every point @xmath67 , @xmath104 is the set of neighbours of @xmath35 in @xmath44 , which consists of all the points of @xmath44 which have distance at most one to @xmath35 in @xmath105 norm .",
    "we also define extremal points of @xmath153 as the set of points that are local minima of the degree function and denote it by @xmath158 .",
    "local minima here is understood with respect to the topology of @xmath49 : @xmath159 is a local minima if and only if there exists an open ball @xmath160 containing @xmath159 such that @xmath159 is the point of minimum degree in @xmath161 .",
    "the following theorem describes the sigma - region of @xmath57 in terms of its extremal points .",
    "[ dom_thm ] every point of the sigma - region dominates an extremal point .",
    "in other words , @xmath162 . recall that @xmath163 is the set of integral points of the cone @xmath164 .",
    "indeed , we first prove the following continuous version of theorem  [ dom_thm ] .",
    "[ cdom_thm ] for any ( integral ) sub - lattice @xmath57 of @xmath77 , we have @xmath165 .    and theorem  [ dom_thm ] is derived as a consequence of theorem  [ cdom_thm ] .",
    "the proof of these two theorems are presented in section  [ app : theo - dom ] .",
    "the proof shows that every extremal point of @xmath166 is an integral point and @xmath167 , where @xmath168 denotes the set of integral points of @xmath166 .",
    "we refer to section  [ app : theo - dom ] for more details .",
    "[ prop : twosigmas ] we have @xmath167 and @xmath169 in particular , @xmath170 .",
    "the important point about theorem  [ dom_thm ] is that one can use it to express @xmath68 in terms of the extremal points of @xmath121 . for an integral point @xmath171 ,",
    "let us define @xmath172 and @xmath173 .",
    "we have :    [ rank_lem ] for every integral point @xmath174 , @xmath175    first recall that @xmath176 let @xmath177 and @xmath178 be a point in @xmath121 . by theorem [ dom_thm ] , we know that @xmath96 is a point in @xmath121 if and only if @xmath179 for some point @xmath180 in @xmath156 and @xmath181 .",
    "so we can write @xmath182 where @xmath183 and @xmath184",
    ". hence we have @xmath185    we now observe that for every @xmath186 , the integral point @xmath187 of minimum degree such that @xmath188 has degree exactly @xmath189 . we infer that @xmath190 we conclude that @xmath191 and the lemma follows .",
    "we define two notions of genus for full - rank sub - lattices of @xmath1 , _ min- and max - genus _ , in terms of the extremal points of the sigma - region of @xmath57 .",
    "( the same definition works for full - rank sub - lattices of @xmath77 . )",
    "the min- and max - genus of a given sub - lattice @xmath57 of @xmath1 of dimension @xmath30 , denoted respectively by @xmath78 and @xmath79 , are defined as follows : @xmath192    there are some other notions of genus associated to a given lattice , e.g. , the notion _ spinor genus _ for lattices developed by eichler ( see @xcite and @xcite ) in the context of integral quadratic forms .",
    "every sub - lattice of @xmath1 provides a quadratic form in a natural way .",
    "but a priori there is no relation between these notions .",
    "it is clear by definition that @xmath193 .",
    "but generally these two numbers could be different .",
    "a sub - lattice @xmath194 of dimension @xmath30 is called _ uniform _ if @xmath195 . the genus of a uniform sub - lattice is @xmath196 .    as we will show later in section",
    "[ sec : examples ] , sub - lattices generated by laplacian of graphs are uniform .",
    "in this section , we present the proofs of theorem  [ dom_thm ] and theorem  [ cdom_thm ] .",
    "this section is quite independent of the rest of this paper and can be skipped in the first reading .",
    "recall that @xmath150 is the set of points in @xmath154 that are not dominated by any point in @xmath57 and @xmath153 is the topological closure of @xmath150 in @xmath154 . also , recall that @xmath158 denotes the set of extremal points of @xmath153 .",
    "these are the set of points which are local minima of the degree function . as we said before , instead of working with the sigma - region directly , we initially work with @xmath166 . we first prove theorem  [ cdom_thm ] .",
    "namely , we prove @xmath197 . to prepare for the proof of this theorem",
    ", we need a series of lemmas .",
    "the following lemma provides a description of @xmath166 in terms of the domination order in @xmath49 .",
    "recall that for two points @xmath198 and @xmath199 , @xmath200 ( resp .",
    "@xmath201 ) if @xmath202 ( resp .",
    "@xmath203 ) for all @xmath204 .",
    "[ sigc ] @xmath205    easy and omitted .",
    "extremal points of @xmath166 are contained in @xmath206 .",
    "easy and omitted .",
    "let @xmath96 be a point in @xmath166 and let @xmath207 be a vector in @xmath154 .",
    "we say that @xmath207 is _ feasible _ for @xmath96 , if it satisfies the following properties : + 1 .",
    "there exists a @xmath209 such that for every @xmath210 , @xmath211 . by lemma  [ sigc",
    "] , this means that @xmath212 for all lattice points @xmath213 .",
    "+ furthermore , we define the function @xmath214 as follows : @xmath215 let @xmath216 we have the following explicit description of @xmath217 .",
    "@xmath218    one can easily verify that    [ rel_lem ] for a point @xmath96 in @xmath153 , @xmath219 for all @xmath220 in the only cases when the inequality is strict , we must have @xmath221 and @xmath222 .",
    "we now prove the following lemma which links the function @xmath223 to the feasibility of @xmath207 at @xmath96 .",
    "[ feas_lem ] for a point @xmath96 in @xmath166 and @xmath207 in @xmath154 with @xmath208 , @xmath207 is not feasible for @xmath96 if and only if @xmath224 for some @xmath225 .",
    "let @xmath96 be a point of @xmath166 .",
    "( @xmath226 ) .",
    "assume the contrary , then we should have the following properties :    1 .",
    "[ deg_prop1 ] @xmath227 2 .",
    "[ zero_prop1 ] @xmath228 for all @xmath229    we claim that @xmath230 for some @xmath231 by the definition of @xmath217 , if @xmath232 , then @xmath233 is at least @xmath234 , where @xmath235 is the rational part of @xmath236 if @xmath236 is not integral , and is @xmath42 if @xmath236 is integral . as the number of indices is finite ,",
    "we conclude that @xmath237 and the claim holds .",
    "it follows that @xmath238 for all @xmath132 in @xmath57 and for all @xmath239 .",
    "this implies that @xmath207 is feasible for @xmath96 .",
    "( @xmath240 ) .",
    "if @xmath224 for some @xmath225 , then there exists a @xmath241 such that @xmath242 for every @xmath243 .",
    "this shows that @xmath207 is not feasible for @xmath96 .",
    "[ ext_cor ] for a point @xmath96 in @xmath166 , @xmath96 is an extremal point if and only if for every vector @xmath244 with @xmath208 , we have @xmath224 for some @xmath132 in @xmath57 .    combining lemma  [ rel_lem ] and corollary  [ ext_cor ] , we obtain the following result :    [ dom_lem ] if @xmath96 is not an extremal point of @xmath166 , then there exists a vector @xmath207 in @xmath245 which is feasible for @xmath96 .",
    "if @xmath96 is not an extremal point of @xmath166 , then there exists a vector @xmath246 in @xmath154 that is feasible for @xmath96 . by corollary [ ext_cor ] , @xmath246 has the following properties :    1 .",
    "[ deg_prop2 ] @xmath247 2 .",
    "[ zero_prop2 ] @xmath248 for all @xmath249    let @xmath250 .",
    "we have @xmath208 , since @xmath251 and @xmath252 . by lemma [ rel_lem ] , we have @xmath253 for all @xmath225 , and in the only cases for @xmath132 when the inequality is strict we have @xmath254 .",
    "we infer that @xmath207 also satisfies properties [ deg_prop2 ] and [ zero_prop2 ] . by corollary  [ ext_cor ] , @xmath207 is also feasible for @xmath96 and by construction , @xmath207 belongs to @xmath245 ; the lemma follows .",
    "consider the set @xmath255 the next lemma shows that the degree function is bounded below on the elements of @xmath166 ( by some negative real number ) .",
    "[ sup_lem ] for an @xmath256dimensional sub - lattice @xmath57 of @xmath1 , @xmath257 is finite .    it is possible to give a direct proof of this lemma . but using our results in section  [ sec : voronoi ] allows us to shorten the proof .",
    "so we postpone the proof to section  [ sec : voronoi ] .",
    "we are now in a position to present the proofs of theorem  [ cdom_thm ] and theorem  [ dom_thm ] .",
    "consider a point @xmath96 in @xmath153 .",
    "we should prove the existence of an extremal point @xmath258 such that @xmath259 .",
    "consider the cone @xmath119 . as a consequence of lemma  [ sup_lem ]",
    ", we infer that the region @xmath260 is a bounded closed subspace of @xmath49 , and so it is compact .",
    "the degree function @xmath261 restricted to this compact set , achieves its minimum on some point @xmath262 .",
    "we claim that @xmath258 .",
    "suppose that this is not the case . by lemma  [ dom_lem ]",
    ", there exists a feasible vector @xmath263 for @xmath180 , i.e. , such that @xmath264 for all sufficiently small @xmath265 .",
    "now it is easy to check that    * @xmath266 and hence @xmath267 * @xmath268 .",
    "this contradicts the choice of @xmath180 .    in order to establish theorem  [ dom_thm ] , we first prove that every point in @xmath158 is an integral point . for",
    "the sake of a contradiction , suppose that there exists a non integral point in @xmath158 .",
    "let @xmath269 be such a point and suppose without loss of generality that @xmath270 is not integer .",
    "we claim that the vector @xmath271 is feasible .",
    "indeed it is easy to check that @xmath272 for all @xmath225 , and so by corollary  [ ext_cor ] we conclude that @xmath96 could not be an extremal point of @xmath166 .",
    "let @xmath273 be the set of integral points of @xmath166 .",
    "we show that @xmath274 .",
    "note that as soon as this is proved , theorem  [ cdom_thm ] and the fact that extremal points of @xmath166 are all integral points implies theorem  [ dom_thm ] .",
    "we prove @xmath275. let @xmath276 , for a point @xmath277 .",
    "to show @xmath278 we should prove that @xmath279 .",
    "suppose that this is not the case and let @xmath225 be such that @xmath280 .",
    "it follows that @xmath281 and hence , @xmath282 , which is a contradiction .",
    "we prove @xmath283. a point @xmath7 in @xmath284 is contained in @xmath285 for some @xmath132 in @xmath57 and hence @xmath280 .",
    "we infer that @xmath121 is contained in the interior of @xmath166 , and so for each point @xmath96 of @xmath121 , every vector in @xmath49 of negative degree will be feasible . by lemma  [ sup_lem ] ,",
    "there exists a point @xmath286 such that @xmath287 for some @xmath288 .",
    "it follows that @xmath289 . by theorem [ cdom_thm ] , @xmath290 for some @xmath180 in @xmath158",
    "this implies that @xmath291 for some @xmath292 . by definition",
    ", @xmath96 is an integral point and we just showed that @xmath180 is also an integral point .",
    "hence we can further deduce that @xmath293 .",
    "we infer that @xmath294 and therefore , @xmath295 ( because @xmath296 ) .",
    "it follows that @xmath297 .",
    "the proof of theorem  [ dom_thm ] is now complete .",
    "in this section , we provide some basic properties of the voronoi diagram of a sub - lattice @xmath57 of @xmath1 under a simplicial distance function @xmath298 which we define below .",
    "the distance function @xmath298 has the following explicit form , and as we will see in this section , is the distance function having the homotheties of the standard simplex in @xmath77 as its balls ( which explains the name simplicial distance function ) . for two points @xmath96 and @xmath132 in @xmath77 ,",
    "the simplicial distance between @xmath96 and @xmath132 is defined as follows @xmath299 the basic properties of @xmath300 are better explained in the more general context of polyhedral distance functions that we now explain .",
    "let @xmath41 be a convex polytope in @xmath301 with the reference point @xmath302 in its interior .",
    "the _ polyhedral distance function _",
    "@xmath303 between the points of @xmath301 is defined as follows : @xmath304 @xmath305 is not generally symmetric , indeed it is easy to check that @xmath303 is symmetric if and only if the polyhedron @xmath41 is centrally symmetric i.e. , @xmath306",
    ". nevertheless @xmath307 satisfies the triangle inequality .",
    "[ lin_lem ] for every three points @xmath308 , we have @xmath309 . in addition , if @xmath132 is a convex combination of @xmath96 and @xmath13 , then @xmath310 .    to prove the triangle inequality , it will be sufficient to show that if @xmath311 and @xmath312 , then @xmath313 . we write @xmath314 and @xmath315 for two points @xmath316 and @xmath317 in @xmath41 .",
    "we can then write @xmath318 . @xmath41 being convex and @xmath319 , we infer that @xmath320 , and so @xmath313 .",
    "the triangle inequality follows .    to prove the second part of the lemma ,",
    "let @xmath321 $ ] be such that @xmath322 by the triangle inequality , it will be enough to prove that @xmath323 .",
    "let @xmath324 so that @xmath325 for some point @xmath317 in @xmath41 .",
    "we infer first that @xmath326 , which implies that @xmath327 .",
    "similarly we have @xmath328 .",
    "it follows that @xmath329 and so @xmath330 we conclude that @xmath323 , and the lemma follows .",
    "we also observe that the polyhedral metric @xmath303 is translation invariant , i.e. ,    [ lem : trans - inv ] for any two points @xmath331 in @xmath301 , and for any vector @xmath332 , we have @xmath333 .",
    "in particular , @xmath334 .",
    "the proof is easy : if @xmath311 , then @xmath335 , and vice versa .",
    "the notion of a polyhedral distance function is essentially the concept of a gauge function of a convex body that has been studied in @xcite .",
    "lemmas [ lin_lem ] and [ lem : trans - inv ] can be derived in a straight forward way from the results in @xcite .",
    "for the sake of easy reference , we included them here .",
    "consider a discrete subset @xmath336 in @xmath337 .",
    "for a point @xmath74 in @xmath336 , we define the _ voronoi cell _ of @xmath74 with respect to @xmath338 as @xmath339    the _ voronoi diagram _",
    "@xmath340 is the decomposition of @xmath151 induced by the cells @xmath341 , for @xmath342 we note however that this need not be a cell decomposition in the usual sense .",
    "we state the following lemma on the shape of cells @xmath343 .",
    "[ lem : star]@xcite let @xmath336 be a discrete subset of @xmath301 and @xmath340 be the voronoi cell decomposition of @xmath301 .",
    "for any point @xmath74 in @xmath336 , the voronoi cell @xmath343 is a star - shaped polyhedron with @xmath74 as a kernel .",
    "it is easy to see that @xmath343 is a polyhedron .",
    "we show that it is star - shaped .",
    "assume the contrary .",
    "then there is a line segment @xmath344 $ ] and a point @xmath132 between @xmath74 and @xmath13 such that @xmath345 and @xmath346 .",
    "suppose that @xmath132 is contained in @xmath347 for some @xmath348 .",
    "we should then have @xmath349 . by lemma  [ lin_lem ] , @xmath350 .",
    "we infer that @xmath351      voronoi diagrams of root lattices under the euclidean metric have been studied previously in literature .",
    "conway and sloane @xcite , describe the voronoi cell structure of root lattices and their duals under the euclidean metric .    here",
    "we study voronoi diagrams of sub - lattices of @xmath1 under polyhedral distance functions ( and later under the simplicial distance functions @xmath298 ) .",
    "we will see the importance of this study in the proof of riemann - roch theorem in section  [ sec : r - r - theo ] , and in the geometric study of the laplacian of graphs in section  [ sec : examples ] .",
    "let @xmath57 be a sub - lattice of @xmath1 of full rank .",
    "note that @xmath57 is a discrete subset of the hyperplane @xmath77 and @xmath352 .",
    "let @xmath353 be a convex polytope of dimension @xmath30 in @xmath77 .",
    "we will be interested in the voronoi cell decomposition of the hyperplane @xmath77 under the distance function @xmath303 induced by the points of @xmath57 .",
    "the following lemma , which essentially uses the translation - invariance of @xmath303 , shows that these cells are all simply translations of each other .",
    "[ trans_lem ] for a point @xmath96 in @xmath354 as a consequence , @xmath355 .",
    "easy and omitted .    by lemma  [ trans_lem ] ,",
    "to understand the voronoi cell decomposition of @xmath77 , it will be enough to understand the cell @xmath356 .",
    "we already know that @xmath357 is a star - shaped polyhedron .",
    "the following lemma shows that @xmath357 is compact , and so it is a ( non - necessarily convex ) star - shaped polytope .",
    "[ compact_lem ]",
    "the voronoi cell @xmath356 is compact .",
    "the proof is standard",
    ". it will be sufficient to prove that @xmath357 does not contain any infinite ray .",
    "indeed , @xmath357 being star - shaped and closed , this will imply that @xmath357 is bounded and so we have the compactness .",
    "assume , for the sake of a contradiction , that there exists a vector @xmath358 in @xmath77 such that the ray @xmath359 for @xmath360 is contained in @xmath356 .",
    "this means that @xmath361 choose a real number @xmath362 such that @xmath363 . by lemma  [ lin_lem ] , @xmath364 for @xmath288 . by the definition of @xmath305 , the choice of @xmath362 and property  ( [ keypro ] )",
    ", the polytope @xmath365 does not contain any point @xmath366 for @xmath288 .",
    "let @xmath367 .",
    "it is easy to check that @xmath10 is the cone generated by @xmath368 .",
    "it follows that @xmath369 does not contain any lattice point apart from @xmath370 ( for @xmath371 ) .",
    "in addition , @xmath41 being a polytope of dimension @xmath30 , @xmath10 should be a cone of full dimension in @xmath77 .",
    "but this will provide a contradiction , because as we will show below for any vector @xmath372 with rational coordinates in @xmath77 , the open ray @xmath373 for @xmath374 contains a lattice point in @xmath57 .",
    "( and it is clear that any cone @xmath10 of full dimension in @xmath77 contains a rational vector . ) to see this , observe that a basis for @xmath57 is also a basis for the @xmath30-dimensional @xmath375-vector space @xmath376 . here",
    "@xmath376 denotes the rational points of the hyperplane @xmath77 .",
    "this means that @xmath372 can be written as a rational combination of some points in @xmath57 .",
    "multiplying by a sufficiently large integer number @xmath377 , @xmath378 can be written as an integral combination of the same points in @xmath57 , i.e. , @xmath379 , and this finishes the proof of the lemma .    from now on",
    ", we will restrict ourselves to two special polytopes @xmath380 and @xmath381 in @xmath77 .",
    "they are both standard simplices of @xmath77 under an appropriate isometry @xmath382 .",
    "the @xmath30-dimensional regular simplex @xmath383 centred at the origin @xmath370 has vertices at the points @xmath384 . for all @xmath385 , the coordinates of @xmath386",
    "are given by :    @xmath387    the simplex @xmath388 is the _ opposite _ simplex to @xmath383 , i.e. , @xmath389 .",
    "the simplicial distance functions @xmath390 and @xmath391 are the distance functions in @xmath49 defined by @xmath380 and @xmath381 respectively .",
    "it is easy to check the following anti - symmetric property for the above distance functions : _ for any pair of points @xmath392 , we have @xmath393 . _",
    "( this is indeed true for any convex polytope @xmath41 : @xmath394 , where @xmath395 . )",
    "[ [ notation . ] ] notation .",
    "+ + + + + + + + +    in the following we will use the following terminology : for a point @xmath396 , we let @xmath397 and @xmath398 .",
    "more generally given a real @xmath399 and @xmath396 , we define @xmath400 , and similarly , @xmath401 .",
    "we can think of these as _ balls of radius _ @xmath362 around @xmath5 for @xmath300 and @xmath402 respectively",
    ".     has three vertices and @xmath403 edges .",
    "the lattice @xmath86 is generated by the two vectors @xmath404 and @xmath405 .",
    "the corresponding laplacian sub - lattice of @xmath86 , whose elements are denoted by @xmath406 , is generated by the vectors @xmath407 and @xmath408 ( and @xmath409 ) , which correspond to the vertices of @xmath0.,title=\"fig : \" ]   has three vertices and @xmath403 edges . the lattice @xmath86 is generated by the two vectors @xmath404 and @xmath405 .",
    "the corresponding laplacian sub - lattice of @xmath86 , whose elements are denoted by @xmath406 , is generated by the vectors @xmath407 and @xmath408 ( and @xmath409 ) , which correspond to the vertices of @xmath0.,title=\"fig : \" ]    the following lemma shows that the definition given in the beginning of this section coincides with the definition of @xmath300 given above .",
    "we can explicitly write a formula for @xmath390 and @xmath391 in the hyperplane @xmath77 :    [ d_form ] for two points @xmath410 and @xmath411 in @xmath77 , the @xmath380-simplicial distance from @xmath96 to @xmath132 is given by @xmath412 and the @xmath381-simplicial distance from @xmath96 to @xmath132 is given by @xmath413 here the sum @xmath414 denotes the tropical sum of the numbers @xmath415 .    by the anti - symmetry property of the distance function @xmath298 ( namely @xmath416 ) , we only need to prove the lemma for @xmath298 . by definition , @xmath417 is the smallest positive real @xmath362 such that @xmath418 .",
    "the simplex @xmath380 being the convex hull of the vectors @xmath386 defined above , it follows that for an element @xmath419 , there should exist non - negative reals @xmath420 such that @xmath421 and @xmath422 . from the definition of the vector @xmath386 s",
    ", we obtain @xmath423 .",
    "it follows that @xmath424 is the smallest @xmath362 such that @xmath425 becomes equal to @xmath426 for some @xmath420 such that @xmath427 .",
    "let @xmath428 be the smallest positive real number such that the vector @xmath429 has non - negative coordinates .",
    "as @xmath430 , a simple calculation shows that the other condition @xmath431 holds automatically , and hence such @xmath428 is equal to @xmath424 .",
    "it is now easy to see that @xmath432 .",
    "it follows that @xmath433      for a discrete subset @xmath336 of @xmath77 ( e.g. , @xmath435 ) , the simplicial distance function @xmath436 is defined as follows : @xmath437 by definition , it is straightforward to verify that @xmath438 .",
    "note that our definition above exactly imitates the classical definition of a distance function  @xcite . in what follows",
    ", we restrict ourselves to @xmath435 .",
    "let @xmath57 be a full - rank sub - lattice of @xmath1 and @xmath439 be the distance function defined by @xmath57 .",
    "we first give a description of @xmath284 ( see section  [ sec : extremal ] ) in terms of @xmath439 .",
    "the _ lower - graph _ of @xmath439 is the graph of the function @xmath439 in the negative half - space of @xmath49 , i.e. , in the half - space of @xmath49 consisting of points of negative degree .",
    "more precisely , the _ lower - graph _ of @xmath439 , denoted by @xmath440 , consists of all the points @xmath441 for @xmath442 .",
    "( in the example given in figure  [ defvor ] , these are all the vertices of the polygon drawn in the plane @xmath443 ( the right figure ) having one concave and one convex neighbours on the polygon .",
    "there are six of them . )",
    "we have    [ lem : lower - graph ] the lower - graph of @xmath439 and @xmath284 coincide , i.e. , @xmath444 .    in order to present the proof of lemma  [ lem : lower - graph ] ,",
    "we need to make some remarks .",
    "let @xmath96 be a point of @xmath57 .",
    "the function @xmath445 is defined as follows : @xmath446 note that @xmath447 is defined with respect to the ordering of @xmath49 , and is well - defined because @xmath448 if and only if @xmath449 . remark also that @xmath450 is finite .    the above notion has the following tropical meaning : let @xmath451 .",
    "then @xmath452 .",
    "the numbers @xmath453 are used in  @xcite to define the tropical closest point projection into some tropical polytopes . for a finite set of points @xmath454 with the tropical convex - hull polytope @xmath41 , the tropical projection map @xmath455 at the point @xmath456 is defined as @xmath457 it would be interesting to explore the connection between the work presented here and the theory of tropical polytopes .",
    "a simple calculation shows that @xmath458 , and hence by lemma  [ d_form ] , we obtain @xmath459 . in other words , @xmath450 is the lower - graph of the function @xmath460 .",
    "we claim that for all @xmath461 here , @xmath447 is understood as before with respect to the ordering of @xmath49 . in other words ,",
    "the lower - graph @xmath440 is the lower envelope of the graphs @xmath462 for @xmath366 . to see this , remark that @xmath463 .",
    "it is easy to see that for every point @xmath442 , the intersection of the half - ray @xmath464 with @xmath465 is the point @xmath466 .",
    "this gives the lemma .",
    "more precisely , by the definition of @xmath166 ( see section  [ sec : extremal ] ) , we have @xmath467    it is possible to strengthen lemma  [ lem : lower - graph ] and to obtain a description of the voronoi diagram @xmath468 in terms of the boundary of the sigma - region .",
    "the following lemma can be seen as the simplicial voronoi diagram analogue of the classical result that _ the voronoi diagram under the euclidean metric is the projection of a lower envelope of paraboloids @xcite . _    [ lowenv_lem ] the voronoi diagram of @xmath57 under the simplicial distance function @xmath298 is the projection of @xmath469 along @xmath470 onto the hyperplane @xmath77 .",
    "more precisely , for any @xmath120 , the voronoi cell @xmath471 is obtained as the image of @xmath472 under the projection map @xmath103 .    by definition ,",
    "@xmath473 consists of the points which are dominated by @xmath96 .",
    "it follows that the intersection @xmath472 consists of all the points of @xmath284 which are dominated by @xmath96 . by lemma  [ lem : lower - graph ] ,",
    "the boundary of @xmath166 , @xmath284 coincides with the graph of the simplicial distance function @xmath439 .",
    "it follows that the intersection @xmath472 consists of all the points of the lower - graph of @xmath439 that are dominated by @xmath96 . by definition ,",
    "any point of the lower - graph of @xmath439 is of the form @xmath474 for some @xmath442 . by definition of the function @xmath475 ,",
    "such a point is dominated by @xmath96",
    "if and only if @xmath476 . by definition , we know that @xmath477 for all @xmath442 . we infer that for @xmath442 , @xmath478 if and only if @xmath479 , or equivalently , if and only if @xmath480 .",
    "we conclude that @xmath481 and the lemma follows .    as we show in the next two lemmas ,",
    "it is possible to describe voronoi _ vertices _ that are local maxima of @xmath439 as the projection of the extremal points of the sigma - region onto the hyperplane @xmath77 ( see below , lemma  [ ver_cor ] , for a precise statement ) .",
    "let us denote by @xmath482 the set of all local maxima of @xmath483 .",
    "we have    [ crit_lem ] the critical points of @xmath57 are the projection of the extremal points of @xmath166 along the vector @xmath470 . in other words , @xmath484 .",
    "let @xmath485 be a point in @xmath482 , and let @xmath486 , be the corresponding point of the lower - graph of @xmath439 , @xmath487 by lemma  [ lem : lower - graph ] ) .",
    "note that @xmath488 .",
    "we claim that @xmath489 .",
    "assume the contrary .",
    "then there should exist an infinite sequence @xmath490 such that @xmath491 , @xmath492 , and @xmath493 .",
    "by @xmath494 and lemma  [ lem : lower - graph ] , we can write @xmath495 for some @xmath496 . by @xmath497 , we should have @xmath498 for every @xmath499 , and so @xmath500 .",
    "by @xmath501 , we have @xmath502 . all together",
    ", we have obtained an infinite sequence of points @xmath503 in @xmath77 such that @xmath504 and @xmath502 .",
    "this is a contradiction to our assumption that @xmath505 is a local maximum of @xmath439 .",
    "a similar argument shows that for every point @xmath506 , @xmath507 is in @xmath482 , and the lemma follows .    by proposition  [ prop : twosigmas ] , we have @xmath508 , and so    [ cor : crit ] we have @xmath509 .    the following lemma gives a precise meaning to our claim that the critical points are the voronoi vertices of the voronoi diagram , and will be used in section  [ sec : examples ] in the proof of theorem  [ thm : main - laplacian ] ( also used to drive theorem  [ theo : crit - n ! ] ) .",
    "[ ver_cor ] each @xmath510 is a vertex of the voronoi diagram @xmath511 : there exist @xmath22 different points @xmath512 in @xmath57 such that @xmath513 .",
    "more precisely , a point @xmath396 is critical , i.e. , @xmath510 , if and only if it satisfies the following property : for each of the @xmath22 facets @xmath514 of @xmath515 , there exists a point @xmath516 such that @xmath517 and @xmath236 is not in any of @xmath518 for @xmath519 .",
    "remark that this shows that every point in @xmath482 is a vertex of the voronoi diagram @xmath520 .",
    "we first prove that for every @xmath521 , there exist @xmath522 different points @xmath523 , such that the corresponding voronoi cells @xmath524 shares @xmath5 , i.e. , such that @xmath525 for @xmath526 . by lemma  [ crit_lem ] , we know that there exists a point @xmath527 such that @xmath528 .",
    "we will prove the following : there exist @xmath522 different points @xmath523 such that @xmath529 for all @xmath526 .",
    "once this has been proved , we will be done . indeed by lemma  [ lowenv_lem ] , we know that that every voronoi cell @xmath471 , for @xmath366 , is of the form @xmath530 .",
    "so @xmath531 for each point @xmath236 , and this is exactly what we wanted to prove .    to prove the second part , it will be enough to show that the points @xmath236 have the desired property .",
    "remark that we have @xmath532 , so @xmath533 for all @xmath499 . by the choice of @xmath236",
    ", we have @xmath534 for all @xmath519 and @xmath535 .",
    "since @xmath536 , it is now easy to see that @xmath236 is in the facet @xmath514 of @xmath515 defined by @xmath537 ( remark that @xmath538 so this is a facet of @xmath515 . ) and @xmath236 is not in any of the other facets @xmath518 ( since @xmath539 for @xmath519 ) .",
    "so the proof of one direction is now complete . to prove the other direction ,",
    "let @xmath5 be a point such that each of the @xmath22 facets @xmath514 of @xmath515 has a point @xmath516 and @xmath236 is not in any of the other facets @xmath518 for @xmath519 .",
    "we show that @xmath5 is critical , i.e. , @xmath5 is a local maxima of @xmath439",
    ". it will be enough to show that for any non - zero vector @xmath540 of sufficiently small norm , there exists one of the points @xmath236 such that @xmath541 . for all @xmath542 , by the characterisation of the facet @xmath518 ( see above ) and by @xmath543 for all @xmath544 , we have @xmath545 if all @xmath546 s are sufficiently small ( namely if for all @xmath98 , @xmath547 where @xmath548 is chosen so that @xmath549 $ ] ) . as @xmath550 and @xmath551 , there exists @xmath499 such that @xmath552 .",
    "it follows that @xmath553 . and",
    "this shows that @xmath5 is a local maximum of @xmath439 .",
    "the proof of the lemma is now complete .",
    "we end this section by providing the promised short proof of lemma  [ sup_lem ] , which claims that the degree function is bounded below in the region @xmath166 .    in section  [ sec : criticalvertices ] we obtained the following explicit formula for @xmath450 : @xmath554 we infer that @xmath555    by lemma [ lem : lower - graph ] , we have @xmath556 .",
    "it follows from equation  [ eq : vp ] that @xmath557    we now observe that : @xmath558 this shows that @xmath559 depends only on the simplicial distance @xmath300 between @xmath456 and @xmath96 . by translation invariance of the simplicial distance function ( lemma  [ lem : trans - inv ] ) , translation invariance of the voronoi cells ( lemma  [ trans_lem ] ) , and the above observations , we obtain @xmath560    by lemma [ compact_lem ] , we know that @xmath561 is compact .",
    "also the function @xmath562 is continuous on @xmath456 .",
    "hence @xmath563 is finite and the lemma follows .",
    "consider a full dimensional sub - lattice @xmath57 of @xmath1 and its voronoi diagram @xmath468 under the simplicial distance function . from the previous sections ,",
    "we know that the points of @xmath482 are vertices of @xmath468 .",
    "we know that @xmath561 is a compact star - shaped polyhedron with @xmath370 as a kernel , and that the other cells are all translations of @xmath564 by points in @xmath57 .",
    "consider now the subset @xmath565 of vertices of @xmath566 which are in @xmath482 .",
    "the sub - lattices of @xmath1 of interest for us should have the following symmetry property :    a sub - lattice @xmath567 is called _ reflection invariant _",
    "if @xmath568 is a translate of @xmath482 , i.e. , if there exists @xmath569 such that @xmath570 .",
    "@xmath57 is called _ strongly reflection invariant _ if the same property holds for @xmath571 , i.e. , if there exists @xmath569 such that @xmath572 .    by translation invariance , it is easy to show that every strongly reflection invariant sub - lattice of @xmath1 is indeed reflection invariant .",
    "also , note that the vector @xmath573 in the definition of reflection invariance lattices above is not uniquely defined : by translation invariance , if @xmath574 is linearly equivalent to @xmath573 , @xmath574 also satisfies the property given in the definition .",
    "[ [ reflection - invariance - and - involution - of - mathrmextl . ] ] reflection invariance and involution of @xmath156 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath57 be reflection invariant and @xmath569 be a point such that @xmath570 .",
    "this means that for any @xmath505 there exists a unique @xmath575 such that @xmath576 . by lemma  [ crit_lem ] and corollary  [ cor : crit ] , for every point @xmath485 in @xmath482",
    ", there exists a point @xmath180 in @xmath156 such that @xmath577 .",
    "thus , for every point @xmath180 in @xmath156 , there exists a point @xmath578 in @xmath156 such that @xmath579 .",
    "this allows to define an involution @xmath580 :    for any point @xmath581 , @xmath582 .",
    "note that @xmath583 is well defined . indeed ,",
    "if there exist two different points @xmath584 and @xmath585 such that @xmath586 for @xmath587 , then @xmath588 and this would imply that @xmath589 or @xmath590 which contradicts the hypothesis that @xmath591 .",
    "a similar argument shows that @xmath583 is a bijection on @xmath156 and is an involution .",
    "in this subsection , we provide the proof of the riemann - roch inequality stated in theorem  [ rrineq_theo ] for reflection invariant sub - lattices of @xmath1 .",
    "we refer to section  [ sec : min - max - genus ] for the definition of @xmath78 and @xmath79 .",
    "let @xmath57 be a reflection invariant sub - lattice of @xmath1 .",
    "we have to show the existence of a canonical point @xmath80 such that for every point @xmath81 , we have @xmath592 @xmath593 is defined up to linear equivalence ( which is manifested in the choice of @xmath573 in the definition of reflection invariance ) .",
    "* construction of a canonical point @xmath593 .",
    "*    we define the canonical point @xmath593 as follows : let @xmath594 be an extremal point such that @xmath595 has the maximum degree , i.e. , @xmath596 .",
    "the map @xmath583 is the involution defined above .",
    "define @xmath597 .",
    "* proof of the riemann - roch inequality .",
    "* we first observe that @xmath593 is well - defined and for any point @xmath180 in @xmath156 , @xmath598 this is true because all the points @xmath599 are on the line @xmath600 , and @xmath593 is chosen in such a way to ensure that @xmath601 has the maximum degree among the points of that line .",
    "we infer that for any point @xmath183 , there exists an effective point @xmath602 such that @xmath603 . using this ,",
    "we first derive an upper bound on the quantity @xmath604 as follows : @xmath605    to obtain inequality ( [ ineq2 ] ) , we use the fact that if @xmath177 then @xmath606 . also remark that inequality ( [ lem_gmax ] ) is a simple consequence of the definition of @xmath79 .",
    "now , we obtain a lower bound on the quantity @xmath604 . in order to do so",
    ", we first obtain an upper bound on the degree of @xmath602 , for the effective point @xmath602 such that @xmath603 .",
    "to do so , we note that by the definition of @xmath593 and by the definition of @xmath78 , we have @xmath607 . also observe that by the definition of @xmath79 , we have @xmath608 .",
    "it follows that @xmath609 we proceed as follows @xmath610 the last inequality follows from the definition of @xmath78 .",
    "now since the map @xmath611 is a bijection from @xmath156 onto itself , we can easily see that @xmath612    by lemma [ rank_lem ] and the fact @xmath583 is a bijection , we know that :    @xmath613 + @xmath614    finally we infer that @xmath615 and the riemann - roch inequality ( [ rrineq_theo ] ) follows .",
    "[ rema : r - r - digraph]as the above proof shows , we indeed obtain a slightly stronger inequality @xmath616 in particular if @xmath617 for all @xmath183 ( see section  [ sec : digraphs ] for examples , e.g. , regular digraphs ) , we have : @xmath618    we remark that the proof technique used above is quite similar to the one used by baker and norine  @xcite .    from lemma [ rank_lem ] ,",
    "it is easy to obtain the inequality @xmath619 , for all sub - lattices @xmath57 of @xmath1 and all @xmath620 .",
    "this inequality is usually referred to as riemann s inequality .",
    "note that the riemann - roch inequality ( [ rie - ro_ineq ] ) is more sensitive on ( and contains more information about ) the extent of `` un - evenness '' of the extremal points , while the above trivial inequality does not provide any such information .",
    "recall that a lattice @xmath57 is called uniform if @xmath621 , i.e. , every point in @xmath156 has the same degree . by corollary  [ cor : crit ] and the definition of @xmath622 ,",
    "this is equivalent to saying that the set of critical values of @xmath439 is a singleton .",
    "we call @xmath623 the _ genus _ of the lattice .",
    "the following is a direct consequence of theorem  [ rrineq_theo ] .",
    "however we give it as a separate theorem .",
    "[ theo : r - r - uniform ] every uniform reflection invariant sub - lattice @xmath567 of dimension @xmath30 has the riemann - roch property .",
    ". if @xmath57 is a reflection invariant lattice , we can apply theorem [ rrineq_theo ] to obtain @xmath624 where @xmath593 is the canonical point defined as in the proof of theorem  [ rrineq_theo ] .",
    "since @xmath57 is uniform we have @xmath625 and we obtain @xmath626 it remains to show that @xmath627 .",
    "but , we know from the construction of @xmath593 that @xmath628 for a point @xmath629 . since @xmath57 is uniform , we infer that @xmath630 ( and also that @xmath631 , @xmath632 ) .",
    "we say that a sub - lattice @xmath57 of @xmath1 has a riemann - roch formula if there exists an integer @xmath23 and an integral point @xmath633 , or simply @xmath593 , of degree @xmath634 ( a canonical point ) such that for every integral point @xmath35 , we have : @xmath635    the following result shows the amount of geometric information one can obtain from the riemann - roch property .",
    "[ theo : r - r - class ] a sub - lattice @xmath57 has a riemann - roch formula if and only if it is uniform and reflection invariant .",
    "moreover , for a uniform and reflection invariant lattice @xmath636 ( the genus of the lattice ) .",
    "the rest of this section is devoted to the proof of this theorem .",
    "one direction is already shown , we prove the other direction .",
    "we first prove that    if @xmath57 has a riemann - roch formula , then @xmath637 .",
    "the riemann - roch formula for a point @xmath35 with @xmath638 implies that @xmath639 . we know",
    "that if @xmath640 then @xmath641",
    ". this for @xmath35 with @xmath642 shows that @xmath643 . by the riemann - roch formula , we have @xmath644 for any @xmath35 with @xmath645 .",
    "let @xmath646 , where @xmath647 is an extremal point of minimal degree .",
    "remark that we have @xmath69 .",
    "this shows that @xmath648 .",
    "and we infer that @xmath649 .",
    "we now prove that    if @xmath57 has a riemann - roch formula , then @xmath57 is uniform and @xmath636 .",
    "let @xmath377 be the set of points of @xmath121 of degree @xmath650 .",
    "we note that every point in @xmath377 is extremal , i.e. , @xmath651 . to prove the uniformity",
    ", we should prove that @xmath652 .",
    "we claim that @xmath653 , and this in turn implies that @xmath654 . indeed ,",
    "if the claim holds , then every extremal point @xmath581 should dominate a point @xmath7 in @xmath377 , and so @xmath655 , meaning that @xmath656 .",
    "to prove the claim , we proceed as follows .",
    "let @xmath123 be a point in @xmath121 .",
    "we know that @xmath657 .",
    "we should prove the existence of a point @xmath180 in @xmath377 such that @xmath658 . by the riemann - roch formula there exists",
    "@xmath177 with @xmath659 and @xmath660 .",
    "the point @xmath661 has degree @xmath650 and so is in @xmath377 .",
    "in addition @xmath662 . and",
    "this is what we wanted to prove .",
    "the proof of the uniformity is now complete .",
    "to finish the proof of the theorem , it remains to show that    [ prop : r - r - inverse ] if a uniform sub - lattice @xmath57 of @xmath1 of full dimension has a riemann - roch formula , then it is reflection invariant .",
    "consider a uniform lattice satisfying the riemann - roch property . by lemma  [ ranksig_lem ] , we know that for a point @xmath180 in @xmath156 , @xmath663 . now ,",
    "if we evaluate the riemann - roch formula for @xmath664 , we get @xmath665 .",
    "hence , we have @xmath666 .",
    "again by lemma  [ ranksig_lem ] , this implies that @xmath667 is a point in @xmath121 . by the riemann - roch property and claim 2 above , @xmath627 .",
    "since @xmath57 is uniform and @xmath668 , we have @xmath669 .",
    "we infer that @xmath670 , and it follows that @xmath667 is an extremal point of @xmath121 .",
    "we now define @xmath671 .",
    "clearly , the map @xmath672 is a bijection from @xmath156 onto itself .",
    "let @xmath673 .",
    "we obtain @xmath674 for all @xmath668 . by corollary  [ cor : crit ]",
    ", we have @xmath675 and hence @xmath676 for every @xmath485 in @xmath482 .",
    "this implies that @xmath677 .",
    "to finish the proof , observe that @xmath678 is a bijection from @xmath482 onto itself , and so we have @xmath570 .",
    "the proof of theorem  [ theo : r - r - class ] is now complete .",
    "in this section we study the machinery we presented in the previous sections through a few classes of examples .",
    "probably the most interesting examples of the sub - lattices of @xmath1 are generated by laplacian of connected multi - graphs ( and more generally directed multi - graphs ) on @xmath22 vertices . in this subsection",
    ", we provide a geometric study of these sub - lattices .",
    "we prove the following result :    [ theo : laplacian - unif+reflect][thm : graphic ] for any connected graph @xmath0 , the sub - lattice @xmath43 of @xmath1 generated by the laplacian of @xmath0 is strongly reflection invariant and uniform .",
    "theorem  [ thm : graphic ] will be a direct consequence of theorem  [ thm : main - laplacian ] below . combining this theorem with theorem  [ rr_theo ] gives the main result of  @xcite .",
    "[ coro : r - r - graph ] for any connected graph @xmath0 on @xmath22 vertices and with @xmath23 edges , the laplacian lattice @xmath43 has the riemann - roch property .",
    "in addition , we have @xmath679 and the canonical point @xmath593 is given by @xmath680 of @xmath44 where @xmath681 s are the degrees of the vertices of @xmath0 .    using reduced devisors , and the results of  @xcite ,",
    "it is probably quite straightforward to obtain a proof of theorem  [ thm : graphic ] .",
    "( this is not surprising since , as we pointed out in the previous section , a lattice with a riemann - roch formula has to be uniform and reflection invariant . ) the proof we will present for theorem  [ thm : graphic ] gives indeed more than what is the content of this theorem .",
    "we give a complete description of the voronoi - diagram and its dual delaunay triangulation .",
    "and we do not use reduced divisors , which is the main tool used in the previous proofs of the riemann - roch theorem . as we will see , the form of the canonical divisor for a given graph ( and the genus ) as defined in  @xcite comes naturally out of this explicit description .",
    "let @xmath0 be a connected graph on @xmath22 vertices @xmath682 and @xmath23 edges .",
    "let @xmath43 , or simply @xmath57 if there is no risk of confusion , be the laplacian sub - lattice of @xmath1 .",
    "we summarise the main properties of the lattice @xmath43 and the matrix @xmath41 , defined in section  [ sec : intro ] .",
    "@xmath43 is an @xmath30-dimensional sub - lattice of @xmath1 with @xmath683 as a basis such that the @xmath684 matrix @xmath41 has @xmath683 as the first @xmath30 rows and @xmath685 as the last row .",
    "in addition , the matrix @xmath686 has the following properties :    * @xmath687 s are integers , @xmath688 for all @xmath689 and @xmath690 . *",
    "@xmath691 ( and is the degree of the @xmath692 vertex ) .",
    "we denote by @xmath160 the basis @xmath683 of @xmath43 .",
    "we first provide a decomposition of @xmath77 into simplices with vertices in @xmath57 such that the vertices of each simplex forms an affine basis of @xmath43 . recall that a subset of lattice points @xmath694 of size @xmath22 is called an affine basis of @xmath57 , if for @xmath695 , the set of vectors @xmath696 , @xmath697 and @xmath698 , forms a basis of @xmath57 . in other words , if the simplex defined by @xmath699 is minimal ( which means it is full - dimensional and has minimum volume among all the ( full - dimensional ) simplices whose vertices lie in @xmath57 ) . the whole decomposition is derived from the symmetries of the affine basis @xmath160 , and describes in a very nice way the voronoi decomposition @xmath700 .",
    "what follows could be considered as an explicit construction of the `` _ delaunay dual _ '' , @xmath701 , of @xmath693 .",
    "we consider the family of total orders on the set @xmath702 .",
    "a total order @xmath703 on @xmath702 gives rise to an element @xmath704 of the symmetric group @xmath705 , defined in such a way that @xmath706 .",
    "it is clear that the set of all total orders on @xmath707 is in bijection with the elements of @xmath705 .",
    "in addition the total orders which have @xmath30 as the maximum element are in bijection with the subgroup @xmath708 consisting of all the permutation which fix @xmath30 , i.e. , @xmath709 . in the following when we talk about a permutation in @xmath710 , we mean a permutation of @xmath705 which fixes @xmath30 . for @xmath711 , we denote by @xmath712 the _ opposite permutation _ to @xmath704 defined as follows : we set @xmath713 and @xmath714 for all @xmath715 . in other words , for all @xmath715 , @xmath716 if and only if @xmath717 , and @xmath718 for all @xmath542 .",
    "let @xmath719 denotes the group of cyclic permutations of @xmath707 , i.e. , @xmath720 where @xmath721 is the element of @xmath705 defined by @xmath722 for @xmath723 and @xmath724 .",
    "it is easy to check that @xmath725    let @xmath703 be a total order such that @xmath711 , i.e. , @xmath726 and @xmath709 .",
    "we first define a set of vectors @xmath727 as follows : @xmath728 in particular , note that @xmath729    [ lem : affine - base ] for any total order @xmath730 with @xmath30 as maximum , or equivalently for any @xmath704 in @xmath731 , the set @xmath732 forms an affine basis of @xmath43 .",
    "it is easy to see that the matrix of @xmath733 in the base @xmath160 is upper triangular with diagonals equal to @xmath42 .",
    "it follows that the set @xmath733 is a basis of @xmath57 . as @xmath734",
    ", it follows that @xmath735 is an affine basis .",
    "we denote by @xmath736 the simplex defined by @xmath735 .",
    "in other words , @xmath737 , the convex - hull of @xmath735 .",
    "consider the fundamental parallelotope @xmath738 defined by the basis @xmath160 of @xmath43 .",
    "note that @xmath738 is the convex - hull of all the vectors @xmath739 for @xmath711 and @xmath740 .",
    "we next show that the set of simplices @xmath741 provides a simplicial decomposition ( i.e. , a triangulation ) of @xmath738 .",
    "but before we need the following simple lemma :    [ freud_lem ] let @xmath742 be the unit hypercube in @xmath301",
    ". for a permutation @xmath711 , let @xmath743 .",
    "the set of simplices @xmath744 is a simplicial decomposition of @xmath745 .",
    "we have    [ simdecomp_lem]let @xmath0 be a connected graph and @xmath746 be the corresponding laplacian lattice .",
    "the set of simplices @xmath747 is a simplicial decomposition of @xmath738 .    since @xmath160 is a basis of the @xmath30 dimensional lattice @xmath43 , which is contained in @xmath77 , it is also a basis of @xmath77 . by definition , @xmath738 is the unit cube with respect to the basis @xmath160 . by lemma [ freud_lem ] ,",
    "the family of simplices @xmath748 is a simplicial decomposition of @xmath738 , where @xmath749 and the vectors are written in the @xmath160-basis .",
    "now recall that the vertices of @xmath750 are given by the points @xmath751 .",
    "recall also that @xmath752 and that @xmath753 .",
    "a simple calculation shows that @xmath750 coincides with the simplex @xmath754 above , and the proof follows .",
    "a combination of this lemma with the simple fact that @xmath755 is a tiling of @xmath77 gives us :    [ simpdecomp_cor ] the set of simplices @xmath756 forms a triangulation of @xmath77 .    in the simplicial decomposition @xmath757 of @xmath77 , consider the set @xmath758 consisting of all the simplices that contain the origin @xmath370 as a vertex .",
    "we have    [ s0_lem ] a simplex is in @xmath758 if and only if it is spanned by @xmath759 for some @xmath704 in @xmath705 .",
    "( remark that we do not assume that @xmath709 . )    by corollary [ simpdecomp_cor ] , we know that every simplex in @xmath758 is of the form : @xmath760 for some @xmath103 in @xmath731 and @xmath132 in @xmath57",
    ". recall that the element @xmath704 of @xmath731 is regarded as an element of @xmath705 , with the property that @xmath709 . since , the vertex set of @xmath761 is @xmath762 , we should have @xmath763 for some @xmath764 .",
    "let @xmath765 be such that @xmath766 .",
    "a straightforward calculation shows that @xmath767 , where @xmath768 and @xmath721 is the cyclic permutation @xmath769 .",
    "the lemma follows because every element @xmath726 can be written uniquely in the form @xmath770 for some @xmath771 ( @xmath772 ) .",
    "remark also that @xmath773 .",
    "our aim now will be to provide a complete description of the set @xmath774 of extremal points of @xmath166 ( and equivalently the set @xmath775 ) in terms of this triangulation .",
    "actually we obtain an explicit description of the set @xmath565 .",
    "before we proceed , let us introduce an extra notation .",
    "let @xmath704 be an element of the permutation group @xmath705 .",
    "we do not suppose anymore that @xmath709 .",
    "we define the point @xmath776 as the tropical sum of the points of @xmath735 , i.e. , @xmath777 ( and recall that @xmath778 . )",
    "we have the following theorem .",
    "[ thm : main - laplacian ]",
    "let @xmath0 be a connected graph and @xmath43 be the laplacian lattice of @xmath0 .",
    "* the set of extremal points of @xmath779 consists of all the points @xmath780 for @xmath726 and @xmath781 , i.e. , @xmath782 as a consequence , we have @xmath783 * we have @xmath784 .",
    "it is quite easy to see that the set @xmath785 has the following properties ( c.f .",
    "theorem  [ theo : laplacian - unif+reflect ] below . )    * * reflection invariance . * for all @xmath726 , @xmath786 where @xmath712 is the opposite permutation to @xmath704 , and @xmath681",
    "denotes the degree of the vertex @xmath37 . since @xmath787",
    ", it follows that @xmath43 is strongly reflection invariant .",
    "more precisely we have @xmath788 ( recall that @xmath103 is the projection function . )",
    "* * uniformity .",
    "* for all @xmath726 , @xmath789 .",
    "in other words , the laplacian lattice @xmath43 is uniform .",
    "the proof of the results of this section will be given in the next subsection .",
    "however , let us quickly show how to calculate @xmath21 and @xmath593 in the above corollary .",
    "the vertices @xmath790 all belong to @xmath791 and have degree @xmath792 .",
    "it follows that the vertices of @xmath793 have all degree @xmath794 , and so by the definition of genus , we obtain @xmath795 .",
    "in particular @xmath21 coincides with the graphical genus of @xmath0 ( which is the number of vertices minus the number of edges plus one ) .",
    "since the points of @xmath796 are of the form @xmath797 , and as we saw in the proofs of theorem  [ rrineq_theo ] and theorem  [ theo : r - r - uniform ] , we have @xmath798 .",
    "it is easy to see that the point @xmath799 has the following explicit form : @xmath800 it follows that @xmath801    and we infer that    [ lem : ex1 ] for every @xmath726 , we have @xmath802 .",
    "second , we calculate the degree of the point @xmath790 .",
    "it is easy to see that @xmath803 where @xmath23 denotes the number of edges of @xmath0 , or equivalently in terms of the matrix @xmath41 , @xmath804 .",
    "it follows that    [ lem : ex2 ] all the points @xmath790 have the same degree .",
    "we now show that @xmath805 for every @xmath726 .",
    "assume for the sake of contradiction that there exists a point @xmath366 such that @xmath806 . by the definition of the laplacian lattice @xmath57 , we know that there are integers @xmath807 such that @xmath808 , and so we can write @xmath809 for some @xmath810 . among the integer numbers @xmath811 ,",
    "consider the set of indices @xmath812 consisting of the indices @xmath499 for which @xmath811 is minimum .",
    "remark that as @xmath96 is certainly non zero ( since there is a coordinate of @xmath790 which is zero , we can not have @xmath813 ) , we can not have @xmath814 . now in the set @xmath812 consider the index @xmath98 which is the minimum in the total order @xmath730 . by construction of @xmath98",
    ", we have @xmath815 for all @xmath816 and @xmath817 for all @xmath818 .",
    "it follows that @xmath819 , the @xmath820th coordinate of @xmath96 , is bounded above by @xmath821    and this contradicts our assumption @xmath806 .",
    "next , we need to show that @xmath822 is a local minimum of the degree function",
    ". we already now that @xmath789 .",
    "we will prove that for every point @xmath823 , we have @xmath824 . by lemma  [ lem : lower - graph ] , it will be enough to prove that @xmath825 for every point @xmath826 . by the definition of the simplicial distance function",
    "@xmath439 , this is equivalent to proving that the simplex @xmath827 contains a lattice point @xmath366 , i.e. , @xmath828    here we use the following trick to reduce the problem to the case when all the entries of @xmath41 are non - zero .",
    "we add a rational number @xmath829 , @xmath830 , to each @xmath831 , @xmath832 , to obtain @xmath833 .",
    "we also define @xmath834 in such a way that @xmath835 .",
    "remark that @xmath836 .",
    "the new matrix @xmath837 is not integral anymore ( but if we want to work with integral lattices , we can multiply every coordinate by a large integer @xmath573 to obtain an integral matrix @xmath838 ) .",
    "if we know that our claim is true for all laplacians with non - zero coordinates , then the function @xmath839 associated to @xmath838 satisfies the property @xmath840    where @xmath841 denotes the lattice generated by the matrix @xmath838 .",
    "let @xmath842 be the ( non necessarily integral ) lattice generated by the matrix @xmath837 .",
    "it is easy to see that @xmath843 .",
    "equation  [ eq : hdelta ] implies then @xmath844 using characterisation of equation  [ eq : latticepoints ] , one can see that , varying @xmath845 , the above property for all sufficiently small rational @xmath846 will imply that @xmath847 , and that is what we wanted to prove .",
    "indeed one can easily show that the distance function @xmath848 is a continuous function in @xmath845 and @xmath96 .",
    "so at present , we have shown that we can assume that all the @xmath687 s are strictly positive .",
    "this is the assumption we will make for a while . in this case , using the explicit calculation of @xmath790 , we can quite easily show that    [ vprop_lem ] the point @xmath822 has the following properties : + 1 .",
    "@xmath849 for @xmath850 .",
    "@xmath851 for @xmath852 and @xmath853 .    as a corollary",
    "we obtain :    [ orth_cor ] let @xmath854 be the standard orthonormal basis of @xmath151 , i.e. , @xmath855 @xmath856 @xmath857 .",
    "let @xmath858 be a fixed vector . for every @xmath265 , @xmath859 .",
    "[ wdom_lem ] for every non - zero vector @xmath860 in @xmath861 and for every @xmath265 , there exists a point @xmath96 in @xmath57 such that @xmath862",
    ".    follows easily from the above discussion .",
    "it follows now easily that    [ cor : critical ] the point @xmath822 is an extremal point of @xmath153",
    ".    follows by combining lemmas [ wdom_lem ] and [ dom_lem ] .",
    "we will now prove the following : _ every extremal point of @xmath153 can be written as the tropical sum of the vertices of a simplex of the form @xmath863 , for some @xmath864 and some @xmath132 in @xmath57 .",
    "_ again we will first assume a stronger condition that @xmath865 for all @xmath866 such that @xmath852 and @xmath867 .",
    "and then we do a limiting argument similar to the one we did above to obtain the general statement .",
    "let @xmath868 a fixed permutation . using the assumption @xmath865 for @xmath852 , it is easy to show that    [ abs_lem][ord_lem ] for any total ordering @xmath730 , @xmath726 , we have @xmath869 for all @xmath853 and @xmath870 . ( remark that @xmath734 . )",
    "here @xmath871 is the @xmath872th coordinate of the vector @xmath739 .",
    "in addition , if @xmath873 ( resp .",
    "@xmath874 ) , then @xmath875 ( resp .",
    "@xmath876 ) .",
    "as we saw in lemma  [ s0_lem ] , the set of simplices @xmath877 , @xmath878 , coincides with @xmath758 , the set of all simplices of the triangulation which are adjacent to @xmath370 .",
    "the simplices of @xmath758 naturally define a fan @xmath879 , the maximal elements of which are the set of all cones @xmath880 generated by @xmath877 for @xmath878 .",
    "in other words if @xmath735 denoted the affine basis @xmath881 , the cone @xmath880 is the cone generated by @xmath735 . in particular every element of @xmath77 is in some @xmath880 for some @xmath878 .",
    "we have    [ neighdom_lem ] let @xmath132 be a point in @xmath57 , and @xmath882 for all @xmath726 and @xmath883 .",
    "let @xmath880 be a cone in @xmath879 which contains @xmath132 .",
    "there exists a vector @xmath739 in @xmath735 such that @xmath884 for every point @xmath96 in @xmath885 .",
    "in particular , no point in @xmath885 is contained in @xmath166 .",
    "since @xmath132 is a point in @xmath886 , there exists non - negative integers @xmath887 , @xmath888 , such that we can write @xmath889 .",
    "in addition , since @xmath890 , we have @xmath891 .",
    "let @xmath892 , i.e. , the minimum index such that @xmath893 , and let @xmath894 we show that the point @xmath895 satisfies the condition of the lemma . for this , it will be enough to prove that @xmath896 .",
    "indeed @xmath897 implies that @xmath898 , and so if @xmath896 , then we have @xmath899 , which is the required claim",
    ".    we should prove that @xmath900 for all @xmath98 .",
    "as @xmath901 , by lemma [ abs_lem ] we know that @xmath902 for all @xmath98 .",
    "there are two cases : if @xmath903 , then easily we have @xmath904 .",
    "if @xmath905 , then by lemma [ ord_lem ] , we have @xmath906 for all @xmath907 . by the choice of @xmath499 , we have @xmath908 for all @xmath909 .",
    "we infer that @xmath910 , and the lemma follows .",
    "we obtain the following corollary : _ the simplices of our simplicial decomposition form the dual of the voronoi diagram_. more precisely    [ cor : vor - ex ] let @xmath132 be a point in @xmath57 that is not a vertex of a simplex in @xmath758 , i.e. , @xmath882 for all @xmath726 and @xmath883",
    ". then @xmath911 . hence , for every two points @xmath96 and @xmath132 in @xmath57",
    ", we have @xmath912 if and only if @xmath96 and @xmath132 are adjacent in the simplicial decomposition of @xmath77 defined by @xmath913 i.e. , @xmath912 if and only if there exists @xmath726 such that @xmath132 is a vertex of @xmath914 .",
    "we prove the first statement by contradiction .",
    "so for the sake of a contradiction , assume the contrary and let @xmath915 . by definition , we have @xmath916 for all points @xmath917 . by lemma [ lowenv_lem ] this implies that the point @xmath918 is a point in @xmath465 ( c.f . section  [ sec : voronoi ] for the definition of @xmath475 ) . by the definition of @xmath919 ,",
    "the point @xmath456 is in @xmath885 . on the other hand , lemma [ neighdom_lem ]",
    "implies that no point in @xmath920 can be contained in @xmath153 .",
    "we obtain a contradiction . to see the second part , by translation invariance we can assume @xmath921 . and",
    "in this case , the results follows by observing that for @xmath922 , @xmath923 .",
    "we can now present the proof of theorem  [ thm : main - laplacian ] in the case where all the @xmath687 s are strictly positive",
    ". it will be enough to prove that @xmath924 . as @xmath925 and we showed that @xmath926 is in @xmath158",
    ", we have @xmath927 .",
    "we show now @xmath928 .",
    "let @xmath929 and @xmath159 be the point in @xmath158 with @xmath528 . by lemma  [ ver_cor ] , there exist points @xmath930 such that @xmath931 . by corollary  [ cor : vor - ex ] ,",
    "points @xmath512 should be adjacent in the simplicial decomposition of @xmath77 defined by @xmath913 . as @xmath5 is also in @xmath932 , it follows that one of the @xmath236 is @xmath370 , and so there exists @xmath878 such that @xmath933 . by the proof of lemma  [ ver_cor ]",
    ", we also have @xmath934 .",
    "but @xmath935 . it follows that @xmath936 .",
    "we infer that @xmath937 and the theorem follows .",
    "the proof of theorem  [ theo : laplacian - unif+reflect ] is a simple consequence of lemma  [ lem : ex1 ] , and what we just proved , namely , @xmath938 and @xmath924 .",
    "to prove the general case , it will be enough to show that @xmath924 still holds .",
    "indeed the rest of the arguments remain unchanged .",
    "we consider again the @xmath845-perturbed laplacian @xmath939 and do a limiting argument similar to the one we did before .",
    "let @xmath940 to be the lattice generated by @xmath939 .",
    "by @xmath941 and @xmath942 , we denote the voronoi diagram of @xmath940 under the distance function @xmath300 and the voronoi cell of a point @xmath943 .",
    "we also define @xmath944 , @xmath945 , and @xmath946 similarly .    theorem  [ thm : main - laplacian ] in the case where all the coordinates are strictly positive implies that @xmath947 .",
    "we can naturally define limits of the sets @xmath948 as @xmath845 tends to zero as limits of the points @xmath949 .",
    "indeed this limit exists and coincides with the set @xmath950 , as can be easily verified .",
    "we show now    [ limiting_lem ] we have @xmath951 .",
    "unfortunately this is not true in general for non graphical lattices .",
    "however , we always have @xmath952 .    by corollary  [ cor : critical ] , we already know that every point of @xmath953 is critical .",
    "so we should only prove that these are the only critical points , namely @xmath954 .",
    "let @xmath485 be a critical point of @xmath57 .",
    "by lemma  [ ver_cor ] , we know that there exists a set of points @xmath512 such for each @xmath499 , the facet @xmath514 of @xmath955 contains @xmath236 and none of the other points @xmath956 .",
    "we will show the following : for all sufficiently small @xmath845 , there exists a point @xmath957 and @xmath958 such that @xmath959 has the same property for the lattice @xmath940 , namely , for each @xmath499 , the facet @xmath960 of @xmath959 contains a point @xmath961 which is not in any other facet @xmath962 of @xmath959 , for @xmath963 .",
    "in addition @xmath964 , and so @xmath965 and @xmath966 ( @xmath967 and @xmath968 being the radius and the centre of these balls @xmath959 ) . as each of the point @xmath969 will be critical for @xmath940",
    ", we conclude that @xmath970 which is easily seen to be enough for the proof of the lemma . to show this last statement",
    ", we argue as follows : for small enough @xmath845 , there exist points @xmath971 and @xmath972 such that @xmath973 and for all @xmath974 , @xmath975 when @xmath845 goes to zero .",
    "these points naturally define a ball for the metric @xmath402 , i.e. , a simplex of the form @xmath976 .",
    "this is the bounded simplex defined by the set of hyperplanes @xmath977 , where @xmath977 is the hyperplane parallel to the facet @xmath514 of @xmath955 which contains @xmath978 ( @xmath971 for @xmath979 ) .",
    "we define the ball @xmath980 as follows . for each @xmath845 , if the interior of @xmath976 does not contain any other lattice point ( a point of @xmath940 ) , we let @xmath981 .",
    "if the interior of @xmath976 contains another point of @xmath940 , let @xmath982 be the furthest point from the hyperplane @xmath983 and @xmath984 the hyperplane parallel to @xmath983 which contains this point .",
    "the simplex ( ball ) @xmath980 is the simplex defined by the hyperplanes @xmath983 and @xmath985 .",
    "these simplices have the following properties :    * for all small @xmath845 , @xmath986 does not contain any point of @xmath987 in its interior . in consequence @xmath988 . * when @xmath989 , the simplices @xmath986 converge to @xmath955 ( in gromov - haussdorf distance for example ) . *",
    "the point @xmath982 is in the interior of the facet @xmath990 of the simplex @xmath991 .",
    "in addition for sufficiently small @xmath845 , each point @xmath978 is in the interior of the facet @xmath960 of the simplex @xmath991 .",
    "this is true because @xmath992 , @xmath975 , and each point @xmath236 is in the interior of the facet @xmath514 of @xmath955 .",
    "these properties show that the point @xmath969 is critical for @xmath987 and @xmath993 , which completes the proof .",
    "the proofs of theorem  [ thm : main - laplacian ] and theorem  [ theo : laplacian - unif+reflect ] are now complete .",
    "we note that this representation of @xmath485 as a limit of @xmath969 is not in general unique .",
    "indeed it is quite straightforward to check the following two theorems which show together that : _ different non - equivalent classes of critical points , up to linear equivalence , can converge in the limit to the same class . _    in the case where all @xmath994 , none of the points @xmath790 for @xmath864 is linearly equivalent to another one , i.e. , they define different classes in @xmath995 . in particular , the number of different critical points up to linear equivalence is exactly @xmath996 .",
    "however for general graphs this number is usually strictly smaller than @xmath996 .",
    "we state here without proof the following result about the number of non - equivalent classes of critical points .",
    "two permutations @xmath704 and @xmath997 are _ elementary equivalent _ if @xmath704 is obtained from @xmath721 by switching two consecutive vertices in the order defined by @xmath721 which are not adjacent in @xmath0 ( @xmath998 ) . two elements @xmath704 and @xmath999 are _ equivalent _ if there is a sequence of elementary equivalences which relate @xmath704 to @xmath721 .",
    "each equivalent class for this equivalence relation is called a _ cyclic order _ of @xmath0 .",
    "let @xmath0 be a given connected graph on @xmath22 vertices .",
    "the number of different critical points up to linear equivalence for the laplacian lattice @xmath57 is exactly the number of different cyclic orders of @xmath0 .",
    "the number in the above theorem is exactly the number of acyclic orientations of @xmath0 with a unique fixed source @xmath1000 , which is also the evaluation of the tutte polynomial at the point @xmath1001  @xcite .      in this section ,",
    "we briefly describe how to extend partially the results of the previous section to connected regular digraphs .",
    "a digraph @xmath35 is _ regular _ if the in - degree and out - degree of each vertex are the same .",
    "this allows to define a laplacian matrix for @xmath35 , almost similar as in the graphic case : if the vertices of @xmath35 are enumerated by @xmath1002 , the matrix representation of the laplacian @xmath35 is of the form equation  [ gra_form ] but we do not have symmetry any more .",
    "namely @xmath1003 has the following properties :    * @xmath687 s are integers and @xmath688 for all @xmath689 .",
    "* @xmath691 ( and is the in - degree ( @xmath1004 out - degree ) of the vertex @xmath37 ) .",
    "we obtain the simplicial decomposition of @xmath77 defined by @xmath1005 , similar to the case of unoriented graphs . in the case where all the coordinates @xmath687 are strictly positive",
    ", we can similarly prove the following results ( the proofs remain unchanged ) :    * for all @xmath864 and @xmath366 , the point @xmath780 is extremal ( c.f .",
    "corollary  [ cor : critical ] ) . * for every two points @xmath96 and @xmath132 in @xmath57 , we have @xmath912 if and only if @xmath96 and @xmath132 are adjacent in the simplicial decomposition of @xmath77 defined by @xmath913 . in other words , @xmath912 if and only if there exists @xmath726 such that @xmath132 is a vertex of @xmath914 ( c.f . corollary  [ cor : vor - ex ] ) . * the set of extremal points of @xmath779 consists of all the points @xmath780 for @xmath726 and @xmath781 , i.e. , @xmath1006 as a consequence , we have @xmath1007 more precisely , we have @xmath787 .",
    "theorem  [ thm : main - laplacian ] ) .",
    "* we have @xmath1008 and @xmath1009 .",
    "* riemann - roch inequality .",
    "remark  [ rema : r - r - digraph ] can be applied : for @xmath1010 , we have for all @xmath35 , @xmath618    in the general case , where some of the @xmath687 s could be zero , unfortunately the limiting argument does not behave quite well . indeed , there are examples of regular digraphs for which a point @xmath790 is not a critical point for @xmath57 for some @xmath864 .",
    "however as the proof of lemma  [ limiting_lem ] shows , we always have @xmath1011 so it could happen that we lose ( strong ) reflection invariance .",
    "although we do not know in general if such lattices have any sort of reflection invariance , it is still possible to prove a riemann - roch inequality for these lattices by taking the limit of the riemann - roch inequalities for the lattices @xmath940 .",
    "one point in doing this limiting argument is to extend the definition of the rank function to all the points of @xmath49 ( and not only for integral points ) , which we briefly defined in the beginning of this paper .",
    "this new rank - function will have image in @xmath1012 and is continuous on the points where it is strictly positive .    in the general case we have the following results :    * every point of degree @xmath1013 among the points @xmath790 is extremal ( by a similar limiting argument as in the graphic case ) .",
    "so we have @xmath1009 .",
    "in addition , @xmath1014 .",
    "let @xmath1015 . *",
    "( riemann - roch inequality . ) taking the limit of the family of inequalities @xmath1016 where @xmath845 goes to zero , we get @xmath1017    here @xmath1018 is the rank function for the lattice @xmath940 .",
    "this is because @xmath1019 ; @xmath1020 ; and @xmath1021 for all @xmath1022 .      in this section ,",
    "we consider full - rank sub - lattices of @xmath86 .",
    "first , we show that all these sub - lattices are reflection invariant .",
    "this is indeed an easy consequence of theorem  [ theo : crit - n ! ]",
    "by which a sub - lattice of @xmath86 of rank two has at most two different classes of critical points .",
    "it follows that :    every sub - lattice @xmath57 of @xmath86 of dimension two is reflection invariant .",
    "indeed something quite strong holds in dimension two : every two dimensional sub - lattice @xmath57 of @xmath86 is a laplacian lattice of some regular digraph on three vertices .",
    "[ digraph_lem ] every full dimensional sub - lattice of @xmath86 is the laplacian lattice of a regular digraph on three vertices .",
    "let @xmath1023 be the standard basis of @xmath77 where @xmath1024 , @xmath1025 and @xmath1026 .",
    "let the linear functional @xmath1027 and @xmath1028 be defined by taking the scaler product with @xmath1029 respectively .",
    "so for example for @xmath1030 , @xmath1031 .",
    "let @xmath1032 be a basis of @xmath57 and @xmath1033 .",
    "let @xmath41 be the matrix having @xmath1032 and @xmath1034 as its first , second and third row , respectively . for @xmath1035 , define the cone @xmath1036 to be the set of vectors @xmath5 such that @xmath1037 and @xmath1038 for @xmath963 .",
    "we have    the basis @xmath1039 is the basis defined by a regular digraph if and only if the following holds : for each @xmath499 , @xmath386 is in the cone @xmath1036 .",
    "let @xmath687 denote the @xmath542-th coordinate of @xmath386 .",
    "it will be enough to show that @xmath1040 for @xmath832 .",
    "let @xmath1041 be different from @xmath499 and @xmath542 .",
    "we have @xmath1042 .",
    "but @xmath1043 . it follows that @xmath1044 .",
    "* of lemma  [ digraph_lem ] * we should show the existence of lattice points @xmath1045 such that :    * @xmath1046 is a basis of @xmath57 ; * @xmath1047 ; * @xmath386 is contained in the cone @xmath1036 .",
    "first consider a shortest vector @xmath1048 of the lattice and a shortest vector of the lattice @xmath1049 that is linearly independent of @xmath1048 .",
    "using for example pick s formula , one can show that @xmath1046 forms a basis of the lattice @xmath57 .",
    "we may now assume that @xmath1048 is contained in one of the cones @xmath1050 or @xmath1051 , and without loss of generality @xmath1052 .",
    "indeed if @xmath1048 does not belong to any of these cones then @xmath1053 will belong to one of these cones , and we may replace @xmath1048 by @xmath1053 .",
    "so we assume that @xmath1048 belongs to @xmath1052 .",
    "it is well known that @xmath1049 can be chosen such that the angle between @xmath1048 and @xmath1049 is in the interval @xmath1054 $ ] . since the maximum angle between any two points in @xmath1036 is @xmath1055 , @xmath1049",
    "is contained in a cone different from @xmath1052 and @xmath1056 .",
    "now , if @xmath1049 is not contained in @xmath1057 or @xmath1051 then @xmath1058 will be in @xmath1057 or @xmath1051 , and we can replace @xmath1049 by @xmath1059 . remark that @xmath1060 will remain a basis .",
    "hence , we may assume without loss of generality that @xmath1061 is a basis of the lattice such that @xmath1048 is contained in cone @xmath1052 and @xmath1049 is contained in cone @xmath1057 .",
    "+ this means that @xmath1062 and @xmath1063 , where @xmath1064 and @xmath1065 and @xmath1066 .",
    "first , we observe that @xmath1067 is contained in @xmath1068 , and if it is in @xmath1069 , then we have our set of lattice points @xmath1045 .",
    "we now define a procedure which , by updating the set of vectors @xmath1032 , provides at the end the set of lattice points @xmath1045 with properties @xmath1070 and @xmath501 above .",
    "the procedure is defined as follows :    * if @xmath1071 then stop . * otherwise , if @xmath1072 replace @xmath1048 by @xmath1073 and iterate . * otherwise , if @xmath1074 replace @xmath1049 by @xmath1073 and iterate .",
    "* output @xmath1075 , where @xmath1076 .",
    "we will show that the number of iterations is finite . and",
    "this shows that the final output has the desired properties .",
    "indeed , at each iteration @xmath1046 form a basis of @xmath57 ( if @xmath1046 is a basis of @xmath57 then @xmath1077 and @xmath1078 will also be a basis of @xmath57 ) , and so by the definition of the procedure , the finiteness of the number of steps shows that at the end we should have @xmath1079 . to show that the procedure terminates after a finite number of iterations , consider a step of the algorithm : if the step @xmath1080 in the procedure happens , then @xmath1073 should be in @xmath1081 and not in @xmath1069 .",
    "this means that @xmath1082 , which implies that @xmath1083 .",
    "indeed @xmath1084 and so @xmath1085 .",
    "furthermore , we have , @xmath1086 , since @xmath1087 .    similarly , if the step @xmath1088 in the above procedure happens , then @xmath1073 should be in @xmath1057 and not in @xmath1069 .",
    "hence , we should have @xmath1089 and @xmath1090 .",
    "we infer that , starting form @xmath1048 and @xmath1049 , at each iteration one of the two inequalities @xmath1091 or @xmath1092 for @xmath1093 should be satisfied .",
    "furthermore , at every iteration we have @xmath1094 and @xmath1095 .",
    "hence , an upper bound on the number of iterations is the number of lattice points @xmath96 in @xmath1052 with @xmath1096 plus the number of lattice points @xmath132 in @xmath1057 with @xmath1097 and this is indeed finite .    in higher dimensions ,",
    "the analogue of lemma  [ digraph_lem ] is unlikely to be true since a simple calculation shows that the minimum angle between cones @xmath1036 and @xmath1098 is at least @xmath1099 ( here , as in dimension two @xmath1100 is the corresponding basis of @xmath77 where @xmath1101 , and @xmath1102 is the linear form defined by taking the scaler product with @xmath1103 ) .",
    "indeed , let @xmath1104 and @xmath1105 .",
    "we have @xmath1106    the two inequalities of the last line follow from the set of inequalities @xmath1107 @xmath1108 and the cauchy - schwartz inequality .",
    "hence , if the lattice @xmath57 is generated by a regular digraph , then there exists a basis such that the pairwise angles between the elements of the basis is at least @xmath1055 .",
    "but , it is known that there exist lattices that are not weakly orthogonal , see @xcite",
    ". however , note that the notion of a weakly - orthogonal lattice seems to be slightly different from the notion of a digraphical lattice .",
    "we now characterise all the sub - lattices of @xmath86 which are strongly reflection invariant .",
    "[ thm : a2-strongreflect ] a sub - lattice @xmath57 of @xmath86 is strongly reflection invariant if and only if there are two different classes of critical points up to linear equivalence or @xmath57 is defined by a multi - tree on three vertices ( i.e. , a graph obtained from a tree by replacing each edge by multiple parallel edges ) .    let @xmath1046 be the regular digraph basis of @xmath57 and @xmath1076 .",
    "we consider the triangulation @xmath1109 of @xmath77 defined by this basis .",
    "let @xmath1110 be the triangle defined by the convex hull of @xmath1111 ( @xmath1112 ) and let @xmath1113 be the opposite of @xmath1110 , the triangle defined by the convex hull of @xmath1114 ( @xmath1115 ) , and let @xmath1116 and @xmath1117 be @xmath1118 and @xmath1119 .",
    "at least one of the points @xmath1116 or @xmath1117 is critical . and",
    "in addition the set of critical points of @xmath1120 is a subset of @xmath1121 .",
    "( @xmath226 ) if @xmath1116 and @xmath1117 are both critical points and they are different , we have @xmath1122 and we can directly see that @xmath1123 where @xmath1124 .",
    "it is easy to check directly than the only case when @xmath1116 and @xmath1117 are equivalent is when @xmath1125 and @xmath1126 for @xmath1127 ( in which case @xmath1128 and @xmath1129 , and so @xmath1130 and the lattice is also uniform ) . in this case",
    ", we also have @xmath1122 and so again @xmath1123 where @xmath1124 .",
    "( @xmath240 ) if there is just one critical point up to linear equivalence , let us assume without loss of generality that the critical point is @xmath1116 . in this case",
    ", @xmath1131 .",
    "it is now easy to check that for any bijection @xmath583 of @xmath1120 onto itself , @xmath1132 can not be the same over all @xmath159 in @xmath1120 .",
    "we end this section by providing an example of a sub - lattice @xmath57 of @xmath86 which is not strongly reflection invariant . by the previous theorem",
    ", @xmath57 should contain only one critical point up to linear equivalence and should not be a multi - tree .",
    "( in particular , since we only have one class of critical points , @xmath57 is uniform and satisfies the riemann - roch theorem . )",
    "consider the two dimensional sub - lattice of @xmath86 defined by the vectors @xmath1133 and @xmath1134 , and let @xmath1135 .",
    "these vectors form the rows of the @xmath1136 matrix @xmath41 ( which is the laplacian matrix of a regular digraph ) .",
    "@xmath1137 let @xmath704 and @xmath1138 be the permutation corresponding to the order @xmath1139 and its opposite @xmath1140 as in the proof of theorem  [ thm : a2-strongreflect ] .",
    "we have @xmath1141 and @xmath1142 .",
    "we claim that @xmath1143 is not an extremal point of @xmath166 and so @xmath1144 is not critical .",
    "this is true because @xmath1145 , and so @xmath1146 can not be extremal .    indeed the above example can be turned into a generic class of examples , that we now explain .",
    "consider a lattice defined by generators of the form @xmath1147 and @xmath1148 : @xmath1149 here we suppose in addition that @xmath1150 and @xmath1151 such that the above matrix is the laplacian of a regular digraph .",
    "the two permutations @xmath704 and @xmath712 are defined as above , so for these permutations we have @xmath1152 and @xmath1153 .",
    "it is clear that @xmath1154 .",
    "we infer that @xmath790 is extremal . but",
    "@xmath1146 is not extremal since @xmath1155 .",
    "it is also easy to see that @xmath57 can not have a multi - tree basis .      in this subsection , we show that there exist an infinite family of sub - lattices @xmath1156 , where @xmath1157 is a full rank sub - lattice of @xmath1 , each @xmath1157 satisfies the riemann - roch theorem ( we say that it has the riemann - roch property ) , and such that none of @xmath1157 is graphical . by not being graphical ,",
    "we mean that there does not exist any basis of @xmath57 which comes from a connected unoriented multi - graph , i.e. @xmath1158 for any connected multi - graph @xmath0 on @xmath22 vertices .",
    "indeed , we have already provided in the previous section such an example ( and even an infinite number of them ) in dimension two : the family of sub - lattices of @xmath86 defined by @xmath1147 and @xmath1148 ( we will prove this shortly below ) .",
    "the construction of @xmath1157 for larger values of @xmath30 is then recursive .",
    "suppose we have already constructed an infinite family of full rank sub - lattices of @xmath1159 which are not graphical and have the riemann - roch property , and let @xmath1160 be an element of this family .",
    "then we construct a full rank sub - lattice of @xmath1161 as follows . by taking the natural embedding @xmath1162 , @xmath1163",
    ", we embed @xmath1160 in @xmath1161 . the lattice @xmath1164 is obtained by adding @xmath1165 to the image of @xmath1157 . remark that if @xmath1160 comes from a regular digraph @xmath0 with vertices @xmath1166 , then @xmath1164 is the lattice of the digraph @xmath1167 consisting of @xmath0 and a new vertex @xmath1168 which is connected to @xmath1169 by two arcs , one in each direction .",
    "we will see that @xmath1164 will not be graphical , and in addition it will have the riemann - roch property . here",
    "we provide the details of the construction .",
    "let @xmath1170 be a sub - lattice of @xmath86 defined by @xmath1147 and @xmath1148 , where @xmath1150 and @xmath1151 .",
    "the sub - lattice @xmath1170 has riemann - roch property and @xmath1170 is not graphical .",
    "we saw in the previous section that @xmath1170 has only one class of critical points , up to linear equivalence , is not strongly reflection invariant , and in addition @xmath1171 .",
    "this shows that @xmath1170 can not be graphical .",
    "however , @xmath1170 is uniform and reflection invariant , and so it has the riemann - roch property .",
    "let @xmath1160 be a full rank sub - lattice of @xmath1159 that we regard as an @xmath30-dimensional sub - lattice of @xmath1161 by taking the embedding @xmath1172 described above .",
    "define @xmath1164 to be the lattice generated by @xmath1157 and @xmath1173 .",
    "we first provide two correspondences : one between the rank function @xmath1174 of @xmath1157 and the rank function @xmath1175 of @xmath1164 , and the other one , between the extremal points of @xmath1157 and the extremal points of @xmath1164 .",
    "let @xmath35 be an element of @xmath1176 .",
    "by @xmath1177 we denote the projection of @xmath35 to @xmath44 obtained by eliminating the last coordinate .",
    "so if @xmath1178 , then @xmath1179 .",
    "let @xmath1178 be a point in @xmath1176 and let @xmath1180 .",
    "we have @xmath1181 .",
    "we first prove that @xmath1182 .",
    "let @xmath1183 be effective .",
    "we should prove that if @xmath1184 , then @xmath1185 for at least one @xmath1186 .",
    "let @xmath1187 .",
    "as @xmath1188 , there exists a @xmath1189 such that @xmath1190 . by the definition of @xmath1164 , there exists @xmath917 and @xmath1191 such that @xmath1192 .",
    "it follows that @xmath1193 , and so @xmath1194 .",
    "so @xmath1185 and we are done .    we now show that @xmath1195 .",
    "let @xmath1196 be effective of degree at most @xmath1197 .",
    "we have to prove the existence of a point @xmath1189 such that @xmath1190 .",
    "let @xmath1198 be defined by @xmath1199 .",
    "in other words @xmath1200 .",
    "it is clear that @xmath1201 and @xmath1202 .",
    "so there exists a point @xmath1203 such that @xmath1204 .",
    "we infer that @xmath1205 .",
    "so for @xmath1206 , we have @xmath1190 , and we are done .",
    "[ extconst_lem ] the extremal points of @xmath1207 are of the form @xmath1208 where @xmath5 is an extremal point @xmath1209 and @xmath132 is a point in @xmath1164 .",
    "similarly , the elements of @xmath1210 are of the form @xmath1211 where @xmath7 is a point of @xmath1212 and @xmath1189 .",
    "the proof is similar to the proof of the previous lemma and we only prove one direction , namely @xmath1213 .",
    "the other inclusions @xmath1214 , @xmath1215 , and @xmath1216 follows similarly .",
    "let @xmath1217 be an extremal point of @xmath1164 , i.e. , @xmath1218 .",
    "let @xmath1219 be defined as follows : @xmath1220 .",
    "the claim follows once we have shown that @xmath5 is an extremal point of @xmath1157 . to prove that @xmath5 is an extremal point , we need to show that for all @xmath1221 , @xmath1222 and that @xmath5 is a local minimum for the degree function .",
    "suppose that this is not the case and let @xmath1221 be such that @xmath1223 .",
    "we have @xmath1224 and @xmath1225 , which is a contradiction to the assumption that @xmath1218 .",
    "the proof that @xmath5 is a local minimum follows similarly .    as a corollary to the above lemmas",
    ", we obtain    if @xmath1160 has the riemann - roch property ( resp .",
    "is uniform and reflection - invariant ) , then @xmath1164 also has the riemann - roch property ( resp .",
    "is uniform and reflection - invariant ) .",
    "furthermore , we have @xmath1226 , where @xmath1227 is canonical for @xmath1228 , @xmath1229 .",
    "we now show that if @xmath1170 is the family of lattices that we described above , then @xmath1157 is not graphical . indeed , by applying lemma  [ extconst_lem ] and by induction on @xmath30 , it is easy to show that @xmath1160 is not strongly reflection invariant , provided that @xmath1170 is not strongly reflection invariant , and we know that this is the case .",
    "remark that the family of all @xmath1157 constructed above is infinite ( for each fixed @xmath30 ) . indeed , by using the fact that @xmath1230 , and by observing that the set @xmath1231 contains an infinite number of values , we conclude that @xmath1232 takes an infinite number of values and",
    "so the family of all @xmath1157 is infinite .",
    "let @xmath57 be a full - rank sub - lattice of @xmath1 . while it is not well known whether calculating the rank of a given point for a laplacian lattice can be done in polynomial time or",
    "not , calculating the rank function for general @xmath57 becomes more complicated . in this section , we show that this problem is np - hard .",
    "actually we prove that deciding if @xmath644 is already np - hard for general @xmath35 and @xmath57 .",
    "remark that for the case of graphs , deciding if @xmath644 can be done in polynomial time  @xcite .    by the results of section  [ sec : prel ] , deciding",
    "if @xmath69 is equivalent to deciding whether @xmath1233 or not .",
    "so we will instead consider this membership problem .",
    "we will show below that this problem is equivalent to the problem of deciding whether a rational simplex contains an integral point .",
    "we then use this to show that it is generally np - hard to decide if a given integral point @xmath35 is contained in @xmath121 . as every point of positive degree",
    "is in @xmath121 , we may only consider the points of negative degree .    we first state the following simple lemma .",
    "[ lat_lem ] let @xmath35 be a point in @xmath60 of negative degree .",
    "we have @xmath1234 if and only if the simplex @xmath1235 contains no lattice point ( a point in @xmath57 ) in its interior .",
    "we saw in section  [ sec : voronoi ] that @xmath465 is the lower graph of the function @xmath439 .",
    "it follows that @xmath1234 if and only if @xmath1236 . by the definition of @xmath439",
    ", this means that @xmath1234 is equivalent to @xmath1237 for all @xmath120 , which is to say , @xmath1235 contains no lattice point .",
    "hence , the question of deciding whether if @xmath1234 is equivalent to the following question :    _ given a simplex of the form @xmath1238 with centre at @xmath159 and radius @xmath1239 , can we decide if there is a lattice point in the simplex ? _",
    "a simple calculation shows that the vertices of @xmath1240 are all integral .",
    "this shows that with respect to the lattice @xmath57 , the simplex @xmath1240 is rational , i.e. , there exists a large integer @xmath377 such that @xmath1241 is a polytope with vertices all in @xmath57 .",
    "( this is because @xmath57 is full dimensional and itself integral . )",
    "we now recall that the complexity of deciding if an arbitrary rational @xmath30-dimensional simplex in @xmath301 contains a point of @xmath32 is np - hard when the dimension @xmath30 is not fixed , and it is polynomial time solvable when the dimension is fixed  @xcite . in our case , we are fixing the rational simplex , and @xmath57 is an arbitrary sub - lattice of @xmath1 .",
    "however , it is quite easy to reduce the original problem to our case and to obtain the same complexity results in our setting .",
    "a polynomial - time reduction is described below :    given the vertices @xmath1242 of a rational simplex @xmath1243 in @xmath337 , we do the following .",
    "* compute the centroid @xmath1244 of @xmath1243 and let @xmath1245 . *",
    "define the linear map @xmath1246 from @xmath301 to @xmath77 by sending @xmath1247 bijectively to @xmath1248 .",
    "let @xmath1249 be the image of @xmath1243 , where @xmath1250 .",
    "* let @xmath1251 and @xmath377 be a large integer such that @xmath1252 ( such @xmath377 exists since @xmath1246 and @xmath1243 are rational , and so @xmath57 is rational ) .",
    "remark that we have @xmath1253 if and only if @xmath1254 . remark also that @xmath1255 .",
    "* let @xmath35 be the integral point in @xmath44 defined by @xmath1256 .",
    "then @xmath1257 , @xmath1258 , and @xmath1259 . )    for @xmath57 defined as above , we infer that @xmath1260 if and only @xmath1261 .",
    "so we have    for an arbitrary full rank sub - lattice @xmath57 of @xmath1 , the problem of deciding if @xmath69 given a point @xmath81 and a basis of @xmath57 is np - hard .    as a consequence",
    ", we also note that the decision version of the problem of computing the rank is np - hard .",
    "given an integer @xmath1262 , a point @xmath81 and a basis of @xmath57 of a sub - lattice of @xmath1 .",
    "the problem of deciding if @xmath1263 is np - hard .",
    "it is interesting to note that for the case of laplacian lattices of graphs on @xmath22 vertices , with a given basis formed by the @xmath30 rows of the laplacian matrix , the problem of deciding if an integral point belongs to the sigma - region can be done in polynomial time  @xcite .",
    "so we are naturally led to the following questions :    given a full rank sub - lattice @xmath57 of @xmath1 , does there exist a special basis @xmath160 of @xmath57 such that if @xmath57 is given with @xmath160 , then the membership problem for the sigma - region of @xmath57 can be solved in polynomial time @xmath1264    given a laplacian sub - lattice of @xmath1 , is it possible to find the special basis of @xmath57 in time polynomial in @xmath1265 given a sub - lattice of @xmath1 , is it possible to decide if @xmath57 is laplacian in time polynomial in @xmath1266",
    "in this section , we provide some concluding remarks on the results of the previous sections .",
    "it is possible to extend the results of the previous sections to an arbitrary sub - lattice @xmath57 of @xmath77 of dimension @xmath30 .",
    "however , since @xmath121 does not make sense in the general case , one needs to work directly with @xmath1267 and its closure @xmath166 .",
    "thus , in this setting and for integral sub - lattices , min- and max - genus , rank - function , canonical point , etc change but the new theory is easily related to what we considered in the previous sections ( through the relation between @xmath153 and @xmath121 ) .    in the general setting ,",
    "the definition of the rank - function is inspired by the characterization given in lemma  [ ranksig_lem ] .",
    "namely , for a point @xmath35 in @xmath154 , @xmath1268 if and only if @xmath123 is a point in @xmath153 .",
    "more generally , @xmath1269 is the distance of @xmath123 to @xmath153 in the @xmath125 norm , i.e. , @xmath1270    in the case of integral sub - lattices of @xmath1 , the previous rank - function @xmath15 is related to the new rank function by @xmath1271 .",
    "the structural theorem of sigma - region remains valid , and the definitions of the max- and min - genus and the distance function extend without change to this case .",
    "a riemann - roch theorem can be proved for uniform and reflection invariant real sub - lattices of @xmath77 .",
    "note that for integral sub - lattices of @xmath1 , the @xmath1272genus with respect to @xmath1273 is @xmath1274 where @xmath1275 , and the new canonical point @xmath1276 associated to @xmath1277 , if exists , is nothing but @xmath1278 , where @xmath593 is the canonical point described in the previous sections .",
    "( sketch of the proof . )",
    "let us consider the gradient flow of the function @xmath839 and its corresponding flow complex .",
    "i.e. , for each critical point @xmath521 , we have a maximal open subset @xmath1280 such that for each point @xmath1281 , the gradient flow of @xmath839 starting at @xmath7 ends at @xmath5 .",
    "moreover , @xmath1282 has measure zero . by translation invariance ,",
    "the tiling obtained by @xmath1283 is also translation invariant , i.e. , @xmath1284 for all points @xmath120 and @xmath1285 .",
    "lemma  [ ver_cor ] implies that for each critical point @xmath5 , there exist points @xmath1286 , such that @xmath236 s are in different facets of @xmath515 . by the definition of the distance function @xmath439 , it is easy to see the simplex @xmath515 containing these points is in the topological closure of the open set @xmath1283 .",
    "it follows that @xmath1283 has volume at least the volume of the simplex obtained by taking the convex hull of the points @xmath512 .",
    "this volume is at least the volume of the minimal simplex defined by @xmath57 , i.e. , @xmath1287 .",
    "we infer that each open set @xmath1283 has volume at least @xmath1287 . by taking the quotient modulo @xmath57",
    ", we conclude that @xmath1288 , i.e. , the number of different classes of critical points modulo @xmath57 is at most @xmath996 .",
    "let @xmath57 be a sub - lattice of @xmath1 of dimension @xmath30 .",
    "for a real number @xmath1289 , define the arrangement @xmath1290 as the union of all the simplices @xmath1291 for @xmath1292 , i.e. , @xmath1293 a second arrangement @xmath1294 is defined as the union of all the simplices @xmath1295 for @xmath366 , i.e. ,          let @xmath0 be an undirected graph on @xmath22 and with @xmath23 edges ( thus , @xmath1302 ) .",
    "let @xmath43 be the laplacian lattice of @xmath0 .",
    "( in this case , by the results of section  [ sec : laplacian ] ( c.f . , equation  [ eq : latticepoints ] ) , the covering number of @xmath1303 is the density of the graph . )        ( sketch of the proof )",
    "let @xmath1310 . by the definition of the two arrangements @xmath1305 and @xmath1304 , there exists a point @xmath781 and a point @xmath1311 such that @xmath1312 . by the triangle inequality for @xmath1313 and the results of section  [ sec : laplacian ]",
    ", it follows that @xmath1314 , @xmath1315 , and @xmath1316 .",
    "thus , we have @xmath1317 .",
    "it follows that @xmath1294 and @xmath1307 have disjoint interiors , and so @xmath1318 the other inclusion @xmath1319 follows from the structural theorem of the sigma - region , theorem  [ dom_thm ] ( and theorem  [ cdom_thm ] ) .",
    "namely , we claim that for every point @xmath1320 , there exists a point @xmath781 and a point @xmath1311 , such that @xmath1321 , and this clearly implies the inclusion @xmath1322 .",
    "let @xmath96 be a point of @xmath43 such that @xmath1323 .",
    "by proposition  [ lem : lower - graph ] , the point @xmath1324 lies on the boundary of @xmath1325 . by theorem  [ cdom_thm ] , there exists an extremal point @xmath180 of @xmath774 such that @xmath1326 .",
    "let @xmath485 be the critical point @xmath1327 .",
    "note that @xmath1328 . by proposition  [ lem : lower - graph ]",
    ", we have @xmath1329 .",
    "thus , we have @xmath1330 , or equivalently @xmath1331 . by the explicit definition of @xmath300",
    ", we have @xmath1332 . since @xmath1333",
    ", this shows that @xmath1334 and the claim follows .",
    "the presentation has been benefited very much from very helpful and interesting suggestions and remarks of an anonymous referee .",
    "the authors are extremely grateful to him / her .",
    "special thanks to ivan popov for his help in programming issues which allowed to test some of the conjectures .",
    "many thanks to kurt melhorn for his interest in this work , and to jan van den heuvel for interesting discussions ."
  ],
  "abstract_text": [
    "<S> recently , baker and norine ( _ advances in mathematics _ , 215(*2 * ) : 766 - 788 , 2007 ) found new analogies between graphs and riemann surfaces by developing a riemann - roch machinery on a finite graph @xmath0 . in this paper </S>",
    "<S> , we develop a general riemann - roch theory for sub - lattices of the root lattice @xmath1 by following the work of baker and norine , and establish connections between the riemann - roch theory and the voronoi diagrams of lattices under certain simplicial distance functions . in this way </S>",
    "<S> , we rediscover the work of baker and norine from a geometric point of view and generalise their results to other sub - lattices of @xmath1 . in particular , we provide a geometric approach for the study of the laplacian of graphs . </S>",
    "<S> we also discuss some problems on classification of lattices with a riemann - roch formula as well as some related algorithmic issues . </S>"
  ]
}