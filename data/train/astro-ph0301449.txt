{
  "article_text": [
    "as astronomical surveys are growing in size and scope , so image analysis methods are increasing in complexity and accuracy . in order to calibrate these new methods ,",
    "it is essential to have a large sample of images containing objects whose properties are already known . since real data is subject to the uncertainties of observational noise , telescope aberration and seeing , several packages have been developed to manufacture artificial images ( _ e.g. _  skymaker ( see erben 2001 ) or artdata in iraf ( tody 1993 ) ) . the accuracy of image analysis methods can then be assessed by comparing their output to the known input image properties that were specified before the addition of such observational effects .",
    "the image simulation packages currently available are particularly valuable for imitating deep ground - based data .",
    "however , they limit themselves to a representation of galaxies as parametric forms such as symmetric de vaucouleurs or exponential profiles . deep space - based images , on the other hand , contain many irregular or asymmetrical galaxies with complex resolved features such as spiral arms , mergers and dust lanes .",
    "one possibility for simulating space images , utilised by bouwens , broadhurst & silk ( 1998 ) , is to repeatedly reuse well - resolved galaxies from the hubble deep fields ( hdfs ; williams 1996 , 1998 ) .",
    "however , this restricts us to morphology templates from a relatively bright and nearby sample .",
    "fainter galaxies can not be used because they have been significantly contaminated with background noise .",
    "consequently , the morphological properties of the faint galaxy population are not fairly represented .",
    "this method also faces the difficulty that the same real galaxies must be reused many times within one simulation .",
    "although the hdfs are indeed very deep ( @xmath0=27.60 at 10@xmath1 , williams 1996 ) , they only cover a small area ( @xmath26 square arcminutes each ) and contain a finite number of galaxies . even if we were to source our real galaxies from larger surveys such as the groth strip ( groth 1994 ) or the medium deep survey ( ratnatunga , griffiths & ostrander 1999 ) , we would still face the difficulty of using particular real galaxies many times in a large simulation .    in this paper , we present a method for simulating deep images that contain genuinely unique objects , yet replicate the morphological distribution of galaxies in the hdf at all depths .",
    "this method has the advantage of allowing us to simulate arbitrarily large , deep surveys with no repetition of galaxy shapes .",
    "it also allows us to know accurately the intrinsic properties of each galaxy , before adding telescope - specific noise properties , systematic effects and convolution with a point - spread function ( psf ) .",
    "our method is to decompose all objects in the hdfs into shapelet parametrizations , following the formalism introduced by refregier ( 2003 , hereafter shapelets  i ) and refregier & bacon ( 2003 ; hereafter shapelets  ii ) . using just a few coefficients , these can completely quantify the shape properties of all galaxies , including spiral arms , bars and arbitrary radial profiles .",
    "we then model their distribution of shapelet coefficients , and draw from this probability distribution new sets of shapelet coefficients , representing new galaxies .",
    "in particular , we take into account the covariance between shapelet coefficients so that , for example , shapes depend upon magnitude and size ( _ e.g. _  faint galaxies appear more irregular than bright ones ) . in this method , we therefore do not input any model of physical morphology or evolution .",
    "rather , we exclusively use the measured statistics of the shapelet coefficient distributions from a real galaxy sample , as a function of magnitude and size . the new galaxy images",
    "can then be analytically convolved with any psf , pixellated , and given an appropriate amount of noise for any exposure time down to the depth of the hdf .",
    "these simulations have several significant applications .",
    "we can use them to calibrate the effectiveness of image analysis and detection methods such as sextractor ( bertin & arnouts 1996 ) , imcat ( kaiser , squire & broadhurst 1995 ) , gim2d ( simard 1998 ) , galfit ( peng 2002 ) and wavelet routines ( _ e.g. _  meyer 1993 ) . by examining the errors on shape measurement at various signal - to - noise levels of galaxy detection",
    ", we can also predict the accuracy of future experiments requiring accurate shape measurement .",
    "an example of this for space - based cosmic shear surveys is presented in massey ( 2003 ) .",
    "this paper is organized as follows . in  [ mk_decomp ]",
    "we give a brief overview of the shapelet formalism and describe how the hdf galaxies are modelled using shapelet coefficients . in ",
    "[ adddisadd ] , we show how the properties of the shapelet basis functions make them eminently suitable for this method . in  [ method ] we discuss the means by which we recover a smooth probability distribution of galaxy morphologies in shapelet parameter space . in  [ results ] we generate new galaxies by resampling the distribution .",
    "we then add observational noise and show an example of the final simulated images .",
    "we then demonstrate that the simulations do indeed have similar properties to the hdfs . for this purpose ,",
    "we consider in  [ tests ] commonly used quantifiers for galaxy morphology .",
    "we find good agreement between simulations and the real hdf galaxies for measures such as the size - magnitude distribution , ellipticity , concentration , asymmetry and clumpiness indices ( _ e.g. _  bershady 2000 , conselice 2000a ) .",
    "it is this agreement which is the final justification of our shapelet - based simulation method .",
    "we compare our method to others in  [ compare ] and summarise our findings in  [ conclusions ] .",
    "sample images may be downloaded from http://www.ast.cam.ac.uk/@xmath2rjm/shapelets .",
    "in this section , we describe the detection of hdf galaxies and their modelling as shapelets .",
    "this procedure creates a parametrized catalogue of real galaxy morphologies , which we will require later .",
    "objects are initially detected using sextractor ( bertin & arnouts 1996 ) upon the hdf @xmath3-band ( f814w ) images , together with the pixel weight maps outputted by drizzle ( fruchter & hook 2002 ) .",
    "the convolution mask and detection parameters were adapted from those used by williams ( 1996 ) . in particular , we use a comparatively low s / n detection threshold , @xmath4 , of 1.3 .",
    "this affords recovery of faint galaxies and minimizes incompleteness , at the expense of many false - positive ` detections ' of noise , which need to be flagged and filtered out later ( see  [ decomp ] ) .",
    "stars with @xmath5% are immediately discarded , as we wish to model only galaxies .",
    "the image is then segmented into small square ` postage stamp ' regions around the remaining galaxies .",
    "the sizes of these regions are set to @xmath6 pixels square , where @xmath7 is a measure of the galaxy s major axis provided by sextractor .",
    "this area is slightly smaller than those illustrated in figure  [ fig : gals ] ; it is compact enough to be computationally efficient , but large enough to ensure that the shapelet basis functions are close to zero at the boundaries of the image .",
    "this prescription conveniently leaves a border of sky background and noise around the edge of each image .",
    "we use all of the border pixels that do not belong to any other object in the sextractor catalogue to locally renormalise the pixel weight map . as noticed by williams ( 1996 ) ,",
    "the inverse variance map outputted during the data reduction of the hdf systematically overestimates the noise by a factor of a few .",
    "this bias also varies as a function of position around the image . while sextractor requires only relative weights between pixels , and is thus unaffected by this bias , we need to calibrate the absolute value of noise for the shapelet decomposition .",
    "shapelets are a complete , orthonormal set of 2d basis functions .",
    "a linear combination of these functions can be used to model any image , in a similar way to fourier or wavelet synthesis .",
    "the shapelet decomposition is particularly efficient for images localised in space , such as those of individual galaxies .",
    "the formalism was first introduced in shapelets  i , and a related method has also been independently suggested by bernstein & jarvis ( 2002 ) .    for the polar shapelet analysis , the surface brightness @xmath8 of an object",
    "can be written as @xmath9 where @xmath10 is a scale parameter , and @xmath11 is the position of the centre of the basis functions .",
    "only combinations of @xmath12 and @xmath13 where both are even or both are odd should be included in this summation .",
    "the basis functions @xmath14 , expressed in their polar separable form , are given by    @xmath15^{\\frac{1}{2 } }    r^{|m| }    l_\\frac{n-|m|}{2}^{|m| } \\left(\\frac{r^2}{\\beta^2}\\right )    e^\\frac{-r^{2}}{2\\beta^2 }    e^{im\\theta } , \\end{aligned}\\ ] ]    where @xmath16 are the laguerre polynomials ( see _ e.g. _  boas 1983 ) .",
    "the index @xmath12 describes the radial oscillations and the index @xmath13 describes the order of rotational symmetry .",
    "orthonormality ensures that the shapelet coefficients @xmath17 are given by @xmath18 these are gaussian - weighted multipole moments of the surface brightness , familiar in several branches of astronomy .    for reasonable choices of the centroid @xmath11 and scale size @xmath10 , the galaxy shape information is contained within only the first few shapelet coefficients .",
    "the series in equation  ( [ eq : decompose_2d ] ) can then be truncated at some finite order @xmath19 . in order to make good choices for @xmath11 , @xmath10 and @xmath19",
    ", we first define @xmath20 as the difference between the original and reconstructed image , renormalised with respect to the local noise level .",
    "we then attempt to find the values of @xmath11 and @xmath10 which achieve @xmath21 with the fewest possible shapelet coefficients , or minimum @xmath19 .",
    "shapelet coefficients with higher @xmath12 can be discarded and the shapelet model will still be consistent with the data .    a practical algorithm to perform this optimisation by iteratively exploring @xmath22 , @xmath10 ,",
    "@xmath23 space is described in massey & refregier ( 2003 ) .",
    "the algorithm creates a catalogue of optimised shapelet decompositions for @xmath24 objects per square arcminute in the hdfs .",
    "however , this represents only 81% of the ` objects ' detected by sextractor .",
    "approximately two dozen of the brightest of these galaxies require a decomposition with @xmath25 to achieve @xmath26 . to reduce the dimensionality in later analysis",
    ", these parametrizations are truncated at this point regardless , with @xmath11 and @xmath10 chosen to give the best possible , if slightly imperfect , shapelet fit .",
    "the algorithm also fails to converge to fits with @xmath26 for a further 42 galaxies in close pairs , as identified by the sextractor segmentation map ; 36 galaxies because of their proximity to bright stars or the edge of the image ; and 60 more objects across the hdfs ( about 10% of all sextractor detections ) , which are mainly false detections of noise due to the low s / n detection threshold set in section  [ catgen ] .",
    "note that the number of decompositions which fail due to contamination from a near neighbour is roughly independent of magnitude .",
    "indeed , the slope of the number counts for galaxy pair members is within @xmath27 of that for all the galaxies in the hdf : therefore this particular effect should not introduce any bias .",
    "figure  [ fig : gals ] displays a selection of hdf galaxies at various s / n levels , and their shapelet reconstructions ( see also shapelets  i , figures  3 and 4 ) .",
    "faint galaxies typically require an @xmath19 of only 2 , 3 or 4 , while brighter , larger objects require an increasing number of shapelet coefficients to model their greater degree of detail .",
    "the right - hand column of figure  [ fig : gals ] shows the reconstruction residuals , which are consistent with noise even for irregular galaxy morphologies .      during the modelling of galaxy shapes",
    ", we must in general account for the psf of the wfpc2 camera that has smeared the hdf images .",
    "since our objective here is to simulate only hst images , we do not apply any correction .",
    "the psf will be naturally contained within the shapelet parametrization of the galaxy images and these are intentionally left unaltered .",
    "when we create simulated images , they will automatically have been smeared by the wfpc2 psf : effectively circularised on average , because of the random reorientation of the new galaxies .    however ,  for  other  applications  it  may  be  desir able  to  simulate  observations  from  other  telescopes such  as  the  jwst  ( http://www.stsci.edu/ngst/ ) , snap ( http://snap.lbl.gov/ ) or gaia ( http://astro .",
    "esa.int/gaia/ ) .",
    "it would then be necessary to take account of their different instrumental properties . the ideal way to do",
    "this would be to deconvolve hdf galaxies from the wfpc2 psf analytically in shapelet space ( see shapelets  ii  3 ) , and then to reconvolve simulated galaxies with a new psf at the end .",
    "unfortunately , we have found this method difficult to implement in practice .",
    "the process of deconvolution naturally pushes information into high-@xmath12 and @xmath13 shapelet coefficients , as shown in shapelets  i figure 8 .",
    "although the ensuing galaxy reconstructions are still realistic , information about the overall galaxy morphology distribution is spread thinly over an increased number of coefficients .",
    "this distribution is no longer sufficiently well sampled by galaxies in the hdfs for the smoothing - and - resampling method presented in  [ method ] to be effective .",
    "an alternative solution exists to simulate images with a psf of the same size or larger than that of hst .",
    "the wfpc2 psf can be conveniently maintained throughout the simulations , and the images convolved again at the end with a second , ` difference ' kernel .",
    "this kernel is intended to make up the difference between the original psf of wfpc2 and that of the new instrument .",
    "it can be obtained by deconvolving the wfpc2 psf from the new psf , an operation performed easily in shapelet space ( see shapelets  ii  3 ) .",
    "an example of this method can be seen in massey 2003 .",
    "figure  [ fig : gals ] demonstrates the superb quality of shapelet - based image reconstruction possible for all galaxy morphologies . particularly for spiral or irregular galaxies , we find the shapelet models superior to those using traditional radial profiles alone _ e.g. _  galfit ( peng 2002 ) . that paper contains plots",
    "similar to figure  [ fig : gals ] ; but with much worse residuals .",
    "there are also many more advantages to using the shapelet parametrization for image simulations .",
    "for example , the truncation in @xmath19 produces data compression by setting a minimum and maximum physical scale of interest ( see discussion in shapelets  i ) .",
    "the discarded high-@xmath12 order coefficients contain a small amount of high spatial frequency information .",
    "but because we have ensured that the reconstruction has been pursued up to an order @xmath19 such that @xmath28 , we know that the high - frequency remainder is consistent with noise . usefully for astronomy , the resolution of a shapelet model is also greatest near its centre .",
    "the compression factor for typical galaxy morphologies can be as high as @xmath29 ( shapelets  i ) .",
    "furthermore , this compression is achieved through a parameter - independent truncation of a series . with its complete basis set , shapelets avoid the requirement in galfit or gim2d ( simard 1998 ) to specify in advance the number and type of profiles for each model .",
    "a karhunen - love decomposition would also require models to be specified in advance for both the image and the noise .",
    "furthermore , the orthonormality of the shapelet basis set guarantees a unique and linear one - to - one mapping from the image plane to the coefficients .",
    "this advantage , and many of shapelets convenient mathematical properties are lost to methods using an over - complete basis set such as pixon ( pia & puetter 1993 ) .",
    "it is mainly for these convenient mathematical properties that we choose to model galaxies using shapelets .",
    "for example , an object s orientation is controlled to first order by the phase of the @xmath30 coefficient ( corresponding to the position angle of the object s ellipticity ) ; and its chirality ( handedness ) by the relative phase of the @xmath31 coefficient .",
    "the first can easily be factored out of the parametrization , so that the ellipticity of all objects becomes aligned to the horizontal axis .",
    "the image can then be flipped , if necessary , so that the sign of the @xmath31 phase is positive and the outer isophotes of all objects twist in the same anti - clockwise sense .",
    "correlations between remaining shapelet coefficients @xmath17 are of course maintained in order to preserve the morphology of the galaxy .",
    "any two well - sampled objects which are identical apart from their orientation will then decompose into identical shapelet coefficients .",
    "this greatly increases the sampling density of the galaxy morphology distribution .",
    "simulated galaxies will later be randomly rerotated and flipped as they are created .",
    "shapelets are also designed to be convenient for many aspects of image manipulation and post - processing . since the shapelet basis functions @xmath14 are the eigenfunctions of the 2d quantum harmonic oscillator , they are invariant under fourier transform up to a phase factor .",
    "this renders convolutions ( _ e.g. _  with a psf ) easy and quick to perform .",
    "it also suggests a well - developed mathematical notation from quantum mechanics .",
    "convolutions become a bra - ket matrix multiplication ( see shapelets  ii ) . translations and rotations , useful for simulating dithered images ,",
    "are described to first order by a few applications of @xmath32 and @xmath33 ladder operators .",
    "so too are the distorting shears produced by both optical aberrations within a telescope and weak gravitational lensing within galaxy clusters ( see shapelets  i ) .",
    "there are two main criticisms often levelled at shapelets .",
    "the first is that a gaussian - laguerre expansion may not easily capture the extended wings of many galaxies .",
    "after truncation in @xmath19 , the shapelet basis set is left incomplete and not ideally matched to typical exponential or de vaucouleurs profiles . a demonstration that our algorithm does select sufficiently high",
    "@xmath19 is the remarkable match in the concentration index between shapelet models and real galaxies shown in  [ tests ] .",
    "in fact , the ability of a shapelet decomposition to recognise correlations between adjacent pixels may even enable it to extend further than sextractor into the wings of a faint object at the threshold of detection , where flux in individual pixels is lost beneath the noise .",
    "a potentially greater problem for our simulations is the second criticism that a shapelet decomposition can produce artefacts when it is truncated .",
    "indeed , any truncated basis set that is complete rather than over - complete will be subject to spurious residuals that resemble one basis state , due to the near - cancelling of large positive and negative coefficients in others . for shapelets",
    ", this emerges as ringing , and is particularly apparent after psf deconvolution or around long and thin galaxies , which are less well - matched to the circular basis functions .",
    "furthermore , a desire to keep the shapelet decomposition method linear prevents the imposition of a positive - definite constraint .",
    "the spurious residuals can therefore appear as either extra positive flux or negative holes .",
    "however , we note that this occurs widely in other methods , including wavelets , where it is only removed by a ( non - linear ) projection in wavelet space onto the sub - space of positive solutions .",
    "while most low - level residuals will be lost in the final simulated images beneath even modest background noise , we turn around this disadvantage in  [ lam ] .",
    "there we use the absence of any negative holes in a noise - free image as a first - order diagnostic that the morphed shapes of simulated galaxies are realistic .",
    "a sample of galaxy morphologies can be thought of as a distribution of points in a multi - dimensional shape parameter space .",
    "the axes in this space might represent size , magnitude , position angle ( p.a . ) and so on .",
    "each point corresponds to a particular galaxy with a specific morphology , and various correlations may emerge between variables .",
    "for example , the classic hubble tuning - fork diagram ( hubble 1926 , sandage 1961 , de vaucouleurs 1959 ) relates the object ellipticity , the bulge / disc ratio , and the extent to which the spiral arms are unwound .",
    "gim2d ( simard 1998 ) and galfit ( peng 2002 ) software use axes parametrized by the relative amounts of exponential or de vaucouleurs / srsic functions ( de vaucouleurs 1959 , srsic 1968 ) required to fit the galaxy s radial profile .      in this work ,",
    "we instead choose the axes of our galaxy morphology distribution to be the magnitudes and complex phases of the polar shapelet coefficients .",
    "first , we describe the properties of this ` shapelet parameter space ' . in the following section",
    ", we will then argue that the underlying probability density function ( pdf ) of galaxy morphology is relatively simple in this parameter space and may be recovered from a finite sample like the hdfs .",
    "projections of shapelet parameter space are shown in figure  [ fig : slice ] .",
    "each point in the top - left panel represents a data vector encoding the shape information about one hdf galaxy .",
    "collectively , they describe the overall morphology distribution of distant galaxies . the rotations and reflections used to pre - align galaxies",
    "have considerably compressed this space ( without loss of information ) and allowed it to be more densely sampled by only a finite number of galaxies .",
    "notice that there are correlations evident in the parameters , which correspond to the construction of the familiar shapes of galaxies . in the middle - left plot ,",
    "for example , the scatter of ellipticity values widens for faint galaxies which are known to be more irregular . in the bottom - right plot , deviations from the diagonal show twisting isophotes that can grow , with higher order basis functions , into spiral arms .",
    "it is also important to notice that some regions of parameter space are empty .",
    "a random set of shapelet coefficients will not produce a realistic galaxy shape : there is not even a positive definite constraint imposed upon an image in the shapelet formalism .",
    "two other axes are required for our parameter space , since real galaxy morphologies clearly vary as a function of size and magnitude ( _ e.g. _  figure  [ fig : realimage ] ) .",
    "storing the shapelet scale factor @xmath10 ( see  [ decomp ] ) allows large hdf galaxies to occupy different regions of parameter space to small ones .",
    "similarly , using magnitude as a parameter allows galaxies of different luminosities to have different shapes .",
    "since shapelet coefficients ( including @xmath34 ) scale as the flux , once we include magnitude as an independent parameter , we can divide all @xmath17 by @xmath34 .",
    "this removes explicit magnitude dependence from these quantities and coincidentally ensures a convenient version of adaptive smoothing at a later stage ( see  [ pdf_kernel ] ) .",
    "the degenerate parameter @xmath35 is now removed , and size and magnitude are treated in the same way as any other axis of the parameter space from now on .    note that any orthogonal transformation of the shapelet basis functions would maintain their useful properties of completeness , orthogonality and fourier transform invariance .",
    "for instance , the cartesian version of shapelets can be used instead ( see shapelets  i ) , but without the convenient factoring out of the object s orientation and handedness . using principal components analysis ( pca ; _ e.g. _",
    "francis & wills 1999 ) , it is possible to calculate the optimal linear combination of shapelet coefficients to quantitatively describe galaxy morphology with the fewest numbers .",
    "however , both elliptical and spiral galaxy shapes are already quite simple to manufacture by specifying only a few polar shapelet coefficients ; we therefore avoid the extra complication of pca in this paper .",
    "of course , the principle components of galaxy morphology are interesting in their own right .",
    "these are being studied elsewhere .",
    "the top - left panel of figure  [ fig : slice ] shows a slice through the parameter space of galaxy morphologies , populated by @xmath36-functions representing real , observed shapes . unlike a distribution parametrized simply by bulge / disc ratios and disc inclination angles , it is not obvious _ a priori _ that an underlying , smooth pdf should exist for galaxy morphologies in shapelet space .",
    "however , the compact shapelet representation of astronomical objects suggests that this ought to be the case , and we will attempt to recover it by smoothing this parameter space .",
    "once the validity of the smoothed pdf has been established , it will be a simple matter to resample it and thus to synthesise a population of galaxies .",
    "monte carlo techniques can be used to generate unlimited numbers of realistic galaxies in this fashion , to fill any amount of sky area in a simulated imaging survey .",
    "the remaining panels of figure  [ fig : slice ] demonstrate that the parameter space is indeed smooth in those places where it is well sampled .",
    "we assume that some other regions are equally smooth , but poorly sampled because of the finite number of galaxies in the hdf .",
    "we note that voids are also expected in the parameter space , where the shapelet expansions do not correspond to realistic galaxy shapes",
    ". we will therefore be careful not to smooth the pdf with large smoothing lengths which would significantly encroach upon these voids .",
    "however , limited perturbations around hdf galaxies may indeed recover realistic morphologies .    without an explicitly physical model of galaxy morphology and evolution built in to shapelets ,",
    "it is the final results that must provide the ultimate verification of our statistical method . in @xmath37[results ] , we show that it is indeed possible to find a smoothing length for the pdf that recovers objects which appear to represent realistic shapes . in @xmath37[tests ] we demonstrate quantitatively that their global properties are realistic , by comparing real and simulated populations of galaxies via morphology diagnostics commonly used on deep images .",
    "[ cols= \" < , > \" , ]     as can be seen from the scatter in the plots , the agreement between simulations and real data is rather good : we are very pleased by the encouraging results .",
    "the matching distributions of the concentration parameter puts to rest one criticism frequently levelled at shapelets ( see  [ adddisadd ] ) , that a truncated gaussian - laguerre expansion may not stretch far enough spatially to capture the extended wings of typical astronomical objects .",
    "clearly our algorithm sets @xmath19 high enough to avoid this problem while still modelling the hdf galaxies using only a few coefficients",
    ".    the final population of simulated galaxies does contain asymmetry values lower than those in the real data , although the distributions agree within 1@xmath1 .",
    "this slight discrepancy is neither due to deficiencies in the shapelet modelling procedure , nor to the increased clustering of galaxies at short separations in real data , because it is absent from the simulation created with a @xmath36-function pdf .",
    "decreased object asymmetry must therefore be a by - product of the pdf smoothing .",
    "there is no obvious _ a priori _ reason why this should happen .",
    "even @xmath13 states are symmetric and odd @xmath13 states anti - symmetric , so if the absolute values of all coefficients are randomly changed by the same amount , the overall symmetry of the object should stay constant .",
    "however , our nearest - neighbour prescription from  [ lam ] results in an average smoothing length across typical even @xmath13 states , and particularly the @xmath38 states , of approximately twice that for odd @xmath13 states .",
    "this may simply be because the first state is even , and the smoothing length tends to get shorter as @xmath12 increases .",
    "a more sophisticated adaptive smoothing method might be found to prevent this effect , but we have not pursued that idea here .",
    "we note the asymmetry discrepancy , but note also that it is relatively small .",
    "the behaviour of the clumpiness parameter is also reasonable .",
    "truncation in shapelet modelling smooths galaxies slightly , and thus removes the tail of objects with very high @xmath39 .",
    "morphing in shapelet space apparently acts to then smooth some of the galaxies further .",
    "this is peculiar because , if anything , the galaxies in figure  [ fig : lam ] appear by eye to become more clumpy as the smoothing length is increased .",
    "overall , the agreement of the simulated distributions with real data is remarkably consistent with the field - to - field variation between the two hdfs . indeed , clumpiness is a rather unstable statistic to measure .",
    "for example , even the slight rise in mean clumpiness for the @xmath36-function simulation might be significant : especially since it is apparent despite the missing tail at high @xmath39 .",
    "it is possible that the increase is caused by residual artefacts in the shapelet models , but more plausibly because the noise in our simulated images is not correlated between adjacent pixels .",
    "the hdfs themselves have been drizzled in order to achieve their high resolution , a process which also aliases the image . as a simple approximation to this effect",
    ", we have tried smoothing the noise slightly in our simulations , by a top hat kernel 3 pixels wide .",
    "this process does indeed remove the slight disparity observed in the simulated clumpiness distribution , but simultaneously creates many false detections of faint , circular objects from the noise at the magnitude limit around @xmath40 .",
    "therefore we conclude that our shapelet simulations obtain similar morphology distributions to those found in real data .",
    "this is most encouraging as these were not arranged by construction , and the level of realism seen here is a strong vindication of the shapelet modelling of galaxies .",
    "perturbing shapelet parameters to create new galaxies can introduce a few minor deviations , but these are small compared to natural variation between objects , and are well understood and quantified .",
    "we can therefore use shapelets as a tool for investigating galaxy morphology and for creating realistic simulated images .",
    "there have been many packages in the literature which simulate astronomical observations , including skymaker ( see erben 2001 ) and artdata in iraf ( tody 1993 ) .",
    "these typically parametrize galaxy shapes using simple physical models such as ellipses with de vaucouleurs or exponential profiles .",
    "the smooth variation allowed for these parameters enables them to generate an unlimited number of unique simulated galaxies .",
    "these methods are particularly valuable for simulating images from ground - based telescopes .",
    "unfortunately , deep images from hst contain galaxies with resolved features more complex than these analytical models , so such simulations are useful in only a limited regime .",
    "this was realised by bouwens , broadhurst & silk ( 1998 ) , who designed simulations to investigate the evolution of galaxy morphology in the hdf .",
    "indeed , their work succeeds in ruling out pure luminosity evolution of galaxies : which precisely demonstrates the need for deep image simulations to contain more irregular and asymmetric morphologies .",
    "their method repeatedly places the few brightest hdf galaxies onto a simulated image , and is similar to that which ours would have been , had we left the pdf as an ( unsmoothed ) sum of @xmath36-functions .",
    "some physics can be added to rescale and redshift these few sources , but it remains a very small population from which to simulate a large imaging survey , and containing members drawn exclusively from the local universe .",
    "creating realistic images was not the intention of bouwens , broadhurst & silk ( 1998 ) and , for our objectives , their method would require the addition of more physics ( _ e.g. _  galaxy evolution , star formation histories , redshift distributions , _ etc .",
    "our technique attempts to capture the best aspects of both methods , by defining a smooth parameter space that can yield an unlimited number of unique galaxies , but also contains a rich diversity of their morphologies ( potentially any morphology , in fact , since the set of shapelet basis functions is complete ) . since the parameter space is populated via statistical rather than physical arguments , it is the many tests to which we have subjected our simulated images that demonstrate the validity of our method .",
    "we find a regime spanning six orders of magnitude in luminosity where our simulations are valid , and their statistical properties match those of real data .",
    "this ability to produce simulated images containing galaxies with realistic morphologies is a significant advance .",
    "we have presented a method for generating simulated deep sky images of an arbitrarily large survey area , as might be observed with extended observations with the hubble space telescope .",
    "these simulated images are populated with all morphological types of galaxies , based upon those in the hubble deep fields .",
    "the simulated galaxies are drawn from a multi - variate distribution of realistic morphologies , described using the shapelet formalism ( refregier 2003 ) . in order to generate this morphology distribution",
    ", we decompose all hdf galaxies into shapelet components using least - squares fitting .",
    "we optimise this decomposition by finding the scale length @xmath10 and number of modes @xmath19 which produces a best shapelet coefficient fit to each galaxy .",
    "the resulting coefficients of hdf galaxies form a cloud of points in shapelet space ; these points are replaced by smooth kernels in order to recover the underlying probability distribution of real galaxy morphologies .",
    "the smooth distribution is then resampled , using an unbiased monte - carlo technique , to obtain new galaxies .",
    "we place these simulated galaxies onto hdf - sized images , simultaneously including effects such as psf , pixellisation , photon shot noise and gaussian background noise .",
    "the level of detail in the resulting simulated galaxies includes features such as realistic radial profiles , spiral arms , dust lanes and resolved knots of star formation .",
    "we have noted that the global morphological properties of the simulated galaxy population must match those of real galaxies if our simulations are to be useful .",
    "we have demonstrated that this is the case by comparing various morphology diagnostics in simulated and real galaxies , including number counts as a function of magnitude , the size distribution , ellipticity distribution , and concentration , asymmetry and clumpiness indices .",
    "a test involving purely the shapelet decomposition and reproduction of the hdf galaxies preserves all of these statistics with high precision , and we conclude that a shapelet decomposition can successfully capture the morphological properties of all galaxy types .",
    "a few slight discrepancies are introduced to the statistics by perturbing their shapelet coefficients ( or smoothing the morphology distribution ) to manufacture genuinely new galaxy shapes .",
    "however , these differences are small compared to even the natural variations between objects .",
    "several minor effects have been well quantified by our various tests , and their causes understood for correction in future implementations .",
    "an important application for our simulated images is presented in massey ( 2003 ) , where they are used to predict the sensitivity to weak gravitational lensing of the proposed snap satellite . however , the simulations presented here are in no way specific to gravitational lensing , and may be used for testing image analysis in various branches of astronomy .",
    "further simulated images and catalogues are available from the authors",
    ".    a useful extension to this work will be to include ` groth survey strip ' ( groth 1994 ) galaxies and acs data when constructing the morphology probability distribution .",
    "this will provide future simulations with a more extensive sample of large , bright galaxies , improving the fidelity of the simulations in this region of parameter space .",
    "a method is also in development to generate multi - colour simulated images using several hdf passbands and photometric redshifts .",
    "a by - product of this work is a complete morphological catalogue of all the hdf galaxies in shapelet space .",
    "this catalogue will be used in a future paper on the automated morphological classification of galaxies at high redshift .",
    "the authors thank the raymond and beverly sackler fund for travel support .",
    "ar was supported in cambridge by a pparc advanced fellowship .",
    "djb was supported by a pparc fellowship .",
    "we would also like to thank tzu - ching chang for her help in developing the shapelets method and code .",
    "that code would run much slower without sarah bridle and phil marshall s insightful statistical trickery .",
    "thanks to jason rhodes for help implementing the morphology tests .",
    "we are also grateful to richard ellis , josh frieman , andy fruchter , eric gawiser , jean - paul kneib and jean - luc starck for ideas , comments and enthusiasm throughout this work .",
    "an anonymous referee provided several insights and ideas which have improved this paper .",
    "99 abraham r.  1996 , apjs , 107 , 1 bacon d. , refregier a. , clowe d.  & ellis r.  2001 , mnras , 325 , 1065 bartelmann m.  & schneider p.  2001",
    ", physics reports , 340 , 291 bernstein g.  & jarvis m.  2002 , aj , 123 , 583 bershady m. , jangren a.  & conselice c.  2000 , aj , 119 , 2645 bertin e.  & arnouts s.  1996 , a&as , 117 , 393 blinnikov s.  & moessner r.  1998 , a&as , 130 , 193 boas m.  1983 , `` mathematical methods in the physical sciences '' , wiley .",
    "bouwens r. , broadhurst t.  & silk j.  1998a , apj , 506 , 557 bouwens r. , broadhurst t.  & silk j.  1998b , apj , 506 , 579 conselice c. , bershady m.  & jangren a.  2000a , apj , 529 , 886 conselice c. , bershady m.  & gallagher j.  2000b , a&a , 354 , 21l conselice c. , gallagher j.  & wyse r.  2002 , aj , 123 , 2246 conselice c.  2003 , apjs , in press , astro - ph/0303065 conselice c. , bershady m. , dickinson m.  & papovich , c.  2003 , aj , 126 , 1183 driver s.  1999 in looking deep in the southern sky , eds f.   morganti and w.  couch .",
    "berlin : springer - verlag p.280 epanechnikov , v.  1969 , `` nonparametric estimation of a multivariate probability density '' , theory of probability and its applications , 14 , 153 erben t. , van waerbeke l. , bertin e. , mellier y.  & schneider p.  2001",
    ", a&a , 366 , 717 francis p.  & wills b.  1999 , in `` quasars and cosmology '' , a.s.p .",
    "conference series 1999 , eds .",
    "g.  ferland , j.  baldwin ( san francisco : asp ) fruchter a.  & hook r.  2002 , pasp , 114 , 144 gerhard o.  1993 , mnras , 265 , 213 groth e.  1994 , baas , 185 , 5309 hubble e.  1926 , apj , 64 , 321 kaiser n. , squires g.  & broadhurst t.  1995 , apj , 449 , 460 krist j.  1995 , adass iv , a.s.p .",
    "conference series , vol .",
    "349 krist j. , & hook r.  1997 , the tiny tim user s guide ( baltimore : stsci ) lupton r.  1993 , statistics in theory and practice ( princeton u.  press : princeton ) marleau f.  & simard l.  1998 , apj , 507 , 585 marshall p.  2003 , in preparation massey r.  2003 , aj , submitted , astro - ph/0304418 mellier y.  1999 , ara&a , 37 , 127 meyer y.  1993 , `` wavelets : algorithms and applications '' , society for industrial and applied mathematics , philadelphia odewahn s. , windhorst r. , driver s.  & keel w.  1996 , apjl , 472 , 13 peng c. , ho l. , impey c.  & rix h .- w .",
    "2002 , aj in press .",
    "petrosian v.  1976 , apj , 209 , 1l pia r.  & puetter r.  1993 , p.a.s.p .",
    ", 105 , 630 ratnatunga k. , griffiths r.  & ostrander e.  1999 , aj , 118 , 86 refregier a.  2003 , mnras , 338 , 35 refregier a.  & bacon , d.  2003 , mnras , 338 , 48 rhodes j. , refregier a.  & groth e.  2001 , apj , 552 , 85 sandage a.  1961 , `` the hubble atlas of galaxies '' ( carnegie inst .",
    "washington publ .",
    "618 ) ( washington : carnegie inst . )",
    "sain s.  1999 , `` multivariate locally adaptive density estimation '' , technical report , department of statistical science , southern methodist university srsic j.  1968 , `` atlas de galaxias australes '' ( cordoba : obs .",
    "astronomico ) silverman b.  1986 , `` density estimation for statistics '' and data analysis ( chapman and hall , london ) simard l.  1998 , adass vii , a.s.p .",
    "conference series , vol .",
    "145 , 108 stark j .-",
    ", pantin e.  & murtagh f.  2002 , pasp , 114 ,",
    "1051 tody d.  1993 , `` iraf in the nineties '' in adass ii , a.s.p .",
    "conference series , vol 52 , eds .",
    "r.  hanisch , r.  brissenden , & j.  barnes , 173 van der marel r.  & franx m.  1993 , apj , 407 , 525 van der marel r.  1994 , mnras , 268 , 521 de vaucouleurs g.  1959 , hand .",
    "physik , 53 , 275 williams r.  1996 , aj 112 , 1335 williams r.  1998 , a&as , 193 , 7501 york d.  2000 , aj , 120 , 1579"
  ],
  "abstract_text": [
    "<S> we present a method to simulate deep sky images , including realistic galaxy morphologies and telescope characteristics . to achieve a wide diversity of simulated galaxy morphologies </S>",
    "<S> , we first use the shapelets formalism to parametrize the shapes of all objects in the hubble deep fields . </S>",
    "<S> we measure this distribution of real galaxy morphologies in shapelet parameter space , then resample it to generate a new population of objects . </S>",
    "<S> these simulated galaxies can contain spiral arms , bars , discs , arbitrary radial profiles and even dust lanes or knots . to create a final image , we also model observational effects , including noise , pixellisation , astrometric distortions and a point - spread function . </S>",
    "<S> we demonstrate that they are realistic by showing that simulated and real data have consistent distributions of morphology diagnostics : including galaxy size , ellipticity , concentration and asymmetry statistics . </S>",
    "<S> sample images are made available on the world wide web . </S>",
    "<S> these simulations are useful to develop and calibrate precision image analysis techniques for photometry , astrometry , and shape measurement . </S>",
    "<S> they can also be used to assess the sensitivity of future telescopes and surveys for applications such as supernova searches , microlensing , proper motions , and weak gravitational lensing .    </S>",
    "<S> = = = = = = = =    # 1 # 1 # 1 # 1 @mathgroup@group @mathgroup@normal@groupeurmn @mathgroup@bold@groupeurbn @mathgroup@group @mathgroup@normal@groupmsamn @mathgroup@bold@groupmsamn = `` 019 = ' ' 016 = `` 040 = ' ' 336 = \" 33e = = = = = = = =    # 1 # 1 # 1 # 1 = = = = = = = =    [ firstpage ]    galaxies : fundamental parameters , statistics  methods : statistical  gravitational lensing . </S>"
  ]
}