{
  "article_text": [
    "in the current structure formation paradigm the properties of galaxies are coupled to the evolution of their dark matter ( dm ) hosting halo . in this paradigm the sizes and dynamics of galaxies",
    "are driven by the halo internal dm distribution .",
    "the internal dm distribution in a halo is usually parameterized through the density profile . in a first approximation",
    "this profile is spherically symmetric ; the density only depends on the radial coordinate .",
    "one of the most popular radial parameterizations is the navarro - frenk - white ( nfw ) profile @xcite .",
    "this profile can be considered as universal @xcite , assuming that one is not interested in the very central region where galaxy formation takes place , and where the effects of baryon physics on the dm distribution are still unknown .",
    "this profile is a double power law in radius , where the transition break happens at the so - called scale radius , @xmath7 .",
    "the ratio between the scale radius and the halo virial radius @xmath8 is known as the concentration @xmath9 .",
    "the concentration of the nfw profile provides a conceptual framework to study simulated dm halos as a function of redshift and cosmological parameters .",
    "numerical studies @xcite summarized their results through the mass - concentration relationship ; that is , the distribution of concentration values at a fixed halo mass and redshift .",
    "the success of such numerical experiments rests on a reliable algorithm to estimate the concentration .",
    "such an algorithm should provide unbiased results and must be robust when applied at varying numerical resolution .",
    "there are two established algorithms to estimate the concentration parameter .",
    "the first method takes the halo particles and bins them into logarithmic radii to estimate the density in each bin , then it proceeds to fit the density as a function of the radius .",
    "a second method uses an analytic property of the nfw profile that relates the maximum of the ratio of the circular velocity to the virial velocity , @xmath10/@xmath11 .",
    "the concentration can be then found as the root of an algebraic equation dependent on this maximum value .",
    "the first method is straightforward to apply but presents two disadvantages .",
    "first , it requires a large number of particles in order to have a proper density estimate in each bin .",
    "this makes the method robust only for halos with at least @xmath12 particles .",
    "the second problem is that there is not a way to estimate the optimal radial bin size , different choices may produce different results for the concentration .",
    "the second method solves the two problems mentioned above .",
    "it works with low particle numbers and does not involve data binning .",
    "however , it effectively takes into account only a single data point and discards the rest of the data .",
    "small fluctuations on the maximum can yield large perturbations on the estimated concentration parameter .    in this letter",
    "we use bootstrapping to estimate the bias and standard deviation on the concentration estimates as a function of particle number .",
    "we show that the two standard methods to estimate concentrations have increasing biases for decreasing particle numbers .",
    "this motivates us to present a third alternative based on fitting the integrated mass profile .",
    "this approach has two advantages with respect to the above mentioned methods .",
    "it does not involve any data binning and does not throw away data points .",
    "this translates into a robust estimate even at low resolution / particle numbers .",
    "furthermore , since the method does not require any binning , there is no need to tune numerical parameters .",
    "this is a new independent method to estimate the concentration parameter .",
    "let us review first the basic properties of the nfw density profile . this shall help us to define our notation .",
    "the nfw density profile can be written as    @xmath13    where @xmath14 is the universe critical density , @xmath15 is the hubble constant , @xmath16 the universal gravitational constant , @xmath17 is the halo dimensionless characteristic density and @xmath7 is the scale radius .",
    "this radius marks the point where the logarithmic slope of the density profile is equal to -2 , the transition between the power law scaling @xmath18 for @xmath19 and @xmath20 for @xmath21 .",
    "we define the virial radius of a halo , @xmath22 , as the boundary of the spherical volume that encloses a density of @xmath23 times the mean density of the universe .",
    "the corresponding mass @xmath24 , the virial mass , can be written as @xmath25 . from these virial quantities",
    "we define new dimensionless variables for the radius and mass @xmath26 and @xmath27 .    in this letter",
    "we use @xmath28 , a number roughly corresponding to 200 times the critical density at redshift z=0 .      from these definitions",
    "we can compute the total mass enclosed inside a radius @xmath29 : @xmath30,\\ ] ] or in terms of the dimensionless mass and radius variables    @xmath31 , \\label{eq : profile}\\ ] ]    where @xmath32 and the parameter @xmath33 corresponds to the concentration @xmath34 .    from this normalization and for later convenience",
    "we define the following function @xmath35 the most interesting feature of eq .",
    "( [ eq : profile ] ) is that the concentration is the only free parameter to describe the integrated mass profile .",
    "it is also customary to express the mass of the halo in terms of the circular velocity @xmath36 . from this",
    "we can define a new dimensionless circular velocity @xmath37 , using the result in eq .",
    "[ eq : profile ] we have :    @xmath38},\\ ] ]    this normalized profile always shows a maximum provided that the concentration is larger than @xmath39 .",
    "it is possible to show that for the nfw profile the maximum is provided by    @xmath40    where @xmath41 @xcite and the function @xmath42 corresponds to the definition in eq .",
    "( [ eq : f_nfw ] ) .",
    "to date , there are two standard methods to estimate concentrations in dm halos extracted from n - body simulations .",
    "the first method takes all the particles in the halo and bins them in the logarithm of the radial coordinate from the halo center .",
    "then , it estimates the density in each logarithmic bin . at this point is possible to make a direct fit to the density as a function of the radial coordinate .",
    "this method has been broadly used for more than two decades to study the mass - concentration - redshift relation of dm halos .",
    "a second method uses the circular velocity profile .",
    "it finds the value of @xmath43 for which the normalized circular velocity @xmath44 shows a maximum . using this value it solves numerically for the corresponding value of the concentration using eq .",
    "( [ eq : max_v ] ) .      here",
    "we propose a new method to estimate the concentration .",
    "it uses the integrated mass profile defined in eq .",
    "( [ eq : profile ] ) . we build it from n - body data as follows .",
    "first , we define the center of the halo to be at the position of the particle with the lowest gravitational potential",
    ". then we rank the particles by their increasing radial distance from the center . from this",
    "ranked list of @xmath45 particles , the total mass at a radius @xmath46 is @xmath47 , where @xmath46 is the position of the @xmath48-th particle and @xmath49 is the mass of a single computational particle .",
    "we then divide the enclosed mass @xmath50 and the radii @xmath46 by their virial values to finally obtain the dimensionless variables @xmath51 and @xmath52 .    using bootstrapping data (  [ sec : bootstrapping ] ) we find that at a given normalized radius , @xmath43 , the logarithm of the normalized integrated mass , @xmath53 , approximately follows a gaussian distribution with variance    @xmath54    if the integrated mass values at different radii were independent from each other we could write a likelihood distribution as @xmath55 with    @xmath56 ^ 2}{\\sigma_i^2},\\ ] ]    where @xmath57 , @xmath58 corresponds to the values in eq.([eq : profile ] ) at @xmath59 for a given value of the concentration parameter @xmath33 , and the @xmath48 index sums over all the particles in the numerical profile . in this computation the particles @xmath60 and @xmath61",
    "are discarded to avoid divergent terms in the sum .",
    "however , tests on the bootstrapping data show that using @xmath57 , instead of the full inverse covariance matrix , grossly overestimates @xmath62 , providing small uncertainties around the best concentration value .",
    "to avoid the expensive computation and inversion of a full covariance matrix we use the bootstrapping data to calibrate an effective @xmath63 .",
    "we impose two conditions on the approximate @xmath64 .",
    "it must keep the dependence on @xmath43 that we have discovered for the diagonal elements and must give similar curves of @xmath65 vs. @xmath33 around the minimum as the full covariance matrix .",
    "we found that the effective @xmath66 can be approximated as    @xmath67    we then use an affine invariant markov chain monte carlo ( mcmc ) implemented in the python module ` emcee ` @xcite to sample the likelihood function distribution . from the @xmath68 distribution we find the optimal concentration value and its associated uncertainty .",
    "we stress that different choices for @xmath69 do not affect the optimal concentration value , only its uncertainty .",
    "run - time is roughly proportional to @xmath70 . using a single 2.3ghz cpu core with two walkers over 500 steps takes @xmath71 milliseconds per halo per particle in the halo ,",
    "i.e. a halo with @xmath72 can be fit in one second .",
    "we use two different simulations to test our methods .",
    "the first is the bolshoi run , a cosmological simulation that follows the non - linear evolution of a dm density field sampled with @xmath73 particles over a cubic box of @xmath74 on a side .",
    "the cosmological parameters use a hubble parameter @xmath75 , a matter density @xmath76 and a normalization of the power spectrum @xmath77 .",
    "the data is publicly available at http://www.cosmosim.org/. details about the structure of the database and the simulation can be found in @xcite .",
    "we use the halos located in a cubic sub - volume of @xmath78  on a side containing a total of @xmath79 objects . from this sample",
    "we select all the halos at @xmath80 detected with a friends - of - friends ( fof ) algorithm with more than 300 particles , meaning that the masses are in the interval @xmath81 .",
    "the fof algorithm used a linking length of @xmath82 times the mean inter - particle distance .",
    "this choice translates into an overdensity @xmath83 dependent on the halo concentration @xcite .    from this set of particles",
    "we follow the procedure spelled out in section [ sec : method ] with @xmath28 to select an spherical region that we redefine to be our halo .",
    "this choice makes that the overdensities are fully included inside the original fof particle group . on the interest of providing a fair comparison against the density method",
    "we only report results from overdensities with at least @xmath1 particles ( @xmath84 ) .",
    "we also use public data from the via lactea simulation project @xcite .",
    "this simulation contains a single isolated halo with a virial mass of the order of @xmath85simulated using the tree code pkdgrav @xcite .",
    "the simulation had @xmath86 particles to resolve this region .",
    "the cosmological parameters are different from those in the bolshoi simulation , with a hubble parameter @xmath75 , a matter density @xmath87 and a normalization of the power spectrum @xmath88 .",
    "the data available to the public corresponds to a downsampled set of @xmath89 particles , which corresponds to a particle mass of @xmath90 .",
    "we take halos with at least @xmath91 particles and subsample them by factors of @xmath92 up to @xmath93 .",
    "we measure the concentration at every resampling .",
    "we use a two - sample kolmogorov - smirnov ( ks ) test to compare the list of radial distances from each subsample against that of its parent halo .",
    "we find that the resulting p - value distribution is flat .",
    "this confirms that the radial particle distribution in the bootraped halo is consistent with coming from the distribution given by the parent halo . why not using different simulations with the same initial conditions and",
    "lower resolutions ( i.e. * ? ? ?",
    "because we want to be sure that we are only measuring the bias of a given method as a function of particle number for statistically identical halos , and not a possible simulation artifact that changes the halo structure .    for every subsample we keep fixed the virial radius and the center found for the high resolution halo . leaving the virial radius and center free in each bootstrapping iteration has an effect smaller than @xmath94 in the concentration . in the bolshoi simulation",
    "we select 14 massive halos and create 700 subsamples for each one . for the via lactea simulation",
    "the same halo is subsampled 10000 times .",
    "the average concentration value for the largest number of particles , @xmath95 , provides a baseline to compare all the other results .",
    "we use the following statistic @xmath96 to account for the offset between the concentration at a given downsampled particle number @xmath97 and the baseline @xmath95 .",
    "figure [ fig : downsampling ] summarizes our results .",
    "the plot on the left shows the average value of @xmath98 as a function of particle number .",
    "this can be interpreted as the statistical bias on the concentration estimate . for large enough particle numbers , @xmath99 the results of the three algorithms show a bias below the @xmath94 level . for a lower number of particles",
    "the results start to deviate . at @xmath1 particles the velocity method overestimates the concentration by a factor @xmath100 while the density method overestimates it by @xmath101 . around the same sampling scale ,",
    "the new algorithm shows a more stable behaviour underestimating the concentration only by a factor of @xmath94-@xmath102 .",
    "the thin lines on the same panel show a fit to the function @xmath103 with @xmath104 , @xmath105 ; @xmath106 , @xmath107 and @xmath108 , @xmath109 for the density , velocity and mass method , respectively .",
    "the right panel in figure [ fig : downsampling ] shows different uncertainty results .",
    "the lines show the difference between the 14 and 86 percentiles in the @xmath98 distribution at fixed mass .",
    "each line corresponds to the three different methods to estimate the concentration applied to both simulations .",
    "this shows that the bootstrapping technique can help us to assign a @xmath110 uncertainty to the concentration values at a fixed @xmath111as @xmath112 the circles in the same figure show the @xmath110 uncertainty on all the relaxed halos in the bolshoi simulation sample using the mcmc results . to allow for a fair comparison with the bootstrapping results ,",
    "this uncertainty is normalized to the concentration value .",
    "the uncertainty from the bootstrapping experiment provides an upper bound uncertainty on the concentration estimate for individual halos .",
    "we now inspect the mass - concentration relationship results with the three different algorithms .",
    "this can help us to identify possible consequences of the biases detected through the bootstrapping experiments .",
    "figure [ fig : concentration ] shows the mass - concentration relationship for the density , velocity and integrated mass method .",
    "the left panel shows the results as they are produced by each of the algorithms .",
    "the thin dashed line marks the trend reported by @xcite using the velocity method , showing that our velocity method implementation can reproduce their results .",
    "the results from the new algorithm follow very closely the velocity algorithm at high masses ( @xmath113 or equivalently for @xmath114 particles ) . for lower masses",
    "there is a difference between the median of the two methods , but they are still consistent within the statistical uncertainties .",
    "we hypothesize that the increase in the results for the velocity and density methods below @xmath115 particles comes from the systematic bias described in the previous section . to test the general consistency of this hypothesis",
    ", we correct the concentration values in the velocity and integrated mass methods by a factor of @xmath116 , using the definition in equation ( [ eq : f_off ] ) and the parameters obtained from the data presented in figure ( [ fig : downsampling ] ) .",
    "the correction brings into good agreement the results between the velocity / density methods and the new algorithm .",
    "we also notice that the results from the density method have a systematic @xmath117 offset from the velocity methods .",
    "this offset was already presented by @xcite for low concentrations ( @xmath118 ) and high ( @xmath113 ) halo masses .",
    "recently @xcite summarized results for the mass - concentration relationship coming from different methods and datasets to show that similar systematic offsets are present .",
    "@xcite studied the mass - concentration relationship using the maximum velocity and density methods and did not report any significant difference .",
    "however , they implemented a modified version of the velocity algorithm that bins the particle data , which might explain why they the offset was not reported .",
    "how do these results impact the most recent mass - concentration estimates ?",
    "@xcite and @xcite estimated the mass - concentration relation over different suites of cosmological n - body simulations using the density and velocity methods , respectively . both used halos with at least @xmath119 particles .",
    "this imposes a lower halo mass limit of @xmath120(figure 8 in @xcite , figure 17 in @xcite ) to have robust estimates .",
    "this means that their results for individual halos should not be affected by the bias we report here .",
    "this also leaves open the question about what other methods can robustly say about the flattening we report below @xmath85using the new method .",
    "however , there are other results at lower masses and higher redshifts ( i.e. * ? ? ?",
    "* ) that should be reconfirmed using higher resolution simulations as they use halos with only @xmath4 particles .",
    "in this letter we used bootstrapping to quantify the biases on concentration estimates .",
    "we found that methods commonly used in the literature can overestimate the concentrations by factors of @xmath117-@xmath101 for halos with @xmath1 particles , or @xmath2-@xmath3 for halos with @xmath4 particles .",
    "this procedure provides a robust technique to quantify the bias in concentration estimates with the advantage that it works without having to run new simulations .",
    "these results motivated us to introduce a new method based on the integrated mass profile that show a robust performance at low particle numbers .",
    "the new algorithm showed a bias of @xmath5 for halos with @xmath1 particles and less than @xmath94 for halos with @xmath4 particles or more . to keep the bias of the velocity and density methods below @xmath121 only halos with at least @xmath6 particles",
    "should be considered .",
    "the three methods are in broad agreement , within the statistical uncertainties , concerning their estimates of the mass - concentration relationship .",
    "some noticeable differences include a @xmath117 systematically higher concentrations in the density method compared to the velocity method .",
    "this systematic offset has been reported before with the same dataset @xcite and with different simulations @xcite without any conclusive explanation for its origin .",
    "another difference is that the velocity and integrated mass methods start to differ for masses below @xmath122 ( @xmath6 particles ) .",
    "we found that correcting the mean concentration by the mean bias factor found through bootstrapping brings these two techniques into agreement .",
    "these results show that using the integrated mass profile to estimate the dm halo concentrations is a tool deserving deeper scrutiny .",
    "further tests with larger simulated volumes , varying numerical resolution , higher redshifts , stacked data and different density profiles are the next natural step to explore the full potential of this new method .",
    "we acknowledge financial support from uniandes and estrategia de sostenibilidad 2014 - 2015 universidad de antioquia .",
    "we thank toms verdugo , stefan gottloeber and nelson padilla for their feedback .",
    "we thank the anonymous referees for comments that improved the presentation of these results ."
  ],
  "abstract_text": [
    "<S> we use bootstrapping to estimate the bias of concentration estimates on n - body dark matter halos as a function of particle number . </S>",
    "<S> we find that algorithms based on the maximum radial velocity and radial particle binning tend to overestimate the concentration by @xmath0 for halos sampled with @xmath1 particles and by @xmath2-@xmath3 for halos sampled with @xmath4 particles . to control this bias at low particle numbers we propose a new algorithm that estimates halo concentrations based on the integrated mass profile . </S>",
    "<S> the method uses the full particle information without any binning , making it reliable in cases when low numerical resolution becomes a limitation for other methods . </S>",
    "<S> this method reduces the bias to @xmath5 for halos sampled with @xmath1-@xmath4 particles . </S>",
    "<S> the velocity and density methods have to use halos with at least @xmath6 particles in order to keep the biases down to the same low level . </S>",
    "<S> we also show that the mass - concentration relationship could be shallower than expected once the biases of the different concentration measurements are taken into account . </S>",
    "<S> these results show that bootstrapping and the concentration estimates based on the integrated mass profile are valuable tools to probe the internal structure of dark matter halos in numerical simulations . </S>"
  ]
}