{
  "article_text": [
    "for quantitative understanding , predicting , and controlling time - varying phenomena it is necessary to relate observations to a mathematical model of a system dynamics . in a great number of important problems",
    "such model is multidimensional , nonlinear , stochastic and not known from `` first principles '' .",
    "furthermore , often only part of the system s variables can be measured and these measurements are corrupted by noise .",
    "the rest of the system variables are invisible , or _",
    "hidden_. in these settings , perhaps the most fundamentally difficult unsolved problem of dynamical inference is how and to which extent one can learn both the model parameters and system trajectory from a given set of incomplete trajectory measurements .",
    "a solution of this problem is of importance across many disciplines .",
    "examples range from molecular motors  @xcite to coupled matter - radiation system  @xcite ( see e.g.  @xcite for further examples ) .    here",
    "we present a solution to this problem using a path - integral approach to fluctuational dynamics@xcite .",
    "we show that , given the measurements , the most probable system trajectory can be obtained from finding the minimum of the mechanical action of a certain auxiliary hamiltonian system under properly defined boundary conditions .",
    "the dependence of the minimum action on the system model parameters determines the statistical likelihood of different parametric models .",
    "the method is used to solve an intensively studied problem from the population dynamics of the predator - prey system@xcite where the cyclic dynamics of populations of small rodents is observed in kilpisj@xmath0rvi , finnish lapland , 1952 - 1992 @xcite ( see fig .  [",
    "fig : vole_original](a ) ) while the number of predators is difficult or impossible to estimate .",
    "the predator - prey dynamics is fully nonlinear subject to seasonal and random perturbations .",
    "this is a classical longstanding problem in ecology  @xcite and epidemiology ( see e.g.  @xcite ) . in particular ,",
    "the cited database accumulates nearly 5000 individual datasets with similar structure collected over more then 150 years of research .",
    "it is shown that the proposed approach allows to recover both the unknown dynamics of predators and model parameters directly from measurements of the prey dynamics .",
    "( a ) stochastic trajectory of the population dynamics of small rodents observed in kilpisj@xmath0rvi , finnish lapland , 1952 - 1992  @xcite is shown by yellow dots .",
    "black solid line is shown to guide an eye .",
    "dashed lines shows the solution of the optimization problem .",
    "( b ) black solid line shows recovered hidden dynamics of the population of the specialists predators obtained by varying parameters @xmath1 and @xmath2 of the model ( [ eq : the_model ] ) .",
    "parameters used to obtain these results are : r = 5.2 @xmath3 2.5 , rk/k = -5.2 @xmath3 2.5 ; s = 1.2 ; a = 15 ; g = 0.1 ; e1 = .8 ; e2 = .5 ; k = 90 ; q = 30 ; @xmath4 = 0.02 ; @xmath5 = 0.02 .",
    "the insert shows the cross - section of the weighted distribution of the dynamical trajectories for the year 1956 indicated by the arrow in the main figure.,title=\"fig:\",width=377,height=188 ]   ( a ) stochastic trajectory of the population dynamics of small rodents observed in kilpisj@xmath0rvi , finnish lapland , 1952 - 1992  @xcite is shown by yellow dots .",
    "black solid line is shown to guide an eye .",
    "dashed lines shows the solution of the optimization problem .",
    "( b ) black solid line shows recovered hidden dynamics of the population of the specialists predators obtained by varying parameters @xmath1 and @xmath2 of the model ( [ eq : the_model ] ) .",
    "parameters used to obtain these results are : r = 5.2 @xmath3 2.5 , rk/k = -5.2 @xmath3 2.5 ; s = 1.2 ; a = 15 ; g = 0.1 ; e1 = .8 ; e2 = .5 ; k = 90 ; q = 30 ; @xmath4 = 0.02 ; @xmath5 = 0.02 .",
    "the insert shows the cross - section of the weighted distribution of the dynamical trajectories for the year 1956 indicated by the arrow in the main figure.,title=\"fig:\",width=377,height=188 ]",
    "to formalize the discussion above note that in a typical experimental situation we observe @xmath6-dimensional time series of signals @xmath7 , with the sampling step @xmath8 .",
    "the unknown is the actual @xmath9-dimensional dynamical trajectory of the system @xmath10 .",
    "we are interested in the case where @xmath11 so some of the trajectory components are hidden .",
    "quantitative understanding of the time - varying phenomena underlying @xmath12 requires , in general , an expert input into the observed data in the form of a mathematical modelling framework for the system dynamics and for the measurement scheme . a commonly used dynamical and measurement equations for nonlinear models in the presence of random perturbations that apply to but by far not limited by the predator - prey ecological system described above are @xmath13here we introduced continues - time interpolations @xmath14 for components of the observed time - series @xmath12 .",
    "this approximation can often be justified for a sufficiently small sampling interval @xmath8 and a large number of data points , @xmath15 , in the time - series @xmath12 . in ( [ eq : sde ] ) @xmath16 ( @xmath17 ) are dynamical variables composing a vector @xmath18 that describes an instantaneous state of the system .",
    "the system dynamics in ( [ eq : sde ] ) is governed by @xmath9-dimensional vector field with components @xmath19 depending on the set of parameters @xmath20 and white gaussian process with zero - mean components @xmath21 characterized by a @xmath22 correlation matrix @xmath23 .",
    "the deterministic part of the measurement equation in ( [ eq : sde ] ) is described by @xmath24 measurement matrix @xmath25 and the measurement error is described by the white gaussian process with zero - mean components @xmath26 and @xmath27 measurement noise matrix @xmath28 ( @xmath29 ) .",
    "overall , the dynamical and measurement model ( [ eq : sde ] ) is characterized by the full set of the _ unknown _ parameters @xmath30 .",
    "due to the presence of dynamical and measurement noise the problem of dynamical inference must be cast in probabilistic terms .",
    "this can be done within a general framework of the baeysian statistical approach  @xcite .",
    "a key statistical quantity is a so - called _ likelihood _ probability density functional ( lpdf ) @xmath31 $ ] .",
    "it represents a joint probability density that the system trajectory is @xmath18 and the system parameter values are @xmath32 conditioned on the observed time - series @xmath33 .",
    "we emphasize that in a real physical process the system has a distinct trajectory and parameter values . in this regard",
    "the lpdf represents a degree of uncertainty in our knowledge about these quantities obtained from the measurements and assuming some basic properties of the system fluctuational dynamics @xcite .",
    "the explicit form of the lpdf can be obtained from ( [ eq : sde ] ) using the path - integral approach to fluctuational dynamics  @xcite .",
    "we write @xmath34=a_{{{\\cal y } } } \\exp\\left(-s _ { { \\cal y}}[{\\bf x}(t);\\,{{\\cal m}}]\\right)$ ] , where @xmath35 is a normalization constant and a negative log - likelihood functional @xmath36 is obtained in the appendix a @xmath37=   \\frac{1}{2}\\int_{0}^{t}dt   \\left[\\left({{\\bf y}}(t)-\\hat { { \\bf b}}\\,{{\\bf x}}(t ) \\right)^t{\\bf\\hat   n}^{-1}\\left({{\\bf y}}(t)-\\hat { { \\bf b}}\\,{{\\bf x}}(t ) \\right)+ { { \\boldsymbol \\nabla}}\\cdot   { { \\bf k}}({{\\bf x}}(t),{{\\bf c}})\\right.\\nonumber\\\\ & & \\left.+\\left(\\dot{{\\bf x}}(t)-{{\\bf k}}({{\\bf x}}(t),{{\\bf c}})\\right)^t\\hat   { \\bf d}^{-1}(\\dot{{\\bf x}}(t)-{{\\bf k}}({{\\bf x}}(t),{{\\bf c}}))\\right]+\\frac{{{\\cal k}}}{2}\\ln\\left(\\det(\\hat{\\bf d})\\det(\\hat{\\bf n})\\right).\\end{aligned}\\ ] ] here @xmath38 is a time length of the data record @xmath12 . in what following we shall focus on the case @xmath39 that implies the existence of hidden variables .",
    "we note that despite hidden dynamical variables are not measured directly the functional @xmath36 ( [ eq : action ] ) still depends on them explicitly because of the dynamic coupling between the variables imposed by the force field @xmath40 .    in many practically important cases available",
    "recording of a system trajectory , while containing only a part of dynamical variables , has sufficiently small time - step , long time duration and limited noise characteristics .",
    "such measurements can provide a strong information that is sufficient to pin down both key model parameters of the system and its trajectory , or at least to extract strong correlations between them . in these cases",
    "the joint lpdf @xmath41 will be well localized in the vicinity of one or more of its maxima where @xmath42 and @xmath43 . in the case",
    "where a single maximum dominates lpdf its position corresponds to the trajectory @xmath44 and parameter values @xmath45 that the system most probably has , given the measurements @xmath12 .",
    "we now put forth a new paradigm in which a solution of the dynamical inference problem with hidden variables is obtained via the calculus of variations for the functional @xmath46 .",
    "the power of this approach is in its simplicity , efficiency and an insight that it provides to the solution of dynamical inference problem by drawing a close connection to the methods and concepts of classical mechanics , in particular , a least action principle .",
    "we search for the minimum of @xmath46 by alternatively computing the expected values of @xmath18 and model parameters in @xmath47 from the solution of the two variational problems @xmath48 and @xmath49 .",
    "the first condition corresponds to a solution of the boundary value problem for an auxiliary mechanical system with the coordinate @xmath50 , momentum @xmath51 and a hamiltonian function @xmath52 @xmath53 we look for the solution of the hamiltonian equations @xmath54 that satisfy the boundary conditions @xmath55 .",
    "if several solutions exist we choose the one providing a minimum of a functional @xmath56 $ ] playing a role of a mechanical action .",
    "we then fix the inferred trajectory @xmath18 and update the value of the parameters in the set @xmath47 , using analytical solution of the second variational problem , @xmath49 , developed in our earlier research  @xcite ( see appendix a for details ) .",
    "this procedure is repeated iteratively until the desired convergence is achieved .",
    "the outcome of this algorithm is the most probable system trajectory @xmath57 and model parameters @xmath58 .",
    "the measure of their fitness to the observed data @xmath33 is @xmath59 where the globally minimum action @xmath60 $ ] .",
    "the bayesian approach for dynamical inference was initially proposed by meyer and christensenin @xcite for the case where all variables were directly observed .",
    "the previous work on this subject ( see e.g.  @xcite ) was exclusively focusing on brute force numerical methods , such as markov chain monte carlo ( mcmc ) .",
    "however our detailed study of mcmc approach for the problem of dynamical inference with hidden variables has shown that the functional @xmath61 has multiple deep spurious minima in the space of piece - wise continuous trajectories @xmath62 .",
    "these minima occur due to the contributions to the cost functions from the terms of the order of @xmath63 .",
    "if one starts from a poor guess about both the system trajectory and model parameters mcmc search stacks in those minima and takes a prohibitively large time to converge ( see sec .",
    "[ sec : mcmc ] for details ) . in contrary",
    ", our approach avoids those spurious minima because the solution of the hamiltonian boundary value problem ( [ eq : he ] ) is achieved via large smooth variations in the space of continuous trajectories .",
    "this key finding reflects a basic property of a hidden - variable and parameter inference in a noisy dynamical system with continuous vector field @xmath64 : expected value of the inferred trajectory @xmath44 is a smoothly varying function of time whereas the measured signal @xmath65 is not .",
    "we note that the likelihood distribution around the maximum is determined by the second variation @xmath66 of the action with respect to the both @xmath10 and @xmath47 computed at its minimum . in many cases , in particular in the case of a multi - modal lpdf ,",
    "it is of interested to explicitly study the full shape of the lpdf in a reduced subspace of the model parameters while marginalizing the lpdf with respect to the other parameters and the system trajectory . within our approach",
    "this can be handily done by computing the minimum action @xmath67 using the above algorithm for different values of the parameters @xmath68 .",
    "however in many complex cases where observational and model errors are significant and hidden variables are present lpdf can have a very large number of local minima .",
    "in this case the more informative quantity is a distribution of local minima . to obtain it",
    "we pick at random some values of ( @xmath69 and converge to the nearest point ( @xmath70 ) of a local minimum of the action @xmath67 where the conditions @xmath48 and @xmath49 are satisfied .",
    "we then repeat this procedure many times for different starting values of ( @xmath71 .",
    "then the histogram of the local minima ( @xmath70 ) weighed with the factors @xmath72 and appropriately normalized gives the distribution of local minima @xmath73 .",
    "we will demonstrate this approach in sec .",
    "[ sec : predator.prey ] for the inference of the population dynamics .",
    "finally , we emphasize that the prerequisite of the approach considered in this section is that lpdf computed at any set @xmath74 of relevant parameter values has a sharp peak in the space of the system paths @xmath18 at some @xmath75 that depends on @xmath76 ( cf .",
    "[ fig:3dtrajectory ] ) .",
    "result of the direct comparison of the path - integral and mcmc techniques for ( a ) observed variable @xmath77 and ( b ) hidden variable @xmath78 .",
    "the actual dynamical trajectories @xmath77 and @xmath78 are shown by solid lines .",
    "the measured trajectory @xmath79 is shown by dashed black line in figure ( a ) and is taken as initial guess for the solution @xmath77 . for an unobservable trajectory",
    "@xmath78 initial guess is taken to be @xmath80 .",
    "the solution of the boundary value problem is shown by yellow circles .",
    "the mcmc solution is shown by red squares .",
    "the inset in the figure ( a ) shows the variation of the cost function as a function of time for mcmc algorithm ( black dots ) and for boundary value method ( yellow circle).,width=377,height=226 ]     result of the direct comparison of the path - integral and mcmc techniques for ( a ) observed variable @xmath77 and ( b ) hidden variable @xmath78 .",
    "the actual dynamical trajectories @xmath77 and @xmath78 are shown by solid lines .",
    "the measured trajectory @xmath79 is shown by dashed black line in figure ( a ) and is taken as initial guess for the solution @xmath77 . for an unobservable trajectory",
    "@xmath78 initial guess is taken to be @xmath80 .",
    "the solution of the boundary value problem is shown by yellow circles .",
    "the mcmc solution is shown by red squares .",
    "the inset in the figure ( a ) shows the variation of the cost function as a function of time for mcmc algorithm ( black dots ) and for boundary value method ( yellow circle).,width=377,height=226 ]",
    "we now apply the method described above to reconstruction of the unknown predator dynamics and model parameters from the observed oscillations of small rodents in finish lapland .",
    "the observed time - series data is shown by yellow circles in the fig .",
    "1(a ) . to formulate the problem we first briefly summarize an expert input into observed data , see e.g.  @xcite for more details .",
    "it was argued  @xcite that the most likely predators to potentially maintain oscillatory dynamics in rodent populations are small mustelids , weasels , and stoats which are notoriously difficult to observe and study in the field .",
    "it was further argued  @xcite that in addition to the dominating effect of these so - called specialist predators the population of rodents is strongly affected by generalists predators ( such as foxes , owls and skua ) and by seasonal ( periodic ) and stochastic variations of the environment .",
    "based on these arguments the following equations were introduced to model observed ecological time series @xmath81 here the state of the system is characterized by the dynamical variables @xmath82 and @xmath83 , corresponding to the density of rodents and predators , respectively .",
    "taking into account a log - normal distribution of the measurement errors the measured rodent density @xmath84 is related to the actual ( unknown ) value @xmath82 via @xmath85 where @xmath86 is a white gaussian noise of unit intensity .",
    "the predator density is not measured so the variable @xmath83 is hidden . in ( [ eq : the_model ] ) @xmath87 is a zero - mean white gaussian vector of dynamical noise .",
    "the precise functional form is known neither for predation nor for numerical response of the predators and some modifications of the equations ( [ eq : the_model ] ) where considered in the literature  @xcite .",
    "the problem of dynamical inference is the following : use 80 experimental points of corrupted by noise measurements to recover both hidden dynamics of predators @xmath88 and the model of the nonlinear stochastic dynamics of small rodent in fennoscandia represented by the full set of parameters from eq .",
    "( [ eq : the_model ] ) and @xmath89 .",
    "since there were no general methods to recover neither hidden dynamics nor nonlinear models of stochastic systems it was always assumed ( see e.g.  @xcite ) that the goal to obtain solution of this problem is unrealistic and no attempt was made to solve it in the earlier research .",
    "instead a number of models were developed  @xcite from the first ecological principles and from the extensive field studies of the small rodents ecology .",
    "the outcome of the simulation of these models was compared to the experimental points to decide whether or not the model is capable of producing reasonable predictions .",
    "this approach although very valuable and often the only one available in practice has very limited statistical significance and can hardly be generalized .",
    "( a ) weighted distribution of the inferred values of the model parameters @xmath1 and @xmath2 .",
    "( b ) the same distribution top view .",
    "( c ) weighted distribution of the inferred values of the model parameters @xmath90 and @xmath91 .",
    "( d ) top view of the same distribution.,title=\"fig:\",width=226,height=226 ]   ( a ) weighted distribution of the inferred values of the model parameters @xmath1 and @xmath2 .",
    "( b ) the same distribution top view .",
    "( c ) weighted distribution of the inferred values of the model parameters @xmath90 and @xmath91 .",
    "( d ) top view of the same distribution.,title=\"fig:\",width=226,height=207 ]     ( a ) weighted distribution of the inferred values of the model parameters @xmath1 and @xmath2 .",
    "( b ) the same distribution top view .",
    "( c ) weighted distribution of the inferred values of the model parameters @xmath90 and @xmath91 .",
    "( d ) top view of the same distribution.,title=\"fig:\",width=226,height=226 ]   ( a ) weighted distribution of the inferred values of the model parameters @xmath1 and @xmath2 .",
    "( b ) the same distribution top view .",
    "( c ) weighted distribution of the inferred values of the model parameters @xmath90 and @xmath91 .",
    "( d ) top view of the same distribution.,title=\"fig:\",width=226,height=207 ]    the method introduced above provides a general and effective alternative approach to a solution of this ecological problem .",
    "first , we map the predator - pray model ( [ eq : the_model ] ) directly onto the dynamical model with additive white noise considered in eqs .",
    "( [ eq : sde ] ) by making the change of variables : @xmath92 and @xmath93 ( here some known nominal values are used for the scaling coefficients @xmath94 and @xmath95 ) .",
    "then the full set of unknown parameters @xmath96 and the trajectory of the predator density @xmath88 is inferred from the observed data using the dynamical inference scheme described above ( for the scaling of dynamical equations and precise ecological meaning of these parameters see  @xcite ) . to present the solution of this inference problem we investigate the marginalized lpdf as a function of key model parameters that are notoriously difficult to estimate  @xcite using other techniques : carrying capacity @xmath97 and equilibrium ration between two populations @xmath98",
    "( see online supplement material for further details ) .",
    "the results are shown in the fig  [ fig : vole_original ] and fig .  [",
    "fig : vole_rs_dist ] .",
    "it can be seen from the fig  [ fig : vole_original ] ( a ) that the model ( [ eq : the_model ] ) can fit experimental data very well in a wide range of values of e.g. parameters @xmath1 and @xmath2 .",
    "this gives rise to a broad distribution of the possible dynamical trajectories of hidden predators shown in the fig  [ fig : vole_original ] ( b ) .",
    "however , the likelihood functions of various trajectories are exponentially different .",
    "this fact is taken into account by weighting the corresponding distributions of the model parameters with the factor @xmath99)$ ] .",
    "the weighted distributions of trajectories and model parameters is the main outcome of the statistical analysis of the ecological experimental data .",
    "the weighted joint distributions of the inferred pairs of parameters ( @xmath1 , @xmath100 ) and ( @xmath90 , @xmath91 ) are shown in the fig .",
    "[ fig : vole_rs_dist ] .",
    "analysis of these distributions gives the following estimates of the model parameters @xmath101 , @xmath102 , @xmath103 @xmath104 , @xmath105 , @xmath106 , @xmath107 , @xmath108 , @xmath109 , and @xmath110 which are close to the values considered in the earlier ecological research  @xcite . at the same time statistical analysis",
    "reveals that distributions for the parameters @xmath111 ( in the range of values ? ?",
    ") are very flat and further information is needed for a more accurate estimate of their values .",
    "the method can be further verified by analyzing experimental data obtained for the small rodents - predators community in high - arctic greenland  @xcite .",
    "this data is very similar to the data collected in fennoscandia with a important exception , namely , dynamics of both populations prey and predator was recorded very carefully in greenland .",
    "therefore , it has become possible to check if the predator dynamics reconstructed from the prey population alone coincides with the actual observations of the predator time series .     lemming ( a ) and ( b ) stoat population ( individuals / ha ) observed in the high - arctic tundra in 19882002  @xcite are shown by yellow circles .",
    "the thing solid line is shown to guide the eye . dashed black lines show population dynamics inferred using model ( [ eq : lemming_model ] ) under assumption that the dynamics of both populations was measured in the experiment with measurement error 0.2 .",
    "dashdot lines show population dynamics inferred using model ( [ eq : lemming_model ] ) under assumption that only the dynamics of prey populations was measured in the experiment with measurement error 0.2 and the predator dynamics is hidden.,width=377,height=188 ]     lemming ( a ) and ( b ) stoat population ( individuals / ha ) observed in the high - arctic tundra in 19882002  @xcite are shown by yellow circles .",
    "the thing solid line is shown to guide the eye .",
    "dashed black lines show population dynamics inferred using model ( [ eq : lemming_model ] ) under assumption that the dynamics of both populations was measured in the experiment with measurement error 0.2 .",
    "dashdot lines show population dynamics inferred using model ( [ eq : lemming_model ] ) under assumption that only the dynamics of prey populations was measured in the experiment with measurement error 0.2 and the predator dynamics is hidden.,width=377,height=188 ]    the experimental data ( see fig .",
    "3 ) for the population oscillation in the lemming - stoat predator prey community were collected in the high - arctic tundra in greenland in 19882002  @xcite .",
    "the time - variation of the predator and prey oscillations are also influenced by a number of generalists predators such as arctic fox , snowy owl , and long - tailed skua .",
    "we note that a very detailed model with experimentally measured numerical responses of various predators is available  @xcite to simulate this data . however , to analyze hidden predator population along the lines outlined in the previous section we notice that the organization of the lemming - stoat community in the high - arctic greenland is very similar to the vole - weasel community in finnish lapland .",
    "so we attempt to fit the lemming - stoat population oscillations using the model ( [ eq : the_model ] ) developed for the latter community  @xcite .    in this model",
    "the populations are scaled as @xmath112 and @xmath113 with some assumed values of the carrying capacity @xmath94 and proportionality constant @xmath95 ( @xmath94 and @xmath95 are known , while actual values @xmath97 and @xmath98 are not known and have to be inferred ) .",
    "the time - variations of @xmath114 and @xmath115 are described by the following set of equations  @xcite @xmath116 the parameters of these equations have the following  @xcite meaning .",
    "vole population _ is characterized by : ( i ) the intrinsic rate of the vole population growth @xmath1 with possible values in the range : 4 - 7 yr@xmath117 ; ( ii ) the dimensionless amplitude of seasonal forcing @xmath118 with range : 0.5 - 1 ; ( iii ) prey carrying capacity @xmath97 with range : 100 - 300 voles ha@xmath117 . the _ specialist predator population _",
    "is described by : ( i ) intrinsic rate of weasel population growth @xmath90 with range : 1- 1.5 yr@xmath117 ; ( ii ) minimum consumption per predator @xmath119 with range : 500 - 700 voles yr@xmath117 weasel@xmath117 ; ( iii ) half saturation constant @xmath120 with range : 5 - 6 voles ha@xmath117 ; ( iv ) predator - prey constant ratio @xmath98 with range : 20 - 40 voles weasel@xmath117 .",
    "the _ generalist predation _ is characterized by : ( i ) the maximum rate of mortality @xmath121 with range : 70 - 125 voles ha@xmath117 yr@xmath117 and ( ii ) half - saturation prey density @xmath122 with range : 11 - 16 voles ha@xmath117 .",
    "first , we try to fit this model to the experimental data taking into account measurements of both populations . to avoid the problem related to the fact that continuous model is being fitted to the experimental points measured only once a year we interpolate experimental points for predator and prey using a piecewise cubic hermite interpolation with time step @xmath123 year .",
    "the corresponding results of the fit are shown by the dashed black line in the fig .",
    "[ fig : lemming_data](a ) and ( b ) .",
    "we note that the model ( [ eq : lemming_model ] ) can fit very well experimental data . however , this agreement has a limited statistical significance since we are fitting 30 experimental points by a nonlinear model with 18 parameters .",
    "it turns out that the same experimental data can be well fit in a broad range of the values of the model parameters . a detailed study of the landscape of the log - likelihood function is needed to choose the most probable model .",
    "we defer this study to a future publication . in the present study our main goal is to verify that even in the absence of the measurements of the predator population we can still recover both hidden dynamics of the predator and the model parameters although with degraded accuracy .",
    ".[tab : lemming_mod ] inference results for the parameters of the model ( [ eq : lemming_model ] ) obtained by two methods : value i were obtained assuming that both populations ( lemming and stoat ) were measured ; value ii were obtained assuming that only lemming population were measured .",
    "experimental points in both cases were interpolated using piecewise cubic hermite interpolation with time step @xmath123 year . [ cols=\"^,>,<,>,<\",options=\"header \" , ]     to this end we now infer both hidden dynamics of the stoat population and the model parameters assuming that only population of lemming was measured .",
    "the corresponding inference results are shown in the fig .",
    "[ fig : lemming_data](a ) and ( b ) by the red dash - dot lines .",
    "the values of the parameters inferred in both cases are summarized in the table  [ tab : lemming_mod ] .",
    "we conclude that even in the case of incomplete corrupted by noise measurements of the population dynamics our method allows one to recover both hidden dynamics of invisible predator and the model parameters .",
    "finally we analyze a distribution of the most probable predator trajectories for different model parameter values taken at multiple minima of lpdf discussed above ( see fig .",
    "[ fig : vole_rs_dist ] ) .",
    "we search for local minima of lpdf with respect to the set of coefficients @xmath124 in the region @xmath125 . at each local minima @xmath126",
    "we find the most probable predator trajectory @xmath127 by solving a boundary value problem described above and attach the statistical weight to this trajectory @xmath128 .",
    "the resulting 3d distribution of the weighted predator trajectories is shown in the fig [ fig:3dtrajectory ] .",
    "( a ) probaility distribution of the predator trajectories at local minima of lpdf ; ( b ) the corresponding contour plot . local minima of lpdf with respect to four model parameters were sampled in the region : @xmath129 .",
    "other parameters in this test were : @xmath130 , @xmath131 , @xmath132 , @xmath133 , @xmath134 , @xmath135.,width=377,height=377 ]     ( a ) probaility distribution of the predator trajectories at local minima of lpdf ; ( b ) the corresponding contour plot .",
    "local minima of lpdf with respect to four model parameters were sampled in the region : @xmath129 .",
    "other parameters in this test were : @xmath130 , @xmath131 , @xmath132 , @xmath133 , @xmath134 , @xmath135.,width=377,height=188 ]",
    "to compare directly the results of the reconstruction obtained by the path - integral method and by mc algorithm we simplify problem and consider oscillations in a two - dimensional system of the form @xmath136 where @xmath137 and @xmath138 .",
    "we assume that only @xmath77 is measured with measurement noise @xmath86 of intensity @xmath139 to produce an observed time series @xmath140 while the second variable is missing .",
    "result of the direct comparison of the path - integral and mcmc techniques for ( a ) observed variable @xmath77 and ( b ) hidden variable @xmath78 .",
    "the actual dynamical trajectories @xmath77 and @xmath78 are shown by solid lines .",
    "the measured trajectory @xmath79 is shown by dashed black line in figure ( a ) and is taken as initial guess for the solution @xmath77 . for an unobservable trajectory",
    "@xmath78 initial guess is taken to be @xmath80 .",
    "the solution of the boundary value problem is shown by yellow circles .",
    "the mcmc solution is shown by red squares .",
    "the inset in the figure ( a ) shows the variation of the cost function as a function of time for mcmc algorithm ( black dots ) and for boundary value method ( yellow circle).,width=377,height=226 ]     result of the direct comparison of the path - integral and mcmc techniques for ( a ) observed variable @xmath77 and ( b ) hidden variable @xmath78 .",
    "the actual dynamical trajectories @xmath77 and @xmath78 are shown by solid lines .",
    "the measured trajectory @xmath79 is shown by dashed black line in figure ( a ) and is taken as initial guess for the solution @xmath77 . for an unobservable trajectory",
    "@xmath78 initial guess is taken to be @xmath80 .",
    "the solution of the boundary value problem is shown by yellow circles .",
    "the mcmc solution is shown by red squares .",
    "the inset in the figure ( a ) shows the variation of the cost function as a function of time for mcmc algorithm ( black dots ) and for boundary value method ( yellow circle).,width=377,height=226 ]    we find maximum of the posterior pdf @xmath141 in the space of dynamical trajectories @xmath142 by applying two methods : path - integral approach as described above and markov chain mote carlo ( mcmc ) using metropolis - hastings algorithm within gibbs sampling scheme ( see e.g.  @xcite ) .",
    "the results are shown in the fig .",
    "it can be seen from the figure that the mcmc algorithm can indeed be used to reconstruct dynamical trajectory from the noisy measurements",
    ". however , in the case of missing variable the mcmc fails to recover correct solution .",
    "the reason is that the later requires large smooth variations of the trajectory , while the mcmc algorithm is searching in the space of discontinuous nondifferentiable trajectories and as a result converges to multiple deep spurious minima produced by the terms of the order @xmath143 in the cost function ( [ eq : action ] ) .",
    "similar problem appears already in deterministic case  @xcite , where the multiple shooting technique is applied to solve the problem .",
    "we note that our approach is more general .",
    "it is valid both in stochastic and deterministic case and avoids logistic and technical problems related to dividing trajectory on arbitrary number of piece - wise continuous solutions and on gluing these solution together .",
    "we found our method to be sufficiently robust to work in the case of more then one hidden variable . to demonstrate this we consider the archetypical chaotic nonlinear system of lorenz , @xmath144 driven by zero - mean white gaussian noise processes @xmath145 with covariance @xmath146 .",
    "synthetic data ( with no measurement noise ) were generated by simulating ( [ eq : lorenz ] ) using the standard parameter set @xmath147 , @xmath148 , @xmath149 , and for various levels of dynamical noise intensities .",
    "it is assumed that the trajectory component @xmath114 shown in fig .",
    "[ fig : lorenz](a ) is measured directly ( no measurement noise ) while the components @xmath115 and @xmath150 are not observed ( hidden variables ) .",
    "the results of the trajectory inference are shown in fig .",
    "[ fig : lorenz](b , c , d ) .     ( a ) measured variable @xmath114 for the following system parameters : @xmath151 , @xmath152 , and @xmath153 , @xmath154 , @xmath155 , @xmath156 . ( b ) and ( c )",
    "actual values of the unknown dynamical variables @xmath115 and @xmath150 are shown by the black line .",
    "inferred values are shown by the red dots .",
    "( d ) actual trajectory of the system in 3d space of the variables @xmath157 ( black solid line ) is compared with the inferred trajectory ( red line).,width=384,height=432 ]",
    "is has been assumed up to now that a lack of observational data for predator populations constituted a fundamental obstacle to the inference of ecological parameters from experimental data  @xcite . a conclusion that can be drawn from the above results that this is not necessarily the case . using the methods described above it is possible to reconstruct both invisible dynamics of predators population and the model parameters directly from measurements of prey populations , even those containing some measurement errors and uncertainties .",
    "note , that much of the studies across many scientific disciplines rely on the analysis of the extremal properties of the effective action similar to ( [ eq : action ] ) in various function spaces ( cf .",
    "e.g.  @xcite ) .",
    "for example , solution of the problems of large occasional deviations in noisy dynamical systems is given by the minimum of the functional ( [ eq : action ] ) with no measurement term .",
    "unlike the dynamical inference searching for the trajectory and model parameters that the system has with high probability , the theory of large deviations is concerned with an optimal fluctuation , or a _ least improbable path _ of the system to reach a remote state from the attractor during the rare event .",
    "however the solution of both problems provides a global minimum to the functional ( [ eq : action ] ) in the space of dynamical trajectories and is equivalent to a certain hamiltonian dynamics in an extended phase space . in the theory of large deviations the corresponding hamiltonian",
    "is called wentzel - friedlin hamiltonian  @xcite .",
    "the dynamical quantities appearing within this hamiltonian theory have precise physical meaning and are accessible for direct experimental measurements  @xcite .",
    "very similar optimization problems also occur in the context of stochastic optimal control of large deviations  @xcite and the related hamiltonian can sometimes be identified  @xcite with so - called pontryagin hamiltonian  @xcite playing a key role in the theory of optimal control .",
    "we note however that the dynamical inference hamiltonian @xmath158 ( [ eq : the_hamiltonian ] ) is of a qualitatively new type .",
    "it depends explicitly on the time - varying measurement signal @xmath65 that plays a role of a control force in the hamiltonian dynamics .",
    "these considerations suggest that the proposed path - integral approach to the problem of dynamical inference with hidden variables is a general one and sets the solution of this problem into the standard mathematical context .",
    "it is valid both in deterministic and stochastic case and is a natural generalization of the earlier _ ad hoc _ approach to the dynamical inference of deterministic systems  @xcite .",
    "we believe that methods of hamiltonian theory will provide a new topological insight to the solutions of complex problems of a dynamical inference with hidden variables .",
    "for example , in many cases the observed data are not sufficient to discriminate with high probability between the different values of system parameters and/or the forms of its hidden trajectory component .",
    "this corresponds to a certain degeneracy set in the joint functional space @xmath159 where the functional @xmath160 takes a constant maximum value . in general",
    ", the degeneracy set will be determined by the properties of the corresponding lagrangian manifold associated with the auxiliary hamiltonian system ( [ eq : the_hamiltonian ] ) and conditions @xmath161 .",
    "we also note that whenever the dynamical inference converges to a right solution the inferred system trajectory and parameter values correspond to a sufficiently small momentum @xmath162 ( of the order of noise intensities , @xmath163 ) and the minimum action @xmath164 .",
    "however in certain cases the global minimum of @xmath160 corresponds to a much larger momentum @xmath165 and @xmath166 .",
    "then the fitness to the data @xmath12 is poor for _ any _ choice of parameters and trajectory .",
    "this implies that model assumptions ( [ eq : sde ] ) do not capture some important properties of the real - world system ( a so called , model error \" ) .",
    "overall , the locations of maxima of effective action @xmath160 dominating the lpdf , their relative weights , as well as the topological structure in the joint functional space @xmath159 answer the statistical question of what _ can _ or _ can not _ be learned with a high likelihood about the system at hand given the available data and basic assumptions about the dynamical model .",
    "our results also reveal a remarkable property of the dynamical inference with incomplete measurements . in the absence of the model error",
    "the system parameters can be learned with uncertainties @xmath167 that are _ not _ limited by the dynamical nor measurement noise intensities .",
    "in particular , @xmath168 , for large @xmath169 ( see appendix for the details of the derivation ) . on the other hand ,",
    "the uncertainty in the inferred system trajectory @xmath170 is bounded from below by the dynamical and measurement noise .",
    "this effect can appear counterintuitive to a reader , because hidden variables and model parameters are trading against each other in the log - likelihood ( [ eq : action ] ) that could seemingly cause the parameter and trajectory errors to be comparable with each other .",
    "the explanation for the above effect is that the trajectory points @xmath171 at closely spaced instances of time @xmath172 are correlated with each other , those correlations are being extracted and accumulated during the dynamical inference which we presented in the paper and this leads to the shrinking of the parameter error with time below the noise level .",
    "the proposed method should be applicable to a broad range of problems in science and technology ranging from extracting parameters of molecular motors from the measurements of their progression along microtubules  @xcite to the inference of a climate forcing mechanisms from reconstructed from the measurements of carbon dioxide in ocean sediment  @xcite .",
    "we also expect this method to be particularly useful in the context of physiological measurements where it is especially important to relate difficult - to - access parameters to noninvasively - measured data  @xcite .",
    "the open question to be addressed in the near future is an extension of this theory to quantum and spatially extended systems .",
    "within the bayesian framework the problem of dynamical inference is to determine the conditional probability density functional ( pdf ) defined over the set of the unknown quantities @xmath173 , subject to observations @xmath65 .",
    "the later , so - called _ posterior _ pdf , @xmath174 $ ] is found using bayes theorem @xmath175 \\propto \\,p_{\\rm ob}[{{\\bf y}}(t)\\,|\\,{{\\bf x}}(t),{{\\cal m } } ] \\",
    ",      p_{\\rm{pr}}[{{\\bf x}}(t),{{\\cal m}}].\\ ] ] here the missing proportionality coefficient is simply a normalization factor .",
    "@xmath176 $ ] is a so - called _ prior _ pdf that provides the joint statistical information about @xmath18 and @xmath47 before the measurements @xmath65 were made .",
    "the prior pdf can be written in the form : @xmath176={\\cal p}[{{\\bf x}}(t)|\\,{{\\cal m}}]\\,p_0({{\\cal m}})$ ] . here",
    "@xmath177 is some prior distribution of model parameters and @xmath178 $ ] is the pdf of finding a realization of the dynamical trajectory @xmath18 for a given set of the system parameters @xmath47  @xcite .",
    "this functional directly depends on the form of the stochastic dynamical model ( [ eq : sde ] ) and its parametrization .",
    "for example , in the case of the additive white noise considered in ( [ eq : sde ] ) this functional has the form  @xcite @xmath179&\\propto & \\left(\\left(\\frac{2\\pi}{h}\\right)^l { \\rm det}\\hat { { \\bf d}}\\right)^{-{{\\cal k}}/2}\\,\\label{paths}\\\\ & & \\times\\,\\exp\\left[-\\frac{1}{2}\\int_{0}^{t}dt\\left ( { { \\boldsymbol \\nabla}}\\cdot { { \\bf k}}+(\\dot{{\\bf x}}-{{\\bf k}}^t)\\hat   { \\bf d}^{-1}(\\dot{{\\bf x}}-{{\\bf k}})\\right)\\right],\\label{paths }   \\end{aligned}\\ ] ] where @xmath180 , @xmath181 and a coefficient of proportionality is a normalization factor .    in eq.([eq : bayes ] ) @xmath182 $ ] is a conditional pdf to observe the measurement signal @xmath65 for a specific realization of a system trajectory @xmath18 and model parameters @xmath47 . for the continuous - time measurement model considered in ( [ eq : sde ] ) this pdf takes the form @xmath183&=&\\left(\\left(\\frac{2\\pi}{h}\\right)^m { \\rm det}\\hat { { \\bf n}}\\right)^{-{{\\cal k}}/2}\\,\\label{pobs}\\\\ & & \\times\\,\\exp\\left[-\\frac{1}{2}\\int_{0}^{t}dt\\ , \\left({{\\bf y}}(t)-\\hat { { \\bf b}}\\,{{\\bf x}}(t ) \\right)^t{\\hat   { { \\bf n}}}^{-1}\\left({{\\bf y}}(t)-\\hat { { \\bf b}}\\,{{\\bf x}}(t ) \\right)\\right],\\nonumber\\end{aligned}\\ ] ] and describes the zero - mean gaussian statistics of the measurement error @xmath184 . returning back to the original discreet - time measurements",
    "@xmath185 one gets @xmath186 .",
    "prior pdf @xmath187 $ ] usually represents a posterior pdf obtained as a result of the dynamical inference based on the _ previous _ sets of data and on the expert knowledge about possible domains for the system parameters .",
    "often the inference is entirely based on the present set of data and the prior pdf is assumed to be completely uniform . in this case the posterior pdf @xmath188 $ ] in ( [ eq : bayes ] ) is usually referred to as a likelihood pdf .",
    "we denote the later as @xmath189 $ ] and obtain : @xmath190\\propto p_{\\rm ob}[{\\cal y}\\,|{{\\bf x}}(t),{{\\cal m}}]\\,{\\cal p}[{{\\bf x}}(t)|\\,{{\\cal m}}].\\label{py}\\ ] ] using eqs .",
    "( [ paths ] ) and ( [ pobs ] ) in ( [ py ] ) one can rewrite the likelihood pdf in the form @xmath191=a_{{\\cal y}}\\ , \\exp\\left(- s_{{\\cal y}}[{{\\bf x}}(t);{{\\cal m}}]\\right).\\label{like}\\ ] ] where the negative log - likelihood function @xmath36 is given in ( [ eq : action ] ) and @xmath35 is a normalization factor that does not depend on @xmath18 nor @xmath47 .    [",
    "[ calculation - of - the - expectation - values - using - the - maximum - likelihood - estimation . ] ] calculation of the expectation values using the maximum - likelihood estimation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the asymptotic limit of a sufficiently long and dense data record @xmath12 and low noise intensities the pdf @xmath192 $ ] is , generally , a very steep function of its arguments and the derivatives of @xmath36 with respect to @xmath18 and @xmath47 are much greater then 1 ( assuming all quantities are dimensionless ) . in this case",
    "the expectation values of the system trajectory @xmath193 and the model parameters @xmath194 for a given measurement record @xmath12 can be obtained by computing a maximum of the likelihood pdf in the joint space @xmath195 .",
    "the conditions for the maximum have the form of the variational equations @xmath196 that have to be solved simultaneously with the system of the algebraic equations @xmath197",
    "@xmath198 @xmath199 @xmath200 eqs.([cond - x ] ) for the minimum of the action @xmath36 with respect to the trajectory components @xmath16 correspond to the hamiltonian equations ( [ eq : the_hamiltonian]),([eq : he ] ) with the appropriate boundary conditions described in the main text .",
    "inference of the model parameters was considered in @xcite under the simplifying assumptions that the measurement noise is zero , there are no hidden variables and the force field is linear in the parameters @xmath201 ( but generally , nonlinear in @xmath202 ) .",
    "below we provide the generalization of the results of the ref .",
    "@xcite that allows us to infer the unknown parameters of the measurement model and does not relay on the linearity of @xmath40 in @xmath203 .",
    "( [ cond - c ] ) gives the conditions of the minimum of @xmath36 with respect to the parameters @xmath201 of the force field @xmath204 .",
    "using the eq .",
    "( [ eq : action ] ) we obtain these conditions in the following form : @xmath205=\\frac{1}{2}\\int_{0}^{t}dt\\frac{\\partial } { \\partial c_j}\\ , { { \\boldsymbol \\nabla}}\\cdot{{\\bf k}}({{\\bf x}}(t),{{\\bf c}}).\\label{c}\\ ] ] solving the eqs .",
    "( [ cond - d ] ) and ( [ cond - n ] ) with respect to @xmath206 and @xmath207 , respectively , we obtain @xmath208\\,[\\dot x_{j}-k_{j}({{\\bf x}}(t),{{\\bf c}})],\\label{d}\\\\ n_{kl}&=&\\frac{1}{{{\\cal k}}}\\int_{0}^{t}dt\\,[\\dot y_{k}(t)-\\sum_{i=1}^{l}b_{ki}x_{i}(t)]\\,[y_{l}(t)-\\sum_{j=1}^{l}b_{lj}x_{j}(t)]\\label{n}.\\end{aligned}\\ ] ] finally , the eq .",
    "( [ cond - b ] ) can be re - written in the explicit form of the system of linear equations for the matrix elements of @xmath209 @xmath210 where @xmath211 one solves simultaneously eqs .",
    "( [ c])-([w ] ) and the hamiltonian equations ( [ eq : the_hamiltonian]),([eq : he ] ) and selects the solution with the minimum value of @xmath36 .",
    "we now consider how the variances of the model parameters around the maximum of the lpdf depend on the noise intensity and length of the observation record .",
    "we focus on demonstrating of the main effect mentioned in conclusion and for brevity we assume that there are two dynamical variables , one of them , @xmath212 , is hidden , and the other , @xmath213 , is observed with zero measurement error , @xmath214 . we assume that the correlation matrix @xmath215 of the dynamical noise is diagonal with the small nonzero matrix elements @xmath216 .",
    "we also assume that there is only one unknown model parameter @xmath217 and it enters the expression for the vectorial force field @xmath218 .",
    "the action functional in the reduced space @xmath219\\equiv s[x_1(t);c]$ ] has the form @xmath220&=&\\frac{1}{d_{1}}\\int_{0}^{t}dt\\ , \\left[\\frac{1}{2}(\\dot x_1(t)- \\bar k_{1}(x_1(t),y_2(t);c))^2-v(x_1(t),t , c)\\right]\\\\ v(x_1,t , c)&\\equiv&-\\frac{d_{1}}{2 d_{2}}(\\dot y_{2}(t)-k_{2}(x_1,y_2(t);c))-\\frac{d_1}{2}\\,\\sum_{j=1}^{2}\\frac{\\partial k_{j}(x_1,y_2(t);c)}{\\partial x_j}.\\label{sbar}\\end{aligned}\\ ] ] at certain point @xmath221 where the action @xmath222 $ ] reaches its minimum the conditions @xmath223 and @xmath224 are satisfied .",
    "consider now the trajectory @xmath225 corresponding to the _ partial _ minimum of the action with respect to @xmath77 with the value of the model parameter fixed : @xmath226=s[x(t , c),c]$ ] . the hamiltonian equations ( [ eq : he ] ) for @xmath227 have the following form : @xmath228 of central interest for us here is the coefficient of expansion of the action @xmath229 $ ] in @xmath230 @xmath231\\approx \\frac{a}{2 } ( c - c^{\\rm opt})^2,\\quad \\langle \\delta c^2\\rangle = a^{-1},\\label{a}\\ ] ] that equals to the inverse variance of the model parameter @xmath217 . to calculate this coefficient",
    "we expend the trajectory @xmath232 .",
    "then , using ( [ sbar]),([hambar ] ) we obtain in the leading order in @xmath233 @xmath234.\\label{aa}\\ ] ] the function @xmath235 can be obtained from solution of the following system of equations obtained by linearization of equations ( [ hambar ] ) around the hamiltonian trajectory @xmath236 in the extended space ( @xmath237 corresponding to the full minimum of the action @xmath238 $ ] : @xmath239 ( all the partial derivatives of @xmath240 above are evaluated at the arguments @xmath241 and @xmath242 ) .",
    "we note that the integrand in the expression for @xmath243 represents a sum of squares and therefore @xmath243 is a growing function of @xmath169 , implying that the variance @xmath244 shrinks down with @xmath169 .",
    "assume now that the measurement of the trajectory component @xmath245 varies periodically for large @xmath246 ( system approaches a periodic attractor ) .",
    "this variation will play a role of a periodic forcing in eqs .",
    "( [ deta])-([boundary ] ) and the long - time solutions of those equations , @xmath247 will also have a periodic component .",
    "that means that @xmath243 in ( [ aa ] ) is growing at least linearly with @xmath169 , an assertion made in the conclusion .",
    "dynamical inference with hidden variables in systems with chaotic attractors will be considered elsewhere ."
  ],
  "abstract_text": [
    "<S> the problem of determining dynamical models and trajectories that describe observed time - series data ( dynamical inference ) allowing for the understanding , prediction and possibly control of complex systems in nature is one of very great interest in a wide variety of fields . </S>",
    "<S> often , however , in multidimensional systems only part of the system s dynamical variables can be measured . </S>",
    "<S> furthermore , the measurements are usually corrupted by noise and the dynamics is complicated by an interplay of nonlinearity and random perturbations . </S>",
    "<S> the problem of dynamical inference in these general settings is challenging researchers for decades . </S>",
    "<S> we solve this problem by applying a path - integral approach to fluctuational dynamics @xcite , and show that , given the measurements , the system trajectory can be obtained from the solution of the certain auxiliary hamiltonian problem in which measured data act effectively as a control force driving the estimated trajectory toward the most probable that provides a minimum to certain mechanical action . </S>",
    "<S> the dependance of the minimum action on the model parameters determines the statistical distribution in the model space consistent with the measurements . </S>",
    "<S> we illustrate the efficiency of the approach by solving an intensively studied problem from the population dynamics of predator - prey system @xcite where the prey populations may be observed while the predator populations or even their number is difficult or impossible to estimate . </S>",
    "<S> we emphasize that the predator - prey dynamics is fully nonlinear , perturbed stochastically by environmental factors and is not known beforehand ( see e.g.  @xcite ) . </S>",
    "<S> no overall solution was previously available for this problem even in the deterministic case  @xcite . </S>",
    "<S> we apply our approach to recover both the unknown dynamics of predators and model parameters ( including parameters that are traditionally very difficult to estimate ) _ directly _ from measurements of the prey dynamics . </S>",
    "<S> we provide a comparison of our method with the markov chain monte carlo technique . as a further test of the method we demonstrate the reconstruction of the dynamics of chaotic lorenz attractor driven by noise from measurements of only one if its trajectory component </S>",
    "<S> .    1.0 </S>"
  ]
}