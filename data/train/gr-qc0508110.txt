{
  "article_text": [
    "adaptive mesh refinement ( amr ) will be needed for many grid - based numerical approaches designed to solve a variety of problems of interest in numerical relativity , including critical gravitational collapse , binary black hole mergers , and the study of singularity structure in cosmological settings and black hole interiors @xcite .",
    "the reason is that such problems often exhibit a wide range of relevant spatial and temporal length scales that are impossible to adequately resolve with a uniform mesh , given resources available on contemporary computers . in certain restricted scenarios , such as the head - on collision of black holes @xcite , or during the inspiral phase of a circular merger @xcite , it is possible to construct a single , static coordinate grid that can resolve all of the length scales",
    "however , this requires some _ a priori _ knowledge of the structure of the solution that will not be available in general . to date , in numerical relativity , mesh refinement has been used quite effectively in 1d and 2d critical collapse simulations @xcite , the study of critical phenomena in the nonlinear sigma model in 3d minkowski space @xcite , in 2d simulations of cosmological spacetimes @xcite , 3d simulation of gravitational waves and single black holes@xcite , to construct initial data for binary black hole mergers @xcite , and the evolution of binary black hole spacetimes @xcite .    in the following we only consider cauchy evolution",
    "; in other words , we have a timelike coordinate @xmath0 that foliates the spacetime into a set of spacelike slices , and , given initial data at @xmath1 , we want to evolve to the future @xmath2 . in such a coordinate basis the field equations of general relativity consist of a set of 10 , second order , quasi - linear partial differential equations ( pdes ) for 10 metric coefficients that describe the structure of spacetime .",
    "thus , from a lagrangian perspective , one would expect ten dynamical degrees of freedom per point in spacetime , where each degree of freedom is specified by a pair of values  a generalized coordinate and its conjugate momenta ( here , for example , a metric element and its first time derivative )",
    ". however , four of the field equations do not contain second time derivatives of the metric , and therefore serve as _ constraints _ , eliminating four dynamical degrees of freedom ( these four equations are usually called the _ constraint equations _ , and the six remaining equations the _ evolution equations _ ) .",
    "furthermore , the geometry of spacetime is invariant under arbitrary coordinate transformations of the 4 spacetime coordinates , and choosing a particular coordinate system ( or `` gauge '' ) amounts to imposing four additional constraints , leaving only two dynamical degrees of freedom per spacetime point .",
    "the presence of constraints and coordinate freedom in the einstein equations permits considerable leeway in the solution method .",
    "one of the more common methods used these days is so - called _ free evolution _ within the adm ( arnowitt - deser - misner@xcite ) decomposition ( see  @xcite for a thorough discussion of the various possibilities and corresponding classification scheme ) . here , the 4 dimensional spacetime metric is written as a 3 dimensional spatial metric ( 6 independent components ) , _ lapse function _ and a spatial _ shift vector _ ( 3 components )  .",
    "a coordinate system is chosen by specifying the lapse and shift , the constraint equations are solved at the initial time , and the spatial metric is then evolved in time using the evolution equations . in the continuum limit , the bianchi identities ( see @xcite , for example ) guarantee that such an evolution scheme will preserve the constraints for all time , given appropriate boundary conditions .",
    "the constraint equations are elliptic in nature , whereas the evolution equations are hyperbolic .",
    "coordinate conditions can be chosen that give algebraic , elliptic , parabolic or hyperbolic equations for the kinematical variables ( lapse and shift ) .",
    "thus , even though it is always possible in principle to adopt a free evolution approach in the numerical solution of einstein s equations where elliptic equations are only solved at the initial time , there are nonetheless two situations where it may be preferable or necessary to solve one or more elliptic equations at each time step of the evolution .",
    "first , as just mentioned , it may be useful to adopt elliptic coordinate conditions .",
    "for example the choice of _ maximal slicing _ yields an elliptic equation for the lapse function , and the _ minimal distortion _ condition gives a set of elliptic equations for the shift vector components  @xcite .",
    "second , in a numerical evolution , since the bianchi identities will only be satisfied to within truncation error , the constraints can only be preserved to within truncation error  @xcite .",
    "this is not necessarily problematic , as the violation of the constraints should converge away in any consistent , stable numerical code .",
    "however , studies have indicated that with some formulations of the field equations , and using free evolution , certain constraint - violating modes grow exponentially with time , requiring prohibitively high accuracy ( hence resolution ) of the initial data and subsequent evolution to obtain a solution that is sufficiently close to the continuum one for the desired length of time integration@xcite .",
    "one possible method to circumvent this problem is to use _ constrained evolution _ rather than free evolution ; in this case one uses some number , @xmath3 , @xmath4 , of the constraint equations to fix @xmath3 of the dynamical variables , in lieu of the @xmath3 second - order in time equations that would otherwise be used to update those quantities  .",
    "again , the expectation is that a stable numerical code will , in the continuum limit , provide a solution that is consistent with _ all _ of the field equations , including , in this case , those evolution equations that are not explicitly used in the overall update scheme .",
    "( additionally , one hopes that violations in the evolution equations will not grow exponentially in time ) . to date , a significant majority of numerical codes use free evolution@xcite , and with the exception of @xcite all constrained evolution simulations have been carried out in 1d or 2d .    at this point , it is worth noting that there apparently is still an impression in the relativity community as a whole that elliptic equations are computationally expensive , and are thus to be avoided in numerical evolution if at all possible .",
    "however , provided that appropriate algorithms  such as the multigrid method  are adopted , this view is not consistent with at least some experience ( see also @xcite for fast elliptic solvers using spectral methods ) . in particular , as we will show below , the solution of the elliptic equations in our adaptive code requires roughly twice the cpu time required to solve the hyperbolic equations ; furthermore , the solution cost of the elliptics scale _ linearly _ with the size of the computational domain .",
    "thus , if one considers that in a free evolution an equivalent number of hyperbolic equations would need to be solved in lieu of the elliptic equations , the difference in cost is _ not _ a significant issue in deciding whether to tackle a particular problem using constrained versus free evolution .",
    "we are thus lead to consider amr algorithms for mixed elliptic / hyperbolic type , where our use of the term `` hyperbolic '' does not denote any formal definition of hyperbolicity , but instead is used to refer to an equation that is characterized by locality of influence .",
    "now , a very well known amr algorithm for hyperbolic equations is due to berger and oliger ( b&o )  @xcite .",
    "this algorithm has several important properties that make it quite useful and efficient in solving certain classes of problems .",
    "these properties include dynamical regridding via local truncation error ( te ) estimates , a grid - hierarchy composed of unigrid ( single mesh ) building blocks , and a recursive time - stepping algorithm that provides `` optimal '' efficiency in solving discretized evolution equations that are subject to a cfl - type stability condition .",
    "however , this algorithm , implemented verbatim for a mixed elliptic / hyperbolic system _ can not _ be expected to work in general , due in part to the non - local nature of elliptic equations , and in part to the non - linear nature of the elliptic equations that tend to arise in numerical relativity .",
    "the reasons for this are as follows ( a more detailed discussion is given in sec .",
    "[ sec_orig_bo ] and sec .",
    "[ sec_mod_bo ] ) . in the b&o time - stepping procedure , a single ,",
    "large time step is taken on a coarser level before several smaller time steps are taken on the interior , fine level .",
    "this is done so that the solution obtained on the coarse level can be used to set boundary conditions ( via interpolation in time ) for the subsequent fine level evolution . as the hierarchy is generated via local truncation error estimates , the solution obtained on the coarse level in the vicinity of the fine level boundaries",
    "will presumably be sufficiently accurate to allow one to use the coarse level solution to set fine level boundary conditions without adversely affecting the global solution .",
    "if the equations are hyperbolic , then a poorly resolved solution in the interior region of the coarse level will not have time to `` pollute '' the coarse / fine boundary region in only a single coarse level evolution step ( and the coarse level solution is refreshed every time step with the fine level solution in the injection phase of the algorithm ) .",
    "this last statement is not true for elliptic equations in general , for then poorly resolved source functions in the interior of the coarse level could globally affect the accuracy of the solution obtained during the coarse level evolution step . for certain kinds of linear elliptic equations , such as the poisson equation in newtonian gravity , or",
    "that arising in the incompressible navier - stokes equations , one can circumvent this problem by taking advantage of conservation laws satisfied by source fields that couple to the elliptic equtions ( for example , with the poisson equation in newtonian gravity one can use a fine to coarse level injection function that preserves the matter energy density , and see for example @xcite for a method for solving the navier - stokes equations with b&o style time sub - cycling ) . in general relativity the equations are non - linear , and furthermore are coupled in such a manner that it is impossible to isolate such source functions in general .",
    "therefore , to use b&o amr in a constrained evolution , in particular its time - stepping algorithm , requires some modifications to deal with the elliptic equations ; these modifications are the prime focus of this paper .    in sec .",
    "[ sec_graxi ] , we first review the axisymmetric gravitational collapse code introduced in @xcite that was used to develop the amr approach described in this paper .",
    "this code solves a discretized version of the einstein - klein gordon system of equations .",
    "we then review the original berger and oliger algorithm in sec .",
    "[ sec_orig_bo ] , and then proceed to a description of the modifications we have made to handle elliptic equations in sec .",
    "[ sec_mod_bo ] .",
    "our primary modification involves a split of the solution of the elliptic equations into two phases . during the first phase ,",
    "when hyperbolic equations are solved , functions satisfying elliptic equations are extrapolated to the advanced time level .",
    "the second phase is delayed until all finer levels have been evolved in the same fashion via recursion , and hence all levels at the same or finer resolution as the given one are in sync ( i.e.  have been evolved to the same physical time ) .",
    "then , the elliptic equations are solved over the _",
    "entire _ sub - hierarchy from the given level to the finest , using _ extrapolated _ boundary conditions from the parent ( coarser ) level at interior coarse - grid boundaries . in sec .",
    "[ sec_results ] we present several simulation results , including convergence tests and comparison with unigrid simulations . concluding remarks",
    "are given in sec .",
    "[ sec_conclusion ] .",
    "all equations and finite - difference operators are listed in app .",
    "[ appendix ] , and some additional details of the amr algorithm are given in app .",
    "[ algorithm_details ] .",
    "in this section we briefly review the physical system we are modeling ( general relativity with a scalar field matter source ) , the pdes governing the model , and the unigrid numerical code that computes an approximate finite - difference solution of the pdes ; additional details can be found in @xcite .",
    "the einstein field equations can be written as @xmath5 where @xmath6 is the ricci tensor , @xmath7 is the ricci scalar ( using the einstein summation convention where repeated indices are summed over ) , and we use geometric units where newton s constant , @xmath8 , and the speed of light , @xmath9 , are set to 1 @xcite . with a massless scalar field @xmath10 as the matter source , the stress - energy tensor @xmath11 is given by @xmath12 and the evolution of @xmath10 is governed by the wave equation @xmath13 in these expressions a comma ( , ) is used to denote a partial derivative , and a semicolon ( ;) a covariant derivative .    restricting attention to axisymmetric spacetimes without angular momentum , and choosing cylindrical coordinates , @xmath14 , adapted to the symmetry , we can write the spacetime metric as @xmath15 . \\label{metric}\\ ] ]",
    "the axial killing vector is @xmath16 and hence all the metric functions @xmath17 and @xmath18 , and the scalar field @xmath10 depend only on @xmath19 and @xmath0 . almost all coordinate freedom has been eliminated by choosing this form for the metric .",
    "what remains to be specified is a time - slicing , and for this we use maximal slicing , defined by @xmath20 where @xmath21 is the trace of the extrinsic curvature tensor @xmath22 of @xmath23 slices @xcite .",
    "this gives an elliptic equation for @xmath24 ( [ slicing_eqn ] ) .",
    "the constraint equation subset of ( [ einstein_tens ] ) gives 3 additional elliptic equations : the _ hamiltonian constraint _",
    ", which is viewed as an equation for @xmath25 ( [ hc_eqn ] ) , and the @xmath26 and @xmath27 components of the _ momentum constraint _ , which are treated as equations for @xmath28 ( [ brho_eqn ] ) and @xmath29 ( [ bz_eqn ] ) , respectively .",
    "one member of the evolution subset of ( [ einstein_tens ] ) yields a second order evolution equation for @xmath18 , and the wave equation ( [ phi_eom ] ) provides a second order hyperbolic equation for @xmath10 .",
    "we convert both of these evolution equations to first - order - in time - form ( [ omegabar_eqn],[pi_phi_eqn ] ) by defining conjugate variables @xmath30 ( geometry ) and @xmath31 ( matter ) as follows :    @xmath32_{,\\rho}\\ ] ]    @xmath33    thus we end up with a system of @xmath34 equations for @xmath34 variables@xmath35 and @xmath29 satisfy elliptic equations , and @xmath36 and @xmath31 satisfy hyperbolic equations .      on the axis at @xmath37 ,",
    "the following regularity conditions must be enforced in order that spacetime remain locally flat in the vicinity of the axis : @xmath38 at the outer boundaries @xmath39 , @xmath40 and @xmath41 , for the hyperbolic variables approximate outgoing radiation ( sommerfeld ) conditions are imposed   falloff . ] , while for the elliptic equations , conditions based on asymptotic flatness conditions are used : @xmath42      the set of @xmath34 pdes are solved using second - order accurate finite difference ( fd ) techniques .",
    "the elliptic equations are solved using an fas ( full approximation storage ) multigrid algorithm with @xmath43-cycling @xcite . at @xmath1 , @xmath36 and @xmath31",
    "are freely specified , after which the remaining variables @xmath44 and @xmath25 are obtained by solving the corresponding elliptic equations . to evolve the variables with time",
    ", the hyperbolic equations are discretized using an iterative crank - nicholson scheme , with kreiss - oliger@xcite dissipation added to reduce unwanted ( and un - physical ) high - frequency solution components ( `` noise '' ) of the fd equations .",
    "this iteration involves variables at two time levels : the known solution at @xmath45 , and the unknowns , solved for using newton - gauss - seidel relaxation implemented in rnpl @xcite , at @xmath46 .",
    "after each iteration , the elliptic variables are updated at @xmath47 by applying a single @xmath43-cycle .",
    "this process is repeated until the infinity norm of the residual of all equations is below some specified tolerance .",
    "the pseudo - code in fig .",
    "[ ngs_iteration ] summarizes this iteration sequence :     +   +  as an initial guess to the solution at time @xmath48 , copy variables +  from @xmath49 to @xmath48 ; +   +  repeat +  perform 1 newton - gauss - seidel relaxation sweep of the +  evolution equations , solving for the unknowns at time @xmath48 ; +  perform 1 multigrid vcycle on the set of elliptic equations , +  discretized at time @xmath48 ; +  until ( residual norm < tolerance ) +   +    specific difference operators used to discretize the equations are summarized in app .",
    "[ app_fde ] .",
    "here we briefly review some aspects of the b&o amr algorithm for hyperbolic pdes that are of relevance to this paper , in particular the grid hierarchy and time - stepping procedure .      in the berger and oliger amr algorithm , the computational domain is decomposed into a hierarchy of uniform meshes ( see fig .",
    "[ bo_mesh_struct ] ) with the following properties :    * the hierarchy contains @xmath50 _ levels_. each level @xmath51 contains grids of the same resolution ",
    "the coarsest grids are in level @xmath52 ( the _ base grid _ ) , the next - coarsest in level @xmath53 , and so on until level @xmath50 , which contains the finest grids in the hierarchy . *",
    "the ratio of discretization scales @xmath54 between levels @xmath51 and @xmath55 is called the _ spatial refinement ratio _ @xmath56 .",
    "@xmath56 is typically an integer greater than or equal to 2 .",
    "for simplicity , we will also assume that @xmath56 is the same for all levels , and therefore use the symbol @xmath57 to denote the spatial refinement ratio .",
    "* all grids at level @xmath55 ( _ child _ grids ) are _ entirely _ contained within grids at level @xmath51 ( _ parent _ grids ) .",
    "grids at the same level may overlap . * in the simplified variant of the b&o algorithm described here , we require that all grids within the hierarchy share the same coordinate system . in particular , this implies that all grid boundaries run parallel to the corresponding boundaries of the computational domain .",
    "in addition , a child grid must be aligned relative to its parent grid such that all points on the parent grid , within the common overlap region , are coincident with a point on the child level . the original b&o algorithm allowed for a child grid to be rotated relative to its parent .    ) , beginning with level 1 for the coarsest mesh .",
    "the upper diagram shows the computational domain , covered by a three - level - deep hierarchy .",
    "the plots below this demonstrate how the hierarchy is stored in memory , namely as a collection of individual grids .",
    "thus a given point , @xmath58 in the computational domain can be contained / represented in multiple grids in the berger and oliger scheme .",
    "[ bo_mesh_struct],width=604 ]    the particular grid structure that exists at any given time is calculated by computing local truncation error estimates , so that at any point @xmath59 within the computational domain the finest grid covering that point has sufficient resolution to adequately resolve all features of the solution there .",
    "this is an important property of the grid hierarchy , not only for the obvious reason of providing the desired resolution everywhere , but it justifies the use of the b&o time - stepping algorithm to evolve the hierarchy , as we now review .",
    "the b&o recursive time - stepping algorithm was designed to solve hyperbolic equations , discretized on the amr grid hierarchy .",
    "the basic ideas behind this update scheme are as follows .",
    "the hierarchy is evolved in time through a particular sequence of unigrid time - steps , performed on individual grids within the hierarchy . a time step of size @xmath60",
    "is taken on all grids at level @xmath51 , _ before _ a number @xmath61 ( the _ temporal refinement ratio _ ) time steps of size @xmath62 are taken on level @xmath55 .",
    "the preceding rule is applied recursively , from the coarsest to finest level in the hierarchy . in general",
    ", @xmath61 must be an integer greater than or equal to @xmath56 in order to satisfy the cfl condition on all levels in the hierarchy if it is satisfied on the coarsest level .",
    "as with @xmath57 , we only consider a constant temporal refinement ratio @xmath63 for all levels .",
    "the reason why a time step is first taken on coarse level @xmath51 is that the solution obtained there at time @xmath64 is then used to set boundary conditions , via interpolation in time , for the subsequent time steps on the finer level @xmath55 ( unless some portion of the fine level abuts the boundary of the computational domain , in which case the physical / mathematical boundary conditions of the original problem can be applied . )",
    "it is possible to do this because the solution obtained on the coarse level in the vicinity of the finer level boundary will be _ as accurate _ , to within the specified truncation error , as a putative solution would have been that was obtained on a fine level encompassing the entire computational domain .",
    "the solution obtained on the coarse level interior to this boundary will not be as accurate ; however , the assumed hyperbolic nature of the pdes will protect this inaccuracy from polluting the coarse / fine boundary region within a single coarse level time step .",
    "after @xmath63 time - steps on level @xmath55 , when the solution on grids at levels @xmath51 and @xmath55 are again in synchrony , grid functions from level @xmath55 are _ injected _ into the coarse grids at level @xmath51 , in the region of overlap between the two levels .",
    "thus , the most accurate solution available at a given point @xmath65 is continuously propagated to all grids in the hierarchy that contain @xmath65 .",
    "injection simply consists of copying values from level @xmath55 to level @xmath51 at common points ( in the more general b&o algorithm , where finer levels can be rotated relative to coarser levels , the injection step requires some form of interpolation ) .",
    "[ bo1_ts_fig ] is a pseudo code description of the b&o time - stepping procedure just described .",
    "+  repeat @xmath66 times : call single_step(1 ) ; +  stop ; +   +  subroutine single_step(level @xmath51 ) +  if ( regridding time for level @xmath51 ) then +  regrid from levels @xmath51 to @xmath50 ; +  end if +   +  if ( @xmath51 > 1 ) then +  set boundary conditions along amr boundaries at time +  @xmath67 via interpolation from level ( @xmath68 ) ; +  end if +   +  perform 1 evolution step on all grids at level @xmath51 ; +   +  @xmath69 ; +   +  if ( @xmath70 ) then +  repeat [ @xmath71 times : call single_step(@xmath55 ) ; +  inject the solution from level @xmath55 to level @xmath51 +  in the region of overlap between levels @xmath51 and @xmath55 ; +  end if +   +  end of subroutine single_step +",
    "the locality argument given in the preceding section to justify the use of the b&o evolution algorithm is only applicable to hyperbolic equations , for then the finite speed of propagation prevents contamination of the solution in the boundary region of a coarse level by a poorly resolved solution in the interior .",
    "solutions to elliptic equations do not share this property , and therefore it is not feasible to solve for such equations on the coarse grid alone , with the intention of supplying boundary conditions for subsequent fine grid time steps . one way to circumvent this problem",
    "is to abandon the b&o recursive time - stepping procedure . in other words",
    ", one could evolve the entire hierarchy forward in time with a global time step , for example by performing a crank - nicholson style iteration as in the unigrid code ( see sec .",
    "[ sec_unigrid ] ) .",
    "a major drawback to this method is that , to satisfy the cfl condition , the global time step will need to be set to @xmath72 , where @xmath73 is the cell size on the _ finest _ level @xmath50 in the hierarchy , and @xmath74 is a constant .",
    "this would require that one take @xmath75 additional time steps at level @xmath51 for each time step that the usual @xmath76 algorithm would have taken .",
    "the technique that we propose here to incorporate elliptic equations into the standard b&o time - stepping framework is to employ a combination of _ extrapolation and delayed solution _ of the elliptic variables ( see fig .  [ bo_ts_fig2 ] ) .",
    "simply stated , on coarse levels one does _ not _ solve the elliptic equations during the evolution step of the algorithm ; rather , one extrapolates the corresponding variables to the advanced time from the solution obtained at earlier times .",
    "the solution of the elliptic equations is delayed until _",
    "after _ the injection of fine grid ( level @xmath55 ) values into the parental coarse grids ( level @xmath51 ) . at that stage ,",
    "all levels from @xmath51 to @xmath50 are in sync , and the elliptic equations are solved over the _ entire resulting subset _ of the hierarchy , with boundary conditions on amr boundaries of level @xmath51 set via extrapolation .",
    "this ensures that all details from finer grids interior to level @xmath51 are represented in the solution .",
    "+  repeat @xmath66 times : call single_step(1 ) ; +  stop ; +   +  subroutine single_step(level @xmath51 ) +  if ( regridding time for level @xmath51 ) then +  regrid from levels @xmath51 to @xmath50 ; +  end if +   +  for hyperbolic variables : if ( @xmath77 ) then set boundary conditions along +  amr boundaries at time ( @xmath67 ) via interpolation from level @xmath68 ; +   +  for elliptic variables : extrapolate the entire grid function to time +  ( @xmath67 ) from earlier - time values ; +   +  repeat +  if ( @xmath78 ) then perform 1 multigrid vcycle on elliptic variables +  at time ( @xmath67 ) ; +  perform 1 iteration of the crank - nicholson sweep for all +  hyperbolic variables ; +   until ( residual norm < tolerance ) +   +  @xmath69 ; +   +  if ( @xmath70 ) then +  repeat [ @xmath71 times : call single_step(@xmath55 ) ; +  compute the truncation error estimate for level @xmath55 by subtracting +  the solution in the region of overlap between levels @xmath51 and @xmath55 ; +  inject the solution from level @xmath55 to level @xmath51 +  in the region of overlap between levels @xmath51 and @xmath55 ; +  end if +   +  if ( @xmath79 or ( @xmath70 and @xmath80 ) ) then +  @xmath81 ; +  do @xmath82 to @xmath50 +  for each elliptic variable @xmath83 : @xmath84 ; +  end do +  re - solve the elliptic equations over the sub - hierarchy [ @xmath85 at time @xmath0 ; +  do @xmath82 to @xmath50 +  for each elliptic variable @xmath83 : +  @xmath86 ; +  @xmath87 ; +  @xmath88 ; +  end do +  end if +   +  end of subroutine single_step +    one of the non - trivial aspects of this technique is the method used to extrapolate the elliptic variables , which we now describe .",
    "we use linear ( 2nd order ) extrapolation in time , with periodic _ corrections _ to try to account for changes that occur upon global multigrid solves . for level @xmath51 , @xmath89 , the two past - times used in the extrapolation",
    "are the two most recent times _ when levels @xmath51 and @xmath68 were in sync _ ( thus , at times when a solution of the elliptic variables involving at least levels @xmath68 to @xmath50 was obtained ) ; in other words , every @xmath63 steps we save the elliptic variables for use in extrapolation for extrapolation resulted in unstable evolution . ]",
    "( see sec .",
    "[ sec_grid_init ] for a pseudo - code description of how the past time levels are initialized for the very first time step of evolution ) . for level @xmath79 ,",
    "the two most recent time levels are used for extrapolation is _ always _ fully refined because of the self - shadow hierarchy mechanism we use for truncation error estimation ( see sec .",
    "[ sec_ss ] ) , and therefore level 2 should be considered the `` true '' coarsest level of the hierarchy ( in effect , level 1 is only used for truncation error estimation ) ] .",
    "the correction , applied only to levels @xmath89 , is calculated as follows . whenever level @xmath51 is in sync with level @xmath90 , where @xmath91 , a multigrid solve takes place over levels @xmath92 .",
    "denote by @xmath93 the value of a variable @xmath94 at level @xmath51 , calculated via extrapolation from @xmath95 and @xmath96 , and let @xmath97 denote the value of the same variable _ after _ the multigrid solve at time @xmath0 ( note that for simplicity in notation we have dropped the spatial coordinate dependence of the variable @xmath94 ) . as illustrated in fig.[mg_extrap_fig",
    "] , the correction contains two components : @xmath98 which are used to change the _ past _ time value @xmath99 as follows : @xmath100 the logic behind this form of correction stems from a couple of observations about how the re - solved solution differs from the extrapolated solution , and how some adaptive solutions differ from unigrid solutions of comparable resolution .",
    "first , in general @xmath101 is ( in a loose sense ) proportional to @xmath102 ; i.e.  the more levels over which the elliptic equations are re - solved , the larger the change in the interior , finer level @xmath51 solution .",
    "however , the change in the interior part of the solution induced by the global solve tends to be a near constant shift , leaving finer details of the interior solution unchanged .",
    "second , the local `` velocity '' @xmath103 ( calculated _ prior _ to the correction ) tends to be represented quite accurately in the adaptive solution scheme .",
    "therefore the @xmath101 part of the correction preserves this velocity for subsequent extrapolation , and is in fact essential for the stability of the algorithm with a deep hierarchy , as then the global shift is often larger in magnitude than the local velocity .",
    "the second part of the correction @xmath104 is an attempt to improve the accuracy of the extrapolation , for if in hindsight the quantity @xmath104 had been added to @xmath94 at each one of the @xmath105 intermediate time steps between solves over levels @xmath106 , then @xmath101 would be zero at time @xmath0 ( ignoring , of course , the effect that this putative correction would have had on the solution ) .",
    "from @xmath107 to @xmath0 , assuming that @xmath108 and @xmath70 . initially",
    "( step 1 ) , @xmath109 at @xmath0 is calculated via linear extrapolation from data at past times @xmath110 and @xmath111 ( quantities used for extrapolation are depicted by boxes in the diagram ) .",
    "this value , labeled @xmath93 , is used during the solution of the hyperbolic variables ( via crank - nicholson iteration ( cn ) here ) . at time @xmath0 , we assume levels @xmath51 and @xmath112 are in sync , and so after the cn iteration ( and _ after _ the equations on finer levels @xmath113 have been evolved to @xmath0 ) the elliptic equations are re - solved over levels @xmath106 ( step 2 ) .",
    "this results in a change in the value of @xmath94 from @xmath93 to @xmath97 ( for simplicity we assume that a similar change that occurred at time @xmath110 is zero ) .",
    "this change is propagated back to @xmath110 , so that the same velocity @xmath114 , _ modulo a correction _",
    "@xmath104 , will be used to extrapolate @xmath94 to @xmath115 ( step 3 ) . here , since @xmath116 , the correction is such that one is effectively extrapolating from @xmath111 and @xmath0 to time @xmath115 ; this would not be the case otherwise  see ( [ mg_ext_cor]-[mg_ext_ap_cor ] ) .",
    "( if @xmath78 , then the elliptic variables are solved within the cn iteration , and the value obtained afterward is used for @xmath93 . )",
    "[ mg_extrap_fig],width=529 ]    one last comment regarding the extrapolation : on the finest level of the hierarchy , the elliptic equations are solved via the usual interleaved crank - nicholson/@xmath43-cycle iteration as discussed in sec .  [ sec_unigrid ] ; then the extrapolation simply serves to set boundary conditions .",
    "the extrapolation technique described in the previous section is rather ad - hoc , though both the choice of which past times to extrapolate from and the use of corrections play a significant role in the stability and accuracy of the adaptive evolution code . in this section we present some results showing the effectiveness of the algorithm .",
    "the first test of the algorithm presented here is a comparison of unigrid evolutions to a similar amr evolution ( test results on the convergence properties of the unigrid code can be found in @xcite ) .",
    "specifically , we compare an evolution obtained with the amr code to a unigrid evolution , where the entire unigrid mesh is given the resolution @xmath117 of the finest level in the amr hierarchy . to gauge",
    "how well the amr solution approximates the unigrid one , we then compare the unigrid solution to that obtained with two additional unigrid runs , with resolutions of @xmath118 and @xmath119 . in certain respects",
    "this is not a very stringent test , as limited computational resources do not allow us to run using very high resolution unigrid simulations ( which of course is the motivation for pursuing amr ) .",
    "also , the accuracy of the amr solution will largely depend on the structure of the grid hierarchy , which is ( predominantly ) controlled by the maximum allowed te .",
    "thus , in principle one could obtain better agreement between the amr and unigrid simulations by decreasing the te parameter while keeping the maximum depth of the amr hierarchy fixed .",
    "nevertheless , this comparison _ does _ demonstrate that the adaptive algorithm works in practice .",
    "the initial data for this example is a time symmetric scalar field pulse : @xmath120,\\ ] ] with @xmath121 and @xmath122 ( all other free fields are set to @xmath123 at @xmath1 ) .",
    "this amplitude is sufficiently large that the solution is in the non - linear regime ( and thus close to forming a black hole ) .",
    "the outer boundary is at @xmath124 .",
    "the maximum value for the te is set to @xmath125 ( only @xmath10 and @xmath31 are used in the calculation of the te  see app .",
    "[ algorithm_details ] ) .",
    "the resolution of the base grid is @xmath126 , with @xmath127 , and up to @xmath128 additional levels of refinement .",
    "thus , level @xmath129 has an effective resolution of @xmath130 , and so we choose unigrid comparison runs with resolutions of @xmath130 ( @xmath117 ) , @xmath131 ( @xmath118 ) and @xmath132 ( @xmath119 ) .",
    "the courant factor is @xmath133 for all runs , and the physical time at the end of each simulation is @xmath134 ( which corresponds to 480 time steps on the level with the finest resolution ) .",
    "[ fig_psi_ad_t2 ] shows a plot of the conformal factor @xmath25 at @xmath135 from the adaptive simulation , with grid bounding boxes overlaid to give an idea of the structure of the hierarchy adaptively generated by the amr code .",
    "[ fig_l2_uni_comp ] shows @xmath136 norms of the differences between the solutions generated by the @xmath117 resolution unigrid simulation and the two lower resolution unigrid and adaptive simulations . for brevity",
    "we only show differences for the @xmath129 elliptic variables ; differences in the hyperbolic variables exhibit similar behavior .",
    "what fig .  [ fig_l2_uni_comp ] demonstrates is that , compared to the @xmath117 unigrid simulation , the adaptive solution has accuracy comparable to the @xmath118 simulation , and significantly greater accuracy than the @xmath119 simulation , even though ( as illustrated in fig .",
    "[ fig_psi_ad_t2 ] ) the majority of the coordinate domain in the adaptive solution is spanned by a grid with less resolution that either that of the @xmath118 or @xmath119 simulations .",
    "[ fig_ddt_comp ] is a comparison of the time - difference of the maximum ( or minimum , as appropriate ) of the elliptic variables @xmath137 and @xmath29 from the @xmath117 unigrid and adaptive simulations .",
    "the time - difference @xmath138 is calculated as @xmath139 , where @xmath140 denotes one of the quantities , @xmath141 or @xmath29 at time step @xmath142 .",
    "[ fig_ddt_comp ] demonstrates two interesting aspects of the extrapolation scheme of the adaptive code .",
    "first , the high frequency temporal `` noise '' that is apparent in the adaptive solution of the elliptic variables ( and that has been exaggerated in the figure by taking a time - difference ) does not adversely affect the accuracy of the solution on average .",
    "second , the presence of such noise suggests why linear extrapolation at level @xmath51 from the most recent times of level @xmath51 is unstable ; however , it is not so obvious why extrapolation from past times that are in - sync with a parent level ( @xmath68 or less ) results in stable evolution .",
    "note that with the particular system of equations solved for here ( summarized in app .",
    "[ appendix ] ) _ no _ explicit time derivatives of any elliptic quantities appear .",
    "furthermore , during the evolution phase of the algorithm ( see sec .",
    "[ sec_unigrid ] ) , the crank - nicholson differencing scheme only couples the time average ( over two time steps ) of elliptics variables to the hyperbolic equations , providing a certain amount of temporal smoothing .",
    "thus , the results shown in fig .",
    "[ fig_ddt_comp ] suggest that modifications to the extrapolation scheme may be needed for systems of pdes that use other methods to difference in time , or if time derivatives of variables solved for using elliptic equations couple to the hyperbolic equations .     at @xmath135 from the adaptive simulation discussed in sec .",
    "[ sec_res_comp ] , where the height of the surface is proportional to the magnitude of @xmath25 ( ranging approximately from @xmath52 at the outer boundary to @xmath143 at the origin @xmath144 ) . overlaid on the surface",
    "are the amr grid bounding boxes ",
    "the smallest , interior box has the finest resolution , corresponding to an effective unigrid resolution of @xmath130 .",
    "[ fig_psi_ad_t2],width=529 ]     and @xmath29 , as discussed in sec .",
    "[ sec_res_comp ] .",
    "shown here are @xmath136 norms of differences between the solution generated by the @xmath117 resolution ( @xmath145 ) unigrid simulation and each of the solutions produced by two lower resolution unigrid simulations , @xmath118 ( @xmath131 ) and @xmath119 ( @xmath132 ) , and an adaptive simulation ( see fig .",
    "[ fig_psi_ad_t2 ] for a representative sample of the mesh structure from the amr solution at @xmath135 , where the base level @xmath52 has resolution @xmath126 , and the finest level @xmath129 has the same resolution as the @xmath117 unigrid run ) .",
    "thus , we are using the @xmath117 unigrid solution as a benchmark , and the plots show that the adaptive solution is of comparable accuracy to the @xmath118 unigrid solution , and of significantly greater accuracy than the @xmath119 unigrid solution , despite that the majority of the coordinate domain of the amr solution is covered by grids with mesh spacing @xmath146 satisfying @xmath147 . [ fig_l2_uni_comp],width=604 ]     resolution ( @xmath130 ) unigrid and adaptive simulations results as discussed in sec .",
    "[ sec_res_comp ] , showing the time - difference of the maximum ( or minimum , as appropriate ) of the elliptic variables @xmath137 and @xmath29 . for clarity , only about @xmath148 time - steps are shown , and the differences for @xmath24 and @xmath25 have been scaled by constants to fit all the plots on the same vertical scale .",
    "the time - difference @xmath138 is calculated as @xmath139 , where @xmath140 labels one of the above quantities at time step @xmath142 .",
    "these figures demonstrate a couple of interesting aspects of the extrapolation scheme for the adaptive code .",
    "first , the high frequency `` noise '' that is apparent in the adaptive solution ( which has been exaggerated here by taking a time - difference ) does not adversely affect the accuracy of the solution on average .",
    "second , the presence of such noise suggests why linear extrapolation from the most recent time levels is unstable ( though it is not obvious why extrapolation from past time levels that are in - sync with a parent level results in stable evolution ) .",
    "[ fig_ddt_comp],width=604 ]      we conclude this section by presenting timing information in tab .",
    "[ tab_time ] below for the comparison test just described .",
    "this serves to show that , at least for the elliptic - hyperbolic system considered here , the overhead of the amr algorithm is negligible , and that the solution time scales roughly linearly with the total number of grid points in the discrete solution .",
    "see also sec .",
    "[ sec_timing2 ] , which contains more detailed information on the percentage of time spent in various stages of the algorithm for the test simulations presented in the next section .",
    ".timing information for the tests described in sec.[sec_res_comp ] .",
    "the _ runtime _ is the wall time taken ( on a 2.4ghz intel xeon processor ) , in seconds , for each simulation , including initial data calculation and evolution .",
    "the _ total number of grid points _ is a count of all the grid points , in space and time , at which a solution was obtained during the simulation .",
    "this includes the grid points used during calculation of the initial data , and the calculation of the initial hierarchy for the adaptive run .",
    "the _ average time per grid point _",
    "( in microseconds ) is the runtime divided by the total number of grid points . what these numbers suggest ( see also tab .",
    "[ tab_time2 ] is that the computational cost of this solution method scales approximately linearly with the total number of grid points , and that the computational overhead for the adaptive algorithm is negligible .",
    "note however that we have _ not _ taken into account that in the adaptive hierarchy certain coordinate locations are covered by multiple points , and therefore there is some `` wastage '' in the amr calculation . in this particular simulation , at any one time between @xmath149 of the points in the adaptive hierarchy were redundant , and this should be viewed as an additional ( and unavoidable ) overhead to the per - point cost of this berger and oliger style amr algorithm . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]",
    "in this paper we have discussed modifications of the standard berger and oliger adaptive mesh refinement method , so that the resulting algorithm can solve systems resulting from the discretization of _ coupled , non - linear , hyperbolic and elliptic equations _ in _ linear time_. moreover , as we have retained recursive time - stepping , the algorithm is still optimally efficient in solving systems that contain hyperbolic equations which are subject to a cfl stability condition .",
    "the initial application that drove development of the method was a study of critical gravitational collapse of the scalar field in axisymmetry @xcite .",
    "this involved the approximate solution of a mixed elliptic / hyperbolic system : the coupled einstein - klein gordon system in a certain coordinate system , with a particular choice among the overdetermined set of pdes at our disposal to advance the solution in time .",
    "however , the algorithm is sufficiently general that it can be applied to a variety of similar systems of partial differential equations .",
    "for example , there are numerous problems in astrophysics that need to evolve various matter equations coupled to gravity and/or the electromagnetic field , including cosmological structure formation , stellar evolution , supernovae , jets , accretion disks , etc .",
    "many of these scenarios have a large range of spatio - temporal length scales that need to be modeled , and can benefit tremendously from berger and oliger style amr . in some situations",
    "newtonian gravity is sufficient to accurately describe the physics , and due to the linearity of the poisson equation , modifications to berger and oliger as described here are not strictly necessary .",
    "however , some of the most interesting astrophysical events occur in regions where gravity is sufficiently strong that nonlinear effects become important , and the algorithm described in this paper could be of significant use in such simulations .    with regards to new applications of this algorithm in numerical relativity , of particular interest is constrained evolution in 3d , which , on the basis of substantial 1d and 2d evidence@xcite , we have long felt has great potential for the study of problems such as black hole collisions , critical gravitational collapse , and the structure of black hole interiors .",
    "all of the aforementioned lower dimensional studies made use of the symmetries in the problem , in addition to particular coordinate choices , to obtain well - posed coupled elliptic / hyperbolic systems , and so there is some skepticism in the community about whether constrained evolution can be implemented for general problems in 3d .",
    "though recently a fully constrained 3d evolution scheme was proposed in @xcite , based on the dirac gauge and spherical coordinates ( the implementation presented in @xcite made use of a multidomain spectral solution method ) .",
    "a potential disadvantage of this system is that it is not obvious how to generalize it beyond spherical coordinates , which are not well adapted to studying problems that are far from spherical symmetry .",
    "a formulation of the einstein equations that is amenable to 3d constrained evolution and _ can _ be written in cartesian coordinates was described in @xcite .",
    "both of these formulations are prime candidates for numerical implementation using our amr algorithm .",
    "fp would like to thank bernd brgmann for helpful suggestions on an earlier version of the manuscript .",
    "the authors gratefully acknowledge research support from ciar , nserc , nsf phy-0099568 , nsf phy-0244906 , and caltech s richard chase tolman fund .",
    "the simulations described here were performed on ubc s * vn * cluster ( supported by cfi and bckdf ) , and the * maci * cluster at the university of calgary ( supported by cfi and asra ) .    1 l. lehner , `` numerical relativity : a review '' , _ class .",
    "* 18 * , r25 ( 2001 ) . c. gundlach ,",
    "`` critical phenomena in gravitational collapse '' , _ living rev .",
    "rel . 2 1999 - 4 _ b. berger , `` numerical approaches to spacetime singularities '' , _ living rev .",
    "2002 - 1 _ l. smarr , `` the structure of general relativity with a numerical illustration : the collision of two black holes '' , _ univ . of texas at austin ph.d .",
    "thesis _ ( 1975 ) b. brgmann , w. tichy , n. jansen , `` numerical simulation of orbiting black holes '' , _ phys .",
    "lett . _ * 92 * , 211101 ( 2004 ) m. d. duez , p. marronetti , s. l. shapiro , t. w. baumgarte , `` hydrodynamic simulations in 3 + 1 general relativity '' , _ phys.rev . _ * d67 * , 024004 ( 2003 ) m.w",
    ". choptuik , `` universality and scaling in gravitational collapse of a massless scalar field '' , _ phys .",
    "lett . _ * 70 * , 9 ( 1993 ) r.s .",
    "hamade and j.m .",
    "stewart , `` the spherically symmetric collapse of a massless scalar field '' , _ class .",
    "_ * 13 * , 497 ( 1996 ) r.s .",
    "hamade , j.h .",
    "horne and j.m .",
    "stewart , `` continuous self - similarity and s - duality '' , _ class .",
    "* 13 * , 2241 ( 1996 ) m.w .",
    "choptuik , t. chmaj and p. bizon , `` critical behaviour in gravitational collapse of a yang - mills field '' , _ phys .",
    "lett _ * 77 * , 424 ( 1996 ) m.w .",
    "choptuik , e.w .",
    "hirschmann , s.l .",
    "liebling and f. pretorius , `` critical collapse of the massless scalar field in axisymmetry '' , _ phys .",
    "rev . _ * d 68 * , 044007 ( 2003 ) m.w .",
    "choptuik , e.w .",
    "hirschmann , s.l .",
    "liebling and f. pretorius , `` critical collapse of a complex scalar field with angular momentum '' , _ phys .",
    "lett _ * 93 * , 131101 ( 2004 ) s.l .",
    "liebling and m.w .",
    "choptuik `` black hole criticality in the brans - dicke model '' , _ phys .",
    "lett _ * 77 * , 1424 ( 1996 ) m.w .",
    "choptuik , e.w .",
    "hirschmann and s.l .",
    "liebling , `` instability of an ` approximate black hole ' '' , _ phys .",
    "* d 55 * , 6014 ( 1997 ) s.l .",
    "liebling , `` the singularity threshold of the nonlinear sigma model using 3d adaptive mesh refinement '' , _ phys.rev . _ * d 66 * , 041703 ( 2002 ) s. hern , `` numerical relativity and inhomogeneous cosmologies '' , phd dissertation , cambridge ( 1999 ) ,",
    "gr - qc/0004036 b. brgmann , `` adaptive mesh and geodesically sliced schwarzschild spacetime in 3 + 1 dimensions '' , _ phys .",
    "* d 54 * , 7361 ( 1996 ) p. papadopoulos , e. seidel and l. wild , `` adaptive computation of gravitational waves from black hole interactions '' , _ phys .",
    "rev . _ * d 58 * , 084002 ( 1998 ) k.c.b .",
    "new , d. choi , j.m .",
    "centrella , p. macneice , m.f .",
    "huq and k. olson , `` three - dimensional adaptive evolution of gravitational waves in numerical relativity '' , _ phys .",
    "* d62 * , 084039 ( 2000 ) e. schnetter , s. h. hawley and i. hawke `` evolutions in 3d numerical relativity using fixed mesh refinement '' ,",
    "_ class.quant.grav . _ * 21 * , 1465 ( 2004 ) b. imbiriba et al , `` evolving a puncture black hole with fixed mesh refinement '' , _",
    "phys.rev . _",
    "* d70 * , 124025 ( 2004 ) f. pretorius , `` numerical relativity using a generalized harmonic decomposition '' , _ class.quant.grav . _",
    "* 22 * , 425 ( 2005 ) p. diener , n. jansen , a. khokhlov and i. novikov , `` adaptive mesh refinement approach to construction of initial data for black hole collisions '' , _ class .",
    "* 17 * , 435 ( 2000 ) j. d. brown and l. l. lowe , `` distorted black hole initial data using the puncture method '' , _ phys.rev . _ * d70 * , 124014 ( 2004 ) j. d. brown and l. l. lowe , `` multigrid elliptic equation solver with adaptive mesh refinement '' , _ j.comp.phys _ * 209 * , 582 ( 2005 ) f. pretorius , `` evolution of binary black hole spacetimes '' , qr - qc/0507014 ( 2005 ) c.w .",
    "misner , k.s .",
    "thorne and j.a .",
    "wheeler , _ gravitation _ , new york , w.h .",
    "freeman and company ( 1973 ) r. arnowitt , s. deser and c.w .",
    "misner , in _ gravitation : an introduction to current research _ , ed",
    ". l. witten , new york , wiley ( 1962 ) t.  piran , `` numerical codes for cylindrical relativistic systems '' , _",
    "phys . _ * 35 * , 254 ( 1980 ) m.w .",
    "choptuik , `` consistency of finite difference solutions of einstein s equations '' , _ phys .",
    ", _ * d44 * 3124 , ( 1991 ) _ gravitation _ , new york , w.h .",
    "freeman and company ( 1973 ) a.s .",
    "almgren , j.b .",
    "bell , p. colella , l.h .",
    "howell and m.l .",
    "welcome ,  a conservative adaptive projection method for the variable density incompressible navier - stokes equations `` , _ j.comput.phys . _ _ 142_,1 ( 1998 ) m.w .",
    "choptuik , e.w .",
    "hirschmann , s.l .",
    "liebling and f. pretorius , `` an axisymmetric gravitational collapse code '' , _ class .",
    "grav . _ * 20 * , 1857 ( 2003 ) l. lindblom , m. a. scheel , `` energy norms and the stability of the einstein evolution equations '' , _ phys.rev . _ * d66 * , 084014 ( 2002 ) h. shinkai and g. yoneda , `` re - formulating the einstein equations for stable numerical simulations : formulation problem in numerical relativity '' , gr - qc/0209111 m. anderson and r. a. matzner , `` extended lifetime in computational evolution of isolated black holes '' , gr - qc/0307055 r. a. matzner , `` hyperbolicity and constrained evolution in linearized gravity '' , _ phys.rev . _ * d71 * , 024011 ( 2005 ) m. holst , l. lindblom , r. owen , h. p. pfeiffer , m. a. scheel and lawrence e. kidder , `` optimal constraint projection for hyperbolic evolution systems '' , phys.rev . *",
    "d70 * , 084017 ( 2004 ) s. bonazzola , e. gourgoulhon , p. grandclement and j. novak , `` a constrained scheme for einstein equations based on dirac gauge and spherical coordinates '' , _ phys.rev . _ * d70 * , 104007 ( 2004 ) j.w .",
    "york , in _ sources of gravitational radiation _",
    "l. smarr , seattle , cambridge university press ( 1978 ) h. p. pfeiffer , l. e. kidder , m. a. scheel and s. a. teukolsky `` a multidomain spectral method for solving elliptic equations '' _ comput",
    "commun . _ * 152 * , 253 ( 2003 ) f. pretorius and l. lehner `` adaptive mesh refinement for characteristic codes '' , _ j.comp.phys . _ * 198 * , 10 ( 2004 ) m.j .",
    "berger and j. oliger , `` adaptive mesh refinement for hyperbolic partial differential equations '' , _ j. comp .",
    "phys . _ * 53 * , 484 ( 1984 ) f. pretorius , `` numerical simulations of gravitational collapse '' , _ univ . of british columbia ph.d .",
    "( 2002 ) h. kreiss and j. oliger , `` methods for the approximate solution of time dependent problems '' , _ global atmospheric research programme , publications series no .",
    "_ ( 1973 ) r.l .",
    "marsa and m.w .",
    "choptuik , `` the rnpl user s guide '' , + http://laplace.physics.ubc.ca/members/marsa/rnpl/users_guide/users_guide.html ( 1995 ) a. brandt , `` multi - level adaptive solutions to boundary - value problems '' , _ math .",
    "comput . _ * 31 * , 330 ( 1977 ) u. trottenberg , c. oosterlee and a. schuller , _ multigrid _ , london , academic press 2001 m.w .",
    "choptuik , `` a study of numerical techniques for the initial value problem in general relativity '' , _ univ . of british columbia",
    "thesis _ ( 1982 ) m.w .",
    "choptuik and w.g .",
    "unruh , ' ' an introduction to the multi - grid method for numerical relativists \" , _ general relativity and gravitation _ * 18 * , 813 ( 1986 ) j. bardeen and t. piran , `` general relativistic axisymmetric rotating systems : coordinates and equations '' , _ phys .",
    "_ * 96 * , 205 ( 1983 ) r.f .",
    "stark and t. piran , `` gravitational - wave emission from rotating gravitational collapse '' , _ phys .",
    "lett . _ * 55 * , 891 ( 1985 ) c.r .",
    "evans , in _ dynamical spacetimes and numerical relativity _",
    "j. centrella , cambridge , cambridge university press ( 1986 ) t. nakamura , k. oohara and y. kojima , `` general relativistic collapse of axially symmetric stars '' , _ prog .",
    "suppl . _ * 90 * , 13 ( 1987 ) c.r .",
    "evans , in _ frontiers in numerical relativity _ , ed .",
    "evans , l.s .",
    "finn and d.w .",
    "hoboll , cambridge , cambridge university press ( 1989 ) s.l .",
    "shapiro and s.a .",
    "teukolsky , `` formation of naked singularities : the violation of cosmic censorship '' , _ phys . rev",
    ". lett . _ * 66 * , 994 ( 1991 ) a.m. abrahams and c.r .",
    "evans , `` trapping a geon : black hole formation by an imploding gravitational wave '' , _ phys .",
    "rev . _ * d46 * , r4117 ( 1992 ) .",
    "a.m. abrahams and c.r .",
    "evans , `` critical behavior and scaling in vacuum axisymmetric gravitational collapse '' , _ phys .",
    "lett . _ * 70 * , 2980 ( 1993 ) .",
    "a.m. abrahams , g.b .",
    "cook , s.l .",
    "shapiro and s.a .",
    "teukolsky , `` solving einstein s equations for rotating spacetimes : evolution of relativistic star clusters '' , _ phys .",
    "* d 49 * , 5153 ( 1994 ) g. b. cook , s. l. shapiro , s. a. teukolsky `` testing a simplified version of einstein s equations for numerical relativity '' , _",
    "phys.rev . _ * d53 * , 5533 ( 1996 ) h. dimmelmeier , j. a. font and e. mueller , `` relativistic simulations of rotational core collapse .",
    "i. methods , initial models , and code tests '' , _ astron .",
    "astrophys . _ * 388 * , 917 ( 2002 ) d. garfinkle and g.c .",
    "duncan , `` numerical evolution of brill waves '' , _ phys.rev .",
    "d63 _ , 044011 ( 2001 ) i. olabarrieta and m. w. choptuik , `` critical phenomena at the threshold of black hole formation for collisionless matter in spherical symmetry '' , _",
    "phys.rev . _ * d65 * , 024007 ( 2002 ) j. f. ventrella and m. w. choptuik , `` critical phenomena in the einstein - massless - dirac system '' _ phys.rev . _ * d68 * , 044020 ( 2003 ) l. andersson and v. moncrief , `` elliptic - hyperbolic systems and the einstein equations '' , _",
    "annales henri poincare _ * 4 * , 1 ( 2003 ) s.f .",
    "mccormick and j. thomas , _ mathematics of computation _ * 46 * , 439 ( 1986 ) d. choi , private communication . m.j .",
    "berger and i.rigoutsos , `` an algorithm for point clustering and grid generation '' , _ ieee trans .",
    "21 _ * no . 5 * ( 1991 )",
    "here , for completeness , we list all of the equations introduced in section [ sec_graxi ] , and the specific set of finite difference operators used to discretize them .",
    "summarizing section [ sec_graxi ] , the four - metric is @xmath150\\right ) dt^2 + 2\\psi^4\\left({\\beta^\\rho}d\\rho + { \\beta^z}dz\\right ) dt \\nonumber\\\\ + \\psi^4\\left(d\\rho^2 + dz^2 + \\rho^2 e^{2\\rho{\\bar{\\sigma } } } d\\phi^2\\right)\\end{aligned}\\ ] ] the conjugate variable to the scalar field @xmath10 is @xmath31 ( [ phi_eqn ] ) , and the conjugate to @xmath18 is @xmath30 ( [ omegabar_def ] ) .",
    "all of these variables are functions of @xmath19 and @xmath0 .",
    "the maximal slicing condition results in the following elliptic equation for @xmath24 : @xmath151     - \\frac{\\psi^4}{6\\alpha } \\left [                                      2 \\alpha \\rho { \\bar{\\omega}}+ \\beta^\\rho{}_{,\\rho }                                    - \\beta^z{}_{,z }                                   \\right]^2     - 16 \\pi \\alpha \\pi^2 = 0 \\label{slicing_eqn}\\end{aligned}\\ ] ] the hamiltonian constraint is @xmath152     + { \\psi^4 \\over 6\\alpha^2 }          \\left [ 2\\alpha\\rho\\bar{\\omega }            + \\beta^\\rho{}_{,\\rho }            - \\beta^z{}_{,z }    \\right]^2 \\nonumber\\\\   =               - 16 \\pi \\left ( \\pi^2 + \\phi_{,\\rho}{}^2 + \\phi_{,z}{}^2 \\right )              -   6 \\left ( \\rho^2 \\left(\\rho { \\bar{\\sigma}}\\right)_{,\\rho } \\right)_{,\\rho^3 } \\nonumber\\\\              -   2 \\left ( \\left ( \\rho { \\bar{\\sigma}}\\right)_{,\\rho } \\right)^2              -   2 \\left ( \\rho { \\bar{\\sigma}}\\right)_{,zz }              -   2 \\left ( \\left ( \\rho { \\bar{\\sigma}}\\right)_{,z    } \\right)^2   \\label{hc_eqn}\\end{aligned}\\ ] ] the @xmath26 and @xmath27 momentum constraints are @xmath153   - \\frac{8}{3 } \\alpha \\bar{\\omega }   -\\frac{2 \\alpha \\rho } { 3 } \\left [                                       6 { \\bar{\\omega}}\\frac{\\psi_{,\\rho } } { \\psi }                                     + { \\bar{\\omega}}_{,\\rho }                                     + 3 { \\bar{\\omega}}\\left(\\rho { \\bar{\\sigma}}\\right)_{,\\rho }                                     \\right]=0 , \\label{brho_eqn}\\end{aligned}\\ ] ] and @xmath154         \\left ( \\beta^\\rho{}_{,z } + \\beta^z{}_{,\\rho } \\right ) \\nonumber\\\\     + \\left [    2 \\left ( \\rho { \\bar{\\sigma}}\\right)_{,z }              - \\frac{4}{3 } \\left (     \\frac { \\alpha_{,z } } { \\alpha }                                  - 6 \\frac { \\psi_{,z }    } { \\psi    } \\right )             \\right ]         \\left ( \\beta^z{}_{,z } - \\beta^\\rho{}_{,\\rho } \\right )   - \\frac{2 \\alpha\\rho}{3 } \\left (                                    6 { \\bar{\\omega}}\\frac{\\psi_{,z}}{\\psi }                                  + { \\bar{\\omega}}_{,z }                                 \\right ) \\nonumber\\\\   + 32\\pi { \\alpha \\over \\psi^2 } \\pi_{,z }   - 2\\alpha({\\bar{\\sigma}}_{,z})\\rho^2{\\bar{\\omega}}=0 \\label{bz_eqn}\\end{aligned}\\ ] ] the definition of @xmath30 ( [ omegabar_def ] ) gives an evolution equation for @xmath18 : @xmath155_{,\\rho}\\ ] ] the evolution equation for @xmath30 is @xmath156      + 64\\pi{\\alpha\\over \\psi^4 } \\rho ( \\phi_{,\\rho^2})^2 \\label{omegabar_eqn}\\end{aligned}\\ ] ] the definition of @xmath31 and the wave equation for @xmath10 give @xmath157 and @xmath158       + \\frac{\\alpha}{\\psi^2 } \\left [                                       \\left ( \\rho { \\bar{\\sigma}}\\right)_{,\\rho } \\phi_{,\\rho }                                     + \\left ( \\rho { \\bar{\\sigma}}\\right)_{,z    } \\phi_{,z }                                    \\right ] \\label{pi_phi_eqn}\\end{aligned}\\ ] ]    the maximal slicing condition @xmath159 gives an independent hyperbolic evolution equation for @xmath25 : @xmath160      the set of axis regularity conditions , applied at @xmath37 are : @xmath161 the outer boundary conditions used , applied at @xmath39 , @xmath40 and @xmath41 , are : @xmath162      in this section , we write out all of the difference operators used to convert the differential equations in the previous section to finite difference equations . at all interior points of the mesh ,",
    "the centered forms of the derivate operators are used , and along boundaries , backward and forward operators are used as appropriate .",
    "kreiss - oliger style dissipation is applied to evolution equations , at interior points at least two grid points inward , in the direction of the stencil , from any boundary . for @xmath18 and @xmath30 , we linearly interpolate in @xmath26 at location @xmath163 ( and optionally at @xmath164 as well ) , using the values of these variables at @xmath37 and @xmath165 ( or @xmath166 ) .",
    "below , we use the notation @xmath167 to label a point in the mesh corresponding to coordinate location @xmath168 ( except for the coordinate variable @xmath26 , where it is sufficient to use @xmath169 ) . for time derivatives ,",
    "we use @xmath170 to denote the retarded time level , and @xmath171 the advanced time level .",
    "all of the finite - difference operators are @xmath172 order accurate .",
    "@xmath173      @xmath174      @xmath175      the following dissipation operator is applied in the @xmath26 direction : @xmath176 and in the @xmath27 direction : @xmath177 where @xmath178 .",
    "this appendix contains descriptions of a few additional features of the amr algorithm described in the paper : computing te estimates using a self - shadow hierarchy , details of how the multigrid algorithm is applied to an adaptive hierarchy , and a description of the particular set of interpolation and restriction operators used .",
    "a self - shadow hierarchy is a simplification of the idea of using a _",
    "shadow hierarchy _ to do truncation error estimation .",
    "a shadow hierarchy is a coarsened ( usually with @xmath179 version of the main hierarchy .",
    "both hierarchies are evolved simultaneously , and the function values of a given grid in the shadow hierarchy are replaced with those of the corresponding grid in the main hierarchy whenever the two are in sync .",
    "for example , with @xmath180 , each time step of a shadow grid corresponds to two time steps of the main grid , and the shadow is updated every two main - grid time steps . a te estimate",
    "can therefore readily be computed by comparing function values in the shadow with corresponding values in the main hierarchy just before the update step .",
    "notice however , that within the recursive time - stepping flow of the berger and oliger algorithm , information for computing a te estimate is `` naturally '' available prior to the fine - to - coarse grid injection step ( see fig .",
    "[ bo_ts_fig2 ] ) .",
    "the coarse level @xmath51 is evolved independently of the fine level @xmath55 from @xmath49 to @xmath181 , where @xmath182 is the coarse level time step .",
    "also , at @xmath45 the level @xmath51 grid functions are restricted copies of level @xmath55 grid functions in the region of overlap @xmath183 .",
    "therefore , prior to injection at time @xmath181 , the difference in an evolved variable @xmath94 in levels @xmath51 and @xmath55 , within the region @xmath183 , can serve as an approximation to the truncation error @xmath184 for @xmath94 at level @xmath55 : exist , then in the overlap @xmath185 the estimate ( [ tau_s_def ] ) will be modified by an amount of order @xmath186 . ]",
    "@xmath187 therefore , for levels @xmath89 , one can use ( [ tau_s_def ] ) as the basis for computing truncation error estimates , without the need to refer to a shadow hierarchy ( i.e. , the main hierarchy `` casts its own shadow '' , hence the name self - shadow hierarchy ) .",
    "this method can not give a te estimate for the coarsest level ( 1 ) in the hierarchy , and so we require that the coarsest level always be fully refined .",
    "thus , the resolution of level 2 is chosen to match the desired coarsest resolution for a given problem ( for the sample evolutions described in in sec .",
    "[ sec_results ] , level 2 is always quoted as the base level ) .    in practice ,",
    "a slightly modified form of @xmath188 is used , as we now describe . depending upon the problem ,",
    "one or more of @xmath25 , @xmath10 , @xmath189 , @xmath30 , and @xmath18 are used in the calculation ( i.e. , all evolved quantities@xmath25 is not used when the hamiltonian constraint is used to solved for @xmath25 in a fully constrained evolution ) .",
    "optionally , the truncation error estimate is scaled by the norm of the function , if the norm is larger than some constant @xmath190 ( @xmath191 typically ) , and can also be multiplied @xmath192 , for some integer @xmath193 chosen heuristically to either enhance or reduce the near - axis refinement . the te estimate for a function @xmath109 at level @xmath51",
    "is thus defined to be @xmath194 where it is implied that @xmath109 is only defined in the overlap between levels @xmath51 and @xmath68 , @xmath109 is restricted to the resolution of level @xmath68 prior to subtraction , and the result is then interpolated back to the resolution of level @xmath51 .",
    "typically , we use @xmath195 for @xmath30 , @xmath196 for @xmath18 , and @xmath197 for the other variables . the te estimate for the level",
    "is defined to be @xmath198 where the sum is taken over the desired subset of variables listed above .",
    "optionally , the te estimate calculated in ( [ ref_tre_l ] ) is further smoothed ( using simple averaging over a 5-by-5 square cell of points ) , and/or scaled by a quantity @xmath199 in the region of overlap between levels @xmath51 and @xmath55 .",
    "@xmath200 therefore provides a kind of `` hysteresis '' to the truncation error estimation process : when the te estimate in a region of level @xmath51 grows above @xmath201 , that region is refined ; however , for the region to be unrefined at a later time , the te estimate needs to drop below @xmath202 there . in most of the simulations we keep @xmath203 ,",
    "though occasionally it has proven useful to set it to around @xmath204 .      the fas multigrid algorithm , with @xmath43-cycling , that we use to solve elliptic equations on a grid hierarchy such as that shown in fig .",
    "[ bo_mesh_struct ] is based on brandt s multi level adaptive ( mlat ) scheme @xcite , and is similar to that used in @xcite . to simplify the algorithm",
    ", we require that @xmath205 for some integer @xmath206 ; then the amr hierarchy can easily be extended to incorporate the multigrid levels , which have a refinement ratio @xmath207 of 2:1 .",
    "when building the multigrid hierarchy , each amr grid is individually coarsened by factors @xmath207 ( i.e. factors of 2 ) until either a ) one dimension of the grid is smaller that the minimum allowed , or b ) the coarsened grid can be `` absorbed '' into a larger grid at that level in hierarchy . with this type of hierarchy",
    "the @xmath43-cycle begins with relaxation of the finest level grids only .",
    "then as the finer levels are coarsened they are absorbed , if possible , into coarser levels .",
    "this method of relaxation on an adaptive hierarchy is in contrast to the fast adaptive composite grid method@xcite , though we do not believe that the particular details of how the elliptic equations are solved have much bearing on the algorithm described here for dealing with coupled elliptic / hyperbolic equations .",
    "a couple of minor points regarding the details of the multigrid solution are worth mentioning .",
    "first , inter - level operations , such as restriction , computing coarse - grid corrections , etc . , are only performed in the region of overlap between the two levels ( which is _ always _ the region of the fine level , given the kind of hierarchies that are produced by b&o amr ) .",
    "second , the manner in which the relaxation sweep proceeds over a level is modified , to account for possible grid overlap , as follows . during the relaxation sweep ,",
    "the variables at a given coordinate location and level are relaxed _ only once _ , regardless of the number of grids encompassing that location .",
    "this is crucial in order to preserve the smoothing properties of the relaxation scheme .",
    "we use a mask function to enforce this requirement of a single update per grid point .",
    "the mask is initialized to zero on all grids at that level , prior to a relaxation sweep . then ,",
    "on a given level , a sweep is applied , in turn , to each grid in the level , but only variables at points where the mask is equal to zero are modified .",
    "after the sweep is complete on a given grid , the mask is set to one throughout the grid , and the mask and other grid functions are copied to overlapping grids at the same level .",
    "therefore , subsequent relaxation sweeps on adjacent grids skip over points that have already been relaxed .",
    "this communication step , in addition to enforcing a single update per point , ensures that grid functions are numerically unique at all physical grid locations , which is important for preserving the convergence properties of multigrid .",
    "also , although dirichlet boundary conditions are used at interior boundaries ( i.e. those not abutting boundaries of the computational domain ) of any single grid , the communication ensures that points interior to a union of grids are ultimately updated using the pdes , even if they lie on the boundary of some grid in the overlap region .    with regards to the performance of this multigrid scheme on a general adaptive hierarchy",
    ", there are two situations of relevance where performance could suffer , compared to the single grid multigrid algorithm .",
    "the first occurs when , at some level down ( coarser ) in the multigrid hierarchy , one or more grids in a connected union of grids is a `` coarsest grid '' , and hence needs to be solved `` exactly'' see fig .",
    "[ mg_cprob ] .",
    "experimentation showed that the _ entire union _ needs to be solved exactly in that situation ; i.e. it is not sufficient to solve the equations exactly on the coarsest grids , then proceed down the @xmath43-cycle on the remaining grids .",
    "if the union of grids consists of a relatively small number of grid points , then such a situation will not be a problem ; otherwise , there will be a significant slow - down of the code , for the speed of an exact solve suffers dramatically as the number of unknowns increase . to date",
    ", we have been able to avoid this potential speed bottleneck by using a more simplistic clustering method that does not produce grid - overlap , as discussed in the following section .",
    "the second situation where performance suffers is when the te estimate requires long , skinny rectangular regions to be refined .",
    "this does occur with the more prolate initial data configurations that have been studied @xcite .",
    "what happens then , is that such an elongated grid can not be coarsened very much along the larger grid dimension before the smaller dimension has reached the smallest allowed size .",
    "again , this results in a relatively large number of points on the coarsest grid where the solution needs to be obtained exactly . as of yet",
    "this problem has not been addressed .",
    "we have incorporated two clustering routines into the code .",
    "the first , written by reid guenther , mijan huq and dale choi @xcite , is based upon the signature - line method of berger and rigoutsos @xcite .",
    "the second is a simple routine that produces single , isolated clusters  each isolated region of high te is surrounded by a single cluster , and then all clusters within a certain distance of each other are merged together into an encompassing cluster . for the problems studied so far , the isolated cluster method turns out to be almost as efficient as the signature - line method . therefore , since efficiency is not an issue , the isolated cluster method is preferable , because it avoids one of the potential speed - bottlenecks of the multigrid algorithm discussed in section [ sec_mg_ad ] ; furthermore , as mentioned in section [ sec_hf_gb_noise ] , minimizing cluster overlap helps reduce high - frequency noise problems .    a clustering issue that needs to be dealt with in this code",
    "is that the resultant grid hierarchy must be compatible with the multigrid solver .",
    "this places two restrictions on cluster sizes and positions .",
    "first , an individual grid must have dimensions that can be factored into @xmath208 , where @xmath209 is one of the smallest , allowed grid dimensions , and @xmath142 is a non - negative integer .",
    "second , if several grids overlap , then their relative positions must be such that the common grid points align on all possible levels of a multigrid hierarchy . specifically ,",
    "if a union of overlapping grids can collectively be coarsened @xmath3 times in the multigrid hierarchy , then the relative offsets of grid origins on the finest level must be multiples of @xmath210 grid points .",
    "these requirements are enforced after the initial clustering algorithm is called , by modifying the returned cluster list accordingly .",
    "this gives more flexibility to experiment with different clustering routines , which consequently do not need to be aware of the alignment issues .    to conclude this section we mentioned a couple of additional options that have been implemented in the post - clustering routine .",
    "they are adding `` ghost zones '' between adjacent , touching clusters , so that both the multigrid and evolution relaxation sweeps correctly solve the system of equations in a domain given by the union of grids at a given level ; and optionally moving or shrinking clusters , if necessary , to prevent them from touching parent boundaries , which helps to avoid instabilities that occasionally occur in such situations .      here",
    "we state the restriction and interpolation operators used in the amr code .",
    "simple injection is used to restrict a fine grid to a coarse grid during the injection phase of the amr algorithm , and when computing the te estimate . a fourth order",
    "( bi - cubic ) interpolation scheme is used to initialize newly refined fine grids ( or regions thereof ) from the encompassing coarser grid .",
    "the scheme proceeds by first interpolating every row of the coarse grid to the fine grid ( i.e. every @xmath57th row of the fine grid is filled in ) , then all the remaining points on the fine grid are computed via interpolation , column - by - column . the multigrid routine uses half - weight restriction when transferring from a fine to coarse grid , and linear interpolation for the coarse to fine transfer .",
    "+  t:=0 ; +  initialize the grid hierarchy with @xmath53 levels , each covering the entire domain ; _ ( so @xmath211 ) _",
    "+   +  repeat +  @xmath212 ; +  call set_initial_data ( ) ; _ ( see below ) _ +  call set_past_t_data_1st_order ( ) ; _ ( see below ) _ +  call",
    "single_step(1 ) ; _ ( see fig.[bo_ts_fig2 ] ) _ +  regrid the entire hierarchy using truncation error estimates +  computed in the previous step ; _ ( thus possibly changing @xmath50 ) _",
    "+  reset @xmath0 to @xmath213 while retaining the current hierarchy structure ; +  until @xmath214 or maximum number of refinement levels reached +   +  call set_initial_data ( ) ; +  call set_past_t_data_1st_order ( ) ; +   +  call single_step(1 ) ; _ ( evolve hierarchy * forwards * in time one coarse step ) _ +  call",
    "flip_dt ; _ ( see below ) _",
    "+   +  call single_step(1 ) ; _ ( evolve hierarchy * backwards * in time one coarse step ) _ +  call flip_dt ; +   +  call set_initial_data ( ) ; +   +  _ ( done computing initial data and hierarchy ) _",
    "+   +  subroutine set_initial_data ( ) +  initialize hyperbolic variables over levels @xmath215 $ ] with freely - specifiable data ; +  solve the elliptic equations over levels @xmath215 $ ] ; +  end of subroutine set_initial_data +   +  subroutine flip_dt ( ) +  for each elliptic variable @xmath216 : @xmath217 ; +  do @xmath218 to @xmath50 +  for each elliptic variable @xmath219 : @xmath220 ; +  @xmath221 ; +  end do +  end of subroutine flip_dt +   +  subroutine set_past_t_data_1st_order ( ) +  do @xmath222 to @xmath50 +  for each elliptic variable @xmath219 : @xmath223 ; +  end do +  end of subroutine set_past_t_data_1st_order +      an issue that needs to be dealt with in a berger & oliger style amr scheme is controlling high - frequency solution components ( `` noise '' ) that may occur at parent - child grid boundaries . for a second order",
    "accurate finite - difference scheme , the second derivatives of grid functions are typically not continuous across the boundaries after child to parent injection .",
    "this potential source of high - frequency noise on the parent level is rather efficiently eliminated by the kreiss - oliger dissipation filters we incorporate into our finite differenced evolution equations .    in certain situations",
    "we have found that high - frequency noise also develops on child grids , within a grid point or two of the amr boundary ( in particular near the corners of the grid , or places where two grids overlap ) .",
    "this noise is not as easily dealt with , as the kreiss - oliger filter acting normal to the boundary is only applied a distance three points and further away from the boundary .",
    "the source of this noise appears to be the parent - child interpolation scheme used to set the boundary values , and in general the interpolation method must be tailored to each variable in order to reduce the noise to an acceptable level . for out",
    "current model , we use the following interpolation method . for all evolved variables ( @xmath224 and @xmath25 ) we use linear interpolation in time from the parent level to set boundary values on the child grid at points coincident with parent grid points .",
    "this is followed by fourth - order interpolation in space ( as described in section [ sec_ip_ops ] ) for the remaining boundary points .",
    "furthermore ( see fig .",
    "[ fig_bar_interp ] and [ pseudo_bar_interp ] ) , after each step of the crank - nicholson iteration we reset @xmath30 and @xmath18 in a zone two grid points in from amr boundaries with values obtained either 1 ) by fourth order interpolation using function values from the boundary and three additional points inward from this zone , or 2 ) via bilinear interpolation at `` corner '' points , i.e. those points that are a single cell width away from two boundaries . this technique for @xmath18 and @xmath30 was discovered after quite a bit of experimentation with different interpolation schemes , and is quite effective in reducing the level of noise at the grid boundaries .     and",
    "@xmath30 during amr evolution . in the figure",
    "we assume that the spatial refinement ratio is @xmath225 , and that all four grid boundaries are amr boundaries .",
    "points labeled by ( 1 ) and ( 2 ) are set once prior to the crank - nicholson ( cn ) iteration , while points labeled by ( 3 ) , ( 4 ) and ( 5 ) are reset after every cn step ( see the pseudo - code in fig .",
    "[ pseudo_bar_interp ] ) .",
    "points not explicitly labeled are `` interior '' points , and are evolved .",
    "[ fig_bar_interp],width=529 ]    for the elliptic variables ( @xmath226 , @xmath29 and optionally @xmath25 ) , prior to a crank - nicholson evolution cycle , we reset these variables on amr boundaries at points unique to the grid ( in between points coincident with parent level points  those labeled by ( 2 ) in fig .",
    "[ fig_bar_interp ] ) using fourth order interpolation from the remaining points on the boundary .",
    "this overwrites the values set by coarse - grid corrections ( cgcs ) during the most recent multigrid solve that involved coarser levels .",
    "the reason for doing this is as follows . in multigrid ,",
    "cgcs typically introduce high - frequency noise on the finer level , while the subsequent post - cgc relaxation sweeps smooth out this noise . however , since no relaxation is applied on amr boundaries , some form of explicit smoothing is required  the above described fourth order interpolation provides this smoothing mechanism .",
    "another stage in the algorithm where high - frequency noise can creep into the solution is during the regridding phase , if the refined region on a given level expands .",
    "then , within the part of a new grid overlapping the old refined region , grid functions will be initialized by copying data from an old fine grid , while on the remaining part of the new grid the grid functions will be initialized via interpolation from a parent grid .",
    "sometimes , at the interface between the copied / interpolated data , tiny discontinuities are introduced .",
    "the grid functions are then easily smoothed by applying a kreiss - oliger filter to them ( at all time levels involved ) after regridding ."
  ],
  "abstract_text": [
    "<S> we present a modification to the berger and oliger adaptive mesh refinement algorithm designed to solve systems of coupled , non - linear , hyperbolic and elliptic partial differential equations . </S>",
    "<S> such systems typically arise during constrained evolution of the field equations of general relativity . </S>",
    "<S> the novel aspect of this algorithm is a technique of `` extrapolation and delayed solution '' used to deal with the non - local nature of the solution of the elliptic equations , driven by dynamical sources , within the usual berger and oliger time - stepping framework . </S>",
    "<S> we show empirical results demonstrating the effectiveness of this technique in axisymmetric gravitational collapse simulations , and further demonstrate that the solution time scales approximately linearly with problem size . </S>",
    "<S> we also describe several other details of the code , including truncation error estimation using a self - shadow hierarchy , and the refinement - boundary interpolation operators that are used to help suppress spurious high - frequency solution components ( `` noise '' ) . </S>"
  ]
}