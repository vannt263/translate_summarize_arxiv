{
  "article_text": [
    "this is the second paper in a series of two where we discuss stationary solutions to the nlse on metric graphs  that is _ nonlinear quantum graphs_. in the first paper @xcite we have developed a framework that allows to reduce the solution of the wave equation with matching conditions at the vertices to a finite set of nonlinear algebraic equations and we have derived a low intensity approximation scheme for the nonlinear transfer operator that expresses the wave function and its derivative at one end of an edge in terms of their values at the other end .",
    "+ nonlinear quantum graphs have received increasing attention in the mathematical and theoretical physics literature recently as a model that allows to study the interplay between topology and nonlinear wave propagation in a relatively simple but non - trivial setting .",
    "we refer to our first paper @xcite for a detailed overview of the recent literature .",
    "+ in this paper we focus on the stationary cubic nlse and we apply the framework and the approximation scheme to a number of basic open and closed graph structures . in order to keep this",
    "paper self - contained we summarise the relevant exact framework for nonlinear quantum graphs and the approximate solutions of the cubic nlse using canonical perturbation theory in the remainder of this section . in section  [ stationary ]",
    "we consider the spectral curves of some basic examples with increasing complexity : the interval , the ring , star graphs and the tadpole ( aka lollipop or lasso ) graph .",
    "for all these examples we derive a finite set of nonlinear algebraic equations that describe the spectrum of the nonlinear graph and the corresponding wave functions . in the low - intensity limit",
    "we show how the equations reduce to a single secular equation for the spectrum that is well known for linear quantum graphs . in a short wavelength",
    "limit we show how canonical perturbation theory simplifies the nonlinear equations and may be used in order to describe genuine nonlinear effects such as the appearance of new solutions via bifurcations .",
    "+ in section  [ scattering ] we consider stationary scattering on open graphs where one or two nonlinear edges are connected to a small number of leads .",
    "we assume linear wave propagation on the leads and derive exact equations that describe the nonlinear scattering of stationary waves . in the small wavelength limit",
    "we show how canonical perturbation theory simplifies the nonlinear equations that describe genuine nonlinear effects .",
    "we explicitly show how multi - stability occurs in some settings .",
    "+ in section  [ conclusion ] we conclude with an outlook and the proposition to use the approximate description based on canonical perturbation theory as a genuine model for nonlinear stationary waves on metric graphs .",
    "+ the definitions of the elliptic integrals used in the main text are summarised in the appendix .      a nonlinear quantum graph consists of a metric graph , a nonlinear wave equation on the edges of the graph and matching conditions for the wave functions at the vertices .",
    "each edge @xmath0 has a length @xmath1 and a coordinate @xmath2 $ ] .",
    "some edges may be half - infinite intervals with @xmath3 and one end at @xmath4 adjacent to one vertex .",
    "we call such edges _ leads _ while edges of finite length ( adjacent to vertices on both ends ) will be called _",
    "bonds_. graphs that contain ( do not contain ) leads are _ open _ ( _ closed _ ) .",
    "+ in this paper we consider the stationary cubic nlse for a complex valued scalar wave function @xmath5 on any edge @xmath0 @xmath6 here @xmath7 is the nonlinear coupling constant and @xmath8 the chemical potential . the nonlinear interaction is called repulsive for @xmath9 and attractive for @xmath10 .",
    "we use units ( of energy ) where the coefficient of the second derivative in is unity .",
    "the wave equation needs to be complemented by matching conditions at the vertices .",
    "we will introduce these below in section  [ sec : matching ] after discussing the solutions of the wave equation on one edge .",
    "let us consider one edge without any conditions at its ends .",
    "we omit the index @xmath0 until we come back to solutions on the graph . all local solutions to the stationary cubic nlse on an interval",
    "are known and may be expressed in terms of elliptic functions ( see @xcite for a complete overview ) . in this paper",
    "we only consider solutions @xmath11 with a positive chemical potential @xmath12 ( @xmath13 ) .",
    "we will also restrict our attention to sufficiently low intensities where @xmath14 such that all solutions remain bounded when extended to the infinite line .",
    "the bounded solutions are characterized by the maximal and minimal values @xmath15 of the local intensity @xmath16 @xmath17 the amplitude is a periodic function @xmath18 with period @xmath19 where @xmath20 is the complete elliptic integral of first kind ( see appendix  [ appendix ] for our conventions for elliptic functions and integrals ) and we introduced the two constants    @xmath21    it is explicitly given in terms of the @xmath22-periodic elliptic sine function @xmath23 as @xmath24 the phase @xmath25 is a monotonic function that is non - decreasing in the direction of the constant current @xmath26 in the interval @xmath27 the phase is given by @xmath28 where @xmath29 is the incomplete elliptic integral of third kind and @xmath30 for @xmath31 the phase function is continued in a smooth way using @xmath32 note that the change of phase over a period @xmath33 is in general not commensurate with @xmath34 .",
    "+ the stationary wave functions simplify considerably if the current vanishes @xmath35 . for the bounded wave functions this is the case if and only if there are nodal points such that @xmath36 .",
    "the corresponding wave functions are given by @xmath37 these wave functions are essentially real as they only contain a global phase factor @xmath38 .",
    "the wave function on the graph @xmath39 ( where @xmath40 is the set of edges of the graph ) is just the collection of all scalar wave functions on the edges .",
    "we choose standard matching conditions at all vertices ( also known as kirchhoff or neumann matching conditions for quantum graphs ) . at the vertex @xmath41",
    "these are defined as follows .",
    "let @xmath42 be the set of edges connected to @xmath41 .",
    "we may assume that @xmath4 at the vertex @xmath41 for all @xmath43 .",
    "we now require the following conditions : ( i. ) continuity of the wave function @xmath44 for all @xmath45 , and ( ii . ) a vanishing sum of outward derivatives @xmath46 . if @xmath47 is the valency of the vertex @xmath41 these conditions imply @xmath48 complex equations that couple the wave functions on different edges .",
    "it is useful to write these conditions in terms of amplitudes and phases . with @xmath49 continuity of the wave function",
    "just implies continuity of amplitudes and phases @xmath50 the condition on the outward derivatives then becomes    @xmath51    [ eq : derivativesum ]    where @xmath52 is the ( constant ) current along edge @xmath41 .",
    "the second equation is just kirchhoff s rule that the sum of all currents at a vertex must vanish .",
    "the exact solutions of the one - dimensional nlse described in section  [ sec : elliptic_wf ] may be used to find solutions on a graph .",
    "the matching conditions and lead to a finite set of nonlinear algebraic equations for the parameters @xmath53 , @xmath54 and @xmath55 of the exact solution on each edge . even for simple network structures these equations",
    "are usually too complex to be solved analytically .",
    "an approximation method that may take into account the effect of week nonlinearity has been developed in @xcite using canonical perturbation theory after rewriting the nlse as an equivalent integrable hamiltonian system with two degrees of freedom and ` time ' @xmath56 . in this approximation scheme",
    "the unperturbed system is the corresponding linear schrdinger equation obtained by setting @xmath57 .",
    "the approximation is locally valid for sufficiently small nonlinearities @xmath58 ( where @xmath59 ) .",
    "we will use the dimensionless parameter @xmath60 to denote the order of the approximation . with few exceptions we will only require first - order perturbation theory in this manuscript .",
    "the corresponding approximate solutions may best be described introducing action - angle variables in the zero - order ( linear ) wave equations . with @xmath61 the solution in higher order perturbation theory is written as @xmath62 where @xmath63 while @xmath64 can take arbitrary real values .",
    "the action variable @xmath64 is constant for arbitrary value of @xmath65 while @xmath66 is only constant for @xmath57 .",
    "indeed for @xmath57 one has @xmath67 and @xmath68 such that eq .",
    "reduces to a superposition of two plane waves with opposite current directions . in first - order perturbation theory",
    "one finds @xcite    @xmath69    [ eq : actionangle ]    where @xmath70 and @xmath71 are the constant action variables of the nonlinear system and    [ eq : phasedynamics ] @xmath72    note that one action variable is equivalent to the current @xmath73 .",
    "equations and reveal two entirely different effects of a weak nonlinearity on a solution .",
    "the first effect seen in is a local deformation of the linear solution .",
    "the second effect seen in is a change of the phase dynamics where we see a shift in the ` nonlinear wave numbers ' @xmath74 and @xmath75 .",
    "the latter changes may accumulate over large distances and lead to a dephasing between the two angles which is not present in the linear case where the two nonlinear wave numbers have the exact ratio two . in the setting of a nonlinear quantum graph",
    "we need to specify the parameters @xmath76 , @xmath71 , @xmath77 and @xmath78 on each edge separately such that the given matching conditions are satisfied at the vertices .",
    "it may then happen that though the local deformations ( which are of order @xmath79 ( where @xmath80 ) are tiny while the accumulated change in the phase @xmath81 along an edge of length @xmath82 is of order unity which implies that the global spectral characteristics of the graph ( such as the nonlinear spectrum ) completely change .",
    "we thus have a second dimensionless parameter @xmath83 that may characterise different asymptotic regimes .",
    "especially short wave length limits @xmath84 will be of interest . in the latter locally weak nonlinearity @xmath85 does not imply globally weak nonlinearity @xmath86 .",
    "-@xmath87 plane where the asymptotic regimes r1 , r2 , r3 are applicable .",
    "the dimensionless parameters @xmath88 and @xmath83 define the lines @xmath89 , @xmath90 and @xmath91 with are shown .",
    "the dashed ( red ) line @xmath92 marks the complete breakdown of canonical perturbation theory which requires @xmath85 .",
    "regimes r1 and r2 require @xmath93 and @xmath94 and thus break down near the dash - dotted ( green ) line @xmath95 .",
    "regime r3 only requires @xmath96 while @xmath97 may not be negligible . along the dash - dotted ( green )",
    "line @xmath95 only first - order perturbation theory gives a non - negligible contribution .",
    "along the dotted line @xmath98 second - order contributions are required .",
    ", scaledwidth=65.0% ]    we may identify three different regimes that are consistent with the canonical perturbation expansion ( @xmath85 ) and may lead to additional simplifications .",
    "we explain their range of validity in the following and illustrate it in figure [ fig : asymptotic_regimes ] .    *",
    "the _ low - intensity asymptotic regime _",
    "@xmath96 at fixed @xmath99 ( see illustration in figure [ fig : asymptotic_regimes ] ) .",
    "this regime is weak in both the local and the global sense . for the leading nonlinear effects one may expand the oscillatory functions with respect to the small phase shifts ( where this leads to a simplification ) .",
    "we will see that this regime allows explicit analytical results that include nonlinear effects to lowest order . *",
    "the _ short wavelength globally weak nonlinear asymptotic regime _",
    "@xmath84 with @xmath100 ( see illustration in figure [ fig : asymptotic_regimes ] ) . this is a special case of the low - intensity regime which leads to additional simplifications as the dominant nonlinear effects all come from the shift in the nonlinear wave numbers @xmath74 and @xmath75 . * the _ short wavelength asymptotic regime with moderately large intensities _ @xmath101 and @xmath96",
    "( see illustration in figure [ fig : asymptotic_regimes ] ) .",
    "this regime is weakly nonlinear only in the local but not ( necessarily ) in the global sense and the intensity is allowed to have moderately large values . as in the globally weak short wavelength regime",
    "the leading effect is the change of the nonlinear wave numbers @xmath74 and @xmath75 which leads to phase shifts of order @xmath102 .",
    "as these phase shifts may be large we may _ not _ expand the oscillatory terms and the nonlinear effect in the wave function comes in the leading order .",
    "if we are only interested in the leading effect we may neglect all other deformations . in this regime the equations that describe the stationary states on nonlinear quantum graphs simplify considerably but remain nonlinear .",
    "+ a final note on this regime : we have only given the leading shift of the nonlinear wave numbers in .",
    "this is consistent as long as the intensity is only growing moderately as @xmath103 ( at fixed @xmath82 and @xmath65 ) .",
    "the regime however allows a larger growth @xmath104 but this requires to calculate the nonlinear wave numbers @xmath74 and @xmath75 to higher orders : if @xmath105 then we need to calculate @xmath74 and @xmath75 to @xmath106-th order .",
    "while this is possible in principle ( see @xcite ) we will confine our discussions to @xmath107 ( or , equivalently @xmath108 ) with one exception : in our discussion of multi - stability in section  [ sec : scatt_interval1 ] we will consider @xmath109 and @xmath110 .    apart from finding analytical or numerical solutions in the above mentioned cases we will also discuss to some extent whether the regimes allow for a quantitative or at least qualitative description of nonlinear effects such as multi - stability of scattering solutions or bifurcations of spectral curves .",
    "our focus here is on how the complexity of the description of example graphs reduces with an appropriate perturbation theory",
    ". therefore we will usually not give the complete discussion of nonlinear effects that each example graph may deserve .",
    "we believe that the methods we present here will be useful for such a detailed analysis in the near future .",
    "finally let us state how equations and simplify for essentially real wave functions ( real modulo a global complex phase ) where the current @xmath71 vanishes .",
    "these equations appear to be singular at @xmath111 .",
    "the limit @xmath112 is however well defined and after an appropriate shift of the angle variable @xmath113 they reduce to    @xmath114    [ eq : real_perturbation_sol ]    where @xmath38 is a fixed global phase of the solution .",
    "note that we have included a term proportional to @xmath115 in @xmath74 .",
    "this term can be obtained straight forwardly using canonical perturbation theory to second order in @xmath116 . in most of our discussion",
    "this term will be negligible ( apart from section  [ sec : scatt_interval1 ] ) .",
    "let us now discuss a few examples of closed nonlinear quantum graphs @xmath117 .",
    "exact solutions for the interval and the ring are well - known and are used here to illustrate approximations using canonical perturbation theory  the star and the lasso are added to illustrate how proper graph topologies behave .",
    "our main aim in this section is to describe the spectral curves @xmath118 that give the nonlinear eigenvalues as a function of the @xmath119-norm or _ total intensity _ @xmath120 which is physically proportional to the number of particles in a bose - einstein condensate or the number of photons in an optical setting . in each case we will reduce the problem of solving the generalized nonlinear eigenproblem to a set of ( coupled ) nonlinear equations with a finite number of unknown variables .",
    "where analytical solutions are available we will give them , but will sometimes have to rely on numerical solutions .",
    "the stationary nlse on the interval ( as a graph with a single edge connecting two vertices , see figure [ fig : closed_graphs]a ) ) @xmath121 $ ] with dirichlet conditions at both ends @xmath122 is straight forward to solve @xcite . in this case",
    "the current @xmath123 vanishes which leads to the essentially real exact solutions where we set the arbitrary phase @xmath124 .",
    "the dirichlet condition at @xmath125 implies @xmath126 .",
    "the remaining parameters in the solution are the wave number @xmath127 and @xmath128 .",
    "the latter is a dimensionless measure of the strength of nonlinearity and proportional to the intensity with @xmath129}(g |\\phi(x)|^2/k^2)= \\rho_+$ ] ( for @xmath130 it is bounded by @xmath131 ) . in order to obey the second dirichlet condition @xmath132 as well the wave number @xmath133 has to be quantised according to @xmath134 for any positive integer @xmath106 . for @xmath135",
    "one finds the usual spectrum @xmath136 of the linear schrdinger equation .",
    "the total intensity can now be evaluated as @xmath137 } { g }      & \\text{if $ g>0$}\\\\      \\frac{2n k_n(\\rho_+ ) ( 2+\\rho_+)\\left[\\pi\\left (    1 ,            \\frac{\\rho_+}{2(\\rho_++1 ) } , \\frac{\\rho_+}{2(\\rho_++1 ) } \\right )          -k\\left ( \\frac{\\rho_+}{2(\\rho_++1 ) } \\right)\\right ]    } { |g|\\sqrt{\\rho_++1 } }      & \\text{if $ g<0$. }    \\end{cases }    \\label{eq : interval_norm}\\ ] ] equations and implicitly define the nonlinear wave number spectrum @xmath138 which is shown in figure [ fig : interval_spectrum ] together with some corresponding wave functions @xmath139 .",
    "are shown dashed .",
    "on the left the regime @xmath140 , on the right the regime @xmath130 is considered .",
    "the upper panels focus on small values of @xmath83 , the lower panels on large values of @xmath99 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically smaller but of the same order compared to the definition in the text . ) , title=\"fig:\",scaledwidth=45.0% ]   are shown dashed . on the left the regime @xmath140 , on the right the regime @xmath130 is considered .",
    "the upper panels focus on small values of @xmath83 , the lower panels on large values of @xmath99 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically smaller but of the same order compared to the definition in the text . ) , title=\"fig:\",scaledwidth=45.0% ] +   are shown dashed . on the left the regime @xmath140 , on the right the regime @xmath130 is considered .",
    "the upper panels focus on small values of @xmath83 , the lower panels on large values of @xmath99 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically smaller but of the same order compared to the definition in the text . ) , title=\"fig:\",scaledwidth=45.0% ]   are shown dashed . on the left the regime @xmath140 , on the right the regime @xmath130 is considered .",
    "the upper panels focus on small values of @xmath83 , the lower panels on large values of @xmath99 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically smaller but of the same order compared to the definition in the text . ) , title=\"fig:\",scaledwidth=45.0% ]    with the full solution available for the interval we may use this as a test ground for using the perturbative local solutions that have been developed in section iii of @xcite . in first order perturbation theory the wave function is given by .",
    "the first dirichlet condition implies @xmath142 and we may again set @xmath143 .",
    "the nodal points @xmath144 with @xmath145 then satisfy @xmath146 . requiring @xmath132 thus leads to the condition @xmath147 on the wave number . note that @xmath148 .",
    "the total intensity of the corresponding wave function is @xmath149 which allows us to write @xmath150 explicitly in terms of the total intensity @xmath151 which is consistent with expanding and for small @xmath152 and solving for @xmath138 including first - order corrections ( for either sign of @xmath65 ) .",
    "note that @xmath153 .",
    "figure [ fig : interval_spectrum ] compares the exact spectrum and wave functions to the ones obtained using perturbation theory . as expected from the error estimate in the agreement",
    "extends to much higher intensities for large values of @xmath99 .",
    "+ note that no further assumptions than locally weak nonlinearity ( in first - order canonical perturbation theory ) have been used to derive which is thus valid in the low - intensity and both small wave length regimes introduced in sec .",
    "[ sec : canonpert ] .",
    "the small wave length limit corresponds here to @xmath154 where includes the regime r3 where @xmath155 should grow not faster than @xmath106 .",
    "only the first - order shift in the nonlinear wave number @xmath156 enters into the explicit first - order correction term to @xmath157 in and @xmath138 in . for @xmath157",
    "higher - order corrections follow directly from higher - order corrections in the nonlinear wave number @xmath158 .",
    "the explicitly given first - order correction ( and any higher order corrections ) to the intensity @xmath159 in result from corrections to @xmath158 _ and _ the deformations of the wave form .",
    "this implies that apart from the shift in the nonlinear wave number also the deformations are relevant in higher - order corrections of @xmath138 .",
    "+ for consistency let us compare maximal amplitudes in the exact and approximate solutions .",
    "one then finds @xmath160 which allows us to express @xmath161 which is indeed the first - order expansion in @xmath152 of the exact expression .",
    "+ while the shift of the nonlinear wave number and the deformation of the plane wave solution are both affected by the nonlinearity in first - order perturbation theory we see that even for the simplest graph the two effects enter in different ways  and that some leading nonlinear corrections to spectral curves may be found by only referring to the shift .",
    "a star graph consists of @xmath162 edges ( which we enumerate @xmath163 ) with lengths @xmath164 , one vertex of degree @xmath162 ( the _ center _ of the graph to which all edges are adjacent ) and @xmath162 vertices of degree one where we assume dirichlet conditions .",
    "for @xmath165 the corresponding graph is depicted in figure [ fig : closed_graphs]b ) .",
    "the ground states of nonlinear star graphs and their stability ( with respect to the time - dependent nlse dynamics ) have been the subject of recent research @xcite .",
    "+ we will use the convention that the variable @xmath166 on edge @xmath0 increases towards the center where @xmath167 while @xmath4 corresponds to the other end .",
    "we will also assume that the coupling constant takes the same constant value @xmath168 on all edges .",
    "as there is no cycle in the graph the current has to vanish everywhere and the wave function @xmath169 may be chosen real . + if some of the edges have rational ratios then we may immediately construct some solutions with a nodal point at the central vertex from the known solutions on the interval . for instance",
    "if @xmath170 assume that @xmath171 is a solution of the nlse on the interval @xmath172 that we continue smoothly to the edge such that @xmath173 . defining @xmath174 to be the corresponding continuation along edge @xmath175 ( that is @xmath176 ) and @xmath177 on all remaining edges we have constructed a solution on the star with a nodal point in the centre . moreover there will be a corresponding spectral curve @xmath178 such that the central vertex remains a nodal point for the solutions of this spectral curve . if all edges have rationally independent lengths then we are not able to build any solutions as easily from the solutions on the interval .",
    "there will generally still be some solutions with a nodal point at the centre ( and a wave function which is supported by a few edges ) but these features can not be expected to be stable along any spectral curve .",
    "+ let us now consider the problem of finding spectral curves under the assumption that there is no nodal point at the centre . by continuity we can extend this to spectral curves with isolated points with a nodal point at the centre .",
    "we first reduce the problem of finding exact stationary solutions on a star to a set of nonlinear equations that may be solved numerically in an efficient way . for a given ( unperturbed ) wave number @xmath133 the wave function on each edge is given by . the dirichlet conditions",
    "@xmath179 imply @xmath180 . the remaining parameters @xmath181 and @xmath182 have to be found by considering the matching conditions at the centre",
    "let @xmath183 be the value of the wave function at the central vertex . by choosing a global phase",
    "we assume @xmath184  the wave function is then real and @xmath185 .",
    "the parameters @xmath181 can be found in terms of @xmath186 by solving the nonlinear equation @xmath187 .",
    "this is a nonlinear equation which has in general many solutions @xmath188  for @xmath189 the sign @xmath190 then follows from requiring @xmath191 . choosing one solution branch @xmath192 on each edge this leaves @xmath186 and the wave number @xmath133 as free parameters .",
    "however we have one more condition to satisfy which is @xmath193  this condition can be compactly written as    [ eq : star_nonlinearquantisation ] @xmath194    we have omitted the explicit dependence of @xmath195 .",
    "we may write the solutions of as spectral curves @xmath196 ( where @xmath106 enumerates disconnected spectral curves ) .",
    "the total intensity @xmath197 is then calculated straight forwardly from the corresponding parameters @xmath181 .",
    "this implies that we implicitly know @xmath138 . note that as @xmath198 all amplitudes @xmath199 have to vanish and the condition reduces to @xmath200 which is the secular equation for @xmath133 to be in the spectrum of the corresponding linear star graph where @xmath57 ( for rationally independent lengths this gives the complete spectrum ) .",
    "+ numerically , if one point on a spectral curve @xmath201 is found one may use newton - raphson methods to extend this numerically to a finite part of the curve .",
    "if one is only interested in spectral curves that connect to the spectrum of the corresponding linear graph it may be numerically more efficient to first solve for the linear spectrum and then extend the curves using newton - raphson methods .",
    "+ while we have reduced the coupled nonlinear problem of finding @xmath162 parameters @xmath181 ( and corresponding signs ) to a sequence of @xmath202 relatively benign nonlinear equations that can be solved numerically it remains a formidable task to find all solutions in a given spectral interval ( and some restrictions on the maximal local or total intensities ) .",
    "+ we now turn to the perturbative solutions for locally weak nonlinearity @xmath203 .",
    "the wave function @xmath5 on each edge @xmath0 is then given in terms of with @xmath204 and @xmath205 .",
    "we need to find a set of @xmath162 action variables @xmath206 such that the matching conditions at the centre are satisfied .",
    "the continuity condition @xmath207 leads to the nonlinear implicit equation @xmath208 for @xmath209 .",
    "we will later see that the asymptotic regimes r1 and r2 allow us to obtain explicit unique expressions for @xmath209 in terms of @xmath210",
    ". in general may have many solutions which are easy to obtain numerically . before discussing the asymptotic regimes",
    "let us continue with the general expressions based on first - order perturbation theory .",
    "once the parameters @xmath209 are found such that is satisfied we may calculate the total intensity @xmath211 which at this stage is a function of @xmath186 .",
    "the remaining matching condition @xmath212 may be reduced to @xmath213=0    \\ .",
    "\\label{eq : star_quantization_pert}\\ ] ] here @xmath214 , @xmath215 and @xmath216 , so that one obtains @xmath217 in leading order which is consistent with the linear limit where @xmath218 .",
    "equations , and implicitly define the spectral curves @xmath138 . while they are simpler than the corresponding exact equations based on jacobi elliptic functions they generally remain nonlinear .",
    "+ let us now turn to the three asymptotic regimes r1 , r2 , and r3 where additional simplifications allow for a more explicit form of the solutions . in the low intensity regime",
    "r1 @xmath219 where @xmath220 is bounded one may expand oscillatory functions such as @xmath221 ( note that @xmath222 ) . after this expansion equation may be solved explicitly for the action variable @xmath223 we keep error terms involving low orders in @xmath99 for later use .",
    "we may use above expression in order to give an explicit expression for the leading nonlinear correction in .",
    "the latter correction is proportional to the total intensity @xmath224 for which we only give the required leading term .",
    "equation now reduces to @xmath225 which implicitly defines the spectral curves @xmath226 .",
    "one may worry about the terms @xmath227 that appear in various denominators and give rise to poles for @xmath228 .",
    "note that we have already assumed that there is no nodal point in the centre @xmath229  moreover in the low intensity regime r1 one has @xmath230 which implies @xmath231 as well .",
    "+ if @xmath232 is in the spectrum of the linear graph it satisfies @xmath233 and the spectral curve @xmath178 emanating from there can be evaluated from as @xmath234 next let us consider the short wave length regime r2 where @xmath235 with bounded total intensity ( @xmath84 and @xmath236 in terms of dimensionless quantitites ) .",
    "the expansions performed in the low intensity regime r1 remain valid .",
    "note that in expressions , , , and we have kept track of the dependence of error terms on the wave number @xmath133 .",
    "neglecting subdominant terms allows us to simplify and    [ eq : star_r2 ] @xmath237    which shows that the slope of the spectral curves decreases fast when @xmath238 .    while the regimes r1 and r2 allowed us to express the spectral curves @xmath178 implicitly as the zeros of an explicit function of @xmath133 and @xmath155 the corresponding results may as well have been derived by expanding the exact expressions in terms of elliptic functions in terms of the local amplitudes @xmath181 .",
    "one strength of the approach based on canonical perturbation theory is that it remains valid even for moderately strong total intensities at small wave lengths .",
    "this is the regime r3 where @xmath239 with a total intensity @xmath240 that may grow proportional to the wave number ( or equivalently , the actions may grow as @xmath241 ; in terms of dimensionless parameters @xmath242 , @xmath243 where @xmath244 ) . in this case",
    "we are not allowed to expand oscillating terms completely .",
    "e.g. , in a term @xmath245 the phase @xmath246 can not be considered small .",
    "indeed these phases give the leading nonlinear effect which is of order unity .",
    "neglecting all other nonlinear effects leads to the set of equations    [ eq : star_r3 ] @xmath247    where the neglected term falls off at least as @xmath248 ( if the total intensity is allowed to grow @xmath249 ) .",
    "note that these equations remain nonlinear and allow in principle for effects such as bifurcation of spectral curves that remain absent in the regimes with globally weak nonlinearity ( r1 and r2 ) .",
    "for instance eq .   at fixed",
    "@xmath133 and @xmath186 has generally more than one solution that is consistent with the range of validity of these equations .    ,",
    "@xmath250 and @xmath251 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically different but of the same order compared to the definition in the text.),title=\"fig:\",scaledwidth=45.0% ] , @xmath250 and @xmath251 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically different but of the same order compared to the definition in the text.),title=\"fig:\",scaledwidth=45.0% ] + , @xmath250 and @xmath251 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically different but of the same order compared to the definition in the text.),title=\"fig:\",scaledwidth=45.0% ] , @xmath250 and @xmath251 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically different but of the same order compared to the definition in the text.),title=\"fig:\",scaledwidth=45.0% ] + , @xmath250 and @xmath251 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically different but of the same order compared to the definition in the text.),title=\"fig:\",scaledwidth=45.0% ] , @xmath250 and @xmath251 .",
    "( for the purpose of this graph we have defined @xmath141 which is numerically different but of the same order compared to the definition in the text.),title=\"fig:\",scaledwidth=45.0% ]    indeed one can find bifurcations of spectral curves in the exact spectral curves and these are well described by the asymptotic approximation in the short wave length regime r3 .",
    "this can be seen in figure [ fig : graph_spectrum ] where we compare the spectral curves obtained from exact solutions with approximative solutions based on .",
    "the agreement of the curves clearly improves with increasing wave number @xmath133 and extends to higher total intensities @xmath155 as @xmath133 is increased .",
    "we have found some new spectral curves appearing at higher intensities which are not connected to the linear spectrum at @xmath252 .",
    "we do not want to suggest that we have found all spectral curves in the shown intervals .",
    "the spectral curves that extend to the linear spectrum were found using a newton raphson method by deforming the ( easily available ) linear solution .",
    "we would like to note that the computations using the asymptotic approximation were considerably quicker .",
    "indeed the bifurcations where new spectral curves appear at larger intensities have usually first to be found using the asymptotic equations before ( which could then be used as a starting point to find the exact ones ) . in a very different regime ( negative chemical potential )",
    "bifurcations in the ground state have been analyzed in @xcite .",
    "next let us consider a ring of total length @xmath82 illustrated in figure [ fig : closed_graphs]c ) where the spectrum of the linear case is just the collection of eigenvalues @xmath253 for @xmath254 ( we will always assume @xmath255 ) . here",
    ", @xmath256 corresponds to the constant function and eigenvalues @xmath257 are double degenerate with corresponding eigenfunctions of the form @xmath258 such that the intensity @xmath259 is constant for @xmath260 or @xmath261 and has discrete nodal points for @xmath262 .",
    "the exact solutions in the nonlinear case have been studied in detail before in terms of jacobi elliptic equations for repulsive @xcite and attractive nonlinearity @xcite . here",
    "we want to give a short overview how the equations simplify for locally weak nonlinearity where first - order canonical perturbation theory applies .",
    "the main new feature compared to the interval or star graphs is that the wave functions may be genuinely complex valued .",
    "this is accompanied by the fact that there are now two distinct periodicities described by the nonlinear wave numbers @xmath74 and @xmath75 . in the linear",
    "limit their ratio takes a unique value @xmath263 and we will see that in the nonlinear case this ratio can take other ( rational ) values .",
    "+ let us start with stating the conditions for an exact solution @xmath264 which is locally given by and with @xmath126 ( by choice of origin ) and with the periodicity condition @xmath265 for all @xmath56 .",
    "this implies    [ eq : ring_periodicity ] @xmath266    the solutions and depend on two parameters @xmath267 such that @xmath268 . for a given value of the wave number @xmath133",
    "the two conditions can be satisfied for a discrete set of values @xmath269 . with the total intensity @xmath270 each of the solutions",
    "@xmath269 then defines a spectral curve @xmath271 .",
    "+ we want to discuss these curves using canonical perturbation theory to first order where the wave function is given by equations   and ( with @xmath272 by choice of origin and global phase ) .",
    "these solutions depend on the two action variables @xmath70 and @xmath71 which need to be determined through conditions .",
    "complex conjugation of a solution gives a new solution that is given by replacing @xmath273 .",
    "we may thus confine our discussion to non - negative values @xmath274 . for @xmath275",
    "the periodicity conditions imply    [ eq : circle_conditions ] @xmath276    where @xmath106 and @xmath277 are integers . here",
    "@xmath278 may take any positive value which is obvious from the second equation .",
    "we will see later that @xmath279 takes non - negative values and this is the reason for writing @xmath280 in the first condition . if @xmath281 the intensity is constant and only the second condition applies which then reduces to @xmath282 note that in this case the integer @xmath277 is not defined .",
    "with @xmath283 one obtains a spectral curve @xmath284 these spectral curves connect to the linear spectrum as @xmath285 .",
    "+ setting @xmath286 in leads to another set of spectral curves that connect to the linear spectrum . in this case",
    "@xmath111 and we have an essentially real wave function ( modulo choice of a global phase ) with @xmath287 nodal points such that the problem reduces to the nonlinear interval of length @xmath288 .",
    "the corresponding spectral curves are given by @xmath289 where @xmath290 .",
    "note that so far the discussion has been consistent with the globally weak asymptotic regimes r1 and r2 as well as the short wave length regime with moderate intensities r3 .",
    "let us now discuss the case @xmath291 . first note that eliminating @xmath106 from gives @xmath292 which is manifestly non - negative ( as we confined the discussion to @xmath293 without loss of generality ) , so that @xmath294 is a non - negative integer as stated above .",
    "moreover , if we want to have @xmath291 then shows that this is not consistent with globally weak nonlinearity ( regimes r1 and r2 ) where the right - hand side becomes arbitrarily small in the asymptotic limit . on the other hand",
    "the short wave length regime r3 with modestly large intensities allows for the right - hand side to be of order unity ( as @xmath71 is allowed to take values @xmath295 ) .",
    "the rest of the discussion will be confined to this regime where the @xmath71 and @xmath76 are of order @xmath295 and @xmath296 ( so @xmath297 ) while @xmath298 takes small integer values ( @xmath299 ) .",
    "solving for the action variables gives    @xmath300    note that the second equation implies that @xmath76 changes sign at @xmath301 .",
    "as @xmath76 is manifestly positive this defines an endpoint of a spectral curve where @xmath302 is not vanishing at the same time . with @xmath303",
    "the corresponding spectral curve @xmath304 does not connect directly to the linear spectrum .",
    "rather it bifurcates from the spectral curve @xmath138 given by at a finite total intensity @xmath305 .",
    "this bifurcation scenario is depicted in figure [ fig_bifurc ] .",
    "( see eq .  )",
    "is shown for @xmath306 together with the spectral curves @xmath307 ( see eq .  ) that bifurcate above a critical intensity .",
    "the approximations are valid in the high wave number asymptotic regime r3 .",
    ", title=\"fig:\",scaledwidth=45.0% ]   ( see eq .  ) is shown for @xmath306 together with the spectral curves @xmath307 ( see eq .  ) that bifurcate above a critical intensity .",
    "the approximations are valid in the high wave number asymptotic regime r3 . , title=\"fig:\",scaledwidth=45.0% ] +      the tadpole graph consists of a ring graph of length @xmath308 to which one dangling edge of length @xmath309 is attached at one end , see figure [ fig : closed_graphs]d ) .",
    "we choose the coordinates on the ring such that @xmath310 where @xmath311 ( and equivalently @xmath312 ) is the position of the vertex where the dangling edge is attached .",
    "the coordinate on the dangling edge will be chosen such that @xmath313 with @xmath314 for the vertex of degree one and @xmath315 for the vertex that connects to the ring .",
    "we assume dirichlet boundary conditions @xmath316 at the dangling vertex and standard matching conditions    [ tadpole - matching - condition ] @xmath317    at the vertex on the ring .",
    "one may observe that the real solutions of the ring considered in the section  [ sec : ring ] can be extended to a solution on the tadpole : if one of the nodal points is on the vertex and we set @xmath318 then all matching conditions are satisfied .",
    "if we try to extend the ( non - trivially ) complex solutions on the ring ( with a finite current ) to the tadpole then , due to the lack of nodal points , this can only be done with a non - vanishing solution on the dangling edge such that @xmath319 .",
    "this can in general not be satisfied at the same time as continuity .",
    "however , there is also the additional rotational freedom of solutions on the ring ",
    "so the problem of extending a ring solution to the tadpole reduces to the condition @xmath319 where @xmath320 .",
    "while this may not work for arbitrary ring solutions one expects that at least some ( non - trivially ) complex nonlinear ring solutions can be extended to the tadpole for any values of the lengths @xmath308 and @xmath309 .",
    "interestingly , in the linear case ( @xmath57 ) this is generally not the case because solutions do not change with the overall scaling .",
    "+ in the linear case complex solutions with a finite current around the ring only exist for wave numbers @xmath133 that satisfy @xmath321 and @xmath322 at the same time .",
    "this in turn implies that the quotient of the two lengths is rational @xmath323 ( where @xmath324 and @xmath325 are integers ) .",
    "the linear wave number spectrum is then discrete and non - degenerate .",
    "one half of the spectrum @xmath326 for positive integers",
    "@xmath106 corresponds to wave functions @xmath327 on the ring with a nodal point on the vertex while the other half can only be given implicitly as the zeros of the equation @xmath328 the wave functions corresponding to the latter solutions are of the form @xmath329 which have a non - vanishing value @xmath330 at the vertex which follows from condition and the assumption that @xmath331 is irrational .    in the nonlinear case",
    "the exact solutions were classified in @xcite and their stability and bifurcations were studied in @xcite .",
    "we will now establish a few complex solutions using canonical perturbation theory in the generic case where @xmath331 is irrational . in the previous sections we have seen that the asymptotic low - intensity regimes r1 and the globally weakly nonlinear short wave length regime r2 describe how nonlinear solutions connect to the linear solutions while not being able to describe any bifurcations .",
    "the same applies in the present context , so we immediately consider the short wave length asymptotic regime r3 and try to find solutions of the form    @xmath332    where the form of @xmath171 ensures that @xmath333 .",
    "we have also chosen @xmath334 such that complex solutions have a current along the ring in increasing direction of @xmath335 . by complex conjugation one",
    "then finds a new solution with opposite current ( i.e. the corresponding solution with negative @xmath336 ) . + before considering how some complex solutions can be described let us first consider the appreciable simpler case of real solutions where @xmath337 and @xmath338 . in that case the two choices of the sign in @xmath171 lead to @xmath339 it is straight forward to see from @xmath340 that the sine solutions must have a nodal point at the vertex which implies @xmath341 and that the wave function on the dangling bond is identically zero @xmath318 .",
    "we identify these solutions as the nonlinear solutions on the ring .",
    "the corresponding spectral curves are given by and connect to the corresponding part of the linear spectrum .",
    "choosing the cosine in leads to the condition    @xmath342    which together define spectral curves @xmath178 . in the limit @xmath198",
    "we have @xmath343 and @xmath344 and the condition becomes the implicit equation for the corresponding linear spectrum .",
    "altogether we found a clear correspondence between the real nonlinear solutions and corresponding linear solutions of the tadpole graph .",
    "+ in addition to the real solutions there may be a large number of complex solutions . with the canonical perturbation approach",
    "we have reduced the problem of finding all complex solutions to a finite set of non - linear conditions that can in general be solved numerically . in the present setting we restrict ourselves to establish the existence of some complex solutions analytically .",
    "let us consider only the leading behaviour and look for solutions that satisfy the additional condition @xmath345 .",
    "this condition implies that the intensity on the ring is constant , @xmath346 . in this case",
    "the matching condition @xmath347 implies @xmath348 for some integer @xmath324 . in this case",
    "@xmath349 which reduces the matching condition to @xmath319 or @xmath350 for a positive integer @xmath351 .",
    "the remaining matching conditions @xmath352 just implies @xmath353 .",
    "we may replace one of the two conditions and by the quotient @xmath354 this is a single condition for the combination @xmath355 .",
    "if it is satisfied the individual conditions and are straight forwardly satisfied by considering @xmath133 and @xmath356 independently .",
    "so let us show that can indeed be satisfied in the short wave length regime . in this regime one may choose @xmath357 and @xmath358 large such that the ratio @xmath359 is a rational approximant to ( the irrational number ) @xmath360 or @xmath361 where @xmath362 may be positive or negative and arbitrarily small .",
    "choosing @xmath363 then satisfies the condition ( in leading order ) .",
    "+ we see that a relatively simple graph such as the tadpole already has a rich set of solutions . within canonical perturbation theory",
    "we have shown straight forwardly that there exist solutions to the nonlinear tadpole which are not just deformations of the solutions of the corresponding linear problem .",
    "it would certainly be interesting to study the full bifurcation scenario of the spectral curves @xmath178 in this case using canonical perturbation theory  in the present paper we confine ourself to initial steps in a variety of simple graphs and thus leave this as an open problem for later investigation .",
    "in this section we discuss stationary scattering from nonlinear graphs .",
    "we will consider a few simple graphs with some nonlinear bonds and linear leads .",
    "we will fix incoming wave amplitudes on the leads and be interested in reflection and transmission amplitudes through the nonlinear graph . in the linear setting these amplitudes are described by a scattering matrix @xcite .",
    "scattering through nonlinear graphs was studied previously by different methods in @xcite .",
    "we will use canonical perturbation theory to show how the nonlinear setting connects to the known linear description at low intensities and also discuss how multi - stability as a proper nonlinear effect can be described in this framework . as before we do not aim at a complete description of each example graph .",
    "we consider a nonlinear interval of length @xmath82 with dirichlet boundary condition at @xmath125 and a linear interval coupled at @xmath364 ( see fig .  [",
    "fig : scattgraphs]a ) ) .",
    "it is ideal for testing the power of the canonical perturbation theory for a scattering setup .",
    "we write the wave function as @xmath365 where @xmath366 is a real nonlinear solution given in equation   ( with @xmath126 to satisfy the dirichlet condition and @xmath367 ) .",
    "the parameter @xmath368 in is the current of the incoming wave .",
    "the reflected wave contains an additional scattering amplitude @xmath369 . in an experiment one",
    "sets the current @xmath368 and the wave number @xmath133 and measures the scattering phase @xmath362 as a function of @xmath133 and @xmath368 . in the linear case",
    "the scattering phase is @xmath370 ( or @xmath371 ) which follows from the dirichlet condition at @xmath125 . at a given wave number @xmath133 the nonlinear wave function @xmath366 depends on the single parameter @xmath152 .",
    "if we fix @xmath152 we may determine @xmath368 and @xmath362 from the continuity of the wave function and its derivative at @xmath364 .",
    "this is equivalent to considering the point @xmath364 as a vertex on graph with two edges ( a finite bond and an infinite lead ) with the standard matching conditions described in section  [ sec : matching ] .",
    "this leads to the exact and unique relation between @xmath368 and @xmath152 @xmath372         &         \\text{if $ g>0$}\\\\        \\frac{k^3}{|g|}\\frac{\\rho_+(2+\\rho_+)}{8(1+\\rho_+ ) }        \\left [          \\frac {            \\mathrm{sn}^2\\left(k\\sqrt{1+\\rho_+}\\ell,\\frac{\\rho_+}{2(1+\\rho_+)}\\right )          } { \\mathrm{dn}^2\\left(k\\sqrt{1+\\rho_+}\\ell,\\frac{\\rho_+}{2(1+\\rho_+)}\\right ) }          +          ( 1+\\rho_+ )          \\frac {            \\mathrm{cn}^2\\left(k\\sqrt{1+\\rho_+}\\ell,\\frac{\\rho_+}{2(1+\\rho_+)}\\right ) } {            \\mathrm{dn}^4\\left(k\\sqrt{1+\\rho_+}\\ell,\\frac{\\rho_+}{2(1+\\rho_+)}\\right)}\\right ] .         &",
    "\\text{if $ g<0$. }      \\end{cases }    \\label{eq : scatt_int_flow}\\end{aligned}\\ ] ] the scattering amplitude may generally be expressed as @xmath373 which leads to the phase shift @xmath374 implicitly this defines the scattering phase @xmath362 as a function of the incoming flow @xmath368 .",
    "it is well - known that multi - stability and related hysteresis effects occur already in the most basic nonlinear scattering systems such as the one considered here . in the present context hysteresis",
    "physically implies that the outcome of an experiment where @xmath368 and @xmath133 are given and @xmath362 is measured depends on the history of the experiment which selects one ( stable ) branch out of many .",
    "numerically this is indeed seen straight forwardly .",
    "this is shown in fig.[fig : intervalscatt ] where @xmath375 is depicted for some values of @xmath133 .",
    "as can be seen there is a critical value @xmath376 such that multi - stability sets in above @xmath377 and this value increases with @xmath133 .    .",
    "the blue curves depict the exact results whereas the results based on canonical perturbation theory are shown as yellow curves .",
    "the flow is plotted in natural dimensionless units as @xmath378.,title=\"fig:\",scaledwidth=45.0% ] .",
    "the blue curves depict the exact results whereas the results based on canonical perturbation theory are shown as yellow curves .",
    "the flow is plotted in natural dimensionless units as @xmath378.,title=\"fig:\",scaledwidth=45.0% ] + .",
    "the blue curves depict the exact results whereas the results based on canonical perturbation theory are shown as yellow curves .",
    "the flow is plotted in natural dimensionless units as @xmath378.,title=\"fig:\",scaledwidth=45.0% ] .",
    "the blue curves depict the exact results whereas the results based on canonical perturbation theory are shown as yellow curves .",
    "the flow is plotted in natural dimensionless units as @xmath378.,title=\"fig:\",scaledwidth=45.0% ]    in the remainder of this chapter we want to use canonical perturbation theory in order to approximate the nonlinear effects in the scattering phase and to give an analytical estimate how the critical flow @xmath376 increases with @xmath133 .",
    "the wave function @xmath366 is then given by equation ( with @xmath142 and @xmath367 ) .",
    "the scattering amplitude can then be expressed as @xmath379 } {      2kj_r(\\ell)+e^{i\\beta_r(\\ell)/2 }      \\left[(\\beta'_r(\\ell)-2k)j_r(\\ell)\\cos(\\beta_r(\\ell)/2 )         + j'_r(\\ell ) \\sin(\\beta_r(\\ell)/2)\\right ]    }    \\label{eq : scatt_phase_interval_cp}\\ ] ] and the incoming flow as @xmath380 ^ 2    \\label{eq : scatt_flow_interval_cp}\\ ] ] the low intensity regimes r1 and r2 do not allow for multi - stability because the asymptotic limit is not compatible with describing nonlinear effects above a critical value .",
    "+ let us now turn to the short wavelength regime @xmath381 . in this regime @xmath382 and @xmath383 . in all previous examples we could capture interesting nonlinear effects by only considering the leading order corrections of order @xmath384 to the phase while neglecting contributions @xmath385 to the phase and @xmath386 ( relative to the leading term ) to the amplitude .",
    "we will show that the critical value @xmath376 scales like @xmath387 which implies that @xmath388 can not be neglected as @xmath389 .",
    "the detailed calculation can then only be performed consistently if one also keeps corrections @xmath386 to the amplitude . using and",
    "one then obtains @xmath390    \\label{eq : scatt_interval_r3_ilir}\\ ] ] and @xmath391 where @xmath392 fig .",
    "[ fig : intervalscatt ] shows the scattering phase @xmath375 by numerically solving and and compares it to the numerical solution of the exact equations .",
    "as can be seen multi - stability can be accurately described numerically .",
    "+ the expressions can also be used for analytical estimates .",
    "a unique function is only obtained if the function is a monotonic function of @xmath76 .",
    "if @xmath393 is the smallest value such that @xmath394 then multi - stability sets in for @xmath395 , and since the incoming flow @xmath368 is equal to @xmath76 to leading order we get multi - stability for incoming flows @xmath396 . this value can be estimated straight forwardly from by taking the derivative @xmath397 which shows that the derivative can only vanish if @xmath398 is of order unity which gives the estimate @xmath399 fig .",
    "[ fig : critflow ] compares this estimate @xmath376 to the numerically obtained critical value using the exact equations .     as a function of the wave number above which multi - stability sets in for scattering from a nonlinear interval with one ( linear )",
    "lead attached at one end : a ) attractive case ; b ) repulsive .",
    "the wave number is expressed in a natural dimensionless way by @xmath400 . + thick blue lines : numerical data using exact equations .",
    "+ thin yellow lines : numerical data using canonical perturbation theory ( see text ) .",
    "+ dashed lines give the analytically found scaling law @xmath401 in very good agreement with numerically found data . , title=\"fig:\",scaledwidth=45.0% ]   as a function of the wave number above which multi - stability sets in for scattering from a nonlinear interval with one ( linear ) lead attached at one end : a ) attractive case ; b ) repulsive .",
    "the wave number is expressed in a natural dimensionless way by @xmath400 . + thick blue lines : numerical data using exact equations .",
    "+ thin yellow lines : numerical data using canonical perturbation theory ( see text ) .",
    "+ dashed lines give the analytically found scaling law @xmath401 in very good agreement with numerically found data .",
    ", title=\"fig:\",scaledwidth=45.0% ]      next let us consider a nonlinear interval of length @xmath82 that is connected to linear leads at both ends ( see fig .",
    "[ fig : scattgraphs]b ) ) .",
    "here a plane wave with flow @xmath368 and wave number @xmath133 comes in through one lead and is partially reflected and partially transmitted through the interval .",
    "the wave function may written as @xmath402 here @xmath403 and @xmath404 are complex transmission and reflection coefficients that depend on the incoming flow @xmath368 and the wave number @xmath133 .",
    "flow conservation implies @xmath405 . inside",
    "the nonlinear lead @xmath366 is a complex solution of the nlse .",
    "+ we do not aim at a complete discussion of the solutions .",
    "rather we want to show how the solution simplifies in the leading order when one considers the short wavelength regime r3 where @xmath406 and @xmath407 while @xmath97 need not be small . neglecting terms of order @xmath386",
    "we can write @xmath408 where @xmath409 , @xmath410 , and we have used that the flow @xmath71 through the interval is positive . requiring that the wave function and its first derivative are continuous at the two ends of the interval it is straight forward to show that assuming @xmath411 is consistent with these requirements . in this case there is negligible reflection and the wave passes through unhindered .",
    "the only effect is a non - negligible phase shift that can easily be calculated as @xmath412 it is well known @xcite that transport through a nonlinear interval shows multi - stability .",
    "our calculation here shows that this can not be analysed by only considering the nonlinear phase shifts  which are the dominant nonlinear effect in the short wavelength asymptotic regime r3 .",
    "multi - stability can only be analysed if the reflection coefficient is not neglected ",
    "so one needs to take into account terms of order @xmath413 in the nonlinear wave function @xmath366 .",
    "this is analogous to the scattering from the nonlinear interval with a single lead : in order to get a consistent description of multi - stability we had to add terms that change the shape of the wave function in addition .",
    "the main reason why seemingly small contributions are important when considering multi - stability is the necessity to use the implicit function theorem to get @xmath414 and @xmath415 as a locally unique function of @xmath368 and @xmath133 .",
    "multi - stability can be analysed by considering the breakdown of the implicit function theorem  this involves derivatives of the wave function with respect to all parameters .",
    "a consistent description of these derivatives in the presence of large phase shifts generally requires also that the corrections @xmath413 to the shape are used in sufficient high order . in that sense equations",
    "have to be taken with care  if one assumes that one obtains a unique solution . however solving the equations for @xmath414 and @xmath415 starting from using the implicit function theorem",
    "may still reveal that there are additional solutions .",
    "+ any further analysis in the present case would follow similar lines as for the case with one lead .",
    "a detailed discussion of this case would certainly also be of interest but at present our aim is just to show the power and the limitations of the approach using canonical perturbation theory .",
    "we now consider a nonlinear ring with ( circumference ) length @xmath82 and a variable @xmath416 $ ] with one infinite linear lead attached at @xmath417 ( see fig .",
    "[ fig : scattgraphs]c ) ) .",
    "we denote the variable on the lead as @xmath418 with the vertex on the ring being at @xmath419 .",
    "the configuration is similar to the finite tadpole discussed above where the finite nonlinear interval is replaced by an infinite linear lead .",
    "+ the wave function in the lead is @xmath420 where @xmath368 is the incoming flow and @xmath421 is a scattering phase and the wave function @xmath422 on the ring is a complex solution of the nlse .",
    "+ one special feature of this scattering system is the existence of bound states in the continuum , i.e. states that have a finite amplitude on the ring but vanish on the lead .",
    "this implies @xmath423 and @xmath424 which are just the conditions for finding real solutions to the nlse on the ring as discussed in chapter [ sec : ring ]  in the linear limit this leads to the standard quantisation condition @xmath425 .",
    "the existence of such solutions gives rise to severe limitations to any kind of perturbation theory because assuming that the incoming flow @xmath368 is sufficiently small does in general not imply that the intensities on the ring are small as well .",
    "+ our aim is to show in a concise way how canonical perturbation theory can be used in this context to find some solutions .",
    "we focus again on the short wavelength regime r3 where the leading effect is a nonlinear phase shift in a superposition of plane waves and other changes being neglected @xmath426 where @xmath427 and @xmath428 .",
    "we have chosen @xmath429  solutions with the opposite direction of flow can be obtained by complex conjugation . for the bound states in the continuum we have no current @xmath71 . confining our discussions to scattering states that are ` close ' to the bound states we will focus on solutions with @xmath430 .",
    "the wave function simplifies to @xmath431 where we implicitly redefined the ( still undetermined ) phase @xmath432 .",
    "continuity at the vertex then implies @xmath433 which has two types of solutions : either @xmath434 with arbitrary @xmath432 or @xmath435 with no restrictions on @xmath74 . in the first case",
    "@xmath434 we have @xmath436 and @xmath424 which are the conditions for a solution on the ring .",
    "this in term implies that @xmath437 or that the scattering phase is @xmath438 . the bound state is thus embedded in a one - parameter family of solutions with finite incoming flow where the scattering phase vanishes . in fact",
    "this can easily be seen using the exact equations . + finally let us turn to solutions with @xmath435 where two conditions still need to be satisfied @xmath439 using that @xmath440 and consistently neglecting terms @xmath386 these equations simplify to @xmath441 , @xmath442 and a scattering phase @xmath443 while our calculations again show that some solutions can easily be explored using canonical perturbation theory caution needs to be applied when uniqueness of these solutions is considered ( see the previous discussion for the interval with two leads ) .",
    "note that the existence of bound states did not obstruct a consistent derivation of some solutions in the perturbative regime .",
    "this is mainly due to the restricted topology and our restriction to solutions without flow around the ring .",
    "narrow resonances in a scattering graph pose a challenge to any perturbation theory based on ( relatively ) low intensities .",
    "if the corresponding linear quantum graph has a narrow resonance at some wave number @xmath232 then this implies that the wave is ` trapped ' inside the graph where constructive interference leads to intensities inside the graph that may be much higher than on the lead . in the nonlinear case",
    "any nonlinearity is then magnified .",
    "indeed it has been observed @xcite that nonlinear effects such as multi - stability in quantum graphs occur generically already when the incoming flow is very low due to a generic mechanism for narrow resonances , the so - called topological resonances @xcite .",
    "we refer to @xcite for a more detailed discussion of topological resonances in linear quantum graphs and to @xcite for a numerical analysis how topological resonances magnify nonlinearities and lead to multi - stability for arbitrarily small incoming flows . here",
    "we want to describe this mechanism briefly for two example graphs .",
    "we leave the detailed nonlinear analysis as a challenging problems in future research and restrict ourselves to explain the challenge .",
    "+ the first example is the y - structure shown in fig .",
    "[ fig : scattgraphs ] ( d ) .",
    "two nonlinear bonds of lengths @xmath308 and @xmath309 are connected to a linear lead . in the linear case",
    "it can easily be seen that there are bound states if the bond lengths are rationally related @xmath444 for some integers @xmath357 and @xmath358 in that case it is straight forward to construct sine waves on the bonds such that there is a nodal point on the vertex , so that the solution can be continued on the lead by a vanishing wave function .",
    "however for a generic choice of lengths no integers @xmath357 and @xmath358 exist ( the lengths are incommensurate ) and thus no bound states . while there are",
    "no bound states where the wave function has a nodal point on the vertex there are many scattering solutions where a nodal point comes arbitrarily close to the vertex  in that case the intensity on the two bonds may be orders of magnitude higher than on the attached lead .",
    "indeed , just as any irrational number can be approximated by a rational number to arbitrary precision one can find resonances where the intensity on the bonds is arbitrarily high . in a nonlinear graph this leads to arbitrarily high magnifications of all nonlinear effects .",
    "if @xmath133 ranges in a certain spectral interval the strongest topological resonance will limit any _ uniform _ application of perturbation theory ( though it may break down only in a tiny interval around the resonance ) .",
    "+ the y - graph is the simplest structure where the effect of such topological resonances may be studied .",
    "one reason for being simple is that all scattering solutions are essentially real ( they can be made real by a global gauge transformation ) and total flows on all edges vanish .",
    "the simplest graph with fundamentally complex scattering solutions consists of two bonds of lengths @xmath308 and @xmath309 and two leads , see fig .",
    "[ fig : scattgraphs ] ( e ) .",
    "the two bonds form a ring with two vertices by connecting each end of one bond to an end of the other  and the leads are connected . in the linear case",
    "we again find bound states for rationally related lengths  in that case one can construct sine functions around the ring that have nodal points at both vertices .",
    "for incommensurate lengths one finds again no bound states but one does find topological resonances that are arbitrarily ` close ' to a bound state ( in the sense that the intensity outside may be arbitrarily small ) @xcite .",
    "if one wants to consider nonlinear effects of topological resonances in a graph with complex wave functions and particle flows this structure is probably the simplest case  though it remains a challenge for future research .",
    "note , however that it is sufficient to assume that one of the two bonds responds nonlinearly which does simplify the problem to some extent .",
    "to summarise , we studied applications of canonical perturbation theory for the stationary nonlinear schrdinger equation developed in @xcite to some specific quantum graphs . depending on wave number , the strength of the nonlinear interaction and the lengths of the edges in the graphs we identified three different asymptotic regimes .",
    "the first two regimes can be equivalently obtained by linearizing the stationary wave function and the chemical potential around the results obtained for vanishing nonlinearity .",
    "the resulting equations are simple to solve as they allow for a recursive treatment , however effects like multistabilities and bifurcations typical for systems with nonlinear dynamics can not be obtained .",
    "the third regime describing quantum graphs with weak nonlinear interaction but moderately large intensities at large wave numbers ( or large bond lengths ) allows to describe multistabilities and bifurcations as the underlying equations connecting the solutions at the vertices remain nonlinear . compared to an exact analysis , this regime offers a reduced complexity .",
    "numerically this leads to much shorter computation times .",
    "analytically it opens the way to find some asymptotic solutions and their nonlinear properties .",
    "+ in the case of closed graphs , we focused on determining spectral curves @xmath138 , i.e.  we determined the discrete allowed values indexed by @xmath106 of the wave number as a function of the norm @xmath155 of the wave function .",
    "we considered here the nonlinear interval , star graphs , the ring and the tadpole graph and explained the simplifications induced by the canonical perturbation theory .",
    "e.g.  for the nonlinear interval we obtain an explicit expression for the spectral curves within canonical perturbation theory , whereas only an implicit expression was available from exact calculations . for star graphs we could show numerically that the asymptotic description captures the bifurcations present in the exact solutions . for the ring we could analyse the bifurcation scenario within canonical perturbation theory . for the tadpole graph we established some complex solutions in the asymptotic large wave number regime . + for open graphs we focused on the transmitted intensity and scattering phase . for the nonlinear interval connected to one lead we derived in our perturbative approach a simple condition for the onset of multistabilities that we confirmed numerically .",
    "we also calculated the scattering phase for the nonlinear interval connected to two leads and the infinite tadpole .",
    "+ canonical perturbation theory is usually used to describe either small perturbations of an integrable hamiltonian system or the vicinity of a periodic orbit with elliptic stability . to our knowledge",
    ", our work is the first extending this analysis to quantum graphs with nonlinear interaction on the bonds .",
    "thus the aim of our work is to give a first overview over the possibilities provided by canonical perturbation theory leaving plenty of open questions : the bifurcation scenarios and classification of spectral curves for the closed star graph and the tadpole graph remain incomplete . characterizing bifurcation scenarios by canonical perturbation theory in more complicated nonlinear scattering systems would be of interest as well . a first step would be to consider here the nonlinear interval connected to two leads or the infinite tadpole .",
    "another interesting question is if there is any way to approximate the exact solutions obtained at negative chemical potential by canonical perturbation theory .",
    "+ here we focussed on the cubic nlse ",
    "the approach has also been developed to the non - cubic case ( see @xcite ) and may be extended to other nonlinear wave equations on quantum graphs .",
    "furthermore , several interesting modifications and applications of quantum graphs without nonlinearity have been developed in the past , that call for including effects of nonzero nonlinearity .",
    "one example are fat graphs consisting of bonds with finite widths @xcite .",
    "what is the effect of nonlinear interaction on quantum spectral filters modelled by star graphs @xcite ?",
    "+ nonlinear equations play in general a fundamental role for describing the dynamics in physical systems .",
    "an extension of the method applied here to networks with the dynamics determined by the burgers equation , the dirac equation with nonlinearity @xcite , korteweg - de vries @xcite or the sine - gordon equation @xcite could lead to new insights into bifurcations present in these systems .",
    "+ finally , all of the results of the paper are obtained using the model of quantum graphs .",
    "it would be interesting how well such a model can be realized and our predicted effects can be confirmed in experiments by considering optical fiber networks or one dimensional ( cigar - like ) bose - einstein condensates .",
    "we would like to thank uzy smilansky for initial discussions during research stays of both authors at the weizmann institute and the weizmann institute of science for hospitality .",
    "d.w .   acknowledges financial support from the minerva foundation making this research stay possible .",
    "s.g . would like to thank the technion for hospitality and the joan and reginald coleman - cohen fund for support .",
    "we use the following notation for elliptic integrals        where @xmath446 , @xmath447 and @xmath448 .",
    "jacobi s elliptic function @xmath449 , the elliptic sine , is defined as the inverse of @xmath450 @xmath451 extended to a periodic function with period @xmath452 .",
    "the corresponding elliptic cosine @xmath453 is @xmath454 such that @xmath455 .",
    "we also use the non - negative function @xmath456    10 s.  gnutzmann , d.  waltner , phys .",
    "e  * 93 * , 032204 ( 2016 ) .",
    "l.  d.  carr , c.  w.  clark , w.  p.  reinhardt , phys .",
    "a * 62 * , 063610 ( 2010 ) .",
    "l.  d.  carr , c.  w.  clark , w.  p.  reinhardt , phys .",
    "a * 62 * , 063611 ( 2010 ) .",
    "r.  adami , c.  cacciapuoti , d.  finco , d.  noja , j. phys .",
    "a : math .  theor .  * 45 * , 192001 ( 2012 ) .",
    "r.  adami , c.  cacciapuoti , d.  finco , d.  noja , europhys .",
    "* 100 * , 10003 ( 2012 ) .",
    "r.  adami , d.  noja , commun .",
    "phys .  * 318 * , 247 ( 2013 ) .",
    "r.  adami , c.  cacciapuoti , d.  finco , d.  noja , j. diff .",
    "eq .  * 257 * , 3738 ( 2014 ) .",
    "r.  adami , c.  cacciapuoti , d.  finco , d.  noja , ann .",
    "i.  h.  poincare * 31 * , 1289 ( 2014 ) . c.  cacciapuoti , d.  finco , and d.  noja , phys .",
    "e * 91 * , 013206 ( 2015 ) .",
    "d.  noja , d.  pelinovsky , g.  shaikhova , nonlinearity * 28 * , 2343 ( 2015 ) .",
    "t.  kottos , u.  smilansky , phys .",
    "85 * , 968 ( 2000 ) .",
    "t.  kottos , u.  smilansky , j.  phys .",
    "a * 36 * , 3501 ( 2003 ) .",
    "r.  adami , c.  cacciapuoti , d.  finco , d.  noja , rev .",
    "* 23 * , 409 ( 2011 ) .",
    "z.  sobirov , d.  matrasulov , k.  sabirov , s. sawada , k.  nakamura , phys .",
    "e * 81 * , 066602 ( 2010 ) .",
    "j.  holmer , j.  marzuola , m.  zworski , commun .",
    "phys .  * 274 * , 187 ( 2007 ) .",
    "h.  uecker , d.  grieser , z.  sobirov , d.  babajanov , d.  matrasulov , phys ,  rev .",
    "e * 91 * , 023209 ( 2015 ) .",
    "k.  rapedius , d.  witthaut , h.j .",
    "korsch , phys .",
    "a * 73 * , 033608 ( 2006 ) .",
    "k.  rapedius , h.j .",
    "korsch , phys .",
    "a * 77 * , 033610 ( 2008 ) .",
    "s.  gnutzmann , u.  smilansky , s.  derevyanko , phys .",
    "rev .  a  * 83 * , 033831 ( 2011 ) .",
    "s.  gnutzmann , h.  schanz , u.  smilansky , phys .",
    "lett .  * 110 * , 094101 ( 2013 ) .",
    "d.  waltner , u.  smilansky , act .",
    "phys .  pol .",
    "* 124 * , 1087 ( 2013 ) .",
    "d.  waltner , u.  smilansky , j.  phys .  a  * 47 * , 355101 ( 2014 ) .",
    "o.  turek , t.  cheon , europhys .",
    "* 98 * 50005 ( 2012 ) .",
    "o.  turek , t.  cheon , ann .",
    "( ny ) * 330 * 104 ( 2013 ) . c.  cacciapuoti , r.  carlone , d.  noja , a. posilicano , arxiv:1607.00665 .",
    "d.  mugnolo , d.  noja , c.  seifert , arxiv:1608.01461 .",
    "z.  sobirov , d.  babajanov , d.  matrasulov , k. nakamura , h.  uecker , arxiv:1511.02314 ."
  ],
  "abstract_text": [
    "<S> we consider exact and asymptotic solutions of the stationary cubic nonlinear schrdinger equation ( nlse ) on metric graphs . </S>",
    "<S> we focus on some basic example graphs . </S>",
    "<S> the asymptotic solutions are obtained using the canonical perturbation formalism developed in our earlier paper @xcite . </S>",
    "<S> for closed example graphs ( interval , ring , star graph , tadpole graph ) we calculate spectral curves and show how the description of spectra reduces to known characteristic functions of linear quantum graphs in the low intensity limit . </S>",
    "<S> analogously for open examples we show how nonlinear scattering of stationary waves arises and how it reduces to known linear scattering amplitudes at low intensities . </S>",
    "<S> + in the short - wave length asymptotics we discuss how genuine nonlinear effects such as may be described using the leading order of canonical perturbation theory : bifurcation of spectral curves ( and the corresponding solutions ) in closed graphs and multistability in open graphs . </S>"
  ]
}