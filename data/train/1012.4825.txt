{
  "article_text": [
    "the space of automorphic forms over @xmath11 is an extensively studied object and many explicit results about its structure are known , for instance , one knows the dimensions of certain subspaces like spaces of cusp forms with a fixed weight and ramification .",
    "the function field analog of the rational numbers are rational function fields @xmath12 $ ] .",
    "the space of automorphic forms is also in these cases well - studied .",
    "a major tool of investigation are hecke operators , for which explicit formulas are available for both @xmath11 and @xmath12 $ ] .",
    "the action of hecke operators is less known for other global fields than @xmath11 and @xmath12 $ ] . in particular , explicit formulas for the action of hecke operators over function fields of genus @xmath13 or higher are not available in literature  with one exception , which are elliptic function fields with odd class number .",
    "we explain below how to extract these explicit formulas from results in literature and why this method works only for odd class number .",
    "we will see that the only satisfying cases are elliptic function fields with class number @xmath13 , which includes , up to isomorphism , only three fields ( cf .",
    "example [ eg_class_number_1 ] ) .    in this paper we shall work out explicit equations for hecke operators over any elliptic function field . this will be done in terms of the graph of an hecke operator , which is a tool introduced exactly for this purpose ( cf .",
    "we extract formulas from these graphs and employ them to calculate the space of cusp forms , the space of toroidal automorphic forms as well as some other spaces .",
    "note that in this exposition as well as throughout the paper , we will restrict ourselves to unramified automorphic forms and unramified hecke operators exclusively , and we agree to suppress the attribute `` unramified '' from our terminology .",
    "we continue with explaining what can be deduced from literature about hecke operators for elliptic function fields .",
    "let the @xmath0 be the function field of an elliptic curve @xmath1 over a finite field @xmath2 .",
    "let @xmath14 be a place of @xmath0 .",
    "we denote by @xmath15 the completion of @xmath0 at @xmath14 , by @xmath16 its integers , by @xmath17 a uniformizer and by @xmath18 the cardinality of the residue field @xmath19 .",
    "the bruhat - tits tree @xmath20 of @xmath15 is a graph with vertex set @xmath21 .",
    "there is an edge between two cosets @xmath22 $ ] and @xmath23 $ ] if and only if @xmath23 $ ] contains @xmath24 or @xmath25 for some @xmath26 .",
    "note that this condition is symmetric in @xmath27 and @xmath28 , so @xmath20 is a geometric graph .",
    "in fact , @xmath20 is a @xmath29-regular tree .",
    "we define the action of the local hecke operator @xmath30 on the space of complex valued functions @xmath31 on the vertices of @xmath20 by the formula @xmath32 let @xmath33 be the dedekind ring of all elements @xmath34 with @xmath35 for all places @xmath36 .",
    "then @xmath37 acts on @xmath20 by left multiplication , which induces an action of @xmath38 on the functions on @xmath39 .",
    "this action commutes with the action of @xmath30 .",
    "if the class number @xmath9 of @xmath0 as well as the degree of @xmath14 is odd , then the strong approximation property of @xmath40 implies that the inclusion of @xmath41 into @xmath42 induces a bijection @xmath43 where @xmath44 is the maximal compact subring of the adeles @xmath45 of @xmath0 ( cf .",
    "we denote the quotient on the right hand side by @xmath46 .",
    "an automorphic form is a function @xmath31 on @xmath46 , or , equivalently , on @xmath47 , which satisfies , as a ( @xmath38-invariant ) function on @xmath39 , that @xmath48 spans a finite - dimensional complex vector space .",
    "note that the local hecke operator @xmath30 corresponds to a ( global ) hecke operator @xmath49 . to be more precise",
    ", the bijection @xmath50 induces an isomorphism between the function spaces on these sets , which is equivariant with respect to the operators @xmath30 and @xmath49 .",
    "thus we can regard @xmath31 as a function on the quotient @xmath47 .",
    "shuzo takahashi calculates this quotient for places @xmath14 of degree @xmath13 in @xcite .",
    "this means that he describes representatives in @xmath41 for the double quotient @xmath51 .",
    "the full subgraph of the classes of these representatives in @xmath39 is a tree , and this tree is isomorphic to the quotient graph @xmath52 .",
    "we illustrate the quotient graph together with some matrix representatives of vertices in figure [ figure_takahashi ] .",
    "the element @xmath53 varies through all elements in @xmath2 . whether @xmath54 represents a vertex to the right or to the left of @xmath55 depends on whether the weierstrass polynomial @xmath56 for @xmath1 has a root in @xmath57 for @xmath58 or not .    ]",
    "this quotient graph , in turn , is isomorphic to the graph of @xmath49 ( when weights are suppressed ) , which is illustrated in figure [ ell_h_odd_graph ] ( see section [ section_examples ] ) .",
    "takahashi further determines the stabilizers of @xmath38 acting @xmath39 , which allows to compute the action of @xmath30 on a function on @xmath59 by the formula @xmath60 \\cdot f(v')\\;.\\ ] ]    an automorphic form that is an simultaneous eigenfunction for all hecke operators is determined by the set of its eigenvalues . in the case that the class number is @xmath13 , the automorphic form is already determined by the eigenvalue with respect to @xmath49 respective @xmath30 , up to finitely many exceptions . for computations that profit from this point of view ,",
    "see @xcite .",
    "if the class number is odd , but not @xmath13 , then the eigenvalue with respect to @xmath30 does not suffice to determine an automorphic form , but we need to consider the action of other hecke operators as well .",
    "this leads to the difficulty to identify the representatives of @xmath46 in @xmath41 with the representatives in @xmath61 where @xmath62 is a different place of degree @xmath13 . from the viewpoint of",
    "takahashi s paper , this seems to be a difficult problem .",
    "even worse , if the class number is even , the correspondence between the local and the global situation breaks down and we are not able to draw any of the above conclusions .    for this reason ,",
    "the notion of the graph of an hecke operator was introduced in @xcite , which relates to automorphic forms as functions on @xmath46 directly , without making use of the tree @xmath20 .",
    "the interpretation of @xmath46 as the set of isomorphism classes of @xmath3-bundles on @xmath1 allows us to apply geometric methods , which prove to be very efficient .",
    "this gives access to a simultaneous consideration of all hecke operators , for both odd and even class number .",
    "note that we will restrict ourselves to the geometric viewpoint for the rest of this paper , in contrast to the above exposition .",
    "more details on the relation between the geometric and the arithmetic setting can be found in @xcite .",
    "the paper is organized into two parts . in part",
    "[ part_graphs ] , we determine the graphs @xmath63 of the hecke operators @xmath49 for degree @xmath13 places @xmath14 . in section [ section_graphs ] , we recall the definition of the graphs @xmath63 in the more general setting of an arbitrary global function field .",
    "we review the structure theory for @xmath63 as developed in @xcite . in particular",
    ", we explain that @xmath63 decomposes into finitely many cusps , which are subgraphs that have a simple description , and into a finite subgraph , which is called the nucleus of @xmath63 . in section [ section_vertices ] , we determine the vertices of the nucleus as a consequence of atiyah s classification of vector bundles on elliptic curves . in section [ section_edges ] , we determine the edges in the nucleus by extensive use of the methods from @xcite . in section [ section_examples ] ,",
    "we illustrate examples of graphs of hecke operators .    in part",
    "[ part_applications ] , we apply the knowledge about the graphs @xmath63 to explicit calculations with automorphic forms . in section [ section_automorphic ] ,",
    "we review the notion of an automorphic form as a function on the graph .",
    "we write out explicit formulas for an hecke operator @xmath49 acting on an eigenfunction . in section",
    "[ section_cusp ] , we calculate the space of cusp forms .",
    "this means that we determine its dimension and the ( maximal ) support of a cusp form .",
    "we show that the space of cusp forms is a @xmath64-eigenspace for every @xmath49 where @xmath14 is a place of odd degree .",
    "we prove further that a cuspidal hecke eigenform does not vanish in the trivial @xmath3-bundle . in section [ section_toroidal ] ,",
    "we calculate the space of @xmath4-toroidal automorphic forms where @xmath4 is the quadratic constant field extension of @xmath0 .",
    "in particular , we see that this space contains co non - trivial cusp form .",
    "we show that the space of toroidal automorphic forms is generated by a single eisenstein series @xmath6 where @xmath7 is a zero of the zeta function of @xmath0with a possible exception in the case that the characteristic of @xmath0 is @xmath65 and the class number @xmath9 of @xmath0 equals @xmath10 where the space of toroidal automorphic forms might be @xmath65-dimensional .",
    "this paper is extracted from my thesis @xcite .",
    "i would like to thank gunther cornelissen for his advice during my graduate studies .",
    "[ part_graphs ]",
    "in this section , we recall the definition of the graphs @xmath63 of the hecke operators @xmath49 as introduced in @xcite . these graphs encode the action of certain unramified hecke operators @xmath49 which act on the space of automorphic forms for @xmath66 over a global function field @xmath0 .",
    "the connection to the hecke operators @xmath49 will be explained in section [ section_automorphic ] .",
    "we concentrate in this resume on the geometric point of view . for the translation into adelic language , see section 5 in @xcite .",
    "[ def_hecke_graphs ] let @xmath8 be a prime power and @xmath1 a smooth projective geometrically irreducible curve over @xmath2 with function field @xmath0 .",
    "let @xmath67 be the set of closed points of @xmath1 , which we identify with the set of places of @xmath0 .",
    "let @xmath68 be the constant field extension of @xmath1 to @xmath69 and @xmath70 the constant field extension of @xmath1 to the algebraic closure @xmath71 of @xmath2 .",
    "for @xmath72 equal to @xmath1 , @xmath73 or @xmath74 , we denote by @xmath75 the picard group of @xmath72 and by @xmath76 the set of isomorphism classes of rank @xmath65 bundles over @xmath72 .",
    "the picard group @xmath75 acts on @xmath76 via the tensor product .",
    "we denote the quotient by @xmath77 , which is the same as the set of isomorphism classes of @xmath3-bundles over @xmath72 .",
    "we write @xmath78\\in\\pbun_2 y$ ] if the class @xmath78 $ ] is represented by the rank @xmath65 bundle @xmath79 , and @xmath80 if @xmath78=[\\cm']$ ] .",
    "we identify @xmath79 with the associated locally free sheaf of rank @xmath65 .",
    "two exact sequences of sheaves @xmath81 are _ isomorphic with fixed @xmath82 _ if there are isomorphisms @xmath83 and @xmath84 such that @xmath85&{\\cf_1}\\ar[r]\\ar[d]^\\simeq&{\\cf}\\ar[r]\\ar@{=}[d]&{\\cf'_1}\\ar[r]\\ar[d]^\\simeq&0\\\\ 0\\ar[r]&{\\cf_2}\\ar[r]&{\\cf}\\ar[r]&{\\cf'_2}\\ar[r]&0}\\ ] ] commutes .",
    "fix a place @xmath14 .",
    "let @xmath86 be the torsion sheaf that is supported at @xmath14 and has stalk @xmath87 at @xmath14 , where @xmath87 is the residue field at @xmath14 .",
    "fix a representative @xmath79 of @xmath78\\in\\pbun_2 x$ ] .",
    "we define @xmath88,[\\cm'])$ ] as the number of isomorphism classes of exact sequences @xmath89&{\\cm''}\\ar[r]&{\\cm}\\ar[r]&{\\ck_x}\\ar[r]&0}}\\ ] ] with fixed @xmath79 and with @xmath90 .",
    "this number is independent of the choice of representative @xmath79 ( cf .",
    "5.4 ) ) .    for a @xmath3-bundle @xmath91",
    "we define @xmath92 and call the occurring @xmath93 the _ @xmath49-neighbours of @xmath94 _ , and @xmath95 their _",
    "multiplicity_.    we define the graph @xmath63 by @xmath96 where an edges from @xmath94 to @xmath93 comes together with a weight @xmath97 .",
    "we list some facts about the graphs @xmath63 . by definition ,",
    "the weight of an edge is a positive integer , and there is at most one edge between two vertices .",
    "every edge @xmath98 has an inverse edge , i.e.  there is an edge @xmath99 in @xmath63 for some positive integer @xmath100 , which in general differs from @xmath101 ( cf .",
    "the weights of all edges @xmath98 with origin @xmath94 sum up to @xmath102 where @xmath103 is the cardinality of @xmath87 ( cf .",
    "in particular , @xmath63 is a locally finite graph .",
    "we illustrate a single edge @xmath98 by @xmath104 and a pair of inverse edges @xmath98 and @xmath99 by @xmath105 ( note that in all examples of the present paper @xmath106 for an edge @xmath98 of @xmath63 ) .",
    "we encourage the reader to have a glance at the examples in section [ section_examples ] .",
    "[ char_pbundec][char_pbuntr ] more details on the facts listed in this paragraph can be found in sections 6 and 7 of @xcite .",
    "a line subbundle of a rank @xmath65 bundle @xmath79 is a morphism @xmath107 where @xmath108 is a line bundle such that the quotient @xmath109 is torsion free and thus also a line bundle .",
    "we define @xmath110 as @xmath111 and @xmath112 as the supremum of @xmath110 over all subbundles @xmath107 . if @xmath80 , then @xmath113 , so @xmath114)=\\delta(\\cm)$ ] is well - defined for @xmath78\\in\\pbun_2 x$ ] .",
    "for all rank @xmath65 bundles @xmath79 there is a line subbundle @xmath107 such that @xmath115 .",
    "we call such a line subbundle a _",
    "maximal subbundle of @xmath79_. for every @xmath116 , we have @xmath117 where @xmath27 is the genus of @xmath1 .",
    "the set @xmath118 is the disjoint union of the following three subsets : the set @xmath119 of classes that are represented by rank @xmath65 bundles that decompose into a direct sum of two line bundles , the set @xmath120 of classes that are represented by indecomposable rank @xmath65 bundles that decompose over @xmath73 into the sum of two line bundles and the set @xmath121 of classes that are represented by geometrically indecomposable rank @xmath65 bundles .",
    "classes in @xmath119 can be represented by a rank @xmath65 bundle of the form @xmath122 where @xmath123 is the structure sheaf of @xmath1 and @xmath124 is the line bundle associated to the divisor class @xmath125 in the divisor class group @xmath126 ( cf .",
    "ii.6.13 ) ) .",
    "we denote the corresponding class in @xmath119 by @xmath127 .",
    "we have that @xmath128 if and only if @xmath129 or @xmath130 in @xmath126 ( cf .",
    "6.3 ) ) .",
    "classes in @xmath120 are represented by the trace of a line bundle @xmath108 over @xmath73 .",
    "a line bundle over @xmath73 corresponds to a divisor class @xmath131 , and we denote the class in @xmath118 represented by the trace of @xmath124 by @xmath132 .",
    "note that @xmath133 if and only if @xmath134 , and otherwise @xmath135 .",
    "we have @xmath136 if and only if @xmath129 or @xmath130 in @xmath137 ( cf .",
    "the integer @xmath138 is even and negative for @xmath139 .",
    "the set @xmath121 depends heavier on the arithmetic of the given curve @xmath1 . for @xmath140",
    ", we have that @xmath141 .",
    "consequently , @xmath121 is empty if the genus of @xmath1 is @xmath64 . for genus @xmath13",
    ", we will determine @xmath121 in theorem [ ell_pbungi ] .",
    "we recall the definitions of the nucleus and the cusps of @xmath63 .",
    "more details on the following can be found in section 8 of @xcite .",
    "let @xmath142 .",
    "nucleus @xmath143 of @xmath63 _ is the full subgraph of @xmath63 whose vertex set consists of all those @xmath144 with @xmath145 . for every @xmath146 , the _ cusp @xmath147 _",
    "is defined as the full subgraph of @xmath63 whose vertex set consists of all vertices of the form @xmath148 with @xmath149 and @xmath150 .",
    "in particular , a cusp depends only on the class @xmath151\\in\\operatorname{cl}x/\\langle x\\rangle$ ] .",
    "these classes are represented by @xmath146 with @xmath152 ; consequently there are @xmath153 cusps where @xmath154 is the class number of @xmath0 . if @xmath125 is such a representative , then the cusp @xmath147 looks like @xmath155 the graph @xmath63 is the union of the nucleus and the cusps .",
    "the union of edges is disjoint .",
    "the vertex sets of different cusps are disjoint and the intersection of @xmath156 with @xmath157 equals @xmath158 if @xmath152 . note that both @xmath120 and @xmath121 are contained in the vertex set of @xmath143 .",
    "the connected components of @xmath63 stay in bijection with the @xmath65-torsion elements of @xmath159 .",
    "in particular , @xmath63 is connected if and only if the class number of @xmath0 is odd .",
    "in this section , we determine the set @xmath118 of all isomorphism classes of @xmath3-bundles for a curve @xmath1 of genus @xmath13 . in paragraph",
    "[ char_pbundec ] , we already described the subsets @xmath119 and @xmath120 .",
    "this reduces the problem to classifying the classes in @xmath121 .",
    "[ ell_basics ] from now on , let @xmath1 be a curve of genus @xmath13 over @xmath2 with function field @xmath0 , @xmath126 the divisor class group and @xmath9 the class number .",
    "the canonical sheaf @xmath160 is isomorphic to the structure sheaf @xmath123 .",
    "the map @xmath161 , which is defined by considering an @xmath2-rational point as a prime divisor of degree @xmath13 , is a bijection .",
    "we identify these sets .",
    "the choice of an @xmath162 defines the bijection @xmath163 so @xmath164 inherits a group structure and @xmath1 becomes an elliptic curve .",
    "[ rr_for_ell_curves ] the riemann - roch theorem reduces to @xmath165 . since @xmath166 is non - zero if and only if @xmath108 is associated to an effective divisor ( cf .",
    "ii.7.7(a ) ) ) , we obtain : @xmath167    by serre duality , @xmath168 is one - dimensional .",
    "the multiplicative group @xmath169 acts on @xmath170 , and this action preserves the isomorphism type of the rank @xmath65 bundle @xmath79 that is determined by an extension of @xmath123 by itself ( cf .",
    "consequently , there is only one rank @xmath65 bundle @xmath171 , up to isomorphism , that is a non - trivial extension of @xmath123 by itself .",
    "since @xmath172 , ( * ? ? ?",
    "* lemma 7.6 ) implies that @xmath173 , and since @xmath174 , the vector bundle @xmath171 is indecomposable . since for @xmath139 , we have @xmath175 , it follows that @xmath176\\in\\pbungi x$ ] .",
    "we denote this class by @xmath177 .",
    "let @xmath14 be a place of degree @xmath13 and let @xmath178 denote the line bundle associated to the divisor class @xmath179\\in\\operatorname{cl}x$ ] .",
    "the @xmath2-vector space @xmath180 is also one - dimensional , and the non - trivial extensions define a rank @xmath65 bundle @xmath181 . in this case ,",
    "@xmath182 and @xmath183 is a maximal subbundle . indeed ,",
    "if there was a subbundle @xmath184 of positive degree , ( * ? ? ?",
    "* lemma 7.6 ) would imply that @xmath185 and @xmath186 .",
    "but @xmath187 , thus we contradict the assumption that @xmath181 is a non - trivial extension of @xmath178 by @xmath123 . by the considerations of paragraph [ char_pbundec ] on the values of @xmath188",
    "we know that @xmath189\\in\\pbungi x$ ] .",
    "we denote this class by @xmath190 .",
    "[ rem_d_vs_[d ] ] the notations for the vector bundles @xmath178 and @xmath181 of the previous paragraph is the same as the notation for the stalk of some vector bundles @xmath108 respective @xmath79 at @xmath14 . to avoid confusion , we will reserve the notations @xmath178 and @xmath181 strictly for the vector bundles as defined in the last paragraph throughout the whole paper .",
    "[ ell_pbungi ] @xmath191 and @xmath192 if and only if @xmath193 .",
    "let @xmath72 denote one of @xmath1 , @xmath194 or @xmath195 .",
    "let @xmath196 be the set of isomorphism classes of geometrically indecomposable rank @xmath197 bundles over @xmath72 that have degree @xmath198 .",
    "we have inclusions @xmath199 ( cf .",
    "6.1 ) ) . for a rank @xmath13 bundle @xmath108 over @xmath72 , the map @xmath200 defines a bijection of sets for every @xmath201 and @xmath202 .",
    "we have to determine the orbits of @xmath203 in @xmath204 and @xmath205 to verify the theorem .",
    "we already know that @xmath206 and @xmath207 for all @xmath208 .",
    "for the case @xmath209 , we use the following result of atiyah .    for all @xmath210 , there exists a unique @xmath211 such that @xmath212 .",
    "this implies that for every @xmath213 , there exists a unique @xmath214 such that @xmath215 .",
    "the action of @xmath216 and @xmath217 on vector bundles over @xmath74 commute , and thus for every @xmath218 , @xmath219 by uniqueness , @xmath220 ; thus @xmath221 .",
    "hence @xmath78=s_0\\in\\pbungi x$ ] .    for @xmath222 , we restate atiyah s classification of indecomposable vector bundles over @xmath74 .",
    "[ atiyah_thm7 ] there are bijections @xmath223 such that the diagrams @xmath224^{\\varphi_n^d } \\ar[d]^{\\det } & { \\operatorname{pic}^0(\\overline x)}\\ar[d]^{(n , d ) } \\\\               { \\cb_1^d(\\overline x)}\\ar[r]^{\\varphi_1^d }                & { \\operatorname{pic}^0(\\overline x ) } }",
    "\\ ] ] commute for all @xmath225 and @xmath202 .",
    "here @xmath226 denotes multiplication with the greatest common divisor of @xmath197 and @xmath198 .",
    "this means that @xmath227 is a bijection , and consequently the restriction is still injective . because every element of @xmath228 is of the form @xmath178 for some place @xmath14 of degree @xmath13 and because @xmath229 , we obtain that @xmath230 .    by the injectivity of the determinant map , @xmath231 for some @xmath221 if and only if @xmath232 , or , equivalently , @xmath233 .",
    "this proves theorem [ ell_pbungi ] .",
    "[ const_ext_pbungi ] theorem [ ell_pbungi ] shows that non - isomorphic @xmath3-bundles that are geometrically indecomposable may become isomorphic after extension of the base field  in contrast to the opposite result for @xmath119 and @xmath120 ( ( * ? ? ?",
    "* lemma 6.5 ) ) .",
    "namely , if @xmath234 , then @xmath190 and @xmath235 are not isomorphic .",
    "but there is a finite constant extension @xmath236 such that @xmath237 , since geometrically the class group of an elliptic curve is divisible .",
    "thus @xmath190 and @xmath235 become isomorphic over @xmath72 . for a concrete example , consider @xmath238 , and @xmath239 as in paragraph [ example_x_6 ] .",
    "[ repr_s_x ] if a rank @xmath65 bundle @xmath79 has @xmath240 and @xmath241 , then @xmath79 represents @xmath190 .",
    "a rank @xmath65 bundle @xmath79 with @xmath240 must be geometrically indecomposable .",
    "the corollary follows from the fact that every element of @xmath205 is characterised by its determinant .",
    "let @xmath242 .",
    "then the nucleus @xmath143 of the graph @xmath63 consists of the vertices @xmath243    theorem [ ell_pbungi ] describes @xmath121 , which is contained in the vertex set of the nucleus .",
    "the description of all other vertices follows from the definition of the nucleus and the classification of @xmath119 and @xmath120 as described in paragraph [ char_pbundec ] .",
    "in this section , we investigate the edges of the graphs @xmath63 for degree @xmath13 places @xmath14 , i.e.  @xmath242 . in section [ section_graphs ] , we described these graphs up to the nucleus @xmath143 and in the previous section we determined the vertices of @xmath143 .",
    "we illustrate our knowledge in figure [ figure_genstr_ell ] .     up to a finite number of edges ]",
    "fix a place @xmath14 of degree @xmath13 .",
    "the divisor classes of degree @xmath64 can be represented by @xmath244 where @xmath245 is place of degree @xmath13 which is uniquely determined by the divisor class @xmath244 .",
    "the following theorem characterizes all missing edges of @xmath63 .",
    "[ str_thm_graphs_for_genus_1 ] let @xmath14 be a prime divisor of degree @xmath13 and @xmath246 $ ] the cardinality of the @xmath65-torsion of the class group .",
    "then the edges with origin in @xmath143 are given by the following list : @xmath247 , \\\\    \\cu_x(c_{y - x } ) & = \\{(c_{y - x},c_y,1),(c_{y - x},c_{2x - y},1),(c_{y - x},s_y , q-1)\\ } \\hspace{0,6 cm } \\text{if } y - x\\notin(\\operatorname{cl}x)[2 ] , \\\\",
    "\\cu_x(s_0 ) & = \\{(s_0,c_x,1),(s_0,s_x , q)\\}\\ ; , \\\\",
    "\\cu_x(t_d ) & = \\{(t_d , s_{x+d+\\sigma d},q+1)\\ } \\hspace{0,6 cm } \\text{for }",
    "d\\in\\operatorname{cl}^0 x'-\\operatorname{cl}^0 x \\text { and } \\\\",
    "\\cu_x(s_y ) & = \\{(s_y , s_0,h_2)\\mid \\text{if } y\\equiv x\\pmod{2\\operatorname{cl}^0x}\\ } \\vspace{0,3cm}\\\\                      & \\quad\\cup \\",
    "\\left\\{\\ ( s_y , c_{z - x},\\tfrac 12 h_2)\\ \\left|\\                                 \\begin{subarray}{l}\\text{if } ( z - x)\\in(\\operatorname{cl}^0 x)[2],\\\\                                                    z\\neq x\\text { and } ( z - y)\\in2\\operatorname{cl}^0x \\end{subarray}\\                                   \\right.\\right\\ } \\vspace{0,3cm}\\\\                      & \\quad\\cup \\",
    "\\left\\{\\ ( s_y , c_{z - x},h_2)\\ \\left|\\                                \\begin{subarray}{l}\\text{if } ( z - x)\\notin(\\operatorname{cl}^0 x)[2]\\\\                                                    \\text{and } ( z - y)\\in2\\operatorname{cl}^0x\\end{subarray}\\                                   \\right.\\right\\ } \\vspace{0,3cm}\\\\                      & \\quad\\cup \\ \\left\\{\\ ( s_y , t_d,\\tfrac 12 h_2)\\ \\left|\\                                \\begin{subarray}{l}\\text{if } d\\in(\\operatorname{cl}^0x'-\\operatorname{cl}^0x),\\,2d\\in\\operatorname{cl}^0x\\\\                                                    \\text{and } y\\equiv d+\\sigma d+x \\pmod{2\\operatorname{cl}^0x } \\end{subarray}\\                                   \\right.\\right\\ } \\vspace{0,3cm}\\\\                      & \\quad\\cup \\",
    "\\left\\{\\ ( s_y , t_d , h_2)\\ \\left|\\                                \\begin{subarray}{l}\\text{if } d\\in(\\operatorname{cl}^0x'-\\operatorname{cl}^0x),\\,2d\\notin\\operatorname{cl}^0x\\\\                                                    \\text{and } y\\equiv d+\\sigma d+x \\pmod{2\\operatorname{cl}^0x } \\end{subarray}\\                                   \\right.\\right\\ } \\hspace{0,6cm}\\text{for } y\\in\\operatorname{cl}^1x .",
    "\\end{aligned}\\ ] ]    the rest of this section is dedicated to the proof of the theorem .",
    "there are illustrations of the sets described in the theorem at the appropriate places in the proof .",
    "we draw vertices @xmath94 from left to right to indicate an increasing value of @xmath138 . in section [ section_examples ]",
    "we show illustrations of entire graphs .",
    "we recall some results that we will use in the proof without further reference .",
    "the weights of all @xmath49-neighbours of each vertex sum up to @xmath10 ( ( * ? ? ?",
    "if @xmath94 and @xmath248 are @xmath49-neighbours , then @xmath249 ( ( * ? ?",
    "* lemma 8.2 ) ) .",
    "the @xmath49-neighbours @xmath93 of a vertex @xmath250 $ ] with @xmath251 counted with multiplicity are in bijection with the maximal subbundles of @xmath79 ( ( * ? ? ?",
    "* lemma 8.4 ) ) .",
    "this bijection is given by associating to a maximal subbundle @xmath107 the unique sequence @xmath252 such that @xmath107 lifts to a subbundle @xmath253 ( cf .",
    "* par .  8.3 ) ) .",
    "we call this sequence the _ sequence associated to @xmath107_.    we shall also need the following lemma .",
    "let @xmath254 be the kernel of @xmath255 , which is the inverse of the line bundle @xmath178 in @xmath159 .",
    "[ lift_split ] let @xmath107 be a line subbundle and @xmath89&{\\cm'}\\ar[r]&{\\cm}\\ar[r]&{\\ck_x}\\ar[r]&0}}\\ ] ] the associated sequence .",
    "let @xmath256 . if @xmath257 , then @xmath258 .",
    "note that @xmath259 .",
    "the hypothesis can be illustrated by the diagram @xmath85 & { \\cl}\\ar[r]\\ar@{=}[d ] & { \\cm'}\\ar[r]\\ar[d ] & { \\cl'\\ci_x}\\ar[r]\\ar[dl]{\\ar@ { > ->}@<-0,0ex>[}d ] & 0 \\\\               0\\ar[r ] & { \\cl}\\ar[r ] & { \\cm}\\ar[r ] & { \\cl'}\\ar[r]\\ar@/_/[l ] & 0 \\;.\\hspace{-5pt } } \\ ] ] since the composition @xmath260 is zero , @xmath261 lifts to @xmath262 , and the upper sequence also splits .",
    "we prove the theorem case by case .",
    "@xmath263    by ( * ? ? ?",
    "8.5 ) , @xmath264 is the only @xmath49-neighbour of @xmath265 , which describes @xmath266 completely :        let @xmath267 represent @xmath264 .",
    "we know from ( * ? ? ?",
    "8.5 ) that @xmath268 is the only neighbour @xmath269 with @xmath270 .",
    "it has multiplicity @xmath13 and is given by the sequence associated to @xmath271 . by lemma [ lift_split ] ,",
    "the sequence associated to @xmath272 gives @xmath273 as neighbour .",
    "for all other @xmath274 neighbours @xmath269 , neither @xmath271 nor @xmath272 lifts to @xmath269 , but then @xmath275 lifts to a subbundle @xmath276 .",
    "we have that @xmath277 , but @xmath278 can not have a complement , since otherwise @xmath272 would lift . thus @xmath269 must represent @xmath177 .",
    "this describes @xmath279 :        let @xmath280 represent @xmath281 with @xmath36 .",
    "again , we know from ( * ? ? ? * thm .",
    "8.5 ) that @xmath282 is the only neighbour @xmath269 with @xmath270 , and it has multiplicity @xmath13 . for all other @xmath8 neighbours",
    ", @xmath283 is a subbundle , and @xmath284 .",
    "but since @xmath285 , we have that @xmath286 ( paragraph [ rr_for_ell_curves ] ) , and thus @xmath269 decomposes .",
    "we obtain for @xmath287 :        let @xmath288 represent @xmath289 with @xmath36 . then the sequences associated to the two maximal subbundles @xmath290 and @xmath271 determine two neighbours @xmath291 and @xmath292 .",
    "they both decompose by lemma [ lift_split ] and represent @xmath281 and @xmath293 , respectively",
    ". for all other @xmath274 neighbours @xmath269 , no maximal line bundle lifts , and thus @xmath294 . since @xmath295 , by corollary [ repr_s_x ]",
    ", @xmath269 represents @xmath235 .",
    "we have @xmath296 if and only if @xmath297 , or equivalently , @xmath298 .",
    "this means that these two neighbours are the same if and only if @xmath299 $ ] .",
    "if this is the case , we get for @xmath300 :        if @xmath301 $ ] , @xmath300 looks like :        let @xmath79 be the bundle @xmath171 of paragraph [ rr_for_ell_curves ] , which represents @xmath177 . then it has a unique maximal subbundle @xmath272 and an associated neighbour @xmath269 with @xmath302 , which decomposes . because its maximal subbundle is @xmath278 , @xmath303 , and we recognize it as @xmath304",
    "thus @xmath269 represents @xmath264 .",
    "all @xmath8 other neighbours @xmath269 have @xmath305 , and @xmath306 . by corollary",
    "[ repr_s_x ] , @xmath307 and thus also @xmath269 represent @xmath190 , and @xmath308 is as follows :        let @xmath79 represent @xmath132 for a @xmath309",
    ". since @xmath310 , every neighbour @xmath269 of @xmath79 must have @xmath294 .",
    "it is determined by its determinant , which we can calculate by extending constants to @xmath73 .",
    "we have @xmath311 . because @xmath312 , corollary [ repr_s_x ] implies that @xmath269 represents @xmath313 .",
    "we obtain for @xmath314 :        the most subtle part is to determine the neighbours of @xmath235 for @xmath315 .",
    "we choose @xmath316 as representative for @xmath235 , see paragraph [ rr_for_ell_curves ] , and recall that it was defined by a nontrivial element in @xmath317 .",
    "thus @xmath318 , and @xmath319 .",
    "look at an exact sequence @xmath89&{\\cm'}\\ar[r]&{\\cm_y}\\ar[r]&{\\ck_x}\\ar[r]&0 } } \\;.\\ ] ] then @xmath320 , and @xmath321 . by the symmetry of edges ( see paragraph [ def_hecke_graphs ] )",
    ", @xmath235 must also be a neighbour of @xmath322 $ ] .",
    "but we have already determined the neighbours of vertices @xmath94 with these properties .",
    "we find that for @xmath323 , @xmath324 is a neighbour of @xmath235 if and only if @xmath325 , @xmath132 with @xmath326 is a neighbour of @xmath235 if and only if @xmath327 , and @xmath177 is a neighbour of @xmath235 if and only if @xmath328 , but @xmath265 is never a neighbour of @xmath235 .",
    "this shows that the theorem lists precisely the neighbours of @xmath235 .",
    "there is still some work to be done to determine the weights .",
    "we begin with an observation .",
    "[ only_one_sequence ] up to isomorphism with fixed @xmath316 , there is at most one exact sequence @xmath329 for a fixed @xmath269 .",
    "suppose there are two .",
    "we derive a contradiction as follows .",
    "if @xmath330 , then @xmath269 must be a trace of a line bundle @xmath108 defined over @xmath73 . by extending constants to @xmath69 , we may assume that @xmath331 and that there are @xmath332 such that @xmath269 is an extension of @xmath333 by @xmath108 .",
    "the composition @xmath334 defines a maximal subbundle of @xmath79 because @xmath335 .",
    "we get back the inclusion @xmath336 by taking the associated sequence .",
    "since we assume we have two different inclusions of @xmath269 into @xmath79 , we get two different subbundles of the form @xmath107 , thus an inclusion @xmath337 .",
    "the cokernel is a torsion sheaf of degree @xmath13 defined over @xmath69 , say @xmath338 for a place @xmath339 of @xmath340 , and we obtain an exact sequence @xmath89&{\\cl\\oplus\\cl}\\ar[r]&{\\cm_y}\\ar[r]&{\\ck_{x'}}\\ar[r]&0 } } \\;;\\ ] ] @xmath341 $ ] is thus an @xmath342-neighbour of @xmath316 .",
    "this is a contradiction as @xmath235 is not a neighbour of @xmath265 .",
    "we consider a second neighbour @xmath343 of @xmath316 that represents the same element as @xmath269 in @xmath344 , i.e.   @xmath345 for some @xmath346 .",
    "since they have the same determinant , @xmath347 , we have @xmath348 $ ] .",
    "on the other hand , theorem [ atiyah_thm7 ] tells us that for @xmath349 , @xmath350 if and only if @xmath348 $ ] .",
    "thus @xmath351 $ ] acts on the sequences that we investigate .",
    "by lemma [ only_one_sequence ] , we find that the multiplicity of a neighbour @xmath269 of @xmath316 equals the number of isomorphism classes that @xmath352 meets as @xmath353 varies through @xmath351=(\\operatorname{pic}^0 x)[2]$ ] .",
    "we begin with the case of a neighbour @xmath269 that is associated to a maximal subbundle @xmath354 . then @xmath355 . if @xmath356 , the only possibility with these properties is @xmath177 .",
    "but then @xmath253 is the only maximal subbundle , so all @xmath357 with @xmath358 $ ] have different associated sequences , and the multiplicity of @xmath177 is therefore @xmath359 $ ] .    if @xmath360 , then @xmath269 represents @xmath324 for the divisor @xmath361 that satisfies @xmath362 . since @xmath363 , we have @xmath364 . the rank @xmath65 bundle @xmath269 has two different maximal subbundles , and it could happen that @xmath365 for some @xmath358-\\{\\co_x\\}$ ] .",
    "this only happens if @xmath366 , so @xmath367 $ ] , or equivalently , @xmath368 $ ] .",
    "thus the multiplicity of @xmath324 as a neighbour of @xmath235 is @xmath369 if @xmath368-\\{0\\}$ ] and @xmath370 if @xmath371 $ ] .",
    "the last case is that of @xmath372 , where @xmath269 is the trace of a line bundle @xmath124 , where @xmath326 .",
    "if we lift the situation to @xmath73 , then @xmath373 , and we see as in the preceding case that @xmath365 for some @xmath358-\\{\\co_x\\}$ ] if and only if @xmath374 $ ] .",
    "this is equivalent to the two conditions @xmath375 and , or @xmath376 and @xmath377 , respectively , both saying that @xmath378 .",
    "this finally gives for @xmath326 that @xmath132 has multiplicity @xmath369 as neighbour of @xmath235 if @xmath378 and @xmath370 if @xmath379 .",
    "we illustrate this below .",
    "the dashed arrow only occurs if @xmath380 . the indices @xmath245 and @xmath125 take all possible values as in the theorem , and @xmath381 depends on the particular edge .",
    "this completes the proof of the theorem .",
    "this section provides some examples of graphs of hecke operators .",
    "[ eg_class_number_1 ] the easiest examples are given by elliptic curves with only one rational point @xmath14 .",
    "these examples can be found in the literature , cf .",
    "@xcite , ( * ? ? ? * and ex . 3 of 2.4 ) or @xcite .",
    "there are up to isomorphism three such elliptic curves : @xmath382 over @xmath383 defined by the weierstrass equation @xmath384 , @xmath385 over @xmath386 defined by the weierstrass equation @xmath387 and @xmath388 over @xmath389 defined by the weierstrass equation @xmath390 with @xmath391 . since the class number is @xmath13 , @xmath392 and @xmath393 for @xmath394 .",
    "one calculates that @xmath395 , @xmath396 and @xmath397 , thus @xmath398 has @xmath8 different elements @xmath399 for @xmath394 .",
    "we obtain figure [ ell_h=1_graph ] .     for the unique degree one place @xmath14 of the elliptic curves",
    "@xmath400 for @xmath401    [ illustrations_ell_graphs ] more generally , let the class number @xmath9 be odd .",
    "let @xmath14 a place of degree @xmath13 .",
    "then @xmath63 has only one component .",
    "we write @xmath402 where the @xmath403 s are ordered such that @xmath404 for @xmath405 and @xmath406",
    ". then we can illustrate the graph of @xmath49 as in figure [ ell_h_odd_graph ] .     for a degree one place @xmath14 of an elliptic curve with odd class number ]",
    "we give two examples for elliptic curves with even class number .",
    "both examples are elliptic curves over @xmath386 with class number @xmath407 , but with respective class group @xmath408 and @xmath409 .",
    "the first example is the elliptic curve @xmath410 over @xmath386 defined by the weierstrass equation @xmath411 , which has class group @xmath412 .",
    "let @xmath413 such that @xmath414 is the element of order @xmath65 .",
    "the number of components is @xmath415 , and @xmath121 is given by @xmath177 , @xmath416 and @xmath417 .",
    "the class group of @xmath418 is @xmath419 , thus @xmath420 .",
    "let @xmath421 be representatives such that @xmath125 is the divisor with @xmath422 .",
    "then @xmath423 contains the two elements @xmath132 and @xmath424 .",
    "we do not need to calculate the norm map @xmath425 as we can find out to which of @xmath426 and @xmath427 the vertices @xmath190 and @xmath428 are connected by the constraint that the weights around @xmath190 and @xmath428 , respectively , sum up to @xmath407 .",
    "the graph is illustrated in figure [ ell_h=4_grapha ] .     for a degree one place @xmath14 of the elliptic curve @xmath410 ]     for a degree one place @xmath14 of the elliptic curve @xmath430    [ example_x_6 ] the second example @xmath431 over @xmath386 is defined by the weierstrass equation @xmath432 , and has class group @xmath433 .",
    "here @xmath434 , and @xmath190 , @xmath235 , @xmath428 and @xmath435 are pairwise distinct vertices . for @xmath436 , @xmath437 , thus @xmath438 , which we represent by @xmath439 , each of the @xmath440 being of order @xmath65 .",
    "again , by the constraint that weights around each vertex sum up to @xmath407 , we find that @xmath441 contains three different traces of the line bundles corresponding to @xmath442 , @xmath443 and @xmath444 , which we denote by @xmath445 , @xmath446 and @xmath447 , and which are connected to @xmath235 , @xmath428 and @xmath435 , respectively . the graph is illustrated in figure [ ell_h=4_graphb ] .",
    "[ part_applications ]",
    "in this section , we will review the notion of an automorphic form as a function on the vertex set @xmath118 of the graphs @xmath63 .",
    "these geometrically defined automorphic forms correspond to unramified automorphic forms for @xmath448 over @xmath0 in the more common adelic language .",
    "the geometric viewpoint lets us extract explicit eigenvalue equations from the graphs @xmath63 , which we will list at the end of this section .",
    "this allows us to calculate the space of cusp forms and the space of toroidal automorphic forms in the following sections .     and their cardinalities ]    [ notation_toroidal_forms_for_genus_1 ] to begin with",
    ", we describe a useful picture of the graphs @xmath63 .",
    "define the following numbers : @xmath449=\\#\\{s_y\\}_{y\\in x(\\ff_q ) } ,        & h_2'\\hspace{-7pt}&=&\\hspace{-7pt}\\#(\\operatorname{cl}^0x'/\\operatorname{cl}^0x)[2],\\vspace{4pt}\\\\      r   \\hspace{-7pt}&=\\hspace{-7pt}&(h+h_2)/2 - 1=\\#\\{c_d\\}_{d\\in\\operatorname{cl}^0x-\\{0\\}},\\hspace{10pt }     & r '   \\hspace{-7pt}&=&\\hspace{-7pt}(h'+h'_2)/2 - 1=\\#\\{t_d\\}_{d\\in\\operatorname{cl}x'-\\operatorname{cl}x}.   \\end{array}\\ ] ] the equality in the definition of @xmath370 follows from theorem [ ell_pbungi ] and the equalities in definitions of @xmath9 , @xmath450 and @xmath451 follow from what we explained in paragraph [ char_pbundec ] .",
    "figure [ clustergraph_ell ] shows certain subsets of @xmath452 .",
    "each dashed subset of @xmath452 is defined by the set written underneath .",
    "the integer written to the right is its cardinality .",
    "a line between two dashed areas indicates that there is at least one edge in @xmath63 between two vertices in the corresponding subsets .",
    "[ h=2(q+1)-h ] @xmath453 .",
    "fix a place @xmath14 of degree @xmath13 and consider @xmath63 .",
    "we count the weights around the @xmath370 vertices @xmath235 , where @xmath62 varies through @xmath454 modulo adding a class in @xmath455 . we know that the weights around each of the @xmath370 vertices add up to @xmath10 .",
    "on the other hand , theorem [ str_thm_graphs_for_genus_1 ] tells us precisely which vertices occur as @xmath49-neighbours of the @xmath235 s and with which weight .",
    "we count all weights around the @xmath235 s :    * the vertex @xmath177 occurs with weight @xmath370 . * the vertex @xmath324 occurs with weight @xmath370 if @xmath456 and @xmath457 . *",
    "the vertex @xmath324 occurs with weight @xmath369 if @xmath456 and @xmath458 . *",
    "the vertex @xmath132 occurs with weight @xmath370 if @xmath459 and @xmath460 . *",
    "the vertex @xmath132 occurs with weight @xmath369 if @xmath459 and @xmath461 .    since @xmath462 ,",
    "the sum of the weights of the @xmath324 s is @xmath463 .",
    "since @xmath464 and @xmath132 depends only on the class of @xmath125 modulo @xmath126 , the sum of the weights of the @xmath132 s is @xmath465 . adding up all these contributions gives @xmath466 which implies the relation of the lemma .",
    "this result can also be obtained from the equality @xmath467 , where @xmath468 is the hecke character corresponding to @xmath4 by class field theory .",
    "these function can be written out explicitly as @xmath469 where @xmath470 .",
    "comparing the coefficients of the numerators of these rational functions in @xmath471 yields an alternative proof of the lemma .",
    "we review the notion of hecke operators and automorphic forms in geometric language .",
    "let @xmath472 be the space of complex valued functions on the vertex set @xmath118 of the graphs @xmath63 .",
    "the action of the _ hecke operators @xmath49 _ on @xmath472 is as follows . given a function @xmath473 and a vertex @xmath474 , we define @xmath475 the actions of @xmath49 and @xmath476 commute for every @xmath477 .",
    "hecke algebra _ is the free algebra @xmath478_{x\\in{\\left| x \\right|}}$ ] generated by the hecke operators @xmath49 .",
    "it acts on @xmath472 by linear continuation of the action of the @xmath49 .",
    "a function @xmath473 is an _ automorphic form _ if @xmath31 is contained in a finite - dimensional @xmath479-invariant subspace of @xmath472 .",
    "we denote the space of automorphic forms by @xmath480 .",
    "note that @xmath31 is automorphic if and only if @xmath481 is contained in a finite - dimensional subspace of @xmath472 for one @xmath482 .",
    "moreover , every @xmath49-eigenspace for a fixed place @xmath14 has a basis that consists of simultaneous eigenfunctions for all @xmath483 .",
    "we call such a simultaneous eigenfunction an _ @xmath479-eigenfunction_.    an automorphic form as defined here corresponds to an unramified automorphic form for @xmath66 over the function field @xmath0 and an element @xmath484 corresponds to an unramified hecke operators for @xmath66 . for more details on this correspondence ,",
    "see section 5 in @xcite .",
    "note that there is a digression in notation : all upper and lower indices @xmath485 are suppressed in this paper .",
    "for instance , we write @xmath480 for the space denoted by @xmath486 and @xmath479 for the algebra denoted by @xmath487 in @xcite and @xcite .",
    "[ eigenvalue_equations_in_vertices_of_the_nucleus ] let @xmath488 be an @xmath479-eigenfunction and let @xmath489 be the eigenvalue for @xmath49 where @xmath482 .",
    "we can evaluate the eigenvalue equation @xmath490 at each vertex @xmath94 of @xmath63 and for each place @xmath14 of degree @xmath13 , which yields the following equations for the vertices in the nucleus .",
    "( note that the expressions in the column on the left are labels , which will be used for the purpose of reference . )",
    "@xmath491\\in\\operatorname{cl}x'/\\operatorname{cl}x\\\\ [ d]\\neq\\operatorname{cl}x\\\\ d-\\sigma d+x - y\\in2\\operatorname{cl}^0 x } } \\hspace{-0,8cm}f(t_d)\\\\                                 \\hspace{4cm}\\      & & \\hspace{-10cm}\\text{for } y\\in x(\\ff_q)\\text { , where } \\alpha=\\left\\{\\begin{array}{ll } h_2 & \\text{if } ( y - x)\\in2\\operatorname{cl}^0x,\\\\0&\\text{if } ( y - x)\\notin2\\operatorname{cl}^0x.\\end{array}\\right.\\!\\!\\!\\\\   \\end{aligned}\\ ] ]    if we add up all the eigenvalue equations evaluated in the vertices @xmath235 , where we let @xmath62 range over all of @xmath492 , then we obtain that @xmath493\\in\\operatorname{cl}x'/\\operatorname{cl}x\\\\ [ d]\\neq\\operatorname{cl}x } } \\hspace{-0,5cm}f(t_d ) \\;.   \\end{aligned}\\ ] ]",
    "in this section , we use our knowledge about the graphs @xmath63 to investigate the space @xmath494 of cusp forms .",
    "this means that we calculate its dimension and determine the ( maximal ) support of a cusp form .",
    "further we employ a hecke operator @xmath476 for a place @xmath62 of degree @xmath65 to show that a cusp form that is a @xmath479-eigenfunction does not vanish in @xmath265 .    a _ cusp form _",
    "is an automorphic form @xmath488 that satisfies the equation @xmath495 for all @xmath484 ( cf .",
    "we denote the space of cusp forms by @xmath494 .",
    "the space of cusp forms admits a basis of @xmath479-eigenfunctions , and is thus invariant under @xmath479 .",
    "the support of a cusp form is contained in the set of vertices @xmath94 with @xmath496 ( cf .",
    "@xcite or ( * ? ? ?",
    "9.3 ) ) .",
    "let @xmath370 and @xmath451 be as in the previous section .",
    "we obtain the following result .",
    "[ dimension_and_eigenvalues_of_cusp_forms ]    1 .",
    "[ cusp1 ] the dimension of @xmath494 is @xmath497 .",
    "[ cusp2 ] the support of @xmath498 is contained in @xmath499 .",
    "[ cusp3 ] if @xmath14 is a place of odd degree , then @xmath500 .",
    "[ cusp_forms_for_genus_1 ] let @xmath31 be an @xmath479-eigenform , which means , in particular , that @xmath31 is not trivial , and @xmath489 be the eigenvalue for @xmath49 where @xmath482 .",
    "we first show that @xmath501 if @xmath14 is of degree @xmath13 .",
    "assume that @xmath502 , then we conclude successively :    * @xmath503by equation .",
    "* @xmath504by equation .",
    "* @xmath505for all places @xmath506 of degree @xmath13 by equation .",
    "* @xmath507for all places @xmath62 of degree @xmath13 by equations and .",
    "* @xmath508for all @xmath459 by equation .",
    "thus @xmath31 must be trivial , which contradicts our assumption on @xmath31 .",
    "this shows that @xmath501 for all places @xmath14 of degree @xmath13 .",
    "we make the following successive conclusions :    * @xmath507for all places @xmath62 of degree @xmath13 by equation . *",
    "@xmath505for all places @xmath506 of degree @xmath13 by equation",
    ". * @xmath509by equation .",
    "* @xmath510\\in\\operatorname{cl}x'/\\operatorname{cl}x\\\\ [ d]\\neq\\operatorname{cl}x\\\\ d-\\sigma d+x - y\\in2\\operatorname{cl}^0x}}\\hspace{-0,7cm}f(t_d)=0 $ ] for all places @xmath62 of degree @xmath13 by equation , where @xmath511 if @xmath512 and @xmath513 otherwise .",
    "this means that the support of @xmath31 is contained in @xmath499 , which proves .",
    "we have @xmath514 linearly independent equations for @xmath31 as described by the last two lines of the above list .",
    "there are no further restrictions on the values of @xmath31 given by the eigenvalue equations since equation becomes trivial .",
    "hence the dimension of the @xmath64-eigenspace of @xmath49 in @xmath494 equals @xmath515 since there are no other eigenvalues for cusp forms , @xmath494 equals the @xmath64-eigenspace , which proves .",
    "assertion follows since the support of @xmath31 contains only vertices @xmath94 with @xmath138 even and the parity of two @xmath49-neighbours is different if @xmath14 is of odd degree ( cf .",
    "* lemma 8.2 ) ) .",
    "this implies that @xmath516 for every place @xmath14 of odd degree , which proves .",
    "the dimension can be calculated by other methods , too .",
    "once the vertices of the graphs @xmath63 are determined , one can use theta series to calculate the dimension , cf .",
    "* satz 3.3.2 ) and ( * ? ? ?",
    "[ cusp_eigenfunction_does_not_vanish_in_c_0 ] if @xmath498 is an @xmath479-eigenfunction , then @xmath517 .",
    "let @xmath498 be an @xmath479-eigenfunction with @xmath49-eigenvalue @xmath489 such that @xmath503 .",
    "we will deduce that @xmath31 must be the zero function , which contradicts the assumption that @xmath31 is an @xmath479-eigenfunction .",
    "this will prove the lemma .",
    "first we conclude from theorem [ dimension_and_eigenvalues_of_cusp_forms ] and equation that @xmath504 .",
    "the only other vertices that are possibly contained in the support of @xmath31 are of the form @xmath132 for a @xmath459 .",
    "we fix an arbitrary @xmath459 for the rest of the proof and show that @xmath518 .",
    "since @xmath519 maps surjectively to @xmath520 , and @xmath132 only depends on the class @xmath151\\in\\operatorname{cl}x'/\\operatorname{cl}x$ ] , there is a @xmath521 such that @xmath522 .",
    "the covering @xmath523 maps @xmath245 as well as its galois conjugate @xmath524 to a place @xmath525 of degree @xmath65 . as classes in @xmath526",
    ", we have @xmath527 .    in the following",
    ", we will investigate the graph of the hecke operator @xmath476 with the help of the graphs of the hecke operators @xmath528 and @xmath529 , which are defined over @xmath4 .",
    "recall from ( * ? ? ?",
    "* lemma 6.5 ) that the map @xmath530 restricts to an injective map @xmath531 and @xmath532 maps @xmath121 to @xmath533 .",
    "we will denote the elements in @xmath534 by @xmath535 with @xmath131 .",
    "then we have in particular that @xmath536 , that @xmath537 and that @xmath538 , and in each case , there is no other vertex in @xmath118 that is mapped to @xmath539 , @xmath540 , and @xmath541 , respectively .",
    "recall from paragraph [ def_hecke_graphs ] that @xmath542 denotes the sheaf on @xmath1 that is supported at @xmath62 with stalk @xmath543 .",
    "if we denote by @xmath544 and @xmath545 the corresponding sheaves on @xmath73 , we have that @xmath546 .",
    "let @xmath547 fit into an exact sequence @xmath89&{\\cm'}\\ar[r]&{\\cm}\\ar[r]&{\\ck_y}\\ar[r]&0 } } \\;.\\ ] ] extension of constants is an exact functor , thus we obtain an exact sequence @xmath89&{p^\\ast\\cm'}\\ar[r]&{p^\\ast\\cm}\\ar[r]&{\\ck_z\\oplus\\ck_{\\sigma z}}\\ar[r]&0 } } \\;,\\ ] ] which splits into two exact sequences @xmath548 where @xmath549 is the kernel of @xmath550 .    in the language of graphs",
    ", this means that for every edge        between vertices @xmath551 in @xmath552 , there are a vertex @xmath553 , and edges @xmath554 in @xmath555 and @xmath556 , respectively .",
    "we apply this observation to find out all possibilities of @xmath476-neighbours of @xmath265 .",
    "the only @xmath528-neighbour of @xmath265 is @xmath557 , and since @xmath558 , the @xmath529-neighbours of @xmath557 are @xmath559 and @xmath560 .",
    "this means that the only possible @xmath476-neighbours of @xmath265 are @xmath446 and @xmath281 .",
    "the vertex @xmath281 has multiplicity @xmath10 by ( * ? ? ?",
    "thus the neighbour @xmath446 has multiplicity @xmath561 . hence @xmath562 can be illustrated as        by the assumptions on @xmath31 , it vanishes both at @xmath265 and at @xmath281 .",
    "thus the eigenvalue equation @xmath563 implies that @xmath564 , which completes the proof .",
    "in this section , we calculate the space of toroidal automorphic forms .",
    "we start with @xmath4-toroidal automorphic forms , which have a particular nice geometric description , and prove in particular hat there are no non - trivial @xmath4-toroidal cusp forms . from this result together with the investigation of the zeros of certain @xmath5-functions , we shall show that the space of toroidal automorphic forms is generated by a single eisenstein series @xmath6 where @xmath7 is a zero of the zeta function of @xmath0with the exception that the characteristic of @xmath0 is @xmath65 and the class number @xmath9 of @xmath0 equals @xmath10 where the space of toroidal automorphic forms might be @xmath65-dimensional .",
    "let @xmath4 be the function field of @xmath73 .",
    "an automorphic form @xmath488 is _ @xmath4-toroidal _ if @xmath565\\in\\operatorname{cl}x'/\\operatorname{cl}x } } \\hspace{-0,2 cm } \\phi(f)(t_d ) \\",
    "= \\ 0 \\;.\\ ] ] for all @xmath484 ( cf .",
    "* thm .  10.8 ) ) .",
    "we denote the space of all @xmath4-toroidal automorphic forms by @xmath566 .",
    "this space is a @xmath479-invariant subspace of @xmath480 , and it decomposes into a direct sum of the following three @xmath479-invariant subspaces : the space @xmath567 of @xmath4-toroidal cusp forms , the space @xmath568 that is generated by @xmath4-toroidal derivatives of eisenstein series and the space @xmath569 that is generated by toroidal derivatives of residual eisenstein series ( see sections 6 and 7 in @xcite for the definition of the derivative of a ( residual ) eisenstein series ; we shall also give a brief description in paragraph [ intro_eisenstein ] ) .",
    "we shall investigate these subspaces in the following .",
    "we begin with @xmath567 . since @xmath133 if @xmath146 , the defining equations for @xmath4-toroidality contain in particular the equation @xmath570\\in\\operatorname{cl}x'/\\operatorname{cl}x\\\\ [ d]\\neq\\operatorname{cl}x } } \\hspace{-0,2 cm } f(t_d ) \\",
    "= \\ 0 \\;.    \\end{aligned}\\ ] ] for the unit @xmath571 in @xmath479 .      since the support of unramified cusp forms is contained in @xmath573 ( theorem [ dimension_and_eigenvalues_of_cusp_forms ] ) , after multiplying by @xmath574 , equation simplifies to @xmath575\\in\\operatorname{cl}x'/\\operatorname{cl}x\\\\ [ d]\\neq\\operatorname{cl}x } } \\hspace{-0,3cm}f(t_d ) \\;.\\ ] ]",
    "subtracting equation from it yields @xmath576 for cusp forms , equation reads @xmath577 and this implies that @xmath578 .",
    "thus proposition [ cusp_eigenfunction_does_not_vanish_in_c_0 ] implies that @xmath579 .    a formula of waldspurger ( ( * ? ? ?",
    "* prop .  7 ) ) for number fields together with certain non - vanishing results implies that a cusp form @xmath31 which is an @xmath479-eigenfunction is @xmath580-toroidal if and only if @xmath581 where @xmath580 is a quadratic field extension of @xmath0 , @xmath582 is the cuspidal representation generated by @xmath31 and @xmath583 is the hecke character associated to @xmath580 by class field theory ( cf .",
    "section 6 in @xcite ) .",
    "conjecturally the corresponding fact is also true in the function field case ; see @xcite for partial results .    in our framework , @xmath584 and @xmath585 .",
    "the case of genus @xmath64 follows trivially since there are no ( unramified ) cusp forms . for genus @xmath13 , both @xmath586 and @xmath587 equal @xmath588 and",
    "therefore they do not vanish in @xmath589 . on the other hand ,",
    "there are no toroidal cusp forms by the previous theorem .",
    "thus the case of genus @xmath13 follows .",
    "before we proceed to determine the rest of @xmath566 , we need some facts on the zeros of the zeta function @xmath590 of @xmath4 .",
    "the zeta function @xmath591 of @xmath0 satisfies the functional equation @xmath592 . here",
    "@xmath9 is the class number and @xmath470 .",
    "thus the zeros @xmath593 come in pairs @xmath594 ( modulo @xmath595 ) .",
    "note that this set contains only one element if @xmath596 .",
    "we say that @xmath594 is a pair of zeros of order @xmath197 if @xmath597 is a zero of order @xmath197 in the case that @xmath598 respective if @xmath197 is a zero of order @xmath599 in the case that @xmath600 .",
    "note that in the latter case @xmath597 is always a zero of even degree ( ( * ? ? ?",
    "* lemma 12.1 ) ) .",
    "since the denominator in the above equation for @xmath601 is a polynomial in @xmath470 of degree @xmath65 , we see that @xmath601 has only one pair of zeros ( modulo @xmath595 ) , which is of order @xmath13 .",
    "the same is true for the @xmath5-series @xmath602 namely its pair of zeros is @xmath603 if @xmath594 is the pair of zeros of @xmath601 . here",
    "@xmath585 is the unramified hecke character associated to @xmath4 by class field theory .",
    "however , the zeta function @xmath604 of @xmath4 , considered as a function of @xmath597 modulo @xmath595 , has either two different pairs of zeros of order @xmath13 or one pair of zeros of order @xmath65 .",
    "[ intro_eisenstein ] we proceed with determining the space @xmath566 .",
    "we give a brief description of ( residual ) eisenstein series and their derivatives .",
    "an _ unramified hecke character _ is a character on the divisor class group @xmath126 .",
    "in particular , the principal characters @xmath611 are unramified hecke characters .",
    "let @xmath612 be an unramified hecke character .",
    "define @xmath613 for all @xmath482 and all unramified hecke characters @xmath612 where we consider @xmath14 as a prime divisor and @xmath103 .",
    "the automorphic form @xmath614 is characterised , up to scalar multiple , by the eigenvalue equations @xmath615 for all @xmath482 ( see ( * ? ? ?",
    "3.5 and 9.2 ) for more details ) .",
    "if @xmath616 , then @xmath614 is called a _",
    "eisenstein series _ and if @xmath617 , then @xmath618 is called a _ residual eisenstein series _ or a _ residuum of an eisenstein series_. the functional equation for eisenstein series is a linear relation between @xmath614 and @xmath619 .",
    "indeed , @xmath620 for all @xmath482 .",
    "define @xmath621 for all @xmath482 and all unramified hecke characters @xmath612 .",
    "if @xmath622 where @xmath623 is the trivial character , then there is a unique automorphic form @xmath624 that satisfies the generalised eigenvalue equations @xmath625 for all @xmath482 ( ( * ? ?",
    "* lemmas 11.2 , 11.3 and 11.7 ) ) . the functions @xmath614 and @xmath624 span a @xmath65-dimensional @xmath479-invariant subspace of @xmath480 ( ( * ? ?",
    "* props .  11.4 and 11.8 ) ) .",
    "if @xmath626 , then there is a unique automorphic form @xmath627 that satisfies the generalised eigenvalue equations @xmath628 for all @xmath482 ( ( * ? ? ?",
    "* lemmas 11.2 and 11.3 ) ) .",
    "the functions @xmath614 and @xmath627 span a @xmath65-dimensional @xmath479-invariant subspace of @xmath480 ( ( * ? ? ?",
    "11.6 ) ) .",
    "[ space_of_f_toroidal_forms ] let @xmath7 be a zero of @xmath593 and @xmath629 the set of all unramified hecke characters @xmath630 such that @xmath631 , but @xmath632 . if @xmath633 , then @xmath566 is generated by @xmath634 and if @xmath606 , then @xmath566 is generated by @xmath635 in particular , @xmath636 .",
    "since @xmath637 , we can investigate the three summands separately . by theorem [ no_toroidal_cusp_forms_for_genus_1 ]",
    ", we have @xmath638 . by (",
    "7.6 ) , we have @xmath639 . by definition , @xmath640 if and only if @xmath641 is an unramified hecke character that factors through @xmath642 and that is nontrivial if restricted to @xmath643 .",
    "the group @xmath642 is a group of order @xmath644 , and its character group is of the same order .",
    "there are two quadratic characters such that @xmath645 is trivial , namely , the trivial character and @xmath646 .",
    "consequently , the cardinality of @xmath629 is @xmath647 .    by ( * ?",
    "4.3 ) , an eisenstein series @xmath614 is @xmath4-toroidal if and only if @xmath648 vanishes in @xmath589 .",
    "since this happens only for principal characters @xmath649 , we may reformulate this condition as follows : @xmath650 is @xmath4-toroidal if and only if @xmath651 . if @xmath633 , then @xmath652 has two pairs of zeros of order @xmath13 by lemma [ h = q+1_and_zeta_zeros ] . by (",
    "6.2 ) , the two eisenstein series in the theorem are @xmath4-toroidal and by ( * ? ? ?",
    "* thm .  4.3 ( ii ) ) ,",
    "@xmath568 is generated by these two linear independent functions .",
    "if @xmath606 , then @xmath653 is a pair of zeros of order @xmath65 by lemma [ h = q+1_and_zeta_zeros ] .",
    "note that @xmath654 is not of order @xmath65 , but of order @xmath407 .",
    "thus by ( * ? ? ?",
    "4.3 and 6.2 ) , @xmath650 and @xmath655 form a basis of @xmath568 where @xmath656 is a zero of @xmath657 .",
    "an alternative proof of the above theorem can be accomplished by considering eigenvalue equations , similar to the proof of theorem [ dimension_and_eigenvalues_of_cusp_forms ] .",
    "this is done in @xcite .",
    "the interesting aspect of the calculations with the eigenvalue equations is that one obtains the equality @xmath659 for the @xmath49-eigenvalues @xmath489 of the eisenstein series @xmath614 in @xmath566 if @xmath14 is of degree @xmath13 .",
    "the estimation @xmath660 coming from the embedding of @xmath1 into @xmath661 yields that @xmath566 is unitarizable .",
    "to prove that @xmath566 is a tempered representation , which would imply the riemann hypothesis for @xmath1 ( cf .",
    "* thm .  9.4 ) ) , one needs the estimate @xmath662 . for more details , cf .",
    "8.4.7 ) .",
    "the dependence of @xmath489 on @xmath9 should come as no surprise , since the class number @xmath9 has an important influence on the shape of the graphs @xmath63 .",
    "for a given elliptic curve with known class number , it is however possible to proof the riemann hypothesis via these methods .",
    "note that in this proof , we do not make use of the fact that the zeta function is a rational function . this leaves some hope that these methods can say something about zeta functions of number fields .",
    "[ explanations_on_toroidal ] in the rest of this paper , we will determine the space of toroidal automorphic forms for an elliptic curve @xmath1 .",
    "this will be done based on theorems of @xcite and calculations with @xmath5-series .",
    "there is , more general , a definition of an @xmath580-toroidal automorphic form for every separable quadratic algebra extension of @xmath0 , which is either a separable quadratic field extension of @xmath0 or isomorphic to @xmath663 . if @xmath664 denotes the space of ( unramified ) @xmath580-toroidal automorphic forms , then the space of _ ( unramified ) toroidal automorphic forms _ is the intersection @xmath665 where @xmath580 ranges over all separable quadratic algebra extensions of @xmath0 .",
    "we shall not recall these definitions , which can be found in @xcite .",
    "important for the following conclusions is the connection of @xmath580-toroidal automorphic eisenstein series and zeros of @xmath5-series .",
    "namely , let @xmath580 be a separable quadratic algebra extension of @xmath0 .",
    "let @xmath666 be the hecke character that is associated to @xmath580 by class field theory .",
    "in particular , @xmath666 is the trivial character for @xmath667 and @xmath585 for the function field @xmath4 of @xmath73 .",
    "then an eisenstein series @xmath614 is @xmath580-toroidal if and only if @xmath668 ( cf .",
    "4.4 and 5.6 ) ) . for zeros of higher order , also derivatives of eisenstein series",
    "are toroidal .",
    "the precise statement can be found in ( * ? ? ?",
    "let @xmath669 denote the space that is generated by all @xmath580-toroidal derivatives of eisenstein series .",
    "we can draw some first conclusions . since @xmath670 , there are no toroidal automorphic cusp forms . by (",
    "7.7 ) , there are no toroidal residues of eisenstein series .",
    "so we are left to determine the space of toroidal ( derivatives of ) eisenstein series , which contains at most the @xmath65-dimensional space @xmath568 as determined in theorem [ space_of_f_toroidal_forms ] and at least the eisenstein series @xmath671 for which @xmath672 , which span an @xmath13-dimensional subspace of @xmath568 .",
    "we will show in the following that @xmath673 equals this @xmath13-dimensional subspace when the characteristic of @xmath0 is odd or @xmath633 .",
    "[ toroidal_space_genus_1_split_torus ] let @xmath7 be a zero of @xmath593 .",
    "then @xmath674 is @xmath65-dimensional .",
    "if @xmath675 , then it is generated by @xmath676 and if @xmath677 , then it is generated by @xmath678      if @xmath675 , which is the case when @xmath683 , then @xmath684 vanishes in @xmath597 to order @xmath65 . in this case , the space of @xmath663-toroidal derivatives of eisenstein series is spanned by @xmath650 , @xmath655 , @xmath685 and @xmath686 ( cf .",
    "6.2 ) ) . by ( * ? ?",
    "* thm .  11.10 ) ,",
    "@xmath650 and @xmath655 form a basis for this space .",
    "if @xmath677 , which is the case when @xmath687 , then @xmath684 vanishes in @xmath597 to order @xmath407 . in this case , the space of @xmath663-toroidal derivatives of eisenstein series is spanned by @xmath650 , @xmath655 , @xmath688 and @xmath689 ( cf .",
    "* thm . 6.2 ) ) . by (",
    "* thm .  11.10 ) ,",
    "@xmath650 and @xmath688 form a basis for this space .",
    "this completes the proof .",
    "[ toroidal_space_genus_1_h_even ] assume that @xmath0 has a separable geometric quadratic unramified field extension @xmath580 .",
    "let @xmath666 be the corresponding hecke character .",
    "let @xmath7 be a zero of @xmath593 .",
    "then @xmath669 is @xmath65-dimensional and generated by @xmath690    as explained above , @xmath614 is @xmath580-toroidal if and only if @xmath612 is a zero of the product @xmath691 . note that a separable quadratic unramified field extension is geometric if and only if the corresponding hecke character @xmath666 restricts to a non - trivial character on the class group @xmath692",
    ". therefore @xmath693 can not be the inverse of @xmath694 .",
    "consequently , the only ( unramified ) pair of zeros of @xmath695 is @xmath681 and it is of order @xmath13 .",
    "the only pair of zeros of @xmath696 is @xmath697 and it is of order @xmath13 .",
    "this proves the proposition .      1",
    ".   [ thmd1 ] if either the characteristic of @xmath0 is odd or @xmath633 , then @xmath673 is @xmath13-dimensional and spanned by the eisenstein series @xmath650 .",
    "[ thmd2 ] if the characteristic of @xmath0 is @xmath65 and @xmath606 , then @xmath673 is either @xmath13-dimensional and spanned by @xmath650 or @xmath65-dimensional and spanned by @xmath698 .    as explained in paragraph [ explanations_on_toroidal ]",
    ", @xmath673 contains @xmath650 and is contained in the @xmath65-dimensional space @xmath568 generated by @xmath650 and @xmath699 if @xmath633 , respective , @xmath650 and @xmath655 if @xmath606 ( as described in theorem [ space_of_f_toroidal_forms ] ) .",
    "it suffices to show that @xmath699 respective @xmath655 is not toroidal if the characteristic of @xmath0 is odd or @xmath633 to prove the theorem .    if @xmath633 , then @xmath590 has simple zeros by lemma [ h = q+1_and_zeta_zeros ] . hence the intersection of @xmath568 ( as described in proposition [ space_of_f_toroidal_forms ] ) with @xmath674 ( as described in proposition [ toroidal_space_genus_1_split_torus ] ) is @xmath13-dimensional and spanned by @xmath650 .",
    "if the characteristic is odd , then the result follows from ( * ? ? ?",
    ". we can also deduce it easily from the preceding as follows .",
    "we can assume that @xmath606 , so @xmath9 is even .",
    "there is thus a separable geometric quadratic unramified field extension @xmath700 that corresponds to a non - trivial character @xmath666 on the class group @xmath692 .",
    "thus the intersection of @xmath566 with @xmath669 ( as described in proposition [ toroidal_space_genus_1_h_even ] ) is @xmath13-dimensional and spanned by @xmath650 .",
    "let @xmath0 be an elliptic function field with constant field @xmath2 and class number @xmath9 .",
    "if either the characteristic of @xmath0 is not @xmath65 or @xmath633 , then there is for every unramified hecke character @xmath612 and for every @xmath701 a quadratic character @xmath702 such that @xmath703 .",
    "[ rem_on_class_number_1 ] the proof of the last theorem depends on many results from the theory for toroidal automorphic forms as developed in @xcite and @xcite . in the particular case that the class number is @xmath13 , however , it is possible to deduce the theorem comparatively quickly by the method described in the introduction ( cf .",
    "@xcite ) .",
    "gunther cornelissen and oliver lorscheid .",
    "toroidal automorphic forms , waldspurger periods and double dirichlet series . to appear in a proceedings of the edinborough conference on @xmath5-series , arxiv:0906.5284 , 2009 ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be the function field of an elliptic curve @xmath1 over @xmath2 . in this paper , we calculate explicit formulas for unramified hecke operators acting on automorphic forms over @xmath0 . </S>",
    "<S> we determine these formulas in the language of the graph of an hecke operator , for which we use its interpretation in terms of @xmath3-bundles on @xmath1 . </S>",
    "<S> this allows a purely geometric approach , which involves , amongst others , a classification of the @xmath3-bundles on @xmath1 .    </S>",
    "<S> we apply the computed formulas to calculate the dimension of the space of unramified cusp forms and the support of a cusp form . </S>",
    "<S> we show that a cuspidal hecke eigenform does not vanish in the trivial @xmath3-bundle . </S>",
    "<S> further , we determine the space of unramified @xmath4-toroidal automorphic forms where @xmath4 is the quadratic constant field extension of @xmath0 </S>",
    "<S> . it does not contain non - trivial cusp forms . </S>",
    "<S> an investigation of zeros of certain hecke @xmath5-series leads to the conclusion that the space of unramified toroidal automorphic forms is spanned by the eisenstein series @xmath6 where @xmath7 is a zero of the zeta function of @xmath1with one possible exception in the case that @xmath8 is even and the class number @xmath9 equals @xmath10 . </S>"
  ]
}