{
  "article_text": [
    "x - ray free electron lasers ( xfels ) have been successful in performing crystallographic reconstructions of biomolecules with nanocrystalline samples having as few as @xmath1 unit cells@xcite@xcite .",
    "this is possible , in part , because the high signal and bragg peak concentration allows indexing methods to determine the orientation of each frame @xcite .",
    "there are , however , many situations in which indexing with a single frame is not possible either because of the nature of the sample ( e.g. a non - crystalline particle or protein ) or because the number of scattered photons detected in a single frame simply do not provide enough information . in these cases , a different approach is required .",
    "the emc ( expand - maximize - compress ) algorithm@xcite@xcite presents a method of dealing with these more difficult data sets .",
    "the heart of this algorithm depends on expectation maximization ( em ) methods that were experimentally demonstrated previously@xcite using the prototype detector based upon the asic ( application specific integrated circuit ) developed by cornell for the cs - pad detector at the linac coherent light source ( lcls ) .",
    "the present work extends this approach to 3d tomographic reconstructions using sparse x - ray transmission data collected from a 5 cm sized object , where each data frame is from a random and unknown orientation .",
    "the sparse data frames used for reconstruction have signal levels of @xmath2 photons / pixel / frame .",
    "the detector system used is a tiled pixel array detector ( pad ) .",
    "each tile has 128@xmath3128 pixels and uses the mixed - mode pixel array detector ( mmpad ) asic@xcite .",
    "the overall tiling format is a 3@xmath32 grid@xcite .",
    "the object reconstructed is relatively low - contrast at the @xmath4 emission line of molybdenum ( 17.5 kev ) .",
    "the object absorbs from 5% of the photons incident on it in the thinnest regions to 90% in the central portion .",
    "+    low - signal tomographic reconstructions using the emc algorithm were tested using a plastic lego ninjago samukai  figure , roughly matching the size of the detector , as the object of study .",
    "a 50 watt molybdenum anode x - ray tube was used to generate x - rays ( tru - focus tcm-5000 m ) .",
    "the applied high voltage was 21.5 kv and the current was set to 0.05 ma .",
    "a 400 micron zirconium filter was used to better isolate the k line of molybdenum ( 17.5 kev ) from the x - ray tube emission spectrum by preferentially attenuating lower energies and higher energies ( beyond the k - edge of zirconium , 18.0 kev ) .",
    "the distance between the x - ray source and the sample was 1.3 meters .",
    "the detector was placed directly after the sample .",
    "detector pixels measured 150 @xmath5 m @xmath3 150 @xmath5 m .",
    "the per - frame exposure time was chosen to be 4 ms with an average signal of 100 photons per frame ( @xmath6 photons / pixel / frame ) .",
    "the ninjago figure ( figure  [ fig : ninjago ] ) was mounted on a post and attached to a rotation stage ( newport urs100bpp ) . during data taking , the rotation stage turned continuously at a rate of 2 degrees per second .",
    "the data was taken continuously with 860 @xmath5s between frames in batches of 1000 frames .",
    "variable time delays were used between batches , to ensure that there was no time sequence bias , and 15.6 million frames were acquired .",
    "each frame ( figure  [ fig : frame1 ] ) acquired was converted to photon counts in the following way : 1 ) an average of 100 to 300 dark frames was subtracted from the signal frames and detector specific offsets were corrected .",
    "2 ) a threshold was applied to each pixel that corresponded to 60% of a single molybdenum k@xmath7 x - ray .",
    "pixels that did not exceed this threshold were set to zero signal level .",
    "3 ) the number of photons detected in a pixel exceeding the threshold was determined by dividing the pixel signal by the single photon signal level , and rounding to the nearest integer .",
    "note the edge pixels around the rim of each tile are larger than the interior pixels due to edge effects in the sensor@xcite .",
    "no correction for this effect was applied to the data .    after digitizing each frame ,",
    "a list of pixels having non - zero photons was recorded .",
    "because of the sparse nature of the low - fluence data , recording pixel coordinate and number of photons , rather than all pixel values , greatly reduced the memory required to store data .",
    "these data frames were passed to the algorithm without any information about the rotation of the object corresponding to each frame .",
    "this was done to simulate the unknown - orientation aspect of the single molecule imaging process .",
    "three more data sets were generated by combining 2 , 4 , and 10 consecutive frames within the 1000 frame batches , respectively .",
    "since the object rotated approximately @xmath8 degrees between frames , we can safely assume that 10 consecutive frames are from essentially identical orientations of the object .",
    "+    figure  [ fig : powder ] shows the angle - averaged pattern obtained by summing over all frames .",
    "since pixels in the outer region ( e.g. top - right and top - left corner ) are never obscured by the object , they provide no structural or orientational information . from the histogram in fig .",
    "[ fig : histogram ] , a photon count of 17,800 was chosen as the cutoff to define a mask of pixels as shown in fig .",
    "[ fig : mask ] .",
    "only the green pixels are used to determine the orientations of each frame of data . in the remainder of the paper , these pixels are referred to as relevant and the others as irrelevant .    another mask ( red in fig .",
    "[ fig : mask ] ) is used to exclude the pixels in the gaps between detector tiles .",
    "if this is not done , the algorithm naturally interprets these gaps as coming from an infinitely opaque structure obstructing the view in every frame .",
    "since there are no photons here , the exact attenuation caused by this structure is undefined except that it is above a certain level .",
    "in addition to these pixels , this mask also includes 7  hot \" pixels that were malfunctioning and erroneously record extremely high count rates .",
    "this mask of ignored pixels is shown in red in fig .",
    "[ fig : mask ] .",
    "the pattern is not symmetric or smooth because of statistical noise , small variations in pixel gain , detection efficiency and small errors in pixel offsets .",
    "the lack of symmetry and smoothness present no problem for data reduction and the algorithm is generally robust in this regard .",
    "( expand ) expand : + @xmath9 ; ( maximize ) maximize : + @xmath10 ; ( compress ) compress : + @xmath11 ; ( expand )  ( maximize ) ; ( maximize ) ",
    "( compress ) ; ( compress ) to[out=-120,in=-60 ] ( expand ) ;    the imaging process can be thought of as unknown - angle tomography at very low signal .",
    "this problem naturally splits into two parts , tomography and determination of angle .",
    "the projection - slice theorem was used to tackle the first and an iterative expectation - maximization ( em ) based algorithm for the second .    since the projection - slice operation is applied partly in fourier space",
    ", it is convenient to have the iterate be a 3d fourier space model @xmath12 .",
    "the 3d inverse fourier transform of @xmath12    @xmath13=m_{xyz}\\ ] ]    gives the attenuation , by @xmath14 , of x - rays passing through voxel @xmath15 of the object .    the relevant pixel mask is used to generate the initial random model .",
    "consider the three - dimensional object generated by rotating this mask about the axis of rotation .",
    "since we assume that all pixels outside the relevant region are never obscured for any angle , this ` rotated - mask ' object acts as the support for the target object .",
    "thus , voxels inside this object are assigned a random number uniformly in the range [ 0,1 ] and the voxels outside are zeroed .",
    "this 3d array is zero - padded perpendicular to the rotation axis to reduce interpolation errors and fourier transformed to generate the initial random fourier model .",
    "we express our algorithm in the expand - maximize - compress ( emc ) framework of @xcite . starting with the initial random model , in each iteration",
    ", these three operations are applied to it to generate the updated model . here",
    "the expand and compress steps represent transformations between the 3d attenuation model in fourier space and the collection of 2d real - space intensity attenuation patterns , for uniformly sampled object - rotation angles .",
    "we will refer to the latter as tomograms .",
    "the maximize step generates updated tomograms which increase the likelihood of the data being generated from the model .",
    "thus , in each iteration , we generate the tomograms from the current model ( expand ) , update the tomograms ( maximize ) , and combine them to generate the new model ( compress ) .",
    "( muvw ) @xmath12 ; ( trhow ) @xmath16 ; ( trz ) @xmath17 ; ( wrz ) @xmath18 ; ( muvw )  nodeinterpolation ( trhow ) ; ( trhow )  node2dift ( trz ) ; ( trz )  nodeexponentiation ( wrz ) ;    the tomograms are generated using the projection - slice theorem augmented by exponentiation of the projections .",
    "we use linear interpolation to generate slices @xmath16 of @xmath12 passing through the axis @xmath19 for a large number of uniformly spaced orientations , @xmath20 . to avoid interpolation errors ,",
    "we oversample the fourier space model . thus",
    ", if there are @xmath21 pixels in the detector and the rotation axis is along the @xmath22-axis , the iterate has @xmath23 complex voxels , where @xmath24 is the oversampling factor .",
    "we inverse fourier transform the slices @xmath16 to generate the projected attenuations @xmath17 and then generate the intensity models by applying the formula ,    @xmath25 \\\\",
    "w_{rz}(\\theta ) & = f . \\exp[-s t_{rz}(\\theta ) ]      \\label{eqn : exp}\\end{aligned}\\ ] ]    here , @xmath26 represents the unattenuated intensity and @xmath27 represents a scale factor explained below .. since we assume that the irrelevant pixels are unobstructed in any orientation , we can obtain @xmath26 from the mean photon count in these pixels .",
    "before we apply the maximize step on @xmath18 , we must determine if we have the right overall scale for @xmath17 .",
    "from the data , we know the mean number of photons / frame , @xmath28 , where the angle bracket denotes averaging over all orientations @xmath20 .",
    "however , due to the exponentiation in eq .",
    "( [ eqn : exp ] ) , we can not use this to directly calculate @xmath29 .",
    "we also observe that the algorithm is prone to a scaling instability in the first few iterations where the values in @xmath17 explode , leading to underflows in the intensity due to eqn  [ eqn : exp ] .",
    "this is avoided by numerically determining the correct scale every iteration .",
    "we use the secant method  @xcite to solve    @xmath30\\rangle\\ ] ]    for the unknown scale factor @xmath27 .      in this step",
    "we find the updated intensities @xmath31 using expectation maximization . due to the low signal count per pixel",
    ", we expect the probability of a photon incident on a pixel to be governed by poisson statistics . at each pixel",
    ", the intensity model value gives the mean of this poisson distribution .",
    "thus , the likelihood of a frame of data @xmath32 ( @xmath33 ) coming from @xmath18 is given by ,    @xmath34}{k_{d , rz } ! }",
    "\\label{eqn : like}\\\\      \\rightarrow p_d(\\theta ) & = \\frac{\\ell_d(\\theta)}{\\sum\\limits_\\theta \\ell_d(\\theta ) }       \\label{eqn : prob}\\end{aligned}\\ ] ]    where @xmath35 is the probability obtained by normalization and @xmath36 is the number of photons at pixel @xmath37 in frame @xmath32 . the @xmath38 factor in the denominator of eq .",
    "[ eqn : like ] cancels out in the calculation of @xmath35 . to increase the effectiveness of our probability assignment , we only consider photons in relevant pixels .    using these probabilities",
    "we calculate the updated intensities , @xmath31 , which maximize the log - likelihood of generating the data , @xmath39 = \\sum_d \\sum_\\theta \\sum_{rz } p_d(\\theta ) [ k_{d , rz } log(w'_{rz } ) - w'_{rz}]\\ ] ] rearranging the sums and maximizing with respect to @xmath40 , we get @xmath41    for two reasons explained below , we apply an  inertia \" factor @xmath42 in the update rule for @xmath18 .",
    "we apply an update rule , @xmath43 thus , @xmath31 has a contribution from the previous iteration .    in the first few iterations , where the iterate changes rapidly , a high value of @xmath42 prevents @xmath17 from exploding , leading to underflows in the intensity calculation .",
    "secondly , it also provides an additional handle on the rate of convergence of the algorithm . in the current geometry ,",
    "the various slices @xmath16 do not overlap each other except at the rotation axis .",
    "this means that there is only a weak constraint for successive slices to correspond to successive rotation angles .",
    "thus , there are near solutions which have arbitrary jumps in angles in successive slices . indeed ,",
    "this is what we observe we converge to when we have relatively high signal .",
    "however , if we slow down the rate of convergence using a high inertia factor , we reliably converge to the right solution .",
    "we do not expect this to be an issue if we have full 3d rotation as the various slices strongly overlap . in that case",
    ", the expand and compress steps should together provide a strong constraint which impose the correct ordering on the slices .",
    "this is the inverse of the expand step .",
    "first , we generate the attenuation projections @xmath44 by taking the negative logarithm of the updated tomograms ,    @xmath45    the ignored pixels from the panel gaps and  hot \" pixels are not updated .",
    "these updated projections are then zero - padded and fourier transformed to get the updated slices @xmath46 .",
    "we then use linear interpolation to generate the updated 3d model .",
    ".parameters of four data sets analyzed . the last three were generated by combining 2 , 4 , and 10 successive frames of the first data set .",
    "relevant pixels refer to the green region in fig .",
    "[ fig : mask ] .",
    "only the photons in this region have orientational information about the data frames . [ cols=\"^,^,^,^,^ \" , ]     data was taken with 99.5 mean photons per frame .",
    "of these , only 37 photons were incident in the relevant region of the detector as defined in section  [ sec : preprocess ] . using the mean incident flux calculated from the irrelevant pixels",
    ", we can determine that on average around 4 photons were absorbed by the object per frame .",
    "as mentioned in section  [ sec : datagen ] , frames were grouped by either 1 , 2 , 4 , or 10 consecutive frames into 4 data sets .",
    "after this initial grouping , no information on the angular position of the combined frames was passed to the reconstruction algorithm .",
    "table  [ tab : data ] lists the properties of all four data sets .",
    "figure  [ fig : results ] shows reconstructions from the four data sets along with a set of high flux , static projections . in all four cases ,",
    "the only thing that changes is the signal per frame .",
    "the total number of photons and the object is unchanged .",
    "we can clearly see that the quality of the reconstruction improves as we increase the mean number of photons / frame . with 99 photons / frame , the algorithm is unable to determine even the gross shape of the object . the finer ,",
    "low - contrast features are reconstructed with more and more accuracy as we increase the number of frames combined . in the bottom row ,",
    "the circle shows the location of the extra upper arm , which was attached only on one side .",
    "the oval shows the asymmetry in the two lower arms due to one of them holding a lego dumbbell .",
    "note that even with 10 frames combined , there are still only @xmath47 photons / frame / pixel in the relevant region of the detector .",
    "for all four data sets , an oversampling factor , @xmath24 , of 2 was chosen .",
    "thus , the fourier - space iterate had dimensions @xmath48.the angular range was divided into 200 discrete orientations and the inertia factor was chosen to be 0.8 in each case .",
    "a cutoff count of 17,800 was used to generate the relevant pixels mask .",
    "there were 46,890 relevant pixels and 8,670 ignored pixels .    due to the large size of the problem ,",
    "a parallel algorithm was required .",
    "the most time - consuming step in each iteration was implementing equation  [ eqn : like ] .",
    "the parallelization was applied over the @xmath20 index i.e. each process was assigned a part of the angular range for which to calculate @xmath35 .",
    "reconstructions were performed at the lcls cluster at slac . with 120 processes on 10 nodes ,",
    "an iteration took 2 - 3 minutes and the algorithm took 3050 iterations to converge . to test for convergence",
    ", reconstructions were performed multiple times with different random starts and they yielded the same result .",
    "we view these results as an extension of the 2d reconstructions performed previously with similarly sparse data in @xcite .",
    "the in - plane rotation axis in the present study meant that we had to reconstruct a 3d object .",
    "any given frame in this experiment did not have the full structural information .",
    "due to the large size of the object , a non - linear attenuation model had to be used .",
    "also , we needed a parallel code running on a cluster to perform the reconstruction in a reasonable time . with this experiment , we are one step closer to demonstrating the reconstruction of the 3d intensity of a biomolecule or nanocrystal in conditions of very low signal",
    ".    there are further avenues that could be pursued to improve the quality of the reconstruction : 1 ) one could take into account the small , but finite divergence of the beam .",
    "this would make the analysis in the expand and compress steps similar to fan - beam tomography .",
    "2 ) the data at the edge pixels could be modified to reflect their larger size .",
    "3 ) the axis of rotation was assumed to be aligned along the middle of the detector .",
    "this could estimated more accurately .",
    "4 ) our criterion for the relevant pixel mask was chosen for simplicity ( a hard cutoff on the number of photons / pixel ) .",
    "this could be further refined to maximize the capacity to determine the orientation of a frame .",
    "in the process of constructing a 3d proof - of - principle experiment for biomolecule imaging with x - rays , our experiment closely approaches the setup of cryo - electron microscopy ( cryo - em ) experiments@xcite for biomolecules . in that case",
    ", we also have tomography with unknown orientations at very low signal - to - noise . however , there are a few differences .",
    "the cryo - em reconstructions do not have the assistance of a rotation axis , and so have molecules in all orientations in so(3 ) .",
    "in addition , they must also fix translational alignment in their individual frames . finally , the x - ray data here is in the low signal regime of poissonian statistics , while the noise model for cryo - em is not as simple .",
    "the results in fig  [ fig : results ] suggest that there is a minimum number of photons / frame needed to determine the structure of the object .",
    "a similar feasibility criterion was found in the emc simulations for single molecule diffraction imaging  @xcite  @xcite . in this case",
    ", the criterion depends on the particular object .",
    "more specifically , the more attenuation there is far from the rotation axis , the easier it is to assign orientations to frames .",
    "also , a higher contrast object with the same shape would be easier to reconstruct .",
    "the goal of reconstructing a single biomolecule or microcrystal needs a few more steps .",
    "first , we need to demonstrate a reconstruction with randomly - oriented diffraction data .",
    "secondly , there would be sources of background we have not included , such as air - scatter , which would make the reconstruction more challenging .",
    "research on the development and application of x - ray detectors is supported by doe grant de - fg02 - 10er46693 , the keck foundation , and chess .",
    "chess is supported by nsf and nih - nigms under nsf grant dmr-0936384 .",
    "the data analysis work is supported by doe grant de - fg02 - 11er16210 .",
    "the sample used to demonstrate tomographic reconstruction was graciously provided by russell k. philipp ."
  ],
  "abstract_text": [
    "<S> schemes for x - ray imaging single protein molecules using new x - ray sources , like x - ray free electron lasers ( xfels ) , require processing many frames of data that are obtained by taking temporally short snapshots of identical molecules , each with a random and unknown orientation </S>",
    "<S> . due to the small size of the molecules and short exposure times , average signal levels of much less than 1 photon / pixel / frame are expected , much too low to be processed using standard methods . </S>",
    "<S> one approach to process the data is to use statistical methods developed in the emc algorithm ( loh & elser , phys . </S>",
    "<S> rev . </S>",
    "<S> e , 2009 ) which processes the data set as a whole . in this paper </S>",
    "<S> we apply this method to a real - space tomographic reconstruction using sparse frames of data ( below @xmath0 photons / pixel / frame ) obtained by performing x - ray transmission measurements of a low - contrast , randomly - oriented object . </S>",
    "<S> this extends the work by philipp et al . </S>",
    "<S> ( optics express , 2012 ) to three dimensions and is one step closer to the single molecule reconstruction problem .    </S>",
    "<S> = [ rectangle , draw , thick , text width=8.5em , text centered , rounded corners , minimum height=4em ] = [ rectangle , draw , thick , text centered , rounded corners , minimum height=2em ] = [ draw , very thick , -latex ]    99    h.  t.  philipp , k.  ayyer , m.  w.  tate , v.  elser and s.  m.  gruner ,  solving structure with sparse , randomly - oriented x - ray data , \" * 20*(12 ) , 1312913137 ( 2012 )    h.  n.  chapman , p.  fromme , a.  barty , et  al .  femtosecond x - ray protein nanocrystallography , \" * 470*(7332 ) , 7377 ( 2011 )    s.  boutet , l.  lomb , g.  j.  williams , et  al .  </S>",
    "<S> high - resolution protein structure determination by serial femtosecond crystallography , \" science , * 337*(6092 ) , 362364 ( 2012 )    t.  a.  white , r.  a.  kirian , a.  v  martin , a.  aquila , k.  nass , a.  barty , and h.  n.  chapman  crystfel : a software suite for snapshot serial crystallography , \" , * 45*(2 ) , 335 - 341 ( 2012 )    v.  elser , `` noise limits on reconstructing diffraction signals from random tomographs , '' , * 55*(10 ) , 47154722 ( 2009 ) .    </S>",
    "<S> ne - te  duane  loh and veit elser , `` reconstruction algorithm for single - particle diffraction imaging experiments , '' * 80*(2 ) ( 2009 ) .    </S>",
    "<S> n.  d.  loh , m.  j.  bogan , v.  elser , a.  barty , s.  boutet , s.  bajt , j.  hajdu , t.  ekeberg , f.  r.  n.  c. maia , j.  schulz , m.  m.  seibert , b.  iwan , n.  timneanu , s.  marchesini , i.  schlichting , r.  l.  shoeman , l.  lomb , m.  frank , m.  liang , and h.  n.  chapman , `` cryptotomography : reconstructing 3d fourier intensities from randomly oriented single - shot diffraction patterns , '' * 104*(22 ) ( 2010 ) .    </S>",
    "<S> w.  vernon , m.  allin , r.  hamlin , t.  hontz , d.  nguyen , f.  augustine , s.  m.  gruner , ng .  </S>",
    "<S> h.  xuong , d.  r.  schuette , m.  w.  tate , l.  j.  koerner . </S>",
    "<S> `` first results from the 128x128 pixel mixed - mode si x - ray detector chip '' , 67060u ( september 21 , 2007 ) .    k.  s.  green , h.  t.  philipp , m.  w.  tate , j.  t.  weiss , s.  m.  gruner , `` calibration and post - processing for photon - integrating pixel array detectors , '' , * 425*(062009 ) ( 2013 ) ]    m.  w.  tate , d.  chamberlain , k.  s.  green , h .  t.  philipp , p.  purohit , c.  strohman , s.  m.  gruner , `` a medium - format , mixed - mode pixel array detector for kilohertz x - ray imaging '' , * 425*(6 ) ( 2013 ) .    </S>",
    "<S> eric  w.  weisstein ,  secant method \" from mathworld - a wolfram web resource . </S>",
    "<S> http://mathworld.wolfram.com/secantmethod.html    </S>",
    "<S> s.  h.  w.  scheres , h.  gao , m.  valle , et  al ,  disentangling conformational states of macromolecules in 3d - em through likelihood optimization \" , * 4*(1 ) ( 2007 ) </S>"
  ]
}