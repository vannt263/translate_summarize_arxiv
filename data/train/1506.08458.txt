{
  "article_text": [
    "quantum key distribution ( qkd ) is a cryptographic task that allows two distant parties , alice and bob , to exchange secret keys and communicate securely over an untrusted quantum channel , provided they have access to an authenticated classical channel .",
    "the first qkd protocol , bb84 , was proposed by @xcite more than three decades ago and the last 30 years have witnessed staggering experimental advances , making qkd the first quantum information technology . with the advent of quantum information theory , @xcite offered a fruitful new perspective on quantum key distribution by casting it in terms of quantum entanglement and bell nonlocality and it was quickly noted that the original bb84 protocol can be seen in this light as well  @xcite .",
    "this new perspective was particularly useful for the development of formal security proofs of qkd .",
    "formalizing the intuitive security arguments accompanying the first protocols has proven to be challenging .",
    "early proofs by @xcite , @xcite , and @xcite successfully attacked the problem in the asymptotic limit of infinitely many exchanged quantum signals ( and unbounded classical computing power ) .",
    "a later work by @xcite first brought to light that security can be certified using an entropic form  @xcite of heisenberg s uncertainty principle  @xcite .",
    "however , these works all lacked a convincing treatment of the security tradeoff in a more realistic regime where the number of exchanged signals and the classical computing power ( i.e. , the length of the bit strings computations are performed on ) are necessarily finite , and the final secret key is thus also of finite length . as absolute security is no longer feasible , the first and most crucial question arising in this finite regime is how to properly define approximate security of a cryptographic protocol .",
    "following developments in classical cryptography , @xcite extended the concept of composable security to quantum key distribution and established a first security proof for finite key lengths .",
    "this security analysis essentially established a tradeoff between different parameters of a quantum key distribution protocol :    block length : : :    during the run of the protocol the two honest parties , typically    called alice and bob , prepare , send and measure quantum signals and    store the results of these measurements in bit strings that they store    on their respective ( classical ) computers .",
    "these bit strings will    eventually be used to check for the presence of an interfering    eavesdropper and to compute a secret key .",
    "as these strings get longer    it gets easier to guard against eavesdroppers and secret keys can be    extracted more efficiently . on the other hand",
    "there are limitations on    the length because we would like to start producing a secret key as    early as possible and because computations on    longer strings get more and more difficult .",
    "the length of the bit    strings used in the protocol is called the _",
    "block length_. current    experimental and commercial implementations of quantum key    distribution typically work with block lengths of the order    @xmath0@xmath1 whereas block lengths of the    order @xmath2@xmath3 can be achieved , but    require an extreme stability of the system during the several hours    required to collect the data @xcite , @xcite .",
    "key length : : :    the _ secret key length _ is the length of the secret key ( in bits ) that    is extracted from a single block of measurement data .",
    "an ideal secret    key is a uniformly random bit string perfectly correlated between    alice and bob and independent of any information the eavesdropper    might have collected after the run of the protocol .",
    "the ratio of the    key length to the block length is a key performance indicator of    quantum key distribution systems .",
    "security parameters : : :    modern security definitions for quantum key distribution rely on    approximate indistinguishability from an ideal protocol , which ensures    that the resulting key can be safely used in any other ( secure )    application . in this case , the ideal protocol either has the two    parties produce an ideal secret key or an abort flag that indicates    that no secret key can be extracted , either because an eavesdropper is    present , or more mundanely because the quantum channel is too noisy .    the _ security parameter _ is the distinguishing advantage between the    real and the ideal protocols , given by the diamond norm distance    between the two protocols .",
    "evidently we would like this parameter to    be very small and while there is no consensus on what value it should    have we will take it to be @xmath4 for our numerical    examples .",
    "robustness : : :    according to the notion of security discussed above , a quantum key    distribution protocol can be perfectly secure and completely useless    because it always aborts . as an additional requirement we thus impose    that the protocol succeeds with high probability when the quantum    channel is subject to noise below a specific ( and realistic )",
    "this describes the _ robustness _ of the protocol against    noise , that is , the probability that the protocol returns a nontrivial    key for a given noise level .",
    "the noise model used should capture the    dynamics of the quantum channel in the expected field operation ;    however , the exact specification of the noise model  and whether the    noise is caused by an eavesdropper or just by the undisturbed    operation of the channel  is independent of any security considerations    and can thus be treated independently .",
    "the robustness , and more    specifically the values of the channel parameters for which the    robustness goes to zero , is an important figure of merit to compare    the expected performance of various protocols .",
    "the tradeoffs between these parameters have been significantly improved since renner s proof  @xcite , in particular by @xcite and @xcite , so that the proofs are now sufficiently tight to provide security for realistic implementations of quantum key distribution .",
    "the present analysis will mostly follow the approach in the former paper  @xcite .",
    "so what justifies us revisiting this problem here ?",
    "firstly , we believe that presenting a complete and rigorous security proof in a single article will make the topic of finite size security more accessible to researchers in quantum cryptography . secondly , thanks to some improvements in the technical derivation and a steamlining of the analysis , our proof yields significantly stronger tradeoff relations between security and performance parameters .",
    "it is worth noting here that strengthening theoretical tradeoff relations of a qkd protocol has rather direct implications for practical implementations as it allows for the generation of more secure key at the same noise level without any changes to the hardware .",
    "thirdly , although all the necessary technical ingredients and conceptual insights are present in the literature , we were not able to find a concise security proof for any qkd protocol that satisfies the following two stringent criteria :    1 .",
    "the protocol is able to extract a composably secure key for reasonable parameters ( i.e.  realistic noise levels , security parameters and block lengths that can be handled with state - of - the - art computer hardware ) .",
    "the protocol and all the assumptions on the physical devices used in the protocol are completely specified and all aspects of the protocol are formalized , including the randomness that is required and all the communication transcripts that are produced .",
    "the second point may appear trivial  but we believe the absence of a complete formalization of all aspects of a protocol found in many research papers presents a major obstacle in verifying the proofs and learning about the security of quantum key distribution and quantum cryptography in general .",
    "it is in fact common in much of the present literature to fully formalize some aspects of a security proof while keeping other aspects vague and informal  and this has lead to various misconceptions .",
    "let us illuminate this issue with an example .",
    "it is often argued ( e.g.  in  @xcite ) that collective attacks ( where the eavesdropper attacks every quantum signal exchanged between alice and bob in the same way ) are optimal for the eavesdropper using symmetry and de - finetti arguments  @xcite .",
    "to get such symmetry it is at some point or another used that measurements are performed in a random basis or that a random subset of raw key bits are used for parameter estimation . however",
    ", complete security proofs also must allow for the protocol to abort in case certain thresholds are not met , and one is then left to analyze the state of the system conditioned on the fact that the protocol does not abort .",
    "this conditioning will in general introduce correlations between the state held by alice and bob and the seeds used to choose the measurement bases and parameter estimation subset , violating the strict symmetry assumptions .",
    "even if these correlations are weak in typical cases , they prove problematic since they allow the eavesdropper to slightly influence alice and bob s measurement devices , something which is usually explicitly forbidden in security proofs for quantum key distribution with trusted devices . hence , many simple arguments based on symmetry or independent randomness simply do not go through without modification when the security proof is put under a microscope .    as mentioned above",
    ", the early asymptotic proofs fail with point  1 .",
    "moreover , while renner s analysis  @xcite gives bounds for finite keys , these are not sufficient to pass point  1 since the bounds are not strong enough for realistic key lengths . or @xmath1 uses of the quantum channel are typically required for the key rate to effectively become nonzero  @xcite .",
    "] more recent security proofs by @xcite and @xcite satisfy point  1 , but they are not fully formalized and thus do not satisfy point  2 . in fact , our requirements in point  2 are very stringent and we are not aware of any security proof that has met this level of rigor , except arguably renner s thesis  @xcite .",
    "a recent security proof for the one - sided device - independent setting  @xcite satisfies point 2 but provides a key rate that is not optimal asymptotically .    [ [ results - and - outline . ] ] results and outline .",
    "+ + + + + + + + + + + + + + + + + + + +    in the present paper , we give a rigorous and largely self - contained security proof for qkd that satisfies the two conditions above .",
    "the proof is based on the security analysis in  @xcite and uses an entropic uncertainty relation  @xcite as its main ingredient .",
    "a few additional technical results and modifications of previous results are needed .",
    "we hope that our proof is accessible to all researchers interested in the security of quantum cryptography .",
    "as such , our treatment does not require the reader to have prior knowledge of various tricks and security reductions in quantum cryptography , but presumes a solid understanding of the mathematical foundations of quantum information theory .",
    "the remainder of this manuscript is structured as follows .",
    "first we introduce necessary notation and concepts in section  [ sc : notation ] . in part",
    "[ part : eb ] we analyze a class of simple entanglement - based protocols reminiscent of the bbm92 protocol  @xcite .",
    "section  [ sc : eb1 ] formally describes the class of protocols we are using ( see also table  [ tb : simple ] ) .",
    "section  [ sc : eb2 ] formally introduces our security definitions and claims .",
    "we discuss our results in section [ sc : eb2.5 ] and provide a detailed security proof in section  [ sc : eb3 ] . in part",
    "[ part : pm ] we move on to a prepare - and - measure protocol that is essentially equivalent to bb84 .",
    "section  [ sc : pm1 ] formally introduces this class of protocols ( see also table  [ tb : realistic ] ) and section  [ sc : pm2 ] reduces their security to the security of the entanglement - based protocol .    _ note added . _ after completion of this work a novel and intriguing proof technique ( based on rnyi entropy accumulation ) has been proposed by @xcite .",
    "this technique does not yet seem to yield tradeoffs between security and protocol parameters that match those found in  @xcite and  @xcite , on which we improve upon here . however , the technique is more versatile and in particular allows to show security of device - independent protocols as demonstrated by  @xcite .",
    "device - independent protocols have the advantage that fewer assumptions on the physical devices used in the protocol are required , but are beyond the scope of this work .",
    "we will summarize some concepts necessary for our formal security proofs here , assuming that the reader is familiar with the mathematical foundations of quantum information theory .",
    "we refer to  @xcite for a comprehensive introduction into this mathematical toolkit .",
    "sections  [ sec : not1][sec : not4 ] are necessary for understanding our main exposition whereas the concepts introduced in sections  [ sec : not5 ] will be employed only in the security proof .      individual _ quantum systems _ and the corresponding finite - dimensional hilbert spaces are denoted by capital letters .",
    "the dimension of the system @xmath5 is denoted by @xmath6 .",
    "a _ joint quantum system _ @xmath7 is defined via the tensor product of the corresponding hilbert spaces of @xmath5 and @xmath8 .",
    "we use @xmath9 $ ] to denote the set @xmath10 and use @xmath11}$ ] to denote a joint quantum system comprised of quantum systems @xmath12 .",
    "similarly , if the subscript is a subset of @xmath9 $ ] , we just refer to the subsystems in the subset .",
    "let us also introduce the notation @xmath13 : |\\pi| = k \\}$ ] , the set of subsets of @xmath9 $ ] of size @xmath14 .",
    "we write @xmath15 to denote normalized states on @xmath5 , i.e. , positive semi - definite operators acting on the hilbert space @xmath5 with unit trace .",
    "a state is called pure if it the corresponding operator has rank @xmath16 .",
    "we will employ the trace distance between states , which is defined as @xmath17 where @xmath18 ranges over projectors , i.e.  positive semi - definite operators with eigenvalues in @xmath19 .",
    "in particular , we have @xmath20 , where @xmath21 denotes the schatten 1-norm .",
    "the trace distance has an immediate physical interpretation  @xcite : for two states with trace distance @xmath22 , the maximum probability of distinguishing them with a single measurement equals @xmath23 .",
    "we also collect positive semi - definite operators with trace norm not exceeding 1 on @xmath5 in the set @xmath24 , and call them sub - normalized states .",
    "symbolizes the unit disk in trace norm . ]",
    "sub - normalized states will be very convenient for technical reasons as they allow us to represent the state of quantum systems and classical events simultaneously .",
    "the following metric is very useful when dealing with sub - normalized states :    [ df : pd ] for @xmath25 , we define the _ generalized fidelity _ , @xmath26 and the _ purified distance _ , @xmath27 .    the purified distance is a metric on sub - normalized states and satisfies  ( * ? ? ?",
    "* lemma  2 ) @xmath28 for every completely positive ( cp ) trace non - increasing map @xmath29 .",
    "this means in particular that the distance contracts when we apply a quantum channel to both states .",
    "an important property of the purified distance  ( * ? ? ?",
    "* corollary  3.1 ) is that for any two states @xmath30 and any extension @xmath31 of @xmath32 , there exists an extension @xmath33 with @xmath34 .",
    "( this property is not true in general for the trace distance . )",
    "moreover , it is related to the trace distance as follows  ( * ? ? ?",
    "* lemma  6 ) : @xmath35      we model discrete random variables by finite - dimensional quantum systems , called _",
    "registers _ , with a fixed orthonormal basis .",
    "for example , let @xmath36 be a random variable with probability law @xmath37 .",
    "then we write the corresponding quantum state as @xmath38 where @xmath39 is an orthonormal basis of the space @xmath40 .",
    "conversely , we write @xmath41_{\\rho } = p_x(x)$ ] .    more generally , the classical register might be correlated with a quantum system @xmath5 , and this is modeled using _ classical - quantum ( cq ) _ states : @xmath42 where we use @xmath43 to denote the quantum state on @xmath5 conditioned on the register @xmath40 taking the value @xmath44 .",
    "we also write @xmath45_{\\rho } = \\operatorname{tr}\\ { { \\left|x\\middle\\rangle\\!\\middle\\langle x\\right|}_x \\rho_{xa } \\ } = p_x(x)$ ] .",
    "this convention is extended to arbitrary events defined on a classical register @xmath40 , i.e.  if @xmath46 is an _ event _ , we write @xmath47_{\\rho } = \\sum_{x \\in { \\mathcal{x } } } p_x(x ) \\omega(x ) \\quad \\textrm{and } \\quad     \\rho_{xa \\land \\omega } = \\sum_{x \\in { \\mathcal{x } } } p_x(x ) \\omega(x ) { \\left|x\\middle\\rangle\\!\\middle\\langle x\\right|}_x \\otimes \\rho_{a|x = x } \\,,\\end{aligned}\\ ] ] a state that is generally sub - normalized .",
    "we will also write @xmath48_{\\rho}^{-1 } \\rho_{xa|\\omega}$ ] for the conditional state . for any event",
    "@xmath49 we denote its complement on @xmath50 by @xmath51 .      a _ quantum channel _",
    "@xmath52 is a completely positive trace - preserving ( cptp ) map that maps operators on @xmath5 to operators on @xmath8 .",
    "prime examples of quantum channels are the trace , denoted @xmath53 , and the partial trace over system @xmath5 , denoted @xmath54 .",
    "we will encounter the diamond distance between cptp maps , which we here define as @xmath55 where the optimization goes over joint states on @xmath5 and an auxiliary system @xmath56 , and we can assume without loss of generality that @xmath57 .",
    "the diamond distance also inherits the physical interpretation of the trace distance : for two quantum channels with diamond distance @xmath22 , the maximum probability of distinguishing them by preparing a state on the input system and an ancilla system and then measuring the joint system after applying the channel equals @xmath23 .",
    "a _ generalized measurement _ on @xmath5 is a set of linear operators @xmath58 such that @xmath59 where @xmath60 denotes the identity operator on @xmath5 .",
    "a measurement on @xmath5 can be represented as a cptp map @xmath61 that maps states on a quantum system @xmath5 to measurement outcomes stored in a register @xmath40 . the measurement in   applied to a bipartite state @xmath31 yields @xmath62 where @xmath63 is now a ( normalized ) classical - quantum state . finally , let @xmath64 be a function acting on two sets @xmath50 and @xmath65 . we denote by @xmath66 the corresponding cptp map @xmath67 = \\sum_{x \\in { \\mathcal{x } } } { \\left|f(x)\\right\\rangle}_{y } { \\left|x\\middle\\rangle\\!\\middle\\langle x\\right|}_x \\cdot { \\left|x\\middle\\rangle\\!\\middle\\langle x\\right|}_x { \\left\\langle f(x)\\right|}_{y } \\,\\end{aligned}\\ ] ] that acts on classical registers @xmath40 and @xmath68 of a general cq state",
    "note that we defined the map such that the input register @xmath40 is kept intact and the operation is deterministic and invertible .",
    "universal hashing is used ( at least ) twice in the analysis of the quantum key distribution protocol : first in the error correction step to ensure the correctness of the protocol ( theorem  [ th : correct ] ) , and then in the privacy amplification procedure to guarantee the secrecy of the final key .",
    "let @xmath69 be a family of functions from @xmath70 to @xmath71 .",
    "the family @xmath72 is said to be _ universal@xmath73 _",
    "if @xmath74 = \\frac{1}{|\\mathcal{z}|}$ ] for any pair of distinct elements @xmath75 , when @xmath76 is chosen uniformly at random in @xmath72 .    in this work we do not need to specify any particular family of hash functions , and it suffices to note that such families of functions always exist if @xmath77 and @xmath78 are powers of @xmath79 .",
    "( see , e.g. ,  @xcite . )",
    "conditional entropies measure the amount of uncertainty present in a random variable from the perspective of an observer with access to correlated side information . here",
    "we are particularly interested in observers that have access to a quantum system that serves as side information , for example the eavesdropper s memory after interfering with the quantum communication during the run of a quantum key distribution protocol .",
    "the most common measure of entropy is the shannon or von neumann entropy , defined as @xmath80 .",
    "however , while this entropy has various operational interpretations in the asymptotic limit of infinite repetitions of an information processing task , it is insufficient to describe finite size effects . on the other hand ,",
    "smooth min- and max - entropy allow us to capture such finite size effects and share many properties with the von neumann entropy .",
    "we will not need the full generality of the smooth entropy formalism here and instead refer to  @xcite for a comprehensive introduction .",
    "min- and max - entropy are natural generalizations of conditional rnyi entropies  @xcite to the quantum setting and were first proposed by  @xcite and  @xcite .",
    "the conditional min - entropy captures how difficult it is for an observer with access to quantum side information to guess the content of a classical register . for a bipartite cq state @xmath81",
    ", we define @xmath82_{\\rho } \\operatorname{tr}\\big\\ { e_b^x \\ , \\rho_{b|x = x } \\big(e_b^x\\big)^\\dag\\big\\ } , \\label{eq : gp }     \\end{aligned}\\ ] ] where the optimization goes over all generalized measurements on @xmath8 .    the conditional min - entropy for a cq state is then defined as @xmath83 . for later convenience",
    "we introduce the measure more generally for any bipartite , potentially sub - normalized , state :    for any bipartite state @xmath84 , we define @xmath85    showing equivalence between this definition and the special case of cq states in   involves semidefinite - programming duality  @xcite and is outside the scope of this work .",
    "we will also encounter the max - entropy , which is a natural dual of the min - entropy in the following sense :    for any tripartite state @xmath84 , we define @xmath86 where @xmath87 is any pure state with @xmath88 .    the max - entropy is a measure of the size of the support of @xmath40 . in particular , we have the following ordering of unconditional entropies : @xmath89 _ \\rho > 0 \\ } \\big| , \\end{aligned}\\ ] ] which is a consequence of the monotonicity of the rnyi entropies  @xcite in the order parameter . here and throughout this article @xmath90 denotes the binary logarithm .",
    "we will need a slight generalization of the concepts of conditional min- and max - entropy , which takes into account a ball of states close to @xmath31 in terms of the purified distance introduced in the previous section .    for @xmath84 and @xmath91 , we define @xmath92    in the above definitions we can replace the supremum and infimum with a maximum and minimum , respectively . roughly speaking ,",
    "the smooth conditional min - entropy of @xmath40 given @xmath8 approximates how much randomness that is uniform for an observer with access to @xmath8 can be extracted from @xmath40 .",
    "( this will be made formal when discussing the leftover hashing lemma in section  [ sc : hash ] . )",
    "the smooth entropies inherit the duality relation  @xcite . for any pure state @xmath93",
    ", we have @xmath94    the smooth entropies also satisfy a data - processing inequality ( dpi )  ( * ? ? ?",
    "* theorem  18 ) . for any cq state @xmath95 and any completely positive trace - preserving map @xmath96",
    ", we have @xmath97 this expresses our intuition that performing any processing of the side information can at most increase our uncertainty about @xmath40 .",
    "moreover , we need a simple chain rule  ( * ? ? ? * lemma  11 ) , which states that @xmath98 where @xmath40 is a ( classical ) register of dimension @xmath99 .",
    "this corroborates our intuition that an additional bit of side information on @xmath40 can not decrease our uncertainty about @xmath40 by more than one bit .",
    "we have defined all these quantities for sub - normalized states so that we can easily treat restrictions to events .",
    "let @xmath100 be classical on @xmath40 and @xmath68 and let @xmath101 be an event .",
    "then we denote by @xmath102 the conditional entropy evaluated for the state @xmath103 .",
    "similarly , @xmath104 denotes the smooth conditional min - entropy evaluated for the marginal @xmath105 .",
    "these states are in general sub - normalized .",
    "the same notational convention is also used for ( smooth ) min- and max - entropy .",
    "[ part : eb ]    ll @xmath106 , @xmath107 & symbols for abort and passing , respectively +   @xmath108 & measurement operator acting on register @xmath109 with setting @xmath110 and outcome @xmath44 +   @xmath111 & parameter quantifying the quality of the measurement on register @xmath109 +   @xmath112 & parameter quantifying the overall ( average ) quality of measurements on @xmath5 +   @xmath113 & total number of quantum systems shared and measured by alice and bob +   pe & parameter estimation scheme : @xmath114 +   @xmath14 & length ( in bits ) of the raw key used for parameter estimation +   @xmath115 & length ( in bits ) of the raw key used for key distillation +   @xmath116 & threshold for the parameter estimation test +   test & test function used in the parameter estimation step +   ec & error correcting scheme : @xmath117 +   @xmath118 & length ( in bits ) of the error correction syndrome +   @xmath119 & length ( in bits ) of the hash used for verification in the error correcting scheme +   synd & function computing the error syndrome +   corr & function that calculate the corrected string +   @xmath120 & universal@xmath73 family of hash functions used in the error correcting scheme +   pa & privacy amplification scheme : @xmath121 +   @xmath122 & length ( in bits ) of the final key +   @xmath123 & universal@xmath73 family of hash functions used in the privacy amplification scheme +    @xmath5 , @xmath8 & alice s and bob s initial quantum system +   @xmath124 & eve s quantum memory +   @xmath125 & measurement map applied on register @xmath5 with setting @xmath126 and storing the result in register @xmath40 +   @xmath127 & register for alice s and bob s classical bits used for parameter estimation +   @xmath128 & register for alice s and bob s classical bits used for key distillation +   @xmath129 & register for alice s syndrome during error correction +   @xmath130 & register containing the hash of alice s raw key during error correction +   @xmath131 , @xmath132 & register for alice s and bob s final keys +   @xmath133 & seed for the choice of the measurement bases in the idealized protocol +   @xmath134 & seed for the choice of the random subset @xmath135 used for parameter estimation +   @xmath136 & seed for the choice of the measurement bases for the subsystems used for parameter estimation +   @xmath137 & seed for the choice of the measurement bases for the subsystems used for key distillation +   @xmath138 & seed for the choice of the hash function used in the error correction test +   @xmath139 & seed for the choice of the hash function used in the privacy amplification step +   @xmath126 & register corresponding to all the seeds , @xmath140 . +   @xmath141 & flag for the parameter estimation test +   @xmath142 & flag for the error correction test +   @xmath143 & register corresponding to all the flags ,",
    "@xmath144 +   @xmath145 & transcript of the register @xmath146 sent during parameter estimation +   @xmath147 & transcripts of the registers @xmath129 and @xmath130 sent during error correction +   @xmath56 & register containing all the communication transcripts , @xmath148 +    @xmath149 & quantum state before any measurement took place +   @xmath150 & quantum state after the registers used for parameter estimation have been measured +   @xmath151 & quantum state once alice and bob s quantum registers have been entirely measured +   @xmath152 & quantum state describing the final output of the protocol +",
    "[ sc : eb1 ]    we first focus on class of simple entanglement - based qkd protocols .",
    "we give an overview of the protocols in table  [ tb : simple ] .",
    "section  [ sec : assumpt ] discusses the assumptions that go into our model , section  [ sc : params ] presents the protocol parameters , and the detailed mathematical description of the individual steps follows in section  [ sec : model ] .",
    "let us emphasize that by _",
    "simple _ protocols , we mean that we restrict our attention to protocols where the _ sifting _ procedure is essentially given for free , meaning that alice and bob are assumed to initially share a quantum state on which all the measurements are performed .",
    "relatedly , we also do not allow for strategies where the measurement settings are biased towards a specific value .",
    "as discussed in part [ part : pm ] , the sifting procedure can be analyzed separately under certain assumptions .",
    "[ sc : assumeb ]    every mathematical model of physical reality requires some assumptions , and in cryptography it is important to discuss these assumptions since if they are not met by an implementation then the security guarantees derived here are also not applicable to this implementation .    [",
    "[ finite - dimensional - quantum - systems ] ] finite - dimensional quantum systems : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we assume that alice s and bob s relevant quantum degrees of freedom can be effectively represented on a finite - dimensional hilbert space .",
    "( this requirement is not strictly necessary to show security but allows us to circumvent some technical pitfalls . )    [ [ sealed - laboratories ] ] sealed laboratories : + + + + + + + + + + + + + + + + + + + +    we assume that the laboratories of alice and bob are spatially separated .",
    "this allows us to model joint quantum systems @xmath7 shared between alice and bob as tensor products of respective local hilbert spaces @xmath5 and @xmath8 .",
    "moreover , an easily overlooked ( an in practice hard to ensure ) assumption we need is that we control exactly what information is released from alice and bob s laboratory .    [ [ random - seeds ] ] random seeds : + + + + + + + + + + + + +    we assume that alice has access to uniform randomness ( uniformly random seeds ) . in practice , the seeds can be produced by a trusted quantum random number generator in alice s lab .",
    "[ [ authenticated - communication - channel ] ] authenticated communication channel : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we assume that alice and bob share an authenticated public ( classical ) communication channel . everything that is communicated over this channel will be in the public domain and is thus treated as an output of the protocol .",
    "the authentication of the classical channel can be obtained with information - theoretic security by tagging every classical message  @xcite .",
    "a more detailed discussion of authentication for qkd is beyond the scope of the present work , and the interested reader is referred to  ( * ? ? ?",
    "* appendix d ) .",
    "[ [ deterministic - detection ] ] deterministic detection : + + + + + + + + + + + + + + + + + + + + + + + +    we further assume that alice and bob s measurement devices always output a valid outcome , either @xmath153 or @xmath16 . this is unrealistic in practice since it is often the case that detectors will not detect the quantum system ( due to losses or imperfect detection efficiency ) .",
    "a simple fix is then to flip a coin and use the resulting bit as the measurement output .",
    "unfortunately , this solution artificially decreases the robustness of the protocol beyond what is usually tolerable in a practical setting .",
    "another much more practical solution consists in discarding these `` no detection '' events , but this should be done with care and requires extra - assumptions about the measurement devices to prevent various types of side - channel attacks such as that of  @xcite .",
    "we will discuss this solution in more detail in part [ part : pm ] of this work .",
    "[ [ commuting - measurements ] ] commuting measurements : + + + + + + + + + + + + + + + + + + + + + + +    the block length is given by a protocol parameter , @xmath113 , which will be discussed in section  [ sc : params ] .",
    "for alice and bob to run a protocol with block length @xmath113 , we need to assume that both can perform up to @xmath113 measurements ( with either one of two possible settings ) on their share of the quantum state in such a way that the order in which they do these measurements does not affect the resulting measurement outcome distribution .",
    "this is a standard assumption in the model of trusted measurement devices ( by opposition to device - independent cryptography ) and ensures that there are no memory effects in the measurement devices .",
    "more formally , we assume that alice s and bob s share of the quantum system can be decomposed into @xmath113 individual quantum systems , @xmath154 } = a_1 a_2 \\ldots a_m$ ] and @xmath155 } = b_1 b_2 \\ldots b_m$ ] and that the measurements can be represented as operators acting on the individual subsystems .",
    "we model alice s @xmath156-th measurement with setting @xmath157 by a binary generalized measurement @xmath158 acting on subsystem @xmath109 .",
    "the index @xmath44 ranges over the two possible outcomes of alice s measurement .",
    "analogously , bob s @xmath156-th measurement with setting @xmath157 is a binary generalized measurement @xmath159 acting on subsystem @xmath160 .",
    "the index @xmath161 ranges over the two possible outcomes of bob s measurement .",
    "[ [ complementarity - of - alices - measurements ] ] complementarity of alice s measurements : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the exact description of the measurement devices will not be relevant for our derivations .",
    "however , we will need to assume that alice s measurements are sufficiently complementary , a property that is encapsulated by the average overlap , @xmath162 that we introduce next .",
    "let @xmath113 be the block length and @xmath163 the number of bits used for key extraction ( see section  [ sc : params ] for a discussion of the protocol parameters ) .",
    "let us define @xmath164 in an ideal physical implementation of the protocol with complementary measurements ( for example in the computational and hadamard basis ) , we would have @xmath165 for all @xmath166 $ ] . in realistic implementations ,",
    "its value will be larger .",
    "we assume that there exists a reliable upper bound on @xmath111 .",
    "more precisely , we assume that @xmath167    we always have @xmath168 $ ] and the condition @xmath169 is necessary to ensure secrecy .",
    "as long as the commuting measurement assumption holds , the parameter @xmath112 can in principle be measured directly in an experiment  even if the operators @xmath170 are unknown .    for bob we do not need to assume a bound on the complementarity parameter .",
    "( we only need to assume that the measurements commute , as described in the previous item . )      from an information theoretic and mathematical point of view , an entanglement - based qkd protocol is simply a completely positive trace - preserving ( cptp ) map composed of local operations and classical communication ( locc ) that takes a bipartite state @xmath31 as an input and either aborts or returns two classical binary strings , the keys , which should ideally be identical and independent of the knowledge of any third party having access to a purifying system of @xmath31 and to the transcript of the communication performed by the protocol .",
    "we consider protocols that are parametrized by the block length , @xmath113 , and the sub - protocols for parameter estimation , error correction and privacy amplification , respectively denoted by @xmath171 , @xmath172 , and @xmath173 .",
    "* the block length , @xmath174 , determines the number of individual quantum systems that are shared between alice and bob , and thus available to them for parameter estimation and key extraction .",
    "* parameter estimation is characterized by a tuple @xmath114 , where @xmath175 determines the number of quantum systems used for parameter estimation and @xmath176 is the tolerated error rate .",
    "let us for later convenience also define @xmath177 to denote the number of quantum systems used for key generation . *",
    "the error correcting scheme is described by a quintuple @xmath117 . here , @xmath178 is the length ( in bits ) of the error correction syndrome .",
    "moreover , @xmath179 and @xmath180 are functions of the form @xmath181 and @xmath182 used to compute the error syndrome and calculate the corrected string , respectively .",
    "we do not need to assume anything about the structure of this code . to fix ideas ,",
    "let us just note that there exist good error correction codes with @xmath183 , where @xmath184 is the binary entropy function and @xmath116 is the number of errors to be corrected",
    ". could be a linear code described by an @xmath185 parity check matrix @xmath76 such that @xmath186 .",
    "moreover , @xmath180 can be any decoder , for example the ( optimal ) maximum likelihood decoder , but also a more practical suboptimal iterative decoder .",
    "] + finally , @xmath187 is the length ( in bits ) of the hash used for verification and @xmath188 is a universal@xmath73 family of hash functions .",
    "we will see in theorem  [ th : correct ] that the size @xmath119 only depends logarithmically on the targeted correctness parameter .",
    "* privacy amplification is characterized by a tuple @xmath121 , where @xmath189 with @xmath190 is the length ( in bits ) of the extracted key and @xmath191 is a universal@xmath73 family of hash functions .",
    "+ note that @xmath122 , the length of the final key , is fixed .",
    "it is in principle possible to design adaptive protocols where the final key length is chosen after parameter estimation , but this is beyond the scope of this work .",
    "this allows us to define a family of protocols in table  [ tb : simple ] .",
    "note that any such protocol is simply a completely positive trace - preserving map that maps bipartite quantum states shared between alice and bob onto probability distributions of the classical outputs , and we will define their exact operation in section  [ sec : model ] .      here",
    "we describe in detail the mathematical model underlying the protocol in table  [ tb : simple ] .",
    "it is worth emphasizing that the eavesdropper does not appear anywhere in this description , but will of course be required when assessing the security of the protocol as discussed in section [ sc : eb2 ] .",
    "[ [ input ] ] input : + + + + + +    alice and bob are given a state @xmath192 , where @xmath193 } = a_1 a_2 \\ldots a_m$ ] consists of @xmath113 quantum systems of arbitrary , finite dimension , @xmath194 } = b_1 b_2 \\ldots b_m$ ] consists of @xmath113 quantum systems of arbitrary , finite dimension .",
    "note that apart from the above structure , the state @xmath192 is fully general .",
    "the situation is depicted in figure  [ fig : state_input ] .",
    "( 200 , 40 ) ( 11 , 30)alice ( 70 , 30)public domain ( 170 , 30)bob ( 15 , 10 ) ( 19 , 10)@xmath5 ( 172 , 10 ) ( 176 , 10)@xmath8 ( 50 , 0 ) ( 0 , 1)40 ( 150 , 0 ) ( 0 , 1)40    [ [ randomization ] ] randomization : + + + + + + + + + + + + + +    we model the randomization by random seeds ( uniform random variables ) , shared between alice and bob over the public authenticated channel .",
    "these random seeds are represented by a quantum state @xmath195 which is assumed to be maximally mixed and independent of @xmath31 .",
    "the situation after randomization is depicted in figure  [ fig : state_rand ] .",
    "let us now detail the content of the system @xmath126 .",
    "the first random variable is a random basis choice for each quantum system .",
    "this is modeled as a register @xmath196 in the state @xmath197 where @xmath198 is an orthonormal basis of the space @xmath196 and @xmath199 } = ( \\phi_1 , \\phi_2 , \\ldots , \\phi_m)$ ] with @xmath200 . the total state at the beginning of the protocol is thus of the form @xmath201 .",
    "the seed for the choice of the random subset is denoted @xmath202 and is initially in the state @xmath203 where @xmath204 is an orthonormal basis of the space @xmath202 . for any @xmath135",
    ", we denote its @xmath14 elements by @xmath205 , for @xmath206 $ ] and we denote by @xmath207 $ ] the complement of @xmath208 .    at this point",
    "we reorder the measurement settings in @xmath196 into two parts : the settings to be used for measuring quantum systems in @xmath208 will be stored in a register @xmath209 and the settings to be used for measuring the remaining @xmath163 quantum systems in @xmath210 will be stored in a register @xmath211 .",
    "formally , we consider the function @xmath212 since @xmath196 is uniformly random , the resulting state after applying this function and discarding @xmath196 is of the form @xmath213 where the registers containing @xmath209 and @xmath211 are again uniformly random : @xmath214 for @xmath215 } = ( \\xi_1 , \\xi_2 , \\ldots , \\xi_k)$ ] and @xmath216 } = ( \\theta_1 , \\theta_2 , \\ldots , \\theta_n)$ ] with @xmath217 .    the choice of the hash function in the family @xmath218 and the choice of hash function in the family @xmath219 are modeled via random seeds @xmath220    ( 200 , 60 ) ( 11 , 50)alice ( 70 , 50)public domain ( 170 , 50)bob ( 15 , 30 ) ( 15 , 5 ) ( 19 , 30)@xmath5 ( 19 , 5)@xmath126 ( 172 , 30 ) ( 172 , 5 ) ( 176 , 30)@xmath8 ( 176 , 5)@xmath126 ( 32 , 9)(1 , 0)138 ( 100,9)(0 , 1)15 ( 92 , 30 ) ( 96 , 30)@xmath126 ( 50 , 0 ) ( 0 , 1)60 ( 150 , 0 ) ( 0 , 1)60    [ [ measurement ] ] measurement : + + + + + + + + + + + +    we split the measurement process into two parts , measuring the systems in the set @xmath208 and @xmath210 separately .",
    "while this distinction is not relevant for the practical implementation of the protocol , the notation introduced here will be important for the security analysis later .",
    "the first measurement concerns the registers in @xmath208 , which are used for parameter estimation . for any subset @xmath135",
    ", we define a completely positive trace - preserving map @xmath221 where @xmath222 } = v_1 \\otimes v_2 \\otimes \\ldots v_k$ ] models @xmath14 binary classical registers storing the measurement outcomes . the map is given by @xmath223 where @xmath224 } m_{a_{\\pi_i}}^{\\xi_i , v_i}$ ] .",
    "this map measures the @xmath14 subsystems determined by @xmath208 using the ( random ) measurement settings stored in the register @xmath136 .",
    "the results are stored in the classical register @xmath146 , and the post - measurement state remains in the systems @xmath225 .",
    "similarly , we define @xmath226 as @xmath227 where @xmath228 } m_{b_{\\pi_i}}^{\\xi_i , w_i}$ ] .",
    "the two maps @xmath229 and @xmath230 commute since they act on different systems and we write their concatenation as @xmath231 .",
    "so far we have considered @xmath208 to be fixed .",
    "the full measurement for parameter estimation instead consults the register @xmath202 and is modeled as a map @xmath232 given by @xmath233 the state of the total system after the measurement required for parameter estimation is thus given by @xmath234    the second measurement concerns the quantum systems used for extracting the secret key .",
    "the corresponding measurement maps are defined analogously to the measurements maps above , but now act on the systems determined by @xmath210 , the complement of @xmath208 in @xmath9 $ ] .",
    "we define @xmath235 as well as @xmath236 .",
    "it is evident that all measurements @xmath237 defined so far mutually commute because they act either on classical registers or on distinct quantum registers .",
    "finally , we define the total measurement map as @xmath238 .    of particular interest",
    "is the state of the system after measurement and after we discard the quantum systems .",
    "this is given by a classical state @xmath239 .",
    "this state is of the form @xmath240 where we write @xmath241 and analogously introduce @xmath242 , @xmath243 and @xmath244 .",
    "the situation after the complete measurement is depicted in figure  [ fig : state_meas ] .",
    "( 300 , 60 ) ( 31 , 50)alice ( 120 , 50)public domain ( 240 , 50)bob    ( 35 , 30 ) ( 39 , 30)@xmath126 ( 5 , 5 ) ( 9 , 5)@xmath5 ( 43,25.5)(0 , -1)16 ( 4 , 0)(1,1)17 ( 23 , 9)(1 , 0)30 ( 55 , 5 ) ( 59 , 5)@xmath146 ( 75 , 5 ) ( 79 , 5)@xmath40    ( 245 , 30 ) ( 249 , 30)@xmath126 ( 215 , 5 ) ( 219 , 5)@xmath8 ( 253,25.5)(0 , -1)16 ( 214 ,",
    "0)(1,1)17 ( 233 , 9)(1 , 0)30 ( 265 , 5 ) ( 268 , 5)@xmath245 ( 285 , 5 ) ( 289 , 5)@xmath68    ( 245,-1)@xmath246 ( 35,-1)@xmath246    ( 142 , 30 ) ( 146 , 30)@xmath126 ( 100 , 0 ) ( 0 , 1)60 ( 200 , 0 ) ( 0 , 1)60    [ [ parameter - estimation ] ] parameter estimation : + + + + + + + + + + + + + + + + + + + + +    we model parameter estimation by a test function acting on the registers @xmath146 and @xmath245 and creating a binary flag @xmath247 as follows : @xmath248 } 1\\ { v_i \\neq w_i \\ } \\geq k \\delta ,       \\\\    { \\checkmark } & \\textrm{otherwise}. \\end{cases } \\end{aligned}\\ ] ]    this test can be applied to the states @xmath249 or @xmath250 defined previously .",
    "this requires alice to communicate @xmath146 to bob on the authenticated classical channel in order to evaluate the value of @xmath251 and the transcript of this communication is stored in the variable @xmath252 .",
    "we are specifically interested in the state @xmath253 and the corresponding state conditioned on the outcome @xmath254 , given by @xmath255_{\\tau } } \\sum_{\\pi \\in \\pi_{m , k } } \\sum_{\\xi \\in \\{0,1\\}^k } \\sum_{v , w \\in \\{0,1\\}^k \\atop \\sum_{i = 1}^k 1\\ { v_i \\neq w_i \\ }",
    "< k \\delta } \\frac{1 } { 2^k { m \\choose k } } { \\left|\\pi,\\xi\\middle\\rangle\\!\\middle\\langle \\pi,\\xi\\right|}_{s^{\\pi}s^{\\xi } } \\otimes~   \\nonumber\\\\    & \\qquad\\qquad\\qquad   \\dots\\    \\rho_{s^{\\theta } } \\otimes { \\left|v , w\\middle\\rangle\\!\\middle\\langle v , w\\right|}_{vw } \\otimes \\big ( m_{a_{\\pi}}^{\\xi , v } \\otimes m_{b_{\\pi}}^{\\xi , w } \\big ) \\rho_{ab } \\big ( m_{a_{\\pi}}^{\\xi , v } \\otimes m_{b_{\\pi}}^{\\xi , w } \\big)^{\\dagger } \\ , .",
    "\\label{eq : tautau}\\end{aligned}\\ ] ] we will see that this state is crucial for the security analysis in the next section . finally , we note that @xmath256 and @xmath257 commute , and thus in particular we find that @xmath258    we then relabel @xmath146 to @xmath145 and keep it around as part of the transcript , while we discard @xmath245 after performing parameter estimation .",
    "the situation after parameter estimation is depicted in figure  [ fig : state_parest ] .",
    "( 250 , 60 ) ( 11 , 50)alice ( 70 , 50)public domain ( 170 , 50)bob    ( 5 , 30 ) ( 9 , 30)@xmath40 ( 30 , 30 ) ( 34 , 30)@xmath126 ( 15 , 5 ) ( 19 , 5)@xmath146 ( 14 , 0)(1,1)17    ( 172 , 30 ) ( 176 , 30)@xmath68 ( 197 , 30 ) ( 200 , 30)@xmath245 ( 195 , 25)(1,1)17 ( 222 , 30 ) ( 226 , 30)@xmath126 ( 172 , 5 ) ( 176 , 5)@xmath146 ( 170 , 0)(1,1)17    ( 232 , 5 ) ( 235 , 5)@xmath141 ( 189 , 9)(1,0)40 ( 205 , 9)(0,1)16    ( 32 , 9)(1 , 0)138 ( 115,9)(0 , 1)15 ( 77 , 30 ) ( 81 , 30)@xmath126 ( 107 , 30 ) ( 110 , 30)@xmath145 ( 198 , 2)avg    ( 50 , 0 ) ( 0 , 1)60 ( 150 , 0 ) ( 0 , 1)60    [ [ error - correction ] ] error correction : + + + + + + + + + + + + + + + + +    the error correction part of the protocol is split into two parts .",
    "the first part consists of the actual error correction procedure , determined by two functions @xmath179 and @xmath180 that are executed by alice and bob , respectively .",
    "we do not assume anything about these functions , but rather check their success in the second part by evaluating hash functions .",
    "first alice computes a syndrome @xmath259 and sends it to bob over the public channel .",
    "bob then computes an estimate @xmath260 , discarding @xmath68 in the process .",
    "alice and bob then need to check that the decoding procedure succeeded with high probability by comparing hashes of their respective strings @xmath40 and @xmath261 and abort the protocol if they differ .",
    "alice computes a hash of size @xmath119 ( in bits ) of @xmath40 and sends it to bob , who computes the corresponding hash for @xmath261 .",
    "this test is summarized as a classical map @xmath172 acting on registers @xmath40 , @xmath261 and @xmath138 creating a transcript of the hash value @xmath262 and a binary flag @xmath142 as follows : @xmath263    these classical functions are modeled using cptp maps @xmath264 , @xmath265 and @xmath266 , respectively .",
    "applying them to the state @xmath267 yields @xmath268 where the transcript register @xmath269 contains the value of the syndrome and @xmath262 the output of alice s hash .",
    "this process is depicted in figure  [ fig : state_ec ] .",
    "( 320 , 120 ) ( 31 , 110)alice ( 120 , 110)public domain ( 250 , 110)bob    ( 30 , 65 ) ( 34 , 65)@xmath40 ( 75 , 65 ) ( 79 , 65)@xmath129 ( 74 , 60)(1,1)17 ( 47 , 69)(1,0)27 ( 50 , 73)synd    ( 0 , 33 ) ( 4 , 33)@xmath126 ( 75 , 33 ) ( 79 , 33)@xmath130 ( 74 , 28)(1,1)17 ( 17 , 37)(1,0)57 ( 40 , 37)(0,1)23.5 ( 35 , 28)hash    ( 247 , 90 ) ( 251 , 90)@xmath68 ( 246 , 85)(1,1)17 ( 222 , 65 ) ( 226 , 65)@xmath129 ( 220 , 60)(1,1)17 ( 239 , 69)(1,0)35 ( 255 , 69)(0,1)16 ( 276 , 65 ) ( 279 , 65)@xmath261 ( 244 , 60)corr    ( 222 , 33 ) ( 226 , 33)@xmath130 ( 220 , 28)(1,1)17 ( 302 , 33 ) ( 306 , 33)@xmath126 ( 301 , 37)(-1,0)35 ( 285 , 37)(0,1)23.5 ( 249 , 33 ) ( 253 , 33)@xmath270 ( 246 , 28)(1,1)17 ( 232 , 5 ) ( 235 , 5)@xmath142 ( 237,37)(1,0)12 ( 262 , 5 ) ( 265 , 5)@xmath141 ( 243,37)(0,-1)20 ( 274 , 28)hash    ( 92 , 69)(1 , 0)128 ( 182,69)(0 , 1)15 ( 117 , 90 ) ( 121 , 90)@xmath126 ( 142 , 90 ) ( 145 , 90)@xmath145 ( 172 , 90 ) ( 175 , 90)@xmath269 ( 92 , 37)(1 , 0)128 ( 182,37)(0 , -1)20 ( 172 , 5 ) ( 175 ,",
    "5)@xmath262    ( 100 , 0 ) ( 0 , 1)120 ( 200 , 0 ) ( 0 , 1)120    [ [ privacy - amplification ] ] privacy amplification : + + + + + + + + + + + + + + + + + + + + + +    alice and bob use the seed @xmath271 to choose a hash function , which they then both apply on their raw key to compute @xmath272 and @xmath273 , their respective keys . formally , the privacy amplification map is defined as : @xmath274 denoting by @xmath131 and @xmath132 the respective key spaces of alice and bob , the final quantum state is @xmath275 finally , bob reveals the status of his flag registers .",
    "this final step is depicted in figure  [ fig : state_privacy ] .",
    "( 330 , 60 ) ( 31 , 50)alice ( 120 , 50)public domain ( 260 , 50)bob    ( 35 , 30 ) ( 39 , 30)@xmath126 ( 34 , 25)(1,1)17 ( 5 , 5 ) ( 9 , 5)@xmath40 ( 43,25.5)(0 , -1)16 ( 4 , 0)(1,1)17 ( 23 , 9)(1 , 0)40 ( 65 , 5 ) ( 69 , 5)@xmath131    ( 280 , 30 ) ( 284 , 30)@xmath126 ( 279 , 25)(1,1)17 ( 250 , 5 ) ( 254 , 5)@xmath261 ( 288,25.5)(0 , -1)16 ( 249 , 0)(1,1)17 ( 268 , 9)(1 , 0)40 ( 310 , 5 ) ( 313 , 5)@xmath132 ( 220 , 5 ) ( 224 , 5)@xmath143 ( 219 , 0)(1,1)17 ( 218 , 9)(-1,0)38 ( 180 , 9)(0,1)15    ( 280,0)hash ( 35,0)hash    ( 122 , 30 ) ( 126 , 30)@xmath126 ( 147 , 30 ) ( 151 , 30)@xmath56 ( 172 , 30 ) ( 176 , 30)@xmath143    ( 100 , 0 ) ( 0 , 1)60 ( 200 , 0 ) ( 0 , 1)60",
    "for a detailed discussion of the security of quantum key distribution , we refer the reader to  @xcite . for our purposes here ( consistent with  @xcite and  @xcite )",
    ", we say that our protocol is @xmath276-secure if is @xmath276-close to an ideal protocol in terms of the diamond distance .",
    "note in particular that an ideal protocol is allowed to abort , but it will always output a uniformly random shared key in case it does not",
    ". table  [ tb : ideal ] gives such an ideal protocol , denoted designed in such a way that it is close to the original protocol .    in order to show that the protocol is secure , it thus suffices to show that @xmath277 is very small for certain choices of parameters @xmath278 and @xmath173 . in the latter expression @xmath279",
    "is an arbitrary extension of @xmath31 to an auxiliary system @xmath124 . without loss of generality we may take @xmath280 , which is sufficient to achieve the supremum .",
    "physically the system @xmath124 is held by a potential adversary , the eavesdropper . in particular",
    ", this assures that @xmath124 can be assumed finite - dimensional .",
    "hence , we need to show that the trace distance between the protocols outputs is small for all possible input states @xmath279 .",
    "let us now fix @xmath279 for the moment .",
    "the trace distance in   can be simplified by noting that the output of ` qkd_ideal ` equals the output of ` qkd_eb ` if the protocol aborts .",
    "we find @xmath281_{\\omega } \\cdot     \\big\\| \\omega_{k_a k_b s c e | f = \\,({\\checkmark } , { \\checkmark } ) } - \\chi_{k_a k_b } \\otimes \\omega_{s c e | f = \\,({\\checkmark } , { \\checkmark } ) } \\big\\|_{\\operatorname{tr } } \\label{eq : boundthat}\\\\     & \\qquad =     \\big\\| \\tilde{\\omega}_{k_a k_b s c f e \\land f = \\,({\\checkmark } , { \\checkmark } ) } - \\chi_{k_a k_b}\\otimes \\tilde{\\omega}_{s c f e \\land f = \\,({\\checkmark } , { \\checkmark } ) } \\big\\|_{\\operatorname{tr } } \\label{eq : boundthis}\\end{aligned}\\ ] ] where we use @xmath282 and define a perfect key @xmath283 as follows : @xmath284 recall that @xmath285 in   corresponds to a subnormalized state with trace equal to @xmath286_{\\omega}$ ] .",
    "our goal in the following is to bound   or   uniformly in @xmath279 , which implies an upper bound on   as well . in order to do this",
    "we will employ the following lemma which allows us to split the norm into two terms corresponding to correctness and secrecy .",
    "this has been shown , e.g. , in ( * ? ? ?",
    "* theorem 4.1 ) , but we provide a proof here for completeness .    [ lm : security ] let @xmath287 be two constants . if , for every state @xmath288 and @xmath289 , we have @xmath290_{\\omega } & \\leq { \\varepsilon}_{\\textrm{ec } }      \\qquad \\textrm{and}\\\\       \\big\\| \\omega_{k_a s c f e \\land f = \\,({\\checkmark } , { \\checkmark } ) } - \\chi_{k_a}\\otimes \\omega_{s c f e \\land f = \\,({\\checkmark } , { \\checkmark } ) } \\big\\|_{\\operatorname{tr } }       & \\leq { \\varepsilon}_{\\textrm{pa } } \\ , .    \\end{aligned}\\ ] ] then , @xmath291 .",
    "let us introduce an auxiliary state @xmath292 that is equal to @xmath293 except that we set @xmath294 . then",
    ", applying the triangle inequality to the trace distance in   and simplifying the resulting terms , we find @xmath295_{\\omega } + \\big\\| \\eta_{k_a s c e | f = \\,({\\checkmark } , { \\checkmark } ) } - \\chi_{k_a } \\otimes \\omega_{s c e | f = \\,({\\checkmark } , { \\checkmark } ) } \\big\\|_{\\operatorname{tr } } \\ , .",
    "\\end{aligned}\\ ] ] multiplying this with @xmath296_{\\omega}$ ] as in   yields the desired implication .",
    "the first condition of the above lemma  [ lm : security ] ensures that the protocol is _",
    "@xmath297-correct _ , and the second condition ensures that the protocol _ @xmath298-secret_.",
    "if both are satisfied , we say that the protocol is _",
    "@xmath299-secure_. in the security proof we can thus verify the two conditions separately .",
    "we will show the following theorems , which essentially give bounds on the security parameters in terms of the protocol parameters .",
    "the first theorem establishes correctness of the protocol .",
    "correctness of the protocol is ensured in the error correction step using hash functions , and consequently correctness can be bounded in term of the length @xmath119 of the hash that is used . the proof is given in section  [ sc : sec - corr ] .",
    "[ th : correct ] consider the protocol in section  [ sc : protocol ] with @xmath300 .",
    "then for every state @xmath301 and @xmath302 we have @xmath303_{\\omega } & \\leq { \\varepsilon}_{\\rm ec } : = 2^{-t } \\ , .",
    "\\end{aligned}\\ ] ]    the second theorem asserts secrecy .",
    "secrecy is ensured by a combination of the parameter estimation and privacy amplification steps of the protocol , which both introduce an error .",
    "there is a tradeoff between these two errors , parametrized by a scalar @xmath304 , which ought to be optimized numerically . the proof is given in sections  [ sc : sec - first][sc : sec - last ] .",
    "[ th : secure ] consider the protocol in section  [ sc : protocol ] with @xmath305 , @xmath306 and @xmath307 .",
    "then , for every state @xmath279 and _ @xmath282 _ , we have @xmath308 where the error functions are given as @xmath309 and @xmath310 denotes the binary entropy .    combining theorems  [ th : correct ] and  [ th : secure ] we see that total error is thus composed of three components , @xmath311 , @xmath312 , and @xmath298 .",
    "let us take a close look at these errors for the case of large @xmath113 .",
    "first , we note that @xmath312 vanishes asymptotically when we choose @xmath313 , or any other slowly growing function of @xmath113 . to make sure that @xmath311 vanishes we choose @xmath314 and @xmath315 , for example . for a robust operation at noise level @xmath116",
    "it is necessary ( and in theory sufficient ) that the error correction leakage satisfies @xmath316 . since @xmath317 by continuity , we find that @xmath298 vanishes as long as @xmath318 is positive and grows in @xmath113 .",
    "since @xmath14 and @xmath319 become negligible compared to @xmath113 as @xmath113 gets large , our protocol thus achieves the asymptotically optimal rate by  @xcite , with @xmath320 .     as a function of @xmath113 for different error thresholds @xmath321 , optimized over all protocols .",
    "the protocols are required to be @xmath22-secure with @xmath322 and the device parameter is assumed to be @xmath323 .",
    "the error correction leakage is approximated to be @xmath324 , see for instance @xcite .",
    "( a more detailed approximation that includes finite - size effects was recently given in  @xcite . )",
    "all remaining parameters , i.e.  @xmath325 and @xmath119 , are optimized numerically to maximize @xmath122 ( code available online ) .",
    "the dotted horizontal lines show the corresponding asymptotic limit of the key rate for each value of @xmath116 , given as @xmath326 .",
    "the markers indicate the points at which the key rate matches @xmath327 of the asymptotic limit.,scaledwidth=85.0% ]      the security proof should establish that for any input channel @xmath499 given to @xmath493 , either the protocol outputs secret identical keys , or else it aborts . in the same spirit as the entanglement - based version of part [ part : eb ] , we define the security parameter @xmath546 where again @xmath547 is defined analogously to the entanglement - based case and simply replaces the output of @xmath548 with a perfect key in case the protocol does not abort . here , the channels @xmath549 have an additional output that goes to an eavesdropper , and it again suffices to consider maps where @xmath124 is finite - dimensional . establishing security thus boils down to showing that this trace distance is small for all such channels .",
    "our strategy is to show that the realistic protocol is equivalent to applying the idealized qkd protocol on a virtual quantum state @xmath31 independent from the uniformly distributed random seed @xmath196 for the measurement settings .",
    "if this holds , then the security proof of part [ part : eb ] for the simple protocol applies , and establishes the security of the prepare - and - measure protocol . for this",
    ", we need to make explicit assumptions about ( i ) the state preparation on alice s side to make sure that no basis information is leaked and ( ii ) the measurement device on bob s side to ensure that the invalid measurement results do not depend on the measurement basis .",
    "under the assumptions in section [ sc : assumpm ] , we show that the prepare - and - measure qkd protocol is secure .",
    "[ thm : real ] let @xmath550 be such that the protocol in section  [ sc : protocol ] is @xmath22-secure with device parameter @xmath551 . then @xmath493 is also @xmath22-secure .    as will be shown in section  [ sec : proofpm ] , the security of the prepare - and - measure protocol is a consequence of that of the simple protocol studied in part [ part : eb ] , provided that some additional assumptions are made .",
    "when assessing the performance of the protocol , however , two modifications appear .",
    "first , the device parameter ( @xmath484 instead of @xmath112 ) needs to be defined differently since it is no longer a function of the measurement device of alice , but rather of her preparation device . in an ideal implementation , it is still expected to be equal to @xmath552 , as was discussed in section [ sc : assumpm ] .",
    "the more important difference is due to the sifting procedure . indeed , the definition of the _ secret key rate",
    "should now be modified to mean the ration between the key length @xmath122 and the number @xmath465 of individual states prepared and sent by alice ( instead of the number @xmath113 in the simple entanglement - based protocol ) .",
    "the means that the secret key rate achieved with the prepare - and - measure protocol is given by @xmath553 the sifting procedure that we have considered here ( and described in section [ sub : mod ] ) is not optimized to maximize the secret key rate ( or equivalently the ratio @xmath554 ) , but rather to simplify the analysis as much as possible .",
    "better sifting procedures are discussed in @xcite and could involve not fixing the value of @xmath465 in advance for instance .",
    "a typical experiment would be characterized by a given overall transmittance @xmath498 of the optical channel , meaning that approximately @xmath555 photons will be detected by bob , or in other words , that the expected value of @xmath556 is @xmath555 .",
    "given that alice and bob s measurement bases will coincide on expectation @xmath327 of the time , we therefore expect that @xmath557 holds asymptotically .    in particular , the secret key rate of the prepare - and - measure protocol",
    "is then expected to be equal to @xmath558 times the secret key rate of the simple protocol displayed in figure  [ fig : keylength ] .",
    "the purpose of this section is to prove theorems  [ th : correct ] and  [ th : secure ] .",
    "we wish to upper bound the probability of the protocol not aborting and outputting distinct final keys for alice and bob .",
    "we consider the following chain of inequalities : @xmath328_{\\omega } & \\leq \\pr [ k_a \\neq k_b \\land   f^{\\textrm{ec } } = \\ , { \\checkmark}]_{\\omega } \\\\ & =   \\pr [ h_{\\mathrm{pa}}(x ) \\neq h_{\\mathrm{pa}}(x ' ) \\land h_{\\mathrm{ec}}(x ) = h_{\\mathrm{ec}}(x ' ) ] _ { \\omega}\\\\ & \\leq   \\pr [ x \\neq x ' \\land h_{\\mathrm{ec}}(x ) = h_{\\mathrm{ec}}(x ' ) ] _ { \\sigma}\\\\ & = \\pr[x \\neq x']_{\\sigma } \\pr[h_{\\mathrm{ec}}(x ) = h_{\\mathrm{ec}}(x ' ) \\ : | \\ : x \\neq x']_{\\sigma}\\\\ & \\leq \\pr[h_{\\mathrm{ec}}(x ) = h_{\\mathrm{ec}}(x ' ) \\ : | \\ : x \\neq x']_{\\sigma } \\\\ & \\leq |\\mathcal{h}_{\\mathrm{ec}}|^{-1 }   = 2^{-t}.\\end{aligned}\\ ] ] the first inequality follows since we ignore the status of the flag @xmath141 .",
    "the second inequality is a consequence of the fact @xmath329 implies @xmath330 .",
    "the third inequality follows since @xmath331_{\\sigma } \\leq 1 $ ] and the last one by definition of universal@xmath73 hashing .",
    "the crucial bound on the smooth entropy of alice s measurement outcomes follows by the entropic uncertainty relation , suitably applied .",
    "we state the uncertainty relation in a natural form  ( * ? ? ?",
    "* corollary  7.4 ) .",
    "[ pr : ur ] let @xmath332 be an arbitrary state with @xmath18 a classical register , and set @xmath333 .",
    "furthermore , let @xmath334 and let @xmath335 be a bijective function on @xmath18 that is a symmetry of @xmath336 in the sense that @xmath337 for all @xmath338 .",
    "then , we have @xmath339 where @xmath340 . here",
    ", @xmath341 for the map @xmath342 & =   \\operatorname{tr}_a \\bigg ( \\sum_{p \\in p } \\sum_{x \\in x }       { \\left|x\\right\\rangle}_{x }         \\big ( { \\left|p\\middle\\rangle\\!\\middle\\langle p\\right|}_{p } \\otimes f_{a}^{p , x } \\big)\\ \\cdot\\ \\big ( { \\left|p\\middle\\rangle\\!\\middle\\langle p\\right|}_{p } \\otimes f_{a}^{p , x } \\big)^{\\dagger } { \\left\\langle x\\right|}_{x } \\bigg ) \\ , .",
    "\\label{eq : urth2-orig }    \\end{aligned}\\ ] ] and any set ( indexed by @xmath338 ) of generalized measurements @xmath343 .",
    "a variant of this uncertainty relation was first shown in  @xcite , based on the techniques introduced in  @xcite .",
    "we provide a full proof of the uncertainty relation in appendix  [ app : ur ] for completeness . in the following corollary",
    "we apply it to the situation at hand during our protocol .",
    "[ cor : smooth - min - bound ] consider the protocol in section  [ sc : protocol ] with @xmath344 applied to a state @xmath288 and the state @xmath345 as in   that results after measurement and parameter estimation .",
    "define @xmath112 as in  .",
    "then , for @xmath346_{\\sigma}}\\big)$ ] , we have @xmath347    consider the state @xmath348 defined in   and note that it is of the form @xmath349 this is the state of the system after parameter estimation and after measuring @xmath146 and @xmath245 , but with the measurement of @xmath40 and @xmath68 ( in the basis determined by @xmath211 ) delayed .",
    "in particular we have used the fact that the register @xmath211 has not yet been touched in the protocol , and is thus independent and uniform and independent even after we consider the event @xmath350 .",
    "let us now apply proposition  [ pr : ur ] to this state .",
    "for this purpose we equate @xmath351 , @xmath352 , and @xmath353 .",
    "the symmetry is determined by the map @xmath354 with @xmath355 , which only acts on @xmath211 and since this system is uniform and in product with the rest of the state trivially satisfies the symmetry condition of the theorem .",
    "the measurement map is then simply @xmath356 and we can calculate @xmath357 proposition  [ pr : ur ] applied to our setup thus yields @xmath358 finally , the statement of the proposition follows by applying the measurement map @xmath359 ( and discarding the seed registers ) and noting that @xmath360 by the data - processing inequality .",
    "this section covers the necessary statistical analysis .",
    "this is essentially a variation of the analysis in  @xcite , but requires a new tool , lemma  [ lm : likely ] , presented in section [ subsection:2.2 ] , as we are finding it clearer to do the analysis with sub - normalized states here .",
    "we use the following standard tail bound .",
    "[ lm : stat ] consider a set of binary random variables @xmath361 with @xmath362 taking values in @xmath19 and @xmath363 .",
    "let @xmath364 be an independent , uniformly distributed random variable .",
    "then , @xmath365 \\leq e^ { - 2 \\nu^2   \\frac{n k^2}{(n+k ) ( k+1 ) } } .    \\end{aligned}\\ ] ]    remarkably this bound is valid without any assumption on the distribution of @xmath129 .",
    "let @xmath366 } z_i$ ] .",
    "consider the following sequence of inequalities : @xmath367 & \\leq",
    "\\pr \\bigg [ \\frac{1}{n } \\sum_{i \\in \\bar{\\pi } } z_i \\geq \\frac{1}{k } \\sum_{i \\in \\pi } z_i + \\nu \\bigg ] \\\\      & = \\sum_{z \\in \\{0,1\\}^{m } } \\!\\ !",
    "\\pr [ z = z ]         \\pr \\bigg [   \\frac{1}{n } \\sum_{i \\in \\bar{\\pi } } z_i \\geq \\frac{1}{k } \\sum_{i \\in \\pi } z_i+ \\nu \\bigg ] \\\\          & = \\sum_{z \\in \\{0,1\\}^{m } } \\!\\ !",
    "\\pr [ z = z ]         \\pr \\bigg [ \\frac{1}{n } \\sum_{i \\in \\bar{\\pi } } z_i \\geq \\mu(z ) + \\frac{k \\nu}{m } \\bigg ] .",
    "\\label{eq : backintohere }    \\end{aligned}\\ ] ] here , the first inequality holds since @xmath368 implies @xmath369 \\leq \\pr[b]$ ] for any events @xmath5 and @xmath8 .",
    "the first equality follows from the fact that @xmath370 is independent of @xmath129 .",
    "the last equality follows by substituting @xmath371 and rearranging the terms appropriately .",
    "now note that the random sums @xmath372 can be seen as emanating from randomly sampling without replacement @xmath163 balls labelled by @xmath373 from a population @xmath374 with mean @xmath375 .",
    "serfling s bound  ( * ? ? ?",
    "* corollary  1.1 ) then tells us that @xmath376       & \\leq e^ { - 2 n \\bigg ( \\frac{k \\nu}{m } \\bigg)^2 \\frac{1}{1 - f_n^ * } } = e^ { - 2 \\nu^2   \\frac{n k^2}{(n+k ) ( k+1 ) } } \\ , .",
    "\\end{aligned}\\ ] ] where we substituted @xmath377 .",
    "it is important to note that this bound is independent of @xmath375 .",
    "thus , substituting this back into  , we conclude the proof .",
    "the following lemma ensures that disregarding an unlikely event will not disturb the state too much in terms of the purified distance .",
    "[ lm : likely ] let @xmath378 be classical on @xmath40 and @xmath379 an event with @xmath380_{\\rho } = { \\varepsilon } < \\operatorname{tr}\\{\\rho_{ax}\\}$ ] .",
    "then there exists a state @xmath381 with @xmath380_{\\tilde{\\rho } } = 0 $ ] and @xmath382 .",
    "set @xmath383 .",
    "let @xmath384 for some normalization @xmath385 $ ] to be determined .",
    "then the generalized fidelity evaluates to @xmath386 this expression is maximized for @xmath387 and , thus , @xmath388 and @xmath389 . substituting this into   yields @xmath390 , concluding the proof .    with this in hand",
    ", we wish to bound the smooth max - entropy of the state when passing the parameter estimation test .",
    "[ pr : smooth - max - bound ] consider the protocol in section  [ sc : protocol ] with @xmath305 applied to a state @xmath301 and the state @xmath391 in   that results after measurement and parameter estimation . for any @xmath392 , we first define @xmath393 then , for any @xmath394 $ ] such that @xmath395_{\\sigma}$ ] , the following holds : @xmath396    intuitively , this result is a consequence of the fact that when we pass the parameter estimation test , conditioned on any particular value of @xmath68 , the support of @xmath40 is small as the number of errors ( positions where @xmath397 ) is bounded ( with high probability ) .",
    "we use the shorthand @xmath398_{\\sigma}$ ] and @xmath177 .",
    "define the event event @xmath399 } 1\\ { x_i \\neq y_i \\ } \\geq",
    "n ( \\delta + \\nu)\\big\\}$ ] .",
    "we show that the statement in   holds when @xmath400 .",
    "using lemma  [ lm : stat ] , we find @xmath401_{\\sigma } = \\pr\\bigg [ \\sum_{i \\in [ k ] } 1\\ { v_i \\neq w_i \\ } \\leq k \\delta \\",
    "\\land\\ \\sum_{i \\in [ n ] } 1\\ { x_i \\neq y_i \\ }",
    "n ( \\delta + \\nu ) \\bigg]_{\\sigma } \\leq { \\varepsilon}(\\nu)^2 \\label{eq : omegabound}.\\end{aligned}\\ ] ] this gives an upper bound on the probability of the unlikely coincidence where the parameter estimation test passes with threshold @xmath116 but the fraction of errors between @xmath40 and @xmath68 exceeds the threshold @xmath116 by a constant amount .",
    "we now want to remove the above unlikely events from our state @xmath402 by means of smoothing .",
    "lemma  [ lm : likely ] allows to do just that , and we introduce the state @xmath403 that is @xmath404-close to @xmath402 in purified distance and satisfies @xmath380_{\\tilde{\\sigma } } = 0 $ ] . from this",
    "we conclude that @xmath405 where the last equality is a consequence of the fact that @xmath406 is only supported on @xmath407 .",
    "it remains to show that @xmath408 . using the expansion of the conditional max - entropy in  ( *",
    "4.3.2 ) , we find @xmath409_{\\tilde{\\sigma } } \\",
    "2^ { h_{\\max}(x|y = y)_{\\tilde{\\sigma } } } \\bigg ) \\\\    & \\leq \\max_{y \\in \\{0,1\\}^n \\atop \\pr[y = y]_{\\tilde{\\sigma } } > 0 } h_{\\max}(x|y = y)_{\\tilde{\\sigma } } \\\\    & \\leq \\max_{y \\in \\{0,1\\}^n \\atop \\pr[y = y]_{\\tilde{\\sigma } } > 0 } \\log \\big| \\big\\ { x \\in \\{0,1\\}^n : \\pr[x = x|y = y]_{\\tilde{\\sigma } } > 0 \\big\\ } \\big| \\\\    & = \\max_{y \\in \\{0,1\\}^n } \\log \\big| \\big\\ { x \\in \\{0,1\\}^n : \\pr[x = x \\land y = y]_{\\tilde{\\sigma } } > 0 \\big\\ } \\,.\\end{aligned}\\ ] ] in the ultimate inequality we used that the ( unconditional ) rnyi entropy is upper bounded by the logarithm of the distribution s support  @xcite . furthermore , since @xmath380_{\\tilde{\\sigma } }",
    "= 0 $ ] , we have @xmath410_{\\tilde{\\sigma } } > 0 \\big\\ } \\big| & \\leq       \\sum_{x \\in \\{0,1\\}^n } 1 \\bigg\\ { \\sum_{i \\in [ n ] } 1\\ { x_i \\neq y_i \\ } < n ( \\delta + \\nu ) \\bigg\\ } \\\\      & = \\sum_{e \\in \\{0,1\\}^n } 1 \\bigg\\ { \\sum_{i=1}^n e_i < n ( \\delta+\\nu ) \\bigg\\ }",
    "\\label{eq : comb1 } \\\\      & = \\sum_{\\lambda = 0}^n { n \\choose \\lambda } 1 \\big\\ { \\lambda < n ( \\delta+\\nu ) \\big\\ } = \\sum_{\\lambda = 0}^{\\lfloor n ( \\delta + \\nu ) \\rfloor } { n \\choose \\lambda}. \\label{eq : comb2 }    \\end{aligned}\\ ] ] here , in order to derive   we reparameterize @xmath411 , indicating if there is an error at the @xmath156-th position .",
    "finally , in   we substitute @xmath412 , the total number of errors .",
    "the inequality @xmath413 for @xmath414 ( see , e.g. ,  ( * ? ? ?",
    "1.4 ) ) then concludes the proof .",
    "[ sc : sec - last ]    the last main ingredient of our proof is a so - called leftover hashing lemma .",
    "it ensures that if the smooth min - entropy of @xmath40 given some side information @xmath8 is large , then we can extract randomness from @xmath40 that is independent of @xmath8 .",
    "the leftover hashing lemma is , up to a slight change of the definition of the smooth min - entropy , due to renner  ( * ? ? ?",
    "* corollary  5.6.1 ) .",
    "the proof of this exact statement is provided in appendix  [ app : leftover ] for the convenience of the reader .",
    "[ pr : leftover ] let @xmath415 be a classical on @xmath40 and let @xmath416 be a universal@xmath73 family of hash functions from @xmath417 to @xmath418",
    ". moreover , let @xmath419 .",
    "then , @xmath420 where @xmath421 is the fully mixed state and @xmath422 for the function @xmath423 that acts on the registers @xmath40 and @xmath424 .",
    "the following technical lemma allows us to bound the smooth conditional min - entropy restricted to events in terms of the unrestricted entropy .",
    "[ lm : conditioning ] let @xmath425 be classical on @xmath40 and @xmath68 and let @xmath426 be an event with @xmath380_\\rho > 0 $ ] . then",
    ", for @xmath427_{\\rho}}\\big)$ ] , we have @xmath428    let us start with the first inequality . by definition of the smooth conditional min - entropy there exists a state @xmath429 and a state @xmath430 such that @xmath431 without loss of generality  ( * ? ? ?",
    "* lemma  6.6 ) we can assume that @xmath432 is classical on @xmath40 and @xmath68 .",
    "as such , we have @xmath433 and @xmath434 by the monotonicity of the purified distance under trace non - increasing maps .",
    "the desired inequality then follows by definition of the smooth min - entropy evaluated for the state with the event @xmath435 .",
    "the second inequality follows similarly . by definition of the smooth conditional min - entropy",
    "there exists a state @xmath436 and a state @xmath437 such that @xmath438 as discussed previously , this implies in particular the existence of an extension @xmath429 that satisfies @xmath439 . without loss of generality",
    "we can assume that @xmath432 is classical on @xmath40 and @xmath68 .",
    "( to see this , note that pinching in the computational basis on @xmath68 would indeed only decrease the distance between the @xmath432 and @xmath440 , leaving the latter state invariant . ) on the state @xmath432 we can now define the restriction on the event @xmath435 and find @xmath441 finally , we proceed in the same fashion as for the first inequality to show that @xmath442 and conclude the proof .",
    "the next proposition builds on corollary  [ cor : smooth - min - bound ] and proposition  [ pr : smooth - max - bound ] and the above leftover hashing lemma to establish the secrecy of the key .",
    "[ pr : secure ] let @xmath288 .",
    "consider the protocol in section  [ sc : protocol ] with @xmath305 , @xmath306 and @xmath307 and the state @xmath289 .",
    "define @xmath404 as in .",
    "then , for any @xmath394 $ ] such that @xmath443_{\\sigma}$ ] , the following holds : @xmath444 where @xmath445 .",
    "we use @xmath115 .",
    "since @xmath446_{\\sigma } \\leq \\pr[f^{\\mathrm{pe } } = { \\checkmark}]_{\\sigma}$ ] the condition of proposition  [ pr : smooth - max - bound ] is satisfied and we find that @xmath447 for the state @xmath345 as in   that results after measurement and parameter estimation .",
    "combining this with corollary  [ cor : smooth - min - bound ] yields @xmath448 where we introduced the shorthand @xmath449 .",
    "our goal is to translate this in a condition on the state @xmath450 as in   that results after error correction .",
    "the following chain of inequalities holds : @xmath451 the first inequality follows by relabeling @xmath146 to @xmath145 and discarding @xmath245 , an instance of the data - processing inequality .",
    "the transcript register @xmath269 contains the syndrome sent from alice to bob and the inequality   follows by the chain rule in  , and the fact that @xmath452 .",
    "the register @xmath138 in the state @xmath453 is independent of the other registers .",
    "the register @xmath262 contains the hash of the raw key @xmath40 of size @xmath454 leading to the penultimate inequality . in the last step we used lemma  [ lm : conditioning ] .    summarizing @xmath455 as well as @xmath148 , and @xmath456 as usual , we can thus more compactly write this as @xmath457 proposition  [ pr : leftover ] applied with this bound then immediately yields the desired inequality .",
    "the above proposition suffers from the assumption @xmath458_{\\omega}$ ] .",
    "however , the other case can easily be dealt with .",
    "indeed , the trace distance @xmath459 is upper bounded by the the trace of both states , i.e.  the probability @xmath460_{\\omega}$ ] . the inequalities @xmath460_{\\sigma } \\leq { \\varepsilon}(\\nu)^2 \\leq { \\varepsilon}(\\nu)$ ] then yield the following corollary , which is equivalent to theorem  [ th : secure ] .",
    "consider the setup of proposition  [ pr : secure ] .",
    "for any @xmath394 $ ] the following holds : @xmath461 where @xmath404 is defined in  .",
    "[ part : pm ]    ll @xmath462 & quantum channel between alice and bob +   @xmath463 & preparation map that returns a state in register @xmath5 depending on the settings @xmath464 +    @xmath465 & number of states sent by alice in the prepare - and - measure version +   @xmath435 & subset of @xmath466 $ ] for which bob obtains a conclusive measurement result +   @xmath467 & subset of @xmath113 indices where alice and bob s settings agree and bob obtained a conclusive outcome +   ro & reordering map used in the sifting step .",
    "+    @xmath468 & register for alice s raw key in the prepare - and - measure protocol +   @xmath469 & register for bob s measurement results in the prepare - and - measure protocol +    @xmath470 & seed for the choice of alice s measurement bases in the prepare - and - measure protocol +   @xmath471 & seed for the choice of bob s measurement bases in the prepare - and - measure protocol +    @xmath126 & register corresponding to all the seeds that alice communicates to bob after state distribution +   & @xmath472 +    @xmath473 & flag for the sifting procedure in the prepare - and - measure protocol +   @xmath143 & register corresponding to all the flags ,",
    "@xmath474 +   @xmath475 & transcripts of the registers @xmath435 and @xmath467 sent during sifting +   @xmath56 & register containing all the communication transcripts , @xmath476 +",
    "[ sc : pm1 ]    here we discuss a prepare - and - measure ( pm ) protocol for qkd , denoted , which is essentially equivalent to bb84  @xcite , and prove that its security follows from that of the entanglement - based protocol considered in part [ part : eb ] , provided that some _",
    "additional assumptions _ are made .",
    "section  [ sc : modelpm ] provides the details of the protocol described in table [ tb : realistic ] , for the steps where it differs from the entanglement - based protocol .",
    "we describe the additional assumptions on the preparation and measurement devices in [ sub : dev ] and present a mathematical model of the protocol in [ sub : mod ] .",
    "[ sc : assumpm ]    the physical equipment of alice an bob is modified compared to that of the entanglement - based protocol considered in part [ part : eb ] .",
    "indeed , the main point of implementing a prepare - and - measure protocol is that it is no longer required for alice and bob to share an entangled state , a task that remains very challenging if the two parties are a few tens of kilometers apart , which is typical in realistic scenarios where one wants to distribute secret keys at the scale of a metropolitan area . in the prepare - and - measure setup alice and bob",
    "do not start with an entangled state but instead have access to a quantum channel from alice to bob .",
    "the assumption on finite - dimensional quantum systems , sealed laboratories , random seeds and authenticated communication channel discussed in section  [ sc : assumeb ] still apply .",
    "the assumption of sealed laboratories in particular implies that the quantum channel between alice and bob models all quantum communication leaving alice s lab .",
    "however , we will replace the assumption of commuting measurements , deterministic detection and the complementarity of alice s measurements .",
    "[ [ alices - preparation ] ] alice s preparation : + + + + + + + + + + + + + + + + + + + +    in every round , indexed by @xmath477 $ ] , alice s preparation device takes two bits as input : @xmath157 describing a basis choice and @xmath478 describing the bit value within each basis .",
    "it produces a quantum state @xmath479 , ideally corresponding to one of the four bb84 states . the commuting measurement assumption for alice",
    "is replaced with the requirement that these states do not depend on the preparations in previous or later rounds ( which is already ensured by our notation ) .",
    "our next assumption is that the state @xmath479 does not leak any information about the basis choice @xmath110 , i.e. , we require that @xmath480 moreover , instead of the complementarity assumption on the measurements , we require that the prepared states are sufficiently complementary .",
    "more precisely , let us define @xmath481 in case @xmath40 has not full support we take the generalized inverse ( on its support ) in the above definition .",
    "our second assumption on alice s preparation is that @xmath482 for all @xmath477 $ ] and some constant @xmath483 .",
    "the constant @xmath484 is closely related to the constant @xmath112 that described the complementarity of alice s measurement in the entanglement - based protocol , as we will see in corollary  [ cor : virtual ] .    in an ideal implementation of the bb84 protocol , the states @xmath485 would be single - qubit states given by @xmath486 these states obviously satisfy the assumption in   and it is easy to verify that @xmath487 is a valid bound .",
    "we should note that our first assumption is rather strong and for instance does not allow us to assess the security of popular implementations of the bb84 protocol relying on a weak - coherent - state encoding . since single - photon sources remain expensive and imperfect today",
    ", it is indeed tempting to encode each qubit with two polarization modes and replace single - photons by phase - randomized weak - coherent states for @xmath488 , where @xmath489 is the amplitude of the coherent states . ] .",
    "for such an implementation , the four bb84 states become linearly independent , and eq",
    ".   can not hold .",
    "it is well - known that such implementations are sensitive to `` photon - number - splitting '' attacks but that solutions exist to restore their security , for instance with the help of decoy states @xcite . while we believe that our framework could accommodate such modifications ( see for instance  @xcite ) , we do not address this issue here .",
    "[ [ bobs - measurement ] ] bob s measurement : + + + + + + + + + + + + + + + + + +    as for the simple protocol of part [ part : eb ] , we require that bob s quantum system can be decomposed as @xmath490 } = b_1 b_2 \\ldots b_m$ ] .",
    "bob s measurement device is similar to that of the simple protocol of part [ part : eb ] , but the measurement operators now need to be specified for indices in @xmath466 $ ] and allow for an additional outcome , ` @xmath106 ' , corresponding to an inconclusive result .",
    "such an inconclusive result can for instance occur when no detector clicked ( photon loss ) or when more than 1 detector clicked ( dark counts ) .    for any @xmath477 $ ]",
    ", we model bob s measurement on subsystem @xmath160 with setting @xmath157 by a ternary generalized measurement @xmath491 acting on @xmath160 .",
    "the index @xmath374 ranges over the two conclusive outcomes , 0 and 1 , of bob s measurement as well as the inconclusive outcomes @xmath106 .",
    "we require that @xmath492 meaning that the element corresponding to an inconclusive result coincides for both measurements .",
    "as will be formalized in lemma [ lm : sifting2 ] , this implies that bob s measurement map can be interpreted as a two - step process first deciding whether the result is conclusive or not , and then , in the former case , proceeding with the ideal measurement considered in part [ part : eb ] .",
    "while this assumption seems quite reasonable for photon detector working in the few photons regime , it usually fails to apply when avalanche photo diodes are accessed in the linear mode , and this was precisely the origin of the `` blinding attack '' of  @xcite .    in any realistic implementation",
    ", alice and bob would need to be synchronized so that bob can keep track of which system he is currently measuring .",
    "this is especially relevant in high - loss regimes where bob s detectors would not click most of the time .",
    "such a synchronization procedure can realized classically , provided that both players have access to an authenticated channel . for simplicity",
    ", we ignore this synchronization issue in our model .",
    "the protocol @xmath493 is parametrized as @xmath494 , but with one extra parameter :    * the number of individual states prepared and sent through the quantum channel by alice , @xmath495 .",
    "we require that @xmath496 and for optical implementations a typical value for @xmath465 is @xmath497 where @xmath498 is the overall transmittance of the optical channel between alice and bob .      here",
    "we describe in detail the mathematical model corresponding to the protocol in table  [ tb : realistic ] , for the steps where it differs from the simple protocol of part [ part : eb ] .",
    "[ [ input-1 ] ] input : + + + + + +    the realistic protocol @xmath493 we consider is a prepare - and - measure protocol , and the role of the input is now played by an ( arbitrary ) quantum channel @xmath499 between alice and bob .",
    "here @xmath500}$ ] and @xmath501}$ ] .",
    "this situation is depicted in figure [ fig : pm - input ] .    as before",
    ", we make the assumption that the input and output of the quantum channel are finite - dimensional .",
    "this arguably appears quite restrictive since any complete description of the optical channel would involve infinite - dimensional fock spaces , with the idea that each of the @xmath465 systems prepared by alice corresponds to two polarization modes for instance .",
    "however , we point out that we do not require any explicit upper bound on the dimension of the hilbert spaces occurring in the protocol , and that any _ physical _ state necessarily has a bounded energy , which means that it can be arbitrarily well approximated by a quantum state in a finite - dimensional hilbert space of sufficiently large dimension .",
    "( 200 , 60 ) ( 11 , 50)alice ( 70 , 50)public domain ( 170 , 50)bob    ( 32 , 34)(1 , 0)138 ( 32 , 33)(1 , 0)134 ( 32 , 35)(1 , 0)134    ( 15 , 30 ) ( 90 , 38)@xmath502 ( 172 , 30 )    ( 50 , 0 ) ( 0 , 1)60 ( 150 , 0 ) ( 0 , 1)60    [ [ randomization-1 ] ] randomization : + + + + + + + + + + + + + +    the random seeds are modeled similarly as for the idealized version of the protocol . here",
    ", the seed @xmath133 corresponding to identical measurement settings is not provided directly .",
    "instead , alice and bob initially choose independently two strings @xmath503 , and it will later be the role of the sifting procedure to produce a set of identical measurement settings @xmath504 .",
    "the random choice of the strings @xmath505 is modeled by two registers @xmath506 in the state @xmath507 where @xmath508 are orthonormal bases of @xmath470 and @xmath471 , respectively .",
    "another difference with the simple protocol of part [ part : eb ] is that alice also has access to a register @xmath468 that she will use to choose which state to prepare .",
    "this register is modeled similarly as the other seeds as a maximally mixed state : @xmath509 where @xmath510 is an orthonormal basis of @xmath468 .",
    "the other random seeds @xmath511 are identical to the idealized version .",
    "this situation is depicted in figure [ fig : pm - rand ] .",
    "( 200 , 90 ) ( 11 , 75)alice ( 70 , 75)public domain ( 170 , 75)bob    ( 32 , 52)(1 , 0)138 ( 32 , 51)(1 , 0)134 ( 32 , 53)(1 , 0)134    ( 15 , 48 ) ( 90 , 56)@xmath502 ( 172 , 48 )    ( -10 , 23 ) (-8 , 23)@xmath512    ( -35 , 23 ) ( -31 , 23)@xmath468    ( 15 , 48 ) ( 15 , 23 ) ( 19 , 23)@xmath126 ( 172 , 48 ) ( 172 , 23 ) ( 174 , 23)@xmath513    ( 50 , 0 ) ( 0 , 1)85 ( 150 , 0 ) ( 0 , 1)85    note that while in the simple protocol all the seeds are communicated publicly during a step of the protocol , it is crucially not the case here for the seed @xmath468 , from which the final key could be immediately inferred .",
    "we will see that it is not necessary to communicate the seed @xmath470 to bob since the sifting procedure is performed by alice .    in a practical implementation ,",
    "the various random seeds , except for @xmath471 would be initially prepared by alice , and only communicated to bob when needed ( except for @xmath468 and @xmath470 ) .",
    "in particular , one should wait until the state distribution is over before communicating the value of the chosen subset for parameter estimation or of the various hash functions .",
    "[ [ state - preparation ] ] state preparation : + + + + + + + + + + + + + + + + + +    alice prepares a quantum state on n @xmath465 systems @xmath514}$ ] using the map @xmath515 where @xmath516 .",
    "applying this map to the seeds in registers @xmath468 and @xmath470 results in the state @xmath517 this situation is depicted in figure [ fig : pm - prep ] .",
    "( 200 , 90 ) ( 11 , 75)alice ( 70 , 75)public domain ( 170 , 75)bob    ( 32 , 52)(1 , 0)138 ( 32 , 51)(1 , 0)134 ( 32 , 53)(1 , 0)134 ( 15 , 48 ) ( 90 , 56)@xmath502 ( 172 , 48 ) ( -10 , 23 ) (-8 , 23)@xmath512 ( -35 , 48 ) ( -31 , 48)@xmath468 ( -18 , 52)(1 , 0)30 (-8 , 34 ) ( 0 , 1)18 ( -10 , 56)@xmath518 ( 15 , 48 ) ( 19 , 48)@xmath5 ( 15 , 23 ) ( 19 , 23)@xmath126 ( 172 , 48 ) ( 172 , 23 ) ( 174 , 23)@xmath513 ( 50 , 0 ) ( 0 , 1)85 ( 150 , 0 ) ( 0 , 1)85    [ [ state - distribution ] ] state distribution : + + + + + + + + + + + + + + + + + + +    alice sends her register @xmath5 to bob through the quantum channel @xmath519 . the state shared by alice and bob",
    "is given by : @xmath520 where we defined @xmath521 .",
    "this situation is depicted in figure [ fig : pm - dist ] .",
    "( 200 , 90 ) ( 11 , 75)alice ( 70 , 75)public domain ( 170 , 75)bob    ( 32 , 52)(1 , 0)138 ( 32 , 51)(1 , 0)134 ( 32 , 53)(1 , 0)134 ( 15 , 48 ) ( 15,44)(1,1)17 ( 90 , 56)@xmath502 ( 89,54)(1,1)12 ( 172 , 48 ) ( -10 , 23 ) (-8 , 23)@xmath512 ( -10 , 48 ) ( -6 , 48)@xmath468 ( 15 , 48 ) ( 15 , 23 ) ( 19 , 23)@xmath126    ( 172 , 48 ) ( 176 , 48)@xmath8 ( 172 , 23 ) ( 174 , 23)@xmath513 ( 15 , 23 ) ( 19 , 23)@xmath126 ( 50 , 0 ) ( 0 , 1)85 ( 150 , 0 ) ( 0 , 1)85    [ [",
    "measurement-1 ] ] measurement : + + + + + + + + + + + +    ( 200 , 90 ) ( 11 , 75)alice ( 70 , 75)public domain ( 170 , 75)bob ( 15 , 48 ) ( 15,44)(1,1)17 ( -10 , 23 ) (-8 , 23)@xmath512 ( -10 , 48 ) ( -6 , 48)@xmath468 ( 15 , 48 ) ( 15 , 23 ) ( 19 , 23)@xmath126 ( 15 , 23 ) ( 19 , 23)@xmath126 ( 172 , 37 ) ( 176 , 37)@xmath435 ( 172 , 13 ) ( 176 , 13)@xmath469 ( 236 , 27)(-1,0)35 ( 201 , 15)(0,1)24 ( 201 , 15)(-1,0)11 ( 201 , 39)(-1,0)11 ( 236 , 23 ) ( 239 , 23)@xmath8 ( 234 , 18)(1,1)17 ( 207 , 19)meas ( 209 , 48 ) ( 211 , 48)@xmath513 ( 217,45)(0 , -1)18 ( 50 , 0 ) ( 0 , 1)85 ( 150 , 0 ) ( 0 , 1)85    bob measures each of his @xmath465 quantum systems in the basis corresponding to @xmath513 and stores his measurement outcomes , either 0 , 1 , or @xmath106 in the case of inconclusive outcomes , in a classical register @xmath469 taking values in @xmath522 . the measurement map @xmath523 is defined as : @xmath524 where @xmath525 is the subset of @xmath466 $ ] where @xmath526 takes values in @xmath527 , namely @xmath528 \\ : : \\ : u_i \\neq { \\varnothing}\\}.    \\end{aligned}\\ ] ] the state of the total system after bob s measurement is given by @xmath529 and the situation is depicted in figure [ fig : pm - meas ] .    [ [ randomness - distribution ] ] randomness distribution : + + + + + + + + + + + + + + + + + + + + + + + +    ( 320 , 120 ) ( 31 , 110)alice ( 120 , 110)public domain ( 250 , 110)bob ( 45 , 65 ) ( 49 , 65)@xmath435 ( 75 , 65 ) ( 77 , 65)@xmath513 ( 15 , 33 ) ( 19 , 33)@xmath468 ( 45 , 33 ) ( 47 , 33)@xmath512 ( 75 , 33 ) ( 79 , 33)@xmath126 ( 222 , 90 ) ( 224 , 90)@xmath513 ( 244 , 65 ) ( 248 , 65)@xmath435 ( 243 , 60)(1,1)17 ( 222 , 33 ) ( 226 ,",
    "33)@xmath126 ( 244 , 33 ) ( 248 , 33)@xmath469 ( 152,37)(0 , -1)15 ( 92 , 37)(1 , 0)125 ( 128,69)(0 , 1)15 ( 182,69)(0 , 1)15 ( 230,69)(0 , 1)15 ( 117 , 90 ) ( 121 , 90)@xmath530 ( 172 , 90 ) ( 175 , 90)@xmath531 ( 242 , 69)(-1 , 0)150 ( 142 , 10 ) ( 146 , 10)@xmath126 ( 100 , 0 ) ( 0 , 1)120 ( 200 , 0 ) ( 0 , 1)120    bob publicly announces the content of the register @xmath471 together with the description @xmath531 of the set @xmath152 of indices corresponding to conclusive measurement results .",
    "this situation is depicted in figure  [ fig : pm - rand - dist ] .",
    "alice publicly announces the value of the various seeds , @xmath532 .",
    "[ [ sifting ] ] sifting : + + + + + + + +    alice applies the _ sifting map _ , a classical map ` sift ' defined as follows @xmath533 } &   \\to & \\pi_{m , m }   \\times \\ { { \\varnothing } , { \\checkmark}\\ }   \\\\         ( \\phi_{\\ ! a } , \\phi_{\\ !",
    "b } , \\omega ) & \\mapsto & ( \\sigma , f^{\\mathrm{si } } )         \\end{array }         \\right .",
    "\\end{aligned}\\ ] ] where @xmath467 is either the first subset of @xmath435 of cardinality @xmath113 in the lexicographic order where @xmath534 and @xmath535 coincide , if such a set exists , or else it is set to a dummy value , for instance @xmath9 $ ] . in the first case , the flag @xmath473 is set to @xmath107 , otherwise it is set to @xmath106 and the protocol aborts .",
    "the output of the sifting map immediately allows alice and bob to compute the value of the seed @xmath196 which is simply the restriction of either @xmath470 or @xmath471 to the indices in  @xmath467 .",
    "this classical map is lifted to give a cptp map @xmath536 .",
    "this situation is depicted in figure [ fig : pm - sift1 ] .",
    "( 320 , 120 ) ( 31 , 110)alice ( 120 , 110)public domain ( 250 , 110)bob ( 15 , 84 ) ( 19 , 84)@xmath126 ( 45 , 84 ) ( 49 , 84)@xmath435 ( 42 , 79)(1,1)17 ( 75 , 84 ) ( 77 , 84)@xmath513 ( 74 , 79)(1,1)17 ( 15 , 52 ) ( 19 , 52)@xmath468 ( 45 , 52 ) ( 47 , 52)@xmath512 ( 75 , 52 ) ( 79 , 52)@xmath467 ( 62 , 56)(1,0)13 ( 62 , 79)(1,-1)15 ( 82,79)(0 , -1)15 ( 74 , 20 ) ( 76 , 20)@xmath473    ( 118 , 20 ) ( 120 , 20)@xmath473 ( 93,23)(1,0)25",
    "( 82,49)(0,-1)19 ( 222 , 84 ) ( 226 , 84)@xmath469 ( 222 , 52 ) ( 226 , 52)@xmath467 ( 249 , 84 ) ( 253 , 84)@xmath126    ( 145 , 20 ) ( 149 , 20)@xmath126    ( 249 , 52 ) ( 251 , 52)@xmath513    ( 182,56)(0 , -1)25 ( 93 , 56)(1 , 0)128 ( 172 , 20 ) ( 175 , 20)@xmath537 ( 117 , 84 ) ( 121 , 84)@xmath530 ( 172 , 84 ) ( 175 , 84)@xmath538 ( 100 , 0 ) ( 0 , 1)120 ( 200 , 0 ) ( 0 , 1)120    we then define a cptp map @xmath539 that discards the systems in @xmath468 , @xmath469 and @xmath512 which do not correspond to the subset @xmath467 and put the remaining systems in registers denoted @xmath540 , @xmath541 and @xmath504 of size @xmath113 , respectively .",
    "@xmath542 this situation is depicted in figure [ fig : pm - sift2 ] .",
    "( 320 , 120 ) ( 31 , 110)alice ( 120 , 110)public domain ( 250 , 110)bob    ( 18 , 43 ) ( 22 , 43)@xmath126    ( 50 , 43 ) ( 54 , 43)@xmath467 ( 47 , 38)(1,1)17 ( 57,54)(0 , 1)24    ( 74 , 43 ) ( 76 , 43)@xmath473 ( 76 , 38)(1,1)17    ( 18 , 20 ) ( 20 , 20)@xmath512 ( 15 , 15)(1,1)17    ( 35 , 22)(1,0)40 ( 57,22)(0 , 1)17    ( 75 , 20 ) ( 79 , 20)@xmath504    ( 222 , 20 ) ( 226 , 20)@xmath504    ( 75 , 75 ) ( 79 , 75)@xmath468 ( 74 , 70)(1,1)17    ( 18 , 75 ) ( 22 , 75)@xmath540 ( 75 , 78)(-1,0)40    ( 222 , 43 ) ( 226 , 43)@xmath126    ( 222 , 75 ) ( 226 , 75)@xmath469 ( 221 , 70)(1,1)17    ( 254 , 43)@xmath467 ( 250 , 43 ) ( 247 , 38)(1,1)17 ( 282 , 75 ) ( 286 , 75)@xmath541    ( 282 , 20 ) ( 286 , 20)@xmath513 ( 279 ,",
    "15)(1,1)17    ( 238 , 78)(1,0)43 ( 256,54)(0 , 1)24    ( 256,22)(0 , 1)17 ( 281 , 22)(-1,0)43    ( 118 , 43 ) ( 120 , 43)@xmath473    ( 172 , 75 ) ( 174 , 75)@xmath531    ( 146 , 43 ) ( 150 , 43)@xmath126 ( 146 , 75 ) ( 148 , 75)@xmath543 ( 117 , 75 ) ( 121 , 75)@xmath471 ( 100 , 0 ) ( 0 , 1)120 ( 200 , 0 ) ( 0 , 1)120    finally , similarly as in the simple protocol of part [ part : eb ] , alice and bob use the content of register @xmath370 to reorder their raw keys , which become @xmath544 for alice and @xmath545 for bob .",
    "the situation here is similar to that obtained after measurement in the simple protocol ( compare figures [ fig : reorder ] and [ fig : state_meas ] ) , with the addition of the registers @xmath537 , @xmath531 , @xmath471 and @xmath473 now available in the public domain .",
    "( 300 , 60 ) ( 31 , 50)alice ( 120 , 50)public domain ( 240 , 50)bob    ( 35 , 30 ) ( 39 , 30)@xmath126 ( 5 , 5 ) ( 9 , 5)@xmath540 ( 5 , 30 ) ( 9 , 30)@xmath504 ( 43,25.5)(0 , -1)16 ( 4 , 0)(1,1)17 ( 23 , 9)(1 , 0)30 ( 55 , 5 ) ( 59 , 5)@xmath146 ( 75 , 5 ) ( 79 , 5)@xmath40 ( 245 , 30 ) ( 249 , 30)@xmath126 ( 215 , 5 ) ( 219 , 5)@xmath541 ( 253,25.5)(0 , -1)16 ( 214 , 0)(1,1)17 ( 233 , 9)(1 , 0)30 ( 265 , 5 ) ( 268 , 5)@xmath245 ( 285 , 5 ) ( 289 , 5)@xmath68 ( 215 , 30 ) ( 219 , 30)@xmath504 ( 118 , 5 ) ( 120 , 5)@xmath473    ( 172 , 30 ) ( 174 , 30)@xmath531    ( 146 , 5 ) ( 150 , 5)@xmath126 ( 146 , 30 ) ( 148 , 30)@xmath543 ( 117 , 30 ) ( 121 , 30)@xmath471 ( 100 , 0 ) ( 0 , 1)60 ( 200 , 0 ) ( 0 ,",
    "1)60    [ [ remaining - steps ] ] remaining steps : + + + + + + + + + + + + + + + +    the remaining steps are as in the entanglement - based qkd protocol presented in part [ part : eb ] .",
    "in sections  [ sec : ass1 ] and  [ sec : ass2 ] , we discuss some implications of the device assumptions made in section  [ sc : assumpm ] .",
    "the security reduction to the simple protocol will be addressed in section [ sc : pm2 ] .",
    "consider the four states @xmath559 created by alice in round @xmath156 of the protocol for some @xmath477 $ ] .",
    "since these states adhere to the assumptions stated in   and  , the following lemma is applicable :    [ lm : virtual ] let @xmath560 where @xmath44 and @xmath110 are taken from discrete sets .",
    "moreover , let @xmath561 be a probability distribution for each @xmath110 such that @xmath562 then there exists a state @xmath563 where @xmath564 and a generalized measurement @xmath565 on @xmath566 for each @xmath110 such that @xmath567 \\quad \\textrm{and } \\quad      c\\big ( \\big\\ { m_{a'}^{\\phi , x } \\big\\}_x , \\big\\ { m_{a'}^{\\phi',x } \\big\\}_x \\big ) = c'\\big ( \\ { \\rho_a^{\\phi , x } \\}_x , \\ { \\rho_a^{\\phi',x } \\}_{x } \\big )",
    ".   \\label{eq : conditions }    \\end{aligned}\\ ] ]    we will explicitly construct the state and measurement as follows . first , let us introduce @xmath568 and choose @xmath569 as its purification on @xmath566 .",
    "now we choose @xmath570 where the transpose is taken with regards to the schmidt basis of @xmath569 .",
    "let us first verify that this constitutes a generalized measurement .",
    "indeed , for every @xmath110 , we find @xmath571 let us now verify the conditions in  . since @xmath572 purifies @xmath573 , we find @xmath574 where @xmath575 purifies @xmath576 .",
    "the first equality readily follows .",
    "the second equality can be confirmed by consulting the definitions of @xmath577 and @xmath578 in   and  , respectively .",
    "these assumptions on alice s preparation allow us to replace the state preparation by a measurement performed on a virtual extension of the average prepared state .",
    "[ cor : virtual ] if the two assumptions in   and   on alice s preparation device hold , then for each @xmath477 $ ] there exists a state @xmath579 where @xmath580 and generalized measurements on @xmath581 of the form prescribed in section  [ sec : assumpt ] such that @xmath582 , and , in particular , @xmath583 . combining all these measurements into a map @xmath584 acting on @xmath585}'$ ]",
    ", we further have @xmath586      the objective of the assumption made on bob s measurement is to show that when the sifting procedure succeeds , the resulting register @xmath133 is independent of the state shared by alice and bob , similarly as in the entanglement - based protocol of part [ part : eb ] .",
    "[ lm : sifting2 ] if bob s measurement satisfies , that is , @xmath587 for all @xmath477 $ ] , then the measurement map @xmath588 can be decomposed as @xmath589    define for each @xmath477 $ ] operators @xmath590 and @xmath591 satisfying @xmath592 note in particular that @xmath593 .",
    "the generalized measurement @xmath594 is then described by @xmath595 with @xmath596 . up to relabeling",
    ", the string @xmath577 contained in register @xmath435 describes the subset @xmath152 describing the indices for which the measurement was conclusive .",
    "indeed @xmath597 \\ : : \\ : c_i \\ne { \\varnothing}\\ } = \\{i \\in [ m ] \\ : : \\ : c_i = { \\checkmark}\\}$ ]",
    ". it will be convenient in the following to write @xmath598 instead of @xmath599 , and put the value @xmath600 in register @xmath435 .",
    "let us now define the second measurement , @xmath601 , characterized by operators @xmath602 for each @xmath477 $ ] .",
    "in the case where the register @xmath603 is set to @xmath106 ( or equivalently that the set @xmath152 does not contain index @xmath156 ) , we choose @xmath604 which means that the measurement is essentially trivial and simply reveals the content of register @xmath603 . to address the case where the register is set to @xmath107 , indicating that a conclusive outcome should be obtained , we choose operators @xmath605 and @xmath606 given by @xmath607 it is immediate to check that these define valid generalized measurements and that eq .",
    "is satisfied .",
    "[ lm : sifting ] if the assumption of eq",
    ".   on bob s measurement holds , then for any state @xmath608 , define @xmath609 then , the state conditioned on the sifting procedure passing satisfies : @xmath610 where @xmath611 .",
    "since the measurement map @xmath612 only acts on register @xmath8 , independently of the value @xmath513 , we have @xmath613 where the state @xmath614 is a classical - quantum state : @xmath615 } } { \\left|\\omega\\middle\\rangle\\!\\middle\\langle \\omega\\right|}_\\omega \\otimes   ( { \\mathrm{id}}_{a ' } \\otimes m_b^\\omega \\otimes { \\mathrm{id}}_e)\\rho_{a'be } ( { \\mathrm{id}}_{a ' } \\otimes ( m_b^\\omega)^{\\dagger } \\otimes { \\mathrm{id}}_e).\\end{aligned}\\ ] ] it is straightforward to check that the classical map ` sift ' has the following property : for all strings @xmath616 and any subset @xmath617 $ ] , if the sifting succeeds , then @xmath618 indeed , this is true since the map ` sift ' only examines whether alice and bob s measurement bases coincide or not , and not their actual value . in particular ,",
    "if @xmath512 and @xmath513 are uniformly distributed , then @xmath504 , the restriction of @xmath512 to the subset @xmath467 returned by the sifting map when it succeeds , will also be uniformly distributed over the set of strings of length @xmath113 .    finally , the map @xmath539 examines register @xmath470 and puts its content , restricted to the subset determined by the sifting map , into register @xmath196 , and traces over all the systems that do not belong to that subset .",
    "the above property of the sifting map ensures that the value of @xmath504 does not depend on @xmath435 .",
    "this establishes that whenever the sifting test passes , the output state takes a tensor product form : @xmath619 .",
    "this lemma shows in particular that it is legitimate to consider @xmath133 as a uniform seed , and not as a transcript , hence its notation @xmath133 instead of @xmath620 .",
    "we are now ready to prove theorem  [ thm : real ] .",
    "it is sufficient to consider the case where the sifting procedure succeeds , since otherwise the protocol aborts and its output is trivially secret .",
    "for this reason , let us define a slight variant @xmath621 of the entanglement - based protocol of part [ part : eb ] which differs by taking an additional input register @xmath622 .",
    "the variant starts by examining the content of this registers , and either aborts if the flag is set to @xmath106 , or proceeds with the protocol @xmath494 if the flag is set to @xmath107 .",
    "a second difference between @xmath494 and @xmath621 is that the randomness for the measurement basis choice is explicitly given as an input . in particular , for any state @xmath608 , it holds that : @xmath623 from it definition , it is immediate that if @xmath494 is @xmath22-secure , then so is @xmath621 .",
    "indeed , the only quantitative difference between the two protocol is that the latter one is less robust since it will not output nontrivial keys as soon as the sifting flag is set to @xmath106 .",
    "our goal is therefore to show that in that case , for any input channel @xmath624 , there exists a state @xmath625 where @xmath626 and @xmath627 consist of @xmath113 systems such that @xmath628 let us therefore consider the application of the prepare - and - measure protocol @xmath493 to an arbitrary quantum channel @xmath549 . according to the description of the protocol , the classical - quantum state shared by alice , bob and eve after the distribution step is given by some @xmath629 .",
    "the assumption made on alice s preparation shows , as stated in corollary [ cor : virtual ] , show that there exist a state @xmath569 and a measurement map @xmath584 such that @xmath630 where we defined @xmath631 .",
    "the last equality follows from the fact that the maps @xmath549 and @xmath584 trivially commute since they act on distinct systems . after applying the measurement map @xmath632 promised by lemma [ lm : sifting2 ] , followed by the sifting and maps ,",
    "we obtain @xmath633 where @xmath540 and @xmath627 are now restricted to the @xmath113 indices corresponding to the set @xmath467 provided by the sifting map .",
    "indeed , recall that the map @xmath634 replaces the @xmath465-system registers @xmath468 and @xmath8 by @xmath113-system registers @xmath540 and @xmath627 obtained by tracing over the systems not corresponding to @xmath467 .",
    "since the measurement map @xmath584 of alice s system @xmath566 commutes with @xmath635 , we obtain : @xmath636    in the mathematical description of the protocol given in section [ sub : mod ] , the map was applied to registers @xmath637 , but since it commutes with measurement maps on either alice s or bob s system , the map can be just as well applied to registers @xmath566 and @xmath469 , with outputs denoted @xmath626 and @xmath541 , respectively .",
    "we deduce that we can replace the map @xmath638 by @xmath639 in .",
    "this yields : @xmath640 lemma [ lm : sifting ] now shows that @xmath641    let us finally collect @xmath642 . if the sifting test passes , then @xmath643 which concludes the proof .",
    "we provide a self - contained security proof of qkd detailing all the steps of the protocol and explicitly spelling out all the required assumptions for the security proof to go through . for simplicity , we focussed on a variant of the entanglement - based bbm92 protocol as well as the bb84 protocol and showed that practical secret key rates can be achieved , even for moderately large block size .",
    "these results , however , come at the price of several assumptions which are sometimes challenging to enforce in practice .",
    "this should not come as a surprise since many simplified implementations are known to be vulnerable to quantum hacking , illustrating that there exist necessary trade - offs between ease of implementation and security guarantees .",
    "we believe that there is room for improvement for these trade - offs and that further collaboration between theory and experiment will be essential for achieving this objective . in this context , it is crucial to model the protocols as thoroughly as possible in order to understand what level of security can be obtained , and under which assumptions .    [",
    "[ acknowledgements . ] ] acknowledgements .",
    "+ + + + + + + + + + + + + + + + +    we thank philippe grangier , christopher portmann and charles lim ci wen for helpful comments .",
    "mt is funded by an arc discovery early career researcher award ( decra ) fellowship and acknowledges support from the arc centre of excellence for engineered quantum systems ( equs ) .",
    "46 [ 1]#1 [ 1]`#1 ` urlstyle [ 1]doi : # 1    c.h .",
    "bennett and g.  brassard . .",
    "in _ proc .",
    "ieee international conference on computers , systems and signal processing 1984 _ , volume  1 , pages 175179 , bangalore , 1984 .",
    ".  ekert . .",
    "_ physical review letters _ , 670 ( 6):0 661663 , 1991 .",
    "doi : 10.1103/physrevlett.67.661 .    c.  bennett , g.  brassard , and n.  mermin . .",
    "_ physical review letters _ , 680 ( 5):0 557559 , 1992 .",
    "doi : 10.1103/physrevlett.68.557 .",
    "lo and h.f .",
    "_ science _ , 2830 ( 5410):0 20502056 , 1999 .",
    "doi : 10.1126/science.283.5410.2050 .",
    "shor and j.  preskill . .",
    "_ physical review letters _ , 850 ( 2):0 441444 , 2000 .",
    "doi : 10.1103/physrevlett.85.441 .",
    "d.  mayers . .",
    "_ journal of the acm _ , 480 ( 3):0 351406 , 2001 .",
    "doi : 10.1145/382780.382781 .",
    "m.  koashi . .",
    "_ journal of physics : conference series _ , 360 ( 1):0 98102 , 2006 .",
    "doi : 10.1088/1742 - 6596/36/1/016 .",
    "h.  maassen and j.  uffink . .",
    "_ physical review letters _",
    ", 600 ( 12):0 11031106 , 1988 .",
    "doi : 10.1103/physrevlett.60.1103 .",
    "w.  heisenberg . .",
    "_ zeitschrift fr physik _",
    ", 430 ( 3 - 4):0 172198 , mar 1927 .",
    "r.  renner .",
    "_ security of quantum key distribution_. phd thesis , eth zurich , 2005 .",
    "url http://arxiv.org/abs/quant-ph/0512258 .",
    "comandar , m.  lucamarini , b.  frhlich , j.f .",
    "dynes , a.w .",
    "sharpe , s.w .- b",
    ".  tam , z.l .",
    "yuan , r.v .",
    "penty , and a.j .  shields . .",
    "_ nature photonics _ , 100 ( 5):0 312315 , 2016 .",
    "doi : 10.1038/nphoton.2016.50 .",
    "p.  jouguet , s.  kunz - jacques , a.  leverrier , p.  grangier , and e.  diamanti . .",
    "_ nature photonics _ , 70 ( 5):0 378381 , 2013 .",
    "doi : 10.1038/nphoton.2013.63 .",
    "m.  tomamichel , c.c.w .",
    "lim , n.  gisin , and r.  renner . .",
    "_ nature communications _ , 3:0 634 , 2012 .",
    "doi : 10.1038/ncomms1631 .",
    "m.  hayashi and t.  tsurumaru . .",
    "_ new journal of physics _ , 140 ( 9):0 093014 , 2012 .",
    "doi : 10.1088/1367 - 2630/14/9/093014 .",
    "v.  scarani and r.  renner . .",
    "_ physical review letters _ , 1000 ( 20 ) , 2008 .",
    "doi : 10.1103/physrevlett.100.200501 .",
    "r.  renner . .",
    "_ nature physics _ , 30 ( 9):0 645649 , 2007 .",
    "doi : 10.1038/nphys684 .",
    "m.  christandl , r.  knig , and r.  renner . .",
    "_ physical review letters _ , 1020 ( 2 ) , 2009 .",
    "doi : 10.1103/physrevlett.102.020504 .",
    "l.  sheridan , t.p .",
    "le , and v.  scarani . .",
    "_ new journal of physics _ , 12:0 123019 , 2010 .    c.  pfister , n.  ltkenhaus , s.  wehner , and p.j .",
    "_ new journal of physics _ , 180 ( 5):0 053001 , 2016 .",
    "doi : 10.1088/1367 - 2630/18/5/053001 .",
    "m.  tomamichel , s.  fehr , j.  kaniewski , and s.  wehner . .",
    "_ new journal of physics _ , 150 ( 10):0 103002 , 2013 .",
    "doi : 10.1088/1367 - 2630/15/10/103002 .",
    "m.  tomamichel and r.  renner . .",
    "_ physical review letters _ ,",
    "1060 ( 11):0 110506 , 2011 .",
    "doi : 10.1103/physrevlett.106.110506 .",
    "f.  dupuis , o.  fawzi , and r.  renner . , 2016 .",
    "url http://arxiv.org/abs/1607.01796 .",
    "r.  arnon - friedman , r.  renner , and t.  vidick .",
    "url http://arxiv.org/abs/1607.01797 .",
    "m.  tomamichel .",
    "_ quantum information processing with finite resources  mathematical foundations _ , volume  5 of _ springerbriefs in mathematical physics_. springer international publishing , 2016 .",
    "isbn 978 - 3 - 319 - 21890 - 8 .",
    "doi : 10.1007/978 - 3 - 319 - 21891 - 5 .",
    "_ quantum detection and estimation theory_. academic press , new york , ny , 1976 .",
    "m.  tomamichel , r.  colbeck , and r.  renner . .",
    "_ ieee transactions on information theory _ , 560 ( 9):0 46744681 , 2010 .",
    "doi : 10.1109/tit.2010.2054130 .",
    "carter and m.n .",
    "_ journal of computer and system sciences _ , 180 ( 2):0 143154 , 1979 .",
    "doi : 10.1016/0022 - 0000(79)90044 - 8 .",
    "wegman and j.l .",
    "_ journal of computer and system sciences _ , 220 ( 3):0 265279 , 1981 .",
    "doi : 10.1016/0022 - 0000(81)90033 - 7 .",
    "a.  rnyi . .",
    "in _ proc .",
    "4th berkeley symposium on mathematical statistics and probability _ , volume  1 , pages 547561 , berkeley , california , usa , 1961 .",
    "university of california press .",
    "r.  knig , r.  renner , and c.  schaffner . .",
    "_ ieee transactions on information theory _ , 550 ( 9):0 43374347 , 2009 .",
    "doi : 10.1109/tit.2009.2025545 .",
    "s.  winkler , m.  tomamichel , s.  hengl , and r.  renner . .",
    "_ physical review letters _ , 1070 ( 9):0 090502 , 2011 .",
    "issn 0031 - 9007 .",
    "doi : 10.1103/physrevlett.107.090502 .",
    "lo , h.f .",
    "chau , and m.  ardehali .",
    "efficient quantum key distribution scheme and a proof of its unconditional security .",
    "_ journal of cryptology _",
    ", 18(2):133165 , 2004 doi : 10.1007/s00145 - 004 - 0142-y    d.  frauchiger , r.  renner , and m.  troyer . , 2013 .",
    "url http://arxiv.org/abs/1311.4547 .    c.  portmann and r.  renner . , 2014 .",
    "url http://arxiv.org/abs/1409.3525 .",
    "l.  lydersen , c.  wiechers , c.  wittmann , d.  elser , j.  skaar , and v.  makarov . .",
    "_ nature photonics _ , 40 ( 10):0 686689 , 2010 .",
    "doi : 10.1038/nphoton.2010.214 .",
    "m.  tomamichel and esther hnggi . .",
    "_ journal of physics a : mathematical and theoretical _ , 460 ( 5):0 055301 , 2013 .",
    "doi : 10.1088/1751 - 8113/46/5/055301 .",
    "lim , c.  portmann , m.  tomamichel , r.  renner , and nicolas gisin . .",
    "_ physical review x _ , 30 ( 3):0 031006 , 2013 .",
    "doi : 10.1103/physrevx.3.031006 .",
    "i.  devetak and a.  winter . .",
    "_ proceedings of the royal society a _ , 4610 ( 2053):0 207235 , 2005 .",
    "doi : 10.1098/rspa.2004.1372 .",
    "d.  elkouss , a.  leverrier , r.  alleaume , and j.j .",
    "boutros . .",
    "in _ proc .",
    "ieee isit 2009 _ , pages 18791883 , 2009 .",
    "doi : 10.1109/isit.2009.5205475 .",
    "m.  tomamichel , j.  martinez - mateo , c.  pacher , and d.  elkouss . , 2014 .",
    "url http://arxiv.org/abs/1401.5194 .",
    "m.  tomamichel .",
    "_ a framework for non - asymptotic quantum information theory_. phd thesis , eth zurich , 2012 .",
    "url http://arxiv.org/abs/1203.2142 .",
    "serfling . .",
    "_ annals of statistics _ , 20",
    "( 1):0 3948 , 1974 .    j.h .",
    "_ introduction to coding theory_. graduate texts in mathematics .",
    "springer , third edition , 1999 .",
    "lo , x.  ma , and k.  chen . .",
    "_ physical review letters _ , 940 ( 23 ) , 2005",
    "doi : 10.1103/physrevlett.94.230504 .",
    "j.  hasegawa , m.  hayashi , t.  hiroshima , and a.  tomita .",
    "url http://arxiv.org/abs/0707.3541 .",
    "lim , m.  curty , n.  walenta , f.  xu , and h.  zbinden . .",
    "_ physical review a _ , 890 ( 2):0 022307 , 2014 .",
    "doi : 10.1103/physreva.89.022307 .",
    "r.  bhatia .",
    "_ matrix analysis_. graduate texts in mathematics .",
    "springer , 1997 .",
    "isbn 0 - 387 - 94846 - 5 .",
    "let us restate the desired inequality for the convenience of the reader .",
    "let @xmath332 be an arbitrary state with @xmath18 a classical register , and set @xmath333 .",
    "furthermore , let @xmath334 and let @xmath335 be a bijective function on @xmath18 that is a symmetry of @xmath336 in the sense that @xmath337 for all @xmath338 .",
    "then , we have @xmath644 where @xmath340 . here , @xmath341 for the map @xmath342 & =   \\operatorname{tr}_a \\bigg\\ { \\sum_{p \\in p } \\sum_{x \\in x }       { \\left|x\\right\\rangle}_{x }         \\big ( { \\left|p\\middle\\rangle\\!\\middle\\langle p\\right|}_{p } \\otimes f_{a}^{p , x } \\big)\\ \\cdot\\ \\big ( { \\left|p\\middle\\rangle\\!\\middle\\langle p\\right|}_{p } \\otimes f_{a}^{p , x } \\big)^{\\dagger } { \\left\\langle x\\right|}_{x } \\bigg\\ } \\ , .",
    "\\label{eq : urth2 }    \\end{aligned}\\ ] ] and any set ( indexed by @xmath338 ) of generalized measurements @xmath343 .",
    "the condition on @xmath22 ensures that all smooth entropies are well - defined .",
    "we first introduce the stinespring dilation isometry of the measurement map  @xmath645 .",
    "this is the isometry @xmath646 given by @xmath647 now note that the measured state @xmath648 in   has a natural purification in @xmath649_{\\tau}}\\ , { \\left|p\\right\\rangle}_p \\otimes { \\left|p\\right\\rangle}_{p ' } \\otimes { \\left|\\tau_{arsd|p = p}\\right\\rangle } ,       \\label{eq : v02 }    \\end{aligned}\\ ] ] where @xmath650 is isomorphic to @xmath18 and @xmath651 is any purification of @xmath652 on a sufficiently large auxiliary system @xmath653 .",
    "( the choice @xmath654 ensures that all purifications can be accommodated . )",
    "this now allows us to rephrase our target inequality . using the duality relation for smooth min- and max - entropy in   together with the fact that @xmath655 since @xmath650 is a copy of @xmath18 , we find that   is equivalent to @xmath656 moreover , the data - processing inequality for the smooth min - entropy in   applied for the map @xmath657 yields @xmath658 and thus it in fact suffices to show that is that , without loss of generality , we may assume that the eavesdropper already holds a purification of the state shared by the honest parties and @xmath653 is thus trivial .",
    "luckily this physical intuition is corroborated by a mathematical argument  the data - processing inequality .",
    "] @xmath659 the remainder of the proof will be concerned with showing the inequality in  .    for this purpose ,",
    "let us consider the following unitary rotation : @xmath660 that exchanges @xmath661 with its conjugate , @xmath662 .",
    "it clearly acts as a permutation when acting on the classical register @xmath18 and furthermore we have @xmath663    due to the symmetry condition that we imposed on @xmath335 and @xmath664 in the statement of the proposition .",
    "based on this we define the isometry @xmath665 that corresponds to a measurement in the basis determined by @xmath662 instead of @xmath661 .",
    "we find @xmath666 which shows that the trace non - increasing map @xmath667 coherently undoes the measurement in the basis determined by @xmath661 and then instead measures in the basis determined by @xmath662 .",
    "now we have the tools at hand to prove the inequality in  . by the definition of the smooth min - entropy , @xmath668",
    ", there exists a state @xmath669 and a state @xmath670 that is @xmath22-close to @xmath671 in the sense that @xmath672 such that the following inequality holds : @xmath673 next we consider the cp trace non - increasing map @xmath674 = \\sum_{p \\in p } \\operatorname{tr}_{ax ' } \\big ( q_{p}^{\\dag } \\bar{v } { v}^{\\dag } { \\left|p\\middle\\rangle\\!\\middle\\langle p\\right|}_{p } \\,\\cdot\\ , { \\left|p\\middle\\rangle\\!\\middle\\langle p\\right|}_{p } v \\bar{v}^{\\dag } q_{p } \\big )",
    ".    \\end{aligned}\\ ] ] from   we learn that @xmath675 = \\sigma_{pxr}$ ] .",
    "thus , using the fact that the purified distance contracts   when we apply @xmath29 , we find that the state @xmath676 $ ] satisfies @xmath677 furthermore , applying @xmath29 on both sides of   yields @xmath678 = 2^{-\\lambda } \\operatorname{tr}_{x'a } \\big ( q_{p}^{\\dag } \\bar{v } { v}^{\\dag } \\big ( { \\mathrm{id}}_x \\otimes \\hat{\\omega}_{pax'r } \\big ) v \\bar{v}^{\\dag } q_{p } \\big ) , \\label{eq : op - ineq1 }    \\end{aligned}\\ ] ] where @xmath679 with @xmath680 .",
    "let us now simplify the right - hand side of this inequality , hoping to capture the incompatibility of the measurements in the basis @xmath661 versus the basis @xmath662 .",
    "first , we note that @xmath681 and , hence , we can write @xmath682 to establish   and   we used the fact that @xmath683 for every linear operator @xmath684 by definition of the operator norm .",
    "the final equality   follows from the definition of @xmath685 .    combining this bound with   yields @xmath686 since @xmath687 by construction and @xmath688 due to",
    ", the definition of the smooth entropy implies that @xmath689 concluding the proof .",
    "our proof of the leftover hashing lemma is based on the following result due to renner  ( * ? ? ?",
    "* corollary  5.5.2 ) :    [ lm : leftover ] let @xmath415 be a classical on @xmath40 and let @xmath416 be a universal@xmath73 family of hash functions from @xmath417 to @xmath418",
    ". moreover , let @xmath419 be fully mixed .",
    "then , @xmath690 where @xmath421 is the fully mixed state and @xmath422 for the function @xmath423 that acts on the registers @xmath40 and @xmath424 .",
    "first , by definition of the min - entropy , there exists a state @xmath691 such that @xmath692 .",
    "next , note that by definition of the trace distance , we have @xmath693 where @xmath694 denotes the schatten 1-norm .",
    "moreover , by construction of @xmath695 it is evident that @xmath696 for all @xmath697 .",
    "due to hlder s inequality for schatten norms  ( * ? ? ? * corollary  iv.2.6 ) , we have @xmath698 where @xmath699 is inverted on its support .",
    "we took advantage of the fact that @xmath421 is proportional to the identity to simplify the above expression . combining this with",
    ", jensen s inequality thus ensures that @xmath700    next , observe that @xmath701 by construction .",
    "we then use the universal@xmath73 property of @xmath416 which implies that @xmath702 when @xmath703 . this yields @xmath704 bounding @xmath705 and plugging this into  , we find @xmath706 finally , due to the operator anti - monotonicity of the inverse and the definition of @xmath699 , we have @xmath707 . combined with   this yields the desired result .",
    "let @xmath415 be a classical on @xmath40 and let @xmath416 be a universal@xmath73 family of hash functions from @xmath417 to @xmath418 .",
    "moreover , let @xmath419 be fully mixed .",
    "then , @xmath708 where @xmath709 and @xmath695 are define as in lemma  [ lm : leftover ] .",
    "let @xmath710 be a state such that @xmath711 and @xmath712 .",
    "without loss of generality we can assume that @xmath713 is classical on @xmath40 .",
    "now , the lemma  [ lm : leftover ] yields the inequality @xmath714 where we constructed @xmath715 and bounded @xmath716 to arrive at the second inequality . using the monotonicity of the purified distance under cptp maps",
    "we conclude that @xmath717 . finally , exploiting the triangle inequality for the trace norm we find @xmath718"
  ],
  "abstract_text": [
    "<S> in this work we present a security analysis for quantum key distribution , establishing a rigorous tradeoff between various protocol and security parameters for a class of entanglement - based and prepare - and - measure protocols . </S>",
    "<S> the goal of this paper is twofold : 1 ) to review and clarify the state - of - the - art security analysis based on entropic uncertainty relations , and 2 ) to provide an accessible resource for researchers interested in a security analysis of quantum cryptographic protocols that takes into account finite resource effects . for this purpose </S>",
    "<S> we collect and clarify several arguments spread in the literature on the subject with the goal of making this treatment largely self - contained .    more precisely , we focus on a class of prepare - and - measure protocols based on the bennett - brassard ( bb84 ) protocol as well as a class of entanglement - based protocols similar to the bennett - brassard - mermin ( bbm92 ) protocol . </S>",
    "<S> we carefully formalize the different steps in these protocols , including randomization , measurement , parameter estimation , error correction and privacy amplification , allowing us to be mathematically precise throughout the security analysis . </S>",
    "<S> we start from an operational definition of what it means for a quantum key distribution protocol to be secure and derive simple conditions that serve as sufficient condition for secrecy and correctness . </S>",
    "<S> we then derive and eventually discuss tradeoff relations between the block length of the classical computation , the noise tolerance , the secret key length and the security parameters for our protocols . </S>",
    "<S> our results significantly improve upon previously reported tradeoffs . </S>"
  ]
}