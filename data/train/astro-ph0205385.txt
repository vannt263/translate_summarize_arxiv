{
  "article_text": [
    "the technique of interferometry has been widely used in radio astronomy to image the sky using arrays of antennas . by correlating the complex voltage signals between pairs of antennas ,",
    "the field - of - view of a single element can be sub - divided into `` synthesized beams '' of higher angular resolution . in the small - angle approximation ,",
    "the interferometer forms the fourier transform of the sky convolved with the autocorrelation of the aperture voltage patterns .",
    "in standard radio interferometric data analysis , as described for example in the text by @xcite and the proceedings of the nrao synthesis imaging school @xcite , the correlations or visibilities are inverse fourier transformed back to the image plane . however , there are applications such as estimation of the angular power spectrum of fluctuations in the cosmic microwave background ( cmb ) where it is the distribution of and correlation between visibilities in the aperture or @xmath0-plane that is of most interest .    in standard cosmological models ,",
    "the cmb is assumed to be a statistically homogeneous gaussian random field @xcite . in this case , the spherical harmonics of the field are independent and the statistical properties are determined by the power spectrum @xmath1 where @xmath2 labels the component of the legendre polynomial expansion ( and is roughly in inverse radians ) .",
    "@xcite showed that in cold dark matter inspired cosmological models , there would be features in the cmb power spectrum that reflected critical properties of the cosmology .",
    "recent detections of the first few of these `` acoustic peaks '' at @xmath3 in the power spectrum @xcite have supported the standard inflationary cosmological model with @xmath4 .",
    "measurement of the higher-@xmath2 peaks and troughs , as well as the damping tail due to the finite thickness of the last scattering surface , is the next observational step .",
    "interferometers are well - suited to the challenge of mapping out features in the cmb power spectrum , with a given antenna pair probing a characteristic @xmath2 proportional to the baseline length in units of the observing wavelength ( a @xmath5 projected baseline corresponds to @xmath6 , see  [ sec : basic ] ) .",
    "there are many papers in the literature on the analysis of cmb anisotropy measurements , estimation of power spectra , and the use of interferometry for cmb studies .",
    "general issues for analysis of cmb datasets are discussed in @xcite .",
    "@xcite present a bayesian method for the analysis of cmb interferometer data , using the 3-element cosmic anisotropy telescope data as a test case .",
    "a description of analysis techniques for interferometric observations from the degree angular scale interferometer ( dasi ) were presented in @xcite , while @xcite report on the power spectrum results from first - season of dasi observations .",
    "@xcite discusses cmb interferometry with application to the proposed amiba instrument .",
    "@xcite have recently presented an approach similar to ours , and demonstrate their technique on simulated very small array ( vsa ) data ; a brief comparison of their algorithm with ours is given in appendix  [ app : hobson ] .    in this paper",
    ", we describe a fast gridded method for the @xmath0-plane analysis of large interferometric data sets .",
    "the basis of this approach is to grid the visibilities and perform maximum likelihood estimation of the power spectrum on this compressed data .",
    "our use of gridded estimators is significantly different from what has been done previously .",
    "in addition to power spectrum extraction , this procedure has the ability to form optimally filtered images from the gridded estimators , and may be of use in interferometric observations of radio sources in general .",
    "we have applied our method to the analysis of data from the cosmic background imager ( cbi ) .",
    "the cbi is a planar interferometer array of 13 individual 90-cm cassegrain antennas on a 6-m pointable platform @xcite .",
    "it covers the frequency range 2636  ghz in 10 contiguous 1  ghz channels , with a thermal noise level of @xmath7k in 6 hours , and a maximum resolution of @xmath8 limited by the longest baselines .",
    "the cbi baselines probe @xmath2 in the range 5003900 .",
    "the 90-cm antenna diameters were chosen to maximize sensitivity , but their primary beamwidth of @xmath9 ( fwhm ) at 31  ghz limits the instantaneous field of view , which in turn limits the resolution in @xmath2 .",
    "this loss of aperture plane resolution can be overcome by making mosaic observations , i.e.  observations in which a number of adjacent pointings are combined @xcite . in the cbi observations , mosaicing a field several times larger than the primary beam has resulted in an increase in resolution in @xmath2 by more than a factor of 3 , sufficient to discern features in the power spectrum .",
    "the first cbi results were presented in @xcite , hereafter paper  i , using earlier versions of the software that did not make use of @xmath0-plane gridding , and were far too slow to be used on larger mosaiced data sets .",
    "it was therefore essential to develop a more efficient analysis method that would be fast enough to carry out extensive tests on the cbi mosaic data .",
    "the software package described below has been used to process the first year of cbi data . in the companion papers (",
    "* hereafter paper  ii ) and ( * ? ? ?",
    "* hereafter paper  iii ) , the results from passing cbi deep - field data and mosaic data respectively through the pipeline are presented .",
    "this paper is paper  iv in the series . the output from this pipeline is then used to derive constraints on cosmology ( * ? ?",
    "* hereafter paper  v ) .",
    "finally , analysis of the excess of power at high-@xmath2 seen in results shown in paper  ii in the context of the sunyaev - zeldovich effect is carried out , again using the method presented here , in ( * ? ? ?",
    "* hereafter paper  vi ) .    an introduction to the properties of the cmb power spectrum ,",
    "the response of an interferometer to the incoming radiation , and the computation of the primary beam are given in sections ",
    "[ sec : pscmb ] ,  [ sec : basic ] , and ",
    "[ sec : gauss ] respectively .",
    "the gridding process is presented in  [ sec : gridmethod ] , followed by a description of the likelihood function and construction of the various covariance matrices in  [ sec : liklhd ] .",
    "details on the maximum likelihood solution and the calculation of window functions and component bandpowers is given in ",
    "[ sec : relax ] , while  [ sec : image ] presents our method for making optimally filtered images from the gridded estimators .",
    "finally , a description of the cbi implementation of this method and the performance of the pipeline , including demonstrations using simulated cbi datasets , is given in ",
    "[ sec : estliklhd ] , followed by a summary and conclusions in  [ sec : conclude ] .",
    "at small angles , the curvature of the sky is negligible and we can approximate the spherical harmonic transform of the the temperature field @xmath10 in direction @xmath11 as its fourier transform @xmath12 @xcite , where @xmath13 is the conjugate variable to @xmath11 .",
    "we adopt the fourier convention @xmath14 of @xcite , @xcite , and @xcite . in terms of the multipoles @xmath2 , @xmath15 which we simplify to @xmath16 for the @xmath17 of interest in this paper . for the low levels",
    "anisotropy seen in the cmb on these scales , it is convenient to give @xmath18 in units of @xmath19k and thus @xmath1 will be in units of @xmath20 .    because the cmb is assumed to be a statistically homogeneous gaussian random field , the components of its fourier transform are independent",
    "gaussian deviates .",
    "@xmath21 where @xmath22 . because @xmath10 is real",
    ", its transform must be hermitian , with @xmath23 , and therefore @xmath24 note that it is common to write the cmb power spectrum @xmath1 in a form @xmath25 @xcite .",
    "constant @xmath26 corresponds to equal power in equal intervals of @xmath27 .",
    "although the power spectrum @xmath1 is defined in units of brightness temperature , the interferometer measurements carry the units of flux density @xmath28 ( janskys , 1  jy = @xmath29 w m@xmath30 hz@xmath31 ) . in particular , the intensity field on the sky @xmath32 has units of specific intensity ( w m@xmath30 hz@xmath31 sr@xmath31 or jy / sr ) , and thus to convert between @xmath33 and @xmath18 we use @xmath34 with the planck factor @xmath35 where @xmath36 corrects for the blackbody spectrum .",
    "note that we have treated the temperature @xmath18 as small fluctuations about the mean cmb temperature @xmath37  k @xcite , and thus the @xmath36 appropriate to @xmath38 is used with @xmath39 at @xmath40  ghz .",
    "we are not restricted to modeling the cmb .",
    "for example , we might wish to determine the power spectrum of fluctuations in a diffuse galactic component such as synchrotron emission or thermal dust emission . in this case",
    ", one might wish to express @xmath41 in jy / sr , but take out a power - law spectral shape @xmath42 where @xmath43 is the spectral index , and @xmath44 is the conversion factor that normalizes to the intensity @xmath45 at the fiducial frequency @xmath46 .",
    "note that this normalization is particularly useful for fitting out centimeter - wave foreground emission , which tends to have a power - law spectral index in the range @xmath47 that is significantly different from that for the thermal cmb ( @xmath48 ) .",
    "in addition , foregrounds will also tend to have a power spectrum shape different from that of cmb , which must be included in the analysis ( see  [ sec : foreground ] below ) .",
    "a visibility @xmath49 formed from the correlation of an interferometer baseline between two antennas with projected separation ( in the plane perpendicular to the source direction ) @xmath50 meters observed at wavelength @xmath51 meters measures ( in the absence of noise ) the fourier transform of the sky intensity modulated by the response of the antennas @xcite @xmath52 where @xmath53 is the primary beam , and @xmath54 is the conjugate variable to @xmath11 . for angular coordinates",
    "@xmath11 in radians , @xmath13 has the dimensions of the baseline or aperture in units of the wavelength .",
    "the fourier domain is also referred to as the _ uv_-plane or aperture plane in interferometry for this reason .",
    "we define the direction cosines @xmath55 between the point at right ascension and declination @xmath56 and the center of the mosaic @xmath57 . for the cbi , data are taken keeping the phase center fixed on the pointing center @xmath58 by shifting the phase with the beam and rotating the platform to maintain constant parallactic angle during a scan , so that the response to a point source at the center of the field @xmath59 is constant , and thus @xmath60 in equation ( [ eq : point1 ] ) , where @xmath61 is the normalized primary beam response at the observing frequency of visibility @xmath62",
    ". then , by application of the fourier shift theorem , it is easy to show that @xmath63 where @xmath64 is the fourier transform of the primary beam @xmath65 , and @xmath32 is the sky brightness field ( expressed in units such as jy / sr ) with transform @xmath66 . the instrumental noise on the complex visibility measurement is represented by @xmath67 .",
    "the _ uv_-plane resolution of an interferometer in a single pointing is thus limited by the convolution with @xmath68 .",
    "however , these sub - aperture spatial frequencies can be recovered by using the phase gradient in the exponential @xmath69 $ ] from a raster of mosaic pointings @xmath70 , provided that the spacing of the pointings is sufficiently small to avoid aliasing as discussed in appendix  [ app : estim ] .    to aid us later on ,",
    "we introduce a convolution kernel @xmath71 and thus @xmath72 where @xmath73 is the planck conversion factor for the cmb given in equation ( [ eq : fplanck ] ) .",
    "it is easiest to write these in operator notation , with @xmath74 where @xmath75 and @xmath76 are the visibility and noise vectors respectively , @xmath77 is our kernel , and @xmath78 is the transform of the temperature field . in this representation @xmath78 can be thought of as a vector of cells in _",
    "uv _ space .",
    "in order to determine the response of the array to the radiation field , we need to know the primary beam @xmath79 of the antenna elements and its fourier transform @xmath80 . in general , for each frequency channel , each baseline has a primary beam which is the fourier transform of the cross - correlation of the voltage illumination functions across the aperture of each antenna  see @xcite for a detailed treatment of the interferometer response . for a real and symmetric primary beam that is identical between antennas , then the transforms are symmetric and real we can ignore the differences between cross - correlation and convolution and write @xmath81 for the voltage illumination function @xmath82 across the radius of the aperture @xmath83 at frequency @xmath84 , where @xmath85 is the fourier transform of @xmath86 .",
    "the cbi beams have been measured and are nearly identical and symmetric , and thus we will use a single mean primary beam and its transform for the array . for a heterogeneous array ,",
    "the individual beams can be used with some added complication .    for most antennas , such as those used in the cbi",
    ", the primary beam width scales linearly with observing wavelength , and thus @xmath87 is approximately constant with wavelength .",
    "then , we can define @xmath88 as the normalized aperture autocorrelation function , and write @xmath89 for a channel centered at wavelength @xmath90 , with @xmath91 normalizes the response to give unity gain on - sky at the beam center ( @xmath92 ) . if @xmath93 , then @xmath94 .",
    "the two - dimensional primary beam response , @xmath79 , is determined by means of measurements of a bright radio source over a two - dimensional grid of offset pointings centered on the source .",
    "the central lobe of @xmath79 for the cbi is well approximated by a circular gaussian , which is characterized by its dispersion @xmath95 , which is related to the full width at half - maximum ( fwhm ) @xmath96 by @xmath97 .",
    "the fourier transform of an infinite circular gaussian is given by @xmath98 where @xmath99 is the gaussian dispersion in fourier space .",
    "the function @xmath88 is therefore @xmath100 for gaussian radius @xmath101 . for the cbi the measured primary beam",
    "( see paper  iii ) has @xmath102 , so @xmath103 at 31  ghz ( @xmath104  cm ) , which corresponds to @xmath105  cm .    for the cbi software pipeline , instead of using a gaussian approximation to @xmath88 we have chosen to model the antenna illumination @xmath106 as a gaussian truncated at both the dish edge and the secondary blockage radius @xmath107 where for the cbi antennas @xmath108  cm .",
    "note that if @xmath106 and @xmath88 were infinite circular gaussians , then @xmath109 .",
    "a best - fit taper parameter @xmath110 is obtained using the measured primary beam @xmath111 , giving @xmath112  cm or an edge taper of 0.118 ( @xmath113  db of power ) at the dish edge .",
    "we then numerically tabulate the autocorrelation @xmath88 assuming @xmath112  cm which is then interpolated in the code when @xmath68 is required .",
    "this model is a better fit to the observed beam than a pure gaussian beam ( see figure  1 in paper  iii for a plot of this model ) .",
    "the resolution in @xmath0 or @xmath2 space is set by the width of @xmath114 . for a gaussian approximation to the beam ,",
    "the dispersion in multipole @xmath2 is @xmath115 , and the fwhm is @xmath116 . for @xmath117 at 31  ghz we have fwhm @xmath118 ( @xmath119 ) . given that features are expected in the power spectrum of widths significantly less than this , it is highly desirable to reduce the effective resolution width of the cbi by at least a factor three using mosaicing .",
    "the principal problem in using likelihood ( see  [ sec : liklhd ] ) to determine confidence limits on the power spectrum for cbi data is the large number of visibilities compounded by the large number of mosaic pointings ( typically @xmath120 or larger ) .",
    "even a modest reduction in the number of matrix elements passed to the likelihood calculation will greatly aid the computation .",
    "this suggests that we grid the visibilities before computing the likelihood function . for an effective resolution in the aperture plane determined by the primary beam and mosaic",
    "size , there is little use in sampling below this smearing scale , and we can define an optimum gridding scheme which minimizes the quantity of data and information loss ( the gridding is a form of compression ) .",
    "we implement this by defining _ estimators _",
    "@xmath121 for the true complex brightness transform which are linear combinations of the measured visibilities .",
    "these estimators bin together data from the different frequency bands and mosaic pointings .",
    "thus , a direct sum of visibilities taken at the same @xmath122 but over the whole mosaic @xmath123 will result in an estimator that has a higher effective resolution in the _ uv _ plane .",
    "the result is that we can speed up the likelihood estimation at the cost of complicating the covariance matrix . in general , this matrix can be computed relatively quickly as it is a @xmath124 process , and thus this is a worthwhile trade - off versus the @xmath125 cost of calculating the likelihood .",
    "the estimators derived in appendix  [ app : estim ] are not orthogonal combinations of the original visibilities , and thus some information loss is expected .",
    "however , the tests performed in  [ sec : test ] show that these estimators are unbiased , and comparisons to results obtained using the visibilities directly show that there is no noticeable loss in sensitivity .",
    "thus , our gridding can be considered to be an efficient form of ( lossy ) compression using the beam as a signal template .    in appendix",
    "[ app : estim ] , we argue that a @xmath126 formed by a linear combination of visibilities will give a estimate of the weighted average of @xmath127 or @xmath128 around _ uv _ locus @xmath129 .",
    "we have from equation ( [ eq : moskern ] ) @xmath130 where the kernel @xmath131 is defined in equation ( [ eq : moskern ] ) and the kernel for the conjugate visibilities @xmath132 is defined in equation ( [ eq : moskernalt ] ) .",
    "in particular , @xmath133 where @xmath134 the normalization factor given in equation ( [ eq : zk1 ] ) , and @xmath135 is the visibility weight given in equation ( [ eq : viswt ] ) .    by operating with the gridding kernel on equation ( [ eq : visop ] ) , we get @xmath136 where we define @xmath137 as the convolution kernel that operates on the transform of the intensity ( the gridded version of @xmath77 ) , and @xmath138 is the gridded noise .",
    "the conjugate to @xmath77 defined in equation ( [ eq : pk ] ) is given by @xmath139 which gathers the conjugate visibilities under the transformation @xmath140 .",
    "although it is not necessary to do so , it is convenient to construct the @xmath126 on a regular lattice in @xmath129 with a spacing @xmath141",
    ". thus the grid `` cells '' represented by the @xmath126 represent an interpolation using @xmath131 of the visibilities onto the _ uv_-plane .",
    "this will be useful when using the estimators to form filtered images (  [ sec : image ] ) .",
    "if it is desired that the visibilities be used directly , for example when the datasets are small , then the ungridded case can be recovered by setting @xmath142 and @xmath143 , giving @xmath144 and @xmath145 , with no loss of generality in the derivations .",
    "to carry out the power spectrum estimation , we form the likelihood of the data given covariance matrices for the signal , noise , and foregrounds .",
    "since the estimators are linear combinations of the visibilities , which we assume are made up of gaussian noise and gaussian signal components , we can use a multivariate gaussian probability distribution to describe the estimators also . because @xmath146 is complex",
    ", it is easier to deal with the real and imaginary parts by packing them together in a double - length real vector @xmath147 written here as a column - vector of length @xmath148 .",
    "the log - likelihood function for a real multivariate gaussian probability distribution is @xmath149 where @xmath150 is the transpose of @xmath151 , and @xmath152 is a block matrix of the real and imaginary covariances .",
    "the vector @xmath153 represents the parameters of the model or theory against which the data is being measured ( see below ) .",
    "these parameters are contained in @xmath154 .    in terms of @xmath155 and @xmath156 , we can write @xmath157 and therefore @xmath158 \\nonumber \\\\ \\langle { \\rm im}\\,{\\mbox{\\boldmath $ \\delta$}}\\,{\\rm im}\\,{\\mbox{\\boldmath $ \\delta$}}^{\\rm t } \\rangle & = &    \\phantom{-}{1\\over2}\\,{\\rm re}\\,\\left [     \\langle { \\mbox{\\boldmath $ \\delta$}}\\,{\\mbox{\\boldmath $ \\delta$}}^\\dag \\rangle -     \\langle { \\mbox{\\boldmath",
    "$ \\delta$}}\\,{\\mbox{\\boldmath $ \\delta$}}^{\\rm t } \\rangle \\right ] \\nonumber \\\\ \\langle { \\rm re}\\,{\\mbox{\\boldmath $ \\delta$}}\\,{\\rm im}\\,{\\mbox{\\boldmath $ \\delta$}}^{\\rm t } \\rangle & = &   -{1\\over2}\\,{\\rm im}\\,\\left [ \\langle { \\bf \\delta}\\,{\\bf \\delta}^\\dag \\rangle    - \\langle { \\mbox{\\boldmath $ \\delta$}}\\,{\\mbox{\\boldmath $ \\delta$}}^{\\rm t } \\rangle \\right ] \\nonumber \\\\ \\langle { \\rm im}\\,{\\mbox{\\boldmath $ \\delta$}}\\,{\\rm re}\\,{\\mbox{\\boldmath $ \\delta$}}^{\\rm t } \\rangle & = &    \\phantom{-}{1\\over2}\\,{\\rm im}\\,\\left [     \\langle { \\mbox{\\boldmath $ \\delta$}}\\,{\\mbox{\\boldmath $ \\delta$}}^\\dag \\rangle     + \\langle { \\mbox{\\boldmath $ \\delta$}}\\,{\\mbox{\\boldmath $ \\delta$}}^{\\rm t } \\rangle \\right ]     \\label{eq : cimre}\\end{aligned}\\ ] ] where @xmath159 is the hermitian transpose of @xmath155 ( a row - vector containing the complex conjugate of a column - vector ) , and @xmath160 is the tensor or outer product of @xmath155 and @xmath161 , which is a matrix with elements @xmath162 .",
    "it is important to include the covariances of @xmath163 as well as those for @xmath160 .",
    "normally , only one of a given visibility @xmath49 or its conjugate @xmath164 will correlate with @xmath165 .",
    "however , for short baselines @xmath166 ( less than 127.3  cm for the 90  cm cbi dishes ) , there may be overlap between the support for a given visibility and both another visibility and its conjugate , as shown in figure  [ fig : support ] , and thus both may be nonzero . note that the correlation between distant conjugate pairs is small , since the overlap occurs far out in the antenna response @xmath68 , although it is non - negligible on the shortest cbi baselines where the overlap occurs at the @xmath167 point ( illustrated in figure  [ fig : support ] ) for perpendicular 1-meter baselines with the beam response @xmath168 . outside the baseline range @xmath169 one of @xmath170 or @xmath171 will be zero",
    ".    the covariance matrix @xmath154 can be split into a sum of independent contributions from instrumental noise @xmath172 , the cmb signal @xmath173 , and foreground signals @xmath174 and @xmath175 .",
    "we further split @xmath176 into a sum of terms @xmath177 from separate @xmath2 bands of the power spectrum , @xmath178 the factors @xmath179 are the `` bandpowers '' @xcite for bins with centers at @xmath180 , and are the model parameters to be determined by maximizing the likelihood .",
    "the factor @xmath181 is amplitude of the covariance due to a residual gaussian foreground , and @xmath182 is the amplitude of the covariance contributed by known point sources ; there may more than one of each of these types of foreground covariance matrices .",
    "the @xmath182 and @xmath181 can be treated as adjustable parameters to determined by maximum likelihood , or they can be held fixed at _ a priori _ values , in which case @xmath174 and @xmath183 are constraint matrices with their corresponding terms in equation ( [ eq : csnbandv ] ) behaving like additional noise terms .    in the following sections we consider each of the terms @xmath172 , @xmath177 , @xmath174 , and @xmath183 in turn .",
    "if we write @xmath184 then in each case we calculate the contributions to the covariance matrix for the real and imaginary parts of the estimators using equations ( [ eq : creim ] ) and ( [ eq : cimre ] ) @xmath185 &               -{1\\over2}\\,{\\rm im}\\ , [ { \\bf m } - \\overline{\\bf m } ] \\\\    \\phantom{-}{1\\over2}\\,{\\rm im}\\ , [ { \\bf m } + \\overline{\\bf m } ] &    \\phantom{-}{1\\over2}\\,{\\rm re}\\ , [ { \\bf m } - \\overline{\\bf m } ]   \\end{array } \\right)\\ ] ] with the individual covariance matrices given by insertion of the appropriate contribution to @xmath186 and @xmath187 for that component , e.g.  @xmath188 and @xmath189 to compute the block elements of @xmath177 .",
    "the instrumental noise correlations are assumed to be gaussian and independent between different baselines , and frequency channels . for the cbi ,",
    "tests have been carried out on the data which show this to be true to a high level of accuracy . in this case , the noise contribution to the real and imaginary parts of the visibilities are independent zero - mean normal deviates with @xmath190 and thus we can write @xmath191 for real noise matrix @xmath192 , where @xmath193 .    it can be shown that the noise contributions @xmath138 to the estimators defined in equation ( [ eq : rop ] ) have the contributions to the covariance elements @xmath186 and @xmath187 defined in equation ( [ eq : mmbar ] ) given by @xmath194 using the covariances of @xmath195 given in equation ( [ eq : ndef ] ) .",
    "this is assembled into the covariance matrix @xmath172 using equation ( [ eq : csbreimest ] ) . in general",
    ", the gridding kernel @xmath131 will map a given visibility to more than one estimator , and thus @xmath172 will have non - zero off - diagonal elements . furthermore , if there are noise correlations between baselines or channels , then the structure of @xmath172 will be even more complicated .",
    "the cmb contribution to the visibility covariance matrix is given by the covariance of the @xmath196 term in equation ( [ eq : rop ] ) @xmath197 where @xmath198 and @xmath199 are given in equations ( [ eq : cofu ] ) and ( [ eq : cofualt])respectively .",
    "then , the elements of @xmath200 and @xmath201 for estimators @xmath202 and @xmath203 are @xmath204 with @xmath205 where to aid in breaking up the cmb covariance matrices into bands we write the integrations in terms of polar fourier coordinates @xmath206 ( @xmath207 ) .    as an illustration ,",
    "consider the case without gridding .",
    "then , @xmath145 , and using equation ( [ eq : pk ] ) in ( [ eq : mkkint ] ) we get @xmath208 for the covariance matrix element between visibilities @xmath49 and @xmath165 .",
    "we furthermore write the radial integral over @xmath209 as a sum with respect to @xmath210 of equation ( [ eq : cvflat ] ) @xmath211 where @xmath212 is the _ variance window function _ ( e.g.  @xcite ) .    we define the bandpowers @xmath179 by constructing @xmath210 piecewise with respect to a fiducial shape @xmath213 @xmath214 where @xmath215 breaks the power spectrum into non - overlapping bands .",
    "the standard choice for the shape is @xmath216 for equal power per log-@xmath2 interval , with @xmath217 then giving the bandpowers in units of @xmath218 .",
    "then , to calculate @xmath177 , we construct band versions of the covariance matrix elements in equation ( [ eq : mdef ] ) @xmath219 where @xmath220 and @xmath221 .",
    "these are then combined following the prescription in equation ( [ eq : csbreimest ] ) to assemble the @xmath222 .",
    "the variance window function @xmath223 is the convolution of the @xmath224 and @xmath225 , and thus its width is characteristic of the square of the fourier transforms primary beam , or fwhm @xmath226 .",
    "thus we would expect in a single field to be able to achieve a limiting resolution of @xmath227 for @xmath118 at 31  ghz .",
    "this will be increased by the mosaicing by a factor roughly equal to the extent of the half - power width of the mosaic relative to that of a single field . in practice ,",
    "the limiting useful width for the @xmath2 bins for the bandpowers will be set by the band - band correlations introduced in the maximum likelihood estimation procedure ( see  [ sec : relax ] and  [ sec : test ] for further discussion and examples ) .",
    "consider a set of @xmath228 point sources at positions @xmath229 with flux densities @xmath230 ( @xmath231 ) .",
    "the intensity field at frequency @xmath84 is then given by @xmath232 which is assumed to be uncorrelated with other intensity components like the cmb .",
    "the effect @xmath233 on the visibilities @xmath49 ( e.g.  eq.[[eq : visi]])is then given by the sum over sources @xmath234 where @xmath235 is the contribution to visibility @xmath62 of source @xmath236 .",
    "we assume that the positions of the sources can be determined with negligible uncertainty through radio surveys , and that the errors are due to uncertainties in the measurements of the flux densities .",
    "then , the covariance between the source contributions to visibilities @xmath62 and @xmath237 is @xmath238 where @xmath239 is the flux density covariance matrix between sources @xmath236 and @xmath240 at frequencies @xmath241 and @xmath242 respectively .",
    "there is a similar covariance matrix @xmath243 .",
    "t these can be passed through the gridding procedure using equation ( [ eq : linop ] ) to make @xmath244 and used to construct the covariance elements @xmath245 using equation ( [ eq : mmbar ] ) .",
    "this covariance matrix can be greatly simplified if we can subtract off the mean source flux densities , leaving a zero - mean residual error .",
    "let the true source flux density @xmath230 be the sum of the measured flux density @xmath246 and an error @xmath247 .",
    "if our measurements of these foreground sources are accurate , then the residuals @xmath247 should be uncorrelated between sources ( they are due to measurement errors ) and have zero mean . in this case , we can make corrected visibilities @xmath248 @xmath249 to be used in place of @xmath250 in subsequent analysis . then , we are left with the fluctuating component @xmath251 which we must deal with statistically .",
    "the covariance between the source error contributions to the visibilities , assuming the flux density errors are independent between sources ( but not between frequency channels for the same source ) , is given by @xmath252 and similarly for @xmath253 .",
    "finally , if the covariance is separable , e.g. @xmath254 then we can write @xmath255 the other covariance @xmath256 can be computed in the same way . because we have assumed that the covariance is separable , we can speed up the covariance calculation as only the vector @xmath257 for each source is needed .",
    "we can grid this onto the estimators @xmath258 and then @xmath259 which are used to build @xmath174 .",
    "there are two components to the source flux density uncertainties @xmath260 , one from the uncertainties on the source frequency spectrum , and the other from the uncertainties on the flux density measurements and any extrapolation of the measured flux densities to the observing frequencies @xmath241 ( using the estimated source spectrum ) . as an example , consider a source with a flux density @xmath261 measured with standard deviation @xmath262 at frequency @xmath46 , and a known power - law frequency spectrum with spectral index @xmath43 , @xmath263 then , it is easy to show that @xmath264 with the fractional uncertainty in the flux density @xmath265 remaining independent of the frequency .    on the other hand , consider the case where there is now an uncertainty @xmath266 in the spectral index between @xmath241 and @xmath46 . then , our extrapolation factor @xmath267 , which we write as @xmath268 propagates to the extrapolated flux density as @xmath269 which can be negative  for two channels flanking the fiducial frequency ( e.g.  @xmath270 ) the errors will be anti - correlated .",
    "note that we have approximated the resulting distribution as gaussian .",
    "in general it is not , e.g.  for a gaussian distribution in @xmath43 we find a log - normal distribution in @xmath271 .",
    "although the dominant spectral error is due to the extrapolation from a frequency @xmath46 outside the range of the cmb instrument , there is an additional error due to an error in the spectral index over the frequency channels @xmath241 of the visibilities .",
    "this is as if you extrapolated using one spectrum appropriate for the band center @xmath272 of the instrument , but when the flux densities @xmath273 are extrapolated from band center @xmath274 there is an error from using the wrong @xmath43 over the band .",
    "this is handled using equation ( [ eq : sigmaa ] ) with another @xmath266 appropriate to the uncertainty in the spectral index over the @xmath241 .",
    "for the cbi analysis , we have approximated both the flux density error and the spectral extrapolation error as a single equivalent flux density error . for the cbi ,",
    "the frequency span ( 2636  ghz , or @xmath275 ) is small enough that we can approximate the spectral index uncertainty as an effective flux density uncertainty @xmath276 extrapolated to band center @xmath272 from @xmath46 using @xmath277 @xmath278 ^ 2\\,\\sigma^2_\\alpha \\big)\\ ] ] where @xmath43 need not equal @xmath277 and should reflect the spectral index over the observing band , not the one used for extrapolation from @xmath46 .    in principle , if the true mean flux densities for the sources are correctly subtracted from the visibilities , and the covariance matrix @xmath174 is built using the correct elements @xmath279 , then inclusion of this as a noise term in @xmath154 using @xmath280 would remove the effects of these sources from our power spectrum estimation in a statistical sense .",
    "however , there are a number of factors that make this difficult .",
    "if the source flux density measurements have a calibration error , then the errors will not be independent between sources .",
    "also , the fainter sources ( which are still significant contributors to the signal ) have flux densities that are often extrapolated from much lower frequencies ( e.g.  the `` nvss '' sources in paper  ii and paper  iii ) .",
    "furthermore , since there are a relatively small number of discrete sources contributing to a given field , it is not clear we are in the statistical limit where the flux density covariance is an accurate description of what is happening to the data . for these reasons , for the cbi analysis",
    "we treat the covariance matrix @xmath174 constructed using the approximation in equation ( [ eq : sigmeff ] ) as a constraint matrix for the nuisance parameters due to the sources , and set @xmath182 to a high enough amplitude to _ project out _ the contaminated modes in the data .",
    "because the source modes are spread out by the effect of the synthesized beam ( the `` point - spread function '' in imaging terms ) , setting @xmath182 to too high a value will start to down - weight modes that are not significantly contaminated , while too low a value will eat into the noise and cmb signal power in those modes without down - weighting them sufficiently thus biasing the affected bandpowers low .",
    "the exact values to be used thus depend upon the signal and noise levels in the data ; we refer the reader to papers ii and iii for descriptions of what was chosen for the cbi analysis .",
    "see @xcite for a description of the constraint matrix formalism and the technique of projection .      in  [ sec :",
    "pscmb ] it was mentioned that a single foreground component could be modeled with a modified covariance matrix , power spectrum shape and frequency dependence .",
    "as long as these foregrounds can be treated as a gaussian random field , they can be processed in the same manner as the cmb .",
    "therefore , once the amplitude and shape of the foreground fluctuation power spectrum @xmath281 is input , we compute the foreground covariance matrix elements @xmath282 where the variance window functions @xmath283 and @xmath284 are given by substituting for @xmath137 in equation ( [ eq : wijvarpi ] ) a new @xmath285 built from a kernel @xmath286 using a frequency factor @xmath287 appropriate to the foreground in question .",
    "the matrix @xmath183 is then obtained by substitution of @xmath288 and @xmath289 as usual using equation ( [ eq : csbreimest ] ) .",
    "although it is possible to break up the gaussian foreground component into bands as we did the cmb , it is preferable to compute the foreground covariance matrix in a single band using its shape @xmath290 , to reduce the degeneracy with the cmb  you can not distinguish between the two in narrow @xmath2 bands where the shapes are unimportant .",
    "an example of a foreground that strongly affects the cbi data is that from point sources below the limit for subtraction contaminating the cbi fields .",
    "residual _ statistical background , in the limit where there are many sources per field , can be modeled as a white noise gaussian field with constant angular power spectrum and power - law frequency spectrum .",
    "each individual source has a flux density drawn from a differential number count distribution @xmath291 which represents the number of sources per steradian with flux densities between @xmath28 and @xmath292 at observing frequency @xmath84 .",
    "the angular clustering in these sources is very small , and can be neglected .",
    "the contribution of a source @xmath236 to visibility @xmath49 was given by @xmath235 in equation ( [ eq : vsrc ] ) .",
    "the sources are independently distributed in flux density and on the sky , so @xmath293 where the angular average can be written as an integral over @xmath294 with @xmath295 as the normalizing solid angle .",
    "this integral is just a fourier transform , and so @xmath296 which is the same as the cmb visibility covariance matrix @xmath297 in equation ( [ eq : mkkintvis ] ) with @xmath298 and @xmath299 .",
    "similarly , the other covariance @xmath300 reduces to @xmath301 .",
    "thus , in the stochastic limit the residual source background behaves as a gaussian random field and can thus be treated as we do the cmb signal in  [ sec : viscor ] but with a power spectrum shape @xmath302 which is constant over @xmath2 for a given pair of frequency channels .",
    "the amplitude of the covariance matrix is the ensemble average of the source power per solid angle , which is obtained by integration over the flux density and spectral index distributions @xmath303 where we have again assumed that the spectrum is a power - law with spectral index @xmath43 over the range of interest for the @xmath241 , and integrate over the number counts over the flux density range from @xmath304 to @xmath305 .",
    "we also assume that there is a large number of these faint sources over the solid angles of interest ( e.g.  the cbi primary beam ) and thus the poisson contribution to the probability can be ignored and we can use the mean source density given by the number counts @xmath306 at the fiducial frequency @xmath46 for which @xmath307 is given . the spectral index distribution as a function of flux density @xmath308 must be estimated from radio surveys , though it can be uncertain at the high frequencies and faint levels at which the cmb experiments are carried out . if @xmath309 and thus is independent of flux density , then it can be shown ( e.g.  appendix  [ app : counts ] ) that the integrals in equation ( [ eq : resampint ] ) can be evaluated at a single frequency @xmath84 in the band and scaled using an effective spectral index @xmath310 @xmath311 where @xmath312 is the amplitude of the fluctuation power per solid angle ( in units of jy@xmath313/sr ) at @xmath84 . in terms of the logarithmic average @xmath26 for the cmb , @xmath314 which rises at high @xmath2 with respect to the cmb .",
    "see appendix  [ app : counts ] for an example analytic calculation using power - law source counts and a gaussian spectral index distribution .",
    "the frequency range of the cbi is insufficient to distinguish nonthermal foreground emission from the thermal cmb , and thus this is treated as a constraint matrix ( i.e.  @xmath181 is not solved for as a parameter ) .",
    "therefore , in the cbi analysis we construct the covariance matrix @xmath315 using the matrix elements in equation ( [ eq : mkkfg ] ) built assuming unit power ( 1  jy@xmath313/sr ) and the frequency dependence @xmath316 from equation ( [ eq : creskk ] ) .",
    "the value used for @xmath181 is equal to the source fluctuation power @xmath317 calculated as an _ a priori _ estimate based on knowledge of the residual foreground source populations ( see appendix  [ app : counts ] ) .",
    "we are not restricted to cmb , gaussian foreground , and discrete point sources as the components of our signal or noise in the covariance matrix @xmath154 in equation ( [ eq : csnbandv ] ) .",
    "this approach can be generalized to deal with other signals of interest .",
    "for example , extended sources with a known profile , such as the sunyaev - zeldovich effect from clusters of galaxies , could be modeled either analytically or numerically giving a power spectrum shape ( e.g.  @xcite ) . in the case of a signal with a known distribution on the sky , a template can be used .",
    "examples of this include dust emission in the millimeter - wave bands , or the anomalous centimeter - wave emission observed at ovro @xcite and by cobe @xcite .",
    "in particular , the latter foreground , which is posited as due to spinning dust grains by @xcite , correlates with the 100@xmath19 m dust emission as measured by iras and dirbe , and thus a template of emission can be constructed .",
    "unfortunately , with its low intrinsic fringe rates and extremely short ( @xmath318 ) spacings , the cbi is susceptible to ground pickup . to remove this , we observe for each field a trailing field displaced @xmath319 in right ascension @xmath319 later , and difference the corresponding visibilities",
    "therefore , we must take this differencing into account in our correlation analysis .",
    "this effectively modifies the window function , quenching low spatial frequencies further .",
    "let us write @xmath320 for switching offset @xmath321 ( e.g.  @xmath319 in ra @xmath322 for the cbi fields near the celestial equator ) .",
    "then , from equation ( [ eq : visi ] ) we find @xmath323     + e^{\\rm sw}_k\\ ] ] where the switched noise @xmath324 . in terms of the kernel of equation ( [ eq : pk ] ) , @xmath325    \\label{eq : pksw}\\ ] ] and",
    "thus for our switched visibilities we compute everything as before , but substituting @xmath326 for @xmath327 .    note that if the trail field offsets @xmath328 were constant in arc length rather than in right ascension ( this is approximately true since the declination range of the mosaic is limited ) we could write the convolution kernel as @xmath329\\ ] ] where the leading factor of 2 dominates ( you essentially get twice the cmb power ) .",
    "note that a noticeable effect of the differencing is that the window function will have a ripple of `` wavelength '' @xmath330 superimposed on its envelope .",
    "for example , the @xmath319 switching in ra that the cbi uses corresponds to @xmath331 at the celestial equator , and thus the ripple has @xmath332 in @xmath333 .",
    "this corresponds to 180 in @xmath2 , but is azimuthally averaged in the _",
    "uv_-plane and thus the peak - to - peak amplitude is reduced .",
    "we have expressed the estimators as a real vector @xmath151 and obtained expressions for the components of its covariance matrix , and now turn to the problem of solving for the maximum likelihood estimators for the bandpowers using equation ( [ eq : likx ] ) .",
    "as shown below , we will be carrying out a large number of matrix operations using @xmath154 and its component matrices ( e.g.  @xmath172 , @xmath177 , etc . ) and thus these will need factorization . because @xmath154 is positive definite we use optimized cholesky decomposition routines ( dchdc from linpack , or dpotrf from lapack ) to carry out the required factorizations .    the large number of visibilities _ times _ the number of mosaic pointings makes this computation extremely costly ( the matrix inversions and/or solution of systems of equations are order @xmath125 processes ! ) , especially for a large number of bands @xmath334 .",
    "clever perturbative or gradient search methods can help to reduce the overhead in finding the maximum in parameter space .",
    "one such method is the quadratic relaxation technique of ( * ? ? ?",
    "* bjk ) . to summarize here ,",
    "if one taylor expands the log - likelihood around the maximum likelihood bandpowers @xmath335 to second order @xmath336 then we can move toward the maximum using the quadratic approximation @xmath337^{-1 } \\ ,    { \\partial \\,\\ln l({\\bf q } ) \\over \\partial q_{b ' } } .\\ ] ]    the first derivative ( gradient ) is given by @xmath338\\ ] ] and the second derivative ( curvature matrix ) by @xmath339 \\nonumber \\\\     & & { } + { 1\\over2}\\,{\\rm tr}\\bigg [       { \\bf c}^{-1 } { \\partial c \\over \\partial q_{b } }      { \\bf c}^{-1 } { \\partial c \\over \\partial q_{b ' } }      \\bigg ] .",
    "\\label{eq : curvf}\\end{aligned}\\ ] ] note that the partial derivatives of the covariance matrix are just the band signal covariance matrices @xmath340 defined above .",
    "the final approximation is to replace the curvature matrix with its expectation value , which is the fisher information matrix @xmath341 .",
    "\\label{eq : fisher}\\ ] ] this yields @xmath342_{b b ' } \\ ,     { \\rm tr}\\left [ ( { \\mbox{\\boldmath $ d$}}\\,{\\mbox{\\boldmath $ d$}}^{\\rm t } - { \\bf c } )    ( { \\bf c}^{-1}\\,{\\bf c}^{\\rm s}_{b'}\\,{\\bf c}^{-1 } ) \\right ] \\label{eq : delqb}\\ ] ] for the iterative correction to the bandpowers",
    ". this amounts to making a quadratic approximation to the shape of the likelihood function around the maximum , and iteratively approaching it . at each step",
    ", the total covariance matrix @xmath154 must be updated using the new bandpowers @xmath343 . a convergence criterion based on the magnitude of the corrections",
    "@xmath344 will allow approach to the true @xmath345 to be controlled .",
    "the inverse of the fisher matrix @xmath346_{b b'}$ ] evaluated at maximum likelihood is the covariance matrix of the parameters @xcite .",
    "the diagonals @xmath346_{bb}$ ] give an estimated gaussian error bar for the derived bandpowers @xmath345 , though the full fisher matrix must be used to take the ( usually significant ) band - band correlations into account . as the width of the @xmath2 bins for the bands @xmath347 is reduced , anti - correlation between adjacent bands increases due to the intrinsic @xmath2-space resolution of the data .",
    "the presence of known or residual point source foregrounds in equation ( [ eq : csnbandv ] ) is dealt with by either fixing the amplitudes @xmath182 or @xmath181 and treating @xmath348 or @xmath349 as additions to the noise matrix @xmath172 , or by solving for the @xmath182 or @xmath181 and treating them as extra bandpowers @xmath217 with associated entries in the fisher matrix . in practice , for the cbi , it is necessary to hold fixed the @xmath181 because the contribution from the source foreground with a white noise power spectrum and appropriate frequency spectrum is largely indistinguishable from an overall offset of the cmb power spectrum .",
    "in addition , the uncertainties on the individual known source contributions to an aggregate @xmath174 will be substantial , and thus solving for a single amplitude @xmath182 will not be as useful as it might appear . in this case , the @xmath174 acts as a constraint matrix and the @xmath182 can be set to an arbitrarily high value , which will effectively _ project _ out the modes corresponding to the known sources by down - weighting the relevant combinations of the estimators in the likelihood @xcite .",
    "consider observations taken of separate sets of single fields or mosaics @xmath350 where there is effectively no correlation between fields from separate @xmath350 and the fields within a given set @xmath350 are related by the mosaic covariance given in the previous sections . in this case",
    ", we can assemble a giant data vector @xmath351 from the @xmath352 individual field vectors @xmath353 ( e.g.  eq.[[eq : xvec ] ] ) , with the block diagonal covariance matrix @xmath354 which in turn can be written as sums of block - diagonal noise and signal covariance matrices @xmath355 and @xmath356 etc .",
    ", with blocks given by @xmath355 and @xmath356 , etc . because they are block diagonal , we can write the log - likelihood in equation ( [ eq : likx ] ) as the sum over datasets @xmath357    we proceed as before , with the same bandpowers @xmath358 and with the block - diagonal band covariance matrix @xmath359 and thus all matrices are block - diagonal and composed of the individual single field or mosaic matrices . therefore , @xmath360 \\nonumber \\\\",
    "\\delta q_b & = & { 1\\over2}\\,\\sum_{b'}\\left [ f^{-1 } \\right]_{b b ' } \\ ,       \\sum_f { \\rm tr}\\left [ ( { \\mbox{\\boldmath $ d$}}_f\\,{\\mbox{\\boldmath $ d$}}_f^{\\rm t } - { \\bf c}_f )      ( { \\bf c}_f^{-1}\\,{\\bf c}^{\\rm s}_{b'f}\\,{\\bf c}_f^{-1 } ) \\right]\\end{aligned}\\ ] ] which is used to iteratively approach the @xmath345 using the bjk scheme as in the single dataset case .      to compare the bandpowers obtained from the data to model power spectra we need to define a set of filter functions which project models @xmath361 into a set of bandpowers @xmath362 @xmath363 as in @xcite . in the ensemble limit",
    ", the expectation value @xmath364 will approach the underlying signal covariance matrix @xmath176 .",
    "we can then use the expression for the minimum variance estimate of the bandpower to derive the filter functions @xmath365 @xcite . since @xmath366_{b b ' } \\ ,    { \\rm tr}\\left [ ( { \\bf c}^{-1}\\,{\\bf",
    "c}^{\\rm s}_{b'}\\,{\\bf c}^{-1 } ) \\ ,    { \\bf   c}^{\\rm s } \\right]\\ ] ] and @xmath367 the normalized filter functions can be computed using the band averaged fisher matrix ( e.g.  eq.[[eq : fisher ] ] ) @xmath368_{b b ' } \\ ,    { \\rm tr}\\left [ ( { \\bf c}^{-1}\\,{\\bf c}^{\\rm s}_{b'}\\,{\\bf c}^{-1})\\ ,    \\frac{\\partial { \\bf c}^{\\rm s}}{\\partial \\cal{c}_{\\ell}}\\right]\\ ] ] with respect to the @xmath369 that is built into the @xmath176 . because of the @xmath370 used in the construction of the @xmath177 in equation ( [ eq : mkkbin ] ) , @xmath371 and thus @xmath372 is orthonormal with respect to the bands defined by @xmath370 .",
    "calculating the filter functions at each @xmath2 becomes somewhat prohibitive in both processor time ( the problem scales as an extra @xmath373 operations ) and storage since the calculation of equation ( [ eq : windows ] ) can only proceed once we have relaxed to the maximum likelihood solution .",
    "for this reason , in practice we sample the full filter functions in bands at intervals @xmath374 where the @xmath374 are narrower than the bands @xmath347 , with @xmath375_{b b ' } \\ ,    { \\rm tr}\\left [ ( { \\bf c}^{-1}\\,{\\bf",
    "c}^{\\rm s}_{b'}\\,{\\bf c}^{-1 } ) \\ ,    { \\bf c}^{\\rm s}_{b_f}\\right].\\ ] ] in principle , this is equivalent to assuming a flat window over the ` fine ' band @xmath374 and as long as the curvature of the exact window function is small over the intervals @xmath374 this should provide an adequate sampling of the continuous limit .    to obtain model bandpowers",
    "we can then either interpolate the samples @xmath376 to obtain an approximate form for @xmath365 for use in equation ( [ eq : bpaverage ] ) or _ pre - average _ the model spectrum over the fine bands @xmath374 as @xmath377 where @xmath378 are bandpowers calculated using flat filters ( @xmath379 ) .",
    "we find that a fine band width @xmath380 is sufficient to adequately sample the window functions and ensure normality and orthogonality to within @xmath381 with respect to integration over the bands ( e.g.  eq.[[eq : winortho ] ] ) .",
    "example window functions calculated in this manner for mock deep fields and mosaics are shown in the lower panels of figure  [ fig : mockdeep ] and figure  [ fig : mockmos ] respectively .",
    "a further complication at the parameter end of the process is that the likelihood of the bandpowers can not be assumed to be a gaussian .",
    "this is especially so in cases where the error in the bandpowers is sample or cosmic variance limited .",
    "assuming the bandpowers to be gaussian distributed can lead to the well known problem of _ cosmic bias _ where the likelihood of low power models can be overestimated and conversely that of high power models can be underestimated . @xcite",
    "have shown how one can avoid this problem while still retaining gaussianity in the @xmath382 analysis by treating certain functions of the bandpowers as gaussian distributed .",
    "very good fits to the non - gaussian distribution of the bandpowers can be obtained by use of the _ offset log - normal _ and _ equal variance _",
    "approximations to the likelihood .",
    "both approximations use offsets @xmath383 in the bandpowers which describe the contributions to the error in the bandpowers due to components other than the cmb . for",
    "the range of scales probed by instruments such as cbi these components will include the foregrounds such as point sources in addition to the usual noise ` on the sky ' offset @xmath384 , where @xmath385 is the offset due to the noise contribution to the error such that the quantity @xmath386 has a normal distribution @xcite .",
    "for accurate parameter fits we therefore require estimates of bandpowers for all the components making up the total covariance @xmath154 .",
    "an approximation for these can be obtained by modifying the minimum variance estimator for the bandpowers @xmath217 at the maximum likelihood @xmath387^{-1 } \\ ,    { \\rm tr}\\left [ ( { \\bf c}^{-1}\\,{\\bf c}^{\\rm s}_{b'}\\,{\\bf c}^{-1 } ) \\ ,    { \\bf   c}^{\\rm x } \\right]\\ ] ] where we have substituted @xmath388 in equation ( [ eq : delqb ] ) for the observed measure for the signal covariance @xmath389 .",
    "we then set @xmath388 to the noise @xmath172 , foreground source @xmath390 or gaussian residual foreground @xmath391 covariance components as desired ( or use the maximum likelihood values @xmath392 and @xmath393 if these are included as parameters in the solution rather than being fixed ) .",
    "examples of these are shown in paper  ii and paper  iii for the deep field data and mosaic data respectively .",
    "the offset to the log - normal is then obtained by summing the @xmath394 over the components , @xmath395 ( e.g.  @xcite ) .",
    "this formalism is used in paper  v to approximate the shapes of the likelihood functions in order to derive limits on the cosmological parameters .",
    "although not the primary goal of this method , an image can be constructed by fourier transforming back to the sky plane using equation ( [ eq : fourier ] ) .",
    "if the estimators @xmath126 are constructed on a regular lattice in @xmath396 with spacing @xmath141 and _ uv _ extent @xmath397 , then the resulting image will have an extent on the sky given by the inverse of the spacing @xmath398 and a resolution given by @xmath399 . in the continuum limit ( see appendix  [ app : estim ] ) , we can define an estimator @xmath400 for the temperature field @xmath401 @xmath402 where @xmath121 is the continuous functional form ( e.g.  eq[[eq : estcont ] ] ) for the estimators , with @xmath403 . in practice",
    "the lattice of estimators @xmath126 is embedded in a wider grid padded with zero in the unsampled cells , and an fft is carried out .    for our standard gridding normalization @xmath404 given in equation ( [ eq : zk1 ] ) , the units of @xmath155 will be flux density units ( jy ) and thus its inverse fourier transform will produce a map in units of jy / beam , where the beam area is given by the point - spread - function ( psf ) of the image . for a single field ,",
    "the psf is just the image generated using equation ( [ eq : image ] ) using estimators @xmath405 computed by introducing unit `` visibilities '' into equation ( [ eq : linop ] ) @xmath406 the situation for the mosaics is somewhat more complicated , as the mosaic offsets must be taken into account in constructing equivalent visibilities for point sources @xmath407 obtained by evaluating equation ( [ eq : visi ] ) with no noise and @xmath408 . in this case",
    "one would evaluate the psf at various positions @xmath409 in the map .",
    "because our estimators use the kernel @xmath131 as given in equation ( [ eq : qik ] ) which includes the beam transform @xmath68 , we are effectively multiplying the image on the sky by the primary beam squared  once in the kernel , and once due to the instrument itself ( e.g.  eq.[[eq : pk ] ] ) .",
    "images made directly from the @xmath155 will therefore be strongly attenuated in the ( noisy ) outskirts .",
    "as mentioned in appendix  [ app : estim ] , the optimal weighting for the imaging of the cmb component is to use the planck factor in equation ( [ eq : fplanck ] ) to correct for the thermal frequency spectrum ( e.g.  eq.[[eq : qtherm ] ] ) , while our standard intensity weighting given in equation ( [ eq : viswt ] ) is optimized for a flat non - thermal power - law spectrum with spectral index @xmath410 .",
    "we can also filter the gridded estimators in such a way as to enhance or down - weight certain signals or noise .",
    "we can do this with optimal or wiener filtering ( e.g.  @xcite ) , @xmath411 where the choice of the filter @xmath412 depends on the application . for example , the covariances @xmath388 calculated from equation ( [ eq : csbreimest ] ) can be used to construct optimal filters for each component contributing to the observations . for the signal component described by the covariances",
    "@xmath388 we can construct a wiener filter to be applied to the gridded @xmath0 estimators @xmath413 the amplitudes for the signal models such as the bandpowers @xmath217 or the source amplitudes @xmath182 can be set to their maximum likelihood values or to fiducial model amplitudes .",
    "the wiener filtered image is then recovered by fourier transforming .",
    "examples of images created using this method are described in the next section , and shown in figure  [ fig : image ] .",
    "wiener - filtered images are also used in paper  vi to explore the possibility of detection of the sunyaev - zeldovich effect in the data at high @xmath2 .",
    "the algorithm described above was coded as a scalar fortran ( f77 compatible ) program designated cbigridr , with a parallelized fortran 90 version using openmp directives also available for use on multiprocessor machines .",
    "in addition , the bjk likelihood relaxation was coded in a second parallelized fortran 90 program called mlikely using parallel versions of lapack matrix algebra routines ( e.g.   [ sec : relax ] ) .",
    "together , these two programs make up the cbi analysis pipeline .",
    "this pipeline has undergone numerous tests and development since its inception in april 2001 , and has been used to produce the power spectra and to provide the bandpowers as input to the cosmological parameter analysis given in the companion papers .",
    "we now give a brief description of our implementation .    in order to carry out the numerical integrations , a fine - grain rectangular lattice in _",
    "uv_-space was used .",
    "the fine - grain grid size @xmath414 ( in units of wavelength ) was chosen to adequately sample the phase turns in the _ uv _ plane due to the mosaic size and differencing ; for a standard @xmath120 cbi mosaic with @xmath415 spacing , the maximum field separation along the grid direction is @xmath416 , which gives oscillations in the _ uv _ plane with wavelength of @xmath417 , giving @xmath418 for two samples per cycle . to evaluate the projection operators @xmath419 ( e.g.  eq.[[eq : rop ] ] ) , we store a small fine - grain lattice around each @xmath129 .",
    "the maximum radius in _ uv _ space needed for the support of @xmath137 is @xmath420 . for cbi @xmath421  cm , and @xmath422  cm at @xmath423  ghz",
    ", we get @xmath424 . a grid of size @xmath425 cells with @xmath426 will fit both the sampling and radius requirements .",
    "the estimators are evaluated on a coarse - grain lattice of @xmath129 , with a spacing of @xmath427 .",
    "the fine - grain lattices on which we accumulate the @xmath419 will be cross - correlated to form the covariance elements @xmath428 and @xmath429 ( e.g.  eq.[[eq : mkkint ] ] ) , it is desirable to have the coarse grid size locked to integer multiples of the fine - grid cells .",
    "this coarse grid does not have to sample the highest mosaic frequencies , but only the effective width of @xmath137 .",
    "we find that for single cbi fields , @xmath430 is adequate . for cbi mosaics , a hybrid lattice with @xmath431 in the inner part ( @xmath432 ) and @xmath433 in the outer part",
    "was found to work well .    as stated in ",
    "[ sec : pscmb ] , the choice of sign of the exponential of the fourier transform in equation ( [ eq : fourier ] ) is a convention .",
    "this choice varies throughout the literature on the subject , but in practice depends upon the way the baseline vectors are defined in the data and how the correlation products are made ( e.g.  which antenna gets the quadrature phase shift ) .",
    "we note that in coding our algorithm to conform to the imaging standards of the aips , and difmap @xcite packages using the cbi data , we had to use the opposite sign convention from the one presented in equation ( [ eq : fourier ] ) .    to process a dataset , a spectral weighting @xmath434 and shape function @xmath435 are chosen .",
    "the visibilities @xmath49 are looped over , and any source subtraction (  [ sec : src ] ) is applied . for each estimator",
    "@xmath202 that @xmath49 contributes to either directly or as a conjugate , its contribution to the fine - grain lattice @xmath436 for @xmath437 is accumulated , e.g. @xmath438 where @xmath439 is a @xmath425 unit ( fine - grain ) lattice .",
    "this means that for @xmath440 estimators , the storage required for @xmath137 is only @xmath441 double - precision complex numbers .",
    "if the data were differenced ( as for cbi data ) , then @xmath442 from equation ( [ eq : pksw ] ) is used .",
    "the contributions to the noise covariance elements @xmath443 and @xmath444 ( eq.[[eq : eeexmat ] ] ) , and the @xmath445 ( eq.[[eq : dsrcrms ] ] ) are also accumulated at this time .",
    "finally , this visibility s contributions are added to estimator @xmath126 and normalization @xmath134 .",
    "the storage for @xmath137 , @xmath443 , and @xmath444 dominate the memory requirements . for example , the cbi mosaics use around @xmath446 estimators , and thus storage for @xmath447 double - precision complex numbers is needed .",
    "a single packed @xmath448 array is needed to hold @xmath443 and @xmath444 .",
    "the @xmath388 matrices are calculated in place and written out row by row , and thus need not be stored .",
    "there are no instances where matrices of dimension @xmath449 are stored ; the storage for a matrix of this size would be prohibitive as our largest cbi mosaics have @xmath450 .",
    "when all the visibilities have been processed , the estimators are normalized by @xmath134 , split into real and imaginary parts , and written out to disk .",
    "the covariance matrices @xmath451 , @xmath452 , and any @xmath453 are constructed by looping over pairs of rows corresponding to the real and imaginary parts of each estimator , e.g.  rows @xmath202 and @xmath454 for estimator @xmath202 .",
    "for each @xmath455 , the stored @xmath456 and @xmath457 are cross - correlated along with the shape function @xmath458 to form the bandpower covariance elements @xmath459 and @xmath460 of equation ( [ eq : mkkint ] ) , combined to make @xmath452 using equation ( [ eq : csbreimest ] ) , and stored .",
    "the relevant columns of these rows of @xmath451 are formed from the stored @xmath461 and @xmath462 . at this point , for each @xmath174 desired ( there may be more than one , in the cbi analysis we use 3 ) , the relevant @xmath463 are combined using equation ( [ eq : mkksrc ] ) to form @xmath464 and @xmath462 , which in turn are used to make @xmath453 .",
    "after all columns for these rows of the covariance matrices are computed , they are written to disk , and this process is repeated for the pair of rows corresponding to the next estimator @xmath202 . when all rows are complete , the output file is complete .",
    "note that different binnings of the @xmath222 can be run without regridding using the original @xmath137 , saving significant time .",
    "if a residual foreground covariance matrix @xmath183 is desired , the procedure outlined above is repeated in its entirety using the description in  [ sec : foreground ] .",
    "the spectrum and shape appropriate for the source population or foreground emission is used during the gridding and covariance matrix construction .",
    "other than these factors , the same gridding as in the cmb and noise estimators must be used .",
    "the output files from cbigridr are then used as input to mlikely .",
    "these can be for single fields or mosaics , or for combinations of independent fields or mosaics (  [ sec : comblike ] ) . at this point ,",
    "the pre - factors @xmath182 and @xmath181 for any @xmath465 and @xmath183 covariance matrices are chosen and fixed .",
    "relaxation to the likelihood maximum is carried out as described in  [ sec : relax ] , and the resulting bandpowers @xmath358 and inverse fisher matrix elements @xmath346_{b b'}$ ] are written out . if desired , the bandpower window functions @xmath376 (  [ sec : bwin ] ) can be computed if cbigridr was run to produce narrow - bin @xmath466 .",
    "the component bandpowers @xmath467 , @xmath468 and @xmath469 (  [ sec : comp ] ) can also be computed at this time .",
    "finally , filtered images using the formalism of  [ sec : image ] can be computed from the estimators , the @xmath154 ( at maximum likelihood ) , and the component covariance matrices .",
    "results from this are shown below and in paper  vi .",
    "the timing for cbigridr depends upon the degree of parallelization as well as the processor speed on a given machine , and the number of visibilities gridded , number of foreground sources , and number of bins @xmath347 for the bandpowers . as an example , the processing of the 14-h mosaic field of paper  iii ( the largest of the datasets ) involved gridding 228819 visibilities from 65 separate nights of data in 41 fields to 2352 complex estimators .",
    "a total of 916 sources were gridded into three source covariance matrices .",
    "a total of 7 different binnings for @xmath222 were run at this time from the same gridding .",
    "the execution time using the parallel version of cbigridr was @xmath470 running on 22 processors on a 32-processor alpha gs320 workstation at the canadian institute for theoretical astrophysics .",
    "it then took @xmath471 on the same computer for mlikely to process 4704 double - precision real estimators in 16 @xmath222 bands , with 3 @xmath174 matrices , one @xmath183 and one @xmath172 .",
    "this included the time needed to calculate the component bandpowers @xmath472 , but not the window functions .",
    "the speed of this fast gridded method has allowed us to carry out numerous tests on both real and simulated dataset , which would not have been possible carrying out maximum likelihood ( e.g.  using even the optimized mlikely ) on the 200000-plus visibilities .",
    "the performance of the method was assessed by applying it to mock cbi datasets .",
    "simulated cbi datasets were obtained by replacing the actual visibilities from the data files containing real cbi observations of the various fields used in paper  ii and paper  iii with the response expected for a realization of the cmb sky drawn from a representative power spectrum , plus uncorrelated gaussian instrumental noise with the same variance as given by the scatter in the actual cbi visibilities .",
    "the differencing of the lead and trail fields used in cbi observations was included ( e.g.   [ sec : difference ] ) .",
    "this mock dataset had the same _ uv _ distribution as the real data , and gives an accurate demonstration of expected sensitivity levels and the effect of cosmic variance .",
    "the power spectrum chosen for these simulations was for a model that fit the cobe and boomerang data @xcite .",
    "figure  [ fig : mockdeep ] shows the power spectrum estimation derived following the procedure detailed above .",
    "the mock datasets were drawn as realizations for the 08h cbi deep field from paper  ii .",
    "the binning of the signal covariance matrix @xmath222 was chosen to be uniform in @xmath2 with bin width @xmath473 . because a single realization of the sky drawn from the model power spectrum will have individual mode powers that deviate from mean given by the power spectrum due to this intrinsic so - called `` cosmic variance '' plus the effect of the thermal instrumental noise , we analyze 387 realizations each taken from a different realization of the sky and a different set of instrumental noise deviates .",
    "the mean @xmath217 for each band @xmath347 converge to @xmath474 , which is obtained by integrating the model @xmath475 over the window functions @xmath365 ( e.g.  eq.[[eq : cbpred ] ] ) , within the sample uncertainty for the realizations .",
    "furthermore , the standard deviation of the @xmath217 from the mean for each band agrees with the value obtained from the diagonals of the inverse of the fisher matrix .",
    "the choice of the @xmath2 bin size is driven by the trade off between the desired narrow bands for localizing features in the power spectrum and the correlations between bins introduced by the transform of the primary beam .",
    "there is an anti - correlation between adjacent bands seen in @xmath476_{bb'}$ ] at the level of @xmath477% to @xmath478% for @xmath473 with a single field .",
    "we have found that correlations up to about @xmath479% give plots of the @xmath217 that are more visually appealing than those made with narrower band and higher correlation levels due to the increasing scatter in the bandpowers about the mean values .",
    "bins of this size do not achieve the best possible @xmath2-resolution , and thus our cosmological parameter runs use finer - binned bands since the correlations are taken into account in the analyses .    the band window functions @xmath480 are shown in the lower panel of figure  [ fig : mockdeep ] , and were computed using narrow binnings @xmath376 ( e.g.  eq.[[eq : wbbf ] ] ) with @xmath481 .",
    "the small - scale structures seen in the window functions , particularly visible around the peaks , are due to the differencing which introduces oscillations ( see  [ sec : difference ] ) . as shown in equation ( [ eq : winortho ] ) , a window function @xmath480 is normalized to sum to unity within the given band @xmath347 , and to sum to zero in the other bands , and thus there must be compensatory positive and negative `` sidelobes '' of the window function outside the band .",
    "figure  [ fig : mockmos ] shows the power spectrum derived for a simulated mosaic of @xmath120 fields separated by @xmath415 using the actual cbi 20h mosaics fields from paper  iii as a template .",
    "this mosaic field was chosen as it had incomplete mosaic coverage , and thus would be the most difficult test for the method .",
    "the binning for @xmath222 shown used @xmath482 , which gave adjacent band anti - correlations of @xmath483 to @xmath484 in the @xmath485 .",
    "again the mean of the 117 realizations converges to the value expected within the error bars , showing that there is no bias introduced by the method , even in the presence of substantial holes in the mosaic ( see paper  iii for the mosaic weight map ) .",
    "furthermore , the rms scatter in the realizations converges to the mean of the inverse fisher error bars , as in the single - field case . as in the previous figures ,",
    "the bandpower window functions are shown in the lower panels .    in figure",
    "[ fig : mockmosruns ] are shown three randomly chosen realizations from the ensemble , plotted along with the input power spectrum .",
    "this shows the level of field - to - field variations that we might expect to see in cbi data .",
    "there are noticeable deviations from the expected bandpowers in individual realizations , particularly at low @xmath2 where cosmic variance and the highly - correlated bins conspire to increase the scatter .",
    "these differences are within the expected scatter when bin - bin correlations and limited sample size is taken into account , but care must be exercised in interpreting single field power spectra . in particular ,",
    "the acoustic peak structures are obscured by the sample variations .",
    "however , the average bandpowers for the 3 runs ( shown in figure  [ fig : mockmosruns ] as open black circles ) are better representations of the underlying power spectrum .",
    "although this is not a proper `` joint '' maximum likelihood solution ( e.g.   [ sec : comblike ] ) as is done for the real cbi mosaic fields , the improvement seen using the 3-field average leads us to expect that the combination of even 3 mosaic fields damps the single field variations sufficiently to begin to see the oscillatory features in the cmb power spectrum .",
    "while we do not show the equivalent plots of the deep fields from figure  [ fig : mockdeep ] , the same behavior is seen ( with even larger field - to - field fluctuations in the relatively unconstrained first bin , though still consistent with the error bars ) .    the effect of adding point sources to the mock fields , and then attempting power spectrum extraction , is shown in figure  [ fig : mockdeepsrc ] .",
    "a set of 200 realizations were made in the same manner as in the runs in figure  [ fig : mockdeep ] , but the list of point source positions , flux densities and uncertainties , and spectral indices from lower frequency used in the analysis in paper  ii ( the `` nvss '' sources ) was used to add mock sources to the data .",
    "the flux density of the sources actually added to the data were perturbed using the stated uncertainties as 1-@xmath486 standard deviations .",
    "the errors used were 33% of the flux density except for a few of the brighter sources which were put in with 100% uncertainties .",
    "we then used the methodology described in  [ sec : src ] to compute the constraint matrices .",
    "the first method of correction used was to subtract the ( unperturbed ) flux densities from the visibilities , and build the @xmath174 from @xmath487 built using the uncertainties ( shown as the red triangles ) .",
    "in addition , we also did no subtraction , but built @xmath174 from @xmath487 using the full ( unperturbed ) flux densities ( shown as the blue squares ) .",
    "this is equivalent to assuming a 100% error on the source flux densities , and thus canceling the average source power in those modes . in both cases",
    "the factor @xmath280 was used .",
    "the simulations show that both methods are effective , with no discernible bias in the reconstructed cmb bandpowers .",
    "finally , the production of images using the gridded estimators described in  [ sec : image ] is demonstrated in figure  [ fig : image ] .",
    "the series of plots show the effect of wiener filtering using the noise and various signal components on an image derived from one of the mock 08h cbi deep field realizations with sources from the ensemble shown in figure  [ fig : mockdeepsrc ] .",
    "the planck factor weighting of equation ( [ eq : qtherm ] ) was used during gridding to optimize for the thermal cmb spectrum , though in practice this makes little difference due to the restricted frequency range of the cbi .",
    "the estimators for this realization were computed by subtracting the mean values of the source flux densities and putting the standard deviations into @xmath174 with @xmath280 ( the red triangles in figure  [ fig : mockdeepsrc ] ) .",
    "the filtering down - weights the high spatial frequency noise seen in the unfiltered image , and effectively separates the cmb and source components as shown by comparing panels ( c ) and ( d ) to the total signal in panel ( b ) .",
    "the signal in this realization is dominated by the residuals from two bright point sources that had 100% uncertainties put in for their flux densities and thus escaped subtraction .",
    "the effectiveness of @xmath174 in picking out the sources in the image plane underlines its utility as a constraint matrix in the power spectrum estimation .",
    "we have outlined a maximum likelihood approach to determining the power spectrum of fluctuations from interferometric cmb data .",
    "this fast gridded method is able to handle the large amounts of data produced in large mosaics such as those observed by the cbi .",
    "software encoding this algorithm was written , and tested using mock cbi data drawn from a realistic power spectrum .",
    "the results of the code were shown to converge as expected to the input power spectrum with no discernible bias . for small datasets , this code was also tested against independently written software that worked directly on the visibilities .",
    "in addition , the pipeline was run with gridding turned off as described in  [ sec : liklhd ] , again for small test data sets .",
    "no bias or significant loss in sensitivity was seen in these comparisons .",
    "this software pipeline was used to analyze the actual cbi data , producing the power spectra presented for the deep fields and mosaics in paper  ii and paper  iii respectively .",
    "the output of the pipeline also was used as the input for the cosmological parameter analysis in paper  v and the investigation of the sunyaev - zeldovich effect in paper  vi .",
    "this method is of interest for carrying out power spectrum estimation for interferometer experiments that produce a large number of visibilities but with a significantly smaller number of independent samples of the fourier plane ( such as close - packed arrays such as vsa or dasi ) .",
    "the cbi pipeline analysis is carried out in two parts , the gridding and covariance matrix construction from input uv - fits files in cbigridr and the maximum likelihood estimation of bandpowers using quadratic relaxation in mlikely .",
    "the software for the pipeline is available by contacting the authors .",
    "we close by noting that our formalism can be extended to deal with polarization data . in the case of cmb polarization ,",
    "there are as many as six different signal covariance matrices of interest in each band , with estimators ( or visibilities ) for parallel - hand and cross - hand polarization products , and thus development of a fast method such as this is critical . in september 2001 polarization capable versions of cbigridr and mlikely",
    "were written and tested .",
    "we describe the method , the polarization pipeline , and results in the upcoming paper ( myers et al .",
    "2002 , in preparation ) .",
    "stm was supported during the early years of the cbi by a alfred p.",
    "sloan fellowship from 1996 to 1999 while at the university of pennsylvania .",
    "genesis of this method by stm greatly benefited by a stay in july 2000 at the itp in santa barbara , supported in part by the national science foundation under grant phy99 - 07949 .",
    "the national radio astronomy observatory is a facility of the national science foundation operated under cooperative agreement by associated universities , inc .",
    "the cbi was funded under nsf grants ast-9413934 , ast-9802989 and ast-0098734 , with contributions by maxine and ronald linde , and cecil and sally drinkward , and the strong support of the california institute of technology , without which this project would not have been possible .",
    "in addition , this project has benefited greatly from the computing facilities available at cita , and from discussions with other members of the group at cita not represented as authors on this paper .",
    "suppose we were to construct a simple linear `` dirty '' mosaic on the sky obtained by a linear combination of the dirty ( not deconvolved ) images of the individual fields ( e.g.  @xcite ) .",
    "in the _ uv _ plane , this reduces to summing ( integrating ) up the visibilities from each mosaic `` tile '' with some weighting function , e.g. @xmath488 where for the time being we ignore the contribution from the complex conjugates of the visibilities ( see below ) . for illustrative purposes ,",
    "let us consider only a single frequency channel and write the estimator as a function @xmath121 , where @xmath403 , which in the absence of instrumental noise is given by @xmath489 with kernel @xmath490 , sky and aperture plane sampling given by @xmath491 , and where @xmath492 is the visibility at pointing position @xmath11 and _ uv _ locus @xmath493 from equation ( [ eq : visi ] ) .",
    "in practice , the sampling function is just a series of delta functions @xmath494 over the measured visibilities @xmath495 each with weight @xmath496 .    as an ansatz , we let the mosaicing kernel have the form @xmath497 where @xmath498 is the interpolating kernel . furthermore , let us assume that the _ uv_-plane coverage is the same for all mosaic pointings , and thus @xmath499 is separable @xmath500 where @xmath501 and @xmath502 are the sampling and weighting in the two domains . combining these and rearranging terms , we get @xmath503 where in equation ( [ eq : mos2 ] ) we used the fact that the final right - hand side integral in equation ( [ eq : mos2a ] ) is the fourier transform @xmath504 of the mosaic function @xmath505 .    for an infinite continuous mosaic , @xmath506 and thus @xmath507",
    "if we wish to recover @xmath508 in this limit , then @xmath509 with normalization @xmath510 will fulfill our requirements .",
    "we have chosen @xmath511 as the _ uv _ kernel as it reproduces the least - squares estimate of the sky brightness in the linear mosaic @xcite .",
    "then , equation ( [ eq : mos2 ] ) becomes @xmath512 which has a width controlled by the narrower of the width of @xmath513 or the width of @xmath504 .",
    "thus , by widening the mosaic @xmath514 to a larger area than the beam @xmath111 , we will fill in the desired information inside the @xmath68 smeared patches in the _ uv_-plane .",
    "thus , a properly sampled @xmath515 mosaic will fill in a @xmath515 sub - grid within each _ uv _ cell you would have normally had for a single pointing , and thus an @xmath515 mosaic consisting of @xmath124 `` images '' each is equivalent to a _",
    "uv _ super - grid of size @xmath516 ( e.g.  @xcite ) .",
    "note that for a non - continuous mosaic , there will be `` aliases '' in the _ uv _ plane separated by the inverse of the mosaic spacing in the sky @xcite . ideally , we would like the separation between aliased copies to be larger than the extent of the beam transform , which is satisfied for @xmath517 which for @xmath421  cm corresponds to @xmath518 at @xmath519  ghz and only @xmath520 at @xmath423  ghz , the centers of the extremal cbi bands .",
    "the spacing used in the cbi mosaics is a compromise between the aliasing limits over the bands and the desire to have a fewer number of pointings on a convenient grid .",
    "we chose to observe with pointing centers separated by @xmath415 , which is sub - optimal above @xmath521  ghz .",
    "however , the effect of aliasing is small , with the overlap point @xmath522 occurring at the @xmath523 point of @xmath68 at 31  ghz , and the @xmath524 point for the highest frequency channel at @xmath423  ghz .",
    "we obtain the gridding kernel @xmath525 of equation ( [ eq : linest ] ) corresponding to equation ( [ eq : qvu ] ) by using the discrete sampling in equation ( [ eq : fsamp ] ) @xmath526 with visibility weights @xmath496 , and normalization factor @xmath134 .",
    "the discrete form of the normalization derived in equation ( [ eq : zu ] ) is @xmath527 then , @xmath528 is the weighted sum of visibilities used for the estimators . note that because @xmath529 , there are also visibilities @xmath165 for which @xmath530 lies within the support range around @xmath129 , i.e.@xmath531 .",
    "thus , we should add in the complex conjugates @xmath532 @xmath533 to do this , we construct another kernel @xmath534 @xmath535 which will gather the appropriate @xmath532 , giving @xmath536 for the final form of our linear estimator .    for estimated visibility variances",
    "@xmath537 , the optimal weighting factor ( in the least - squares estimation sense ) is given by @xmath538 but may also include factors based on position in the mosaic or frequency channel .",
    "for example , up until now we have neglected the frequency dependence of the observed visibilities .",
    "if we are reconstructing an intensity field with a uniform flux density spectrum , then no changes need be made .",
    "if there is a frequency dependence , such as that for a power - law foreground ( e.g.  eq.[[eq : alpha ] ] ) or the thermal spectrum of the cmb ( e.g.  eq.[[eq : fplanck ] ] ) , then the visibilities should be scaled and weighted by the appropriate factor @xmath539 when gridded in order to properly estimate @xmath540 or @xmath541 respectively .",
    "for example , for the cmb using equation ( [ eq : fplanck ] ) for the spectrum , we find @xmath542 in practice for the cbi , the frequency range of the data is not great enough for the spectral weighting factor to matter , and we therefore use the default weighting given in equation ( [ eq : viswt ] ) .",
    "this will therefore be slightly non - optimal in the signal - to - noise sense ( it will not be the minimum - variance estimator ) but it will not introduce a bias in the bandpowers .",
    "the choice of the normalization @xmath134 is somewhat arbitrary , as it only determines the units of the @xmath126 and not the correlation properties .",
    "however , this can be important if we wish to use the estimators to make images using the formalism of  [ sec : image ] .",
    "for instance , the normalization given in equation ( [ eq : zi ] ) has the drawback of diverging in cells where all the @xmath543 are vanishingly small ( such as the innermost and outermost supported parts of the _ uv_-plane ) , and will produce images with heightened noise on short and long spatial wavelengths .",
    "it is therefore more convenient to use the alternate normalization @xmath544 which when inserted into equation ( [ eq : linest2 ] ) will properly normalize the weighted sums of visibilities .",
    "this will then produce images with the desired units of janskys per beam ( see  [ sec : image ] ) .",
    "we therefore use equation ( [ eq : zk1 ] ) for the normalization in our cbi pipeline .",
    "we wish to calculate @xmath312 ( cf .",
    "eq.[[eq : creskk ] ] ) using equation ( [ eq : resampint ] ) with @xmath545 . if @xmath546 is independent of flux density , then @xmath547 where we have left in the possibility that the upper flux density cutoff will depend on spectral index ( see below ) and set the lower flux density cutoff to zero ( the results for realistic power - law counts with @xmath548 are insensitive to the lower cutoff , but one can easily be included ) . as an example for the calculation of the fluctuation power due to residual sources in the gaussian limit , consider power - law integral source counts @xmath549 where @xmath550 is the mean number density of sources with flux density _ greater _ than @xmath307 at frequency @xmath46 , and a gaussian spectral index distribution at frequency @xmath46",
    "@xmath551    first consider the case where there is a fixed flux density upper cutoff @xmath305 at the frequency where the number counts are defined .",
    "the two parts of equation ( [ eq : creskk ] ) separate easily , where the source count part of the integral is @xmath552 for the distribution in equation ( [ eq : gausalpha ] ) , the integral over @xmath43 becomes @xmath553 where @xmath554 , and @xmath555 where @xmath556 is the mean of the extrapolated spectral index distribution which remains a gaussian , and the effective spectral index @xmath310 for the spectral component is shifted from the mean spectral index of the input distribution @xmath277 by the combination of the scatter in the @xmath43 and the lever arm @xmath557 from the frequency extrapolation . putting these together ,",
    "we get @xmath558    one can also deal with the case where there is an upper flux density cutoff @xmath559 imposed at a frequency @xmath560 other than @xmath46 where the @xmath561 distribution is defined . in this case , the flux density cutoff in equation ( [ eq : resampdef ] ) is @xmath562 where @xmath563 , and @xmath564 is the cutoff @xmath559 extrapolated to @xmath46 using @xmath277 .",
    "then , @xmath565 and thus @xmath566 with @xmath567 where @xmath568 gives the modification of the effective spectral index due to the change in the frequency at which the cutoff is done .",
    "one often has an upper flux density cutoff at two different frequencies .",
    "for example , sources that are extrapolated to be bright at the cmb observing frequency will have been detected and subtracted . if there is a flux density cutoff of @xmath559 imposed at a frequency @xmath560 as before , but an additional upper cutoff of @xmath569 at another frequency @xmath570 , then there is a critical spectral index @xmath571 above which the effective cutoff @xmath564 of equation ( [ eq : snumax ] ) changes from that appropriate to @xmath560 to that at @xmath570 ( assuming @xmath572 ) .",
    "thus , the integral over @xmath43 in equation ( [ eq : resampcut ] ) will be broken into two pieces , @xmath573 where @xmath574 . the quantities in @xmath575 are as defined in equations ( [ eq : snumax ] ) through ( [ eq : alphaeffhat ] ) , and the parameters in @xmath576 are defined in the same way but using the higher frequency @xmath570 .",
    "the truncated gaussian integrals are just the integrated probabilities for the normal distribution @xmath577 with @xmath578 the error function .",
    "then , @xmath579    \\label{eq : j2}\\end{aligned}\\ ] ] where @xmath580 and @xmath581 .    as an example , consider the source counts presented in paper  ii (  4.3.2 ) , with @xmath582 above @xmath583  mjy at @xmath584  ghz and @xmath585 , which gives @xmath586 as the raw source power . in the analysis described there , mason et al .",
    "find that a gaussian 1.4  ghz to 31  ghz spectral index distribution with @xmath587 and @xmath588 fits the observed data .",
    "the cbi and ovro direct measurements have a cutoff of @xmath589  mjy at 31  ghz ( sources brighter than this have been subtracted from the cbi data and have residual uncertainties placed in a source covariance matrix ) , and sources above @xmath590  mjy at @xmath591  ghz have already been accounted for in a second source matrix .",
    "therefore , the critical spectral index is @xmath592 from equation ( [ eq : alpcrit ] ) . for @xmath593 , the 31  ghz cutoff holds .",
    "since the cutoff and source distribution are at the same frequency as the observations @xmath594 , there is no extrapolation factor @xmath595 and the spectral index distribution is unchanged ( @xmath596 ) .",
    "then , @xmath597 and @xmath598 , so @xmath599          = 0.003\\,{\\rm jy}^2\\,{\\rm sr}^{-1}\\ ] ] for the flat - spectrum tail of the spectral index integral .",
    "the rest of the integral uses the 1.4  ghz cutoff , which we extrapolate using the mean spectrum to 31  ghz using equation ( [ eq : snumax ] ) , @xmath600 because @xmath595 , we have to modify the quantities in equation ( [ eq : alphaeffhat ] ) by explicitly expanding the terms in @xmath568 , and canceling remaining terms in @xmath557 , giving @xmath601 which can then be inserted into equation ( [ eq : j1 ] ) , giving @xmath602 for @xmath603 , @xmath604 , and thus we expect @xmath605 for the amplitude of the residual sources in the cbi fields . in paper",
    "ii , it is noted that there is a 25% uncertainty on @xmath606 , and more importantly the power - law slope of the source counts could conceivably be as steep as @xmath607 . taking the extreme of @xmath607",
    ", we get @xmath608 using the above procedure . we thus conservatively",
    "estimate a 50% uncertainty on the value of @xmath609 derived in this manner .",
    "note that in paper  ii we actually use the value of @xmath610 derived using a monte - carlo procedure emulating the integrals in equation ( [ eq : intj ] ) but using the actual observed distribution of source flux densities and spectral indices .",
    "the agreement between these two estimates shows the efficacy of this procedure in practice .",
    "recently , ( * ? ? ? * hm ) have independently proposed a binned _ uv_-plane method that is somewhat similar to ours , though it is more directly related to the `` optimal maps '' of @xcite .",
    "hm use a gathering mapping @xmath611 ( @xmath186 in their notation ) @xmath612 rather than our scattering kernel @xmath131 of equation ( [ eq : linop ] ) . in the hm method",
    ", the vector @xmath613 can be thought of as a set of ideal pixels in the _",
    "they show that the likelihood depends upon binned visibilities @xmath493 and noise @xmath138 @xmath614 where @xmath615 the hm kernel @xmath616 is chosen to equal 1 if the @xmath617 of visibility @xmath618 lies in cell @xmath62 , though other more complicated kernels could be imagined .",
    "the hm method will also give a calculational speedup through the reduction in number of independent gridded estimators , and the use of the method is demonstrated using simulated vsa data in their paper .                                                                        .",
    "note that both @xmath619 and its conjugate @xmath620 have overlapping support for visibility @xmath618 , and this must be taken into account in computing the covariance matrix element.[fig : support],width=624 ]"
  ],
  "abstract_text": [
    "<S> we describe an algorithm for the extraction of the angular power spectrum of an intensity field , such as the cosmic microwave background ( cmb ) , from interferometer data . </S>",
    "<S> this new method , based on the gridding of interferometer visibilities in the aperture plane followed by a maximum likelihood solution for bandpowers , is much faster than direct likelihood analysis of the visibilities , and deals with foreground radio sources , multiple pointings , and differencing . </S>",
    "<S> the gridded aperture - plane estimators are also used to construct wiener - filtered images using the signal and noise covariance matrices used in the likelihood analysis . </S>",
    "<S> results are shown for simulated data . </S>",
    "<S> the method has been used to determine the power spectrum of the cosmic microwave background from observations with the cosmic background imager , and the results are given in companion papers . </S>"
  ]
}