{
  "article_text": [
    "the classic `` lander - waterman model '' @xcite provides statistical estimates for the read coverage in a whole genome shotgun ( wgs ) sequencing experiment via the poisson approximation to the binomial distribution .",
    "although originally intended for estimating the extent of coverage when mapping by fingerprinting random clones , the lander - waterman model has served as an essential tool for estimating sequencing requirements for modern wgs experiments @xcite .",
    "although it makes a number of simplifying assumptions ( e.g. fixed fragment length and uniform fragment selection ) that are violated in actual experiments , extensions and generalizations @xcite have continued to be developed and applied in a variety of settings .",
    "the advent of `` high - throughput sequencing '' , which refers to massively parallel sequencing technologies has greatly increased the scope and applicability of sequencing experiments . with the increasing scope of experiments , new statistical questions about coverage statistics have emerged . in particular , in the context of _ sequence census methods _ , it has become important to understand the _ shape _ of coverage functions , rather than just coverage statistics at individual sites .",
    "sequence census methods @xcite are experiments designed to assess the content of a mixture of molecules via the creation of dna fragments whose abundances can be used to infer those of the original molecules .",
    "the dna fragments are identified by sequencing , and the desired abundances inferred by solution of an inverse problem .",
    "an example of a sequence census method is chip - seq . in this experiment",
    ", the goal is to determine the locations in the genome where a specific protein binds .",
    "an antibody to the protein is used to `` pull down '' fragments of dna that are bound via a process called chromatin immunoprecipitation ( abbreviated by chip ) .",
    "these fragments form the `` mixture of molecules '' and after purifying the dna , the fragments are determined by sequencing .",
    "the resulting sequences are compared to the genome , leading to a _ coverage function _ that records , at each site , the number of sequenced fragments that contained it .",
    "as with many sequence census methods , `` noise '' in the experiment leads to random sequenced fragments that may not correspond to bound dna , and therefore it is necessary to identify regions of the coverage function that deviate from what is expected according to a suitable null model .",
    "the purpose of this paper is not to develop methods for the analysis of chip - seq ( or any other sequence census method ) , but rather to present a null model for the shape of a coverage function that is of general utility .",
    "that is , we propose a definition for the shape of a fragment coverage function , and describe a random instance assuming that fragments are selected at random from a genome , with lengths of fragments given by a known distribution .",
    "the distinction between our work and previous statistical studies of sequencing experiments , is that we go beyond the description of coverage at a single location , to a description of the change in coverage along a genome .",
    "we begin by explaining what we mean by a _ coverage function_. given a genome modeled as a string of fixed length @xmath0 , a coverage function is a function @xmath1 .",
    "the interpretation of this function , is that @xmath2 is the number of sequenced fragments obtained from a sequencing experiment that cover position @xmath3 in the genome .",
    "it is important to note that @xmath0 is typically large ; for example , the human genome consists of approximately @xmath4 billion bases . because @xmath0 is very large",
    ", we replace the finite set @xmath5 with @xmath6 , and re - define a coverage function to be a function @xmath7 .",
    "this helps to simplify our analysis .",
    "we next introduce an object that describes a sequence coverage function s shape .",
    "our approach is motivated by recent applications of topology including persistent homology @xcite and the use of critical points in shape analysis @xcite .",
    "for a given coverage function @xmath8 , we will define a rooted tree , which is a particular type of directed graph with all the directed edges pointing away from the root .",
    "this tree @xmath9 is based on the _ upper - excursion sets of _ @xmath10 : @xmath11 , @xmath12 and keeps track of how the sets @xmath13 evolve as @xmath14 decreases .",
    "long paths in @xmath9 represent features of the coverage function that persist through many values of @xmath14 .",
    "specifically , for each @xmath15 , let @xmath16 denote the set of connected components of the upper - excursion set @xmath13 .",
    "we define the rooted tree @xmath17 as follows    * vertices in @xmath18 correspond to the connected components in the collection @xmath19 * @xmath20 provided their corresponding connected components @xmath21 and @xmath22 with @xmath23 satisfy @xmath24 and @xmath25 .",
    "note that the root of @xmath9 corresponds to the single connected component in @xmath26 .",
    "the tree @xmath9 is very similar to a contour tree @xcite , which is built using level sets of a function , and a join tree @xcite . indeed , suppose we ignore every vertex that is adjacent to only one vertex with greater height . then , the remaining vertices of @xmath9 correspond to ( equivalence classes of ) local extrema of @xmath10 .",
    "each local maximum of @xmath10 yields the birth of a new connected component as we sweep down through @xmath12 while a local minimum of @xmath10 merges connected components .",
    "since we do not require @xmath10 to have distinct critical values ( as is frequently assumed ) , the vertices in @xmath9 can have arbitrary degrees , as is depicted in figure [ curve - path - tree]c .    in the sequel",
    ", we will use the following equivalent characterization that can be found in @xcite . given a coverage function @xmath27 with @xmath28 and @xmath29 for @xmath30",
    ", we form an integer - valued sequence @xmath31 that records the changes in height of @xmath10 on the interval @xmath32 $ ] .",
    "the sequence @xmath31 consists of the @xmath33 values that @xmath10 travels through from @xmath34 to @xmath35 and satisfies @xmath36 such a sequence is called a _ lattice path excursion away from _ @xmath37 .",
    "next , we define an equivalence relation on the set @xmath38 by setting @xmath39 the equivalence classes under this relation are in @xmath40 correspondence with the connected components in the upper - excursion sets of @xmath41}$ ] .",
    "one equivalence class is @xmath42 , and if @xmath43 is an equivalence class with @xmath44 then @xmath45 whereas @xmath46 for @xmath47 .",
    "conversely , any index @xmath3 with @xmath48 is the minimal element of an equivalence class .",
    "we use the minimal element of each equivalence class as its representative .",
    "thus , we can view the vertices of @xmath49}}$ ] as the set @xmath50 two indices @xmath51 are adjacent in @xmath49}}$ ] provided @xmath52 and @xmath53 for @xmath54 .",
    "figure [ curve - path - tree ] gives an example of a coverage function together with its lattice path excursion @xmath55 and rooted tree .",
    "the minimal elements of each equivalence class in figure [ curve - path - tree]b are depicted with red squares .",
    "in order to model random coverage along the genome , we use a poisson process to give random starting locations to the fragments . specifically ,",
    "suppose that we have a stationary poisson point process on @xmath6 with intensity @xmath56 .",
    "at each point of the poisson point process we lay down an interval that has that point as its left end - point .",
    "the lengths of the successive intervals are independent and identically distributed with common distribution @xmath57 .",
    "we will use the notation @xmath58 for a coverage function built from this process and @xmath59 for the height at a point @xmath60 .",
    "let @xmath61 be the left - end points and @xmath62 be the corresponding lengths of intervals .",
    "the interval given by @xmath63 will cover a nucleotide @xmath64 provided @xmath65 and @xmath66 .",
    "we can view this pictorially by plotting points @xmath67 in the plane .",
    "then @xmath68the number of intervals covering @xmath64is the number of points in the triangular region below .",
    "( -2,0 )  ( 5,0 ) ; ( 2,0 )  ( 2,4 ) ; ( 2,0 )  ( -2,4 ) node[midway , sloped , below ] @xmath69 ; ( 2,0 )  ( 2,4 )  ( -2,4 )  cycle ; ( 2 cm,2pt )  ( 2 cm,-3pt )",
    "node[anchor = north ] @xmath64 ; ( 4,2.5 ) node[anchor = north ] @xmath70-plane ;    we now recall the definition of a two - dimensional poisson process and refer the reader to @xcite or @xcite for the details .",
    "suppose @xmath71 is a locally finite measure on the borel @xmath72-algebra @xmath73 .",
    "a random countable subset @xmath74 of @xmath75 is called a _ non - homogeneous poisson process with mean measure _",
    "@xmath71 if , for all borel subsets @xmath76 , the random variables @xmath77 satisfy :    1 .",
    "@xmath78 has the poisson distribution with parameter @xmath79 , and 2 .",
    "if @xmath80 are disjoint borel subsets of @xmath75 , then @xmath81 are independent random variables .",
    "the following theorem is a consequence of ( * ? ? ?",
    "* proposition 12.3 ) .",
    "[ poissonthm ] the collection @xmath82 of points obtained as described above is a non - homogeneous poisson process with mean measure @xmath83 . here",
    "@xmath84 is lebesgue measure on @xmath6 .",
    "we compute the expected value @xmath85=\\rho \\ , m \\otimes \\mu(\\mbox{wedge}):$ ] @xmath86      we treat the simplest case first , namely the case where the distribution @xmath57 of fragment lengths is exponential with rate @xmath87 .",
    "then , we have @xmath88 , and @xmath89    the process @xmath58 is a stationary , time - homogeneous markov process .",
    "it is clear that @xmath58 is stationary because of the manner in which it is constructed from a poisson process on @xmath75 that has a distribution which is invariant under translations in the @xmath60 direction ; that is , the random set @xmath90 has the same distribution as @xmath91 for any fixed @xmath92 .",
    "since @xmath57 is exponential , it is memoryless , meaning for any interval length @xmath93 with an exponential distribution @xmath94 this means that probability that an interval covers @xmath95 knowing that it covers @xmath96 is the same as the probability that an interval starting at @xmath96 covers @xmath95 .",
    "thus , the probability that @xmath97 given @xmath59 for @xmath98 only depends on the value of @xmath99 .",
    "indeed , in terms of time , @xmath100 depends only on @xmath101 .",
    "more specifically , x is a birth - and - death process with birth rate @xmath102 in all states @xmath103 and death rate @xmath104 in state @xmath105 .",
    "note that as the exponential distribution is the only distribution with the memoryless property , we lose the markov property when @xmath57 is not exponential .    to build the tree of [ treesection ] , we are interested in the jumps of the coverage function @xmath106 .",
    "we hence consider the jump chain of @xmath58 a discrete - time markov chain with transition matrix @xmath107 suppose now we have a lattice path excursion starting at @xmath37 . given a vertex @xmath108 of the associated tree at height @xmath103 , we are interested in the number of offspring ( at height @xmath109 ) of this vertex .",
    "suppose @xmath110 is the minimal equivalence class representative for vertex @xmath108 , and suppose @xmath111=\\{i_0 , i_1 , \\cdots , i_n\\}$ ] with @xmath112 .",
    "then , we have @xmath113 for @xmath114 , @xmath115 for @xmath116 , @xmath117 , and @xmath118 for @xmath119 with @xmath120 some @xmath121 . from the markov property , for @xmath122 , @xmath123 and @xmath124 .",
    "the resulting tree is a galton - watson tree with generation - dependent offspring distributions ( see @xcite for more on galton - watson trees ) .",
    "indeed , we have @xmath125 which is the probability of @xmath126 failures before the first success in a sequence of independent bernoulli trials where the probability of success equals @xmath127 .",
    "suppose that we have a general distribution @xmath57 for the fragment lengths .",
    "we observe @xmath58 at some fixed `` time ''  which might as well be @xmath37 because of stationarity , and ask for the conditional probability given @xmath128 that the next jump of @xmath58 will be upwards . we know from the above that if @xmath57 is exponential with rate @xmath87 , then conditional on @xmath129 this is @xmath130 .",
    "let @xmath131 denote the time until the next segment comes along .",
    "this random variable has an exponential distribution with rate @xmath56 and is independent of @xmath128 @xcite .",
    "if we condition on @xmath129 , the two - dimensional poisson point process must have @xmath103 points in the region @xmath132    ( -4,0 )  ( 4,0 ) ; ( 2,0 )  ( -2,4 ) ; ( 0,0 )  ( 0,4 ) ; ( 0,0 )  ( -4,4 ) ; ( 0,0 )  ( 0,2 ) ",
    "( -2,4)(-4,4 )  cycle ; ( 0,2 ) ",
    "( 0,4)(-2,4 )  cycle ; ( 0cm,2pt )  ( 0 cm,-3pt ) node[anchor = north ] @xmath37 ; ( 2 cm,2pt )  ( 2 cm,-3pt ) node[anchor = north ] @xmath131 ; ( 3,2.5 ) node[anchor = north ] @xmath70-plane ; ( 3pt,2 cm )  ( -3pt,2 cm ) node[anchor = south west ] @xmath131 ;    conditionally , these @xmath103 points in @xmath76 have the same distribution as @xmath103 points chosen at random in @xmath76 according to the probability measure @xmath133 however , in order that the next jump after @xmath37 is upwards , the two - dimensional poisson point process must have no points in the orange region @xmath134 as these segments end before time @xmath131 .",
    "this leaves the @xmath103 points lying in the blue region @xmath135 which occurs with probability @xmath136 thus , conditional on @xmath129 , the probability that the next jump will be upwards is @xmath137 write @xmath138 for this quantity . a reasonable approximation to the jump skeleton @xmath139 of @xmath58",
    "is to take it be a discrete - time markov chain on the nonnegative integers with transition probabilities @xmath140 the resulting tree is then a galton - watson tree with generation dependent offspring distributions , where @xmath141    suppose @xmath57 is the point mass at @xmath142 ( that is , all segment lengths are @xmath142 )",
    ". then @xmath143 and @xmath144 this gives @xmath145 where @xmath146 $ ] .",
    "we integrate by parts and find that @xmath147 where @xmath148 which yields the recursion @xmath149 solving explicitly , we obtain @xmath150",
    "our observation that randomly sequenced fragments from a genome form a planar poisson process in @xmath151 coorindates has implications beyond the coverage function analysis performed in this paper .",
    "for example we have found that the visualization of sequencing data in this novel form is useful for quickly identifying instances of sequencing bias by eye , as it is easy to `` see '' deviations from the poisson process .",
    "an example is shown in figure [ visual ] where fragments from an illumina sequencing experiment are compared with an idealized simulation ( where the fragments are placed uniformly at random ) . specifically , paired - end reads from an rna - seq experiment conducted on a gaii sequencer were mapped back to the genome and fragments inferred from the read end locations .",
    "bias in the sequencing is immediately visible , likely due to non - uniform pcr amplification @xcite and other effects .",
    "we hope that others will find this approach to visualizing fragment data of use .    )",
    "( b ) the spatial poisson process resulting from fragments with the same length distribution as ( a ) but with position sampled uniformly at random.,title=\"fig:\",width=576 ] [ visual ]    the `` shape '' we have proposed for coverage functions was motivated by persistence ideas from topological data analysis ( tda ) . in the context of tda ,",
    "our setting is very simple ( 1-dimensional ) , however unlike what is typically done in tda , we have provided a detailed probabilistic analysis that can be used to construct a null hypothesis for coverage - based test statistics .",
    "for example , we envision computing test statistics @xcite based on the trees constructed from coverage functions and comparing those to the statistics expected from the galton - watson trees . it should be interesting to perform similar analyses with high - dimensional generalizations for which we believe many of our ideas can be translated .",
    "there are also biological applications , for example in the analysis of pooled experiments where fragments may be sequenced from different genomes simultaneously .    indeed",
    ", we believe that the study of sequence coverage functions that we have initiated may be of use in the analysis of many sequence census methods .",
    "the number of proposed protocols has exploded in the past two years , as a result of dramatic drops in the price of sequencing .",
    "for example , in january 2010 , the company illumina announced a new sequencer , the hiseq 2000 , that they claim `` changes the trajectory of sequencing '' and can be used to sequence 25 gb per day . although technologies such as the hiseq 2000 were motivated by human genome sequencing a surprising development has been the fact that the majority of sequencing is in fact being used for sequence census experiments @xcite .",
    "the vast amounts of sequence being produced in the context of complex sequencing protocols , means that a detailed probabilistic understanding of random sequencing is likely to become increasingly important in the coming years .",
    "sne is supported in part by nsf grant dms-0907630 and vh is funded by nsf fellowship dms-0902723 .",
    "we thank adam roberts for his help in making figure 4 .",
    "lp proposed the problem of understanding the random behaviour of coverage functions in the context of sequence census methods .",
    "vh investigated the jump skeleton based on ideas from topological data analysis .",
    "se developed the probability theory and identified the relevance of theorem 3.0.1 .",
    "sne , vh and lp worked together on all aspects of the paper and wrote the manuscript .",
    "herbert edelsbrunner , john harer , and afra zomorodian .",
    "hierarchical morse - smale complexes for piecewise linear 2-manifolds . , 30(1):87107 , 2003 .",
    "acm symposium on computational geometry ( medford , ma , 2001 )",
    ".      dean  h. fearn .",
    "galton - watson processes with generation dependence . in _ proceedings of the sixth berkeley symposium on mathematical statistics and probability ( univ .",
    "california , berkeley , calif .",
    ", 1970/1971 ) , vol .",
    "iv : biology and health _ , pages 159172 , berkeley , calif . , 1972 .",
    "california press ."
  ],
  "abstract_text": [
    "<S> _ background : _ we study the statistical properties of fragment coverage in genome sequencing experiments . in an extension of the classic lander - waterman model , we consider the effect of the length distribution of fragments . we also introduce the notion of the _ shape _ of a coverage function , which can be used to detect abberations in coverage . the probability theory underlying these problems is essential for constructing models of current high - throughput sequencing experiments , where both sample preparation protocols and sequencing technology particulars can affect fragment length distributions . </S>",
    "<S> +   + _ results : _ we show that regardless of fragment length distribution and under the mild assumption that fragment start sites are poisson distributed , the fragments produced in a sequencing experiment can be viewed as resulting from a two - dimensional spatial poisson process . </S>",
    "<S> we then study the jump skeleton of the the coverage function , and show that the induced trees are galton - watson trees whose parameters can be computed . </S>",
    "<S> +   + _ conclusions : _ our results extend standard analyses of shotgun sequencing that focus on coverage statistics at individual sites , and provide a null model for detecting deviations from random coverage in high - throughput sequence census based experiments . by focusing on fragments , we are also led to a new approach for visualizing sequencing data that should be of independent interest . </S>"
  ]
}