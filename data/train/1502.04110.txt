{
  "article_text": [
    "as our ability to image neurons with light and electron microscopes improves , so does our understanding of their form and function .",
    "today we can image large volumes of both live and fixed brain tissue across a wide range of resolutions . at the micrometer scale ,",
    "light microscopy ( lm ) of fluorescently labeled structures reveals dendrites and axons of a subset of neurons that can potentially be reconstructed revealing their complex 3d network , as shown in fig .",
    "[ fig : correlative](b ) . however , their internal structures and all their surrounding elements remain invisible when using this technique . to see them",
    ", one must turn to electron microscopes ( em ) .",
    "these provide images at the nanometer scale making it possible to visualize all the structural elements and especially those that are important for understanding the basic connectivity and activity of different cells .",
    "these include synapses , dendritic spines , vesicles , and mitochondria , as depicted by fig .",
    "[ fig : correlative](c ) .    these recent technologies will therefore provide crucial information about the structural , functional , and plasticity principles that govern neural circuits . and",
    "since most neurological and psychiatric disorders involve deviations from these principles , such an understanding is key to treating them",
    ". furthermore , neural circuits exhibit a computational power that no known technology can match .",
    "a more thorough understanding of their complexities could therefore spur development of new paradigms and bio - inspired devices that would far outperform existing ones .",
    "however , a major bottleneck stands in the way of this promise : these new microscopes can produce terabytes upon terabytes of image data that is so rich and so complex that humans can not analyze them effectively in their entirety . in this paper",
    ", we will briefly present the algorithms we have developed at epfl to automatically recover the dendritic and axonal trees , segment intra - neuronal structures from em images , and register the resulting models . for further details ,",
    "we refer the interested reader to the original publications .",
    "resolution acquired using a 2-photon microscope .",
    "( c ) image slice of a sub - volume at the @xmath0 resolution above a reconstruction of a neuron , dendrite , and associated organelles .",
    ", title=\"fig : \" ] + ( a ) ( b ) ( c )",
    "the automated delineation of curvilinear structures has been investigated since the inception of the field of computer vision in the 1960s and 1970s . nevertheless , despite decades of sustained effort",
    ", full automation remains elusive when the image data is as noisy and the structures exhibit as complex a morphology as they do in microscopy data . as a result , practical systems still require extensive manual intervention that is both time - consuming and tedious . for example , in the diadem challenge to map nerve cells , the results of all the finalists still required substantial time and effort to proofread and correct  @xcite .",
    "part of the problem comes from the fact that many existing techniques rely mostly on weak local image evidence , and employ greedy heuristics that can easily get trapped in local minima . as a result , they lack robustness to imaging noise and artifacts .",
    "another common issue is that curvilinear networks are usually treated as tree - like structures without any loops . in practice , however , many interesting networks are not trees since they contain cycles .",
    "furthermore , even among those that really are trees , such as neurites , the imaging resolution is often so low that the branches appear to cross , thus introducing several spurious cycles that can only be recognized once the whole structure has been recovered .",
    "in fact , this is reported as one of the major sources of error in  @xcite and a number of heuristics have been proposed to avoid spurious connections in  @xcite .",
    "in our work , we attempt to overcome these limitations by formulating the reconstruction problem as one of solving an integer program ( ip ) on a graph of potential tubular paths . as shown in fig .",
    "[ fig : delinmethod ] , the resulting algorithm goes through the following steps :     + ( a ) ( b ) ( c )    * we first compute a _ tubularity _ value at each image location and radius value .",
    "it quantifies the likelihood that there exists a tubular structure of this radius at that location .",
    "given an 3d stack , this creates an 4d scale - space tubularity volume .",
    "* we select regularly spaced high - tubularity points as seed points and connect pairs of them that are within a given distance from each other .",
    "this results in a directed tubular graph , such as those shown in fig .",
    "[ fig : delinmethod](b ) , which serves as an overcomplete representation for the underlying curvilinear networks . * having trained a path classifier using such graphs and ground - truth delineations , we assign probabilistic weights to pairs of consecutive edges of a given graph at detection time .",
    "* we use these weights and solve an integer program to compute the maximum - likelihood directed subgraph of this graph to produce a final result such as the one of fig .",
    "[ fig : delinmethod](c ) .",
    "these four steps come in roughly the same sequence as those used in most algorithms that build trees from seed points , as in  @xcite , but with three key differences .",
    "first , whereas heuristic optimization algorithms such as mst followed by pruning or the k - mst algorithm of  @xcite offer no guarantee of optimality , our approach guarantees that the solution is within a small tolerance of the global optimum .",
    "second , our approach to scoring individual paths using a classifier instead of integrating pixel values as usually done gives us more robustness to image noise and provides peaky probability distributions , which helps ensure that the global optimum is close to the ground truth .",
    "finally , instead of constraining the subgraph to be a tree as many state - of - the - art approaches , we allow it to contain cycles and instead penalize spurious junctions and early branch terminations as described in more details in  @xcite .      here",
    ", we demonstrate the effectiveness of our approach on the two datasets depicted in fig .  [",
    "fig : delinmethod ] :    * _ confocal - axons _ , 8 image stacks of olfactory projection fibers ( opf ) of the drosophila fly acquired using a 3d confocal microscope and taken from the diadem competition . *",
    "_ brightfield _ : 6 image stacks were acquired by brightfield microscopy from biocytin - stained rat brains .    in both datasets ,",
    "the neurites form tree structures without cycles . however , in the latter , disjoint branches appear to cross , introducing false loops , due to the low z - resolution . in both cases , we used half the stacks for training and half for testing .",
    "we used a semi - automated delineation tool  @xcite to extract ground truth tracings from the training stacks and train our path - classifiers .    in table",
    "[ tab : diadem_opf ] , we compare our approach ( ours ) to several state - of - the - art algorithms on the confocal - axons .",
    "they are the pruning - based approach ( app2 ) of  @xcite , the active contour algorithm ( osnake ) of  @xcite , the neuronstudio ( ns ) software of  @xcite , the focus - based depth estimation method ( focus ) of  @xcite , and finally the k - mst technique of  @xcite , the last two of which were finalists in the diadem competition .",
    "for all these algorithms , we used the implementations provided by their respective authors with default parameters .",
    "we report diadem scores as described in  @xcite , which were designed to compare topological accuracy of a reconstructed tree against a ground truth tree .",
    "we also evaluated the app2  @xcite , osnake  @xcite , and focus  @xcite algorithms on the brightfield dataset .",
    "since they do not allow the user to provide multiple root vertices , the diadem score of their output can not be computed . to compare their algorithms to ours",
    ", we therefore used the netmets measure of  @xcite instead because it does not rely heavily on roots .",
    "as the diadem metric , this measure takes as input the reconstruction and the corresponding ground truth tracings .",
    "however , it is more local because it does not account for network topology .",
    "table  [ tab : netmets_br ] shows the netmets scores on the test images of the _ brightfield _ dataset .",
    "note that the focus algorithm of  @xcite is specifically designed for brightfield image stacks distorted by a point spread function .",
    "our approach nevertheless brings about a systematic improvement except in one case ( brf@xmath1 - connectivity fpr ) .",
    "however , the algorithm does that best in this category does significantly worse in the other three .",
    "to observe the connectivity between neurons electron microscopy is required . in our work , we have used focus ion beam scanning electron microscopy ( fibsem ) at a @xmath2 nearly isotropic sampling .",
    "the resulting image stacks reveal the fine neuronal structures , including the synaptic contacts . however",
    ", segmenting em data poses unique challenges in part because the volumes are heavily cluttered with structures that exhibit similar textures and are therefore difficult to distinguish based solely on local image statistics . in this section ,",
    "we outline our approach to segmenting both synapses and mitochondria .",
    "they are described in more details in  @xcite .",
    "synapses are difficult to distinguish from other structures based solely on local texture , as shown in fig .",
    "[ fig : synapseresults ] .",
    "human experts confirm their presence by looking for nearby for post - synaptic densities and vesicles .",
    "this protocol can not be emulated simply by measuring filter responses at the target voxel as in  @xcite , pooling features into a global histogram as in  @xcite or relying on hand - determined locations for feature extraction as in  @xcite .    to emulate this human ability , we designed features we call _ context features _ , which can be extracted in any cube contained within a large volume centered on the voxel to be classified at 3d location @xmath3 with local orientation @xmath4 , as depicted in fig .",
    "[ fig : featurelocation](b ) .",
    "they are computed in several image channels using a number of gaussian kernels .",
    "this yields more than @xmath5 potential features and we rely on adaboost to select the most discriminative ones .",
    "+ ( a ) ( b )              we evaluated our method on three different em stacks acquired from different regions of the adult rat brain , the somatosensory cortex , the hippocampus , and the cerebellum .",
    "example slices from each dataset are shown in fig .",
    "[ fig : synapseresults ] along with our results .    to evaluate the performance of our approach and compare it to that of  @xcite",
    ", we performed a voxel - wise evaluation against manually acquired ground - truth data . to discount the influence of boundary voxels",
    "whose classification may be ambiguous , we defined a testing exclusion zone around the labeled border of the synapse within a distance of @xmath6 .",
    "the voxels within that exclusion zone are ignored and , in fig .",
    "[ fig : synapsevocs ] , we plot the jaccard index between the ground - truth labeling and the one the two algorithms produce as a function of @xmath6 . to highlight the importance of using context , we plot a third curve that correspond to our approach using only boxes centered on the voxel to be classified , which is much worse than the other two .",
    "mitochondria participate in a wide range of cellular functions and their morphology and localization play a key role in cellular physiology  @xcite .",
    "furthermore , localization and morphology of mitochondria have been tightly linked to neural functionality .",
    "for example , pre- and post - synaptic presence of mitochondria is known to have an important role in synaptic function , as shown in  @xcite , and mounting evidence also indicates a close link between mitochondrial function and many neuro - degenerative diseases  @xcite .    new approaches to detecting mitochondria in em images",
    "have therefore begun to appear .",
    "for example , in  @xcite a gentle - boost classifier was trained to detect them based on textural features . in  @xcite , texton - based mitochondria classification in melanoma cells was performed using a variety of classifiers including k - nn , svm , and adaboost .",
    "while these techniques achieve reasonable results , they incorporate only textural cues while ignoring shape information .",
    "more recently , more sophisticated features have been successfully used in  @xcite in conjunction with either a random forest classifier as in  @xcite .",
    "the algorithm of  @xcite could be used to impose higher - order shape constraints but would be very difficult to extend to 3d volume segmentation because its computational requirements are prohibitive .",
    "our approach overcomes this limitation and extends these earlier techniques by explicitly modeling membranes and exploiting the power of our context features in a structured svm framework  @xcite .      to reduce the computational complexity ,",
    "our first step of our approach is to over - segment the image stack into _ supervoxels _ , that is , small voxel clusters with similar intensities .",
    "we use the algorithm of  @xcite to compute them .",
    "it lets us choose their approximate diameter , which we take to be on the order of the known thickness of the outer mitochondrial membranes .",
    "this means that membranes are typically one supervoxel thick .",
    "all subsequent computations are performed on supervoxels instead of individual voxels , which speeds them up by several orders of magnitude .",
    "our task is now to classify these supervoxels as being inside the mitochondria , part of the membrane , or outside , as shown in fig .",
    "[ fig : mitochondria](b ) .    to this end",
    ", we introduce a three - class conditional random field ( crf )  @xcite .",
    "it is defined over a graph @xmath7 whose nodes @xmath8 correspond to supervoxels and whose edges @xmath9 connect nodes @xmath10 and @xmath11 if they are adjacent in the 3d volume .",
    "each node is associated to a feature vector @xmath12 computed from the image data and a label @xmath13 denoting one of the three classes to which a supervoxel can belong .",
    "let @xmath14 be the vector of all @xmath13 , which we will refer to as a _",
    "labeling_. the most likely labeling of a volume is then found by minimizing an objective function of the form @xmath15 where @xmath16 is referred to as the unary data term and @xmath17 as the pairwise term .",
    "the superscript denotes the dependency of these two terms to a parameter vector @xmath18 .",
    "the unary data term @xmath16 is taken to be a kernelized function of the context features of section  [ sec : synapseapproach ] .",
    "the pairwise term is a linear combination of a spatial regularization term and a containment term .",
    "the spatial term is learned from data and reflects the transition cost between nodes @xmath10 and @xmath11 from label @xmath13 to label @xmath19 .",
    "the containment term constrains the membrane class to completely enclose the inside class and to be at least one supervoxel thick , as originally proposed in  @xcite .",
    "this containment term is hand - defined and does not depend on any parameters .",
    "the set of parameters @xmath18 to be learned are therefore the weights given to individual features in the unary term and the spatial regularization term .",
    "these parameters are learned within the structured svm framework discussed above , which requires solving an inference problem on the supervoxel graph @xmath20 .",
    "+ ( a ) ( b ) ( c ) ( d )    fig .",
    "[ fig : mitochondria](c ) depicts the 3d reconstructions we obtained from a @xmath21 volume . in fig .",
    "[ fig : mitochondria](d ) , we show the same results after having been proof - read and hand - corrected by a trained neuroscientist .",
    "the whole process , including generating the training data , took a little under 2 hours . for comparison purposes , the neuroscientist re - generated these results entirely manually and that took him about 6 hours for a similar level of precision in terms of the mitochondria volumes and surface areas , which are the relevant biological quantities .",
    "in other words , automation reduced the required amount of manual intervention by a factor 3 .",
    "going further will require deploying tools based on deformable models such as those of  @xcite to automatically refine mitochondria boundaries and break apart incorrectly merged ones .",
    "[ cols=\"<,^,^,^,^,^,^,<\",options=\"header \" , ]      +    to further quantify the performance of our approach , we compared it against other recent automatic methods on image stacks from the hippocampus and striatum , which are similar to those we used to detect synapses . in table",
    "[ tab : mitochondriaj ] , we report the jaccard index for the foreground and membrane class jointly , which is representative for this task since whole mitochondria are the object of interest being segmented . the first one is a very recent mitochondria segmentation method  @xcite that does _ not _ rely on structured learning .",
    "instead , it trains a cascade of classifiers at different scales and has been shown to outperform earlier algorithms based on neural networks , svms , and random forests on em imagery .",
    "the others correspond to different approaches to performing structured learning .",
    "as can be seen , we consistently outperform the competing methods .",
    "registering lm and em stacks such as those of fig .  [",
    "fig : correlative](b , c ) is required to identify the same region in both images and to combine the specific information each modality provides , as discussed earlier .",
    "however , this is challenging because the scale - discrepancy between the two modalities@xmath22 for em vs @xmath0 for lm  produces drastic appearance changes .",
    "it makes it impractical to use standard registration techniques that rely on maximizing image similarity , such as those described in  @xcite .    instead",
    ", we have proposed in  @xcite a new approach for matching graph structures embedded in 3d volumes , which can deal with the scale - change while being robust to topological differences between the two graphs and even changes in the distances between vertices , unlike earlier graph - matching techniques such as those of  @xcite .",
    "it requires no initial position estimate , can handle non - linear deformations , and does not rely on local appearance or global distance matrices . instead , given graphs extracted from the two images or image - stacks to be registered , we treat graph nodes as the features to be matched .",
    "we model the geometric mapping from one data set to the other as a gaussian process whose predictions are progressively refined as more correspondences are added .",
    "these predictions are in turn used to explore the set of all possible correspondences starting with the most likely ones , which allows convergence at an acceptable computational cost even though no appearance information is available .",
    "given graphs @xmath23 and @xmath24 extracted from image - stacks @xmath25 and @xmath26 , let the @xmath27s denote edges and the @xmath28s nodes .",
    "the edges , in turn , are represented by dense sets of points forming 3d paths connecting the nodes .",
    "our goal is to use these two graphs to find a geometrical mapping @xmath29 from @xmath25 to @xmath26 such that @xmath30 is as close as possible to @xmath31 in the least - squares sense assuming that @xmath32 and @xmath31 are corresponding voxels .",
    "if correspondences between points belonging to the two graphs were given , we could directly use the gaussian process regression ( gpr ) as in  @xcite to estimate a non - linear mapping that would yield a  prediction of @xmath29 and its associated variance . in our case , however , the correspondences are initially unavailable and can not be established on the basis of local image information because the @xmath25 and @xmath26 are too different in appearance . in short , this means that we must rely only on geometrical properties to simultaneously establish the correspondences and estimate the underlying non - linear transform . since attempting to do this directly for all edge points",
    "would be computationally intractable , our algorithm goes through the following two steps :    1 .   *",
    "coarse alignment : * we begin by only matching graph nodes so that the resulting mapping is a combination of an affine deformation and a smooth non - linear deformation .",
    "we initialize the search by randomly picking d correspondences , which roughly fixes relative scale and orientation , and using them to instantiate a  gaussian process ( gp ) .",
    "we then recursively refine it as follows : given some matches between @xmath33 and @xmath34 nodes , the gp serves to predict where other @xmath33 nodes should map and restricts the set of potential correspondences . among these possibilities ,",
    "we select the most promising one and use it to refine the gp . repeating this procedure recursively until enough mutually consistent correspondences have been established and backtracking when necessary lets us quickly explore the set of potential correspondences and recover an approximate geometric mapping .",
    "* fine alignment : * having been learned only from potentially distant graph nodes , the above - mapping is coarse . to refine it",
    ", we also establish correspondences between points that form the edges connecting the nodes in such a way that distances along these edges , which we will refer to as _ geodesic _ distances , are changed as little as possible between the two graphs .",
    "because there are many more such points than nodes , this would be extremely expensive to do from scratch .",
    "therefore , we constrain the correspondence candidates to edges between already matched nodes and rely on the hungarian algorithm of  @xcite to perform the optimal assignment quickly",
    ".       + ( a)(b)(c)(d)(e )    fig .  [ fig : register ] illustrates the two stages of our approach applied to the em and lm stacks of fig .",
    "[ fig : correlative ] .",
    "even though the two images look extremely different , our algorithm returns a non - rigid deformation that lets us correctly superpose the two stacks .",
    "the technique is generic and allows us to correctly align other biological structures , such as blood - vessels networks , that are non - linearly transformed and extracted with different techniques , without having to pre - aligning them and in a manageable amount of time .",
    "if we are ever to unravel the mysteries of brain function at its most fundamental level , we will need a precise understanding of how neurons connect to each other . with the advent of new high - resolution light and electron microscopes , fast computers , and high - capacity storage media , the data required to perform this task is now becoming available .",
    "electron microscopes ( em ) can now provide the nanometer resolution that is needed to image synapses , and therefore connections , while light microscopes ( lm ) see at the micrometer resolution required to model the 3d structure of the dendritic network . since both the arborescence and the connections are integral parts of the wiring diagram , combining these two modalities is critically important to answer a growing need for automated quantitative assessment of neuron morphology and connectivity .    here",
    ", we have reviewed our approach to addressing this daunting task .",
    "our algorithms are effective at delineating linear structures in lm , segmenting mitochondria and synapses in em , and putting the results into a unified coordinate systems to produce a joint representation .",
    "however , we have so far only modeled small fractions of cells , which only represent minute parts of simple neural circuit .",
    "our challenge therefore is now to scale up our methods so that they can handle much larger volumes , which will involve parallelizing them and using gpus , instead of cpus , to massively increase the processing speed ."
  ],
  "abstract_text": [
    "<S> if we are ever to unravel the mysteries of brain function at its most fundamental level , we will need a precise understanding of how its component neurons connect to each other . </S>",
    "<S> electron microscopes ( em ) can now provide the nanometer resolution that is needed to image synapses , and therefore connections , while light microscopes ( lm ) see at the micrometer resolution required to model the 3d structure of the dendritic network . </S>",
    "<S> since both the topology and the connection strength are integral parts of the brain s wiring diagram , being able to combine these two modalities is critically important .    </S>",
    "<S> in fact , these microscopes now routinely produce high - resolution imagery in such large quantities that the bottleneck becomes automated processing and interpretation , which is needed for such data to be exploited to its full potential . in this paper , we briefly review the computer vision techniques we have developed at epfl to address this need . </S>",
    "<S> they include delineating dendritic arbors from lm imagery , segmenting organelles from em , and combining the two into a consistent representation . </S>"
  ]
}