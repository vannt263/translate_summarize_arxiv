{
  "article_text": [
    "this is the fourth paper in a series , where we investigate non - archimedean group actions , length functions and infinite words . in @xcite lyndon",
    "introduced real - valued length functions as a tool to carry over nielsen cancelation theory from free groups to a more general setting ( see also @xcite ) . some results in this direction",
    "were obtained in @xcite . in @xcite chiswell described a crucial construction which shows that a group with a real - valued length function has an action on an @xmath5-tree , and vice versa . later",
    ", morgan and shalen realized that a similar construction holds for an arbitrary group with a lyndon length function which takes values in an arbitrary ordered abelian group @xmath0 ( see @xcite ) .",
    "in particular , they introduced @xmath0-trees as a natural generalization of @xmath5-trees which they studied in relation with thurston s geometrization program .",
    "thus , actions on @xmath0-trees and lyndon length functions with values in @xmath0 are two equivalent languages describing the same class of groups . in the case when the action is free ( the stabilizer of every point is trivial ) we call groups in this class @xmath0-free .",
    "we refer to the book @xcite for a detailed discussion on the subject .",
    "one of the major events in combinatorial group theory in 1970 s was the development of bass - serre theory .",
    "we refer to the book @xcite , where serre laid down fundamentals of the theory of groups acting freely on simplicial trees",
    ". in particular , bass - serre theory makes it possible to extract information about the structure of a group from its action on a simplicial tree .",
    "alperin and bass @xcite developed the initial framework of the theory of group actions on @xmath0-trees and stated the fundamental research goals : find the group theoretic information carried by an action ( by isometries ) on a @xmath0-tree ; generalize bass - serre theory to actions on arbitrary @xmath0-trees .",
    "a joint effort of several researchers culminated in a description of finitely generated groups acting freely on @xmath5-trees @xcite , which is now known as rips theorem : a finitely generated group acts freely on an @xmath5-tree if and only if it is a free product of free abelian groups and surface groups ( with an exception of non - orientable surfaces of genus @xmath6 , and @xmath7 ) .",
    "the key ingredient of this theory is the so - called `` rips machine '' , the idea of which comes from makanin s algorithm for solving equations in free groups ( see @xcite ) .",
    "the rips machine appears in applications as a general tool that takes a sequence of isometric actions of a group @xmath1 on some `` negatively curved spaces '' and produces an isometric action of @xmath1 on an @xmath5-tree as the gromov - hausdorff limit of the sequence of spaces .",
    "free actions on @xmath5-trees cover all archimedean actions , since every group acting freely on a @xmath0-tree for an archimedean ordered abelian group @xmath0 also acts freely on an @xmath5-tree .",
    "in the non - archimedean case there are only partial results for particular choices of @xmath0 .",
    "first of all , in @xcite bass studied finitely generated groups acting freely on @xmath8-trees with respect to the right lexicographic order on @xmath9 . in this case",
    "it was shown that the group acting freely on a @xmath9-tree splits into a graph of groups with @xmath10-free vertex groups and maximal abelian edge groups .",
    "next , guirardel ( see @xcite ) obtained the structure of finitely generated groups acting freely on @xmath11-trees ( with the lexicographic order ) . in @xcite",
    "the authors described the class of finitely generated groups acting freely and regularly on @xmath12-trees in terms of hnn - extensions of a very particular type .",
    "the importance of regular actions becomes clear from the results of @xcite , where we proved that a finitely generated group acting freely on a @xmath12-tree is a subgroup of a finitely generated group acting freely and regularly on a @xmath13-tree for @xmath14 , and the paper @xcite , where is was shown that a group acting freely on a @xmath0-tree ( for arbitrary @xmath0 ) can always be embedded in a length - preserving way into a group acting freely and regularly on a @xmath0-tree .",
    "in this paper we give a partial solution ( for finitely presented groups ) of the following main problem of the alperin - bass program .",
    "* problem . *",
    "_ describe finitely presented ( finitely generated ) @xmath0-free groups for an arbitrary ordered abelian group @xmath0 .",
    "_    nowadays , the geometric method of group actions seems much more in use than the length functions , even though the nielsen theory still gives very powerful results ( see the discussion in @xcite ) .",
    "there are several reasons for this .",
    "firstly , the lyndon s abstract axiomatic approach to length functions is less intuitive than group actions .",
    "secondly , the current development of the abstract nielsen theory is incomplete and insufficient  one of the principal notions of complete actions and regular length functions were not in use until recently .",
    "thirdly , and this is crucial , an abstract analog of the rips machine for length functions with values in @xmath5 ( or an arbitrary @xmath0 ) was not introduced or developed enough to be used easily in applications .",
    "notice , that in the case of @xmath15 the completeness and regularity come for free , so there was no need for axiomatic formalization and it went mostly unnoticed .",
    "the regularity axiom appeared first in @xcite as a tool to deal with length functions in @xmath12 ( with respect to the lexicographic order ) . on the other hand , an analog of the rips machine for @xmath15 did exist for a long time  the original makanin - razborov process @xcite for solving equations in free groups .",
    "but it was not recognized as such until @xcite , where it was used systematically to get splittings of groups .",
    "introduction of infinite @xmath0-words in @xcite gives another approach to group actions .",
    "every group admitting a faithful representation by @xmath0-words acts freely on a @xmath0-tree .",
    "the converse is proved in @xcite .",
    "formulation of the regularity axiom is another important ingredient .",
    "this axiom ensures that the group is complete with respect to the gromov s inner product , that is , the gromov s product of two elements of the group can be realized as the length of a particular element of the group ( not only as an abstract length ) . in the language of actions",
    "this means that all branch points belong to the orbit of the base point .",
    "this allows one to use the nielsen cancelation argument , very similar to the case of a free group .",
    "the regularity ( completeness ) condition is crucial for the existence of makanin - razborov type processes over groups with @xmath0-length functions .    in this paper",
    "we prove the following results .",
    "[ th : main1 ] any finitely presented regular @xmath0-free group @xmath1 can be represented as a union of a finite series of groups @xmath16 where    1 .",
    "@xmath17 is a free group , 2 .",
    "@xmath18 is obtained from @xmath19 by finitely many hnn - extensions in which associated subgroups are maximal abelian and the associated isomorphisms preserve the length induced from @xmath19 .",
    "let @xmath1 be a finitely presented regular @xmath0-free group .",
    "then @xmath1 is a torsion - free toral relatively hyperbolic biautomatic group with a quasi - convex hierarchy ( see @xcite for the definition of a quasi - convex hierarchy ) .",
    "it follows from the description of the structure of @xmath1 that each @xmath19 is toral relatively hyperbolic .",
    "( it also follows from @xcite and theorem 3 since @xmath1 acts freely on @xmath11-tree . ) from @xcite it follows that @xmath1 is biautomatic .",
    "now by @xcite centralizers are regular and quasi - convex in biautomatic groups .",
    "so the associated subgroups in @xmath19 are quasiconvex in @xmath19 . if they are not conjugate , then they are centralizers in @xmath18 and therefore quasiconvex there . if they are conjugate , then the hnn - extension is equivalent to an extension of the centralizer of one of them ( denote it by @xmath20 ) .",
    "the centralizer @xmath21=1 , a\\in a>$ ] is quasiconvex in @xmath18 and @xmath20 is a direct summand of @xmath22 , therefore @xmath20 is quasiconvex in @xmath22 and in @xmath23    let @xmath1 be a finitely presented regular @xmath0-free group .",
    "then the following algorithmic problems are decidable in @xmath1 :    * the word and conjugacy problems ; , * the diophantine problem ( decidability of arbitrary equations in @xmath1 ) .",
    "indeed , decidability of equations follows from @xcite .",
    "results of dahmani and groves @xcite imply the following two corollaries .",
    "let @xmath1 be a finitely presented regular @xmath0-free group .",
    "then :    * @xmath1 has a non - trivial abelian splitting and one can find such a splitting effectively , * @xmath1 has a non - trivial abelian jsj - decomposition and one can find such a decomposition effectively .",
    "the isomorphism problem is decidable in the class of finitely presented groups that act regularly and freely on some @xmath0-tree .",
    "[ th : main3 ] any finitely presented regular @xmath0-free group @xmath1 is @xmath11-free for an appropriate @xmath24 , where @xmath11 is ordered lexicographically .",
    "[ th : main4 ] any finitely presented @xmath0-free group can be isometrically embedded into a finitely presented regular @xmath0-free group .",
    "any finitely presented @xmath0-free group @xmath1 is @xmath11-free for an appropriate @xmath25 and lexicographically ordered @xmath11 .",
    "our main conjecture about @xmath0-free groups is still open .",
    "[ th : main2 ] any finitely presented @xmath0-free group @xmath1 is @xmath26-free for an appropriate @xmath27 and lexicographically ordered @xmath26 .",
    "here we introduce basic definitions and notations which are to be used throughout the whole paper .",
    "let @xmath1 be a group and @xmath0 an ordered abelian group .",
    "then a function @xmath28 is called a _ ( lyndon ) length function _ on @xmath1 if the following conditions hold :    1 .",
    "@xmath29 and @xmath30 ; 2 .",
    "@xmath31 ; 3 .",
    "@xmath32 , + where @xmath33 .",
    "sometimes we refer to length functions with values in @xmath0 as to @xmath0-length functions .",
    "observe , that the word length function on a finitely generated group ( with respect to a fixed finite generating set ) usually is not a lyndon length function . in this paper",
    "we consider length functions only of lyndon type .",
    "notice that @xmath34 may not be defined in @xmath0 ( if @xmath35 is not divisible by @xmath36 ) , so in the axiom ( l3 ) we assume that @xmath0 is canonically embedded into a divisible ordered abelian group @xmath37 ( see @xcite for details ) .",
    "it is not difficult to derive the following two properties of length functions from the axioms ( l1) ( l3 ) :    * @xmath38 ; * @xmath39 .    a length function @xmath40",
    "is called _ free _ if it satisfies the following two axioms .",
    "1 .   @xmath41 2 .",
    "@xmath42    as we have mentioned in the introduction group actions on @xmath0-trees provide a geometric counterpart to @xmath0-length functions .",
    "to explain we need the following definitions , which we also use later in the text .",
    "let @xmath43 be a non - empty set and @xmath0 an ordered abelian group .",
    "@xmath0-metric on @xmath43 _ is a mapping @xmath44 such that for all @xmath45 :    1 .",
    "@xmath46 and @xmath47 if and only if @xmath48 , 2 .",
    "@xmath49 , 3 .",
    "@xmath50 .",
    "if the axioms ( m1)(m3 ) are satisfied then the pair @xmath51 is an _",
    "@xmath0-metric space_. if @xmath51 and @xmath52 are @xmath0-metric spaces , an _ isometry _ from @xmath51 to @xmath52 is a mapping @xmath53 such that @xmath54 for all @xmath55 .    for elements",
    "@xmath56 the _ closed segment _",
    "@xmath57 $ ] is defined by @xmath58 = \\{c \\in a \\mid a \\leqslant c \\leqslant b \\}.\\ ] ] more generally , a _ segment _ in an @xmath0-metric space is the image of an isometry @xmath59 \\rightarrow x$ ] for some @xmath56 .",
    "the endpoints of the segment are @xmath60 . a segment with endpoints @xmath61 is denoted by @xmath62 $ ] .",
    "an @xmath0-metric space @xmath51 is _ geodesic _ if for all @xmath55 , there is a segment in @xmath43 with endpoints @xmath63 .",
    "@xmath0-tree _ is an @xmath0-metric space @xmath51 such that :    1 .",
    "@xmath51 is geodesic , 2 .",
    "if two segments of @xmath51 intersect in a single point , which is an endpoint of both , then their union is a segment , 3 .",
    "the intersection of two segments with a common endpoint is also a segment .",
    "we say that a group @xmath1 acts on a @xmath0-tree @xmath43 if it acts on @xmath43 by isometries , i.e. there exists an embedding of @xmath1 into @xmath64 .",
    "an action of @xmath1 on @xmath43 is termed _ free _ if for every @xmath65 neither @xmath66 , nor @xmath67 has a fixed point in @xmath43 .",
    "if @xmath1 acts on a @xmath0-tree @xmath51 and @xmath68 then one can associate to this action a function @xmath69 so that @xmath70 for every @xmath71 .",
    "it is not hard to check that @xmath72 is a lyndon length function . moreover ,",
    "if the action of @xmath1 on @xmath43 is free then @xmath72 is a free length function .",
    "the converse is also true , that is , every action of a group @xmath1 on a @xmath0-tree arises from some lyndon @xmath0-length function .",
    "@xcite let @xmath1 be a group and @xmath28 a lyndon length function satisfying ( l4 ) .",
    "then there are a @xmath0-tree @xmath51 , an action of @xmath1 on @xmath43 and a point @xmath68 such that @xmath73 .    for elements",
    "@xmath74 we write @xmath75 if @xmath76 and @xmath77 . also ,",
    "for @xmath78 we write @xmath79 if @xmath80 and @xmath81 .    a length function @xmath28",
    "is called _ regular _ if it satisfies the _ regularity _ axiom :    1 .",
    "@xmath82 : @xmath83    many examples of groups with regular free length functions are given in @xcite .      in this subsection",
    "we give a geometric characterization of group actions that come from regular length functions .",
    "the four lemmas below were proved in @xcite , but for convenience of the reader we give the proofs here too .",
    "let @xmath1 act on a @xmath0-tree @xmath84 .",
    "the action is regular with respect to @xmath85 if for any @xmath86 there exists @xmath87 such that @xmath88 = [ x , g x ] \\cap [ x , h x]$ ] .",
    "@xcite let @xmath1 act on a @xmath0-tree @xmath89 .",
    "then the action of @xmath1 is regular with respect to @xmath90 if and only if the length function @xmath91 based at @xmath92 is regular .    by definition ,",
    "the length function @xmath72 is regular if for every @xmath93 there exists @xmath87 such that @xmath94 , where @xmath95 and @xmath96 .",
    "suppose the action of @xmath1 is regular with respect to @xmath92 .",
    "then for @xmath86 there exists @xmath97 such that @xmath88 = [ x , g x ] \\cap [ x , h x]$ ] .",
    "we have @xmath98 = [ x , f x ] \\cup [ f x , g x],\\ [ x , h x ] = [ x , f x ] \\cup [ f x , h x]$ ] and @xmath99 = [ x , ( f^{-1 } g)x ] = l_x(f^{-1 } g),\\ [ f x , h x ] = [ x , ( f^{-1 } h ) x ] = l_x(f^{-1 } h)$ ] . taking @xmath100 we have @xmath101 . finally , since @xmath102 and @xmath103 we get @xmath104 .",
    "suppose that @xmath72 is regular .",
    "then from @xmath105 it follows that @xmath106 = [ x , f x ] \\cup [ f x , g x],\\ [ x , h x ] = [ x , f x ] \\cup [ f x , h x]$ ] .",
    "@xmath107 , so @xmath108 . in other words ,",
    "@xmath109 @xmath110 which is equivalent to @xmath88 = [ x , g x ] \\cap [ x , h x]$ ] .",
    "let @xmath1 act minimally on a @xmath0-tree @xmath84 .",
    "if the action of @xmath1 is regular with respect to @xmath85 then all branch points of @xmath84 are @xmath1-equivalent .    from minimality of the action it follows that @xmath84 is spanned by the set of points @xmath111",
    ".    now let @xmath112 be a branch point in @xmath84 .",
    "it follows that there exist ( not unique in general ) @xmath113 such that @xmath62 = [ x , g x ] \\cap [ x , h x]$ ] . from regularity of the action it follows that there exists @xmath87 such that @xmath114 .",
    "hence , every branch point is @xmath1-equivalent to @xmath92 and the statement of the lemma follows .",
    "let @xmath1 act on a @xmath0-tree @xmath84 .",
    "if the action of @xmath1 is regular with respect to @xmath115 then it is regular with respect to any @xmath116 .",
    "we have to show that for every @xmath93 there exists @xmath87 such that @xmath117 = [ y , g y ] \\cap [ y , h y]$ ] . since @xmath118 for some @xmath119 then we have to prove that @xmath120 = [ t x , ( gt ) x ] \\cap [ t x , ( ht ) x]$ ] . the latter equality is equivalent to @xmath121 = [ x , ( t^{-1 } g t ) x ] \\cap [ x , ( t^{-1 } h t ) x]$ ] which follows from regularity of the action with respect to @xmath92 .",
    "let @xmath1 act freely on a @xmath0-tree @xmath84 so that all branch points of @xmath84 are @xmath1-equivalent .",
    "then the action of @xmath1 is regular with respect to any branch point in @xmath84 .",
    "let @xmath92 be a branch point in @xmath84 and @xmath93 . if @xmath122 then @xmath98 \\cap [ x , h x ] = [ x , g x]$ ] and @xmath66 is the required element .",
    "suppose @xmath123 . since the action is free then @xmath124 and we consider the tripod formed by @xmath125 .",
    "hence , @xmath126 is a branch point in @xmath84 and by the assumption there exists @xmath87 such that @xmath114 .      in this subsection at first we recall some notions from the theory of ordered abelian groups ( for all the details refer to the books @xcite and @xcite ) and then following @xcite describe the construction of infinite words .",
    "let @xmath0 be a discretely ordered abelian group with the minimal positive element @xmath127 .",
    "it is going to be clear from the context if we are using @xmath127 as an element of @xmath0 , or as an integer .",
    "let @xmath128 be a set .",
    "put @xmath129 and @xmath130 .",
    "a _ @xmath0-word _ is a function of the type @xmath131 \\to x^\\pm,\\ ] ] where @xmath132 . the element @xmath133 is called the _ length _ @xmath134 of @xmath135 .    by @xmath136",
    "we denote the set of all @xmath0-words .",
    "observe , that @xmath136 contains an empty @xmath0-word which we denote by @xmath137 .",
    "concatenation @xmath138 of two @xmath0-words @xmath139 is a @xmath0-word of length @xmath140 and such that : @xmath141    a @xmath0-word @xmath135 is _ reduced _ if @xmath142 for each @xmath143 .",
    "we denote by @xmath144 the set of all reduced @xmath0-words .",
    "clearly , @xmath145 . if the concatenation @xmath138 of two reduced @xmath0-words @xmath146 and @xmath147 is also reduced then we write @xmath148 .    for @xmath149 and @xmath150 $ ] by @xmath151",
    "we denote the restriction of @xmath146 on @xmath152 $ ] . if @xmath153 and @xmath150 $ ] then @xmath154 for some uniquely defined @xmath155 .",
    "an element @xmath156 is called the (    _ longest _ ) _ common initial segment _ of @xmath0-words @xmath146 and @xmath147 if @xmath157 for some ( uniquely defined ) @xmath0-words @xmath158 such that @xmath159 .",
    "now , we can define the product of two @xmath0-words .",
    "let @xmath160 .",
    "if @xmath161 is defined then @xmath162 for some uniquely defined @xmath163 and @xmath164 . in this event put @xmath165 the product @xmath166 is a partial binary operation on @xmath144 .",
    "an element @xmath167 is termed _ cyclically reduced _ if @xmath168 .",
    "we say that an element @xmath167 admits a _",
    "cyclic decomposition _",
    "if @xmath169 , where @xmath170 and @xmath146 is cyclically reduced . observe that a cyclic decomposition is unique ( whenever it exists ) .",
    "we denote by @xmath171 the set of all cyclically reduced words in @xmath144 and by @xmath172 the set of all words from @xmath144 which admit a cyclic decomposition .",
    "let @xmath173 index the set of all convex subgroups of @xmath174 .",
    "@xmath173 is linearly ordered ( see , for example , @xcite ) : @xmath175 if and only if @xmath176 , and @xmath177 we say that @xmath71 _ has the height _ @xmath178 and denote @xmath179 if @xmath180 and @xmath181 for any @xmath182 .",
    "below we refer to @xmath0-words as _ infinite words _ usually omitting @xmath0 whenever it does not produce any ambiguity .",
    "the following result establishes the connection between infinite words and length functions .",
    "[ co:3.1 ] @xcite let @xmath0 be a discretely ordered abelian group and @xmath43 be a set .",
    "then any subgroup @xmath1 of @xmath172 has a free lyndon length function with values in @xmath0  the restriction @xmath183 on @xmath1 of the standard length function @xmath184 on @xmath172 .",
    "the converse of the theorem above is also true .",
    "[ chis ] @xcite let @xmath1 have a free lyndon length function @xmath185 , where @xmath0 is a discretely ordered abelian group .",
    "then there exists a set @xmath43 and a length preserving embedding @xmath186 , that is , @xmath187 for any @xmath71 .",
    "[ chis - cor ] @xcite let @xmath1 have a free lyndon length function @xmath185 , where @xmath0 is an arbitrary ordered abelian group .",
    "then there exists an embedding @xmath188 , where @xmath189 is discretely ordered with respect to the right lexicographic order and @xmath43 is some set , such that , @xmath190 for any @xmath71 .    theorem [ co:3.1 ] , theorem [ chis ] , and corollary [ chis - cor ] show that a group has a free lyndon length function if and only if it embeds into a set of infinite words and this embedding preserves the length .",
    "moreover , it is not hard to show that this embedding also preserves regularity of the length function .",
    "[ chis - cor-1 ] @xcite let @xmath1 have a free regular lyndon length function @xmath185 , where @xmath0 is an arbitrary ordered abelian group .",
    "then there exists an embedding @xmath191 , where @xmath192 is a discretely ordered abelian group and @xmath43 is some set , such that , the lyndon length function on @xmath193 induced from @xmath194 is regular .",
    "from now on we assume that @xmath195 is a finitely presented group which acts freely and regularly on a @xmath0-tree , where @xmath0 is a discretely ordered abelian group , or , equivalently , @xmath1 can be represented by @xmath0-words over some alphabet @xmath196 and the length function on @xmath1 induced from @xmath197 is regular . let us fix the embedding @xmath198 for the rest of this section .      a _ combinatorial generalized equation",
    "_ @xmath199 ( which is convenient to visualize as shown on the picture below )    [ pic : example ]    consists of the following objects .    1 .   a finite set of _ bases _ @xmath200 .",
    "the set of bases @xmath201 consists of @xmath202 elements @xmath203 .",
    "the set @xmath201 comes equipped with two functions : a function @xmath204 and an involution @xmath205 ( that is , @xmath206 is a bijection such that @xmath207 is an identity on @xmath201 )",
    ". bases @xmath208 and @xmath209 are called _",
    "dual bases_. we denote bases by letters @xmath210 , etc .",
    "2 .   a set of _ boundaries _ @xmath211 ,",
    "that is , integer points of the interval @xmath212 $ ] .",
    "we use letters @xmath213 , etc . for boundaries .",
    "two functions @xmath214 and @xmath215 .",
    "we call @xmath216 and @xmath217 the _ initial and terminal boundaries _ of the base @xmath208 ( or endpoints of @xmath208 ) .",
    "these functions satisfy the following conditions : for every base @xmath218 : @xmath219 if @xmath220 and @xmath221 if @xmath222 .",
    "4 .   a set of _ boundary connections _",
    "@xmath223 where @xmath224 is a boundary on @xmath225 ( that is a number between @xmath226 and @xmath227 ) and @xmath228 on @xmath229 . in this case",
    "we say that @xmath224 and @xmath228 are @xmath225-tied .",
    "if @xmath230 is a boundary connection then @xmath231 is also a boundary connection .",
    "( the meaning of boundary connections will be explained in the transformation ( et5 ) ) .",
    "with a combinatorial generalized equation @xmath199 one can canonically associate a system of equations in _ variables _",
    "@xmath232 ( variables @xmath233 are also called _",
    "items _ ) .",
    "this system is called a _ generalized equation _ , and",
    "( slightly abusing the terminology ) we denote it by the same symbol @xmath199 , or @xmath234 specifying the variables it depends on .",
    "the generalized equation @xmath199 consists of the following two types of equations .    1 .",
    "each pair of dual bases @xmath235 provides an equation @xmath236^{\\varepsilon ( \\lambda ) } = [ h_{\\alpha(\\overline\\lambda ) } h_{\\alpha(\\overline\\lambda ) + 1 } \\ldots h_{\\beta(\\overline \\lambda ) - 1}]^{\\varepsilon(\\overline\\lambda)}.\\ ] ] these equations are called _ basic equations_. 2 .",
    "every boundary connection @xmath237 gives rise to a _ boundary equation _",
    "= [ h_{\\alpha(\\overline\\lambda ) } h_{\\alpha(\\overline\\lambda ) + 1 } \\cdots h_{q-1}],\\ ] ] if @xmath239 and @xmath240 = [ h_{q } h_{q+1 } \\cdots h_{\\alpha ( \\overline\\lambda)-1}]^{-1 } , \\ ] ] if @xmath241    we assume that every generalized equation comes from a combinatorial one .    given a generalized equation @xmath234 one can define the _ group of @xmath234 _",
    "@xmath242    let @xmath243 be a generalized equation in variables @xmath232 .",
    "a set @xmath244 of nonempty @xmath0-words is called a _ solution _ of @xmath199 if :    1 .",
    "all words @xmath245 are reduced , 2 .",
    "@xmath246 $ ] .",
    "observe that a solution @xmath247 of @xmath234 defines a homomorphism @xmath248 induced by the mapping @xmath249 $ ] since after this substitution all the equations of @xmath234 turn into identities in @xmath250 .",
    "if we specify a particular solution @xmath247 of a generalized equation @xmath199 then we use a pair @xmath251 .",
    "a cancelation table @xmath252 of a solution @xmath253 is defined as follows @xmath254    a solution @xmath255 of a generalized equation @xmath199 is called _ consistent _ with a solution @xmath247 if @xmath256 .",
    "recall that @xmath195 is finitely presented and let @xmath257 and @xmath258 .",
    "adding , if necessary , auxiliary generators , we can assume that every relator involves at most three generators .    since @xmath259 is a homomorphism it follows that after the substitution @xmath260 $ ] all products @xmath261 $ ] cancel out .",
    "hence , we have finitely many _",
    "cancellation diagrams _ over @xmath262 , which give rise to a generalized equation @xmath199 corresponding to the embedding @xmath263 .    the precise definition and all the details concerning cancellation diagrams over @xmath262 can be found in @xcite .",
    "briefly , a cancellation diagram for @xmath264 can be viewed as a finite directed tree @xmath265 in which every positive edge @xmath266 has a label @xmath267 so that every occurrence @xmath268 of @xmath68 in @xmath269 corresponds to a reduced path @xmath270 , where @xmath271 , in @xmath265 and @xmath272 . in other words ,",
    "each @xmath267 is a piece of some generator of @xmath1 viewed as a @xmath0-word .",
    "moreover , we assume that @xmath273 is known ( since we know the homomorphism @xmath259 ) .",
    "[ triangle ]    now we would like to construct a generalized equation @xmath274 corresponding to @xmath265 .",
    "denote by @xmath275 all generators of @xmath1 which appear in @xmath269 .",
    "next , consider a segment @xmath276 in @xmath0 of length @xmath277 which is naturally divided by the lengths of @xmath278 into subsegments with respect to any given order on @xmath275 .",
    "since every @xmath278 splits into at least one reduced product @xmath279 , every such splitting gives a subdivision of the corresponding subsegment of @xmath276 .",
    "hence , we subdivide @xmath276 using all product representations of all @xmath278 . as a result",
    "we obtain a subdivision of @xmath276 into @xmath280 items whose endpoints become boundaries of @xmath274 . observe that each @xmath267 appears exactly twice in the products representing some @xmath281 and each such entry covers several adjacent items of @xmath276 .",
    "this pair of entries defines a pair of dual bases @xmath282 .",
    "hence , @xmath283 @xmath284 depends on the sign of @xmath267 in the corresponding product representing a variable from @xmath275 ( similarly for @xmath285 ) .",
    "in the same way one can construct @xmath265 and the corresponding @xmath274 for each @xmath286 $ ] . combining all combinatorial generalized equations @xmath287 $ ] we obtain the equation @xmath199 with items @xmath288 and bases @xmath289 . by definition @xmath290 at the same time , since each item can be obtained in the form @xmath291 it follows that @xmath292 can be generated by @xmath201 with the relators obtained by rewriting @xmath293 in terms of @xmath201 .",
    "it is possible to transform the presentation @xmath294 into @xmath295 using tietze transformations as follows .",
    "from the cancellation diagrams constructed for each relator in @xmath296 it follows that @xmath297 $ ] . hence @xmath298\\ } \\rangle.\\ ] ] next , from the cancellation diagrams it follows that @xmath296 is a set of consequences of @xmath299\\}$ ] , hence , @xmath298\\ } \\cup r \\rangle.\\ ] ] finally , since the length function on @xmath1 is regular , for each @xmath233 there exists a word @xmath300 such that @xmath301 and all the equations in @xmath302\\}$ ] follow from @xmath296 after we substitute @xmath233 by @xmath300 for each @xmath303 .",
    "it follows that @xmath304\\ } \\cup r \\rangle\\ ] ] @xmath305\\ } \\cup r \\cup \\{h_j = u_j(x),\\ j \\in",
    "[ 1,\\rho]\\ } \\rangle \\simeq \\langle x \\mid r \\rangle.\\ ] ] it follows that @xmath306 .",
    "let @xmath307 be the standard cw @xmath36-complex for @xmath1 corresponding to the presentation @xmath308 .",
    "let @xmath309 be a cw @xmath36-complex obtained from @xmath310 by creating for each relator a polygon with boundary labeled by this relator and gluing these polygons together along edges labeled by the same letter .",
    "@xmath309 may have several vertices .",
    "if we add arcs joining all the vertices in @xmath309 we obtain a cw complex @xmath311 which has the same fundamental group as @xmath307 ( namely , @xmath1 ) .",
    "@xmath1 is a free product of @xmath312 and , possibly , a free group",
    ".    follows from the construction .",
    "[ nonreg ] let @xmath2 be a finitely presented group with a free length function in @xmath0 ( not necessary regular ) .",
    "it can be embedded isometrically in the group @xmath313 with a free regular length function in @xmath0 by @xcite . that group can be embedded in @xmath314 .",
    "when we make a generalized equation @xmath199 for @xmath2 , we have to add only finite number of elements from @xmath313 .",
    "let @xmath1 be a subgroup generated in @xmath313 by @xmath2 and these elements .",
    "then @xmath1 is the quotient of @xmath310 containing @xmath2 as a subgroup .",
    "in this section at first we introduce transformations of combinatorial generalized equations , then we show how they can be applied to `` simplify '' the given equation @xmath199 and to extract information about the structure of the corresponding group @xmath292 .",
    "in this subsection we describe _ elementary transformations _ of generalized equations .",
    "let @xmath251 be a generalized equation together with a solution @xmath247 .",
    "an elementary transformation ( et ) associates to a generalized equation @xmath251 a generalized equation @xmath315 and an epimorphism @xmath316 such that for the solution @xmath317 the following diagram commutes    @xmath318    one can view ( et ) as a mapping @xmath319 .    1 .   _",
    "( cutting a base ( see fig .",
    "[ et1]))_. let @xmath225 be a base in @xmath199 and @xmath224 an internal boundary of @xmath225 ( that is , @xmath320 ) with a boundary connection @xmath321 .",
    "then we cut the base @xmath225 at @xmath224 into two new bases @xmath322 and @xmath323 , and cut @xmath324 at @xmath228 into the bases @xmath325 and @xmath326 .",
    "( transfering a base ( see fig . [",
    "et2]))_. if a base @xmath225 of @xmath199 contains a base @xmath208 ( that is , @xmath327 ) and",
    "all boundaries on @xmath208 are @xmath225-tied by boundary some connections then we transfer @xmath208 from its location on the base @xmath225 to the corresponding location on the base @xmath324 .",
    "( removal of a pair of matched bases ( see fig .",
    "if the bases @xmath225 and @xmath324 are _ matched _ ( that is , @xmath328 ) then we remove @xmath329 from @xmath199 .",
    "+ observe , that @xmath199 and @xmath330 , where @xmath331 for @xmath332 have the same set of variables @xmath333 and the bijection @xmath334 $ ] induces an isomorphism @xmath335 .",
    "moreover , @xmath247 is a solution of @xmath199 if and only if @xmath247 is a solution of @xmath330 .",
    "( removal of a lone base ( see fig . [",
    "et4]))_. suppose , a base @xmath225 in @xmath199 does not _ intersect _ any other base , that is , the items @xmath336 are contained only inside of the base @xmath225 .",
    "+ suppose also that all boundaries in @xmath225 are @xmath225-tied , that is , for every @xmath303 ( @xmath337 ) there exists a boundary @xmath338 such that @xmath339 is a boundary connection in @xmath199 .",
    "then we remove the pair of bases @xmath225 and @xmath324 together with all the boundaries @xmath340 ( and rename the rest @xmath341 of the boundaries correspondingly ) .",
    "+ we define the isomorphism @xmath342 as follows : @xmath343 @xmath344 for @xmath345 .",
    "( introduction of a boundary ( see fig .",
    "[ et5]))_. suppose a point @xmath224 in a base @xmath225 is not @xmath225-tied .",
    "the transformation ( et5 ) @xmath225-ties it . to this end , denote by @xmath346 the element of @xmath262 corresponding to @xmath225 and let @xmath347 be the beginning of this word ending at @xmath224",
    ". then we perform one of the following two transformations according to where the end of @xmath347 on @xmath324 is situated : 1 .",
    "if the end of @xmath347 on @xmath324 is situated on the boundary @xmath228 then we introduce the boundary connection @xmath348 . in this case",
    "the corresponding isomorphism @xmath316 is induced by the bijection @xmath349 $ ] .",
    "( if we began with the group @xmath350 with non - regular length function as in remark [ nonreg ] this is the only place where @xmath316 may be a proper epimorphism , but its restriction on @xmath350 is still an isomorphism . ) 2 .",
    "if the end of @xmath347 on @xmath324 is situated between @xmath228 and @xmath351 then we introduce a new boundary @xmath352 between @xmath228 and @xmath351 ( and rename all the boundaries ) , and also introduce a new boundary connection @xmath353 . in this case",
    "the corresponding isomorphism @xmath354 is induced by the map @xmath355 , if @xmath356 , and @xmath357 .      in this section",
    "we define complexity of a generalized equation and describe several useful `` derived '' transformations of generalized equations .",
    "some of them can be realized as finite sequences of elementary transformations , others result in equivalent generalized equations but can not be realized by finite sequences of elementary moves .",
    "a boundary is _ open _ if it is an internal boundary of some base , otherwise it is _",
    "a section @xmath358 $ ] is said to be _ closed _ if the boundaries @xmath303 and @xmath359 are closed and all the boundaries between them are open .",
    "sometimes it will be convenient to subdivide all sections of @xmath199 into _ active _ ( denoted @xmath360 ) and _ non - active _ sections . for",
    "an item @xmath333 denote by @xmath361 the number of bases containing @xmath333 .",
    "an item @xmath333 is called _ free _ is it meets no base , that is , if @xmath362 .",
    "free variables are transported to the very end of the interval behind all items in @xmath199 and they become non - active .    1 .   _ ( closing a section)_. let @xmath363 be a section of @xmath199 .",
    "the transformation ( d1 ) makes the section @xmath363 closed .",
    "namely , ( d1 ) cuts all bases in @xmath199 through the end - points of @xmath363 .",
    "( transporting a closed section)_. let @xmath363 be a closed section of a generalized equation @xmath199 .",
    "we cut @xmath363 out of the interval @xmath364 $ ] together with all the bases on @xmath363 and put @xmath363 at the end of the interval or between any two consecutive closed sections of @xmath199 .",
    "after that we correspondingly re - enumerate all the items and boundaries of the latter equation to bring it to the proper form . clearly , the original equation @xmath199 and the new one @xmath365 have the same solution sets and their coordinate groups are isomorphic 3 .   _",
    "( moving free variables to the right)_. suppose that @xmath199 contains a free variable @xmath366 in an active section .",
    "here we close the section @xmath367 $ ] using ( d1 ) , transport it to the very end of the interval behind all items in @xmath199 using ( d2 ) . in the resulting generalized equation @xmath365",
    "the transported section becomes a non - active section .",
    "( deleting a complete base)_. a base @xmath208 of @xmath199 is called _ complete _ if there exists a closed section @xmath363 in @xmath199 such that @xmath368 $ ] .",
    "+ suppose @xmath208 is an active complete base of @xmath199 and @xmath363 is a closed section such that @xmath369 $ ] . in this case using ( et5 ) , we transfer all bases from @xmath208 to @xmath370 , then using ( et4 ) we remove the lone base @xmath208 together with the section @xmath363 .",
    "( finding the kernel)_. we will give a definition of eliminable base for an equation @xmath199 that does not have any boundary connections .",
    "an active base @xmath371 is called _ eliminable _ if at least one of the following holds 1 .",
    "@xmath208 contains an item @xmath233 with @xmath372 , 2 .",
    "at least one of the boundaries @xmath373 is different from @xmath374 and does not touch any other base ( except for @xmath208 ) .",
    "+ the process of finding the kernel works as follows .",
    "we cut the bases of @xmath199 along all the boundary connections thus obtaining the equation without boundary connections , then consequently remove eliminable bases until no eliminable base is left in the equation .",
    "the resulting generalized equation is called the _ kernel _ of @xmath199 and we denote it by @xmath375 .",
    "it is easy to see that @xmath375 does not depend on a particular removal process . indeed ,",
    "if @xmath199 has two different eliminable bases @xmath376 , and deletion of @xmath377 produces an equation @xmath274 then by induction ( on the number of eliminations ) @xmath378 is uniquely defined for @xmath379 . obviously , @xmath380 is still eliminable in @xmath381 , as well as @xmath382 is eliminable in @xmath330 .",
    "now eliminating @xmath380 and @xmath382 from @xmath381 and @xmath330 we get one and the same equation @xmath383 . by induction , @xmath384",
    "hence the result .",
    "we say that an item @xmath233 _ belongs to the kernel _",
    "( @xmath385 ) , if @xmath233 belongs to at least one base in the kernel .",
    "notice that the kernel can be empty .",
    "+ also , for an equation @xmath199 by @xmath386 we denote the equation which is obtained from @xmath199 by deleting all free variables . obviously , @xmath387 where @xmath388 is the set of free variables in @xmath199 .",
    "+ let us consider what happens in this process on the group level .",
    "+ we start with the case when just one base is eliminated .",
    "let @xmath208 be an eliminable base in @xmath389 .",
    "denote by @xmath330 the equation resulting from @xmath199 by eliminating @xmath208 .",
    "1 .   suppose @xmath390 and @xmath372",
    ". then the variable @xmath233 occurs only once in @xmath199 - precisely in the equation @xmath391 corresponding to the base @xmath208 .",
    "therefore , in the group @xmath292 the relation @xmath391 can be written as @xmath392 , where @xmath135 does not contain @xmath233 . using tietze transformations we can rewrite the presentation of @xmath292 as @xmath393 , where @xmath365 is obtained from @xmath199 by deleting @xmath394 and the item @xmath233 .",
    "it follows immediately that @xmath395 and @xmath396 for some free group @xmath397 .",
    "2 .   suppose now that @xmath208 satisfies case ( b ) above with respect to a boundary @xmath303 .",
    "then in the equation @xmath391 the variable @xmath398 either occurs only once , or it occurs precisely twice and in this event the second occurrence of @xmath398 ( in @xmath370 ) is a part of the subword @xmath399 . in both cases it is easy to see that the tuple @xmath400 generates @xmath1 .",
    "therefore , by eliminating the relation @xmath391 we can rewrite the presentation of @xmath292 in the generators @xmath401 . observe also that any other equation @xmath402 ( @xmath403 ) of @xmath199 either does not contain the variables @xmath404 , or it contains them as parts of the subword @xmath405 , that is , any such a word @xmath406 can be expressed as a word @xmath407 in terms of the generators @xmath388 .",
    "this shows that @xmath408 where @xmath365 is a generalized equation obtained from @xmath330 by deleting the boundary @xmath303 .",
    "denote by @xmath409 an equation obtained from @xmath365 by adding a free variable @xmath410 to the right end of @xmath365 .",
    "it follows now that @xmath411 and @xmath412 for some free group @xmath413 .",
    "+ by induction on the number of steps in the process we obtain the following lemma .",
    "+ [ 7 - 10 ] if @xmath414 is a generalized equation , then @xmath415 where @xmath413 is a free group on @xmath416 .",
    "+ let @xmath417 be a linear elimination process .",
    "it is easy to see ( by induction on @xmath418 ) that for every @xmath419 @xmath420 moreover , if @xmath421 is obtained from @xmath422 as in the case ( b ) above , then ( in the notations above ) @xmath423 now the statement of the lemma follows from the remarks above and equalities ( [ eq : ker1 ] ) and ( [ eq : ker2 ] ) .",
    "( linear elimination)_. suppose that in @xmath199 there is @xmath233 in an active section with @xmath372 and such that @xmath424 is comparable with the length of the active section . in this case",
    "we say that @xmath199 is _ linear in @xmath233_. + if @xmath199 is linear in @xmath233 in an active section such that both boundaries @xmath303 and @xmath425 are closed then we remove the closed section @xmath426 $ ] together with the lone base using ( et4 ) .",
    "+ if there is no such @xmath233 but @xmath199 is linear in some @xmath233 in an active section such that one of the boundaries @xmath427 is open , say @xmath425 , and the other is closed , then we perform ( et5 ) and @xmath208-tie @xmath425 through the only base @xmath208 it intersects . next , using ( et1 ) we cut @xmath208 in @xmath425 and",
    "then we delete the closed section @xmath426 $ ] by ( et4 ) .",
    "+ suppose there is no @xmath233 as above but @xmath199 is linear in some @xmath233 in an active section such that both boundaries @xmath303 and @xmath425 are open .",
    "in addition , assume that there is a closed section @xmath363 containing exactly two ( not matched ) bases @xmath380 and @xmath382 , such that @xmath428 and in the generalized equation @xmath429 ( see the derived transformation ( d3 ) ) all the bases obtained from @xmath430 by ( et1 ) in constructing @xmath429 from @xmath199 , do not belong to the kernel of @xmath429 . here , using ( et5 ) , we @xmath380-tie all the boundaries inside of @xmath380 , then using ( et2 ) we transfer @xmath382 onto @xmath431 , and remove @xmath380 together with the closed section @xmath363 using ( et4 ) .",
    "+ suppose now that @xmath199 satisfies the first assumption of the previous paragraph and does not satisfy the second one . in this event we close the section @xmath432 $ ] using ( d1 ) and remove it using ( et4 ) .",
    "+ [ lin - el ] suppose that the process of linear elimination continues infinitely and there is a corresponding sequence of generalized equations @xmath433 then 1 .",
    "( @xcite , lemma 15 ) the number of different generalized equations that appear in the process is finite",
    ". therefore some generalized equation appears in this process infinitely many times .",
    "( @xcite , lemma 15 ) if @xmath434 then @xmath435 is an isomorphism , invariant with respect to the kernel , namely @xmath436 for any variable @xmath233 that belongs to some base in @xmath375 .",
    "the interval for the equation @xmath422 can be divided into two disjoint parts , each being the union of closed sections , such that one part is a generalized equation @xmath375 and the other part is non - empty and corresponds to a generalized equation @xmath365 , such that @xmath437 is a free group on variables @xmath416 and @xmath438 .",
    "+ we will only prove the third statement . in the process of linear elimination we do not remove or cut variables @xmath233 that belong to the kernel . since we do not cut variables that belong to the kernel",
    ", we can remove parts of bases that cover some of these variables only finitely many times .",
    "therefore , bases that are cut in the process belong to the part of the interval that is disjoint from the @xmath375 .",
    "together with lemma [ 7 - 10 ] this proves the third statement . 7 .   _",
    "( tietze cleaning)_. this transformation consists of four transformations performed consecutively 1 .",
    "linear elimination : if the process of linear elimination goes infinitely we replace the equation by its kernel , 2 .   deleting all pairs of matched bases , 3 .   deleting all complete bases , 4 .",
    "moving all free variables to the right .",
    "( entire transformation)_. we need a few definitions",
    ". a base @xmath208 of the equation @xmath199 is called a _ leading _",
    "base if @xmath439 .",
    "a leading base is said to be _ maximal _ ( or a _ carrier base _ ) if @xmath440 for any other leading base @xmath225 .",
    "let @xmath208 be a carrier base of @xmath199 .",
    "any active base @xmath403 with @xmath440 is called a _ transfer _ base ( with respect to @xmath208 ) .",
    "+ suppose now that @xmath199 is a generalized equation with @xmath441 for each @xmath233 in the active part of @xmath199 and such that @xmath424 is comparable with the length of the active part .",
    "_ entire transformation _ is a sequence of elementary transformations which are performed as follows .",
    "we fix a carrier base @xmath208 of @xmath199 .",
    "we transfer all transfer bases from @xmath208 onto @xmath442 .",
    "now , there exists some @xmath443 such that @xmath444 belong to only one base @xmath208 , while @xmath445 belongs to at least two bases . applying ( et1 ) we cut @xmath208 along the boundary @xmath425 . finally , applying ( et4 )",
    "we delete the section @xmath446 $ ] .",
    "denote by @xmath448 the number of variables @xmath233 in all active sections of @xmath199 , by @xmath449 the number of bases in all active sections of @xmath199 , by @xmath450 the number of open boundaries in the active sections , and by @xmath451 the number of closed boundaries in the active sections .    for",
    "a closed section @xmath452 denote by @xmath453 the number of bases and , respectively , variables in @xmath363 .",
    "@xmath454 @xmath455    the _ complexity _ of the generalized equation @xmath414 is the number @xmath456    notice that the entire transformation ( d5 ) as well as the cleaning process ( d4 ) do not increase complexity of equations .",
    "below we recall delzant - potyagailo s result ( see @xcite ) .",
    "a family @xmath457 of subgroups of a torsion - free group @xmath1 is called _ elementary _ if    1 .",
    "@xmath457 is closed under taking subgroups and conjugation , 2 .",
    "every @xmath458 is contained in a maximal subgroup @xmath459 , 3 .",
    "every @xmath458 is small ( does not contain @xmath460 as a subgroup ) , 4 .   all maximal subgroups from @xmath457 are malnormal .",
    "@xmath1 admits a _ hierarchy _ over @xmath457 if the process of decomposing @xmath1 into an amalgamated product or an hnn - extension over a subgroup from @xmath457 , then decomposing factors of @xmath1 into amalgamated products and/or hnn - extensions over a subgroup from @xmath457 etc .",
    "eventually stops .",
    "( @xcite ) if @xmath1 is a finitely presented group without @xmath36-torsion and @xmath457 is a family of elementary subgroups of @xmath1 then @xmath1 admits a hierarchy over @xmath457 .    if @xmath1 is a finitely presented @xmath0-free group then @xmath1 admits a hierarchy over the family of all abelian subgroups .",
    "there is a notion of complexity of a group @xmath1 defined in @xcite and denoted by @xmath447 .",
    "we will only use the following statement that follows from there .",
    "( @xcite ) [ dp ] if @xmath1 is a finitely presented @xmath0-free group .",
    "let @xmath84 be an abelian decomposition of @xmath1 as a fundamental group of a graph of groups with more than one vertex and with each edge group being maximal abelian at least in one of its vertex groups .",
    "then for each vertex group @xmath461 , @xmath462 .      in this section",
    "we describe a rewriting process ( elimination process ) for a generalized equation @xmath199 corresponding to @xmath1 . performing the elimination process",
    "we eventually detect a decomposition of @xmath1 as a free product or ( if it is freely indecomposable ) as the fundamental group of a graph of groups with vertex groups of three types : qh vertex groups , abelian vertex groups ( corresponding to periodic structures , see below ) , non - qh , non - abelian vertex groups ( we will call them _ weakly rigid _ meaning that we do not split them in this particular decomposition ) .",
    "we also can detect splitting of @xmath1 as an hnn - extension with stable letter infinitely longer than generators of the abelian associated subgroups .",
    "after obtaining such a decomposition we continue the elimination process with the generalized equation corresponding to free factors of @xmath1 or to weakly rigid subgroups of @xmath1 ( we will show that this generalized equation can be naturally obtained from the generalized equation @xmath199 .",
    "the delzant - potyagailo complexity of factors in a free decomposition and complexity of weakly rigid subgroups is smaller than the complexity of @xmath1 ( denoted @xmath447 ) @xcite . in the case of an hnn extension",
    "we will show that the complexity @xmath463 of the generalized equation corresponding to a weakly rigid subgroup is smaller that the complexity of @xmath199 .",
    "we assume that @xmath199 is in standard form , namely , that transformations ( et3 ) , ( d3 ) and ( d4 ) have been applied to @xmath199 and that on each step we apply them to the generalized equation before applying any other transformation .",
    "let @xmath414 be a generalized equation .",
    "we construct a path @xmath464 ( with associated structures ) , as a directed path oriented from the root @xmath465 , starting at @xmath465 and proceeding by induction on the distance @xmath4 from the root .",
    "we start with a general description of the path @xmath464 . for each vertex @xmath147 in @xmath464",
    "there exists a unique generalized equation @xmath466 associated with @xmath147 .",
    "the initial equation @xmath199 is associated with the root @xmath465 , @xmath467 .",
    "in addition there is a homogeneous system of linear equations @xmath468 with integer coefficients on the lengths of variables of @xmath469 .",
    "we take @xmath470 to be empty . for each edge @xmath471 (",
    "here @xmath147 and @xmath472 are the origin and the terminus of the edge ) there exists an isomorphism @xmath473 associated with @xmath471 .",
    "if @xmath474 is a dubpath of @xmath464 , then by @xmath475 we denote composition of corresponding isomorphisms @xmath476    if @xmath471 is an edge then there exists a finite sequence of elementary or derived transformations from @xmath466 to @xmath477 and the isomorphism @xmath478 is a composition of the isomorphisms corresponding to these transformations .",
    "we also assume that active ( and non - active ) sections in @xmath477 are naturally inherited from @xmath466 , if not said otherwise . recall that initially all sections are active .",
    "suppose the path @xmath464 is constructed by induction up to a level @xmath4 and suppose @xmath147 is a vertex at distance @xmath4 from the root @xmath465 .",
    "we describe now how to extend the path from @xmath147 .",
    "the construction of the outgoing edge at @xmath147 depends on which case described below takes place at the vertex @xmath147 .",
    "there are three possible cases .    *",
    "* linear case : * there exists @xmath233 in the active part such that @xmath424 is comparable with the length of the active part and @xmath372 . *",
    "* quadratic and almost quadratic case : * @xmath479 for all @xmath233 in the active part such that @xmath424 is comparable with the length of the active part . * * general jsj case : * @xmath441 for all @xmath233 in the active part such that @xmath424 is comparable with the length of the active part , and there exists such @xmath233 that @xmath480 .",
    "we apply tietze cleaning ( d7 ) at the vertex @xmath481 if it is possible .",
    "we re - write the system of linear equations @xmath482 in new variables and obtain a new system @xmath483 .",
    "if @xmath484 splits into two parts , @xmath485 and @xmath486 that corresponds to a free group @xmath413 , then we put the free group section @xmath486 into a non - active part and thus decrease the complexity .",
    "it may happen that the kernel is empty , then the process terminates .",
    "if it is impossible to apply tietze cleaning ( that is @xmath441 for any @xmath233 in the active part of @xmath466 comparable to the length of the active part ) , we apply the entire transformation .",
    "* termination condition : * @xmath466 does not contain active sections . in this case the vertex @xmath147 is called a _ leaf _ or an _",
    "end vertex_.      suppose @xmath466 satisfies the condition @xmath487 for each @xmath233 in the active part and @xmath488 for each @xmath233 in the active part comparable with the length of the active part .",
    "first of all , we fill in all the @xmath489 in the active part such that @xmath490 by new ( infinitely short ) bases @xmath208 such that @xmath370 covers a new variable that we add to the non - active part .",
    "we apply the entire transformation ( d8 ) , then apply tietze cleaning ( d7 ) , if possible , then again apply entire transformation , etc . in this process",
    "we , maybe , will remove some pairs of matching bases decreasing the complexity .",
    "eventually we either end up with empty active part or the process will continue infinitely , and the number of bases in the active part will be constant .",
    "let @xmath491 be the leftmost boundary that belongs to a base not participating in the process .",
    "let us analyze the structure of @xmath492 in this case .",
    "let @xmath363 be a section in the active part @xmath493 $ ] .",
    "if @xmath363 is not closed , then cutting the second base at @xmath494 we make @xmath363 a closed section .",
    "let @xmath495 be a free group with basis @xmath496 .",
    "if @xmath363 contains an open boundary @xmath497 then we can consider a new generalized equation @xmath498 obtained from @xmath466 by replacing the product @xmath499 by a new variable @xmath500 and represent @xmath501 .",
    "therefore we can suppose that @xmath363 does not contain open boundaries .",
    "we say that @xmath208 is a _",
    "base if @xmath363 contains @xmath208 and @xmath370 , otherwise @xmath208 is a _ quadratic - coefficient base_. denote the set of quadratic - coefficient bases by @xmath22 .",
    "suppose that @xmath363 contains quadratic bases .",
    "let @xmath502 be the quotient of @xmath495 over the normal closure of elements @xmath503 h[\\alpha(\\overline\\mu),\\beta(\\overline\\mu)]^{-1}$ ] .",
    "let @xmath201 be a set that contains exactly one representative of each pair of double bases on @xmath363 and contains also each base @xmath208 such that @xmath504 and @xmath505 .",
    "if we identify each base on @xmath363 with its double then the product @xmath506 can be written as a product of bases from @xmath201 in exactly two different ways : @xmath507 and @xmath508 .",
    "then @xmath502 is isomorphic to the quotient of the free group @xmath509 over the relation @xmath510 .",
    "every element of @xmath511 occurs in this relation at most twice . applying an automorphism of @xmath509 identical on @xmath22",
    ", we can obtain another basis @xmath512 of this group such that in this basis the relation has form of a standard quadratic equation in variables from @xmath43 with coefficients in @xmath513 ( see @xcite , section 1.7 ) .",
    "note that the variables from @xmath514 do not participate in any relations .",
    "the quadratic equation corresponding to @xmath363 can be written in the standard form with coefficients expressed in terms of non - active variables .",
    "here we have to give some definitions .",
    "a standard quadratic equation over the group @xmath1 is an equation of the one of the following forms ( below @xmath515 are nontrivial elements from @xmath1 ) : @xmath516 \\prod_{i=1}^m z_i^{-1 } c_i z_i d = 1,\\ \\ \\ n , m \\geqslant 0 , m + n \\geqslant 1;\\ ] ] @xmath517 where @xmath518 are coefficients .",
    "let @xmath519 be a strictly quadratic word over a group @xmath1 .",
    "then there is a @xmath1-automorphism @xmath520)$ ] such that @xmath521 is a standard quadratic word over @xmath522    to each quadratic equation one can associate a punctured surface .",
    "for example , the orientable surface associated to equation [ eq : st2 ] will have genus @xmath4 and @xmath523 punctures .    put @xmath524    [ regular ] let @xmath525 be a standard quadratic equation over a group @xmath1 which has a solution in @xmath1 .",
    "the equation @xmath526 is _ regular _ if @xmath527 ( equivalently , the euler characteristic of the corresponding punctured surface is at most @xmath528 ) and there is a non - commutative solution of @xmath526 in @xmath1 , or it is an equation of the type @xmath62 d = 1 $ ] , or @xmath529[x_2,y_2 ] = 1 $ ] .    if the quadratic equation corresponding to @xmath363 is regular , then @xmath492 has a presentation as a fundamental group of a graph of groups with qh - subgroup corresponding to this equation .",
    "( for example , the qh - subgroup corresponding to the standard equation ( [ eq : st2 ] ) has the presentation @xmath530 \\prod_{i=1}^{m+1 } p_i = 1 \\rangle,\\ ] ] and the edge groups are @xmath531 . )    if the equation is not regular and there are quadratic bases , then @xmath492 splits as an hnn - extension over an abelian subgroup . if there are infinitely small @xmath233 s in the quadratic part such that @xmath372 then @xmath532 splits as a free product of the group of the generalized equation on the non - quadratic part ( obtained by removing the quadratic part and all bases that have doubles in quadratic part ) and a free group .",
    "we say that a base _ participates _ in the infinite process of entire transformation if it participates infinitely many times as a leading or transfer base .",
    "if @xmath363 has quadratic - coefficient bases , and the entire transformation goes infinitely , then after a finite number of steps there will be quadratic bases that have length infinitely larger than all participating quadratic coefficient bases .",
    "after finite number of steps quadratic - coefficient bases can only be used as transfer bases ( otherwise quadratic bases would be leaving @xmath363 , and this can not happen infinitely many times ) .",
    "every time such a base of length @xmath533 used as a transfer base , the length of the quadratic part decreases by @xmath533 . for the process to go infinitely , @xmath533 must be infinitely less than the length of the quadratic part .",
    "therefore there is a quadratic base that have length infinitely larger than all participating quadratic coefficient bases .",
    "if @xmath363 does not have quadratic - coefficient bases then @xmath534 splits as a free product with one factor being a closed surface group or a free group .",
    "we move @xmath363 into a non - active part and thus decrease the complexity @xmath463 .",
    "eventually in this case we will make the active part empty .      in this case",
    "@xmath488 for all @xmath233 in the active part such that @xmath424 is comparable with the length of the active part ( some short bases may be covered once or more than twice ) .",
    "this case is , actually , a part of the case considered in the next subsection , but we consider it separately to make the subdivision into the cases depend only on @xmath535 for the variables @xmath233 of the maximal height .",
    "we apply the transformation ( d1 ) to close quadratic sections that begin with bases of the maximal height and put them in front of the interval .",
    "this may increase the complexity by two times the number of closed sections that we put in front of the interval applying ( d1 ) .",
    "then we apply the entire transformation .",
    "every time when the content of one of the closed sections in front of the interval is moved to the other closed section , the complexity decreases by two .",
    "if the process goes infinitely then eventually the number of quadratic bases of maximal height does not decrease .",
    "after a finite number of steps participating quadratic - coefficient bases can only be used as transfer bases . and ,",
    "therefore , there will be participating quadratic bases that have length infinitely larger than all participating quadratic coefficient bases .",
    "we fill in all the @xmath489 in the active part such that @xmath490 by new ( infinitely short ) bases @xmath208 such that @xmath370 covers a new free variable in the non - active part appearing only once .",
    "then we work with the quadratic part the same way as in the quadratic case .",
    "we repeat the described transformation until there is no quadratic base on the active part that has length comparable with the length of the remaining active part .",
    "then we consider the remaining generalized equation in the active part .",
    "we remove from the active part doubles of all quadratic coefficient bases that belong to non - active part ( doing this we may create new boundaries ) .",
    "we will , certainly remember the relations corresponding to these pairs of bases . in this case",
    "the remaining generalized equation has smaller complexity .",
    "relations corresponding to the quadratic sections that we made non - active show that @xmath310 is an hnn - extension of the subgroup generated by the variables in the active part and ( maybe ) a free group .    removing these double bases",
    "we have to add equations to @xmath536 that guarantee that the associated cyclic subgroups are generated by elements of the same length .",
    "generalized equation @xmath466 satisfies the condition @xmath537 for each @xmath233 in the active part such that @xmath424 is comparable with the length of the active part , and @xmath538 for at least one @xmath233 .",
    "first of all , we fill in all the @xmath489 in the active part such that @xmath490 by new ( infinitely short ) bases with doubles corresponding to free variables in the non - active part .",
    "we apply the transformation ( d1 ) to close the quadratic part and put it in front of the interval .",
    "[ [ a - qh - subgroup - case . ] ] ( a ) qh - subgroup case .",
    "+ + + + + + + + + + + + + + + + + + + + +    suppose that the entire transformation of the quadratic part ( d8 ) goes infinitely .",
    "then the quadratic part of @xmath466 ( or the initial section from the beginning of the quadratic part until the first base on the quadratic part that does not participate in the entire transformation ) corresponds to a qh - vertex or to the representation of @xmath292 as an hnn - extension , and there is a quadratic base ( on this section ) that is infinitely longer than all the quadratic coefficient bases ( on this section ) .",
    "we work with the quadratic part the same way as in the quadratic case until there is no quadratic base satisfying the condition above .",
    "then we make the quadratic section non - active , and consider the remaining generalized equation where we remove doubles of all the quadratic coefficient bases .",
    "we certainly have to remember that the bases that we removed express some variables in the quadratic part ( that became non - active ) in the variables in the active part .",
    "we have to add an equation to @xmath536 that guarantees that the associated cyclic subgroups are generated by elements of the same length . in this case",
    "the subgroup of @xmath292 that is isomorphic to the coordinate group of the new generalized equation in active part is a vertex group in an abelian splitting of @xmath292 and has smaller delzant  potyagailo complexity .",
    "[ [ b - qh - shortening ] ] ( b ) qh - shortening + + + + + + + + + + + + + + + + +    suppose that the quadratic part of @xmath199 does not correspond to the hnn - splitting of @xmath292 ( there are only quadratic coefficient bases ) , or , we can not apply the entire transformation to the quadratic part infinitely . in this case",
    "either @xmath310 is a non - trivial free product or , applying the automorphism of @xmath292 , one can replace the words corresponding to the quadratic bases in the quadratic part by such words that in the new solution @xmath539 of @xmath199 the length of the quadratic part is bounded by some function @xmath540 times the length of the non - quadratic part .",
    "solution @xmath539 can be chosen consistent with @xmath541 .",
    "we apply entire transformation to the quadratic part .",
    "this corresponds to a sequence of tietze transformations of generators of @xmath292 .",
    "since the entire transformation does not go infinitely , some of the bases will eventually be transferred to the non - quadratic part ( therefore , their length is bounded by the length of the non - quadratic part ) .",
    "if not all of them are transferred , then reincarnations of some of the other participating bases must form matching pairs giving a representation of @xmath292 as a free product .",
    "if there is a matching pair , we replace @xmath310 by the group obtained by removing a cyclic free factor corresponding to a matching pair .",
    "we also replace @xmath199 by the generalized equation obtained by removing the matching pair .",
    "the delzant  potyagailo complexity decreases .",
    "[ [ c - abelian - splitting - short - shift . ] ] ( c ) abelian splitting : short shift .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    [ perst ] suppose @xmath466 satisfies the following condition : the carrier base @xmath208 of the equation @xmath466 intersects with its dual @xmath370 ( form an overlapping pair ) and is at least twice longer than @xmath542",
    ". then @xmath492 either splits as a fundamental group of a graph of groups that has a free abelian vertex group or splits as an hnn - extension with abelian associated subgroups .",
    "the proof uses the technique of so - called periodic structures introduced by razborov in his ph.d thesis and almost repeats the proof given in @xcite to show that the coordinate group of a generalized equation splits in this case as a fundamental group of a graph of groups that has a free abelian vertex group or splits as an hnn - extension with abelian associated subgroups .",
    "nevertheless , we have to adjust the proof to the case of infinite non - archimedean words . for convenience of the reader",
    "we give a detailed proof of the proposition .",
    "we construct an auxiliary equation @xmath543 ( which does not occur in @xmath464 ) as follows .",
    "firstly , we add a new constant non - active section @xmath544 $ ] to the right of all sections in @xmath466 ( in particular , @xmath545 is a new free variable ) .",
    "secondly , we introduce a new pair of bases @xmath235 such that @xmath546 notice that @xmath466 can be obtained from @xmath543 by ( et4 ) : deleting @xmath324 together with the closed section @xmath544 $ ] .",
    "let @xmath547 be the isomorphism induced by ( et4 ) .",
    "general jsj - case still holds for @xmath548 , but now @xmath225 is the carrier base . applying to @xmath548 the entire transformation we obtain a new vertex @xmath477 together with the isomorphism @xmath549    as a culmination of the above process of adding auxiliary edges we get a generalized equation @xmath365 , which consists of finitely many closed sections @xmath550 such that there exists an overlapping pair @xmath551 for each @xmath552 $ ] .",
    "let @xmath553 , where @xmath554 $ ] have the overlapping pair @xmath555 such that @xmath556| = \\max_{i \\in [ 1,p ] } |[\\alpha(\\mu_i ) , \\alpha(\\overline\\mu_i)]|.\\ ] ] without loss of generality we can assume @xmath557 , that is , @xmath558 $ ] .    a _ periodic structure _ on @xmath365 is a pair @xmath559 , where    1 .",
    "@xmath560 is a set consisting of some items @xmath233 , some bases @xmath225 , and some closed sections @xmath363 from @xmath365 such that the following conditions are satisfied : * if @xmath561 and @xmath562 then @xmath563 , * if @xmath563 , then @xmath564 , * if @xmath563 and @xmath565 , then @xmath566 , * there exists a function @xmath567 mapping the set of closed sections from @xmath560 into @xmath568 such that for every @xmath569 , the condition that @xmath570 and @xmath571 implies @xmath572 .",
    "@xmath296 is an equivalence relation on the set of boundaries @xmath573 belonging to closed sections from @xmath560 ( if a boundary @xmath418 belongs to two closed section @xmath574 , \\sigma_{right}(l ) = [ l , j]$ ] from @xmath560 then instead of @xmath418 we add to @xmath573 formal copies @xmath575 of @xmath418 , which are boundaries of @xmath576 and @xmath577 respectively ) , defined as follows : if @xmath563 then @xmath578 @xmath579    we call items , bases and sections _ long _ if they belong to @xmath560 ( the rest items , bases and sections of @xmath365 are called _ short _ respectively ) .    a _ period _ is just a cyclically reduced @xmath0-word @xmath146 .",
    "a reduced infinite word @xmath135 is called _",
    "@xmath146-periodic _ for a period @xmath146 if @xmath580 , where @xmath581 .",
    "since @xmath146 is cyclically reduced it follows that either @xmath582 , or @xmath583 .",
    "we are going to distinguish two cases of periodicity :    1 .",
    "@xmath135 is _ unbounded _",
    "@xmath146-periodic if @xmath584 , 2 .   @xmath135 is _ bounded _",
    "@xmath146-periodic if @xmath585 and @xmath586 , where @xmath587 and @xmath588",
    ".    observe that in both cases @xmath135 begins with a power of @xmath146 , but in the former case the power is unbounded , while in the latter case it is bounded ( hence the terms used ) .",
    "[ product ] let @xmath589 , where @xmath590 , be @xmath146-periodic for some period @xmath591 .",
    "assume that @xmath592 .",
    "if @xmath593 is defined in @xmath594 then @xmath595 cancels completely in this product .",
    "moreover , @xmath593 is @xmath596-periodic",
    ".    follows from the definition of @xmath146-periodic words .",
    "[ double shift ] if @xmath597 is both @xmath146- and @xmath147-periodic for some periods @xmath598 then @xmath599 = 1 $ ] .",
    "in particular , @xmath146 is unbounded @xmath147-periodic if @xmath600 .",
    "if @xmath601 then commutativity follows from lemma 3.3 @xcite since powers of @xmath146 and @xmath147 have a common initial segment of length greater than @xmath602 .",
    "if @xmath600 then from @xmath147-periodicity of @xmath135 it follows that @xmath146 is @xmath147-periodic .",
    "now , since @xmath135 contains any natural power of @xmath146 as an initial subword it follows that the terminal subword of @xmath146 of length @xmath603 must coincide with @xmath147 and commutativity follows .",
    "let @xmath247 be a solution of the equation @xmath365 , where @xmath604 .",
    "according to our assumption , @xmath605 is @xmath606-periodic , where @xmath607 $ ] .",
    "since @xmath208 and @xmath370 are products of items then every @xmath608 $ ] , such that @xmath609 , is @xmath610-periodic , where @xmath610 is a @xmath0-word such that @xmath611 .",
    "moreover , we can associate with @xmath247 a periodic structure @xmath612 as follows .",
    "we construct @xmath560 as a union of the chain of sets @xmath613 where @xmath614 . to construct @xmath615",
    "we add to it @xmath616 and all @xmath617-periodic items @xmath618 , where @xmath619 , together with any base @xmath225 ( and its dual ) containing @xmath333 .",
    "now , assume that @xmath620 is constructed . if there exists a base @xmath621 such that @xmath622 then we set @xmath623 since @xmath365 contains only finitely many closed sections then this process stops .    [ periodicity ]",
    "let @xmath247 be a solution of the equation @xmath365 and @xmath624 be a periodic structure corresponding to @xmath247 .",
    "then every base ( item ) @xmath563 is @xmath625-periodic , where @xmath626 and @xmath625 is conjugate to @xmath606 in @xmath1 .",
    "it is enough to prove the statement for bases - the argument for items is similar .",
    "we are going to use the induction on @xmath627 , where @xmath627 is the number of sections in @xmath560    by our assumption ( short shift ) we have @xmath628 .",
    "it follows that any base @xmath629 , such that @xmath630 , is @xmath625-periodic , where @xmath631 $ ] then @xmath632 and @xmath633 .",
    "hence , all bases from @xmath634 have the properties stated in the lemma .",
    "suppose we have the statement of the lemma for all bases from @xmath635 . by definition , @xmath636 is obtained from @xmath635 by adding a section @xmath637 , such that there exists @xmath638 and @xmath639 , as well as all appropriate items and bases of @xmath637 .",
    "observe that since @xmath640 is @xmath617-periodic , where @xmath641 $ ] , it follows that @xmath324 is @xmath642-periodic , where @xmath643 and @xmath642 is conjugate to @xmath617 by means of @xmath71 . at the same time , by the induction hypothesis , @xmath225 is @xmath625-periodic , where @xmath626 .",
    "hence , by lemma [ double shift ] we have @xmath644 = 1 $ ] and it follows that @xmath645 = 1 $ ] , where @xmath646 .",
    "now , since latexmath:[$|p| \\geqslant    @xmath640 is @xmath648-periodic .",
    "the statement of the lemma for all bases in @xmath637 of the length at least @xmath649 follows automatically now .",
    "[ rem : period ] from the construction of @xmath624 and lemma [ periodicity ] it follows that if @xmath650 with an overlapping pair @xmath651 and if @xmath652 $ ] then there exists a period @xmath653 conjugate in @xmath1 either to @xmath606 or @xmath654 such that    1 .   if @xmath655 ) > ht(p)$ ] then @xmath656 $ ] has any natural power of @xmath653 as a terminal subword , 2 .   if @xmath657 ) > ht(p)$ ] then @xmath658 $ ] has any natural power of @xmath653 as an initial subword , 3 .   if @xmath655 ) \\leqslant ht(p)$ ] then @xmath656 = q '' \\circ q_l^{k_l}$ ] , where @xmath659 , 4 .   if @xmath657 ) \\leqslant ht(p)$ ] then @xmath658 = q_l^{k_l } \\circ q'$ ] , where @xmath659 .",
    "[ le : pp ] @xmath624 corresponding to a solution @xmath247 of @xmath365 is a periodic structure on @xmath365 .",
    "parts 1(a ) , 1(b ) and 1(c ) of the definition of periodic structure hold by construction .    set @xmath660 . if there is a base @xmath570 such that @xmath661 then we set @xmath662 .",
    "observe that the sign of @xmath663 is well - defined since",
    "if there exists another base @xmath664 such that @xmath665 and @xmath666 then it follows that there exists a group element conjugating @xmath606 into @xmath654 , which is impossible .",
    "hence 1(d ) holds .    by remark [ rem :",
    "period ] if two boundaries @xmath667 belong to sections from @xmath560 then there exist @xmath668 conjugate in @xmath1 either to @xmath606 or @xmath654 such that some of the conditions listed in the remark hold .",
    "thus , we define a relation @xmath296 as follows : @xmath669 if and only if @xmath670 , and part 2 follows immediately .",
    "now let us fix a nonempty periodic structure @xmath559 .",
    "item ( d ) allows us to assume ( after replacing the variables @xmath671 by @xmath672 on those sections @xmath673",
    "\\in { \\mathcal p}$ ] for which @xmath674 ) = -1 $ ] ) that @xmath675 for all @xmath628 .",
    "for a boundary @xmath627 , we will denote by @xmath676 the equivalence class of the relation @xmath296 to which it belongs .",
    "let us construct an oriented graph @xmath84 whose set of vertices is the set of @xmath296-equivalence classes .",
    "for each long @xmath677 we introduce an oriented edge @xmath266 leading from @xmath676 to @xmath678 and an inverse edge @xmath679 leading from @xmath678 to @xmath676 .",
    "this edge @xmath266 is assigned the label @xmath680 ( respectively , @xmath681 ) .",
    "for every path @xmath682 in the graph @xmath84 , we denote by @xmath683 its label @xmath684 .",
    "the periodic structure @xmath559 is called _ connected _ , if the graph @xmath84 is connected .",
    "suppose first that @xmath559 is connected .",
    "we can also suppose that each boundary of @xmath365 is a boundary between two bases .",
    "[ paths ] let @xmath247 be a solution of @xmath365 and @xmath685 . if @xmath224 is a path in the graph @xmath84 from @xmath686 to @xmath687 then @xmath688^{-1 } \\ast q_i \\ast u[p ] = q_j$ ] in @xmath1 .    if @xmath689 then all products between @xmath690 are defined and the required result follows from lemma [ product ] .",
    "[ cycles ] let @xmath247 be a solution of @xmath365 and @xmath685 .",
    "if @xmath691 are cycles in the graph @xmath84 at the vertex @xmath692 then @xmath693 , u[c_2 ] ] = 1 $ ] in @xmath1 .    assume at first that @xmath694 .",
    "there exists a loop @xmath695 at @xmath696 such that @xmath697 = p$ ] . by lemma [ paths ]",
    "@xmath688^{-1 } \\ast p \\ast u[p ] = p$ ] in @xmath1 for every path @xmath224 from @xmath696 to @xmath696 , so @xmath693 , p ] = [ u[c_2 ] , p ] = 1 $ ] and from the csa - property of @xmath1 the required follows .",
    "if @xmath698 then , since @xmath84 is connected it follows that there exists a path @xmath224 from @xmath147 to @xmath465 .",
    "moreover , by lemma [ paths ] we have @xmath688^{-1 } \\ast q_k \\ast u[p ] = p$ ] in @xmath1 .",
    "so , by the csa - property commutativity of cycles at @xmath676 follows from commutativity of cycles at @xmath696 which is already proved .    @xmath365 is called _ periodized _ with respect to a given periodic structure @xmath699 if for every two cycles @xmath700 and @xmath701 with the same initial vertex in the graph @xmath84 there is a relation @xmath702 = 1 $ ] in @xmath393 .",
    "observe that according to lemma [ cycles ] @xmath365 is periodized with respect to @xmath624 for any solution @xmath247 .",
    "let @xmath703 be the subgraph of the graph @xmath84 having the same set of vertices and consisting of the edges @xmath266 whose labels do not belong to @xmath560 .",
    "choose a maximal sub - forest @xmath704 in the graph @xmath703 and extend it to a maximal sub - forest @xmath514 of the graph @xmath84 .",
    "since @xmath705 is connected by assumption , it follows that @xmath514 is a tree .",
    "let @xmath465 be an arbitrary vertex of the graph @xmath84 and @xmath706 the ( unique ) path from @xmath465 to @xmath147 all of whose vertices belong to @xmath514 .",
    "for every edge @xmath707 not lying in @xmath514 , we introduce a cycle @xmath708 .",
    "then the fundamental group @xmath709 is generated by the cycles @xmath710 ( see , for example , the proof of proposition 3.2.1 @xcite ) .",
    "furthermore , the set of elements @xmath711 forms a basis of the free group with the set of generators @xmath712 .",
    "if @xmath713 , then @xmath714 by the definition of @xmath296 and , consequently , the word @xmath715\\ h[\\alpha(\\overline\\lambda ) , \\beta(\\overline\\lambda)]^{-1}\\ ] ] is the label of a cycle @xmath716 from @xmath717 . let @xmath718 .",
    "then @xmath719\\ h[\\alpha(\\overline\\lambda ) , \\beta(\\overline \\lambda)]^{-1}\\ u^{-1},\\ ] ] where @xmath146 is a certain word .",
    "since @xmath720 , it follows that @xmath721 , where @xmath722 is a certain word in the indicated generators which can be effectively constructed ( see proposition 3.2.1 @xcite ) .",
    "let @xmath723 denote the image of the word @xmath722 in the abelianization of @xmath724 .",
    "denote by @xmath725 the free abelian group consisting of formal linear combinations @xmath726 , and by @xmath727 its subgroup generated by the elements @xmath728 and the elements @xmath729 .",
    "let @xmath730 the torsion subgroups of the group @xmath731 , and @xmath732 the preimage of @xmath733 in @xmath725 .",
    "the group @xmath734 is free , therefore , there exists a decomposition of the form @xmath735 of the group @xmath725 in terms of the generators @xmath736 so that for the subgroups @xmath732 and @xmath737 generated respectively by @xmath738 and @xmath739 , the relation ( [ 2.54 ] ) holds .",
    "it suffices , for instance , to look through the bases one by one , using the fact that under the condition @xmath740 the relations @xmath741 hold if and only if the generators of the groups @xmath727 and @xmath732 generate the same linear subspace over @xmath742 , and the latter is easily verified algorithmically .",
    "notice , that a more economical algorithm can be constructed by analyzing the proof of the classification theorem for finitely generated abelian groups . by proposition",
    "1.4.4 @xcite , one can effectively construct a basis @xmath743 , @xmath744 of the free ( non - abelian ) group @xmath745 so that @xmath738 , @xmath739 are the natural images of the elements @xmath743 , @xmath744 in @xmath725 .    now assume that @xmath559 is an arbitrary periodic structure on @xmath365 , not necessarily connected .",
    "let @xmath746 be the connected components of the graph @xmath84 .",
    "the labels of edges of the component @xmath747 form in @xmath365 a union of closed sections from @xmath560 . moreover , if a base @xmath563 belongs to such a section , then its dual @xmath324 also does by definition of periodic structure . therefore , by taking for @xmath748 the set of labels of edges from @xmath747 belonging to @xmath560 , sections to which these labels belong , and bases @xmath563 belonging to these sections , and restricting in the corresponding way the relation @xmath296 , we obtain a periodic connected structure @xmath749 with the graph @xmath747 .",
    "the notation @xmath750 means that @xmath751 and the relation @xmath752 is a restriction of the relation @xmath296 .",
    "in particular , @xmath753 in the situation described in the previous paragraph . since @xmath365 is periodized , the periodic structure must be connected .",
    "let @xmath754 be all the edges of the graph @xmath84 from @xmath755 .",
    "since @xmath704 is the spanning forest of the graph @xmath703 , it follows that @xmath756 .",
    "let @xmath757 be a free group generated by the variables of @xmath365 .",
    "consider in the group @xmath757 a new basis @xmath758 where variables @xmath759 do not belong to the closed sections from @xmath760 .",
    "let @xmath761 be the initial vertex of the edge @xmath762 .",
    "we introduce new variables @xmath763 for @xmath764 , as follows @xmath765 @xmath766    without loss of generality we can assume @xmath767 .",
    "[ 2.10  ] let @xmath365 be periodized with respect to a periodic structure @xmath559 .",
    "let @xmath416 be the subgroup of @xmath393 generated by @xmath768\\}.\\ ] ] if @xmath769 then the group @xmath393 splits as a fundamental group of a graph of groups with two vertices , where one vertex group is @xmath416 and the other is a free abelian group generated by @xmath770 .",
    "the corresponding edge group is generated by @xmath771 .",
    "the other edges are loops at the vertex with vertex group @xmath416 , have stable letters @xmath772 $ ] , and associated subgroups @xmath773 . if @xmath774 then there is no vertex with abelian vertex group .",
    "we are going to study in more detail how the variables @xmath772 $ ] can participate in the equations from @xmath365 rewritten in the set of variables @xmath775 .",
    "if @xmath677 does not lie on a closed section from @xmath560 , or @xmath776 , but @xmath777 ( where @xmath778 ) , then @xmath677 belongs to the basis @xmath775 and is distinct from each of @xmath779 .",
    "now let @xmath778 , @xmath776 and @xmath780 .",
    "then @xmath781 , where @xmath782 are paths in @xmath514 . since @xmath783 belongs to @xmath784 modulo commutation of cycles .",
    "the vertices @xmath676 and @xmath678 lie in the same connected component of the graph @xmath703 and , hence , they are connected by a path @xmath785 in the forest @xmath704 . furthermore , @xmath786 and @xmath787 are paths in the tree @xmath514 connecting the vertices @xmath676 and @xmath465 . consequently , @xmath788 .",
    "thus , @xmath789 and @xmath790 .",
    "the variable @xmath772 $ ] can occur in the right - hand side of the expression obtained ( written in the basis @xmath775 ) only in @xmath791 and at most once . moreover , the sign of this occurrence ( if it exists ) depends only on the orientation of the edge @xmath762 with respect to the root @xmath465 of the tree @xmath514 .",
    "if @xmath792 then all the occurrences of the variable @xmath793 in the words @xmath677 written in the basis @xmath775 , with @xmath794 , are contained in the occurrences of words of the form @xmath795 , that is , in occurrences of the form @xmath796 , where @xmath695 is a certain cycle of the graph @xmath84 starting at the initial vertex of the edge @xmath797 .    therefore all the occurrences of @xmath772 $ ] in the equations corresponding to @xmath798 are of the form @xmath799 .",
    "also , @xmath793 does not occur in the equations corresponding to @xmath563 in the basis @xmath775 .",
    "the system @xmath365 is equivalent to the following system in the variables @xmath775 : @xmath800 @xmath801 @xmath802 = 1,\\ ] ] @xmath803 = 1 , \\ c_1,c_2",
    "\\in c^{(1 ) } , c^{(2)},\\ ] ] @xmath804 where @xmath805 does not contain @xmath806 .",
    "let @xmath807 . then to obtain @xmath292 we first take an hnn - extension of the group @xmath416 with abelian associated subgroups generated by @xmath808 and @xmath809 and stable letters @xmath793 , and then extend the centralizer of the image of @xmath810 by the free abelian subgroup generated by the images of @xmath811 .",
    "proposition [ perst ] now follows from lemma [ 2.10  ] .",
    "[ [ d - abelian - splitting - long - shift . ] ] ( d ) abelian splitting : long shift .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    if @xmath199 does not satisfy the conditions of ( a)(c ) , we perform qh - shortening , then apply the entire transformation and then , if possible , the transformation ( d7 ) .",
    "[ 3.2 ] let @xmath812 be an infinite path in @xmath464 .",
    "then there exists a natural number @xmath813 such that all the generalized equations in vertices @xmath814 satisfy the general jsj - case ( d ) .",
    "indeed , the tietze cleaning either replaces the group by its proper free factor or decreases the complexity .",
    "every time when the case ( a ) holds we replace @xmath1 by some vertex group in a non - trivial abelian splitting of @xmath1 . this can be done only finitely many times @xcite .",
    "every time when case ( c ) takes place , we decrease the complexity .    [",
    "( d ) ] the general jsj case ( d ) can not be repeated infinitely many times .",
    "consider an infinite path @xmath815 we have @xmath816 .",
    "denote by @xmath377 the carrier base of the equation @xmath817 .",
    "the path ( [ 3.6 ] ) will be called @xmath208-reducing if @xmath818 , and either @xmath382 does not overlap with its double or they overlap but @xmath819 , and @xmath208 occurs in the sequence @xmath820 at least twice .",
    "the path ( [ 3.6 ] ) is called _ prohibited _ if it can be represented in the form @xmath821 such that for some sequence of bases @xmath822 the following three properties hold :    1 .",
    "every base occurring at least once in the sequence @xmath820 occurs at least @xmath823 times in the sequence @xmath824 , where @xmath4 is the number of pairs of bases in equations @xmath817 , 2 .",
    "the path @xmath269 is @xmath825-reducing , 3 .",
    "every transfer base of some equation of path @xmath826 is a transfer base of some equation of path @xmath827 .",
    "every infinite path contains a prohibited subpath .",
    "indeed , let @xmath828 be the set of all bases occurring in the sequence @xmath829 infinitely many times , and @xmath830 the set of all bases , that are transfer bases of infinitely many equations @xmath817 .",
    "if one cuts out some finite part in the beginning of this infinite path , one can suppose that all the bases in the sequence @xmath829 belong to @xmath828 and each base that is a transfer base of at least one equation , belongs to @xmath830 .",
    "such an infinite path for any @xmath831 contains infinitely many non - intersecting @xmath208-reducing finite subpaths .",
    "hence , it is possible to construct a subpath ( [ 3.7 ] ) of this path satisfying the first two conditions in the definition of a prohibited subpath . making @xmath827 longer one obtains a prohibited subpath .",
    "suppose we have a prohibited path ( [ 3.6 ] ) .",
    "as before , let @xmath377 denote the carrier base of @xmath817 , and @xmath832 and @xmath830 denote the set of such bases which are transfer bases for at least one equation in ( [ 3.6 ] ) .",
    "by @xmath833 denote the set of such bases @xmath208 for which either @xmath208 or @xmath370 belongs to @xmath834 .",
    "by @xmath835 denote the set of all the other bases .",
    "let @xmath836 where @xmath497 is the boundary between active and non - active sections .",
    "let @xmath837.\\ ] ] if @xmath838 corresponds to a vertex in the sequence ( [ 3.6 ] ) then denote @xmath839    we call @xmath840 the _ excess _ of @xmath199",
    ". since the case ( a ) is not applicable , @xmath841 and is comparable with the length of the section @xmath842 $ ] . consider the quadratic part of @xmath843 which is situated to the left of @xmath844 .",
    "let @xmath20 be the length of the quadratic part and @xmath307 be the length of the non - quadratic part .",
    "suppose there exists a function @xmath845 such that we have an inequality @xmath846 then there is a function @xmath847 such that @xmath848 , because @xmath849 .    from the definition of the process it follows that all the words @xmath850 $ ]",
    "are the ends of the word @xmath851 $ ] , that is @xmath852 \\doteq u_i u^{(i)}[1 , \\rho_i + 1].\\ ] ] on the other hand any base @xmath853 participates in these transformations neither as a carrier base , nor as a transfer base .",
    "hence , @xmath854 $ ] is the end of the word @xmath850 $ ] , that is , @xmath855",
    "\\doteq v_i u^{(1)}[\\alpha(\\omega ) , \\rho_1 + 1].\\ ] ] so we have @xmath856 in particular ( [ 3.13 ] ) , ( [ 3.22 ] ) imply that @xmath857 .",
    "denote the number ( [ 3.22 ] ) by @xmath858 .",
    "let the path ( [ 3.6 ] ) be @xmath208-reducing .",
    "estimate @xmath859 from below .",
    "first notice that if @xmath860 for @xmath861 and @xmath862 for @xmath863 then @xmath864|.\\ ] ] indeed , if @xmath865 then @xmath866 = d(u^{(i_1 + 1)}[1 , \\alpha(\\overline\\mu)]$ ] .",
    "if @xmath867 then @xmath868 and @xmath208 is a transfer base in the equation @xmath869 .",
    "hence , @xmath870| = |u^{(i_1 + 1)}[1 , \\alpha(\\mu_{i_1 + 1})]|$ ] . now ( [ 3.23 ] ) follows from @xmath871|.\\ ] ] so , if the bases @xmath382 and @xmath872 do not intersect in the equation @xmath873 then ( [ 3.23 ] ) implies that @xmath874| \\geqslant    which implies that @xmath875 we obtain the same inequality if @xmath382 overlaps with @xmath876 but @xmath877    suppose now that the path ( [ 3.6 ] ) is prohibited .",
    "hence , it can be represented in the form ( [ 3.7 ] ) . from the definition ( [ 3.13 ] ) we have @xmath878 .",
    "so , at least for one base @xmath879 the inequality @xmath880 holds . because @xmath881 , we can suppose that @xmath882 .",
    "let @xmath883 be the length of the path @xmath884 in ( [ 3.7 ] ) .",
    "if @xmath885 then by the third part of the definition of a prohibited path there exists @xmath886 such that @xmath208 is a transfer base of @xmath817 .",
    "hence , @xmath887 . if @xmath888 then take @xmath208 instead of @xmath377 .",
    "we proved the existence of a base @xmath888 such that @xmath889 ) and the inequality @xmath890 , we obtain @xmath891 by ( [ 3.22 ] ) the sum in the left part of the inequality ( [ 3.28 ] ) equals @xmath892 .",
    "hence , @xmath893 which , in case of the inequality ( [ quadr ] ) , contradicts ( [ psi ] ) .",
    "this contradiction was obtained from the supposition that there are prohibited paths ( [ 3.6 ] ) .",
    "hence there are no prohibited paths .",
    "the proposition is proved .",
    "* proof of theorem [ th : main1 ] .",
    "* we perform the elimination process for the generalized equation @xmath894 corresponding to @xmath1 .",
    "if the process goes infinitely we obtain one of the following :    * free splitting of @xmath1 with at least on non - trivial free factor ( 4.4.1 ) and , maybe , some surface group factor ( 4.4.2 ) , * a decomposition of @xmath1 as the fundamental group of a graph of groups with qh - vertex groups corresponding to quadratic sections ( 4.4.4 ( a ) ) , * decomposition of @xmath1 as the fundamental group of a graph of groups with abelian vertex groups corresponding to periodic structures ( see proposition [ perst ] in 4.4.4 ( c ) ) and hnn - extensions with stable letters infinitely longer than the generators of the abelian associated subgroups ( 4.4.4 ( c ) ) .",
    "then we continue the elimination process with the generalized equation @xmath895 where the active part corresponds to weakly rigid subgroups . in the case of an hnn - extension",
    "the complexity @xmath896 is smaller than @xmath897 in the other cases the delzant  potyagailo complexity of weakly rigid subgroups is smaller by proposition [ dp ]",
    ". therefore this procedure stops . at the end",
    "we obtain some generalized equation @xmath898 with all non - active sections . continuing the elimination process till the end",
    ", we obtain a complete system of linear equations with integer coefficients @xmath899 on the lengths of items @xmath233 s that is automatically satisfied , therefore the associated maximal abelian subgroups are length - isomorphic .    notice",
    "that if @xmath900 is obtained as the fundamental group of a graph of groups with two vertices , where @xmath19 is one vertex group and the other vertex is a qh - vertex , then one can also obtain @xmath18 from @xmath19 by taking a free product of @xmath19 and a free group and then the hnn - extension with cyclic associated subgroups .",
    "if @xmath18 is an amalgamated product of @xmath19 and a free abelian group then it can be obtained from @xmath19 as a series of extensions of centralizers .",
    "this completes the proof of theorem [ th : main1 ] .",
    "@xmath901    [ nonreg1 ] if we begin with the group @xmath2 mentioned in remark [ nonreg ] with free but not necessary regular length function in @xmath0 then in the elimination process we work with the generalized equation @xmath199 and add a finite number of elements from @xmath313 .",
    "thus we got an embedding of @xmath2 in a group that can be represented as a union of a finite series of groups @xmath16 where    1 .",
    "@xmath17 is a free group , 2 .",
    "@xmath18 is obtained from @xmath19 by finitely many hnn - extensions in which associated subgroups are maximal abelian and length isomorphic as subgroups of @xmath0 .    [ fin ] as a result of the elimination process , the equation @xmath898 ( we will denote it @xmath902 ) is defined on the multi - interval @xmath903 , that is , a union of closed sections which have a natural hierarchy : a section @xmath616 is smaller than a section @xmath904 if the largest base on @xmath904 is infinitely larger than the largest base on @xmath616 .    the lengths of bases satisfy the system of linear equations @xmath899 .",
    "suppose @xmath1 , as above , is a @xmath0-free group with a regular action .",
    "let @xmath199 be a generalized equation for @xmath1 corresponding to the union of closed sections @xmath903 , @xmath905 .",
    "consider the cayley graph @xmath906 of @xmath1 with respect to the generators @xmath907 .",
    "assign to edges of @xmath908 their lengths in @xmath0 and consider edges as closed intervals in @xmath0 of the corresponding length . for each relation between bases of @xmath199 , @xmath909 ( without cancelation ) there is a loop in @xmath43 labeled by this relation .",
    "then the path on the boundary of this loop labeled by @xmath910 has the same length in @xmath0 as the path labeled by @xmath911 .",
    "if @xmath92 is a point on the path @xmath910 at the distance @xmath912 from the beginning of the path , and @xmath913 is a point on the path @xmath911 at the distance @xmath914 from the beginning , then we say that _ @xmath92 and @xmath913 are in the same leaf_. in other words , after we substitute generators in @xmath915 by their infinite word representations , we `` fold '' loops into segments .",
    "we consider the equivalence relation between points of @xmath43 generated by all such pairs @xmath916 .",
    "equivalence classes of this relation are called _",
    "leaves_. we also glue an arc isometric to a unit interval between each @xmath92 and @xmath913 .",
    "let @xmath917 be the foliation ( the set of leaves ) .",
    "one can define a foliated complex @xmath918 associated to @xmath43 as a pair @xmath919 .",
    "we define a metric space @xmath920 as follows .",
    "the paths in @xmath921 can travel vertically ( along the leaves ) and horizontally ( along the intervals in @xmath0 ) .",
    "the length of a path @xmath922 in @xmath923 ( denoted @xmath924 ) is the sum of the lengths of horizontal intervals in @xmath922 .",
    "the pseudo - distance @xmath914 between two points of @xmath921 is defined as the length of a minimal path between them . a metric space @xmath514",
    "is obtained from @xmath921 by identifying points at pseudo - distance @xmath925 .",
    "we extend naturally the left action of @xmath1 on @xmath43 to the action on @xmath514 .",
    "we will prove the second statement first .",
    "suppose @xmath92 is a vertex of @xmath43 , @xmath926 .",
    "then @xmath927 is also a vertex of @xmath43 .",
    "if @xmath928 in @xmath921 , then @xmath92 and @xmath927 are in the same leaf . hence , there is a vertical path @xmath929 that uses relations from @xmath930 @xmath931 where all @xmath932 are products of some bases ( @xmath1 is generated by bases from @xmath201 ) ; @xmath92 is a vertex between @xmath933 and @xmath934 , @xmath935 is a vertex on @xmath377 , @xmath936 is a vertex between @xmath937 and @xmath938 .",
    "then @xmath939 , where @xmath940    since relations are coming from the generalized equation @xmath199 , @xmath933 and @xmath941 are the same infinite words , as well as @xmath942 and @xmath943 are the same infinite words for @xmath944 , and @xmath945 and @xmath937 are the same infinite words . therefore @xmath946 @xmath947 @xmath948 and @xmath949",
    "if @xmath92 is not a vertex of @xmath43 , then @xmath92 is a point on some edge of @xmath43 labeled by @xmath957 and joining some @xmath958 and @xmath959 , while @xmath960 , by translation in the cayley graph , is a point on the edge of @xmath43 labeled by @xmath957 and joining @xmath961 and @xmath962 .",
    "there is a vertical path @xmath963 that uses relations of @xmath930 @xmath964 let @xmath112 be a vertex of @xmath43 belonging to one of the loops @xmath965 and nearest to the leaf joining @xmath92 and @xmath927 .",
    "suppose @xmath112 belongs to the loop @xmath966 and it is a vertex between @xmath967 and @xmath380 .",
    "then there is a leaf joining @xmath112 and @xmath968 that uses the relations @xmath969 , and we can show that @xmath956 as above .",
    "now we prove that @xmath514 is a @xmath0-tree .",
    "suppose , we have a loop @xmath922 in @xmath921 beginning at @xmath92 , which is a vertex of @xmath43 ( @xmath970 ) .",
    "we are going to show that the image of this loop becomes degenerate in @xmath514 ( if we remove all subpaths of the form @xmath971 from the image of @xmath922 we get a point ) .",
    "notice that the image of any closed horizontal path in @xmath921 is degenerate in @xmath514 , so in the loop we can replace a horizontal subpath joining any two vertices @xmath972 by any other horizontal path joining @xmath112 and @xmath410 .",
    "represent @xmath973 , where @xmath974 is a sequence of vertical and horizontal paths between @xmath92 and another vertex @xmath112 of @xmath43 , and @xmath975 is a horizontal path between @xmath112 and @xmath92 such that if there is a horizontal subpath @xmath224 at the end of @xmath974 then @xmath224 does not contain another vertex @xmath976 .",
    "we can use induction on the number of vertical components in @xmath974 , the case of zero vertical components being trivial .",
    "we can replace the path @xmath974 by a path @xmath977 of equal or shorter length with the same image in @xmath514 such that each vertical subpath of @xmath977 is passing through some vertex of @xmath43 ( see figure [ pic : paths_0 ] ) .",
    "let @xmath978 be the first vertex of @xmath979 .",
    "suppose the last vertical part of @xmath977 begins with @xmath980 , ends with @xmath981 and is passing through @xmath982 .",
    "then the image in @xmath514 of the circle at @xmath983 consisting of the vertical path from @xmath983 to @xmath981 ( see figure [ pic : paths ] ) and the corresponding horizontal path from @xmath981 to @xmath983 ( denote it @xmath984 ) is degenerate .",
    "the image of the circle at @xmath983 consisting of the vertical path from @xmath983 to @xmath980 and the horizontal path @xmath985 is also degenerate .",
    "denote by @xmath986 the horizontal path between @xmath987 and @xmath983 .",
    "we now replace @xmath975 by @xmath988 and @xmath974 by the part of @xmath974 from @xmath92 to @xmath987 .",
    "the image of this path in @xmath514 is degenerate by induction because it has less vertical subpaths .",
    "therefore , @xmath514 is a @xmath0-tree .",
    "similarly , we can construct a @xmath0-tree where @xmath1 acts freely beginning not with the original generalized equation @xmath199 but with a generalized equation obtained from @xmath199 by the application of the elimination process . in this case",
    "we may have closed sections with some items @xmath233 with @xmath989 then to construct the cayley graph of @xmath1 in the new generators we cover items @xmath233 with @xmath990 by bases without doubles .",
    "( these bases were previously removed at some stages of the elimination process as matching pairs ) .",
    "_ proof of theorem [ th : main3 ] .",
    "_ we begin by considering the union of the smallest closed sections , see remark [ fin ] .",
    "denote the union of these sections by @xmath363 .",
    "the group @xmath541 of the generalized equation corresponding to their union is a free product of free groups , free abelian groups and closed surface groups .",
    "notice that for those sections for which @xmath372 for some maximal height items , these items @xmath233 are also products of some bases because initially every item is a product of bases .",
    "we can assume the following :    1 .",
    "for all closed sections of @xmath363 such that @xmath479 for all items of the maximal height , the number of bases of maximal height can not be decreased using entire transformation or similar transformation applied from the right of the section ( _ right entire transformation _ ) ; 2 .   for all closed sections of @xmath363 where we apply linear elimination",
    ", the number of bases of maximal height can not be decreased using the transformations as above as well as transformation ( e2 ) ( transfer ) preceded by creation of necessary boundary connections as in ( e5 ) ( denote it ( @xmath991 ) ) , ( e3 ) and first two types of linear elimination ( d6 ) ( denote it ( @xmath992 ) ) ;    indeed , if we can decrease the number of bases of maximal height using the transformations described above then we just do this and continue . since these transformations do not change the total number of bases we can also assume that they do not decrease the number of bases of second maximal height etc .",
    "we now re - define the lengths of bases belonging to @xmath363 in @xmath993 .",
    "we are going to show that all components of the length of every base can be made zeros except for the components which appear to be maximal in the lengths of bases from @xmath363 .",
    "denote by @xmath996 the minimal convex subgroup of @xmath0 containing lengths of all bases in @xmath363 , and by @xmath192 a maximal convex subgroup of @xmath996 not containing lengths of maximal height bases in @xmath363 ( it exists by zorn s lemma ) .",
    "then the quotient @xmath997 is a subgroup of @xmath998 .",
    "denote by @xmath999 the length function in @xmath998 on this quotient induced from @xmath533 .",
    "we consider elements of @xmath192 as infinitesimals .",
    "denote by @xmath1000 the @xmath998-tree constructed from @xmath514 by identifying points at zero distance ( see @xcite , theorem 2.4.7 ) .",
    "then @xmath541 acts on @xmath1000 .",
    "denote by @xmath1001 the induced length of the path @xmath922 in @xmath1000 , and by @xmath1002 the induced distance .    however , the action of @xmath541 on @xmath1000 is not free .",
    "the action is minimal , that is , there is no non - empty proper invariant subtree .",
    "notice that the canonical projection @xmath1003 preserves alignment , and the pre - image of the convex set is convex .",
    "the pre - image of a point in @xmath1000 is an infinitesimal subtree of @xmath514 .",
    "[ quad - main ] let @xmath616 be a closed section on the lowest level corresponding to a closed surface group and the lengths of the bases satisfy some system of linear equations @xmath921",
    ". then one can define the lengths of bases in @xmath616 in @xmath993 .",
    "denote by @xmath1007 the set of bases ( on all the steps of the process of entire transformation applied to the lowest level ) with non - zero oldest component and by @xmath1008 the rest of the bases ( infinitesimals ) .",
    "denote by @xmath999 the projection of the length function @xmath533 to @xmath997 as before .",
    "then @xmath1009 if and only if @xmath1010 .",
    "we apply the entire transformation to @xmath616 .",
    "if we obtain an overlapping pair or an infinitesimal section , where the process goes infinitely , we declare it non - active and move to the right .",
    "this either decreases , or does not change the number of bases in the active part .",
    "therefore , we can assume that the process goes infinitely and the number of bases in @xmath1007 never decreases .",
    "therefore bases from @xmath1008 are only used as transfer bases .",
    "we will show that the stabilizer of a pre - image of a point , an infinitesimal subtree @xmath704 of @xmath514 is generated by some elements in @xmath1008 .",
    "an element @xmath333 from @xmath541 belongs to such a stabilizer if @xmath1011 .",
    "if some product of bases not only from @xmath1008 has infinitesimal length ( denote this product by @xmath66 ) , then the identity and @xmath66 belong to leaves at the infinitesimal distance @xmath1012 in @xmath921 . therefore using elementary operations",
    "we can obtain a base of length @xmath1012 .",
    "denote by @xmath1013 the minimal convex subgroup of @xmath0 containing all elements of the same height as bases from @xmath1008 .",
    "[ quad ] let @xmath1014 be the projection of the quadratic section @xmath616 to @xmath1015 .",
    "suppose the process of entire transformation for @xmath616 goes infinitely and the number of bases in @xmath1007 never decreases .",
    "then the process of entire transformation for @xmath1014 goes infinitely too and the number of bases in @xmath1007 never decreases .        therefore , we can make all components of the lengths of bases in @xmath201 zeros except for those which are maximal components of some bases in @xmath201 . since @xmath201 is a finite set , the number of such components is finite , and the length is defined in @xmath993 for some @xmath627 not larger than the number of pairs of bases .",
    "let @xmath363 be a closed section corresponding to infinite linear elimination process for a free group as in lemma [ lin - el ] ( c ) .",
    "we cover ( for technical reasons ) items @xmath233 with @xmath990 by bases without doubles .",
    "( these bases were removed at some stages of the elimination process as matching pairs ) .",
    "[ lin ] let @xmath363 be a closed section corresponding to infinite linear elimination process for a free group as in lemma [ lin - el ] ( c ) .",
    "let @xmath1018 be the projection of section @xmath363 to @xmath1019 .",
    "suppose the process of linear elimination on @xmath1020 goes infinitely and some generalized equation @xmath365 ( with the minimal possible number of bases ) appears in this process infinitely many times .",
    "then the process of linear elimination on @xmath1018 goes infinitely . moreover , suppose for any base @xmath208 with @xmath1021 obtained by elementary transformations , @xmath1022 .",
    "if @xmath1023 , and @xmath1024 then @xmath1025 .    the first statement holds because the steps that we make in the process depend only on the situation of bases of maximal height .",
    "if some product @xmath66 of bases not only from @xmath1008 has infinitesimal length , then the identity and @xmath66 belong to leaves at the infinitesimal distance @xmath1012 in @xmath921 . therefore using elementary operations",
    "we can obtain a base @xmath208 of length comparable to @xmath1012 .",
    "therefore @xmath1026 .",
    "[ lin1 ] let @xmath1027 be a closed section corresponding to infinite linear elimination process for a free group .",
    "suppose the process of linear elimination on @xmath1018 goes infinitely and some generalized equation @xmath199 ( with the minimal possible number of bases ) appears in this process infinitely many times .",
    "suppose all items have length in @xmath1028 . then applying elementary transformations we can not decrease the difference @xmath627 between the number of items and the total number of basic and boundary equations .",
    "this difference is the rank of the free group that is the coordinate group of @xmath199 .",
    "every equation @xmath1029 that is obtained from @xmath199 by elementary operations has the free group of rank @xmath627 as the coordinate group .",
    "if we cut bases of @xmath365 along boundary connections and start removing eliminable bases , we have to remove them all .",
    "every time when we remove eliminable base we express one item in terms of the others .",
    "there must be @xmath627 items left at the end .",
    "lemma [ lin1 ] implies that if @xmath363 is a closed section corresponding to infinite linear elimination process for a free group , then a base @xmath208 with @xmath1021 can only be obtained by elementary transformations from bases in @xmath1030 .",
    "therefore , by lemma [ lin ] , if @xmath1031 , and @xmath1024 then @xmath1025 .",
    "( @xcite , lemma 1.1.6 ) if @xmath541 is a finitely generated ordered abelian group , it has a decomposition @xmath1032 for some @xmath1033 , where the ordering is the lexicographic ordering and @xmath1034 are subgroups of @xmath1035    therefore , @xmath541 has a free basis @xmath1036 such that @xmath1037 .",
    "we can now make all the components in the length of the basis elements zeros except those corresponding to @xmath1038 .",
    "this defines a free length function in @xmath3 on @xmath541 .",
    "the new lengths of elements in @xmath541 satisfy the same system of linear equations as their lengths in @xmath0 .",
    "the points of an @xmath3-tree , where @xmath1 acts freely are the leaves in the foliation corresponding to the new length of bases in @xmath3 .",
    "the new lengths of bases are exactly their lyndon lengths .",
    "@xmath1039    _ proof of theorem [ th : main4]_. notice that in the case when @xmath2 is a finitely presented group with a free length function in @xmath0 ( not necessary regular ) it can be embedded in the group with a free regular length function in @xmath0 by remark [ nonreg ] .",
    "that group can be embedded in @xmath314 .",
    "when we make a generalized equation for @xmath2 , we have to add only a finite number of elements from @xmath314 .",
    "we run the elimination process for this generalized equation as we did in the proof of theorem [ th : main1 ] and obtain a group @xmath1 as in remark [ nonreg1 ] , where @xmath2 is embedded , and then redefine the length of elements of @xmath1 in @xmath3 as above . therefore @xmath1 acts freely and regularly on a @xmath3-tree .",
    "the theorem is proved .",
    "if @xmath2 is a finitely presented group which has a free ( not necessary regular ) length function in @xmath0 , then it acts freely on a @xmath0-tree , and one can construct , as in @xcite , a foliated band complex with measured foliation with horizontal measure in @xmath0 .",
    "r. alperin and h. bass , _ length functions of group actions on @xmath0-trees .",
    "_ combinatorial group theory and topology , ( ed .",
    "s. m. gersten and j. r. stallings ) , annals of math .",
    "studies * 111 * , 265378 .",
    "princeton university press , 1987 .",
    "o. kharlampovich and a. myasnikov , _ irreducible affine varieties over a free group .",
    "ii : systems in triangular quasi - quadratic form and description of residually free groups . _ j. of algebra * 200 * no .  2 ( 1998 ) , 517570 .",
    "a. myasnikov , v. remeslennikov and d. serbin , _ regular free length functions on lyndon s free @xmath1041$]-group @xmath1042}$ ] , _ _ algorithms , languages , logic _",
    "a. borovik ) , contemp .",
    "* 378 * ( 2005 ) , 3777 ."
  ],
  "abstract_text": [
    "<S> a group is called @xmath0-free if it has a free lyndon length function in an ordered abelian group @xmath0 , which is equivalent to having a free isometric action on a @xmath0-tree . </S>",
    "<S> a group has a regular free length function in @xmath0 if and only if it has a free isometric action on a @xmath0-tree so that all branch points belong to the orbit of the base point . in this paper </S>",
    "<S> we prove that every finitely presented @xmath0-free group @xmath1 can be embedded into a finitely presented group with a regular free length function in @xmath0 so that the length function on @xmath1 is preserved by the embedding . </S>",
    "<S> next , we prove that every finitely presented group @xmath2 with a regular free lyndon length function in @xmath0 has a regular free lyndon length function in @xmath3 ordered lexicographically for an appropriate @xmath4 and can be obtained from a free group by a series of finitely many hnn - extensions in which associated subgroups are maximal abelian and length isomorphic . </S>"
  ]
}