{
  "article_text": [
    "one of the fundamental problems in network data analysis is the community detection that aims to divide nodes into groups such that the links are dense within groups and relatively sparse between groups .",
    "the stochastic block model proposed by @xcite is a popular approach to this end ; for applications , see @xcite and @xcite .    in a stochastic block model with @xmath0 communities ,",
    "@xmath1 nodes are clustered into @xmath0 groups , i.e. , there exists a mapping : @xmath2\\rightarrow[k]^n$ ] , where @xmath3=\\{1,\\ldots , n\\}$ ] .",
    "then , the entries @xmath4 ( @xmath5 ) of the symmetric adjacency matrix @xmath6 of an undirected random graph @xmath7 are mutually independent bernoulli random variables with the occurrence probabilities @xmath8 for certain symmetric probability matrix @xmath9^{k\\times k}$ ] .",
    "a large number of methods for recovering the community labels have been proposed , including modularity [ @xcite ] , likelihood maximization [ @xcite ] , variational methods [ @xcite ] and spectral clustering [ @xcite ] . for review , see @xcite .",
    "asymptotic properties of the estimators of the community labels have also been established [ e.g. , @xcite ] .",
    "however , how to validate the stochastic block model is a challenging problem and has not been addressed only until recently .",
    "@xcite developed a likelihood - based approach to test the model and derived the asymptotic null distribution of the log - likelihood ratio statistic under model misspecification when the block number @xmath0 is fixed .",
    "@xcite used the largest eigenvalue of the centered and scaled adjacency matrix to test the erds  rnyi model and derived the asymptotic null distribution . by extending their arguments",
    ", @xcite developed a goodness - of - fit test for stochastic block models using the largest singular value of the centered and re - scaled adjacency matrix and derived its asymptotic null distribution when the condition @xmath10 holds .",
    "however , it seems difficult to extend these results to the more realistic degree corrected block model .    in this paper",
    ", we propose a new goodness - of - fit test based on the maximum entry - wise deviation of the centered and re - scaled observed adjacency matrix .",
    "we show that its asymptotic null distribution is the gumbel distribution when @xmath11 .",
    "this condition implies that @xmath0 is allowed to grow linearly with @xmath1 ignoring a logarithm factor .",
    "@xcite called it the highest dimensional stochastic block model as the number of communities must be smaller than the number of nodes , and no reasonable model would allow @xmath0 to grow faster . as a result",
    ", it significantly relaxes the condition in @xcite .",
    "the remainder of the paper is organized as follows . in section",
    "[ section : test ] , we introduce the new test statistic and state the asymptotic null distribution . we extend our results to the degree corrected stochastic block model in section [ section : extension ] .",
    "the numerical studies are given in section [ section : simulation ] .",
    "all proofs are relegated to the appendix .",
    "consider a stochastic block model on @xmath1 nodes with the membership vector @xmath12 and probability matrix @xmath13 .",
    "given @xmath14 , the probability mass function for the adjacency matrix @xmath15 is @xmath16 given an observed adjacency matrix @xmath15 , a positive integer @xmath17 , and a membership vector @xmath18 , one may want to know whether @xmath15 can be well fitted by a stochastic block model with @xmath17 and @xmath18 .",
    "this leads to the test of fitness of stochastic block models with the null hypothesis : @xmath19    given @xmath18 and @xmath17 , the maximum likelihood estimate of b is given by @xmath20 and we define the centered and re - scaled adjacency matrix @xmath21 by @xmath22 where @xmath23 by assuming @xmath10 , lei ( 2016 ) showed that @xmath24 where @xmath25 denotes the tracy - widom distribution with index 1 and @xmath26 denotes the @xmath27-th largest eigenvalue of the matrix @xmath15 .",
    "further , lei ( 2016 ) proposed the following test statistic : @xmath28\\ ] ] to test whether the network data can be fitted by the stochastic block model .",
    "we note that @xmath0 and @xmath12 are implicit in lei ( 2016 ) , and as a result , the probability of type i error may be larger than the nominal level .",
    "furthermore , it seems difficult to extend these results to the more realistic degree corrected block model . to overcome these disadvantages ,",
    "it is natural to develop a new statistic that satisfies the following three conditions : ( 1 ) @xmath0 and @xmath12 are explicit in the new statistic ; ( 2 ) @xmath0 is allowed to grow faster than @xmath29 ; ( 3 ) the new statistic can be easily extended to the degree corrected block model . in this paper , we propose a new test statistic based on the maximum entry - wise deviation : @xmath30 where @xmath31 .    to derive the asymptotic distribution for @xmath32 , we make the following mild assumptions ..    ( a1 ) the entries of @xmath13 are uniformly bounded away from 0 to 1 .",
    "( a2 ) there exists @xmath33 such that @xmath34 for all @xmath1 .",
    "note condition ( a1 ) was also used in @xcite .",
    "condition ( a2 ) requires that the size of each community is at least proportional to @xmath35 .",
    "this is a reasonable and mild condition , for example , it is satisfied almost surely if the membership vector @xmath12 is generated from a multinominal distribution with @xmath1 trials and probability @xmath36 such that @xmath37 .",
    "this condition was also used in @xcite and @xcite .",
    "asymptotic properties of @xmath32 are stated below , while the proof is given in the supplemental material .    [",
    "theorem : null : a ] suppose that conditions ( a1 ) and ( a2 ) hold . under the null hypothesis @xmath38 , @xmath39 ,",
    "if @xmath11 , then as @xmath40 , we have @xmath41 where the right hand side of ( 2.2 ) is the cumulative distribution function of the gumbel distribution with @xmath42 and @xmath43 .    by the above theorem we can test the null hypothesis @xmath44 using the test statistic @xmath45 specifically , we reject @xmath38 if @xmath46 or @xmath47 , where @xmath48 is the @xmath49 quantile of the gumbel distribution .",
    "although we use the maximum entry - wise deviation to test the goodness - of - fit for stochastic block models , the block number @xmath0 is allowed to be fixed .",
    "this is a great difference between our method and the general maximum entry - wise deviation methods , where @xmath0 is required to be infinite .",
    "the reason is that the node number @xmath1 is embedded in the statistic @xmath32 .",
    "a typical network often contains a handful of high degree `` hub '' nodes having many edges and many low degree nodes having few edges . to incorporate the degree heterogeneity of nodes for community detection , @xcite proposed the degree corrected stochastic block model . specifically , the degree corrected stochastic block model assumes that @xmath50 , where @xmath51 are a set of node degree parameters measuring the degree variation . for identifiability of the model , we use the following constraint for the degree corrected stochastic block model .",
    "( a3 ) @xmath52 for each community @xmath53 .    similar to @xcite ,",
    "we replace the bernoulli distribution of @xmath4 by the poisson distribution with the mean @xmath54 .",
    "as discussed in @xcite , there is no practical difference in performance between the log - likelihood and its slightly more elaborate version based on the true bernoulli observations .",
    "the reason is that the bernoulli distribution with a small mean is well approximated by the poisson distribution .",
    "one advantage of using the poisson distribution is that it greatly simplifies the calculations .",
    "another advantage is that it admits networks containing both multi - edges and self - edges .    to develop a goodness - of - fit test for the degree corrected stochastic block model , we consider two cases : ( 1 ) @xmath55 is known and ( 2 ) @xmath55 is unknown .",
    "we first consider the case where @xmath55 is known , which was also assumed by @xcite , @xcite in their theoretical analyses . in this case",
    ", we propose the following test statistic @xmath56 where @xmath57 .",
    "to derive the asymptotic distribution of @xmath58 under the null hypothesis , we make the following additional assumption .",
    "( a4 ) the entries of @xmath59 are uniformly bounded away from 0 and 1 .",
    "asymptotic properties of @xmath58 are stated below , while the proof is similar to that of theorem [ theorem : null : a ] and thus omitted .",
    "[ theorem : null : b ] suppose that conditions ( a2)-(a4 ) hold . under the null hypothesis @xmath38 ,",
    "@xmath39 , if @xmath11 , then as @xmath40 , we have @xmath60    if @xmath55 is unknown , we can plug in its estimate for @xmath58 . specifically , under the degree corrected stochastic block model , the maximum likelihood estimate of the parameter @xmath55 is given by @xmath61 , where @xmath62 .",
    "then the proposed plug - in test statistic is given by @xmath63 where @xmath64 .",
    "we note that when @xmath55 is unknown , it is difficult to derive the asymptotic distribution of @xmath65 as the dependence of the terms in the summation of the above expression is complicated .",
    "instead , we did some simulation studies and found that the empirical distribution of @xmath66 deviates from the gumbel distribution ( see figure [ figure - b ] ( b ) )",
    ". however , we also found that when @xmath65 is adjusted as @xmath67 , the deviation becomes small , especially when the number of blocks @xmath0 is small .",
    "thus we use @xmath68 as an empirically modified test statistic for the degree corrected stochastic block model .",
    "in this section , we carry out simulation studies to evaluate the performance of the proposed test statistic .",
    "we consider both the stochastic block model and the degree corrected stochastic block model . in the stochastic block model setting , spectral clustering is used to obtain the community labels , whereas in the degree corrected stochastic block model setting , the score algorithm [ @xcite ] is employed .",
    "note that for the stochastic block model , @xmath69 . for the degree corrected stochastic block model ,",
    "we define @xmath70 , where @xmath71 .    _ simulation 1 .",
    "_ in the stochastic block model setting , we examine how well the gumbel limiting distribution approximates the empirical distribution of the test statistic @xmath72 .",
    "we set @xmath73 and @xmath74 with @xmath75 .",
    "the edge probability between communities @xmath76 and @xmath77 is @xmath78 .",
    "figure [ figure - a ] plots the distribution of @xmath79 from 200 replications .",
    "we can see that the empirical distribution can be well approximated by the limiting distribution .    .",
    "the solid curve is the density of the gumbel distribution .",
    ", width=652,height=307 ]    _ simulation 2 .",
    "_ in the stochastic block model setting , given @xmath80 ( @xmath18 is derived by a consistent community detection method , e.g. , spectral clustering ) , we simulate the probability of type i error and the power of the test statistic @xmath79 under the hypothesis test @xmath81 here , @xmath0 denotes the true block number and @xmath17 is the fitted block number .",
    "the network size @xmath1 is @xmath82 with equal sized communities .",
    "the edge probability between communities @xmath76 and @xmath77 is @xmath83 .",
    "each simulation is repeated @xmath84 times .",
    "the simulation results are given in table [ tab : b ] .",
    "it can be seen from this table that the probability of type i error is close to nominal level @xmath85 , especially for small @xmath0 .",
    "we can also see from this table that when the difference between the true block number @xmath0 and the fitted block number @xmath17 increases , the power becomes larger .",
    "we also compare our method with @xcite .",
    "it can be seen from table [ tab : b ] that the probability of type i error of our method is smaller than that of lei ( 2016 ) .    ,",
    "@xmath86 and @xmath87 .",
    "the solid curve is the density of the gumbel distribution .",
    ", width=652,height=307 ]    _ simulation 3 .",
    "_ in the stochastic block model setting , given @xmath88 , we simulate the probability of type i error of the test statistic @xmath79 under the hypothesis test @xmath89 here , @xmath18 is derived by spectral clustering method .",
    "@xmath12 denotes the true block number and @xmath18 is the fitted block number .",
    "the network size @xmath1 is @xmath82 with equal sized communities .",
    "the edge probability between communities @xmath76 and @xmath77 is @xmath90 .",
    "each simulation is repeated @xmath84 times .",
    "the simulation results are given in table [ tab : c ] .",
    "it can be seen from this table that the probability of type i error is close to nominal level @xmath85 , especially for large @xmath91 . on the other hand , when @xmath91 is fixed , the probability of type i error increases as @xmath0 increases .",
    "we also compare our method with @xcite .",
    "it can be seen from table [ tab : c ] that the probability of type i error of our method is smaller than that of lei ( 2016 ) .",
    "_ simulation 4 .",
    "_ in the degree corrected stochastic block model setting , we examine how well the gumbel limiting distribution approximates the empirical distribution of the test statistic .",
    "we set @xmath73 and @xmath74 with @xmath92 . in choosing the parameters @xmath55 and @xmath13 to generate networks from the degree corrected stochastic block model , we follow the approach used in @xcite .",
    "the identifiability constraint @xmath52 for each community @xmath53 is replaced by the requirement that the @xmath93 be independently generated from a distribution with unit expectation @xmath94 where @xmath95 is uniformly distributed on the interval @xmath96 $ ] . the edge probability between communities",
    "@xmath76 and @xmath77 is @xmath78 .",
    "each simulation is repeated @xmath84 times . in figure [ figure - b ] , ( a ) , ( b ) and ( c ) plot the empirical distributions of @xmath97 , @xmath86 and @xmath87 , respectively .",
    "it can be seen that the empirical distributions of @xmath97 and @xmath87 can be well approximated by the gumbel distribution , whereas the empirical distribution of @xmath86 deviates from the gumbel distribution .",
    "_ simulation 5 .",
    "_ in the degree corrected stochastic block model setting , given @xmath80 ( @xmath18 is derived by a consistent community detection method , e.g. , score ) , we simulate the probability of type i error and the power of the test statistics @xmath86 and @xmath87 under the hypothesis test @xmath98 the network size @xmath1 is @xmath82 with equal sized communities . the edge probability between communities",
    "@xmath76 and @xmath77 is @xmath99 .",
    "each simulation is repeated @xmath84 times .",
    "the simulation results are given in tables [ tab : g ] .",
    "we can see that , for small @xmath0 , the probability of type i error of the test statistics @xmath87 is smaller than that of @xmath86 .    _ simulation 6 .",
    "_ in the degree corrected stochastic block model setting , given @xmath88 , we simulate the probability of type i error of the test statistics @xmath86 and @xmath87 under the hypothesis test @xmath89 here , @xmath18 is derived by score .",
    "@xmath12 denotes the true block number and @xmath18 is the fitted block number .",
    "the network size @xmath1 is @xmath82 with equal sized communities .",
    "the edge probability between communities @xmath76 and @xmath77 is @xmath90 .",
    "the simulation results are given in table [ tab : d ] .",
    "it can be seen from this table that the probability of type i error of the test statistic @xmath87 is close to nominal level @xmath85 , especially for large @xmath91 . on the other hand , when @xmath91 is fixed , the probability of type i error of the test statistic @xmath87 increases as @xmath0 increases .",
    "we can also see that , for small @xmath0 , the probability of type i error of the test statistics @xmath87 is smaller than that of @xmath86 .        in this subsection ,",
    "we study an international trade dataset collected by @xcite .",
    "it contains yearly international trade data among @xmath100 countries from 19812000 .",
    "one can refer to @xcite for a detail description .",
    "this dataset was revisited by @xcite for the purpose of estimating the number of communities .",
    "following their paper , we only focus on data from 1995 and transform the weighted adjacency matrix to the binary matrix using their methods .",
    "an adjacency matrix @xmath15 is created by first considering a weight matrix @xmath101 with @xmath102 , where @xmath103 denotes the value of exports from country @xmath27 to country @xmath104 .",
    "define @xmath105 if @xmath106 , and @xmath107 otherwise , here @xmath108 denotes the @xmath109-th quantile of @xmath110 .",
    "we set @xmath111 as in @xcite .",
    "@xcite used three different methods to conclude that the number of communities are @xmath112 respectively .",
    "we use @xmath72 as the test statistic for the stochastic block model .",
    "the member vector @xmath18 is derived by the spectral clustering .",
    "we first consider the case @xmath113 .",
    "we computed @xmath114 ( after removing about 10 percent singular values of @xmath115 ) , and the corresponding p - value is about 0.001 .",
    "thus , at the level of 0.05 , we would reject @xmath44 . by a similar discussion",
    ", we would reject @xmath116 at the level @xmath117 . for @xmath118",
    ", we computed @xmath119 ( again after removing about 10 percent singular values of @xmath115 ) , and the corresponding p - value is about 0.45 .",
    "thus , at the level of 0.05 , we would not reject @xmath118 .      in this subsection",
    ", we use the political blog network [ @xcite ] to demonstrate the proposed method .",
    "the data consists of political blogs , with edges representing web links .",
    "each node is labeled either as  conservative \" or  liberal \" based on the blogger s political stance .",
    "we only consider the largest connected component of this network which consists of @xmath120 nodes as is commonly done in the literature .",
    "@xcite proposed a network cross - validation method and applied it to the political blog network to select the number of communities ; they identified @xmath121 and @xmath122 respectively for the stochastic block model and the degree corrected stochastic block model . here , we reanalyze the data using the test statistics that we have developed to test the significance of the block number identified by chen and lei ( 2014 ) . specifically , we use @xmath72 and @xmath87 as the test statistic for the stochastic block model and the degree corrected stochastic block model , respectively .",
    "we first consider the case @xmath116 under the stochastic block model ; we computed @xmath123 ( after removing about 10 percent singular values of @xmath115 ) , and the corresponding p - value is about 0 .",
    "thus , at the level of 0.05 , we would reject @xmath116 .",
    "for the case of @xmath124 under the degree corrected stochastic block model , we computed @xmath125 ( again after removing about 10 percent singular values of @xmath126 ) , and the corresponding p - value is 0.16 .",
    "thus , at the level of 0.05 , we would not reject @xmath124 .",
    "the result of our analysis agrees with that of chen and lei ( 2014 ) for the degree corrected stochastic block model but not so for the stochastic block model .",
    "it is possible that the stochastic block model is not an appropriate model for this particular data set as it was observed that there is a big variation among node degrees .",
    "in this paper , we have developed a novel goodness - of - fit test based on the maximum entry - wise deviation of the centered and re - scaled observed adjacency matrix and demonstrated that its asymptotic null distribution is the gumbel distribution when @xmath11 , which significantly relaxes the condition in @xcite .",
    "the test is different from those used in traditional methods on independent random variables in which the goodness - of - fit is usually assessed by the sum of residual squares . for stochastic block models ,",
    "the residual is a matrix .",
    "the proposed test incorporates the signal change among different blocks nested in the residual matrix to test the goodness - of - fit of the model .",
    "we note that we have only considered dense networks . in practice , networks are often sparse . to admit the sparse case , the probability matrix @xmath13 is often assumed to be of the form @xmath127",
    ", where the entries of @xmath128 are of order @xmath129 and @xmath130 is a parameter controlling the sparsity of the network [ @xcite ] .",
    "it would be of interests to see whether the proposed method can be extended to cover this case .",
    "we are very grateful to two anonymous referees , an associate editor , and the editor for their valuable comments that have greatly improved the manuscript .",
    "yan was partially supported by by the national natural science foundation of china .",
    "in this section , we give the proof of theorem [ theorem : null : a ] .",
    "we start with three lemmas that will be used in the proof .",
    "the following poisson approximation result is essentially a special case of theorem [ theorem : null : a ] in @xcite .",
    "[ lemma : poisson ] let @xmath131 be an index set and @xmath132 be a set of subsets of @xmath131 , that is , @xmath133 .",
    "let also @xmath134 be random variables .",
    "for a given @xmath135 , set @xmath136 .",
    "then @xmath137 where @xmath138 @xmath139 and @xmath140 is the @xmath12-algebra generated by @xmath141 . in particular , if @xmath142 is independent of @xmath141 for each @xmath109 , then @xmath143 .",
    "[ lemma : chen ] suppose @xmath144 are i.i.d random variables with @xmath145 and @xmath146 .",
    "set @xmath147 .",
    "let @xmath148 and @xmath149 satisfy that @xmath150 and @xmath151 .",
    "if @xmath152 for some @xmath153 , then @xmath154 for any @xmath155 .",
    "[ lemma : cj ] suppose @xmath144 are i.i.d random variables with @xmath145 , @xmath146 and @xmath152 for some @xmath153 and @xmath148 .",
    "set @xmath147 and @xmath156 .",
    "then , for any @xmath157 with @xmath158 and @xmath159 and @xmath160 with @xmath161 , @xmath162 as @xmath40",
    ". +    * proof of theorem [ theorem : null : a ] .",
    "* by @xcite s ( @xcite ) inequality , we have @xmath163 it implies that @xmath164 let @xmath165 @xmath166 @xmath167 to prove theorem 1 ( 1 ) , it is sufficient to show : @xmath168 in probability as @xmath40",
    ".              let @xmath186 , @xmath172 , @xmath173 . then @xmath174 . since @xmath175 is i.i.d with @xmath176 and @xmath177 , by lemma [ lemma : poisson ] , @xmath178 where @xmath179 . by lemma [ lemma : cj ] , @xmath187 hence , @xmath188 similar to the proof in theorem 1 ( 1 ) , @xmath189 , @xmath190 .",
    "thus , @xmath191 +              bickel , p. j. and chen , a. ( 2009 ) . a nonparameter view of network models and newman - girvan and other modularities . _ proceedings of the national academy of sciences of the united states of america _ * 106 * , 21068 - 21073 .",
    "cai , t. t. and jiang , t. ( 2011 ) . limiting laws of coherence of random matrices with applications to testing covariance structure and construction of compressed sensing matrices . _",
    "the annals of statistics _ , * 39 * , 1496 - 1525 .",
    "westveld , a. h. and hoff , p. d. ( 2011 ) . a mixed effects model for longitudinal relational and network data with applications to international trade and conflict .",
    "_ the annals of applied statistics _ , 5 , 843872 ."
  ],
  "abstract_text": [
    "<S> the stochastic block model is widely used for detecting community structures in network data . how to test the </S>",
    "<S> goodness - of - fit of the model is one of the fundamental problems and has gained growing interests in recent years . in this paper , we propose a new goodness - of - fit test based on the maximum entry of the centered and re - scaled observed adjacency matrix for the stochastic block model in which the number of communities can be allowed to grow linearly with the number of nodes ignoring a logarithm factor . </S>",
    "<S> we demonstrate that its asymptotic null distribution is the gumbel distribution . </S>",
    "<S> our results can also be extended to the degree corrected block model . </S>",
    "<S> numerical studies indicate the proposed method works well . </S>",
    "<S> + * key words : * degree corrected stochastic block model ; goodness - of - fit test ; network data ; stochastic block model . </S>",
    "<S> +    jianwei hu , department of statistics , central china normal university , wuhan , p.r . </S>",
    "<S> china , 430079 , email : jwhu@mail.ccnu.edu.cn . </S>",
    "<S> hong qin , department of statistics , central china normal university , wuhan , p.r . </S>",
    "<S> china , 430079 , email : qinhong@mail.ccnu.edu.cn . </S>",
    "<S> ting yan , department of statistics , central china normal university , wuhan , p.r . </S>",
    "<S> china , 430079 , email : tingyanty@mail.ccnu.edu.cn . </S>",
    "<S> ji zhu , department of statistics , university of michigan , ann arbor , michigan , usa , email : jizhu@umich.edu . </S>"
  ]
}