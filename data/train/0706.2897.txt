{
  "article_text": [
    "several processes can contribute to the production of ions in the vicinity of accelerated electron beams @xcite .",
    "these positively charged ions are attracted to the negative beam .",
    "anti - proton accumulation systems have suffered under the field from accumulated ions @xcite , and so have electron beams @xcite .",
    "ions can damage the beam in various ways .",
    "firstly , they produce a focusing field that changes in a very nonlinear way with an electron s distance from the beam s center . the resulting nonlinear motion can increase the beam emittance , can lead to particle loss , and can produce a halo around the beam .",
    "secondly , the ion distribution oscillates within the electron beam , while the electrons are attracted to the ion distribution .",
    "this system of coupled oscillators can become unstable @xcite and lead to large transverse beam oscillation amplitudes or to an increase of the apparent transverse beam size .",
    "it is therefore important to reduce the density of ions in the vicinity of the beam to a tolerable amount .",
    "different accelerators achieve this differently .",
    "storage rings typically use ion - clearing gaps .",
    "these are short gaps in the filling pattern that lead to an absence of focusing forces for the ions every time this gap has traveled around the ring .",
    "when the gap length and frequency are chosen suitably , the ions get over - focused which lets the ions oscillate with increasing amplitude until they have moved outside the beam region .",
    "the length of the beam - filled region is typically a few microseconds long for a large accelerator , whereas the gap is typically shorter than one microsecond . in pulsed linacs ,",
    "the gaps are often much longer and allow ions to drift out of the beam region .    in rings with coasting beams ,",
    "there is no ion - clearing gap , and obviously the beam can not be turned off regularly .",
    "similarly , in energy recovery linacs ( erls ) @xcite where the beam s energy is dumped in rf cavities and is immediately used to accelerate new electrons , one can not easily turn off the beam ( because this would interrupt the erl process ) and one can also not easily introduce short gaps in the beam ( because this would disrupt the gun or the linac that injects large currents into the erl ) . in both of these cases , ion - clearing electrodes may have to be used @xcite .",
    "the electron beam diameter varies along the accelerator , and this variation produces longitudinal forces , guiding ions to a location where the electron density is relatively large , typically close to the waists of the electron beam .",
    "clearing electrodes are placed along the beam - line at such places of ion accumulation .",
    "because these longitudinal forces are relatively weak , it typically takes a few milliseconds for an ion to move from the place where it is produced to an ion - clearing electrode a few meters down the beam - line . during this time ,",
    "new ions are created , leading to a remnant equilibrium ion density that establishes itself in the presence of clearing electrodes . creating a number of ions per length as large as the number of electrons per length typically takes only a few seconds , even for very good vacuum in the ntorr range @xcite . because the motion to clearing electrodes that are spaced many meters apart takes several milliseconds ,",
    "such electrodes tend to produce a linear ion density that is in the order of about one part in a thousand of the linear charge density in the beam .",
    "computing an equilibrium density is typically very time consuming .",
    "here we show how to use scaling properties of the maxwell equations and the lorentz force , as well as the adiabatic invariance of the action integral , to compute the equilibrium ion density very efficiently .",
    "we subsequently apply this technique to analyze the cornell erl project @xcite .",
    "we investigate whether the remnant ion density after placement of clearing electrodes can lead to any of the discussed damages to the electron beam , so that additional clearing electrodes would have to be installed .",
    "we assume the parameters listed in tab .",
    "[ tb : erlpara ] , where the ionization cross - section is taken from @xcite for 5gev . to be conservative",
    "we used the high energy cross section for all energies , even though for lower energies the cross - section is up to 40% smaller .",
    "the gas density of @xmath0m@xmath1 corresponds to a pressure of 1ntorr for room temperature sections of the accelerator .",
    "the unnormalized emittances are obtained with the relativistic @xmath2 by @xmath3 .",
    ".parameters of the cornell erl used for the examples in this paper.[tb : erlpara ] [ cols= \" < , < , < \" , ]",
    "for a rotationally symmetric electron beam , the density is given by @xmath4 where @xmath5 is the linear particle density .",
    "with gauss law , the transverse velocity kick on a singly charged , non relativistic ion becomes @xmath6 \\right)\\ , \\label{eq : gauss_kick}\\ ] ] where @xmath7 is the rms width of the electron - beam profile , @xmath8 is the distance from the beam centerline , @xmath9 the number of electrons in the bunch , @xmath10 the classical proton radius and @xmath11 the atomic weight of the ion . for non - round gaussian electron beams , the transverse kick of the ion can be evaluated analytically in terms of complex error functions @xcite .",
    "if the size of the electron beam changes as a function of @xmath12 , the ion will also experience a longitudinal force from the passing bunch as shown in fig .",
    "[ fg : force - fig ] .",
    "linearizing in the slopes of the electron trajectories , this longitudinal force can be expressed as a function of transverse force components and beam parameters @xcite : @xmath13 \\frac{\\partial \\ : \\delta v_x } { \\partial x } - \\alpha_y \\varepsilon_y \\frac{\\partial \\ : \\delta v_y } { \\partial y}\\ .\\ ] ] the velocity changes that are produced by one bunch passage can be seen in fig .",
    "[ fg : gauss_force ] .",
    "here we used the values of tab .",
    "[ tb : erlpara ] for top energy and twiss parameters of @xmath14 m , @xmath15 .        in our restriction",
    "to rotationally symmetric beams , we have a dispersion of @xmath16 , @xmath17 , @xmath18 , and the longitudinal kick becomes @xmath19 for the beam parameters we studied , the longitudinal kick is typically five orders of magnitude weaker than the transverse kick , as shown in fig .  [ fg : gauss_force ] . in the special case of rotational symmetry ,",
    "the longitudinal kick on the ion will be in the same direction for all positions .",
    "this is not true in the general case ; if @xmath20 and @xmath21 have different signs , the kick direction can depend on the distance from the centerline @xcite .      in a brute force simulation ,",
    "the state of each ion is characterized by its x and s position , as well as by the velocities in both directions .",
    "every kick has to be calculated separately from the beam - beam force , which is assumed to be a function of the x and s position .",
    "such a simulation would be very inefficient because there are two different timescales : a large number of kicks is required to resolve the sharply focused transverse ion motion , but the longitudinal motion hardly changes in a single oscillation .",
    "it is therefore not possible to simulate the motion of a realistic number of ions in this way .    the period of transverse oscillations in the beam s potential @xcite depends on the average beam density , and for typical high - brightness beam parameters as those of tab .",
    "[ tb : erlpara ] it is of the order of several to tens of bunch crossings .",
    "during one transverse oscillation the longitudinal position @xmath12 of the ion changes typically only by a fraction of a millimeter even at the largest possible ion speeds .",
    "ions thus oscillate in a potential that slowly changes over many periods .",
    "because of this , an ion s action integral over one oscillation period @xmath22 is an adiabatic invariant of the motion .",
    "this can be used to drastically speed up the simulation .    in this improved simulation , the state of the ion is now described by its longitudinal position @xmath12 , its longitudinal speed @xmath23 and its action integral @xmath24 . for each position",
    "@xmath12 , @xmath24 is a measure of the transverse oscillation amplitude @xmath25 , because the action increases with @xmath25 .",
    "this can most easily be seen in @xmath26 phase space where the graph @xmath27 for any oscillation is a closed curve , and @xmath24 is the enclosed area .",
    "a closed curve that starts with a larger oscillation amplitude has to completely enclose one that starts with a smaller amplitude because different phase - space trajectories can not cross .",
    "solving the motion in @xmath28 rather than in @xmath29 coordinates has two advantages : ( 1 ) the degrees of freedom are reduced from 2 to 1 . ( 2 ) because @xmath30 changes much slower than @xmath31 , the integration steps can be vastly increased , typically by about a factor of 10000 .",
    "if the density at @xmath12 is to be computed , it is not enough to know the action at @xmath12 , but one oscillation is sufficient to compute the density contribution of particles with action j.    the longitudinal acceleration averaged over one oscillation is given by the time average over individual kicks @xmath32 where @xmath33 calculating this time average again and again for each ion is computationally demanding and wasteful . instead , we pre - compute a table of possible values of this time average for many beam sizes @xmath7 and amplitudes @xmath25 of the oscillation .",
    "the program was further accelerated by noting that the time averaged kick as a function of @xmath24 can be calculated for a typical standard beam size and then rescaled for regions with other beam sizes .    to derive this scaling behavior",
    ", we use a general scaling theorem for maxwell s equations and the lorentz force .",
    "if @xmath34 , @xmath35 , @xmath36 , and @xmath37 satisfy maxwell s equation , and a charged particle with mass @xmath38 and trajectory @xmath39 satisfies the lorentz force equation , then the following scaled quantities also satisfy these equations , @xmath40 the effect of this scaling transformation is to reduce spatial distances and time intervals by a factor @xmath41 , so that velocities remain unchanged .",
    "also , the charge and current densities are increased by a factor @xmath42 , so that the total charge in a scaled volume remains constant .",
    "we now want to find out how the spatial derivative of the transverse kicks changes when the transverse scale of the beam is reduced by a factor @xmath41 .",
    "if the rotationally symmetric beam produces a field @xmath43 , the 3-d scaled field would be @xmath44 .",
    "however , only the transverse scale changes from one beam width to another , and the longitudinal scale stays the same , signified by the unchanged line density .",
    "the charge within a 3-d scaled volume is therefore smaller by @xmath45 , and the field after transverse scaling is therefore @xmath46 .",
    "the transverse scaling transformation therefore gives @xmath47 > from this , we see that a rescaling of the two relevant length scales @xmath7 and @xmath25 has the effect @xmath48 this is true for both derivatives , so that the time average of their sum multiplied by @xmath49 is only a function of @xmath50 , @xmath51 our goal is to express this time average as a function of the beam size @xmath7 and the action integral @xmath24 , so we also have to find the functional dependence of @xmath24 on @xmath25 and @xmath7 .",
    "as noted above , the electric field at a location where the beam size is reduced by a factor @xmath41 , is scaled in the transverse to @xmath52 .",
    "to obtain scaled transverse ion motion , we do not change the mass of the ions , i.e. @xmath53 . the transverse velocity is then not changed by transverse scaling , and according to eq .",
    "( [ eq : sint ] ) , the action integral is reduced by a factor @xmath41 . from this",
    "we conclude @xmath54 combining this result with the above analysis , we finally find @xmath55 to speed up the program , a lookup table for the function @xmath56 is therefore computed for a standard beam size @xmath7 and a range of action integrals @xmath24 . the longitudinal acceleration of the ions is then given by @xmath57      the toy model for our ion simulations consists of a field - free beam region of variable length @xmath58 , so that the @xmath59-function is given by @xmath60 \\label{eq : beta*}\\ ] ] with waist at @xmath61 .",
    "we then simulate the creation of ions in the beampipe through ionization processes .",
    "the ionization rate in a given volume @xmath62 is given by @xmath63 where @xmath64 is the local particle density of the electrons as given by the gaussian beam profile @xmath65 . by integrating over the transverse directions ,",
    "one obtains an equation for the number of ions created in a length @xmath58 of the beam @xmath66 > from this it is clear that ions are created with equal rate at all locations along the beam . under the influence of the longitudinal beam force , the ions",
    "will then slowly propagate to the point with minimal potential .    in our simulation",
    ", we assume that clearing electrodes have been placed at the waist , so that ions crossing the @xmath61 line are removed .",
    "an equilibrium situation is reached when an equal number of ions are produced and removed during a given time interval .",
    "the time needed to reach this equilibrium depends on the length of the beam pipe and the steepness of the longitudinal potential .",
    "typical values in our simulation are @xmath67 to @xmath68 bunch separations of 0.77 ns .    as a first example",
    ", we show a @xmath58=20 m long part of the beam with a waist of @xmath69 m at its center . the longitudinal equilibrium ion distribution for 10 m up to the waist is shown in fig .",
    "[ fg:20m - longdistr ] .",
    "there is a sharp increase in the ion density near the electrode at @xmath61 m that is caused by two effects .",
    "the first is that ions which have been created at all points of the beam pass through this region and contribute to the density .",
    "the second effect is that the @xmath41-function becomes smaller near the waist , so that ions which are created there experience a weaker longitudinal force and move more slowly to the electrode .",
    "the transverse ion distribution can be characterized by its standard deviation , which is plotted in fig .",
    "[ fg:20m - rms ] .",
    "two features of this graph can be explained easily .",
    "( a ) the rms width of the ions at the start of the section ( at @xmath70 m ) is smaller than that of the electron beam , even though ions are created in proportion to the gaussian electron distribution .",
    "the reason is that ions start to oscillate within the electron beam after their creation and therefore contribute to the density around zero , no matter where they were created .",
    "( b ) the ion distribution contracts less than the electron beam .",
    "this can be explained by the adiabatic invariance and the scaling of the action integral .",
    "ions that are created with an action @xmath24 in regions where the electron beam is wide will still have that action by the time they reach a part of the beam that is narrower by a factor @xmath41 . at that position",
    ", their oscillation amplitude will have increased relative to the beam size , because the action for a proportionally reduced oscillation amplitude would be reduced by a factor @xmath41 according to eq .",
    "( [ eq : jscale ] ) .    the density profile of the transverse ion distribution at @xmath71 near the clearing electrode is shown in fig .",
    "[ fg:20m - density ] . near the beam axis ,",
    "the density diverges approximately as @xmath72 , so that it is not appropriate to fit the ion distribution to a gaussian .    for a rotationally symmetric particle density ,",
    "the number of ions created in a length d@xmath12 and in a radius element d@xmath8 per time is @xmath73    subsequent to the creation of an ion at ( @xmath74 ) , it travels along the beamline to @xmath75 and oscillates through the electron beam to @xmath76 .",
    "ions created between @xmath77 and @xmath12 can contribute to the distribution at @xmath12 , and a ring element d@xmath8d@xmath12 with radius @xmath8 therefore contains d@xmath78 ions , @xmath79 where @xmath80 is the radius at @xmath81 that leads to @xmath8 when the ion arrives at @xmath12 and @xmath82 is the time at which it arrives , i.e. @xmath83 and @xmath84 , @xmath85    the number of particles per radius interval @xmath86 is clearly not zero for @xmath87 , and the density close to zero therefore has a singularity of the form @xmath88    because of repulsive forces between the ions , the density at the origin can not diverge , and we therefore estimate the radius @xmath89 below which these forces become larger than the forces from the electron beam .",
    "it will turn out that this radius is a very small fraction of the electron beam s width , so that deviation from the @xmath72 density can be neglected .",
    "we assume that the region with radius @xmath90 in which the ion density can be approximated as @xmath91 contains most of the charge . at some radius , the density has to fall off faster than @xmath72 to integrate to a finite value .",
    "our assumption therefore leads to an overestimate of the ion force . integrating @xmath92 up to @xmath90 leads to the ion line density @xmath93 .",
    "the region that contains most of the charge has a radius @xmath90 that is usually smaller than the rms width of the electron beam . only if ions were created in a very wide region of the beam , and it were to be focused down to an extremely small radius , could the ion width be much larger than the electron width .",
    "however , such extreme focusing does not occur in most beams , especially not in the cornell erl .",
    "gauss law within @xmath90 leads to the constant radial electric field @xmath94 the radial electric field of the electron beam has already been used in eq .",
    "( [ eq : gauss_kick ] ) and for radii much smaller than @xmath7 simplifies to @xmath95 .",
    "we can now find the radius @xmath96 for which the ion field is as large as the electron field , @xmath97 .",
    "as long as the number of ions per length is much smaller than the number of electrons per length , the @xmath72 scaling of the ion density is therefore correct and not altered by the ion forces in by far the largest part of the beam .",
    "m in the 20 m beam model and comparison with a @xmath72 distribution.,scaledwidth=50.0% ]",
    "m in the 20 m beam model.,scaledwidth=50.0% ]    because of the @xmath72 ion density characteristics , the electric field of the ion distribution approaches a constant for small distances , as specified in eq .",
    "( [ eq : eion ] ) .",
    "this is shown in fig .",
    "[ fg:20m - field ] . to investigate the strength of the resulting beam distortion , we simulated the propagation of a representative set of beam electrons through the ion field .",
    "our simulation was set up to include a piece of the beampipe of length @xmath58 , with the clearing electrode and the waist of the beam placed in the center .",
    "the initial electron distribution is determined by random betatron amplitudes @xmath98 and phases",
    "@xmath99 with the density distribution @xmath100    we also investigated the effect of the beam transversing the region of length @xmath58 several times , which could lead to the build - up of damaging resonances .",
    "for this study , the linear optics has to be made periodic after crossing the field - free region .",
    "this can be accomplished by including a thin half - quad with the transfer matrix @xmath101 before and after each run through the ion field .",
    "the is @xmath102 before and @xmath103 after the thin quadrupole . simultaneously",
    ", this @xmath41-function must correspond to that of a drift , i.e. @xmath104 . therefore , @xmath105    the simulation of the electron motion is implemented with a dynamical time step proportional to the distance from the beam axis , so that the effects of the strong field near the centerline are accounted for accurately .    as a worst case scenario",
    ", we simulated two drift regions with 200 m and 100 m length and a beam waist of @xmath106 m at the center in both cases .",
    "the final phase - space distributions with and without the ion field are shown in figs .",
    "[ fg:200m - phase ] and [ fg:100m - phase ] .",
    "m at its center .",
    "dark - red @xmath107 : phase space in a free drift , light - green @xmath108 : phase space for motion through the ion field.,scaledwidth=50.0% ]    m at its center .",
    "dark - red @xmath107 : phase space in a free drift , light - green @xmath108 : phase space for motion through the ion field.,scaledwidth=50.0% ]    while passing through the ion field once , the emittance increases from 30.6pm to 53.1pm in the 100 m field and to 50.7pm in the 200 m field , as can be seen in fig .",
    "[ fg : emittance ] .",
    "the electronic version of this paper contains an animation of the beam as it transverses the ion fields .    )",
    ".,scaledwidth=50.0% ]      the previous two examples show that sections of only a few times 10 meters between clearing electrodes can produce intolerable emittance growth if the beta function is large , because in that case the beam is not very divergent and the longitudinal force that clears ions is consequently small .",
    "it therefore has to be tested whether the optics in the cornell erl provides fast enough ion motion to clearing electrodes , so that emittance growth is limited .",
    "because ions travel to the minima of the electrostatic potential , a clearing electrode has to be located at every such minimum .",
    "we therefore first calculate the potential in the beam s center with the approximate equation @xcite @xmath109\\ , \\ ] ] for a round beam pipe with radius @xmath96 and a beam with the relativistic factor @xmath2 .",
    "this equation assumes a uniform transverse density distribution .",
    "[ fg : optics ] shows the relevant beam optics for the cornell erl and fig .",
    "[ fg : erl_v ] shows the resulting potential in the center of the beam",
    ".    - function , vertical @xmath59-function and horizontal dispersion.,scaledwidth=50.0% ]        to find a round beam approximation suitable to our simulations , we first look at the minima of this potential and calculate the @xmath59-function that would give the same potential at those locations in the case of a round beam , @xmath110}\\ .\\ ] ] we can then define a round beam approximation for the entire erl lattice by using a free drift from one potential maximum to the next with @xmath111 from eq .",
    "( [ eq : beta * ] ) . the longitudinal ion velocities near the center of the beam ( where most of the ions are located )",
    "depend only on this potential gradient . as will be demonstrated by a comparison with particle tracking in figs .",
    "[ fg : erl_b ] and [ fg : erl_a ] , ions that are not in the center have the same velocity to a good approximation .",
    "this clearing speed determines the linear ion density also for non - round beams , and our round beam model should therefore be a good approximation .",
    "the number of ions created per unit length at the longitudinal position @xmath81 during a time interval @xmath112 is given by @xmath113 with @xmath114 where the number density of the residual gas is @xmath115 , the ionization cross section is @xmath7 and @xmath116 is the elementary charge . in the equilibrium state",
    "this is the same as the rate of ions per unit length originating from @xmath81 passing through every surface perpendicular to the beam axis , provided that the surface is located downstream from @xmath81 .    during a time interval @xmath112 ,",
    "the total number of ions per unit interval from @xmath81 crossing the surface is given by @xmath117 where @xmath118 is the local linear density of ions from @xmath81 per unit length at the point @xmath12 . solving for this quantity , we obtain @xmath119 where the velocity of ions from @xmath81 at @xmath12 is given by @xmath120}\\ . \\rule[-3ex]{0ex}{1ex}\\ ] ] integrating over the relevant upstream points from the nearest potential maximum to @xmath12 yields the total local ion density at @xmath12 @xmath121 using this method , and assuming that the residual gas density in the linac sections is reduced by a factor 100 as specified in tab .  [",
    "tb : erlpara ] , we find the linear ion densities for the cornell erl shown in fig .",
    "[ fg : erl_lambda ] .",
    "the two sections of the erl with the largest linear ion densities are located at @xmath122 m ( section a ) and at @xmath123 m ( section b ) .",
    "we therefore studied these sections in detail by performing numerical ion and beam simulations .",
    "the resulting equilibrium ion densities can be found in figs .",
    "[ fg : erl_b ] and [ fg : erl_a ] .",
    "the figures demonstrate that our analytical approximation agrees well with the simulations even though the approximation assumes that all ions are in the center of the electron beam .",
    "we checked that the agreement becomes perfect in this case .            to reduce the impact of the two sections",
    ", additional clearing electrodes can be placed between the maximum and minimum of the potential .",
    "we find that by including one extra electrode , the emittance increase can be reduced from 1.04pm to 0.46pm for section a , and from 1.55pm to 0.71pm for section b.    to get a better estimate of the ion effects in the full erl , we also simulated the ion distribution in a 34 m long region around @xmath124 m , which corresponds to one of the medium high peaks in fig .",
    "[ fg : erl_lambda ] . sending the beam through this section 1000 times results in the phase - space distribution in fig .",
    "[ fg : islands ] .",
    "we find that after 1000 passes through the ion field , 6.2% of the beam electrons have left the main bunch and have migrated to the four separated islands in phase space .",
    "the electronic version of this paper contains an animation of this development of the beam halo .",
    "while we have argued that our circular beam model should be quite accurate , it would be good to extend our simulations to non - round beams .",
    "however , in that case the ion propagation can not be simulated in the same way using adiabatic invariants .",
    "two independent invariant quantities would be needed to account for oscillations in the @xmath125 and @xmath126 directions .",
    "the problem is that the action integrals can not be defined as the area in a phase space plane , because the ion motion is generally not a simple superposition of two independent periodic oscillations in phase - space planes .",
    "an example of such phase - space motion can be seen in fig .",
    "[ fg:3dbeam ] .",
    "we computed the ion distribution produced by an electron beam when ion - clearing electrodes are installed .",
    "the transverse ion distributions are shown to strongly peak in the beam s center , producing very nonlinear forces on the electron beam .",
    "these can produce strong perturbations of beam properties leading to emittance growth and halo development .",
    "these simulations rely on fast algorithms that take advantage of adiabatic invariants and scaling properties of maxwell s equations and the lorentz force .",
    "our results are very relevant for high current energy recovery linacs , where ions are produced relatively quickly , and where clearing gaps in the electron beam can not easily be used for ion elimination . as an example we used the cornell energy recovery linac project . for simplicity we only consider the case of a circular electron beam of changing diameter .",
    "however , we parameterize this model to approximate the non - round beams of the erl well .",
    "we found suitable places for clearing electrodes and computed the equilibrium ion density and the electron - emittance growth it would produce even after installing extra clearing electrodes at the two most dangerous places .",
    "we also showed that the nonlinear - ion forces would lead to a significant halo development .",
    "j.  a.  clarke , j.a .",
    "clarke , d.m .",
    "dykes , s.f .  hill , e.a .",
    "hughes , m.w .",
    "poole , p.d .",
    "quinn , s.l .",
    "smith , v.p .",
    "suller , l.a .",
    "welbourne , source size variation and ion effects in the srs at daresbury , in proceedings pac93 , washington / dc ( 1993 )                  g.  h.  hoffstaetter , i.v .",
    "bazarov , s.  belomestnykh , d.h .",
    "bilderback , m.g .",
    "billing , j.s - h .",
    "choi , z.  greenwald , s.m .",
    "gruner , y.  li , m.  liepe , h.  padamsee , d.  sagan , c.k .",
    "sinclair , k.w .",
    "smolenski , c.  song , r.m .",
    "talman , m.  tigner , status of a plan for an erl extension to cesr , in proceedings pac05 , knoxville / tn ( 2005 )"
  ],
  "abstract_text": [
    "<S> here we compute the ion distribution produced by an electron beam when ion - clearing electrodes are installed . </S>",
    "<S> this ion density is established as an equilibrium between gas ionization and ion clearing . </S>",
    "<S> the transverse ion distributions are shown to strongly peak in the beam s center , producing very nonlinear forces on the electron beam . </S>",
    "<S> we will analyze perturbations to the beam properties by these nonlinear fields . to obtain reasonable simulation speeds , we develop fast algorithms that take advantage of adiabatic invariants and scaling properties of maxwell s equations and the lorentz force .    </S>",
    "<S> our results are very relevant for high current energy recovery linacs , where ions are produced relatively quickly , and where clearing gaps in the electron beam can not easily be used for ion elimination . </S>",
    "<S> the examples in this paper therefore use parameters of the cornell energy recovery linac project . for simplicity we only consider the case of a circular electron beam of changing diameter . </S>",
    "<S> however , we parameterize this model to approximate non - round beams well . </S>",
    "<S> we find suitable places for clearing electrodes and compute the equilibrium ion density and its effect on electron - emittance growth and halo development . </S>",
    "<S> we find that it is not sufficient to place clearing electrodes only at the minimum of the electron beam potential where ions are accumulated . </S>"
  ]
}