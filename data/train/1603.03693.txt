{
  "article_text": [
    "a copula is a mathematical tool designed to join marginal probability distribtions forming a joint multidimensional probability distribution .",
    "the advantage with copulas is that they reduce the problem of studying multidimensional probability distributions to studying a function , copula , defined on the unit hypercube . for a full introduction to copulas",
    "we refer to nelsen @xcite .",
    "as pointed out in e.g. @xcite,@xcite,@xcite copulas have recently gained a lot in popularity .",
    "this is in part driven by their usefulness in applied mathematics , especially mathematical finance .",
    "this paper as well is motivated by a problem originating from applied mathematics but the application is to be found in toxicology .",
    "let @xmath0 $ ] be the unit interval , and let @xmath1 .",
    "a function @xmath2 with piecewise continuous second derivatives is a cumulative distribution function on @xmath3 if and only if @xmath4 \\text { , and } \\\\ c\\left ( 0,v\\right ) & = & 0\\text { , } v\\in \\left [ 0,1\\right]\\end{aligned}\\]]the lower boundary values @xmath5 are zero ; the upper boundary values @xmath6 are the marginal distributions .",
    "the function @xmath7 is said to be a _ copula _ if the marginals are uniform which is summarised in the following definition .",
    "[ def : copula]a two - dimensional _ copula _ is a function @xmath7 from @xmath8 to @xmath9 with the following properties:1 . for every @xmath10 in @xmath9,@xmath11and@xmath122 . for every @xmath13 in @xmath9 such that @xmath14 and @xmath15@xmath16    let us consider an example .",
    "the function @xmath17 is a copula since @xmath18 , @xmath19 , @xmath20 and@xmath21    it turns out that any copula @xmath22 is bounded from above by the frecht - hoeffding upper bound , and from below by the frecht - hoeffding lower bound . indeed",
    "the frecht - hoeffding bounds are extremal copulas as they are copulas themselves , which is stated in the theorem below .",
    "the frecht - hoeffding upper bound is given by @xmath23 and the frecht - hoeffding lower bound is given by @xmath24 .",
    "the upper and lower frecht - hoeffding bounds @xmath25 and @xmath26 are copulas . moreover , for any copula @xmath7 and all @xmath27,@xmath28    while generalising a model , the probit model @xcite , for estimating the health impact on people exposed to hazardous chemicals we realised that the problem can be cast as a copula problem . the standard probit model is used to find a statistical description of the injury outcome of a population exposed to toxic substances .",
    "the model can be utilized to describe this outcome at several discrete injury states , such as _ light injuries _ , _ severe injuries _ , and _",
    "death_. the joint probability distribution of two succeeding injury states may be expressed as a multivariate normal distribution with normal marginal distributions . by sklar s theorem ,",
    "see e.g. @xcite , there exists a copula that prescribes how to joint , couple , the marginal distributions to achieve the probit model .",
    "as it happens the corresponding copula is the upper frecht - hoeffding copula @xmath29 .",
    "our generalisation of the probit model aims at treating the population as an aggregate of individuals rather than as one entity . in this approach",
    "individuals are allocated one threshold value per injury state which determines at which exposure they will reach every state . the thresholds are distributed among the population according to the standard normal distribution .",
    "however , individuals must be able to possess different sensibility for the different injury states which means that they will not be located on the diagonal axis on the multivariate probability distribution which otherwise would be the trivial solution . as the thresholds are distributed , the overall statistics of the population must be kept intact . in copula terms",
    "this equates to rearranging the mass of the joint probability distribution without changing the marginal distributions .. adding the criteria that the probit model should readily support numerical investigation we arrived at the condition that the generalised probit model is feasible if the upper frecht - hoeffding copula @xmath25 can be regularized and still remain a copula . in this paper",
    "we will focus on this mathematical problem while the full toxicological motivation and the generalised probit model will be published elsewhere in the toxicology literature.the regularity that we are aiming for is absolute continuity , which is defined in the following way :    a two - dimensional copula @xmath7 is said to be _ absolutely continuous _",
    "if @xmath30 has a density @xmath31 and@xmath32    we note that @xmath33 exists almost everywhere in @xmath3 , see theorem 2.2.7 in @xcite , and is equal to the density @xmath31 .",
    "the example copula @xmath17 that we considered earlier is absolutely continuous .",
    "the copula @xmath17 is absolutely continuous since@xmath34    the frecht - hoeffding copulas on the other hand are not absolutely continuous , indeed they are not absolutely continuous on any subdomain @xmath35 @xmath3 , and are thus _ singular_. geometrically the frecht - hoeffding upper and lower copula are @xmath36 surfaces each made up of two planar surfaces intersecting transversally along a line segment , see figure [ fig : fhcopulas ] . regularising these functions , @xmath26 and @xmath25 , is , of course , trivial : any type of averaging around and along the transversal intersection will smooth out the @xmath37-discontinuity .",
    "the point here is that the regularized function should still be a copula .",
    "for our purposes , the probit model , it would suffice to work with only the upper frecht - hoeffding @xmath25 copula , but the regularization method works equally well for the lower one @xmath26 .",
    "thus the main contribution in this paper is that we prove under which conditions the upper and lower frecht - hoeffding copula can be regularised to _ absolutely continuous copulas _ , see theorem [ thm : main ] .",
    "we then show that this class of copulas is non - empty by providing an explicit example .",
    "we remark that the proposed averaging method can not be used to prove regularity beyond , at most , @xmath38 due to unbounded third derivatives .",
    "the question of regularity of copulas and the associated differentiability of copulas has been studied before and there are at least two well - known classes of differentiable copulas : archimedean and farlie - gumbel - morgenstern copulas . recently a preprint claiming to characterize all twice differentiable copulas was presented @xcite . in that paper also a new class , fourier copulas , of twice differentiable copulas is introduced .     and @xmath26 .",
    "as was hinted at in the introduction , regularization of the upper and lower frecht - hoeffding copulas @xmath25 and @xmath26 will be achieved by averaging these copulas at , and in the vicinity of , their respective singularities : for @xmath25 the singularity is located along the diagonal while for @xmath26 it is the anti - diagonal ( see figure [ fig : fhcopulas ] ) . as averaging method",
    "we choose a family of discs and in each such disc we replace the value of the copula with the average value of the copula in that disc . due to the simple geometry it turns out that these averages can be expressed explicitly , however the expressions become somewhat involved due to evaluating integrals on circle segments .",
    "it is convenient to make the following change of coordinates@xmath39and study the problem in @xmath40-coordinates .",
    "let @xmath22 be a copula defined on @xmath3 . with a slight abuse of notation ,",
    "we write @xmath41 . @xmath42is",
    "defined on@xmath43the copula conditions , stated in definition [ def : copula ] , can be summarized in the following way@xmath44and may be checked in @xmath40-coordinates instead .",
    "the inverse coordinate transformation is given by@xmath45which implies that the partial derivatives are transformed according to@xmath46and thus the copula conditions ( [ def : copula1 ] ) and ( [ def : copula2 ] ) becomes@xmath47 in @xmath40-coordinates and where the interior @xmath48 and the boundary @xmath49 are given in the @xmath50coordinates by:@xmath51the expression for the boundary values occuring in the copula conditions is defined for all @xmath52:@xmath53this is a ( non  smooth ) copula , the lower frchet - hoeffding bound , where all the probability mass is concentrated on the antidiagonal @xmath54",
    ". there is also an upper bound@xmath55which is a non  smooth copula , the upper frchet - hoeffding bound , where all the probability mass is concentrated on the diagonal @xmath56 .",
    "now we are in a position to state the main theorem describing under which conditions the frecht - hoeffding bounds can be regularised using the proposed averaging method .",
    "[ thm : main]let @xmath57 be a twice continuously differentiable and strictly positive function defined for @xmath58 .",
    "let @xmath59and let @xmath60 be the circular disk with radius @xmath61 centered at @xmath62 , and let@xmath63then    1 .",
    "if @xmath64 and @xmath65 then@xmath66is an absolutely continuous copula with probability mass supported on @xmath67 , and@xmath68 2 .   if @xmath69 and @xmath70 then@xmath71is an absolutely continuous copula with probability mass supported on @xmath72 and@xmath73    we remark that the conditions stated in the theorem are not sharp , and this is pointed out in the proof which we postpone to the next section .",
    "let us first consider an example showing that the class of copulas generated by the theorem is non - empty .",
    "symmetric gaussian copula .",
    "let @xmath74 be the cumulative distribution function of a standard normal random variable , @xmath75its probability density function , and consider a radius function @xmath76 implicitly defined by@xmath77where @xmath78 is a given constant .",
    "denote@xmath79implicit differentiation gives @xmath80which gives@xmath81where @xmath82by the definitions above . hence @xmath83 .",
    "furthermore , @xmath84hence it suffices to show that @xmath85 for @xmath86 .",
    "but @xmath87since @xmath88 and @xmath89 .",
    "hence @xmath90 satisfies the assumptions in the theorem , so @xmath91 is an absolutely continuous copula with probability mass supported on @xmath92.it may be interesting to note that upon transforming the copula random variables @xmath93 back to the original @xmath94 , @xmath95 we obtain a pair of gaussian random variables @xmath96 with standard normal marginal distributions @xmath97 , @xmath98 and joint pdf @xmath99 supported on @xmath100 .",
    "as the example shows , verifying the conditions in theorem [ thm : main ] may require some work .",
    "in the example the radius function @xmath101 did not have a general dependence on both variables , indeed @xmath102 in the example , and this simplified the verification of the conditions .",
    "in general the conditions are easier to verify if the radius function has a product - structure @xmath103 which we state in the following corollary of theorem [ thm : main ] .    if @xmath104 and @xmath105 then the conclusions for @xmath106 are true if@xmath107for all @xmath108 .",
    "in particular , it holds true if @xmath109 $ ] , @xmath110 and @xmath111 and@xmath112for all @xmath108 . in the symmetric case @xmath113",
    ", the condition reduces to@xmath114    this allows for skew distributions , since the probability mass of @xmath106 is supported on @xmath115 , i.e. , @xmath116the ratio @xmath117 between modulus of the upper and lower limit is@xmath118    the corollary and the remark is stated for @xmath119 , but the analogous result holds for @xmath120 by interchanging the roles of @xmath121 and @xmath122 , and @xmath123 and @xmath124 .",
    "the proof of theorem [ thm : main ] relies on being able to construct radius functions @xmath125 such that the circular disc averages of the functions @xmath126 and @xmath127,@xmath128satisfy@xmath129where @xmath130 is the circular disc with radius @xmath61 centred at @xmath40 . once we have established what conditions the radius functions @xmath131 have to satisfy ( the averaging lemma [ lemma : average ]  below ) we pick those radius functions and apply the disc averaging method to the upper and the lower frecht - hoeffding copulas @xmath25 and @xmath26 and show that it results in absolutely continuous copulas : regularised frecht - hoeffding bounds @xmath132 and @xmath133 .",
    "evaluating the disc averages of the functions @xmath126 and @xmath127 and exploring the differentiability properties of these averages with respect to the choice of radius function @xmath101 and the part of the domain that is considered is summarised in the following technical averaging lemma .",
    "[ lemma : average]let @xmath134 be twice continuously differentiable and strictly positive , and let @xmath130 be the circular disc with radius @xmath61 centred at @xmath40 , and let@xmath135then @xmath136and @xmath137 , @xmath138 are twice continuously differentiable . moreover ,    1 .",
    "if @xmath139 then @xmath140 and @xmath141 , 2 .   if @xmath142 then @xmath143 and @xmath144 , 3 .   if @xmath145 , @xmath146 and @xmath147 , then @xmath148 , and 4 .   if @xmath149 , @xmath150 and @xmath151 , then @xmath152 .",
    "let us begin by showing the equality in equations ( [ eqn : f ] ) and ( eqn : g ) , that is , evaluating the disc averages .",
    "let @xmath153 the case @xmath154 is immediate , since then the integrand is linear .",
    "thereby statement 1 . and 2 .",
    "follow directly.for the case @xmath155 we introduce the nondimensional coordinates @xmath156whereby@xmath157applying the standard integrals@xmath158gives us@xmath159 _ { -z / r}^{1}-\\frac{z}{\\pi } \\left [ \\arcsin \\left ( \\zeta \\right ) + \\zeta   \\sqrt{1-\\zeta ^{2}}\\right ] _ { -1}^{-z / r } \\\\",
    "+ \\frac{r}{\\pi } \\left [ -\\frac{2}{3}\\left ( 1-\\zeta ^{2}\\right ) ^{3/2}\\right ] _ { -z / r}^{1}-\\frac{r}{\\pi } \\left [ -\\frac{2}{3}\\left ( 1-\\zeta ^{2}\\right ) ^{3/2}\\right ] _ { -1}^{-z / r } \\\\",
    "= \\frac{2z}{\\pi } \\arcsin \\left ( \\frac{z}{r}\\right ) + \\frac{2z}{\\pi } \\frac{z}{r}% \\sqrt{1-\\frac{z^{2}}{r^{2}}}+\\frac{4r}{3\\pi } \\left ( 1-\\frac{z^{2}}{r^{2}}% \\right ) ^{3/2 } \\\\",
    "= r\\cdot \\frac{2}{\\pi } \\left ( \\frac{z}{r}\\arcsin \\left ( \\frac{z}{r}\\right ) + % \\sqrt{1-\\frac{z^{2}}{r^{2}}}\\left ( \\frac{z^{2}}{r^{2}}+\\frac{2}{3}\\left ( 1-% \\frac{z^{2}}{r^{2}}\\right ) \\right ) \\right )",
    "\\\\ = r\\cdot \\frac{2}{\\pi } \\left ( \\frac{z}{r}\\arcsin \\left ( \\frac{z}{r}\\right ) + % \\frac{1}{3}\\sqrt{1-\\frac{z^{2}}{r^{2}}}\\left ( 2+\\frac{z^{2}}{r^{2}}\\right ) \\right ) = rg\\left ( \\frac{z}{r}\\right ) \\text{.}\\end{gathered}\\]]which proves the equality in ( [ eqn : g ] ) .",
    "proving the disc average @xmath160 , ( [ eqn : f ] ) , is analogous.in a preamble to studying how the derivatives of @xmath160 and @xmath161 behaves , we note that @xmath162 and @xmath163and@xmath164and @xmath165 , @xmath166 and @xmath167 as @xmath168 , hence @xmath169 and convex .",
    "however , @xmath170 is not @xmath171 since@xmath172to simplify calculations , we define the auxiliary function@xmath173and note that@xmath174and , in addition , we observe that since@xmath175its first partial derivatives are given by@xmath176now we are ready to study the properties of the second derivatives of @xmath138 , with the aim of proving points 2 . and 4 . in the lemma .",
    "let us remind ourselves that @xmath138 is defined as , compare equation ( [ eqn : g]),@xmath177taking derivatives , first once and then twice , with respect to @xmath123 and @xmath124 respectively gives@xmath178and@xmath179and@xmath180and@xmath181rearranging the terms and combining ( [ eqn : gww ] ) and ( [ eqn : g_zz ] ) gives@xmath182dividing by @xmath183 we denote the resulting quadratic polynomial in @xmath184 by @xmath185@xmath186a quadratic polynomial @xmath187 is @xmath188 for @xmath189 if and only if 1 ) the values at the endpoints are nonnegative , i.e. , @xmath190 and @xmath191 , which is equivalent to @xmath192 , and 2 ) if there is local minimum between the endpoints , i.e. , if @xmath193 , then this minimum is nonnegative , i.e , @xmath194 .",
    "if @xmath193 then @xmath195 so a simpler , sufficient condition would be @xmath196 and @xmath197 .",
    "applying this condition to ( [ eqn : quadpoly ] ) we see that@xmath198if @xmath199 and @xmath200 , which is equivalent to @xmath201the last condition is only needed when@xmath202the radius function @xmath61 is always positive , and by ( [ eqn : g  ] ) we have @xmath203 for @xmath155 , hence equation ( [ eqn : differenceg  ] ) implies that @xmath204 if conditions ( [ eqn : cond_r ] ) and ( eqn : cond_r  ) are satisfied .",
    "remember that @xmath205 , hence @xmath206 is equivalent to @xmath207",
    ". thus we have proved statement 4 . in the lemma.we remark that the conditions stated in the lemma ( and theorem [ thm : main ] ) are not sharp since we chose a simplified condition in the quadratic polynomial , if more precision is needed we the exact condition@xmath208which is equivalent to@xmath209can be employed.next , let us consider the remaining unproved statement , statement 3 .",
    "it follows analogously by the arguments above by interchanging the roles of @xmath123 and @xmath124 .",
    "that is , let us consider@xmath210interchanging the roles of @xmath123 and @xmath124 , and applying the the same arguments as above to@xmath211we obtain@xmath212if @xmath213and@xmath214thus we have proved the lemma .",
    "let @xmath101 be a twice continously differentiable and strictly positive function such that @xmath215 and @xmath216 .",
    "considering the definition of @xmath120 in ( [ eqn : defw_bar ] ) and inserting the expression for the lower frecht - hoeffding copula @xmath26 stated in ( [ eqn : w ] ) gives @xmath217applying lemma [ lemma : average ] we obtain@xmath218likewise , letting @xmath101 be a twice continously differentiable and strictly positive function such that @xmath219 and @xmath220 , and inserting the expression for the upper frecht - hoeffding copula @xmath25 , stated in ( eqn : m ) , into the definition of @xmath221 given in ( eqn : defm_bar ) yields @xmath222applying lemma [ lemma : average ] gives@xmath223since @xmath224 it follows that @xmath225 and @xmath106 are @xmath38 ; however they are not @xmath171 since @xmath226 is unbounded as @xmath227 or @xmath228 .",
    "the sufficient conditions on @xmath134 in in the lemma are fullfilled in the respective cases .",
    "therefore @xmath229 and @xmath152 , and hence it follows , see the copula definition ( eqn : defcopulac_wz  ) , that @xmath230 and @xmath231 .",
    "furthermore , the averaging method employed does not alter the boundary values of the copula , hence also the copula condition ( eqn : defcopulac_wzboundary ) is satisfied since @xmath26 and @xmath25 are copulas .",
    "thus we have proved that @xmath225 and @xmath106 are absolutely continuous copulas ."
  ],
  "abstract_text": [
    "<S> we show that the lower and upper frecht - hoeffding copulas , which are singular , can be regularized to absolutely continuous copulas . </S>",
    "<S> the method , which is constructive and explicit , states sufficient conditions for when an absolutely continuous copula can be achieved by averaging . a higher degree of regularisation can not be achieved with the proposed method . </S>"
  ]
}