{
  "article_text": [
    "the fate of the progeny of two seemingly identical cells can be markedly distinct .",
    "well studied examples include the immune system and hematopoietic system , for which the extent of clonal expansion and differentiation has been shown to vary greatly between cells of the same phenotype @xcite . fate and expression heterogeneity at the single - cell level",
    "are also apparent in other systems including the brain @xcite and cancers @xcite . whether this heterogeneity is due to the stochastic nature of cellular decision making ,",
    "reflects limitations in phenotyping , is caused by external events , or a mixture of effects , is a subject of active study @xcite . as addressing this pivotal question through population - level analysis is not possible , tools have been developed that facilitate monitoring single cells and their offspring across generations .",
    "long - term fluorescence microscopy represents the most direct approach to assess fate heterogeneity at the single - cell level .",
    "studies employing that technique are numerous @xcite , and have revealed many significant features .",
    "filming and tracking of cell families _ in vitro _ remains technically challenging , is labor intensive , and only partially automatable @xcite . despite significant advances in the field , continuous tracking _ in vivo _ is confined to certain tissues , and time windows of up to twelve hours for slowly migrating cells .",
    "a radically different approach to long - term clonal monitoring is to mark single cells with unique dna tags via retroviral transduction , a technique known as cellular barcoding @xcite .",
    "as tags are heritable , clonally related cells can be identified via dna sequencing . by tagging multi - potent cells of the hematopoietic system and adoptively transferring them into irradiated mice , the contribution of single stem cells to hematopoiesis",
    "has been quantified @xcite . amongst other discoveries ,",
    "this has revealed heterogeneity in the collection of distinct cell types produced from apparently equi - potent progenitors @xcite .",
    "current barcoding techniques are unsuitable for tagging cells _ in vivo _ , and typically require _ ex vivo _ barcoding followed by adoptive cell transfer @xcite .",
    "this restricts its scope to cell types such as naive lymphocytes and cancer cells , as well as hematopoietic stem and progenitors which require perturbation of the new host , usually irradiation , to enable them to engraft .",
    "ideally , a cellular barcoding system would inducibly mark cells in their native environment , would be non - toxic , permanent and heritable , barcodes would be easy to read with a high - throughput technique , and the system would enable labeling large numbers of cells with unique barcodes .",
    "two recently published studies address some of these points .",
    "sun et al .",
    "@xcite employed a dox inducible form of the sleeping beauty transposase to genetically tag stem cells _ in situ _ , and followed clonal dynamics during native hematopoiesis in mice .",
    "there tags are the random insertion site of an artificial transposon , which upon withdrawal of dox is relatively stable .",
    "a second _ in situ _ cellular barcoding system based on site - specific dna recombination with the rci invertase has also been implemented @xcite .",
    "inspired by the brainbow mouse @xcite , this system induces a random barcode by stochastically shuffling a synthetic cassette pre - integrated into the genome of a cell .",
    "the authors predicted high code diversity from relatively small constructs ( approx .",
    "@xmath0 kb ) and demonstrated feasibility of random barcode generation in escherichia coli @xcite .",
    "each of those approaches elegantly overcome shortcomings of previous systems by generating largely unique tags without significant perturbation to the system of interest , but some difficulties remain . for barcode readout",
    ", the sleeping beauty system requires whole - genome amplification technology and three - arm - ligation - mediated pcr to efficiently amplify unknown insertion sites .",
    "furthermore , the random location of the transposon may impact behavior of some barcoded clones and lead to biased data",
    ". moreover , some background transposon mobilization was detected , subverting the stability of the barcodes .",
    "the rci invertase based system remains to be implemented outside bacteria . as with the sleeping beauty transposase ,",
    "the method requires tight temporal control over rci expression to make codes permanent .",
    "here we consider the cre lox system as a driver to induce _ in situ _ large numbers of distinct , permanent , randomly determined barcodes from a series of tightly spaced lox sites .",
    "in contrast to the brainbow construct @xcite , which relies on overlapping pairs of incompatible lox sites recombining randomly to one of several stable dna sequence configurations , our design exploits constraints on the distance between lox sites that arise during dna loop formation , a prerequisite for site - specific recombination @xcite .",
    "this known feature has not previously been exploited , but is a crucial design element for obtaining high barcode diversity . employing repeated usage of the same lox site , code diversity",
    "is solely restricted by cassette size and not , as in the brainbow construct , by the relatively small set of non - interacting lox sites @xcite . for a design without distance constraints ,",
    "the maximal diversity of stable barcodes creatable with the cre lox system is of order @xmath1 , where @xmath1 is the number of lox sites @xcite , but with distance constraints we establish that optimal barcode diversities of order @xmath2 are possible . boosting this scaling with the four incompatible lox sites that have been reported in the literature @xcite enables @xmath3 distinct codes of about 600 bp each from a genetic construct as small as 2.5 kb . in combination with the creer system @xcite ,",
    "this is sufficient to inducibly barcode label all naive cd8 t cells in a mouse @xcite or all nucleated cells in the bone marrow @xcite .",
    "desirable features are inherently part of the lox barcode cassette design , including : short and stable barcodes ; a single barcode per cell ; and robust read - out .      before introducing the lox barcode cassette ,",
    "we revisit cre lox biology @xcite .",
    "cre is a bacteriophage pl recombinase that catalyzes site - specific recombination between lox sites .",
    "a lox site is a 34 bp sequence composed of two 13 bp palindromic flanking regions and an asymmetric 8 bp core region ( fig .",
    "[ fig : fig1 ] a ) . for recombination to occur , four cre proteins bind to the four palindromic regions of two lox sites and form a synaptic complex .",
    "a first pair of strand exchanges leads to a holliday junction intermediate @xcite .",
    "isomerization of the intermediate then allows a second pair of strand exchanges , and formation of the final recombinant product @xcite .",
    "the dna cleavage site is situated in the asymmetric core region .",
    "if the lox sites are on the same chromosome , their interaction requires formation of a dna loop . if they have the same orientation ( direct repeats ) , recombination results in excision of the intervening sequence . if lox sites are in the opposite orientation to each other ( inverted repeats ) , the sequence between the sites is inverted , becoming its reverse complement ( fig .",
    "[ fig : fig1 ] b ) . due to compatibility with eukaryotes ,",
    "the cre lox system has become an essential tool in genetic engineering and a large array of transgenic mouse models with inducible cell - type specific expression of cre have been created @xcite .    in _ in vitro _",
    "trials with cre mediated lox reactions , a sharp decrease in recombination efficiency has been observed when the sequence separating two lox sites is less than 94 bp @xcite .",
    "recombination is still detectable at low levels at 82 bp , but not at 80 bp where dna stiffness appears to prevent dna loop formation , and as a consequence lox site interaction . for the distinct , but similar , flp / fr system",
    "this minimal distance was established to be smaller _ in vivo _ , with interactions possible at 74bp @xcite .",
    "the existence of a minimal distance is one of the key features that we exploit to make random barcodes stable , but in our proposed design it will only prove necessary for it to be greater than 44 bp .      in complete generality , a lox barcode cassette is a series of lox sites interlaced with @xmath1 distinguishable dna code elements of size @xmath4 bp each .",
    "on cre expression , code elements change orientation and position , or are excised @xcite . through cre mediated excision , the number of elements eventually decreases until reaching a stable number ( fig .",
    "[ fig : fig1 ] c ) .",
    "sequences that have attained a stable number of code elements form size - stable barcodes .",
    "a cassette s code diversity is the number of size - stable barcodes that can be generated from the cassette via site - specific recombination .",
    "our main result is a robust lox cassette design that provably maximizes code diversity .",
    "the design is robust to both sequencing errors and to the minimal interaction distance between lox sites .",
    "the analysis that leads us to the design is provided in the optimal design section .",
    "the identification of code element sequences that avoid misclassification due to sequencing read errors then follows .",
    "finally , probabilistic aspects of code generation from an optimal barcode cassette are explored via monte carlo simulation .",
    "lox cassettes with code elements of size 4 bp , higher order lox interactions , and the impact of transient cre activation , are considered in the discussion .",
    "the optimal design will prove to have the orientation of both the outmost , and any two consecutive , lox sites inverted ( fig .",
    "[ fig : fig1 ] c ) .",
    "code elements between lox sites are of size longer than four bp , but shorter than 24 bp .",
    "the lower limit ensures that elements can be chosen sufficiently distinctly to correct two sequencing errors per element . due to the minimal lox interaction distance",
    ", the upper limit ensures that barcodes with three code elements are size - stable .    the barcode diversity for this cassette design with @xmath1 code elements under constitutive cre expression will , as established in the optimal design section , transpire to be @xmath5 which is maximal for code elements that are larger than four base pairs .    a good compromise between cassette , robustness to sequencing errors and barcode diversity is given by an alternating lox cassette with 13 elements of length 7 bp each as shown in fig .",
    "[ fig : fig1 ] c. the cassette is initially 567 bp long and generates a code diversity of @xmath6 barcodes .",
    "after excisions and inversions , size - stable barcodes are composed of either a single element or three elements , with lengths 75 bp and 157 bp respectively , including remaining non - interacting lox sites . concatenating four such cassettes with poorly - interacting lox variants ( e.g. loxp , lox2272 , lox5171 and m2 @xcite , fig .",
    "[ fig : fig1 ] d ) yields a @xmath7 bp construct with a size - stable code diversity of @xmath8 .      to implement cre lox barcoding in the mouse",
    ", one could cross mice generated from embryonic stem cells that have been transduced with the concatenated lox barcoding cassettes described above onto a tamoxifen inducible cell - type specific creer expressing background @xcite .",
    "an experiment is initiated by administrating tamoxifen to the animal , which activates cre and induces generation of a barcode ( @xmath9 bp ) in each cell where cre becomes active .",
    "some time after activation , cells of interest are harvested and sorted for specific phenotypes , and sequenced using a next generation sequencing platform that produces read - lengths @xmath10 bp .",
    "cells originating from the same progenitor carry the same barcode and this information can then used for scientific inference . to identify the frequent barcodes that are to be discarded in the analysis ( see the barcode distribution is heterogeneous section ) , in a control experiment large numbers of cells would be harvested shortly after tamoxifen administration and sequenced .",
    "a simple upper bound on the barcode diversity of @xmath11 elements from a cassette initially containing @xmath1 elements is the number of possible outcomes when choosing @xmath11 from @xmath1 elements in arbitrary order and orientation : @xmath12 although loose , it will become clear that it captures the dominant growth , @xmath13 , indicating the importance of @xmath11 in generating barcode diversity and motivating a closer look at how cassette designs influence it .    for what follows",
    ", we introduce some terminology : a cassette is alternating if the orientation of any two consecutive lox sites is inverted ( fig .",
    "[ fig : fig1 ] c ) ; outermost lox sites are termed flanking lox sites ; and flanking sites are direct or inverted if they have the same or opposite orientation , respectively .",
    "cre recombination requires a minimal distance between the interacting lox sites . in what follows",
    "we assume that the minimal distance for lox interaction is 82 bp , but our results will be robust for any minimal interaction distance greater than 44 bp .    to understand how a minimal lox - lox interaction distance and cassette design determine size - stable barcodes and code diversity , we start with the simplest case , a barcode with a single code element ( fig . [",
    "fig : fig2 ] a ) .",
    "if the code element is less than 82 bp , the barcode is size - stable irrespective of the orientation of its flanking sites .",
    "if the element is larger than 82 bp , the code is only size - stable if the flanking sites are inverted as excision will remove the element .    for a barcode with two elements , the sequence between the flanking sites contains an additional element and a lox site ( 34 bp ) , giving a sequence of @xmath14 bp .",
    "if the flanking sites have the same orientation , the barcode is size - stable if @xmath15 bp , hence if @xmath16 bp .",
    "if they are in opposite orientation , excisions can only occur if flanking sites interact with the middle lox site , and @xmath17 bp is sufficient for stability ( fig .",
    "[ fig : fig2 ] b ) . for given @xmath4 , in general",
    "if there exists a barcode of size @xmath11 with direct flanking sites , a barcode with @xmath18 elements is possible that has inverted flanking sites .",
    "thus @xmath4 and the orientation of the flanking sites are critical features that determine the maximum @xmath11 .    in fig .",
    "[ fig : fig2 ] c , the stability of barcodes with @xmath19 is shown as a function of @xmath4 for a cassette with inverted flanking sites .",
    "the stability depends on a critical distance , i.e. , the largest distance between two lox sites in the barcode that is , or can be brought into , the same orientation via recombination . as shown ,",
    "barcodes of size three and four become unstable if @xmath20 bp and @xmath21 bp , respectively , while barcodes of size five or greater are always unstable .",
    "orientation of a cassette s flanking sites is immutable under recombination",
    ". therefore cassettes with direct and inverted flanking sites generate barcodes with direct and inverted flanking sites only .",
    "having seen that maximal code diversity grows as @xmath13 , and that having inverted flanking sites relative to direct ones increases the maximum size of barcodes by one , it follows that the diversity for cassettes with inverted flanking sites is of the order @xmath22 .",
    "inverted flanking sites are thus superior in terms of code diversity and are an essential design decision .",
    "optimality regarding the size of the elements , @xmath4 , is more intricate . for @xmath23 ,",
    "the maximum size of barcodes is four elements , and according to the formula above , their diversity grows as @xmath24 .",
    "the stability of barcodes with four elements is , however , sensitive to the minimal distance estimate ( the gray interval in fig .",
    "[ fig : fig2 ] c ) . in addition",
    ", the short length of code elements limits error correction , a point revisited later .",
    "thus we focus on cassettes in the regime @xmath25 bp , which generate error - robust barcodes of up to size three and a code diversity that is insensitive to the reported minimal lox interaction distance .      for the orientation of the remaining lox sites we prove , via a two - step strategy , that the alternating design produces maximal code diversity .",
    "first we derive a refined upper bound for the diversity that takes into account the structure of the lox cassette , but ignores constraints imposed by the recombination process .",
    "we then show that alternating lox cassettes with inverted flanking sites and @xmath26 elements are unconstrained in terms of barcode generation via sequential recombination events , thus achieving this upper bound",
    ".      during cre induced recombination , cre proteins cleave the core region of the interacting lox sites asymmetrically @xcite .",
    "the sequences between subsequent cleavage sites are not affected by cre and represent the fundamental building blocks of the lox barcode cassette .",
    "each block contains a code element and half a lox site on each side .    depending on the orientation of the lox sites ,",
    "there are four possible types of blocks ( fig .",
    "[ fig : fig2 ] d ) .",
    "three colours have been used to code these : red , green and blue . by definition ,",
    "the reverse complement of a block is of the same colour class .",
    "in contrast to blue blocks , red and green blocks have their lox cores cleaved in a way such that their flanking lox sites are unchanged after inversion , while the intervening sequence is reverse - complemented .",
    "blocks are similar to the concept of units in @xcite , introduced to derive expressions for the total number of sequences , stable or unstable , generated from a lox cassette where all @xmath27 sites can interact .",
    "their analysis implies @xmath28 and a code diversity of order @xmath1 .",
    "quite distinctly , here we focus on enumerating size - stable sequences that arise in the regime @xmath25 bp with code diversities of order @xmath2 .",
    "stable codes are necessarily made of blocks from the initial cassette , and as shown in fig .",
    "[ fig : fig2 ] e , their composition in terms of block colors is prescribed .",
    "letting @xmath29 , @xmath30 , and @xmath31 be the number of red , green , and blue blocks in the initial cassette with @xmath1 elements , an upper bound on the number of possible barcodes of size @xmath11 with @xmath32 red , @xmath33 green and @xmath34 blue blocks is the number of possible outcomes when choosing @xmath35 , @xmath36 and @xmath37 from @xmath29 , @xmath30 and @xmath31 elements in arbitrary order : @xmath38 where @xmath39 and @xmath40 .",
    "the additional factor @xmath41 arises as there are two valid orientations of every code element of a red and green block after recombination .",
    "conditioned on @xmath29 , @xmath30 , and @xmath31 , to derive an upper bound for a cassette s diversity , we add the numbers for the four possible stable barcode configurations of @xmath35 , @xmath36 , and @xmath37 ( fig . [",
    "fig : fig2 ] e ) , taking into account that certain configurations appear more than once ( e.g. the configurations with one red and two blue blocks appears three times ) . using the expression above for each of the four configurations , for @xmath42 bp @xmath43 bp , and cassettes with inverted flanking sites pointing at each other (",
    "the opposite case is similar ) this yields , @xmath44 by construction , @xmath45 , and since @xmath46 , substituting the respective terms leads to an expression that is a function of @xmath1 and @xmath47 alone . for given @xmath1",
    "odd , this reduces the task of finding the optimal cassette design to an explicitly solvable one - dimensional optimization problem : @xmath48 for @xmath49 , the global maximum is achieved at the boundary @xmath50 .",
    "this implies @xmath51 , and a global upper diversity bound of @xmath52 , of order @xmath53 .",
    "it is easily verified that @xmath51 is only possible if the cassette design is alternating and n is odd , which implies the flanking sites are inverted .      for an alternating cassette design , achieving the code diversity",
    "upper bound requires complete freedom in code generation via recombination events . by construction , we show that this is the case if @xmath26 .",
    "consider an alternating cassette with five elements and @xmath21 bp , and recombination events that do not alter the size of the cassette ( i.e. , inversions ) .",
    "first note that red blocks in position three and five can move into the first position via a single recombination event .",
    "furthermore , a red block in position one can be inverted by first moving to position three , then to five , and back again . a straight - forward recipe to create",
    "an arbitrary code made of a single red block is then to : i ) move the block into the first position ( if required ) ; ii ) change its orientation ( if required ) ; and finally iii ) excise the remaining blocks .    similarly , to generate an arbitrary code composed of a red and a green block from an alternating cassette with six elements",
    ", we can perform steps i ) and ii ) .",
    "then we apply the same procedure to the green blocks , leaving the first block untouched .",
    "this results in the first two blocks of the cassette being the desired code . to generate the size - stable code , elements that are not part of the code are excised .",
    "finally , for a cassette with seven elements , sequentially following the recipe given above , the first three blocks can be populated such that they match any possible code before excising the remaining blocks .",
    "this shows that any possible code of size one to three can be created via lox recombination if the cassette is alternating , @xmath26 , @xmath21 bp , and flanking sites are inverted .    under constitutive cre expression , barcodes with three elements",
    "can still undergo inversions via the flanking sites , which reduces their code diversity by a factor of two .",
    "the code diversity is therefore that given in eq . .",
    "that barcodes generated from a lox cassette are pre - defined in terms of sequence and position in the genome represents an advantage over barcoding systems that rely on insertion site analysis for barcode readout @xcite . if codes - reading was error - free , choosing code elements of a particular color ( fig .",
    "[ fig : fig2 ] d ) from a set of sequences that differ at least by one bp pair in both orientations would be sufficient .",
    "the maximum number of such elements is @xmath54 and @xmath55 for @xmath4 even or odd , respectively , which is large even for small @xmath4 .    in order to be perfectly robust to @xmath56",
    "read errors via nearest - neighbor match , all pairs of elements of a given color need to differ by a hamming distance of at least @xmath57 bp @xcite .",
    "the size of the sets of elements that meet this condition quickly decreases with increasing @xmath56 ( see fig . [",
    "fig : fig3 ] a for numerical estimates ) . to ensure correction of two sequencing errors",
    "requires @xmath21 bp .    assuming that sequencing errors arise independently and error rates are identical for all bases , the number of read sequencing errors in a code element of size @xmath4 is binomial with the error probability per bp @xcite .",
    "any element that has @xmath56 or less errors will be classified correctly by nearest - neighbor matching .",
    "the probability of more than @xmath56 errors gives an upper bound for the expected proportion of misclassified code elements .",
    "[ fig : fig3 ] b shows this for elements of size @xmath58 bp as a function of the minimal distance and the read error rates for next - generation sequencing platforms @xcite .",
    "different symbols indicate different sequence data . even for low - fidelity platforms like pacific bioscience single molecule real time sequencing ,",
    "a minimal distance of five bp results in less than ten misclassified elements per million .",
    "in this section we explore stochastic features of the optimal design , specifically the probabilities to generate each of the final codes and the number of recombination events that are needed to create size - stable codes . for the analysis , we make two assumptions : first , all interactions with lox sites that are at least 82 bp apart are equally likely ; second , recombination events occur sequentially and independently",
    ".      size - stable barcodes of a lox cassette are randomly generated and not all codes are equally likely .",
    "although an analytical expression for the probability mass function of final codes is not available , stochastic simulations enable us to study properties of practical importance such as the probability of generating a code more than once . ensuring this probability is low is important in practice because progeny of two cells that independently generate the same code will be confounded as pertaining to the same clone .",
    "[ fig : fig3 ] c shows the generation probability for each of the 1022 codes from a cassette with 13 elements . to produce this plot ,",
    "@xmath59 barcodes were monte carlo generated _ in silico _ via sequential recombination of the initial cassette .",
    "the number of times a specific code appeared was recorded , normalized and sorted . while some codes are relatively frequent , most are rare . in fig .",
    "[ fig : fig3 ] d , the average number of recombination events ( inversions : blue , excision : black ) is plotted as a function of barcode probability .",
    "the number of inversions and barcode probability are negatively correlated , an indication that rare codes undergo , on average , more inversions .",
    "the number of excisions is close to two for all codes .",
    "ideally , each cell is tagged with a unique barcode .",
    "as with all existing barcoding techniques however , 100% unique barcodes can not be guaranteed .",
    "what influences the expected number of unique barcodes is the code diversity @xmath60 , @xmath61 , the probability of code @xmath62 , where @xmath63 , and @xmath56 , the total number of codes that are generated .",
    "using analysis of the generalized birthday party problem @xcite , the expected proportion of unique codes is @xmath64 where the numerically convenient approximation on the right hand side arises from a taylor expansion around @xmath65 and is appropriate if @xmath66 .",
    "relatively large @xmath67 s negatively affect the expected proportion of unique codes . for heterogeneous barcode distributions ,",
    "a natural strategy is to discard most frequent codes from the analysis .",
    "barcodes that are included in the final analysis are called informative .    using the approximation eq . , in fig .",
    "[ fig : fig3 ] e we computed the maximum number of cells that can initially be barcoded versus the number of cells that generate an informative code , for one to three sequential cassettes ( indicated by the numbers 1 , 2 , 3 ) , with the requirement that no more than 1% of informative codes are generated more than once .",
    "the color represents the percentage of discarded codes relative to the total code diversity .",
    "this parameter can be adjusted to meet the needs of a given experiment .",
    "e.g. , for three concatenated cassettes with 13 elements each , @xmath68 informative codes that are 99% unique can be generated by inducing barcodes in either @xmath69 cells and including most codes or inducing barcodes in @xmath3 cells and discarding most codes from the analysis .",
    "these results show that by discarding frequent codes from the read - out , large numbers of clones can be confidently tracked , indicating this _ in situ _ barcoding is suitable for high - throughput lineage tracing experiments .",
    "if cre is expressed for long enough , lox cassettes will eventually become size - stable . the time this will take correlates with the number of recombination events that separate a stable barcode from its initial cassette .",
    "below , we estimate this quantity using the theory of absorbing markov chains .    in a cassette with @xmath1 elements ,",
    "there are @xmath70 lox sites .",
    "the number of lox pairs that are flanking @xmath11 elements is @xmath71 .",
    "lox pairs that have less than three elements between them do not interact as they are separated by less than the minimal distance .",
    "pairs of lox sites that have three or more elements between them are termed productive . for @xmath72",
    "the number of productive pairs is @xmath73 , and the number of productive pairs , where recombination leads to excision , i.e. where an even number of elements separates the two sites , is @xmath74 for @xmath1 odd .",
    "the probability that a productive pair excises exactly @xmath11 elements is given by the ratio of productive pairs that are separated by @xmath11 elements to the total number of productive pairs , i.e. @xmath75 for @xmath11 even , @xmath76 , otherwise it is zero .",
    "the number of productive pairs where recombination leads to inversion is ( for @xmath1 is odd ) @xmath77 and the probability that interaction of a productive pair leads to an inversion is @xmath78    equations - allow the formulation of size - stable barcodes as a discrete - time absorbing markov chain .",
    "the number of elements in the cassette corresponds to its state , and eq . and",
    "eq . give the transition probabilities from @xmath1 to @xmath79 , and from @xmath1 to @xmath1 elements respectively .",
    "there are @xmath80 transient and @xmath81 absorbing states .",
    "absorbing states are cassettes that have either three , two , one , or zero elements . absorbing markov models",
    "are well understood , and a wealth of theoretical predictions regarding their properties are available @xcite .",
    "the fundamental matrix of this markov chain is @xmath82 where @xmath83 is an @xmath84 identity matrix , and @xmath85 is the transition matrix corresponding to the transient states .",
    "the expected number of recombination events , starting with a cassette of @xmath1 elements , until reaching a final code is the @xmath86 entry of the vector @xmath87 , where c is a column vector all of whose entries are 1 .    in fig . [",
    "fig : fig3 ] f , the average number of recombination events from the initial cassette to final code is shown as a function of the cassette length .",
    "although code diversity grows as @xmath53 , the number of recombination events code generation increases linearly in @xmath1 .",
    "when we identify the optimal lox barcode cassette , we focus on code elements in the regime @xmath88 . these have maximal size - stable barcodes of three elements that are insensitive to over - estimation of the minimal lox interaction distance . for @xmath23",
    "bp , size - stable barcodes of four elements are possible and their maximal code diversity grows as @xmath24 .",
    "these are stable , however , only if the minimal interaction distance between two lox sites is greater than @xmath89 bp , a distance at which interactions have shown to still be possible _ in vivo _ in the similar flp / fr system @xcite .",
    "most interesting is the case @xmath90 bp , which permits correction of one sequencing error with six code elements that are @xmath91 bp apart in both orientations ( see gray bars in fig .",
    "[ fig : fig3 ] a ) .",
    "the upper diversity bound is derived along the same lines as for @xmath21 bp ( see fig . [",
    "fig : fig4 ] e for possible stable codes ) , which gives @xmath92 to maximize usage of the 6 code elements , we start with a cassette that has six red , five green and six blue blocks , i.e. @xmath93 .",
    "this gives an upper diversity bound of 36996 barcodes .",
    "as confirmed by simulations , this upper bound is attained by a cassette with inverted flanking sites in which the first 11 lox sites are alternating , and the remaining sites , except the last , are oriented in the same direction as the first lox site ( fig .",
    "[ fig : fig4 ] f ) . under constitutive cre expression , barcodes with four elements can still undergo inversions , and the effective code diversity is 19,716 .",
    "careful measurements will be needed to determine whether lox sites at a distance of 80 bp still interact . if they do nt , the cassette shown in fig .",
    "[ fig : fig4 ] f with @xmath90 bp represents an interesting alternative to the design described in the main text , as with less elements it reaches higher code diversity , but at the cost of less robustness to sequencing error and hence barcode readout fidelity .",
    "single recombination events always involve exactly two lox sites .",
    "however nothing except dna flexibility prevents several pairs of lox sites to interact simultaneously .",
    "the rate at which pairs of lox sites bind depends on the number of lox sites and the kinetic rates of lox - lox complexes . _ in vitro _ , the latter appear stable @xcite and with the potentially large number of lox sites in the barcode cassettes , make simultaneous interactions a plausible possibility .",
    "higher order lox interactions lead to previously unreported , and in certain cases novel , recombination products ( fig .",
    "[ fig : fig4 ] c ) . for example , simultaneous interactions of two overlapping pairs of lox sites oriented in the same direction do not result in excision , but in a reordering of the sequences between the sites .",
    "similarly , if pairs are inverted , simultaneous recombinations do not invert but excise the sequence between the outermost sites .    for the alternating cassette and @xmath26",
    ", multiple concurrent lox interactions do not generate additional codes as the upper code diversity bound is already attained .",
    "therefore our results on lox barcode design and code elements remain unchanged in the presence of higher order lox interactions .",
    "what changes is the distribution over barcodes , which flattens in the tail if more than one lox pair recombines at a time ( fig .",
    "[ fig : fig4 ] d ) .",
    "code diversity strongly depends on the number of elements in size - stable barcodes .",
    "if cre is expressed constitutively , size - stable barcodes with code elements of size @xmath21 bp have a maximum of three elements .",
    "another possibility is to create transient cre activity rather than constitutive .",
    "a well tested system that provides temporal control over cre activity is tamoxifen inducible creer @xcite . in the presence of tamoxifen , the fusion protein creer , which is normally located in the cytoplasm ,",
    "is transported into the nucleus , where it can bind to lox sites and induce recombination .",
    "depending on the duration of cre activation and its efficiency , stable sequences with more than three elements are likely to be generated from a lox barcode cassette .",
    "although most of these sequences are stable only in the absence of cre , in this section we make no distinction between these and the size - stable barcodes defined earlier .",
    "[ fig : fig4 ] a shows barcode probabilities after activation of creer in @xmath69 cells with an optimal lox cassette of size 13 .",
    "the number of recombination events induced by transient creer activity is assumed poisson with mean one .",
    "about @xmath94 distinct barcodes are generated , and 30% of these appear only once . although promising in terms of code diversity , it should be noted that potential drawbacks of this approach are the length of the barcodes ( leading to more involved code sequencing ) , leakiness of creer into the nucleus in non - induced cells @xcite , and the relatively long half - life of tamoxifen @xcite .",
    "existing cellular barcoding approaches have already lead to significant biological discoveries and so new approaches that overcome their shortcomings are inherently desirable .",
    "here we have established that using cre lox , it would be feasible to create an _ in situ _",
    ", triggerable barcoding system with sufficient diversity to label a whole mouse , and propose this as a system for experimental implementation .",
    "nolan - stevaux o , tedesco d , ragan s , makhanov m , chenchik a , ruefli - brasse a , et  al . measurement of cancer cell growth heterogeneity through lentiviral barcoding identifies clonal dominance as a characteristic of in vivo ttmor engraftment .",
    "2013;8(6):e67316 + .",
    "klauke k , broekhuis mjc , weersing e , dethmers - ausema a , ritsema m , gonzlez mv , et  al . tracing dynamics and clonal heterogeneity of cbx7-induced leukemic stem cells by cellular barcoding .",
    "stem cell reports . 2015;4(1):7489 .",
    "gomes fl , zhang g , carbonell f , correa ja , harris wa , simons bd , et  al .",
    "reconstruction of rat retinal progenitor cell lineages in vitro reveals a surprising degree of stochasticity in cell fate decisions . development .",
    "2011;138(2):227235 .",
    "ringrose l , chabanis s , angrand po , woodroofe c , stewart af .",
    "quantitative comparison of dna looping in vitro and in vivo : chromatin increases effective dna flexibility at short distances . the embo journal . 1999;18(23):66306641 .",
    "bp palindromic cre binding sites and an @xmath95 bp core ( original loxp sequence shown ) .",
    "cleavage sites in the core are indicated by arrows . *",
    "b * ) cre mediated site - specific excision and inversion of a sequence with a minimum of @xmath96 bp between two lox sites on the same chromosome @xcite . if lox sites are oriented in the same direction , recombination excises the sequence , while if they are oriented in opposite direction the sequence is inverted ( i.e. , the reverse complement ) .",
    "* c * ) an alternating lox cassette with 13 elements of size 7 bp . to illustrate how barcodes are generated ,",
    "two excision and one inversion event are shown , creating a size - stable barcode with three random elements .",
    "pairs of interacting lox sites are indicated by a , b , and c. elements affected by recombination have colored background .",
    "the barcode with three elements is size - stable as lox sites oriented in the same direction ( arrows ) are closer than the minimal lox interaction distance , precluding further excision . *",
    "d * ) four concatenated alternating lox cassettes of 13 elements each with poorly - interacting lox site variants",
    "@xcite result in a code diversity greater than @xmath3 .",
    "[ fig : fig1 ] ]     to @xmath42 elements for a lox barcode cassette with inverted flanking sites .",
    "if the critical distance surpasses the minimal distance , stable codes ( green ) become unstable ( gray ) .",
    "barcodes of size three and four are unstable if @xmath20 and @xmath21 respectively , while codes of size five are always unstable .",
    "the gray interval illustrates potential uncertainty in the estimate of the minimal interaction distance . *",
    "d * ) sequences between lox cleavage sites represent the fundamental building blocks of the barcode cassette .",
    "there are two with inverted lox repeats ( red , green ) and two direct lox repeats ( blue ) types of blocks . in the example , code elements are of size 7 bp and n denotes an arbitrary base .",
    "* e * ) for a cassette with inverted flanking sites pointing at each other and @xmath97 , four block compositions are possible ( @xmath98 ) : two for barcodes of size three ( three @xmath99 and one @xmath100 ) , one for barcodes of size two ( two @xmath101 ) and one for barcodes of size one ( one @xmath102).[fig : fig2 ] ]     bp . *",
    "b * ) upper bound for the expected proportion of misclassified elements as a function of empirical dna sequencing read error rates @xcite for common sequencing platforms ( illumina , ion torrent , pacific biosciences ) and different sequence data ( p. falciparum ( @xmath103 ) , e. coli ( @xmath104 ) , r. spha .",
    "( @xmath105 ) , h. sapiens ( @xmath106 ) ) .",
    "the minimal distance that separates the elements is 1 bp ( solid ) , 3 bp ( dotted ) , and 5 bp ( dashed ) .",
    "* c * ) ranked probabilities of the 1022 size - stable barcodes from a cassette with 13 elements generated under constitutive cre expression .",
    "a few codes are relatively frequent , but the majority are rare . *",
    "d * ) scatter - plot showing barcode probabilities against the average number of excisions ( black ) and the number of inversions ( blue ) that are generate size - stable barcodes from a 13 element optimal cassette .",
    "* e * ) number of cells in which a barcode can be induced versus the number of cells that produce informative codes , for one to three sequential cassettes , without exceeding 1% repeated occurrences in the informative codes .",
    "the color represents the percentage of discarded codes relative to the total code diversity , which can be adjusted to experimental conditions post acquisition . * f",
    "* ) although code diversity grows as @xmath53 , the expected number of recombination events that are needed to generate a size - stable code increases linearly in @xmath1 .",
    "[ fig : fig3 ] ]     bp .",
    "* b * ) cassette with 17 elements and @xmath90 bp that attains an effective code diversity of 19,716 barcodes if the minimal lox interaction distance is greater than @xmath89 bp .",
    "* c * ) if two ore more pairs of lox sites recombine simultaneously , unexpected recombination products can occur .",
    "* d * ) estimated barcode distribution if two lox pairs can interact simultaneously ( blue ) .",
    "the distribution becomes flatter at the lower end , implying that rare codes are more likely than if recombination events only occur sequentially ( black ) .",
    "* e * ) mimicking a short cre activation pulse in a population of a million cells carrying a 13 element lox cassette , the number of recombination events is assumed poisson distributed with mean @xmath107 . after the pulse many barcodes have not experienced any excisions . * f * ) code abundance after the pulse .",
    "almost @xmath94 distinct barcodes are generated , with  30% being generated once .",
    "[ fig : fig4],title=\"fig : \" ] +   bp .",
    "* b * ) cassette with 17 elements and @xmath90 bp that attains an effective code diversity of 19,716 barcodes if the minimal lox interaction distance is greater than @xmath89 bp .",
    "* c * ) if two ore more pairs of lox sites recombine simultaneously , unexpected recombination products can occur . *",
    "d * ) estimated barcode distribution if two lox pairs can interact simultaneously ( blue ) .",
    "the distribution becomes flatter at the lower end , implying that rare codes are more likely than if recombination events only occur sequentially ( black ) .",
    "* e * ) mimicking a short cre activation pulse in a population of a million cells carrying a 13 element lox cassette , the number of recombination events is assumed poisson distributed with mean @xmath107 .",
    "after the pulse many barcodes have not experienced any excisions . * f * )",
    "code abundance after the pulse .",
    "almost @xmath94 distinct barcodes are generated , with  30% being generated once .",
    "[ fig : fig4],title=\"fig : \" ] +   bp . * b * ) cassette with 17 elements and @xmath90 bp that attains an effective code diversity of 19,716 barcodes if the minimal lox interaction distance is greater than @xmath89 bp .",
    "* c * ) if two ore more pairs of lox sites recombine simultaneously , unexpected recombination products can occur .",
    "* d * ) estimated barcode distribution if two lox pairs can interact simultaneously ( blue ) .",
    "the distribution becomes flatter at the lower end , implying that rare codes are more likely than if recombination events only occur sequentially ( black ) .",
    "* e * ) mimicking a short cre activation pulse in a population of a million cells carrying a 13 element lox cassette , the number of recombination events is assumed poisson distributed with mean @xmath107 . after the pulse many barcodes have not experienced any excisions . * f * ) code abundance after the pulse .",
    "almost @xmath94 distinct barcodes are generated , with  30% being generated once .",
    "[ fig : fig4],title=\"fig : \" ]"
  ],
  "abstract_text": [
    "<S> cellular barcoding is a significant , recently developed , biotechnology tool that enables the familial identification of progeny of individual cells in vivo . </S>",
    "<S> most existing approaches rely on ex vivo viral transduction of cells with barcodes , followed by adoptive transfer into an animal , which works well for some systems , but precludes barcoding cells in their native environment , such as those inside solid tissues . with a view to overcoming this limitation , </S>",
    "<S> we propose a new design for a genetic barcoding construct based on the cre lox system that induces randomly created stable barcodes in cells in situ by exploiting inherent sequence distance constraints during site - specific recombination . </S>",
    "<S> leveraging this previously unused feature , we identify the cassette with maximal code diversity . </S>",
    "<S> this proves to be orders of magnitude higher than what is attainable with previously considered cre lox barcoding approaches and is well suited for its intended applications as it exceeds the number of lymphocytes or hematopoietic progenitor cells in mice . </S>",
    "<S> moreover , it can be built using established technology .    </S>",
    "<S> * keywords : * cell fate tracking ; cellular barcoding ; cre lox system ; dna stochastic programme ; combinatorial explosion . </S>"
  ]
}