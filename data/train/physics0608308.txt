{
  "article_text": [
    "virtual compton scattering ( vcs ) off the nucleon @xmath0 is a valuable reaction to study the structure of the nucleon .",
    "vcs refers to the reaction @xmath1 , where @xmath2 and @xmath3 represent a virtual and a real photon , respectively .",
    "it can be seen as an extension of real compton scattering ( rcs ) to photon virtuality @xmath4 . in this case",
    "six electromagnetic observables , called generalized polarizabilities ( gps ) , enter the cross section and may be determined to gain valuable insight into the structure of the scatterer . in the real - photon limit , @xmath5 , two of the six independent gps are proportional to the well - known polarizabilities @xmath6 and @xmath7 obtained from rcs .",
    "the concept of gps has first been worked out by arenhvel et al .",
    "@xcite for nuclei and later by guichon et al .",
    "@xcite for the nucleon .",
    "vcs off the proton is studied using the @xmath8 reaction : an electron scatters off a proton and a real photon is produced .",
    "the scattered electron and the recoiling proton are detected in coincidence , each in a high - resolution magnetic spectrometer , and real - photon production events are identified by reconstruction of the missing mass , which is zero in this reaction .",
    "the real photon can be produced either by the incoming or by the outgoing electron ( the bethe - heitler contribution to the reaction ) or by the nucleon .",
    "the nucleon contribution contains the born part and the non - born part .",
    "the sum of the bethe - heitler and the born contributions will be denoted by bh+b .",
    "the non - born part contains the gps , which are accessible through the deviation of the measured @xmath8 cross section from the bh+b cross section , the latter being perfectly calculable once the elastic form factors of the proton are known .",
    "the very first dedicated vcs experiment below pion threshold to obtain information on the gps took place at the mainz microtron mami ( mainz , germany ) at @xmath9 ( gev / c)@xmath10  @xcite .",
    "for the kinematics of this experiment the contribution of the gps to the cross section had been estimated to amount to 10%  @xcite .",
    "this means that the absolute cross section had to be measured very precisely .",
    "in addition , one needed very elaborated analysis methods .",
    "the present paper is devoted to the description of the latter , which have been developed further and adapted to analyse also the next vcs experiment , performed at the thomas jefferson national accelerator laboratory jlab ( newport news , usa ) at @xmath11 values of 0.9 and 1.8 ( gev / c)@xmath10  @xcite .",
    "both experiments are unpolarized and they are very similar , in apparatus as well as in method .",
    "most numerical examples given in this paper refer to the mami experiment .",
    "the monte carlo code simulates @xmath8 events comparable to those of the experiments .",
    "the simulation generates realistic spectra in the physical variables of interest and it has been used to determine with great accuracy what we will call effective solid angle .",
    "this effective solid angle is defined such that it does not only represent the geometrical acceptance , but it also includes the convolution of many effects .",
    "the aim of the present paper is to explain how the cross - section behaviour and the various resolution - deteriorating processes taking place in the target and in the detection systems have been taken into account .",
    "in addition the calculation of the simulated luminosity is explained . throughout the paper",
    "the cross section used in the simulation will be often called `` vcs cross section '' for simplicity .",
    "the paper is organized as follows : in section [ sec : definitions ] the kinematics of the reaction , a description of the experiment and the definition of the effective solid angle are discussed . in section [ sec : cross_section_and_phase_space ]",
    "we outline the method used to implement the cross - section behaviour and we define the phase space in which the events are generated . section [ sec : radcor ] is devoted to a detailed description of the implementation of the radiative effects .",
    "section [ sec : sim_pack ] discusses the simulation package .",
    "section [ sec : integrated_luminosity ] covers the determination of the simulated luminosity and section [ sec : solang ] the calculation of the effective solid angle .",
    "results are presented in section [ sec : results ] .",
    "finally , section [ sec : summary ] is a brief summary of the paper .",
    "in the process @xmath8 an incoming electron with momentum @xmath12 scatters off a proton by exchange of a virtual photon @xmath2 with momentum @xmath13 and a real photon with momentum @xmath14 is emitted .",
    "the vector @xmath12 and the momentum vector of the outgoing electron , @xmath15 , define the scattering plane .",
    "the momentum vector of the recoiling proton , @xmath16 , and @xmath14 define the reaction plane .",
    "the vector @xmath13 , which is determined as @xmath17 , lies in both planes .",
    "the direction of the real photon in the cm - system of @xmath2 and @xmath18 is determined by the angle between the two photons , @xmath19 , and the angle @xmath20 between the scattering and the reaction plane as is shown in figure  [ fig : kinem ] ( throughout this paper all variables in the center of mass have an index _ cm _ ; if no index is given the variable is defined in the laboratory system ) .",
    "@xmath20 is defined equal to @xmath21 when @xmath14 lies in the scattering plane and points to the same side of @xmath13 as @xmath15 . in the cm - system ,",
    "@xmath3 and @xmath22 move back to back . in the laboratory system the recoiling proton is boosted in a ( narrow ) cone around @xmath13 , while the undetected @xmath3 can have any direction .",
    "this very welcome feature of the vcs kinematics makes it possible to cover a large range in @xmath19 by detecting the proton within the moderate solid angle of a high - resolution spectrometer .    in the experiment a monochromatic electron beam impinges on liquid hydrogen ,",
    "contained in a metal can of known geometry .",
    "its temperature and pressure are constantly monitored . to prevent local overheating of the liquid ( which would cause density fluctuations and as such luminosity errors ) , the beam position on the target is continuously moving using a `` raster '' system .",
    "the scattered electron and the recoil proton are both detected in magnetic spectrometers , the entrance collimators defining their angular acceptances .",
    "the electron spectrometer defines the virtual - photon acceptance . for each electron -",
    "spectrometer setting , several proton - spectrometer settings are used to cover the interesting part of the proton cone . as both spectrometers usually rotate in the horizontal plane , one measures essentially around @xmath23 and @xmath24 ; only at sufficiently high momentum transfer and low real - photon energy the full proton cone is covered by the acceptance of the proton spectrometer . +     reaction . on the left - hand side",
    "all variables are drawn in the center of mass of @xmath2 and @xmath18 . in the laboratory system",
    "the proton is boosted on a cone around @xmath13 as shown on the right.,width=491 ]      for an ideal experiment ( free of resolution effects ) the cross section is determined from the number of counts detected in a given phase space bin , @xmath25 , and the integrated luminosity , @xmath26 , via @xmath27 where @xmath28 is a notation for the differential cross section and @xmath29 represents an infinitesimal bin in the phase space under study .",
    "it is clear that in order to derive precise differential cross sections from the measured data , the solid angle of the detection apparatus has to be accurately known .",
    "using equation   one determines the cross section averaged over the solid angle @xmath30 , the latter one being a purely geometrical quantity . when the cross section has a curvature , ascribing the average cross section to the mean kinematics results in a bias .",
    "one can solve this bias by ascribing the measurement to an appropriate different kinematics ( c.f .",
    "this is , however , unpractical in our case because the cross section depends on five kinematical variables ( see section  [ sec : cross_section_and_phase_space ] ) . in this case",
    "one can stick to the central kinematics ( or choose any other kinematics in the bin ) and apply an appropriate correction to the average cross section in order to get an unbiased result .",
    "we choose to include this correction factor in the solid angle by defining another solid angle @xmath31 : @xmath32 where @xmath33 is the cross section at the chosen point .",
    "the solid angle @xmath31 deviates from @xmath34 by the amount @xmath35 , which depends on the curvature of the cross section over the bin and the chosen point in the bin . to obtain",
    "@xmath31 one must know with sufficient accuracy the cross section behaviour of the process under study in the phase space region under consideration . in principle , this must be the cross section which one is going to measure and which is therefore unknown at the moment of the simulation . a sufficiently good approximation , however",
    ", is the bh+b cross section , since it is expected to deviate by less than 10% from the complete @xmath8 cross section ; in particular its curvature , which is the decisive feature in this context , should be a very good approximation to the real one .",
    "the solid angles @xmath30 or @xmath36 must incorporate not only the actual detection geometry but also the various resolution effects .",
    "this is why these solid angles are called `` effective '' and why they can only be calculated by a monte carlo simulation .",
    "the present simulation is used to calculate @xmath36 of the experimental setups used in vcs experiments and , at the same time , to compare experimental and simulated data on an absolute scale . to this end , one introduces a simulated luminosity , @xmath37 , equivalent to the experimental one .",
    "this simulated luminosity is defined by @xmath38 where @xmath39 stands for the differential cross section in the simulation averaged over a well - known solid angle , @xmath40 , and @xmath41 is the number of events generated in @xmath40 . once the quantity @xmath37 is known , one calculates the effective solid angle @xmath42 ( which can be @xmath34 or @xmath31 ) , in full parallellism with equation   and using @xmath43 where @xmath44 is the cross section used in the simulation and @xmath45 the number of events in @xmath42 .",
    "sections [ sec : cross_section_and_phase_space ] to [ sec : integrated_luminosity ] describe how the various terms of this equation are obtained .",
    "as mentioned above , the calculation of @xmath46 needs as input the cross section behaviour .",
    "the bh+b cross section , @xmath47 , depends on the variables ( @xmath48 ) , where @xmath49 , @xmath50 ,  are the moduli of the corresponding three - vectors . instead of @xmath51 and",
    "@xmath52 one can also use @xmath53 and the photon polarisation , @xmath54 , which ensures that , in the cross - section grid used by the simulation , only the real physical space is covered .",
    "an example of how the cross section behaves as a function of @xmath19 and @xmath20 for fixed @xmath55 , @xmath56 and @xmath54 for the mami kinematics is shown in figure  [ evol ] .",
    "it is symmetric with respect to the scattering plane , and therefore only a `` half - sphere '' is shown .",
    "one clearly observes the two peaks corresponding to real photon emission around the incoming and outgoing electron directions . over the complete angular range",
    "the cross section varies by orders of magnitude , but in the phase space of interest ( which is away from the peak region ) , the cross section flattens substantially .",
    "this allows one to choose a reasonable upper limit , or envelope value , for the cross section sampling , which cuts through the peaks .",
    "reaction as a function of @xmath19 and @xmath20 ( @xmath57 mev / c , @xmath58 mev / c and @xmath59).,width=377 ]    the number of events in an infinitesimal phase space bin is given by @xmath60 where @xmath61 is the angle between the scattering plane and the horizontal plane containing the axis of the spectrometers .",
    "to generate counts in the phase space according to equation one uses the acceptance - rejection method  @xcite in five dimensions with a constant as envelope for the cross section",
    ". however , the theoretical code  @xcite used to calculate the bh+b cross section is too slow to be used on an event - by - event basis in the simulation . to solve this problem ,",
    "the theoretical code has been used to calculate the bh+b cross section at the nodes of a five - dimensional grid in the variables ( @xmath62 ) .",
    "then , in the simulation , the cross section value is obtained by interpolating in this grid , which makes the calculation faster by a factor of about 1000 . in practice ,",
    "a logarithmic interpolation is performed , reaching an accuracy of better than 1% .",
    "+      the events have to be generated according to the five - fold differential bh+b cross section in a phase - space volume @xmath63 . for an efficient simulation ,",
    "one wants to optimize this phase space . while being not too large , it must cover the full acceptance of the apparatus , taking into account all resolution effects .",
    "the following ranges in the above mentioned variables are used :    * @xmath64 : the maximum and minimum values of @xmath52 and @xmath61 are determined taking into account the shape of the extended target , the position of the spectrometer and the shape of its entrance collimator and multiple scattering effects . * @xmath65 : the lower bound is given by the lower limit of the momentum acceptance of the electron spectrometer .",
    "the upper bound is given by the maximum momentum of elastically scattered electrons in the @xmath66 bin defined above .",
    "this upper bound is fixed independently of the position of the elastic line relative to the electron spectrometer s momentum acceptance , since an electron , scattered with a momentum larger than the maximum accepted momentum , can still be detected due to energy losses before the spectrometer s entrance .",
    "* @xmath67 : the outgoing photon can go in any direction in the cm - system , therefore events are generated in the full solid angle @xmath68 . as a result , the outgoing proton is also sampled in its full angular phase space , i.e. the full proton cone in the laboratory .",
    "this ensures that all detectable events are indeed taken into account , even with resolution - smearing at the target .",
    "another advantage is that the simulation can be run for several proton - spectrometer settings all at once . for each generated proton",
    ", the simulation performs a loop over the various proton - spectrometer settings and tests if the particle is accepted or not .",
    "the five - fold differential cross section depends on the incoming electron momentum at the interaction point , @xmath49 , but it is not differential in this variable .",
    "however , although the beam is monochromatic ( at the 10@xmath69 level ) , @xmath49 is not a constant .",
    "each incoming electron loses energy in the target by collisions and by external bremsstrahlung in the material before the vertex point and by internal bremsstrahlung at the vertex point itself ( see section [ sec : radiative_tail ] ) .",
    "the resulting distribution of @xmath49 at the interaction point is depicted on figure  [ fig : beam_momentum ] for an incoming electron momentum of 766.4  mev / c and a hydrogen target of 340 mg / cm@xmath10 .",
    "the energy losses by collision and by external and internal bremsstrahlung ( before scattering ) are taken into account .",
    "the insert shows a rebinned zoom on the peak region in linear scale.,width=302 ]",
    "the radiative tail is a well - known feature of electron scattering experiments : after correction for the energy losses by collisions , the energy spectrum of the scattered electron shows a peak at the kinematically expected value , but this peak is accompanied by a radiation tail to lower energies @xcite .",
    "this tail is due to energy loss of the incoming and outgoing electron via ionisation , external bremsstrahlung in the materials of the target and up to the spectrometer s entrances and via internal real radiation in the scattering process itself .",
    "these effects are of course also present in vcs experiments and give rise to the radiative tail observed in the spectrum of the missing mass squared @xmath71 , defined as @xmath72 ( bold characters represent the four - vector of the particles ) .",
    "the resulting tail is shown in figure  [ fig : mx2_exp_sim ] .",
    "for the calculation of the effective solid angles , one needs a recipe to generate in the monte carlo simulation the radiation tail as observed .",
    "indeed , experimentally one applies a cut in the @xmath71 spectrum around 0 to select real - photon production events , and the same cut must be applied to the simulated events .",
    "the simulation reproduces the radiative tail well , which is very important because one wants the final cross - section result to be independent of the cut in @xmath71 .",
    "in fact , the influence of the position of the cut in the missing mass squared on the resulting cross section was lower than 1  % in the mami case . by reproducing the radiation tail in the simulation , the part of the radiative corrections which changes the kinematics of the reaction",
    "is taken into account , and the simulated radiative tail is properly convoluted with the detector acceptance ( these points will be discussed below ) . the other part of the radiative corrections is applied as a constant factor to the calculated cross section .",
    "internal and external real radiation are incorporated in the simulation .",
    "these processes are simulated by sampling in an energy - loss distribution for the incoming and outgoing electron . in the simulation only the electron s energy",
    "is changed , while its direction is assumed to be unaffected by the radiation effects ( angular peaking approximation ) . for ionisation not only",
    "energy losses are taken into account for the electron and proton , but also multiple scattering is incorporated in the simulation .",
    "the used probability distributions are discussed in the following subsections .    , for one of the mami kinematics ( @xmath73 mev / c , @xmath74 , @xmath57 mev / c ) . for the simulation",
    "the bh+b cross section was used and the simulated distribution is normalised using the factor @xmath26/@xmath37.,title=\"fig:\",width=245 ] , for one of the mami kinematics ( @xmath73 mev / c , @xmath74 , @xmath57 mev / c ) . for the simulation",
    "the bh+b cross section was used and the simulated distribution is normalised using the factor @xmath26/@xmath37.,title=\"fig:\",width=245 ]      collisions of the particles in the materials of the target are simulated by applying an energy loss and a scattering angle .",
    "the program glando of the cern - libraries @xcite is used to generate a realistic energy - loss distribution based on the mean value of the energy loss , which is calculated using the bethe - bloch equation .",
    "the deflection caused by multiple scattering is treated as explained in @xcite .",
    "an electron passing through a slice of material of thickness @xmath75 ( in units of radiation length ) emits photons due to bremsstrahlung .",
    "the energy loss of the electron , @xmath76 , is equal to the sum of the energies of all produced photons .",
    "the distribution of @xmath76 is given in very good approximation by  @xcite ( @xmath77 ) @xmath78.\\ ] ] @xmath79 is the kinetic energy of the electron before bremsstrahlung and @xmath80 .    to generate the energy loss of the electron , one samples an energy loss according to the distribution using the acceptance - rejection method , using @xmath81 as an envelope . to avoid variable overflows in the code for very small @xmath76",
    ", the introduction of a lower limit , @xmath82 , is necessary . in the present simulation @xmath83  kev ( which is well below the resolution of the experiment ) .",
    "finally the electron energy is decreased by the obtained value for @xmath76 .    in the simulation of the bremsstrahlung ,",
    "only the energy of the electron is changed , which is equivalent with photon emission along the electron - momentum direction .",
    "this is a good approximation , since bremsstrahlung is very forwardly peaked .",
    "the smaller @xmath76 , the better this approximation . moreover , the scattering angle due to bremsstrahlung is small compared to that from multiple scattering .",
    "the cross section for the @xmath8 reaction , @xmath84 , i.e. a process involving only one virtual photon and one real photon , can not be measured directly , since in reality the pure @xmath8 process is always accompanied by additional photons , either real or virtual .",
    "these internal radiative effects give rise to a measured cross section , @xmath85 , which deviates from @xmath84 : @xmath86 the correction term @xmath87 is negative and depends on the cut in the radiative tail accompanying the scattering process .",
    "the internal radiative corrections to vcs are discussed in great detail in  @xcite .",
    "written in first order , one gets @xmath88 @xmath89 accounts for vacuum polarisation diagrams , @xmath90 is the vertex correction and @xmath91 is the correction for radiation in the one additional photon approximation .",
    "one can approximately take into account higher order radiative corrections by writing  @xcite : @xmath92 for @xmath93 , one can write : @xmath94 - { \\frac{1}{2 } } \\ln^2 \\bigl ( { \\frac{e_{cm}}{e_{cm}^ { ' } } }   \\bigr ) \\ , \\bigr .",
    "\\nonumber\\\\ & & \\hspace{.8cm}\\bigl .",
    "+ \\ , \\frac{1}{2 } \\ln^2 \\bigl ( \\frac{q^2}{m^2 } \\bigr ) \\,-\\ , { \\frac{\\pi^2}{3 } } \\,+\\ , sp\\bigl ( \\cos^2 \\frac{\\theta_{e',cm}}{2}\\bigr ) \\bigr\\ } \\ ; , \\\\",
    "\\delta_{ver } & \\approx &   \\frac{\\alpha}{\\pi } \\bigl\\ { - \\frac{3}{2 } \\ln \\bigl(\\frac { q^2}{m^2 } \\bigr )   -2 - \\frac{1}{2 } \\ln^2\\bigl(\\frac { q^2}{m^2 } \\bigr ) + \\frac{\\pi^2}{6 } \\bigr\\ } , \\\\ \\delta_{vac } & \\approx &   \\frac{2\\alpha}{3\\pi } \\bigl\\ { - \\frac{5}{3 } + \\ln \\bigl(\\frac { q^2}{m^2 } \\bigr )   \\bigr\\ } , \\label{eq : radcorrrealbis}\\end{aligned}\\ ] ] where @xmath95 ( @xmath96 ) is the incoming ( outgoing ) electron ( kinetic ) energy at the reaction vertex , @xmath6 is the fine - structure constant and @xmath97 is the electron mass .",
    "@xmath98 is the spence function , eg .",
    "the virtual correction terms @xmath90 and @xmath89 are independent of the cut in the radiative tail , @xmath99 , and nearly constant for the phase space of interest .",
    "the correction for these effects will be applied by a constant correction factor to the measured cross section . since",
    "only the first term of @xmath91 is dependent on @xmath99 , this term is related to the radiative tail .",
    "the other terms of @xmath91 are independent of the cut position and they can be considered to be constant over the phase space of interest . therefore they will be treated in the same way as @xmath90 and @xmath89 .",
    "the radiative tail appears in the spectrum of the missing mass squared @xmath71 .",
    "the cut position should be expressed in terms of @xmath71 since in the experiment one cuts in @xmath71 to identify photon - production events .",
    "the relation between @xmath99 and @xmath71 is given by  @xcite @xmath100 given the relationship one could apply the correction to obtain @xmath84 , without including the internal radiative effects in the simulation .",
    "this procedure would only be valid if the acceptance of the detectors would not cut in some parts of the phase space more severely in @xmath71 than the cut on the missing mass itself .",
    "this , however , is not the case in the experiments",
    ". therefore the simulation must generate the full radiative tail by implementing electron energy losses by radiation , reproducing in this way realistic spectra .",
    "the first factor of the correction factor @xmath101 is the product of a number of factors , of which the first one can be written as @xmath102 where @xmath103 $ ] .",
    "assuming angular peaking , we can write  @xcite @xmath104 following  @xcite we interpret the factors @xmath105 and @xmath106 as the fraction of incoming and outgoing electrons respectively , which have lost less than @xmath107 or @xmath108 due to internal real radiation . to sample each of these energy losses",
    "@xmath76 one uses the distribution , @xmath109 , such that : @xmath110 integration yields @xmath111 which is normalised to 1 .",
    "remark the similarity between @xmath109 and the leading term of @xmath112 ( eq . ) .",
    "@xmath113 has been replaced by the quantity @xmath114 , which is well known in literature as equivalent radiator @xcite , i.e. an imaginary radiator placed before and after the scattering center to generate internal real radiation .",
    "the recipe used to introduce the radiation tail due to internal radiation in the monte carlo simulation is :    1 .",
    "sample an energy loss , @xmath107 , according to the distribution with @xmath115 incoming electron energy @xmath116 .",
    "2 .   generate the kinematics of a @xmath8 event at the vertex ( see figure  [ fig : kinem ] ) for the reduced energy @xmath117 of the incoming electron .",
    "the events are sampled according to the cross section at this reduced energy .",
    "after the scattering process the outgoing electron has an energy @xmath118 at the vertex .",
    "3 .   sample an energy loss , @xmath119 , according to the distribution with @xmath120 .",
    "the outgoing electron energy is now @xmath121 .",
    "remark that the above procedure implies electron - energy losses both at the incoming and the outgoing electron sides , which is fully consistent with the exponentiation idea .",
    "again , for numerical reasons , one has to introduce a @xmath82-value to sample in the @xmath122 distribution . in practice",
    "the sampling is done uniformly in the integrated distribution of @xmath122 , then solving analytically for @xmath76 . to calculate the equivalent - radiator thickness @xmath114",
    ", one needs the value of @xmath11 for the event , which one can only calculate after the complete process has taken place .",
    "however , due to the slow variation of @xmath123 , one gets a very good approximation by using the value of @xmath11 given by elastic electron - proton scattering at the nominal beam momentum @xmath124 and scattering angle @xmath125 .",
    "the simulation consists of three separate programs : vcssim , resolution and analysis .",
    "the first one , vcssim , generates @xmath8 events in the target , applying ionisation energy losses and multiple scattering to all charged particles and radiative effects to the electrons .",
    "the outgoing electron and proton are tracked up to the entrance of the spectrometers , where the collimator - acceptance cut is applied .",
    "this program produces two output files : one contains the generated events and the other one contains statistical information . the second program , resolution , applies the resolution effects of the spectrometers on the events generated by vcssim , producing a datafile with the events affected by the spectrometer resolution .",
    "the third program , analysis , analyses the output datafile from resolution in the same way experimental data are analysed and produces a third datafile . the latter contains a set of reconstructed variables to be compared to the experimental ones .",
    "the modular structure of the package has the advantage that one can change e.g. the spectrometer - resolution effects or the analysis , without having to redo the first step , which is the most time - consuming one .",
    "the three programs are described in more detail below .      using all necessary input parameters",
    ", the program first defines the phase space in which it is going to sample ( see section  [ sec : sim_phase_space ] ) . in order to obtain an event",
    "the following steps are taken : first the transverse beam position on the target is generated in a horizontal and vertical distribution similar to the experimental one .",
    "an interaction point along the beamline is chosen uniformly inside the target length .",
    "the incoming electron is subject to multiple scattering , energy loss by collision and external bremsstrahlung in the target wall and the liquid hydrogen till the reaction vertex .",
    "then the real internal radiation at the vcs vertex is simulated by an additional energy loss of the incoming electron using the equivalent - radiator approach discussed in section [ sec : gen_rad_tail ] .",
    "then the four - vector @xmath126 of the electron inducing the actual vcs process is obtained .",
    "the energy loss through radiation can be so large , that @xmath49 can already be too small to give any detectable electron in the final state . at this fixed value of @xmath49",
    ", the highest value of @xmath50 is given by the kinematics of the elastic process",
    "so at this point a test is made if the momentum of the elastically scattered electron is high enough to be accepted in the electron spectrometer .",
    "if the test is negative , the event is terminated , and a new event is generated starting all over again .",
    "if the test is positive , one generates a scattered electron in the labframe and an outgoing real photon direction in the cm frame .",
    "the variables @xmath128 , @xmath61 , @xmath129 , @xmath20 and @xmath50 are all sampled uniformly in their phase space .",
    "remark that the outgoing real photon energy is already determined by the electron kinematics .",
    "if the generated kinematics is physically possible , the cross section is calculated for this event by interpolation in the bh+b grid of section [ sec : cross_section_implementation ] . with this value for the cross section one",
    "samples a random number between zero and the envelope value .",
    "if the value is higher than the calculated cross section , the event did not pass the acceptance - rejection test and the event is terminated .    as a next step",
    ", one has to determine whether the scattered electron and outgoing proton enter the acceptances of the spectrometers .",
    "to this end , the momenta and directions of the electron and proton have to be calculated . based on the variables @xmath52 , @xmath61 and @xmath50",
    ", one can immediately calculate the four - vectors of the scattered electron and the virtual photon .",
    "then the momentum four - vector in the center of mass for the outgoing real photon can be calculated using @xmath19 and @xmath20 .",
    "the real photon is transformed to the lab to obtain the four - vector @xmath130 .",
    "the four - vector of the outgoing proton can now be calculated as @xmath131 .",
    "the scattered electron is first subject to real internal radiation energy loss .",
    "then it loses energy by collision and by external radiation and undergoes multiple scattering in the various materials from the vertex point to the entrance collimator of the spectrometer .",
    "similarly , the outgoing proton will undergo energy loss by collision and multiple scattering on its way to the collimator ( bremsstrahlung is negligible for such a heavy particle ) .",
    "several options are proposed to calculate the collisional energy loss of particles : the mean energy loss , the most probable energy loss , or a realistic energy - loss distribution ( landau distribution ) . for the calculation of the effective solid angle",
    "this last option was chosen .",
    "the spectrometer acceptance is defined in different ways depending on the experiment . in the case of the mami experiment",
    "the angular acceptance is defined by the collimators at the entrance of the spectrometers , in the case of the jlab experiment it is defined by cuts in a five - dimensional phase space .",
    "the output of the vcssim program is twofold : first a file is produced containing the events accepted by both spectrometers .",
    "one stores the kinematics at the vertex , the coordinates of the interaction point , and the momenta and angles of the particles at the spectrometer entrances .",
    "also a proton - spectrometer index is stored , since several proton - spectrometer settings can be defined and filled simultaneously in one simulation run . the second output file contains the simulated luminosity @xmath37 ( see section [ sec : integrated_luminosity ] ) and some statistical information regarding the simulation run .",
    "the second program , resolution , introduces the resolution effects of the spectrometers . in the experiment , for each particle seen in the set of two double vertical drift chambers ( vdcs ) the trajectory , measured in the focal plane , is traced back to the target using the spectrometer optics .",
    "this yields four independent variables at the target ( the momentum modulus , two projected angles and one position coordinate ) .",
    "the accuracy obtained on these target variables reflects the resolution of the apparatus .",
    "the program resolution starts from the initial target variables ( delivered by vcssim ) and modifies them by adding the errors .",
    "three options to realize this are discussed below .    as a first option",
    "one can simply make use of gaussian - distributed resolution effects on each target variable independently , ignoring error correlations . in this scheme",
    ", the difference between the initial target variable and the modified one is sampled in a gaussian distribution of fixed width .    in the experiment ,",
    "the resolution effects of the vdcs will cause correlations in the resolution effects on the reconstructed target variables due to the spectrometer optics .",
    "the second option reproduces these correlations .",
    "the consistency of the drift times with a straight line is used as estimate for the error on a track - by - track basis . in this way , also effects from multiple scattering within the chamber and from the used algorithm are effectively included @xcite . after adding quadratically the contribution of multiple scattering in the spectrometer exit window , one obtains the total error on the detector coordinates , which is propagated through the known spectrometer optics to yield the error on the target variables . from the experimental data",
    "one can fill a four - dimensional histogram for each spectrometer , where each dimension corresponds to the error on a given target variable . in this way",
    "one keeps track of error correlations ( signs excluded ) between the four target variables .",
    "the binning is chosen with equal width on the logarithm of the errors , which describes the distribution very precisely around the most probable value and sufficiently precisely in the long tails of the distribution , extending over four orders of magnitude , relatively to the width of the central peak .",
    "for each event the simulation samples in the four - dimensional histogram , yielding the width of the gaussian error distribution on each target variable .",
    "then one samples for this event in the obtained gaussian distributions and one gets the modified target variables .",
    "this method has been applied in the analysis of the mami vcs experiment .    as a third option",
    ", one can implement the resolution effects in the simulation directly at the detector level . in this scheme ,",
    "the accepted particle is transported to the focal plane of the spectrometer , where two types of errors are generated : 1 ) multiple scattering through the various materials , 2 ) the global resolution of the drift chambers ( as deduced from experimental studies ) . for each particle ,",
    "two tracks are considered : one with and one without these focal plane resolution effects . as in the second option",
    ", one uses the full spectrometer optics to transport the tracks back to the target . now",
    "the quantity of interest is just the difference between the two tracks for the same particle .",
    "this difference represents the resolution effects on the target variables .",
    "since one uses the difference between the two tracks , one can approximate the optical transport from target to focal plane : it does not need to be the exact reverse of the optical transport from focal plane to target .",
    "the method generates error correlations at the target , signs included .",
    "large resolution tails are introduced at the level of the detector coordinates , e.g. by sampling in the sum of two gaussian distributions with very different widths for the drift chamber resolution .",
    "this method has been applied in the analysis of the jlab vcs experiment .",
    "the output is a datafile containing the same variables as the one from vcssim , but now they include also the spectrometers resolution effects .",
    "this datafile is comparable to the experimental one .",
    "the third and final part of the simulation , the analysis program , performs the full event reconstruction as in the analysis of the experimental data . from the reconstructed target coordinates , one first calculates the vertex point and from this the pathlengths of the particles in target materials and the corresponding ( mean collisional ) energy losses .",
    "the particle momenta are corrected for these energy losses , yielding the four - vectors at the vertex point .",
    "then the complete reaction kinematics is reconstructed , including the missing particle .",
    "then one can compare e.g. the distribution in missing mass squared @xmath71 to the experimental one , as shown on figure  [ fig : mx2_exp_sim ] .",
    "as it is clear from equation one needs to know the simulated luminosity in order to obtain the effective solid angle . in the experiment ,",
    "the luminosity , @xmath26 , is obtained as the product of the number of incoming electrons and the target thickness and is totally independent of the reaction under study .",
    "the simulation uses a different approach : the luminosity in the simulation , @xmath37 , is calculated from the cross - section samples of the acceptance - rejection method , i.e. from the reaction itself .",
    "the method is most efficient and gives a very accurate result , provided the procedure is established carefully .",
    "one counts the number of samples , @xmath0 , generated during a simulation run in the luminosity phase space , l.p.s .",
    ", which is a sub - part of the total simulation phase space ( see section  [ sec : sim_phase_space ] ) .",
    "simultaneously , the cross section is integrated over this luminosity phase space .",
    "according to equation @xmath37 is then simply given by @xmath132 as such , @xmath37 is actually calculated in a reverse way , i.e. at the end of a simulation run , once the number of generated events is known .    in principle one",
    "is free to define the size of the luminosity phase space .",
    "however one will have to choose a luminosity phase space that is smaller than the simulation phase space .",
    "the first complication is due to the method used to implement the cross - section behaviour . as mentioned in section [ sec : cross_section_implementation ] , the acceptance - rejection method with constant envelope is used , with a rejection level of about 90% . however , among these rejected samples a large fraction can be kept to calculate the value of the cross - section integral over the luminosity phase space .",
    "one just has to make sure that the luminosity phase space does not overlap with the regions of the simulation phase space where the cross section is larger than the envelope , since the acceptance - rejection method does not work in these regions .",
    "the second complication is connected to the fact that the real @xmath49 distribution has a low - momentum tail and to the fact that the cross section depends on the value of @xmath49 .",
    "if all vcs inducing electrons would have the same momentum @xmath49 , one could immediately apply equation .",
    "this case is explained in subsection [ sec : integration_phase_space ] .",
    "the case of the real @xmath49 distribution , for which one can not apply equation directly , is discussed in subsection [ sec : incoming_momentum ] .",
    "if all interacting electrons would have the same momentum , @xmath124 ( the nominal beam momentum ) , the cross - section integral of equation would be given by @xmath133 one has to define the luminosity phase space as an integration range in @xmath134 , @xmath135 and @xmath136 : this is done using a 5-dimensional box in @xmath137  @xmath138  @xmath139  @xmath140  @xmath141 , where the limits on each variable are independent of the other variables .",
    "for example , for the mami experiment the box has the following dimensions :    * in @xmath142 : @xmath19 varies from 0 to @xmath143 and @xmath20 varies from about 0.8 to 5.48 radians .",
    "this region is chosen in order to stay away from the steep cross - section rise in the region of the bh+b peaks around @xmath144 ( see figure  [ evol ] ) . * in @xmath145 : one uses the complete solid angle in which the electron directions are sampled . * in @xmath65 : for the minimum of @xmath50 , the lower limit of the electron spectrometer acceptance , @xmath146 , is used . for the maximum of the @xmath50-integration range one has to be careful not to cross the envelope value with the cross - section values in the regions in @xmath142 and in @xmath145 defined above .",
    "indeed , as @xmath50 increases at fixed @xmath124 , one approaches the elastic kinematics and as such the cross section rises . to stay far enough away from the elastic kinematics , the maximum value of @xmath50 for the integration range is taken equal to @xmath147 .",
    "the quantity @xmath148 is the minimum momentum an elastically scattered electron can have in @xmath145 , for an incoming electron momentum @xmath124 .",
    "this is illustrated on figure  [ fig : lumips ] .     and",
    "@xmath52 for the case of constant @xmath49 . the l.p.s . is the shaded rectangle , upper - bounded by @xmath149 as explained in the text .",
    "the range in @xmath52 is defined by the acceptance of the spectrometer .",
    "the solid line is the @xmath150 elastic line at the incoming energy @xmath49 .",
    ", width=321 ]      due to energy losses the electron momentum at the vertex point becomes distributed as shown in figure  [ fig : beam_momentum ] . in this realistic case",
    "one could divide this distribution in small bins in @xmath49 and apply equation to calculate the partial luminosity for each bin @xmath151 @xmath152 where @xmath153 is given by expression and @xmath154 is the number of accepted samples , both evaluated in a luminosity phase space similar to the one of section [ sec : integration_phase_space ] , where the range in @xmath49 is limited to the bin @xmath151",
    ". then @xmath37 would be equal to @xmath155 .",
    "there are two limitations to this procedure :    1 .",
    "it is not possible to use formula on the whole incoming electron momentum distribution , because the cross - section grid does not contain cross - section samples for the entire 0 @xmath156 @xmath124 incoming momentum range .",
    "one has to cut somewhere in the @xmath49-range , hereby defining a cut value @xmath157 .",
    "2 .   for small values of @xmath49 ,",
    "the elastic line drawn on figure  [ fig : lumips ] lies totally below the lower bound of the electron - momentum acceptance @xmath146 , therefore @xmath158 lies below @xmath146 and the luminosity phase space can not be defined as in section  [ sec : integration_phase_space ] for these electrons .    to solve these problems",
    "the cross - section integration will be performed in a limited range of incoming electron momentum , i.e. a bin in @xmath49 for which the l.p.s .",
    "can be defined as in section [ sec : integration_phase_space ] .",
    "this will yield a partial luminosity .",
    "the total luminosity will then be obtained by a simple renormalization procedure .",
    "quite obviously , the cross section integration of equation should be performed for the incoming electron momenta that are closest to the beam momentum @xmath124 .",
    "therefore one defines a range of the type [ @xmath159 .",
    "the luminosity phase space is then defined as in section [ sec : integration_phase_space ] .",
    "the value of @xmath158 is calculated using the elastic line at the lowest incoming momentum of the bin , i.e. at @xmath160 .    of course , when one lowers the value of @xmath157 , one reduces the size of the luminosity phase space ( due to the choice of @xmath158 ) , and the statistical error on the luminosity increases .",
    "so one should keep @xmath157 close enough to @xmath124 .",
    "for example for the mami experiment the range [ @xmath161 mev / c , @xmath124 ] was chosen .",
    "it contains about 80% of all incoming electrons , and yields a statistical error on @xmath37 well below 1 % .    during execution the number of samples in the luminosity phase space , @xmath163 ,",
    "is counted and the integral over the cross section in the l.p.s . , @xmath164 , is calculated .",
    "@xmath163 is the number of samples accepted by the acceptance - rejection method of section  [ sec : cross_section_implementation ] . at the end of execution ,",
    "the partial luminosity @xmath165 is given by @xmath166 .      by the method described above we know",
    "the luminosity @xmath165 corresponding to a fraction , @xmath167 , of all incoming electrons , which have a momentum higher than @xmath161 mev / c .",
    "this fraction @xmath167 is easily calculated in the simulation : one counts the total number of @xmath49-values that have been generated , @xmath168 , and the number of values that have been generated above the threshold of @xmath161 mev / c , @xmath169 . at the end",
    "one has @xmath170 .",
    "however , one needs to know the total luminosity @xmath37 according to all incoming electrons . one can obtain the right value by correcting for the electrons one did not count in the calculation of @xmath165 .",
    "since the luminosity is independent of the reaction under study , the total luminosity @xmath37 is obtained by dividing @xmath165 by @xmath167 .",
    "the data in the output file from the analysis program , in combination with simulated luminosity @xmath37 from the vcssim program are used to calculate the effective solid angle for any given bin in the phase space , applying equation  : @xmath171 where @xmath172 is now the differential cross section for the @xmath8 reaction , used in the simulation and @xmath45 the number of counts in the bin .",
    "@xmath173 is similar as in equation or , with now the specific dimension of ( sr@xmath174 mev / c ) , as can be deduced from equation  [ eq : solid_angles ] . by applying energy losses for radiative effects in the simulation , a part of the radiative correction",
    "is automatically taken into account in @xmath173 . if the cross section is taken to be a constant value over the complete phase space , equation will yield @xmath30 . calculating the cross section from the data using this @xmath30 yields the experimental cross section averaged over the bin .",
    "on the other hand , if the simulation has been performed using the bh+b cross section , the quantity @xmath172 in equation equals the bh+b cross - section value at a given phase - space point , which can be chosen anywhere , preferentially in the bin",
    ". this procedure will give rise to @xmath36 , comparable to equation .",
    "applying this @xmath36 to the measured data will result in the actual cross - section value at a given phase - space point . in order to get a precise result ,",
    "the cross section in the simulation must have a behaviour very close to the true cross - section shape .    if necessary",
    ", one can even use an iteration procedure to improve the value of @xmath31 by implementing in the simulation a cross section of the type bh+b plus a polarizability effect .",
    "this procedure was tested for the two experiments . in the case of mami ,",
    "the relative change of @xmath46 was smaller than 1 % , hence the iterations had a negligible effect on the physics observables ( the gps ) . in the case of jlab , the relative change of @xmath46 was larger , typically a few percent , translating into significant changes of the physics observables : after the first ( resp .",
    "second ) iteration , the gps reached @xmath175 70 % ( resp .",
    "90 % ) of their convergence value .",
    "the full convergence was obtained after the third iteration .",
    "as an example , figure  [ fig : omega12 ] shows the obtained effective solid angles at @xmath56 = 45 mev / c ( @xmath59 and @xmath57 mev / c ) .",
    "the phase space is defined by 40  mev / c @xmath176 mev / c , @xmath177 .",
    "the statistical error on the effective solid angle in the plateau region is about 1% .",
    "@xmath36 is the solid angle obtained by generating the events according to the bh+b cross section .",
    "a simulation with a constant cross section gives @xmath30 .",
    "it turns out that for this setting the difference between @xmath30 and @xmath36 is up to the order of 10% .",
    "it is also interesting to run the simulation without radiative effects , which results in @xmath178 .",
    "the right panel of figure  [ fig : omega12 ] shows clearly that radiative effects have to be included in the simulation , since there is no common scaling factor between @xmath36 and @xmath178 for the complete phase space .",
    "( @xmath179 , @xmath57 mev / c , @xmath58 mev / c and @xmath59 ) .",
    "@xmath30 is obtained by running the simulation with a flat cross section , for @xmath36 the bh+b cross section is used .",
    "@xmath178 is the same quantity as @xmath36 , but for a simulation without radiative effects .",
    "the purely statistical errors are smaller than the size of the symbols.,title=\"fig:\",width=245 ]   ( @xmath179 , @xmath57 mev / c , @xmath58 mev / c and @xmath59 ) .",
    "@xmath30 is obtained by running the simulation with a flat cross section , for @xmath36 the bh+b cross section is used .",
    "@xmath178 is the same quantity as @xmath36 , but for a simulation without radiative effects .",
    "the purely statistical errors are smaller than the size of the symbols.,title=\"fig:\",width=245 ]",
    "the monte carlo simulation described in this paper has been developed for the analysis of the vcs experiment at mami and has been adapted afterwards for the analysis of the vcs experiment at jlab .",
    "it has been used to generate realistic observable spectra , which can be compared with the measured ones , and to determine accurately effective solid angles which also account for the radiative processes accompanying the vcs reaction .",
    "the use of a five - dimensional cross - section grid covering the complete simulation phase space allows to generate events according to the bethe - heitler+born cross section at a very acceptable rate , using the acceptance - rejection method with a constant envelope .",
    "external and internal radiation of real photons are implemented in a well - founded way by generating realistic radiative tails and convoluting these effects with the acceptance of the detection system .",
    "the simulation described above is flexible .",
    "all resolution deteriorating effects can independently be switched on or off and it is possible to use a constant cross section or the bh+b cross section to generate events . due to the multiple proton - spectrometer option the yield in several proton - arm settings for one electron - spectrometer setting can be simulated in one run , while the modularity of the code gives the possibility to study spectrometer - resolution effects in an efficient way .",
    "finally , the program is general enough to allow adaptation to many other processes , including e.g. elastic scattering and pion electroproduction .",
    "this work was supported in part by the fwo - flanders ( belgium ) , the bof - ghent university , the french cea and cnrs / in2p3 , the deutsche forschungsgemeinschaft ( sfb 201 and sfb 443 ) and by the federal state of rhineland - palatinate , the u.s .",
    "doe and nsf ."
  ],
  "abstract_text": [
    "<S> this paper describes the monte carlo simulation developed specifically for the vcs experiments below pion threshold that have been performed at mami and jlab . </S>",
    "<S> this simulation generates events according to the ( bethe - heitler + born ) cross - section behaviour and takes into account all relevant resolution - deteriorating effects . </S>",
    "<S> it determines the `` effective '' solid angle for the various experimental settings which are used for the precise determination of the photon electroproduction absolute cross section .    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    ,    , </S>"
  ]
}