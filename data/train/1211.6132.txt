{
  "article_text": [
    "we consider a region , @xmath0 , in @xmath1 with a smooth boundary @xmath2 .",
    "we assume that there is a riemannian metric , @xmath3 , on @xmath0 that is conformal to the euclidean metric with conformal factor @xmath6 where @xmath7 is strictly positive .",
    "this means that @xmath8 , where @xmath9 is the euclidean metric , or , in cartesian coordinates @xmath10 , @xmath11 .",
    "we analyze the inverse problem of reconstructing @xmath3 based on measurements of the curvature of wavefronts produced by point diffractors located inside @xmath0 and propagated according to the wave operator on @xmath12 .",
    "indeed , geodesics for the metric @xmath3 are rays following the propagation of singularities by a parametrix corresponding to this wave operator . in the seismic context",
    "@xmath13 is the wave speed .",
    "as originally formulated by dix @xcite , this type of data may in some cases be reconstructed from reflection data by variation of source and receiver locations at the surface of the earth .",
    "in particular , it is possible to recover from reflection data the shape operator for the wave front produced by a given point diffractor where the rays beginning at the diffractor intersect @xmath2 orthogonally @xcite .",
    "dix developed a procedure , with a formula , for reconstructing one - dimensional wave speed profiles in a half space from reflection data . since dix various adaptations have been considered to admit more general wave speed functions in a half space .",
    "we mention the work of shah @xcite , hubral & krey @xcite , dubose , jr .",
    "@xcite , and mann @xcite .",
    "we consider here the case of higher dimensional regions with riemannian metrics conformal to the euclidean metric .",
    "our method is different in the cases of @xmath5 and @xmath14 and in fact we expect better results in the case @xmath14 .",
    "the problem is closely related to the problem where broken geodesics are observed on the boundary @xcite or when the cauchy data of the solution of the wave equations are observed on the boundary , see e.g. @xcite and references therein .    assuming that we know @xmath13 and all of its derivatives on @xmath2 ( c.f .",
    "@xcite ) , we may extend @xmath13 to a function , which we will also denote by @xmath13 , on a complete manifold @xmath15 compactly containing @xmath0 ( in fact we can take @xmath16 ) .",
    "the corresponding extended metric is also denoted simply be @xmath3 . as described in detail below , we measure the curvature of generalized spheres for @xmath3 centered at `` diffraction '' points intersected with an open subset of @xmath17 . from these data , and assuming we know @xmath13 in @xmath18 , we show an explicit method to determine the function @xmath13 in the cartesian coordinates @xmath10 along geodesics of @xmath3 which connect the diffractions points to the measurement region .",
    "this method can be viewed as a generalization of the work of iversen and tygel @xcite .",
    "we now proceed to introduce the concepts and notations necessary for the statement of our main results .    for any @xmath19 ( @xmath20 indicates the unit sphere bundle with respect to @xmath3 ) we will write @xmath21 for the geodesic with initial data @xmath22 , @xmath23 . for @xmath24 in the domain of @xmath21",
    "we let @xmath25 denote the set of times @xmath26 such that @xmath26 is conjugate to @xmath24 along @xmath21 ( by this we mean that @xmath27 is a critical point for @xmath28 ) .    for the moment we fix @xmath29 and use the notation @xmath30 for @xmath31 .",
    "we will refer to the image of the set @xmath32 under the exponential map as the _ generalized sphere of radius @xmath33 centered at @xmath34_. when @xmath35 is in the domain of @xmath36 and @xmath37 there is a small portion of the generalized sphere of radius @xmath38 centered at @xmath39 containing @xmath40 that is an embedded submanifold @xmath41 of @xmath15 .",
    "indeed , in this case we can define a vector field @xmath42 in a neighborhood of @xmath40 by writing for @xmath43 in a small neighborhood of @xmath44 : @xmath45 geometrically , @xmath42 gives the outward pointing normal vector fields to a part of the generalized sphere centered at @xmath46 near @xmath40 .",
    "the shape operator @xmath47 of @xmath41 at @xmath40 is then given by @xmath48 for all @xmath49 , where @xmath50 is the levi - civita connection for @xmath3 .",
    "for the reconstruction of @xmath13 we assume that @xmath51 is known for all @xmath52 such that @xmath53 . in reflection",
    "seismology one refers to @xmath41 as the ( partial ) front of a point diffractor located at @xmath54 .",
    "[ notfig ]    we now introduce a mapping which defines local coordinates in which we will perform our initial calculations .",
    "we begin with picking a large @xmath55 in the domain of @xmath36 such that @xmath56 .",
    "next , let us take local coordinates @xmath57 on @xmath58 such that @xmath59 defines @xmath60 and suppose @xmath61 is the coordinate map .",
    "we will assume that the image of these maps , @xmath62 , is the same for all @xmath63 .",
    "for @xmath64 , let @xmath65 be the geodesic with a special choice of initial data : @xmath66 .",
    "then we define coordinates , @xmath67 , on some set by the inverse of the map @xmath68 we define @xmath69 and so that the map @xmath70 defines a local parametrization on @xmath71 .",
    "it may not be a global parametrization because it may not be injective .",
    "the @xmath67 local coordinates on @xmath71 , basically , are riemannian normal coordinates centered at @xmath72 , but parametrized in a particular way : @xmath73 can be thought of as a parametrization of part of the sphere of radius @xmath63 in @xmath74 , and then @xmath24 corresponds to the radial variable in @xmath74 .",
    "figure [ wfig ] shows a possible depiction of @xmath71 and the coordinates defined there .",
    "we note that the domain @xmath71 includes @xmath75 .",
    "we also define for some @xmath76 @xmath77 in our reconstruction we cover @xmath0 by sets like @xmath71 , and then recover @xmath13 on each of these regions separately . in the case that there are conjugate points to @xmath63 along @xmath36 we will also have to cover some regions with more than one such set . note",
    "that along @xmath36 the coordinate vectors @xmath78 are jacobi fields , and are defined even at the conjugate points .",
    "finally , we introduce frames @xmath79 defined by parallel translation along @xmath80 such that for @xmath81 @xmath82 where we are using the notation @xmath83 and so @xmath84 points in the opposite direction of @xmath85 . to simplify the presentation",
    "we adopt this notation , @xmath83 , throughout the paper .",
    "also we write @xmath86 for the corresponding dual frame ; that is @xmath87 where @xmath88 denotes the usual pairing of @xmath89 and @xmath90 .",
    "[ fig : coord ]    in the sequel will also consider the shape operators @xmath91 when @xmath60 is replaced in the above construction by another point in @xmath58 represented in the coordinates by @xmath73 .",
    "we thus have for each @xmath73 and @xmath92 such that @xmath24 and @xmath26 are not conjugate along @xmath80 a tensor @xmath93 .",
    "we represent @xmath94 using the frames constructed above as @xmath95 for fixed @xmath63 and @xmath73 we will also use the notation @xmath96 .",
    "note that immediately from the definition we have @xmath97 for all @xmath98 and because of this in what follows when we write @xmath99 ( respectively @xmath100 ) without indices we will actually be referring to the @xmath101 matrix @xmath102 ( respectively @xmath103 ) with @xmath98 , @xmath104 .",
    "the data for our recovery are the matrix elements @xmath105 , and their first three derivatives with respect to @xmath26 , for @xmath106 and @xmath26 not conjugate to @xmath107 along @xmath80 .    in  @xcite",
    ", we obtain the following result : it is possible to uniquely determine the riemannian metric @xmath3 in a neighborhood of @xmath108 in riemannian normal coordinates having origin at the point @xmath72 ( this can be done for general metrics , not just ones which are conformally euclidean ) . here",
    ", we cast this result into an algorithm , and construct a conversion from the mentioned coordinates to cartesian coordinates , which is the main contribution of this paper .",
    "essentially , we generalize the time - to - depth conversion in dix original method to multi - dimensional manifolds with riemannian metrics conformal to the euclidean metric and , roughly speaking , show that if we measure near the point @xmath60 the shape operators of the wave fronts of waves diffracted from the points @xmath109 , we can then determine the wave speed @xmath13 near the geodesic @xmath36 .",
    "the theoretical contributions of this work are thus contained in the following two theorems .",
    "[ thm1 ] suppose that @xmath110 and @xmath111 is open and nonempty , @xmath112 , @xmath113 is a set of the form constructed above ( see ( [ wdef ] ) ) using the metric @xmath114 , and @xmath115 for all @xmath116 .",
    "we also assume that @xmath117 is complete .",
    "if @xmath118 is known then from the data @xmath119 ( see ( [ shape_coord ] ) ) for all @xmath63 in an open subinterval of @xmath120 , @xmath64 , and @xmath121 it is possible to recover @xmath13 in a neighborhood of @xmath122 in cartesian coordinates . in dimension",
    "strictly larger than @xmath123 the reconstruction only involves solving ordinary differential equations along the rays of @xmath3 .",
    "note that the sets @xmath25 are always discrete , and so the hypotheses of the theorem assume we have data except for at a discrete set of times .",
    "we also stress here that the reconstruction is local along geodesics .",
    "that is , to reconstruct @xmath13 in a neighborhood of @xmath36 we only require measurements of the shape operator near the point @xmath60 for generalized spheres @xmath58 centered at points @xmath109 with radii @xmath124 .",
    "we recall @xmath125 is representation of the shape operator of these generalized spheres in the local coordinates and that we have @xmath126 . in the case",
    "that the dimension @xmath4 the conversion from riemannian normal to cartesian coordinates involves solving a system of @xmath127 nonlinear ordinary differential equations . in the two dimensional case",
    "the construction requires the solution of a cauchy problem for an elliptic operator ( i.e. we must solve the scalar curvature equation ( [ scal ] ) with known boundary data ) .",
    "the discretization of the system is directly related to the available `` density '' of scatterers .    in order to state our second result",
    ", we must introduce generalized distance functions . as @xmath128 is complete ,",
    "the map @xmath129 is surjective , and by sard s theorem , the set @xmath130 of critical values of @xmath131 has measure zero .",
    "suppose @xmath132 and let @xmath133 be such that @xmath134 .",
    "then @xmath135 has a neighborhood @xmath136 such that @xmath137 is a diffeomorphism ; one says that @xmath138 is a local inverse of @xmath131 corresponding to @xmath135 . in @xmath139 , we define the function , @xmath140 , by @xmath141 and call this function the generalized distance or travel time function from the point @xmath34 associated to direction @xmath135 ; the wave fronts observed from a point source at @xmath34 give us its level sets .",
    "we may now state our second theorem .",
    "[ thm2 ] let @xmath0 and @xmath142 be as in theorem  [ thm1 ] and suppose that @xmath2 is smooth and @xmath143 is an open set such that for all @xmath144 there is a non - normalized geodesic @xmath145 for @xmath3 such that @xmath146 ) \\subset w'$ ] , @xmath147 , @xmath148 and @xmath149 .",
    "we use the notation @xmath150 , and also assume that @xmath151 is known .",
    "further suppose that @xmath152 is an indexing set such that there is a bijective map from @xmath152 to @xmath153 and label @xmath154 according to this map .",
    "then from knowledge of @xmath155 for @xmath156 we can recover the wave speed @xmath13 in @xmath157 .",
    "this generalizes an earlier result which says that the boundary distance functions of a compact riemmanian manifold given on the whole boundary determine the manifold uniquely , see @xcite and ( * ? ? ?",
    "* section 3.8 ) .",
    "the structure of the rest of the paper is as follows . in section  [ sec : prelim ]",
    "we go over some background from riemannian geometry that is necessary .",
    "section  [ step1 ] reviews the first step of the recovery procedure in which we reconstruct the metric @xmath3 in the coordinates @xmath67 given by the map @xmath70 .",
    "then sections  [ step2 ] and  [ 2d ] describe the second step of the recovery procedure in which the geodesics and wave speed are reconstructed in cartesian coordinates respectively in the case of three and higher dimensions and the case of two dimensions . finally , the proofs of theorems  [ thm1 ] and  [ thm2 ] are given in section  [ sec : proofs ] , and section  [ sec : conc ] contains some concluding remarks .",
    "we also provide detail on the conversion from travel time measurements to measurements of the shape operator of generalized spheres for the case when @xmath2 is flat and @xmath13 is constant in a neighborhood of @xmath2 in  [ appenda ] .",
    "we summarize the basic differential equations from riemannian geometry that we will use .",
    "we mention some general references to riemannian geometry @xcite . in this work",
    "we will use the conventions from @xcite for the curvature tensor and related quantities in local coordinates .",
    "we evaluate the geodesics by solving @xmath158 where @xmath159 are the christoffel symbols .",
    "it is also possible to find the solutions of ( [ gamma ] ) using the hamiltonian flow for the hamiltonian @xmath160 .",
    "although we will not use the hamiltonian formulation here , we note that it gives the system @xmath161 for the geodesics . from this , we see that , in terms of seismic ray tracing , the geodesics may be identified with generalized image rays .    in our case , assuming isotropy ( i.e. that the metric is conformally euclidean ) , we have @xmath162 it is more convenient to work with @xmath163 than @xmath13 and we will generally do so throughout the remainder of the paper although it is clear that recovery of @xmath163 is equivalent to recovery of @xmath13 . to make the notation more concise below we introduce the shorthand @xmath164      as mentioned above , @xmath165 denotes the parallel translation of @xmath166 along @xmath167 from @xmath107 to @xmath24 .",
    "thus , for every @xmath168 and @xmath169 , @xmath170 forms a basis for @xmath171 .",
    "the invariant formula for parallel translation is @xmath172 if we introduce matrices which give the frames @xmath173 in cartesian coordinates @xmath174 then the invariant formula implies that these satisfy @xmath175 or @xmath176 and since the coordinates @xmath73 on @xmath58 are known , we also know the initial conditions , @xmath177",
    ".      the riemannian curvature tensor in any coordinate system is given as a @xmath178 tensor field by @xmath179 or as a @xmath180 tensor field as @xmath181 the ricci curvature tensor is given by the trace @xmath182 and the scalar curvature is @xmath183 . in the cartesian coordinates the riemmanian and ricci curvature tensors are given respectively by the following formulae in terms of @xmath163 : @xmath184 where @xmath185 is the kulkarni - nomizu product ( in coordinates , see @xcite for the invariant formula ) , @xmath186 is the hessian matrix of second derivatives , @xmath187 is the ( euclidean ) gradient , and @xmath188 is the euclidean norm of @xmath187 ; @xmath189 also , when the dimension is @xmath5 the scalar curvature satisfies the so - called scalar curvature equation @xmath190 where @xmath191 is the laplace - beltrami operator corresponding to @xmath3 given in any coordinate system @xmath192 by @xmath193 here @xmath194_{j , k=1}^2 ) $ ] and @xmath195_{j , k=1}^2 $ ] is the inverse matrix of @xmath196_{j , k=1}^2 $ ] . from these formulae we see a fundamental difference between the two dimensional case and the case of three or more dimensions . in two dimensions",
    "the ricci curvature and scalar curvature give only the laplacian of @xmath163 , and so to find @xmath163 from these curvature tensors would require the solution of an elliptic equation .",
    "on the other hand , in three or more dimensions the ricci curvature tensor depends on all the second partial derivatives of @xmath163 , and in general we can recover a formula for @xmath186 in terms of the ricci curvature and @xmath187 .",
    "indeed , if we define @xmath197 then from ( [ ric0 ] ) we may calculate @xmath198 this is possible in three dimensions , but not in two dimensions , and is the reason we must consider the two cases separately .",
    "we will also write the riemannian curvature on the geodesic @xmath167 in the frame obtained by parallel transport as @xmath199 or @xmath200 recalling that @xmath201 , we also write @xmath202 and for fixed @xmath63 @xmath203 for the directional curvature operator which we reconstruct in the first step of our procedure .",
    "note that as with @xmath204 , for any @xmath98 @xmath205 , and so when we write @xmath206 without indices we will actually be referring to the corresponding @xmath207 matrix .",
    "we continue in the next sections to describe the actual reconstruction algorithm .",
    "the reconstruction procedure consists of two steps . in the first step",
    "we consider only the single geodesic @xmath36 and reconstruct @xmath208 , and then the metric @xmath3 as a function of @xmath24 for @xmath209 . in the second step ,",
    "we determine @xmath163 , and therefore also @xmath13 , in a neighborhood of @xmath36 by also varying @xmath73 and @xmath63 .    following the geometric analysis of",
    "@xcite we now describe the first step of the procedure which is itself broken up into a number of substeps below .    1 .",
    "let @xmath210 , @xmath211 represent @xmath207 matrices .",
    "we solve the autonomous system of ordinary differential equations for @xmath212 , @xmath213 in which @xmath214 for @xmath215 .",
    "this system is supplemented with initial data , @xmath216 applying picard s theorem in a standard way , we see that the equations ( 12)-(13 ) have unique solution on some interval @xmath217 $ ] ( for details on this see  @xcite ) . in practice , we may use a runge - kutta method to solve the system numerically for @xmath218 .",
    "the system will not generally have a solution all the way up to @xmath63 ; in this case , we must divide the interval @xmath219 $ ] into several subintervals , and reconstruct on each of these in turn as described below in substep 3",
    "we extract the directional curvature operator , @xmath220 note that this matrix @xmath221 is @xmath207 , but recall that from this we can recover the full directional curvature operator @xmath222 since the @xmath223th row and column of @xmath222 are both equal to zero .",
    "[ step1fig ]   on line 1 .",
    "then substep 1 recovers @xmath224 in region 1 by solving ( [ eq a ] ) .",
    "next substep 2 gives @xmath221 for @xmath225 by ( [ eq ainit ] ) , and then substep 3 gives @xmath204 on line 2 .",
    "returning to substep 1 again gives @xmath224 in region 2 .",
    "then as before substep 2 gives @xmath221 for @xmath226 , and substep 3 gives @xmath204 on line 3 .",
    "continuing in this way we reconstruct @xmath206 as far along @xmath36 as we like.,title=\"fig : \" ] + in general the first two steps only reconstruct @xmath227 for @xmath225 where @xmath228 since we may not able to solve ( [ eq a ] ) all the way up to @xmath63 . here",
    ", we describe how to find @xmath227 for @xmath24 in the entire interval @xmath219 $ ] .",
    "the idea is to replace @xmath107 by @xmath229 , and then use knowledge of @xmath230 for @xmath231 .",
    "indeed , let us fix @xmath232 .",
    "now we find the coordinates of the jacobi fields corresponding to the coordinate vectors fields of @xmath67 along @xmath36 with respect to the parallel frame .",
    "these can be found by solving the system @xmath233 with initial conditions @xmath234 we can then recover @xmath235 by the equation @xmath236 now we may return to substep 1 and solve ( [ eq a ] ) with ( [ final init .",
    "data ] ) replaced by @xmath237 this then allows us to use ( [ eq ainit ] ) to recover @xmath221 for @xmath24 up another time @xmath238 say with @xmath239 . if @xmath238 is less than @xmath63 we repeat this same procedure again with @xmath229 replaced by @xmath238 , and so on .",
    "by results in  @xcite there is a lower bound on the size of each step we take ( i.e. a lower bound on @xmath240 ) , and so by induction we eventually recover @xmath227 for @xmath24 on the entire interval @xmath219 $ ] . for a visual depiction of how the first three substeps proceed see figure  [ step1fig ] .",
    "we now obtain the metric in the @xmath67 coordinates given by the coordinate map @xmath70 along @xmath36 , which we write as @xmath241 , by the formula @xmath242 where @xmath243 we assume in the hypotheses of theorem  [ thm1 ] that @xmath244 is known , and @xmath245 ( resp .",
    "@xmath246 ) are the components of the coordinate vector @xmath247 ( resp .",
    "@xmath248 ) with respect to cartesian coordinates . thus @xmath249 is known . by adjusting the choice of @xmath60 we also find the metric with respect to the @xmath67 coordinates where they are defined ( i.e. on all of @xmath71 ) .",
    "by the procedure described in the previous section we can reconstruct the metric @xmath250 in the coordinates @xmath67 everywhere in the domain @xmath71 where those coordinates are defined . thus we can also reconstruct the ricci curvature tensor in these coordinates and also the scalar curvature , which we will use below . in this section ,",
    "we show how to determine the velocity function @xmath251 and the geodesics @xmath252 in the cartesian coordinates from this information .",
    "the reconstruction is done initially up to the first conjugate point to @xmath63 along @xmath36 .",
    "then , as described at the end of this section , @xmath63 must be changed to allow reconstruction past this conjugate point .    as observed above , the coordinate vectors in the @xmath67 coordinates are jacobi fields along @xmath80 ; in particular , if @xmath253 ( recall that @xmath254 are the coordinate vectors for the euclidean coordinates ) then the matrix @xmath255 satisfies @xmath256 supplemented with the initial data @xmath257 in fact , here we are simply adding the dependence on @xmath73 and @xmath63 to the same quantities already considered in the previous section . since parallel",
    "translation preserves the metric , we also have the relation @xmath258 by taking determinants of the matrices on each side and then the natural log , we obtain the following formula @xmath259 recall that @xmath260 are the components of the parallel frame with respect to the cartesian coordinate vectors ( cf .",
    "( [ fdef ] ) ) .",
    "also , combining some of the previous formulas we have @xmath261 away from conjugate points along @xmath167 , we may invert to obtain @xmath262 which may further be combined with ( [ vrel ] ) to show @xmath263 where we use the notation @xmath264    [ rem ] a  stepping \" recovery procedure in the spirit of dix original method may now be presented .",
    "we introduce a step size @xmath265 in @xmath24 , and for @xmath266 we label @xmath267 .",
    "if we know @xmath268 , @xmath269 , and @xmath270 , then we approximate the same quantities at @xmath271 by the following strategy .",
    "first we numerically estimate the derivatives @xmath272 then we use ( [ coc ] ) to estimate the derivatives @xmath273 we then have an estimate of @xmath274 .",
    "next , we use this estimate to perform a forward euler step in ( [ eq : fpartr ] ) and get an approximation of @xmath275 . then , finally , we use ( [ vrel ] ) to obtain the approximation for @xmath276 .",
    "we note that @xmath277 may be obtained through a completely independent calculation using ( [ jacobisys ] ) . because @xmath278 , we can then approximate @xmath279 as well .      while the technique described in remark  [ rem ] may be a direct generalization of dix method , in fact we seek a single closed system of ordinary differential equations that could be solved using any numerical scheme to give all the desired quantities .",
    "this is possible , although the method we present here works in three or more dimensions only .",
    "the reason for this limitation , as explained above , comes from our use of formulas ( [ ric ] ) and ( [ ric2 ] ) to express the hessian of @xmath163 in terms of the ricci curvature and the first order derivatives of @xmath163 in cartesian coordinates .",
    "since we actually know the ricci curvature in @xmath67 coordinates given by @xmath70 , which we will label as @xmath281 , we also need the formula for the tensorial change @xmath282 now we can describe how to get the closed system of ordinary differential equations .",
    "we differentiate ( [ eq : fpartr ] ) and use ( [ coc1 ] ) to get @xmath283 where we have suppressed the dependence on @xmath284",
    ". we may use ( [ ric ] ) , ( [ ric2 ] ) , ( [ dfdx ] ) , and ( [ cartric ] ) to express the right - hand side of ( [ dfsys ] ) only in terms of @xmath285 , @xmath286 , derivatives of @xmath286 , and the ricci curvature @xmath287 . combining all the previous equations we now have a closed system of ordinary differential equations that may be solved uniquely up to conjugate points . in the next paragraph , we summarize the entire method for convenience .    as claimed above we",
    "have now produced a closed system of ordinary differential equations that may be solved to obtain @xmath13 and @xmath288 in cartesian coordinates .",
    "the system is nonlinear and contains @xmath289 equations .",
    "it may be written as @xmath290           { \\bf j}_{k}^l \\\\[0.1 cm ]           \\dot { \\bf j}_{k}^l \\\\[0.1 cm ]           f^l_k \\\\[0.1 cm ]           \\frac{\\partial f^l_k}{\\partial { \\widehat{x}}^p }           \\end{matrix}\\right )     = \\left(\\begin{matrix }       w_\\gamma^l(r,{\\widehat{x}},{\\bf j},\\dot { \\bf j } ,                       f,\\frac{\\partial f}{\\partial { \\widehat{x } } } ) \\\\[0.1 cm ]       w_{{\\bf j};k}^l(r,{\\widehat{x}},{\\bf j},\\dot { \\bf j } ,                       f,\\frac{\\partial f}{\\partial { \\widehat{x } } } ) \\\\[0.1 cm ]       w_{\\dot { \\bf j};k}^l(r,{\\widehat{x}},{\\bf j},\\dot { \\bf j } ,                       f,\\frac{\\partial f}{\\partial { \\widehat{x } } } ) \\\\[0.1 cm ]       w_{f;k}^l(r,{\\widehat{x}},{\\bf j},\\dot { \\bf j } ,                       f,\\frac{\\partial f}{\\partial { \\widehat{x } } } ) \\\\[0.1 cm ]       w_{\\frac{\\partial f}{\\partial { \\widehat{x}}};kp}^l(r,{\\widehat{x}},{\\bf j } ,       \\dot { \\bf j},f,\\frac{\\partial f}{\\partial { \\widehat{x } } } )       \\end{matrix}\\right ) .\\ ] ] we describe how each of the `` @xmath113 '' functions on the right - hand side are to be evaluated . @xmath291 and @xmath292 are the simplest .",
    "recalling that @xmath293 and using ( [ jacobisys ] ) they are given by @xmath294 next , again according to ( [ jacobisys ] ) , @xmath295 is given by @xmath296 since @xmath297 , @xmath298 is given by @xmath299 finally , @xmath300 is given by ( [ dfsys ] ) where we calculate @xmath301 using ( [ dfdx ] ) , and calculate @xmath302 in several steps using the values of @xmath301 already calculated , ( [ cartric ] ) , ( [ ric ] ) , and then ( [ ric2 ] ) . system ( [ w sys ] ) gives a nonlinear system of odes which can be solved to recover @xmath145 and @xmath303 up to conjugate points .",
    "however , at the conjugate points the matrix @xmath285 will become singular , and we will not be able to continue .",
    "note that we do not explicitly solve for @xmath13 in this system , but after we have found @xmath304 , then @xmath163 and therefore @xmath13 may be calculated from ( [ vrel ] ) . indeed since @xmath305 , ( [ vrel ] ) becomes @xmath306      by its construction , the system ( [ w sys ] ) has a solution up to the first conjugate point of @xmath63 along @xmath36 , and since the functions on the right hand side of ( [ w sys ] ) are lipschitz continuous away from the conjugate points this solution is unique .",
    "thus we can recover @xmath13 along the entire length of @xmath36 using ( [ w sys ] ) if there is no conjugate point to @xmath63 .",
    "however , if there is a conjugate point , then we must follow a more sophisticated strategy .",
    "note that once we are able to calculate the matrix @xmath307 after step 1 , then we can identify all of the conjugate points of @xmath63 .",
    "since we are only concerned with a finite length along the geodesic @xmath36 , by the morse index theorem ( see e.g. ( * ? ? ?",
    "* theorem 15.1 ) ) there are only a finite number of points conjugate to @xmath63 , and each of these conjugate points also has only a finite number of conjugate points on the finite interval of interest",
    ". thus we can pick an alternate value of @xmath308 such that @xmath63 and @xmath308 do not have any of the same conjugate points , and there are no conjugate points to either on @xmath309 $ ] .",
    "performing step 1 with @xmath63 replaced by by @xmath310 , we can also consider the system ( [ w sys ] ) with @xmath63 replaced by @xmath310",
    ".    now suppose that @xmath311 is the set of times conjugate to @xmath63 in the interval @xmath312 given in decreasing order ( i.e. so that @xmath313 for all @xmath98 ) .",
    "then for each @xmath98 there is an open interval @xmath314 containing @xmath315 such that @xmath316 does not contain any times conjugate to @xmath308 along @xmath36 .",
    "suppose that @xmath317 is another collection of open intervals so that @xmath318 covers @xmath312 and @xmath319 $ ] for all @xmath98 where we are setting @xmath320 for some @xmath321 sufficiently small .",
    "now , let us set @xmath322 ( recall that @xmath62 is the domain of the inverse coordinate map @xmath323 ) . by solving ( [ w sys ] ) and possibly shrinking @xmath324 we can find the wave speed @xmath13 in cartesian coordinates on the set @xmath325 . by the continuity of @xmath326 we can find an open set @xmath327 and an open interval @xmath328 containing @xmath107 and intersecting @xmath329 nontrivially such @xmath330 .",
    "therefore , since the wave speed is known in @xmath331 we can find the parallel fields and jacobi fields in cartesian coordinates corresponding to @xmath308 for @xmath332 and @xmath333 . now ,",
    "after possibly shrinking @xmath334 , we can solve ( [ w sys ] ) with @xmath63 replaced by @xmath308 to find the wave speed in cartesian coordinates on @xmath335 .",
    "thus we have reconstructed the wave speed on @xmath336 .",
    "switching the roles of @xmath63 and @xmath308 we can reconstruct the wave speed on a set of the form @xmath337 for some open set @xmath338 . continuing in this way after a finite number of steps we can eventually reconstruct the wave speed on a set of the form @xmath339 which is a neighborhood of the geodesic @xmath36 .",
    "this completes the reconstruction in dimension three or higher .",
    "the method of the previous section , step 2 in the reconstruction procedure , will not work in two dimensions .",
    "the basic reason for this is that we can not determine all of the second partial derivatives of @xmath163 from the curvature of @xmath3 , but rather can only obtain the laplacian of @xmath163 as shown in ( [ scal ] ) . therefore in the two - dimensional case",
    "we are forced to recover @xmath163 by solving ( [ scal ] ) .",
    "we discuss this in more detail below , but first we will also revisit step 1 in the two - dimensional case where the formulae can be simplified .",
    "the main simplification comes from the fact that in the two dimensional case the trace of @xmath340 contains all of the same information as @xmath340 itself , and so it is actually easier to consider this trace .",
    "indeed , let us define @xmath341 in this case we have the following simple method of calculating @xmath342 away from conjugate points .",
    "if @xmath24 is not conjugate to @xmath26 along @xmath80 , then there is a distance function defined for @xmath343 in a neighborhood of @xmath67 by @xmath344 in the seismic context this is nothing other than the local travel time along rays close to @xmath80 from @xmath345 to points near @xmath346 .",
    "by @xcite we have @xmath347 we continue to review step 1 in the two dimensional case .",
    "we note that the @xmath348 which appear in equation ( [ eq a ] ) are actually all scalars and the only nonzero component of @xmath349 is @xmath350 which is what we recover in ( [ eq ainit ] ) .",
    "note also that in the two dimensional case , @xmath350 contains the same information as the sectional curvature ( if @xmath351 is chosen to have unit length with respect to @xmath3 then in fact @xmath350 is the sectional curvature ) .",
    "the other simplification occurs in substep 4 . in the two dimensional case",
    "the metric must have the form @xmath352 now by @xcite , @xmath353 satisfies the equation @xmath354 where @xmath355 is already known .",
    "since the metric is also known in a neighborhood of @xmath58 we may simply solve this equation with the known initial data @xmath356 and @xmath357 in order to find the metric in the @xmath67 coordinates defined by @xmath70 .",
    "we see that it is not necessary in this case to compute the matrix @xmath285 corresponding to the jacobi fields .",
    "now we continue to show how step 2 may be accomplished in the two dimensional case .",
    "the method makes use of the scalar curvature rather than the ricci curvature .      in step 2",
    "we must take a different strategy for the two dimensional case .",
    "the difference is that we can not express the second derivatives of @xmath163 which appear in ( [ dfsys ] ) in terms of @xmath285 , @xmath286 , derivatives of @xmath286 , and the ricci curvature .",
    "instead we use a method inspired by the treatment from ( * ? ? ?",
    "* section 4.5.6 ) of a different problem .",
    "after we recover the metric @xmath3 in the coordinates @xmath67 given by @xmath70 we use the scalar curvature equation ( [ scal ] ) to directly solve for @xmath163 in these coordinates .",
    "indeed , we assume that @xmath358 are known , and so in fact we have cauchy data for @xmath163 on @xmath58 . thus @xmath163 satisfies a cauchy problem for the elliptic operator @xmath191 ( see ( [ scal ] ) ) expressed in @xmath67 coordinates .",
    "this equation is given explicitly by @xmath359 here @xmath360 is the inverse of the matrix given by formula ( [ hatg ] ) extended to values of @xmath73 other than @xmath107 and @xmath361 is the determinant of the matrix @xmath362 .",
    "the scalar curvature , @xmath363 , can be computed from @xmath250 .",
    "expressed in the coordinates this is an elliptic equation although it is degenerate when @xmath24 is conjugate to @xmath63 along @xmath80 . adopting the notation of the previous section , by the unique continuation principal ( for a modern review of cauchy problems for elliptic operators see @xcite ) we can first reconstruct @xmath364 for @xmath365 .",
    "we note , however , that this reconstruction is generally unstable ( once again see @xcite for a detailed review of the stability of this type of problem ) .",
    "now once we have recovered @xmath163 in @xmath67 coordinates for @xmath365 the system ( [ w sys ] ) can be replaced by a significantly simpler system . indeed ,",
    "if we combine the equation ( [ jacobisys ] ) for the jacobi field matrix with ( [ eq : fpartr ] ) and ( [ coc ] ) , then we have a closed system of ordinary differential equations which may be solved just like ( [ w sys ] ) for the higher dimensional case . for convenience",
    "we write this system down explicitly .",
    "the system is @xmath366           { \\bf j}_{k}^l \\\\[0.1 cm ]           \\dot { \\bf j}_{k}^l \\\\[0.1 cm ]           f^l_k \\\\[0.1 cm ]           \\end{matrix}\\right )     = \\left(\\begin{matrix }       w_\\gamma^l(r,{\\widehat{x}},{\\bf j},\\dot { \\bf j } ,                       f ) \\\\[0.1 cm ]       w_{{\\bf j};k}^l(r,{\\widehat{x}},{\\bf j},\\dot { \\bf j } ,                       f ) \\\\[0.1 cm ]       w_{\\dot { \\bf j};k}^l(r,{\\widehat{x}},{\\bf j},\\dot { \\bf j } ,                       f ) \\\\[0.1 cm ]       w_{f;k}^l(r,{\\widehat{x}},{\\bf j},\\dot { \\bf j } ,                       f ) \\\\[0.1 cm ]       \\end{matrix}\\right ) .\\ ] ] here @xmath367 , @xmath368 , and @xmath369 are given by the same formulae shown below ( [ w sys ] ) .",
    "the last entry on the right hand side is given , according to ( [ eq : fpartr ] ) and ( [ coc ] ) , by @xmath370 solving these equations we can recover @xmath163 , and therefore also @xmath13 , in cartesian coordinates on @xmath371 .",
    "once we have this we can find cauchy data on the surface @xmath372 for some @xmath373 for the scalar curvature equation in the coordinates given by @xmath326 , and repeat the process described above . thus we can introduce a stepping procedure as in the higher dimensional case and this completes the reconstruction in the case of two dimensions .",
    "this theorem follows from the recovery procedure that we have presented in sections  [ step1 ] through  [ 2d ] .",
    "indeed , from results in  @xcite applying step 1 , which is described in section  [ step1 ] , for any @xmath64 we can recover the metric @xmath3 in @xmath67 coordinates corresponding to @xmath70 for any @xmath374 .",
    "then , in dimension @xmath375 or higher , the argument of section  [ step2 ] completes the proof , while in dimension @xmath123 we must use the scalar curvature equation as described in section  [ 2d ] .",
    "the proof of theorem  [ thm2 ] involves reduction to the case of theorem  [ thm1 ] .",
    "we also perform this reduction more explicitly in the case that @xmath2 is flat and @xmath13 is constant in a neighborhood of @xmath2 in the appendix .",
    "let us begin by taking any @xmath376 .",
    "by the hypotheses there exists a point @xmath377 .",
    "let @xmath378 be a set of local coordinates defined on an open subset of @xmath379 containing @xmath380 and denote by @xmath381 the coordinate mapping which we suppose has range given by @xmath382 .",
    "we construct @xmath381 such that @xmath383 .",
    "finally , let @xmath384 denote the outward pointing unit normal , with respect to @xmath3 , vector field for @xmath2",
    ".    we will now write @xmath385 for the exterior derivative on @xmath2 . for @xmath64 and @xmath386",
    "let us consider the set @xmath387 and mapping @xmath388 defined by @xmath389 this set and mapping can be found from the data .",
    "now , if @xmath390 is dense in @xmath391 for all @xmath73 in a neighborhood of @xmath107 and @xmath392 then the geodesic represented by @xmath393 ( see the next paragraph ) is contained in @xmath157 and intersects @xmath2 transversally . in this case we continue .",
    "otherwise we do not use this choice of @xmath394 .",
    "intuitively , @xmath395 is a representation of the portion of a geodesic passing through @xmath396 which lies inside @xmath0 , and the range of @xmath397 parametrizes this geodesic segment . indeed , for every @xmath398 ,",
    "let @xmath399 be given by @xmath400 \\",
    "g_z^{jk}(\\phi^{-1}_z(\\hat{x } ) ) \\frac{\\partial}{\\partial \\hat{x}^k } \\\\ & & \\hskip.5 in + \\left ( \\sqrt{1 - \\left |   \\frac{\\partial}{\\partial \\hat{x}^j } \\rho_\\lambda \\left ( \\phi_z^{-1}(\\hat{x } ) \\right ) \\right |_{g_z}^2 } \\right ) \\nu ( \\phi_z^{-1}(\\hat{x } ) ) \\nonumber\\end{aligned}\\ ] ] where @xmath401 is the metric @xmath3 restricted to @xmath2 expressed in the @xmath73 coordinate frame .",
    "then @xmath395 represents a segment of the geodesic @xmath402 .",
    "we now begin relating the constructions we have made so far with the data required to apply theorem  [ thm2 ] .",
    "first , let us take a sufficiently small constant @xmath403 and set @xmath404 these can be constructed from the given data because @xmath405 for @xmath406 sufficiently small .",
    "we can also construct the map @xmath407 defined by @xmath408 taking @xmath406 sufficiently small , and possibly shrinking @xmath62 we can make @xmath409 a diffeomorphism onto its image , and so @xmath410 is a coordinate map on the image of @xmath409 which , using the notation introduced earlier in the paper , we take to be @xmath58 with @xmath411 . also following the earlier notation we let @xmath412 be the outward pointing unit normal vector for @xmath58 at @xmath413 .",
    "suppose now that @xmath64 , and @xmath414 $ ] .",
    "if @xmath415 and @xmath26 are not conjugate along @xmath416 then there exists a @xmath398 such that @xmath417 .",
    "now we have that @xmath418 is defined on a neighborhood @xmath419 of @xmath73 , and the set @xmath420 is then given by @xmath421 since we can recover this set and we know @xmath422 we can calculate the shape operator @xmath423 provided it exists .",
    "therefore we may calculate @xmath119 .",
    "since there are only a finite number of @xmath414 $ ] that are conjugate to @xmath415 along @xmath416 we may in fact obtain @xmath119 for all @xmath414 $ ] for which it is defined by continuity . finally since @xmath424",
    "we can also find @xmath119 for all @xmath425 $ ] for which it is defined .",
    "now suppose that @xmath426 .",
    "provided that @xmath308 and @xmath406 are not conjugate along @xmath36 , there exists @xmath427 such that @xmath428 .",
    "we may now repeat the previous construction with @xmath63 replaced by @xmath308 to obtain @xmath429 for all @xmath430 $ ] where it is defined , and this gives all of the data necessary to apply theorem  [ thm1 ] .",
    "therefore we can recover the wave speed @xmath13 in a neighborhood of @xmath431 . by the hypotheses @xmath157",
    "can be covered by sets of this form , and so we can recover the wave speed @xmath13 on all of @xmath157 as claimed .",
    "we generalized the method of dix for reconstructing a depth varying velocity in a half space , where depth is the cartesian coordinate normal to the boundary , to a procedure for reconstructing a conformally euclidean metric on a region of @xmath1 from expansions of diffraction travel times generated by scatterers in the region and measured on its boundary .",
    "our procedure consists of two steps : in the first step , we reconstruct the directional curvature operator along geodesics as well as the metric in riemannian normal coordinates .",
    "riemannian normal coordinates can be thought of as `` time '' coordinates as they appear in so - called seismic time migration .",
    "we note that the directional curvature operator did not appear in the method of dix because of the class of velocity models he considered . in the second step ,",
    "the velocity and the geodesics on which the velocity is reconstructed are obtained through a transformation to cartesian coordinates ; this can be thought of as a generalization of the `` time - to - depth '' conversion in the framework of dix original formulation . in dimension three or more",
    "both steps are essentially formulated in terms of solving a closed system of nonlinear ordinary differential equations , for example , by application of a runge - kutta method . in dimension two",
    "the second step requires the solution of a cauchy problem for an elliptic operator which may suffer from stability issues . through the associated discretization",
    ", we accommodate the case of a finite number of scatterers in the manifold .",
    "we admit the formation of caustics .",
    "in this appendix we show more explicitly how the somewhat abstract procedure described in the proof of theorem  [ thm2 ] to move from travel times , or generalized distance functions , to the shape operators for wavefronts can be done in a particular case .",
    "we assume that @xmath0 is a lower half space and @xmath13 is constant in a neighborhood of the boundary and thus can be extended smoothly as a constant . here",
    "we have the application in mind , and so we use the term travel time for the distance in the metric @xmath3 .",
    "we use cartesian coordinates @xmath433 and assume that we have a flat boundary at @xmath434 so that @xmath435 and @xmath436 .",
    "we focus on a single diffraction point , @xmath437 , and measure the travel times from @xmath437 as a function of the transverse coordinates at @xmath438 which we label as @xmath73 .",
    "we assume that the wave speed @xmath13 is equal to a constant @xmath439 in a neighborhood of @xmath440 and write the travel time as @xmath441 which is a function of @xmath73 for @xmath73 in some open set @xmath382 .",
    "first we can determine the tangent vector of the ray passing through a certain point @xmath73 of the boundary and corresponding to the travel time @xmath442 by @xmath443 @xmath444 ( these equations should be compared with ( [ eq : v ] ) ) .",
    "we are using the prime notation here to indicate that the indices only run from @xmath445 to @xmath446 .",
    "in practice it would be possible to calculate @xmath447 by finding the normal to the surface @xmath448 which is proportional to the vector @xmath449 also note that if we look at multiple wavefronts coming from different diffraction points , then we can identify contributions from diffraction points along the same ray by the fact that they must satisfy @xmath450 ( compare with ( [ eq : wtgamma ] ) ) where @xmath451 and @xmath452 correspond to the two different wavefronts .",
    "now we choose @xmath453 and consider the surface of points with travel time @xmath63 from the given diffraction point . in the body of the paper this surface is labeled @xmath58 .",
    "we may parametrize the surface @xmath58 by @xmath73 using the map ( labeled @xmath454 in the body of the paper ) @xmath455 it is through this map that we define the coordinates on @xmath58 . for @xmath456 we can also write a formula for the inverse of the coordinate map for the coordinates @xmath67 ( @xmath70 in the body of the paper ) .",
    "this is @xmath457 now we may calculate the matrices @xmath458 and @xmath459 which give respectively the parallel translated fields @xmath460 and the coordinate vector fields @xmath166 ( which are also jacobi fields ) in the cartesian coordinates ( note that @xmath461 differs from @xmath462 in the body of the paper which represents the jacobi fields with respect to the parallel frame ) . to take advantage of the summation notation",
    "we also write @xmath463 and @xmath464",
    ". then we have @xmath465 where we may calculate ( using the notation @xmath466 ) @xmath467 the parallel fields are the same as the coordinate vectors at @xmath468 , and since for @xmath456 the wave speed is constant they are in fact constant in the cartesian frame on the same set .",
    "thus we have , for @xmath456 , @xmath469 these matrices may also be written directly in terms of the travel time function @xmath441 . indeed if we write @xmath470 for the hessian matrix of @xmath441 , and @xmath471 for the gradient then @xmath472 and @xmath473 now we calculate the matrix @xmath474 which corresponds with the shape operator of @xmath475 with respect to the parallel frame . to begin , recall that @xmath476 where @xmath477 is the dual frame for @xmath478 .",
    "now we can use the fact that the christoffel symbols in cartesian coordinates are zero where the wave speed is constant to calculate @xmath479 therefore @xmath480 once again , this can also be changed to an expression in terms of @xmath441 and its derivatives as @xmath481 and we may use this formula to calculate @xmath482 which we invert to give the initial conditions for the system ( [ eq a ] ) . to calculate the derivatives with respect to @xmath26 we must consider multiple wavefronts , and using the comment above identify singularities in the wavefront corresponding to diffraction points along the same ray ."
  ],
  "abstract_text": [
    "<S> we consider a region @xmath0 in @xmath1 with boundary @xmath2 and a metric @xmath3 on @xmath0 conformal to the euclidean metric . </S>",
    "<S> we analyze the inverse problem , originally formulated by dix  @xcite , of reconstructing @xmath3 from boundary measurements associated with the single scattering of seismic waves in this region . in our formulation the measurements </S>",
    "<S> determine the shape operator of wavefronts outside of @xmath0 originating at diffraction points within @xmath0 . </S>",
    "<S> we develop an explicit reconstruction procedure which consists of two steps . in the first step </S>",
    "<S> we reconstruct the directional curvatures and the metric in what are essentially riemmanian normal coordinates ; in the second step we develop a conversion to cartesian coordinates . </S>",
    "<S> we admit the presence of conjugate points . in dimension @xmath4 </S>",
    "<S> both steps involve the solution of a system of ordinary differential equations . in dimension @xmath5 the same is true for the first step , but the second step requires the solution of a cauchy problem for an elliptic operator which is unstable in general . </S>",
    "<S> the first step of the procedure applies for general metrics . </S>"
  ]
}