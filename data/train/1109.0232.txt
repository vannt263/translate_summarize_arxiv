{
  "article_text": [
    "let @xmath7 be a number field with set of valuations @xmath8 . given an algebraic variety @xmath9 defined over @xmath7 we have the obvious inclusions @xmath10 where @xmath11 is the diagonal embedding of the set @xmath12 of @xmath7-rational points into the set @xmath13 of adles of @xmath9 .",
    "moreover the set @xmath13 is empty if and only if @xmath14 is empty and clearly provides a local obstruction to the existence of @xmath7-rational points on @xmath9 .",
    "recall that a class @xmath15 of algebraic varieties @xmath9 defined over @xmath7 is said to satisfy the hasse principle if @xmath16 whenever @xmath17 .",
    "likewise @xmath15 is said to satisfy weak approximation if whenever it is non - empty the image of @xmath12 under @xmath11 is dense in @xmath13 in the product of @xmath18-adic topologies .",
    "this paper is concerned with the hasse principle and weak approximation for the class of varieties satisfying the diophantine equation @xmath19 where @xmath20 is a full norm form for an extension @xmath21 of number fields , and @xmath3 is a polynomial over @xmath7 . thus if @xmath22=n$ ] and we fix a basis @xmath23 for @xmath1 as a vector space over @xmath7 , then @xmath24 throughout this paper we will use @xmath20 to denote a norm form , and @xmath25 to denote the corresponding field norm .",
    "progress on this problem has been limited , and we begin by discussing what is known in the simplest cases . a crude measure of difficulty is given by the number of distinct roots of @xmath3 over an algebraic closure @xmath26 .",
    "when @xmath3 is a non - zero constant polynomial the hasse principle for is known as the `` hasse norm principle '' .",
    "the validity of the hasse norm principle for cyclic extensions @xmath21 was established by hasse himself , but for non - cyclic extensions there can be counterexamples .",
    "there is an extensive literature on the subject and it is known , for example , that the hasse norm principle holds if the field @xmath1 has prime degree over @xmath7 ( bartels @xcite , for example ) ; or the galois group of @xmath27 is dihedral , where @xmath28 is the normal closure of @xmath1 over @xmath7 ( bartels @xcite ) ; or the extension @xmath21 is galois and every sylow subgroup of the galois group is cyclic ( gurak ( * ? ? ?",
    "* corollary 3.2));. following the work of colliot - thlne and sansuc ( * ? ? ?",
    "* proposition 9.1 ) , we also have simple sufficient conditions to ensure that `` weak approximation for norms '' holds , by which we mean that weak approximation holds for when @xmath3 is a non - zero constant polynomial .",
    "let @xmath28 be the normal closure of @xmath1 over @xmath7 .",
    "then weak approximation holds if either the degree @xmath22 $ ] is prime , or if the galois group of @xmath27 has cyclic sylow subgroups .",
    "in particular the latter result implies that it suffices for @xmath21 to be cyclic .",
    "the next case to consider is that in which @xmath29 for some @xmath30 and some positive degree @xmath31 . in this situation the hasse principle and weak approximation may fail .",
    "however is a principal homogeneous space under an algebraic @xmath7-torus , and the work of sansuc @xcite and voskresenski@xmath32 @xcite shows that the brauer  manin obstruction is the only obstruction to the hasse principle and weak approximation on any smooth projective model of this variety .",
    "when @xmath22=2 $ ] and @xmath3 has degree @xmath33 or @xmath34 then defines a chtelet surface .",
    "the arithmetic of such surfaces is well - understood .",
    "the hasse principle and weak approximation may fail , but it has been shown by colliot - thlne , sansuc and swinnerton - dyer @xcite that all such failures are explained by the brauer  manin obstruction .",
    "the same conclusion is available when @xmath22=3 $ ] and @xmath35 , by work of colliot - thlne and salberger @xcite .",
    "there have also been investigations into when @xmath3 factors completely over @xmath7 , with at most two roots . in this case one",
    "may write @xmath36 with @xmath37 and @xmath38 .",
    "it is known that one has the hasse principle and weak approximation whenever the brauer  manin obstruction is empty , providing that we work over the ground field @xmath39 .",
    "this was first proved under the assumption that @xmath40 , by heath - brown and skorobogatov @xcite , a condition that was subsequently removed by colliot - thlne , harari and skorobogatov @xcite . while all the previous work described had been purely algebraic , the approach used by heath - brown and skorobogatov combined analytic machinery , in the form of the hardy  littlewood circle method , with the previous descent approach to the brauer  manin obstruction .",
    "the circle method can be adapted , with some effort , to apply to ground fields other than @xmath39 . however , for simplicity , this possibility was not explored in @xcite .",
    "very little is known about other polynomials @xmath3 .",
    "when @xmath3 is a non - zero separable polynomial with degree at least @xmath41 , it is conjectured that the hasse principle and weak approximation hold whenever the brauer  manin obstruction is empty .",
    "when @xmath21 is cyclic and schinzel s hypothesis is granted , work of colliot - thlne , skorobogatov and swinnerton - dyer ( * ? ?",
    "* theorem  1.1 ) yields a positive answer to this question .",
    "note that this result is already a special case of earlier work of colliot - thlne and swinnerton - dyer @xcite on pencils of severi  brauer varieties , but this connection is only made clear in the discussion @xcite .",
    "note that when @xmath21 is cyclic the brauer  manin obstruction is known to be empty if @xmath3 is irreducible over @xmath7 .",
    "( this follows from corollary 2.6(c ) of colliot - thlne , harari and skorobogatov @xcite , which shows that the brauer group contains only vertical elements when @xmath21 is cyclic .",
    "however it is not hard to show that the vertical part of the brauer group is trivial when @xmath3 is irreducible over @xmath7 , using the remark on page 76 of @xcite . )",
    "finally we mention that there is potential for tackling the case in which @xmath3 is an arbitrary polynomial which splits completely over @xmath7 into @xmath31 linear factors , at least in the case @xmath39 , by using ideas from the work of green and tao @xcite together with the main theorem from green , tao and ziegler @xcite . in this case",
    "the methods of heath - brown and skorobogatov @xcite reduce the problem to one involving a system of equations @xmath42 in the language of @xcite , this is a system of linear forms of finite complexity .",
    "the machinery of green and tao , and of green , tao and ziegler , allows one to handle such systems when the norms are replaced by primes , and it seems reasonable to hope that a variant of the method would allow one to handle the problem above .",
    "this plan was first mentioned to us by professor wooley .",
    "it will be apparent from the foregoing survey that the most obvious open case is that in which @xmath3 is an irreducible quadratic over @xmath7 , and this is the goal of the present paper .",
    "again we shall be dependent on techniques from analytic number theory which have not been fully developed for ground fields other than @xmath39 , so we shall confine attention to this latter case . with this restriction",
    "our goal will be to establish the hasse principle and weak approximation for @xmath43 under suitable assumptions on the extension @xmath5 .",
    "let @xmath44 denote the @xmath18-adic norm , which we extend to vectors by setting @xmath45 if @xmath46 . when @xmath47 we will simply write @xmath48 with this in mind the following is our main result .",
    "[ thmain ] let @xmath0 $ ] be an irreducible quadratic polynomial and let @xmath1 be a quartic extension of @xmath2 containing a root of @xmath3 .",
    "suppose that , for every @xmath49 , we are given a solution @xmath50 of .",
    "let @xmath51 be any finite subset and let @xmath52 . then there is a solution @xmath53 of such that @xmath54 for every @xmath55 .",
    "thus the hasse principle and weak approximation hold for .",
    "it is interesting to note that our result is both unconditional and concerns field extensions @xmath5 which may be non - cyclic .",
    "this marks a departure from the sort of results achieved in @xcite .",
    "in fact our theorem answers in the affirmative a question posed by colliot - thlne , during the 2005 bremen workshop `` rational points on curves  explicit methods '' , about the hasse principle for in the special case that @xmath1 is a biquadratic extension containing a root of @xmath3 ( cf .   the questions at the close of  2 in the work of colliot - thlne , harari and skorobogatov @xcite ) .",
    "the proof of theorem [ thmain ] relies on techniques from analytic number theory and is inspired by work of fouvry and iwaniec @xcite , who proved that there are infinitely many primes @xmath56 of the form @xmath57 , with @xmath58 also prime .",
    "more generally they showed how to produce primes of the form @xmath57 with @xmath58 from any sufficiently dense set .",
    "our argument involves many complexities of detail , but also one major simplification , since we have only to produce integers in @xmath59 , rather than primes .",
    "we can generalise our result mildly , to include the case in which @xmath60 for an odd positive integer @xmath61 , where @xmath62 $ ] is an irreducible quadratic polynomial .",
    "this is achieved by establishing a bijection between solutions of and solutions of the corresponding equation in which @xmath3 is quadratic .",
    "to do this we begin by choosing @xmath63 for which @xmath64 .",
    "the equation becomes @xmath65 , and raising to the power @xmath66 we obtain @xmath67 , whence @xmath68 . since @xmath1 has degree @xmath34 over @xmath2 , we deduce that @xmath69 is a norm from @xmath1 whenever @xmath60 is a norm from @xmath1 .",
    "the converse deduction is similar .",
    "thus if @xmath70 then , raising both sides to the power @xmath61 we find that @xmath71 , whence @xmath72 . thus @xmath3 is a norm from @xmath1 whenever @xmath73 is a norm from @xmath1 .",
    "it is now immediate from theorem [ thmain ] that we have the hasse principle and weak approximation for @xmath60 .    by a simple change of variable",
    "we may assume that @xmath74 in theorem [ thmain ] , where @xmath75 is a non - zero rational and @xmath76 is a square - free integer .",
    "let @xmath77 the fields to which our theorem applies take the shape @xmath78 , with @xmath79 .",
    "in particular we have @xmath80 in the statement of theorem [ thmain ] .",
    "it turns out that most of our argument carries over to an arbitrary degree @xmath81 extension @xmath1 of @xmath2 that contains @xmath82 as a subfield .",
    "given @xmath74 as above , we suppose that @xmath83 are solutions of , for each @xmath49",
    ". then we want to determine conditions on @xmath1 , beyond the hypothesis @xmath84 , such that for any finite set @xmath51 we can find a solution @xmath85 of for which the weak approximation condition holds for each @xmath55 .",
    "in pursuing this goal we may assume that @xmath23 is an integral basis for the ring of integers @xmath86 , with @xmath87 . by the transitivity of norms we have @xmath88 , since @xmath84 .",
    "hence any norm from @xmath1 to @xmath2 is also a norm from @xmath82 to @xmath2 .",
    "we will make frequent use of this fact in our work .    since @xmath89 it follows from the hypotheses of the theorem that the equation @xmath90 can be solved for @xmath91 for any @xmath92 .",
    "the hasse norm principle therefore implies that there exists @xmath93 such that @xmath94 thus it will suffice to work with the equation @xmath95 rather than , with square - free @xmath96 and non - zero @xmath97 .",
    "we are then given a finite set @xmath51 and a solution @xmath98 of this equation for every @xmath92 and we wish to establish the existence of a solution @xmath85 such that holds for every @xmath55 .",
    "our plan is to achieve this by arranging that @xmath99 where @xmath100 then if @xmath101 and @xmath102 we obtain ( [ eq:2.3 ] ) on taking @xmath103 to correspond to the element @xmath104",
    ". it will be convenient to write @xmath105 for the vector @xmath106 produced by this construction .",
    "in fact we will establish the following result , which demonstrates the hasse principle and weak approximation for , for any number field @xmath1 of degree @xmath81 that contains @xmath82 .",
    "[ thmain - a ] let @xmath107 and assume that @xmath80 .",
    "suppose that , for every @xmath49 , we are given a solution @xmath108 of .",
    "let @xmath51 be any finite subset and let @xmath52 .",
    "then there is a solution @xmath109 of such that @xmath110 for every @xmath55 .    in   [",
    "s : deduc ] we will show how theorem [ thmain ] follows from this result when @xmath1 is a quadratic extension of @xmath82 .",
    "this will be achieved via the following result .",
    "[ newlem ] let @xmath1 be a quadratic extension of @xmath82 .",
    "let @xmath111 be a finite set and let @xmath52 be given .",
    "suppose that the equation @xmath112 has solutions @xmath113 everywhere locally",
    ". then there exists @xmath114 with @xmath115 such that @xmath116 has solutions @xmath117 everywhere locally , with @xmath118 .",
    "we should emphasise here that when we speak of local solutions we are thinking of zeros over @xmath119 of the polynomial , defined over @xmath119 , which specifies the equation .",
    "in particular , elements of the completions @xmath120 , for @xmath121 , do not occur .",
    "it has been suggested to us by professor colliot - thlne that the open descent method of colliot - thlne and skorobogatov @xcite might be used to establish a variant of lemma [ newlem ] in which @xmath1 is an arbitrary finite extension of @xmath82 .",
    "the proposed lemma would then give the same conclusion as lemma [ newlem ] , but under the assumption that the solutions @xmath113 of ( [ pnz1 ] ) produce an adlic point orthogonal to the brauer group of the variety .",
    "once combined with theorem [ thmain - a ] , this should demonstrate that the brauer  manin obstruction to the hasse principle and to weak approximation is the only one for , when @xmath0 $ ] is an irreducible quadratic polynomial and @xmath1 is an arbitrary extension of @xmath2 containing a root of @xmath3 .",
    "however this would still leave open the difficult problem of calculating the brauer group , which our route avoids .    by lemma [ newlem ] ,",
    "given local solutions of , we may produce an equation in which @xmath122 and @xmath123 , and which has corresponding local solutions suitably close to those of .",
    "we may then use theorem [ thmain - a ] to produce a global solution of close to the given local solutions . finally , taking the norm from @xmath82 to @xmath2 we obtain a suitable global solution of .",
    "it should be pointed out that this argument uses the fact that the map from @xmath124 to @xmath105 is continuous for @xmath125 providing that we avoid a neighbourhood of @xmath126 .",
    "we stress that the only point in the paper where we use our assumption that @xmath127 is quadratic occurs in the proof of lemma [ newlem ] .",
    "we proceed to indicate the initial steps in our treatment of in theorem [ thmain - a ] .",
    "a suitable value of @xmath128 will exist , providing that @xmath129 moreover , we will then have @xmath130 thus if we have a solution of ( [ yeq1 ] ) in which @xmath131 and @xmath132 are sufficiently close to @xmath133 and @xmath134 it will be automatic that the corresponding solution @xmath135 will be close to @xmath136 .",
    "it follows that we have only to establish a suitable hasse principle and weak approximation result for ( [ yeq1 ] ) .",
    "we must make a further manoeuvre before reaching our fundamental equation . as mentioned above , the work of fouvry and iwaniec handles primes . using standard machinery ,",
    "prime numbers are dealt with by means of `` type  i sums '' and `` type ii sums '' . of these , type ii sums involve bilinear forms in which the prime number is replaced by a product of integers @xmath137 , which have to lie in suitable ranges . in our case",
    "we can insist that our norm @xmath138 is a product @xmath139 , thereby eliminating the need to consider type i sums .",
    "indeed , since we can specify the sizes of @xmath140 and @xmath141 , the treatment of the type ii sums will also be simplified somewhat .",
    "thus instead of attacking we shall consider the diophantine equation @xmath142 with the aim of finding suitably localised solutions @xmath143    let @xmath144 denote the non - trivial automorphism of @xmath82 and suppose that @xmath145 is a @xmath146-basis for @xmath147 , and hence also a @xmath2-basis for @xmath82 .",
    "for technical reasons it will be convenient to replace the trace @xmath148 by a `` skew - trace '' @xmath149 for @xmath150 , where @xmath151 .",
    "thus @xmath152 is the different of @xmath153 .",
    "on writing @xmath154 our condition becomes @xmath155 we will count suitably restricted solutions of this equation . if @xmath156 is the number of such solutions we can write @xmath157 here the function @xmath158 , respectively @xmath159 , counts appropriately restricted representations of @xmath160 by @xmath161 , respectively of @xmath162 by @xmath163 .",
    "moreover @xmath164 counts suitably constrained solutions of @xmath165 .    our expression for @xmath166 can be viewed as a bilinear form .",
    "we have good techniques for estimating these , going back to the works of vinogradov .",
    "however the methods are designed to produce upper bounds for bilinear forms in which we expect cancellation , while our problem is to establish an asymptotic formula for an expression in which all the terms are non - negative .",
    "we shall therefore split @xmath167 into two parts @xmath168 , and write @xmath169 where @xmath170 is a main term , and contains the contribution from @xmath171 , while @xmath172 is an error term , and is the corresponding expression involving @xmath173 .",
    "thus we will need @xmath171 to be a sufficiently simple function that we can compute @xmath170 directly .",
    "moreover we will want @xmath173 to produce sufficient cancellation on average , so that a bilinear form estimation of @xmath172 can be achieved .",
    "the underlying principle here is exactly that which linnik @xcite developed in his `` dispersion method '' .    in   [",
    "s : approx ] we will describe a general procedure for producing an approximation of the type @xmath171 . in our context",
    "@xmath160 runs over the ring @xmath147 , but we will begin by presenting the method as it applies to sequences indexed by @xmath146 , since we hope this will prove to be of independent interest . with",
    "this choice made , our proof that the bilinear form @xmath174 makes a satisfactory overall contribution to the asymptotic formula is the subject of   [ s : bil ] .",
    "it is this part of our argument which is based on ideas from the work of fouvry and iwaniec @xcite , who provide a general framework for estimating sums of this sort .",
    "finally , the asymptotic evaluation of @xmath175 will be executed in   [ s : m ] and   [ s : ssi ] .",
    "some of this work was done while the authors were visiting the _ hausdorff institute _ in bonn and the _ institute for advanced study _ in princeton , and while the second author was visiting the _ mathematical sciences research institute _ in berkeley .",
    "the hospitality and financial support of these bodies is gratefully acknowledged . while working on this paper the first author",
    "was supported by epsrc grant number ` ep / e053262/1 ` .",
    "the goal of this section is to prove lemma [ newlem ] .",
    "as explained in the previous section , this is enough to allow the deduction of theorem [ thmain ] from theorem  [ thmain - a ] .",
    "let @xmath74 , where @xmath75 is a non - zero rational and @xmath76 is a square - free integer .",
    "for the moment let @xmath1 be an arbitrary number field of degree @xmath81 containing @xmath176 .",
    "in particular @xmath81 is even .",
    "fix any @xmath177 such that @xmath178 and let @xmath51 be finite .",
    "we may assume that @xmath179 contains the archimedean valuation , together with any valuations that become ramified in @xmath1 , and any valuations @xmath92 for which @xmath180 for some @xmath181 above @xmath18 .",
    "we proceed to look for a suitable @xmath182 , fulfilling the conditions of lemma [ newlem ] , by examining values @xmath183 .",
    "we will see that when @xmath184 any @xmath185 is acceptable .",
    "thus our first task is to find a value @xmath186 which works for the `` bad '' places @xmath187 . for such valuations",
    "we claim that there exist @xmath188 , with @xmath189 such that @xmath190 it then suffices to choose @xmath191 so that @xmath186 is close to @xmath192 for each @xmath55 , since then we may take @xmath193 and find a suitable @xmath194 close to @xmath195 .",
    "to establish the claim we begin by noting that the form @xmath196 decomposes as @xmath197 over @xmath82 , where @xmath198 $ ] are forms of degree @xmath199 . setting @xmath200 and @xmath201 , and multiplying through by @xmath192",
    ", we see that the equation becomes @xmath202 thus our problem is to show the existence of @xmath203 satisfying this , given the condition , namely @xmath204 if we set @xmath205 and @xmath206 for convenience , then becomes a pair of conditions @xmath207 we need to find a solution @xmath208 of these , with @xmath209 . in doing",
    "so we may assume , which becomes @xmath210 however the determinant of the system is @xmath211 moreover , if @xmath212 one readily deduces from that @xmath213 , which is impossible .",
    "this suffices for the proof of the claim .    in handling the case",
    "@xmath184 the following lemma will be useful .",
    "it will be proved at the end of the section .",
    "[ newlem2 ] let @xmath214 be a finite place , unramified in @xmath1 .",
    "suppose that @xmath215 is a unit in @xmath120 for each place @xmath216 of @xmath82 above @xmath18 .",
    "then @xmath217 for some @xmath218 , by which we mean that if @xmath219 and @xmath220 are as in then @xmath221 and @xmath222 .",
    "while lemma [ newlem2 ] is valid for arbitrary extensions @xmath1 of @xmath82 , we now make the assumption that @xmath1 is a quadratic extension of @xmath82 .",
    "in particular we have @xmath223 in the above discussion .    when @xmath184 our task is to show that if @xmath224 then there exists @xmath225 such that @xmath226 is of the form @xmath227 for some vector @xmath228 . since @xmath184",
    "there are no weak approximation conditions to be satisfied .",
    "we begin by considering the case in which @xmath184 is inert in @xmath153 .",
    "then @xmath229 for any @xmath186 , and @xmath230 by the choice of @xmath179 , whence @xmath231 will be a unit in @xmath232 .",
    "lemma [ newlem2 ] then shows that there exists @xmath233 such that @xmath234 .",
    "it therefore suffices to take @xmath235 in .",
    "finally we must deal with the case @xmath236 , with @xmath18 split in @xmath82 .",
    "suppose @xmath18 splits as @xmath237 and @xmath238 in @xmath82 .",
    "write @xmath56 for the rational prime associated to @xmath18 .",
    "let @xmath239 let @xmath240 and @xmath241 be the prime ideals associated to @xmath237 and @xmath242 respectively , so that @xmath243 for some ideal @xmath244 coprime to both @xmath240 and @xmath245 .",
    "choose @xmath246 , and set @xmath247 .",
    "we write @xmath248 and @xmath249 so that @xmath250 and @xmath251 are integers , and @xmath66 is strictly positive . since @xmath252 and @xmath127 is quadratic , we have @xmath253 .",
    "we may then calculate that @xmath254 and @xmath255 whence @xmath256 similarly we have @xmath257 thus lemma [ newlem2 ] tells us that @xmath258 can be written as @xmath138 for some @xmath259 .",
    "it follows that @xmath260 takes the form @xmath261 for some @xmath262 , whence @xmath263 is acceptable in .",
    "this completes the proof of lemma [ newlem ] .",
    "it now remains to establish lemma [ newlem2 ] , for which we return to an arbitrary extension @xmath1 of degree @xmath81 over @xmath2 , which contains @xmath82 as a subfield .",
    "it will be convenient to use the notation @xmath264 for the embedding of @xmath82 into the completion @xmath120 , and similarly for valuations of @xmath2 and @xmath1 .",
    "thus our hypothesis is that @xmath265 is a unit for every @xmath121 . for each such @xmath216",
    "we choose a place @xmath266 such that @xmath267",
    ". then the extension of local fields @xmath268 is unramified , whence @xmath265 must be a norm from @xmath269 ( see gras ( * ? ? ?",
    "* corollary 1.4.3 , part ( ii ) , page 75 ) , for example ) . for each @xmath216 above @xmath18 we may therefore write @xmath270 for appropriate elements @xmath271 .",
    "if @xmath272 lies above @xmath216 but is different from @xmath273 we take @xmath274 , so that @xmath275 we now use weak approximation to find elements @xmath276 such that @xmath277 for every @xmath272 above @xmath18 .",
    "we note in particular that the sequence @xmath278 converges with respect to each valuation @xmath279 above @xmath18 .",
    "we now have @xmath280 where the limit is with respect to @xmath281 .",
    "we therefore conclude that @xmath282 however , according to gras ( * ? ? ?",
    "* proposition 2.2 , page 93 ) we have @xmath283 so that @xmath284 since this holds for all @xmath216 above @xmath18 it follows that @xmath285 the convergence being with respect to @xmath286 , where @xmath287 finally , since the sequence @xmath276 converges for every valuation @xmath279 above @xmath18 , the sequence @xmath288 must converge in @xmath119 , yielding the required vector @xmath218 .",
    "we are now ready to begin the proof of theorem [ thmain - a ] , which concerns the hasse principle and weak approximation for the variety . for the remainder of the paper let @xmath1 be an arbitrary number field of degree @xmath81 that contains @xmath176 .",
    "as noted , it will be convenient to work with the equivalent variety .",
    "for ease of reference we repeat the definition here:- @xmath289 we are presented with local solutions @xmath290 for every valuation @xmath18 , and wish to find a global solution which approximates these for every @xmath187 .",
    "we claim that it suffices to consider the case in which @xmath290 are integral for every finite @xmath187 .",
    "indeed , let us suppose that we can solve with the local conditions @xmath291 providing that @xmath290 are integral for all finite @xmath187 .",
    "let us suppose further that we have a general set of values for @xmath290 satisfying .",
    "then we may choose an integer @xmath292 such that @xmath293 are integral for all finite @xmath187 .",
    "we note that these values will still satisfy .",
    "then , by our assumption , we can find a global solution @xmath294 of which satisfies @xmath295 for all @xmath187 .",
    "it follows that @xmath296 is a solution of fulfilling the condition .",
    "this establishes our claim .",
    "we now use weak approximation for @xmath297 to produce vectors @xmath298 such that @xmath299 for all finite @xmath187 .",
    "thus ( [ tap31 ] ) becomes @xmath300 for an appropriate modulus @xmath301 .",
    "having suitably re - interpreted the weak approximation conditions for the finite places we turn our attention to the infinite place .",
    "here we use a similar re - scaling argument to conclude that if @xmath302 satisfy @xmath303 then a solution @xmath294 of which satisfies both and the @xmath47 constraints @xmath304 of which meets the original condition . since @xmath305 and @xmath306 can not vanish we may choose @xmath307 sufficiently small that neither of @xmath131 or @xmath132 can be zero in .    as in ",
    "[ intro ] we replace the vector @xmath131 by @xmath140 and @xmath141 to produce the variety , whose definition it is convenient to repeat here:- @xmath308 it is clear that if @xmath140 and @xmath141 are sufficiently close to @xmath309 and @xmath310 in @xmath119 then @xmath131 will be suitably close to @xmath133 .",
    "we therefore assume that has local solutions @xmath311 for all places @xmath18 , with @xmath312 given by , and we aim to find a global solution such that @xmath313 for @xmath55 . since @xmath314 and @xmath312 are integral at all finite @xmath187 we can re - interpret the corresponding conditions as congruences @xmath315 with integer vectors @xmath316 and @xmath317 for which @xmath318 for technical reasons we will move @xmath319 in very slightly , and make a corresponding adjustment in @xmath306 to compensate , so as to ensure that @xmath320 for the infinite place we replace the parameter @xmath321 by two further values @xmath322 and @xmath323 satisfying @xmath324 and impose the conditions @xmath325 instead of @xmath326 .",
    "we can now summarise our conclusions in the following result .",
    "[ lem : suffice ] suppose we are given local solutions of for every valuation @xmath18 of @xmath2 , subject to the condition .",
    "let @xmath52 also be given .",
    "then there is a modulus @xmath301 having @xmath327 for all finite @xmath187 , and a solution @xmath328 of over @xmath329 satisfying , having the following property .",
    "let @xmath330 be integer parameters with @xmath331 .",
    "let @xmath332 and suppose that @xmath333 .",
    "if @xmath334 then any solution @xmath335 of satisfying @xmath336 and @xmath337 gives rise to a global solution of satisfying .",
    "moreover , for every finite place @xmath187 there is a solution @xmath338 of satisfying .",
    "it might help the reader at this point to say more about the rle of the parameters @xmath339 and @xmath323 .",
    "we shall think of @xmath339 as being a small fixed power of @xmath323 .",
    "when we estimate error terms in our analysis we can not afford to lose any power @xmath340 of @xmath323 , unless @xmath341 can be taken arbitrarily small . on the other hand there will be certain points in our argument where we will lose factors of @xmath342 with arbitrary small @xmath343 .",
    "this will not matter since we will make a key saving which is a power of @xmath339 , so that there is a net gain overall .    with this in mind",
    ", many of our estimates will involve factors of the type @xmath344 .",
    "these involve the standard convention that there are implicit order constants for each occurrence of the @xmath345 notation , which need not be the same on each occasion .",
    "since we are taking the degree @xmath81 of @xmath1 to be fixed , we will allow these implicit order constants to depend on @xmath81 .",
    "recalling that @xmath346 we may replace terms involving any combinations of @xmath347 and @xmath348 by @xmath344 .",
    "the number @xmath349 will be a sufficiently small positive constant , which will be fixed throughout the proof .",
    "we could have chosen to specify its value at the outset of the argument , but we feel it is more instructive merely to impose the condition that @xmath349 is sufficiently small , at various points in the proof .",
    "we are now ready to cast our problem in terms of a bilinear form .",
    "if @xmath350 is any ring it will be convenient to write @xmath351 for the set of solutions @xmath352 of the equation in which each of the vectors has coordinates lying in @xmath350 . in the light of lemma [ lem : suffice ] we introduce the counting function @xmath353 henceforth we will allow the constants implied by the notations @xmath354 , @xmath355 and @xmath345 to depend on @xmath356 which are to be regarded as fixed once and for all .    in our work we will restrict the values over which @xmath141 runs by stipulating that if @xmath357 then @xmath358 in particular it follows that @xmath359    we are now ready to specify the sets over which we will sum . in the case of the variable @xmath140",
    "there is a technical point to be dealt with in   [ app2 ] . for the time",
    "being we give ourselves independent linear forms @xmath360 whose rle will become clear later .",
    "let @xmath361 be a further parameter , tending to infinity with @xmath323 , which we assume is in the range @xmath362 .",
    "we then define the regions @xmath363 in order to interpret our counting function @xmath364 as a bilinear form , we let @xmath365 and @xmath366 for @xmath367 .",
    "lastly we define the function @xmath368 on @xmath146 . notice that @xmath369 and @xmath306 are all non - zero , whence @xmath370 and @xmath132 will be non - zero throughout @xmath371 and @xmath372 , if @xmath361 is large enough .",
    "it follows in particular that @xmath373 and @xmath279 are supported on non - zero @xmath374 and @xmath375 .",
    "we now define the bilinear form @xmath376 it is easy to check that @xmath377 whenever @xmath378 , where the implied constant is allowed to depend on the linear forms @xmath379 , a convention that we adhere to for the remainder of the paper .",
    "it now suffices to demonstrate that @xmath380 for large values of @xmath361 .",
    "note that we will ultimately take @xmath381    although we have framed @xmath382 as a bilinear form , it is not an upper bound for @xmath382 that we seek but an asymptotic formula as @xmath383 .",
    "as indicated in the introduction we will begin by extracting a main term from our expression for @xmath382 .",
    "instrumental in this will be finding a decomposition @xmath168 , for an appropriate approximation @xmath171 to @xmath158 .",
    "we will then write @xmath384 where @xmath385 is regarded as the main term and @xmath386 is the error term . the handling of @xmath387 will be executed in ",
    "[ s : bil ] and the estimation of @xmath388 will be the subject of ",
    "[ s : m ] and   [ s : ssi ] .",
    "our treatment of @xmath387 requires bounds for @xmath389 uniformly for small moduli @xmath390 and square regions @xmath350 .",
    "thus our approximation @xmath391 will have to be such that @xmath392 averages to zero over all congruence classes to small moduli .",
    "this will be achieved via a quite general procedure described in the next section .",
    "our estimate for @xmath387 will also require bounds for @xmath393 for which we have the following result .",
    "[ lem : upper - abl ] for any @xmath343 we have @xmath394 and @xmath395    since @xmath396 we will also require a bound for @xmath397 this will be established in   [ app2 ] .",
    "we conclude this section by proving lemma  [ lem : upper - abl ] .",
    "we will discuss the upper bound for the case of @xmath398 , the remaining estimates being dealt with similarly .",
    "let @xmath399 .",
    "we shall show that if @xmath400 is given , then there are @xmath401 choices of @xmath141 for which @xmath402 .",
    "we set @xmath403 , so that @xmath404 .",
    "if @xmath405 , then @xmath406 in @xmath86 , and the conjugates of @xmath407 are all @xmath408 in absolute magnitude . the number of admissible elements @xmath407 is therefore @xmath409 for any @xmath410 .",
    "if we now take @xmath411 it follows that the number of @xmath141 corresponding to a given @xmath400 is @xmath401 , as required .",
    "the fact that a given value @xmath412 is attained @xmath413 times will be used at various points in the rest of the paper without further comment .",
    "similarly , we shall use estimates @xmath413 for the number of representations of @xmath414 as @xmath415 with @xmath416 , or of @xmath417 as @xmath418 with @xmath419 .",
    "our goal now is to split @xmath167 into two parts @xmath168 , where @xmath171 is a sufficiently simple function that we can compute @xmath388 directly . moreover",
    "we will want @xmath173 to produce sufficient cancellation on average , so that a bilinear form estimation of @xmath387 can be achieved .",
    "we start by describing a general procedure for producing an approximation of the type @xmath171 . in our context",
    "@xmath160 runs over the ring @xmath147 , but we will begin by presenting the method as it applies to sequences indexed by @xmath146 , since we hope this will prove to be of independent interest .",
    "the underlying ideas are perhaps not new .",
    "in particular there are certain similar features in recent work of brdern @xcite .",
    "however we have not found anything in the literature which exactly meets our needs .",
    "we begin by supposing that we are given a sequence @xmath420 of complex numbers .",
    "we aim to show how to approximate @xmath421 locally by a function @xmath422 . by this",
    "we mean that for any congruence class @xmath423 the sum @xmath424 will be approximated by @xmath425 at least for small values of @xmath58 .",
    "naturally we can do this by merely setting @xmath426 , but we seek a function @xmath422 which is defined in terms of the density of the sequence @xmath421 in congruence classes to small moduli .",
    "as an example of what we have in mind , consider the sequence @xmath427 , where @xmath428 is the von mangoldt function .",
    "if we choose any constant @xmath429 and set @xmath430 with @xmath431 , then @xmath432 uniformly for @xmath433 , for all residue classes @xmath434 .",
    "this result follows from heath - brown ( * ? ? ?",
    "* lemma  1 ) .",
    "we first introduce our fundamental hypotheses .",
    "we assume that we have an arithmetic function @xmath435 and a `` smooth '' function @xmath436 , together with a bound @xmath437 such that @xmath438 with @xmath439 for all residue classes @xmath76 to moduli @xmath440 .",
    "we observe that @xmath441 for all @xmath442 , and we therefore impose the natural condition that @xmath443 for all @xmath442 . since we can always re - scale the functions @xmath407 and @xmath444 in there is no loss in generality in assuming that @xmath445 although it is not necessary in general , it will prove convenient to assume that @xmath446 for all pairs @xmath447 .",
    "we will also require a smoothness condition on the function @xmath436 , which we formulate as the bound @xmath448 for all residue classes @xmath76 to moduli @xmath449 .",
    "our choice for @xmath422 will be motivated by the treatment of major arcs in the circle method . if we consider the exponential sum @xmath450 then when @xmath451 is close to @xmath452 one would use the major - arc approximation @xmath453 when @xmath451 is not close to @xmath452 the above expression tends to be small .",
    "hence it is reasonable to approximate @xmath454 by @xmath455 for all real @xmath451 . picking out the coefficient of @xmath456 in the above expression",
    "we are therefore led to suggest the choice @xmath457    we proceed to investigate the sum @xmath458 with @xmath433 .",
    "we have @xmath459 the final sum over @xmath423 is a ramanujan sum , for which the standard evaluation as @xmath460 produces @xmath461 the simultaneous congruences @xmath462 and @xmath463 are only soluble if @xmath464 divides @xmath465 , in which case there is a unique solution @xmath466})}$ ] say . thus if @xmath467 our hypothesis shows that @xmath468 with @xmath469}\\ ] ] and @xmath470 in view of and we have @xmath471 whence the crude bound @xmath472 yields",
    "@xmath473    turning to the main term @xmath170 we observe in general that @xmath474 } & = h^{-1}{\\sum_{\\substack{d\\mid q\\\\#2}}}\\mu(q / d)(d , h)\\\\ & = h^{-1}\\sum_{d\\mid q}\\mu(q / d)\\sum_{e\\mid d , h , k}e\\sum_{f\\mid d / e , h / e}\\mu(f)\\\\ & = h^{-1}\\sum_{e\\mid q , h , k}e\\sum_{f\\mid q / e , h / e}\\mu(f ) { \\sum_{\\substack{d\\mid q\\\\#2}}}\\mu(q / d)\\\\ & = h^{-1}\\sum_{e\\mid q , h , k}e\\sum_{f\\mid q / e , h / e}\\mu(f ) \\sum_{g\\mid q/(ef)}\\mu\\left(\\frac{q/(ef)}{g}\\right).\\end{aligned}\\ ] ] the final sum vanishes unless @xmath475 , in which case we must have @xmath476 .",
    "it then follows that @xmath474 } & = h^{-1}\\sum_{e\\mid q , k}e\\mu(q / e)\\\\ & = h^{-1}{\\sum_{\\substack{a{\\,(\\operatorname{mod } { q})}\\\\#2}}}e_q(ak).\\end{aligned}\\ ] ] inserting this result into our formula for the main term @xmath170 , we see that @xmath477 using we have @xmath478 whence @xmath479 as @xmath58 runs over divisors of @xmath390 , and @xmath76 runs over residue classes coprime to @xmath58 , the fractions @xmath452 run over the entire set @xmath480 we therefore deduce that @xmath481 since the summation over @xmath81 produces the value @xmath390 when @xmath482 , and the value @xmath483 otherwise .    in view of we",
    "may now summarise our results as follows .",
    "[ mainapp ] with the above assumptions we have @xmath484 for all @xmath433 and all residue classes",
    "@xmath485 modulo @xmath390 .",
    "thus @xmath422 approximates @xmath421 well , in congruence classes to small moduli",
    ". it may be instructive to consider the effect of this procedure on the sequence @xmath427 that we discussed earlier .",
    "taking @xmath486 we readily deduce from the siegel  walfisz theorem that for any @xmath487 there exists a constant @xmath488 such that @xmath489 uniformly for @xmath490 .",
    "on taking @xmath491 we see that @xmath492 is admissible in .",
    "since @xmath493 in , the approximation in is a trivial consequence of lemma [ mainapp ] with @xmath494 for @xmath490 .    in applications it may be important to know about the size of @xmath422 , and we therefore investigate the mean square @xmath495 if we write @xmath496 then @xmath497 thus , if we assume that @xmath498 for all @xmath499 , then the dual large sieve produces @xmath500 in view of we have @xmath501 with @xmath502 it follows that @xmath503 , and hence that @xmath504 we now apply the standard large sieve to deduce that @xmath505 we express this result formally in the following lemma",
    ".    [ l2 ] we have @xmath506 moreover @xmath507 providing that @xmath508 .",
    "thus under suitable circumstances the @xmath509-norm of @xmath422 will have order of magnitude bounded by the @xmath509-norm of @xmath421 .",
    "having described the situation for sequences @xmath421 indexed by @xmath146 we return to our original problem , in which we have a sequence @xmath167 with @xmath160 running over @xmath147 .",
    "we will describe the situation as it applies to a quite general function @xmath451 , and only later , in ",
    "[ app2 ] , restrict to the function .",
    "we shall consider sums in which @xmath160 runs over a region @xmath350 , say , and lies in a congruence class @xmath510 , where @xmath511 and @xmath512 .",
    "we therefore set @xmath513 and @xmath514 and assume that we have functions @xmath515 and @xmath516 such that @xmath515 is non - negative and @xmath517 for @xmath440 , with @xmath437 and @xmath518 as before we will assume that @xmath519 and @xmath520 finally , we shall suppose that @xmath521 for all residue classes @xmath162 to moduli @xmath449 .    in order to define @xmath171",
    "we will need an analogue of the coprimality condition @xmath522 which occurs in .",
    "it turns out that the correct generalisation is to require that there is no non - trivial common divisor of @xmath162 and @xmath58 in @xmath523 .",
    "of course this is not the same as requiring @xmath524 in @xmath147 .",
    "we write @xmath525 to denote a sum in which @xmath511 runs over residue classes modulo @xmath58 such that @xmath162 and @xmath58 have no non - trivial common divisor in @xmath523 .",
    "we also need an analogue for the exponential function @xmath526 . recall that @xmath145 is a @xmath146-basis for @xmath147 , and hence also a @xmath2-basis for @xmath82 . if @xmath527 , with @xmath528 , and if @xmath512 , we define @xmath529 these exponential functions have the property that if @xmath511 then @xmath530 thus , for the analogue of the ramanujan sum we have @xmath531    we are now ready to specify our approximation to @xmath167 .",
    "we set @xmath532 an argument precisely analogous to that used for lemma [ mainapp ] then produces the following result .",
    "[ mainapp2 ] with the above assumptions we have @xmath533 for all @xmath433 and all residue classes",
    "@xmath534 modulo @xmath390 .    to produce an analogue of lemma [ l2 ]",
    "we shall assume that @xmath535 for certain @xmath536 .",
    "then we will have a large sieve inequality for @xmath147 , taking the form @xmath537 this follows from the two dimensional large sieve of huxley ( * ? ? ?",
    "* theorem  1 ) . under the condition that @xmath538 , which we now impose , we will then have @xmath539 . we proceed to argue as before to deduce from the dual of the above estimate that @xmath540 with @xmath541 this time the estimate yields @xmath542 with @xmath543 continuing as before we then obtain @xmath544 this gives us the following conclusion .",
    "[ l22 ] suppose that @xmath535 for certain @xmath536 , and assume that there is a constant @xmath545 such that @xmath546 for all @xmath547 .",
    "then @xmath548 providing that @xmath538 and @xmath549 .",
    "in this section we will apply lemmas [ mainapp2 ] and [ l22 ] to the function .",
    "it will be important for us to produce functions @xmath552 and @xmath444 which depend only on the set @xmath553 , and not on the set @xmath350 , since we require results which are uniform in @xmath350 .",
    "we will write @xmath554 in the form @xmath555 with @xmath556 .",
    "we shall also write @xmath557 as @xmath558 . the reader should observe that this notation does not coincide with that used temporarily in , nor that used in our discussion of .",
    "we let @xmath350 be a square in the @xmath559-plane , with sides parallel to the @xmath560 and @xmath561 axes , and side - length @xmath562 .",
    "this corresponds , by abuse of notation , to the square @xmath350 used in defining the sums @xmath563 in . extending this abuse of notation",
    "we shall allow @xmath557 to denote the ordered pair @xmath564 .",
    "we will specify the function @xmath565 and verify its properties at the end of this section .",
    "for the time being we content ourselves with describing the key features as follows .",
    "[ omegaprops ] there is a continuously differentiable function @xmath566 , depending on @xmath553 , for which @xmath567 for all @xmath568 , and such that @xmath569 for every square @xmath350 as above .",
    "furthermore @xmath444 is supported on a disc of radius @xmath570 and satisfies @xmath571 throughout this disc .",
    "moreover there is a disc of radius @xmath572 around the point @xmath573 on which we have @xmath574 .",
    "although it is a real measure which occurs on the right - hand - side of what occurs naturally for us is the corresponding cardinality @xmath575 we proceed to establish a relation between the two . for each @xmath576",
    "we let @xmath577 and @xmath578 thus @xmath579 , and the number of integer vectors in @xmath553 but not @xmath580 is @xmath581 . in particular , @xmath582 now if @xmath583 and @xmath584 then @xmath585 .",
    "thus there are squares @xmath586 and @xmath587 of sides @xmath588 and @xmath589 respectively , such that @xmath590 whenever @xmath584 .",
    "we deduce that @xmath591 and @xmath592 however @xmath580 is contained in @xmath553 and differs from it by a set of measure @xmath581 , whence @xmath593 and @xmath594 according to we may then deduce that @xmath595 and @xmath596 however the squares @xmath586 and @xmath587 each differ from @xmath350 by a set of measure @xmath581 , and furthermore @xmath597 .",
    "thus @xmath598 finally , if we compare this with , we deduce that @xmath599    we next consider @xmath600 to each point @xmath106 counted in the above sum we associate the square @xmath601 . if @xmath602 then @xmath603 by lemma  [ omegaprops ] , whence @xmath604 we sum this for points @xmath605 with @xmath606 .",
    "since there are @xmath607 such points if @xmath608 we deduce that @xmath609 the union of the squares @xmath610 will be a square @xmath611 say , whose sides are within a distance @xmath58 of the sides of @xmath350 .",
    "thus @xmath350 and @xmath611 differ by a set of measure @xmath612 , if @xmath608 . since @xmath613 for all @xmath614 this produces @xmath615 comparing this with we therefore obtain @xmath616 providing that @xmath617 and @xmath618 .",
    "in particular , when @xmath619 we obtain @xmath620 so that holds with @xmath621 and any @xmath622 .",
    "we next consider the condition . in view of the definition",
    "we see that @xmath623})},\\ , \\delta{\\mathbf{n}}_{k / l}({\\mathbf{u}})\\in r\\},\\ ] ] where @xmath132 runs over vectors modulo @xmath624 $ ] for which @xmath625 and @xmath626 . for a general modulus @xmath627",
    "we proceed to compare the sizes of the sets @xmath628 for the values @xmath629 and @xmath630 . for @xmath631 let @xmath632,\\ldots , r[u_n / r]).\\ ] ] if @xmath633 then @xmath634 will belong to @xmath635 unless either @xmath140 is within a distance @xmath636 of the boundary of @xmath553 , or @xmath637 is within a distance @xmath638 of the boundary of @xmath350 .",
    "a pair @xmath639 arises at most @xmath640 times as a value of @xmath641 with @xmath642 , and hence it follows that @xmath643 for any @xmath343 .",
    "if we now sum for all @xmath644 we deduce that @xmath645 and hence that @xmath646 substituting this back into we deduce that @xmath647 we therefore see that @xmath648 with @xmath649^{n}}\\#\\left\\{\\mathbf{s}{\\,(\\operatorname{mod } { [ m , q]})}:~ \\begin{array}{l } \\mathbf{s}\\equiv{\\mathbf{u}}^{(m)}{\\,(\\operatorname{mod } { m})},\\\\ \\delta{\\mathbf{n}}_{k / l}(\\mathbf{s})\\equiv y{\\,(\\operatorname{mod } { q } ) } \\end{array}\\right\\}.\\ ] ] the conditions and are now readily checked , and we see that follows from with @xmath650 .    we are now ready to apply lemma [ mainapp2 ] , which produces the following result .    [ mainapp3 ]",
    "let @xmath350 be a square with side @xmath651 satisfying @xmath652 . then if @xmath349 is any positive constant we have @xmath653 for all @xmath654 and all @xmath510 .    in our application the square @xmath350 will vary and so it is crucial that lemma [ mainapp3 ] is uniform in squares of side length @xmath570 . as to lemma [ l22 ]",
    ", we will only need a result for the @xmath655-norm taken over all @xmath160 .",
    "hence we choose @xmath350 to be a square centred at the origin and with side @xmath656 , in which the constant @xmath75 is taken sufficiently large that @xmath547 whenever @xmath657 .",
    "we may clearly take @xmath658 by lemma [ omegaprops ] and @xmath659 by lemma [ lem : upper - abl ] .",
    "our remaining task is thus to estimate @xmath179 from below .",
    "however our choice of @xmath350 ensures that @xmath660 , whence yields @xmath661 , assuming that @xmath662 , say . consequently we deduce from lemma [ l22 ] the following bound .",
    "[ l23 ] for any constant @xmath343 we have @xmath663 providing that @xmath664 and @xmath662 .",
    "moreover we then have @xmath665    the final estimate follows immediately from lemma [ lem : upper - abl ] , since @xmath666    we end this section by proving lemma [ omegaprops ] .",
    "we first show that the map from @xmath667 to @xmath668 given by @xmath669 is non - singular at any point for which @xmath670 , by which we mean that @xmath671 and @xmath672 are only proportional if @xmath673 .",
    "clearly it suffices to do the same for the map @xmath674 however @xmath675 ( respectively , @xmath676 ) is a product of @xmath677 ( respectively , @xmath678 ) with certain conjugates of @xmath679 .",
    "thus we can write our map in the form @xmath680 with suitable linear forms @xmath681 , which will be linearly independent .",
    "hence if we set @xmath682 for @xmath683 it will suffice to show that the map @xmath684 is non - singular whenever @xmath685 .",
    "this however is trivial .    since @xmath686",
    ", we deduce that there are indices @xmath687 and @xmath688 such that @xmath689 we suppose for notational simplicity that @xmath690 and @xmath691 , the other cases being similar . by continuity",
    "we then have @xmath692 throughout @xmath553 , if @xmath361 is large enough .",
    "we now write @xmath693 and @xmath694 , where @xmath695",
    ". we will find it convenient to number the entries in @xmath132 as @xmath696 . by the implicit function theorem ,",
    "if @xmath697 with @xmath698 , we can express @xmath141 in terms of @xmath106 and @xmath132 as @xmath699 .",
    "we may now calculate that @xmath700 where @xmath701 we therefore define @xmath702 so that immediately follows .",
    "it is clear from the definition of @xmath703 that @xmath444 is supported on the set of values @xmath637 as @xmath140 runs over @xmath553 .",
    "thus the support is contained in a disc of radius @xmath570 as claimed in the lemma .",
    "moreover @xmath704 whence yields @xmath571 as required .    the function @xmath705 will be continuously differentiable with respect to @xmath106 and @xmath132",
    ". moreover it will be weighted - homogeneous of degree 1 in @xmath132 and degree @xmath706 in @xmath106 . since @xmath707 for @xmath708 we deduce from that @xmath709 we observe from that @xmath710 does not vanish , whence @xmath711 for at least one of @xmath712 or @xmath691 .",
    "moreover @xmath713 for @xmath714 , whence @xmath715 thus at least one of @xmath716 and @xmath717 is non - vanishing at @xmath319 .",
    "we suppose that @xmath718 , the alternative case being similar . by continuity",
    "we then have @xmath719 for @xmath720 , if @xmath361 is large enough .",
    "it follows that @xmath721 throughout @xmath553 , since the partial derivative is homogeneous in @xmath132 , of weight zero .",
    "we can now investigate @xmath722 .",
    "on @xmath723 we have @xmath724 by .",
    "moreover @xmath725 is a form in @xmath140 of degree @xmath726 .",
    "it then follows from that @xmath727 on @xmath728 .",
    "we therefore see from that the contribution to @xmath722 from the set @xmath728 will be @xmath729 .",
    "this is satisfactory .    on the remaining range we merely use the bound @xmath730 .",
    "it therefore suffices to estimate the measure of the set of @xmath731 for which either @xmath732 or @xmath733 , but not both . by substituting @xmath734 and @xmath735 if necessary , we may suppose that @xmath733 and @xmath736 .",
    "in view of this means that @xmath737 lies in @xmath553 at a distance @xmath738 from the boundary of @xmath553 .",
    "let @xmath739 denote the set of such points @xmath132 .",
    "as yet we have not completely specified the set @xmath553 in , and it is now time to do so . for indices @xmath740",
    "we merely choose @xmath741 .",
    "then if @xmath737 lies in @xmath553 at a distance @xmath738 from the edge defined by @xmath742 we see that the corresponding @xmath743 runs over an interval of length @xmath738 , so that the contribution to @xmath744 is @xmath745 .",
    "we take the remaining linear forms @xmath742 to be @xmath746 and @xmath747 . here",
    "@xmath279 is a non - zero constant chosen sufficiently small that @xmath748 throughout @xmath553 . in view of such a choice",
    "will be possible , since we have @xmath749 .",
    "suppose now that @xmath750 are fixed .",
    "then if @xmath737 lies in @xmath553 at a distance @xmath738 from the edge defined by the linear form @xmath751 we see that @xmath752 is confined to an interval of length @xmath738 , and similarly for the edge defined by @xmath753 .",
    "it follows that the contribution to @xmath744 is @xmath754 in these cases too .",
    "since @xmath730 we deduce that @xmath755 as required .",
    "it remains to establish the lower bound for @xmath756 .",
    "it is clear that @xmath757 is homogeneous of degree @xmath726 , whence @xmath758 for all relevant @xmath140 . in view of it",
    "therefore suffices to show that @xmath759 on a suitable set of values @xmath106 .",
    "now @xmath760 moreover if @xmath761 and @xmath762 then @xmath763 by the homogeneity properties of @xmath705 .",
    "we therefore see from the definition of @xmath553 that there is a small constant @xmath764 such that @xmath733 whenever we have @xmath765 for @xmath766 and @xmath767 we therefore have @xmath759 in the above region , as required .",
    "from lemma [ mainapp3 ] we know that @xmath551 is evenly distributed in all congruence classes for moduli @xmath440 .",
    "the condition that @xmath622 causes no problems .",
    "however a more serious constraint on the size of @xmath768 comes from the fact that we can not handle @xmath391 if @xmath768 is too large .",
    "the goal of the present section is to show that in fact @xmath392 is evenly distribution for `` almost all '' congruence classes , for much larger values of @xmath58 .",
    "this will enable us to get equidistribution for large moduli , on average , while keeping @xmath768 sufficiently small that @xmath391 can be adequately handled .",
    "our equidistribution result will be achieved by a quite general large sieve argument , motivated by ( but , we believe , simpler than ) that used by fouvry and iwaniec @xcite .",
    "a related procedure is given by iwaniec and kowalski ( * ? ? ? * theorem  17.5 ) .",
    "however we have found it more convenient to use additive characters directly , rather than to switch to multiplicative ones as they do .",
    "the reader might care to note that a somewhat different argument , also of a very general kind , appears in heath - brown @xcite .",
    "we assume that we have a function @xmath551 defined on @xmath147 , satisfying @xmath769 for all @xmath440 and @xmath511 , where @xmath350 is a square of side @xmath770 as in lemma [ l22 ] .",
    "for the duration of this section let us write @xmath771 for any square @xmath179 .",
    "we proceed to consider @xmath772 if @xmath773 for @xmath774 then @xmath775 and we deduce that @xmath776 we now write the fraction @xmath777 in lowest terms as @xmath778 , say .",
    "then @xmath779 the contribution from terms @xmath780 is at most @xmath781 by the two dimensional large sieve in the form .",
    "for the remaining terms with @xmath433 we observe that @xmath782 by our assumption .",
    "thus terms with @xmath433 contribute at most @xmath783 to @xmath784 .",
    "this enables us to conclude as follows .",
    "[ ls2 ] under the assumption we have @xmath785    we will require a form of this estimate in which we have a maximum over different squares @xmath350 .",
    "we assume that @xmath551 is supported on a set @xmath786 ^ 2\\}\\ ] ] and proceed to cover this with @xmath787 smaller squares , each contained in @xmath179 and of the type @xmath788 ^ 2\\},\\ ] ] for appropriate pairs @xmath789 . here",
    "@xmath790 is a positive integer parameter which we will specify in due course .",
    "now any square @xmath791 , with sides aligned with the coordinate axes , will include a union of certain of the squares @xmath792 , outside which there are only @xmath793 points of @xmath147 .",
    "if we now require that @xmath794 thus if @xmath795 then @xmath796 lemma [ ls2 ] then yields @xmath797 since @xmath798 we deduce that @xmath799 we now choose @xmath800 , which yields the following conclusion .    [ ls3 ] under the assumptions and we have @xmath801 providing that @xmath802 .",
    "we apply this last result to our particular situation . in view of the conditions in lemmas  [ mainapp3 ] and [ l23 ] we take @xmath28 of order @xmath803 , @xmath664 and @xmath662 , so that the value @xmath804 is admissible . in order to estimate @xmath551",
    "we note that @xmath805 for any @xmath343 .",
    "moreover yields @xmath806 , since and imply @xmath807 since @xmath808 by lemma [ omegaprops ] , we will certainly have @xmath809 . taking @xmath810 ,",
    "the right hand side in lemma [ ls3 ] is therefore @xmath811 by lemma [ l23 ] .",
    "this enables us to conclude as follows .",
    "[ ls4 ] if @xmath812 and @xmath662 , then @xmath813 for any @xmath343 .",
    "we end by establishing a trivial bound for the above sum , which provides an instructive comparison . if @xmath814 then @xmath815 whence @xmath816 we therefore obtain the trivial bound @xmath817 via lemma [ l23 ] .",
    "thus lemma [ ls4 ] provides a saving which is a power of @xmath768 , providing that @xmath768 is larger than a suitable power of @xmath818 .",
    "the estimation of bilinear forms is one of the cornerstones of analytic number theory and can be traced back to the work of vinogradov . given finite sequences @xmath819 and a matrix @xmath820 of complex numbers , the essential problem is to estimate the double sum @xmath821 the standard procedure is to use cauchy s inequality to remove the dependence on @xmath822 .",
    "this gives @xmath823 for the second term on the right one expands the square and reverses the order of summation , so as to use suitable information about the sum @xmath824 it may happen that the sum itself is small .",
    "in other cases one can give an asymptotic evaluation with a main term @xmath825 say .",
    "one may then complete the analysis via an estimation of the sum @xmath826    in our work we will require an analogue of this procedure for sequences indexed by elements of @xmath827 , rather than by @xmath146 . in this endeavour",
    "we are inspired by the analytic machinery developed for the gaussian integers @xmath828 $ ] by fouvry and iwaniec @xcite .",
    "we will provide a completely self - contained account of the method , which has the advantage of being slightly more general in scope .",
    "let @xmath829 and let @xmath830 be arbitrary functions with finite @xmath509-norms @xmath831 be such that @xmath832 is also finite .",
    "our objective is to estimate the double sum @xmath833 where @xmath834 indicates that the summation over @xmath131 is restricted by the condition @xmath835 .    in the analysis of this section",
    "the implied constants in our @xmath345 and @xmath354 notation will be allowed to depend implicitly on the coefficients of the matrix @xmath836 .",
    "however they will be uniform in all other parameters",
    ". it will be convenient to introduce a norm on elements @xmath837 via @xmath838 .",
    "we should observe that this particular choice of norm is important , since it will be significant for us that the unit ball is a square .",
    "let @xmath839 with @xmath840 .",
    "we will think of @xmath841 and @xmath842 as being large , with @xmath843 also large , but of considerably smaller order than @xmath842 .",
    "we will suppose that @xmath844 are supported on the sets @xmath845 respectively .",
    "let @xmath846 denote the maximum of the moduli of the entries of @xmath836 , and let @xmath847 we now define @xmath848 and we observe that @xmath849 whenever @xmath850 .",
    "an application of cauchy s inequality now gives @xmath851 enlarging the range of summation for @xmath131 we therefore deduce that @xmath852 where @xmath853 opening up the inner sum we obtain @xmath854 with @xmath855    the vectors @xmath131 take the form @xmath856 where @xmath857 is primitive , and where @xmath858 is a positive integer . since @xmath859 , we see that the general solution of the linear equation @xmath860 is @xmath861 for @xmath862 . hence @xmath863 where @xmath864 denotes summation for primitive vectors @xmath865 .",
    "we note that cauchy s inequality yields @xmath866 for any @xmath867 .",
    "thus the contribution to the above sum from terms with @xmath868 is @xmath869 , whence @xmath870 with @xmath871 we now use the mbius function to pick out the condition @xmath872 , giving @xmath873 where @xmath874    for @xmath875 we deduce that @xmath876 moreover we will have @xmath877 unless @xmath878 . thus we can restrict the summation over @xmath75 to the range @xmath879 say .",
    "we may now handle certain ranges of @xmath485 and @xmath75 trivially . to this end",
    "we give ourselves a parameter @xmath880 which we will choose in due course . in view of the number of available vectors @xmath881 , corresponding to a particular triple @xmath882 is @xmath883 .",
    "since @xmath866 we deduce that the contribution to @xmath884 from @xmath885 is @xmath886 similarly the contribution from @xmath887 is @xmath888    it follows that @xmath889 combining this with and therefore leads to the conclusion that @xmath890 for any @xmath891 and @xmath880 , with @xmath892    we now open up the convolution @xmath893 to obtain @xmath894 where @xmath895 thus @xmath896 where @xmath350 now runs over all squares with sides aligned to the axes .",
    "it follows from cauchy s inequality that @xmath897 with @xmath898 if we insist that @xmath899 then @xmath900 , whence @xmath901 hence , if @xmath902 denotes the usual divisor function , and we set @xmath903 a further application of cauchy s inequality yields @xmath904 we may now conclude as follows .",
    "[ lem : bil ] let @xmath905 and define @xmath906 .",
    "let @xmath830 be functions supported on the sets , and let @xmath907 .",
    "define @xmath908 and @xmath909 as in and .",
    "then for any @xmath880 we have @xmath910 with @xmath911    before preceding further it may be helpful to comment on the above estimate .",
    "for the purposes of this illustration we shall suppose that @xmath1 is chosen so that @xmath912 if we merely estimate @xmath913 via cauchy s inequality , using the fact that @xmath914 has @xmath915 solutions @xmath916 for each given @xmath417 , we are led to a trivial bound @xmath917 hence the first term in the above lemma saves at least @xmath918 .",
    "similarly the second term saves at least @xmath919 .",
    "both these are at least @xmath920 . to analyse the third term we use the argument in to deduce that @xmath921 for @xmath922 .",
    "we therefore obtain the trivial bound @xmath923 for comparison , in order for the third term in lemma [ lem : bil ] to produce a comparable saving to that in the first two terms , one would wish to replace the above by @xmath924 say .",
    "the type of saving we require is exactly that given by lemma [ ls4 ] , providing that we work with @xmath925 .",
    "we now show how lemma [ lem : bil ] can be applied to estimate @xmath926 when @xmath927 .",
    "we have yet to specify the parameter @xmath768 used in the definition of @xmath391 , but we shall do this shortly . under suitable hypotheses we will see in   [ s : m ] and   [ s : ssi ] that the main term @xmath388 has order at least @xmath928 .",
    "our goal is to show that @xmath387 is smaller than this by at least a power of @xmath339 .    if @xmath929 and @xmath930 , then @xmath931 , where @xmath932 by abuse of notation we will write @xmath933 and @xmath934 . from our definitions of @xmath935 and @xmath444 in , and we see that if @xmath936 then @xmath937 for some @xmath416",
    "moreover , from we deduce that @xmath938 as @xmath939 . since @xmath940 it follows that @xmath941 is supported on a suitable set @xmath942 with @xmath943 for a certain constant @xmath944 .",
    "we may analyse the support of @xmath398 similarly .",
    "since @xmath945 we deduce that @xmath946 is supported on a set @xmath947 with @xmath948 for a suitable positive constant @xmath949 .",
    "moreover , @xmath950 is also supported on vectors @xmath131 with @xmath951 , by .",
    "we may therefore take @xmath952 of order @xmath953 .",
    "estimates for @xmath954 and @xmath955 are given by lemma [ lem : upper - abl ] , while lemma [ l23 ] handles @xmath956 .",
    "inserting these bounds into lemma [ lem : bil ] and adopting the assumption , together with the bounds @xmath664 and @xmath662 , we then see that @xmath957 and @xmath958 so that @xmath959    we now apply lemma [ ls4 ] , along with the bounds @xmath960 and @xmath961 , to deduce that @xmath962 providing that @xmath963 note that when @xmath964 the condition @xmath662 is automatic for large @xmath323 .",
    "moreover , if @xmath965 then we automatically have @xmath664 , if @xmath349 is small enough .",
    "thus , on recalling that @xmath966 and @xmath967 , we deduce that @xmath968 it is now apparent that we should take @xmath969 , which will satisfy and if @xmath970 and @xmath971 .",
    "we conclude as follows .",
    "[ lem : treat_e ] let @xmath927 and assume that @xmath972 then we have @xmath973",
    "the purpose of this section and the next is to produce a satisfactory estimate for the sum @xmath974 as @xmath383 , where @xmath391 is the approximation to @xmath975 which we constructed in .",
    "our goal will be to demonstrate that @xmath170 has order @xmath976 , which simple heuristics suggest to be the expected size of @xmath382 .",
    "in fact we will fall a little short of this , showing that @xmath977 when suitable constraints are placed on the parameters @xmath978 and @xmath323 .",
    "let @xmath979 where @xmath980 are given by . opening up the functions @xmath981 and @xmath982 from and , respectively",
    ", we find that @xmath983 say .",
    "recall that @xmath984 where @xmath145 is a @xmath146-basis for @xmath147 .",
    "it will be convenient to make the observation that @xmath985 which is a non - zero integer . by enlarging the weak approximation set @xmath179 in theorem [ thmain -",
    "a ] , if necessary , we may clearly assume that @xmath986 contains any prime divisors of @xmath987 .",
    "we now set in motion our analysis of @xmath988 , for given @xmath989 and @xmath990 .",
    "suppose that @xmath991 decomposes as @xmath992 , for suitable forms @xmath993 of degree @xmath199 .",
    "then demands that that @xmath994 and @xmath995 be coprime .",
    "moreover , in view of and our convention that @xmath87 in the integral basis @xmath996 for @xmath1 over @xmath2 , it is clear that @xmath997 let us write @xmath929 .",
    "the constraint in the @xmath160 summation is equivalent to @xmath998 for integers @xmath999 such that @xmath1000 in order to analyse @xmath988 we will need to recall the expression for @xmath171 . let the function @xmath565 be given by , with key properties as in lemma  [ omegaprops ] .",
    "then for any parameter @xmath1001 and @xmath1002 we have @xmath1003 where @xmath1004 is given by and the notation @xmath1005 means that the sum is taken over @xmath1006 , with @xmath1007 such that @xmath1008 .",
    "define @xmath1009 for @xmath1010 .",
    "it is clear from that @xmath1011 . inserting our expression for @xmath550 and breaking the inner sum into congruence classes modulo @xmath58",
    ", we see that @xmath1012 where @xmath1013    we proceed to investigate the summation conditions on @xmath160 .",
    "we first prove that @xmath1014 and @xmath1015 are not both zero , that @xmath485 is non - zero , and that @xmath1016 in particular @xmath1017 .    to establish the claim we observe that @xmath1018 is a common divisor of @xmath1019 and @xmath1020 however @xmath141 and @xmath132 are in the regions with @xmath1021 and @xmath1022 non - zero .",
    "thus if @xmath361 is large enough we will have @xmath991 and @xmath1023 non - zero .",
    "hence @xmath485 will be non - zero and similarly , since @xmath1024 , the numbers @xmath1014 and @xmath1015 can not both be zero .",
    "we also see that @xmath1025 since @xmath1026 and @xmath1027 for any prime divisor @xmath56 of @xmath987 , the claim readily follows .",
    "we now write @xmath1028 for @xmath1029 , and @xmath1030 , so that the first condition on @xmath160 becomes @xmath1031 .",
    "thus the sum will be empty unless @xmath1032 , as we now assume . for future use",
    "we note that this is equivalent to demanding that @xmath1033 we may therefore write @xmath1034 for some @xmath1035 . then , if we take @xmath1036 , the summation conditions on @xmath160 translate into the requirement that @xmath1037 . since @xmath1038 is coprime to @xmath1039 we can find integers @xmath1040 such that @xmath1041 .",
    "we then have @xmath1042 , so that @xmath1043 and @xmath1044 for some integer @xmath1045 .",
    "it follows that the summation conditions @xmath1046 and @xmath1047 are satisfied if and only if @xmath560 and @xmath561 take the forms @xmath1048 and @xmath1049 respectively .",
    "our conclusion is therefore that @xmath1050 if ( [ eq : rcond ] ) holds , where @xmath1051    we would now like to replace the discrete summation over @xmath1045 by a continuous integral . for this",
    "a relatively crude approach is available to us through lemma  [ omegaprops ] . thus if @xmath1052 $ ] it follows that @xmath1053 moreover lemma [ omegaprops ] tells us that @xmath444 is supported on a disc of radius @xmath570",
    ", whence @xmath1054 is supported on an interval with length @xmath1055 .",
    "recalling that @xmath1056 in lemma [ lem : suffice ] and @xmath1057 , this therefore produces the conclusion @xmath1058 assuming that @xmath1059 the change of variables @xmath1060 now yields @xmath1061 for @xmath1062 satisfying , with @xmath1063 here @xmath999 depend on @xmath141 and @xmath132 and are given by . if @xmath1064 we reverse the rles of @xmath1014 and @xmath1015 to produce an integral involving @xmath1065 .",
    "recall the estimate @xmath1011 that we recorded above . inserting our estimate for @xmath1066 into that for @xmath988",
    ", it now follows that @xmath1067 we now sum both sides over all @xmath1068 and @xmath1069 on observing that @xmath1070 and @xmath1071 , we see that the overall contribution from the error term is @xmath1072 this will be satisfactory if @xmath768 is sufficiently small compared to @xmath339 .",
    "our work so far has shown that @xmath1073 where @xmath1074 are given by , and @xmath1075    opening up , we find that @xmath1076 we have seen that the condition can be written @xmath1032 , for non - zero integers @xmath1077 such that @xmath1078 . the inner sum is a ramanujan sum and thus it follows from , combined with , that @xmath1079 let @xmath1080 .",
    "writing @xmath1081 for @xmath1082 and @xmath1083 we see that the sum over @xmath1062 is equal to @xmath1084 where @xmath1085 .",
    "since @xmath1038 and @xmath1039 are coprime it follows that there are precisely @xmath1086 possibilities for @xmath1087 the definition of @xmath1088 therefore reveals that @xmath1089^n }   \\#\\left\\{{{\\bf s}}{\\,(\\operatorname{mod } { [ m , u]})}:~ \\begin{array}{l } { { \\bf s}}\\equiv{\\mathbf{u}}^{(m)}{\\,(\\operatorname{mod } { m})},\\\\ 2^{-\\kappa}f({\\mathbf{v}};{\\mathbf{w}};{{\\bf s } } ) \\equiv 0{\\,(\\operatorname{mod } { u } ) } \\end{array}\\right\\},\\ ] ] where @xmath1090 this is the polynomial that underpins the variety introduced in .    we proceed to insert this expression for @xmath1091 into .",
    "we will use the mbius function to remove the coprimality condition , which is implicit in the definition of @xmath1092 .",
    "we therefore arrive at the estimate @xmath1093^n }   \\sum_{\\substack{{{\\bf s}}{\\,(\\operatorname{mod } { [ m , u]})}\\\\ { { \\bf s}}\\equiv{\\mathbf{u}}^{(m)}{\\,(\\operatorname{mod } { m } ) } } } \\\\ & \\times \\sum_{\\substack{({\\mathbf{v}},{\\mathbf{w}})\\in { \\mathcal{v}}_2\\times { \\mathcal{w}}_1\\\\ 2^{-\\kappa}f({\\mathbf{v}};{\\mathbf{w}};{{\\bf s } } ) \\equiv 0{\\,(\\operatorname{mod } { u})}}}i({\\mathbf{v}},{\\mathbf{w } } ) + o\\left(q^6h^{n/2}v^{2n}\\right ) , \\end{split}\\ ] ] where @xmath1094 is given by and @xmath1095 is defined as for @xmath1092 , but with the condition replaced by @xmath1096 .",
    "this latter condition is taken componentwise as @xmath1097 and @xmath1098 , in the usual way .",
    "the sum over @xmath7 is empty when @xmath1099 so that we only need consider values @xmath1100 .",
    "however we need to reduce this range further .",
    "since @xmath1101 it follows from and the definition of @xmath1102 that @xmath1103 the integration in is therefore over an interval of length @xmath1104 , by lemma  [ omegaprops ] . a second application of lemma  [ omegaprops ] to bound the size of @xmath444 now yields",
    "@xmath1105 hence there is an absolute constant @xmath764 such that the overall contribution to @xmath170 from terms with @xmath1106 is @xmath1107 where @xmath1108 clearly @xmath1109 whenever @xmath1096 , whence latexmath:[\\[m_k(x){\\leqslant}\\sum_{\\substack { n\\ll x^n\\\\ k^2\\mid n } } \\#\\{{\\mathbf{v}}\\in { \\mathbb{z}}^n :    the overall contribution to the main term from @xmath1106 is therefore seen to be @xmath1111 this allows us to truncate the summation over @xmath7 in with acceptable error .",
    "we now replace the sum over @xmath1112 in by one in which the variable runs modulo @xmath1113 $ ] .",
    "this has the effect of multiplying it by @xmath1114^{-n}[m , u]^n$ ] .",
    "we may therefore summarise our findings in the following result .",
    "[ lem : stage1 ] let @xmath880 and let @xmath1115 be given by .",
    "then we have @xmath1116 where @xmath1117 $ ] and @xmath1118 here @xmath1119 is given by , @xmath1120 is given by and @xmath1095 is defined as for @xmath1092 in , but with replaced by @xmath1096 .",
    "the next phase of the argument concerns a detailed analysis of @xmath1121 .",
    "it is natural to break the sum over @xmath141 and @xmath132 into congruence classes modulo @xmath1122 $ ] .",
    "let @xmath1123 then we have @xmath1124 where the sum is over @xmath1125 for which @xmath1126 and @xmath1127 perhaps the most obvious way to deal with @xmath1128 is to approximate the sums over @xmath132 and @xmath141 by integrals .",
    "a simple change of variables would then permit us to extract the dependence of @xmath1128 on @xmath1129 and @xmath11 . instead of this",
    "it turns out that we can manage with a relatively crude direct comparison of @xmath1128 with @xmath1130 , as we proceed to show .",
    "it follows from our conditions of summation that @xmath1131",
    ". it will be convenient to make the additional hypothesis @xmath1132 which implies in particular that @xmath1133 . in view of we have @xmath1134 where if @xmath1135 and @xmath1136 are given by then @xmath1137 we will denote by @xmath1138 the integrand that appears in this expression for @xmath1128 . using an approach based on the proof of lemma [ mainapp3 ] in ",
    "[ app2 ] we compare @xmath1138 with @xmath1139 . for this we will assume without loss of generality that @xmath1140 in the sum over @xmath141 . the alternative possibility is accommodated by a simple change of variables in the integral over @xmath160",
    ". hence the definition of @xmath1141 ensures that @xmath1142 has order of magnitude @xmath1143 and by lemma  [ omegaprops ] we have @xmath1144 in @xmath1128 .    under the change of variables @xmath1145",
    "we see that @xmath1146 since @xmath1147 by .",
    "we may therefore conclude from lemma  [ omegaprops ] that @xmath1148 note that the number of @xmath141 appearing in the outer sum is @xmath1149 .",
    "for @xmath1150 such that @xmath1151 it is clear that @xmath1152 unless @xmath1150 is within a distance @xmath11 of the boundary of @xmath372 . invoking lemma [ omegaprops ] to deduce that @xmath1054 is bounded absolutely , and recalling that @xmath966 and @xmath967 , it easily follows that @xmath1153 by .",
    "we now repeat the above process by considering the effect of a change of variables @xmath1154 in @xmath1155 . recalling that @xmath1156 , by , we obtain @xmath1157 for @xmath1029 . in particular",
    "it follows that @xmath1158 for any @xmath1159 .",
    "an application of lemma [ omegaprops ] reveals that @xmath1160 to control the error term we note that the total number of available @xmath1161 in the sums is @xmath1162 we conclude that @xmath1163 whence @xmath1164    summing the latter estimate over @xmath1165 modulo @xmath11 gives @xmath1166 which we substitute back in to get @xmath1167 now the outer integral in our expression for @xmath1128 is over an interval of length @xmath1168 .",
    "we have therefore arrived at the following result .",
    "[ lem : j ] assume that @xmath1169 .",
    "then we have @xmath1170    this result will allow us to separate out what is in effect the `` singular integral '' associated to our counting problem . in the notation of it",
    "is given by @xmath1171 it follows from that @xmath1172 it is interesting to compare the present situation with the singular integrals arising from typical applications of the hardy  littlewood circle method .",
    "these are expressed as volumes that reflect the real density of solutions .",
    "it transpires that we will be able to provide a lower bound for @xmath1173 which essentially matches the upper bound without first approximating the sum by an integral .",
    "nonetheless crucial use will be made of the fact that @xmath1173 features a sum over points close to a non - singular real point on the variety .",
    "for given @xmath7 and @xmath61 , let @xmath1174 where @xmath1175 $ ] .",
    "we claim that @xmath1176 for any @xmath410 . to see this we write @xmath1177 for fixed @xmath1178 modulo @xmath1179 .",
    "then the number of @xmath1180 contributing to @xmath1181 is at most @xmath1182^n : 2{\\mathbf{n}}_{k/{\\mathbb{q}}}({{\\bf q}})=n\\ } \\ll_\\xi \\frac{{\\delta}^{n+\\xi/2}}{u}.\\end{aligned}\\ ] ] moreover there are @xmath1183 possibilities for @xmath1184 and the number of available @xmath1185 is at most @xmath1186^n : { \\mathbf{n}}_{k/{\\mathbb{q}}}({{\\bf p}})=n\\ } \\ll_\\xi \\frac{{\\delta}^{n+\\xi/2}}{k^2}.\\ ] ] it therefore follows that @xmath1187 noting that @xmath1188 , we easily arrive at .",
    "the extraction of @xmath1189 now follows on combining lemmas  [ lem : stage1 ] and [ lem : j ] with and . putting these together , and assuming that @xmath1169",
    ", we therefore deduce that @xmath1190 where @xmath1191 is given by .",
    "since @xmath1169 it is clear that the error term is @xmath1192    we now show that the summation over @xmath7 can be extended to infinity with acceptable error .",
    "it follows from and that the error in so doing is @xmath1193 this error term is subsumed by that above when @xmath1169 .",
    "choosing @xmath1194 the hypothesis becomes @xmath1195 .",
    "putting everything together we have therefore established the following result .",
    "[ lem : onion ] assume that @xmath1195",
    ". then we have @xmath1196 where @xmath1189 is given by and @xmath1197 with @xmath1175 $ ] and @xmath1181 given by .",
    "it remains to produce satisfactory lower bounds for the quantities @xmath1198 and @xmath1199 .",
    "for the former our strategy will be to show that as @xmath768 tends to infinity the sum @xmath1198 converges to a limit @xmath1200 which is a product of local factors .",
    "we will then show that each of these factors is positive . in view of ( [ eq : bugle ] )",
    "the sum @xmath1201 is absolutely convergent .",
    "we rearrange it as @xmath1202 and write @xmath1203 where @xmath1204 and @xmath1205",
    ". then @xmath1113=[m , u]k_2 $ ] and @xmath1206^{3n } }   \\sum_{k_2}\\frac{\\mu(k_2)}{k_2^{3n}}n_{m}(k_1k_2,u).\\ ] ] the function @xmath1207 factors as @xmath1208 where @xmath1209 $ ] in @xmath1210 .",
    "we write @xmath1211 and observe that @xmath1212 by the argument used for ( [ sfo1 ] ) , and the fact that @xmath1213 .",
    "it follows that @xmath1214 with @xmath1215 we therefore see that @xmath1216 where @xmath1217^{3n } } \\prod_{p\\mid um}\\left(1-\\frac{r(p)}{p^n}\\right)^{-1}n_{m}(k , u)\\ ] ] is a multiplicative function in the two variables @xmath58 and @xmath986 .",
    "we write @xmath1218 and @xmath1219 , where @xmath1220 vanishes for all but finitely many primes",
    ". then @xmath1221 exists .",
    "moreover we will have @xmath1222 with @xmath1223 and in order to prove that @xmath1224 it will suffice to show that @xmath1225 for every prime @xmath56 .    our treatment of the singular series",
    "will depend on the following two lemmas , which we will prove later in this section",
    ". it will be convenient to write @xmath106 for the vector @xmath1226 and @xmath1227 for @xmath1228 .",
    "moreover we shall write @xmath1229 and @xmath1230 .",
    "we now prove that the product ( [ abs ] ) converges .",
    "lemma [ sscon ] yields @xmath1237 - 2}\\ll p^{-2}.\\ ] ] we note also that @xmath216 is non - zero only for the primes in @xmath179 , and that @xmath1238 thus a bound @xmath1239 will suffice to establish absolute convergence . in general we have @xmath1240^{3n } } \\prod_{p\\mid up^\\mu}\\left(1-\\frac{r(p)}{p^n}\\right)^{-1}n_{p^\\mu}(k , u)\\\\ & = \\sum_{u\\mid p^\\beta}u\\sum_{k\\mid up^\\mu } \\frac{\\mu(k)}{[p^\\mu , u]^{3n } } \\prod_{p\\mid up^\\mu}\\left(1-\\frac{r(p)}{p^n}\\right)^{-1}n_{p^\\mu}(k , u ) \\sum_{q\\mid p^\\beta:\\,u\\mid q}\\mu(q / u),\\end{aligned}\\ ] ] in view of ( [ fex ] ) .",
    "the final sum over @xmath58 vanishes unless @xmath1241 , and if @xmath1232 our expression reduces to @xmath1242 taking @xmath1243 and @xmath1244 we obtain @xmath1245 the required estimate @xmath1239 now follows from lemma [ mlem ] , since @xmath1246 by .",
    "this completes the proof of absolute convergence .      using hensel s lemma it will follow that @xmath1225",
    "if the variety @xmath1250 introduced in , has a non - singular point over @xmath1251 which satisfies the constraints @xmath1252 the function @xmath1253 counts points over @xmath1254 which lie on the above variety and satisfy the constraints ( [ twocond ] ) , whether they are non - singular or not .",
    "the number of singular points will be @xmath1255 , whence the estimate ( [ 5/2 ] ) shows that there will be a suitable non - singular point providing that @xmath1256 , say .",
    "we can arrange that the set @xmath179 includes all primes @xmath1257 , so that lemma [ lem : suffice ] ensures the existence of @xmath56-adic integer solutions with @xmath1258 and @xmath1259 .",
    "it follows that @xmath1260 .",
    "finally we prove , by contradiction , that any such point must be non - singular .",
    "for otherwise we would have @xmath1261 where @xmath1262 .",
    "it would then follow from euler s identity that @xmath1263 a contradiction .",
    "thus we have suitable non - singular points for every prime @xmath56 , and hence it follows that @xmath1225 for all primes @xmath56 .",
    "it remains to establish lemmas [ mlem ] and [ sscon ] .",
    "to handle lemma [ mlem ] we observe that the variety defined by @xmath1266 takes the simple form @xmath1267 over @xmath1268 .",
    "this makes it clear that we have a hypersurface of projective dimension @xmath1269 , whose singular locus has projective dimension @xmath1270 .",
    "here we use the fact that the singular locus consists of points where two or more coordinates vanish from each of the sets @xmath1271 , @xmath1272 , and @xmath1273 . according to the result of hooley @xcite the number of projective points modulo @xmath56 differs from @xmath1274 by an amount @xmath1275 , whence the number of points in @xmath1276 is @xmath1277 .",
    "it follows that @xmath1278 in the set on the right we have @xmath1279 and @xmath1280 from which it follows that @xmath1281 .",
    "it follows , by the argument leading to ( [ sfo1 ] ) that the number of possible @xmath1282 is @xmath1283 and that the number of possible @xmath1284 is @xmath1285 .",
    "we then see that @xmath1286 for any fixed @xmath410 , which gives us the required bound ( [ 5/2 ] ) .    turning to the proof of lemma [ sscon ]",
    "we will begin by supposing that @xmath1287 it follows that @xmath1288 , whence ( [ fsum2 ] ) yields @xmath1289 it will be appropriate to observe at this point that @xmath1290 , which follows from ( [ rb ] ) .",
    "we proceed to compare @xmath1291 with @xmath1292 , using hensel lifting . for @xmath1293",
    "we define @xmath1294 when @xmath1295 and @xmath1296 one sees that if @xmath1297 then @xmath1298 for all @xmath1299 .",
    "thus @xmath1300 is composed of cosets modulo @xmath1301 .",
    "moreover @xmath1302 will be in @xmath1303 for exactly @xmath1304 choices of @xmath1305 .",
    "it follows that each coset modulo @xmath1301 in @xmath1300 lifts to exactly @xmath1304 cosets modulo @xmath1306 in @xmath1303 , and hence that @xmath1307 for @xmath1295 and @xmath1296 .",
    "we now write @xmath1308 whence @xmath1309 for @xmath1310 .",
    "then for any non - negative integer @xmath1311 we have @xmath1312 whence @xmath1313",
    "similarly we have @xmath1314 we therefore wish to use for every value @xmath1315 .",
    "this will require that @xmath1316 and @xmath1317 .",
    "this condition is equivalent to requiring that @xmath1318 and @xmath1317 , or that @xmath1319 and @xmath1320 . thus if @xmath1321\\right\\}\\ ] ] then ( [ compare ] ) yields @xmath1322    we proceed to insert this bound into ( [ f1 ] ) . if @xmath1323 we find that @xmath1324 $ ] providing that @xmath1325 .",
    "in fact we have made the stronger assumption , and we deduce that @xmath1326}t(p^{[\\alpha/2]}).\\ ] ] we have therefore reduced our problem to one of providing a suitable upper bound for @xmath1327 .",
    "we now recall that @xmath1328 if we set @xmath1329 it then follows that @xmath1330 where @xmath1331 and @xmath1332 we begin by explaining our estimation of @xmath1333 .",
    "the treatment of @xmath1334 will then be in the same spirit , but a little more complicated .",
    "over @xmath1335 we have @xmath1336 for certain linearly independent linear forms @xmath1337 with coefficients in the normal closure @xmath28 , say , of @xmath1 .",
    "indeed our original choice of the basis @xmath1338 ensures that the @xmath1339 are algebraic integers .",
    "we now have @xmath1340 where @xmath1341",
    "let @xmath1342 denote the matrix @xmath1343 and write @xmath1344 , so that @xmath1345 is the discriminant of @xmath1 .",
    "suppose now that @xmath1346 divides @xmath1347 .",
    "then if @xmath1348 is the column vector with elements @xmath1349 we will have @xmath1350 .",
    "this divisibility relation may be interpreted in the ring of integers for @xmath28 .",
    "we now pre - multiply by the matrix @xmath1351 , whose entries are algebraic integers , and use the fact that @xmath1352 to deduce that @xmath1353 .",
    "we conclude that @xmath1354 for each index @xmath687 , where divisibility is again within the ring of integers of @xmath28 .",
    "then @xmath1355 , and hence @xmath1356 whenever @xmath1357 .",
    "let @xmath1358 since @xmath1359 we then have @xmath1360^n : \\,p^\\sigma\\mid{\\mathbf{n}}_{k/{\\mathbb{q}}}({{\\bf s}})\\}. \\end{aligned}\\ ] ] suppose that @xmath1361 splits over @xmath1 as @xmath1362 for @xmath1363 .",
    "let @xmath1364 , so that @xmath451 is a non - zero element of @xmath86 .",
    "if we now set @xmath1365 we deduce that @xmath1366 whence @xmath1367 .",
    "it then follows that @xmath1368 , where @xmath1369 .",
    "thus for each element @xmath1112 there are non - negative integers @xmath1370 for which @xmath1371 and @xmath1372 this condition restricts @xmath1112 to a lattice @xmath1373 say , with @xmath1374 , and with @xmath1375 .",
    "the number of choices for @xmath1376 is at most @xmath1377 .",
    "it therefore follows that @xmath1378 since @xmath1379 is fixed .",
    "we now examine @xmath1334 in a similar way .",
    "the form @xmath1380 takes the shape @xmath1381 if we replace @xmath1382 by @xmath1383 and @xmath1384 by @xmath1385 we find that @xmath1386 where @xmath1387 and @xmath1388 for @xmath1389 and @xmath1390 for @xmath1391 .",
    "thus @xmath1392 for @xmath683 , where @xmath1379 is the determinant of the matrix @xmath1393 .",
    "in particular @xmath1379 is a non - zero algebraic integer . taking the product for @xmath1394 yields @xmath1395 .",
    "by symmetry we also obtain @xmath1396 , and hence @xmath1397 it follows that @xmath1398 with @xmath1399    we can now complete the argument as before .",
    "this time there will be two sets of non - negative exponents @xmath1400 and @xmath1401 , say , corresponding to @xmath1402 and @xmath1403 respectively , and such that @xmath1404 .",
    "thus the factor @xmath1405 must be replaced by @xmath1406 .",
    "for each such set of exponents we find that @xmath1407 is restricted to a sublattice of @xmath1408 of index at least @xmath1409 , and we deduce as before that @xmath1410 in view of ( [ test ] ) and ( [ t2est ] ) we deduce that @xmath1411 since if @xmath1412 we have @xmath1413 for any real number @xmath1414 .",
    "it now follows from ( [ f0est ] ) that @xmath1236 - 2},\\ ] ] and this suffices for lemma [ sscon ] when holds .",
    "finally , it is clear in fact that we still have this estimate if @xmath1415 , since if @xmath1416 then @xmath56 belongs to the finite set of divisors of @xmath986 .",
    "this therefore completes the proof of lemma  [ sscon ] .",
    "our final task in this section is to establish a lower bound for @xmath1199 to complement the upper bound in . for any @xmath1417 let @xmath1418 denote the box centered on @xmath1419 with side length @xmath1420 .",
    "the final part of lemma [ omegaprops ] implies that there exists @xmath1421 such that @xmath1422 for every @xmath1423 .",
    "here we view @xmath1424 as a vector @xmath1425 in @xmath1426 . in this way we deduce from and that @xmath1427 where",
    "if @xmath1135 and @xmath1136 are given by then @xmath1428 the minimum distance from the line @xmath1429 to the point @xmath1425 is equal to @xmath1430 .",
    "suppose now that we have points @xmath141 and @xmath132 satisfying @xmath1431 .",
    "if we set @xmath1432 and @xmath1433 then @xmath1434 and @xmath1435 moreover @xmath1436 thus @xmath1437 , while @xmath1438 since @xmath1439 are not both zero .",
    "since @xmath1421 , it follows that @xmath1440 providing that we take @xmath279 as a sufficiently small positive constant .",
    "we now see that , for points @xmath1441 satisfying ( [ smaller ] ) , the line @xmath1429 meets the disc @xmath1442 in a segment of length @xmath1443 , so that @xmath1444 the number of available points @xmath1441 is @xmath1445 and we therefore conclude from ( [ last ] ) that @xmath1446 this should be compared with the upper bound .        recalling and our choice @xmath927 , it is now time to select parameters @xmath1450 such that @xmath1451 we will choose @xmath1452 with which choice lemma  [ lem : final - main ] implies that @xmath1453 , if @xmath1454 in line with lemma [ lem : suffice ] we let @xmath323 run through large integers congruent to @xmath953 modulo @xmath986 .",
    "next we choose @xmath1455 $ ] , which is a positive integer congruent to @xmath953 modulo @xmath986 .",
    "but then @xmath332 has order @xmath1456 and so @xmath1457 satisfies the conditions of lemma [ lem : treat_e ] .",
    "this implies that the required estimate for @xmath1458 holds and so completes the proof of theorem [ thmain - a ] .",
    "colliot - thlne , d. harari and a.n .",
    "skorobogatov , valeurs dun polynme  une variable reprsents par une norme .",
    "_ number theory and algebraic geometry _ , 6989 , london math .",
    ".  lecture note ser .",
    "* 303 * cambridge univ .",
    "press , cambridge , 2003 .",
    "colliot - thlne , j .- j .",
    "sansuc and p. swinnerton - dyer , intersections of two quadrics and chtelet surfaces , i.",
    "_ j.  reine angew .",
    "_ * 373 * ( 1987 ) , 37107 ; ii .",
    "_ j.  reine angew .",
    "_ * 374 * ( 1987 ) , 72168 .",
    "colliot - thlne , a.n .",
    "skorobogatov and p. swinnerton - dyer , rational points and zero - cycles on fibred varieties : schinzel s hypothesis and salberger s device .",
    "_ j.  reine angew .  math . _",
    "* 495 * ( 1998 ) , 128 ."
  ],
  "abstract_text": [
    "<S> let @xmath0 $ ] be an irreducible quadratic polynomial and suppose that @xmath1 is a quartic extension of @xmath2 containing the roots of @xmath3 . </S>",
    "<S> let @xmath4 be a full norm form for the extension @xmath5 . </S>",
    "<S> we show that the variety @xmath6 satisfies the hasse principle and weak approximation . </S>",
    "<S> the proof uses analytic methods . </S>"
  ]
}