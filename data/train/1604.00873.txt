{
  "article_text": [
    "directed graphs ( digraphs ) are widely used to describe interactions in technological , biological , and social complex systems @xcite .",
    "a digraph is composed of vertices and arcs ( directed edges ) which link between vertices .",
    "for instance , the gene regulation system of a biological cell can be modeled as a digraph of genes , in which an arc points from gene @xmath0 to gene @xmath1 if @xmath0 regulates the expression of @xmath1 @xcite .",
    "real - world complex systems are full of feedback interactions and adaptation mechanisms , and the digraphs of these systems usually contain an abundant number of directed cycles , which make the system s dynamical properties difficult to predict and to externally control @xcite .",
    "not all vertices and arcs are equally important in feedback interactions .",
    "some vertices and arcs may participate in a much greater number of directed cycles than other vertices and arcs .",
    "a minimum feedback vertex set ( fvs ) contains a smallest number of vertices whose deletion from the digraph destroys all the directed cycles .",
    "similarly , a minimum feedback arc set ( fas ) is an arc set of smallest cardinality such that every directed cycle of the digraph has at least one arc in this set . in terms of collective effect",
    ", the vertices in a fvs and the arcs in a fas may be most significant to the dynamical complexity of a complex networked system @xcite , and these vertices and arcs may also be optimal targets of distributed network attack processes @xcite .",
    "the directed feedback problems , namely constructing a minimum fvs and a minimum fas for a generic digraph , are combinatorial optimization problems in the nondeterministic polynomial - hard ( np - hard ) class and therefore are intrinsically very difficult @xcite .",
    "some progresses have been achieved by computer scientists and applied mathematicians in understanding this classic hard problem since the 1990s @xcite .",
    "approximate algorithms with provable bounds have been designed ( see , for example @xcite ) and efficient heuristic algorithms such as greedy local search @xcite and simulated annealing @xcite have been implemented and tested on benchmark small problem instances . yet unlike the fvs problem on an undirected graph @xcite , it is still very difficult to give tight bounds on the minimal cardinality of the directed fvs and fas problems .    in this paper",
    "we study the directed fvs problem using statistical physics methods .",
    "our method is also applicable to the fas problem since it is essentially equivalent to the fvs problem @xcite .",
    "we construct a spin glass model for the directed fvs problem and derive the replica - symmetric ( rs ) mean field theory for this model .",
    "the mean field theory enables us to estimate the minimum directed fvs cardinality for random digraphs .",
    "based on this mean field theory we implement a belief propagation - guided decimation ( bpd ) algorithm and apply this message - passing algorithm to large random digraph instances .",
    "the bpd algorithm slightly outperforms the simulated annealing algorithm @xcite in terms of the fvs cardinality and the arc density of the remaining directed acyclic graph ( dag ) , while the computing times of the two algorithms are comparable to each other . our work will be helpful for future investigations on the dynamical complexity of various real - world networked systems and for further studies of targeted attacks on directed networks . in this paper",
    "we also point out a major difficulty of the rs mean field theory in treating directed cycle - caused long range correlations .    directed and undirected cycles cause long - range correlations and frustrations in dynamical systems and spin glass models .",
    "they are very important network structural properties , but theoretical efforts directly treating them as constraints are quite lacking .",
    "directed cycles are global properties of a digraph ( each of which may involve a lot of vertices and arcs ) . compared with problems with local constraints ( such as the @xmath2-satisfiability problem @xcite ) , optimization problems constrained by directed cycles are much more difficult to tackle theoretically .",
    "the present paper is a continuation of our earlier report @xcite which treated the undirected fvs problem successfully .",
    "we realized that the directness of the cycle constraints makes the directed fvs problem much harder than its undirected counterpart .",
    "it is clear that further efforts are needed to overcome the gap between the bpd results and the rs predictions in fig .",
    "[ fig : rdfvs ] .",
    "the next section defines the directed fvs and fas problems and explains their essential equivalence .",
    "we then introduce a fvs spin glass model in sec .",
    "[ sec : model ] and study it by rs mean field theory in sec .",
    "[ sec : rs ] . in sec .",
    "[ sec : bpd ] we describe the bpd message - passing algorithm and compare its performance with the simulated annealing algorithm on random digraphs .",
    "we conclude this paper in sec .",
    "[ sec : conclusion ] .",
    "the two appendices contain some additional technical discussions .",
    "consider a simple digraph @xmath3 .",
    "this digraph contains @xmath4 vertices whose indices ( say @xmath5 ) range from integer values @xmath6 to @xmath4 .",
    "there are @xmath7 arcs in this digraph , each of which points from one vertex ( say @xmath8 ) to another different vertex ( say @xmath9 ) and is denoted as @xmath10 $ ] .",
    "there is no self - arc pointing from a vertex to itself , and there is at most one arc from any vertex @xmath8 to any another different vertex @xmath9 .",
    "the arc density @xmath11 of a digraph is just the ratio between arc number @xmath7 and vertex number @xmath4 , that is @xmath12 .",
    "each vertex @xmath8 of the digraph has a positive weight @xmath13 whose meaning is context - dependent .",
    "for instance , in the problem of complex - system control @xcite , the weight @xmath13 may be the cost of monitoring the vertex @xmath8 .",
    "the vertex weights are fixed parameters of the digraph and can not be modified . in the actual numerical computations of this paper , each vertex weight @xmath13 is set to be @xmath14 just for simplicity .",
    "if there is an arc @xmath10 $ ] from a vertex @xmath8 to another vertex @xmath9 but the reverse arc @xmath15 $ ] is absent , then @xmath9 is said to be a _ child _ of @xmath8 and @xmath8 is said to be a _",
    "parent _ of @xmath9 .",
    "if there are two arcs @xmath10 $ ] and @xmath15 $ ] of reverse direction between vertices @xmath8 and @xmath9 , then vertex @xmath8 is said to be a _ brother _ of vertex @xmath9 and @xmath9 a brother of @xmath8 .",
    "the in - degree and out - degree of vertex @xmath9 are defined as the total number of arcs pointing to @xmath9 and pointing from @xmath9 , respectively .",
    "for example , vertex @xmath16 in fig .",
    "[ fig : digraph ] is a parent of vertex @xmath6 and is a child of vertex @xmath17 , while vertices @xmath17 and @xmath6 are brother of each other .",
    "a directed path in a digraph @xmath3 is a sequence of arcs which connect a sequence of vertices , for example a directed path @xmath18 , \\ [ j_1 ,   j_2 ] , \\",
    "\\ldots , \\ [ j_{n-1 } ,   j_{n } ] , \\ [ j_n , j]$ ] from a start vertex @xmath8 to an end vertex @xmath9 .",
    "if the start vertex and the end vertex of a directed path are identical , then this path is referred to as a directed cycle . some examples of directed paths and cycles can be found in the small graph of fig .",
    "[ fig : digraph ] .",
    "a feedback vertex set of digraph @xmath3 is a subset @xmath19 of the @xmath4 vertices such that if all the vertices of this set and the attached arcs are removed from @xmath3 the remaining digraph will have no directed cycle . in other words ,",
    "the set @xmath19 contains at least one vertex of every directed cycle . as an example , the set @xmath20 is a fvs for the small digraph of fig .",
    "[ fig : digraph ] .",
    "similarly , a feedback arc set is a subset of the @xmath7 arcs such that it contains at least one arc of every directed cycle of digraph @xmath3 . for the example of fig .",
    "[ fig : digraph ] one can easily verify that the arc set @xmath21 , [ 13 , 14]\\}$ ] is a minimum fas .",
    "the weight @xmath22 of a feedback vertex set @xmath19 is just the total weight of its ingredient vertices : @xmath23 .",
    "the fundamental goal of the feedback vertex set problem is to construct a fvs for a given digraph with total weight as small as possible .",
    "this np - hard problem has been studied by mathematicians and computer scientists , see for example references @xcite , but it appears that this important problem has not yet been treated by statistical physics methods .",
    "here we work on the directed fvs problem using the mean field spin glass theory and the belief propagation message - passing algorithm .",
    "the feedback arc set problem for a digraph @xmath3 ( left ) can be converted into a feedback vertex set problem for a new digraph @xmath24 ( right ) .",
    "each arc @xmath25 $ ] of @xmath3 is mapped to a vertex ( denoted by a square ) in @xmath24 , and an arc is created in @xmath24 from a vertex @xmath10 $ ] to another vertex @xmath26 $ ] if and only if @xmath27 .",
    "the left digraph becomes acyclic after arc @xmath28 $ ] is deleted , and correspondingly the right digraph becomes acyclic after vertex @xmath28 $ ] and its attached arcs are deleted .",
    ", scaledwidth=60.0% ]    the spin glass model of this work and the corresponding bpd algorithm is also applicable to the fas problem .",
    "this is because the fas problem is equivalent to the fvs problem on a modified digraph @xcite ( fig .",
    "[ fig : fastofvs ] ) . to construct a fas for a given digraph @xmath3 ,",
    "we can first map each arc @xmath10 $ ] of @xmath3 to a vertex ( also denoted as @xmath25 $ ] ) of a new digraph @xmath24 , and then we setup an arc in @xmath24 from a vertex @xmath25 $ ] to another vertex @xmath26 $ ] if and only if @xmath27 .",
    "it is easy to verify that there is a one - to - one correspondence between a directed cycle of digraph @xmath3 and a directed cycle in the digraph @xmath24 , and a fvs of digraph @xmath24 is just a fas of digraph @xmath3 ( fig .",
    "[ fig : fastofvs ] ) .    in the present paper we focus on the directed fvs problem .",
    "treatment of the fas problem on random and real - world networks and its application to the network destruction problem will be reported in a separate paper @xcite .",
    "we now describe in detail a spin glass model for the directed fvs problem , which was briefly introduced in the last section of @xcite by the present author .",
    "similar model systems have also been discussed by other authors , see , e.g. , @xcite .",
    "first , a height state @xmath29 is assigned to each vertex @xmath8 of a digraph @xmath3 .",
    "this height state can take integer values in the interval @xmath30 , with @xmath31 being the allowed maximal height in the model .",
    "the value of @xmath31 is adjustable in the theoretical calculations , but it should not exceed the total number @xmath4 of vertices . setting @xmath31 to a larger value will result in better theoretical results . on the other hand ,",
    "the memory space and the computing time both increase linearly with @xmath31 . in this paper",
    "we mainly work with @xmath32 but we will also discuss the effect of @xmath31 on the theoretical results .    a generic configuration of the system is denoted as @xmath33 with @xmath34 . if the height of a vertex @xmath8 is @xmath35 , this vertex is referred to as being unoccupied or empty , otherwise @xmath8 is referred to as being occupied . to ensure that there are no directed cycles within the set of occupied vertices , we impose the following constraint on each arc @xmath10 $ ] of digraph @xmath3 : if both vertex @xmath8 and vertex @xmath9 are occupied ( @xmath36 and @xmath37 ) , then the height of vertex @xmath8 must be less than that of vertex @xmath9 ( @xmath38 ) . a configuration @xmath33 is referred to as a legal configuration if it satisfies all the @xmath7 arc constraints .",
    "if @xmath33 is a legal configuration of digraph @xmath3 , then the vertex heights along any directed path of occupied vertices form a strictly increasing sequence",
    ". therefore there must be no directed cycles within the set of occupied vertices of configuration @xmath33 and the set of unoccupied vertices of this configuration must form a fvs . in other words ,",
    "each legal configuration @xmath33 corresponds to exactly one fvs .    on the other hand ,",
    "since two or more legal configurations may have the identical set of unoccupied vertices , a single fvs often corresponds to more than one legal configuration . in this sense",
    "the above introduced arc constraints are not very restrictive .",
    "we can achieve a one - to - one mapping between a legal configuration and a fvs by requiring that if the height of a vertex is positive it must exceed the maximal height of its parent and brother vertices by @xmath6 ( see [ sec : modelb ] ) .",
    "but the spin glass model with such a set of more restrictive arc constraints is more complicate for numerical treatment , and it does not lead to better fvs solutions for single digraph instances . in the present paper we stick to the weaker arc constraints . a comparative study on this weaker model and the stronger model of [ sec : modelb ] will be carried out in another technical paper .    for the convenience of theoretical development ,",
    "if there is an arc @xmath10 $ ] between a vertex @xmath8 and another vertex @xmath9 but the reverse arc @xmath15 $ ] is absent , we denote this situation by the notation @xmath39 ; if both the forward arc @xmath10 $ ] and the reverse arc @xmath15 $ ] exist between vertices @xmath8 and @xmath9 , we denote this situation by the notation @xmath40 . in later discussions , @xmath39 and @xmath41",
    "are referred to as _ links _ of digraph @xmath3 .",
    "a link factor is defined for each link @xmath39 as @xmath42 where @xmath43 is the kronecker symbol such that @xmath44 if @xmath45 and @xmath46 if @xmath47 , and @xmath48 is the heaviside step function such that @xmath49 for integers @xmath50 and @xmath51 for @xmath52 . the link factor",
    "@xmath53 if either @xmath54 ( vertex @xmath9 is unoccupied ) or @xmath55 ( vertex @xmath9 is occupied and its height is higher than that of vertex @xmath8 ) , otherwise @xmath56 .",
    "a different link factor is defined for each link @xmath41 as @xmath57 this link factor @xmath58 if either @xmath59 ( vertex @xmath8 is unoccupied ) or @xmath54 ( vertex @xmath9 is unoccupied ) or both , otherwise its value is zero .",
    "we now introduce a partition function @xmath60 for the digraph @xmath3 as @xcite @xmath61    \\prod\\limits_{(i\\rightarrow j)\\in g } c_{(i\\rightarrow j)}(h_i , h_j )    \\prod\\limits_{(k \\leftrightarrow l ) \\in g } c_{(k\\leftrightarrow l)}(h_k , h_l )   \\ ; .",
    "\\label{eq : zxd1}\\ ] ] because of the product term of link factors in the above expression , only legal configurations have positive contributions to the partition function .",
    "the parameter @xmath62 of ( [ eq : zxd1 ] ) is a re - weighting parameter ( the inverse temperature ) which favors configurations of larger total weight of occupied vertices .",
    "as @xmath62 becomes sufficiently large , the partition function @xmath60 will be contributed predominantly by those height configurations @xmath33 which correspond to minimum feedback vertex sets .    given a height configuration @xmath33 ,",
    "the total number of occupied vertices , @xmath63 , and the total number of occupied arcs , @xmath64 , are computed respectively through @xmath65 \\in g }    \\bigl(1- \\delta_{h_i}^0    \\bigr ) \\bigl(1-\\delta_{h_j}^0 \\bigr ) \\ ; .\\ ] ] the free entropy @xmath66 of the spin glass system is defined as @xmath67 for a digraph @xmath3 containing a large number @xmath4 of vertices , we expect the free entropy @xmath66 to be an extensive thermodynamic quantity , namely @xmath68 with @xmath69 being the free entropy density . the free entropy density @xmath70 depends on the the re - weighting parameter @xmath62 but not on the vertex number @xmath4 ( for @xmath4 sufficiently large ) .",
    "an interesting connection which we wish to point out is that the directed fvs problem can be viewed as an irreversible opinion propagation problem . consider a simple contagion process in which an initially occupied vertex will decay to be unoccupied if all its parent and brother vertices become unoccupied @xcite .",
    "for this process to reach all the vertices of the digraph we need to fix some vertices to be unoccupied as the initial condition .",
    "this set of externally fixed vertices must form a fvs . in this opinion - dynamics context",
    "the height @xmath29 of a vertex @xmath8 should be understood as the discrete time at which vertex @xmath8 jumps from being occupied to being unoccupied ( see @xcite for related theoretical and computational efforts on irreversible and reversible opinion spreading processes ) .",
    "we now study the model ( [ eq : zxd1 ] ) by the rs mean field spin glass theory .",
    "this theory is based on the bethe - peierls approximation @xcite , and it can also be derived through the method of partition function expansion @xcite .      a quantity of central importance is the probability that a vertex belongs to a fvs ( i.e. , being unoccupied ) . to calculate this marginal probability ,",
    "let us denote by @xmath71 the probability of vertex @xmath9 taking the height state @xmath72 . if there is a link between two vertices @xmath8 and @xmath9 , we denote by @xmath73 the marginal probability that vertex @xmath9 would take the height state @xmath72 if the effect of vertex @xmath8 to @xmath9 was not considered .",
    "consider a randomly chosen vertex @xmath9 of the digraph @xmath3 .",
    "in general this vertex is connected to a set of parent , child , and brother vertices ( fig .",
    "[ fig : bpapprox ] ) .",
    "let us denote by @xmath74 , @xmath75 , and @xmath76 the set of parent , child , and brother vertices of vertex @xmath9 , respectively .",
    "in mathematical terms , @xmath77 , @xmath78 , and @xmath79 .",
    "the set of neighboring vertices of vertex @xmath9 , denoted as @xmath80 , is the union of these three disjoint sets , namely @xmath81 .    to compute the marginal probability @xmath82 ,",
    "let us first remove vertex @xmath9 and all the attached arcs from digraph @xmath3 .",
    "the remaining digraph is referred to as a cavity graph and is denoted as @xmath83 ( fig .  [ fig : bpapprox ] ) . as a first approximation",
    "we assume that in the cavity digraph @xmath83 all the vertices in the set @xmath80 are mutually independent and therefore the joint distribution of these vertices height states can be written as a product of the marginal height distributions of single vertices ( the bethe - peierls approximation @xcite ) . under this approximation ,",
    "when vertex @xmath9 is added to the cavity digraph @xmath83 to form the whole digraph @xmath3 , its marginal height distribution @xmath71 can be expressed as @xmath84 where @xmath85 is a shorthand notation for the expression @xmath86",
    "\\prod\\limits_{k\\in c(j ) }    \\bigl [      q_{k \\rightarrow j}^0 + \\sum\\limits_{h^{\\prime\\prime } \\geq h+1}^{d }      q_{k\\rightarrow j}^{h^{\\prime\\prime } }      \\bigr ] \\ ; , \\ ] ] and the normalization constant @xmath87 is expressed as @xmath88    \\prod\\limits_{k\\in c(j ) }    \\bigl [      q_{k \\rightarrow j}^0 + \\sum\\limits_{h^{\\prime\\prime } \\geq h+1}^{d }      q_{k\\rightarrow j}^{h^{\\prime\\prime } }      \\bigr ] \\ ; .\\ ] ]     the neighborhood of a vertex @xmath9 .",
    "the whole square region represents the digraph @xmath3 , and the shaded region represents the cavity digraph @xmath83 after vertex @xmath9 and all its attached arcs are removed from @xmath3 .",
    "the neighboring vertices of @xmath9 can be divided into three disjoint sets , the parent set @xmath74 , the child set @xmath75 , and the brother set @xmath76 .",
    "for instance , vertex @xmath89 , @xmath90 , and @xmath91 .",
    "each double - arrowed link in this figure denotes two oppositely directed arcs.,scaledwidth=30.0% ]    the free entropy contribution of vertex @xmath9 is defined as @xmath92 \\ ; , \\ ] ] where @xmath93 denotes the partition function of the cavity digraph @xmath83 . under the bethe - peierls approximation ,",
    "the explicit expression of @xmath94 is @xmath95     \\prod\\limits_{k\\in c(j ) }    \\bigl [      q_{k\\rightarrow j}^0 + \\sum\\limits_{h^{\\prime\\prime } \\geq h+1}^{d }      q_{k\\rightarrow j}^{h^{\\prime\\prime } }      \\bigr ]    \\biggr ) \\ ; .",
    "\\label{eq : phiv}\\ ] ] consider a link @xmath39 which indicates a single arc @xmath10 $ ] between vertices @xmath8 and @xmath9 .",
    "the free entropy contribution of this link is defined as @xmath96 } \\bigr ) }    \\bigr ] \\ ; , \\ ] ] where @xmath97}\\bigr)$ ] is the partition function of the cavity graph @xmath98}$ ] obtained by removing the single arc @xmath10 $ ] from @xmath3 .",
    "its explicit expression under the bethe - peierls approximation is @xmath99    \\biggr ) \\ ; .",
    "\\label{eq : phiarc}\\ ] ] similarly , the free entropy contribution @xmath100 of a link @xmath101 ( due to the existence of arcs @xmath10 $ ] and @xmath15 $ ] of opposite direction between vertices @xmath8 and @xmath9 ) is expressed as @xmath102    under the bethe - peierls approximation , the whole free entropy @xmath66 of digraph @xmath3 can be evaluated through the following simple expression : @xmath103 the first term of the above expression is the sum of free entropy contributions of all the vertices .",
    "since each link @xmath39 contributes to the free entropies of vertices @xmath8 and @xmath9 , the free entropy contribution of this link should be subtracted once from the total free entropy .",
    "this explains the second term of ( [ eq : phi ] ) .",
    "similarly the free entropy contribution of each link @xmath104 should be subtracted once from the total free entropy , leading to the third term of ( [ eq : phi ] ) .",
    "the free entropy density is computed from ( [ eq : phi ] ) as @xmath105 .",
    "the entropy density @xmath106 of the system is then calculated through @xmath107 \\ ; , \\ ] ] where @xmath108 is the relative total weight of the occupied vertices : @xmath109 to actually compute the free entropy density @xmath69 and other thermodynamic quantities , we need to compute the two cavity probability distributions @xmath110 and @xmath111 associated with every link @xmath112 and also the two distributions @xmath111 and @xmath110 associated with every link @xmath113 . under the same bethe - peierls approximation we can write down the following self - consistent equations for two connected vertices @xmath9 and @xmath114 : @xmath115 where @xmath116 and @xmath117 are computed through the following two expressions , respectively : @xmath118     \\prod\\limits_{k\\in c(j)\\backslash j^\\prime }    \\bigl",
    "[      q_{k \\rightarrow j}^0 + \\sum\\limits_{h^{\\prime\\prime } \\geq h+1}^{d }      q_{k\\rightarrow j}^{h^{\\prime\\prime } }      \\bigr ]    \\ ; , \\\\",
    "\\hspace*{-2.0 cm } a_{j\\rightarrow j^\\prime}(h )   =     e^{x w_j }    \\prod\\limits_{l\\in b(j)\\backslash j^\\prime } q_{l\\rightarrow j}^0    \\prod\\limits_{i \\in p(j)\\backslash j^\\prime }    \\bigl [      \\sum\\limits_{h^\\prime=0}^{h-1 } q_{i\\rightarrow j}^{h^\\prime }      \\bigr ]    \\prod\\limits_{k\\in c(j)\\backslash j^\\prime }    \\bigl [      q_{k\\rightarrow j}^0 + \\sum\\limits_{h^{\\prime\\prime } \\geq h+1}^{d }      q_{k\\rightarrow j}^{h^{\\prime\\prime } }      \\bigr ] \\ ; .\\end{aligned}\\ ] ] notice that eq .",
    "( [ eq : qjjpmarginal ] ) holds for all vertices @xmath119 , and it differs from eq .",
    "( [ eq : qjmarginal ] ) only by discarding vertex @xmath114 from the set @xmath80 . equation ( [ eq : qjjpmarginal ] ) is referred to as the belief propagation ( bp ) equation .",
    "this equation together with the free entropy expression ( [ eq : phi ] ) forms the rs mean field theory of model ( [ eq : zxd1 ] ) .",
    "the bp equation can be solved by iterations . in each time step of this iteration",
    "we consider all the vertices consecutively and in a random order , and for each vertex @xmath9 under consideration we update all its output cavity probabilities @xmath120 using ( [ eq : qjjpmarginal ] ) .",
    "the difference between the updated cavity probability @xmath121 at time @xmath122 and the old cavity probability @xmath123 is measured by @xmath124 if the maximal value of all the differences @xmath125 is less than certain small threshold @xmath126 then we regard the bp iteration as converging to a fixed point . in this work we set the convergence criterion as @xmath127 .",
    "compared with the bp iteration process of the undirected fvs problem @xcite , the bp iteration for the directed fvs problem is more time- and computer memory - consuming , since each height state can have @xmath128 possible values .",
    "after the bp equation converges on all the arcs we can then compute the free entropy density @xmath70 and the entropy density @xmath106 .",
    "in addition , the mean fraction @xmath129 of vertices in the fvs is equal to the mean fraction of unoccupied vertices : @xmath130      1.0 cm    as a simple illustration of the rs mean field theory , let us apply it to a digraph composed of a single directed cycle of @xmath4 vertices and @xmath131 arcs ( in the example of fig .",
    "[ fig : cycle : a ] , @xmath132 ) .",
    "the bp equation ( [ eq : qjjpmarginal ] ) always converges for this system , and at the bp fixed point all the parent - to - child cavity distributions @xmath133 for arcs @xmath10 $ ] are identical to the same probability function @xmath134 which satisfies @xmath135 the unique solution of this equation is @xmath136 where the constant @xmath0 is determined by @xmath137 . similarly all the child - to - parent cavity distributions @xmath138 on the arcs @xmath10 $ ] are identical to the same probability function @xmath139 with @xmath140 and @xmath141 ( @xmath142 ) .",
    "the mean field theory then predicts that the fvs relative size @xmath129 , the free entropy density @xmath70 , and the entropy density @xmath106 are @xmath143 which are all independent of the cycle length @xmath4 . as @xmath144",
    "we have @xmath145 and @xmath146 , see fig .",
    "[ fig : cycle : b ] .",
    "the minimum fvs size @xmath147 predicted by the rs theory is @xmath148 , which is higher than the true minimum size @xmath6 if @xmath149 and is lower than the true value if @xmath31 is longer than the cycle length @xmath4 .",
    "this exactly solvable example clearly demonstrates that the rs mean field theory is only an approximate theory .",
    "a major shortcoming of the rs theory is that it neglects all the cycle - caused long range correlations and all the cycle corrections to the free entropy @xmath66 @xcite , even though the constraints in the directed fvs and fas problems are induced by directed cycles .    in [ sec : appendix ] we consider another simple random graph example to discuss more about the relationship between predicted minimum fvs relative size ( @xmath147 ) and the parameter @xmath31 .",
    "the numerical results shown in fig .",
    "[ fig : rrra20 ] demonstrates that the predicted value of @xmath147 decreases considerably with @xmath31 for an infinitely large random digraph .",
    "we now perform bp iterations on two types of random digraphs , namely erds - rnyi ( er ) digraphs and regular random ( rr ) digraphs @xcite .",
    "we generate a random digraph @xmath3 of @xmath4 vertices and @xmath150 arcs in two steps .",
    "first we generate an undirected random simple graph @xmath151 of @xmath4 vertices and @xmath7 undirected edges .",
    "then we turn each undirected edge of @xmath151 into a directed edge ( an arc ) by assigning it a direction uniformly at random from the two possible directions .",
    "the resulting digraph is then the digraph @xmath3 .",
    "an undirected er graph @xmath151 is generated from an empty graph of @xmath4 vertices .",
    "two different vertices @xmath8 and @xmath9 are randomly drawn from the whole set of @xmath4 vertices , if these two vertices are not yet connected we draw an edge between them .",
    "this edge addition process continues until @xmath7 edges have been created .",
    "an undirected rr graph has the property that each vertex is attached by exactly @xmath152 edges , therefore to generate such a graph we first assign @xmath153 @xmath154half - edges to each vertex , and then repeatedly glue two randomly chosen half - edges into a full edge if this full edge is neither a self - connection nor a multi - edge between two vertices .",
    "the circular and diamond points of figure  [ fig : entropyrspop10 ] are the bp iteration results on a single random er digraph with @xmath155 vertices and arc density @xmath156 .",
    "as the re - weighting parameter @xmath62 increases from zero , the relative size @xmath129 of fvs and the entropy density @xmath106 decrease continuously .",
    "however we find that the bp iteration process no longer converges if @xmath62 exceeds @xmath157 .",
    "the non - convergence of bp iteration indicates the bethe - peierls approximation is no longer a good approximation at @xmath158 for this system ( see also sec .",
    "[ sec : cycle ] ) . on the other hand ,",
    "when bp converges on a single digraph instance , the computed entropy density @xmath106 and fvs relative size @xmath129 are in good agreement with ensemble - averaged results ( see next subsection ) .",
    "the rs mean field theory can also be used to calculate ensemble - averaged properties of random digraphs at the thermodynamic limit of @xmath159 . from eq .",
    "( [ eq : phi ] ) we know that to compute the free entropy density @xmath69 we need only to compute the mean value of vertex contribution @xmath94 over all vertices @xmath8 and the mean value of link contribution @xmath160 over all links @xmath39 ( the sum of link contributions @xmath100 can be neglected since there is only a vanishing fraction of links @xmath41 in random er or rr digraphs ) .",
    "these mean values and the fvs relative size @xmath129 are easy to compute by population dynamics simulations @xcite .",
    "corresponding to eq .",
    "( [ eq : rhoexp ] ) for the fvs relative size @xmath129 of a single digraph , the ensemble - averaged value of @xmath129 is obtained by the following probabilistic equation ( assuming all the vertex weights @xmath161 ) @xmath162    \\prod\\limits_{k}^{d_{c } }    \\int \\mathcal{d } q_{k\\rightarrow j }    q^{(c)}[q_{k\\rightarrow j } ] \\nonumber \\\\",
    "\\quad \\quad \\quad \\quad \\times    \\frac{1}{1 + e^{x } \\sum\\limits_{h=1}^{d }      \\prod\\limits_{i \\in p(j ) }      \\bigl [        \\sum\\limits_{h^\\prime=0}^{h-1 } q_{i\\rightarrow j}^{h^\\prime }        \\bigr ]      \\prod\\limits_{k\\in c(j ) }      \\bigl [        q_{k \\rightarrow j}^0 + \\sum\\limits_{h^{\\prime\\prime } \\geq h+1}^{d }        q_{k\\rightarrow j}^{h^{\\prime\\prime } }        \\bigr ]    } \\ ; .",
    "\\label{eq : rhopd}\\end{aligned}\\ ] ] in this equation , @xmath163 is the probability that a randomly chosen vertex has @xmath164 parent vertices and @xmath165 child vertices . for er",
    "digraphs @xmath163 is the product of two poisson distributions with mean value @xmath11 , @xmath166 , while for rr digraphs @xmath163 is the binomial distribution @xmath167 .",
    "the probability functional @xmath168 $ ] of eq .",
    "( [ eq : rhopd ] ) is the probability that the parent - to - child message on an arc @xmath25 $ ] is the height distribution function @xmath169 ; similarly , @xmath170 $ ] is the probability that the child - to - parent message on an arc @xmath171 $ ] is the height distribution function @xmath172 .",
    "the ensemble - averaged expressions for the vertex free - entropy contribution @xmath173 [ eq .",
    "( [ eq : phiv ] ) ] is very similar to eq .",
    "( [ eq : rhopd ] ) , while the ensemble - averaged expression for the arc free - entropy contribution @xmath174 is computed through @xmath175    \\int \\mathcal{d } q_{j\\rightarrow i }    q^{(c)}[q_{j\\rightarrow i } ]     \\ln \\biggl ( q_{j\\rightarrow i}^0 + \\sum\\limits_{h_j=1}^{d }     q_{j\\rightarrow i}^{h_j }    \\bigl[\\sum\\limits_{h_i=0}^{h_j-1 } q_{i\\rightarrow j}^{h_i }      \\bigr ]    \\biggr )     \\ ; .\\ ] ]    in the population dynamics simulations the probability functional @xmath176 $ ] is represented by a large array of @xmath177 cavity probability distributions @xmath178 of the parent - to - child type ( arcs @xmath179 $ ] ) . similarly @xmath180 $ ] is also represented by a large array of @xmath177 cavity probability distributions @xmath178 of the child - to - parent type ( arcs @xmath181 $ ] ) . to update an element of the array",
    "@xmath182 $ ] , we first generate an in - degree @xmath183 and an out - degree @xmath184 for the parent vertex @xmath9 according to the cavity degree distribution @xmath185 and we then select @xmath183 parent - to - child probability distributions @xmath169 from the array @xmath176 $ ] and @xmath186 child - to - parent probability distributions @xmath172 from the array @xmath180 $ ] , finally we compute a new probability distribution @xmath178 according to eq .",
    "( [ eq : qjjpmarginal ] ) and replace an old element of the array @xmath176 $ ] with this new element .",
    "the array @xmath187 $ ] is updated according to the same procedure , but the degree distribution of the child vertex @xmath9 is changed to be @xmath188 as an example , fig .",
    "[ fig : entropyrspop10 ] shows the ensemble - averaged mean field results for er digraphs with arc density @xmath189 . in our calculations the weight of each vertex @xmath8",
    "is set to be @xmath14 for simplicity .",
    "the fvs relative size @xmath129 and the entropy density @xmath106 both decrease with the re - weighting parameter @xmath62 , while the entropy density @xmath106 as a function of @xmath129 appears to be concave and its value becomes negative as @xmath129 is lower than certain threshold value @xmath190 which depends slightly on the parameter @xmath31 ( the maximal height ) , e.g. , @xmath191 at @xmath192 and @xmath193 at @xmath32",
    ".    0.2 cm    at a given value of @xmath31 we take the value of @xmath147 obtained by the rs population dynamics at entropy density @xmath194 as the predicted minimum relative size of fvs .",
    "the relationship between @xmath147 and the arc density @xmath11 obtained at @xmath32 is shown in fig .",
    "[ fig : rdfvs ] for er and rr random digraphs . in view of the discussion made in sec .",
    "[ sec : cycle ] the predicted @xmath147 should only be considered as an educated guess on the true value of fvs relative size .",
    "through bp iteration we can obtain an estimate about the height probability distribution @xmath71 of each vertex @xmath9 , see eq .",
    "( [ eq : qjmarginal ] ) .",
    "this estimate might not be very accurate if the underlying bethe - peierls approximation is not a good approximation ( especially when the bp iteration fails to converge ) , however it still contains very useful information for constructing a near - optimal feedback vertex set .",
    "we now describe a belief propagation - guided decimation ( bpd ) algorithm for solving the directed fvs problem ( and also the fas problem ) on single digraph instances .",
    "initially all the vertices of the digraph @xmath3 are declared as active , and the candidate fvs is initialized as empty , @xmath195 .",
    "the bp iteration then runs on this digraph for @xmath196 time steps and the height probability distribution @xmath71 of each vertex @xmath9 is computed by eq .",
    "( [ eq : qjmarginal ] ) .",
    "we set @xmath197 in this paper .",
    "the bpd algorithm then repeatedly performing the following fixing - and - updating procedure :    in the fixing stage , the active vertices @xmath9 are ranked in descending order of their empty probability @xmath198 , and the vertices at the top @xmath199 percent of this ranked sequence are all added to the set @xmath19 and declared as inactive .",
    "we set @xmath200 in this paper .",
    "the digraph induced by the remaining active vertices is then simplified by repeatedly turning an active vertex into inactive if this vertex has no active parent and brother vertices , or no active child and brother vertices .    then in the updating state , we run bp iteration on the simplified digraph of active vertices for @xmath201 time steps ( @xmath202 in this paper )",
    ". then the height probability distributions of all the active vertices are computed by eq .",
    "( [ eq : qjmarginal ] ) again .",
    "all the vertices in the original digraph @xmath3 will be turned into inactive by repeating the fixing - and - updating process .",
    "the resulting set @xmath19 forms a fvs of @xmath3 .",
    "we then further polish this set by examining , in a random order , each vertex of @xmath19 and deleting it from @xmath19 if the reduced set is still a fvs .",
    "the performance of the bpd algorithm also depends on the maximal height @xmath31 and the re - weighting parameter @xmath62 . for a digraph with @xmath4 vertices and @xmath7 arcs ,",
    "the required memory space for running the bpd algorithm is of order @xmath203 while the time complexity is of order @xmath204 .",
    "the source code of the bpd algorithm is accessible at the author s webpage ( power.itp.ac.cn/@xmath205zhouhj/codes.html ) .",
    "figure  [ fig : bpd10 ] shows the mean value of the relative sizes of constructed feedback vertex sets and the mean value of arc densities of the complementary directed acyclic digraphs , obtained by averaging the results of a single run of the bpd algorithm on @xmath206 random er digraphs of arc density @xmath207 and vertex number @xmath208 .",
    "when the maximum height @xmath31 is fixed , the performance of bpd improves considerably as @xmath62 increases from @xmath209 to @xmath210 and then saturates as @xmath62 goes beyond @xmath211 . if the re - weighting parameter @xmath62 is fixed but the maximal height changes from @xmath192 to @xmath32 , there is considerable improvement in the performance of bpd . however",
    "if @xmath31 is further increased to @xmath212 the additional improvement in performance is much weaker .",
    "based on the empirical observations of fig .",
    "[ fig : bpd10 ] we set @xmath213 and @xmath32 when applying bpd to all the other random digraph instances mentioned below , even if these digraphs have different arc density @xmath11 .",
    "we apply the bpd algorithm to a set of er digraphs with @xmath208 vertices and mean arc density @xmath11 ranging from @xmath6 to @xmath214 . at each value of @xmath11",
    "the fvs mean relative size , denoted as @xmath215 , is computed by averaging over the results of a single run of the bpd algorithm on @xmath206 independent random digraph instances .",
    "when @xmath216 we find the value of @xmath215 is very close to the minimum fvs relative size @xmath217 as predicted by the rs mean field theory at @xmath32 , see fig .",
    "[ fig : erfvs ] .",
    "however , the difference between @xmath215 and @xmath217 becomes noticeable at @xmath218 and the positive gap @xmath219 increases continuously as @xmath11 further increases .",
    "we have tested on several digraphs of larger size @xmath155 and found that the bpd results @xmath215 are not sensitive to @xmath4 . at @xmath32 ,",
    "the discrepancy between the rs mean field results and the bpd algorithmic results therefore is unlikely to be caused by finite - size effects .",
    "instead we tend to believe that this gap indicates that the rs mean field prediction @xmath217 is lower than the true minimum fvs size .",
    "we expect that the minimum fvs size obtained by the first - step replica - symmetric breaking ( 1rsb ) mean field theory @xcite will be closer to the empirical bpd results , but we have not yet carried out such an investigation .",
    "we notice that an elegant 1rsb study has been carried out in the context of the minimal contagious set problem @xcite , which is an inspiration for our future 1rsb work .",
    "we also apply the bpd algorithm to a set of rr digraphs with @xmath208 vertices and arc density @xmath11 ranging from @xmath6 to @xmath214 , and compare the results with rs mean field predictions at @xmath32 , see fig .",
    "[ fig : rrfvs ] . when @xmath220 the mean fvs relative size @xmath215 obtained by bpd is very close to the minimum fvs relative size @xmath217 of mean field theory , but the difference between @xmath215 and @xmath217 becomes noticeable at @xmath221 and is more and more pronounced as @xmath11 further increases .",
    "recently an efficient heuristic local algorithm was proposed in @xcite , which repeatedly refine the height configuration @xmath33 of a digraph through simulated annealing under the constraints ( [ eq : linkc1 ] ) and ( [ eq : linkc2 ] ) . when tested on some small digraph instances with @xmath222 vertices",
    ", the sa algorithm outperforms the greedy adaptive searching process ( grasp ) @xcite , one of the most successful local algorithms which repeatedly reduces the number of directed cycles by deleting vertices with highest value of in- and out - degree product @xmath223 . at each elementary step of the sa algorithm a trial",
    "is proposed to update the fvs : ( a ) first a randomly chosen vertex @xmath9 of the fvs ( height @xmath54 ) is chosen , and ( b ) its height @xmath72 is either set to a maximal value while satisfying all the out - going arcs @xmath224 $ ] or set to a minimal value while satisfying all the in - coming arcs @xmath10 $ ] , and then ( c ) the parent vertices @xmath8 of all the unsatisfied arcs @xmath25 $ ] or the child vertices @xmath225 of all the unsatisfied arcs @xmath224 $ ] are put to the fvs ( @xmath59 or @xmath226 ) . such a trial is accepted for sure if the resulting fvs size does not increase , otherwise it is accepted with a low probability @xcite .    here",
    "we compare the performances of bpd and sa on large digraph instances of @xmath208 vertices , see fig .",
    "[ fig : rdfvs ] and fig .",
    "[ fig : rdag ] .",
    "first , we notice that the mean relative sizes of fvs constructed by bpd and by sa are very close to each other both for er and for rr digraphs .",
    "( we have also tested the bpd algorithm on the same set of small digraph instances used in @xcite and found that bpd performs equally good as sa . )",
    "if we assume that the fvs solutions reached by the sa algorithm are close to optimal solutions , the results of fig .",
    "[ fig : rdfvs ] then indicate that ( 1 ) the bpd algorithm is able to construct close - to - minimum feedback vertex sets , and that ( 2 ) the rs population dynamics predictions underestimate the minimum fvs size of finite random digraph instances .    although the sizes of fvs solutions constructed by bpd and by sa are almost equal , we find that the bpd algorithm is more likely to select a vertex of low connectivity into the fvs than the sa algorithm . as a result",
    "the dag obtained by the bpd algorithm has considerably higher arc density ( fig .",
    "[ fig : rdag ] ) .",
    "in other words , if we choose the bpd algorithm instead of the sa algorithm , we can make the digraph free of directed cycles by deleting much fewer arcs .",
    "in this latter sense the bpd algorithm outperforms the sa algorithm ( besides the advantage that bpd is much faster than sa ) .",
    "of course both the bpd algorithm and the sa algorithm can be modified by adding another re - weighting parameter to avoid deleting highly connected vertices .",
    "such an extension might be necessary for some practical applications .",
    "in this paper we introduced a spin glass model ( [ eq : zxd1 ] ) for the directed feedback vertex set problem , approximately solved this model by the replica - symmetric mean field theory of statistical physics , and implemented a belief propagation - guided decimation algorithm to construct nearly optimal feedback vertex sets for single digraph instances .",
    "the theory and algorithm of this paper is also applicable to the equivalent feedback arc set problem .",
    "the bpd algorithm slightly outperforms the simulated annealing algorithm ( fig .",
    "[ fig : rdfvs ] and fig .",
    "[ fig : rdag ] ) , it is therefore an efficient algorithm to approach a minimum feedback vertex set for single difficult digraph instances .    the rs mean field theory appears to compute a lower - bound for the fvs minimum relative size @xmath129 ( fig .",
    "[ fig : rdfvs ] ) .",
    "this theory assumes that the height states of all the neighbors of a vertex @xmath9 are independent of each other after vertex @xmath9 is deleted ( fig .",
    "[ fig : bpapprox ] ) .",
    "this approximation essentially ignores all the correlations propagated along the directed cycles ( e.g. , in fig .  [",
    "fig : cycle : a ] the heights @xmath29 and @xmath227 of vertices @xmath8 and @xmath225 must be strongly correlated at low temperatures even if vertex @xmath9 is removed ) . conceptually speaking , the rs mean field theory of sec .",
    "[ sec : rs ] can not be a satisfactory approach to tackle cycle constraints .",
    "much theoretical efforts ( including 1rsb mean field computations ) are needed to achieve a deeper understanding on the directed fvs problem .",
    "an especially interesting but challenging question would be to design a spin glass model with truly local interactions for the cycle constraints ( like the edge - constrained model for the undirected fvs problem @xcite ) , without using height as the vertex state .",
    "the author thanks yang - yu liu , shao - meng qin , chuang wang and jin - hua zhao for helpful discussions , and the school of physics of northeastern normal university for hospitality during his two visits in august 2013 and august 2014 .",
    "this work was supported by the national basic research program of china ( grant number 2013cb932804 ) , by the national natural science foundation of china ( grant numbers 11121403 and 11225526 ) , and by the knowledge innovation program of chinese academy of sciences ( no .",
    "kjcx2-ew - j02 ) .",
    "in this appendix we describe a more restrictive spin glass model for the directed feedback vertex set problem .",
    "the model in the main text can be regarded as a relaxed version of this model . for simplicity",
    "we assume that there is no bi - directional edges in the digraph @xmath3 so that the set of brother vertices of each vertex @xmath9 is empty : @xmath228 .",
    "the partition function of this new model is defined as @xmath229 \\ ; , \\ ] ] where @xmath230 returns the maximal height value among all the parent vertices of @xmath9 .",
    "a height configuration @xmath231 with @xmath232 zero elements will contribute a term @xmath233 to this partition function if , for every vertex @xmath9 , the height state @xmath72 is either zero ( vertex @xmath9 being unoccupied ) or @xmath72 is exceeding the maximal height of its parent vertices by one . such a height configuration is called a legal configuration , and all other height configurations are illegal and have no contribution to @xmath234 .",
    "there is a one - to - one correspondence between a legal configuration @xmath33 of model ( [ eq : modelb ] ) and a fvs of the digraph @xmath3 .",
    "first , it is obvious that the set formed by all the zero - height vertices of a legal configuration @xmath33 must be a fvs .",
    "second , given any feedback vertex set @xmath19 of the digraph we can construct a unique legal height configuration by recursion : first assign all vertices in @xmath19 the height value @xmath209 and put them into an initially empty vertex set @xmath235 ; then assign the height value @xmath6 to all the vertices whose parent vertices are completely contained in set @xmath235 and then add these newly assigned vertices to set @xmath235 ; then repeat this process and assign the remaining vertices the height values @xmath157 , @xmath236 , @xmath237 , until all the vertices have been exhausted .",
    "the resulting height configuration must be a legal configuration .",
    "the spin glass model ( [ eq : modelb ] ) is more restrictive than the model ( [ eq : zxd1 ] ) .",
    "this is due to the fact that in the new model each vertex @xmath9 causes a many - body constraint among @xmath9 and all its parent vertices . for convenience of discussion",
    "let us denote by @xmath238 the constraint caused by vertex @xmath9 . to solve this more difficult model by the replica - symmetric mean field theory , we denote by @xmath239 the probability that vertex @xmath225 will be in height state @xmath227 if it is only constrained by constraint @xmath240 .",
    "similarly , for each parent vertex @xmath9 of vertex @xmath225 , we denote by @xmath241 the probability that @xmath9 will be in height state @xmath72 if it is only constrained by the constraint @xmath240 .",
    "we can write down the following set of belief - propagation equations for these two height distributions : @xmath242      \\biggr\\ } \\ ; ,      \\label{eq : bpmany1 }      \\\\      & \\hspace*{-2.2 cm } p_{\\boxed{\\scriptstyle{k}}\\rightarrow j}^{h_j }   =       \\frac{1}{z_{\\boxed{\\scriptstyle{k}}\\rightarrow j } }      \\biggl\\ { e^{-x } q_{k\\rightarrow \\boxed{\\scriptstyle{k}}}^0 +       q_{k\\rightarrow \\boxed{\\scriptstyle{k}}}^{h_j+1 } \\prod\\limits_{i\\in p(k)\\backslash j }      q_{i\\rightarrow \\boxed{\\scriptstyle{k}}}^{h_j } + \\nonumber \\\\      & \\hspace*{2.0 cm } \\sum\\limits_{h_k\\geq h_j+2 }      q_{k\\rightarrow \\boxed{\\scriptstyle{k}}}^{h_k } \\bigl [        \\prod\\limits_{i\\in p(k)\\backslash j }        q_{i\\rightarrow \\boxed{\\scriptstyle{k}}}^{h_k-1 }        -\\prod\\limits_{i\\in p(k)\\backslash j }        q_{i\\rightarrow \\boxed{\\scriptstyle{k}}}^{h_k-2 }        \\bigr ] \\biggr\\ } \\ ; .",
    "\\label{eq : bpmany2 }    \\end{aligned}\\ ] ] in the above equations @xmath243 and @xmath244 are two probability normalization constants ; the quantity @xmath245 denotes the probability that vertex @xmath225 will be in height state @xmath227 if it is _ not _ constrained by constraint @xmath240 ; the quantity @xmath246 is a partial sum defined as @xmath247 where @xmath248 denotes the probability that the parent vertex @xmath9 of vertex @xmath225 will be in height state @xmath72 if the constraint @xmath240 is absent .",
    "the self - consistent bp equations for @xmath245 and @xmath248 are much simplier : @xmath249 where again @xmath250 and @xmath251 are two probability normalization constants",
    ".    the marginal probability @xmath252 that vertex @xmath9 will be in height state @xmath72 in the digraph @xmath3 is then evaluated at a fixed - point of the bp iteration as @xmath253 with @xmath87 being a normalization constant .",
    "the mean fraction of unoccupied vertices ( i.e. , the fvs relative size ) @xmath129 is computed as @xmath254 the bp equations ( [ eq : bpmany1])([eq : bpmany5 ] ) are rather slow to iterate .",
    "our preliminary numerical results indicated that the feedback vertex set solutions offered by this more complicated bp scheme are not better than the solutions obtained by the relaxed bp scheme of the main text . in this work",
    "we therefore give up further exploration of the model ( [ eq : modelb ] ) of many - body interactions .    to be complete , here we also list the explicit expression for the total free entropy @xmath66 of the new model : @xmath255 \\,\\ ] ] where @xmath256 is the number of child vertices of vertex @xmath225 ( the out - degree ) . in this expression",
    ", @xmath257 is the free entropy contribution of constraint @xmath240 and all its involved vertices , and @xmath258 is the free entropy contribution of vertex @xmath225 .",
    "their respective expressions are @xmath259 \\nonumber \\\\      & \\hspace{2.0 cm }      +   \\prod\\limits_{l\\in c(k ) } p_{\\boxed{\\scriptstyle{l}}\\rightarrow k}^1      \\prod\\limits_{j\\in p(k)}\\bigl [        p_{\\boxed{\\scriptstyle{j}}\\rightarrow j}^{0 }        \\prod\\limits_{m\\in c(j)\\backslash k }         p_{\\boxed{\\scriptstyle{m}}\\rightarrow j}^{0 } \\bigr ] \\nonumber \\\\      & \\hspace{2.0 cm } +      \\sum\\limits_{h_k\\geq 2 }      \\prod\\limits_{l\\in c(k ) } p_{\\boxed{\\scriptstyle{k}}\\rightarrow k}^{h_k }      \\biggl (      \\prod\\limits_{j\\in p(k)}\\bigl [        \\sum\\limits_{h_j=0}^{h_k-1 } p_{\\boxed{\\scriptstyle{j}}\\rightarrow j}^{h_j }        \\prod\\limits_{m\\in c(j)\\backslash k }         p_{\\boxed{\\scriptstyle{m}}\\rightarrow j}^{h_j } \\bigr ] \\nonumber \\\\      & \\hspace{4.0 cm }      - \\prod\\limits_{j\\in p(k)}\\bigl [        \\sum\\limits_{h_j=0}^{h_k-2 } p_{\\boxed{\\scriptstyle{j}}\\rightarrow j}^{h_j }        \\prod\\limits_{m\\in c(j)\\backslash k }         p_{\\boxed{\\scriptstyle{m}}\\rightarrow j}^{h_j } \\bigr ]       \\biggr )      \\biggr\\ }      \\ ; , \\\\      & \\hspace*{-1.0 cm }      \\phi_{k }   = -\\frac{1}{x } \\ln \\biggl\\ {      \\sum\\limits_{h_k } p_{\\boxed{\\scriptstyle{k}}\\rightarrow k}^{h_k }       \\prod\\limits_{l\\in c(k ) } p_{\\boxed{\\scriptstyle{l}}\\rightarrow k}^{h_k }      \\biggr\\ }      \\ ; .",
    "\\end{aligned}\\ ] ]",
    "in sec .  [ sec : cycle ] we studied a single directed cycle and found that the rs mean field predicted that the relative size @xmath147 of minimum fvs approaches zero as the maximal height parameter @xmath260 . in this appendix",
    "we study another exactly solvable digraph and show that for this system the value of @xmath147 may converge to a strictly positive value at @xmath261 .",
    "the digraph we now consider is a completely random digraph with the constraint that each vertex has exactly @xmath11 parent vertices and @xmath11 child vertices ( i.e. , the in - degree and out - degree of every vertex is an integer @xmath11 ) .",
    "the weight of every arc in this digraph is set to be unity .",
    "for such a random digraph the bp equation ( [ eq : qjjpmarginal ] ) has a fixed point with all the parent - to - child cavity distributions @xmath262 for arcs @xmath10 $ ] being identical to the same probability function @xmath134 and all the child - to - parent cavity distributions @xmath263 being identical to the same probability function @xmath139 .",
    "furthermore we find that @xmath264 and @xmath265 for @xmath266 .",
    "following the general bp equation ( [ eq : qjjpmarginal ] ) , we obtain the self - consistent condition for the function @xmath134 as @xmath267^{\\alpha }        \\bigl [ \\sum\\limits_{h^{\\prime \\prime}=0}^{d-\\tilde{h } }          q_{p c}^{h^{\\prime \\prime } } \\bigr]^{\\alpha -1 } } \\ ; ,       \\label{eq : qpc0rrr } \\\\      q_{p c}^h & = &      \\frac{e^x        \\bigl [ \\sum\\limits_{h^\\prime=0}^{h-1 } q_{p c}^{h^\\prime } \\bigr]^{\\alpha }        \\bigl [ \\sum\\limits_{h^{\\prime \\prime}=0}^{d - h }          q_{p c}^{h^{\\prime \\prime } } \\bigr]^{\\alpha -1 } }           { 1 +   e^x \\sum\\limits_{\\tilde{h}=1}^{d }             \\bigl [ \\sum\\limits_{h^\\prime=0}^{\\tilde{h}-1 } q_{p c}^{h^\\prime }                \\bigr]^{\\alpha } \\bigl [ \\sum\\limits_{h^{\\prime \\prime}=0}^{d-\\tilde{h } }               q_{p c}^{h^{\\prime \\prime } } \\bigr]^{\\alpha -1 } } \\quad \\quad \\quad           ( h=1 , 2 , \\ldots , d ) \\ ; .",
    "\\label{eq : qpchrrr }    \\end{aligned}\\ ] ] these two equations have only a unique solution for any fixed values of the parameters @xmath62 and @xmath31 .",
    "we determine the value of @xmath268 through the following numerical procedure : ( 1 ) set @xmath269 to a value @xmath270 $ ] ; ( 2 ) determine the value @xmath271 by solving @xmath272 , and then determine @xmath273 according to @xmath274 ; ( 3 ) then determine the value of @xmath275 by solving @xmath276 and then determine @xmath277 according to @xmath278 ; ( 4 ) then continue to determine all the remaining probability items @xmath268 in the same sequential maner as steps ( 2 ) and ( 3 ) ; ( 5 ) then compute a new value of @xmath269 according to eq .",
    "( [ eq : qpc0rrr ] ) ; ( 6 ) if @xmath269 is different from the input value @xmath279 we then change @xmath279 appropriately and repeat steps ( 1)(5 ) until convergence is reached .    at the fixed point of eqs .",
    "( [ eq : qpc0rrr ] ) and ( [ eq : qpchrrr ] ) we then compute the relative size @xmath129 of fvs is @xmath280^{\\alpha }          \\bigl [ \\sum\\limits_{h^{\\prime \\prime}=0}^{d-\\tilde{h } }            q_{p c}^{h^{\\prime \\prime } } \\bigr]^{\\alpha -1 } } \\ ; .\\ ] ] the free entropy density @xmath70 is @xmath281^{\\alpha } \\bigl [ \\sum\\limits_{h^{\\prime \\prime}=0}^{d-\\tilde{h } }            q_{p c}^{h^{\\prime \\prime } } \\bigr]^{\\alpha -1 } \\biggr ]   \\nonumber \\\\        & &         - \\frac{(\\alpha - 1)}{x } \\ln \\biggl [          1 +   e^x \\sum\\limits_{\\tilde{h}=1}^{d }          \\bigl [ \\sum\\limits_{h^\\prime=0}^{\\tilde{h}-1 } q_{p c}^{h^\\prime }             \\bigr]^{\\alpha } \\bigl [ \\sum\\limits_{h^{\\prime \\prime}=0}^{d-\\tilde{h } }            q_{p c}^{h^{\\prime \\prime } } \\bigr]^{\\alpha } \\biggr ] \\ ; .",
    "\\end{aligned}\\ ] ] the entropy density is then simply computed as @xmath282 . at a given value of maximal height @xmath31 we can obtain the function @xmath283 by performing numerical calculations at different values of @xmath62 .",
    "the minimum relative size @xmath147 at this value of @xmath31 is then determined by solving @xmath284 .",
    "the plus symbols of fig .  [ fig : rrra20 ] are the predicted values of @xmath147 up to @xmath285 for the particular case of arc density @xmath286 .",
    "qualitatively the same mean field results are obtained for other values of the arc density @xmath11 .",
    "the predicted minimum value @xmath147 of fvs relative size for the special regular random digraph in which every vertex is connected to @xmath214 parent vertices and @xmath214 child vertices .",
    "the value of @xmath147 depends on the maximal height @xmath31 used in the rs mean field theory .",
    "the three fitting curves are @xmath287 ( long - dashed blue line ) , @xmath288 ( dashed blue line ) , and @xmath289 ( dotted red line ) . ,",
    "scaledwidth=55.0% ]    figure  [ fig : rrra20 ] demonstrates that @xmath147 decreases slowly with maximal height @xmath31 .",
    "we can fit the behaviour of @xmath147 as @xmath290 the fitting parameter @xmath291 is then the predicted minimum fvs relative size for an infinite random digraph .",
    "the fitted value of @xmath291 is sensitive to the range of @xmath31 values included in the fitting .",
    "for example , if we only use the data points of @xmath292 , we obtain @xmath293 , see the green long - dashed line of fig .",
    "[ fig : rrra20 ] ; if we use the data points of @xmath294 we obtain a value @xmath295 , see the blue dashed line of fig .",
    "[ fig : rrra20 ] .",
    "it s not easy for us to compute @xmath147 for @xmath296 , but we anticipate that if more @xmath147 data obtained at very large @xmath31 values are included in the fitting , the fitted @xmath291 will further decrease . on the other hand , we observe that if we fix @xmath297 the fitting can not capture the asymptotic behaviour of @xmath147 at @xmath298 ( see dotted red curve of fig .",
    "[ fig : rrra20 ] ) . therefore we believe @xmath291 should be strictly positive .",
    "10                    a.  mochizuki , b.  fiedler , g.  kurosawa , and d.  saito . dynamics and control at feedback vertex sets .",
    "ii : a faithful monitor to determine the diversity of molecular activities in regulatory networks . , 335:130146 , 2013 .",
    "p. festa , p.  m. pardalos , and m.  g.  c. resende .",
    "feedback set problems . in d",
    "du and p.  m. pardalos , editors , _ handbook of combinatorial optimization _ , pages 209258 .",
    "springer , berlin , germany , 1999 .",
    "c .- l . chang and y .- d .",
    "lyuu . triggering cascades on strongly connected directed graphs . in _ proceedings of the fifth international symposium on parallel architectures , algorithms and programming ( paap ) _ , pages 9599 .",
    "ieee , 2012 ."
  ],
  "abstract_text": [
    "<S> a directed graph ( digraph ) is formed by vertices and arcs ( directed edges ) from one vertex to another . </S>",
    "<S> a feedback vertex set ( fvs ) is a set of vertices that contains at least one vertex of every directed cycle in this digraph . </S>",
    "<S> the directed feedback vertex set problem aims at constructing a fvs of minimum cardinality . </S>",
    "<S> this is a fundamental cycle - constrained hard combinatorial optimization problem with wide practical applications . in this paper </S>",
    "<S> we construct a spin glass model for the directed fvs problem by converting the global cycle constraints into local arc constraints , and study this model through the replica - symmetric ( rs ) mean field theory of statistical physics . </S>",
    "<S> we then implement a belief propagation - guided decimation ( bpd ) algorithm for single digraph instances . </S>",
    "<S> the bpd algorithm slightly outperforms the simulated annealing algorithm on large random graph instances . </S>",
    "<S> the predictions of the rs mean field theory are noticeably lower than the bpd results , possibly due to its neglect of cycle - caused long range correlations .    </S>",
    "<S> janary 17 , 2016 ( first version ) ; april 04 , 2016 ( revised version ) </S>"
  ]
}