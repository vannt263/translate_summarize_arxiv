{
  "article_text": [
    "the availability of increasing amounts of genomic data is making the use of statistical models to predict traits of interest a mainstay of many applications in life sciences .",
    "applications range from medical diagnostics for common and rare diseases to breeding characteristics such as disease resistance in plants and animals of commercial interest .",
    "we explored an implicit assumption of how such prediction models are often assessed : that the individuals whose traits we would like to predict originate from the same population as those that are used to train the models .",
    "this is commonly not the case , especially in the case of plants and animals that are parts of selection programs . to study this problem we proposed a model - agnostic approach to infer the accuracy of prediction models as a function of two common measures of genetic distance .",
    "using data from plant , animal and human genetics , we find that accuracy decays approximately linearly in either of those measures .",
    "quantifying this decay has fundamental applications in all branches of genetics , as it measures how studies generalise to different populations .",
    "predicting unobserved phenotypes using high - density snp or sequence data is the foundation of many applications in medical diagnostics @xcite , plant @xcite and animal @xcite breeding .",
    "the accuracy of genomic predictions will depend on a number of factors : relatedness among genotyped individuals @xcite ; the density of the markers @xcite ; and the genetic architecture of the trait , in particular the allele frequencies of causal variants @xcite and the distribution of their effect sizes @xcite .    most of these issues have been explored in the literature , and have been tackled in various ways either from a methodological perspective or by producing larger data sets and more accurate phenotyping .",
    "however , the extent to which predictive models generalise from the populations used to train them to distantly related target populations appears not to have been widely investigated ( two exceptions are @xcite ) .",
    "the accuracy of prediction models is often evaluated in a general setting using cross - validation with random splits , which implicitly assumes that test individuals are drawn from the same population as the training sample ; in that case accuracy to predict phenotypes is only bounded by heritability , although unaccounted `` missing heritability '' is common @xcite .",
    "however , this assumption is violated in many practical applications , such as genomic selection , that require predictions of individuals that are genetically distinct from the training sample : for instance , causal variants may differ in both frequency and effect size between different ancestry groups ( in humans , e.g. @xcite for lactose persistence ) , subspecies ( in plants and animals , e.g. @xcite for rice ) or even families @xcite .",
    "in such cases cross - validation with random splits may overestimate predictive accuracy due to the mismatch between model validation and the prediction problem of interest @xcite even when population structure is taken into account @xcite .",
    "the more distantly the target population is related to the training population , the lower the average predictive accuracy of a genomic model ; this has been demonstrated on both simulated and real dairy cattle data @xcite .    in this paper",
    "we will investigate the relationship between genetic distance and predictive accuracy in the prediction of quantitative traits .",
    "we will simulate training and target samples with varying genetic distances by splitting the training population into a sequence of pairs of subsets with increasing genetic differentiation .",
    "we will measure predictive accuracy with pearson s correlation , which we will estimate by performing genomic prediction from one subset to the other in each pair . among various measures of relatedness available in the literature",
    ", we will consider mean kinship and @xmath0 , although we will only focus on the latter .",
    "we will then study the mean pearson s correlation as a function of genetic distance , which we will refer to as the `` decay curve '' of the former over the latter .",
    "this approach is valuable in addressing several key questions in the implementation of genomic selection programs , such as : how often ( e.g. , in terms of future generations ) will the genomic prediction model have to be re - estimated to maintain a minimum required accuracy in the predictions of the phenotypes ?",
    "how should we structure our training population to maximise that accuracy ?",
    "which new , distantly related individuals would be beneficial to introduce in a selection program for the purpose of maintaining a sufficient level of genetic variability ?",
    "a baseline model for genomic prediction of quantitative traits is the genomic blup ( gblup ; @xcite ) , which is usually written as @xmath1 where @xmath2 is a vector of genetic random effects , @xmath3 is a design matrix that can be used to indicate the same genotype exposed to different environments , @xmath4 is a kinship matrix and @xmath5 is the error term .",
    "many of its properties are available in closed form thanks to its simple definition and normality assumptions , including closed form expressions of and upper bounds on predictive accuracy that take into account possible model misspecification @xcite .",
    "other common choices are additive linear regression models of the form @xmath6 where @xmath7 is the trait of interest ; @xmath8 are the markers ( such as snp allele counts coded as @xmath9 , @xmath10 and @xmath11 with @xmath10 the heterozygote ) ; @xmath12 are the marker effects ; and @xmath5 are independent , normally - distributed errors with variance @xmath13 . depending on the choice of the prior distribution for @xmath12 , we can obtain different models from the literature such as bayesa and bayesb @xcite , ridge regression @xcite , the lasso @xcite or the elastic net @xcite . the model in eq .",
    "( [ eq : blup ] ) is equivalent to that in eq .",
    "( [ eq : bayesreg ] ) if the kinship matrix @xmath4 is computed from the markers @xmath8 and has the form @xmath14 and @xmath15 @xcite . in the remainder of the paper we will focus on the elastic net , which we have found to outperform other predictive models on real - world data @xcite .",
    "this has been recently confirmed in @xcite .",
    "predictive accuracy is often measured by the pearson correlation ( @xmath16 ) between the predicted and observed phenotypes .",
    "when we use the fitted values from the training population as the predicted phenotypes , and assuming that the model is correctly specified , @xmath17 coincides with the proportion of genetic variance of the trait explained by the model and therefore @xmath18 , the heritability of the trait .",
    "( an incorrect model may lead to overfitting , and in that case @xmath19 . )",
    "when using cross - validation with random splits , @xmath20 and typically the difference will be noticeable ( @xmath21 ) .",
    "however , @xmath22 may still overestimate the actual predictive accuracy @xmath23 in practical applications where target individuals for prediction are more different from the training population than the test samples generated using cross - validation @xcite .",
    "this problem may be addressed by the use of alternative model validation schemes that mirror more closely the prediction task of interest ; for instance , by simulating progeny of the training population to assess predictive accuracy for a genomic selection program .",
    "this approach is known as forward prediction and is common in animal breeding @xcite .",
    "another possible choice is the prediction error variance ( pev ) .",
    "it is commonly used in conjunction with gblup because , for that model , it can be estimated ( for small samples ) or approximated ( for large samples ) in closed form from henderson s mixed model equations @xcite . in the general case",
    "no closed form estimate is available , but pev can still be derived from pearson s correlation @xcite for any kind of model as both carry the same information : @xmath24 for consistency with our previous work @xcite and with @xcite , whose results we partially replicate below , we will only consider predictive correlation in the following .      a common measure of kinship from marker data is average allelic correlation @xcite , which is defined as @xmath25 $ ] with @xmath26 where @xmath27 and @xmath28 are the standardised allele counts for the @xmath29th and @xmath30th individuals and the @xmath31th marker .",
    "an important property of allelic correlation is that it is inversely proportional to the euclidean distance between the marker profiles @xmath32 of the corresponding individuals : if the markers are standardised @xmath33    this result has been used in conjunction with clustering methods such as _ k_-means or partitioning around medoids ( pam ; @xcite ) to produce subsets of minimally related individuals from a given sample by maximising the euclidean distance @xcite .    at the population level",
    ", the divergence between two populations due to drift , environmental adaptation , or artificial selection is commonly measured with @xmath0 .",
    "several estimators are available in the literature , and reviewed in @xcite . in this paper we will adopt the estimator from @xcite , which is obtained by maximising the beta - binomial likelihood of the allele frequencies as a function of @xmath0 .",
    "@xmath34 then describes how far the target population has diverged from the training population , which translates to `` how far '' a genomic prediction model will be required to predict . in terms of kinship , we know from the literature that the mean kinship coefficient @xmath35 between two individuals in different populations is inversely related to @xmath34 @xcite : kinship can be interpreted as the probability that two alleles are identical by descent , which is inversely related to @xmath0 which is a mean inbreeding coefficient .",
    "intuitively , the fact that individuals in the two populations are closely related implies that the latter have not diverged much from the former : if @xmath35 is large , the marker profiles ( and therefore the corresponding allele frequencies ) will on average be similar . as a result ,",
    "any clustering method that uses the euclidean distance to partition a population into subsets will maximise their @xmath0 by minimising @xmath35 .",
    "the simulations and data analyses below confirm experimentally that @xmath35 and @xmath34 are highly correlated , which makes them equivalent in building the decay curves ; thus we will report results only for @xmath34 ( see section c , ) .",
    "we evaluate our approach to construct decay curves for predictive accuracy using two publicly - available real - world data sets with continuous phenotypic traits , and a third , human , genotype data set .    * wheat .",
    "* we consider @xmath36 wheat varieties from the triticeaegenome project , described in @xcite .",
    "varieties collected from those registered in france ( @xmath37 varieties ) , germany ( @xmath38 varieties ) and the uk ( @xmath39 varieties ) between 1946 and 2007 were genotyped using a combination of @xmath40 predominantly dart markers .",
    "several traits were recorded ; in this paper we will focus on grain yield , height , flowering time , and grain protein content .",
    "genotype - environment interactions were accounted for by an incomplete block design over trial fields in different countries , to prevent genomic prediction being biased by the country of registration of each variety . as in @xcite , we also group varieties in three groups based on their year of registration : pre-1990 ( @xmath41 varieties ) , 1990 to 1999 ( @xmath42 varieties ) , and post-1999 ( @xmath43 varieties ) .    * mice . *",
    "the heterogeneous mice population from @xcite consists of @xmath44 individuals genotyped with @xmath45 snps ; among the recorded traits , we consider growth rate and weight .",
    "the data include a number of inbred families , the largest being f005 ( @xmath46 mice ) , f008 ( @xmath47 mice ) , f010 ( @xmath48 mice ) and f016 ( @xmath49 mice ) .",
    "* human . *",
    "the marker profiles from the human genetic diversity panel @xcite include @xmath50 individuals from different ancestry groups : @xmath51 from africa , @xmath52 from america , @xmath53 from asia , @xmath54 from europe , @xmath55 from the middle east and @xmath56 from oceania .",
    "each has been genotyped with @xmath57 snps ; for computational reasons we only use those in chromosomes @xmath10 and @xmath11 , for a total of @xmath58 snps .",
    "all data sets have been pre - processed by removing markers with minor allele frequencies @xmath59 and those with @xmath60 missing data .",
    "the missing data in the remaining markers have been imputed using the * impute * r package @xcite . finally , we removed one marker from each pair whose allele counts have correlation @xmath61 to increase the numerical stability of the genomic prediction models .",
    "we estimate a decay curve of @xmath23 as a function of @xmath0 as follows :    1 .",
    "produce a pair of minimally related subsets ( i.e. , with maximum @xmath0 ) from our training population using _",
    "k_-means clustering , @xmath62 in r @xcite .",
    "pam was also considered as an alternative clustering method , but produced subsets identical to those from _",
    "k_-means for all the data sets studied in this paper .",
    "the largest of these two subsets will be used to train the genomic prediction model , and will be considered the ancestral population for the purposes of computing @xmath0 ; the smallest will be the target used for prediction . in the following",
    "we will call them the _ training subsample _ and the _ target subsample _ , respectively . [",
    "item : kmeans ] 2 .",
    "compute @xmath63 and @xmath64 for the pair of subsets with a genomic prediction model .",
    "we compute @xmath63 using the beta - binomial estimator from @xcite ; and we compute @xmath64 with the elastic net implementation in the * glmnet * r package @xcite . other models can be used : the proposed approach is model - agnostic as it only requires the chosen model to be able to produce estimates of its predictive correlation .",
    "the optimal values for the penalty parameters of the elastic net are chosen to maximise @xmath65 on the training subset using @xmath66 runs of @xmath67-fold cross - validation as in @xcite .",
    "@xmath68 will act as the far end of the decay curve ( in terms of genetic distance ) .",
    "[ item : methods ] 3 .",
    "for increasing numbers @xmath69 of individuals : 1 .",
    "create a new pair of subsamples by swapping @xmath69 individuals at random between the training and the test subsamples from step [ item : kmeans ] ; 2 .   fit a genomic prediction model on the new training subsample and use it to predict the new target subsample , thus obtaining @xmath70 using the same algorithms as in step [ item : methods ] .",
    "4 .   estimate the decay curve from the sets of @xmath70 points using local regression ( loess ; @xcite ) , which can be used to produce both the mean and its @xmath71 confidence interval at any point in the range of observed @xmath34 .",
    "we denote with @xmath23 the resulting estimate of predictive correlation for any given @xmath34 .    the pair of subsets produced by _",
    "k_-means corresponds to @xmath72 , hence the notation @xmath68 , and we increase @xmath69 by steps of @xmath11 to @xmath73 until the @xmath34 between the subsamples is at most @xmath74 .",
    "we choose the stepping for each data set to be sufficiently small to cover the interval @xmath75 $ ] as uniformly as possible .",
    "the larger @xmath69 is , the smaller we can expect @xmath76 to be .",
    "we repeat step 3(a ) and 3(b ) @xmath77 times for each @xmath69 to achieve the precision needed for an acceptably smooth curve .    as an alternative approach ,",
    "we also consider estimating the decay rate of @xmath23 by linear regression of the @xmath78 against the @xmath76 ; we will denote the resulting predictive accuracy estimates with @xmath79 .",
    "for any set value of @xmath34 , we compare the @xmath79 at that @xmath34 with the corresponding value @xmath23 from the decay curve estimated by averaging all the @xmath78 for which @xmath80 . assuming that the decay curve is in fact a straight line reduces the number of subsamples that we need to generate , enforces smoothness and makes it possible to compute @xmath79 for values of @xmath0 larger than @xmath63 . on the other hand",
    ", the estimated @xmath79 will be increasingly unreliable as @xmath81 , because the regression line will provide negative @xmath79 instead of converging asymptotically to zero .",
    "we also regress the @xmath82 against the @xmath83 to investigate whether they have a stronger linear relationship than the @xmath78 with the @xmath76 , as suggested in @xcite using simulated genotypes and phenotypes mimicking a dairy cattle population .",
    "the size of the training ( @xmath84 ) and target ( @xmath85 ) subsamples is determined by _ k_-means . for the data used in this paper , _",
    "k_-means splits the training populations in two subsamples of comparable size ; but we may require a smaller @xmath86 to estimate @xmath64 and the @xmath78 while at the same time a larger @xmath84 is needed to fit the genomic prediction model",
    ". in that case , we increase @xmath84 by moving individuals from the target subsample while keeping the @xmath63 between the two as large as possible .",
    "the impact on the estimated @xmath34 is likely to be small , because its precision depends more on the number of markers than on @xmath84 and @xmath85 @xcite .",
    "the estimated @xmath87 and @xmath78 might be inflated because we are altering the subsets , even when @xmath34 does not change appreciably .",
    "its variance , which can be approximated as in @xcite , decreases linearly in @xmath85 except that can be compensated by generating more pairs of subsamples for each value of @xmath69 .",
    "we study the behaviour of the decay curves via two simulation studies .",
    "* genomic selection .",
    "* we simulate a genomic selection program using the wheat varieties registered in the last @xmath66 years of the wheat data as founders .",
    "the simulation is a forward simulation implemented as follows for @xmath67 , @xmath88 , @xmath89 and @xmath90 causal variants , and decay curves are produced for each .    1",
    ".   we set up a training population of @xmath89 founders : @xmath91 varieties from the wheat data , @xmath92 obtained from the former via random mating without selfing using the * haplosim * r package @xcite .",
    "* haplosim * assumes that markers are allocated at regular intervals across the genome , we allocated them uniformly in @xmath93 chromosomes ( wheat varieties in the wheat data are allohexaploid , with @xmath94 = @xmath95 = @xmath96 ) to obtain roughly the desired amount of recombination and to preserve the linkage disequilibrium patterns as much as possible .",
    "[ item : geno ] 2 .",
    "we generate phenotypes by selecting causal variants at random among markers with minor allele frequency @xmath97 and assigning them normally - distributed additive effects with mean zero .",
    "noise is likewise normally distributed with mean zero and standard deviation @xmath10 , and the standard deviation of the additive effects is set such that @xmath98 .",
    "we choose this value as the mid - point of a range of heritabilities , @xmath99 $ ] , we consider to be of interest .",
    "[ item : pheno ] 3 .",
    "we fit a genomic prediction model on the whole training population .",
    "[ item : gs ] 4 .   for @xmath100 times",
    ", we perform a sequence of @xmath67 rounds of selection . in each round : 1 .",
    "we generate the marker profiles of @xmath89 progeny via random mating , again without selfing ; [ item : markers ] 2 .",
    "we generate the phenotypes for the progeny as in step [ item : pheno ] ; [ item : curpheno ] 3 .",
    "we compute the @xmath34 between the training population and the progeny generated in [ item : markers ] ; 4 .",
    "we use the marker profiles from step [ item : markers ] and the genomic prediction model from [ item : gs ] to obtain predicted values for the phenotypes , which are then used together with those from step [ item : curpheno ] to compute predictive correlation ; 5 .",
    "we select the @xmath73 individuals with the largest phenotypes as the parents of the next round of selection .",
    "we compute the average predictive correlation @xmath101 and the average @xmath34 for each round of selection , which are used as reference points to assess how well the results of the genomic selection simulation are predicted by the decay curve .",
    "[ item : avg ] 6 .",
    "we estimate the decay curve @xmath70 and its linear approximation @xmath79 from the training population , and we compare it with the average @xmath102 reference points from step [ item : avg ] .",
    "we then repeat this simulation after adding the varieties available at the end of the second round of selection to the training population while considering the scenario with @xmath89 and @xmath90 causal variants .",
    "the size of the training population is thus increased to @xmath103 varieties , allowing us to explore the effects of a larger sample size and of considering new varieties from the breeding program to update the genomic prediction models when their predictive accuracy is no longer acceptable . in the following ,",
    "we refer to this second population as the `` augmented population '' as opposed to the `` original population '' including only the @xmath89 varieties described in steps [ item : geno ] and [ item : pheno ] above",
    ".    * cross - population prediction .",
    "* we explore cross - population predictions using the human data and simulated phenotypes . similarly to the above , we pick @xmath66 , @xmath73 , @xmath100 , @xmath104 , @xmath105 and @xmath106 causal variants at random among those with minor allele frequency @xmath97 and we assign them normally - distributed effects such that @xmath98 .",
    "the same effect sizes are used for all populations .",
    "we then use individuals from asia as the training population to estimate the decay curves .",
    "those from other continents are the target populations for which we are assessing predictive accuracy , and we compute their @xmath34 and the corresponding predictive correlations @xmath107 .",
    "we use the @xmath108 points as terms of comparison to assess the quality of the curve , which should be close to them or at least cross the respective @xmath71 confidence intervals .",
    "finally , we estimate the decay curves for some of the phenotypes available in the wheat and mice data . for both data sets we also produce and average @xmath77 values of @xmath65 using hold - out cross - validation . in hold - out cross - validation",
    "we repeatedly split the data at random into training and target subsamples whose sizes are fixed to be the same as those arising from clustering in step [ item : kmeans ] of the decay curve estimation .",
    "then we fit an elastic net model on the training subsamples and predict the phenotypes in the target subsamples to estimates @xmath65 .",
    "ideally , the decay curve should cross the area in which the @xmath109 points cluster .    * wheat data . * for the wheat data , we construct decay curves for grain yield , height , flowering time and grain protein content using the french wheat varieties as the training population .",
    "uk and german varieties are the target populations , for which we estimate @xmath108 . furthermore , we also construct a second decay curve for yield using the varieties registered before 1990 as the training population , as in @xcite .",
    "varieties registered between 1990 and 1999 , and those registered after 2000 , are used as target populations .",
    "* mice data . * for the mice data , we construct decay curves for both growth rate and weight using each of the f005 , f008 , f010 and f016 inbred families in turn as the training population ; the remaining families are used as target populations ."
  ],
  "abstract_text": [
    "<S> the prediction of phenotypic traits using high - density genomic data has many applications such as the selection of plants and animals of commercial interest ; and it is expected to play an increasing role in medical diagnostics . </S>",
    "<S> statistical models used for this task are usually tested using cross - validation , which implicitly assumes that new individuals ( whose phenotypes we would like to predict ) originate from the same population the genomic prediction model is trained on .    in this paper </S>",
    "<S> we propose an approach based on clustering and resampling to investigate the effect of increasing genetic distance between training and target populations when predicting quantitative traits . </S>",
    "<S> this is important for plant and animal genetics , where genomic selection programs rely on the precision of predictions in future rounds of breeding . </S>",
    "<S> therefore , estimating how quickly predictive accuracy decays is important in deciding which training population to use and how often the model has to be recalibrated . </S>",
    "<S> we find that the correlation between true and predicted values decays approximately linearly with respect to either @xmath0 or mean kinship between the training and the target populations . </S>",
    "<S> we illustrate this relationship using simulations and a collection of data sets from mice , wheat and human genetics . </S>"
  ]
}