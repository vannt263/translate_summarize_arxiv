{
  "article_text": [
    "what is a relation between the lmmp and some concrete geometrical results such as polyhedral properties of effective and mobile cones for ft varieties , finiteness results for modifications of ft varieties and minimal models , factorization of birational isomorphisms of mori fibrations into sarkisov links and birational rigidity ?",
    "one of the possible explanations for those relations can be found by exploring the geography of log models .",
    "this paper presents this explanation that was originally introduced in @xcite @xcite and partially developed in @xcite .",
    "we always assume the lmmp and the semiampleness conjecture .",
    "one can find a detailed information about those conjectures and which of their variations are needed in section  [ section7-lmmp - semi ] .",
    "take a pair @xmath0 where @xmath1 is a proper morphism and @xmath2 is a reduced b - divisor of @xmath1 with the distinct prime components @xmath3 . in this section",
    "we introduce @xmath4 equivalence relations on the _ unit cube _ : @xmath5 s_i \\cong [ 0,1]^m.\\ ] ]    an element @xmath6 will be referred to as a _ boundary _",
    "divisor even when it is actually a b - boundary . for the concepts of the lmmp used in these relations , see section  [ section7-lmmp - semi ] .",
    "[ [ model - equivalence . ] ] model equivalence .",
    "+ + + + + + + + + + + + + + + + + +    boundaries @xmath7 are _ model equivalent _ and we write @xmath8 if the pairs @xmath9 have the same set of resulting models @xcite .",
    "[ [ weakly - log - canonical - equivalence . ] ] weakly log canonical equivalence .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    boundaries @xmath7 are _ wlc model equivalent _ and we write @xmath10 if both pairs @xmath9 have the same wlc models and the models are numerically equivalent , that is : for any model @xmath11 of @xmath1 ,    @xmath12 is a wlc model of @xmath13 if and only if @xmath14 is a wlc model of @xmath15 ; and    the divisors @xmath16 have the same signatures with respect to the intersection for all curves on @xmath11 .    [",
    "[ log - canonical - model - equivalence . ] ] log canonical model equivalence .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    boundaries @xmath7 are _ lc model equivalent _ and we write @xmath17 if the pairs",
    "@xmath9 have the same ( rational ) iitaka fibrations : for a given ( rational ) contraction @xmath18 , @xmath19 is an iitaka fibration for @xmath20 if and only if @xmath19 is an iitaka fibration for @xmath21 , or equivalently , @xmath13 has a ( rational ) iitaka fibration @xmath22 if and only if @xmath15 has a ( rational ) iitaka fibration @xmath23 and the fibrations are naturally isomorphic , that is , there is a commutative diagram    @xmath24\\ar@{-->}[rd ] & \\\\",
    "y\\ar[rr]^{\\cong } & & y ' } \\ ] ] with the natural isomorphism @xmath25 .",
    "[ [ mobile - equivalence . ] ] mobile equivalence .",
    "+ + + + + + + + + + + + + + + + + + +    boundaries @xmath7 are _ mobile equivalent _ and we write @xmath26 if the positive parts @xmath27 of both b - divisors @xmath28 have the same signatures with respect to the curves on rather high models @xmath11 . on a rather high model",
    "we can take any model @xmath11 over some wlc models of @xmath9 .",
    "[ [ fixed - equivalence . ] ] fixed equivalence .",
    "+ + + + + + + + + + + + + + + + + +    boundaries @xmath7 are _ fix equivalent _ and we write @xmath29 if the fixed parts @xmath30 of both",
    "b - divisors @xmath28 have the same signatures of their multiplicities , that is : for any prime b - divisor @xmath31 , @xmath32    note that all the relations above are defined on the whole @xmath33 .",
    "the resulting models obtained by the lmmp are at least projective , and even slt by the slt lmmp .",
    "an abstract definition of resulting models gives a larger class of them .",
    "however , according to the following it is enough to consider only the good ones : projective @xmath34-factorial wlc models , e.g. , slt wlc models .",
    "[ prop - qfact - proj ] the equivalence @xmath35 for projective @xmath34-factorial wlc models is the same as that for all wlc models",
    ".    any non-@xmath34-factorial wlc model can be obtained by a crepant contraction of some @xmath34-factorial wlc model that gives a wlc model by the semiampleness .",
    "any @xmath34-factorial nonprojective wlc model can be obtained from a projective and @xmath34-factorial wlc model by a ( generalized ) log flop .",
    "both constructions use the slt lmmp and @xcite .",
    "thus if the pairs have the same projective and @xmath34-factorial , numerically equivalent models , they have the same numerically equivalent wlc models .",
    "the converse statement means that each projective and @xmath34-factorial wlc model of @xmath13 will be also projective and @xmath34-factorial wlc model of @xmath15 when @xmath10 ( cf .",
    "the proof of lemma [ lemma - convex relations ] ) .",
    "[ convention ] the model equivalences @xmath36 are defined for projective and @xmath34-factorial resulting models of pairs .",
    "in fact , we can even use slt wlc models since proposition [ prop - qfact - proj ] holds for slt wlc models too . in",
    "most of constructions below , we use slt wlc resulting models",
    ". however , slt wlc models are not stable for limits of boundaries ( see lemma [ lemma - closed n ] ) .",
    "the following relations hold for model equivalences .",
    "[ prop - equivalence ] we have the following implications : @xmath37 @xmath38    immediate by definition and the semiampleness [ conj - semiample ] .    in general , @xmath39 for example , @xmath40 follows from the fact that the small modifications of flopping facets preserve the @xmath41 equivalence relation but not @xmath42 ( see theorem [ thrm - facet types ] , [ thrm - ridge types ] ) .",
    "define the subset of @xmath33 : @xmath43 equivalently , we can also use the condition : @xmath44 ( see numerical kodaira dimension in section [ section7-lmmp - semi ] ) .",
    "moreover , by the semiampleness [ conj - semiample ] , this is equivalent to the nonnegativity of ( invariant ) kodaira dimension ( see kodaira dimension in section [ section7-lmmp - semi ] ) : @xmath45 .",
    "proposition [ prop - equivalence ] implies that @xmath35 is the finest of the model equivalences on @xmath46 .",
    "thus , for the pairs with wlc models , the finiteness and polyhedral properties of all the equivalence relations follow from those of @xmath35 .",
    "all the above equivalence relations , except for @xmath42 , are not interesting outside @xmath46 because they are trivial on @xmath47 .",
    "it is expected that many similar properties hold for @xmath42 on @xmath33 in the case of mori log fibrations @xcite and that plays an important role for the genuine sarkisov program .",
    "recall that @xmath48 is the @xmath49-vector space of b - divisors spanned by @xmath50 : @xmath51 the space @xmath48 contains the cube @xmath33 .",
    "a _ convex polyhedron _ @xmath52 in @xmath48 is a set defined by the intersection of finitely many ( open or closed ) half spaces and hyperplanes in @xmath48 .",
    "a _ polyhedron _ is a finite union of convex ones .",
    "a convex polyhedron @xmath52 is said to be _ open _ in @xmath48 if the half spaces in the intersection are open .",
    "the closure @xmath53 , the interior @xmath54 , and the boundary @xmath55 of a convex polyhedron @xmath52 will be taken in its linear span , the minimal intersection of hyperplanes containing @xmath52 .",
    "@xmath56 of a convex polyhedron @xmath52 is the intersection @xmath57 ( possibly @xmath58 or @xmath53 itself ) for some hyperplane @xmath59 such that @xmath60 .",
    "a _ facet _ of @xmath52 is a maximal face , that is , a face of dimension @xmath61 .",
    "a _ ridge _ is a facet of a facet .    for two distinct vectors @xmath62",
    ", @xmath63 denotes the open ray starting from @xmath64 through @xmath65 and @xmath66 denotes the line through @xmath64 and @xmath65 .",
    "@xmath67 $ ] ( @xmath68 , etc ) is defined as the closed ( resp .",
    "half closed , open , etc ) interval between @xmath64 and @xmath65 .",
    "let @xmath52 be a convex polyhedron in @xmath33 .",
    "a facet ( face ) @xmath56 of @xmath52 is _ given by a facet @xmath69 of _",
    "@xmath33 if @xmath70 . the facet ( resp .",
    "face ) @xmath69 is given by equation @xmath71 or @xmath72 .",
    "thus @xmath56 can be given in @xmath53 by one of those equations .",
    "note the following property of the linear function @xmath73 on @xmath48 : if @xmath74 ( respectively @xmath75 ) in @xmath76 and @xmath77 ( respectively @xmath78 ) in some point of @xmath52 , then @xmath74 ( respectively @xmath75 ) on @xmath56 and @xmath77 ( respectively @xmath78 ) in @xmath79 .    by a _ geography _ on @xmath46 ,",
    "we mean a finite rational polyhedral decomposition of it , and the subsets @xmath80 of such a decomposition will be referred to as _ classes _ or just _",
    "polyhedrons_. we call a class @xmath81 of maximal dimension , @xmath82 , a _ country _ , a class @xmath56 of codimension 1 a _ facet _ , and a class @xmath83 of codimension 2 a _",
    "ridge_.    according to the following , each of the above equivalence relations defines a geography on @xmath46 , but the notations @xmath46 will be reserved only for the _ wlc _ geography given by @xmath35 .",
    "thus we consider @xmath46 as a set with the structure .",
    "let @xmath56 be a minimal face of @xmath33 which contains a polyhedron @xmath52 .",
    "we say that a polyhedron @xmath52 is open in @xmath33 if it is open in @xmath56 , that is , @xmath84 , where @xmath85 is an open polyhedron in @xmath48 .",
    "[ mainthrm - geography]the set @xmath46 is closed convex rational polyhedral and it is decomposed into a finite number of @xmath35 classes @xmath52 .",
    "each class @xmath52 of the wlc geography is a convex rational polyhedron which is open in @xmath33 . for two classes",
    "@xmath86 , @xmath87 holds if and only if @xmath88 is a face of @xmath53 .",
    "let @xmath89 be a projective surface with a contraction @xmath90 of a nonsingular rational curve @xmath91 .",
    "consider the pairs @xmath13 where @xmath92c$ ] .",
    "then by the adjunction formula , we have the equality @xmath93 . if @xmath94 , the pair @xmath95 is a wlc model of itself .",
    "if @xmath96 , @xmath97 is a wlc model of @xmath95 . in total , we have the following geography :    example1.eps ( -1,-10)@xmath75 ( 42,-10)@xmath98 ( 96,-10)@xmath99    in this example , we have the following :    1 .   @xmath100 ; 2 .   there are three @xmath35 classes in @xmath46 : @xmath101 @xmath102 @xmath103c$ ] ; 3 .",
    "there are two @xmath104 classes : @xmath105c$ ] ; 4 .",
    "@xmath106 , but @xmath107 : @xmath108 .",
    "[ example - cremona ] suppose that @xmath109 and @xmath110 are related by a standard quadratic transformation .",
    "choose a general nonsingular prime b - divisor @xmath111 where @xmath112 is a straight line on @xmath113 for @xmath114 .",
    "consider the geography in the unit cube @xmath33 where @xmath115 .",
    "example2.eps ( 10,75)@xmath116 ( 50,50)@xmath117 ( 75,10)@xmath118 ( -23,71)@xmath119 ( -12,95)@xmath120 ( 65,-12)@xmath121 ( 95,-10)@xmath122    in particular , @xmath123 are resulting models for @xmath116 and @xmath118 .",
    "two @xmath124 s are isomorphic under an unnatural isomorphism ( the quadratic transform ) : @xmath116 and @xmath118 are different classes for @xmath42 .",
    "however , @xmath125 and @xmath104 is not convex .",
    "[ lemma - convex relations]@xmath35 is convex in @xmath46 .",
    "the proof of ( * ? ? ? * lemma  2 ) . )",
    "if @xmath10 and @xmath12 is a projective @xmath34-factorial wlc model of @xmath13 , then @xmath126 is a projective @xmath34-factorial wlc model of @xmath15 .",
    "moreover , for any @xmath127 $ ] , @xmath128 is a projective @xmath34-factorial wlc model of @xmath129 .",
    "the models are numerically equivalent to the edge models @xmath130 @xmath126 . thus all",
    "@xmath128 have the same ( generalized ) log flops and wlc models .",
    "note that @xmath131 are linear with respect to @xmath31 and by proposition [ prop - equivalence ] , @xmath132 has the same signatures for all multiplicities with respect to the prime b - divisors .",
    "thus the log flops of @xmath128 corresponding to wlc models are the same for all @xmath127 $ ] ( cf .",
    "corollary [ cor - property - p - e ] ( 1 ) ) .",
    "we say that a _ set _ @xmath52 in a finite dimensional @xmath49-vector space @xmath133 is _ locally conical _ if for any point @xmath134 in @xmath133 , there exists an open neighborhood @xmath135 containing @xmath134 such that the intersection @xmath136 is conical .",
    "in other words , for any @xmath137 , either @xmath138 or @xmath139 . a _ decomposition _ of a set into disjoint subsets @xmath52",
    "is said to be _ locally conical _ if each @xmath52 is locally conical with the same @xmath135 .",
    "as we will see shortly , any wlc geography is a locally conical decomposition of @xmath46 .",
    "[ lemma - locally conical ] let @xmath140 be a closed bounded ( convex ) set in a finite dimensional @xmath49-vector space .",
    "then @xmath140 is locally conical if and only if @xmath140 is polyhedral .",
    "we use induction on @xmath141 .",
    "the case @xmath142 is trivial .",
    "let @xmath143 and assume that the lemma holds in @xmath144 .",
    "the property of being locally conical is preserved under taking hyperplane sections .",
    "therefore by the inductive assumption , all the sections of @xmath140 are polyhedral .",
    "this implies that the set @xmath140 is polyhedral by the following standard criterion @xcite :    @xmath140 is polyhedral if and only if all of its @xmath145-dimensional plane sections are polyhedral where @xmath146 .",
    "the converse is clear .",
    "[ lemma - closed n]let @xmath147 be a sequence of boundaries converging to a limit @xmath148 , and @xmath11 be a model of @xmath1 such that @xmath149 is a sequence of wlc models of @xmath150 .",
    "then @xmath12 is a wlc model of @xmath13 .",
    "in particular , @xmath151 .",
    "however , @xmath12 may not be a slt wlc model of @xmath13 even if all models @xmath149 are slt wlc models of @xmath150 .",
    "we call a model @xmath12 in the lemma _ limiting _ from a class @xmath52 if all @xmath152 .",
    "immediate by definition .",
    "first , we establish the finiteness , convexity , and polyhedral property for the closures @xmath53 of the classes in the geography .",
    "note that the closures do not give a decomposition but , by lemma [ lemma - closed n ] , @xmath46 is a finite union of these closures . in particular , @xmath46 is closed .",
    "the convexity of wlc classes follows from lemma  [ lemma - convex relations ] .    the polyhedral property of @xmath53 follows from the locally conical property of @xmath53 by lemma [ lemma - locally conical ] and its compactness .",
    "the conical property for @xmath53 follows from that of @xmath52 : the closure of a locally conical set is locally conical . but",
    "@xmath52 is locally conical by the stability of wlc models .",
    "this means the following .",
    "take @xmath151 , and let @xmath12 be a _",
    "stable _ wlc model of @xmath13 .",
    "the stability here means that , for all @xmath153 in a neighborhood @xmath135 of @xmath65 in @xmath33 , the pairs @xmath154 are slt initial models of @xmath15 .",
    "such a model @xmath12 can be constructed from a slt wlc model of @xmath13 by additional blowups of lc centers which lie in divisors @xmath155 having @xmath75 multiplicities in @xmath65 .",
    "then , for any boundary @xmath156 , there exists a ( generalized ) log flop @xmath157 such that , for all @xmath158 , the models @xmath159 are slt wlc models of @xmath15 , and the boundaries @xmath153 are wlc equivalent , where @xmath160 denotes the open ray from @xmath65 through @xmath31 .",
    "the existence of @xmath161 follows from ( * ? ? ?",
    "* corolary 9 and addendum 5 ) .",
    "the equivalence of @xmath153 follows from the construction of the flop and from ( * ? ? ? * corollary 11 and addendum 6 ) ( cf .",
    "the proof of lemma  [ lemma - convex relations ] above ) .",
    "note that @xmath162 may not be slt , but by the slt lmmp the dlt condition can be replaced by the lc condition everywhere in ( * ? ? ?",
    "* remarks after proposition 1 ) by ( * ? ? ?",
    "* conjecture and heuristic arguments ) .",
    "the finiteness also follows by induction on dimension @xmath46 and the stability",
    ". see ( * ? ? ?",
    "* proposition 3.2.5 ) for details .",
    "these established facts imply all stated properties of @xmath46 , except for the convexity and rationality of @xmath46 .",
    "note that convexity follows from the convexity of positive parts : for all @xmath163 , @xmath164 the slt lmmp assumption is sufficient here .",
    "the proof of the rationality ( of @xmath165 ) and the open property ( of @xmath52 ) uses properties of functions @xmath166 introduced below .",
    "actually , for each @xmath52 there exist finitely many curves @xmath167 on a rather high model and finitely many prime b - divisors @xmath168 such that @xmath52 in @xmath53 can be given by the system of inequalities : @xmath169 in particular , those inequalities determine any country @xmath81 in @xmath46 while @xmath46 itself is given in @xmath33 ( more accurately , in the minimal face containing @xmath46 ) by nonstrict inequalities @xmath170 for some curves @xmath171 and some b - divisors @xmath172 , where the linear functions @xmath173 are extensions of linear functions given by @xmath174 , respectively on the linear span of @xmath46 as it will be explained in the continuation of the proof by the end of the section , and equations ( of the face ) @xmath71 or @xmath72 .",
    "the closure @xmath53 of any other lower dimensional class @xmath52 lies in a face of dimension @xmath175 of some country @xmath81 of ( cf .",
    "corollary [ cor - facet = face ] below ) and thus @xmath52 can be given in @xmath33 by strict inequalities and equations : @xmath176 or @xmath74 .",
    "( to be continued )    on a rather high model @xmath177 of @xmath1 and for a curve @xmath178 on @xmath177 , the function @xmath179 is defined as @xmath180 where @xmath12 is a wlc model of @xmath13 , and @xmath181 is a birational morphism .",
    "a _ rather high _ model satisfies the following universal property : @xmath133 dominates some wlc model for any @xmath151 , and @xmath182 is @xmath49-cartier over @xmath133 ( cf . definition of @xmath183 ) .",
    "such a universal model @xmath177 exists by the finiteness in the first half of the proof of the theorem .",
    "by @xcite , the function is independent of the choice of such a model @xmath177 .    for a prime b - divisor @xmath31 of @xmath1 ,",
    "the _ initial _ log discrepancy @xmath184 is defined as @xmath185    for a prime b - divisor @xmath31 of @xmath1 , the _ immobility _ function @xmath186 is defined as @xmath187 where @xmath12 is a wlc model of @xmath13 .",
    "it is called immobility because @xmath188 is the multiplicity in b - divisors @xmath31 of the fixed part @xmath189 of @xmath190 . by the invariant property of log discrepancies of wlc models ,",
    "the function @xmath188 is independent of the choice of the wlc model @xmath12 ( * ? ? ?",
    "* @xmath191 ) .",
    "[ prop - p - e]the functions @xmath166 on @xmath46 are nonnegative continuous rational piecewise linear , and linear on each @xmath192 , where @xmath52 is a class of @xmath46 .",
    "moreover , @xmath188 is convex from above , and @xmath193 is convex from below for rather general ( mobile ) curves , that is , for a curve @xmath194 through a general point of a rather high model @xmath177 of @xmath1 .",
    "the function @xmath193 is nonnegative by the nef property of b - divisor @xmath182 .",
    "the function @xmath188 is nonnegative by definition or because the fixed part @xmath189 is effective . the rationality and the linearity on each @xmath53 follow from the corresponding properties of the intersection pairing and the discrepancy function by lemma [ lemma - closed n ] .",
    "thus the finiteness established in the first half of the proof of theorem [ mainthrm - geography ] implies the continuity and the rational piecewise linearity of the functions .",
    "this includes also the rational property of any maximal linear subset ( cf .",
    "facets in corollary [ cor - eqn for facets ] below ) .",
    "the convex properties of @xmath193 from above and of @xmath188 from below follow from the inequalities : @xmath195 and @xmath196 , where @xmath197 and @xmath198 .",
    "[ cor - property - p - e]for any curve @xmath178 on a rather high model @xmath177 of @xmath1 and for any prime b - divisor @xmath31 of @xmath1 , the functions @xmath166 satisfy the following .    1 .",
    "each function @xmath166 has the constant signature on each class @xmath52 : either @xmath78 or @xmath199 on @xmath52 .",
    "the converse holds also , that is , if the values @xmath166 and @xmath200 have the same signatures , then @xmath10 .",
    "2 .   @xmath201 on a class @xmath52 if and only if @xmath178 is contracted by the lc contraction @xmath202 ( cf .",
    "log canonical model in section [ section7-lmmp - semi ] . ) of the pair @xmath13 with @xmath203 .",
    "in particular , the contraction depends only on @xmath52 .",
    "equivalently , @xmath204 on @xmath52 if and only if @xmath205 is a curve on @xmath206 .",
    "@xmath207 on a class @xmath52 if and only if @xmath31 can be blown up on a wlc model of this class , i.e. , @xmath31 is nonexceptional on some wlc model @xmath11 .",
    "equivalently , @xmath208 on a class @xmath52 if and only if @xmath31 is exceptional on any wlc model of @xmath13 for @xmath203 .",
    "\\(1 ) by definition @xmath183 is equivalent to the same signatures for all @xmath193 , and so is @xmath41 for @xmath188 .",
    "thus by proposition [ prop - equivalence ] @xmath35 is equivalent to the same signatures for all @xmath166 .",
    "\\(2 ) immediate by construction of @xmath209 as a composition of @xmath210 followed by the lc contraction of a wlc model @xmath12 , where @xmath12 is an appropriate wlc model of @xmath13 .",
    "the composition contracts exactly the curves @xmath178 on @xmath177 with @xmath211 ( cf .",
    "* ( ii ) ) ) .",
    "\\(3 ) by definition @xmath207 for any wlc model @xmath12 , on which @xmath31 is nonexceptional .    on the other hand , if @xmath207 and @xmath31 is exceptional on a wlc model @xmath12 , then @xmath212 and one can blow up @xmath31 to a crepant slt wlc model @xmath162 of @xmath13 with a ( higher ) model @xmath213 of @xmath214 by the slt lmmp . by ( 1 )",
    "this depends only on @xmath52 .",
    "[ cor - facet = face]let @xmath52 be a class of @xmath46 and @xmath56 be its face .",
    "then @xmath215 for some class @xmath85 of @xmath46 .",
    "in particular , @xmath216 .",
    "thus the geography @xmath46 is determined up to finitely many possibilities by its countries @xmath81 and even their closures @xmath217 .",
    "note that @xmath53 is a convex polyhedron by the first half of the proof of theorem [ mainthrm - geography ] .",
    "immediate by proposition [ prop - p - e ] and corollary [ cor - property - p - e ] ( 1 ) .",
    "an elementary property of linear functions is useful here : a nonnegative linear function on a convex polyhedron @xmath218 has the same signature on @xmath219 .",
    "[ cor - eqn for facets]let @xmath52 be a class of @xmath46 , @xmath56 be its facet , and @xmath177 be a rather high model of @xmath1 .",
    "then either    @xmath56 is given by a facet of @xmath33 ;    there exists a curve @xmath178 on a rather high model @xmath177 of @xmath1 such that @xmath220 and @xmath221 ; or    there exists a prime b - divisor @xmath31 of @xmath1 such that @xmath222 and @xmath223 .",
    "moreover , if @xmath224 , then @xmath225 .",
    "however , if @xmath226 , then @xmath227 , and this is possible only for facets given by a facet of @xmath33 .",
    "the same holds for the faces of @xmath52 .",
    "take @xmath76 , and an outer direction @xmath228 from @xmath52 , that is , @xmath229 and @xmath230 .",
    "let @xmath12 be a wlc model of @xmath13 which is a limit of ( slt ) wlc model @xmath126 of @xmath15 for @xmath231 ( e.g. , along @xmath232 ; see lemma [ lemma - closed n ] ) .    by the polyhedral property of lc @xcite , the following three cases are only possible :    \\(i )",
    "@xmath153 is not a b - boundary for any @xmath233 ;",
    "\\(ii ) @xmath154 is not lc for any @xmath233 ;    \\(iii ) for any @xmath233 in a neighborhood of @xmath65 , @xmath153 is a b - boundary and @xmath154 is lc .    in the case ( i ) , there exists prime @xmath3 , such that @xmath234 or @xmath235 .",
    "the facet @xmath69 of @xmath33 with the equation @xmath71 or @xmath74 respectively gives @xmath56 ( see the property of function @xmath73 on page 5 above ) .    in the case ( ii )",
    ", there exists a prime b - divisor @xmath31 of @xmath1 such that @xmath236 for any @xmath233 .",
    "if we do not assume ( i ) , @xmath31 is exceptional on @xmath237 and , by the linear property of discrepancy , @xmath238 and @xmath239 for any @xmath240 .",
    "thus @xmath207 and , if for every @xmath241 , @xmath242 , then for all @xmath153 near @xmath65 on @xmath232 , @xmath243 and @xmath244 for @xmath233 , a contradiction again by the negation of ( i ) .",
    "hence @xmath245 for some @xmath241 .",
    "this gives required @xmath31 by corollary [ cor - facet = face ] .",
    "the case ( iii ) itself has two subcases : for all @xmath233 in a neighborhood of @xmath65 ,    ( iii-1 ) @xmath126 is not a wlc model ; or    ( iii-2 ) @xmath126 is a wlc model but not of @xmath15 .    indeed",
    ", otherwise , for all those @xmath153 , the pairs @xmath126 are wlc models of @xmath15 . by definition",
    "all functions @xmath200 are linear on @xmath232 in the neighborhood of @xmath65 .",
    "thus @xmath200 have the same signatures and all those @xmath153 are @xmath35 , a contradiction with our assumptions .    in the case ( iii-1 ) , by ( * ? ? ?",
    "* corollary  9 ) there exists a curve @xmath246 on @xmath11 such that @xmath247 for @xmath233 and @xmath248 .",
    "thus @xmath249 for @xmath240 , and for a curve @xmath178 on a rather high model @xmath250 of @xmath1 with @xmath251 and @xmath252 , again by corollary [ cor - facet = face ] , @xmath220 and @xmath221 .",
    "the same holds for a birational transform of @xmath178 on @xmath177 @xcite .    in the case",
    "( iii-2 ) , there exists a b - divisor @xmath31 with @xmath253 . by the linear property of discrepancy and of initial discrepancy , @xmath245 for @xmath240 and @xmath207 .",
    "thus @xmath31 is a required divisor .",
    "the results about @xmath254 follow from corollaries [ cor - property - p - e ] ( 1 ) and [ cor - facet = face ] ; in the case of faces by induction .",
    "let @xmath255 be the minimal face of @xmath33 containing @xmath46 .",
    "then the linear span of @xmath46 is the linear span of @xmath56 by the monotonicity @xmath256 for @xmath257 in @xmath33 ( cf .",
    "proposition [ prop - monotone n ] ) .",
    "moreover , the linear span of @xmath46 can be given in @xmath48 by equations @xmath74 .",
    "in particular , the span is rational .",
    "the rationality of @xmath46 , of the polyhedrons @xmath53 , and the open property of the classes @xmath52 follow from corollaries [ cor - facet = face ] and [ cor - eqn for facets ] .",
    "this gives also required equations and inequalities .",
    "the linear function @xmath258 on the linear span of @xmath52 is determined by the linear function @xmath193 on @xmath52 , in particular , those functions with @xmath221 for a facet @xmath56 of @xmath52 will suffice .",
    "similarly , one can introduce functions @xmath259 .",
    "finally , the interior @xmath219 of a face of @xmath52 given by a facet of @xmath33 , belongs to @xmath52 or is disjoint from it .",
    "if @xmath86 are two classes and @xmath260 is a face of @xmath53 , then @xmath87 .",
    "conversely , if @xmath87 but @xmath260 is not a face of @xmath53 , then by corollary  [ cor - facet = face ] , @xmath261 .",
    "moreover , by the convexity of classes and of @xmath46 , we can suppose that @xmath88 contains a face @xmath262 of @xmath53 ( maybe for different @xmath52 ) which is a polyhedron of the same dimension as @xmath85 and with @xmath263 .",
    "hence there exists a facet @xmath264 of @xmath52 which contains an internal point of @xmath85 .",
    "this gives a contradiction with corollary  [ cor - eqn for facets ] .",
    "for example , if @xmath56 is given by a facet of @xmath33 with an equation @xmath71 or @xmath72 , then @xmath71 or @xmath72 respectively on @xmath88 , in particular , on @xmath262 , and thus on @xmath53 , a contradiction .",
    "similarly , for other functions .",
    "for first applications of geography , we recall and define natural cones in @xmath48 and @xmath265 .",
    "let @xmath266 be a model of @xmath1 , and @xmath267 be a reduced b - divisor of @xmath1 .",
    "our _ numerical space _ @xmath265 denotes the space of @xmath49-divisors , not necessarily @xmath49-cartier , mudulo the numerical equivalence @xmath268 . nonetheless , the relative weil - picard ( class ) number @xmath269 for proper @xmath1 .",
    "[ [ semiample - cones . ] ] semiample cones .",
    "+ + + + + + + + + + + + + + + +    in the numerical space @xmath265 and in the space of b - divisors @xmath48 , respectively , the cones @xmath270 \\in \\operatorname{n^1}(x / z)\\left|\\begin{array}{l } d\\equiv d ' \\text { for some semiample}\\\\ \\text{divisor $ d'$ on } x / z \\end{array}\\right.\\right\\}_,\\\\ \\operatorname{s\\mathfrak{a}}_s(w / z)&:=\\{d\\in{\\mathfrak d}_s\\mid d_w \\text { is semiample on } w / z\\ } \\end{array}\\ ] ] are defined .",
    "[ [ nef - cones . ] ] nef cones .",
    "+ + + + + + + + + +    in @xmath271 , respectively , the cones @xmath272 \\in \\operatorname{n^1}(x / z)\\mid d \\text { is nef on } x / z\\},\\\\ \\operatorname{\\mathfrak{nef}}_s(w / z)&:=\\{d\\in{\\mathfrak d}_s\\mid d_w \\text { is nef on } w / z\\ } \\end{array}\\ ] ] are defined and closed . in the projective case",
    ", they are the closures of the ample ( khler ) cones .",
    "the cone @xmath273 is dual to the kleiman - mori cone , the closure of the cone of curves .",
    "thus its polyhedral properties are related to the cone of curves ( the mori theory ) .",
    "however , we consider only cones of divisors ( see corollary [ cor - positive cones ] below ) .    [",
    "[ mobile - cones . ] ] mobile cones .",
    "+ + + + + + + + + + + + +    in @xmath271 , respectively , the cones @xmath274\\in \\operatorname{n^1}(x / z)\\left|\\begin{array}{l }   d\\equiv d ' \\text { for some $ { \\mathbb{r}}$-mobile } \\\\ \\text{divisor $ d'$ on } x / z \\end{array}\\right.\\right\\}_,\\\\ \\operatorname{\\mathfrak{m}}_s(w / z)&:=\\{d\\in{\\mathfrak d}_s\\mid d_w \\text { is $ { \\mathbb{r}}$-mobile on } w / z\\ } \\end{array}\\ ] ] are defined .",
    "[ [ effective - cones . ] ] effective cones .",
    "+ + + + + + + + + + + + + + + +    in @xmath271 , respectively , the cones @xmath275 are defined .    in general",
    ", the numerical equivalence @xmath268 of divisors does not preserve the semiampleness and mobile properties of divisors while clearly @xmath276 does . thus introducing cones in the numerical space",
    ", we had a choice to assume such a property on the whole class @xmath277 $ ] or on some representative @xmath278 $ ] .",
    "we chose the second one to have a larger cone . according to the choice",
    ", the linear map @xmath279 $ ] agrees the @xmath280 equivalence property with the numerical one ( cf .",
    "the proof of corollary [ cor-0log num cones ] ) .",
    "it is well - known that the above cones , numerical and linear , are convex and satisfy the inclusions : @xmath281    we recall also that :    * _ @xmath75-log pair _",
    "@xmath13 is a pair with a proper morphism @xmath1 and a boundary @xmath65 on @xmath89 such that @xmath282 is klt and @xmath283 , or equivalently @xmath284 according to @xcite ; and * ( relative ) _ ft ( fano type ) _",
    "variety @xmath1 is a variety such that there exists a boundary @xmath65 on @xmath89 such that the pair @xmath13 is a klt log fano variety , in particular , @xmath1 is projective .    for other equivalent characterizations of relative ft varieties ,",
    "see ( * ? ? ? * lemma - definition 2.8 ) .",
    "the most useful one among them to us is the following .",
    "[ lemma - ft=0log ] let @xmath1 be be an ft variety .",
    "then for any fixed reduced divisor @xmath50 of @xmath89 , there exists an @xmath49-boundary @xmath65 on @xmath89 such that @xmath13 is a @xmath75-log pair and @xmath285 .",
    "moreover , @xmath65 is big .",
    "conversely , if @xmath13 is a @xmath75-log pair with projective @xmath1 and big @xmath65 , e.g. , prime components of @xmath286 generate @xmath265 , then @xmath1 is ft",
    ".    see ( * ? ? ?",
    "* lemma - definition 2.8 ) .",
    "the big property for @xmath65 follows from the big property of @xmath287 for ft varieties .    to obtain polyhedral properties of cones in @xmath48 from geography of log models ,",
    "we translate polyhedrons in the space .",
    "let @xmath288 be the translation by @xmath289 .",
    "it translates @xmath65 into the origin @xmath290 , the vertex of cones .",
    "geography allows to construct only some polyhedrons in @xmath291 .",
    "however each polyhedron near @xmath65 is conical .",
    "thus to compare the translation of a polyhedron with a cone in a neighborhood @xmath135 of @xmath290 would be sufficient . in what follows",
    ", we say that two sets @xmath292 ( cones or polyhedrons ) coincide in @xmath135 if @xmath293    [ prop-0log cones coincide in u]let @xmath13 be a @xmath75-log pair and put @xmath294 .",
    "then there exists a neighborhood @xmath135 of @xmath75 in @xmath48 in which : @xmath295 where @xmath296 is the closure of a maximal dimensional class @xmath297 of wlc models with @xmath298 , @xmath299 are the classes of wlc models with @xmath298 , and @xmath300 are the closures of classes @xmath301 of wlc models with @xmath237 isomorphic to @xmath89 in codimension @xmath72 .",
    "each divisor @xmath302 has a unique mob+exc decomposition : @xmath303 and @xmath304 , where @xmath305 is @xmath49-mobile and @xmath306 is effective very exceptional with respect to a @xmath72-contraction given by @xmath305 ; the @xmath72-contraction , @xmath306 are unique and @xmath305 is unique up to @xmath280 and @xmath268 , respectively . in particular , in @xmath48 the @xmath49-mobile and @xmath280 effective properties of divisors are equivalent to those for @xmath268 .",
    "moreover , for @xmath307 , @xmath308 and @xmath309 , respectively , where @xmath310 .",
    "first we clarify the statement .",
    "let @xmath311 be a boundary in a class @xmath52 .",
    "if the pair @xmath15 has a wlc model @xmath312 for which @xmath22 is a small birational isomorphism , that is , an isomorphism in codimension @xmath72 , we denote the corresponding class by @xmath313 . in particular , if @xmath298 , we have isomorphism in codimension @xmath314 , or in dimension @xmath315 , and we denote it by @xmath299 . if @xmath89 is nonprojective or / and non @xmath34-factorial , we allow such models .",
    "but if we have to follow convention [ convention ] , we need to replace the models by their small projective @xmath34-factorializations ( * ? ? ?",
    "* corollary 6.7 ) ( cf .",
    "proposition [ prop - qfact - proj ] ) . for @xmath316 , in addition , we suppose that @xmath317 is a small log flop .",
    "thus we can replace @xmath1 by a small projective @xmath34-factorialization .",
    "now we choose a conical neighborhood @xmath135 of @xmath290 such that ,    for each @xmath318 , the pair @xmath15 with @xmath310 is a klt initial model of itself , including the boundary condition ;    @xmath319 is conical for each class @xmath320 ( this is sufficient for the classes @xmath52 with @xmath321 ) .",
    "such a neighborhood exists by our assumptions and by theorem [ mainthrm - geography ] .    for any divisor @xmath318 , @xmath322    thus @xmath323    @xmath324    @xmath325    @xmath326    this gives the required equalities and mob+exc decompositions .",
    "indeed , since @xmath327 is lc , the @xmath49-mobile part @xmath305 of @xmath31 is @xmath328 and respectively , the very exceptional part @xmath306 is @xmath329 .",
    "the @xmath49-linear decomposition gives the numerical one because the former is essentially numerical by the lmmp ( see ( * ? ? ?",
    "* definition 3.3 and proposition 3.4 ) ) .",
    "the semiampleness gives the equality @xmath330 .",
    "the closed property and the equalities with closures follow from lemma [ lemma - closed n ] or corollary [ cor - property - p - e ] ( 1 ) .    finally , by corollary [ cor - property - p - e ]",
    "( 1 ) , by convexity of @xmath331 and by the open property of classes , @xmath332 . holds for one class @xmath297 ( cf .",
    "* lemma 2 ) ) .    to construct all the required models , the klt slt lmmp is sufficient , and for contractions of those models , the semiampleness for klt @xmath34-boundaries is sufficient ( see corollary [ cor - qsamp = rsamp ] ) .",
    "[ cor-0log cones]let @xmath13 be a @xmath75-log pair and @xmath285 be a reduced divisor on @xmath89 .",
    "then the cones @xmath333 in @xmath48 are closed convex rational polyhedral .",
    "each divisor @xmath302 has a unique mob+exc decomposition : @xmath303 and @xmath304 , where @xmath305 is @xmath49-mobile and @xmath306 is effective very exceptional with respect to a @xmath72-contraction given by @xmath305 .",
    "moreover , @xmath268 instead of @xmath280 gives the same cones in @xmath48 .",
    "immediate by proposition [ prop-0log cones coincide in u ] and theorem [ mainthrm - geography ] for @xmath294 . if @xmath334 , we obtain the required polyhedral properties by intersection with the subspace @xmath48 .    [ cor-0log num cones]let",
    "@xmath13 be a @xmath75-log pair such that prime components of @xmath294 generate @xmath265 .",
    "then the cones @xmath335 in @xmath265 are closed convex rational polyhedral .",
    "thus @xmath336 is the pseudo - effective cone too .    the relations @xmath268 and @xmath280 coincide on @xmath1 .",
    "each divisor @xmath337 has a unique mob+exc decomposition : @xmath338 , where @xmath305 is @xmath49-mobile and @xmath306 is effective very exceptional with respect to a @xmath72-contraction given by @xmath305 .    the corollary gives a new result even for @xmath273 when @xmath1 is nonprojective .",
    "the required properties of the linear cones in @xmath48 imply the same properties of the numerical cones in @xmath265 .",
    "indeed , the natural linear map @xmath339\\colon { \\mathfrak d}_s & \\rightarrow   \\operatorname{n^1}(x / z)\\\\              d   & \\mapsto [ d],\\text { the numerical class of } d , \\end{array}\\ ] ] maps the cones @xmath340 @xmath341 since prime components @xmath3 of @xmath50 generate @xmath265 , the map @xmath279 $ ] and the induced maps of cones are surjective , that gives the above implication by corollary [ cor-0log cones ] .",
    "the surjectivity for cones uses the following : @xmath280 can be replaced by @xmath268 in the definition of cones in @xmath48 by the same corollary .",
    "moreover , the coincidence of @xmath268 and @xmath276 holds on @xmath1 .",
    "this is well - known for projective @xmath1 ( * ? ? ?",
    "* lemma 4.1.12 ) ( the proof uses the assumption that @xmath342 ; possibly , conjecture [ conj - semiample ] in the positive characteristic allows us to omit the assumption ) .",
    "the general case uses the rationality of singularities of @xmath89 .",
    "all required models in construction will be ft varieties by lemma [ lemma - ft=0log ] .",
    "semiampleness holds for ft varieties in characteristic @xmath75 : for @xmath34-divisors , it holds by the base freeness of @xcite , that is sufficient for @xmath49-divisors by corollary [ cor - qsamp = rsamp ] ( cf .",
    "* corollary  10 ) ) .    by lemma [ lemma - ft=0log ] ,",
    "the big klt slt lmmp is sufficient for the ft varieties .",
    "[ cor - positive cones]let @xmath1 be an ft variety , and @xmath50 be a reduced divisor of @xmath89 .",
    "then the cones @xmath343 in @xmath265 and in @xmath48 , respectively are closed convex rational polyhedral .    the relations @xmath268 and @xmath280 coincide on @xmath1 .",
    "each class @xmath277\\in\\operatorname{eff}(x / z)$ ] ( respectively divisor @xmath302 ) has a unique decomposition mob+exc : @xmath277=[m]+[e]$ ] ( respectively @xmath303 ) , where @xmath305 is @xmath49-mobile and @xmath306 is effective very exceptional with respect to a @xmath72-contraction given by @xmath305 .",
    "immediate by lemma [ lemma - ft=0log ] and corollaries [ cor-0log cones ] , [ cor-0log num cones ] .",
    "we use here the finiteness of the weil - picard number : @xmath269 .",
    "we will give a natural decomposition of the cones @xmath344 in @xmath265 and @xmath345 in @xmath48 in the next section .",
    "the support of a b - divisor @xmath346 is defined as the reduced b - divisor @xmath347 .",
    "so , a reduced b - divisor @xmath348 is identified with its support : @xmath349 .",
    "let @xmath13 be a @xmath75-log pair and @xmath294 .",
    "then the geography of @xmath46 in proposition [ prop-0log cones coincide in u ] _ induces _ a finite decomposition of the cone @xmath350 into open convex rational polyhedral subcones @xmath52 .",
    "the open and polyhedral properties follow from that of classes in @xmath46 by theorem [ mainthrm - geography ] .",
    "note that @xmath65 is an internal point of @xmath33 .",
    "this decomposition gives also a decomposition of @xmath351 for any reduced @xmath352 by corollary [ cor-0log cones ] ; its subcones will be called also classes . to give an internal interpretation of this decomposition , we introduce the following relation .    for divisors",
    "@xmath353 , @xmath354 if , for their mob+exc decompositions @xmath355 , the rational @xmath72-contractions @xmath356 given by @xmath357 are the same , and @xmath358",
    ". the relation @xmath280 can be replaced by @xmath268 and used for classes : @xmath277{\\sim_{\\mathrm{m+e}}}[d']$ ] .",
    "the corresponding _ induced _ classes of @xmath336 in @xmath265 will be denoted by @xmath359 and their contractions by @xmath360 .",
    "the rational @xmath72-contraction depends only on the class @xmath52 and @xmath359 , respectively , and will be referred to as the @xmath31-contraction . if @xmath1 is a birational contraction with respect to @xmath31 , then @xmath361 is small and well - known as a @xmath31-flip of @xmath1 @xcite . by construction , it is also a log flop of @xmath13 in the latter case .",
    "( _ warning _ : @xmath31-contraction is not a contraction with respect to a divisor @xmath31 in the @xmath31-mmp . )    in particular , this gives polyhedral decompositions of cones @xmath336 , @xmath362 in @xmath265 and @xmath363 @xmath364 in @xmath48 for @xmath75-log pairs @xmath13 , when prime components of @xmath294 generate @xmath265 , and for ft varieties @xmath1 .",
    "the decomposition of mobile cones @xmath365 @xmath366 is interesting for applications ( see proposition [ prop - ft mobile cones ] ) rather than their general structure : each class of those cones is a class in @xmath336 or @xmath350 respectively and it is determined by its @xmath72-contraction ( @xmath367 ) .",
    "so , we focus on classes of effective cones .",
    "let @xmath368 be a @xmath72-contraction with projective @xmath11 .",
    "a polarization on @xmath11 is an ample @xmath49-divisor @xmath369 .",
    "the polarization is called _ supported _ in @xmath50 if @xmath370 for some effective divisor @xmath306 on @xmath89 , very exceptional on @xmath237 , where @xmath371 is the pull back ( transform ) of @xmath369 @xcite ; in general , @xmath371 is an @xmath49-weil divisor .",
    "[ cor-0log eff decomposition]let @xmath13 be a @xmath75-log pair and @xmath285 be a reduced divisor on @xmath89 .",
    "then the decomposition of the cone @xmath350 induced by @xmath46 can be given by the mob+exc relation @xmath372 .",
    "there are finitely many rational @xmath72-contractions @xmath373 , and @xmath374 is projective with a polarization supported in @xmath50 .",
    "conversely , any such contraction corresponds to a class @xmath52 .",
    "immediate by proposition [ prop-0log cones coincide in u ] , corollary [ cor-0log cones ] and corollary [ cor - property - p - e ] ( 1 ) . note that , for @xmath375 such that @xmath376 , in the proposition , the contraction condition of @xmath372 means that @xmath377 , and the support condition that @xmath378 . but for any prime divisor @xmath306 exceptional on @xmath89 , @xmath379 by the klt property in @xmath135 .",
    "thus the support condition means that @xmath380 , or equivalently , @xmath381 have the same signatures .",
    "the finiteness of rational @xmath72-contractions @xmath373 follows from the finiteness of geography by theorem  [ mainthrm - geography ] . by construction ,",
    "each @xmath374 is projective with a polarization supported in @xmath50 .",
    "the converse is by definition .",
    "[ cor-0log num eff decomposition]let @xmath13 be a @xmath75-log pair such that components of @xmath294 generate @xmath265 .",
    "then the decomposition of the cone @xmath336 induced by @xmath46 can be given by the mob+exc relation @xmath372 .",
    "there are finitely many rational @xmath72-contractions @xmath360 , and @xmath382 is projective .",
    "conversely , any such contraction corresponds to a class @xmath359 .",
    "immediate by the above corollary and corollary [ cor-0log num cones ] .",
    "[ cor - ft eff decomposition]let @xmath1 be an ft variety and @xmath50 be a reduced divisor on @xmath89 .",
    "then the decomposition of cones @xmath383 induced by @xmath46 can be given by the mob+exc relation @xmath372 .",
    "there are finitely many rational @xmath72-contractions @xmath384 , and @xmath385 are projective with a polarization supported in @xmath50 for @xmath386 .",
    "conversely , any such contraction corresponds to a class @xmath387 .",
    "immediate by lemma [ lemma - ft=0log ] and corollary [ cor-0log num eff decomposition ] .",
    "[ cor-0log finite contractions]let @xmath13 be a @xmath75-log pair such that components of @xmath294 generate @xmath265 .",
    "then there are only finitely many rational @xmath72-contractions @xmath388 with projective @xmath11 .",
    "immediate by corollary [ cor-0log num eff decomposition ] .",
    "[ cor - ft finite contractions]let @xmath1 be an ft variety .",
    "then there are only finitely many rational @xmath72-contractions @xmath388 with projective @xmath11 .",
    "immediate by lemma [ lemma - ft=0log ] and corollary [ cor-0log finite contractions ] .",
    "[ thrm - finite wlc big klt]let @xmath13 be a klt log pair such that @xmath389 is big .",
    "then there are only finitely many projective wlc models @xmath390 of @xmath13 .",
    "let @xmath12 be a slt wlc model of @xmath13 .",
    "then by the monotonicity ( * ? ?",
    "* lemma 2.4 ) , @xmath12 is also klt and thus @xmath391 .",
    "let @xmath392 be its lc model . by construction , @xmath392 is also klt and projective .",
    "it is known also that any wlc model @xmath393 of @xmath13 is a generalized log flop of @xmath392 .",
    "generalized means that it can blow up divisors @xmath31 of @xmath394 , but only with log discrepancies @xmath395 .",
    "thus any wlc model @xmath393 of @xmath13 is a @xmath72-contraction @xmath396 of a projective _ terminalization _",
    "@xmath397 where @xmath398 is a crepant blow up of all prime @xmath31 with @xmath395 . since the set of those @xmath31 is finite ( * ? ? ?",
    "* corollary 1.7 ) , such a blow up exists .",
    "the terminalization @xmath398 is ft by lemma [ lemma - ft=0log ] ( for birational contraction @xmath399 any divisor is big ) and the number of @xmath72-contractions into projective models is finite by corollary [ cor - ft finite contractions ] .",
    "[ cor - finite big minimal ] let @xmath1 be a relative variety of general type",
    ". then there are only finitely many projective minimal models of @xmath1 .",
    "immediate by theorem [ thrm - finite wlc big klt ] applied to a resolution of singularities of @xmath1 .",
    "@xmath31-contractions can be constructed by the @xmath31-mmp with the initial model @xmath400 @xcite .",
    "[ cor - dmmp on 0log]let @xmath13 be a @xmath75-log pair with projective @xmath1 and @xmath31 be an @xmath49-cartier divisor on @xmath89 supported in @xmath286 .",
    "then the @xmath31-mmp holds for @xmath400 and , if @xmath31 is pseudo - effective , then the @xmath31-mmp followed by the @xmath31-contraction of a resulting model gives a rational @xmath72-contraction @xmath373 for the class @xmath52 of @xmath31 .",
    "it is well - known that , in this situation , the @xmath31-mmp is equal to the lmmp with an initial model @xmath401 for @xmath402 and @xmath403 of proposition [ prop-0log cones coincide in u ] .",
    "each birational transformation is a rational @xmath72-contraction and they are not isomorphic as log pairs ( monotonicity ) of log discrepancies ) .",
    "existence of transformations ( divisorial contractions and flips ) and their termination hold by the klt slt lmmp . in the pseudo - effective case",
    ", we get a wlc model and the required rational @xmath72-contraction by the semiampleness .",
    "otherwise , @xmath31 will be negative on some fibration and thus not pseudo - effective .",
    "[ cor - num dmmp 0log]let @xmath13 be a @xmath75-log pair with projective @xmath1 and such that the components of @xmath294 generate @xmath265 .",
    "then for any @xmath49-cartier divisor @xmath31 on @xmath89 , the @xmath31-mmp holds for @xmath400 and , if @xmath31 is pseudo - effective , then the @xmath31-mmp followed by the @xmath31-contraction of a resulting model gives a rational @xmath72-contraction @xmath373 for the class @xmath52 given by @xmath31 .",
    "the class @xmath52 can be replaced by numerical @xmath359 .",
    "termination in this case is universally bounded ( the bound depends only on the variety @xmath1 ) .",
    "immediate by corollary [ cor - dmmp on 0log ] .",
    "the boundedness for termination follows from corollary [ cor - ft finite contractions ] , because @xmath1 is ft ( cf .",
    "the following lemma ) .",
    "[ cor - dmmp on ft ]",
    "let @xmath1 be an ft variety .",
    "then the @xmath31-mmp holds for @xmath400 and , if @xmath31 is pseudo - effective , then the @xmath31-mmp followed by the @xmath31-contraction of a resulting model gives a rational @xmath72-contraction @xmath360 for the class @xmath359 of @xmath336 containing @xmath31 .",
    "termination in this case is universally bounded ( the bound depends only on variety @xmath1 ) .",
    "immediate by lemma [ lemma - ft=0log ] and corollary [ cor - num dmmp 0log ] .",
    "theorem [ thrm - finite wlc big klt ] gives the finiteness of projective wlc models for a klt pair @xmath13 of general type .",
    "it is well - known that all wlc models are crepant birationally isomorphic . moreover , if @xmath393 and @xmath404 are two wlc models of @xmath13 , then their natural ( identical on rational functions ) birational isomorphism @xmath405 can be factored into projective(@xmath406 ) crepant minimizations @xmath407 @xmath408 and a small log flop @xmath409 : @xmath410\\ar@{-->}[r ] & v'\\ar[d]\\\\   y\\ar@{-->}[r ] & y'/z . } \\ ] ] a minimal model @xmath411 is maximal for the contraction order @xmath412 for wlc models of @xmath13 : @xmath133 is @xmath34-factorial , projective@xmath413 and blows up all prime @xmath31 with @xmath207 ( cf .",
    "the proof of theorem [ thrm - finite wlc big klt ] ) .",
    "moreover , @xmath414 is a slt wlc model of @xmath13 exactly when @xmath177 is projective . in its turn",
    ", each crepant birational contraction can be factored into a sequence of extremal divisorial and small contractions and their number is bounded by the relative picard number @xmath415 for a projective@xmath416 minimization @xmath417 of the log canonical model . thus the remaining factorization concerns the log flop .",
    "note also that @xmath418 is projective but @xmath177 may be not . if @xmath419 , any klt model , in particular , above minimization is projective@xmath416 . however , if @xmath420 , @xmath177 can be nonprojective and factorization of birational isomorphism @xmath421 or @xmath422 into elementary ( extremal ) flops is out of our grasp .",
    "thus we consider only projective wlc models and focus on minimal ( slt ) models @xmath423 .",
    "then their birational isomorphism @xmath405 gives a small log flop and can be factored into elementary flops .",
    "( note that , for an elementary flop , the flopping locus can be very nonelementary , e.g. , not an irreducible curve in dimension @xmath424 . ) the general case , not necessarily of general type models , will be considered in corollary [ cor - small klt slt wlc models in elementary log flops ] below .",
    "here we have a little bit stronger result .",
    "it is natural to consider the factorization problem for flops of projective @xmath75-log pairs @xmath13 .",
    "however to control polarization in @xmath286 we need to consider big @xmath65 and thus ft varieties by lemma [ lemma - ft=0log ] . note that a @xmath34-factorialization of an ft variety is again an ft variety , and , for any rational @xmath72-contraction @xmath388 with projective @xmath11 , @xmath11 is ft ( * ? ? ?",
    "* lemma 2.8 ) .",
    "[ cor - qfact ft flops]let @xmath425 be two @xmath34-factorial ft varieties .",
    "then any small birational isomorphism @xmath405 can be factored into elementary small birational ( flips , antiflips , or flops ) transformations@xmath416 .",
    "the number of such transformations is bounded ( the bound depends only on @xmath11 ) .",
    "the factorization is a general fact .",
    "for instance , we can use the @xmath31-mmp , where @xmath31 is the birational transform of any polarization from @xmath426 .",
    "each transformation will be an elementary @xmath31-flip .",
    "the number of flips is bounded by the number of rational @xmath72-contractions with projective @xmath382 according to corollary [ cor - ft finite contractions ] .",
    "[ cor - slt flops ] let @xmath423 be two klt slt wlc models of general type . then any ( small ) log flop @xmath427 can be factored into elementary log flops and the number of such flops is bounded ( the bound depends only on @xmath393 ) .",
    "immediate by corollary [ cor - qfact ft flops ] for ft variety @xmath428 .",
    "we conclude the section with results that shed a light on terminology : _ a mobile cone @xmath362 as a polarizations cone .",
    "_    [ prop - small iso mobile cones ] let @xmath1 be a variety with a reduced divisor @xmath50 and @xmath368 be a small isomorphism . then @xmath429 induces an isomorphism @xmath430 that preserves cones @xmath431 . if the isomorphism is a rational @xmath72-contraction of a class @xmath52 in @xmath350 , then under the above identification : @xmath432 . for ft @xmath433 , the last subcone @xmath434 .    uses the birational invariance of mob+exc decomposition .",
    "of course , all definitions work and the result holds for general @xmath1 but cones are not necessarily closed nor polyhedral .    [ prop - ft mobile cones ] let @xmath1 be an ft variety , and @xmath359 be the classes in @xmath362 with rational @xmath72-contractions @xmath360 .",
    "then @xmath435 in @xmath265 , where @xmath436 is the ample cone .",
    "furthermore , @xmath437 , @xmath438 in @xmath265 .",
    "transform the decomposition into the classes @xmath359 of @xmath439 into their polarization cones : @xmath437 .",
    "the equation is given by the pull back @xmath440 $ ] of the numerical classes of ample divisors @xmath369 on @xmath382 by @xmath441 .",
    "the points of polyhedron @xmath46 fills up the the cube @xmath33 .",
    "[ prop - monotone n]@xmath46 satisfies the following :    1 .",
    "( monotonicity ) if @xmath442 and @xmath257 , then @xmath443 ; 2 .   ( the face of geography ) the linear span of @xmath46 is the linear span of a minimal face @xmath444 of @xmath33 containing @xmath46 ; moreover , equations of the span have the form @xmath74 , and are the linear equations for @xmath445 ; 3 .",
    "@xmath446 .",
    "the monotonicity is immediate by the inequality for kodaira dimensions : @xmath447 .",
    "however , the slt lmmp is sufficient . for this",
    ", one can use the stability of wlc models @xcite .",
    "indeed , by the compact and convex property of @xmath46 , there exists a maximal @xmath448 in the direction @xmath449 , that is , @xmath450 $ ] .",
    "if @xmath451 $ ] , the monotonicity holds in the direction . otherwise , let @xmath128 be a slt wlc model of @xmath129 .",
    "then by ( * ? ? ?",
    "* corollary  9 and addendum  5 ) after finitely many log flops of this model , it will become a wlc model such that , for each @xmath452\\ ] ] near @xmath31 , @xmath453 has a mori log fibration ( cf .",
    "the proof of theorem  [ mainthrm - geography ] ) .",
    "then , since @xmath454 , for a generic curve @xmath194 of the fibration , @xmath455 a contradiction .",
    "the other two properties follow from the monotonicity and definitions .    [ [ separatrix ] ] separatrix + + + + + + + + + +    so , to find the largest lower bound of @xmath46 , or the minimum divisors ( by the closedness ) of @xmath46 , is sufficient to determine @xmath46 .",
    "such a bound @xmath456 will be called a _",
    "separatrix_. it consists of boundaries @xmath151 which _ separate _",
    "@xmath46 : for any neighborhood @xmath135 of @xmath65 in the face @xmath444 , there exists a boundary @xmath457 , that is , @xmath458 and @xmath459 .",
    "@xmath460 if and only if @xmath151 and is a limit of boundaries @xmath461 with @xmath459 .    [ prop - s = closed rational poly]@xmath456 is a closed rational polyhedron ( usually nonconvex ) , and @xmath462 more precisely , a bordering facet of @xmath46 lies either    in a facet of @xmath33 ( or of @xmath444 ) , or    in @xmath456 , and @xmath456 is the closure of union of those facets .    a facet in the proposition is a facet of geography @xmath46 .",
    "( however , the statement holds also for facets of the polyhedron @xmath46 . ) a facet @xmath56 of _ geography _",
    "@xmath46 is _ bordering _ if @xmath463 .",
    "immediate by theorem  [ mainthrm - geography ] and proposition [ prop - monotone n ] .",
    "the separatrix plays an important role in birational geometry of uniruled varieties , because it divides mori log fibrations from wlc models ( see corollary  [ cor - geoface = cube for general ] below ) . to factorize the birational transformations of those fibrations into more elementary standard transformations ( links ) , we will use a path on @xmath456 connecting corresponding points .",
    "the best one would be a segment on @xmath456 connecting the points but the separatrix is usually not convex .",
    "thus we can use _ geodesics _ on @xmath456 according to the euclidean metric of the ambient space @xmath48 or induced by a projection .",
    "we prefer a natural projection from the _ origin _",
    "@xmath464 of the face of geography",
    "@xmath444 : @xmath465 where @xmath74 for the equations of @xmath46 and @xmath199 otherwise .",
    "[ lemma - nonempty separatrix]@xmath466 if and only if @xmath467 and @xmath468 , or equivalently , @xmath469 and @xmath470 .",
    "immediate by proposition  [ prop - s = closed rational poly ] and definition .",
    "let @xmath471 be a projection from @xmath464 onto a hyperplane @xmath369 in @xmath444 given by the equation @xmath472 ( here we discard all @xmath73 corresponding to the equations of @xmath46 ) .",
    "( see diagram [ dia projection ] below . )",
    "separatrix.eps ( -7,-7)@xmath464 ( 25,36)@xmath65 ( 68,70)@xmath31 ( 52,52)@xmath473 ( 35,85)@xmath46 ( 75,24)@xmath369 ( 45,10)@xmath456 ( 45,50)@xmath474 ( 63,70)@xmath474    by lemma  [ lemma - nonempty separatrix ] , @xmath475 is well - defined on @xmath456 .",
    "[ prop - image of separatrix]if @xmath466 , the image @xmath476 is a closed convex rational polyhedron .",
    "moreover , @xmath475 is @xmath72-to-@xmath72 on @xmath456 .",
    "immediate by theorem [ mainthrm - geography ] and proposition  [ prop - monotone n ] .",
    "the @xmath72-to-@xmath72 property follows from definition .",
    "[ [ geography - of - general - type ] ] geography of general type + + + + + + + + + + + + + + + + + + + + + + + + +    it is a geography @xmath46 containing a boundary @xmath65 such that the pair @xmath13 is of general type .",
    "this assumes that the geography @xmath46 is equipped with certain functions , e.g. , @xmath166 of section [ section2-geography ] , @xmath477 etc .",
    "one of those functions is the numerical kodaira dimension @xmath478 .",
    "( for other functions , see section [ section2-geography ] . )",
    "it behaves almost constant .",
    "[ prop - kd nd are constants]for each @xmath479 ( in particular , @xmath480 ) , @xmath481 the same holds for @xmath482 .",
    "immediate by theorem [ mainthrm - geography ] and the following fact on a rather high projective model @xmath177 .",
    "if @xmath483 are nef divisors on @xmath177 , then for any subvariety @xmath484 and any real numbers @xmath485 such that @xmath486 , @xmath487 is big on @xmath488 if and only if @xmath489 is big on @xmath488 , and if @xmath31 is big on @xmath488 , then @xmath487 is big on @xmath488 . thus @xmath490 . for @xmath482 , one can use semiampleness .",
    "[ cor - geoface = cube for general ] let @xmath46 be a geography of general type",
    ". then @xmath491 ( the number of prime components of @xmath50 ) , in particular , @xmath468 and , for any @xmath460 , @xmath492 .",
    "immediate by proposition  [ prop - monotone n ] and the open property of general type : if @xmath493 is of general type , then @xmath15 is also of general type for any @xmath494 near @xmath65 . for the kodaira dimension",
    ", this follows from definition , for numerical one from the slt lmmp .",
    "if @xmath495 are two reduced b - divisors on @xmath1 , then there exists a natural inclusion of geographies : @xmath496 and @xmath497 where @xmath498 , the exceptional part of @xmath499 . indeed , by definition @xmath12 is a wlc model of @xmath13 if and only if this holds for @xmath15 .",
    "this correspondence preserves @xmath35 .",
    "the transition from @xmath50 to @xmath500 will be called an _",
    "extension_. it allows us to perturb any wlc model to a much better model as follows . for instance , if @xmath12 is a wlc model of @xmath13 not slt or not of general type , e.g. , for @xmath501 , we can convert it to a polarized wlc model .",
    "indeed , if @xmath500 is sufficiently larger than @xmath50 , the geography @xmath502 is of general type , and @xmath153 belongs to a face of a country @xmath503 .",
    "thus @xmath504 where @xmath505 , has a lc model @xmath506 , and by lemma",
    "[ lemma - closed n ] a limit of such models gives a wlc model @xmath12 of @xmath13 ( might be different from @xmath237 above or / and not slt ; cf . with convention  [ convention ] ) with a polarization of @xmath507 .",
    "moreover , as we will see below , for a good choice of @xmath500 , @xmath11 will be @xmath34-factorial . of course",
    ", the variety @xmath206 obtained by a perturbation is not unique .",
    "nonetheless it is useful ( see corollary [ cor - small klt slt wlc models in elementary log flops ] and theorem  [ thrm - mori morphism is cte ] below ) .",
    "[ [ generality - conditions ] ] generality conditions + + + + + + + + + + + + + + + + + + + + +    in what follows we assume that @xmath50 is a reduced divisor , @xmath508 is a slt initial pair of general type , and components of @xmath50 generate @xmath265 .",
    "it is easy to satisfy these conditions on a log resolution of @xmath508 after an extension of @xmath50 .",
    "each country in such a geography has a unique model .",
    "[ thrm - unique wlc for general geo]under the generality conditions on @xmath508 , let @xmath509 be an internal point of a country @xmath81 in the geography @xmath46 .",
    "then @xmath13 has a unique wlc model @xmath12 .",
    "moreover , the model is a klt slt wlc model of @xmath13 , in particular , @xmath391 , @xmath11 is projective @xmath34-factorial , depending only on @xmath81 , and the model is lc ; components of @xmath510 generate @xmath511 .    the key instrument to investigate generic geographies",
    "is the following .",
    "[ lemma - rho of wlc / lc]under the generality conditions on @xmath13 ,",
    "let @xmath393 be a klt slt wlc model of @xmath13 for a boundary @xmath65 in a subclass @xmath512 and @xmath513 be its lc contraction .",
    "then @xmath514 is ft , components of @xmath510 generate @xmath511 , and @xmath515    since the initial model @xmath13 is klt slt and @xmath516 , by the klt slt lmmp there exists a klt slt wlc model @xmath393 of @xmath13 and components of @xmath517 generate @xmath511 .",
    "otherwise , we get a mori log fibration and nothing to prove . by construction of the lc model , @xmath518 is a @xmath75-log pair and by lemma  [ lemma - ft=0log ] , @xmath514 is ft .",
    "the contraction exists by the base freeness @xcite , because @xmath519 is big .",
    "the klt slt properties imply also that the image @xmath520 of @xmath52 under the natural linear map @xmath521 has the same codimension : @xmath522 ( * ? ? ?",
    "* lemma 3.3.2 ) . by the open property in theorem  [ mainthrm - geography ] ,",
    "@xmath523 when @xmath524 .",
    "on the other hand , the generation property of @xmath510 gives the surjectivity of the natural linear map @xmath525.\\ ] ] by construction and the definition of @xmath35 , @xmath520 lies in the kernel of the last map .",
    "thus    @xmath526 finally , note that the constructed model @xmath514 can be different from the one in the statement of lemma . however , the difference is in a log flop . by corollary  [ cor - qfact ft flops ] , it is a composition of elementary small birational transformations which preserve the required properties .",
    "let @xmath12 be a slt wlc model of @xmath13 .",
    "since the latter pair is klt initial , the former pair is klt and @xmath391 ( * ? ? ?",
    "* lemma 2.4 ) . by our assumptions and proposition  [ prop - kd nd are constants ] , the pair @xmath393 has general type and a lc model @xmath527 .",
    "thus by lemma [ lemma - rho of wlc / lc ] and corollary [ cor - geoface = cube for general ] , @xmath528 and @xmath529 , the uniqueness .",
    "the last uniqueness was established only for slt models .",
    "any other wlc model is a rational @xmath72-contraction of @xmath514 and thus coincide with @xmath237 ( see the projective case in corollary  [ cor - ft eff decomposition ] ; in general , cf .",
    "the proof of theorem  [ thrm - finite wlc big klt ] ) .",
    "models of facets and ridges for a generic geography also behave quite controllable . in dimension",
    "@xmath530 , all facets are bordering and ridges only cube bordering . in dimension",
    "@xmath531 , flopping facets are impossible and the birational modifications of ridges are only divisorial ( see the classification of ridges below ) .",
    "we divide facets into two types according to their location in @xmath46 : _ bordering _ and _ internal_. furthermore , they are divided into two subtypes , respectively : _ cube bordering , ( mori ) fibering _ and _ flopping , divisorial_. let @xmath56 be a facet of @xmath46 under the generality conditions , @xmath532 , and @xmath12 be a projective wlc model of @xmath13 .",
    "first , we describe neighboring classes and properties of their models ( only projective , possibly not @xmath34-factorial ) and then prove them ( see the proof of theorem  [ thrm - facet types ] below ) .",
    "[ [ cube - bordering ] ] cube bordering + + + + + + + + + + + + + +    the facet @xmath56 is bordering for @xmath46 and its closure @xmath533 lies in a facet of @xmath33 , or satisfies an equation @xmath71 or @xmath72 in @xmath46 . in this case",
    ", @xmath12 can be non klt . if it is klt , the wlc models can be classified as types below .",
    "we are not interested in this because after a perturbation we have internal boundaries ( see the proof of corollary  [ cor - small klt slt wlc models in elementary log flops ] below ) .",
    "[ [ mori - fibering ] ] ( mori ) fibering + + + + + + + + + + + + + + +    the facet @xmath534 is also bordering for @xmath46 but @xmath535",
    ". the pair @xmath130 @xmath391 , is a klt slt wlc model of @xmath13 and @xmath237 has a mori log fibration @xmath536 given by the lc contraction .",
    "the base @xmath537 is @xmath34-factorial .",
    "such a mori fibration will be called _ polarized _ by the boundary @xmath519 . the model @xmath393 and the fibration are unique for @xmath65 and both morphisms @xmath538 depend only on the facet @xmath56 .",
    "moreover , there exists a unique ( neighboring ) country @xmath81 of @xmath46 such that @xmath533 is its facet . for any @xmath539 ,",
    "@xmath312 is a lc model of @xmath15 , and @xmath393 is limiting from @xmath81 . on the other side ,",
    "if @xmath540 and is sufficiently close to @xmath65 , the mori log fibration @xmath541 is a slt mori log fibration of @xmath15 .",
    "the facet is given by the equation @xmath542 in @xmath543 where @xmath178 is a curve on a rather high model @xmath177 of @xmath1 , contracted on @xmath537 but not on @xmath237 .",
    "the function is @xmath78 on @xmath81 and @xmath244 in the points of @xmath47 near the points of @xmath56 for the linear extension of @xmath544 from @xmath81 .",
    "the functions @xmath545 have the same signatures on @xmath546 .",
    "the next two types are possible respectively only in dimension @xmath547 and @xmath548 .",
    "[ [ flopping ] ] flopping + + + + + + + +    the facet is internal for @xmath46 : @xmath549 , and @xmath533 is a facet of two ( neighboring ) countries @xmath550 in @xmath46 .",
    "the pair @xmath13 has exactly three wlc models which are klt of general type and related by an elementary small flop , extraction or contraction .",
    "countries @xmath550 give exactly two slt wlc models @xmath551 @xmath552 @xmath553 @xmath554 of @xmath13 , where @xmath555 @xmath556 are lc models of @xmath15 for @xmath557 , respectively .",
    "those models of @xmath13 are limiting from @xmath550 , respectively .",
    "the third model @xmath558 , of @xmath13 is a lc one .",
    "both contractions @xmath559 are elementary small .",
    "in particular , @xmath537 is not @xmath34-factorial and the third model is not slt .",
    "the facet is given by equations @xmath560 in @xmath561 where @xmath562 are curves on a rather high model @xmath177 of @xmath1 contracted on @xmath537 but not on @xmath563 , respectively ; @xmath564 on @xmath116 and @xmath315 on @xmath117 ; @xmath565 on @xmath116 and @xmath566 on @xmath117 .",
    "the functions @xmath545 have the same signatures on @xmath567 .",
    "[ [ divisorial ] ] divisorial + + + + + + + + + +    the facet is also internal for @xmath46 : @xmath549 , and @xmath533 is a facet of two ( neighboring ) countries @xmath550 in @xmath46 .",
    "the pair @xmath13 has exactly two wlc models which are klt of general type and related by an elementary divisorial extraction or contraction of a prime divisor @xmath31 .",
    "the country @xmath116 gives exactly one slt wlc model @xmath568 , of @xmath13 , where @xmath569 is a lc model of @xmath15 for @xmath570 .",
    "the model @xmath571 is limiting from @xmath116 .",
    "the second model @xmath558 , of @xmath13 is the lc one , the contraction @xmath572 of @xmath31 is elementary divisorial . in particular , @xmath537 is @xmath34-factorial , @xmath573 is a slt wlc model , but not a slt wlc model of @xmath13 .",
    "the model @xmath573 is limiting from @xmath117 . the facet @xmath56 is given by the equation @xmath542 in @xmath574 where @xmath178 is a curve on a rather high model @xmath177 of @xmath1 contracted on @xmath537 but not on @xmath575 ; @xmath576 on @xmath577 and @xmath78 on @xmath116 .",
    "similarly , @xmath56 can also be given by the equation @xmath207 in @xmath578 : @xmath242 on @xmath579 and @xmath78 on @xmath117 .",
    "[ thrm - facet types]under the generality conditions on @xmath508 , let @xmath56 be a facet of the geography @xmath46 .",
    "then it has one of four above types : cube bordering , fibering , flopping or divisorial , and behaves accordingly .",
    "( see diagram [ dia4 facets ] below . )",
    "facets.eps ( 49,103)(1 ) ( 72,53)(3,4 ) ( 24,17)(2 )    @xmath580    a bordering facet @xmath56 of @xmath46 has the cube bordering or fibering type by definition , proposition  [ prop - s = closed rational poly ] and corollary [ cor - geoface = cube for general ] .",
    "cube bordering type : @xmath56 satisfies an equation @xmath71 or @xmath72 and lies in the corresponding facet of @xmath581 by corollary  [ cor - geoface = cube for general ] .",
    "for the boundaries @xmath532 of the other type , @xmath65 is _ internal _ : @xmath535 . by the generality assumption , @xmath13 is a klt slt initial pair of itself and components of @xmath516 generate @xmath265 . in particular",
    "@xmath65 is big .",
    "thus any wlc model @xmath12 of @xmath13 is klt ( * ? ? ?",
    "* lemma 2.4 ) with big @xmath391 and has a lc contraction @xmath582 @xcite . if @xmath514 is projective , it is ft by lemma  [ lemma - ft=0log ] .",
    "such a model @xmath393 exists because @xmath151 and it satisfies lemma  [ lemma - rho of wlc / lc ] when it is a slt wlc model of @xmath13 .",
    "the slt model can be constructed by the slt lmmp from the above initial model .",
    "fibering type .",
    "suppose that @xmath56 is fibering and @xmath393 is a slt wlc model of @xmath13 . by construction and lemma  [ lemma - rho of wlc / lc ] ,",
    "@xmath514 is a mori log fibration .",
    "indeed , it is not isomorphism and an extremal fibration by corollary  [ cor - geoface = cube for general ] . the model ( in the projective class ) and",
    "contraction are unique by corollary  [ cor - ft eff decomposition ] .",
    "since @xmath237 is @xmath34-factorial and @xmath514 is ft , @xmath537 is @xmath34-factorial too ( cf . @xcite ) .",
    "the boundary @xmath519 is a polarization of @xmath514 .",
    "thus if we perturb @xmath65 to @xmath153 in a positive direction , @xmath583 , then @xmath539 for a unique neighboring country @xmath81 of @xmath46 and @xmath312 is a wlc ( actually lc ) model of @xmath15 with a polarization @xmath584 over @xmath537 . hence the functions @xmath585 have the same signatures on @xmath546 . by lemma",
    "[ lemma - closed n ] , @xmath393 is limiting from @xmath81 , and by theorem [ mainthrm - geography ] , @xmath533 is a facet of @xmath81 .",
    "a perturbation @xmath312 in a negative direction , @xmath540 , gives a slt mori log fibration @xmath541 of @xmath15 . by construction and theorem",
    "[ thrm - unique wlc for general geo ] , a required equation @xmath542 can be given by a curve @xmath178 on @xmath177 with the curve image in a fiber of @xmath514 .",
    "the next two types are possible only in dimension @xmath548 and internal : @xmath549 , by theorem [ mainthrm - geography ] @xmath533 is a facet of two ( neighboring ) countries @xmath550 in @xmath46 , and @xmath480 .",
    "( according to the open property in theorem  [ mainthrm - geography ] , @xmath586 . ) by our assumptions and proposition  [ prop - kd nd are constants ] , any wlc model @xmath393 of @xmath13 has general type and a lc model @xmath587 with the lc contraction @xmath588 .",
    "let @xmath393 be a slt wlc model of @xmath13 .",
    "note that it is not lc : @xmath589 .",
    "otherwise , any small perturbation @xmath153 of @xmath65 in @xmath33 is @xmath590 : @xmath591 , a contradiction .",
    "hence @xmath592 , or equivalently , @xmath514 is elementary by lemma  [ lemma - rho of wlc / lc ] .    flopping type .",
    "now we claim that @xmath56 is of flopping type if @xmath11 is small .",
    "it is possible only in dimension @xmath593 . by corollary  [ cor - ft eff decomposition ]",
    "the pair @xmath13 has exactly three projective wlc models @xmath594 which are related by an elementary small flop , extraction or contraction : @xmath595\\ar[rd ] & & y_2\\ar[ld]\\\\    & t / z . & } \\ ] ]    ( the cone @xmath596 is a line @xmath49 with three subcones ( classes ) : @xmath597 @xmath598 . )",
    "the boundary @xmath519 is a polarization of @xmath514 .",
    "if we perturb @xmath65 to @xmath153 in a positive direction , @xmath583 , that is , @xmath584 becomes a polarization , then @xmath599 is limiting from @xmath116 if @xmath600 , otherwise @xmath601 is limiting from @xmath117 .",
    "so , the boundary @xmath539 for one of the two neighboring countries @xmath81 of @xmath46 and @xmath312 is a wlc ( actually lc ) model of @xmath15 with a polarization @xmath584 .",
    "the same holds for another neighboring country after a log flop of @xmath514 . by theorem  [ mainthrm - geography ]",
    ", @xmath533 is a facet of @xmath116 and of @xmath117 .",
    "the third wlc model of @xmath13 is @xmath573 . in particular , @xmath537 is not @xmath34-factorial and the model is not slt . by construction , the functions @xmath188 have the same signatures on @xmath567 . by construction and theorem  [ thrm - unique wlc for general geo ] , required equations @xmath560 can be given by curves @xmath562 on @xmath177 with the curve image in a fiber of @xmath602 , respectively .",
    "divisorial type . in the remaining last type case",
    ", @xmath514 is a divisorial contraction of a unique prime divisor @xmath31 by the extremal and @xmath34-factorial properties .",
    "again by corollary  [ cor - ft eff decomposition ] the pair @xmath13 has exactly two projective wlc models which are related by an elementary divisorial extraction or contraction .",
    "( the cone @xmath596 is a line @xmath49 with two subcones ( classes ) : @xmath603,(0,+\\infty)$ ] . )",
    "the boundary @xmath519 is a polarization of @xmath514 .",
    "thus if we perturb @xmath65 to @xmath153 in a positive direction , @xmath583 , that is , @xmath584 becomes a polarization , say for @xmath600 , then @xmath599 is limiting from @xmath116 .",
    "the second wlc model of @xmath13 is @xmath573 . in particular ,",
    "@xmath537 is @xmath34-factorial , @xmath573 is a slt wlc model , but not a slt wlc model of @xmath13 : @xmath207 .",
    "the model @xmath573 is limiting from @xmath117 . by construction and theorem  [ thrm - unique wlc for general geo ] , required equations @xmath604 can be given respectively by the contracted divisor @xmath31 and by a curve @xmath178 on @xmath177 with the curve image in a fiber of @xmath514 .",
    "[ cor - small klt slt wlc models in elementary log flops]let @xmath423 be two klt slt wlc models . then any small log flop @xmath427 can be factored into elementary log flops .",
    "it is sufficient to assume that the transformation is small and @xmath605 is the birational image of @xmath519 .",
    "we can prove the corollary using elementary log flops of the @xmath31-mmp with @xmath606 where @xmath607 is an effective polarization on @xmath426 @xcite . according to the stability of (",
    "* addendum 5 ) , the @xmath31-mmp of @xmath11 is equivalent to the klt slt lmmp of the initial model @xmath608 for some @xmath609 .    we can use a geography instead of the @xmath31-lmmp which is more symmetric . pick up two effective ( generic ) polarizations @xmath610 on @xmath611 respectively .",
    "( in dimension @xmath612 , one can suppose that @xmath610 are prime . )",
    "take a log resolution @xmath508 of @xmath613 where @xmath614 and @xmath615 are the exceptional divisors of @xmath616 .",
    "then for an appropriate klt boundary @xmath6 , both models @xmath393 and @xmath404 are klt slt wlc models of @xmath13 . after a perturbation by polarizations @xmath610 , they will become klt log canonical models @xmath617 respectively of @xmath618 where @xmath619 are perturbations of @xmath65 in @xmath33 .",
    "in other words , there are two classes @xmath620 in the geography @xmath46 such that @xmath621 and @xmath423 are limiting from @xmath620 respectively ; @xmath622 . as above by the stability ( * ? ? ? * addendum 5 ) , the geography is conical near @xmath65 .",
    "hence for a perturbation , @xmath620 are actually countries and the segment @xmath623 $ ] intersects only facets @xmath56 , which are also adjacent to @xmath65 : @xmath624 is limiting for the facets . by theorem  [ thrm - facet types ] , this gives a required factorization .",
    "but for this we need to expand @xmath50 to fulfil the generality conditions .",
    "we also need to verify that all intersections @xmath623\\cap{\\mathfrak f}$ ] have flopping type . in other words , if a prime divisor @xmath625 is not exceptional on @xmath237 , then @xmath625 should not be exceptional on the wlc models of all @xmath626 $ ] and vice versa . by construction , @xmath610 are mobile and big on the divisors of all those wlc models . thus if all divisors in the extension of @xmath50 are also mobile and big ( e.g. , ample on @xmath89 ; cf .",
    "the perturbation in the proof of theorem  [ thrm - mori morphism is cte ] ) on those divisors , we secure the required nonexceptionality : each wlc model for @xmath626 $ ] corresponds to an effective perturbation of @xmath519 . on the other hand , for @xmath65 with all @xmath627 or close to @xmath72 and any exceptional on @xmath237 b - divisor @xmath306 , by the klt assumption for @xmath628 the inequality",
    "@xmath629 holds near @xmath65 .",
    "hence @xmath306 will be exceptional on the wlc models of all @xmath626 $ ] .",
    "finally , note that this proof allows us to relax the klt slt lmmp to the klt slt big one .",
    "a birational transformation @xmath630 gives a ( small ) log flop if and only if the transformation is small and @xmath631 is the birational image of @xmath519 ( * ? ? ?",
    "* proposition 2.4 ) .",
    "we divide ridges also into two types according to their location in @xmath46 : _ bordering _ and _ internal_. furthermore , the bordering ones are divided into two subtypes : _ cube bordering _ and _ ( mori ) fibering_. the internal ridges correspond to general type and will be also referred to as _ birational_. in its turn , fibering and birational types have three subtypes each .",
    "essentially they can be divided into types as _ only flopping _ , _ divisorial and flopping _ , etc .",
    "but we prefer just a conventional ordering 2a , 2b , etc : e.g. , 2b means fibering type b.    so , let @xmath83 be a ridge of @xmath46 under the generality conditions , @xmath632 , and @xmath12 be a projective wlc model of @xmath13 .",
    "first , we describe the neighboring classes and properties of their models ( only projective , possibly not @xmath34-factorial ) and then prove the statements ( see the proof of theorem  [ thrm - ridge types ] below ) .",
    "[ [ cube - bordering-1 ] ] cube bordering + + + + + + + + + + + + + +    the ridge @xmath83 is _ bordering _ , that is , @xmath633 , and the closure @xmath634 either lies in a ridge of @xmath33 , or in a facet @xmath56 of @xmath33 . in the former case ,",
    "@xmath83 satisfies two equations @xmath71 or @xmath72 , @xmath635 or @xmath72 in @xmath46 . in the latter case",
    ", @xmath56 satisfies an equation @xmath71 or @xmath72 in @xmath33 and @xmath83 is a ridge of @xmath46 in @xmath56 . in both cases ,",
    "@xmath12 can be non klt .",
    "if it is klt , the wlc models can be classified as types below .    for the internal types , the wlc models @xmath12 of @xmath636 , are klt and @xmath391 .",
    "each of them has the lc contraction @xmath637 and @xmath514 is ft .",
    "the base @xmath537 depends only on the ridge @xmath83 .",
    "the pair @xmath393 with projective @xmath11 is a slt wlc model of @xmath13 if and only if @xmath638 and there exist exactly two extremal contractions of @xmath237 over @xmath537 .    [",
    "[ fibering - or-2 ] ] fibering or 2 + + + + + + + + + + + + +    the ridge @xmath639 is also bordering for @xmath46 but @xmath535 .",
    "equivalently , @xmath640 .",
    "the closure @xmath634 is a facet of @xmath641 ( neighboring ) facets @xmath642 in @xmath46 , and a ridge of @xmath643 countries @xmath644 ; @xmath645 has ( closed ) facets @xmath646 ( see diagram [ dia5 facets2 ] below ) .    ridge.eps ( 10,90)@xmath116 ( 37,80)@xmath117 ( 59,45)@xmath645 ( 47,10)@xmath647 ( -5,103)@xmath648 ( 32,103)@xmath649 ( 63,83)@xmath650 ( 72,60)@xmath69 ( 74,40)@xmath651 ( 50,-8)@xmath652 ( 68,8)@xmath653 ( 2,35)@xmath83 ( 9.5,39.5)@xmath474    facets @xmath654 are fibering , and @xmath655 are _ birational _ : flopping or divisorial .",
    "let @xmath656 be mori log fibrations of facets @xmath654 , @xmath657 , be lc models of the birational facets , and @xmath658 , be lc models of countries @xmath645 .",
    "if @xmath653 is divisorial , we suppose that @xmath649 is divisorial ( after interchanging @xmath116 with @xmath647 ) .",
    "each @xmath659 , is flopping , and corresponding @xmath660 are not @xmath34-factorial .",
    "the varieties @xmath661 are @xmath34-factorial .",
    "the varieties @xmath662 are @xmath34-factorial if and only if @xmath663 respectively are divisorial .",
    "more precisely , if @xmath649 is divisorial , then @xmath664 is an elementary divisorial contraction of a prime divisor @xmath120 .",
    "the similar holds for divisorial @xmath653 with contraction @xmath665 of a prime divisor @xmath666 ( possibly the same as b - divisor @xmath120 ) . for @xmath667 , the variety @xmath668 has ( only ) two elementary contractions @xmath669 .",
    "the same holds for @xmath670 if @xmath663 respectively are flopping .",
    "all contractions @xmath671 are small .",
    "the same holds for @xmath672 if @xmath663 respectively are flopping .",
    "each @xmath673 , has a natural contraction to @xmath537 , @xmath674 is extremal , ft and fibered for @xmath675 .",
    "the base @xmath537 is not @xmath34-factorial exactly when @xmath676 is small .",
    "the base @xmath537 is @xmath34-factorial for @xmath677 , in particular , in dimension @xmath678 , and for types 2a with @xmath679 , 2b - c . in all other cases , @xmath537 can be non @xmath34-factorial .",
    "the pair @xmath13 has exactly two wlc models @xmath551 @xmath680 , @xmath681 , @xmath682 , @xmath683 , equipped with a mori log fibration : @xmath684 @xmath685 over @xmath537 , respectively .",
    "the fibrations @xmath656 are _ square _ birational , that is , both contractions @xmath686 are birational if and only if the facets @xmath654 are coplanar . for @xmath679 , 2a is only possible , the pair @xmath13 has exactly one wlc model @xmath571 , the latter is slt and has two mori log fibrations : @xmath687 over @xmath537 , the base @xmath537 is @xmath34-factorial and @xmath688 are mori log fibrations too , @xmath689 are never coplanar .    the flopping ( small ) contractions exist only for @xmath547 .",
    "thus , @xmath690 in dimension @xmath531 ( there are no fibering ridges in dimension @xmath691 ) . in dimension @xmath547 , the only nonflopping cases are : 2a with @xmath679 , 2b with @xmath692 and 2c with @xmath693 .",
    "each pair @xmath694 , @xmath695 , @xmath667 , is a klt slt wlc model of @xmath13 , limiting from @xmath645 .",
    "the pairs @xmath696 satisfy exactly the same when respectively @xmath663 are flopping , and they are limiting from @xmath697 , respectively . each pair @xmath698 , is a non @xmath34-factorial nonslt projective wlc model of @xmath13 , limiting from @xmath69 .",
    "the pairs @xmath699 satisfy exactly the same when respectively @xmath663 are flopping .",
    "if @xmath649 is divisorial , @xmath700 is an @xmath34-factorial projective wlc model of @xmath13 but not a slt wlc model of @xmath13 .",
    "the similar holds for @xmath653 .",
    "there are no other projective wlc models of @xmath13 than above .",
    "the closures @xmath701 are given by equations @xmath702 @xmath199 in @xmath703 , respectively where @xmath704 are curves on a rather high model @xmath177 of @xmath1 , contracted on @xmath661 but not on @xmath670 , respectively .",
    "moreover , if @xmath705 is rather general , then @xmath564 on @xmath706 , and @xmath315 on @xmath707 whereas @xmath199 if and only if the fibration @xmath708 factors through @xmath685 : the diagram @xmath709\\ar@{-->}[r ] & y_m\\ar[d]\\\\ t_1\\ar@{-->}[r ] & t_{m+1 } , } \\ ] ] with the natural birational isomorphism @xmath710 and a ( natural ) rational contraction @xmath711 , is commutative .    the similar holds for general @xmath712 .",
    "the models @xmath656 are square birational if and only if @xmath713 . moreover , @xmath656 are _ generically isomorphic _ , that is , they are natural isomorphic over the general points of @xmath714 , if and only if the facets @xmath654 are coplanar .",
    "if @xmath649 is divisorial , its closure @xmath715 is given by the equation @xmath716 in @xmath579 : @xmath717 on @xmath718 and @xmath199 on @xmath719 ; @xmath716 on @xmath720 if @xmath721 as b - divisor or @xmath653 is flopping .",
    "if @xmath722 , then @xmath717 on @xmath720 .",
    "the similar holds for @xmath666 if @xmath653 is divisorial .",
    "other equations for the divisorial and flopping facets were given in theorem  [ thrm - facet types ] above .",
    "[ [ fibering - a - or-2a ] ] fibering a or 2a + + + + + + + + + + + + + + + +    ( the sarkisov link of type iv . ) both @xmath723 .",
    "the pair @xmath571 is a slt wlc model of @xmath13 .",
    "the base @xmath537 is possibly not @xmath34-factorial for @xmath724 .",
    "all intermediate facets @xmath725 , are flopping .",
    "the only possible other slt wlc models @xmath694 of @xmath13 correspond to the countries @xmath726 , and they are log flops of @xmath571 , directed by a polarization on @xmath668 . more precisely , those flops are composition of elementary ones : @xmath727 the total birational transformation of fibrations : @xmath728\\ar[d]&y_2\\ar@{-->}[r ] & \\cdots \\ar@{-->}[r]&y_i\\ar@{-->}[r]&\\cdots\\ar@{-->}[r ] & y_{m-1}\\ar@{-->}[r ] & y_m\\ar[d]\\\\ t_1\\ar[rrrd]^{\\not\\cong } & & & & & & t_{m+1}\\ar[llld]_{\\not\\cong}\\\\            &   & & t / z . & & & } } \\ ] ]    [ [ fibering - b - or-2b ] ] fibering b or 2b + + + + + + + + + + + + + + + +    ( the sarkisov link of type i and its inverse type iii . ) @xmath729 but @xmath730 .",
    "the base @xmath537 is @xmath34-factorial .",
    "the facet @xmath649 is divisorial with the elementary divisorial contraction @xmath731 and the only possible extremal contraction of @xmath732 is its mori fibration .",
    "all other intermediate facets @xmath733 , are flopping .",
    "the only slt wlc models of @xmath13 are @xmath734 , limiting from the countries @xmath645 , and they are log flops of @xmath735 , directed by a polarization on @xmath668 .",
    "more precisely , those flops are composition of elementary ones : @xmath736 the total birational transformation of fibrations :    @xmath737&y_2\\ar[l]\\ar@{-->}[r]&\\cdots \\ar@{-->}[r]&y_i\\ar@{-->}[r]&\\cdots\\ar@{-->}[r ] & y_{m-1}\\ar@{-->}[r ] & y_m\\ar[d]\\\\   & & & & & & t_{m+1}\\ar[llld]_{\\not\\cong}\\\\ t_1\\ar[rrr]^{\\cong }    &        &   & t / z .",
    "& & & } } \\ ] ]    [ [ fibering - c - or-2c ] ] fibering c or 2c + + + + + + + + + + + + + + + +    ( the sarkisov link of type ii . ) @xmath738 .",
    "the base @xmath537 is @xmath34-factorial .",
    "facets @xmath663 are divisorial with elementary divisorial contractions @xmath739 , respectively .",
    "the only possible extremal contractions of @xmath740 are their mori fibrations .",
    "all other intermediate facets @xmath659 , are flopping .",
    "the only slt wlc models of @xmath13 are @xmath741 , which are limiting from the countries @xmath645 , and they are log flops of @xmath735 , directed by a polarization on @xmath668 . more precisely , those flops are composition of elementary ones : @xmath736    the total birational transformation of fibrations : @xmath709 & y_2\\ar[l]\\ar@{-->}[r ] & \\cdots\\ar@{-->}[r]&y_i\\ar@{-->}[r]&\\cdots\\ar@{-->}[r ] & y_{m-1}\\ar[r ] & y_m\\ar[d ] \\\\ t_1\\ar[rrrd]^{\\cong } &   & & & & & t_{m+1}\\ar[llld]_{\\cong}\\\\   & & & t / z . & & & } \\ ] ]    [ [ internal - or - birational - or-3 ] ] internal , or birational , or 3 + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the ridge @xmath83 is _ internal _ if @xmath742 . in this case , as for internal facets , all wlc models @xmath12 are klt with @xmath391 and of general type with the lc model @xmath743 .",
    "the model @xmath744 of @xmath1 depends only on @xmath83 .",
    "the closure @xmath634 is a facet of @xmath745 ( neighboring ) facets @xmath746 in @xmath46 , and a ridge of @xmath643 countries @xmath644 ; @xmath645 has ( closed ) facets @xmath747 ( see diagrams 6 - 8 below ) .",
    "any two subsequent facets @xmath748 are strictly in a half - plane .",
    "all facets are birational : flopping or divisorial .",
    "let @xmath749 , be lc models of the birational facets @xmath69 and of countries @xmath645 , respectively .",
    "if there is a divisorial facet , we suppose that @xmath649 is divisorial with contraction @xmath731 after shifting indices @xmath750 .",
    "any variety @xmath751 is @xmath34-factorial , and @xmath660 is @xmath34-factorial if and only if @xmath69 is divisorial .",
    "the base @xmath537 is @xmath34-factorial if and only if there are two subsequent divisorial facets @xmath689 with contractions @xmath752 .",
    "all varieties @xmath753 are ft extremal or identical , and @xmath668 are ft with @xmath754 .",
    "the pairs @xmath755 are the nonslt wlc models of @xmath13 .",
    "[ [ birational - a - or-3a ] ] birational a or 3a + + + + + + + + + + + + + + + + + +    the weil - picard number @xmath756 all facets @xmath69 are flopping , and all contractions @xmath757 respectively elementary and extremal small",
    ". the pairs @xmath758 @xmath695 , are the only slt wlc models of @xmath13 .",
    "the models @xmath660 and base @xmath537 are not @xmath34-factorial .",
    "there exists a sequence of elementary log flops in the facets @xmath69 : @xmath759 a subsequence @xmath760 of flops is directed with respect to a polarization on @xmath761 if the flopping facets @xmath762 are strictly in a half - plane . in general , the configuration of facets and countries is not symmetric , in particular , facets are not coplanar .",
    "however two facets @xmath763 are coplanar if and only if @xmath764 is a generalized extremal and directed log flop@xmath765 with respect to their polarizations .",
    "otherwise the span of @xmath69 intersects @xmath766 and @xmath767 is a generalized non - extremal and directed log flop@xmath765 with respect to a polarization .",
    "an equation @xmath768 for the closure @xmath769 in @xmath770 , can be given by a curve @xmath771 on a rather high model @xmath177 of @xmath1 .",
    "this allows us to find coplanar facets in terms of linear extensions for functions @xmath772 from certain countries .",
    "the commuting , centrally symmetric , case is possible only for @xmath773 with coplanar pairs @xmath774 and @xmath775 ; both flopping loci are disjoint .",
    "see diagram [ dia6 ] below :    @xmath776&&\\ar@{--}[ll]\\ar@{--}[rd]&\\\\ y_1\\ar@{-->}[r]\\ar[rrd]^{\\not\\cong}&y_2\\ar@{-->}[r ] & \\cdots\\ar@{-->}[r ] & y_{m-1}\\ar@{-->}[r]&y_{m}\\ar[lld]_{\\not\\cong}\\\\ & & t & & } \\ ] ]     l c r    bir-ridge-a.eps ( 25,-20)(@xmath777 ) ( -5,-1)@xmath649 ( 23,70)@xmath69 ( 43,50)@xmath645 ( -8,55)@xmath650 ( 100,14)@xmath778 ( 63,73)@xmath651 ( 90,59)@xmath653 ( 45,12)@xmath83 ( 60,10)@xmath116 ( 6,23)@xmath117 ( 70,30)@xmath647    & &    bir-ridge-ab4.eps ( 23,46)@xmath83 ( 85,-8)@xmath648 ( 8,-7)@xmath649 ( -8,105)@xmath650 ( 67,103)@xmath779 ( 40,15)@xmath116 ( 2,50)@xmath117 ( 30,80)@xmath118 ( 64,50)@xmath780 ( -64,-28)(@xmath773 , flopping loci are disjoint )     +    [ [ birational - b - or-3b ] ] birational b or 3b + + + + + + + + + + + + + + + + + +    the weil - picard number @xmath781 , and the only divisorial facets are @xmath663 with elementary divisorial contractions @xmath739 of a unique prime b - divisor @xmath120 .",
    "all other facets @xmath69 are flopping with elementary small contractions @xmath782 with @xmath783 or @xmath784 , and with extremal divisorial contractions",
    "@xmath674 , @xmath785 .",
    "the pairs @xmath786 @xmath695 , @xmath667 , are the only slt wlc models of @xmath13 . the models @xmath662 are @xmath34-factorial .",
    "all other models @xmath660 and the base @xmath537 are not @xmath34-factorial .",
    "there exists a sequence of an elementary divisorial extraction , elementary log flops in the facets @xmath787 , and of an elementary divisorial contraction : @xmath788    ccc + & & + & & +    bir-ridge-b.eps ( 30,-20)(@xmath777 ) ( -11,38)@xmath649 ( -6,59)@xmath650 ( 26,79)@xmath69 ( 44,62)@xmath645 ( 102,40)@xmath653 ( 65,80)@xmath651 ( 90,67)@xmath789 ( 35,-7)@xmath778 ( 52,24)@xmath83 ( 23,17)@xmath116 ( 10,43)@xmath117 ( 75,47)@xmath790 ( 75,20)@xmath647 ( 48,30)@xmath474    & &    bir-ridge-ab4.eps ( -55,-30)(@xmath791 ) ( 23,46)@xmath83 ( -8,105)@xmath650 ( 67,103)@xmath779 ( 85,-8)@xmath648 ( 8,-4)@xmath649 ( 40,15)@xmath116 ( 2,50)@xmath117 ( 30,80)@xmath118 ( 65,50)@xmath780     +    any subsequence @xmath760 of flops is directed with respect to a polarization on @xmath761 , and the flopping facets @xmath762 are strictly in a half - plane .",
    "moreover , the facets @xmath792 , are in a half - plane and strictly exactly when @xmath663 are not coplanar . in general , the configuration of facets and countries is not symmetric , in particular , pairs of facets @xmath793 and @xmath663 are not coplanar",
    ". however , two facets @xmath793 are coplanar if and only if @xmath794 is a generalized divisorial contraction , that is , for @xmath795 , @xmath796 is negative on @xmath797 , and @xmath798 is @xmath49-cartier . if @xmath799 are not coplanar and the span of @xmath800 intersects @xmath116 ( respectively @xmath647 ) , then @xmath801 ( respectively @xmath802 ) is a generalized extremal and directed log flop@xmath765 with respect to a polarization .",
    "the facets @xmath663 are coplanar if and only if the flopping locus of @xmath803 does not contain @xmath804 .",
    "this is possible only for @xmath805 .",
    "moreover , the commuting , centrally symmetric , case is possible only for @xmath773 with coplanar pairs @xmath774 and @xmath775 ; the flopping locus is disjoint from @xmath120 .",
    "an equation @xmath768 for the closure @xmath769 in @xmath806 , can be given by a curve @xmath771 on a rather high model @xmath177 of @xmath1 .",
    "for closures @xmath807 respectively in @xmath703 , the equations @xmath808 are given by the contractible divisor @xmath120 .",
    "this allows us to find coplanar facets in terms of linear extensions for functions @xmath809 from certain countries .",
    "[ [ birational - c - or-3c ] ] birational c or 3c + + + + + + + + + + + + + + + + + +    the weil - picard number @xmath810 , @xmath805 , the only divisorial facets are @xmath811 with elementary divisorial contractions @xmath812 @xmath813 of two prime divisors @xmath814 , respectively .",
    "the other contractions @xmath815 are extremal divisorial with both exceptional divisors @xmath816 .",
    "the contractions @xmath817 corresponding to @xmath818 are elementary small .",
    "the pairs @xmath786 @xmath695 , @xmath819 are the only slt wlc models of @xmath13 . the models @xmath820 are @xmath34-factorial .",
    "all other models @xmath821 , are not @xmath34-factorial .",
    "there exists a sequence of elementary divisorial extractions , elementary log flops in the facets @xmath822 , and of elementary divisorial contractions : @xmath823 any subsequence @xmath760 of flops is directed with respect to a polarization on @xmath761 , and the flopping facets @xmath762 are strictly in a half - plane . moreover , the facets @xmath824 , and @xmath825 respectively , are in a half - plane and strictly exactly when @xmath774 and @xmath663 , respectively , are not coplanar . in general , the configuration of facets and countries is not symmetric , in particular , pairs of facets @xmath774 and @xmath663 are not coplanar .",
    "however , pairs @xmath774 and @xmath663 are coplanar if and only if respectively @xmath826 and @xmath827 .",
    "each case or both cases simultaneously can occur for @xmath828 .",
    "however , for @xmath773 , both pairs are coplanar or none of the pairs are coplanar .",
    "the former is possible only for the commuting centrally symmetric case with disjoint contractible divisors @xmath816 .",
    "an equation @xmath768 for the closure @xmath769 in @xmath806 , can be given by a curve @xmath771 on a rather high model @xmath177 of @xmath1 .",
    "for closures @xmath807 respectively in @xmath703 , the equations @xmath808 are given by the contractible divisor @xmath120 .",
    "for closures @xmath829 respectively in @xmath830 the equations @xmath831 are given by the contractible divisor @xmath832 .",
    "this allows to find coplanar facets in terms of linear extensions for functions @xmath833 from certain countries .",
    "@xmath834\\ar[d]&y_4\\ar@{-->}[r ] & \\cdots\\ar@{-->}[r ] & y_{m-2}\\ar@{-->}[r]&y_{m-1}\\ar[d]\\\\ y_2\\cong t_3 \\ar[rrd ] &   & & & y_m\\cong t_m\\ar[lld]\\\\ & & y_1\\cong t_1\\cong t_2\\cong t & & } \\ ] ]    lll    bir-ridge-c.eps ( 44,19)@xmath83 ( -8,-3)@xmath649 ( -2,60)@xmath650 ( 24,78)@xmath835 ( 39,65)@xmath836 ( 50,80)@xmath651 ( 81,69)@xmath653 ( 100,13)@xmath778 ( 55,5)@xmath116 ( 10,25)@xmath117 ( 77,35)@xmath647    & &    bir-ridge-ab4.eps ( -45,-30)(@xmath773 , @xmath837 ) ( 25,46)@xmath83 ( -8,105)@xmath650 ( 67,103)@xmath779 ( 85,-8)@xmath648 ( 8,-4)@xmath649 ( 40,15)@xmath116 ( 3,50)@xmath117 ( 30,80)@xmath118 ( 65,50)@xmath780    [ thrm - ridge types]under the generality conditions on @xmath508 , let @xmath83 be a ridge of the geography @xmath46 .",
    "then it is one of the above types : cube bordering , fibering , or birational , and behaves accordingly .",
    "( see diagram [ dia9 ] below . )",
    "ridges.eps ( 31,103)(1 ) ( 65,58)(3 ) ( 15,25)(2 ) ( 23,36)@xmath474 ( 35,96)@xmath474 ( 57,57)@xmath474    @xmath838    a bordering ridge @xmath83 of @xmath46 has the cube bordering or fibering type by definition , proposition  [ prop - s = closed rational poly ] and corollary [ cor - geoface = cube for general ] . indeed , if @xmath839 , it is cube bordering .",
    "otherwise , @xmath640 and @xmath83 is fibering .",
    "cube bordering type : @xmath83 satisfies at least one equation @xmath71 or @xmath72 .",
    "if @xmath83 satisfies another equation @xmath635 or @xmath72 , it lies in the ridge of @xmath33 given by these equations .",
    "otherwise , @xmath840 for a facet @xmath56 of @xmath33 which satisfies the equation @xmath71 or @xmath72 .    for the boundaries @xmath632 of the other type ridges , @xmath65 is internal : @xmath535 . as in the proof of theorem  [ thrm - facet types ] , any wlc model @xmath12 of @xmath13 is klt with big @xmath391 and has a lc contraction @xmath513 .",
    "if @xmath514 is projective , it is ft by lemma  [ lemma - ft=0log ] with @xmath841 and with at most two extremal contractions@xmath765 by lemma [ lemma - rho of wlc / lc ] .",
    "as we see from the following , @xmath638 holds and there exist two extremal contractions of @xmath237 over @xmath537 exactly when @xmath393 is a slt wlc model of @xmath13 .",
    "in particular , @xmath548 .",
    "such a model @xmath393 exists because @xmath151 and it satisfies the assumptions of lemma  [ lemma - rho of wlc / lc ] .",
    "the slt model can be constructed by the slt lmmp from the above initial model .",
    "fibering type .",
    "suppose that @xmath83 is fibering .",
    "then by the open property of classes and the last statement in theorem  [ mainthrm - geography ] , there exist required countries @xmath645 and facets @xmath800 .",
    "most of stated properties follow from theorem  [ thrm - facet types ] and standard facts .",
    "the pair @xmath571 is a wlc model of @xmath13 by lemma",
    "[ lemma - closed n ] , limiting from @xmath116 . by definition",
    "it has a mori log fibration @xmath842 and @xmath843 .",
    "thus @xmath844 . on the other hand ,",
    "since there exists a slt wlc model of @xmath13 over @xmath575 , this model is @xmath571 and @xmath845 by lemma  [ lemma - rho of wlc / lc ] .",
    "similarly , @xmath681 is a slt wlc model of @xmath13 too .",
    "moreover , all intermediate facets @xmath846 , are flopping and the models @xmath847 are the only slt wlc models of @xmath13 .",
    "if @xmath679 , @xmath732 has two mori log fibrations @xmath848 , which are the only extremal contractions@xmath765 , and by corollary  [ cor - small klt slt wlc models in elementary log flops ] , @xmath571 is the only wlc model of @xmath13 . in the last case , the facets @xmath689 are noncoplanar by corollary  [ cor - facet = face ] . for @xmath724 ,",
    "another extremal contraction @xmath849 is birational and flopping by corollary  [ cor - small klt slt wlc models in elementary log flops ] . indeed ,",
    "if it is divisorial , @xmath850 and @xmath851 has a mori log fibration @xmath852 , a contradiction .",
    "similarly , all other intermediate facets are flopping .",
    "now the description of all wlc models can be obtained from corollary  [ cor - ft eff decomposition ] and theorem  [ thrm - facet types ] .",
    "again the pair @xmath571 is a wlc model of @xmath13 , limiting from @xmath116 . by definition",
    ", it has a mori log fibration @xmath853 .",
    "thus @xmath854 and @xmath855 is the only extremal contraction for @xmath732 . by theorem  [ thrm - facet types ]",
    ", @xmath649 is divisorial .",
    "otherwise , @xmath575 has another extremal contraction to @xmath856 .",
    "in particular , @xmath724 .",
    "so , the pair @xmath735 is a wlc model of @xmath13 , limiting from @xmath117 , with an elementary divisorial contraction @xmath857 . again",
    "@xmath858 and @xmath735 is a slt model of @xmath13 .",
    "moreover , all intermediate facets @xmath859 , are flopping and the models @xmath734 are the only slt wlc models of @xmath13 . if @xmath692 , @xmath851 has exactly one more contraction@xmath765 , the mori log fibration @xmath860 , and by corollary  [ cor - small klt slt wlc models in elementary log flops ] , @xmath735 is the only slt wlc model of @xmath13 .",
    "for @xmath745 , another extremal contraction @xmath861 is birational and flopping by corollary  [ cor - small klt slt wlc models in elementary log flops ] . indeed ,",
    "if it is divisorial , @xmath862 and @xmath863 has a mori log fibration @xmath864 , a contradiction .",
    "similarly , all other intermediate facets are flopping .",
    "as above the description of all wlc models can be obtained from corollary  [ cor - ft eff decomposition ] and theorem  [ thrm - facet types ] .",
    "type 2c . as in type 2b ,",
    "@xmath649 is divisorial and @xmath735 is a slt model of @xmath13 with an elementary divisorial contraction @xmath857 .",
    "similarly , @xmath653 is divisorial and @xmath865 is a slt model of @xmath13 with an elementary divisorial contraction @xmath866 and the subsequent mori log fibration @xmath867 . in particular ,",
    "as above all intermediate facets @xmath868 , are flopping and the models @xmath869 are the only slt wlc models of @xmath13",
    ". the description of all wlc models can be obtained from corollary  [ cor - ft eff decomposition ] and theorem  [ thrm - facet types ] .",
    "note that flopping facets only possible for @xmath547 .",
    "the properties of equations given by @xmath870 @xmath871 and @xmath872 @xmath873 follow from theorem  [ thrm - facet types ] . moreover , if @xmath705 is a sufficiently general curve of a mori log fibration @xmath708 ( from a rather high model @xmath177 of @xmath1 ) , it is not contracted on all models @xmath874 . hence @xmath564 on @xmath706 , and @xmath315 on @xmath707 .",
    "more precisely , @xmath875 on @xmath707 if and only if the birational image of @xmath705 belongs to a fiber of @xmath685 , that is , @xmath708 factors through the last fibration .",
    "the similar holds for a general curve @xmath712 on @xmath685 .",
    "thus the fibrations @xmath656 are square birational to each other if and only if @xmath686 are birational ( the same general curves in fibers ) , or @xmath713 for general @xmath704 .",
    "moreover , @xmath656 are generically isomorphic if and only if the facets @xmath654 are coplanar . indeed ,",
    "if the isomorphism holds then @xmath876 and the natural modification @xmath710 does not touch the general fiber .",
    "thus @xmath877 is linear on @xmath46 near @xmath83 and @xmath654 are coplanar .",
    "conversely , if @xmath654 are coplanar , the convexity of proposition [ prop - p - e ] implies that @xmath878 and @xmath877 is linear on @xmath46 near @xmath83 .",
    "thus the modifications @xmath879 do not touch @xmath705 and @xmath656 are generically isomorphic .",
    "birational type .",
    "suppose that @xmath83 is birational .",
    "then by the open property of classes and the last statement in theorem  [ mainthrm - geography ] , there exist required countries @xmath645 and facets @xmath69 .",
    "most of stated properties follow from theorem  [ thrm - facet types ] and standard facts .",
    "we discuss the others below .    in this case as for internal facets ,",
    "all wlc models @xmath12 are klt with @xmath391 , but now of general type with the lc model @xmath587 by our assumptions and proposition  [ prop - kd nd are constants ] .",
    "the facets @xmath748 are in a half - plane by convexity of @xmath645 and strictly by corollary  [ cor - facet = face ] . in particular , @xmath745 .    type 3a .",
    "since @xmath756 and by lemma  [ lemma - rho of wlc / lc ] , for a slt wlc model @xmath393 of @xmath13 , the contraction @xmath514 is small with @xmath638 and two extremal contractions@xmath765 are also elementary small . as above , for some @xmath750 , @xmath880 , limiting from a country",
    "@xmath645 with two flopping facets @xmath748 , corresponding to two extremal contractions@xmath765 by theorem  [ thrm - facet types ] .",
    "the rest also follows from the classification of facets in the theorem and corollaries  [ cor - ft eff decomposition ] , [ cor - small klt slt wlc models in elementary log flops ] .",
    "note also , that if two facets @xmath763 are coplanar , then @xmath764 is a generalized extremal and directed log flop@xmath765 with respect to a polarization .",
    "indeed , if the facets are coplanar , the one dimensional subspace of @xmath49-cartier divisors in @xmath881 is generated by @xmath882 or @xmath883 , and respectively @xmath884 is ample or antiample@xmath765 .",
    "the converse follows from definition and the description of all projective rational @xmath72-contractions of @xmath514 .",
    "similarly , one can treat the case with the span of @xmath69 intersecting @xmath766 .",
    "an equation @xmath768 for a facet @xmath69 in @xmath806 can be given by a curve @xmath771 on a rather high model @xmath177 of @xmath1 which is contracted on @xmath660 but not on @xmath885 , respectively .",
    "the commuting case can be treated with the convexity of proposition  [ prop - p - e ] .",
    "since @xmath781 , in particular , @xmath537 is not @xmath34-factorial , and by lemma  [ lemma - rho of wlc / lc ] , for a slt wlc model @xmath393 of @xmath13 , the contraction @xmath514 is not small with @xmath638 but two extremal contractions@xmath765 can be small .",
    "however , applying the @xmath120-lmmp for a prime divisor @xmath120 of @xmath237 exceptional on @xmath537 , we obtain a new slt wlc model of @xmath886 , say , @xmath735 , limiting from @xmath117 and with an elementary divisorial contraction @xmath857 of @xmath120 .",
    "equivalently , @xmath649 is divisorial .",
    "thus @xmath575 is @xmath34-factorial and @xmath571 is a nonslt model of @xmath13 , limiting from @xmath116 .",
    "the second facet @xmath648 of @xmath116 is flopping by theorem  [ thrm - facet types ] , because it corresponds to a small extremal contraction @xmath732 .",
    "in particular , @xmath120 is the only prime divisor of @xmath237 exceptional on @xmath537 .",
    "the log flop in @xmath648 gives another @xmath34-factorial nonslt model of @xmath13 : @xmath681 , limiting from @xmath647 .",
    "again by theorem  [ thrm - facet types ] , the facet @xmath653 is divisorial with an elementary divisorial extraction @xmath887 of @xmath120 .",
    "moreover , @xmath663 are the only divisorial facets , e.g. , by corollary  [ cor - small klt slt wlc models in elementary log flops ] .",
    "the rest follows from the classification of facets and corollaries  [ cor - ft eff decomposition ] , [ cor - small klt slt wlc models in elementary log flops ] . by construction and definition ,",
    "@xmath717 on @xmath888 and @xmath199 on the other countries and facets .",
    "thus by the convexity of @xmath889 , the facets @xmath792 , are in a half - plane and strictly exactly when @xmath663 are not coplanar .",
    "the facets @xmath663 are coplanar if and only if the function @xmath889 is linear on the half - plane of @xmath648 , or equivalently , the flop in @xmath648 does not touch @xmath804 generically .",
    "this is possible only for @xmath805 by corollary  [ cor - facet = face ] . by construction facets @xmath793",
    "are coplanar if and only if @xmath890 is a generalized divisorial contraction of @xmath120 .",
    "otherwise , @xmath801 or @xmath891 is a generalized extremal and directed log flop@xmath765 with respect to a polarization ( * ? ? ?",
    "* proof - explanation of corollary 1.9 ) .",
    "note that the contraction @xmath797 is not small , but extremal , and @xmath796 is negative on @xmath797 for @xmath892 when @xmath893 is @xmath49-cartier , or equivalently @xmath153 is coplanar with @xmath800 .",
    "in this situation , for @xmath600 ( respectively @xmath894 ) , a generalized log flip with respect to @xmath153 or a generalized directed log flop of @xmath895 with the polarization @xmath896 ( respectively @xmath897 is @xmath801 ( respectively @xmath802 ) ; it is neither a divisorial contraction or a small flip / flop . for @xmath795 , a log flip or",
    "a log flop of @xmath797 is a generalized divisorial contraction @xmath898 .",
    "the commuting case can be treated as above .",
    "since @xmath810 , @xmath537 is @xmath34-factorial . as in type",
    "2c , we can construct a slt wlc model of @xmath13 , say , @xmath899 with @xmath900 , limiting from @xmath118 and with an elementary divisorial contraction @xmath901 of a prime divisor @xmath832 .",
    "thus @xmath650 is divisorial , @xmath902 is @xmath34-factorial and @xmath735 is a limiting from @xmath117 nonslt model of @xmath13 .",
    "however , now by the @xmath34-factorial property of @xmath537 , the second facet @xmath649 of @xmath117 is also divisorial with an elementary divisorial contraction @xmath903 of a prime divisor @xmath120 .",
    "again by theorem  [ thrm - facet types ] the facets @xmath904 are divisorial with elementary divisorial contractions @xmath905 of divisors @xmath816 , respectively . in particular , @xmath805 .",
    "all other facets are flopping .",
    "the rest follows from the classification of facets and corollaries  [ cor - ft eff decomposition ] , [ cor - small klt slt wlc models in elementary log flops ] . by construction and definition ,",
    "@xmath717 on @xmath888 and @xmath75 on the other countries and facets .",
    "thus by the convexity of @xmath889 , the facets @xmath792 , are in a half - plane and strictly exactly when @xmath663 are not coplanar .",
    "the facets @xmath663 are coplanar if and only if the function @xmath889 is linear on the half - plane of @xmath648 , or equivalently , the extraction @xmath832 in @xmath648 does not touch @xmath804 generically , that is , @xmath827 .",
    "similarly , the facets @xmath906 , are in a half - plane and strictly exactly when @xmath774 are not coplanar .",
    "the facets @xmath774 are coplanar exactly when @xmath907 . if @xmath816 are disjoint , then @xmath773 and the commuting case holds with coplanar pairs @xmath774 and @xmath775 .",
    "conversely , if @xmath773 , then @xmath908 has two extremal divisorial contractions@xmath765 of @xmath816 . if @xmath909 , the commuting case holds with the coplanar pairs .",
    "otherwise , the extremal property implies that @xmath910 and both pairs @xmath774 and @xmath775 are not coplanar .",
    "[ [ central - model ] ] central model + + + + + + + + + + + + +    let @xmath83 be a fibering or birational ridge of a geography under the generality conditions , @xmath632 be a boundary with a decomposition @xmath911 , where @xmath912 and @xmath913 is big and @xmath49-mobile over the lc model @xmath537 of @xmath13 .",
    "such a decomposition always exists and , in applications , the decomposition mob+exc is typical .",
    "a klt slt wlc model @xmath393 of @xmath13 is _ central _ with respect to the decomposition @xmath911 if @xmath914 is a weak log fano ( * ? ? ?",
    "* definition 2.5 ) .",
    "since @xmath915 , @xmath237 depends only on @xmath83 when @xmath916 ( and @xmath917 ) for the mob+exc decomposition of @xmath519 .",
    "theorem [ thrm - ridge types ] implies the following properties of a central model @xmath393 :    1 .",
    "@xmath514 is a @xmath34-factorial ft contraction with @xmath638 .",
    "2 .   @xmath918 , and all other slt wlc models @xmath919 can be reconstructed from @xmath393 by elementary log flops in both directions : @xmath920 @xmath921 and @xmath922 are sequences of a log flop and log flips with respect to @xmath923 ( the modifications are optional ) , with at most one log flop for both chains . in particular , this restores all other divisorial and fibering contractions over @xmath537 : @xmath924 @xmath925 and all other wlc models of @xmath13 .",
    "thus a modification ( link ) of @xmath575 ( respectively @xmath926 ) into @xmath927 ( respectively @xmath928 ) is factored into log antiflips , a log flop ( optional ) and log flips with respect to @xmath929 .",
    "the pair @xmath914 is a log fano exactly when there are no flops ; flops are possible only in dimension @xmath547 .",
    "a prime divisor @xmath31 of @xmath237 is contractible@xmath765 by @xmath930 if and only if there exists a @xmath34-factorial wlc model @xmath404 of @xmath13 where @xmath31 is exceptional on @xmath426 and with @xmath931 . in particular , there are no such divisors if , for any @xmath34-factorial wlc model @xmath404 of @xmath13 , @xmath932 is terminal ( the last condition can be extended for non @xmath34-cartier @xmath933 , assuming that @xmath932 is terminal when it is terminal for a @xmath34-factorialization ) .",
    "4 .   if @xmath393 is @xmath934-lc ( in codimension @xmath935 )",
    ", then @xmath936 is also @xmath934-lc ( respectively , in codimension @xmath935 ) .",
    "for example , this holds if @xmath282 is @xmath934-lc ( respectively , in codimension @xmath935 , @xmath937 and the components of @xmath65 are nonexceptional on @xmath237 ) .",
    "[ cor - central model exists]let @xmath83 be a fibering or birational ridge in @xmath46 under the generality assumptions and @xmath632 .",
    "then for any decomposition @xmath911 as above , @xmath13 has a central model @xmath393 .",
    "for such a decomposition , the model @xmath393 is unique up to a log flop of @xmath914 over @xmath537 .",
    "conversely , any klt weak log fano @xmath914 with the property ( i ) in central model above corresponds to such a ridge .    to construct a central model one can use the @xmath938-mmp@xmath765 with any slt wlc model as an initial one . since @xmath938 is @xmath49-mobile , the modifications are small .",
    "note also that @xmath939 by definition of @xmath537 : @xmath940 .",
    "thus a required model is defined up to a log flop of @xmath914 .",
    "conversely , take @xmath941 , @xmath942 where @xmath913 and @xmath943 ( @xmath49-complement ) .",
    "the generality conditions can be satisfied near @xmath65 according to the big and the semiample property of @xmath305 .",
    "note that , for @xmath294 , @xmath944 is possibly non slt .",
    "thus to apply theorem [ thrm - ridge types ] , we can consider its local version near @xmath65 or we can replace @xmath944 by an appropriate log resolution @xmath945 .",
    "the latter uses the klt property of @xmath946 : for some @xmath947 , @xmath948 and @xmath949 is a slt wlc model of @xmath950 corresponding to a ridge .",
    "the following finiteness is a key to birational factorizations .",
    "[ cor - central models bounded]let @xmath934 be a positive real number .",
    "suppose that ( * ? ? ?",
    "* conjecture 1.1 ) holds for @xmath934-lc varieties of dimension @xmath951 .",
    "then the family of central models @xmath514 and thus their links in dimension @xmath951 for @xmath934-lc slt models @xmath393 are bounded over @xmath952 .",
    "immediate by corollary  [ cor - central model exists ] and by conjecture 1.1 in @xcite . for links ,",
    "see section  [ section6-linkage ] below .",
    "[ example - d=2 links]all possible central models with links in dimension @xmath953 with @xmath954 , e.g. , @xmath955 , and terminal singularities i.e. , nonsingular , ( see links in mori category in section  [ section6-linkage ] below ) are as follows :    2a : @xmath956 , a nonsingular quadric ;    2b : @xmath957 , a blowup of the plane @xmath958 ;    2c : @xmath959 , the standard fiber modification , where @xmath960 are @xmath961-fibrations over a nonsingular curve @xmath178 and @xmath962 is a blowup of @xmath963 with blowdown of another curve to @xmath964 .",
    "note that the last model is @xmath965 .",
    "there are much more such links @xmath966 and central models in dimension @xmath424 in the nonsingular case , and thousands are expected for terminal singularities .",
    "[ [ links ] ] links + + + + +    let @xmath967 be two extremal contractions ( possibly birational ) of @xmath34-factorial projective@xmath968 birationally equivalent varieties @xmath563 . their _ link _ @xmath969 is a composition ( chain ) of extremal divisorial extractions , contractions and small modifications ( e.g. , flips , flops or antiflips ) over another variety @xmath537 with contractions @xmath970 : @xmath709\\ar@{-->}[r]&\\cdots\\ar@{-->}[r ] & y_2\\ar[d]\\\\ t_1\\ar[rd ] & & t_2\\ar[ld]\\\\ & t. & } \\ ] ] such a link from @xmath708 into @xmath971 is _ elementary _ if @xmath563 and all intermediate models @xmath514 in the link are @xmath34-factorial ft with @xmath841 , and modifications are elementary in the following order : ( at most 2 ) divisorial extractions , small modifications , ( at most 2 ) divisorial contractions ; all modifications are optional .",
    "the sequences of modifications of fibering 2a - c and birational 3a - c ridges are elementary .",
    "if , in addition , @xmath967 are mori fibrations and all the models in the link are terminal , it is one of sarkisov links of types i , ii , iii , or iv @xcite .",
    "if @xmath972 are two wlc models of @xmath13 for @xmath65 in a fibering ridge @xmath83 connected by generalized log flops as in types 2a - c , then these log flops give an elementary link from @xmath708 into @xmath685 by theorem  [ thrm - ridge types ] .",
    "we can take also their inverses but the only new will be for nonsymmetric type 2b .",
    "they are sarkisov links when all varieties @xmath751 are terminal .",
    "those links will be referred to as _ cte _ ( _ centralized terminal elementary _ ) if they have a terminal _",
    "model @xmath514 with @xmath973 , in particular , @xmath974 is big and @xmath49-mobile itself@xmath765 on any wlc model @xmath393 of @xmath13 . in addition , @xmath237 should be terminal for all @xmath34-factorial wlc models @xmath393 of @xmath13 .",
    "e.g. , this is true if a slt model @xmath694 in the link is terminal and @xmath975 or @xmath976 is big@xmath765 on any divisor of @xmath751 ( cf . the mobility below ) .",
    "conversely , the sarkisov links are cte .",
    "the terminal and elementary properties follow from definition .",
    "the central property also follows from definition .",
    "more precisely , if the first small modification is a flip or a flop , @xmath732 is a central model .",
    "otherwise , a central model @xmath668 is a result of maximal chain of antiflips ; if the next modification is a flop , @xmath668 is a weak fano fibration , otherwise , @xmath668 is a fano fibration . in total , the link is factored into a divisorial extraction , antiflips , a flop , flips and a divisorial contraction ( all factors are optional ; cf .",
    "( ii ) in central model ) .",
    "flops are possible only in dimension @xmath547 .",
    "the contractions @xmath514 in a cte or sarkisov link satisfy the _ mobility@xmath765 _ : @xmath977 is @xmath49-mobile and big@xmath765 in codimension @xmath72 .",
    "the latter means that @xmath977 is big@xmath765 and big@xmath765 on any divisor of @xmath237 .",
    "thus @xmath978 for @xmath979 , @xmath977 is nonzero effective@xmath765 modulo @xmath276 .",
    "the boundedness of corollary  [ cor - central models bounded ] with @xmath980 holds also for the sarkisov links ( cf .",
    "* proposition 6 ) ) .",
    "[ cor - links / pt bounded in 3](global ) cte links with @xmath981 are bounded in dimension @xmath982 .",
    "immediate by corollary  [ cor - central models bounded ] with @xmath980 and @xcite .    [",
    "[ mori - category ] ] mori category + + + + + + + + + + + + +    let @xmath1 be a variety .",
    "its mori category is the category of minimal resulting models of @xmath1 with birational transformations as morphisms .",
    "so , an object is a projective terminal @xmath34-factorial model @xmath11 of @xmath1 with nef @xmath983 , a minimal model , or a projective terminal @xmath34-factorial model @xmath11 of @xmath1 equipped with a mori fibration @xmath541 .",
    "a factorization of morphisms in the case of minimal models is known ( see corollary  [ cor - small klt slt wlc models in elementary log flops ] above ) .",
    "a factorization between mori fibrations was suggested by sarkisov .",
    "[ thrm - mori morphism is cte]a morphism between mori fibrations can be factorized into cte links , or equivalently , into sarkisov links .",
    "however , this is not a factorization of the genuine sarkisov program : the sarkisov s invariants may not decrease .",
    "so , this is not a solution to the sarkisov program",
    ".    follows from a linkage ( * ? ? ?",
    "* example 2.11 ) after a perturbation . for simplicity ,",
    "we assume the absolute case : @xmath984 , and omit the notation @xmath416 below .",
    "we suppose also that the dimension @xmath985 .",
    "so , let @xmath986_g\\ar@{-->}[r ] & y'\\ar[d]^{g ' } \\\\",
    "t&t ' } \\ ] ] be a birational transformation for mori fibrations @xmath987 .",
    "we can convert each mori fibration @xmath514 into a polarized one @xmath518 with an ample boundary @xmath519 .",
    "take a sufficiently ( very ) ample divisor @xmath369 on @xmath537 and put @xmath988 where @xmath31 is a generic reduced irreducible divisor in a linear system @xmath989 @xmath990 , and @xmath991 . by construction @xmath628",
    "is a terminal ( in codimension @xmath612 ) slt model with the lc contraction @xmath429 , the mori fibration .",
    "similarly , @xmath992 has a polarization @xmath993 with @xmath994 .",
    "we can assume also that @xmath995 have a common log resolution @xmath89 on which ( the birational transformations of ) @xmath619 are big , mobile ( even free ) and disjoint .    according to ( * ? ? ?",
    "* example 2.11 ) and corollary  [ cor - small klt slt wlc models in elementary log flops ] ( see also factorization for a birational transformation of wlc models in section [ section4-finiteness ] ) , there exists a factorization of @xmath996 into links .",
    "the intermediate models @xmath997 in the factorization are slt wlc models of @xmath998 for @xmath999 , a class ( an open interval ) in the separatrix @xmath1000 .",
    "( since each @xmath976 is @xmath49-mobile , we identify @xmath976 with its birational transform @xmath1001 on @xmath751 by writing the same @xmath976 . )",
    "the union @xmath1002 gives a path from @xmath65 to @xmath153 in @xmath456 . by construction",
    "each @xmath751 has only terminal singularities and has a mori fibration @xmath1003 ( possibly after a log flop of @xmath997 ) by corollary  [ cor - geoface = cube for general ] .",
    "we can suppose that @xmath1004 for the first interval @xmath1005 and @xmath1006 for the last interval @xmath1007 .",
    "see diagram [ dia10 ] below .",
    "a link from @xmath1003 into @xmath1008 corresponds to the point @xmath1009 of intersection @xmath1010 . note that @xmath1011 are wlc models of @xmath1012 by lemma  [ lemma - closed n ] .",
    "the link may not be elementary , in particular , @xmath660 is not necessarily the lc model of @xmath997 , and the picard ranks for intermediate models @xmath1013 over the lc model of @xmath1012 can be rather high .",
    "ccc    nonpert-path.eps ( 60,26)@xmath153 ( 60.5,30)@xmath474 ( 7,59)@xmath1005 ( 32,35)@xmath1014 ( -2,87)@xmath65 ( 22,48)@xmath1015 ( 21,44.8)@xmath474 ( 82,50)@xmath1016 ( 75,56)perturbation    & &    perturbed-path2.eps ( 25,86)@xmath65 ( 84,26)@xmath153 ( 5,-4)@xmath1017 ( 35,78)@xmath1018 ( 40,49)@xmath1019 ( 48,34)@xmath1020 ( 73,37)@xmath1021 ( 35,39)@xmath1014 ( 29,55)@xmath1005 ( 56,31)@xmath1022 ( 31,76)@xmath474 ( 38.5,45)@xmath474 ( 45.5,38.5)@xmath474 ( 74,31)@xmath474    to attain cte links we use a perturbation and theorem  [ thrm - ridge types ] . to fulfil the generality conditions for @xmath945",
    ", we add to @xmath1023 generic ( very ample ) divisors @xmath3 so that the conditions hold for a suitable extension @xmath1024 .",
    "note that after a perturbation our new subclasses @xmath1025 and @xmath1009 are embedded into @xmath1026 .",
    "( if @xmath1027 , the subclasses are cube bordering : @xmath1028 . )",
    "now we perturb the whole path @xmath1029 into a path in @xmath456 away from @xmath1030 .",
    "we perturb the path in such a way that it goes only through internal points of fibering facets and ridges .",
    "( this path can be straight under the projection of proposition  [ prop - image of separatrix ] . )",
    "thus now we suppose that new intervals @xmath1025 are in fibering facets @xmath69 and new vertexes @xmath1009 in fibering ridges @xmath1031 ( we use the same notations for the perturbed path even though there is no @xmath72-to-@xmath72 correspondence for intervals and vertexes under the perturbation ) . by construction @xmath1032",
    "are the mori log fibrations of @xmath1033 , @xmath1034 are terminal and @xmath751 is terminal for other mori log fibrations of facets @xmath69 . indeed , for the perturbation @xmath1035 of @xmath65 , the pair @xmath1036 has the same contraction @xmath514 because the contraction is extremal ft . the same works for @xmath426 : for the perturbation @xmath1037 in the facet @xmath762 close to @xmath153 , a slt model @xmath1038 is terminal , and so is @xmath1039 .",
    "the terminal property is also stable under perturbation .",
    "each slt wlc model @xmath1040 of @xmath1041 for a ( klt ) boundary @xmath1042 , is terminal because @xmath1041 is terminal and @xmath1043 is non contractible .",
    "( this model may have cn singularities on the lc model . ) similarly , the terminal property holds for intermediate @xmath751 .",
    "moreover , the same holds for any intermediate @xmath34-factorial model of a link from @xmath1003 into @xmath1008 by theorem  [ thrm - facet types ] .",
    "indeed , if we have the lc model @xmath1040 for @xmath1043 in a divisorial facet of @xmath46 , with a contracted divisor @xmath306 of the facet , then for pair @xmath1040 , the only cn singularity is @xmath1044 .",
    "but by our assumptions @xmath1045 contains the center , and @xmath488 is terminal .",
    "since @xmath1046 is big and @xmath49-mobile , the link is cte by corollary  [ cor - central model exists ] and a required factorization is @xmath1047 .",
    "[ [ polarized - linkage ] ] polarized linkage + + + + + + + + + + + + + + + + +    so , we have constructed a chain of links with _",
    "polarizations _ as follows .",
    "there exist a model @xmath945 of @xmath237 , where @xmath1048 is a reduced divisor with only big and mobile prime components , with components of @xmath1049 generating each @xmath1050 , and intervals @xmath1051 such that :    all boundaries in the interval @xmath1025 are @xmath35 equivalent with terminal klt wlc models @xmath1052 , of @xmath998 ; actually @xmath976 on @xmath751 is the birational transform of @xmath976 from @xmath89 ;    @xmath1053 is the lc contraction of @xmath997 , that is , @xmath1054 is a pull back of an ample divisor from @xmath660 ; and    each vertex @xmath1009 gives a cte or sarkisov link between limiting models @xmath1011 ; they can be cn and with lc models @xmath1055 over which the link goes : for @xmath1009 ,    2a : @xmath1056 and each @xmath1013 have at most one another elementary small and numerically trivial contractions@xmath1057 with respect to @xmath1058 ;    2b : @xmath1059 , an elementary divisorial extraction @xmath1060 corresponds to the unique _ maximal _",
    "center @xmath1061 ( exceptional divisor ) with cn singularity : @xmath1062 with center @xmath1063 ( a small linear prolongation in direction @xmath1064 gives a unique noncn center ) , and @xmath1065 has at most one another elementary small and numerically trivial contraction@xmath1057 with respect to @xmath1066 ; the same can hold after interchanging @xmath750 and @xmath1067 ;    2c : @xmath1068 with elementary divisorial extractions @xmath1069 as in 2b ;    each of those links can be centralized ( see links above ) .    a limit to boundaries in @xmath1070 supported in @xmath1023 ( the original path ) gives similar conditions with cn singularities of pairs instead of terminal and semiampleness instead of ampleness on @xmath660 and @xmath1055 .",
    "[ [ rigidity ] ] rigidity + + + + + + + +    a mori fibration @xmath514 is _ rigid _ if , for any other mori fibration @xmath992 , any birational isomorphism @xmath405 gives an isomorphism of the fibrations @xmath987 .",
    "the definition and the definitions below work over any @xmath1071 .",
    "however , if @xmath1072 the rigidity is only possible when @xmath1073 .",
    "thus , for @xmath1074 , it is reasonable to use a weaker version : @xmath514 is birationally rigid ( see below ) and any mori fibration @xmath1075 satisfies the above property .",
    "there are other weaker versions of the rigidity .",
    "if it holds over the general points of @xmath1076 we say that @xmath514 is _ generically _ rigid .",
    "for example , so do the conic bundles satisfying sarkisov s criterion below .",
    "a mori fibration @xmath514 ( or over the general point of @xmath537 ) is _ birationally _ rigid if , for any other mori fibration @xmath992 , any birational isomorphism @xmath405 gives a birational isomorphism of the fibrations @xmath514 and @xmath992 , that is , they are square birational under the isomorphism .",
    "the fibration is _ weakly _ rigid if , in addition , any mori fibration @xmath992 square birational to @xmath514 is isomorphic to @xmath514 over the general point of @xmath537 ( possibly under a different birational isomorphism @xmath405 ) .",
    "such an isomorphism allows us to treat the birational isomorphism @xmath405 as a birational automorphism of @xmath514 and vice versa .",
    "del pezzo fibrations of degree @xmath953 and @xmath424 give nontrivial examples of the last rigidity ( see corollary  [ cor - delpezzo123rigid ] below ) .",
    "in general , it is expected that a mori fibration @xmath514 is weakly rigid if its general fiber is weakly rigid and @xmath514 is sufficiently twisted , e.g. , the discriminant locus is large or the map of @xmath537 into moduli of fibers has a large degree . moreover , in higher dimensions , a rather general mori fibration @xmath514 is usually rigid@xmath1077 if its general fiber is rigid .",
    "we will treat this with more details and applications elsewhere .",
    "here we only illustrate this in some special cases usually assuming @xmath1072 .",
    "[ cor - conic rigid threshold]suppose ( * ? ? ?",
    "* conjecture 1.1 ) for terminal weak fano varieties of dimension @xmath1078 . in dimension @xmath951 , there exists a rational number @xmath1079 ( _ the birational rigidity threshold for conic bundles of dimension @xmath951 _ ) satisfying the following .",
    "a mori conic bundle @xmath1080 with @xmath1081 is generically rigid if , for some real number @xmath1082 , @xmath1083 is cn and @xmath1084 is pseudo - effective where @xmath178 is the discriminant locus of the conic bundle @xmath1080 .",
    "moreover , for @xmath1085 , we can omit ( * ? ? ? * conjecture 1.1 ) .    for @xmath1086 ,",
    "the corollary becomes the sarkisov theorem @xcite @xcite .",
    "for any @xmath1087 with cn @xmath1083 , the condition @xmath1084 is pseudo - effective is equivalent to the condition @xmath1088 by conjecture [ conj - semiample ] . according to zagorskii @xcite in dimension @xmath424 and to sarkisov ( * ? ? ? *",
    "theorem 1.13 ) in higher dimensions , any conic bundle @xmath1080 has a mori conic bundle model @xmath514 ( square birational to @xmath1089 with cn @xmath1083 for any @xmath1090 .",
    "actually , in the corollary one can suppose that @xmath1080 is a morphism which is a mori or standard conic bundle over codimension @xmath72 .",
    "such a weak standard model with cn @xmath1083 can be easily constructed for any conic bundle and any @xmath1091 .",
    "suppose that @xmath1092 is another mori fibration , @xmath89 and @xmath1093 are birational , but not square birational .",
    "note that square birational links preserve all conditions except for the cn property @xmath1083 .",
    "however , if @xmath1094 is pseudo - effective on such a cn model , it is true on any model with the birational transform of @xmath178 plus any exceptional divisors ( cf .",
    "* lemma 2.2 ) ( * ? ? ?",
    "* lemma 4 ) ) . now consider a cte link from @xmath1080 into @xmath1092 which is not square birational , that is , over some @xmath488 with @xmath1095 , there exists a fibering contraction @xmath1096 . according to the big and @xmath49-mobile property of @xmath1097 , @xmath1098 .",
    "hence , for @xmath1099 , by the key formula @xmath1100 ( * ? ? ?",
    "* lemma 2 ) , where @xmath1101 , a contradiction .",
    "now by corollary  [ cor - central models bounded ] , the ft varieties @xmath1102 and thus @xmath1103 are bounded generically@xmath1104 .",
    "note that @xmath1105 and they are mori log fibrations@xmath1104 with @xmath1106 .",
    "this implies our improvement for @xmath1107 for all weil reduced divisors @xmath178 on @xmath537 and assuming @xmath1108 .",
    "actually , @xmath1109 .",
    "indeed , the cn property of @xmath1083 and the pseudo - effective property of @xmath1084 for any @xmath1082 implies that of @xmath1110 and of @xmath1111 for @xmath1112 .",
    "[ cor - delpezzo123rigid ] let @xmath1113 be a @xmath424-fold mori fibration of degree @xmath1114 over a curve @xmath178 : @xmath1115 , @xmath178 is a nonsingular curve ( not necessarily complete ) , @xmath1113 is a mori fibration whose general fibers are del pezzo surfaces of degree @xmath951 .",
    "then @xmath1113 is weakly rigid if one of the following holds :    1 .",
    "@xmath1113 has sufficiently many singular fibers over a nonsingular completion @xmath1116 of @xmath178 , that is , there exists a natural number @xmath1117 such that the number of nonsmoothable fibers on the completion of @xmath178 is @xmath1118 ; 2 .",
    "the map @xmath1119 , @xmath1120 the class of the smooth geometric fiber @xmath1121 of @xmath1122 , has a sufficiently large degree , where @xmath1123 is a coarse moduli space of smooth del pezzo surfaces of degree @xmath951 ; 3 .   for each mori model @xmath1124 of @xmath1113 over the completion @xmath1116 , @xmath1125 holds ; or 4 .   for each mori model @xmath1124 of @xmath1113 ,",
    "@xmath1126 holds , where @xmath1127 denotes the cone of curves on @xmath237 .    moreover , for degree @xmath72 , @xmath1113 is generically rigid and , for degree @xmath1128 , any birational automorphism of @xmath1113 is a composition of ( bertini and geiser ) involutions and of isomorphisms over the general point of @xmath178 .",
    "the number in ( i ) is the sum of degrees of points in @xmath1116 , the fibers over which are not smoothable .",
    "the condition ( ii ) is geometrical and , according to the proof below , ( i ) can be treated geometrically too . the condition in ( iii ) for @xmath1124",
    "was introduced by grinenko @xcite and is known as the @xmath1129-_condition _",
    "* conjecture 1.2 ( ii ) ) ) .",
    "for a mori fibration @xmath1130 over a nonsingular projective curve @xmath178 , it is equivalent to the inclusion : @xmath1131\\oplus g^*\\operatorname{eff}(c)\\ ] ] where @xmath1132 and @xmath1133 .",
    "the condition in ( iv ) for @xmath1124 was introduced by pukhlikov @xcite and is known as the @xmath1134-_condition_. the @xmath1134-condition implies the @xmath1129-condition .    after a completion we can suppose that @xmath89 and @xmath1135 are projective . by the weak rigidity of minimal del pezzo surfaces of degree @xmath678 ( * ? ? ?",
    "* proposition  3.3 ) , each link over @xmath1136 is square birational and preserves all conditions ( i - iv ) . for @xmath691 , the links do not change @xmath1113 generically over @xmath178 . for @xmath1137 , the only nontrivial fiberwise links are ( bertini and geiser ) involutions and they give the same fibration generically .",
    "but the ( global ) links@xmath1138 are bounded by corollary  [ cor - links / pt bounded in 3 ] that contradicts ( i ) and ( ii ) with sufficiently large constants .",
    "the property ( ii ) is geometrical because the degree is geometrical and , actually , we need to consider moduli over an algebraically closed field .",
    "the property ( i ) is geometrical too because the smoothness is geometrical due to park : the smooth compactification is unique for @xmath1139 ( even @xmath1140 ) @xcite .    by the mobility of cte links ,",
    "there are no links of @xmath1130 under the conditions ( iii - iv ) .",
    "more precisely , the @xmath1134-condition implies the @xmath1129-condition and the latter contradicts the mobility .",
    "indeed , the link has type 2b or 2c .",
    "let @xmath426 be its central model and @xmath1141 be an anticanonical model of @xmath426 with a small contraction @xmath1142 .",
    "thus there exists a ( natural ) small modification @xmath1143 into a fano @xmath424-fold @xmath1141 .",
    "this gives a decomposition @xmath1144 , that contradicts the @xmath1129-condition , where @xmath305 is a ( big ) @xmath34-mobile divisor , @xmath625 is a fiber of @xmath1130 , and @xmath1145 is a positive rational number .",
    "note that @xmath1146 is an ample divisor on @xmath1141 and @xmath1147 is a weil divisor on @xmath1141 .",
    "[ cor - dp1nonsing rigid = k ] let @xmath1113 be a @xmath424-fold mori fibration of degree @xmath72 over a nonsingular projective curve @xmath178 .",
    "then @xmath1113 is generically rigid if and only if , for each mori model @xmath1130 of @xmath1113 , the @xmath1129-condition holds .",
    "this is a weak version of the @xmath1129-conjecture ( * ? ? ?",
    "* conjecture  4.4 ) for del pezzo fibrations of degree @xmath72 .",
    "immediate by corollary  [ cor - delpezzo123rigid ] ( iii ) and [ grin2 , theorem  4.5 ] .",
    "it is not difficult to construct many examples of weakly rigid @xmath424-fold mori fibrations satisfying corollary  [ cor - delpezzo123rigid ] ( i - ii ) .",
    "those examples and corollary  [ cor - dp1nonsing rigid = k ] allow us to construct many rigid mori fibrations of degree @xmath72 satisfying corollary  [ cor - delpezzo123rigid ] ( iii ) .",
    "examples of such fibrations satisfying corollary  [ cor - delpezzo123rigid ] ( iv ) for degree @xmath72 or ( iii - iv ) for degrees @xmath1128 are unknown at present , but they are expected ( * ? ? ?",
    "* problem  5.9 ( 3 ) ) .",
    "[ [ questions ] ] questions + + + + + + + + +    for what degrees @xmath951 , does the @xmath1129- , or @xmath1134-condition hold , or the mobility not hold for almost all del pezzo fibrations with terminal singularities ? equivalently , for what degrees @xmath951 , does the condition @xmath1148 , or the mobility is _ bounded _",
    ", that is , the del pezzo fibrations @xmath1113 of degree @xmath951 with given property and only with terminal singularities form a bounded family ? the same questions are especially important for mori fibrations .    for example , the condition @xmath1149 is unbounded for cubic mori fibrations ( * ? ? ?",
    "* lemma  3.6 ) .",
    "this and corollary  [ cor - delpezzo123rigid ] give an unbounded family of terminal gorestein weakly rigid cubic mori fibrations@xmath1150 without the @xmath1134-condition . on the other hand , all nonsingular mori fibrations with @xmath1129-condition of degrees @xmath1151 and rather general of degree @xmath424",
    "are weakly rigid ( * ? ? ?",
    "* theorems  5.6 , 6.4 and 7.1 ) . some of them does not satisfy the @xmath1134-condition . however , it is unknown whether the condition ( iii ) of corollary  [ cor - delpezzo123rigid ] holds for some of them .",
    "the proofs of these rigidity results use the maximal singularity method and some elements of the sarkisov program @xcite",
    "@xcite @xcite .",
    "probably , the latter can be replaced by polarized linkage .",
    "maximal singularities play a crucial role in birational geometry .",
    "anyway , our approach improves the maximal singularity method .",
    "[ thrm - nonrigid mori ] let @xmath1080 be a mori fibration .",
    "the following properties are equivalent :    1 .",
    "@xmath1080 is nonrigid@xmath1077 ; 2 .",
    "there exists a mobile@xmath765 linear system @xmath1152 of degree ( possibly a rational number ) @xmath1153 which has a single exceptional maximal b - divisor ; 3 .",
    "there exists a mobile@xmath765 linear system @xmath1152 of degree @xmath1153 which has an exceptional maximal b - divisor ; 4 .",
    "there exists a big mobile@xmath765 linear system @xmath1152 of degree @xmath1153 which has a single exceptional cn b - divisor and is big@xmath765 on all its cn b - divisors ; 5 .",
    "there exists a big mobile@xmath765 linear system @xmath1152 of degree @xmath1153 which has an exceptional cn b - divisor and is big@xmath765 on all its cn b - divisors ; 6 .",
    "@xmath1080 has a model @xmath514 such that @xmath514 is a weak projective terminal @xmath34-factorial fano variety with @xmath638 and with big@xmath765 @xmath977 in codimension @xmath72 ; 7 .",
    "@xmath1080 has a model @xmath514 such that @xmath514 is a terminal fano variety with @xmath1154 ; 8 .",
    "@xmath1080 has a model @xmath514 such that @xmath514 is a weak projective terminal @xmath34-factorial fano variety with @xmath844 and with big@xmath765 @xmath977 in codimension @xmath72 ; and 9 .",
    "@xmath1080 has a model @xmath514 such that @xmath514 is a terminal fano variety with @xmath1155 .    in the statement and below @xmath1156",
    "means that , for any weil divisor @xmath1157 , @xmath1158 , that is , @xmath1159 .",
    "in other words , @xmath1160 denotes an integral weil divisor @xmath31 such that @xmath1161 .",
    "( of course , for the integral numbers @xmath951 , @xmath1162 has a canonical choice up to @xmath1163 . ) note that @xmath31 is not unique even if @xmath951 is integral .",
    "the linear system @xmath1164 _ has a cn @xmath1165-divisor _",
    "@xmath306 if , for general @xmath1166 , the cn threshold @xmath1167 of @xmath1168 is @xmath1169 and @xmath1170 .",
    "the cn @xmath1165-divisor is _ maximal _ if @xmath1171 .",
    "note that @xmath1167 is independent of general @xmath31 and each nonexceptional divisor is cn if @xmath1172 .",
    "suppose that @xmath1080 is nonrigid@xmath1077 and @xmath1173 with @xmath1174 is the first cte link .",
    "the link goes over @xmath537 and let @xmath514 be its central model .",
    "the model @xmath514 satisfies ( vi ) and ( viii ) , and ( iv - v ) with @xmath1164 , the birational transformation of @xmath1175 for some @xmath990 .",
    "taking @xmath1164 with the fixed exceptional divisor for @xmath1176 , we get ( iii ) .",
    "the contraction of flopping curves of @xmath514 in ( vi ) ( the anticanonical model ) gives a model in ( vii ) and ( ix ) .",
    "conversely , the @xmath34-factorialization of models in ( vii ) and ( ix ) gives models in ( vi ) and ( viii ) respectively .",
    "thus ( vi ) , ( viii ) and ( vii ) , ( ix ) are equivalent respectively .",
    "note that , ( i ) , ( iv ) and ( vi ) are equivalent ( see the proof of corollary  [ cor - central model exists ] ) , and follow from ( ii ) .",
    "similarly , ( v ) and ( viii ) are equivalent and follow from ( iii ) .",
    "a perturbation of the linear system @xmath1177 in ( iii ) allows us to construct a linear system in ( ii ) .",
    "hence ( ii ) and ( iii ) are equivalent .",
    "similarly , ( iv ) and ( v ) are equivalent .",
    "finally , ( ii ) implies ( iv ) by definition .",
    "[ cor - rigid mori ] a mori fibration @xmath1080 is rigid@xmath765 if and only if any mobile@xmath765 linear system @xmath1178 of rational degree @xmath1153 has no exceptional maximal b - divisors .",
    "immediate by theorem  [ thrm - nonrigid mori ] .",
    "this implies that rigidity and nonrigidity are constructive conditions ( cf .",
    "@xcite ) . recall that a _ mori - fano variety _ is a mori fibration over a point @xmath981 .",
    "[ cor - rigid mori fano ] suppose that the base field k is algebraically closed and assume ( * ? ? ?",
    "* conjecture 1.1 ) for projective weak fano varieties of dimension @xmath1078",
    ". then the rigid ( respectively nonrigid ) mori - fano varieties of dimension @xmath951 form a constructive set in the coarse moduli of mori - fano varieties of dimension @xmath951 .",
    "it is enough to consider nonrigidity . by theorem  [ thrm - nonrigid mori ] , the nonrigid mori - fano varieties are the images of the terminal fano varieties @xmath89 with @xmath1179 .",
    "more precisely , the latter should have a fixed @xmath34-factorialization and a fixed extremal ray on it .",
    "then the image is given by a modifications starting from the ray .",
    "the image gives mori - fano varieties for a constructive subset and is constructive itself .",
    "this section gives an overview of the lmmp and semiampleness and detailed assumptions for the statements of the paper .",
    "we use the basic notions and notations from @xcite @xcite @xcite .",
    "below we recall some of them .",
    "let @xmath1 be a morphism of varieties .",
    "a variety means a geometrically reduced and irreducible normal algebraic variety over some field @xmath1180 , usually , of characteristic 0 ( not necessarily algebraically closed ) .",
    "the role of the last assumption will be explained below . according to the following",
    "we can suppose that @xmath1 is proper .",
    "a model of @xmath1 is another _ proper _ morphism @xmath11 of varieties such that @xmath89 and @xmath237 are birationally isomorphic@xmath416 .",
    "moreover , the birational isomorphisms @xmath1181 is fixed and called _ natural _ for the model @xmath11 . in other words , a _ model _",
    "is such an isomorphism @xmath388 .",
    "a _ natural birational isomorphism _ of models @xmath969 for @xmath1 is a unique birational isomorphism in the commutative diagram : @xmath24\\ar@{-->}[rd ] & \\\\ y_1\\ar@{-->}[rr ] & & y_2 } \\ ] ] with natural birational isomorphisms @xmath1182 .",
    "similarly , if @xmath925 , @xmath1183 are two proper morphisms of models@xmath416 , their _ ( rational ) morphism _ is a commutative square : @xmath709\\ar@{-->}[r]&y_2 \\ar[d]\\\\ t_1\\ar@{-->}[r]&t_2 } \\ ] ] with the natural birational isomorphism @xmath969 ; the _ natural _ rational morphism @xmath1184 is unique",
    ". two models @xmath1185 are considered as the _ same ( equal ) _ if the natural birational isomorphism is biregular , that is , they are naturally _",
    "isomorphic_. respectively , @xmath967 are _ naturally isomorphic _ if @xmath1186 are biregular isomorphisms . usually , everybody omit the adjective  natural \" .",
    "the symbol @xmath1187 or @xmath1188 denotes a natural isomorphism and @xmath1189 any other .",
    "for example , a quadratic transformation @xmath1190 gives a model @xmath1191 of @xmath1192 which is unnaturally isomorphic to @xmath1192 ( see example [ example - cremona ] above ) .",
    "there are two subtleties in the model theory .",
    "first , we can consider local and even formal theory , that is , we can replace @xmath1071 by a local or formal germ of @xmath1071 at some scheme point @xmath1193 .",
    "this gives _",
    "local _ and _ formal _ models over @xmath1071 whereas models over a variety @xmath1071 , especially for projective @xmath1071 , are known as _",
    "global_. for simplicity , a reader can suppose that all models are global . however , everything works ditto for local and formal models .",
    "second , that is more important for us , we consider models of pairs .",
    "this leads to log models .      a pair @xmath129 consists of a proper morphism @xmath1 and a b - divisor @xmath1194 .",
    "usually , we suppose that @xmath1195 is a b - boundary .",
    "a b - boundary means a finite b-@xmath49-divisor @xmath1196 where the sum runs over a finite set of distinct prime b - divisors @xmath1061 with multiplicities @xmath73 in the unit segment @xmath1197 $ ] of real numbers .",
    "the divisors @xmath1061 are supposed to be fixed .",
    "for example , all @xmath1198 and @xmath1199 s_i \\cong [ 0,1]^m,\\ ] ] where @xmath1200 is a fixed finite reduced b - divisor .",
    "an element @xmath6 will be referred to as a _ boundary _",
    "divisor even when it is actually a b - boundary .",
    "let @xmath13 be a pair with a boundary @xmath6 .",
    "a log pair @xmath12 is a _ log model _ of @xmath13 if @xmath11 is a model of @xmath1 , with a natural birational isomorphism @xmath1181 , and @xmath1203 is the _ log transformation _ of @xmath65 on @xmath237 , that is , @xmath1204 where @xmath519 is the trace of @xmath65 on @xmath237 and the summation runs over the distinct @xmath1205-exceptional prime divisors @xmath1061 on @xmath237 , not components of @xmath50 .",
    "since @xmath12 is a log pair , for any canonical divisor @xmath983 of @xmath237 , the divisor @xmath1206 is @xmath49-cartier .",
    "note that the boundary @xmath1203 is also the trace on @xmath237 of an _ infinite _ b - boundary @xmath1207 where @xmath1061 are the distinct prime divisors exceptional on @xmath89 and not prime components of @xmath50 . both boundaries @xmath1208 and @xmath1203 depend on @xmath50 .",
    "however , if @xmath50 is a usual divisor ( i.e. , a b - divisor without exceptional components ) on @xmath89 , the divisors @xmath1208 and @xmath1203 are independent of @xmath50 .",
    "it is a lc pair with a boundary .",
    "such a pair @xmath12 is called an _ initial model _ of @xmath13",
    "if @xmath12 is a log model of @xmath13 and the following inequalities hold : for each prime @xmath1209-exceptional divisor @xmath306 of @xmath89 , @xmath1210 and , for each prime component @xmath3 of @xmath50 exceptional on @xmath237 , @xmath1211 . using the initial log discrepancy @xmath1212 defined in section [ section2-geography ]",
    ", we can combine the the two inequalities into one : @xmath1213 .",
    "an initial _ strictly lt ( slt ) _ model is a slt pair with a boundary . recall that the slt property means that the variety is @xmath34-factorial and projective over the base , the pair is lt .",
    "an initial model @xmath12 of @xmath13 is called an initial _ slt _ model of @xmath13 if @xmath12 is a slt pair and the above inequalities are strict for all divisors @xmath306 of @xmath89 and all prime components of @xmath50 exceptional on @xmath237 .",
    "existence of an initial model for some pair @xmath13 is not obvious and related to log resolutions .",
    "if a pair @xmath945 is log nonsingular and the divisor @xmath1214 is nonexceptional , then @xmath13 is initial for any boundary @xmath1215 . for any pair @xmath508 and for any of its projective@xmath416 log resolution @xmath1216 ,",
    "the pair @xmath12 is a slt initial model of @xmath13 for all @xmath6 .",
    "it is an initial model @xmath13 with a nef divisor @xmath389 .",
    "the pair is a _ log canonical ( lc ) model _ if @xmath389 is ample .",
    "an initial model @xmath12 of @xmath13 is called a _ weakly log canonical ( wlc ) model _ of @xmath13 if @xmath12 is a wlc model .",
    "it will be a _ log canonical ( lc ) model _ of @xmath13 if @xmath12 is a lc model .",
    "a lc model of @xmath13 is unique ( up to a natural isomorphism ) if it exists and will be denoted by @xmath392 where @xmath1217 .",
    "a wlc model is called a _ strictly log terminal ( slt ) _ wlc model if it is also slt . respectively , a _ strictly log terminal ( slt ) _ wlc model @xmath12 of @xmath13 is a slt wlc model which is a slt initial model of @xmath13 .",
    "it is an elementary fano log fibration ( * ? ? ?",
    "* definition  1.6 ( v ) ) .",
    "more precisely , it is an initial model @xmath13 with a contraction @xmath1218 such that : ( a ) @xmath1219 ; ( b ) @xmath13 has only @xmath34-factorial and lt singularities ; ( c ) the relative picard number @xmath1220 ; and ( d ) @xmath1221 is relatively ample@xmath765 . such a model without ( b - c ) ( respectively only without ( b ) ) is known as an ( elementary ) fano log fibration .",
    "note that the contraction @xmath1080 is a fixed structure of the mori log fibration .",
    "it is an _ slt _",
    "mori log fibration if , additionally , @xmath744 is projective .",
    "a mori log fibration is _ generic _ if it is considered over the general point of @xmath537 .",
    "an initial model @xmath12 of @xmath13 with a contraction @xmath1222 is called a _",
    "mori log fibration of _",
    "@xmath13 if @xmath12 is a mori log fibration with the contraction @xmath514 .",
    "similarly , one can define a _",
    "fano log fibration of _ @xmath13 .",
    "the model @xmath12 is an _ slt",
    "_ mori log fibration of @xmath13 if @xmath12 is a slt initial model of @xmath13 and @xmath12 is also a slt mori log fibration .",
    "thus , for each slt mori log fibration of @xmath13 , the pair @xmath12 is a slt mori log fibration , but not conversely in general even when @xmath12 is a mori log fibration of @xmath13 . similarly , for a wlc model @xmath12 of @xmath13 ,",
    "a slt wlc model @xmath12 is not the same as a slt model of @xmath13 , in general .",
    "if @xmath1223 and @xmath89 is trm then a slt mori log fibration @xmath13 is simply a _",
    "mori fibration_. respectively , if @xmath1224 and @xmath237 is trm then a slt mori log fibration @xmath1225 is a _ mori fibration _ @xmath11 or a _ mori model _ _ of _ @xmath1 .",
    "it is a wlc model or a mori log fibration ( or even a fano log fibration ) .",
    "a _ resulting model _ of a pair @xmath13 is either a wlc model or a mori log fibration ( or even a fano log fibration ) of @xmath13 . according to @xcite",
    ", any pair @xmath13 can not have both resulting models simultaneously .",
    "however , a pair can have many wlc models or mori ( fano ) log fibrations .",
    "it is expected that every pair @xmath13 with a boundary divisor @xmath65 has at least one of them , that is , a resulting model .",
    "the log minimal model program ( lmmp ) allows us to construct a resulting model .",
    "the _ lmmp _",
    "is a special case of the @xmath31-minimal model program ( @xmath31-mmp ) @xcite .",
    "an initial model for the lmmp is an initial model @xmath13 and @xmath1226 ( usually , it works with @xmath268 instead of @xmath1188 ) .",
    "we suppose also that @xmath1 is projective for reasons explained ( see characteristic @xmath75 below ) .",
    "then a @xmath31-minimal model is a projective wlc model and a nonbirational @xmath31-contraction @xmath1227 is a projective elementary fano log fibration .",
    "the program itself is a chain of birational transformations of the initial model which are supposed to exist and terminate .",
    "each transformation is a ( generalized ) log flip of a projective negative extremal contraction @xcite , but not necessarily elementary ( see below ) .",
    "intermediate models obtained after each transformation are again projective initial models .",
    "the last model under the lmmp is either a projective wlc model or a projective elementary fano log fibration of the initial model .",
    "the last model under the lmmp starting from some initial model of @xmath13 is a resulting model of @xmath13 .",
    "however , the slt lmmp is easier and more common .",
    "an initial model of the _ slt lmmp _ is a slt initial model @xmath13 , in particular , @xmath1 is projective .",
    "each transformation is either a log flip or a divisorial contraction which are supposed to be elementary .",
    "intermediate models obtained after each transformations are again slt initial .",
    "the last model under the lmmp is either a slt wlc model or a slt mori log fibration of the initial model .",
    "the last model under the lmmp starting from some slt initial model of @xmath13 is a slt resulting model of @xmath13 : either a slt wlc model or a slt mori log fibration of @xmath13 .",
    "an _ elementary _ contraction ( extraction ) or _ elementary _ small transformation ( modification ) is respectively a projective contraction ( extraction ) @xmath1228 or a small nonregular projective modification @xmath1229 such that @xmath611 are @xmath34-factorial and @xmath1230 .",
    "actually , for an elementary contraction ( extraction ) , @xmath1231 and , for an elementary small transformation , @xmath1232 .",
    "an _ extremal _ contraction or _",
    "extremal _ transformation ( modification ) is respectively a contraction ( extraction ) @xmath1228 or a transformation @xmath1229 such that @xmath1230 .",
    "actually , for an extremal contraction ( extraction ) , @xmath1231 and , for an extremal transformation , @xmath1232    thus each pair @xmath13 has a resulting model by the lmmp and a slt resulting model of @xmath13 by the slt lmmp , of course , if such a program exists for @xmath13 , including existence of an initial model ( see characteristic @xmath75 below ) .",
    "for such a construction , a _ weak _ termination is enough , that is , some sequence of birational transformations terminates , gives a resulting model .",
    "for example , the ( slt ) lmmp is established over any perfect field in dimension @xmath953 : for any algebraic surface over such a field , the lmmp exists .",
    "[ cor - qsamp = rsamp ] in any fixed dimension @xmath951 , the slt lmmp in dimension @xmath951 and the semiampleness with @xmath34-boundaries imply the semiampleness with @xmath49-boundaries .",
    "moreover , for the klt semiampleness with @xmath49-boundaries , the klt slt lmmp and the klt semiampleness with @xmath34-boundaries are sufficient .",
    "let @xmath13 be a wlc model .",
    "then by conjecture [ conj - semiample ] the @xmath49-divisor @xmath389 defines a _ lc ( iitaka ) contraction _",
    "@xmath1234 onto a normal projective variety @xmath206 , called a _ lc ( iitaka ) model _ of @xmath13 .",
    "in particular , if @xmath1235 is birational , the pair @xmath392 with @xmath1236 is the lc model of @xmath13 ( see weakly log canonical model above ) .",
    "if both the lmmp and conjecture  [ conj - semiample ] hold for a pair @xmath13 and the pair has a wlc model @xmath12 , then one can define a rational iitaka contraction @xmath1237 as a composition of the birational transformation @xmath22 and of the iitaka contraction of @xmath1238 . if @xmath282 is lc , the rational iitaka contraction is a @xmath72-contraction .    by @xcite , the image @xmath394 and the rational map @xmath1239 depend only on the pair @xmath13 .",
    "thus we can write @xmath394 instead of @xmath1240 . furthermore",
    ", it is known that the rational iitaka contraction @xmath1235 and its image @xmath394 depend only on the @xmath104-class by definition(see corollary [ cor - property - p - e ] ) . in particular , the contraction @xmath1235 is independent of @xmath65 modulo @xmath35 .",
    "the _ positive part _ of @xmath1241 is the b - cartier divisor @xmath1242 where @xmath12 is a wlc model of @xmath13 . by definition @xmath182",
    "is nef and @xmath49-mobile by the semiampleness [ conj - semiample ] .",
    "if @xmath13 does not have a wlc model , that is , @xmath1243 , put @xmath1244 .",
    "@xcite given a pair @xmath13 with @xmath6 , we define the _ relative numerical kodaira dimension _ @xmath1247 as @xmath1248 if the resulting model of @xmath13 is a mori log fibration and as the integer @xmath1249 if @xmath13 has a wlc model @xmath12 .    by definition ,",
    "the following are equivalent : ( i ) @xmath44 , ( ii ) there exists a wlc model of @xmath13 , ( iii ) @xmath445 ( see section [ section2-geography ] above ) , ( iv ) @xmath1250 ( if the semiampleness holds [ conj - semiample ] ) .",
    "if this is the case , the integer @xmath478 is independent of the choice of the wlc model @xmath237 @xcite .",
    "* definition 2.2.3 ) let @xmath65 be an @xmath49-boundary on @xmath1 and @xmath11 be a model of @xmath1 such that the log pair @xmath12 is lc . then the _ relative invariant log kodaira dimension",
    "_ @xmath1251 of the pair @xmath13 is defined as the integer : @xmath1252 where @xmath1253 denotes the relative iitaka dimension of @xmath31 . for a @xmath34-divisor @xmath31 ,",
    "this is the same as the usual definition , but for an @xmath49-divisor @xmath31 , see ( * ? ? ?",
    "* definition 2.2.3 ) .",
    "most of the results in this paper , if not all , can be established under the following assumptions : existence of log resolutions , the lmmp and the semiampleness . of course , by the subsection lmmp above we can include log resolutions into the lmmp .",
    "indeed , to construct an ( slt ) initial model of @xmath13 , one can use a log resolution ( see initial model above ) . however , usually it is not useful especially in characteristic @xmath75 , because in that case a log resolution always exists .",
    "moreover , in characteristic @xmath75 some parts of the lmmp are established or announced : the cone theorem , the contraction of an extremal ray and existence of some special flips ( e.g. , slt ) .",
    "according to the proofs , these results require projectivity of @xmath11 .",
    "the main remaining problem is termination .",
    "a _ weak _ termination , that is , some sequence of flips terminates , is sufficient for many results in birational geometry , in particular , for this paper ( cf .",
    "assumptions for our results below ) .",
    "thus we suppose the weak termination in the lmmp .",
    "note also , that in characteristic @xmath75 , the semiampleness holds for any nef divisor of relative ft varieties .",
    "the lmmp with usual termination is established only in dimension @xmath1254 @xcite and the slt lmmp with weak termination in dimension @xmath1255 @xcite .",
    "for the klt big lmmp with weak termination in all dimensions see in @xcite .",
    "the _  big \" _ means that @xmath65 is big for an initial model , or equivalently , the same holds for each initial model .",
    "since the lmmp is still not established even in characteristic @xmath75 and some of our results can be use in its proof , we prefer to put explicitly what is needed in each statement even some of assumptions is already proved . in the low dimension applications , we do not do this .",
    "so , in addition to the assumptions in characteristic @xmath75 , we need the following .",
    "note that the big conjecture [ conj - semiample ] means that of for big @xmath389 .",
    "needed assumptions are mentioned after colons and each assumption is sufficient in the dimension of varieties of the statement and the dimension @xmath1256 .",
    "proposition [ prop-0log cones coincide in u ] : the klt slt lmmp and conjecture  [ conj - semiample ] for klt pairs with @xmath34-boundaries ; the klt slt big lmmp for any convex closed polyhedral subset of klt big boundaries .",
    "corollary [ cor-0log num cones ] : the klt slt big lmmp .",
    "comment : it looks that @xmath342 is only needed for the coincidence @xmath268 and @xmath280 . for arbitrary characteristic",
    ", one can use conjecture [ conj - semiample ] .",
    "iskovskih , _ on the rationality problem for three - dimensional algebraic varieties fibered over del pezzo surfaces . _ trudy mat .",
    "inst . steklov . 208",
    "( 1995 ) , teor .",
    "chisel , algebra i algebr .",
    "geom . , 128 - 138",
    ".          y. kawamata , k. matsuda and k. matsuki , _ introduction to the minimal model program _",
    ", algebraic geometry , sendai ( t. oda , ed . ) , kinokuniya - north- holland , 1987 , adv . stud .",
    "pure math , vol 10 , pp .",
    "283 - 360 .",
    "shokurov , _ anticanonical boundedness for curves .",
    "_ appendix to nikulin v.v .",
    "hyperbolic reflection group methods and algebraic varieties in higher dimensional complex varieties ( trento , june 1994 ) ed .",
    "andreatta m. , and peternell t. berlin : new york : de gruyter , 1996 , 321 - 328 ."
  ],
  "abstract_text": [
    "<S> an introduction to geography of log models with applications to positive cones of ft varieties and to geometry of minimal models and mori fibrations . </S>"
  ]
}