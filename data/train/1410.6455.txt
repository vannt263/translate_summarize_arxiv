{
  "article_text": [
    "next - generation sequencing technologies generate huge amount of sequences in an ever increasing speed . some of these reads contain adapters and other exogenous contents by experimental designs . on other situations",
    ", adapters were sequenced inadvertently when they should not due to operational errors and other unknown reasons .",
    "if these adapters were not trimmed out , they would interfere with the downstream data analysis , such as mapping the reads to the reference genome and _ de novo _ assembly . unlike the traditional homology search tools such as blast , nearly all the current popular mapping programs for short reads from the next - generation sequencing technologies use global matching algorithms , trying to match the whole length of the read to the reference genome if the number of mismatches or edit distance ( mismatches and indels ) is smaller than a pre - defined threshold .",
    "since the adapters are not part of the biological sequences , they are treated as matching errors and the reads containing them are not mapped .",
    "if the reads containing the exogenous contents are below the error threshold and eventually mapped , they will be the cause of many potential issues for downstream analysis .",
    "for example , the exogenous contents will increase the false positive rate for the subsequent variant analysis .",
    "they will also cause problems for _ de novo _ assembly .    for most of the next - generation sequencing technologies ,",
    "the quality of the sequencing reads becomes lower towards the end of the reads .",
    "if too many sequencing errors occur in the end of the reads , it would cause problem for mapping and other downstream analysis , for the same reason as mentioned above , even if the reads contain high - quality and mappable bases in the beginning .",
    "as the length of sequences becomes longer , this issue will become more serious .",
    "some experiments using the next - generation sequencing platforms utilize barcode technology : distinct barcode sequence tag representing individual samples are ligated into the dna sequences and the pooled samples are sequenced . to assign the reads back to the original samples we need to reliably identify the barcodes within the sequence reads , in the presence of possible experimental and sequencing errors in the barcodes . in practice",
    ", barcode identification can be achieved by using algorithms similar to those used in finding the adapters .",
    "the similar problem of adapter and low - quality region trimming existed for the traditional sanger sequencing technology .",
    "most people dealt with the problem using some makeshift solutions without paying much attention to their efficiency , which worked fine for small number of sequences . with the advent of next - generation sequencing technologies , the huge volume of sequences generated asks for more efficient software to handle the problem .",
    "some existing specialized packages , such as mapping program novoalign ( http://www.novocraft.com/ ) , have some built - in adapter - removal functions .",
    "a versatile stand - alone program will be very useful for flexible downstream analysis using different software packages .",
    "for example , after exogenous contents and low quality regions removed , the processed sequences can then be used as input for different mapping or assembly programs to compare their performance . on the other hand",
    ", a range of different parameters can be tried to trim the original sequences and the optimal parameter can be chosen based on the output of downstream analysis .    here",
    "we present a fast and lightweight program for adapter and quality trimming . for adapter trimming",
    ", the program is based on modified myers s bit - vector dynamic programming algorithm  @xcite . for quality",
    "trimming , a simple moving window algorithm is used and the reads are trimmed at the point where the average quality score within the window drops below a threshold .",
    "as one of the fastest dynamic programming algorithms available with edit distance as the error model ( each mismatch , insertion , or deletion counts as one error ) , the myers s bit - vector dynamic programming algorithm finds all locations at which the query matches a substring of the target sequence of length @xmath0 with @xmath1 or fewer errors .",
    "the algorithm scales linearly with the length of the target sequence ( @xmath0 ) when the length of the query is less than the machine word size @xmath2 ( typically , @xmath3 for 32-bit machines and @xmath4 for 64-bit machines ) , regardless of @xmath1 or query length  @xcite .",
    "before the search starts , the algorithm pre - processes the query sequences . since in most cases",
    "the number of query sequences is far smaller than that of the target sequences , this pre - processing time is negligible . after the query sequences have been set up , in the subsequent search phase the algorithm scans the target sequences linearly and one - by - one , reporting any occurrences of the query with @xmath1 or fewer errors .",
    "hence our trimming program has a time complexity @xmath5 , for @xmath6 queries ( adapters or barcodes ) .",
    "the original myers s algorithm searches from the beginning of the target sequence towards the end and only reports the _ stopping _ position of query occurrences in the target sequence .",
    "for example , if the query is acgt and the target sequence is at**agt**ccgga , the position of the second `` t '' in the target sequence is reported for an occurrence with one deletion . in order to determine precisely the boundary between the insert and the adapters or barcodes , the _ starting _ position of query occurrences in the target sequence",
    "is needed ( for example , when 3-adapter is being trimmed ) . in the previous example",
    "we need to know the position of the second `` a '' . by algorithm s design no traditional trace - back",
    "could be done to find the query s starting position since no standard dynamic programming matrix is saved .",
    "furthermore a trace - back would defeat the efficiency of the algorithm . to find query s starting positions , we modified myers algorithm for the 3-adapter search .",
    "the modified algorithm carries out the search backward along the target sequence . in order to do so",
    ", the query sequences have to be set up backward also .",
    "the parameter @xmath1 , the upper limit of the number of match errors , is set equal to @xmath7 as default for 5-adapter and equal to @xmath8 for 3-adapter , but they can be changed to be based on the length of the adapters , or as user - specified . in the default mode for adapter trimming , for each pair of 5- and 3-adapters , the program searches for the locations of 5-adapter within the beginning region of the read ( default @xmath9 query length ) .",
    "if none of the 5-adapters is found , the trimming is failed for the read . if one or more of the 5-adapters are found with @xmath1 or fewer errors , the adapter with the smallest error is selected .",
    "the corresponding 3-adapter is then used as query to search the rest of the read , using the above - mentioned modified algorithm .    if the selected 3-adapter is found in the region , then the location with the smallest error is used to trim the read ; otherwise , quality scores of the read are used to trim the 3-end . to use the quality scores ,",
    "the average score within a moving window is calculated .",
    "the window moves from the 5 trimming point to the end of the read .",
    "if the average score drops below a preset threshold , then the 3 trimming point is found at the beginning of the moving window .",
    "other modes of adapter trimming are also available , such as passing the read to quality trimming if the adapters can not be found , or trimming based on the 3-adapters only .",
    "one of the advantages of myers s algorithm is that it can handle ambiguous and wildcard letters effortlessly .",
    "this makes it more suitable for adapter trimming , since usually the adapters are designed with degenerate bases incorporated in specific positions . to handle ambiguous bases , simply put them into square brackets , such as [ gc ] for either g or c in the same position . for wildcard letters ( which match any bases in the position ) , use `` . '' in the query .",
    "iupac codes can be incorporated easily . by default",
    "the query search is case insensitive ; it can be switched to case sensitive by a command line option .",
    "in addition to adapter trimming , btrim can do the trimming based on quality scores only .",
    "regardless of the trimming mode , as an option , all flanking fragments and their quality scores that have been trimmed off can be written into a separate file with detailed trimming information for each read , such as the trimming status , the adapters / barcodes found , the errors for the adapter / barcode , and the location of them in the read .",
    "this file can be parsed easily and may be useful for downstream analysis , such as barcode assignment .",
    "the details about how to use the program can be found in the document in the program s web site .",
    "figure  [ f : err ] shows the error distribution of adapter trimming for sequences from a typical illumina lane . with two sets of 5- and 3-adapter pairs ( each for one orientation of the insert ) ,",
    "30 m 75bp illumina reads are processed in 57 seconds in a machine with a 3.16ghz intel xeon processor .",
    "as the target sequences are read in sequentially , the memory footprint of the program is very small ( less than 1 m ) .",
    "btrim supports fastq format currently ( both sanger and illumina formats ) .",
    "the program is written in c programming language and available at http://graphics.med.yale.edu / trim/.     ]",
    "this work was supported by yale school of medicine ."
  ],
  "abstract_text": [
    "<S> btrim is a fast and lightweight software to trim adapters and low quality regions in reads from ultra high - throughput next - generation sequencing machines . </S>",
    "<S> it also can reliably identify barcodes and assign the reads to the original samples . </S>",
    "<S> based on a modified myers s bit - vector dynamic programming algorithm , btrim can handle indels in adapters and barcodes . </S>",
    "<S> it removes low quality regions and trims off adapters at both or either end of the reads . </S>",
    "<S> a typical trimming of 30 m reads with two sets of adapter pairs can be done in about a minute with a small memory footprint . </S>",
    "<S> btrim is a versatile stand - alone tool that can be used as the first step in virtually all next - generation sequence analysis pipelines . </S>",
    "<S> the program is available at http://graphics.med.yale.edu / trim/.    next - generation sequencing ; adapters trimming ; barcode assignment ; approximate string matching ; bit - vector algorithm </S>"
  ]
}