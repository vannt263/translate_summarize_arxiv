{
  "article_text": [
    "control of quantum phenomena lies at the heart of emerging quantum technology @xcite-@xcite .",
    "quantum control theory has many components including controllability assessment , optimal control , feedback control , etc .",
    "most existing results focus on control design of single quantum systems @xcite-@xcite .",
    "another important issue is control design for quantum ensembles .",
    "a quantum ensemble consists of a large number of ( up to @xmath1 ) single quantum systems ( e.g. , spin systems ) and every quantum system is referred to as a member of the ensemble in this paper .",
    "quantum ensembles have wide applications in emerging quantum technology including quantum computation @xcite , long - distance quantum communication @xcite , quantum memory @xcite , and magnetic resonance imaging @xcite .",
    "several results on quantum ensemble control have been presented including unitary control in homogeneous quantum ensembles for maximizing signal intensity in coherent spectroscopy @xcite and feedback stabilization of quantum ensembles @xcite .    in practical applications , the members of a quantum ensemble could have variations in the parameters that characterize the system dynamics @xcite , @xcite .",
    "for example , the spins of an ensemble in nuclear magnetic resonance ( nmr ) experiments may encounter large dispersion in the strength of the applied radio frequency field ( rf imhomogeneity ) as well as the members exhibiting variations in their natural frequencies ( larmor dispersion ) @xcite , @xcite . in this paper , these situations are referred as _ inhomogeneous _ quantum ensembles .",
    "it is generally impractical to employ different control inputs for individual members of a quantum ensemble in the laboratory .",
    "hence , it is important to develop the means for designing control fields that can simultaneously steer the ensemble of systems from an initial state to a desired target state when variations exist in the system parameters .",
    "such controls are also called compensating pulse sequences in nmr spectroscopy @xcite , @xcite .",
    "other applications include control of a randomly oriented ensemble of molecules in physical chemistry @xcite , the design of slice selective excitation and inversion pulses in magnetic resonance imaging , and the correction of systematic errors in quantum information processing @xcite .",
    "theoretical results showed that under commonly arising conditions there exist optimal laser fields to control all molecules in an inhomogeneous ensemble , regardless of their orientation or spatial location @xcite , @xcite .",
    "recent studies considered the controllability and optimal control of inhomogeneous spin ensembles @xcite , @xcite , @xcite-@xcite .",
    "an additional investigation considered the stabilization of an inhomogeneous ensemble of non - interacting spin systems using lyapunov control methodology @xcite .",
    "this paper presents a systematic methodology for control design of inhomogeneous quantum ensembles for the state - to - state transition probability , specifically for spins and three - level @xmath0 type systems .",
    "the proposed method involves the steps of ( i ) training and ( ii ) testing , and we call sampling - based learning control ( slc ) . in the training step ,",
    "we sample several members according to the distribution of inhomogeneous parameters from the ensemble and construct a generalized system using these collective samples .",
    "then we employ a gradient flow based learning and optimization algorithm @xcite to find the control providing good performance for the generalized system . in the process of testing the deduced controls",
    ", we randomly select a number of sampling members to evaluate the control performance .",
    "numerical simulations show that the slc method has potential for practical control design of various inhomogeneous quantum ensembles .",
    "these findings support the previous theoretical analysis suggesting that control on inhomogeneous ensembles should generally be feasible @xcite-@xcite .    the paper is organized as follows . section [ sec2 ] formulates the control problem for inhomogeneous quantum ensembles and presents the details of slc .",
    "the slc method is illustrated for a two - level inhomogeneous quantum ensemble in section [ sec3 ] , and for a three - level inhomogeneous quantum ensemble in section [ sec4 ] .",
    "conclusions are presented in section [ sec5 ] .",
    "consider a finite - dimensional closed quantum system where the evolution of its state @xmath2 is described by the schrdinger equation ( setting @xmath3 ) : @xmath4 , \\",
    "|\\psi(0)\\rangle=|\\psi_{0}\\rangle.\\\\ \\end{array } \\right.\\ ] ] the solution of ( [ systemmodel ] ) is given by @xmath5 , where the propagator @xmath6 satisfies @xmath7 , \\",
    "u(0)=\\textrm{id}.\\\\ \\end{array } \\right.\\ ] ]    in this paper , we consider an inhomogeneous ensemble in which the hamiltonian of each member has the following form @xmath8 where @xmath9 is the free hamiltonian and @xmath10 corresponds to the time - dependent control hamiltonian that represents the interaction of the system with the external fields @xmath11 ( real - valued and square - integrable functions ) through hermitian operators @xmath12 .",
    "the functions @xmath13 and @xmath14 characterize the inhomogeneous distribution in the free hamiltonian and control hamiltonian , respectively ( see fig .",
    "1 ) . in this paper , we assume that @xmath15 and @xmath16 , and the parameters @xmath17 and @xmath18 are time independent and uniformly distributed over @xmath19 $ ] and @xmath20 $ ] , respectively .",
    "the constants @xmath21 $ ] and @xmath22 $ ] represent the bounds of the parameter dispersion .",
    "the objective is to design the controls @xmath23 to simultaneously drive the members ( with different @xmath17 and @xmath18 ) of the quantum ensemble from an initial state @xmath24 to the same target state @xmath25 with high fidelity .",
    "the control outcome is described by a _ performance function _ @xmath26 for each control strategy @xmath27 .",
    "the control problem can then be formulated as a maximization problem as follows : @xmath28\\\\ % \\overline{\\| \\langle\\psi_{\\omega,\\theta}(t)|\\psi_{\\text{target}}\\rangle\\|^{2}}\\\\ \\text{s.t . } \\ \\ \\ & \\frac{d}{dt}|\\psi_{\\omega,\\theta}(t)\\rangle =-",
    "ih_{\\omega,\\theta}(t)|\\psi(t)\\rangle,~ t \\in [ 0 , t ] , \\\\ & |\\psi_{\\omega,\\theta}(0)\\rangle=|\\psi_{0}\\rangle \\\\ & h_{\\omega,\\theta}(t)=\\omega h_{0}+\\theta \\sum_{m=1}^{m}u_{m}(t)h_{m } , \\\\ & \\omega \\in [ 1-\\omega,1+\\omega ] , \\ \\",
    "\\in [ 1-\\theta,1+\\theta ] , % & t \\in [ 0 , t ] , \\ |\\psi_{\\omega,\\theta}(0)\\rangle=|\\psi_{0}\\rangle \\\\ \\end{split}\\ ] ] where @xmath29 is a fidelity measure of each member of the ensemble and @xmath30 $ ] denotes the average value of @xmath31 over the ensemble .",
    "the fidelity between the final state @xmath32 and the target state @xmath25 is defined as follows @xcite @xmath33 the fidelity @xmath34 is used to evaluate the performance of a designed control in the testing step . however ,",
    "for convenient calculation of a gradient flow in the training step , we take the performance function @xmath35 ; i.e. , @xmath36 note that @xmath31 depends implicitly on the control @xmath37 through the schrdinger equation .",
    "gradient - based methods @xcite , @xcite , @xcite , @xcite have been successfully applied to search for optimal solutions to a variety of quantum control problems , including the theoretical and laboratory applications . in this paper ,",
    "a gradient - based learning method is employed to optimize the controls for inhomogeneous quantum ensembles .",
    "we present a systematic methodology for ensemble control design utilizing selected samples ( as shown in fig .",
    "1 ) from the ensemble .",
    "these samples are drawn from the distribution of inhomogeneous parameters to design the control .",
    "then the resultant control is applied to additional ensemble members to test the control performance . as such",
    ", the slc method includes the steps of ( i ) training and ( ii ) testing .     and @xmath14 , and the selection of samples to construct a generalized system .",
    "an ensemble of inhomogeneous members on the left is mapped into a space determined by @xmath13 and @xmath14 on the right , where @xmath13 and @xmath14 characterize the distribution of inhomogeneity in the free hamiltonian and control hamiltonian , respectively .",
    "samples for ensemble control design are drawn from the distribution of inhomogeneous parameters .",
    "these samples are used to construct a generalized system for learning a control field with the performance as an average on the samples.,width=336 ]      in the training step , we select @xmath38 sampled members from the quantum ensemble according to the distribution ( e.g. , uniform distribution ) of the inhomogeneous parameters and then construct a generalized system as follows @xmath39 where @xmath40 with @xmath41 .",
    "the performance function for the generalized system is defined by @xmath42 the goal of the training step is to find a control @xmath43 that maximizes the performance function defined in eq . .",
    "the performance function is @xmath44 with an initial control @xmath45 .",
    "we apply the gradient flow method @xcite , @xcite , @xcite-@xcite to seek an optimal control @xmath46 .",
    "the detailed gradient flow algorithm is provided in the appendix ( _ algorithm 1 _ ) .",
    "the time interval @xmath47 $ ] is divided equally into @xmath48 time slices @xmath49 and we assume that the controls are constant within each time slice .",
    "the time index is @xmath50 , where @xmath51 and @xmath52 .",
    "the motivation behind slc is to design the control using a minimal number of sample members .",
    "therefore , it is necessary to choose a representative set of samples .",
    "for example , when the distributions of both @xmath17 and @xmath18 are uniform , we may choose some equally spaced samples in the @xmath53 space .",
    "in this case , the intervals of @xmath54 $ ] and @xmath20 $ ] are divided into @xmath55 and @xmath56 subintervals , respectively , where @xmath57 and @xmath58 are conveniently chosen positive odd integers .",
    "then the total number of samples is @xmath59 , where @xmath60 and @xmath61 are chosen from all combinations of @xmath62 as follows @xmath63      for testing , we apply the optimal control @xmath64 obtained in the training step to additional samples randomly selected from the inhomogeneous quantum ensemble and evaluate the control performance of each sample in terms of the fidelity @xmath65 between the final state achieved by each sample @xmath66 and the target state @xmath25 . if both the average value and the minimum value of the fidelity @xmath65 for all the tested samples are satisfactory , we accept the designed control law and end the control design process .",
    "otherwise , we return to the training step and generate another optimized control strategy ( e.g. , restarting the training step with a new initial control strategy or a new set of samples guided by the performance of the tested members ) .",
    "in this section , we apply slc to two - level inhomogeneous ensembles . several groups of numerical experiments",
    "are given to evaluate the performance of slc .",
    "consider a quantum ensemble consisting of two - level quantum systems ( e.g. , spins ) .",
    "the pauli matrices @xmath67 are denoted as follows : @xmath68 we let the free hamiltonian be @xmath69 and its two eigenstates are denoted as @xmath70 and @xmath71 .",
    "the control hamiltonian is @xmath72 .",
    "then we have @xmath73 . for the inhomogeneous ensemble ,",
    "the hamiltonian of each member is described as @xmath74 the state of the quantum system can be represented as @xmath75 .",
    "denote @xmath76 , where @xmath77 and @xmath78 are complex amplitudes .",
    "we have @xmath79    to construct a generalized system for the training step , we select @xmath38 members ( @xmath80 ) from the ensemble as follows : @xmath81 where @xmath82 , @xmath83 $ ] and @xmath84 $ ] have uniform distributions .",
    "the objective is to find a control @xmath85 to drive all the inhomogeneous members from an initial state @xmath86 ; i.e. , @xmath87 , to the target state @xmath88 ; i.e. , @xmath89 .",
    "we construct a generalized system for the training samples using eq .",
    "( [ generalized - system ] ) with the performance function @xmath90 in eq .",
    "( [ eq : cost ] ) .",
    "the task is to find the control @xmath91 to maximize the performance function @xmath90 . for a given small threshold @xmath92 ,",
    "if @xmath93 , we find a suitable candidate control law for the generalized system .",
    "we employ _ algorithm 1 _ to find the optimal control @xmath94 for this generalized system .",
    "this optimal control is then applied to other randomly selected members to test its performance .",
    "several groups of numerical experiments are carried out on an inhomogeneous spin ensemble to demonstrate slc .",
    "the parameter settings are as follows : @xmath95 and @xmath96 ; the target time is @xmath97 and the total time interval @xmath47 $ ] is divided equally into @xmath98 time steps , @xmath99 ; the learning rate is set as @xmath100 ; the control strategy is initialized as @xmath101 .      to construct a generalized system for the inhomogeneous ensemble with parameter dispersion on both @xmath17 and @xmath18 , we choose @xmath102 and @xmath103 such that @xmath104 samples are employed in the learning phase . using eq .",
    "( [ discrete ] ) , we have @xmath105 where @xmath106 , @xmath107 , @xmath108 and @xmath109 is the set of integers .",
    "we set @xmath110 .",
    "the learned optimal control strategy is given as in fig .",
    "2 and the testing performance in fig .",
    "3 shows that the fidelities for the state transition lie in the interval of @xmath111 $ ] with mean value of @xmath112 . for comparison ,",
    "if we use only one sample ( @xmath113 ) for training to obtain a control law , the testing performance gives fidelities that lie in @xmath114 $ ] with mean value of @xmath115 .",
    "these numerical results show that slc is effective for control design of the two - level inhomogeneous ensemble .",
    "the fidelities of the controlled state for the randomly selected members can approach very near to @xmath116 even with @xmath117 of parameter dispersion with a uniform distribution on all the parameters .     for the two - level ensemble with two controls.,width=336 ]         and @xmath18 using the learned optimal control strategy as shown in fig . 2 for the state transition problem of guiding from the initial state of @xmath118 ( i.e. , @xmath86 ) to the target state of @xmath119 ( i.e. , @xmath120).,width=336 ]    using the optimal control strategy in fig .",
    "2 , we randomly select several thousand members and present the state transition trajectories of the two - level ensemble on the bloch sphere . for a two - level system on the bloch sphere",
    ", its state can be represented using a vector @xmath121 where @xmath122 , @xmath123 , @xmath124 . as shown in fig .",
    "4 , although the trajectories of these randomly selected members considerably differ from each other due to the inhomogeneity of the ensemble , they are all successfully driven from the initial state @xmath86 ( i.e. , @xmath118 ) to the same target state @xmath120 ( i.e. , @xmath119 ) with high fidelities indicated above .     for the two - level ensemble with @xmath125.,width=336 ]    .,width=336 ]      here we consider only one control , i.e. , let @xmath127 with the evolution equation of the ensemble being @xmath128 where @xmath129 .",
    "we apply the same slc design method and parameter settings as in section iii.b.1 except that @xmath130 .",
    "the optimal control strategy is shown in fig . 5 , and fig . 6",
    "gives the testing performance of @xmath131 randomly selected testing members , whose fidelities lie in @xmath132 $ ] with mean value @xmath133 .",
    "upon comparison with the case in section iii.b.1 , the restricted control has reduced the attainable fidelity .",
    "in this section , we further demonstrate slc with a @xmath0-type three - level inhomogeneous ensemble .",
    "we conclude this section with a summary of the state transition control fidelities for all the cases in the paper .",
    "we consider a @xmath0-type atomic ensemble and demonstrate the slc design process . for a @xmath0-type atomic system @xcite , @xcite , we assume that the initial state is @xmath134 , and denote @xmath135 where @xmath136 s are complex amplitudes .",
    "we have @xmath79 we take @xmath137 and choose @xmath138 and @xmath139 in the control hamiltonian of eq .",
    "( [ controlmodel ] ) as follows @xcite : @xmath140    to construct a generalized system for the slc training step , we choose @xmath38 samples from the ensemble to form : @xmath141 where @xmath83 $ ] and @xmath84 $ ] have uniform distributions .",
    "the objective is to find a control strategy @xmath85 to drive all the inhomogeneous members from @xmath142 ( i.e. , @xmath143 ) to @xmath144 ( i.e. , @xmath145 ) .",
    "we aim to maximize the performance function @xmath90 in eq .",
    "( [ eq : cost ] ) and employ _ algorithm 1 _ to find the optimal control @xmath94 for this generalized system .",
    "then the optimal control strategy is applied to other randomly selected members to test its performance .",
    "we use the parameter settings as follows : the control strategy is initialized with @xmath146 ; @xmath147 ; the other parameter settings are the same as those of the numerical experiments for the spin ensemble in section [ sec3 ] . to construct a generalized system for the training step , we have the training samples selected as follows     for the @xmath0-type atomic ensemble.,width=336 ]    -type atomic ensemble.,width=336 ]    @xmath148    where @xmath106 . the learned optimal control strategy is given in fig . 7 and the testing results",
    "are shown in fig .",
    "8 , which shows the fidelities for all the @xmath131 testing members lie in the interval of @xmath149 $ ] with the mean value of @xmath150 . for comparison ,",
    "if we use only one sample ( @xmath113 ) for training to obtain a control law , the testing performance gives fidelities that lie in @xmath151 $ ] with mean value of @xmath152 .    as a summary of the overall numerical examples ,",
    "we show the control performance ( including some cases that have been explicitly shown above ) for the aforementioned spin and @xmath0-type atomic ensembles in fig .",
    "for the two - level inhomogeneous ensemble with parameter dispersion only in @xmath17 , the fidelities of all the 300 testing members are excellent and lie in the interval of @xmath153 $ ] . for the case with parameter dispersion only in @xmath18 , the fidelities lie in the interval of @xmath154 $ ] with the mean value 0.9994 .",
    "if only @xmath155 is allowed , the control performance is not as good as that with two controls @xmath156 and @xmath157 since we have fewer adjustable degrees of freedom .",
    "all these numerical results further demonstrate previous theoretical predictions that ensemble control should be feasible @xcite-@xcite .",
    "in this paper , we presented a systematic methodology for control design of inhomogeneous quantum ensembles .",
    "the proposed slc method includes the steps of ( i ) training and ( ii ) testing . in the training step ,",
    "the control is learned for a generalized system constructed from samples using a gradient flow based learning and optimization algorithm . in the process of testing",
    ", the control obtained in the first step is evaluated for more randomly selected members .",
    "one approach would be to first learn off - line a control field using the slc method , and then generate and apply the control field to an inhomogeneous quantum ensemble in the laboratory .",
    "to get an optimal control strategy @xmath158 ) , m=1,2,\\ldots , m\\}$ ] for the generalized system ( [ generalized - system ] ) , one technique is to follow the gradient of @xmath159 as an ascent direction .",
    "for ease of notation , we present the method for @xmath160 .",
    "we introduce a time - like variable @xmath161 to characterize different control strategies @xmath162 .",
    "then a gradient flow in the control space is defined as @xmath163 where @xmath164 denotes the gradient of @xmath165 with respect to the control @xmath37 .",
    "if @xmath166 is the solution of starting from an arbitrary initial condition @xmath167 , then the value of @xmath165 will increase along @xmath166 ; i.e. , @xmath168 .",
    "starting from a trial guess @xmath169 , we solve the following initial value problem @xmath170 in order to find a control strategy which maximizes @xmath165 .",
    "this initial value problem can then be solved numerically by using a forward euler method ( or , if necessary , a high order integration method ) over the @xmath161-domain ; i.e. , @xmath171    in practical applications , in term of a discrete update iteration index @xmath172 , equation can be rewritten as @xmath173 where @xmath174 is the updating stepsize ( learning rate ) for the @xmath175 iteration . by eq .",
    ", we also obtain that @xmath176 in addition , we have @xmath177 where @xmath178 , @xmath179 denotes the imaginary part of a complex number , and the propagator @xmath180 satisfies @xmath181 the gradient flow method can be generalized to the case with @xmath182 as shown in _",
    "algorithm 1_.    set the iteration index @xmath183    choose a set of arbitrary controls @xmath184 $ ]    compute the propagator @xmath185 with the control strategy @xmath186    @xmath187 where @xmath188    @xmath189    @xmath190    the optimal control strategy @xmath191",
    "this work was supported by the natural science foundation of china ( no.61273327 ) , by the australian research council ( dp130101658 , fl110100020 ) and by the us doe ( no . de - fg02 - 02er15344 ) , nsf ( no . che-0718610 ) and aro ( no . 0025020 ) ."
  ],
  "abstract_text": [
    "<S> compensation for parameter dispersion is a significant challenge for control of inhomogeneous quantum ensembles . in this paper , we present a systematic methodology of sampling - based learning control ( slc ) for simultaneously steering the members of inhomogeneous quantum ensembles to the same desired state . the slc method is employed for optimal control of the state - to - state transition probability for inhomogeneous quantum ensembles of spins as well as @xmath0 type atomic systems . </S>",
    "<S> the procedure involves the steps of ( i ) training and ( ii ) testing . in the training step , </S>",
    "<S> a generalized system is constructed by sampling members according to the distribution of inhomogeneous parameters drawn from the ensemble . </S>",
    "<S> a gradient flow based learning and optimization algorithm is adopted to find the control for the generalized system . in the process of testing , a number of additional ensemble members are randomly selected to evaluate the control performance . </S>",
    "<S> numerical results are presented showing the success of the slc method . </S>"
  ]
}