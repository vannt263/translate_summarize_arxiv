{
  "article_text": [
    "naive brownian dynamics ( bd ) simulations notoriously suffer on only inefficently modeling a molecule s diffusive motion near boundaries .",
    "in fact , tiny time steps are in general necessary to resolve the diffusive behavior close to boundaries with acceptable accuracy , rendering the naive application of the bd scheme highly incapable of accounting for reaction - diffusion systems over biologically relevant time scales .",
    "many particle - based stochastic simulation algorithms seek remedy by employing exact analytical solutions of the smoluchowski diffusion equation that incorporate suitable boundary conditions ( bc ) @xcite .",
    "because the analytical solutions take into account the correct boundary behavior , much larger time steps can be used without sacrifying accuracy .",
    "schematically , a particle - based algorithm describing bimolecular reactions consists of three major parts .",
    "first , it has to decide if an encounter took place during a simulation time step . secondly ,",
    "if there was an encounter , did also a reaction occur ?",
    "thirdly , if no reaction occurred , the encounter pair is propagated according to a full solution of the smoluchowski equation that takes into account the bc . in this general scheme ,",
    "the step that involves the propagation is the most time consuming one , it involves sampling from a probability density function ( pdf ) that is given by a series expansion where the individual terms are represented by complicated , numerically difficult to evaluate , integrals .",
    "this is where the proposed method comes into play : it eliminates the need to sample from a complicated series expansion , without giving up on accuracy or large size of the time step .",
    "importantly , only the gaussian pdf has to be sampled from , which results in a tremendously faster execution of the propagation move .",
    "while other algorithms using gaussian random numbers to update the particle positions have been suggested @xcite , our approach does not require rescaling of reaction rates based on macroscopic parameters @xcite and is particularly close to the underlying physics as well as , at the same time , easy to implement . because the position moves",
    "provide _ en passant _ the first - passage ( fp ) times , it facilitates the use of small - time approximations @xcite of those expressions involving green s functions ( gf ) that are employed to decide whether there was a reaction or not .",
    "this is important for 2d systems , because in this case even the radial gf are given by complicated integrals that make their numerical evaluation quite inefficient .",
    "finally , although the proposed method is designed to provide a coarse - grained description , its accuracy can easily be enhanced and the method can also be made exact in a natural way .    regarding reversible reactions , the algorithm includes possible rebindings after dissociation within the same time step .",
    "simulations show that incorporating this effect enhances the accuracy compared to those using only a poisson model .",
    "the manuscript is structured as follows .",
    "first , we give a brief overview of those elements of the smoluchowski theory @xcite needed to explain the proposed algorithm .",
    "then , to be specific , we consider a stochastic simulation algorithm that has been described before @xcite and that uses exact solutions to propagate a molecule pair .",
    "next , we show how the same can be achieved much swifter but virtually equally accurate .",
    "finally , we consider a few examples and construct , via the proposed simulation method , the pdf corresponding to a non - reactive , irreversible and reversible reacting pair in 3d and 2d , respectively .",
    "we consider an isolated pair of molecules with diffusion constants @xmath0 that diffuse around each other . alternatively",
    ", the pair may be described as a point - like particle diffusing with diffusion constant @xmath1 around a static sphere that may be reactive or non - reactive . to be explicit ,",
    "we consider the 3d case , but corresponding considerations apply equally well to a molecule pair in 1 and 2d .",
    "the pdf that gives the likelihood to find the particle located at @xmath2 , given that it initially was at @xmath3 , is the gf @xmath4 of the diffusion equation @xmath5 the gf is subject to the initial @xmath6 and bc @xmath7 where @xmath8 .",
    "the solution to eqs .",
    "( [ diffeq ] ) , ( [ initial_bc ] ) and ( [ inf_bc ] ) is given by the free - space gf @xmath9 focusing on a radially - symmetric system , the diffusion equation ( eq .  ( [ diffeq ] ) ) can be written in terms of the radial coordinate @xmath10 alone @xmath11 p(r , t\\vert r_{0 } ) .",
    "\\end{aligned}\\ ] ] chemical reactions are incorporated into this formalism by bc at the encounter distance .",
    "the bc that describe an irreversible and reversible reaction read as follows @xmath12 , \\quad \\label{revbc}\\end{aligned}\\ ] ] and are referred to as radiation @xcite and backreaction bc @xcite , respectively .",
    "the radiation bc ( eq .  ( [ radbc ] ) )",
    "describes an irreversibly , partially reactive boundary .",
    "the limiting cases of a completely reactive ( absorbing ) bc @xcite corresponds to @xmath13 , while a non - reactive pair is described by @xmath14 ( reflective boundary ) .",
    "the backreaction bc ( eq .  ( [ revbc ] ) ) takes into account dissociations also .",
    "clearly , in the limit of a vanishing dissociation constant @xmath15 , the backreaction bc reduces to the radiation bc .",
    "the survival probability @xmath16 that appears in the backreaction bc is defined by @xmath17    the radial gf corresponding to the different bc are denoted by @xmath18 , @xmath19 , @xmath20 , @xmath21 and @xmath22 and will play a prominent role in the algorithm we will discuss in the following . for later use , we provide the expressions for @xmath21 in 3d @xcite and @xmath22 in 2d @xcite @xmath23 + \\exp\\left[-\\frac{(r + r_{0 } - 2a)^{2}}{4dt}\\right ]   \\nonumber\\\\ & & -\\kappa \\sqrt{4\\pi dt}\\exp\\left(\\kappa^{2}dt + ( r+r_{0 } - 2a)\\kappa\\right)\\text{erfc}\\left ( \\kappa\\sqrt{dt } + \\frac{(r+r_{0 } - 2a)}{2\\sqrt{dt}}\\right)\\bigg ] , \\label{radialgf}\\quad\\quad\\\\ & & p_{\\text{rev}}(r , t\\vert t_{0 } ) = \\frac{1}{2\\pi}\\int^{\\infty}_{0}e^{-dtx^{2}}t(r , x)t(r_{0 } , x)x \\,dx , \\label{radialrevgf}\\end{aligned}\\ ] ] where @xmath24 and the function @xmath25 is defined as @xmath26      it is important to emphasize that sampling from any of the radial gf does _ not _ completely determine the updated 3d positions @xcite .",
    "rather , to this purpose , one has to use the full solutions describing the angle dependency also .",
    "the major drawback is that these full solutions are given by quite unwieldy integrals , which make their evaluation painfully slow .",
    "although , in many situations , the algorithm as a whole is still much more efficient than bd , because large steps can be made , the position update mechanism represents a major bottleneck .",
    "the analytical representation for the full gf describing the diffusion of a point particle around a partially absorbing sphere in 3d is known @xcite to be @xmath27 the functions @xmath28 are defined by @xmath29 - 2 ax [ j_{\\nu}(rx)y^{\\prime}_{\\nu}(ax ) - y_{\\nu}(rx)j^{\\prime}_{\\nu}(ax)]}{\\lbrace [ ( 2 \\tilde{h }   + 1)j_{\\nu}(ax ) - 2 ax j^{\\prime}_{\\nu}(ax)]^{2 } + [ ( 2 \\tilde{h } + 1)y_{\\nu}(ax ) - 2 ax y^{\\prime}_{\\nu}(ax)]^{2}\\rbrace^{1/2}}.\\ ] ] here , @xmath30 denotes the angle between the corresponding relative position vectors and one defines @xmath31 . in the following",
    ", we will describe an position update method that abandons the use of the full gf altogether . to put that update mechanism into context , we focus on a simulation algorithm described in ref .  @xcite and we briefly summarize its main features .",
    "we consider a molecule , located at @xmath32 at time @xmath33 , close to a reactive sphere of radius @xmath34 .",
    "we update the position according to free diffusion , i.e. we sample the gaussian pdf ( eq .  ( [ free - space - gf ] ) ) , which amounts to adding the following increments to the cartesian coordinates @xmath35 where @xmath36 denotes a random number sampled from a gaussian with vanishing mean and variance equal to unity .",
    "after this position update , at time @xmath37 , the molecule is located at @xmath38 . if @xmath39 , an encounter took place during the time step @xmath40 with probability one . however , as is well - known , even if @xmath41 , there may have been an encounter . to take into account those encounters as well",
    ", one may employ radial gf @xcite .",
    "more precisely , the expression @xmath42 defines the conditional probability @xmath43 that there was an encounter during @xmath40 , given the molecule was propagated according to free diffusion .",
    "thus , to test for an encounter , it is sufficient to sample a uniform random number @xmath44 and to check whether @xmath45 . on the other hand ,",
    "if there was no encounter , nothing else has to be done and the next position update can be executed .",
    "however , if an encounter was detected , the position @xmath46 has to get corrected ( as it corresponds to the free - space gf ) and one resamples the position according to the expression @xmath47 that involves the full gf ( eq .  ( [ genericgf3d ] ) with @xmath48 and @xmath49 , respectively ) . the rationale to substract the gf with absorbing bc is that @xmath50 accounts for exactly those particle trajectories that never encountered the boundary during the time step .",
    "finally , the algorithm has to decide whether an encounter also led to a reaction . to this end ,",
    "one employs the conditional reaction probability , given that the molecule was propagated according to eq .",
    "( [ propagator ] ) , defined by @xmath51 this completes a simulation step . as emphasized before , the by far most time consuming step is the propagation according to eq .",
    "( [ propagator ] ) .",
    "now we will show how the time - consuming sampling can be avoided and replaced by an iterative scheme that is quite easy to implement .",
    "we begin by recalling that @xmath52 can be numerically approximated by repeatedly sampling from @xmath53 until one obtains @xmath54 , i.e. all samplings resulting in @xmath55 are rejected and redrawn @xcite .",
    "this sampling scheme will result in a renormalized free - space probability density @xmath56 now , as @xmath57 or as @xmath58 , one has @xmath59 at first , this seems to indicate that this relation can not be exploited because , first , we would like to keep large time steps and second , in a simulation one faces in general a situation where @xmath60 and accurately propagating the system closer to the boundary requires exactly the measures ( either small time steps or use of exact full solutions ) we seek to avoid .",
    "so the central question is how we can make use of eq .",
    "( [ ref_free ] ) when @xmath61 and @xmath40 is large ?    to this end , we recall that the expressions appearing in the definition of the reaction probability ( eq .  ( [ p_reac ] ) ) and in eq .  ( [ propagator ] ) and that therefore play an essential role for propagation and detection of reactions in the algorithm , can be written as a convolution relation where the individual factors allow for a clear physical interpretation @xcite @xmath62 this decomposition relation motivates to search for an algorithm that is capable of faithfully constructing the individual processes represented by the rhs of eq .",
    "( [ fundamentalrelation ] ) , upon sampling from a free - space density functions only . in case of a reflective boundary , sampling according to",
    "the renormalized free - space density corresponds to the first two factors on the rhs .",
    "we now detail an iterative bisection method to faithfully model the fp time process described by the third factor on the rhs .",
    "a similar construction has been described in @xcite to determine the last reflection time for a 1d problem in a different context , but it works equally well in 2 and 3d for our problem at hand .",
    "we reconsider the first part of the previously described algorithm , the detection of encounter events via the conditional probability @xmath43 ( eq .  ( [ bayes1d ] ) ) .",
    "this method is not exact @xcite , an error remains due to the ignorance about the precise value of the fp time @xmath63 , i.e.  the time when @xmath64 for the first time .",
    "put differently , the detection of an encounter event via @xmath43 solely provides an upper bound , i.e.  we only know that @xmath65 .",
    "however , it turns out that one can determine the fp time and , in addition , _ en passant _ , the associated full 3d position @xmath66 with any desired accuracy , only upon using @xmath43 and sampling random numbers from the uniform and gaussian densities .    to see this",
    ", we assume that after a position move , the molecule is located at @xmath2 at time @xmath37 .",
    "if @xmath55 , there was an encounter . as we have discussed before , even if @xmath41 , an encounter may have taken place .",
    "hence , we test for encounter by employing @xmath43 as usual . if there was an encounter , but @xmath41 , we map the point @xmath46 outside the sphere to a point inside the sphere by defining @xmath67 next , we split the time interval @xmath68 $ ] into @xmath69 $ ] and @xmath70 $ ] . then , we employ the conditional pdf that describes the intermediate position @xmath71 at time @xmath72 , given that the molecule was at time @xmath33 at @xmath3 and ended up at time @xmath37 at @xmath46 .",
    "one can show that this conditional probability density is again a gaussian with first moment given by @xmath73 and variance @xmath74 as follows @xcite .",
    "consider two independent gaussian random variables @xmath75 and @xmath76 with variance @xmath77 and vanishing mean . to be definite , we consider the 3d case , but the described construction works equally well in 1 and 2d .",
    "the quantity we are interested in is the conditional pdf @xmath78 . in the context of a simulation",
    ", the variable @xmath79 describes the position update @xmath80 during a time step @xmath40 , hence @xmath75 can be interpreted to describe an intermediate position update @xmath81 during @xmath82 .",
    "the conditional pdf can be obtained via @xmath83 where @xmath84 , @xmath85 refer to the joint pdf of @xmath75 and @xmath79 and the marginal pdf of @xmath79 , respectively . using the identities @xmath86 , @xmath87 and @xmath88 , one obtains @xmath89}.\\ ] ] hence , it turns out that the conditional pdf assumes the form of a gaussian with mean @xmath90 and variance @xmath91 .",
    "this means , in the context of the simulation , that an intermediate position can be obtained by a naive bd position move ( eq .  ( [ bd_move ] ) ) , with adjusted mean and standard deviation ) .",
    "if the in this way constructed intermediate point is @xmath71 with @xmath92 , the fp time has to lie between @xmath33 and @xmath72 .",
    "but even if @xmath93 , there may have been an encounter in the interval @xmath94 $ ] .",
    "we test for this as usual by invoking @xmath95 . in case",
    "there was an encounter , we map the intermediate point inside the sphere ( eq .",
    "( [ reflection_map ] ) ) and iterate the procedure for the interval @xmath94 $ ] and for @xmath3 and @xmath71 . in case there was no encounter in that time interval , we have to conclude that the encounter occurred during @xmath96 $ ] instead , and we apply the algorithm to that time interval and , correspondingly , to @xmath71 and @xmath46 .",
    "thus , iteratively , we can determine the _ exact _ fp time and the _ exact _ full 3d position of the molecule when its distance first assumes the value of the encounter radius , only using naive bd moves .",
    "next , being located at the encounter radius , we may apply the free propagator with rejection to construct the reflective pdf , meaning that again we only have to employ sampling from a gaussian density . note that for this move we have to use the remaining time step , i.e. @xmath97 , showing that the first - passage time , that we were initially not interested in , plays now an important role .",
    "in fact , if one used @xmath40 , a significant error would result .",
    "finally , it is determined whether a reaction took place via the reaction probability ( eq .  ( [ p_reac ] ) ) .",
    "note , however , that now one may use @xmath98 ( compare also with eq .",
    "( [ fundamentalrelation ] ) ) instead of @xmath99 .",
    "after the two molecules assumed a bound state , they may dissociate again in the case of an reversible reaction .",
    "the dissociation probability within a time step @xmath40 is assumed to be given by @xmath100 however , especially when the simulation time step is relatively large , the dissociated molecule may rebind again within @xmath40 . to correct for these rapid rebindings",
    ", one may use eq .",
    "( [ p_reac ] ) to take into account the possibility for reactions .",
    "thus , the algorithm incorporates dissociations in the following way .",
    "first , a uniform random number @xmath44 is sampled and compared with the dissociation probability ( eq .  ( [ pdiss ] ) ) .",
    "if a dissociation took place , one determines the dissociation time @xmath101 by solving @xmath102 .",
    "then , the dissociated molecule is placed at @xmath103 .",
    "the molecule is propagated as described previously , where the propagation time step is @xmath104 . finally , one employs @xmath105 for the time span @xmath104 to check whether there was a rebinding .    as we will see in the next section ,",
    "skipping the test for rebindings , can lead to a large error ( fig .",
    "[ fig : prev ] , right panel ) .",
    "we employed the described simulation algorithm to construct numerically the gf for the non - reactive and irreversiblly reacting pair in 3d and the reversiblly reacting pair in 2d .",
    "more precisely , the following simulation set up was used : we considered an isolated pair reacting irreversibly @xmath106 and reversibly @xmath107 .",
    "molecule @xmath108 was held fixed at the origin .",
    "molecule @xmath109 was placed at an initial position @xmath110 .",
    "the simulation algorithm was run for a time @xmath111 , during which molecule @xmath109 underwent a diffusive motion described by the diffusion constant @xmath112 .",
    "furthermore , @xmath109 possibly associated with and dissociated from @xmath108 according to @xmath113 and @xmath114 , respectively .",
    "after each run , we recorded @xmath109 s final postion , unless it was bound to a. the corresponding histogram was normalized to account for the number of bound states at @xmath111 .",
    "we emphasize that the simulations in 2d ( and @xmath115 ) were performed with the small - time expansion of the gf @xcite .",
    "[ fig : prad ] shows the simulation results for the non - reactive and irreversible reacting pair in 3d .",
    "the full 3d gf for the non - reactive bc ( i.e.  @xmath48 ) is shown in fig .",
    "[ fig : pradfull ] . finally , fig .",
    "[ fig : prev ] shows the results for the reversible reacting pair in 2d .",
    "all simulation results are compared to the corresponding analytical representations ( eqs .",
    "( [ radialgf ] ) , ( [ genericgf3d ] ) , ( [ radialrevgf ] ) ) .",
    "we find excellent agreement .     for an isolated pair in 3d .",
    "the simulation time and the time step are @xmath116 and @xmath117 , respectively .",
    "the other parameters are @xmath118 , @xmath119 .",
    "the four curves correspond to different values of the association constant @xmath120 .",
    "the markers indicate the height of the histogram and the solid lines refer to the exact analytical representation of the irreversible 3d gf ( eq .",
    "( [ radialgf ] ) ) . ]     for an isolated , non - reactive pair in 3d .",
    "the simulation time is @xmath116 and the other parameters are @xmath118 , @xmath121 .",
    "the histogram bars represent the simulation results and the solid lines refer to the analytical representation of the full 3d gf ( eq .  ( [ genericgf3d ] ) , with @xmath14 ) . ]     for an isolated reversible reacting pair in 2d .",
    "the simulation time is @xmath116 and the other parameters are @xmath118 , @xmath122 .",
    "left panel : the four curves describe the analytical results ( eq .",
    "( [ radialrevgf ] ) ) for different values of the dissociation constant @xmath123 .",
    "the histogram markers represent the simulation results .",
    "right panel : simulation results ( @xmath124 ) obtained by using a poisson dissociation mechanism only ( eq .  ( [ pdiss ] ) ) show deviations from the analytical curve ( eq .",
    "( [ radialrevgf ] ) ) , while results obtained by additionally including possible rebinding effects show good agreement.,title=\"fig : \" ]   for an isolated reversible reacting pair in 2d .",
    "the simulation time is @xmath116 and the other parameters are @xmath118 , @xmath122 .",
    "left panel : the four curves describe the analytical results ( eq .  ( [ radialrevgf ] ) ) for different values of the dissociation constant @xmath123 .",
    "the histogram markers represent the simulation results .",
    "right panel : simulation results ( @xmath124 ) obtained by using a poisson dissociation mechanism only ( eq .  ( [ pdiss ] ) ) show deviations from the analytical curve ( eq .",
    "( [ radialrevgf ] ) ) , while results obtained by additionally including possible rebinding effects show good agreement.,title=\"fig : \" ]",
    "this research was supported by the intramural research program of the nih , national institute of allergy and infectious diseases ."
  ],
  "abstract_text": [
    "<S> we present a simulation algorithm that accurately propagates a molecule pair using large time steps without the need to invoke the full exact analytical solutions of the smoluchowski diffusion equation . </S>",
    "<S> because the proposed method only uses uniform and gaussian random numbers , it allows for position updates that are two to three orders of magnitude faster than those of a corresponding scheme based on full solutions , while mantaining the same degree of accuracy . neither simplifying nor ad hoc assumptions that are foreign to the underlying smoluchowski theory are employed , instead </S>",
    "<S> , the algorithm faithfully incorporates the individual elements of the theoretical model . </S>",
    "<S> the method is flexible and applicable in 1 , 2 and 3 dimensions , suggesting that it may find broad usage in various stochastic simulation algorithms . </S>",
    "<S> we demonstrate the algorithm for the case of a non - reactive , irreversible and reversible reacting molecule pair . </S>"
  ]
}