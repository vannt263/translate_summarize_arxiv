{
  "article_text": [
    "the detailed knowledge concerning the position of the tumour and of the vital organs during the treatment has long been one of the most crucial and demanding problems in radiation therapy .",
    "disregarding patient - localisation uncertainties , one may identify two time scales in relation to organ motion : one pertaining to daily variations ( interfraction motion ) , the other to the respiration cycle ( intrafraction motion ) .",
    "these two scales affect differently the various regions within the human anatomy .    to overcome the absence of a monitoring process , which would be practical enough for everyday application , the oncologists add a margin around the target in order to maximise the probability of destroying the entire tumour by the end of the treatment . the inevitable consequence of increasing the volume of the region which receives the largest radiation impact is the destruction of healthy tissue .    aiming at increasing the precision in radiation therapy , varian medical systems , inc .",
    "( vms ) , palo alto , ca , has recently deployed a number of new products . in autumn 2004 , the vms clinac accelerator , equipped with imaging functionality  , the ` on - board imager ' ( obi ) , came into operation ( figure [ fig : obi ] ) .",
    "as this device is capable of both tracking and targeting tumours , it represents a clinically - applicable solution for image - guided radiation therapy .",
    "the two main components of the obi system are the low - energy ( kv ) x - ray tube ( simply called ` tube ' hereupon ) and the flat - panel detector ( fpd ) ; both are attached to the body of the device via a system of robotic arms enabling 2d ( for the tube ) or 3d ( for the detector ) movement .",
    "the detector which is currently in use may be operated in fluoroscopic ( real - time moving images , to be used for position and verification ) or radiographic mode ( high - resolution images , to be used for diagnosis and planning ) .",
    "the availability of reliable large - area fpds at the commercial level has been a crucial factor in the development of the high - resolution volumetric reconstruction .",
    "the transition from traditional computed tomography ( ct ) to modern imaging modalities is well under way . in circular cone - beam ct ( cbct ) imaging ,",
    "the algorithm of feldkamp ( 1984 ) is a good starting point for further investigation ; variants of this algorithm have appeared in the literature , e.g. , see grass ( 2000 ) and tang ( 2005 ) .",
    "the problem of the reconstruction in case of a helical source - detector trajectory has been studied for a number of years , e.g. , see fuchs ( 2000 ) and the corresponding references in grass ( 2000 ) .",
    "new techniques , aiming at improving the image quality by suppressing the noise , have surfaced with the papers of pan ( 1999 ) , kachelrie ( 2001 ) , and pan and yu ( 2003 ) . finally , renewed interest in ` @xmath0 plus ' reconstructions was triggered with the works of yu and pan ( 2003 ) , and zou ( 2005 ) .    to yield reliable information ,",
    "the imaging unit must be properly calibrated ; the calibrations may be classified as general and mode - specific .",
    "the general calibrations include the geometric calibration ( yielding the values of important spatial parameters , e.g. , of the source - axis and source - detector distances , as well as the corrections due to the mechanical imperfection ) , the @xmath1 calibration ( yielding the open - geometry signal - the so - called ` air counts ' - as a function of the position on the detector ) , the norm - phantom calibration ( yielding images of a norm phantom , that is , of a cylindrical object of known density , which may subsequently be used as reference in the reconstruction of other objects ) , the calibration for the beam - hardening correction  , etc .",
    "the mode - specific calibrations relate to the different operation modes of the detector .",
    "an overview of the calibrations of the imaging unit , including some details , may be obtained from matsinos ( 2005 ) .    the present paper deals with the description of the most promising operation mode of the vms fdps , namely , the dual - gain mode .",
    "this mode has been developed in the recent years as a result of the need for enhancing the dynamic range of the detectors in order to improve image quality ; the broader the dynamic range of an imaging device , the higher is the contrast capability in the reconstructed image .",
    "the method described here is general and may be used in systems where a dual signal , relating to the same object , is produced , either via successive exposures or by sophisticated readout .",
    "the x - ray source is the vms model g242 ; it is a rotating - anode x - ray tube with maximal operation voltage of @xmath2 kv .",
    "the anode is a disc ( @xmath3 @xmath4 mm ) with a rhenium - tungsten face on molybdenum substrate with graphite backing .",
    "the tube is driven and controlled by the x - ray generator .",
    "the vms paxscan 4030cb amorphous - silicon fpd is a real - time digital x - ray imaging device comprising @xmath5 square elements ( pixels ) and spanning an approximate area of @xmath6 @xmath7 . in order to expedite the data transfer and processing , the so - called half - resolution ( @xmath8-binning )",
    "mode is used in most of the vms applications ; thus , the detector is assumed to consist of @xmath9 ( logical ) pixels ( pitch : @xmath10 @xmath11 m ) . due to the high sensitivity of the scintillating material ( thallium - doped cesium iodide ) and to the sophisticated noise - reduction techniques implemented ,",
    "the low - dose imaging performance of this type of detector is remarkable , save for a small band neighbouring its borders   mm of the detector borders ( the so - called ` inactive area of the detector ' ) are not taken into account . ] .",
    "the application of this fpd in cbct imaging has been outlined in roos ( 2004 ) .      the vms fpds may be operated in a number of modes ; a mode is identified as a set of options pertaining to binning , gain choice , etc . in the dual - gain mode , the charge stored in the semiconductor is read out by using two different capacitors ( @xmath12 and @xmath13 pf ) , leading to the so - called high- and low - gain signals , see roos ( 2004 ) . in this mode , each scan ( approximately @xmath14 images ) produces about @xmath15 gb of data which has to be transferred ( from the acquisition system ) to the workstation for additional processing ( correction , storage and reconstruction ) .",
    "the mode has been subjected to extensive and successful experimentation during the recent years and , at present , it represents the best option for high - quality radiography .",
    "the dual - gain mode is an important option because it increases the dynamic range of the detector .",
    "affecting the contrast and the signal - to - noise ratio , the dynamic range in an image is a key factor for high - quality ct images .",
    "the storage capacity of the each individual detector pixel does not impose limits to the delivered dose ; the saturation level in the readout circuits defines ( depending on the gain chosen ) these limits .",
    "the optimal acquisition settings for a given exposure are those for which the maximal low - gain signal detected is close to the saturation level of the photodiode capacity . in the low - gain mode ,",
    "the digital increment is coarse and restricts the contrast resolution in the high - attenuation areas of the irradiated object . to improve the contrast in these areas , a higher gain must be used ; this is exactly where the dual - gain mode comes in . in this mode , each row of detector pixels is read out twice : first in low , then in high gain .",
    "one image is finally created , in which the two signals are interlaced .",
    "the purpose of the calibration is to produce a set of files needed in the data processing . before delving into the description of these files",
    ", we will give one definition .",
    "henceforth , ` map ' implies an array of values ( matrix ) pertaining to the logical pixels of the detector ; for instance , in the @xmath8-binning mode , a map comprises @xmath9 elements .",
    "the description of the calibration is facilitated if one commences with two notions which are common in imaging : the dark current and the flatness correction .",
    "the dark current is also referred to as dark field .",
    "it is due to a number of physical processes which occur inside the detector irrespective of the external radiation ; these processes involve effects relating to the de - trapping current , thermal noise , on - chip electronic noise , etc",
    ". a useful overview of these effects may be obtained from young ( 1998 ) . as a result",
    ", the detector signal is not vanishing in the absence of external radiation .",
    "the dark - field correction is often referred to as offset correction of raw data .    to subtract the appropriate dark field from the data",
    ", one has to reassess its contribution frequently during the daily operation of the imaging unit ; the dark field is sensitive to temperature variation and exposure history . to ensure that the appropriate dark - field values be used in the correction of the data , vms has implemented an automatic procedure leading to the recalibration of the dark field if the imaging device is inactive for some ( user - defined ) time ; additionally , the recalibration of the dark field is forced in case of mode switching , prior to any other calibration and shortly before acquiring scan data . to suppress noise in the determination of the dark field , a number of images ( for example , @xmath16 maps ) are averaged .",
    "one important question one might pose is whether the dark field determined in the absence of radiation provides the appropriate offset correction in the case of exposures ; this is not a trivial subject .",
    "one unique feature of the present work is that corrections to the measured dark fields ( obtained in the absence of radiation ) will be derived prior to applying the offset correction to the raw data .",
    "even when the appropriate dark field is deducted from the raw data , the resulting map is not expected to be flat . assuming the absence of statistical fluctuation , there are two reasons for this deviation : the anisotropy in the radiation field and the variability in the response of the detector pixels to the incident radiation .",
    "we will now estimate the corrections which lead to a flat image at each intensity level in open - field geometry .",
    "the intensity @xmath17 may be thought of as the product of two acquisition settings , namely , of the tube current and pulse width .",
    "the intensity - signal linearity implies that the raw signal @xmath18 , extracted from the pixel @xmath19 ( @xmath20 denotes the lateral position of the pixel on the detector and @xmath21 the longitudinal ) , is given by the formula @xmath22 where @xmath23 and @xmath24 are position - dependent quantities ; the latter represents the dark field . under this assumption , the offset - corrected signal in each pixel is defined as @xmath25    we previously gave reasons why the offset - corrected signal is not expected to be constant over the detector . to achieve the signal uniformity",
    ", one has to multiply the offset - corrected contents in each pixel by a flatness - correction factor which may be defined as @xmath26 where the average of the @xmath27 signals over the entire area of the detector appears in the numerator on the right - hand side . taking ( [ eq : offsetcorrectedsignal ] ) and ( [ eq : flatnesscorrection ] ) into account",
    ", the flatness correction may be written as @xmath28 therefore , the factors @xmath29 may be calculated from the slope parameters @xmath23 .",
    "if each @xmath29 multiplies the corresponding offset - corrected signal of ( [ eq : offsetcorrectedsignal ] ) , a constant value is obtained over the entire detector .",
    "the flatness correction is also referred to as flood - field or flat - field correction .    assuming that the input signals do not saturate anywhere on the detector ( i.e. , that the intensity - signal linearity holds ) , equation ( [ eq : flatnesscorrectionreduced ] )",
    "explains why the flatness corrections extracted at one intensity lead to flat images at all intensity levels . to suppress noise in the determination of the flatness - correction maps , a number of images ( for example , @xmath16 maps ) are averaged .",
    "as two signals in each pixel are obtained in the dual - gain mode , two dark - field and two flatness - correction maps have to be introduced .",
    "the two dark - field values for the pixel @xmath19 will be denoted as @xmath30 and @xmath31 , where the superscripts have obvious meaning .",
    "similarly , the two flatness corrections will be given by the formulae @xmath32 and @xmath33    the fully - corrected high - gain signal may be obtained by the formula @xmath34 similarly , @xmath35    combining ( [ eq : offsetcorrectedsignal ] ) , ( [ eq : flatnesscorrectionreducedhg ] ) and ( [ eq : fullycorrectedsignalhg ] ) , we conclude that @xmath36 and @xmath37 as expected , flat images have been obtained in both gains . from ( [ eq : fullycorrectedsignalfinalhg ] ) and ( [ eq : fullycorrectedsignalfinallg ] ) , it is deduced that the ratio of the fully - corrected signals is constant over the whole detector .",
    "@xmath38    in the data processing , the signal @xmath39 from ( [ eq : fullycorrectedsignalhg ] ) will be used if the raw high - gain signal @xmath40 does not exceed a threshold value ; otherwise , the low - gain signal @xmath41 , scaled up by the ratio @xmath42 of ( [ eq : ratiooffullycorrectedsignals ] ) , will be used .",
    "the fully - corrected ( scaled ) low - gain signal may be expressed as @xmath43 where @xmath44 denotes the ( position - dependent ) high - to - low - gain slope ratio .",
    "this formula suggests that the final signal , corresponding to the use of the low - gain component in the data processing , may be put in the form of a product of the offset - corrected low - gain signal , high - to - low - gain slope ratio and high - gain flatness correction .      at the end of the calibration",
    ", the following maps are produced .",
    "* the high - gain dark - field map ; it is used in the offset correction of the raw high - gain data . * the low - gain dark - field map",
    "; it is used in the offset correction of the raw low - gain data . * the high - gain flatness - correction map ; according to ( [ eq : fullycorrectedsignalhg ] ) , it is used in the correction of the offset - corrected high - gain data and , according to ( [ eq : fullycorrectedsignalfinalscaledlg ] ) , it is also involved in the correction of the low - gain data .",
    "* the low - gain flatness - correction map ; it is used in the correction of the offset - corrected low - gain data . as previously explained ,",
    "the low - gain flatness - correction map is simply the product of the high - to - low - gain slope - ratio and high - gain flatness - correction maps . * the threshold map ; it contains the maximal reliable raw signal .",
    "the method to derive the threshold map will be given in detail later on .",
    "an important point in the present work is that two additional maps will be introduced to correct for small effects in the two dark fields .",
    "all in all , eight maps are needed to process the data ; the eighth calibration file is the map of defect pixels ( defect - pixel map ) .",
    "when initialising the dual - gain - calibration workspace , the user has the option of selecting an already existing defect - pixel map and append to it new defect pixels ; otherwise , a new map is created .",
    "the input data comprises a number of dark - field images and a number of raw images ; the latter are acquired at different intensity levels by varying the width of the pulse produced by the generator .",
    "there are two reasons why series of images are obtained . on one hand",
    ", this is done to suppress noise ; on the other , the range of the signal values obtained in each pixel provides an estimate of the ( signal ) uncertainty which is to be used in the optimisation phase .    at this point",
    ", we are touching upon an important issue , namely , the numbers of images to be skipped and acquired at each intensity value .",
    "this discussion surfaces because the detector signals do not only depend on the incident radiation within the time window corresponding to the particular exposure , but also on the ( short- and long - term ) exposure history of the detector .",
    "the signal which is not directly associated with the dose delivered by the current pulse will be assumed to be a product of ` lag effects ' .",
    "information on this effect may be found in hsieh ( 2000 ) and overdick ( 2001 ) .",
    "the deep - seated traps in the semiconductor seem to be responsible for this bizarre behaviour , inducing two types of effects : those which affect the dark field and those which lead to the modification of the gain of each pixel .",
    "lag effects in the calibration have to be avoided for two reasons .",
    "first , they lead to erroneous calibration files , as the averages obtained do not match the characteristics of the asymptotic behaviour .",
    "second , they artificially increase the uncertainties , which are subsequently to be used in the optimisation scheme , thus affecting the determination of the fit parameters in each pixel and complicating the statistical interpretation of the results of the linearity tests .",
    "the data analysed in the present paper were acquired at the vms laboratory in baden , switzerland , on december 15 , 2005 .",
    "a total of @xmath45 dark - field images were obtained .",
    "a total of @xmath45 exposures at each of @xmath46 pulse - width values   and @xmath47 msec pulse widths were avoided because of the larger corrections ( due to the pulse shape ) which are to be applied at the low end of the ( pulse - width ) range . ]",
    "( @xmath13 , @xmath48 , @xmath49 , @xmath50 , @xmath51 , @xmath52 , @xmath53 , @xmath54 , @xmath55 , @xmath56 , @xmath57 , @xmath58 , @xmath59 , @xmath60 and @xmath61 msec ) were obtained with the tube voltage set to @xmath62 kv and the tube current to @xmath63 ma . to reduce the lag effects ,",
    "only the last @xmath64 of these images at each intensity level were processed .",
    "the variation of the average high- and low - gain signals with the frame counter was found small , namely , below the @xmath65 level ; the variation in the original series ( @xmath45 images ) was around @xmath66 for the high gain and @xmath49 to @xmath67 ( depending on the pulse - width value ) for the low gain .",
    "therefore , the exclusion of the first @xmath2 images at each intensity value leads to a significant reduction of the lag effects .",
    "the dark - field images were processed first .",
    "each pixel was followed across the input files .",
    "pixels with constant contents were marked defect .",
    "pixels with null content in any of the images were also marked defect .",
    "only a few pixels failed these two tests . the average signal across the images and the rms of each signal distribution ( i.e. , for each pixel )",
    "were evaluated and stored .",
    "the processing of the raw images , obtained at different intensity levels , came next .",
    "the average signal across the input images and the rms of the distributions were evaluated and stored for each good pixel ( that is , not already marked as defect ) , at each intensity level separately .    a correction to the pulse - width values",
    "was implemented to account for differences between the actual widths of the produced pulses and the nominal acquisition settings .",
    "a scheme has been put forth to derive these corrections from the low - gain signals  .",
    "for each pixel of the detector , two low - gain values were assumed ` safe ' to use : the measured dark field and the signal at the highest intensity being used in the calibration ( @xmath61 msec ) .",
    "the amount by which each intermediate pulse - width value had to be corrected in order to bring the corresponding signal onto the straight line ( defined by the two extreme measurements ) was histogrammed , separately for the different pulse widths , and average values over the entire detector were obtained from these distributions . these correction factors ( see figure [ fig : correctionstopulsewidths ] for an example ) were directly applied to the high - gain signal and removed the nonlinear effects which had previously been observed .",
    "the correction described in the previous paragraph ensures that the intensity - signal linearity is fulfilled in the low gain _ on average _ ; however , the absence of position - dependent effects is not guaranteed .",
    "consequently , it does make sense to test the linearity hypothesis in each pixel even in the case of the low - gain data .",
    "the intensity - signal linearity is fulfilled in each pixel up to a threshold value .",
    "an absolute bound for this threshold corresponds to the ` hard ' limit in the analog - to - digital conversion , which at present utilises @xmath57 bits of information ; however , nonlinearity enters the problem at smaller signals , in fact , at a fixed ( that is , almost identical for all pixels ) level below each maximal ( saturated ) signal @xmath68 .",
    "this last observation leads to two suggestions : first , differences ( of signals ) to the maximal signal ( observed in the pixel chosen ) should be used in this investigation and , second , a single value of the difference to the maximal signal ( i.e. , not a map ) is adequate in describing the onset of the nonlinear effects over the entire area of the detector ; in the following , this signal difference ( to the corresponding @xmath68 ) will be denoted as @xmath69 .",
    "it is recommended that one be rather generous with the starting @xmath69 value ; in the present analysis , the first @xmath69 value was @xmath70 counts .",
    "the linearity hypothesis was then tested for those signals which do not exceed the @xmath71 level .",
    "if the test failed , the pixel was marked defect ; if it succeeded , the two parameters ( slope and intercept ) of the straight line , optimally describing the data below the @xmath71 level , were calculated via a weighted least - squares fit .",
    "the normalised residuals for the signals above the @xmath71 level were evaluated on the basis of the straight line which was obtained below the @xmath71 level . finally , the square of each normalised residual was histogrammed in bins of the difference @xmath72 between the chosen signal and the maximal signal @xmath68 . the position where the average @xmath73 contribution appeared rapidly increasing with decreasing @xmath72 identified the level at which nonlinear behaviour set in .",
    "the above procedure involves one parameter , namely , the distance @xmath69 . the consistency of the scheme may be investigated by varying @xmath69 . the average @xmath73 contributions as functions of @xmath72 are plotted in figure [ fig : averagechi2 ] for different choices of @xmath69 ; it is comforting to find out that there is good overlap in the low-@xmath72 region for all @xmath69 choices .",
    "the conclusion from this figure is that , for the detector used , the nonlinear behaviour starts becoming an issue about @xmath74 counts below the maximal signal . to safeguard against the variability of the properties of different detectors ( of the same type )",
    ", it was decided that the threshold map contain the maximal signal ( observed in each pixel ) reduced by @xmath75 counts .",
    "a few words should be said about the linearity tests .",
    "as usual , the @xmath73 function is defined by the formula @xmath76 where @xmath77 is the measured signal in one pixel , @xmath78 the fitted one and @xmath79 the signal uncertainty , the index @xmath20 identifying the dose level ; the sum extends over @xmath80 measurements .",
    "the goodness of the fit is determined on the basis of the p - value corresponding to the calculated @xmath73 value for the given degrees of freedom , that is , @xmath81 , as two parameters ( slope and intercept ) are calculated ( per gain type ) in each pixel ; the p - value of the fit represents the upper tail of the @xmath73 distribution for the given degrees of freedom .",
    "large p - values indicate good fits , small ones point to the inefficiency of the parametric model to account for the input data ; since a linear parametric model is used in the data description , small p - values indicate departure from linearity . in the present paper , statistical significance",
    "is associated with p - values below @xmath82 .",
    "we now give some details concerning the extraction of the calibration maps . in each pixel ,",
    "two weighted least - squares fits were performed ( figure [ fig : signalexample ] ) .",
    "the high - gain fits were made on all the values below threshold .",
    "the low - gain fits were made from the highest intensity which still yielded high - gain signals below threshold onwards .",
    "this method ensures that the parameters for the two gains be obtained exclusively from the regions where they will subsequently ( in the data processing ) be used .",
    "the following distributions were obtained after iterating over all pixels : high - gain dark field ( fitted values ) , low - gain dark field ( fitted values ) , high - gain slope , low - gain slope and threshold .",
    "we now come to an important point .",
    "experience showed that the outcome of the data processing using the two measured dark fields was inferior to the case involving the _ fitted values _ in the correction scheme .",
    "taken as such , this observation implies the existence of a systematic difference between the measured and fitted values of the two dark fields , corroborating a previous suspicion that the offset obtained from a direct measurement might not correct the raw data sufficiently well .",
    "there is one additional point to consider .",
    "even if the fitted values of the dark fields were stored each time that the dual - gain calibration is performed ( for instance , on a monthly basis ) , a recalibration of the dark field ( which is made several times during the daily operation of the imaging unit ) would inevitably overwrite these maps .",
    "therefore , only one set of offset files , the one obtained in the dual - gain calibration , would correspond to fitted values ; all the subsequent files would contain measured , not fitted , values .",
    "such a correction scheme , however , would be inconsistent .",
    "a solution to this problem may be obtained by storing the measured dark - field maps , as well as the ones corresponding to the difference between fitted and measured values .",
    "a recalibration of the dark field overwrites only the measured values . in the data processing ,",
    "the difference of the two dark fields ( assumed to be time invariant ) is added to the current ( measured ) dark fields to produce the maps to be used in the offset correction of the raw data .",
    "it has to be stressed that , though the difference between fitted and measured dark - field values is about two orders of magnitude smaller than these values themselves , it is nevertheless systematic and , as such , it does affect the correction scheme .    the high - gain flatness - correction map is obtained from the high - gain slopes via equation ( [ eq : flatnesscorrectionreducedhg ] ) . the high - to - low - gain slope - ratio map is obtained from the ratio of the two slopes as they are extracted from the two linear fits to the data in each pixel .",
    "as previously said , the threshold map has been obtained from the maximal raw signal in each pixel , reduced by @xmath75 counts .",
    "the defect - pixel map is the last of the calibration files .",
    "as the name indicates , this map contains the coordinates of the pixels with unreliable signal .",
    "this failure may be due to several reasons : a pixel may be dead ( constant signal ) , flickering ( occasionally dead ) or its properties may be sufficiently ` out of range ' when compared to a standard , set by the majority of the pixels ( bulk of the data ) .",
    "the tests for dead pixels take place when processing the series of images being used as input in the calibration . to obtain a set of pixels with sufficiently close properties",
    ", we have applied cuts to the distributions of the high - gain dynamic range ( threshold diminished by the dark - field value ) , low - gain dynamic range and high - to - low - gain slope ratio .",
    "the pixels which populate the tails of any of these three distributions were marked defect ; @xmath83 limits on either side of the average values were assumed .",
    "pixels with high - gain flatness correction outside the range [ 0.5,2 ] were also marked defect .",
    "although the choice of the acceptance limits ( that is , identifying what is sufficiently ` out of range ' ) is arbitrary , the changes in our results are very small when using different cuts ( @xmath84 ) .",
    "the idea in the last part of the calibration is to capture those pixels which can not be properly corrected for during a scan .",
    "this failure may be due to a number of reasons .",
    "for instance , as the calibration is performed at one gantry angle , it may be insufficient in correcting all pixels at all angles .",
    "two scans are acquired corresponding to different acquisition pulse - width settings : the first scan is tailored to the high - gain signal , the second to the low - gain one .",
    "the low - gain component is not used in the high - gain scan ; similarly , the high - gain component is not used in the low - gain scan . in either case ,",
    "raw signals of about @xmath85 to @xmath86 counts are obtained in the appropriate gain type .",
    "each pixel is followed across the images in the two scans separately .",
    "pixels with constant contents are marked defect .",
    "pixels with null content or with content below the corresponding dark - field value in any of the images are marked defect .",
    "each image is then corrected using the calibration files obtained in the previous steps . in each image ,",
    "the signal @xmath87 in every good pixel is compared to the average @xmath88 of its good neighbours .",
    "a dissimilarity index @xmath89 may be defined as @xmath90 in case that @xmath89 exceeds @xmath91 in any of the input images , the pixel is turned to defect . at the end of the analysis of the scan data ,",
    "the defect - pixel map is updated ( that is , it is enhanced with those pixels which were marked defect at this stage ) .      the average maps , corresponding to the pulse widths used in the calibration , are fully corrected on the basis of the calibration files obtained ; for artefact - free image reconstructions",
    ", it is important that any deviations from uniformity on these fully - corrected average images be entirely due to random , not systematic , noise .",
    "an overall ` noise level ' , defined as the mean of all rms - to - average - signal ratios over the entire intensity range , may serve as an indicator of the goodness of the calibration ; at present , the values lie in the vicinity of @xmath92 .",
    "the pixels contained in the tails ( @xmath83 cut ) of any of the signal distributions do not contribute to the calculation of this noise - level indicator ; they are all turned to defect . at the end of the assessment ,",
    "the defect - pixel map is updated .",
    "this operation completes the calibration of the dual - gain mode .",
    "the defect - pixel map was gradually enhanced as follows .",
    "the analysis of the dark - field images suggested the exclusion of @xmath49 pixels .",
    "the linearity tests failed in the case of @xmath54 pixels .",
    "a total of @xmath93 pixels were excluded as belonging to the tails of the distributions of the high - gain dynamic range , low - gain dynamic range and high - to - low - gain slope ratio ; the lion s share corresponds to the two former distributions and mostly represents three half - columns of detector pixels which stick out dramatically from the rest of the data .",
    "an additional @xmath94 pixels were found defect during the analysis of the data of the two scans . finally , @xmath95 pixels failed to pass the signal - distribution cut applied during the assessment of the goodness of the calibration .",
    "therefore , the resulting defect - pixel map contained @xmath96 pixels , corresponding to about @xmath97 of all pixels in the active area of the detector .",
    "when fitted to a gaussian form , the distribution of the high - gain dynamic range yielded an average of @xmath98 and an rms of @xmath99 counts .",
    "the high - gain flatness correction for all good pixels was found equal to @xmath100 and the low - gain flatness correction to @xmath101 .",
    "the high - to - low - gain slope ratio was found equal to @xmath102 .",
    "finally , a straight line was fitted to the average fully - corrected signals , obtained in each of the average maps corresponding to the different intensity levels used in the calibration .",
    "the description of the data was found to be excellent and the extrapolation to null intensity yielded an intercept of @xmath103 counts , compatible with the expectation value of @xmath104 .",
    "the slope on this plot was found equal to @xmath105 counts / mas .",
    "the dual - gain data are processed in the following manner . in each pixel ,",
    "two fully - corrected signals are created : the first corresponds to the high gain ( [ eq : fullycorrectedsignalhg ] ) , the second to the low gain ( [ eq : fullycorrectedsignalfinalscaledlg ] ) .",
    "the raw high - gain signal @xmath18 is then compared to the threshold value @xmath106 for the pixel currently processed ; only if @xmath18 is smaller than @xmath106 , is the high - gain content used .",
    "finally , one map is created corresponding to half the size of the input data .    to ensure a smooth transition between the regions where the high- and low - gain signals are exclusively used ,",
    "one may think of introducing a constant window ( @xmath107 ) below threshold where both signals ( with the appropriate weights ) are involved in the determination of the output value .",
    "the weights which the two signals are to be given in the overlapping region are subject to two conditions .",
    "first , they have to be ` continuous ' functions of the input signal : the high - gain weight must equal @xmath108 at the @xmath109 position and @xmath104 at @xmath106 .",
    "second , the sum of the two weights must equal @xmath108 at all positions .",
    "finally , the signals in the defect pixels are not processed ; their contents are obtained via interpolations using their good neighbours .",
    "an iterative approach has been developed to correct for defect - pixel clusters ( defect pixels without any good neighbour ) . at each iteration cycle , the defect pixels with the maximal number of good neighbours are identified and corrected for ; the value assigned to any such pixel is the average of its good neighbours . at the end of each iteration ,",
    "the defect - pixel map is updated ( the pixels which were interpolated at that step are restored as good ) .",
    "the process is repeated until all defect pixels have been corrected for .",
    "( naturally , such a simple scheme is not expected to correct in case of large defect - pixel clusters , but then again which one would ? ) on the technical side , the correction sequence ( defining which pixel is to be corrected at which step ) solely depends on the supplied defect - pixel map ; the algorithm proposed leads to unique corrected maps . to enable the fast processing of the data , the way in which the correction is to be performed",
    "is determined only once ( at the initialisation step , prior to the data processing ) and the correction sequence is stored in an array .",
    "to assert the improvement in the image quality when using the dual - gain signal , three reconstructions were made : the first two involved separately the low- and high - gain components of the dual - gain signal , whereas , in the last case , the two signals were combined as described in the previous section . as an example , a phantom ( catphan 500 , the phantom laboratory , salem , ny ) was scanned , using the acquisition settings : @xmath62 kv , @xmath110 ma and @xmath55 msec .",
    "the results for the reconstructed central slice of the phantom ( corresponding to its ctp401 module ) are shown in figure [ fig : catphan ] .",
    "the reconstruction resolution is @xmath111 .",
    "the standard 2d weighted filtered backprojection algorithm was used , see kak and slaney ( 1988 ) , combined with modified - blackman noise filter .",
    "the input data comprised @xmath112 images obtained within one complete rotation of the gantry .",
    "the geometric calibration , see matsinos and kaissl ( 2006 ) , was made prior to the data acquisition and yielded the values of the lateral displacement of the detector ( @xmath113 mm ) and source - detector distance ( @xmath114 mm ) ; these values were used as input in the three reconstructions . in the processing of the dual signal , a constant window of @xmath115 counts below the threshold",
    "was introduced in each pixel ; linear weights for the two gains were assumed in the overlapping window .",
    "it is evident that the reconstruction of the fully - processed dual - gain signal is of superior quality ; when only the high - gain component is used , the borders of the phantom can not be reconstructed ( due to signal saturation ) , whereas noise effects and artefacts appear ( as a result of the signal degredation in the high - attenuation areas of the irradiated object ) in the reconstruction of the low - gain signal .",
    "with image - guided radiation therapy ( igrt ) , tracking and targeting tumours will become simultaneous processes .",
    "such a development will boost efficiency , reliability and safety in radiation therapy . to this end , varian medical systems , inc .",
    "( vms ) , has produced and installed the first igrt machine , the standard vms clinac equipped with an imaging unit .",
    "cone - beam ct ( cbct ) imaging , one of the operation modes of the imaging unit , aims at high - quality volumetric reconstruction .",
    "the information on the position of the tumour and of the vital organs and tissue may be processed quickly , enabling modifications in the treatment plan on the daily basis and resulting in the delivery of higher dose in each treatment session and higher protection of the healthy tissue surrounding the tumour .",
    "the dynamic targeting , the simultaneous tracking and targeting tumours , is the next goal .",
    "a number of calibrations are needed in order to operate the imaging unit properly ; these calibrations ensure that the machine components are aligned , the mechanical distortions are small and yield important output which is to be used in the reconstruction of the scan data . to improve quality in cbct imaging , vms has developed the dual - gain mode , a successful means for enhancing the dynamic range of the flat - panel detectors ( fpd ) .",
    "the broadening of the dynamic range leads to better contrast in the reconstructed images as meaningful data is simultaneously obtained both in the high- and low - attenuation areas of the irradiated object .",
    "the appropriate calibration of the mode has been achieved via an elaborate pixel - to - pixel analysis and has been shown to lead to improved artefact - free images .    the response of each pixel of the fpd to the variation of the incident radiation is thoroughly investigated on the basis of a series of images obtained at several intensity levels . at the onset of the calibration , a correction to the pulse widths is derived and applied systematically in the rest of the analysis . a threshold value in each pixel is identified as corresponding to the maximal raw signal which fulfills the intensity - signal linearity , a basic point in the data processing .",
    "the response parameters in the high- and low - gain - signal series are extracted from the input data and are used to produce the flatness corrections and the high - to - low - gain slope - ratio map .",
    "finally , the defect - pixel map is obtained , containing dead and flickering pixels , as well as those pixels having properties which are sufficiently ` out of range ' .",
    "one of the important corrections made in the present scheme relates to the dark field .",
    "it so happens that the dark fields obtained in the absence of incident radiation can not correct the raw data sufficiently well ; the fitted values , that is , the ones obtained via an extrapolation from nonzero intensities , seem to do a better job .",
    "a scheme has been proposed to ensure that the fitted values of the dark field , instead of the measured ones , be involved in the offset correction of raw data .",
    "the only assumption made at this point is that the ( generally small ) fitted - minus - measured dark - field difference in each pixel is time invariant , this being a reasonable claim regarding the temperature stability in the laboratory and the concepts involved in the electronics of the detector .",
    "the data - processing scheme uses the maps obtained during the calibration . concerning the combination of the high- and low - gain images , the high - gain signal is used whenever meaningful ( not saturated ) ;",
    "otherwise , it is substituted by the low - gain signal , properly scaled with the high - to - low - gain slope ratio . a constant window below the threshold value in each pixel",
    "may be introduced to ensure the smooth transition from the area where the high - gain signals are used to the one where they are replaced by the low - gain signals . in this overlapping window , both signals , with different weights , are invoked in the determination of the output values .",
    "defect pixels are interpolated on the basis of the contents of their good neighbours .",
    "a simple method achieving the correction in case of small defect - pixel clusters has been implemented .",
    "the dual - gain mode was developed in a time span of several years .",
    "its potentiality in improving the quality in ct imaging was originally conceived by our colleagues : r e colbeth , i mollov , j pavkovich , p g roos , e j seppi , e g shapiro and g zentai . during the development phase ,",
    "important contributions were made by many ; we apologise if some names which should have been included do not appear here . during the recent past",
    ", important contributions in this research were made by s bhler , p munro , j richters , h riem , r suri , c a tognina and g f virshup .",
    "the data presented in this paper were acquired by h riem .",
    "tang x , hsieh j , hagiwara a , nilsen r a , thibault j - b and drapkin e 2005 a three - dimensional weighted cone beam filtered backprojection ( cb - fbp ) algorithm for image reconstruction in volumetric ct under a circular source trajectory _ phys",
    "* 50 * 3889 - 905                high- and low - gain fits for one pixel chosen at random .",
    "the threshold value for this pixel corresponds to @xmath116 counts ( horizontal line ) .",
    "the parameters for the high gain are obtained from the signals below threshold ( open circles ) ; above threshold , the high - gain points ( filled circles ) are not used .",
    "the parameters for the low gain are obtained from the signals corresponding to the area where the high - gain signal saturates ( open squares ) ; the low - gain values are not used in the area where the high - gain signals are below threshold ( filled squares ) .",
    "saturation in this pixel occurs around @xmath117 mas.,height=585 ]    the reconstructed central slice of a phantom using the calibration and data - processing scheme described in the present paper ( right ) ; also shown are the results involving only the low- ( left ) and the high - gain ( middle ) components of the dual - gain signal . in the case of the low - gain signal ,",
    "the central area of the reconstructed image has been magnified to demonstrate the signal degradation.,width=585 ]"
  ],
  "abstract_text": [
    "<S> varian medical systems has manufactured and recently put into operation a clinically - applicable solution for image - guided radiation therapy . cone - beam ct imaging , </S>",
    "<S> one of the operation modes of the imaging unit of this device , aims at high - quality volumetric reconstruction . to boost the image quality , the dual - gain mode , a successful means for enhancing the dynamic range of the flat - panel detectors and obtaining better results in the contrast of the reconstructed image , </S>",
    "<S> was developed and successfully tested during the last few years . </S>",
    "<S> the important steps in the calibration of this mode involve a correction to the pulse widths associated with the x - ray production , the assessment of the detector signal above which nonlinear effects become significant and the determination of some properties of the detector pixels , namely , of dark fields , flatness corrections , etc . </S>",
    "<S> finally , the defect - pixel map is obtained , containing dead and flickering pixels , as well as pixels with properties which are sufficiently ` out of range ' . </S>",
    "<S> an effect observed in the offset correction of raw images seems to originate in the mismatch between the measured and extrapolated values of the dark field ; a correction scheme is proposed to take account of this effect . in the data processing , which is achieved on the basis of the files produced in the calibration of the mode , </S>",
    "<S> the high - gain signal is used whenever meaningful ; otherwise , it is substituted by the low - gain signal , properly scaled . </S>",
    "<S> defect pixels are interpolated from their good neighbours ; a procedure achieving a correction in case of small defect - pixel clusters is outlined .    </S>",
    "<S> _ keywords _ : cone - beam ct , flat - panel detector , dual gain , image quality + </S>"
  ]
}