{
  "article_text": [
    "the goal of this investigation is to develop and validate a computational method for optimization of the shape of cooling elements in general steady heat transfer problems .",
    "the motivation for this work comes from problems encountered in the design of battery systems for hybrid - electric ( hev ) and electric vehicles ( ev ) @xcite in which a central role is played by methods of the thermal battery management ( tmb ) ensuring that the battery operates in a suitable thermal environment @xcite . a typical battery system used in automotive applications",
    "is shown in figure [ fig : battery_pack]a , whereas in figure [ fig : battery_pack]b we present a possible design of the channels with the coolant fluid acting as the heat - exchange elements . in these applications",
    "a key issue is optimization of the shape of the cooling elements , so that the temperature distribution is as close as possible to prescribed profiles in some selected regions of the battery system . assuming a known distribution of the heat sources representing the heat generation in the battery , mathematical models of such problems lead to systems of elliptic boundary - value problems defined on irregular domains and subject to some rather complicated boundary conditions .",
    "optimization of geometry of the cooling elements thus leads to shape - optimization problems for such systems of equations , and in this study we propose an approach based on the continuous ( i.e. , infinite - dimensional , or `` optimize - then - differentiate '' , @xcite ) formulation and the methods of the shape - differential calculus .",
    "the main novel contribution is the development and validation of an accurate and efficient technique based on the boundary - integral formulation for the evaluation of the shape gradients which is a key enabler of the proposed optimization strategy .    in the literature devoted to heat transfer and the related field of fluid mechanics most of the works concerning shape optimization , or equivalently shape identification , concern problems formulated in the `` discretize - then - differentiate '' setting , where a finite - dimensional optimization problem is set up based on a discrete version of the governing equations , somewhat limiting the flexibility in dealing with different geometries .",
    "such approaches were pursued , for example , in @xcite , and we also mention the monograph @xcite .",
    "approaches based on continuous adjoint formulations usually rely on the shape - differential calculus to determine the shape sensitivities .",
    "the shape calculus , reviewed in the monographs @xcite , is a general suite of techniques derived from differential geometry which allow one to differentiate solutions of partial differential equations ( pdes ) and functionals defined on these solutions with respect to variations of the domains on which these pdes are defined .",
    "applications of various continuous shape - optimization approaches to problems involving heat transfer , fluid flow and phase transformations were investigated in @xcite .",
    "we add that , as regards the numerical representation of free boundaries in pde problems , there are two main computational approaches , namely , the `` interface capturing '' methods based on the use of suitable implicit functions , such as the level set formulation @xcite , and the `` interface tracking '' methods which rely on explicit representations of the boundary . since the model problem considered here",
    "is described by elliptic pdes , we survey below the state - of - the - art numerical techniques used for the solution of optimization problems for such system based on the continuous formulation .      in both paradigms ,",
    "i.e. , in the approaches relying on the level sets to capture the interface and in the methods based on explicit interface tracking , optimization problems are typically solved using discrete ( with respect to some pseudo - time ) forms of gradient flows in which suitably defined shape gradients are used as the descent directions . starting with the seminal work @xcite , most attention has recently been focused on level - set - based techniques in which the level - set function is evolved using the hamilton - jacobi equation with the velocity field given as an extension of the shape gradient away from the interface .",
    "their advantage is that they do not require interface - fitted domain discretizations and perform well on simple cartesian grids .",
    "the governing and adjoint problems can be solved using the immersed interface method @xcite , as was done for example in @xcite , or with a penalization technique @xcite .",
    "regularization aspects of such approaches were investigated in @xcite , whereas the study @xcite explored formulations resulting from different definitions of the inner products for the shape variations .",
    "limitations of such methods arise when the boundary conditions and/or the shape gradients defined on the interface have a more complicated form ( e.g. , include derivatives ) , as then they tend to be difficult to evaluate accurately on cartesian grids .",
    "on the other hand , shape optimization techniques based on explicit interface tracking typically require interface - fitted discretization of the domains on which the governing and adjoint systems are solved .",
    "this discretization then needs to be updated during iterations which can be a complicated process .",
    "such approaches were reviewed in @xcite , whereas some applications to image processing are discussed in @xcite    the approach proposed here is based on explicit interface tracking combined with suitably chosen sobolev gradients . while both the shape - differentiation and sobolev gradients are well - known techniques , the main novelty of the proposed approach is a method for the evaluation of shape gradients which is based on a boundary - integral formulation coupled with an elliptic solver constructed using a cartesian grid . in comparison to the approaches described above",
    ", it offers the following advantages    * it is characterized by a high ( in principle spectral ) accuracy in approximating complex interface boundary conditions and expressions for the shape gradients , so that only modest resolution is required to discretize the contour , * as boundary - fitted grids need not be constructed , it can deal with fairly complicated contour shapes at a low computational cost .",
    "the proposed implementation takes advantage of the analytic structure of the governing equations .",
    "while boundary - integral techniques have been used for shape optimization of elliptic pdes , this was typically done in the discrete setting ( i.e. , `` discretize - then - differentiate '' ) with or without the adjoint equations used to evaluate the shape sensitivities as in @xcite . in @xcite",
    "the optimized shape was described in terms of a graph of a function , so that determination of the gradients did not require methods of the shape - differential calculus . a boundary - integral formulation for a time - dependent ( parabolic ) shape optimization problem was devised in @xcite .",
    "we add that all of these approaches relied on the standard techniques of the boundary - element method ( bem ) to evaluate the resulting integral expressions .",
    "finally , we also mention @xcite and some references cited therein where the shape sensitivities were expressed in terms of hypersingular integral equations ( obtained via shape - differentiation of the standard boundary - integral formulations ) .",
    "we will comment on this interesting alternative approach at the end of the paper .",
    "the structure of the paper is as follows : in the next section we introduce the mathematical model of the system and state the optimization problem , in the following section we briefly describe a gradient - based descent algorithm based on shape - differentiation and smoothed ( sobolev ) gradients ; the proposed computational method for the solution of the governing and adjoint system and evaluation of the sensitivities is presented in detail in section [ sec : implement ] , whereas validation tests and results demonstrating application of the method to some selected shape optimization problems are presented in section [ sec : results ] ; discussion and conclusions are deferred to section [ sec : final ] .",
    "we will consider a simplified model of the problem based on the following set of assumptions    1 .",
    "heat transfer is independent of time and occurs via conduction only with @xmath0 representing the constant thermal conductivity , 2 .",
    "the battery pack is treated as a 2d square region @xmath1 with isolated boundary @xmath2 ( i.e. , the heat flux vanishes on @xmath3 ) , 3 .",
    "the distribution of the heat sources in the battery is given by the function @xmath4 which we will assume to be square - integrable , i.e. , @xmath5 ; the corresponding temperature distribution will be denoted by @xmath6 , 4 .",
    "the cooling element is represented by a @xmath7 curve @xmath8 of total length @xmath9 and characterized by the reference temperature @xmath10 ; the density @xmath11 of the heat flux absorbed by the cooling element at a point @xmath12 is modelled using newton s law of cooling as @xmath13 , where @xmath14 is a constant heat transfer coefficient and the temperature field @xmath15 is continuous across the contour @xmath8 , [ ass_newton ] 5 .",
    "given an arbitrary subdomain @xmath16 , the target temperature distribution is given by @xmath17 .",
    "we restrict our attention to contours which are lipschitz - continuous and will assume that they are parameterized in terms of the arc - length coordinate @xmath18 $ ] .",
    "two versions of the problem will be considered : @xmath19 corresponding , respectively , to a closed contour @xmath8 with a constant reference temperature and to an open contour @xmath8 with the reference temperature @xmath20 varying with the arc length .",
    "all validation tests and a number of optimizations will be performed for the simper problem p1 .",
    "in addition , some optimization problems will be solved for the more realistic configuration p2 in which @xmath21 will be taken to be the distribution of the heat sources in an actual battery ( figure [ fig : battery_pack]b ) . to fix attention , in problem p2 we will assume that @xmath10 increases linearly with the length corresponding to the coolant liquid heating up as it absorbs heat , i.e. , @xmath22 , \\label{eq : u0}\\ ] ] where @xmath23 and @xmath24 are the prescribed temperatures at the inlet and outlet .",
    "sketches of the domain @xmath25 with its different attributes are shown for both cases in figure [ fig : domain ] . in problem p2 with an open contour @xmath8 the endpoints",
    "are assumed to attach to the domain boundary at the right angles .",
    "we will denote @xmath26 the part of the domain @xmath25 inside , or above , contour @xmath8 , and @xmath27 its complement , cf .",
    "figure [ fig : domain ] ( `` @xmath28 '' means `` equal to by definition '' ) . denoting @xmath29 and @xmath30 the restrictions of the temperature field to the subdomains on the two sides of contour @xmath8 , we have the following mathematical model of the problem    [ eq : intr_d ] @xmath31    where @xmath32 is the unit vector normal to the contour @xmath8 , or the boundary @xmath3 , and oriented as shown in figure [ fig : domain ] .",
    "the corresponding unit tangent vector will be denoted @xmath33 .",
    "we add that boundary conditions and represent newton s law of cooling mentioned in assumption 1.(4 ) .",
    "typically used to model the heat transfer in the presence of convection , this law stipulates that the heat flux @xmath34 absorbed into the cooling element @xmath8 at a given point @xmath35 is proportional to the difference between the local temperature @xmath36 and the reference temperature @xmath10 .",
    "we remark that @xmath10 may be therefore thought of as the temperature of some hypothetical coolant liquid circulating in the cooling element , although details of this process are neglected in the present model ( the contour @xmath8 has in fact zero thickness ) .",
    "clearly , the solution @xmath15 will depend on the shape of the contour , i.e. , @xmath37 .",
    "we also remark that , while the differential equations and boundary conditions in system are linear in the dependent variables @xmath38 and @xmath39 , problem is in fact _ geometrically _ nonlinear with respect to the shape of the contour @xmath8 . for a discussion of the existence and regularity of solutions to elliptic boundary - value problems in complicated domains",
    "we refer the reader to monograph @xcite .",
    "the optimization problem , motivated by the industrial applications discussed in introduction , is to find an optimal contour @xmath40 such that the corresponding solution @xmath41 of system evaluated over @xmath42 is as close as possible to the prescribed target distribution @xmath43 .",
    "defining the reduced least - squares cost functional as @xmath44 we obtain the following optimization problem @xmath45 since in actual applications the length of the contour representing the cooling element may not be arbitrary , we will also consider a second optimization problem with the additional constraint on the contour length , namely , @xmath46 where @xmath47 is the prescribed length of the contour @xmath48 .",
    "clearly , problems and represent pde - constrained shape optimization problems .",
    "pde optimization problems involving shapes of the domains as the control variables require special treatment @xcite , and our computational approach will be based on methods of the shape - differential calculus recalled in the next section . finally , we add that , in principle , in the statement of optimization problems and we should also include the condition @xmath49 which is equivalent to a suitable set of inequality constraints .",
    "however , in the interest of simplifying the formulation , this condition is omitted here , although as discussed in section [ sec : grad ] below , it will be incorporated in the final computational algorithm .",
    "in this section we review the formulation of the optimality conditions for problems and and a gradient - based descent approach for the computational solution of these problems .",
    "since these elements of our approach are rather standard , their presentation will be brief .",
    "we consider the first - order optimality conditions which require the vanishing of a suitably - defined gteaux ( directional ) differential evaluated at the optimal contour @xmath48 .",
    "we remark that defining such differential and the related expression for the gradient requires differentiation of governing system with respect to the shape of the domains @xmath26 and @xmath50 on which the pdes are defined .",
    "this is properly done based on the methods of the _ shape - differential _",
    "calculus @xcite which rely on a special parametrization of the domain geometry and provide formulas for shape - differentiation of general functionals , pdes and the associated boundary conditions .",
    "below we briefly present this construction and recall the main results we will need , referring the reader to monographs @xcite for further details . as a first step , we define the `` velocity '' field @xmath51 which will parametrize the deformations of the contour @xmath8 and of the domains @xmath26 and @xmath50 , so that for every point @xmath52 we have @xmath53 where @xmath54 is a parameter and @xmath55 is the position of a point on the deformed contour @xmath56 .",
    "relations analogous to can also be written for points in the deformed domains @xmath57 and @xmath58 . given a sufficiently regular function @xmath59 and the functionals @xmath60 and @xmath61 defined on the perturbed domain and contour ,",
    "the corresponding shape differentials are defined as @xmath62 $ ] and @xmath63 $ ] .",
    "one of the central results of the shape - differential calculus is summarized in the following    the shape differentials of @xmath64 and @xmath65 with respect to parametrization are given by expressions    [ eq : s ] @xmath66    where @xmath67 is the shape derivative of the integrand function @xmath68 defined for @xmath69 as @xmath70 $ ] and @xmath71 denotes the signed curvature of the contour @xmath8 .",
    "[ thm : lshape ]    a detailed proof of lemma [ thm : lshape ] can be found , for example , in @xcite .",
    "we remark that , in general , when differentiating with respect to the shape of _ open _ contours , expressions and will have additional terms proportional to @xmath72 and localized via dirac delta distributions at the contour endpoints @xcite .",
    "however , in our problem p2 , owing to and the assumption that contour @xmath8 meets the domain boundary @xmath2 at the right angle ( cf .",
    "figure [ fig : domain]b ) , these terms vanish identically .",
    "therefore , for both the closed and open contours only the normal component @xmath73 of the perturbation velocity field on the contour @xmath8 plays a role in expressions for shape differentials .",
    "the normal perturbations @xmath74 , considered as functions of the arc - length coordinate , must satisfy certain regularity conditions .",
    "it is sufficient for the perturbation @xmath75 to belong to the sobolev space @xmath76 of periodic functions with square - integrable derivatives on @xmath77 $ ] ( precise definition of the corresponding inner product will be given in below ) .",
    "we add that contour parametrization allows us to recast line integrals , such as appearing in , and below , as definite integrals .",
    "the optimality condition for problem is given by @xmath78 where we note that the subdomain @xmath42 is fixed and does not depend on the perturbation @xmath75 , and @xmath79 is the shape derivative of the solution of governing problem evaluated for the optimal contour shape @xmath48 .",
    "the sensitivity ( perturbation ) equation satisfied by @xmath80 is obtained by considering a suitable weak form of system and shape - differentiating the resulting integrals using formulas , see @xcite ,    [ eq : ptb ] @xmath81\\zeta { -\\gamma\\ , u'_0 } \\quad&&\\text{on } \\",
    "\\c , \\label{eq : ptb4 } \\\\",
    "k\\dpartial{u'}{n}&=0\\quad & & \\text{on } \\ \\partial\\omega , \\label{eq : ptb5 }    \\end{aligned}\\ ] ]    where @xmath82 and @xmath83 , and @xmath84 is the shape - derivative of @xmath85\\kappa\\zeta\\ , ds ' \\label{eq : du0}\\ ] ] in which @xmath86 is the heaviside function and whose structure is a consequence of the dependence of the arc length @xmath87 on the contour shape . as a matter of course , in problem",
    "p1 , @xmath88 , cf  .",
    "as regards the second optimization problem , we will incorporate the additional constraint on the length of the contour @xmath8 by defining an augmented cost functional @xmath89 where @xmath90 is a numerical parameter . the optimality condition for this second optimization problem",
    "is thus @xmath91 where we used relationship to differentiate the second term in .",
    "we note that , although it arises from rather different mathematical principles , the more systematic formulation of the constrained problem using lagrange multipliers would result in an optimality condition quite similar to .",
    "more precisely , the only difference is that the factor @xmath92 in would be replaced by the lagrange multiplier @xmath93 . as a result , the modification of the descent direction would have the same form ( but with a different magnitude ) in the two cases . on the other hand , given the geometric nonlinearity of the constraint @xmath94 , the lagrange multiplier @xmath93 can be rather hard to compute accurately , so for simplicity in this study we chose formulation . we emphasize that optimality conditions and only characterize _ local _ , rather than global , minimizers and due to the non - convexity of cost functional , resulting from the geometric nonlinearity of system , existence of multiple local minima can be expected .",
    "the ( locally ) optimal shape @xmath48 can be found computationally as @xmath95 using the following gradient - descent algorithm @xmath96 where the points @xmath97 represent the contour @xmath98 used as the `` initial guess '' and @xmath99 is the length of the step along the descent direction at the @xmath100-th iteration computed by solving a line - minimization problem @xmath101 there are many different approaches to solving problems of this type and in our study we use brent s iterative method combining the golden section search with inverse parabolic interpolation in the neighbourhood of the minimum .",
    "this approach does not require any derivatives with respect to @xmath102 and an efficient implementation is discussed in @xcite .",
    "if @xmath99 found by solving problem results in the deformed contour @xmath103 intersecting the domain boundary @xmath2 , the value of @xmath99 is suitably reduced to ensure the condition @xmath104 is always satisfied .",
    "we add that , while for the sake of brevity of notation formula represents the steepest descent approach , more advanced optimization methods such as the polak - ribire version of the nonlinear conjugate gradients method @xcite were used to obtain the results presented in section [ sec : optim ] .",
    "at least for the problems we investigated , these approaches were found to systematically outperform the steepest descent method . clearly , a critical element of minimization algorithm is evaluation at every iteration of the cost functional gradient @xmath105 .",
    "the riesz representation theorem @xcite guarantees that it can be extracted from the gteaux shape differential according to the formula @xmath106 where @xmath107 denotes an inner product in the sobolev space @xmath76 in which @xmath108 is a parameter ( which will be shown below to have the meaning of a length scale ) .",
    "we observe that expressions for the gteaux differentials @xmath109 and @xmath110 appearing in and are not yet in the form consistent with , because the perturbation @xmath75 rather than appear as a factor is hidden in boundary conditions  of the sensitivity system defining @xmath80 . in order to transform the differential @xmath109 to riesz form",
    "we will employ the _ adjoint variable _",
    "@xmath111 which is the solution of the following _ adjoint system _    [ eq : adj ] @xmath112    where @xmath113 and @xmath114 , whereas @xmath115 is the characteristic function of the region @xmath116 , @xmath117 . following the standard procedure , see e.g.  @xcite , we obtain @xmath118 where @xmath119u^*(s')\\ , ds'}\\qquad \\text{on }",
    "\\nonumber\\end{aligned}\\ ] ] the last term in stems from the arc length dependence of the reference temperature @xmath10 in problem p2 , cf .  , and vanishes identically in problem p1 .",
    "derivation details are presented in @xcite ; in @xcite we also discuss a symbolic algebra algorithm for automated determination of the adjoint boundary conditions in pde optimization problems characterized by complicated interface conditions such as the problem considered here .",
    "while this is not the gradient we use in the actual computations , for simplicity in  the gradient @xmath120 was obtained as the riesz representer in the space @xmath121 of square - integrable functions .",
    "we also add that the part of gteaux differential associated with the length constraint is already in the riesz form , so that the @xmath122 gradient of cost functional @xmath123 is @xmath124 the gradients actually used in minimization algorithm , namely the sobolev gradients @xmath125 and @xmath126 , can be obtained from and identifying  with , and noting the arbitrariness of the shape perturbations @xmath127 .",
    "then , after integrating by parts and using the boundary conditions , we arrive at @xmath128 thus , the sobolev gradient @xmath129 is obtained by first computing the gradient @xmath120 from or , and then by solving elliptic boundary - value problem defined on the contour @xmath8 , a step which is known to be equivalent to low - pass filtering ( smoothing ) the @xmath122 gradient with @xmath130 acting as the cut - off length scale @xcite . in problem",
    "p2 the homogeneous neumann boundary conditions ensure that the sobolev gradient @xmath129 does not change the angle at which the contour @xmath8 meets the domain boundary @xmath2 ( which therefore always remains @xmath131 ) .",
    "for some other applications of sobolev gradients to solution of minimization problems involving pdes we refer the reader to monograph @xcite , articles @xcite and to articles @xcite for studies concerned specifically with shape optimization .",
    "the different elements discussed in the present section combine into algorithm [ alg1 ] .",
    "@xmath132 @xmath133 initial guess @xmath98 solve direct problem solve adjoint problem evaluate  and solve to determine @xmath134 compute the polak - ribire conjugate direction @xmath135 $ ] perform line minimization @xmath136 \\}$ ] to find the step size @xmath99 , ensuring that @xmath137\\right ) \\notin \\partial \\omega$ ] obtain @xmath103 by deforming @xmath138 along the conjugate direction @xmath139 $ ] with the step size @xmath99 , @xmath140 @xmath141 or @xmath142    an elegant and accurate numerical solution technique for the direct and adjoint systems and is described in the next section .",
    "in this section we present in detail a novel numerical approach we devised to solve the governing and adjoint systems and at every iteration of algorithm [ alg1 ] .",
    "since these systems have in fact essentially identical structure , we will focus our discussion on the solution of the first one .",
    "the methods to tackle problems p1 and p2 are based on the same concept , but differ in regard to some technical details , and to fix attention , below we describe the approach applicable to problem p1 .",
    "modifications required to solve problem p2 are summarized further below with all details available in @xcite .",
    "we observe that both systems and can be regarded as combinations of two poisson problems ( defined in @xmath26 and in @xmath50 ) which are coupled via some complicated ( mixed ) boundary conditions on the contour @xmath8 separating the two domains .",
    "it should be emphasized that this contour can have an arbitrary , though non - intersecting , shape .",
    "given the linearity ( with respect to @xmath38 and @xmath39 ) of equations  , we split problem into two subproblems : a potential problem associated with the complex interface boundary condition and another elliptic problem arising from the presence of the source term @xmath21 , which are then coupled using a suitable interpolation scheme .",
    "since the solution methods for these subproblems are adapted to their analytic structure , we achieve for each of them the highest possible ( spectral ) numerical accuracy .",
    "while similar techniques have already been used for the solution of certain direct problems @xcite , to the best of our knowledge , this direction has not been explored in applications to optimization or inverse problems .    as a starting point , we consider the following ansatz for the solution @xmath15 of problem @xmath143 where the fields @xmath144 and @xmath145 satisfy the following system of pdes and boundary conditions equivalent to    [ eq : num_d ]",
    "@xmath146    we note that the fields @xmath144 and @xmath145 are coupled only through boundary conditions and .",
    "since the field @xmath145 is harmonic in @xmath147 , it admits a representation in terms of the single - layer potential density @xmath148 @xmath149 taking the limit @xmath150 in , using boundary conditions and , and taking into account the limiting properties of integrals of type known from the potential theory @xcite , we arrive at a singular boundary integral equation of fredholm type ii satisfied by the density @xmath151 .",
    "thus , system can be equivalently rewritten as    [ eq : upmu ] @xmath152    the new dependent variables are @xmath153 and the advantage of this formulation is that the second variable ( potential density ) needs to be found on the contour @xmath8 only and , unlike in original system , there are no differential operators defined on the contour @xmath8 . for the purpose of discretizing poisson equation",
    "we cover the domain @xmath25 with a @xmath154 dyadic chebyshev grid @xcite , where @xmath155 is the number of grid points in each direction .",
    "contour @xmath8 is represented with @xmath156 points equispaced in the arc - length coordinate @xmath157 ( @xmath156 is taken to be an even number ) .",
    "these discretizations are shown in figure [ fig : grids ] ( in problem p2 the discretization of contour @xmath8 needs to be a bit different , cf .",
    "@xcite ) .     and contour @xmath8 .",
    "for clarity , the discretization shown is much coarser than used in the actual computations reported in section [ sec : results].,scaledwidth=50.0% ]    we let @xmath158 , @xmath159 and @xmath160 , @xmath161 denote the discrete nodal values of the unknowns , where @xmath162 are the coordinates of the collocation points on the dyadic chebyshev grid covering @xmath25 , whereas @xmath163 are the arc - length coordinates of the points discretizing contour @xmath8 in problem p1 , i.e. , @xmath164 , @xmath161 .",
    "we then construct the vectors @xmath165 and @xmath166    [ eq : umu ] @xmath167_{(i-1)n+j } & = u_{p;i , j}^n , & \\qquad & i , j=1,\\dots , n , \\label{eq : umu1 } \\\\ [ \\m]_l & = \\mu_l^m , & & l=1,\\dots , m ,   \\label{eq : umu2}\\end{aligned}\\ ] ]    and will use the symbol @xmath168 to denote the discretization of the laplace operator @xmath169 based on the chebyshev spectral collocation approach @xcite and corresponding to the neumann boundary conditions .",
    "thus , discretization of takes the algebraic form @xmath170 where @xmath171 contains the values of the right - hand side ( rhs ) function @xmath21 evaluated at the interior collocation points ( and zeros in the entries corresponding to the boundary nodes ) and @xmath172 is a vector containing the values of @xmath173 at the boundary nodes , cf .  .",
    "it can be expressed as @xmath174 in which @xmath175 is a @xmath176 matrix operator representing the discretization via the trapezoidal rule of the relation @xmath177 where @xmath178 ( the rows of @xmath175 corresponding to the interior grid points are zero ) . as regards integral equation",
    ", we observe that the logarithmic kernel it contains is in fact singular and , assuming the potential density is a lipschitz - continuous function of @xmath157 , the integral is defined as an improper one . as a standard approach to deal with this issue @xcite ,",
    "we rewrite the kernel as @xmath179 where @xmath180 $ ] are the variables parameterizing contour @xmath8 .",
    "therefore , rewriting the line integral in as a definite integral , the boundary integral equation becomes @xmath181\\ , r(t ' ) \\,dt ' } } = \\frac{\\gamma}{k}[u_p(\\x_\\c(t))-u_0 ] , \\quad t \\in [ 0,2\\pi ] \\end{split } \\label{eq : bie}\\ ] ] where , assuming that the contour parameterization is uniform in the arc length @xmath157 , we have @xmath182 .",
    "we note that integral @xmath183 has now a regular kernel ( with a removable singularity to be more precise ) and can be evaluated with spectral accuracy in a straightforward manner using the trapezoidal quadrature . the singularity is now contained in the improper integral @xmath184 which can be evaluated analytically as follows .",
    "we approximate the potential density @xmath185 using the spectrally - accurate trigonometric interpolation @xcite @xmath186 in which @xmath187 , @xmath188 , are the trigonometric cardinal functions @xmath189 , \\",
    "t\\neq\\,t_j , \\ j=1,\\dots , m,\\ ] ] where @xmath190 . defining now @xmath191 +   \\frac{1}{m}\\cos\\left[\\frac{m(t - t_j)}{2}\\right]\\right\\ } , \\quad j=1,\\dots , m , \\label{eq : rjm}\\ ] ] the improper integral @xmath184 in is approximated as @xmath192\\ , r(t ' ) \\,dt '   \\approx \\frac{\\gamma\\,l}{4\\pi\\,k}\\sum_{j=1}^{m}\\mu^m_jr_j^{m}(t ) , \\",
    "t \\in [ 0,2\\pi ] .",
    "\\label{eq : ii}\\ ] ] therefore , collocating integral equation on the grid points @xmath193 yields the following discrete problem @xmath194 where @xmath195 is a column vector of dimension @xmath156 with all entries equal to one and the matrices @xmath196 and @xmath197 are defined as , cf .  ,",
    "@xmath198_{ij } =   -\\frac{l}{2\\pi\\,m}\\ln\\biggl|\\frac{\\x_{\\c}(t_i)-\\x_{\\c}(t_j)}{2\\sin\\left(\\frac{t_i - t_j}{2}\\right)}\\biggr| , \\quad [ \\mathbf{k}_2]_{ij } = \\frac{l}{4\\pi}\\,r_j^m(t_i ) , \\qquad i , j=1,\\dots , m , \\label{eq : kk}\\ ] ] whereas @xmath199 is an @xmath200 matrix representing interpolation of the field @xmath144 from the chebyshev grid onto the points @xmath201 discretizing the contour @xmath8 .",
    "thus , combining and , the final discrete form of system is @xmath202 the accuracy of approximation represented by system is ultimately determined by the accuracy of the interpolation operator @xmath199 , and in principle can be spectral , although for reasons of the numerical stability we have used spline interpolation in the present study .",
    "system is readily solved using standard methods of numerical linear algebra , and we refer the reader to thesis @xcite for numerical validation and tests of accuracy .",
    "discretization of adjoint system leads to a discrete problem with the same matrix as in , but with a different right - hand side .",
    "the @xmath122 gradient @xmath120 is obtained from the solution @xmath203^t$ ] of the discrete adjoint problem using relation , where the different terms are computed using boundary conditions  and the following identities , known from the potential theory @xcite ,    [ eq : jj ] @xmath204&= -\\frac{1}{2\\pi}\\oint_{\\c}\\frac{\\big\\langle \\n(\\x_\\c),\\x_\\c -\\x'\\big\\rangle}{|\\x_\\c - \\x'|^2 } \\mu^*(\\x')\\,ds , \\label{eq : jj2 }   \\end{aligned}\\ ] ]    valid for all points @xmath52 , where @xmath205 denotes the inner product in @xmath206 , @xmath207 and @xmath208 is the single - layer potential density associated with @xmath209 .",
    "we add that the kernel of the integral on the rhs in is in fact bounded , as we have @xmath210 @xmath211 @xcite .",
    "accuracy of the cost functional gradients computed in this way is assessed in the next section .",
    "finally , we remark that after each step of gradient algorithm , the points @xmath212 , @xmath213 , are no longer distributed uniformly in the arc length @xmath157 . in order to retain the spectral accuracy of the solution of equation , at every iteration we therefore construct , using spectral fourier interpolation @xcite , a new set of collocation points @xmath201 which are equispaced in the arc - length coordinate . the main modification required to adapt the method described above to problem p2 concerns the solution of boundary - integral equation .",
    "since the integration domain is no longer periodic , identity must be replaced with a different one and contour @xmath8 must be discretized using a different set of points @xcite .",
    "moreover , the trapezoidal quadratures need to be replaced with the clenshaw - curtis quadratures whereas the trigonometric interpolation with a suitable polynomial technique .",
    "in this section we first perform tests to thoroughly validate the computational algorithm introduced in section [ sec : implement ] for the evaluation of cost functional gradients @xmath214 .",
    "we do this here for problem p1 and refer the reader to @xcite for the corresponding validation tests for problem p2 .",
    "next , we apply this method in the framework of algorithm [ alg1 ] to perform shape optimization in a number of test cases concerning problems p1 and p2 . throughout this section",
    "we take the domain to be @xmath215 \\times [ -1,1]$ ] .      a standard computational test employed to ascertain",
    "the accuracy of the cost functional gradients in pde optimization problems is to calculate the gteaux differential @xmath109 for a given contour @xmath8 and its perturbations @xmath75 in two different ways : using an approximate finite - difference formula and riesz identity @xcite .",
    "thus , the ratio of these two expressions , denoted @xmath216 should be approximately equal to unity for a range of values of @xmath217 .",
    "plotting @xmath218 using the logarithmic scale allows one to see the number of significant digits of accuracy captured in the computation .",
    "we remark that , since different riesz representations ( @xmath122 vs.  @xmath219 ) give the same differential @xmath109 , for simplicity in we can use the @xmath122 inner product together with the corresponding gradient . to focus attention , we present our validation results for the functional @xmath220 , i.e. , without the length constraint , as the gradient of the latter part does not involve the adjoint variable @xmath221 .",
    "we analyze two sets of results : one in which we fix the contour @xmath8 and consider different perturbations @xmath75 and vice versa .",
    "for every pair of the contour and the perturbation we study the effect of different resolutions @xmath222 and @xmath156 . details concerning the two test cases",
    "are collected in table [ tab : kappa ] , where the different contours are specified in table [ tab : c ] , whereas the perturbations tested are given by @xmath223 , \\",
    "\\label{eq : zeta}\\ ] ] in both validation tests we assume that @xmath224 and use the following distribution of the heat sources and the target temperature profile @xmath225 where @xmath226 . the results of test # 1 and test # 2 are shown in figures [ fig : kappa1 ] and [ fig : kappa2 ] , respectively . in both cases",
    "we note that @xmath227 is fairly close to the unity for values of @xmath217 spanning several orders of magnitude .",
    "the quantity @xmath227 deviates from the unity for very small values of @xmath217 which is due to the subtractive cancellation ( round - off ) errors , and for large values of @xmath217 which is due to the truncation errors , both of which are well - known effects @xcite .",
    "since we use the `` differentiate - then - discretize '' formulation , one should not expect @xmath218 to be at the level of the machine precision , although this quantity approaches zero as the resolution is refined .",
    "we also tested cases in which @xmath228 and the length constraint was included obtaining similar results as in figures [ fig : kappa1 ] and [ fig : kappa2 ] .",
    "having thus validated the cost functional gradients , we now move on to discuss solution of the actual optimization problems .",
    ".definitions of contours @xmath229 used in the different cases studied in section [ sec : results ] . [ cols=\"^,^,^,^,^ \" , ]     [ tab : cases ]    the results characterizing the performance of algorithm [ alg1 ] in case # 1 are collected in figure [ fig : case1 ] .",
    "first of all , we note that , depending on the choice of the initial guess @xmath230 for the contour in , cf .",
    "figure [ fig : case1]a , the iterations in fact converge to quite distinct locally optimal shapes , cf .  figure [ fig : case1]b , providing evidence for the existence of multiple local minima in the optimization problem , as discussed in section [ sec : grad ] .",
    "we also note that the decrease of cost functional @xmath231 with iterations @xmath100 is quite different in these different cases , cf .",
    "figure [ fig : case1]c . in figure",
    "[ fig : case1]d we show the intermediate shapes found at the consecutive iterations of the algorithm starting from the initial guess @xmath232 for which the largest decrease was obtained in the cost functional .",
    "we observe that `` simpler '' initial guesses ( i.e. , a circle or an ellipse ) tend to lead to `` better '' local minimizers .",
    "however , the final temperature distributions @xmath233 obtained from the different initial guesses all capture features of the cellular pattern characterizing the target distribution @xmath43 , see figures [ fig : case1]f , h , j , l vs. figure [ fig : qub]b .",
    "the data illustrating the performance of algorithm [ alg1 ] in case # 2 is shown in figure [ fig : case2 ] . since in this case",
    "we include the length constraint with a rather large value of the penalty parameter ( @xmath234 ) , the optimal contours are not allowed to deform much ( figure [ fig : case2]c ) . however , we remark that the algorithm is able to `` shift '' the contour so that the optimal shape @xmath48 is enclosed within the target domain @xmath42 in which the temperature field @xmath43 is defined ( figure [ fig : case2]d ) .    the data concerning case # 3 is collected in figure [ fig : case3 ] . using the contour shown in figure [ fig : case3]b as the initial guess ( cf .",
    "table [ tab : c ] ) , we first solve problem p2 assuming @xmath235 and with the length constraint not enforced ( @xmath236 ) . then , using thus obtained optimal shape ( marked with the solid line in figure [ fig : case3]e ) as the initial guess , we solve problem p2 again , now allowing @xmath10 to vary with the arc length @xmath157 . mimicking changes in the inflow / outflow temperature of the coolant liquid , this is achieved by decreasing @xmath23 or increasing @xmath24 in and corresponds to , respectively , dash - dotted and dashed contours in figure [ fig : case3]e . in figure [ fig : case3]c we observe that in the initial optimization the cost functional drops by over three orders of magnitude during less than 10 iterations ( in the subsequent problems which have better initial guesses this decrease is smaller ) .",
    "finally , we consider the case with @xmath237 and @xmath238 , and solve the optimization problem with the length constraint using @xmath239 and increasing values of @xmath240 .",
    "the resulting optimal contour shapes are shown in figure [ fig : case3]f , whereas figure [ fig : case3]d presents the evolution of the contour length @xmath241 with iterations for different values of @xmath240 .",
    "as expected , we see that for increasing values of @xmath240 the contour length approaches the prescribed value @xmath242 while the contours themselves become less deformed .",
    "the temperature fields @xmath243 obtained in the cases with @xmath244 , @xmath245 and @xmath246 , and @xmath237 and @xmath238 , cf .  , and without the length constraint",
    "are shown in figures [ fig : case3]g , h , i . this last case with the length constraint and @xmath247",
    "is shown in figure [ fig : case3]j .",
    "we see that , as compared to the temperature corresponding to the initial guess for the contour ( figure [ fig : case3]b ) , the optimal distributions in figures [ fig : case3]g , h , i , j have the temperature ranges much closer to target field .",
    "we also observe that , with the exception of the case in which the inflow temperature @xmath23 is quite low ( figure [ fig : case3]h ) , the optimal contour shapes tend to weave around the two hot spots in the heat source distribution ( figure [ fig : case3]a ) in a complicated manner .",
    "in this investigation we have addressed the problem of shape optimization for a system of elliptic pdes subject to mixed interface boundary conditions which models the steady - state heat transfer in 2d .",
    "our continuous optimization formulation relies on sobolev shape gradients obtained using the shape - differential calculus and explicit interface tracking employed to represent the optimized contour , all of which are rather well known approaches .",
    "the key novel contribution of this work is the method we introduced to numerically evaluate the shape gradients . by splitting the adjoint system into two coupled subproblems",
    "we could achieve optimal accuracy for each of the subproblems .",
    "in particular , the proposed boundary - integral formulation exploits the analytical ( potential ) structure of the problem and , as demonstrated by the exhaustive validation tests presented in section [ sec : validate ] , offers high numerical accuracy without the need to construct a boundary - fitted mesh at every iteration , as required in other approaches based on explicit interface tracking @xcite . as a result ,",
    "the proposed method is quite efficient from the computational point of view and , as shown in section [ sec : optim ] , can deal with fairly complicated contour shapes in an easy and straightforward manner . while boundary - integral formulations have been used to study the shape sensitivities of elliptic pdes ( e.g. , @xcite ) , the method we introduced is designed for higher accuracy than previous approaches .",
    "as compared to the `` discretize - then - differentiate '' approaches , they key advantage of the continuous formulation used here is that , as discussed at the end of section [ sec : implement ] , it offers the freedom to remesh the points discretizing the contour which is crucial to achieving spectral accuracy in the solution of the boundary integral equation . on the contrary , in the discrete setting such remeshing would actually require one to set up a new optimization problem ( corresponding to the new set of the discrete control variables ) .",
    "moreover , it is also not evident how the analytic treatment of singularities described in section [ sec : implement ] could be employed in the discrete setting . in regard to the level - set - based interface capturing methods , the present approach arguably offers more flexibility in the high - accuracy treatment of the complex interface boundary conditions .",
    "optimizations performed on three test problems led to rather nonintuitive optimal shapes of the contour which differed significantly from the initial guesses provided based on the `` engineering intuition '' , reflecting the geometric nonlinearity and nonlocality of the governing system .",
    "smoothness of the contours was enforced by defining the cost functional gradients in a suitable sobolev space .",
    "this , combined with the interpolation technique described at the end of section [ sec : implement ] , allowed for an accurate representation of even strongly deformed contours using a rather modest number of points ( @xmath248 in cases # 1 , # 2 , and # 3 , cf .",
    "table [ tab : cases ] ) .",
    "evidence was also shown for the presence of multiple local minima . in problem",
    "p1 , when the length constraint was not imposed , the optimal temperature distributions were found to capture the main features of the target temperature field @xmath43 . on the other hand ,",
    "the presence of the length constraint restricted the ability of the algorithm to deform the contour , although it was still capable of `` shifting '' the contour to a different part of the domain @xmath25 without significant shape changes .",
    "it ought to be added that extension of the proposed approach to three - dimensional ( 3d ) configurations is conceptually straightforward . aside from the need to work with the 3d fundamental solutions in expressions resulting from ansatz , some technical complications may arise from the fact that the boundary integral equations will be formulated on 2d surfaces , rather than on 1d contours which , in particular , may make achieving high numerical accuracy more difficult .",
    "the formulation developed in this study leads to the following open problems of a more fundamental character .",
    "our adjoint system was derived in the pde setting @xcite and only then recast in terms of the boundary - integral formulation for the purpose of the numerical solution . on the other hand",
    ", one could begin with the boundary - integral formulation of governing system which , after shape differentiation , would give rise to an integral expression with more singular , possibly hypersingular , kernels .",
    "assessing the relative advantages and disadvantages of such an alternative approach is an interesting open question and is left to the future research ( we mention that sensitivity calculations based on hypersingular integral equations have already been discussed in @xcite ) .",
    "in addition , our future work will also involve generalizations of the proposed approach to mathematical models of the battery system more complex than accounting for some effects of the actual flow of the coolant fluid in channels of finite thickness ( see figure [ fig : battery_pack]b ) . we also intend to explore optimization of the topology of the contours @xcite .",
    "the two anonymous referees are acknowledged for providing many constructive comments and a number of important references .",
    "the authors are also grateful to the national centre of excellence auto21 ( canada ) for generous funding provided for this research ( through grant ed401-ehe `` multidisciplinary optimization of hybrid and electric vehicle batteries '' ) .",
    "the authors also acknowledge many helpful discussions with the general motors of canada r&d team in oshawa , ontario .",
    "n.  a.  chaturvedi , r.  klein , j.  christensen , j.  ahmed , and a.  kojic , `` algorithms for advanced batter - management systems : modeling , estimation , and control for lithium - ion batteries '' _ ieee control systems magazine _ * 30 * , 4968 , ( 2010 ) .        c.  h.  lan , c.  h.  cheng and c.  y.  wu , `` shape design for heat conduction problems using curvilinear grid generation , conjugate gradient and redistribution methods '' , _ numerical heat transfer , part a _ * 39 * , 487510 , ( 2001 ) .",
    "f.  chantalat , ch .- h .",
    "bruneau , c.  galusinski and a.  iollo , `` level - set , penalization and cartesian meshes : a paradigm for inverse problems and optimal design '' , _ journal of computational physics _ * 228 * , 62916315 , ( 2009 ) .",
    "c.  h.  huang and b.  h.  chao , `` an inverse geometry problem in identifying irregular boundary configurations '' , _ international journal of heat and mass transfer _ * 40 * , 20452053 , ( 1997 ) . . c.  h.  huang and t.  y.  hsiung , `` an inverse design problem of estimating optimal shape of cooling passages in turbine blades '' , _ international journal of heat and mass transfer _ , * 42 * , 43074319 , ( 1999 ) .    c.  h.  huang and c.  c.  shih , `` a shape identification problem in estimating simultaneously two interfacial configurations in a multiple region domain '' , _ applied thermal engineering _ * 26 * , 7788 , ( 2006 ) .    c.  h.  huang and c.  y.  liu , `` a three - dimensional inverse geometry problem in estimating simultaneously two interfacial configurations in a composite domain '' , _ international journal of heat and mass transfer _ * 53 * , 4857 , ( 2010 ) .",
    "a.  abba , s.  fausto and c.  dangelo , `` a 3d shape optimization problem in heat transfer : analysis and approximation via bem '' , _ mathematical models and methods in applied sciences _ * 16 * , 12431270 , ( 2006 ) .",
    "g.  rus and r.  gallego , `` hypersingular shape sensitivity boundary integral equation for crack identification under harmonic elastodynamic excitation '' , _ comput .",
    "methods appl .",
    "_ * 196 * , 25962618 , ( 2007 ) ."
  ],
  "abstract_text": [
    "<S> this investigation is motivated by the problem of optimal design of cooling elements in modern battery systems . </S>",
    "<S> we consider a simple model of two - dimensional steady - state heat conduction described by elliptic partial differential equations and involving a one - dimensional cooling element represented by a contour on which interface boundary conditions are specified . </S>",
    "<S> the problem consists in finding an optimal shape of the cooling element which will ensure that the solution in a given region is close ( in the least squares sense ) to some prescribed target distribution . </S>",
    "<S> we formulate this problem as pde - constrained optimization and the locally optimal contour shapes are found using a gradient - based descent algorithm in which the sobolev shape gradients are obtained using methods of the shape - differential calculus . </S>",
    "<S> the main novelty of this work is an accurate and efficient approach to the evaluation of the shape gradients based on a boundary - integral formulation which exploits certain analytical properties of the solution and does not require grids adapted to the contour . </S>",
    "<S> this approach is thoroughly validated and optimization results obtained in different test problems exhibit nontrivial shapes of the computed optimal contours .    * keywords : * heat transfer , adjoint - based optimization , shape calculus , sobolev gradients , boundary integral equations 80m50 , 35q93 , 49q10 , 49q12 , 65n38 </S>"
  ]
}