{
  "article_text": [
    "recent years have witnessed momentous interest  @xcite in the collective density oscillations of a doped graphene sheet , the so - called dirac plasmons . the reason is partly related to the fact that the propagation of graphene plasmons has been _ directly _ imaged in real space by utilizing scattering - type scanning near - field optical microscopy  @xcite . in a series of pioneering experiments in the mid - infrared spectral range ,",
    "fei _ et al . _",
    "@xcite and chen _ et al . _",
    "@xcite demonstrated that the plasmon wavelength @xmath1 can be @xmath2-@xmath3 times smaller than the free - space excitation wavelength @xmath4 , allowing an extreme concentration of electromagnetic energy , and that dirac plasmon properties are easily _ gate tunable_.    importantly , these figures of merit have been dramatically improved by utilizing van der waals stacks  @xcite comprising graphene encapsulated in boron nitride crystals  @xcite .",
    "mid - infrared plasmons in encapsulated graphene display  @xcite ultra - large field confinement ( i.e.  @xmath5 ) , small group velocity , and a remarkably long lifetime , @xmath6 . in the terahertz spectral range , acoustic plasmons with @xmath7 and a similar lifetime",
    "have been recently observed in hbn / graphene / hbn heterojunctions including a nearby metal gate  @xcite .",
    "substantial theoretical efforts have also been devoted to understanding the nonlinear optical properties of graphene  @xcite .",
    "experimentally , hendry et al .",
    "@xcite demonstrated that the third - order optical susceptibility of graphene is remarkably large ( @xmath8 ) and only weakly dependent on wavelength in the near - infrared frequency range .",
    "third - harmonic generation ( thg ) from mechanically exfoliated graphene sheets has been measured by kumar et al .",
    "@xcite who extracted a value of the third - order susceptibility on the order of @xmath9 for an incident photon energy @xmath10 .",
    "finally , hong et al .",
    "@xcite reported strong thg in graphene grown by chemical vapor deposition , in the situation in which the incident photon energy @xmath11 is in three - photon resonance with the exciton - shifted van hove singularity .",
    "since plasmons enable the concentration of electromagnetic energy into extremely small volumes , many groups have theoretically studied the interplay between plasmons and the nonlinear optical properties of graphene and its nanostructures  @xcite .",
    "an all - optical plasmon coupling scheme , which takes advantage of the intrinsic nonlinear optical response of graphene , has been implemented experimentally  @xcite .",
    "free - space , visible light pulses were used by the authors of ref .   to launch dirac plasmons in graphene .",
    "difference - frequency wave mixing ( see below ) enabled the achievement of the energy- and wavevector - matching conditions . by carefully controlling the phase matching conditions",
    ", they also showed that one can excite dirac plasmons with a definite wavevector and direction across a large frequency range , with an estimated efficiency approaching @xmath12 .    in this article",
    ", we present a formal theory of second- and third - order nonlinearities , which treats quantum effects , intra- and inter - band contributions , and electron - electron interactions on equal footing .",
    "our theory starts from an equilibrium matsubara approach and related feynman diagrams for the non - interacting nonlinear susceptibilities  @xcite and includes electron - electron interactions via a large-@xmath0 approach  @xcite .",
    "here , @xmath0 refers to the number of fermion flavors . in this approximation ,",
    "only diagrams with the largest number of fermion loops are kept  @xcite , with the idea that each fermion loop ( bubble ) carries a factor @xmath0 .",
    "our large-@xmath0 theory reduces to the ordinary bohm - pines random phase approximation ( rpa )  @xcite in the case of linear response theory .",
    "this article therefore naturally generalizes rpa theory to the case of nonlinear response functions , capturing screening and plasmons .    while our approach is completely general , we carry out detailed microscopic calculations for the case of a system of two - dimensional ( 2d ) massless dirac fermions  @xcite interacting via long - range coulomb interactions .",
    "large-@xmath0 theories are known to work very well for weakly correlated materials , like graphene , in which long - range coulomb interactions ( rather than on - site hubbard - type interactions ) play a major role , while they fail to describe e.g.  excitonic effects in semiconductors . in this case ,",
    "vertex corrections need to be taken into account .",
    "this is well beyond the scope of the present article and is left for future works .",
    "our article is organized as following . in sect .",
    "[ sect : second - order ] we present our large-@xmath0 theory of the second - order susceptibility , while the case of the third - order response is analyzed in sect .",
    "[ sect : third - order ] . in sect .",
    "[ sect : small_q_limit ] we detail the derivation of long - wavelength expressions for the second- and third - order density response functions , which are extremely useful to understand nonlinear optics experiments . symmetry considerations that apply to the case of homogeneous and isotropic 2d systems are summarized in sect .",
    "[ sect : symmetries ] . in sect .",
    "[ sect : second - order - dirac ] we present explicit analytical and numerical calculations of the second - order conductivity of a 2d system of massless dirac fermions . for the sake of clarity ,",
    "the case of harmonic generation and sum / difference wave mixing are independently analyzed in sects .",
    "[ sect : harmonic ] and  [ sect : sum_and_difference ] , respectively .",
    "a comparison between our theory and available experimental results  @xcite is reported in sect .",
    "[ subsection : comparison - with - experimental - results ] .",
    "a summary of our main results and a brief set of conclusions are reported in sect .",
    "[ sect : summary ] .",
    "three appendices report a wealth of technical details .",
    "in particular , in appendix  [ app : tdh ] , we show that the main formal results of our article , eqs .",
    "( [ eq : chi2_rpa ] ) , ( [ eq : chi3_rpaa ] ) , and   ( [ eq : chi3_rpab ] ) , can also be independently derived by using the time - dependent hartree approximation  @xcite .",
    "this derivation highlights a pathway to transcend the large-@xmath0 approximation , by suggesting a straightforward approach to include exchange and correlation effects in the spirit of density functional theory  @xcite .",
    "we start by considering the bare second - order density response function .",
    "this is diagrammatically represented in fig .",
    "[ fig : chi2_rpa](a ) . in this diagram ( usually termed `` triangle '' diagram ) , solid lines are non - interacting green s functions while filled circles represent density vertices  @xcite .    in the large-@xmath0 approximation",
    "@xcite , electron - electron interactions are captured by the diagrams reported in figs .  [ fig : chi2_rpa](b)-(d ) . in fig .",
    "[ fig : chi2_rpa](b ) , all the three density vertices of the bare diagram are dressed by the infinite rpa series of bubble diagrams shown in fig .",
    "[ fig : chi2_rpa](e )",
    ". similarly , in fig .  [ fig : chi2_rpa](c ) and ( d ) , only two vertices ( one vertex ) are ( is ) dressed by the rpa series of bubble diagrams .    the logic of keeping only the diagrams in fig .",
    "[ fig : chi2_rpa](b)-(d ) is the following . in the large-@xmath0 approximation , only diagrams that dominate in the limit @xmath13 are retained , where @xmath0 stands for the number of fermion flavors ( @xmath14 , for example , in graphene ) . as discussed in ref .  , each fermion loop ( i.e.  bubble ) brings a factor @xmath0 , while each electron - electron interaction line brings a factor @xmath15 .",
    "therefore , a diagram with @xmath16 bubbles and @xmath17 electron - electron interaction lines scales like @xmath18 , where @xmath19 . in the limit @xmath13 ,",
    "all diagrams with @xmath20 are negligible , while diagrams with @xmath21 dominate .",
    "diagrams in fig .",
    "[ fig : chi2_rpa](b)-(d ) have @xmath22 , while the diagram in fig .",
    "[ fig : chi2_rpa](f ) has @xmath23 .",
    "we therefore conclude that the latter diagram must be discarded in the large-@xmath0 approximation .    the sum of diagrams in fig .",
    "[ fig : chi2_rpa](b)-(d ) renormalizes the bare second - order response @xmath24 shown in fig .",
    "[ fig : chi2_rpa](a ) .",
    "we find that the second - order nonlinear response function in the large-@xmath0 limit , which will be denoted by the symbol @xmath25 , is given by the following expression : @xmath26 where @xmath27 in eq .",
    "( [ eq : r2 ] ) we have used the following shorthand : @xmath28 and @xmath29 . here , @xmath30 is the 2d fourier transform of the coulomb interaction potential and @xmath31 is the usual rpa series of bubble diagrams  @xcite , where @xmath32 is the frequency- and wavevector - dependent first - order _ non - interacting _ density response function  @xcite .",
    "finally , for @xmath33 , we have @xmath34 and @xmath35 .    carrying out the sums in eq .",
    "( [ eq : r2 ] ) , we find @xmath36 where @xmath37 is a shorthand for @xmath38 which is the dynamical rpa screening function  @xcite .",
    "therefore , the second - order density - density response function in the large-@xmath0 limit is given by @xmath39 in the harmonic case , @xmath40 , eq .  ( [ eq : chi2_rpa ] ) reduces to a result that has been obtained earlier by using a self - consistent density - matrix approach  @xcite .",
    "in this section we lay down a large-@xmath0 theory for the third - order response function . in this case , the situation is more subtle .",
    "the point is that the bare third - order response function ( square diagram ) contains _ four _ density vertices , see fig .  [",
    "fig : chi3_rpa](a ) .",
    "one can therefore create _ two _ families of large-@xmath0 diagrams that contribute to the third - order response .",
    "the first family , which is based on square - type diagrams , is shown in fig .  [",
    "fig : chi3_rpa ] .",
    "these large-@xmath0 series just renormalizes the bare third - order response , as in the case of the second - order response in fig .",
    "[ fig : chi2_rpa ] .",
    "the second family is topologically distinct and based on triangle - type diagrams , as illustrated in fig .",
    "[ fig : chi3_bis_rpa ] .",
    "the idea of the second family is that you can create feynman diagrams with four density vertices by `` glueing '' together two second - order triangular diagrams via an electron - electron interaction line .",
    "the sum of the diagrams in the first family will be denoted by the symbol @xmath41 , while the sum of the diagrams in the second family will be denoted by @xmath42 .",
    "the full third - order response function in the large-@xmath0 approximation is given by : @xmath43 .",
    "in analogy with the second - order response function ( [ eq : chi2_rpa ] ) , the sum of the diagrams in fig .  [",
    "fig : chi3_rpa ] can be written as @xmath44 where @xmath45 here , @xmath46 and @xmath47 is the kronecker delta . carrying out the sums in eq .",
    "( [ eq : r3 ] ) , we find @xmath48 and @xmath49 the situation is quite different for the second family of feynman diagrams shown in fig .  [",
    "fig : chi3_bis_rpa ] .",
    "the sum of these diagrams can be written as @xmath50 where @xmath51 @xmath52 @xmath53 @xmath54 and @xmath55 in eqs .",
    "( [ eq : typeii_ingredient1])-([eq : typeii_ingredient4 ] ) , @xmath56 and @xmath57 .        from eq .",
    "( [ eq : typeii_ingredient5 ] ) , one can show that @xmath58 , with similar expressions holding for @xmath59 and @xmath60 , provided that suitable cyclic permutations of the @xmath61,@xmath62 , and @xmath63 indices are carried out .",
    "after lengthy but straightforward algebra we conclude that @xmath64 where @xmath65 for @xmath66 and so on and so forth , in a cyclic manner , and the dynamically screened interaction is defined by  @xcite @xmath67 an alternative derivation of eqs .",
    "( [ eq : chi2_rpa ] ) , ( [ eq : chi3_rpaa ] ) , and  ( [ eq : chi3_rpab ] ) , which is based on the time - dependent hartree approximation , is offered in appendix  [ app : tdh ] .",
    "in this section we present a long - wavelength expansion of the nonlinear response functions introduced in the previous sections . to this end , we take advantage of the gauge invariance principle and introduce nonlinear _ conductivity _ tensors .    using gauge invariance  @xcite , we obtain the following relation between the @xmath68-th order nonlinear density response function and the corresponding nonlinear conductivity : @xmath69 where @xmath70 and @xmath71 are the cartesian components of the vectors @xmath72 and @xmath73 , respectively . in writing eq .",
    "( [ eq : chi - sigma ] ) we have dropped for simplicity the argument of the nonlinear functions @xmath74 and @xmath75 : @xmath76 and @xmath77 .",
    "using eq .",
    "( [ eq : chi - sigma ] ) , we can first express the dynamical screening function in terms of the linear - response conductivity tensor : @xmath78 using eqs .",
    "( [ eq : chi2_rpa_0 ] ) , ( [ eq : sum_type_i ] ) , ( [ eq : sum_type_ii ] ) , and  ( [ eq : chi - sigma ] ) , we obtain the following formal relations for the second- and third - order conductivities : @xmath79 and @xmath80 in eqs .",
    "( [ eq : sigma2_eff ] ) and  ( [ eq : sigma3_eff ] ) , @xmath81 and @xmath82 denote the second- and third - order conductivities of the _ interacting _ electron system , while @xmath83 and @xmath84 denote their non - interacting counterparts .    also , in eq .",
    "( [ eq : sigma3_eff ] ) we have introduced    @xmath85    the contribution denoted by the symbol @xmath86 stems from the family of diagrams shown in fig .",
    "[ fig : chi3_bis_rpa ] . as we have discussed earlier",
    ", a similar contribution does not exist in the case of the second - order response  cf .",
    "( [ eq : sigma2_eff ] ) .",
    "physically , @xmath86 represents an interaction - induced _ nonlocal _ contribution to the third - order conductivity .",
    "a caveat is now in order .",
    "some care must be exercised when adding @xmath84 and @xmath86 in eq .",
    "( [ eq : sigma3_eff ] ) . in principle , indeed , one should expand @xmath84 in powers of wavevectors in the long - wavelength limit , up to the same order that appears in eq .",
    "( [ eq : tilde_sigma3 ] ) .",
    "this calculation is very cumbersome and will be not carried out in this work .",
    "the numerical results in fig .",
    "[ fig : plasmonic_shg_thg](c ) below have been calculated by neglecting nonlocal corrections to @xmath84 .",
    "we are now in the position to expand the nonlinear density response functions in the long - wavelength limit . to this end",
    ", we just need to expand the conductivity tensors @xmath75 , keeping the leading contributions .",
    "we also need to specify the functional dependence of @xmath30 on @xmath87 . for long - range coulomb interactions in a _ free - standing _ graphene sheet ,",
    "the 2d fourier transform of the coulomb potential is given by @xmath88 , with @xmath89 and @xmath90 the vacuum permittivity .",
    "in the long - wavelength @xmath91 limit the rpa dynamical screening function can be expanded as @xmath92 where we have introduced the longitudinal linear conductivity @xmath93 in eq .",
    "( [ eq : expansion_dynamical_screening ] ) and below , `` @xmath94 '' denote higher - order corrections , which vanish faster that the leading term in the long - wavelength limit .",
    "similarly , the long - wavelength expansion of the second - order density response function requires an expansion of the second - order conductivity up to linear order in @xmath95 : @xmath96 where the zeroth - order term , @xmath97 , is the second - order optical conductivity , while its _ dipole _ is defined by @xmath98 using eqs .",
    "( [ eq : chi2_rpa ] ) , ( [ eq : chi - sigma ] ) and  ( [ eq : sigma2_small_q ] ) , we can rewrite the large-@xmath0 second - order density response in the long - wavelength limit as @xmath99+\\dots\\nonumber\\\\\\end{aligned}\\ ] ] where @xmath100 and @xmath101 in eq .",
    "( [ eq : chi2_rpa_small_q ] ) , we have introduced the following long - wavelength expansion of the @xmath102 factors : @xmath103 \\pi^n_{j=1}\\left [ 1 + i   \\frac { q_j}{2\\epsilon_0 \\omega_j }   \\sigma^{(1)}_{\\rm l}(\\omega_j)\\right ] \\nonumber \\\\&+ & \\dots\\end{aligned}\\ ] ] with @xmath104 .",
    "similarly , we can expand the third - order nonlinear density response functions . in the long - wavelength limit eq .",
    "( [ eq : sum_type_i ] ) reduces to @xmath105 where the longitudinal third - order optical conductivity is given by @xmath106 in the same limit , eq .",
    "( [ eq : sum_type_ii ] ) reduces to @xmath107 }   % \\big [ \\sigma^{(2)}_{\\rm l}(-\\omega_\\sigma;\\omega_i,\\widetilde\\omega_i ) + \\nonumber\\\\ & & q_i d^{(2)}_{\\rm l , i}(-\\omega_\\sigma;\\omega_i,\\widetilde\\omega_i ) + \\widetilde q_i d^{(2)}_{\\rm l,2}(-\\omega_\\sigma;\\omega_i,\\widetilde\\omega_i )   \\big ]    % \\big [ \\sigma^{(2)}_{\\rm l}(-\\widetilde\\omega_i;\\omega_j,\\omega_k ) \\nonumber\\\\ & &   + q_j d^{(2)}_{\\rm l,1}(-\\widetilde\\omega_i;\\omega_j,\\omega_k ) + q_k d^{(2)}_{\\rm l,2}(-\\widetilde\\omega_i;\\omega_j,\\omega_k ) \\big]+\\dots.\\end{aligned}\\ ] ] notice again that @xmath65 for @xmath66 , and so on and so forth , in a cyclic way .",
    "in a homogeneous and isotropic 2d system , the properties of the nonlinear conductivity tensors are highly constrained by rotational , translational , and inversion symmetries .",
    "we start by recalling that , due to mirror @xmath108 ( @xmath109 ) symmetry , all elements of the third - order conductivity with an odd number of @xmath110 ( @xmath111 ) cartesian indices are identically zero .",
    "full rotational symmetry implies @xmath112 moreover , mirror symmetry with respect to diagonal in the @xmath113-@xmath114 plane provides an exchange symmetry between @xmath110 and @xmath111 cartesian indices : we therefore have @xmath115 by using eqs .",
    "( [ eq : s3l ] ) , ( [ eq : sym3_1 ] ) , and  ( [ eq : sym3_2 ] ) and @xmath116 for @xmath117 , we get @xmath118 here , @xmath119 is the azimuthal angle of @xmath120 , i.e. @xmath121 with @xmath122 .",
    "all conductivity tensor elements in eq .",
    "( [ eq : sigma3l ] ) have argument @xmath123 .",
    "( [ eq : sigma3l ] ) reduces to @xmath124 for the particular case of thg .    in an inversion symmetric system",
    ", we have @xmath125",
    ". however , a _ non - vanishing _ dipole @xmath126 of the second - order conductivity is expected .",
    "since @xmath126 is a rank-@xmath127 tensor , it obeys the same symmetry properties of the third - order nonlinear conductivity .",
    "because of the intrinsic permutation symmetry of the second - order conductivity tensor , we have @xmath128 .",
    "moreover , as demonstrated in appendix  [ app : d2l ] , @xmath129 .    we can therefore write the following result for @xmath130 : @xmath131   \\cos(\\theta_\\sigma-\\theta_2 ) ~.\\end{aligned}\\ ] ] all tensor elements on the right - hand side of eq .",
    "( [ eq : d2l1 ] ) have argument @xmath132 . for the case of @xmath133 , we have ( see appendix [ app : d2l ] ) @xmath134 from now on , we use the symbol @xmath126 as a shorthand for @xmath135 .",
    "we are now ready to specialize our general results to the case of a specific material .    we will consider a 2d dirac material with two valleys , like graphene .",
    "the low - energy hamiltonian reads as following  @xcite : @xmath136 , where @xmath137 is the fermi velocity , @xmath138 stands for the valley ( @xmath139 , @xmath140 ) index , and @xmath141 represent ordinary pauli matrixes acting in sublattice space .",
    "the eigenstates ( i.e.  bands ) of the this hamiltonian are given @xmath142 , where @xmath143 indicates conduction and valence bands .",
    "the corresponding eigenvectors are @xmath144^{\\rm t } = \\left [ 1 , \\lambda \\tau e^{i \\tau \\phi({\\bm k } ) } \\right ] /\\sqrt{2}$ ] , where @xmath145 is the polar angle of the vector @xmath146 .",
    "the wavefunctions in real space are @xmath147 where @xmath148 is the 2d electron system area .",
    "the matrix elements of the charge density ( @xmath149 ) and charge current ( @xmath150 ) operators are given by @xmath151 and @xmath152 where @xmath153 stands for the anti - commutation and the paramagnetic current operator in the first quantization picture reads @xmath154 therefore , @xmath155 .",
    "in the scalar potential gauge , the second - order charge current reads as follows  @xcite : @xmath156 here , @xmath157 denotes the fourier transform of the external scalar potential and @xmath158 is the second - order response function that establishes a link between the current response @xmath159 and the product of two external scalar potentials , @xmath160 and @xmath161 . the quantity @xmath158 is diagrammatically represented by a triangular diagram similar to the one in fig .",
    "[ fig : chi2_rpa]a ) , with two density vertices and one current vertex , i.e. @xmath162~.\\end{aligned}\\ ] ] in eq .",
    "( [ eq : pi2 ] ) we have introduced the form factor @xmath163}}{2 } \\nonumber\\\\ & \\times&\\frac{1+\\lambda_1 \\lambda_2 e^{-i\\tau[\\phi({\\bm k}+{\\bm q}_1)-\\phi({\\bm k})]}}{2}~.\\end{aligned}\\ ] ] as customary in many - body perturbation theory  @xcite , everywhere in eq .",
    "( [ eq : pi2 ] ) @xmath164 denotes a photon energy accompanied by an infinitesimal positive imaginary part , i.e.  @xmath165 , with @xmath166 .",
    "the symbol @xmath167 implies that we are enforcing the intrinsic permutation symmetry@xcite between @xmath168 and @xmath169 .    because of inversion symmetry",
    ", the second - order optical conductivity @xmath170 is identically zero in the case of graphene .",
    "( it is non - zero in the case of a finite valley polarization and can be used as a diagnostic tool for the presence of the latter  @xcite . ) however , its dipole is finite : @xmath171 after straightforward algebraic steps ( which are summarized in appendix  [ app : d2xxxx ] ) , we obtain the following expression for @xmath172 at zero temperature : @xmath173   \\left [ ( \\hbar\\omega_\\sigma)^2 -4 e^2_{\\rm f } \\right ] }     \\nonumber\\end{aligned}\\ ] ] where we have introduced @xmath174 we have checked ( not shown here ) that the expected permutation symmetry @xmath175 is satisfied . our results in eqs .",
    "( [ eq : d2xxxx])-([eq : dzero ] ) coincide with those recently reported in ref .  .",
    "the other non - vanishing tensor elements of the second - order dipole are : @xmath176   \\left [ ( \\hbar\\omega_\\sigma)^2 -4 e^2_{\\rm f } \\right ] } \\nonumber\\\\ & & \\times 8 e^2_{\\rm f } \\left [   ( \\hbar\\omega_1)^2 \\hbar\\omega_\\sigma -2\\hbar\\omega_2 e^2_{\\rm f}\\right ] \\end{aligned}\\ ] ] and @xmath177   \\left [ ( \\hbar\\omega_\\sigma)^2 -4 e^2_{\\rm f } \\right ] } \\nonumber \\\\ & & \\times 16 e^2_{\\rm f } \\left [ e^2_{\\rm f } ( 2\\hbar\\omega_1 + 3\\hbar\\omega_2)-(\\hbar\\omega_1)^2 \\hbar\\omega_\\sigma\\right ] ~.\\end{aligned}\\ ] ] it can be shown that the identity @xmath178 holds true .    , @xmath179 , and @xmath180in units of @xmath181 , where @xmath182 has been introduced in eq .",
    "( [ eq : dzero])for the case of clean graphene , at zero temperature .",
    "the quantities @xmath172 and @xmath183 ( solid black and dotted red lines ) show _ two _ sharp resonances at @xmath184 and @xmath185 , while @xmath186 ( dashed blue line ) shows only one resonance at @xmath187.[fig : d2 ] ]",
    "fig5a(-1,67)(a )    fig5b(-1,67)(b )    fig5c(-1,67)(c )    we first consider the case of a _ single _ laser beam with frequency @xmath188 and wavevector @xmath87 , which is polarized along the @xmath189 direction .    according to eq .",
    "( [ eq : sigma2_eff ] ) , the nonlinear conductivity for the case of second - harmonic generation ( shg ) is @xmath190 where @xmath191 has been introduced in eq .",
    "( [ eq : r_n ] ) and encodes the plasmonic enhancement of the second - order response due to the collective behavior of the many - electron system .",
    "notice that @xmath192 is manifestly zero in the homogeneous @xmath193 limit , in agreement with the fact that graphene is an inversion - symmetric material .",
    "illustrative plots of the second - order conductivity dipole in the case of shg are reported in fig .",
    "[ fig : d2 ] .",
    "we clearly see that @xmath172 and @xmath183 display _ two _ sharp resonances at @xmath194 and @xmath185 , while @xmath186 displays only _",
    "one _ resonance at @xmath187 .",
    "the calculation of @xmath191 requires knowledge of the first - order optical conductivity , which in the case of clean graphene at zero temperature reads as following  @xcite : @xmath195 \\right \\}~.\\ ] ] here , @xmath196 is the universal optical conductivity  @xcite .",
    "we now estimate the dimensionless _ efficiency _",
    "@xmath197 of second - harmonic nonlinear processes , as dressed by electron - electron interaction effects .",
    "using a slowly - varying envelope approximation approach and neglecting the so - called `` wavevector mismatch ''  @xcite , we find @xmath198 where @xmath199 and @xmath200 stand for incident - beam and second - harmonic - generated signal intensities , respectively .",
    "notice that @xmath201 is the real part of graphene refraction index .",
    "illustrative plots of @xmath197 for the case of clean graphene at zero temperature are reported in fig .",
    "[ fig : plasmonic_shg_thg](a ) .",
    "we clearly see two plasmon - related singularities , one located at the usual dirac plasmon pole , i.e.  at @xmath202 , and one at @xmath203 .",
    "we note that @xmath204 is the root of the equation @xmath205 = 0 $ ] for @xmath206 . in the long - wavelength limit and in the case of a free - standing graphene sheet ,",
    "linear - response theory in the rpa yields  @xcite @xmath207 , where @xmath208 is the non - interacting drude weight in graphene  @xcite .",
    "we also note that the resonance at @xmath209 is much stronger than the one at @xmath203 .",
    "the reason is that the former is due to a second - order pole , i.e.  @xmath210^{-2}$ ] near @xmath209 , while the latter one is due to a first - order pole , i.e.  @xmath211^{-1}$ ] near @xmath203 .",
    "of course , @xmath197 contains the same non - plasmonic poles of @xmath212 , which are located at @xmath213 and @xmath214 .",
    "we now proceed to discuss plasmon - related effects in the third - harmonic nonlinearity . using eq .",
    "( [ eq : sigma3_eff ] ) , the dressed third - harmonic conductivity in the long - wavelength limit reads as following : @xmath215 where @xmath216 is defined in eq .",
    "( [ eq : tilde_sigma3 ] ) and @xmath217 in eq .",
    "( [ eq : r_n ] ) .    for the case of harmonic generation and in the long - wavelength limit , we have @xmath218 + \\dots \\end{aligned}\\ ] ] in the case of graphene , @xmath219 displays  @xcite three weak ( i.e.  _ logarithmic _ ) singularities at @xmath220 , @xmath221 , and @xmath222 . on the other hand , the second - order dipole contributions",
    "@xmath223 , @xmath224 , and @xmath225 are responsible for much stronger singularities ( i.e.  first - order poles ) in @xmath226 , at the same resonant frequencies .",
    "this implies that the electron - electron interaction contribution @xmath226 to the third - order conductivity can be much larger than the bare contribution @xmath219 when @xmath188 approaches the resonant frequencies , despite the small ( but finite ) @xmath227 factor in eq .",
    "( [ eq : tilde_sigma3_xxxx ] ) .",
    "leaving aside these resonances of single - particle origin , the dressed thg conductivity @xmath228 in eq .",
    "( [ eq : plasmon - thg ] ) displays plasmon - related poles .",
    "these are due to the explicit factor @xmath229 in eq .",
    "( [ eq : plasmon - thg ] ) , but also due to the denominator @xmath230 in eq .",
    "( [ eq : tilde_sigma3_xxxx ] ) . this latter factor , in particular , is also responsible for a further enhancement of @xmath226 with respect to the bare value @xmath219 .",
    "following the same steps that led to eq .",
    "( [ eq : ishg - iin ] ) , we reach the following estimate for the third - harmonic conversion efficiency : @xmath231 illustrative plots of @xmath232 for the case of clean graphene at zero temperature are reported in figs .",
    "[ fig : plasmonic_shg_thg](b ) and  [ fig : plasmonic_shg_thg](c ) . in particular , in obtaining the results shown in fig .",
    "[ fig : plasmonic_shg_thg](b ) , we have deliberately set @xmath233 in eq .",
    "( [ eq : plasmon - thg ] ) , for illustrative purposes only .",
    "results for the case @xmath234 are presented in fig .",
    "[ fig : plasmonic_shg_thg](c ) .    in fig .",
    "[ fig : plasmonic_shg_thg](b ) , we clearly see that the quantity @xmath232 is large at @xmath209 and that it displays a weaker plasmon `` satellite '' at @xmath235 .",
    "we can further notice two more poles at @xmath236 and @xmath237 , which are visible only when they merge with the main plasmon branch and are otherwise too weak to be seen .",
    "these poles originate from the aforementioned logarithmic singularities  @xcite of the bare thg conductivity @xmath238 .    in fig .",
    "[ fig : plasmonic_shg_thg](c ) , we include also the effect of @xmath239 on @xmath232 . considering this interaction - induced nonlocal modification of the third - harmonic conductivity",
    ", we find a dramatic enhancement of all plasmonic and single - particle poles of the thg efficiency .",
    "we also see that , because of @xmath239 , an extra plasmon satellite appears at @xmath203 .",
    "the latter emerges from the denominator in eq .",
    "( [ eq : tilde_sigma3_xxxx ] ) .",
    "moreover , after taking @xmath239 into account , a single - particle pole at @xmath240 shows up , while the peaks that were barely visible in fig .",
    "[ fig : plasmonic_shg_thg](b ) at @xmath241 and @xmath221 become much stronger .",
    "we now turn to consider an experimental setup with _ two _ laser beams with frequencies @xmath242 and @xmath243 .",
    "the wavevector of each beam has in - plane , @xmath73 , and perpendicular - to - the - plane , @xmath244 , components ( with respect to the plane of the 2d electron system ) .",
    "notice that @xmath245 and @xmath246 where @xmath247 is the speed of light and @xmath248 is the angle between the @xmath249-th beam and the plane where graphene lies .",
    "fig6a(-1,90)(a )    fig6b(-1,85)(b )    fig7a(-1,89.5 ) ( a )    fig7b(-1,87 ) ( b )    using again a slowly - varying envelope approximation approach  @xcite , one can show that the output electrical signal @xmath250 is proportional to @xmath251 . in the scalar potential gauge ,",
    "the @xmath252-th component of the electric field reads as following : @xmath253 , where @xmath254 is the field amplitude .",
    "we conclude that the output electrical signal amplitude is proportional to the longitudinal component of the second - order conductivity , i.e.  @xmath255 .",
    "consequently , the conversion efficiency @xmath256 for the sum- and difference - frequency ( sf and df , respectively ) wave mixing processes can be estimated as following : @xmath257 where @xmath258 indicates the intensities of the incoming laser beams and @xmath259 corresponds to the sf / df - generated signal intensities . using eqs .",
    "( [ eq : d2l1 ] ) and ( [ eq : d2l2 ] ) , we find the following long - wavelength approximation for the longitudinal second - order conductivity :    @xmath260\\cos(\\theta+\\tilde\\theta_1 ) \\big \\ } \\nonumber\\\\ & + & \\frac{q_2}{{\\cal r}_2 } \\big \\ {   d^{(2)}_{xyyx}(-\\omega_\\sigma ; \\pm \\omega_2,\\omega_1)\\cos(\\theta+\\tilde\\theta_2 )   + \\big [ d^{(2)}_{xyxy}(-\\omega_\\sigma ; \\pm\\omega_2,\\omega_1 )   + d^{(2)}_{xyyx}(-\\omega_\\sigma ; \\pm \\omega_2,\\omega_1 )   \\big ]   \\cos(\\theta-\\tilde\\theta_2 ) \\big \\}+\\dots~. \\nonumber\\\\\\end{aligned}\\ ] ]    here , @xmath261 is the relative angle , @xmath262 , and @xmath263 in the sf and df processes , the outgoing photon has frequency @xmath264 ( @xmath265 ) and wavevector @xmath266 corresponds to the sf / df case , respectively . by changing the value of the relative angle @xmath267 , one can tune the strength of @xmath268 .",
    "we start by analyzing the main features of the _ bare _ value of @xmath256 .",
    "this is obtained by setting @xmath269 in eq .",
    "( [ eq : sigma2leff ] ) and inserting the result in eq .",
    "( [ eq : efficiency - sf - df ] ) .",
    "the corresponding numerical results are reported in fig .",
    "[ fig : ysfdfnof2 ] , where we plot @xmath256 as a function of the relative frequency @xmath270 , for a fixed value of @xmath242 , and relative angle @xmath267 . in the case of fig .",
    "[ fig : ysfdfnof2 ] , all the peaks that are seen originate from the intrinsic poles of the non - interacting second - order conductivity .",
    "we note that for @xmath271 there are sharp peaks in both @xmath272 and @xmath273 .",
    "a large peak in @xmath272 at @xmath274 ( i.e.  @xmath275 ) indicates that giant shg occurs in the quasi - homogeneous limit , which is remarkable since shg is forbidden in graphene in the homogeneous limit due to its inversion symmetry@xcite . on the other hand , a large peak in @xmath273 at @xmath274",
    "( i.e.  @xmath276 ) indicates the finiteness of the `` photon drag '' ( pd ) response  @xcite .",
    "similarly to the case of shg , optical rectification ( which is , by definition , a phenomenon occurring in the @xmath193 limit ) is forbidden in graphene because of its inversion symmetry .",
    "however , the finiteness of the second - order conductivity in the quasi - homogeneous limit enables the occurrence of the pd effect .",
    "physically , pd means that we can induce a finite dc - current , in response to two laser beams , in a system with inversion symmetry thanks to _ momentum transfer _ from the photon to the electron subsystem .",
    "we now proceed to analyze the role of electron - electron interactions . in fig .",
    "[ fig : ysfdfplasmon ] we present numerical results , which , contrary to fig .",
    "[ fig : ysfdfnof2 ] , are now obtained by taking into account the factor @xmath277 in eq .",
    "( [ eq : sigma2leff ] ) . in fig .",
    "[ fig : ysfdfplasmon](a ) , we illustrate the functional dependence of @xmath278 on @xmath270 and @xmath267 , for the case of the df wave mixing process .",
    "we have discovered that @xmath279 for the sf process , for the same parameters as in fig .",
    "[ fig : ysfdfplasmon](a ) .",
    "therefore , from now on , we concentrate only on the df wave mixing process .    in agreement with refs .  , we find that the df wave mixing process is very effective to launch dirac plasmons in graphene without the aid of a sharp afm tip  @xcite .",
    "this is because one can achieve frequency- and wavevector - matching between the outgoing photon generated in a df wave mixing process and the dirac plasmon .",
    "to this end , one needs to design the experiment in such a way to have sufficiently low - energy outgoing photons but with an in - plane wavevector which is much larger than that of incident photons .",
    "dirac plasmon launching is therefore likely to occur in the df wave mixing process  @xcite because one can simply make @xmath280 by changing the angle @xmath267 .",
    "this frequency - wavevector matching is more likely when @xmath267 approaches @xmath281 . as we can see in fig .",
    "[ fig : ysfdfplasmon ] , two plasmon resonances emerge for @xmath282 .    on the contrary , in the sf wave mixing process , the frequencies of the incoming lasers add up and result in an outgoing photon with higher frequency in comparison with that of the incident lasers . in the sf process",
    "one is not be able to fulfill the frequency - wavevector matching condition to launch low - energy dirac plasmons .",
    "electron - electron interactions alter also the pd effect in a significant manner .",
    "the bare peak at @xmath283 , which we highlighted while discussing fig .",
    "[ fig : ysfdfnof2](b ) , disappears , while two plasmon resonances emerge .",
    "the former fact happens because the @xmath284 prefactor in eq .",
    "( [ eq : sigma2leff ] ) is utterly small in the limit @xmath285 , for the case of the df wave mixing process  see the dark region in fig .",
    "[ fig : ysfdfplasmon](a ) .",
    "the reason for this behavior is easy to understand . in the df wave mixing process , @xmath286 is proportional to @xmath287 . in the limit",
    "@xmath285 ( @xmath288 ) , @xmath289 =   4e_{\\rm f } \\sigma_{\\rm uni}/(\\pi \\hbar \\omega_{\\rm df})$ ] diverges like @xmath290 ( drude peak ) , leading to a divergence in @xmath286 . in other words",
    ", the bare pd efficiency is strongly diminished due to screening . in a real system with disorder",
    ", however , the @xmath290 divergence is regularized by a finite transport time ( i.e.  the drude peak is regularized into the low - frequency drude tail ) .",
    "this implies that the pd efficiency in a disordered system is finite , contrary to the clean - limit case discussed above .",
    "fig8a(-1,72 ) ( a )    fig8b(-1,71 ) ( b )      in fig .",
    "[ fig : ydf](a ) we present the df wave mixing conversion efficiency for two different configurations of pump ( @xmath291 , @xmath292 , and @xmath293 ) and probe ( @xmath294 , @xmath295 , and @xmath296 ) laser beams , as in ref .  .",
    "the angle between the in - plane wavevectors of the two beams is @xmath297~.\\ ] ] in ref .  , the authors explored two different angular configurations : @xmath298 , @xmath299 , and @xmath300 , @xmath301 .",
    "these two cases are illustrated in fig .",
    "[ fig : ydf](a ) by means of solid and dashed curves , respectively . using eq .",
    "( [ eq : angle ] ) , we therefore find @xmath302 and @xmath303 for the solid and dashed curves in fig .",
    "[ fig : ydf](a ) , respectively .",
    "sharp plasmon resonances are seen at the frequency difference between the two incident beams .",
    "as expected , the peaks display a blue - shift as fermi energy increases .",
    "moreover , we note that the curves corresponding to a relative angle @xmath304 ( dashed curves ) show stronger resonances at a higher frequency difference , in comparison with the solid ones .",
    "this is because this value of @xmath267 enables to launch dirac plasmons with a larger wavevector ( and therefore higher energy ) , a process that occurs with a large df wave mixing conversion efficiency , as shown in fig .",
    "[ fig : ysfdfplasmon](b ) .    dashed curves in fig .  [ fig : ydf](a )",
    "indicate plasmon launching in the frequency range @xmath305-@xmath306 , in surprisingly good agreement with the experimental observation  @xcite ( i.e.  @xmath307 at @xmath308 ) , considering that our theory does not deal with substrate effects and refers to a free - standing graphene sheet . since our analysis is carried out in the case of a clean graphene sheet at zero temperature ,",
    "the value of the efficiency @xmath273 at the plasmon resonance is formally divergent and therefore impossible to be compared with the experimentally estimated dimensionless efficiency  @xcite @xmath309 .",
    "we , however , note that these formal mathematical divergencies are effectively regularized in the numerical calculations by i ) the discrete nature of the wavelength mesh in the plots and ii ) the finite value of @xmath310 , where @xmath310 has been defined in sect .",
    "[ sect : second - order - dirac ] , right after eq .",
    "( [ eq : form - factor ] ) .",
    "regarding point i ) , the numerical results in fig .",
    "[ fig : ydf ] have been obtained by using a step @xmath311 in the wavelength mesh . regarding point ii ) , the results reported in fig .",
    "[ fig : ydf ] ( and all other figures above ) have been obtained by setting @xmath312 .",
    "we now observe that the authors of ref .   interpreted their experimental data by introducing a phenomenological model , where a second - order susceptibility , denoted by the symbol @xmath313 , was taken to be _",
    "frequency- and wavevector - independent_. _ fitting _ their experimental data , the authors obtained  @xcite @xmath314 .",
    "our theory gives a formal meaning to the quantity @xmath313 , identifying it with the plasmon - enhanced second - order susceptibility of graphene ,    @xmath315    here , the @xmath68-th order nonlinear susceptibility @xmath316 is defined by the polarization response to the electric field , i.e. @xmath317 in a 2d system , the longitudinal component @xmath318 of the nonlinear susceptibility is related to the @xmath68-th order longitudinal conductivity by @xmath319 in eq .",
    "( [ eq : x2l ] ) , @xmath320 is an effective width in the direction perpendicular to the 2d electron system ( i.e.  the effective system thickness ) .",
    "numerical results for @xmath321 for the case of graphene are presented in fig .",
    "[ fig : ydf](b ) , where we have set @xmath322 . the horizontal dashed line in fig .",
    "[ fig : ydf](b ) denotes the experimental value @xmath314 .",
    "we therefore conclude that , for the aforementioned step in the wavelength mesh and value of @xmath310 , our prediction for @xmath321 on resonance matches the experimental value .",
    "we have checked that the peak value of @xmath321 in fig .",
    "[ fig : ydf](b ) increases by a factor @xmath323 when one reduces @xmath324 by a factor @xmath127 .",
    "( we have also checked that a further reduction in the value of @xmath310 by a factor @xmath325 is irrelevant . )",
    "we have presented a large-@xmath0 diagrammatic theory of plasmon - dressed second- and third - order nonlinear density response functions .",
    "our work therefore represents a natural extension of the conventional linear - response bohm - pines random phase approximation  @xcite to the realm of nonlinear response functions .",
    "our most important formal results can be found in eqs .",
    "( [ eq : chi2_rpa ] ) , ( [ eq : chi3_rpaa ] ) , and ( [ eq : chi3_rpab ] ) .",
    "while our theory is completely general , we have presented a wealth of numerical results for a specific two - dimensional material with inversion symmetry , i.e.  graphene .",
    "electrons in this material are modelled in the usual fashion , by using the massless dirac fermion model  @xcite .",
    "our most important numerical results have been summarized in figs .",
    "[ fig : d2 ] , [ fig : plasmonic_shg_thg ] , [ fig : ysfdfnof2 ] , [ fig : ysfdfplasmon ] , and  [ fig : ydf ] .",
    "more precisely , we have quantified second- and third - harmonic generation , sum- and difference - frequency wave mixing , and photon drag effects .",
    "all second - order effects ( second - harmonic generation , sum- and difference - frequency wave mixing , and photon drag effects ) in the quasi - homogeneous limit turn out to be finite and largely enhanced by plasmonic effects .",
    "detailed comparisons between our theory and available experimental results  @xcite are reported in section  [ subsection : comparison - with - experimental - results ] .",
    "this work can be generalized in the several directions .",
    "on the one hand , once can include electron - electron interaction effects beyond large-@xmath0 theory .",
    "this is notoriously difficult , although the most important corrections that are needed to deal with excitonic effects in semiconductors can be captured by ladder - type diagrams .",
    "more simply , one can take into account substrate and disorder effects , which may play an important role in establishing a truly microscopic description of nonlinear optics experiments like the one in ref .  .",
    "last but not least , we note that our formal theory can be generalized to calculate nonlinear optical properties of two- and three - dimensional electron systems hosting topological plasmon modes  @xcite , such as gapped graphene  @xcite , transition - metal dichalcogenides  @xcite , and weyl semimetals  @xcite .",
    "this work was supported by fondazione istituto italiano di tecnologia , the european union s horizon 2020 research and innovation programme under grant agreement no .",
    "696656 `` graphenecore1 '' , and the erc advanced grant 338957 femto / nano ( m.i.k . ) .",
    "koppens , d.e .",
    "chang , and f.j .",
    "garca de abajo , http://dx.doi.org/10.1021/nl201771h[nano lett .  *",
    "11 * , 3370 ( 2011 ) ] .",
    "grigorenko , m. polini , and k.s .",
    "novoselov , http://dx.doi.org/10.1038/nphoton.2012.262[nature photon .",
    "* 6 * , 749 ( 2012 ) ] .",
    "basov , m.m .",
    "fogler , a. lanzara , f. wang , and y. zhang , http://dx.doi.org/10.1103/revmodphys.86.959[rev .",
    "* 86 * , 959 ( 2014 ) ] .",
    "t. low and p. avouris , http://dx.doi.org/10.1021/nn406627u[acs nano  * 8 * , 1086 ( 2014 ) ] .",
    "f.j . garca de abajo , http://dx.doi.org/10.1021/ph400147y[acs photonics  * 1 * , 135 ( 2014 ) ] .",
    "z. fei , a.s .",
    "rodin , g.o .",
    "andreev , w. bao , a.s .",
    "mcleod , m. wagner , l.m .",
    "zhang , z. zhao , m. thiemens , g. dominguez , m.m .",
    "fogler , a.h .",
    "castro neto , c.n .",
    "lau , f. keilmann , and d.n .",
    "basov , http://dx.doi.org/10.1038/nature11253[nature  * 487 * , 82 ( 2012 ) ] .",
    "j. chen , m. badioli , p. alonso - gonzlez , s. thongrattanasiri , f. huth , j. osmond , m. spasenovi , a. centeno , a. pesquera , p. godignon , a. zurutuza elorza , n. camara , f.j .",
    "garca de abajo , r. hillenbrand , and f.h.l .",
    "koppens , http://dx.doi.org/10.1038/nature11254[nature  * 487 * , 77 ( 2012 ) ] .",
    "a.k . geim and i.v .",
    "grigorieva , http://dx.doi.org/10.1038/nature12385[nature  * 499 * , 419 ( 2013 ) ] .",
    "a.s . mayorov , r.v .",
    "gorbachev , s.v .",
    "morozov , l. britnell , r. jalil , l.a .",
    "ponomarenko , p. blake , k.s .",
    "novoselov , k. watanabe , t. taniguchi , and a.k .",
    "geim , http://dx.doi.org/10.1021/nl200758b[nano lett .  * 11 * , 2396 ( 2011 ) ] .",
    "l. wang , i. meric , p.y .",
    "huang , q. gao , y. gao , h. tran , t. taniguchi , k. watanabe , l.m .",
    "campos , d.a .",
    "muller , j. guo , p. kim , j. hone , k.l .",
    "shepard , and c.r .",
    "dean , http://dx.doi.org/10.1126/science.1244358[science  * 342 * , 614 ( 2013 ) ] .",
    "d. bandurin , i. torre , r.k .",
    "kumar , m. ben shalom , a. tomadin , a. principi , g.h .",
    "auton , e. khestanova , k.s .",
    "novoselov , i.v .",
    "grigorieva , l.a .",
    "ponomarenko , a.k .",
    "geim , and m. polini , http://dx.doi.org/10.1126/science.aad0201[science  * 351 * , 1055 ( 2016 ) ] .",
    "a. woessner , m.b .",
    "lundeberg , y. gao , a. principi , p. alonso - gonzlez , m. carrega , k. watanabe , t. taniguchi , g. vignale , m. polini , j. hone , r. hillenbrand , and f.h.l .",
    "koppens , http://dx.doi.org/10.1038/nmat4169[nature mater .  *",
    "14 * , 421 ( 2015 ) ] .",
    "alonso - gonzlez , a.y .",
    "nikitin , y. gao , a. woessner , m.b .",
    "lundeberg , a. principi , n. forcellini , w. yan , s. vlez , a.j .",
    "huber , k. watanabe , t. taniguchi , f. casanova , l.e .",
    "hueso , m. polini , j. hone , f.h.l .",
    "koppens , and r. hillenbrand , http://arxiv.org/abs/1601.05753[arxiv:1601.05753 ] ( nature nanotechnology , in press ) .",
    "jafari , http://dx.doi.org/10.1088/0953-8984/24/20/205802[j .",
    "phys . : condens .",
    "matter  * 24 * , 205802 ( 2012 ) ] .",
    "mikhailov , http://dx.doi.org/10.1103/physrevb.90.241301[phys .",
    "b  * 90 * , 241301(r ) ( 2014 ) ] ; see also erratum : http://dx.doi.org/10.1103/physrevb.91.039904[phys . rev . b  * 91 * , 039904 ( 2015 ) ] .",
    "cheng , n vermeulen , and j.e sipe , http://dx.doi.org/10.1088/1367-2630/16/5/053014[new j. phys .",
    "* 16 * , 053014 ( 2014 ) ] .",
    "wehling , a. huber , a.i .",
    "lichtenstein , and m.i .",
    "katsnelson , http://dx.doi.org/10.1103/physrevb.91.041404[phys .",
    "rev . b  * 91 * , 041404(r ) ( 2015 ) ] .",
    "cheng , n. vermeulen , and j.e .",
    "sipe , http://dx.doi.org/10.1103/physrevb.91.235320[phys .",
    "b  * 91 * , 235320 ( 2015 ) ] ; see also erratum : http://dx.doi.org/10.1103/physrevb.93.039904[phys . rev . b  * 93 * , 039904 ( 2016 ) ] .",
    "h. rostami and m. polini , http://dx.doi.org/10.1103/physrevb.93.161411[phys .",
    "b  * 93 * , 161411(r ) ( 2016 ) ] . s.a .",
    "mikhailov , http://10.1103/physrevb.93.085403[phys .",
    "b  * 93 * , 085403 ( 2016 ) ] . s.a .",
    "mikhailov , https://arxiv.org/abs/1608.00877[arxiv:1608.00877 ( 2016 ) ] .",
    "n.a . savostianova and s.a .",
    "mikhailov , https://arxiv.org/abs/1608.05975[arxiv:1608.05975 ( 2016 ) ] .",
    "cheng , n. vermeulen , and j.e .",
    "sipe , https://arxiv.org/abs/1609.06413[arxiv:1609.06413 ( 2016 ) ] .",
    "e. hendry , p.j .",
    "hale , j. moger , a.k .",
    "savchenko , and s.a .",
    "mikhailov , http://dx.doi.org/10.1103/physrevlett.105.097401[phys .",
    "lett .  * 105 * , 097401 ( 2010 ) ] .",
    "n. kumar , j. kumar , c. gerstenkorn , r. wang , h .- y .",
    "chiu , a.l .",
    "smirl , and h. zhao , http://dx.doi.org/10.1103/physrevb.87.121406[phys . rev .",
    "b  * 87 * , 121406(r ) ( 2013 ) ] . s .- y . hong , j.i .",
    "dadap , n. petrone , p .- c .",
    "yeh , j. hone , and r.m .",
    "osgood , jr .",
    ", http://dx.doi.org/10.1103/physrevx.3.021014[phys .",
    "x  * 3 * , 021014 ( 2013 ) ] .",
    "mikhailov , http://dx.doi.org/10.1103/physrevb.84.045432[phys .",
    "b  * 84 * , 045432 ( 2011 ) ] . s.a .",
    "mikhailov , http://dx.doi.org/10.1103/physrevlett.113.027405[phys .",
    "lett .  * 113 * , 027405 ( 2014 ) ] .",
    "x. yao , m. tokman , and a. belyanin , http://dx.doi.org/10.1103/physrevlett.112.055501[phys .",
    "112 * , 055501 ( 2014 ) ] .",
    "manzoni , i. silveiro , f.j .",
    "garca de abajo , and d.e .",
    "chang , http://dx.doi.org/10.1088/1367-2630/17/8/083031[new j. phys .",
    "* 17 * , 083031 ( 2015 ) ] .",
    "m. tokman , y. wang , i. oladyshkin , a.r .",
    "kutayiah , and a. belyanin , http://dx.doi.org/10.1103/physrevb.93.235422[phys . rev .",
    "b  * 93 * , 235422 ( 2016 ) ] . j.d .",
    "cox , i. silveiro , and f.j .",
    "garca de abajo , http://dx.doi.org/10.1021/acsnano.5b06110[acs nano  * 10 * , 1995 ( 2016 ) ] .",
    "constant , c.j .",
    "tollerton , e. hendry , and d.e .",
    "chang , http://arxiv.org/abs/1605.01542[arxiv:1605.01542v1 ( 2016 ) ] .",
    "constant , s.m .",
    "hornett , d.e .",
    "chang , and e. hendry , http://dx.doi.org/10.1038/nphys3545[nature phys .",
    "* 12 * , 124 ( 2016 ) ] .",
    "p. coleman , _ introduction to many - body physics _",
    "( cambridge university press , cambridge , 2016 ) .",
    "d. pines and p. nozires , _ the theory of quantum liquids _",
    "benjamin , inc .",
    ", new york , 1966 ) .",
    "g.f . giuliani and g. vignale ,",
    "_ quantum theory of the electron liquid _ ( cambridge university press , cambridge , 2005 ) .",
    "h. rostami , m.i .",
    "katsnelson , and m. polini , on the arxiv soon .",
    "m. i. katsnelson , _ graphene : carbon in two dimensions _",
    "( cambridge university press , cambridge , 2012 ) .",
    "kotov , b. uchoa , v.m .",
    "pereira , f. guinea , and a.h .",
    "castro neto , http://dx.doi.org/10.1103/revmodphys.84.1067[rev .",
    "* 84 * , 1067 ( 2012 ) ] .",
    "butcher and d. cotter , _ the elements of nonlinear optics _ ( cambridge university press , cambridge , 1990 ) .",
    "grinberg and s. luryi , http://link.aps.org/doi/10.1103/physrevb.38.87[phys .",
    "b * 38 * , 87 ( 1988 ) ] . m.m . glazov and s.d .",
    "ganichev , http://dx.doi.org/10.1016/j.physrep.2013.10.003[phys . rep .",
    "* 535 * , 101 ( 2014 ) ] .",
    "j.c.w . song and m.s .",
    "rudner , http://dx.doi.org/10.1073/pnas.1519086113[proc .",
    "( usa )  * 113 * , 4658 ( 2016 ) ] .",
    "a. kumar , a. nemilentsau , k.h .",
    "fung , g. hanson , n.x .",
    "fang , and t. low , http://dx.doi.org/10.1103/physrevb.93.041413[phys .",
    "b  * 93 * , 041413(r ) ( 2016 ) ] . r.v .",
    "gorbachev , j.c.w .",
    "song , g.l .",
    "kretinin , f. withers , y. cao , a. mishchenko , i.v .",
    "grigorieva , k.s .",
    "novoselov , l.s .",
    "levitov , and a.k .",
    "geim , http://dx.doi.org/10.1126/science.1254966[science  * 346 * , 448 ( 2014 ) ]",
    ". m. sui , g. chen , l. ma , w .- y .",
    "shan , d. tian , k. watanabe , t. taniguchi , x. jin , w. yao , d. xiao , and y. zhang , http://dx.doi.org/10.1038/nphys3485[nature phys .  * 11 * , 1027 ( 2015 ) ] .",
    "y. shimazaki , m. yamamoto , i. v. borzenets , k. watanabe , t. taniguchi , and s. tarucha , http://dx.doi.org/10.1038/nphys3551[nature phys .",
    "* 11 * , 1032 ( 2015 ) ] .",
    "m. beconcini , f. taddei , and m. polini , http://dx.doi.org/10.1103/physrevb.94.121408[phys .",
    "b  * 94 * , 121408(r ) ( 2016 ) ] . k.f .",
    "mak , k.l .",
    "mcgill , j. park , and p.l .",
    "mceuen , http://dx.doi.org/10.1126/science.1250140[science  * 344 * , 1489 ( 2014 ) ] .",
    "j. lee , k.f .",
    "mak , and j. shan , http://dx.doi.org/10.1038/nnano.2015.337[nature nanotech .  * 11 * , 421 ( 2016 ) ] .",
    "a. syntjoki , l. karvonen , h. rostami , a. autere , s. mehravar , a. lombardo , r.a .",
    "norwood , t. hasan , n. peyghambarian , h. lipsanen , k. kieu , a.c .",
    "ferrari , m. polini , and z. sun , https://arxiv.org/abs/1608.04101[arxiv:1608.04101 ( 2016 ) ] .",
    "huang , s .- y .",
    "xu , i. belopolski , c .- c .",
    "lee , g. chang , b. wang , n. alidoust , g. bian , m. neupane , a. bansil , h. lin , and m.z .",
    "hasan , http://dx.doi.org/10.1038/ncomms8373[nature commun .",
    "* 6 * , 7373 ( 2015 ) ] .",
    "x. huang , l. zhao , y. long , p. wang , d. chen , z. yang , h. liang , m. xue , h. weng , z. fang , x. dai , and g. chen , http://dx.doi.org/10.1103/physrevx.5.031023[phys .",
    "x  * 5 * , 031023 ( 2015 ) ] .",
    "weng , b.b .",
    "wang , h. miao , j. ma , p. richard , x.c .",
    "huang , l.x .",
    "zhao , g.f .",
    "chen , z. fang , x. dai , t. qian , and h. ding , http://dx.doi.org/10.1103/physrevx.5.031013[phys .",
    "x  * 5 * , 031013 ( 2015 ) ] .",
    "lv , n. xu , h.m .",
    "weng , j.z .",
    "ma , p. richard , x.c .",
    "huang , l.x .",
    "zhao , g.f .",
    "chen , c. matt , f. bisti , v. strokov , j. mesot , z. fang , x. dai , t. qian , m. shi , and h. ding , http://dx.doi.org/10.1038/nphys3426[nature phys .",
    "* 11 * , 724 ( 2015 ) ] .",
    "xu , c. liu , s.k .",
    "kushwaha , r. sankar , j.w .",
    "krizan , i. belopolski , m. neupane , g. bian , n. alidoust , t .-",
    "chang , h .-",
    "jeng , c .- y .",
    "huang , w .- f .",
    "tsai , h. lin , p.p .",
    "shibayev , f .-",
    "chou , r.j .",
    "cava , and m.z .",
    "hasan , http://dx.doi.org/10.1126/science.1256742[science  * 347 * , 294 ( 2015 ) ] .",
    "ghimire , y. luo , m. neupane , d.j .",
    "williams , e.d .",
    "bauer , and f. ronning , http://dx.doi.org/10.1088/0953-8984/27/15/152201[j .",
    "phys . : condens .",
    "matter  * 27 * , 152201 ( 2015 ) ] .",
    "pellegrino , m.i .",
    "katsnelson , and m. polini , https://doi.org/10.1103/physrevb.92.201407 [ phys .",
    "b  * 92 * , 201407(r ) ( 2015 ) ] . l.x .",
    "yang , z. k. liu , y. sun , h. peng , h.f .",
    "yang , t. zhang , b. zhou , y. zhang , y.f .",
    "guo , m. rahn , d. prabhakaran , z. hussain , s .- k .",
    "mo , c. felser , b. yan , and y.l .",
    "chen , http://dx.doi.org/10.1038/nphys3425[nature phys .",
    "* 11 * , 728 ( 2015 ) ] . c. shekhar , a.k .",
    "nayak , y. sun , m. schmidt , m. nicklas , i. leermakers , u. zeitler , y. skourski , j. wosnitza , z. liu , y. chen , w. schnelle , h. borrmann , y. grin , c. felser , and b. yan , http://dx.doi.org/10.1038/nphys3372[nature phys .",
    "* 11 * , 645 ( 2015 ) ] .",
    "xu , i. belopolski , n. alidoust , m. neupane , g. bian , c. zhang , r. sankar , g. chang , z. yuan , c .- c .",
    "huang , h. zheng , j. ma , d.s .",
    "sanchez , b. wang , a. bansil , f. chou , p.p .",
    "shibayev , h. lin , s. jia , and m.z .",
    "hasan , http://dx.doi.org/10.1126/science.aaa9297[science  * 349 * , 613 ( 2015 ) ] . s .-",
    "xu , i. belopolski , d.s .",
    "sanchez , c. zhang , g. chang , c. guo , g. bian , z. yuan , h. lu , t .-",
    "chang , p.p .",
    "shibayev , m.l .",
    "prokopovych , n. alidoust , h. zheng , c .- c .",
    "huang , r. sankar , f. chou , c .- h .",
    "jeng , a. bansil , t. neupert , v.n .",
    "strocov , h. lin , s. jia , and m.z .",
    "hasan , http://dx.doi.org/10.1126/sciadv.1501092[science adv .  * 1 * , e1501092 ( 2015 ) ] . s .-",
    "xu , i. belopolski , d.s .",
    "sanchez , m. neupane , g. chang , k. yaji , z. yuan , c. zhang , k. kuroda , g. bian , c. guo , h. lu , t .-",
    "chang , n. alidoust , h. zheng , c .- c .",
    "huang , c .- h .",
    "jeng , a. bansil , t. neupert , f. komori , t. kondo , s. shin , h. lin , s. jia , and m.z .",
    "hasan , http://dx.doi.org/10.1103/physrevlett.116.096801[phys .",
    "lett .  * 116 * , 096801 ( 2016 ) ] .",
    "h. inoue , a. gyenis , z. wang , j. li , s.w .",
    "oh , s. jiang , n. ni , b.a .",
    "bernevig , and a. yazdani , http://dx.doi.org/10.1126/science.aad8766[science  * 351 * , 1184 ( 2016 ) ] .",
    "g. chang , s .- y .",
    "sanchez , s .-",
    "huang , c .- c .",
    "chang , g. bian , h. zheng , i. belopolski , n. alidoust , h .-",
    "jeng , a. bansil , h. lin , and m.z .",
    "hasan , http://dx.doi.org/10.1126/sciadv.1600295[science adv .",
    "* 2 * , e1600295 ( 2016 ) ] .",
    "l. wu , s. patankar , t. morimoto , n.l .",
    "nair , e. thewalt , a. little , j.g .",
    "analytis , j.e .",
    "moore , and j. orenstein , https://arxiv.org/abs/1609.04894v1[arxiv:1609.04894v1 ] .",
    "in this appendix we derive eqs .",
    "( [ eq : chi2_rpa ] ) , ( [ eq : chi3_rpaa ] ) , and  ( [ eq : chi3_rpab ] ) by using the so - called time - dependent hartree approximation ( tdha )  @xcite .",
    "we define the @xmath68-th order density response function of an interacting electron system as the @xmath68-th order functional derivative of the charge density with respect to the external scalar potential . for the first- , second- , and third - order density response functions we have @xmath326 @xmath327~,\\end{aligned}\\ ] ] and @xmath328~. \\nonumber\\\\\\end{aligned}\\ ] ] these definitions imply that the response functions are fully symmetric with respect to permutations of the variables @xmath329 for @xmath330 .    in the spirit of time - dependent density functional theory  @xcite , we can build effectively non - interacting ( i.e.  kohn - sham ) response functions by differentiating the time - dependent density with respect to a suitable effective potential . in the spirit of the tdha",
    ", the effective potential is solely given by the hartree self - consistent potential : @xmath331 where @xmath332 is the vacuum permittivity .",
    "the resulting tdha response functions are given by : @xmath333 @xmath334 and @xmath335 below , we will be using the following very useful functional derivative : @xmath336 where @xmath337 indicates the dirac delta function .",
    "after simple algebraic manipulations , eq .",
    "( [ eq : useful_functional_derivative ] ) becomes @xmath338 we now note that @xmath339 in fourier transform with respect to space , @xmath340 where @xmath341 [ @xmath342 for three - dimensional [ two - dimensional ] systems .",
    "for the sake of notational simplicity , we will use from now on the following shorthand : @xmath343 , @xmath344 , etc .",
    "for example , eq .  ( [ eq : useful_functional_derivative_last ] ) reads as following : @xmath345      using the definitions given in the previous section , we can write the following relation for the first - order density response function : @xmath346 or , more explicitly , @xmath347 in a compact matrix - form notation , eq .",
    "( [ eq : chi1 ] ) reads as following : @xmath348 in fourier transform , the well - known rpa equation  @xcite ( [ eq : chi1 ] ) becomes @xmath349 for translationally - invariant systems , eq .",
    "( [ eq : linear - response - rpa - general ] ) simplifies to the following well - known rpa result  @xcite : @xmath350 we also introduce the rpa dynamical screening function  @xcite : @xmath351 using @xmath352 , we can rewrite eq .",
    "( [ eq : linear - response - rpa - translationally - invariant ] ) as following : @xmath353      we now proceed to derive explicit expressions for the _ second - order _ density response . in this case , we need to perform the functional derivative of the first - order response @xmath354 with respect to the external field , as indicated in the second line of eq .",
    "( [ eq : chi2_def ] ) . using the representation of @xmath355 given in eq .",
    "( [ eq : chi1 ] ) inside eq .",
    "( [ eq : chi2_def ] ) , we find : @xmath356~.\\end{aligned}\\ ] ] we now need to calculate @xmath357 \\nonumber\\\\   & = & \\chi^{(2)}_0(1,2,3)+ \\int d4 \\int d5 ~\\chi^{(2)}_0(1,2,4 ) v(4,5 )   \\chi^{(1)}(5,3)~.\\end{aligned}\\ ] ] using eq .",
    "( [ eq : d_chi1_0_dv ] ) in eq .",
    "( [ eq : chi2_eq1 ] ) , together with the definitions given in eqs .",
    "( [ eq : chi1_def ] ) , ( [ eq : chi2_def ] ) , and  ( [ eq : chi3_def ] ) , we finally obtain : @xmath358 since the above result is symmetric with respect to the interchange of labels `` 2 '' and `` 3 '' , we have dropped the permutation sign , i.e.  @xmath167 .",
    "we can rewrite eq .",
    "( [ eq : second - order - intermediate ] ) as @xmath359 \\chi^{(2)}(5,2,3 )   = \\nonumber \\\\ & & \\sum'_{\\cal p } \\int d4 \\int d5 ~ \\chi^{(2)}_0(1,4,5 )   \\left [ \\tilde \\delta(5,3)+ \\int d6~   v ( 5,6 ) \\chi^{(1)}(6,3)\\right ]   \\left [ \\tilde \\delta(4,2)+ \\int d7~ v ( 4,7 )   \\chi^{(1)}(7,2 ) \\right ] ~.\\end{aligned}\\ ] ] using the following matrix - form notation @xmath360 and eq .",
    "( [ eq : epsilon1 ] ) , we can write the following compact expression for the second - order response function : @xmath361   \\chi^{(2)}_0    \\left [ 1 + v ~\\chi^{(1 ) }   \\right ] \\left [ 1+v ~\\chi^{(1 ) }   \\right ] ~.\\ ] ] more explicitly , @xmath362   \\chi^{(2)}_0(1',2',3 ' )    \\left [   \\tilde\\delta(3',3)+   \\int d5 ~ v(3',5 ) \\chi^{(1)}(5,3 )   \\right ]   \\nonumber \\\\ & \\times & \\left [ \\tilde\\delta(2',2)+ \\int d6 ~ v(2',6 ) \\chi^{(1)}(6,2 )   \\right ]   \\bigg \\}~.\\end{aligned}\\ ] ] in fourier transform and considering energy conservation , we find @xmath363    \\chi^{(2)}_0(-{\\bm q}'_1,-{\\bm q}'_2,-{\\bm",
    "q}'_3,-\\omega_\\sigma,\\omega_2,\\omega_3 )    \\nonumber\\\\ & \\times &    \\left [ 1 +    v_{{\\bm q}'_3 } \\chi^{(1)}({\\bm q}'_3,{\\bm q}_3,-\\omega_3,\\omega_3 )   \\right ]    \\left [ 1 +    v_{{\\bm q}'_2 } \\chi^{(1)}({\\bm q}'_2,{\\bm q}_2,-\\omega_2,\\omega_2 )   \\right ] ~,\\end{aligned}\\ ] ] where @xmath364 .",
    "in the case of translationally - invariant systems , the previous equation simplifies to @xmath365   \\chi^{(2)}_0(-{\\bm q}_\\sigma,{\\bm q}_2,{\\bm q}_3,-\\omega_\\sigma,\\omega_2,\\omega_3 )   \\nonumber\\\\ & \\times &    \\left [ 1 +    v_{{\\bm q}_3 } \\chi^{(1)}(-{\\bm q}_3,{\\bm q}_3,-\\omega_3,\\omega_3)\\right ]    \\left [ 1 +    v_{{\\bm q}_2 } \\chi^{(1)}(-{\\bm q}_2,{\\bm q}_2,-\\omega_2,\\omega_2)\\right ] ~,\\end{aligned}\\ ] ] where @xmath366 . using eq .",
    "( [ eq : epsilon1 ] ) inside eq .",
    "( [ eq : chi2-translationally - invariant ] ) , we finally reach eq .",
    "( [ eq : chi2_rpa ] ) in the main text .",
    "finally , in this section we derive an explicit expression for the third - order response in the tdha . in this case , we need to take the functional derivative of the second - order response @xmath25 with respect to the external field , as in the second line of eq .",
    "( [ eq : chi3_def ] ) . to this end",
    ", we first simplify the real - space representation of the second - order response : @xmath367 also , we need the following functional derivative : @xmath368~.\\end{aligned}\\ ] ] using eqs .",
    "( [ eq : chi3_def ] ) , ( [ eq : chi2_eq3 ] ) , and  ( [ eq : dchi2_0_dv ] ) and carrying out lengthy but straightforward algebra , we find : @xmath369 \\nonumber \\\\ & + &   \\int d1 ' \\int d4 '   ~ \\chi^{(2)}(1,4',4 ) v(4',1 ' )   \\chi^{(2)}_0(1',2,3 )    \\nonumber\\\\ & + & \\int d1 ' \\int d4 ' \\int d5 '   ~ \\chi^{(1)}(1,4 ' ) v(4',1 ' )   \\chi^{(3)}_0(1',2,3,5 ' )   \\left [ \\tilde\\delta(5',4 ) + \\int d6 ' ~ v(5',6 ' ) \\chi^{(1)}(6',4 ) \\right ] \\nonumber \\\\ & + &   \\int d3 ' \\int d4 '   ~ \\chi^{(2)}_0(1,2,3 ' ) v(3',4 ' ) \\chi^{(2)}(4',3,4 ) \\nonumber\\\\ & + & \\int d3 ' \\int d4 ' \\int d5 '   ~ \\chi^{(2)}_0(1,2,3',5 ' )   \\left [ \\tilde\\delta(5',4 ) + \\int d6 ' ~ v(5',6 ' ) \\chi^{(1)}(6',4 ) \\right ] v(3',4 ' ) \\chi^{(1)}(4',3 ) \\nonumber \\\\ & + &    \\int d2 ' \\int d4 ' ~   \\chi^{(2)}_0(1,2',3 )   v(2',4 ' ) \\chi^{(2)}(4',2,4 ) \\nonumber\\\\ & + & \\int d3 ' \\int d4 ' \\int d5 '   ~ \\chi^{(3)}_0(1,2',3,5 ' ) \\left [ \\tilde\\delta(5',4 ) + \\int d6 ' ~ v(5',6 ' ) \\chi^{(1)}(6',4 ) \\right ]   v(2',4 ' ) \\chi^{(2)}(4',2 )   \\nonumber \\\\ & + & \\int d1 ' \\int d3 ' \\int d4 ' \\int d5 ' ~ \\chi^{(2)}(1,4',4 ) v(4',1 ' )   \\chi^{(2)}_0(1',2,3 ' )   v(3',5 ' ) \\chi^{(1)}(5',3 )   \\nonumber\\\\ & + & \\int d1 ' \\int d3 ' \\int d4 ' \\int d5 ' ~\\chi^{(1)}(1,4 ' ) v(4',1 ' )   \\chi^{(2)}_0(1',2,3 ' )   v(3',5 ' ) \\chi^{(2)}(5',3,4 ) \\nonumber \\\\   & + & \\int d1 ' \\int d3 ' \\int d4 ' \\int d5 ' \\int d6 ' ~\\chi^{(1)}(1,4 ' ) v(4',1 ' )   \\chi^{(3)}_0(1',2,3',6 ' ) \\left [ \\tilde\\delta(6',4 ) + \\int d7 ' ~ v(6',7 ' )",
    "\\chi^{(1)}(7',4 ) \\right ]    \\nonumber \\\\ & \\times & v(3',5 ' ) \\chi^{(1)}(5',3 ) \\nonumber\\\\ & + & \\int d1 ' \\int d2 ' \\int d4 ' \\int d6'~ \\chi^{(2)}(1,4',4 ) v(4',1 ' )   \\chi^{(2)}_0(1',2',3 )   v(2',6 ' ) \\chi^{(1)}(6',2 ) \\nonumber\\\\ & + & \\int d1 ' \\int d2 ' \\int d4 ' \\int d6'~ \\chi^{(1)}(1,4 ' ) v(4',1 ' )   \\chi^{(2)}_0(1',2',3 )   v(2',6 ' ) \\chi^{(2)}(6',2,4 ) \\nonumber \\\\ & + & \\int d1 ' \\int d2 ' \\int d4 ' \\int d5 ' \\int d6'~ \\chi^{(1)}(1,4 ' ) v(4',1 ' )   \\chi^{(3)}_0(1',2',3,5 ' ) \\left [ \\tilde\\delta(5',4 ) + \\int d7 ' ~ v(5',7 ' ) \\chi^{(1)}(7',4 ) \\right ]   \\nonumber \\\\ & \\times & v(2',6 ' ) \\chi^{(1)}(6',2 ) \\nonumber \\\\ & + & \\int d2 ' \\int d3 ' \\int d4 ' \\int d5 ' ~    \\chi^{(2)}_0(1,2',3 ' ) v(3',4 ' ) \\chi^{(2)}(4',3,4 ) v(2',5 ' ) \\chi^{(1)}(5',2 ) \\nonumber\\\\ & + & \\int d2 ' \\int d3 ' \\int d4 ' \\int d5 ' ~    \\chi^{(2)}_0(1,2',3 ' ) v(3',4 ' ) \\chi^{(1)}(4',3 ) v(2',5 ' ) \\chi^{(2)}(5',2,4 ) \\nonumber \\\\ & + & \\int d2 ' \\int d3 ' \\int d4 ' \\int d5 ' \\int d6 ' ~    \\chi^{(3)}_0(1,2',3',6 ' ) \\left [ \\tilde\\delta(6',4 ) + \\int d7 ' ~v(6',7 ' ) \\chi^{(1)}(7',4 ) \\right ] v(3',4 ' ) \\chi^{(1)}(4',3 )   \\nonumber \\\\ & \\times & v(2',5 ' ) \\chi^{(1)}(5',2 ) \\nonumber\\\\ & + & \\int d1 ' \\int d2 ' \\int d3 ' \\int d4 ' \\int d5 ' \\int d6 ' ~",
    "\\chi^{(2)}(1,4',4 ) v(4',1 ' ) \\chi^{(2)}_0(1',2',3 ' ) v(3',5 ' ) \\chi^{(1)}(5',3 ) v(2',6 ' ) \\chi^{(1)}(6',2 ) \\nonumber\\\\ & + & \\int d1 ' \\int d2 ' \\int d3 ' \\int d4 ' \\int d5 ' \\int d6 ' ~   \\chi^{(1)}(1,4 ' ) v(4',1 ' ) \\chi^{(2)}_0(1',2',3 ' ) v(3',5 ' ) \\chi^{(2)}(5',3,4 ) v(2',6 ' ) \\chi^{(1)}(6',2 ) \\nonumber\\\\ & + & \\int d1 ' \\int d2 ' \\int d3 ' \\int d4 ' \\int d5 ' \\int d6 ' ~   \\chi^{(1)}(1,4 ' ) v(4',1 ' ) \\chi^{(2)}_0(1',2',3 ' ) v(3',5 ' ) \\chi^{(1)}(5',3 ) v(2',6 ' ) \\chi^{(2)}(6',2,4 ) \\nonumber\\\\ & + & \\int d1 ' \\int d2 ' \\int d3 ' \\int d4 ' \\int d5 ' \\int d6 ' \\int d7 ' ~   \\chi^{(1)}(1,4 ' ) v(4',1 ' ) \\chi^{(3)}_0(1',2',3',7 ' )   \\nonumber \\\\ & \\times & \\left [ \\tilde\\delta(7',4 ) + \\int d8 ' ~v(7',8 ' ) \\chi^{(1)}(8',4 ) \\right ]   v(3',5 ' ) \\chi^{(1)}(5',3 ) v(2',6 ' ) \\chi^{(1)}(6',2 ) \\bigg \\}~.\\end{aligned}\\ ] ] the previous expression contains terms that vanish in the limit @xmath370 : the sum of all these terms will be denoted by the symbol @xmath41 .",
    "however , we also notice the presence of terms that do _ not _ contain the non - interacting third - order response function @xmath371 .",
    "rather , they contain the non - interacting second - order response @xmath24 .",
    "the sum of all these terms will be denoted by the symbol @xmath42 . in the diagrammatic language , the former family is depicted in fig .",
    "[ fig : chi3_rpa ] , while the latter is depicted in fig .",
    "[ fig : chi3_bis_rpa ] .    using eq .",
    "( [ eq : chi3-full - tdha ] ) and fourier transforming , we find that the quantity @xmath41 obeys the following equation : @xmath372 \\nonumber\\\\ & & +   \\sum_{{\\bm q}'_2 { \\bm q}'_4}\\chi^{(3)}_0({\\bm q}_1,{\\bm q}'_2,{\\bm q}_3,{\\bm q}'_4,-\\omega_\\sigma,\\omega_2,\\omega_3,\\omega_4 )    \\left [ 1 +    v_{{\\bm q}'_4 } \\chi^{(1)}(-{\\bm q}'_4,{\\bm q}_4,-\\omega_4,\\omega_4 )   \\right ]   v_{{\\bm q}'_2 }   \\chi^{(1 ) } ( -{\\bm q}'_2,{\\bm q}_2,-\\omega_2,\\omega_2 ) \\nonumber\\\\   & & +   \\sum_{{\\bm q}'_3 { \\bm q}'_4}\\chi^{(3)}_0({\\bm q}_1,{\\bm q}_2,{\\bm q}'_3,{\\bm q}'_4,-\\omega_\\sigma,\\omega_2,\\omega_3,\\omega_4 )    \\left [ 1 +    v_{{\\bm q}'_4 }   \\chi^{(1)}(-{\\bm q}'_4,{\\bm q}_4,-\\omega_4,\\omega_4 )   \\right ]   v_{{\\bm q}'_3 } \\chi^{(1)}(-{\\bm q}'_3,{\\bm q}_3,-\\omega_3,\\omega_3 ) \\nonumber\\\\   & & +   \\sum_{{\\bm q}'_1 { \\bm q}'_4}\\chi^{(1)}({\\bm q}_1,-{\\bm q}'_1,-\\omega_\\sigma , \\omega_\\sigma ) v_{{\\bm q}'_1 } \\chi^{(3)}_0({\\bm q}'_1,{\\bm q}_2,{\\bm q}_3,{\\bm q}'_4,-\\omega_\\sigma,\\omega_2,\\omega_3,\\omega_4 ) \\left [ 1 +    v_{{\\bm q}'_4 } \\chi^{(1)}(-{\\bm q}'_4,{\\bm q}_4,-\\omega_4,\\omega_4 )   \\right ]     \\nonumber \\\\   & & +   \\sum_{{\\bm q}'_1 { \\bm q}'_3 { \\bm q}'_4}\\chi^{(1)}({\\bm",
    "q}_1,-{\\bm q}'_1,-\\omega_\\sigma,\\omega_\\sigma ) v_{{\\bm q}'_1 } \\chi^{(3)}_0({\\bm q}'_1,{\\bm q}_2,{\\bm q}'_3,{\\bm q}'_4,-\\omega_\\sigma,\\omega_2,\\omega_3,\\omega_4 )    \\left [ 1 +   v_{{\\bm q}'_4 } \\chi^{(1)}(-{\\bm q}'_4,{\\bm q}_4,-\\omega_4,\\omega_4 )    \\right ]    \\nonumber \\\\ & & \\times v_{{\\bm q}'_3 } \\chi^{(1)}(-{\\bm q}'_3,{\\bm q}_3,-\\omega_3,\\omega_3 )   \\nonumber\\\\ & & + \\sum_{{\\bm q}'_1 { \\bm q}'_2 { \\bm q}'_4}\\chi^{(1)}({\\bm q}_1,-{\\bm q}'_1,-\\omega_\\sigma,\\omega_\\sigma ) v_{{\\bm q}'_1 } \\chi^{(3)}_0({\\bm q}'_1,{\\bm q}'_2,{\\bm q}_3,{\\bm q}'_4,-\\omega_\\sigma,\\omega_2,\\omega_3,\\omega_4 )    \\left [ 1 +   v_{{\\bm q}'_4 } \\chi^{(1)}(-{\\bm q}'_4,{\\bm q}_4,-\\omega_4,\\omega_4 )    \\right ]    \\nonumber \\\\ & & \\times v_{{\\bm q}'_2 } \\chi^{(1)}(-{\\bm q}'_2,{\\bm q}_2,-\\omega_2,\\omega_2 )   \\nonumber\\\\ & & + \\sum_{{\\bm q}'_2 { \\bm q}'_3 { \\bm q}'_4 } \\chi^{(3)}_0({\\bm q}_1,{\\bm q}'_2,{\\bm q}'_3,{\\bm q}'_4,-\\omega_\\sigma,\\omega_2,\\omega_3,\\omega_4 )     \\left [ 1 +   v_{{\\bm q}'_4 } \\chi^{(1)}(-{\\bm q}'_4,{\\bm q}_4,-\\omega_4,\\omega_4 )    \\right ]    v_{{\\bm q}'_3 } \\chi^{(1)}(-{\\bm q}'_3,{\\bm q}_3,-\\omega_3,\\omega_3 )     \\nonumber \\\\ & & \\times v_{{\\bm q}'_2 } \\chi^{(1)}(-{\\bm q}'_2,{\\bm q}_2,-\\omega_2,\\omega_2 )   \\nonumber\\\\ & & + \\sum_{{\\bm q}'_1 { \\bm q}'_2 { \\bm q}'_3 { \\bm q}'_4}\\chi^{(1)}({\\bm q}_1,-{\\bm q}'_1,-\\omega_\\sigma,\\omega_\\sigma ) v_{{\\bm q}'_1 } \\chi^{(3)}_0({\\bm q}'_1,{\\bm q}'_2,{\\bm q}'_3,{\\bm q}'_4,-\\omega_\\sigma,\\omega_2,\\omega_3,\\omega_4 )    \\left [ 1 +   v_{{\\bm q}'_4 } \\chi^{(1)}(-{\\bm q}'_4,{\\bm q}_4,-\\omega_4,\\omega_4 )    \\right ]    \\nonumber \\\\ & & \\times v_{{\\bm q}'_3 } \\chi^{(1)}(-{\\bm q}'_3,{\\bm q}_3,-\\omega_3,\\omega_3 )   v_{{\\bm q}'_2 } \\chi^{(1)}(-{\\bm q}'_2,{\\bm q}_2,-\\omega_2,\\omega_2 )   \\bigg \\}~,\\end{aligned}\\ ] ] while the quantity @xmath42 is given by @xmath373 as usual , for translationally - invariant systems , we can use momentum conservation ( i.e.  @xmath374 ) for each response function .",
    "after lengthy but straightforward algebra , one reaches eqs .",
    "( [ eq : chi3_rpaa ] ) and  ( [ eq : chi3_rpab ] ) in the main text .",
    "since the second - order dipole @xmath375 is a rank-@xmath127 tensor , it obeys the same symmetries of the third - order conductivity as in eqs .",
    "( [ eq : sym3_1 ] ) and ( [ eq : sym3_2 ] ) .",
    "the following equations follow from this observation : @xmath376 and @xmath377 where @xmath119 is given by @xmath378 according to the intrinsic permutation symmetry of the second - order conductivity , we have @xmath379 + q_{2,\\beta }   \\big [ d^{(2)}_{\\ell \\alpha_1\\alpha_2\\beta,2}(-\\omega_\\sigma;\\omega_1,\\omega_2 ) -d^{(2)}_{\\ell \\alpha_2 \\alpha_1\\beta,1}(-\\omega_\\sigma;\\omega_2,\\omega_1 ) \\big ] \\bigg \\ } + \\dots \\equiv 0~.\\end{aligned}\\ ] ] we therefore can conclude that @xmath380 .",
    "this implies the following result @xmath381 using eq .",
    "( [ eq : d2_derv ] ) we can conclude @xmath129 . using the above equations , we obtain eqs .",
    "( [ eq : d2l1 ] ) and  ( [ eq : d2l2 ] ) in the main text .",
    "taking the derivative in eq .",
    "( [ eq : d2_derv ] ) , performing the integral over the polar angle of the vector @xmath382 , and summing over the band indices @xmath383 in eq .",
    "( [ eq : pi2 ] ) , we arrive at the following expression for @xmath172 : @xmath384   \\nonumber \\\\&+ & \\kappa\\int^{\\infty}_{0 }   de   \\left",
    "[ n'_{\\rm f}(e ) f_1(e )   -   n'_{\\rm f}(-e ) f_1(-e ) \\right ] \\nonumber \\\\&+ & \\kappa\\int^{\\infty}_{0 }   de   \\left",
    "[ n''_{\\rm f}(e ) f_2(e )   -    n''_{\\rm f}(-e ) f_2(-e ) \\right ] \\nonumber \\\\&+ & \\kappa\\int^{\\infty}_{0 }   de   \\left",
    "[ n'''_{\\rm f}(e ) f_3(e )   -   n'''_{\\rm f}(-e ) f_3(-e ) \\right ] ~.\\end{aligned}\\ ] ] here , @xmath385 , @xmath386 is the usual the fermi - dirac distribution function at finite temperature @xmath387 and chemical potential @xmath388 , @xmath389 @xmath390~,\\end{aligned}\\ ] ] @xmath391~,\\end{aligned}\\ ] ] @xmath392~,\\ ] ] and @xmath393 integrating by parts eq .",
    "( [ eq : to - be - integrated ] ) , we reach @xmath394 where @xmath395 + \\left ( \\frac{\\omega_\\sigma}{\\omega_1   } \\right)^2 \\left [ \\frac{1}{(2e+\\hbar\\omega_\\sigma)^2 } - \\frac{1 } { ( 2e-\\hbar\\omega_\\sigma)^2 } \\right ] \\right \\}\\end{aligned}\\ ] ] and @xmath396 + n'_{\\rm f}(e ) \\left [ f_2(e ) -f'_3(e ) \\right ] + n''_{\\rm f}(e ) f_3(e)~.\\ ] ] at zero temperature ,",
    "@xmath397 @xmath398 and @xmath399 since @xmath400 is an odd function of @xmath401 , we conclude that @xmath402 f(e ) - \\kappa \\frac{2\\hbar\\omega_1+\\hbar\\omega_2}{4(\\hbar\\omega_1)^2 \\hbar\\omega_2\\hbar\\omega_\\sigma}~.\\ ] ] carrying out the integration in eq .",
    "( [ eq : d2xxxx_int ] ) , we finally get eq .",
    "( [ eq : d2xxxx ] ) in the main text ."
  ],
  "abstract_text": [
    "<S> we develop a microscopic large-@xmath0 theory of electron - electron interaction corrections to multi - legged feynman diagrams describing second- and third - order nonlinear response functions . our theory , which reduces to the well - known random phase approximation in the linear - response limit , is completely general and is useful to understand all second- and third - order nonlinear effects , including harmonic generation , wave mixing , and photon drag . </S>",
    "<S> we apply our theoretical framework to the case of graphene , by carrying out microscopic calculations of the second- and third - order nonlinear response functions of an interacting two - dimensional ( 2d ) gas of massless dirac fermions . </S>",
    "<S> we compare our results with recent measurements , where all - optical launching of graphene plasmons has been achieved by virtue of the finiteness of the quasi - homogeneous second - order nonlinear response of this inversion - symmetric 2d material . </S>"
  ]
}