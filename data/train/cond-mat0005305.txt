{
  "article_text": [
    "this paper discusses approximate ground - state wave functions for inhomogeneous interacting many - electron systems such as solids .",
    "in particular , we consider wave functions of the slater - jastrow type , @xmath0 , where @xmath1 is a slater determinant and @xmath2 , the jastrow factor , takes account of the electronic correlations .",
    "we have two main aims : we wish to devise a method for generating inhomogeneous jastrow factors appropriate for use in strongly inhomogeneous solids ; and we wish to understand the surprisingly accurate results obtained when slater - jastrow trial functions are used in variational ( v ) and diffusion ( d ) quantum monte carlo ( qmc ) simulations@xcite of weakly - correlated solids such as silicon . despite the apparent simplicity of the slater - jastrow form , cohesive energies calculated using vqmc are typically an order of magnitude more accurate@xcite than cohesive energies obtained using hartree - fock ( hf ) or density - functional theory within the local density approximation ( lda).@xcite cohesive energies calculated using dqmc are even more accurate .",
    "this is not the place for a general introduction to qmc ( see hammond _",
    "et al._@xcite for a review ) , but a brief sketch of the vqmc method may be helpful .",
    "the idea is to obtain an approximate many - electron ground state by numerically optimizing an explicit parametrized trial wave function .",
    "once this has been done , the calculation of expectation values reduces to the evaluation of multi - dimensional integrals .",
    "ordinary integration methods using a grid become very inefficient when the dimension of the integral is greater than 5 or 10 ( equivalent to a 2 or 3 electron system in three dimensions ) , and so the integrals are evaluated using monte carlo integration.@xcite this approach scales much more favorably with the dimension than grid - based integration methods .",
    "the trial wave functions used in most qmc simulations contain a slater determinant of lda or hf orbitals and a jastrow factor that includes pairwise correlation terms , @xmath3 , and one - electron terms , @xmath4 , where @xmath5 and @xmath6 are the position and spin component of electron @xmath7 .",
    "the @xmath8 and @xmath9 functions are usually obtained by optimizing specific parametrized functional forms according to the variational principle . in simulations of solids , it is common to simplify the optimization by insisting that @xmath8 be both homogeneous and isotropic ( i.e. , @xmath10 is assumed to depend only on the interelectronic distance @xmath11 ) .",
    "by contrast , our principal aim is to derive a physically - motivated inhomogeneous and anisotropic jastrow factor for nonuniform systems , based on a generalization of the random - phase approximation ( rpa ) of bohm and pines.@xcite this will enable us to reduce or even dispense with the time - consuming optimization procedure .",
    "the rpa is known to give unphysical results in some cases and is not generally regarded as an accurate quantitative method . here , however , we use the rpa only to guide the construction of an approximate trial wave function . once this wave function has been chosen , energies are calculated using the true interacting many - electron hamiltonian instead of the approximate rpa form .",
    "the results are therefore variational and much more accurate than standard rpa energies .",
    "the rpa theory of the _ homogeneous _ electron gas is already used in the construction of jastrow factors for qmc simulations.@xcite this approach predicts that the @xmath8 function should decay like @xmath12 for large @xmath13 , but says nothing about the @xmath9 function ( which is zero in a homogeneous system ) or the short - range behavior of @xmath8 .",
    "although it is easy to modify the @xmath8 function to make it have the correct cusp - like behavior at short range , the absence of @xmath9 terms implies that the homogeneous rpa jastrow factor produces inaccurate densities , and hence poor energies , when used in strongly inhomogeneous systems .",
    "this problem is usually fixed by adding a parametrized @xmath9 function and optimizing the parameters numerically.@xcite    here , we generalize the rpa theory to _ inhomogeneous _ systems ( see malatesta@xcite and fahy@xcite for an alternative approach ) .",
    "we obtain a correlation term that is truly inhomogeneous and anisotropic . furthermore , as originally noted by malatesta _",
    "et al._,@xcite we find that the inhomogeneous rpa theory automatically produces a jastrow factor containing @xmath9 terms .",
    "the short - range behavior of the inhomogeneous rpa @xmath8 function is no better than that of the homogeneous version but is more difficult to correct .",
    "we impose the required short - range cusps using a @xmath14-space method which , although approximate , works well .",
    "an interesting aspect of the inhomogeneous rpa theory is that it provides a justification for using slater determinants consisting of lda or hf orbitals .",
    "this is common practice but is not obviously correct : one might guess that the hf orbitals that are optimal in the absence of a jastrow factor would no longer be accurate in its presence .",
    "in fact , the rpa theory shows that hf or lda orbitals are close to optimal whether or not an rpa jastrow factor is present .",
    "we test our inhomogeneous rpa jastrow factor by carrying out vqmc calculations for a strongly inhomogeneous electron gas .",
    "we find that the inhomogeneous rpa @xmath9 functions are of such high quality that there is no need to resort to the standard but costly numerical optimization methods .",
    "surprisingly , however , we gain almost no advantage by using inhomogeneous @xmath8 functions : a jastrow factor consisting of a homogeneous @xmath8 function plus any good @xmath9 function gives almost the same results .",
    "inhomogeneous @xmath8 functions are often used in full core atomic and molecular calculations@xcite but do not seem necessary in the strongly inhomogeneous electron gases studied here .",
    "some recent vqmc simulations by hood@xcite and nekovee@xcite suggest a possible explanation for this observation . although our system has a strongly inhomogeneous exchange - correlation hole",
    "@xmath15 n({\\bf r}')$ ] , the lda seems to provide a better description of the pair - correlation function @xmath16 .",
    "the use of a strongly inhomogeneous @xmath8 function may therefore be unnecessary .",
    "in agreement with previous work@xcite we conclude that the most important features of the jastrow factor are ( i ) that the corresponding slater - jastrow wave function produces an accurate electron density , and ( ii ) that the @xmath8 function has the correct cusp - like behavior whenever two electrons approach each other . as long as both these conditions are satisfied , the calculated energies are normally quite accurate .    in summary ,",
    "the five main results of our paper are :    1 .",
    "we have extended the rpa to inhomogeneous systems .",
    "we have used the inhomogeneous rpa theory to derive expressions for the @xmath9 function and for the long - range behaviour of the fully inhomogeneous @xmath8 function .",
    "we have developed a general method for imposing a cusp on any inhomogeneous jastrow factor expressed in @xmath14-space .",
    "4 .   the inhomogeneous rpa analysis has enabled us to explain why slater - jastrow - type wave functions containing lda or hf orbitals work so well .",
    "we have implemented and tested the inhomogeneous rpa jastrow factor and found that the calculated one - body term works perfectly , but that the inhomogeneity of the two - body term contributes little to the energy at typical valence electron densities .",
    "the rest of this paper is organized as follows . in sec .",
    "[ sec : qmc ] we describe the slater - jastrow trial wave functions used in most qmc simulations of atoms , molecules , and solids . section [ sec : rpa ] presents the rpa theory of the inhomogeneous electron gas and explains how it leads to slater - jastrow trial wave functions containing both @xmath9 terms and inhomogeneous @xmath8 terms . to supplement the somewhat mathematical presentation in sec .",
    "[ sec : rpa ] , appendix [ sec : appa ] describes the rpa in more physical terms . section [ sec : results ] discusses the results of the vqmc simulations we have done to test the inhomogeneous rpa jastrow factor , and sec .",
    "[ sec : conclusions ] concludes .",
    "the aim of this paper is to provide a better physical understanding of the success of the slater - jastrow trial wave functions used in many qmc calculations of atoms , molecules , and weakly correlated solids .",
    "a slater - jastrow trial function is the product of a totally antisymmetric slater determinant @xmath1 and a totally symmetric jastrow factor @xmath17 .",
    "the slater determinant is often split into two smaller determinants , one for each spin value :    @xmath18    this spoils the antisymmetry of the trial wave function on interchange of electrons of opposite spin , but does not affect expectation values of spin - independent operators.@xcite since two smaller determinants are easier to deal with than one big one , it also reduces the numerical complexity of the problem .",
    "the orbitals used in @xmath19 and @xmath20 are normally obtained from lda or hf calculations .",
    "the slater determinants build in exchange effects but neglect the electronic correlations caused by the coulomb interactions .",
    "the most important correlation effects occur when pairs of electrons approach each other , and these may be included by choosing a pairwise jastrow factor of the form ,    @xmath21    where @xmath22 . because the lda or hf orbitals in @xmath19 and @xmath20 already give a reasonably good approximation to the density , the introduction of a two - body @xmath8 function usually causes the density of the many - electron wave function to deteriorate . as a result",
    "the trial energy deteriorates too .",
    "it is therefore necessary to introduce one - body @xmath9 terms to adjust the jastrow factor :    @xmath23    note the sign conventions here : our definition of @xmath8 is the negative of that used by many other authors .",
    "most authors also omit the diagonal @xmath24 terms in the sum over @xmath7 and @xmath25 , but we find it mathematically convenient to include them in our analysis . in homogeneous systems",
    "the diagonal terms only affect the normalization of the trial function , while in inhomogeneous systems they add one - body contributions that may be accounted for by a simple redefinition of @xmath26 .",
    "since we are using periodic boundary conditions , it will often prove convenient to express the electron density and jastrow factor in reciprocal space :    @xmath27    note that we are using a symmetric definition of the fourier transformation ; the corresponding back transformation is @xmath28 .",
    "several different types of jastrow factor are in common use :    1 .",
    "jastrow factors based on the rpa theory of the uniform electron gas in the form due to bohm and pines.@xcite ( in this paper we show how to generalization this approach to obtain jastrow factors for strongly inhomogeneous systems . )",
    "jastrow factors based on the rpa theory of the uniform electron gas in the form due to gaskell.@xcite this type of jastrow factor has been widely used by ceperley and coworkers.@xcite 3 .",
    "jastrow factors obtained by the numerical optimization of a parametrized functional form . in most cases the optimization is carried out using the variance minimization technique in the form developed by umrigar.@xcite 4 .",
    "jastrow factors derived using the fermi hypernetted chain approximation as given by krotscheck et al .",
    "@xcite      in this section we deduce the short - range behavior of @xmath8 .",
    "when the distance @xmath29 between two electrons approaches zero , the potential energy in the hamiltonian operator diverges like @xmath12 .",
    "( except where otherwise stated , we use hartree atomic units , @xmath30 , throughout this paper . ) since , for any exact eigenstate , @xmath31 is proportional to @xmath32 , this coulomb divergence must be cancelled by an equal and opposite divergence in the kinetic energy terms .",
    "when choosing a trial wave function for use in a qmc simulation , it is important to ensure that this exact cancellation still occurs . if it does not , the local energy @xmath33 , which is the quantity actually sampled in the simulation , diverges as @xmath13 approaches zero , causing numerical difficulties .    since",
    ", away from the nuclei , the single - particle orbitals are smooth functions of the electronic coordinates , the determinantal part of the trial wave function depends smoothly on the positions of the electrons . for small @xmath34 , it may therefore be expanded in the form : @xmath35 the application of the kinetic energy operator to this series produces a smooth function of @xmath34 , whereas the application of the potential energy operator places a divergent @xmath12 factor in front of every term .",
    "it is clear that a trial function containing only the slater determinants does not show the required cancellation of potential and kinetic energy divergences .",
    "the cancellation may however be imposed by modifying the terms of the expansion as follows : @xmath36 each term in the series is multiplied by a factor , @xmath37 , which includes a cusp at @xmath38 . the numerical constant @xmath39 in front of the cusp",
    "is @xmath40 , where @xmath41 is the order of @xmath42 in the original expansion .",
    "a convenient way to introduce a cusp - like term is to include it in the jastrow factor @xmath17 in such a way that the cusp terms @xmath43 or @xmath44 appear in the expansion of @xmath17 for small @xmath13 .",
    "as we only have one jastrow factor we can only hope to deal with one of the terms in the expansion of @xmath45 correctly ; we choose the lowest order term that is nonzero , as this is the one that causes the divergence in the local energy @xmath46 .",
    "if electrons @xmath7 and @xmath25 have antiparallel spins , the lowest order term is the constant @xmath47 ; for parallel spins , @xmath45 is an antisymmetric function of @xmath48 and so the lowest order term is @xmath49 .",
    "the required cusp may thus be introduced by imposing the following conditions on @xmath50 : @xmath51    for antiparallel spins , and    @xmath52    for parallel spins.@xcite      as will be explained in sec .",
    "[ sec : rpa ] , the rpa theory of bohm and pines@xcite suggests that the long - range behavior of the correlation term @xmath8 in a homogeneous electron gas of number density @xmath41 should take the form :    @xmath53    where @xmath54 is the plasma frequency .",
    "this spin - independent two - body term has no cusp and is only expected to be correct for large @xmath13 .",
    "multiplying eq .",
    "( [ bpf ] ) by @xmath55 yields    @xmath56    which approaches eq .",
    "( [ bpf ] ) for large @xmath13 and also has the correct cusp behavior if @xmath57 is chosen appropriately .",
    "because of the spin dependence of the cusp conditions , we need different values of @xmath58 for parallel- and antiparallel - spin electrons . by expanding eq .",
    "( [ homu ] ) to first order in @xmath13 , we see that the cusp conditions eq .",
    "( [ cca ] ) and eq .",
    "( [ ccp ] ) become    @xmath59    for antiparallel spins , and    @xmath60    for parallel spins .",
    "the @xmath9 function needed to counteract the density - adjusting effects of the @xmath8 function is normally obtained by numerical optimization .",
    "if we wish to avoid this costly procedure we have several options :    1 .",
    "we could use no one - body term and hope for the best .",
    "this is the correct thing to do in a homogeneous system and also proves satisfactory in cases when the spatial variation of the charge density is much more rapid than that of the @xmath8 function . 2 .",
    "we could use the result of sec .",
    "[ sec : rpa ] and include a one - body term of the form : @xmath61 3 .",
    "we could use a one - body term as given by malatesta _",
    "et al._@xcite : @xmath62    in cases when the @xmath8 function is homogeneous ,    @xmath63    we get    @xmath64    and so eq .",
    "( [ fchi ] ) reduces to eq .",
    "( [ fahychi ] ) . option",
    "( 2 ) therefore reduces to option ( 3 ) . strictly speaking",
    ", however , @xmath8 is never exactly homogeneous unless the electron density is exactly uniform , in which case both options ( 2 ) and ( 3 ) merely state that @xmath65 .",
    "this section starts with a brief introduction to the ideas behind the standard rpa treatment of homogeneous systems.@xcite we then generalize the rpa theory to inhomogeneous systems .",
    "this generalization shows us how to construct approximate ground - state wave functions of the slater - jastrow type .",
    "the rpa forms of the @xmath8 and @xmath9 functions are closely related and both depend on the electron density .",
    "let us first give a brief overview of the standard rpa as formulated for homogeneous systems .",
    "the starting point is the usual hamiltonian ,    @xmath66    of a uniform electron gas in a volume @xmath67 .",
    "note that we have adopted a slightly unusual definition of the number density operator ,    @xmath68    which includes a @xmath69 factor in order to be consistent with the symmetric definition of the fourier transform used throughout this paper .",
    "the @xmath14-points are chosen in accordance with the geometry of the system , which is taken to obey periodic boundary conditions .",
    "the system is assumed to be charge neutral and so the @xmath70 terms are omitted from the @xmath14-space summations .",
    "as we are interested in describing the long - range correlations due to the electron - electron interaction , we wish to make a connection between the hamiltonian of eq .",
    "( [ eq : hbasic ] ) and the long wavelength density fluctuations known as plasmons .",
    "our eventual aim is to split the hamiltonian into an electronic term with short - range interactions and a plasmon term that is only weakly coupled to the electrons .",
    "once the electron and plasmon parts of the hamiltonian have been ( almost ) decoupled in this way , we shall see that the long - range correlations are described by the ground - state wave function of the plasmon part , which is simply a set of quantum mechanical harmonic oscillators . at shorter wavelengths the plasmons",
    "are not well defined and the collective plasmon description of electronic correlation ceases to be valid . instead , the electrons feel a short - range screened interaction that produces additional electron - electron scattering - like correlations .",
    "the assumption of weak plasmon - electron interaction is reasonable at small @xmath14 since long wavelength plasmons are long lived . for larger @xmath14 values , however , the almost flat plasmon dispersion curve runs into the continuum of electron - hole pair excitations and the plasmons are no longer well defined . in a uniform electron gas",
    "this happens at a wave vector @xmath71 given by@xcite    @xmath72    where @xmath73 is the fermi wave vector , @xmath74 is the radius of a sphere containing one electron on average , and @xmath75 , the bohr radius , is the atomic unit of length .",
    "this estimate of the cutoff should also be applicable to inhomogeneous systems as long as the density does not vary too much .",
    "we see that for typical metals with @xmath76 values of 2 or 3 the cutoff is of the order of the fermi wave vector .",
    "we also see that the higher the density the better the plasmon description should be .",
    "the inverse of @xmath71 is a measure of the minimum length scale on which the electronic correlations may be described in terms of plasmons .",
    "the first step in the derivation of the homogeneous rpa@xcite is to introduce a new pair of conjugate operators , @xmath77 and @xmath78 , for every wave vector @xmath79 with modulus @xmath80 .",
    "these operators act in a new hilbert space that we call the _ oscillator space _ , and transform like @xmath81 under hermitian conjugation : @xmath82 and @xmath83 .",
    "the physical and oscillator hilbert spaces are quite distinct , and so @xmath84 and @xmath78 commute with @xmath85 and @xmath86 . for the time being @xmath84 and @xmath87",
    "have little physical meaning , but later in the derivation they will become associated with the plasmon coordinates .",
    "the oscillator - space operators are now used to define a new hamiltonian ,    @xmath88    which acts in an enlarged hilbert space that is the product of the physical space and the oscillator space .",
    "the bohm - pines hamiltonian @xmath89 may be written in the form    @xmath90    and so its eigenvalue spectrum is bounded below .",
    "we now restrict our attention to those states @xmath91 from the enlarged hilbert space that satisfy the _",
    "subsidiary condition _ :    @xmath92    any state obeying eq .",
    "( [ subcon1 ] ) may be written in the form @xmath93@xmath94@xmath95 , where @xmath96 is a state in the physical hilbert space and @xmath97@xmath94@xmath98 is the oscillator - space state satisfying    @xmath99    ( the bold symbol @xmath100 is shorthand for the vector of all the @xmath101 with @xmath102 . ) the set of product - space states satisfying the subsidiary condition may therefore be put into one - to - one correspondence with the set of physical states .",
    "equally , given any eigenstate @xmath96 with eigenvalue @xmath103 of the original hamiltonian , the product state @xmath104 ) , and is an eigenstate of eq .",
    "( [ newh ] ) with the same energy .",
    "this is because all the new terms in @xmath89 involve @xmath84 and hence give zero when operating on @xmath97@xmath94@xmath105 .",
    "as long as the subsidiary condition is obeyed , the additional degrees of freedom may simply be regarded as dummy variables , both in the wave function and the hamiltonian .",
    "it will be proved later on in this paper that the overall ground state @xmath106 of the extended hamiltonian , eq .",
    "( [ newh ] ) , _ automatically _ satisfies the subsidiary condition , eq .",
    "( [ subcon1 ] ) .",
    "the physical - space part of the ground state of @xmath89 is therefore the ground state of the original hamiltonian , and we might as well study the ground - state properties of the extended hamiltonian as those of the original .",
    "the next stage in the derivation is to make a unitary transformation , which will be described in more detail in sec .",
    "[ alg.2 ] .",
    "once the extended bohm - pines hamiltonian has been transformed and several supposedly small terms have been dropped , the transformed hamiltonian may be written as the sum of a spatial hamiltonian with a short - range interaction ,    @xmath107    and an oscillator - like plasmon term ,    @xmath108    where @xmath109 is the plasma frequency .",
    "one of the approximations made during the derivation of these results involves the replacement of an exponential factor of the form @xmath110 $ ] by its average value .",
    "since the electronic positions @xmath111 are effectively random in a homogeneous system , the phase of the exponential is also random unless @xmath112 , and so the average is @xmath113 if @xmath114 or zero otherwise .",
    "this is the eponymous random - phase approximation .",
    "the approximate hamiltonian ,    @xmath115    still includes short - range electron - electron interactions and so can not be solved exactly .",
    "we may , however , use the hf method or the lda to obtain approximate eigenstates of @xmath116 .",
    "these approximate eigenstates , which are of course slater determinants , may then be multiplied by eigenstates of the oscillator hamiltonian , eq .",
    "( [ hp ] ) , to obtain approximate eigenstates of the full hamiltonian @xmath117 .",
    "the unitary transformation may then be inverted to obtain approximate eigenstates of @xmath89 .",
    "unlike the exact ground state , the resulting approximate ground state of @xmath89 does not satisfy the subsidiary condition , eq .",
    "( [ subcon1 ] ) , exactly .",
    "it may , however , be projected onto the subspace of states that do satisfy the subsidiary condition to obtain an approximate ground state in the physical hilbert space .",
    "this approximate physical ground state has the homogeneous slater - jastrow form ,    @xmath118   d(\\ { { \\bf x}_{i } \\ } ) \\;,\\ ] ]    where @xmath119 and @xmath120 describes the position and spin component of electron @xmath7 .",
    "the rpa @xmath8 function is therefore independent of spin and proportional to @xmath12 at large @xmath13 .",
    "as noted earlier , the cutoff wave vector @xmath121 is usually chosen to be of the order of the fermi wave vector @xmath122 .",
    "the aim is to find an approximate ground state @xmath123 with energy @xmath124 of the following hamiltonian :    @xmath125    where @xmath126 is an applied potential .",
    "the `` physical '' hilbert space in which this hamiltonian acts will be denoted @xmath127 . for reasons that will become clear later on , it is sometimes convenient to rewrite @xmath128 in the form ,    @xmath129    where @xmath130 is defined via :    @xmath131    and the @xmath132 are arbitrary numbers satisfying @xmath133 .",
    "let us now introduce conjugate pairs of operators , @xmath134 and @xmath135 , acting in a different hilbert space @xmath136 , which we call the oscillator space .",
    "the `` momentum '' operator @xmath134 and the `` position '' operator @xmath135 are taken to be the fourier transforms of field operators @xmath137 and @xmath138 :    @xmath139    @xmath140    which satisfy the commutation relation    @xmath141 =   -i\\delta({\\bf r}-{\\bf r } ' ) \\;.\\ ] ]    it therefore follows that @xmath142 and @xmath143 obey    @xmath144= -i\\delta_{{\\bf k},{\\bf k } ' } \\;.\\ ] ]    we can form an extended hilbert space by taking the product space @xmath145 . if we denote the identity operators in the real and oscillator spaces by @xmath146 and @xmath147 respectively , we can define extended - space operators such as @xmath148 and @xmath149 corresponding to any operator belonging to one or other of the constituent hilbert spaces .",
    "it is obvious that all the extended `` @xmath150 '' operators commute with all the extended `` @xmath151 '' operators . from now on we shall omit the identity operators and drop all `` @xmath151 '' , `` @xmath150 '' , and `` @xmath152 '' subscripts .",
    "operators will always be denoted using hats , and so anything without a hat may be assumed to be a ( possibly complex ) number .",
    "now consider the hermitian _ extended hamiltonian _ ,    @xmath153    which is an operator in the extended hilbert space @xmath154 .",
    "note that the potential @xmath155 is still the same as given by eq .",
    "( [ npot ] ) ; the variables @xmath132 that were used to construct @xmath155 have not been replaced by operators in @xmath136 , but remain ordinary complex numbers .",
    "because @xmath156 and @xmath157 commute they may be diagonalized simultaneously , and hence all eigenstates of the extended hamiltonian @xmath89 may be written in the form @xmath158 , where @xmath159 for all @xmath102 .",
    "let @xmath123 and @xmath160 be the ground - state wave function and ground - state eigenvalue of the physical hamiltonian @xmath128 . if we define an eigenstate @xmath161 of the @xmath134 operators such that @xmath162 for all @xmath102",
    ", it follows that @xmath163 is an eigenstate of @xmath89 with the same eigenvalue @xmath124 .",
    "it need not , however , be the ground state of @xmath89 , which might correspond to a different wave function @xmath164 .",
    "the question that now arises is how to choose the constants @xmath132 ( and hence the modified potential @xmath155 ) such that @xmath163 is in fact the ground state of @xmath89 and not just some other eigenstate . in other words",
    ", we have to find a link between the @xmath132 and @xmath123 .",
    "this can be achieved using the hellmann - feynman theorem .",
    "consider the lowest energy state @xmath165 corresponding to some fixed oscillator - space eigenstate @xmath166 .",
    "the energy eigenvalue of @xmath167 will be denoted @xmath168 .",
    "when @xmath89 acts on @xmath169 , the operators @xmath134 may be replaced by their eigenvalues @xmath170 , and hence @xmath171 is in fact the ground state of    @xmath172    note that @xmath173 operates not in the extended hilbert space but in @xmath127 .",
    "furthermore , it is important to keep in mind that @xmath155 is formed using the as yet unknown numbers @xmath132 .",
    "the overall ground state of @xmath89 corresponds to the minimum of @xmath174 with respect to .",
    "as we are now looking at a standard quantum mechanical problem formulated in the physical hilbert space @xmath175 , the hellmann - feynman theorem gives :    @xmath176    where @xmath171 is assumed normalized .",
    "if the overall ground state of @xmath89 occurs when @xmath177 , it follows that :    @xmath178    we wish to choose the constants @xmath132 such that @xmath179 , since in this case we have already argued that the physical - space part @xmath180 of the bohm - pines ground state    @xmath181 .",
    "the sought after link between @xmath123 and the @xmath132 is therefore :    @xmath182    where @xmath183 is a fourier component of the ground - state electron density @xmath184 . note that eq .",
    "( [ numb1 ] ) is _ not _ an operator equation ; it simply links one number , @xmath185 , to another , @xmath186 .",
    "since all the @xmath134 operators have @xmath102 , eq .",
    "( [ numb1 ] ) only applies when @xmath102",
    ".    we still have to verify that the stationary point @xmath187 is in fact the minimum of @xmath188 .",
    "( [ stationary ] ) determines the slope at any given @xmath100 .",
    "the matrix of second derivatives of @xmath168 , which determines the curvature , may therefore be obtained by differentiating eq .",
    "( [ stationary ] ) :    @xmath189    where    @xmath190    is the static susceptibility matrix and @xmath191 is the inverse dielectric matrix .",
    "if we make the reasonable assumption that all the eigenvalues of the dielectric matrix are positive,@xcite it follows that all the eigenvalues of the matrix of second derivatives of @xmath174 are also positive . the stationary point given by eq .",
    "( [ min1 ] ) is then a minimum .",
    "( [ min1 ] ) is the generalization to inhomogeneous systems of the `` subsidiary condition '' of bohm and pines.@xcite it can be rewritten as    @xmath192    where    @xmath193    and has to be obeyed by @xmath106 , the exact ground state of @xmath89 . in the case of a homogeneous system ,",
    "( [ sc1 ] ) reduces to @xmath194 as derived by bohm and pines.@xcite    the effect of the subsidiary condition is to reduce the number of degrees of freedom of the extended hilbert space @xmath195 .",
    "the reduced hilbert space satisfying the subsidiary condition is spanned by the set of eigenstates of @xmath89 of the form @xmath196 , where    @xmath197    if we have set the parameters @xmath198 using eq .",
    "( [ numb1 ] ) , the states @xmath96 are then eigenfunctions of the _ original _ hamiltonian , eq .",
    "( [ horig ] ) .",
    "this follows from the definition of the potential @xmath130 , which is such that the hamiltonian in eq .",
    "( [ hpi ] ) is the same as the original hamiltonian of eq .",
    "( [ horig ] ) when the value of @xmath199 is consistent with the subsidiary condition : @xmath200 .",
    "the subspace singled out by the subsidiary condition eq .",
    "( [ sc1 ] ) is thus equivalent to the original hilbert space @xmath127 .",
    "let us now use the subsidiary condition to evaluate @xmath201 and @xmath202 .",
    "for @xmath201 we get    @xmath203    where @xmath204 is the long wavelength ( @xmath205 ) part of the ground - state electron density and @xmath206 is the periodic ( ewald - summed ) coulomb interaction .",
    "the constant @xmath201 is therefore the long wavelength contribution to the hartree energy .",
    "for @xmath207 we get    @xmath208    and hence    @xmath209 = 4\\pi n^{l}({\\bf r } ) \\;.\\ ] ]    @xmath202 is therefore the hartree potential corresponding to the long wavelength fourier components of the electronic charge density .",
    "because @xmath202 is subtracted from @xmath126 to give @xmath130 , the extended hamiltonian @xmath156 contains a reduced external potential .",
    "the long - range part of the mutual repulsion of the electrons has been absorbed into the plasmon degrees of freedom via the subsidiary condition .      we have now concluded that we can concentrate on the ground state of the bohm - pines hamiltonian , @xmath89 , from eq .",
    "( [ eq : hbp ] ) instead of the ground state of the original hamiltonian from eq .",
    "( [ horig ] ) , provided we choose the constants @xmath132 and hence the effective potential @xmath155 in accordance with eq .",
    "( [ numb1 ] ) .",
    "the oscillator - space part of the ground state @xmath106 of @xmath89 is then equal to @xmath210 , and the real - space part is the physical ground state @xmath123 .",
    "( [ numb1 ] ) specifies @xmath132 in terms of the ground - state density , which is obtained by solving @xmath89 .",
    "unfortunately , this hamiltonian depends on the parameters @xmath132 calculated from its ground state , and so we are faced with a self - consistency problem analogous to those encountered in bandstructure calculations .",
    "we could in principle devise an iterative algorithm to home in on a self - consistent solution , but this is unnecessary .",
    "we only need the ground - state density , not the wave function itself , and it is known that the lda gives reasonably good ground - state densities in most solids . in practice , therefore , we can use the lda density @xmath211 to obtain a good approximation for @xmath132 :    @xmath212    unsurprisingly , the bohm - pines extended hamiltonian can not be solved exactly .",
    "it may , however , be solved approximately by means of a unitary transformation.@xcite we use the unitary operator    @xmath213\\ ] ]    to transform an eigenstate @xmath91 of @xmath89 into an eigenstate    @xmath214    of the transformed hamiltonian @xmath215 .",
    "( in general , all operators transform according to @xmath216 . )",
    "the position operators @xmath85 and @xmath135 are unchanged by the transformation because they commute with @xmath217 .",
    "the momentum operators transform as follows :    @xmath218    where @xmath219 is a unit vector in the @xmath79 direction .",
    "the transformations of the momentum operators may be checked using the general expansion ,    @xmath220 + \\frac{1}{2}\\left[\\hat{x},\\left[\\hat{x},\\hat{o}\\right]\\right ] + \\ldots \\;,\\ ] ]    with @xmath221 .",
    "when @xmath222 is one of the momentum operators , @xmath134 or @xmath223 , the first commutator @xmath224 $ ] only contains position operators , and so higher order commutators such as @xmath225 $ ] all vanish .",
    "the final result of the unitary transformation defined by eq .  ( [ utr ] ) is the hamiltonian :    @xmath226    which is obtained by replacing @xmath227 and @xmath134 in eq .",
    "( [ eq : hbp ] ) by @xmath228 and @xmath229 .",
    "the subsidiary condition becomes    @xmath230    where    @xmath231    we now make the random - phase approximation , which amounts to replacing the @xmath232 factor in the fourth line of eq .",
    "( [ brpa ] ) by its ground - state expectation value . in uniform systems",
    "the electronic positions @xmath5 are random and so the phases are also random ; the expectation value of @xmath233 is therefore equal to @xmath234 . in inhomogeneous systems we have to evaluate the expectation value of the ( untransformed ) operator @xmath233 in the transformed ground state @xmath235 .",
    "since the density operator @xmath236 commutes with the unitary transformation , it follows that    @xmath237    the required expectation value of @xmath238 is therefore equal to the fourier component @xmath239 of the ground - state electron density of the original ( untransformed ) bohm - pines hamiltonian from eq .",
    "( [ eq : hbp ] ) .",
    "the term on the third line of eq .",
    "( [ brpa ] ) may be rewritten as    @xmath240    where @xmath241 is the current density operator . following bohm and pines,@xcite this plasmon - electron coupling term",
    "will be neglected . to justify this approximation ( and indeed the rpa )",
    "we can appeal to the measured physical properties of interacting electron gases ; we know that the plasmons are well defined when @xmath102 , and hence that the plasmon - electron coupling terms must indeed be small .    a more physical discussion of the rpa may be found in appendix  [ sec : appa ] .",
    "the two approximations described above decouple the electrons and plasmons and reduce the transformed hamiltonian of eq .",
    "( [ brpa ] ) to the rpa hamiltonian @xmath242 .",
    "the first two lines of eq .",
    "( [ brpa ] ) yield the short - range electronic hamiltonian ,    @xmath243    and the last two lines yield the plasmon hamiltonian ,    @xmath244    where the matrix @xmath245 is given by    @xmath246    and we have introduced a position dependent _ local plasma frequency _ defined by @xmath247 .",
    "the full ground state of @xmath117 is the product of the ground states of @xmath116 and @xmath248 .",
    "if we choose to work in a representation in which the @xmath249 operators are diagonal , the plasmon ground state takes the standard simple harmonic oscillator form :    @xmath250 \\;.\\ ] ]    the matrix @xmath251 is well defined since all the eigenvalues of the hermitian matrix @xmath245 are greater than zero . the fact that the @xmath134 and @xmath135 operators are non - hermitian may cause some confusion here , but one can easily rewrite the @xmath14-space hamiltonian of eq .",
    "( [ rpaham ] ) in real space using eqs .",
    "( [ opdef1 ] ) and ( [ opdef2 ] ) .",
    "the real - space operators @xmath252 and @xmath253 are hermitian , and so the plasmon hamiltonian is then a set of coupled hermitian harmonic oscillators .",
    "the ground state of these oscillators is    @xmath254 \\;,\\ ] ]    which reduces to eq .",
    "( [ pgs ] ) when re - expressed in @xmath14-space .",
    "if we make use of the expression for @xmath155 from eq .",
    "( [ npot ] ) and the condition @xmath255 from eq .",
    "( [ numb1 ] ) , the short - range hamiltonian of eq .",
    "( [ hsrc ] ) becomes :    @xmath256    the first two lines are identical to the original hamiltonian , eq .",
    "( [ horig ] ) , but with the small @xmath14 ( long wavelength ) contributions to the electron - electron interactions omitted .",
    "the third line is the hartree potential corresponding to those long wavelength coulomb interactions ,    @xmath257    and the fourth line is the hartree energy , which is subtracted to prevent double counting .",
    "the short - range hamiltonian is therefore equivalent to the original hamiltonian , eq .",
    "( [ horig ] ) , but with the long wavelength parts of the coulomb interaction treated within the hartree approximation .",
    "since the long wavelength parts of the effective potentials used in hartree - fock and lda calculations are both dominated by the hartree contributions , we might equally well say that @xmath116 is equivalent to the original hamiltonian but with the small @xmath14 coulomb interactions approximated using hartree - fock or lda , provided the hf or lda densities are sufficiently similar to the exact ground state density .",
    "the short - range hamiltonian still contains the full coulomb interaction for @xmath258 , and so still diverges like @xmath12 whenever two electrons approach each other .",
    "the electron - electron cusps therefore appear in the short - range electronic wave function , not in the jastrow factor that describes the plasmons .    in practice , of course , we do not attempt to solve @xmath116 exactly , but treat it within an independent electron approach such as hartree - fock or lda .",
    "this additional approximation replaces the short - range part of the electron - electron interaction by a mean field , which simply adds to the long wavelength mean field already introduced by the rpa .",
    "the overall effect is equivalent to starting from the original hamiltonian and replacing the _ full _ interaction by a mean field .",
    "this implies that one can obtain the short - range `` electronic '' part of the rpa wave function by starting from the original fully interacting hamiltonian and treating it using any sensible mean - field approximation .",
    "the best single - particle orbitals to use in the slater determinant are therefore very close to the familiar hartree - fock or lda orbitals ; they are not significantly altered by the presence of the rpa jastrow factor from eq .",
    "( [ rpajas ] ) .",
    "one drawback of treating the short - range hamiltonian within a mean - field approximation is that this neglects the electron - electron cusps that should be present in the short - range electronic wave function .",
    "the cusps play an important role in reducing the total energy of the many - electron system , and so the trial wave function may be significantly improved by building them into the jastrow factor .",
    "the ground state of @xmath117 is the product of the ground states of @xmath116 and @xmath248 , neither of which commutes with the transformed subsidiary condition , eq .",
    "( [ sc2.1 ] ) .",
    "this implies that , unlike the ground state of @xmath259 , the ground state of @xmath117 need not obey the subsidiary condition automatically . in consequence",
    ", the approximate ground state of @xmath89 obtained by applying the back transformation , @xmath260 , to the ground state of @xmath117 , need not be an eigenfunction of the plasmon momentum operators , and we can no longer extract an approximation to the spatial ground state by simply forgetting about the @xmath166 factor in a product wave function of the form @xmath261 .",
    "fortunately , however , the subsidiary condition is still exact ( no approximations were made in transforming it ) , and so still defines the subspace of the extended hilbert space in which the true ground state lies .",
    "we can therefore take the ground state of the approximate hamiltonian , @xmath117 , and project it onto that subspace .",
    "the projection operator may be applied before or after the back transformation , but if we choose to make the back transformation first it is not difficult to see that the required projection operator is    @xmath262    as discussed in sec .",
    "[ alg.3b ] , we approximate the ground state of @xmath116 as a slater determinant @xmath1 , and so the approximate ground state of the full hamiltonian @xmath117 is @xmath263 . we can now obtain an approximate ground state of the original hamiltonian @xmath89 by back transforming using the inverse of the unitary transformation .",
    "the only important effect of the back transformation is to shift the numbers @xmath264 appearing in @xmath265 by @xmath266 :    @xmath267    where @xmath119 .",
    "this can be verified by observing that , when evaluating a back - transformed wave function @xmath268 , we can apply the transformation to the bra @xmath269 rather than the ket @xmath270 .",
    "but since    @xmath271    we see that    @xmath272    the @xmath134 eigenvalues of the transformed bra are therefore shifted by @xmath273 relative to those of the original bra . as a result ,",
    "@xmath274 .    applying the projection operator given in eq .",
    "( [ prop ] ) replaces the remaining @xmath101 by @xmath275 .",
    "( in the homogeneous case this is zero . ) all in all , then , the spatial part of the approximation to the ground state is    @xmath276 d \\;,\\ ] ]    where    @xmath277_{{\\bf k},{\\bf k } ' } } { k k ' }   \\left ( \\frac{e^{i{\\bf k}'\\cdot{\\bf r}'}}{\\sqrt{v } }   - \\frac{\\langle\\hat{n}_{{\\bf k}'}\\rangle_0}{n } \\right ) \\left   .",
    "\\rule{0cm}{6 mm } \\right ] .",
    "\\nonumber \\\\\\end{aligned}\\ ] ]    the rpa jastrow factor includes constant terms , one - electron terms , and two - electron terms .",
    "the constant terms may be ignored as they only affect the normalization of the wave function .",
    "the remaining one- and two - electron terms may then be disentangled and the jastrow factor rewritten in the form ,    @xmath278 \\;,\\ ] ]    where @xmath279 and @xmath280 are defined via :    @xmath281_{{\\bf k } , { \\bf k } ' } } { k k ' }   e^{i{\\bf k } ' \\cdot { \\bf r } ' } , \\ ] ]    and    @xmath282_{{\\bf k } , { \\bf k } ' } } { k k ' }   \\langle\\hat{n}_{{\\bf k}'}\\rangle_0 \\\\ & = & -\\int_{v } u({\\bf r},{\\bf r } ' ) n^{l}({\\bf r}')d^{3}r ' \\;,\\end{aligned}\\ ] ]    where , as in eq .",
    "( [ deltae ] ) , @xmath283 is the long wavelength @xmath102 part of the ground - state electron density . the derivation of eq .",
    "( [ fchi1 ] ) made use of the symmetry @xmath284 , which follows from eq .",
    "( [ mkk ] ) . in @xmath14-space ,",
    "the relationship between @xmath8 and @xmath9 takes the form ,    @xmath285    discussed in sec .",
    "[ subsec : qmc - chi ] .    in a homogeneous system , eq .",
    "( [ mkk ] ) states that @xmath286 .",
    "the @xmath9 function therefore vanishes and the @xmath8 function becomes    @xmath287    transforming to real space we obtain    @xmath288    if @xmath71 is set equal to infinity this gives    @xmath289    for finite @xmath71 , the divergence of @xmath290 at small @xmath291 is suppressed , but the @xmath292 decay at large @xmath291 remains more or less unaltered .",
    "section [ subsec : qmc - rpau ] explained how cusps may be built in to a homogeneous rpa jastrow factor by adding an exponential factor to the @xmath8 function :    @xmath293    at large @xmath294 this @xmath8 function has the @xmath295 behavior implied by the rpa , while at small @xmath294 it tends smoothly towards the required cusp at @xmath296 . when supplemented by appropriate @xmath9 functions ,",
    "such jastrow factors are remarkably successful .",
    "it is therefore worth considering how we might add cusps to our inhomogeneous rpa @xmath8 function .",
    "this is not easy , since the inhomogeneous @xmath8 function is given as a complicated truncated double fourier series .",
    "the series determines the behavior of @xmath279 when @xmath297 is large , and we have to find a way of splicing this known long - range behavior onto the cusp at small @xmath297 .",
    "the cusp fixes the slope of @xmath279 as @xmath298 , but does not determine its position - dependent value at the point @xmath299 .",
    "this makes it difficult to implement simple interpolation schemes that use different functions to describe @xmath8 at small and large @xmath297 .",
    "the introduction of a multiplicative factor , as in the homogeneous @xmath8 function of eq .",
    "( [ cusp1 ] ) , is equally problematic .",
    "it turns out that this interpolation problem is easiest to handle when expressed in @xmath14-space .",
    "this might seem unlikely at first , since a true cusp can only be generated by a computationally intractable infinite fourier sum . in practice",
    ", however , it appears that satisfactory approximate cusps can be introduced using fourier sums with manageable numbers of terms .",
    "the @xmath14-space cutoff needs to be large enough to ensure that the real space volume within which the cusp is not represented correctly is small , and hence that the resulting errors contribute little or nothing to expectation values .",
    "( [ cusp1 ] ) can be fourier analyzed to give :    @xmath300    eqs .",
    "( [ eq : f1 ] ) and ( [ eq : f2 ] ) show that @xmath301 , where @xmath302 for antiparallel spins and @xmath303 for parallel spins .",
    "hence    @xmath304    in section [ subsec : results - homog ] we test a homogeneous @xmath8 function defined using a truncated fourier series of this form , and find that most of the cusp energy can be retrieved using a reasonably low cutoff .",
    "( [ cusp2 ] ) defines a natural @xmath14-space crossover , @xmath305 , given by @xmath306 .",
    "the terms with @xmath307 produce the rpa behavior at large @xmath294 , while for @xmath308 we have @xmath309 , which generates the cusp .",
    "the density dependence of @xmath305 differs from that of the plasmon cutoff @xmath71 from eq .",
    "( [ cutoffk ] ) .",
    "it turns out , however , that for typical metallic densities @xmath71 and @xmath305 are both of the order of @xmath73 .",
    "the @xmath310 factor in the denominator of eq .",
    "( [ cusp2 ] ) therefore allows us to introduce the cusp without significantly affecting the large @xmath294 ( @xmath311 ) behavior implied by the rpa . if the density is extremely small",
    ", @xmath305 ( @xmath312 ) is smaller than @xmath71 ( @xmath313 ) , and so the @xmath14-space method of imposing the cusp is no longer consistent with the rpa limit we expect when @xmath311",
    ".    equation ( [ cusp2 ] ) suggests a simple @xmath14-space prescription for building a cusp into the inhomogeneous jastrow factor .",
    "we write the inhomogeneous jastrow factor as a double fourier series ,    @xmath314    noting that in a homogeneous system we have @xmath315 .",
    "we use this relationship to rewrite the homogeneous @xmath8 function of eq .",
    "( [ cusp2 ] ) in a form suitable for generalization to the inhomogeneous case ,    @xmath316    interpreting the inversion as that of a ( diagonal ) matrix . in the absence of cusps",
    ", we have seen that the homogeneous jastrow factor may be obtained from the inhomogeneous one by replacing    @xmath317    by @xmath318 . as we now wish to extrapolate from a homogeneous jastrow factor to an inhomogeneous one , we do the opposite and replace @xmath319 by the matrix square root @xmath320 .",
    "( [ cusp3 ] ) then becomes    @xmath321    the matrix to be inverted is no longer diagonal , but remains hermitian and positive definite .",
    "if we make the reasonable assumption that the fourier series for @xmath322 converges fairly rapidly , the elements of the matrix @xmath245 are constant along the diagonal and fall off as we move away from the diagonal . for large @xmath14 and @xmath323 , this guarantees that @xmath324 is dominated by the @xmath325 prefactor , generating a cusp . for small @xmath14 and @xmath323 we have",
    "@xmath326    which is the rpa result .    the @xmath8 function of eq .",
    "( [ cuspyu ] ) therefore interpolates smoothly between the anisotropic long - range correlation term derived from the inhomogeneous rpa and the cusp at short range . in @xmath14-space",
    "we now have a continuous crossover from collective behavior to two - particle scattering instead of a sudden and rather unphysical cutoff at @xmath71 .",
    "the introduction of the cusp modifies the @xmath102 fourier components of the rpa @xmath8 function and introduces nonzero fourier components with @xmath258 .",
    "in addition , it makes the @xmath8 function spin dependent , suggesting that we need a spin - dependent one - body term .",
    "we therefore generalize our expression for @xmath327 from eq .",
    "( [ eq : chiu ] ) by extending the wave vector sum to include components with @xmath258 and introducing a sum over spin indices ,    @xmath328 \\;,\\ ] ]    with an equivalent formula for @xmath329 . in a spin - unpolarized system , where @xmath330 , this reduces to    @xmath331 n({\\bf k } ' ) \\;.\\ ] ]    in the case of a homogeneous correlation term @xmath8 this further reduces to    @xmath332 n({\\bf k } ) \\;,\\ ] ]    as first proposed by malatesta _",
    "this section assesses the effectiveness and accuracy of qmc trial wave functions containing rpa jastrow factors .",
    "section  [ subsec : results - geom ] describes the systems studied and explains how the results are presented ; sec .",
    "[ subsec : results - homog ] considers homogeneous systems ; and sec .",
    "[ subsec : results - inhomog ] looks at inhomogeneous systems .",
    "all the results were obtained using trial wave functions of the standard slater - jastrow form , where the spin - up and spin - down slater determinants were constructed using accurate lda orbitals .",
    "the jastrow factor contained two- and one - body terms , @xmath333 and @xmath334 , of various different types .",
    "note that from now on we drop the @xmath335 self - interaction terms from the jastrow factor .",
    "this is equivalent to altering @xmath336 by a negligible amount ( ca .",
    "the energy averages discussed in the rest of this section were all accumulated using samples of 10000 statistically independent configurations of all the electrons ; the quoted errors are standard deviations of the mean of the local energy .      in one - electron bandstructure calculations",
    "the energy eigenfunctions @xmath337 may be obtained by solving the one - electron schrdinger equation within a single unit cell subject to bloch boundary conditions .",
    "properties of the infinite crystal may then be obtained by evaluating brillouin zone integrals ( i.e.  averaging over boundary conditions ) . in qmc calculations , however , we have to take account of all the electrons simultaneously , and it is no longer possible to reduce the problem to a single unit cell .",
    "instead , we consider a model solid consisting of a finite simulation subject to periodic ( not bloch ) boundary conditions .",
    "the simulation cell is made as large as possible to minimize the finite - size errors , and normally consists of several primitive unit cells containing a few hundred electrons in total .",
    "the simulation cell we choose is the wigner - seitz cell of a face - centered cubic ( fcc ) lattice .",
    "since we use periodic boundary conditions , any electron that moves out through one face of this cell immediately re - enters through the opposite face .",
    "the simulation - cell hamiltonian obeys the same periodic boundary conditions , and hence a periodic model potential energy is required ; we use the potential energy per cell of an infinite lattice of identical copies of the simulation cell .",
    "since the wigner - seitz cell of an fcc lattice is close to spherical , the interactions between electrons in neighboring copies of the simulation cell are smaller than for most other geometries , which helps to reduce the finite - size errors .",
    "it is important not to confuse the simulation - cell lattice with the actual lattice structure of the solid ; the simulation cell may contain many primitive unit cells , and these need not be face - centred cubic .",
    "the lattice vectors of the fcc simulation - cell lattice will be denoted by @xmath338 , @xmath339 , and @xmath340 , and the corresponding body - centered cubic ( bcc ) reciprocal lattice vectors by @xmath341 , @xmath342 , and @xmath343 .    for reasons of computational efficiency , we have chosen to study electron gas systems subject to external potentials that vary along the @xmath343 direction only ,    @xmath344    where @xmath345 in atomic units .",
    "since @xmath343 is a reciprocal lattice vector , this choice ensures that the potential has the same periodicity as the simulation cell .",
    "the electron density and @xmath9 functions , which also vary only in the @xmath343 direction , share this periodicity .",
    "the one- and two - body terms must also respect the periodic boundary conditions applied to the simulation cell .",
    "this implies that analytic jastrow factors based on the @xmath8 function of eq .",
    "( [ cusp1 ] ) must be made periodic by including contributions from all the electrons in a periodic lattice of identical copies of the simulation cell .",
    "since the analytic @xmath8 function decays like @xmath346 at large @xmath294 , the sum of contributions is evaluated using ewald summation techniques .",
    "numerical jastrow factors calculated from the inhomogeneous rpa are periodic by construction .",
    "the next two subsections contain a number of figures showing electron densities , @xmath9 functions , and @xmath8 functions .",
    "charge densities and @xmath9 functions are plotted along the @xmath343 direction from one side of the simulation cell to the other .",
    "the inhomogeneous two - body term @xmath347 is more difficult to represent .",
    "we have chosen to fix the position @xmath348 of the first electron , while sweeping @xmath349 along the @xmath343 direction on a line passing through @xmath348 .",
    "figure [ fig_1 ] shows the three positions of the first electron considered .",
    "note that because @xmath340 and @xmath343 are not the same , moving along a line parallel to @xmath350 does not bring you back to a point equivalent to ( i.e.differing by a lattice vector from ) the starting point until you have passed through three layers of simulation cells .",
    "this means that although @xmath351 always has the full periodicity of the simulation cell , this is not always apparent from the plots .",
    "note also that all jastrow factors are symmetric on interchange of @xmath352 and @xmath349 .",
    "the fcc simulation cell considered in this section held a uniform electron gas of 61 up - spin electrons and 61 down - spin electrons , giving 122 electrons in total .",
    "the density parameter @xmath76 was equal to 2 , corresponding to a fermi wave vector @xmath73@xmath94@xmath353 .",
    "two different jastrow factors were considered :    [ [ homogeneous - rpa - without - cusps . ] ] homogeneous rpa without cusps .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the homogeneous rpa theory suggests using a correlation term of the form ,    @xmath354    we saw in sec .",
    "[ subsec : rpareview ] that for typical metallic densities the cutoff @xmath71 is set to a value comparable to the fermi wave vector @xmath73 .",
    "[ [ homogeneous - rpa - with - cusps . ] ] homogeneous rpa with cusps .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    in sec .",
    "[ subsec : qmc - rpau ] we saw how a cusp may be introduced by adding an exponential factor to the @xmath71@xmath355@xmath356 limit of the homogeneous rpa @xmath8 function ,    @xmath357    where @xmath358 is chosen appropriately .",
    "table [ table.conv ] shows the local energy averages and standard deviations obtained in vqmc simulations using these two jastrow factors . for comparison ,",
    "we also show results obtained using a `` hartree - fock '' trial function including up- and down - spin slater determinants of lda orbitals ( in this case plane waves ) but no jastrow factor .",
    "the introduction of an rpa jastrow factor without a cusp lowers the calculated energy considerably but has little effect on the standard deviation .",
    "the introduction of the cusp lowers the energy greatly and also reduces the standard deviation .",
    "it is clear that the presence of the cusp is vital if accurate total energies are to be obtained .",
    "the cuspless rpa results shown in table [ table.conv ] were obtained using a value of @xmath71 equal to the fermi wave vector @xmath73 , but we also investigated the limit as @xmath71 tends to infinity , in which case @xmath359@xmath355@xmath360 . since we know that the description of screening in terms of collective plasmon modes is invalid at short distances , it was no surprise that this limiting form gave very poor results .",
    "the residual two - electron interactions in the short - range hamiltonian lead to a cusp - like behavior in the wave function at close distances , not a @xmath360 divergence .    in sec .",
    "[ subsec : inhomcusp ] we saw how the @xmath8 function with a cusp from eq .",
    "( [ rpacusp ] ) may be represented as a fourier series ,    @xmath361    where @xmath302 for antiparallel spins and @xmath362 for parallel spins .",
    "we can investigate the usefulness of this representation by cutting off the series at a wave vector @xmath363 and varying @xmath364 to see how fast the calculated vqmc energy approaches the @xmath364@xmath355@xmath356 limit .",
    "the hope is that with a reasonably small @xmath14-space cutoff we will be able to produce a jastrow factor that gives essentially the @xmath364@xmath355@xmath356 energy .",
    "figure [ fig_2 ] shows the convergence of the energy graphically .",
    "it can be seen that a cutoff of @xmath363@xmath94@xmath365@xmath366 produces a wave function with the same energy ( to within statistical uncertainties ) as an infinite cutoff .",
    "the @xmath367 cutoff is small enough to be computationally feasible , and so there is no difficulty in representing the cusp in @xmath14-space .",
    "note also how the standard deviation tends to zero as the energy improves .",
    "as mentioned above , the inhomogeneous systems we consider have a background potential that varies in one dimension only .",
    "the lda electron density of the unpolarized 64 electron simulation cell considered in this subsection is shown in fig .",
    "[ fig_3 ] .",
    "this system is strongly inhomogeneous ( for comparison , a typical interatomic distance in a solid is @xmath368@xmath369 ; this is roughly the distance between the trough and the peak of the charge density ) .",
    "the average electron density is the same as that of a uniform system with @xmath76@xmath94@xmath370 and fermi wave vector @xmath371@xmath94@xmath353 .",
    "in addition to investigating the influence of the cusp , as in the homogeneous case , we must also now investigate the effects of the one - body @xmath9 function and compare the accuracies of homogeneous and inhomogeneous @xmath8 functions .",
    "we therefore split this section into three subsections :    1 .",
    "first we look at the pure ( i.e.  cuspless ) homogeneous rpa jastrow factor ( which has no @xmath9 function ) and compare it with the pure inhomogeneous rpa jastrow factor ( which does have a @xmath9 function ) .",
    "second we investigate the effects of adding cusps to these two correlation factors .",
    "finally we add an ad - hoc one - body @xmath9 term to the homogeneous rpa jastrow factor .",
    "the inhomogeneous rpa jastrow factor considered here is the one derived in sec .",
    "[ alg.3 ] ( eqs .",
    "( [ rpajas ] ) , ( [ two1 ] ) , and ( [ fchi1 ] ) ) , which includes both @xmath8 and @xmath9 functions . as always in this work , the matrix @xmath245 is constructed using the lda density , and the slater determinants contain lda orbitals .",
    "the homogeneous jastrow factor includes the @xmath8 function from eq .",
    "( [ sumrpa ] ) but no @xmath9 . in both cases",
    "the cutoff @xmath71 is set equal to the fermi wave vector , @xmath372@xmath94@xmath353 , of a homogeneous system with the same average electron density as the inhomogeneous system .",
    "table [ table2 ] compares the vqmc energies and standard deviations calculated using the homogeneous and inhomogeneous jastrow factors .",
    "it is clear that the inhomogeneous jastrow factor is much the better of the two .",
    "the reason is apparent from fig .",
    "[ fig_3 ] , which demonstrates that the inhomogeneous jastrow factor , which has a built - in one - body term , produces a near optimal density .",
    "figure [ fig_3 ] also shows that the homogeneous rpa jastrow factor ( which has no one - body term ) gives a very poor electron density .",
    "this explains why the corresponding vqmc energy is so poor    in fig .",
    "[ fig_4 ] we plot the inhomogeneous rpa two - body term . both inhomogeneity and anisotropy can be seen . to aid understanding , fig .",
    "[ fig_5 ] shows the jastrow factors of three different homogeneous systems , the constant densities of which correspond to the _ local _ densities at the central positions of plots a , b , and c , respectively .",
    "it is clear that the three inhomogeneous @xmath8 functions shown in fig .",
    "[ fig_4 ] are much more similar than the three homogeneous @xmath8 functions shown in fig .",
    "[ fig_5 ] .",
    "this shows that the inhomogeneous rpa @xmath8 function is not well approximated by a local - density - like approximation based on the homogeneous rpa.@xcite in the low density region ( position c ) , in particular , we find that the inhomogeneous jastrow factor in fig .",
    "[ fig_4 ] is suppressed relative to the `` local density '' version of fig .",
    "[ fig_5 ] .    at point",
    "b , the charge density around the electron is asymmetric , and this is reflected in the anisotropy of the @xmath8 function .",
    "the anisotropy is such that the @xmath8 function is stronger on the side where the density is lower ; this is consistent with the idea that the rpa screening is more effective where the electron density is high .    in summary",
    ", we find that the jastrow factor has a larger range in the low density regions than in the high density regions , consistent with the `` local density '' picture of fig .",
    "[ fig_4 ] and with the physical expectation that screening should be more effective at high densities .",
    "this interpretation also explains the sign of the anisotropy : the @xmath8 function is weaker on the high density side where the screening is more effective .",
    "we find , however , that the range of variation of the inhomogeneous jastrow factor is much smaller than predicted by the `` local density '' picture .",
    "this suggests that a homogeneous jastrow factor defined by the averaged density of the underlying inhomogeneous system may not be such a bad approximation .",
    "a cusp may be added to the inhomogeneous rpa @xmath8 function using the fourier - space method explained in sec .",
    "[ subsec : inhomcusp ] .",
    "the results below are obtained with a fourier cutoff @xmath363 of @xmath373 ; fig .",
    "[ fig_2 ] suggests that this is large enough to represent the cusp accurately . since we choose not to change the relationship between the @xmath8 and @xmath9 functions , eq .",
    "( [ fchi ] ) , the introduction of the cusp also modifies the one - body @xmath9 function .",
    "the addition of the cusp to the inhomgeneous rpa jastrow factor reduces the calculated vqmc energy from @xmath374 ev per electron to @xmath375 ev per electron .",
    "this is the best variational estimate of the energy we were able to obtain using any of the jastrow factors considered in this paper .",
    "the addition of cusps to the homogeneous @xmath8 function does not introduce a one - body term and so the density obtained using the homogeneous rpa jastrow factor is still poor .",
    "energies calculated using the homogeneous rpa jastrow factor therefore remain much worse than energies calculated using the inhomogeneous rpa jastrow factor .",
    "figure [ fig_6 ] , which is analogous to fig .",
    "[ fig_4 ] , shows the inhomogeneous rpa @xmath8 function after the cusp has been added .",
    "it is clear that the addition of the cusp greatly reduces the amount of inhomogeneity and anisotropy .",
    "despite the fact that the system is strongly inhomogeneous , the cusp acts as such a stringent constraint that @xmath376 is close to homogeneous .",
    "although the inhomogeneity derived from the rpa must persist when @xmath377 is large enough , the crossover length , @xmath378 , corresponding to the average density @xmath76@xmath94@xmath370 , is comparable to our system size .",
    "this implies that the form of the @xmath8 function is largely determined by the cusp throughout our system .",
    "if we had studied larger systems we would have seen the rpa reassert itself at large @xmath379 , but previous work on numerical trial function optimization@xcite and finite - size errors@xcite has shown that the behavior of the @xmath8 function at such large values of @xmath380 has very little effect on the total energy .",
    "the fact that the inhomogeneous @xmath8 function becomes so homogeneous once the cusp has been added may explain the surprisingly good performance of the homogeneous @xmath8 functions used in most qmc simulations of solids .      in this subsection",
    "we compare the quality of analytic one - body terms based on eq .",
    "( [ fchi ] ) and numerical one - body terms obtained using variance optimization .",
    "we have already explained that we always construct the @xmath9 function appearing in the inhomogeneous rpa jastrow factor from the @xmath8 function and density according to eq .",
    "( [ fchi ] ) . although",
    "( [ fchi ] ) was derived within the rpa , we assume that it holds unaltered even after the spin - dependent cusps have been added to @xmath8 .",
    "this assumption proves very successful in practice , yielding @xmath9 functions that are not significantly worse than those computed ( at much greater cost ) using numerical variance optimization .    when adding a @xmath9 function to the homogeneous @xmath8 function of eq .",
    "( [ rpacusp ] ) we have two options : we could try using eq .",
    "( [ fchi ] ) again , or we could use variance minimization .",
    "since @xmath8 is now a function of @xmath380 only , eq .  ( [ fchi ] ) reduces to eq .",
    "( [ fahychi ] ) , which was first derived by malatesta _ et al._@xcite the impressive accuracy of eq .",
    "( [ fahychi ] ) is shown in fig .",
    "[ fig_7 ] , where we compare the analytic @xmath9 function with one obtained using additional numerical variance optimization .",
    "we see that the two @xmath9 functions ( and hence the two electron densities ) are very similar .",
    "table [ table4 ] shows that the difference between the two vqmc energies is smaller than the statistical noise in our simulations .",
    "table [ table3 ] shows that the inhomogeneous rpa ( including the @xmath9 function from eq .",
    "( [ fchi ] ) and an approximate fourier representation of the cusp ) yields marginally better results than the homogeneous rpa ( including the @xmath9 function from eq .",
    "( [ fahychi ] ) and an approximate fourier representation of the cusp ) . comparing these results to the ewald ( i.e.@xmath363@xmath355@xmath356 )",
    "results from table [ table4 ] , we see that including the exact cusp reduces the variance but has only a negligible effect on the energy .",
    "the inhomogeneous numerical jastrow factor yields a slightly better energy than the ewald jastrow factor .",
    "the improvement is barely statistically significant , but suggests that the inhomogeneity of the rpa correlations does produce a slight improvement .",
    "our aim was to better understand the physics underlying the jastrow factors used in qmc simulations of solids , and to derive improved jastrow factors for strongly inhomogeneous systems .",
    "we began by reviewing bohm and pines rpa treatment of the homogeneous electron gas@xcite and generalizing it to the inhomogeneous case .",
    "the result of this analysis was a slater - jastrow trial wave function containing an anisotropic inhomogeneous jastrow factor expressed as a double fourier sum .",
    "the optimal orbitals appearing in the slater determinants were shown to be close to hartree - fock or lda orbitals , even though these theories do not include jastrow factors .",
    "the rpa describes the long - range electronic correlations accurately , but not the scattering - like correlations at short distances .",
    "we saw , however , that the correct short - range behavior determined by the cusp conditions may easily be imposed on any jastrow factor represented in @xmath14-space . when the inhomogeneous rpa result is modified in this way ,",
    "the result is a parameter - free jastrow factor with the correct short and long - range behavior .    for systems of a few hundred electrons and an external potential varying in one dimension",
    "only , we showed that trial functions incorporating modified rpa jastrow factors are both accurate and computationally tractable .",
    "since such jastrow factors are parameter - free , the time - consuming variance minimization procedure normally used to generate accurate @xmath9 functions is not required . surprisingly , however , the inhomogeneity of the two - body @xmath8 function yields little benefit in the system we studied , producing an energy only two standard deviations ( a barely statistically significant amount ) below the best result obtained using a homogeneous @xmath8 function .",
    "provided we have a cusp describing the short - range interaction and a one - body term to mend the density , the detailed form of the @xmath8 function is not very important .",
    "the reason is that the imposition of the cusp conditions , which fixes the gradient of @xmath381 when @xmath382 , washes out most of the inhomogeneity of the rpa @xmath8 function when @xmath383 is small .",
    "it is the short - range correlations that have most effect on the energy , and so the long - range inhomogeneities that remain after the cusp conditions have been imposed have little effect .",
    "if we compare the plasmon cutoff @xmath71 ( @xmath384 ) from eq .",
    "( [ cutoffk ] ) with the wave vector @xmath305 ( @xmath385 ) that characterizes the crossover from screening behavior to cusp - like behavior ( see sec .  [",
    "subsec : inhomcusp ] ) , we see that the cusp is relatively less important in high density systems .",
    "this suggests that the inhomogeneity of the rpa @xmath8 function may produce a more obvious improvement when the average electron density is both large and strongly varying .",
    "this is intuitively sensible , since in low density systems we expect the short - range electron - electron scattering described by the cusp to dominate , whereas at higher densities screening and collective effects should be more important .",
    "possible candidates for high density systems include calculations explicitly involving the core electrons , where it is already known that the use of inhomogeneous @xmath8 functions is advantageous.@xcite other systems where one might expect inhomogeneities in the correlation term to become important are rare earth elements , where some of the valence electrons are strongly bound to the core .    in summary ,",
    "we hope that this paper has contributed a better and more general understanding of the physics underlying the slater - jastrow trial functions used in most qmc simulations of solids .",
    "in this appendix we look at the physical interpretation of the bohm - pines hamiltonian @xmath259 _ after _ the application of the unitary transformation discussed in sec .",
    "[ alg.2 ] . as expressed in eq .",
    "( [ brpa ] ) this hamiltonian appears very complicated .",
    "however , if we define a field              the hamiltonian of eq .",
    "( [ hfield ] ) describes a set of quantum mechanical particles moving in a reduced external potential potential @xmath130 and interacting with a quantum mechanical longitudinal electromagnetic field @xmath390 .",
    "the kinetic energy of the field is associated with the energy density of the electric field in the usual way .",
    "the interactions between the particles and the field are also described via the standard coupling to the momentum operators .",
    "the physical interpretation of the transformed subsidiary condition , @xmath391 , where @xmath392 is as given in eq .",
    "( [ sc2.1 ] ) , also becomes much clearer when re - expressed in terms of the new fields ; it simply sets the fourier components of      to zero .",
    "the subsidiary condition thus ensures that the electric field is related to the density of the particles via gauss s law .",
    "crucially , we found that this constraint is automatically satisfied in the ground state , provided the @xmath394 have been chosen correctly .",
    "the rpa decouples the electronic and field variables by neglecting the @xmath395 terms and treating the quadratic @xmath396 terms only approximately by averaging the electron positions .",
    "the field part of the decoupled hamiltonian is then harmonic :        eq .",
    "( [ eq : fieldreal ] ) looks disconcertingly simple : it appears that we have three independent harmonic oscillators at every point @xmath398 ( one each for the x , y and z components of the vector potential ) .",
    "the apparent simplicity is misleading , however , since the condition that the fields be longitudinal , @xmath399 , couples the oscillators at different points in space and reduces the number of degrees of freedom at any point from three to effectively just one .",
    "dropping this condition and retaining only one scalar oscillator is equivalent to dropping the @xmath400 term in eq .",
    "( [ mkk ] ) and leads to a local - density - like version of the rpa .",
    "s. fahy , in _ quantum monte carlo methods in physics and chemistry _ , nato science series c : mathematical and physical sciences , vol .",
    "525 , edited by m.  p. nightingale and c.  j. umrigar ( kluwer academic , dordrecht , the netherlands , 1999 ) , p.  101 .",
    "d.  a. kirzhnitz , in _ the dielectric function of condensed systems _ ,",
    "modern problems in condensed matter science , vol .",
    "24 , edited by v.  m. agranovich , a.  a. maradudin , l.  v. keldysh and d.  a. kirzhnitz ( north holland , amsterdam - london , 1989 ) , p.  58"
  ],
  "abstract_text": [
    "<S> quantum monte carlo simulations of interacting electrons in solids often use slater - jastrow trial wave functions with jastrow factors containing one- and two - body terms . in uniform systems the long - range behavior of the two - body term may be deduced from the random - phase approximation ( rpa ) of bohm and pines . here </S>",
    "<S> we generalize the rpa to nonuniform systems . </S>",
    "<S> this gives the long - range behavior of the inhomogeneous two - body correlation term and provides an accurate analytic expression for the one - body term . </S>",
    "<S> it also explains why slater - jastrow trial wave functions incorporating determinants of hartree - fock or density - functional orbitals are close to optimal even in the presence of an rpa jastrow factor . after adjusting the inhomogeneous rpa jastrow factor to incorporate the known short - range behavior , we test it using variational monte carlo calculations . </S>",
    "<S> we find that the most important aspect of the two - body term is the short - range behavior due to electron - electron scattering , although the long - range behavior described by the rpa should become more important at high densities . </S>"
  ]
}