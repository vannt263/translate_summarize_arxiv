{
  "article_text": [
    "interest in random number generator ( rng ) deficiencies has recently been aroused by the work of ferrenberg et al @xcite , who found that the widely employed `` r250 '' generator produces systematic errors in monte carlo simulations using cluster updating algorithms .",
    "their high precision measurements of the specific heat and the internal energy of the critical two dimensional ising model differed from the exact values by up to @xmath1 @xcite .",
    "these observations prompted a number of detailed studies of systematic errors in cluster algorithms and other `` depth first '' algorithms , such as those employed for simulating self avoiding walks @xcite-@xcite .",
    "the consensus emerging from these studies was that pseudo random numbers ( prns ) @xmath2 generated by generalized feedback shift register ( gfsr ) algorithms of the type @xcite    @xmath3    are generally `` bad '' when used in depth first algorithms , even though they pass many of the standard rng tests and have very long periods @xcite .",
    "however for local ( single spin flip ) metropolis updating , good results were obtained using the gfsr generators .",
    "it was therefore concluded that this type of algorithm is relatively insensitive to correlations and thus safe to use .    in this paper , we show that in certain circumstances large systematic errors can also arise when using gfsrs generators in conjunction with local metropolis updating .",
    "we demonstrate this for the case of the tricritical blume - capel model and argue that the observed errors originate from certain extremely large triplet correlations in the random number sequences .",
    "there have been a number of recent suggestions in the literature that the problems observed with the gfsr generators may originate from triplet correlations @xcite . in view of this",
    "we have made a study of three point correlations in the gfsr generators and have indeed found an extremely large effect in the @xmath4 triplet . for this triplet the three point average takes the value @xmath5 instead of @xmath6 .",
    "this effect is displayed in figure  [ fig : triplets ] where we plot the triplets @xmath7 as a function of @xmath8 , for @xmath9 .",
    "the results were obtained from a sequence of @xmath10 prns using the magic number pair @xmath11 corresponding to the r250 generator .",
    "in fact the same effect , with the same magnitude , is observable for other magic number pairs @xmath12 recommended in the literature @xcite , viz @xmath13 , @xmath14 , @xmath15 , @xmath16 , @xmath17 , @xmath18 , @xmath19 , @xmath20 , @xmath21 , @xmath22 , @xmath23 , @xmath24 .",
    "it is thus conceivable that triplet correlations are responsible for the systematic errors observed in `` depth first '' algorithms , which principally rely on long uncorrelated sequences of random numbers .",
    "however , as mentioned above , it has hitherto been generally believed that local metropolis updating schemes are insensitive to correlations in the prn sequences and give results at least better than linear congruential rngs @xcite .",
    "in fact we have found that in one system , the tricritical blume - capel model , triplet correlations can lead to extremely large ( @xmath25 ) errors , even when using a metropolis single site updating scheme .",
    "the blume - capel model is a spin 1 ising model with the hamiltonian    @xmath26    where spins @xmath27 take the values @xmath28 and the sum @xmath29 runs over all nearest neighbor pairs .",
    "we have simulated this model on an fcc lattice for system size @xmath30 spins .",
    "spins were updated serially , each update requiring two random numbers : one to choose the new spin , and one for the metropolis step .",
    "the random numbers were generated by the r250 rng , having the magic number pair ( p=250 , q=147 ) .",
    "figure  [ fig : asymm](a ) shows the measured probability distribution of the magnetisation @xmath31 at the near - tricritical parameters @xmath32 , @xmath33 ( circles ) . notwithstanding",
    "the symmetry of the hamiltonian under inversion of all spins ( @xmath34 ) , the distribution is clearly asymmetric with respect to the `` plus '' and `` minus '' phases .",
    "we find , however , that if spins are updated randomly instead of serially , the distribution becomes symmetric [ figure  [ fig : asymm](b ) ] .",
    "we believe that the observed asymmetry in @xmath35 is related to the fact that for system size @xmath36 , the larger generator lag @xmath37 is a factor of the system volume , so that a given spin is always updated with a random number having the same relative position within successive sequences of @xmath38 prns .",
    "this view is supported by the following evidence :    * we find that the asymmetry in @xmath35 disappears when other system sizes are simulated , e.g. @xmath39 .",
    "* the asymmetry disappears for the @xmath36 system size when one additional prn is drawn and discarded after each monte carlo step ( i.e. after a whole sweep through the lattice ) . * the asymmetry disappears for the @xmath36 system size when the r250 generator is substituted by the `` r1279 '' , a gfsr rng with the magic number pair ( 1279,216 ) . *",
    "the asymmetry reappears with the r1279 , for the @xmath36 system size when @xmath40 additional prns are drawn and discarded after each monte carlo step .",
    "we further believe that the asymmetry in @xmath35 is a manifestation of the aforementioned triplet correlations in the prn sequence @xmath4 . to substantiate this we performed a simulation using the lagged fibonacci rng @xcite    @xmath41    which is formally similar to the `` r1279 '' , but does not display the triplet correlation . even after discarding @xmath40 prns after each cycle , @xmath35 remains symmetric with this generator .",
    "it is interesting to observe that a number of further factors influence the size of the asymmetry effect .",
    "one is the proximity to the tricritical point .",
    "if we choose @xmath42 , corresponding to the critical point of the spin 1 ising model , the effect weakens , but remains clearly discernible ( not shown ) .",
    "we also note that the asymmetry effect is not influenced by the dimensionality or the type of lattice : simulations of the @xmath43 blume - capel model on a square lattice ( with @xmath44 additional random numbers discarded between each sweep ) exhibit the asymmetry with a similar magnitude to that observed in the three - dimensional case .",
    "the effect does , however , seem to depend on the symmetry of the hamiltonian of the model studied . to demonstrate this we have also performed simulations on the three state potts model near its critical point .",
    "this is a lattice spin model with the hamiltonian    @xmath45    where @xmath46 denotes the kronecker symbol and @xmath27 takes again the values @xmath47 .",
    "the sole alteration required to the blume - capel program to simulate this model , is the calculation of the energy change in the metropolis step . in figure",
    "[ fig : potts ] we show the magnetisation distribution @xmath35 for the three state potts model on a @xmath36 fcc lattice , for the near - critical temperature @xmath48 .",
    "no asymmetry between the `` plus '' and `` minus '' phases is evident .",
    "similar simulations on the 2d simple ising model also reveal no asymmetry .",
    "it is thus clear that the observed asymmetry in the tricritical blume - capel model is the result of a subtle interplay between the tricritical clusters and prn triplet correlations .",
    "the fact that one of the three phases in the blume - capel model ( the `` 0 '' phase ) is distinguishable from the other two at the tricritical point seems to be crucial . from the joint distribution @xmath49 , with @xmath50 ( figure  [ fig : contours ] ) , one sees that there is no direct phase space path between the `` plus '' and `` minus '' phases . in order to migrate from one of these phases to the another",
    ", the system must pass through the `` 0 '' phase .",
    "it seems that the tricritical clusters of `` 0 ' 's are very sensitive to correlations in the prns , and that `` resonant enhancement '' of the triplet correlations occurs when the system size is a multiple of the larger generator lag .",
    "the critical clusters in the potts model are much less susceptible to these specific correlations .",
    "to summarize , we have demonstrated that the interplay between the physical properties of a system ( principally the system size ) and random number generator triplet correlations can lead to strong systematic errors in simulations even when simple metropolis updating is used .",
    "such `` resonant enhancement '' of prn correlations can be very specific to a particular situation , as in our case of the tricritical blume - capel model , and not be observable at all in other , albeit very similar systems .",
    "our observation therefore supports the view that a random number generator is only `` good '' in conjunction with the specific application for which it has been tested  every new application is also a new pseudo random number test , where known and unknown correlations may gain importance in an uncontrolled way .",
    "* acknowledgments * we are grateful to d.p .",
    "landau and k. binder for useful discussions , and to p. nielaba for practical help with some of the tests .",
    "some of our simulations were carried out using externally provided versions of the r250 , e.g. on the cray - ymp at the hchstleistungs - rechenzentrum jlich .    99 a.m. ferrenberg , d.p .",
    "landau , y.j .",
    "wang , phys .",
    "lett . * 69 * , 3382 ( 1992 ) .",
    "p. grassberger , phys . lett . * a 181 * , 43 ( 1993 ) .",
    "w. selke , a.l .",
    "talapov , l.n .",
    "shchur , jetp lett . * 58 * , 665 ( 1993 ) .",
    "coddington , intn .",
    "c * 5 * , 547 ( 1994 ) .",
    "k. kankaala , t. ala - nissila , i. vattulainen , phys .",
    "e * 48 * , r4211 ( 1993 ) ; i. vattulainen , k. kankaala , j. saarinen , t. ala - nissila , comp .",
    ". comm . * 86 * , 209 ( 1995 ) .",
    "i. vattulainen , t. ala - nissila , k. kankaala , phys .",
    "lett . * 73 * , 2513 ( 1994 ) ; phys .",
    "e * 52 * , 3205 ( 1995 ) .",
    "lewis , w.h .",
    "payne , j. assoc .",
    ". mach . * 20 * , 456 ( 1973 ) ; h.s .",
    "bright , computing surveys * 11 * , 357 ( 1979 ) .",
    "marsaglia , in _ computer science and statistics _ , vol 16 ed .",
    "l. balliard ( elsevier , amsterdam , 1985 ) ."
  ],
  "abstract_text": [
    "<S> we report large systematic errors in monte carlo simulations of the tricritical blume - capel model using single spin metropolis updating . </S>",
    "<S> the error , manifest as a @xmath0 asymmetry in the magnetisation distribution , is traced to the interplay between strong triplet correlations in the shift register random number generator and the large tricritical clusters . </S>",
    "<S> the effect of these correlations is visible only when the system volume is a multiple of the random number generator lag parameter . </S>",
    "<S> no such effects are observed in related models . </S>"
  ]
}