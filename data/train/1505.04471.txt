{
  "article_text": [
    "in this section , we provide details how the langevin equations , @xmath144 can be transformed into the one - dimensional fpe presented in the main text . from general results on stochastic processes ( see @xcite ) , it follows that the previous langevin equation is associated to the following two - dimensional fpe : @xmath21\\nonumber \\\\ & + \\frac{1}{2}\\sum_i   \\partial^2_{i}\\left\\ { \\left[(n_i\\sigma_i)^2 + n_i\\left(\\nu_i+\\gamma\\frac{n}{k}\\right)\\right]p\\right\\}\\ , ,   \\label{fp2d }   \\end{aligned}\\ ] ] where @xmath22 .",
    "the drift part is directly stemming from the non - fluctuating parts of the langevin equations @xmath145 .",
    "diffusion depends on the correlation level of the noises experienced by the two species .",
    "in particular , we have introduced the correlation coefficient @xmath146 .",
    "the case when the two noises are the same is given by @xmath67 , when they are independent is @xmath69 and when they are anti - correlated is @xmath147 .    to study the evolutionary dynamics associated to eq .",
    ", the relative abundances are the natural choice of variables .",
    "therefore , we transform the absolute abundances @xmath148 and @xmath149 to @xmath23 and @xmath24 . to perform the change of variables ,",
    "not only @xmath150 and @xmath151 have to be replaced , also the differential operators and the probability distribution have to be transformed . ensuring that the latter is still normalized after change of variables , the jacobian has to be introduced , @xmath152 .",
    "the derivatives are given by , @xmath153 and @xmath154 .",
    "after the change of variables , the fpe for @xmath25 and @xmath26 can now be further simplified exploiting the fact that the time scale of selection , @xmath27 , is much slower than the one of the population growth @xmath28  @xcite .",
    "therefore , we marginalize the fpe with respect to the total population size @xmath26 . thereby ,",
    "the integrals @xmath155 of @xmath26-derivative terms such as @xmath156 or @xmath157 vanish and the fpe simplifies to    @xmath31q\\right\\ } \\nonumber \\\\   & + \\partial_x\\left(\\frac{s}{n } q\\right)\\nonumber\\\\ & + \\!\\partial^2_x\\!\\left\\{\\!\\left[\\frac{\\sigma_1 ^ 2\\!-\\!2\\epsilon\\sigma_1\\sigma_2\\!+\\!\\sigma_2 ^ 2}{2}x(1\\!-\\!x)\\!+\\!\\!\\frac{\\gamma}{2k}+\\frac{\\nu_1-sx}{2n}\\right]\\ !",
    "q\\right\\ } , \\label{eq : fp1db}\\end{aligned}\\ ] ]    where @xmath32 . the drift term in the second line stemming from demographic fluctuations can be neglected as @xmath30 holds .",
    "to finally arrive at the one - dimensional fpe employed in the main text , we compute the steady state population size @xmath158 . as the deterministic differential equation for @xmath26",
    "is given by @xmath159,\\nonumber\\end{aligned}\\ ] ] the fixed point for the populations size is @xmath160 $ ] . employing that relation and the aforementioned condition @xmath161 , the last term in eq",
    ".   can be simplified as @xmath162 , which finally leads to the one - dimensional fpe in the main text : @xmath31q\\right\\ } \\nonumber \\\\ & + \\!\\partial^2_x\\!\\left\\{\\!\\left[\\frac{\\sigma_1 ^ 2\\!-\\!2\\epsilon\\sigma_1\\sigma_2\\!+\\!\\sigma_2 ^ 2}{2}x(1\\!-\\!x)\\!+\\!\\!\\frac{\\gamma}{k}\\right]\\ !",
    "q\\right\\ } , \\label{eq : fp1d}\\end{aligned}\\ ] ]",
    "in the following , we derive a general expression for the fixation probability .",
    "the calculations are analogous to the procedure for the neutral case described in the body of the paper . to determine the fixation probability the following backward equation has to be solved , @xmath163\\partial_x\\nonumber \\\\ & + \\!\\left[\\frac{\\sigma_1 ^ 2\\!-\\!2\\epsilon\\sigma_1\\sigma_2\\!+\\!\\sigma_2 ^ 2}{2}x(1\\!-\\!x)+\\!\\frac{\\gamma}{k}\\right]\\ !",
    "\\partial_x^2\\bigg\\}p_\\text{fix}(x ) .",
    "\\label{eq : fp}\\end{aligned}\\ ] ] boundary conditions are @xmath57 and @xmath58 . the solution to eq .   for the fixation probability",
    "is @xmath164}\\right\\}}{1-\\exp{\\left\\{2\\zeta\\ , \\text{tanh}^{-1}\\alpha\\right\\}}}\\ , , \\label{eq : fix_prob}\\end{aligned}\\ ] ] with @xmath165    the solution is obtained by integrating once , to find the gradient @xmath166 the expression is verified to be proportional to the derivative of @xmath167 and boundary conditions are then imposed to fix the two constants of integration .",
    "the resulting expression is finally transformed into eq .   by using the elementary identity : @xmath168 $ ] .",
    "it is verified that in the limit @xmath169 , one recovers the expression given in the main text .",
    "all in all , the behavior we discussed in the main text is validated by analyzing the fixation probability : both a higher growth rate and a smaller variability are beneficial for an individual .",
    "the expression for the time of fixation in the neutral case that we presented in the body of the paper is derived as follows .",
    "the average time for fixation obeys the following backward equation , @xmath170 \\partial_x\\right\\ } \\partial_x t(x)= \\nonumber \\\\ & -\\left(\\tilde\\sigma^2x\\left(1-x\\right)\\right)^{-1 } , \\label{eq : fp_time}\\end{aligned}\\ ] ] with @xmath89 the boundary conditions @xmath85 . integrating eq .   and",
    "by variation of constants , we obtain : @xmath171\\ , , \\label{t_der}\\end{aligned}\\ ] ] where @xmath172 is a constant to be fixed by the boundary conditions .",
    "the integrals @xmath173 of eq .   needed for @xmath174 are performed by decomposing the rational function at the prefactor and using the formula : @xmath175 that follows from the very definition of the dilogarithm @xmath176 ( see  @xcite ) .",
    "the formula is used four times either directly ( with a simple change of variables ) or first integrating by parts to satisfy the condition @xmath177 in .",
    "the resulting expression is then transformed to the form given in the main text ( which is the one given by mathematica ) by using the reflection property , @xmath178 , see  @xcite .      in the general case when selection is present ,",
    "the expression for the average fixation time can not be found explicitly but is reducible to quadratures as follows .",
    "the fixation time obeys the backward equation with the left - hand side replaced by @xmath179 . using the definitions , we obtain @xmath180 \\partial_x\\right\\}\\times\\nonumber \\\\ & & \\partial_xt(x)=-\\frac{2k}{\\gamma x(1-x)}. \\label{eq : fpt}\\end{aligned}\\ ] ] boundary conditions are @xmath85 .",
    "the homogeneous solution was already found following and reads @xmath181 where @xmath182 and @xmath183 are constants and we defined @xmath184 to simplify notation .",
    "the non - homogeneous solution for the gradient of @xmath185 is obtained by varying the constant in , remarking that @xmath186 and integrating the resulting first - order differential equation to obtain @xmath187\\nonumber\\end{aligned}\\ ] ] where @xmath188 is the hypergeometric function of two variables @xcite .",
    "the solution for @xmath185 involves the integral @xmath189 of the expression above ( for which a closed form does not seem to be available ) , and the two constants in are fixed by @xmath190    it is verified from the expression above or directly from the original equation that in the two limits @xmath191 and @xmath192 the solution behaves like in the neutral case , _",
    "i.e. _ @xmath193 and @xmath194 . selection and the rest of the parameters affect of course the solution in the rest of the interval of definition @xmath195 $ ] .",
    "depending on the position of the stable fixed point , coexistence between two species ( one with a larger growth rate , one with a smaller variability , @xmath196 and @xmath197 ) is possible . in this section",
    "we present some additional data demonstrating this . in fig .",
    "[ fig : coex ] , the extinction time which corresponds to the time of coexistence is shown depending on @xmath64 is shown for different values of @xmath46 .",
    "dots correspond to solutions of eqs .   and black lines are numerical solutions of eq .  .",
    "the extinction time has a maximum which exactly coincides with the parameter values of a fixed point @xmath71 .",
    "the dependence of this maximal extinction time on the selection strength @xmath46 is shown in fig .",
    "[ fig : fp ] .",
    "extinction time depending on @xmath64 for different values of the selection strength : @xmath198 ( red ) , @xmath199 ( violet ) and @xmath200 ( blue ) .",
    "dots are numerical solutions of the langevin equations ,  eq .  , and black lines are solutions of eq .  .",
    "]     extinction time for different values of @xmath46 and @xmath201 .",
    "this combination of @xmath46 and @xmath64 corresponds to a stable fixed point at @xmath71 and the maximal coexistence time for each value of @xmath46 , see fig .",
    "[ fig : coex ] . as not only the selection strength but also the variability is increasing from left to right ,",
    "the fixation time is a monotonically decreasing function of @xmath46 . ]",
    "the aim of this section is to show that individual - based models are described by the langevin equations , eqs .  , discussed in the main text and to analyze the mapping between the parameters of the two models .",
    "the environmental conditions change stochastically at the rate @xmath107 and are distributed according to a distribution , @xmath108 , with mean @xmath109 and variance @xmath202}$ ] .",
    "the dependency of the instantaneous reproduction rate @xmath110 on @xmath103 is given by the sigmoidal function : @xmath203 which reduces to @xmath204 in the limit of large variances @xmath202}$ ] .",
    "birth rates are defined as , @xmath205 in the no - memory limit @xmath119 , the growth rate is therefore given by the instantaneous growth rate @xmath110 , while for @xmath121 the current growth rate is the arithmetic mean of all previously experienced environments .",
    "death rates are given by @xmath124 .",
    "we discuss first the model without memory , where the memory parameter , @xmath123 , is zero : individuals reproduce with the instantaneous reproduction rates [ eq .  ] , which reduce to @xmath206 in the limit of large environmental variance .",
    "we consider an interval of length @xmath207 such that the probability for an individual to reproduce or die is small , yet the total number of events occurring over the whole population ( @xmath208 ) is large .",
    "neglecting the standard demographic noise term @xcite , the variation of the @xmath2-type population is given by @xmath209 where @xmath210 is the environmental boolean random variable that takes values @xmath211 and switches with characteristic time @xmath140 .",
    "the last term of eq .   is estimated as follows @xmath212 where @xmath213 is a gaussian random variable having zero mean and variance @xmath214=\\int_0^{\\delta t}ds\\int_0^{\\delta t}ds'\\langle \\hat{\\sigma}(s)\\hat{\\sigma}(s')\\rangle=2\\tau\\delta t\\ , .",
    "\\label{eq : corrsigma}\\ ] ] here , we used that @xmath215 and @xmath216 .",
    "the second term in eq .",
    "is evaluated at the order @xmath217 using the same integral , eq .  , and gives @xmath218 .",
    "combining back all the terms , we conclude that the equation is equivalent to the langevin equation   with the mapping of the parameters @xmath219 note that the standard demographic noise term in eq .",
    "should a priori include the fluctuating environmental term @xmath220 in the sum of the rates .",
    "in fact , it can be safely ignored as @xmath221 due to @xmath222 and @xmath207 .",
    "finally , the factor @xmath223 appearing in @xmath224 in depends on the poisson statistics of the environmental fluctuations . if the duration is fixed and equal to @xmath140 , eq .",
    "becomes @xmath225 . in that case , the corresponding mappings are @xmath226 and @xmath227 .",
    "this is confirmed numerically in fig .",
    "[ fig : compare ] where we show data for exponentially distributed ( black ) and fixed duration ( red ) environments .",
    "solid lines are analytic solutions of the fixation time [ eq .",
    "( 6 ) main text ] employing the respective mappings .     for fixed times of environmental changes and @xmath228 for exponentially distributed switches .",
    "thereby , the data confirms that the origin of the factor 2 in the mapping is solely the exponential distribution of the environmental changes .",
    "parameters are @xmath229 and @xmath230 , @xmath49 , @xmath231 , @xmath125 , @xmath82=100 $ ] and @xmath232 .",
    "[ fig : compare ] ]      we now turn to the scenario where memory extends over several environmental conditions that an individual previously experienced .",
    "whilst for @xmath119 an exact analytic mapping can be found in the limit of small @xmath140 , for finite memories the situation is more intricate .",
    "however , for the special case @xmath129 the variability in the growth rate can be well approximated by the following argument .",
    "the reproduction rate @xmath115 of an individual , @xmath99 , of type @xmath2 at time @xmath100 depends on the average of all instantaneous reproduction rates @xmath110 experienced by the individual : @xmath234 at the time of reproduction , we assume for simplicity that offspring looses its memory of past environments experienced by the progenitor .",
    "we consider again a time interval of length @xmath217 as in .",
    "fluctuations in the rates @xmath235 decorrelate on timescales of the order of the lifetimes of individuals , @xmath236 , which are much longer than @xmath140 and @xmath217 . therefore on the @xmath217 scale , noise is smooth , contrary to .",
    "conversely , timescales of several lifetimes are much smaller than those on which selection acts and much longer than the characteristic time of the noise .",
    "therefore , to describe the dynamics of the fractions , the environmental noises are well approximated by a shortly correlated noise .",
    "an estimation of the amplitude of the noise is obtained by calculating the sum @xmath237 the durations @xmath238 of the environmental intervals are independent for different @xmath239 and @xmath240 ( and the contribution @xmath241 is negligible with respect to the rest of the sum ) so that one can replace them by @xmath140 .",
    "in addition , the symmetry in the indices of the intervals allows us to further simplify the expression @xmath242 to compute the average in eq .",
    "three different orders of events have to be distinguished : a ) if the birth of the @xmath243-th individual was prior to the one of the @xmath99-th individual , then it follows from eq   that the quantity to be averaged is @xmath244 , where @xmath245 is the number of environmental switches since the birth of the @xmath99-th individual up to time @xmath246 . to derive eq",
    "we have used that the terms in the sum   take independent values @xmath247 with equal probability .",
    "conversely , case ( b ) is when the birth of the @xmath243 individual is posterior to the one of the @xmath99-th individual .",
    "then the quantity to be averaged is @xmath248 , where @xmath249 is the time between the birth of the @xmath99-th and the @xmath243-th individuals . finally , in case ( c ) when @xmath250 , the correlation is zero as there is no overlap between the environmental fluctuations of the two individuals .",
    "due to the poissonian nature of the events , the number of switches since birth ( back in the past ) or before reproduction ( forward in the future ) have the same distribution @xmath251 where @xmath252 ( its exact value does not affect the sequel ) .",
    "it follows that @xmath253\\,.\\nonumber\\\\ \\label{eq : mess }   \\end{aligned}\\ ] ] the integral over @xmath100 is the continuous approximation of the sum over @xmath254 appearing in eq .   while the variables @xmath255 and @xmath256 refer to the variables @xmath257 and @xmath249",
    "the first and second term in the square parentheses of correspond to cases ( a ) and ( b ) , respectively . by a series of change of variables and integrations by parts",
    ", it is shown that reduces to @xmath258 the validity of this approximation is confirmed for the neutral case in fig .  2 in the main body of the paper where the fixation probability and time are compared to the analytic calculations employing eq .  .",
    "additional data for non - neutral evolution is presented in fig .",
    "[ fig : fit ] where two species ( one with finite variability , @xmath259 , one with vanishing variability ) are analyzed .",
    "analytic solutions for the fixation time and probability are fitted to simulation data .",
    "the best fit deviates less than @xmath260 from eq .  .    .",
    "black dots correspond to simulation results of the ibm and red lines are analytic solutions . to obtain the latter we fitted eq .   and the solution of eq .   to the ibm .",
    "we used @xmath261 and @xmath262 as fitting parameters and obtained @xmath263 and @xmath264 .",
    "other parameters are @xmath229 , @xmath265 , @xmath266 , @xmath267 , @xmath49 , @xmath231 , @xmath125 and @xmath82 $ ] .",
    "[ fig : fit ] ]    we now briefly discuss the dependence of @xmath5 on the memory parameter @xmath123 . in fig .",
    "[ fig : sigma ] , the std of the noise in the growth rate , @xmath96 , depending on the memory parameter , @xmath123 , is analyzed .",
    "results were obtained by simulating the neutral evolution case , measuring the fixation time and calculating @xmath96 employing the analytic expression for the extinction time [ eq .   6 main text ] .",
    "for @xmath119 the thereby obtained value agrees nicely with the mapping introduced above indicated by the red dashed line [ eq .  ] . with increasing memory , @xmath123",
    ", the std of the noise , @xmath96 , decreases monotonically and approaches eq .   for @xmath121 .",
    "extinction times in the neutral scenario were measured . by evaluating the inverse of the fixation time function [ eq .",
    "( 6 ) main text ] the std of the growth was calculated . for @xmath119",
    "the result agrees with the mapping , cf .",
    "eq  , indicated by the red dashed line . for larger values of @xmath123 the variability is reduced .",
    "parameters are @xmath268 , @xmath269 , @xmath270 , @xmath49 , @xmath50 , @xmath125 and @xmath82 $ ] .",
    "[ fig : sigma ] ]    let us now analyze the mapping of the average reproduction rate @xmath1 .",
    "importantly , this mapping is very sensitive to model details which we will exemplify in the following . as results for neutral species do not dependent on the average reproduction rate",
    ", we have to turn to the evolution of non - equal individuals to understand the mapping of the growth rates . in fig .",
    "[ fig : fit ] , we show the fixation probability for two species with the same @xmath229 but only the first species has a variable reproduction rate @xmath271 for @xmath129 .",
    "red lines correspond to a fit with @xmath272 and agree perfectly with simulation results . in other words , the first species does not only have a disadvantage due its sensitivity on environmental changes , @xmath273 , but also has a smaller average growth rate . to study this effect in more detail ,",
    "let us now analyze the fixation probability dependence on the memory parameter @xmath123 , see fig .",
    "[ fig : kernel_sel ] panel ( a ) .",
    "black dots correspond to the standard ibm ( if not mentioned otherwise our discussion applies to this data ) , red dots to a slightly changed model which is going to be introduced in the following . for @xmath119",
    "both species are equally likely to fixate as the growth advantage of the more variable species @xmath274 exactly compensates for its disadvantage due to the std of the noise @xmath273 .    .",
    "the first species growth rate depends on the environment while the second one s is constant .",
    "black dots correspond to the ibm introduced in the main body of the paper , while red dots represent a model modification not memorizing the first environment ( the one in which an individual is born ; for details see text ) .",
    "while the fixation probability is a direct simulation result , the selection coefficient @xmath46 is inferred from it using the additional data presented in fig .",
    "[ fig : sigma ] . parameters are @xmath268 , @xmath275 , @xmath266 , @xmath270 , @xmath49 , @xmath50 , @xmath125 and @xmath82 $ ] . [",
    "fig : kernel_sel ] ]    for increasing values of @xmath123 first the more variable ( @xmath276 ) later the less variable species is favored ( @xmath277 ) .",
    "whether this behavior is caused by the std of the noise or differences in the mean reproduction rates is not obvious as the influence of both fitness contributions is of comparable strength .",
    "therefore , we estimate the selection coefficient , @xmath27 , from the fixation probability data , see fig .",
    "[ fig : kernel_sel ] panel ( b ) .",
    "this is achieved by assuming that the variability of species * 1 * with @xmath278 is zero ( @xmath279 ) and that the variability of species * 2 * with @xmath280 is the same as in the neutral evolution scenario and thereby given by the data presented in fig  [ fig : sigma ] .",
    "note that this approximation might neglect some higher noise correlations arising due to the coupling of both species via the carrying capacity .",
    "for @xmath119 the thereby obtained value of @xmath46 agrees well with our analytic results , cf .",
    "eq .  . with increasing @xmath123 the growth rate of the more variable species",
    "is decreased till the selection coefficients becomes negative effectively favoring the more variable species .",
    "however the decrease of the selection coefficient with @xmath123 is smaller than the reduction of @xmath96 shown in fig .",
    "[ fig : sigma ] .",
    "hence , for small @xmath123 the more variable species is favored as its advantage due to a larger average reproduction rate is larger than its disadvantage due to its sensitivity on the environment .",
    "this advantage in the growth rate is more sensitive to details in the ibm in comparison to the variability discussed in the main text for the langevin equation eq .",
    "( 1).we are going to illustrate this by analyzing a slightly modified version of the ibm .",
    "but before doing so , we present an intuitive argument explaining one factor influencing the average growth rate : when an individual is born it experiences the current environment shorter than the average length of an environment . however , the model weights all experienced environments equally , see eq .",
    "( 7 ) in the main text .",
    "as the first experienced environment is more likely to be a good environment [ more reproduction events happen during more beneficial environments ] , higher growth rates have a larger weight in the average and the average growth rate of the variable species is effectively increased . to obtain a description including this factor",
    ", it would be best to perform a time average over all previously experienced environments .",
    "unfortunately , such a procedure is computationally very expensive .",
    "we therefore , test our explanation for the bias by not including the very first environment , the one in which an individual is born , in the averaged reproduction rate .",
    "the red dots in fig .",
    "[ fig : kernel_sel ] corresponds to simulation results for this modified model . even though all parameters are the same and for @xmath270 and @xmath281 an individual experiences in average 25 different environments , the small modification of the model substantially changes the simulation results .",
    "while the modification almost has no impact on the std of the noise , it alters the average reproduction rate .",
    "for instance the regime in which the more variable species is favored completely disappears , cf .",
    "red dots fig .",
    "[ fig : kernel_sel ] where @xmath282 for all @xmath123 .",
    "this example illustrates that on the first sight tiny details of an ibm might substantially influence the evolutionary outcome and that one should be cautious when drawing conclusions from them .",
    "importantly , the mechanism discussed in the main text does not rely on specific assumptions of the microscopic models : a finite std of the growth rate is always a disadvantage .",
    "it might be compensated for by a larger average reproduction rate but the same value of the growth rate without variability is always preferable .",
    "dependence of the fixation probability on the environmental switching rate .",
    "both species have the same @xmath268 , but only the second species is sensitive to the environment ( @xmath283 ) . for no memory ( @xmath119 ) ,",
    "both species are equally likely to fixate , as the advantage in the average growth rate of species * 2 * exactly compensates for its disadvantage due to its sensitivity on the environment . for @xmath233 those two effects do not cancel out anymore and the second species is favored .",
    "other parameters are @xmath49 , @xmath50 , @xmath284 , @xmath125 and @xmath82=100 $ ] . ]    in this section , we present additional data for the non - neutral case . fig .",
    "[ fig : compare_models ] shows the fixation probability depending on the environmental switching rate @xmath107 .",
    "in particular , we investigate extinction for a species which is not sensitive to its environment ( @xmath285 , @xmath278 ) competing with a sensitive species ( @xmath286 , @xmath287 ) for different values of @xmath123 . in the case of no memory",
    "@xmath119 both species are equally likely to fixate as the advantage in the average reproduction rate @xmath288 exactly compensates for the disadvantage due to the std of the noise in the growth rate [ see eq .  ] . for larger values of the memory parameter ,",
    "a bias favoring the species with @xmath289 is present ( the exact value of the fixation probability depends on mapping details as discussed above ) .",
    "importantly , the bias is not only present for very quickly fluctuating environments , but already emerges if reproduction events happen on a time scale comparable to @xmath140 .",
    "this supports the conclusion , that we were already drawing in the body of this paper when discussing fig .  4 : the white noise approximation is an adequate description for such an evolutionary process in that parameter regime ."
  ],
  "abstract_text": [
    "<S> one essential ingredient of evolutionary theory is the concept of fitness as a measure for a species success in its living conditions . here , we quantify the effect of environmental fluctuations onto fitness by analytical calculations on a general evolutionary model and by studying corresponding individual - based microscopic models . </S>",
    "<S> we demonstrate that not only larger growth rates and viabilities , but also reduced sensitivity to environmental variability substantially increases the fitness . even for neutral evolution , variability in the growth rates plays the crucial role of strongly reducing the expected fixation times . </S>",
    "<S> thereby , environmental fluctuations constitute a mechanism to account for the effective population sizes inferred from genetic data that often are much smaller than the census population size .    </S>",
    "<S> spencer s famous expression `` survival of the fittest ''  @xcite provides an appealing short summary of darwin s concept of evolution  @xcite . </S>",
    "<S> however , it leaves aside a very difficult yet important aspect namely identifying the factors determining the fitness of a species  @xcite : fittest individuals are by definition prevailing but the reasons facilitating their survival are not obvious . besides the difficulties arising due to the genotype phenotype mapping causing complex fitness landscapes  @xcite , also ecological factors like population structure and composition additionally complicate the issue . </S>",
    "<S> therefore traditional fitness concepts solely based on growth rates and viability were extended by frequency - dependent  @xcite or inclusive fitness approaches  @xcite . </S>",
    "<S> another important factor for the success of a certain trait , is a non - constant environment influencing birth / death rates  @xcite . </S>",
    "<S> how variable environmental conditions affect evolutionary strategies like phenotypic heterogeneity or bet - hedging has been extensively studied , see _ e.g. _  </S>",
    "<S> @xcite , yet the consequences of fluctuating reproduction rates and their interplay with demographic fluctuations were not fully elucidated .    here </S>",
    "<S> , we quantitatively investigate the impact of variable environments on the fitness . </S>",
    "<S> in contrast to other models dealing with variable environmental conditions , we do not study which strategy is optimally suited to cope with such changing environments but focus on the consequences of fluctuating reproduction rates . </S>",
    "<S> in particular , we show that an individual s sensitivity to environmental changes contributes substantially to its fitness : a reduced sensitivity increases the fitness and may compensate for large disadvantages in the average reproduction rate . </S>",
    "<S> we also find that fluctuating environments influence neutral evolution where they can cause much quicker fixation times than expected . </S>",
    "<S> these effects are relevant as constant environmental conditions are the exception rather than the norm ; for instance , the availability of different nutrients , the presence of detrimental substances and other external factors like temperature , all strongly influence reproduction / survival and occur on a broad range of time scales @xcite .    to understand the impact of fluctuating environmental conditions </S>",
    "<S> , we first consider rapidly changing environments in an evolutionary process based on birth and death events similar to  @xcite . </S>",
    "<S> the dynamics is described by the following stochastic differential equations : @xmath0 the influence of environmental variability is modeled as white noise acting on the growth rate , @xmath1 , of a trait of type @xmath2 : @xmath3 , where @xmath4 and @xmath5 is the standard deviation ( std ) of the noise . </S>",
    "<S> death rates are assumed to be constant and identical for all traits  @xcite . </S>",
    "<S> population growth is bounded and therefore death rates increase with the total population size , @xmath6 where @xmath7 is the number of @xmath2-type individuals  @xcite . </S>",
    "<S> this may account for density - dependent ecological factors such as limited resources or metabolic waste products accumulating at high population sizes . for specificity , </S>",
    "<S> we choose @xmath8 as functional form where @xmath9 is the carrying capacity scaling the maximal number of individuals and @xmath10 sets the rate of death events . beside environmental noise , </S>",
    "<S> demographic fluctuations arising from the stochastic nature of the birth - death dynamics yield the term @xmath11 , where @xmath12 is @xmath13-correlated noise , @xmath14 , with a variance given by the sum of reaction rates  @xcite . </S>",
    "<S> both multiplicative noise terms in eq .   are interpreted in the ito sense @xcite . </S>",
    "<S> note that environmental noise is linearly multiplicative in @xmath7 , which is crucial for our results .    </S>",
    "<S> let us now consider the fokker - planck equation ( fpe ) associated to eq .  , which we will use to derive fixation probabilities and times . </S>",
    "<S> we shall carry out further analysis for two different traits @xmath15 ; generalizations are straightforward . </S>",
    "<S> the transformation of eq .   to a fpe , depends on the correlation level of the environmental noise acting on distinct traits  @xcite . </S>",
    "<S> while demographic noise for different traits is always uncorrelated , the same environmental noise can affect multiple traits , e.g. if both traits feed from the same nutrients whose abundance fluctuates . </S>",
    "<S> we keep the following analysis quite general by introducing the correlation coefficient @xmath16 : for @xmath17 environmental noise is uncorrelated , @xmath18 , while @xmath19 for @xmath20 . the resulting fpe is @xmath21\\nonumber \\\\ & + \\frac{1}{2}\\sum_i   \\partial^2_{i}\\left\\ { \\left[(n_i\\sigma_i)^2 + n_i\\left(\\nu_i+\\gamma\\frac{n}{k}\\right)\\right]p\\right\\}\\ , ,   \\end{aligned}\\ ] ] where @xmath22 . to uncover the influence of environmental noise on the evolutionary dynamics , </S>",
    "<S> the relative abundances seem the natural observables . </S>",
    "<S> therefore , we change variables to the fraction @xmath23 and the total number of individuals @xmath24 . </S>",
    "<S> the fpe for @xmath25 and @xmath26 can be simplified exploiting the fact that selection , @xmath27 , is much slower than population growth @xmath28 . </S>",
    "<S> therefore , we integrate over the total population size @xmath26 , considering the fpe for the marginal distribution @xmath29 , and employing @xmath30 , see sm  @xcite . </S>",
    "<S> the resulting one - dimensional fpe reads : @xmath31q\\right\\ } \\nonumber \\\\ & + \\!\\partial^2_x\\!\\left\\{\\!\\left[\\frac{\\sigma_1 ^ 2\\!-\\!2\\epsilon\\sigma_1\\sigma_2\\!+\\!\\sigma_2 ^ 2}{2}x(1\\!-\\!x)\\!+\\!\\!\\frac{\\gamma}{k}\\right]\\ ! </S>",
    "<S> q\\right\\}\\!\\!\\equiv\\ ! { \\cal l}p(x , t ) , \\label{eq : fp}\\end{aligned}\\ ] ] where @xmath32 and the last equality defines the fokker - planck operator @xmath33 needed in the sequel . in ref </S>",
    "<S> .  @xcite a similar fpe was derived for the special case @xmath34 . for @xmath35 , </S>",
    "<S> the drift term reduces to the well - know expression @xmath36 favoring the trait with a higher growth rate  @xcite . </S>",
    "<S> note that the variability in the growth rates affects both the diffusion term and the drift , which is due to the multiplicative nature of the environmental noise .    for simplicity </S>",
    "<S> , we discuss the case of _ different environmental sensitivity _ , defined by @xmath37 and @xmath38 , _ </S>",
    "<S> i.e. _ only the reproduction rate of the first trait depends on the environment . </S>",
    "<S> the drift is then proportional to @xmath39 independent of @xmath16 . if @xmath40 , _ i.e. _ the second trait with a smaller variability in its birth rate is also faster in reproducing , the evolutionary dynamics does not change qualitatively compared to @xmath41 </S>",
    "<S> conversely , if @xmath42 , the situation changes dramatically : the growth rate favors trait * 1 * while the variability term favors trait * 2*. this leads to a stable fixed point @xmath43 for @xmath44 ( for @xmath45 variability is not sufficient to prevent extinction of trait * 2 * ) . </S>",
    "<S> such a dynamics can be interpreted as frequency - dependent fitness function . </S>",
    "<S> however , the frequency - dependence arises here from environmental noise and not from a pay - off matrix  @xcite as in standard evolutionary game theory .    , depending on selection strength , @xmath46 , and variability @xmath47 according to eq .  . </S>",
    "<S> other parameters are @xmath48 , @xmath38 , @xmath49 and @xmath50 . </S>",
    "<S> the black line indicates the parabola @xmath51 , which is our prediction for @xmath52 . </S>",
    "<S> the inset shows cuts for exemplary values of @xmath53 in @xmath54red , violet , blue , green@xmath55 . </S>",
    "<S> [ fig : a ] ]    even though environmental variability causes a drift term favoring the traits which is less sensitive to environmental changes  @xcite , the interplay between drift and diffusion term has to be understood to predict the evolutionary outcome . </S>",
    "<S> this is even more important as for the particular situation discussed here , the environmental contribution to the drift caused by @xmath5 is intrinsically connected to the diffusion term . </S>",
    "<S> therefore we study the fixation probability , _ </S>",
    "<S> i.e. _ the probability that trait * 1 * fixates or trait * 2 * goes extinct . </S>",
    "<S> this quantity can be calculated by solving the backward fpe , @xmath56 for the boundary conditions @xmath57 and @xmath58 . the solutions is given by ( for details see sm ) , @xmath59}\\right\\}}{1-\\exp{\\left\\{2\\zeta\\ , \\text{tanh}^{-1}\\alpha\\right\\ } } } , \\label{eq : fix_prob}\\end{aligned}\\ ] ] with @xmath60 , @xmath61 and @xmath62 in fig .  </S>",
    "<S> [ fig : a ] we show the fixation probability for different values of @xmath46 and @xmath37 ( @xmath38 ) . </S>",
    "<S> results are obtained by the numerical solution of eq .  , _ i.e_. before marginalization on @xmath26 . the parabola @xmath51 ( fig .  </S>",
    "<S> [ fig : a ] black line ) defined by @xmath63 ( or @xmath52 ) , separates the regions where one of the two traits is predominant : in the grey ( green ) area , the smaller variability ( growth rate ) dominates , respectively . </S>",
    "<S> the general case of both species having variable birth rates yields analogous results : a selection advantage for the trait with less variability . in the inset , </S>",
    "<S> the fixation probability depending on @xmath64 is compared to the analytic solution ( eq .  ) for the four values @xmath53 . </S>",
    "<S> both plots demonstrate the advantage of the less variable trait . for strong environmental variations </S>",
    "<S> it is then beneficial for a species to minimize its sensitivity to those variations rather than optimizing its growth rate . </S>",
    "<S> interestingly one can interpret this result in the context of game theory : decreasing the sensitivity to environmental changes also means to optimize the worst case scenario outcome : the average birth rate is the least reduced when the variability is small . in game theory </S>",
    "<S> , this corresponds to the maximin strategy which was shown to be very successful in many fields as finance , economy or behavioral psychology  @xcite . in the context of evolutionary dynamics </S>",
    "<S> another example of a maximin strategy was proposed for bacterial chemotaxis where bacteria move move so as to optimize their minimal uptake of chemoattractants  @xcite .    besides contributing to the fitness </S>",
    "<S> , environmental variability also influences fixation probability and time in the case of _ neutral evolution _ , _ </S>",
    "<S> i.e. _ @xmath65 and @xmath66 . </S>",
    "<S> such analysis is of great interest , as evolution is often studied by investigating how neutral mutations evolve over time . in recent years </S>",
    "<S> fast - sequencing techniques made huge amounts of data available , see , _ e.g. _ , @xcite , which is now analyzed and interpreted by comparison to evolutionary models as the moran or fisher - wright models  @xcite . while the correlation parameter does not qualitatively influence results discussed so far , it plays an important role for neutral evolution . for fully correlated noise , @xmath67 , eq .   </S>",
    "<S> is the same as for @xmath68 and thereby correspond to the ones obtained for no environmental noise , extinctions are solely driven by demographic fluctuations and well - known results apply  @xcite . </S>",
    "<S> in contrast , for all other values of @xmath16 , including uncoupled noise @xmath69 , the dynamics differs in two major respects . </S>",
    "<S> first , the drift term @xmath70 does not vanish and corresponds to a stable fixed point at @xmath71 . </S>",
    "<S> second , the diffusion term consists of demographic @xmath72 and environmental fluctuations @xmath73 . </S>",
    "<S> as the drift suppresses extinction events while a larger diffusion term favors them , a more detailed analysis is required to grasp the evolutionary outcome .    due to the stable fixed point </S>",
    "<S> , the fixation probability qualitatively differs from the linear dependence @xmath74 which holds for constant or uncorrelated environments . in fig  [ fig:2]a ) , typical solutions for @xmath67 and @xmath69 are shown which clearly demonstrated the ensuing s - shape for the uncorrelated case ( @xmath69 ) .     and @xmath69 . </S>",
    "<S> parameters are : @xmath75 , @xmath50 , @xmath76 and @xmath49 . </S>",
    "<S> dots are simulations of the ibm . </S>",
    "<S> additional parameters are @xmath77 , @xmath78 , @xmath79 , @xmath80 , @xmath81 , and @xmath82\\!=\\!100 $ ] . </S>",
    "<S> [ fig:2 ] ]    another important quantity , the extinction time , @xmath83 , also obeys a backward fpe , @xmath84 . employing the boundary conditions @xmath85 </S>",
    "<S> , the fixation time in the neutral case ( @xmath86 and @xmath87 ) can be calculated  @xcite : @xmath88\\ , , \\label{eq : fix_time}\\end{aligned}\\ ] ] where @xmath89 , @xmath90 , @xmath91 , the function @xmath92 and @xmath93 is the polylogarithm . </S>",
    "<S> the result for @xmath94 differs again from the non - fluctuating / fully correlated scenario , @xmath95 $ ] ( see fig .  </S>",
    "<S> [ fig:2]b ) . </S>",
    "<S> fluctuating environments decrease the fixation times for all initial conditions . </S>",
    "<S> this has a crucial consequence : when measuring extinction times and comparing them to standard models without environmental fluctuations , one can only explain large diffusion constants by small population sizes . </S>",
    "<S> indeed , it is often found that effective population sizes are much smaller than the census population sizes   @xcite . </S>",
    "<S> fig .  </S>",
    "<S> [ fig:3 ] shows that conspicuous orders - of - magnitude reductions in the population size set in already at moderate levels of environmental noise . amongst other explanations this could account for a difference between effective and census population size . in other words as long as the level of environmental noise and the correlation level of its influence on different growth rates is not known , the effective population size can only be interpreted as a lower bound for the census population size .    . </S>",
    "<S> using , we plot the values of the population size @xmath9 and noise @xmath96 that lead to the fixation time @xmath97 for @xmath49 . </S>",
    "<S> the black line corresponds to @xmath98 ( see ) , i.e. either perfectly correlated noise or no environmental noise . in the presence of environmental noise , the values of @xmath9 are systematically higher and increase several orders of magnitude even for moderate noise levels . </S>",
    "<S> [ fig:3 ] ]    to further investigate the impact of variable environmental conditions , we introduce an exemplary individual based model ( ibm ) . </S>",
    "<S> in particular , the ibm serves as a proof of principle that linear multiplicative noise can be realistically expected and enables us to study the effect of such noise beyond the white noise regime . </S>",
    "<S> importantly , our results presented above hold for any microscopic model whose macroscopic representation is given by eq .  , _ </S>",
    "<S> i.e. _ where noise in the birth or death rates is linearly multiplicative . in specific scenario discussed here , the reproduction rate of an individual , @xmath99 , at time @xmath100 , depends a priori on the history of environmental conditions experienced during its lifetime @xmath101 $ ] , where @xmath102 is the time of birth . </S>",
    "<S> this could for example account for the level of nutrients or detrimental substances that individuals are exposed to . </S>",
    "<S> following  @xcite , our model is based on independent birth and death rates , now depending on the environmental variations subsumed in the scalar value @xmath103 . the number of environments experienced by an individual , @xmath99 , is denoted as @xmath104 and their values are contained in a vector @xmath105 . for the fully correlated case ( @xmath106 ) , @xmath103 is the same for both traits while two different values are drawn for @xmath17 . </S>",
    "<S> environmental conditions change stochastically at rate @xmath107 and are distributed according to a distribution , @xmath108 , with mean @xmath109 and variance @xmath82 $ ] .    </S>",
    "<S> we first consider a constant environment @xmath103 . the average _ instantaneous growth rate _ </S>",
    "<S> @xmath110 is assumed to be a positive , monotonically increasing function of @xmath103  @xcite . in particular , we consider the sigmoidal function : @xmath111 with @xmath112 the ordinate of the inflection point , @xmath113 the maximal deviation from it , and @xmath114 scales the sensitivity to environmental changes .    </S>",
    "<S> let us now consider changing environments and individuals whose current growth rate memorizes previously experienced environments . the reproduction rate @xmath115 of an individual , @xmath99 , of type @xmath2 now depends on the whole vector , @xmath116 . for concreteness </S>",
    "<S> , we assume that the rate is @xmath117 where the memory parameter @xmath118 $ ] defines the influence of previously experienced environments upon an individual s growth rate . </S>",
    "<S> for @xmath119 only the current environment sets @xmath120 , while for @xmath121 all experienced environments , @xmath104 , have the same influence in the arithmetic mean @xmath122 . </S>",
    "<S> independent of @xmath123 we assume that offsprings lose memory at the time of reproduction . </S>",
    "<S> bounded growth is modeled by death rates @xmath124 .    to compare the results of the microscopic individual based model to the effective stochastic model , eq .  </S>",
    "<S> , the parameters of both models have to be mapped . for simplicity </S>",
    "<S> let us consider the case @xmath125 and a symmetric distribution @xmath108 throughout the following discussion . </S>",
    "<S> since death rates are constant , there is a direct correspondence between them in the langevin and the ibm . for birth rates and their stds </S>",
    "<S> the situation is more intricate as we discuss hereafter . for the no - memory case ( @xmath119 ) an exact mapping </S>",
    "<S> is obtained  @xcite : for strong fluctuations , @xmath126\\gg 1 $ ] , the mean of the growth rate @xmath1 and std of the noise @xmath5 in eq .   </S>",
    "<S> are given by : @xmath127 note that the variability in the growth rate not only results in @xmath128 , but also influences the average reproduction rate @xmath1 . while for @xmath119 such a variability increases @xmath1 , the second term of @xmath1 is reduced while @xmath123 increases till it changes sign ( see sm  @xcite for details ) . </S>",
    "<S> for instance , for @xmath129 the growth rate is approximately @xmath130 . </S>",
    "<S> hence , the more variable trait has a disadvantage in the average reproduction rate in addition to the effects discussed above . for @xmath129 , the approximation @xmath131 holds  @xcite . </S>",
    "<S> dependencies in this expression are intuited as follows . the number of environmental changes an individual experiences until the memory resets is of the order @xmath132 , where @xmath133 is the typical time for an individual to reproduce or die . </S>",
    "<S> as environmental changes are independent random events , the variance of the reproduction rates is @xmath134 . </S>",
    "<S> the expression for @xmath135 is finally obtained noting that correlations in the noise extend over times @xmath136 therefore it follows that the average reproduction rate @xmath1 drops out .    </S>",
    "<S> comparison of the ibm and the langevin model . </S>",
    "<S> we show the fixation time for neutral evolution for @xmath137 _ vs _ the environmental switching rate @xmath107 . </S>",
    "<S> dots correspond to the ibm [ @xmath119 ] for different values of @xmath139 in red , blue and green . </S>",
    "<S> black lines are analytic solutions [ eq .   with eq .  </S>",
    "<S> ] . for quickly fluctuating environments both results are in good agreement whilst for large @xmath140 the white noise approximation fails . </S>",
    "<S> other parameters are as in fig .  </S>",
    "<S> [ fig:2 ] . ]    for a detailed comparison of the ibm with the analytics derived in the first part of this paper , we simulate the ibm with a modified gillespie algorithm updating reproduction rates after every environmental change  @xcite . as shown in figs .  </S>",
    "<S> [ fig:2]a ) and b ) , results for fixation probability and time , are in very good agreement with analytic solutions [ eqs .   and ] . </S>",
    "<S> in particular , the sigmoidal shape of the fixation probability is well reproduced by the ibm , supporting the existence and importance of linear multiplicative noise .    </S>",
    "<S> finally , the ibm enables us to study the environmental switching rate . </S>",
    "<S> this is of main interest as results obtained previously strictly only hold for very rapidly fluctuating environments . in fig .  </S>",
    "<S> [ fig : change_env ] , the dependency on @xmath140 of the extinction time in the neutral case for @xmath137 is shown for different @xmath141 ; see sm for results with @xmath142  @xcite . </S>",
    "<S> the black lines correspond to eq .   </S>",
    "<S> mapped according to eqs .   and </S>",
    "<S> dots are obtained by stochastic simulations of the ibm for @xmath119 . for @xmath143 </S>",
    "<S> both models are in very good agreement . </S>",
    "<S> this demonstrates that the white noise approximation is valid in a broad parameter range , where fluctuating environments substantially influence the evolutionary dynamics .    in summary </S>",
    "<S> , we demonstrated that environmental variability has crucial impact on evolutionary fitness . </S>",
    "<S> first , we quantified the role of reduced sensitivity to environmental changes and determined how it substantially increases the fitness . </S>",
    "<S> second , we showed that the timescale of extinction in the neutral case is strongly affected by environmental noise . </S>",
    "<S> that provides a mechanism to explain experimental observations of population sizes that are often much smaller than expected . </S>",
    "<S> finally , we investigated individual based models that generate the linear multiplicative noise considered here </S>",
    "<S> . it will be of interest to investigate how different forms of memory or time - dependent reproduction rates influence evolution and to integrate them with evolutionary game models .    </S>",
    "<S> 28 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , _ _ ( , ) .    , </S>",
    "<S> _ _ ( , ) , .    , * * , ( ) .    , , , * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , , , * * , ( ) .    , * * ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , , , , * * , ( ) .    , * * , ( ) .    , , , * * , ( ) .    , * * ( ) .    , * * ( ) .    , * * , ( ) .    , , , * * , ( ) .    , , , , , * * ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , _ _ ( , ) , ed .    , </S>",
    "<S> * * , ( ) .    , </S>",
    "<S> _ _ ( , , ) .    , </S>",
    "<S> _ _ ( , , ) .    , * * , ( ) .    , </S>",
    "<S> _ _ ( , ) .    , </S>",
    "<S> _ _ ( , ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , , , * * , ( ) .    , , , * * , ( ) .    in this supporting material , we provide more details on the calculations leading to the one - dimensional fokker - planck equation ( fpe ) , eq .  </S>",
    "<S> ( 3 ) main text . </S>",
    "<S> moreover , we present calculations for the average fixation time and the extinction probability . </S>",
    "<S> we discuss the mapping of the individual based model ( ibm ) to the langevin model . for the no - memory limit we present an analytic derivation of the mapping . for other parameter values </S>",
    "<S> we give heuristic arguments that are supported by additional data . </S>",
    "<S> finally , we present results for non - neutral evolution investigating the regime in which the white noise approximation is an adequate description for the evolutionary process . </S>"
  ]
}