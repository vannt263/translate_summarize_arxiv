{
  "article_text": [
    "optimal control theory @xcite is a versatile tool to tackle tasks in quantum information science , allowing to reach very high fidelities in state preparation  @xcite and manipulation  @xcite for complex quantum systems .",
    "very recently the field of application of optimal control has also been extended also to many body quantum systems  @xcite .",
    "optimal control represents a mathematical toolbox which processes its input , the desired physical target and constraints as well as the quantum system s equation of motion , to yield external controls that drive the dynamics towards the target as best possible .",
    "the optimized controls thus depend crucially on a proper mathematical formulation of the physical ingredients .",
    "for example , it is possible to obtain controls that are robust with respect to experimentally unavoidable fluctuations by accounting for these fluctuations in the optimization  @xcite .",
    "similarly , when treating the quantum system as open , one can explore the limits on fidelity imposed by decoherence  @xcite or identify control mechanisms that rely on the coupling to the environment  @xcite .",
    "optimal control also allows to develop time - optimal strategies , resulting in protocols that perform transformations at the fastest possible pace  the so called quantum speed limit ( qsl )  compatible with energy and information constraints  @xcite .    while fluctuations and coupling to the environment enter the equation of motion , the optimization goal and additional constraints are expressed in the optimization functional .",
    "one can target a state - to - state transition  @xcite , a quantum gate  @xcite , or a certain class of quantum gates  @xcite .",
    "it is also possible to minimize the system energy  @xcite , maximize entanglement  @xcite , or prescribe a desired time evolution  @xcite , as well as targeting an unknown stable and maximally entangled states  @xcite .",
    "typical constraints include finite pulse energy  @xcite and bandwidth  @xcite or smoothness of the control  @xcite .",
    "constraints naturally limit the resources available for control and thus restrict the search .",
    "this does not only slow down convergence of the optimization , but may also prevent reaching the target with sufficient fidelity altogether  @xcite .    similarly , formulating the optimization target in an overly specific way may unnecessarily restrict the flexibility of optimization .",
    "for example , in the circuit model of quantum computing , the capability to implement an entangling two - qubit gate is required  @xcite .",
    "this may be the controlled not gate but any gate within the local equivalence class of cnot , i.e. , all gates that differ from cnot only by single qubit operations , will work equally well  @xcite .",
    "however , the time evolution of gates in the same local equivalence class is generated by hamiltonians which may be very different .",
    "for example , diagonal hamiltonians are sufficient to generate a controlled phasegate which is locally equivalent to cnot , whereas cnot itself requires non - diagonal entangling terms .",
    "thus , optimization for the cnot gate does not have any effect if the hamiltonian is diagonal but targeting an arbitrary gate in the local equivalence class of cnot with the same hamiltonian is effective  @xcite .",
    "the corresponding optimization functional utilizes the geometric theory of non - local two - qubit operations  @xcite .    for other applications in quantum information science",
    ", the optimization target can be formulated even more generally than the functional for a gate within a certain local equivalence class .",
    "for example , the capability to implement an arbitrary perfect entangler ( pe ) is sufficient in quantum communication .",
    "perfect entanglers make up a large part of all entangling two - qubit operations . therefore , extending the optimization functional targeting a specific local equivalence class to comprise all perfect entanglers holds the promise of a significantly more flexible and easier search .",
    "this flexibility is crucial when very high fidelities are required or when optimal control theory is utilized to identify fundamental limits for control in a numerical search .    in the preceding paper  @xcite ,",
    "two variants of an optimization functional targeting all two - qubit perfect entanglers have been developed . here",
    ", we apply these functionals to two quantum information platforms that currently enjoy great popularity , nitrogen vacancy ( nv ) centers in diamond and superconducting josephson junctions , due to their promise of control and scalability . in particular , both are candidates for use in hybrid systems which shall provide the interconnect between information processing and communication platforms .",
    "the two variants of the perfect entanglers functional differ in the representation of the two - qubit non - locality , utilizing either the coefficients @xmath0 , @xmath1 , @xmath2 of @xmath3 , @xmath4 , @xmath5 in the canonical parametrization of two - qubit gates or the so - called local invariants  @xcite .",
    "the latter offer the advantage that they can be calculated from the time evolution in a closed analytical formula .",
    "this is a prerequisite for optimization algorithms using gradient information  @xcite . due to the non - linear relation between the coefficients @xmath0 , @xmath1 , @xmath2 and the local invariants ,",
    "the topology underlying the two optimization functionals is rather different  @xcite . while the @xmath6-space ( the space spanned by the coefficients @xmath0 , @xmath1 , @xmath2 ; we refer to this also as the weyl chamber due to the symmetries of the @xmath6-space  see ref",
    ".  ) variant is expected to provide for a more direct approach towards the target , gradient algorithms can use more information of a given control landscape . in order to investigate whether the topology underlying the optimization functional influences the final fidelities , we employ two different optimization methods , chopped random basis ( crab ) optimization , which combines a gradient - free search with a randomized parametrization of the control  @xcite , and krotov s method , which utilizes gradient information  @xcite .",
    "our paper is organized as follows .",
    "we first present the models for our applications , nv centers in diamond and superconducting charge and transmon qubits , in sec .",
    "[ sec : models ] .",
    "section  [ sec : crab ] reviews the crab optimization algorithm which utilizes the perfect entanglers functional based on the coefficients @xmath0 , @xmath1 , @xmath2 .",
    "krotov s method with the corresponding perfect entanglers functional written in terms of the local invariants is presented in sec .",
    "[ sec : krotov ] .",
    "our numerical results are discussed in sec .",
    "[ sec : appl ] for the three models , and we conclude in sec .",
    "[ sec : concl ] .",
    "an optimization functional that allows for a very flexible search is only useful when the system dynamics is sufficiently complex to explore different areas of the search space . in paper",
    "i  @xcite , the two - qubit hamiltonian @xmath7 with @xmath8 the @xmath9th pauli operator acting on the @xmath10th qubit and @xmath11 the control field , was shown to allow for a non - trivial search in the weyl chamber .",
    "the weyl chamber is the geometric space spanned by the non - local coefficients @xmath0 , @xmath1 , @xmath2 , taking into account reflection symmetries , see ref .  .",
    "here , we extend the discussion to specific physical examples , starting with an nv center in diamond , followed by superconducting transmon and charge qubits .",
    "the hamiltonians of the latter two can be related to eq .  , although for realistic parameters , additional levels , beyond the logical two - qubit space , have to be taken into account .",
    "the electronic states @xmath13 and @xmath14 correspond to the ground @xmath15 and degenerate @xmath16 sublevels of the @xmath17 triplet state of the two unpaired electrons of the nv center ( see ref .  ) .",
    "the energy levels are not drawn to scale . ]    for an nv center in diamond , we employ the nv+@xmath18c model of refs .",
    "@xcite for the ground @xmath19a state of the nv center coupled to a @xmath18c nuclear spin .",
    "this comprises the four states @xmath20 , @xmath21 , @xmath22 , and @xmath23 , where the electronic states @xmath13 and @xmath14 correspond to the ground @xmath15 and degenerate @xmath16 sublevels of the @xmath17 triplet state of the two unpaired electrons of the nv center ( see figure  [ fig : nvlevels ] )",
    ". transitions between these levels are driven by a radio frequency field , @xmath24\\,,\\ ] ] and a microwave field , @xmath25\\,,\\ ] ] as depicted in fig .",
    "[ fig : nvlevels ] . in the interaction picture ( @xmath26 ) under the rotating wave approximation ,",
    "the corresponding hamiltonian reads @xmath27 with @xmath28 .",
    "if we tune the radiation fields onto resonance , @xmath29 , only two driving terms are retained in eq .",
    ", i.e. , @xmath30 with @xmath31 for a gate duration of @xmath32 , typical amplitudes for the optimized pulses are on the order of @xmath33mhz and @xmath34khz .",
    "the interaction described by eqs .   and   is of different form than eq .",
    ", and thus we have to analyze controllability separately .",
    "this is straightforward : labelling @xmath35 , @xmath36 , their commutator yields @xmath37   = -{\\boldsymbol{\\mathsf{\\hat{\\sigma}}}}_x{\\boldsymbol{\\mathsf{\\hat{\\sigma}}}}_y     -{\\boldsymbol{\\mathsf{\\hat{\\sigma}}}}_y{\\boldsymbol{\\mathsf{\\hat{\\sigma}}}}_x\\,.\\ ] ] the nested commutators read @xmath38= -{\\boldsymbol{\\mathsf{\\hat{a}}}}_2 , \\quad   [ { \\boldsymbol{\\mathsf{\\hat{a}}}}_2,{\\boldsymbol{\\mathsf{\\hat{a}}}}_3]={\\boldsymbol{\\mathsf{\\hat{a}}}}_1\\,.\\ ] ] therefore , the lie algebra is closed under just the three operators @xmath39 , @xmath40 , @xmath41 .",
    "these operators are not linearly independent ( up to local transformations ) and correspond to only two dimensions of the weyl chamber , specifically the ground plane .",
    "we also consider the case of a non - zero detuning @xmath42 in eq .  .",
    "this results in a third control hamiltonian , @xmath43 @xmath42 is on the order of 1@xmath44mhz .",
    "this additional terms provides the missing commutators necessary to reach every point in the weyl chamber .",
    "both cases , @xmath45 and @xmath46 , allow for a non - trivial search in the weyl chamber , making it a suitable candidate for optimization employing the perfect entanglers functional .      .",
    "the interaction is driven by @xmath47 . ]    as an example relating more directly to eq .  , we consider two superconducting charge qubits coupled via a josephson junction @xcite , as depicted in fig .",
    "[ fig : jcq - sketch ] .",
    "the local hamiltonian reads @xmath48\\,.\\end{aligned}\\ ] ] we can control the josephson coupling @xmath49 , while the charging energy @xmath50 and the offset charge @xmath51 are fixed . in order to make the connection to eq .",
    "explicit , we truncate each anharmonic ladder to two levels , @xmath52\\,,\\ ] ] omitting terms proportional to the identity . as was shown in paper  i  @xcite ,",
    "only a two - dimensional subsection of the weyl chamber can be reached at the degeneracy point , i.e. @xmath53 . here",
    ", as we are more interested in the control problem than in its possible experimental realization and thus its robustness against noise , we set @xmath54 , lifting the degeneracy between the qubit levels and ensuring full controllability .",
    "the interaction is described by @xmath55 or @xmath56 if truncated to two levels .",
    "typically , @xmath50 takes values between 20@xmath44ghz and 200@xmath44ghz , and @xmath57 is between @xmath58 and @xmath59 .",
    "both single and two - qubit gates can be implemented on a picosecond time scale @xcite .",
    "the two - level truncation of the hamiltonian is generally only accurate near the charge degeneracy point . for the parameters considered here",
    ", higher levels have to be taken into account .",
    "the transmon qubit @xcite is closely related to the charge qubit , but operated in a different parameter regime , @xmath60 .",
    "this makes them significantly less anharmonic than typical charge qubits , but more robust with respect to charge noise .",
    "the coupling between two transmons is implemented via a shared transmission line resonator ( `` cavity '' ) .",
    "the energy of each transmon qubit transition is denoted by @xmath61 , @xmath62 for the first ( `` left '' ) and second ( `` right '' ) transmon , respectively .",
    "higher levels are given as a duffing oscillator with anharmonicity @xmath63 , @xmath64 .",
    "each qubit couples to the cavity with coupling strength @xmath65 , @xmath66 . in the dispersive limit @xmath67 ( @xmath68 ) with @xmath69 the cavity frequency",
    ", the cavity can be eliminated and an effective two - transmon hamiltonian is obtained .",
    "the coupling between each transmon and the cavity turns into an effective qubit - qubit coupling , @xmath70 in most current setups , @xmath71 , and the two - transmon hamiltonian can be approximated as @xcite @xmath72 where @xmath73 is the driving field that couples to the cavity .",
    "typical parameters are listed in table  [ tab : transmon_parameters ] .",
    ".parameters for the transmon hamiltonian eq .   [ cols= \" <",
    ", < , > , < \" , ]     .",
    "[ tab : transmon_parameters ]    a hamiltonian of the form of eq .",
    "is obtained by truncating the higher levels , @xmath74    finally , notice that in systems b and c , the assumption that only two qubit levels are populated leading to eqs .   and",
    "might not hold in general , however , we present it to make the connection to eq .   and",
    "the controllability analysis of paper  i  @xcite explicit .",
    "a common choice for a fidelity that quantifies whether an obtained gate @xmath75 corresponds to the target gate @xmath76 is @xcite @xmath77 \\right|^2\\,.\\ ] ] in the context of the geometric theory for two - qubit gates , reviewed in paper  i  @xcite , where arbitrary local transformations are allowed , the generalization of this fidelity can be expressed through the difference of the weyl chamber coordinates of the obtained gate @xmath75 and the target point , @xmath78 this fidelity can also be used as a functional for optimizing towards gates of a given local equivalence class as shown in the preceding paper .",
    "building on the local equivalence class functional , a functional @xmath79 for the optimization of an arbitrary perfect entangler can be derived . in the weyl chamber ,",
    "the perfect entanglers form a polyhedron confined by the three planes    @xmath80    these planes divide the weyl chamber into the polyhedron of perfect entanglers and three corners of non - perfect entanglers . within the perfect entangler polyhedron , the functional is defined to take the value @xmath81 .",
    "outside of the polyhedron , the value of @xmath79 depends on the region of the weyl chamber the gate is in , @xmath82 as shown in the preceding paper , both @xmath83 and @xmath79 are not only optimization functionals but have also a nonlocal fidelity interpretation .    generally , the logical two - qubit subspace is embedded in a larger hilbert space , such that while the dynamics in the total hilbert space are unitary , the dynamics in the subspace may not be . in this case ,",
    "a closest unitary @xmath75 can be derived from the non - unitary ( projected ) gate @xmath84 : if @xmath84 has the singular value decomposition @xmath85 , then the unitary that fulfills @xmath86 is given by @xmath87 .",
    "the local equivalence - class and perfect entangler fidelities then become @xmath88 these fidelities can be directly used as optimization functionals .",
    "the optimization target is then to find @xmath89 in such a way that eqs .   and",
    "are maximized .",
    "the chopped random basis ( crab ) algorithm  @xcite is an optimal control tool that allows to optimize quantum operations in cases where it is either not possible or impractical to calculate gradients of the optimization functional . in the present context , it is mathematically unfeasible to calculate gradients of @xmath83 and @xmath79 as given in eqs .  , with respect to the states ( as needed for the krotov update formula in sec  [ sec : krotov ] below ) , since the functionals depends on the states in a highly non - trivial way .",
    "the central idea of crab is the expansion of the control function into a truncated basis using random basis functions  @xcite , @xmath90 where the set of @xmath91 form the truncated basis .",
    "we choose @xmath92 with random @xmath93 $ ] .",
    "the coefficients @xmath89 are optimized by a direct search algorithm , nelder - mead downhill simplex in our case .",
    "for optimal control approaches utilizing gradient information , the capability to take the derivative of the optimization functional with respect to the unitary @xmath75 , or equivalently , with respect to the time - evolved basis states , is required .",
    "this is not possible for the functionals in eqs .   and  .",
    "we therefore use an equivalent functional , based not on the weyl chamber coordinates @xmath0 , @xmath1 , @xmath2 , but on the local invariants @xmath65 , @xmath66 , @xmath95  @xcite .    an appropriate functional to optimize towards gates in a local equivalence class",
    "is given by  @xcite @xmath96 where @xmath97 is the euclidean distance between local invariant @xmath98 of the obtained unitary @xmath75 and that of the optimal gate @xmath99 .",
    "for the perfect entanglers , the functional becomes  @xcite @xmath100 both of these functionals take the value zero if the goal is reached .",
    "they are thus distance measures , as opposed to the fidelities in eqs .  , , and they are not restricted to lie within the range @xmath101 $ ] .    again , non - unitarity due to projection onto the logical subspace must be taken into account .",
    "however , the expression @xmath102 , similarly to the functionals @xmath83 , @xmath79 used in sec  [ sec : crab ] , can not easily be differentiated . as an alternative , we minimize the loss of population @xmath103/4 $ ] from the logical subspace , @xmath104\\right )    \\label{eq : j_li_tilde}\\\\    \\mathcal{d}(\\tilde u )    & = & w \\mathcal{d}(u ) + ( w-1 ) \\left(1 - \\frac{1}{4 }      { \\operatorname{tr}}\\left [ \\tilde u^\\dagger \\tilde u \\right]\\right)\\ , .",
    "\\label{eq : j_pe_tilde}\\end{aligned}\\ ] ] in eqs .",
    ", , the factor @xmath105 $ ] is used to weight the relative importance of weyl - chamber optimization and unitarity .",
    "it can adaptively be changed during the optimization in order to improve convergence .      in krotov",
    "s method , the total functional @xmath106 must include a control - dependent running cost in order to derive an update equation .",
    "@xmath106 takes the form @xmath107    + \\int_0^t    \\frac{\\lambda_a}{s(t ) }      \\left [ u(t ) - u_\\mathrm{ref}(t)\\right]^2   \\;dt \\,,\\ ] ] where @xmath108 is a final - time functional , e.g.eq .   or  .",
    "the second term is a constraint on the optimized control field @xmath109 . taking the reference field @xmath110 to be",
    "the field from the previous iteration ensures that close to the optimum the functional is improved only due to changes in the actual target @xmath108  @xcite .",
    "a comprehensive description of krotov s method for quantum control problems is found in ref .",
    "@xcite . here",
    ", we state the control equations for a final - time functional @xmath108 that depends higher than quadratically on the states , linear coupling to the control and linear equations of motion . in this case , the update equation for the control at the @xmath111st iterative step , @xmath112 , is given by    @xmath113    with @xmath114 representing the change in state @xmath115 . in eq .  ,",
    "@xmath116 is a shape function to smoothly switch the control on and off , and @xmath117 is a parameter that determines the step size of the change in the control . the scalar function @xmath118 is constructed to ensure monotonic convergence . for final - time functionals that depend higher than quadratically on the states @xmath119 , linear equations of motion and linear coupling to the control",
    ", it reads  @xcite @xmath120 with @xmath121 , where @xmath122 is a small non - negative number that can be used to enforce strict inequality in the second order optimality condition .",
    "the parameter @xmath123 depends on the final - time functional . in principle",
    ", it is possible to determine a supremum for @xmath123 that guarantees convergence . in practice",
    ", one should determine the optimal value for @xmath123 in each iteration numerically  @xcite ,    @xmath124      + j_t\\left(\\{\\varphi_k^{(i+1)}(t)\\}\\right )      -j_t\\left(\\{\\varphi_k^{(i)}(t)\\}\\right ) }    { \\sum_{k=1}^{4}\\left [        \\braket{\\delta{\\varphi}_k\\left(t\\right)|\\delta{\\varphi}_k\\left(t\\right)}\\right ] }    \\,.\\end{aligned}\\ ] ]    evaluation of the update equation for the control , eq .  , implies forward propagation of the logical basis states and backward propagation of the adjoint states .",
    "the forward propagation of the logical basis uses the new control , as indicated by the superscript @xmath125 ,    [ eq : forward_prop ] @xmath126    |{\\varphi}^{(i+1)}_k(t)\\rangle \\\\",
    "|{\\varphi}^{(i+1)}_k(0)\\rangle & = & |k\\rangle \\,,\\quad k=1,\\ldots , 4    \\,.\\end{aligned}\\ ] ]    the adjoint states are propagated backward in time under the old control , @xmath127 ,    [ eq : backward_prop ] @xmath128    |\\chi^{(i)}_k\\rangle   \\\\    |\\chi^{(i)}_k(t)\\rangle & = & -\\nabla_{\\bra{{\\varphi}_k } }    j_t\\big|_{|{\\varphi}^{(i)}_k(t)\\rangle }    \\ , \\label{eq : chit }    \\end{aligned}\\ ] ]    for the @xmath129 states that constitute the logical two - qubit basis . note that it is eq .",
    "that necessitates a functional that is differentiable with respect to the states .",
    "the initial condition for the adjoint states is given in terms of the final - time functional , @xmath108 .",
    "we use either one of the functionals in eqs .   and  .",
    "for a system whose dynamics do not leak out of the logical subspace , such as nv centers in diamond introduced in section  [ subsec : model : nv ] , optimization towards a perfect entangler is a powerful tool , given that half of all possible two - qubit gates are perfect entanglers .",
    "since without leakage any control is guaranteed to yield a fully unitary gate , the likelihood of finding a perfect entangler already with an arbitrary control is large , provided the gate duration is sufficiently long .    in fig .  [",
    "fig : nv_controllability ] , a sampling of all the gates obtained during an optimization of the hamiltonian   is shown , for two pulses , @xmath130 and @xmath131 ( left ) , cf .",
    "eqs .   and  , as well as for a third control @xmath42 ( right ) , cf .",
    "eq .  . the gates from an optimization towards the polyhedron of perfect entanglers , using the functional of eq",
    ".  , are indicated by black dots .",
    "the optimization was performed using the crab algorithm and was allowed to continue even after reaching a perfect entangler .",
    "furthermore , an optimization towards the local equivalence class of the points @xmath132 and @xmath133 ( which are corners of the polyhedron of perfect entanglers  see paper  i  @xcite for interpretation ) using the functional of eq .  , encountered the gates shown by blue and red dots , respectively",
    "in all cases , the results confirm the predictions of section  [ subsec : model : nv ] : for two controls all gates lie in the ground plane of the weyl chamber , whereas for three controls every part of the weyl chamber is reached .",
    "since @xmath132 and @xmath133 are not reachable using only two control fields , the optimization only yields success for the pe - functional , within at most two iterations . nonetheless , the gates obtained from _ all _ optimization targets ( that is pe - functional and the local equivalence classes p and n ) sample the entire reachable region ; the black , red , and blue points in fig .",
    "[ fig : nv_controllability ] ( left ) each evenly cover the entire ground plane of the weyl chamber .    for three controls ,",
    "the system shows full controllability , and the gates from different optimization targets cluster in different regions .",
    "the gates from the pe optimization evenly fill most of the front half of the pe polyhedron , whereas the local - equivalence - class optimizations cluster in the direction of their respective target points . in all cases ,",
    "the desired target is reached .",
    "however , there is a dramatic difference in the effort required in the different cases . for the perfect entanglers ,",
    "the optimization target was reached within usually one or two optimization steps .",
    "in contrast , for the optimization towards the @xmath132 and @xmath133 points , at least several hundred iterations were necessary .",
    "the optimization problem becomes more difficult once the model accounts for the possibility of leakage out of the logical subspace , which is the case for superconducting qubits . as a first example , we optimize the system of coupled charge qubits described in sec .",
    "[ subsec : model : charge ] , using the crab algorithm . for each qubit ,",
    "six levels were taken into account , and thus leakage from the logical subspace had to be considered , cf .",
    "eqs .   and  .     and total time @xmath134ns .",
    "the error @xmath135 for optimization toward the polyhedron of perfect entanglers ( pe ) is compared to the error @xmath136 for optimization towards the local equivalence classes of different points in the weyl chamber @xmath137 , @xmath132 , and @xmath138 . ]     and total time @xmath134ns , using the pe functional as well as the local invariants functional for the points @xmath123 , @xmath132 , @xmath138 .",
    "the end points of the optimization for the results shown in fig .",
    "[ fig : jcq - fidelity-1pulse ] are indicated , using the same color coding ( black for pe optimization , green for optimization towards the @xmath123 point , blue for @xmath132 , and orange for @xmath138 ) . ]    first , we consider the case @xmath139 , i.e.  using only a single control pulse .",
    "figure  [ fig : jcq - fidelity-1pulse ] shows the optimization results of the perfect entanglers functional for different values of @xmath50 and compares it to optimization towards a specific perfect entangler equivalence class , for three corners of the polyhedron , @xmath138 , @xmath137 , and @xmath132 .",
    "success is measured by the error @xmath140 for optimization towards the polyhedron of perfect entanglers ( black solid line , circles ) , and equivalently , @xmath141 for optimization towards a local equivalence class .",
    "larger values of @xmath50 increase the spacing between levels and thus make the implementation of a gate easier as leakage of population to higher levels is suppressed .",
    "we stress that while for the truncated hamiltonian we can show full controllability , this does not clearly imply full controllability also when additional levels are included .",
    "furthermore , the choice of specific parameters can make certain parts of the weyl chamber harder to reach in the chosen total time .",
    "this is indeed what we see and report in fig .",
    "[ fig : jcq - fidelity-1pulse ] : the optimization for an arbitrary perfect entangler significantly outperforms the optimization towards a specific local equivalence class .",
    "indeed , we find that while @xmath138 and @xmath137 can be reached with an error @xmath142 and decreasing with the gate duration ( or equivalently increasing @xmath50 ) , @xmath132 can not be reached with precision higher than a few percent .",
    "this finding is supported by fig .",
    "[ fig : jcq-1pulse_weyl_paths ] that shows the position in the weyl chamber of the gates reached during optimization .",
    "each dot corresponds to a reached gate at final time ( if leakage is present , the closest gate @xmath143 is shown ; see section  [ sec : crab ] ) .",
    "this explains the blue dot appearing near the point @xmath132 : while the projection onto @xmath144 gets relatively close to @xmath132 , a loss of population from the logical subspace of 2.1% is observed , making the overall fidelity low .",
    "in contrast , the population loss for the gates ( @xmath138 , @xmath137 ) as well as the perfect entanglers is less then 0.1% .",
    "interestingly , all optimizations towards a perfect entangler cluster around the @xmath138 point , which is the point that was reached with highest fidelity by a direct local equivalence class optimization .     but control with two independent pulses @xmath145 and @xmath146 . ]     but control with 2 pulses @xmath145 and @xmath146 . color coding as in fig .",
    "[ fig : jcq - fidelity-2pulses ] . ]    finally , we relax the constraint @xmath139 , allowing for two independent pulses : figure  [ fig : jcq - fidelity-2pulses ] shows the optimization success of the perfect entanglers functional for different gate durations , comparing it to optimization towards a given local equivalence class . here , we examine four corners of the polyhedron , namely @xmath138 , @xmath137 , @xmath132 , and also @xmath133 .",
    "as expected , again the smallest errors , i.e. , highest fidelities , are obtained for perfect entangler optimization .",
    "in addition to @xmath138 and @xmath137 , now also @xmath132 could be implemented with high fidelity , but @xmath133 ( data not included in fig .",
    "[ fig : jcq - fidelity-1pulse ] ) remains unreachable .",
    "this is also supported by fig .",
    "[ fig : jcq-2pulses_weyl_paths ] that shows the position in the weyl chamber of the gates reached during optimization .",
    "the obtained results for two independent pulses suffer from significantly less loss of population from the logical subspace compared to optimization with a single pulse .",
    "this is the expected behavior as the system goes from being weakly controllable ( the drift hamiltonian is needed to counteract leakage ) for one control to being fully controllable for two controls @xcite . for the optimization towards specific points in the weyl chamber ,",
    "the loss was below 0.01% , for the perfect entanglers it was as low as machine precision .",
    "lastly , for two transmons as described in sec .",
    "[ subsec : model : transmon ] , we analyze the performance of the perfect entanglers functional using krotov s method , outlined in sec .",
    "[ sec : krotov ] .",
    "the optimization is carried out for different gate durations between 25@xmath44ns and 400@xmath44ns , starting from a @xmath147-squared guess pulse of 35@xmath44mhz peak amplitude .",
    "ns and @xmath148ns are shown in light blue and dark purple , respectively , with the starting points labeled by 50@xmath149 and 400@xmath149 . ]",
    "figure  [ fig : transmon_weyl_paths ] shows the results of the optimization in the weyl chamber .",
    "the point at which each optimization enters the perfect entanglers polyhedron is indicated by a black dot and labeled with the gate duration . for @xmath150ns , no perfect entangler",
    "can be reached  defining heuristically the qsl for this transformation . in order to illustrate how the optimization proceeds , the optimization paths for @xmath151ns ,",
    "i.e. , the gate at the qsl , and a high - fidelity gate ( @xmath148ns ) are traced in light blue and dark purple , respectively .",
    "both optimizations start in the @xmath152 region ( near the @xmath153 point ) .",
    "the gate obtained with the guess pulse for @xmath151ns is significantly farther away from the surface of the polyhedron of pe than that for the guess pulse with @xmath148ns .",
    "optimization for @xmath148ns therefore moves directly towards the @xmath152 surface of the pe polyhedron , whereas the optimization for @xmath154  ns enters the ground plane and emerges in the @xmath155 region , before finally reaching the @xmath155 surface of the polyhedron of perfect entanglers .",
    "the jump from @xmath152 to @xmath155 is indicated by the light blue arrow .",
    "we find the optimization to enter @xmath155 from @xmath152 for durations @xmath156ns , whereas for longer gate duration the optimizations stay within @xmath152 entirely .",
    "the different optimization paths are a result of the competition between the two objectives  to reach a perfect entangler , and to implement a gate that is unitary in the logical subspace ( the points shown in fig .",
    "[ fig : transmon_weyl_paths ] are the weyl chamber coordinates of the unitary @xmath75 closest to the actual time evolution @xmath84 ) .",
    "the latter objective is more difficult to realize for shorter gate durations , resulting in a more indirect approach to the polyhedron of perfect entanglers than one might expect when considering that objective alone .",
    "-space , although the optimization functionals are defined in @xmath94-space ( see text for details ) . for the li - optimization , the results are fully converged . for the pe - optimization",
    ", the results are converged to a relative change below @xmath157 ( black solid curve ) and @xmath158 ( gray dash - dash - dotted curve ) . ]",
    "analogously to the study of charge qubit optimization in sec .",
    "[ subsec : jcq ] , it is instructive to compare the optimization success of the perfect entangler functional , eq .",
    ", to that of the local invariants functional , eq .  , for a few select points of the weyl chamber .",
    "this is shown in fig .",
    "[ fig : tm_conv_li ] . instead of",
    "the optimization functionals eqs .",
    "and we plot the gate errors @xmath159 for the local invariants optimization , and @xmath160 for the pe optimization , see .",
    "eqs .   and  .",
    "the results of fig .",
    "[ fig : tm_conv_li ] show how , for different gate durations , the gates that are easiest to reach differ . in agreement with the results of fig .",
    "[ fig : transmon_weyl_paths ] , for durations @xmath161  ns , the jump in the optimization error indicates a speed limit . for short gate durations ,",
    "@xmath162 , optimization towards the point @xmath138 in the weyl chamber is most successful .",
    "this matches the optimized gates for @xmath163ns in fig .",
    "[ fig : transmon_weyl_paths ] being near the @xmath138 point . also correspondingly , the longer gate durations end near the @xmath133 point .",
    "the failure to reach the point @xmath138 for longer durations is due to the symmetry structure of the weyl chamber .",
    "namely , for the ground plane of the chamber , there is a mirror axis defined by the line through @xmath164 and @xmath137 , where mirrored points are in the same local equivalence class .",
    "both the @xmath138-point and the @xmath165 point have local invariants of @xmath166 .",
    "since the optimization was performed in @xmath94-space , these two points are not distinguishable ; indeed , for long gate durations , the @xmath138-optimization successfully reached the @xmath165 point .    in comparison with the local invariants optimization , the perfect entanglers",
    "functional shows excellent performance .",
    "it automatically identifies the optimal gate for a given gate duration and reaches significantly better fidelities .",
    "this is due to the fact that the desired entangling power of @xmath75 can usually be obtained in just a few tens of iterations of the algorithm , and the remainder of the optimization then focuses on improving the unitarity of the obtained gate @xmath84 .",
    "most strikingly , we find that for the optimization towards a specific local equivalence class , the convergence rate becomes extremely small as the optimum is approached .",
    "all the results shown in fig .",
    "[ fig : tm_conv_li ] are converged to a relative change below @xmath167 , such that no measurable improvement can be expected within a reasonable number of iterations . while in principle ( due to the full controllability of the system )",
    ", the direct optimizations should yield arbitrarily small gate errors , as long as the gate duration is above the quantum speed limit , in practice this depends on numerical parameters such as the weight @xmath168 in krotov s method and may take a extremely large number of iterations or stagnate , as we observe here .",
    "the perfect entangler optimization shows remarkable robustness with respect to this issue .",
    "we observed very little slow - down in convergence .",
    "the black curve in fig .  [ fig : tm_conv_li ] for the pe - optimization already yields a significantly smaller optimization error than any of the li - optimizations , but is only converged to a relative change of @xmath157 .",
    "even the gray dash - dash - dotted curve , labeled pe@xmath149 , is only converged to a relative change of @xmath158 , and thus the optimization would still yield considerably better results if it were to be continued .     in the logical subspace ( blue circles ) , and average gate error , @xmath169 , with which @xmath75 is implemented ( red circles ) . ]    the values of the optimization error in fig .",
    "[ fig : tm_conv_li ] of @xmath158 or @xmath157 should not be understood to indicate a gate error above the quantum error correction threshold . whereas the optimization error relates only to a figure of merit used for optimization ,",
    "the relevant physical quantity that would be determined in an experiment is the average gate fidelity .",
    "it can be evaluated as  @xcite @xmath170             \\bigg)\\,,\\end{aligned}\\ ] ] assuming a two - qubit target gate @xmath171 and denoting the logical basis by @xmath172 .",
    "figure  [ fig : tm_conv_favg ] shows the generated entanglement as measured by the concurrence and the average gate error , @xmath169 , together with the population loss from the logical subspace .",
    "@xmath171 is taken to be the unitary that is closest to the projection of the realized operation from the full hilbert space onto the logical subspace . for @xmath173ns ,",
    "the gate errors are at or below @xmath167 . for shorter gate durations ,",
    "insufficient entanglement is generated , cf .",
    "blue dashed curve in fig .",
    "[ fig : tm_conv_favg ] . once @xmath174 is sufficiently large to generate the desired entanglement , the only source of error is loss of population from the logical subspace , shown in light red in fig .",
    "[ fig : tm_conv_favg ] .",
    "this loss does not depend on the choice of the weight @xmath175 in eq .  . when the gate duration is increased , optimization yields gates that are exponentially more unitary , as indicated by the linear decrease of the average gate error in our semi - log plot , in agreement with recently introduced error bounds for optimal transformations  @xcite .",
    "the difficulty to ensure unitarity on the logical subspace is typical for weakly anharmonic ladders , as found in superconducting transmon or phase qubits .",
    "optimal control can be successfully employed to tackle the problem of ensuring unitarity in the logical subspace , in addition to generating entanglement , as exemplified in fig .",
    "[ fig : tm_conv_favg ] .",
    "we have employed an optimization functional targeting an arbitrary perfect entangler to obtain gate implementations for nv centers in diamond and superconducting josephson junctions . for nv centers in diamonds , to a good approximation , the dynamics is confined to the logical subspace . in this case ,",
    "optimization for a perfect entangler turns out to be trivial .",
    "this finding is in striking contrast to optimization for a specific local equivalence class which requires a large number of iterations , if it is successful at all .",
    "the ease with which perfect entanglers are identified for perfectly unitary time evolution can be rationalized by the fact that more than half of all non - local two - qubit gates are perfect entanglers .",
    "when population may leak out of the logical subspace , the optimization problem becomes more difficult .",
    "our corresponding examples were the anharmonic ladders of superconducting qubits in the charge and transmon architectures . while an optimization for a perfect entangler is then no longer trivial , it converges much faster than an optimization for a local equivalence class .",
    "this is rationalized by the larger flexibility that a functional offers which allows for more possible solutions .",
    "larger flexibility implies an easier optimization problem , which is reflected in better convergence properties of the algorithm , i.e. , optimization is less likely to get stuck , and better final gate fidelities can be reached .",
    "the perfect entanglers functional is thus a better tool to investigate the quantum speed limit for perfectly entangling two - qubit gates , i.e. , the minimum time in which an perfectly entangling gate operation can be performed , than the local invariants functional .",
    "we find a qualitatively similar performance of two variants of the perfect entanglers functional , expressed in terms of the weyl chamber coordinates and the local invariants .",
    "this is despite the very different topologies connected with each formulation .",
    "our results underline the importance of properly expressing the physical target in an optimization functional .",
    "this is particularly encouraging in view of more complex quantum systems than those considered here , including models that explicitly account for decoherence .",
    "such applications require identification of the unitary that is closest to the actual dynamical map in order to evaluate the perfect entanglers functional .",
    "this is possible by extending the mathematical framework developed in refs .",
    "@xcite and will be subject of future work .",
    "we thank the kavli institute for theoretical physics for hospitality and for supporting this research in part by the national science foundation grant no .",
    "phy11 - 25915 .",
    "we acknowledge the bwgrid for computational resources .",
    "financial support from the national science foundation under the catalzying international collaborations program ( grant no .",
    "oise-1158954 ) , the daad under grant ppp usa 54367416 , the ec through the fp7-people ief marie curie action qoc4qip grant no .",
    "pief - ga-2009 - 254174 , eu - ip projects siqs , diadems and the dfg sfb / trr21 and the science foundation ireland under principal investigator award 10/in.1/i3013 is gratefully acknowledged ."
  ],
  "abstract_text": [
    "<S> the difficulty of an optimization task in quantum information science depends on the proper mathematical expression of the physical target . </S>",
    "<S> here we demonstrate the power of optimization functionals targeting an arbitrary perfect two - qubit entangler , creating a maximally - entangled state out of some initial product state . </S>",
    "<S> for two quantum information platforms of current interest , nitrogen vacancy centers in diamond and superconducting josephson junctions , we show that an arbitrary perfect entangler can be reached faster and with higher fidelity than specific two - qubit gates or local equivalence classes of two - qubit gates . </S>",
    "<S> our results are obtained with two independent optimization approaches , underlining the crucial role of the optimization target . </S>"
  ]
}