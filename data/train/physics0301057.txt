{
  "article_text": [
    "time series analysis is the backdrop against which most theoretical models are developed in the biomedical and social sciences .",
    "the traditional assumption made in the engineering literature , and subsequently adopted in the biophysical , biological and social sciences , is that the discrete time series variable @xmath0 consists of a slowly varying part @xmath1 and a randomly fluctuating part @xmath2    @xmath3    the slow , regular variation of the time series is called the _ signal _ , and the rapid erratic fluctuations are called the _",
    "noise_. the implication of this separation of effects is that @xmath4 contains information about the system of interest , whereas @xmath5 is a property of the environment and does not contain any information about the system .",
    "the science of complexity is making us acquainted with a different perspective .",
    "physiological and sociological time series invariably contain fluctuations , so that when sampled @xmath6 times the data set @xmath7 , @xmath8 , appears to be a sequence of random points .",
    "examples of such data are the interbeat intervals of the human heart @xcite , interstride intervals of human gait @xcite , brain wave data from eegs @xcite and interbreath intervals @xcite , to name a few , and , of course , the texas teen birth data @xcite analyzed in the companion paper @xcite . from now on , we shall refer to this paper as paper ii .",
    "the analysis of the time series in each of these cases has made use of random walk concepts ( see sec . [ tool - diffusion ] for the details ) in both the processing of the data and in the interpretation of the results .",
    "for example , the variance of the associated random walk , @xmath9 , in each of these cases ( and many more ) satisfies the property @xmath10 , where @xmath11 corresponds to anomalous diffusion .",
    "a value of @xmath12 is interpreted as an antipersistent process in which a step in one direction is preferentially followed by a reversal of direction .",
    "a value of @xmath13 is interpreted as a persistent process in which a step in one direction is preferentially followed by another step in the same direction .",
    "a value of @xmath14 is interpreted as ordinary diffusion in which the steps are independent of one another .",
    "this would be compatible with the earlier mentioned concept of environmental noise . in the science of complexity",
    "the fluctuations @xmath15 are expected to depart from this totally random condition , since they are expected to have memory and correlation .",
    "this memory is manifest in inverse power - law spectra of the form @xmath16 , where the corresponding correlation function , the inverse transform of the spectrum , is determined by a tauberian theorem to be    @xmath17    here the power - law index is given by @xmath18 note that the two - point correlation function depends only on the time difference , thus , the underlying process is stationary .",
    "these properties , as well as a number of other properties , are discussed for discrete time series by beran . @xcite .",
    "another important property of complex systems is that the associated random walk is not monofractal .",
    "for instance the heart beat variability has been found to be multifractal @xcite as were the interstride intervals @xcite .",
    "a more accurate way to define the deviation from ordinary diffusion is ensured by the scaling property . if the time series is long enough , following the prescription of the pioneer work of ref .",
    "@xcite we can generate a diffusion process out of it .",
    "the probability density function ( pdf ) of the diffusion process , @xmath19 , is expected to satisfy the scaling condition    @xmath20    the deviation from ordinary statistical mechanics , and consequently the manifestation of complexity , takes place through two distinct quantities .",
    "the first indicator is the scaling parameter @xmath21 departing from the ordinary value @xmath22 which it would have for a simple diffusion process .",
    "the second indicator is the function @xmath23 departing from the conventional gaussian form . the first quantity is usually assessed by measuring the second moment , or the variance , of the distribution as we did above .",
    "this method of analysis is reasonable only when @xmath23 maintains its gaussian form . if the scaling condition of eq . ( [ scalingdefinition ] ) applies , it is convenient to measure the scaling parameter @xmath21 by the method of diffusion entropy ( de ) @xcite that , in principle , works independently of whether the second moment is finite or not .",
    "the de method affords many advantages , including that of being totally independent of a constant bias . unfortunately ,",
    "in the presence of a non - constant bias , the scaling detected by the de need not indicate the correlations of the fluctuations , but instead would reflect the influence of the time - dependent bias .",
    "this important fact , the relationship of the scaling index to the bias , brings us back to the decomposition of the time series into a signal plus noise ( see eq .",
    "( [ intro1 ] ) ) .",
    "we address the theoretical issues raised by a physical condition where the important information is not contained in what the engineering literature defines as a signal , but rather in what is usual defined as noise . in other words , we adopt a perspective where the role of the environment might be that of creating a time - dependent slow component @xmath24 . in this case",
    "@xmath24 could be an external forcing , due to seasonal periodicity , demographic pressure , or to other causes . in any case",
    ", we need to isolate @xmath25 from @xmath24 , to detect the genuine complexity of the system under study .",
    "as we shall show , a process of analysis made without first establishing this separation might give the impression of a complexity higher than the real one .",
    "this overestimation of the scaling index is caused by the non - stationarity of the time series and inapplicability of the property of eq .",
    "( [ intro2 ] ) , implicitly assumed by the method of analysis .",
    "we can not rule out another important possibility .",
    "in complex phenomena the separation of effects implied by eq .",
    "( [ intro1 ] ) may no longer be appropriate .",
    "the low - frequency , slowly changing , part of the spectrum may be coupled to , and exchange energy with , the high - frequency , rapidly varying part of the spectrum ; a fact that often results in fractal statistical processes . for these latter processes the traditional view of deterministic , predictable signal given by the smooth part of the time series , on which random",
    ", unpredictable noise is superimposed , distorts the dynamics of the underlying process . although the research work of this paper has been done having in mind the former perspective , namely that the complexity of the system is of internal origin , and that the slow component @xmath24 is an external forcing",
    ", that does not affect the internal complexity of the system under study , its result can be used to asses where the latter perspective applies .",
    "for instance , after separating @xmath24 from @xmath26 in the most rigorous and objective way possible , we might observe many complex systems , for instance the teen birth process of many different counties , and to assess if it is true or not that those characterized by a more intense @xmath24 might lead to a larger deviation of @xmath27 from ordinary scaling .",
    "the outline of the paper is as follows . in section",
    "ii we provide a concise review of diffusion - based methods used to asses the scaling properties of a time series , the diffusion entropy ( de ) , the second moment ( sm ) , the multi - scaling ( ms ) analysis and the direct assessment of scaling ( das ) , and a brief review of the wavelet analysis ( wa ) and its use to reveal the features of the signal at different time scales . in section iii , with the help of computer - generated time series , we discuss how the different diffusion - based methods perceive the addition of a  slow component \" to the fluctuations , how to detrend this component ( we introduce two different methods : the wavelet smoothing and the step smoothing ) and how the detrending procedures affect the capability of recovering the scaling properties of the fluctuations .",
    "section iv addresses the same questions of section iii , but in the case when a  periodic component \" is added to the fluctuations . in section v we draw some conclusions .",
    "to make this paper as self - contained as possible , we devote this section to a concise review of the methods of analysis that we use .",
    "these methods are the diffusion - based methods , the diffusion entropy ( de ) , the second moment ( sm ) , the multi - scaling ( ms ) analysis and the direct assessment of scaling ( das ) , discussed in section [ diffusionmethods ] , and the decomposition of the time series done with the wavelet analysis ( wa ) , as illustrated in section [ waveletmethod ] .      [ diffusionmethods ]    as mentioned in the introduction , the theoretical backdrop to our discussion is that we have a stochastic time series denoted by the function @xmath28 this time series is used to generate a diffusion process as follows @xmath29 here @xmath30 is the position occupied by a random walker at time @xmath31 and the function @xmath30 is a diffusion trajectory .",
    "furthermore , it is evident that to create a probability density function ( pdf ) we need many diffusion trajectories of the type indicated by eq .",
    "( [ difftrajectory ] ) , namely , an ensemble of statistically equivalent trajectories .",
    "the continuum form for the diffusion trajectory leaves us with two main problems .",
    "the first problem is typically that we do not have a continuous time data , in which case the integral in eq .",
    "( [ difftrajectory ] ) is replaced by a sum and the time @xmath31 is discrete .",
    "the scaling property of eq .",
    "( [ scalingdefinition ] ) is usually discussed within a continuous - time perspective , but since the data are discrete , some caution must be exercised in moving from one representation to the other .",
    "the second , and even more important problem , is how to create many statistically equivalent trajectories .",
    "this is a delicate issue in time series analysis , where , in general , it is not possible to have many identical replicas of the system , with many statistically equivalent series of fluctuations .",
    "typically one has only a single time series . to solve this problem we use an overlapping windows technique .",
    "if @xmath31 is a discrete time in the interval @xmath32 $ ] , we define @xmath33 different diffusion trajectories ( number of members in the ensemble ) in the following way    @xmath34    this corresponds to initiating a `` window '' ( interval ) of length @xmath31 at the data point @xmath35 , and to aggregating all the data in the sequence @xmath36 . for any window position",
    "we sum all the values of the variable @xmath36 spanned by the window .",
    "this procedure is shared by all the diffusion based methods .",
    "let us now explore , briefly , the different methods based on creating a diffusion process from data via eq .",
    "( [ difftrajectory2 ] ) .",
    "the rationale behind the adoption of de analysis is that , if the pdf of the diffusion process satisfies eq .",
    "( [ scalingdefinition ] ) , then , regardless of the pdf shape , the shannon entropy satisfies the following relationship    @xmath37 dx = a+\\delta   \\text { } \\ln(t ) ,   \\label{derelation}\\ ] ]    where @xmath38 is a constant defined by @xmath39 dy,\\qquad y=\\frac{x}{% t^{\\delta } } .",
    "\\label{adefinition}\\ ] ] therefore the scaling condition of eq .",
    "( [ scalingdefinition ] ) can be detected by searching for the linear dependence of the entropy of eq.([derelation ] ) on a logarithmic time scale .    in practice , the numerical procedure necessary to evaluate the pdf",
    "requires that the x - axis be divided into cells of a given size , that , in principle , might also depend on the cell position on the x - axis .",
    "we adopt the criterion of assigning to each cell the same size , but we leave this size time - dependent . for this reason",
    "we denote the cell size with the symbol @xmath40 . at any time @xmath31 , the size @xmath41",
    "must be chosen so as to lead to a fair approximation of @xmath42 , through the histogram relation    @xmath43    here @xmath44 is the histogram at the value @xmath45 , the midpoint of the @xmath46-th cell , at time @xmath31 and @xmath47 is the fraction of the total number of trajectories found in this cell at time @xmath31 . the rationale behind the choice of a time - dependent size for the cell has to do with obtaining a good estimate of the pdf from the histogram . at early times ,",
    "when the trajectories are close together , a constant @xmath48 is adequate to estimate the ratio @xmath49 as the trajectories diffuse apart , however , either more trajectories are needed , or a larger @xmath48 is needed , to provide a reasonable estimate for this ratio . to ensure that ( [ new1 ] ) is satisfied at any time we evaluate the standard deviation of the diffusion process , @xmath50 , and select the cell size to be a fraction of the standard deviation , @xmath51 where @xmath52 @xmath53 there is some sensitivity to the choice of @xmath54 , but in the proper range of values in which eq .",
    "( [ new1 ] ) is satisfied , the diffusion entropy    @xmath55 dx\\approx -\\sum_{j}p_{j}\\ln p_{j}+\\ln \\delta \\left ( t\\right )    \\label{new2}\\ ] ]    is insensitive to the particular fraction of the standard deviation adopted .",
    "it has to be pointed out that the de analysis can yield a logarithmic dependence on time even when the scaling condition of eq .",
    "( [ scalingdefinition ] ) is not fulfilled .",
    "this is the case of the symmetric lvy walk studied by the authors of @xcite .",
    "lvy walks @xcite are characterized by the fact that the time for the walker to cover a given distance is proportional to the distance itself .",
    "this restriction generates a diffusion process limited by diffusion fronts moving ballistically . in @xcite a case where the population of the ballistic fronts @xmath56 decrease extremely slowly , @xmath57 with @xmath58 , is examined and in this case the pdf between the ballistic peaks tends to become a lvy distribution with scaling parameter @xmath59 . due to the slow decrease to zero of @xmath60 , the diffusion process is bi - scaling ( the two scaling parameters being that of lvy for the central part and the ballistic one for the fronts ) . the numerical limitation in creating a perfect power law , makes the de growing , after a transient , linearly with a slope equal to @xmath61 giving the impression that the condition eq .",
    "( [ scalingdefinition ] ) is fulfilled .",
    "therefore , it is convenient to denote the slope of the linear dependence on the logarithm of time of the de , with the symbol @xmath62 .      the sm analysis is based on evaluating the standard deviation of the diffusion process @xmath63 ^{\\frac{1}{2}% } ,   \\label{smdefinition}\\ ] ] where @xmath64 and @xmath65 denotes the average over the ensemble of realizations of diffusion trajectories . if the time series fluctuations have zero mean value , the quantity @xmath66 vanishes and eq .",
    "( [ smdefinition ] ) can be written as @xmath67 ^{\\frac{1}{2}% } ,   \\label{smrelation}\\ ] ] which is , in fact , the square - root of the second moment of the distribution .",
    "we evaluate the standard deviation from eq .",
    "( [ smdefinition ] ) , and we look for a time domain where @xmath68 \\propto \\delta _ { sm}\\text { } \\ln(t ) .",
    "\\label{smscaling}\\ ] ] is satisfied .",
    "then , in the time domain for which eq.([smdefinition ] ) is fulfilled , the standard deviation rescales with the scaling parameter @xmath69 .",
    "this scaling does not automatically imply , as mentioned in section i , that the proper scaling condition of eq .",
    "( [ scalingdefinition ] ) is fulfilled .",
    "the ms analysis is a generalization of the sm analysis .",
    "in fact eq .",
    "( [ smdefinition ] ) is replaced by the expression @xmath70 ^{\\frac{1}{q } } , \\label{mscdefinition}\\ ] ] where @xmath71 is a real number .",
    "it is evident that eq .",
    "( [ smdefinition ] ) is recovered from eq .",
    "( [ mscdefinition ] ) by setting @xmath72 . in case of fluctuations with zero mean value ,",
    "( [ mscdefinition ] ) reads : @xmath73 ^{% \\frac{1}{q}}.   \\label{mscrelation}\\ ] ] if the scaling condition of eq . ( [ scalingdefinition ] ) holds , we can express ( [ mscrelation ] ) as @xmath74 where @xmath75 ^{\\frac{1}{q}}. \\label{deifnitionofbq}\\ ] ] note that even in the case where @xmath23 has a long tail with an inverse power law index @xmath76 , with @xmath77 , and consequently a divergent second moment , the relation of eq .",
    "( [ mscscaling ] ) holds true , if @xmath78 .    in the case of fractional",
    "brownian motion @xcite , the function @xmath23 is gaussian , the scaling exponent , usually called @xmath79 in this case , in honor of hurst , is a number in the interval @xmath80 $ ] and @xmath81 - 1,+\\infty ) .",
    "\\label{mscscalingfbm}\\ ] ] in the case of a lvy flight @xcite the function @xmath23 is a lvy stable distribution of index @xmath82 @xcite .",
    "note that the index @xmath82 is related to the inverse power - law index of the distribution by the relation @xmath83 , and that the scaling @xmath21 is given in this case by @xmath84 .",
    "thus , in this case , it is straightforward to prove @xmath85 - 1,\\alpha [ .",
    "\\label{mscscalinglevy}\\ ] ]    as for the sm analysis we look for a time domain where the f@xmath71-th fractional standard deviation @xmath86 rescales with exponent @xmath87 , namely @xmath88^{q } \\propto t^{\\zeta ( q)}\\leftrightarrow \\ln \\left[(\\sigma_{q}(t))^{q}\\right ] \\propto \\zeta \\left ( q\\right ) \\ln(t ) .   \\label{mscscaling2}\\ ] ] when the scaling condition of eq . ( [ scalingdefinition ] )",
    "applies : @xmath71 @xmath89 . in the ideal case where divergent moments are involved ,",
    "as we have seen earlier , we should limit our observation to values of @xmath71 smaller than a given @xmath90 . in practice , we do the calculation for the entire range of values from @xmath91 to @xmath92 ( in reality the behavior of @xmath86 for very high value of @xmath71 , @xmath93 for example , can not be trusted because they are dominated by rare events and therefore subject to the problem of lack of statistics ) .",
    "this is done because , in real data there are no moment divergences , due to the fact that time series are of finite length .",
    "we , then , plot the calculated @xmath94 as a function of @xmath71 and see if a straight line results .",
    "the corresponding slope is the genuine value of the scaling parameter @xmath95 , assuming that the scaling condition eq .",
    "( [ scalingdefinition ] ) applies .",
    "of course , with this technique , as in the case of the de analysis , there is no compelling reason to ensure that the resulting scaling parameter corresponds to a genuine scaling property .",
    "if the scaling condition exists , the de analysis and the ms analysis detect the real scaling parameter ( a property that the sm analysis does not share ) .",
    "the reverse is not necessarily true .      the definition of scaling given by eq .",
    "( [ scalingdefinition ] ) has an attractive physical meaning .",
    "given any two times @xmath96 and @xmath97 , with @xmath98 , the pdf at time @xmath96 coincides with the pdf at time @xmath97 if the the following self - affine transformation is applied : take the scale of the variable @xmath99 , and  squeeze \" it by a factor @xmath100^{% \\delta } $ ] , simultaneously take the scale of the distribution intensity , and  enhance \" it by the factor @xmath101 .",
    "in other words , when eq .",
    "( [ scalingdefinition ] ) is satisfied , the diffusion process is invariant under this self - affine transformation .",
    "this property is the expression of a kind of thermodynamic equilibrium reached by the complex system under study ; one that is different from that usually obtained if @xmath102 and @xmath23 is not gaussian .",
    "the das analysis consists exactly of this procedure of  squeezing \" and  enhancing \" aimed at establishing the invariance of the pdf by a scaling transformation .",
    "the reader might wonder why no significant use is made of the das in literature .",
    "the reason seems to be that the detection of real scaling would necessitate many trials before discovering the right scaling index , if it exists .",
    "we think that the adoption of the das only becomes useful after the de and ms methods are applied .",
    "in fact , those analysis define a possible candidate for the true scaling .",
    "however , these techniques , as we have seen , do not provide any compelling reason to prove that the resulting scaling is a genuine property of the system dynamics . herein , we apply the de and the ms analysis and use the das to check if we have determined a genuine scaling or not .",
    "[ waveletmethod ]    the wavelet transformation @xcite is close in spirit to the fourier transformation , but has a significant advantage .",
    "the fourier transformation decomposes a time series into a superposition of oscillating modes , each of which lasts forever .",
    "the wavelet transformation decomposes the time series into  notes \" or wavelets @xcite , localized in time and in frequency .",
    "formally , the wavelet transform @xmath103 of the function @xmath104 is defined as follows @xmath105 where the symbol @xmath106 denotes the complex conjugate of the wavelet @xmath107 .",
    "the wavelet @xmath108 is a filter function satisfying the particular condition , known as the  admissibility condition \" @xcite .",
    "the parameters @xmath109 , @xmath31 and @xmath110 , are real numbers .",
    "( [ wavelettr ] ) shows the advantages of the wavelet transformation in resolving local features of the time series .",
    "in fact , the wavelet transformation rests on a convolution of the signal with the wavelet rescaled , through the use of the parameter @xmath109 , and centered on @xmath111 .",
    "therefore the parameter @xmath109 localizes the frequency domain and the parameter @xmath31 localizes the time domain .",
    "herein we use the discrete version of the wavelet transformation , known as the maximum overlap discrete wavelet transform ( modwt ) that gives birth to a decomposition of the signal in terms of  approximations \" and  details \" relative to different time scales . consider the integers @xmath6 and @xmath112 .",
    "the former is the length of the series under study and @xmath112 is the greatest number satisfying the condition @xmath113 . in this condition",
    "we can consider @xmath112 different time scales , given by @xmath114 .",
    "then , starting from the smallest time scale , the wavelet transformation is used to divide the original time series @xmath115 into two components @xmath116 the component @xmath117 contains features having a characteristic time scale greater than @xmath118 , since a local average of the time series over all time scales inferior to @xmath118 has been performed .",
    "therefore the component @xmath119 , often referred as  approximation \" , is  @xmath118-smooth \" , in the sense that @xmath117 can be considered a slow changing function with respect the time scale @xmath118 .",
    "the component @xmath120 , on the other hand , contains all the features of the time series with a characteristic time scale less than @xmath121 and therefore is called the  detail \" .",
    "the partitioning procedure described above can then applied to the approximation @xmath117 , splitting it into the functions @xmath122 and @xmath123 .",
    "the latter two functions represent , respectively , the features of the time series with time scales greater than @xmath124 and those features with a time scale less than @xmath124 , but greater than @xmath118 , that have already been removed .",
    "clearly , at the k - th step of this procedure , with @xmath125 , we have the decomposition @xmath126 with @xmath127 representing the smooth time series referring to the time scale @xmath128 and @xmath129 , with @xmath130 , the detail of time series with the time scale located in the interval @xmath131 $ ] .",
    "in section i we mentioned that the main goal of this paper is to detect the scaling index as a measure of complexity of time series : this task is confounded by the presence of slow components . in this section",
    "we illustrate the influence of a slow component on a computer - generated random time series created for this specific purpose .",
    "we apply the diffusion entropy ( de ) , the second moment ( sm ) , the multiscaling analysis ( ms ) and the direct assessment scaling ( das ) analysis to this computer - generated time series , and establish that it is not possible to reach a reliable conclusion about the real complexity of the process with any of these techniques .",
    "consequently we show how to eliminate the influence of the slow component , without distorting the scaling properties of the fluctuations , if any exists .",
    "this detrending procedure aims at establishing a stationary condition , to which de , sm and ms analysis can be productively applied .",
    "let us introduce the computer - generated time series we use to test the above processing techniques .",
    "we adopt a discrete - time picture , so that the time series to analyze reads as follows : @xmath132 where both @xmath133 and @xmath134 are functions of the discrete time @xmath46 .",
    "the slow component of the time series , @xmath133 , is a function , either regular or stochastic , that changes over a long time scale denoted by @xmath135 .",
    "the function @xmath134 represents the fluctuations and we refer to it as noise . in the numerical calculations , we assume the noise to not have any memory . however , the conclusion reached in this section can be easily extended to the case where @xmath134 has a long - time memory , yielding a scaling index @xmath21 moderately larger than the simple diffusion scaling , @xmath136 .",
    "we shall consider three different kinds of slow components , all of them with zero mean : a linear drift with a small slope , @xmath137 , a slowly changing continuous function , @xmath138 , and a step function , @xmath139 .",
    "[ figure1 ] shows these three different slow components .",
    "we select @xmath140 to be a gaussian random process with zero average and standard deviation @xmath141 , to which we will refer as gaussian noise ( gn ) .",
    "this choice of @xmath142 makes the intensity of the gn , measured by the standard deviation , comparable to the intensity of the slow components @xmath143 and @xmath139 , while keeping the noise at a slightly larger intensity than that of the @xmath144 component .",
    "we note that de analysis applied to the computer - generated time series , corresponding to gn , is a perfectly straight line , with @xmath136 .",
    "the use of random , rather than correlated , fluctuations in the simulation is dictated by simplicity .",
    "this choice of a memoryless noise makes the non - stationary effects , produced by the slowly changing first term on the right - hand side of eq .",
    "( [ slow+random ] ) , more transparent .",
    "however , the theoretical arguments adopted , in the remaining part of this section , to explain these significant effects , are independent of whether the noise is memoryless or correlated . finally , the length , @xmath145 , of the data has been chosen for ease of application of these results in paper ii .      in this section",
    "we apply the de and the sm analysis to the computer - generated sequences of eq .",
    "( [ slow+random ] ) . figs .",
    "[ figure2 ] and [ figure3 ] illustrate the de and the sm methods , respectively . in both figures",
    "the top , middle and bottom frame refer to @xmath139 , @xmath143and @xmath146 , respectively . in each frame",
    "we compare the results relative to the application of the methods to the time series defined by the sum of the slow component and the gn , as in eq .",
    "( [ slow+random ] ) , with the results obtained when the two components are considered separately .",
    "regarding the slow components @xmath139and @xmath143 , we see from fig .",
    "[ figure2 ] that at short times the de generated by the time series of eq .",
    "( [ slow+random ] ) , is different from both the de of the slow component and the de of the gn component .",
    "this is explained by the fact that the slow component and gn have comparable intensities .",
    "thus , it is evident that their joint action generates a faster spreading of the pdf and therefore a faster entropy increase . at long times the joint action of the two components",
    "yields the same effects as the slow component alone .",
    "this is due to the fact that the slow component generates ballistic diffusion , which is faster than the simple diffusion generated by the gn alone .",
    "a different behavior appears with the slow component @xmath137 . in this case , the short - time behavior is dominated by the noise component .",
    "this dominance by the noise occurs because the intensity of this component is smaller than the noise intensity .",
    "however , even in this case the long - time behavior is dominated , as explained earlier , by the slow component .",
    "this is a remarkable property , because in this case a mere visual inspection of the time series is not sufficient to reveal the presence of a bias , which is hidden by very large fluctuations . in any event ,",
    "the adoption of the de method yields a large scaling exponent that one might erroneously attribute to highly correlated fluctuations .",
    "this is an effect that we have to take into account when analyzing real time series .",
    "the sm analysis reveals properties similar to those emerging from the de analysis , the only relevant difference is that the convergence to the steady condition of the slow component alone is much faster than in the corresponding case of the de analysis .",
    "it is worthwhile to discuss this result in detail .",
    "let us define @xmath147 as the total standard deviation , at a time @xmath31 , of the diffusion process relative to the sum of the slow component and the noise . under the assumption that the individual components of the signal of eq .",
    "( [ slow+random ] ) are independent of one another , we write    @xmath148 .   \\label{sigmadecomposition}\\ ] ]    the sm analysis rests on evaluating the increase with time of the logarithm of the standard deviation . with some elementary algebra , we convert eq .",
    "( [ sigmadecomposition ] ) into @xmath149 = \\log \\left [ \\sigma _ { slow}(t)\\right ] + \\frac{1}{2 } \\ , \\log \\left [ 1+\\frac{\\sigma _ { noise}^{2}(t)}{\\sigma _ { slow}^{2}(t)}\\right ] .",
    "\\label{logsigmadecomposition}\\ ] ] when the noise standard deviation is smaller than the slow component standard deviation , namely , @xmath150 , using the taylor series expansion of the logarithm .",
    "we obtain @xmath149 \\approx \\log \\left [ \\sigma _ { slow}(t)\\right ] + \\frac{1}{2 } \\ ,",
    "\\frac{\\sigma _ { noise}^{2}(t)}{\\sigma _ { slow}^{2}(t)}. \\label{logsigmaapproximation}\\ ] ] therefore , when @xmath150 the leading contribution of the sm analysis is the logarithm of the slow component standard deviation , and the next expansion term is the square of the ratio of the noise standard deviation to the slow component standard deviation . in the case of diffusion",
    "entropy the numerical results indicate that a plausible expression to use is    @xmath151 ^{\\alpha } ,   \\label{entropyapproximation}\\ ] ]    with @xmath152 .",
    "in fact , the numerical results illustrated in the frames of fig .",
    "[ figure2 ] corresponding to @xmath143and @xmath139reveal that the diffusion entropy is more sensitive to the noise component than is the sm analysis .",
    "this sensitivity is due to the convergence to the behavior dominated by the slow component being faster than the one relative to the sm analysis . for a deeper understanding of the diffusion created by the superposition of the noise and slow component , in the next subsection we use the multiscaling analysis .      in fig .",
    "[ figure4 ] we observe that in the long - time limit , @xmath153 , the de produced by the time series resulting from the sum of noise and slow component @xmath139 coincides with the de generated by the slow component alone that increases with a slope equal to @xmath154 .",
    "this asymptotic property has already been discussed .",
    "our goal here is to shed light on the convergence to the long - time scaling of the whole time series , with the help of multiscaling analysis . to accomplish this goal",
    ", we divide the time range , explored by the de analysis , into three time regions : times smaller than @xmath155 ( early stage of the diffusion process ) , times between @xmath155 and @xmath156 ( middle stage of the diffusion process ) and times from @xmath156 to @xmath157 ( later stage of the diffusion process ) .",
    "we apply the multiscaling analysis to the two time series in fig .",
    "[ figure4 ] , for each of these three time regions , as shown in fig .",
    "[ figure5 ] .",
    "the three frames of fig .",
    "[ figure5 ] , from bottom to top refer to the early , the middle and the later stage of the diffusion process , respectively .",
    "the squares denote the numerical results relative to the slow component alone , the triangles denote the numerical results concerning the sum of slow component and noise and the dashed line corresponds to a straight line of slope @xmath154 , as expected for a diffusion rescaling ballistically . moving from the bottom to the top",
    "we notice that the agreement between triangles and squares tend to increase . at the top",
    ", there is an almost complete equivalence throughout the whole @xmath71-region explored .",
    "we also see that in the early and middle region the disagreement between triangles and squares tend to increase upon increasing @xmath71 .",
    "this means that the difference between the two cases becomes more and more significant at larger and larger distances .",
    "the presence of noise tends to slow down the distribution broadening .    to understand the influence of the gn on the slow component",
    ", we notice that the position of any of the diffusing trajectories can be written at time @xmath31 as @xmath158 where the contributions to @xmath30 are separated into the slow component and noise , respectively .",
    "now , since the noise has a vanishing mean , we have @xmath159 probability that the absolute value of @xmath30 is increased by the presence of the noise and @xmath160 that it is decreased .",
    "when we raise the absolute value of @xmath30 to a power of @xmath71 larger than @xmath154 , the half with positive increment contribute to the q - th moment with a greater weight than the other half .",
    "so , at any given time , the presence of the noise component makes the q - th moments , with @xmath161 , larger than in the case without noise , namely , the larger @xmath71 , the larger the discrepancy . we know that at long times , the moments of the two distributions , those with and without noise , must coincide . as earlier pointed out ,",
    "this occurs , because the noise component has slower diffusion .",
    "consequently , the moments of the distribution with noise undergo a slower increase than the moments of the distribution without noise .",
    "finally , we want to use the das method to shed light on the apparently confusing situation emerging from the use of de , sm , and ms analysis .",
    "we have seen that the de suggests that @xmath162 might be a reasonable measure of scaling , thereby suggesting the existence of pronounced cooperation in the system under study .",
    "the ms method , on the contrary , suggests that the ballistic scaling , @xmath163 is a more appropriate representation of the system complexity , at least in the long - time regime . using the das",
    "we discover that neither of these two conditions is a proper representation of the system dynamics .",
    "previously , we studied three distinct time regimes , short , intermediate and long . here",
    "we focus on the intermediate time regime , ranging from @xmath155 to @xmath156 .",
    "this choice is dictated by the fact that the deviation from a straight line in the middle frame of fig .",
    "[ figure4 ] suggests that the de prediction of @xmath162 is questionable .",
    "we apply the das method , namely , the squeezing and enhancing technique , assuming for the scaling parameter @xmath21 , the values @xmath154 , @xmath164 and @xmath165 .",
    "the corresponding results are illustrated in the top , middle and bottom frames of fig .",
    "[ figure6 ] , respectively .",
    "we see that the adoption of @xmath166 leaves the tail and the peak positions unchanged .",
    "however , the peak intensity ( in particular the intensity of the central peak ) is not invariant .",
    "this lack of invariance of the peaks means that @xmath166 is an acceptable scaling parameter for the skeleton of the pdf and its tail , but not for the peak@xmath167s intensities .",
    "the adoption of @xmath162 , as suggested by the de analysis , is satisfactory for both peak intensities and position .",
    "however , this scaling property is limited to the central part of the histogram .",
    "we see from the middle frame of fig .",
    "[ figure6 ] that the choice of the scaling parameter indicated by de has difficulty with the side portions of the histogram .",
    "in fact , we see that the peak at @xmath168 is annihilated by the adoption of the das method .",
    "finally , as we see in the last panel , the scaling parameter @xmath169 turns out to be unsatisfactory everywhere .    in summary ,",
    "the scaling parameter @xmath162 emerging from de analysis depicted in fig .",
    "[ figure4 ] does not reflect the true scaling of the computer - generated process .",
    "fig [ figure6 ] indicates that the scaling @xmath170 afforded by de , refers to the central part of the distribution , whereas the sides of the histogram are more satisfactorily represented by the scaling @xmath171 .",
    "this is reminiscent of the multiscaling properties revealed , using the ms analysis , in the paper of ref .",
    "however , in the case studied in ref .",
    "@xcite the scaling of the central part , corresponding to lvy walk dynamics , turned out to be a fair reflection of the correlated nature of fluctuations . here",
    ", this anomalous scaling is not the effect of correlated fluctuations , rather it is the consequence of the non - stationary effects produced by the slow component superposed on the gn with our computer - generated data .",
    "the above results establish that a slow component can produce misleading effects that have to be removed in order to detect the scaling properties of stationary fluctuations .",
    "the possible correlations remaining after the slow component has been removed , indicate the amount of cooperation of the system . in the following subsections",
    "we illustrate two distinct detrending methods , the  step smoothing \" and  wavelet smoothing  .",
    "the `` step smoothing '' procedure consists of dividing the time series into non - overlapping patches of length equal to the characteristic time @xmath135 : we evaluate the average value inside each patch and we subtract it from the data .",
    "in other words , this procedure consists of approximating the slow component with a step function of the same kind as that of the top frame of fig.[figure1 ] .",
    "the details of the procedure are as follows .",
    "start from eq .",
    "( [ slow+random ] ) and create the new variable @xmath172 , the sum of the variable @xmath173 inside the @xmath46-th patch , namely , @xmath174 where @xmath175 is the number of patches of length @xmath135 in the time series . to make explicit the contribution to @xmath172 of the two components ( the slow and the random ) of the variable @xmath36 we define    @xmath176    and therefore    @xmath177    if it happens that in any single patch the second term of the right - hand side of eq .",
    "( [ twopieceszj ] ) is negligible compared to the first term , we can use this equation to evaluate the average of the slow component and consider it as a fair approximation to the slow component inside each patch .",
    "moreover , we notice that the noise component has zero mean .",
    "thus , the most probable value for @xmath178 is zero , and the error associated with this prediction is given by the standard deviation @xmath179 , therefore @xmath180 .",
    "then , using the definition eq .",
    "( [ definitionofrjaj ] ) we apply the following approximation @xmath181 where @xmath182 is the standard deviation of the variable @xmath140 and the exponent @xmath183 is a number between @xmath184 and @xmath154 . if the scaling condition applies and the standard deviation is finite , this exponent is the scaling coefficient , that is , @xmath185 . if the scaling condition does not apply , this exponent is given by the mean slope . finally , with the help of eq .",
    "( [ stddevofrj ] ) we can state that @xmath186 when @xmath187 where @xmath188 is the average amplitude of the slow component in the j - th patch , and , with this equation holding true ,    @xmath189    in fig .",
    "[ figure7 ] we show the results of this detrending procedure for the three time series with the three slow components of fig .",
    "[ figure1 ] , with characteristic time @xmath190 and with gn .",
    "we choose the value 365 in anticipation of the application of these techniques to yearly data in paper ii .",
    "we see that the slow components @xmath139 and @xmath143 ( top and middle frame of fig .",
    "[ figure7 ] ) are fairly well reproduced , while the result for the slow component @xmath146 ( bottom frame of fig .",
    "[ figure7 ] ) is poor .",
    "the reason for this behavior is that the first two cases satisfy the condition of eq .",
    "( [ conditionofdetrendability ] ) while the last one does not .",
    "in fact , in the last case the absolute value of the average , @xmath191 , relative to the @xmath46-th patch is considerably smaller than @xmath182 , the intensity of the gn .",
    "another way of obtaining an approximation to the slow component is to use the chain of approximations and details stemming from the modwt . if @xmath135 is the characteristic time of the slow component , a good approximation is given by the @xmath46-th wavelet approximation , the one relative to scale @xmath192 where @xmath193 is such that @xmath194is as close as possible to the time @xmath135 ( @xmath195 so both @xmath196 and @xmath197 are good choices ) .",
    "in fact , the wavelet transformation acts as a filter on the contributions corresponding to time scales smaller than the time scale examined .",
    "the detrending procedure rests on eliminating the component corresponding to the @xmath135-time scale from the data .",
    "we apply the wavelet smoothing to the three time series that have been analyzed , in fig .",
    "[ figure7 ] , by means of the step detrending procedure .",
    "our purpose is to show that the two detrending techniques yield virtually the same results .",
    "we choose as analyzing wavelet the daubechies wavelet number @xmath154 and @xmath198 , the same as those adopted elsewhere @xcite .",
    "we denote these wavelets as db1 and db8 , respectively .",
    "we adopt , as a scale , @xmath199 .",
    "the results are shown in figs .",
    "[ figure8 ] and [ figure9 ] , respectively . in both cases , as expected , we get results very similar to what obtained with the step procedure .",
    "this means that the wavelet method very satisfactorily reproduces both the @xmath139 and @xmath143 ( top and middle frame ) time series , but it turns out to be as inaccurate as the step detrending method , and very similar as well , when applied to the @xmath137 time series ( bottom frame ) .",
    "this equivalence is a consequence of the wavelet result retaining , in part , the features of the mother wavelet , which is , in turn , a square wave .",
    "the adoption of the db8 wavelet yields a result that is as inaccurate as that of wavelet db1 and the step detrending method .",
    "we are , now , in a position to check a crucial step of our approach to the search of the complexity of a given process . in the next section",
    "we shall show how to detrend a periodic bias . when this approach is applied to real sequences in paper ii , we derive a time series similar to the slow component plus noise that we are discussing here .",
    "then , we shall have to detrend the slow component using the procedure of this subsection .",
    "for the sake of simplicity , the computer - generated time series , here under study , has been chosen to be the sum of a slow component and uncorrelated fluctuations .",
    "consequently , in the case here under study the fluctuations emerging from the adoption of the detrending procedure should be random , therefore yielding @xmath136 .",
    "now we apply the de method to the time series resulting from the detrending procedures and assess the extent we succeed in recovering the statistical properties of the gn .",
    "we consider three time series resulting from the addition of gn to the three slow components @xmath139 , @xmath143 and @xmath200 in fig .",
    "[ figure10 ] we apply the step smoothing detrending and in figs . [ figure11 ] and [ figure12 ] we use the wavelets db8 and db1 , respectively .",
    "we notice that in all three cases the detrending procedure works very well , if we ignore the saturation taking place at long times .",
    "the remainder of this subsection is devoted to explaining why the detrending procedure is affected by the unwanted saturation effect .",
    "let us first direct our attention to the results in fig .",
    "[ figure10 ] , the case of the step smoothing procedure , and why the saturation effect is an artifact of the detrending procedure . using eq .",
    "( [ practicalbj ] ) it can be shown that the detrended time series ( variable @xmath201 ) is obtained from the original time series according to the following prescription @xmath202 where @xmath203 is the characteristic function of the @xmath46-th patch . using ( [ slow+random ] ) and eq .",
    "( [ twopieceszj ] ) , it is possible to write    @xmath204    we recall that different diffusing trajectories are created using the method of overlapping windows . according to this method , the position occupied at time @xmath31 by the @xmath205-th trajectory , denoted by @xmath206 , is given by @xmath207 the right - hand side of eq .",
    "( [ detrendedsignal2 ] ) is the sum of four contributions , and , correspondingly , the right - hand side of eq .",
    "( [ gammaxitilde ] ) can be expressed as the sum of four terms .",
    "these terms are , with , obvious notations , @xmath208 , @xmath209 , @xmath210 and @xmath211 .",
    "therefore eq .",
    "( [ gammaxitilde ] ) can be written as @xmath212 at this point we can determine the reason for the saturation effect .",
    "in fact , when the index @xmath205 denotes the beginning of a patch and @xmath213 , the function @xmath214 , being the sum of @xmath201 within the patch , vanishes ( see the definition of @xmath178 and @xmath215 in eq .",
    "( [ definitionofrjaj ] ) ) . for values of @xmath205 denoting a position different from the first site of a patch ,",
    "the quantity @xmath214 can assume non - vanishing values .",
    "however , the above mentioned constraint establishes an upper bound on @xmath214 , thereby reducing the spreading of diffusion process . as we can see from fig .",
    "[ figure10 ] , the reduction of the diffusion process is already significant at times smaller than @xmath135 .",
    "consequently , the step detrending procedure successfully detrends for only a limited range of times , which we estimate to be @xmath216 .    the wavelet method yields saturation effects for similar reasons .",
    "in fact using the wavelet method we detrend the @xmath46-th approximation ( @xmath217 ) , and the @xmath46-th approximation is obtained through a filtering process averaging all the components with a time scale smaller than @xmath192 .",
    "therefore , this procedure is similar to the step smoothing , and the ensuing saturation effects have the same origin .",
    "finally , we notice that the step smoothing is slightly more effective than the wavelet db8 smoothing in the case of the step component @xmath139 , while in the case of the continuous component @xmath143 it is the other way around . in fact , the nature of the two signals @xmath139 and @xmath143 is such that the step smoothing is naturally the best  fit \" for @xmath139 and the db8 wavelet smoothing is naturally the best one for @xmath143 .",
    "therefore , in the case of the step smoothing acting on @xmath143 , the detrending process in not so successful and its effect occur before saturation , becoming thus visible .",
    "the same argument applies to the db8 wavelet smoothing acting on @xmath139 , thereby explaining why the db1 wavelet smoothing does not produce excellent results when applied to both @xmath139 and @xmath143 ( top and middle frame of fig .",
    "[ figure12 ] .",
    "finally , in the case of the @xmath137 all the detrending procedures do not work effectively , given the fact that in this case the noise intensity is much greater than the slow - component intensity .",
    "in this section we analyze , again with the help of computer - generated sequences , the effects of a periodic component rather than the slow components .",
    "this is another issue of crucial importance for the analysis of data sets with strong annual periodicities .",
    "the effects of this kind of external bias have been previously studied in refs .",
    "@xcite . the task of this section is , of course , that of proving that the detrending of a periodic component is a necessary step toward the detection of the true scaling of the underlying phenomenon with the diffusion based methods of analysis , de , sm , ms and das .",
    "we use the same notation as that of eq .",
    "( [ slow+random ] ) , and we describe the signal to analyze in this section as @xmath218 where @xmath219 is a periodic function , of period @xmath135 , satisfying the relation @xmath220 eq .",
    "( [ zeromean ] ) yields the vanishing of the mean value of function @xmath221 . as in the case studied in the previous section ,",
    "the presence of the seasonal component has the effect of  masking \" the scaling properties of the diffusion process stemming from the variable @xmath140 , by producing additional spreading .",
    "however , due to the fact that the external bias is periodic , the additional spreading undergoes regression to the initial condition at times that are an integer multiple of the period @xmath135 .",
    "this yields an alternating sequence of increasing and decreasing spreading phases . for this reason we refer to the diffusion effect caused by the periodic component as the  accordion \" effect .    for a convenient explanation of the  accordion \" effect ,",
    "let us study the variable @xmath222 .",
    "as in the previous section , the quantity @xmath31 is the length of the window ( or diffusion time ) and @xmath46 is the initial position of the sliding window . in the present case",
    "@xmath222 reads @xmath223 by noticing that @xmath224 with @xmath225 being a given integer depending on @xmath31 and @xmath226 a real number between @xmath184 and @xmath135 , and by using eq .",
    "( [ zeromean ] ) , we obtain    @xmath227    now , with @xmath31 and therefore @xmath228 fixed , as the index @xmath46 runs along the sequence the function @xmath229 repeats itself every @xmath135 steps and inside this time period the function assumes a maximum and a minimum value . the difference between these two extremes is a measure of the spreading due to the seasonal component .",
    "it is evident that if @xmath230 , that is , if @xmath31 is a multiple of the period @xmath135 , the  seasonal \" spreading is zero . with @xmath228 increasing , the spreading increases , but",
    "then it has , eventually , to decrease since for @xmath231 the initial condition must be recovered . using eq .",
    "( [ fisarmonica ] ) or eq .",
    "( [ parteintera2 ] ) it is evident that if we want to know the scaling property of the diffusion relative to the variable @xmath140 alone , we have to look at the diffusion relative to the variable @xmath232 only at times @xmath31 that are multiples of the period @xmath135 , since for these times , we have    @xmath233    throughout the whole sequence .",
    "so , in principle , there would be no reason to process the data in any way in order to retrieve the desired information on the variable @xmath140 .",
    "we might , in fact , limit ourselves to studying the behavior of the de or sm at times that are a multiple of @xmath135 .",
    "however , when dealing with real data , the limitation on the number of data points available and the excessive magnitude of @xmath135 limits the accuracy of the observation of times that are multiples of the time period .",
    "for example if the number of data is @xmath145 and @xmath190 ( the case study in paper ii ) , then the saturation effect , due to lack of statistics , affects the de or sm already at times smaller than @xmath234 .",
    "therefore if we want insight into the properties of the diffusion process of the noise component , before any saturation takes place , we must detrend the periodic component from the time series .",
    "let us proceed with the detrending in this case . consider a time series whose length is @xmath235 , @xmath6 being an integer .",
    "in other words , we assume the sequence to have a length which is a multiple of the time period @xmath135 .",
    "we define @xmath236 for all the values of @xmath237 $ ] , or , in a more concise notation ,    @xmath238 .",
    "\\label{sigmas2}\\ ] ]    eq .",
    "( [ sigmas2 ] ) can be used to evaluate the periodic component @xmath239 if @xmath240 . using the same argument as that adopted earlier for the detrending of the slow component .",
    "we establish the condition    @xmath241    yielding @xmath242    we note a significant difference with respect to the case of the moving window that we are forced to adopt in the general case . in this case",
    "the detrended data do not show any saturation effect .",
    "in fact @xmath243 does not vanish if the sum of @xmath244 is carried out over a patch .    in fig .",
    "[ figure13 ] we illustrate the results of a test done with a periodic function and a computer - generated sequence having gn . the first frame of fig .",
    "[ figure13 ] shows the periodic component used and the one resulting from the detrending procedure described above , the agreement is good .",
    "the second frame depicts the diffusion entropy applied to the sequence with both noise and periodic component , to the sequence with only the noise component and to the sequence derived from the detrending procedure .",
    "the agreement between the de applied to the original noise and the de applied to the detrended sequence is impressive , and , as expected , there is no indication of a saturation effect .",
    "we have shown that the de method , although possessing the remarkable property of detecting genuine scaling if it exists , can not be trusted in general as method for detecting the true scaling index .",
    "in fact , the existence of scaling makes the diffusion entropy grow in direct proportion to the logarithm of time .",
    "however , if the diffusion entropy grows in direct proportion to the logarithm of time , this growth is not necessarily an indication that the rate of this logarithmic increase is the scaling parameter .",
    "it is possible that there is no scaling @xcite . nevertheless , the adoption of the de method is useful , since it allows us to determine very quickly the range of values over which the scaling parameter may be located . at that stage",
    "the determination of the correct scaling value of the scaling parameter has to be determined using a more fine grained analysis , based on the ms analysis and the das . in paper ii",
    "@xcite we shall see this method at work in a case of sociological interest ."
  ],
  "abstract_text": [
    "<S> most data processing techniques , applied to biomedical and sociological time series , are only valid for random fluctuations that are stationary in time . </S>",
    "<S> unfortunately , these data are often non stationary and the use of techniques of analysis resting on the stationary assumption can produce a wrong information on the scaling , and so on the complexity of the process under study . herein , we test and compare two techniques for removing the non - stationary influences from computer generated time series , consisting of the superposition of a slow signal and a random fluctuation . the former is based on the method of wavelet decomposition , and the latter is a proposal of this paper , denoted by us as step detrending technique . </S>",
    "<S> we focus our attention on two cases , when the slow signal is a periodic function mimicking the influence of seasons , and when it is an aperiodic signal mimicking the influence of a population change ( increase or decrease ) . for the purpose of computational simplicity </S>",
    "<S> the random fluctuation is taken to be uncorrelated . however , the detrending techniques here illustrated work also in the case when the random component is correlated . </S>",
    "<S> this expectation is fully confirmed by the sociological applications made in the companion paper . </S>",
    "<S> we also illustrate a new procedure to assess the existence of a genuine scaling , based on the adoption of diffusion entropy , multiscaling analysis and the direct assessment of scaling . using artificial sequences , </S>",
    "<S> we show that the joint use of all these techniques yield the detection of the real scaling , and that this is independent of the technique used to detrend the original signal . _ </S>",
    "<S> pacs _ : 05.45.tp ; 05.40.-a ; 87.23.ge _ keywords _ : scaling , multiscaling , diffusion entropy , non - stationary time series , detrending methods . </S>"
  ]
}