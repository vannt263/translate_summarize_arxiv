{
  "article_text": [
    "it is a basic result of relativity theory that light rays follow null geodesics in curved 4-dimensional spacetimes , and this means that if one is pursuing cosmological applications of solutions of einstein s field equations with the aim of comparing the model s theoretical predictions with the actual data produced by astronomical observations , one requires null geodesic solutions for the chosen metric .",
    "in fact , for cosmological applications one only needs the _ past _ null geodesics , as what we observe today are events which occurred in the past . nevertheless , a very basic problem arising in cosmology , and which hinders comparison between theory and observations in other models than the standard friedmann - lematre - robertson - walker ( flrw ) , stems from the fact that as soon as we depart from the simple flrw models largely used by observational cosmologists , the task of finding null geodesic solutions quickly becomes an intractable analytical problem .",
    "in fact , this situation is not fully appreciated by many of those dealing with cosmological modelling of astronomical data , inasmuch as the simple flrw models largely applied in observational cosmology is the exception , since it has a very simple analytical solution for the null geodesic equation .    the lematre - tolman - bondi ( ltb ) spacetime is the most general spherically symmetric dust solution of einstein s field equations , having the flrw models as special sub - cases @xcite . by being a spatially inhomogeneous model ,",
    "that is , where @xmath0 , it allows us to study scenarios which do not have flrw s spatial homogeneity assumed _ a priori_. due to this , it is the most widely used cosmological model after the standard flrw , having been applied in a wide range of cosmological problems , from microwave background radiation studies to hierarchical ( fractal ) modelling , just to quote a few ( see @xcite , and references therein , for a large number of applications of ltb models in cosmology ) . however , as is the case with almost all non - standard cosmologies , while it is possible to solve analytically its einstein s field equations , ltb s null geodesic equation remains an intractable analytical problem , unless we rewrite its geometry in terms of the so - called `` observational coordinates '' .",
    "that , however , has the handicap of adding a great deal of mathematical complexity to the problem , since such an approach requires complex mathematical calculations in curved spacetimes @xcite , something which may not be required in all ltb applications .",
    "therefore , due to such a wide range of application , a code which produces numerical solutions of ltb null geodesics is desirable .    in this paper",
    "i will describe such a code .",
    "it deals with ltb geometry in its full generality , being applicable to each of its special sub - cases , parabolic , hyperbolic and elliptic @xcite , either separately or together in a single problem encompassing all sub - cases , if desired .",
    "it was originally designed to find scale invariant solutions of the average density by means of numerical simulations @xcite , but as we shall see below , without changing its core null geodesic calculations the code can be easily adapted to do much more than this , due to its modularity .",
    "the original results obtained by this code were recently analytically confirmed , and extended , by other authors @xcite by means of the observational coordinates approach mentioned above .",
    "the confirmation of the results of @xcite by @xcite adds then further reliability to the numerical results obtained with the code that will be described below .",
    "besides , those two approaches , numerical and analytical , when applied to a difficult problem such as null geodesic solutions in ltb spacetime , will in fact complement each other , rather than exclude one another . in  [ des ]",
    "i will describe version 1.1 of the code , and in  [ io ] the input and output will be discussed .",
    "the results are summarized in  [ conc ] , where i also indicate where the code can be obtained .",
    "simu solves simultaneously two ordinary differential equations ( ode s ) by means of the fourth order runge - kutta method with adaptive stepsize control .",
    "one differential equation is required for the null geodesic , while the other is needed for obtaining the redshift in this cosmology @xcite .",
    "the subroutines that carry out the numerical integration are from @xcite , and some minor changes necessary for taking the results back to the main program were made , but without changing the actual numerical implementation of the runge - kutta method .",
    "a full description of the ltb model and notation as used in simu is given in @xcite .",
    "the numerical simulations take advantage of the fact that ltb spacetime geometry has three unknown functions,@xmath1 , @xmath2 , @xmath3 , respectively representing the amount of gravitational mass within the radius coordinate @xmath4 , the overall curvature and dynamics of the model , and the time elapsed since the big bang for each observer located at particular values of @xmath4 @xcite .",
    "the simulations then take advantage of this freedom , as one starts by choosing these functions , run the program and analyse the results , concluding then whether or not the simulation was successful , and if not choose another set of three functions ( see @xcite for a very detailed explanation of this procedure ) .",
    "the code is implemented in double precision , and it has a built - in methodology for checking the possible catastrophic accumulation of round - off errors .",
    "that is done by monitoring the energy equation , as derived from einstein s field equations , and its derivative , since , by theory , both must remain unchanged throughout the integration @xcite .",
    "in addition , to check for accuracy and stability , after the integration the program runs in reverse , that is , it takes the final result and uses it as initial conditions to get another result that can be compared with the original initial condition . the results described in @xcite showed that double precision is enough for maintaining the desired accuracy required by the problem under study .",
    "simu also calculates the errors associated with each observational quantity evaluated , as well as the propagated errors .",
    "this is done by taking the accuracy given by the adaptive method and using this value as the input in the standard propagation error equations .",
    "all those details are fully explained in the initial documentation of the code .    as mentioned above",
    ", the code uses some subroutines from @xcite , namely the fourth order runge - kutta integration with adaptive stepsize control , the root finding algorithm for the transcendental equations appearing in ltb s elliptical and hyperbolic sub - cases @xcite , the extended trapezoidal rule quadrature algorithm , as well as simpson s rule to the desired accuracy . however , apart from those , the remaining subroutines are new , as well as the actual way in which the whole set of subroutines were linked to each other and organized . in addition , the code is extensively commented and widely documented , also having a structure chart showing the dependence among the subroutines and functions .",
    "this detailed documentation is added in order to help readers who might be interested in implementing simu in their own computer environments , or changing it to suit their specific applications .",
    "it must be mentioned that there are more `` state of the art '' ways for finding numerical solutions of ode s than using the adaptive 4th order runge - kutta method .",
    "the odepack subroutine package is an example @xcite . nevertheless ,",
    "although the chosen ode integrator for simu may have already been superseded by better methods , it _ does _ solve the proposed problem , and at the desired accuracy .",
    "inasmuch as simu is a tested code , with its results having already been analytically confirmed by other authors @xcite , there is no need to change to another ode integrator at simu s current version .",
    "the reader must , however , be aware that such a change might be required for other applications of simu to ltb spacetime .",
    "the code uses only standard fortran 77 commands to avoid possible compilation problems with machine dependent commands that are not available universally .",
    "if a potential user is only interested in the core of the program , that is , the part which integrates the null geodesic and calculates the observational relations , he or she can simply remove its `` tail '' , where the observational relations are manipulated according to the aims of the theory studied in @xcite , and replace it with something else .",
    "this `` tail '' consists of the two last branches of the structure chart headed by the subroutines fit and output , and are easily spotted in the main . finally , the functions @xmath2 , @xmath1 , @xmath3 and their derivatives appear in six subroutines at the end of the list so that they can be compiled separately .    the previous version 1.0 ( formerly simu 5d ; see @xcite ) had the pgplot plotting routines merged into the second half of the output subroutine , while version 1.1 removed them and piped the numerical results into eleven independent files , v1 to v11 , that are then _ externally _ read by the gnuplot plotting package in order to produce a graphical output of the results .",
    "this is the only difference between versions 1.0 and 1.1 , meaning that in version 1.1 the graphical output is completely independent from the code itself . making this change was justified on two grounds : _",
    "( i ) _ the gnuplot package has greater plotting capabilities , even allowing latex  output formats that can be included directly in the figure environment of any latex  macro .",
    "so , producing plots with the results is done by feeding the numerical tables into gnuplot itself by means of a script file written for , say , a linux environment ; _ ( ii ) _ this feature of having the results outputted into numerical files brings flexibility to the code , as its results can be independently used by another program , if so desired or demanded by another application of the ltb spacetime .",
    "the actual implementation for the original problem advanced in @xcite was described at length in @xcite , where one can find detailed plots with the results and analysis of the various simulations , as well as detailed explanations of initial conditions and functions used in each simulation .",
    "so , in here i shall limit the discussion to the code itself , without dealing with any specific application .    as mentioned above",
    ", we require a script file for running a simulation and immediately producing a graphical output .",
    "an example of such a script in linux is given as follows :    g77 simu1.1.for + a.out < in.simu + gnuplot",
    "< in.gnu + latex plots.tex + xdvi plots.dvi    here the file in.simu contains the maximum value for the radius coordinate @xmath4 for the integration , while in.gnu is a short gnuplot script file for inputting the v1 to v11 files and producing latex  files ( see appendix [ app1 ] ) .",
    "finally plots.tex is a file for running the .tex latex  files produced by gnuplot in order for the results be available for analysis directly on the screen .",
    "the details of each simulations , as well as accuracy monitoring are given in an outputted file called s1 .",
    "appendix [ app2 ] shows the results of a simulation using the value 1.5 for in.simu , and the three functions given as follows : @xmath5 , @xmath6 , @xmath7 .",
    "in this paper i have described the fortran 77 code simu version 1.1 for calculating solutions of the null geodesics equations in the lematre - tolman - bondi spacetime geometry .",
    "i have discussed the details of the code , input and output , as well as the ways in which it can be possibly modified for other cosmological applications of this geometry .",
    "the code is available for download at @xcite .",
    "i am grateful to william r.  stoeger for reading the original manuscript , newton jos de moura jr .  for his assistance with the gnuplot package , and the referee for helpful comments .",
    "i also thank the vatican observatory research group for their kind hospitality while writing this paper .    00",
    "m.  b.  ribeiro , _ astrophys .",
    "j.  _ * 395 * ( 1992 ) 29 m.  b.  ribeiro , _ in : _ d.  hobill , a.  burd and a. coley , eds .",
    ", _ deterministic chaos in general relativity _ ( new york , plenum , 1994 ) 269 - 296 a.  krasiski , _ inhomogeneous cosmological models _ ( cambridge university press , 1997 ) r.  marteens , n.  p.  humphreys , d.  r.  matravers and w.  r.  stoeger , _ class .  quantum grav .  _",
    "* 13 * ( 1996 ) 253 ; corrigenda * 13 * ( 1996 ) 1689 ; m.  e.  arajo and w.  r.  stoeger , _ phys .",
    "d _ * 60 * ( 1999 ) 104020 w.  b.  bonnor , _ monthly not .",
    "royal astron .",
    "* 167 * ( 1974 ) 55 m.  b.  ribeiro , _ astrophys .",
    "j.  _ * 388 * ( 1992 ) 1 m.  b.  ribeiro , _ astrophys .  j.  _ * 415 * ( 1993 ) 469 n.  p.  humphreys , d.  r.  matravers and r.  marteens , _ class .",
    "quantum grav .  _",
    "* 15 * ( 1998 ) 3041 , gr - qc/9804025 w.  h.  press , b.  p.  flannery , s.  a.  teukolsky and w. t.  vetterling , _ numerical recipes _ , ( cambridge university press , 1986 ) a.  c.  hindmarsh , _ `",
    "odepack , a systematized collection of ode solvers ' _ , _ in : _ r.  s.  stepleman et al .",
    ", _ scientific computing _",
    "( north - holland , 1983 ) 55 - 64 l.  r.  petzold , _",
    "siam j.  sci .",
    "comput .  _ * 4 * ( 1983 ) 136 l.  r.  petzold and a.  c.  hindmarsh , odepack subroutine package available from netlib at http://www.netlib.org/odepack/ m.  b.  ribeiro , _ on modelling a relativistic hierarchical ( fractal ) cosmology by tolman s spacetime _ ,",
    "phd thesis , ( queen mary and westfield college , university of london , 1992 ) ; http://www.if.ufrj.br/~mbr/publi.html can be downloaded from http://www.if.ufrj.br/~mbr/codes or http://arxiv.org/abs/gr-qc/0205",
    "set terminal latex + set output v1.tex + set size 1,1 + set xlabel `` $ @xmath8log d_l ( gpc)$ '' + set ylabel `` $ @xmath8log @xmath8rho$ '' + set nokey + plot v1 with points 1 8 , v11 with lines 1 + set output v2.tex + set xlabel `` $ d_l ( gpc)$ '' + set ylabel `` $ @xmath8rho$ '' + plot v2 with points 1 8 + set output v3.tex + set xlabel `` $ z$ '' + set ylabel `` $ d_l$ @xmath8@xmath8 $ ( gpc)$ '' + plot v3 with points 1 8 + set output v4.tex + set xlabel `` $ z$ ''",
    "+ set ylabel `` $ n_c$ '' + plot v4 with points 1 8 + set output v5.tex + set xlabel `` $ r$ '' + set ylabel `` $ field$ @xmath8@xmath8 $ ee$ '' + set yrange [ -10**-5:10**-5 ] + plot v5 with points 1 8 + set output v6.tex + set xlabel `` $ r$ '' + set ylabel `` $ deriv.$ @xmath8@xmath8 $ field$ @xmath8@xmath8 $ eedsh$ '' + set yrange [ -10**-5:10**-5 ] + plot v6 with points 1 8 + set output v7.tex + set title `` $ center @xmath8rightarrow border$ '' + set xlabel `` $ r$ '' + set ylabel `` $ t$ '' + set autoscale y + plot v7 with points 1 8 + set output v8.tex + set title `` $ border @xmath8rightarrow center$ '' + set xlabel `` $ r$ '' + set ylabel `` $ t$ '' + plot v8 with points 1 8 + set output v9.tex + set title `` $ center @xmath8rightarrow border$ '' + set xlabel `` $ r$ '' + set ylabel `` $ i$ '' + plot v9 with points 1 8 + set output v10.tex + set title `` $ border @xmath8rightarrow center$ '' + set xlabel `` $ r$ '' + set ylabel `` $ i$ '' + plot v10 with points 1 8 + quit"
  ],
  "abstract_text": [
    "<S> this paper describes the fortran 77 code simu , version 1.1 , designed for numerical simulations of observational relations along the past null geodesic in the lematre - tolman - bondi ( ltb ) spacetime . </S>",
    "<S> simu aims at finding scale invariant solutions of the average density , but due to its full modularity it can be easily adapted to any application which requires ltb s null geodesic solutions . in version 1.1 the numerical output can be read by the gnuplot plotting package to produce a fully graphical output , although other plotting routines can be easily adapted . </S>",
    "<S> details of the code s subroutines are discussed , and an example of its output is shown .    </S>",
    "<S> cosmology , numerical simulation ; solution of equations , numerical relativity 98.80.-k , 02.60.cb , 04.25.dm </S>"
  ]
}