{
  "article_text": [
    "traders on financial markets frequently face the task of selling a large amount of a given asset over a short time period .",
    "this has sparked a lot of research on how to carry out such transactions in an optimal way .",
    "the existing literature on optimal portfolio liquidation can essentially be divided into two classes : market impact models and order book models . in a market impact model one",
    "directly specifies the price impact of a given trading strategy .",
    "the fundamental price ( the price if the trader is inactive ) is usually modelled as a diffusion process such as geometric brownian motion . in an order book model one specifies the dynamics of the limit order book in which the orders of the large trader are executed .",
    "this results in an endogenous price impact that follows from the structure of the order book .    in this paper",
    ", we study the optimal liquidation problem in a market impact model with temporary and permanent price impact and with a novel type of price dynamics .",
    "we assume that the asset price follows a pure jump process ; this mimics the fact that , in reality , quoted prices are constant between trades and jump only when new orders arrive .",
    "the trader uses absolutely continuous liquidation strategies with liquidation rate @xmath0 . the local characteristics ( intensity and jump size distribution ) of the price process",
    "depend on @xmath1 , so that there is permanent price impact .",
    "in particular , a high liquidation rate will push prices down .",
    "moreover , the local characteristics depend on an unobservable markov chain @xmath2 , so that the liquidity and the trend of the market are random and not directly observable .",
    "the chain @xmath2 can be used to model the impact of other traders .",
    "this setup captures many typical features of asset prices on the fine timescales that are relevant in the analysis of optimal liquidation strategies ; details are given in section  [ sec : framework ] .",
    "since the chain @xmath2 is unobservable , the trader faces an optimization problem under partial information .",
    "the first step in the analysis of this problem is to derive an equivalent control problem under full information via stochastic filtering .",
    "we use the reference probability approach to derive the filtering equations for our model .",
    "this enables us to deal with the issue that the information available to the investor depends on the liquidation strategy .",
    "we end up with a control problem whose state process @xmath3 consists of the stock price , the inventory level and the filter process .",
    "the form of the asset return dynamics implies that @xmath3 is a piecewise deterministic markov process ( pdmp ) .",
    "we address the optimal liquidation problem using control theory for pdmps ; an introduction to this theory is given in @xcite or in @xcite .",
    "we establish the dynamic programming equation for the value function and we derive conditions on the data of the problem that guarantee the continuity of the value function and the existence of optimal relaxed controls .",
    "note that here we have a more delicate situation than in ( * ? ? ?",
    "* chapter  8) , since in our setup the pdmp may reach the boundary of the state space so that a careful analysis of the behavior of the value function close to the boundary is needed . as a further step , using ideas from @xcite we characterize the value function as viscosity solution of the hamilton jacobi bellman ( hjb ) partial integro - differential equation associated with the problem and we prove a novel comparison principle . in order to gain intuition on the form of the resulting optimal liquidation rate we carry out a numerical study , based on discretization of the hjb equation . we calculate the additional liquidation profit from the use of stochastic filtering and we study the influence of the temporary and permanent price impact parameters on the form of the liquidation strategy .",
    "we find that for certain parameter constellations the optimal strategy displays a surprising yet economically plausible gambling behaviour of the trader .",
    "following @xcite we establish convergence of our numerical scheme .    in summary , our contributions are the following .",
    "first , we study the optimal liquidation problem in a novel market impact model with partial information , which captures salient features of high frequency data .",
    "second , we transform the problem to a full - information context by solving a stochastic filtering problem with point process information . third , we provide a detailed mathematical analysis of the ensuing problem using control theory for pdmps .",
    "fourth , we prove a novel comparison theorem for the hjb equation , which is valid in more general setups . finally , our numerical experiments show that the optimal strategy exhibits a behaviour that can not be guessed upfront .",
    "we continue with a brief discussion of the existing literature on optimal liquidation problems .",
    "starting with market impact models , the first contribution is @xcite who analyze the optimal portfolio execution problem for a risk - neutral agent in a model with linear and purely permanent price impact where the fundamental price follows an arithmetic random walk .",
    "this model has been generalized in continuous time by @xcite allowing for risk aversion and temporary price impact . since then",
    ", market impact models have been extensively studied .",
    "important contributions include @xcite @xcite , @xcite , @xcite , @xcite , @xcite .",
    "recently , @xcite considered an extension of the almgren chriss model with a self - exciting temporary price impact .",
    "@xcite use dynamic programming equations and viscosity solutions to study a model with market impact and regime switching .",
    "all these models work in a ( discretized ) diffusion framework .    in the order book literature on the other hand",
    "a few contributions based on point - process models exist .",
    "@xcite study the optimal portfolio execution problem in a model with discrete order flow represented by a poisson process with observable intensity .",
    "the price impact is purely temporary and is represented in terms of a cost function . @xcite",
    "consider the same setting with a standard poisson process and solve the cost minimization problem by using tools from the control theory of pdmps .",
    "a further order book model based on point process methodology is @xcite .",
    "there it is assumed that the trader uses limit orders and that she can control the intensity of the order flow by choosing the spread at which she is willing to trade .",
    "additional contributions mainly based on diffusion models are @xcite . for a detailed overview",
    "we refer to the surveys @xcite , @xcite or @xcite . from a methodological point of view our analysis",
    "is also related to the literature on expected utility maximization or hedging for pure jump process such as @xcite or @xcite .",
    "the outline of the paper is the following . in section",
    "[ sec : framework ] , we introduce our model , the main assumptions and the optimization problem . in section [ sec : partial info ] , we derive the filtering equations for our model . section [ section : mdm ] contains the mathematical analysis of the optimization problem via pdmp techniques . in section [ sec : viscosity ] we provide a viscosity solution characterization of the value function .",
    "finally , in section [ sec : numerics ] , we present the results of our numerical experiments .",
    "the appendix is divided into three sections and organized as follows .",
    "section [ app : filtering ] contains results and technical proofs on filtering . in section [ app : sec-4 ]",
    "we collect some basics and additional proofs on markov decision models . finally in section [ app : num ] we show convergence of the numerical scheme used in section [ sec : numerics ] .",
    "throughout we work on the filtered probability space @xmath4 , where the filtration @xmath5 satisfies the usual conditions . here",
    "@xmath6 is the global filtration , i.e. all considered processes are @xmath6-adapted , and @xmath7 is the historical probability measure .",
    "we consider a trader who wants to liquidate @xmath8 units of a given security ( referred to as the _ stock _ in the sequel ) over the period @xmath9 $ ] for a given time horizon @xmath10 .",
    "we denote the bid price process by @xmath11 and @xmath12 is the filtration generated by @xmath13 . in what follows",
    "we assume that @xmath14 satisfies the usual conditions .",
    "we assume that the trader sells the shares at a nonnegative @xmath12-adapted rate @xmath15 .",
    "hence her inventory , i.e.  the amount of shares she holds at time @xmath16 $ ] , is given by @xmath17.\\ ] ] modelling the inventory as an absolutely continuous process corresponds to the situation where the trader is frequently submitting small sell orders . by taking @xmath18 to be nonnegative",
    ", we confine the trader to pure selling strategies .",
    "the goal of the trader is to maximize the expected revenue from her trading strategy .",
    "we assume that the implementation of the liquidation strategy generates temporary and permanent price impact , where permanent price impact is the impact of trading on the dynamics of @xmath13 and temporary price impact is the impact of trading on the execution price of the current trade .",
    "we model the bid price as a markov - modulated geometric finite activity pure jump process .",
    "let @xmath19 be a continuous - time finite - state markov chain on @xmath4 with state space @xmath20 ( @xmath21 is @xmath22-th unit vector in @xmath23 ) , generator matrix @xmath24 and initial distribution @xmath25 .",
    "we assume that the bid price has the dynamics @xmath26 where the _ return process _",
    "@xmath27 is a finite activity pure jump process .",
    "we assume that @xmath28 so that @xmath13 is strictly positive .",
    "denote the random measure associated with @xmath29 by @xmath30 and by @xmath31 the @xmath32-dual predictable projection ( or compensating random measure ) of @xmath33 .",
    "@xmath34 is absolutely continuous and of the form @xmath35 for a finite measure @xmath36 on @xmath37 . in order to specify the joint law of @xmath2 and @xmath29 ,",
    "let @xmath38 be the set of possible jumps of the chain @xmath2 and denote the elements of @xmath39 by @xmath40 .",
    "let @xmath41 be the jump measure of the pair @xmath42 on @xmath43 .",
    "we assume that the compensator @xmath44 of @xmath45 is absolutely continuous , @xmath46 , where @xmath47 note that implies that @xmath2 and @xmath29 have no common jumps .",
    "now we turn to the semimartingale decomposition of the bid price with respect to the full information filtration @xmath6 .",
    "denote by @xmath48 the mean of @xmath49 ( @xmath50 exists under assumption  [ ass1 ] below ) .",
    "fix some liquidation strategy @xmath18 .",
    "then the martingale part @xmath51 of the return process is given by @xmath52 , @xmath53 $ ] , and the @xmath6-semimartingale decomposition of @xmath13 equals @xmath54\\,.\\ ] ] it is well - known that the semimartingale decomposition of @xmath13 with respect to the trader filtration @xmath14 is obtained by projecting the process @xmath55 onto @xmath14 .    in the sequel",
    "we assume that for all @xmath16 , e \\in \\mathcal{e}$ ] , the mapping @xmath56 is decreasing on @xmath57 , that is selling pushes the price down on average .",
    "furthermore , we make the following regularity assumption .",
    "[ ass1 ] there is a deterministic finite measure @xmath58 on @xmath37 whose support , denoted @xmath59 , is a compact subset of @xmath60 , such that for all @xmath61 \\times \\mathcal{e}\\times [ 0 , \\infty)$ ] the measure @xmath62 is equivalent to @xmath58 .",
    "furthermore , for every @xmath63 there is some constant @xmath64 such that @xmath65 \\times \\mathcal{e } \\times [ 0 , { \\nu^{\\text{max}}}]\\,.\\ ] ]    the assumption implies that for every @xmath66 there is a @xmath67 such that @xmath68 , e \\in \\mathcal{e } , \\nu \\in [ 0 ,   { \\nu^{\\text{max}}}]\\ } \\le   \\lambda^{\\text{max } } \\,;\\ ] ] in particular the counting process associated to the jumps of @xmath13 is @xmath69-nonexplosive .",
    "moreover , it provides a sufficient condition for the existence of a _ reference probability measure _ ,",
    "i.e. a probability measure @xmath70 equivalent to @xmath69 on @xmath71 , such that under @xmath70 the compensator of @xmath33 is a poisson random measure with intensity measure @xmath58 independent of @xmath2 and @xmath72 .",
    "this measure is needed in the analysis of the filtering problem of the trader in section  [ sec : partial info ] . note that the equivalence of @xmath73 and @xmath74 implies that for all @xmath61 \\times \\mathcal{e}\\times [ 0 , \\infty)$ ] the support of @xmath75 is equal to @xmath59 .",
    "the assumption that @xmath59 is compact is not restrictive , since in reality the bid price moves only by a few ticks at a time .",
    "[ [ economic - motivation . ] ] economic motivation .",
    "+ + + + + + + + + + + + + + + + + + + +    to begin with , the choice of a finite activity pure jump process for @xmath13 mimics the fact that in reality the bid price is constant between events and jumps only when a market sell order is executed or when a new limit buy order above the current bid price arrives .",
    "this discrete nature of the bid price evolution is illustrated in figure  [ fig : amazon ]        we admit that portfolio execution strategies are typically carried out on a somewhat larger timescale , so that for very liquid assets with extremely rapid order arrival the bid price process could be approximated by a diffusion , as it is done in the bulk of the literature .",
    "however even in this case it is interesting to study optimal portfolio execution in a model that takes the fine structure of high frequency data seriously .",
    "the assumption that @xmath34 depends on the liquidation rate serves to model _ permanent price impact .",
    "_ it is well known that a high selling rate increases the likelihood of downward jumps in the bid price , since other traders tend to reshuffle their orders in reaction to the observed selling activity ; empirical evidence is presented for instance in ( * ? ? ?",
    "* chapter 4 ) .",
    "as shown in the examples below , this feature is easily reproduced in our framework .",
    "the fact that @xmath76 depends explicitly on time can be used to model the strong intraday seasonality patterns observed for high frequency data .",
    "there are several reasons for introducing an unobservable regime switching factor @xmath2 in the price dynamics .",
    "first , this helps to reproduce the clustering in inter - event durations observed in high frequency data .",
    "more importantly , @xmath2 can be used to model the feedback effect from the trading activity of the rest of the market : @xcite observes that in reality the order flow is clustered in time : we observe periods with a lot of buy orders and periods with a lot of sell orders .",
    "this is partly due to the fact that many observed orders are components of a larger parent order that is executed in small blocks to minimize market impact .",
    "this behaviour of prices can be mimicked by having a high intensity of downward jumps in one state of @xmath2 , and having a high intensity of upward jumps in another state of @xmath2 , see also example  [ exm2 ] below . with this interpretation in mind ,",
    "it is natural to assume that @xmath2 is not directly observable for the trader , as the trading activity of other investors can be observed only indirectly via its impact on the price . in this context ,",
    "stochastic filtering allows the trader to estimate the state of @xmath2 in an optimal way .",
    "the following examples serve to illustrate our framework ; they will be taken up in our numerical experiments in section  [ sec : numerics ] .",
    "[ exm1 ] consider the case where the return process @xmath29 follows a bivariate point process , i.e. there are two possible jump sizes , @xmath77 for some @xmath78 . in this example",
    "we assume that the dynamics of @xmath13 is independent of @xmath2 and @xmath79 .",
    "moreover , the intensity @xmath80 of an upward jump is constant and equal to @xmath81 , and the intensity @xmath82 of a downward jump depends on the rate of trading and is given by @xmath83 for constants @xmath84 .",
    "note that , with this choice of @xmath82 , the intensity of a downward jump in @xmath13 is linearly increasing in the liquidation rate @xmath72 .",
    "the function @xmath85 from   is independent of @xmath79 and @xmath86 and linearly decreasing in @xmath72 ; it is given by @xmath87 .",
    "linear models for the permanent price impact are frequently considered in the literature as they have theoretical and empirical advantages ; see for instance @xcite or @xcite .",
    "[ exm2 ] now we generalize example  [ exm1 ] and allow @xmath88 to depend on the state process @xmath2 .",
    "we consider a two - state markov chain @xmath2 with the state space @xmath89 and we assume that @xmath90 is a ` good ' state and @xmath91 a ` bad ' state in the following sense : in state @xmath90 the intensity of an upward move of the stock is larger than in state @xmath91 ; the intensity of a downward move on the other hand is larger in state @xmath91 than in @xmath90 . given constants @xmath92 , @xmath93 and @xmath94 we set @xmath95 for @xmath96 .",
    "then , @xmath97 .",
    "note that in this model we again have a linear permanent price impact .",
    "[ rem : calibration ] we briefly discuss a potential approach for parameter estimation in our setup .",
    "consider the model from example  [ exm2 ] .",
    "for @xmath98 the model is a hidden markov model with point process observation .",
    "it is therefore natural to use the expectation maximization ( em ) methodology for markov modulated point processes as described in  @xcite or in @xcite to estimate the generator matrix of @xmath2 and the parameters @xmath99 , @xmath100 , @xmath101 and @xmath102 . using proprietary data on the performance of equity sales , @xcite find empirical support for a linear permanent price impact function ; the parameter @xmath103 can be estimated by regressing price changes on trading volume .      in this section",
    "we specify the ingredients of the traders optimization problem in detail .    [",
    "[ liquidation - strategies . ] ] liquidation strategies .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    we assume that the state process @xmath2 is not directly observable by the trader .",
    "instead , she observes the price process @xmath13 and knows the model parameters ( see remark  [ rem : calibration ] ) , so that the information available to her is carried by the filtration @xmath14 or , equivalently , by the filtration generated by the return process @xmath29 .",
    "hence we assume that the trader uses only liquidation strategies that are @xmath14-adapted .",
    "moreover we impose a bound on the maximal speed of trading : we fix some constant @xmath104 and we call a liquidation strategy @xmath18 _ admissible _ if @xmath18 is @xmath14-adapted and if @xmath105 $ ] for all @xmath16 $ ] @xmath69 a.s .",
    "note that the condition @xmath104 ensures that it is feasible for the trader to liquidate the whole inventory over the period @xmath106 $ ] .",
    "the assumption of a bounded liquidation rate merits a discussion . from a mathematical point of view a bound on the liquidation rate facilitates the application of results for the control of piecewise deterministic markov processes , since in this theory it is typically assumed that the strategies take values in a compact control space . moreover , without this assumption the viscosity solution characterization of the value function ( theorem  [ thm : viscosity ] below ) does not hold ; a counterexample is given in section  [ subsec : counterexample ] .",
    "there we show that for unbounded liquidation rate the value function turns out to be a strict supersolution of the corresponding dynamic programming equation . finally , the upper bound on @xmath1 ensures that under assumption  [ ass1 ] for every admissible strategy @xmath18 a return process @xmath29 with compensating measure @xmath107 ( and hence the bid price process ) exists .    from a financial point of view",
    "an upper bound on @xmath1 is reasonable , as trading at infinite speed would correspond to large block transactions ; allowing such transactions at some time point @xmath108 would require an explicit model for market resiliency .",
    "it is however not clear how to determine @xmath66 empirically . in proposition",
    "[ prop : bound - on - value ] we therefore show that @xmath109 , the optimal proceeds from liquidation if the trader uses @xmath14 adapted strategies with @xmath110 for all @xmath79 , is bounded independently of @xmath111 .",
    "now the sequence @xmath112 is obviously increasing , since a higher @xmath111 means that the trader can optimize over a larger set of strategies .",
    "hence @xmath112 is cauchy , and the optimal proceeds from liquidation are essentially independent of the precise numerical value chosen for @xmath66 , provided that the upper bound is sufficiently large .",
    "this is confirmed by our numerical experiments , see table [ tab : numax ] .",
    "[ [ objective - of - the - trader . ] ] objective of the trader .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    to account for the case where not all shares have been sold prior to time @xmath10 we specify the liquidation value of the remaining share position @xmath113 .",
    "this liquidation value is of the form @xmath114 for some increasing , continuous and concave function @xmath115 with @xmath116 and @xmath117 .",
    "we give some examples for @xmath115 .",
    "the choice @xmath118 corresponds to the case where liquidation at the terminal date is not possible ; the choice @xmath119 for some @xmath120 models a situation where the liquidation value of the remaining shares is positive but strictly smaller than the book value , reflecting the limited liquidity of the market for the stock .",
    "we do not need to model market resiliency or permanent price impact as the model ` ends ' at @xmath10 . ]",
    "we model the temporary price impact by a nonnegative and increasing function @xmath121 so that the proceeds from liquidation are given by @xmath122 .",
    "for instance , @xcite propose a power function of the form @xmath123 and they estimate the coefficient @xmath124 .",
    "now we define the time @xmath125 as the minimum of the first time the inventory is completely liquidated and the horizon @xmath10 : @xmath126 denote by @xmath127 the ( subjective ) discount rate of the trader .",
    "consider an admissible strategy @xmath18 and denote the corresponding bid price by @xmath128 .",
    "the expected discounted value of the proceeds generated by the liquidation strategy @xmath18 is equal to @xmath129 the trader wants to maximize over all admissible strategies ; the corresponding optimal value is denoted by @xmath130 , or , if we want to emphasize the dependence on the upper bound on the liquidation rate , by @xmath131 .",
    "note that the form of the objective function in implies that the trader is risk neutral .",
    "risk neutrality is frequently assumed in the literature on optimal order execution , see for instance @xcite .",
    "moreover , in our setup the risk the trader may take is limited as we consider pure selling strategies and as the time period @xmath106 $ ] is fairly short .    the next proposition establishes an upper bound on @xmath130 .",
    "[ prop : bound - on - value ] suppose that assumption  [ ass1 ] holds and that the function @xmath50 from is decreasing in @xmath72 , and set @xmath132 , e \\in \\mathcal{e}\\}.\\ ] ] then @xmath133 .",
    "note that the upper bound on @xmath130 corresponds to the liquidation value of the inventory in a frictionless model where the expected value of the bid price grows at the maximum rate @xmath134 .",
    "fix some @xmath14-adapted strategy @xmath18 with values in @xmath135 $ ] and let @xmath136 .",
    "since @xmath137 we get by partial integration that @xmath138 since @xmath116 and @xmath139 we thus get that @xmath140 now @xmath141 .",
    "moreover , @xmath142 is a true martingale : as @xmath143 , a similar argument as in the proof of lemma  [ lemma : martingale - part - of - s ] shows that this process is of integrable quadratic variation .",
    "since @xmath144 , @xmath145 and @xmath146 , we get @xmath147 next we show that @xmath148 . to this , note that by lemma [ lemma : martingale - part - of - s ] , @xmath149 is a true martingale so that @xmath150 and the claim follows from the gronwall inequality .",
    "using we finally get that @xmath151 , and hence the result .",
    "considering @xmath14-adapted investment strategies results in an optimal control problem under partial information .",
    "the standard approach to dealing with such problems is to introduce the filter for the markov chain as additional state variable of the control problem . in this section",
    "we therefore derive the filtering equations for our model .",
    "filtering for point processes observation is for instance considered in @xcite .",
    "this literature is mostly based on the innovations approach . in this paper , instead , we address the filtering problem via the _ reference probability approach_. this methodology relies on the existence of an equivalent probability measure such that the observation process is driven by a random measure with dual predictable projection independent of the markov chain , see for instance ( * ? ? ?",
    "* chapter 6 ) .",
    "the reference probability approach permits us to overcome the difficulties caused by the fact that the observation process @xmath13 is affected by the liquidation strategy chosen by the trader .",
    "we start from a filtered probability space @xmath152 that supports a markov chain @xmath2 with state space @xmath153 and generator matrix @xmath154 , and an _ independent _ poisson random measure @xmath33 with compensator @xmath155 as in assumption [ ass1].2 ; @xmath70 is known as the _ reference probability_. note that under @xmath70 , the dynamics of @xmath13 and @xmath29 are independent of the liquidation strategy @xmath18 so that @xmath14 is exogenously given . moreover , due to the independence of @xmath29 and @xmath2 , the @xmath156-dual predictable projection of the jump measure @xmath45 of the pair @xmath157 has the form @xmath158 fix an admissible liquidation strategy @xmath18 and define the function @xmath159 by @xmath160 i.e. @xmath161 is the radon - nikodym derivative of the measure @xmath162 with respect to @xmath163 . define for @xmath164 the stochastic exponential @xmath165 by @xmath166 then we have the following result .",
    "[ lem : change - of - measure ] let assumption [ ass1 ] prevail . then the process @xmath165 is a strictly positive martingale with @xmath167 define a measure @xmath69 on @xmath168 by setting @xmath169",
    ". then @xmath69 and @xmath70 are equivalent and , under @xmath69 , the random measure @xmath45 has the compensator @xmath170 given in .",
    "conversely , given a pair @xmath157 with compensating random measure @xmath171 as in , the reference probability @xmath70 can be constructed by the inverse change of measure .",
    "the proof of the lemma is postponed to appendix [ app : filtering ] .",
    "note that lemma  [ lem : change - of - measure ] ensures , for every admissible @xmath18 , the existence of a pair @xmath157 with compensating measure @xmath172 , that is unique in law .      for a function @xmath173",
    ", we introduce the filter @xmath174 as the optional projection of the process @xmath175 on the filtration @xmath14 , i.e.  @xmath174 is a cdlg process such that for all @xmath16 $ ] , it holds that @xmath176 . note that @xmath177 , where @xmath178 denotes the scalar product on @xmath179 and @xmath180 , @xmath181 , so that functions of the markov chain can be identified with @xmath182-vectors",
    "let @xmath183 .",
    "then , we can represent the filter as @xmath184.\\ ] ] in this section we derive the dynamics of the process @xmath185 .    by the kallianpur - striebel formula we have @xmath186 , for",
    "every @xmath16 $ ] , where @xmath187 denotes the _ unnormalized _ version of the filter defined by @xmath188\\,.\\ ] ] the next theorem gives the dynamics of @xmath187 .",
    "[ thm : zakai ] suppose assumption  [ ass1 ] holds and let @xmath189 .",
    "then , for every @xmath16 $ ] , the unnormalized filter solves the equation : @xmath190 where @xmath191 stands for for @xmath192 and @xmath193 .",
    "the idea of the proof of this theorem is the following .",
    "consider the process @xmath165 defined in and some function @xmath194 .",
    "then by it s formula , the product @xmath195 , has the following @xmath196-semimartingale decomposition @xmath197 where @xmath198 is the true @xmath199-martingale appearing in the semimartingale decomposition of @xmath175 .",
    "taking the conditional expectation with respect to @xmath200 on both sides gives the result , since @xmath201 .",
    "the details of the proof are given in appendix  [ app : filtering ] .",
    "we introduce the notation @xmath202.\\ ] ] by applying ( * ? ? ?",
    "ii , theorem t14 ) it is easy to see that @xmath203 provides the @xmath204-dual predictable projection of the measure @xmath33 .",
    "the next proposition provides the filter dynamics .",
    "[ k - s ] the @xmath204-semimartingale decomposition of the normalized filter @xmath174 is given by @xmath205 where @xmath206 .",
    "note that the filtering equation does not depend on the particular choice of the reference probability @xmath70 .",
    "the proof is a tedious application of the ito formula , see appendix  [ app : filtering ] .",
    "[ cor : ks - equation ] the process @xmath207 solves the following sde system @xmath208 for every @xmath16 $ ] , where @xmath209 .",
    "we set @xmath210 in proposition  [ k - s ] and obtain the result .",
    "[ [ example-2.2-revisited ] ] example 2.2 revisited + + + + + + + + + + + + + + + + + + + + +    in the following we now give the dynamics of @xmath211 for example [ exm2 ] . in this case",
    "it is sufficient to specify the dynamics of @xmath212 , since @xmath213 .",
    "define two point processes by @xmath214 and @xmath215 , @xmath16 $ ] , that count the upward and the downward jumps of the return process , respectively .",
    "note that the function @xmath216 is given by @xmath217 by corollary  [ cor : ks - equation ] we then get the following equation for @xmath218 @xmath219    representing the underlying stochastic factor that drives the market by a finite - state markov chain is clearly an approximation of a real world situation . hence there may arise robustness issues associated to the choice of the dynamics of @xmath2 .",
    "nevertheless , under certain conditions , if the approximating state process @xmath2 is close ( in the sense of weak convergence ) to the real state process then also the corresponding filters are close . for precise mathematical results in the context of point process observations we refer to @xcite or @xcite .",
    "we begin with a brief overview of our analysis of the control problem  . in proposition",
    "[ prop : pdmp - exists ] below we show that the kushner stratonovich equation has a unique solution .",
    "then , standard arguments ( see for instance @xcite ) ensure that the original control problem under incomplete information is equivalent to a control problem under complete information with state process equal to the @xmath220-dimensional process @xmath221 .",
    "this process is a pdmp in the sense of @xcite .",
    "a trajectory of a pdmp consists of a deterministic part , which is a solution of an ordinary differential equation ( ode ) , interspersed by random jumps .",
    "we apply control theory for pdmps to the optimal liquidation problem .",
    "this theory is based on the observation that a control problem for a pdmp is discrete in time : loosely speaking , at every jump - time @xmath222 of the process one chooses a control policy to be followed up to the next jump time or until maturity .",
    "therefore , one can identify the control problem for the pdmp with a control problem for a discrete - time , infinite - horizon markov decision model ( mdm ) . using this connection",
    "we show that the value function of the optimal liquidation problem is continuous and the unique solution of the dynamic programming or optimality equation for the mdm , and we establish the existence of an optimal strategy in the set of all relaxed controls .",
    "these results are the basis for the viscosity - solution characterization of the value function in section  [ sec : viscosity ] .",
    "there are several contributions where optimal control for pdmps is studied via mdms , see for instance @xcite .      from the viewpoint of the trader endowed with the filtration @xmath14",
    ", the state of the economic system at time @xmath223 $ ] is given by @xmath224 .",
    "to make the piecewise deterministic process markovian it is convenient to include time into the state ; we set @xmath225 . in this section",
    "we show that this process is a pdmp in the sense of @xcite and we rewrite the original control problem as control problem for a pdmp .",
    "the corresponding state space is @xmath226\\times \\mathcal x$ ] where @xmath227\\times\\r^+\\times \\s^k $ ] and @xmath228 is the @xmath182-dimensional simplex .",
    "let @xmath229 be the liquidation strategy followed by the trader .",
    "it follows from , , and from the fact that the bid price is a pure jump process that between jump times the state process follows the ode @xmath230 , where the vector field @xmath231 is given by @xmath232 , @xmath233 , @xmath234 , and for @xmath235 , @xmath236 for our analysis we need the following regularity property of @xmath237 .",
    "[ lemma : lipschitz ] under assumption  [ ass1 ] , the function @xmath237 is lipschitz continuous in @xmath238 uniformly in @xmath79 and @xmath72 .",
    "the proof is postponed to appendix  [ subsec : proofs-4 ] .",
    "the _ jump rate _ of the state process @xmath239 is given by @xmath240 , where @xmath241 note that @xmath242 is independent of @xmath243 and @xmath244 .",
    "next , we identify the transition kernel @xmath245 that governs the jumps of the state process .",
    "denote by @xmath246 the probability of jumping to a point in the set @xmath247 for a given state @xmath248 and a given control @xmath249 $ ] .",
    "it follows that for any bounded and measurable function @xmath250 , @xmath251 where the unnormalized kernel @xmath252 is given by @xmath253    the state process of the optimal liquidation problem is a pdmp with characteristics given by the vector field @xmath237 , the jump rate @xmath254 and the transition kernel @xmath245 . it is standard in control theory for pdmps to work with so - called open - loop controls . in the current context",
    "this means that the trader chooses at each jump time @xmath255 a liquidation policy @xmath256 to be followed up to @xmath257 .",
    "this policy may depend on the state @xmath258 and is therefore denoted by @xmath259 .",
    "denote by @xmath260 the set of measurable mappings @xmath261\\to [ 0,{\\nu^{\\text{max}}}]$ ] .",
    "we define an _",
    "admissible open loop liquidation strategy _ as a sequence of mappings @xmath262 ; the liquidation rate at time @xmath79 is given by @xmath263 } ( t )    \\nu^n ( t- t_n,\\widetilde x_{t_n}).\\end{aligned}\\ ] ] it follows from ( * ? ? ? * theorem  t34 , appendix  a2 ) that an admissible strategy as defined in section  [ subsec : optimization - problem ] has the form for @xmath264 measurable mappings @xmath265 , where @xmath266 may depend on the entire history of the system .",
    "general results for markov decision models ( see ( * ? ? ?",
    "* theorem  2.2.3 ) ) show that the expected profit of the trader stays the same if instead we consider the smaller class of admissible open loop strategies , so that from now on it is implicitly understood that an admissible strategy is automatically an open loop strategy of the form .",
    "[ prop : pdmp - exists ] let assumption  [ ass1 ] hold .",
    "for every admissible liquidation strategy @xmath267 and every initial value @xmath238 , a unique pdmp with characteristics @xmath237 , @xmath254 , and @xmath245 as above exists .",
    "in particular the kushner - stratonovic equation has a unique solution .",
    "lemma [ lemma : lipschitz ] implies that for @xmath268 the ode @xmath269 has a unique solution so that between jumps the state process is well - defined . at any jump time @xmath222",
    ", @xmath270 is uniquely defined in terms of observable data @xmath271 . moreover , since the jump intensity is bounded by @xmath272 , jump times can not accumulate .",
    "denote by @xmath273 ( equiv .",
    "@xmath274 ) the law of the state process provided that @xmath275 and that the trader uses the open - loop strategy @xmath276 .",
    "the reward function associated to an admissible liquidation strategy @xmath277 is @xmath278 and the value function of the liquidation problem under partial information is @xmath279    [ rem : v - pos - hom ] note that the compensator @xmath88 and the dynamics of the filter @xmath211 are independent of the current bid price @xmath244 , and that the payoff of a liquidation strategy @xmath267 is positively homogeneous in @xmath244 .",
    "this implies that the reward and the value function of the liquidation problem are positively homogeneous in @xmath244 and in particular @xmath280      the optimization problem in is essentially discrete : the control policy is chosen at the discrete time points @xmath281 , @xmath282 , and , given an admissible control policy , the sequence @xmath283 is markov .",
    "hence can be rewritten as a control problem in an infinite horizon mdm . in this section",
    "we identify this mdm . a short introduction to mdms",
    "is given in appendix [ app : mdm ] .",
    "[ [ basic - definitions . ] ] basic definitions .",
    "+ + + + + + + + + + + + + + + + + +    let @xmath284 be a cemetery state .",
    "consider the sequence @xmath285 of random variables defined by @xmath286 in order to derive the transition kernel of the sequence @xmath285 and the corresponding reward function of the mdm , we introduce some notation . for a function @xmath287",
    "we denote by @xmath288 or by @xmath289 the flow of the initial value problem @xmath290 with initial condition",
    "@xmath291 whenever we want to make the dependence on time explicit we write @xmath292 in the form @xmath293 .",
    "next we define the functions @xmath294 finally we consider the boundary of the state space @xmath295 .",
    "note that @xmath296 belongs to the hyperplane @xmath297 , so that @xmath295 is contained in the set @xmath298 which is a hyperplane of @xmath299 . when considering the boundary or the interior of @xmath295 we always refer to the _ relative _ boundary or the _ relative _ interior with respect to @xmath300 .",
    "of particular interest to us is the _ active boundary _ @xmath301 of the state space , that is the part of the boundary of @xmath295 which can be reached by the flow @xmath288 starting in an interior point @xmath302 .",
    "the boundary of the state space @xmath303 can only be reached if @xmath304 , if @xmath305 , or if the filter process reaches the boundary of the @xmath182-dimensional simplex .",
    "the latter is not possible : indeed , if @xmath306 , then @xmath307 for all @xmath223 $ ] , since there is a positive probability that the markov chain has not changed its state .",
    "hence the active boundary equals @xmath308 , where @xmath309 \\times \\{0\\ } \\times ( 0 , \\infty ) \\times \\s^k_0 \\ \\text { and } \\ \\gamma_2 = \\{t\\ } \\times [ 0 , w_0 ] \\times ( 0 , \\infty ) \\times \\s^k_0,\\ ] ] and where @xmath310 is the interior of @xmath228 , i.e. @xmath311 . in",
    ", @xmath312 is the lateral part of the active boundary that corresponds to an inventory level equal to zero and @xmath313 is the terminal boundary related the exit from the state space at maturity @xmath10 .    in the sequel",
    "we denote the first exit time of the flow @xmath288 from @xmath295 by @xmath314 notice that the stopping time @xmath125 defined in corresponds to the first time the state process @xmath315 reaches the active boundary @xmath301 and also that @xmath316 is equal to @xmath125 , if there is no jump in the time interval @xmath317 .",
    "[ [ transition - kernel . ] ] transition kernel .",
    "+ + + + + + + + + + + + + + + + + +    to identify the transition kernel of the sequence @xmath285 , we denote by @xmath318 the inter - arrival times of the jumps of @xmath29 . for a bounded and measurable function @xmath319",
    ", it holds that @xmath320 now note that @xmath321 .",
    "moreover , the distribution of @xmath322 given @xmath323 and @xmath324 is equal to @xmath325 .",
    "hence , we get @xmath326 moreover , using the transition kernel of the state process given in , for @xmath327 we have @xmath328 by integrating with respect to the conditional distribution of @xmath329 , we get that the transition kernel @xmath330 of @xmath331 is given by @xmath332 moreover , since the cemetery state is absorbing , @xmath333 .    [",
    "[ reward - function - of - the - associated - mdm . ] ] reward function of the associated mdm .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we now identify the optimal liquidation problem with a mdm for the sequence @xmath285 . for this",
    ", we define for @xmath238 the one - period reward function @xmath334 by @xmath335 where @xmath336 represents the inventory - component of @xmath292 , and we set @xmath337 . for an admissible strategy @xmath277 we let @xmath338 , and",
    "@xmath339 the next lemma shows that the mdm with transition kernel @xmath330 and one - period reward @xmath340 is equivalent to the optimization problem .",
    "[ lemma2.1 ] for every admissible strategy @xmath267 it holds that that @xmath341 .",
    "hence @xmath342 , and the control problems and are equivalent .",
    "the proof is in appendix [ subsec : proofs-4 ] .",
    "next we use theorem  [ thm : optimality - general ] to derive the optimality equation for the value function @xmath343 and hence for @xmath344 . for this",
    "we face a number of tasks .",
    "first , we need to introduce a topology on the control set @xmath345 so that @xmath345 is compact ; second , we need to find a suitable bounding function ; finally , we need to ensure that @xmath346 and @xmath330 are continuous with respect to the topology on @xmath345 .",
    "we introduce the following continuity conditions on the data of our model :    [ ass2 ] for all @xmath347 ,    1 .",
    "the measure @xmath348 is continuous in the weak topology , i.e.  for all bounded and continuous functions @xmath121 , the mapping @xmath349 is continuous on @xmath106 \\times [ { 0 } , { \\nu^{\\text{max}}}]$ ] ; 2 .   for the functions",
    "@xmath350 introduced in corollary  [ cor : ks - equation ] the following holds : for any sequence @xmath351 \\times \\s^k$ ] , such that @xmath352 { } ( t , \\nu , \\pi)$ ] , one has @xmath353    [ [ relaxed - controls - and - the - young - topology . ] ] relaxed controls and the young topology .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the standard approach to ensure that @xmath345 is compact is to extend the control set and to allow for randomized or relaxed controls .",
    "we define the set of _ relaxed controls _ by @xmath354\\to   \\mathcal{m}^1([{0},{\\nu^{\\text{max}}}])\\   \\text{measurable }   \\},\\end{gathered}\\ ] ] where @xmath355)$ ] is the set of probability measures on @xmath356 $ ] . in line with the definition of an admissible liquidation strategy in the non - relaxed framework ,",
    "an _ admissible relaxed liquidation strategy _ is a sequence of mappings @xmath357 .",
    "a suitable topology on @xmath358 is the so - called _ young topology .",
    "_    the young topology on @xmath358 is the coarsest topology such that all mappings of the form @xmath359 are continuous for all functions @xmath360\\times[{0 } , { \\nu^{\\text{max}}}]\\to\\mathbb{r}$ ] that are continuous in the second argument , measurable in the first one , and satisfy the condition @xmath361}\\}{\\mathrm",
    "d}t < \\infty$ ] .    notice that @xmath345 is a subset of @xmath358 , since standard ( non - relaxed ) controls can be identified with dirac measures on @xmath362 $ ] .",
    "furthermore , applying the chattering theorem , see ( * ? ? ?",
    "* , theorem 2.2 ) , it is possible to show that @xmath345 is dense in @xmath358 with respect to the young topology .",
    "these facts imply that relaxed controls can be approximated by deterministic controls .",
    "for further details on the young topology we refer to @xcite or ( * ? ? ?",
    "next , we extend the definition of the reward function and the transition kernel of the mdm @xmath331 to a setup with relaxed controls . for a measurable function @xmath363 on @xmath356 $ ] and some measure @xmath364)$ ] , we define @xmath365 . with relaxed controls , the vector fields @xmath237 of the pdmp",
    "is defined as @xmath366 as before , the flow associated to this vector field is denoted by @xmath367 and @xmath368 is the entrance time of @xmath367 into the active boundary @xmath301 of @xmath295 . for a relaxed control",
    "@xmath369 the jump intensity is given by @xmath370 , and we set @xmath371    recall that the temporary price impact is modelled by the function @xmath121 . then the reward function is extended for controls from @xmath358 as follows : @xmath372 finally we extend the transition kernel @xmath330 to @xmath358 by setting @xmath373    [ [ bounding - function ] ] bounding function + + + + + + + + + + + + + + + + +    the following lemma gives the bounding function @xmath374 ( see definition  [ boundingf ] ) for the current problem .",
    "our choice of @xmath374 is motivated by @xcite .",
    "[ lemma : bounding - function ] for @xmath375 , we define @xmath376 by @xmath377 for every @xmath378 , and @xmath379 .",
    "then under assumptions  [ ass1 ] and  [ ass2 ] , @xmath380 is a bounding function for the mdm with transition kernel @xmath330 and reward function @xmath346 .",
    "moreover , the mdm is contracting for @xmath381 sufficiently large .",
    "the proof is postponed to appendix [ subsec : proofs-4 ] . in the sequel",
    "we denote by @xmath382 the set of all functions @xmath383 such that @xmath384 for all @xmath385 and some @xmath386 .",
    "note that for @xmath387 , @xmath388 .",
    "[ [ continuity - of - r - and - q_l . ] ] continuity of @xmath346 and @xmath330 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    finally we show that under assumptions  [ ass1 ] and  [ ass2 ] , @xmath346 and @xmath330 satisfy the continuity conditions in theorem  [ thm : optimality - general ] .",
    "[ prop : continuity ] suppose that assumptions  [ ass1 ]  and  [ ass2 ] hold .",
    "consider a continuous function @xmath389 .",
    "then the mappings @xmath390 and @xmath391 are continuous on @xmath392 with respect to the young topology on @xmath358 .",
    "consider some sequence @xmath393 , where @xmath394 .",
    "it follows from ( * ? ? ?",
    "* theorem 43.5 ) that @xmath395 this does however not imply that @xmath396 , the entrance time of @xmath397 into the active boundary of the state space , converges to @xmath398 ; for this we would need a strictly positive lower bound on the liquidation rate , see also ( * ? ? ?",
    "* example  44.15 ) . to deal with this issue",
    "we distinguish two cases :    _ case 1 . _ the flow @xmath399 exits the state space @xmath295 at the terminal boundary @xmath313 ( see ) .",
    "this implies that @xmath400 and that the inventory level @xmath401 is strictly positive for @xmath402 .",
    "we therefore conclude from that @xmath396 converges to @xmath403 and that @xmath404 converges to @xmath405 .",
    "the continuity of the one - period reward @xmath346 and of @xmath406 follows immediately using the definition of @xmath346 and the continuity of the mapping @xmath407 established in lemma  [ lemma : continuity - of - ql ] , see appendix  [ subsec : proofs-4 ] .",
    "_ case 2 . _ the flow @xmath399 exits @xmath295 at the lateral boundary @xmath312 so that @xmath408 . in that case",
    "it may happen that @xmath409 ; only implies that @xmath410 . in order to prove the continuity of @xmath346 we decompose @xmath411 ( setting @xmath412 for simplicity ) as follows : @xmath413 now it follows from that the integral in converges to @xmath414 .",
    "the terms in are bounded from above by @xmath415 ; this can be shown via a similar partial integration argument as in the proof of lemma  [ lemma : bounding - function ] , see appendix  [ subsec : proofs-4 ] .",
    "moreover , @xmath416 converges to @xmath417 , which gives the convergence @xmath418 .",
    "finally we turn to the continuity of @xmath406 .",
    "we decompose @xmath406 as follows : @xmath419 the integral in converges to @xmath420 by and the continuity of the mapping @xmath407 ( lemma  [ lemma : continuity - of - ql ] ) . to deal with the integral in note that @xmath421 ( as @xmath422 is a probability transition kernel ) , so that is smaller than @xmath423      in this section we use theorem  [ thm : optimality - general ] to derive the optimality equation for the value function @xmath344 . to formulate our result , for @xmath424",
    "we define the mapping @xmath425 by @xmath426 and the _ maximal reward operator _",
    "by @xmath427    [ thm : fixed_point ] suppose that assumptions  [ ass1 ]  and  [ ass2 ] hold .",
    "then the following assertion hold :    1 .",
    "the value function @xmath344 is continuous on @xmath428 and satisfies the boundary conditions @xmath429 for @xmath238 in the lateral boundary @xmath312 and @xmath430 .",
    "moreover , @xmath344 is the unique fixed point of the operator @xmath431 in @xmath382 .",
    "2 .   there exists an optimal relaxed markov control .",
    "more precisely , the stationary strategy @xmath432 with @xmath433 , for every @xmath434 and @xmath435 is optimal .",
    "the claim follows immediately from theorem  [ thm : optimality - general ] in appendix [ app : mdm ] .",
    "lemma  [ lemma : bounding - function ] ensures the existence of a legitimate bounding function for the mdm , and proposition  [ prop : continuity ] ensures that the continuity conditions are satisfied .",
    "the equation @xmath436 is the _ optimality equation _ for @xmath344 . in explicit form",
    "it reads as follows : @xmath437    since relaxed controls are difficult to interpret , we next provide a characterization of @xmath344 that involves only non - relaxed controls .",
    "define the operator @xmath438 with @xmath439 .",
    "[ cor : non - relaxed - controls ] under the assumptions of theorem  [ thm : fixed_point ] , @xmath344 is the unique fixed point of the operator @xmath440 in @xmath382 .",
    "clearly , @xmath441 , as in the definition of @xmath440 the supremum is taken over a smaller set of controls than in the definition of @xmath431 .",
    "fix @xmath442 . by the chattering theorem ( * ? ? ?",
    "* , theorem 2.2 ) @xmath345 is dense in @xmath443 with respect to the young topology , and that the mapping @xmath444 is continuous in the young topology by proposition  [ prop : continuity ] .",
    "hence we may choose a sequence @xmath445 with @xmath446 for @xmath447 to obtain @xmath448 .",
    "this gives the equality @xmath449 .",
    "uniqueness of the fixed point of @xmath438 is clear since the operator @xmath438 is contracting .",
    "note that @xmath438 is the optimality operator for the set @xmath345 of non - relaxed controls .",
    "hence , the corollary shows that the value function @xmath344 can be characterized in terms of non - relaxed controls .",
    "nevertheless , it is not possible , to the best of our knowledge , to make a statement about the existence of an optimal strategy taking values in the set of non - relaxed controls .",
    "in this section we follow the approach of @xcite and characterize the value function as the viscosity solution of the standard hjb equation associated with the controlled markov process @xmath450 .",
    "moreover we derive a comparison principle for that equation .",
    "these results are crucial for establishing the convergence of suitable numerical schemes for the hjb equation and thus for the numerical solution of the optimal liquidation problem ; see appendix  [ app : num ] for details .",
    "finally , we provide an example which shows that in general the hjb equation does not admit a classical solution .      as a first step we use the positive homogeneity of @xmath344 in the bid price @xmath244 to eliminate this variable from the set of state variables and to reduce the problem to a bounded state space .",
    "define @xmath451 \\times [ 0 , w_0 ] \\times \\s^k $ ] and set for @xmath452 , @xmath453 so that the value function satisfies the relation @xmath454 . for @xmath455 $ ] , @xmath456 , and any measurable function @xmath457 ,",
    "define @xmath458 note that the function @xmath237 from is independent of @xmath244 , and define @xmath459\\to \\r^{k+2}$ ] by @xmath460 finally , denote by @xmath461 the flow of @xmath462 and by @xmath463 the first time this flow reaches the active boundary @xmath464 of @xmath465 , where @xmath466 \\times \\{0\\ } \\times \\s^k_0   \\cup \\{t\\ } \\times [ 0 , w_0 ]   \\times \\s^k_0\\,.\\ ] ] below , we write @xmath467 and @xmath468 to denote the _ relative _ interior and the _ relative _ boundary of @xmath465 with respect to the hyperplane @xmath469 . using corollary  [ cor : non - relaxed - controls ] , the homogeneity of @xmath344 and the fact that the jump intensity @xmath254 introduced in is independent of @xmath244 , we get the following optimality equation for @xmath470 : @xmath471    for @xmath457 bounded , define the function @xmath472 \\to \\r^+ $ ] by @xmath473 and the operator @xmath474 by @xmath475 with this , can be written as the fixed point equation @xmath476 . for fixed @xmath477",
    ", @xmath478 is the value function of a deterministic optimal exit - time problem .",
    "this problem is studied extensively in @xcite , and we will use his results to obtain a viscosity solution characterization of @xmath470 .    for @xmath479 , define the function @xmath480 by @xmath481 } \\big \\{-(\\rho + \\lambda ( \\widetilde{y } , \\nu ) ) v   +   g(\\widetilde{y } , \\nu ) ' p + \\ell^{\\psi } ( \\widetilde y , \\nu ) \\big \\}\\,.\\ ] ] then the dynamic programming equation associated with the exit time optimal control problem   is @xmath482 there are two issues with this equation : first , @xmath483 is typically not sufficiently smooth to be a classical solution of ; second , it is not clear how to treat the non - active part of the boundary , as for @xmath484 , @xmath485 is determined endogenously . to overcome these problems @xcite proposes to use the following notion of viscosity solutions .",
    "[ def : viscosity-1 ]    * a bounded upper semi - continuous ( u.s.c . )",
    "function @xmath486 on @xmath465 is a _ viscosity subsolution _ of , if and only if for all @xmath487 the following holds : if @xmath488 is a local maximum of @xmath489 , one has @xmath490 * a bounded lower semi - continuous ( l.s.c . )",
    "function @xmath491 on @xmath465 is a _ viscosity supersolution _ of , if and only if for all @xmath487 the following holds : if @xmath488 is a local minimum of @xmath492 , one has @xmath493 * a _ viscosity solution _ @xmath483 of is either a continuous function on @xmath465 that is both a sub and a supersolution of , or a bounded function the u.s.c .  and l.s.c",
    ".  envelopes of which are a sub and a supersolution of .",
    "note that definition [ def : viscosity-1 ] allows for the case that for certain boundary points @xmath494 one has @xmath495 .",
    "in particular , if @xmath496 in the viscosity sense , and hold irrespective of the value of @xmath497 and the boundary value @xmath498 is endogenously determined .",
    "now we return to the optimal liquidation problem .",
    "since @xmath470 satisfies the relation @xmath476 , we expect that @xmath470 solves ( in the viscosity sense ) the equation @xmath499 the difference between and is that in the latter the function @xmath477 is fixed .    [ def : viscosity-2 ] a bounded u.s.c",
    ". function @xmath486 on @xmath465 is a _ viscosity subsolution _ of , if and only if for all @xmath487 such that @xmath488 is a local maximum of @xmath489 the relation holds for @xmath500 . + a bounded ( l.s.c . )",
    "function @xmath491 on @xmath465 is a _ viscosity supersolution _ of , if and only if for all @xmath487 such that @xmath488 is a local minimum of @xmath492 , holds with @xmath501 .",
    "+ @xmath502 is a _ viscosity solution _ of , if it is both a sub and a supersolution of that equation ( with the same continuity properties as in definition  [ def : viscosity-1 ] ) .",
    "the next theorem is the main result of this section .",
    "[ thm : viscosity ] suppose that assumptions  [ ass1 ] and [ ass2 ] hold , and that the markov chain @xmath2 has no absorbing state ( @xmath503 for all @xmath22 ) .    1 .",
    "the value function @xmath502 is a continuous viscosity solution of in @xmath465 .",
    "2 .   a comparison principle holds for : if @xmath486 is a subsolution and @xmath491 a supersolution of such that @xmath504 and @xmath505 are bounded on @xmath465 and such that @xmath506 on the active boundary @xmath507 , then @xmath508 on @xmath467 .",
    "it follows that @xmath509 is the only continuous viscosity solution of .",
    "first , by theorem  [ thm : fixed_point ] , @xmath502 is continuous .",
    "* theorem  5.2 ) implies that @xmath502 is a viscosity solution of with @xmath510 and hence of equation : for the details we refer to ( * ? ? ?",
    "* lemma 7.5 ) .",
    "next we turn to the comparison principle .",
    "note that in order to establish the inequality @xmath511 we can not directly apply the comparison principle obtained in @xcite for , since we have to compare equations with different @xmath477 .",
    "instead we use an inductive argument based on the monotonicity of @xmath512 .",
    "let @xmath513 and define @xmath514 .",
    "it follows from ( * ? ? ?",
    "* theorem 5.2 ) that @xmath515 is a viscosity solution of with @xmath516 .",
    "moreover , @xmath517 is bounded on @xmath465 so that @xmath518 on @xmath507 .",
    "since @xmath519 is a supersolution of it is also a supersolution of with @xmath516 .",
    "it follows from ( * ? ? ?",
    "* theorem 5.3 ) ( comparison principle for ) , that @xmath520 ; this theorem applies since @xmath521 for all @xmath22 and since @xmath522 on @xmath507 .",
    "define now inductively @xmath523 , and suppose that @xmath524 .",
    "then , using the monotonicity of @xmath474 , we have @xmath525 this proves that @xmath526 for every @xmath527 .",
    "moreover , the sequence @xmath528 converges to @xmath470 since @xmath529 is a contraction ( see the discussion preceding theorem  [ thm : optimality - general ] ) , so that @xmath530 for all @xmath527 .",
    "analogously we can construct a sequence of functions @xmath531 with @xmath532 such that @xmath533 , and we conclude that @xmath534 .",
    "the remaining statements are clear .",
    "we briefly comment on the relation of theorem [ thm : viscosity ] to the results in @xcite .",
    "their analysis implies that @xmath470 is the unique continuous viscosity solution of .",
    "however , they do no not give a comparison principle for .",
    "this is crucial since we need comparison to establish the convergence of the numerical scheme for @xmath470 .",
    "finally write the hjb equation more explicitly . to this",
    ", we use the fact that @xmath535 , the definition of @xmath237 in and the definition of @xmath536 in to obtain the equation @xmath537\\big \\}\\,,\\end{aligned}\\ ] ] with @xmath538 given by @xmath539 where @xmath540 this equation coincides with the standard hjb equation associated with the controlled markov process @xmath541 .",
    "the advantage of using viscosity solution theory is that we are able to give a precise mathematical meaning to this equation , even in those cases where the value function is merely continuous .",
    "moreover , in the current setting we can not expect the existence of a classical solution to the hjb equation .",
    "indeed , in the next section we provide an example showing that the solution to the hjb equation only exists in the viscosity sense .",
    "we work in the context of example [ exm1 ] ( linear permanent price impact and no markov chain ) .",
    "for simplicity we let @xmath542 , @xmath543 , @xmath544 , @xmath545 ( no temporary price impact ) .",
    "moreover , we assume that @xmath546 .",
    "recalling the definition of @xmath85 in equation , we have that for @xmath547 $ ] , @xmath548 by the semimartingale decomposition of @xmath13 given in equation we get that @xmath13 is a supermartingale .",
    "we conjecture that it is optimal to sell as fast as possible to reduce the impact of the falling price , that is @xmath549 . in that case , for @xmath550 it holds that @xmath551 and the expected bid price is @xmath552 . by fubini s theorem we hence get @xmath553 and this integral is equal to @xmath554 in order to verify that @xmath502 is in fact the value function , we show that @xmath502 is a viscosity solution of the corresponding hjb equation [ eq : hjb_2 ] .",
    "note that in the current setting this equation reads as @xmath555 } \\right\\}=0.\\ ] ] first note that @xmath502 can not be a classical solution as it is not differentiable for points @xmath556 with @xmath557 and that @xmath502 satisfies the correct terminal and boundary conditions .",
    "next we verify that @xmath502 is a viscosity solution .",
    "fix some point @xmath558 .",
    "there are three different cases .",
    "_ case 1 : _",
    "@xmath559 . in that case @xmath560 and @xmath561 moreover , comparing the cases @xmath562 and @xmath563 , we get that the supremum in is attained for @xmath563 ( selling at the maximum rate is optimal ) , and a direct computation shows that the hjb equation   is satisfied in the classical sense .",
    "_ case 2 : _",
    "@xmath564 . in that case @xmath565 and @xmath566 again , comparing the cases @xmath562 and @xmath563 we get that the supremum in is attained for @xmath563 , ( as @xmath567 for @xmath562 due to the assumption @xmath568 ) , and a direct computation shows that holds in the classical sense .",
    "_ case 3 : _ @xmath569 .",
    "here we have to consider the sub and supersolution property . for the supersolution property",
    "there is nothing to show as there is no @xmath570-function @xmath571 such that @xmath572 has a local minimum in @xmath573 .",
    "for the subsolution , consider @xmath574 such that @xmath572 has a local maximum in @xmath573 .",
    "then we get that @xmath575 and that @xmath576 .",
    "moreover , it holds for @xmath577 that @xmath578 .",
    "differentiating with respect to @xmath79 gives that @xmath579 using the inequalities for @xmath580 we get that @xmath581}\\big\\}&=\\nu^{\\max}\\big(-\\frac{\\partial \\phi}{\\partial w}+ e^{\\overline{\\eta}^\\p(\\nu^{\\max})(t - t)}\\big ) .",
    "\\end{aligned}\\ ] ] as @xmath582 , this gives @xmath583\\big\\ } = 0      \\end{aligned}\\ ] ] and hence the subsolution property .",
    "note that the counterexample also works for nonzero temporary price impact , i.e. @xmath584 , see figure  [ fig : counterexample ] below .",
    "however , taking @xmath545 allows us to compute the value function and the optimal strategy explicitly .",
    ", @xmath585 , @xmath586 , and the other parameters as in table [ tab : params].[fig : counterexample],width=302 ]    [ [ unbounded - liquidation - rate . ] ] unbounded liquidation rate .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    finally we consider the limit of the value function as @xmath587 .",
    "note that @xmath588 .",
    "denote by @xmath589 the value function in .",
    "then it holds that @xmath590 @xmath591 is a strict ( classical ) supersolution of equation since @xmath592 this shows that @xmath593 is the value function of the optimal liquidation problem for @xmath594 , and we conclude that in the absence of a bound on the liquidation rate the viscosity - solution characterization from theorem  [ thm : viscosity ] ceases to hold in general .",
    "in this section we study in detail the value function and the optimal liquidation rate for example  [ exm2 ] . since the hjb equation can not be solved analytically , we resort to numerical methods .    [ [ numerical - method - and - parameters . ] ] numerical method and parameters .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the following we briefly sketch the approach we use .",
    "we apply an explicit finite difference scheme to solve the hjb equation and to compute the corresponding liquidation strategy .",
    "first , we turn the hjb equation into an initial value problem via time reversion . given a time discretization @xmath595 we set @xmath596 , and given @xmath597 , we approximate the liquidation strategy as follows : @xmath598 } h ( \\nu , t_k , w,\\pi , v'_{t_k } , \\nabla^{\\text{disc } } v'_{t_k } )    \\,,\\end{aligned}\\ ] ] where @xmath599 is the gradient operator with derivatives replaced by suitable finite differences . with this",
    "we obtain the next time iterate of the value function , @xmath600 in appendix [ app : num ] we describe the numerical scheme we apply .",
    "moreover , we use the approach of @xcite to show that the numerical solution converges to the unique viscosity solution of the hjb equation .    in our numerical experiments",
    " unless stated otherwise  we work with the parameter set given in table [ tab : params ] .",
    "the maximum rate of selling @xmath601 is chosen so that it is possible to liquidate the whole portfolio before @xmath10 .",
    "we model the temporary price impact as @xmath602 , with @xmath603 .",
    "moreover , we set the liquidation value @xmath604 , i.e.  we do not allow for a block sale at maturity @xmath10 . without loss of generality we set @xmath605 , so that the expected liquidation profit is equal to @xmath502 .",
    ".parameter values used in numerical experiments.[tab : params ] [ cols=\"^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     [ [ exampleexm2-re - revisited . ] ] example  [ exm2 ] re - revisited .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this example , @xmath34 depends on the 2-state markov chain @xmath2 and is of the form @xmath606 since @xmath607 , we can eliminate @xmath608 from the set of state variables . in the sequel",
    "we denote by @xmath609 the value function evaluated at the point @xmath610 . using the functions @xmath611 given in",
    ", the hamiltonian @xmath538 in becomes @xmath612 \\\\   & \\qquad \\times ( \\pi^1 c^\\text{down}_1+(1-\\pi^1)c^\\text{down}_2)(1+a\\nu)\\\\   & + \\left[(1+\\theta)v'\\left(t ,",
    "w,\\frac{\\pi^1 c^\\text{up}_1}{\\pi^1 c^\\text{up}_1+(1-\\pi^1 ) c^\\text{up}_2 }   \\right)-v'(t , w,\\pi^1)\\right](\\pi^1 c^\\text{up}_1+(1-\\pi^1)c^\\text{up}_2)\\ , .",
    "\\end{aligned}\\ ] ] the liquidation strategy is given by @xmath613 where @xmath614 , and @xmath615 denotes the discretized partial derivative in direction @xmath212 .",
    "+ we focus on three different research questions : ( i ) the impact of @xmath66 on the expected proceeds from liquidation ; ( ii ) the additional liquidation profit from the use of stochastic filtering ; ( iii ) the influence of the temporary and permanent price impact parameters on the form of the liquidation strategy .    [",
    "[ i - impact - of - nutextmax . ] ] ( i ) impact of @xmath66 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    table [ tab : numax ] displays the value function @xmath616 for varying @xmath66 ( expressed as multiple of the initial inventory @xmath617 ) and for fixed @xmath618 , @xmath619 .",
    "the value grows in @xmath66 , but for @xmath620 , the additional gain is small .",
    "this supports the argument from proposition [ prop : bound - on - value ] that imposing an upper bound on @xmath18 is not a severe restriction .",
    "c | c c c c c c c c c c @xmath66 & @xmath617 & @xmath621 & @xmath622 & @xmath623 & @xmath624 & @xmath625 + @xmath626 &     +    [ [ ii - gain - from - stochastic - filtering . ] ] ( ii ) gain from stochastic filtering .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we compare the optimal expected proceeds from liquidation in this setup to the expected proceeds in case that the trader ( mistakenly ) uses a model with deterministic @xmath88 and @xmath627 , @xmath628 , i.e.  she works with the stationary distribution of @xmath2 throughout . for @xmath629 , @xmath630 , the expected gain from the use of filtering",
    "is  @xmath631 . for @xmath632",
    "the effect becomes even stronger with  @xmath633 .",
    "this shows that the additional complexity of using filtering methods to learn about the state of the market may be worthwhile .",
    "[ [ iii - form - of - the - liquidation - strategy - for - varying - price - impact - parameters . ] ] ( iii ) form of the liquidation strategy for varying price impact parameters .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    throughout we fix @xmath629 , @xmath634 .",
    "first , we discuss the form of the liquidation rate for varying size of the temporary price impact , that is for varying @xmath635 and for @xmath103 as in table  [ tab : params ] ( moderate value of @xmath103 ) .",
    "figure [ fig : pi - cf ] shows the liquidation rate at @xmath636 for the cases of no , intermediate , and large temporary price impact as a function of @xmath243 and @xmath212 .",
    "the figure is a contour plot : white areas correspond to @xmath637 ; black areas correspond to selling at maximum speed ( @xmath638 ) ; grey areas correspond to selling at a moderate speed , see also the color bars below the graphs .",
    "we observe that the liquidation rate is decreasing in @xmath212 ( the probability that @xmath2 is in the good state ) and increasing in the inventory level .    comparing the graphs we see that for higher temporary price impact the trader tends to trade more evenly over the state space to keep the cost due to the temporary price impact small .",
    "note that for @xmath639 the liquidation strategy converges to a _ bang - bang type strategy_. the optimal policy is then characterized by two regions : a _ sell _ region , where the trader sells at the maximum speed , and a _ wait _ region , where she does not sell at all .",
    "( @xmath640-axis ) and @xmath212 ( @xmath641-axis ) for @xmath642 ( left ) , @xmath643 ( middle ) , and @xmath644 ( right ) and @xmath636 for example  [ exm2 ] .",
    "note the different scale in the graphs.,title=\"fig:\",scaledwidth=32.0%,height=139 ]   ( @xmath640-axis ) and @xmath212 ( @xmath641-axis ) for @xmath642 ( left ) , @xmath643 ( middle ) , and @xmath644 ( right ) and @xmath636 for example  [ exm2 ] .",
    "note the different scale in the graphs.,title=\"fig:\",scaledwidth=32.0%,height=139 ]   ( @xmath640-axis ) and @xmath212 ( @xmath641-axis ) for @xmath642 ( left ) , @xmath643 ( middle ) , and @xmath644 ( right ) and @xmath636 for example  [ exm2 ] .",
    "note the different scale in the graphs.,title=\"fig:\",scaledwidth=32.0%,height=139 ]    now we study the situation where the permanent price impact becomes large .",
    "the left plot in figure  [ fig : pi - a ] shows the sell and wait regions under partial information in dependence of the inventory level @xmath243 and the filter probability @xmath212 for @xmath645 , and ( essentially ) without temporary price impact . the sell region forms a band from low values of @xmath243 and @xmath212 to high values of @xmath243 and @xmath212 . in the presence of a temporary price impact ( right plot of figure  [ fig : pi - a ] ) the qualitative behaviour of the liquidation rate is similar to the case without temporary price impact , but the transition from waiting to selling at the maximum rate is smooth .",
    "( @xmath640-axis ) and @xmath212 ( @xmath641-axis ) for @xmath642 ( left ) and @xmath643 ( right ) for @xmath645 and @xmath636 for example  [ exm2].,title=\"fig : \" ]   ( @xmath640-axis ) and @xmath212 ( @xmath641-axis ) for @xmath642 ( left ) and @xmath643 ( right ) for @xmath645 and @xmath636 for example  [ exm2].,title=\"fig : \" ]    we offer the following interpretation .",
    "the qualitative behaviour of the liquidation rate is determined by an interplay of two effects .",
    "the _ price anticipation effect _ makes the trader ` wait ' in the good state where prices are increasing on average ( for @xmath646 ) , and ` sell ' in the bad state where prices are trending downward . on the other hand",
    ", there is a _",
    "liquidity effect_. in our model the permanent price impact is proportional to @xmath647 , which is small in the good state and large in the bad state .",
    "hence the trader has an incentive to sell in the good state and wait in the bad state to reduce the permanent price impact .",
    "as we see in figure  [ fig : pi - cf ] , for small values of @xmath103 the price anticipation effect dominates , explaining the observed monotonicity behaviour in @xmath212 . for large @xmath103 and large",
    "@xmath243 the liquidity effect dominates ( ` sell ' for @xmath212 close to one and ` wait ' for @xmath212 close to zero ) .",
    "the observation that for @xmath243 small the price anticipation effect dominates , whereas for @xmath243 large the liquidity effect dominates , is due to the fact that for small @xmath243 the trader can liquidate ( most of ) her inventory before the negative impact on the stock price materializes .",
    "for large @xmath243 on the other hand selling can be prohibitively expensive and the trader prefers to waits for better market conditions .",
    "this leads to an interesting feature for the case where @xmath243 is large and @xmath212 is small : there is a _ gambling region _ where the trader prefers to wait for better market liquidity , even if he is confronted with a downward - trending price .",
    "[ lemma : martingale - part - of - s ] suppose that assumption  [ ass1 ] holds .",
    "fix @xmath648 and consider some @xmath14-adapted strategy @xmath18 with values in @xmath135 $ ] . define @xmath649 \\times \\mathcal{e } \\times   [ 0 ,   m ] \\big \\}\\,.\\ ] ] then @xmath650 , @xmath651 , and @xmath652 is a true martingale .    to ease the notation we write @xmath653 for @xmath654 .",
    "we begin with the bound on @xmath655 .",
    "first note that @xmath656 is finite by assumption  [ ass1 ] . at a jump time @xmath222 of @xmath29",
    "it holds that @xmath657 and therefore @xmath658 hence @xmath659 and we get @xmath660 so that @xmath651 by the gronwall inequality . to show that @xmath661 is a true martingale",
    "we show that this process has integrable quadratic variation .",
    "since @xmath662_t = \\int_0^t \\int_\\r s_{s-}^2 z^2 \\mu^r({\\mathrm d}z , { \\mathrm d}s ) $ ] , we have @xmath663_t \\right ) = \\mathbb{e } \\left ( \\int_0^t s_{s}^2 \\int_\\r z^2 \\eta^\\p(s , y_{s- } , \\nu_{s-}{\\mathrm d}z ) { \\mathrm d}s\\right ) \\le",
    "s_0 ^ 2 \\tilde c \\int_0^t e^{c s } { \\mathrm d}s\\,,\\ ] ] for every @xmath53 $ ] , where @xmath664 , \\ e",
    "\\in \\mathcal{e } , \\nu \\in [ 0 ,   m ] \\big \\}$ ] is finite by assumption  [ ass1 ] .",
    "conditions   and imply that @xmath665 is a true martingale , see @xcite .",
    "moreover , @xmath666 , since @xmath667 by assumption .",
    "this implies that @xmath668 , and hence the equivalence of @xmath69 and @xmath70 .",
    "next we identify the @xmath69-compensator of @xmath45 .",
    "+ define the function @xmath669 \\times \\mathcal{e } \\times   [ { 0 } , { \\nu^{\\text{max } } } ] \\times e \\times \\r \\to ( -1 , \\infty ) $ ] by @xmath670 and note that the stochastic differential equation for @xmath671 can be written in the form @xmath672 the girsanov theorem for random measures ( see ( * ? ? ?",
    "* viii , theorem t10 ) ) shows that under @xmath69 , @xmath673 has the predictable compensator @xmath674 by definition of @xmath159 this is equal to @xmath675    conversely , in order to construct @xmath70 define the process @xmath676 by @xmath677 with initial condition @xmath678 .",
    "then @xmath223 $ ] is a true @xmath679 martingale and we may define a measure @xmath70 by @xmath680 .",
    "the girsanov theorem for random measures ensures that under @xmath70 , the measure @xmath673 has the predictable compensator @xmath681 . using the relation @xmath682 for every @xmath16 $ ] , it s formula for jump processes",
    "finally gives that @xmath683 .",
    "therefore , the two measure changes are inverse to each other .    in the sequel",
    "we want to prove theorem [ thm : zakai ] .",
    "for this we need the following result .",
    "[ lemma : cond - esp ] for @xmath16 $ ] let @xmath684 be an integrable @xmath685-measurable random variable and let @xmath686 .",
    "then @xmath687 .",
    "the proof is similar to the proof of ( * ? ? ?",
    "* proposition 3.15 ) . first note that for @xmath223 $ ] , @xmath688 , as the jumps of @xmath29 are greater than @xmath689 .",
    ". then @xmath691 . under the probability measure @xmath70",
    ", the @xmath692-algebra @xmath693 is independent of @xmath685 .",
    "this is a consequence of the fact that under @xmath70 , @xmath33 is a poisson random measure , and then @xmath29 has independent increments .",
    "therefore , since @xmath684 is @xmath685-measurable , we get that @xmath694 .",
    "our derivation is in line with the proof of ( * ? ? ?",
    "* theorem  3.24 ) for the classical case where the observation process is a brownian motion with drift .",
    "recall that for a function @xmath695 the semimartingale decomposition of @xmath696 is given by @xmath697 , where @xmath198 is a true @xmath199-martingale .",
    "define the process @xmath698}$ ] by @xmath699 and note that @xmath700 for every @xmath16 $ ] , i.e.  @xmath701 is a bounded process .",
    "it s formula gives that @xmath702 now we compute @xmath703 .",
    "notice that @xmath704_t = 0 $ ] for every @xmath16 $ ] , as @xmath29 and @xmath2 have no common jumps .",
    "hence , from it s product rule we get @xmath705    next we show that @xmath706 . by the definition of conditional expectation ,",
    "this is equivalent to @xmath707 for every bounded , @xmath708-measurable random variable @xmath538 .",
    "define an @xmath709-martingale by @xmath710 , @xmath711 , and note that @xmath712 . by the martingale representation theorem for random measures ,",
    "see , e.g. , ( * ? ? ?",
    "iii , theorem 4.37 ) or ( * ? ? ?",
    "viii , theorem t8 ) , we get that there is a bounded @xmath14-predictable random function @xmath571 such that @xmath713 \\,.\\ ] ] now , applying the it product rule and using that @xmath714_t = [ y , r]_t = 0 $ ] for every @xmath16 $ ] , we obtain @xmath715 both integrals on the right hand side of the above representation are martingales .",
    "this follows from the finite - state property of the markov chain @xmath2 and the boundedness of @xmath701 and @xmath538 .",
    "hence , taking the expectation we get that @xmath707 as claimed .    taking the conditional expectation from and applying lemma  [ lemma : cond - esp ] and the fubini theorem we get for every @xmath16 $ ] , @xmath716 note that",
    ", for every @xmath16 $ ] , @xmath717 and that @xmath718 is integrable .",
    "since @xmath159 is bounded by assumption , by dominated convergence we get the following three limits @xmath719    finally we consider the integral with respect to @xmath720 in .",
    "let @xmath721 be the sequence of jump times and the corresponding jump sizes of the process @xmath29 . denote by @xmath722 the number of jumps up to time @xmath79 , so that @xmath723 is the last jump time before @xmath79",
    ". then @xmath724 assembling the previous results we obtain @xmath725 and hence the claim of the theorem follows by lemma  [ lemma : cond - esp ] .",
    "in order to obtain the kushner - stratonovich equation we apply it s formula to compute the dynamics of @xmath726 . from theorem  [ thm : zakai ]",
    "we have @xmath727 and hence @xmath728 since @xmath729 , by the product rule we get @xmath730 the integrand above is equal to @xmath731 it follows from the definition of @xmath159 in that @xmath732 . making the necessary substitutions and cancellations we get the result .",
    "for the convenience of the reader we recall a few basics of mdms .",
    "our presentation is largely based on ( * ? ? ?",
    "* chapter  7 ) .    1 .   a _ stationary infinite horizon mdm _ consists of the data @xmath733 , where the borel set @xmath295 is the state space , the borel set @xmath345 is the set of control actions , @xmath734 is the reward function and @xmath735 is a transition kernel from @xmath736 $ ] .",
    "2 .   a _ control policy _",
    "@xmath737 is a sequence of mappings @xmath738 . if @xmath739 for all @xmath527 , then the policy @xmath740 is called _",
    "stationary_.    given a control policy @xmath740 and an initial state @xmath741 , one can construct a sequence @xmath742 of random variables with @xmath743 and @xmath744 the reward associated with the policy @xmath745 is then @xmath746,\\ ] ] and the value function is @xmath747 .    for @xmath748 and a measurable function @xmath749",
    "we define the function @xmath750 by @xmath751 the _ maximal reward operator _",
    "@xmath438 is then given by @xmath752 .",
    "dynamic programming suggests that @xmath343 is a solution of the so - called optimality equation @xmath753 . in theorem",
    "[ thm : optimality - general ] below we provide conditions which ensure that this is in fact true ; this theorem is a crucial tool for our analysis of the optimal liquidation problem via mdms in section  [ subsec : optimality - equation ] . to state the result",
    "we introduce several definitions .",
    "[ boundingf ] a function @xmath754 is called a _ bounding function _ for a mdm , if there are constants @xmath755 such that @xmath756 for all @xmath757 and @xmath758 . if moreover @xmath759",
    ", the mdm is _",
    "contracting_.    define the set of functions @xmath760 for some constant @xmath761 , and define for @xmath762 the norm @xmath763 .",
    "it is known that @xmath764 is a banach space . for @xmath765 , @xmath766 it holds that @xmath767 and hence also @xmath768 , see ( * ? ? ?",
    "* lemma 7.3.3 ) .",
    "in particular , the maximal reward operator is a contraction , if the mdm is contracting .",
    "the following result is essentially ( * ? ? ?",
    "* theorem 7.3.6 ) .",
    "[ thm : optimality - general ] suppose that the bounding function @xmath374 is continuous , @xmath759 , and the action space @xmath345 is compact .",
    "suppose moreover that    * @xmath769 is continuous for all @xmath762 that are continuous ; * @xmath770 is continuous .",
    "then the following assertions hold :    1 .",
    "the value function @xmath343 is continuous and lies in the set @xmath382 .",
    "2 .   @xmath753 , and @xmath343 is the unique fixed point of @xmath438 in @xmath382 .",
    "3 .   there exists an optimal strategy .",
    "more precisely , any stationary strategy @xmath432 with @xmath433 for every @xmath434 and @xmath771 is optimal .",
    "to establish the claim we show that the first derivatives of the vector field @xmath237 are bounded , uniformly in @xmath72 .",
    "the components of @xmath772 and @xmath773 are all 0 , and , using assumption [ ass1 ] , the nonzero components of @xmath774 , @xmath775 , can be estimated by @xmath776 for @xmath777 . for @xmath778",
    "we get @xmath779    to simplify notation , without loss of generality we set @xmath636 , we take the temporary price impact @xmath780 and we let @xmath781 .",
    "since @xmath117 , we get @xmath782 where we let @xmath783 . using the transition kernel @xmath330 of the sequence @xmath331",
    "we get that @xmath784 where the last equality follows from the fact that @xmath785 for @xmath786 and @xmath787 .",
    "first we estimate the reward function introduced in . since @xmath788 , @xmath789 , and @xmath790",
    ", we get with @xmath791 , @xmath792 using partial integration we get @xmath793_0^{\\tau^\\varphi } - \\int_0^{\\tau^\\varphi } \\lambda^\\alpha_u   e^{-\\lambda^{\\alpha}_u } w_u^\\alpha { \\mathrm d}u \\le w - e^{-\\lambda^{\\alpha}_{\\tau^\\phi } } w_{\\tau^\\phi}^\\alpha\\,.\\ ] ] substituting this into gives @xmath794 next we estimate @xmath795",
    ". define @xmath796 , e \\in \\mathcal{e } \\big\\}.$ ] it holds that @xmath797 where we have used that @xmath798 and @xmath799 . the last term is bounded by @xmath800 , and the mdm is contracting for @xmath801 .    the following lemma is needed in the proof of proposition  [ prop : continuity ] .",
    "[ lemma : continuity - of - ql ] consider a continuous function @xmath802 with @xmath803 . then for all @xmath347 the mapping @xmath804 is continuous on @xmath805 $ ] .",
    "consider a sequence with elements @xmath806 { } ( t , \\nu , \\pi)$ ] .",
    "note that , for sufficiently large @xmath527 , the set @xmath807 is contained in a compact subset @xmath808 \\subset ( 0 , \\infty)$ ] .",
    "moreover , @xmath486 is uniformly continuous on the compact set @xmath809 \\times [ 0 , w_0 ] \\times [ \\underline{s } , \\overline{s } ] \\times \\s^k \\times [ { 0 } , { \\nu^{\\text{max}}}]\\ , .",
    "$ ] then , assumption  [ ass2]-(2 ) implies that the sequence @xmath810 with @xmath811 converges uniformly in @xmath812 to @xmath813 .",
    "hence the following estimate holds : @xmath814 finally , the first term in can be estimated by @xmath815 , which converges to zero as @xmath816 converges to @xmath817 uniformly ; the second term in converges to zero by assumption  [ ass2]-(1 ) ( continuity of the mapping @xmath818 in the weak topology ) .",
    "@xcite introduced conditions under which a numerical scheme converges to the viscosity solution of an hjb equation .",
    "the conditions on the numerical scheme are _ consistency _ , which means that the difference operators converge to the differential operators , _ stability _ , which means that the finite difference operator stays bounded as the time and space steps converge to zero , and _ monotonicity _ , which means that the mapping @xmath819 from is monotone .",
    "moreover , a comparison principle for the limiting hjb equation needs to hold .    in the sequel we present the discretization scheme for example [ exm2 ] ,",
    "treated numerically in section [ sec : numerics ] , and verify the above conditions . for the discretization of the differential operators we use the standard difference scheme as stated in ( *",
    "* chapter ix ) . in order to satisfy the monotonicity condition we need to discretize the first order terms appropriately by using an upwinding scheme : depending on the sign of the coefficient",
    ", we use a forward or a backward difference operator . in example",
    "[ exm2 ] the integral w.r.t .",
    "@xmath88 reduces to a sum , which is evaluated by interpolation between the grid points .",
    "it is easier to verify the convergence conditions from @xcite for the hjb equation including @xmath244 as a state variable . from that , using the homogeneity of @xmath344 in @xmath244 , we obtain a convergence result for the reduced equation .",
    "let @xmath820 be the step - sizes in @xmath821-direction . in our computations",
    "we choose @xmath822 and @xmath823 . for fixed time point @xmath824",
    "we determine the control @xmath825 by maximizing @xmath538 , see .",
    "the discretized version of the hjb equation is @xmath826\\\\ & + ( t_{k+1}-t_k ) ( \\nu-{c_f}{\\varsigma}\\nu^{{\\varsigma}+1})s\\ , , \\end{aligned}\\ ] ] where @xmath827 on the active boundary we set @xmath828 . due to the use of an upwinding scheme , on the non - active part of the boundary the solution to is determined endogenously , i.e.  by the values of @xmath344 in the interior of the state space .",
    "note that this is in line with the formulation of the boundary conditions for the limiting equation in definition [ def : viscosity-1 ] .    by construction ,",
    "this scheme is consistent . in order to get stability , we need to choose the time step sufficiently small , namely @xmath829 .",
    "monotonicity requires positivity of the coefficients of the difference operators and suitable quadrature weights for the integral term ( for the latter see @xcite ) . in our context , this holds since @xmath830 are positive , and the coefficients of @xmath831 are positive by construction .",
    "( the construction we used is an easy implementable way of decomposing the coefficient @xmath832 into its positive and its negative part . ) hence , @xmath833 is also positive .",
    "since we also showed in theorem [ thm : viscosity ] that the comparison principle holds and that the value function is the unique viscosity solution to our hjb equation , we get convergence of the proposed scheme to the value function .",
    "n.  buerle and u.  rieder . optimal control of piecewise deterministic markov processes with finite time horizon . _ modern trends in controlled stochastic processes : theory and applications _ , 123:0 143 , 2010 .",
    "c.  damian , z.  eksi , and r.  frey .",
    "em algotithm for markov chains observed via gaussian noise and point process infrmation : theory and numerical experiments .",
    "_ working paper , ) institute for statistics and mathematics , wu vienna _ , 2017 .",
    "dempster and j.j . ye .",
    "necessary and sufficient optimality conditions for control of piecewise deterministic markov processes . _ stochastics : an international journal of probability and stochastic processes _ , 400 ( 3 - 4):0 125145 , 1992 .    g.  b. di  masi and w.  runggaldier . on approximation methods for nonlinear filtering . in _ nonlinear filtering and stochastic control _ , volume 972 of _ lecture - notes in mathematics _ , pages 249259 , berlin , 1982 .",
    "springer .",
    "r.  frey and w.  runggaldier . a nonlinear filtering approach to volatility estimation with a view towards high frequency data . _ international journal of theoretical and applied finance _ , 40 ( 2):0 199210 , 2001 .",
    "s.  lenhart and y.  liaot .",
    "integro - differential equations associated with optimal stopping time of a piecewise - deterministic process . _ stochastics : an international journal of probability and stochastic processes _ , 150 ( 3):0 183207 , 1985 ."
  ],
  "abstract_text": [
    "<S> we study the problem of a trader who wants to maximize the expected revenue from liquidating a given stock position . </S>",
    "<S> we model the stock price dynamics as a geometric pure jump process with local characteristics driven by an unobservable finite - state markov chain and by the liquidation rate . </S>",
    "<S> this reflects uncertainty about activity of other traders and feedback effects from trading . </S>",
    "<S> we use stochastic filtering to reduce the optimization problem under partial information to an equivalent one under complete information . </S>",
    "<S> this leads to a control problem for piecewise deterministic markov processes ( pdmps ) . </S>",
    "<S> we apply control theory for pdmps to our problem . in particular </S>",
    "<S> , we derive the optimality equation for the value function , we characterize the value function as viscosity solution of the associated dynamic programming equation , and we prove a novel comparison result . </S>",
    "<S> the paper concludes with a detailed analysis of a specific example . </S>",
    "<S> we present numerical results illustrating the impact of partial information and feedback effects on the value function and on the optimal liquidation rate . </S>"
  ]
}