{
  "article_text": [
    "observations of the cosmic microwave background ( cmb ) provide a direct image of the early universe @xcite , and have revolutionized our understanding of the composition and evolution of the universe as a whole @xcite .",
    "the new insights derive primarily from heroic community - wide efforts in microwave instrumentation , leading to steadily improved detector performance and noise levels .",
    "however , with improved data sets follow more stringent requirements on analysis techniques , and optimal statistical cmb analysis has become a rich scientific field in its own right during the last 20 years .",
    "one branch of this community - wide effort has revolved around optimal exploration of the full joint cmb posterior , and among the most successful of such methods is the cmb gibbs sampler .",
    "this framework , which was originally introduced by @xcite , has proved particularly powerful because of its ability to seamlessly and jointly account for astrophysical and instrumental nuisance parameters together with the primary cmb parameters , and thereby both mitigating and propagating systematic uncertainties in final science results .",
    "this method has already been applied successfully to evaluation of power spectrum for @xcite , @xcite and @xcite , and it has played a central role in separation of astrophysical components for  @xcite .    by virtue of being a gibbs sampler ,",
    "this overall method consists of a series of iterated conditional markov chain moves , in which one or more parameters are changed at a time , leaving all other parameters fixed .",
    "each conditional parameter move is usually fairly simple , and always associated with a well - established sampling algorithm .",
    "for instance , the conditional distribution of the cmb power spectrum is an inverse wishart distribution , that of the cmb sky map conditional distribution is a multivariate gaussian @xcite , while astrophysical foreground conditionals can usually be described in terms of some fairly simple @xmath3 evaluations @xcite .",
    "still , the computational cost per sample is certainly non - trivial , with the primary cost being driven by the multivariate gaussian sky distribution , and can easily amount to several cpu hours per sample , requiring more advanced algorithmic treatment @xcite .    in this paper , we revisit the problem of estimation of cosmological parameters and the cmb power spectrum within the gibbs sampling framework , with the goal of establishing an efficient algorithm in both high and low signal - to - noise regimes , and thereby reducing the overall computational cost of the method .",
    "the same problem has been discussed and addressed repeatedly in the literature already ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , but no definitive and general solution has been presented until now . in sect .",
    "[ sec : motivation ] we present the intuition behind our new algorithm , and we compare the new approach to existing sampling schemes . then , in sect .",
    "[ sec : algo ] we formalize the algorithm in standard mathematical notation , before testing it on simplified simulations in sect .",
    "[ sec : application ] .",
    "we conclude in sect .",
    "[ sec : concl ] .",
    "as noted already by @xcite , the most severe complication for estimation of the cmb power spectrum and cosmological parameters with the gibbs sampling framework concerns the relationship between effective signal - to - noise ratio and markov chain correlation length : while the width of the full power spectrum posterior is given by both cosmic variance and instrumental noise , the step size of the markov chain power spectrum in the default algorithm @xcite is given by cosmic variance alone .",
    "this problem is illustrated in the top two panels of fig .",
    "[ fig : sketches ] .",
    "each move ( illustrated by black arrows for sky map parameters and colored for power spectrum parameters ) affects only one parameter at a time .",
    "each arrow therefore points parallel to either coordinate axis . in the high signal - to - noise regime (",
    "top left panel ) , the sky signal is highly constrained , and the corresponding marginal posterior is very narrow . the power spectrum marginal , however , still has significant uncertainty due to cosmic variance , even if the noise contribution is small .",
    "however , since the sky map distribution essentially converges to a delta function with increasing signal - to - noise ratio , the joint distribution is nearly uncorrelated between the two directions , and pure gibbs steps ( defined by a gaussian distribution in the vertical direction and an inverse wishart distribution in the horizontal direction ) are able to navigate the full posterior efficiently .    in the low signal - to - noise regime ( top right panel ) , this is no longer true . in this case , there is significant uncertainty in the true sky signal , and _ for each sky map value _ the power spectrum conditional follows an inverse wishart distribution centered on a value given by the sky map .",
    "the joint distribution therefore becomes highly degenerate .",
    "to move from one end of the joint distribution to the other , a very large number of orthogonal moves are thus required .",
    "such degeneracies are a well - known problem for the gibbs sampling algorithm in general .    this problem was first identified and studied by @xcite , and a first proper attempt at solving it was subsequently presented by @xcite .",
    "they introduced a new type of joint markov chain move that consists of three steps .",
    "first , one proposes an arbitrary change to the power spectrum , @xmath4 , where @xmath5 is some proposal rule .",
    "second , one rescales the corresponding sky map , @xmath6 , where @xmath7 is the signal - only covariance matrix .",
    "this rescaling operation leaves the quantity @xmath8 invariant , and one can show that any determinant factors in the corresponding metropolis - hastings accept probability cancel , and the final accept ratio is given by @xmath3 s only @xcite .",
    "the third and final step is therefore to evaluate this accept probability , and apply the metropolis - hastings rule .",
    "intuitively , this algorithm corresponds to diagonal moves in fig .",
    "[ fig : sketches ] , as illustrated in the bottom two panels . with an accept rate given by @xmath3 s alone , this kind of move works very well in the low signal - to - noise regime ( bottom right panel ) , since the effective @xmath3 does not change appreciably when changing the amplitude of the map .",
    "however , in the high signal - to - noise regime the @xmath3 becomes sensitive to the _ phase information _ in the sky map , and large map rescaling factors are generally associated with very low accept probabilities ; only very short moves are allowed in order to stay within the acceptable region .    in the present paper",
    "we solve this problem by introducing a small but critical variation of the previous scheme .",
    "first , as detailed by @xcite and @xcite , we note that the sky signal map may be decomposed into the sum of a wiener filter component , @xmath9 , and a fluctuation term , @xmath10 , in the form @xmath11 . the high signal - to - noise information is contained in @xmath9 , while the noise - dominated component is described by @xmath10 .",
    "exploiting the intuition described above , we now note that the optimal markov chain move should leave @xmath9 invariant , and rescale only @xmath10 by the power spectrum .",
    "specifically , we introduce a partially rescaled proposal rule in the following form : @xmath12 where @xmath13 is the wiener filtered sky map evaluated with @xmath14 .",
    "this new move is contrasted to the previous joint sampler in the bottom two panels of fig .",
    "[ fig : sketches ] in terms of yellow versus blue arrows . in the low signal - to - noise regime ( right panel ) , the two perform nearly identically , since @xmath15 .",
    "however , they perform very differently in the high signal - to - noise regime : since @xmath10 is very small in the signal - dominated regime , only small changes are proposed to @xmath16 in the new scheme , maintaining a high net accept rate .",
    "in this section , we first define necessary notation and review previous cmb gibbs sampling algorithms , before formalizing the intuition described above into a well - defined and operational algorithm .",
    "the technical derivation of the metropolis - hastings accept probability is deferred to the appendix  [ app : accrate ] .",
    "let us start by considering a data model of the form @xmath17 where @xmath18 denotes a data vector in pixel space ; @xmath19 represents convolution with an instrumental beam , usually represented by a legendre transform @xmath20 ; @xmath21 is a gaussian signal with covariance @xmath22 ; and @xmath23 denotes gaussian instrumental noise with covariance @xmath24 .",
    "we further assume that the signal @xmath21 is statistically isotropic , and define its power spectrum as @xmath25 , where @xmath26 .",
    "the signal covariance matrix is then given as @xmath27 .",
    "the overall goal of this paper is to characterize the marginal power spectrum posterior @xmath28 somehow . in the literature , this is conventionally done in several different ways , for instance by adopting either single-@xmath29 or binned estimates of the power spectrum . while the algorithm presented here certainly is suitable for such parameterizations as well , we will in the following instead focus directly on cosmological parameters , which are the ultimate goal of any cmb experiment .",
    "furthermore , adopting a high - level parametrization that depends on both low and high multipoles ( and therefore both high and low signal - to - noise regimes ) puts maximum pressure on the algorithm itself .",
    "note that this method is also naturally suitable for sampling power spectrum coefficients , @xmath30 , which can be useful to reveal features or anomalies in the data .    for convenience ,",
    "we adopt a standard six - parameter @xmath31cdm model in the following , with baryon density @xmath32 , cold dark matter density @xmath33 , optical depth at reionization @xmath34 , amplitude and tilt of the primordial fluctuations @xmath35 and @xmath36 , and the hubble parameter @xmath37 as free parameters . to evaluate corresponding power spectra",
    ", we employ camb=10000 @xcite . in the rest of the paper",
    ", we will denote this vector of parameters as @xmath38 .",
    "thus , our goal is to map out @xmath39 .",
    "to do so , we use bayes theorem to write the joint density @xmath40 as @xmath41 for clarity , we have dropped the dependence of @xmath22 on @xmath38 , as well as any factor of @xmath42 .",
    "optional priors on @xmath38 are described by @xmath43 , and from now on we will neglect the overall normalization factor , @xmath44 , often called the evidence .",
    "we note that our target distribution is obtained by marginalizing the joint distribution over @xmath21 , @xmath45      to recap , the basic idea behind gibbs sampling is to draw a sample from the joint posterior @xmath46 by iteratively sampling from the corresponding conditional probabilities , @xmath47 as discussed by @xcite and @xcite , the former of these distributions may be recognized as a standard multivariate gaussian by rewriting the exponent in eq .",
    "[ jointpdf ] as follows : @xmath48 where we defined the mean - field map @xmath49 . given this expression , we sample the sky signal according to @xmath50 where @xmath51 is a gaussian multivariate , with a mean vector @xmath52 and a covariance @xmath53 .",
    "specifically , we generate two random vectors , @xmath54 and @xmath55 , drawn from @xmath56 , and solve the equation @xmath57 \\boldsymbol{s } = \\rm{\\bold{a}}\\rm{\\bold{n}}^{-1 } \\boldsymbol{d } + \\rm{\\bold{s}}^{-\\frac{1}{2 } } \\boldsymbol{\\omega_0}+\\rm{\\bold{a}}\\rm{\\bold{n}}^{-\\frac{1}{2 } }   \\boldsymbol{\\omega_1}.\\ ] ]    solving eq .",
    "[ sampling_eq ] in the context of a realistic experiment with anisotropic noise and non - trivial masks can be computationally expensive @xcite .",
    "however , this is a purely computational problem of algebraic nature , and fully independent of questions regarding monte carlo correlation lengths and signal - to - noise levels . in this paper",
    ", we therefore circumvent this problem entirely , and consider only an ideal data set in the harmonic domain with uniform noise and full sky coverage . in this particular case",
    ", the noise matrix may be described by a noise power spectrum , @xmath58 , and eq .",
    "[ sampling_eq ] may be solved directly in harmonic space at negligible computational cost : @xmath59    finally , the second conditional distribution in eq .",
    "[ eq : gibbs ] reduces to an inverse wishart distribution with a well - known sampling algorithm .",
    "this particular sampling step , however , will not be needed for the purposes of the current paper , and we therefore refer the interested reader to the referenced papers for further details .      adopting the above notation , @xcite introduced the following joint sampling step to mitigate the slow convergence rate discussed in sect .",
    "[ sec : motivation ] in the low signal - to - noise regime : @xmath60 where @xmath61 denotes a random fluctuation drawn from a normal distribution with zero mean and variance given by the sum of cosmic variance and instrumental noise .",
    "they then showed that the corresponding metropolis - hastings accept probability for such a joint move reduced to the ratio of exponentiated @xmath3 s , @xmath62 although efficient in the low signal - to - noise regime , this particular move performs very poorly in the high signal - to - noise regime .    to solve this , we propose in this paper a slight  but critical variation of the above scheme , as discussed in sect .",
    "[ sec : motivation ] . specifically , rather than rescaling the full signal map",
    ", we propose to rescale only the fluctuation component , such that @xmath63 or written in terms of @xmath64 as in eq .",
    "[ eq : rescale ] , @xmath65 again , the underlying intuition behind this proposal is to leave the high signal - to - noise component of the sky signal invariant , and modify only the low signal - to - noise component , to which the total @xmath3 is largely insensitive .",
    "lcccccc[t ] new joint sampler & 0.02241 @xmath66 0.00035 & 0.1180 @xmath66 0.0029 & 0.067 @xmath66 0.019 & 3.063 @xmath66 0.037 & 0.972 @xmath66 0.01 & 68.2 @xmath66 1.5 + exact posterior & 0.02241 @xmath66 0.00035 & 0.1180 @xmath66 0.0029 & 0.068 @xmath66 0.019 & 3.063 @xmath66 0.038 & 0.972 @xmath66 0.01 & 68.2 @xmath66 1.5 + posterior mean bias @xmath67 $ ] & -0.002 & -0.002 & -0.005 & -0.006 & -0.001 & 0.003 + posterior rms bias ( % ) & 0.0 & 0.0 & 3.2 & 3.1 & 0.0 & 0.1    we derive",
    "the metropolis - hastings accept rate for this new proposal in the appendix  [ app : accrate ] , and find it to be given by @xmath68,\\ ] ] where @xmath69 and @xmath70 denotes the proposal distribution for @xmath38 in eq .",
    "[ eq : parprop ] .",
    "note that , for clarity , we dropped the @xmath71 dependence of @xmath72 , @xmath73 , and @xmath74 in the above expression .",
    "the proposal rule @xmath75 is in principle arbitrary .",
    "however , as for standard cosmological parameter estimation , as implemented for instance in cosmomc @xcite , overall faster convergence is achieved when adopting a proposal rule that is close to the underlying marginal posterior distribution .",
    "following cosmomc and other samplers , we therefore adopt a multivariate gaussian for @xmath75 of the form : @xmath76 with a covariance matrix derived by some earlier analysis .",
    "( if no such earlier analysis is available , we generate a short chain with a diagonal covariance matrix , and compute a first covariance matrix from that run . )    as in the case of the original method introduced by @xcite , the sampling step introduced above explores by itself only a very limited subspace of the full volume of the sky signal posterior , namely that spanned by a single amplitude rescaling . to explore the full posterior volume",
    ", this step must therefore be interleaved with a standard gibbs step , as described in eq .",
    "[ eq : mapmaking ] .",
    "overall , the full sampler therefore works as follows :    1 .",
    "propose some initial parameter vector @xmath77 , and generate a power spectrum @xmath78 with camb .",
    "solve eqs .   and to obtain the mean - field map @xmath79 and the fluctuation map @xmath80 .",
    "2 .   propose a new parameter vector @xmath81 according to the proposal rule @xmath75 , and compute the corresponding power spectrum @xmath82 .",
    "3 .   compute the deterministically rescaled fluctuation map @xmath83 , and evaluate the accept probability according to eq .  ; accept or reject the proposal according to the usual metropolis - hastings rule .",
    "4 .   given the most recent parameter sample , make a standard conditional gibbs step for the sky map , according to eq .",
    "[ eq : mapmaking ] , computing both the mean - field and fluctuation maps .",
    "iterate 24 .      to validate and benchmark our new sampling scheme , we compare it to a case for which we can evaluate the exact posterior at negligible cost , namely a data set with uniform noise and full sky coverage . in this case",
    ", the exact marginal parameter posterior , @xmath84 , reads @xmath85 to map out this distribution , we use a standard metropolis sampler with the same proposal distribution , @xmath75 , as for the joint gibbs sampler .",
    "to validate and benchmark our method , we now apply it to a simplified simulation generated as follows . we draw a random gaussian cmb sky realization from the planck 2015 best - fit @xmath31cdm power spectrum ( tt + lowp ; @xcite ) , and convolve this with a @xmath86 fwhm gaussian beam .",
    "finally , we add white noise with a power spectrum amplitude of @xmath87 .",
    "both the beam and noise level are chosen to mimic wmap , in order to probe both the high and low signal - to - noise regimes within our effective multipole range . to be specific ,",
    "with these parameter choices we find a signal - to - noise ratio per multipole of unity at @xmath88 .",
    "next , since we consider only temperature observations in the following , our constraints on @xmath34 are very loose . to produce more realistic results",
    ", we therefore additionally impose an informative prior of @xmath89 .    as our first proposal matrix",
    ", we adopt the covariance matrix obtained from the  2015 _ tt+lowp _ markov chains , which are publicly available from the  legacy archive .",
    "however , due to its higher signal - to - noise ratio and different effective sky realization , this proposal distribution is quite poor .",
    "we therefore first generate a set of chains with 50k samples each , and compute the parameter covariance from the latter 40k samples .",
    "we additionally rescale the resulting distribution by @xmath90 , as proposed in @xcite , for further optimization . based on this proposal",
    ", we run 40 chains with 30k samples each , for both the new joint sampler and the exact sampler .",
    "after conservatively removing burn - in , we retain a total of 1 m samples for analysis . note that this is far more than is strictly required , but since each sample is cheap , and our primary concerns here are of algorithmic nature , optimization of chain lengths is not an issue .",
    "we first consider the overall efficiency of the algorithm , as measured in terms of markov chain correlation lengths .",
    "these are shown in fig .",
    "[ fig : autocor ] for each of the six cosmological parameters , and for both the new ( dashed ) and the exact ( dotted ) samplers .",
    "overall , we see that the correlation lengths for the new sampler are roughly twice as long as than for the standard sampler , which translates into a computational cost roughly double that of standard samplers . for comparison",
    ", we typically find a correlation length of roughly 3050 with cosmomc .",
    "thus , the new sampler performs similarly to existing samplers in terms of overall correlation length , within a very small factor .",
    "this has never before been achieved within the cmb gibbs sampling framework .",
    "next , in fig .",
    "[ fig : triangles ] we compare the 1d and 2d marginal distributions derived using the two samplers . at least at a visual level ,",
    "all distributions agree very well .",
    "this agreement is quantified in table  [ table : stat ] in terms of posterior mean and standard deviations for each of the two methods , and the relative difference between the two .",
    "we find that the posterior means are identical up to a few thousandths of a @xmath91 , while somewhat larger differences are observed for the posterior standard deviation  up to 3% for @xmath34 and @xmath35 .",
    "the cause of this small discrepancy is still under investigation , although we observe that it vanishes if we loosen or remove the prior on @xmath34 .",
    "it is thus not an intrinsic feature of the method as such , but rather related to the use of external priors .",
    "since most applications of this type are anyway made without such external priors , and the difference is in either case very small , we defer further discussion and resolution of the issue to a future publication .",
    "we have introduced a new sampling step for exploring the joint cmb sky signal and power spectrum posterior that is suitable for both high and low signal - to - noise regimes .",
    "this new step is very closely related to an already introduced rescaling algorithm @xcite , but with a very important difference : rather than rescaling the entire sky signal in each iteration , we now propose to rescale only the component with low signal - to - noise fluctuations . as a result ,",
    "high metropolis - hastings accept rates are maintained even in the high signal - to - noise regime .",
    "our focus in this paper has been on purely statistical - algorithmic aspects of the method , not real - world applications . to make the algorithm useful for such",
    ", it needs to be combined with state - of - the - art constrained realization samplers @xcite , in order to solve the computationally expensive map - making step efficiently .",
    "once that task has been completed , it will finally be possible to go from raw sky maps to cosmological parameters without the use of any likelihood approximations whatsoever .",
    "in addition , full physical marginalization over astrophysical foreground contamination will be straightforward @xcite .",
    "finally , we note that while we have considered only cmb temperature analysis in the current paper , the method generalizes naturally to all other fields that employ joint gibbs sampling as their basic algorithm .",
    "three specific examples include cmb polarization analysis @xcite , large - scale structure analysis @xcite , and weak lensing analysis @xcite .",
    "b.r . and h.k.e .",
    "thank charles lawrence and the jet propulsion laboratory ( jpl ) for their hospitality during the summer 2015 , where this project was initiated .",
    "we acknowledge the use of the camb and healpix @xcite software packages .",
    "b.r . acknowledges funding from the research council of norway .",
    "this project was supported by the erc starting grant stg2010 - 257080 .",
    "part of the research was carried out at the jet propulsion laboratory , california institute of technology , under a contract with nasa .",
    "99 alsing , j. , heavens , a. , jaffe , a.  h. , et al .",
    "2016 , , 455 , 4452 bennett , c.  l. , larson , d. , weiland , j.  l. , et al .",
    "2013 , , 208 , 20 dunkley , j. , bucher , m. , ferreira , p.  g. , moodley , k. , & skordis , c.  2005 , , 356 , 925 eriksen , h.  k. , odwyer , i.  j. , jewell , j.  b. , et al .",
    "2004 , , 155 , 227 eriksen , h.  k. , huey , g. , banday , a.  j. , et al .",
    "2007 , , 665 , l1 eriksen , h.  k. , jewell , j.  b. , dickinson , c. , et al .",
    "2008 , , 676 , 10 grski , k.  m. , hivon , e. , banday , a.  j. , et al .",
    "2005 , , 622 , 759 hinshaw , g. , larson , d. , komatsu , e. , et al .",
    "2013 , , 208 , 19 jasche , j. , & wandelt , b.  d.  2013 , , 779 , 15 jewell , j. , levin , s. , & anderson , c.  h.  2004 , , 609 , 1 jewell , j.  b. , eriksen , h.  k. , wandelt , b.  d. , et al .",
    "2009 , , 697 , 258 larson , d.  l. , eriksen , h.  k. , wandelt , b.  d. , et al .",
    "2007 , , 656 , 653 lewis , a. , challinor , a. , & lasenby , a.  2000 , , 538 , 473 lewis , a. , & bridle , s.  2002 , , 66 , 103511 planck collaboration 2015 , arxiv:1502.01582 planck collaboration 2015 , arxiv:1502.05956 planck collaboration 2015 , arxiv:1502.01588 planck collaboration 2015 , arxiv:1507.02704 planck collaboration 2015 , arxiv:1502.01589 seljebotn , d.  s. , mardal , k .- a . , jewell , j.  b. , eriksen , h.  k. , & bull , p.  2014",
    ", , 210 , 24 jasche , j. , & lavaux , g.  2015 , , 447 , 1204 wandelt , b.  d. , larson , d.  l. , & lakshminarayanan , a.  2004 , , 70 , 083511",
    "we first assume joint proposals for _ both _ cmb maps and parameters of the form @xmath94 in words , we first generate a proposal for cosmological parameters possibly dependent on the current state of the mcmc chain , followed by a proposal for a new cmb map given the current and proposed parameters @xmath95 and @xmath71 respectively , the current cmb map , and the data ( in the numerical examples presented in this paper , a _",
    "proposal for the parameters was used for them , but we proceed with the general case for now ) .    for the proposal for the new map @xmath96 , we consider variations about the new _ mean - field map _ @xmath97 ( note that the mean - field map is a function of information conditioned on when proposing @xmath96 , specifically @xmath71 and the data @xmath18 ) .",
    "we consider , for some linear filter @xmath98 , general proposals of the form @xmath99 with @xmath100 gaussian - distributed with unit variance and @xmath101 a scaling factor controlling its variance .",
    "our family of proposals for @xmath102 is therefore @xmath103 we take the limit @xmath104 , which reduces to a @xmath105-function for the map about the _",
    "proposal @xmath106   ( \\boldsymbol{s}^{i } -   \\boldsymbol { { \\hat s}}^{i } ) \\right].\\end{aligned}\\ ] ] finally , we focus on one choice of filter ( used for the numerical results in this paper ) : @xmath107 ( see the discussion below for a generalization of this choice of filter and its impact on the mcmc algorithm ) . to satisfy detailed balance , note that we must have @xmath108   ( \\boldsymbol{s}^{i+1 } -   \\boldsymbol { { \\hat s}}^{i+1 } ) , \\end{aligned}\\ ] ] which means that the filter must satisfy @xmath109 ( which it does , as can be readily verified ) .",
    "as reviewed in @xcite , stationary mcmc transition matrices can be constructed by demanding _ detailed balance _ , from which the probabilistic rule of accepting or rejecting proposed changes in @xmath110 can be derived .",
    "we will require that the probability of _ rejecting a proposed move when starting from state @xmath111 _ is equal to the probability of _ accepting a transition to the state @xmath111 from some other state _ @xmath112 \\ \\delta [ (   \\boldsymbol{s}^{1 } - \\boldsymbol { { \\hat s}}^{1 } ) - { \\bf f}(\\theta^{1 } , \\theta^{2 } ) ( \\boldsymbol{s}^{2 } - \\boldsymbol { { \\hat s}}^{2 } ) ] \\ w(\\theta^{1 } | \\theta^{2 } ,   \\boldsymbol{s}^{2 } , \\boldsymbol{d } ) \\right ] p(\\theta^{2 } ,   \\boldsymbol{s}^{2 } | \\boldsymbol{d } ) \\nonumber \\\\ \\mbox{prob . of acc .",
    "} & = &    \\left [ \\int d ( \\boldsymbol{s}^{1 } , \\theta^{1 } ) \\ a [ \\theta^{2 } ,   \\boldsymbol{s}^{2 } | \\theta^{1 } ,   \\boldsymbol{s}^{1 } ] \\",
    "\\delta [ (   \\boldsymbol{s}^{2 } - \\boldsymbol { { \\hat s}}^{2 } ) - { \\bf f}(\\theta^{2 } , \\theta^{1 } ) ( \\boldsymbol{s}^{1 } - \\boldsymbol { { \\hat s}}^{1 } ) ] \\",
    "w(\\theta^{2 } |   \\theta^{1 } ,   \\boldsymbol{s}^{1},\\boldsymbol{d } ) \\right ] p(\\theta^{1 } ,   \\boldsymbol{s}^{1 } | \\boldsymbol{d } ) .\\end{aligned}\\ ] ] the integration over the @xmath105-function in the latter term is equivalent to @xmath113 \\   \\frac { \\delta [ (   \\boldsymbol{s}^{1 } - \\boldsymbol { { \\hat s}}^{1 } ) - { \\bf f}(\\theta^{1 } , \\theta^{2 } ) ( \\boldsymbol{s}^{2 } - \\boldsymbol { { \\hat s}}^{2 } ) ] } { | { \\bf f}(\\theta^{2 } , \\theta^{1 } ) | } w(\\theta^{2 } |   \\theta^{1 } ,   \\boldsymbol{s}^{1},\\boldsymbol{d } ) \\right ] p(\\theta^{1 } ,   \\boldsymbol{s}^{1 } | \\boldsymbol{d})\\end{aligned}\\ ] ] where we explicitly note that @xmath114 and where the last line follows from @xmath115 . in order to have the two integrals for the reject and accept probabilities",
    "be equal , we can demand that in detail the accept probability satisfies @xmath116   & = &   a [ \\theta^{2 } ,   \\boldsymbol{s}^{2 } | \\theta^{1 } ,   \\boldsymbol{s}^{1 } ] \\",
    "\\left ( \\frac{1 } { | { \\bf f}(\\theta^{2 } , \\theta^{1 } ) | } \\right ) w(\\theta^{2 } | \\theta^{1 } ,   \\boldsymbol{s}^{1 } , \\boldsymbol{d } )   p(\\theta^{1 } ,   \\boldsymbol{s}^{1 } | \\boldsymbol{d } ) , \\end{aligned}\\ ] ] which equivalently leads to the usual rule @xmath117 $ ] with the ratio defined as @xmath118 explicitly substituting the form of the joint posterior @xmath119 , and using the fact that @xmath120 , we have @xmath121 - \\frac{1}{2 }   \\boldsymbol { { \\hat s}}^{2 } \\rm{\\bold{s}}^{-1}(\\theta^{2 } )    \\boldsymbol { { \\hat s}}^{2 } } } {   e^{- \\frac{1}{2 } \\chi^{2 } [   \\boldsymbol { { \\hat s}}^{1 } ] - \\frac{1}{2 }   \\boldsymbol { { \\hat s}}^{1 } \\rm{\\bold{s}}^{-1}(\\theta^{1 } )    \\boldsymbol { { \\hat s}}^{1 } } } \\right ) \\left ( \\frac{e^{- \\frac{1}{2 } \\boldsymbol{{\\hat f}}^{2 } \\rm{\\bold{a}}^{t } \\rm{\\bold{n}}^{-1 } \\rm{\\bold{a } } \\boldsymbol{{\\hat f}}^{2}}}{e^{- \\frac{1}{2 } \\boldsymbol{{\\hat f}}^{1 } \\rm{\\bold{a}}^{t } \\rm{\\bold{n}}^{-1 } \\rm{\\bold{a } } \\boldsymbol{{\\hat f}}^{1 } } } \\right ) \\left ( \\frac{w(\\theta^{1 } | \\theta^{2 } ,   \\boldsymbol{s}^{2 } , \\boldsymbol{d})}{w(\\theta^{2 } | \\theta^{1 } ,   \\boldsymbol{s}^{1 } , \\boldsymbol{d } ) } \\right),\\end{aligned}\\ ] ] where @xmath122 = ( \\boldsymbol{d } - \\rm{\\bold{a } } \\boldsymbol { { \\hat s}})^t \\rm{\\bold{n}}^{-1 } ( \\boldsymbol{d } - \\rm{\\bold{a } } \\boldsymbol { { \\hat s } } ) $ ] . above and",
    "from now on , we drop the @xmath123 notation for the transpose vectors . for the choice of a parameter proposal matrix that is _ independent of the cmb map and data and symmetric _ ( for example @xmath124 ) the ratio of parameter proposals drops out and we are left with @xmath121 - \\frac{1}{2 }   \\boldsymbol { { \\hat s}}^{2 } \\rm{\\bold{s}}^{-1}(\\theta^{2 } )    \\boldsymbol { { \\hat s}}^{2 } } } {   e^{- \\frac{1}{2 } \\chi^{2 } [   \\boldsymbol { { \\hat s}}^{1 } ] - \\frac{1}{2 }   \\boldsymbol { { \\hat s}}^{1 } \\rm{\\bold{s}}^{-1}(\\theta^{1 } )    \\boldsymbol { { \\hat s}}^{1 } } } \\right ) \\left ( \\frac{e^{- \\frac{1}{2 } \\boldsymbol{{\\hat f}}^{2 } \\rm{\\bold{a}}^{t } \\rm{\\bold{n}}^{-1 } \\rm{\\bold{a } } \\boldsymbol{{\\hat f}}^{2}}}{e^{- \\frac{1}{2 } \\boldsymbol{{\\hat f}}^{1 } \\rm{\\bold{a}}^{t } \\rm{\\bold{n}}^{-1 } \\rm{\\bold{a } } \\boldsymbol{{\\hat f}}^{1 } } } \\right).\\end{aligned}\\ ] ]    [ [ generalization - to - unity - accept - transitions - vs .- computational - expense ] ] generalization to unity accept transitions vs. computational expense ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~      we look for a filtering operation @xmath98 that leaves invariant @xmath125 we can therefore set @xmath126 this has the desired invariance of the fluctuation map , as well as satisfying the condition required for detailed balance , @xmath127 .",
    "the determinant factor appearing in the ratio for the accept probability is @xmath128 ( with generalizations for the case when @xmath129 is singular ) .",
    "the significance of the above is the following - everything in the accept probability ratio @xmath130 cancels if the proposals for the cosmological parameters are from the `` exact '' form as discussed in this paper .",
    "while it may appear somewhat paradoxical to consider _ proposals _ in cosmological parameters from the exact posterior marginal ( therefore making mcmc unnecessary ) , the idea provides insight into the correctness of the algorithm as well as intuition if _ approximations to the inverse noise _ can be made . a well - known approximation to the functional form of the likelihood in cmb analysis",
    "has been to take only the diagonal elements in a spherical harmonic basis .",
    "the above comments simply show that in the limit that approximations to the noise converge to the true instrument noise ( and we can generate proposals to parameters from the approximate posterior ) we will have high accept probabilities ."
  ],
  "abstract_text": [
    "<S> we propose an efficient bayesian markov chain monte carlo ( mcmc ) algorithm for estimating cosmological parameters from cosmic microwave background ( cmb ) data without the use of likelihood approximations . </S>",
    "<S> it builds on a previously developed gibbs sampling framework that allows for exploration of the joint cmb sky signal and power spectrum posterior , @xmath0 , and addresses a long - standing problem of efficient parameter estimation simultaneously in regimes of high and low signal - to - noise ratio . to achieve this , </S>",
    "<S> our new algorithm introduces a joint markov chain move in which both the signal map and power spectrum are synchronously modified , by rescaling the map according to the proposed power spectrum before evaluating the metropolis - hastings accept probability . </S>",
    "<S> such a move was already introduced by jewell et al .  </S>",
    "<S> ( 2009 ) , who used it to explore low signal - to - noise posteriors . </S>",
    "<S> however , they also found that the same algorithm is inefficient in the high signal - to - noise regime , since a brute - force rescaling operation does not account for phase information . </S>",
    "<S> this problem is mitigated in the new algorithm by subtracting the wiener filter mean field from the proposed map prior to rescaling , leaving high signal - to - noise information invariant in the joint step , and effectively only rescaling the low signal - to - noise component . to explore the full posterior , </S>",
    "<S> the new joint move is then interleaved with a standard conditional gibbs move for sky map . </S>",
    "<S> we apply our new algorithm to simplified simulations for which we can evaluate the exact posterior to study both its accuracy and its performance , and find good agreement with the exact posterior ; marginal means agree to @xmath1 and standard deviations to better than @xmath23% . </S>",
    "<S> the markov chain correlation length is of the same order of magnitude as those obtained by other standard samplers in the field . </S>"
  ]
}