{
  "article_text": [
    "from now on , the monte carlo method is no more restricted to linear problems .",
    "the five examples exposed above have been worked out by teams gathering specialists of monte carlo method and specialists of the physical problem under consideration . by their full exposition",
    ", we offer the readers all the details to implement their own applications . as a guideline ,",
    "the first step is to formulate the physical observable under its expectation form , including the non linearities and integrating all levels of complexity .",
    "the second step is to reformulate this expectation as a formulation compliant with standard monte carlo method , according to the kind of non linearities . for polynomial non linearities ,",
    "use i.i.d .",
    "series products . for other differentiable forms , use taylor expansion around an",
    "upper - bound of the innermost random variable in order to regain a polynomial form . using this mc - compliant formulation , every advanced mc technique",
    "can then be applied : parallel implementation , complex geometry , null - collisions , zero - variance , control variate , importance sampling , sensitivities analysis ... as illustrated by the variety of our seminal examples , this guideline covers a large set of non linear academic and real world problems .",
    "15 dimov , i. t. & mckee , s. monte carlo methods for applied scientists .",
    "( world scientific publishing , 2008 ) .",
    "delatorre , j. et al .",
    "monte carlo advances and concentrated solar applications .",
    "energy 103 , 653 - 681 ( 2014 ) .",
    "siala , f. m. f. & elayeb , m. e. mathematical formulation of a graphical method for a no - blocking heliostat field layout .",
    "energy 23 , 77 - 92 ( 2001 ) .",
    "farges , o. et al .",
    "life - time integration using monte carlo methods when optimizing the design of concentrated solar power plants .",
    "energy 113 , 57 - 62 ( 2015 ) .",
    "assaraf , r. & caffarel , m. zero - variance principle for monte carlo algorithms .",
    "83 , 4682 ( 1999 ) .",
    "metropolis , n. , rosenbluth , a. w. , rosenbluth , m. n. , teller , a. h. & teller , e. equation of state calculations by fast computing machines .",
    "21 , 1087 - 1092 ( 1953 ) .",
    "hammersley , j. m. & handscomb , d. c. monte carlo methods .",
    "( springer netherlands , 1964 ) .",
    "roger , m. , blanco , s. , el hafi , m. & fournier , r. monte carlo estimates of domain - deformation sensitivities .",
    "95 , 180601 ( 2005 ) .",
    "curtiss , j. h. monte carlo methods for the iteration of linear operators .",
    "32 , 209 - 232 ( 1953 ) .",
    "kalos , m.h . & whitlock , p.a .",
    "monte carlo methods , second ed .",
    "( wiley - vch , weinheim 2008 ) .",
    "chatterjee , k. , roadcap , j. r. and singh , s. a new green s function monte carlo algorithm for the solution of the two - dimensional nonlinear poisson - boltzmann equation : application to the modeling of the communication breakdown problem in space vehicles during re - entry .",
    "j. comput .",
    "276 , 479 - 485 ( 2014 ) .",
    "vajargah , b. f. & moradi , m. monte carlo algorithms for solving fredholm integral equations and fredholm differential integral equations .",
    "sci . 1 , 463 - 470 ( 2007 ) .",
    "charon , j. et al .",
    "monte carlo implementation of schiff s approximation for estimating radiative properties of homogeneous , simple - shaped and optically soft particles : application to photosynthetic micro - organisms .",
    "172 , 3 - 23 ( 2016 ) .",
    "cornet , j. f. calculation of optimal design and ideal productivities of volumetrically lightened photobioreactors using the constructal approach .",
    "65 , 985 - 998 ( 2010 ) .",
    "galtier , m. et al .",
    "radiative transfer and spectroscopic databases : a line - sampling monte carlo approach",
    ". j. quant .",
    "172 , 83 - 97 ( 2016 ) .",
    "kac , m. on some connections between probability theory and differential and integral equations .",
    "second berkeley symp .",
    "math . statistics probab . 189 ( 1951 ) .",
    "corney , j. f. & drummond , p. d. gaussian quantum monte carlo methods for fermions and bosons .",
    "93 , 2 - 5 ( 2004 ) .",
    "galtier , m. et al .",
    "integral formulation of null - collision monte carlo algorithms .",
    "125 , 57 - 68 ( 2013 ) .",
    "wagner , w. stochastic particle methods and approximation of the boltzmann equation . math .",
    "38 , 211 - 216 ( 1995 ) .",
    "rjasanow , s. a stochastic weighted particle method for the boltzmann equation .",
    "j. comput .",
    "124 , 243 - 253 ( 1996 ) .",
    "rjasanow , s. & wagner , w. simulation of rare events by the stochastic weighted particle method for the boltzmann equation .",
    "comput . model .",
    "33 , 907 - 926 ( 2001 ) .",
    "krook , m. & wu , t. t. formation of maxwellian tails .",
    "36 , 1107 - 1109 ( 1976 ) .",
    "krook , m. & wu , t. t. exact solutions of the boltzmann equation .",
    "fluids 20 , 1589 - 1595 ( 1977 ) .",
    "l. boltzmann , in wissenschaftliche abhandlungen , edited by f. hasenorl ( j.a .",
    "barth , leipzig , 1909 ) , vol .",
    "ii , p. 83 .",
    "gury - odelin , d. , muga , j. g. , ruiz - montero , m. j. & trizac , e. nonequilibrium solutions of the boltzmann equation under the action of an external force .",
    "112 , 180602 ( 2014 ) .",
    "weitz , s. et al .",
    "monte carlo efficiency improvement by multiple sampling of conditioned integration variables .",
    "j. comput .",
    "326 , 30 - 34 ( 2016 ) .",
    "competing interests : :    the authors declare that they have no competing financial interests .",
    "correspondence : :    correspondence and requests for materials should be addressed to    jrmi dauchet  ( email : jeremi.dauchet@sigma-clermont.fr ) .",
    "authors contributions : :    all authors contributed extensively to the theoretical developments    presented in this paper .",
    "each author contributed to the practical    applications according to its scientific expertise : j.d .",
    ", r.f . and m.g .",
    "in atmospheric sciences , j.d .",
    "c.ca . ,    m.e.h .",
    ", m.g . and m.r .",
    "in radiative transfert , j.d .",
    ", r.f . , j.g .",
    ", a.k . and s.w .",
    "in complex systems in biology , j.d .",
    ",    j.j.b .",
    "c.ca . , m.e.h .",
    ", o.f . and",
    "r.f . in solar energy ,",
    ", s.b . , j.c .",
    ", m.e.h . and",
    "r.f . in electromagnetism and quantum    mechanics , j.d .",
    ", r.f . , j.g .",
    ", b.p . and g.t .",
    "in    statistical physics . c.co .",
    ", v.f . and b.p .",
    "( www.meso-star.com )    performed the numerical implementations .",
    ", r.f . and j.g",
    ".    wrote the paper .",
    "[ [ basics - of - monte - carlo - methods . ] ] basics of monte carlo methods .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    @xmath9 + let us estimate @xmath63 by repeatedly tossing a ( fair ) coin .",
    "the tossing process is described by a random variable @xmath64 that takes the value @xmath0 for head ( probability @xmath65 ) and @xmath1 for tail ( probability @xmath66 ) .",
    "now , to estimate any process ( e.g. a process output : @xmath63 ) , we can affect arbitrary weights @xmath67 to values @xmath68 in order to write @xmath69 as an expectation of the weighted process , following : @xmath70 with @xmath71 and @xmath72 and where @xmath73 denotes expectation with respect to @xmath74 . using the results @xmath75 of @xmath37 successive tosses ( independent realisations of @xmath74 )",
    ", we can then estimate @xmath76 from the weighted average of the tosses results @xmath77 since @xmath78 is indeed the average of monte carlo weights that take the values @xmath79 and @xmath80 with equal probabilities .",
    "such an approach is at the basement of monte carlo techniques : define the weights according to the problem to be solved , sample the process repeatedly , and take the average .",
    "depending on the physical description of the value to be estimated , this approach still holds for an infinite number of terms and can also be extended to integrals formulation using continuous random variables : @xmath81 which can be estimated by @xmath82 , where the @xmath83 are @xmath37 realisations of the random variable @xmath84 with probability density function @xmath85 and domain of definition @xmath86 .",
    "[ [ basics - of - non - linear - monte - carlo - methods . ] ] basics of non - linear monte carlo methods .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    @xmath9 + in order to estimate @xmath87 we introduce two independent variables @xmath40 and @xmath41 identically distributed as @xmath42 ( still conditioned by the same @xmath12 ) : @xmath88 since @xmath40 and @xmath41 are independent , and conditionally independent given @xmath5 : @xmath89 hence @xmath90    the same demonstration can be drawn to establish that : @xmath91    let us now assume that the weights associated to the random variable @xmath12 are described by a nonlinear function @xmath92 of the conditional expectation @xmath93 .",
    "the problem then becomes to compute : @xmath94    such nonlinearity can be treated with no approximation using a projection on infinite basis . in all the examples presented in this article ,",
    "we have used taylor polynomials basis , which means that @xmath95 is expanded around @xmath96 @xmath97 we note that both @xmath96 and @xmath98 can be conditioned by @xmath5 .",
    "now , following the same line as explained above for the basics of monte carlo methods , we regard the sum in the expansion of @xmath98 as an expectation , writing : @xmath99 where the random variable @xmath37 ( of probability law @xmath100 ) is the degree of one monomial in the taylor polynomial .",
    "this step only requires to define an infinite set of probabilities ( instead of two in eq .",
    "[ eq : somme ] ) , with @xmath101 . for the choice of @xmath96 ,",
    "we have used an upper bound of @xmath7 , so that @xmath102 is implicitly derived using bernoulli random variables ( see details in si 1 - 3 ) .",
    "equation  [ eq : form ] can then be rewritten as : @xmath103 defining independent and identically distributed random variables @xmath104 , with same distribution as @xmath42 , the innermost term rewrites @xmath105 or , equivalently : @xmath106 since the variables @xmath107 are independent in the innermost term , we have : @xmath108 so that : @xmath109 and we finally have : @xmath110 which can be read as : @xmath111 with @xmath112    the translation into a monte carlo algorithm then follows :    * sample a realisation @xmath113 of @xmath12 ( and set @xmath96 and @xmath98 accordingly if they depend on @xmath113 ) * sample a realisation @xmath48 of @xmath37 * sample @xmath48 independent realisations @xmath114 of @xmath42 conditioned by @xmath115 * keep @xmath116    and estimate @xmath69 as the average of many realisations @xmath117 .",
    "solar - driven high temperature thermochemical cycles processes , commonly based on metal oxides reduction  @xcite , are an alternative to fossil fuel - based method for @xmath118 generation . here",
    "we focus on thermal reduction zinc oxide , as the first part of a two step water splitting cycle .",
    "photons emitted from the sun are reflected on heliostats and concentrated at the entrance of the chemical reactor in which @xmath119 dissociation is carried out .",
    "solar power received by the reactor at a given instant determines the chemical conversion rate of the reaction @xmath120 .",
    "the present monte carlo estimation of the solar - plant s annual conversion rate @xmath23 associates the thermochemical knowledge of the non - linear kinetics of zinc oxide dissociation  @xcite to the description of radiative transfer on a multiple - reflection solar receiver  @xcite .",
    "the nonlinearity lies in the instantaneous coupling between photon transport and zinc - oxide reduction .",
    "the random variable @xmath42 is the contribution of an optical path from the sun to the entrance of the chemical reactor .",
    "its expectation @xmath121 is the instantaneous thermal - power fraction collected at a given moment @xmath5 of the year@xcite .",
    "solar power is used to reduce the zinc oxide with a nonlinear conversion rate @xmath122 ( see@xcite ) .      the annual conversion rate @xmath23 is reformulated as its taylor expansion around @xmath123 .",
    "first , independent and identically distributed ( i.i.d ) optical - path random variables are introduced , each defining a random contribution @xmath124 i.i.d as @xmath21 . then , we expand the non - linear function @xmath125 around @xmath123 chosen as an upper bound of @xmath21 . finally , the infinite power series is statistically formulated thanks to the discrete random variable @xmath37 the order of taylor expansion : @xmath126 where the @xmath127 are bernoulli random variables : @xmath128    in the end , the reformulation is : @xmath129 where the monte carlo weight function @xmath130 is @xmath131 with @xmath132 and @xmath133 , @xmath134 , @xmath135 , @xmath136 , @xmath137 and @xmath123 known constants .",
    "step 1 : :    uniform sampling of a moment @xmath113 of the year and    index initialisation @xmath49 .",
    "step 2 : :    sampling of the @xmath48-th optical path contributing to    thermal - power collection at instant @xmath113 and    computation of its contribution @xmath138 ( as presented    in@xcite ) .",
    "step 3 : :    computation of the probability @xmath139 in    eq .",
    "[ eq : sipsolbernou ] and sampling of a realisation @xmath140    of the bernoulli random variable @xmath141 .",
    "step 4 : :    if @xmath142 , the algorithm loops to step 2 after    incrementation of @xmath48 .",
    "else , the procedure is terminated    and the weight @xmath143 computed according to    eq .",
    "[ eq : sisolw ] .",
    "results shown in extended data figure 1 are obtained for a 1 mw solar plant with a 80 m high central receiver tour and 160 heliostats arranged in a radial stagered layout ( nueen method ) .",
    "values of the conversion - rate parameters @xmath133 , @xmath134 , @xmath135 , @xmath136 and @xmath137 are given in  @xcite .",
    "meteonorm dni database .",
    "this example is fully detailed in charon _",
    "et al . _ 2016@xcite .      here",
    "we address the solution of schiff s approximation@xcite , also known as the _ anomalous diffraction approximation_@xcite , for an incident plane wave with propagation direction @xmath16 and wave number @xmath144 scattered by the scattering potential @xmath145 that takes value @xmath146 inside a large domain compared to @xmath147 and @xmath0 outside ( this domain corresponds to the shape of the scatterer ) , with @xmath148 .",
    "let @xmath149 be the projected surface of the scatterer seen from @xmath16 , given the scatterer orientation @xmath12 .",
    "straight rays along @xmath16 cross @xmath149 at locations @xmath150 ; the domain of definition of @xmath150 is then @xmath151 .",
    "these rays are attenuated and phase shifted over the crossing length @xmath152 .",
    "the complex random variable @xmath153 is the contribution of one of these rays to the scattered field in a direction @xmath19 deviating from @xmath16 by a small scattering angles @xmath154@xcite : @xmath155 where @xmath156 is the unit vector along the projection of @xmath157 on the plane containing @xmath158 and @xmath159 is the area of @xmath158 .",
    "given the orientation @xmath12 of the scatterer , the conditional expectation @xmath160 is the complex scattering amplitude in direction @xmath19@xcite . for the scatterer orientation @xmath12 ,",
    "the far - field scattering diagram is given by the _ _ differential scattering cross - section__@xcite : @xmath161 .",
    "we address the monte carlo computation of @xmath162 which is @xmath163 averaged over the statistics of the scatterer orientation @xmath12",
    "the full expression is then @xmath164 where the configuration spaces are the orientation vectors of the scattering potential with respect to @xmath16 ( @xmath86 ) and the projected surface of the scattering potential seen from the incident direction @xmath16 ( @xmath158 ) .",
    "@xmath165 is reformulated based on the definition of two independent and identically distributed location random - variables @xmath166 and @xmath167 : @xmath168 where the monte carlo weight function @xmath130 is : @xmath169 with @xmath170 defined in eq .  [ eq : siwavex ]",
    ".      the sampling procedures of the monte - carlo algorithm are then :    step 1 : :    isotropic sampling of an orientation @xmath113 of the    scattering potential .",
    "step 2 : :    uniform sampling of the first location @xmath171 on the    projected surface defined by @xmath113 and computation of    the corresponding crossing length @xmath172 : the    realisation @xmath173 of    @xmath174 is computed according to    eq .  [ eq : siwavex ] .",
    "step 3 : :    uniform sampling of the second location @xmath175 on the    projected surface defined by @xmath113 and computation of    the corresponding crossing length @xmath176 : the    realisation @xmath177 of    @xmath174 is computed according to    eq .",
    "[ eq : siwavex ] .",
    "step 4 : :    computation of the weight    @xmath178 according to    eq .",
    "[ eq : siwavew ] :    @xmath179    codes for the implementation of this algorithm in the case of spheroidal and cylindrical scattering potentials , as well as validation against reference solution , are provided in charon et al .",
    "2016 @xcite ( see also http://edstar.lmd.jussieu.fr/codes ) .",
    "results shown in extended data figure 2 are obtained for @xmath180 , with wavelength @xmath181 and the scattering potential @xmath182 , with @xmath183 ( scatterer relative refractive index@xcite ) .",
    "the shape of the scatterer is helical with length @xmath184 , pitch @xmath185 , helix diameter @xmath186 , cylinder diameter @xmath187 .",
    "here we address the production of reference solutions for a photobioreactor model .",
    "this model is based on a radiative transfer approach presented in@xcite . the rate of photon absorption @xmath188 by micro - algae at location @xmath12 within the culture volume is solution of the radiative transfer equation .",
    "the present study is based on the standard linear transport mc algorithm presented in@xcite for the estimation of @xmath188 at any location within the photobioreactor . in this algorithm ,",
    "realisations of the optical path random variable @xmath189 are sampled backward from the absorption location @xmath12 to the light emitting surface ( the surface of the 979 light - diffusing optical fibres , see edf3 ) .",
    "since micro - algae are scattering visible light , @xmath189 depends on their concentration @xmath23 within the suspension : the scattering and absorption coefficient of the suspension are proportional to @xmath23 ( independent scattering ) .",
    "the random variable @xmath190 is the contribution of one of these optical paths to the photon absorption rate at @xmath12 ( see@xcite for the detailed expression of @xmath191 ) .",
    "this contribution @xmath191 depends on the biomass concentration @xmath23 because the absorption coefficient of the suspension determines the fraction of incident light flux that is transmitted along the optical path @xmath189 ( according to beer law ) . in the end ,",
    "the conditional expectation @xmath192 is the rate of photon absorption at location @xmath12 , for the biomass concentration @xmath23 .",
    "photons absorbed by a micro - algae are converted within the photosynthetic units and the z - scheme@xcite , leading to the local biomass growth - rate@xcite @xmath193 where @xmath137 , @xmath194 , @xmath195 and @xmath196 are constant parameters that depend on the studied microorganism ( see@xcite for values in the case of _ chlamydomonas reinhardtii _ ) .",
    "due to light absorption and scattering by micro - algae , the field @xmath188 is heterogeneous within the volume ( less light farther from the fibres and for higher concentrations ) and so is the local photosynthetic rate @xmath197 .",
    "we address the monte carlo computation of @xmath198 , the local photosynthetic rate @xmath197 averaged over locations @xmath12 of the culture volume .",
    "the full expression is then @xmath199      @xmath22 is reformulated based on the taylor expansion of @xmath125 around @xmath123 .",
    "first , independent and equally distributed optical - path random variables @xmath200 are introduced , defining independent and equally distributed contributions @xmath201 .",
    "then , we expand the non - linear function in eq .  [ eq : sipbrloi ] around @xmath123 chosen as an upper bound of @xmath202 .",
    "finally , the infinite power series is statistically formulated thanks to the discrete random variable @xmath37 the order of taylor expansion : @xmath203 where the @xmath204 are bernoulli random variables : @xmath205    in the end , the reformulation is : @xmath206 where the monte carlo weight function @xmath130 is @xmath207 \\;\\;\\mbox{if}\\ ; u=1\\vspace{6 mm } \\\\ w(1)-\\displaystyle\\sum_{i=1}^{u-1}c\\left[\\alpha\\;\\frac{k^2}{k+x_0}\\left(\\frac{x_0}{k+x_0}\\right)^i + \\beta\\;\\frac{k_r}{k_r+x_0}\\left(\\frac{x_0}{k+x_0}\\right)^i\\;\\right ] \\;\\;\\mbox{if}\\ ; u>1 \\end{array}\\right .",
    "\\label{eq : sipbrpoids}\\ ] ] with @xmath132 and @xmath137 , @xmath195 , @xmath194 , @xmath196 , @xmath123 and @xmath23 known constants .",
    "step 1 : :    uniform sampling of a location @xmath113 within the    culture volume and index initialisation @xmath49 .",
    "step 2 : :    sampling of the @xmath48-th optical path contributing to    absorption at @xmath113 : the realisation @xmath138    of @xmath208 is computed    according to@xcite .",
    "step 3 : :    computation of the probability in eq .",
    "[ eq : sipbrbernou ] ,    @xmath209 , and sampling of a realisation    @xmath140 of the bernoulli random variable    @xmath210 . step 4 : :    if @xmath142 , the algorithm loops to step 2 after    incrementation of @xmath48 .",
    "else , the procedure is terminated    and the weight @xmath211 computed according to    eq .",
    "[ eq : sipbrpoids ] .",
    "results shown in extended data figure 3 are obtained for kinetics parameters @xmath212 @xmath213 , @xmath214 @xmath215 , @xmath216 @xmath217 and @xmath218 @xmath217 .",
    "the photobioreactor is a 25l dicofluv@xcite : reactor diameter @xmath219 , reactor height @xmath220 , optical fibres diameter @xmath221 , fibres height @xmath220 , @xmath222 fibres , hexagonal lattice fibre arrangement with distance @xmath223 between two fibres axis ( see@xcite ) , homogeneous surface flux density @xmath224 emitted at fibres surface .",
    "the radiative properties ( absorption and scattering by micro - algae ) are those presented in@xcite for _ chlamydomonas reinhardtii_.",
    "this example is fully detailed in galtier _",
    "et al . _ 2015@xcite .",
    "photons are emitted either by a surface ( here the ground ) or by the volume ( the atmosphere ) .",
    "the radiation @xmath225 perceived at the observation location toa is the fraction of all these photons that have a frequency inside the observation - band @xmath226 and reach the sensor , i.e. which are not absorbed by the atmosphere in between . when no scattering occurs ( clear sky ) , photon - paths are straight lines and the fraction of the photons of frequency @xmath227 that travel ( let say along the strict vertical ) from altitude @xmath228 to toa is @xmath229 where @xmath230 this exponential extinction is that of beer law where @xmath231 is the monochromatic optical thickness , i.e. the sum of all transition cross - sections @xmath232 at all intermediate altitudes @xmath233 . in this example , the random variable @xmath5 is a vector that gathers the altitude @xmath27 of emission , the photon - path @xmath234 from @xmath27 to toa and frequency @xmath31 of emission .",
    "similarly , @xmath2 gathers all the description of an absorption event , altitude @xmath235 and index of absorption - transition @xmath236 .    in standard",
    "monte carlo approaches , @xmath231 is either precomputed and tabulated , or is easily computable from tabulated values of the absorption coefficient ( @xmath237 )",
    ". then the monte carlo algorithm deals only with the sampling of @xmath5 and the weight function has the form @xmath238 @xmath28 is the source associated with the emission @xmath5 ( planck s function at the local temperature times an emissive power that depends on concentration , pressure and temperature ) .",
    "the sum over the @xmath239 transitions @xmath240 is thus not handled by standard monte carlo algorithms , despite the fact that this sum has all the features inviting to make use of statistical approaches : @xmath239 is huge , typically of the order of @xmath241 , and the deterministic pre - calculations can be computationally very demanding ( and are to be re - performed when testing each new spectroscopic assumption ) .",
    "no attempt has been made so far to address this sum statistically , together with the photon - path statistics because these two statistics are combined via the non - linearity of the exponential extinction .",
    "so the present question is to design a monte carlo algorithm performing the summation @xmath242 together with the integrals over frequency , emission location and absorption location , despite of the nonlinearity of beer extinction .",
    "this starts by looking at @xmath231 in statistical terms  : the integral over altitudes @xmath235 is transformed into the sampling of absorption locations , and the sum @xmath243 into the sampling of absorption - transitions . this double sampling is formally summarised into the random variable @xmath2 . to get a sample @xmath233 of @xmath2 , one first samples @xmath235 and @xmath236 .",
    "then @xmath233 is the value that the optical thickness @xmath231 would have if the atmosphere was homogeneous at the thermodynamic conditions of altitude @xmath244 and if all transitions were identical to @xmath240 .",
    "this random variable depends on @xmath5 and its expectation , knowing @xmath245 , is @xmath246 .",
    "we therefore get @xmath247      a strict application of the solution described in _ methods _ implies to first sample @xmath5 ( as in a standard monte carlo algorithm ) , then sample the degree @xmath48 of one monomial in the taylor expansion of the negative - exponential function @xmath125 , and draw @xmath48 independent samples @xmath248 of @xmath2 , i.e @xmath48 absorption locations @xmath249 ( between emission location and toa ) and @xmath48 transition indexes @xmath250 :    step 1 : :    sample a frequency , step 2 : :    sample an emission - altitude , step 3 : :    sample an order @xmath48 of the development of the exponential , step 4 : :    sample @xmath48 paired absorption - altitudes , transitions .      instead of implementing this solution in this straightforward manner , we chose to use null - collisions@xcite .",
    "the same quantities are sampled , but the order is different , leading to quite intuitive physical pictures .",
    "the first step is still to sample a frequency , but then we implement a backward tracking algorithm , starting from the observation altitude .",
    "we sample a first collision - altitude as if photons were emitted at the observation location in the downward direction in an homogeneous atmosphere .",
    "then we sample a transition and a statistical test is made to determine whether the algorithm stops at this altitude or continues ( a bernoulli test to determine whether the collision is a true one or a null - collision ) .",
    "if it continues , this first collision - altitude and first transition have the status of one of the @xmath48 absorption - altitudes and transitions in the above presented algorithm .",
    "then a next collision - location is sampled , together with a next transition , etc .",
    "when the algorithm stops after @xmath48 collisions , the final altitude is interpreted as the emission - altitude .",
    "so @xmath48 and the emission - altitude are not sampled first : they are sampled by the successive bernoulli tests as in a standard backward - tracking multiple - scattering algorithm .",
    "step 1 : :    initialisation of the current altitude at    @xmath251 .",
    "step 2 : :    uniform sampling of a frequency @xmath227 in the considered    infrared band ( or the whole infrared ) .",
    "step 3 : :    exponential sampling of a travelled distance @xmath54 before    absorption for a photon of frequency @xmath227 travelling    from @xmath244 in the backward direction within a virtual    homogeneous atmosphere of absorption coefficient    @xmath252 .",
    "step 4 : :    if the travelled distance leads the photon to hit the surface ,    @xmath253 and the algorithm jumps to _ step 7_.    otherwise @xmath254 .",
    "step 5 : :    sampling of a state - transition @xmath240 according to    @xmath255 ( see@xcite ) .",
    "step 6 : :    bernoulli trial of probability    @xmath256    to decide whether the algorithm jumps to _ step 7 _ or _",
    "step 3_. step 7 : :    @xmath257 and the algorithm stops with    @xmath258 where @xmath259 is the    planck function at frequency @xmath227 for the atmospheric    temperature at @xmath228 .",
    "the simulation results in extended data fig .",
    "4 have been obtained using the hitran spectroscopic database .",
    "all other parameters are given in galtier _",
    "_ 2015@xcite .      as far as computational costs are concerned",
    ", our computations did not require to first scan hitran and pre - compute absorption coefficients at all altitudes and all frequencies before running the monte carlo code for transfer since our monte carlo code handles both simultaneously despite the nonlinearity of the exponential extinction .",
    "the computational benefit is very significant when studying the effects of new spectroscopic data or new line - shape assumptions . otherwise , for earth applications and fixed spectroscopic assumptions , there is no problem associated to the pre - computation of absorption coefficients and to their tabulation as function of molecular composition and thermodynamic state .",
    "but for combustion or astrophysics applications , thinking in particular of exoplanets , the diversity of compositions is extremely wide , temperatures can by high , imply the use of much larger spectroscopic databases , including hot lines , and pre - computation / tabulation of absorption coefficients is a today s challenge in itself .",
    "our nonlinear monte carlo suppresses this need@xcite .",
    "we consider a gas of interacting particles , with collisions following maxwell model , and a cross section @xmath260 .",
    "particles are confined within an harmonic static trap of pulsation @xmath261 so that acceleration at position @xmath262 is spring - like : @xmath263 .",
    "we follow the distribution function @xmath264 at location @xmath262 , velocity @xmath265 at time @xmath266 .",
    "we consider it known at some time @xmath267 , either constrained at local equilibrium , according to :    @xmath268    or , out of equilibrium , according to :    @xmath269    where @xmath270 denotes density , @xmath271 denotes the mean velocity and @xmath272 denotes the mean square speed at @xmath262 at time @xmath267 ; @xmath273 denotes probability density function of a gaussian random variable , with expectation @xmath274 and variance @xmath275 .",
    "[ [ for - the - case - in - fig.-3a ] ] for the case in fig .",
    "3a , + + + + + + + + + + + + + + + + + + + + + + + +    we set @xmath276 , and @xmath270 , @xmath271 and @xmath272 are set homogeneous , corresponding to the case studied par krook and wu@xcite .",
    "starting from @xmath277 , the gas relaxes to equilibrium @xmath278 .",
    "adimensional time is @xmath279 and adimensional distribution function is @xmath280 .",
    "[ [ for - the - case - in - fig.-3b ] ] for the case in fig .",
    "3b , + + + + + + + + + + + + + + + + + + + + + + + +    we set @xmath281 , and @xmath270 , @xmath271 and @xmath272 are set heterogeneous to correspond to one state of the undamped oscillation ( _ _ breathing mode__@xcite ) :    @xmath282    with @xmath283 where @xmath284 is the maximal deviation of @xmath285 from its equilibrium value @xmath286 .    with these initial values , and starting from local equilibrium @xmath278 ,",
    "the local equilibrium remains unbroken and the gas displays the undamped oscillation for any value of the cross section .",
    "conversely , starting from out of equilibrium @xmath277 , any positive value of cross section will lead to dampened oscillations .",
    "adimensional time is @xmath287 , adimensional distribution function is @xmath288 and adimensional parameter for cross - section is @xmath289 .",
    "simulation results are given for @xmath290 and @xmath291 .",
    "the distribution function obeys the boltzmann equation :    @xmath292    where @xmath293 , @xmath294 , @xmath295 and @xmath296 .",
    "velocities @xmath297 and",
    "@xmath298 are functions of @xmath265 , @xmath299 and @xmath300  : @xmath301 , @xmath302 .    the usual pde expression of this model , given above , can be translated into its fredholm counterpart , following :    @xmath303 \\end{aligned } \\label{eqf}\\ ] ]    with    @xmath304    where @xmath305 and @xmath306 are location and velocity corresponding to the ballistic path through @xmath262 at time @xmath266 with velocity @xmath265 , such as : @xmath307 and @xmath308 , @xmath309 .",
    "the product @xmath310 has been treated following the nlmc expansion exposed in methods .",
    "the exponential term is handled using null collisions technique , as exposed in si4 .",
    "the upper bound for cross section is set at the value it takes at the center of the gas cloud at time of maximal contraction of the undamped oscillation : @xmath311      according to eq .",
    "[ eqf ] , three random variables are defined for the monte carlo estimates : @xmath312 for @xmath313 , @xmath314 for @xmath300 and @xmath315 for @xmath299 , with :    @xmath316-\\infty , t]\\\\",
    "p_{\\vec{u}}(\\vec{u } ) & = & \\frac{1}{4\\pi } \\ & \\text{over the unit sphere } \\\\ p_{\\vec{c^*}}(\\vec{c } _ * ) & = & p_{{\\cal n}(\\vec{u}_{boltz } , c_{q , boltz}^2 ) } \\ & \\text{over velocity space }   \\end{array}\\ ] ]    where @xmath317 et @xmath318 are respectively the mean velocity and the mean square speed at the considered time , and set to the values predicted in the case of undamped oscillation .    @xmath319 can be estimated by this recursive algorithm :    initialisation : :    sample a date @xmath313 .",
    "recursion termination : : :    if @xmath320 return    @xmath321 .",
    "recursion : :    @xmath322 +    sample a velocity @xmath299 and a unit vector    @xmath300 .",
    "+    compute the ballistic solution @xmath323 and    @xmath324 .",
    "+    estimate    @xmath325 .",
    "+    set @xmath326    +    if @xmath327 $ ] , then set    @xmath328 else set    @xmath329 .",
    "+    sample a standard uniform @xmath330 .",
    "+    if @xmath331 , then estimate    @xmath332    and return @xmath333 ,    +    else set @xmath334    +    estimate    @xmath335 .",
    "+    estimate    @xmath336 .",
    "+    return    @xmath337    4 steinfeld , a. solar thermochemical production of hydrogen  a review _ sol .",
    "energy_. * 78 * , 603 ( 2005 ) mller , r. et al",
    ". transient heat transfer in a directly - irradiated solar chemical reactor for the thermal dissociation of zno .",
    "_ * 28 * , 524 ( 2008 ) schunk , l.o .",
    "et al . heat transfer model of a solar receiver - reactor for the thermal dissociation of zno - experimental validation at 10 kw and scale - up to 1 mw . _",
    "j. _ * 150 * 502 ( 2009 ) pitz - paal , r. et al .",
    "heliostat field layout optimization for high - temperature solar thermochemical processing . _",
    "sol . energy_. * 85 * , 334 ( 2011 ) delatorre , j. et al .",
    "monte carlo advances and concentrated solar applications .",
    "_ sol . energy_.",
    "* 103 * , 653 ( 2014 ) farges , o. et al .",
    "life - time integration using monte carlo methods when optimizing the design of concentrated solar power plants .",
    "energy 113 , 57 - 62 ( 2015 ) .",
    "charon , j. et al .",
    "monte carlo implementation of schiff s approximation for estimating radiative properties of homogeneous , simple - shaped and optically soft particles : application to photosynthetic micro - organisms .",
    "172 , 3 - 23 ( 2016 ) .",
    "schiff , l. i. approximation method for high - energy potential scattering .",
    "_ physical review_. ( 1956 ) van de hulst , h. c. light scattering by small particles . _ dover publication , inc._. ( 1981 ) dauchet , j. and al .",
    "calculation of the radiative properties of photosynthetic microorganisms .",
    "_ j. quant .",
    "transfer_. ( 2015 ) dauchet , j. , cornet , j .- f . , gros , f. , roudet , m. and dussap , c .- g .",
    "chapter one  photobioreactor modeling and radiative transfer analysis for engineering purposes .",
    "48 , 1 - 106 ( 2016 ) .",
    "bohren , c. f. and huffman , d. r. absorption and scattering of light by small particles .",
    "_ new york , wiley - interscience_. ( 1983 ) cornet j.f .",
    "calculation of optimal design and ideal productivities of volumetrically lightened photobioreactors using the constructal approach .",
    "sci . _ * 65 * 985 ( 2010 ) takache , h. et al .",
    "kinetic modeling of the photosynthetic growth of chlamydomonas reinhardtii in a photobioreactor .",
    "_ biotechnol .",
    "_ * 28 * 681 ( 2012 ) dauchet , j. et al .",
    "the practice of recent radiative transfer monte carlo advances and its contribution to the field of microorganisms cultivation in photobioreactors .",
    "_ j. quant .",
    "radiat . transfer_.",
    "* 128 * 52 ( 2013 ) delatorre , j. et al .",
    "monte carlo advances and concentrated solar applications .",
    "_ sol . energy_.",
    "* 103 * , 653 ( 2014 ) hatch , m.d .",
    "photosynthesis and photo - respiration .",
    "_ wiley - interscience _ ( 1971 ) cornet j.f . &",
    "dussap c.g . a simple and reliable formula for assessment of maximum volumetric productivities in photobioreactors _ biotechnol .",
    "* 25 * 424 ( 2009 ) galtier , m. et al .",
    "radiative transfer and spectroscopic databases : a line - sampling monte carlo approach",
    ". j. quant .",
    "galtier , m. et al .",
    "integral formulation of null - collision monte carlo algorithms .",
    "125 , 5768 ( 2013 ) .",
    "krook , m. & wu , t. t. formation of maxwellian tails .",
    "rev . lett .",
    "36 , 1107 - 1109 ( 1976 ) .",
    "krook , m. & wu , t. t. exact solutions of the boltzmann equation .",
    "fluids 20 , 1589 - 1595 ( 1977 ) .",
    "gury - odelin , d. , muga , j. g. , ruiz - montero , m. j. & trizac , e. nonequilibrium solutions of the boltzmann equation under the action of an external force .",
    "112 , 180602 ( 2014 ) ."
  ],
  "abstract_text": [
    "<S> the monte carlo method is widely used to numerically predict systems behaviour . </S>",
    "<S> however , its powerful incremental design assumes a strong premise which has severely limited application so far : the estimation process must combine linearly over dimensions . </S>",
    "<S> here we show that this premise can be alleviated by projecting nonlinearities on a polynomial basis and increasing the configuration - space dimension . </S>",
    "<S> considering phytoplankton growth in light - limited environments , radiative transfer in planetary atmospheres , electromagnetic scattering by particles and concentrated - solar - power - plant productions , we prove the real world usability of this advance on four test - cases that were so far regarded as impracticable by monte carlo approaches . </S>",
    "<S> we also illustrate an outstanding feature of our method when applied to sharp problems with interacting particles : handling rare events is now straightforward . </S>",
    "<S> overall , our extension preserves the features that made the method popular : addressing nonlinearities does not compromise on model - refinement nor system complexity and convergence rates remain independent of dimension .    </S>",
    "<S> 1 .   universit clermont auvergne , sigma - clermont , institut pascal , bp 10448 , f-63000 clermont - ferrand , france . </S>",
    "<S> 2 .   </S>",
    "<S> universit fdrale de toulouse midi - pyrnes , mines albi , umr cnrs 5302 , centre rapsodee , campus jarlard , f-81013 albi ct cedex . </S>",
    "<S> 3 .   laplace , universit de toulouse , cnrs , inpt , ups , france . </S>",
    "<S> 4 .   processes , materials and solar energy laboratory , promes , cnrs , 7 rue du four solaire , 66120 font - romeu - odeillo - via , france . </S>",
    "<S> 5 .   </S>",
    "<S> mso - star sas , www.meso-star.com . </S>",
    "<S> 6 .   </S>",
    "<S> total energies nouvelles , r&d - concentrated solar technologies , tour michelet , 24 cours michelet , 92069 paris la dfense cedex , france . </S>",
    "<S> 7 .   </S>",
    "<S> univ lyon , cnrs , insa - lyon , universit claude bernard lyon 1 , cethil umr5008 , f-69621 , villeurbanne , france . 8 </S>",
    "<S> .   research center on animal cognition ( crca ) , center for integrative biology ( cbi ) , toulouse university , cnrs , ups , france </S>",
    "<S> . 9 .   </S>",
    "<S> umr ma 122 efts ( education , formation , travail , savoirs ) , universit toulouse 2 , toulouse .    </S>",
    "<S> the standard monte carlo ( mc ) method is a method to predict a physical observable by numerically estimating a statistical expectation over a multi - dimensional configuration space@xcite . </S>",
    "<S> the reason why this method is so popular in all fields of scientific research is its intuitive nature . in the most current practice , </S>",
    "<S> simulation tools are designed in direct relation with the pictures available in each discipline and later refinements are gradual and straightforward . </S>",
    "<S> model refinements merely extend sampling to new suitable dimensions . </S>",
    "<S> the method is nonetheless mathematically rigorous : specialists specify observables that are implicitly translated into integral quantities that are estimated using random sampling in each direction of the configuration space . </S>",
    "<S> this choice of a statistical viewpoint is highly powerful because the algorithm can be designed directly from the description of the system , whether it is deterministic or not , with no reworking nor approximation .    </S>",
    "<S> let us illustrate how mc is used in engineering with a typical example : the optimal design of a concentrated solar plant@xcite ( see fig.1-a ) . </S>",
    "<S> the power collected by the central - receiver results from all the rays of sunlight that reach it after reflection by heliostats , so it depends on the complex geometry of the heliostats . </S>",
    "<S> moreover , the heliostats being adaptively oriented to follow the sun position , they can mask one another at some times of the day . to estimate by mc the received power at one time of interest , </S>",
    "<S> i.e. for a given geometry of the heliostats : pick an optical path among the ones that join the sun to the central - receiver via an heliostat , check whether this path is shadowed or blocked by another heliostat , and retain a monte carlo weight equal to @xmath0 or @xmath1 depending on the transmission success . </S>",
    "<S> let @xmath2 be the random variable denoting the transmission success . </S>",
    "<S> the collected fraction of the available sun power is then the expectation @xmath3 of @xmath2 and can be evaluated with no bias as the average of such weights over a large number of sampled paths .    </S>",
    "<S> this approach robustly complies with expanded descriptions of the physical observable to be addressed . </S>",
    "<S> for instance , the fraction of the available sun power collected on average over the entire lifetime of the plant ( operating typically 30 years ) can be predicted as the expectation over time of @xmath3 varying in time . denoting @xmath4 the collected fraction at random time @xmath5 within the 30 years </S>",
    "<S> , the time - averaged fraction is given by @xmath6 . </S>",
    "<S> the basic algorithm above can then be encapsulated within time sampling : first pick a date for @xmath5 , then pick a path at that date for @xmath7 . in the end , </S>",
    "<S> estimate @xmath8 by computing the average of the transmission success over all combined pairs ( date , path ) . </S>",
    "<S> meanwhile , one can as well account for sun power fluctuations by estimating the atmospheric transmission at each picked date . </S>",
    "<S> the choice of the statistical viewpoint thus allows to incorporate into one single statistical question as many ingredients as it takes : the geometrical complexity of the heliostats@xcite , the daily course of the sun , the seasonal scale as well as the hour scale weather fluctuations@xcite . </S>",
    "<S> remarkably , the latter question is nearly as simple to address as the estimation of the power collected at one single date : the algorithmic design can map the full conceptual description , yet computational costs are poorly affected . </S>",
    "<S> contrastingly , deterministic approaches would translate into unpractical computation times or require simplified and approximate descriptions , so mc has become the only practical solution in many such engineering contexts . </S>",
    "<S> becoming such a standard practice , mc has prompted numerous theoretical developments@xcite .     * complex systems with non linear outputs : four real - world examples . </S>",
    "<S> *        [ [ fig.-1-complex - systems - with - nonlinear - outputs - four - real - world - examples . ] ] fig . 1 * complex systems with nonlinear outputs : four real world examples . </S>",
    "<S> * + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    @xmath9 + * a , solar - driven high - temperature thermal reduction of zinc oxide , as the first part of a two step water splitting cycle . </S>",
    "<S> * photons emitted from the sun are reflected on heliostats and concentrated at the entrance of the chemical reactor in which @xmath10 dissociation is carried out . depending on their transmission success @xmath2 , the solar power @xmath11 absorbed by the receiver at a random instant @xmath12 of lifetime determines the nonlinear chemical conversion rate of the reaction @xmath13 . </S>",
    "<S> here we address the estimation of the annual solar - plant s conversion rate @xmath14 at different earth locations @xmath15 , by averaging the instantaneous conversion rates over the statistics of sun position and incident direct normal irradiance ( dni ) , which fluctuates with time and weather ( see also edf1 and si1 ) . </S>",
    "<S> @xmath9 +    * b , wave scattering by a complex - shaped and optically - soft scatterer ( cyanobacterium _ arthrospira _ ) . * </S>",
    "<S> an incident plane wave with propagation direction @xmath16 is scattered by the helical cyanobacterium . </S>",
    "<S> the bacterium has low relative refractive index and is much larger than wavelength ( optically - soft particle ) . </S>",
    "<S> the complex scattering - amplitude @xmath11 in the forward directions is the sum of secondary waves contributions @xmath17 ( interference ) originating from the scatterer projected surface . </S>",
    "<S> this surface depends on the scatterer orientation @xmath12 . </S>",
    "<S> here we address the estimation of @xmath18 the single - scattering differential cross - section in direction @xmath19 for a suspension of particles , assuming independent scattering , by averaging the squared modulus of @xmath11 over the statistics of orientations @xmath12 ( see also edf2 and si2 ) . </S>",
    "<S> @xmath9 +    * c , phytoplankton growth in light - limited environments . </S>",
    "<S> * phytoplankton is put to grow in a continuous stirred tank photobioreactor internally illuminated by optical fibres @xmath20 immersed in the culture . </S>",
    "<S> the local rate of photon absorption @xmath11 at location @xmath5 is the average of the contributions @xmath21 of every optical path from fibres to @xmath5 through the scattering and absorbing suspension . </S>",
    "<S> @xmath11 determines the nonlinear photosynthetic growth - rate at location @xmath12 . here </S>",
    "<S> , we address the monte carlo estimation of @xmath22 the global growth - rate in the whole culture volume as a function of biomass concentration @xmath23 , by averaging the local rate over locations in the volume ( see also edf3 and si3 ) . </S>",
    "<S> @xmath9 +    * d , atmospheric radiative transfer : top - of - atmosphere ( toa ) specific intensity ( from earth toward the outer space ) . * </S>",
    "<S> photons emitted by the atmosphere at infrared frequencies are due to random emission - transitions @xmath12 , from an upper to a lower energy - state , of mainly @xmath24 and @xmath25 molecules of concentration @xmath26 at altitude @xmath27 . the corresponding source @xmath28 depends on the thermodynamic state of the atmosphere , mainly temperature @xmath29 ( defining the energy - state population ) and pressure @xmath30 ( defining most of the line - width , i.e. the uncertainty of the emission - frequency @xmath31 ) . this source is then exponentially extinct by atmospheric absorption , i.e. by all random absorption - transitions @xmath21 , from a lower to an upper energy - state , occurring at altitude @xmath32 between @xmath27 and the top of atmosphere ( see also edf4 and si4 ) </S>",
    "<S> .    still , mc can not handle _ any _ question to date . as a matter of fact </S>",
    "<S> , it has been identified early on that `` the extension of monte carlo methods to nonlinear processes may be impossible''@xcite and it is a prevalent opinion nowadays that `` monte carlo methods are not generally effective for nonlinear problems mainly because expectations are linear in character''@xcite so that `` a nonlinear problem must usually be linearized in order to use monte carlo technique''@xcite . </S>",
    "<S> we are aware of only one attempt so far to bypass this failing : the proposition by vajargah@xcite or dimov@xcite of using branching processes to solve fredholm - type integral equations with polynomial nonlinearity .    </S>",
    "<S> unluckily , most real world problems are nonlinear . and </S>",
    "<S> indeed , if the question were now to evaluate the final return on investment of the solar plant , namely how much electrical power it would deliver over its lifetime , standard mc would fail because the instantaneous conversion efficiency from collected solar - power to electrical power is not linear . </S>",
    "<S> let us consider , as a toy example , a basic nonlinear case where the electrical power would be proportional to the square of the instantaneous collected solar power @xmath4 at date @xmath5 . in monte - carlo terms , the question would be then to estimate @xmath33 over the plant lifetime . in this case </S>",
    "<S> , the optical and temporal expectations can not be combined any more because it would be wrong to first estimate , as above , the total solar power collected over lifetime , and then apply the conversion efficiency in the end ( basically , @xmath34 the same way as @xmath35 ) . </S>",
    "<S> instead , one would have to sample dates ( say @xmath36 dates , millions over 30 years ) , estimate the solar power collected at each date by averaging over numerous optical paths transmission successes ( say @xmath37 paths , millions for each date ) , apply the nonlinear conversion to the result at that date , and then average over all dates . </S>",
    "<S> doing so , mc would now require @xmath38 samples , and , even worse , further levels of complexity ( each adding a nonlinearity to the problem ) would similarly multiply the computation time . </S>",
    "<S> moreover , the result would be biased due to the finite sampling sizes of the innermost dimensions . in short , mc distinctive features are dismissed and exact life - time integration looks impossible .    bearing in mind our earlier theoretical works about mc integral formulations@xcite , we found a way to bypass this obstacle for a large class of nonlinear problems , based on the very statistical nature of mc . </S>",
    "<S> in the case of our toy example , we use the fact that : @xmath39 where @xmath40 and @xmath41 are two independent variables identically distributed as @xmath42 ( see methods ) . translated in sampling algorithm , the solution is then to sample optical paths in pairs @xmath43 ( instead of millions ) at each sampled date and now retaining the pair product @xmath44 of their transmission successes . </S>",
    "<S> the optical and temporal statistics can then actually be sampled together and yield the unbiased result with no combinatorial explosion . </S>",
    "<S> this reformulation can be generalised to any nonlinearity of polynomial shape . </S>",
    "<S> first , monomials of any degree can indeed be estimated using the same sampling property as the one used above for @xmath45 : @xmath46 where the @xmath47 are @xmath48 independent random variables identically distributed as @xmath42 . for any monomial of degree @xmath48 , the expectation can then be computed by sampling series of @xmath48 independent realisations of @xmath7 , and averaging the series products . </S>",
    "<S> the linear case , solved by standard mc , corresponds to @xmath49 . </S>",
    "<S> secondly , since polynomials are just linear combinations of monomials , the expectation for any polynomial function of @xmath50 of degree @xmath48 can be translated into a monte carlo algorithm , sampling first a degree in the polynomial , and then sampling as many independent realisations of @xmath51 as this random degree ( see _ methods _ ) . for a polynomial function of degree @xmath48 , </S>",
    "<S> the corresponding non - linear monte carlo ( nlmc ) algorithm is then :    * pick a sample @xmath52 of @xmath12 , * pick a monomial degree value @xmath53 , * draw @xmath54 independent samples of @xmath55 and retain their product ,    repeat this sampling procedure and compute the estimate as the average of retained products .    </S>",
    "<S> moreover , if polynomial forms of any dimension are now solvable with no approximation , so is the projection of any nonlinear function on a polynomial basis of any dimension , even of infinite dimension if needed ( full details using the taylor expansion are given in _ </S>",
    "<S> methods _ ) . as a result , </S>",
    "<S> any hierarchy of nested statistical processes that combine nonlinearly can now be , in theory , exactly addressed within the monte carlo framework . </S>",
    "<S> the deep rationale of our reformulation of nonlinear expectations can be grounded on the fundamentals of functional statistics : </S>",
    "<S> nonlinear processes are formally equivalent to infinite - dimension processes and mc algorithms are well known to smartly address , by design , expectations over domains of infinite dimension .    to our knowledge , this analysis has never been made . </S>",
    "<S> it has yet major practical consequences for real world problems , provided the polynomial sampling , which is the price to be paid for tackling nonlinearities exactly , remains tractable . </S>",
    "<S> for instance , let s go back to our illustrative solar - power - plant example , and use now the actual expression for the conversion rate and its taylor expansion : for each date , once a sun - position and climate conditions have been fixed , one would have to pick a random number of independent optical paths ( instead of one optical path in the linear case ) , keep the product of their transmission success , and make the average of many such products in the end . </S>",
    "<S> doing so , it becomes possible to integrate hourly solar input fluctuations over 30 years in the full geometry of a kilometre - wide heliostats field in order to optimise the nonlinear solar - to - electric conversion over the plant lifetime ( fig . </S>",
    "<S> 1a ) . </S>",
    "<S> the same line of thought can be used to predict wave scattering by a tiny scale complex - shaped scatterer@xcite such as an helicoidal cyanobacterium ( fig . </S>",
    "<S> 1b ) . </S>",
    "<S> the biomass production example ( fig . </S>",
    "<S> 1c ) , where incoming light favours the photosynthetic growth that in turn blocks the incoming light , illustrates how our method also handles nonlinear feedbacks@xcite . finally , with the estimation of earth radiative cooling ( fig . </S>",
    "<S> 1d ) , we reproduce quite classical results , yet with a pure statistical approach : by sampling directly the state transitions of greenhouse gases , we avoid costly deterministic computations that the standard linear monte carlo approach requires in order to by - pass the nonlinearity of beer extinction law@xcite . in each of the four cases , it appeared that the additional computations were well affordable using only ordinary computing power ( the complete physical descriptions of the four problems , the nonlinearities involved and their translation in nlmc can be found in their respective extended data figures and supplemental information , solar plant : edf1 , si1 ; complex - shaped scatterer : edf2 , si2 ; biomass production : edf3 , si3 ; earth radiative cooling : edf4 , si4 ) .    from a theoretical point of view , in these four cases , the model is directly enunciated in statistical terms , defining two random variables @xmath42 and @xmath12 from the start . </S>",
    "<S> more broadly , standard mc practice can start as well from a deterministic description ( see methods ) , most commonly from a linear partial differential equation ( pde ) . </S>",
    "<S> the formal equivalence between the solution of a linear pde and the expectation of a random variable has been established for long@xcite . and indeed pde - to - mc translations are essential to nanoscale mechanics ( quantum monte carlo@xcite ) or nuclear sciences . </S>",
    "<S> nlmc allows such translations for nonlinear pde .    as a touchstone </S>",
    "<S> , we address a prominent example of nonlinear pde in statistical physics , the boltzmann equation which governs the spatiotemporal density of interacting particles in a dilute gas ( full details in si5 ) . </S>",
    "<S> the corresponding physics is easy to visualise : a particle just follows its ballistic flight until it collides with another particle . </S>",
    "<S> the collisions are considered as instantaneous and only modify the two particles velocities . </S>",
    "<S> the equation for the evolution of particle density in phase - space ( position , velocity ) is nonlinear because the collision rate depends on the density itself . in order to project this nonlinearity on the proper polynomial basis of infinite dimension , </S>",
    "<S> this pde is first translated into its fredholm integral counterpart ( a step reminiscent of the aforementioned dimov s proposition@xcite ) . </S>",
    "<S> this fredholm integral expresses the density in the phase space at some location for some velocity at some time , as if putting a probe in space - time . </S>",
    "<S> it is estimated by monte carlo , tracking the dynamics backward in time up to the initial condition ( or boundary conditions ) . </S>",
    "<S> importantly , such a probe estimation does not require the exhaustive resolution of the whole field at previous times : like in standard backward mc for linear transport , the information about previous states of the field is reconstructed along each path only where and when it is required@xcite . </S>",
    "<S> the contrast with linear mc is that nonlinearity due to collisions translate into branching paths .    </S>",
    "<S> this extension deals very efficiently with extremely rare events because it preserves an essential feature of mc : avoiding time / space / velocity discretisation@xcite , very low densities can be estimated with no bias , and the only source of uncertainty is the finite number of sampled events ( i.e. the confidence interval around the estimated density ) . as a test bed , we consider a case for which analytical solutions have been published : the early krook s analysis of the distribution of speeds in far out - of - equilibrium conditions@xcite . </S>",
    "<S> krook s analysis was outstanding because it provided an analytical solution to a problem which looked impossible to solve numerically : events with the greatest consequences , namely particles with the highest energies ( i.e. high speed particles , of tremendous importance in nuclear chemistry ) lie far in the tail of speed distribution and have very low probability of occurrence ( rare events ) . using our nlmc design , the fractions of particles which have a kinetic energy higher than @xmath56 times the average value , and which correspond to a fraction as low as @xmath57 of the total , </S>",
    "<S> can now be quantified as accurately as desired , and fit perfectly the analytical solution ( fig . </S>",
    "<S> 2a ) .    being validated on krook s case , this extension opens the way to solve systems for which no analytical solutions are available . </S>",
    "<S> as an example , we consider now a fully spatialised system in which the particles are confined by an outside harmonic potential , leading to a so - called _ breathing mode _ of the gas density . </S>",
    "<S> such a solution to the boltzmann equation had been early identified by boltzmann himself@xcite , but has been recently revisited and generalised in the context of shortcut to adiabaticity techniques for classical gases@xcite . </S>",
    "<S> exact solutions are available only under the constraint that gas is at local equilibrium , in which case density displays a permanent oscillation . here again , these analytical solutions are exactly recovered . yet </S>",
    "<S> , nlmc allows to go beyond this constraint and to explore the gas behaviour when the local equilibrium constraint is alleviated : starting from a state far from local equilibrium , it is now possible to estimate how fast the velocities redistribution induced by collisions actually dampens the oscillation ( fig . </S>",
    "<S> 2b ) .    </S>",
    "<S>  * non linear monte carlo for gas kinetics . </S>",
    "<S> *        [ [ fig.-2-non - linear - monte - carlo - for - gas - kinetics . ] ] fig . </S>",
    "<S> 2 * non - linear monte carlo for gas kinetics . * + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    @xmath9 +    * a , relaxation of speed distribution to equilibrium * ( * a1 * : tail distribution of particles speeds ( fraction of particles faster than @xmath58 ) , * a2 * : probability density function of velocity , * a3 * : evolution of the fraction of particles faster than 6 speed units ) . in an homogenous gas , </S>",
    "<S> collisions between particles redistribute velocities so that the speed distribution tends to equilibrium ( maxwellian distribution ) . starting from a distribution far from equilibrium ( black curves ) </S>",
    "<S> , we compute the relaxation to the maxwellian distribution ( blue curves ) by estimating the tail distribution at different times ( e.g. red curves correspond to the system state at 1 unit time ) . </S>",
    "<S> the continuous lines correspond to the analytical solutions and each point corresponds to an independent nlmc estimation . </S>",
    "<S> the fraction of particles faster than 6 speed units ( * a3 * ) illustrates how nlmc well accounts for the 1000-fold increase of the rarest high - speed particles , with no space nor time discretisation . </S>",
    "<S> remarkably , rare events are estimated with the same relative uncertainty as frequent events ( @xmath59 samples for each estimate , confidence intervals of all estimates are contained within the point thickness ) . </S>",
    "<S> @xmath9 +    * b , dampening of breathing mode . * a dilute gas confined by an outside harmonic potential display a </S>",
    "<S> _ breathing mode_. we estimate the density at probe position @xmath60 and velocity @xmath61 ( in adimensional units , see si5 ) at different times ( adim . </S>",
    "<S> unit ) . </S>",
    "<S> starting from a distribution complying with local equilibrium , the density displays a perpetual oscillation at twice the trap frequency ( blue curve , analytical solution ) , independent of the collision rate ( or , equivalently , of the elastic cross section ) . starting from a distribution far from local equilibrium ( the same initial distribution as in * a * ) , </S>",
    "<S> the density still pulsates in absence of collisions ( null cross section , black curve : analytical solution , black points : probe estimates ) . introducing collisions ( raising cross section ) , the velocities redistribution induced by collisions dampens the oscillation ( red points : probe estimates , no analytical solution ) . </S>",
    "<S> the inset illustrates that probes can be bunched to zoom in on a period of special interest ( e.g. estimating the peak values at each cycle ) . </S>",
    "<S> each point is estimated independently using @xmath62 samples , confidence intervals of all estimates are contained within the point thickness in the main figure , confidence intervals are represented by the gray background area in the inset ) . </S>"
  ]
}