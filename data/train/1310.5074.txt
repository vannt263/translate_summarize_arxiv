{
  "article_text": [
    "partial differential equations involving singular sturm - liouville operators with continuous spectra arise frequently in computational physics .",
    "common approaches to solving them include domain truncation , which often regularizes the operator and makes the spectrum discrete , or projection onto finite dimensional orthogonal polynomial or finite element subspaces , which also leads to discrete spectra . here",
    "we develop an alternative approach in which the continuous spectrum is treated analytically via a spectral transform , and the numerical challenge is in accurately representing and evaluating the integrals giving the exact solution .",
    "while the methods developed in this paper to diagonalize singular sturm - liouville operators are quite general , we will describe them in the context of velocity - space diffusion in one dimension , @xmath1 , \\qquad    ( v>0,\\;t>0),\\ ] ] where @xmath2/(2v^2)$ ] is the chandrasekhar function and @xmath3 is the error function .",
    "the diffusion operator on the right - hand side of ( [ eq : u : intro ] ) plays an important role in numerical simulations of systems governed by the fokker - planck kinetic equation @xcite @xmath4 here @xmath5 is the distribution function for particles of species @xmath6 of charge @xmath7 and mass @xmath8 , and @xmath9 is the fokker - planck collision operator @xcite describing collisions between species @xmath6 and other species , including itself . in many problems of interest ,",
    "the distribution function @xmath10 is close to a maxwell - boltzmann distribution , in which case one often writes @xmath11 , where @xmath12 is the maxwell - boltzmann distribution and @xmath13 @xcite .",
    "the collision operator @xmath9 may then be linearized about @xmath12 @xcite . when this is done , the operator on the right - hand side of ( [ eq : u : intro ] ) is the term in the linearized version of @xmath9 that represents energy diffusion resulting from the collision of @xmath14 with a maxwellian background @xmath12 @xcite . in this context , the variable @xmath15 in equation ( [ eq : u : intro ] ) is the speed coordinate @xmath16",
    ".    numerical solution of ( [ eq : full : fp ] ) is expensive due to the high - dimensional phase space in which the distribution functions evolve @xcite . to reduce the computational time without sacrificing accuracy ,",
    "it is important to develop optimized discretization techniques @xcite . for",
    "the speed coordinate , non - classical orthogonal polynomials @xcite are emerging as a promising alternative to finite difference methods @xcite . equation ( [ eq : u : intro ] ) is well - suited to assess the merits of these discretization schemes for the speed coordinate in ( [ eq : full : fp ] ) without the computational overhead of a high - dimensional phase space .",
    "it is physically relevant since the right - hand side of ( [ eq : u : intro ] ) can be identified as the energy - diffusion term in the `` test - particle '' part of the linearized landau collision operator @xcite , as already discussed .",
    "the solution also relaxes to a maxwellian distribution as @xmath17 , as one would physically expect from a collision operator , and the equation is `` mass - conserving , '' i.e.  the integral @xmath18 remains constant in time . as such , ( [ eq : u : intro ] ) and close variants of it are often used as standard tests of the accuracy and conservation properties of numerical solvers , as illustrated by example iv.a in @xcite for instance .    in the present paper , we develop a spectral transform method to study the dynamics of ( [ eq : u : intro ] ) in detail . in subsequent work @xcite ,",
    "joint with landreman , we will study the projected dynamics of this equation in finite - dimensional spaces of orthogonal polynomials . roughly speaking ,",
    "we show in this article how to efficiently evaluate the exact solution by discretizing a continuous transform , while in @xcite we discretize the pde before evolving the solution .",
    "the latter approach is faster and better suited to large scale computations of the full fokker - planck equation , while the current approach clarifies the role of the continuous spectrum in the dynamics and provides an independent means of validating the orthogonal polynomial approach .",
    "validation is especially important in singular cases where the true solution of ( [ eq : u : intro ] ) leaves the finite - dimensional subspace and later returns to a point that may or may not agree closely with the solution of the projected dynamics .",
    "these singular cases are not only of academic interest , but in fact correspond to situations of practical interest in plasma physics , such as the calculation of the resistivity of a homogeneous , unmagnetized plasma @xcite .",
    "the construction of an accurate discretization of the exact solution of ( [ eq : u : intro ] ) with singular initial conditions is therefore a useful tool to evaluate the performance and accuracy of numerical solvers for the fokker - planck equation , and to understand their behavior .",
    "it is also of intrinsic theoretical interest , with applications beyond plasma physics , to be able to diagonalize differential operators with continuous spectra .",
    "existing algorithms for computing spectral density functions of singular sturm - liouville problems employ either a domain truncation technique ( accelerated by richardson extrapolation ) @xcite , or use formulas for the density function @xcite that avoid domain truncation but only apply to sturm - liouville problems in standard form , @xmath19 .",
    "further details about both approaches are given in sections  [ sec : comp ] and  [ sec : compare ] , and in @xcite .",
    "while it is always possible to reduce to standard form via the liouville transformation @xcite , it is often preferable to work with the most physically relevant variables .",
    "our idea is to turn weyl s original construction @xcite into a numerical algorithm by complexifying the spectral parameter @xmath20 and extrapolating the titchmarsh - weyl @xmath0-function to the real axis using chebyshev interpolating polynomials . in more detail , when @xmath21 is complex , @xmath22 $ ] is the limiting ratio of two solutions of @xmath23 .",
    "we show that this limit converges exponentially fast relative to the work required to compute the solutions @xmath24 and @xmath25 , with a decay rate proportional to @xmath26 ( as a function of work ) .",
    "making use of arbitrary - order ode solvers and interpolation methods , the cost of the new algorithm for computing the spectral density function @xmath27 to a tolerance @xmath28 grows slower than @xmath29 ( for any @xmath30 ) as @xmath31 .",
    "proving this requires precise information about the asymptotic behavior of solutions of @xmath23 for large @xmath32 .",
    "we present a wkb analysis in appendix  [ sec : asym ] and a proof of analyticity of @xmath33 in appendix  [ sec : analytic ] for the sturm - liouville operator associated with ( [ eq : u : intro ] ) .",
    "in addition to developing a new algorithm for computing spectral density functions of singular sturm - liouville problems of the form @xmath23 , we show how to use them to evaluate the solution of @xmath34 at any later time . through appropriate changes of variables ,",
    "the spectral transform of the solution , @xmath35 , can be represented accurately and concisely as a trigonometric polynomial .",
    "the solution @xmath36 in physical space is then expressed as an oscillatory integral in @xmath21 . for some initial conditions , the spectral transform @xmath35 decays exponentially in @xmath21 for @xmath37 but only algebraically at @xmath38 .",
    "thus , with limited computational resources , the solution of @xmath34 often can not be resolved to the desired level of accuracy until @xmath39 surpasses a critical value , @xmath40 , where the decay rate of @xmath41 becomes fast enough .    remarkably , the same is true of the projected dynamics in some spaces of orthogonal polynomials @xcite . for singular initial conditions ,",
    "the projected dynamics is a poor approximation of the true solution initially , regardless of which space of polynomials is used to represent the solution .",
    "however , the true solution will generally return ( very nearly ) to the space once @xmath39 exceeds some @xmath40 .",
    "for the class of orthogonal polynomials introduced by shizgal @xcite and landreman and ernst @xcite , the true solution agrees with the projected dynamics to 29 digits of accuracy for @xmath42 ( in quadruple - precision arithmetic ) .",
    "by contrast , for classical hermite polynomials , it only agrees to 23 digits of accuracy for similar computational work .",
    "thus , in one case the projected dynamics evolves to the correct state when @xmath39 reaches @xmath40 , while in the other case it does not .",
    "the methods of the current paper were developed in order to quantify these errors and understand these results .",
    "our goal is to develop a spectral representation for solutions of the pde ( [ eq : u : intro ] ) . for notational convenience , we will use the variable @xmath32 instead of @xmath15 for the speed coordinate . the equation",
    "may then be written @xmath43 ,    \\qquad ( x>0,\\;t>0),\\end{aligned}\\ ] ] where @xmath44 , \\qquad    { { \\operatorname}{erf}}(x ) = \\frac{2}{\\sqrt{\\pi}}\\int_0^x e^{-s^2}\\,ds.\\end{aligned}\\ ] ] several properties of @xmath45 , which differs from the chandrasekhar function @xmath46 in the introduction by a factor of @xmath32 , are established in lemma  [ lem : psi ] of appendix  [ sec : lem ] .",
    "in particular , @xmath47 , @xmath48 , @xmath45 is monotonically decreasing for @xmath49 , and @xmath50 as @xmath51 .",
    "furthermore , it is clear that as the ratio of two odd functions , @xmath45 is even .",
    "we begin by transforming ( [ eq : u ] ) to a self - adjoint system .",
    "let @xmath52 then @xmath53 satisfies @xmath54 where @xmath55 and the prime symbol stands for the derivative with respect to @xmath32 .",
    "the domain @xmath56 of @xmath57 can be characterized precisely ( see @xcite and  [ sec : green ] ) , but it is difficult to show that @xmath57 is symmetric on all of @xmath56 directly .",
    "thus , initially , we will work with the set @xmath58 of bounded , @xmath59 functions on @xmath60 with two bounded derivatives .",
    "such functions extend continuously to @xmath61 with finite limiting value and slope . since @xmath62 where @xmath63",
    ", we see that the ( densely defined ) restriction operator @xmath64 is symmetric on the hilbert space @xmath65 @xmath57 is defined as the graph closure of @xmath66 , which exists since @xmath66 is symmetric .",
    "a well - known theorem @xcite asserts that @xmath57 is self - adjoint iff @xmath67 and @xmath68 are dense in @xmath69 , which may be proved by construction of a green s function ( see  [ sec : green ] ) .",
    "we note that @xmath58 must be small enough that @xmath66 is symmetric but large enough that @xmath58 and @xmath70 are dense in @xmath69 . for singular sturm - liouville operators ,",
    "this boils down to imposing the correct boundary conditions at the endpoints .",
    "the operator @xmath57 in ( [ eq : pde ] ) is singular at @xmath61 since @xmath71 , and at @xmath72 since the domain is unbounded .",
    "we now show that @xmath57 is of limit circle type at @xmath61 and limit point type at @xmath72 @xcite . to classify the endpoints",
    ", we study the behavior of solutions of @xmath73 as @xmath74 and @xmath51 . when @xmath75 , the general solution is @xmath76 the integrand may be expanded in a laurent series about @xmath77 to obtain @xmath78 thus , @xmath79 since @xmath80 belongs to @xmath69 in ( [ eq : h ] ) , all solutions of ( [ eq : eval ] ) are square - integrable on @xmath81 with weight function @xmath82 when @xmath75 .",
    "theorem @xcite states that this is true for all @xmath83 if it is true for one @xmath21 .",
    "thus , the limit circle case prevails at @xmath61 .",
    "the situation is different at @xmath72 .",
    "since @xmath84 , there is an @xmath85 such that @xmath86 it follows that @xmath87 in ( [ eq : u : lam0 ] ) with @xmath88 and @xmath89 satisfies @xmath90 for @xmath91 .",
    "the function on the right is not square integrable on @xmath92 with weight function @xmath82 , so neither is @xmath53 and the limit point case prevails at @xmath72 .",
    "the limit circle case requires a boundary condition .",
    "it suffices for this to require that solutions of @xmath23 remain bounded at @xmath61 .",
    "however , a linearly independent solution ( that blows up at the origin ) must also be computed to evaluate the titchmarsh - weyl @xmath0-function , and both of these solutions grow rapidly as @xmath51 .",
    "thus , it is convenient to rescale @xmath53 and its derivative to avoid overflow in numerical computations .",
    "we define @xmath93 and note that @xmath53 belongs to @xmath69 iff @xmath94 . in terms of @xmath95 and @xmath96 ,",
    "the ode ( [ eq : eval ] ) can be rewritten as @xmath97 which has a singularity of the first kind @xcite at @xmath61 .",
    "formal series solutions of ( [ eq : y : ode ] ) are therefore convergent , yielding actual solutions . in the present case , the solution may be expanded in a taylor series , though other problems may require the use of more general frobenius series or logarithmic sums to obtain a formal solution @xcite .",
    "since @xmath98 is even , we see that @xmath99 $ ] where @xmath100 .",
    "it is therefore natural to construct a fundamental matrix with one column even and the other odd : @xmath101 matching terms yields @xmath102 where @xmath103 is the @xmath104 identity matrix .",
    "since the eigenvalues of @xmath105 are 0 and 1 , nontrivial vectors @xmath106 and @xmath107 exist , which are defined up to multiplicative factors .",
    "once these factors are chosen , the higher order coefficients @xmath108 and @xmath109 are uniquely determined from the recursion relationships given above .",
    "the leading terms are @xmath110 the arbitrary constants were chosen so that @xmath111 = \\psi w(u_0u_1 ' - u_1u_0 ' ) = \\frac{1}{x}\\det\\phi(x ) \\equiv 1,\\ ] ] where @xmath112 , @xmath113 , ( @xmath114 ) , and @xmath115 is the wronskian determinant . the general solution @xmath116 reduces to ( [ eq : u : lam0 ] ) when @xmath75 .",
    "note that @xmath117 is analytic in a complex neighborhood of @xmath61 , i.e.  ( [ eq : y : ode ] ) has only an apparent singularity @xcite at @xmath61 .",
    "the determinant of a fundamental matrix is always zero at an apparent singularity , which is true in our case as @xmath118 .",
    "an alternative first - order system using @xmath87 and @xmath119 as components would yield a fundamental matrix with a pole at @xmath61 .",
    "another alternative in which @xmath120 is replaced by @xmath121 yields the equation @xmath122 which is self - adjoint and regular at the origin , alleviating the need for initialization with series solutions .",
    "this advantage comes at the cost of @xmath123 being more expensive to evaluate than @xmath124 in ( [ eq : y : ode ] ) due to the additional @xmath125 term .",
    "we also note that the formulas for @xmath45 and @xmath125 in ( [ eq : y : ode : intro ] ) are numerically unstable near the origin , and have to be computed with a series for small @xmath32 anyway .      for any @xmath83 with @xmath126",
    ", we can construct a green s function for @xmath127 .",
    "we seek an operator @xmath128(x)= \\int_0^\\infty g(x,\\xi;\\lambda)f(\\xi)w(\\xi)\\,d\\xi$ ] that satisfies @xmath129 for a wide class of functions @xmath53 and @xmath130 , which we characterize in detail below .",
    "the key to the construction is to identify the complex number @xmath131 , unique in the limit point case , for which @xmath132 although @xmath133 has a simple pole at @xmath61 for all @xmath21 , it is square integrable on @xmath81 because @xmath134 .",
    "thus , @xmath131 is determined by the behavior of @xmath24 and @xmath25 as @xmath51 . indeed , when @xmath135",
    ", one may show @xcite that the set of complex numbers @xmath136 for which @xmath137 satisfies @xmath138 forms a nested family of circles ( parametrized by @xmath139 ) in the upper half - plane that converge to @xmath131 as @xmath140 .",
    "the parameter @xmath139 is independent of @xmath141 , @xmath0 and @xmath21 , and represents a general self - adjoint boundary condition that could be imposed at the right endpoint if the domain were truncated to the finite interval @xmath142 $ ] .",
    "taking @xmath143 , we have @xmath144 note that this also holds for @xmath145 , the only difference being that the nested family of circles are then in the lower half - plane .",
    "once @xmath131 and @xmath146 are known , the green s function may be written @xmath147 suppressing @xmath21 to simplify the notation , we have @xmath148 if @xmath130 is continuous on @xmath60 and belongs to @xmath69 , it follows from ( [ eq : gf ] ) and the wronskian identity that @xmath149 has two continuous derivatives on @xmath60 and satisfies @xmath150 , where @xmath127 is applied pointwise as a differential operator .",
    "it follows that @xmath151 from  [ sec : problem ] has dense range for @xmath126 , i.e.  @xmath66 is essentially self - adjoint . in more detail",
    ", let @xmath152 be the set of continuous functions @xmath130 with compact support that satisfy @xmath153 . if @xmath154 , then @xmath155 ( defined in  [ sec : problem ] ) and @xmath156 ( already shown ) .",
    "moreover , @xmath152 is dense in @xmath69 . in particular , the `` orthogonality '' condition @xmath157 does not preclude density as @xmath158 .",
    "in fact , if @xmath159 is any function for which @xmath160 is finite , then @xmath160 can be adjusted to zero with a continuous , compactly supported perturbation to @xmath130 of arbitrarily small @xmath69-norm .",
    "we leave the details to the reader .",
    "we now characterize the domain @xmath56 of @xmath57 .",
    "the formula ( [ eq : gf ] ) is well - defined for @xmath159 ( still assuming @xmath126 ) .",
    "its derivative exists almost everywhere , where it equals @xmath161 , which is locally absolutely continuous .",
    "thus , @xmath162 is actually differentiable everywhere , and @xmath163 almost everywhere .",
    "we claim @xmath164 , i.e.  @xmath165 is bounded .",
    "this can be seen as follows .",
    "let @xmath166 in @xmath69 with @xmath167 .",
    "a standard argument @xcite using the symmetry of @xmath66 shows that @xmath168 .",
    "since @xmath169 is a cauchy sequence , it converges to some @xmath170 with @xmath171 .",
    "it also converges pointwise to @xmath162 , by ( [ eq : gf ] ) . as a result , @xmath172 a.e .",
    ", as required .",
    "in addition to belonging to @xmath69 , @xmath162 remains finite as @xmath173 .",
    "indeed , the first term on the right - hand side of ( [ eq : gf ] ) approaches zero since @xmath174 and the integral is bounded by @xmath175 , which is finite . by uniqueness of the solutions of @xmath150 with @xmath176 and @xmath53 bounded near the origin ,",
    "the range @xmath56 of @xmath165 consists precisely of those functions @xmath176 with a locally absolutely continuous derivative such that @xmath177 .",
    "moreover , ( [ eq : gl : inv ] ) holds for all @xmath178 , @xmath159 , @xmath179 .",
    "this set @xmath56 , which is independent of @xmath21 , is the domain of @xmath57 .      from the general theory of singular self - adjoint eigenvalue problems",
    "@xcite , we know that @xmath131 ( and hence the green s function ) is analytic on @xmath180 , with simple poles at the eigenvalues of @xmath57 and a branch cut across the continuous spectrum of @xmath57",
    ". the imaginary part of @xmath131 is positive for @xmath181 , so @xmath131 is a pick - nevanlinna function @xcite .",
    "any such function can be represented in the canonical form @xcite @xmath182 where @xmath183 , @xmath184 is real , and @xmath185 is a non - decreasing , real - valued function such that @xmath186 . using the fact from  [ sec : green ] that @xmath187 , one may show @xcite that @xmath188 . setting @xmath20 ,",
    "the imaginary part of ( [ eq : m : diff ] ) yields @xmath189 an expression for @xmath190 as a function of @xmath191 can be derived from ( [ eq : poisson ] ) . integrating ( [ eq : poisson ] ) from @xmath192 to @xmath193 ,",
    "one finds @xmath194d\\rho(s)$ ] on the right - hand side of the equation . taking the limit as @xmath195 , this integrand approaches @xmath196 for @xmath197 and 0 outside this range .",
    "it is also positive and bounded by @xmath198 $ ] for @xmath199 and @xmath200 .",
    "thus , by the dominated convergence theorem , @xmath201 at points of continuity @xmath192 , @xmath202 of @xmath190 . moreover , there is a 1 - 1 norm - preserving correspondence between @xmath203 and @xmath204 , where one function may be obtained from the other by the relations @xcite @xmath205 the second integral defines @xmath206 , the first gives the inversion formula , and @xmath207 . as with the fourier transform , if @xmath130 or @xmath208 belongs to @xmath209 but not @xmath210 , then the integrals in ( [ eq : fhat ] ) must be defined through a limiting procedure , e.g.  by multiplying @xmath130 or @xmath211 by the characteristic function supported on @xmath212 $ ] and letting @xmath213 .",
    "equivalently , the integrals may be regarded as improper integrals rather than lebesgue integrals over the whole integration domain ; see @xcite for precise statements .",
    "since the transform pair ( [ eq : fhat ] ) preserves the @xmath209 norm , the jump discontinuities of @xmath190 are precisely the eigenvalues of @xmath57 , and the size of the jump at the @xmath214th eigenvalue is @xmath215 .",
    "we note that all eigenvalues are simple since any solution of @xmath216 that is not a multiple of @xmath217 will blow up as @xmath218 . since @xmath219 is bounded in the upper half - plane , standard arguments @xcite show that @xmath220 exists and is finite for a.e .",
    "decomposing @xmath222 into absolutely continuous and singular components , it follows from ( [ eq : poisson ] ) that for a.e .",
    "@xmath221 , @xmath223 and @xmath224 is supported on the set @xmath225 ; see @xcite .",
    "while examples can be constructed in which @xmath224 has a singular continuous component @xcite , the usual situation @xcite is that @xmath224 has a pure point spectrum and @xmath185 is absolutely continuous between eigenvalues . in that case , if there are no eigenvalues between @xmath226 and @xmath227 , ( [ eq : m : diff ] ) may be written as a cauchy integral @xmath228 the function @xmath229 , which includes @xmath184 and the remaining portions of the integral in ( [ eq : m : diff ] ) , is analytic in the upper and lower half - planes as well as in the disk @xmath230",
    ". we will show in appendix  [ sec : analytic ] that for @xmath57 in ( [ eq : pde ] ) , @xmath33 is real - analytic ( for @xmath231 ) .",
    "thus , if the radius of convergence of @xmath33 at @xmath232 exceeds @xmath6 , then the contour from @xmath226 to @xmath227 along the real axis in ( [ eq : m : cauchy ] ) can be deformed to the semicircle @xmath233 in the lower half - plane , and @xmath131 has an analytic continuation from the upper half - plane to @xmath233 .",
    "this leads to rapid convergence of polynomial extrapolation methods from the upper half - plane to the real axis , as we will see in section  [ sec : length ] .",
    "note that for @xmath234 , @xmath235(x,\\xi;\\lambda)$ ] , where @xmath236 $ ] is the jump in the green s function across the real @xmath21 axis .",
    "some authors @xcite make use of this in deriving the transform pair ( [ eq : fhat ] ) .",
    "it is also useful to know that @xmath237 at points of continuity of @xmath190 , where @xmath238 is the spectral density function for the eigenvalue problem @xmath23 over the finite interval @xmath239 with appropriate boundary conditions .",
    "each @xmath238 is a right - continuous step function with arbitrary additive constant chosen ( in our case ) so that @xmath240 for @xmath241 .",
    "the operator @xmath57 in ( [ eq : pde ] ) has only one eigenvalue , @xmath242 .",
    "the corresponding eigenvector is @xmath243 , which has norm @xmath244 .",
    "there are no negative eigenvalues since @xmath245 . in appendix",
    "[ sec : asym ] , we show that the asymptotic behavior of the general solution of ( [ eq : y : ode ] ) for @xmath231 and @xmath246 has the form @xmath247",
    "-\\theta \\big\\ }    + o(x^{-11/4 } ) ,    \\end{aligned}\\ ] ] where @xmath248 and @xmath249 are constants determined by the initial conditions .",
    "thus , @xmath250 does not belong to @xmath251 , @xmath252 does not belong to @xmath69 , and there are no positive eigenvalues .",
    "moreover , a green s function does not exist for @xmath231 since there is no @xmath131 for which ( [ eq : weyl : m ] ) holds ; thus , the continuous spectrum includes @xmath60 .",
    "it actually equals @xmath60 since ( [ eq : m : diff ] ) shows that the green s function is analytic across the real axis in regions where @xmath253 is constant , and @xmath254 for @xmath241 .",
    "alternatively , when @xmath241 , an @xmath131 for which ( [ eq : weyl : m ] ) holds can be constructed explicitly since one of the asymptotic solutions @xmath255 in ( [ eq : asym : u ] ) belongs to @xmath69 .",
    "thus , @xmath165 exists and @xmath127 has a bounded inverse when @xmath241 .",
    "plots of @xmath250 and the error in the asymptotic approximation ( [ eq : asym ] ) are given in figure  [ fig : asym ] for @xmath256 and @xmath257 .",
    "for small @xmath21 , the solution exhibits a rapid growth phase before becoming oscillatory . for larger values of @xmath21 ,",
    "the asymptotic formula ( [ eq : asym ] ) is accurate even for small values of @xmath32 .",
    "the three error curves correspond to the difference between the exact solution ( from solving the ode ) and the asymptotic formula ( [ eq : asym ] ) , truncated at orders @xmath258 , @xmath259 and @xmath260 , respectively .",
    "the amplitude @xmath248 and phase @xmath249 in ( [ eq : asym ] ) were obtained in two stages .",
    "first we computed @xmath261 , @xmath262 by fitting the solution through 201 data points near @xmath263 for @xmath257 and @xmath264 for @xmath256 , with @xmath265 .",
    "then we extrapolated to @xmath72 assuming @xmath266 , @xmath267 .",
    "these values of @xmath248 and @xmath249 were also used for the lower order truncations .",
    "solution @xmath250 for two values of @xmath21 and the error in using the asymptotic formula ( [ eq : asym ] ) and its lower order variants .",
    "the `` exact '' solution was computed using a 50th order fully implicit runge - kutta collocation ( irk ) method in quadruple precision arithmetic .",
    ", title=\"fig : \" ] solution @xmath250 for two values of @xmath21 and the error in using the asymptotic formula ( [ eq : asym ] ) and its lower order variants .",
    "the `` exact '' solution was computed using a 50th order fully implicit runge - kutta collocation ( irk ) method in quadruple precision arithmetic .",
    ", title=\"fig : \" ]    the growth phase observed in fig .",
    "[ fig : asym ] occurs only for @xmath268 , and always begins after the first extremum of @xmath250 .",
    "this is because @xmath123 in ( [ eq : y : ode : intro ] ) is negative near the origin , causing @xmath250 to execute a small half - oscillation before rapid growth begins ( see fig .",
    "[ fig : qplot ] ) . in more detail , @xmath269 satisfies @xmath270 for as long as @xmath271 is positive , the integral is positive and increasing , and @xmath272 ( assuming @xmath231 ) .",
    "thus , by the mean value theorem , @xmath273 for @xmath274 , where @xmath275 is the first zero of @xmath271 .",
    "this zero exists since we can use ( [ eq : u : le:1 ] ) to bound @xmath119 away from zero for @xmath276 $ ] , where @xmath277 is chosen so @xmath278 on @xmath279 $ ] . as a result ,",
    "@xmath280 on @xmath281 , so its first extremum is of modest size .",
    "the second extremum can be much larger in magnitude if @xmath282 .",
    "plots of @xmath123 and @xmath250 , @xmath283 , on a signed log ( i.e.  arcsinh ) scale ( left ) and linear scale ( right ) . since @xmath284",
    ", there is a band of @xmath32 values where @xmath285 . in this region",
    ", @xmath250 grows rapidly as soon as @xmath286 and @xmath287 are both negative , since @xmath288 $ ] remains negative , accelerating the growth rate , until @xmath289 changes sign . decreasing @xmath21 increases the size of the growth region . ]",
    "since the point spectrum of @xmath57 is @xmath290 , the singular continuous spectrum is absent ( see appendix  [ sec : analytic ] ) , and the absolutely continuous spectrum is @xmath60 , the transform pair ( [ eq : fhat ] ) simplifies slightly , and the solution of the pde ( [ eq : pde ] ) with initial condition @xmath291 , @xmath203 , may be written @xmath292    \\frac{y_1(x;\\lambda)}{xy(\\lambda)}[y(\\lambda)\\rho'(\\lambda)]\\,d\\lambda , \\\\",
    "\\label{eq : fhat3 }    \\hat{f}(\\lambda ) & = \\int_0^\\infty \\big [ xe^{-x^2/2}f(x ) \\big ]    y_1(x;\\lambda)\\,dx , \\qquad ( \\lambda\\ge0),\\end{aligned}\\ ] ] where we used @xmath293 and @xmath294 in ( [ eq : fhat ] ) . here",
    "@xmath295 is an arbitrary scale factor that will be used later to account for the rapid initial growth of @xmath250 when @xmath21 is small .",
    "evaluation of @xmath296 is straightforward if @xmath297 decays rapidly ( e.g.  if @xmath130 is a polynomial ) . for a given @xmath21 ,",
    "we just add a third component @xmath298 to @xmath299 in ( [ eq : y : ode ] ) and evolve @xmath300 along with @xmath286 and @xmath301 until @xmath302 is negligible .",
    "the most difficult part of computing the solution @xmath36 via ( [ eq : fhat2 ] ) and ( [ eq : fhat3 ] ) is determining @xmath33 .",
    "a popular approach , implemented in the software package sledge @xcite , is to compute the step function @xmath303 for the regular problem over @xmath239 and let @xmath140 . for problems of the form @xmath304 , more sophisticated methods have recently been developed @xcite that",
    "compute @xmath33 directly , without computing auxiliary functions @xmath238 and taking a limit .",
    "further details are given in ",
    "[ sec : compare ] and @xcite . see also @xcite , which focus on solving @xmath305 when both endpoints are singular .",
    "in addition , @xcite contains a wealth of information on the history of the problem and provides an insightful review of the literature .",
    "there are also many papers on computing eigenvalues and eigenfunctions ( rather than continuous spectra and density functions ) for singular sturm - liouville problems ; see e.g.  @xcite .      rather than approximating @xmath253 by @xmath303 on a truncated domain or searching for specialized formulas for @xmath33 that avoid solving odes with complex @xmath21",
    ", we have developed a simpler approach based directly on ( [ eq : m : lim ] ) and ( [ eq : rho : m ] ) . for a given @xmath231",
    ", we choose a complex line segment @xmath306 of length @xmath307 , @xmath308 and choose @xmath309 collocation points on @xmath306 consisting of nodes of a chebyshev - lobatto quadrature scheme , omitting the node at @xmath310 : @xmath311 ,    \\qquad 1\\le k\\le { n}.\\ ] ] for each @xmath312 , we evaluate @xmath313 by computing the limit ( [ eq : m : lim ] ) .",
    "we do this by evolving @xmath314 and @xmath315 simultaneously using an arbitrary ( e.g.  50th ) order fully implicit runge - kutta collocation ( irk ) method @xcite in double or quadruple - precision arithmetic .",
    "as shown in appendix  [ sec : asym ] , there exist two solutions of ( [ eq : y : ode ] ) of the form @xmath316\\ ] ] for @xmath246 , where @xmath317 and @xmath318 are defined in ( [ eq : pq : def ] ) and approach 1 as @xmath51 .",
    "since @xmath319 is positive , @xmath320 decays super - exponentially as @xmath51 while all other linearly independent solutions grow .",
    "the function @xmath321 is guaranteed to grow super - exponentially since decaying would cause the corresponding @xmath25 to be an eigenfunction of @xmath57 .",
    "the same is true of @xmath322 since there is a related self - adjoint boundary value problem in which @xmath24 would then be an eigenfunction . the limit ( [ eq : m : lim ] ) emerges when the decaying mode in @xmath322 and @xmath321 becomes negligible in comparison to the growing mode .",
    "quantitatively , ( [ eq : y : asym : cx ] ) gives an asymptotic estimate for the rate of convergence of @xmath323 to @xmath0 .",
    "expressing @xmath324 for @xmath114 , we have @xmath325\\ ] ] for @xmath246 . here",
    "we used the fact that @xmath326 and @xmath327 , as explained above , as well as the estimate @xmath328 when @xmath329 , and @xmath330e^ {      -{\\operatorname{im}}\\big\\ {      ( 4/5)\\sqrt{2\\lambda_k}\\big[p_1(x;\\lambda_k ) - 1\\big]\\big\\}x^{5/2}},\\ ] ] which converges to zero as @xmath51 since @xmath331= \\frac{5x^{3/2}}{12}\\big[-\\lambda_k^{-1/2}+o(x^{-1})\\big]$ ] , so its imaginary part approaches @xmath332 as @xmath51 ( since @xmath333 ) .",
    "we conclude that the relative error in approximating @xmath313 by @xmath334 decays extremely rapidly , faster than @xmath335 , as @xmath51 .    since this asymptotic estimate for the convergence rate only applies for large @xmath32 , it is useful to develop an estimate for the error that can be monitored as the solution is evolved numerically .",
    "we find that the number of digits in @xmath336 that remain frozen as @xmath32 increases is roughly the same as the number of correct digits in the numerically computed wronskian .",
    "thus , we use the stopping criterion that @xmath337 - 1|$ ] in ( [ eq : w ] ) exceeds 1 . at this point , @xmath338 and @xmath339 in ( [ eq : fund : mat ] )",
    "are linearly dependent to machine precision and continuing further in the evaluation of the limit ( [ eq : m : lim ] ) does more harm than good due to additional roundoff errors .",
    "note that loss of accuracy in the wronskian does not mean @xmath340 and @xmath286 are inaccurate ; the catastrophic cancellation of digits occurs when the determinant of @xmath341 is computed .",
    "once @xmath313 is known for each @xmath312 in ( [ eq : cheb : pts ] ) , we compute the interpolating polynomial @xmath342 satisfying @xmath343 and evaluate @xmath344 to approximate @xmath345 . the results of this `` naive '' algorithm , and the improved version described in  [ sec : split ] below , are shown in figure  [ fig : rho ] , where we computed @xmath33 at 768 values of @xmath21 of the form @xmath346 when @xmath21 decreases below @xmath347 , @xmath33 begins to decrease rapidly and typical values of @xmath250 grow very large . to account for this , we introduced a scale factor @xmath295 in ( [ eq : fhat2 ] ) , which we define as @xmath348 where @xmath349 is the first negative extremum of @xmath250 , computed using newton s method to solve @xmath350 for @xmath32 , which occurs when @xmath351 .",
    "for example , in figure  [ fig : asym ] , @xmath352 while @xmath353 .",
    "the reason we use the first negative extremum ( rather than the positive one that precedes it ) was explained in figure  [ fig : qplot ] .",
    "plots of the real and imaginary parts of @xmath354 , the spectral density function @xmath33 , and its re - scaled version , @xmath355 , which is used in ( [ eq : fhat2 ] ) to represent @xmath36 .",
    "roundoff errors in the naive algorithm are amplified to unacceptable levels when re - scaled . ]",
    "the poor scaling of @xmath250 poses a problem in the reconstruction of the solution via ( [ eq : fhat2 ] ) .",
    "roundoff errors in @xmath33 near @xmath356 in double - precision and @xmath357 in quadruple - precision are amplified to large values by @xmath295 when @xmath21 is small enough .",
    "fortunately , we are able to improve the algorithm to achieve small _ relative _ errors in @xmath33 .",
    "let us complexify @xmath21 again and write @xmath20 with @xmath358 fixed .",
    "we wish to compute @xmath359 .",
    "first , we write the fundamental matrix in ( [ eq : fund : mat ] ) as a product , @xmath360 where @xmath361 is the location of the first negative extremum of @xmath362 , which is independent of @xmath363 , and @xmath364 is another fundamental matrix for ( [ eq : y : ode ] ) , evolved from the identity at @xmath365 . by analogy with ( [ eq : fund : mat ] )",
    ", we denote the entries of @xmath366 by @xmath367 , @xmath368 , @xmath369 , @xmath370 .",
    "when @xmath371 , the limit ( [ eq : m : lim ] ) exists and we find from ( [ eq : xstar ] ) that @xmath372 since @xmath373 is invertible , the numerator and denominator can not both be zero , so the limit exists in the extended complex plane .",
    "it is in fact finite , for @xmath374 is the @xmath0-function ( multiplied by @xmath375/x^*$ ] ) for the eigenvalue problem @xmath23 on @xmath376 with dirichlet boundary conditions at the left endpoint .",
    "moreover , @xmath377 exists ( since @xmath378 does ) , and is given by the final formula of ( [ eq : mtil ] ) with @xmath131 replaced by @xmath378 and @xmath21 replaced by @xmath191 in @xmath340 , @xmath286 @xmath379 , @xmath301 .",
    "next , since @xmath380 , the singular value decomposition of @xmath381 has the form @xmath382 where @xmath383 , @xmath384 and @xmath385 . we know that if the first singular value is @xmath386 the second singular value must be @xmath387 because the wronskian is equal to 1 .",
    "this is convenient because the larger singular value @xmath386 can be computed accurately while the smaller one may be severely corrupted by roundoff error . in our algorithm , we ignore the computed version of the smaller singular value and assume it equals @xmath387 instead .",
    "combining ( [ eq : phi : star ] ) with ( [ eq : mtil ] ) , we obtain @xmath388 where @xmath389 , @xmath390 , and @xmath340 , @xmath379 , @xmath286 and @xmath301 are evaluated at @xmath391 . the resulting formula @xmath392      -\\frac{1}{\\pi}{\\operatorname{im}}\\left\\ {      \\frac{1+\\beta^{-2}}{\\alpha^{-2}\\mu+\\beta^{-1 } } \\right\\ } , & |\\beta|>1 ,    \\end{cases}\\ ] ] avoids the cancellation of digits that occurs if @xmath393 is large and @xmath0 is not simplified in ( [ eq : m : clever ] ) to separate out the @xmath394 ( or @xmath395 ) term .",
    "the choice of @xmath361 as the first negative extremum of @xmath362 ensures that @xmath381 captures the growth phase of @xmath362 observed in figures  [ fig : asym ] and  [ fig : qplot ] . as a result , @xmath364 begins as the identity matrix in the oscillatory phase of the ode , where growth is due to @xmath21 being complex rather than all solutions growing .",
    "this causes @xmath396 in the improved algorithm to be more accurately computed than @xmath0 in the naive algorithm .",
    "another advantage of the split ( [ eq : xstar ] ) is that @xmath21 can be set to @xmath191 when computing @xmath373 since it does not depend on @xmath32 .",
    "of course , @xmath21 must remain complex in @xmath364 since the limits @xmath51 and @xmath195 do not commute .",
    "we remark that if @xmath120 is replaced by @xmath121 and @xmath117 is evolved according to @xmath397 with @xmath398 as in ( [ eq : y : ode : intro ] ) , then @xmath399 , rather than @xmath361",
    ". formulas ( [ eq : phi : star])([eq : rho : clever ] ) remain unchanged , except that @xmath400 should be omitted from the diagonal in ( [ eq : phi : star ] ) .",
    "this technique of computing @xmath33 with high relative accuracy works generally , and is not tied to @xmath57 in ( [ eq : pde ] ) .",
    "any convenient choice of @xmath361 can be used as long it is in the `` oscillatory '' region where the solution grows due to @xmath21 being complex . to compute @xmath6 , @xmath141 , @xmath401 , @xmath402 , @xmath393 and @xmath403 ,",
    "one may use any first order system @xmath404 that is equivalent to @xmath23 , provided the first component of @xmath405 is a multiple of @xmath53 .",
    "( in our case , @xmath406 with @xmath407 . ) the abel - liouville formula @xmath408 will determine the factor to include with @xmath393 and @xmath409 in ( [ eq : phi : star ] ) .",
    "typically , as in ( [ eq:1st : order : alt ] ) , @xmath410 and the factor is 1 .      in the improved algorithm",
    ", we need to compute @xmath411 for @xmath231 .",
    "this is done with an interpolating polynomial @xmath342 , just as in ( [ eq : q : interp ] ) , but matching @xmath412 instead of @xmath313 at @xmath262 .",
    "as in ( [ eq : cheb : pts ] ) , @xmath21 is now real while @xmath413 , @xmath414 , are complex",
    ". we will show in this section that the cost of computing @xmath415 for @xmath416 is dominated by the @xmath417 term , regardless of @xmath309 , and determine the parameters @xmath418 and @xmath309 to best take advantage of the super - exponential rate of convergence of @xmath419 to @xmath420 .",
    "writing @xmath421 for @xmath114 , we obtain ( [ eq : rate ] ) again , but with tildes placed over @xmath340 , @xmath286 , @xmath422 , @xmath423 and @xmath0 .",
    "the coefficients @xmath424 are determined from the initial condition @xmath425 by solving @xmath426 where @xmath427 $ ] and we have dropped @xmath312 to simplify the notation , since it is fixed in this discussion .",
    "we emphasize that @xmath428 are exact solutions of the ode ( [ eq : y : ode ] ) for which @xmath429 have the form ( [ eq : y : asym : cx ] ) for @xmath430 .",
    "as before , the coefficients @xmath431 must be non - zero since there are self - adjoint boundary - value problems , this time on @xmath376 , for which @xmath432 or @xmath433 would be an eigenfunction with complex eigenvalue if it were a multiple of @xmath434 , the solution that decays as @xmath51 .",
    "in other words , neither @xmath435 nor @xmath436 can ever vanish since @xmath437 .",
    "the same conclusions hold if we define @xmath438 in ( [ eq : match : ypm ] ) and use ( [ eq : y : ode : intro ] ) and ( [ eq:1st : order : alt ] ) to evolve the solution instead of ( [ eq : y : ode ] ) .",
    "the growing solution , @xmath439 , is not uniquely determined .",
    "adding any multiple of @xmath435 will not affect the asymptotics of @xmath439 as @xmath51 .",
    "thus , we may assume that the columns of @xmath440 above are orthogonal to each other .",
    "also , @xmath441 is unchanged if we replace @xmath442 by @xmath443 and @xmath248 by @xmath444 , where @xmath56 is diagonal .",
    "thus , we may assume @xmath440 and @xmath248 are orthogonal matrices in ( [ eq : match : ypm ] ) if we allow @xmath445 and @xmath446 to be of the form ( [ eq : y : asym : cx ] ) up to constant factors .",
    "the signs can be arranged ( via @xmath56 ) so that @xmath447 , @xmath448 , @xmath449 , and @xmath450 .",
    "the argument of ( [ eq : rate ] ) then gives the relative error estimate @xmath451 } \\big),\\ ] ] where @xmath452 the first inequality in ( [ eq : rate2 ] ) is valid once @xmath453 .",
    "note that @xmath454 is the ratio of the magnitudes of the decaying and growing solutions if both are scaled to equal 1 at @xmath365 , and if the growing solution is chosen to be orthogonal to the decaying solution at @xmath365 .",
    "the @xmath455 term in ( [ eq : rate2 ] ) accounts for the fact that the error is @xmath456 when @xmath365 .",
    "it is not strictly necessary , but avoids hiding a large constant in the @xmath457 notation that would delay its convergence to zero .",
    "as mentioned already , @xmath458 and @xmath459 are guaranteed to be nonzero , so @xmath460 is finite .",
    "the results of figure  [ fig : cheb ] below show that @xmath461 for @xmath462 and remains less than 3000 if @xmath21 is decreased to @xmath463 , assuming @xmath464 is small enough that @xmath465 is similar in size to @xmath466 .      in appendix",
    "[ sec : step : bound ] , we show that the number of steps required to evolve ( [ eq : y : ode ] ) or ( [ eq : y : ode : intro ] ) at @xmath312 from @xmath275 to @xmath467 using a @xmath468-stage runge - kutta collocation method of order @xmath469 while maintaining a bound of @xmath28 on the local truncation error satisfies @xmath470 here @xmath471 , @xmath472 , and @xmath473 was assumed to obtain these particular constants .",
    "for the complexity analysis , it is convenient to decouple @xmath361 from the location where @xmath474 achieves its second extremum .",
    "instead , we set @xmath475 this change has little effect on the running time of the algorithm , but is easier to analyze .",
    "recall that we evolve to @xmath361 with @xmath21 real to get past the growth phase , then complexify @xmath476 and evolve from @xmath361 until @xmath323 converges to @xmath415 .",
    "as shown in figure  [ fig : qplot ] above , the growth phase occurs in the band of @xmath32 values for which @xmath477 .",
    "this band only exists when @xmath478 , and ends well before @xmath32 reaches @xmath479 , since @xmath480 for @xmath481 .",
    "thus , ( [ eq : xstar2 ] ) is sufficient to traverse the growth phase , when it exists .    combining ( [ eq : n : steps ] ) and ( [ eq : xstar2 ] ) and making use of @xmath482 for @xmath481 , @xmath483 , we find that the number of steps required to evolve from @xmath361 to @xmath32 is bounded by @xmath484,\\ ] ] where we used @xmath485 when @xmath486 and @xmath487 when @xmath488 and @xmath489 .",
    "an additional @xmath490 steps are required to evolve from 0 to @xmath361 .",
    "we see from ( [ eq : rate2 ] ) that for small enough @xmath28 , the relative error in estimating @xmath403 by @xmath492 will be less than @xmath28 if @xmath493\\bigg).\\ ] ] here we rely on surpassing the point beyond which @xmath494 in ( [ eq : rate2 ] ) .",
    "equivalently , @xmath454 and @xmath460 in ( [ eq : kappa : eps ] ) must satisfy @xmath495 by the time @xmath496 reaches @xmath497 .",
    "this happens rapidly since @xmath498 converges to zero super - exponentially in spite of the rapid growth of @xmath499 , as in ( [ eq : yp : ym : rate ] ) . combining ( [ eq : n : steps2 ] ) and ( [ eq : evolve : to ] ) , the number of steps required to achieve a relative error of @xmath28 satisfies @xmath500 we see that for fixed @xmath28 , @xmath501 is a function of @xmath502 , and , to leading order , scales inversely with it . retaining only this leading term , which is particularly accurate for those @xmath262 closest to zero ( which matter most )",
    ", we can estimate the total cost ( in steps ) of computing @xmath503 , ",
    ", @xmath504 : @xmath505 the final equality follows from observing that the polynomial @xmath506 satisfies @xmath507 and @xmath508 . setting @xmath509 ,",
    "we find ( from the choice of the @xmath262 in ( [ eq : cheb : pts ] ) as chebyshev - lobatto nodes ) that @xmath510 .",
    "this gives @xmath511 which evaluate to @xmath512 and @xmath513 , respectively .",
    "the result ( [ eq : cost ] ) follows from @xmath514=(2{n}^2 + 1)/3 $ ] .",
    "it is worth noting that @xmath515 $ ] also grows quadratically for large @xmath309 .",
    "a series expansion shows that @xmath516(2{n}^2 + 1)\\big)>0 $ ] for @xmath517 .",
    "thus , the ratio of @xmath518 to @xmath519 decreases monotonically from 1 ( at @xmath520 ) to @xmath521 ( as @xmath522 ) .",
    "this shows that for @xmath517 , the cost of computing @xmath523 is more than @xmath524 of the total cost of computing @xmath415 at all the collocation points along the complex line segment @xmath306  the closest point to the real @xmath21 axis dominates the others .      as explained in section  [ sec : spec : tr ] ,",
    "if @xmath185 is real analytic at @xmath525 , then @xmath526 can be analytically continued from the upper half - plane to a disk of radius @xmath6 centered at @xmath21 . by ( [ eq : mtil ] ) , the same is true of @xmath527 .",
    "thus , there exists @xmath528 such that @xmath529 is analytic and bounded in the region @xmath184 bounded by the bernstein ellipse @xcite @xmath530 which encloses @xmath306 , has foci at its endpoints , and has semi - major and semi - minor axes equal to @xmath531 and @xmath532 , respectively . in particular , it is not hard to show that the choice @xmath533 causes @xmath534 to cross the real @xmath535-axis at @xmath536 and to remain strictly above the semicircle @xmath537 .",
    "we regard @xmath418 as a free parameter of the method and @xmath6 as a property of the operator @xmath57 : it is the ( effective ) radius of convergence of @xmath538 at @xmath539 .",
    "note that @xmath6 , @xmath540 and @xmath96 here are not related to those in ( [ eq : phi : star ] ) , ( [ eq : y : ode ] ) and ( [ eq : evolve : to ] ) . from ( [ eq : rho : from : a ] )",
    ", we see that @xmath541 for @xmath542 and @xmath543 for @xmath544 .",
    "the significance of @xmath540 is that the chebyshev coefficients of @xmath545 decay like @xmath546 , i.e. we can write @xmath547 where the @xmath548 are chebyshev polynomials and @xmath549 ; ( see @xcite ) . let @xmath550 be the polynomial of degree @xmath309 that interpolates the value of @xmath551 at @xmath552 ( including @xmath553 ) .",
    "then @xmath554 and the chebyshev coefficients of @xmath555 satisfy @xmath556 , due to aliasing @xcite .",
    "the polynomial @xmath342 of degree @xmath557 that interpolates @xmath403 at @xmath558 differs from @xmath550 by a multiple of the lagrange polynomial @xmath559 the multiple is chosen to reduce the degree of @xmath550 by one , i.e.  @xmath560 . as a result , @xmath561 in addition to this bound on the extrapolation error , we find that the chebyshev coefficients of @xmath562 agree closely with those of @xmath563 : @xmath564 where we used @xmath565 , which is bounded by @xmath566 .",
    "plots of @xmath567 and the magnitudes of the chebyshev coefficients @xmath568 used to compute @xmath411 .",
    "the points at left are color coded to correspond to two curves at right , one for each type of machine precision used to compute it .",
    "the interval lengths @xmath418 in ( [ eq : sigma : opt ] ) were chosen so the chebyshev coefficients decay just fast enough to reach machine precision at @xmath569 .",
    "the inset at left shows the optimal bernstein ellipse with @xmath570 . ]",
    "figure  [ fig : cheb ] confirms that the chebyshev modes of @xmath342 decay exponentially , as predicted from @xmath571 and ( [ eq : qj : err ] ) .",
    "the function @xmath411 computed here corresponds to @xmath361 as defined in ",
    "[ sec : split ] rather than the simplified version in ( [ eq : xstar2 ] ) .",
    "we find empirically that with @xmath572 collocation points , the segment lengths @xmath573 are close to optimal over a wide range of @xmath21 values . indeed , for each @xmath21 in the range computed in figure  [ fig : cheb ] ( @xmath574 ) , the chebyshev modes @xmath568 reach the roundoff threshold just before @xmath575 reaches @xmath576 .",
    "assuming the observed modes @xmath577 are a good predictor of the bound @xmath578 , then we can estimate @xmath579 by @xmath580 .",
    "if the latter is @xmath581 , then @xmath582 is at most @xmath583 times larger , or @xmath584 , due to ( [ eq : q0:err ] ) .",
    "the value of @xmath540 is substantially larger than @xmath585 since reducing @xmath586 by a factor of @xmath28 when @xmath575 varies from 0 to @xmath587 requires @xmath588 .",
    "when @xmath589 , this gives @xmath590 in double - precision and @xmath591 in quadruple - precision arithmetic .",
    "we note from ( [ eq : rho : from : a ] ) that @xmath540 can be controlled easily by varying @xmath418 . in practice , we choose @xmath418 to be just small enough that roundoff errors in the highest - frequency chebyshev modes of @xmath568 begin to be visible , hitting a plateau rather than continuing to decay exponentially .",
    "the effects of floating - point arithmetic can be taken into account using the extrapolation formula @xmath592 in exact arithmetic , if @xmath342 interpolates the exact values of @xmath593 for @xmath414 , we have shown how to choose @xmath418 so that the right - hand side of ( [ eq : extrap : formula ] ) will equal @xmath411 to @xmath584 .",
    "if each term of the right - hand side of ( [ eq : extrap : formula ] ) is perturbed by @xmath581 , the accumulated effect remains @xmath584 . in practice",
    ", the errors really are this small , as shown in the follow - up paper @xcite by comparing double - precision results to `` exact '' solutions computed in quadruple - precision , and indirectly in @xcite by comparing this method of solving ( [ eq : pde ] ) to a projected dynamics approach using orthogonal polynomials .",
    "we conclude this section with a complexity estimate for the algorithm when @xmath309 ( the number of collocation points ) and @xmath468 ( the number of fully implicit runge - kutta stages ) are chosen optimally .",
    "first , for fixed @xmath21 and @xmath28 , we wish to find @xmath491 and @xmath418 to minimize @xmath594 in ( [ eq : cost ] ) subject to the constraint @xmath595 .",
    "a nearly identical optimization problem ( with a simpler answer ) is to minimize @xmath596 subject to @xmath597 , where @xmath540 is regarded as a function of @xmath418 ( with @xmath6 fixed ) in ( [ eq : rho : from : a ] ) .",
    "a routine calculation shows that the optimal solution satisfies @xmath598 which yields @xmath599 ,",
    "@xmath600 and @xmath601 .",
    "this gives @xmath602 for @xmath603 and @xmath604 for @xmath605 .",
    "thus , our choice of @xmath572 above is nearly optimal in double - precision but too small in quadruple - precision , which is what we observe in practice as well ( see  [ sec : compare ] below ) .",
    "note that the eccentricity of the optimal bernstein ellipse equals @xmath606 , independent of @xmath21 and @xmath28 ( see figure  [ fig : cheb ] ) .",
    "its size is determined by @xmath6 , the effective radius of convergence of @xmath538 at @xmath539 .",
    "we can estimate @xmath6 as a function of @xmath21 indirectly , using @xmath599 and the left formula in ( [ eq : sigma : opt ] ) , since @xmath572 is close to optimal in double - precision .",
    "the target accuracy @xmath28 affects the number of grid points via @xmath607 , but not the size or shape of the ellipse . with these parameter choices , ( still approximating @xmath608 by @xmath609 )",
    ", we obtain @xmath610 where @xmath611 in our case , and @xmath471 .    the additional @xmath490 steps required to evolve from 0 to @xmath361 are normally a small fraction of @xmath594 .",
    "these initial steps do not require complex arithmetic , which further reduces their cost .",
    "nevertheless , @xmath612 will eventually dominate @xmath613 when @xmath614 . over the range of @xmath21 and tolerances considered here ( @xmath574 , @xmath615 )",
    ", @xmath616 is at least 9 times larger than @xmath617 .",
    "but for still larger values of @xmath21 , the latter could become significant .",
    "fortunately , this term is an artifact of choosing @xmath618 in ( [ eq : xstar2 ] ) , and is not present when @xmath361 is defined as the first negative extremum of @xmath250 . the naive algorithm ( in which @xmath361 is set to zero and only one fundamental matrix is computed )",
    "can even be used since there is no growth phase when @xmath619 .    the difficulty in analyzing the case in which @xmath21 is large and @xmath361",
    "is allowed to drop below 1 is that the estimate ( [ eq : rate2 ] ) of the convergence rate is based on the large @xmath32 asymptotics of @xmath45 , yielding errors of the form @xmath620)$ ] , where @xmath621 is a multiple of @xmath319 . this formula ( incorrectly )",
    "suggests that if @xmath361 is close to zero , little progress will be made until @xmath32 reaches 1 . by contrast , ( [ eq :",
    "n : steps ] ) does not rely on asymptotics , and shows that the number of steps needed to evolve from @xmath361 to @xmath32 scales linearly , like @xmath622 $ ] , when @xmath361 is close to zero and @xmath623 .",
    "we expect that a more refined wkb analysis using ( [ eq : xi : def ] ) instead of ( [ eq : xi : asym ] ) would show that for large @xmath21 , @xmath624 decays initially like @xmath625)$ ] , where @xmath626 is also a multiple of @xmath319 , before exhibiting the @xmath620)$ ] behavior . as a basic check ,",
    "if we approximate @xmath627 in ( [ eq : xi : def ] ) by @xmath628 and assume that @xmath629 in ( [ eq : vpm ] ) remain small down to @xmath61 when @xmath630 , then @xmath454 in ( [ eq : kappa : eps ] ) becomes @xmath625)$ ] with @xmath631 .",
    "since the number of steps and the logarithm of the inverse error grow similarly as functions of @xmath32 , with prefactors proportional to @xmath632 and @xmath633 , respectively , the technique of linking @xmath634 to @xmath497 by comparing ( [ eq : n : steps2 ] ) to ( [ eq : evolve : to ] ) should work the same .",
    "we did not carry out the details as this was not an issue over the range of @xmath21 considered here .",
    "next , to leading order in @xmath468 , the computational cost of the steps in ( [ eq : cost2 ] ) is @xmath635 , where @xmath636 is the cost of a floating - point operation with roundoff threshold @xmath28 , @xmath637 is the number of multiplications required to solve the @xmath638 linear system associated with a @xmath468-stage fully - implicit runge - kutta step for a linear ode with two components ( see @xcite ) , and @xmath639 accounts for the four multiplications and four additions required to perform one complex multiplication and one complex addition .",
    "optimizing @xmath640 boils down to minimizing @xmath641 with @xmath28 fixed .",
    "minimizing @xmath642 instead gives @xmath643 , for which @xmath644 .",
    "using @xmath645 for @xmath473 , we obtain @xmath646 since @xmath636 grows like @xmath647 or @xmath648 $ ] , depending on the arbitrary precision implementation , we conclude that the cost of computing @xmath33 by this method with accuracy @xmath28 grows slower than @xmath29 for any @xmath30 as @xmath31 .",
    "this translates into significant performance gains over other methods for computing spectral density functions with high accuracy , as shown in ",
    "[ sec : compare ] and @xcite .",
    "we find that the estimate @xmath649 for the optimal number of collocation points agrees closely with comparisons of actual running times in practice  the same @xmath491 is close to optimal .",
    "however , the bounds ( [ eq : n : steps2 ] ) and ( [ eq : cost2 ] ) overpredict the number of steps taken using adaptive stepsize control @xcite by a factor of roughly @xmath650 , and the optimal choice of @xmath651 is a few times larger than @xmath652 .",
    "this factor of @xmath651 can be obtained in the analysis of appendix  [ sec : step : bound ] if we set @xmath653 instead of @xmath654 in ( [ eq : trunc : error ] ) .",
    "( @xmath655 is a type of lipschitz constant for the ode , @xmath656 is the radius of a disk centered at @xmath32 in the complex plane , and @xmath657 is the stepsize ) .",
    "however , for technical reasons explained in @xcite , our current analysis requires @xmath658 , which breaks down if @xmath656 is increased in this way .",
    "we believe it should be possible to remove this barrier using a - stability of the scheme rather than a neumann series to bound the condition number of the implicit runge - kutta equations , but we do not know how to do this . if it is indeed possible to increase @xmath659 to @xmath651 without losing control of the constants in the formulas , then @xmath660 would be of the form @xmath661 and the result ( [ eq : ctot ] ) could be improved to contain @xmath662 instead of @xmath663 .",
    "we remark that these optimization problems are only intended to serve as a guideline for choosing @xmath491 and @xmath468 and deriving a rough complexity estimate .",
    "the correctness of the algorithm does not depend on choosing @xmath491 or @xmath468 optimally , and does not rely on asymptotics .",
    "we now consider two examples illustrating the use of ( [ eq : fhat2 ] ) , ( [ eq : fhat3 ] ) to solve @xmath34 with initial conditions @xmath664 , namely @xmath665 example 1 is harder to compute since @xmath666 has a singularity at @xmath61 that leads to an infinite initial speed @xmath667 there .",
    "this causes @xmath668 to decay slowly ( like @xmath612 ) , just as the fourier transform of a function with a slope - discontinuity decays slowly . nevertheless , this singular example is relevant to the problem of resistive damping in a plasma ; see section  3 of @xcite .",
    "we computed @xmath669 and @xmath670 at the grid points @xmath671 in ( [ eq : grid ] ) using the method explained above , in which a third component is added to @xmath405 in ( [ eq : y : ode ] ) to represent @xmath672 , and the solution is evolved until @xmath673 reaches its limiting value .",
    "the results are shown in figure  [ fig : fhat ] , where we have adopted the notation @xmath674e^{-x^2/2 } ,    \\end{aligned }    \\quad    \\tilde u(x , t ) = \\int_{-\\infty}^\\infty    \\frac{y_1(x;e^\\sigma)}{xy(e^\\sigma)}\\tilde f(\\sigma , t)\\,d\\sigma.\\ ] ] the tilde here is not related to the one used in ( [ eq : xstar])([eq : m : clever ] ) to denote solutions of ( [ eq : y : ode ] ) starting at @xmath365 .",
    "note that @xmath675 with @xmath293 and @xmath676 , and the extra factor of @xmath21 accounts for @xmath677 in the change of variables .",
    "also , if @xmath678 can be represented efficiently as a function of @xmath679 for some fixed @xmath680 , then for @xmath681 we have @xmath682 which is easy to evaluate",
    ". we will represent @xmath678 using a fourier series on @xmath683 , where @xmath684 in example 1 and @xmath685 in example 2 .",
    "plots of @xmath686 and @xmath687 at various times for the two examples in ( [ eq : ex12 ] ) .",
    "the effective support ( exceeding @xmath357 ) of @xmath688 lies between @xmath689 for @xmath690 while that of @xmath691 extends beyond @xmath692 until @xmath693 due to the slow @xmath612 decay rate of @xmath669 .",
    "both @xmath691 and @xmath688 turn out to be negative everywhere they can be distinguished from roundoff error . ]",
    "figure  [ fig : filter ] shows that the grid spacing in ( [ eq : grid ] ) is sufficient to represent @xmath691 over @xmath694 for @xmath695 and @xmath688 for @xmath690 to quadruple - precision accuracy using the fft .",
    "the red @xmath696 markers were obtained by computing @xmath670 and @xmath33 directly .",
    "the black markers were obtained from the red by truncating the data at @xmath697 ( the vertical red line ) , applying the fft ( to all 768 points ) , truncating the fourier series at @xmath698 ( the vertical green line ) , and transforming back .",
    "the blue markers show a filtered version of the raw data labeled @xmath693 in figure  [ fig : fhat ] . in this case",
    ", the fourier series was truncated at @xmath698 with no initial filter in @xmath679 .",
    "note that roundoff error causes @xmath699 to grow to around @xmath357 near @xmath700 in both examples .",
    "this is not a problem since @xmath295 was included in the raw data before the fft was computed . for larger values of @xmath39 in example 1 and",
    "all @xmath690 in example 2 , the domain can be reduced to @xmath701 so that only 512 raw data points are needed",
    ". however , we will continue to work with the grid ( [ eq : grid ] ) for illustration .",
    "sampling @xmath702 and @xmath703 at the 768 grid points in ( [ eq : grid ] ) is sufficient to reduce the highest frequency fourier modes to roundoff error in quadruple - precision arithmetic .",
    "( right ) the raw data ( red ) is evaluated on the original grid while the filtered data ( black and blue ) is evaluated on a finer mesh with 1536 grid points . ]    to perform the integral in ( [ eq : ftil ] ) , we use the trapezoidal rule over the interval @xmath704 .",
    "we increase the number of collocation points as @xmath32 increases in order to resolve the increasingly oscillatory integrals involved .",
    "much of this work can be done once and for all , independent of the initial condition @xmath705 . to this end",
    ", we pre - compute @xmath706 at selected @xmath32 locations on a nested hierarchy of grids @xmath707 for @xmath708 , @xmath709 only has to be computed for odd indices @xmath575 since it is already known for even indices from the previous level .",
    "note that @xmath710 coincides with @xmath711 in ( [ eq : grid ] ) .",
    "this makes it easy to interpolate the values of @xmath712 rather than computing @xmath354 and @xmath713 at the new grid points directly . to increase the size of @xmath714 by a factor of @xmath715 , we simply zero - pad its fft and compute the inverse transform .",
    "for example , the black and blue markers in the right panel of figure  [ fig : filter ] were computed in this way on the @xmath716 grid with 1536 nodes .",
    "plots of @xmath717 , its fourier modes @xmath718 , the solution @xmath719 , and the error @xmath720 for example 1 at @xmath693 .",
    "as @xmath32 increases , @xmath717 becomes more oscillatory and more grid points are needed to avoid aliasing errors in the trapezoidal rule integration scheme . ]    the results of this calculation for example 1 are given in figure  [ fig : fourier1 ] .",
    "panels ( a)(c ) show the integrand @xmath717 in the reconstruction formula @xmath721 as a function of @xmath679 for @xmath61 , @xmath722 , @xmath723 and @xmath724 with @xmath725 fixed .",
    "note that as @xmath32 increases , @xmath726 becomes more oscillatory as a function of @xmath679 .",
    "panel ( b ) shows the @xmath722 solution stretched vertically to a signed logarithmic scale .",
    "this was done by plotting @xmath727 on the @xmath95-axis and placing tick marks where @xmath728 .",
    "note that @xmath726 becomes highly oscillatory as it decays . on a stretched scale ,",
    "solutions with other values of @xmath32 have a similar envelope to the @xmath722 solution shown here , and range from having no oscillations ( @xmath61 ) to very rapid oscillations ( @xmath729 ) .",
    "panel ( d ) gives the magnitudes of the fourier modes of @xmath717 with @xmath32 and @xmath39 held fixed .",
    "the mode amplitudes of the fft are normalized by @xmath730 , where @xmath731 is the number of grid points . with this scaling",
    ", the @xmath732-point trapezoidal rule gives @xmath733 , where @xmath734 .",
    "the curves labeled @xmath61 , @xmath735 , etc . , were computed with @xmath736 , @xmath737 , @xmath738 , @xmath739 , @xmath639 , @xmath740 and @xmath741 , respectively .",
    "these levels were chosen so that @xmath742 decays to roundoff error before @xmath214 reaches the nyquist frequency @xmath743 , which is the largest mode shown for each curve .",
    "panel ( e ) shows the solution @xmath744 at @xmath693 , obtained by integrating @xmath717 . for comparison , we also plot @xmath745 which agrees closely with @xmath746 except near @xmath61 , where @xmath667 is initially infinite .",
    "panel ( f ) gives the error in the reconstructed solution using @xmath747 as the exact solution .",
    "higher values of @xmath32 require finer grids to resolve the oscillations in @xmath717 . for this example",
    ", the @xmath748 and 10 solutions are identical to 30 digits of accuracy .",
    "analogous results for example 2 .",
    "note that the axes are scaled differently in figure  [ fig : fourier1 ] .",
    "]    in figure  [ fig : fourier2 ] , we present analogous results for example  2 . since @xmath57 maps @xmath749 to a smooth function that is well - behaved at the origin , the reconstruction can be done at @xmath38 to recover @xmath291 .",
    "by contrast , we needed @xmath695 to overcome the slow decay of @xmath713 in example  1 .",
    "the main difference between figures  [ fig : fourier1 ] and  [ fig : fourier2 ] is that the effective support of @xmath726 is smaller in the latter case , leading to less oscillatory integrals .",
    "this is evident on comparing panel ( b ) in both figures , and also on observing that fewer fourier modes are needed in panel ( d ) to reach machine - precision in example 2 .",
    "more specifically , the curves labeled @xmath61 , @xmath735 , etc . , in ( d ) were computed with @xmath736 , @xmath750 , @xmath750 , @xmath585 , @xmath737 , @xmath738 and @xmath751 , respectively . in panel",
    "( e ) , the orange curve gives the exact initial condition @xmath752 while the black markers are computed using the trapezoidal rule on the numerically computed @xmath717 .",
    "panel ( f ) gives the true errors relative to the exact initial condition ( [ eq : exact ] ) rather than using the solution on the finest grid as the benchmark .",
    "in example 2 , the solution reaches roundoff error already at @xmath753 , which corresponds to a grid 32 times coarser than the @xmath748 mesh needed in example 1 .",
    "the accelerating frequency of oscillation that occurs in @xmath754 as @xmath679 increases is partly due to our choice of @xmath676 in the change of variables ( [ eq : ftil ] ) .",
    "when @xmath32 is small , this choice is very good for representing @xmath754 with a small number of fourier modes .",
    "however , we can do better for larger @xmath32 . from the asymptotic analysis in appendix  [ sec : asym ]",
    ", we expect @xmath755 in ( [ eq : g : def ] ) to oscillate like @xmath756 at leading order .",
    "thus , to achieve a nearly constant number of grid points per cycle with respect to @xmath21 holding @xmath32 fixed , we should change variables so that @xmath757 for large @xmath758 .",
    "we also want @xmath614 as @xmath759 .",
    "we tried functions of the form @xmath760 and found that @xmath761 works nicely .",
    "the first formula is used for positive @xmath758 and the second for negative @xmath758 .",
    "the alternative change of variables ( [ eq : chgvar ] ) leads to a more efficient representation of the oscillatory integrand @xmath762 for @xmath763 .",
    "panel ( e ) is omitted as it looks identical to figure  [ fig : fourier1](e ) . ]",
    "figure  [ fig : fourier3 ] shows the results for example 1 at @xmath725 with the alternative integration variable .",
    "plots ( a)(c ) show the integrand @xmath762 in the reconstruction formula @xmath764 where @xmath21 is related to @xmath758 via ( [ eq : chgvar ] ) , @xmath765 , and @xmath766 .",
    "note that the oscillation frequency is nearly uniform over @xmath767 in ( b ) , unlike the result in figure  [ fig : fourier1 ] .",
    "to compute the integrals , we pre - compute @xmath768 on a nested grid similar to ( [ eq : nested ] ) but over @xmath769 , namely @xmath770 the lowest level is labeled 2 so that the number of grid points at a given level is the same in figures  [ fig : fourier1][fig : fourier3 ] .",
    "the drawback of using @xmath758 is that more grid points are needed at @xmath61 to represent @xmath762 than @xmath717 .",
    "the benefit is that fewer grid points are needed for larger @xmath32 .",
    "the following table gives the index @xmath732 at which the fourier modes of @xmath754 and @xmath762 reach roundoff error in quadruple - precision with @xmath725 @xmath771 we use these numbers as a guideline for the optimal number of collocation points to use in the trapezoidal rule .",
    "as @xmath32 increases , the cost of reconstructing the solution via ( [ eq : g : til ] ) or ( [ eq : g : check ] ) increases due to more collocation points being needed to resolve the oscillations in @xmath726 or @xmath772 , and more timesteps being needed to evolve to @xmath32 .",
    "note that the @xmath679 variable is better for small @xmath32 because @xmath726 and @xmath772 grow at similar rates near @xmath773 and @xmath774 , respectively , but the domain for @xmath758 is several times larger than for @xmath679 .",
    "however , for larger @xmath32 , the oscillations dominate the smoothness properties of @xmath726 and @xmath772 , and are spread out more uniformly in the @xmath758 variable .",
    "thus , fewer collocation points are wasted in less oscillatory regions . in our code",
    ", we use the fourier representation of @xmath712 in figure  [ fig : filter ] to evaluate @xmath775 on the @xmath776 grid since this only requires 768 evaluations of @xmath354 and @xmath206 rather than 3072 .",
    "once @xmath777 is known at @xmath776 , we use the fft to interpolate to higher levels .",
    "we give here a brief summary of the method presented in detail in the sections above , which may help readers interested in implementing it .",
    "the key steps of the algorithm may be summarized as follows :    1 .",
    "[ stepmesh ] pick a `` coarse '' mesh in @xmath21-space , e.g.  @xmath778 or @xmath779^{-2}$ ] , where @xmath711 ( or @xmath780 ) is uniformly spaced from @xmath781 to @xmath782 ( or @xmath783 to @xmath784 ) .",
    "the number of grid points and choice of @xmath781 and @xmath782 may be adjusted later , in steps  [ stepftil ] and  [ stepfft ] .",
    "[ stepinit ] for each @xmath21 on the mesh , evolve @xmath250 forward to @xmath361 , the location of its first negative extremum , @xmath349 .",
    "if the ode is singular at the origin , i.e.  ( [ eq : y : ode ] ) is used rather than ( [ eq : y : ode : intro ] ) , use the series solution ( [ eq : taylor ] ) to initialize the ode to the right of the singularity , e.g.  at @xmath785 . use enough terms of the series to achieve roundoff - level accuracy . also define @xmath295 as in ( [ eq : y : def ] ) and evolve @xmath786 to @xmath361 to obtain @xmath373 in ( [ eq : xstar ] ) .",
    "we use an arbitrary ( e.g.  50th ) order , fully implicit runge - kutta collocation ( irk ) method to advance the solutions in @xmath32 .",
    "[ stepcx ] let @xmath476 , with @xmath21 a grid point from steps 1 and 2 and @xmath787,  ,@xmath788 the chebyshev points in ( [ eq : cheb : pts ] ) .",
    "evolve @xmath789 forward from the identity at @xmath365 until its columns become linearly dependent to machine precision ( determined by monitoring the wronskian ) .",
    "record @xmath790 .",
    "extrapolate to obtain @xmath411 as well as @xmath354 and @xmath33 .",
    "adjust @xmath418 , if necessary , to obtain appropriate chebyshev mode decay rates ( fig .",
    "[ fig : cheb ] ) .",
    "4 .   compute the transform of the initial condition at the grid points via @xmath791 , @xmath792y_1(s;\\lambda)\\,ds$ ] .",
    "@xmath298 is evolved via an ode , along with @xmath286 and @xmath301 in ( [ eq : yz : def ] ) , until @xmath298 stops changing , which happens rapidly due to @xmath793 . if the ode is singular at the origin , initialize @xmath298 at @xmath785 using the series solution of the ode .",
    "[ stepftil ] evaluate @xmath794 on the grid at @xmath685 .",
    "if necessary , go back to step 1 and adjust the mesh endpoints so that @xmath714 decays rapidly to zero as @xmath795 and @xmath796 .",
    "it may be necessary to increase @xmath40 to achieve sufficient decay at the right endpoint ( fig .",
    "[ fig : fhat ] ) . 6 .",
    "[ stepfft ] compute the fft of @xmath678 for the purpose of interpolation .",
    "adjust the number of mesh points ( in step 1 ) as necessary so the fourier modes of @xmath678 decay to roundoff accuracy .",
    "optionally , filter the modes ( fig .",
    "[ fig : filter ] ) . 7 .",
    "compute the basis functions @xmath797 $ ] by solving the ode for @xmath286 on a nested hierarchy of grids , @xmath798 , as in ( [ eq : nested ] ) .",
    "record @xmath768 at the points @xmath32 where @xmath36 is to be evaluated .",
    "start with level @xmath736 and add levels as needed in step [ steptrap ] .",
    "[ steptrap ] compute @xmath799 on successive levels of the grid hierarchy and evaluate @xmath800 via the trapezoidal rule . since the trapezoidal rule is the constant mode of the fft , stop at level @xmath801 of the grid hierarchy when the fft of @xmath717 decays to roundoff accuracy .",
    "evaluation of @xmath712 is done via ( [ eq : ftil : eval ] ) , with @xmath678 evaluated via the fft from step [ stepfft ] .",
    "steps [ stepftil][steptrap ] should be modified via ( [ eq : g : check ] ) and ( [ eq : nested : xi ] ) if @xmath758 is used instead of @xmath679 in step  [ stepmesh ] .",
    "we note that the procedure is very general : @xmath57 can be replaced by any singular sturm - liouville operator that is regular ( or of limit circle type , with taylor or frobenius series solutions ) at the origin and of limit point type at @xmath802 , provided the spectral density function @xmath33 is smooth enough .",
    "smoothness of @xmath190 affects the smoothness of @xmath131 in ( [ eq : m : diff ] ) and ( [ eq : m : cauchy ] ) , which determines how effectively @xmath131 can be extrapolated to the real axis from the upper half - plane via chebyshev polynomials .",
    "steps [ stepftil][steptrap ] also rely on @xmath190 being sufficiently smooth to ensure that the fourier modes of @xmath714 and @xmath726 decay rapidly .",
    "we note that each step of the algorithm provides _ a - posteriori _ error estimates based on the decay of chebyshev and fourier modes .",
    "this allows rapid selection of mesh parameters through a few iterations of steps  [ stepmesh ] , [ stepftil ] and  [ stepfft ] .",
    "since the new algorithm is based on an exact mathematical formula expressing the solution @xmath36 at a later time in terms of the initial condition @xmath705 , it will be as accurate as the quantities @xmath206 , @xmath803 $ ] , and @xmath804 $ ] that appear in ( [ eq : fhat2 ] ) , up to quadrature error in the trapezoidal rule , which is controlled by checking that the fourier modes decay to machine precision .",
    "computing @xmath206 , @xmath250 and @xmath295 involves solving linear odes , which are easily solved to machine precision using high - order runge - kutta methods . achieving high relative accuracy in @xmath250 requires that it not be a multiple of the recessive solution , but this is guaranteed for @xmath805 since the point spectrum of @xmath57 is @xmath290 .",
    "computing @xmath806 can also be done to machine precision using high - order runge - kutta methods .",
    "the extrapolation procedure to compute @xmath807 is numerically stable in finite precision arithmetic , as shown in ",
    "[ sec : roundoff ]",
    ". however , high relative accuracy of the complex number @xmath378 does not imply high relative accuracy of the imaginary part , and digits can be lost when evaluating @xmath808 when @xmath809 .",
    "we showed how to avoid this loss of accuracy in the imaginary part by factoring the fundamental matrix as in ( [ eq : xstar ] ) and using the wronskian identity to correct the smaller singular value of one of the factors .    to confirm that the new algorithm is spectrally accurate ,",
    "we have checked in joint work with landreman @xcite that the solution @xmath36 computed as above agrees to roundoff accuracy ( 14 or 29 digits ) with the projected dynamics of ( [ eq : u : intro ] ) in spaces of orthogonal polynomials .",
    "such agreement provides strong evidence that monitoring chebyshev and fourier mode decay rates provides accurate _ a - posteriori _ error estimates .",
    "the current algorithm may be viewed as a method of approximating exact integral formulas for the solution , while that in @xcite may be regarded as a ( nearly ) exact evolution of a finite - dimensional approximation of the pde .    to gauge the performance of the new algorithm , in follow - up work @xcite ,",
    "we compare our method of computing the spectral density function ( steps  [ stepinit ] and  [ stepcx ] ) to the popular software package sledge @xcite , and to the algorithm of fulton , pearson and pruess @xcite .",
    "the algorithm in sledge is based on the levitan - levinson formula , @xmath237 , where @xmath238 is the spectral function associated with the regular problem on the interval @xmath810 .",
    "sledge could not handle the weight function @xmath134 due to underflow for @xmath811 in double - precision . to convert to a constant weight function",
    ", we made the change of variables @xmath812 to obtain ( [ eq : y : ode : intro ] ) . in this form ,",
    "the problem is regular at the origin , as discussed in  [ sec : rescaled ] , and we were able to compute the spectral function @xmath253 using sledge to around 4 digits of accuracy .",
    "further refinement of the mesh led to failure of the algorithm , apparently due to overflow when scaling the eigenfunctions with small eigenvalues to satisfy @xmath813 at @xmath61 .",
    "computing @xmath33 from @xmath253 would lead to additional loss of accuracy .",
    "thus , sledge was not found to be suitable for our purposes .",
    "the algorithm of fulton , pearson and pruess @xcite ( fpp ) proceeds by defining a sequence of auxiliary functions @xmath814 , @xmath815 , @xmath816 such that @xmath817 converges to @xmath33 as @xmath818 , with improved convergence rates as @xmath491 increases . here",
    "@xmath819 is related to @xmath252 or @xmath250 in previous sections by the liouville transformation @xcite to schrdinger form , @xmath820 . for @xmath821 and @xmath822 ,",
    "the fpp procedure gives @xmath823 the formulas for @xmath824 are given in @xcite and @xcite along with explicit error estimates .",
    "these estimates imply that , in the present case , the error in approximating @xmath33 by @xmath825 decays like @xmath826 , where the liouville transformation relates @xmath32 to @xmath827 via the ode @xmath828 ; see lemma  [ lem : x ] , appendix  [ sec : asym ] and @xcite .",
    "the following table gives running times ( in seconds ) for computing the spectral density function with our method and the fpp method at the 768 grid points @xmath829 in ( [ eq : grid ] ) using a 3.33 ghz intel xeon x5680 system with 12 cores : @xmath830 here the letters d and q stand for double- and quadruple - precision computations with tolerances set to @xmath356 and @xmath357 , respectively .",
    "fpp4d3 employs the 4th order timestepper described in @xcite , which uses richardson extrapolation to improve the accuracy of a 2nd order frozen coefficient method , with @xmath824 in ( [ eq : fpp : fn ] ) .",
    "fpp15d3 and fpp31q3 also use @xmath824 in ( [ eq : fpp : fn ] ) , but with a 15th or 31st order timestepper . the letters wc refer to the new algorithm presented in this article , and",
    "wc76q25 means that we use a 38-stage , 76th order fully implicit runge - kutta method with 25 chebyshev extrapolation points . comparing wc76q25 to wc76q48",
    "confirms the prediction in  [ sec : complexity ] that @xmath831 extrapolation points should be close to optimal in quadruple - precision .",
    "( our fft implementation required adjusting to @xmath832 . )",
    "the transformation to liouville normal form for the fpp method involves solving the _ nonlinear _",
    "system @xmath833 , @xmath834 , @xmath835u$ ] , where @xmath836 is needed to compute @xmath837 . since fully implicit methods are difficult to implement for nonlinear equations , we used a spectral deferred correction scheme @xcite in the fpp15d3 and fpp31q3 cases .",
    "the scheme orders in the table were chosen optimally by trial and error in all but the fpp4d3 cases .",
    "the running times above show that the choice of timestepper is critical for efficiently computing spectral density functions with high accuracy . in double - precision ,",
    "our method is 650 times faster than the fpp algorithm described in @xcite .",
    "however , we were able to improve their algorithm to be 1.66 times faster than ours by implementing a better timestepper . in quadruple - precision , our method is 16.6 times faster than their method using the best timestepper available for each method . to explain this",
    ", we recall @xcite that the error @xmath838 in their method decays like @xmath839 when @xmath824 .",
    "thus , to reduce the error to @xmath581 , the solution must be evolved to @xmath840 .",
    "empirically , @xmath841 works well in double and quadruple - precision arithmetic over @xmath574 , though establishing precise dependence on @xmath21 is difficult .",
    "indeed , for smaller values of @xmath21 this will not be adequate to traverse the growth region of figure  [ fig : qplot ] .",
    "( the potential @xmath837 must drop below @xmath21 for the convergence theory of @xcite to be valid ) . from (",
    "[ eq : n : steps2 ] ) and lemma  [ lem : x ] , this translates into @xmath842 .",
    "by contrast , our method requires @xmath843 steps over this range of @xmath21 , where again the @xmath21-dependence is empirical and not precisely known .",
    "since @xmath844 exceeds @xmath845 once @xmath846 , this is roughly the transition point where our method should become more efficient . in practice , as shown in the table above , the methods are already comparable in double - precision ( @xmath847 ) since converting to liouville normal form in the fpp method introduces the nonlinear equation @xmath848 .",
    "a more detailed comparison of the convergence rates of the two methods will be given in @xcite .",
    "an advantage of the fpp method is that @xmath21 is real , so the solution remains real and complex linear algebra is avoided .",
    "this comes at the cost of having to evaluate higher derivatives of @xmath837 that appear in the formulas for @xmath814 , @xmath815 and @xmath816 in ( [ eq : pzr ] ) for @xmath849 ; see @xcite for details .",
    "this is a significant issue when @xmath837 is complicated , and could lead to loss of accuracy if the derivatives are computed numerically . in our case , @xmath837 is the term in parentheses in ( [ eq : f ] ) below , with @xmath32 replaced by @xmath836 . in @xcite , to make this practical , we had to resort to asymptotics , making use of lemmas  [ lem : psi ] and  [ lem : x ] from appendix  [ sec : lem ] below to evaluate @xmath850 in @xmath851 .",
    "by contrast , our method involves only the original ode .",
    "no derivatives of the potential need to be computed , and the equation need not even be converted to liouville normal form .",
    "we have studied the dynamics of a model partial differential equation that is used in plasma physics to compare the merits of different discretization schemes for the speed variable in numerical solvers .",
    "to do so , we used the spectral transform associated with a singular sturm - liouville operator @xmath57 to represent the solution in such a way that the dynamics becomes trivial , through multiplication by @xmath852 .",
    "our algorithm relies on expressing the spectral density function of @xmath57 in terms of the titchmarsh - weyl @xmath0-function , evaluating the @xmath0-function along a line segment in the complex plane , and extrapolating it to the real axis using chebyshev polynomials .",
    "our method is very general , and will work for any singular sturm - liouville problem that is of limit point type at infinity and of limit circle type ( or regular ) at the origin , and if the @xmath0-function has enough smoothness near the real @xmath21-axis to be well approximated by polynomials along line segments in the transverse direction .",
    "furthermore , the complexity of the new method for computing the @xmath0-function has been analyzed and shown to be comparable to other methods in double - precision , and faster in quadruple - precision , when optimal timestepping algorithms are used for all methods .",
    "the solution of the pde computed in this way can be compared with approximate solutions obtained with the discretization methods traditionally used in plasma physics , and provides a basis for error quantification .",
    "our construction of the solution and its behavior for certain initial conditions are also very helpful in explaining the behavior of approximate solutions .",
    "for example , we found that for singular initial conditions the solution of the pde often can not be resolved to the desired level of accuracy until @xmath39 surpasses a critical value @xmath40 , because the decay rate of the spectral transform of the solution is only algebraic at @xmath38 , and slow ( but at least exponential ) in the moments that follow .",
    "this has strong implications for the projected dynamics of this equation in finite - dimensional spaces of orthogonal polynomials , and for the choice of these polynomials , as we present elsewhere in subsequent work .",
    "a detailed analysis of arbitrary - order @xmath468-stage runge - kutta collocation methods of order @xmath469 , presented elsewhere @xcite , reveals that if such a scheme is used to evolve the fundamental matrix @xmath853 for @xmath854 from @xmath32 to @xmath855 , with @xmath856 and @xmath83 , the local truncation error is bounded by @xmath857 where @xmath858 is a bound on @xmath859 , @xmath860 , @xmath861 , @xmath393 controls the size of a bernstein ellipse @xcite with foci at @xmath32 and @xmath855 and semi - major and semi - minor axes of length @xmath862 and @xmath863 , respectively , and @xmath656 is the radius of a disk centered at @xmath32 in the complex plane containing the bernstein ellipse , which requires @xmath864 . to obtain ( [ eq : trunc : error ] )",
    ", it is assumed in @xcite that @xmath473 , @xmath865 , @xmath866 , @xmath658 .",
    "the first - order system ( [ eq : ode : balanced ] ) is equivalent to ( [ eq : y : ode ] ) and ( [ eq : y : ode : intro ] ) when @xmath96 is defined by @xmath867 , which is scaled so that @xmath96 grows at the same rate as @xmath95 ( like @xmath868 ) as @xmath51 when @xmath21 is real . in practice , all three systems ( [ eq : y : ode ] ) , ( [ eq : y : ode : intro ] ) and ( [ eq : ode : balanced ] )",
    "perform similarly , but the error analysis is simplest for ( [ eq : ode : balanced ] ) .",
    "we interpret ( [ eq : trunc : error ] ) as a relative error in advancing any fundamental matrix @xmath117 from @xmath32 to @xmath855 since @xmath869 .",
    "in floating point arithmetic with roundoff threshold @xmath28 , the accuracy of the result will cease to improve when this relative error reaches @xmath581",
    ". the right - hand side of ( [ eq : trunc : error ] ) will be less than @xmath28 if we assume @xmath473 , choose @xmath656 so @xmath870 , and require @xmath871 .",
    "increasing @xmath393 to 3 if necessary , the condition @xmath872 implies @xmath873 , and we are led to the stepsize constraint @xmath874 the intermediate assumptions that @xmath866 , @xmath875 , and @xmath865 are ensured by ( [ eq : knu ] ) since @xmath870 , @xmath876 , and @xmath877 .",
    "to derive ( [ eq : n : steps ] ) , we note that counting steps using the largest stepsize allowed by ( [ eq : knu ] ) will give the points @xmath878 .",
    "this is euler s method for the ode @xmath879 with steps of size @xmath880 .",
    "the change in @xmath827 after @xmath732 steps is then @xmath732 .",
    "since @xmath881^{-1}$ ] is a positive , decreasing function , solutions of the continuous problem are increasing and concave down .",
    "hence , euler s method will overpredict the solution @xmath836 of this ode . as a result ,",
    "solving the ode will overpredict the change in @xmath827 needed to achieve a specified change in @xmath32 using euler s method . using separation of variables ,",
    "we conclude that @xmath882 is an upper bound on the number of steps required to advance the solution of ( [ eq : ode : balanced ] ) from @xmath275 to @xmath467 with the maximum stepsize allowed by ( [ eq : knu ] ) .",
    "in this section we present four technical lemmas needed in appendix  [ sec : asym ] to establish the asymptotic behavior of the solutions @xmath53 and @xmath95 of ( [ eq : eval ] ) and ( [ eq : y : ode : intro ] ) , respectively .",
    "[ lem : psi ] the function @xmath45 in ( [ eq : psi ] ) is real analytic , even , positive and satisfies @xmath883 , where @xmath884 means that @xmath885 as @xmath51 for all integers @xmath886 , @xmath887 .",
    "taylor expansion shows that @xmath888 $ ] has a removable singularity at @xmath889 with limiting value @xmath47 ; thus , @xmath890 is entire .",
    "it is even since @xmath891 , @xmath892 and @xmath893 are odd .",
    "the formula @xmath894 shows that @xmath45 is decreasing on @xmath60 . since @xmath895",
    ", it follows that @xmath896 for @xmath49 .",
    "since @xmath45 is even , it is positive for @xmath897 as well .",
    "a straightforward induction argument shows that @xmath898 has derivatives of the form @xmath899,\\ ] ] where @xmath900 , @xmath901 , @xmath902 and @xmath903 since @xmath904 , there is a polynomial @xmath905 of degree @xmath906 such that @xmath907 , which converges to @xmath750 as @xmath51 , as claimed .",
    "[ lem : pows ] let @xmath908 and define @xmath909 .",
    "suppose @xmath910 and its derivatives grow slowly as @xmath51 , i.e.  there exist integers @xmath911 such that @xmath912 for @xmath886 .",
    "suppose also ( increasing @xmath913 if necessary ) that @xmath914 .",
    "then @xmath915 implies @xmath916 , provided one of the following is true : @xmath562 is an integer ; @xmath917 and @xmath130 are real - valued ; or the inverse of the distance from @xmath910 to the negative real axis is @xmath918 .    by hypothesis , there exist @xmath919 , @xmath920 such that @xmath921 increasing @xmath922 if necessary , we may assume @xmath923 for @xmath91 .",
    "any point @xmath535 on the line segment @xmath924 joining @xmath910 to @xmath705 in the complex plane satisfies @xmath925 , and hence @xmath926 in the complex case , if @xmath562 is not an integer , we also have @xmath927 whenever @xmath91 and @xmath928 ; thus , @xmath910 is closer to each @xmath929 than to the negative real axis and @xmath924 does not cross the branch cut of @xmath930 . if @xmath562 is an integer , there is no branch cut .",
    "if @xmath130 and @xmath917 are real - valued , then @xmath705 and @xmath910 have the same sign for @xmath931 ( since @xmath910 is closer to @xmath705 than to the origin ) , so @xmath924 is either a subset of the positive real axis or lies along the ray from the origin through @xmath932 .",
    "either way , @xmath924 does not cross the branch cut .",
    "next , for any @xmath886 and @xmath91 , we have @xmath933 multiplying by @xmath934 , where @xmath887 , and using ( [ eq : line : seg ] ) , we obtain @xmath935 since @xmath936 grows slowly ( i.e.  polynomially ) in @xmath32 , the @xmath553 case also implies that @xmath937 grows slowly .",
    "finally , we use fa - di bruno s formula @xcite @xmath938 where @xmath814 is the set of partitions of @xmath939 , @xmath940 is the number of blocks in the partition @xmath196 , and @xmath941 is the number of integers in block @xmath141 .",
    "thus , for any integer @xmath887 , @xmath942 subtracting and adding telescoping terms , e.g. @xmath943 the right - hand side of ( [ eq : faa : bnd ] ) is bounded by a finite sum of terms in which one factor is a difference , either @xmath944 or @xmath945 , and the rest grow slowly in @xmath32 .",
    "since the difference converges to zero faster than any polynomial , the right - hand side of ( [ eq : faa : bnd ] ) converges to zero as @xmath51 , as claimed .",
    "[ lem : prods ] if @xmath946 and its derivatives grow slowly , i.e.  there exist integers @xmath911 such that @xmath947 for @xmath886 , then @xmath915 implies @xmath948 .",
    "it suffices to check that @xmath949 with @xmath950 .",
    "we see that @xmath951^{(n)}(x ) - [ hg]^{(n)}(x ) \\right)x^k\\right|$ ] may be bounded by @xmath952 for large @xmath32 , where @xmath953 is a bound on @xmath954 for large @xmath32 . but",
    "( [ eq : prod : bnd ] ) converges to zero as @xmath51 due to @xmath955 .",
    "finally , we note that if @xmath949 , then @xmath956 can be made smaller than any multiple of @xmath957 for large @xmath32 , so if one is @xmath958 , so is the other .",
    "[ lem : x ] the solution @xmath836 of @xmath959 , @xmath960 exists for all @xmath199 and is an increasing , real analytic , odd function of @xmath827 . there is a constant @xmath401 such that @xmath961{25/8}(s - c)^{2/5}$ ] .    by lemma  [ lem : psi ]",
    ", @xmath45 is real analytic , even , and positive .",
    "it follows that @xmath836 is increasing , odd , and real analytic for as long as the solution exists ( see @xcite regarding analyticity ) .",
    "moreover , @xmath962 , which gives @xmath963\\,dr,\\ ] ] where @xmath964\\,dx \\approx 1.6247 $ ] . since the integrand in ( [ eq : sx ] ) and each of its derivatives is @xmath965 for all @xmath887 , we may apply lemma  [ lem : pows ] to conclude @xmath966{25/8}(s - c)^{2/5 } + { \\varepsilon}_0(x ) , \\qquad { \\varepsilon}_0(x)\\doteq 0.\\ ] ] since @xmath828 , we see that @xmath967{25/8}(s - c)^{2/5}\\right ]    + { \\varepsilon}_n(x ) , \\quad    { \\varepsilon}_n(x ) = \\sqrt{\\psi(x)}\\,\\frac{d}{dx}{\\varepsilon}_{n-1}(x ) ,    \\quad ( n\\ge1).\\ ] ] by lemmas  [ lem : psi ] and  [ lem : pows ] , @xmath968 , which has derivatives that grow slowly ( in fact decay ) .",
    "thus , we may apply lemma  [ lem : prods ] inductively to conclude that @xmath969 for @xmath886 .",
    "since @xmath970 for any @xmath887 , it follows from ( [ eq : xs : err ] ) that @xmath971 for @xmath887 , as claimed .",
    "in this section , we study the asymptotic behavior of solutions of @xmath972 for large @xmath32 , where @xmath973/(2x^3)$ ] and @xmath974 .",
    "the case @xmath75 does not require asymptotic arguments as the general solution ( [ eq : u : lam0 ] ) can be written down in closed form .",
    "we will show that if @xmath805 , two linearly independent solutions of ( [ eq : a1 ] ) exist of the form @xmath975\\ ] ] for @xmath246 , where @xmath976 when @xmath21 is real and positive , any real - valued solution of ( [ eq : a1 ] ) may still be written as a linear combination @xmath977 .",
    "reality requires @xmath978 , which implies @xmath979\\ ] ] for some @xmath980 , which yields ( [ eq : asym ] ) . for all other values of @xmath981 , one of the modes @xmath255 in ( [ eq : asym : u ] ) grows super - exponentially as @xmath51 while the other decays .",
    "the recessive ( decaying ) mode is uniquely determined by ( [ eq : asym : u ] ) , but the dominant ( growing ) mode is not .",
    "when @xmath231 , neither mode dominates the other , so both are determined uniquely by ( [ eq : asym : u ] ) .    while it is possible to derive ( [ eq : asym : u ] ) by guessing its form and computing successive terms of @xmath982 and @xmath983 from ( [ eq : a1 ] ) iteratively , it is difficult to prove error bounds for the resulting series . instead , we will use a liouville transformation @xcite to convert the ode to normal form and use wkb theory @xcite to study the asymptotics .    to convert the general second order self - adjoint equation @xmath984 to liouville normal form @xcite , @xmath985 , one solves the ode @xmath986 to obtain @xmath836 , and then defines @xmath987{p(x(s))w(x(s ) ) } , \\qquad    q(s)=\\frac{q(x(s))}{w(x(s ) ) } + \\frac{\\gamma''(s)}{\\gamma(s)}.\\ ] ] to fit in the framework of wkb theory , it is convenient to change the sign of @xmath988 and absorb @xmath21 into the potential . thus , we convert ( [ eq : a1 ] ) to the form @xmath989 by the change of variables @xmath848 , @xmath990 , @xmath991 , @xmath992 , and @xmath993 the same result is obtained if we start from ( [ eq : y : ode : intro ] ) instead of ( [ eq : a1 ] ) . since @xmath994 is even and entire",
    ", @xmath995 has a removable singularity at @xmath889 . by lemma  [ lem : psi ] , @xmath996 on the real axis .",
    "thus , @xmath997 and @xmath998 are real analytic on all of @xmath999 . by lemma  [ lem : x ] , @xmath1000 is also real analytic .",
    "( we subtract @xmath21 to make @xmath673 and @xmath837 real valued for real arguments ) . by lemmas  [ lem : psi ] , [ lem : pows ] and  [ lem :",
    "prods ] , we may replace @xmath45 by @xmath1001 in ( [ eq : f ] ) to conclude @xmath1002 where @xmath884 means that @xmath885 as @xmath818 for all integers @xmath1003 .",
    "lemmas  [ lem : pows ] and  [ lem : prods ] were both used ( the latter twice ) to convert @xmath1004 into @xmath1005 .",
    "the wkb approximation @xcite of the solution of ( [ eq : can_form ] ) is @xmath1006 where @xmath1007 means @xmath1008 as @xmath818 .",
    "when @xmath837 is real and positive , ( [ eq : wkb ] ) can be derived by performing another liouville transformation , namely @xmath1009 , @xmath1010 , to convert the ode to @xmath1011w$ ] .",
    "neglecting @xmath1012 gives @xmath1013 .",
    "if @xmath1014 is small , error estimates can be derived in the @xmath758 coordinate system @xcite .    in our case , @xmath837 is complex - valued , so the change of variables @xmath1015 requires that we complexify the dependent variable @xcite .",
    "we prefer to work with complex functions of the real variable @xmath32 , and only use @xmath827 and @xmath758 as intermediate steps to finding a representation of ( [ eq : a1 ] ) that is suitable for perturbation analysis . to this end , we still define @xmath1016 , but treat it as a function of  @xmath827 rather than  @xmath758 .",
    "substitution of the identity @xmath1017 +    q^{1/4 } \\left(\\frac{d^2}{ds^2}q^{-1/4}\\right)u\\ ] ] in the equation @xmath1018 gives @xmath1019w , \\qquad    \\phi(s ) = -q^{-3/4}\\frac{d^2}{ds^2}q^{-1/4},\\ ] ] where we have adopted the convention that differential operators act on all products that follow them unless otherwise indicated by parentheses .",
    "the left - hand side of ( [ eq : w2 ] ) plays the role of @xmath1020 in @xcite .",
    "changing back to the @xmath32-coordinate system and writing @xmath1021 , we find that if @xmath1022 and @xmath87 are related by @xmath1023^{-1/4}v(x),\\ ] ] then @xmath87 satisfies ( [ eq : a1 ] ) iff @xmath1022 satisfies @xmath1024 we again recognize the left - hand side as @xmath1020 .",
    "two technical issues concern zeros of @xmath673 and the branch cut of the square root and fourth root functions along the negative real axis .",
    "we claim there is an @xmath1025 such that @xmath673 is bounded away from zero and neither @xmath673 nor @xmath1026 crosses the negative real axis for @xmath1027 .",
    "since we are interested in the asymptotics of @xmath87 for large @xmath32 , we only need to solve ( [ eq : v : psi ] ) for @xmath1028 . if @xmath179 , then @xmath1029 since @xmath1030 , and @xmath1031 suffices .",
    "if @xmath21 is real ( and non - zero ) , then @xmath673 may have zeros , but by ( [ eq : ftil ] ) there is an @xmath1032 such that for @xmath1027 , @xmath673 and @xmath21 have the same sign , and @xmath1033 .",
    "if the sign is positive , the branch cut is avoided , and if the sign is negative , we treat @xmath1034 in all formulas involving fractional powers of @xmath21 or @xmath673 , e.g.  @xmath1035 .",
    "if @xmath1036 were zero in ( [ eq : v : psi ] ) , @xmath1037 would be independent solutions , where @xmath1038 lemmas  [ lem : pows ] and  [ lem : prods ] justify replacing @xmath1039 by @xmath1040 and @xmath298 by ( [ eq : ftil ] ) to obtain an asymptotic formula for @xmath1041 : @xmath1042 we choose the integration constant in ( [ eq : xi : def ] ) so that @xmath1043 where @xmath983 was defined in ( [ eq : pq : def ] ) .",
    "this result is obtained by expanding the asymptotic formula for @xmath1041 in a binomial series and integrating term by term .",
    "we now look for solutions of ( [ eq : v : psi ] ) that are perturbations of @xmath1044 : @xmath1045 the functions @xmath1046 and @xmath1047 must satisfy @xmath1048 solutions of the homogeneous problem ( with @xmath1049 ) are @xmath1050 and @xmath1051 . using variation of parameters @xcite to solve the non - homogeneous problem yields an integral equation for the solution with initial conditions @xmath1052 , @xmath1053 : @xmath1054\\,dy.\\ ] ] the location of @xmath922 will be chosen below , and depends on @xmath21 and the @xmath1055 sign . simplifying the formula for @xmath1036 in ( [ eq : v : psi ] )",
    "gives its behavior to leading order as @xmath51 : @xmath1056 our goal is to use this in ( [ h : int : eq ] ) to produce solutions @xmath629 of ( [ eq : h : ode ] ) that decay like @xmath1057 .",
    "if we are successful , then ( [ eq : asym : u ] ) will follow from ( [ eq : vpm ] ) , ( [ eq : uv : relation ] ) , ( [ eq : xi : asym ] ) and @xmath1058^{-1/4 } =     \\frac {    x^{-1/4}e^{x^2/2}p_0(x)\\big[1 + o(x^{-4})\\big]}{(\\lambda/2)^{1/4 } } ,    \\qquad ( x\\rightarrow\\infty),\\ ] ] with @xmath982 as in ( [ eq : pq : def ] ) . indeed , the factor of @xmath1059 can be dropped by linearity , and the factors of @xmath1060 , @xmath1061 and @xmath1062 combine to make @xmath1063 in ( [ eq : asym : u ] ) , as claimed .",
    "the coefficients of @xmath982 were obtained from ( [ eq : p : derive ] ) using ( [ eq : ftil ] ) , @xmath1064 , lemmas  [ lem : pows ] and  [ lem : prods ] , and the binomial series .",
    "let us therefore study solutions of the integral equation ( [ h : int : eq ] ) .",
    "let @xmath1065 and @xmath1066 , depending on the case considered in ( [ eq : vpm ] ) .",
    "we drop the @xmath1055 subscript on @xmath657 and define @xmath1067\\psi(y ) , \\qquad    e(x , y ) = e^{2i\\beta\\{\\xi(y)-\\xi(x)\\ } } , \\qquad ( \\beta=\\pm1)\\ ] ] which appear in ( [ h : int : eq ] ) .",
    "we claim that there is an @xmath1068 ( depending on @xmath21 and @xmath1069 ) such that one of the following holds : @xmath1070 where @xmath1071 . if @xmath1072 , then @xmath231 and setting @xmath1073 suffices to establish case 1 . indeed , since @xmath1074 for @xmath1027",
    ", it follows that @xmath1075 in ( [ eq : xi : def ] ) is real , @xmath1076 is on the unit circle , and @xmath1077 for @xmath1078 , @xmath1079 . if @xmath385 , we see from ( [ eq : psi_f_asym ] ) that @xmath1080 as @xmath1081 .",
    "since @xmath1082 , there exists @xmath1068 such that @xmath1083 it then follows from ( [ eq : xi : def ] ) that @xmath1084 since @xmath1085 , we see that @xmath1076 lies inside or on the unit circle when @xmath1086 and @xmath1087 .",
    "thus , case 1 holds when @xmath1086 . interchanging @xmath32 and @xmath95 in ( [ eq : xi : order ] ) and evaluating @xmath1088 shows that case 2 holds when @xmath1089 .",
    "similar arguments show that if @xmath1090 , cases 1 and 2 hold when @xmath1089 and @xmath1086 , respectively .    in case 1",
    ", we set @xmath1091 in ( [ h : int : eq ] ) and send @xmath922 to infinity .",
    "this yields the equation @xmath1092(x ) , \\qquad    \\mathbb{k}[f](x ) = -\\int_x^\\infty k(x , y)f(y)\\,dy.\\ ] ] increasing @xmath1093 if necessary , we may assume @xmath1094",
    ". then @xmath1095 , where @xmath1096 is regarded as an operator on @xmath1097 , the banach space of bounded , continuous functions in the uniform norm .",
    "thus , @xmath1098 is the unique bounded , continuous function that satisfies the integral equation . by the dominated convergence theorem and leibniz integral rule",
    ", such a solution of the integral equation also satisfies the ode ( [ eq : h : ode ] ) .",
    "we note that @xmath1099 can be computed via the picard iteration @xmath1100 , @xmath1101 $ ] .",
    "standard estimates @xcite on the size of @xmath1102 in the picard iteration scheme give the bound @xmath1103 by ( [ eq : psi : asym ] ) , @xmath1104 as @xmath51 , as required .    in case 2 , we define @xmath1105(x ) = \\int_{r}^x k(x , y)f(y)\\,dy$ ] and proceed in the same manner , again assuming @xmath1106 .",
    "this establishes existence and uniqueness of a bounded , continuous solution of @xmath1107 $ ] , along with the bound @xmath1108 although @xmath946 will not in general approach 0 as @xmath51 , we will show below that it approaches a limiting value , @xmath401 , with @xmath1109 .",
    "defining @xmath1110 we find that @xmath1111 satisfies @xmath1112 $ ] , and hence ( [ eq : h : ode ] ) .",
    "thus , adjusting the initial condition from 0 to @xmath1113 merely shifts and rescales the solution .",
    "if we can show that @xmath1114 as @xmath51 , then @xmath1115 will be the desired solution of ( [ eq : h : ode ] ) that decays as @xmath1057 . to prove that @xmath1116 exists , we integrate ( [ eq : h : ode ] ) from @xmath275 to @xmath467 , assuming @xmath1117 : @xmath1118 recall that @xmath1066 distinguishes the case in ( [ eq : vpm ] ) .",
    "the first term on the right is @xmath1119 due to ( [ eq : h : bound ] ) and ( [ eq : psi : asym ] ) .",
    "if we can show that @xmath1120 , then we are done : ( [ eq : cauchy ] ) implies that for any sequence @xmath1121 with @xmath1122 , @xmath1123 is a cauchy sequence . so @xmath1124 exists .",
    "sending @xmath467 to @xmath802 and replacing @xmath275 by @xmath32 in ( [ eq : cauchy ] ) then gives @xmath1125 , as required .    to show that @xmath1120 , we differentiate the integral equation @xmath1107 $ ]",
    "this gives @xmath1126\\,dy ,    \\qquad ( x > r).\\ ] ] using the bound @xmath1127 for @xmath1128 , and breaking the integral in ( [ eq : h : deriv ] ) into two segments of length @xmath1129 , we obtain @xmath1130 where @xmath654 is a bound on @xmath1131 .",
    "the first integral on the right is bounded by @xmath1132 while @xmath1133 which decays super - exponentially as @xmath51 . since @xmath1134 ,",
    "the second integral in ( [ eq : h : deriv : bnd ] ) is bounded by @xmath1135 thus , @xmath1136 as claimed .",
    "a number of authors have proved that the spectral function @xmath1137 is absolutely continuous when the potential in the schrdinger equation is of bounded variation or decreases sufficiently rapidly at infinity ; see e.g.  @xcite .",
    "however , we are not aware of any work that establishes conditions to ensure that @xmath33 will be real analytic for @xmath231 . in this appendix",
    ", we prove this for the operator @xmath57 in ( [ eq : pde ] ) , studied throughout this paper .",
    "our proof will be to show that @xmath1138 in ( [ eq : asym : u ] ) can be made to depend analytically on @xmath21 in a complex neighborhood of each @xmath1139 .",
    "we can then construct a fundamental matrix @xmath364 for ( [ eq:1st : order : alt ] ) of the form @xmath1140 where @xmath1141 .",
    "the construction of @xmath1138 will involve a fixed - point ( i.e.  picard ) iteration , as in appendix  [ sec : asym ] , producing solutions for sufficiently large @xmath32 , say @xmath91 , where @xmath922 does not depend on @xmath21 in the neighborhood .",
    "similar to what we did in ( [ eq : xstar ] ) , we can express the fundamental matrix @xmath1142 with correct boundary conditions at @xmath61 in the form @xmath1143 where @xmath1144 depends analytically on @xmath21 near @xmath1145 , since @xmath1146 is an entire function of @xmath21 ( see @xcite ) while @xmath1147 is analytic in the neighborhood where @xmath1138 are analytic .",
    "the @xmath0-function may then be written @xmath1148 this equation clarifies the source of the discontinuity across the continuous spectrum in the @xmath0-function : when @xmath1149 changes sign , the growing and decaying solutions switch , i.e.  @xmath1150 and @xmath1151 reverse roles . from ( [ eq : m : diff ] ) , we know @xmath1152 .",
    "thus , @xmath1153 which is real - valued for real @xmath21 and analytic in the neighborhood on which @xmath1138 can be constructed to depend analytically on @xmath21 .",
    "reality of the final formula in ( [ eq : rho : prime ] ) for @xmath234 can be confirmed by noting that @xmath1154 with @xmath341 real and @xmath366 having complex conjugate columns ( since @xmath1155 ) .",
    "we note that ( [ eq : rho : prime ] ) could potentially be used to compute @xmath33 without complexifying @xmath21 , but by solving a terminal value problem as well as an initial value problem .",
    "this is the key idea of the fulton , pearson , pruess algorithm @xcite , though their derivation is different than ours and leads to a representation , namely ( [ eq : fpp : fn ] ) , that does not allow @xmath21 to be complex .",
    "the wkb analysis in appendix  [ sec : asym ] fails to produce analytic functions @xmath1138 because different formulas are used for the cases when @xmath1149 is positive or negative .",
    "the problem occurs in case 2 , where we adjusted @xmath1113 in ( [ h : int : eq ] ) to achieve @xmath1156 .",
    "in fact , ( [ h : int : eq ] ) is not the most general solution of ( [ eq : h : ode ] ) ; one could add to it a term of the form @xmath1157 , so that @xmath1158 and @xmath1159 .",
    "varying @xmath1160 and solving for @xmath1113 ( as we did with @xmath1161 ) leads to a one - parameter family of solutions of ( [ eq : h : ode ] ) that approach zero as @xmath51 , consistent with the observation at the beginning of appendix  [ sec : asym ] that the recessive solution is unique while the dominant solution is not .",
    "our task now is to analytically continue @xmath1162 from the upper @xmath21-half - plane into the lower half - plane , and @xmath1163 from the lower half - plane into the upper half - plane , in order to select the `` right '' dominant solutions",
    ".    it will be necessary to complexify @xmath32 in appendix  [ sec : asym ] , as well as in lemmas  [ lem : psi][lem : prods ] .",
    "we will use the letter @xmath96 ( to replace @xmath32 ) as there is no chance of confusion with the second component of @xmath405 in ( [ eq : y : ode ] ) .",
    "first , we modify the notation @xmath1164 to mean that there is a number @xmath1165 such that @xmath1166 and @xmath1167 are both defined and analytic on the region @xmath1168 , and , for all non - negative integers @xmath491 and  @xmath214 , @xmath1169 as @xmath1170 , i.e.  as @xmath1171 with @xmath96 remaining in @xmath1172 .",
    "we then have      since @xmath890 is entire , both @xmath890 and @xmath1174 are defined on @xmath1172 with @xmath1175 . defining @xmath1176",
    ", we see that ( [ eq : dn : psi ] ) holds with @xmath32 replaced by @xmath1177 and the integral interpreted as @xmath1178 . note that @xmath1179 . since @xmath1180 , we have @xmath1181 , @xmath1182 , and @xmath1183 .",
    "it follows that @xmath1184 .",
    "similarly , @xmath1185 .",
    "the rest of the proof of lemma  [ lem : psi ] works the same , i.e.  there is a polynomial @xmath905 of degree @xmath906 such that @xmath1186 , which converges to zero as @xmath1170 .",
    "since @xmath1187 satisfies @xmath1188 is easily modified to show @xmath1189 .",
    "in particular , there is an @xmath1093 large enough that @xmath1190 has no poles for @xmath1191 , which also follows from @xmath1192 and lemma  [ lem : psi : z ] .",
    "adapting lemma  [ lem : prods ] to the case of analytic functions on @xmath1172 is also straightforward , and implies that @xmath1193 $ ] satisfies @xmath1194 where the left - hand side is independent of @xmath21 .",
    "next we fix @xmath1139 and consider @xmath1195 , where @xmath1196 is the open ball of radius @xmath1197 centered at @xmath1145 . by ( [ eq : f : z : lam ] ) , we may increase @xmath1093 if necessary so that @xmath1198 .",
    "we then have @xmath1199 , which implies that @xmath1200 for @xmath1195 and @xmath1191 . since @xmath1201",
    ", we may increase @xmath1093 further if necessary to conclude that @xmath1202 for @xmath1191 , where @xmath1203 .",
    "as a result , @xmath1204\\big|<7\\pi/12 $ ] for @xmath1191 .",
    "thus , @xmath1205 , @xmath1190 and @xmath1206 are bounded away from the branch cut of the square root and fourth root functions for @xmath1195 and @xmath1207 . if we define @xmath1208^{1/4}[2\\psi(z)]^{1/4}u(z;\\lambda),\\ ] ] then @xmath1209 will satisfy ( [ eq : a1 ] ) iff @xmath1210 satisfies @xmath1211 this may be derived analogously to ( [ eq : uv : relation ] ) and ( [ eq : v : psi ] ) .",
    "we also define @xmath1212 and look for solutions of ( [ eq : v : psi2 ] ) of the form @xmath1213 $ ] .",
    "the equation for @xmath1214 is @xmath1215 we can solve this equation for @xmath1195 and @xmath1216 , where @xmath1217 this is done by solving the integral equation @xmath1218\\,d\\zeta,\\ ] ] where @xmath1219\\psi(\\zeta;\\lambda)$ ] , @xmath1220 , @xmath1221 is the path from @xmath96 to @xmath802 in the direction @xmath1222 , and @xmath1223 records the sign in ( [ eq : h : ode2 ] ) .",
    "thus , we seek a solution of @xmath1107 $ ] , where @xmath1224 focusing on the @xmath1225 case , we will show below that ( increasing @xmath1093 if necessary ) there is a positive , decreasing function @xmath1226 defined for @xmath1227 such that @xmath1228 and @xmath1229 for @xmath1230 , @xmath1231 and @xmath1227 .",
    "let @xmath1232 be the banach space of ( jointly ) holomorphic functions @xmath1233 that are bounded on @xmath1234 , with norm @xmath1235 .",
    "then since the integrand of ( [ eq : k2 ] ) is holomorphic in @xmath96 and @xmath21 for fixed @xmath827 and is uniformly dominated by @xmath1236 , @xmath1096 maps @xmath1232 to @xmath1232 and has norm @xmath1237 . indeed ,",
    "continuity of @xmath1238 follows from the dominated convergence theorem , and analyticity follows from morera s theorem and fubini s theorem .",
    "the fixed - point iteration @xmath12391 $ ] leads to a holomorphic function @xmath1240 that satisfies @xmath1241 $ ] and @xmath1242 .",
    "a change of variables shows that for any @xmath690 we have @xmath1243\\hat\\gamma\\,ds.\\ ] ] applying @xmath1244 $ ] and @xmath1245\\big\\}$ ] to this equation and setting @xmath38 shows that @xmath1246 satisfies ( [ eq : h : ode2 ] ) .",
    "finally , we will see below that @xmath1247 it follows that @xmath1248 , which converges to zero as @xmath1171 .",
    "in particular , for real @xmath32 , @xmath1249 as @xmath51 . as a result ,",
    "@xmath1250 for large @xmath32 , and @xmath1162 has the form ( [ eq : asym : u ] ) and depends analytically on @xmath1195 for fixed  @xmath32 . in the @xmath1251 case ,",
    "the same construction works on @xmath1252 , and in fact the partial sums @xmath1253 are related to those above by @xmath1254 for @xmath1255 , @xmath1195 . as a result , @xmath1256 for @xmath1257 . in ( [ eq : x0:def ] ) ,",
    "the point @xmath922 where @xmath1258 is defined can be any number greater than @xmath1093 .",
    "it remains to construct @xmath1226 so that @xmath1228 and ( [ eq : k : bnd ] ) holds .",
    "first we claim that @xmath1259 is a decreasing function of @xmath827 when @xmath1195 and @xmath1216 are fixed , and therefore remains bounded by 1 for @xmath1227 .",
    "focusing on the @xmath1225 case , this is equivalent to claiming that @xmath1260 is an increasing function of @xmath827 .",
    "this follows from @xmath1261 , where @xmath1262 . indeed , since @xmath1263 and @xmath1231",
    ", the arguments used above to bound @xmath1205 and @xmath1190 away from the branch cut also imply @xmath1264 therefore , the imaginary part of @xmath1265 is positive .",
    "note that @xmath1266 offsets the negative contributions from the other terms , which is why adjusting the contour of integration to point in the @xmath1267 direction allows us to analytically continue @xmath21 across the real axis .",
    "since @xmath1268 for @xmath1227 , the left - hand side of ( [ eq : k : bnd ] ) is bounded by @xmath1269 .",
    "increasing @xmath1093 if necessary , we claim there is a non - negative function @xmath1226 such that @xmath1270 and @xmath1271 for @xmath1227 , @xmath1230 , @xmath1195 .",
    "( we continue to assume @xmath1225 ) . to this end",
    ", we note that @xmath1272 , \\quad    c_2 \\doteq \\frac{\\zeta^{-11/2}}{\\sqrt{32}}[1-\\frac{45}{16}\\zeta^{-4}]^2 , \\quad    c_3 \\doteq -\\frac{\\zeta^{-9/2}}{\\sqrt2}[1-\\frac{135}{16}\\zeta^{-4}],\\end{gathered}\\ ] ] where we used ( [ eq : f : z : lam ] ) to compute @xmath1273 and @xmath1274 , which are independent of @xmath21 .",
    "increasing @xmath1093 if necessary , we may assume @xmath1275 , @xmath1276 and @xmath1277 for @xmath1278 .",
    "we already established that @xmath1279 for @xmath1195 and @xmath1278 , so @xmath1280 .",
    "it follows that @xmath1281 finally , for @xmath1230 and @xmath1262 with @xmath1227 , we have @xmath1282 $ ] , by the law of cosines . since @xmath1283 and @xmath1284 , @xmath1285 .",
    "it follows that @xmath1286 .",
    "defining @xmath1226 to be the right - hand side of ( [ eq : psi : bnd ] ) with @xmath1287 replaced by @xmath1288 , we have that @xmath1226 is a positive , decreasing function for @xmath1227 and @xmath1289 for @xmath1230 and @xmath1195 , as claimed . increasing @xmath1093 if necessary , @xmath1228 .                , _ the titchmarsh - weyl eigenfunction expansion theorem for sturm - liouville differential equations _ , in sturm - liouville theory , past and present , w.  o. amrein , a.  m. hinz , and d.  p. pearson , eds .",
    ", birkhuser , basel , 2005 ."
  ],
  "abstract_text": [
    "<S> we develop a spectrally accurate numerical method to compute solutions of a model partial differential equation used in plasma physics to describe diffusion in velocity space due to fokker - planck collisions . </S>",
    "<S> the solution is represented as a discrete and continuous superposition of normalizable and non - normalizable eigenfunctions via the spectral transform associated with a singular sturm - liouville operator . </S>",
    "<S> we present a new algorithm for computing the spectral density function of the operator that uses chebyshev polynomials to extrapolate the value of the titchmarsh - weyl @xmath0-function from the complex upper half - plane to the real axis . </S>",
    "<S> the eigenfunctions and density function are rescaled and a new formula for the limiting value of the @xmath0-function is derived to avoid amplification of roundoff errors when the solution is reconstructed . </S>",
    "<S> the complexity of the algorithm is also analyzed , showing that the cost of computing the spectral density function at a point grows less rapidly than any fractional inverse power of the desired accuracy . </S>",
    "<S> a wkb analysis is used to prove that the spectral density function is real analytic . using this new algorithm , we highlight key properties of the partial differential equation and its solution that have strong implications on the optimal choice of discretization method in large - scale plasma physics computations .    </S>",
    "<S> = 1    sturm - liouville theory , continuous spectrum , titchmarsh - weyl @xmath0-function , spectral density function , fokker - planck collisions , wkb approximation </S>"
  ]
}