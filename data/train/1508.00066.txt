{
  "article_text": [
    "the interaction of charged particle beams and the vacuum chamber environment can be quantified using the concept of impedance or wakefield  @xcite . in order to calculate electromagnetic fields in accelerators several different numerical approaches",
    "have been suggested and implemented in computer codes .",
    "such calculations for complicated three dimensional structures , however , remain a challenge even for today s parallel computers .",
    "the approaches suggested in papers  @xcite-@xcite allow one to obtain reliable results for rotationally symmetric and general three - dimensional structures even when using a personal computer . however , fully three dimensional calculations can be cumbersome and require long computation times .",
    "in contrast , for rotationally symmetric structures , the modelling is much simpler , the execution time is much shorter , and the required computational resources are relatively modest .",
    "many three - dimensional vacuum chamber components used in particle accelerators can be well - approximated with structures of rectangular cross - section whose height can vary as function of longitudinal coordinate but whose width and side walls remain fixed",
    ". three examples of such geometry are shown in fig .",
    "[ fig01 ] : ( a ) a corrugated structure that can be used as a dechirper  @xcite , ( b ) a rectangular tapered collimator , and ( c ) a vacuum chamber in a bunch compressor .",
    "calculation of the wakefields for such structures can be greatly simplified by expanding the field generated by the beam into fourier series . as it turns out ,",
    "each fourier harmonic can be solved separately , and the wakefield calculated as a sum of their contributions .",
    "this reduces the original 3d problem into a number of 2d ones , each of which requires much less computing resources than the original problem .        in this paper",
    "we derive the equations for the fourier harmonics and propose a computational scheme for their solution .",
    "the scheme was implemented in a computer code that we call echo(2d ) .",
    "the paper is organized as follows . in section  [ sec:2 ]",
    ", we apply the fourier transform in the horizontal direction ( the direction of constant width ) , and derive a system of equations for the fourier harmonics . in section  [ sec:3 ] , we prove that the longitudinal wake function satisfies the laplace equation with respect to the coordinates of the source particle . in section  [ sec:4 ] , we show that , in the general case , the wakefield of each harmonic can be described by four scalar functions of one variable .",
    "the description is further simplified in section  [ sec:5 ] where we assume that the entire structure has a horizontal symmetry plane , and then analyze the longitudinal and transverse wakefields near the system axis .",
    "an important symmetry relation for the wake function is established in section  [ sec:6 ] . in sections  [ sec:7 ] and  [ sec:8 ]",
    "we present a numerical algorithm for solving equations derived in section  [ sec:2 ] .",
    "several numerical examples obtained with the computer code echo(2d ) are described in section  [ sec:9 ] .",
    "the results of the paper are summarized in section  [ sec:10 ] .",
    "we consider a bunch of particles moving with the velocity of light @xmath0 through a metallic structure comprising an incoming pipe , a transition or cavity , and an outgoing pipe , an example of which is shown in fig .",
    "[ fig02 ] .",
    "the bunch is characterized by the charge distribution @xmath1 and the electric current density @xmath2 .",
    "we assume that the bunch is moving along a straight line parallel to the longitudinal axis of the system , and we neglect the influence of the wakefields on the bunch s motion .",
    "our problem is to find the electric and magnetic fields @xmath3 , @xmath4 , in the domain @xmath5 which is bounded transversally by perfectly conducting metallic walls , defined by the boundary @xmath6 of the domain @xmath5 .",
    "we need to solve maxwell s equations with the boundary conditions : @xmath7 where @xmath8 , @xmath9 , is an initial electromagnetic field in the domain @xmath10 and @xmath11 is a unit vector normal to the surface @xmath6 . while we consider the propagation of beams through vacuum , for the generality of the computational algorithm we included in eqs .",
    "arbitrary dielectric constant @xmath12 and magnetic permittivity @xmath13 .",
    "we choose a coordinate system with @xmath14 in the vertical and @xmath15 in the horizontal directions ; the @xmath16 coordinate is directed along the longitudinal axis of the system .",
    "the structures considered in this paper have constant width @xmath17 and a fixed location of the side walls ( in the @xmath15-direction ) .",
    "the charge density is localized within the interval @xmath18 and vanishes at the ends of the interval , @xmath19 .",
    "such a function can be expanded in fourier series @xmath20 it follows from the linearity of maxwell s equations , eqs .",
    "( [ eq01 ] ) and eq .",
    "( [ eq03 ] ) , that the components of electromagnetic field can be represented by infinite sums : @xmath21 for each mode number @xmath22 we can write an independent system of equations @xmath23 hence we have reduced the 3d problem , eqs .",
    "( [ eq01 ] ) , to an infinite set of independent 2d problems , eqs .",
    "( [ eq05 ] ) .",
    "our approach is similar to one used in  @xcite for solving maxwell s equations in the frequency domain .",
    "let us consider a line - charge beam with vanishing transverse dimensions , @xmath24 where @xmath25 , @xmath26 , define the transverse offset of the beam , @xmath27 is the local longitudinal coordinate in the bunch , @xmath28 is the bunch charge and @xmath29 is the longitudinal bunch profile [ for a point charge , @xmath30 .",
    "the longitudinal wake potential @xmath31 at point @xmath32 is defined as  @xcite @xmath33_{t=({z - s})/{c}}dz,\\ ] ] where the electric field on the right - hand side is the solution to maxwell s equation with the sources of eqs .",
    "( this field , of course , is also a function of @xmath25 and @xmath26 omitted in the arguments of @xmath34 for brevity ) .",
    "it is well known  @xcite that the longitudinal wake potential satisfies the laplace equation for the coordinates @xmath15 , @xmath14 , of the witness particle @xmath35    in order to express the wake potential in structures of constant width through one - dimensional functions we need to prove that the longitudinal wake potential satisfies also the laplace equation with respect to the coordinates @xmath25 , @xmath26 , of the source particle .",
    "this statement will actually be proven below for arbitrary structures without any restrictions on the structure geometry .",
    "the only requirement imposed on the system is that the incoming and outgoing waveguides have perfectly conducting walls .",
    "the proof is based on the directional symmetry relation between the wake potential @xmath31 for the case when the particle travels through the system in the positive @xmath16 direction , and the wake potential @xmath36 corresponding to the case when the particle travels through the same system but in the negative @xmath16 direction .",
    "it was shown in ref .",
    "@xcite that the two wake potentials are related by @xmath37 where @xmath38 @xmath39 is the permittivity of vacuum , @xmath40 and @xmath41 are two dimensional vectors , and @xmath42 , @xmath43 , are the green functions for the laplacian in the incoming and outgoing pipes with cross - sections , @xmath44 , @xmath45 : @xmath46 where @xmath47 is the boundary of @xmath48 .",
    "note that @xmath49 and @xmath50 are offsets of , respectively , the leading and the trailing particles in @xmath31 , while @xmath50 is the offset of the leading particle , and @xmath49 is the offset of the trailing particle in @xmath51 .",
    "note also that , according to the general property of the wake potentials  , @xmath51 satisfies the laplace equation @xmath52    with the help of green s first identity ( @xmath11 is the outward pointing unit vector normal to the line element @xmath53 ) , @xmath54 we can rewrite eq .  ( [ eq15 ] ) as @xmath55,\\ ] ] where we have used the symmetry of green s functions , @xmath56 , @xmath57 .",
    "we now apply the laplacian operator to the coordinates @xmath25 , @xmath26 in eq .",
    "( [ eq17 ] ) and use relation   to obtain @xmath58 this proves that the wake potential , in addition to being a harmonic function with respect to the coordinates of the trailing particle , is also a harmonic function with respect to the coordinates of the leading particle . to our knowledge , this general property of wakefields has not been previously reported in the literature .",
    "it is well known  @xcite that for rotationally symmetric structures the wake potential can be represented through one dimensional functions , with only one function for each azimuthal mode number @xmath22 , @xmath59 as it turns out , a similar , comparably simple representation exists for the wake potential in structures of rectangular cross - section and constant width ; however , in the latter case four one - dimensional functions are needed for each mode number @xmath22 .",
    "substituting eq .",
    "( [ eq07 ] ) into   we find for the charge distribution @xmath60 it then follows from maxwell s equations   that all components of the fields will be proportional to @xmath61 and using eqs .",
    "( [ eq04 ] ) and ( [ eq08 ] ) we find @xmath62 if we insert representation  ( [ eq11 ] ) into eq .",
    "( [ eq12 ] ) , we obtain the one - dimesional helmholz equation @xmath63 which has a general solution of the form @xmath64 finally from eq .",
    "( [ eq18 ] ) it follows that functions @xmath65 and @xmath66 satisfy equations @xmath67 these equations can again be easily integrated with the result : @xmath68 where @xmath69\\cosh(k_{x , m } y )      \\nonumber\\\\          & + \\left[w_m^{cs}(s)\\cosh(k_{x , m } y_0)+w_m^{ss}(s)\\sinh(k_{x , m }   y_0)\\right]\\sinh(k_{x , m } y ) .",
    "\\end{aligned}\\ ] ] thus , we have proven that , in structures of constant width , for each mode number @xmath22 four functions are needed to completely describe the longitudinal wake potential .",
    "these functions can be calculated as follows @xmath70 where the @xmath71 modal component of the wake potential @xmath72_{t=({z - s})/{c}}dz\\ ] ] is excited by a charge distribution that does not depend on @xmath15 , @xmath73    with a knowledge of the longitudinal wake we can calculate the transverse wakes . for example , the vertical wake potential , @xmath74 , can be easily found through the panofsky - wenzel theorem  @xcite @xmath75 in the next section we will analyze both the longitudinal and the transverse wakes assuming that the structure under consideration has a symmetry axis .",
    "let us consider a structure of constant width @xmath17 that also has a vertical symmetry plane , at @xmath76 .",
    "structures in fig .",
    "[ fig01 ] ( a ) and ( b ) possess this symmetry ; hence , they have a symmetry axis located at @xmath77 , @xmath76 . due to the symmetry , the wake potential satisfies the equation @xmath78 and eq .",
    "( [ eq21 ] ) simplifies : @xmath79 note that @xmath80    let us consider the transverse wakes in such structures .",
    "we first introduce the integrated wake functions ( sometimes called the step function response ) @xmath81 it then follows from that the transverse wake function can be written as @xmath82 where @xmath83 representations ( [ eq30 ] ) , ( [ eq31 ] ) , are valid for arbitrary offsets of leading and trailing particles .    for small offsets near the symmetry axis ,",
    "@xmath77 , @xmath76 , the transverse wake potential is usually expanded in taylor series , @xmath84 the first term in  ( [ eq32 ] ) is usually called the transverse _ dipole _ wake in the @xmath14-direction .",
    "it can be calculated as follows @xmath85 the second term in  ( [ eq32 ] ) is called the transverse _ quadrupole",
    "_ wake in @xmath14-direction ; it is obtained by @xmath86 the transverse wakes in the @xmath15 direction are obtained by equations corresponding to those of eqs .",
    "( [ eq33 ] ) , ( [ eq34 ] ) .",
    "note that @xmath87 .    in numerical calculations of structures with symmetry we can use the approach of paper  @xcite that allows us to reduce the calculation domain in half . indeed",
    "the charge distribution ( [ eq24 ] ) can be written as a sum of symmetric and antisymmetric parts @xmath88 where @xmath89 \\lambda(s),\\label{eq36}\\\\      \\rho_m^e(y_0,y , s)&=\\frac{1}{2}q\\left[\\delta(y - y_0)-\\delta(y+y_0 ) \\right]\\lambda(s).\\label{eq37 }      \\end{aligned}\\ ] ] in problems with the symmetric driving charges ( [ eq36 ] ) , the tangential component of the magnetic field will be zero in the symmetry plane ( the so called `` magnetic '' boundary condition ) . in problems with the antisymmetric driving charges ( [ eq37 ] )",
    "the tangential component of the electric field will be zero in the symmetry plane ( the `` electric '' boundary condition ) .",
    "thus , instead of solving the system of equations ( [ eq05 ] ) in the whole domain , one can solve two independent problems in half of the domain : one problem with the `` magnetic '' boundary condition at @xmath76 and one problem with the `` electric '' boundary condition at @xmath76 .",
    "this is true not only for the line - charge current distribution  ( [ eq07 ] ) , but for any arbitrary three dimensional charge distribution @xmath90 . from solutions @xmath91 and @xmath92 of the two problems we can easily find the one dimensional modal functions in eq .",
    "( [ eq27 ] ) : @xmath93",
    "in the general case , from the directional symmetry relation , eqs .  , discussed in section  [ sec:3 ]",
    ", one can not immediately infer the corresponding symmetry for the transverse wakes taken in the positive and negative directions .",
    "it turns out , however , that for structures of constant width with a symmetry axis , such a directional symmetry relation for the transverse wake potential can be proven .",
    "indeed , from the symmetry relation ( [ eq27 - 1 ] ) and eq .",
    "( [ eq21 - 1 ] ) follows the symmetry of the longitudinal wake potential , @xmath94 hence the directional symmetry relation  ( [ eq17 ] ) for the longitudinal wake potential can now be written as @xmath95;\\ ] ] and from the panofsky - wenzel theorem  ( [ eq25 ] ) it follows that @xmath96,\\nonumber\\\\      \\lambda(s )      & = \\int_{-\\infty}^s\\lambda(s')ds ' .",
    "\\end{aligned}\\ ] ] in the last equation we have used the vectorial notation for the transverse wake , @xmath97 .    let us now calculate the directional relation for the dipole and quadrupole wakes defined by eqs .",
    "( [ eq33 ] ) , ( [ eq34 ] ) .",
    "denote the vertical aperture of the incoming rectangular pipe by @xmath98 and that of the outgoing pipe @xmath99 .",
    "( both pipes have the same width @xmath17 . )",
    "the green function for poisson s equation in a rectangular pipe , @xmath100 , has been obtained by gluckstern , _ et al _  @xcite . for @xmath101 ,",
    "their result reads : @xmath102 \\frac{\\sinh^2\\frac{\\pi      ( x - w)}{4g_a}+\\cos^2\\frac{\\pi}{4g_a}(y+y_0)}{\\sinh^2\\frac{\\pi      ( x - w)}{4g_a}+\\sin^2\\frac{\\pi } { 4g_a}(y - y_0)}\\right\\}\\nonumber\\\\      & -\\ln\\left[{(x - w)^2+(y - y_0)^2}\\right ] .      \\end{aligned}\\ ] ] the last term is singular in the limit @xmath103 and @xmath104 .",
    "all other terms are finite for all admissible @xmath15 and @xmath14 , and the sum in the first term rapidly converges .",
    "the green s function of the outgoing pipe , @xmath105 , is obtained from   by replacing @xmath106 .",
    "it is then easy to see that the singular terms cancel in the difference @xmath107 ; hence this function is finite within the domain of its definition .",
    "if we follow the approach of paper  @xcite and use eqs .",
    "( 39 ) , ( 40 ) , ( 45 ) from that paper , then from eq .",
    "( [ eq41 ] ) our final result reads @xmath108,\\nonumber\\\\          w_{y , q}^{(-)}(s)-w_{y , q}(s )      & =      2c\\lambda(s)\\left [ z_{y , q}(g_a)-z_{y , q}(g_b)\\right ] , \\nonumber\\\\          z_{y , d}(g )      & =      \\frac{\\pi z_0}{12g^2}\\left[1 + 24\\sum_{m=1}^\\infty\\frac{m}{1+e^{2\\pi m ( w / g)}}\\right],\\nonumber\\\\      z_{y , q}(g )      & =      \\frac{\\pi z_0}{24g^2}\\left[1 - 24\\sum_{m=1}^\\infty\\frac{2m-1}{1+e^{\\pi(2m-1)(w / g)}}\\right ] .      \\end{aligned}\\ ] ]",
    "in this section we describe a particular realization of the implicit te / tm scheme introduced in  @xcite .",
    "the scheme will be discussed in the context of the finite integration technique  @xcite .     showing the positions of the voltage and magnetic flux components , height=188 ]    we will consider maxwell s equations in their integral form on a domain @xmath5 with the linear non - dispersive constitutive relations : @xmath109 let us start by introducing a grid - based decomposition of the entire computation domain @xmath5 into cell complex @xmath110 .",
    "we use here a three dimensional cartesian mesh in @xmath111 coordinates , with the corresponding indexing @xmath112 . unlike in finite - difference methods where one starts by allocating the field components ,",
    "we begin by taking the voltage along cell edges and the magnetic flux through cell facets as the computational unknowns : @xmath113 where @xmath114 is a mesh multi - index and @xmath115 . solving faraday s law in integral form for the front surface shown in fig .",
    "[ fig03 ] yields : @xmath116 note , that this representation is still exact , as @xmath117 is ( by definition ) the exact electric voltage along one edge of the cell , and similarly @xmath118 represents the exact value of the magnetic flux density integral over the cell surface .",
    "if we compose column vectors @xmath119 from all voltage and flux components , we can write the combination of all equations over all surfaces in an elegant matrix form as @xmath120 the matrix @xmath121 picks the affected components out of the long vector to make up the corresponding equation .",
    "@xmath121 is thus the discrete curl operator over the mesh @xmath110 . with an appropriate indexing scheme",
    "the curl matrix has a 3x3 block structure : @xmath122 the double - banded , topological @xmath123-matrices take the role of discrete partial differential operators .",
    "the second important differential operator in maxwell s equations ( [ eq01 ] ) is the divergence operator . in order to construct a discrete divergence operator",
    "we integrate maxwell s equation @xmath124 over the entire surface of a mesh cell depicted in fig .",
    "[ fig03 ] . by adding up the six fluxes for each cell and by writing down all such equations for the entire mesh we obtain a discrete analogue to the divergence equation : @xmath125    the discretization of the remaining maxwell equations requires the introduction of a second cell complex @xmath126 which is dual to the primary cell complex @xmath110 . for the cartesian grid",
    "the dual complex @xmath126 is defined by taking the foci of the cells of @xmath110 as gridpoints for the mesh cells of @xmath126 .",
    "we again introduce the computational unknowns as integrals @xmath127 where @xmath114 is a mesh multi - index and @xmath128 .    following an equivalent procedure for the remaining maxwell s equations , but using the dual cell complex @xmath126",
    ", we obtain a set of four discrete equations representing maxwell s equations on a dual grid : @xmath129 where the asterisk denotes the hermetian adjoint operator .    equations ( [ eq42 ] ) are completed by the discrete form of the material relations ( constitutive equations ) which appear ( in the simplest linear case ) as matrix equations @xmath130 with @xmath131 the discrete inverse permittivity matrix , and @xmath132 the inverse permeability matrix .     in @xmath133-plane.,height=188 ]        in the case of cartesian grids ( or , more generally , whenever the primary and dual grids are orthogonal ) all material operators can be represented by diagonal matrices .",
    "note that the material matrices contain both averaged material parameters , and the lengths and areas of the grid edges and faces , respectively . in the standard staircase approximation",
    "the material matrices contain elements ( without double indices for simplicity of notation ) @xmath134 with @xmath135 and the face areas and edge lengths of the primary and secondary grid given by @xmath136 , respectively .    in the conformal scheme  @xcite , we allow the cells of the computational grid to be only partially filled by a perfectly electric conducting ( pec ) material and with an arbitrarily shaped interface . to model",
    "such a case we modify only the elements of the material matrices : @xmath137 where @xmath138 denote the reduced cell areas and lengths , including only those parts inside the computational domain ( outside pec material ) , as shown in fig .",
    "[ fig04b ] .",
    "the complete set of equations ( [ eq42 ] ) and ( [ eq_material ] ) is referred to as maxwell s grid equations .    for our 2d rectangular structures ,",
    "maxwell s equations  ( [ eq01 ] ) reduce to the modal equations ( [ eq05 ] ) .",
    "in addition , the dual three - dimensional cell complex @xmath139 reduces to the two - dimensional plane complex shown in fig .",
    "[ fig04 ] . in maxwell",
    "s grid equations the discrete operator @xmath140 reduces to the diagonal matrix @xmath141 , where @xmath142 is the unit matrix",
    ".    system ( [ eq42 ] ) is a time - continuous and space - discrete approximation of problem ( [ eq05 ] ) .",
    "the next step is a discretization of the system in time .",
    "the field components can be split in time and the leap - frog method can be applied . with ",
    "electric / magnetic \" splitting , a well known yee s scheme  @xcite will be obtained .",
    "however yee s scheme has large dispersion errors along the grid lines . in the following we consider an alternative te / tm splitting scheme  @xcite , one that does not have dispersion errors in the longitudinal direction .",
    "let us rewrite eqs .",
    "( [ eq42 ] ) in an equivalent form @xmath143 where @xmath144 and @xmath145    applying te / tm splitting  @xcite of the field components in time to system ( [ eq43 ] ) , the following numerical scheme is obtained @xmath146 two - layer operator - difference scheme ( [ eq44 ] ) acquires the canonical form  @xcite @xmath147 where @xmath148 it was shown in  @xcite that stability of the method is insured if @xmath149 if the matrix @xmath150 is positive definite , then we can define a discrete energy as @xmath151 and the discrete energy conservation law holds @xmath152 the stability condition ( [ eq46 ] ) in the staircase approximation ( of the boundary in vacuum ) can be rewritten in the form @xmath153 this last condition resembles the well - known stability condition of the explicit fdtd scheme for one - dimensional problems .",
    "the maximal eigenvalue of the discrete operator @xmath154 fulfills the relation @xmath155 , and",
    "the stability condition of the scheme in the staircase approximation of the boundary in vacuum reads @xmath156 on an equidistant mesh the implicit scheme ( [ eq44 ] ) has a second order local approximation error in homogeneous regions .    relation ( [ eq49 ] ) does not contain information about the transverse mesh .",
    "hence the transverse mesh can be chosen independent of stability considerations .",
    "following the conventional procedure  @xcite , the dispersion relation can be obtained in the form @xmath157 where @xmath158 , @xmath159 , @xmath160 . with the  magic \" time step @xmath161",
    ", the scheme does not have dispersion in the longitudinal direction .    following the approach of  @xcite",
    "it is easy to show that charge conservation holds : @xmath162 where functions with overbars are defined as @xmath163",
    "in this section we rewrite scheme ( [ eq44 ] ) in component notation and discuss the algorithm of numerical solution .",
    "the field components @xmath164 at time level @xmath165 can be found as @xmath166,\\nonumber\\\\ \\mathbf{\\tilde{h}}_y^n&=\\mathbf{h}_y^{n-0.5}+\\alpha\\mathbf{m}_{\\mu_y^{-1}}\\left[-\\mathbf{p}_z\\mathbf{e}_x^n+k_{x , m}\\mathbf{e}_z^{n-0.5}\\right],\\nonumber\\\\ \\mathbf{e}_z^{n+0.5}&=\\mathbf{e}_z^{n-0.5}+2\\alpha\\mathbf{w}_e^{-1}\\mathbf{m}_{\\epsilon_z^{-1}}\\left[-k_{x , m}\\mathbf{\\tilde{h}}_y^n+\\mathbf{p}_y^{*}\\mathbf{\\tilde{h}}_x^n-\\mathbf{j}_z^n\\right],\\nonumber\\\\ \\mathbf{h}_x^{n+0.5}&=\\mathbf{\\tilde{h}}_x^{n}+\\alpha\\mathbf{m}_{\\mu_x^{-1}}\\left[\\mathbf{p}_z\\mathbf{e}_y^n-\\mathbf{p}_y\\mathbf{e}_z^{n+0.5}\\right]\\nonumber\\\\ \\mathbf{h}_y^{n+0.5}&=\\mathbf{\\tilde{h}}_y^{n}+\\alpha\\mathbf{m}_{\\mu_y^{-1}}\\left[\\mathbf{p}_z\\mathbf{e}_x^n+k_{x , m}\\mathbf{e}_z^{n+0.5}\\right],\\end{aligned}\\ ] ] where @xmath167 are auxiliary vectors and operator matrix @xmath168 is a sparse one , @xmath169.\\end{aligned}\\ ] ] the field components @xmath170 at time level @xmath171 can be found as @xmath172,\\nonumber\\\\ \\mathbf{\\tilde{e}}_y^{n+0.5}&=\\mathbf{e}_y^{n}+\\alpha\\mathbf{m}_{\\epsilon_y^{-1}}\\left[\\mathbf{p}_z^{*}\\mathbf{h}_x^{n+0.5}-k_{x , m}\\mathbf{h}_z^{n}-\\mathbf{j}_y^{n+0.5}\\right],\\nonumber\\\\ \\mathbf{h}_z^{n+1}&=\\mathbf{h}_z^{n}+2\\alpha\\mathbf{w}_h^{-1}\\mathbf{m}_{\\mu_z^{-1}}\\left[-k_{x , m}\\mathbf{\\tilde{e}}_y^{n+0.5}+\\mathbf{p}_y\\mathbf{\\tilde{e}}_x^{n+0.5}\\right],\\nonumber\\\\ \\mathbf{e}_x^{n+1}&=\\mathbf{\\tilde{e}}_x^{n+0.5}+\\alpha\\mathbf{m}_{\\epsilon_x^{-1}}\\left[\\mathbf{p}_z^{*}\\mathbf{h}_y^{n+0.5}-\\mathbf{p}_y^{*}\\mathbf{h}_z^{n+1}-\\mathbf{j}_x^{n+0.5}\\right]\\nonumber\\\\ \\mathbf{e}_y^{n+1}&=\\mathbf{\\tilde{e}}_y^{n+0.5}+\\alpha\\mathbf{m}_{\\epsilon_y^{-1}}\\left[\\mathbf{p}_z^{*}\\mathbf{h}_x^{n+0.5}-k_{x , m}\\mathbf{h}_z^{n+1}-\\mathbf{j}_y^{n+0.5}\\right],\\end{aligned}\\ ] ] where @xmath173 are auxiliary vectors and operator matrix @xmath174 is a sparse one , @xmath175.\\end{aligned}\\ ] ]    in the staircase approximation of the boundary , the material matrices @xmath132 , @xmath131 are diagonal , and the operators ( [ eq51a]),([eq51b ] ) are tri - diagonal matrices .",
    "the equations involving these operators can be solved easily by the  elimination \" method  @xcite . however ,",
    "the staircase approximation of the boundary results in first order convergence in the wake potential . in order to obtain second order convergence and avoid time step reduction , we use conformal method in the same way as described for the rotationally symmetric case in  @xcite .    in the original problem formulation ( [ eq01 ] )",
    ", we assumed that the structure walls are perfectly conducting .",
    "however , in order to use the fourier expansion ( [ eq04 ] ) , it is sufficient to require only that the walls at @xmath176 and @xmath177 be perfectly conducting .",
    "the bottom and top walls of the structure can have different boundary conditions ; for example , they can be specified to be metallic with finite resistivity . a similar approach for the case of rotationally symmetric geometry and the use of the staircase approximation for the boundaries was described in  @xcite . in echo(2d )",
    "we have realized a conformal version of the method for including boundaries with finite conductivity .",
    "details of the implementation of our algorithm will be published elsewhere .",
    "in this section we consider two example calculations : a corrugated pipe (  dechirper \" ) with perfectly conducting walls , and a tapered collimator with resistive walls .",
    "we compare results obtained with echo(2d ) with those of several 3d codes .    for our dechirper example we used the parameters of the dechirper experiment performed at the pohang accelerator laboratory  @xcite .",
    "the geometry is shown in fig .",
    "[ fig01]a .",
    "the dechirper structure is 1  m long , has a width @xmath178  mm , and is made of aluminum .",
    "the corrugations are characterized by the period @xmath179  mm , height @xmath180  mm , and aspect ratio @xmath181 .",
    "the gap between the jaws is adjustable ; at a nominal setting the full gap @xmath182  mm .",
    "we have performed calculations of the wakes for a gaussian bunch with rms length @xmath183  mm .",
    "the transverse dimensions of the bunch were assumed negligibly small . in the right plots of figs .",
    "[ fig05][fig06 ] , we show some of the harmonics @xmath184 and @xmath185 , calculated for @xmath186  cm .",
    "if the bunch passes through the middle of the structure , at @xmath101 , then only odd harmonics are excited . in the left plots of figs .",
    "[ fig05][fig06 ] , these functions are shown as continuous functions of @xmath187 ( denoted with subscript @xmath22 removed ) ; they are independent ( see appendix ) of the width parameter @xmath17 .",
    "( here we have used @xmath188  cm to obtain a denser sampling of the functions in the figures . ) finally , in fig .",
    "[ fig07 ] , we compare the longitudinal ( left plot ) and the dipole ( right plot ) wakes obtained with echo(2d ) with the existing , fully 3d code , echo(3d )  @xcite . in the calculation of the wake potentials , where the width @xmath186  cm , we used only the first 15 odd harmonics .",
    "we see that the agreement with the existing code is very good .",
    "( left ) , and the harmonics @xmath189 , 9 , 19 , of @xmath190 ( right).,height=226 ]     ( left ) , and the harmonics @xmath189 , 9 , 19 , of @xmath191 ( right).,height=226 ]        in table  [ table01 ] we compare the calculated average wakes ( the loss factor in the longitudinal case and the kick factors in the transverse cases ) with numerical results obtained with the time - domain code t3p of the code suite ace3p  @xcite .",
    "the results in the table , denoted by @xmath192 , have been normalized to analytical results , valid for infinitesimally small corrugations ( see @xcite ) .",
    "we see good agreement except for the case of the dipole wake .",
    "( note , however , that we have good reason to believe that @xmath192 should always be @xmath193 . )",
    "incidentally , it should be noted that in  @xcite the strength of the wakes of the pohang dechirper were measured , both the longitudinal and transverse wakes , and it was estimated that their measured ( effective ) @xmath192 was about 0.75 , a result that is in good accord with the echo(2d ) results .",
    ".for the pohang dechirper , for a gaussian bunch with @xmath183  mm : the ratio of the numerically obtained and the analytical result(see @xcite ) , that we denote by @xmath192 .",
    "we compare the results given in ref .",
    "@xcite , @xmath192[t3p ] , with the new results , @xmath192[echo ] . [ cols=\"<,^,^ \" , ]         as the second example problem we consider a symmetric , tapered collimator ( see fig .",
    "[ fig01]b ) .",
    "the dimensions are : width @xmath188  cm , height of large pipe @xmath194  cm , length of tapers @xmath195  cm ; height and length of the minimum gap section , @xmath196  cm and @xmath197  cm .",
    "as was mentioned above , echo(2d ) is capable of modelling structures with metallic walls of finite conductivity .",
    "the tapered walls and the walls of the minimum gap section are taken to have conductivity @xmath198  s / m ( a poor conductor ) , while the remaining surfaces are assumed to be perfectly conducting . in the left plot of fig .",
    "[ fig08 ] we compare the longitudinal wake for this collimator with one that has the same geometry but is perfectly conducting .",
    "the gaussian bunch in the simulations has an rms length @xmath199  cm .",
    "both wakes were obtained with echo(2d ) . in the right plot of fig .",
    "[ fig08 ] we compare the echo(2d ) wake potential with the one obtained using a fully three - dimensional , commercially available code cst  @xcite .",
    "the good agreement between the results indicates a good accuracy of the conformal meshing and the resistive wall modelling in echo(2d ) .        finally , in order to demonstrate the capabilities of the new code to calculate wakes of very short bunches , we give in fig .",
    "[ fig09 ] the calculated loss factor @xmath200 as function of bunch length in the 1  m - long pohang dechirper ( black plotting symbols ) .",
    "note that the shortest bunch length used in the calculations is @xmath201 m .",
    "for the shorter bunches , the loss factor in a 1  m - long structure is larger than the steady - state ( periodic ) result .",
    "we can see that by plotting on the same figure the difference of @xmath202 for a 2  m structure minus that for a 1  m structure ( the gray curve ) .",
    "note that the analytical , asymptotic value of the loss factor , for @xmath203 , is @xmath204  v / pc",
    "[ we have taken @xmath205  @xmath5 , structure length @xmath206  m , and half - gap @xmath207  mm ] , which agrees well with the linear extrapolation of the echo(2d ) steady - state results ( the gray curve ) .",
    "in this paper we presented a new method for solving electromagnetic problems and calculating wakefields excited by a relativistic bunch in a structure that is characterized by a rectangular cross - section whose height can vary as function of longitudinal coordinate but whose width and side walls remain fixed . using the fourier expansion of the fields , currents and charge densities , we derived a fourier representation of the wake potential in terms of four one - dimensional functions for each harmonic .",
    "we proved that the longitudinal wake is a harmonic function with respect of the coordinates of the leading charge . for a structure that has a horizontal symmetry plane we also proved an important symmetry relation of the wake function .",
    "a numerical method was proposed for solving fourier harmonics of the fields .",
    "the method does not generate dispersion in the longitudinal direction and it conserves the energy and charge in the calculations .",
    "the computer resources required to solve the system with several tens of the lowest harmonics are moderate and comparable to those needed for 2d rotationally symmetric calculations .",
    "the authors thank m.dohlus for helpful discussions . this work was supported by the department of energy , contract de - ac02 - 76sf00515 .",
    "the modal charge distribution , eq .",
    "( [ eq24 ] ) , in maxwell s equations , eqs .",
    "( [ eq04 ] ) , is independent of the structure width , @xmath17 .",
    "the same holds for the boundary conditions .",
    "hence the modal solution depends on @xmath17 only through the harmonic number @xmath208 .",
    "this fact allows us to consider components of the electromagnetic fields as continuous functions of the harmonic number , @xmath187 . the same is true for the longitudinal wake potential .",
    "if the continuous function @xmath209 , @xmath210 , is known , then we can find the solution for any arbitrary width @xmath211 as @xmath212    in order to find the function @xmath209 , @xmath210 , we can proceed in the following way .",
    "we take width @xmath17 large enough in order that the sampling of @xmath209 with step @xmath213 is dense enough for smooth interpolation of the function between the discrete values @xmath214 . due to the existence of perfectly conducting walls at @xmath176 and @xmath177",
    ", the discrete fourier harmonics do not contain a  zero \" harmonic with @xmath215 . at the same time it is reasonable to find the solution to this problem as well .",
    "then , using interpolation , we obtain a universal continuous function @xmath209 , @xmath210 , which is independent from the halfwidth @xmath216 ."
  ],
  "abstract_text": [
    "<S> we consider the calculation of electromagnetic fields generated by an electron bunch passing through a vacuum chamber structure that , in general , consists of an entry pipe , followed by some kind of transition or cavity , and ending in an exit pipe . </S>",
    "<S> we limit our study to structures having rectangular cross - section , where the height can vary as function of longitudinal coordinate but the width and side walls remain fixed . for such structures , </S>",
    "<S> we derive a fourier representation of the wake potentials through one - dimensional functions . a new numerical approach for calculating the wakes in such structures is proposed and implemented in the computer code echo(2d ) . </S>",
    "<S> the computation resource requirements for this approach are moderate and comparable to those for finding the wakes in 2d rotationally symmetric structures . </S>",
    "<S> numerical examples obtained with the new numerical code are presented .    </S>",
    "<S> pacs numbers : 41.60.-m , 29.27.bd , 02.60.cb , 02.70.bf    submitted to physical review special topics  accelerators and beams    desy-15 - 134 + slac - pub-16353 + august 2015 </S>"
  ]
}