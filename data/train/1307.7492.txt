{
  "article_text": [
    "in the course of numerical simulations of coasting beams in cyclotrons it turned out that the eigen - emittances  @xcite computed from the second moment matrices were not constant as one would expect for symplectic motion  @xcite .",
    "quite obviously there was something wrong in the interpretation of the data . in this article",
    "we trace this error back to a missing transformation .",
    "the simulation tool opal  @xcite uses global cartesic coordinates for the integration of the equations of motion ( eqom ) .",
    "the transformation to local co - moving coordinates is not always sufficient to analyze the data properly and to compare them with second moments matrices obtained from linear transfer matrix models like the one in ref .",
    "the solution of the problem might be trivial to ( some ) specialists , but due to the general context we consider it being worth a more general discussion .",
    "the problem that we refer to , can be briefly described by either one of the following questions :    1 .",
    "why are the transfer matrices at the entrance and exit of solenoid magnets considered to be non - symplectic  @xcite .",
    "is it true after all ?",
    "2 .   why is the entrance and exit of a bending magnet not considered to be non - symplectic ? 3 .",
    "is it possible to derive the transfer matrix of a bending magnet in cartesic coordinates ? 4 .",
    "how do we compare particle distributions generated by cartesic tracking codes with those generated by the transfer matrix formalism ?",
    "this work is dedicated to those readers that are not _ ad hoc _ able to give the answer to these questions or that are at least not sure about it .    in some sense",
    "this work is a continuation of ref .",
    "@xcite , where we derived new methods to `` solved problems '' with the general hamiltonian of a two - dimensional harmonic oscillator . here",
    "we start with the general lagrangian description of an harmonic oscillator and derive the hamiltonian from it .",
    "the comparison allows us to identify the conditions for the use of the lagrangian state vector compared to the hamiltonian state vector and how they can be transformed into each other .",
    "next we analyze the situation in case of solenoids and bending magnets and compare different interpretations .",
    "finally we apply the resulting ( simple ) transformation to our numerical problem .",
    "in order to formulate the lagrangian function @xmath0 of the @xmath1-dimensional harmonic oscillator , we define a state vector @xmath2 .",
    "we then write the lagrangian function of the harmonic oscillator in the most general way as a quadratic form : = ^t*l*. the matrix @xmath3 should be symmetric , as any antisymmetric component does not alter the lagrangian function @xmath4 and should therefore be physically irrelevant : = & * b * + * b*^t&*m * , where the matrices @xmath5 and @xmath6 are symmetric . written in components",
    "this is = ( q_ju_jkq_k+2q_jb_jkq_k+q_jm_jkq_k ) . with the @xmath7-matrix @xmath3 and the @xmath8-matrices @xmath5 , @xmath9 and @xmath6 .",
    "the lagrangian equations of motion ( eqom ) are : = lq_j .",
    "[ eq_lagrange ] the derivatives are explicitely : & = & m_jkq_k+b_kjq_k = p_j + lq_j&=&u_jkq_k+b_jkq_k + l&=&*m**q*+*b*^t*q*=*p * + l&=&*u**q*+*b**q * + so that one obtains for the eqom * q*=*u**q*+(*b*-*b*^t)*q*. [ eq_leqom ] as well - known , any matrix @xmath9 can be split into two matrices @xmath10 and @xmath11 , representing the symmetric and the antisymmetric part : _ s=(*b*+*b*^t)/2 + * b*_a=(*b*-*b*^t)/2 + if one compares this with eqn .",
    "[ eq_leqom ] , one finds that the eqom depend only on the antisymmetric ( `` gyroscopic '' ) part @xmath11 while the definition of the canonical momentum includes all components of @xmath9  @xcite .",
    "the number of parameters @xmath12 that can be found in the lagrangian are the parameters that are required to describe two symmetric @xmath8-matrices and an arbitrary @xmath8-matrix : = 2n(n+1)2+n^2=2n^2+n .",
    "for instance , systems with @xmath13 general degrees of freedom give @xmath14 , for @xmath15 this gives @xmath16 .",
    "nevertheless , with respect to the dynamics ( i.e. the eqom ) , some parameters can be omitted .",
    "as already mentioned , the symmetric part of @xmath9 does not enter the eqom and secondly , the lagrangian function can be multiplied by an arbitrary factor without effect on the dynamics .",
    "this is a consequence of the fact that in the lagrangian function appears on both sides of eqn .",
    "[ eq_lagrange ] , such that the any scaling factor applied to the matrix @xmath3 cancels out .",
    "however such a factor  even though irrelevant for the dynamics  changes the scale of the canonical momentum : = * m**q*+*b*^t*q*. [ eq_pcanonical ]    in summary one finds that the eqom derived from the above lagrangian contain @xmath17 dynamically relevant parameters .",
    "it equals the number of parameters that are required to define two symmetric @xmath8-matrices and an antisymmetric @xmath8-matrix , minus the scale factor : _",
    "d=2n(n+1)2+n(n-1)2 - 1=3n^2+n-22 . for @xmath13",
    "one finds @xmath18 and for @xmath15 we have @xmath19 .",
    "the hamilton function @xmath20 is obtained by & = & p_kq_k - l + h&=&*p*^t*q*-(*q*^t*u**q*+*q*^t*b**q*+*q*^t*b*^t*q*+*q*^t*m**q * ) + [ eq_hamilton0 ] we assume that the mass matrix @xmath6 is invertible and replace @xmath21 . if the hamiltonian state vector @xmath22 is defined as @xmath23 , then the hamiltonian function is derived in a few steps & = & ^t*h * + & = & + * p*^t*m*^-1*b*^t-*u * & -*b**m*^-1 + -*m*^-1*b*^t & * m*^-1 + * p * [ eq_hamiltonmatrix ] the symplectic unit matrix @xmath24 is given ( in this representation ) by _ 0=&*1 * + -*1*&*0 * , [ eq_sym_unit1 ] so that the hamiltonian eqom are + * p*&=&**_0*m*^-1*b*^t-*u * & -*b**m*^-1 + -*m*^-1*b*^t & * m*^-1 + * p * + & = & -*m*^-1*b*^t & * m*^-1 + * u*-*b**m*^-1*b*^t & * b**m*^-1 + * p * + the hamiltonian state vector @xmath22 and the lagrangian state vector @xmath25 are related by @xmath26 : + * p * + = & * 0 * + * b*^t&*m * +   + * q * + [ eq_phi_psi ] and + * q * + = & * 0 * + -*m*^-1*b*^t&*m*^-1 +   + * p * + this coordinate transformation is symplectic , if _ 0*q*^t=_0 , or explicitely _ 0&=&&*0 * + * b*^t&*m * + * * _ 0 & * b * + * 0*&*m * +   + & * 1 * + -*1*&*0 * + & = & & * m * + -*m*&*b*^t*m*-*m**b * +   + & & * m*=*1 * + & & * b*^t=*b * , i.e. it is symplectic , if ( and only if ) the mass matrix @xmath6 equals the unit matrix  @xcite and if @xmath9 is symmetric which means that no gyroscopic forces are present . only in this case",
    "it is legitimate to identify @xmath27 and @xmath28 ( up to a symplectic transformation ) .",
    "the first condition is usually fulfilled , if the system describes a _ single particle with @xmath1 degrees of freedom _",
    " instead of for example @xmath1 coupled particles with different masses in a linear chain .",
    "the second condition is not always fulfilled .",
    "consider for instance the transfer - matrix @xmath29 that describes the transversal motion of a charged particle through the fringe field of a solenoid magnet  @xcite . in the coordinate",
    "ordering used so far it is  @xcite : = 1&0&0&0 + 0&1&0&0 + 0&k&1&0 + k&0&0&1 + .",
    "[ eq_tsolenoid ] this is a nice example for the transformation from @xmath25 to @xmath22 ( or vice versa ) with non - vanishing gyroscopic terms .",
    "the matrices are formally _ non - symplectic _  @xcite , but it would be a misinterpretation to believe that the _ ( equation of ) motion _ in the fringe fields of solenoid magnets is _ non - symplectic_. this is not the case .",
    "the concept of symplectic motion is based on hamiltonian dynamics and it presumes the use of _ canonical _ momenta .",
    "the above transformation @xmath29 is only required if one uses the state vector @xmath25 instead of @xmath22 , i.e. the mechanical instead of the canonical momentum .",
    "if this difference is not properly taken into account , the motion _ appears _ to be non - symplectic  @xcite .",
    "the _ gyroscopic _ terms of the matrix @xmath11 are connected to the ( derivatives of the ) vector potential as one would expect by @xmath30 ( using units where @xmath31 and @xmath32 )  @xcite . in the linear 3-dimensional case one finds : _ a&= & 0&-b_z&b_y + b_z&0&-b_x + -b_y&b_x&0 +   + & & + a&=&*b**q*=*b*_s*q*+ -b_zy+b_y z + b_zx - b_x z + -b_yx+b_xy + , which directly yields a&=&(b_x , b_y , b_z)^t + & & + a&=&tr(*b*)=tr(*b*_s ) .",
    "assuming for the moment that @xmath33 one finds with @xmath34 that the matrix @xmath29 corresponds exactly to the 2-dim .",
    "transformation from @xmath25 to @xmath22 as given in eqn .",
    "[ eq_phi_psi ] .",
    "this matrix needs to be applied , since the _ entrance _ of a solenoid is a transition from the field free region where @xmath35 to a region with gyroscopic force , where the canonical momentum is not identical with the mechanical momentum  @xcite .",
    "the symmetric part of @xmath9 represents a symplectic transformation which is irrelevant for the dynamics expressed by the coordinates . in this sense",
    "it is a similar to a `` gauge field '' that changes exclusively the canonical momentum .",
    "the antisymmetric ( `` gyroscopic '' ) part of @xmath9 is ( in 3 dimensions ) equivalent to the magnetic field and one can literally identify the vector potential @xmath36 with @xmath37 .",
    "indeed the misinterpretation of the matrices that describe the entrance and the exit of solenoids magnets also leads to seemingly non - symplectic motion inside the solenoid magnet .",
    "the transfer matrix @xmath38 of the solenoid field is in the above coordinate ordering  @xcite : _",
    "sol= 1&0&ls&l(c-1 ) + 0&1&l(1-c)&ls + 0&0&c&-s + 0&0&s&c + , [ eq_msol ] where @xmath39 and @xmath40 , which is formally also non - symplectic .",
    "but the product of the matrix for the entrance field @xmath29 ( eqn .",
    "[ eq_tsolenoid ] ) , @xmath41 and @xmath42 turns out to be symplectic .",
    "hence we have : ( * t**m*_sol*t*^-1)_0(*t**m*_sol*t*^-1)^t=_0 + from which one derives in a few steps : ^-1_0(*t*^-1)^t&=&*m*_sol*t*^-1_0(*t*^-1)^t*m*_sol^t + _ 0&=&*m*_sol_0*m*_sol^t , so that one may also re - interpret the process as a transformation of the symplectic unit matrix : _ 0=*t*^-1_0(*t*^-1)^t .",
    "but in fact , what it really describes is a change of the vector potential .",
    "in the previous section we developed a proper interpretation of the matrices that describe particle motion at the entrance of a solenoid magnet .",
    "this raises the question , if there is an analog phenomenon at the entrance of bending magnets . in order to clarify this ,",
    "we rederive the transfer matrix of a bending magnet in the following .",
    "again we ignore motion parallel to the magnetic field , which is in this case the axial ( i.e. transverse vertical ) motion .",
    "motion of charged particles in electromagnetic fields is described by the lorentz force equation : = q(e+vb ) , written in cartesic coordinates : & = & q(e_x+v_yb_z - v_zb_y ) + d p_ydt&=&q(e_y+v_zb_x - v_xb_z ) + d p_zdt&=&q(e_z+v_xb_y - v_yb_x ) .",
    "we choose the @xmath43-coordinate as the vertical ( axial ) direction so that @xmath44 and @xmath45 and the horizontal coordinates .",
    "the motion in the median plane of a bending magnet is then ( in the absence of acceleration ) described by : & = & qv_yb_z + d p_ydt&=&-qv_xb_z + in a first step , we devide both equations by @xmath46 , which is ( in the absence of acceleration ) constant : & = & qmv_yb_z + d v_ydt&=&-qmv_xb_z + we consider the _ orbit _ as the trajectory of the reference particle and we aim for a description of the motion in the vicinity of the orbit , i.e. of the _ trajectories _ of particles with small deviations from the orbit .",
    "we start with the state vectors of the orbit @xmath47 and of the trajectory @xmath22 in cartesic coordinates @xmath48  @xcite : & = & * f*= 0&1&0&0 + 0&0&0&qmb_z + 0&0&0&1 + 0&-qmb_z&0&0 +   + since @xmath49 is the only relevant component in the median plane , we skip the `` z '' from now on .",
    "furthermore , we like to have a mathematically positive angular velocity and hence for positive charge we need to have a negative field @xmath49 , so that we define @xmath50 .",
    "a rotation in the horizontal plane is described by the following generator matrix  @xcite : _ rot&= & 0&0&-1&0 + 0&0&0&-1 + 1&0&0&0 + 0&1&0&0 +   + the coordinate transformation into the rotating frame is then done by subtracting the rotational `` force matrix '' from the matrix @xmath51  @xcite : & = & * f*= 0&1&&0 + 0&0&0&-qmb+ + -&0&0&1 + 0&-+qmb&0&0 +   + for synchronous rotation the rotational frequency @xmath52 must equal @xmath53 , so that one obtains in the co - moving frame & = & * f*= 0&1&&0 + 0&0&0&0 + -&0&0&1 + 0&0&0&0 +   + [ eq_rot ] next we consider small deviations from the orbit @xmath47 and write :",
    "_ o&=&*f*_o_o + ddt&=&*f * + ddt(-_o)&=&*f*-*f*_o_o + ddt&=&(*f*-*f*_o)+*f*_o .",
    "since the condition @xmath54 holds only for the orbit ( but not for all trajectories ) , we express the deviations by a taylor series which we evaluate at the orbit parameters and truncate to the linear terms : & = & 1_o-_ov_oc^2(v - v_o)=1_o(1-_o^2v_o^2c^2v - v_ov_o ) + & = & 1_o(1-_o^2_o^2vv_o ) + and b&=&b_o+d bdx(x - x_o ) + & = & b_o(1 + 1b_od bdxx ) + note that we did not include a term with @xmath55 , since a field change along the longitudinal coordinate contradicts our assumption that @xmath56 .",
    "we then find ( neglecting higher order terms ) : ( 1-^2 ^ 2v_ov+1b_od bdxx ) . and hence @xmath57 is given by *",
    "0&0&0&0 + 0&0&0&-f + 0&0&0&0 + 0&f&0&0 + , where f = qb_om(-^2 ^ 2v_ov+1b_od bdxx ) . to this point we merely transformed into the rotating frame .",
    "the _ global _ coordinates of the orbit in the rotating frame must be constant ( but not necessarily zero ) .",
    "the time derivative of the _ orbit _ must vanish in the rotating frame , so that we expect from eqn .",
    "[ eq_rot ] _",
    "o=0 , which is fulfilled by @xmath58 , if v_o=. this choice means that we choose @xmath44 to be the horizontal transverse and @xmath45 to be the longitudinal coordinate , from which we conclude that @xmath59 . then we find ( again skipping higher orders ) * f*=*f*(_o+)*f*_o , so that with @xmath60 one finds & = & ( * f*-*f*_o)_o+*f*_o + & = & 0 + -v_o(-^2 ^ 2v_ov+1b_od bdxx ) + 0 + 0 +   + & + & 0&1&&0 + 0&0&0&0 + -&0&0&1 + 0&0&0&0 +   + & = & 0&1&&0 + -v_o1b_od bdx&0&0&v_o^2 ^ 2v_o + -&0&0&1 + 0&0&0&0 + = * f * + we devide both sides by @xmath61 so that with @xmath62 we obtain & = & 0&1v_o&v_o&0 + -1b_od bdx&0&0&^2 ^ 2v_o + -v_o&0&0&1v_o + 0&0&0&0 +   + in the following we apply a sequence of 3 transformations described by matrices @xmath63 , where each transformation is of the general form & & * t*_i + * f*&&*t*_i*f**t*_i^-1 , where we omitted the tilde of the force matrix @xmath51 for a better readability .",
    "the first transformation matrix @xmath64 is used to scale the velocities by @xmath65 and is given by : _",
    "1=(1,1v_o,1,1v_o ) , so that = 0&1&v_o&0 + -v_o1b_od bdx&0&0&v_o^2 ^ 2 + -v_o&0&0&1 + 0&0&0&0 + , and hence @xmath66 is now given by : = ( x , v_xv_o , y , vv_o)^t . due to the choice of @xmath67",
    ", @xmath68 is the local horizontal , @xmath69 the local longitudinal coordinate and @xmath70 is the velocity deviation , so that with the field index @xmath71 define by @xmath72 and @xmath73 we obtain = 0&1&1&0 + -n_x^2&0&0&^2 ^ 2 + -1&0&0&1 + 0&0&0&0 + .",
    "next we transform from the velocity deviation to the momentum deviation using @xmath74 _",
    "2=(1,1,1,^2 ) .",
    "the result is : = 0&1&1&0 + -n_x&0&0&^2 + -1&0&0&1 ^ 2 + 0&0&0&0 + .",
    "[ eq_fb ]     in position a causes a deviation @xmath75 in position b , where one finds no direction difference in cartesic coordinates .",
    "interpreted in curvilinear ( i.e. cylindrical ) coordinates one has ( in first order ) a direction deviation @xmath76 .",
    "[ fig_curvilin],width=302 ]    the last transformation @xmath77 required to obtain the well - known transfer matrix of a bending magnet , transforms from the local co - moving cartesic system to the local co - moving _ curvilinear _ system .",
    "the transformation is explained in fig .",
    "[ fig_curvilin ] : _",
    "3= 1&0&0&0 + 0&1&1&0 + 0&0&1&0 + 0&0&0&1 + .",
    "[ eq_t3 ] this last transformation yields finally : = 0&1&0&0 + -1+n_x^2&0&0&1 + -1&0&0&1 ^ 2 + 0&0&0&0 + .",
    "the ( symplectic ) transfer matrix @xmath78 then is : _",
    "b&= & c&s&0&1-c1+n_x + -s&c&0&s + -s&-(1-c)1+n_x&1&s(1+n_x)^3/2+s^2-s1+n_x + 0&0&0&1 +   + s&= & + c&= & , [ eq_mb ] where the bending angle @xmath79 is given by @xmath80 .",
    "as in case of the solenoid magnet , it is possible to split the transfer matrix @xmath81 into 3 parts , first the transformation into curvilinear coordinates @xmath77 which then represents the fringe field ( without entrance angle ) , second the transfer matrix of the bending magnet `` itsself '' and finally the transformation @xmath82 back to cartesic coordinates .",
    "the transfer matrix for the bending magnet ( analog to @xmath41 as given in eqn .  [ eq_msol ] ) is the matrix exponent of the force matrix ( as given by eqn .",
    "[ eq_fb ] ) multiplied by the pathlength @xmath83 and is explicitely given by : _",
    "bend&= & + & = & c&s&s&(1-c)k + -n_xs&1+n_xck&(c-1)n_xk&x + -s&(c-1)k&c+n_xk&y + 0&0&0&1 +   + x&=&(^2 - 1)+n_x(^2s-)^2k^3/2 + y&=&(sk^3/2+(1 ^ 2 - 1k ) ) + k&=&1+n_x + s&= & + c&= & , where @xmath79 is the bending angle of the magnet and @xmath84 the bending radius or the orbit .",
    "then one verifies from eqn .",
    "[ eq_t3 ] and eqn .",
    "[ eq_mb ] : _ b=*t*_3*m*_bend*t*_3 ^ -1 , so that the complete symplectic transfer matrix of a bending magnet may be regarded as a product of 3 `` non - symplectic '' matrices , just as one finds it for solenoids .",
    "in essence we merely applied the equation = * t*_3*t*_3 ^ -1 , which we believe to reflect the essential difference in typical textbook descriptions of bending magnets ( left side , symplectic ) and solenoids ( right side , 3 times `` non - symplectic '' ) .    in order to facilitate comparison with sec .",
    "[ sec_solenoid ] , we go back to the coordinate ordering from sec .",
    "[ sec_lagrange ] , i.e. first the coordinates and then the momenta ( or `` velocities '' ) . the matrix @xmath77 is then written as _",
    "3= 1&0&0&0 + 0&1&0&0 + 0&1&1&0 + 0&0&0&1 + if we compare this with eqn .  [ eq_tsolenoid ] and eqn",
    ".  [ eq_phi_psi ] , then we find that the difference is merely the _ gauge _ represented by a symmetric matrix @xmath9 of the form _",
    "s= 0&-1 + -1&0 + . and",
    "as we derived above , a non - vanishing symmetric part of @xmath9 equals a symplectic gauge - transformation without influence on the dynamics of @xmath85 and @xmath28 .",
    "all the above developed formalism stays academic as long as we do not refer to a practical `` problem '' . in ref .",
    "@xcite we described an iterative method to determine the parameters of a matched beam matrix of second moments @xmath86 for cyclotrons with strong space charge forces . using samples with typically @xmath87 particles  @xcite , the parallel framework opal has been used to simulate coasting beams in cyclotrons similar to the psi ring machine  @xcite and some results have been presented  @xcite .     of a gaussian particle distribution tracked along the equilibrium orbit over one sector of a separate sector ring cyclotron .",
    "the transformation @xmath77 has not been applied .",
    "the horizontal eigenvalues ( thin solid line ) , the longitudinal eigenvalue ( dashed line ) and the product of both ( dotted line ) .",
    "the thick solid line shows the magnetic field in tesla .",
    "lower graph : the same figure after the transformation @xmath77 .",
    "the eigenvalues are all constant along the orbit as expected for symplectic motion .",
    "[ fig_opal],width=302 ]    the distributions turned out to be properly matched only for a starting position in the field free region ( i.e. between sector magnets ) , while the matching failed when the tracking started somewhere within the sector magnet . a detailled analysis ( including a cross check with a second tracking code without space charge solver ) suggested , that the eigen - emittances from the distributions evaluated in cartesic coordinates where constant only in constant field regions , but changed from valley to sector ( and vice versa ) .",
    "the transformation from the local cartesic to the local curvilinear coordinate system with the matrix @xmath77 as derived above solved the problem and verified that the motion is indeed symplectic .",
    "the eigen - emittances evaluated in local cartesic and local curvilinear coordinate systems are shown in fig .",
    "[ fig_opal ] as a function of time ( i.e. step - number ) .",
    "we investigated symplectic motion in magnetic fields using the examples of solenoid and bending magnets .",
    "we rederived the transfer matrix of a bending magnet starting from the lorentz force equation in cartesic coordinates .",
    "we found that the motion is symplectic in both types of magnets , if one takes the proper canonical momentum into account .",
    "furthermore it turned out that there is no essential difference between solenoid and bending magnets , despite the fact that they are often described differently .",
    "we also found that the _ curvature _ ( @xmath88 ) of the local coordinate system is intimately connected to the vector potential which is ( in linear approximation ) given by the matrix @xmath9 multiplied by the coordinates @xmath85 .",
    "we applied these findings to tracking of particle distributions in cartesic coordinates and gave the transformation between local curvilinear and local cartesic coordinates .",
    "we showed that the motion is formally symplectic only in local curvilinear coordinates .",
    "we thank j.j . yang for fruitful discussions about particle tracking with opal .",
    "00 the eigen - emittances are the eigenvalues of @xmath89 , where @xmath86 is the matrix of second moments and @xmath90 is the symplectic unit matrix .",
    "dragt , f. neri and g. rangarajan ; phys .",
    "a 45 ( 1992 ) , 2572 - 2585 . j. j. yang , a. adelmann , m. humbel , m. seidel , and t. j. zhang , phys . rev .",
    "beams 13 , 064201 ( 2010 ) .",
    "y. j. bi , a. adelmann , r. dlling , m. humbel , w. joho , m. seidel , and t. j. zhang , phys . rev .",
    "beams 14 , 054402 ( 2011 ) . c. baumgarten ; phys . rev .",
    "st accel . beams .",
    "14 , 114201 ( 2011 ) .",
    "a. w. chao and m. tigner ( ed . ) : handbook of accelerator physics and engineering ; world scientific , singapore 1999 , p. 269 . m. conte and w.w .",
    "mckay : an introduction to the physics of particle accelerators ( 2nd ed . ) ; world scientific , singapore 2008 , pp .",
    "87 - 91 . c. baumgarten",
    "; phys . rev .",
    "st accel . beams .",
    "14 , 114002 ( 2011 ) . c. baumgarten ; phys . rev .",
    "st accel . beams .",
    "15 , 124001 ( 2012 ) .",
    "r. talman : geometric mechanics ; 2nd ed .",
    ", wiley - vch weinheim , germany , 2007 .",
    "yakubovich and v.m .",
    "starzhinskii : linear differential equations with periodic coefficients ; john wiley and sons , new york , 1975 .",
    "frank hinterberger , physik der teilchenbeschleuniger ( springer , heidelberg 2008 ) , 2nd ed . c. baumgarten ; arxiv:1205.3601 .",
    "m. seidel et .",
    "al . ; proc of ipac 2010 , isbn 978 - 92 - 9083 - 352 - 9 , p. 1309",
    "- 1313 . c. baumgarten ; european cyclotron progress meeting 2012 , may 9 - 12 , villigen , switzerland ; slides are available under indico.psi.ch :      if one takes into account that the lagrangian allows for a scaling factor , the mass matrix effectivly has to be proportional to a unit matrix .",
    "we ignore the motion parallel to the magnetic field , which is in case of a solenoid the longitudinal coordinate .",
    "note that this transformation has no influence on the second moments of the particle displacements , i.e. the beam size ( or _ beam envelope _ ,",
    "respectively ) .",
    "but it indeed changes the eigen - emittances .",
    "here we choose a different coordinate ordering compared to sec .",
    "[ sec_lagrange ] in order to facilitate comparison with the conventional notation and we postpone the question , if the state vector is hamiltonian of lagrangian . in analogy to einstein s equivalence principle of a uniformly accelerated reference frame and the force of gravitation , a frame rotating at constant angular velocity is equivalent to a gyroscopic force , i.e. a `` magnetic '' field ."
  ],
  "abstract_text": [
    "<S> we take a new look at the details of symplectic motion in solenoid and bending magnets and rederive known ( but not always well - known ) facts . </S>",
    "<S> we start with a comparison of the general lagrangian and hamiltonian formalism of the harmonic oscillator and analyze the relation between the canonical momenta and the velocities ( i.e. the first derivatives of the canonical coordinates ) . </S>",
    "<S> we show that the seemingly non - symplectic transfer maps at entrance and exit of solenoid magnets can be re - interpreted as transformations between the canonical and the mechanical momentum , which differ by the vector potential .    in a second step </S>",
    "<S> we rederive the transfer matrix for charged particle motion in bending magnets from the lorentz force equation in cartesic coordinates . </S>",
    "<S> we rediscover the geometrical and physical meaning of the local _ curvilinear _ coordinate system . </S>",
    "<S> we show that analog to the case of solenoids - also the transfer matrix of bending magnets can be interpreted as a symplectic product of 3 non - symplectic matrices , where the entrance and exit matrices are transformations between local cartesic and curvilinear coordinate systems .    </S>",
    "<S> we show that these matrices are required to compare the second moment matrices of distributions obtained by numerical tracking in cartesic coordinates with those that are derived by the transfer a matrix method .    </S>",
    "<S> # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) # 1(#1 ) </S>"
  ]
}