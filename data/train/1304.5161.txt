{
  "article_text": [
    "quantum key distribution ( qkd )  @xcite allows two parties , alice and bob , to establish a common and secret key @xmath0 that is informationally secure ; see  @xcite and references therein .",
    "a widely used setup for qkd is the one suggested by bennett and brassard ( bb84 )  @xcite .",
    "bb84 is ideally implemented by preparing and transmitting single - photon pulses .",
    "information can be encoded in the state of one of two conjugate polarization bases , e.g. vertical / horizontal or diagonal / antidiagonal .",
    "only those photons that were prepared by alice and detected by bob in the same basis are useful to build a sifted key , which forms @xmath0 after additional steps of information reconciliation and privacy amplification .",
    "security follows from the inability of faithfully copying quantum information  @xcite and the unavoidable information - disturbance trade - off in quantum mechanics .",
    "nevertheless , realistic implementations of bb84 use weak coherent photon pulses that could involve many photons , avoiding the assumptions made in security analyses  @xcite . such pulses could be exploited by eve , the eavesdropper , to gain access to the ( insecure ) distributed key using a so - called photon - number splitting ( pns ) attack  @xcite . in a simple proposed pns attack , eve measures the number of photons in the pulse , @xmath1 . if @xmath2 , eve blocks the pulse . if @xmath3 , eve `` splits '' the pulse to obtain a copy of a single photon with the correct polarization and keeps it in her quantum memory .",
    "eve could then obtain a full copy of @xmath0 by making measurements of her photons in the correct polarization bases , which are known after a public discussion between alice and bob . since alice and bob can not measure @xmath1",
    ", a pns attack may go undetected .",
    "our goal is to provide a protocol for secure qkd in the presence of pns attacks .    a simple approach to overcome a pns attack considers reducing the probability of multi - photon pulses by reducing the coherent - pulse intensities .",
    "the drawback with this approach is that the probability of creating single - photon pulses is also reduced .",
    "then , the rate at which bits to build @xmath0 are sifted is far from optimal  @xcite .",
    "another approach is to use decoy states , that allow to detect pns attacks without a substantial reduction on the rate of sifted bits if eve is not present  @xcite . in a decoy - state protocol ( dsp ) , one of several weak coherent sources",
    "is randomly selected for each pulse .",
    "such sources create pulses of different intensities ( mean photon numbers ) .",
    "this gives alice and bob a means to estimate @xmath4 and @xmath5 , the number of bob s detections due to empty and single - photon pulses prepared by alice , in the same basis , respectively .",
    "the values of @xmath4 and @xmath5 are important to determine @xmath6 , the length of the secure key .",
    "for example , in the discussed pns attack , @xmath5 is substantially smaller than its value when eve is not present , and so is @xmath6 .    in more detail , we let @xmath7 be the total number of pulses prepared by alice .",
    "we first assume that the channel is non - adversarial , i.e. no eavesdropping attacks are present .",
    "if the pulse has a random phase , the number of photons it contains is sampled according to the poisson distribution : @xmath8 where @xmath9 is the mean photon number for that source and @xmath10 in applications .",
    "we let @xmath11 be the transmission / detection efficiency of the quantum channel shared by alice and bob .",
    "if @xmath12 ( @xmath13 ) denotes the event in which bob detects a non - empty ( empty or vacuum ) pulse , @xmath14 is the probability of a detection by bob given that alice s prepared pulse contained @xmath1 photons .",
    "@xmath15 is the so - called @xmath1-photon yield and @xmath16 due to losses in the channel . for @xmath17",
    ", we may assume @xmath18 which is a good approximation in applications .",
    "for @xmath19 , @xmath20 denotes bob s detector dark - count rate .",
    "the total probability of bob detecting a pulse ( in any one cycle ) is the total yield @xmath21 @xmath22 can be estimated by alice and bob , via public discussion , from the frequency of detections after all pulses were transmitted .    in qkd , we allow eve to manipulate the parameters that characterize the channel at her will .",
    "we use the superscript @xmath23 to represent the interaction of eve with the communication .",
    "for example , @xmath24 denotes the @xmath1-photon yield in the presence of eve . in a general intercept - resend attack ,",
    "eve may intercept a pulse and resend a different one .",
    "that is , each detection by bob is not guaranteed to come from the same pulse that alice prepared . in a simple pns attack ,",
    "eve makes non - demolition measurements of @xmath1 . with this information ,",
    "eve sets @xmath25 and @xmath26 for @xmath3 , so that @xmath27 then , if alice and bob can only estimate the total yields , a pns attack could be `` invisible '' with the right choices of @xmath28 . to increase the multi - photon yield ,",
    "eve may use an ideal channel to resend the pulses .",
    "( note that sophisticated pns attacks that do not change the poisson distribution are possible  @xcite . )",
    "a pns attack allows eve to have the full key @xmath0 if @xmath29 in this case , eve possesses a photon with the same polarization as that of the pulse detected by bob and no single - photon pulses are involved in creating @xmath0 . only if @xmath30 some security guarantees are possible  @xcite .",
    "such an inequality is satisfied when @xmath31 , implying a rate for sifted bits of order @xmath32 [ eq .  ] .",
    "this is undesirably small ( @xmath33 ) .",
    "remarkably , dsps give an optimal rate of order @xmath11 with small resource overheads . a goal in a dsp",
    "is to estimate @xmath34 and @xmath35 , which provide a lower bound on @xmath36 and @xmath37 , respectively .",
    "empty and single - photon pulses can not be split and the information carried in their polarization can not be faithfully copied , making them useful to create a secure key . for the estimation ,",
    "alice uses photon sources with different values of @xmath9 , but are identical otherwise .    in a conventional dsp",
    ", it is assumed that eve s pns attack treats every @xmath1-photon pulse equally and independently , regardless of its source .",
    "that is , eve s attack is simulated by independent and identically distributed ( i.i.d . )",
    "random variables .",
    "the total yield in this case is , for any given @xmath9 , @xmath38 equation   describes mathematically what we denote as the i.i.d . assumption .",
    "it follows that @xmath39 |_{\\mu=0 } \\ ; .\\end{aligned}\\ ] ] then , if eve s attack satisfies @xmath40 for all @xmath9 , @xmath41 that is , by being able to estimate @xmath42 for two values of @xmath43 via public discussion , alice and bob can restrict eve s attack so that the dark - count rate and single - photon yield are almost unchanged    from the non - adversarial case .",
    "in addition , if a third source with @xmath44 is randomly invoked , an optimal key rate of order @xmath11 will be achieved .    in reality , the estimation of @xmath45 and @xmath46 is subject to finite statistics and can be technically involved .",
    "nevertheless , the i.i.d .",
    "assumption in eq .",
    "allows alice and bob to gain information about eve s attack by running the protocol and analyzing the ( binomial ) distributions of the detection events for each source .",
    "however , we remark that if eve were to correlate her attacks , the i.i.d . assumption and",
    "the corresponding security analyses would be invalid .",
    "this is the main motivation behind our analysis .    in this paper ,",
    "we give an example that shows how the i.i.d .",
    "assumption can be simply bypassed by eve , resulting in security parameters that are worse from those obtained under the assumption .",
    "we then analyze the security of dsps for general pns attacks .",
    "our main result is an estimation procedure that gives a lower bound on @xmath36 and @xmath37 , with a confidence level that is an input to the estimation procedure .",
    "our security analysis does not use the i.i.d .",
    "assumption and is particularly relevant when eve performs a pns attack that could correlate different pulses in one session or even different sessions .",
    "we compare some results obtained by our estimation procedure with those obtained by using the i.i.d .",
    "assumption , and emphasize the important of our procedure .",
    "of high significance in cryptographic protocols is @xmath47 , the so - called security parameter .",
    "@xmath47 measures the deviation of a real protocol implementation from an ideal one .",
    "we use the same definition used in ref .",
    "@xcite , that states that a real qkd protocol is @xmath47-secure if it is @xmath47-indistinguishable from a perfectly secure and ideal one .",
    "this definition is equivalent to a statement on the trace norm of the difference between the quantum states resulting from the real and ideal protocol , respectively .",
    "it implies that a qkd protocol that is @xmath47-secure can be safely reused order @xmath48 times without compromising its security .",
    "usually , one fixes a value for @xmath47 and then determines the size of @xmath0 based on several protocol performance parameters .",
    "these parameters include the number of pulses sent by alice , the number of pulses detected by bob , and the estimated bit error rates at each mean photon number . for dsps",
    ", @xmath47 has a component @xmath49 that determines the confidence level in the estimation of a lower bound of @xmath36 and @xmath37 , due to finite statistics .    a possible way to obtain such lower bounds , under the i.i.d .",
    "assumption , is the one followed in ref  @xcite . in this case , we consider a dsp with three sources , @xmath50 . the mean photon number in each pulse , for each source , is @xmath51 , @xmath52 , and @xmath53 .",
    "each source @xmath54 randomly prepares a pulse with probability @xmath55 and we let @xmath56 be the total number of pulses for that source . @xmath56",
    "is known to alice and bob by public discussion after all pulses are sent and @xmath57 when @xmath7 .",
    "we write @xmath58 for the random variable that counts the number of pulses from source @xmath54 detected by bob under the presence of eve  @xcite .",
    "the exact value that @xmath58 takes in a session can also be obtained by alice and bob via public discussion after the pulses were transmitted .    under the i.i.d .",
    "assumption [ eq .",
    "] , @xmath58 is sampled according to the binomial distribution .",
    "then , @xmath59 is an estimator of the total yield @xmath60 $ ] , where @xmath61 $ ] denotes the mean value .",
    "that is , for a given @xmath62 , we can establish confidence intervals @xmath63 with confidence level @xmath64 . the constant @xmath65 depends on @xmath62 and can be obtained using chernoff s bound  @xcite  see appendix  [ app : chernoff ] . the standard deviation in this case is @xmath66 using eq .   for @xmath67 , we can search for the minimum values of @xmath45 and @xmath46 that satisfy eqs .",
    ", e.g. by executing a linear program .",
    "both @xmath45 and @xmath46 can then be used to obtain the desired lower bounds on @xmath36 and @xmath37 , respectively , with corresponding confidence level @xmath68 .",
    "this last step also requires using the i.i.d . assumption .",
    "we remark that eq .",
    "does not properly regard the problem of inferring a distribution for @xmath69 from the known @xmath70 , a problem that would require knowledge on the prior distribution of @xmath69 .",
    "the analysis in sec .",
    "[ sec : decoys ] used the i.i.d .",
    "assumption that resulted in a value for @xmath71 given by eq .  .",
    "nevertheless , the actual value of @xmath71 could be much higher in more general pns attacks .",
    "for the same confidence level , a bigger @xmath71 implies a `` wider '' confidence interval for the estimation of the yield @xmath69 ( appendix  [ app : chernoff ] ) , and thus smaller lower bounds on @xmath36 and @xmath37 . the overall result in",
    "the dsp is a secret key @xmath0 of smaller size for the same security parameter .    to illustrate how eve can bypass the i.i.d .",
    "assumption , we suggest a potential attack that results in almost no change for the total yields ( i.e. , @xmath72 )  @xcite but the variances @xmath71 are increased with respect to those of the binomial distribution [ eq .  ] .",
    "the suggested attack could be detected by alice and bob by estimating the variances directly via public discussion .",
    "nevertheless , it still shows that a better analysis of the security of dsps is needed to make rigorous claims .",
    "in the attack , eve first picks an integer value for @xmath73 , where @xmath74 denotes a scale for a variance or `` correlation '' of a particular distribution .",
    "eve receives all pulses from alice and we let @xmath75 be the total number of @xmath1-photon pulses in the protocol . note that the exact value of @xmath75 is known to eve but not to alice and bob . in general , @xmath75 is sampled according to the binomial distribution @xmath76 where @xmath77 is the probability of a pulse containing @xmath1 photons : @xmath78 .",
    "the mean and variance for such distribution are @xmath79 & = p_n k \\ ; , \\\\",
    "\\nonumber \\sigma^2_{k_n } & = p_n ( 1-p_n ) k \\ ; .\\end{aligned}\\ ] ]    given @xmath75 , eve randomly picks a value for @xmath80 , where @xmath81 is the total number of detections due to @xmath1-photon pulses prepared by alice .",
    "in particular , we assume that eve can control @xmath82 , which determines the dark - count rate .",
    "the distribution associated with @xmath83 has the following properties : @xmath84 & = y_n k_n \\ ; , \\\\",
    "\\nonumber \\sigma^2_{d^{\\ce}_n|k_n } & = \\tau^2 y_n ( 1-y_n )   k_n \\ ; .\\end{aligned}\\ ] ] we let @xmath85    be the number of @xmath1-photon pulses , prepared by alice s @xmath54th source only , and detected by bob .",
    "the exact value of @xmath85 is unknown to all parties . because eve does not know the source being used in the dsp , @xmath85 is sampled according to the binomial distribution when given @xmath86 : @xmath87 where @xmath88 the distribution associated with @xmath85 satisfies @xmath89 & = q_n^i d_n^{\\ce } \\ ; , \\\\",
    "\\nonumber \\sigma^2_{d_n^{i,\\ce}|d_n^\\ce } & = q_n^i ( 1-q_n^i ) q_n^\\ce \\ ; .\\end{aligned}\\ ] ]    as in sec .",
    "[ sec : decoys ] , we let @xmath90 be the variance associated with the random variable @xmath91 , where @xmath92 and @xmath93=y^\\ce(\\mu^i)$ ] . an accurate estimate of @xmath94 can be obtained if we approximate @xmath95 , in the limit of large @xmath96 .",
    "in addition , because @xmath96 is fixed , the variables @xmath75 are not independent .",
    "however , in the large-@xmath96 limit , @xmath75 can also be approximated by its mean value .",
    "it implies that the @xmath75 are almost independent and so are the @xmath86 and @xmath85 for different values of @xmath1 . under these approximations ,",
    "@xmath97 in appendix  [ app : attackstatistics ] we show that @xmath98 q_n^i y_n p_n k   \\ ; .\\end{aligned}\\ ] ] by inserting    eq .   in eq .",
    ", we can obtain the variances as a function of @xmath99 . in fig .",
    "[ fig : attack1 ] we compute @xmath100 and @xmath101 .",
    "the i.i.d . assumption discussed in sec .",
    "[ sec : decoys ] corresponds to @xmath102  see appendix  [ app : attackstatistics ]",
    ". using these results in eq .",
    "yields wider confidence intervals for the same confidence level .     and",
    "@xmath101 for an attack in which eve correlates @xmath1-photon pulses according to the value of @xmath99 .",
    "the channel parameters are @xmath103 , @xmath104 , @xmath105 , @xmath106 , @xmath51 , @xmath107 , @xmath108 , and @xmath109  @xcite . the results in sec .",
    "[ sec : decoys ] are recovered for @xmath102.,width=283 ]    to illustrate our point further , we consider a simple attack in which a single source @xmath110 is used to estimate the dark - count rate . here , @xmath51 and @xmath111 is known . in the non - adversarial case",
    ", @xmath112 is sampled according to the binomial distribution with probability @xmath113 and known sample size @xmath114 .",
    "nevertheless , for the correlated attack , we assume that eve `` receives '' the @xmath115 pulses and groups them according to blocks of size @xmath74 .",
    "then , eve will force ( prevent ) the detection of all pulses in any one block with probability @xmath113 ( @xmath116 ) .",
    "the random variable @xmath112 for the correlated attack satisfies @xmath117 & = y_0 k_0 \\ ; , \\\\",
    "\\nonumber \\sigma^2_{d_0^\\ce } ( \\tau ) & =   [ y_0 ( \\tau^2)^2 - ( y_0 \\tau^2)^2]\\frac{k_0}{\\tau^2 } =   \\tau^2 y_0 ( 1-y_0 ) k_0 \\ ; , \\end{aligned}\\ ] ] and @xmath102 corresponds again to the i.i.d .",
    "assumption [ see eq .  ] .    in fig .",
    "[ fig : darkcount ] ( a ) , we plot the probability that @xmath118 satisfies @xmath119 + c \\sigma_{d_0^\\ce } ( 1 ) \\ge   z^{u,\\ce } \\ge e[z^{u,\\ce } ] - c \\sigma_{d_0^\\ce } ( 1 ) \\ ; , \\end{aligned}\\ ] ] for different values of @xmath65 and @xmath99 . for @xmath102",
    ", such a probability corresponds to the confidence level in eq .  .",
    "@xmath120=y_0 $ ] in this example . for the inverse problem , namely the estimation of @xmath113 from @xmath121 and @xmath115 , eq .   may be incorrect .",
    "we may then assume a uniform prior distribution for @xmath122 $ ] , and obtain the posterior distribution as @xmath123 which is plotted in fig .",
    "[ fig : darkcount ] ( b ) .",
    "our results demonstrate that , for a fixed security parameter , the accuracy in the estimation of the dark - count rate strongly depends on eve s attack and can be substantially different from the one obtained under the i.i.d .",
    "assumption ( @xmath102 ) .    , and confidence bounds , parametrized by @xmath65 .",
    "( b ) bayesian estimation of @xmath113 , the mean dark - count rate , assuming a uniform prior and for different correlated attacks [ eq .  ] .,width=294 ]",
    "we go beyond the i.i.d . assumption and study more general and correlated pns attacks , in which eve has full control on bob s detection events .",
    "the secure key - rate in a realistic implementation of qkd is  @xcite @xmath124 which determines the size of the distributed key as @xmath125 .",
    "@xmath126 is the total number of pulses detected by bob and prepared by alice in the same basis , that are useful for the sifted key . in bb84 , @xmath127 , where @xmath128 is the total number of detections .",
    "@xmath129 is a lower bound on @xmath130 , the number of @xmath1-photon pulses prepared and detected in the same basis .",
    "@xmath131 is the shannon entropy , @xmath132 and @xmath133 are coefficients due to the error correction and privacy amplification steps , ber is the total bit error rate , and @xmath134 is an upper bound to the bit error rate due to single - photon pulses only .    in a dsp , we characterize a general pns attack by the distribution @xmath135 see fig .",
    "[ fig : interceptresend1 ] for an example .",
    "our goal is to build an estimation procedure that places confidence intervals on @xmath136 and @xmath137 from the known @xmath58 .",
    "these intervals ultimately imply a lower bound on @xmath138  see eq .  .    , @xmath139 , and @xmath140",
    "each block represents the number of pulses with @xmath141 , respectively .",
    "the random variables @xmath75 indicate the number of @xmath1-photon pulses prepared by alice and the superscript @xmath54 denotes the source used for such pulses .",
    "eve s attack controls the number of detections by bob , due to @xmath1-photon pulses , through @xmath86 .",
    ", width=294 ]    we assume that there are three sources satisfying @xmath142 , and @xmath143 .",
    "nevertheless , our analysis can be easily generalized to the case in which more sources are present , where the estimation is more accurate . for each source ,",
    "bob s detections satisfy eq .  .",
    "if a simple relationship between each @xmath85 and @xmath86 could be found , we could execute a program to solve eqs .  .",
    "such a relationship could be obtained from the binomial distribution associated with @xmath85 , when given @xmath144 [ eq .  ] .",
    "our estimation procedure uses @xmath145 to determine the confidence intervals @xmath146 the corresponding confidence level for each inequality is @xmath147 .",
    "the upper and lower bounds are monotonic and invertible functions",
    ". then , @xmath148 with the same confidence levels .",
    "such confidence levels do not result from the binomial distribution as we are analyzing the inverse problem , namely the estimation of @xmath149 from the available information ( i.e. , @xmath58 and @xmath56 ) . from eqs .   and",
    ", we obtain @xmath150 see fig .",
    "[ fig : boundsfig ] for an example .    .",
    "the yellow blocks represent the number of pulses from source @xmath151 with @xmath19 and @xmath2 .",
    "the dark and blue blocks represent the total number of pulses with @xmath19 and @xmath2 , respectively .",
    "the confidence level for this case is not smaller than @xmath152.,width=294 ]    next , our estimation procedure executes a program to obtain @xmath153 and @xmath154 , the corresponding smallest values of @xmath112 and @xmath155 , subject to the constraints given by eqs .  .",
    "from the union bound , the confidence level in such values is @xmath156 , with @xmath157 when three sources are used .",
    "since @xmath158 and @xmath159 are sampled according to a binomial distribution when given @xmath126 ( i.e. , the preparation and detection basis are random ) , we obtain @xmath160 where the constant @xmath161 can be obtained using eq .  .",
    "the overall confidence level for the key rate @xmath138 is @xmath68 , where the security parameter satisfies @xmath162 in the next section we obtain the confidence intervals and levels specifically for our method .",
    "our method takes @xmath49 as input and outputs @xmath158 and @xmath159 . to satisfy eq .  , we can set @xmath163 and @xmath164 [ see eqs .   and ] .",
    "next , we will find @xmath165 and @xmath166 as required by eq .  .",
    "if @xmath167 depends on @xmath85 only , the probability that @xmath86 is smaller than @xmath167 is @xmath168 with @xmath169 when given @xmath149 , the random variable @xmath85 is sampled according to eq .  .",
    "from chernoff s bound ( appendix  [ app : chernoff ] ) @xmath170 and we choose the lower bound so that @xmath171 } \\ ; , \\end{aligned}\\ ] ] with @xmath172 . the error probability satisfies",
    "@xmath173 see appendix  [ app : errors ] . a similar analysis gives the upper bound @xmath174 } \\ ; , \\end{aligned}\\ ] ] with the same confidence level .",
    "then , to satisfy eq .  , it suffices to set @xmath175    to complete the estimation procedure , we invert eqs .   and and obtain @xmath176 we can then execute a program that finds the minimum values of @xmath112 and @xmath155 subject to eqs .  .",
    "for instance , a quadratic program can be used to search @xmath177 .",
    "such minimum values will be used in eqs .   and to obtain the key rate .",
    "a technical remark is in order . when @xmath178 , @xmath179 exponentially fast in @xmath1 .",
    "then , the contribution of large-@xmath1 terms in eqs",
    ".   is negligible .",
    "we can set a suitable cutoff @xmath180 in the number of photons per pulse in our analysis , to avoid unnecessary computational overheads in finding @xmath165 and @xmath166 , and with an insignificant impact in the estimated values .",
    "we analyzed general photon - number splitting attacks and pointed out that previous security analyses on decoy - state protocols for qkd made a strong assumption on the attack .",
    "we provided an estimation procedure that sets a lower bound on the size of the secure , distributed key , with the corresponding confidence levels .",
    "our procedure requires executing a program to find the minimum values of the number of detections due to empty and single - photon pulses , subject to constraints that are determined by the results of the protocol and by the desired security parameter .",
    "it results in rigorous security guarantees even if eve correlates her attack according to the number of photons in the pulse .",
    "we emphasize that our estimation procedure is not unique : any time that a confidence interval can be set as a function of publicly available information for general attacks , then an estimation procedure is possible .",
    "in addition , our choice of confidence intervals and @xmath181 is not essential and could be further optimized to improve the size of the secure key .",
    "we thank jane nordholt , kevin mccabe , raymond newell , charles peterson , and stephanie wehner for discussions .",
    "we thank the laboratory directed research and development ( ldrd ) program at los alamos national laboratory for support .",
    "we let @xmath183 be a random variable and @xmath184 the probability distribution .",
    "the random variable @xmath185 has the conditional distribution @xmath186 .",
    "the probability of @xmath187 is @xmath188 .",
    "then , it is easy to show @xmath189 + \\sigma^2_{e[y|x ] } \\ ; , \\end{aligned}\\ ] ] where @xmath190 is the variance of @xmath187 .",
    "also , @xmath191 = \\sum_{y=0}^k g(y|x ) y \\ ; \\end{aligned}\\ ] ] is the expected value of @xmath187 when given @xmath192 , @xmath193 } = \\sum_{x=0}^k f(x ) e[y|x ] - \\left ( \\sum_{x=0}^k f(x ) e[y|x ] \\right)^2 \\ ; \\end{aligned}\\ ] ] is the variance of @xmath194 $ ] , @xmath195 is the variance of @xmath187 when given @xmath192 , and @xmath196= \\sum_{x=0}^k f(x ) \\sigma^2_{y|x }   \\ ; \\end{aligned}\\ ] ] is the expected value of such a variance .    in the attack discussed in sec .  [",
    "sec : attack ] , @xmath96 is fixed and the distribution of @xmath75 satisfies @xmath79=p_n k \\ ; , \\\\ \\nonumber \\sigma^2_{k_n } = p_n ( 1-p_n ) k \\ ; .\\end{aligned}\\ ] ] next , @xmath83 is chosen such that , when given @xmath75 , @xmath197 = y_n k_n \\ ; , \\\\ \\nonumber \\sigma^2_{d_n^\\ce|k_n } = \\tau^2 y_n ( 1-y_n ) k_n \\ ; .\\end{aligned}\\ ] ] it follows that @xmath198 = \\tau^2 y_n ( 1-y_n ) p_n k \\ ; , \\\\ \\nonumber \\sigma^2_{e[d_n^\\ce|k_n]}= ( y_n)^2 \\sigma^2_{k_n}= ( y_n)^2 p_n ( 1-p_n ) k \\ ; .\\end{aligned}\\ ] ] then , @xmath199 when given @xmath200 , the distribution for @xmath85 satisfies @xmath89 = q_n^i d_n^{\\ce } \\ ; , \\\\ \\nonumber \\sigma^2_{d_n^{i,\\ce}|d_n^{\\ce } } = q_n^i ( 1-q_n^i ) d_n^{\\ce } \\ ; .\\end{aligned}\\ ] ] therefore , @xmath201 } = ( q_n^i)^2 \\sigma^2_{d_n^{\\ce } } \\ ; ,   \\\\   \\nonumber e[\\sigma^2_{d_n^{i,\\ce}|d_n^{\\ce}}]= q_n^i ( 1-q_n^i ) y_n p_n k \\ ; .\\end{aligned}\\ ] ] also , @xmath202 + \\\\ \\nonumber & + q_n^i ( 1-q_n^i ) y_n p_n k \\\\ \\nonumber & = [ ( \\tau^2 - 1 ) q_n^i ( 1-y_n ) + ( 1-q_n^i y_n p_n ) ] q_n^i y_n p_n k \\ ; .\\end{aligned}\\ ] ] the first term on the _ rhs _ vanishes when @xmath102 .",
    "the second term is @xmath203 so that @xmath204 ^ 2 \\ ; , \\end{aligned}\\ ] ] for @xmath102 .",
    "moreover , since @xmath205 ^ 2 \\ll y(\\mu^i ) \\ll 1 $ ] , then @xmath206 which shows that the case discussed in sec .",
    "[ sec : decoys ] , i.e. the i.i.d .",
    "assumption , corresponds to choosing @xmath102 in this case .",
    "chernoff s bound  @xcite sets a bound on the probabilities of `` rare '' events as a function of the standard deviation of the corresponding distribution .",
    "more precisely , we let @xmath207 be a set of i.i.d .",
    "random variables that satisfy @xmath208 and define @xmath209 .",
    "a general version of chernoff s bound implies @xmath210 + c \\sigma ] \\le   \\exp \\{- c^2/4 \\ } \\ ; , \\end{aligned}\\ ] ] where @xmath211 - ( e[x_j])^2}$ ] is the standard deviation . for the special case of the binomial distribution where @xmath212 with probability @xmath213 and @xmath214 otherwise , @xmath215 & = n a\\ ; , \\end{aligned}\\ ] ] and @xmath216 & = i_{a } ( k , n - k+1 ) \\\\ \\label{eq : chernoffboundbinomial } & \\le   \\exp \\{- ( k - n a ) ^2/(4 a ( 1-a ) n ) \\ } \\ ; .\\end{aligned}\\ ] ] here",
    ", @xmath217 is the so - called regularized incomplete beta function . to satisfy @xmath218",
    "\\le \\epsilon$ ] , it suffices to choose @xmath65 such that @xmath219 calculations of errors ----------------------      chernoff s bound for the binomial distribution [ eq .  ]",
    "implies that @xmath222 if we set , @xmath223 then @xmath224 as in eq .  .",
    "replacing @xmath225 by @xmath85 and @xmath149 by @xmath226 in eq .  , and solving the resulting quadratic equation , we obtain @xmath227 / ( 2q_n^i ) \\ ; .\\end{aligned}\\ ] ] that is , @xmath228 } } { 2 q_n^i } \\ ; , \\end{aligned}\\ ] ] that yields eq .  .",
    "changing @xmath229 provides the upper bound without changing @xmath181 , i.e. , the confidence level .        c. h. bennett and g. brassard .",
    "quantum cryptography : public - key distribution and coin tossing . in proceedings of ieee international conference on computers , systems and signal processing , pages 175179 , 1984 .",
    "d. mayers .",
    "quantum key distribution and string oblivious transfer in noisy channels . in advances in cryptology",
    " crypto  96 , volume 1109 of lecture notes in computer science , pages 343357 .",
    "springer , 1996 .",
    "our definition of @xmath58 does not imply that the same @xmath1-photon pulse created by alice is detected by bob , as eve may be replacing each pulse at her will .",
    "@xmath58 only gives information about detections corresponding to those clock cycles in which alice prepared the pulse with source @xmath54 .",
    "security will follow from the analysis on the bit error rates that will subtract those detections corrupted by eve as implied by eq .  .",
    "wassily hoeffding .",
    "probability inequalities for sums of bounded random variables .",
    "assoc . , 58 ( 301 ) : 13 , 1963 .",
    "h. chernoff . a note on an inequality involving the normal distribution .",
    "annals of probability , 9 : 533 , 1981 .",
    "the exact values of @xmath230 are irrelevant as alice and bob can not have exact estimates of the channel parameters such as @xmath11 , in general . if eve changes these values slightly , such changes will not be noticed ."
  ],
  "abstract_text": [
    "<S> decoy - state protocols provide a way to defeat photon - number splitting attacks in quantum cryptography implemented with weak coherent pulses . we point out that previous security analyses of such protocols relied on assumptions about eavesdropping attacks that considered treating each pulse equally and independently . </S>",
    "<S> we give an example to demonstrate that , without such assumptions , the security parameters of previous decoy - state implementations could be worse than the ones claimed . </S>",
    "<S> next we consider more general photon - number splitting attacks , which correlate different pulses , and give an estimation procedure for the number of single photon signals with rigorous security statements . </S>",
    "<S> the impact of our result is that previous analyses of the number of times a decoy - state quantum cryptographic system can be reused before it makes a weak key must be revised .    </S>",
    "<S> la - ur 13 - 20168 </S>"
  ]
}