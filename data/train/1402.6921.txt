{
  "article_text": [
    "quantum key distribution  ( qkd )  @xcite is a technology that provides a practical way to distribute a secret key between two distant parties using quantum physics and without making any assumptions on a potential eavesdropper s power .",
    "such a level of theoretical security can not be achieved using classical protocols .",
    "recently , the study of the practical security of qkd systems  @xcite has attracted a lot of interest from the scientific community ( see for example ,  @xcite ) .",
    "indeed , deviations between the theoretical description of a qkd protocol and its implementation , open security loopholes that can be exploited by an eavesdropper . demonstrations of partial or full eavesdropping against commercial discrete - variable qkd systems have been performed  @xcite .",
    "so far such hacking attacks were compiled on discrete variable systems as they were the only ones available at that time .",
    "however , recently a commercial qkd system using continuous variables ( cv )  @xcite , that features secure distances  @xcite comparable to commercial discrete - variable qkd systems , was released  @xcite .",
    "while the theoretical security of cv - qkd protocols has been established @xcite , the study of practical security of cv - qkd devices is far from sufficient ( see for example , @xcite ) .",
    "this is mostly due to the relative youth of the technology .",
    "recent work includes the extension from discrete - variable qkd to cv - qkd of an attack ( and solution ) that exploits the wavelength dependency of fiber beam splitters  @xcite .",
    "however , this attack was limited to the case where bob performs heterodyne detection , i.e. , he measures both quadratures of the electromagnetic field simultaneously  @xcite . in this paper",
    ", we propose another wavelength dependency attack ( along with a solution ) but this time one that can be applied to a cv - qkd system using homodyne detection .",
    "such a system also corresponds to those that are currently commercially available @xcite .    in ref .",
    "@xcite , an attack targeting the local oscillator calibration routine of a cv - qkd system was proposed together with a family of countermeasures that consisted in measuring the shot noise in real time .",
    "we propose and provide experimental evidence of a wavelength attack targeting the real - time shot noise measurement procedure proposed in ref .",
    "@xcite . by inserting light pulses at different wavelengths ,",
    "this attack allows the eavesdropper to bias the shot noise estimation even if it is done in real time .",
    "based on experimental evidence , we discuss the feasibility of this attack and suggest a prevention scheme by improving the previously proposed countermeasures .    in sec .",
    "[ background ] , we first recall the basics of a cv - qkd scheme based on a gaussian modulation of coherent states and homodyne detection .",
    "we present in detail how the relevant quantities , used to estimate the secret key rate of the protocol , are computed and tackle the problem of the shot noise evaluation procedure .",
    "then , we give the principle of the attack proposed in @xcite and the associated countermeasures . in sec .",
    "[ hack ] , we explain how the wavelength dependency of the fiber beam splitter at the receiver s side can be exploited to bypass the real - time shot noise measurement countermeasure and detail the various steps of our attack . in sec .",
    "[ fea ] , we study the practical feasibility of our scheme based on experimental values .",
    "finally , we show in sec .",
    "[ countermeasure ] how to improve the real - time shot noise measurement technique in order to detect our attack .",
    "the conclusion is given in sec .",
    "a typical cv - qkd system using homodyne detection  @xcite can be realized using the schematic given in fig .",
    "[ homodyne ] . in this scheme ,",
    "the weak signal and strong local oscillator are generated from the same coherent state pulse by a @xmath0 beam splitter .",
    "the signal is then modulated randomly following a gaussian distribution with variance @xmath1 and zero mean in both quadratures , by using phase and amplitude modulators .",
    "the signal and local oscillator are separated in time and modulated into orthogonal polarizations using a polarization beam splitter before being inserted into the channel .",
    "when these pulses arrive at bob s side , bob randomly selects @xmath2 or @xmath3 in order to measure either the @xmath4 or @xmath5 quadrature , respectively . after measuring ,",
    "either direct or reverse error reconciliation ( alternatively , postselection ) protocols are performed in order to recover a common shared key .",
    "this is then followed by privacy amplification to reduce the eavesdropper s ( eve ) knowledge to an arbitrary small amount  @xcite .",
    "homodyne detection plays a key role in cv - qkd implementations . to illustrate the new wavelength attack scheme ,",
    "let us first review the physical description of the homodyne detection .",
    "note that a more detailed explanation can be found in appendix  [ appendix 1 ] .",
    "here we assume that both the signal and the local oscillator are coherent states .",
    "the signal state is denoted as @xmath6 and the local oscillator is denoted as @xmath7 .",
    "the specific quadrature of the signal is related to bob s modulated phase @xmath8 and the substraction of the detector outcomes  @xcite .",
    "this can be expressed as @xmath9 here @xmath10 and @xmath11 are the photocurrents recorded by detector 1 and detector 2 , respectively ; @xmath12 is the efficiency of the detectors ; @xmath13 is the quadrature of the signal and @xmath14 is the quadrature of the vacuum state .",
    "when @xmath2 , @xmath15 and when @xmath3 , @xmath16 .    a clock signal , which is generated by the local oscillator in a practical cv - qkd system ( see fig .",
    "[ homodyne ] ) , is necessary for maximizing the output of the homodyne detection .",
    "however , it opens a potential loophole for the eavesdropper . in ref .",
    "@xcite , the local oscillator calibration attack was proposed , in which eve modifies the shape of the local oscillator pulse in order to induce a delay to the clock trigger . as a result ,",
    "the homodyne detection outcome will drop down after such a delay due to the circuit design , which results in a decrease of the detection response slope , i.e. , between the variance of the homodyne measurement and the local oscillator power .",
    "the value of the shot noise will be overestimated and consequently the excess noise present will be underestimated .",
    "hence , eve s presence will be underestimated .    to prevent this attack",
    ", bob can apply real - time shot noise measurements , which consists of two types of implementations  @xcite . in this paper",
    ", we concentrate on the first one as shown in fig .",
    "[ homo2 ] . in this scheme",
    ", an amplitude modulator is added on the signal path .",
    "bob randomly applies attenuation ratios @xmath17 and @xmath18 by the amplitude modulator to measure the shot noise level in real time .",
    "the measurement results will be directly used to estimate the shot noise in the data processing that follows .",
    "fiber beam splitters are one of the key components in an all - fiber qkd system .",
    "the most widely used technology in making fiber beam splitters is the so - called fused biconical taper technology  @xcite . as is described in ref .",
    "@xcite , the coupling ratio of fused biconical taper beam splitter varies with the wavelength of the input light . for sufficing different requirements",
    ", there are three types of fused biconical taper beam splitters : the single wavelength type , the wavelength flatten type and the double wavelength type . compared to the first two ,",
    "the double wavelength type fused biconical taper beam splitter is more popular commercially because of its relatively stable performance in a wide wavelength range .",
    "even so , it does not mean that it is totally wavelength independent .",
    "we experimentally tested two double wavelength type @xmath19 ( reflection / transmittance ) and a @xmath20 fused biconical taper beam splitter in our laboratory  @xcite .",
    "the relationship between their coupling ratios and wavelengths is shown in table  i.    [ thorlabs ]    .the transmittance @xmath21 of thorlabs  @xcite double wavelength type @xmath19 beam splitter and a @xmath20 beam splitter under different wavelengths @xmath22  ( nm ) . [",
    "cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]",
    "in this section , a hacking scheme on a cv - qkd system using homodyne detection is proposed . before introducing our scheme , two facts should be noted .",
    "first , in the improved cv - qkd scheme shown in fig .  [ homo2 ] , bob does not need to measure the intensity of the local oscillator because the shot noise level can be directly measured in real time . on the other hand ,",
    "very low light intensity is enough to trigger the clock  @xcite . in this case",
    ", eve can hack the system by only utilizing the wavelength dependent character of the fused biconical taper beam splitter .",
    "a full wavelength attack scheme is proposed for this situation . moreover , even if bob monitors the local oscillator intensity , by combining the local oscillator calibration attack  @xcite with the wavelength attack idea , eve can still successfully achieve all of the secure key information without being discovered .",
    "our attack scheme can be divided into two parts : attack part 1 and attack part 2 .      in this attack eve",
    "performs a full intercept - resend attack . for this purpose",
    ", she measures the information sent from alice by performing heterodyne detection on both the signal and the local oscillator .",
    "after which she obtains two quadrature values @xmath23 and @xmath24 . according to these measurement results , she prepares a new signal and local oscillator and sends them to bob . in this stage",
    ", two strategies can be used .    _ strategy",
    "a : _  suppose that bob does not monitor the local oscillator intensity . instead of preparing a signal state of amplitude @xmath25 along with a local oscillator of amplitude @xmath7 as in the regular intercept - resend attack , eve chooses a real number @xmath26 larger than 1 and prepares a signal state of amplitude @xmath27 along with a local oscillator of amplitude @xmath28 .",
    "the pulses are separated in time and orthogonal polarizations , as the original pulses were , and then sent onto bob . in this strategy ,",
    "bob measures the quadratures with a variance of @xmath29 and a realistic shot noise of @xmath30 , where @xmath31 is the excess noise in units of @xmath32 , and @xmath33 ( see appendix  [ appendix 1 ] for details ) is the shot noise variance without the attack .",
    "the excess noise bob estimates is equal to @xmath34n_0 $ ]  @xcite .",
    "if he still uses @xmath32 as the shot noise unit , the excess noise he estimates can be made arbitrarily close to zero for certain channel efficiencies by choosing the proper @xmath26 .",
    "for instance , by choosing typical values such as @xmath35 , @xmath36  @xcite and @xmath26 = 10 , the excess noise estimated by bob is @xmath37 .",
    "it reaches zero when @xmath38 , corresponding to @xmath39  db loss or about @xmath40  km of optical fiber link ( with loss assumed to be @xmath41  db / km ) .",
    "thus entirely compromising the security of the protocol .    _ strategy b : _",
    "suppose that bob monitors the local oscillator intensity and its linear relation with the shot noise . and",
    "eve performs the local oscillator calibration attack as proposed in ref .",
    "@xcite . in this strategy ,",
    "eve controls the slope of the homodyne detection response by calibrating the trigger time . according to the analysis in  @xcite ,",
    "the excess noise estimated by alice and bob is close to zero when the realistic shot noise is reduced by @xmath42 of the original level and @xmath43 .",
    "both of these strategies alone can not pass the protection test proposed in ref .",
    "@xcite ( fig .",
    "[ homo2 ] ) . under this technique",
    ", bob can easily monitor the shot noise level in real time , therefore he can modify the parameters immediately to fully protect against the above attacks . in order to",
    "not be discovered , eve should take one more step to keep the counter - measurement results normal .",
    "for this purpose , the wavelength dependent character of fused biconical taper beam splitter is utilized to nullify the protection measurement in the second part of the scheme .      in this attack ,",
    "eve prepares and resends two extra coherent state pulses with wavelengths different from the typical communication wavelength of @xmath44 nm . one of them is modulated the same polarization as the signal and the other with the local oscillator .",
    "so that when they reach bob s side , one goes into the signal path and the other goes into the local oscillator path .",
    "let us denote these pulses and also their intensities as @xmath45 and @xmath46 .",
    "eve randomly chooses the wavelengths of @xmath45 and @xmath46 from one of the following two sets : @xmath47 where @xmath48 @xmath49 denotes the transmittance of the @xmath20 fused biconical taper beam splitter corresponding to the different wavelengths ( see table  1 ) .",
    "as the transmittances are deviated from @xmath50 , an extra differential current proportional to the light intensity will appear in the final results .",
    "when bob applies strong attenuation ( @xmath17 ) on the signal , the extra differential current is primarily contributed by @xmath46 .",
    "this extra contribution is equal to @xmath51 or @xmath52 plus shot noise ( cf .",
    "( [ photocurr2 ] ) for details ) , where @xmath53 denotes the detector efficiency corresponding to the different wavelengths . as",
    "this contribution should have zero statistical average and positive variance , eve must ensure that @xmath54 and choose @xmath55 and @xmath56 with equal probability . in this case , the variance is approximately equal to @xmath57 .",
    "therefore eve should make @xmath58 for strategy a and @xmath59 for strategy b , in order to make the shot noise measurement results seem normal .    on the other hand ,",
    "when bob applies no attenuation ( @xmath18 ) on the signal , the extra differential current comes from both @xmath46 and @xmath45 .",
    "similarly , the differential current introduced by @xmath45 is @xmath60 or @xmath61 plus shot noise .",
    "eve makes @xmath62 and chooses @xmath63 and @xmath64 with equal probability . for convenience , we summarize the notations defined above as follows : @xmath65 by making @xmath66 , the contribution from @xmath45 will cancel the contribution from @xmath46 except for a small amount of shot noise , which keeps the influence to the quadrature measurement results at an acceptable level . a more rigorous analysis taking the shot noises into account is described in sec .",
    "[ fea ] and appendix  [ appendix_2 ] .",
    "in this section , we analyze bob s estimated excess noise under the two kinds of attacks proposed in sec .",
    "[ hack ] . for simplicity , we take @xmath67 ( @xmath68 ; @xmath69 ) , @xmath70 , @xmath71 and the intensity of the local oscillator @xmath72 ( in units of photo - electron number ) .",
    "let us analyze the measurement outcomes corresponding to @xmath46 and @xmath45 .",
    "first though , let us briefly review the method of estimating the excess noise in cv - qkd  @xcite . by denoting @xmath73 as the quadrature modulated by alice ( @xmath74 or @xmath75 ) and @xmath76 as the quadrature measured by bob ( @xmath77 or @xmath78 )",
    ", we note that @xmath79 here @xmath80 is the channel transmittance , @xmath81 is the modulation variance , @xmath31 is the excess noise , @xmath32 is the shot noise , @xmath12 is the efficiency of homodyne detector and @xmath82 is the electric noise ( all expressed in their respective units ) . among these parameters , @xmath12 and @xmath82",
    "are pre - known as the system parameters , @xmath32 is estimated by the local oscillator intensity from @xmath83 , and the others are estimated from alice and bob s correlated variables @xmath84 . the excess noise can then be estimated as @xmath85 in a later protection scheme given in ref .",
    "@xcite , two attenuation ratios , @xmath86 and @xmath87 , are introduced on the signal path .",
    "typically we set @xmath70 for shot noise estimation and @xmath71 for quadrature measurements .",
    "the variance of @xmath76 should be expressed as @xmath88 we can then estimate the parameters by @xmath89/\\tilde{n}_0 .",
    "\\end{array}\\ ] ] from now on , we denote @xmath90 as a constant value ( that is , the shot noise value when the system runs normally ) and @xmath91 and @xmath92 as the estimation values . let us now analyze how large @xmath91 and @xmath92 could be under the two different attack strategies .",
    "_ strategy a : _  the differential current @xmath93 at the output of the homodyne detection can be considered as the summation of @xmath94 and @xmath95 , which present the contributions from part  1 and part  2 of our attack scheme respectively .",
    "that is , @xmath96 , where the index @xmath68 denotes that bob applies the attenuation ratio @xmath97 . in strategy",
    "a , @xmath98 can be obtained ( cf .",
    "( [ xpapp ] ) ) by taking @xmath99 , and its variance can then be computed as @xmath100 + r_i\\eta\\eta_{ch}\\xi n_0 + v_{el}\\\\            & = r_i\\eta\\eta_{ch}(v_a + 2 + \\xi)n_0 + \\frac{n_0}{n } + v_{el}. \\end{array}\\ ] ] for @xmath101 , we derive its variance in appendix  [ appendix_2 ] ( cf .",
    "( [ vpart2i ] ) ) as follows @xmath102 thus the total variance is given by @xmath103 we can now get the estimations about the shot noise level and excess noise under strategy a to be @xmath104/\\tilde{n}_0 . \\end{array}\\ ] ] by choosing proper intensities @xmath45 , @xmath46 and @xmath26 , eve can make @xmath105 and @xmath106 arbitrary close to zero . for this purpose , we take @xmath107 , for example .",
    "assume @xmath35 , simple calculations show that eve can choose @xmath108 , @xmath109 , @xmath110 , @xmath111 and @xmath112 , which are @xmath113 orders of magnitude smaller than @xmath114 .",
    "_ strategy b : _",
    "as long as eve can change the slope of the homodyne detection response by calibrating the trigger time , the excess noise @xmath115 will be close to zero .",
    "let us assume the realistic shot noise is @xmath116 .",
    "it is easy to derive that @xmath117n_0 + v_{el } , \\end{array}\\ ] ] and @xmath118 is the same as in strategy a. here @xmath119 and @xmath120 are parameters chosen by eve , and she should make @xmath121 in order to keep the estimated parameters normal . therefore @xmath122n_0 + v_{el}\\\\                & ~~ + ( 1 - r_i)^2d^2 + ( 35.81 + 35.47r_i^2)d .",
    "\\end{array}\\ ] ] the shot noise level and excess noise under attack 2 can then be computed to give @xmath123/\\tilde{n}_0 . \\end{array}\\ ] ] by choosing proper intensities @xmath45 , @xmath46 and @xmath26 , eve can make @xmath105 and @xmath115 arbitrarily close to zero .",
    "let us take @xmath43 and @xmath35 , for example .",
    "again a simple calculation shows that , by choosing @xmath124 , @xmath125 , @xmath126 , @xmath127 and @xmath128 , we again get about @xmath113 orders of magnitude smaller than @xmath114 as in strategy a.    finally , we note that the intensities of the pulses in part 2 will affect the local oscillator intensity measurement .",
    "this effect is small due to the low strength of the pulses in part 2 , and eve can fully compensate it by decreasing the local oscillator intensity in part 1 and carefully calibrating the trigger time .",
    "in the former proposed scheme in the real - time shot noise measurement regime  @xcite , only two attenuation ratios @xmath17 and @xmath71 are applied on the signal path , and we have already shown that this is not enough to detect the wavelength attack .",
    "in fact , in that case , according to eqs .",
    "( [ vsa ] ) and ( [ vsb ] ) , the total noise @xmath129 can be written as a second - order polynomial of the attenuation ratio @xmath130 : @xmath131 where @xmath132 ( @xmath133 ) is the signal on the detection caused by the attack signal going through the signal path ( local oscillator path ) . the shot noise measurement procedure in ref .",
    "@xcite assumes that @xmath134 is a linear function of @xmath130 and this is why it is defeated by the wavelength attack , which uses the term @xmath135 to compensate for the terms @xmath136 and @xmath137 when @xmath138 .",
    "the countermeasure can be modified to thwart the wavelength attack by allowing bob to use a third attenuation ratio , thereby observing @xmath129 for three values of @xmath130 . this way the three coefficients @xmath139 of the polynomial @xmath140 can be obtained .",
    "the coefficient @xmath141 in front of @xmath142 should be 0 in an ideal setting . to avoid the wavelength attack ,",
    "it is enough that alice and bob ensure that @xmath143 . indeed , in that case , @xmath144 hence , @xmath145 ( since @xmath137 is not small compared to @xmath32 ) .",
    "as a result , @xmath146 , and it is not possible anymore to compensate @xmath137 with @xmath135 .    for instance , bob can randomly apply attenuation ratios @xmath147 , @xmath148 and @xmath149 to the amplitude modulator , with probabilities of @xmath150 , @xmath151 and @xmath151 respectively . as has been pointed out in ref .",
    "@xcite , this countermeasure has an impact on the overall key rate since some pulses are attenuated . in our example , assuming that @xmath152 of the pulses that are attenuated are discarded , the final key rate is the same as in ref .",
    "@xcite .",
    "it is worth noting that applying randomly several attenuation ratios on bob s side allows us to check the transmittance linearity with respect to the attenuation ratio in the same way as we do for the noise .",
    "this allows us for instance to defeat saturation attacks @xcite that rely on non - linearities of the detection apparatus .",
    "therefore this countermeasure defeats all currently known attacks on the detection apparatus of gaussian cvqkd , and is expected to constitute a strong defense against variants of these attacks .",
    "in addition to the procedure above , physical countermeasures such as adding wavelength filters before detection ( to ensure that the wavelengths used for the attacks are close to the system wavelength , which forces the attacker to use high - power signals ) , and a monitoring of the local oscillator intensity ( to detect these high - power signals ) are also suggested .",
    "in conclusion , we proposed two strategies to realize a wavelength attack targeting a practical cv - qkd system using homodyne detection . by inserting light pulses at different wavelengths , with intensities lower than the local oscillator light by three orders of magnitude",
    ", eve can bias the shot noise and the excess noise estimated by alice and bob .",
    "in other words , eve can tap all of the secure key information without being discovered .",
    "the real - time shot noise measurement scheme as proposed in ref .",
    "@xcite can not detect this type of attack .",
    "however , it can be improved by using three attenuation ratios to successfully fix this security loophole .",
    "moreover , other physical countermeasures , such as adding additional wavelength filters and monitoring the local oscillator intensity , are also suggested .",
    "we thank xiao - tian song and yun - guang han for providing the test data .",
    "this work was supported by the national basic research program of china ( grants no .",
    "2011cba00200 and no .",
    "2011cb921200 ) , national natural science foundation of china ( grants no .",
    "60921091 and no .",
    "61101137 ) .",
    "p. j. and s. k .- j .",
    "acknowledge support from the french national research agency , through the hipercom ( 2011-chri-006 ) project , by the direccte ile - de - france through the qvpn ( feder-41402 ) project , and by the european union through the q - cert ( fp7-people-2009-iapp ) project . c. w. acknowledges support from nserc .",
    "when a signal , described by the annihilation operator @xmath153 , is inserted to a photodetector with an efficiency of @xmath12 , the measured annihilation operator becomes @xmath154 , where @xmath155 denotes the vacuum mode .",
    "the input photons are converted to an electric current with strength @xmath156 , where @xmath157 is a constant amplification factor and @xmath158 represents the number of electrons . without loss of generality , we set @xmath159 for simplicity .      in general , we can calculate the variance of @xmath180 as @xmath184\\\\                                & = \\eta^2\\alpha^4_{lo}(2t-1)^2 + \\eta\\alpha^2_{lo}[1-\\eta+\\eta(2t-1)^2]\\\\                                & ~~+ 4\\eta^2\\alpha^2_{lo}t(1-t)(\\langle x^2_{\\phi}\\rangle + 1 ) \\end{array}\\ ] ] finally , the differential current introduced by excess noise and electric noise should be added  @xcite . hence , the total output current is @xmath185 with a variance of @xmath186 .",
    "v.  scarani , h.  bechmann - pasquinucci , n.  j.  cerf , m.  duek , n.  lutkenhaus , and m.  peev , _ rev .",
    "phys . _ * 81 * , 1301 ( 2009 ) .",
    "b.  qi , c.  -h .",
    "f.  fung , h.  -k .",
    "lo , and x.  ma , _ quant .  inf .",
    "comp . _ * 7 * , 73 - 82 ( 2007 ) .                                              c.  weedbrook , a.  m.  lance , w.  p.  bowen , t.  symul , t.  c.  ralph , and p.  k.  lam , _ phys .",
    "lett . _ * 93 * , 170504 ( 2004 ) ; c.  weedbrook , a.  m.  lance , w.  p.  bowen , t.  symul , t.  c.  ralph , and p.  k.  lam , _ phys .",
    "a. _ * 73 * , 022316 ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> imperfect devices in commercial quantum key distribution systems open security loopholes that an eavesdropper may exploit . </S>",
    "<S> an example of one such imperfection is the wavelength dependent coupling ratio of the fiber beam splitter . utilizing this loophole </S>",
    "<S> , the eavesdropper can vary the transmittances of the fiber beam splitter at the receiver s side by inserting lights with wavelengths different from what is normally used . here , we propose a wavelength attack on a practical continuous - variable quantum key distribution system using homodyne detection . by inserting light pulses at different wavelengths , this attack allows the eavesdropper to bias the shot noise estimation even if it is done in real time . based on experimental data , </S>",
    "<S> we discuss the feasibility of this attack and suggest a prevention scheme by improving the previously proposed countermeasures . </S>"
  ]
}