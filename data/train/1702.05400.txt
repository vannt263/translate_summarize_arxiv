{
  "article_text": [
    "the metabolism of a cell entails a complex network of chemical reactions performed by thousands of enzymes that continuously process intake nutrients to allow for growth , replication , defense and other cellular tasks @xcite .",
    "thanks to the new high - throughput techniques and comprehensive databases of chemical reactions , large scale reconstructions of organism - wide metabolic networks are nowadays available .",
    "such reconstructions are believed to be accurate from a topological and stoichiometric viewpoint ( e.g. the set of metabolites targeted by each enzyme , and their stoichiometric ratio ) . for the determination of reaction rates , large - scale constraint based approaches have been proposed @xcite .",
    "typically , such methods assume a steady - state regime in the system where metabolite concentrations remain constant over time ( mass - balance condition ) .",
    "a second type of constraints limit the reaction velocities and their direction . in full generality",
    "the topology of a metabolic network is described in terms of the chemical relations between the @xmath0 metabolites and @xmath1 reactions . in mathematical terms",
    "we can define a @xmath2 stoichiometric matrix @xmath3 in which rows correspond to the stoichiometric coefficients of the corresponding metabolites in all reactions . a positive ( resp .",
    "negative ) * @xmath4 * term indicates that metabolite @xmath5 is created ( resp . consumed ) by reaction @xmath6 . assuming mass - balance and limited interval of variation for the different reactions",
    ", we can cast the problem in terms of finding the set of fluxes @xmath7 compatible with the following linear system of constraints and inequalities :    @xmath8    where @xmath9 is the known set of intakes / uptakes , and the pair @xmath10 represent the extremes of variability for the variables of our problem .",
    "only in few cases the extremes are experimentally accessible , in the remaining ones they are fixed to arbitrarily large values .",
    "it turns out that @xmath11 , and the system is typically under - determined . as an example , the recon1 model of homo sapiens has @xmath12 fluxes ( _ i.e. _ variables ) and @xmath13 metabolites ( _ i.e. _ equations ) .",
    "the mass - balance constraints and the flux inequalities encoded in eqs .  - define a convex bounded polytope , which constitutes the space of all feasible solutions of our metabolic system .",
    "the most widely used technique to analyze fluxes in large scale metabolic reconstruction is flux balance analysis ( fba ) @xcite where a linear objective function , typically the biomass or some biological proxy of it is introduced , and the problem reduces to find the subspace of the polytope which optimizes the objective function .",
    "if this subspace consists in only one point , the problem can be efficiently solved using linear programming .",
    "fba has been successfully applied in many metabolic models to predict specific phenotypes under specific growth condition ( e.g. bacteria in the exponential growth phase ) . however ,",
    "if one is interested in describing more general growth conditions , or is interested in other fluxes than the biomass @xcite , different computational strategies must be envisaged @xcite .",
    "as long as no prior knowledge is considered , each point of the polytope is an equally viable metabolic phenotype of the biological system under investigation .",
    "therefore , being able to sample high - dimensional polytopes becomes a theoretical problem with concrete practical applications . from a theoretical standpoint the problem is known to be # p - hard @xcite and thus an approximate solution to the problem must be sought . a first class of monte carlo markov chain sampling techniques available to analyze large - dimensional polytopes was originally proposed three decades ago @xcite and falls under the name of hit - and - run ( hr ) @xcite .",
    "basically , it consists on iteratively collecting samples by choosing random directions from a starting point belonging to the polytope .",
    "unfortunately polytopes defined by large - scale metabolic reconstructions are typically ill - conditioned ( i.e. some direction of the space are far more elongated than others ) , and improved hr techniques to overcome this problem have been proposed @xcite and implemented in the context of metabolic modeling @xcite . despite the fact that these dynamic sampling strategies are often referred as uniform random samplers , the uniformity of the sampling is guaranteed only in an asymptotic sense , and often establishing in practice how long a simulation should be run and how frequently the measurement should be taken for a given instance of the problem requires extensive preliminary simulations which make their use very difficult under general conditions .",
    "note also that the problem of assessing how perturbations of network parameters affect the structure of the polytope is often of practical importance ; e.g. changing extremal flux values for studying growth rate curves or enzymopaties @xcite . in these situations in principle",
    "the convergence time of the algorithm should be established independently for each new value of the parameter .",
    "another limitation of this class of sampling strategies is the difficulty of imposing other constraints @xcite such as the experimentally measured distribution profiles of specific subset of fluxes ( typically biomass and/or in - take / out - take of the network ) , a particularly timely issue given the recent breakthrough of metabolic measurements in single cell @xcite , although recent attempts in this direction * * exist @xcite .",
    "recently , alternative statistical methods based on message passing ( mp ) techniques ( also known as cavity or bethe approximation in the context of statistical mechanics ) @xcite have been proposed @xcite , allowing for sampling of the polytope orders of magnitude faster than hr methods , under two main conditions : ( i ) the graphical structure of the graph must be a tree or , at least , locally tree - like ( i.e. without short loops ) , ( ii ) the rows of the stoichiometric matrix @xmath3 should be statistically uncorrelated . unfortunately ,",
    "neither assumption is really fulfilled by large - scale metabolic reconstructions . to give an example ,",
    "consider the rows of the stoichiometric matrix for _ ecoli - core _",
    "model @xcite .",
    "the rows corresponding to the adenosine - diphosphate ( adp ) and adenosine - triphosphate ( atp ) appear strongly correlated as both metabolites commonly appear in 11 reactions ; the same apply for the intracellular water and hydrogen ion that have 10 reactions in common . for these reasons",
    "mp methods suffer from all kind of convergence and accuracy problems .    in this work",
    "we propose a new bayesian inference strategy to analyze with unprecedented efficiency large dimensional polytopes .",
    "the use of a bayesian framework allows us to map the original problem of sampling the feasible space of solutions of eqs .  - into the inference problem of the joint distribution of metabolic fluxes .",
    "linear and inequality constraints will be encoded within the likelihood and the prior probabilities that via bayes theorem provide a model for the posterior @xmath14 .",
    "the goal of this work is to determine a tractable multivariate probability density @xmath15 able to accurately approximate the posterior even in the case of strongly row - correlated stoichiometric matrices .",
    "this strategy relies on an iterative and local refinement of the parameters of @xmath15 that falls into the class of expectation propagation ( ep ) algorithms .",
    "we report results of ep for representative state - of - the - art models of metabolic networks in comparison with hr estimate , showing that ep can be used to compute marginals in a fraction of the computing time needed by hr .",
    "we also show how the technique can be efficiently adapted to incorporate the estimated growth rate of a population of _",
    "we are going to formulate an iterative strategy to solve the problem of finding a multivariate probability measure over the set of fluxes @xmath16 compatible with eqs .  - . for a vector of fluxes satisfying bounds [ eq : bounds ]",
    ", we can define a quadratic energy function @xmath17 whose minimum(s ) lies on the assignment of variables @xmath16 satisfying the stoichiometric constraints in eq . :",
    "@xmath18    we define the likelihood of observing @xmath19 given a set of fluxes @xmath16 as a boltzmann distribution :    @xmath20    where @xmath21 is a positive parameter , the `` inverse temperature '' in statistical physics jargon , that governs the penalty of whose configurations of fluxes that are far from the minimum of the energy . in a bayesian perspective one can consider the posterior probability of observing @xmath14 as :    @xmath22    where the prior @xmath23\\right)}{\\nu_{n}^{sup}-\\nu_{n}^{inf}}\\label{eq : prior}\\ ] ] enforces the bounds over the allowed range of fluxes .",
    "the function @xmath24\\right)$ ] is an indicator function that takes value @xmath25 if @xmath26 $ ] and @xmath27 otherwise .",
    "we finally obtain the following relation for the posterior :    @xmath28    and eventually we will investigate the @xmath29 limit . neglecting terms that do not depend on @xmath16 , the posterior takes the form of    @xmath30    where we have not explicitly reported the normalization constant . by marginalization of eq .",
    "one can determine the marginal posterior @xmath31 for each flux @xmath32 .",
    "however , performing this computation naively would require the calculation of a multiple integral that is in principle computationally very expensive and can not be performed analytically in an efficient way .",
    "a standard way of approximately computing @xmath14 is through sampling methods , such as the hr technique .",
    "the accuracy obtained with hr depends of course on the number of samples , and sampling accurately can be very time consuming . in the following",
    "we develop an analytic approach to approximately compute marginal posteriors which is able to achieve results as accurate as the hr sampling technique for a large number of sampled points in a fraction of the computing time .",
    "but first , we will describe as a warm - up a naive analytic method to approximately compute marginal distributions @xmath31 .      as a first approximation one can think of replacing each exact prior @xmath33 with a single gaussian distribution @xmath34 whose statistics , i.e. the mean and the variance , are constrained to be equal to the one of @xmath33 .",
    "that is    @xmath35    we estimate the marginal posteriors from the distribution    @xmath36    notice that in this approximation fluxes result unbounded .",
    "marginals obtained by this strategy against the hit - and - run monte carlo estimate are shown is figure [ fig : ecolilocal ] ( cyan line ) for 9 representative metabolic fluxes of one of the standard model for red blood cell @xcite .",
    "marginals evaluated with this simple non - adaptive strategy differ significantly from the ones evaluated with the montecarlo sampling technique . in the following",
    "we will show how we can overcome this limitation by choosing different values for the means @xmath37 and the variances @xmath38 in eq .",
    "[ eq : gaussposterior ] making use of the expectation propagation algorithm .",
    "expectation propagation ( ep ) @xcite is an efficient technique to approximate intractable ( _ i.e. _ impossible or impractical to compute analytically ) posterior probabilities .",
    "ep was first introduced in the framework of statistical physics as an advanced mean - field method @xcite and further developed for bayesian inference problems in the seminal work of minka @xcite .",
    "let us consider the @xmath39 flux and its corresponding approximate prior @xmath40 .",
    "we define a _ tilted _ distribution @xmath41as    @xmath42    the important difference between the tilted distribution and the multivariate gaussian @xmath15 is that all the intractable priors are approximated as gaussian probability densities except for the @xmath39 prior which is treated _",
    "exactly_. for this reason we expect that this distribution will be more accurate than @xmath15 regarding the estimate of the statistics of flux @xmath43 without significantly affecting the computation of expectations . bearing in mind that it is a large number of _ exact _ priors ( _ i.e. _ the distributions @xmath44 ) that make the computation intractable and not a single one , we have introduced only one exact _",
    "intractable _ prior in @xmath41 .",
    "one way of determining the unknown parameters @xmath45 and @xmath46 of @xmath40 is to require that the multivariate gaussian distribution @xmath15 is as close as possible to the auxiliary distribution @xmath47 .",
    "intuitively , there are at least two possibilities to enforce this similarity : ( i ) matching the first and the second moments of the two distributions ( ii ) minimizing the kullback - leibler divergence @xmath48 ; these two methods coincide ( see details in supplementary note 1 ) .",
    "thus , we aim at imposing the following moment matching conditions :    @xmath49    from which we get a relation for the parameters @xmath45 , @xmath46 that is explicitly reported in section [ subsec : update - rule ] .",
    "ep consists in sequentially repeating this update step for all the other fluxes and iterate until we reach a numerical convergence .",
    "further technical details about the convergence are reported in subsection [ subsec : numerical - results ] . at the fixed point",
    "we directly estimate the marginal posteriors @xmath31 , for @xmath32 , from marginalization of the tilted distribution @xmath41 that turns out to be a truncated gaussian density in the interval @xmath50 $ ] ( see supplementary note 2 ) .    at difference from the non - adaptive approach",
    ", the ep algorithm determines the approximated prior density by trying to reproduce the effect that the true prior density has on variable @xmath51 , including the interaction of this term with the rest of the system .",
    "first , the information encoded in the stoichiometric matrix is surely encompassed in the computation of the means and the variances of the approximation since both the distributions @xmath41 and @xmath52 contain the exact expression of the likelihood .",
    "secondly , the refinement of each prior also depends on the parameters of _ all _ the other fluxes .    as an example of the accuracy of this technique we report in figure [ fig : ecolilocal ] ( red line ) the nine best marginals estimated by ep of the red blood cell against the results of hit - and - run monte carlo sampling .",
    "[ fig : ecolilocal ] suggests that this technique leads to a significant improvement of the non - adaptive approximation as the plot shows a very good overlap between the distributions provided by hr and ep .",
    "the entire set of marginals and a comparison with a state - of - the - art message passing algorithm @xcite is reported in the supplementary fig .",
    "2 .     sampling points .",
    "the cyan line is the result of the non - adaptive gaussian approximation while the red line represents the expectation propagation estimate .",
    "[ fig : ecolilocal ] ]      this section is devoted to compare the results of our algorithm against the outcomes of a state - of - the - art hit - and - run monte carlo sampling technique on three representative models of metabolic networks , precisely the _ ijr904 _",
    "@xcite , the _ cholnorm @xcite _ and the _ recon1 _",
    "@xcite models for _ escherichia coli _ , the _ cholinergic neuron _ and _ homo sapiens _ organisms respectively . in supplementary fig .",
    "3 we report results for a larger set of models all selected from the bigg models database @xcite .",
    "experiments are performed as follows .",
    "first we preprocess the stoichiometric matrix of the model in order to remove all reactions involving metabolites that are only produced or only degraded@xcite .    after the pre - processing",
    ", we run hr and ep , both implemented on matlab or as matlab libraries , to the reduced model .",
    "let us explain how the two methods work .",
    "starting from a point lying on the polytope , hr iteratively chooses a random direction and collects new samples in that direction such that they also reside in the solution space . in this work we use an optimized implementation of hr , called",
    "_ optgpsampler _ @xcite . regarding the hr simulations we set the number of sampled points to be equal to @xmath53 for an increasing number of explored configurations @xmath54 from @xmath53 to @xmath55 in most of the cases",
    "; for some specific models , i.e. very large networks having @xmath56 reactions , we explore up to @xmath57 points . concerning the ep algorithm we perform the same experiment setting the @xmath21 parameter to be equal to @xmath58 for almost all models .",
    "in only one case ( the recon1 model ) , we encountered convergence problems and thus we decreased it to @xmath59 .",
    "numerical convergence of ep depends on the refinement of parameters @xmath37 and @xmath38 or , more precisely , on the estimate of the marginal distributions of fluxes . at each iteration",
    "@xmath60 we compute an error @xmath61 which measures how the approximate marginal distributions change in two consecutive iterations .",
    "formally , we define the error as the maximum value of the sum of the differences ( in absolute values ) of the mean and second moment of the marginal distribution , that is @xmath62 if @xmath63 is smaller than a predetermined target precision ( we used @xmath64 , the algorithm stops .",
    "to quantitatively compare the two techniques we report here the scatter plots of variances and means of the approximate marginals computed via hr and ep .",
    "moreover we estimate the degree of correlation among the two sets of parameters computing the pearson product - moment correlation coefficient    notice that we can not have access to the exact marginals and that we assume that the results obtained by hr are exact only asymptotically .",
    "thus our performances , both for the direct comparison of the means and variances and for the pearson s coefficient , should be considered accurate if they are approached by the monte - carlo ones for an increasing number of explored points .",
    "the three large subplots in fig .",
    "[ fig : mainres ] show the results for _ escherichia coli _ , _ cholinergic neuron _ and _ homo sapiens _ respectively . for each organism",
    ", we report on the top - left panel the time spent by ep ( straight line ) and by hr ( cyan points ) and on the bottom - left panel the pearson correlation coefficients",
    ". both measures of time and correlation , are plotted as functions of the number of configuration @xmath54 obtained from the hr algorithm . as shown in these plots",
    ", we can notice that to reach a high correlation regime a very large number of explored configurations , employing a computing time that is always several orders of magnitude larger than the ep running time .",
    "this is particularly strinking in the case of the _ recon1 _ model , for which we needed to run hr for about 20 days in order to reach results similar to the outcomes of ep , that converges in less than one hour on the same machine .    to underline how ep seems to approach hr results in the asymptotic limit",
    ", we report in the rest of the sub - figures the scatter plots of the means ( top ) and the variances ( bottom ) of the marginals . on the @xmath65-axis we plot",
    "the ep means ( variances ) against the hr means ( variances ) for an increasing number of explored configurations , as indicated in @xmath66-axis .",
    "results clearly show that as @xmath54 grows , the points ( both means and variances ) are more and more aligned to the identity line : not only these measures are highly correlated for large @xmath54 , but they assume very similar values .",
    "this is remarkably appreciable in the results for @xmath67 model : for @xmath68 the means of the scatter plots are quite unaligned but as @xmath54 reaches @xmath69 , they almost lie on the identity line . in fact , means are poorly correlated for @xmath68 while the pearson correlation coefficient is close to 1 for @xmath70 .    * *    .",
    "the top - left plot shows the pearson correlation coefficients between variances and means estimated through ep and hr .",
    "the bottom - left panel reports the computing time of ep and hr for different values of _ t_. the plots on the right are scatter plots of the means and variances of the approximated marginals computed via ep against the ones estimated via hr for an increasing number of explored configurations _",
    "t._,title=\"fig : \" ] .",
    "the top - left plot shows the pearson correlation coefficients between variances and means estimated through ep and hr .",
    "the bottom - left panel reports the computing time of ep and hr for different values of _ t_. the plots on the right are scatter plots of the means and variances of the approximated marginals computed via ep against the ones estimated via hr for an increasing number of explored configurations _",
    "t._,title=\"fig : \" ] .",
    "the top - left plot shows the pearson correlation coefficients between variances and means estimated through ep and hr .",
    "the bottom - left panel reports the computing time of ep and hr for different values of _ t_. the plots on the right are scatter plots of the means and variances of the approximated marginals computed via ep against the ones estimated via hr for an increasing number of explored configurations _ t._,title=\"fig : \" ]      the ep formalism can efficiently deal with a slightly modified version of problem of sampling metabolic networks .",
    "suppose to have access to experimental measurements of the distribution of some fluxes under specific environmental conditions .",
    "we would like to embed this empirical knowledge in our algorithm , by matching the posterior distribution of the measured fluxes with the empirical measurements . within the ep scheme",
    ", this task corresponds to matching the first two moments ( mean and variance ) of the posteriors with the one defined by the empirical measurements . with the inclusion of",
    "empirically established prior knowledge , we want to investigate how the experimental evidence is related to the metabolism at the level of reactions or , in other words , we want to determine how fluxes modify in order to reproduce the experiments . in this perspective , the ep scheme can easily accommodate additional constraints on the posteriors by modifying the ep update equations as outlined in methods .",
    "we have tested this variant of ep algorithm on the _",
    "ijr904 _ model of _ escherichia coli _ for a constrained growth rate .",
    "in fact , one of the few fluxes that are experimentally accessible is the biomass flux , often measured in terms of doubling per hour . as a matter of example",
    "we decide to extract one of the growth rates reported in fig .",
    "3(a ) of @xcite ; the profile labeled as _ glc ( p5-ori ) _ can be well fitted by a gaussian probability density of mean @xmath71 and variance @xmath72 .",
    "this curve represent single - cell measures of a population of bacteria living in the so - called _ minimal substrate _",
    "whose main characteristics are in principle well caught by the _",
    "ijr904 _ model .",
    "we fixed the bound on the glucose exchange flux ex_glc(e ) such that the maximum allowed growth rate ( about @xmath73 ) contained all experimental values in the profile labeled as _ glc ( p5-ori ) _ of fig .",
    "3(a ) of @xcite .",
    "this was easily computed by fixing the biomass flux to the desired value and minimizing the glucose exchange flux using fba , and gies a the lower bound of the exchanged glucose flux of @xmath74\\right)^{-1}h^{-1}}$ ] .",
    "we then apply ep algorithm to the modified _",
    "ijr904 _ model in two different conditions .",
    "first , we do not impose any additional constraint and we run the original ep algorithm as described in the previous section . then , as described in methods , we fix the marginal posterior of the biomass",
    ". we can now compare the means and the variances of all the other fluxes in the two cases and single out those fluxes that have been more affected by the empirical constraints on the growth rate .",
    "we report in fig .",
    "[ fig : scatter - const ] the plot of the ratio between the means ( fig .",
    "[ fig : scatter - const ] ( a ) ) and the variances ( fig .",
    "[ fig : scatter - const ] ( b ) ) in the unconstrained case and in the constrained case . in fig .",
    "[ fig : scatter - const ] ( a ) these ratios are plotted against the logarithm of the absolute value of the unconstrained means to differentiate those fluxes having means close to zero and all the other cases .",
    "the ratios of the variances are instead plotted as a function of the unconstrained variances in semi - log scale .",
    "we can notice that apparently a large fraction of the fluxes have changed their marginal distribution in order to accommodate the fixed marginal for the biomass .",
    "we have reported the name of the reactions with the most significant changes ; for instance , the marginal of the _ tkt2 _",
    "reaction has reduced its mean of more than one third , while many reactions involving _ aspartate _ have significantly lowered their variances .    to underline the non - trivial results of ep algorithm in the constrained case ,",
    "we apply again the standard ep algorithm to the _ ijr904 _ model when the lower bound and the upper bound of the biomass is fixed to the average value of the experimental profile .",
    "the comparison ( not shown ) between the two approaches suggests that the most relevant change concerns the _",
    "ex_asp_l(e ) _ flux as both the average value and the variance estimated in the second case are about two times the ones predicted by constrained ep .",
    "the distributions of most other fluxes remain do not considerably change .",
    "we underline that the different behavior of the marginals in the two cases , even if not significant for most of the fluxes , was in principle unpredictable without the use of constrained ep ; and we do not exclude that fixing other empirical profiles can lead to very different results .",
    "likewise , it seems unlikely that the results computed with constrained ep could be obtained using unbiased samples as provided by standard hr implementations ( see a discussion in supplementary note 6 ) .",
    ", title=\"fig : \" ] , title=\"fig : \" ]",
    "in this work we have shown how to study the space of feasible configurations of metabolic fluxes within a cell via an analytic description of the marginal probability distribution characterizing each flux .",
    "such marginals are described as truncated gaussian densities whose parameters are determined through an iterative and extremely efficient algorithm , the expectation propagation algorithm .",
    "we have compared our predictions against the estimates provided by hr sampling technique and results shown in subsection [ subsec : numerical - results ] suggest a very good agreement between ep and hr for a large number of explored configurations , @xmath54 .",
    "first of all , the direct comparison of the means and variances of ep vs hr reported in the scatter plots shows that the more we increment the hr points , the more the scatter points are aligned .",
    "secondly we see an increment of the correlation between ep and hr statistics for an increasing number of sampled points ; correlations reach values very close to @xmath25 for large values of @xmath54 and for almost all the models we have considered .",
    "the most important point is that the computation times of ep , at high correlation regime , are always orders of magnitude lower than hr sampling times .",
    "this is extremely time - saving when we deal with very large networks , as the _ recon1 _ model for _ homo sapiens _ where the running time ( in seconds ) of ep is three order of magnitude smaller then hr . we underline that exact marginals are generally inaccessible and we can not compare our results against a ground - truth ; our measures well approximate `` true '' distributions as long as the exactness of hr in the asymptotic limit is correct .",
    "we have shown how to include empirical knowledge on distribution of fluxes on the ep algorithm without compromising the computing time .",
    "more precisely we have investigated how fixing an experimental profile of the growth rate into the _",
    "ijr904 _ model of escherichia coli affect non - trivially all other fluxes .",
    "this is a remarkable advantage of the ep algorithm with respect to other methods .",
    "ep provides an analytic estimate of each single flux marginal which relies on the optimization of two parameters , the mean and the variance of a gaussian distribution .",
    "the formalism allows in principle more complicated parametrizations of posteriors to include other biological insights .",
    "ep equations are extremely easy to derive and to implement , as the main loop can be written in few lines of matlab code .",
    "the method is iterative , and the number of operations in each iteration scales as @xmath75 , rendering ep extremely convenient in terms of computation time with respect to existing alternatives .",
    "an shown in fig .",
    "[ fig : mainres ] in real cases variances of the marginal distributions can span several orders of magnitude .",
    "this range of variability implies that also the variances of the approximation need to allow both very small and huge values . to cope with the numeric problems that may arise , we allow parameters @xmath38 to vary in a finite range of values with the drawback of limiting the set of allowed gaussian densities of the approximation .",
    "for instance , a flat distribution can not be perfectly approximated through a gaussian whose variance can not be arbitrary large ; in the opposite extreme , imposing a lower bound on variances prevents the approximation of posteriors that are too concentrated on a single point .",
    "thus this range needs to be reasonably designed in order to catch as many `` true '' variances as possible . in this work we have tried to impose a very large range of values , typically @xmath76 $ ] , to include as many distributions as possible without compromising the convergence of the algorithm .",
    "moreover , the gaussian profile itself is surely a limitation of the approximation as true marginals can have in principle arbitrary profiles .",
    "ep performances are sensitive to the parameter @xmath21 and equations become numerically unstable for too large @xmath21 ( e.g. @xmath77 ) . on the other hand @xmath21 can be seen as the inverse - variance of a gaussian noise affecting the conservation laws .",
    "the nature of this noise could depend on localization properties on the cell and real thermal noise . in this case ,",
    "an optimization of the free energy with respect to @xmath21 can in principle lead to better predictions .",
    "the algorithm described in the expectation propagation section relies on local moves in which , at each step , we refine only the parameters of _ one _ single prior , minimizing the dissimilarity between the auxiliary @xmath78 distribution @xmath41 and @xmath52 .",
    "the values of the mean and of the variance of @xmath40 are iteratively tuned in a way that the first and second moments of the two distributions match .",
    "the update rule for the parameters @xmath45 and @xmath46 of the gaussian prior will be derived in details in the following section .",
    "let us express the auxiliary density @xmath41 in eq .",
    "[ eq : q(n)ep ] as a standard multivariate gaussian distribution times the exact prior of the @xmath39 flux as    @xmath79    where @xmath80 , @xmath81 is a diagonal matrix with components @xmath82 for @xmath83 and @xmath84 ( and of course non - diagonal terms @xmath85 if @xmath86 ) .",
    "the covariance matrix @xmath87 and the mean vector @xmath88 satisfy :    @xmath89    note that we are omitting for notational simplicity the dependence of @xmath90 on @xmath43 .",
    "equivalently @xmath91 where @xmath92 .",
    "if we now exploit the moment matching condition in eq .",
    "( a detailed calculation of the moments of @xmath52 and @xmath41 expressed in standard form is reported in supplementary notes 2 - 3 ) we obtain an update equation for the mean and the variance :    @xmath93 \\end{cases}\\label{eq : update_a_d}\\ ] ]    notice that the sequential update scheme described in the expectation propagation section requires the inversion of the matrix @xmath87 each time that we have to refine the parameters of flux @xmath43 , leading to @xmath1 inversions per iteration amounting to @xmath94 operations per iteration .",
    "we propose in supplementary note 4 a parallel update , that needs only one matrix inversion per iteration , i.e. @xmath75 operations per iteration .",
    "let us assume to have access to experimental measures of the ( marginal ) posterior @xmath95 for flux @xmath5 .",
    "we aim at determining how the posteriors of other fluxes would modify to fit with the experimental results compared , for instance , to the unconstrained case . the so - called _ maximum entropy principle _",
    "@xcite dictates that the most unconstrained distribution which is consistent with the experiment , prior distributions and flux conservation @xmath96 , is simply @xmath97\\right)g\\left(\\nu_{i}\\right)\\,\\,\\,\\,,\\label{eq : lagrange}\\ ] ] where @xmath98 and @xmath99 is the ( exponential of the ) function of unknown lagrange multipliers that has to be determined in order for the constraint @xmath100 to be satisfied . in the particular case in which the posterior can be reasonably fitted by a gaussian distribution @xmath101",
    ", then it suffices to consider also a gaussian @xmath102 with only two free parameters .",
    "the determination of @xmath103 can be achieved by slightly modifying the ep update for flux @xmath5 . assuming as before that the prior of each flux",
    "@xmath104 can be approximated as a gaussian profile @xmath40 of parameters @xmath45 and @xmath46 , also to be determined , we must impose that    @xmath105    where the distribution @xmath15 is the one in eq . .",
    "since both the left - hand side and the right - hand side of eq .",
    "contain gaussian distributions , the relations for @xmath106 and @xmath107 can be easily computed and take the form    @xmath108    this expression is exactly the same in eq . if we replace the mean and the variance of the tilted distribution with the experimental ones .",
    "the computations were performed on a dell poweredge server with 128 gb of memory and 48 amd opteron cpus clocked at 1.9ghz .",
    "no constraint have been placed on the number of cpu threads , allowing both ep and hr to parallelize their processes .",
    "we observed that ep used 2 - 3 cores , exclusively in the matrix inversion phase ( which was time - dominant ) , while hr employed a variable number of cores ( around 6 or 7 at some times ) .",
    "for this reason only the order of magnitude of computing times of hr and ep are fairly comparable but they are sufficient to underline the differences between the two algorithms .      all data generated or analysed during this study are included in this published article ( and its supplementary information file ) .",
    "an implementation of the algorithm presented in this work is publicly available at https://github.com/anna-pa-m/metabolic-ep .",
    "authors declare no competing interest .",
    "we warmly thank andrea de martino , roberto mulet , jorge fernndez de cossio , eduardo martinez montes for interesting discussions .",
    "we acknowledge support from project sibyl , financed by fondazione crt under the initiative `` la ricerca dei talenti '' and project `` from cellulose to biofuel through clostridium cellulovorans : an alternative biorefinery approach '' of university of turin , financed by compagnia di sanpaolo .",
    "all authors contributed equally to this work .",
    "patrick  f. suthers , anthony  p. burgard , madhukar  s. dasika , farnaz nowroozi , stephen  van dien , jay  d. keasling , and costas  d. maranas .",
    "metabolic flux elucidation for large - scale models using 13c labeled isotopes .",
    ", 9(5 - 6):387  405 , 2007 .",
    "jan schellenberger , richard que , ronan m.  t. fleming , ines thiele , jeffrey  d. orth , adam  m. feist , daniel  c. zielinski , aarash bordbar , nathan  e. lewis , sorena rahmanian , joseph kang , daniel  r. hyduke , and bernhard  o. palsson . quantitative prediction of cellular metabolism with constraint - based models : the cobra toolbox v2.0 .",
    ", 6(9):12901307 , sep 2011 .",
    "sattar taheri - araghi , serena bradde , john  t. sauls , norbert  s. hill , petra  anne levin , johan paulsson , massimo vergassola , and suckjoon jun .",
    "cell - size control and homeostasis in bacteria .",
    ", 25(3):385  391 , 2015 .",
    "francesco  alessandro massucci , francesc font - clos , andrea de  martino , and isaac  prez castillo . a novel methodology to estimate metabolic flux distributions in constraint - based models .",
    ", 3(3):838 , 2013 .",
    "francesc font - clos , francesco  alessandro massucci , and isaac  prez castillo .",
    "a weighted belief - propagation algorithm for estimating volume - related properties of random polytopes .",
    ", 2012(11):p11003 , 2012 .",
    "jeffrey  d. orth , bernhard   .",
    "palsson , and r.  m.  t. fleming .",
    "reconstruction and use of microbial metabolic networks : the core escherichia coli metabolic model as an educational guide . , 4(1 ) ,",
    "september 2010 .",
    "sharon  j. wiback , iman famili , harvey  j. greenberg , and bernhard   palsson .",
    "monte carlo sampling can be used to determine the size and shape of the steady - state flux space .",
    ", 228(4):437447 , june 2004 .",
    "thomas  p. minka .",
    "expectation propagation for approximate bayesian inference . in _ proceedings of the seventeenth conference on uncertainty in artificial intelligence _ , pages 362369 .",
    "morgan kaufmann publishers inc . , 2001 .",
    "nathan  e. lewis , gunnar schramm , aarash bordbar , jan schellenberger , michael  p. andersen , jeffrey  k. cheng , nilam patel , alex yee , randall  a. lewis , roland eils , rainer knig , and bernhard   palsson .",
    "large - scale in silico modeling of metabolic interactions between cell types in the human brain .",
    ", 28(12):12791285 , december 2010 .",
    "natalie  c. duarte , scott  a. becker , neema jamshidi , ines thiele , monica  l. mo , thuy  d. vo , rohith srivas , and bernhard   .",
    "global reconstruction of the human metabolic network based on genomic and bibliomic data .",
    ", 104(6):17771782 , february 2007 .",
    "zachary  a king , justin lu , andreas drger , philip miller , stephen federowicz , joshua  a lerman , ali ebrahim , bernhard  o palsson , and nathan  e lewis .",
    "bigg models : a platform for integrating , standardizing and sharing genome - scale models . , 44(d1):d515d522 , 2016 .",
    "christopher  s henry , matthew dejongh , aaron  a best , paul  m frybarger , ben linsay , and rick  l stevens .",
    "high - throughput generation , optimization and analysis of genome - scale metabolic models .",
    ", 28(9):977982 , 2010 .",
    "andrew  s. kennard , matteo osella , avelino javer , jacopo grilli , philippe nghe , sander  j. tans , pietro cicuta , and marco cosentino  lagomarsino .",
    "individuality and universality in the growth - division laws of single _",
    "e. coli _ cells .",
    ", 93:012408 , jan 2016 ."
  ],
  "abstract_text": [
    "<S> assuming a steady - state condition within a cell , metabolic fluxes satisfy an under - determined linear system of stoichiometric _ _ equations . characterizing the space of fluxes that satisfy such equations along with given bounds ( and possibly additional relevant constraints ) </S>",
    "<S> is considered of utmost importance for the understanding of cellular metabolism . </S>",
    "<S> extreme values for each individual flux can be computed with linear programming ( as flux balance analysis ) , and their marginal distributions can be approximately computed with monte - carlo sampling . here </S>",
    "<S> we present an approximate analytic method for the latter task based on expectation propagation equations that does not involve sampling and can achieve much better predictions than other existing analytic methods . </S>",
    "<S> the method is iterative , and its computation time is dominated by one matrix inversion per iteration . with respect to sampling , </S>",
    "<S> we show through extensive simulation that it has some advantages including computation time , and the ability to efficiently fix empirically estimated distributions of fluxes . </S>"
  ]
}