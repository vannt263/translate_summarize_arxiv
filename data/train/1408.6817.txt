{
  "article_text": [
    "the advantages of a thermodynamically admissible system with a positive entropy production are obvious from a physical point of view . for simulations ,",
    "the entropy balance is often regarded as redundant .",
    "motivated by the success of the entropic lattice boltzmann method @xcite,@xcite , where the entropy acts as a stabilizing lyapunov function , we seek to incorporate the entropy balance in a shock tube study of moment equations for rarefied gas dynamics .",
    "the modified system remains well posed by removing terms from the original system .",
    "this elimination enables us to rewrite the system of equations in divergence form and use a tailored numerical scheme for hyperbolic conservation laws .",
    "the stability of the resulting simulations encourages us to use this straightforward recipe for other entropic models with numerically challenging properties .",
    "the paper is structured as follows .",
    "we start by introducing the nomenclature and mathematical generalization of the system that we intend to study and give a brief overview of the available numerical methods in section [ sec : hyp ] .",
    "section [ sec : hco ] outlines the physical model of interest . in section",
    "[ sec : tube ] we discuss the intended simulation setup for a shock tube simulation . section [ sec : num ] describes the family of numerical schemes that we are building on and a naive extension for the numerically problematic terms in our physical model . a more sophisticated method using the entropy to overcome the gap in the numerical literature is derived in section [ sec : sol ] .",
    "finally , section [ sec : results ] presents the simulation results and gives a comparison between the naive and entropic extension .",
    "consider a system of first order partial differential equations that constitute conservation laws of production type in one spatial dimension , @xmath0 where @xmath1 is the vector of _ conserved _ variables , @xmath2 is the flux vector , @xmath3 is a production term and @xmath4 a relaxation constant .",
    "such a system is called _ hyperbolic _ in @xmath5 at @xmath6 if the eigenvalues of the quasilinear jacobian @xmath7 are real . in physical terms",
    ", the hyperbolicity condition means that the characteristic speeds of the quasilinear equations are finite .",
    "this is in contrast to parabolic partial differential equations with imaginary eigenvalues , such as the navier - stokes equations , which can be seen as a regularization of the hyperbolic euler equations .",
    "the finite speeds pose a numerical challenge for simulations , since a naive approximation of the derivatives does not necessarily reproduce the information propagation accurately .",
    "problems arise in particular for non - smooth solutions such as shock structures in gas dynamics .",
    "these are discontinuities that travel at supersonic speeds , such as a pressure shock at the wing edges of a supersonic jet .",
    "many numerical schemes have been developed for the homogenous case @xmath8 in the context of the euler equations of gas dynamics .",
    "a comprehensive introduction to the numerical methods available is given in @xcite .",
    "the majority of these schemes make use of the characteristic structure of the equations by solving riemann problems on the discrete level , since the eigenvalue structure of the euler equations is well understood . for some systems",
    "the eigenvalues can not be obtained analytically .",
    "one method able of handling this situation is the nessyahu - tadmor @xcite central scheme .",
    "this method has been extendend for the non - homogeneous case of production terms @xcite , where a family of explicit and implicit schemes for stiff relaxation are proposed .",
    "this scheme has been successfully implemented for various moment equations in gas dynamics and is the starting point of our numerical approach .",
    "the mathematics of hyperbolic conservation laws are no longer well understood , as soon as the equations can not be written in divergence form as above in ( [ eq : div ] ) .",
    "naturally this carries over to the numerical methods and there is a lack of schemes for this type of hyperbolic systems .",
    "we present such a system in the following section .",
    "the physical model we are studying is a set of moment equations in three space dimensions derived from the boltzmann equation .",
    "its purpose is to describe rarified monatomic gas dynamics and gas flows far from equilibrium where the constitutive equations of navier - stokes - fourier no longer hold ( @xcite , @xcite and @xcite ) .",
    "these rarefied flow domains are best characterised by a dimensionless knudsen number @xmath9 of order unity , which refers to the ratio of the particle mean free path @xmath10 over the characteristic length of the problem @xmath11 .",
    "a classical example of such a flow situation is the initial re - entry phase of a space vehicle .",
    "moment equations reach a more appropriate level of description by extending the five fields of hydrodynamics by a second moment tensor @xmath12 and third moment vector @xmath13 , which are related to the pressure tensor and heat flux , to a total of thirteen fields . in this section",
    "we present and discuss the fully three dimensional system of equations before reducing the system to the one dimensional simulation setup . for the density @xmath14 and momentum @xmath15 we have the common mass and momentum balance @xmath16 and @xmath17 where we have used einstein s summation convention .",
    "the additional second moment tensor @xmath12 and skewed third moment vector @xmath13 are governed ( @xcite and @xcite ) by the evolution equations @xmath18 and @xmath19 where @xmath20 is the velocity , @xmath21 is the particle mass and @xmath22 is an often occurring scalar indicating the skewness away from equilibrium .",
    "the tensor @xmath23 contains the isotropic dimensionless tensor @xmath24 which is determined by the two - particle interaction potential .",
    "the temperature ( and pressure ) is contained in the trace of the second moment tensor .",
    "the dimensionless constants @xmath25 and @xmath26 are related to the closure , and @xmath4 is a relaxation time . in comparison to the",
    "well known 13 moment equations of grad @xcite , this system has the advantage of being thermodynamically admissible and equipped with an entropy @xmath27 + \\frac{5}{2 } + \\bar{s}(\\varphi)\\right\\ } \\rho d^3 x.\\ ] ] here we have introduced the skewness contribution @xmath28 and the boltzmann and planck constants @xmath29 and @xmath30 .",
    "the evolution of the entropy density @xmath31 is governed by @xmath32 where @xmath33 is the particle number density @xmath34 .    a detailed study of the physical properties of this system , including linear and nonlinear stability analysis , hyperbolicity , sound waves , shock structures , boundary conditions and channel flows is subject to forthcoming papers . in the following",
    "we discuss the numerical properties of the system and only give a brief description of one of the applications : the shock tube .",
    "the most prominent test case for the physical accuracy of gas dynamics models and hyperbolic numerical schemes is the one - dimensional shock tube problem . in this application",
    "we consider a long tube separated into two sections by a membrane .",
    "the gases in the two chambers are in equilibrium , but differ in pressure and density , where the pressure difference can be up to two orders of magnitude . after the membrane is burst , one can observe a shock wave and a contact discontinuity traveling at supersonic speeds into the low pressure section of the tube , and a rarefaction wave traveling into the high pressure section .",
    "apart from its interesting physical properties , this application is the standard benchmark for the robustness of numerical methods due to the inherent non - smoothness @xcite .",
    "mathematically , the discontinuous initial conditions constitute a riemann problem , of which the analysis is a vital element of the theory of hyperbolic equations and their numerical methods . additionally , the geometry in cartesian coordinates is interpreted as essentially one - dimensional and therefore no boundary conditions are needed .",
    "the relevant spatial dimension @xmath35 describes the position along the tube and shows the only dynamical variation .",
    "the tube s width and height ( or circular cross section ) and the size of the membrane are infinite and therefore the problem is independent of @xmath36 and @xmath37 .",
    "this leads to the state variables density @xmath14 , momentum @xmath38 in direction @xmath35 and the heat flux related @xmath39 .",
    "the radial symmetry now imposes a second moment tensor of @xmath40 the next step is to find a diffeomorphic transformation of variables in order to rewrite the field equations ( [ eq : density ] - [ eq : q ] ) in the desired balance form ( [ eq : div ] ) . naturally , the guiding principle is conservation , and density and momentum are already conserved .",
    "the second moment tensor ( [ eq : pi ] ) itself is not conserved but its trace can be incorporated in a conserved equation for the mechanical energy @xmath41 additionally we take the second diagonal term of the non - peculiar second moment tensor ( including a momentum contribution ) which includes the deviatoric stress .",
    "finally , for the remaining variable we take @xmath39 as it is .",
    "this transformation yields the following system of equations : in the notation of ( [ eq : div ] ) the conversion between the simulation variables @xmath42 and the physical variables @xmath43 are given in table [ table : vars ] .",
    "[ cols=\"<,>,^ , < , > \" , ]     the flux vector @xmath44 is given by the components @xmath45\\\\ f_2=v_1 m_1 + \\dfrac{\\rho}{m^2 } \\pi_{11 } \\\\ [ 1.5pt]\\\\ f_3=\\dfrac{1}{2 } \\rho v_1 ^ 3 +   \\dfrac{1}{2 } \\dfrac{1 } { m^2 } \\rho v_1   ( 3 \\pi_{11 } + 2 \\pi_{22})+ \\dfrac{1}{m^2 } \\dfrac{f}{m } \\dfrac{2 b}{1 + 2 \\varphi b } \\rho \\pi_{11}q_1 + 2 \\dfrac{1}{m^2 } \\dfrac{f}{m }",
    "\\dfrac{2 b}{1 + 2 \\varphi b } \\rho \\pi_{22}q_1 \\\\ [ 1.5pt]\\\\ f_4=\\dfrac{1}{2 m^2 } \\rho \\pi_{22 } v_1   \\\\ [ 1.5pt]\\\\ f_5=v_1 q_1 + \\dfrac{f}{m}(\\pi_{11}+2\\pi_{22 } ) \\end{array}\\ ] ] and the production vector is given by @xmath46\\\\ g_4 = -\\dfrac{1}{2 m^2 } \\rho \\dfrac{1}{3}\\dfrac{1}{\\tau}(\\pi_{22}-\\pi_{11 } )   \\\\ [ 1.5pt]\\\\ g_5 = -\\dfrac{1}{2 \\tau}d_{11}q_1 \\end{array}\\ ] ] where we have included the relaxation parameter @xmath4 .",
    "the variable transformation has brought us as close as possible to a clean divergence form , but leaves remaining terms on the right hand side that are neither of the production type , nor the flux - divergence type : @xmath47\\\\ h_4 = - \\dfrac{1}{m^2 } \\pi_{22 } \\dfrac{\\partial } { \\partial x_1 } \\left ( \\dfrac{f}{m } \\dfrac{2 b}{1 + 2 \\varphi b } \\rho q_1 \\right ) \\\\ [ 1.5pt]\\\\ h_5 = -\\dfrac{q_1}{\\rho } \\dfrac{\\partial } { \\partial x_1 } \\left ( \\dfrac{f}{m } \\dfrac{2 b}{1 + 2 \\varphi b } \\rho q_1 \\right ) .",
    "\\end{array}\\ ] ] the derivatives in ( [ eq : remainder ] ) pose a numerical challenge and we propose a simple method to overcome them .",
    "before we find a solution for the additional terms of our system , we will address the other numerical properties in order to select the appropriate scheme .",
    "these are :    1 .",
    "an eigenstructure that is only known from numerical evaluation .",
    "3 .   a relaxation constant @xmath4 that can vary over a wide range of regimes of rarefaction and hence considerable stiffness .",
    "the scheme addressing the first two points is the central nessyahu - tadmore scheme @xcite .",
    "it is a predictor - corrector method of second degree accuracy in time and space and works with and without a detailed knowledge of the eigensystem .",
    "the extension for stiff production terms is a family of implicit schemes by @xcite .",
    "let us define the _ minmod _ function @xmath48 which is required for the discrete derivatives @xmath49 at spatial grid nodes",
    "@xmath50 and cell size @xmath51 : @xmath52 these limiters are proposed by @xcite as giving the best results .",
    "the full time step integrates the cell @xmath53 \\times [ t^n , t^{n+1}]$ ] .",
    "the integration consists of two predictor steps at time @xmath54 and @xmath55 for @xmath56 and @xmath57 at the cell edges , where @xmath33 denotes the time step index .",
    "the predictors are implicit in time , with the unknown variables appearing in the production @xmath58 , and can be written in vector notation as @xmath59 the corrector @xmath60 evaluates the mid - cell values @xmath61 on a spatially staggered grid with @xmath62 , and is also time implicit with the unknows again appearing in the production term . after a full time step ,",
    "the original grid is reconstructed by average interpolation . a continuous staggering results in oscillations depending on the size of @xmath51 .",
    "as presented , we have the ideal scheme for a system in divergence form .",
    "the remaining issue @xmath63 could be dealt with in a naive manner : a second order central discretisation of the derivative appearing in ( [ eq : remainder ] ) and subsequent treatment as an additional production term .",
    "the drawbacks apart from the obvious hyperbolicity issues are the loss of the implicitness and no reliable knowledge of the method s region of stability .",
    "in addition a few shock - structure related issues arise , which will be highlighted in the results section ( [ sec : results ] ) .",
    "since our physical model has an entropy , we would like to take advantage of that .",
    "the terms appearing in @xmath63 , which are re - occurring , contain the expression @xmath64 which is the non - convective entropy flux @xmath65 without the pre - factor @xmath66 .",
    "this allows us to integrate the entropy balance into the simulations whilst keeping a closed system of equations .",
    "we proceed in the following way : replace @xmath67 , making @xmath68 and rewriting @xmath69 as @xmath70\\\\ g_4 = -\\dfrac{1}{2 m^2 } \\rho \\dfrac{1}{3}\\dfrac{1}{\\tau}(\\pi_{22}-\\pi_{11 } ) - \\dfrac{1}{m^2 } \\pi_{22 } j_s \\\\ [ 1.5pt]\\\\ g_5 = -\\dfrac{1}{2 \\tau}d_{11}q_1 -\\dfrac{q_1}{\\rho } j_s . \\end{array}\\ ] ] we have declared @xmath67 as an additional unknown to the system and therefore can add the entropy evolution to the system , since it is no longer redundant and closes the extended system .",
    "some care has to be taken at this step , since although we have the unknowns @xmath71 now , the system is not simply the same as ( [ eq : div ] ) with system size @xmath72 .",
    "the newly formed variable @xmath67 only appears in the production terms ( [ eq : g ] ) and ( [ eq : js ] ) and we therefore do not have a time evolution equation for it , but rather an algebraic relation .",
    "the coupling to the other variables is constructed from the entropy balance by expressing the entropy density @xmath31 in terms of the other five state variables with ( [ eq : entropy ] ) .",
    "it takes the form @xmath73 with a convective entropy flux @xmath74 and entropy production @xmath75 + \\frac{n k_\\text{b}b}{\\tau } q_1 \\frac{1}{\\pi_{11}}\\bar{d}_{11}q_1.\\ ] ] in its continuous form , the substitution amounts to expressing the non - convective entropy flux in a more complicated manner with the entropy balance .",
    "the fundamental information of the system has not changed . on a discretized level , this is a completely different story .",
    "what we have gained , is that the system is in divergence form and we can rely on the numerical recipe .",
    "the entropy balance turns into a discrete formula , and shows us how the problematic terms on the right hand side have to be treated in order to be consistent with the stable scheme .",
    "although we lack the mathematical foundation to handle these terms in a hyperbolic system , we have made use of physical principles , a non - negative h - theorem , to enforce the stability of the simulations . to illustrate the principle we write the modified first predictor step ( [ eq : pred ] ) .",
    "@xmath76 this is still a system of six equations and six unknowns , namely @xmath56 and @xmath77 , which can be solved at each time step .",
    "the new variable @xmath67 is still implicitly defined .",
    "it occurs in the production terms of the state variables @xmath6 , explicitly on the left hand side of the additional equation and implicitly on the right hand side by way of the entropy .",
    "the solutions @xmath78 ( and @xmath79 as well as @xmath80 respectively ) of this discrete system can be found by a root - finding algorithm for each predictor and corrector step .",
    "this can be achieved in two approaches .",
    "the slightly simpler approach is to solve all six unknowns by the root finder .",
    "the resulting program is easier to implement and modify , but the solver and starting values need some attention .",
    "alternatively one can reformulate the predictor and corrector to have explicit formulas for @xmath81 to @xmath82 which are evaluated after solving a decoupled , closed one - dimensional equation for @xmath83 .",
    "this nonlinear equation is a polynomial with logarithmic terms ( from the entropy expression ) .",
    "it is smooth and regular and easily solved by standard root - finding techniques .",
    "this approach needs some thorough preparation in a symbolic programming language , but the results for all attempted shock tube simulations are perfectly smooth .",
    "since we are applying a novel numerical approach to a new physical model we can not benchmark the results independently .",
    "therefore we show two simulation results .",
    "first we adhere to the simulation setup and parameters proposed in @xcite , which serves as a general demonstration of the numerical functionality .",
    "the initial values for the riemann problem are @xmath84 and @xmath38 and @xmath39 equal to zero .",
    "the simulation grid size is @xmath85 and @xmath86 is within the stability region .",
    "dimensionless variables are obtained by rescaling the density with a reference upstream density @xmath87 .",
    "the velocity is scaled by the speed of sound @xmath88 and the space variable by the length of the mean free path @xmath10 .",
    "the remaining variables follow from this and the resulting rescaling is identical to the mathematical approach given in @xcite .",
    "the dimensionless constants are chosen as @xmath89 , @xmath90 and @xmath91 .",
    "the relaxation time @xmath4 is replaced by the relaxation parameter @xmath92 which represents the knudsen number and controls the rarefaction regime .",
    "the simulation time is @xmath93 .",
    "the results for the simulation variables are presented in figure  [ fig : vars1 ] and exhibit perfectly smooth solutions .    ,",
    "@xmath86 and @xmath94 .",
    "the dashed line shows the initial conditions , the dots represent the grid point values of the simulation variables .",
    "the continuous line in the last two plots is for visual guidance . ]    at this stage , the values of the new variable @xmath67 have already settled down and only the most prominent peaks remain .",
    "smaller features are no longer visible since the order of @xmath67 in @xmath95 is @xmath96 smaller than the other production terms in this regime .    for the comparison of results between the naive and the entropic approach",
    "we alter the simulation regime .",
    "we have identified two situations for which the entropic approach is clearly superior .",
    "first , it can be observed that the naive approach has a smaller region of stability and oscillations arise earlier when the size of the time step is increased . of greater importance",
    "is the second situation .",
    "as we increase the difference between the initial conditions of the left and right hand side , say to @xmath97 we observe higher shock speeds and greater gradients .",
    "these can not be resolved smoothly by the naive approach even for small time steps . for density and momentum density ,",
    "the oscillations are not as drastic , although it is evident that the shock front is propagated at slightly faster speed ( figure  [ fig : comparison1 ] ) . for the remaining variables",
    "the difference between the spoilt and smooth simulations are far more striking ( figure  [ fig : comparison2 ] ) .    , @xmath98 and @xmath99 .",
    "the dashed line shows the initial conditions , the dots represent the grid point values . ]    , @xmath98 and @xmath99 . ]",
    "we have introduced a general concept of using the redundant entropy balance to our advantage for numerical schemes .",
    "the method produces perfectly smooth and stable solutions .",
    "although we are demonstrating the principle by showing a particular example , the method is clearly more universal and could be used in other hyperbolic or mixed systems with an entropy evolution equation .",
    "additionally , the concept could open doors for certain open question in the theory of hyperbolic equations when a balance form is not attainable , such as the development of further schemes and enables the calculation of rankine - hugoniot conditions .",
    "the authors thank manuel torrilhon , henning struchtrup and martin krger for valuable discussions ."
  ],
  "abstract_text": [
    "<S> stable numerical simulations for a hyperbolic system of conservation laws of relaxation type but not in divergence form are obtained by incorporating the physical entropy into the simulations . </S>",
    "<S> the entropy balance is utilized as an additional equation to eliminate the numerically critical terms with simple substitutions . </S>",
    "<S> the method has potential for a wider applicability than the particular example presented here .    </S>",
    "<S> conservation laws , hyperbolicity , relaxation , moment equations , entropy    35l65 , 35l67,76l05 </S>"
  ]
}