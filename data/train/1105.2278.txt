{
  "article_text": [
    "for physical systems in equilibrium , the probability of observing a microstate is given by the boltzmann distribution , @xmath1 where @xmath2 denotes a microstate of the system ( which may include coordinates , momenta , and other dynamical variables , such as simulation box dimensions ) , @xmath3 denotes a set of thermodynamic parameters whose values define a _ thermodynamic state _ , and @xmath4 is a normalizing constant known as the _ partition function_.    the reduced potential @xmath5 depends on the thermodynamic ensemble under consideration  @xcite .",
    "for instance , in an isothermal - isobaric ( @xmath6 ) ensemble , the reduced potential will assume the form , @xmath7 , \\label{equation : reduced - potential}\\end{aligned}\\ ] ] which depends on the hamiltonian @xmath8 ( which may include an external biasing potential , and is presumed to be invariant under momentum inversion ) and the system volume @xmath9 . in this ensemble , the vector of controllable thermodynamic parameters @xmath10 includes the inverse temperature @xmath11 , the hamiltonian @xmath8 , and external pressure @xmath12 .",
    "other thermodynamic parameters and their conjugate variables can be included or excluded to generate alternative physical ( or unphysical ) ensembles .    to allow sampling from",
    "_ multiple _ thermodynamic states within a single simulation , we also define an _ expanded ensemble _",
    "@xcite , which specifies a joint distribution for @xmath13 in a weighted mixture of thermodynamic states , @xmath14 where @xmath15 specifies an externally - imposed weight for state @xmath3 . here",
    ", @xmath16 may assume values in a discrete or continuous space @xmath17 .",
    "if the set @xmath17 consists of a single value of @xmath3 , a single thermodynamic state is sampled , and @xmath18 .",
    "these thermodynamic states may correspond to a variety of different states of interest , such as temperatures in a simulated tempering simulation  @xcite , alchemical states in a simulated scaling simulation  @xcite , or protonation states in a constant - ph simulation  @xcite .",
    "we first describe the general form of ncmc . at the start of an iteration",
    ", the current sample in the markov chain , @xmath19 , which is assumed to be drawn from @xmath20 , is used to initialize a trajectory , @xmath21 .",
    "a _ candidate _",
    "configuration @xmath22 is then proposed through a nonequilibrium process in which a set of degrees of freedom and/or thermodynamic parameters may be driven according to some protocol  @xcite selected with a probability dependent only on @xmath23 .",
    "even if we only wish to sample from a single thermodynamic state @xmath3 , we may use a protocol that transiently drives the thermodynamic parameters away from @xmath3 and back again ( as in ref .",
    "finally , an acceptance probability is computed and used to decide whether the next sample in the markov chain , @xmath24 , is the candidate , @xmath22 , or the momentum reversal of the initial sample , @xmath25 .",
    "an ncmc move begins by selecting a protocol @xmath26 from a set of possible protocols with probability @xmath27 , such that there exists a reverse protocol labeled as @xmath28 ( to be defined momentarily ) with @xmath29 .",
    "a protocol @xmath26 specifies both a series of @xmath30 _ perturbation kernels _ @xmath31 and _ propagation kernels _",
    "@xmath32 , arranged in an alternating pattern such that @xmath33 . both @xmath31 and @xmath32",
    "are conditional probabilities of @xmath34 given any @xmath2 , and must satisfy the requirement that if @xmath35 , then @xmath36 , for @xmath12 substituted by @xmath37 and @xmath38 .",
    "each perturbation kernel @xmath37 drives some or all of the degrees of freedom @xmath39 in a stochastic or deterministic way ( e.g.  by driving a torsion angle , a distance between two atoms , or the volume of the simulation cell ) .",
    "similarly , each propagation kernel @xmath38 propagates some or all of the coordinates of the system at fixed @xmath40 according to some form of mcmc or md ( e.g.  metropolis monte carlo  @xcite , velocity verlet  @xcite deterministic dynamics , or overdamped langevin stochastic dynamics  @xcite ) that may also depend on the time index @xmath41 .",
    "interleaving perturbation and propagation allows for energetically unfavorable interactions introduced by perturbation to be relaxed during propagation , potentially increasing acceptance rates relative to the instantaneous perturbations of standard metropolis monte carlo .",
    "the procedure by which a trajectory @xmath42 is generated from an initial microstate @xmath43 according to a protocol @xmath26 can be illustrated by the scheme , @xmath44 application of the perturbation @xmath37 to @xmath45 generates a perturbed configuration @xmath46 , which is then propagated by the kernel @xmath38 to obtain @xmath47 .",
    "the reverse protocol @xmath48 reverses the order in which the perturbation and propagation steps are applied , generating the time - reversed trajectory @xmath49 , where @xmath50 denotes @xmath39 with inverted momenta , @xmath51    the next step in ncmc is to accept or reject @xmath22 as the next sample in the chain . to ensure that the stationary distribution @xmath20 is preserved , we enforce a strict _ pathwise _ form of detailed balance , @xmath52 the quantity",
    "@xmath53 is the ncmc acceptance probability , while @xmath54 and @xmath55 denote the probability of generating trajectory @xmath56 from initial configuration @xmath43 using protocol @xmath26 , or @xmath57 from final configuration @xmath58 with protocol @xmath28 , respectively , @xmath59 summation of eq .",
    "[ equation : pathwise - detailed - balance ] over all trajectories starting with @xmath43 and ending with @xmath60 recovers the standard detailed balance condition ( see appendix for proof ) .",
    "we define the ratio of proposal kernels as , @xmath61 and the ratio of propagation kernels as the exponentiated difference in forward and backward conditional path actions as , @xmath62 using the above expressions and the momentum invariance property @xmath63 , we may write the ratio of acceptance probabilities as , @xmath64 where @xmath65 is the energy difference . eq .  [ equation : acceptance - criteria - relationship ] is the main result of this paper , and is highly general with regard to both the choice of protocol for perturbation and propagation . in subsequent sections ,",
    "we discuss specific choices for these protocols that lead to particularly simple acceptance criteria .",
    "many choices of acceptance probabilities @xmath66 that satisfy eq .",
    "[ equation : acceptance - criteria - relationship ] are possible , including the well - known metropolis - hastings criterion  @xcite , @xmath67 after generating @xmath22 and evaluating @xmath66 , we generate a uniform random variate @xmath68 . if @xmath69 , then the candidate becomes the next value in the chain , @xmath70 .",
    "otherwise , it is rejected , we perform a momentum flip , and the next value becomes @xmath71 .",
    "alternately , we may perform a momentum flip upon acceptance , @xmath72 and preserve the momentum upon rejection , @xmath73 .",
    "we can not , however , ignore the momentum flip completely ; as explained in the appendix , it is necessary to preserve the equilibrium distribution .",
    "we note that ncmc need not be used exclusively to sample from @xmath20 , but can be mixed with other mcmc moves or with md  @xcite .",
    "for example , one may reinitialize velocities from the maxwell - boltzmann distribution after each ncmc step ; this is a gibbs sampling mcmc move using the marginal distribution for velocities .",
    "a large variety of choices are available for the perturbation kernels @xmath31 . through judicious selection of these kernels ,",
    "a practitioner can design nonequilibrium proposals that carry some component of the system from one high - probability region to another with high acceptance rates .",
    "we briefly describe a few possibilities .",
    "suppose we wish to drive a torsion angle @xmath74 ( an angle subtended by four bonded atoms ) _ stochastically _ by rotating it to a new torsion angle @xmath75 ( holding bond lengths and angles fixed)according to some probability , such as the von mises circular distribution centered on @xmath74 , @xmath76^{-1 } e^{\\kappa \\cos(\\phi ' - \\phi ) } , \\ ] ] with @xmath77 denoting the modified bessel function of order zero and @xmath78 taking the role of a dimensionless force constant .",
    "because the stochastic perturbation is made in a non - cartesian coordinate , a jacobian @xmath79 must be included to compute @xmath80 in cartesian coordinates , resulting in the ratio , @xmath81 where @xmath82 because the transformation ( a rotation about a bond vector ) preserves the cartesian phase space volume .      instead of perturbing the torsion angle",
    "stochastically , we can deterministically drive it in small , fixed increments @xmath83 . in this case",
    ", we effectively define an invertible map @xmath84 that takes @xmath85 , such that @xmath86 differs from @xmath39 only in the rotation of the specified torsion @xmath74 by @xmath83 . to implement this",
    ", we may choose a perturbation @xmath83 from a distribution where @xmath87 have equal probability , and drive @xmath88 from its current value @xmath89 to a final value @xmath90 over @xmath30 steps in equal increments , such that @xmath91 is constrained to @xmath92 .",
    "in this case , @xmath93 , where the jacobian @xmath94 represents the factor by which cartesian phase space is compressed on the application of the map @xmath84 , which is again unity for rotation about a torsion angle by @xmath83 , and , due to the invertibility of the map , the ratio @xmath95 .      another possible deterministic perturbation kernel is simulation box scaling .",
    "a barostat can be implemented by proposing propagation kernels that scale the molecular centers and box geometry by a factor @xmath96^{1/3}$ ] with @xmath97 chosen uniformly from @xmath98 $ ] applied as a factor of @xmath99 over the course of @xmath30 steps . in this case , the perturbation kernel @xmath31 is a delta function that compresses or expands the molecular centers and box geometry . since the jacobian is the ratio of infinitesimal volumes upon scaling , the ratio of perturbation kernels is @xmath100 , where @xmath101 denotes the number of molecular centers .      in many driven nonequilibrium processes , there is no direct perturbation to the coordinates , such that @xmath102 and the ratio @xmath103 .",
    "instead , only the thermodynamic parameters @xmath3 are varied in time , carrying the system out of equilibrium through action of the @xmath38 propagation kernels .",
    "we recover neal s method  @xcite if the reduced potential @xmath104 is a simple linear interpolation such that @xmath105 , the probability of choosing protocol @xmath26 is symmetric with @xmath28 , and mc  @xcite is used for the propagation kernel @xmath38 .",
    "the choice of propagation kernels available is also very broad .",
    "if strong driving is performed in selection of @xmath106 , one may elect to choose a time - independent propagation kernel @xmath107 that samples from a stationary distribution @xmath108 of interest .",
    "alternatively , a strongly time - dependent @xmath38 could be selected to transiently drive the system out of equilibrium , or from the equilibrium distribution at one thermodynamic state to another .",
    "some possible choices are described below .",
    "one may propagate some or all of a system s degrees of freedom ( e.g. those not affected by the perturbation kernel @xmath37 ) by a method that satisfies detailed balance in @xmath109 , @xmath110 where @xmath111 for a specified @xmath112 .",
    "many mcmc methods  @xcite , including metropolis  @xcite and various hybrid monte carlo ( hmc ) algorithms that combine discrete - timestep integrators with monte carlo acceptance / rejection steps  @xcite , obey detailed balance and are commonly used for the simulation of physical systems .",
    "by analogy with crooks  @xcite , we define a _ work _ @xmath113 and _ heat _",
    "@xmath114 for the nonequilibrium driven process , @xmath115 \\label{eq : work } \\\\",
    "q(x|\\lambda ) & = & \\sum_{t=1}^t \\left [ u_t(x_t ) - u_t(x_t^ * ) \\right ] \\label{eq : heat}\\end{aligned}\\ ] ] such that @xmath116 , a restatement of the first law of thermodynamics .",
    "the conditional path action difference can then be written in terms of the heat of the process , @xmath117 , @xmath118 leading to an acceptance probability similar to standard mc , except that the work , @xmath119 , replaces the instantaneous potential energy difference , @xmath120      when an isolated system is propagated by a symplectic integrator  a reversible , deterministic integrator that preserves phase space volume  the propagation kernels follow @xmath121 . hence , @xmath122 and the acceptance ratio is , @xmath123 where @xmath124 is the energy difference .",
    "the equivalence of the work and energy difference for volume - preserving integrators was previously recognized in the context of fluctuation theorem calculations  @xcite .",
    "symplectic integrators include velocity verlet  @xcite .",
    "these integrators are also symplectic when utilizing constraints through the application of algorithms such as rattle  @xcite , provided that the constraints are iterated to convergence each timestep  @xcite .",
    "stochastic integrators such as velocity verlet discretizations of langevin dynamics  @xcite sample a modified distribution that differs from the desired equilibrium distribution @xmath109 in a timestep - dependent manner  @xcite .",
    "while this modified distribution may be difficult or impossible to compute in order to recover equilibrium properties by reweighting , computation of the relative action @xmath125 is relatively straightforward , and the ncmc acceptance criteria ensures that the ncmc - sampled configurations are distributed according to the desired equilibrium ensemble . as examples , we compute @xmath126 for the overdamped langevin ( brownian ) dynamics integrator of ermak and yeh  @xcite and the brnger - brooks - karplus ( bbk ) langevin integrator  @xcite in the appendix .",
    "to demonstrate ncmc , we ran simulations of a bistable dimer ( adapted from section 1.3.2.4 of ref .",
    "@xcite ) in vacuum as well as a dense fluid .",
    "the dimer consists of a pair of `` bonded '' particles interacting via a double - well potential , with minima at @xmath127 ( compact ) and @xmath128 ( extended ) , and a @xmath129 barrier ( see fig .",
    "[ figure : wca - fluid - diagram ] ) . in the solvated simulations ,",
    "the dimer was immersed in a dense bath ( reduced density @xmath130 ) of particles that interact with the bonded particles and each other via the weeks - chandler - andersen ( wca ) soft repulsive potential  @xcite .",
    "each simulation `` iteration '' consisted of velocity reassignment from the maxwell - boltzmann distribution , 500 steps of generalized hybrid monte carlo ( ghmc ) dynamics  @xcite ( essentially , a metropolis - corrected form of langevin dynamics , henceforth referred to here as md ) , optionally followed by either an instantaneous mc move or an ncmc move .",
    "the rate at which effectively uncorrelated samples are generated can be quantified in terms of the correlation time @xmath131 for the dimer extension @xmath132 ( shown in fig .",
    "[ figure : wca - trajectory ] ) .",
    "this time represents the asymptotic decay time constant for the correlation function @xmath133 , which will behave like @xmath134 for large @xmath41 , where @xmath135 and @xmath136 . the correlation time is related to the statistical inefficiency , @xmath137 , a factor that describes the number of iterations necessary to generate an effectively uncorrelated sample  @xcite .    for the md simulation in vacuum ( fig .",
    "[ figure : wca - trajectory ] , top trace ) , we observe slow hopping between compact and extended configurations with a correlation time @xmath138 iterations , resulting in slow convergence of the histogram . introducing instantaneous mc dimer extension / contraction moves that modify the dimer extension by @xmath139 reduces the correlation time to @xmath140 , such that an uncorrelated configuration is generated after each iteration of 500 md steps and one instantaneous mc step ( fig .",
    "[ figure : wca - trajectory ] , second trace from top ) .",
    "when the dimer is immersed in a dense fluid of wca particles , however , iterations consisting of 500 md steps alone result in extremely slow barrier crossings , requiring g @xmath141 600 iterations to produce an uncorrelated sample ( fig .",
    "[ figure : wca - trajectory ] , middle trace ) . unlike in vacuum",
    ", the introduction of instantaneous mc moves does not significantly reduce the correlation time @xmath131 ( fig .",
    "[ figure : wca - trajectory ] , second trace from bottom ) .",
    "however , performing these same dimer expansion and contraction moves over 2048-step ncmc moves ( fig .  [ figure : wca - trajectory ] , bottom trace ) allows the system to rapidly mix between both compact and extended states with a correlation time of @xmath142 iterations .",
    "while each iteration requires a 5-fold increase in computational effort ( 500 md steps + 2048 ncmc switching steps = 2548 force evaluations , versus 500 force evaluations for md alone ) , a 67-fold reduction in correlation time is achieved , resulting in a remarkable order - of - magnitude gain in overall efficiency .    the length of the ncmc switching process is a free parameter that may be tuned to further improve efficiency . towards this end",
    ", we estimated the acceptance probability of the extension / contraction moves in dense solvent as a function of switching length ( fig .  [ figure : wca - acceptance ] ) . while instantaneous mc proposals of @xmath143 are only accepted with probability @xmath144 ( the error is this quantity is likely underestimated due to its extremity ) , dividing the move into smaller steps boosts the acceptance rate to a level useful in condensed - phase simulation .",
    "if the move is divided into a small number of steps ( 1 to 8) , there is little to no increase in acceptance rate , but for an intermediate number of steps ( 16 to 1024 ) , there is a superlinear boost in the acceptance probability relative to the length of the switching process .",
    "the acceptance probability finally reaches useful levels around 2000 steps , achieving an acceptance rate of 12% using nonequilibrium proposal trajectories of 2048 steps , or 38% for 8192 steps .",
    "in general , there is no direct relationship between acceptance probability and efficiency . under certain assumptions relevant to the bistable dimer , however , it is possible to link the ncmc acceptance probability to @xmath145 , an indirect estimate of the correlation time , @xmath146,\\end{aligned}\\ ] ] where @xmath147 and @xmath148 are correlation times for iterations consisting solely of md or ncmc moves , respectively .",
    "the latter correlation time may be estimated from the average acceptance probability @xmath149 by @xmath150 ( see _ appendix _ for derivation ) .    as shown in fig .",
    "[ figure : wca - efficiency ] , the effective correlation time @xmath145 is only diminished when the ncmc acceptance probability is large enough such that @xmath151 , which occurs when @xmath152 ( about 256 switching steps or more ) . for shorter switching times , even though the acceptance probability is high relative to instantaneous mc , it is still too small to significantly reduce @xmath145 .",
    "when comparing efficiency , we are most interested in the rate of generating uncorrelated configurations for a given amount of computational effort . relative to md alone , this rate is described by the efficiency gain , @xmath153 here , @xmath154 steps per iteration , and @xmath155 is again varied from 1 to 8192 steps .",
    "the results are shown in the bottom panel of fig .",
    "[ figure : wca - efficiency ] .",
    "surprisingly , there is actually a slight _ loss _ in efficiency at short switching times  dropping to a minimum of @xmath156 the efficiency of md alone at 128 steps  followed by a rapid gain in efficiency , plateauing at an efficiency gain of @xmath157 the efficiency of md alone for 20484096-step ncmc proposals .",
    "( a similar plateau behavior is observed in the modified parallel tempering protocol of ref .",
    "@xcite . ) after this point , longer switching times do not achieve as high of an efficiency gain ; even though the acceptance rate continues to increase as the number of ncmc switching steps is doubled again to 8192 steps , the reduction in correlation time is not sufficient to offset the additional cost of these moves .",
    "we have described a procedure_nonequilibrium candidate monte carlo _ ( ncmc)by which nonequilibrium proposals can be used within mcmc simulations to enhance acceptance rates . in our illustration , we have demonstrated how its use can lead to large improvements in statistical efficiency ",
    "the rate at which uncorrelated samples are generated for a fixed amount of computational effort . in other applications , whether similarly large efficiency gains are achieved will depend on the precise nature of the system under study and the nonequilibrium proposals introduced .",
    "the most straightforward approach  borrowing metropolis monte carlo proposals that are reasonable for one component of the system in isolation , and converting them to nonequilibrium proposals  is likely to be a fruitful avenue for generating efficient schemes , as was demonstrated here for a simple system .",
    "more generally , the problem of selecting efficient nonequilibrium proposals is similar to the problem of choosing good reaction coordinates , in that it is desirable to drive the system along ( possibly complex ) slow collective coordinates where orthogonal degrees of freedom relax quickly .",
    "the search for such collective coordinates is a topic of active research  @xcite .",
    "given an initial nonequilibrium protocol , the issue of _ optimizing _ such a protocol to minimize dissipation ( and maximize acceptance ) is also a topic of active study , led by forays into the world of single - molecule measurement  @xcite .",
    "recent work has also suggested that estimating the thermodynamic metric tensor along the nonequilibrium parameter switching path  @xcite , could prove useful in adaptively optimizing the switching protocol  @xcite .",
    "we note that switching trajectories contain potentially useful information .",
    "indeed , several methods  @xcite have recently been developed to estimate _ equilibrium _ properties from nonequilibrium samples through the application of statistical estimator theory to nonequilibrium fluctuation theorems  @xcite ; these are particularly relevant to switching between multiple thermodynamic states .",
    "though the development of efficient estimators that utilize _ both _ nonequilibrium switching trials and sampled equilibrium data generated in ncmc simulations remains an open challenge , it is at least straightforward to incorporate information from rejected ncmc proposals in the estimation of equilibrium averages  @xcite .",
    "the dimer system considered here consists of two particles that interact via a double - well `` bonded '' potential in the interatomic distance  @xmath158 , @xmath159 ^ 2\\end{aligned}\\ ] ] with @xmath160 , @xmath161 , and @xmath162 , where @xmath163 .",
    "simulations denoted as `` vacuum '' contain only these two particles , while simulations denoted as `` solvated '' also interact with a dense bath of particles via the wca nonbonded potential  @xcite , @xmath164 + \\epsilon , & r < r_\\mathrm{wca } \\\\ 0 & r \\ge r_\\mathrm{wca } \\end{cases},\\end{aligned}\\ ] ] with mass @xmath165 amu , @xmath166  , and @xmath167 . the nonbonded wca interaction is excluded between the two bonded particles .",
    "the solvated system contains a total of 216 wca particles at a reduced density of @xmath130 .",
    "for all simulations , the reduced temperature is @xmath168 .",
    "a custom python code making use of the gpu - accelerated openmm package  @xcite and the pyopenmm python wrapper  @xcite was used to conduct the simulations .",
    "all scripts are available for download from http://simtk.org/home/ncmc .    to ensure that observed differences were not due to changes in the stationary distribution of the integrator , we used generalized hybrid monte carlo ( ghmc )  ( @xcite ) for all our simulations",
    ". ghmc is based on a velocity verlet discretization  @xcite of langevin dynamics  the two are equivalent in the limit of small timesteps - but includes an acceptance / rejection step to correct for errors introduced by finite timesteps so that the stationary distribution is the exact equilibrium distribution .",
    "we used a timestep of @xmath169 , where @xmath170 , and the collision rate was set to @xmath171 . with this timestep , the acceptance probability is @xmath172% ; the resulting dynamics closely approximates langevin dynamics .    in simulations employing instantaneous monte",
    "carlo moves , a perturbation @xmath173 to the interatomic distance @xmath158 of the dimer was chosen according to , @xmath174 the dimer was contracted or expanded about the bond midpoint to generate a new configuration @xmath175 with dimer extension @xmath176 from the old configuration @xmath177 with dimer extension @xmath178 , and the move accepted or rejected with the metropolis - hastings criterion  @xcite , @xmath179 } j_r(x_\\mathrm{old},x_\\mathrm{new } ) \\right\\ } \\nonumber \\\\\\end{aligned}\\ ] ] where the jacobian ratio term @xmath180 accounts for the expansion and contraction of phase space due to the monte carlo proposals .    for simulations employing @xmath30-step ncmc moves ,",
    "proposals were made by selecting a new velocity vector from the maxwell - boltzmann distribution , integrating @xmath30 steps of velocity verlet dynamics  @xcite for all bath atoms as the dimer extension was driven from @xmath178 to @xmath176 in equal steps of size @xmath181 , and accepting or rejecting based on the modified metropolis criteria for symplectic integrators ( eqs .",
    "[ equation : modified - metropolis - criteria ] and [ equation : deterministic - acceptance - criteria ] ) , @xmath182 } j_r(x_0,x_t ) \\right\\ } .\\end{aligned}\\ ] ] the jacobian ratio is also @xmath183 .",
    "this scheme corresponds to a choice for the perturbation kernel of , @xmath184 ^ 2 \\delta([r(y ) - r(x ) ] - [ \\delta r / t ] ) , \\end{aligned}\\ ] ] where @xmath185 denotes the dimer separation of configuration @xmath39 .",
    "the propagation kernel @xmath32 corresponds to velocity verlet dynamics where the dimer atoms are held fixed in space .",
    "the final configuration after the mc or ncmc rejection procedure was stored and plotted to generate fig .",
    "[ figure : wca - trajectory ] .",
    "the mean acceptance probabilities for each switching time @xmath131 can be estimated via the sample mean @xmath186 for numerical stability , logarithms of @xmath187 were stored , as @xmath188 .",
    "we then estimated @xmath189 ( shown in fig .",
    "[ figure : wca - efficiency ] ) as @xmath190 where @xmath191 .",
    "integrated autocorrelation times were estimated using the rapid scheme described in section 5.2 of ref .",
    "@xcite .",
    "the acceptance probabilities plotted in fig .  [ figure : wca - efficiency ] were estimated from a trajectory consisting of 10 000 iterations of 2048-step ncmc , with 500 steps of ghmc dynamics in between each ncmc trial , to ensure equilibrium sampling .",
    "prior to each 2048-step ncmc iteration , a velocity from the maxwell - boltzmann distribution was selected , and ncmc trial moves with varying switching times were conducted solely to accumulate statistics . the statistical error in the estimate of @xmath189 and the computed relative efficiency over instantaneous monte carlo",
    "was estimated by 1000 bootstrap trials , in which the dataset of 10 000 work samples was resampled with replacement in each bootstrap trial and 95% confidence intervals computed from the distribution over bootstrap replicates .    the reference distribution for the interparticle distribution @xmath192 plotted in red on the right side of fig .",
    "[ figure : wca - trajectory ] was computed analytically for the vacuum system , @xmath193 for the solvated system , this distribution was estimated from an umbrella sampling simulation employing a modified bonded potential intended to remove the barrier in between compact and extended states , @xmath194 ^ 2 \\nonumber \\\\ & & \\mbox { } + \\theta(r - r_\\mathrm{max } ) ( k/2 ) [ r - r_\\mathrm{max}]^2 , \\end{aligned}\\ ] ] where @xmath195 , @xmath196 , and @xmath197 , with @xmath198  , and @xmath199 is the heaviside function that assumes a value of unity for @xmath200 and zero otherwise .",
    "the true solvated interparticle distribution @xmath201 was estimated by reweighting the data produced from this simulation , using the relationship @xmath202}}{\\sum_{n=1}^n e^{-\\beta",
    "[ u_\\mathrm{bond}(r_n ) - u_\\mathrm{umbrella}(r_n)]}}\\ ] ] where @xmath203 denotes the bond separation for sample @xmath204 , and a finite - width histogram bin was used instead of the delta function @xmath205 .",
    "the authors thank gabriel stoltz ( cermics , cole des ponts paristech ) ; jed w.  pitera ( ibm almaden research center ) ; manuel athens ( cea saclay ) ; firas hamze ( d - wave systems ) ; yael elmatad , anna schneider , paul nerenberg , todd gingrich , david chandler , david sivak , phillip geissler , michael grnwald , and ulf rrbck pederson ( university of california , berkeley ) ; vijay s. pande ( stanford university ) ; and suriyanarayanan vaikuntanathan , andrew j.  ballard , and christopher jarzynski ( university of maryland ) , and huafeng xu ( d.  e.  shaw research ) for enlightening discussions on this topic and constructive feedback on this manuscript , as well as the two anonymous referees for their helpful suggestions for improving clarity .",
    "jpn was supported by the u.s .",
    "department of energy by lawrence livermore national laboratory under contract de - ac52 - 07na27344 .",
    "gec was funded by the helios solar energy research center , which is supported by the director , office of science , office of basic energy sciences of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "ddlm was funded by a director s postdoctoral fellowship from argonne national laboratory .",
    "jdc was supported through a distinguished postdoctoral fellowship from the california institute for quantitative biosciences ( qb3 ) at the university of california , berkeley . additionally , the authors are grateful to openmm developers peter eastman , mark friedrichs , randy radmer , and christopher bruns for their generous help with the openmm gpu - accelerated computing platform and associated pyopenmm python wrappers .",
    "this research was performed under the auspices of the u.s .",
    "department of energy by lawrence livermore national laboratory under contract de - ac52 - 07na27344 and by uchicago argonne , llc , operator of argonne national laboratory ( argonne ) .",
    "argonne , a u.s .",
    "department of energy office of science laboratory , is operated under contract no .",
    "de - ac02 - 06ch11357 .",
    "government retains for itself , and others acting on its behalf , a paid - up nonexclusive , irrevocable worldwide license in said article to reproduce , prepare derivative works , distribute copies to the public , and perform publicly and display publicly , by or on behalf of the government .",
    "10    liu , j.  s. ( 2002 ) _ monte carlo strategies in scientific computing_. ( springer - verlag , new york ) , 2nd ed . edition .    metropolis , n , rosenbluth , a.  w , rosenbluth , m.  n , teller , a.  h , & teller , e. ( 1953 ) equation of state calculations by fast computing machines . : 10871092 .",
    "hastings , w.  k. ( 1970 ) monte carlo sampling methods using markov chains and their applications . : 97109 .",
    "rahman , a. ( 1964 ) correlations in the motion of atoms in liquid argon . :",
    "a405a411 .",
    "swendsen , r.  h & wang , j .- s .",
    "( 1987 ) nonuniversal critical dynamics in monte carlo simulations . : 8688 .",
    "wolff , u. ( 1989 ) collective monte carlo updating for spin systems . : 361364 .",
    "neal , r.  m. ( 2004 ) taking bigger metropolis steps by dragging fast variables , ( department of statistics , university of toronto ) , technical report 0411 .",
    "andrieu , c , doucet , a , & holenstein , r. ( 2010 ) particle markov chain monte carlo methods . : 269342 .",
    "athnes , m. ( 2002 ) computation of a chemical potential using a residence weight algorithm . : 046705 .",
    "brgi , r , kollman , p.  a , & van gunsteren , w.  f. ( 2002 ) simulating proteins at constant ph : an approach combining molecular dynamics and monte carlo simulation . : 469480 .    stern , h.  a. ( 2007 ) molecular simulation with variable protonation states at constant ph .",
    ": 164112 .",
    "nilmeier , j & jacobson , m.  p. ( 2009 ) monte carlo sampling with hierarchical move sets : posh monte carlo .",
    ". 19681984 .",
    "opps , s.  b & schofield , j. ( 2001 ) extended state - space monte carlo methods . : 56701 .",
    "brown , s & head - gordon , t. ( 2003 ) cool walking : a new markov chain monte carlo sampling method .",
    ": 6876 .",
    "ballard , a.  j & jarzynski , c. ( 2009 ) replica exchange with nonequilibrium switches .",
    ": 1222412229 .",
    "lyubartsev , a.  p , martsinovski , a.  a , shevkunov , s.  v , & vorontsov - velyaminov , p.  n. ( 1992 ) new approach to monte carlo calculation of the free energy : method of expanded ensembles . :",
    "17761783 .",
    "park , s. ( 2008 ) comparison of the serial and parallel algorithms of generalized ensemble simulations : an analytical approach . : 016709 .",
    "shirts , m.  r & chodera , j.  d. ( 2008 ) statistically optimal analysis of samples from multiple equilibrium states . : 124105 .",
    "marinari , e & parisi , g. ( 1992 ) simulated tempering : a new monte carlo scheme . : 451458 .",
    "li , h , fajer , m , & yang , w. ( 2007 ) simulated scaling method for localized enhanced sampling and simultaneous `` alchemical '' free energy simulations : a general method for molecular mechanical , quantum mechanical , and quantum mechanical / molecular mechanical simulations . : 024106 .",
    "mongan , j , case , d.  a , & mccammon , j.  a. ( 2004 ) constant ph molecular dynamics in generalized born implicit solvent .",
    ": 20382048 .",
    "jarzynski , c. ( 2000 ) hamiltonian derivation of a detailed fluctuation theorem . : 77102 .",
    "swope , w.  c , andersen , h.  c , berens , p.  h , & wilson , k.  r. ( 1982 ) a computer simulation method for the calculation of equilibrium constants for the formation of physical clusters of molecules : application to small water clusters .",
    ": 637649 .",
    "ermak , d.  l & yeh , y. ( 1974 ) equilibrium electrostatic effects on the behavior of polyions in solution : polyion - mobile ion interaction . : 243248 .",
    "ermak , d.  l. ( 1975 ) a computer simulation of charged particles in solution . i. technique and equilibrium properties . :",
    "41894196 .",
    "frenkel , d. ( 2004 ) speed - up of monte carlo simulations by sampling of rejected states .",
    ": 1757117575 .",
    "duane , s , kennedy , a.  d , pendleton , b.  j , & roweth , d. ( 1987 ) hybrid monte carlo .",
    "lelivre , t , stoltz , g , & rousset , m. ( 2010 ) langevin dynamics with constraints and computation of free energy differences .",
    "ar@xmath206iv:1006.4914 .",
    "crooks , g.  e. ( 1998 ) nonequilibrium measurements of free energy differences for microscopically reversible markovian systems . : 14811487 .",
    "jarzynski , c. ( 1997 ) nonequilibrium equality for free energy differences . : 26902693 .",
    "lechner , w , oberhofer , h , dellago , c , & geissler , p.  l. ( 2006 ) equilibrium free energies from fast - switching trajectories with large time steps . : 044113 .",
    "andersen , h.  c. ( 1983 ) rattle : a `` velocity '' version of the shake algorithm for molecular dynamics calculations . : 2434 .",
    "leimkuhler , b & skeel , r.  d. ( 1994 ) symplectic numerical integrators in constrained hamiltonian systems . : 117125 .",
    "paterlini , m.  g & ferguson , d.  m. ( 1998 ) constant temperature simulations using the langevin equation with velocity verlet integration . : 243252 .",
    "izaguirre , j.  a , sweet , c.  r , & pande , v.  s. ( 2010 ) multiscale dynamics of macromolecules using normal mode langevin . : 240251 .",
    "lelivre , t , stoltz , g , & rousset , m. ( 2010 ) _ free energy computations : a mathematical perspective_. ( imperial college press ) , 1st edition .",
    "gustafson , p. ( 1998 ) a guided walk metropolis algorithm .",
    ": 357364 .",
    "brnger , a , brooks iii , c.  l , & karplus , m. ( 1984 ) stochastic boundary conditions for molecular dynamics simulations of st2 water .",
    ".    pastor , r.  w , brooks , b.  r , & szabo , a. ( 1988 ) an analysis of the accuracy of langevin and molecular dynamics algorithms . : 14091419 .",
    "schlick , t. ( 2002 ) _ molecular modeling and simulation : an interdisciplinary guide_. ( springer - verlag ) , 1st edition .",
    "weeks , j.  d , chandler , d , & andersen , h.  c. ( 1971 ) role of repulsive forces in determining the equilibrium structure of simple liquids . : 52375247 .",
    "chodera , j.  d , swope , w.  c , pitera , j.  w , seok , c , & dill , k.  a. ( 2007 ) use of the weighted histogram analysis method for the analysis of simulated and parallel tempering simulations . : 2641 .",
    "bolhuis , p.  g , chandler , d , dellago , c , & geissler , p.  l. ( 2002 ) transition path sampling : throwing ropes over rough mountain passes , in the dark . : 291318 .",
    "best , r.  b & hummer , g. ( 2005 ) reaction coordinates and rates from transition paths . : 67326737 .",
    "ma , a & dinner , a.  r. ( 2005 ) automatic method for identifying reaction coordinates in complex systems . : 67696779 .",
    "e , w , ren , w , & vanden - eijnden , e. ( 2005 ) finite temperature string method for the study of rare events .",
    ": 66886693 .",
    "berezhkovskii , a & szabo , a. ( 2005 ) one - dimensional reaction coordinates for diffusive activated rate processes in many dimensions . : 014503 .",
    "peters , b & trout , b.  l. ( 2006 ) obtaining reaction coordinates by likelihood maximization . : 054108 .",
    "ensing , b , de  vivo , m , liu , z , moore , p , & klein , m.  l. ( 2006 ) metadynamics as a tool for exploring free energy landscapes of chemical reactions . : 7381 .",
    "schmiedl , t & seifert , u. ( 2007 ) optimal finite - time processes in stochastic thermodynamics . : 108301 .",
    "then , h & engel , a. ( 2008 ) computing the optimal protocol for finite - time processes in stochastic thermodynamic . : 041105 .",
    "gomez - marin , a , schmiedl , t , & seifert , u. ( 2008 ) optimal protocols for minimal work processes in underdamped statistical thermodynamics . : 024114 .",
    "salamon , p & berry , r.  s. ( 1983 ) thermodynamic length and dissipated availability . :",
    "crooks , g.  e. ( 2007 ) measuring thermodynamic length . : 100602 .",
    "feng , e.  h & crooks , g.  e. ( 2009 ) far - from - equilibrium measurements of thermodynamic length . : 012104 .",
    "minh , d. d.  l & chodera , j.  d. ( 2011 ) multiple - timeslice nonequilibrium estimators : estimating equilibrium ensemble averages from nonequilibrium experiments using multiple timeslices , with application to thermodynamic length . : 024111 .",
    "shenfeld , d.  k , xu , h , eastwood , m.  p , dror , r.  o , & shaw , d.  e. ( 2009 ) minimizing thermodynamic length to select intermediate states for free - energy calculations and replica - exchange simulations .",
    ": 046705 .",
    "minh , d. d.  l & adib , a.  b. ( 2008 ) optimized free energies from bidirectional single - molecule force spectroscopy . : 180602 .",
    "minh , d. d.  l & chodera , j.  d. ( 2009 ) optimal estimators and asymptotic variances for nonequilibrium path - ensemble averages . : 134110 .",
    "crooks , g.  e. ( 1999 ) entropy production fluctuation theorem and the nonequilibrium work relation for free energy differences . : 27212726 .    crooks , g.  e. ( 2000 ) path - ensemble averages in systems driven far from equilibrium . : 23612366 .",
    "athnes , m & marinica , m .- c .",
    "( 2010 ) free energy reconstruction from steered dynamics without post - processing . : 71297146 .",
    "friedrichs , m.  s , eastman , p , vaidyanathan , v , houston , m , legrand , s , beberg , a.  l , ensign , d.  l , bruns , c.  m , & pande , v.  s. ( 2009 ) accelerating molecular dynamic simulation on graphics processing units . : 864872 .",
    "eastman , p & pande , v.  s. ( 2010 ) openmm : a hardware - independent framework for molecular simulations . : 3439 .",
    "eastman , p & pande , v.  s. ( 2010 ) efficient nonbonded interactions for molecular dynamics of a graphics processing unit . : 1268 .",
    "bruns , c.  m , radmer , r.  a , chodera , j.  d , & pande , v.  s. ( 2010 ) pyopenmm .",
    "following the proof for ghmc in ref .",
    "@xcite , here we show that ncmc preserves the equilibrium distribution .",
    "the expected acceptance rate for ncmc moves initiated from @xmath13 is , @xmath207    suppose that we have a variate @xmath19 drawn from the equilibrium distribution @xmath20 .",
    "the probability density of the next value in the chain , @xmath208 , has contributions from two scenarios : when the candidate variate is rejected and when it is accepted .",
    "the contribution from rejecting the candidate and flipping the momentum such that @xmath209 is , @xmath210 \\delta(\\tilde{x}-x^{(n+1 ) } ) \\delta(\\lambda - \\lambda^{(n+1 ) } ) & = & \\pi(\\tilde{x}^{(n+1 ) } , \\lambda^{(n+1 ) } ) [ 1 - \\alpha(\\tilde{x}^{(n+1)},\\lambda^{(n+1 ) } ) ] .",
    "\\label{eq : rejection - term}\\end{aligned}\\ ] ] the latter contribution from accepting the candidate such that @xmath70 is , @xmath211 \\delta(x_t - x^{(n+1 ) } ) \\delta(\\lambda_t - \\lambda^{(n+1 ) } ) \\nonumber \\\\ & = & \\int dx_t \\sum_{\\lambda_t } \\int d\\tilde{x } \\int d\\tilde{\\lambda } \\ , \\left [ \\pi(\\tilde{x}_t,\\lambda_t ) \\ , \\rho(\\tilde{x},\\tilde{\\lambda } | \\tilde{x}_t , \\lambda_t ) \\ , a(\\tilde{x}|\\tilde{\\lambda } )   \\right ] \\delta(x_t - x^{(n+1 ) } ) \\delta(\\lambda_t - \\lambda^{(n+1 ) } ) \\nonumber \\\\ & = & \\pi(\\tilde{x}^{(n+1)},\\lambda^{(n+1 ) } ) \\alpha(\\tilde{x}^{(n+1 ) } , \\lambda^{(n+1 ) } ) , \\label{eq : acceptance - term}\\end{aligned}\\ ] ] where @xmath212 is the probability of generating the trajectory - protocol pair @xmath213 from @xmath23 , and the pathwise detailed balance condition ( eq . [ equation : pathwise - detailed - balance ] ) is used to produce the quantity in brackets .    taking the sum of eqs .",
    "[ eq : rejection - term ] and [ eq : acceptance - term ] , we find that the equilibrium distribution is preserved , @xmath214    by analogous reasoning , maintaining the momentum upon rejection , @xmath215 , and flipping it upon acceptance , @xmath216 will also preserve the equilibrium distribution .",
    "a common integrator for brownian dynamics ( the overdamped regime of langevin dynamics ) , in which only coordinates @xmath39 are explicitly integrated , is given by ermak and yeh  @xcite . in our notation , where the perturbed coordinates @xmath46 are propagated by one step of the stochastic integrator to obtain @xmath47 , application of the propagation kernel @xmath217 can be written , @xmath218 where @xmath219 is the particle mass , @xmath220 is the ( potentially time - dependent ) systematic force , and @xmath149 is an effective collision frequency or friction coefficient with units of inverse time .",
    "the noise history @xmath221 for each degree of freedom is a normal random variate with zero mean and variance @xmath222 , drawn from the distribution @xmath223\\end{aligned}\\ ] ]    in ncmc , every application of the propagation kernel @xmath38 produces a transition @xmath224 determined by the noise history variable @xmath221 , there is a corresponding @xmath225 that generates the opposite step , @xmath226 . by noting @xmath227 we can compute the relationship , @xmath228 - \\xi_t,\\end{aligned}\\ ] ]    then",
    ", the ratio of transition kernels appearing in eq .  [ equation : ratio - of - propagation - kernels ] can be written in terms of noise history @xmath221 and the computed reverse noise history @xmath229 , @xmath230 = \\frac{\\beta}{2 } \\sum_{t=1}^t ( { \\tilde{\\xi}_t}^2 - { \\xi_t}^2 ) \\label{equation : ermak - action}\\end{aligned}\\ ] ] where the tildes are dropped because the microstate @xmath39 contains no momenta .",
    "the quantity @xmath231 represents the jacobian for the change of variables from the @xmath221 to @xmath47 , and the jacobians in the numerator and denominator cancel . the quantity in eq .",
    "[ equation : ermak - action ] can easily be computed during integration .",
    "the brnger - brooks - karplus ( bbk ) stochastic integrator  @xcite is a popular integrator for simulating langevin dynamics . in our notation ,",
    "where the perturbed coordinates @xmath46 are propagated by one step of the stochastic integrator to obtain @xmath47 , application of the propagation kernel @xmath217 can be written , @xmath232\\end{aligned}\\ ] ] where we have used a velocity verlet discretization of the bbk integrator  @xcite . here",
    "@xmath233 and @xmath234 denote the respective cartesian position and velocity components of the microstate @xmath47 , @xmath149 the effective collision frequency with units of inverse time , and @xmath219 the particle mass .",
    "@xmath235 is an auxiliary variable used only in simplifying the mathematical representation of the integration scheme .",
    "note that we require _ two _ random variates , @xmath221 and @xmath236 , per degree of freedom per timestep in order for this scheme to be able to generate both the forward trajectory @xmath56 and its time - reverse @xmath57 ( see , e.g. , section 2.2.3.2 of @xcite ) .",
    "the noise history terms @xmath221 and @xmath236 are normal random variates with zero mean and variance @xmath222 .",
    "their joint distribution can therefore be written , @xmath237 .\\end{aligned}\\ ] ] for every step @xmath224 , the positions and velocities undergo a transition @xmath238 determined by the noise variables @xmath239 . a corresponding choice of noise variables @xmath240 will generate the reverse step , @xmath241 , carrying @xmath242 with a little algebra",
    ", it is seen that , @xmath243 in order to write the ratio of transition kernels appearing in eq .",
    "[ equation : ratio - of - propagation - kernels ] in terms of noise variables @xmath244 and the computed reverse noise variables @xmath245 , we must first compute the jacobian @xmath246 because the random variates are not in cartesian space , @xmath247 , \\end{aligned}\\ ] ] which can be shown to be independent of @xmath221 and @xmath236 .",
    "the conditional path action difference can now be computed , @xmath248\\end{aligned}\\ ] ] where the ratio of jacobians @xmath249 cancels because the jacobians are independent of the noise variates .",
    "for simplicity , we make the assumption that the system of interest has two long - lived conformational states of equal population with dimer extensions @xmath250 and @xmath251 .",
    "this assumption holds to good approximation for the wca dimer example considered here , and may apply to other systems of interest as well .",
    "we assume that the correlation time for a fixed number of md simulation steps per iteration is given by @xmath147 , and describe the probability of finding the system ends up in a given conformational state after one iteration by a @xmath252 column - stochastic transition matrix @xmath253 , @xmath254\\end{aligned}\\ ] ]    for a @xmath252 system whose time evolution is governed by the column stochastic transition matrix @xmath255 , we can write the autocorrelation function for the dimer extension @xmath158 as @xmath256 { \\bf t}^n \\left [ \\begin{array}{cc } 1/2 & 0 \\\\ 0 & 1/2 \\end{array } \\right ] \\left [ \\begin{array}{c } r_c \\\\ r_e \\end{array}\\right ] \\nonumber \\\\ & = & \\left [ \\begin{array}{cc } r_c & r_e \\end{array } \\right ] { \\bf u } \\left [ \\begin{array}{cc } 1 & 0 \\\\ 0 & \\mu^n \\end{array } \\right ] { \\bf u}^{-1 }   \\left [ \\begin{array}{cc } 1/2 & 0 \\\\ 0 & 1/2 \\end{array } \\right ] \\left [ \\begin{array}{c } r_c \\\\ r_e \\end{array}\\right ] \\nonumber \\\\ & = & ( c_0 - c_\\infty ) \\mu^n + c_\\infty\\end{aligned}\\ ] ] where the transition matrix @xmath255 has unitary eigenvalue decomposition @xmath257 , and @xmath0 is the non - unit eigenvalue of @xmath255 .",
    "the constants are @xmath258 and @xmath259 .    relating this to the autocorrelation time @xmath131 estimated from a timeseries , intended to reflect the fit to @xmath260",
    "we can see that @xmath261 .",
    "we then determine that the correlation time @xmath262 , with @xmath263 .",
    "similarly , we can write the probability that the ncmc step will carry the system from one conformational state to another in terms of the acceptance probability @xmath149 , which we assume to be symmetric , @xmath264\\end{aligned}\\ ] ] where we have correlation time @xmath265 and @xmath266 .    the effective transition matrix @xmath267 for iterations consisting of md simulation steps followed by an ncmc trial is given by @xmath268 \\left [ \\begin{array}{cc } 1-\\gamma & \\gamma \\\\ \\gamma & 1 - \\gamma \\end{array } \\right ]   = \\left [ \\begin{array}{cc } 1 - ( \\alpha + \\gamma ) & ( \\alpha + \\gamma ) - 2 \\alpha \\gamma \\\\",
    "( \\alpha + \\gamma ) - 2 \\alpha \\gamma & 1 - ( \\alpha + \\gamma ) \\end{array }   \\right]\\end{aligned}\\ ] ] where the effective correlation time @xmath269 , with @xmath270 $ ] . substituting in @xmath271 and @xmath272 , we obtain @xmath273 } \\nonumber \\\\ & = &   - \\frac{1}{\\ln\\left[e^{-1/\\tau_\\mathrm{md } } e^{-1/\\tau_\\mathrm{ncmc}}\\right ] } =   \\frac{1}{\\tau_\\mathrm{md}^{-1 } + \\tau_\\mathrm{ncmc}^{-1 } } = \\frac{\\tau_\\mathrm{md } \\ , \\tau_\\mathrm{ncmc}}{\\tau_\\mathrm{md } + \\tau_\\mathrm{ncmc } } \\label{equation : effective - correlation - time}\\end{aligned}\\ ] ] as a check of the accuracy of eq .",
    "[ equation : effective - correlation - time ] , we note that for md with 2048-step ncmc switching , we compute @xmath274 iterations , using only @xmath275 iterations and the ncmc acceptance probability @xmath276 . the actual correlation time measured from a 10 000 iteration simulation",
    "is computed to be @xmath277 ."
  ],
  "abstract_text": [
    "<S> metropolis monte carlo simulation is a powerful tool for studying the equilibrium properties of matter . in complex condensed - phase systems , </S>",
    "<S> however , it is difficult to design monte carlo moves with high acceptance probabilities that also rapidly sample uncorrelated configurations . here , we introduce a new class of moves based on _ nonequilibrium _ dynamics : candidate configurations are generated through a finite - time process in which a system is actively driven out of equilibrium , and accepted with criteria that preserve the equilibrium distribution . </S>",
    "<S> the acceptance rule is similar to the metropolis acceptance probability , but related to the nonequilibrium work rather than the instantaneous energy difference . </S>",
    "<S> our method is applicable to sampling from both a single thermodynamic state or a mixture of thermodynamic states , and allows both coordinates and thermodynamic parameters to be driven in nonequilibrium proposals . </S>",
    "<S> while generating finite - time switching trajectories incurs an additional cost , driving some degrees of freedom while allowing others to evolve naturally can lead to large enhancements in acceptance probabilities , greatly reducing structural correlation times . using nonequilibrium driven processes </S>",
    "<S> vastly expands the repertoire of useful monte carlo proposals in simulations of dense solvated systems .    </S>",
    "<S> n this paper , we describe a new technique for constructing efficient markov chain monte carlo ( mcmc )  @xcite moves that both have high acceptance rates and also allow rapid transit through configuration space , greatly enhancing convergence rates in simulations of dense solvated systems . the metropolis monte carlo  @xcite sampling procedure is generalized by using _ </S>",
    "<S> nonequilibrium _ processes to generate candidates for _ equilibrium _ simulations . within this framework , </S>",
    "<S> moves that are efficient for an isolated part of a system but lead to near - universal rejection in standard monte carlo simulations of dense mixtures can be converted to nonequilibrium processes that generate candidates with higher acceptance probabilities . in this new procedure , </S>",
    "<S> the acceptance criteria is related to the nonequilibrium work , rather than the potential energy difference used in traditional monte carlo moves .    since their introduction in the mid - twentieth century , metropolis monte carlo ( mc )  @xcite and molecular dynamics ( md )  @xcite simulations </S>",
    "<S> have become favored tools for sampling from complex multidimensional distributions , such as configurations of microscopic physical systems in thermodynamic ensembles . </S>",
    "<S> however , these methods can produce highly correlated samples , leading to slow convergence of estimated expectations . </S>",
    "<S> while md requires the use of small timesteps for numerical stability and to approximate sampling from the desired distribution , mc simulations can , in principle , make use of non - local moves that accelerate mixing of the markov chain . indeed , vast improvements in efficiency have been obtained by applying cleverly constructed move sets that exploit physical intuition about the system under study , such as cluster moves in potts and ising model simulations  @xcite .    </S>",
    "<S> designing efficient moves requires striking a balance between rapid traversal of phase space and ensuring reasonable acceptance probabilities . for complex heterogeneous systems such as solvated biomolecules , achieving this balance remains challenging . </S>",
    "<S> typically , efficient moves exploit physical insight into kinetically slow processes and energetically favorable configurations . </S>",
    "<S> often , the experimenter may possess physical insight about one component in the system ( e.g.  a biomolecule ) that permits the design of moves that would be efficient in the absence of other components ( e.g.  solvent ) , but encounter energetically unfavorable interactions in their presence , reducing acceptance rates to levels where standard mc provides no benefit . as an illustrative example , consider a bistable dimer  </S>",
    "<S> a pair of particles interacting with a potential with minima in compact or extended configurations , separated by a high barrier ( see fig .  [ </S>",
    "<S> figure : wca - fluid - diagram ] ) . for simulations of this system in a vacuum , a simple and effective standard mc move is to instantaneously increase the interparticle distance from a compact to extended configuration ( or conversely , to decrease the distance from an extended to compact configuration ) . when the dimer is immersed in a dense solvent , however </S>",
    "<S> , this move is met with near - universal rejection because solvent molecules overlap with proposed configurations .    </S>",
    "<S> one approach that can allow unperturbed degrees of freedom to relax , and hence maintain a reasonable acceptance rate , is to use a _ nonequilibrium _ process to generate candidate configurations . using the appropriate acceptance criterion for the final configuration will preserve the equilibrium distribution . in the case of the bistable dimer immersed in dense solvent , the extension ( contraction ) </S>",
    "<S> may be carried out over a finite number of increments interleaved with standard metropolis monte carlo or molecular dynamics steps that allow the solvent to reorganize to avoid overlap with the dimer particles .    </S>",
    "<S> the basic idea of using nonequilibrium driven processes as monte carlo moves has precedents in both the statistical  @xcite and chemical  @xcite literature . among the latter , athnes developed `` work - bias monte carlo '' to enhance acceptance rates in grand canonical monte carlo simulations  @xcite , stern presented a scheme to sample an equilibrium mixture of protonation states at constant ph in explicit solvent  @xcite ( though an inexact variant was proposed earlier  @xcite ) , and nilmeier et al .  </S>",
    "<S> @xcite proposed the driving of a subset of degrees of freedom to enhance acceptance rates ( using an approximate acceptance criteria ) . </S>",
    "<S> nonequilibrium processes have also been used to generate configurations for parallel tempering simulations  @xcite . here , we unify these ideas and </S>",
    "<S> significantly extend the application of nonequilibrium moves in physical simulations . </S>",
    "<S> we present a theoretical framework , _ nonequilibrium candidate monte carlo _ ( ncmc ) , that is applicable to both single thermodynamic states ( e.g.  nvt , npt , @xmath0vt ensembles ) as well as </S>",
    "<S> _ mixtures _ of thermodynamic states ( e.g.  expanded ensemble  @xcite simulations ) . </S>",
    "<S> nonequilibrium proposals may drive a subset of degrees of freedom , the thermodynamic parameters characterizing the equilibrium distribution , or _ both _ </S>",
    "<S> , significantly expanding the repertoire of monte carlo moves that lead to high acceptance and efficient mixing in dense condensed - phase systems . </S>"
  ]
}