{
  "article_text": [
    "photometric stereo ( ps ) techniques reconstruct surface geometry from shading , using images acquired under calibrated lighting .",
    "while other depth sensors  like those based on triangulation or time - of - flight  provide measurements of depth or distance , shading intensities are directly related to surface orientation .",
    "this makes ps the preferred choice for recovering high - resolution surface relief .",
    "however , classical ps requires capturing multiple images of an object under different illumination environments  a minimum of three images for lambertian objects  @xcite  to be well constrained .",
    "consequently , it is predominantly used for recovering shapes of static objects .    at the same time ,",
    "reasoning about shape from shading ( sfs ) in a single image has been a classical problem in computer vision  @xcite . while early work made restrictive assumptions  like known or constant albedo and known or directional lighting  barron and malik  @xcite recently demonstrated that reasonable surface reconstructions are possible from a single image of an object with unknown spatially - varying albedo under unknown natural lighting . although impressive given the inherent ambiguities in the sfs setup , their recovered geometries are typically coarse due to the use of strong smoothness priors , and their inference algorithm is computationally expensive .",
    "this is true even when known lighting is provided as input to their algorithm , primarily because it is designed to handle arbitrary and potentially ambiguous _",
    "natural _ illumination environments .    in this paper , we show that efficient and high - quality surface recovery from a single image is possible , when using a calibrated lighting environment that is specifically chosen to be directly informative about shape . specifically , we use the rgb ( or color ) photometric stereo ( rgb - ps ) setup  @xcite , where an object is illuminated by three monochromatic directional light sources , such that each of the red , green , and blue channels in the observed image is `` lit '' from a different direction . for natural lighting , directional diversity in color has been shown to be informative towards shape  @xcite .",
    "but the benefits of this lighting setup for shape recovery can be better understood by interpreting it as one that multiplexes the multiple images of classical ps into the different color channels of a single image .",
    "strictly speaking , rgb - ps observations are as ambiguous as images under a single directional light . while each pixel now has observations from three directional lights , there are also now three unknown albedos  one for each channel .",
    "this is why previous methods using the rgb - ps setup have had to rely on assuming constant surface albedo  @xcite , or on capturing additional information  @xcite . in this work",
    ", we present a single - shot rgb - ps estimation method that can handle spatially varying albedo , by relying on spatial reasoning to resolve this ambiguity .",
    "we assume that the albedo of the observed surface is piece - wise constant and consists of a finite , but unknown , set of distinct albedo values .",
    "we motivate our method by showing that for a typical non - degenerate constant - albedo local surface patch , its shape is uniquely determined by ideal lambertian observations in the rgb - ps setup",
    ". however , this still requires identifying which patches in the image have constant albedo and which straddle boundaries .",
    "moreover , noise , shadows , and other non - idealities can render independent per - patch shape reconstructions unstable .",
    "accordingly , we propose a robust algorithm based on the inference framework of @xcite , which combines local patch - wise inference with a global harmonization step .",
    "we analyze a dense overlapping set of patches in the observed rgb - ps image , and extract local shape distributions for each after identifying a restricted set of possible albedo values for the object .",
    "we then combine these local distributions to recover a consistent estimate of global object shape .",
    "we show that the combination of a piece - wise constant albedo assumption and the observation model in our rgb - ps setup enable computationally efficient inference .",
    "both the computation of local shape distributions and global object shape can be efficiently mapped to modern parallel architectures .",
    "we systematically evaluate this method on both synthetic and real images .",
    "we find that our approach , while also being significantly faster , yields higher quality reconstructions with much more surface detail than the approach of @xcite designed for generic natural lighting .",
    "in fact , we show that our method approaches the accuracy of classical multi - image ps with the same set of lighting directions .",
    "formalized initially by horn  @xcite , the sfs problem has been the focus of considerable research over the last few decades  @xcite . a remarkably successful solution to the problem",
    "was recently proposed by @xcite , who introduced a versatile method to recover object shape from a single image of a diffuse object with spatially - varying albedo . however , since it was designed for general un - calibrated natural lighting , their inference algorithm is computationally expensive and relies heavily on strong geometric smoothness priors .",
    "in contrast , our method is designed for a known optimized lighting setup , and is able to efficiently recover shape with a higher degree of surface detail .",
    "rgb - ps was introduced as a means to overcome the requirement in classical ps of capturing multiple images , which makes the latter unusable on moving or deforming objects ( although , some methods attempt to handle such cases using multi - view setups  @xcite ) . however , the degree of ambiguity ( 5 unknowns for 3 observations ) in rgb - ps reconstruction  @xcite is the same as that in single image sfs ( 3 unknowns for 1 observation ) .",
    "previous work addressed this by disallowing albedo variations  @xcite , or by exploiting the temporal constancy of surface reflectance  @xcite .",
    "anderson  @xcite use a stereo rig with multiplexed color lights .",
    "they reconstruct coarse shape and align shading intensities using stereo .",
    "this is used to segment the scene into constant albedo regions , followed by albedo estimation and refinement of surface depth and orientation estimates .",
    "an exception is the work of fyffe  @xcite , who like us , rely on the statistics of natural albedos .",
    "they assume that surface albedo , as a function of spectral wavelength , is low - dimensional .",
    "since this assumption does nt provide an informative constraint for albedos in just three color channels , their setup involves multi - spectral capture under six spectrally distinct color sources .",
    "however , this requires a more complex imaging system and also suffers from lower light efficiency  since the visible spectrum now is split into six , instead of three , non - overlapping bands for both illumination and sensing .",
    "in contrast , we rely on the spatial , instead of spectral , statistics of albedos , and are able to employ regular three - channel rgb cameras .",
    "our estimation algorithm employs a similar computational framework as xiong  @xcite , who used a combination of dense local estimation and globalization for traditional sfs , assuming known albedo and a single known directional light .",
    "our goal is different  we seek to recover high resolution geometric detail in the presence of spatially - varying albedo , from images captured under the rgb - ps setup . to this end , we employ a piece - wise constant assumption on albedo which we show to be informative in our setup , while @xcite assumed piece - wise smooth shape .",
    "the rgb - ps setup , illustrated in fig .",
    "[ fig : teaser ] ( left ) , uses color multiplexing to capture different lighting directions in a single image .",
    "an object is illuminated with three directional mono - chromatic light sources , where each light s spectrum is such that it is observed in only one of the three color channels ( red , green , or blue ) of the camera .",
    "we let @xmath0 denote the product of the direction and scalar intensity of these lights , with directions chosen so that the lighting matrix @xmath1\\in gl(3)$ ] is invertible .    assuming no noise , the observed rgb intensities @xmath2 of an un - shadowed lambertian surface point are @xmath3^t    = { \\mbox{diag}[\\kappa(p)]}l^t\\hat{n}(p),\\ ] ] where @xmath4 the unit normal of the surface point imaged at image location @xmath5 , and @xmath6 is the corresponding rgb surface albedo vector .    both @xmath7 and @xmath8 are unknown , and",
    "can not be recovered point - wise from the three observed intensities in @xmath9 alone .",
    "therefore , we further assume that the object has piecewise constant albedo , , the image can be segmented into a set of regions @xmath10 such that all points within each region have the same albedo : @xmath11 .",
    "this assumption is useful because , as we show next , if a region is correctly identified as having constant albedo , its shape and albedo are typically determined uniquely by the ideal diffuse intensity measurements in the rgb - ps setup .",
    "[ prop:1 ] given noiseless observed intensities @xmath9 at a set of locations @xmath12 on a diffuse surface patch known to have constant albedo , i.e. , @xmath13 , the true surface normals @xmath14 and common albedo @xmath15 are uniquely determined , if :    all intensities @xmath9 are strictly positive .",
    "the true surface is non - degenerate in the sense that the set @xmath16 , of outer - products of the true normal vectors , span the space @xmath17 of all @xmath18 symmetric matrices .",
    "* proof * :  given @xmath15 and @xmath7 as the true patch albedo and normals , let @xmath19 ,  @xmath20 be a second solution pair that also explains the observed intensities @xmath9 in the patch @xmath21 . since the observed intensities are strictly positive , this implies that the albedos @xmath22 are strictly positive as well , and further that no point is in shadow under any of the lights ,  @xmath23 .",
    "then , since @xmath24 is invertible , we can write @xmath25}l^t\\hat{n}(p ) = { \\mbox{diag}[\\kappa'_\\omega]}l^t\\hat{n}'(p)\\notag\\\\    \\rightarrow \\hat{n}'(p ) = a\\hat{n}(p),~~\\forall p\\in\\omega,\\end{aligned}\\ ] ] where we define the matrix @xmath26 , with @xmath27}^{-1}{\\mbox{diag}[\\kappa_\\omega]}$ ] being a diagonal matrix whose entries are the ratio between the two albedo solutions .",
    "note that these entries also correspond to the eigenvalues of @xmath28 , and are real and positive since @xmath29 are real and positive .",
    "since @xmath20 are unit vectors , we have as conditions on @xmath28 : @xmath30_{ij } = 1,~\\forall p\\in\\omega,\\end{aligned}\\ ] ] where @xmath31 refers to the element - wise hadamard product , and @xmath32_{ij}$ ] to the @xmath33 element of the matrix @xmath34 .",
    "represents a set of linear equations on the elements of @xmath35 .",
    "since @xmath36 and @xmath37 spans @xmath17 , this linear system is full rank , and can have at most one solution .",
    "it is easy to see that this unique solution is given by @xmath38 .",
    "therefore , @xmath28 must be an orthogonal matrix , and since the only orthogonal matrix with only real and positive eigenvalues is the identity , @xmath39 .",
    "this in - turn implies @xmath40 , @xmath41 , and from , @xmath42 .",
    "therefore , the solutions must be identical , and the albedo and normals of the surface are uniquely determined.@xmath43 + intuitively , the non - degeneracy condition in prop .  [ prop:1 ] requires that the region @xmath21 have sufficient diversity in its surface normals  such that no non - trivial linear transform preserves the length of all normal vectors .",
    "the curvature and relief in most surface regions typically render them non - degenerate .",
    "an example of a degenerate surface is a perfect plane  all normals , and therefore all observed intensities , in a plane are identical , and its orientation has the same ambiguity as the normal of a single point .",
    "it is important to remember that the uniqueness result in the previous section holds only in the ideal case . with observation noise , for example , there may be multiple diverse surface - albedo explanations that come equally close to explaining the intensities in a region .",
    "moreover , a segmentation of the image into constant - albedo regions is not available , and must be inferred jointly estimated with the albedo and shape of each region . in this section ,",
    "we describe a robust and efficient algorithm to carry out such inference .",
    "formally , we seek to recover the surface normal field @xmath7 of an object , given its color image @xmath9 acquired under known lighting @xmath44 .",
    "our estimation method uses a framework similar to that of @xcite , with local inference followed by globalization to simultaneously reasons about whether different local patches have constant albedos , and if so , about their shape using the constant - albedo constraint .",
    "broadly , we consider a set of dense overlapping fixed - size patches in the observed image , and run local inference independently , and in - parallel , on each patch . for robustness ,",
    "rather than commit to a single local shape estimate , the local inference step produces a distributional output for every patch in the form of a discrete set of candidate shapes and associated scores . each shape in this distribution corresponds to surface normals that best explain the observed patch intensities assuming a different constant patch albedo .",
    "this set is computed for a dense sampling of the albedo space . following prop .",
    "[ prop:1 ] , patches with good surface variation produce more accurate shape estimates and have scores that are tightly clustered around the correct albedo value .",
    "we further assume that the observed object overall has a limited number of distinct albedos .",
    "this adds an additional constraint to inference that makes the per - patch local distributions compact .",
    "we identify a global albedo set as the peaks of a histogram of scores over all albedos , computed from all patches in the observed image .",
    "local distributions for each patch are then restricted to consist of shape estimates corresponding only to albedos in this global set .",
    "this allows albedo estimates in patches that are not ambiguous to restrict the space of solutions at other patches that are",
    ".    local inference is followed by global optimization that finds a consistent normal map for the object by harmonizing the local shape distributions of all overlapping patches .",
    "this optimization refines the patch - wise shape estimates by considering consistency with other overlapping patches , and either selecting one of the local candidate shapes or deciding to ignore the local estimates all together to account for the possibility that the patch albedo is _ not _ constant .",
    "we next describe the local inference and globalization steps in detail .      given a dense set of patches @xmath45 that cover the image plane , local inference produces distributions comprising sets of @xmath46 surface normal estimates @xmath47 , and corresponding scores @xmath48 , for every patch .",
    "these distributions are computed with respect to a global albedo set @xmath49 for the image , where normal estimates @xmath50 are computed assuming @xmath51 as the albedo in patch @xmath52 .",
    "[ [ local - shape - model ] ] local shape model + + + + + + + + + + + + + + + + +    during inference , we represent each set of local surface normals @xmath50 based on a polynomial model for surface depth within a patch : @xmath53}~x^{d_x}y^{d_y},\\ ] ] where @xmath54 is the polynomial degree .",
    "the coefficient vector @xmath55}\\}]^t$ ] describes the @xmath56 candidate shape estimate for @xmath52 , with @xmath50 corresponding to the surface normals of @xmath57 above .",
    "this approach automatically constrains each candidate normal set @xmath50 to be integrable .",
    "note that a similar polynomial model ( with @xmath58 ) was also used in @xcite .",
    "however , unlike @xcite , our goal is not to impose smoothness on our local shape estimates , but to make shape estimation more efficient .",
    "therefore , we employ higher degree polynomials to able to express high - frequency local relief .",
    "we use @xmath59 to represent the co - ordinates of the intersection of a normal vector @xmath60 with the @xmath61 plane , @xmath62^t/\\|[\\tilde{n},1]\\|$ ] .",
    "these co - ordinates correspond to the gradients of depth : @xmath63 $ ] .",
    "we let @xmath64 denote a vector formed by concatenating the gradient vectors @xmath65 at all pixels @xmath66 . then , assuming all patches @xmath52 are the same size and using a patch - centered co - ordinate system in , we have @xmath67^t\\notag\\\\    & = \\left[\\begin{array}{ccc}&\\vdots\\\\        \\cdots & d_xx_i^{d_x-1}y_i^{d_y}&\\cdots\\\\        \\cdots&d_yx_i^{d_x}y_i^{d_y-1}&\\cdots\\\\ & \\vdots\\end{array}\\right]\\left[\\begin{array}{c}\\vdots\\\\(a_{m : k})_{[d_x , d_y]}\\\\\\vdots\\end{array}\\right]\\notag\\\\    & = ga_{m : k},\\end{aligned}\\ ] ] , the concatenated gradient vectors @xmath68 for all patches are related to their coefficients @xmath69 by the same matrix @xmath70 .",
    "[ [ albedo - parameterization ] ] albedo parameterization + + + + + + + + + + + + + + + + + + + + + + +    for the albedo of each patch , we search over a discrete set formed by quantizing the space of possible albedo vectors @xmath71 . in particular ,",
    "we factor @xmath72 as the product of a scalar `` luminance '' @xmath73 , and a chromaticity vector @xmath74the latter constrained to be a unit vector with non - negative elements",
    ". this factorization will prove convenient since the point - wise ambiguity in rgb - ps is resolved when the albedo chromaticity @xmath74 is known .",
    "we construct our discrete candidate albedo set by quantizing @xmath73 and @xmath74 separately into uniformly spaced bins @xmath75 in @xmath76 $ ] and @xmath77 in @xmath78 respectively . here , the value of @xmath79 depends on the scale of the intensities @xmath9 and lighting matrix @xmath44 .",
    "[ [ global - albedo - set ] ] global albedo set + + + + + + + + + + + + + + + + +    the first step in inference is identifying a restricted global set of possible albedo values present in the object by pooling evidence from all patches .",
    "we do this by iterating over the discrete values of candidate albedo chromaticities @xmath80 , and for each chromaticity @xmath81 , computing estimates of the albedo luminance values @xmath82 and integrable surface normals @xmath83 , for every patch @xmath52 .",
    "we score these estimates in terms of a normalized rendering error @xmath84 where @xmath85}l^t\\hat{n}(p)\\|^2}{\\sum_{p\\in\\omega_m}\\|v(p)\\|^2}.\\ ] ] note that the denominator above is the same for different albedo - shape explanations for a given patch , and only serves to weight contributions from different patches .",
    "while we could use a full non - linear optimizer to minimize to compute the luminance and normal estimates @xmath82 and @xmath86 , we find that a much simpler and faster approach suffices .",
    "we first compute normals @xmath87 and luminance values @xmath88 for individual pixels simply as @xmath89}^{-1}v(p),\\ ] ] disambiguating the two terms in the lhs using the fact that @xmath88 is a scalar , and @xmath87 a unit vector .",
    "this computation can be done for all pixels efficiently on modern parallel architectures , since it maps to the product of the same matrix @xmath90}^{-1})$ ] with all the intensity vectors @xmath9 .",
    "then , we compute per - patch luminance and normal estimates by `` projecting '' their set of pixel - wise values to the constant - albedo and polynomial depth models respectively .",
    "we set @xmath82 simply to the mean of the corresponding pixel luminances @xmath91 in the patch . for the normals ,",
    "we find the best fit of the pixel - wise normals to the polynomial model for each patch @xmath92 where @xmath93 is the concatenated gradient vector for patch @xmath52 formed from the per - pixel normals @xmath94 .",
    "we then set @xmath86 to the unit normals corresponding to @xmath95 .",
    "these computations can also be carried out efficiently , in this case parallelized across patches .",
    "using these estimates and corresponding errors @xmath96 , we construct a global histogram @xmath97 $ ] over the full discrete candidate albedo set using clipped values of these errors as @xmath98 = \\sum_{m } i[\\tau_{m : c } = _ q \\tau_l]\\times\\max\\left(0,h_{\\max}-s_{m : c}\\right),\\ ] ] where @xmath99 $ ] is one when the quantized value of @xmath82 equals @xmath100 , and zero otherwise . every patch",
    "thus makes a contribution to only one luminance bin for every chromaticity value .",
    "@xmath97 $ ] represents a soft aggregation of the number of patches that have low rendering errors ( as per @xmath101 ) for each albedo . using non - maxima suppression ,",
    "we construct our global albedo set @xmath102 as the @xmath46 highest - valued peaks in the histogram @xmath97 $ ] .",
    "[ [ local - shape - distributions ] ] local shape distributions + + + + + + + + + + + + + + + + + + + + + + + + +    we then recompute normal estimates and rendering error scores for all patches , now with respect to only the global albedo set .",
    "we follow a similar procedure as above .",
    "we iterate over the chromaticities of the albedos in the global set , and for each @xmath103 , we compute pixel - wise luminance and normal values @xmath104 and @xmath105 using . we compute the per - patch surface coefficients @xmath69 , and therefore the corresponding normals @xmath50 , from @xmath105 using .",
    "our local distributions are then @xmath46 pairs @xmath106 of these surface coefficients , along with rendering scores @xmath107 .",
    "here , we set @xmath108 by projecting the mean , of the per - pixel luminances @xmath109 , to the bin corresponding to the luminance @xmath110 of the @xmath56 albedo in the global set .",
    "to form our final shape estimate , we have to find a single shape estimate for each patch @xmath52by deciding between selecting one of multiple shape candidates , or ignoring them all together to account for patches with varying albedo  and harmonize normal estimates at each pixel @xmath111 from multiple overlapping patches that include it .",
    "we do this by employing an alternating iterative algorithm to minimize a consensus - based cost function similar to @xcite .",
    "this cost function is defined over the pixel - wise depth gradient map @xmath112 , and auxiliary variables @xmath113 that correspond to per - patch shape coefficients , as @xmath114,\\end{aligned}\\ ] ] where @xmath115 is formed from concatenating @xmath116 .",
    "the first term of the cost function essentially requires the gradients @xmath112 at each pixel to be close to their predicted estimates @xmath117 from all patches @xmath118 that include that pixel .",
    "the second term enforces fidelity between the per - patch shape coefficients @xmath119 and the local distributions @xmath120 .",
    "@xmath121 is a scalar parameter that controls the relative contribution of these two terms .",
    "the fidelity of @xmath119 to each candidate shape @xmath69 is defined as the sum of the squared error between them and the shape s score @xmath122 . considers the best cost across the different candidates for each patch , and to be able to reject distributions for patches with varying albedo , applies a threshold @xmath123 . when costs of all candidates are beyond this threshold , @xmath119 no longer depends on any of the candidate shapes @xmath124 .",
    "note `` outlier '' handling in our setup serves a different purpose than it did in @xcite .",
    "while we ignore the shape candidates for an outlier , we still enforce the local polynomial shape model .",
    "thus , we only reject the constant - albedo assumption .",
    "our higher - degree polynomial shape model encodes integrability , not smoothness like in @xcite , and enforcing it even in outlier patches allows us to avoid a separate global integrability term in the objective in .",
    "we minimize using an iterative algorithm that alternates between optimizing with respect to @xmath112 and to @xmath113 , while keeping the other fixed .",
    "we also find it useful to begin the iterations with a smaller value of @xmath121 , and increase it by a constant factor at each iteration till it reaches its final value .",
    "we begin by initializing each @xmath119 to simply the candidate shape @xmath69 with the smallest value of @xmath122 .",
    "then , in each iteration , we first minimize with respect to the gradient map @xmath112 keeping @xmath113 fixed .",
    "this is achieved simply by setting each @xmath112 to the mean of its estimates @xmath125 from all patches containing @xmath111 .",
    "the second step at each iteration minimizes with respect to @xmath113 , which can be done independently for each @xmath119 .",
    "we first compute a set of auxiliary coefficients and scores based on @xmath112 as @xmath126 and for @xmath127 , @xmath128 .",
    "each @xmath119 is then set to the @xmath129 among @xmath130 ( , including the outlier case @xmath131 ) for which @xmath132 is lowest .",
    "we now report quantitative and qualitative results on the performance of the proposed method on a large number of synthetically generated surfaces , as well as on acquired images of real objects . in all experiments , we use fully overlapping sets of @xmath133 patches . for the polynomial shape model ,",
    "we choose degree @xmath134 , and for albedo discretization , we choose 4096 bins for chromaticity@xmath135 each over elevation and azimuth of @xmath136and 100 bins for luminance , and set @xmath137 for observed intensities in the range @xmath138 $ ] .    for local inference ,",
    "we consider a global albedo set of size @xmath139 , and set the histogram error threshold @xmath101 to @xmath140 for the synthetic surface renderings in sec  [ sec : synth ] below , and to a higher value of @xmath141 for the real acquired images in sec .",
    "[ sec : real ] to account for higher noise and other non - idealities . for global inference",
    ", we set the outlier threshold @xmath142 .",
    "we run alternating minimization starting with @xmath143 , increasing it by a constant factor of @xmath144 at each iteration till it reaches @xmath145 , for a total of 145 iterations .",
    "we synthetically render @xmath146 randomly generated surfaces to conduct a systematic quantitative evaluation of our method s performance .",
    "each image is of size @xmath147 pixels , and is rendered using randomly generated albedo and depth maps and a common chosen lighting @xmath44 .",
    "the albedo map is generated by dividing the image into four equal triangles , and picking a random albedo vector per triangle .",
    "the surface is generated by first choosing a random base planar ( ensuring that it is not in shadow ) , and adding zero - mean gaussian depth perturbations",
    " generated first at a coarser scale ( of @xmath148 ) and smoothly up - sampled to @xmath147 .",
    "examples of these random surfaces are in fig .",
    "[ fig : synthfig ] ( left ) .",
    "we render all surfaces using with moderate @xmath149 gaussian observation noise , simulating attached shadows by clipping negative values of @xmath150 to zero .",
    "we run our full algorithm on each image , and compute angular errors between estimated and true surface normals .",
    "figure  [ fig : synthfig ] ( center ) shows a cumulative distribution of these errors across all pixels in all surfaces  summarizing our estimation accuracy over a diverse set of albedo - geometry combinations .",
    "we see that our method is usually able to recover accurate surface geometry , with a median error of @xmath151 . as the albedo boundaries in all our rendered images",
    "are aligned , we are also able to visualize how performance varies in pixels close to these boundaries . figure  [ fig : synthfig ] ( right ) shows location - wise median errors , median across surfaces of errors at each pixel location . as expected , we see that errors are higher near albedo boundaries . however , the range of this variation is small  from roughly @xmath152 within constant albedo regions to a high of @xmath153 at albedo `` corners '' .",
    "we evaluate our method on four real objects that were single - shot imaged by a canon eos 40d camera under our rgb photometric stereo setup .",
    "we place color filters in front of three led lights , with filters chosen to create monochromatic lights  we ensure that in a scene lit by , say , only the red light source , green and blue camera intensities are nearly zero .",
    "lighting directions @xmath44 are estimated with a chrome sphere .",
    "we work with raw camera images , where color channels are multiplexed using a bayer pattern . to avoid artifacts from demosaicking",
    ", we blur the image with a one pixel std .",
    "gaussian filter for anti - aliasing , and then down - sample to form a single rgb pixel for every @xmath154 bayer block .",
    "we compute an object mask against the dark background by simple thresholding , and only run inference within this mask .",
    "we also white - balance each image ( dividing each channel by its mean intensity ) , so that the discretization of our albedo search space is uniform .",
    "we also capture images of each object from the same camera , now under different directional white light sources , and run robust classical photometric stereo to get aligned ground truth normal and albedo maps .",
    "moreover , for comparison , we use the known albedo and single - shot rgb image to simulate three separate captures under white lights with the same exact directions as our setup .",
    "we estimate a set of surface normals through classical photometric stereo on these images .",
    "since errors in these normals are due only to non - idealities like shadowing , inter - reflections , specularities , , they represent an upper bound on the performance under our more ambiguous single - shot setup .",
    "figures  [ fig : realfig ] and [ fig : realfig2 ] show our results on these real objects , and fig .",
    "[ fig : realfig3 ] shows alternate views rendered using depth maps obtained by integrating our estimated normals .",
    "our method produces high - quality surface normal estimates in most regions , even though the objects feature natural albedo variations that deviate from our strict piecewise constant model .",
    "this highlights the robustness of our method , and its practical utility .",
    "indeed , we find that most of our errors are in regions where three - source photometric stereo also fails ( , due to shadows ) , although these errors are exaggerated in our estimates  both in magnitude and spatial extent . also note the errors in the base and dark spots of the `` giraffe '' in fig .  [",
    "fig : realfig2 ] .",
    "the albedo values in these regions have roughly constant chromaticity , but continuously changing luminance  and happen to provide a plausible , but incorrect , solution under the piecewise constant albedo model .",
    "we also include results from @xcite in figs .",
    "[ fig : realfig ] and [ fig : realfig2 ] , providing it our calibrated lighting environment , but without using contour information .",
    "we see that @xcite recovers only a coarse estimate of surface geometry , with much less detail than our method .",
    "moreover , it takes 20 mins .  for a @xmath155 image with @xmath156 valid pixels on a 6-core 3.5ghz cpu .",
    "in contrast , our method only takes 160 secs .  with a titan x gpu .",
    "the source code for our implementation , along with data , is available for download at the project website at http://www.ttic.edu / chakrabarti / rgbps/.",
    "in this paper , we presented a single - shot system for recovering the shape of objects with spatially - varying albedo , using a calibrated rgb - ps setup for acquisition",
    ". inference was based on a piece - wise constant model for surface albedo .",
    "we characterized the shape information in rgb - ps observations under this model , showing that exact recovery is possible under idealized conditions .",
    "then , we described a robust and efficient inference algorithm that achieved high - quality results on complex real - world objects .",
    "our system s ability to perform accurate single - shot shape recovery means that it can be used to reconstruct dynamic , deforming objects from a sequence of video frames  which previously had required multi - view setups  @xcite . beyond simply generating stand - alone shape estimates from each image , in future work we will explore efficient ways to incorporate temporal constraints across frames .",
    "we believe this can allow high - quality time - varying reconstructions from monocular video , for example , by ameliorating the effects of shadows  regions that are in shadow in some frames may be lit in others .",
    "we are also interested in extending our method to leverage additional information , like contours , when available , and incorporating non - lambertian reflection models for complex materials ."
  ],
  "abstract_text": [
    "<S> we present a single - shot system to recover surface geometry of objects with spatially - varying albedos , from images captured under a calibrated rgb photometric stereo setup  with three light directions multiplexed across different color channels in the observed rgb image . </S>",
    "<S> since the problem is ill - posed point - wise , we assume that the albedo map can be modeled as piece - wise constant with a restricted number of distinct albedo values . </S>",
    "<S> we show that under ideal conditions , the shape of a non - degenerate local constant albedo surface patch can theoretically be recovered exactly . </S>",
    "<S> moreover , we present a practical and efficient algorithm that uses this model to robustly recover shape from real images . </S>",
    "<S> our method first reasons about shape locally in a dense set of patches in the observed image , producing shape distributions for every patch . </S>",
    "<S> these local distributions are then combined to produce a single consistent surface normal map . </S>",
    "<S> we demonstrate the efficacy of the approach through experiments on both synthetic renderings as well as real captured images .    </S>",
    "<S> = 1 </S>"
  ]
}