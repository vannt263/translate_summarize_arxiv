{
  "article_text": [
    "let us suppose that @xmath0 is a general lvy process with law @xmath1 and lvy measure @xmath2 . that is to say , @xmath3 is a markov process with paths that are right continuous with left limits such that the increments are stationary and independent and whose characteristic function at each time @xmath4 is given by the lvy - khinchine representation [ eq1 ] [ e^ix_t]=e^-t ( ) , , where @xmath5 we have @xmath6 , @xmath7 and @xmath2 is a measure supported on @xmath8 with @xmath9 and @xmath10 .",
    "starting with the early work of madan and seneta @xcite , lvy processes have played a central role in the theory of financial mathematics and statistics ( see for example the books @xcite ) .",
    "more recently they have been extensively used in modern insurance risk theory ( see for example klppelberg et al .",
    "@xcite , song and vondraek @xcite ) .",
    "the basic idea in financial mathematics and statistics is that the log of a stock price or risky asset follows the dynamics of a lvy process whilst in insurance mathematics , it is the lvy process itself which models the surplus wealth of an insurance company until ruin .",
    "there are also extensive applications of lvy processes in queuing theory , genetics and mathematical biology as well as through their appearance in the theory of stochastic differential equations .    in both financial and insurance settings ,",
    "a key quantity of generic interest is the joint law of the current position and the running maximum of a lvy process at a fixed time if not the individual marginals associated with the latter bivarite law .",
    "for example , if we define @xmath11 then the pricing of barrier options boil down to evaluating expectations of the form @xmath12 $ ] for some appropriate function @xmath13 and threshold @xmath14 . indeed if @xmath15 then the latter expectation is related to the value of an ` up - and - in ' put . in credit risk",
    "one is predominantly interested in the quantity @xmath16 as a function in @xmath17 and @xmath4 , where @xmath18 is the law of the dual process @xmath19 .",
    "indeed it is as a functional of the latter probabilities that the price of a credit default swap is computed ; see for example the recent book of schoutens and cariboni @xcite .",
    "one is similarly interested in @xmath20 in ruin theory as these probabilities are also equivalent to the finite - time ruin probabilities .",
    "one obvious way to do monte - carlo simulation of expectations involving the joint law of @xmath21 that takes advantage of the stationary and independent increments of lvy processes is to take a random walk approximation to the lvy process , simulate multiple paths , taking care to record the maximum for each run .",
    "whilst one is able to set things up in this way so that one samples exactly from the distribution of @xmath22 , the law of the maximum of the underlying random walk will not agree with the law of @xmath23 .    taking account of the fact that all lvy processes respect a fundamental path decomposition known as the wiener - hopf factorisation , it turns out there is another very straightforward way to perform monte - carlo simulations for expectations involving the joint law of @xmath21 which we introduce in this paper .",
    "our method allows for exact sampling from the law of @xmath24 where @xmath25 is a random time whose distribution can be concentrated arbitrarily close around @xmath4 .",
    "there are several advantages of the technique we use which are discussed in detail in the subsequent sections of this paper .",
    "firstly , when it is taken in context with very recent developments in wiener - hopf theory for lvy processes , for example recent advances in the theory of scale functions for spectrally negative processes ( see kyprianou et al .",
    "@xcite ) , new complex analytical techniques due to kuznetsov @xcite and vigon s theory of philanthropy ( see @xcite ) , one may quickly progress the algorithm to quite straightforward numerical work . secondly , our wiener - hopf method takes advantage of a similar feature found in the , now classical , ` canadization ' method of carr @xcite for numerical evaluation of optimal stopping problems .",
    "the latter is generally acknowledged as being more efficient than appealing to classical random walk approximation monte - carlo methods .",
    "indeed , later in this paper , we present our numerical findings with some indication of performance against the method of random walk approximation . in this case , our wiener - hopf method appears to be extremely effective .",
    "thirdly , in principle , our method handles better the phenomena of discontinuities which can occur with functionals of the form @xmath12 $ ] at the boundary point @xmath26 .",
    "it is now well understood that the issue of regularity of the upper and lower half line for the underlying lvy process ( see chapter 6 of @xcite for a definition ) is responsible the appearance of a discontinuity at @xmath26 in such functions ( cf .",
    "the nature of our wiener - hopf method naturally builds the distributional atom which is responsible for this discontinuity into the simulations .",
    "additional advantages to the method we propose include its simplicity with regard to numerical implementation .",
    "moreover , as we shall also see in section [ sect : extensions ] of this paper , the natural probabilistic structure pertaining to lvy processes that lies behind our so - called wiener - hopf monte - carlo method also allows for additional creativity when addressing some of the deficiencies of the method itself .",
    "the basis of the algorithm is the following simple observation which was pioneered by carr @xcite and subsequently used in several contexts within mathematical finance for producing approximate solutions to free boundary value problems that appear as a result of optimal stopping problems that characterise the value of an american - type option .",
    "suppose that @xmath27 are a sequence of i.i.d .",
    "exponentially distributed random variables with unit mean .",
    "suppose they are all defined on a common product space with product law @xmath28 which is orthogonal to the probability space on which the lvy process @xmath3 is defined . for all @xmath29 , we know from the strong law of large numbers that @xmath30 @xmath28-almost surely .",
    "the random variable on the left hand side above is equal in law to a gamma random variable with parameters @xmath31 and @xmath32 .",
    "henceforth we write it @xmath33 . recall that @xmath34 is our notation for a general lvy process .",
    "then writing @xmath11 we argue the case that , for sufficiently large @xmath31 , a suitable approximation to @xmath35 is @xmath36 .",
    "this approximation gains practical value in the context of monte - carlo simulation when we take advantage of the fundamental path decomposition that applies to all lvy processes over exponential time periods known as the wiener - hopf factorisation .",
    "[ thm_main ] for all @xmath37 and @xmath38 define @xmath39",
    ". then [ distr_identity ] ( x_(n , ) , _",
    "( n , ) ) ( v(n , ) , j(n , ) ) where @xmath40 and @xmath41 are defined iteratively for @xmath37 as v(n , ) & = & v(n-1,)+s^(n)_+ i^(n ) _ + j(n , ) & = & ( j(n-1 , ) , v(n-1,)+ s^(n ) _ ) and @xmath42 . here ,",
    "@xmath43 , @xmath44 are an i.i.d .",
    "sequence of random variables with common distribution equal to that of @xmath45 and @xmath46 are another i.i.d . sequence of random variables with common distribution equal to that of @xmath47 .",
    "suppose we define @xmath48 .",
    "then it is trivial to note that @xmath49 where @xmath50 .",
    "next we prove by induction that for each @xmath51 @xmath52 note first that the above equality is trivially true when @xmath53 on account of the wiener - hopf factorisation .",
    "indeed the latter tells us that @xmath45 and @xmath54 are independent and the second of the pair is equal in distribution to @xmath47 .",
    "now suppose that ( [ induction ] ) is true for @xmath55 .",
    "then stationary and independent increments of @xmath3 together with the wiener - hopf factorisation imply that @xmath56 where @xmath57 is an independent copy of @xmath3 , @xmath58 and @xmath59 .",
    "the induction hypothesis thus holds for @xmath60 .    for @xmath61 , stationary and independent increments of @xmath3 allows us to write @xmath62 hence for @xmath63 @xmath64 > from ( [ max ] ) and ( [ induction ] ) the result now follows .",
    "note that the idea of embedding a random walk into the path of a lvy process with two types of step distribution determined by the wiener - hopf factorisation has been used in a different , and more theoretical context , by doney @xcite .    given ( [ slln ] ) it is clear that the pair @xmath65 converges in distribution to @xmath21 .",
    "this suggests that we need only to be able to simulate i.i.d .",
    "copies of the distributions of @xmath66 and @xmath67 and then by a simple functional transformation we may produce a realisation of random variables @xmath68 . given a suitably nice function @xmath69 , using standard monte - carlo methods one estimates for large @xmath70 @xmath71 \\simeq \\frac{1}{k}\\sum_{m=1}^k f(v^{(m)}(n , n / t ) , j^{(m)}(n , n / t ) ) \\label{wh - mc}\\ ] ] where @xmath72 are i.i.d .",
    "copies of @xmath73 .",
    "indeed the strong law of large numbers implies that the right hand side above converges almost surely as @xmath74 to @xmath75 which in turn converges as @xmath76 to @xmath77 .",
    "the central limit theorem indicates that the right hand side of ( [ wh - mc ] ) converges to @xmath78 $ ] at rate @xmath79 .",
    "below we give an indiction of the rate of convergence of @xmath78 $ ] to the desired expectation @xmath80 $ ] .",
    "[ rate ] assume that function @xmath81 belongs to the domain of @xmath82 , the infinitesimal generator of @xmath83 .",
    "then as @xmath84 [ asymptotic_speed ] = + o(n^-12 )    for @xmath85 and @xmath86 define @xmath87 $ ] .",
    "the fact that @xmath88 belongs to the domain of the infinitesimal generator guarantees that function @xmath89 satisfies kolmogorov equation @xmath90 , in particular function @xmath91 is differentiable in the variable @xmath92 . using ( [ distr_identity ] ) and",
    "the fact that @xmath93 is independent of @xmath22 we find @xmath94&=&{\\bbb{e}}\\left [ f(x_{\\mathbf{g}(n , n / t ) } , \\overline{x}_{\\mathbf{g}(n , n / t ) } ) \\right]\\\\   & = & \\int\\limits_{\\r^+ } { \\bbb{e}}\\left[f(x_s , \\overline{x}_s ) \\right ] { \\bbb{p}}(\\mathbf{g}(n , n / t ) \\in",
    "\\d s)\\\\ & = &   \\frac{n^n}{t^n ( n-1)!}\\int\\limits_{\\r^+ }   h(s ) s^{n-1 } e^{-\\frac{ns}{t } }   \\d s.\\end{aligned}\\ ] ] the remainder of the proof is a classical application of the stationary point method ( see @xcite ) . the right side of the above equation is equal to [ proof_asympt1 ] & & + & & = ( + o(1/n ) ) _",
    "-^ h(t+ ) e^-2 u where we have changed the variable of integration @xmath95 and have used stirling s formula @xmath96 .",
    "next , using power series expansion @xmath97 one can check that ( 2+n(1 + ) -u ) = ( - +  ) = 1 + + o(1/n ) and combining this with ( [ proof_asympt1 ] ) and the fact that @xmath98 we obtain ( [ asymptotic_speed ] ) .",
    "the algorithm described in the previous section only has practical value if one is able to sample from the distributions of @xmath45 and @xmath99 .",
    "it would seem that this , in itself , is not that much different from the problem that it purports to solve .",
    "however , it turns out that there are many tractable examples and in all cases this is due to the tractability of their wiener - hopf factorisations .    whilst several concrete cases can be handled from the class of spectrally one - sided lvy processes",
    "thanks to recent development in the theory of scale functions which can be used to described the laws of @xmath45 and @xmath99 ( cf .",
    "@xcite ) , we give here two large families of two sided jumping lvy processes that have pertinence to mathematical finance to show how the algorithm may be implemented .",
    "the @xmath100-class of lvy processes , introduced in @xcite , is a 10-parameter lvy process which has characteristic exponent @xmath101 with parameter range @xmath102 and @xmath103 . here",
    "@xmath104 is the beta function ( see @xcite ) .",
    "the density of the lvy measure is given by @xmath105 although @xmath106 takes a seemingly complicated form , this particular family of lvy processes has a number of very beneficial virtues from the point of view of mathematical finance which are discussed in @xcite .",
    "moreover , the large number of parameters also allows one to choose lvy processes within the @xmath100-class that have paths that are both of unbounded variation ( when at least one of the conditions @xmath107 , @xmath108 or @xmath109 holds ) and bounded variation ( when all of the conditions @xmath110 , @xmath111 and @xmath112 hold ) as well as having infinite and finite activity in the jumps component ( accordingly as both @xmath113 or not ) .",
    "what is special about the @xmath100-class is that all the roots of the equation @xmath114 are completly identifiable which leads to semi - explicit identities for the laws of @xmath45 and @xmath99 as the following result lifted from @xcite shows .",
    "[ kuz1 ] for @xmath38 , all the roots of the equation @xmath115 are simple and occur on the imaginary axis .",
    "they can be enumerated by @xmath116 on the positive imaginary axis and @xmath117 on the negative imaginary axis in order of increasing absolute magnitude where @xmath118 moreover , for @xmath119 , @xmath120 where @xmath121 a similar expression holds for @xmath122 with the role of @xmath123 being played by @xmath124 and @xmath125 replaced by @xmath126 .",
    "note that when @xmath127 is irregular for @xmath128 the distribution of @xmath45 will have an atom at @xmath127 which can be computed from ( [ max - density ] ) and is equal to @xmath129 .",
    "alternatively , from remark 6 in @xcite this can equivalently be written as @xmath130 .",
    "a similar statement can be made concerning an atom at @xmath127 for the distribution of @xmath99 when @xmath127 is irregular for @xmath131 .",
    "conditions for irregularity are easy to check thanks to bertoin @xcite ; see also the summary in kyprianou and loeffen @xcite for other types of ly processes that are popular in mathematical finance .    by making a suitable truncation of the series ( [ max - density ] )",
    "one may easily perform independent sampling from the distributions @xmath132 and @xmath133 as required for our monte - carlo methods .",
    "the forthcoming discussion will assume familiarity with classical excursion theory of lvy processes for which the reader is referred to chapter vi of @xcite or chapter 6 of @xcite .    according to vigon s theory of philanthropy , a ( killed ) subordinator",
    "is called a _ philanthropist _ if its lvy measure has a decreasing density on @xmath134 . moreover , given any two subordinators @xmath135 and @xmath136 which are philanthropists , providing that at least one of them is not killed , there exist a lvy process @xmath3 such that @xmath135 and @xmath136 have the same law as the ascending and descending ladder height processes of @xmath3 , respectively .",
    "suppose we denote the killing rate , drift coefficient and lvy measures of @xmath135 and @xmath136 by the respective triples @xmath137 and @xmath138 .",
    "then @xcite shows that the lvy measure of @xmath3 satisfies the following identity @xmath139 where @xmath140 is the density of @xmath141 . by symmetry",
    ", an obvious analogue of ( [ phillm ] ) holds for the negative tail @xmath142 , @xmath143 .",
    "a particular family of subordinators which will be of interest to us is the class of subordinators which is found within the definition of kuznetsov s @xmath100-class of lvy processes .",
    "these processes have characteristics @xmath144 where @xmath145 , @xmath146 and @xmath147 .",
    "the lvy measure of such subordinators is of the type @xmath148    > from proposition 9 in @xcite , the laplace exponent of a @xmath100-class subordinator satisfies [ kuz ] ( ) = + + \\",
    "{ b(1-+ , - ) - b ( 1-++/ , - ) } for @xmath149 where @xmath150 is the drift coefficient and @xmath151 is the killing rate .",
    "let @xmath135 and @xmath152 be two independent subordinators from the @xmath100-class where for @xmath153 with respective drift coefficients @xmath154 , killing rates @xmath155 and lvy measure parameters @xmath156 .",
    "their respective laplace exponents are denoted by @xmath157 , @xmath158 . in vigon",
    "s theory of philanthropy it is required that @xmath159 . under this assumption ,",
    "let us denote by @xmath3 the lvy process whose ascending and descending ladder height processes have the same law as @xmath135 and @xmath136 , respectively .",
    "in other words , the lvy process whose characteristic exponent is given by @xmath160 it is important to note that the gaussian component of the process @xmath3 is given by @xmath161 , see @xcite .",
    "> from ( [ phillm ] ) , the lvy measure of @xmath3 is such that @xmath162 assume first that @xmath163 , taking derivative in @xmath17 and computing the resulting integrals with the help of @xcite we find that for @xmath119 the density of the lvy measure is given by ( x)&=&-(,-_2 ) e^-x ( 1+_1-_1 ) _",
    "2f_1(1+_1,;-_2;e^-x ) + & + & c_1 ( k_2 + ( 1+_2-_2,-_2 ) ) - _ 2 c_1 where @xmath164 .",
    "the validity of this formula is extended for @xmath165 by analytical continuation . the corresponding expression for @xmath143",
    "can be obtained by symmetry considerations .",
    "we define a general hypergeometric process to be the 13 parameter lvy process with characteristic exponent given in compact form @xmath166 where @xmath167 . the inclusion of the two additional parameters @xmath168 is largely with applications in mathematical finance in view . without these two additional parameters",
    "it is difficult to disentangle the gaussian coefficient and the drift coefficients from parameters appearing in the jump measure .",
    "note that the gaussian coefficient in ( [ compact ] ) is now @xmath169 .",
    "the definition of general hypergeometric lvy processes includes previously defined hypergeometric lvy processes in kyprianou et al .",
    "@xcite , caballero et al .",
    "@xcite and lamperti - stable lvy processes in caballero et al .",
    "@xcite .    just as with the case of the @xmath100-family of lvy processes , because @xmath106 can be written as a linear combination of a quadratic form and beta functions , it turns out that one can identify all the roots of the equation @xmath170 which is again sufficient to describe the laws of @xmath45 and @xmath99 .",
    "[ hg ] for @xmath38 , all the roots of the equation @xmath115 are simple and occur on the imaginary axis .",
    "moreover , they can be enumerated by @xmath171 on the positive imaginary axis and @xmath172 on the negative imaginary axis in order of increasing absolute magnitude where @xmath173 moreover , for @xmath119 , @xmath174 where @xmath175 moreover , a similar expression holds for @xmath176 with the role of @xmath177 replaced by @xmath178 and @xmath179 replaced by @xmath180 .",
    "the proof is very similar to the proof of theorem 10 in @xcite .",
    "formula ( [ compact ] ) and reflection formula for the beta function ( see @xcite ) [ eq_beta_reflection ] b(-z;-)=b(1+z+;- ) tell us that @xmath181 as @xmath182 , and since @xmath183 we conclude that @xmath184 has a solution on the interval @xmath185 .",
    "other intervals can be checked in a similar way ( note that @xmath186 are laplace exponents of subordinators , therefore they are positive for @xmath187 ) .",
    "next we assume that @xmath188 . using formulas ( [ compact ] ) , ( [ eq_beta_reflection ] ) and",
    "an asymptotic result = z^a+o(z^a-1 ) , z+ which can be found in @xcite , we conclude that @xmath189 has the following asymptotics as @xmath190 : ( i)&=&-12 ( ^2 + 2_1 _ 2 ) ^2+o(^1+_2 ) + & - & using the above asymptotic expansion and the same technique as in the proof of theorem 5 in @xcite we find that as @xmath191 there exists a constant @xmath192 such that _ n^+ = ( n+1+_2-_2 ) + c_1 n^_2 - 1 + o(n^_2 - 1- ) with a similar expression for @xmath193",
    ". thus we use lemma 6 from @xcite ( and the same argument as in the proofs of theorems 5 and 10 in @xcite ) to show that first there exist no other roots of meromorphic function @xmath194 except for @xmath195 , and secondly that we have a factorisation = _",
    "n1_n1 , the wiener - hopf factoris @xmath196 are identified from the above equation with the help of analytical uniqueness result , lemma 2 in @xcite . formula ( [ hypsup ] ) is obtained from the infinite product representation for @xmath197 using residue calculus .",
    "this ends the proof in the case @xmath188 , in all other cases the proof is almost identical , except that one has to do more work to obtain asymptotics for the roots of @xmath184 .",
    "we summarise all the possible asymptotics of the roots below ^+_n= ( n-_2+_2)+c n^_2+o(n^_2-)n . where the coefficients @xmath198 and @xmath199 are presented in table [ table2 ] .",
    "corresponding results for @xmath193 can be obtained by symmetry considerations .",
    "[ ht ]    .coefficients for the asymptotic expansion of @xmath200 . [ cols=\"^,^,^,^ \" , ]     similar remarks to those made after theorem [ kuz1 ] regarding the existence of atoms in the distribution of @xmath45 and @xmath99 also apply here .",
    "it is important to note that the hypergeometric lvy process is but one of many examples of lvy processes which may be constructed using vigon s theory of philanthropy . with the current monte - carlo algorithm in mind",
    ", it should be possible to engineer other favourable lvy processes in this way .",
    "the starting point for the wiener - hopf monte - carlo algorithm is the distribution of @xmath45 and @xmath47 , and in section [ sec_impl ] we have presented two large families of lvy processes for which one can compute these distributions quite efficiently .",
    "we have also argued the case that one might engineer other fit - for - purpose wiener - hopf factorisations using vigon s theory of philanthropy .",
    "however , below , we present another alternative for extending the the application of the wiener - hopf monte - carlo technique to a much larger class of lvy processes than those for which sufficient knowledge of the wiener - hopf factorisation is known .",
    "indeed the importance of theorem [ thm_cmpnd_poisson ] below is that we may now work with any lvy processes whose lvy measure can be written as a sum of a lvy measure from the @xmath100-family or hypergeometric family plus * any * other measure with finite mass .",
    "this is a very general class as a little thought reveals that many lvy processes necessarily take this form .",
    "however there are obvious exclusions from this class , for example , cases of lvy processes with bounded jumps .",
    "[ thm_cmpnd_poisson ] let @xmath201 be a sum of a lvy process @xmath3 and a compound poisson process such that for all @xmath202 , y_t = x_t+_i=1^n_t _ i where @xmath203 is a poisson process with intensity @xmath204 and @xmath205 is a sequence of i.i.d .",
    "random variables .",
    "define iteratively for @xmath37 v(n , ) & = & v(n-1,)+s^(n)_++ i^(n)_++ _ n ( 1-_n ) + j(n , ) & = & ( v(n , ) , j(n-1 , ) , v(n-1,)+ s^(n)_+ ) where @xmath42 , sequences @xmath206 and @xmath207 are defined in theorem [ thm_main ] , and @xmath208 are an i.i.d . sequence of bernoulli random variables such that @xmath209",
    ". then [ distr_identity2 ] ( y_(n , ) , _",
    "( n , ) ) ( v(t_n , ) , j(t_n , ) ) where @xmath210 .",
    "consider a poisson process with arrival rate @xmath211 such that points are independently marked with probability @xmath212 .",
    "then recall that the poisson thinning theorem tells us that the process of marked points is a poisson process with arrival rate @xmath213 .",
    "in particular , the arrival time having index @xmath214 is exponentially distributed with rate @xmath213 .",
    "suppose that @xmath215 is the first time that an arrival occurs in the process @xmath216 , in particular @xmath215 is exponentially distributed with rate @xmath204 .",
    "let @xmath217 be another independent and exponentially distributed random variable , and fix @xmath218 and @xmath219 . then making use of the wiener - hopf decomposition , @xmath220 if we momentarily set @xmath221 then by the poisson thinning theorem it follows that @xmath222 is equal in distribution to @xmath223 .",
    "moreover , again by the poisson thinning theorem , @xmath224 is equal in distribution to @xmath225 .",
    "this proves the theorem for the case @xmath226 .    in the spirit of the proof of theorem [ thm_main ] , the proof for @xmath227 can be established by an inductive argument . indeed ,",
    "if the result is true for @xmath228 then it is true for @xmath229 by taking @xmath230 then appealing to the lack of memory property , stationary and independent increments of @xmath231 and the above analysis for the case that @xmath226 .",
    "the details are left to the reader .    a particular example where the use of the above theorem is of pertinence is a linear brownian motion plus an independent compound poisson process .",
    "this would include for example the so - called kou model from mathematical finance in which the jumps of the compound poisson process have a two - sided exponential distribution . in the case that @xmath3 is a linear brownian motion the quantities @xmath45 and @xmath99 are both exponentially distributed with easily computed rates .",
    "next we consider the problem of sampling from the distribution of the three random variables @xmath232 , which is also an important problem for applications , in particular with regard to the double - sided exit problem and , in particular , for pricing double barrier options .",
    "the following slight modification of the wiener - hopf monte - carlo technique allows us to obtain two estimates for this triple of random variables , which in many cases can be used to provide upper and lower bounds for certain functionals of @xmath232 .",
    "[ thm_3d_distr ] given two sequences @xmath233 and @xmath234 introduced in theorem [ thm_main ] we define iteratively for @xmath37 [ def_5_rand_vrls ] v(n , ) & = & v(n-1,)+s^(n)_+ i^(n ) _",
    "+ j(n , ) & = & ( j(n-1 , ) , v(n-1,)+ s^(n ) _ ) + k(n , ) & = & ( k(n-1 , ) , v(n , ) ) + j(n , ) & = & ( j ( n-1 , ) , v(n , ) ) + k(n , ) & = & ( k(n-1 , ) , v(n-1,)+ i^(n ) _ ) where @xmath235 .",
    "then for any bounded function @xmath236 which is increasing in @xmath237-variable we have [ f(v(n , ) , j(n , ) , k(n , ) ) ] & & [ f(x_(n,),_(n,),_(n , ) ] [ bias-1 ] + [ f(v(n , ) , k(n , ) , j(n , ) ) ] & & [ f(x_(n,),_(n , ) , _",
    "( n , ) ] [ bias-2 ]    from theorem [ thm_main ] we know that @xmath238 has the same distribution as @xmath239 , and , for each @xmath240 , @xmath241 . the inequality in ( [ bias-1 ] ) now follows .",
    "the equality in ( [ bias-2 ] ) is the result of a similar argument where now , for each @xmath240 , @xmath242 and @xmath243 .",
    "theorem [ thm_3d_distr ] can be understood in the following sense .",
    "both triples of random variables @xmath244 and @xmath245 can be considered as estimates for @xmath246 , where in the first case @xmath247 has a positive bias and in the second case @xmath248 has a negative bias .",
    "an example of this is handled in the next section .",
    "in this section we present numerical results .",
    "we perform computations for a process @xmath22 in the @xmath100-family with parameters ( a , , _ 1,_1,_1 , c_1 , _ 2,_2,_2 , c_2 ) = ( a , , 1 , 1.5 , 1.5 , 1 , 1 , 1.5 , 1.5 , 1 ) where the linear drift @xmath249 is chosen such that @xmath250 with @xmath251 , for no other reason that this is a risk neutral setting which makes the process @xmath252 a martingale .",
    "we are interested in two parameter sets .",
    "set 1 has @xmath253 and set 2 has @xmath110 .",
    "note that both parameter sets give us proceses with jumps of infinite activity but of bounded variation , but due to the presence of gaussian component the process @xmath22 has unbounded variation in the case of parameter set 1 .    as the first example",
    "we compare computations of the joint density of @xmath254 for the parameter set 1 .",
    "our first method is based on the following fourier inversion technique . as in the proof of theorem [ thm_main ]",
    ", we use the fact that @xmath45 and @xmath54 are independent , and the latter is equal in distribution to @xmath47 , to write ( _ _ 1/ x ) ( -__1/ y ) & = & ( _ _ 1/ x , _ _",
    "1/-x__1/ y ) + & = & _ ^+ e^-t ( _ t x,_t - x_t y ) t writing down the inverse laplace transform we obtain [ eq_fourier ] ( _ t x,_t - x_t y)= _ _ 0+i ( _ _ 1/ x ) ( -__1/ y ) ^-1 e^t where @xmath255 is any positive number .",
    "the values of analytical continuation of @xmath256 for complex values of @xmath213 can be computed efficiently using technique described in @xcite .",
    "our numerical results indicate that the integral in ( [ eq_fourier ] ) can be computed very precisely , provided that we use a large number of discretization points in @xmath213 space coupled with filon - type method to compute this fourier type integral .",
    "thus first we compute the joint density of @xmath254 using ( [ eq_fourier ] ) and take it as a benchmark , which we use later to compare the wiener - hopf monte - carlo method and the classical monte - carlo approach . for both of these methods we fix the number of simulations @xmath257 and the number of time steps @xmath258 . for fair comparison",
    "we use @xmath259 time steps for the classical monte - carlo , as wiener - hopf monte - carlo method with @xmath216 time steps requires simulation of @xmath259 random variables @xmath260 .",
    "all the code was written in fortran and the computations were performed on a standard laptop ( intel core 2 duo 2.5 ghz processor and 3 gb of ram ) .",
    "figure [ fig_2d_density ] presents the results of our computations . in figure [ fig_2d_density_a ]",
    "we show our benchmark , a surface plot of the joint probability density function of @xmath254 produced using fourier method ( [ eq_fourier ] ) , which takes around 40 - 60 seconds to compute .",
    "figures [ fig_2d_density_b ] , [ fig_2d_density_c ] and [ fig_2d_density_d ] show the difference between the benchmark and the wiener - hopf monte - carlo result as the number of time steps @xmath216 increases from 20 to 50 to 100 .",
    "computations take around 7 seconds for @xmath261 , and 99% of this time is actually spent performing the monte - carlo algorithm , as the precomputations of the roots @xmath262 and the law of @xmath263 take less than one tenth of a second .",
    "figure [ fig_2d_density_e ] shows the result produced by the classical monte - carlo method with @xmath261 ( which translates into 200 random walk steps according to our previous convention ) ; this computation takes around 10 - 15 seconds since here we also need to compute the law of @xmath264 , which is done using inverse fourier transform of the characteristic function of @xmath22 given in ( [ eq1 ] ) .",
    "finally , figure [ fig_2d_density_f ] shows the difference between the monte - carlo result and our benchmark .",
    "the results illustrate that in this particular example the wiener - hopf monte - carlo technique is superior to the classical monte - carlo approach .",
    "it gives a much more precise result , it requires less computational time , is more straightforward to programme and does not suffer from some the issues that plague the monte - carlo approach , such as the atom in distribution of @xmath265 at zero , which is clearly visible in figure [ fig_2d_density_e ] .",
    "next we consider the problem of pricing up - and - out barrier call option with maturity equal to one , which is equivalent to computing the following expectation : @xmath266.\\ ] ] here @xmath267 $ ] is the initial stock price .",
    "we fix the strike price @xmath268 , the barrier level @xmath269 .",
    "the numerical results for parameter set 1 are presented in figure [ fig_barrier1 ] .",
    "figure [ fig_barrier1_a ] shows the graph of @xmath270 as a function of @xmath92 produced with fourier method similar to ( [ eq_fourier ] ) , which we again use as a benchmark .",
    "figures [ fig_barrier1_b ] , [ fig_barrier1_c ] and [ fig_barrier1_d ] show the difference between the benchmark and results produced by wiener - hopf monte - carlo ( blue solid line ) and classical monte - carlo ( red line with circles ) for @xmath271 .",
    "again we see that wiener - hopf monte - carlo method gives a better accuracy , especially when the initial stock price level @xmath92 is close to the barrier @xmath272 , as in this case monte - carlo approach produces the atom in the distribution of @xmath265 at zero which creates a large error .",
    "figure [ fig_barrier2 ] shows corresponding numerical results for parameter set 2 . in this case",
    "we have an interesting phenomenon of a discontinuity in @xmath270 at the boundary @xmath272 .",
    "the discontinuity should be there and occurs due to the fact that , for those particular parameter choices , there is irregularity of the upper half line .",
    "irregularity of the upper half line is equivalent to there being an atom at zero in the distribution of @xmath273 for any @xmath29 ( also at independent and exponentially distributed random times ) .",
    "we see from the results presented in figures [ fig_barrier1 ] and [ fig_barrier2 ] that wiener - hopf monte - carlo method correctly captures this phenomenon ; the atom at zero is produced if and only if the upper half line is irregular , while the classical monte - carlo approach always generates an atom .",
    "also , analyzing figures [ fig_barrier2_b ] , [ fig_barrier2_c ] and [ fig_barrier2_d ] we see that in this case classical monte - carlo algorithm is also doing a good job and it is hard to find a winner .",
    "this is not surprising , as in the case of parameter set 2 the process @xmath22 has bounded variation , thus the bias produced in monitoring for supremum only at discrete times is smaller than in the case of process of unbounded variation .    finally , we give an example of how one can use theorem [ thm_3d_distr ] to produce upper / lower bounds for the price of the double no - touch barrier call option @xmath274.\\ ] ] first , we use identity @xmath275 and obtain ^dnt(s ) = ^uo(s ) - e^-r .",
    "function @xmath276 is increasing in both variables @xmath277 and @xmath237 , thus using theorem [ thm_3d_distr ] we find that _ 1^dnt(s ) & = & ^uo(s ) - e^-r + _ 2^dnt(s ) & = & ^uo(s ) - e^-r are the lower / upper bounds for @xmath278 .",
    "figure [ barrier_dnt1 ] illustrates this algorithm for parameter set 1 , the other parameters being fixed at @xmath268 , @xmath279 , @xmath280 and the number of time steps @xmath281 ( 400 for the classical monte - carlo ) .",
    "we see that monte - carlo approach gives a price which is almost always larger than the upper bound produced by the wiener - hopf monte - carlo algorithm .",
    "this is not surprising , as in the case of monte - carlo approach we would have positive ( negative ) bias in the estimate of infimum ( supremum ) , and given that the payoff of the double no - touch barrier option is increasing in infimum and decreasing in supremum this amplifies the bias .",
    "aek and kvs would also like to thank alex cox for useful discussions .",
    "aek and jcp are grateful for support from epsrc grant number ep / d045460/1 . aek and kvs",
    "gratefully acknowledge support form the axa research fund , ak s research is supported by the natural sciences and engineering research council of canada .",
    "hubalek , f. and kyprianou , a.e .",
    "( 2010 ) old and new examples of scale functions for spectrally negative lvy processes . in _ sixth seminar on stochastic analysis , random fields and applications , eds r. dalang , m. dozzi , f. russo . _",
    "progress in probability , birkhuser .",
    "kyprianou , a.e . and loeffen , r. ( 2005 ) lvy processes in finance distinguished by their coarse and fine path properties . in",
    "exotic option pricing and advanced lvy models eds .",
    "a. kyprianou , w. schoutens and p. wilmott ."
  ],
  "abstract_text": [
    "<S> we develop a completely new and straightforward method for simulating the joint law of the position and running maximum at a fixed time of a general lvy process with a view to application in insurance and financial mathematics . </S>",
    "<S> although different , our method takes lessons from carr s so - called ` canadization ' technique as well as doney s method of stochastic bounds for lvy processes ; see carr @xcite and doney @xcite . </S>",
    "<S> we rely fundamentally on the wiener - hopf decomposition for lvy processes as well as taking advantage of recent developments in factorisation techniques of the latter theory due to vigon @xcite and kuznetsov @xcite . </S>",
    "<S> we illustrate our wiener - hopf monte - carlo method on a number of different processes , including a new family of lvy processes called hypergeometric lvy processes . </S>",
    "<S> moreover , we illustrate the robustness of working with a wiener - hopf decomposition with two extensions . </S>",
    "<S> the first extension shows that if one can successfully simulate for a given lvy processes then one can successfully simulate for any independent sum of the latter process and a compound poisson process . </S>",
    "<S> the second extension illustrates how one may produce a straightforward approximation for simulating the two sided exit problem .    </S>",
    "<S> key words and phrases : lvy processes , exotic option pricing , wiener - hopf factorisation .    </S>",
    "<S> msc 2000 subject classifications : 65c05 , 68u20 .    </S>",
    "<S> a. kuznetsov , a. e. kyprianou , j. c. pardo , k. van schaik </S>"
  ]
}