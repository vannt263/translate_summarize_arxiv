{
  "article_text": [
    "_ ab initio _ calculations in the framework of density functional theory(dft )  @xcite have yielded high - quality results for a large variety of systems , ranging from periodic solids to molecules and nanostructures  @xcite .",
    "these results are however mostly limited to quantities related to the electronic _ ground state _ , whereas additional phenomena that occur in the excited state are not correctly described  @xcite .",
    "it was recognized at an early stage  @xcite that in extended systems the standard approximations for dft  the local density(lda ) or generalized gradient(gga ) approximations fail to describe , among other effects , the band gap of insulators and semiconductors  @xcite .",
    "in contrast , many - body perturbation theory(mbpt )  @xcite provides , by means of the quasiparticle(qp ) concept , a more adequate and accurate approach that yields band gaps ( and band structures , in general ) in good agreement with the experimental values  @xcite .    while the first successful qp calculations were performed in the mid 80 s  @xcite , it was only in the late 90 s that many - body effects have been included in the _ ab initio _ calculation of optical properties of real materials  @xcite .",
    "it is now well known that a quantitative description of the optical response of an interacting electron system must account for electron  hole interactions ( excitonic effects )  @xcite .",
    "this is achieved by solving the bethe ",
    "salpeter(bs ) equation for the electron ",
    "hole green s function , within the mbpt framework . nowadays , solving the bs equation is the state - of - the - art approach for calculating optical properties in extended systems .",
    "the importance of including excitonic effects is clear on comparison with the experimental absorption spectra of semiconductors and insulators . in particular , for wide - gap insulators there is hardly any resemblance between the spectrum calculated within a noninteracting theory and the experiment .",
    "an alternative approach to the study of correlation in many - body systems is given by time dependent dft(tddft )  @xcite .",
    "similar to the paradigm of dft for ground - state properties , tddft has emerged as a very powerful tool for the description of excited states . in principle tddft is an exact theory for neutral excited state properties .",
    "nevertheless , in practice it has a number of commonly cited failures related to the approximation of the exchange - correlation(xc ) kernel .",
    "one example is the difficulty encountered when studying the optical properties of extended systems ; another is the severe underestimation of high - lying excitation energies in molecules . on the other hand ,",
    "the combination of tddft with simple approximations for the xc kernel ( based on the homogeneous electron gas ) has been successfully applied to the study of the optical response of molecules and nanostructures .",
    "quasiparticles , excitons and plasmons are the excitations that can be calculated using the yambo code",
    ". these excitations are ubiquitous in the _ ab initio _ description of the electronic and optical properties of any physical system .",
    "the yambo code uses as input the result of standard dft calculations obtained by means of publicly available codes  @xcite .",
    "the theoretical tools implemented in yambo are tddft and the bs equations for the response function and the dyson equation in the @xmath0 approximation for the qps .",
    "the paper is structured as follows . in section  [ sec : theo ] we introduce the most important theoretical concepts as they are utilized in yambo , before describing some of the most important numerical algorithms implemented in the code in section  [ sec : numerics ] .",
    "section  [ sec : overview ] outlines the structure and capabilities of yambo . a more detailed description of how the code is actually utilized is presented in section  [ sec : components ] , before some brief notes regarding installation in section  [ sec : install ] .",
    "finally , an illustrative example of a typical yambo  calculation is outlined in section  [ sec : lets_run_it ] .",
    "mbpt is a rigorous approach based on the green s function method , and provides a proper framework for accurately computing excited state properties . for details of the green s function formalism and many - body techniques applied to condensed matter",
    ", we refer the reader to several comprehensive papers in the literature  @xcite . here",
    "we shall just present some of the main equations used for the quasiparticle and optical spectra calculations .",
    "the basic component of a many - body perturbative expansion is the reference noninteracting system , that in yambo  is represented by the solution of the dft kohn ",
    "sham(ks ) equations . in the following",
    "we will label these single particle levels as @xmath1 , @xmath2 being the band index and @xmath3 the generic vector of the grid used to sample the brillouin zone(bz ) . in this basis",
    "the noninteracting green s function @xmath4 takes the form @xmath5 @xmath6 being the occupation factor and @xmath7 the ks energies . the basic relation between @xmath4 and the exact green s function",
    "is given by the dyson equation @xmath8}^{-1 } ,    \\label{eq : qp_dyson}\\end{aligned}\\ ] ] where the contribution due to the dft exchange - correlation potential @xmath9 is removed from the single - particle energies appearing in @xmath10 in order to prevent double counting of correlation effects induced by the self - energy @xmath11 .",
    "since the basic physical process that distinguishes a bare particle from a quasiparticle is the screening of the particle by means of the polarization of the surrounding medium , yambo uses the @xmath0 approximation for the electronic self - energy @xmath11  @xcite which is diagrammatically depicted in fig .",
    "[ fig : gw_diag ] . in this approximation",
    "the self - energy is a function of @xmath4 and of the inverse dynamical dielectric function @xmath12 , and it is composed of an exchange(x ) , and of a correlation(c ) part , @xmath13 the exchange part is simply the fock term of the hartree ",
    "fock self - energy , and it can be rewritten as @xmath14 where @xmath15 , @xmath16 are the reciprocal lattice vectors , and @xmath17 .",
    "the correlation part of the self - energy is given by @xmath18 the energy integral entering eq.([eq : qp_sig_c ] ) can be solved once the inverse dielectric function is known .",
    "the equation of motion for @xmath19 follows from that of the reducible response function @xmath20  @xcite as @xmath21 the @xmath0 approximation for the self - energy is obtained when @xmath20 is calculated within the random phase approximation(rpa )  @xcite @xmath22}^{-1 } \\chi^0_{\\gg^{''}\\gg'}{\\left(}\\qq,\\go{\\right)}. \\label{eq : dyson_for_chi}\\end{aligned}\\ ] ] the noninteracting response function is easily calculated in terms of the bare green s function @xmath23 : @xmath24}. \\label{eq : chi0}\\end{gathered}\\ ] ] as the numerical integration of @xmath19 in eq.([eq : qp_sig_c ] ) would require the inversion of eq.([eq : dyson_for_chi ] ) for many frequency points , yambo  adopts the plasmon - pole approximation(ppa ) for the gw self - energy  @xcite . in the ppa",
    "the @xmath19 function is approximated with a single pole function @xmath25 } , \\label{eq : ppa}\\end{aligned}\\ ] ] and the residuals @xmath26 and energies @xmath27 are found by imposing the ppa to reproduce the exact @xmath19 function at @xmath28 and @xmath29 , with @xmath30 being a suitable user - defined parameter .    using eq .",
    "[ eq : qp_dyson ] and assuming @xmath6 to be either @xmath31 or @xmath32 we have that : @xmath33}g_{n\\kk}{\\left(}\\go{\\right)}.    \\label{eq : d1}\\end{aligned}\\ ] ] the key approximation is now to take the first order taylor expansion of the self - energy around @xmath7 ( newton approximation ) in order to get @xmath34 } ,    \\label{eq : gqp}\\end{aligned}\\ ] ] with @xmath35 } ,    \\label{eq : qp1.a}\\\\    z_{n\\kk}={\\left[}1-\\left.\\frac{d\\sigma_{n\\kk}{\\left(}\\go{\\right)}}{d\\go}\\right|_{\\go=\\gee_{n\\kk}}{\\right]}^{-1}.    \\label{eq : qp1.b}\\end{gathered}\\ ] ] eqs .",
    "( [ eq : qp1.a][eq : qp1.b ] ) constitute the qp approximation  @xcite .",
    "it is important to note , at this stage , that by including explicitly the electronic occupations @xmath6 , yambo  can be equally applied to semiconductors , insulators and metals . in the latter case",
    ", however , the plasmon - pole approximation can be questionable when some of the valence orbitals are spatially localized ( like in _ d _ or _ f _ metals )  @xcite . nevertheless for metals in general the rpa is an excellent approximation to the calculation of optical properties , as the efficient screening occurring at the fermi surface prevents the formation of excitonic states .",
    "the evaluation of the response function @xmath20 makes it possible to calculate the macroscopic dynamical dielectric function @xmath36 and polarizability @xmath37 .",
    "in particular the _ macroscopic _ dielectric function is defined in terms of the _ microscopic _ inverse dielectric function as  @xcite @xmath38}_{\\gg=0\\,\\gg'=0 } } , \\label{eq : epsilon}\\end{aligned}\\ ] ] where @xmath39 is the matrix in the space of reciprocal vectors @xmath16 defined in eq .",
    "( [ eq : gee_m1_vs_chi ] ) .",
    "equation  ( [ eq : epsilon ] ) implies that , in general , one can not take the simple spatial macroscopic average of the dielectric function  @xcite since the charge redistribution induced by the interaction with light induces , in turn , the formation of local microscopic fields  the local field effects .",
    "such effects are particularly important in nanoscale materials where confinement induces the formation of microscopic fields that counteract the external applied perturbation  @xcite .",
    "similarly the dynamical polarizability of a zero - dimensional electronic system is defined as @xmath40 where @xmath41 is the unit cell volume .",
    "the rpa to eqs.([eq : epsilon],[eq : alpha ] ) is often inadequate to describe the electronic correlations occurring in the response function . in practical applications the rpa does not yield optical absorption spectra in good agreement with experiments for several insulating and metallic systems  @xcite .",
    "for example , in the case of sio@xmath42 , this discrepancy has led to extensive debates over the past forty years about the nature of the four well - defined peaks observed in the experiment ( see fig .  [",
    "fig : sio2 ] ) .",
    "the reason for the poor performance of the rpa is that the response function @xmath20 measures the change in the electronic density induced by the external applied potential . in a noninteracting system",
    "the rpa for @xmath20 is exact , but self - energy corrections modify the electronic density and , consequently , the rpa approximation is not valid anymore .",
    "therefore , an estimation of the importance of corrections to the rpa can be obtained by looking at the value of the gap correction .",
    "the larger the gap , the less adequate is the rpa .",
    "the gap of sio@xmath42 , indeed , is @xmath4310ev and the rpa is not even qualitatively correct .",
    "the drawbacks of the rpa are solved by using a more elaborate equation of motion for @xmath20 that takes into account the effect of electron  electron correlations .",
    "this is the bs equation  @xcite that can be introduced by using the electron ",
    "h ) green s function @xmath44 .",
    "first we note that the noninteracting @xmath45 response function , eq.([eq : chi0 ] ) , can be rewritten in terms of the noninteracting e  h green s function @xmath46 : @xmath47}l^{0}_{nn'\\kk}{\\left(}\\go{\\right)}. \\label{eq : chi0_as_l0}\\end{aligned}\\ ] ] to avoid the inversion of eq.([eq : epsilon ] ) , we define a new interacting polarization  @xcite such that @xmath48 .",
    "this function defines a corresponding e ",
    "h green s function @xmath49 : @xmath50}\\bar{l}_{\\substack{nn'\\kk\\\\mm'\\kk'}}{\\left(}\\go{\\right)}. \\label{eq : chi_as_l}\\end{aligned}\\ ] ] the bs equation is an equation for @xmath49 , obtained by performing a second iteration of hedin s equation  @xcite @xmath51}. \\label{eq : bse}\\end{aligned}\\ ] ] the bs equation naturally takes into account the electron  hole interaction in the response function as shown schematically in fig .  [",
    "fig : bs_diag ] .",
    "the matrix @xmath52 is the kernel of the bs equation composed of a direct electron ",
    "electron scattering term ( @xmath53 ) plus an exchange interaction ( @xmath54 ) . both @xmath53 and @xmath54",
    "are integrals of bloch functions @xmath55 it is important to observe that the bs equation is a dyson - like equation that should be inverted at each frequency point .",
    "the dimension of the @xmath49 matrix can be , however , quite large and the inversion of eq.([eq : bse ] ) practically impossible .",
    "however , for systems with a gap and at zero temperature the noninteracting e  h green s function can be rewritten as @xmath56}=i\\frac{f_{n'\\kk}-f_{n\\kk}}{\\go - \\gee_{n\\kk}+\\gee_{n'\\kk}}. \\label{eq : real_lo}\\end{aligned}\\ ] ] as a consequence it can be shown  @xcite that the bs equation can be reduced to an eigenvalue problem of the hamiltonian @xmath57 , @xmath58}. \\label{eq : bse_h}\\end{aligned}\\ ] ] the hamiltonian in eq .",
    "( [ eq : bse_h ] ) is in general non - hermitian .",
    "nevertheless yambo  adopts the standard tamm ",
    "dancoff approximation  @xcite , in which only e  h pairs at positive energy are considered and the hamiltonian @xmath57 is hermitian .",
    "finally the dielectric function can be expressed in terms of the eigenstates @xmath59 and eigenvalues @xmath60 of @xmath57 : @xmath61 with @xmath62 being the eigenvectors of @xmath57 .    in the case of semiconductors",
    "the bs approach induces only a minor modification of the absorption spectrum . for wide - gap insulators , instead",
    ", the energies @xmath60 may fall within the single particle gap . in this case",
    "the eigenstates of the bs equation are called bound excitons  @xcite .",
    "a typical example is shown in fig .  [",
    "fig : sio2 ] for the case of solid sio@xmath42  @xcite .",
    "time - dependent density functional theory(tddft )  @xcite is gaining increasing popularity as an efficient tool for calculating electronic excitations in finite systems , thanks to its simplicity and moderate computational cost .",
    "in tddft the _ exact _ polarization function satisfies a dyson - like equation that reads @xmath63}\\chi_{\\gg^{''}\\gg'}{\\left(}\\qq,\\go{\\right)}. \\label{eq : tddft_for_chi}\\end{aligned}\\ ] ] eq.([eq : tddft_for_chi ] ) is similar to eq.([eq : dyson_for_chi ] ) with an important addition , the xc kernel @xmath64 that accounts for the exchange and correlation effects .",
    "the exact form of the xc kernel is unknown , but the tddft success relies also in the fact that even using the simplest adiabatic local density approximation(alda ) for @xmath64 a good accuracy in the evaluation of optical properties can be obtained  @xcite .",
    "we would like to mention here some common limitations of eq.([eq : tddft_for_chi ] ) , associated with the use of plane - waves , when applied to low - dimensional electronic systems . as yambo  is a plane - wave code , it uses the super - cell approach to study small systems like molecules and nanoscale materials .",
    "this approach usually leads to two types of problems .",
    "the first of these is the possibility of fictitious interactions between super - cell replicas ( images ) . to treat this problem",
    ", yambo  is capable of removing the long - range tail of coulomb potentials following the method described in ref.@xcite .",
    "the second problem derives from the numerical instability of eq.([eq : tddft_for_chi ] ) that is induced by the presence of large regions of space with vanishing density , as occurs in large supercells ( see inset of fig .  [",
    "fig : alda ] ) .",
    "unfortunately , this vanishing density induces some complications to eq.([eq : tddft_for_chi ] ) when @xmath64 is evaluated at the alda level .",
    "indeed , the alda kernel is defined by : @xmath65 where @xmath66 is the exchange and correlation potential of the homogeneous electron gas . in the region of space with vanishing density",
    "we have that @xmath67 so that the evaluation of the term involving the @xmath64 in eq .",
    "( [ eq : tddft_for_chi ] ) can not be directly calculated in reciprocal space , because the @xmath68 is not well defined .    to overcome this problem yambo",
    "can solve the tddft equation within the alda in the basis of the e ",
    "h pairs , instead of in reciprocal space [ eq .  ( [ eq : tddft_for_chi ] ) ] . in this case",
    "the tddft equation has the same form of the bs equation , eq .",
    "( [ eq : bse ] ) , with the kernel @xmath69 given by @xmath70 with @xmath71 in fig .",
    "[ fig : alda ] we show , as an example , the alda dynamical polarizability along the _ x_-axis of the ethylene molecule . the yambo  result is compared with a calculation made with the code octopus@xcite where all the quantities are defined in real - space , and the results",
    "are not affected by the presence of regions with zero density and of images due to the super - cell approach .",
    "we can see that yambo  well reproduces the main excitation peak at 7.5  ev , that is composed by bound ( localized ) electron - hole states@xcite .",
    "the yambo  code has been applied to a wide range of materials , from bulk compounds to molecules and nanostructures . as a consequence we have developed several _",
    "ad hoc _ methods specifically designed to solve physical and numerical problems that can be commonly encountered .",
    "the definition of the self - energy operator  and of many other quantities  requires an integration in the bz . in practice",
    "this integral is replaced by some suitable grid of points .",
    "let s consider for simplicity only the hartree ",
    "fock self - energy , given by eq.([eq : qp_sig_x ] ) . using a finite grid of transferred momenta @xmath72",
    "it reads @xmath73 in approximating @xmath74 using a finite grid the key assumption is that the integrand of eq.([eq : qp_sig_x ] ) must be a smooth function of @xmath72 .",
    "while this is generally true for the oscillators @xmath75 part , this is not so trivial for the coulomb potential that , indeed , diverges for @xmath76 .",
    "nevertheless , in three - dimensional systems this divergence is not affecting the calculation .",
    "in fact , the phase space volume associated with the @xmath77 point reduces as @xmath78 when @xmath76 and the divergence is _ de facto _ removed . in low - dimensional systems this cancellation holds only if a three - dimensional grid is used . when the brillouin zone is sampled with lower - dimensional grid instability problems",
    "appear in the evaluation of the coulomb integral . as shown in the right panel of fig .",
    "[ fig : rim ] , these instabilities may even grow as a function of the brillouin zone sampling size . on the other hand using a three - dimensional grid",
    "is clearly inconvenient , and more importantly can make the calculations extremely cumbersome .    in order to avoid the use of a three - dimensional sampling in low - dimensional systems yambo  offers two methods to remove the divergence arising from the coulomb integrals .",
    "the first is based on a cutoff coulomb technique which is discussed in detail in ref.@xcite .",
    "the other is the so - called _ random integration method_(rim )  @xcite . in the rim",
    "the hf self - energy is rewritten as @xmath79 the integral of the coulomb potential @xmath80 is evaluated in a region @xmath81 around the @xmath77 point . representing as @xmath82 the region @xmath81 translated in the general @xmath72 position , this region",
    "is chosen in such a way that @xmath83 .",
    "the rim is based again on the uniformity _ ansatz _ described above , but restricted only to the @xmath84 factors .",
    "the @xmath85 integrals are calculated via a three dimensional monte carlo technique  @xcite .    for practical purpose ,",
    "it is necessary to evaluate only @xmath86 because far from the origin the approximation leading to eq .",
    "( [ eq : rim_1 ] ) is still accurate as shown in the right panel of fig .",
    "[ fig : rim ] .",
    "the importance of the rim is exemplified in the left panel of fig .",
    "( [ fig : rim ] ) where we show the convergence of @xmath87 with respect to the @xmath3-point sampling at the @xmath88 point of a quasi one - dimensional _",
    "trans_-polyacetylene polymer .      once the bs ( or the tddft ) hamiltonian @xmath57 [ eq .  ( [ eq : bse_h ] ) ] has been calculated in the basis of e  h pairs @xmath89 , yambo  offers two options for calculating the corresponding macroscopic dielectric function @xmath90 and related quantities ( optical absorption , electron loss and dynamical polarizability ) : either via the diagonalization , or via the lanczos ",
    "haydock ( lh ) recursion method  @xcite . with the first option the program diagonalizes @xmath57 using the standard blas / lapack routines  @xcite to find the eigenvalues @xmath91 and",
    "eigenstates @xmath92 that define the macroscopic dielectric function , eq.([eq : bse_epsilon ] ) . with the second option eq .",
    "( [ eq : bse_epsilon ] ) is rewritten as , @xmath93 where @xmath94 .",
    "then eq .",
    "( [ eq : epsm02 ] ) is calculated using the lh method  @xcite , a general algorithm to compute the matrix elements of the green s function @xmath95 applied for the first time to solve the bs equation by benedict and coworkers  @xcite .",
    "the lh algorithm recursively builds an orthonormal basis @xmath96 ( lanczos basis ) in which @xmath57 is represented as a real symmetric tridiagonal matrix , @xmath97 the first vector @xmath98 of the lanczos basis is set equal to @xmath99 .",
    "the next vectors are calculated from the three - term relation @xmath100 in the lanczos basis eq .",
    "( [ eq : epsm02 ] ) becomes @xmath101 at each iteration the program computes a new vector @xmath102 [ eq .  ( [ eq : lnczos ] ) ] , the matrix elements @xmath103 , @xmath104 , and thus a better approximation @xmath105 for @xmath36 from eq .  ( [ eq : cntfrc ] ) . the lh iteration procedure stops when the difference @xmath106 in the given range of frequencies is smaller than a user - defined threshold .    in practice when interested in a finite range of frequencies one needs a number of iterations @xmath107 much smaller than the dimension @xmath108 of the hamiltonian ( corresponding to number of e  h pairs included in eq .",
    "[ eq : bse_h ] ) to get an accurate @xmath90 . in the left panel of fig .",
    "[ fig : lhtime ] this is exemplified for the dynamical polarizability calculated within the alda of the _ trans_-azobenzene molecule : @xmath109 is enough for getting an accurate spectrum up to 6 ev , with @xmath110 . as a consequence ,",
    "the lh method [ @xmath111 floating point operations ] is usually much faster than the diagonalization procedure [ @xmath112 floating point operations ] .",
    "this is clearly shown in the right panel of fig .",
    "[ fig : lhtime ] : already for @xmath113 the lh method starts to be more convenient , and for @xmath110 it is about 70 times faster than the diagonalization procedure .",
    "the lh method is also more convenient in terms of memory since , in contrast with the diagonalization , only three vectors at a time need to be stored .",
    "furthermore , the whole procedure has been efficiently parallelized in yambo .",
    "the lh algorithm is , therefore , the recommended method in yambofor the computation of the macroscopic dielectric function and related quantities , while the diagonalization should be used when the eigenvalues and eigenvectors of @xmath57 are explicitly needed , as for example for plotting the excitonic wavefunction via the post - processing tool ypp .",
    "the structure of the yambo  package can be separated into a number of stages , schematically depicted in fig .",
    "[ fig : flowchart ] . in the preliminary stage ( i )",
    ", a c / fortran90 driver passes control to the main yambo  executable , or to the data converters ( a2y , p2y , e2y ) .",
    "the purpose of the latter is to generate the core _",
    "databases _ that contain the ground state data necessary for starting the code . a mostly procedural data initialization stage ( ii )",
    "follows , where some general - purpose databases are prepared for later use .",
    "the main physical calculations are performed in the third stage ( iii ) .",
    "finally , databases created by yambo  can be further manipulated using the post - processing tool ypp  in a fourth stage ( iv ) .",
    "operation of the code follows a series of functionally distinct _",
    "runlevels_. the main runlevels are activated by the user via the command - line interface ( described in more detail in sec .",
    "[ sec : cli ] ) , and others are called automatically by the code where dependencies are present .",
    "runlevels have a modular structure , in the sense that each one performs specific physical tasks and terminates ( in most cases ) with the creation of one or several databases written onto disk .",
    "these database files may then be accessed by different runlevels .",
    "runlevels may be skipped in subsequent runs if a database is found that is compatible with the user requirements on execution .",
    "a more thorough discussion of the databases , and the yambo  i / o in general , can be found in sec .",
    "[ sec : io ] .",
    "the main runlevels are now described in more detail .",
    "+ stage i :    1 .",
    "c driver : governs the actions taken by the rest of the code .",
    "yambo  uses a standard getopt function  @xcite to parse the command line .",
    "this function is called by all executables to acquire the user - defined options passed at the command line .",
    "the syntax is described briefly in sec .",
    "[ sec : cli ] .",
    "2 .   data import / converter : the ground - state electronic structure of the system to be studied is imported from ground state codes ( see sec .",
    "[ sec : executables ] ) , and converted into the core database files .",
    "stage ii :    1 .",
    "user input : if command line options were added in stage i , the executable acts as an input file generator . on execution , the code reads default values for input parameters from existing databases and updates the values in the input file , after which the code terminates .",
    "data initialization : reorders @xmath16-vectors into spherical shells , calculates fermi level and electronic occupations , sets up energy grids .",
    "brillouin - zone sampling : expands @xmath3-points to full bz , generates @xmath72-point meshes , checks on uniformity of grids .",
    "stage iii :    1 .",
    "hartree - fock / vxc : calculates the matrix elements of the hartree - fock exchange self - energy and of the dft potential corresponding to the type of functional used in the ground state code run .",
    "screening : calculates static and dynamical inverse dielectric functions , for use in the evaluation of the gw self - energy and of the bs / tddft kernel .",
    "quasiparticle : calculates quasiparticle corrections to the kohn  sham band structure within the gw approximation .",
    "linear response : optical properties within rpa and alda with and without local field effects .",
    "bethe  salpeter / tddft : creation of the bs / tddft hamiltonian and subsequent diagonalization using lapack routines or via lanczos ",
    "haydock iterative procedure .",
    "stage iv :    1 .",
    "post - processing : contains routines for creating @xmath3-point grids , analyzing single - particle and excitonic wavefunctions and plotting the electronic wavefunctions and density .",
    "as described earlier , the yambo  package is in fact composed of three separate utilities .",
    "the first of these is the set of converters ( a2y , p2y  and e2y ) which generate the yambo  core databases from the output of other ground state codes .",
    "the a2y  converter imports data from the so - called ` kss ` file as generated by the abinit code@xcite , while p2y  imports data written by the quantum - espresso / pwscf@xcite code in the ` iotk ` file format@xcite .",
    "alternatively , e2y  can be used to import data from a netcdf formatted file written according to the etsf file - format specifications@xcite . as a set of high - level libraries are available@xcite that are capable of reading and writing this format , it is relatively easy to interface yambo  with other ground state codes .",
    "the main computation tool is the yambo  executable itself .",
    "depending on the command line options used ( see next section ) , it can act either as an input file generator or as a straightforward serial or parallel executable .",
    "the last utility is the ypp  post - processor , which is generally used to perform short analysis of pre - calculated databases .",
    "thanks to the c / fortran driver routine , yambo  offers a very user - friendly command - line interface for configuring the code at run - time and for creating and editing the main input file",
    ". an extended list of options can be displayed by using the ` -h ` option ( see table  [ tab : synopsis ] ) .",
    "yambo  options can be lowercase and uppercase .",
    "upper case options may be added at run - time to specify input / output directories ( ` -i/-o ` , see next section ) , skip the mpi calls ( ` -n ` ) , create a simple report of the existing database properties ( ` -d ` ) , and so on .",
    "for instance , running    ....    yambo -n -i /scratch / tests / silicon - bulk -d ....    will ask for a report of databases in the ` /scratch / tests / silicon - bulk ` directory , and force the parallel - compiled executable to run in serial .",
    "lower case options , instead , drive the input file editor .",
    "for example ,    ....    yambo -i -o c -i ~/tests / silicon - bulk ....    will generate an input file ( the default being ` yambo.in ` ) that can be used to run the initialization steps ( ` -i ` ) and calculate linear response optics at the rpa level ( ` -o c ` ) .",
    "a useful feature of the code is that default values for parameters are suggested based on their values in the most relevant database , if a value is not already present in the input file .",
    "hence if 500 bands are written in the core databases , yambo  will suggest a range of 1500 bands for calculating the noninteracting response function .",
    "since yambo  offers a huge range of tunable parameters , some of which are quite technical , it would be quite daunting for an average user to face the full list of parameters when running the code .",
    "hence , an input - file verbosity flag ( -v ) lets the user decide how detailed the input file is to appear ( the remaining parameters are set to their default values ) . after checking the existing databases and input files ,",
    "yambo  invoked in this way will redirect the user to edit the newly - created ` yambo.in ` file .",
    "the c parser used by yambo  to process the input files is taken from the octopus  @xcite code .    .",
    "[ tab : synopsis ] [ cols= \" < , < , < , < , < , < \" , ]     note that , by reading the databases generated in the setup run , yambo  already knows that there are 19 momenta permitted by the bz sampling , and that 50 bands were calculated in the preceding ground - state run . to perform a test calculation we change some of the values in the input .    * in eq.([eq : chi_as_l ] ) , we restrict the summation from band @xmath114 to band @xmath115 : + .... % bsebands     2 |   6 |                  # [ bsk ] bands range % .... * in the statically screened interaction we use just @xmath116 rl vectors : + .... bsengblk= 51              rl   # [ bsk ] screened interaction block size ngsblkxs= 51              rl   # [ xs ] response block size .... * as the lh method is very fast we increase the number of points on the frequency axis by setting bensteps=1000 .",
    "moreover , to mimic the experimental width of the e@xmath117 and e@xmath42 peaks , we set + .... % bdmrange    0.02000 |   0.8000 |    ev   # [ bss ] damping range % ....    calling yambo  again , without command line options , will start the calculation , which should last for some minutes .",
    "the progress of the calculation ( including expected / elapsed time for each time - consuming operation ) can be followed from the standard output , or in case of background execution , read from the l_optics_bse_em1s_bss log file .    at the end of the run",
    "several new files appear in the save folder : the dielectric function ndb.em1s , the bs hamiltonian matrix ndb.bs_q1 , and the information needed to restart the lh iterative procedure in ndb.haydock_restart .",
    "furthermore , the run generates two files in the working directory , the report file ( r_optics_bse_em1s_bss ) and the output file ( o.eps_q001-bh ) .",
    "the output file contains the calculated spectra ( bs and rpa spectra ) that can be visualized without further processing with standard plotting tools . plotting the second versus the first column of the o.eps_q001-bh file gives the well - known absorption spectrum of bulk silicon within bse .",
    "the result of the run is shown in fig .",
    "[ fig : bulk_si ] , where it is compared with the independent particle ( rpa ) spectrum ( fourth versus the first column of the same file ) , with the experimental spectrum  @xcite ( included in the doc / sample / bulk_silicon / experiment.dat file ) and with the result of a more converged calculation  @xcite .",
    "the noninteracting response function @xmath118 is a key ingredient of the yambo  code .",
    "it enters , for example , in the definition of the rpa dielectric function and of the gw self - energy .",
    "nevertheless the practical evaluation of @xmath119 is often a bottleneck in realistic calculations .",
    "the reason is that , as shown in eq.([eq : chi0 ] ) , @xmath119 contains a triple summation over the @xmath3 points and the occupied and empty electronic levels . for systems with a large number of electrons",
    "this summation can easily reach millions of elements , that must be multiplied by the number of frequencies .    to provide a tunable and efficient tool to reduce the numerical effort in evaluating @xmath119 yambo",
    "follows the general idea of the algorithm proposed by miyake  @xcite to rewrite @xmath119 as @xmath120}f_p { \\left[}\\frac{1}{\\go+e_p+i0^+}- \\frac{1}{\\go - e_p - i0^+}{\\right]}. \\label{eq : chi0_coarse}\\end{aligned}\\ ] ] in eq .",
    "( [ eq : chi0_coarse ] ) the @xmath121 are groups of e  h indexes ( @xmath122 ) with similar e ",
    "h energies @xmath123 .",
    "the latter are approximated with a single pole at @xmath124 with occupation @xmath125 .",
    "the number of groups created can be controlled by the user by tuning the cgrdsp variable in the input file .",
    "the important difference with eq.([eq : chi0 ] ) is that , in eq.([eq : chi0_coarse ] ) the evaluation of the oscillators is partially decoupled from the energy dependence . as a consequence by decreasing the groups of e  h pairs it is possible to make the evaluation of @xmath118 almost independent on the number of frequencies .",
    "the oscillators @xmath126 appear in almost all the quantities calculated in yambo .",
    "they are evaluated using efficient fast fourier techniques(fft )  @xcite . nevertheless yambo  uses symmetry arguments to reduce the number of calls to the fft interface .",
    "if we specify the symmetry operation by rewriting a general point in the bz as @xmath127 , with @xmath128 defined in the irreducible wedge of the bz , eq.([eq : bse_syms_1 ] ) reads @xmath129}e^{i{\\left(}\\qq+\\gg{\\right)}\\cdot \\rr }   { \\left[}e^{ir'{\\left(}\\kk-\\qq{\\right)}_{ibz}-i\\gg_0\\cdot\\rr}u^*_{mr'{\\left(}\\kk-\\qq{\\right)}_{ibz}}{\\left(}\\rr{\\right)}{\\right]},\\end{aligned}\\ ] ] with @xmath130 defined as @xmath131 .",
    "hence we find that @xmath132 in case of spatial symmetries ( a similar procedure applies to the time - reversal symmetry ) we can rewrite the left side rotated wavefunction as @xmath133 , so that @xmath134 finally we notice that the symmetries constitute a group , and , consequently , @xmath135 , with @xmath136 a symmetry operation .",
    "thus , at difference with eq.([eq : bse_syms_1 ] ) , eq.([eq : bse_syms_4 ] ) depends only on one symmetry index . by using eq.([eq : bse_syms_4 ] ) the computational cost of calculating all the oscillators at a given @xmath3 point is reduced by the number of symmetries in the star of @xmath3 .",
    "this work was partially supported by the fp6 european network of excellence nanoquanta ( nmp4-ct-2004 - 500198 ) .",
    "we acknowledge grant support for code development and testing from the cineca ( account ` cne2fm2h ` ) and caspur supercomputing centres .",
    "we would like to thank rodolfo del sole and angel rubio for their active and continuing support towards the development of the code , both as yambo  and during the time the code was known as self .",
    "we would also like to thank the people that have contributed in some way to the development of the code : c. attaccalite , m. palummo , m. gatti , f. de fausti , m. bockstedte , l. wirtz , g. onida , x. gonze .",
    "is a community project for high - quality quantum - simulation software , based on density - functional theory , and coordinated by paolo giannozzi .",
    "see ` http://www.quantum-espresso.org ` and ` http://www.pwscf.org ` .",
    "x. gonze , j. m. beuken , r. caracas , f. detraux , m. fuchs , g. m. rignanese , l. sindic , m. verstraete , g. zerah , f. jollet , m. torrent , a. roy , m. mikami , ph .",
    "ghosez , j. y. raty and d. c. allan , comp . mat .",
    "sci . * 25 * , 478 ( 2002 ) .",
    "l. hedin , phys . rev . * 139 * , a796 ( 1965 ) ; j. phys . : condens .",
    "matter * 11 * , r489 , ( 1999 ) ; l. hedin , and s. lundqvist , 1969 , in _ solid state physics _",
    ", edited by h. ehrenreich , f. seitz and d. turnbull ( academic , new york ) , vol .  23 , p.  1 .      a. marini , r. del sole and g. onida , phys . rev .",
    "b * 66 * , 115101 ( 2002 ) ; a. marini , g. onida and r. del sole , phys .",
    ", * 88 * , 016403 ( 2002 ) ; a. marini , g. onida and r. del sole , phys . rev",
    ". b , * 64 * , 195125 ( 2001 ) .                    the high energy peaks appearing in fig .  [ fig : alda ]",
    "correspond to the excitation of unlocalized orbitals whose different description in the yambo  and octopus codes leads to the discrepancies observed in the figure .",
    "nevertheless , these differences can be systematically removed by increasing the dimension of the basis size .                    `",
    "iotk ` : input - output toolkit ` http://www.s3.infm.it/iotk/ ` written by giovanni bussi ( ethz and s@xmath137 modena ) . for processing the xml formatted `",
    "iotk ` data , yambo  makes use of the high - level wrapper routines available in the ` qexml.f90 ` module written by andrea ferretti ( s@xmath137 modena ) .",
    "netcdf ( network common data form ) is a set of software libraries to support the creation , access , and sharing of array - oriented scientific data .",
    "the key property of the netcdf databases is that they are platform - independent . for more information visit",
    "http://www.unidata.ucar.edu / software / netcdf/.          the sample run of the excitonic optical properties of bulk silicon described in sec .",
    "[ sec : lets_run_it ] is introduced to briefly illustrate the steps needed to run yambo and , more importantly , is conceived to run in a few seconds on a typical pc .",
    "this sample run is not supposed to represent a realistic calculation because of the limited sampling of the bz and because of the use of too few empty bands to perform a converged @xmath0 calculation .",
    "the more converged bse spectrum shown in fig .",
    "[ fig : bulk_si ] uses @xmath138 points in the irreducible(reducible ) wedge of the bz ( which corresponds to a @xmath139 monkorst - pack(mp )  @xcite grid ) .",
    "the @xmath0 qp gap is calculated on the same @xmath139 mp grid but shifted to the origin in such a way as to contain the @xmath77 point .",
    "the @xmath0 gap obtained with yambo  is @xmath140ev , in excellent agreement with the experimental value of @xmath141  @xcite .",
    "we have used a @xmath142 plasmon - pole dielectric function @xmath143 which includes up to @xmath144 bands .",
    "@xmath145 bands , instead , have been included in eq .",
    "(  [ eq : qp_sig_c ] ) .",
    "these converged bse and qp calculations require a total cpu - time of the order of @xmath4324 hours .",
    "interested users can download the relevant input files for these more converged calculations directly from the yambo  web site ` http://www.yambo-code.org/publications.html ` ."
  ],
  "abstract_text": [
    "<S> yambo  is an _ ab initio _ </S>",
    "<S> code for calculating quasiparticle energies and optical properties of electronic systems within the framework of many - body perturbation theory and time - dependent density functional theory . </S>",
    "<S> quasiparticle energies are calculated within the @xmath0 approximation for the self - energy . </S>",
    "<S> optical properties are evaluated either by solving the bethe  </S>",
    "<S> salpeter equation or by using the adiabatic local density approximation . </S>",
    "<S> yambo  is a plane - wave code that , although particularly suited for calculations of periodic bulk systems , has been applied to a large variety of physical systems . </S>",
    "<S> yambo  relies on efficient numerical techniques devised to treat systems with reduced dimensionality , or with a large number of degrees of freedom . </S>",
    "<S> the code has a user - friendly command - line based interface , flexible i / o procedures and is interfaced to several publicly available density functional ground - state codes .    </S>",
    "<S> pacs : 71.35.-y , 71.15.-m , 71.45.gm , 71.15.qe    electronic structure ; optical properties ; excitons ; quasiparticles ;    ,    ,    , and    * program summary * +    _ program title : _ yambo +   + _ journal reference : _ +   + _ catalogue identifier : _ +   + _ program obtainable from : _ http://www.yambo-code.org +   + _ </S>",
    "<S> licensing provisions : _ this program is distributed under the gnu general public license v2.0 ( see http://www.gnu.org/ for details ) +   + _ programming language : _ fortran 95 , c +   + _ computer(s ) for which the program has been designed : _ any computer architecture , running any flavor of unix +   + _ operating system(s ) under which the program has been tested : _ gnu / linux , aix , irix , os / x +   + _ ram required to execute program with typical data : _ 101000 mbytes +   + _ number of processors used : _ up to 100 +   + _ supplementary material : _ </S>",
    "<S> manuals , tutorials , background theory and sample input files are available for download or inspection from the website http://www.yambo-code.org +   + _ keywords : _ many - body perturbation theory , density functional theory , time - dependent density functional theory , self - energy , bethe - salpeter equation , excitons , quasiparticles , plasmons +   + _ pacs : _ </S>",
    "<S> 71.35.-y , 71.15.-m , 71.45.gm , 71.15.qe +   + _ classification : _ 7.3 electronic structure , 4.4 feynman diagrams , 7.2 electron spectroscopies , 18 optics +   + _ external routines / libraries : _    * blas ( http://www.netlib.org/blas/ ) * lapack ( http://www.netlib.org/lapack/ ) * mpi ( www-unix.mcs.anl.gov/mpi/ ) is optional . * </S>",
    "<S> blacs ( http://www.netlib.org/scalapack/ ) is optional . </S>",
    "<S> * scalapack ( http://www.netlib.org/scalapack/ ) is optional . </S>",
    "<S> * fftw ( http://www.fftw.org/ ) is optional . </S>",
    "<S> * netcdf ( www.unidata.ucar.edu/software/netcdf/ ) is optional .    </S>",
    "<S> _ nature of problem : _ + calculation of excited state properties ( quasiparticles , excitons , plasmons ) from first principles . </S>",
    "<S> +   + _ solution method : _ + many body perturbation theory ( dyson equation , bethe  salpeter equation ) and time - dependent density functional theory . </S>",
    "<S> quasiparticle approximation . </S>",
    "<S> plasmon - pole model for the dielectric screening . </S>",
    "<S> plane  wave basis set with norm conserving pseudopotentials . </S>",
    "<S> +   + _ unusual features : _ </S>",
    "<S> + during execution , yambo  supplies estimates of the elapsed and remaining time for completion of each runlevel . very friendly </S>",
    "<S> shell - based user - interface . +   + _ additional comments : _ </S>",
    "<S> + yambo  was known as `` self '' prior to gpl release . </S>",
    "<S> it belongs to the suite of codes maintained and used by the european theoretical spectroscopy facility(etsf )  @xcite +   + _ running time : _ + the typical yambo running time can range from a few minutes to some days depending on the chosen level of approximation , and on the property and physical system under study . </S>",
    "<S> +   +    * long write - up * </S>"
  ]
}