{
  "article_text": [
    "malvenuto  @xcite introduced the hopf algebra @xmath0 of permutations , which has a linear basis @xmath1 indexed by permutations in all symmetric groups @xmath2 .",
    "the hopf algebra @xmath0 is non - commutative , non - cocommutative , self - dual , and graded . among its sub- , quotient- , and subquotient-",
    "hopf algebras are many algebras central to algebraic combinatorics .",
    "these include the algebra of symmetric functions  @xcite , gessel s algebra @xmath3 of quasi - symmetric functions  @xcite , the algebra of non - commutative symmetric functions  @xcite , the loday - ronco algebra of planar binary trees  @xcite , stembridge s algebra of peaks  @xcite , the billera - liu algebra of eulerian enumeration  @xcite , and others .",
    "the structure of these combinatorial hopf algebras with respect to certain distinguished bases has been an important theme in algebraic combinatorics , with applications to the combinatorial problems these algebras were created to study .",
    "here , we obtain a detailed understanding of the structure of @xmath0 , both in algebraic and combinatorial terms .",
    "our main tool is a new basis @xmath4 for @xmath0 related to the original basis by mbius inversion on the weak order on the symmetric groups .",
    "these bases @xmath5 and @xmath6 are analogous to the monomial basis and the fundamental basis of @xmath3 , which are related via mbius inversion on their index sets , the boolean posets @xmath7 .",
    "we refer to them as the monomial basis and the fundamental basis of @xmath0 .",
    "we give enumerative - combinatorial descriptions of the product , coproduct , and antipode of @xmath0 with respect to the monomial basis @xmath5 . in section 3",
    ", we show that the coproduct is obtained by splitting a permutation at certain special positions that we call global descents .",
    "descents and global descents are left adjoint and right adjoint to a natural map @xmath8 .",
    "these results rely on some non - trivial properties of the weak order developed in section  [ s : bruhat ] .",
    "the product is studied in section  [ s : product ] .",
    "the structure constants are non - negative integers with the following geometric - combinatorial description .",
    "the 1-skeleton of the permutahedron @xmath9 is the hasse diagram of the weak order on @xmath2 .",
    "the facets of the permutahedron are canonically isomorphic to products of lower dimensional permutahedra .",
    "say that a facet isomorphic to @xmath10 has type @xmath11 .",
    "given @xmath12 and @xmath13 , such a facet has a distinguished vertex corresponding to @xmath14 under the canonical isomorphism .",
    "then , for @xmath15 , the coefficient of @xmath16 in @xmath17 is the number of facets of the permutahedron @xmath18 of type @xmath11 with the property that the distinguished vertex is below @xmath19 ( in the weak order ) and closer to @xmath19 than any other vertex in the facet .    in section  [ s : antipode ]",
    "we find explicit formulas for the antipode with respect to both bases .",
    "the structure constants with respect to the monomial basis have constant sign , as for @xmath3 .",
    "the situation is more complicated for the fundamental basis , which may explain why no such explicit formulas were previously known .    elucidating the elementary structure of @xmath0 with respect to the monomial basis reveals further algebraic structures of @xmath0 . in section  [ s : cofree ] , we show that @xmath0 is a cofree graded coalgebra .",
    "a consequence is that its coradical filtration ( a filtration encapsulating the complexity of iterated coproducts ) is the algebraic counterpart of a filtration of the symmetric groups by certain lower order ideals . in particular , we show that the space of primitive elements is spanned by the set @xmath20 .",
    "cofreenes was shown by poirier and reutenauer  @xcite in dual form , through the introduction of a different basis .",
    "the study of primitive elements was pursued from this point of view by duchamp , hivert , and thibon  @xcite .",
    "the generating function for the graded space of primitive elements is @xmath21 comtet essentially studied the combinatorics of global descents  ( * ? ? ?",
    "* exercise vi.14 ) .",
    "these results add an algebraic perspective to the pure combinatorics he studied .",
    "there is a well - known morphism of hopf algebras @xmath22 that maps one fundamental basis onto the other , by associating to a permutation @xmath23 its descent set @xmath24 . in section  [ s : descentmap ]",
    ", we describe this map on the monomial bases and then derive a new geometric description for the product of monomial quasi - symmetric functions in which the role of the permutahedron is played by the cube .    in section  [ s : crossed ]",
    "we show that @xmath0 decomposes as a crossed product over @xmath3 .",
    "this construction from the theory of hopf algebras is a generalization of the notion of group extensions .",
    "we provide a combinatorial description for the hopf kernel of the map @xmath22 , which is a subalgebra of @xmath0 .",
    "we study the self - duality of @xmath0 in section  [ s : duality ] and its enumerative consequences .",
    "for instance , a result of foata and schtzenberger  @xcite on the numbers @xmath25 follows directly from this self - duality and we obtain analogous results for the numbers @xmath26 most of the order - theoretic properties that underlie these algebraic results are presented in section  [ s : bruhat ] .",
    "central to these are the existence of two galois connections ( involving descents and global descents ) between the posets of permutations of @xmath27 $ ] and of subsets of @xmath28 $ ] , as well as the order properties of the decomposition of @xmath2 into cosets of @xmath29 .",
    "we thank swapneel mahajan , who suggested a simplification to the proof of theorem  [ t : cop - monomial ] , nantel bergeron , one of whose questions motivated the results of section  [ s : crossed ] , and the referees of an abridged version for helpful comments .",
    "we use only elementary properties of hopf algebras , as given in the book  @xcite .",
    "our hopf algebras @xmath30 will be graded connected hopf algebras over @xmath31 .",
    "thus the @xmath31-algebra @xmath30 is the direct sum @xmath32 of its homogeneous components @xmath33 , with @xmath34 , the product and coproduct respect the grading , and the counit is projection onto @xmath35 .    throughout , @xmath36 is a non - negative integer and @xmath27 $ ] denotes the set @xmath37 . a _ composition _",
    "@xmath38 of @xmath36 is a sequence @xmath39 of positive integers with @xmath40 . to a composition @xmath38 of @xmath36",
    ", we associate the set @xmath41 .",
    "this gives a bijection between compositions of @xmath36 and subsets of @xmath28 $ ] .",
    "compositions of @xmath36 are partially ordered by _",
    "refinement_. the cover relations are of the form @xmath42 under the association @xmath43 , refinement corresponds to set inclusion , so we simply identify the poset of compositions with the boolean poset @xmath7 of subsets of @xmath28 $ ] .",
    "let @xmath2 be the group of permutations of @xmath27 $ ] .",
    "we use one - line notation for permutations , writing @xmath44 where @xmath45 .",
    "sometimes we may omit the commas and write @xmath46 .",
    "a permutation @xmath23 has a _ descent _ at a position @xmath47 if @xmath48 .",
    "inversion _ in a permutation @xmath49 is a pair of positions @xmath50 with @xmath51 .",
    "the set of descents and inversions are denoted by @xmath24 and @xmath52 , respectively .",
    "the length of a permutation @xmath23 is @xmath53 .",
    "given @xmath54 , we consider the product @xmath55 to be a subgroup of @xmath56 , where @xmath57 permutes @xmath58 $ ] and @xmath59 permutes @xmath60 . for @xmath12 and @xmath13 , write @xmath61 for the permutation in @xmath56 corresponding to @xmath62 under this embedding",
    ".    more generally , given a subset @xmath63 of @xmath28 $ ] , we have the ( standard ) parabolic or young subgroup @xmath64 the notation @xmath65 suppresses the dependence on @xmath36 , which will either be understood or will be made explicit when this is used .",
    "lastly , we use @xmath66 to denote disjoint union .",
    "let @xmath0 be the graded vector space over @xmath31 with basis @xmath67 , graded by @xmath36 .",
    "this vector space has a graded hopf algebra structure first considered in malvenuto s thesis  @xcite and in her work with reutenauer  @xcite .",
    "( in  @xcite , it is called the algebra of free quasi - symmetric functions . )",
    "write @xmath68 for the basis element corresponding to @xmath49 for @xmath69 and @xmath70 for the basis element of degree @xmath71",
    ".    the product of two basis elements is obtained by shuffling the corresponding permutations , as in the following example .",
    "more precisely , for @xmath73 , set @xmath74 this is the collection of minimal ( in length ) representatives of left cosets of @xmath55 in @xmath56 . in the literature ,",
    "they are sometimes referred to as @xmath11-shuffles , but sometimes it is the inverses of these permutations that carry that name . we will refer to them as grassmannian permutations . with these definitions ,",
    "we describe the product . for @xmath75 and @xmath76 ,",
    "set @xmath77 this endows @xmath0 with the structure of a graded algebra with unit 1 .",
    "the algebra @xmath0 is also a graded coalgebra with coproduct given by all ways of splitting a permutation . for a sequence @xmath78 of distinct integers , let its _ standard permutation",
    "@xmath79 be the permutation @xmath23 defined by @xmath80 for instance , @xmath81 .",
    "the coproduct @xmath82 is defined by @xmath83 when @xmath49 . for instance",
    ", @xmath84 is @xmath85 @xmath0 is a graded connected hopf algebra  ( * ? ? ? * thorme 5.4 ) .",
    "we refer to the set @xmath6 as the _ fundamental _ basis of @xmath0 .",
    "the main goal of this paper is to obtain a detailed description of the hopf algebra structure of @xmath0 . to this end , the definition of a second basis for @xmath0 ( in   1.3 ) will prove crucial .",
    "this hopf algebra @xmath0 of malvenuto and reutenauer has been an object of recent interest  @xcite .",
    "we remark that sometimes it is the dual hopf algebra that is considered . to compare results , one may use that @xmath0 is self - dual under the map @xmath86 , where @xmath87 is the element of the dual basis that is dual to @xmath88 .",
    "we explore this further in section  [ s : duality ] .",
    "basic references for quasi - symmetric functions are  @xcite and  ( * ? ? ?",
    "* section 7.19 ) ; however , everything we need will be reviewed here .",
    "the algebra @xmath3 of quasi - symmetric functions is a subalgebra of the algebra of formal power series in countably many variables @xmath89 .",
    "it has a basis of _ monomial quasi - symmetric functions _",
    "@xmath90 indexed by compositions @xmath39 , where @xmath91 the product of these monomial functions is given by quasi - shuffles of their indices .",
    "quasi - shuffle _ of compositions @xmath38 and @xmath92 is a shuffle of the components of @xmath38 and @xmath92 , where in addition we may replace any number of pairs of consecutive components @xmath93 in the shuffle by @xmath94 .",
    "then we have @xmath95 where the sum is over all quasi - shuffles @xmath96 of the compositions @xmath38 and @xmath92 .",
    "for instance , @xmath97 the unit element is indexed by the empty composition @xmath98 .",
    "let @xmath99 and @xmath100 be two countable ordered sets and @xmath101 its disjoint union , totally ordered by @xmath102 .",
    "then @xmath103 gives @xmath3 the structure of a coalgebra . in terms of the monomial quasi - symmetric functions , we have @xmath104 for instance , @xmath105 .",
    "the algebra of quasi - symmetric functions was introduced by gessel  @xcite .",
    "its hopf algebra structure was introduced by malvenuto  ( * ? ? ?",
    "* section 4.1 ) . the description of the product in terms of quasi - shuffles can be found in  @xcite and is equivalent to  ( * ? ? ?",
    "* lemma 3.3 ) .",
    "a @xmath106-version of this construction appears in  ( * ? ? ?",
    "* section 5 ) and  @xcite .    the algebra @xmath3 is a graded connected hopf algebra whose component in degree @xmath36 is spanned by those @xmath90 with @xmath38 a composition of @xmath36 .",
    "malvenuto  ( * ? ? ?",
    "* corollaire 4.20 ) and ehrenborg  ( * ? ? ?",
    "* proposition 3.4 ) independently gave an explicit formula for the antipode @xmath107 here , @xmath108 is the number of components of @xmath38 , and if @xmath109 then @xmath110 is @xmath92 written in reverse order @xmath111 .",
    "gessel s _ fundamental _ quasi - symmetric function @xmath112 is defined by @xmath113 by mbius inversion , we have @xmath114 thus the set @xmath115 forms another basis of @xmath3 .",
    "it is sometimes advantageous to index these monomial and fundamental quasi - symmetric functions by subsets of @xmath28 $ ] .",
    "accordingly , given a composition @xmath38 of @xmath36 with @xmath116 , we define @xmath117 the notation @xmath118 suppresses the dependence on @xmath36 , which will be usually understood from the context ; otherwise it will be made explicit by writing @xmath119 .    in terms of power series , @xmath120",
    "we mention that there is an analogous realization of the malvenuto - reutenauer hopf algebra as a subalgebra of an algebra of non - commutative power series , due to duchamp , hivert , and thibon . to this end",
    ", one defines @xmath121 this is discussed in  ( * ? ? ?",
    "* section 3.1 ) , in slightly different terms . in this realization ,",
    "the coproduct of @xmath0 is induced by the ordinal sum of commuting alphabets  ( * ? ? ?",
    "3.4 ) .",
    "the descent set of a permutation @xmath49 is the subset of @xmath28 $ ] recording the descents of @xmath23 @xmath122\\mid u_p >",
    "u_{p+1}\\}\\,.\\ ] ] thus @xmath123 .",
    "malvenuto  ( * ? ? ?",
    "* thormes 5.12 , 5.13 , and 5.18 ) shows that there is a morphism of hopf algebras @xmath124 ( this is equivalent to theorem 3.3 in  @xcite . )",
    "this explains our name and notation for the fundamental basis of @xmath0 .",
    "this map extends to power series , where it is simply the abelianization : there is a commutative diagram @xmath125\\ar@{>>}_{{\\mathcal{d}}}[d ] &     \\quad k\\langle x_1,x_2,\\ldots\\rangle\\quad \\ar@{>>}^{\\mathit{ab}}[d ] \\\\     { \\quad { \\mathcal{q}\\mathit{sym}}\\quad } { \\ar@{^{(}->}}[r ] &   \\quad k[x_1,x_2,\\ldots]\\quad   } \\ ] ] this is evident from   and  .",
    "it is easy to see , however , that @xmath126 is _ not _ the abelianization of @xmath0 .    in analogy",
    "to the basis of monomial quasi - symmetric functions , we define a new _ monomial _",
    "basis @xmath5 for the malvenuto - reutenauer hopf algebra . for each @xmath127 and @xmath128 ,",
    "let @xmath129 where @xmath130 in the weak order in @xmath2 ( described in section  [ s : bruhat ] ) and @xmath131 is the mbius function of this partial order . by mbius inversion , @xmath132 so these elements @xmath133 indeed form a basis of @xmath0 .",
    "for instance , @xmath134 we will show that @xmath133 maps either to @xmath135 or to 0 under the map @xmath136 .",
    "let @xmath52 be the set of inversions of a permutation @xmath49 , @xmath137\\times[n]\\mid i < j \\text { and } u_i > u_j\\}\\,.\\ ] ] the inversion set determines the permutation .",
    "given @xmath23 and @xmath138 , we write @xmath130 if @xmath139 .",
    "this defines the _ left weak order _ on @xmath2 .",
    "@xmath140    figure  [ f : s4 ] shows the ( left ) weak order on @xmath141 .",
    "the weak order has another characterization @xmath142 where @xmath143 is the number of inversions of @xmath23 .",
    "the cover relations @xmath144 occur when @xmath19 is an adjacent transposition .",
    "thus , @xmath144 precisely when @xmath145 is obtained from @xmath23 by transposing a pair of consecutive values of @xmath23 ; a pair @xmath146 such that @xmath147 and @xmath148 . the identity permutation @xmath149 is the minimum element of @xmath2 and @xmath150 is the maximum .",
    "this weak order is a lattice  @xcite , whose structure we describe .",
    "first , a set @xmath151 is the inversion set of a permutation in @xmath2 if and only if both @xmath151 and its complement @xmath152 are _ transitively closed _ ( @xmath153 and @xmath154 imply @xmath155 , and the same for its complement ) .",
    "the join ( least upper bound ) of two permutations @xmath23 and @xmath138 is the permutation @xmath156 whose inversion set is the transitive closure of the union of the inversion sets of @xmath23 and @xmath145 @xmath157 similarly , the meet ( greatest lower bound ) of @xmath23 and @xmath145 is the permutation @xmath158 whose inversion set is @xmath159 the mbius function of the weak order takes values in @xmath160 .",
    "explicit descriptions can be found in  ( * ? ? ?",
    "* corollary 3 ) or  ( * ? ? ?",
    "* theorem 1.2 ) .",
    "we will not need that description , but will use several basic facts on the weak order that we develop here .      in section  [ s : basic ] , we defined @xmath161 to be the set of minimal ( in length ) representatives of ( left ) cosets of @xmath55 in the symmetric group @xmath56 .",
    "thus the map @xmath162 is a bijection .",
    "we leave the following description of the inverse to the reader .",
    "[ l : stdecom ] let @xmath15 , and set @xmath163 . then @xmath164 and @xmath165 .",
    "we describe the order - theoretic properties of this decomposition into cosets.the first step is to characterize the inversion sets of grassmannian permutations .",
    "a subset @xmath151 of @xmath58\\times [ q]$ ] is _ cornered _",
    "if @xmath166 implies that @xmath153 whenever @xmath167 and @xmath168 .",
    "the reason for this definition is that a set @xmath169 is the inversion set of a grassmannian permutation @xmath170 if and only if @xmath171\\times[q ] \\text { is cornered}\\ , .",
    "\\rule{0pt}{14pt }     \\end{array}\\ ] ] given an arbitrary subset @xmath151 of @xmath58\\times[q]$ ] , let @xmath172 denote the smallest cornered subset containing @xmath151 .",
    "denote the obvious action of @xmath173 on a subset @xmath151 of @xmath58\\times[q]$ ] by @xmath174 .",
    "[ l : corners ] let @xmath151 be a cornered subset of @xmath58\\times[q]$ ] and @xmath12 and @xmath13 any permutations .",
    "then @xmath175    let @xmath153 .",
    "the set @xmath176 has @xmath177 elements .",
    "hence there is a number @xmath178 such that @xmath179 and @xmath180 .",
    "similarly there is number @xmath181 such that @xmath182 and @xmath183 .",
    "since @xmath151 is cornered , @xmath166",
    ". hence @xmath184 . by construction , @xmath185 and @xmath186",
    ", so @xmath187 , as needed .",
    "denote the diagonal action of @xmath188 on a subset @xmath169 of @xmath27\\times [ n]$ ] by @xmath189 .",
    "suppose @xmath190 and @xmath191 .",
    "let @xmath151 be the result of shifting @xmath169 , as in  ( _ ii _ ) .",
    "it is easy to see that the result of shifting @xmath192 is @xmath193 , where @xmath194 .",
    "[ c : invshuffle ] let @xmath195 and @xmath196 be grassmannian permutations , and @xmath12 and @xmath13 be permutations . if @xmath197 then @xmath198 .",
    "we show that @xmath199 .",
    "let @xmath151 and @xmath200 be the corresponding shifted sets . according to the previous discussion and the hypothesis , @xmath201 .",
    "hence cr@xmath202 , since @xmath200 is cornered . by lemma  [ l : corners ] ,",
    "@xmath203 , so @xmath204 .",
    "this implies the inclusion of inversion sets , as needed .",
    "the following lemma is straightforward .",
    "[ l : invlambda ] let @xmath170 , @xmath12 , @xmath13 and @xmath205 .",
    "there is a decomposition of @xmath206 into disjoint subsets @xmath207    we deduce some order - theoretic properties of the decomposition into left cosets .",
    "define @xmath208 to be the permutation of maximal length in @xmath161 , so that @xmath209    [ p : shuffles ] let @xmath210 be the bijection @xmath211 then    * @xmath212 is order preserving . that is , @xmath213 * @xmath214 is order preserving when restricted to any of the following sets @xmath215 for any @xmath12 , @xmath13",
    "let @xmath216 and @xmath217 .",
    "suppose @xmath218 , so that @xmath219 . by lemma  [ l : invlambda ] , we have @xmath220 , @xmath221 , and @xmath222 , where @xmath223 and @xmath224 .",
    "therefore , @xmath225 , @xmath226 , and by corollary  [ c : invshuffle ] , @xmath198 .",
    "this proves ( _ i _ ) .",
    "statement ( _ ii _ ) follows by a similar application of lemma  [ l : invlambda ] , noting that @xmath227 and @xmath228 are invariant under any permutation in @xmath55 .",
    "since grassmannian permutations in @xmath229 are left coset representatives of @xmath55 in @xmath56 , their inverses are right coset representatives .",
    "we discuss order - theoretic properties of this decomposition into right cosets .    given a subset @xmath151 of @xmath27\\times[n]$ ] , let @xmath230 we have the following key observation about the diagonal action of @xmath2 on subsets of @xmath27\\times[n]$ ] .",
    "[ l : inversioninv ] for any @xmath49 , we have @xmath231 .    _ proof . _ note that @xmath232 .",
    "thus @xmath233 .",
    "then @xmath234    [ p : rightshuffling ] fix @xmath235 and consider the map @xmath236 given by @xmath237 then @xmath238 is a convex embedding in the sense that    * @xmath238 is injective ; * @xmath238 is order - preserving : @xmath239 ; * @xmath238 is convex : if @xmath240 , for some @xmath241 and @xmath242 , then there are @xmath243 and @xmath244 with @xmath245 .",
    "it follows that    * @xmath238 preserves meets and joins .",
    "assertion ( a ) is immediate .",
    "set @xmath246 .",
    "then @xmath247 . by lemmas  [ l : invlambda ] and  [ l : inversioninv ]",
    ", we have @xmath248 assertion ( b ) follows from this and the characterization of the weak order in terms of inversion sets .    for ( c ) , decompose @xmath249 . by assumption , @xmath250 then @xmath251 by lemma [ l : inversioninv ] , so @xmath245 as needed .",
    "write a subset @xmath252 of @xmath28 $ ] as @xmath63 . in section  [ s : basic ]",
    ", we defined the parabolic subgroup @xmath253 let @xmath254 be the set of minimal ( in length ) representatives of left cosets of @xmath65 in @xmath2 , @xmath255 grassmannian permutations are the special case @xmath256 .",
    "let @xmath257 be the permutation of maximal length in @xmath254 , @xmath258 we record the following facts about these coset representatives .",
    "[ l : galois ] @xmath254 is an interval in the weak order of @xmath2 .",
    "the minimum element is the identity @xmath149 and the maximum is @xmath259 .",
    "our proofs rely upon the following basic fact .",
    "suppose @xmath260 are positive integers and @xmath261 is a subset of @xmath262 $ ] .",
    "define the subset @xmath252 of @xmath263 $ ] to be @xmath264 .",
    "then @xmath265 defines a bijection @xmath266 the maximum elements are preserved under this map @xmath267    the analog of proposition  [ p : shuffles ] for this decomposition of @xmath2 into left cosets of @xmath268 follows from proposition  [ p : shuffles ] by induction using   and  .",
    "[ p : multishuffles ] suppose @xmath252 is a subset of @xmath269 $ ] .",
    "let @xmath270 be the bijection @xmath271 then @xmath212 is order preserving , while @xmath214 is order preserving when restricted to any of the following sets @xmath272    we state the analog of proposition  [ p : rightshuffling ] .",
    "[ p : multirightshuffling ] let @xmath252 be a subset of @xmath28 $ ] .",
    "fix @xmath273 and consider the map @xmath274 given by @xmath275 then @xmath238 is a convex embedding . in particular",
    ", it preserves meets and joins .",
    "let @xmath7 denote the boolean poset of subsets of @xmath28 $ ] , which we identify with the poset of compositions of @xmath36 .",
    "we have the descent map @xmath276 given by @xmath277 , the descent set   of @xmath23 .",
    "let @xmath278 be the map defined by @xmath279 , the maximum left coset representative of @xmath268 as in  .",
    "a _ galois connection _ between posets @xmath280 and @xmath281 is a pair @xmath282 of order preserving maps @xmath283 and @xmath284 such that for any @xmath285 and @xmath286 , @xmath287    [ p : galois ] the pair of maps @xmath288 is a galois connection .",
    "we verify that    * @xmath289 is order preserving ; * @xmath290 is order preserving ; * @xmath291 ; * @xmath292 .",
    "first of all , the map @xmath293 is order preserving simply because @xmath47 is a descent of @xmath23 if and only if @xmath294 .",
    "this is ( a ) .",
    "the remaining assertions follow immediately from @xmath295 which we know from lemma  [ l : galois ] .",
    "condition   follows formally .",
    "in fact , suppose @xmath296 .",
    "then by ( d ) , @xmath297 , and by ( b ) , @xmath298 , so @xmath299 .",
    "conversely , suppose @xmath299 . then by ( a ) and ( c ) , @xmath300 .",
    "@xmath301    this galois connection is why the monomial basis of @xmath0 is truly analogous to that of @xmath3 , and explains why we consider the weak order rather than any other order on @xmath2 .",
    "the connection between the monomial bases of these two algebras will be elucidated in theorem  [ t : map - monomial ] using the previous result .",
    "[ d : global ] a permutation @xmath49 has a _ global descent _ at a position @xmath302 $ ] if @xmath303 equivalently , if @xmath304 .",
    "let @xmath305 $ ] be the set of global descents of @xmath23 .",
    "note that @xmath306 , but these are not equal in general .",
    "in section  [ s : descents ] we showed that the descent map @xmath307 is left adjoint to the map @xmath308 , in the sense that the pair @xmath309 forms a galois connection , as in proposition  [ p : galois ] .",
    "that is , for @xmath49 and @xmath310 , @xmath311 the notion of global descents is a very natural companion of that of ( ordinary ) descents , in that the map @xmath312 is _ right _ adjoint to @xmath308 .",
    "[ p : galoisglobal ] the pair of maps @xmath313 is a galois connection .",
    "we already know that @xmath314 is order preserving . so is @xmath315 , because @xmath47 is a global descent of a permutation @xmath23 if and only if @xmath316 for every @xmath317 , @xmath318 .",
    "it remains to check that @xmath319 as in the proof of proposition  [ p : galois ] , this follows from @xmath320 which is clear from the definition of @xmath259 .",
    "we turn to properties of the decomposition of @xmath2 into left cosets of @xmath268 related to the notion of global descents . recall that @xmath161 is a set of representatives for the left cosets of @xmath55 in @xmath56 , and that @xmath321 .",
    "[ l : global ] suppose @xmath260 are non - negative integers and let @xmath15 .",
    "then @xmath322    first suppose that @xmath15 is in the same left coset of @xmath55 as is @xmath208 .",
    "thus , there are permutations @xmath12 and @xmath13 such that @xmath323 if @xmath317 , then @xmath324 and thus @xmath325 , so @xmath47 is a global descent of @xmath19 as needed .",
    "for the other direction , suppose @xmath47 is a global descent of @xmath19 and set @xmath326 let @xmath327 . by assumption , @xmath328 .",
    "hence @xmath329 , which means that @xmath330 for some @xmath12 and @xmath13 , as needed .",
    "noting that @xmath208 is a minimal coset representative and that the map @xmath212 is order preserving ( proposition  [ p : shuffles](a ) ) proves the second equivalence .    for any subset @xmath252 of @xmath28 $ ] , we have the left coset map @xmath331 of section  [ s : multiweak ] . given a permutation @xmath49 ,",
    "consider its ` projection ' @xmath332 to @xmath268 , which is defined to be the second component of @xmath333 .",
    "that is , @xmath334 for some permutation @xmath335 .",
    "if @xmath336 , then by lemma [ l : stdecom ] , @xmath337 in particular , @xmath338 and @xmath339}=1_n$ ] .",
    "we relate this projection to the order and lattice structure of @xmath2 . for @xmath147 ,",
    "let @xmath340 .",
    "[ l : invus ] for any @xmath49 and subset @xmath252 of @xmath28 $ ] , @xmath341 in particular , @xmath342 .",
    "let @xmath147 be integers in @xmath27 $ ] .",
    "suppose that there is an element @xmath343 with @xmath344 .",
    "since @xmath345 , we have @xmath346 , and so @xmath347 .",
    "thus @xmath348 .",
    "suppose now that that @xmath349 .",
    "then there are consecutive elements @xmath47 and @xmath106 of @xmath252 such that @xmath350 . by  , @xmath351 by",
    ", this implies that @xmath352 and thus @xmath353 .",
    "this completes the proof .",
    "[ p : latticeus ] let @xmath23 , @xmath138 and @xmath354 be subsets of @xmath28 $ ]",
    ". then    1 .   if @xmath130 then @xmath355 and if @xmath356 then @xmath357 .",
    "2 .   @xmath358 , 3 .   if @xmath359 and @xmath360 , then @xmath361 .",
    "the first statement is an immediate consequence of lemma  [ l : invus ] .",
    "for the second , we use   to show that @xmath362 .",
    "first , suppose @xmath363 .",
    "then by lemma  [ l : invus ] and  , we have @xmath364 , and given a chain @xmath365 , there is an index @xmath366 such that @xmath367 .",
    "hence we also have @xmath368 , and thus @xmath369 .",
    "thus @xmath370 .",
    "we show the other inclusion .",
    "let @xmath370 .",
    "considering the chain @xmath147 , we must have @xmath371 .",
    "in particular , @xmath372 . on the other hand , for any chain @xmath365",
    "there is an index @xmath366 such that @xmath369 . since this is a subset of @xmath373 , we have @xmath374 . together with @xmath375 , we see that @xmath363 , proving the second statement .    for the third statement ,",
    "first note that statement ( _ i _ ) implies that @xmath376 and similarly @xmath377 .",
    "thus we have @xmath378 . to show the other inequality , we need the assumptions on @xmath252 and @xmath261 . with those assumptions ,",
    "we show @xmath379 .",
    "suppose that @xmath359 and @xmath360 , so that @xmath252 consists of global descents of @xmath145 and @xmath261 consists of global descents of @xmath23 .",
    "let @xmath380 .",
    "then , by lemma  [ l : invus ] and  , @xmath381 and there is a chain @xmath365 such that for every @xmath366 , @xmath382 .",
    "we refine this chain so that every pair of consecutive elements belongs to @xmath383 .",
    "if @xmath384 then , by lemma  [ l : invus ] , @xmath385 and this interval need not be refined .",
    "if however the intersection is not empty , then choose any refinement @xmath386 with the property that each interval @xmath387 contains exactly _ one _ element of @xmath252 or @xmath261 , but not an element of both .",
    "this is possible because @xmath381 .",
    "we claim that each pair @xmath388 is in @xmath383 .",
    "in fact , if @xmath387 contains an element @xmath343 , then that is a global descent of @xmath145 , so @xmath389 .",
    "thus @xmath390 , since @xmath391 by our construction of the refinement .",
    "similarly , if @xmath387 contains an element of @xmath261 , then @xmath392 . we have thus constructed a chain from @xmath177 to @xmath393 with the required property , which shows that @xmath394 and completes the proof .",
    "we calculate the descents and global descents of some particular permutations .",
    "the straightforward proof is left to the reader .",
    "[ l : over / under ] let @xmath12 and @xmath13 .",
    "then @xmath395 more generally , let @xmath396 , @xmath397 , @xmath398 $ ]",
    ". then @xmath399    [ l : higherglobal ] let @xmath49 and @xmath400 $ ] .",
    "then @xmath401    the reverse implication follows from lemma  [ l : over / under ]  ( _ viii _ ) .",
    "the other follows by induction from lemma  [ l : global ] and  .",
    "the coproduct of @xmath0   takes a simple form on the monomial basis .",
    "we derive this formula using some results of section  [ s : bruhat ] . for a permutation @xmath49 , define @xmath402 to be @xmath403 .",
    "[ t : cop - monomial ] let @xmath128 .",
    "then @xmath404    let @xmath405 be the map whose action on the monomial basis is defined by the sum  .",
    "we show that @xmath406 is the coproduct @xmath407 , as defined by  .",
    "we use the following notation . for @xmath188 and @xmath408 , let @xmath409 and @xmath410 . by virtue of lemmas [",
    "l : stdecom ] and [ l : global ] , we have @xmath411 therefore , @xmath412 write @xmath413 for some @xmath414 which depends on @xmath47 . by proposition [ p :",
    "shuffles ] , @xmath415 therefore , @xmath416    [ r : loday ] the action of the coproduct of @xmath0 on the fundamental basis can also be expressed in terms of the weak order . to see this ,",
    "let @xmath49 and @xmath417 and write @xmath413",
    ". by proposition  [ p : shuffles ] , @xmath418 .",
    "moreover , @xmath419 and @xmath420 are the only permutations in @xmath57 and @xmath421 with this property , again by proposition  [ p : shuffles ] .",
    "therefore , equation   is also described by @xmath422 , where the sum is over all @xmath47 from 0 to @xmath36 and all permutations @xmath423 and @xmath424 such that @xmath425 .",
    "this fact ( in its dual form ) is due to loday and ronco  ( * ? ? ?",
    "* theorem  4.1 ) , who were the first to point out the relevance of the weak order to the hopf algebra structure of @xmath0 .",
    "we give an explicit formula for the product of @xmath0 in terms of its monomial basis and a geometric interpretation for the structure constants .",
    "remarkably , these are still non - negative integers .",
    "for instance , @xmath426 the structure constants count special ways of shuffling two permutations , according to certain conditions involving the weak order . specifically , for @xmath12 , @xmath13 and @xmath15 , define @xmath427 to be those @xmath235 satisfying @xmath428 set @xmath429 .",
    "we will prove the following theorem .",
    "[ t : prod - monomial ] for any @xmath12 and @xmath13 , we have @xmath430    for instance , in   the coefficient of @xmath431 in @xmath432 is 2 because among the six permutations in @xmath433 , @xmath434 only the first two satisfy conditions @xmath435 and @xmath436 of  .",
    "in fact , @xmath437 , @xmath438 and @xmath439 do not satisfy @xmath435 , while @xmath440 satisfies @xmath435 but not @xmath436 .",
    "the structure constants @xmath441 admit a geometric - combinatorial description in terms of the permutahedron . to derive it , recall the convex embeddings of proposition  [ p : rightshuffling ] .",
    "@xmath442 since @xmath238 preserves joins , we may further rewrite the definition   of @xmath443 as @xmath444\\bigr\\}\\,,\\ ] ] where @xmath445:=\\{w''\\mid w\\leq w''\\leq w'\\}$ ] denotes the interval between @xmath19 and @xmath446 .",
    "the vertices of the @xmath447-dimensional permutahedron can be indexed by the elements of @xmath2 so that its 1-skeleton is the hasse diagram of the weak order ( see figure  [ f : s4 ] ) .",
    "facets of the permutahedron are products of two lower dimensional permutahedra , and the image of @xmath238 is the set of vertices in a facet .",
    "moreover , every facet arises in this way for a unique triple @xmath448 with @xmath449 and @xmath170 ; see  ( * ? ? ?",
    "* lemma  4.2 ) , or  ( * ? ? ?",
    "2.9 ) , or  ( * ? ? ?",
    "let us say that such a facet has _",
    "_ @xmath11 .",
    "figure  [ f : alphaperm ] displays the image of @xmath450 , a facet of the @xmath451-permutahedron of type @xmath452 , and the permutation @xmath453 .",
    "@xmath454    the description   of @xmath443 ( and hence of @xmath441 ) can be interpreted as follows : given @xmath12 , @xmath13 , and @xmath15 , the structure constant @xmath441 counts the number of facets of type @xmath11 of the @xmath455-permutahedron such that the vertex @xmath456 is below @xmath19 and it is the maximum vertex in that facet below @xmath19 .",
    "for instance , the facet @xmath450 contributes to the structure constant @xmath457 because the vertex @xmath458 satisfies the required properties in relation to the vertex @xmath459 , as shown in figure  [ f : alphaperm ] .",
    "this description of the product of @xmath0 has an analog for @xmath3 that we present in section  [ s : descentmap ] .",
    "expand the product @xmath17 in the fundamental basis and then use formula   to obtain @xmath460 expressing this result in terms of the monomial basis and collecting like terms gives @xmath461 where @xmath462 is the number of permutations in the set @xmath463 the theorem will follow once we show that @xmath464 or equivalently , by mbius inversion on @xmath55 , @xmath465 we prove this last equality by showing that @xmath466 where the union is disjoint .    to see this , first suppose @xmath467 . then , by condition @xmath435 of  , @xmath468 by proposition  [ p : rightshuffling].(d ) , @xmath469 but then , by condition @xmath436 of  , @xmath470 so the union is disjoint .",
    "next , suppose that @xmath471 for some @xmath225 and @xmath226 .",
    "then , by condition @xmath435 of  , @xmath472",
    ". by proposition  [ p : rightshuffling].(c ) we have , @xmath473 , so @xmath474 .",
    "this proves one inclusion .    for the other inclusion ,",
    "suppose that @xmath474 .",
    "define @xmath475 then @xmath476 : condition @xmath435 is satisfied because @xmath238 preserves joins , and @xmath436 simply by definition .",
    "this completes the proof .",
    "malvenuto left open the problem of an explicit formula for the antipode of @xmath0  @xcite .",
    "we solve that problem , giving formulas that identify the coefficients of the antipode in terms of both the fundamental and monomial basis in explicit combinatorial terms .",
    "we first review a general formula for the antipode of a connected hopf algebra @xmath30 , due to takeuchi  ( * ? ? ?",
    "* lemma 14 ) ( see also milnor and moore  @xcite ) .",
    "let @xmath30 be an arbitrary bialgebra with structure maps : multiplication @xmath477 , unit @xmath478 , comultiplication @xmath479 , and counit @xmath480 .",
    "set @xmath481 , @xmath482 , and for any @xmath483 , @xmath484 these are the higher or iterated products and coproducts .",
    "we also set @xmath485 if @xmath486 is any linear map , the convolution powers of @xmath487 are , for any @xmath488 , @xmath489 in particular , @xmath490 and @xmath491 .",
    "we set @xmath492 .",
    "if @xmath493 is locally nilpotent with respect to convolution , then @xmath494 is invertible with respect to convolution , with inverse @xmath495 this is certainly the case if @xmath30 is a graded connected bialgebra , in which case @xmath493 annihilates the component of degree @xmath71 ( and hence @xmath496 annihilates components of degree @xmath497 ) .",
    "thus   is a general formula for the antipode of a graded connected hopf algebra .",
    "we will make use of this formula to find explicit formulas for the antipode of @xmath0 .",
    "the first task is to describe the higher products and coproducts explicitly .",
    "we begin with the higher coproducts in terms of the fundamental and monomial bases .",
    "[ p : highercop ] let @xmath138 , @xmath127 , and @xmath498 .",
    "then    * @xmath499 ,  and *     ' '' '' + @xmath500 .",
    "both formulas follow by induction from the corresponding descriptions of the coproduct , equations   and  .",
    "we describe higher products in terms of minimal coset representatives @xmath254 of parabolic subgroups , whose basic properties were discussed in section  [ s : multiweak ] . recall that for a subset @xmath336 of @xmath28 $ ] , we have @xmath501 .",
    "analogously to  , given permutations @xmath502",
    ", @xmath503 ,  , @xmath504 , define @xmath505 to be those @xmath335 satisfying @xmath506 set @xmath507 .",
    "[ p : higherprod ] let @xmath252 and @xmath508 be as in the preceding paragraph .",
    "then    * @xmath509  and *     ' '' '' + @xmath510 ,    the first formula follows immediately by induction from ( the case @xmath511 ) , using  .",
    "the second formula can be deduced from  ( _ i _ ) in the same way as in the proof of theorem  [ t : prod - monomial ] .",
    "the structure constants for the iterated product admit a geometric description similar to that of the product .",
    "the image of the map @xmath512 consists of the vertices of a face of codimension @xmath181 in the @xmath447-permutahedron , and every such face arises in this way for a unique pair @xmath513 with @xmath514 $ ] having @xmath181 elements and @xmath273 .",
    "let us say that such a face has _",
    "the structure constant @xmath515 counts the number of faces of type @xmath252 with the property that the vertex @xmath516 is below @xmath19 and it is the maximum vertex in its face below @xmath19 .",
    "we next determine the convolution powers of the projection @xmath517 .",
    "recall that for any subset @xmath518 $ ] and @xmath138 we have @xmath519 as given by  .",
    "we slightly amend our notation in order to simplify some subsequent statements . for @xmath520 and @xmath514 $ ] , set @xmath521 , where @xmath522 are the factors of @xmath523 in the definition above . comparing with  , we see that @xmath524 consists of those @xmath335 satisfying @xmath525 similarly , we define @xmath526 . if @xmath522 are the factors in the definition of @xmath523 , then @xmath527    let @xmath528}{k{-}1}$ ] be the collection of subsets of @xmath28 $ ] of size @xmath529 .",
    "[ p : pipower ] let @xmath530 and @xmath138 .",
    "then    * @xmath531}{k-1}\\\\{\\mathrm{des}}(w^{-1}v_{\\mathsf{s}})\\subseteq{\\mathsf{s } } } } }             { \\mathcal{f}}_w}$ ] ,  and *     ' '' '' + @xmath532 .    by proposition",
    "[ p : highercop](_i _ ) , @xmath533 suppose that an equality @xmath534 occurs ( where we define @xmath535 and @xmath536 ) .",
    "the corresponding permutation @xmath537 is then simply the unique permutation in @xmath538 , which indexes the element @xmath539 .",
    "therefore , @xmath540 the last equality by the formula of proposition  [ p : higherprod](_i _ ) for the iterated product .",
    "changing the index of summation in the first sum to @xmath541}{k-1}$ ] and using the definition of @xmath523 gives @xmath542}{k-1 } }               \\sum_{\\zeta\\in { \\mathfrak{s}^{{\\mathsf{s } } } } } { \\mathcal{f}}_{v_{\\mathsf{s}}\\zeta^{-1}}\\,.\\ ] ] again reindexing the sum and using that @xmath254 consists of permutations whose descent set is a subset of @xmath252 , we obtain @xmath543}{k-1}\\\\               w^{-1}v_{\\mathsf{s}}\\in { \\mathfrak{s}^{{\\mathsf{s } } } } } } } { \\mathcal{f}}_w     \\ = \\",
    "\\sum_{w\\in{\\mathfrak{s}}_n}{\\sum_{\\substack{{\\mathsf{s}}\\in\\binom{[n{-}1]}{k-1}\\\\                    { \\mathrm{des}}(w^{-1}v_{\\mathsf{s } } ) \\subseteq{\\mathsf{s}}}}}{\\mathcal{f}}_w\\,,\\ ] ] establishing ( _ i _ )",
    ".    the second formula in terms of the monomial basis follows in exactly the same manner from propositions  [ p : highercop](_ii _ ) and  [ p : higherprod](_ii _ ) for the higher coproducts and products in terms of the monomial basis , using  .",
    "we derive explicit formulas for the antipode on both bases .",
    "the formula for the fundamental basis is immediate from proposition  [ p : pipower](_i _ ) and  .",
    "[ t : ant - fundamental ] for @xmath520 set @xmath544\\mid       { \\mathrm{des}}(w^{-1}v_{\\mathsf{s}})\\subseteq{\\mathsf{s}}\\text { and $ \\#{\\mathsf{s}}$ is odd}\\}\\\\         & -\\#\\{{\\mathsf{s}}\\subseteq[n{-}1]\\mid { \\mathrm{des}}(w^{-1}v_{\\mathsf{s}})\\subseteq{\\mathsf{s}}\\text { and $ \\#{\\mathsf{s}}$ is even}\\}.   \\end{aligned}\\ ] ] then @xmath545    the coefficients of the antipode on the fundamental basis may indeed be positive or negative .",
    "for instance @xmath546 the coefficient of @xmath547 is @xmath70 because @xmath548 , @xmath549 , and @xmath550 are the subsets @xmath252 of @xmath550 which satisfy @xmath551 .",
    "our description of these coefficients is semi - combinatorial , in the sense that it involves a difference of cardinalities of sets . on the monomial basis",
    "the situation is different .",
    "the sign of the coefficients of @xmath552 only depends on the number of global descents of @xmath145 .",
    "we provide a fully combinatorial description of these coefficients .",
    "let @xmath520 and suppose @xmath553 . define @xmath554 to be those @xmath335 satisfying @xmath555 set @xmath556 .",
    "[ t : ant - monomial ] for @xmath520 , we have @xmath557    for instance , @xmath558 consider the coefficient of @xmath559 . in this case , @xmath560 , so @xmath561 then @xmath562 satisfies ( @xmath177 ) and ( @xmath563 ) of   but not ( @xmath564 ) , 1324 satisfies ( @xmath177 ) and ( @xmath564 ) but not ( @xmath563 ) , 1423 , 2314 and 2413 do not satisfy ( @xmath177 ) , and 3412 is the only element of @xmath565 that satisfies all three conditions of  .",
    "therefore @xmath566 and the coefficient is @xmath567 .",
    "the antipode of @xmath0 has infinite order .",
    "in fact , one may verify by induction that @xmath568    by formula   and proposition  [ p : pipower](_ii _ ) , we have @xmath569 for any @xmath570 , define @xmath571 where @xmath572 is the mbius function of the boolean poset @xmath7 .",
    "we then have @xmath573 we complete the proof by showing that @xmath574 , and more generally that @xmath575 , where @xmath576 is defined in  .",
    "mbius inversion using the definition   of @xmath577 gives @xmath578 we prove this last equality by showing that @xmath579 where the union is disjoint .",
    "this implies that @xmath580 , which will complete the proof .",
    "we argue that this is a disjoint union in several steps .",
    "* claim 1 : * if @xmath581 then @xmath582 .",
    "let @xmath583 .",
    "first of all , @xmath584 , as @xmath254 is the set of permutations with descent set a subset of @xmath252 .",
    "by condition ( @xmath177 ) of  , @xmath585 . on the other hand",
    ", proposition  [ p : latticeus](_i _ ) implies that @xmath586 and both permutations are elements of the parabolic subgroup @xmath268 .",
    "hence by proposition  [ p : multirightshuffling ] , @xmath587 .",
    "thus @xmath588 , which establishes condition ( @xmath177 ) of   for @xmath195 to be in @xmath589 .    now suppose that @xmath226 with @xmath590 .",
    "since @xmath585 , we deduce that @xmath591 the first equality is because @xmath238 is a convex embedding and hence preserves joins by proposition  [ p : multirightshuffling ] , and the second follows from proposition  [ p : latticeus](_iii _ ) as @xmath592 . hence , by condition ( @xmath563 ) for @xmath593 , we have @xmath594 . this establishes ( @xmath563 ) for @xmath195 to be in @xmath589 and completes the proof of claim 1 .    * claim 2 : * if @xmath595 , then @xmath596 .",
    "the inclusion @xmath597 is a consequence of claim 1 . to prove the converse ,",
    "let @xmath598 .",
    "note that @xmath599 , which equals @xmath600 .    by condition ( @xmath177 ) for @xmath601 and for @xmath602",
    ", we have @xmath603 and @xmath604 .",
    "therefore , @xmath605 as before , this uses proposition  [ p : latticeus](_iii _ ) , which applies as @xmath606 .",
    "this proves condition ( @xmath177 ) of   for @xmath195 to be in @xmath607 .",
    "now suppose that @xmath226 with @xmath608 . by proposition  [ p :",
    "latticeus](_i _ ) , @xmath609 .",
    "then by proposition  [ p : multirightshuffling ] , @xmath610 .",
    "thus @xmath611 and by condition ( @xmath563 ) for @xmath612 we deduce that @xmath594 .",
    "this proves condition ( @xmath563 ) for @xmath195 to be in @xmath607 , and establishes claim 2 .",
    "we complete the proof by showing that for @xmath570 we have the decomposition   of @xmath589 into disjoint subsets @xmath576 . comparing the definitions   and",
    ", we see that @xmath613 .",
    "together with claim 1 this implies that the right hand side of   is contained in the left hand side .",
    "we show the union is disjoint .",
    "suppose there is a permutation @xmath614 .",
    "then @xmath615 which equals @xmath616 , by claim 2 .",
    "hence , by condition ( @xmath177 ) for @xmath195 to be in @xmath616 , we have @xmath617 .",
    "but then , from condition ( @xmath564 ) for @xmath618 and for @xmath619 , we deduce that @xmath620 , proving the union is disjoint .",
    "we show that @xmath589 is contained in the union of  .",
    "let @xmath621 and set @xmath622 by claim 2 , @xmath623 so @xmath583 . to show that @xmath624 , we must verify condition ( @xmath564 ) of  .",
    "suppose @xmath625 and @xmath626 .",
    "we need to show that @xmath627 . by the definition   of @xmath252",
    ", it suffices to show that @xmath628 . by our assumption that @xmath626 , condition ( @xmath177 ) for @xmath195 to be in @xmath629 holds .",
    "we show that condition ( @xmath563 ) also holds .",
    "suppose @xmath226 and @xmath630 . by proposition  [ p : latticeus](_i",
    "_ ) we have @xmath631 , and so by proposition  [ p : multirightshuffling ] , @xmath632 .",
    "thus @xmath611 , and by condition ( @xmath563 ) for @xmath195 to be in @xmath593 , we have @xmath594 .",
    "this establishes condition ( @xmath563 ) for @xmath195 to be in @xmath629 .",
    "thus , @xmath633 , and as explained above , shows that   is a disjoint union and completes the proof of the theorem .",
    "the monomial basis reveals the existence of a second coalgebra grading on @xmath0 , given by the number of global descents of the indexing permutations .",
    "we show that with respect to this grading , @xmath0 is a cofree graded coalgebra .",
    "we deduce an elegant description of the coradical filtration : it corresponds to a filtration of the symmetric groups by certain lower order ideals determined by the number of global descents . in particular ,",
    "the space of primitive elements is spanned by those @xmath133 where @xmath23 has no global descents .",
    "we review the notion of cofree graded coalgebras .",
    "let @xmath634 be a vector space and set @xmath635 the space @xmath636 , graded by @xmath181 , becomes a graded coalgebra with the _ deconcatenation _ coproduct @xmath637 and counit @xmath638 for @xmath498 .",
    "@xmath636 is connected , in the sense that the component of degree @xmath71 is identified with the base field via @xmath639 .",
    "we call @xmath636 the cofree graded coalgebra cogenerated by @xmath634 . the canonical projection",
    "@xmath640 satisfies the following universal property .",
    "given a graded coalgebra @xmath641 and a linear map @xmath642 where @xmath643",
    "when @xmath644 , there is a unique morphism of graded coalgebras @xmath645 such that the following diagram commutes @xmath646^{\\hat{\\varphi}}\\ar[dr]_{\\varphi } &     & { q(v)}\\ar[ld]^{\\pi}\\\\ & { v } } \\ ] ] explicitly , @xmath647 is defined by @xmath648 in particular , @xmath649 , @xmath650 , and @xmath651 .",
    "we establish the cofreeness of @xmath0 by first defining a second coalgebra grading .",
    "let @xmath652 , and for @xmath498 , let @xmath653 for instance , @xmath654    let @xmath655 be the vector subspace of @xmath0 spanned by @xmath656 .",
    "[ t : cofree ] the decomposition @xmath657 is a coalgebra grading .",
    "moreover , endowed with this grading , @xmath0 is a cofree graded coalgebra .",
    "let @xmath658 and write @xmath659 .",
    "by theorem  [ t : cop - monomial ] , @xmath660 since @xmath661 and @xmath662 have @xmath663 and @xmath664 global descents , we have @xmath665 thus @xmath657 is a graded coalgebra .",
    "let @xmath666 and @xmath667 the projection associated to the grading .",
    "let @xmath668 be the morphism of graded coalgebras into the cofree graded coalgebra on @xmath634 .",
    "for @xmath23 as above , proposition  [ p : highercop ] gives , @xmath669 among these chains @xmath670 of global descents of @xmath23 , there is the chain @xmath671 . in any other chain",
    "there must be at least one equality , say @xmath672 .",
    "then @xmath673 is the empty permutation and the corresponding term is just the identity @xmath70 , which is annihilated by @xmath674 .",
    "therefore , by  , @xmath647 is given by @xmath675 consider the map @xmath676 that sends @xmath677 where each @xmath678 and @xmath679 $ ] .",
    "lemma  [ l : over / under ] implies that @xmath680 , since each @xmath681 has no global descents .",
    "together with   this shows that @xmath682 .    on the other hand ,",
    "letting @xmath683 , lemma  [ l : higherglobal ] implies that @xmath684 this shows that @xmath685 . thus @xmath647 is an isomorphism of graded coalgebras .",
    "[ r : poirier ] if @xmath634 is finite dimensional then the graded dual of @xmath636 is simply the ( free ) tensor algebra @xmath686 .",
    "more generally , suppose @xmath687 is a graded vector space for which each component @xmath688 is finite dimensional .",
    "then @xmath636 admits another grading , for which the elements of @xmath689 have degree @xmath690 ( with respect to the other grading , these elements have degree @xmath181 ) . with respect to this new grading ,",
    "the homogeneous components are finite dimensional , and the graded dual of @xmath636 is the tensor algebra on the graded dual of @xmath634 ( again a free algebra ) .",
    "in our situation , @xmath691 , with @xmath634 graded by the size @xmath36 of the indexing permutations @xmath49 .",
    "the corresponding grading on @xmath0 is the original one , for which @xmath133 has degree @xmath36 if @xmath49 .",
    "its graded dual is therefore a free algebra .",
    "it is known that @xmath0 is self - dual with respect to this grading ( see section  [ s : duality ] ) .",
    "it follows that @xmath0 is also a free algebra .",
    "this is a result of poirier and reutenauer  @xcite who construct a different set of algebra generators , not directly related to the monomial basis .",
    "( see remark  [ r : comtet ] . )",
    "let @xmath692 be a graded connected coalgebra .",
    "the coradical @xmath693 of @xmath692 is the 1-dimensional component in degree 0 ( identified with the base field via the counit ) .",
    "the primitive elements of @xmath692 are @xmath694 set @xmath695 , the first level of the coradical filtration .",
    "more generally , the @xmath181-th level of the coradical filtration is @xmath696 we have @xmath697 , and @xmath698 thus , the coradical filtration measures the complexity of iterated coproducts .",
    "suppose now that @xmath692 is a cofree graded coalgebra @xmath636 .",
    "then the space of primitive elements is just @xmath634 , and the @xmath181-th level of the coradical filtration is @xmath699 .",
    "these are straightforward consequences of the definition of the deconcatenation coproduct .",
    "define @xmath700 in other words , @xmath701 and for @xmath498 , @xmath702    in proposition  [ p : galoisglobal ] we showed that @xmath312 is order - preserving . since @xmath7 is ranked by the cardinality of a subset , it follows that @xmath703 is a lower order ideal of @xmath2 , with @xmath704 .",
    "the coradical filtration corresponds precisely to this filtration of the weak order on the symmetric groups by lower ideals .",
    "[ c : coradical ] a linear basis for the @xmath181-th level of the coradical filtration of @xmath0 is @xmath705 in particular , a linear basis for the space of primitive elements is @xmath706    this follows from the preceding discussion .",
    "the original grading of @xmath707 yields a grading on the subspace @xmath708 of primitive elements and on each @xmath655 .",
    "let @xmath709 denote the hilbert series of the space of primitive elements , or equivalently , the generating function for the set of permutations in @xmath2 with no global descents , @xmath710 more generally , let @xmath711 be the hilbert series of @xmath655 , or equivalently , the generating function for permutations in @xmath2 with exactly @xmath712 global descents , @xmath713 for instance , @xmath714    there are well - known relationships between the hilbert series of a graded space @xmath634 , its powers @xmath715 and their sum @xmath636 . in our case , these give the following formulas .",
    "[ c : dimprimitive ] we have    1 .",
    "2 .   @xmath717 .",
    "3 .   @xmath718 .",
    "+    ' '' ''    [ r : comtet ] formula @xmath435 is analogous to a formula for ordinary descents in  ( * ? ? ?",
    "* example  2.2.4 ) .",
    "formulas @xmath436 and @xmath719 in corollary  [ c : dimprimitive ] are due to lentin  ( * ? ? ?",
    "* section 6.3 ) , see also comtet  ( * ? ? ? * exercise vi.14 ) .",
    "these references do not consider global descents , but rather the problem of decomposing a permutation @xmath49 as a non - trivial product @xmath720 .",
    "this is equivalent to our study of global descents , as we may write @xmath720 with @xmath423 exactly when @xmath721 is a global descent of @xmath722 .",
    "for instance , @xmath723 has global descents @xmath724 and @xmath725 .",
    "see the encyclopedia of integer sequences  @xcite ( a003319 and a059438 ) for additional references in this connection .",
    "poirier and reutenauer  @xcite showed that the elements of the dual basis @xmath726 indexed by the connected permutations freely generate @xmath727 .",
    "duchamp , hivert , and thibon dualize the resulting linear basis , giving a different basis than we do for the space of primitive elements  ( * ? ? ?",
    "we study the effect of the morphism of hopf algebras   @xmath728 on the monomial basis . here , we use subsets @xmath252 of @xmath28 $ ] to index monomial and fundamental quasi - symmetric functions of degree @xmath36 , as discussed at the end of section  [ s : hopfquasi ] .",
    "our main tool is the galois connection @xmath729 of section  [ s : descents ] .",
    "when we have a galois connection between posets @xmath280 and @xmath281 given by a pair of maps @xmath730 and @xmath731 as in  , a classical theorem of rota  ( * ? ? ?",
    "* theorem 1 ) states that the mbius functions of @xmath280 and @xmath281 are related by @xmath732 a conceptual proof of this simple but extremely useful result can be found in  @xcite .",
    "[ d : closed ] a permutation @xmath49 is _ closed _ if it is of the form @xmath733 for some @xmath734 .",
    "equivalently , in view of   and  , @xmath23 is closed if and only if @xmath735 .    from proposition [ p : galois",
    "] , we deduce the following fact about the mbius function of the weak order .",
    "let @xmath49 and @xmath310",
    ". then @xmath736    rota s formula says in this case that @xmath737 if @xmath23 is not closed , then the index set on the right hand side is empty . if @xmath23 is closed , then the index set consists only of the set @xmath738 , by assertion ( c ) in the proof of proposition [ p : galois ] .",
    "while there are explicit formulas for the mbius function of the weak order , it is precisely the above result that allows us to obtain the description of the map @xmath739 in terms of the monomial bases .",
    "[ t : map - monomial ] let @xmath49 .",
    "then @xmath740    by definition , @xmath741 , hence @xmath742 we complete the proof by noting that @xmath743 by the definition of @xmath135 , and that since @xmath23 is closed , @xmath735 .",
    "malvenuto shows that @xmath126 is a morphism of hopf algebras by comparing the structures on the fundamental bases of @xmath0 and @xmath3 .",
    "we do the same for the monomial bases of @xmath0 and @xmath3 .",
    "to compare the coproducts , first note that for any subsets @xmath744 $ ] and @xmath745 $ ] , @xmath746 therefore , if @xmath49 and @xmath747 , then @xmath748 it follows that applying the map @xmath739 to formula   gives the usual formula   for the coproduct of monomial quasi - symmetric functions .    for instance , we compare formula   with  . since @xmath749 and @xmath750 , applying @xmath126 to   results in  .",
    "indeed , the indices @xmath23 in the first row of   all are closed , while none in the second row are closed .",
    "it is easy to verify that the five terms on the right in the first row in   map to the five terms on the right in  .",
    "the situation is different for the products . the geometric description of the structure constants of the product on the monomial basis of @xmath0   admits an analogue for @xmath3 , but this turns out to be very different from the known description in terms of quasi - shuffles  .",
    "we present this new description of the structure constants for the product of monomial quasi - symmetric functions .",
    "the role of the permutahedron is now played by the cube . associating a subset @xmath252 of @xmath28 $ ] to its characteristic function gives a bijection between subsets of @xmath28 $ ] and vertices of the @xmath447-dimensional cube @xmath751^{n-1}$ ] .",
    "coordinatewise comparison corresponds to subset inclusion , and the 1-skeleton of the cube becomes the hasse diagram of the boolean poset @xmath7 . in this way",
    ", we identify @xmath7 with the vertices of the @xmath447-dimensional cube .    for each grassmannian permutation @xmath170 , consider the map @xmath752 we describe this map @xmath753 in more detail . to that end ,",
    "set @xmath754\\mid                    \\zeta^{-1}(i)+1=\\zeta^{-1}(i{+}1 )                    \\text { and }   \\zeta^{-1}(i)\\neq p\\}\\,,\\ ] ] and recall that the vertices in a face of the cube are an interval in the boolean poset , with every interval corresponding to a unique face .",
    "[ l : rzeta ] let @xmath260 be positive integers and @xmath235 .",
    "the image of @xmath753 is the face @xmath755\\,,\\ ] ] which is isomorphic to the boolean poset of subsets of @xmath756 .",
    "this is an immediate consequence of an alternative ( and direct ) description of @xmath757 . for @xmath758 ,",
    "set @xmath759 .",
    "then , for @xmath760 , we have @xmath761 assuming this for a moment , we note that the association @xmath762 is a bijection between @xmath763 and subsets of @xmath764 .",
    "intersecting with @xmath756 we obtain a surjection onto subsets of @xmath756 , which yields the desired description of the image of @xmath753 .",
    "we prove  .",
    "let @xmath760 and set @xmath765 so that @xmath766 .",
    "note that @xmath767 ( this is a particular case of lemma  [ l : over / under ] ) and if @xmath344 , then @xmath768 .",
    "let @xmath769 $ ] .",
    "we consider whether or not @xmath177 is a descent of @xmath19 .",
    "first , suppose @xmath770 . since the values @xmath771 and @xmath772 occur in order in the permutation @xmath773 (",
    "because @xmath235 ) , we must have @xmath774 and so @xmath775 , thus @xmath776 .",
    "now suppose that @xmath177 is not a descent of @xmath773 .",
    "if @xmath777 , then we must have @xmath778 , again because @xmath235 .",
    "hence @xmath779 and @xmath177 is not a descent of @xmath19 .",
    "if instead we have @xmath780 , then there are two cases to consider . if @xmath781 , then this forces @xmath195 to be @xmath782 so @xmath783 , and we conclude that @xmath177 is not a descent of @xmath19 . if @xmath784 , then @xmath785 and we see that @xmath177 is a descent of @xmath19 exactly when @xmath786 .",
    "this proves   and completes the proof of the lemma .",
    "unlike the case of the permutahedron , the image of @xmath753 need not be a facet .",
    "indeed , by lemma  [ l : rzeta ] , the image of @xmath753 is a facet only if @xmath787 , and this occurs only when @xmath788 or @xmath789 .",
    "figure  [ f : labelcube ] displays the vertices of the 3-cube and figure  [ f : typescube ] shows which faces occur as the image @xmath790 .",
    "@xmath791    @xmath792    observe that while not all faces occur as images of some @xmath790 , any face that does occur is the image of a unique such map .",
    "this is the general case .",
    "a face of @xmath7 is the image of @xmath793 under a map @xmath753 for at most one pair @xmath794 .",
    "suppose @xmath414 for some @xmath795",
    ". we will observe that the pair of sets @xmath796 and @xmath756 determines @xmath195 and @xmath47 uniquely by describing these sets .",
    "suppose first that @xmath797",
    ". then @xmath798 and @xmath799-\\{p\\}$ ] .",
    "suppose now that @xmath414 is not the identity permutation .",
    "then @xmath195 determines @xmath47 and @xmath800 .",
    "since the values @xmath771 and @xmath801 occur in order in @xmath773 , there exist numbers @xmath802 such that the values in @xmath58 $ ] occur in order in the intervals @xmath803 , [ a_1 + 1,b_1 ] , \\dotsc , [ a_k+1 , b_k]\\,,\\ ] ] and the values in @xmath804 in the complementary set .",
    "thus @xmath805 and @xmath799 - \\{b_0,a_1,b_1,a_2,\\ldots , a_k , b_k\\}$ ] .",
    "it follows that @xmath195 and @xmath47 determine and are determined by the sets @xmath796 and @xmath756 , which completes the proof of the lemma .",
    "[ t : prodmonqsym ] suppose @xmath260 are positive integers .",
    "let @xmath806 $ ] , @xmath807 $ ] and @xmath808 $ ] .",
    "the coefficient of @xmath809 in @xmath810 is @xmath811\\}\\,.\\ ] ] in other words , this coefficient counts the number of faces of the cube of type @xmath11 with the property that the vertex @xmath757 is below @xmath812 and it is the maximal vertex in the the face @xmath790 below @xmath812 .    by theorem  [ t : map - monomial ] , @xmath813 .",
    "we expand the product using theorem  [ t : prod - monomial ] , and then apply the map @xmath126 and theorem  [ t : map - monomial ] to obtain @xmath814 according to  , @xmath815\\}\\,.\\ ] ] by proposition  [ p : galois ] , for any @xmath252 , @xmath261 , and @xmath812 we have @xmath816 in other words , @xmath817 this implies that the structure constant @xmath818 is as stated .",
    "we give an example .",
    "let @xmath819 , @xmath820 , @xmath821 and @xmath822 . in terms of compositions , we have @xmath823 , and @xmath824 .",
    "equation   gives @xmath825 on the other hand , also predicts that the coefficient of @xmath826 is @xmath827 .",
    "of the four possible faces of type @xmath828 , only two satisfy the required condition .",
    "one corresponds to the shuffle @xmath562 ( it is a facet ) and the other to @xmath829 ( it is an edge ) .",
    "they are shown in figure  [ f : alphacube ] , together with the vertices @xmath830 , @xmath831 , and the vertex @xmath550 .",
    "we obtain a decomposition of the algebra structure of @xmath0 as a crossed product over the hopf algebra @xmath3 .",
    "we refer the reader to  @xcite for a review of this construction in the general hopf algebraic setting .",
    "let us only say that the crossed product of a hopf algebra @xmath833 with an algebra @xmath834 with respect to a hopf cocycle @xmath835 is a certain algebra structure on the space @xmath836 , denoted by @xmath837 .",
    "the map @xmath838 , @xmath839 , is a morphism of coalgebras and a right inverse to the morphism of hopf algebras @xmath136 .",
    "this is immediate from theorems  [ t : cop - monomial ] and  [ t : map - monomial ] .",
    "in this situation , an important theorem of blattner , cohen , and montgomery  @xcite applies .",
    "namely , suppose @xmath840 is a morphism of hopf algebras that admits a coalgebra splitting ( right inverse ) @xmath841 .",
    "then there is a _ crossed product _",
    "decomposition @xmath842 where @xmath834 , a subalgebra of @xmath30 , is the _ left hopf kernel _ of @xmath493 : @xmath843 and the _ hopf cocycle _",
    "@xmath835 is @xmath844 this result , as well as some generalizations , can be found in  @xcite .",
    "note that if @xmath493 and @xmath96 preserve gradings , then so does the rest of the structure .",
    "let @xmath834 be the left hopf kernel of @xmath136 and @xmath845 its @xmath36-th homogeneous component .",
    "once again the monomial basis of @xmath0 proves useful in describing @xmath834 .",
    "a basis for @xmath845 is the set @xmath5 where @xmath23 runs over all permutations of @xmath36 that are not of the form @xmath846 for any @xmath847 . in particular , @xmath848    by the theorem of blattner , cohen , and montgomery , @xmath849 , in particular @xmath850 as vector spaces .",
    "the generating functions for the dimensions of these algebras are therefore related by @xmath851 it follows that @xmath852 as claimed .",
    "observe that @xmath853 counts the permutations in @xmath2 that are not of the form .",
    "since the @xmath133 are linearly independent , it suffices to show that if @xmath23 is not of that form then @xmath133 is in the hopf kernel .",
    "now , for any @xmath49 and @xmath854 , we have that @xmath855 . hence , if @xmath23 is not of the form , the same is true of @xmath856 and therefore this permutation is not closed .",
    "it follows from theorems  [ t : cop - monomial ] and  [ t : map - monomial ] that @xmath857 .",
    "these results were motivated by a question of nantel bergeron , who asked ( in dual form ) if @xmath0 is cofree as right comodule over @xmath3 .",
    "this is an immediate consequence of the crossed product decomposition .",
    "consider again the general situation of a morphism of hopf algebras @xmath840 with a coalgebra splitting @xmath841 .",
    "this induces an exact sequence of lie algebras @xmath858 with a linear splitting @xmath859 , where @xmath860 denotes the space of primitive elements of @xmath30 , viewed as a lie algebra under the commutator bracket @xmath861=hh'-h'h$ ] .",
    "the hopf cocycle restricts to a linear map @xmath862 ; in fact , for primitive elements @xmath181 and @xmath863 , specializes to @xmath864 and a direct calculation shows that this element of @xmath30 is primitive .",
    "moreover , the lie cocycle corresponding to is the map @xmath865 given by @xmath866-\\gamma(\\left[k , k'\\right ] ) = \\sigma(k , k')-\\sigma(k',k ) \\,.\\ ] ] this map is a non - abelian lie cocycle in the sense that the following conditions hold . for @xmath181 , @xmath867 and @xmath868 , @xmath869+\\left[k ,",
    "k'\\right]\\cdot a \\\\",
    "k\\cdot\\tilde{\\sigma}(k',k'')-k'\\cdot\\tilde{\\sigma}(k , k'')+ k''\\cdot\\tilde{\\sigma}(k , k')=\\tilde{\\sigma}(\\left[k , k'\\right],k'')- \\tilde{\\sigma}(\\left[k , k''\\right],k')+\\tilde{\\sigma}(\\left[k',k''\\right],k )   \\end{gathered}\\ ] ] where @xmath870 $ ] .",
    "let us apply these considerations to the morphism @xmath871 and the coalgebra splitting @xmath872 .",
    "the structure constants of the hopf cocycle @xmath873 do not have constant sign . however , its restriction to primitive elements of @xmath3 has non - negative structure constants on the monomial bases .",
    "they turn out to be particular structure constants of the product of @xmath0 .    recall that these structure constants @xmath441 are defined for @xmath12 , @xmath13 and @xmath15 by the identity @xmath874 the combinatorial description of these constants showing their non - negativity",
    "is given by  .",
    "[ l : struc - constants ] for @xmath875 , and @xmath876 closed , we have @xmath877 except in the following cases @xmath878    apply the map @xmath126 to the product @xmath879 to obtain ( using ) @xmath880 the result is immediate , as @xmath881 unless @xmath19 is closed , and we have @xmath882 and @xmath883 .",
    "we use this lemma to give a combinatorial description of @xmath873 and the lie cocycle @xmath884 on primitive elements . by",
    ", @xmath885 is a linear basis for the space of primitive elements of @xmath3 .",
    "thus @xmath886 is an abelian lie algebra with each homogeneous component of dimension @xmath70 .",
    "recall that @xmath887 is a basis of the primitive elements of @xmath0 , and thus @xmath888 has a basis given by those @xmath133 where @xmath23 has no global descents and @xmath23 is not an identity permutation , @xmath149 .",
    "[ p : cocycle ] for any @xmath47 , @xmath889 , @xmath890    since @xmath891 ,   gives @xmath892 using   and  , we compute @xmath893 and @xmath894 .",
    "therefore , @xmath895    the formula for @xmath896 follows by expanding the product and using lemma  [ l : struc - constants ] .",
    "the expression for @xmath884 follows immediately from  .",
    "the hopf algebra @xmath0 is self - dual .",
    "this appears in  @xcite ,  ( * ? ? ?",
    "* theorem 3.3 ) , and  @xcite .",
    "we provide a proof below , for completeness .",
    "we investigate the combinatorial implications of this self - duality , particularly when expressed in terms of the monomial basis .",
    "we explain how a result of foata and schtzenberger on the numbers @xmath897 is a consequence of self - duality of @xmath0 and obtain analogous results for the numbers @xmath898 the hopf algebra @xmath0 is connected and graded with each homogeneous component finite dimensional .",
    "we consider its _ graded dual _",
    "@xmath727 whose homogeneous component in degree @xmath36 is the linear dual of the homogeneous component in degree @xmath36 of @xmath0 .",
    "let @xmath899 and @xmath900 be the bases of @xmath727 dual to the fundamental and monomial bases of @xmath0 , respectively .",
    "@xmath727 is another graded connected hopf algebra .",
    "_ note that @xmath903 .",
    "therefore , it suffices to show that @xmath904 is a morphism of coalgebras .",
    "we rewrite the product   of @xmath0 .",
    "let @xmath12 and @xmath13 .",
    "then @xmath905 therefore the ( dual ) coproduct of @xmath727 is @xmath906 on the other hand , as observed in  [ r : loday ] , the coproduct of @xmath0 can be written as @xmath907 it follows that @xmath904 is a morphism of coalgebras because @xmath908      formula   for the morphism @xmath904 of hopf algebras has combinatorial implications which we develop . recall that @xmath912 and @xmath913 denote the structure constants of the product and antipode of @xmath0 in terms of the monomial basis .",
    "these integers were described in theorems  [ t : prod - monomial ] and  [ t : ant - monomial ] .",
    "consider @xmath914 , @xmath915 , and @xmath916 to be matrices with rows and columns indexed by elements of @xmath2 .",
    "by lemma  [ l : global ] , the coproduct of @xmath0   can be written as @xmath919 therefore , the dual product is @xmath920 thus , the right hand side of  ( _ i _ ) is the coefficient of @xmath16 in @xmath921 . on the other hand , since @xmath922 , we have @xmath923 thus the left hand side of  ( _ i _ ) is the coefficient of @xmath16 in @xmath924 . since @xmath904 is a morphism of algebras ,  ( _ i _ ) holds .",
    "one may view theorem  [ t : theta - form](_i _ ) as a recursion reducing the computation of @xmath925 to the case when @xmath23 and @xmath145 have no global descents , by virtue of lemma  [ l : global ] . on the other hand ,",
    "since @xmath914 is an invertible matrix , this provides another semi - combinatorial description of the structure constants @xmath912 .",
    "one may also impose the condition that @xmath904 preserves coproducts , but this leads again to ( _ i _ ) of theorem  [ t : theta - form ] . on the other hand",
    ", the equivalent of ( _ ii _ ) of theorem  [ t : theta - form ] for the fundamental basis leads to the following non - trivial identity .    for any @xmath23 and @xmath138 , @xmath926\\mid { \\mathrm{des}}(vu_{\\mathsf{s}})\\subseteq{\\mathsf{s}}\\text { and $ \\#{\\mathsf{s}}$ is odd}\\}\\\\      \\shoveleft{+ \\#\\{{\\mathsf{s}}\\subseteq[n{-}1]\\mid{\\mathrm{des}}(uv_{\\mathsf{s}})\\subseteq{\\mathsf{s}}\\text { and $ \\#{\\mathsf{s}}$ is even}\\ } } \\\\",
    "\\shoveright{=\\ \\#\\{{\\mathsf{s}}\\subseteq[n{-}1]\\mid { \\mathrm{des}}(vu_{\\mathsf{s}})\\subseteq{\\mathsf{s}}\\text { and $ \\#{\\mathsf{s}}$ is even}\\}\\quad}\\\\      + \\#\\{{\\mathsf{s}}\\subseteq[n{-}1]\\mid { \\mathrm{des}}(uv_{\\mathsf{s}})\\subseteq{\\mathsf{s}}\\text { and $ \\#{\\mathsf{s}}$ is odd}\\}\\ , .",
    "\\end{gathered}\\ ] ]    the formula above is equivalent to @xmath927 where @xmath928 is the structure constant for the antipode with respect to the fundamental basis , as proven in theorem  [ t : ant - fundamental ] . but   expresses that @xmath904 preserves antipodes ( on the fundamental basis and its dual ) .",
    "we turn now to quasi - symmetric functions .",
    "the dual @xmath929 of @xmath3 is the hopf algebra of _ non - commutative symmetric functions _ of gelfand , et .",
    "al .  @xcite .",
    "it is the free associative algebra with generators @xmath930 .",
    "this statement is dual to formula   for the coproduct of @xmath3 .        since @xmath936 ,",
    "the dual map satisfies @xmath937 . also , theorem [ t : map - monomial ] dualizes to @xmath938 .",
    "the descriptions of the composite above follow now from those for @xmath904 in   and  , plus that @xmath939 , which in turn follows from .",
    "we now use the fact that @xmath940 is a morphism of hopf algebras .",
    "the image of @xmath932 is precisely the subalgebra of @xmath3 consisting of _ symmetric _ functions .",
    "since @xmath929 is generated by @xmath930 , its image @xmath941 is generated by @xmath942 , for @xmath943 .",
    "observe that @xmath944 for every @xmath734 as @xmath149 is the only permutation @xmath23 in @xmath2 with @xmath945 and @xmath946 .",
    "thus @xmath947 formula   shows that @xmath948 is the complete homogeneous symmetric function of degree @xmath36 .",
    "these generate the algebra of symmetric functions  @xcite .",
    "thus , @xmath932 is the _ abelianization _ map from non - commutative to commutative symmetric functions .",
    "we will not use this , but rather the explicit expression of @xmath932 of proposition  [ p : qsymdual ] .",
    "let @xmath949 denote the structure constants of the product of @xmath3 with respect to its monomial basis .",
    "these integers are combinatorially described by or .",
    "the following analog of theorem  [ t : theta - form ] provides a recursion for computing the numbers @xmath950 in terms of the structure constants @xmath949 .",
    "we view @xmath951 and @xmath952 as matrices with entries indexed by subsets of @xmath28 $ ] .",
    "the dual of the coproduct of @xmath3   is @xmath954 thus , the right hand side of is the coefficient of @xmath955 in @xmath956 . on the other hand , since @xmath957 , we have @xmath958 thus the left hand side of   is the coefficient of @xmath955 in @xmath959 . since @xmath932 is a morphism of algebras ,   holds .    expressing that @xmath904 preserves the antipode in terms of the fundamental basis and its dual gives a result of foata and schtzenberger  @xcite , which gessel obtained in his original work on quasi - symmetric functions by other means  (",
    "* corollary 6 ) ( equation ( _ iv _ ) in the following corollary ) . for @xmath400 $ ] ,",
    "define @xmath960\\mid i\\notin{\\mathsf{s}}\\}\\\\     \\widetilde{{\\mathsf{s}}}&\\ = \\",
    "\\{i\\in[n{-}1]\\mid n - i\\in{\\mathsf{s}}\\}\\ , .   \\end{aligned}\\ ] ]          the antipode of @xmath3 is  ( * ? ? ?",
    "* corollaire 4.20 ) @xmath971 since @xmath932 preserves antipodes , its explicit description in proposition  [ p : qsymdual ] implies that @xmath972 . together with ( _ ii _ ) this yields ( _ iii _ ) .            as mentioned in",
    ", the antipode of @xmath3 is @xmath982 combining this with proposition [ p : qsymdual ] shows that @xmath983 sends @xmath984 thus , we have to show that for each @xmath252 and @xmath812 , @xmath985 now , @xmath986 } ( -1)^{n }        \\#\\{u\\mid { \\mathrm{des}}(u)\\subseteq{\\mathsf{s}},\\ { \\mathrm{des}}(u^{-1})={\\mathsf{t}}'\\}\\\\      & \\ = \\   ( -1)^{n } \\#\\{u\\mid { \\mathrm{des}}(u)\\subseteq{\\mathsf{s}},\\      { \\mathrm{des}}(u^{-1})\\cup{\\mathsf{r}}=[n{-}1]\\}\\\\      & \\ = \\ ( -1)^{n } \\#\\{u\\mid { \\mathrm{des}}(u)\\subseteq{\\mathsf{s}},\\          { \\mathrm{des}}(u^{-1})\\supseteq{\\mathsf{r}}^c\\ } \\\\      & \\ = \\ ( -1)^{n}c({\\mathsf{s}},{\\mathsf{r}}^c)\\ , .       \\end{aligned}\\ ] ]                          grard duchamp , florent hivert , and jean - yves thibon , _ some generalizations of quasi - symmetric functions and noncommutative symmetric functions _ , formal power series and algebraic combinatorics ( moscow , 2000 ) , springer , berlin , 2000 , pp .",
    "170178 .",
    "grard duchamp , florent hivert , and jean - yves thibon , _ noncommutative symmetric functions vi : free quasi - symmetric functions and related algebras _ ,",
    "internat . j. algebra comput .",
    "* 12 * ( 2002 ) , no . 5 , 671717 .",
    "claudia malvenuto , _ produits et coproduits des fonctions quasi - symtriques et de lalgbre des descents _ , no .  16 , laboratoire de combinatoire et dinformatique mathmatique ( lacim ) , univ .",
    "du qubec  montral , montral , 1994 .",
    "gian - carlo rota , _ on the foundations of combinatorial theory .",
    "i. theory of mbius functions _ , z. wahrscheinlichkeitstheorie und verw .",
    "gebiete * 2 * ( 1964 ) , 340368 ( 1964 ) , reprinted in _ gian - carlo rota on combinatorics : introductory papers and commentaries _ ( joseph p.s .",
    "kung , ed . ) , birkhuser , boston , 1995 .",
    "neil j.  a.  sloane , _ an on - line version of the encyclopedia of integer sequences _ , electron .",
    "j. combin .",
    "* 1 * ( 1994 ) , feature 1 , approx .  5 pp .",
    "( electronic ) , http://akpublic.research.att.com/~njas/sequences/ol.html ."
  ],
  "abstract_text": [
    "<S> we analyze the structure of the malvenuto - reutenauer hopf algebra @xmath0 of permutations in detail . </S>",
    "<S> we give explicit formulas for its antipode , prove that it is a cofree coalgebra , determine its primitive elements and its coradical filtration , and show that it decomposes as a crossed product over the hopf algebra of quasi - symmetric functions . </S>",
    "<S> in addition , we describe the structure constants of the multiplication as a certain number of facets of the permutahedron . as a consequence </S>",
    "<S> we obtain a new interpretation of the product of monomial quasi - symmetric functions in terms of the facial structure of the cube . </S>",
    "<S> the hopf algebra of malvenuto and reutenauer has a linear basis indexed by permutations . </S>",
    "<S> our results are obtained from a combinatorial description of the hopf algebraic structure with respect to a new basis for this algebra , related to the original one via mbius inversion on the weak order on the symmetric groups . </S>",
    "<S> this is in analogy with the relationship between the monomial and fundamental bases of the algebra of quasi - symmetric functions . </S>",
    "<S> our results reveal a close relationship between the structure of the malvenuto - reutenauer hopf algebra and the weak order on the symmetric groups . </S>"
  ]
}