{
  "article_text": [
    "the accurate numerical simulation of fluid flow in porous media is important in many applications ranging from hydrocarbon production and groundwater flow to catalysis and the gas diffusion layers in fuel cells  @xcite .",
    "examples include the behavior of liquid oil and gas in porous rock  @xcite , permeation of liquid in fibrous sheets such as paper  @xcite , determining flow in underground reservoirs and the propagation of chemical contaminants in the vadose zone  @xcite , assessing the effectiveness of leaching processes  @xcite and optimizing filtration and sedimentation operations  @xcite .",
    "an important and experimentally determinable property of porous media is the permeability , which is highly sensitive to the underlying microstructure .",
    "comparison of experimental data to numerically obtained permeabilities can improve the understanding of the influence of different microstructures and assist in the characterization of the material .",
    "before the 1990 s the computational power available was very limited restricting all simulations either to small length scales or low resolution of the microstructure .",
    "shortly after its introduction lattice - boltzmann ( @xmath0 ) simulations became popular  @xcite as an alternative to a direct numerical solution of the stokes equation  @xcite for simulating fluid flow in complex geometries .",
    "historically , the @xmath0  method was developed from the lattice gas automata  @xcite .",
    "in contrast to its predecessor , in the @xmath0  method the number of particles in each lattice direction is replaced with the ensemble average of the single particle distribution function , and the discrete collision rule is replaced by a linear collision operator .    in the @xmath0  method",
    "all computations involve local variables so that it can be parallelized easily  @xcite . with the advent of more powerful computers it became possible to perform detailed simulations of flow in",
    "artificially generated geometries  @xcite , tomographic reconstructions of sandstone samples  @xcite , or fibrous sheets of paper  @xcite .",
    "the accuracy of @xmath0  simulations of flow in porous media depends on several conditions .",
    "these include the resolution of the discretization of the porous medium , proper boundary conditions to drive the flow and to implement the solid structure or the choice of the collision kernel .",
    "even though advanced boundary conditions , discretization methods , as well as higher order @xmath0   kernels have been developed and are common in the literature , it is surprising to the authors that they only found limited applications so far . in particular for commercial applications",
    "a three - dimensional implementation with 19 discrete velocities and a single relaxation time linearized collision operator is still the de - facto standard to calculate stationary velocity fields and absolute permeabilities for porous media  @xcite . here ,",
    "the flow is usually driven by a uniform body force to implement a pressure gradient and solid surfaces are generated by simple bounce back boundary conditions .",
    "the present work is motivated by the question whether permeabilities calculated by this standard @xmath0  approach can be considered to be accurate . in particular , it is important to understand where the limits of this method are and how the accuracy can be increased .",
    "we quantify the impact of details of the implementation by studying 3d poiseuille flow in pipes of different shape and resolution and comparing the simulation results to analytical solutions .",
    "this allows to demonstrate how simple improvements of the simulation paradigm can lead to a substantial reduction of the error in the measured permeabilities .",
    "these include a suitable choice of the relaxation parameter @xmath1 and the application of the multirelaxation time method in order to ascertain a minimal unphysical influence of the fluid viscosity on the permeability .",
    "further , a correct implementation of the body force to drive the flow together with suitable in- and outflow boundaries is mandatory to avoid artifacts in the steady state velocity field .",
    "finally , the small compressibility of the @xmath0  fluid requires a proper determination of the pressure gradient in the system .",
    "if these details are taken care of , it is shown that the @xmath0  method is well suitable for accurate permeability calculations of stochastic porous media by applying it to discretized micro computer - tomography ( @xmath2 ) data of a fontainebleau sandstone .",
    "the boltzmann equation @xmath3 describes the evolution of the single particle probability density @xmath4 , where @xmath5 is the position vector , @xmath6 is the velocity vector , @xmath7 is the time , and @xmath8 is the collision operator . while discretizations on unstructured grids exists  @xcite , they are not widely used and typically the position @xmath9 is discretized on a structured cubic lattice , with lattice constant @xmath10 .",
    "the time is discretized using a time step @xmath11 and the velocities are discretized into a finite set of vectors @xmath12 with @xmath13 , called lattice velocities , where the finite integer @xmath14 varies between implementations . in this work",
    "we exclusively use the so - called d3q19 lattice , where @xmath15 velocities are used in a three dimensional domain  @xcite . a cubic lattice with basis @xmath16",
    ", @xmath17 is embedded into @xmath18 using the coordinate function @xmath19 to map the lattice nodes @xmath20 to position vectors @xmath21 .",
    "the computational domain is a rectangular parallelepiped denoted as @xmath22 where @xmath23 are its dimensionless side - lengths .",
    "see fig .",
    "[ fig : permcalc ] for a visualization .",
    "physical quantities @xmath24 such as pressure or density on the lattice are abbreviated as @xmath25 .",
    "we introduce the vector notation @xmath26 , where the components are the probabilities calculated as @xmath27 here , @xmath28 is the finite volume associated with the point @xmath29 and @xmath30 is the volume in velocity space given by lattice velocity @xmath12 .",
    "the macroscopic density @xmath31 and velocity @xmath32 are obtained from @xmath33 as @xmath34 where @xmath35 is a reference density . the pressure is given by @xmath36 with the speed of sound  @xcite @xmath37    discretization of eq .",
    "provides the basic system of difference equations in the @xmath0  method @xmath38 with @xmath39 and the initial condition @xmath40 ( for @xmath41 ) .",
    "the generally nonlinear collision operator is approximated using the linearization @xmath42 around a local equilibrium probability function , with a @xmath43 collision matrix @xmath44  @xcite .    the simplest approach to define the collision matrix uses a single relaxation time with time constant @xmath1 , @xmath45 where @xmath46 is the kronecker delta .",
    "this single relaxation time ( @xmath47 ) scheme is named after the original work of bhatnagar , gross and krook  @xcite . within the @xmath47  method , @xmath48 is approximated by a second order taylor expansion of the maxwell distribution  @xcite , @xmath49 if external forces are absent , the equilibrium velocity is defined as @xmath50 from eq .  .",
    "as explained further below , @xmath51 and @xmath32 may differ from eq .   if an external acceleration is present .",
    "the numbers @xmath52 are called lattice weights and differ with lattice type , number of space dimensions and number of discrete velocities @xmath14 . see  @xcite for a comprehensive overview on different lattices .",
    "an alternative approach to specify the collision matrix is the multirelaxation time ( @xmath53 ) method .",
    "here , a linear transformation @xmath54 is chosen such that the moments @xmath55 represent hydrodynamic modes of the problem .",
    "we use the definitions given in  @xcite , where @xmath56 is the density defined in eq .",
    ", @xmath57 represents the energy , @xmath58 with @xmath59 the momentum flux and @xmath58 , with @xmath60 are components of the symmetric traceless stress tensor . introducing the moment vector @xmath61 , @xmath62 , a diagonal matrix @xmath63 , and the equilibrium moment vector @xmath64",
    ", we obtain @xmath65 during the collision step the density and the momentum flux are conserved so that @xmath66 and @xmath67 with @xmath68 .",
    "the non - conserved equilibrium moments @xmath69 , @xmath70 , are assumed to be functions of these conserved moments and explicitly given e.g. in  @xcite .",
    "the diagonal element @xmath71 in the collision matrix is the relaxation time moment @xmath58 .",
    "one has @xmath72 , because the corresponding moments are conserved , @xmath73 describes the relaxation of the energy and @xmath74 the relaxation of the stress tensor components .",
    "the remaining diagonal elements of @xmath75 are chosen as @xmath76 to optimize the algorithm performance  @xcite .",
    "because two parameters @xmath1 and @xmath77 remain free , the multirelaxation time method reduces to a `` two relaxation time '' ( @xmath78 ) method .",
    "an alternative @xmath78  implementation can be found in  @xcite .",
    "to apply the @xmath0  method to viscous flow in porous media it is necessary to establish its relations with hydrodynamics .",
    "the chapman - enskog procedure shows that density , velocity and pressure fulfill the navier - stokes equations without external forces , with a kinematic viscosity  @xcite @xmath79 combining eq .",
    "and eq .   gives @xmath80 because @xmath81 , @xmath82 , and @xmath83 , it follows that @xmath84 .",
    "a typical value for the pore diameter in sandstone is @xmath85 , and for water the kinematic viscosity and speed of sound are @xmath86 and @xmath87 , respectively . with typical velocities of order @xmath88",
    "the reynolds number is @xmath89 .",
    "discretizing with @xmath90 gives then @xmath91 . because for @xmath92 the @xmath0  method is known to be unstable , a direct simulation of water flow in porous media with these parameters is not feasible . to overcome this impasse",
    ", one might impose @xmath93 and simultaneously fix @xmath94 and @xmath95 as fluid parameters .",
    "the discretization then is @xmath96 and @xmath97 again , a simulation with these parameters is not possible because a typical pore with diameter @xmath98 would have to be represented by @xmath99 nodes , exceeding realistic memory capacities .",
    "another way to circumvent these problems is to appeal to hydrodynamic similarity for stationary flows .",
    "the simulations in this paper are performed with fluid parameters that represent a pseudofluid with the same viscosity as water , but @xmath100 as the speed of sound .",
    "the discretization then is @xmath101 and @xmath102 .",
    "a pore of diameter @xmath103 is then represented by @xmath104 nodes and a cubic sample with side - length @xmath105 requires @xmath106 nodes , a manageable system size on parallel computers . an external force , as discussed next , drives the flow such that the velocities are of order @xmath107 .",
    "the mach and reynolds numbers in the simulations are @xmath108 and @xmath109 , characterizing a laminar subsonic flow .",
    "as long as @xmath110 and hydrodynamic similarity remains valid , we do not expect that the parameters of the pseudofluid will change the permeability estimate .",
    "an external acceleration @xmath111 acting on the fluid is implemented by adding two modifications .",
    "first , a forcing term written as a power series in the velocity  @xcite @xmath112 is added to the right hand side of eq .  .",
    "second , eq .   for the equilibrium velocity @xmath113 in eq .   needs to be modified .",
    "the parameters of order 0 , 1 , and 2 in the expansion are @xmath114 , @xmath115 , and @xmath116 .",
    "the definition of the velocities @xmath51 and @xmath32 differ with the method used . we present four possible implementations which all assume @xmath117 , since otherwise a source term in the mass balance would have to be taken into account .",
    "the sums in this paragraph run from @xmath118 and the quantities @xmath115 , @xmath116 , @xmath119 , @xmath120 , @xmath113 , and @xmath121 are functions of @xmath122 and @xmath123 unless specified otherwise .    the first method to implement a body force is referred to as @xmath124  in the remainder of the paper .",
    "it uses @xmath125 and a modified definition of @xmath113 and @xmath120 which causes the influence of temporal and spatial derivatives of @xmath121 on the density and momentum changes to vanish . for this method one",
    "obtains @xmath126 , with @xmath127 instead of eq .  . a multiscale expansion in time of the resulting discrete @xmath0  equation yields that the macroscopic density @xmath128 and velocity @xmath120 recover the navier - stokes equations with an external body force term  @xcite .",
    "the forcing is applied in two steps during every time step @xmath11 , one half within the collision step by the definition of @xmath113 and the second half within the streaming step by the term @xmath129 . in the case of @xmath130",
    "the part which is applied during the collision step is added to the modes @xmath58 with @xmath59 , which represent the momentum flux .    the second method ( @xmath131 )",
    "is defined by setting @xmath132 so that @xmath133 does not depend on @xmath51 .",
    "the full acceleration is applied only within the streaming step through the term @xmath133 .",
    "one sets @xmath134 and the macroscopic velocity @xmath120 defined as in eq .  .",
    "this simplification is useful because it reduces the computational effort , but it is restricted to stationary flows . in our simulations",
    "@xmath135 is time independent and we are mainly interested in the permeability and stationary flows so that we have adopted @xmath131 in our simulations below . in @xmath131",
    "the macroscopic fields fulfill mass balance , but some additional unphysical terms appear in the momentum balance  @xcite . here",
    "we assume that all these additional terms are negligible or vanish for stationary flows , because we expect that all spatial gradients are sufficiently small .",
    "@xmath136  is intended for constant @xmath121 and uses the same parameters @xmath115 and @xmath116 as @xmath131  @xcite .",
    "however , the macroscopic velocity @xmath137 is calculated as in eq .  .",
    "this recovers momentum balance , because unphysical terms either vanish or are negligible , but it does not recover mass balance , which in this case reads @xmath138 the reason is an inaccurate calculation of the macroscopic velocity @xmath32  @xcite .",
    "the impact of this issue on the simulation results is shown in sec .",
    "[ diffperm : sec ] .",
    "@xmath139  suggests to incorporate the acceleration not by using the forcing term , but by adding the term @xmath140 to the equilibrium velocity @xmath51 .",
    "the macroscopic velocity @xmath32 remains calculated by eq .",
    "this is equivalent to using the forcing term with @xmath141 and @xmath137 given by eq .  .",
    "this implementation leads to the same drawback in the mass balance equation as in @xmath136 .",
    "the most common boundary conditions ( @xmath142 ) used jointly within @xmath0  implementations are periodic ( @xmath143 ) and no - slip @xmath142 . when using @xmath143 , fluid that leaves the domain , i.e. , the term @xmath144 in eq .",
    "exceeds the computational domain size , enters the domain from the other side .",
    "the no - slip @xmath142 , also called simple bounce - back rule ( @xmath145 ) , approximates vanishing velocities at solid surfaces  @xcite . if the lattice point @xmath146 in eq .",
    "represents a solid node , the discrete @xmath0  equation is rewritten as @xmath147 where the probability function @xmath148 is associated with @xmath149 , where is the probability function in opposite direction to @xmath119 .",
    "midplane @xmath142",
    "@xcite improve the @xmath145  eliminating the zig - zag profile when plotting the mass flow @xmath150 vs. @xmath151 , but yield the same mass flow @xmath152 , see eqs .   and   for their definition , respectively .",
    "the @xmath145  scheme depends on viscosity and relaxation time @xmath1 , especially in under - relaxed simulations ( large values of @xmath1 )  @xcite .",
    "the numerically exact position of the fluid - solid interface changes slightly for different @xmath1 which can pose a severe problem when simulating flow within porous media , where some channels might only be a few lattice units wide .",
    "the permeability @xmath153 , being a material constant of the porous medium alone , becomes dependent on the fluid viscosity .",
    "as demonstrated below within the @xmath130  method this @xmath153-@xmath1 correlation is significantly smaller than within @xmath47  @xcite .",
    "recently , further improvements for no - slip @xmath142  have been discussed  @xcite .",
    "most of these implementations use a spatial interpolation .",
    "for example , linearly and quadratic interpolated bounce - back  @xcite , or multireflection  @xcite . to calculate boundary effects these methods use multiple nodes in the vicinity of the surface . for this reason these schemes are unsuitable in porous media where some pore",
    "throats might be represented by 2 or 3  nodes only .",
    "consequently , we use midplane @xmath142  as well as @xmath143  for our simulations .    to drive the flow on - site pressure or flux",
    "@xmath142  @xcite may be used . using them it is possible to exactly set the ideal gas pressure ( or density , see eq .  ) or flux on a specific node .",
    "thus , creating a pressure gradient by fixing either the pressure or the mass flux at the inlet and outlet nodes are feasible alternatives .",
    "the computational domain @xmath154 .",
    "the ( porous ) sample is @xmath155 , and the fluid is accelerated in the acceleration zone @xmath156 .",
    "two fluid chambers @xmath157 and @xmath158 are used to avoid artifacts . ]    the computational domain ( see fig .  [",
    "fig : permcalc ] ) @xmath154 is composed of three zones : the sample @xmath155 describing the geometry and two chambers @xmath157 ( inlet ) and @xmath158 ( outlet ) , before and after the sample , containing fluid reservoirs . the notation @xmath159 denotes a cross - section , where @xmath160 , @xmath161 , @xmath162 , and @xmath163 represent the cross - sections right before the sample ( @xmath164 ) , the first ( @xmath165 ) , and last ( @xmath166 ) cross - section within the sample , and the cross - section right after the sample ( @xmath167 ) , respectively .",
    "every lattice point ( node ) in @xmath154 is either part of the matrix , denoted @xmath168 , or part of the fluid , denoted @xmath169 , so that @xmath170 and @xmath171 .",
    "results are presented in the dimensionless quantities @xmath172 where the discretization parameters @xmath10 and @xmath11 are chosen according to the analysis presented in sec .",
    "[ simmeth : sec ] . unless otherwise noted , the relaxation time is @xmath173 and for @xmath130  simulations @xmath174 is used .",
    "generally , results from @xmath0  simulations are labeled with the superscript `` @xmath175 '' , e.g. , the density @xmath176 .",
    "if the results refer to a specific implementation ( @xmath177  or @xmath53 ) they are labeled accordingly , e.g. , @xmath178 or @xmath179 .    the fluid is driven using model  b. the acceleration @xmath180 is not applied throughout the whole domain but only within the acceleration zone @xmath181 .",
    "an acceleration of @xmath182 is used for all simulations .",
    "the average for a physical quantity @xmath24 is @xmath183 with the domain @xmath184 and @xmath185 the number of nodes in that domain .",
    "the mass flow @xmath150 through a cross - section @xmath186 is given by @xmath187 with @xmath188 being the momentum component in direction of the flow .",
    "the mass flow through the whole domain is @xmath189",
    "to calibrate the simulation we simulate poiseuille flow in pipes with quadratic cross - section .",
    "the simulation parameters are defined by @xmath190 where @xmath191 and @xmath192 .",
    "the system dimensions are @xmath193 , with @xmath194 the channel width .    according to ref .",
    "@xcite the analytical solution for the velocity component in flow direction in a pipe with quadratic cross - section is @xmath195 where @xmath196,{x_{{2}}}\\in[-b/2,b/2]$ ] .",
    "the cartesian coordinates @xmath197 and @xmath198 have their origin in the center of the pipe .",
    "@xmath199 is the pressure gradient in flow direction and @xmath200 the dynamic viscosity .",
    "the expression @xmath201 is asymmetric in @xmath197 and @xmath198 .",
    "contrary to the no - slip condition the velocities @xmath202 are not zero for finite @xmath203 . to estimate the truncation error we define @xmath204,\\\\\\ ] ] and @xmath205 with @xmath206 being the normalized velocities on the wall calculated from eq .  .",
    "@xmath207 quantifies the truncation error at finite @xmath203 . requiring that the truncation error @xmath208 is at least three to four decades smaller than the velocities in the corners , for example @xmath209 or any other such corner velocity , yields @xmath210 . for all further comparisons with @xmath0simulations we use @xmath211 .",
    "if @xmath203 is chosen too small , a meaningful comparison of the simulation results with the analytical solution is not possible because of the inaccuracies in the numerical evaluation of the analytical solution itself .",
    "is the stationary solution for the velocity component in flow direction on a quadratic cross - section in an infinitely long pipe and for a constant pressure gradient .",
    "therefore , the simulated @xmath212 and @xmath213 are inspected for convergence at the end of the simulation @xmath214 and the assumption of a constant pressure gradient is checked .",
    "we define @xmath215 as the maximum relative change of a quantity @xmath24 during the time @xmath216 and within the computational domain @xmath217 , where @xmath218 is either the velocity @xmath212 or the density @xmath219 . because the pressure is proportional to the density , eq .",
    ", the pressure is converged , if the density is sufficiently converged .",
    ".[tbl : steady ] maximum relative change of the velocity @xmath220 and density @xmath221 , eq .  , during the time @xmath216 when the simulation ended at @xmath222 .",
    "@xmath223 is the dimensionless channel width . [",
    "cols=\"^,^,^,^,^,^ \" , ]      the top plot shows the permeability for different @xmath224 , @xmath0  schemes , the @xmath225  and the @xmath226  sample .",
    "the influence of @xmath224 on the permeability is stronger using the @xmath177implementation .",
    "the bottom plot shows the permeability results , for the @xmath225  sample with @xmath227 and the @xmath226  sample with @xmath228 . at @xmath229",
    "the extrapolated permeabilities @xmath230 are shown.,title=\"fig : \" ]   the top plot shows the permeability for different @xmath224 , @xmath0  schemes , the @xmath225  and the @xmath226  sample .",
    "the influence of @xmath224 on the permeability is stronger using the @xmath177implementation .",
    "the bottom plot shows the permeability results , for the @xmath225  sample with @xmath227 and the @xmath226  sample with @xmath228 . at @xmath229",
    "the extrapolated permeabilities @xmath230 are shown.,title=\"fig : \" ]",
    "our simulation setup of an acceleration zone and in / outlet chambers , together with our approximations of darcy s law , provides a method for permeability calculations .",
    "several problems in the numerical implementation and data evaluation were addressed , such as a correct acceleration implementation and an adequate approximation for calculating the pressure gradient .",
    "caveats when using @xmath0  simulations to calculate permeabilities have been exposed .",
    "we performed detailed studies with different @xmath0-implementations , i.e. , @xmath177  and @xmath53 , and for various systems to quantitatively determine the accuracy of the calculated velocity field and calculated permeability .",
    "we find that for reasonably resolved quadratic pipes , the error of the calculated permeability is below @xmath231 .",
    "investigating non - aligned geometries , circular and triangular pipes , the discretization and permeability error is roughly @xmath232 at comparable resolutions . from this",
    "we infer that permeability calculations in stochastic porous media will have a significantly larger error , because the resolution of pores and pore walls is usually well below the resolution used for our pipe calculations above . comparing the two @xmath0-implementations , @xmath47  and @xmath130 , we find that @xmath130  reduces the dependence of the permeability on the value of @xmath1 substantially .",
    "using @xmath47  and a relaxation time @xmath1 tailored to give good results for a specific geometry does not assure reliable results in a stochastic porous medium .",
    "for example , we found that @xmath47  and @xmath233 yields the best result for 3d poiseuille flow in a quadratic pipe .",
    "however , for this value @xmath47  and @xmath130  results differ by 20% if applied to the fontainebleau sandstone ( see fig .  [",
    "fig : fntb ] ) .",
    "therefore , @xmath130  is suggested to be used for permeability estimates based on @xmath0  simulations .",
    "further investigations using the @xmath0  method for flow through stochastic porous media should include a resolution and relaxation time dependent analysis together with an appropriate extrapolation scheme for more reliable permeability estimates .",
    "we are grateful to the high performance computing center in stuttgart , the scientific supercomputing center in karlsruhe , and the jlich supercomputing center for providing access to their machines .",
    "one of us ( t.z . ) would like to acknowledge partial support from the dfg program exc310 ( simulationstechnik ) .",
    "we would like to thank bibhu biswal for fruitful discussions and the sonderforschungsbereich  716 , the dfg program `` nano- and microfluidics '' , and the deutscher akademischer austauschdienst ( daad ) for financial support .",
    "n.  s. martys , j.  g. hagedorn , d.  goujon , and j.  e. devaney .",
    "large scale simulations of single and multi - component flow in porous media . in _ developments in x - ray tomography ii ,",
    "proceeding of spie _ , volume 3772 , pp 205213 , 1999 ."
  ],
  "abstract_text": [
    "<S> during the last decade , lattice - boltzmann ( @xmath0 ) simulations have been improved to become an efficient tool for determining the permeability of porous media samples . </S>",
    "<S> however , well known improvements of the original algorithm are often not implemented . </S>",
    "<S> these include for example multirelaxation time schemes or improved boundary conditions , as well as different possibilities to impose a pressure gradient . </S>",
    "<S> this paper shows that a significant difference of the calculated permeabilities can be found unless one uses a carefully selected setup . </S>",
    "<S> we present a detailed discussion of possible simulation setups and quantitative studies of the influence of simulation parameters . </S>",
    "<S> we illustrate our results by applying the algorithm to a fontainebleau sandstone and by comparing our benchmark studies to other numerical permeability measurements in the literature . </S>"
  ]
}