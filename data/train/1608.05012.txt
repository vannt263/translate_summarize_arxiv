{
  "article_text": [
    "functional data analysis  @xcite is a booming research area .",
    "often the focus is on functions with a univariate domain , such as time series or spectra .",
    "the function values may be multivariate , such as height and weight of children by age , temperature and dewpoint temperature at several weather stations over time , or measurements of human heart activity at two different places on the body , see e.g. @xcite . in this paper",
    "we will also consider functions whose _ domain _ is multivariate .",
    "in particular , images and surfaces are functions on a bivariate domain .",
    "our methods generalize to higher - dimensional domains , e.g. the voxels of a 3d - image of a human brain are defined on a trivariate domain .    detecting outliers in functional data",
    "is an important task .",
    "recent developments include the approaches of @xcite and @xcite .",
    "@xcite proposed the functional boxplot , and @xcite developed the outliergram .",
    "our approach is somewhat different . to detect outlying functions or outlying parts of a function ( in a data set consisting of several functions )",
    "we will look at its ( possibly multivariate ) function value in every time point / pixel / voxel/ ... of its domain . for this purpose",
    "we need a tool that assigns a measure of outlyingness to every data point in a multivariate non - functional sample .",
    "a popular measure is the stahel - donoho outlyingness ( sdo ) due to @xcite and @xcite which works best when the distribution of the inliers is roughly elliptical .",
    "however , it is less suited for skewed data . to address this issue ,",
    "@xcite proposed the ( skewness- ) adjusted outlyingness ( ao ) which takes the skewness of the underlying distribution into account . however , the ao has two drawbacks .",
    "the first is that the ao scale has a large bias as soon as the contamination fraction exceeds 10% .",
    "furthermore , its computation time is @xmath1 per direction due to its rather involved construction .    to remedy these deficiencies",
    "we propose a new measure in this paper , the _ directional outlyingness _ ( do ) .",
    "the do also takes the skewness of the underlying distribution into account , but its scale is more robust and it requires only @xmath0 operations .",
    "the next section defines the do , investigates its theoretical properties , and illustrates it on univariate , bivariate and spectral data .",
    "section 3 derives a cutoff value for the do and applies it to outlier detection .",
    "it also extends the functional outlier map of @xcite to the do , and in it constructs a curve separating outliers from inliers .",
    "section 4 shows an application to mri images , and section 5 analyzes video data .",
    "in the univariate setting , the stahel - donoho outlyingness of a point @xmath2 relative to a sample @xmath3 is defined as @xmath4 where the denominator is the median absolute deviation ( mad ) of the sample , given by @xmath5 where @xmath6 is the standard normal cdf .",
    "the sdo is affine invariant , meaning that it remains the same when a constant is added to @xmath7 and @xmath2 , and also when they are multiplied by a nonzero constant .",
    "a limitation of the sdo is that it implicitly assumes the inliers ( i.e. the non - outliers ) to be roughly symmetrically distributed .",
    "but when the inliers have a skewed distribution , using the mad as a single measure of scale does not capture the asymmetry .",
    "for instance , when the data stem from a right - skewed distribution , the sdo may become large for inliers on the right hand side , and not large enough for actual outliers on the left hand side .",
    "this observation led to the ( skewness- ) adjusted outlyingness ( ao ) proposed by  @xcite .",
    "this notion employs a robust measure of skewness called the medcouple  @xcite , which however requires @xmath8 computation time .",
    "moreover , we will see in the next subsection that it leads to a rather large explosion bias .    in this paper",
    "we propose the notion of _ directional outlyingness _ ( do ) which also takes the potential skewness of the underlying distribution into account , while attaining a smaller computation time and bias .",
    "the main idea is to split the sample into two halfsamples , and then to apply a robust scale estimator to each of them .",
    "more precisely , let @xmath9 be a univariate sample .",
    "( the actual algorithm does not require sorting the data . )",
    "we then construct two subsamples of size @xmath10 as follows .",
    "for even @xmath11 we take @xmath12 and @xmath13 where the subscripts @xmath14 and @xmath15 stand for * a*bove and * b*elow the median . for odd @xmath11",
    "we put @xmath16 and @xmath13 so that @xmath17 and @xmath18 share one data point and have the same size .",
    "next , we compute a scale estimate for each subsample . among many available robust estimators we choose",
    "a one - step m - estimator with huber @xmath19-function due to its fast computation and favorable properties .",
    "we first compute initial scale estimates @xmath20 where @xmath21 and @xmath22 and where @xmath23 ensures consistency for gaussian data .",
    "the one - step m - estimates are then given by @xmath24 where @xmath25 denotes the huber rho function for scale @xmath26 }   + { \\mathbbm{1}}_{(-\\infty , c ) \\cup ( c,\\infty)}$ ] with @xmath27 a tuning parameter regulating the trade - off between efficiency and bias , and where @xmath28 .",
    "finally , the directional outlyingness ( do ) of a point @xmath2 relative to a univariate sample @xmath3 is given by @xmath29 note that do is affine invariant .",
    "in particular , flipping the signs of @xmath7 and @xmath2 interchanges @xmath30 and @xmath31 which results in @xmath32 .",
    "figure  [ fig : scales ] illustrates the denominators of the sdo and do expressions on the family income dataset from",
    "_ https://psidonline.isr.umich.edu _ which contains 8962 strictly positive incomes in the tax year 2012 .",
    "their histogram is clearly right - skewed .",
    "the mad in the denominator of sdo equals @xmath33 and is used both to the left and to the right of the median , as depicted by the orange arrows . for the do the ` above ' scale @xmath34 exceeds the ` below ' scale @xmath35 ( blue arrows ) .",
    "therefore , a point to the right of the median will have a lower do than a point to the left at the same distance to the median .",
    "this is a desirable property in view of the difference between the left and right tails .     -0.2",
    "cm      let us now study the robustness properties of the scales @xmath36 and @xmath37 and the resulting do.it will be convenient to write @xmath36 and @xmath37 as functionals of the data distribution @xmath38 : @xmath39 where @xmath25 is the huber @xmath19-function .",
    "we will first focus on the worst - case bias of @xmath36 due to fraction @xmath40 of contamination , following  @xcite . at a given distribution @xmath38 , the explosion bias curve of @xmath36",
    "is defined as @xmath41 where @xmath42 in which @xmath43 can be any distribution .",
    "the implosion bias curve is defined similarly as @xmath44    from here onward we will assume that @xmath38 is symmetric about some center @xmath45 and has a continuous density @xmath46 which is strictly decreasing in @xmath47 . in order to derive the explosion and implosion bias we require the following lemma ( all proofs can be found in the supplementary material ) :    \\(i ) for fixed @xmath48 it holds that @xmath49 is strictly increasing in @xmath50 ; + ( ii ) for fixed @xmath51 it holds that @xmath52 is strictly decreasing in @xmath53 .    for any @xmath54",
    "the implosion bias of @xmath36 is given by @xmath55 where @xmath56    in fact , the implosion bias of @xmath36 is reached when @xmath57 is the distribution that puts all its mass in the point @xmath58 .",
    "note that the _ implosion breakdown value _ of @xmath36 is 25% because for @xmath59 we obtain @xmath60 .",
    "for any @xmath54 the explosion bias of @xmath36 is given by @xmath61 where @xmath62    the explosion bias of @xmath36 is reached at all distributions @xmath63 for which @xmath64 which ensures that @xmath65 lands on the constant part of @xmath25 . for @xmath59",
    "we find @xmath66 and @xmath67 , so the _ explosion breakdown value _ of @xmath36 is 25% .",
    "the blue curves in figure  [ fig : expimp ] are the explosion and implosion bias curves of @xmath36 when @xmath68 is the standard gaussian distribution , and the tuning constant in @xmath25 is @xmath69 corresponding to 85% efficiency . by affine equivariance",
    "the curves for @xmath37 are exactly the same , so these are the curves of both do scales .",
    "the orange curves correspond to explosion and implosion of the scales used in the adjusted outlyingness ao under the same contamination .",
    "we see that the ao scale explodes faster , due to using the medcouple in its definition .",
    "the fact that the do scale is typically smaller enables the do to attain larger values in outliers .",
    "another tool to measure the ( non-)robustness of a procedure is the influence function ( if ) .",
    "let @xmath70 be a statistical functional , and consider the contaminated distribution @xmath71 .",
    "the influence function of @xmath70 at @xmath38 is then given by @xmath72 and basically describes how @xmath70 reacts to a small amount of contamination .",
    "this concept justifies our choice for the function @xmath25 .",
    "indeed , the if of a fully iterated m - estimator of scale with function @xmath19 is proportional to @xmath73 with the constant @xmath74 .",
    "we use @xmath75 with @xmath69 .",
    "it was shown in @xcite that at @xmath68 this @xmath25 yields the m - estimator with highest asymptotic efficiency subject to an upper bound on the absolute value of its if .",
    "we will now derive the if of the one - step m - estimator @xmath36 given by  .",
    "the influence function of @xmath36 is given by @xmath76 where @xmath77 is the influence function of @xmath30 .     at @xmath68.,scaledwidth=50.0%",
    "]    the resulting if of @xmath36 at @xmath68 is shown in figure [ fig : if_sa ] . [ note that @xmath78 . ]",
    "it is bounded , indicating that @xmath79 is robust to a small amount of contamination even when it is far away .",
    "note that the if has a jump at the third quartile @xmath80 due to the initial estimate @xmath30 . if we were to iterate   to convergence this jump would vanish , but then the explosion bias would go to infinity at a lower @xmath40 as in  @xcite .",
    "let us now compute the influence function of @xmath81 given by   for contamination in the point @xmath82 , noting that @xmath83 and @xmath82 need not be the same .    when @xmath84 it holds that @xmath85 whereas for @xmath86 we obtain @xmath87     for @xmath68 .",
    "]    for a fixed value of @xmath83 the influence function of @xmath88 is bounded in @xmath82 , which is a desirable robustness property .",
    "figure [ fig : if_do ] shows the influence function when @xmath38 is the standard gaussian distribution .      in the multivariate setting we can apply the principle that a point is outlying with respect to a dataset if it stands out in at least one direction .",
    "like the stahel - donoho outlyingness , the multivariate do is defined by means of univariate projections . to be precise ,",
    "the do of a d - variate point @xmath89 relative to a @xmath65-variate sample @xmath90 is defined as @xmath91 where the right hand side uses the univariate do of  .    to compute the multivariate",
    "do we have to rely on approximate algorithms , as it is impossible to project on _ all _ directions @xmath92 in @xmath65-dimensional space .",
    "a popular procedure to generate a direction is to randomly draw @xmath65 data points , compute the hyperplane passing through them , and then to take the direction @xmath92 orthogonal to it .",
    "this guarantees that the multivariate do is affine invariant .",
    "that is , the do does not change when we add a constant vector to the data , or multiply the data by a nonsingular @xmath93 matrix .        as an illustration we take the bloodfat data set , which contains plasma cholesterol and plasma triglyceride concentrations ( in mg / dl ) of 320 male subjects for whom there is evidence of narrowing arteries @xcite . here",
    "@xmath94 and @xmath95 , and following @xcite we generated @xmath96 directions @xmath92 .",
    "figure [ fig : bloodfat ] shows the contour plots of both the do and sdo measures .",
    "we see that the contours of the do capture the skewness in the dataset , whereas those of the sdo are more symmetric even though the data themselves are not .",
    "we now extend the do to data where the objects are functions . to fix ideas",
    "we will consider an example .",
    "the glass data set consists of spectra with @xmath97 wavelengths resulting from spectroscopy on n = 180 archeological glass samples @xcite .",
    "figure [ fig : glassdata ] shows the 180 curves .        at each wavelength the response is a single number , the intensity , so this is a univariate functional dataset .",
    "however , we can incorporate the dynamic behavior of these curves by numerically computing their first derivative .",
    "this yields bivariate functions , where the response consists of both the intensity and its derivative .",
    "in general we write a functional dataset as @xmath98 where each @xmath99 is a @xmath65-dimensional function . as in this example , the @xmath99 are typically observed on a discrete set of points in their domain . for a univariate domain",
    "this set is denoted as @xmath100 .",
    "now we want to define the do of a d - variate function @xmath101 on the same domain , where @xmath101 need not be one of the @xmath99 . for this",
    "we look at all the domain points @xmath102 in turn , and define the _ functional directional outlyingness _ ( fdo ) of @xmath101 with respect to the sample @xmath103 as @xmath104 where @xmath105 is a weight function for which @xmath106 .",
    "such a weight function allows us to assign a different importance to the outlyingness of a curve at different domain points .",
    "for instance , one could downweight time points near the boundaries if measurements are recorded less accurately at the beginning and the end of the process .",
    "figure  [ fig : fdo_glass ] shows the fdo of the 180 bivariate functions in the glass data , where @xmath105 was set to zero for the first 13 wavelengths where the spectra had no variability , and constant at the remaining wavelengths .",
    "these fdo values allow us to rank the spectra from most to least outlying , but do not contain much information about how the outlying curves are different from the majority .",
    "in addition to this global outlyingness measure fdo we also want to look at the local outlyingness . to this end figure  [ fig : domap_glass ]",
    "shows the individual @xmath107 for each of the 180 functions @xmath99 of the glass data at each wavelength @xmath102 .",
    "higher values of do are shown by darker red in this heatmap .",
    "now we see that there are a few groups of curves with particular anomalies : one group around function 25 , one around function 60 , and one with functions near the bottom .",
    "note that the global outlyingness measure fdo flags outlying rows in this heatmap , whereas the dark spots inside the heatmap can be seen as outlying cells .",
    "it is also possible to sort the rows of the heatmap according to their fdo values .",
    "note that the wavelength at which a dark spot in the heatmap occurs allows to identify the chemical element responsible .",
    "when analyzing a real data set we do not know its underlying distribution , but still we would like a rough indication of which observations should be flagged as outliers .",
    "for this purpose we need an approximate cutoff value on the do .",
    "we first consider non - functional data , leaving the functional case for the next subsection .",
    "let @xmath108 be a @xmath65-variate dataset ( @xmath109 ) with directional outlyingness values @xmath110 .",
    "the @xmath111 have a right - skewed distribution , so we transform them to @xmath112 of which the majority is closer to gaussian",
    ". then we center and normalize the resulting values in a robust way and compare them to a high gaussian quantile , flagging @xmath113 as outlying whenever @xmath114 .",
    "this is equivalent to comparing the original do values to the cutoff @xmath115    for an illustration we return to the family income data of figure  [ fig : scales ] .",
    "the blue vertical line in figure  [ fig : scalesfill ] corresponds to the do cutoff , whereas the orange line is the result of the same computation applied to the stahel - donoho outlyingness .",
    "the do cutoff is the more conservative one , because it takes the skewness of the income distribution into account .",
    "figure  [ fig : bloodfat_outlier ] shows the do and sdo cutoffs for the bivariate bloodfat data of figure  [ fig : bloodfat ] .",
    "the do captures the skewness in the data and flags only one point as outlying , where s the sdo takes a more symmetric view and also flags five of the presumed inliers .    to investigate this effect",
    "when the data follow a known distribution we carry out a simulation .",
    "we generate 50 samples of 500 observations from the bivariate marshall - olkin distribution @xcite with parameters @xmath116 and @xmath117 . to these samples",
    "we add 10% of contamination at several positions on the lines @xmath118 and @xmath119 shown in figure  [ fig : modata ] .     and ( b ) @xmath120.,scaledwidth=90.0% ]",
    "figure  [ fig : modata_od ] shows the average percentage of outliers found as a function of the x - coordinate of the contamination .",
    "the left panel is for contamination along @xmath121 , where we see that the do finds the outliers faster than the sdo , both on the left and on the right . on the other hand , for contamination along @xmath122 the projection of the inliers on that direction",
    "is very skewed . as a result ,",
    "the do finds the outliers faster on the left and slightly slower on the right , as it should .",
    "when the data set consists of functions there can be several types of outlyingness . as an aid to distinguish between them",
    ", @xcite introduced a graphical tool called the _ functional outlier map _",
    ". here we will extend the fom to the new do measure and add a cutoff to it , in order to increase its utility .",
    "consider a functional dataset @xmath98 .",
    "the fdo [ see  ] of a function @xmath99 can be interpreted as the ` average outlyingness ' of its ( possibly multivariate ) function values .",
    "we now also measure the _ variability _ of its do values , by @xmath123 note that   has the fdo in the denominator in order to measure relative instead of absolute variability .",
    "this can be understood as follows .",
    "suppose that the functions @xmath99 are centered around zero and that @xmath124 for all @xmath125 .",
    "then @xmath126 but their relative variability is the same . because @xmath127 , putting fdo in the denominator normalizes for this . in the numerator",
    "we could also compute a weighted standard deviation with the weights @xmath128 from  .",
    "the fom is then the scatter plot of the points @xmath129 for @xmath130 .",
    "its goal is to reveal outliers in the data , and its interpretation is fairly straightforward .",
    "points in the lower left part of the fom represent regular functions which hold a central position in the data set .",
    "points in the lower right part are functions with a high fdo but a low variability of do values .",
    "this happens for _ shift outliers _ ,",
    "i.e.  functions which have a regular shape but are shifted on the whole domain .",
    "points in the upper left part have a low fdo but a high vdo .",
    "typical examples are local outliers , i.e.  functions which only display outlyingness over a small part of their domain .",
    "the points in the upper right part of the fom have both a high fdo and a high vdo .",
    "these correspond to functions which are strongly outlying on a substantial part of their domain .        as an illustration",
    "we revisit the glass data .",
    "their fom in figure  [ fig : glass_fom ] contains a lot more information than their fdo values alone in figure  [ fig : fdo_glass ] . in the heatmap ( figure  [ fig : domap_glass ] ) we noticed three groups of outliers , which also stand out in the fom .",
    "the first group consists of the spectra 20 , 22 , 23 , 28 , 30 , 31 and 33 . among these",
    ", number 30 lies furthest to the right in the fom .",
    "it corresponds to row 30 in figure  [ fig : domap_glass ] which has a dark red piece .",
    "it does not look like a shift outlier , for which the row would have a more homogeneous color ( hence a lower vdo ) .",
    "the second group , with functions 5763 , occupies a similar position in the fom .",
    "the group standing out the most consists of functions 143174 .",
    "they are situated in the upper part of the fom , indicating that they are shape outliers .",
    "indeed , they deviate strongly from the majority in three fairly small series of wavelengths .",
    "their outlingness is thus more local than that of functions 5763 .",
    "we now add a new feature to the fom , namely a rule to flag outliers . for this",
    "we define the _ combined functional outlyingness _ ( cfo ) of a function @xmath99 as @xmath131 where @xmath132 and @xmath133 , and similarly for vdo .",
    "note that the cfo characterizes the points in the fom through their euclidean distance to the origin , after scaling .",
    "we expect outliers to have a large cfo . in general",
    ", the distribution of the cfo is unknown but skewed to the right . to construct a cutoff for cfo we use the same reasoning as for the cutoff   on fdo : first we compute @xmath134 for all @xmath130 , and then we flag function @xmath99 as outlying if @xmath135 this yields the dashed curve ( which is part of an ellipse ) in the fom of figure  [ fig : glass_fom ] .",
    "images are functions on a bivariate domain . in practice",
    "the domain is a grid of discrete points , e.g.   the horizontal and vertical pixels of an image .",
    "it is convenient to use two indices @xmath136 and @xmath137 , one for each dimension of the grid , to characterize these points . an image ( or a surface ) is then a function on the @xmath138 points of the grid .",
    "note that the function values can be univariate , like gray intensities , but they can also be multivariate , e.g. the intensities of red , green and blue ( rgb ) . in general we will write an image dataset as a sample @xmath98 where each @xmath99 is a function from @xmath139 to @xmath140 .",
    "the fdo   and vdo   notions that we saw for functional data with a univariate domain can easily be extended to functions with a bivariate domain by computing @xmath141 where the weights @xmath142 must satisfy @xmath143 , and @xmath144 where the standard deviation can also be weighted by the @xmath142 .",
    "( the simplest weight function is the constant @xmath145 for all @xmath136 and @xmath137 . )",
    "note that   and   can trivially be extended to functions with domains in more than 2 dimensions , such as three - dimensional images consisting of voxels . in each case",
    "we obtain @xmath146 and @xmath147 values that we can plot in a fom , with cutoff value  .    as an illustration",
    "we analyze a dataset containing mri brain images of 416 subjects aged between 18 and 96  @xcite , which can be freely accessed at _ www.oasis - brains.org_. for each subject several images are provided ; we will use the masked atlas - registered gain field - corrected images resampled to 1 mm isotropic pixels .",
    "the masking has set all non - brain pixels to an intensity value of zero .",
    "the provided images are already normalized , meaning that the size of the head is exactly the same in each image .",
    "the images have 176 by 208 pixels , with grayscale values between 0 and 255 .",
    "all together we thus have 416 observed images @xmath99 containing univariate intensity values @xmath148 , where @xmath149 and @xmath150 .",
    "there is more information in such an image than just the raw values .",
    "we can incorporate shape information by computing the gradient in every pixel of the image .",
    "the gradient in pixel @xmath151 is defined as the 2-dimensional vector @xmath152 in which the derivatives have to be approximated numerically . in the pixels at the boundary of the brain",
    "we compute forward and backward finite differences , and for the other pixels we employ central differences . in the horizontal direction",
    "we thus compute one of three expressions : @xmath153 depending on where the pixel is located .",
    "the derivatives in the vertical direction are computed analogously .    incorporating these derivatives yields a dataset of dimensions @xmath154 ,",
    "so the final @xmath148 are trivariate . for each subject",
    "we thus have three data matrices which represent the original mri image and its derivatives in both directions .",
    "figure  [ fig : mridata ] shows these three matrices for subject number 387 .",
    "the functional do of an mri image @xmath99 is given by  : @xmath155 where @xmath156 is the do of the trivariate point @xmath148 relative to the trivariate dataset @xmath157 .",
    "in this example the have set the weight @xmath142 equal to zero at the grid points that are not part of the brain , shown as the black pixels around it",
    ". the grid points inside the brain receive full weight .        figure  [ fig : mrifom ] shows the resulting fom , which indicates the presence of several outliers . image 126 has the highest fdo combined with a relatively low vdo .",
    "this suggests a shift outlier , i.e.  a function whose values are all shifted relative to the majority of the data .",
    "images 29 and 92 have a large fdo in combination with a high vdo , indicating that they have strongly outlying subdomains .",
    "images 108 , 188 and 234 have an fdo which is on the high end relative to the dataset , which by itself does not make them outlying .",
    "only in combination with their large vdo are they flagged as outliers .",
    "these images have strongly outlying subdomains which are smaller that those of functions 29 and 92 .",
    "the remaining flagged images are fairly close to the cutoff , meaning they are merely borderline cases .        in order to find out",
    "why a particular image is outlying it is instructive to look at a heatmap of its do values . in figure",
    "[ fig : mrigrid ] we compare the mri images ( on the left ) and the do heatmaps ( on the right ) of subjects 387 , 92 , and 126 .",
    "do values of 15 or higher received the darkest color .",
    "image 387 has the smallest cfo value , and can be thought of as the most central image in the dataset .",
    "as expected , the do heatmap of image 387 shows very few outlying pixels . for subject 92 , the do heatmap nicely marks the region in which the mri image deviates most from the majority of the images .",
    "note that the boundaries of this region have the highest outlyingness .",
    "this is due of including the derivatives in the analysis , as they emphasize the pixels at which the grayscale intensity changes .",
    "the do heatmap of subject 126 does not show any extremely outlying region but has a rather high outlyingness over the whole domain , which explains its large fdo and regular vdo value . the actual mri image to its left is globally lighter than the others , confirming that it is a shift outlier .",
    "we analyze a surveillance video of a beach , filmed with a static camera  @xcite .",
    "this dataset can be found at _ http://perception.i2r.a-star.edu.sg/bk_model/bk_index.html _ and consists of 633 frames .",
    "the first 8 seconds of the video show a beach with a tree , as in the leftmost panel of figure  [ fig : videodata ] .",
    "then a man enters the screen from the left ( second panel ) , disappears behind the tree ( third panel ) , and then reappears to the right of the tree and stays on screen until the end of the video .",
    "our aim is to detect the man in this video .",
    "the frames have @xmath158 pixels and are stored using the rgb ( red , green and blue ) color model , so each frame corresponds to three matrices of size @xmath158 .",
    "overall we have 633 frames @xmath99 containing trivariate @xmath148 for @xmath159 and @xmath160 .",
    "computing the fdo   in this data set is time consuming since we have to execute the projection pursuit algorithm   in @xmath161 for each pixel , so @xmath162 times .",
    "the entire computation took about on hour and a half on a laptop .",
    "therefore we switch to an alternative computation .",
    "we define the componentwise do of a @xmath65-variate point @xmath89 relative to a @xmath65-variate sample @xmath90 as @xmath163 where @xmath164 is the univariate do of the @xmath165-th coordinate of @xmath89 relative to the @xmath165-th coordinate of @xmath166 . analyzing the video data with this componentwise procedure took under 2 minutes , so it is about 50 times faster than with projection pursuit , and it produced almost the same fom .",
    "figure  [ fig : video_fom ] shows the fom obtained from the cdo computation .",
    "the first 480 frames , which depict the beach and the tree with only the ocean surface moving slightly , are found at the bottom left part of the fom .",
    "they fall inside the dashed curve that separates the regular frames from the outliers . at frame 483",
    "the man enters the picture , making the standard deviation of the do rise slightly .",
    "the fdo increases more slowly , as the fraction of the pixels covered by the man is still low at this stage .",
    "this frame can thus be seen as locally outlying .",
    "the subsequent frames 484487 have very high fdo and vdo . in them",
    "the man is clearly visible between the left border of the frame and the tree , so these frames have outlying pixels in a substantial part of their domain .",
    "frames 488491 see the man disappear behind the tree , so the fdo goes down as the fraction of outlying pixels decreases . from frame 492",
    "onward the man reappears to the right of the tree and stays on screen until the end , these frames contain many outlying pixels , yielding points in the upper right part of the fom .    in the fom we also labeled frame 1 , which lies close to the outlyingness border .",
    "further inspection indicated that this frame is a bit lighter than the others , which might be due to the initialization of the camera at the start of the video .",
    "in addition to the fom we can draw do heatmaps of the individual frames . for frames 100 , 487 , 491 and 500 , figure  [ fig : videosum ] shows the raw frame on the left , the do heatmap in the middle and the fom on the right , in which a blue circle marks the position of the frame . in this figure",
    "we can follow the man s path in the fom , while the do heatmaps show exactly where the man is in those frames .",
    "we have created a video in which the raw frame , the do heatmap and the fom evolve alongside each other .",
    "it can be downloaded from _",
    "http://wis.kuleuven.be / stat / robust / publ_.",
    "the notion of directional outlyingness ( do ) is well - suited for skewed distributions .",
    "it has good robustness properties , and lends itself to the analysis of univariate , multivariate , and functional data , in which both the domain and the function values can be multivariate .",
    "rough cutoffs for outlier detection are available .",
    "the do is also a building block of several graphical tools like do heatmaps , do contours , and the functional outlier map ( fom ) .",
    "these proved useful when analyzing spectra , mri images , and surveillance video . in the mri images we added gradients to the data in order to reflect shape / spatial information . in the video data we could also add the numerical derivative in the time direction .",
    "this would make the frames 6-dimensional , but the componentwise do in   would remain fast to compute .",
    "a rudimentary version of the r - code for computing the do and reproducing the examples is available from our website _ http://wis.kuleuven.be / stat / robust / software_.              febrero - bande , m. , galeano , p.   gonzlez - manteiga , w. 2008 , ` outlier detection in functional data by depth measures , with application to identify abnormal @xmath167 levels ' , _ environmetrics _ , * 19 * , 331345 .",
    "lemberge , p. , de  raedt , i. , janssens , k. , wei , f.  van  espen , p. 2000 , ` quantitative z - analysis of 16th17th century archaelogical glass vessels using pls regression of epxma and @xmath48-xrf data ' , _ journal of chemometrics _ * 14 * ,  751763 .",
    "marcus , d. , wang , t. , parker , j. , csernansky , j. , morris , j. buckner , r. 2007 , ` open access series of imaging studies ( oasis ) : cross - sectional mri data in young , middle aged , nondemented , and demented older adults . ' , _ journal of cognitive neuroscience _ * 19 * ,  14981507 .",
    "let @xmath169 be fixed .",
    "for the function @xmath25 we have that @xmath170 the function @xmath171 is increasing in @xmath50 and even strictly increasing at large @xmath172 . this proves ( i ) since @xmath173 in all @xmath83 .",
    "let @xmath178 be fixed and let @xmath179 be a minimizing distribution , i.e. @xmath180 with @xmath181 .",
    "inserting the contaminated distribution @xmath179 into @xmath182 yields the scale @xmath183 for simplicity , put @xmath184 we then have the contaminated scale @xmath185 denote by @xmath186 and @xmath187 the median and the third quartile of the contaminated distribution .    for the distribution @xmath43 it has to hold that @xmath188 and @xmath189 .",
    "this can be seen as follows .",
    "suppose @xmath190 $ ] .",
    "then consider @xmath191 where @xmath192 \\\\      1 & \\text { else } \\\\",
    "\\end{array } \\right.\\ ] ] and denote by @xmath193 and @xmath194 the median and third quartile of @xmath191 .",
    "note that @xmath195 and @xmath196 . therefore , we have @xmath197 .",
    "it then follows from lemma 1(i ) that @xmath198 and @xmath199 .",
    "therefore @xmath200 .",
    "it now follows that @xmath201 , which is a contradiction since @xmath43 minimizes @xmath36 .",
    "therefore , @xmath202 .",
    "a similar argument can be made to show that @xmath189 .",
    "it follows that @xmath188 and @xmath203 for all @xmath204 , so all the mass of @xmath43 is inside @xmath205 $ ] .",
    "we can now argue that @xmath43 must have all its mass in @xmath206 .",
    "note that if @xmath188 and @xmath189 we have @xmath207 and @xmath208 $ ] , depending on @xmath209 .",
    "given that @xmath206 is fixed , we can minimize @xmath210 by minimizing @xmath211 .",
    "now @xmath211 is minimal for @xmath212 as this yields @xmath213 .",
    "note that this choice of @xmath43 to minimize @xmath211 is not unique as any @xmath43 which makes @xmath214 does the job .",
    "note finally that @xmath215 is also minimal for @xmath216 as @xmath217 is nondecreasing in @xmath218 , and this choice of @xmath43 yields @xmath219 .",
    "let @xmath178 be fixed and let @xmath179 be a maximizing distribution , i.e. @xmath225 with @xmath181 .",
    "inserting the contaminated distribution @xmath179 into @xmath182 yields the scale  , which can be rewritten as in   and  .    for the distribution @xmath43 it has to hold that @xmath226 .",
    "this can be seen as follows .",
    "suppose @xmath227 $ ] .",
    "now put @xmath228 and consider the distribution @xmath191 where @xmath229\\\\    h(x ) - p + p\\delta(e )      & \\text { for } x \\in ( q_{3,e},\\infty)\\\\ \\end{array } \\right.\\ ] ] and denote by @xmath193 and @xmath194 the median and third quartile of @xmath191 .",
    "note that @xmath195 and @xmath230 .",
    "therefore @xmath231 and thus @xmath232 because of lemma 1(i ) .",
    "furthermore , @xmath233 because @xmath217 is nondecreasing in @xmath218 , thus @xmath234 .",
    "it now follows that @xmath235 , which is a contradiction since @xmath43 maximizes @xmath36 .",
    "therefore @xmath226 , so @xmath43 has no mass inside @xmath205 $ ] .",
    "without loss of generality we can thus assume that @xmath43 is of the form @xmath236 with @xmath237 and @xmath238 where @xmath239 $ ] .",
    "this choice of @xmath240 and @xmath241 is not unique but it maximizes @xmath182 because @xmath217 is nondecreasing in @xmath218 . inserting the distribution @xmath242 yields @xmath243 where @xmath244 , @xmath245 and @xmath246 .",
    "note that this expression depends on @xmath65 but no longer on @xmath240 and @xmath241 .",
    "we will show that this expression is maximized for @xmath247 .",
    "first we show that @xmath248 is maximized for @xmath247 .",
    "let @xmath249 for any @xmath250\\;$ ] .",
    "note that @xmath251 does not depend on @xmath65 .",
    "therefore , we can write @xmath252 where @xmath253 is a strictly decreasing function of @xmath65 .",
    "note that we can write @xmath254 .",
    "the density @xmath255 is symmetric about some @xmath45 , and by affine equivariance we can assume @xmath256 w.l.o.g .",
    "since @xmath255 is unimodal with @xmath257 for all @xmath83 , the function @xmath258 is strictly decreasing upto its minimum ( corresponding to the mode of @xmath255 ) and then strictly increasing . therefore ,",
    "@xmath259 is maximal for @xmath260 as large as possible , i.e. for @xmath247 . in that case",
    ", we have @xmath261 .",
    "next , we maximize @xmath262 for any fixed @xmath51 .",
    "this is equivalent to maximizing @xmath263 where @xmath264 is such that @xmath265=\\frac{1}{2}\\pm      \\frac{\\varepsilon}{1-\\varepsilon}\\;$ ] .",
    "note that @xmath266 , where the second term does nt depend on @xmath264 .",
    "maximizing   with respect to @xmath264 is therefore equivalent to maximizing @xmath267 .",
    "note that this is equal to @xmath268 . for all @xmath83 in @xmath269",
    "$ ] it holds that @xmath270 , hence the latter integral is maximized by minimizing @xmath271 for all @xmath272 $ ] .",
    "for this @xmath264 must take on its highest possible value @xmath273 , because we then have @xmath274 for all @xmath83 in @xmath269 $ ] and all @xmath275 in @xmath276\\;$ ] .",
    "therefore , is maximized for @xmath247 .",
    "we now know that and satisfy @xmath277 and @xmath278 for all @xmath279 . by lemma 1(i ) , @xmath280 is increasing in @xmath281 . combining these results yields @xmath282 so @xmath283 is maximized for @xmath247 .",
    "therefore , @xmath284 is maximized for @xmath285 , hence @xmath286 and @xmath287 .",
    "the explosion bias is thus @xmath288 where @xmath289      plugging the contaminated distribution @xmath290 into the functional form   of @xmath36 yields",
    "@xmath291 we take the derivative with respect to @xmath40 and evaluate it in @xmath292 .",
    "note that @xmath217 is not differentiable at @xmath293 and @xmath294 , but as these two points form a set of measure zero this does not affect the integral containing @xmath295 .",
    "we also use that @xmath296 and @xmath297 yielding the desired expression .",
    "for @xmath68 we have @xmath298"
  ],
  "abstract_text": [
    "<S> functional data often consist of functions of a univariate quantity such as time or wavelength , whereas images can be considered as functional data with a bivariate domain . in either case </S>",
    "<S> the function values may themselves be multivariate . to detect outlying functions , we propose to compute a measure of outlyingness at each gridpoint . for this purpose </S>",
    "<S> we introduce _ directional outlyingness _ , which accounts for skewness and requires only @xmath0 computation time per direction . </S>",
    "<S> we derive the influence function of this outlyingness measure and compute a cutoff for outlier detection . </S>",
    "<S> the resulting heatmap and functional outlyingness map reflect local and global outlyingness of a function . to illustrate the performance of the method on real data it is applied to spectra , mri images , and video surveillance data .    </S>",
    "<S> # 1    0    0    1    0    * a measure of directional outlyingness + with applications to image data and video *    0.3 cm _ keywords : _ directional outlyingness , functional data , influence function , robustness , + skewness . </S>"
  ]
}