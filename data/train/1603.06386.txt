{
  "article_text": [
    "many real - life systems can be modeled using markov chains .",
    "fields of application are queueing theory , telecommunications , option pricing , etc . in most interesting situations ,",
    "analytic formulas are not available and the state space of the chain is so large that classical numerical methods would require a considerable computational time and huge memory capacity .",
    "so monte carlo ( mc ) simulation becomes the standard way of estimating performance measures for these systems .",
    "a drawback of mc methods is their slow convergence , with respect to the number of random points used .",
    "various techniques have been developed , in order to reduce the variance of the approximation , including stratified sampling and latin hypercube sampling @xcite .",
    "it is shown in a series of papers @xcite that each step of a mc simulation of a markov chain amounts to approximating the measure of a subdomain of the @xmath1-dimensional unit hypercube @xmath2 .",
    "the techniques presented here use stratified samples for calculating this approximation .    among stratification strategies ,",
    "we first consider the simple approach ( smc ) : the unit hypercube is divided into @xmath0 subcubes having the same measure , and one random point is chosen in each subcube . for latin hypercube sampling ( lhs ) , the projections of the points on each coordinate axis are evenly distributed : one projection in each of the @xmath0 subintervals that uniformly divide the unit interval @xmath3 .",
    "then we propose an hybrid method between smc and lhs , that has properties of both approaches , with one random point in each subcube and one projection in each subinterval ; we call this technique _ sudoku _ sampling ( ss ) due to the properties of the points recalling a sudoku grid",
    ".    the improved accuracy of stratified methods may be lost for problems in which we have to approximate the measure of subdomains with irregular boundaries .",
    "it is necessary to take special measures to make optimal use of the greater uniformity associated with stratified samples .",
    "this is achieved in @xcite through the additional effort of reordering the copies of the chain at each time step .",
    "this type of sorting was initiated by @xcite in the context of quasi - monte carlo ( qmc ) methods .",
    "this paper is organized as follows . in section [ sec : integration ] we present smc , lhs and ss methods for numerical integration .",
    "we recall variance bounds for smc and ss and we establish a new bound for the variance of lhs approach in the restrictive case of the approximate calculation of the measure of an interval in dimension @xmath1 . in section [ sec : simulation ] , we propose a mc simulation of markov chains using stratified samples in the context of discrete markov chains with continuous multi - dimensional state space . the results of numerical experiments are presented in section [ sec : illustrations ] .",
    "we compute the values of european and asian options and we compare the variance of the results and the efficiency of the approaches .",
    "it is shown that both smc and ss strategies outperform mc or lhs approaches .",
    "finally , we give some perspectives for future work .",
    "let @xmath4 be a given dimension ; then @xmath5 is the @xmath1-dimensional half - open unit hypercube and @xmath6 denotes the @xmath1-dimensional lebesgue measure .",
    "if @xmath7 is a square - integrable function defined on @xmath5 , we want to approximate @xmath8 for the usual mc approximation , @xmath9 are independent random variables uniformly distributed over @xmath5",
    ". then @xmath10 is an unbiased estimator of @xmath11 .",
    "when @xmath12 , for some measurable @xmath13 , one has @xmath14 a simple stratified sampling ( smc ) method was proposed in @xcite and further analyzed in @xcite . for @xmath15 , put @xmath16 let @xmath17 be independent random variables , with @xmath18 uniformly distributed over @xmath19 .",
    "then @xmath20 is another unbiased estimator of @xmath11 . in @xcite , we have analysed the following case : we consider a function @xmath21 and we define @xmath22 then for @xmath23 we obtain @xmath24 if @xmath25 is of bounded variation @xmath26 in the sense of hardy and krause ( we refer to @xcite for this concept ) .",
    "latin hypercube sampling ( lhs ) was introduced in @xcite and examined studiously in @xcite .",
    "let @xmath27 and @xmath28 be independent random variables , where @xmath29 is uniformly distributed over @xmath30 . if @xmath31 are independent random permutations of @xmath32 and @xmath33 , then each @xmath34 is uniformly distributed over @xmath5 .",
    "consequently , @xmath35 is another unbiased estimator of @xmath11 .",
    "we have proposed in @xcite a combination of smc and lhs : we construct @xmath15 random points in @xmath5 such that in every interval @xmath36 ( for @xmath37 and @xmath38 ) or @xmath19 ( for @xmath39 ) lies only one point of the set ( property @xmath40 ) .",
    "this is achieved as follows .",
    "if @xmath41 , we put @xmath42 .",
    "let @xmath43 be random bijections @xmath44 and @xmath45 be random variables uniformly distributed on @xmath46 ; all these variables are assumed to be mutually independent .",
    "we put @xmath47 the point set @xmath48 has property @xmath40 .",
    "if @xmath49 is defined by @xmath50 it is an unbiased estimator of @xmath11 .",
    "the following variance bound is established in @xcite .",
    "let @xmath13 be such that , for all @xmath51 , with @xmath37 , @xmath52 where @xmath53 are lipschitz continuous functions @xmath54 .",
    "then , for @xmath55 , we have @xmath56 where @xmath57 is a lipschitz constant ( for the maximum norm ) for all the @xmath53 .",
    "we prove a similar result for lhs , in a very restrictive case .",
    "if @xmath58 is a subinterval of @xmath5 , then the variance of the lhs approximation @xmath59 satisfies ( for @xmath60 ) @xmath61    we have @xmath62 for @xmath63 with @xmath64 , we set @xmath65 .",
    "if @xmath66 , then @xmath67 we may assume that @xmath58 is a closed interval : @xmath68,\\ ] ] with @xmath69 and @xmath70 .",
    "let us note @xmath71 : = \\{1,2 , \\ldots , s \\}$ ] and , for @xmath72 $ ] , denote @xmath73 \\setminus h$ ] .",
    "then @xmath74 } \\sum_{\\epsilon_i = \\pm 1 , i \\in h^c } \\prod_{h \\in h } n_h ( n_h+x_h^{-1 } + x_h^{+1 } -1 ) \\prod_{i \\in h^c } x_i^{\\epsilon_i } ( n_i+ x_i^{-\\epsilon_i } ) \\\\ & = & \\frac{1}{n^{2s } } \\prod_{i=1}^s ( n_i ( n_i + x_i^{-1 } + x_i^{+1}-1 ) + ( n_i + x_i^{-1 } ) x_i^{+1 } + ( n_i + x_i^{+1 } ) x_i^{-1 } ) .\\end{aligned}\\ ] ] hence @xmath75 since @xmath76 we obtain @xmath77 and the result follows .",
    "in this section , we use the previous stratification techniques for markov chains simulation .      let @xmath78 ; we consider an homogeneous markov chain @xmath79 with state space @xmath80 , evolving according to the stochastic recurrence : for @xmath81 @xmath82 here @xmath83 is a sequence of i.i.d .",
    "uniform random variables over @xmath84 ( for @xmath85 ) and each @xmath86 is a measurable map",
    ". the distribution @xmath87 of @xmath88 is known , and our aim is to approximate the distribution @xmath89 of @xmath90 .",
    "the standard iterative monte carlo scheme proceeds as follows .",
    "a large number @xmath0 of samples @xmath91 are drawn from the initial distribution @xmath87 ; then we generate @xmath0 sample paths of the chain as follows . for @xmath81 and for each @xmath92 @xmath93 where @xmath94 are pseudo - random numbers simulating i.i.d .",
    "uniform random variables over @xmath84 , independent from all variables introduced previously .",
    "qmc variants have been proposed to improve the accuracy of the method @xcite .",
    "the pseudo - random numbers @xmath95 are replaced with quasi - random numbers ; in order to benefit from the great uniformity of quasi - random points , one possibility is to sort the states @xmath96 by position in every step . since qmc methods do not give confidence intervals , randomized qmc algorithms have also been introduced in @xcite , with randomized quasi - random points . in the present paper , we propose a scheme using the sampling strategies presented in section [ sec : integration ] .",
    "let @xmath97 denote the set of all nonnegative measurable functions on @xmath98 . from ( [ eq : chaintransition ] )",
    ", we obtain @xmath99    let @xmath100 be an integer and put @xmath101 . for each @xmath81 , we are looking for an approximation of @xmath89 of the form @xmath102 where @xmath103 is a subset of @xmath98 to be determined .",
    "we first sample a point set @xmath104 of @xmath0 states from the initial probability distribution @xmath87 .",
    "once we have calculated a point set @xmath105 such that @xmath106 _ approximates _",
    "@xmath89 , we compute @xmath107 in two steps : we first sort the states of @xmath105 according to their successive coordinates , then we perform a numerical integration using a stratified sample .    [",
    "[ step-1-relabeling - the - states ] ] step 1 : relabeling the states + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we label the states @xmath108 using a multi - dimensional index @xmath109 with @xmath110 , such that :    : :    if @xmath111 then    @xmath112 , : :    if @xmath113 then    @xmath114 , : :    @xmath115 : :    if    @xmath116    then @xmath117 .    in the case",
    "@xmath118 , this reduces to simply sort the states by increasing order .",
    "if @xmath119 , the @xmath0 states are first sorted in @xmath120 batches of size @xmath121 according to their first coordinates ; then each batch is sorted in subgroups of @xmath120 batches of size @xmath122 by order of the second coordinates , and so on . at the last step of the sorting , subgroups of size @xmath123",
    "are ordered according to the last coordinate of the state .",
    "this type of nested sorting was introduced in @xcite for the qmc simulation of the boltzmann equation : since the algorithm is described by a series of numerical integrations , the sorting tends to reduce the number of the jumps of the integrand .",
    "[ [ step-2-using - stratified - samples - for - transition ] ] step 2 : using stratified samples for transition + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we define a probability measure @xmath124 on @xmath98 by replacing @xmath89 with @xmath125 in eq .",
    "[ eq : caractransition ] : @xmath126 to obtain a uniform approximation of @xmath127 , similar to ( [ eq : defapprox ] ) , we use a quadrature with stratified samples : let @xmath128 be pseudo - random numbers simulating stratified variables on @xmath129 as described in section [ sec : integration ] , independent from all variables introduced previously . for @xmath109 with @xmath110 , let @xmath130 be the indicator function of the interval @xmath131",
    ". for @xmath132 , denote @xmath133 then we have : @xmath134 we obtain @xmath135 by @xmath136 the second step of the algorithm may be written as follows . for @xmath137 let @xmath138 and @xmath139 ; for @xmath140 , let @xmath141 . then @xmath142 ( compare with eq .",
    "[ eq : mctransition ] ) . here",
    "the states are labeled using a multi - dimensional index @xmath143 with @xmath144 .",
    "the first @xmath1 components of @xmath145 are used to select the state of the chain that perform a transition , while the remaining @xmath146 components are used to determine the new state .",
    "in this section , we compare the stratified strategies with the standard mc scheme in numerical experiments      in the black - scholes model and under the risk - neutral measure , the asset price @xmath147 at time @xmath148 obeys the stochastic differential equation : @xmath149 , where @xmath150 is the risk - free interest rate , @xmath151 the volatility parameter and @xmath152 is a standard brownian motion .",
    "the solution of this equation is given by @xmath153 let @xmath154 be the maturity date and @xmath155 the strike price .",
    "we want to estimate the value of the call option : @xmath156 $ ] . to formulate the problem as a markov chain , we discretize the interval @xmath157 $ ] using observation times @xmath158 .",
    "the discrete version of ( [ eq : st ] ) can be written as : for @xmath81 @xmath159 where @xmath160 .    in this example @xmath161 .",
    "we choose the following parameters : @xmath162 , @xmath163 , @xmath164 , @xmath165 , @xmath166 , @xmath167 and @xmath168 , for @xmath169 .",
    "we want to compare the variances of the mc , lhs , smc and ss estimators of @xmath170 .",
    "we replicate the calculation independently @xmath171 times and we compute the sample variance . figure [ fig : europ_var ] shows the results as functions of @xmath0 , for @xmath172 , in log - log scale ( base @xmath173 ) .",
    "copies of the calculation of @xmath170 as a function of @xmath0 .",
    "mc ( @xmath174 ) , lhs ( @xmath175 ) , smc ( @xmath176 ) and ss ( @xmath177 ) outputs , in log - log scale ( base @xmath173).,scaledwidth=90.0% ]    it is clear that smc and ss produce smaller variances than mc and lhs ( for the same @xmath0 ) .",
    "when comparing the results of smc and ss , we can see that the later approach outperforms the former . at each step of the ss algorithm ,",
    "the mapping @xmath178 is one - to - one , so that each state is considered exactly once for a transition .    assuming that @xmath179 , linear regression is used to evaluate @xmath180 .",
    "the outputs are listed in table [ tab : europ ] .",
    "the convergence rates are close to those established for numerical integration in dimension @xmath173 .",
    ".european option : order @xmath180 of the variance of the calculation of @xmath170 .",
    "[ cols=\"^,^,^,^\",options=\"header \" , ]     as before , smc and ss stratification techniques give smaller variances and better convergence rates .",
    "but the advantage of the ss algorithm compared to the smc is lost . at each step of the ss algorithm , the mapping @xmath181 is not necessarily one - to - one .",
    "the efficiencies of the four methods are reported in figure  [ fig : asian_eff ] .",
    "smc and ss calculations give similar results and outperform mc and lhs outputs .",
    "copies of the calculation of @xmath182 as a function of @xmath0 .",
    "comparison of mc ( @xmath174 ) , lhs ( @xmath175 ) , smc ( @xmath176 ) and ss ( @xmath177 ) outputs , in log - log scale ( base @xmath173 ) . ]",
    "we have proposed upper bounds for the variance , when we approximate the integral of an indicator function of a subdomain of @xmath5 with stratified monte carlo techniques .",
    "we have proposed strategies for simulating markov chains using stratified samples and we have shown on examples that this approach could lead to better efficiency than naive monte carlo simulation .    the variance bound of the lhs approximation is obtained in a very restrictive case and should be extended to less specific subdomains of @xmath5 . the analysis of stratified simulation of markov chains remains undone and will be the subject of future work .",
    "[ 73 ] r. c. h. cheng , t. davenport , the problem of dimensionality in stratified sampling , management science 35 ( 1989 ) 12781296 .",
    "r. el - haddad , r. fakhereddine , c. lcot , stratified monte carlo integration , in : k. k. sabelfeld , i. dimov ( eds . ) , monte carlo methods and applications , de gruyter , berlin , 2013 , pp .",
    "r. el - haddad , r. fakhereddine , c. lcot , g. venkiteswaran , extended latin hypercube sampling for integration and simulation , in : j. dick , f.y .",
    "kuo , g.w .",
    "peters , i.h .",
    "sloan ( eds . ) , monte carlo and quasi - monte carlo methods 2012 , springer , berlin , 2014 , pp . 317330 .",
    "r. el - haddad , c. lcot , p. lecuyer , quasi - monte carlo simulation of discrete - time markov chains on multidimensional state spaces , in : a. keller , s. heinrich , h. niederreiter ( eds . ) , monte carlo and quasi - monte carlo methods 2006 , springer , berlin , 2008 , pp . 413429 .",
    "r. el - haddad , c. lcot , p. lecuyer , n. nassif , quasi - monte carlo methods for markov chains with continuous multi - dimensional state space , mathematics and computers in simulation 81 , ( 2010 ) , 560567 .",
    "m. evans , t. swartz , approximating integrals via monte carlo and deterministic methods , oxford university press , oxford , 2000 .",
    "g. s. fishman , monte carlo , springer , new york , 1996 .",
    "p. glasserman , monte carlo methods in financial engineering , springer , new york , 2004 .",
    "s. haber , a modified monte - carlo quadrature , mathematics of computation 20 ( 1966 ) 361368 . c. lcot , a direct simulation monte carlo scheme and uniformly distributed sequences for solving the boltzmann equation , computing 41 ( 1989 ) 4157 . , a quasi - monte carlo scheme using nets for a linear boltzmann equation , siam journal on numerical analysis 35 ( 1998 ) 5170 .",
    "c. lcot , b. tuffin , comparison of quasi - monte carlo - based methods for the simulation of markov chains , monte carlo methods and applications 10 ( 2004 ) 377384 . , quasi - monte carlo methods for estimating transient measures of discrete time markov chains , in : h. niederreiter ( ed . ) , monte carlo and quasi - monte carlo methods 2002 , springer , berlin , 2004 , pp . 329343 .",
    "p. lecuyer , efficiency improvement and variance reduction , in : j. d. tew , s. manivannan , d. a. sadowski , a. f. seila ( eds . ) , proceedings of the 1994 winter simulation conference , ieee press , 1994 , pp .",
    "p. lecuyer , c. lcot , a. larchevque - gaudet , on array - rqmc for markov chains : mapping alternatives and convergence rates , in : p. lecuyer , a. b. owen ( eds . ) , monte carlo and quasi - monte carlo methods 2008 , springer , berlin , 2009 , pp .",
    "p. lecuyer , c. lcot , b. tuffin , randomized quasi - monte carlo simulation of markov chains with an ordered state space , in : h. niederreiter , d. talay ( eds . ) monte carlo and quasi - monte carlo methods 2004 , springer , berlin , 2006 , pp .",
    "p. lecuyer , c. lcot , b. tuffin , a randomized quasi - monte carlo simulation method for markov chains , operations research 56 ( 2008 ) 958975 . m. d. mckay , r. j. beckman , w. j. conover , a comparison of three methods for selecting values of input variables in the analysis of output from a computer code , technometrics 21 ( 1979 ) 239245 .",
    "h. niederreiter , random number generation and quasi - monte carlo methods , siam , philadelphia , pennsylvania , 1992 .",
    "a. b. owen , monte carlo variance of scrambled net quadrature , siam journal on numerical analysis 34 ( 1997 ) 18841910 .",
    "m. stein , large sample properties of simulations using latin hypercube sampling , technometrics 29 ( 1987 ) 143151 ."
  ],
  "abstract_text": [
    "<S> we present several monte carlo strategies for simulating discrete - time markov chains with continuous multi - dimensional state space ; we focus on stratified techniques . </S>",
    "<S> we first analyze the variance of the calculation of the measure of a domain included in the unit hypercube , when stratified samples are used . </S>",
    "<S> we then show that each step of the simulation of a markov chain can be reduced to the numerical integration of the indicator function of a subdomain of the unit hypercube . </S>",
    "<S> our approach for markov chains simulates @xmath0 copies of the chain in parallel using stratified sampling and the copies are sorted after each step , according to their successive coordinates . </S>",
    "<S> we analyze variance reduction on examples of pricing of european and asian options : enhanced efficiency of stratified strategies is shown .    </S>",
    "<S> stratified sampling , monte carlo simulation , markov chains </S>"
  ]
}