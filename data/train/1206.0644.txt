{
  "article_text": [
    "astronomical research is benefiting from the use of large searchable catalogs made possible by advances in detector and computer technology . with the rapidly growing capacity of ccds ,",
    "astronomical objects are being detected at an increasingly fast rate .",
    "a major challenge to astronomy is being able to synthesize this large amount of data into an organized set of information that takes the form of a catalog .",
    "the catalog describes not only the properties of the images , but more importantly the sources detected within them . in its simplest usage , one can quickly determine whether an object is found in some region of space and examine its listed properties .",
    "but there are many other possible uses of a large catalog .",
    "for example ,",
    "non - positional ( all sky ) searches for objects with particular properties can provide statistical information on large numbers of objects .",
    "objects that lie at the extremes of the distributions provide the potential for new discoveries .",
    "advances in relational database technology have provided a means for building , storing , and searching large catalogs .",
    "this technology alone , however , is not sufficient .",
    "one reason is that the rate at which data is becoming available from detectors is on a path to exceed storage and processing capabilities of computers for a large class of problems @xcite .",
    "new approaches to data organization and new algorithms are needed to deal with the challenges of a telescope such as hubble space telescope ( hst ) . in the case of the hst ,",
    "some of these arise from its small field of view and the complex geometry of its overlapping exposures .",
    "crossmatching of detected sources from images taken at different wavelengths and at different epochs is a crucial capability for catalog construction . by matching source detections across multiple images to a single astronomical object , one",
    "can then determine spectral and temporal properties of the object .",
    "the statistical methodology introduced by @xcite provides a clean framework for determining symmetric @xmath0-way associations , and has been successfully applied in several studies including @xcite , @xcite , @xcite , @xcite and @xcite .",
    "performing crossmatching on hst observations also involves adjusting the positions of the images to place them into better alignment . in practice , these two are related , since the accuracy of the alignment is determined by how well the sources match together .",
    "one approach to crossmatching involves registering images against a known catalog , such as guide star catalog ( gsc ii ; @xcite ) or the sloan digital sky survey ( sdss ; * ? ? ?",
    "* ) skyserver database . in this approach ,",
    "the absolute position information in the catalog is used to anchor positions of matching sources detected in the images .",
    "sources from different images can then be compared .",
    "the drawback to this method is that few or none of the sources in the catalog may be in the image .",
    "this situation is particularly true of images taken by the hst which has a small field of view . on the other hand",
    ", it often detects many more sources than have been previously detected . a different approach , the one we adopt here , is to crossmatch the many sources in overlapping images taken by hst against each other , rather than against an existing catalog .",
    "the process involves adjusting the positions of the overlapping images to improve the residual errors in the crossmatching . in this case ,",
    "relative , rather than absolute , astrometry is determined involving many detected sources .",
    "absolute astrometric positioning can then later be determined by matching the set of overlapping images as a larger unit against the absolute standards .",
    "some astronomical projects , such the sdss , were designed with the goal of providing a catalog .",
    "the observations are made in a way that uniformly tiles regions of sky in certain filter bands and at certain regular time intervals .",
    "on the other hand , the hst as well as other major space observatories , have generally targeted particular sources , although particular programs have undertaken surveys for very limited regions of the sky . for more than two decades , images have been taken for many independent programs , resulting in a sparse , complex geometry of sky coverage and in irregular time intervals between observations of objects . in many cases ,",
    "the coverage involves partially overlapping exposures with a variety of outline sizes and shapes , orientations , filters , and exposure times .",
    "the hst has provided some of the highest resolution images ever obtained .",
    "therefore , in spite of the challenges , there is a potentially important scientific gain by having a catalog for hst .    the hubble legacy archive ( hereafter hla ; * ?",
    "* ) provides enhanced data products and advanced browsing capabilities online .",
    "its products include lists of detected sources and their photometric properties @xcite .",
    "these source lists are obtained running daophot @xcite and source extractor @xcite software on combined , drizzled images .",
    "each of these images is the result of combining exposures for a single instrument , detector and filter from a single visit ( pointing of hst ) .",
    "these source lists contain information about source positions , fluxes , magnitudes , morphology , etc .",
    "the source lists and auxiliary hla data provide the needed input information to implement our algorithms for the hubble catalog . by crossmatching the source lists based on these images , we obtain multi - wavelength time - domain information about astronomical objects .",
    "in this paper we describe some novel approaches to crossmatching with application to the construction of a catalog for hst . in section",
    "[ sec : xmatch ] we describe general algorithms for image clustering , astrometric correction , and source aggregation into matches .",
    "section  [ sec : catalog ] describes the pipeline that we have constructed to build an hst catalog based on these algorithms .",
    "section  [ sec : results ] contains an analysis of the properties of this catalog for acs / wfc and wfpc2 .",
    "section  [ sec : summary ] concludes our study .",
    "to create a reliable set of associations , we need high - precision astrometry .",
    "solutions exist for the global world - coordinate system ( wcs ; * ? ? ?",
    "* ) astrometric determination of large images ( e.g. , * ? ? ?",
    ". however , small images are still difficult to work with , especially when the sources are very faint , since they typically do not contain a sufficient number of calibration standard objects .",
    "the only possibility is to cross - calibrate the set of small overlapping images to obtain improved relative astrometry .",
    "once several of the small images are locked in and tied together , the number of available standards will increase that enables a more accurate absolute positioning .",
    "first we discuss how to cross - calibrate two or more images to improve their relative accuracy . later in the section ,",
    "we describe a bayesian method that determines the matching sources from sets of many nearby detections in overlapping images .",
    "crossmatching millions of sources contained in many irregularly placed images on the sky is a computationally challenging task .",
    "a substantial reduction in computational overhead is obtained by determining disjoint sets of overlapping images through a friends - of - friends ( fof ) algorithm .",
    "we use the term _ mosaic _ to describe each of these disjoint sets .",
    "since the mosaics are disjoint , the source matching is carried out independently within each and every one of them .",
    "the first step in creating sets of matched sources involves the identification of pairs of sources that reside in different images and are close together on the celestial sphere . a tolerance is then needed to be applied that depends on the accuracy of the relative astrometry .",
    "given the set of matched pairs in a mosaic , determined with some tolerance in separation , we next adjust the relative astrometry of the images that make up the mosaic , in order to reduce the separations of sources in the pairs .",
    "the traditional approach is to apply corrections to the world - coordinate system , which is often very expensive computationally , and involves many trigonometric function evaluations .",
    "here we choose a different approach , which is faster to calculate , and can accomplish multiple objectives in just one step .",
    "it is common practice to consider translations and rotations of the images in their x - y plane .",
    "our approach , however , is to use three - dimensional rotations on the celestial sphere .",
    "such transformations can account for both rotation and translation locally in the tangent plane .",
    "when the axis of the 3-d rotation is parallel with the pointing of a given image , the transformation indeed corresponds to a 2-d rotation .",
    "but if the axis is perpendicular to the pointing , the 3-d rotation results in a translation in the tangent plane . if we allow for any direction , a single transformation can describe a combined effect . here",
    "we work with 3-d normal vectors , which is often the preferred way in spherical calculations .",
    "we first consider an idealized problem where a single image is rotated in 3-d to minimize the separations of its sources from those matched to a fixed reference image .",
    "let @xmath1 represent the direction of the @xmath2th detection in the image , and let @xmath3 be a matching reference direction .",
    "we can form a set of @xmath4 pairs to be used in the astrometric correction .",
    "now we have to solve an optimization problem for the 3-d rotation @xmath5 .",
    "the transformed position would be @xmath6 .",
    "hence the optimization formally is @xmath7 ^ 2   \\right\\ } \\label{mr}\\ ] ] where @xmath8 is the precision parameter that is related to the @xmath9 accuracy via @xmath10 .",
    "much like the potential energy stored in springs , our cost is quadratic in the displacements , and can be thought of as a system of springs , where the spring constants are proportional to the @xmath8 weights .",
    "the solution is the equilibrium position of the sphere with a fixed center , which is given by the @xmath11 rotation matrix .",
    "this general optimization , however , is computationally expensive . for this reason ,",
    "working with orthonormal matrices is not practical .",
    "but for small corrections , _ infinitesimal rotations _ are ideally suited .",
    "infinitesimal rotations have many advantageous mathematical properties over general 3-d rotations .",
    "for example , they are commutative .",
    "let @xmath12 represent the axis and the angle of the rotation .",
    "the axis is defined by the direction and the angle is the length of the vector .",
    "the infinitesimal transformation is then @xmath13 considering that the change is perpendicular to @xmath14 and small in amplitude , the resulting vector @xmath15 stays approximately normal to quadratic order in @xmath16 .",
    "the optimization problem with the infinitesimal rotation becomes analytically tractable .",
    "the cost function , whose minimization yields the @xmath17 estimate , is now not only quadratic in the displacement but also in its @xmath12 parameter , @xmath18 ^ 2   \\right\\}. \\label{vomhat}\\ ] ] by requiring that the gradients equal zero , we obtain a 3-d linear equation @xmath19 which is a result of the summations @xmath20 where @xmath21 is the identity matrix , and @xmath22 is the operator of the dyadic product . a derivation of equation  ( [ omeq ] )",
    "is given in appendix  [ app1 ] .",
    "in keeping with the spring analogy described below equation  ( [ mr ] ) , equation  ( [ omeq ] ) can be interpreted as a torque equation .",
    "vector @xmath17 can be considered an angular acceleration vector of a sphere at an early time after its release that is related to its angular displacement at this early time .",
    "the sphere that has springs connecting each point @xmath23 of mass @xmath8 located at position @xmath1 to the fixed standard located at @xmath3 .",
    "matrix @xmath24 is the moment of inertial tensor for sources that lie on the unit sphere that is subject to a torque given by @xmath25 .",
    "notice that in the equation for @xmath25 , quantity @xmath26 can be replaced by @xmath27 , which is the force due to the spring . since @xmath24 is a matrix , equation  ( [ omeq ] ) has a simple analytic solution for @xmath17 , e.g. , by applying of cramer s rule for matrix inversion .",
    "in practice , the matrix inversion can be performed numerically by one of several possible methods .",
    "the cost of the aggregation is linear in the number of pairs , and the matrix inversion involves a small number of operations .",
    "therefore , the computational overhead for this approach is likely to be close to optimal .",
    "so far we assumed that there is a set of @xmath28 calibrators in a fixed , perfect reference image , which is clearly not true in our case .",
    "instead we have imprecise source positions contained in groups of overlapping observations , the mosaics . in each mosaic",
    "we want to correct every one of the images , but the combined minimization problem is not as simple as it is for a single image . since we are only concerned with relative precision , different heuristic approaches come to mind to work around the lack of a true set of reference positions . for example , one of the images could be singled out to act as a reference frame onto which all others are corrected . in a group of images , however , there is no guarantee that there is a single image with which all others would overlap , because a mosaic consists of friends of friends .",
    "another option would be to use the average positions of a preliminary match .",
    "we follow a third approach where the correction of a given image is based on all the other images .",
    "one - by - one we consider each image and derive their corrections independently , effectively assuming that all the others are perfect .",
    "hence we use them as calibrators .",
    "the matched pairs being applied to equation ( [ omeq ] ) are then all the pairs for the mosaic involving the image being corrected .",
    "having derived the infinitesimal rotation for all images , we update the source positions with the appropriate corrections and repeat until convergence .",
    "the @xmath12 vectors are accumulated , i.e. , summed up , for each image ( cf .",
    "commutativity of infinitesimal rotations ) and saved for future reference .",
    "this also enables us to safely work with clean samples of stars , but apply the correction for all sources afterwards .",
    "one can also use this information to correct the alignment of the images in their wcs headers to reflect the changes .",
    "now we use the astrometrically improved coordinates to perform a final cross - identification .",
    "this time we apply a smaller tolerance than the initial crossmatch , and again produce matched pairs of sources , as discussed in section  [ sec : pairs ] .",
    "once all close source pairs are identified across images , the next step is to run a friends - of - friends ( fof ) algorithm , also known to statisticians as single - linkage hierarchical clustering , to link all nearby detections into singly connected graphs .",
    "such clustering is very efficient and can be easily implemented in any programming environment .",
    "the fof groups enumerate all the sources that can be linked together using a specified pairwise distance threshold .",
    "there is no guarantee , however , that this algorithm provides statistically meaningful matches .",
    "for example , by linking nearby sources along a line , we can potentially construct very long chains whose ends are far away from each other @xcite .",
    "these fof matches are just considered preliminary and need to be studied further .",
    "we note that other hierarchical clustering methods also exist @xcite , whose performance depends on the nature of the data and the goals of the project . here",
    "we look for clusters only to provide candidates for the cross - identification .",
    "preliminary experiments with several off - the - shelf tools , including average and complete linkage , were performed on select areas without noteworthy accuracy or speed improvements .",
    "these other tools also provide clusters with a wide range of sizes and shapes . for cross - matching",
    ", we are interested only in identifying isolated compact clusters . to accomplish this",
    ", we apply a bayesian method to evaluate the likelihood of various possible clusters based on the separation of the members and the estimated positional errors .",
    "the question is whether breaking up the fof groups into smaller ones could yield better models , and if the answer is yes , which configuration would the best .",
    "we can address the issue by applying a bayesian model comparison .",
    "if @xmath29 represents the entire set of @xmath0 positions in a given fof group , we can consider alternative hypotheses , where @xmath29 is partitioned into disjoint components that correspond to separate objects .",
    "the baseline case is when we have a single component .",
    "but there could be as many components as the number of detections .",
    "in general , let @xmath30 represent a hypothesis with @xmath31 components with model directions @xmath32 for .",
    "also let @xmath33 be the list of sources that are assigned to each component and @xmath34 their measured directions such that @xmath35 and @xmath36 similar to the problem of probabilistic cross - identification discussed by @xcite , the likelihood of @xmath30 can be derived from the astrometric uncertainties and the prior on the directions of the objects .",
    "in general , it is essentially just the product of the individual @xmath31 matches @xmath37 the calculation is analytic if the uncertainty is modeled with the spherical normal distribution @xcite @xmath38 and the prior is isotropic @xmath39 where @xmath40 is the dirac @xmath41-function",
    ".    we can derive the improvement over the case @xmath42 when all detections are considered separate , cf .",
    "@xcite . in the limit of high astrometric accuracies ,",
    ", the bayes factor becomes @xmath43 where @xmath44 is the angular separation between the @xmath45 and @xmath46 vectors , and the unmarked @xmath23 and @xmath47 summations are over the corresponding @xmath33 sets .",
    "note that this equation is also valid for singleton groups with only one detection because the summation includes the @xmath23=@xmath47 cases , for which the separation is 0 by definition .",
    "other subdivisions of an fof group can be evaluated against each other using the corresponding bayes factors , the ratios of their likelihoods , which can be directly evaluated from the previous formula .",
    "for example , comparing @xmath48 and @xmath49 yields @xmath50 where the @xmath51 baseline case simply cancels out .",
    "when the value is 1 , the case is indecisive but if , the measurements prefer the @xmath48 hypothesis ; otherwise @xmath49 is favored .    while the statistical approach for selecting the best components is clear in principle , the problem is still impossible to fully solve in practice due to its combinatorial nature . for fof associations of , say , only 20 sources , the computational cost of exploring all possible combinations is simply prohibitively large .",
    "thus we resort to a greedy algorithm that essentially corresponds to a shrinking pairwise distance threshold .",
    "each fof group is represented as a connection graph , where the edges link the nearby sources .",
    "we build the initial graph of the group , and evaluate its @xmath31=1 baseline likelihood .",
    "next we repeatedly break the longest edge until the graph splits .",
    "we then evaluate the new hypothesis of these two components ( @xmath31=2 ) against the baseline .",
    "if the new model is more likely , i.e. , the bayes factor is greater than unity , we save it along with ( the logarithm of ) its likelihood .",
    "afterwards we repeat the same steps to further break the subgraphs until we end up with separate objects with no connections at all .",
    "the result is a set of possible associations that are better than the original . out of these",
    "we can pick the most likely .",
    "the hla contains metadata extracted from hst images .",
    "they are stored in a commercial microsoft sql server 2008 database .",
    "the overall design builds on the success of the sloan digital sky survey s skyserver archive and applies a number of its extensions developed for spatial searches and spherical geometry . in this section , we describe our implementation of the aforementioned algorithms that runs completely inside the database engine , which in turn provides efficient parallel execution and rapid access to derived data products .",
    "the hst pointings generally do not follow any particular tiling pattern on the sky . during its long life ,",
    "the hubble telescope has taken over a half - million exposures date , and many of these overlap with others from different programs .",
    "we can determine the overlapping exposures based on their intersecting sky coverage .",
    "the geometry of all visits is stored inside the database using the spherical library , along with its sql routines and spatial indexing facilities @xcite .",
    "the hla contains source lists that are based on applying combined drizzled image files to daophot and source extractor software .",
    "they provide positional and other information for each detected source .",
    "we have carried out the crossmatching on the set of source extractor source lists available from dr6 of the hla for acs / wfc and wfpc2 taken together .",
    "furthermore , we only consider sources that are determined to be good quality by source extractor , which means that the flags value is less than 5 .",
    "the crossmatching process operates on each set of source lists in a mosaic .",
    "the absolute astrometry of the hla images is determined by the pointing of accuracy of hst , which is about 1 to 2 arc - sec in each coordinate",
    ". the hla attempts to correct the absolute astrometry further by matching against three catalogs : guide star catalog 2 ( gsc2 ) , 2mass , and the sloan digital sky survey ( sdss ) catalog .",
    "the typical absolute astrometric accuracy of the hla - produced images is @xmath520.3 arcsecs in each coordinate .",
    "the majority of images , about 80% of acs / wfc , are corrected in this way .",
    "the source detections made in the hla are obtained in two steps .",
    "first , all images within a visit ( hst pointing ) for a given detector are combined to produce a `` white - light '' detection image , the deepest image possible for the visit .",
    "source extractor is then run on the detection image to identify source positions . in the second step , source extractor is run on each `` color '' ( single filter ) combined image within the visit for each detector to find sources at the positions identified by the detection image .",
    "if a source is found at an indicated position , then its properties are determined and stored in a database table .",
    "there are currently about 49,000 source lists containing about 46 million source detections .",
    "given the above procedure for extracting sources , it makes no sense to crossmatch them in different filters for the same detector and visit .",
    "the reason is that , for a given detector and visit , color sources are constructed to have exactly the same position when they exist in different filters .",
    "therefore , crossmatching must be carried out across visits and detectors . to do this , for each detector , we need to use visit level white - light source lists and the geometric outlines for the visit level combined images . the geometric outlines are used to determine the mosaics described in section  [ sec : pairs ] .",
    "both the white light source lists and the geometric outlines are determined from available source lists and image metadata that reside in the hla database .    fig .",
    "[ fig : mossize ] plots the distribution of the number of white - light images within a mosaic . for smaller mosaics ,",
    "the results follow a power law decline in frequency with number of images .",
    "the fall - off occurs with an index of about -2.5 and approaches unity at around 50 images .",
    "there is , however , a long tail that extends beyond that to almost 2000 images .",
    "this tail involves many of the large hst programs , such as the ultra deep field ( udf ) .",
    "much of the computational challenge lies in the crossmatching within the mosaics of this tail .",
    "mosaics are constructed by the application of the algorithms described in section [ sec : pairs ] .",
    "the determination of mosaics is efficiently accomplished by using the hierarchical triangular mesh indexing ( htm ; * ? ? ?",
    "* ) to determine white - light images that are close to a given image and by using the spherical library @xcite to determine whether the images actually overlap .",
    "the pipeline completes the cross - matching on mosaics sequentially .",
    "that is , the crossmatching of sources is carried out for one mosaic at a time . within each mosaic ,",
    "the pipeline determines pairs of white - light sources whose separations are less than 0.3 arc - sec .",
    "this threshold is required to accommodate some of the more significant systematic offsets between the images .",
    "larger offsets are currently not considered in this study .",
    "this matching can be carried out efficiently in an sql database that is indexed on ra and dec .",
    "using the white - light source pairs , the pipeline carries out astrometric corrections of the images within a mosaic using the algorithms described in section [ sec : astrometry ] . the astrometric correction algorithm that uses infinitesimal 3-d rotations",
    "is implemented in the c # programming language and is integrated directly into the database .",
    "the query that selects sources for astrometric correction is limited to detections that are likely stars based on the morphology . despite the risk presented by the resolved objects",
    ", we also experimented with using the both resolved and unresolved sources also , which has the advantage of having more sources .",
    "but we obtained similar global results in most cases .",
    "the details of the sample selection for the correction might change in the future .",
    "as described in section [ sec : astrometry ] , the astrometric correction procedure iterates through all images in a mosaic and corrects them one - by - one assuming the others are correct . the initial large angular separation limit is decreased over time . in this way , any possible wrong associations ( due to the generous threshold ) are later eliminated as the relative calibration of the images tightens up .",
    "the convergence of the procedure is fast , but can be affected by erroneous initial matches . to avoid such situations ,",
    "we exclude at run time all the pairs whose angular separation grows too large during the iterative optimization , as opposed to shrinking as expected .",
    "the transformations are persisted in a database table and are available to future pixel - level corrections that can potentially improve the quality of a combined image . using the refined astrometry of all images , the cross - identification is performed once more with similarly large thresholds , so the list of matching pairs of sources is as inclusive as possible .",
    "the pairwise matches are quickly grouped into fof clusters that are obtained by using the sorted tables with appropriate primary keys .",
    "these clusters then provide preliminary sets of matched sources , which might contain large chains that may then be split by the bayesian method described in section [ sec : comparison ] .",
    "this probabilistic splitting is carried out by an sql stored procedure called the _ chainbreaker _",
    ", which is also written in the c # language .",
    "it reads all the sources grouped into matches and builds a graph out of them . using the refined astrometric positions , we can safely ignore large separations and start with a 0.1 arc - sec linking length . for each match",
    ", the splitting procedure considers a number of cases , using the greedy algorithm of section  [ sec : comparison ] , all the way to separate objects .",
    "each result that proves to be better than the unsplit case is saved in a database table .    for each match",
    ", the _ chainbreaker _ selects the most favorable case based on equations  ( [ eq : bf1 ] ) and ( [ eq : bf2 ] ) , and stores the results in database tables that are used for catalog construction .",
    "the output of the stored procedure includes all the values that are required to link to the hla database and to fetch any relevant details of the observations related to the sources .",
    "the astrometric correction , fof and chainbreaker steps are conceptually intertwined .",
    "after completion of the entire procedure , one could analyze the astrometric uncertainties and revise the results by running the procedure repeatedly .",
    "this is a possible direction of further studies .",
    "a completely integrated scheme , where the chainbreaker is applied in each astrometric iteration , is impractical due to its computational cost .",
    "after the matching of the white - light sources is completed , we apply the available color ( filter ) level information for each white - light source and store the results in a database table for the catalog . the source catalog",
    "we construct then contains the information about the source detections in each filter of a visit .",
    "we also include in the catalog the cases of color non - detections , i.e. , color dropouts , within a visit .",
    "such non - detections can be inferred from the two - step source detection process described above , since we know which images were used to build the white - light detection image and which images contained a source detection at a given position .",
    "consider the case that a user specifies a region - based ( e.g. , position and search radius ) search of the catalog .",
    "another form of non - detection arises in this case when no source is found within a white - light image that overlaps with this user specified region .",
    "all such white - light non - detections can not be stored in a database , but instead are inferred at run time within the catalog search function we have developed .",
    "we therefore provide information about detections and two types of non - detections ( color and white - light ) .",
    "the matches are a collection of color source detections and color non - detections ( as described above ) that lie sufficiently close together in the sky .",
    "( white - light nondetections do not belong to a match . )",
    "each match consists of at least one detected source .",
    "each match can be considered to be describing a single physical object whose properties are determined by the properties of sources in the match . for example , each match has a certain position associated with it ( matchra , matchdec ) that is determined by its source positions .",
    "this position is considered to be the location of the object described by the matched sources .",
    "not all matches involve different visits or detectors .",
    "for example , images that are crossmatched generally contain some sources do not match those in an image obtained from a different detector or visit .",
    "for other cases , the source could not be crossmatched because the image containing the source did not overlap sufficiently with an image from another visit or detector .",
    "about 60% of the images with source lists could not be crossmatched with other images .",
    "the sources in these images are also included in the catalog for completeness . in this case , the matches only involve a single detector and visit .",
    "the crossmatching of the hla dr6 acs / wfc and wfpc2 source lists was carried out with sql server 2008 running on a single ( aging ) dell poweredge 2950 server with intel xeon e5430 @ 2.66ghz ( 2 processors ) and 24 gb of memory . the entire pipeline for matching the sources and building the catalog runs automatically , and takes a few days to complete .",
    "the final catalog is comprised of entries for over 45 million sources detections and 15 million color dropouts for acs / wfc and wfpc2 . the catalog indicates which sources match together . among the matches that involve more than one visit",
    ", there are on average 5.4 detected ( color ) sources , which on average involve 3.8 different visits .",
    "the left panel of fig .",
    "[ fig : matchsize ] plots the cumulative number of detected sources as a function of the number of detected sources in a match .",
    "about 40% of the sources are in matches with only one detected source .",
    "about 30% of these cases involve non - overlapping or insufficiently overlapping images .",
    "about 20% of the sources are in matches with 5 or more detected sources .",
    "about 2% of the sources lie in matches with 50 or more sources .",
    "the right panel of fig .",
    "[ fig : matchsize ] is similar to the left panel , but restricted to crossmatched sources . in this case , there are no matches with less than 2 sources , as required for crossmatching .",
    "all these sources are in images that have been astrometrically corrected by our algorithm .",
    "about 6 million cross - identified detections lie in matches with more than 10 sources .    for each set of matching sources , we determine the standard deviation of the positions among the white light sources involved in the match , where more than one white light source is involved .",
    "( the white light sources are used because they are involved in the crossmatching and are statistically independent , unlike the color sources . ) the distribution of the standard deviations for all matches involving more than one white - light source is shown in fig .",
    "[ fig : sigmac ] .",
    "the lower curve is based on the the current hst astrometry for these matching sources , i.e. , positions before our astrometric correction is applied .",
    "the upper curve is based on positions after astrometric correction .",
    "the median before astrometric correction is 32.5 mas .",
    "the peak ( or mode ) of the astrometrically corrected distribution is 3.0 mas , and the median is 9.1 mas .    in order to test the validity of these matches",
    ", we compare the values of the fluxes determined by source extractor within radii of 3 pixels of the source centers ( fluxaper2 ) for pairs of source detections in the same match that have the same instrument , detector and filter .",
    "no constraints are applied on the exposure times of the sources in the pairs .",
    "apart from variable objects that are rare , we expect the flux difference to be small if the match corresponds to a single object .",
    "flux differences may also be caused by detector degradation over time .",
    "we do not attempt to account for this effect in this paper .",
    "we define the fractional flux difference between source pairs @xmath23 and @xmath47 having fluxes @xmath53 and @xmath54 to be @xmath55 with this definition , we have that @xmath56 in fig .  [",
    "fig : dfluxmix ] , we plot in solid lines the distributions of @xmath57 for acs / wfc and wfc2 for pairs in the same match that have the same instrument , detector and filter .",
    "we compare these results to corresponding cases where pairs are not matched . to carry out this comparison , we considered the same set of pairs as those used in the respective solid lines and mapped the sources in each pair to a random pair taken from the same pair of images .",
    "the figures show that the matched pair distributions have strong peaks near , while the randomly selected pairs have a very broad distribution with a mild peak near .",
    "the results provide evidence that these matches contain repeated observations of the same physical object .    a more detailed view of the flux differences for matched pairs is shown in fig .",
    "[ fig : dfluxacswfpc2 ] .",
    "the width of the acs flux distribution , based on where normalized distribution equals 0.5 , is equal to 0.027 and the corresponding width of the wfpc2 flux distribution is equal to 0.047 .",
    "the smallness of the widths reflect the accuracies of both the matching and the hst photometry .",
    "since no constraints are applied to the exposure times of the matched pairs , some of the larger flux differences likely involve detections of faint sources with short exposure times . in some other cases",
    ", the flux differences may reflect physical changes in the source brightness .",
    "we determine effectiveness of the chainbreaker in splitting unphysical matches by again considering fractional flux differences between pairs of matching sources that have the same instrument , detector and filter .",
    "[ fig : dfluxchain ] shows the comparison of the distributions before and after the application of the chainbreaker . for the case of acs / wfc",
    ", we see that the chainbreaker was effective in reducing the incidence of unphysical matches in the tail of the distribution .",
    "we note that the plot is semi - logarithmic and the apparent offset between the two curves involves only a small fraction of the matches .",
    "a smaller improvement was made for the case of wfpc2 .",
    "we consider the time distribution covered by the matches .",
    "this time coverage of a match is defined as the difference between the earliest start time and latest stop time for the exposures containing detected sources in the match .",
    "the largest match time span is 6419 days or about 17.5 years .",
    "the time span distributions are plotted in fig .",
    "[ fig : timeg ] .",
    "the number of matches greater than some time span falls off roughly logarithmically with the time span . over 1 million matches involving about 10 million source detections",
    "have a time span greater than a few days . about @xmath58 matches involving about 5 million",
    "source detections have a time span greater than a year . about 10%",
    "of the detected sources lie in matches with a duration of more than a year .",
    "about 30% of the crossmatched source detections lie in matches that have a duration of more than one year .    many of the matches involve more than one filter . fig .",
    "[ fig : filterg ] shows that more than one million matches involve multiple filters .",
    "matches involve as many as 21 filters of detected sources and as many as 27 filters of detected sources and color dropouts .",
    "more than @xmath59 matches involve more than 5 filters for detected sources and more than @xmath60 matches involve more than 5 filters for detected sources and dropouts .",
    "[ fig : filtertimedens ] shows how the frequency of matches depends jointly on the number of filters and the time duration of a match .",
    "the minimum match duration considered is one day which implies that all matches being considered involve more than hst visit .",
    "the frequency of matches extends to long time spans for matches with less than 5 filters .",
    "there are bands of many - filter cases at several time spans .",
    "we developed a new approach for positional cross - matching astronomical sources that is well suited to the hubble space telescope ( hst ) .",
    "we applied the approach to crossmatching hst sources detected in the same or different detectors ( acs / wfc and wfpc2 ) and filters .",
    "the hst observations comprise a unique astronomy resource . preserving the measurements and enhancing their value are important but challenging tasks .",
    "while the overall volume of data is moderate by today s standards , the dataset presents a number of difficulties .",
    "one of them is the small field of view that does not contain enough calibrators to accurately pin down the astrometry of the images .",
    "we presented a new algorithm that can cross - calibrate overlapping images to each other .",
    "we introduced infinitesimal 3-d rotations for this purpose , which yield an analytically tractable optimization procedure .",
    "our implementation of this scheme is sufficient to provide high - precision relative astrometry across overlapping images .",
    "the improved astrometric accuracy of source positions is typically about a few milli - arcseconds ( see fig .  [",
    "fig : sigmac ] ) .",
    "another challenge is to deal with the complex placement of the images on the sky and the fact that certain parts of the sky are observed many times ( see fig .  [",
    "fig : mossize ] ) . instead of the naive combinatorial scaling ,",
    "we achieve high efficiency in a greedy `` chainbreaker '' procedure that applies bayesian model selection to find the best matches within a mosaic .    to check on our matching results , we analyzed the flux differences between sources in the same match with the same instrument , detector and filter , which should optimally be zero ( ignoring variable sources ) .",
    "we found that the astrometric correction and the probabilistic object selection provide reliable matches ( see fig .",
    "[ fig : dfluxmix ] ) .",
    "based on just positional information , the bayesian model selection rejects spurious matches and improves the tail of the distribution with large flux deviations ( see fig .",
    "[ fig : dfluxchain ] ) .",
    "we demonstrated that many of the matches cover a broad range of time spans and filters ( figs .",
    "[ fig : timeg ] , [ fig : filterg ] , and [ fig : filtertimedens ] ) .",
    "therefore , the catalog should enable time - domain , multi - wavelength studies of sources detected by hst .",
    "the catalog also provides information about nondetections .",
    "the presented catalog is publicly available online via web forms as well as an advanced query interface .",
    "the catalog provides a basis for further extensions , such as by including other detectors and source lists based on other software .",
    "the algorithms and tools developed in this paper are not specific to the hubble space telescope .",
    "they are directly applicable to any astronomy observations that exhibit similar challenges .",
    "we benefited from inspiring discussions with alex szalay , rick white , and brad whitmore on different aspects of the project .",
    "we acknowledge assistance on a previous approach to this project by nathan cole .",
    "we are grateful for support from nasa aisrp grant nnx09ak62 g .",
    "in this section we provide a short derivation for equation  ( [ omeq ] ) using a variational method .",
    "this approach to the minimization is equivalent to writing out the components of the vectors and matrices to obtain the vanishing partial differentials , but more concise .",
    "the quadratic cost function is @xmath61 ^ 2 \\ .\\ ] ] its minimization yields the value of @xmath17 defined by equation  ( [ vomhat ] ) , that is , @xmath62 to determine the @xmath17 solution , we consider small variations in @xmath63 for and require that they vanish .",
    "this procedure is equivalent to requiring that the partial derivatives of @xmath63 with respect to the components of @xmath12 vanish at .",
    "the linear variation of the cost function due to a small @xmath64 change is @xmath65 \\cdot       ( \\delta { { { \\mbox{\\boldmath{$\\omega$}}}}}\\times{{{{\\mbox{\\boldmath{$r$}}}}_{{{i } } } } } ) \\ . \\label{dc}\\ ] ] we use the fact that the terms in a scalar triple product can be cyclically permuted as in @xmath66 \\ , \\ ] ] and the known equivalence for the vector triple products , in addition to that for the dot products of two cross products , @xmath67\\\\     & = & -\\delta { { { \\mbox{\\boldmath{$\\omega$}}}}}\\cdot \\left [ { { { { \\mbox{\\boldmath{$r$}}}}_{{{i}}}}}\\,({{{{\\mbox{\\boldmath{$r$}}}}_{{{i}}}}}\\cdot      { { { \\mbox{\\boldmath{$\\omega$ } } } } } ) - r_i^2 \\ , { { { \\mbox{\\boldmath{$\\omega$}}}}}\\right ] \\ .\\end{aligned}\\ ] ] since all @xmath68 are unit vectors , i.e. , , equation  ( [ dc ] ) can now be written as @xmath69 \\ .\\ ] ] by requiring that for arbitrary , but small @xmath64 , we have that @xmath70   = 0 \\ .\\ ] ] the cross - product of any vector by itself vanishes , so , and the final result is @xmath71   = 0 \\ .\\ ] ] symbol @xmath21 represents the identity and @xmath22 is the dyadic vector product , hence the term in parenthesis is a linear operator applied to the @xmath17 vector .",
    "this formula is equivalent to equation  ( [ omeq ] ) in the main body of the article ."
  ],
  "abstract_text": [
    "<S> object cross - identification in multiple observations is often complicated by the uncertainties in their astrometric calibration . due to the lack of standard reference objects , an image with a small field of view </S>",
    "<S> can have significantly larger errors in its absolute positioning than the relative precision of the detected sources within . </S>",
    "<S> we present a new general solution for the relative astrometry that quickly refines the world coordinate system of overlapping fields . </S>",
    "<S> the efficiency is obtained through the use of infinitesimal 3-d rotations on the celestial sphere , which do not involve trigonometric functions . </S>",
    "<S> they also enable an analytic solution to an important step in making the astrometric corrections . in cases with many overlapping images , </S>",
    "<S> the correct identification of detections that match together across different images is difficult to determine . </S>",
    "<S> we describe a new greedy bayesian approach for selecting the best object matches across a large number of overlapping images . </S>",
    "<S> the methods are developed and demonstrated on the hubble legacy archive , one of the most challenging data sets today . </S>",
    "<S> we describe a novel catalog compiled from many hubble space telescope observations , where the detections are combined into a searchable collection of matches that link the individual detections . </S>",
    "<S> the matches provide descriptions of astronomical objects involving multiple wavelengths and epochs . </S>",
    "<S> high relative positional accuracy of objects is achieved across the hubble images , often sub - pixel precision in the order of just a few milli - arcseconds . </S>",
    "<S> the result is a reliable set of high - quality associations that are publicly available online . </S>"
  ]
}