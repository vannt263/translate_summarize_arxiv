{
  "article_text": [
    "in many modern applications the data is discrete , and hundreds , or even thousands , of hypotheses are simultaneously tested . in order to control for false - positives , a multiple testing procedure may be applied that either controls the probability of at least one false positive ( family - wise error ) or the expected proportion of true null hypotheses rejected out of all rejected hypotheses , known as the false discovery rate ( fdr , @xcite ) .",
    "researchers have been active in developing methodologies for controlling the fdr , see @xcite for an overview .",
    "however , little has been written about controlling the fdr when the data is discrete .    in many modern applications",
    ", it may be more appropriate to apply a multiple testing procedure that controls the false discovery rate ( fdr ) over a family - wise error controlling procedure .",
    "one such application with discrete data comes from pharmacovigilance systems for marketed medicines , that collect and monitor spontaneous reports of suspected adverse events from health - care providers . in order to detect new adverse drug reactions after the drug marketing approval",
    ", multiple hypotheses of no association between drugs and adverse events are simultaneously tested periodically in the pharmacovigilene databases .",
    "pharmacovigilance and all drug safety issues are relevant for everyone whose life is touched in any way by medical interventions . in the analysis of pharmacovigilance systems ,",
    "the aim is not to substitute the expertise of the pharmacovigilance experts but rather to draw attention to unexpected associations by acting as hypothesis generators .",
    "the associations thus found are then destined to be further investigated , so it is possible to tolerate few false discoveries as long as they are a small fraction of the discoveries .",
    "another modern application area is genomics research .",
    "high - throughput next generation sequencing ( ht - ngs ) technologies output a list of sequence reads .",
    "these sequences are mapped to their genomics locations .",
    "the data for statistical analysis is tag counts . in order to test for enriched regions , the null distribution of counts",
    "discrete data is also encountered in genome wide association studies , where minor allele frequency of diseased and non - diseased individuals are compared simultaneously in hundreds of thousands of single - nucleotide polymorphisms .",
    "the procedure introduced by @xcite , henceforth referred to as the bh procedure , is the original and still very popular multiple testing procedure for controlling the fdr .",
    "if the null distribution of the @xmath0-values is uniform and the @xmath0-values are independent , then the fdr of the bh procedure at level @xmath1 is @xmath2 , where @xmath3 and @xmath4 are the number of hypotheses and the number of true null hypotheses respectively @xcite .",
    "however , for discrete test statistics the null distribution of the @xmath0-values is stochastically larger than the uniform , and therefore the fdr of the bh procedure may be much smaller than @xmath2 .",
    "this is so because the expression for the fdr of the bh procedure involves sums with the terms @xmath5 @xcite , where @xmath6 is the @xmath0-value of a true null hypotheses @xmath7 , @xmath8 . if the null distribution of the @xmath0-value is uniform , then @xmath9 . but for discrete data",
    ", @xmath5 may be less than @xmath10 and , the greater the gaps between @xmath5 and @xmath10 , the smaller the true fdr level of the bh procedure .",
    "thus , the bh procedure may be conservative for discrete data , in the sense that its actual fdr level may be smaller than @xmath2 .",
    "note that this conservatism does not go away with an increase in the number of hypotheses , nor with modifications of the original bh procedure that can provide higher power by incorporating an estimate of the number of null hypotheses ( such as , for e.g. , the adaptive procedure in @xcite ) .",
    "few other approaches that take the discreteness into account for fdr control have been suggested in the literature .",
    "@xcite suggested an fdr controlling procedure using randomized @xmath0-values ( from randomized tests ) to account for the discreteness of the null distribution , thus guaranteeing that the p - values are uniformly distributed under the null , and therefore that the fdr is controlled exactly at the desired level when the @xmath0-values are independent .",
    "interpretation of results is not straightforward in this case though , due to the randomness of the @xmath0-values .",
    "@xcite proposed a two step fdr controlling procedure for discrete data .",
    "first , remove the null hypotheses with test statistics that are unable to reach a certain level of significance .",
    "second , apply the bh procedure to the remaining hypotheses .",
    "this approach does not exploit the discreteness of the test statistics that are not removed in the first step .",
    "@xcite suggested a discrete bh procedure , that exploits more fully the discrete null distributions of the test statistics , and demonstrated in simulations that it has power advantage over the procedure of @xcite .",
    "however , the procedure by @xcite controls the fdr while the procedure in @xcite may be anti - conservative . @xcite used @xmath11-values in conjunction with an fdr controlling procedure for the analysis of pharmacovigilance systems , and provided simulation results that suggest that it is an improvement over using the @xmath0-values .",
    "our first aim in this work is to study the properties of the bh procedure using @xmath11-values .",
    "we will prove that the actual fdr level of the bh procedure based on @xmath11-values is closer to the nominal level than the bh procedure based on @xmath0-values .",
    "we will also derive an upper bound on the fdr level of the bh procedure based on @xmath11-values .",
    "a straightforward modification of the procedure in @xcite will be to apply this procedure using @xmath11-values .",
    "we will compare and contrast this resulting new procedure with the procedure suggested by @xcite .",
    "the bh procedure is a step - up procedures .",
    "@xcite suggested a step - down procedure for fdr control , called henceforth the bl procedure .",
    "our second aim in this work is to study discrete analogues to the bl procedure .",
    "we develop a novel discrete bl procedure and prove that it controls the fdr at the nominal level .",
    "we will compare and contrast this novel procedure with proven fdr control , to the new procedure that results from removing first the null hypotheses with test statistics that are unable to reach the nominal level of significance , and then applies the bl procedure on @xmath11 values .",
    "the paper is organized as follows .",
    "section 2 introduces the relevant procedures and discusses theoretical properties of these procedures .",
    "section [ sec - example ] applies the procedure on an example from a pharmacovigilance database . in the example",
    ", more suspect drugs can indeed be discovered with the procedures that take discreteness into account .",
    "section 4 evaluates the proposed procedures by simulation , and section 5 concludes with final remarks .",
    "an r package _ discretemtp _ to perform the step - up and the step - down discrete multiple testing variates of bh and bl , respectively , is available from the first author web page or cran .",
    "consider a family of @xmath3 hypotheses @xmath12 with corresponding @xmath0-values @xmath13 .",
    "let @xmath14 be the indices of the true null hypotheses , and @xmath15 be the number of null hypotheses . sorting these @xmath0-values , we get @xmath16 with corresponding null hypotheses @xmath17 .    in this section",
    "we illustrate the different fdr controlling procedures using a small data example summarized in table [ tab - smallexample ] , that relates treatment to an adverse event for 10 studies .",
    "this is a subset of the 41 studies considered in @xcite .",
    ".table relating treatment to adverse event , for 10 studies . among the treated ,",
    "the occurrences and nonoccurrences were @xmath18 and @xmath19 respectively ; among the controls , the occurrences and nonoccurrences were @xmath20 and @xmath21 respectively ; the @xmath0-value was computed from a one - sided fisher s exact test for @xmath22 tables ; the @xmath11-value is the average of the @xmath0-value with the next smallest @xmath0-value that could possibly be observed in fisher s exact test with the same fixed margins as observed . [ cols=\">,>,>,>,>,>,>\",options=\"header \" , ]     incorporating dependency among the test statistics , as described in section [ subsec - structuresim ] , did not result in any of the procedures being anti conservative . as in the independence setting , the discrete procedures were more powerful ( not shown ) .",
    "the bh procedure on @xmath0-values appears to control the fdr in more circumstances that are not highly artificial @xcite , @xcite .",
    "this robustness property appears in our simulations to be carried over to the discrete analogues of the bh procedure .",
    "similarly , the step - down procedures were robust to deviations from independence , as considered in our simulations .",
    "we demonstrated that the fdr level may be much lower than the nominal level @xmath1 when applying the bh or bl procedures at level @xmath1 on discrete test statistics . by adjusting for discreteness , it was possible to achieve tighter control of the fdr and higher power .    in the simulations considered , the dbh and dbl procedures were more powerful than the tarone+@xmath11 adjusted bh and bl procedures respectively",
    "however , there are important situations where the tarone+@xmath11 adjusted procedures are more powerful .",
    "specifically , when all the null hypotheses are identical , the dbh and dbl procedures are identical to the bh and bl procedures respectively , yet the tarone+@xmath11 adjustment are more powerful . just as @xcite have it for the discrete bonferroni , the gain in power of the dbh and dbl procedures comes from the fact that the tests are not identically distributed under the null .",
    "we thank felix abramovich , yoav benjamini , abba krieger and daniel yekutieli for useful discussions .",
    "moreover , we thank abba krieger for providing the example where the dbh procedure does not control the fdr in section [ subsec - dbh ] .",
    "agresti , a. and gottard , a. ( 2007 ) .",
    "nonconservative exact small - sample inference for discrete data . , 51:64476458 .",
    "ahmed , i. , dalmasso , c. , harmaburu , f. , thiessard , f. , broet , p. , and tubert - bitter , p. ( 2010 ) .",
    "false discovery rate estimation for frequentist pharmacovigilance signal detection methods . , 66:301309 .",
    "benjamini , y. ( 2010 ) . discovering the false discovery rate . ,",
    "72 ( 4):405416 .",
    "benjamini , y. and hochberg , y. ( 1995 ) . controlling the false discovery rate - a practical and powerful approach to multiple testing . , 57 ( 1):289300 .    benjamini , y. , krieger , a.  m. , and yekutieli , d. ( 2006 ) . adaptive linear step - up false discovery rate controlling procedures . , 93 ( 3):491507",
    ".    benjamini , y. and liu , w. ( 1999 ) . a step - down multiple hypotheses testing procedure that controls the false discovery rate under independence .",
    ", 82:163170 .",
    "benjamini , y. and yekutieli , y. ( 2001 ) . the control of the false discovery rate in multiple testing under dependency . , 29 ( 4):11651188 .    berry , g. and armitage , p. ( 1995 )",
    "mid - p confidence intervals : a brief review . , 44 ( 4):417423 .",
    "chavant , f. , favreliere , s. , chebassier , c. , plazanet , c. , and perault - pochat , m. ( 2011 ) .",
    "memory disorders associated with consumption of drugs : updating through a case / noncase study in the french pharmacovigilance database . , 72 ( 6):898904",
    ".    efron , b. ( 1996 ) .",
    "empirical bayes methods for combining likelihoods . , 91 ( 434):538550 .    fellows , i. ( 2010 ) .",
    "the minimaxity of the mid p - value under linear and squared loss functions .",
    ", 40 ( 2):244254 .",
    "ge , y. , dudoit , s. , and speed , t. ( 2003 ) .",
    "resampling - based multiple testing for microarray data analysis .",
    ", 12(1):177 .",
    "gilbert , p. ( 2005 ) .",
    "a modified false discovery rate multiple - comparisons procedure for discrete data , applied to human immunodeficiency virus genetics .",
    ", 54(1):143158 .",
    "heyse , j. ( 2011 ) . a false discovery rate procedure for categorical data . in _ recent advances in biostatistics : false discovery rates , survival analysis , and related topics _ , pages 4358 .",
    "kulinskaya , e. and lewin , a. ( 2009 ) . on fuzzy familywise error rate and false discovery rate procedures for discrete distributions .",
    ", 96(1):201211 .",
    "lancaster , h. ( 1961 ) .",
    "significance tests in discrete distributions . , 56 ( 294):223234 .",
    "romano , j. , shaikh , a. , and wolf , m. ( 2008 ) .",
    "rejoinder on : control of the false discovery rate under dependence using the bootstrap and subsampling .",
    ", 17 ( 3):461471 .",
    "routledge , r. ( 1994 ) .",
    "practicing safe statistics with the mid - p .",
    ", 22 ( 1):103110 .",
    "sarkar , s. ( 2002 ) .",
    "some results on false discover rate in stepwise multiple testing procedures . , 30 ( 1):239  257 .",
    "westfall , p. and wolfinger , r. ( 1997 ) .",
    "multiple tests with discrete distributions . , 51(1):38 .",
    "yekutieli , d. ( 2008 ) .",
    "comments on : control of the false discovery rate under dependence using the bootstrap and subsampling . , 17 ( 3):458460 .",
    "let @xmath23 and @xmath24 be the atoms ( were an atom is a value the discrete @xmath0-value can receive ) of the @xmath25th discrete @xmath0-value just below and just above @xmath26 for null distribution @xmath25 , and let @xmath27 $ ] be the indicator function",
    ". then @xmath28i[\\frac{b_{kq / m}(i)+a_{kq / m}(i)}2\\leq kq / m]\\end{aligned}\\ ] ] let @xmath29 denote the event that exactly @xmath30 hypotheses are rejected by the bh procedure on @xmath11-values along with true null hypothesis @xmath7 . the fdr level of this procedure may be expressed as follows @xmath31i[\\frac{b_{kq / m}(i)+a_{kq / m}(i)}2\\leq kq / m ] ) pr(c_k^{(i ) } ) \\nonumber \\\\ & & = origfdr +    \\sum_{i\\in i_0 } \\sum_{k=1}^m\\frac 1k [ b_{kq / m}(i)-a_{kq / m}(i)]i[\\frac{b_{kq / m}(i)+a_{kq / m}(i)}2\\leq kq / m ] pr(c_k^{(i)})\\nonumber \\\\\\end{aligned}\\ ] ] where @xmath32 is the fdr level of the bh procedure on the @xmath0-values .",
    "since @xmath33 , it follows that @xmath34 .",
    "it remains to show that @xmath35 .",
    "we will use the following simple lemma :            first , if @xmath42 then fdr=0 since there are no false rejections .",
    "second , if @xmath42 then the only cut - off of interest is @xmath43 , therefore @xmath44 where the last inequality follows from the definition of @xmath45 .",
    "it remains to prove the proposition for @xmath46 .",
    "let @xmath47 , and let @xmath48 and @xmath14 be the index sets of @xmath49 and @xmath4 @xmath0-values corresponding to the false null and true null hypotheses respectively .",
    "let @xmath50 be the @xmath0-values corresponding to false null hypotheses .",
    "we will show that @xmath51 , from which the proposition clearly follows .",
    "let @xmath52 be the sorted @xmath0-values corresponding to false null hypotheses .",
    "let @xmath53 be the largest integer @xmath25 satisfying @xmath54 , where @xmath55 if @xmath56 .",
    "note that @xmath57 since @xmath58 .",
    "let @xmath64 be the indices in the vector of @xmath0-values of the @xmath65 smallest @xmath0-values corresponding to false null hypotheses .",
    "then @xmath66 since @xmath67 then @xmath68 .",
    "therefore , @xmath69 .",
    "if follows that @xmath70",
    "since @xmath40i[\\frac{b_{kq / m}(i)+a_{kq / m}(i)}2\\leq kq / m]}{kq / m}$ ] , then : @xmath41i[\\frac{b_{kq",
    "/ m}(i)+a_{kq / m}(i)}2\\leq kq / m ] ) pr(c_k^{(i ) } ) \\nonumber \\\\ & & =   \\sum_{i\\in i_0 } \\sum_{k=1}^m\\frac 1k \\frac{kq}m \\frac{a_{kq / m}(i)+ [ b_{kq / m}(i)-a_{kq / m}(i)]i[\\frac{b_{kq / m}(i)+a_{kq / m}(i)}2\\leq kq / m]}{kq / m }   pr(c_k^{(i)})\\nonumber   \\\\ & & \\leq \\sum_{i\\in i_0 } \\epsilon_i \\sum_{k=1}^m\\frac q m pr(c_k^{(i ) } ) \\nonumber \\\\   & & =   \\frac qm \\sum_{i\\in i_0 } \\epsilon_i\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> benjamini and hochberg ( 1995 ) proposed the false discovery rate ( fdr ) as an alternative to the family - wise error rate in multiple testing problems , and proposed a procedure to control the fdr . for discrete data </S>",
    "<S> this procedure may be highly conservative . </S>",
    "<S> we investigate alternative , more powerful , procedures that exploit the discreteness of the tests and have fdr levels closer in magnitude to the desired nominal level . </S>",
    "<S> moreover , we develop a novel step - down procedure that dominates the step - down procedure of benjamini and liu ( 1999 ) for discrete data . </S>",
    "<S> we consider an application to pharmacovigilance spontaneous reporting systems , that serve for early detection of adverse reactions of marketed drugs .    </S>",
    "<S> ruth heller + _ department of statistics and operations research , tel - aviv university , tel - aviv , israel . </S>",
    "<S> e - mail : ruheller@post.tau.ac.il_ + hadas gur + _ faculty of industrial engineering and management , technion  </S>",
    "<S> israel institute of technology , haifa , israel . </S>"
  ]
}