{
  "article_text": [
    "we consider the ray - theoretic limit of high - frequency waves propagating in a slab @xmath0 , made of a heterogeneous layered medium with smooth isotropic wave speed @xmath1 .",
    "we assume that waves can only be sent from , and recorded at the surface @xmath2 . without loss of generality",
    "the waves are assumed to originate from the origin @xmath3 , as all points are equivalent on the surface .",
    "the transverse coordinate @xmath4 is assumed to be one - dimensional , as otherwise the problem would be radially symmetric about @xmath5 .",
    "we also assume that all other physical parameters that may affect wave dynamics , such as density , are constant .",
    "the information available for the inversion is the traveltime @xmath6 of the various waves as a function of the recording position @xmath4 .",
    "the two types of waves in a layered slab are        * _ diving _ , or refracted waves , which arrive back at @xmath2 from overturning before reaching @xmath7 ; and * transmitted waves , which arrive at @xmath7 . the first _ reflected _ wave , recorded at @xmath2 after reflecting",
    "off of the boundary @xmath7 , arrives twice later and twice farther than the transmitted wave , hence contains the same information .",
    "multiply reflected waves also do not carry any new information .",
    "diving waves occur for instance when @xmath1 is monotonically increasing .",
    "we assume for simplicity that the type of a wave ( diving or reflected ) is a priori known .",
    "waves that do not reflect ( such as diving waves ) are usually called  transmitted \" in the geophysics literature , so the word  transmitted \" is used very sparingly in the sequel to avoid confusion .    the inverse problem of recovering @xmath1 from the traveltime information of _ diving _ waves was solved circa 1910 by herglotz @xcite , wiechert and geiger @xcite , and bateman @xcite in what is perhaps the first contribution by mathematicians to seismology .",
    "their explicit formula takes the form of an inverse abel transform and has been textbook material for a long time @xcite .",
    "it will be reviewed in this paper , along with the analysis of its stability .",
    "what can be said about the corresponding inverse problem for _ reflected waves _ ?",
    "many authors have argued that this problem is quite different from that concerning diving waves .",
    "firstly , there may not be an explicit formula to solve the problem .",
    "but more importantly , the problem has a completely different stability behavior .",
    "qualitative discussion of ill - posedness of traveltime tomography was an active topic in the geophysics community in the late 1980s and early 1990s , see for instance stork and clayton @xcite ; bube , langan , and resnick @xcite ; ivansson @xcite ; and delprat - jannaud and lailly @xcite .",
    "this paper aims to settle in a quantitative manner that , regardless of the discretization , there is not enough information in traveltime data from reflected rays to solve for a velocity profile @xmath1 in a well - posed manner .",
    "it is clear that in the one - dimensional case of a ray traveling from @xmath2 to @xmath7 ( with @xmath8 known ) , there is a fatal obstruction to solving the inverse problem .",
    "the only datum is the traveltime @xmath9 , hence two smooth profiles with the same slowness integral will be indistinguishable .",
    "one would think that passing to a multidimensional situation may allow to recover a well - posed problem by triangulation  the option to observe a fixed scene from different angles  but that is not the case .",
    "perhaps surprisingly , the presence of rays with different take - off positions and angles only marginally improves the determination of the velocity profile , at least in the layered case .    determining a velocity profile form traveltime data is a nonlinear problem .",
    "as we will see , both in the diving and the reflected case , the forward model can be split into the composition of two operations :    * a _ nonlinear _ operation of mapping the velocity profile to its decreasing rearrangement , which is invertible when the function is monotone but not otherwise ; followed by * a _ linear _ integral operator acting on the inverse of this rearrangement .",
    "it is that integral operator which is invertible and relatively well - conditioned ( of volterra type ) in the diving case , but always ill - conditioned ( of fredholm type ) in the reflected case .",
    "the possible lack of invertibility of the nonlinear step is well - understood : geophysicists refer to the lack of ( increasing ) monotonicity of the velocity profile in @xmath10 as the  presence of low - velocity zones \" @xcite .",
    "the characterization of the conditioning of the linear step seems to be less well understood and is the subject of this paper .",
    "it should be mentioned that the meager results in this paper are far from shedding adequate light on the bigger problem of solvability and well - posedness of the general traveltime tomography problem , also called boundary rigidity problem .",
    "much progress was obtained on this question recently ; see @xcite and other upcoming publications by uhlmann et al . for us , settling the layered special case serves to explain some disturbing numerical results that were observed in the scope of finite - frequency inversion of the background velocity in an idealized layered seismic setup .",
    "what we originally thought should have been a simple test case has now revealed itself to be a pathological example that can not be solved .",
    "we hope it is useful to record this observation for the benefit of the community .",
    "we present a numerical example to this effect in the last section of this paper .",
    "although all our arguments assume a layered model @xmath11 , it is clear that they have an equivalent formulation in the radially symmetric case @xmath12 via the so - called earth flattening transformation .",
    "this is the original setting for the herglotz - wiechert formula .",
    "it is a nice coincidence that some of the mathematics reviewed or used in the proofs originates from the first half of the 20th century , and should be credited to such first - rate analysts as herglotz , bateman , hardy , littlewood , and szeg .      in this section",
    "we review the solutions of the hamiltonian system of geometrical optics in a layered medium .",
    "this classical material is covered in many places , including at least @xcite .",
    "let @xmath13 for position and @xmath14 for slowness ; then @xmath15 since @xmath16 only depends on @xmath10 , it follows that horizontal slowness is conserved and equals @xmath17 where @xmath18 is the take - off angle that the ray leaving from the origin makes with the surface @xmath2 , and @xmath19 is the wave speed there .",
    "we now slightly abuse notations and write @xmath1 for the wave speed",
    ". the rest of the system can be solved by writing @xmath20 isolating @xmath21 , and using this expression in the equation for @xmath22 to obtain @xmath23 solving this ode by separation of variables gives the expression of the traveltime @xmath6 as a function of @xmath10 and @xmath24 : @xmath25 the handy notation @xmath26 refers to the vertical velocity .",
    "returning to the equation for @xmath27 , we get @xmath28 hence the horizontal position of the ray as a function of @xmath10 and @xmath24 is @xmath29    the formulas ( [ eq : tau ] ) and ( [ eq : x ] ) can be used as is for transmitted rays , by letting @xmath7 in the upper bound of the integrals .",
    "reflected rays obey the same expressions with a leading factor of 2 .",
    "for short , we write @xmath30 and @xmath31 when @xmath7 .    the traveltime and arrival position of a diving ( refracted ) ray , however ,",
    "are obtained by following the ray until it reaches a turning point and then returns to the surface @xmath2 .",
    "a ray will turn if @xmath32 , i.e. , if it reaches the first @xmath33 where @xmath34 then , for diving rays , @xmath35    data normally come in the form of one or more functions @xmath36 of the transverse position @xmath4 , but let us now explain how to introduce @xmath24 in this picture . regardless of whether the ray is diving or reflected , the take - off angle @xmath18 is by symmetry the same as the angle that the ray makes with the surface @xmath2 when recorded there . hence @xmath37 at the arrival point as well .",
    "it follows that @xmath24 is the rate of change of traveltime as a function of @xmath4 : @xmath38 where @xmath39 indexes the branch of the possibly multivalued traveltime . by inverting this relation",
    "we get the ( unique ) function @xmath31 . in turn , we get @xmath40 .",
    "the step of forming @xmath31 from its inverse function(s ) may be numerically complicated , but does not in principle suffer from ill - conditioning . hence in this paper",
    "we assume that @xmath30 and @xmath31 are given .",
    "it is a unique feature of layered media that the knowledge of @xmath36 implies that of the full scattering relation , i.e. , of the take - off slowness vector in addition to the traveltime of each ray .",
    "the next ( classical ) step in solving the inverse problem is to change variables in ( [ eq : diving ] ) .",
    "as long as @xmath1 is an increasing function of @xmath10 , the relation @xmath41 introduced in the previous section defines the unique inverse function @xmath42 .",
    "we then consider the jacobian of @xmath10 with respect to @xmath43 : @xmath44    for diving rays , the two relations in equation ( [ eq : diving ] ) become @xmath45 the upper bound is @xmath46 , which is indeed greater than @xmath24 when @xmath1 is increasing .",
    "we see that @xmath30 and @xmath31 in principle carry the same information ; from the mathematical prospective it is sufficient to focus on @xmath30 to determine @xmath47 .. if @xmath47 is determined from @xmath30 alone , the deviation of @xmath31 from its integral expression above is at least an important indication of how well the assumption of layered medium is satisfied . ]",
    "it was the contribution of herglotz @xcite , wiechert and geiger @xcite , and bateman @xcite to recognize that either of these volterra integral relations can be reduced to the abel transform , hence can be inverted in an explicit manner . in terms of @xmath30 , for instance , @xmath48    putting numerical considerations aside , the solution of the inverse problem is now clear : 1 ) determine @xmath47 from equation ( [ eq : inverseabel ] ) , and 2 ) find @xmath49 as the inverse function of @xmath50 .",
    "although it is not the main topic of this paper , we detail for completeness the stability properties of the abel inversion formula ( [ eq : inverseabel ] ) in section [ sec : diving ] . in a nutshell , the abel transform is a half - integral , hence its inverse is a half - derivative . as a result ,",
    "the inverse abel transform is very mildly ill - posed .",
    "it is bounded between lipschitz spaces with orders differing by @xmath51 , and its singular values correspondingly decrease like @xmath52 .",
    "the reasoning leading to an integral over slowness @xmath53 can be extended to non - monotonous @xmath1 if we understand that @xmath47 is now the _ slowness distribution function _ ( sdf ) , @xmath54 this formula should convey the idea of a  continuous histogram \" .",
    "the integrated or cumulative version of @xmath55 is sometimes called the  layered cake \" representation by analysts . if @xmath56 is too singular , the integral over @xmath53 should be understood in the sense of stieltjes .",
    "note that the dependence of @xmath55 on @xmath24 did not all of a sudden become crucial ; the upper bound can be increased without consequence in the zone where @xmath57 . what matters is that the integral avoids large @xmath58 for which @xmath49 increases back to @xmath24 and beyond ; those values of @xmath59 should not be counted in the sdf .",
    "the expressions ( [ eq : diving2 ] ) still hold with @xmath60 in place of @xmath47 in more general situations when @xmath1 may not be monotonically increasing .",
    "since @xmath30 and @xmath31 only determine @xmath55 , the main obstruction to solving for @xmath1 is clear : _ any two profiles @xmath1 which have the same sdf @xmath60 will give rise to the same data @xmath61 .",
    "_ in other words , if @xmath1 is the solution of the inverse problem , so will any ( smooth ) rearrangement within the interval @xmath62 $ ] .",
    "this _ rearrangement ambiguity _ does not pose a problem when @xmath1 is increasing , but does in case @xmath1 decreases before increasing back to @xmath63 at depth @xmath64 .",
    "this explains the remark on  low - velocity zones \" in section [ sec : setup ] .",
    "in addition to this rearrangement ambiguity , let us keep in mind that limited angular coverage is another major reason why practical traveltime tomography falls outside the scope of the abel inversion formula .",
    "in fact , it is plausible that the techniques developed in the next sections would also help quantify the extent of the ill - posedness of the limited - data diving ray tomography problem .      for reflected rays ,",
    "the situation is very different since we are back to formulas ( [ eq : tau ] ) and ( [ eq : x ] ) with @xmath8 in place of @xmath10 in the upper bound of the integrals . as a result ,",
    "the @xmath53-integrals for reflected rays , in terms of the sdf introduced in the previous section , take the form @xmath65 the integral bounds depend only on the medium properties ; they are @xmath66 } \\frac{1}{c(z ) } , \\qquad \\overline{p } = \\max_{z \\in [ 0,h ] } \\frac{1}{c(z)}.\\ ] ] the bounds @xmath67 and @xmath68 on the horizontal slowness variable @xmath24 , on the other hand , relate to the availability of data .",
    "they are the slownesses for which the traveltime information of the reflected rays is known in the interval @xmath69 $ ] .",
    "the relations between the various remarkable slownesses are summarized in figure [ fig : p ] .",
    "$ ] is that of physical slownesses , i.e. , @xmath70 for some @xmath10 . in particular",
    ", @xmath71 belongs in this interval .",
    "the interval @xmath72 $ ] is that of observed horizontal slownesses , i.e. , quantities of the form @xmath73 where @xmath74 is the angle that the incident ray makes with the surface @xmath2 .",
    "note that in the case of diving rays , the two intervals would overlap and @xmath75.,width=377 ]    _ the lower bound @xmath76 is now fixed , so we are dealing with first - kind fredholm equations instead of volterra equations for @xmath60 .",
    "this results in severe ill - conditioning of the inverse map in the case of reflected rays .",
    "_    the conditioning of the linear map in ( [ eq : reflected ] ) depends on how @xmath77 relates to @xmath76 .",
    "this information is captured by the smallest angle @xmath78 that reflected rays make with the lines @xmath10 = const .",
    ", whose cosine is @xmath79 the larger this angle , the worse the conditioning of ( [ eq : reflected ] ) , i.e. , the more unstable the inverse maps . but",
    "the problem is already ill - conditioned even if @xmath80 .",
    "we will need the following functions of @xmath81 and @xmath77 : the contrast @xmath82 , and @xmath83^{1/2 } , \\\\ \\rho^ * & = 1 + 2 \\frac{1-(p^*/\\underline{p})^2}{e-1 } - \\left [ \\left ( 1 + 2 \\frac{1-(p^*/\\underline{p})^2}{e-1 } \\right)^2 - 1 \\right]^{1/2},\\end{aligned}\\ ] ] and @xmath84^{1/2}.\\ ] ] it turns out that both @xmath85 and @xmath86 are increasing functions of @xmath78 ( when @xmath87 is fixed ) . notice that @xmath88 , or @xmath89 , if and only if @xmath80 .",
    "we will see below that @xmath85 gives rise to a lower bound @xmath90 on the condition number , while @xmath86 yields an upper bound @xmath91 , with @xmath92 yet to be defined .",
    "these formulas may look complicated , but there are numerical indications that the upper bound generated by @xmath86 is tight .    in the sequel we limit ourselves without loss of generality to the equation for @xmath30 .",
    "we let @xmath93 for the linear map from @xmath55 to @xmath6 in ( [ eq : reflected ] ) .",
    "the notion of condition number is meaningful only if the number of degrees of freedom is limited .",
    "most sampling schemes of interest would discretize the operator @xmath93 as a @xmath94-by-@xmath92 matrix .",
    "specifically , let    * @xmath95 be an orthogonal projector of rank @xmath94 on @xmath96 ; and * @xmath97 be an orthogonal projector of rank @xmath92 on @xmath98 .",
    "it is natural to consider @xmath99 , and its condition number @xmath100 where @xmath101 denotes the pseudo - inverse , and @xmath102 denote the singular values .    [",
    "def : reasonable ] a discretization is any couple @xmath103 of orthogonal projectors . it is called _ reasonable for @xmath93 _ if @xmath104    [ teo : main ] assume @xmath105 .",
    "let @xmath106 be the condition number of @xmath107 .",
    "* for all discretizations @xmath103 , reasonable for @xmath93 , and such that @xmath97 has rank @xmath92 , @xmath108 it also holds that ( useful when @xmath109 ) @xmath110 * there exists a discretization @xmath111 , where both @xmath112 and @xmath113 have rank @xmath92 , such that @xmath114 furthermore , @xmath97 can be taken as the orthogonal projector on polynomials of @xmath115 , of degree @xmath116 .",
    "we do not believe that the prefactors @xmath92 , @xmath117 and @xmath118 are sharp in any way .",
    "we give numerical indications in section [ sec : num ] that the rate @xmath119 of ( [ eq : upper ] ) may be sharp , while the constants in ( [ eq : lower1 ] ) and ( [ eq : lower2 ] ) are not .",
    "that ( [ eq : lower2 ] ) should scale root - exponentially when @xmath88 seems adequate , however .",
    "it should be mentioned that the positivity constraint on @xmath120 or @xmath121 may be an important piece of information for solving the inverse problem in practice , but that it is does not call the linear stability analysis into question .",
    "as soon as @xmath120 is strictly bounded away from zero on its support , no small perturbation can compromise positivity , hence the linearized perturbative theory applies .",
    "note that once @xmath60 is found , there may still not be a unique @xmath1 that corresponds to it .",
    "the ambiguity of smooth rearrangements in the  low velocity zones \" is as much an issue for reflected rays as it is for diving rays .",
    "while the source of ill - conditioning is now twofold , we present a numerical example in section [ sec : num ] where the ill - conditioning detailed in theorem [ teo : main ] is in fact more problematic than the strict lack of uniqueness arising from the rearrangement ambiguity .      we know from the previous section that there is a wide range of kinematically near - equivalent velocity profiles if one only considers data from reflected rays .",
    "it is possible to describe this range of velocities quite well in the case of small @xmath24 , i.e. , small offset between source and receiver .",
    "when @xmath122 ( rays perpendicular to the layering ) , the problem is one - dimensional and the data reduce to the single number @xmath123 . any two smooth velocity profiles",
    "@xmath124 , @xmath125 such that @xmath126 will appear indistinguishable .",
    "the extension of this observation to the case of small @xmath127 is that traveltimes will be nearly equal provided the integrals of the _ odd powers _ of @xmath16 are identical , namely @xmath128 for some ( small ) integer @xmath129 .",
    "then the traveltimes for @xmath130 $ ] will match up to a remarkably small @xmath131 .",
    "a justification is given in section [ sec : asymp ] .",
    "the linearized version of the conditions above was found by ivansson @xcite .",
    "see also the paper @xcite by bube for a more extensive study of the slowness nullspace in the linearized regime .",
    "in this section , we briefly review the herglotz inversion formula ( [ eq : inverseabel ] ) and what is known about its stability properties .",
    "it is convenient to change variables as @xmath132 , @xmath133 and express ( [ eq : diving2 ] ) via an operator @xmath93 as @xmath134 with @xmath135 and @xmath136 .",
    "this relationship between @xmath137 and @xmath138 is ( a version of ) the abel transform , or abel equation @xcite . it is also called a riemann - liouville integral .",
    "the key to the inversion formula for @xmath93 is to notice that it is an operator of fractional differentiation of order @xmath51 on the half - line .",
    "indeed , @xmath139 with @xmath140 as a result , @xmath141 , hence @xmath142 the inversion formula ( [ eq : inverseabel ] ) follows",
    ".    one can also quickly notice that @xmath143 from which one can ( correctly ) infer that @xmath144 this leads to the well - known fact that @xmath93 is diagonal in the laplace domain , that its powers form a semi - group , and that @xmath145 can also be computed via the scaling @xmath146 in the laplace domain @xcite .",
    "this procedure is not advisable numerically due to the ill - conditioning of the inverse laplace transform",
    ".    equation ( [ eq : abellaplace ] ) also carries the information that any @xmath10 such that re@xmath147 is an eigenvalue of @xmath93 , with square - integrable eigenfunction .",
    "the spectral theory of nonnormal operators such as @xmath93 is however quite pathological , so this observation is rather useless .",
    "a natural finite dimensional approximation of @xmath148 would be a highly defective upper - triangular matrix with constant entries on and above the diagonal .",
    "eigenvalues are not the right tool to study stability under inversion for such nonnormal operators or matrices .",
    "singular values , however , are perfectly informative for stability .",
    "the following result gives an explicit singular value expansion of @xmath93 in the illustrative case when @xmath93 acts on functions supported in @xmath149 $ ]  otherwise some rescaling needs to be done .",
    "it should be credited to johnstone and silverman who proved a very similar result in @xcite .",
    "( johnstone - silverman ) assume @xmath150)$ ] . then @xmath151 with @xmath152 and the inner product is @xmath153    notice that the @xmath154 are an orthonormal basis for the  right \" inner product @xmath155 , whereas @xmath156 are an orthonormal basis for the  left \" inner product @xmath157 the particular values of the @xmath158 depend on the normalization of the inner products , but their decay rate @xmath159 does not .",
    "one first establishes that @xmath160 , from which ( [ eq : svd - a ] ) follows by orthonormality and completeness of the @xmath154 . the proof is a matter - of - fact induction argument which combines equation 22.13.11 in @xcite with the relations @xmath161 ;",
    "@xmath162 ; and @xmath163 .",
    "johnstone and silverman claim that there is a less artificial way of obtaining relations such as @xmath160 via hypergeometric functions .",
    "since the singular values @xmath158 decay like @xmath52 , so will the singular values of any good discretization of @xmath93 . as a result , we can expect that a matrix discretizing @xmath93 on @xmath92 points would have a @xmath164 condition number .",
    "this qualifies as very mild ill - posedness .",
    "we may also understand the stability properties of @xmath145 through boundedness estimates in adequate functional spaces .",
    "consider the lipschitz space @xmath165 of functions with bounded @xmath85 semi - norm @xcite",
    "@xmath166    hardy and littlewood studied boundedness of fractional integration on lipschitz spaces @xcite .",
    "their conclusion for @xmath93 , properly modernized , is that for all @xmath167 , @xmath168 , @xmath169 this result again showcases the mild ill - posedness of inverting @xmath93 .",
    "in this section we prove theorem [ teo : main ] . as in the previous section",
    "we change variables as @xmath132 , @xmath133 , to obtain @xmath170,\\ ] ] with @xmath171 = [ \\underline{p}^2 , \\overline{p}^2 ] , \\qquad [ x _ * , x^ * ] = [ p_*^2 , { p^*}^2].\\ ] ] the relationship between the bounds is the same as earlier , namely @xmath172 . since all @xmath4 and @xmath173 are bounded away from zero ( from the assumption @xmath105 ) ,",
    "considering the linear map between @xmath137 and @xmath138  rather than that between @xmath6 and @xmath55  changes the condition number by a factor independent of @xmath94 , @xmath92 .",
    "hence it suffices to prove the claims of the theorem for ( [ eq : newa ] ) .",
    "we overload notations and reuse the letter @xmath93 for @xmath174 as defined by ( [ eq : newa ] ) .",
    "note that this equation is quite different from ( [ eq : newa - diving ] ) .",
    "the singular values of @xmath93 are the square roots of the eigenvalues of @xmath175 , @xmath176 the kernel integrates to @xmath177 , which is clearly hilbert - schmidt on @xmath178 ^ 2 $ ] even in the case when @xmath179 .",
    "hence @xmath175 is a compact operator . as a consequence of the general theory",
    ", it has a discrete set of eigenvalues ( with square - integrable eigenvectors ) which can only accumulate at the origin .",
    "a key to understanding the spectrum of @xmath175 is that @xmath180 has an explicit expansion in terms of the legendre polynomials rescaled to the interval @xmath181 $ ] .",
    "consider the new variables @xmath182 if @xmath183 denotes legendre polynomial of degree @xmath184 with @xmath185 $ ] , then @xmath186 is an orthonormal basis for @xmath181 $ ] with measure @xmath187 .",
    "the desired expansion is @xmath188 where @xmath189 is related to @xmath190 through @xmath191 equation ( [ eq : legendre ] ) is a straightforward consequence of the fact that @xmath192 is the generating function of the legendre polynomials @xmath183 .",
    "equation ( [ eq : elliptical ] ) is part a change of variables to and from elliptical coordinates in the complex plane ; @xmath193 is the elliptical radius of the bernstein ellipse passing through @xmath190 , with foci at @xmath194 .",
    "ultimately , it is well - known that the speed of convergence of a series like ( [ eq : legendre ] ) , or of the corresponding chebyshev series , depends on the distance of the singularity at @xmath195 to the interval @xmath196 $ ] in the complex plane .    the rescaled polynomials @xmath197 provide a unitary change of basis for @xmath175 . using equation ( [ eq : legendre ] )",
    ", it suffices to find the eigenvalues of the semi - infinite matrix @xmath198^{m+n+1 } \\ ,",
    "d\\tilde{x } , \\qquad m , n \\geq 0.\\end{aligned}\\ ] ] further passing to the @xmath199 variable via ( [ eq : elliptical ] ) , it follows that @xmath200 is ( up to the normalization factor ) a hankel matrix of moments : @xmath201 with density @xmath202,\\ ] ] where the bounds @xmath203 and @xmath204 relate to @xmath205 and @xmath206 respectively through ( [ eq : elliptical ] ) ; in particular @xmath207 .",
    "note that @xmath208 .",
    "we now address the decay of the eigenvalues of @xmath209 and of its finite - dimensional sections .      in this section",
    "we start by assuming @xmath210 , i.e. , the rays never become horizontal and the kernel @xmath211 is bounded .    the following two elementary lemmas detail how to deal with finite - dimensional projections of compact operators .",
    "their proofs are nice homework exercises involving the courant - fischer min - max principle . in what follows",
    "eigenvalues are sorted in decreasing order , and projectors are considered on the domains over which they make sense .",
    "[ lem : one ] let @xmath95 and @xmath97 be two orthogonal projectors .",
    "then for all @xmath212 , @xmath213    [ lem : two ] let @xmath214 be an orthogonal projector of rank @xmath92 . then @xmath215    given our @xmath92-by-@xmath92 matrix @xmath216 , where @xmath217 and @xmath97 are arbitrary",
    ", we use the two lemmas above to obtain the bound @xmath218 we choose @xmath214 to be the orthogonal projector onto polynomials of degree @xmath219 in @xmath196 $ ] , i.e. @xmath220 is unitarily equivalent to the semi - infinite section @xmath221 of the semi - infinite matrix @xmath209 in equation ( [ eq : hankel ] ) .",
    "the largest eigenvalue of this semi - infinite section is further bounded by the hilbert - schmidt ( frobenius ) norm , @xmath222^{1/2}.\\ ] ] by elementary majorations involving geometric series , there exists @xmath223 such that the quantity above is less than @xmath224 for @xmath225 , it follows that the @xmath92th singular value of @xmath226 obeys ( @xmath227 is a number that changes from line to line ) @xmath228    as for the first singular value , we use the assumption that the discretization is reasonable for @xmath93 ( definition [ def : reasonable ] ) to obtain @xmath229 where @xmath227 is independent of @xmath92 .",
    "we assemble inequality ( [ eq : lower1 ] ) by considering that @xmath230 and noticing that @xmath231 .",
    "so far we have assumed @xmath232 , but it is clear that the result is also true ( and somewhat uninformative ) when @xmath109 .",
    "the justification of this fact is a very special case of the analysis in the coming section .      in this section",
    "we consider the worst case scenario when @xmath233 , or equivalently @xmath89 , or @xmath80 .",
    "a fortiori the bounds we derive here also hold for any @xmath234 .",
    "the proof idea for ( [ eq : lower2 ] ) is that the interval @xmath181 $ ] can be subdivided into subintervals of the form @xmath235 \\cap [ ( 1 + \\delta^{j+1})\\underline{x } , ( 1 + \\delta^{j } ) \\underline{x}]$ ] , with @xmath236 and for some @xmath237 .",
    "here @xmath238 is the largest integer such that @xmath239 .",
    "the operator @xmath93 correspondingly splits into the sequence of operators @xmath240 . in accordance with the notation for matrix multiplication we suggestively write @xmath241 .",
    "the coarse bound ( [ eq : lower1 ] ) can now be applied to each @xmath242 . the same reasoning as in the previous section applies , yielding @xmath243 @xmath244 @xmath245 hence the sequence of singular values of @xmath242 obeys @xmath246 where @xmath247 is some re - usable constant which depends on @xmath248 and @xmath249 , but not @xmath250 and @xmath92 . for short",
    "we let @xmath251 .",
    "the recombination of these various sequences , indexed by @xmath250 , is heuristically done by concatenation .",
    "the precise statement is the following inequality due to weyl .",
    "( weyl ) consider partitioning a compact operator @xmath93 as @xmath252 .",
    "the singular values of @xmath253 and @xmath227 are related by @xmath254    write @xmath255 .",
    "apply weyl s inequality to this sum of hermitian compact operators @xcite : @xmath256 the eigenvalues of @xmath257 , @xmath258 , @xmath259 are the squares of the singular values of @xmath93 , @xmath260 , @xmath227 respectively .",
    "let us apply this inequality recursively .",
    "let @xmath261 ( to be determined ) and @xmath262 be integers such that @xmath263 .",
    "then @xmath264 the last term is seen to be @xmath265    the numbers @xmath262 are chosen so that each term @xmath266 is also on the order of @xmath267 ( up to a multiplicative constant that depends on @xmath248 , @xmath249 , but neither @xmath250 nor @xmath209 . ) for this purpose it is sufficient to take @xmath268 rounded off to the nearest smaller integer .",
    "the sequence @xmath269 sums up to a number less than or equal to @xmath92 provided @xmath270 choosing @xmath209 the largest integer smaller than @xmath271 will do . as a result ,",
    "@xmath272 here and earlier , the proportionality constant @xmath247 depends on @xmath248 and @xmath249 , but not @xmath92 .",
    "we now address the choice of @xmath273 .",
    "the number put to the power @xmath274 above has for logarithm @xmath275 with @xmath251 .",
    "the sharpest bound is obtained when @xmath276 is minimized as a function of @xmath277 $ ] .",
    "numerically , this happens when @xmath278 in that case @xmath279 the largest singular value is lower - bounded away from zero for the same reason as in the previous section .",
    "the root - exponential bound on the condition number follows .      in this section",
    "we seek an upper bound on @xmath280 , and a lower bound on @xmath281 , for some particular choice of @xmath95 and @xmath113 .",
    "the bound on @xmath282 is easy : use lemma [ lem : one ] for @xmath283 and @xmath284 to obtain a bound @xmath285 , independent of @xmath92 .",
    "@xmath97 is chosen as the orthogonal projector in @xmath286 on the ( rescaled legendre ) polynomials of degree @xmath116 .",
    "for the definition of the orthogonal projector it makes no difference whether those polynomials are orthogonalized or not . since @xmath132 , @xmath97 is as described in the wording of theorem [ teo : main ] .",
    "the resulting matrix @xmath287 is analogous to a finite section of @xmath209 , except for the presence of @xmath95 :",
    "n } = 2 \\ , \\delta \\ , \\left ( ( n+\\frac{1}{2})(m+\\frac{1}{2 } ) \\right)^{-1/2 } \\times \\\\ & \\qquad\\qquad \\int_{\\tilde{x}_*}^{\\tilde{x}^ * } \\left [ \\ , \\tilde{x } - \\sqrt{\\tilde{x}^2 - 1 } \\,\\ , \\right]^{m+1/2 } \\ ; \\mathcal{p}_m \\left [ \\ , \\tilde{x } - \\sqrt{\\tilde{x}^2 - 1 } \\,\\ ,",
    "\\right]^{n+1/2 }   \\ , d\\tilde{x } , \\qquad   0 \\leq m , n \\leq n-1.\\end{aligned}\\ ] ] this expression reduces to @xmath200 in ( [ eq : hankel ] ) by choosing @xmath289 , and @xmath95 the orthogonal projector in @xmath290 , on the subspace @xmath291^{n+1/2 }   \\ , \\mbox{s.t . }",
    "\\quad   \\tilde{x } = \\frac{x - \\sigma}{\\delta } , \\ , 0 \\leq n \\leq n-1\\}.\\ ] ]    we are thus left with the problem of finding a lower bound on the smallest eigenvalue of each finite section @xmath292 of the nearly - hankel matrix @xmath200 in ( [ eq : hankel ] )",
    ". this question was settled in the hankel case by szeg in 1936 @xcite , where the full asymptotic behavior as @xmath293 was studied .",
    "widom and wilf , unaware of szeg s result , rediscovered it in 1966 with the same techniques @xcite .",
    "since our matrix @xmath209 is not exactly of hankel type ( because of the factor @xmath294 ) , we rehearse and adapt their argument .",
    "we start with a beautiful characterization of the inverse of a moment matrix which , according to berg and szwarc @xcite , was first discovered by aitken @xcite .",
    "let @xmath295 be a hankel matrix of moments of the positive measure @xmath296 .",
    "let @xmath297 denote the orthogonal polynomials associated with @xmath298 .",
    "then @xmath299 is similar to the matrix @xmath300 with entries @xmath301    the main observation of szeg , and widom and wilf , is that the large @xmath184 asymptotics of the polynomials @xmath302 on the unit circle translates into the large @xmath303 asymptotics for @xmath304 .",
    "( szeg - widom - wilf ) assume that supp @xmath305 is a finite interval @xmath306 \\subset { \\mathbb{r}}_{+}$ ] , and that @xmath307 does not vanish on its support ] ] .",
    "then @xmath308 for some @xmath309 , and where @xmath310^{1/2}.\\ ] ]    the next step is to approximate the eigenvector corresponding to the leading eigenvalue of @xmath300 .",
    "this is where we depart from @xcite .",
    "our matrix of interest is not @xmath299 but @xmath311 consider approximating the finite section @xmath312 as @xmath313 where @xmath314 is the leading rank-1 expression @xmath315 it is easy to show that the spectral radius of the remainder @xmath316 tends to zero as @xmath293 , so it can be neglected in an asymptotic sense for large @xmath92 . on the other hand",
    ", @xmath154 is the eigenvector that corresponds to the unique nonzero eigenvalue of the leading part @xmath314 .",
    "this eigenvalue obeys @xmath317 by taking the constant sufficiently large , this bound also holds for @xmath318 , for all @xmath92 . specializing to @xmath200 , we get @xmath319 with @xmath86 given in ( [ eq : betarho ] ) .",
    "the result on the condition number follows .",
    "new ideas may be required to sharpen the constants in the lower bounds on the condition number .",
    "one useful piece of information could be the rate at which the determinant of a hankel form grows as @xmath293 .",
    "consider @xmath320 , where @xmath321 szeg ) when he was an undergraduate student , after plya posed it as a conjecture .",
    "this note on the historical context of the szeg distribution theorem is taken from @xcite .",
    "] found the asymptotic expression @xmath322 where @xmath323 is a map from @xmath324 to @xmath306 $ ] , and @xmath16 is called the transfinite diameter of @xmath306 $ ] corresponding to this map .",
    "it is possible to choose @xmath8 as a simple trigonometric function such that @xmath325 if we let @xmath326 for the right - hand side , we obtain the explicit asymptotic formula @xmath327 d_0 , \\\\ & \\sim r^n c^{(n+1)^2 } d_0.\\end{aligned}\\ ] ] since @xmath328 is the product of the @xmath329 eigenvalues of @xmath330 , and _",
    "if _ we postulate that these eigenvalues decay geometrically , then the only possible decay rate is ( up to a polynomial factor ) @xmath331 with @xmath332 .",
    "the same decay rate would hold for the eigenvalues of the matrix @xmath209 in ( [ eq : hankel ] ) .",
    "the corresponding asymptotics for @xmath106 for the finite - section discretization of the operator @xmath93 would follow as @xmath333 up to a polynomial factor .    as we have no indication that the eigenvalues of sections of @xmath334 or @xmath209 indeed decay geometrically , or whether the  average \" rate @xmath335 could be useful in any way toward formulating a bound on @xmath106 , we contend ourselves with reporting it numerically with the other bounds in section [ sec : num ] .",
    "the obstruction to the traveltime tomography problem in the case @xmath336 ( rays perpendicular to the layering ) was covered in section [ sec : asymp - intro ] . in the more general case",
    "when @xmath337 with small @xmath77 , equation ( [ eq : tau ] ) can be rewritten at @xmath7 as @xmath338 perform a binomial expansion of the inverse square root to find its taylor expansion as @xmath339 the first few generalized binomial coefficients are @xmath340 in our case , if @xmath24 is small enough @xmath341 .",
    "the smaller @xmath24 the more accurate the truncation of the sum to the first few terms : @xmath342 ( we placed the ad - hoc factor @xmath343 in the remainder to make it dimensionless . recall that @xmath344 where @xmath74 is the angle that the ray labeled @xmath24 makes with the surface @xmath345 . )",
    "it is now clear that if two profiles @xmath124 and @xmath125 have matching  odd moments \" up to degree @xmath346 , i.e. @xmath347 their responses @xmath348 and @xmath349 will match to within @xmath350 . the name  moment \" owes from the fact that these integrals are precisely moments of the slowness distribution function introduced in equation ( [ eq : sdf ] ) , namely @xmath351 the moment - matching inverse problem is notoriously ill - posed @xcite .",
    "the reasoning carries over without difficulty to the case of slightly differing odd moments .",
    "for instance , in order to get @xmath352 it suffices to find the smallest @xmath353 such that @xmath354 , and require @xmath355    this latter relation defines a rather elongated set around @xmath124 , a  ambiguity region \" of kinematically near - equivalent velocity profiles @xmath125 . in general",
    "there will exist such near - equivalent @xmath124 and @xmath125 for which the difference @xmath356 is non - oscillatory , i.e. , contain only low wavenumbers .",
    "a numerical illustration of this phenomenon is shown in section [ sec : num ] . as a result _",
    "tychonov regularization will hardly be able to discriminate between @xmath124 and @xmath125 _ if they are comparably smooth : this is bad news for the prospect of solving the inverse problem .",
    "in figure [ fig : egval - abel ] we show an illustration of the various bounds on the condition number @xmath106 as a function of @xmath92 . for the particular choice of discretization made for the upper bound ( [ eq : upper ] ) in theorem [ teo : main ] , recall that @xmath357 where @xmath358 is the @xmath184th eigenvalues of the size-@xmath92 finite section @xmath359 of the infinite matrix @xmath209 in ( [ eq : hankel ] ) .",
    "the graphs of @xmath360 are plotted on the same picture as a function of @xmath184 , with the different curves indexed by @xmath92 .",
    "other discretization choices may not be linked in any way to the @xmath358 .",
    ", for the reflected rays setup .",
    "notice the logarithmic scale of the @xmath173 axis .",
    "left : @xmath361 and @xmath362 .",
    "right : @xmath363 and @xmath89 .",
    "dotted curve : first lower bound ( [ eq : lower1 ] ) . dashed curve : second lower bound ( [ eq : lower2 ] ) .",
    "dash - dotted curve : upper bound ( [ eq : upper ] ) .",
    "solid curves : plots of @xmath360 ( see text ) , as a function of @xmath364 for varying @xmath92 . blue crosses : szeg average rate from section [ sec : average ] .",
    "see further comments in the text.,title=\"fig:\",width=302 ] , for the reflected rays setup .",
    "notice the logarithmic scale of the @xmath173 axis .",
    "left : @xmath361 and @xmath362 .",
    "right : @xmath363 and @xmath89 .",
    "dotted curve : first lower bound ( [ eq : lower1 ] ) .",
    "dashed curve : second lower bound ( [ eq : lower2 ] ) .",
    "dash - dotted curve : upper bound ( [ eq : upper ] ) .",
    "solid curves : plots of @xmath360 ( see text ) , as a function of @xmath364 for varying @xmath92 . blue crosses : szeg average rate from section [ sec : average ] .",
    "see further comments in the text.,title=\"fig:\",width=302 ]    the curves for the bounds were scaled by an arbitrary constant , which amounts to an arbitrary vertical translation in logarithmic scale .",
    "the first observation is that the upper bound ( [ eq : upper ] ) seems sharp as it scales like @xmath365 .",
    "the behavior of the eigenvalues @xmath366 of the infinite matrix @xmath209 is given by the lower envelope of the eigenvalue curves .",
    "its scaling seems to be root - exponential in the case @xmath89 ( figure [ fig : egval - abel ] , right panel ) , i.e. , of the form @xmath367 for some numbers @xmath368 .",
    "the lower bound ( [ eq : lower2 ] ) indeed scales root - exponentially , albeit with a different non - sharp constant in the exponential .",
    "note that the ratio @xmath369 in the case @xmath293 can be seen as the _ discretization - free condition number _",
    ", i.e. , the condition number of the best discretization which gives rise to the largest singular values . in that case , the projector @xmath370 project onto the subspaces formed by the @xmath184 eigenvectors corresponding to the largest eigenvalues @xmath371 .",
    "the discrepancy between @xmath372 ( upper end of the curves ) and @xmath373 ( lower envelope at the same abscissa ) shows that the discretization defined by taking finite sections is far from being ",
    "best \" in the sense discussed above .",
    "although the theory in this paper concerns rays rather than waves , the conditioning issue identified here also plagues the finite - frequency , waveform - based inversion problem of reflection seismology .",
    "a finite difference acoustic wave simulation was carried out in a smoothly increasing medium @xmath1 shown as the blue dashed curve in figure [ fig : c(z ) ] , to create synthetic seismograms of reflected waves ( not shown ) .",
    "the receivers cover the surface @xmath345 .",
    "there is a single source at @xmath3 .",
    "note the  reflector \" near @xmath374 which is responsible for the wave echos recorded at the surface .",
    "the wavelength of the probing waves is about 50 m. the data corresponding to diving waves are discarded .",
    "the initial @xmath1 is the black solid curve .",
    "the inverse problem of determining the background velocity @xmath1 from these synthetic seismograms was solved using ( our own implementation of ) the mulder - van leeuwen correlation - focusing method @xcite . in a nutshell ,",
    "least - squares based inversion  minimizing the @xmath375 norm of the waveform residual  would fail because of lack of convexity of the minimization objective , but correlation focusing is an alternative choice of objective that does not suffer ( as much ) from that problem .    _",
    "the inversion procedure converges successfully so that data are fit within a few digits of accuracy .",
    "yet the converged speed profile ( red dash - dotted curve ) is significantly different from the original  true \" speed profile .",
    "various levels of tychonov regularization did not help in improving convergence .",
    "_     only .",
    "different levels of tychonov regularization do not noticeably improve the converged model . ]    the original @xmath1 used in the forward modeling step was chosen to increase monotonically , so the ill - conditioning is not due to the rearrangement ambiguity ( also called  presence of low - velocity zones \" . ) instead , it is a ( spectacular ) finite - frequency remnant of the conditioning problem associated with reflected rays as studied in this paper .    another numerical piece of evidence for the problem associated with reflected rays is figure [ fig : rays - tomog ] .",
    "the background velocity is shown in shades of yellow and red : it is the same  true \" wave speed profile as earlier . in white , the rays of geometrical optics",
    "were traced in this  true \" medium ( blue dashed curve in figure [ fig : c(z ) ] ) . in black , we traced rays in the converged ",
    "optimal \" medium from correlation - focusing inversion ( red dash - dotted curve in figure [ fig : c(z ) ] . )",
    "notice how the transmitted rays reach the reflector @xmath374 ( and then reflect ) at almost the same location as the white rays with the same take - off angle .",
    "the diving rays are completely different , on the other hand  hence they contain much more information than the reflected rays .",
    ", respectively . the number of lines and take - off angles are same in both cases .",
    "yellow and red colors represent the magnitude of the true background velocity model .",
    "the authors of rsf and madagascar are gratefully acknowledged for providing the plotting routines .",
    ", width=642 ]    finally , we compare the odd moments of the converged velocity profile @xmath376 from the correlation - focusing method after @xmath377 iterations , to those of the  true \" velocity profile @xmath1 .",
    "the table below lists the quantity @xmath378 for different values of @xmath24 and @xmath377 .",
    "[ table : moment ]    [ cols=\"<,<,<,<,<\",options=\"header \" , ]     the moments match to within a few digits after very few iterations , as they should from the discussion in section [ sec : asymp ] .",
    "we have shown that the isotropic , laterally - homogeneous traveltime tomography inverse problem has well - posed formulations in the case of diving rays , but suffers from incurable ill - conditioning in the case of reflected rays .",
    "while diving rays involve a volterra integral equation , reflected rays involve a fredholm integral equation . intuitively , a fredholm operator is to a rank - deficient full matrix what a volterra operator is to the upper - triangular restriction of such a matrix .",
    "our analysis shows that well - posedness is linked to the presence of overturning rays , i.e. , rays whose direction is at some point parallel to the level lines of the speed profile .",
    "we do not know if this non - transversality condition could play a role for the analysis of the more general case of a laterally varying @xmath379 .",
    "the ill - conditioned nature of the reflection traveltime tomography problem has serious implications for imaging , even at finite frequencies . the seismic inverse problem in a smooth , layered background @xmath1 with surface data",
    "can only be only well - posed if either ( 1 ) low - frequency data is seriously taken into account , and/or ( 2 ) the reflectors are more or less  dense \" in the sense that the true wave speed profile is  rough everywhere \" .",
    "the latter point was made precise by symes who wrote a remarkable stability estimate in @xcite .",
    "finally , it should be mentioned that if we restrict the domain to a rectangle , and avail ourselves of complete data on all the sides , then the problem of recovering the wave speed from traveltime data becomes much better posed .",
    "for instance , mukhometov proved a stability estimate ( with loss of one derivative ) in the case of isotropic media that deviate little from a constant @xcite .",
    "h. bateman , the solution of the integral equation connecting the velocity of propagation of an earthquake wave in the interior of the earth with the times which the disturbance takes to travel to the different stations on the earth s surface , ( 1910 ) 576587                                            r. nowack , applications of inverse methods to the analysis of refraction and wide - angle seismic data , in _ inverse problems in wave propagation _",
    ", ed . by g. chavent , g. papanicolaou , p. sacks , w. w. symes , springer , 1997 ."
  ],
  "abstract_text": [
    "<S> this paper revisits the problem of recovering a smooth , isotropic , layered wave speed profile from surface traveltime information . while it is classic knowledge that the diving ( refracted ) rays classically determine the wave speed in a weakly well - posed fashion via the abel transform , we show in this paper that traveltimes of reflected rays do not contain enough information to recover the medium in a well - posed manner , regardless of the discretization . </S>",
    "<S> the counterpart of the abel transform in the case of reflected rays is a fredholm kernel of the first kind which is shown to have singular values that decay at least root - exponentially . </S>",
    "<S> kinematically equivalent media are characterized in terms of a sequence of matching moments . </S>",
    "<S> this severe conditioning issue comes on top of the well - known rearrangement ambiguity due to low velocity zones . </S>",
    "<S> numerical experiments in an ideal scenario show that a waveform - based model inversion code fits data accurately while converging to the wrong wave speed profile .    * </S>",
    "<S> acknowledgments . * </S>",
    "<S> the authors would like to thank guillaume bal , sergey fomel , and william symes for interesting discussions . </S>",
    "<S> this work was supported by a grant from total sa . </S>",
    "<S> ld also acknowledges generous funding from the alfred p. sloan foundation and the national science foundation . </S>"
  ]
}