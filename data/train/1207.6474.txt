{
  "article_text": [
    "motivated by the observation of cell communities over time , we propose a topological expression of the process that facilitates the identification and quantification of its features . in this manuscript , we focus on the mathematical framework .    [ [ motivation . ] ] motivation .",
    "+ + + + + + + + + + +    the specific motivation for the work described in this paper is the experimental data on cell segregation in the developing zebrafish imaged by heisenberg and krens @xcite . making cells of two populations observable through fluorescent markers , they follow them through time , assigning each population ( cell type ) its own unique color .",
    "in this particular case , the two populations start spatially mixed and end in spatially segregated configurations .",
    "the segregation is captured by a series of @xmath0-dimensional images , which we turn into a shape in space - time .",
    "spatial segregation is a special case of the broader class of _ spatial sorting processes _ , in which we are given one or more distinguishable populations of particles ( points in space ) , and we are interested in characterizing their spatial rearrangement in time .",
    "we aim at characterizing the spatial sorting process through detailed measurements of its features .",
    "the quantification may be used to establish a classification of spatial sorting processes or , on a finer scale , to differentiate between realizations of the same process .",
    "a common biological application is the establishment of phenotypes that can help in the classification of genetic influences .",
    "once we have a description of the process beyond initial and final states , we may ask more subtle questions , such as whether an observed inverse process has a symmetric characterization .    [ [ results . ] ] results .",
    "+ + + + + + + +    our contributions are primarily mathematical , with the goal of using the insights toward the quantitative analysis of experimental time - series data :    1 .",
    "we _ model _ a spatial sorting process as a shape in space - time with descriptive topological properties ; 2 .",
    "we _ measure _ this shape using the persistent homology of the time function ; 3 .",
    "we _ provide _ a classification of the measurements , interpreting them as aspects of the process .",
    "note that measuring the process in space - time is different from taking the trajectory of measurements of the sequence of time - slices .",
    "indeed , we will distinguish between _ temporary _ space - time features , that can be observed in slices , from _ fleeting _ features that can not be so observed .",
    "the latter require memory and temporal reasoning and are therefore less readily accessible to an observer who lives in time .",
    "the main idea of our approach is to turn the time - series of geometric data into a @xmath1-dimensional topological space whose connectivity is descriptive of the spatial sorting process .",
    "the construction takes three steps to produce the measurements :    step 1 : : :    construct the voronoi tessellation to turn the data in a time - slice    into a subset of    @xmath2 ; step 2 : : :    maintain the construction through time , effectively sweeping out a    subset of    @xmath3 $ ] ; step 3 : : :    measure the constructed subset of space - time using the persistent    homology of its time function .",
    "we explain the first two steps in section [ sec2 ] and the third step in the section [ sec3 ] .",
    "details of the corresponding algorithms and their implementations can be found in @xcite .",
    "section [ sec4 ] discusses the information provided by persistent homology .",
    "section [ sec5 ] illustrates the ideas by running the corresponding algorithms on simulated data .",
    "section [ sec6 ] concludes the paper .",
    "in this section , we introduce the sets and complexes we use to model spatial sorting processes . in euclidean space ,",
    "we call them _ tessellations _ , _ triangulations _ , and _ complexes _ , and in space - time , we call them _",
    "medusas_. they all consist of _ cells _ of various dimensions , but because we also talk about cells in the biological sense , we will use special names , such as _ voronoi cells _ and _ simplices _ in euclidean space , and _ stacks _ and _ prisms _ in space - time , whenever possible .",
    "the input data is a finite set of colored points in @xmath2 .",
    "writing the color as subscript , we let @xmath4 be the union of @xmath5 to @xmath6 , assuming @xmath7 for all @xmath8 .    [ [ voronoi - tessellation - and - delaunay - triangulation . ] ] voronoi tessellation and delaunay triangulation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the _ voronoi cell _ of @xmath9 consists of all @xmath10 for which @xmath11 minimizes the euclidean distance among all points in @xmath4 : @xmath12 the set of voronoi cells , @xmath13 , is the _ voronoi tessellation _ of @xmath4 . for each @xmath14 , we write @xmath15 for the subset of voronoi cells of that color .",
    "note that @xmath16 is the disjoint union of @xmath17 .",
    "it is often convenient to work with the dual instead of directly with the voronoi tessellation .",
    "abstractly , this is the _ nerve _ of the set of voronoi cells , that is : the system of subsets whose voronoi cells have a non - empty common intersection .",
    "assuming general position of the points in @xmath4 , the number of voronoi cells that can have a non - empty common intersection is at most @xmath1 .",
    "we represent each set in the nerve by the convex hull of the points that generate its voronoi cells , which can be a vertex , and edge , a triangle , or a tetrahedron .",
    "together , these convex hulls form a simplicial complex , known as the _ delaunay triangulation _ of @xmath4 , and denoted as @xmath18 . for each @xmath14",
    ", we write @xmath19 for the full subcomplex of @xmath20 that consists of all vertices of color @xmath21 and all edges , triangles , and tetrahedra that connect them .",
    "as illustrated in figure [ fig : delaunay ] for @xmath22 , the full subcomplexes of different colors are disjoint , with multi - colored edges , triangles , and tetrahedra between them .",
    "[ [ restricted - voronoi - tessellation - and - alpha - complex . ] ] restricted voronoi tessellation and alpha complex .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in a loose configuration , a biological cell would generally not occupy the entire space alloted to it by the voronoi cell of its nucleus . to better approximate the space used by the cell , we therefore choose a fixed positive radius , @xmath23 , and consider the _ restriction _ of the voronoi cell to the ball centered at the generating point : @xmath24 similar to before , we write @xmath25 for the set of restricted voronoi cells , and @xmath26 for the subset of cells generated by points of color @xmath21 .",
    "clearly , @xmath27 is the disjoint union of @xmath28 .",
    "note that @xmath29 for each point @xmath9 .",
    "it follows that the nerve of @xmath27 is isomorphic to a subsystem of the nerve of @xmath16 .",
    "accordingly , we define the dual _ alpha complex _ to consist of the simplices in @xmath20 whose corresponding restricted voronoi cells have a non - empty common intersection , denoting it as @xmath30 . for each @xmath14",
    ", we again have the full subcomplex @xmath31 that contains all vertices of color @xmath21 and all simplices connecting them .",
    "figure [ fig : alpha ] illustrates the definitions by restricting the voronoi cells in figure [ fig : delaunay ] to their disks .",
    "note that @xmath32 is also a subcomplex of @xmath20 , but not necessarily a full subcomplex .",
    "indeed , we have @xmath33 , so @xmath32 is a full subcomplex of @xmath20 iff @xmath34 .    [ [ homotopy - equivalence . ] ] homotopy equivalence .",
    "+ + + + + + + + + + + + + + + + + + + + +    an important structural relationship between unions of voronoi cells and their dual complexes follows from the nerve theorem ; see e.g.  @xcite . to state the relationship",
    ", we ignore the difference between a set of voronoi cells and their union , as well as the difference between a simplicial complex and its underlying space .",
    "we write @xmath35 if the sets @xmath36 and @xmath37 have the same homotopy type ; see @xcite for a definition .",
    "we have @xmath38 , for each color @xmath14 .    proof .",
    "all cells in @xmath39 are closed and convex .",
    "it therefore suffices to use the corresponding special version of the nerve theorem .",
    "it says that the union of the sets and the nerve of the collection have the same homotopy type .",
    "the claimed relationships follow because @xmath32 is a geometric realization of the nerves of @xmath39 .",
    "we get @xmath40 as a special case .",
    "lemma a implies that @xmath39 and @xmath32 have isomorphic homology groups . instead of dealing with the computationally more difficult union of voronoi cells",
    ", we can therefore compute the homology for the dual complex , which is a purely combinatorial object .      assuming a continuous trajectory for each data point , we form subsets of space - time by taking unions of voronoi cells , both in space and in time . we begin with some definitions .",
    "trajectory _ is a continuous mapping @xmath41 \\to { { \\ifmmode{{\\mathbb r}}\\else{\\mbox{\\({\\mathbb r}\\)}}\\fi}}^3 $ ] , with @xmath42 .",
    "we let @xmath43 be a finite set of trajectories , assuming no two intersect in space - time ; that is : @xmath44 for all @xmath45 in @xmath43 and all @xmath46 $ ] for which both trajectories are defined . writing @xmath47 $ ] for the set @xmath48 ,",
    "we let @xmath49 $ ] be a coloring . at each time",
    "@xmath46 $ ] , we have a finite set of points , @xmath50 , of course taking only the trajectories with @xmath51 .",
    "the finite set of points is also colored , with coloring induced by @xmath52 .",
    "[ [ voronoi - and - delaunay - medusas . ] ] voronoi and delaunay medusas .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for each point @xmath53 , we write @xmath54 for its voronoi cell in @xmath55 .",
    "the voronoi tessellation at time @xmath56 is denoted as @xmath57 , and the subset of voronoi cells of color @xmath21 is denoted as @xmath58 .",
    "collecting voronoi cells in time , we get a @xmath59-parameter family of cells generated by a trajectory : @xmath60 } { { \\ifmmode{\\rm vor}\\else{\\mbox{\\(\\rm vor\\)}}\\fi}{({{{\\ifmmode{\\tt u}\\else{\\mbox{\\(\\tt u\\)}}\\fi}}(t ) } ) } } .",
    "\\label{eqn : voronoi}\\end{aligned}\\ ] ] noting that the voronoi cells on the right hand side of lie in distinct parallel copies of @xmath2 , we call @xmath61 a _ stack_. while the voronoi cell in each time - slice is a @xmath0-dimensional convex polyhedron , the stack itself is neither necessarily convex nor necessarily polyhedral ; see figure [ fig : stacks ] on the left .",
    "switching fonts , we write @xmath62 for the set of stacks , each defined by a trajectory in @xmath43 . for each @xmath14",
    ", we write @xmath63 for the subset of stacks generated by trajectories of color @xmath21 .",
    "we call @xmath64 the _ multi - chromatic _ and each @xmath65 a _ mono - chromatic voronoi medusa_.    similar to stacks of voronoi cells , we also consider stacks of delaunay simplices , which we call _ prisms_. there is an important difference caused by the occasional sudden change of the delaunay triangulation .",
    "such a change is a _ flip _ , which either replaces two tetrahedra by three , or three tetrahedra by two ; see e.g.  @xcite . in @xmath1-dimensional space - time",
    ", a flip appears as a ( degenerate ) @xmath1-simplex that connects to the preceding delaunay triangulations along two tetrahedra and to the succeeding delaunay triangulations along three tetrahedra , or the other way round .",
    "reducing the insertion or deletion of a point to a sequence of flips , as described in ( * ? ? ?",
    "* section 5.3 ) , we see that prisms and @xmath1-simplices suffice to fully describe the history of the delaunay triangulation .",
    "we write @xmath66 for the complex in @xmath3 $ ] and @xmath67 for the full subcomplex of color @xmath21 , calling @xmath68 the _ multi - chromatic _ and @xmath69 a _ mono - chromatic delaunay medusa_. figure [ fig : stacks ] illustrates the definitions in @xmath70 $ ] .    [",
    "[ restricted - voronoi - and - alpha - medusas . ] ] restricted voronoi and alpha medusas .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    following the distinction between unrestricted and restricted voronoi cells , we extend the latter to space - time in the obvious way . we thus introduce a _ stack _ of restricted voronoi cells , @xmath71 }                             { { \\ifmmode{\\rm res}\\else{\\mbox{\\(\\rm res\\)}}\\fi}{({{{\\ifmmode{\\tt u}\\else{\\mbox{\\(\\tt u\\)}}\\fi}}(t ) } ) } } , \\end{aligned}\\ ] ] the set of such stacks , @xmath72 , and the complex of prisms and @xmath1-simplices swept out by the simplices in the alpha complex , @xmath73 .",
    "furthermore , we introduce the colored subsets , @xmath74 , and the colored subcomplexes , @xmath75 , with @xmath76 $ ] .",
    "we call @xmath77 the _ multi - chromatic _ and each @xmath78 a _ mono - chromatic restricted voronoi medusa_. similarly , we call @xmath79 the _ multi - chromatic _ and each @xmath80 a _ mono - chromatic alpha medusa_.    [ [ homotopy - equivalence.-1 ] ] homotopy equivalence",
    ". + + + + + + + + + + + + + + + + + + + + +    the structural relationship between unions of voronoi cells and their dual complexes extends from @xmath2 to @xmath3 $ ] . as before , we simplify the notation by ignoring the difference between a collection of cells and its union .",
    "we have @xmath81 , for each color @xmath76 $ ] .    proof .   as in the proof of lemma a , we appeal to the nerve theorem to give the claimed relationships .",
    "since the cells are no longer convex , we use the more general version that applies to finite collections of closed , contractible sets whose intersections ( of any order ) are again contractible .    while each stack in @xmath78 of any dimension is swept out by a convex set and",
    "is therefore contractible , two stacks can intersect in two or more ( lower - dimensional ) stacks , which prevents the direct application of the nerve theorem .",
    "we finesse the difficulty by shrinking each stack at its boundary and thickening it into a @xmath1-dimensional body ; see figure [ fig : nerve ] . there is more than one way to do this such that the bodies are closed and contractible , their union is the same as the union of the original stacks , and the common intersection of @xmath82 bodies is either empty or a contractible @xmath83-dimensional set .",
    "for example , we may use the mixed complex defined for voronoi cells in @xcite to sweep out the bodies .",
    "letting @xmath84 be the resulting set of bodies , we consider the nerve , which we denote by @xmath85 . as illustrated in figure [ fig : nerve ] , this nerve is the barycentric subdivision of a complex of simplices whose vertices correspond to the original @xmath1-dimensional stacks .",
    "note that this complex is _ not _ necessarily a simplicial complex , since two simplices may share more than just one common face . denoting this complex of simplices by @xmath86 , we have @xmath87 in which the only non - trivial , middle relation is furnished by the nerve theorem . to complete the argument",
    ", we still need to show that @xmath86 and @xmath80 have the same homotopy type . to do this",
    ", we contract each prism in @xmath80 along the time direction .",
    "indeed , each prism is a simplex times a time interval , and the contraction glues the bottom to the top face , effectively turning the prism into a simplex .",
    "we do this for all prisms simultaneously in order to avoid temporary inconsistencies between the prisms and their side faces , which are lower - dimensional prisms . eventually , when all prisms have be contracted , we have turned the medusa into @xmath86 .",
    "since the contraction preserves the homotopy type , this implies the claimed relation .",
    "we get @xmath88 as a special case .",
    "lemma b also implies that we get isomorphic homology groups and can therefore do the computation on the dual medusa , or indeed the complex of simplices , @xmath86 , which is a purely combinatorial object .",
    "we refer to it as the _ data structure _ for the mono - chromatic alpha medusa ; beyond being instrumental in the proof of lemma b , it is the main computational tool we use to implement that algorithms that are only sketched in this paper ; see @xcite .",
    "we use the restricted voronoi medusa to explain filtered sequences of spaces , and free up to subscript by focusing the discussion on the multi - chromatic version .",
    "[ [ sub -- and - superlevel - sets . ] ] sub- and superlevel sets .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    the appropriately restricted _ time function _ ,",
    "@xmath89 $ ] , maps every point @xmath90 to its time coordinate , @xmath91 .",
    "given a moment in time , @xmath46 $ ] , the corresponding _ sublevel set _",
    "is @xmath92 $ ] , and the corresponding _ superlevel set _ is @xmath93 $ ]",
    ". we will be interested in the filtered sequences : @xmath94 they capture the evolution of the restricted voronoi medusa in a way that allows us to compare different states without the burden of computing a correspondence .",
    "similarly , we consider the time function restricted to the alpha medusa , define sub- and superlevel sets , @xmath95 and @xmath96 , and form filtered sequences as before .",
    "importantly , the transformation from the stacks to the prisms does not change the homotopy type .",
    "we have @xmath97 as well as @xmath98 , for all @xmath46 $ ] .",
    "we omit the proof which is similar to that of lemma b. it is important to realize that lemma c extends to all mono - chromatic medusas .",
    "[ [ complexes - of - simplices . ] ] complexes of simplices .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    following the proof of lemma b , we find it convenient to replace the sub- and superlevel sets of the alpha medusa by complexes of simplices .",
    "specifically , we write @xmath99 for the complex obtained by contracting all prisms in @xmath95 in time direction .",
    "symmetrically , we write @xmath100 for the complex obtained by contracting all prisms in @xmath96 .",
    "there is an alternative description .",
    "let @xmath101 be a prism in @xmath79 , and write @xmath102 and @xmath103 for the minimum and maximum time values of the points in @xmath101 .",
    "we assign these two values as @xmath104 to the simplex @xmath105 in @xmath106 obtained by contracting @xmath101 .",
    "then @xmath99 is the subcomplex of simplices with @xmath107 , and @xmath100 is the subcomplex of simplices with @xmath108 .",
    "note that @xmath99 and @xmath100 overlap in the simplices that correspond to the prisms with @xmath109 .",
    "similar to the sub- and superlevel sets , the complexes of simplices form filtered sequences : @xmath110 again , the transformation does not affect the homotopy type .",
    "indeed , the complexes forming the filtered sequences in and are reminiscent of the lower- and upper - star filtrations we find in @xcite .",
    "in this section , we turn the spaces of section [ sec2 ] into algebraic information .",
    "the foundation of the transformation is the classical notion of homology , which we review .",
    "the information is summarized in persistence diagrams , which we introduce for modules obtained from sub- and superlevel sets of the time function .",
    "homology groups detect and count holes in a single space .",
    "we begin with a brief introduction of this classical subject ; see @xcite for more information .",
    "[ [ homology - groups . ] ] homology groups .",
    "+ + + + + + + + + + + + + + + +    consider a simplicial complex , perhaps an alpha complex , @xmath111 , which consists of simplices of dimension @xmath112 .",
    "fixing a field of coefficients , @xmath113 , we call a formal sum of the form @xmath114 a _",
    "@xmath115-chain _ , in which the @xmath116 are elements of @xmath113 and the @xmath117 are @xmath115-simplices in @xmath111 , each with a fixed orientation .",
    "the _ boundary _ of the @xmath115-chain is the similarly weighted sum of boundaries of the simplices : @xmath118 , in which @xmath119 is the sum of the @xmath120-simplices that are its faces .",
    "we call @xmath121 a _ @xmath115-cycle _ if @xmath122 , and we call @xmath121 a _ @xmath115-boundary _ if there is a @xmath123-chain @xmath124 with @xmath125 .",
    "the chains thus form _ chain groups _ connected by boundary homomorphisms , @xmath126 . similarly ,",
    "the cycles form _ cycle groups _ , the kernels of the boundary homomorphisms , @xmath127 , and the boundaries form _ boundary groups _ , the images of the boundary homomorphisms , @xmath128 .",
    "since the boundary of a boundary is necessarily zero , we have @xmath129 and we can take the quotient , @xmath130 , which is the _",
    "@xmath115-th homology group_. homology groups can be defined quite generally , for example , as explained above for triangulations of topological spaces .",
    "since we choose the coefficients from a field , all groups we mentioned are vector spaces , which are characterized by their ranks . for the @xmath115-th homology group , the rank",
    "is called the _",
    "@xmath115-th betti number _",
    ", denoted as @xmath131 .    for a space of dimension @xmath132 ,",
    "the only possibly non - zero betti numbers are @xmath133 to @xmath134 . in our case",
    ", @xmath111 has dimension at most @xmath135 , and we have @xmath136 because every @xmath0-chain in @xmath2 has non - zero boundary .",
    "the remaining three possibly non - zero betti numbers have intuitive interpretations : @xmath133 counts components , @xmath137 counts loops , and @xmath138 counts completely surrounding walls .",
    "we get additional intuition by observing that the connectivity of the complement space , @xmath139 , depends on the connectivity of @xmath111 , a relation formalized by alexander duality @xcite .",
    "we refer to the elements of the homology group of the complement space as the _ holes _ of @xmath111 . distinguishing between the different dimensions , @xmath140 counts _ gaps _ between the components , @xmath137 counts _ tunnels _ passing through the loops , and @xmath138 counts _ voids _ surrounded by walls .",
    "we will compute betti numbers for medusas in @xmath3 $ ] . while more complicated than in @xmath0-dimensional space , we can still interpret the betti numbers in terms of _ evolutions _ of gaps , tunnels , and voids , as we will explain in section [ sec4 ] .",
    "in addition to single spaces , we take the homology of pairs in which the second space is a subset of the first , such as @xmath141 , for example",
    ". the _ @xmath115-th relative homology group _",
    ", denoted as @xmath142 , is defined the same way as @xmath143 except that differences in @xmath144 are ignored . in other words ,",
    "two chains are the same if they agree on all simplices in @xmath145 , etc . to get an intuition for these groups",
    ", we may add the cone over @xmath144 .",
    "then the rank of @xmath142 is the same as the rank of the @xmath115-th absolute homology group for the modified complex , except for @xmath146 , where it is one less .    [",
    "[ ordinary - and - extended - persistence - modules . ] ] ordinary and extended persistence modules .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the language of category theory , homology is a functor that maps a space , or a pair of spaces , to a sequence of groups , one for each dimension . to simplify the notation , we write @xmath147 for the direct sum of the individual groups .",
    "this frees up the subscript , which we use to index the homology groups of a filtered sequence .",
    "letting @xmath148 be the homological critical values of @xmath149 , we note that the homology group is constant for all @xmath150 .",
    "hence , it suffices to list the finitely many groups @xmath151 to describe the entire @xmath59-parameter family , giving a finite sequence of homology groups connected by homomorphisms induced by inclusion : @xmath152 we call a _ persistence module _ , or more specifically the _ ordinary persistence module _ of @xmath153 .",
    "as described in ( * ? ? ?",
    "* section vii.1 ) , we can use the persistence module to define _ births _ and _ deaths _ of homology classes and arrange them in pairs . specifically ,",
    "a class is _ born _ at @xmath154 if it does not belong to the image of @xmath155 , and it _ dies entering _",
    "@xmath156 if @xmath157 is the smallest index for which the image of the class lies in the image of @xmath155 . the birth - death pair describes a coset of homology classes and specifies their _ persistence _ as the absolute difference between the function values at the two events , in this case @xmath158 .",
    "the ordinary module allows for homology classes that are born but never die .",
    "these are the classes that describe the entire medusa , @xmath77 , which are of particular interest to us . to get a finite measurement of duration",
    ", we extend the module using the relative homology groups of the form @xmath159 .",
    "writing @xmath160 , we get @xmath161 which we call the _ extended persistence module _ of @xmath162 . it begins and ends with the trivial group , which implies that everything that is born also dies .",
    "we thus get a more complete set of measurements of the alpha medusa from than from .",
    "[ [ isomorphic - relative - homology - groups . ] ] isomorphic relative homology groups .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    lemma c implies that the ( absolute ) homology groups of the sublevel sets of the restricted voronoi medusa are isomorphic to those of the alpha medusa .",
    "we now show that the same is true for the relative homology groups .",
    "the relative homology groups @xmath159 and @xmath163 are isomorphic , for all @xmath46 $ ] .    proof .",
    "recall the exact sequences of the two pairs , which we write from left to right and in parallel : @xmath164 by lemma c , the vertical maps between the first , second , fourth , and fifth groups are isomorphisms .",
    "the diagram commutes because all maps are induced by inclusion .",
    "the steenrod five lemma thus implies that the vertical maps between the middle groups is also an isomorphism @xcite .",
    "similar to lemma c , lemma d extends to the mono - chromatic case .",
    "it is instructive to display the information contained in a persistence module as a finite multi - set of points ( referred to as _ dots _ ) in the plane . after explaining how this is done",
    ", we prove that the sequences of homotopy equivalent spaces introduced above give the same diagram .",
    "[ [ persistence - diagram . ] ] persistence diagram .",
    "+ + + + + + + + + + + + + + + + + + + +    as before , we consider the restricted voronoi medusa , @xmath77 , the time function @xmath89 $ ] , and the extended module defined by the sub- and superlevel sets .",
    "the _ persistence diagram _ of @xmath162 , which we denote as @xmath165 , is a multi - set of dots in a double covering of the plane ; see figure [ fig : diagram ] .",
    "each dot has two coordinates and represents a coset of homology classes .",
    "these classes have a homological dimension , which we use to label the dot .",
    "very often , we consider subdiagrams by limiting ourselves to dots of a particular dimension .",
    "for example , @xmath166 is the multiset of dots of homological dimension @xmath167 , which therefore only represents components .",
    "the arrows in our drawing indicate the direction of increasing time .",
    "since we have two phases , one sweeping forward and the other backward in time , we get every pair of coordinates twice .",
    "to explain this in more detail , we call the two coordinates the _ birth _ and the _ death _ of the dot ( or of the homology classes it represents ) .",
    "the birth axes appear as @xmath168 lines in the figure , and the death axes as @xmath169 lines .",
    "we decompose the persistence diagram into four triangles , referred to as the _ ordinary _ , _ horizontal _ , _ vertical _ , _ relative subdiagrams _",
    ", denoted as @xmath170 , @xmath171 , @xmath172 , @xmath173 .",
    "a dot in @xmath170 represents classes that are born and die during the first phase , a dot in @xmath171 or @xmath172 represents classes that are born during the first phase and die during the second phase , and a dot in @xmath173 represents classes that are born and die during the second phase .",
    "the difference between a dot in @xmath171 and in @xmath172 is that for the former the birth coordinate is smaller than the death coordinate , while for the latter it is the other way round .",
    "we believe this difference is important , as we will explain later .    [ [ equivalence . ] ] equivalence .",
    "+ + + + + + + + + + + +    using lemmas a to d , we can now make sure that the diagrams we get from the different medusas are the same .",
    "as before , we limit the discussion to the multi - chromatic restricted voronoi and alpha medusas .",
    "let @xmath162 and @xmath162 be the corresponding time functions .",
    "@xmath174 and @xmath165 are the same .",
    "proof .   the main tool in this proof is the diagram that connects the homology groups in the two modules : @xmath175 by lemmas c and d , the vertical maps are isomorphisms . since the diagram commutes",
    ", the claim follows by the persistence equivalence theorem in @xcite .",
    "similar to lemmas c and d , lemma e extends to the mono - chromatic case , and it implies the same relation for delaunay and voronoi medusas as a special case .",
    "we expect the measurements for the alpha medusa to be more meaningful than for the delaunay medusa , but there is additional information in the difference .",
    "we compare by studying the images of the homomorphisms induced by the inclusion of the one in the other medusa . while we use this ability for mono - chromatic medusas , we simplify the notation by describing it in the multi - chromatic case .    [",
    "[ image - persistence . ] ] image persistence .",
    "+ + + + + + + + + + + + + + + + + +    recall that @xmath176 , @xmath144 , @xmath177 , and @xmath178 are the sublevel and superlevel sets of the voronoi medusas , for @xmath46 $ ] . by construction",
    ", we have @xmath179 and @xmath180 .",
    "applying the homology functor , we get finitely many distinct groups , which we denote as @xmath154 for the restricted and as @xmath181 for the unrestricted voronoi medusa . aligning the two modules",
    ", we repeat groups as necessary and arrange them in a commuting diagram : @xmath182 writing @xmath183 for the homomorphism induced by the inclusion , we are interested in the sequence of images : @xmath184 similar to the module of homology groups , is a sequence of vector spaces connected by homomorphisms .",
    "we can therefore define births and deaths .",
    "we refer to the corresponding multiset of dots as the _ image persistence diagram _ , denoted as @xmath185 ; see @xcite for a detailed discussion of this construction and for an algorithm .",
    "what does the diagram measure ? in the assumed case of",
    "the multi - chromatic restricted included in the multi - chromatic unrestricted voronoi medusa , it measures nothing interesting , simply because the groups @xmath181 are not interesting .",
    "this is different in the mono - chromatic case . here",
    ", we may have a cycle defined by data points of color @xmath21 surrounding points of color different from @xmath21 . in this case",
    ", we have a non - trivial class in a ( closed or open ) sublevel set of the restricted voronoi medusa whose image in the corresponding sublevel set of the unrestricted voronoi medusa is still non - trivial .",
    "indeed , a cycle in @xmath78 gives rise to a dot in @xmath186 iff it corresponds to a hole formed by points of color different from @xmath21 .",
    "if the hole is not formed by such points , then it does not exist in the unrestricted voronoi medusa , the class maps to @xmath167 , and there is no corresponding dot in the image persistence diagram .    instead of @xmath187",
    ", we can use the inclusion of @xmath78 in @xmath77 to recognize when holes are caused by interactions between different colors .",
    "the algebraic set - up is the same , so we do not need to repeat it . as described in the experimental section [ sec5 ] , the latter inclusion seems to be more effective than the inclusion in the mono - chromatic voronoi medusa .",
    "this is perhaps related to the fact that the most interesting is also the most difficult case in this respect , namely that of a @xmath59-dimensional homology class in @xmath2 .",
    "[ [ equivalence.-1 ] ] equivalence .",
    "+ + + + + + + + + + + +    similar to the conventional case , the image persistence diagrams do not depend on the representation of the space and the time function we use . specifically , we get the same diagrams for the inclusion of @xmath77 in @xmath64 as for the inclusion of @xmath79 in @xmath68 .",
    "@xmath185 and @xmath188 are equal as diagrams .",
    "proof .   arrange the four modules in a @xmath0-dimensional diagram , in which the @xmath189-dimensional section at time @xmath56 consists of the ( absolute ) homology groups of the sublevel sets : @xmath190 or of the relative homology groups if the section is taken during the second phase . in all three directions ,",
    "the maps are induced by inclusion , so the diagram commutes .",
    "this implies that we have maps between the corresponding two modules of images . by lemmas c and d ,",
    "the horizontal maps in the @xmath0-dimensional diagram are isomorphisms , which implies that the maps connecting the two modules of images are isomorphisms .",
    "the claimed relation is implied by the persistence equivalence theorem .",
    "similar to lemmas c , d , and e , lemma f extends to the mono - chromatic case .",
    "we note that the two derived persistence diagrams are best computed using the complexes of simplices , @xmath106 and @xmath191 .",
    "indeed , these can be connected by a mapping cylinder , giving a complex of simplices and prisms , not unlike but different from the alpha medusa . from this complex",
    ", we get the image persistence diagrams by standard matrix reduction ; see @xcite .",
    "in this section , we discuss the information contained in the extended persistence module defined by the time function , interpreting the corresponding events in static space - time as well as in dynamic temporal language .",
    "we begin with the @xmath189-dimensional case as a warm - up exercise , but also to facilitate the comparison with the @xmath0-dimensional case . here , the medusa is embedded in @xmath70 $ ] , and the time function , denoted as @xmath153 , maps each point to its time coordinate .",
    "we can have dots in the diagram for dimensions @xmath167 , @xmath59 , @xmath189 , except for @xmath193 , @xmath194 , @xmath195 , and @xmath196 . recall that the persistence of the class represented by a dot @xmath197 is the absolute difference between the two coordinates , which we denote as @xmath198 . in the ordinary and relative subdiagrams ,",
    "@xmath199 is @xmath200 times the distance from the baseline , while in the horizontal and vertical subdiagrams , it is @xmath200 times the distance from the vertical axis that goes through the middle of the diagram . as established in section [ sec3 ] , we have the choice between several filtrations , all giving the same persistence diagram . to focus the discussion , we limit ourselves to the medusa that best approximates the reality of biological cells , namely the mono - chromatic restricted voronoi medusa . in the text",
    "below , we use _ cell _ in the biological meaning of the word .",
    "[ [ type - analysis . ] ] type analysis .",
    "+ + + + + + + + + + + + + +    the classes recorded in the ordinary subdiagram are illustrated in figure [ fig : cases ] ( a ) .",
    "a dot @xmath197 in @xmath201 corresponds to a component born at @xmath202 that merges with another , older component at @xmath203 .",
    "if @xmath204 , then a non - empty subset of the cells that make up the component exist at the very beginning of the observed time - series .",
    "its death marks the merger with another component also born at @xmath167 , and the tie in the decision who dies and who lives is broken arbitrarily . if @xmath205 , the component is born because of a new cell that is either created by cell division or enters the observation for technical reasons .",
    "a dot @xmath197 in @xmath206 corresponds to a ring ( an annulus ) that forms at @xmath202 and whose hole fills up at @xmath203 .",
    "the classes in the horizontal subdiagram are illustrated in figure [ fig : cases ] ( b ) .",
    "a dot @xmath197 in @xmath207 corresponds to a component born on the way up at @xmath202 and dying on the way down at @xmath203 .",
    "we have @xmath208 since @xmath209 is the minimum and @xmath210 is the maximum time value of the points in the component .",
    "assuming some cells of color @xmath21 live from the beginning to the end of the observations , we have at least one dot with coordinates @xmath167 and @xmath59 in @xmath207 . in the case of a successful segregation ,",
    "in which color @xmath21 eventually forms a single component , we have exactly one such dot and no other other dots with second coordinate equal to @xmath59 in the @xmath167-dimensional horizontal subdiagram .",
    "a dot @xmath197 in @xmath211 corresponds to a ring that forms at @xmath202 and breaks up at @xmath203 .",
    "the breaking up of the ring is not detected by the homology of the growing sublevel set , but rather later by the relative homology during the down phase .",
    "the classes recorded in the vertical subdiagram are illustrated in figure [ fig : cases ] ( c ) .",
    "a dot @xmath212 in @xmath213 corresponds to a tunnel born on the way up at @xmath203 which dies on the way down at @xmath202 , where @xmath208 .",
    "the tunnel is the plane - time expression of a gap that temporarily opens up between two subpopulations of a component that later closes again .",
    "a dot @xmath212 in @xmath214 corresponds to a void born on the way up at @xmath203 which dies on the way down at @xmath202 , where @xmath208 .",
    "the void is formed by a temporary ring structure we see within an interval of level sets .",
    "in contrast to the rings discussed earlier , this ring is formed by puncturing . first , the hole expands until it eventually shrinks back to a point and disappears at @xmath215 .",
    "the classes recorded in the relative subdiagram are illustrated in figure [ fig : cases ] ( d ) .",
    "a dot @xmath212 in @xmath216 corresponds to a component of the level set that splits off another component at @xmath202 , and dies off at @xmath203 .",
    "since this event is detected in the down phase of the module , we see the birth of a @xmath59-dimensional class at @xmath203 and its death at @xmath202 .",
    "a dot @xmath212 in @xmath217 corresponds to ring formed by puncturing a disk at @xmath202 .",
    "the hole expands and eventually disappeared because of the breaking up of the ring at @xmath203 .",
    "[ [ interaction - between - colors . ] ] interaction between colors .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    the appearance and disappearance of a hole may or may not be facilitated by interactions with cells of different color .",
    "for example , a gap recorded in the ordinary subdiagram may disappear by squeezing out cells of color different from @xmath21 , or simply by locally consolidating the configuration . in the former case ,",
    "it is likely that the gap also existed in @xmath65 and unlikely that it existed in @xmath77 .",
    "accordingly , the gap in @xmath78 would be represented by a dot in the image persistence diagram of @xmath187 but not in that of @xmath74 . in the latter case",
    ", it would of course be the other way round .",
    "similar distinctions can be made for gaps recorded in @xmath218 , @xmath219 , and @xmath220 .",
    "the analysis of rings formed by cells of color @xmath21 is similar .",
    "a ring may form around a population of cells of color different from @xmath21 , or around empty space . in the former case ,",
    "the ring can only disappear by killing the surrounded cells or by breaking up to release these cells .",
    "since killing seems unlikely , this may mean that such rings are rare in the ordinary and more common in the horizontal subdiagram .",
    "similarly , the latter case is likely to be the preferred configuration for rings recorded in the vertical and the relative subdiagrams .",
    "indeed , these rings form by puncturing and can therefore not be invaded by cells from the outside .",
    "note , however , that the suggestion that a dot in the persistence diagram of @xmath78 either appears or does not appear in the image persistence diagram is an over - simplification .",
    "thinking of a dot as an interval , it can break up into shorter intervals , or merge with others into a longer interval .",
    "similarly , there is generally no simple relationship between the image persistence diagram and the diagram of the containing medusa .",
    "similar to the planar case , we discuss the time function on a mono - chromatic restricted voronoi medusa , @xmath221 $ ] with @xmath222 $ ] .",
    "[ [ types . ] ] types .",
    "+ + + + + +    compared to the planar case , we have one more dimension and therefore one additional case in each subdiagram ; see figure [ fig : diagram ] . in temporal language",
    ", we follow the evolution of @xmath167- , @xmath59- , and @xmath189-dimensional holes , which we refer to as _ gaps _ , _ tunnels _ , and _ voids_. there are two ways a hole can appear : by _ closing _ the surrounding cycle , or by _ puncturing_. of course , a hole can already exist at the beginning , at @xmath223 , in which case its birth coordinate is @xmath224 .",
    "similarly , there are two ways a hole can disappear : by _ breaking up _ the surrounding cycle , or by _ filling up _ the hole .",
    "in addition , it may remain to the end , at @xmath225 , in which case the death coordinate is @xmath226 .",
    "we observe that a @xmath115-dimensional hole in the level set gives rise to either a @xmath115-dimensional or a @xmath123-dimensional class in the persistence module , and which it is depends on how the hole comes into existence : either by closing a @xmath115-dimensional cycle or by puncturing a @xmath123-dimensional chain ; see table [ tbl : holes ] . a hole recorded in the ordinary subdiagram is formed by closing a cycle , allowing for the case that it exists already at the beginning , and it disappears by filling up .",
    "we refer to this action as _",
    "symmetrically , a hole recorded in the relative subdiagram is formed by puncturing , and the surrounding cycle either breaks up or the hole remains until the end .",
    "we refer to this action as _",
    "disaggregation_. in contrast , the holes recorded in the vertical and horizontal subdiagrams represent aggregations and disaggregations that are either transient or incomplete .",
    "specifically , a hole recorded in the vertical subdiagram appears by puncturing , but instead of breaking up , it disappears by filling .",
    "finally , a hole in the horizontal subdiagram forms by closing a cycle that breaks up later , which allows for the case that the hole exists already at the beginning or that is remains to the end .",
    ".the twelve cases that arise from four kinds of evolutions possible for each of three different types of holes in a @xmath59-parameter family of spaces in @xmath2 . [ cols=\"^,^,^,^,^ \" , ]",
    "this paper introduces the persistent homology analysis of a medusa as a novel method to measure cell segregation . to provide a proof of concept , we have computed these measurements for simulated time series of 3d data .",
    "the application of the method to imaged cell segregation in zebrafish embryos is forthcoming .",
    "the medusa introduced in this paper is related to the vineyard described in ( * ? ? ?",
    "* section viii.1 ) ; see also @xcite .",
    "however , there are differences .",
    "specifically , the vineyard would be constructed for two parameters , the restricting radius , @xmath227 , and the time , @xmath56 .",
    "the result is a richer structure , namely a collection of curves in @xmath70 $ ] , which is therefore more difficult to understand .",
    "in contrast , the medusas fix @xmath227 to @xmath23 and in this way facilitate a more compact representation of a subset of the vineyard .",
    "this is appropriate for biological cells whose size does not vary substantially with time , and it gives topological information that is easier to interpret and more directly relevant to the object of study .",
    "however , we need to keep in mind that with this choice , the persistence diagrams are not stable under the bottleneck distance .",
    "the results are particularly sensitive to the radius , which leaves holes if chosen too small and absorbs holes if chosen too big .",
    "the work in this paper has motivated the extension of alexander duality from spaces to functions , as proved in @xcite .",
    "in particular , the euclidean shore theorem in that paper states that the persistence diagram of the time function restricted to the boundary of a voronoi medusa can be obtained from the diagram of the time function on the voronoi medusa .",
    "generically , the boundary is a @xmath0-manifold without boundary , so that the time function can be understood in morse theoretic terms , which is sometimes convenient .    in conclusion",
    ", we note that the framework introduced in this paper applies to general point processes that unfold in time . the latter model a variety of problems",
    "of which we mention a few : molecules of two fluids mixing after a shock - wave ; microbes forming microfilms ; a flock of birds getting into formation ; two teams competing in a soccer game ; galaxies moving under the influence of gravity .",
    "the measurements taken within this framework are significantly coarser than what could be said by studying braids @xcite or the loop spaces of configuration spaces needed to detect topological differences for particles moving in @xmath0 dimensions @xcite .",
    "this is not necessarily a disadvantage since the coarser information is easier to compute as well as to comprehend ."
  ],
  "abstract_text": [
    "<S> we consider the simultaneous movement of finitely many colored points in space , calling it a _ spatial sorting process_. the name suggests a purpose that drives the collection to a configuration of increased or decreased order . </S>",
    "<S> mapping such a process to a subset of space - time , we use persistent homology measurements of the time function to characterize the process topologically . </S>"
  ]
}