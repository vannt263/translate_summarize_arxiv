{
  "article_text": [
    "the dynamical effects of radiation can be important in astrophysical contexts , so numerical simulations must often address the radiation transport problem .",
    "the radiation field , when treated fully , is a function of not only three spatial coordinates , but also of time , frequency and two direction angles .",
    "the high dimensionality of the problem makes it computationally very challenging , and approximate methods that ignore certain dependencies ( e.g. , on frequency and/or angle ) are often employed .",
    "recent efforts aim to relax these approximations and improve the accuracy of the transport scheme . given the difficulty of the radiation - hydrodynamics ( rhd ) problem , and the critical importance of it in astrophysical simulation , a number of different numerical techniques should be explored .",
    "ultimately , no single approach may prove ideal in every conceivable application , and the relevant tradeoffs in performance will need to be considered on a case by case basis .    in this paper",
    "we explore the coupling of monte carlo radiative transfer ( mcrt ) to hydrodynamics .",
    "the monte carlo approach offer several advantages as compared to a deterministic solution of the radiative transfer equation .",
    "mcrt generalizes readily to arbitrary 3-dimensional geometries , and can naturally incorporate multi - frequency , multi - angle , and time - dependent transport effects .",
    "it is also straightforward to include complex physical interactions , such as anisotropic and inelastic scattering processes , polarization , and resonant line scattering .",
    "mcrt methods generally parallelize well ( although not necessarily trivially for memory intensive problems @xcite ) and so can be run profitably on massively - parallel machines .",
    "this last consideration may ultimately prove to be the most significant , as the available computing power increases over time .",
    "the main disadvantage of mcrt methods is the presence of stochastic error , such that the computation of a large number of packet trajectories may be required .",
    "a number of variance reduction techniques exist to help limit the unwanted effects of noise , and certain acceleration techniques can alleviate the well known computational inefficiency of mcrt in regimes of high optical depth .",
    "the ultimate expense of mcrt relative to other transport methods is difficult to estimate , but generally as the dimensionality of the problem increases , the advantages of monte carlo methods become more apparent .",
    "this suggests that mcrt will be competitive in addressing the full 3-d multi - angle multi - frequency rhd problem .",
    "here we present calculations using a mcrt code designed to handle the full - dimensionality of the boltzmann transport problem  i.e. , the dependence on 3 spatial dimensions , time , frequency and angle .",
    "the code is special relativistic and includes some more complex physical interactions , such as resonant line scattering .",
    "it makes use of implicit techniques @xcite in order to permit time - steps larger than the gas - radiation energy coupling time . for the sake of demonstrating the essential principles and assessing the viability of the approach , we restrict ourselves to coupling to a one - dimensional hydrodynamics solver ; upcoming work will generalize to multi - dimensional rhd .",
    "in section [ sec : literaturereview ] , we review some of the existing literature on rhd in astrophysics , including previous efforts in mcrt . in section [ sec : equations ] we outline the equations solved and the simplifying assumptions employed .",
    "section [ sec : montecarlo ] describes the monte carlo implementation , while section [ sec : hydro ] describes our numerical hydrodynamics scheme .",
    "section [ sec : implicitmc ] describes the implicit monte carlo technique and its use in our code .",
    "section [ sec : radiationtests ] describes some radiation - only tests of our frequency - dependent transfer code . section [ sec : radhydrotests ] , the centerpiece of this paper , presents a suite of rhd test problems .",
    "section [ sec : radiationforcecomparsion ] shows how monte carlo noise can be reduced by computing the radiation force via spatial derivatives of the eddington tensor , rather than through a direct monte carlo force estimator .",
    "section [ sec : performance ] provides some brief considerations of the numerical performance of our code and the possibilities for improving it in the future .",
    "finally , section [ sec : conclusion ] presents our conclusions .",
    "radiation - hydrodynamics is a vast topic that spans many scientific disciplines . in this brief ( and necessarily incomplete ) review",
    ", we will emphasize multi - purpose astrophysical fluid codes .",
    "one of the oldest and most commonly used techniques is flux - limited diffusion ( fld ) @xcite . as its name suggests , in this approach radiation",
    "is transported via a diffusion equation , which amounts to dropping all terms in the radiative transfer ( rt ) equation with a higher - order than linear angular dependence .",
    "an interpolation procedure connects the optically thick to optically thin regimes and ensures that the transfer rate of radiative energy never exceeds the speed of light .",
    "grid - based hydrodynamic and magneto - hydrodynamic ( mhd ) codes in use today making use of fld include those described in @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , and @xcite .",
    "additionally , @xcite describe a smoothed - particle hydrodynamics code that makes use of fld .    while fast and relatively easy to implement , fld suffers from some well - characterized shortcomings .",
    "it restricts the radiative flux to be in the direction of the radiative energy gradient , which can lead to misdirected radiation forces . as a result",
    ", the radiation in an fld simulation will wrap around opaque barriers rather than cast sharp shadows .",
    "an alternative method which alleviates this problem is the @xmath0 closure for the eddington tensor @xcite . here , the two lowest - order angular moments of the rt equation are used .",
    "the radiation energy and pressure are related via an entropy minimization procedure , which results in the correct behavior in the free - streaming and diffusion limits .",
    "the @xmath0 closure has been implemented in astrophysical rhd codes including those described in @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , and @xcite .",
    "another option is to solve the full rt equation for discretized solid angle bins .",
    "this can be accomplished by solving the equation along rays that extend through multiple cells in the domain , a technique referred to as ray - tracing or a long - characteristics method .",
    "an early example of an astrophysical rhd code to use this approach is the stellar atmoshpere code described in @xcite , @xcite , and @xcite , using a variation of a method first proposed by @xcite .",
    "the long characteristics approach is especially effective in situations where a single or small number of luminous point sources are present , and a common application is tracking the ionizing radiation emitted from massive stars .",
    "@xcite describes an an adaptively branching ray tracing procedure , and it has been applied to hd and mhd calculations coupled to ionizing radiation as described in @xcite , @xcite and @xcite .",
    "other uses of ray tracing to track ionizing radiation include those described in @xcite , @xcite , @xcite , and smoothed - particle hydrodynamics implementations are described in @xcite and @xcite .",
    "@xcite introduced a hybrid approach in which ray tracing is used to follow the direct radiation from a point source , while fld is used simultaneously to follow diffuse radiation .",
    "a related method is the short - characteristics technique , which is a subset of @xmath1 methods . here",
    ", the rt equation is solved for a fixed set of angles within every grid cell .",
    "early descriptions of such a technique were given by @xcite and @xcite .",
    "for problems in which the radiation enters the diffusion regime , so that the radiative emissivity is distributed over many grid cells , the short - characteristics approach allows the the computational expense of the problem to scale more slowly with the size of the grid than in the long characteristic case @xcite .",
    "an early example of an astrophysical rhd code to make use of the short - characteristics technique for two - dimensional problems is described in @xcite .",
    "@xcite , @xcite , @xcite , and @xcite describe codes that use short characteristics for neutrino transport , which is coupled to hydrodynamics in simulations of core - collapse supernovae .",
    "@xcite describe an rhd code that uses short - characteristics in the context of stellar atmospheres .",
    "@xcite developed a hybrid method that combined techniques from both short- and long - characeterstics radiative transfer codes in the context of adaptive mesh refinement in three dimensions .",
    "three - dimensional mhd simulations with radiation tracked using short characteristics include those described in @xcite , @xcite , and @xcite .",
    "overall , the short characteristics approach has proven to be accurate and reasonably fast .",
    "one potential drawback is the appearance of ray artifacts at large distances from luminous sources .",
    "@xcite introduced an advection technique to solve the monochromatic radiative transfer equation on both structured and unstructured meshes . in the most general implementation of this scheme , the flux of radiative energy between zones is discretized into solid angle cones , which bears some resemblance to the short - characteristics method .",
    "mcrt , while used for decades to simulate spectra and light curves of astrophysical objects ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , has only recently been employed in the context of astrophysical rhd . @xcite",
    "developed time - dependent ( non - stationary ) mcrt techniques for outflows in which radiation was not dynamically important .",
    "@xcite used mcrt to process snapshots of hd simulations to demonstrate that the diffuse radiation field in stellar ionization problems can differ significantly from an on - the - spot approximation for remitted ionizing photons .",
    "@xcite moved beyond snapshots and coupled mcrt of ionizing radiation , including the diffuse radiation field , to a hydrodynamics solver .",
    "@xcite applied mcrt to neutrino transport in core - collapse supernova simulations , and introduced extensions to the implicit monte carlo technique to the case of velocity - dependent transfer case ( see section [ sec : implicitmc ] ) . @xcite and @xcite used mcrt to simulate the effects of compton cooling in black hole accretion , and coupled this to a hydrodynamics solver .",
    "@xcite presented a general - purpose code that couples mcrt with a godunov solver for hydrodynamics , and validated its performance in a suite of common rhd test problems .",
    "@xcite combined implicit monte carlo with discrete diffusion techniques in high velocity outflows on a lagrangian grid .    in this work ,",
    "we proceed in a manner similar to @xcite , and repeat some of the test problems contained therein .",
    "we keep our radiation equations exact to all orders in @xmath2 ( see sections [ sec : equations ] and [ sec : montecarlo ] ) , although our hydrodynamics equations remain non - relativistic . unlike previous studies of rhd using monte carlo , we include test problems in which the radiation energy is dominant over thermal energy , and where the radiation pressure is dynamically important .",
    "we compare two techniques that may be used to calculate the force from radiation pressure .",
    "our approach also makes use of the implicit monte carlo technique .",
    "we review here a basic formulation of radiation - hydrodynamics . for this",
    ", we rely heavily on the expositions in @xcite and @xcite , quoting directly many of the equations therein for ease of reference throughout the rest of this paper .",
    "the equations governing the fluid flow are the mass conservation equation , the gas momentum conservation equation and the gas total ( kinetic plus thermal ) energy conservation equation , with source terms relating to radiative transfer . to order @xmath2 , where @xmath3 is the fluid velocity and @xmath4 the speed of light , the equations are @xcite @xmath5    @xmath6    @xmath7 & + & \\frac{\\partial}{\\partial x^i } \\left\\ { \\left [ \\rho \\left(\\frac{1}{2 } v^2 + e_0 \\right ) + p_0 \\right ] v^i \\right\\ } \\nonumber \\\\ & = & \\rho v^i",
    "f^i + cg^0 \\ , \\ , .",
    "\\label{eq : energyconservation}\\end{aligned}\\ ] ]    we have used the einstein summation convention for indices , and the generic superscript index @xmath8 may refer to the @xmath9 , @xmath10 , or @xmath11 component of a vector in a cartesian coordinate system .",
    "the subscript @xmath12 denotes that quantities that are evaluated in the local comoving frame of the fluid .",
    "otherwise , the quantity is evaluated in the frame of the fixed coordinate system , which we refer to as the lab frame .",
    "thus , @xmath13 is the lab frame fluid density , @xmath14 is the comoving gas pressure , @xmath15 is the comoving gas specific internal energy ( units energy per mass ) , and @xmath16 is a body force such as gravity as measured in the lab frame .",
    "the quantities @xmath17 and @xmath18 are the lab frame components of the force four - vector , @xmath19 .",
    "this four - vector specifies the energy and momentum coupling between the fluid and the radiation , and will be defined explicitly below .",
    "an ideal gas equation of state relates the comoving pressure and specific internal energy of the gas @xmath20    we do not consider here the fully special relativistic fluid equations .",
    "however , in our treatment of the radiation transport we will be careful to include all special relativistic terms .",
    "we also have not included terms for viscous transport , thermal heat conduction , or an internal energy source terms such as would arise in a fluid undergoing nuclear reactions , although these can in principle be included as well @xcite .    to find the the radiation force four - vector @xmath19 ,",
    "we begin with the lab frame radiative transfer equation @xmath21 here @xmath22 is the specific intensity of the radiation , @xmath23 is the frequency , @xmath24 ( units @xmath25 ) is the total extinction coefficient , @xmath26 is the total radiative emissivity , and @xmath27 is a unit vector representing a direction",
    ". we may also make reference to the radiative source function @xmath28 . for notational brevity we will henceforth suppress writing the dependence of @xmath22 , @xmath24 and @xmath29 on direction @xmath27 , and keep in mind that @xmath22 , @xmath24 and @xmath29 are also be functions of position and time .",
    "both @xmath24 and @xmath29 have contributions from scattering as well as thermal absorption and re - emission , as we will discuss below .",
    "it is useful to define moments of the radiation intensity which correspond to radiative energy density , flux , and pressure @xmath30 @xmath31 @xmath32    equation [ eq : radiativetransfer ] may be integrated over frequency and solid angle to obtain the radiation energy equation @xmath33 this is a conservation equation for the radiation energy density .",
    "the integral represents an energy loss term for the radiation field , and hence an energy source term for the fluid , and can therefore be identified with @xmath34 .    integrating equation [ eq : radiativetransfer ] over frequency and then integrating with respect to @xmath35 results in the radiation momentum equation @xmath36   \\equiv -g^i \\ , \\ , .",
    "\\label{eq : gidefinition}\\ ] ] this is a conservation equation for the radiation momentum density , and the integral can be identified with the term @xmath37 .",
    "the problem has now been fully posed up to the specification of initial conditions and boundary conditions for the radiation and the fluid .    at this point",
    ", we will introduce some simplifying assumptions that will allow us to derive relatively simple expressions for the radiation four - force .",
    "these remain in effect for the entirety of this paper , although some or all of them could be relaxed in future work : ( 1 ) all absorption and emission , including scattering processes , are isotropic in the comoving frame .",
    "( 2 ) scattering in the comoving frame is elastic ( energetically coherent ) .",
    "( 3 ) the quantities @xmath26 and @xmath38 can be decomposed into separate thermal and scattering contributions @xmath39 we will sometimes refer to @xmath40 as the absorption coefficient .",
    "we will also find it useful to define an opacity is used for the extinction coefficient ( units @xmath25 ) rather than for an opacity ( units @xmath41 g@xmath42 ) . ]",
    "( units @xmath43 g@xmath42 ) as @xmath44 , and @xmath45 , @xmath46 .",
    "we define an opacity ratio @xmath47 the case @xmath48 corresponds to complete scattering of photons , without any thermal absorption or re - emission .",
    "the case @xmath49 corresponds to a situation with no scattering , in which every photon interaction corresponds to a photon being absorbed and its energy transferred to the gas .    for the thermal emission , we assume local thermodynamic equilibrium ( lte ) . in this case",
    "kirchoff s law implies that the thermal component of the emissivity , @xmath50 , is equal to @xmath51 , where @xmath52 is the planck function calculated using the gas temperature measured in the comoving frame .",
    "then we may write the total ( thermal plus scattering ) emissivity in the comoving frame as @xmath53 \\ , \\ , .\\end{aligned}\\ ] ] when this expression for @xmath54 is plugged into the comoving frame analogue of equation  [ eq : g0definition ] , the scattering out of the beam ( @xmath55 ) cancels the scattering into the beam ( @xmath56 ) , and the energy component of @xmath57 becomes @xmath58 meanwhile , the assumed isotropy of emitted radiation , both thermal and scattering , allows us to simplify the spatial components of the force four - vector , @xmath59 finally , we introduce three mean extinction coefficients ( energy - weighted mean , planck mean , and flux - weighted mean , respectively ) , @xmath60 the expressions for the components of @xmath57 then reduce to @xmath61 where @xmath62 erg @xmath63 kelvin@xmath64 is the radiation constant , which arises from the integration of the planck function over frequency .",
    "we may then use a lorentz transformation to determine the components of @xmath19 in the lab frame @xmath65 \\ , \\ , , \\\\ & g^i & = g_0^i + \\gamma \\frac{v^i}{c } \\left [ g_0 ^ 0 + \\frac{\\gamma}{\\gamma + 1}\\left(\\frac{v^j}{c}\\right)g_0^j \\right ] \\ , \\ , , \\label{eq : gisimplified}\\end{aligned}\\ ] ] where @xmath66 .",
    "equations [ eq : g0simplified ] and [ eq : gisimplified ] are accurate to all orders of @xmath67 @xcite .",
    "these two equations , along with the fluid equations ( [ eq : massconservation ] through [ eq : energyconservation ] ) , provide the high - level schematic for what our code solves .",
    "it is important to recognize that these are mixed - frame equations in the sense that the left - hand side refers to a lab frame quantity , while the right - hand side is written in terms of comoving quantities .",
    "we still must specify the expressions we will use to compute the comoving quantities @xmath68 and @xmath69 .",
    "one approach would be to first construct the radiation energy density , flux and pressure entirely in the lab frame , and then relate the lab and comoving values of these quantities using the fact that they are components of a second rank lorentz covariant tensor , the radiation stress - energy tensor .",
    "this approach is described in @xcite , and it is also the way to derive the equations used in @xcite and @xcite , which have been truncated at order @xmath70 . however , as will become clear below and in section [ sec : montecarlo ] , we are able to easily construct estimators of the flux in the comoving frame , and so we have a means of accurately calculating @xmath19 without needing to compute and store the components of the pressure tensor .",
    "we note that the radiation field , @xmath71 , is ultimately composed of photons with four - momenta given by @xmath72 . the lab frame and comoving frame components of the four - momentum",
    "are related via a lorentz transformation @xmath73 and @xmath74 \\ , \\ , .",
    "\\label{eq : dtrans}\\ ] ] these equations incorporate the relevant doppler shift and aberration effects .",
    "two final transformations we will need are @xcite @xmath75 @xmath76    then we may write the comoving radiation energy density and flux as @xmath77 @xmath78    equations [ eq : comovingenergy ] and [ eq : comovingflux ] provide us with a means of computing @xmath68 and @xmath79 , accurate to all orders in @xmath2 , in terms of integrals of lab frame quantities ( with the help of equations [ eq : energydoppler ] and [ eq : dtrans ] ) .",
    "it is straightforward to show that these equations are equivalent to those that follow from the lorentz covariance of the stress - energy tensor @xcite .",
    "finally , we consider an approximate alternative to equation [ eq : gisimplified ] that is valid in the raditaive diffusion regime .",
    "consider once again the convservation of radiation momentum as expressed in equation [ eq : gidefinition ] .",
    "as noted in @xcite , when the radiation is diffusing , the time - derivative on the left - hand side of that equation is at most on the order @xmath80 compared to the radiation force term on the right - hand side of the equation , where @xmath81 is the photon mean free path and @xmath82 is the fluid flow length scale . since @xmath83 by definition in the radiative diffusion regime , this term can be safely dropped , leaving us with @xmath84 where in the second line we have introduced the eddington tensor @xmath85 which satisfies @xmath86 in some situations , using equation [ eq : pressuredivergence ] for @xmath18 may reduce the monte carlo sampling noise ( see section [ sec : radiationforcecomparsion ] ) .",
    "to make use of equations [ eq : comovingenergy ] and either [ eq : comovingflux ] or [ eq : pressuredivergence ] , we still must solve the radiation transfer equation for @xmath87 . in the mcrt approach",
    ", one forgoes a direct numerical solution in favor of a stochastic simulation of photon transport . the radiation field",
    "is represented by discrete packets which are tracked through randomized scatterings and absorptions .",
    "each packet is described by a lab frame energy @xmath88 and a lab frame photon momentum four - vector @xmath89 where @xmath23 is the photon frequency and * n * the normalized propagation direction vector measured in the lab frame . the number of photons represented per packet is then @xmath90 .    in many cases ,",
    "we initialize the radiation field based on the assumption of local thermodynamic equilibrium ( lte ) .",
    "this assumption is justified in most test problems we consider here , as the gas is optically thick to radiation across each zone . at the start of the calculation ,",
    "a set number of packets , @xmath91 , are initiated in each zone .",
    "the radiation energy @xmath92 is distributed equally among the packets in each zone .",
    "the packet comoving frequencies are sampled from a blackbody distribution at the local temperature and their directions are sampled isotropically in the comoving frame .    if necessary , it is possible to initialize photon packets without assuming lte , as we will discuss for two test problems ( section [ sec : radeqtest ] and section [ sec : bondi ] ) .",
    "photon packets are tracked in the lab frame , but the gas extinction coefficients and emissivities are calculated in the comoving frame . the extinction coefficient in the comoving frame @xmath93 is then transformed into the lab frame using @xcite @xmath94 while we have assumed that the comoving extinction is isotropic , in moving flows the lab frame extinction @xmath24 is direction dependent ( because of equations [ eq : extinctiontransform ] and [ eq : energydoppler ] ) .",
    "the mean free path is longer for photons propagating along the flow and smaller for photons propagating against it , a property that is essential to include to get the correct advection of radiation ( see section [ sec : advectedpulse ] ) .",
    "the distance @xmath95 a photon travels in the lab frame before an interaction can be randomly sampled using @xmath96 \\ , \\",
    ", , \\ ] ] where @xmath97 is a uniform random number between 0 and 1 , not including 0 .",
    "this distance can be compared to the distance to the nearest cell boundary and the distance to the end of the time - step ( @xmath98 ) to determine the next event . in an interaction event",
    ", a packet may be either scattered or absorbed , with the probability of absorption at a given frequency denoted by @xmath99 .",
    "more details about how photon interactions are implemented are given in section [ sec : interaction ]    at each time - step , new packets may be generated to represent freshly radiated thermal energy .",
    "the emission of this energy provides the cooling contribution in equation [ eq : comovingg0 ] .",
    "the number of photon packets emitted in a zone over a lab frame time - step @xmath100 is @xmath101 this expression will be modified slightly when implicit mcrt techniques are employed ( section  [ sec : implicitmc ] ) . here",
    "@xmath102 is the zone volume measured in the lab frame .",
    "we have made use of the fact that @xmath103 @xcite , so to lowest order we may write @xmath104 .",
    "@xmath105 is the energy ( not energy density ) of each packet in the comoving frame .",
    "the value of @xmath105 can be chosen arbitrarily and ultimately sets the total number of packets included in a calculation .",
    "typically , we choose the packet energy to be a small fraction of the zone energy , @xmath106 , however we limit the number of packets emitted per zone per time - step to a manageable maximum value ( see table  [ tab : numericalparameters ] ) .",
    "the emitted packet s direction is sampled uniformly from an isotropic distribution in the comoving frame .",
    "the frequency of the packet is sampled from a distribution weighted by the comoving thermal emissivity , @xmath107 .",
    "the packet energy , frequency and direction are then transformed into the lab frame using equations [ eq : energydoppler ] and [ eq : dtrans ] .",
    "radiative heating could , in principle , be evaluated by tallying the number of photon packets absorbed in each zone over a time interval . in",
    "any given time - step , however , the number of packets actually absorbed may be very small , especially if the medium is scattering dominated ( @xmath108 ) .",
    "instead , we can construct estimators in each cell of the comoving radiation energy density and radiation flux ( equations [ eq : comovingenergy ] and [ eq : comovingflux ] ) by summing over all path lengths of packets moving through the zone @xcite @xmath109 where @xmath110 is the lab frame energy of packet @xmath111 , @xmath112 is the length of the path the packet travels through the zone ( which may be composed of multiple redirections ) , and we are again substituting @xmath113 for @xmath114 .",
    "the flux estimator relies on the cancellation of packets moving in opposite directions , so it may be poorly sampled in practical calculations .",
    "as noted in section [ sec : equations ] , when the radiation is diffusing we may use the divergence of the lab - frame radiation pressure tensor to compute @xmath18 ( equation [ eq : pressuredivergence ] ) . in this case , @xmath115 is computed with the estimator @xmath116      one advantage of mc transport methods is that it is relatively straightforward to simulate complicated physical interactions , such as anisotropic scattering , line transport , or polarization . in this section ,",
    "we describe the treatment of select matter / radiation interactions .      in the simplest of interaction events , a packet may be either coherently scattered or absorbed , with the probability of absorption at a given frequency , @xmath117 , determined by the nature of the absorption interaction . in an explicit mc calculation ,",
    "absorbed packets are simply removed from the calculation . in implicit mc calculations ,",
    "some absorbed packets are not removed but instead undergo `` effective scattering '' , as will be described in section  [ sec : implicitmc ] .    to simulate an isotropic , coherent scattering event ,",
    "a packet is first lorentz transformed to the comoving frame of the scatterer using [ eq : energydoppler ] and [ eq : dtrans ] . a new direction",
    "is then sampled isotropically in the comoving frame , and the inverse transformation is applied to return the lab frame . in this process , the lab frame energy of the photon becomes @xmath118 where @xmath119 and @xmath120 are the incoming and outgoing packet direction vectors in the lab frame .",
    "the packet frequency changes in a corresponding way . when averaged over many scattering events , eq .",
    "[ eq : escatter ] accounts for the adiabatic losses of the radiation field .",
    "advection is captured via the anisotropy of the lab frame extinction coefficient @xmath38 and the outgoing direction vector @xmath120 .",
    "if desired , one can also take into account the random motions of scatterers , which may introduce additional doppler shifts . in this case",
    ", the velocity vector of the individual scatterer must be randomly sampled at each interaction event .",
    "for example , the speed of a scatter could be randomly sampled from a maxwell boltzmann distribution with velocity dispersion @xmath121 , where @xmath122 is the mass of the scatterer .",
    "the direction of the scatterer velocity vector is sampled from an isotropic distribution .",
    "the photon packet is then lorentz transformed into the rest frame of the scatterer , a new propagation direction is chosen , and then the packet transformed back into the lab frame .",
    "the frequency - dependent cross - section of a line with rest frequency @xmath123 and oscillator strength @xmath124 is @xmath125 where @xmath9 is the frequency relative to line center in units of doppler widths @xmath126 , where @xmath127 and we take the velocity dispersion @xmath128 to be due to thermal line broadening .",
    "the line profile is described by the voigt function @xmath129 the parameter @xmath130 describes the importance of the wings relative to the core of the line profile , and is a function of temperature @xmath131 we use the analytic fits for the voigt profile provided by @xcite .",
    "the line absorption coefficient , @xmath132 , depends on the the number density , @xmath133 , of ions occupying the lower level of the transition , and hence requires knowledge of the ionization and excitation state of the gas . in the case of lte , the state of the gas is readily determined by solving the saha / boltzmann equations .",
    "when lte does not hold , the level populations must be determined by solving a set of coupled rate equations , with the radiative transition rates estimated from the monte carlo transport .",
    "we postpone a discussion of the non - lte problem , and assume here that the level population @xmath133 is known .    to account for the thermal motions of ions , we randomly sample the ion velocities in a manner similar to that described in section  [ sec : scatter",
    "] . however , since the line cross - section depends sensitively on frequency , the line - of - sight velocity @xmath134 must be sampled from the modified distribution @xcite @xmath135 where @xmath136 .",
    "the transverse velocity components are sampled from the ordinary maxwell - boltzmann distribution @xmath137 where @xmath138 and @xmath139 are independently generated uninform random variables between 0 and 1 , not including 0 .",
    "@xmath138 sets the magnitude of the transverse velocity of the ion , and @xmath139 sets its direction in the transverse velocity plane .",
    "packets can either be absorbed or scattered in a line , in the way described in section  [ sec : scatter ] .",
    "if desired , a treatment of fluorescence can also be included by randomly sampling the branching probability of de - excitation into all possible line transitions @xcite .",
    "we will not discuss such a treatment here .",
    "our primary method for solving the hydrodynamics equations is a second - order godunov scheme based on the ppm solver of @xcite .",
    "while this paper only presents results based on the one - dimensional version of this solver , we intend to extend it to higher spatial dimensions in a spatially unsplit manner following the description in @xcite .    for 1-d spherically symmetric problems",
    ", we use a lagrangian hydrodynamics solver because it allows for adaptive grid resolution .",
    "this solver is based on the von neumann - richtmyer staggered mesh scheme as described in @xcite .    as is well known , the inclusion of artificial viscosity is useful to damp numerical oscillations behind strong shocks , but has the negative effect of smearing out the shock front over a number of zones determined by a constant @xmath140 , an adjustable parameter ( see table  [ tab : numericalparameters ] ) . for the lagrangian solver we can include a standard artificial viscosity of the form @xmath141 where @xmath142 and @xmath143 are the lower and upper zone velocities of the lagrangian mass element . for the godunov solver ,",
    "the artificial viscosity is quite similar , although it involves modifying the numerical fluxes in the manner described in @xcite .",
    "we find that including artificial viscosity is helpful both in our lagrangian solver and our godunov solver , although for problems with strong shocks we can typically obtain similar results with a smaller value of @xmath140 in the godunov case than in the lagrangian case .",
    "we use an operator - splitting procedure for coupling the radiation source terms to the hydrodynamics equations in a way similar to that of @xcite .",
    "every time - step , we first perform the packet propagation through the fluid to construct the comoving frame estimators defined in equations [ eq : comovingenergyestimator ] and [ eq : comovingfluxestimator ] . for the eulerian version of the code , we use these estimators to construct the components of @xmath19 in the lab frame , as given by equations [ eq : g0simplified ] and [ eq : gisimplified ] .",
    "we next use our godunov solver to calculate the updates to the hydrodynamical state variables that would have occurred in the absence of radiation .",
    "finally , we use our computed components of @xmath19 to evaluate the right - hand sides of equations [ eq : momentumconservation ] and [ eq : energyconservation ] .",
    "these source terms indicate the _ rate _ at which momentum and energy are transferred per time per zone , so we multiply these rates by @xmath144 to compute the radiation contribution to energy and momentum for that time - step . in other words ,",
    "our treatment of the radiative source terms is first order in time .    in the lagrangian version of the code ,",
    "we use a similar first - order approach to include the radiative source terms , but in this case we use the comoving quantity @xmath145 for the rate of radiative heating or cooling .",
    "we multiply this rate by @xmath144 and add the result to the internal energy of the gas in each zone . for the radiative momentum contribution we use use the radial component of the radiative force .",
    "we multiply this force by @xmath144 and add this contribution to the total force that accelerates each zone boundary .",
    "future work might include the developments described in @xcite , @xcite , and @xcite for including stiff radiative source terms more consistently within the godunov solver .",
    "indeed , once we have used mcrt to construct the radiation energy density , flux , and eddington tensor , then the manner in which this information is incorporated into the godunov solver could proceed in a manner identical that described in @xcite .",
    "on the fluid flow time scale , the monte carlo simulation always provides a stable and accurate representation of the radiation field regardless of the time - stepping . however , an explicit treatment of the matter - radiation coupling will be unstable unless the time - steps are smaller than the time scale for radiative heating / cooling to significantly change the gas energy , given by @xmath146 under certain conditions , in particular cases where the radiation energy exceeds that of matter , @xmath147 may be much smaller than the courant time - step . to avoid excessively small time - steps",
    "while maintaining stability , we implement the implicit monte carlo ( imc ) methods first developed by @xcite ( see also @xcite ) . in this case one",
    "defines the fleck factor @xmath148 where @xmath149 is a nondimensional parameter that can be given a value between 0.5 and 1 in order to ensure stability .",
    "the second term in the denominator can be thought of intuitively as the ratio of @xmath100 to @xmath147 ( up to order unity factors ) .",
    "the fleck factor has several important roles .",
    "first , it is used to define an `` effective scattering '' rate .",
    "the true absorption fraction @xmath99 is multiplied by @xmath150 to determine a new probability that a photon interaction is treated by the code as an absorption event , rather than a scattering event .",
    "when @xmath151 ( i.e. the hydro time - step is much larger than @xmath147 ) , then nearly all photon interactions are ffective scatttering interactions .",
    "conversely , if @xmath152 then the fleck factor factor has little effect on the course of the simulation , and the probability of an absorption event remains approximately equal to @xmath99 .",
    "second , the amount of thermal energy radiated each time step is also multiplied by @xmath150 .",
    "this affects the second term in our calculation of @xmath153 in equation [ eq : comovingg0 ] , and the number of packets emitted each time step as given by equation [ eq : packetsemitted ] .",
    "finally , the fleck factor is used to modify the process of adiabatic heating and cooling of the gas .",
    "following @xcite , we will define an adiabatic heating term @xmath154 : @xmath155 this expresses the rate at which gas kinetic energy is converted into internal energy ( or vice versa ) , and accounts for artificial viscosity . if desired , other heating source terms , such as energy released from nuclear reactions , could be added here .",
    "this rate @xmath154 will also be multiplied by @xmath150 , which amounts to subtracting @xmath156 from the gas heating rate . in order to conserve energy , this same amount of energy per time step",
    "must then be added to the radiation field ( which could amount to a negative contribution if @xmath154 is negative ) .    in detail , for the eulerian version of the code , we use the results of our godunov scheme to construct the quantities @xmath157 and @xmath158 , which are in turn used to consruct @xmath154 .",
    "we subtract @xmath159 from the total energy density update of the hydro state vector . during the subsequent radiative transfer step ,",
    "we add this contribution to the emission terms in equations [ eq : comovingg0 ] and [ eq : packetsemitted ] .    in the lagrangian version of the code , when it is time to update the internal energy density of the fluid , we use @xmath160 for the amount of adiabatic heating or cooling , rather than the full @xmath154 that we would use in the absence of implict monte carlo . the emission in the next radiative transfer step",
    "is modified in the same manner as in the eulerian case .",
    "we have carried out a number of tests calculations to verify our code in a variety of physical situations .",
    "first , we compare our mcrt implementation against analytic treatments of plane - parallel , semi - infinite , stratified , static atmospheres with frequency - dependent photon opacities .",
    "we follow the traditional convention of setting @xmath161 at the observer s location at infinity , so that @xmath162 increases deeper into the atmosphere , along the @xmath11-axis of our coordinate system .",
    "since the gas has zero bulk velocity in this test , we make no distinction between lab frame and comoving frame quantities for the rest of this subsection .",
    "if , in addition to the assumptions listed in the previous paragraph , the source function is istropic , scattering is absent , and the temperature profile of the atmosphere is known , then the first three moments of the radiation intensity can be found exactly in terms of exponential integrals ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "here we follow @xcite in writing the expressions for these moments as @xmath163 where @xmath164",
    "we next consider including a frequency - independent scattering extinction @xmath165 , meant to represent electron scattering , in addition to the frequency - dependent absorption coefficient @xmath166 .",
    "when scattering is included , an exact solution for the moments of the radiation intensity is rarely possible , although excellent approximate solutions can be derived , as we will now show .",
    "it is conventional to introduce @xmath167 , @xmath168 and @xmath169 .",
    "if all radiative cross sections are assumed to be isotropic , then the lowest two moment equations of the steady - state , plane - parallel transfer equation can be written @xmath170    if we employ the eddington approximation , @xmath171 , then the last two equations may be combined to yield ( e.g. * ? ? ?",
    "* ) @xmath172 this is a linear , inhomogeneous ordinary differential equation for @xmath173 . as such , it may be solved via the method of variation of parameters .",
    "@xcite present such a solution for the case when @xmath174 corresponds to _ bremsstrahlung _ , so that it depends on both the density and temperature of the atmosphere at each depth . here",
    ", we consider a slightly simpler situation in which @xmath99 is independent of depth .",
    "to specify the boundary conditions , we assume that @xmath175 approaches some finite value @xmath176 as @xmath177 , and that @xmath178 where @xmath179 is some constant value used to normalize the outgoing flux . if the two - stream approximation were to hold exactly as @xmath180 , then @xmath179 would equal @xmath181 @xcite .    in that case ,",
    "the solution for @xmath173 becomes , rather than cutting off the solution at @xmath182 .",
    "additionally , we have not made the approximation @xmath183 . ]",
    "@xmath184 \\ , \\ , .\\end{aligned}\\ ] ]    the emergent flux can then be computed as @xmath185    since the eddington approximation was used to derive equation [ eq : fluxeddington ] , taking its limit as @xmath186 ( i.e. , in the limit of no scattering ) does not recover equation [ eq : f2flux ] evaluated at @xmath187 . however ,",
    "if we consider equation [ eq : f2flux ] under the the two - stream approximation so that @xmath188 is fixed at @xmath189 in equation [ eq : exponentialintegral ] , and @xmath190 , then we do indeed recover the @xmath186 limit of equation [ eq : fluxeddington ] .    to gain insight into equation [ eq : fluxeddington ]",
    ", we consider the thermalization depth @xmath191 this is the average depth that a freshly emitted photon with frequency @xmath23 will travel via scattering before being reabsorbed . the heuristic derivation ( following @xcite ) for equation [ eq : thermalizationdepth ] is as follows . during each scattering event ,",
    "the probability that the photon is absorbed is @xmath99 , by definition .",
    "thus , an emitted photon will scatter an average of @xmath192 times before being reabsorbed . meanwhile , for any random - walk process , the mean displacement of a packet that has undergone @xmath193 re - directions , each of mean free path @xmath82 , is approximately @xmath194 .",
    "consequently , the average distance between emission and absorption events is @xmath195 .",
    "converting this distance to an optical depth gives us our result .",
    "a factor of @xmath181 in front of @xmath99 can account for the average angle with respect to the @xmath11-axis along which the photons travel in the eddington approximation",
    ".    we do not expect escaping photons to have been emitted at temperatures corresponding to optical depth much greater than the thermalization depth .",
    "in other words , frequencies with large thermalization depths allow us to see such photons that were emitted from deeper , hotter portions of the atmosphere .",
    "we ran three test calculations , each with a different degree of scattering , to test the code against these solutions . in all three cases",
    ", we used a domain of total height @xmath196  cm .",
    "for the first two tests we divided the domain into 128 zones of equal height , and for the final test we used 256 zones .",
    "the domain was filled with gas following a power - law density profile @xmath197^{-1 } \\ , \\ , , \\ ] ] where we have chosen @xmath198  g  @xmath63 ( yielding an optical depth to electron scattering of 100 , where the electron scattering opacity is 0.4 @xmath43 g@xmath42 for fully ionized hydrogen ) , @xmath199  cm , and @xmath200 .",
    "photons were emitted from the @xmath201 plane and propagate toward the @xmath202 plane , where they are tallied to generate an outgoing spectral energy distribution ( sed ) .",
    "any photons that scattered back past the @xmath201 plane were treated as absorbed by the luminous source and were no longer tracked .",
    "we adjusted the photon flux from the inner emitting surface ( at @xmath203 ) so that the bolometric , steady - state radiative flux escaping to infinity would equal a constant value of @xmath204 erg s@xmath42 @xmath41 in all three calculations .",
    "we chose a normalization for @xmath166 so that it would match the electron scattering extinction at 100 angstroms .",
    "we also let @xmath166 scale as @xmath205 .",
    "our wavelength resolution was set by dividing the interval between 1 and @xmath206 angstroms into 100 bins equally spaced logarithmically .",
    "anticipating that the densities and temperatures in these calculations would correspond to cooling times that were orders of magnitude shorter than the radiative diffusion time through the computational domain , we used a fully implicit treatment of the radiative heating and cooling .",
    "absorption events were always treated as effectively scattered , and we periodically re - computed the temperature of the gas in each zone by enforcing radiative equilibrium until a steady state was reached .",
    "figure [ fig : sedabsorptionandscattering ] shows the outgoing sed for three test cases . in the first case , shown in the top panel , we used only the absorption coefficient @xmath166 , and neglected scattering entirely .",
    "this allowed us to solve for the outgoing flux by invoking equation [ eq : e2flux ] at @xmath187 for all @xmath23 .",
    "the match between the analytic formula and the monte carlo results is excellent .    in the second case , shown in the middle panel of figure [ fig : sedabsorptionandscattering ] ,",
    "we add thomson scattering but we keep all other details of the simulation the same as before .",
    "given our functional form for @xmath166 described above , @xmath99 ranges from @xmath207 at 1 angstrom to 0.9 at @xmath208 angstroms .",
    "as shown in figure [ fig : staticatmospheretempvsradius ] , the inclusion of scattering along with absorption , while forcing the escaping flux to be the same , leads to higher temperatures in all regions of the atmosphere .",
    "remarkably , this temperature adjustment occurs in such a way as to keep the shape of the outgoing sed nearly identical to the case without scattering ( compare the first and second panels of figure [ fig : sedabsorptionandscattering ] ) .",
    "the eddington approximation prediction for the shape of the sed ( equation [ eq : fluxeddington ] ) still matches the computed sed quite well .    finally , the bottom panel of figure [ fig : sedabsorptionandscattering ] shows the results of another test that includes both absorption and scattering , but this time the absorption opacity is reduced to a value of 0.01 times the value we had used previously .",
    "now @xmath99 ranges from @xmath209 at 1 angstrom to 0.09 at @xmath208 angstroms . in this case",
    "there is a slight drop in temperature compared to the previous case at all depths in the atmosphere , as seen in figure [ fig : staticatmospheretempvsradius ] . however , this time the sed shifts markedly in the blueward direction , which is evident in the bottom panel of figure [ fig : sedabsorptionandscattering ]",
    "this can be understood in terms of the thermalization length described earlier . as the atmosphere becomes increasingly scattering dominated , the photons that escape to the observer tend to have been emitted at higher thomson optical depth , where the temperature is higher .",
    "again , agreement with the analytic formula is very good , verifying the mcrt calculation of multi - frequency transport in a scattering dominated regime .        .",
    "although the temperatures are noticeably different between all three runs , the outgoing flux has been adjusted to be the same in all three cases.,scaledwidth=50.0% ]       test of line transport in a static medium , comparing monte carlo results ( circles ) to an analytic solution based on the diffusion approximation ( equation  [ eq : static_line ] , solid lines ) . in this problem , a point source radiates line photons into a uniform spherical medium with a pure - scattering optical depth at line center of @xmath210 ( red ) , @xmath211 ( black ) and @xmath212 ( blue ) .",
    ", scaledwidth=50.0% ]    .",
    "results from the monte carlo ( circles ) are compared to the semi - analytic solution based on the sobolev approximation ( equation  [ eq : moving_line ] ) .",
    "[ fig : moving_line],scaledwidth=50.0% ]    we next test the transport of line radiation in both moving and static media .",
    "we use the spherical lagrangian version of the code and inject photons into a uniform density sphere of radius @xmath213  cm .",
    "the thermal motions of ions are taken into account , with a velocity dispersion of @xmath214 .",
    "the line opacity is taken to be pure - scattering , and for computational expediency we adopt a large voigt parameter of @xmath215 ( see equation [ eq : voigtparameter ] ) .    in the first test",
    ", we consider a static atmosphere with a total radial optical depth at line center of @xmath216 .",
    "photons are injected at the center of the sphere and at the line center rest frame frequency @xmath217 .",
    "an analytic solution to the line scattering problem in the plane parallel case was derived by @xcite under the eddington approximation , and generalized to a spherical atmosphere by @xcite , who find a total flux density at the surface of the sphere @xmath218 } \\biggr ] \\label{eq : static_line}\\ ] ] in figure  [ fig : static_line ] we show results of the mc transport for spheres of optical depth @xmath210 and @xmath219 .",
    "the resulting line features show a characteristic double peaked profile .",
    "this is because photons are doppler shifted by the thermal motions of the scatterers , and preferentially escape in the less opaque line wings .",
    "our mc results show favorable agreement with the analytic solution equation  [ eq : static_line ] , comparable to those seen in other mcrt line transport codes @xcite .",
    "to test line transport in a moving atmosphere , we consider the case where the sphere of gas is expanding homologously ( i.e. , velocity proportional to radius ) . we emit photon packets from the surface of a spherical inner boundary of uniform specific intensity @xmath220 in the lab frame at a radius @xmath221  cm .",
    "the velocity structure is given by @xmath222 , with @xmath223 .",
    "because the velocity scale height of this problem is much greater than the ion thermal velocities , the sobolev approximation applies . the emergent line profile in the lab frame is then given by an integral over the impact parameter @xmath111 , ( e.g. , * ?",
    "* ) @xmath224 pdp \\label{eq : moving_line}\\ ] ] where the sobolev optical depth is @xmath225 in the present example the velocity gradient is @xmath226 .",
    "the source function for a pure - scattering line is equal to the mean intensity of the radiation field , @xmath227 where the dilution factor is @xmath228 \\ , \\ , .\\ ] ] as discussed in @xcite , to properly treat the boundary condition of the photosphere , @xmath229 and @xmath230 are zero for the spatial region inside and behind the photosphere , while @xmath231 is zero for @xmath232 .",
    "figure  [ fig : moving_line ] shows results for a constant density atmosphere with @xmath233 .",
    "the spectrum of the mcrt code , which resolves the line profile , is in good agreement with the sobolev semi - analytic solution .",
    "we next discuss test problems in which the energy and momentum coupling of the gas and radiation is considered . in what follows ,",
    "we define the radiation temperature as @xmath234 , where @xmath68 is the comoving radiation energy density .",
    "we use an ideal gas equation of state with @xmath235 .",
    "table [ tab : numericalparameters ] lists the numerical parameters used in each radiation - hydrodynamics test problem .",
    "ccccccccc radiative equilibrium & 2 & @xmath236 & @xmath237 s & @xmath238 & 0 . & 0 .",
    "& 1 & 0 + ( no imc ) & & & & & & & & +   + radiative equilibrium & 2 & @xmath236 & @xmath239 s & @xmath238 & 0.5 or & 0 . & 1 & 0 + ( imc ) & & & & & 1.0 & & & +   + advected pulse & 201 & 0.00995 & @xmath240 s & @xmath241 & n / a & 0 . & @xmath242 & 0 + & & & & & & & ( center zone only ) & +   + homologous expansion & 64 & variable & cfl 0.2 & @xmath243 & n / a & 0 .",
    "& 10 & 0 +   + bondi accretion & 2048 & variable & cfl 0.2 & @xmath244 & 1.0 & 0 .",
    "& 10 & 40 + & & & & & & & & ( from source only ) +   + @xmath245 steady shock & 512 & @xmath246 & cfl 0.5 & @xmath247 & 1.0 & 0.1 & 10 & 400 +   + @xmath248 steady shock & 2048 & @xmath249 & cfl 0.5 & @xmath250 & 1.0 & 0.1 & 10 & 100 +   + @xmath251 steady shock & 896 & @xmath252 & cfl 0.1 & @xmath247 & 1.0 & 0.1 & 7680 & 7680 +   + sub - critical & 512 & @xmath253 & cfl 0.5 & @xmath254 & 0 . & 0.5 & 1000 & 4000 + moving shock ( ensman ) & & & & & & & & +   + super - critical & 512 & @xmath253 & cfl 0.2 & @xmath255 & 1.0 & 0.5 & 1000 & 1000 + moving shock ( ensman ) & & & & & & & & +   + [ tab : numericalparameters ]      we begin with a standard test of the heating and cooling of the gas by radiation , which also provides clear a demonstration of the application of implicit mc techniques .",
    "we chose here a setup identical to that of @xcite , although modified versions of the test have appeared elsewhere , including @xcite .    in this test",
    "we use the eulerian version of the hydro solver .",
    "we again consider gas with zero bulk velocity , so that the lab frame and the comoving frame are identical , although we retain the comoving frame notation . the computational domain is filled with static gas at a uniform density of @xmath256 g @xmath63 , a mean atomic mass of @xmath257 , and a gray opacity @xmath258 @xmath259 g@xmath42 .",
    "additionally , a uniform and isotropic radiation field is initialized with energy density @xmath260 erg @xmath63 , so that @xmath261 k. here @xmath262 , so that the gas and radiation are fully thermally coupled .",
    "although the radiation pressure overwhelms the gas pressure in this test , the radiation field is isotropic , so the radiation pressure does not accelerate the gas . reflecting boundary conditions were used for the radiation .    in this context",
    ", the gas energy equation ( equation  [ eq : energyconservation ] ) simplifies to @xmath263 where @xmath264 is the frequency - integrated planck function @xcite .",
    "we consider two versions of the test , one in which the gas is heated by radiation , and another in which the gas cools .",
    "for the heating case , the gas is given an initial thermal energy density of @xmath265 erg @xmath63 , corresponding to @xmath266 k. for the cooling case , the initial thermal energy density is @xmath267 erg @xmath63 , corresponding to @xmath268 kelvin . in both cases ,",
    "the radiation energy greatly exceeds the gas energy density , and so remains nearly constant during the energy exchange .",
    "this means that the gas will ultimately heat or cool to reach the radiation temperature , corresponding to an equilibrium gas energy density of @xmath269 erg @xmath63 .",
    "this test only follows the evolution of the gas up to an elapsed time of @xmath270 s , whereas the photon interaction time @xmath271 is approximately @xmath272 s. in the absence of explicit photon interactions , the energy exchange between gas and radiation is deterministic , and so the number of photon packets employed has no effect on the solution .",
    "figure  [ fig : radeq ] displays the gas heating and cooling curves compared to the analytic solution of equation  [ eq : radeq ] . consider the cooling curve first . according to equation [ eq : coolingtime",
    "] , the cooling time at the beginning of the simulation is @xmath273 s. if we take a time - step smaller than this , such as @xmath274 seconds , then no implicit methods are needed , and the gas temperature follows the analytic cooling curve to an accuracy of better than 1.3% at all times .",
    "if we wish to take much larger time - steps , then we must turn on the implicit monte carlo by setting @xmath275 , otherwise the code generates negative temperatures and crashes after the first step of the calculation .",
    "figure  [ fig : radeq ] shows the results of taking @xmath276 and @xmath277 for @xmath278 s. in both cases , the cooling curves approach the analytic solution after many time - steps , but the cooling is artificially slow at early times .",
    "the @xmath276 case converges to the correct solution more quickly than the @xmath277 case , demonstrating that one should strive for the smallest value of @xmath149 that still maintains stability .",
    "the heating curves follow the analytic solution to within one part in @xmath209 at all times , regardless of the value of @xmath149 chosen or the size of the time - step up to @xmath279 that we tested , although larger time - steps could be used for the heating case .      in a moving , optically thick medium , radiation",
    "should be swept along with the matter .",
    "this represents an important and non - trivial test of the mcrt routine , as advection is not explicitly included in the code . instead",
    ", advection is a statistical consequence of the lab frame anisotropy of the lab frame extinction coefficient and scattering function .",
    "when averaged over many scatters , these effects preferentially guide packets upstream .",
    "our test is similar to the radiation diffusion tests presented in @xcite and @xcite , but with the added effect of advection .",
    "we use the eulerian version of the code , and consider a homogeneous gas distribution from @xmath280 cm to @xmath281  cm . the gas is pure - scattering ( @xmath282 ) with @xmath283 , and is given a uniform lab frame velocity of @xmath284 cm s@xmath42 . the scattering opacity is taken to be @xmath285 @xmath43 g@xmath42 , which gives an optical depth across each zone equal to @xmath286 in the comoving frame .",
    "the radiation is initialized isotropically in the comoving frame of the central zone only , with a comoving energy density of @xmath267 erg @xmath63 .",
    "since the gas and radiation are thermally decoupled in this test , and we are primarily interested in the advection and diffusion of the radiation energy , the value chosen for the gas temperature is arbitrary .",
    "however , a lower temperature results in a higher mach number . in the test corresponding to figure [ fig : advectingpulse ] ( discussed below ) , we chose to set the gas temperature to @xmath206 , corresponding to an isothermal mach number of roughly 1560 . in this case , we found it necessary to include a floor for the gas energy to prevent it from dropping below zero",
    ". radiation is allowed to escape through either side of the domain , and periodic boundary conditions are employed for the hydrodynamics solver .",
    "cm , so the fluid is highly optically thick to the radiation and sweeps the radiative energy along with it .",
    "the analytic solution is given by the advection - diffusion equation , and the bottom panel shows the absolute error in the computed radiative energy density as compared to the analytic solution .",
    "the numerical parameters used in this test are specified in table  [ tab : numericalparameters].,scaledwidth=50.0% ]    as discussed in @xcite and @xcite , the evolution of the radiation energy can be solved for analytically in the diffusion approximation .",
    "figure  [ fig : advectingpulse ] compares our computed radiation temperature to this solution at various times .",
    "one sees that the radiation pulse moves along with the gas at the expected velocity .",
    "we confirmed that _ both _ the transformation of the extinction coefficient ( equation  [ eq : extinctiontransform ] ) and the effect of aberration ( equation  [ eq : dtrans ] ) must be included to reproduce the proper advection velocity .",
    "thus , even in problems with velocities @xmath287 , a special relativistic mc treatment is desirable to recover the proper advection behavior .",
    "we next consider a problem designed to test whether the code properly handles radiation energy losses due to expansion .",
    "this is also a non - trivial test of the mcrt routine , as no explicit term for radiation @xmath288 work is included in the code . instead , the change in the radiation energy density is a statistical result of the multiple doppler shifts photon packets incur as they scatter anisotropically off of moving gas .",
    "we consider a spherical gas cloud undergoing homologous expansion ( i.e. , velocity proportional to radius ) and opaque enough that photons do not diffuse significantly , but are rather advected along with the flow .",
    "such an adiabatically expanding flow cools as @xmath289 , with @xmath290 .",
    "we assume the medium is pure - scattering ( @xmath282 ) , so that the radiation and gas are thermally decoupled .",
    "hence the gas ( @xmath235 ) should evolve as @xmath291 while the radiation ( @xmath292 ) should evolve separately as @xmath293 .",
    "for this test , we use the lagrangian version of the hydro solver .",
    "the outer edge of the computational domain expands homologously as @xmath294 , where @xmath295 is the time elapsed .",
    "we take @xmath296  cm and @xmath297 .",
    "the gas is initially uniform with a temperature of @xmath206  k , a density of @xmath298 g @xmath63 , @xmath283 , and @xmath258 @xmath43 g@xmath42 . reflecting boundary conditions at @xmath299 are used for the radiation . to compute the fluid pressure gradient at the outer boundary we linearly extrpolate the pressure from the outermost two zones to evaluate the pressure beyond the outermost radial zone , although the gas pressure does not play an important role in this test .",
    ".,scaledwidth=50.0% ]    figure  [ fig : homologousexpansion ] displays the spatially - averaged gas and radiation temperatures as a function of @xmath299 ( each zone was given equal weight in the average ) .",
    "the code recovers the expected adiabatic loses of the gas and radiation field .",
    "we ran two versions of this test , one in which the gas velocity was taken to be piece - wise constant in each zone , and the other in which the gas velocity was linearly interpolated within each zone .    as is evident in the figure ,",
    "the evolution of the radiation temperature is more accurately computed for the case in which velocity interpolation was used , indicating that an adequate resolution of the gas velocity field is necessary properly calculate the radiation @xmath288 work .",
    "the classic bondi problem of steady - state , spherically symmetric gravitational accretion @xcite provides an opportunity for us to test the effect of radiation force in the optically thin limit .",
    "our treatment of the problem closely follows that of @xcite . for an accreting object with mass @xmath300 and isotropic radiative luminosity @xmath301",
    "we may define the eddington factor @xmath302 where @xmath303 is the gas opacity , taken here to be gray .",
    "we consider the isothermal case . for a sound speed @xmath304",
    ", we may then define the radiatively - inhibited bondi radius as @xmath305 the expected steady - state mass accretion rate is then @xmath306 where @xmath307 is the gas density at the outer boundary of the domain .",
    "we set @xmath308 , @xmath309 @xmath310 , @xmath311 cm s@xmath42 , @xmath312 g @xmath63 , @xmath313 , and @xmath258 @xmath43 g@xmath42 , so that @xmath314 and @xmath315 cm .",
    "the spherical domain has inner radius @xmath316 and outer radius @xmath317 .",
    "we initialize the gas density and velocity according to the analytic solution as described in @xcite , in a manner such that each of our lagrangian zones contains roughly equal mass .",
    "we enforce inflow boundary conditions by removing the innermost lagrangian zone from the calculation when its outer radius drops below @xmath318 .",
    "we then simultaneously add a zone at the outer edge of the computational domain with density equal to @xmath307 and with outer velocity equal to the velocity of the formerly outermost zone . as in the previous test , to compute the fluid pressure gradient at the outer boundary we linearly extrpolate the pressure from the outermost two zones .",
    "radiation escapes through the outer boundary .    .",
    "the red curve is our computed solution and the black is the analytic solution .",
    "the maximum disagreement between these two solutions is @xmath319% for the velocity in the innermost zone .",
    "the numerical parameters used in this test are listed in table  [ tab : numericalparameters].,scaledwidth=50.0% ]    figure [ fig : bondidensityandvelocity ] displays the gas density and velocity as a function of position at time @xmath320 .",
    "the fractional deviation between the computed and expected solutions is at most 7% in the innermost zone .",
    "the average accretion rate over this time was 1.06 times the expected mass accretion rate computed from equation [ eq : bondirate ] .",
    "a more complicated set of tests involve steady radiating shocks case ) in which there is no embedded _ viscous _",
    "shock , although there is still a radiation - mediated shock . ] .",
    "the structure of these shocks differs from the pure hydrodynamic case because radiation emitted by the shocked gas leaks out ahead and behind the shock , heating the gas and forming a radiative precursor region ( upstream ) and a radiative relaxation region ( downstream ) .",
    "additionally , the shock obeys a modified set of jump conditions in which the total energy and momentum carried by both gas and radiation is conserved @xcite .    in the gray nonequilibrium diffusion approximation",
    ", there exists a semi - analytic solution for the shock structure @xcite .",
    "for the case where scattering is neglected , and for an adiabatic equation of state with fixed index @xmath321 and mean particle mass @xmath322 , this solution is completely characterized by four dimensionless parameters : the mach number , @xmath323 , of the upstream gas in the rest frame of the shock , the ratio of the speed of light to the upstream sound speed @xmath324 , the ratio of the upstream radiation pressure ( times 3 ) to upstream gas pressure @xmath325 , and the optical depth to the radiation , @xmath162 , for a chosen comoving radiative extinction @xmath326 ( units of @xmath25 ) and lab frame length scale @xmath301    @xmath327    here , quantities with subscript @xmath328 refer to upstream values . for consistency with equations [ eq : massconservation ] through",
    "[ eq : energyconservation ] we take @xmath329 and @xmath330 to be measured in the lab frame and @xmath331 , @xmath332 , and @xmath326 to be measured in the comoving frame , although this distinction is not made in @xcite . also note that when setting these parameters , the upstream gas is considered to be in radiative equilibrium so that @xmath333 = @xmath334 .",
    "following @xcite and @xcite , we choose @xmath335 , @xmath336 , and @xmath337 .",
    "we take @xmath338 cm , so that and @xmath339 . ]",
    "@xmath340 @xmath25 .",
    "we have also set @xmath283 .",
    "the upstream density , temperature , and velocity of the fluid can be determined from these values , and the downstream values can be calculated using the jump conditions and the procedure for solving them outlined in @xcite .",
    "we used the eulerian version of the code . for @xmath245 and @xmath248 , we initialized the computational domain with a step function obeying the jump conditions , not the full semi - analytic solution , and let the shock structure develop on its own .",
    "then , once a structure emerged that was stable over multiple shock crossing times , we spatially translated this solution to compare the numerical shock structure to the semi - analytic solution .",
    "we used dirichlet boundary conditions for the hydrodynamics solver . on the upstream side of the domain , we used reflecting boundary conditions for the radiation . on the downstream side ,",
    "we let the radiation escape freely .",
    "figure [ fig : lem2 ] shows the results for the @xmath245 case at @xmath341 s , and figure [ fig : lem5 ] shows the results for the @xmath248 case at @xmath342 s. in general , there is excellent agreement with the semi - analytic solution .",
    "one slight issue relates to resolving the narrow zeldovich temperature spike . for the @xmath248 case",
    ", we increased our resolution all the way to 2048 zones , and even then the spike is slightly underestimated .            for the @xmath245 case",
    ", we also display our computed value of the eddington tensor element @xmath343 as a function of position in figure [ fig : eddingtonfactor ] .",
    "fld assumes that the diagonal elements of @xmath85 never drop below @xmath344 .",
    "we find , as in @xcite and @xcite , that @xmath343 does indeed drop below 1/3 near the shock .",
    "( red ) for the @xmath245 steady radiating shock test , with the nondimensional density ( blue ) over - plotted .",
    "the solid black line represents a constant value of @xmath344 , which holds in the diffusion approximation .",
    "we that @xmath343 does indeed drop below 1/3 near the shock , as previous authors have observed ( see text for details).,scaledwidth=50.0% ]    we also considered a stronger shock , with @xmath251 . in this case , we initialized the problem with the steady - state solution and tested to make sure it maintained that solution over several shock crossing times . also for the @xmath251 case , rather than implementing a constant radiative flux boundary condition on the downstream side , we used a reflecting boundary condition for the downstream radiation , and extended the downstream domain so that any spurious effects from this boundary condition did not have time to reach the region of interest near the shock .",
    "figure [ fig : lem70 ] shows the results for the @xmath251 case at @xmath345 s. this case is particularly interesting because downstream of the shock , the radiation energy density is larger than the gas thermal energy by a factor of about 9 . here",
    "radiation pressure becomes dynamically important , and we are testing the behavior of the radiation pressure force in our code in the optically thick regime .",
    "we find good agreement between our computed results and the semi - analytic solutions for the gas and radiation temperatures .",
    "however , we find that the gas density on the downstream side is about 5% lower than expected based on the jump conditions .",
    "the cause of this discrepancy is unclear , but it might be related to our method for coupling the radiation momentum source terms to the godunov solver .",
    "our hydro time - steps are large enough that we are in the highly implicit regime for the monte carlo , although our solution does not appear to change signficantly if we reduce our cfl number by a factor of 2 .",
    "this test involves a super - critical radiative shock driven by the supersonic motion of a piston into initially uniform and static gas , as defined by @xcite .",
    "the test has been revisited many times , including in @xcite , in which the zeus - mp2 code was used to solve the problem while making use of the flux - limited diffusion approximation for the radiation .",
    "more recently , @xcite compared the results of their monte carlo radiation - hydrodynamics code to the zeus results for this problem .",
    "the numerical parameters for these tests are reported in table  [ tab : numericalparameters ] . additionally , we used reflecting boundary conditions for both the radiation and the hydrodynamics at the piston boundary . on the other side of the domain",
    ", we let radiation escape freely , and we used dirichlet boundary conditions for the hydrodynamics .",
    "in figures [ fig : ensmansub - critical ] and [ fig : ensmansuper - critical ] we display our results for the sub - critical and super - critical versions of the test , respectively .",
    "the agreement between the two codes is encouraging .",
    "as @xcite found , we see deeper penetration of the radiation into the radiative precursor than in the fld result . we also find that the radiative precursor in our results takes slightly more time to develop than in zeus , and this might be due to our implicit treatment of the radiative cooling .",
    ".,scaledwidth=50.0% ]    , but for a super - critical radiating shock.,scaledwidth=50.0% ]",
    "one of the main concerns with applying mcrt methods to rhd problems is that the estimators of the radiation field possess stochastic errors that may propagate into the dynamics . in general",
    ", the radiation force is more poorly sampled than the radiation energy deposition , due to the fact that packets traveling in opposite directions cancel out in the estimator of the flux .",
    "the problem becomes more acute in regions of high optical depth , where the radiation becomes nearly isotropic and the flux constitutes only a small fraction of the total radiation mean intensity .    in this case , a better approach ( mentioned in section [ sec : equations ] ) may be to use the divergence of the eddington tensor ( equation [ eq : pressuredivergence ] ) to derive the radiation force . as noted before , this approach",
    "is only guaranteed to be accurate when the radiation is diffusing , but that is precisely the situation in which such an approach becomes most attractive .",
    "the @xmath346 element of the radiation pressure tensor does not suffer from the same packet cancellation as does the flux , and so is typically better estimated . to calculate the radiation force",
    ", we used a simple centered difference to take a second - order spatial derivative of the pressure tensor .",
    "we note that there are more sophisticated methods for taking numerical derivatives of noisy data , and that these may lead to superior results .",
    "figure [ fig : radforcecomparison ] compares the noise in the calculation of the radiation force in the @xmath251 steady radiating shock test using our two different methods ( in all other tests , only the direct monte carlo estimator of the force was used , not the divergence of the pressure tensor ) .",
    "the figure demonstrates that although the two methods converge to a similar result at high spatial resolution and for a large number of packets , the pressure tensor divergence method converges must faster - it provides much less noise than the direct monte carlo summation method for coarser spatial resolutions and lower packet number .",
    "these results suggest the possibility of using mcrt in a hybrid approach with other radiation transport schemes .",
    "in particular , solution of the radiation moment equations require a closure relation , which is often taken to be an approximate analytic prescription .",
    "solution of the mcrt , however , provides estimator of the true eddington tensor , which could then be used as a closure to the moment equations . in this case",
    ", the mcrt may not need to be run every time - step , allowing for a reduced computational load .",
    "steady radiating shock problem .",
    "the left panels use the divergence of the pressure tensor to calculate the radiation force , whereas the right panels use the direct monte carlo summation method .",
    "the top two panels use numerical parameters as listed in table  [ tab : numericalparameters ] .",
    "the bottom two panels use a spatial resolution that is four times as coarse , and a maximum of 4000 packets per zone instead of 7680.,scaledwidth=50.0% ]",
    "the relative performance of the mcrt compared to traditional radiation - hydrodynamics schemes depends sensitively on the particular problem at hand  the spatial resolution , optical depth , degree of radiation domination , and level of tolerable noise . for the test problems discussed in the last section",
    ", we find that mcrt execution times are in some cases comparable to grey fld techniques , and in others considerably more expensive .",
    "table [ tab : performance ] summarizes the execution times for the ensman super - critical shock test for a varying number of monte carlo packets employed , and two separate spatial resolutions .",
    "these tests were performed on a 2012 macbook pro laptop ( 2.6 ghz intel core i7 processor ) and compiled with g++ . for comparison , we have included tests run with the flux - limited diffusion code zeus - mp , run on the same machine and compiled with gfortran .",
    "when a smaller number of packets is used , the radiation field in the mcrt calculation naturally possesses increased noise , as illustrated in figure  [ fig : ensmansuper - criticalfewerpackets ] .",
    "the error is most apparent in the high - temperature shocked gas , and in the stair step behavior at the leading edge of the radiative precursor .",
    "the latter effect arises because only a small number of high energy packets manage to diffuse ahead of the shock in any given time - step .",
    "this behavior is in part due to our unoptimized choice to emit equal numbers of packets in every zone , despite the fact that the emissivity behind the shock is at least @xmath219 times greater than that of the coldest gas ahead of it .",
    "applications of so - called importance sampling techniques may substantially reduce the error without increasing the execution time .",
    "in particular , one could increase the number of high - energy packets emitted near the shock interface , while at the same time reducing the number of low - energy packets emitted in the pre - shock region .    , but with a maximum of only 100 packets emitted per zone per time - step , instead of 1000 .",
    "the right panel shows the corresponding gas densities.,scaledwidth=50.0% ]    it is comforting to see that , despite the noisy radiation field of figure  [ fig : ensmansuper - criticalfewerpackets ] , the gas density suffers less from noise .",
    "this is because the gas properties are determined by the radiative heating and acceleration integrated over many time - steps .",
    "these time - averaged quantities are more accurately sampled than the instantaneous radiation field snapshot plotted in the figure . in general",
    ", we find that for problems where gas energy dominates , the dynamics of the problem are rather robust against instantaneous radiation noise . for problems where radiation energy and pressure dominate ,",
    "the radiation noise is more problematic and can propagate into the gas properties .",
    "the deleterious effect of noise may also be more significant in multi - dimensional simulations where instabilities might develop .",
    "figure  [ fig : noisecomparison ] shows the gas temperatures computed for each of the calculations in table  [ tab : performance ] , zoomed in to the region surrounding the zeldovich spike . in addition to the noise present at the scale of a few zone widths , the value of the temperature averaged over larger scales also varies between the individual monte carlo calculations at the level of a few percent , as is evident in figure  [ fig : noisecomparison ] and listed in table  [ tab : performance ] . in order to quantify the small - scale noise , we focus on the region upstream ( left ) of the spike , where the effect of the noise is most severe .",
    "we apply an offset to the monte carlo temperatures so that their mean value in this region matches that of the zeus calculation .",
    "then , we measure the root mean square difference between these offset gas temperatures and the temperatures computed by zeus , excluding the 3 zones directly adjacent to the left boundary .",
    "the effect of increasing the number of packets on the rms error for the four calculations with 1200 zones agrees especially well with the rule of thumb that the random error should scale as @xmath347 where @xmath193 is the number of packets employed . we see that to decrease the rms error associated with small - scale noise to within 1% ,",
    "the cpu time requirement is approximately four times that of zeus in the runs employing 512 zones , and twice that of zeus in the runs employing 1200 zones .",
    "cccc zeus 512 zones & 4617.5 & & 1.8 + mc 512 zones , 100 packets & 4686.9 & 44.7 ( 0.95  % ) & 6.4 + mc 512 zones , 300 packets & 4618.0 & 29.3 ( 0.63  % ) & 18.3 + mc 512 zones , 1000 packets & 4639.0 & 24.7 ( 0.53  % ) & 56.4 + & & & + zeus 1200 zones & 4613.8 & & 17.8 + mc 1200 zones , 50 packets & 4535.5 & 50.1 ( 1.1 % ) & 35.4 + mc 1200 zones , 100 packets & 4574.1 & 35.5 ( 0.75 % ) & 68.3 + mc 1200 zones , 200 packets & 4622.2 & 25.2 ( 0.55 % ) & 133.6 + mc 1200 zones , 500 packets & 4680.6 & 14.3 ( 0.31 % ) & 298.3 + [ tab : performance ]        the potential performance advantages of the mcrt method would become more apparent if , instead of comparing to zeus - mp , we were to compare to a non - grey radiation code . for most deterministic transport methods , the execution time scales with the number of angle bins and frequency groups employed , and therefore become significantly more expensive than grey fld .",
    "our mcrt calculations , on the other hand , already include the angular information and can be run in multi - frequency mode with minimal additional computational expense .",
    "photon packets are distributed across the relevant frequency range and , because the radiation force four - vector is given by integrals over frequency , no additional packets are needed to construct source term estimators of comparable noise , at least in the case that the opacity has a reasonably smooth frequency dependence . in cases where the opacity has sharp dependencies ( e.g. , lines ) ,",
    "importance sampling technique can be used to increase packet statistics at the most important frequencies .",
    "convergence tests varying the number of packets would be required to determine whether the frequency sampling had been sufficient .",
    "as already mentioned , the execution time of the mcrt code is highly problem - dependent , in particular because of the well - known inefficiency of monte carlo methods in regions of high optical depth , where many photon interactions must be tracked per time - step . for high optical depth cases , a substantial speed - up",
    "can be obtained through the inclusion of the discrete diffusion technique , which has been described for the gray radiation case in @xcite and the non - gray case in @xcite .    for problems with one spatial dimension , or problems of higher dimension and sufficiently coarse spatial resolution ,",
    "the entire computational domain can be stored in the memory of a single computational node . with the added fact that monte carlo packets propagate independently of one another over a single time - step",
    ", this permits an `` embarrassingly parallelizable '' treatment for the radiation portion of the problem .",
    "the transport step may be replicated over as many computational nodes as are available , and then the results of the packet propagation during each time - step for each node can be summed together with an message passing interface ( mpi ) reduction .",
    "we have run mpi - parallelized versions of the ensman sub - critical shock test in which the total number of photon packets per time - step is held constant , but is divided over varying numbers of cpus .",
    "although we have only parallelized the radiation portion of the code , the cpu time required to execute the hydro update is negligible compared to the radiation .",
    "we see perfect strong parallel scaling in the time for this test , which is to say that the amount of wall time needed to complete the test is cut in half each we double the number of cores we use , as shown in figure [ fig : parallelscaling ] .",
    "we have demonstrated that mcrt coupled to both lagrangian and eulerian hydrodynamics solvers can result in accurate , robust treatments of rhd problems , including those in which the radiation energy dominates .",
    "although we have focused here on 1-dimensional test problems , our eulerian code is multi - dimensional , and subsequent studies will address astrophysical problems in higher spatial dimensions .",
    "our approach makes use of the implicit mcrt method to allow us to take hydrodynamical time - steps much larger than the gas cooling time .",
    "we also showed how to use monte carlo estimators to construct expressions for the radiation force four - vector @xmath18 that are accurate to all orders of @xmath2 , although the hydrodynamics equations are only solved to order @xmath2 .",
    "we compared simulations using our exact expression for @xmath18 to those using a more approximate expression based on the divergence of the radiation pressure tensor , which is valid when the radiation is in the diffusion regime .",
    "we found that the latter method can lead to a significant reduction in monte carlo noise in cases of coarse spatial resolution . in most of the problems studied here",
    ", the presence of stochastic noise did not introduce substantial error in the dynamics , however the effects of noise become a larger concern in problems where radiation energy is strongly dominated .",
    "several additional refinements will be explored in the future .",
    "we will consider the use of a more sophisticated treatment of the radiative source terms in the godunov scheme .",
    "improvements in performance may be realized by incorporating the discrete diffusion technique .",
    "it is straightforward to incorporate the effects of more complicated radiation - matter interactions , including photoionization and anisotropic scattering processes such as compton scattering with klein - nishina corrections .",
    "possible applications of this technique include radiatively - launched winds from galaxies , tidal disruptions of stars , shock breakouts and ejecta - ism interactions in supernovae .",
    "we thank phil colella for guidance in the developing the godunov solver .",
    "we thank weiqun zhang for providing the script to compute the semi - analytic radiating shock solutions .",
    "we thank ulrich noebauer for helpful correspondence regarding the comparison to zeus - mp2 .    throughout the work ,",
    "nr was supported by the department of energy office of science graduate fellowship program ( doe scgf ) , made possible in part by the american recovery and reinvestment act of 2009 , administered by orise - orau under contract no .",
    "de - ac05- 06or23100 .",
    "this research used resources of the national energy research scientific computing center , which is supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "this research used resources of the oak ridge leadership computing facility at the oak ridge national laboratory , which is supported by the office of science of the u.s .",
    "department of energy under contract no . de - ac05 - 00or22725 ."
  ],
  "abstract_text": [
    "<S> we explore the application of monte carlo transport methods to solving coupled radiation - hydrodynamics problems . </S>",
    "<S> we use a time - dependent , frequency - dependent , 3-dimensional radiation transport code that is special relativistic and includes some detailed microphysical interactions such as resonant line scattering . </S>",
    "<S> we couple the transport code to two different 1-dimensional ( non - relativistic ) hydrodynamics solvers : a spherical lagrangian scheme and a eulerian godunov solver . the gas - radiation energy coupling is treated implicitly , allowing us to take hydrodynamical time - steps that are much longer than the radiative cooling time . </S>",
    "<S> we validate the code and assess its performance using a suite of radiation hydrodynamical test problems , including ones in the radiation energy dominated regime . </S>",
    "<S> we also develop techniques that reduce the noise of the monte carlo estimated radiation force by using the spatial divergence of the radiation pressure tensor . </S>",
    "<S> the results suggest that monte carlo techniques hold promise for simulating the multi - dimensional radiation hydrodynamics of astrophysical systems . </S>"
  ]
}