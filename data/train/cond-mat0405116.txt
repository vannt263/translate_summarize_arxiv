{
  "article_text": [
    "molecular simulation has become indispensable as a modern tool to gain insight in the kinetics of processes in complex environment by supplying detailed atomistic information that is not ( easily ) experimentally accessible . using either classical or _",
    "ab initio _ based atomistic force fields  @xcite , techniques such as molecular dynamics ( md )  @xcite can model reactive events on a reasonable realistic level .",
    "in contrast to most experiments where kinetic properties such as the reaction rate are obtained by measuring the macroscopic population densities of reactant and product states over a long time ( seconds ) , molecular dynamics simulations have to obtain good statistics with much smaller systems ( usually @xmath0 100 to 100000 molecules ) in the accessible time range of nanoseconds - microseconds using a time step of a few femtoseconds , as dictated by the molecular vibrations .",
    "this small timescale and system size limits the application to activated processes with relatively low barriers between reactant and product states .",
    "the computation of rate constants with straightforward md becomes inefficient when the process of interest has to overcome a high activation barrier because the probability to observe a reactive event on this time- and system - scale decreases exponentially with the barrier height .",
    "the system will spend a long time in one of the stable states and occasionally jump in relatively short time to the other state .",
    "this separation of time scales results in two state kinetics : the exponential relaxation of the population densities  @xcite .",
    "the time - scale problem is traditionally solved by a two - step reactive flux method  @xcite .",
    "one first calculates the free energy as a function of a reaction coordinate describing the process . the transition state theory ( tst ) rate constant",
    "is then related to the probability to be at the maximum of the free energy barrier .",
    "this rate is only an approximation and the second part of the reactive flux methods computes the correction , the transmission coefficient , by starting many fleeting trajectories from the top of the barrier  @xcite .",
    "however , the success of this method depends strongly on the choice of reaction coordinate .",
    "if the reaction coordinate fails to capture the molecular mechanism the corresponding transmission coefficient will be extremely low , making an accurate evaluation of the rate problematic if not impossible . for high dimensional complex systems , for instance chemical reactions in solution , or protein folding , a good reaction coordinate can be extremely difficult to find and usually requires detailed _ a priori _ knowledge of the transition mechanism .",
    "hence , tst based reactive flux methods will be ineffective for complex processes for which no prior knowledge is available .",
    "chandler and collaborators  @xcite devised a method for which no reaction coordinate is needed , but only a definition of the reactant and product state .",
    "this method , called transition path sampling ( tps ) , gathers a collection of trajectories connecting the reactant to the product stable region by employing a monte carlo ( mc ) procedure called _ shooting _ and _ shifting_. the resulting _ path ensemble _ gives an unbiased insight in the mechanism of the reaction .",
    "tps has been successfully applied to such diverse systems as cluster isomerization , auto - dissociation of water , ion pair dissociation and on isomerization of a dipeptide , as well a reactions in aqueous solution ( see ref .",
    "@xcite for an overview ) .",
    "a drawback of tps is that the calculation of rate constants is rather computer time consuming .",
    "we therefore developed the more efficient transition interface sampling ( tis ) method @xcite .",
    "tis allows a variable path length , thereby limiting the required md time steps to the strict necessary minimum .",
    "the tis rate equation is based on an effective positive flux formalism and is less sensitive to recrossings .",
    "the shifting moves used in tps to enhance statistics , are unnecessary in the tis algorithm .",
    "also , multidimensional or even discrete order parameters can easily be implemented in tis .",
    "recently , we showed that for diffusive processes one can exploit the loss of correlation along trajectories .",
    "this lead to the development of the partial path tis ( pptis ) method , a variation of tis that samples much shorter paths  @xcite .    in this paper",
    "we re - derive the basic concepts of tis and pptis in a more intuitive way and relate them to the calculation of the transmission coefficient . for the mathematical validation of the expressions we refer to refs .",
    "the paper is organized as follows . in section",
    "ii we discuss the relation between several different microscopic expressions for the phenomenological rate constant present in the literature , and derive the positive effective flux formalism on which both interface path sampling methods are based . in section",
    "iii we present the tis and pptis formalism and precise algorithm . in section iv , we introduce new algorithms for alleviating ergodicity problems that might occur in path sampling simulations .",
    "the last section v , is reserved for new ways of extracting interesting properties from path ensembles , such as the activation energy of a reaction .",
    "we end with concluding remarks .",
    "the calculation of reaction rate constants by computer simulation requires an expression for the rate constant in terms of microscopic properties .",
    "such a microscopic rate expression needs a proper characterization of the reactant state @xmath1 and product state @xmath2 for each separate reaction , but should not be too sensitive to these state definitions , otherwise an unrealistic ill - defined rate will result . once we have a rate expression , there are several ways to compute the reaction rate .",
    "the standard reactive flux method measures the flux through a single hypersurface in phase - space dividing the reactant state @xmath1 from the product state @xmath2 . in tps",
    "the rate constant is taken from a time derivative of a correlation function , which can be calculated by slowly confining a completely free path ensemble to an ensemble that connects reactant to product .",
    "the tis approach measures a reactive flux through many interfaces between @xmath1 and @xmath2 .",
    "these three methods can be related to each other , as they ultimately compute the same properties .",
    "the tps correlation function at @xmath3 becomes equivalent to the tst approach when @xmath1 and @xmath2 are adjacent in phase space @xcite .",
    "the tis effective positive flux formalism for a single interface is equivalent to tst - based transmission coefficient calculations@xcite .",
    "the tis rate equation can also be recast in terms of a tps - like correlation function but then based on the so - called _ overall _ states of the system . in the following subsections , we will explain the reactive flux , tps , and tis methods and their connections in detail .",
    "the first step in tst is to choose a reaction coordinate @xmath4 describing the transition from a stable reactant state @xmath1 to a stable product state @xmath2 .",
    "this reaction coordinate can be any function @xmath5 of phase space point @xmath6 , with @xmath7 the particle coordinates and @xmath8 the momenta .",
    "next , the free energy @xmath9 is calculated by determining the probability @xmath10 to be at @xmath4 using , for instance , biased sampling techniques  @xcite . here",
    ", @xmath11 is the boltzmann constant and @xmath12 is the temperature .",
    "the maximum @xmath13 in @xmath14 defines the dividing surface @xmath15 separating state @xmath1 from state @xmath2 . by convention ,",
    "the system is in @xmath1 if @xmath16 and in @xmath2 if @xmath17 . for a phase point @xmath18 in @xmath1 ,",
    "the probability to be at the top of the barrier is : @xmath19 where the brackets @xmath20 denote the equilibrium ensemble averages , @xmath21 and @xmath22 are the heaviside step - function and the dirac delta function , respectively , and @xmath23 .",
    "tst assumes that trajectories that cross @xmath13 do not recross the dividing surface hence , the tst expression is equivalent to the positive flux through the dividing surface @xmath13 : @xmath24 where the dot denotes a time derivative and the subscript @xmath13 to the ensemble brackets indicates that the ensemble is constrained to the top of the barrier on the dividing surface @xmath13 .",
    "the tst rate constant is sensitive to the choice of reaction coordinate @xmath5 and will only be correct if the surface @xmath25 corresponds to the true transition state dividing surface : the so - called separatrix . for complex systems , it is impossible to know the location and shape of this curved multidimensional separatrix .",
    "it is possible , however , to correct the tst expression with a dynamical factor that is called the transmission coefficient .",
    "traditionally , the dynamical corrected rate constant is derived by applying a small perturbation to the equilibrium state and invoking the fluctuation - dissipation theorem @xcite .",
    "this leads , for instance , to the well known bennett - chandler ( bc ) @xcite expression for the reaction rate @xmath26 where @xmath27 specifies the coordinates and momenta of the system at time @xmath28 as obtained from a short molecular dynamics ( md ) trajectory starting at @xmath29 .",
    "the ensemble average is taken over all phase points @xmath29 . for exponentially relaxing two state kinetics with a well defined rate constant",
    ", there is a separation of timescales : the reaction time @xmath30 ( or expectation time for one single event ) is much longer than the molecular time @xmath31 that the system spends on the barrier . in that case , eq .",
    "( [ bcrate ] ) will reach a plateau value for @xmath32 , which is equal to the correct phenomenological rate constant @xmath33 .",
    "the function @xmath34 will sensitively depend on the choice of the reaction coordinate @xmath4 , but the plateau value will not . in the limit @xmath35 , the bc rate reduces to the tst expression eq .",
    "( [ ratetst ] )    the transmission coefficient is defined as the ratio between the real rate constant and the tst expression : @xmath36 : @xmath37 the numerator in eq .",
    "( [ bctrans ] ) counts trajectories with a positive but also with a negative weight .",
    "the latter trajectories leave the surface at @xmath3 with a negative velocity @xmath38 , but are eventually found at the b side of the surface after a ( few ) recrossing(s ) . however , untrue @xmath39 trajectories do not contribute to the rate because the positive and negative terms cancel   is compensated by a higher probability to measure the crossing point as the trajectory spends more time at the surface . ]",
    "( see fig .",
    "[ fluxcancel ] ) .    ) , ( [ transbc2 ] ) , and ( [ transtis ] ) . for simplicity ,",
    "assume that the system consists of three kind of possible trajectories , as shown by this figure , that cross the dividing surface with the same speed @xmath40 orthogonal to the surface .",
    "to the seven phase points on the surface ( from top to bottom ) the numerator of eq .",
    "( [ bctrans ] ) will assign the values @xmath41 $ ] , while these are @xmath42 $ ] for eq .",
    "( [ transbc2 ] ) and @xmath43 $ ] for eq .",
    "( [ transtis ] ) .",
    "the sum of these give the same result @xmath40 .",
    "evaluation of eq .",
    "( [ transtis ] ) in an actual computer algorithm requires the fewest md steps as only phase points similar to the 3rd and 7th phase points would need the integration until reaching stable state regions .",
    "for instance , the fifth crossing point can be assigned zero already as soon as one detects that its backward trajectory recrosses the surface.,width=151 ]    similarly , the @xmath44 trajectories with multiple @xmath13 crossings are effectively counted only once  @xcite .",
    "although eq .",
    "( [ bcrate ] ) gives the correct rate constant , it is rather unsatisfactory to sample only trajectories forward in time not knowing which contribute to the rate and which do not .",
    "therefore , alternative expressions for the rate constant have been proposed taking the past into account . here ,",
    "they are referred to as the bc2 @xcite expression @xmath45 and the positive flux pf @xcite expression @xmath46 in eq .",
    "( [ transbc2 ] ) the theta functions guarantee that only true @xmath47 events are counted . still , the numerator in eq .",
    "( [ transbc2 ] ) contains negative terms : those phase points @xmath29 with a negative velocity @xmath38 and with corresponding backward and forward trajectory that ends up in @xmath1 and @xmath2 , respectively .",
    "( [ transpf ] ) counts only positive crossings , but cancellation with a negative term can occur when the backward trajectory also ends up at the @xmath2 side of the dividing surface . at first sight , eq .",
    "( [ transpf ] ) seems to overcount @xmath44 trajectories with multiple @xmath13 crossings .",
    "however , if one realizes that each @xmath47 trajectory has an equivalent trajectory @xmath48 by reversing the time , an overall cancellation of positive and negative terms ensures a proper final outcome .    for completeness",
    ", we mention that there are also similar expressions by berne @xcite and a relation by hummer @xcite that counts both positive and negative crossings with a positive weight , but only if the corresponding trajectory ends at opposite sides of the surface and with a weight lower than @xmath49 if its trajectory has more than just one crossing .",
    "ruiz - montero et al .",
    "designed a transition zone method in which they measure the flux on many places at the top of the barrier and weight them to the inverse free energy @xcite .",
    "a more intuitive , yet sound , alternative to the above expressions is the _ effective _ flux formalism .",
    "we can illustrate this formalism with an analogy to the migration of people from country @xmath1 to @xmath2 . to determine the emigration rate we can simply count the number of persons that cross the border from @xmath1 to @xmath2 within a certain time interval .",
    "however , we should not count tourists .",
    "this group consist of people who have a nationality @xmath1 and will only spend a short time in @xmath2 , or have a nationality @xmath2 and are actually on their way back .",
    "moreover , we have to be aware that some emigrants might cross the frontier several times on their way .",
    "to prevent overcounting , we should only count one specified crossing for each person , for instance , the first or the last crossing of the emigration journeys from @xmath1 to @xmath2 .",
    "the same reasoning can be applied when calculating the rate constant of a reaction . in a molecular simulation",
    "we can check the nationality of the system and the one - crossing condition by simply following the equations of motions backward and forward in time .",
    "this procedure , to count only true events and to avoid counting recrossings is what we call the _ effective positive flux _ formalism . in sec .",
    "[ subseccwt ] we give the mathematical expression of the effective positive flux .",
    "it is surprising that the effective positive flux counting strategy is not so common . to our knowledge",
    "only two slightly different expressions of a transmission coefficient based on the effective positive flux have been proposed in refs .",
    "@xcite . in all other expressions found in the literature the counting of recrossings",
    "is not avoided , but the final rate constant follows through cancellation of many negative and positive terms .",
    "the effective flux transmission coefficients formulation is most useful when applying a single dividing surface and when recrossings are apparent  @xcite . in general",
    ", we note that any averaging method counting only zero and positive values will show a faster convergence than one that is based on cancellation of positive en negative terms .",
    "moreover , in the effective flux formalism many trajectories will be assigned as unreactive after just a few md steps ( see fig .",
    "[ fluxcancel ] ) , thus reducing the number of required force evaluations .",
    "a comparative study of ion channel diffusion @xcite showed that the algorithm based on effective positive flux expression of anderson @xcite was superior to the other transmission rate expressions .",
    "moreover , it was found as efficient as an optimized version of the more complicated ruiz - montero method @xcite .      in tps one also has to define an order parameter @xmath5 , but this does not have to be a properly chosen reaction coordinate capturing the essence of the dynamical mechanism .",
    "instead , it is sufficient but necessary that this function is able to characterize the basins of attraction of the stable states  @xcite . by definition",
    "the system is in @xmath1 if @xmath50 and in @xmath2 if @xmath51 with @xmath52 .",
    "clearly , the two states are not connected and the intermediate barrier region , belongs neither to @xmath1 nor to @xmath2 . by introducing following characteristic functions @xmath53 the tps - correlation function is defined as : @xmath54 if there is a separation of timescales , this correlation function grows linearly in time , @xmath55 , for times @xmath56 in that case , the time dependent reaction rate @xmath57 reaches a plateau for @xmath58 .",
    "@xmath59 can be calculated in a path sampling simulation employing the shooting and shifting monte carlo moves , in combination with an umbrella sampling algorithm in which the final region @xmath2 is slowly shrunk from the entire phase space to the final stable state @xmath2",
    "the disadvantage of such a procedure is that it can take a relatively long time @xmath31 before @xmath59 reaches a plateau ( longer than in a transmission coefficient calculation @xcite ) .",
    "all paths in the path sampling should have a minimal length @xmath60 and as a result unnecessarily long periods are spent inside the stable state basins of attraction .",
    "moreover , inspection of eqs .",
    "( [ corrtps ] ) and ( [ ratetps ] ) shows that a necessary cancellation of positive and negative terms can slow down the convergence of the mc sampling procedure . in the case of adjacent @xmath1 and @xmath2 regions ,",
    "the tps formalism becomes equivalent to the tst approximation in the limit @xmath61 @xcite .",
    "the tis method is based on the measurement of the fluxes though multiple dividing surfaces .",
    "consider a set of @xmath62 non - intersecting multidimensional interfaces @xmath63 described by an order parameter @xmath5 that does not have to correspond to the real reaction coordinate .",
    "we choose @xmath64 , @xmath65 such that @xmath66 , and that the boundaries of state a and b are described by @xmath67 and @xmath68 , respectively . for each phase point @xmath18 and each interface @xmath69",
    ", we define a backward time @xmath70 and forward time @xmath71 : @xmath72 \\nonumber \\\\",
    "t_i^f(x_0 ) & \\equiv & + \\min \\left [ \\ { t | \\lambda(x_t ) = \\lambda_i \\wedge t \\ge 0 \\ } \\right],\\end{aligned}\\ ] ] which mark the points of first crossing with interface @xmath69 on a backward ( forward ) trajectory starting in @xmath29 .",
    "note that @xmath73 and @xmath74 defined in this way always have positive values .",
    "following ref .",
    "@xcite , we then introduce two - fold characteristic functions that depend on two interfaces @xmath75 , @xmath76 which measure whether the backward ( forward ) time evolution of @xmath18 will reach interface @xmath69 before @xmath77 or not",
    ". however , as the interfaces do not intersect , the time evolution has to be evaluated only for those phase points @xmath18 that are in between the two interfaces @xmath69 and @xmath77 . in case @xmath78 , we know in advance that @xmath79 if @xmath80 and @xmath81 if @xmath82 . when the system is ergodic , both interfaces @xmath69 and @xmath77 will be crossed in finite time and thus @xmath83 .",
    "the two backward characteristic functions define the tis _ overall _ states @xmath84 and @xmath85 : @xmath86 together , the _ overall _ states cover the entire phase space and , within certain limits , do not sensitively depend on the precise boundaries of stable states @xmath1 and @xmath2 . with these new characteristic functions",
    "we can write down a correlation function similar to eq .",
    "( [ corrtps ] ) : @xmath87 this correlation function exhibits a linear regime @xmath88 for @xmath89 .",
    "therefore , we can simply take the time derivative at @xmath3 yielding @xmath90 one can easily verify that here only positive terms contribute to the rate .",
    "the connection to the transmission coefficient can be made by using following relation  @xcite : @xmath91 for @xmath92 . using this equality",
    ", we can write down a transmission coefficient similar to the ones in sec .",
    "[ sectrans ] but then based on the effective positive flux @xcite : @xmath93 for @xmath94 .",
    "although , in principle @xmath95 is redundant in the numerator of eq .",
    "( [ transtis ] ) as @xmath96 if @xmath97 , it is there to highlight that only positive crossings are counted .",
    "trajectories started at @xmath29 on interface @xmath69 are followed backward in time until they reach stable region @xmath1 or recross interface @xmath69 .",
    "then , only the ones that reach stable region @xmath1 are also followed forward in time until they reach one of the stable regions .",
    "the slightly different effective flux expression of ref .",
    "@xcite follows trajectories until reaching the plateau region time and counts for each @xmath44 trajectory only the last crossing instead of the first .",
    "in a system for which the correct reaction coordinate @xmath4 is known in advance and that is not dominated by recrossings , the effective positive flux formalism of ( eq .  ( [ transtis ] ) and ref .",
    "@xcite ) is probably the best choice when using a single dividing surface @xcite .",
    "however , for complex systems , for instance chemical reactions in solution , any intuitively chosen reaction coordinate can give arbitrary small transmission coefficients , making an accurate computation prohibitive . to improve reaction",
    "coordinates by e. g. taking solvent degrees into account is generally a difficult job .",
    "some progress has been made by using the coordination number as reaction coordinate @xcite , but this ad hoc approach probably only works for specific systems . for instance , we showed that a proton transfer reaction in water depends very sensitively on the angular orientation of the surrounding water molecules @xcite .",
    "similarly , the degrees of freedom in a protein are so large that dynamical folding processes are at best only very qualitatively described by order parameters .",
    "quantities such as radius of gyration or number of native contact do usually not correspond to reaction coordinates @xcite .",
    "subtle effects , e.g. the solvent structure , play also here a role . to incorporate all these subtleties in a single one - dimensional reaction coordinate",
    "is an immense task and can only be successful if the precise reaction mechanism is already known in advance .",
    "the tps and tis techniques do not rely on a reaction coordinate .",
    "the tis hypersurfaces do not have to coincide with the transition state dividing surface .    at the end of this section we give tis ( and pptis ) rate expressions that can be employed in a computer algorithm .",
    "first , as the derivation of the tis and pptis formalism requires a proper notation , we introduce following flux function @xmath98 the first equality has the same flux notation as eq .",
    "( [ ratetis ] ) , but the second equality is more useful in practice . an md trajectory might cross interface @xmath64 , but consists of discrete time slices that are never exactly on the surface ( as opposed to a transmission coefficient calculation ) . however , @xmath99 can still be defined for the discrete md set of time - slices by taking @xmath100 equal to the molecular time - step . in words",
    ", @xmath99 equals @xmath101 if the forward trajectory crosses @xmath64 in one single @xmath100 time - step and the backward trajectory crosses @xmath102 before @xmath64 .",
    "otherwise @xmath99 vanishes .",
    "in addition , we introduce a flux function that incorporates also the forward trajectory @xmath103 by making use of eq .",
    "( [ fluxrel ] ) we can write for @xmath104 : @xmath105 and , thus , the rate constant ( [ ratetis ] ) becomes @xmath106 for each @xmath64 with @xmath107 .",
    "the second step is to define a conditional crossing probability that depends on the location of four interfaces : @xmath108 in words , this is the probability for the system to reach interface @xmath109 before @xmath110 under the condition that it crosses at @xmath3 interface @xmath69 , while coming directly from interface @xmath77 in the past ( see fig .",
    "[ figprob ] ) .     for a certain configuration of interfaces @xmath111 , and @xmath112 .",
    "the condition @xmath113 is depicted by the arrow and the solid line for two phase points ( the dots ) : from this phase point one should cross @xmath64 in one single @xmath100 time - step in the forward direction , and , besides , its backward trajectory should cross @xmath102 before @xmath64 .",
    "two possible forward trajectories are given by the dashed line .",
    "the upper crosses @xmath112 before @xmath114 , the lower crosses @xmath114 as first . the fraction",
    "whose forward trajectories behave like the last case equals @xmath115.,width=226 ]    the probabilities in eq .",
    "( [ p4int ] ) are the building blocks for both tis as pptis to construct expressions for the rate constant .",
    "the probabilities @xmath115 are defined on any set of four interfaces .",
    "the case , where @xmath116 and @xmath117 , is of special interest for tis and will be annotated as follows @xmath118 for pptis , two types of crossing probabilities are required : the one interface crossing probabilities @xmath119 and the long distance crossing probabilities @xmath120 using these probabilities , the tis rate constant can be written in terms that can be determined in a computer simulation  @xcite @xmath121 the first factor @xmath122 is a flux and can be calculated by straightforward md as @xmath123 will be close to @xmath1 ( see sec .",
    "[ secflux ] ) .",
    "the second factor , the crossing probability @xmath124 , is calculated using the factorization in eq .",
    "( [ kabphip ] ) into probabilities @xmath125 that are much higher than the overall crossing probability .",
    "these can be calculated using the shooting algorithm as will be explained in sec .",
    "[ secshooting ] .    for pptis the set of equations",
    "are as follows@xcite : @xmath126 the factor @xmath122 is identical to the tis flux factor , whereas to obtain the reverse rate @xmath127 only a single extra factor @xmath128 is needed .",
    "the @xmath129 and @xmath130 are obtained via the recursive relations  ( [ recpptis ] ) once all single crossing probabilities of eq .",
    "( [ onehop ] ) are known . starting with @xmath131",
    ", we can iteratively determine @xmath132 for @xmath133 until @xmath134 .",
    "the one - hopping probabilities  ( [ onehop ] ) can again be calculated using the shooting algorithm .",
    "the pptis formalism basically transforms the process of interest into a markovian sequence of hopping events . yet ,",
    "if the dynamics is diffusive and the interfaces are sufficient far apart , the rate formalism ( [ ratepptis ] ) and ( [ recpptis ] ) will be almost exact @xcite .",
    "the flux factor @xmath135 is the effective flux through @xmath123 of the trajectories coming from @xmath67 ( from @xmath1 ) .",
    "this factor is most conveniently computed with the first two interfaces identical .",
    "although @xmath136 is not well defined for @xmath137 , we can think that @xmath138 in the limit @xmath139 . in this way",
    ", the effective positive flux will be equal to the simple positive flux through @xmath123 ( trajectories can not recross without re - entering @xmath1 , hence , all crossings are counted . ) .",
    "similarly , for the reverse rate @xmath127 we can set @xmath140 . if @xmath123 is chosen close enough to @xmath1 the flux factor can be obtained by straightforward md initialized in @xmath1 and counting the positive crossings through @xmath137 during the simulation run : @xmath141 with @xmath100 the md time step , @xmath142 the number of md steps , and @xmath143 the number of counted positive crossings . to calculate the rate at constant temperature instead of constant energy",
    ", one can apply a nos - hoover @xcite or andersen @xcite thermostat .",
    "however , one should be aware that these thermostats do give the correct canonical distribution at a given temperature , but modify the dynamics in an unphysical way .",
    "hence , static averages @xmath144 will be correct , but time correlation functions @xmath145 most likely not . as @xmath146 is actually a correlation function over a very short time , this effect will be small . however ,",
    "if necessary one can easily correct for this by explicitly counting only phase points @xmath18 that in absence of the thermostat will cross @xmath123 in one @xmath100 time - step . applying this correction is computationally cheap as it does not require any additional force calculations . in appendix",
    "a we describe some possibilities for further optimization of the flux algorithm .      to calculate the conditional probabilities in tis and pptis we use a path sampling algorithm  @xcite . however , there are some differences with the classic tps algorithm .",
    "most importantly , in ( pp)tis the path length is variable , which has a small implication for the acceptance criterion for the shooting move . in appendix",
    "b we derive this acceptance rule for arbitrary ( stochastic or deterministic ) dynamics .",
    "the main tools in the mc sampling of trajectory space are the shooting move and the time - reversal move  @xcite .",
    "in particular for pptis time - reversal moves can be quite effective .",
    "shifting moves that enhanced statistics in tps are not needed and even useless in ( pp)tis .",
    "* tis algorithm : * the quantity of interest in tis is the crossing probability @xmath147 ( or @xmath148 for the reverse rate constant @xmath127 ) . to calculate this probability by sampling in the @xmath64 interface ensemble",
    "one needs an initial path that starts in @xmath1 ( at @xmath67 ) , crosses the interface @xmath64 at least once , and finally ends by either crossing @xmath67 or @xmath149 . in general",
    "one can take simply a successful path from the previous @xmath150 interface ensemble that reached @xmath151 , and complete its evolution till reaching either @xmath1 or @xmath149 . for more details on initial path generation",
    "we refer to ref .",
    "the phase space point @xmath29 is then defined as the first crossing point of this path with interface @xmath64 .",
    "it is convenient to use a discrete time index @xmath152 , and let @xmath153 and @xmath154/\\delta t)$ ] be the backward and forward terminal time slice indices , respectively .",
    "including @xmath29 , the initial path then consists of @xmath155 time slices . choosing a probability @xmath156 and a gaussian width @xmath157 we now start following loop :    * main loop 1 .",
    "take a uniform random number @xmath158 in the interval @xmath159 $ ] .",
    "2 .   if @xmath160 perform a time - reversal move . otherwise , perform a shooting move .",
    "3 .   if the trial path generated by either the time - reversal or shooting move is a proper path in the @xmath64 ensemble accept the move and replace the old path by the new one , otherwise keep the old path .",
    "update averages and repeat from step 1 .",
    "* time - reversal move 1 .",
    "if the current path ends at @xmath149 reject the time - reversal move and return to the main loop .",
    "2 .   if the current path starts and ends at @xmath67 , reverse the momenta and the order of time - slices . on this reverse path",
    ", @xmath29 is the new first crossing point with @xmath64 .",
    "return to the main loop . * shooting move 1 .   on the current path with length @xmath161",
    "choose a random time slice @xmath162 , with @xmath163 .",
    "2 .   change all momenta of the particles at time - slice @xmath164 by adding small randomized displacements @xmath165 with @xmath166 taken from a gaussian distribution with width @xmath157 and @xmath110 the mass of the particle  @xcite .",
    "[ alg1 ] in case of constant temperature ( nvt ) simulations : accept the new momenta with a probability  @xcite : @xmath167 .",
    "\\nonumber\\end{aligned}\\ ] ] here , @xmath168 is the total energy of the system at phase space point @xmath18 . in case of constant energy ( nve ) simulations in which possibly also total linear- or angular momentum",
    "should be conserved : rescale all the momenta of the system according to the procedure described in ref .",
    "@xcite and accept the new rescaled momenta .",
    "+ if the new momenta are accepted continue with step 4 , else reject the whole shooting move and return to the main loop .",
    "4 .   take a uniform random number @xmath169 in the interval @xmath159 $ ] and determine a maximum allowed path length for the trial move by : @xmath170 5 .",
    "integrate equations of motion backward in time by reversing the momenta at time slice @xmath162 , until reaching either @xmath67 , @xmath149 or exceeding the maximum path length @xmath171 .",
    "if the backward trajectory did not reach @xmath67 reject and go back the main loop .",
    "otherwise continue with step 6 .",
    "integrate from time slice @xmath162 forward until reaching either @xmath67 , @xmath149 or exceeding the maximum path length @xmath171 .",
    "reject and go back to the main loop if the maximum path length is exceeded or if the entire trial path has no crossing with interface @xmath64 .",
    "otherwise continue with the next step .",
    "7 .   accept the new path , reassign @xmath29 to be the first crossing point with @xmath64 and return to the main loop .",
    "finally , the probability @xmath147 follows from : @xmath172 with @xmath173 the number of sampled paths that connect @xmath67 with @xmath149 and @xmath174 the total number sampled paths in the ensemble of interface @xmath151 .",
    "time reversal moves do not require any force calculations .",
    "on the other hand two subsequent time reversals will just result in the same path .",
    "therefore , we usually take @xmath175 giving shooting and time reversal move an equal probability .",
    "similar reasoning is applied to the choice of @xmath157 .",
    "if @xmath157 is large , many trial moves will fail to create a proper path . on the other hand a too small value of @xmath157 will result in almost the same path .",
    "practice has shown that an optimal value of @xmath157 is established when approximately @xmath176 of the paths is accepted  @xcite .",
    "this will usually imply that @xmath157 will be larger for the interfaces @xmath64 close to @xmath1 than the ones closer to @xmath2 .",
    "the mass weighted momenta change at step 2 of the shooting algorithm is chosen such that the velocity rescaling at step 3 maintains detailed balance @xcite . in principle",
    ", nvt simulations do not require rescaling and @xmath177 can be taken from any symmetric distribution .",
    "the integration of the equations of motion at step 5 and 6 of the shooting move are normally performed by constant energy md simulations without using a thermostat to describe the actual dynamics as realistic as possible .",
    "the temperature only appears at the acceptance criterion at step 3 . in this algorithm",
    "we go from one phase point @xmath178 to a new one @xmath179 by means of many md steps .",
    "therefore , it has a strong similarity with hybrid mc @xcite .",
    "hence , the argument that the dynamics should be time reversible and area preserving @xcite should also be applied here . for this reason ,",
    "we strongly advice to use the velocity verlet @xcite algorithm rather than higher order schemes such as runga - kutta .",
    "the maximum allowed path length @xmath171 in step 4 is introduced to maintain detailed balance when sampling paths of different length and to avoid having to reject very long trial paths afterward @xcite .",
    "* pptis algorithm : * the four one - interface probabilities @xmath180 , and @xmath181 for a single interface @xmath64 can be calculated simultaneously @xcite with paths that start at @xmath150 or @xmath149 and end by crossing either @xmath150 or @xmath149 .",
    "all paths should have at least one crossing with @xmath64 .",
    "hence , @xmath182/\\delta t)$ ] and @xmath183/\\delta t)$ ] .",
    "the path sampling is then identical to the tis algorithm except that @xmath150 is used instead of @xmath67 , time reversal moves are always accepted and the backward integrating at step 5 is not rejected when reaching @xmath149 as paths may start from both sides .",
    "the one - interface crossing probabilities are then given by @xmath184      the order parameter @xmath4 in tps and tis does not have to correspond to a reaction coordinate that captures the essence of the reaction mechanism .",
    "the only requirement is that @xmath4 can distinguish between the two basins of attraction . in tis",
    "this occurs via the two outer interfaces @xmath67 and @xmath68 that define state @xmath1 and @xmath2 .",
    "the definitions of @xmath1 and @xmath2 are more strict than in tps @xcite . the boundaries @xmath67 and",
    "@xmath68 should be defined such that each trajectory between the stable states is a rare event for the reaction we are interested in .",
    "in addition , the probability that after this event the reverse reaction occurs shortly thereafter must be as unlikely as an entirely new event .",
    "in other words , a trajectory that starts in @xmath1 and ends in @xmath2 is allowed to leave region @xmath2 shortly thereafter , but the chance that it re - enters region @xmath1 in a short time must be highly unlikely .",
    "sometimes it is not sufficient for a proper definition of the boundaries @xmath67 and @xmath68 to only use configuration space . in the dimer study of ref .",
    "@xcite an additional kinetic energy constraint was introduced to ensure the stability of state @xmath1 and @xmath2 .",
    "the intermediate interfaces can be chosen freely and should be placed to optimize the efficiency .",
    "this is , of course , system dependent , but reasonable estimates can be made a priori .",
    "let us write down the total computation time as @xmath185 with @xmath186 the number of windows ( interface ensembles ) , @xmath187 the number of paths in the ensemble of interface @xmath69 required to obtain a desired precision @xmath188 , and @xmath189 the average path length . here , we neglect the influence of rejections and the fact that two successive pathways in the mc sequence are not completely uncorrelated .",
    "we chose the interface separations and the number of paths such that @xmath190 and @xmath191 , resulting in @xmath192 for all @xmath69 .",
    "the total error @xmath193 , that we fix , is related by @xmath194 with @xmath195 . hence , @xmath196 yielding @xmath197 .",
    "the number of windows follows from @xmath198 . except for diffusive barrier crossings  @xcite , that are most conveniently treated by pptis",
    ", the average path length @xmath189 has a linear dependence @xmath199  @xcite . taking this all into account",
    ", the final result gives @xmath200 that has a minimum for @xmath201 .",
    "although , we made several assumptions in this derivation , we believe that in general @xmath202 for all @xmath69 is close to an optimum efficiency .    between the interface positions one can use of a finer grid of sub - interfaces to obtain the crossing probability function @xmath203 @xcite which is the path space analogy to a landau free energy profile @xmath14 .",
    "for pptis different requirements exist for the position of interfaces .",
    "as the pptis formalism is based on a complete memory loss over distances larger than the interface separations , the pptis interfaces should be set sufficiently far apart .",
    "the calculation of memory loss functions can help to determine the minimum required distance to establish this @xcite .",
    "we would like to stress that although pptis transforms the system into a ( pseudo ) markovian hopping sequence based on local transition probabilities , it still maintains considerable history dependence .",
    "for example , the chance to go from interface @xmath69 to interface @xmath204 is assumed to be equal for the path that arrived at @xmath69 via the sequence @xmath205 or via the sequence @xmath206 .",
    "however , this transition to @xmath204 from @xmath69 can still be different when its history had hopping sequence @xmath207 .",
    "biased sampling methods such as constrained dynamics  @xcite , multicanonical  @xcite or umbrella sampling @xcite can suffer from substantial ergodicity problems when the order parameters are not equal to the reaction coordinate .",
    "this lack of ergodicity usually shows up in hysteresis in the free energy curves ( see e. g.  @xcite ) , and gives , besides a low transmission coefficient , rise to an additional error in the rate constant estimate .",
    "transition path sampling was precisely devised to avoid this problem with reaction coordinates , and , in a way , also avoids ergodicity problems due to the non - local nature of the shooting move .",
    "this advantage showed up in the water trimer study @xcite where the tps algorithm was capable of finding two reaction mechanisms across different saddle points separated by a barrier higher than the total energy of the nve simulation .",
    "we stress that this would have been much more difficult to achieve or even impossible in an umbrella sampling algorithm with several narrow windows .",
    "however , path sampling can also suffer from ergodicity problems if large barriers separate multiple reaction channels in a high dimensional rough energy landscape .",
    "in particular in the case of pptis , the short paths are much less likely to overcome such barriers .",
    "parallel tempering techniques ( also known as replica exchange methods ) can facilitate the sampling @xcite , but requires a rather large computational effort and can not be applied at constant energy . here , we propose a less expensive parallel method especially tailored for pptis to enhance ergodicity .",
    "this parallel path swapping ( pps ) technique is based on the exchange of paths between two subsequent interface ensembles .",
    "ensemble and the first half of the path in the @xmath149 are swapped to the @xmath149 and @xmath151 ensembles , respectively.,width=377 ]    fig .",
    "[ figpathswap ] shows one path in the @xmath64 ensemble , consisting of all possible paths crossing @xmath64 while starting and ending at either @xmath208 or @xmath149 , and one in the @xmath149 ensemble consisting of all paths crossing @xmath149 at least once , while starting and ending at either @xmath64 or @xmath209 .",
    "we introduce a new mc move that attempts swapping the current path of the @xmath64 ensemble with that of the @xmath149-ensemble , as depicted in fig .",
    "[ figpathswap ] . the swap move will be rejected if the @xmath64 ensemble path does not end at @xmath149 or if the @xmath149 ensemble path does not start at @xmath64 .",
    "otherwise , the move is accepted and the two trajectories are swapped from one ensemble to the other . integrating the equations of motion backward ( for the @xmath64 ensemble ) and forward ( for the @xmath149 ensemble )",
    "will result in two entirely new paths for both ensembles .",
    "the acceptance / rejection criterion appears before any expensive computation of md trajectories .",
    "moreover , once accepted we obtain a new path for both ensembles for price of effectively only one path .",
    "this makes the path swapping move useful even if for systems not suffering from ergodicity problems .",
    "another advantage of pps is that it allows to go beyond the pseudo - markovian description of pptis .",
    "[ figpathswap ] shows that the paths at the right hand side , if we include the dashed trajectory part , can connect four interfaces instead of only three .",
    "this extension allows for a long range verification of the memory loss assumption .",
    "also , the development of new , smart algorithms based on pps might be able to correct for memory effects or to search for ideal interface positions on the fly .",
    "while pps is very effective when the confinement of short paths in pptis can cause sampling problems , even tis and tps algorithms might benefit from path swapping when multiple reaction channels exist .",
    "originally developed to sample polymers at high densities , the configurational bias monte carlo ( cbmc ) technique grows chain molecules in a biased fashion in order to avoid unfavorable overlap of the beads  @xcite .",
    "the similarity between growing polymers and generating dynamical trajectories was the inspiration for the development of tps and has been exploited in the sampling of the stochastic path action  @xcite .",
    "this cbmc - like technique was found to be less effective than the shooting algorithm  @xcite . here",
    ", we propose a combination of the shooting move with cbmc for diffusive systems that suffer from low acceptance due to a non flat rough free energy barrier .",
    "when shooting from one basin of attraction in such systems , the lyapunov instability causes the paths to diverge and return to the same basin of attraction before crossing the barrier .",
    "the use of some stochastic noise allows shooting in only one time direction and alleviates this problem slightly  @xcite , but at the price that independent pathways are generated only after a number of accepted shooting moves from the barrier region .",
    "this slow exploration of path space is even worse for processes proceeding via multiple dynamical bottlenecks , for instance reactions taking place though a short lived intermediate state    within the shooting algorithm , cbmc can be applied both at the shooting point ( the random time slice for which we change the momenta ) and along the path by introducing some stochastic noise . at the shooting point",
    "@xmath162 we generate a set of @xmath210 momenta displacements @xmath211 , and accept these displacements using step 3 in sec .",
    "[ secshooting ] .",
    "each phase point is then integrated forward and backward for a time @xmath212 , resulting in @xmath210 trajectory segments @xmath213 , for @xmath214 ( see fig .",
    "[ figcbmc]-a ) .",
    "the time interval @xmath212 should be large enough to decide whether a trajectory has a chance of being successful , but much smaller than the average path length of a complete trajectory .",
    "all path segments are given a weight @xmath215 @xmath216 where @xmath217 equals 1 ( else 0 ) for accepted momenta changes @xmath177 at the shooting point @xmath162 .",
    "the biasing function @xmath218 should be chosen to give the highest weight @xmath215 to those segments that are most likely to produce a complete path of the corresponding interface ensemble .",
    "one possibility is to choose @xmath219 with @xmath220 and @xmath221 a parameter optimized to the steepness of the barrier at @xmath222 . in that case",
    ", @xmath218 is a function only of the backward and forward end points of the path segments @xmath223 .",
    "the rosenbluth factor for the set of trajectory segments is @xmath224 one of the segments @xmath225 is selected with a probability @xmath226 . to correct for this bias and to obey detailed balance , we also have to calculate the rosenbluth factor @xmath227 for the old path .",
    "the procedure is the same as above , but now we apply @xmath228 new random momenta changes @xmath229 to the momenta of @xmath225 at the same shooting point and again generate a set of segments of length @xmath230 .",
    "this set is completed by adding segment @xmath231 of the same length from the old path .",
    "the rosenbluth factor for the old path equals @xmath232 where @xmath233 is the weight of segment @xmath231 , and @xmath234 with @xmath235 are the weights for the segments that follow from @xmath236 .    by imposing super detailed balance @xcite",
    "the acceptance probability of segment @xmath69 becomes @xmath237 .",
    "\\label{cbmcshoot}\\end{aligned}\\ ] ] here , the weight functions @xmath238 and the distributions @xmath239 are still present , because they do not cancel as in the standard cbmc expression .",
    "the accepted segment is integrated to the complete path just as in the normal shooting move of sec .",
    "[ secshooting ] . of course",
    ", this procedure is computationally more expensive than the standard shooting move .",
    "however , the biasing function @xmath218 allows to choose a segment with much higher probability to become a accepted path .",
    "we expect an increase in sampling efficiency when the gain in acceptance outweighs the cost of the construction of the trajectory segment sets .    in the above algorithm",
    "we only can bias the growth of the first segment of the trajectory ( the analog of the polymer in standard cbmc ) because the rest of the trajectory follows deterministically once the first segment has been chosen . in the standard polymer cbmc",
    "a bias is introduced at each segment , and we can make use of the full power of cbmc if we consider stochastic trajectories .",
    "introducing a small amount of stochasticity by for instance the andersen thermostat @xcite or by making use of the periodic boundary condition@xcite will hardly change the dynamical properties of the transition process .",
    "stochasticity allows us to create trajectory jets at several points along the paths ( see fig .",
    "[ figcbmc]-b ) .",
    "the first segment is created as in the deterministic procedure above . however , the chosen segment is not integrated to the full path length .",
    "instead , we start with the end point of the forward trajectory and integrate a jet of forward trajectory segments each evolving differently according to its own random noise .",
    "each segment @xmath77 of this jet @xmath240 has a weight @xmath241 similar to eq .",
    "( [ cbmcweight ] ) and each jet will have a total weight @xmath242 .",
    "we select a segment @xmath69 according to its relative weight @xmath243 , and continue with the next jet of forward segments .",
    "the same is done for the backward paths , until the path is completed . after generating the new path",
    ", we have to repeat the jet procedure for the old path as depicted in fig .  [ figcbmc ] in order to calculate the rosenbluth factor of the old path .",
    "the total rosenbluth factors are now @xmath244 where @xmath240 runs over all the jets including the one at the shooting point @xmath222 .",
    "the final acceptance criterion obeying super detailed balance is then @xmath245\\end{aligned}\\ ] ] where @xmath246 is the segment weight at jet @xmath240 on the old path and @xmath247 is the weight of the selected segment of jet @xmath240 on the new path . to take into account the change in path - length",
    "one should include a factor @xmath248 $ ] , but this is usually implemented by defining a maximum path length as explained at step 4 of the shooting algorithm in sec .",
    "[ secshooting ] .",
    "the above algorithm could be useful when the standard shooting move suffers from extreme low acceptance ratios .      in tis",
    "the choice of the order parameter is not critical as @xmath4 does not have to correspond to the reaction coordinate .",
    "yet , it is possible that the order parameter @xmath4 can bias the outcome of transition mechanism and rate constants  although much less than for the tst reactive flux method , for instance , when the reaction mechanism leads in a direction that @xmath4 does not allow . in principle , an order parameter - free sampling method is , therefore , highly desirable when examining unexpected contra - intuitive reaction mechanisms .",
    "one possibility for such a bias - free method is by using the time on the path outside @xmath1 as transition parameter ( we use transition instead of order to indicate that it is not a traditional order parameter as it is not based on a phase point ) .    for a particular stable state",
    "@xmath1 definition @xmath67 , @xmath249 is the probability that a path , starting from @xmath67 and remaining outside @xmath1 over a time @xmath250 , remains even longer outside @xmath1 until at least @xmath251 . to calculate the probability @xmath249 by a bias - free tis simulation we generate an ensemble of trajectories that have path lengths between @xmath252 and @xmath253 using the shooting algorithm of sec .",
    "[ secshooting ] . at the shooting point , we integrate backward until reaching @xmath67 or until the length of the trial trajectory exceeds @xmath253 ( or @xmath254 as defined at step 4 of the shooting algorithm ) . if the backward trajectory exceeds either @xmath253 or @xmath254 the shooting move is rejected .",
    "the forward trajectory is continued until reaching @xmath67 , or until a path length of @xmath255 or @xmath254 .",
    "the trial path is rejected if @xmath254 is exceeded or if the trajectory ends at @xmath67 in a time shorter than @xmath250 . in the subsequent ensemble",
    ", the probability @xmath256 for @xmath257 is calculated for all paths with at least a length @xmath253 .",
    "this method , as illustrated in fig .",
    "[ figtimepar ] ,    .",
    "the thin lines are free energy contour lines .",
    "the four panels show the representation of generated trajectories in successive time - interface ensembles . at panel 1 ) , @xmath249 is the fraction of of trajectories that stay outside @xmath1 longer than @xmath253 ( open arrows ) .",
    "all trajectories have at least a length @xmath250 .",
    "the solid arrows are the paths that return to @xmath1 before @xmath253 . at panel 2 ) , @xmath256 is calculated for paths that remain outside @xmath1 longer than @xmath253 .",
    "the minimum length of the paths is further increased at panel 3 ) . incidentally",
    ", a path will end up in the yet unknown state @xmath2 . at panel 4 ) the minimum path length constraint forces all the paths into the metastable state region @xmath2 . from here , they will not return .",
    "hence @xmath258 will show a plateau.,width=377 ]    will thus explore automatically the regions further and further outside @xmath1 . at some moment",
    "it will find the closest stable state region ( state @xmath2 ) .",
    "trajectories reaching this region will not go back to @xmath1 , hence , the overall crossing probability function @xmath258 will show a plateau at some time @xmath259 similar to standard tis .",
    "two - ended path sampling methods , such as tis , pptis and tps can only treat processes in which both stable states @xmath1 and @xmath2 are known .",
    "they can not find the final state starting from a single stable state , a fact already discussed by dellago and chandler @xcite .",
    "the algorithm described here , might be a solution to this problem .",
    "the ensemble of paths collected by the tis algorithm can be used to investigate the reaction mechanism .",
    "we believe that for this purpose the tis path ensembles might even be more useful than the tps path ensembles .",
    "the tps method , first samples paths that all successfully reach @xmath2 in the part to obtain the reactive flux function and then in the second step samples artificially short trajectories of fixed length to calculate the time correlation function c(t ) .",
    "because of this constraint , the resulting ensembles do not give useful information about the reaction .",
    "the tis @xmath64-ensembles , on the other hand , contain the correct distribution of paths that have crossed @xmath64 and are either going on to @xmath149 or return to a. some hidden order parameters can only be discovered by carefully comparing configurations along reactive and unreactive trajectories that are similar in terms of order parameters which at first sight were considered as being the ( only ) important ones .",
    "for instance , the comparison of reactive and unreactive geometries with an almost identical orientation of the reactants showed that precise tetrahedral ordering of the solvent water molecules was an important factor in the hydration reaction of ketones @xcite .",
    "although there is currently no systematic way to extract the reaction coordinates from a path ensemble , once a reaction coordinate is postulated based on physical insight it can be tested using committor distributions  @xcite .",
    "the activation energy @xmath260 is an important experimentally accessible quantity and is defined by the arrhenius law @xmath261 where a is a system dependent prefactor .",
    "in fact , @xmath1 and @xmath260 may also be temperature dependent",
    ". such non arrhenius behavior can be quite severe : sometimes reaction rates are even decreasing with increasing temperature , resulting in a negative activation energy ( see e.g. @xcite ) .",
    "> from eq .",
    "( [ arrhenius ] ) it follows that @xmath262 an algorithm to calculate @xmath260 in a tps simulation was given in ref .",
    "@xcite . here",
    ", we use a similar approach to calculate @xmath260 in a canonical tis simulation .",
    "substitution of eq .",
    "( [ kabphip ] ) in eq .",
    "( [ eader ] ) results in @xmath263 \\label{acten1}\\end{aligned}\\ ] ] for any function @xmath264 we can write @xmath265 with @xmath266 . using @xmath267 most terms in eq .",
    "( [ acten1 ] ) cancel , only leaving @xmath268 which is the difference between the average energy of state @xmath1 and the energy of the transition pathways connecting @xmath1 with @xmath2 .",
    "consequently , the calculation of the @xmath260 does not require all interface ensembles , but only the last ensemble @xmath269 .",
    "however , if all the path ensembles @xmath270 are available an activation energy function @xmath271 can be calculated that should converge to a plateau analogous to the crossing probability @xmath272 .",
    "a finer grid of sub - interfaces can be applied to obtain a continuous smooth function @xmath273 .",
    "again , there is a subtle difference between the tps and tis algorithms . for the reaction rate determination",
    ", tps requires a plateau in the time correlation function of eq .",
    "( [ corrtps ] ) , while tis should give a plateau in @xmath4 for the crossing probability @xmath272 .",
    "similarly , the tps activation energy is expressed as a time dependent function that will converge to a plateau at times @xmath274 @xcite , while the tis activation energy reaches a plateau in terms of @xmath4 .",
    "not all reactions show arrhenius behavior .",
    "therefore , it would be interesting to determine @xmath275 for a range of temperatures .",
    "one can estimate the rate for a slightly different temperature by reweighting the crossing probabilities@xcite .",
    "if @xmath144 is the average of an observable @xmath264 at inverse temperature @xmath276 , then @xmath277 should be the average at inverse temperature @xmath278 .",
    "this reweighting technique can also be applied to the crossing probabilities  ( [ p4int ] ) and the flux  ( [ flxmd ] ) . of course",
    ", @xmath279 should be small to obtain good enough statistics .",
    "the calculation of the temperature dependence of individual crossing probabilities has the advantage that the origin of possible non - arrhenius behavior might be located ( in terms of @xmath4 ) along the reaction path .",
    "we reviewed the basic concepts of tis and pptis and explained their relation to tst based methods and tps .",
    "we believe that path sampling methods , tps , tis and pptis , are powerful when dealing with high dimensional complex process for which is a reaction coordinate is lacking . among these methods , tis can be considered as an improvement upon the original tps giving a complete non - markovian description of the reactive event , but more efficient .",
    "pptis improves the efficiency even more , but relies on the assumption of memory loss between interfaces .",
    "hence , it should only be applied for diffusive barrier crossings .",
    "in addition to this review , we have introduced several new techniques in this paper .",
    "these novel methods comprise the cbmc based shooting moves , order parameter free methods , parallel path swapping and the calculation of activation energies .",
    "the efficiency of these methods should be tested by future simulations .",
    "we plan study this in the near future .",
    "we thank daniele moroni for useful discussions and carefully reading this article .",
    "t.s.v.e acknowledges the support by a marie curie intra - european fellowships ( meif - ct-2003 - 501976 ) within the 6th european community framework programme and the support through the european network locnet hprn - ct-1999 - 00163 .",
    "p.g.b acknowledges support from the fom ( stichting fundamenteel onderzoek der materie ) .",
    "in some cases , we can improve the efficiency of the flux calculation by separating the flux into the probability to be on the @xmath123 surface times a factor integrating over all possible velocities when leaving the surface .",
    "the flux term can then be calculated by combining straightforward md with , as soon as we cross the @xmath123 surface , the sampling of sets of randomized gaussian distributed velocities @xmath280 , after which the md trajectory is continued with the old original momenta . in this way , we make optimal use of the statistics of the crossing points",
    ". the velocity sampling does not require force calculations and is therefore cheap .",
    "in the following we assume that we always take @xmath137 .",
    "similar to eq .",
    "( [ ratetst ] ) we can write : @xmath281 with @xmath282 the two terms @xmath283 and @xmath284 can be obtained in the same md simulation .",
    "as @xmath285 is equal to the probability to find the system in the interval @xmath286 $ ] , it can be measured by defining a width @xmath287 and performing a md ( or mc ) simulation starting in @xmath1 : @xmath288 with @xmath289 the number of counts in the specified interval and @xmath142 the number of md steps . however , this number can depend sensitively on the choice of bin width @xmath287",
    ". ideally one would like @xmath287 to be as small as possible , at the cost of having to perform a very long simulation run for a statistically accurate number @xmath289 .",
    "a better option is to weigh the crossings with a function depending on the velocity .",
    "assume that we cross @xmath123 in one md step from @xmath290 to @xmath291 .",
    "if @xmath287 is small neither of these points will lie inside the interval .",
    "however , assuming a linear dynamics between these points , the system traverses from @xmath290 to @xmath291 in @xmath292 equidistant sub steps .",
    "the number of phase points @xmath289 that lie in the @xmath287 interval of this short linear trajectory is approximately latexmath:[$d \\lambda n_\\textrm{sub}/     number of md moves @xmath142 , of course , also increases by a factor @xmath292 .",
    "so eq . (  [ eq : pl ] ) becomes @xmath294 where the @xmath295 indicates that the summation has to be performed only for points @xmath69 along the trajectory for which @xmath296 showed a crossing ( positive or negative ) with interface @xmath123 .",
    "further optimization can be achieved by writing @xmath297 , but the velocity @xmath280 at the interface would give the most exact result . if we also assume a linear change in time for the velocities between @xmath69 and @xmath204 , our best estimate for @xmath284 is : @xmath298 where we have introduced the notation @xmath299 to denote the function @xmath300 at the crossing point of interface @xmath102 obtained by a linear interpolation of the function between two successive trajectory points @xmath301 : @xmath302    g(x_{i\\delta t } ) + [ \\lambda_j-\\lambda(x_{i\\delta t } ) ] g(x_{(i+1)\\delta t } ) \\big\\ } \\nonumber \\\\\\end{aligned}\\ ] ] the factor @xmath303 in eq .",
    "( [ eq : c1 ] ) can be calculated in the same md simulation with an additional sampling procedure . in some simple cases",
    ", there is even an analytically expression .",
    "for instance , in case the @xmath18-coordinate of particle @xmath77 is the order parameter , @xmath304 in a constant temperature ( nvt ) simulation , we would obtain @xmath305 with @xmath306 the mass of this particle .",
    "however , for more complex @xmath5 , such as the distance between two particles @xmath69 and @xmath77 , @xmath307 , no simple analytic expression exists .",
    "the calculation of @xmath303 can then be calculated by sampling a random set of @xmath308 velocities @xmath280 as soon as a crossing is detected : @xmath309 } { n_\\textrm{mc } { \\sum_i}^ *    \\big [ \\frac{1}{|\\dot{\\lambda}(x_{i \\delta t};\\lambda_1)| }   \\big ] } \\label{samplemdmc}\\end{aligned}\\ ] ] where @xmath69 runs over all md crossings with interface @xmath123 , @xmath310 is the md crossing velocity through @xmath123 , @xmath77 runs over the @xmath308 artificial velocities @xmath311 that are taken from a proper distribution @xmath312 . for nvt simulations without additional constraints",
    "this distribution @xmath312 does not depend on the phase point @xmath290 and we can simply sample @xmath313 where the momenta @xmath314 defining @xmath280 are taken from a gaussian distribution for nve simulations , the distribution @xmath312 does depend @xmath290 and we have to change all momenta and distribute them on the hypersphere defined by the kinetic energy @xmath315 with @xmath316 the total energy and @xmath317 the total potential energy at the crossing point . the proper sampling of momenta distributions in the presence of linear constraints , such as linear and angular momentum is explained in ref .",
    "@xcite . clearly , if @xmath318 , eq .",
    "( [ samplemdmc ] ) would be equal to @xmath319 leaving eq .",
    "( [ flx2 ] ) identical to eq .",
    "( [ flxmd ] ) from which we started .",
    "although we assume throughout the paper that the equations of motion were deterministic , it is sometimes useful to implement some stochasticity into the dynamics , or consider completely stochastic equation of motion such as brownian dynamics @xcite .",
    "quantities like @xmath320 are , then , no longer just 1 or 0 but turn into probabilities with a fractional value . moreover , for stochastic dynamics it is not trivial whether we are allowed to use the path that generated @xmath178 as our instrument to search for the new phase point @xmath179 . in this appendix",
    "we derive the acceptance probability for the shooting algorithm for arbitrary dynamics along the same lines as in ref .  @xcite . at start",
    ", we try to be as general as possible making the least possible assumptions on the type of dynamics or on whether the system is in equilibrium or not . for this purpose",
    ", it is most convenient to use the path space description , instead of phase space .",
    "the weight or probability density @xmath321 $ ] for a single path @xmath322 is than not only determined by the distribution @xmath323 of @xmath29 , but also by the probabilities of arriving along this precise route from @xmath324 in the past and continuing upto @xmath325 in the future .",
    "@xmath326=\\rho(x_0 ) \\prod_{i=-1}^{-\\tau^b } p(x_{(i+1 ) \\delta t}\\leftarrow x_{i\\delta t } ) \\prod_{i=1}^{\\tau^f } p(x_{(i-1 ) \\delta t}\\rightarrow x_{i\\delta t})\\ ] ] where @xmath327 is the forward transition probability ( more accurate : probability density ) to go from @xmath18 to @xmath328 and @xmath329 is the probability that , if the system is at @xmath328 , it came from @xmath18 in the past . here , @xmath323 is not necessarily the boltzmann distribution or even a distribution in equilibrium .",
    "it is applicable to all systems that ( at least to some approximation ) are described by a steady state .",
    "we can express @xmath329 in terms of forward transition probabilities as @xmath330 where @xmath331 results from the steady state behavior . using this relation",
    ", one can show that eq .",
    "( [ equ : weight0 ] ) is exactly equal to the probability of the first point @xmath332 times the forward evolution probabilities @xmath333=\\rho(x_{-\\tau^b \\delta t } ) \\prod_{i=-\\tau^b}^{\\tau^f-1 } p(x_{i \\delta t}\\rightarrow x_{(i+1)\\delta t})\\ ] ] which is identical to the weight for a path in the tps - ensemble @xcite with @xmath324 instead of @xmath29 .",
    "note that so far , we have assumed nothing about the nature of dynamics ( irreversible or reversible , stochastic or deterministic ) .",
    "when restricted to the tis ensemble for interface @xmath69 , the probability density of a path can be written as @xmath334\\equiv   \\hat{h}_i({\\bf x } )   { \\mathcal p}[{\\bf x } ] / z(\\lambda_i)\\ ] ] where @xmath335 is unity if the path goes from @xmath67 , crosses @xmath64 and ends either at @xmath336 or goes back to @xmath67 .",
    "otherwise it is zero .",
    "the normalizing factor @xmath337 equals @xmath338\\ ] ] where the integral is taken over all possible paths @xmath339 of all lengths , starting in all possible initial conditions @xmath340 .",
    "note that , contrary to tps , eq .  ( [ equ : weight ] ) and eq .",
    "( [ equ : tpe ] ) are not directly related to the relative probabilities of all paths in the tis ensemble .",
    "this is a result of the path ensemble containing paths of different lengths .",
    "( [ equ : weight ] ) turns into a true probability only when multiplied with the infinitesimal volume element in path space @xmath341 .",
    "hence , a long path has an infinitely smaller probability than a shorter one for stochastic dynamics .",
    "therefore , the concept of path space may sound peculiar for tis . still , it is instrumental to derive proper acceptance rules for tis obeying detailed balance .    when performing the random walk in the tis path space using the shooting algorithm , the detailed balance condition is @xmath342 } { p_\\textrm{gen}[{\\bf x}^{\\rm ( n ) } \\rightarrow { \\bf x}^{\\rm ( o ) } ] } \\frac{p_\\textrm{acc}[{\\bf x}^{\\rm ( o ) } \\rightarrow { \\bf x}^{\\rm ( n ) } ] } { p_\\textrm{acc}[{\\bf x}^{\\rm ( n ) } \\rightarrow { \\bf x}^{\\rm ( o)}]}= \\frac{{\\mathcal p}_{\\lambda_i}[{\\bf x}^{\\rm ( n)}]}{{\\mathcal p}_{\\lambda_i}[{\\bf x}^{\\rm ( o ) } ] } \\label{detbalpath}\\end{aligned}\\ ] ] where o and n , denote the old and new path respectively .",
    "the usual metropolis acceptance rule is then @xmath343   =   \\hat{h}_i({\\bf x}^{\\rm ( n ) } )   \\min\\left [ 1 , \\frac{{\\mathcal p}_{}[{\\bf x}^{\\rm ( n)}]}{{\\mathcal p } _ { } [ { \\bf x}^{\\rm ( o ) } ] } \\frac{p_{\\rm gen}[{\\bf x}^{\\rm ( n ) }   \\rightarrow { \\bf x}^{\\rm ( o ) } ] }   { p_{\\rm gen}[{\\bf x}^{\\rm ( o ) } \\rightarrow { \\bf x}^{\\rm ( n ) } ] }   \\right ] , \\label{equ : acceptance}\\end{aligned}\\ ] ] note that this rule only applies at the trajectory space level , it has nothing to do with whether the underlying dynamics is stochastic or deterministic , or even reversible or irreversible .",
    "the generation probability to create a new path from an old path using the shooting move is given by @xmath344 ) ] } & = &   \\frac{p(\\delta p)}{n^{\\rm ( o ) } }       p_{\\rm gen}^{\\rm f } [ { \\bf x}^{\\rm ( o ) } \\rightarrow { \\bf x}^{\\rm ( n ) } ] p_{\\rm gen}^{\\rm b}[{\\bf x}^{\\rm ( o ) } \\rightarrow { \\bf x}^{\\rm ( n ) } ] \\label{pgen}\\end{aligned}\\ ] ] where @xmath345 is the chance to choose the shooting point @xmath162 with @xmath346 ) at the old path , @xmath347 the chance to select the randomized momenta displacements .",
    "as @xmath177 is normally taken from a symmetric distribution , hence @xmath348 , this term will cancel in eq .",
    "( [ equ : acceptance ] ) . the last two factors in eq .",
    "( [ pgen ] ) are the probabilities to generate trajectories from the shooting point point @xmath162 with the new momenta .",
    "these generation probabilities are given by the underlying dynamics used to generate the trajectories .",
    "if one starts from a shooting point at @xmath349 on the old existing path ( with @xmath350 ) the generation probability for the forward segment is @xmath351   = \\prod_{i=\\tau^\\prime}^{\\tau_f^{\\rm ( n ) } -1 } p\\left(x_{i\\delta t}^{\\rm ( n ) } \\rightarrow x_{(i+1)\\delta t}^{\\rm ( n)}\\right).\\ ] ] this generation probability is exactly identical to the weight of the forward segment .",
    "the integration of the backward segment is not always trivial especially when dealing with irreversible processes .",
    "however , in general , when reversible dynamics is applied , the backward segment is obtained by reversing the momenta , integrating forward in time and reversing the momenta again  @xcite .",
    "accordingly , the backward segment s generation probability equals @xmath352 = \\prod_{i=-\\tau_b^{\\rm ( n)}}^{\\tau^\\prime -1 }   p \\left ( \\bar x_{(i+1)\\delta t}^{\\rm ( n ) } \\rightarrow \\bar x_{i\\delta t}^{\\rm ( n)}\\right).\\ ] ] where @xmath353 for a phase point @xmath354 . using these generation probabilities and the path weight eq .",
    "( [ equ : weight ] ) the factor within the min function of eq  ( [ equ : acceptance ] ) can be written as @xmath355 p_{\\rm gen}[{\\bf x}^{\\rm ( n ) } \\rightarrow { \\bf x}^{\\rm ( o ) } ] } { { \\mathcal p}[{\\bf x}^{\\rm ( o ) } ] p_{\\rm gen}[{\\bf x}^{\\rm ( o ) }   \\rightarrow { \\bf x}^{\\rm ( n ) } ] } = \\frac{\\rho [ x_{-\\tau_b^{\\rm \\rm ( n ) } } ] n^{\\rm ( o ) } } { \\rho [ x_{-\\tau_b^{\\rm ( o ) } } ] n^{\\rm ( n ) } } \\times }   \\\\ & & \\prod_{i=-\\tau_b^{\\rm ( n)}}^{\\tau ' - 1}\\frac{p [ x_{i\\delta t}^{\\rm ( n ) } \\rightarrow x_{(i+1)\\delta t}^{\\rm ( n ) } ] } { p [ \\bar x_{(i+1)\\delta t}^{\\rm ( n ) } \\rightarrow \\bar x_{i\\delta t}^{\\rm ( n)}]}\\prod_{i=-\\tau_b^{\\rm ( o)}}^{\\tau ' - 1}\\frac { p [ \\bar x_{(i+1)\\delta t}^{\\rm ( o ) } \\rightarrow \\bar x_{i\\delta t}^{\\rm ( o)}]}{p[x_{i\\delta t}^{\\rm ( o ) } \\rightarrow x_{(i+1)\\delta t}^{\\rm ( o ) } ] } .\\nonumber\\end{aligned}\\ ] ] where the generation probability and the weight of the forward parts of the trajectories have canceled each other .",
    "( [ equ : weight ] ) simplifies tremendously for dynamics that obey the microscopic reversibility condition  @xcite @xmath356 this condition can be seen as a special case of eq .",
    "( [ equ : ptilde ] ) for time - reversible dynamics with @xmath357 , but is very general and valid for a broad class of dynamics applying to both equilibrium and non - equilibrium systems . as result , if the microscopic reversibility condition  ( [ equ : fw_bw ] ) is satisfied and thus @xmath358 , almost all terms in eq .",
    "( [ equ : ratio_back ] ) cancel , except for the steady state distributions @xmath359 of the shooting points .",
    "@xmath343= \\hat{h}_i({\\bf x}^{\\rm ( n ) } )   \\min\\left[1,\\frac{\\rho(x_{\\tau'}^{\\rm ( n)})}{\\rho ( x_{\\tau'}^{\\rm ( o ) } ) }   \\frac { n^{\\rm ( o)}}{n^{\\rm ( n ) } } \\right ] .",
    "\\label{equ : acceptance_shoot_asymm}\\end{aligned}\\ ] ] which is exactly the same as for deterministic dynamics .",
    "this is an important result as it allows to perform the acceptance / rejection rule ( step 3 of sec .  [ secshooting ] ) for the new momenta at the shooting point even if the energy along the path changes giving a different weight to @xmath360 as to @xmath361 .",
    "the ratio @xmath362 in eq .",
    "( [ equ : acceptance_shoot_asymm ] ) can , of course , not be known in advance at the shooting point . however ,",
    "this is effectively circumvented by defining @xmath363 at step 4 of the shooting algorithm in sec .  [ secshooting ] leaving only the @xmath364 term for the acceptance rule ( step 3 ) .                    c.  h. bennett , molecular dynamics and transition state theory : the simulation of infrequent events , in : r.  e. christofferson ( ed . ) , algorithms for chemical computations , acs symposium series no . 46 , american chemical society , washington , d. c. , 1977 , pp .",
    "6397 .",
    "g.  ciccotti , molecular dynamics simulations of nonequilibrium phenomena and rare dynamical events , in : m.  meyer , v.  pontikis ( eds . ) , computer simulations in materials science , kluwer , dordrecht , 1991 , pp .",
    "365396 .",
    "w.  c. swope , h.  c. andersen , p.  h. berens , k.  r. wilson , a computer simulation method for the calculation of equilibrium constants for the formation of physical clusters of molecules , j. chem .",
    "76 ( 1982 ) 637649 .                        c.  dellago , d.  chandler , bridging the time scale gap with transition path sampling , in : p.  nielaba , m.  mareschal , g.  ciccotti ( eds . ) , molecular simulation for the next decade , vol .",
    "605 of lecture notes in physics ( lnp ) , springe , berlin , 2002 , pp .",
    "321333 .",
    "t.  shimomur , k.  j. tolle , j.  smid , m.  szwarc , energy and entropy of activation of propagation by free polystyryl anions and their ion pairs .",
    "phenomenon of negative activation energy , j. am .",
    "( 1967 ) 796 ."
  ],
  "abstract_text": [
    "<S> we review two recently developed efficient methods for calculating rate constants of processes dominated by rare events in high - dimensional complex systems . </S>",
    "<S> the first is transition interface sampling ( tis ) , based on the measurement of effective fluxes through hypersurfaces in phase space . </S>",
    "<S> tis improves efficiency with respect to standard transition path sampling ( tps ) rate constant techniques , because it allows a variable path length and is less sensitive to recrossings . </S>",
    "<S> the second method is the partial path version of tis . </S>",
    "<S> developed for diffusive processes , it exploits the loss of long time correlation . </S>",
    "<S> we discuss the relation between the new techniques and the standard reactive flux methods in detail . </S>",
    "<S> path sampling algorithms can suffer from ergodicity problems , and we introduce several new techniques to alleviate these problems , notably path swapping , stochastic configurational bias monte carlo shooting moves and order - parameter free path sampling . in addition , we give algorithms to calculate other interesting properties from path ensembles besides rate constants , such as activation energies and reaction mechanisms .    </S>",
    "<S> rare events , reaction rate , transition path sampling , transition interface sampling 82.20.-w , 31.15.qg , 05.10.ln </S>"
  ]
}