{
  "article_text": [
    "fluctuating hydrodynamics ( fhd ) accounts for stochastic effects arising at mesoscopic and macroscopic scales because of the discrete nature of fluids at microscopic scales @xcite . in fhd ,",
    "spatially - extended langevin equations are constructed by including stochastic flux terms in the classical navier - stokes - fourier equations of fluid dynamics and related conservation laws .",
    "it is widely appreciated that thermal fluctuations are important in flows at micro and nano scales ; even more importantly , hydrodynamic fluctuations span the whole range of scales from the microscopic to the macroscopic and need to be consistently included in _ all _ levels of description @xcite . while the original formulation of fluctuating hydrodynamics was for compressible single - component fluids @xcite , the methodology can be extended to other systems such as fluid mixtures @xcite , chemically reactive systems @xcite , magnetic materials @xcite , and others @xcite . the structure of the equations of fluctuating hydrodynamics can be , to some extent , justified on the basis of the mori - zwanzig formalism @xcite .",
    "the basic idea is to add a _",
    "stochastic flux _ corresponding to each dissipative ( irreversible , diffusive ) flux , leading to a continuum langevin model that ensures detailed balance with respect to a suitable einstein or gibbs - boltzmann equilibrium distribution @xcite .",
    "after spatial discretization ( truncation ) of the stochastic partial differential equations ( spdes ) of fhd , one obtains a large - scale system of stochastic ordinary differential equations ( sodes ) that has the familiar structure of langevin equations common in statistical mechanics . the spatial discretization must be performed with specific attention to preserving fluctuation - dissipation balance @xcite ; alternatively , one can directly construct discrete langevin equations with the proper structure from the underlying microscopic dynamics by using the theory of coarse - graining @xcite . in this paper , continuing on our previous work @xcite , we are concerned with temporal integration of the langevin systems that arise in fluctuating hydrodynamics and other mesoscopic models . in @xcite , we constructed several simple predictor - corrector ( two - step ) schemes for langevin equations and applied them to the incompressible fluctuating hydrodynamics equations coupled with an advection - diffusion equation for a scalar concentration field .",
    "the main feature of these schemes is that they allow one to treat some terms implicitly ( e.g. , mass or momentum diffusion ) , and treat others explicitly ( e.g , advection ) .",
    "furthermore , the schemes presented in @xcite are second - order weakly accurate for nonlinear sodes with _ constant additive noise _ , while also achieving , in certain cases , third - order accuracy for the static correlation functions ( static structure factors in fluctuating hydrodynamics ) .    in practical applications , however , several difficulties arise that require the development of novel temporal integration schemes .",
    "the first complication in fhd is the appearance of multiplicative noise . in the context of spdes ,",
    "such multiplicative noise is often purely formal and can not be interpreted mathematically in continuum formulations unless the nonlinear terms are regularized @xcite , or suitable renormalization terms are added @xcite . in most cases ,",
    "a precise formulation of the multiplicative noise terms is not known and the importance of various stochastic drift terms arising due to the multiplicative nature of the noise have not been explored .",
    "a precise mathematical interpretation can , however , be given to the equations of _ linearized _ fhd ( lfhd ) , which are in fact the most common model used in the literature @xcite .",
    "the lfhd equations can in some cases be derived rigorously from the microscopic dynamics as a form of central limit theorem for the gaussian fluctuations around the deterministic hydrodynamic equations , which are themselves a form of law of large numbers for the macroscopic observables @xcite .",
    "one can , at least formally , obtain the lfhd equations from the nonlinear fhd equations by expanding to leading order in the magnitude of the stochastic forcing terms ( more precisely , the inverse of the coarse - graining length scale ) .",
    "such linearization of nonlinear fhd equations leads to a system of two equations , the usual _ nonlinear _ deterministic equation , and a _ linear _ ( additive - noise ) stochastic differential equation ( sde ) for the gaussian fluctuations around the mean .",
    "a naive application of the temporal integrators in @xcite would require first solving the deterministic equation , itself a nontrivial problem except in the simplest of cases , and _ then _ solving a linear sde with a time - dependent but additive noise of magnitude determined by the deterministic solution .",
    "here we demonstrate that with some simple modifications the predictor - corrector integrators from @xcite can accomplish these two steps together without ever explicitly writing the lfhd equations .",
    "specifically , here we construct schemes that numerically linearize the equations around a numerically - determined deterministic solution .",
    "our analysis shows how to achieve second - order weak accuracy for the lfhd equations by choosing where to evaluate the amplitude of the stochastic forcing terms . in certain cases",
    ", the resulting integrators will also be first - order weakly accurate for the ( discrete or regularized ) _ nonlinear _ fhd equations .",
    "for nonlinear langevin equations with multiplicative noise , in general , it is difficult to construct integrators of weak order higher than one .",
    "second - order weak runge - kutta ( derivative - free ) schemes have been constructed @xcite for systems of sodes , however , using these types of methods in the contexts of spdes is non trivial .",
    "a second difficulty that often arises in fhd is the appearance of large separation of time scales between the different hydrodynamic variables . in incompressible",
    "fhd , velocity fluctuations are the most rapid , since flows at small scales are typically viscous - dominated and momentum diffuses much faster than does mass . as the dynamics of interest is usually the slow dynamics of the concentration field or discrete particles advected by the velocity fluctuations ,",
    "specialized multiscale temporal integrators are required to avoid the need to use small time step sizes that resolve the fast dynamics .",
    "this can be accomplished by analytically performing adiabatic mode elimination and eliminating the fast variable from the description to obtain a limiting or",
    "_ overdamped _",
    "equation for the slow variables , and then numerically integrating the limiting dynamics . in this work",
    "we develop predictor - corrector schemes that in essence numerically take the overdamped limit of a two - scale ( fast - slow ) system of sodes in which the fast variable enters linearly .",
    "our predictor - corrector schemes are applicable to a broad range of two - scale langevin equations that frequently arise in practice in a variety of contexts .",
    "their key feature is that they obtain all of the stochastic drift terms numerically without requiring derivatives .",
    "this makes it relatively easy to take a code that integrates the original fast - slow _ inertial _ dynamics using a ( semi-)implicit method , and to convert it into a code that integrates the overdamped dynamics .",
    "furthermore , the schemes we construct here are second - order weakly accurate for the linearized overdamped equations . in order to facilitate the integration of our methods in existing codes",
    "our algorithms make use of the components already required to integrate the original fast - slow equations without making use of the large - separation of scales .",
    "the result is a new algorithm that reuses the base code but can take a time step several orders of magnitude larger .    in this work",
    "we demonstrate that simple predictor - corrector methods can address the difficulties discussed above with a minimal amount of effort on the part of the user .",
    "specifically , we develop simple predictor - corrector schemes for temporal integration of langevin sdes that arise in fluctuating hydrodynamics and accomplish the following design goals :    1 .",
    "they reuse the same computational components already available in standard computational fluid dynamics ( cfd ) solvers , such as linear solvers for viscosity or diffusion , advection schemes , etc .",
    "2 .   in the deterministic context",
    "they are second - order accurate and relatively standard .",
    "3 .   for nonlinear but additive noise sdes they are second - order weakly accurate @xcite .",
    "they numerically linearize the fhd equations and solve the lfhd equations weakly to second - order . 5 .   for lfhd , they give higher - order accurate static correlations ( static structure factors ) at steady state @xcite .",
    "they can be used to integrate two - scale fast - slow systems in the overdamped limit , preserving all of the above properties but now referring to the limiting dynamics .",
    "7 .   in the general nonlinear multiplicative - noise case",
    ", they are weakly first - order accurate and do not require any derivative information .",
    "some of us have previously made use of some of the temporal integrators described here in more specialized works .",
    "in @xcite we constructed temporal integrators for the equations of brownian dynamics , which is a multiplicative - noise overdamped sde .",
    "these overdamped langevin equations result when one eliminates the fast velocity degrees of freedom from a system of equations for the motion of particles immersed in a fluctuating stokes fluid . in @xcite",
    "we solved a related overdamped spde for the concentration of the immersed particles @xcite using the techniques detailed here .",
    "in @xcite we apply our methods to the low mach number equations of fhd . in this work we present the temporal integrators used in this prior work in greater generality , with the hope that they will be useful for other langevin equations .",
    "we also explain the analysis required to study the order of weak accuracy of the schemes , making it easier for other researchers to further generalize our methods or to apply them in specific contexts .",
    "the remainder of this section discusses langevin equations and a specific example thereof : the equations of fluctuating hydrodynamics . in section [ sec :",
    "linearized ] we introduce schemes that are second order weakly accurate for the linearized ( weak noise limit ) langevin equations .",
    "section [ sec : overdamped ] studies systems of equations with a fast and slow variable and proposes schemes which perform adiabatic elimination of the fast variable numerically .",
    "section [ sec : applications ] outlines specific versions of our schemes applied to a system of passive tracers advected by a fluctuating fluid , and in section [ sec : giantfluct ] , we use our temporal integration methods to simulate diffusive mixing in binary liquid mixtures .",
    "finally , section [ sec : conclusions ] gives our concluding thoughts and remarks .",
    "as discussed in more detail in our previous work @xcite , we consider temporal integrators for a class of generic langevin equations for the coarse - grained variables @xmath0 @xcite , @xmath1 where @xmath2 denotes white noise , the formal time derivative of a collection of independent brownian motions , and an ito interpretation is assumed . here",
    "@xmath3 is the thermodynamic driving potential , such as an externally - applied conservative potential or a _ coarse - grained free energy .",
    "_ we will typically suppress the explicit dependence on @xmath4 and write the _ mobility operator _ as @xmath5 , and assume that the noise operator @xmath6 obeys the _ fluctuation - dissipation balance _",
    "condition @xmath7 where star denotes an adjoint .",
    "this ensures that the dynamics ( [ eq : x_t_general ] ) is ( under suitable assumptions ) ergodic with respect to the gibbs - boltzmann distribution @xmath8,\\label{eq : gibbsboltzmann}\\ ] ] where @xmath9 is a normalization constant . in the notation we have chosen , in component form @xmath10 , where repeated indices are implicitly summed throughout this paper .",
    "please note that this is different from the less - standard notation we used in our previous paper @xcite , where the drift term is written as @xmath11 .",
    "the last term in ( [ eq : x_t_general ] ) is an additional `` stochastic '' or `` thermal '' drift term , as can be seen from the fact that it is proportional to @xmath12 .",
    "this term contains information about the noise and therefore depends on the particular interpretation of the stochastic integral .",
    "the thermal drift term , however , also contains information about the anti - symmetric part of the generator @xmath13 that is unrelated to the stochastic noise term .",
    "if the skew - adjoint component @xmath14 is divergence - free , @xmath15 , the associated dynamics is incompressible in phase space @xcite and the stochastic drift term disappears if one uses the kinetic interpretation @xcite of the stochastic integral , denoted with the stochastic product @xmath16 , @xmath17 in the case when @xmath18 is self - adjoint , @xmath19 , the kinetic sde ( [ eq : x_t_kinetic ] ) corresponds to a fokker - planck equation for the evolution of the probability distribution @xmath20 for observing the state @xmath4 at time @xmath21 , @xmath22\\right\\ } , \\label{eq : fokkerplanck}\\ ] ] where we note that the term in square brackets vanishes when @xmath23 .      as a simple but illustrative example of a langevin equation that our methods can be applied to we consider the langevin equation with position - dependent friction tensor @xmath24 , @xmath25 where @xmath26 is the position of a particle diffusing under the influence of an external force @xmath27 , @xmath28 is the particle velocity , and @xmath29 is its mass .",
    "it is well - known that in the low - inertia limit @xmath30 , the velocity can be eliminated as a fast degree of freedom to obtain the overdamped langevin equation @xcite @xmath31 which is of the form ( [ eq : x_t_general ] ) with a self - adjoint mobility @xmath32 and with @xmath33 being a matrix square root or a cholesky factor of @xmath34 . even though the overdamped equation strictly only applies in the limit of infinite separation of time scales",
    ", it will be a very good approximation so long as there still remains a large separation of time scales between the fast velocity and the slow position .      in this paper",
    "we construct predictor - corrector algorithms that integrate the overdamped equation ( [ eq : overdamped_langevin ] ) by instead directly discretizing the inertial equation ( [ eq : inertial_langevin ] ) without the inertial term @xmath35 . by carefully constructing the corrector stage we will obtain the correct stochastic or thermal drift term in ( [ eq : overdamped_langevin ] ) . for the simple langevin equation ( [ eq : inertial_langevin ] ) a trapezoidal integrator goes from time step @xmath36 to time step @xmath37 via the two stages , @xmath38 where superscripts denote the point at which a given quantity is evaluated , for example , @xmath39 , and @xmath40 is a collection of independent and identically distributed ( i.i.d . )",
    "standard normal random variables sampled independently at each time step .",
    "this predictor - corrector method is only first - order accurate for the multiplicative - noise case .",
    "when one is interested in linearized equations ( e.g. , a particle trapped by a harmonic potential to remain close to a stable minimum of the potential ) the predictor - corrector schemes we construct in section [ sec : overdamped ] are second - order weakly accurate .",
    "it is not hard to show that the scheme ( [ eq : fixman_lang ] ) is equivalent to the well - known fixman integrator for ( [ eq : overdamped_langevin ] ) @xcite .",
    "note that the final fixman update can be written in the form @xmath41 where the mobility @xmath42 .",
    "the first line is seen as an application of the ( second - order ) explicit trapezoidal rule for the deterministic drift terms and the euler - maryama method for the stochastic terms , while the second line gives the thermal drift term @xmath43 in expectation , as we explain next .",
    "a key feature of the fixman method is that it requires access to the action of both @xmath34 and @xmath44 , or equivalently , @xmath45 and @xmath46 .",
    "this is a great disadvantage in cases when only the action of the mobility @xmath42 and its factor @xmath47 are easily computable @xcite .",
    "an alternative method to obtain the drift term @xmath48 in expectation is to use the general relation , @xmath49 where @xmath50 and @xmath51 are gaussian variates with mean zero and covariance @xmath52 . the second line in the fixman method ( [ eq : rfd_fixman ] )",
    "can be seen as an application of ( [ eq : driftwithincrements ] ) with @xmath53 and @xmath54 and @xmath55 .",
    "the choice @xmath56 is , however , much simpler to use than the fixman choice because it does not require the application of either @xmath57 or @xmath58 . here",
    "@xmath59 is a small discretization parameter that can be taken to be related to @xmath60 as in the fixman method , but this is not necessary .",
    "one can more appropriately think of ( [ eq : driftwithincrements ] ) as a `` random finite difference '' ( rfd ) with @xmath59 representing the small spacing for the finite difference , to be taken as small as possible while avoiding numerical roundoff problems .",
    "the advantage of the `` random '' over a traditional finite difference is that only a small number of evaluations of the mobility per time step is required .",
    "note that the subtraction of @xmath61 in ( [ eq : driftwithincrements ] ) is necessary in order to control the variance of the rfd estimate .    for the simple langevin equation ( [ eq : inertial_langevin ] ) an rfd approach uses the same predictor ( [ eq : pred_lang ] ) as in the fixman algorithm , but now with corrector , @xmath62\\widetilde{\\m w}^{n},\\label{eq : rfd_lang}\\end{aligned}\\ ] ] where @xmath63 is a collection of independent standard normal variates that are uncorrelated with @xmath40 . because the corrector stage for the velocity evaluates the noise amplitude at the beginning of the time step there are no stochastic drift terms generated from the term @xmath64 , and the rfd in the last line of ( [ eq : rfd_lang ] ) is necessary to generate the missing drift in expectation .",
    "it is not hard to see that ( [ eq : rfd_lang ] ) is a markov chain that is consistent with the ito overdamped equation ( [ eq : overdamped_langevin ] ) . to demonstrate consistency we only need to show that to leading order , the first moment of the increment is equal to the deterministic drift in expectation , @xmath65 which follows directly from ( [ eq : driftwithincrements ] ) , and that in expectation the second moment of the increment matches the covariance of the noise , @xmath66 which is trivially true because the random increment in both the predictor and corrector stages is @xmath67 .",
    "the two schemes ( [ eq : pred_lang],[eq : fixman_lang ] ) and ( [ eq : pred_lang],[eq : rfd_lang ] ) do not , of course , exhaust all possibilities . for example , in the corrector stage for velocity we could evaluate the noise amplitude at the predicted value , @xmath68 it is not difficult to show , however , that with this choice the term @xmath64 in the corrector stage for the position would generate an incorrect stochastic drift term for non - scalar problems .",
    "therefore , additional rfd terms would be required to remove any spurious drift terms and add the correct ones . in this work",
    "we construct several schemes for integrating two - scale systems such as ( [ eq : overdamped_langevin ] ) that generate the correct drift terms using random finite differences , and , furthermore , also obtain second - order weak accuracy for the overdamped equations linearized around a stable deterministic trajectory . with additional effort ,",
    "it is also possible to obtain second - order weak accuracy for the nonlinear overdamped equation by using weak runge - kutta schemes of the kind developed in @xcite , which also rely on an rfd - like approach to avoid explicit evaluation of derivatives .      as a motivating example of a fluctuating hydrodynamic system of equations to which our methods will be applied , we study a model of diffusion of",
    "tagged ( labeled ) molecules in a liquid or of colloidal particles suspended in a fluid .",
    "a detailed mesoscopic model for diffusion in liquids has been described by some of us in previous work @xcite ; here we only summarize some key points to give a specific setting for the discussion to follow .",
    "the hydrodynamic fluctuations of the fluid velocity @xmath69 will be modeled via the incompressible fluctuating navier - stokes equation , @xmath70 , and @xmath71 and appropriate boundary conditions . here",
    "@xmath72 is the fluid density , @xmath73 the shear viscosity , and @xmath74 the temperature , all assumed to be constant throughout the domain , and @xmath75 is the mechanical pressure .",
    "the last term in this equation models the effects of gravity using a boussinesq constant density approximation , with @xmath76 being the gravitational acceleration , and @xmath77 the solutal expansion coefficient .",
    "the concentration of diffusing particles is given by the mass fraction @xmath78 , where @xmath36 is the number density and @xmath29 is the mass of the tracer particles .",
    "the stochastic momentum flux is modeled via a white - noise symmetric tensor field @xmath79 with covariance chosen to obey a fluctuation - dissipation principle @xcite , @xmath80 note that because the noise is additive in ( [ eq : fluct_ns ] ) there is no difference between an ito and a stratonovich interpretation of the stochastic term . for technical reasons , in this work",
    "we will drop the nonlinear advective term @xmath81 and consider the time - dependent fluctuating stokes equation ; this is a good approximation since this term only plays an important role at very large scales .    for our purposes , we will model the evolution of the concentration @xmath82 via a fluctuating advection - diffusion ito equation @xcite , @xmath83 where @xmath84 denotes a white - noise vector field . here",
    "@xmath85 is a _ bare _ or _ molecular _ diffusion coefficient , and the concentration is advected by the random field @xmath86 where @xmath87 is a smoothing kernel that filters out features at scales below a microscopic ( molecular ) scale @xmath88 , and @xmath89 denotes convolution .",
    "it is important here that @xmath90 is also divergence - free , @xmath91 .",
    "formally , one often writes the advective term in ( [ eq : c_eq_original ] ) as @xmath92 ( this corresponds to @xmath93 ) but this only makes sense if one truncates the velocity equation ( [ eq : fluct_ns ] ) at some ultraviolet cutoff wave number @xmath94 ; this kind of implicit smoothing kernel is applied by the finite - volume spatial discretization we employ @xcite , with the grid spacing playing the role of @xmath88 .",
    "additional filtering may also be implemented in the finite - volume schemes , as described in appendix b in @xcite .",
    "the system of equations ( [ eq : fluct_ns],[eq : c_eq_original ] ) is a useful model , for example , for the study of giant concentration fluctuations in low - density polymer @xcite or nanocolloidal suspensions @xcite , or in binary fluid mixtures in the presence of a modest temperature gradient @xcite .",
    "it can be shown that the coupled velocity - concentration system ( [ eq : fluct_ns],[eq : c_eq_original ] ) can formally be written as an infinite - dimensional system of the form ( [ eq : x_t_general ] ) with a physically - sensible coarse - grained energy _",
    "@xmath95=\\frac{\\rho}{2}\\int v^{2}\\left(\\v r\\right)\\ , d\\v r+\\beta\\rho\\int c\\left(\\v r\\right)\\left(\\v r\\cdot\\v g\\right)\\ , d\\v r+\\left(k_{b}t\\right)\\int n\\left(\\v r\\right)\\left(\\ln\\left(\\lambda^{3}n\\left(\\v r\\right)\\right)-1\\right)\\ , d\\v r,\\label{eq : u_fns}\\ ] ] where @xmath96 is the number density of the diffusing particles , and @xmath97 is a fixed length - scale ( e.g. , the thermal de broglie wavelength ) .",
    "a specific form of the mobilty _ operator _ can also be written , see for example refs .",
    "@xcite for the advective terms and ref .",
    "@xcite for the diffusive and stochastic terms .",
    "numerical methods for integrating systems such ( [ eq : fluct_ns],[eq : c_eq_original ] ) as have been discussed in refs .",
    "@xcite . in particular , after spatial discretization of the system of spdes ( [ eq : fluct_ns],[eq : c_eq_original ] ) one obtains a system of sodes of the generic langevin form ( [ eq : x_t_general ] ) .",
    "we note that the last term in ( [ eq : u_fns ] ) , which contains the free energy density of an ideal gas with number density @xmath98 , is quite formal and poses notable mathematical ( and numerical ) difficulties @xcite . in this work",
    "we will make a gaussian approximation and use instead the gaussian free energy @xmath99 @xcite , where @xmath100 and @xmath101 is the average concentration ; this change simplifies the mobility to a constant matrix and the noise term in ( [ eq : c_eq_original ] ) becomes additive , @xmath102 , see section [ sub : constcoeff ] .    in practice , the physical properties of the fluid , notably , the viscosity and the diffusion coefficient , depend on the concentration",
    "this is crucial , for example , to model experiments on the development of giant concentration fluctuations during the diffusive mixing of water and glycerol @xcite , since the viscosity and diffusion coefficient ( by virtue of the stokes - einstein relation ) depend very strongly on the concentration . assuming that the density changes only weakly with concentration we can use a boussinesq approximation .",
    "this approximation essentially amounts to assuming that the two fluid components have very similar density so that the fluid density @xmath72 can be considered constant ; for a generalization that accounts for the fact that density depends on concentration see the low mach number formulation in @xcite .",
    "the fluctuating hydrodynamic equations in the case of variable transport coefficients can formally be written as @xmath103 where in general the specified temperature @xmath104 may depend on position and time . here @xmath105 and @xmath106 is the derivative of the chemical potential of the binary mixture @xcite .",
    "we have omitted stochastic or thermal drift terms since these are poorly understood ( in fact , mathematically they are ill - defined ) and not important in the linearized dynamics .",
    "note that in the linearized equation there is no distinction between the bare and the effective diffusion coefficient , so @xmath107 denotes the macroscopic diffusion coefficient of the ensemble - averaged concentration @xcite .",
    "similarly , in the linearized equations the nonlinear advective terms become a sum of linear terms , and therefore in ( [ eq : variable_coeff ] ) we can write @xmath92 instead of @xmath108 and still give a precise meaning to the linearized equations .",
    "one of the key difficulties in directly integrating the system ( [ eq : fluct_ns],[eq : c_eq_original ] ) is the fact that in liquids momentum diffuses much more rapidly than does mass , i.e. , the dynamics of the velocity is much faster than that of concentration .",
    "we used this fact in @xcite to eliminate the fast velocity adiabatically ( see appendix a in @xcite for technical details ) and obtained a limiting or overdamped equation for the concentration that takes the form of a stratonovich spde , @xmath109 where @xmath110 denotes a stratonovich dot product , and the advection velocity @xmath111 is white in time , with covariance proportional to a green - kubo integral of the velocity auto - correlation function , @xmath112 here @xmath113 denotes the green s function for stokes flow , and @xmath114 denotes @xmath113 regularized by the smoothing kernel @xmath87 ; more explicitly , @xmath115 is a shorthand notation for the smoothed solution of the stokes equation with unit viscosity :",
    "@xmath116 if @xmath117 and @xmath118 solves @xmath119 along with appropriate boundary conditions .    in this paper we will describe an algorithm that can be used to integrate the overdamped limit ( [ eq : limiting_strato ] ) with a time step size several orders of magnitude larger than the time step size required to integrate the original inertial dynamics ( [ eq : fluct_ns],[eq : c_eq_original ] ) .",
    "the spatial discretization will be the same as for the original system and only the temporal integrator will change .",
    "we first described such a temporal integrator that _ automatically _ performs adiabatic mode elimination _ without _ directly discretizing or even writing the limiting dynamics in appendix b of @xcite .",
    "here we generalize this to a broad class of systems of langevin sdes that contain a fast and a slow variable .",
    "at microscopic scales , the nonlinearity and stratonovich nature of the advective term @xmath120 in ( [ eq : limiting_strato ] ) is crucial .",
    "this advection by the rapidly fluctuating random velocity field contributes to the effective diffusion , similar to eddy diffusivity in turbulent flows . in particular , the ensemble averaged concentration @xmath121 is described by fick s macroscopic law with a renormalized diffusion coefficient @xmath122=\\grad\\cdot\\left(\\m{\\chi}_{\\text{eff}}\\grad\\bar{c}\\right),\\label{eq : fick_law}\\ ] ] where the fluctuation - induced diffusion tensor @xmath123 is given by a green - kubo formula and follows a stokes - einstein relation @xcite .",
    "this enhancement of the diffusion coefficient is mathematically a stochastic drift term that comes from the divergence of the mobility operator ( last term in ( [ eq : x_t_general ] ) ) when one writes ( [ eq : limiting_strato ] ) in the ito formulation @xcite .",
    "our temporal integrators will capture this term using a predictor - corrector algorithm , without explicitly evaluating derivatives .    at mesoscopic length - scales @xmath124 much larger than the molecular , in three dimensions ,",
    "one expects that the fluctuations in @xmath125 , where @xmath126 is the solution of the _ deterministic _ fick s law ( [ eq : fick_law ] ) , are small and approximately gaussian ( this is a form of a law of large numbers and a central limit theorem for the fluctuations ) .",
    "in particular , a widely - used model for the fluctuations in the concentration at such scales is _ linearized fluctuating hydrodynamics _",
    "@xcite ( lfh ) . in lfh ,",
    "one first solves the macroscopic _ deterministic _ hydrodynamic equations first , and then linearizes the formal nonlinear fluctuating hydrodynamic equations to leading order in the fluctuations .",
    "if we assume that there is no macroscopic convective motion of the fluid , so that the solution of the deterministic navier - stokes equation @xmath127 and @xmath128 , the lfh equations become @xmath129 in the first part of this paper we describe how to numerically solve these types of linearized langevin equations _ without _ solving the deterministic equations first and then explicitly linearizing around them .",
    "specifically , we will construct temporal integrators that perform the linearization _",
    "numerically_.    note that in cases when there is a large separation of time scales between the velocity and the concentration one may perform adiabatic elimination of the velocity ; in the linearized setting this simply amounts to dropping the inertial term @xmath130 and switching to the time - independent stokes equation for the velocity .",
    "formally , the linearized limiting or overdamped equation is @xmath131 where @xmath113 is the green s function for steady stokes flow and @xmath132 symbolically denotes that the covariance of the additive - noise term @xmath133 is @xmath113 .    in our previous work @xcite we described several semi - implicit predictor - corrector temporal integrators for the inertial system ( [ eq : fluct_ns],[eq : c_eq_original ] ) ,",
    "which has _ time - independent _ additive noise . in this paper",
    "we will describe a simple modification that allows one to numerically linearize and then integrate , with second - order weak accuracy , the linearization ( [ eq : linearized_diffusion ] ) around the _ time - dependent _ solution of the _ nonlinear _ deterministic equations .",
    "we will also construct a _",
    "single _ unified numerical method that can be used to integrate either the nonlinear ( [ eq : limiting_strato ] ) ( microscopic scales , large noise ) or the linearized ( [ eq : linearized_overdamped ] ) ( mesoscopic scales , weak noise ) overdamped equations . which equation is appropriate depends sensitively on the spatial scale of interest , specifically , on the range of wavenumbers whose dynamics needs to be captured accurately .    in this work",
    "we will develop temporal integrators suitable also for the more general variable - coefficient equations ( [ eq : variable_coeff ] ) . since our temporal integrators will work with the original equations but in the end simulate the correct overdamped or linearized dynamics , we will never need to explicitly write down the ( more complex ) overdamped limit or the linearized system .",
    "we simply let the numerical method do that for us .",
    "in this section we consider a relatively general system of langevin equations for the coarse - grained variable @xmath0 , @xmath134 where @xmath135 is a term that we may choose to treat semi - implicitly in cases when it is stiff , and @xmath136 denotes the remaining terms which are difficult to treat implicitly . in cases when the noise is multiplicative",
    "one must choose a specific interpretation of the stochastic integral , here we have chosen the kinetic product @xmath16 @xcite in agreement with our motivating equation ( [ eq : x_t_kinetic ] ) .",
    "the system ( [ eq : dx_dt_nonlin ] ) may arise from a spatial discretization of fluctuating hydrodynamics spdes , but similar equations arise in a variety of contexts",
    ".    our focus will be on developing methods for integrating the system of equations obtained after linearizing ( [ eq : dx_dt_nonlin ] ) around the solution @xmath137 of the deterministic system of equations ( obtained by simply dropping the noise term ) , @xmath138 where @xmath139 is the ( presumably small ) fluctuation around the deterministic dynamics . here",
    "the jacobian of @xmath140 is denoted with @xmath141 more specifically , in index notation @xmath142 note that the noise in ( [ eq : dx_dt_lin ] ) is time - dependent but still additive , and different interpretations of the stochastic integral are equivalent .",
    "one can more precisely justify the system ( [ eq : dx_dt_lin ] ) by assuming that the noise is very weak .",
    "in particular , the deterministic equation ( [ eq : dxbar_dt ] ) can be seen as a law of large numbers describing the most probable trajectory in the weak - noise limit , with the ornstein - uhlenbeck equation ( [ eq : dx_dt_lin ] ) as a central - limit theorem for the small nearly gaussian fluctuations around the average .",
    "it is important to note that one must assume here that the deterministic dynamics is stable , that is , small perturbations do not lead to large deviations of the averages , which is a good assumption far from phase transitions or bifurcation points .",
    "note , however , that the linearized equations can not be used to describe rare events ( large deviations ) or events that occur on exponentially - long timescales .",
    "the essential difficulty in integrating ( [ eq : dx_dt_lin ] ) directly is that the linearization needs to be performed around a time - dependent state @xmath137 that is not known _ a priori _ but is rather itself the solution of a nonlinear system of equations .",
    "furthermore , one must calculate the jacobian @xmath143 explicitly , and this is often quite tedious since many more terms appear in the linearization than do in the original nonlinear equations ( this is especially true for fluctuating hydrodynamics ) .",
    "instead , we will construct methods that directly work with the original nonlinear equation ( [ eq : dx_dt_nonlin ] ) but with a noise term that is deliberately made very weak , as some of us first proposed and applied in @xcite to a case of a _ steady _ deterministic state .",
    "in fact , if the assumption of weak noise used to justify the linearization is actually correct , the noise does not have to be artificially reduced in magnitude at all and using the actual ( physical ) value of the noise amplitude will give indistinguishable results .",
    "while it is of course always better to simply integrate the original nonlinear dynamics in cases where it is known , it is important to emphasize that nonlinear fluctuating hydrodynamics is very poorly understood and in most cases the nonlinear equations are ill - posed ; a notable exception are ( [ eq : fluct_ns],[eq : c_eq_original ] ) and ( [ eq : limiting_strato ] ) because the nonlinear advective term there was carefully regularized in a physically - relevant manner @xcite . by contrast , the linearized equations are well - defined because there are no nonlinear terms and a precise meaning can be given in the space of ( gaussian ) distributions @xcite .",
    "another important reason for focusing on the linearized equations is that while integrating the nonlinear equations to second - order ( weakly ) is rather nontrivial in the case of multiplicative noise @xcite , it is not hard to construct simple second - order integrators for the linearized equations , as we demonstrate here .",
    "before we describe methods for solving ( [ eq : dxbar_dt],[eq : dx_dt_lin ] ) , we describe how to construct temporal integrators for just ( [ eq : dx_dt_lin ] ) , assuming that @xmath137 is known and given to us , and therefore the noise amplitude @xmath144 is only a function of time .      at first , it will not be necessary to assume that the equation for the fluctuations is linear , and we will therefore consider a more general sde with time dependent additive noise , @xmath145 which is a generalization of the constant additive noise equation considered in @xcite .",
    "such an equation may arise , for example , by considering a time - dependent temperature in the fluctuating navier - stokes equation ( [ eq : fluct_ns ] ) . here",
    "@xmath146 denotes a collection of independent white - noise processes , formally identified with the time derivative of a collection of independent brownian motions ( wiener processes ) @xmath147 , @xmath148 , @xmath149 denotes all of the terms handled explicitly ( e.g. , advection or external forcing ) , and the term @xmath150 denotes terms that will be handled semi - implicitly ( e.g. , diffusion ) for stiff systems ( large spread in the eigenvalues of @xmath151 ) . in general , @xmath152 may depend on @xmath4 since the transport coefficients ( e.g. , viscosity ) may depend on certain state variables ( e.g. , concentration ) .",
    "note that the equation ( [ eq : timedepnoise ] ) also includes the case where @xmath153 and @xmath154 depend explicitly on time , as can be seen by considering an expanded system of equations for @xmath155    here we focus on weak integrators that are ( at most ) second - order accurate .",
    "the following is a relatively general mixed explicit - implicit predictor - corrector scheme for solving ( [ eq : timedepnoise ] ) that is a slight generalization of the scheme discussed in @xcite .",
    "the first stage in our schemes is a predictor step to estimate @xmath156 , where @xmath157 is some chosen weight ( e.g. , @xmath158 for a midpoint predictor or @xmath159 for a full - step predictor ) , while the corrector stage completes the step by estimating @xmath160 at time @xmath161 , @xmath162 where we have denoted @xmath163 and superscripts and decorations denote the point at which a given quantity is evaluated , for example , @xmath164 .",
    "note that this class of semi - implicit schemes requires solving only _ linear _ systems involving the matrix @xmath165 evaluated at a specific point and kept fixed . in the above discretization , the standard normal variates @xmath166 correspond to the increment of the underlying wiener processes @xmath167 over the time interval @xmath168 , @xmath169 in law , while the normal variates @xmath170 correspond to the independent increment over the remainder of the time step , @xmath171 in law .",
    "we give two alternative ways to handle the explicit terms in the corrector stage , which give the same order of accuracy , and , are , in fact , identical if @xmath76 is linear . which of the two ways of handling the explicit terms is better",
    "should be tested empirically for strongly nonlinear langevin equations , as we did in ref .",
    "@xcite using the stochastic burgers equation as a model problem .",
    "different specific values for the @xmath172 coefficients determine different schemes .",
    "the analysis summarized in appendix a in @xcite is extended in appendix [ sec : appendix - time - dependent ] to account for the time dependence of @xmath173 , and shows that the scheme ( [ eq : predcorr_scheme ] ) is weakly second order accurate if the weights satisfy @xmath174 we present two simple schemes that satisfy these properties next , the first fully explicit , and the second semi - implicit . while these by no means exhaust all possibilities , they are representative and have several notable advantages for the case of time - independent noise , as discussed in more detail in @xcite .      a fully explicit midpoint predictor - corrector scheme is obtained for @xmath175 : @xmath176 this midpoint scheme has several notable strengths for fluctuating hydrodynamics :    1 .",
    "it is fully explicit and thus quite efficient ( but also subject to restrictive stability limits on the time step size for stiff systems ) .",
    "2 .   it is a weakly second - order accurate integrator for ( [ eq : timedepnoise ] ) .",
    "it is third - order accurate for static structure factors ( static correlations ) for time - independent additive noise in the linearized setting @xcite , that is , for the equation @xmath177 with constant @xmath151 and @xmath173 .",
    "it is also possible to construct an explicit trapezoidal scheme that only uses a single random increment per time step , @xmath178 , but for fluctuating hydrodynamics the explicit midpoint integrator is preferred because it gives third - order accurate static correlations .",
    "we obtain a semi - implicit trapezoidal predictor - corrector scheme for @xmath179 : @xmath180 this scheme has the following advantages :    1 .",
    "it only requires solving two linear systems with the coefficient matrix @xmath181 , which is quite standard in computational fluid dynamics and can be done efficiently using multigrid techniques .",
    "2 .   it is a weakly second - order accurate integrator for ( [ eq : timedepnoise ] ) .",
    "it is stable and gives the _ exact _ _ static _",
    "correlations for ( [ eq : const_noise ] ) for _ any _ time step size @xmath60 @xcite .",
    "the alternative handling of the explicit term leads to the corrector stage , @xmath182 which has the same advantages as ( [ eq : impl_trapezoidal ] ) , but may behave differently for strongly nonlinear equations .",
    "the scheme ( [ eq : predcorr_scheme ] ) with the conditions ( [ eq : second_order_cond ] ) is a second - order weak integrator for the additive - noise equation ( [ eq : timedepnoise ] ) . with a simple addition of a random finite difference ( rfd ) term in the corrector ,",
    "see section [ sub : rfd ] , the scheme ( [ eq : predcorr_scheme ] ) can be turned into a first - order weak integrator for the nonlinear kinetic sde @xmath183 namely , if we interpret @xmath184 as the noise amplitude evaluated at the predictor , the integrator ( [ eq : predcorr_scheme ] ) is consistent with a stratonovich interpretation of the noise .",
    "if we want the integrator to be consistent with the kinetic interpretation , we need to add a missing piece of the stochastic drift term , @xmath185 the first term on the right hand side in index notation reads @xmath186 and is the only drift term that appears if a stratonovich interpretation of the noise is adopted . to obtain the second term , we need to add to the corrected @xmath160 the following rfd increment , @xmath187 where @xmath188 is a collection of i.i.d .",
    "standard normal increments generated independently of @xmath40 .",
    "we now turn our attention to temporal integrators for the linearized system ( [ eq : dxbar_dt],[eq : dx_dt_lin ] ) .",
    "the key difference with ( [ eq : timedepnoise ] ) is that we do not assume that @xmath137 is known , rather , it is also obtained by the numerical method .",
    "our approach will be to pretend we are integrating the nonlinear equation ( [ eq : dx_dt_nonlin ] ) but using very weak noise , so that we will effectively be integrating the linearized equation .",
    "our goal will be to construct schemes that are second - order weakly accurate for the linearized system ( [ eq : dxbar_dt],[eq : dx_dt_lin ] ) .",
    "for steady states , that is , when the deterministic or background state @xmath189 is independent of time , the linearized equation ( [ eq : dx_dt_lin ] ) is of the form ( [ eq : timedepnoise ] ) with the identification @xmath190 and @xmath191 , along with @xmath192\\v x\\label{eq : steady_l_g}\\ ] ] as the part of the linear operator treated implicitly and explicitly , respectively .",
    "we would like to construct one fully explicit integrator that for steady states becomes equivalent to the explicit midpoint scheme ( [ eq : expl_midpoint ] ) , and one semi - implicit integrator that for steady states becomes equivalent to the implicit trapezoidal scheme ( [ eq : impl_trapezoidal ] ) . in this way",
    ", we obtain simple schemes that inherit all of the important strengths of the explicit trapezoidal and implicit midpoint schemes in describing fluctuations around a steady state , while also performing numerical linearization and maintaining second - order weak accuracy for time - dependent problems .",
    "let us first consider fully explicit schemes , for which the analysis is considerably easier .",
    "a simple predictor - corrector update for the nonlinear equation ( [ eq : dx_dt_nonlin ] ) reads @xmath193 if we now split the variables into deterministic and fluctuating components , @xmath194 and expand the predictor and corrector stages to first order in the fluctuations ( i.e. , linearize both stages in @xmath195 and @xmath196 ) , we obtain that for weak fluctuations ( [ eq : explicit_linearizer ] ) is effectively applying the same explicit scheme to the linearized system ( [ eq : dxbar_dt],[eq : dx_dt_lin ] ) .",
    "the analysis summarized in appendix [ appendix - accuracy ] shows that the scheme ( [ eq : explicit_linearizer ] ) is a second - order weakly accurate integrator for ( [ eq : dxbar_dt],[eq : dx_dt_lin ] ) if @xmath197 and @xmath198 .",
    "examples of second - order fully explicit schemes include the explicit midpoint scheme , obtained for @xmath199 , and the explicit trapezoidal scheme , obtained for @xmath200 .",
    "note that at steady state the explicit midpoint scheme becomes equivalent to applying ( [ eq : expl_midpoint ] ) directly to ( [ eq : dx_dt_lin ] ) .",
    "we now consider applying the relatively general predictor - corrector scheme ( [ eq : predcorr_scheme ] ) to ( [ eq : dx_dt_nonlin ] ) , with the identification @xmath201 and @xmath202 , which gives the semi - implicit scheme @xmath203 if we substitute ( [ eq : mean_plus_fluct ] ) in ( [ eq : general_linearizer ] ) and linearize both stages , we obtain that for weak noise the same scheme ( but without the noise terms ) is applied to the deterministic component , @xmath204 while for the fluctuating component , in index notation , @xmath205\\delta x_{j}^{n}\\d t\\label{eq : general_dx_np1}\\\\ + & \\left[w_{3}\\left(\\bar{h}_{ij}^{(p)}+\\left(\\partial_{j}\\bar{h}_{ik}^{(p)}\\right)\\bar{x}_{k}^{(p)}\\right)+w_{4}\\left(\\partial_{j}\\bar{h}_{ik}^{(p)}\\right)\\bar{x}_{k}^{n+1}\\right]\\delta x_{j}^{(p)}\\d t\\nonumber \\\\ + & \\left(w_{4}\\bar{h}_{ij}^{(p)}+w_{5}\\bar{h}_{ij}^{n}\\right)\\delta x_{j}^{n+1}\\d",
    "t\\nonumber \\\\ + & \\begin{cases } \\left((1-w_{6})(\\partial_{k}\\bar{h}_{i}^{n})\\delta x_{k}^{n}+w_{6}(\\partial_{k}\\bar{h}_{i}^{(p)})\\delta x_{k}^{(p)}\\right)\\d t , & \\mbox{or}\\\\ \\partial_{k}\\bar{h}_{i}^{(w)}\\left((1-w_{6})\\d x_{k}^{n}+w_{6}\\d x_{k}^{(p)}\\right)\\d t \\end{cases}\\nonumber \\\\ + & \\left((1-w_{7})\\bar{k}_{ij}^{n}+w_{7}\\bar{k}_{ij}^{(p)}\\right)\\left(\\sqrt{w_{2}\\d t}\\ , w_{j}^{1,n}+\\sqrt{(1-w_{2})\\d t}\\ , w_{j}^{2,n}\\right),\\nonumber \\end{aligned}\\ ] ] where decorations and superscripts indicate where the derivatives are evaluated , for example , @xmath206 , and @xmath207 is evaluated at @xmath208 .",
    "the analysis summarized in appendix [ appendix - accuracy ] shows that this scheme is a second - order weakly accurate integrator for ( [ eq : dxbar_dt],[eq : dx_dt_lin ] ) if the conditions ( [ eq : second_order_cond ] ) hold .",
    "this analysis leads us to the important conclusion that the same schemes can be used not only to integrate time - dependent langevin equations ( [ eq : timedepnoise ] ) but also to numerically linearize ( [ eq : dx_dt_nonlin ] ) , and integrate the equations ( [ eq : dxbar_dt],[eq : dx_dt_lin ] ) to second order weakly .",
    "in particular , for fully explicit schemes we recommend the midpoint scheme ( [ eq : expl_midpoint ] ) , and for implicit schemes we recommend the implicit trapezoidal scheme ( [ eq : impl_trapezoidal ] ) , with the identification @xmath201 and @xmath202 . depending on the interpretation of the noise , the same integrators may also be first - order weak integrators for the nonlinear equation ( [ eq : dx_dt_nonlin ] ) , in particular , this is the case for stratonovich noise . for kinetic noise , the rfd term ( [ eq : rfd_kinetic ] ) can be added to the corrector to obtain the required stochastic drift terms .",
    "in this section we consider a generic finite - dimensional langevin equation of the form ( [ eq : x_t_general ] ) in the case when there are two variables , @xmath209 , where @xmath210 is the slow ( relevant ) variable and @xmath211 is a fast variable .",
    "we focus on a rather general form of such a fast - slow langevin system , @xmath212= & -\\left[\\begin{array}{cc } \\m a & \\epsilon^{-1}\\m b\\\\ -\\epsilon^{-1}\\m b^{\\star } & \\epsilon^{-2}\\m c \\end{array}\\right]\\left[\\begin{array}{c } \\partial_{\\v x}u\\\\ \\partial_{\\v y}u \\end{array}\\right]+\\sqrt{2k_{b}t}\\,\\left[\\begin{array}{cc } \\m a_{\\frac{1}{2 } } & \\m 0\\\\ \\m 0 & \\epsilon^{-1}\\m c_{\\frac{1}{2 } } \\end{array}\\right]\\left[\\begin{array}{c } \\v{\\mathcal{w}}_{\\v x}\\left(t\\right)\\\\ \\v{\\mathcal{w}}_{\\v y}\\left(t\\right ) \\end{array}\\right]+\\left(k_{b}t\\right)\\left[\\begin{array}{c } \\partial_{\\v x}\\cdot\\m a\\\\ -\\epsilon^{-1}\\partial_{\\v x}\\cdot\\m b^{\\star } \\end{array}\\right]=\\nonumber \\\\ = & -\\m n\\left(\\v x\\right)\\left[\\begin{array}{c } \\partial_{\\v x}u\\\\ \\partial_{\\v y}u \\end{array}\\right]+\\left(2k_{b}t\\right)^{\\frac{1}{2}}\\m m_{\\frac{1}{2}}\\left(\\v x\\right)\\v{\\mathcal{w}}(t)+\\left(k_{b}t\\right)\\partial_{\\v x}\\cdot\\m n\\left(\\v x\\right),\\label{eq : original_system}\\end{aligned}\\ ] ] where @xmath213 is a parameter that controls the separation of time scales between the slow and fast variables , @xmath214 in the original ( inertial ) dynamics . here",
    "the linear operators @xmath215 , @xmath216 and @xmath217 depend _ only _ on the slow variable @xmath4 , and @xmath218 and @xmath219 satisfy the fluctuation - dissipation balance condition ( [ eq : fdb ] ) , @xmath220 and @xmath221 . the langevin equation with position - dependent friction ( [ eq : inertial_langevin ] )",
    "is an example of this kind of system with the identification @xmath222 , @xmath223 , @xmath224 , @xmath225 , @xmath226 , @xmath227 .",
    "we will assume that the coarse - grained free energy @xmath228 is _ separable _ and _ quadratic _ in the fast variable , @xmath229 so that the equilibrium distribution ( invariant measure ) of @xmath230 for _ fixed _ @xmath4 is gaussian with mean @xmath231 and covariance @xmath232 that may depend on the slow variable . in particular , in the model equation ( [ eq : original_system ] ) the fast variable enters only linearly ( but the slow variable enters nonlinearly ) ; this greatly simplifies the limiting dynamics @xcite as @xmath233 . in the more general case",
    "one can not write a single sde for the slow variable @xmath4 that describes all aspects of the dynamics . instead ,",
    "depending on the type of observable and the time scale one is interested in , different equations arise in the limit .    as",
    "@xmath233 there is an infinite separation of time scales between @xmath4 and @xmath230 , and we can perform adiabatic elimination of the fast variable @xcite .",
    "the resulting overdamped dynamics is expected to be a good approximation to the original dynamics , @xmath214 . in the limit @xmath233",
    ", it can be shown @xcite ( for a review see also the book @xcite ) that the _ limiting _ or _ overdamped _",
    "dynamics for @xmath4 is @xmath234 and is time - reversible with respect to the equilibrium distribution @xmath235 . here",
    "the symbol @xmath16 denotes the kinetic stochastic interpretation @xcite . for future reference",
    ", we note that the last thermal drift in ( [ eq : limiting_equation ] ) can be expanded using the chain rule , @xmath236 and similarly , @xmath237 where the first term on the right hand side in index notation reads @xmath238 , and is the only drift term that would have appeared if the overdamped dynamics used a stratonovich interpretation .    here",
    "@xmath239 is the free energy in the slow variables , and can be obtained from the marginal distribution @xmath240 giving the relationship @xmath241 note that one can evaluate the derivative of the determinant using jacobi s formula , @xmath242 where colon denotes a double contraction , @xmath243 .",
    "one can construct a random finite difference approach ( see section [ sub : rfd ] ) to evaluate this term in expectation , using the identity @xmath244\\v w},\\label{eq : determinant_rdf}\\ ] ] where @xmath245 is a collection of i.i.d .",
    "standard normal variables .",
    "this only requires a routine for evaluating the trace @xmath246 once per time step , which is likely nontrivial in practice . however , the rfd ( [ eq : determinant_rdf ] ) avoids computing derivatives and is certainly more efficient than computing @xmath247 using finite differences to evaluate the gradient @xmath248 , since this requires evaluating a trace for _ each _ slow variable . in this work",
    "we do not study models where @xmath249 depends on the slow variable further , and henceforth @xmath250 .",
    "we now present two temporal integrators for solving ( [ eq : limiting_equation ] ) .",
    "the first scheme can be seen as an application of the explicit midpoint scheme ( [ eq : expl_midpoint ] ) to the overdamped equation ( [ eq : limiting_equation ] ) , and , aside from some of the stochastic drift terms , consists of applying the explicit midpoint scheme to the original system ( [ eq : original_system ] ) setting @xmath251 .",
    "similarly , we also present an implicit trapezoidal scheme ( [ eq : impl_trapezoidal ] ) applied to the overdamped equation ( [ eq : limiting_equation ] ) . in the explicit midpoint scheme we use a random finite difference ( rfd ) approach to handle several of the stochastic drift terms , as in ( [ eq : rfd_lang ] ) , and in the implicit trapezoidal scheme we show how one can use a fixman - like approach for one of the drift terms , as in ( [ eq : fixman_lang ] ) .    in the general nonlinear setting ,",
    "the schemes presented in this section are only first - order weakly accurate .",
    "they are deterministically second - order accurate . with care , the schemes",
    "_ can _ be second - order weak integrators for the _ linearized _ limiting dynamics , as we explained in section [ sec : linearized ] .",
    "note that the thermal drift terms play no role in the linearized overdamped dynamics because they are proportional to the small noise variance , and only terms of order one half in the noise variance are kept in the linearization . in order to achieve second - order accuracy",
    "the schemes below require solving three linear systems involving @xmath252 per time step . in cases when first - order accuracy is sufficient",
    ", one can avoid the linear solve in the rfd term ; this can save significant computer time in cases when computing the action of @xmath253 is the dominant cost .",
    "furthermore , in the case of constant @xmath252 , one can re - use the predictor s deterministic increment in the corrector for a first order scheme requiring only one linear solve . in this case , the role of the corrector stage is simply to obtain all of the required stochastic drift terms @xcite .    of course",
    ", the trapezoidal and the midpoint schemes we presented here do not exhaust all possibilities ; they are representative of a broad class of schemes that uses the original dynamics to approximate the overdamped dynamics . by combining the techniques we described here one",
    "can construct various schemes tailored to particular problems . in each specific application ,",
    "various terms may vanish , and a different approach may be more efficient , more stable , or simpler to implement , as we illustrate in section [ sec : applications ] on several applications in fluctuating hydrodynamics .      in the explicit midpoint scheme ,",
    "the predictor is an euler - maruyama step to the midpoint of the time step , @xmath254=-\\left[\\begin{array}{cc } \\m a & \\m b\\\\ -\\m b^{\\star } & \\m c \\end{array}\\right]^{n}\\left[\\begin{array}{c } \\partial_{\\v x}f\\\\ \\m{\\psi}\\left(\\v x\\right)\\left(\\v y-\\bar{\\v y}\\left(\\v x\\right)\\right ) \\end{array}\\right]^{n}+\\sqrt{\\frac{2k_{b}t}{\\left(\\d t/2\\right)}}\\,\\left[\\begin{array}{cc } \\m a_{\\frac{1}{2 } } & \\m 0\\\\ \\m 0 & \\m c_{\\frac{1}{2 } } \\end{array}\\right]^{n}\\left[\\begin{array}{c } \\v w_{\\v x}^{n,1}\\\\ \\v w_{\\v y}^{n,1 } \\end{array}\\right],\\label{eq : mid_pred}\\ ] ] in terms of just @xmath4 , the predictor step above is equivalent to an euler - maruyama half - step for the limiting equation , without the stochastic drift terms , @xmath255 in practical implementation , however , we first solve a linear system for @xmath230 and then take an euler - maryama step for @xmath4 using the obtained solution for @xmath230 .",
    "this makes it very easy to convert a semi - implicit code for simulating the original dynamics ( [ eq : original_system ] ) to simulate the overdamped dynamics , using a much larger time step size than possible for the original inertial dynamics .",
    "note , however , that a solver for linear systems involving @xmath252 must be implemented and applied each time step ; this will in general significantly increase the cost of an overdamped step compared to a fully _ explicit _",
    "scheme for the original dynamics . in practice , however , the extreme stiffness in the original dynamics will force us to use a semi - implicit scheme even for the original dynamics ( for example , most fluid dynamics codes treat viscosity , or , more generally , diffusion , semi - implicitly ) , and the required linear solvers will already be available .",
    "if first - order weak accuracy is sufficient , we can reuse the same noise amplitude in the corrector stage as in the predictor stage , and include rfd terms to capture the stochastic drift terms ,    @xmath256 & = & -\\left[\\begin{array}{cc } \\m a & \\m b\\\\ -\\m b^{\\star } & \\m c \\end{array}\\right]^{p , n+\\frac{1}{2}}\\left[\\begin{array}{c } \\partial_{\\v x}f\\\\ \\m{\\psi}\\left(\\v x\\right)\\left(\\v y-\\bar{\\v y}\\left(\\v x\\right)\\right ) \\end{array}\\right]^{p , n+\\frac{1}{2}}\\label{eq : mid_corr_1st_order}\\\\   & + & \\sqrt{\\frac{k_{b}t}{\\d t}}\\,\\left[\\begin{array}{cc } \\m a_{\\frac{1}{2 } } & \\m 0\\\\ \\m 0 & \\m c_{\\frac{1}{2 } } \\end{array}\\right]^{n}\\left[\\begin{array}{c } \\v w_{\\v x}^{n,1}+\\v w_{\\v x}^{n,2}\\\\ \\v w_{\\v y}^{n,1}+\\v w_{\\v y}^{n,2 } \\end{array}\\right]\\nonumber \\\\   & + & \\frac{k_{b}t}{\\delta}\\left[\\begin{array}{c } \\m a\\left(\\v x^{n}+\\delta\\widetilde{\\m w}^{n}\\right)-\\m a\\left(\\v x^{n}\\right)\\\\ \\m b^{\\star}\\left(\\v x^{n}\\right)-\\m b^{\\star}\\left(\\v x^{n}+\\delta\\widetilde{\\m w}^{n}\\right ) \\end{array}\\right]\\widetilde{\\m w}^{n}.\\nonumber \\end{aligned}\\ ] ]    note that here we can re - use the same random numbers @xmath63 for both stochastic drift terms , but this is not necessary .",
    "the corrector step includes random finite differences to capture the stochastic drift terms @xmath257 and @xmath258 , as we did in ( [ eq : rfd_lang ] ) .",
    "the remaining drift term @xmath259 is obtained from the predictor step in the spirit of runge - kutta schemes , as can be confimed by a taylor series analysis ( see appendix [ sec : appendix - kinetic ] for further details ) . to see this , note that the stochastic increment in @xmath260 involving @xmath261 is @xmath262 in the corrector , we have the stochastic increment @xmath263 if we expand @xmath264 to first - order around @xmath265 , we see that @xmath266 contains a term @xmath267 , more precisely , in index notation , the @xmath268-th component of the additional term is @xmath269 evaluated at time step @xmath36 , where @xmath270 . upon taking expectation values , @xmath271",
    ", we obtain the required drift term @xmath272 in ( [ eq : bcb_drift ] ) , since @xmath273      if we want to obtain second - order weak accuracy for the _ linearized _ overdamped dynamics , we should evaluate the noise in the corrector at the predicted midpoint value , as in the explicit midpoint algorithm ( [ eq : expl_midpoint ] ) .",
    "this is however only consistent with a stratonovich interpretation of the noise in the overdamped dynamics and is not consistent with the kinetic interpretation we seek . in order to be consistent with a kinetic interpretation",
    ", we need to add rfd terms to capture the correct stochastic drift terms ( see appendix [ sec : appendix - kinetic ] ) , @xmath256 & = & -\\left[\\begin{array}{cc } \\m a & \\m b\\\\ -\\m b^{\\star } & \\m c \\end{array}\\right]^{p , n+\\frac{1}{2}}\\left[\\begin{array}{c } \\partial_{\\v x}f\\\\ \\m{\\psi}\\left(\\v x\\right)\\left(\\v y-\\bar{\\v y}\\left(\\v x\\right)\\right ) \\end{array}\\right]^{p , n+\\frac{1}{2}}\\label{eq : mid_corr}\\\\   & + & \\sqrt{\\frac{k_{b}t}{\\d t}}\\,\\left[\\begin{array}{cc } \\m a_{\\frac{1}{2}}^{p , n+\\frac{1}{2 } } & \\m 0\\\\ \\m 0 & \\m c_{\\frac{1}{2}}^{p , n+\\frac{1}{2 } } \\end{array}\\right]\\left[\\begin{array}{c } \\v w_{\\v x}^{n,1}+\\v w_{\\v x}^{n,2}\\\\ \\v w_{\\v y}^{n,1}+\\v w_{\\v y}^{n,2 } \\end{array}\\right]\\nonumber \\\\   & + & \\frac{k_{b}t}{\\delta}\\left[\\begin{array}{c } \\m a_{\\frac{1}{2}}^{n}\\left(\\m a_{\\frac{1}{2}}^{\\star}\\left(\\v x^{n}+\\delta\\widetilde{\\v w}_{a}^{n}\\right)-\\m a_{\\frac{1}{2}}^{\\star}\\left(\\v x^{n}\\right)\\right)\\\\ \\m b^{\\star}\\left(\\v x^{n}+\\delta\\widetilde{\\v w}_{a}^{n}\\right)-\\m b^{\\star}\\left(\\v x^{n}\\right ) \\end{array}\\right]\\widetilde{\\v w}_{a}^{n}\\nonumber \\\\   & - & \\frac{k_{b}t}{\\delta}\\left[\\begin{array}{c } 0\\\\ \\m c_{\\frac{1}{2}}\\left(\\v x^{n}+\\delta\\left(\\m b\\m c^{-1}\\m c_{\\frac{1}{2}}\\right)^{n}\\widetilde{\\v w}_{c}^{n}\\right)-\\m c_{\\frac{1}{2}}\\left(\\v x^{n}\\right ) \\end{array}\\right]\\widetilde{\\v w}_{c}^{n},\\nonumber \\end{aligned}\\ ] ] where @xmath274 and @xmath275 are independently - generated random vectors .",
    "as we show in appendix [ sec : appendix - kinetic ] , the scheme ( [ eq : mid_corr ] ) is weakly first - order accurate in general , while also achieving second order weak accuracy for the linearized overdamped dynamics . in @xcite",
    "we successfully used the scheme ( [ eq : mid_pred],[eq : mid_corr ] ) to integrate the equations of brownian dynamics , which result when one eliminates the fast velocity degrees of freedom from a system of equations for the motion of particles immersed in a fluctuating stokes fluid .",
    "the midpoint scheme is ( [ eq : mid_pred],[eq : mid_corr ] ) a _ second - order _ weak integrator for the _ linearized _ overdamped equations .",
    "this is because it can be seen as an application of the explicit midpoint scheme ( [ eq : expl_midpoint ] ) to the limiting dynamics ( [ eq : limiting_equation ] ) , which we concluded in section [ sub : linearization ] to be a second - order integrator for linearized langevin equations .",
    "this shows the importance of carefully selecting where to evaluate the noise amplitude in the corrector stage in the nonlinear setting , and balancing this with rfd terms to ensure consistency with the nonlinear equations . in the case of constant @xmath252",
    ", one can omit the last line in ( [ eq : mid_corr ] ) , similarly , if @xmath276 is constant one can omit the corresponding rfd term .",
    "furthermore , in some cases , such as the specific example studied in section [ sub : constcoeff ] , there is no difference between a stratonovich or a kinetic interpretation of the limiting dynamics and one can use the corrector ( [ eq : mid_corr ] ) without the rfd terms on the last two lines of ( [ eq : mid_corr ] ) .      in this section",
    "we explain how the implicit trapezoidal scheme ( [ eq : impl_trapezoidal ] ) can be used to simulate the overdamped dynamics ( [ eq : limiting_equation ] ) .",
    "we will assume that @xmath277 and treat this term semi - implicitly .",
    "all remaining terms , including the stochastic drift term @xmath278 , which arises due to the elimination of the fast variable , will be handled explicitly .",
    "the predictor step consists of taking an overdamped step for @xmath230 , which simply amounts to deleting the term @xmath279 in ( [ eq : original_system ] ) , followed by an implicit trapezoidal step for @xmath4 .",
    "symbolically , @xmath280=-\\left[\\begin{array}{c } \\frac{1}{2}\\m l^{n}\\left(\\v x^{n}+\\v x^{p , n+1}\\right)+\\left(\\m b\\m{\\psi}\\right)^{n}\\left(\\v y^{n}-\\bar{\\v y}^{n}\\right)\\\\ -\\left(\\m b^{\\star}\\partial_{\\v",
    "x}f\\right)^{n}+\\left(\\m c\\m{\\psi}\\right)^{n}\\left(\\v y^{n}-\\bar{\\v y}^{n}\\right ) \\end{array}\\right]+\\sqrt{\\frac{2k_{b}t}{\\d t}}\\,\\left[\\begin{array}{cc } \\m a_{\\frac{1}{2 } } & \\m 0\\\\ \\m 0 & \\m c_{\\frac{1}{2 } } \\end{array}\\right]^{n}\\left[\\begin{array}{c } \\v w_{\\v x}^{n}\\\\ \\v w_{\\v y}^{n } \\end{array}\\right].\\label{eq : trap_pred}\\ ] ] note that here we have omitted all thermal drift terms ; we will rely on the corrector to obtain those .",
    "the corrector step consists of solving the following linear system for @xmath160 and @xmath281 , @xmath256 & = & \\left[\\begin{array}{c } \\d{\\v x}/\\d t\\\\ \\d{\\v y}/\\d",
    "t \\end{array}\\right]\\label{eq : trap_corr}\\\\   & - & \\left[\\begin{array}{c } \\frac{1}{2}\\left(\\m l^{n}\\v x^{n}+\\m l^{p , n+1}\\v x^{n+1}\\right)+\\frac{1}{2}\\left(\\m b\\m{\\psi}\\right)^{p , n+1}\\left(\\v y^{p , n+1}-\\bar{\\v y}^{p , n+1}\\right)+\\frac{1}{2}\\left(\\m b\\m{\\psi}\\right)^{n}\\left(\\v y^{n}-\\bar{\\v y}^{n}\\right)\\\\ -\\left(\\m b^{\\star}\\partial_{\\v x}f\\right)^{p , n+1}+\\left(\\m c\\m{\\psi}\\right)^{p , n+1}\\left(\\v y^{p , n+1}-\\bar{\\v y}^{p , n+1}\\right ) \\end{array}\\right].\\nonumber \\end{aligned}\\ ] ] where the stochastic increments @xmath50 and @xmath282 are given in ( [ eq : stoch_incr ] ) .",
    "the stochastic increments @xmath50 and @xmath282 need to be carefully constructed in order to obtain the correct drift terms , and can be approximated in one of two ways . for the case",
    "when @xmath276 is invertible , we can use a fixman like approach to obtain the drift term @xmath257 in the corrector step , just as we illustrated for the simple langevin equation in ( [ eq : fixman_lang ] ) , @xmath283 & = & \\sqrt{\\frac{2k_{b}t}{\\d t}}\\,\\left[\\begin{array}{cc } \\frac{1}{2}\\left(\\m a^{n}+\\m a^{p , n+1}\\right)\\left(\\m",
    "a^{-1}\\m a_{\\frac{1}{2}}\\right)^{n } & \\m 0\\\\ \\m 0 & \\m c_{\\frac{1}{2}}^{n } \\end{array}\\right]\\left[\\begin{array}{c } \\v w_{\\v x}^{n}\\\\ \\v w_{\\v y}^{n } \\end{array}\\right]\\label{eq : stoch_incr}\\\\   & + & 2\\frac{k_{b}t}{\\delta}\\left[\\begin{array}{c } \\v 0\\\\ \\m b^{\\star}\\left(\\v x^{n}\\right)-\\m b^{\\star}\\left(\\v x^{n}+\\delta\\widetilde{\\m w}^{n}\\right ) \\end{array}\\right]\\widetilde{\\m w}^{n}.\\nonumber \\end{aligned}\\ ] ] the scheme ( [ eq : trap_corr],[eq : stoch_incr ] ) is only first - order weakly accurate even for the linearized overdamped dynamics .    if we want to obtain second - order weak accuracy for the _ linearized _ overdamped dynamics , we should evaluate the noise in the corrector at the predicted value , as in the implicit trapezoidal algorithm ( [ eq : impl_trapezoidal ] ) . in this case",
    "we need to capture the remaining terms with an rfd approach , as we did in ( [ eq : mid_corr ] ) , @xmath283= & \\sqrt{\\frac{2k_{b}t}{\\d t}}\\,\\left[\\begin{array}{cc } \\frac{1}{2}\\left(\\m a_{\\frac{1}{2}}^{n}+\\m a_{\\frac{1}{2}}^{p , n+1}\\right ) & \\m 0\\\\ \\m 0 & \\m c_{\\frac{1}{2}}^{p , n+1 } \\end{array}\\right]\\left[\\begin{array}{c } \\v w_{\\v x}^{n}\\\\ \\v w_{\\v y}^{n } \\end{array}\\right]\\label{eq : trap_stoch_incr_2nd}\\\\ + & \\frac{k_{b}t}{\\delta}\\left[\\begin{array}{c } \\m a_{\\frac{1}{2}}^{n}\\left(\\m a_{\\frac{1}{2}}^{\\star}\\left(\\v x^{n}+\\delta\\widetilde{\\v w}_{a}^{n}\\right)-\\m a_{\\frac{1}{2}}^{\\star}\\left(\\v x^{n}\\right)\\right)\\\\ 2\\left(\\m b^{\\star}\\left(\\v x^{n}+\\delta\\widetilde{\\v w}_{a}^{n}\\right)-\\m b^{\\star}\\left(\\v x^{n}\\right)\\right ) \\end{array}\\right]\\widetilde{\\v w}_{a}^{n}\\nonumber \\\\ - & \\frac{k_{b}t}{\\delta}\\left[\\begin{array}{c } 0\\\\ \\left(2\\m c_{\\frac{1}{2}}\\left(\\v x^{n}+\\delta\\left(\\m b\\m c^{-1}\\m c_{\\frac{1}{2}}\\right)^{n}\\widetilde{\\v w}_{c}^{n}\\right)-\\m c_{\\frac{1}{2}}\\left(\\v x^{n}\\right)\\right ) \\end{array}\\right]\\widetilde{\\v w}_{c}^{n}.\\nonumber \\end{aligned}\\ ] ] note that the computation of @xmath284 involves solving a linear system involving @xmath252 and will thus , generally , significantly increase the computational effort per time step . in the case of constant @xmath276 or @xmath252 , one can omit the corresponding rfd terms to simplify the scheme . for a stratonovich interpretation of the limiting dynamics ,",
    "one simply omits the last two terms of ( [ eq : trap_stoch_incr_2nd ] ) .",
    "in this section we apply the techniques we developed in this work to the fluctuating hydrodynamics problems described in section [ sub : fhd ] . in the example considered here many of the stochastic drift terms present in the more general case are not present . in @xcite",
    "we presented a numerical method for performing brownian dynamics for particles suspended in a fluid , based on treating the fluid velocity as a fast degree of freedom compared to the positions of the particles .",
    "that example includes the majority of the stochastic drift terms that appear in a general setting , except that @xmath252 is constant , and employs our midpoint scheme for overdamped dynamics essentially in its full generality .",
    "we model the diffusion of a concentration field that is passively advected by the randomly fluctuating fluid velocity , as we first discussed in section [ sub : fhd ] . in the nonlinear overdamped setting , the methods presented here can be used to model diffusion of labeled or tracer particles in liquids over a broad range of length scales , as we did in ref . @xcite . in the linearized setting ,",
    "the same methods can be used to study the spatio - temporal spectrum of gaussian fluctuations around steady or dynamic deterministic flows @xcite , as we first did in ref .",
    "@xcite for a steady state and extend in this work to a dynamic setting in section [ sec : gradflex ] . in section [ sec : soret ] we present an application of the methods developed here to study the dynamic structure factors in binary fluid mixtures subjected to a small temperature gradient , in the presence of gravity and confinement @xcite .",
    "we consider the velocity - concentration system ( [ eq : fluct_ns],[eq : c_eq_original ] ) in a simplified setting in which the noise in the concentration equation is additive and we omit the nonlinear term @xmath81 , @xmath285 where @xmath286 and @xmath100 , where @xmath29 is the mass of the tracer particles and @xmath101 is a reference concentration .",
    "for simplicity we have replaced @xmath287 by @xmath288 , assuming that the filtering is done by an implicit truncation of the spde at small scales ; this is naturally performed in the finite - volume discretizations of this system described in @xcite .",
    "note that for incompressible @xmath288 we have @xmath289 . in ( [ eq : const - coeff ] ) the constraint @xmath70",
    "is enforced by the helmholtz projection operator @xmath290 , where @xmath291 denotes the divergence operator and @xmath292 the gradient operator with the appropriate boundary conditions taken into account .    the coupled velocity - concentration system ( [ eq : const - coeff ] ) can be written as an infinite - dimensional system of the form ( [ eq : original_system ] ) with the identification @xmath293 as the ( potentially ) fast variable and @xmath294 as the slow variable .",
    "we have a quadratic ( gaussian ) coarse - grained energy _ functional _ that includes a contribution due to the ( excess ) gravitational potential energy of the tracer particles of excess mass ( over the solvent ) of @xmath295 , @xmath95=\\frac{\\rho}{2}\\int v^{2}\\left(\\v r\\right)\\ , d\\v r+\\beta\\rho\\int c\\left(\\v r\\right)\\left(\\v r\\cdot\\v g\\right)\\ , d\\v r+\\frac{k_{b}t}{2\\vartheta_{0}}\\int c^{2}\\left(\\v r\\right)\\ , d\\v r,\\label{eq : u_fns-2}\\ ] ] which corresponds to @xmath296 , @xmath297 a multiple of the identity , and quadratic @xmath298 .",
    "the mobility rather than the advective form @xmath92 , as required for momentum conservation in the presence of gravity . ] and noise operators can be taken to be @xmath299=\\left[\\begin{array}{cc } \\m a & \\m b\\\\ -\\m b^{\\star } & \\m c \\end{array}\\right]\\equiv-\\left[\\begin{array}{cc } \\left(k_{b}t\\right)^{-1}\\chi_{0}\\vartheta_{0}\\grad^{2 } & -\\rho^{-1}\\grad\\cdot c\\m{\\mathcal{p}}\\\\ -\\rho^{-1}\\m{\\mathcal{p}}c\\grad & \\rho^{-1}\\nu\\left(\\m{\\mathcal{p}}\\grad^{2}\\m{\\mathcal{p}}\\right ) \\end{array}\\right]\\ ] ] and @xmath300=\\left[\\begin{array}{cc } \\m a_{\\frac{1}{2 } } & \\m 0\\\\ \\m 0 & \\epsilon^{-1}\\m c_{\\frac{1}{2 } } \\end{array}\\right]=\\left[\\begin{array}{cc } \\sqrt{\\chi_{0}\\vartheta_{0}/k_{b}t}\\,\\grad\\cdot & \\m 0\\\\ \\m 0 & \\sqrt{\\rho^{-1}\\nu}\\,\\m{\\mathcal{p}}\\grad\\cdot \\end{array}\\right],\\ ] ] where differential operators act on everything to their right and we note that only the operator @xmath301 $ ] is a functional of the slow variable @xmath302 .",
    "the diagonal blocks of the mobility operator @xmath13 generate momentum and ( bare ) mass diffusion and the corresponding noise terms .",
    "the upper right block of @xmath13 generates the advective term @xmath303 in the concentration equation , while the lower left block of @xmath13 generates the gravity term in the velocity equation , @xmath304 where we used the fact that projection eliminates pure gradients .",
    "this last property allows for a key simplification , namely , the stochastic drift term involving @xmath305 $ ] can be omitted , and there is no difference between a kinetic and a stratonovich interpretation of the overdamped dynamics @xcite .",
    "we take advantage of these properties in the algorithms presented next .",
    "it is important to note that these simplifying properties are also valid after ( careful ) spatial discretization of the spdes @xcite .",
    "also note that spatially - discretized white noise acquires an additional factor of @xmath306 , where @xmath307 is the volume of the grid cells @xcite .",
    "note that a more complete but formal calculation @xcite using the true ideal gas entropy functional ( [ eq : u_fns ] ) would set @xmath308 , where all differential operators act to their right , and obtain multiplicative noise as well as an additional _ barodiffusion _ term in the concentration equation , @xmath309+\\grad\\cdot\\left(\\sqrt{2\\chi_{0}\\rho^{-1}mc}\\,\\m{\\mathcal{w}}_{c}\\right).\\label{eq : c_eq_barodiff}\\ ] ] the barodiffusion term is only important in the presence of very high gravitational energies such as in ultracentrifuges , and we will neglect it here and use ( [ eq : c_eq_original ] ) instead .      for the full inertial dynamics ( [ eq : const - coeff ] ) , applying our predictor - corrector methods would require treating the diffusion of both momentum and mass with the same scheme , i.e. , both would need to treated implicitly or both treated explicitly .",
    "similarly , if a semi - implicit method is used , two linear solves would be required , one for the predictor and one for the corrector stage .",
    "however , we can take specific advantage of the structure of ( [ eq : const - coeff ] ) and use a _ split _ approach , in which we handle concentration and velocity differently , for example , we can treat viscosity implicitly ( since velocity is a faster variable ) and treat mass diffusion explicitly ( since concentration is a slower variable ) . in algorithm [ alg : inertialconstant ]    we present an optimized split scheme for integrating ( [ eq : const - coeff ] ) , which only requires a single fluid solve per time step .",
    "note that this scheme can be made second - order accurate deterministically for the fully nonlinear navier - stokes equation by using a time - lagged ( multi - step ) scheme for the advective term @xmath310 .",
    "here we treat concentration implicitly but an explicit treatment is also possible . in section",
    "[ sec : soret ] we use algorithm [ alg : inertialconstant ] to study the difference between the inertial and overdamped dynamics for a problem involving a fluid sample subjected to a concentration gradient , in the presence of gravity .    1 .   in the predictor step for concentration , solve for @xmath311 , @xmath312 2 .",
    "solve the time - dependent stokes or navier - stokes system for @xmath313 and @xmath314 , @xmath315 the nonlinear advective term @xmath316 can be omitted in the stokes limit , or approximated to second - order accuracy using an adams - bashforth approach .",
    "3 .   correct the concentration by solving @xmath317    the analysis presented in this work does not directly apply to split schemes and confirming second - order weak accuracy requires custom analysis .",
    "empirical order of accuracy tests can also be used but note that these can be misleading since error terms that dominate for very small time step sizes may be negligible for time step sizes of interests .",
    "for very small @xmath60 , statistical errors are often much larger than the truncation errors , making empirical convergence studies computationally infeasible .",
    "for completeness , in algorithm [ alg : varcoeffinert ] we apply our implicit trapezoidal integrator ( [ eq : impl_trapezoidal ] ) to the variable - coefficient inertial equations ( [ eq : variable_coeff ] ) ; this integrator requires two concentration and two velocity ( stokes ) linear solves per time step .",
    "our analysis shows that this is a second - order weak integrator for the _ linearized _ inertial equations .",
    "we do not use this integrator in this work because a constant - coefficient incompressible approximation is appropriate in the ( passive tracer ) applications we study here . note that for incompressible @xmath288 the conservative and advective forms are equivalent , @xmath289 ; in the numerical schemes it is preferred to use the conservative form to ensure strict conservation of mass and momentum even when imposing the divergence - free constraint on the velocity only to some finite threshold . note that the nonlinear advective terms can alternatively be handled using a midpoint rule following ( [ eq : impl_trap_expl_mid ] ) .",
    "for example , @xmath318/2 $ ] can be replaced by @xmath319 without affecting the order of accuracy .    1 .   in the predictor step for concentration ,",
    "solve for @xmath311 , @xmath320+\\grad\\cdot\\left(\\sqrt{\\frac{2\\left(\\chi\\rho^{-1}\\mu_{c}^{-1}\\right)^{n}k_{b}t}{\\d t\\d v}}\\,\\v w_{c}^{n}\\right),\\ ] ] and solve ( independently ) the variable - coefficient stokes system for @xmath321 and @xmath322 @xcite , @xmath323\\\\ \\grad\\cdot\\v v^{p , n+1 } & = & 0.\\end{aligned}\\ ] ] 2 .   correct the concentration by solving , @xmath324+\\frac{1}{2}\\grad\\cdot\\left[\\chi^{n}\\grad c^{n}+\\chi^{p , n+1}\\grad c^{n+1}\\right]\\\\   & + & \\frac{1}{2}\\grad\\cdot\\left[\\left(\\sqrt{\\frac{2\\left(\\chi\\rho^{-1}\\mu_{c}^{-1}\\right)^{n}k_{b}t}{\\d t\\d v}}+\\sqrt{\\frac{2\\left(\\chi\\rho^{-1}\\mu_{c}^{-1}\\right)^{p , n+1}k_{b}t}{\\d t\\d v}}\\right)\\v w_{c}^{n}\\right],\\end{aligned}\\ ] ] and correct the velocity by solving ( independently ) the the variable - coefficient stokes system for @xmath313 and @xmath314 @xcite , @xmath325-\\frac{\\beta\\rho}{2}\\left(c^{n}+c^{p , n+1}\\right)\\v g\\\\   & + & \\frac{1}{2}\\grad\\cdot\\left(\\eta^{n}\\bar{\\grad}\\v v^{n}+\\eta^{p , n+1}\\bar{\\grad}\\v v^{n+1}\\right)+\\\\   & + & \\frac{1}{2}\\grad\\cdot\\left[\\left(\\sqrt{\\frac{2\\eta^{n}k_{b}t}{\\d t\\,\\d v}}+\\sqrt{\\frac{2\\eta^{p , n+1}k_{b}t}{\\d t\\,\\d v}}\\right)\\,\\m w^{n}\\right]\\\\ \\grad\\cdot\\v v^{n+1 } & = & 0.\\end{aligned}\\ ] ]      the overdamped limit of ( [ eq : const - coeff ] ) is the stratonovich spde @xcite @xmath326 where the notation is explained in section [ sub : overdampedfhd ] . in algorithm",
    "[ alg : overdampedconstant ]    we give a temporal integrator for this equation , which we first proposed in appendix b of ref .",
    "this algorithm can be seen as an application of the implicit trapezoidal method ( [ eq : impl_trap_expl_mid ] ) to ( [ eq : limiting_strato_const ] ) , with the identifications @xmath327=\\beta\\rho\\eta^{-1}\\left(\\m",
    "g\\star c\\v g\\right)\\cdot\\grad c,\\ ] ] and @xmath328\\circ\\v{\\mathcal{w}}\\left(t\\right)\\equiv\\sqrt{2\\eta^{-1}k_{b}t}\\,\\left(\\m g_{\\myhalf}\\m{\\mathcal{w}}\\right)\\odot\\grad c+\\grad\\cdot\\left(\\sqrt{2\\chi_{0}\\vartheta_{0}}\\,\\m{\\mathcal{w}}_{c}\\right).\\ ] ] note that the advective term in the corrector stage can alternatively be treated using an explicit trapezoidal rule , as in ( [ eq : impl_trapezoidal ] ) , without affecting the formal order of accuracy of the scheme .    1 .   in the predictor stage ,",
    "solve the steady stokes equation with random forcing , @xmath329 2 .",
    "do a predictor step for ( [ eq : limiting_strato ] ) by solving for @xmath311 , @xmath312 3 .",
    "solve the corrector steady stokes equation @xmath330 note that the same random stress is used here as in the predictor , so that if there is no gravity , we can set @xmath331 .",
    "in general if an iterative solver is used the solution from the predictor @xmath332 should be used as an initial guess to speed up the convergence .",
    "4 .   take a corrector step for concentration to compute @xmath333 , @xmath334    algorithm [ alg : overdampedconstant ] is weakly first - order accurate for the nonlinear overdamped dynamics , and second - order accurate for the linearized overdamped dynamics ( [ eq : linearized_overdamped ] ) .",
    "therefore , this method `` kills two birds with one stone '' and can be used for either strong ( nonlinear ) @xcite or weak ( linearized ) noise settings . in section [ sec : gradflex ] we use algorithm [ alg : overdampedconstant ] to study the dynamics of the development of giant concentration fluctuations in the absence of gravity .",
    "in this section we apply our temporal integrators to the study of diffusive mixing in binary liquid mixtures in the presence of a temperature gradient and gravity .",
    "the equations for the velocity @xmath69 and mass concentration @xmath82 for a mixture of two fluids can be approximated as @xmath335 where @xmath336 denotes white - noise stochastic forcing for the thermal fluctuations and @xmath76 is gravity .",
    "here we have ignored the stochastic forcing term @xmath102 , which is responsible for equilibrium fluctuations in the concentration , since our focus will be on the much larger nonequilibrium fluctuations induced by the coupling to the velocity equation via the advective term @xmath92 . the shear viscosity @xmath337 , mass diffusion coefficient @xmath338 , solutal expansion coefficient @xmath77 , and soret coefficient @xmath339 , are assumed to be given material constants independent of concentration .",
    "furthermore , the density @xmath72 is taken to be constant in a boussinesq approximation .",
    "temperature fluctuations are not considered in a large lewis number ( very fast temperature dynamics ) approximation @xcite .",
    "we assume that the applied temperature gradient @xmath340 is weak and approximate @xmath341 . in principle",
    "there is no difficulty in making the temperature be spatially - dependent , however , our simplifying approximation is justified because the typical relative temperature difference across the sample is not large .",
    "these equations are extremely difficult to integrate numerically for large schmidt number , @xmath342 , if one wants to get dynamics correctly .",
    "therefore , we actually take a limit of the above equations @xmath343 and integrate the resulting dynamics numerically . in a linearized setting , @xmath344 and @xmath345 , the overdamped equations are written in @xcite as a large schmidt and large lewis number approximation to the complete system of equations , @xmath346 where @xmath347 is the concentration gradient imposed by the applied temperature gradient .",
    "theoretical analysis is based on the simplified linearized equations ( [ eq : vc_linearized_overdamped ] ) under the assumption that the appplied gradient @xmath348 is constant and weak .",
    "the theory predicts the _ steady - state _ spectrum of the concentration fluctuations at wave number @xmath349 to be @xcite    @xmath350    where * @xmath351 * and @xmath352 denote the perpendicular and parallel component relative to gravity , respectively .",
    "the characteristic @xmath353 power - law divergence of the spectrum at large wavenumbers is a signature of long - ranged nonequilibrium fluctuations and leads to a dramatic increase in the magnitude and correlation length of the fluctuations compared to systems in thermodynamic equilibrum ; this effect has been termed _ giant fluctuations _",
    "@xcite . the expression ( [ eq : s_c_c ] )",
    "shows that fluctuations at wavenumbers below the critical ( rollover ) wave number @xmath354 are suppressed by gravity .",
    "henceforth we will assume that the gradient is parallel to gravity , @xmath355 .",
    "for the dynamics of vertically - averaged concentration , i.e. , for @xmath356 , @xmath357 , the linearization ( [ eq : vc_linearized_overdamped ] ) predicts an exponential time correlation function @xmath358 with decay time @xmath359.\\label{eq : tau_overdamped}\\ ] ] the relaxation has a minimum at @xmath360 with value @xmath361 . for smaller wavenumbers",
    "@xmath362 becomes the smallest time scale and limits the stability of the simulations . as we discuss in section [ sec : soret ] , at small wavenumbers the separation of time scales used to justify the overdamped limit fails and the fluid inertia has to be taken into account . in the absence of gravity , however , as we discuss in section [ sec : gradflex ] , the separation of time scales is uniform across all length scales and the overdamped limit can be used .      in this section",
    "we perform computer simulations of diffusive mixing in microgravity , recently studied aboard a satellite in orbit around the earth during the gradflex experiment @xcite .",
    "the experimental configuration consists of a dilute solution of polystyrene in toluene with average concentration @xmath363 , confined between two parallel transparent plates that are a distance @xmath364 apart .",
    "a temperature gradient @xmath365 is imposed along the @xmath366 axes via the plates at time @xmath367 . at long times",
    ", the weak temperature gradient leads to a strong concentration gradient @xmath368 due to the soret effect , giving rise to an exponential steady - state concentration profile @xmath369 .",
    "quantitative shadowgraphy is used to observe and measure the strength of the fluctuations in the concentration around @xmath370 via the change in the refraction index .",
    "some of us already modeled the _ steady - state _ fluctuations in the gradflex experiment using the inertial equations ( [ eq : llns_comp_v_simp],[eq : llns_comp_c_simp ] ) in previous work @xcite . here",
    "we extend this study to also model the _ dynamics _ of the concentration fluctuations following the time when the temperature gradient is first applied ( to a uniform sample ) , before the steady state is reached . in future work",
    "we will compare our numerical results to experimental measurements .    in the actual experiments reported in ref .",
    "@xcite , concentration diffusion is much slower than momentum diffusion , corresponding to schmidt number @xmath371 .",
    "this level of stiffness makes direct simulation of the temporal dynamics of the fluctuations infeasible , as long averaging is needed to obtain accurate steady - state spectra , especially for small wavenumbers . in order to bypass this problem , in our previous work @xcite",
    "we artificially increased @xmath338 and decreased @xmath372 to reduce the schmidt number , while keeping the product @xmath373 fixed .",
    "this is exactly the scaling in which one can formally derive the limiting overdamped dynamics ( [ eq : limiting_strato ] ) @xcite , and from ( [ eq : s_c_c ] ) we see that the static structure factor depends only on the product @xmath373 when @xmath374 . in fact , artificially decreasing the schmidt number while keeping @xmath373 fixed , and rescaling time appropriately , can be seen as an instance of the _ seamless _ multiscale method presented in ref .",
    "@xcite . here",
    "we take the overdamped limit and solve the limiting equations numerically , thus completely avoiding the stiffness issue .",
    "this allows us to take a much larger time step size , related to the time scale of mass diffusion , rather than the fast momentum diffusion .    for the gradlex experiments we can assume @xmath375 and thus @xmath376 to make the soret term linear in concentration and treat the soret flux as advection by a soret velocity @xmath377 , to obtain the concentration equation employed in our numerical method , @xmath378 we integrate the overdamped limit of ( [ eq : llns_comp_v_simp],[eq : c_gradflex ] ) for @xmath379 in time using algorithm [ alg : overdampedconstant ] .",
    "the spatial discretization and the physical parameters are essentially identical to those used in incompressible simulations in our previous work , see section v in @xcite .",
    "an important improvement is that we now handle both the soret term and the boundary condition for concentration implicitly , thus ensuring strict conservation of the total solutal mass .",
    "the domain is periodic in the directions parallel to the boundaries . at the top and bottom boundaries",
    "a no - flux boundary condition is imposed for the concentration , and a no - slip boundary condition is imposed for velocity .",
    "the observed light intensity , once corrected for the optical transfer function of the equipment , is proportional to the intensity of the fluctuations in the concentration averaged along the gradient , @xmath380 and this is the main quantity of interest in our simulations .",
    "what is actually measured experimentally is the static structure factor , which is the fourier transform @xmath381 of the concentration fluctuations averaged along the gradient direction , @xmath382    because of the increase in the time step afforded by the use of the overdamped integrator , we are able here to perform fully three - dimensional simulations on a domain of dimensions @xmath383 , discretized on a @xmath384 grid with uniform grid spacing @xmath385 . here",
    "the thickness of the sample is @xmath386 and corresponds to the experimental setup , and the lateral extend is set to @xmath387 . the structure factors @xmath388 were averaged radially to obtain @xmath389 , where @xmath390 .",
    "note that in this case it is possible to obtain the same results using two - dimensional simulations ( @xmath391 ) because of the symmetries of the linearized equations , nevertheless , we chose to obtain three - dimensional results directly comparable to experiments .",
    "the key physical parameters are @xmath392 , @xmath393 , @xmath394 , @xmath395 , @xmath396 , and the temperature difference is @xmath397 .",
    "additional details of the experimental setup and parameters are given in ref .",
    "the time step size was @xmath398 , corresponding to a diffusive courant number @xmath399 , and the results were averaged over 32 simulations . to obtain the static structure factor at steady state",
    ", we used a time step size that was twice larger , and averaged over 32 runs of length @xmath400 skipping the initial @xmath401 in the analysis .        in the left panel of fig .",
    "[ fig : s_k ] we show the static structure factor as a function of time , along with the steady state asymptotic value .",
    "we observe that it takes a long time , on the time scale of the macroscopic diffusive mixing , to actually establish the steady state .",
    "this is in contrast to experiments performed in gravity , where gravity accelerates the dynamics of the concentration fluctuations at the smaller wavenumbers , as seen in ( [ eq : tau_overdamped ] ) .",
    "this was used in refs .",
    "@xcite to construct a simple but approximate theory for the time evolution of the static structure factor during free diffusive mixing of two miscible liquids .",
    "such a simple theory can not be developed in microgravity because there is no separation of time scales between the dynamics of the mean and the dynamics of the fluctuations around the mean , and computer simulations become indispensable .      in this section",
    "we consider giant fluctuations in the presence of gravity .",
    "we model the experiments used in ref .",
    "@xcite to measure the soret and diffusion coefficients in binary mixtures using a setup similar to that in the gradflex experiment described in the previous section .",
    "a notable difference is that the average concentration @xmath402 is much larger than in the gradflex setup , and only a small relative concentration difference is induced by an applied modest temperature gradient .",
    "we therefore approximate @xmath403 in ( [ eq : llns_comp_c_simp ] ) , giving a constant mass soret flux . in this example , because we want to accurately resolve the decay of the time correlation functions over several orders of magnitude , we perform two dimensional simulations . as we already explained , there is no difference between two and three dimensional simulations because of the simple one - dimensional geometry of the deterministic solution @xcite .    by linearizing the inertial dynamics ( [ eq : llns_comp_v_simp],[eq : llns_comp_c_simp ] ) and taking a spatio - temporal fourier",
    "transform we can obtain an approximate theory for the spatio - temporal correlation functions for the concentration fluctuations .",
    "this straightforward analysis predicts that the static factor @xmath404 continues to follow ( [ eq : s_c_c ] ) if @xmath374 , but the time correlation function , unlike the overdamped result ( [ eq : s_k_t_inertial ] ) , is found to be a sum of two modes @xmath405 where we omit the long formula for @xmath406 and just quote the relaxation times @xmath407 in the limit @xmath408 , we get the diffusive relaxation time ( [ eq : tau_overdamped ] ) if we use the minus sign , @xmath409 , and for the plus sign we get the viscous relaxation time @xmath410\\approx\\nu k^{2}.\\label{eq : tau_overdamped-1}\\ ] ] where @xmath286 .",
    "note however that the relaxation times become complex - valued for @xmath411 indicating the appearance of _ propagative _ rather than diffusive modes for small wavenumbers .",
    "because of the fourth root power , for realistic values of @xmath412 , propagative modes appear at wavenumbers that are , in principle , observable in experiments via very low - angle light scattering and shadowgraph techniques , although , to our knowledge , experimental observation of propagative modes has only been reported for temperature fluctuations @xcite .",
    "this shows that there is a _ qualitative _ difference between the inertial and overdamped dynamics in this example .",
    "this comes because of the lack of separation between the relaxation times associated with mass ( @xmath413 ) and momentum diffusion ( @xmath414 ) for wavenumbers @xmath415 .",
    "in order to obtain accurate results over the whole range of wavenumbers observed in experiments , we need to account for the fluid inertia and integrate the system in time using algorithm ( [ alg : inertialconstant ] ) . for comparison we also numerically take the overdamped limit and use algorithm ( [ alg : overdampedconstant ] ) for the temporal integration .    in our simulations",
    "we use a grid of @xmath416 cells , with grid spacing @xmath417 cm .",
    "this corresponds to thickness of the sample of @xmath418 .",
    "the physical parameters correspond to the thn - c12 mixture studied in @xcite , @xmath419 , @xmath420 , @xmath421 , @xmath395 , @xmath422 , @xmath423 , @xmath424 and the temperature difference across the sample is @xmath425 . to obtain the time - correlation functions we analyze a single run corresponding to @xmath426 of physical time , skipping the initial @xmath427 .",
    "the time step used in both the inertial and overdamped integrators is @xmath428s , giving a viscous courant number @xmath429 .",
    "this means that the viscous dynamics is well - resolved by this small time step and there is no real benefit from using the overdamped equations . a larger time step can not be used here even in the overdamped limit because the relaxation time ( [ eq : tau_overdamped ] ) for the smallest wave number @xmath430 is @xmath431 , and therefore resolving the dynamics of the concentration requires a rather small time step .        in the right panel of fig .",
    "[ fig : s_k ] we show numerical results for the static structure factor @xmath432 , while in fig .",
    "[ fig : soret ] we show results for the dynamic structure factor @xmath433 .",
    "while the static factor shows no difference between the inertial and overdamped integrators , the dynamic factor clearly shows the appearance of oscillations ( propagative modes ) for the smallest wavenumbers when inertia is accounted for . for comparison , in fig .",
    "[ fig : soret ] we also plot the theory ( [ eq : s_k_t_inertial ] ) .",
    "we see a qualitative but not a quantitative agreement between the numerical results and the theory .",
    "this mismatch can be attributed to the effects of confinement by the two no - sip boundaries , which is not taken into account in the simple quasi - periodic theory used to derive ( [ eq : s_k_t_inertial ] ) .",
    "this effect becomes stronger the smaller the value of the dimensionless product @xmath434 is .",
    "constructing analytical theories in the presence of confinement and inertial effects is quite challenging and computer simulations are required to study these effects , which we will explore in more detail in future publications .",
    "continuing on our previous work @xcite , we constructed a general class of mixed explicit - implicit predictor - corrector schemes for integrating langevin equations , and recommended two specific schemes that we previously proposed in @xcite in the context of additive - noise langevin equations .",
    "the first is a fully explicit midpoint rule , and the second is a semi - implicit scheme in which some of the terms are treated using an implicit trapezoidal rule and the rest are treated using an explicit trapezoidal rule .",
    "here we showed how to add stochastic forcing terms to these schemes that ensure the following key properties : the schemes are second - order weakly accurate for linearized langevin equations , and they are weakly first - order accurate for multiplicative kinetic noise . in particular , we discussed how to obtain all of the required stochastic drift terms without evaluating derivatives , using random finite differences that give the required stochastic drift in expectation .",
    "the key idea in our approach was to discretize the original nonlinear langevin equations with sufficiently weak noise , and let the algorithm do the linearization for us , without us having to even write the linearized equations explicitly .",
    "this has numerous advantages over the alternative approach of splitting the variables into a deterministic mean plus fluctuations and then linearizing the equations manually .",
    "firstly , the linearization needs to be done around an unknown time - dependent solution of the deterministic equations , which must itself be computed numerically in general .",
    "secondly , the linearized equations typically have many more terms than the nonlinear equations , and do not obey conservation laws , leading to violation of conservation for the overall solution ( mean+fluctuations ) .",
    "lastly , our algorithms can , with care , also be used to integrate genuinely nonlinear langevin equations , and thus numerically access the importance of terms neglected by linearization @xcite . integrating the linearized equations to second - order weak accuracy proved to be relatively simple .",
    "essentially , all that is required is to evaluate the noise amplitude in the corrector step at the correct value for the time - dependent deterministic solution , e.g. , at the midpoint or end - point of the time step . in the general nonlinear setting , by contrast ,",
    "obtaining second - order accuracy with derivative - free schemes is rather nontrivial @xcite .",
    "we also proposed predictor - corrector schemes for integrating systems of langevin equations containing a fast and a slow variable , in the limit of infinite separation of time scales .",
    "we limited our attention here to the simple but common case of the fast variable entering only linearly ; the general case is much more subtle @xcite .",
    "our predictor - corrector schemes discretize the original equations but without the time derivative term in the equation for the fast variable , giving an effective integrator for the overdamped equations without ever explicitly even writing the limiting dynamics .",
    "one way to think about our integrators is as applying a backward euler method to the fast variable , since this method finds a steady state solution of the fast variable in the limit when the time step size is much larger than the internal time scale of the fast variable .",
    "an essential difficulty in the construction of integrators for the nonlinear overdamped equations is capturing the stochastic drift terms that arise due to the kinetic interpretation of the noise .",
    "we accomplished this goal by using a combination of implicit and explicit random finite differences .",
    "the integrators proposed here handle fast - slow systems by taking the limit of infinite separation of variables to eliminate the fast variable .",
    "such an asymptotic limit is often a good approximation , as we illustrated in the past when modeling diffusion in liquids @xcite , and also here by modeling the development of giant fluctuations in microgravity during the gradflex experiment @xcite .",
    "however , we also studied here the dynamics of giant fluctuations in earth gravity and found that the assumption of _ uniform _ separation of time scales between the fast velocity and slow concentration fails in practice for sufficiently small wavenumbers . in this paper , we resorted to integrating the original ( inertial ) equations using a sufficiently small time step .",
    "it remains an important challenge for the future to develop _ uniformly accurate _",
    "temporal integrators that remain weakly first - order accurate even when there is incomplete separation of time scales , while still allowing the use of large time step sizes , on the time scale of the slow variable .",
    "such integrators must likely rely on the linearity of the equation and exponential integrators @xcite for the fast variable .",
    "the key difficulty , which we hope to address in future work , is to correctly capture the effects of the fast velocity on the slow concentration that arise due to the nonlinear advective term @xmath92 @xcite .",
    "we would like to thank john bell , alejandro garcia , andy nonaka , and jonathan goodman for numerous enlightening discussions .",
    "we are indebted to fabrizio croccolo and alberto vailati for their assistance in setting up the simulations of giant fluctuations , and helpful comments on this manuscript .",
    "this material is based upon work supported by the u.s .",
    "department of energy office of science , office of advanced scientific computing research , applied mathematics program under award number de - sc0008271 .",
    "a. donev and y. sun were supported in part by the national science foundation ( nsf ) under grant dms-1115341 .",
    "b. griffith and s. delong acknowledge research support from the nsf under award oci 1047734 .",
    "e. vanden - eijnden and s. delong were supported by the doe office of advanced scientific computing research under grant de - fg02 - 88er25053 .",
    "additional support for e. vanden - eijnden was provided by the nsf under grant dms07 - 08140 and by the office of naval research under grant n00014 - 11 - 1 - 0345 .",
    "in this appendix , we show that the scheme ( [ eq : predcorr_scheme ] ) successfully captures the time dependence of @xmath173 in the equation ( [ eq : timedepnoise ] ) to second order .",
    "the general theory of weak accuracy for stochastic integrators is well - established and reviewed , for example , in section 2.2 of @xcite .",
    "the key result is that , under certain assumptions , second - order weak accuracy is achieved if the first @xmath435 moments of the numerical increment @xmath436 match the moments of the true increment @xmath437 with error no greater than @xmath438 .",
    "the time dependence of the noise amplitude only adds one additional term ( beyond constant noise ) that a second - order integrator must account for , which we find from the expansion @xmath439 here @xmath440 indicates a time derivative of @xmath173 , and likewise @xmath441 indicates a second derivative in time .",
    "the first term in the second line is order @xmath442 and mean zero , so it will not affect second order weak accuracy .",
    "likewise , terms which arise from the time dependence of @xmath173 in the taylor expansion of the deterministic part of ( [ eq : timedepnoise ] ) are all order greater than two and a half and mean zero .",
    "therefore , the only additional expression which must be accounted for in the temporal integrator is the second term on the first line of equation ( [ eq : noise_time_expansion-1 ] ) .",
    "when matching increments for second order weak accuracy , this term appears only in the second moment of the increment , and only in the cross term with @xmath443 , @xmath444= & \\ldots+\\left((\\m{\\partial k})\\m k^{\\star}+\\m k(\\m{\\partial k}){}^{\\star}\\right)\\frac{\\d t^{2}}{2}+o(\\d t^{3})\\label{eq : second_moment-1}\\end{aligned}\\ ] ] where the terms that are present in the constant - noise case already appear in ( 16 ) in @xcite and are denoted with ellipses .    in order to maintain second order weak accuracy ,",
    "the additional term involving @xmath440 in ( [ eq : second_moment-1 ] ) is matched in the temporal integrator by the way in which the noise is evaluated in the corrector step of ( [ eq : predcorr_scheme ] ) , @xmath445 where deterministic terms are denoted by elipses .",
    "taylor expanding @xmath446 in ( [ eq : corrector_noise ] ) gives the following two terms , @xmath447 the terms on the right hand side create the correct cross term in the second moment of the increment as long as @xmath198 .",
    "therefore , scheme ( [ eq : predcorr_scheme ] ) is second order weakly accurate even for time - dependent additive noise .",
    "here we show that the scheme ( [ eq : general_linearizer ] ) is second order accurate for the linearized equations ( [ eq : dxbar_dt],[eq : dx_dt_lin ] ) . for the scheme to be weakly second order accurate ,",
    "we need the difference between the first five moments of the discrete and continuous increments for the composite variable @xmath448 to be @xmath438 @xcite .",
    "the scheme ( [ eq : general_x_bar ] ) for the mean is deterministic and standard taylor series analysis shows that it is second - order accurate .",
    "furthermore , because @xmath449 is deterministic , there are no cross - correlations between increments of @xmath189 and @xmath450 , and therefore moments that involve both variables are guaranteed to match to the same order as the increments in @xmath450 .    in order to examine the moments of the increment in @xmath450 ,",
    "let us re - write equation ( [ eq : dx_dt_lin ] ) in differential and index notation , @xmath451 where as before @xmath452 , giving @xmath453 using the deterministic equation @xmath454 it can be shown that over a time interval @xmath455 , the random variable @xmath456 has the following continuous increment , @xmath457 where in this equation and in the following , @xmath458 , as well as @xmath459 , and @xmath348 and their derivatives , are all evaluated at the beginning of the time step .    in order to compare this to the discrete increment",
    ", we need to perform a taylor expansion of every term in equation ( [ eq : general_dx_np1 ] ) that is not already evaluated at @xmath460 .",
    "these expansions never need to include terms of higher order than @xmath461 , considering that all terms in ( [ eq : general_dx_np1 ] ) are already at least order @xmath462 ( any term that is @xmath463 is mean zero and thus irrelevant ) . additionally , the only term to be expanded which is order @xmath462 before expansion is the stochastic term @xmath464 , which depends only on the deterministic variable @xmath189 .",
    "thus an expansion of @xmath465 to order @xmath461 only includes first order terms .",
    "all other terms in ( [ eq : general_dx_np1 ] ) to be expanded are of order @xmath60 or greater before expansion , so in fact we only need to consider first order expansions for all quantities evaluated at @xmath466 or @xmath467 in the discrete increment .    for @xmath468",
    "we expand the update ( [ eq : general_dx_p],[eq : general_dx_np1 ] ) to first order , substitute the result in the corrector update ( [ eq : general_dx_np1 ] ) , and taylor expand terms involving @xmath459 , and @xmath348 evaluated at a point other than @xmath460 to first order . note",
    "that both options for the handling of the explicit term in ( [ eq : general_linearizer ] ) yield the same increment to second order . after performing these expansions and collecting some terms ,",
    "we get the final discrete increment to second order , @xmath469 where we have omitted bars since all quantities and derivatives are evaluated at @xmath460 .",
    "the first moment includes only the deterministic terms , and making use of the relations ( [ eq : second_order_cond ] ) confirms that they match the continuous increment with error @xmath470 .",
    "the second moment is more complicated due to the cross correlations that arise from the stochastic terms , but after some algebra and again making use of ( [ eq : second_order_cond ] ) , we see that the increments match to the correct order .",
    "the third moment only contains the second order products of the first two terms in the right hand side of ( [ eq : fluctuation_discrete_increment ] ) .",
    "the fourth moment contains only the fourth moment of the lowest order stochastic term , @xmath471 .",
    "the fifth moment is zero for both increments .",
    "all of these moments match with error no greater than order @xmath472 , and hence the scheme ( [ eq : general_dx_np1 ] ) is second order accurate .",
    "in this section , we show that the schemes ( [ eq : mid_pred ] , [ eq : mid_corr ] ) and ( [ eq : trap_pred ] , [ eq : trap_corr ] , [ eq : trap_stoch_incr_2nd ] ) from section [ sec : overdamped ] produce the correct thermal drift arising from the kinetic interpretation of the overdamped limit ( [ eq : limiting_equation ] ) . it is useful to consider the drift split into the following pieces , @xmath473_{i}=\\partial_{j}\\left(a_{ij}+b_{ik}c_{kl}^{-1}b_{jl}\\right)= & \\partial_{j}\\left(a_{ik}^{\\frac{1}{2}}a_{jk}^{\\frac{1}{2}}\\right)+\\partial_{j}\\left(b_{ik}c_{kl}^{-1}\\right)b_{jl}+b_{ik}c_{kl}^{-1}\\partial_{j}\\left(b_{jl}\\right),\\label{eq : drift_pieces}\\end{aligned}\\ ] ] where we have rewritten @xmath474and @xmath475 in order to simplify the notation .",
    "the first term on the right hand side of equation ( [ eq : drift_pieces ] ) can be split into @xmath476 and the second term on the right hand side of equation ( [ eq : drift_pieces ] ) can be rewritten as @xmath477 making use of relations ( [ eq : split_a_drift ] , [ eq : split_bcb_drift ] ) gives the following form of the entire drift @xmath478 the first line of equation ( [ eq : split_system_drift ] ) is generated by the evaluation of the noise in the corrector step , and the second line will be approximated using rfd terms .",
    "both the implicit trapezoidal and explicit midpoint schemes have the following noise term in the corrector step , @xmath479 which after taylor expanding operators evaluated at the predictor to @xmath480 and taking expectation with respect to @xmath481 and @xmath482 , becomes @xmath483 the term on the right - hand side of ( [ eq : expanded_system_noise ] ) thus gives the first line of the drift ( [ eq : split_system_drift ] ) when @xmath198 .",
    "the rfd terms from both schemes give the following additional increment in @xmath4 , @xmath484 where all terms except for the rfd term have been omitted for this analysis .",
    "expanding terms not evaluated at @xmath265 to @xmath485 in ( [ eq : system_rfd ] ) , and taking expectation with respect to @xmath486 and @xmath487 gives @xmath488 which corresponds to the drift term in the second line of equation ( [ eq : split_system_drift ] ) .",
    "together , the rfd terms in ( [ eq : system_rfd ] ) and the noise terms in ( [ eq : system_noise ] ) create the entire thermal drift from ( [ eq : limiting_equation ] ) , demonstrating that our schemes are first order accurate for the fully nonlinear kinetic equations .",
    "giambattista giacomin , joel  l lebowitz , and errico presutti .",
    "deterministic and stochastic hydrodynamic equations arising from simple microscopic model systems . in _",
    "stochastic partial differential equations : six perspectives _ , number  64 in mathematical surveys and monographs , page 107 .",
    "american mathematical soc . , 1999 .",
    "a.  oprisan and a.  leilani  payne .",
    "dynamic shadowgraph experiments and image processing techniques for investigating non - equilibrium fluctuations during free diffusion in nanocolloids . , 290:100106 , 2012 ."
  ],
  "abstract_text": [
    "<S> following on our previous work [ s. delong and b. e. griffith and e. vanden - eijnden and a. donev , phys . </S>",
    "<S> rev . </S>",
    "<S> e , 87(3):033302 , 2013 ] , we develop temporal integrators for solving langevin stochastic differential equations that arise in fluctuating hydrodynamics . </S>",
    "<S> our simple predictor - corrector schemes add fluctuations to standard second - order deterministic solvers in a way that maintains second - order weak accuracy for linearized fluctuating hydrodynamics . </S>",
    "<S> we construct a general class of schemes and recommend two specific schemes : an explicit midpoint method , and an implicit trapezoidal method . </S>",
    "<S> we also construct predictor - corrector methods for integrating the overdamped limit of systems of equations with a fast and slow variable in the limit of infinite separation of the fast and slow timescales . </S>",
    "<S> we propose using random finite differences to approximate some of the stochastic drift terms that arise because of the kinetic multiplicative noise in the limiting dynamics . </S>",
    "<S> we illustrate our integrators on two applications involving the development of giant nonequilibrium concentration fluctuations in diffusively - mixing fluids . </S>",
    "<S> we first study the development of giant fluctuations in recent experiments performed in microgravity using an overdamped integrator . </S>",
    "<S> we then include the effects of gravity , and find that we also need to include the effects of fluid inertia , which affects the dynamics of the concentration fluctuations greatly at small wavenumbers .    </S>",
    "<S> # 1 # 1 # 1    # 1#1 # 1#1    # 1#1 # 1|#1|    # 1#1 # 1#1     b^ c </S>"
  ]
}