{
  "article_text": [
    "fermi acceleration at relativistic shocks is an important topic for understanding the formation of spectra of ultrarelativistic particles and radiation in relativistic flows such as those observed in active nuclei , microquasars , @xmath6ray bursts and pulsar wind nebulae ( see kirk & duffy 2001 and references therein ) .",
    "of particular interest is the acceleration timescale that can be as short as a larmor time for relativistic fermi acceleration ; the smaller return probability to the shock for downstream particles , as compared to the non - relativistic regime , is compensated by the much larger energy gain at each cycle .",
    "however the study of fermi acceleration in the relativistic limit is more involved than in the non - relativistic regime due to the increased importance of the anisotropy of the distribution function ( gallant & achterberg 1999 ) .",
    "various methods have been used to study the relativistic regime of fermi acceleration ( see kirk & duffy 2001 and references therein ) , starting with analytical estimates by peacock ( 1981 ) , followed by semi - analytical methods ( kirk & schneider 1987 ; gallant & achterberg 1999 ; kirk et al .",
    "2000 ; achterberg et al .",
    "2001 ) and numerical monte - carlo techniques ( ballard & heavens 1992 ; ostrowski 1993 ; bednarz & ostrowski 1998 ) , which in spite of their differences converge to an asymptotic spectral index @xmath7 in the ultra - relativistic limit .    in the present _ letter",
    "_ , we propose a new numerical monte - carlo method of simulation of the acceleration of test particles at relativistic shocks .",
    "the trajectories of particles in the upstream and downstream inhomogeneous magnetic fields are integrated out exactly from the entry of each particle through the shock until its first return to the shock .",
    "the law of probability of return to the shock as a function of ingress and egress pitch angles is then constructed by monte - carlo iteration .",
    "finally we combine these probability laws , one defined for upstream and the other for downstream , with the energy gain formula at shock crossing to simulate the acceleration process .",
    "this latter use of the angular probability laws is similar to the method of gallant et al .",
    "( 2000 ) with some differences to be discussed below .",
    "the present method appears efficient and potentially more powerful when compared to direct monte - carlo simulations which follow each particle through its repeated shock crossings ( e.g. ballard & heavens 1992 ; ostrowski 1993 ) .",
    "it allows one to simulate relativistic fermi acceleration in any magnetic configuration , albeit for test particles only .",
    "we describe the method and numerical simulations in section  2 and then present the results for a planar shock with fully turbulent magnetic field both upstream and downstream in section  3 .",
    "the hydrodynamic jump conditions at an adiabatic strong shock , neglecting magnetic fields , are given in blandford & mc  kee ( 1977 ) , kirk & duffy ( 2001 ) and gallant ( 2002 ) .",
    "the shock lorentz factor is @xmath8 ( upstream or lab frame , e.g. , @xmath9 refers to the shock velocity measured in the downstream rest frame . ] ) , and the relative lorentz factor @xmath10 between upstream and downstream @xmath11 . the downstream lorentz factor @xmath12 ( and @xmath13 ) can be obtained as a function of @xmath8 from the relations derived from the shock jump conditions given in gallant ( 2002 ) . in particular , in the ultra - relativistic limit @xmath14 , one finds the well - known results @xmath15 and @xmath16 .",
    "we conduct our simulations in two steps .",
    "we first perform monte - carlo simulations of particle propagation in a given magnetic field structure following casse , lemoine & pelletier ( 2001 ) ( wherein one may find more details on the numerical procedure ) .",
    "these simulations are carried out separately in the downstream and in the upstream rest frames .",
    "it is possible to set up any magnetic field structure including regular and tangled components , but in the following , for the sake of simplicity , we restrict ourselves to the case of pure kolmogorov turbulence in both downstream and upstream rest frames . the equations of motion of each particle are integrated out exactly , the magnetic field being calculated at each point of the trajectory as a sum of plane waves , using 200 modes spaced logarithmically on three decades of wavelength and whose wavevector directions are drawn at random .",
    "ostrowski ( 1993 ) used a similar technique to construct the magnetic field albeit with 3 modes only , while ballard & heavens ( 1992 ) used three - dimensional fft methods ( see casse , lemoine & pelletier 2001 for a comparison of these methods ) .",
    "the trajectories are integrated over 100 scattering times upstream and 1000 scattering times downstream in order not to miss possible late returns to the shocks .",
    "the laws of return probability as a function of ingress and egress pitch angles are then constructed in the following way .",
    "we draw at random a point along a simulated trajectory which defines the point of entry through the shock .",
    "the ingress pitch angle cosine to shock normal @xmath17 is recorded , the trajectory scanned to find the point of exit through the shock , and the egress pitch angle cosine @xmath18 is then recorded .",
    "iteration of the above then yields the desired law of conditional return probability @xmath19 which gives the probability for a particle entering with a pitch angle cosine @xmath17 to return to the shock with a pitch angle cosine @xmath18 .",
    "the simulations also give a direct measurement of the return time to the shock as a function of pitch angles .",
    "once the upstream and downstream laws of return probability , respectively @xmath20 and @xmath21 are known , the simulation of the acceleration process itself can be performed as follows .",
    "we denote by @xmath22 the distribution function of particles that enter the shock to downstream and that have experienced @xmath23 shock crossings , and @xmath24 similarly upstream : particles are upstream for an even number of shock crossings and @xmath25 represents the injection population .",
    "these distribution functions are normalized to the total number of particles @xmath26 injected such that , in the absence of escape from the acceleration site , after @xmath27 shock crossings @xmath28 , and after @xmath23 shock crossings @xmath29 .",
    "the conservation of particle number at shock crossing @xmath30 and lorentz transforms of pitch angles and energies imply :    @xmath31 { \\rm d}\\mu_{\\rm u}^{\\rm e}{\\rm d}\\epsilon_{\\rm u } \\label{eq : mapud_f}\\ ] ]    @xmath32    and one obtains a similar system for shock crossing @xmath33 : @xmath34 { \\rm d}\\mu_{\\rm d}^{\\rm e}{\\rm d}\\tilde\\epsilon_{\\rm d } \\label{eq : mapdu_f}\\ ] ] @xmath35    the terms within brackets in eqs .",
    "( [ eq : mapud_f ] ) and ( [ eq : mapdu_f ] ) correspond to the distribution function upon exit from upstream and downstream respectively .",
    "the return probability to the shock @xmath36 as a function of ingress pitch angle can be obtained as : @xmath37 .",
    "the corresponding return probability for upstream is obviously unity . after each cycle @xmath38",
    ", a fraction @xmath39f_{\\rm d}^{2n+1}(\\mu_{\\rm d}^{\\rm i};\\epsilon)$ ] of the particle population has escaped downstream and accumulates to form the outgoing particle population @xmath40 . by following each shock crossing , and using eqs .",
    "( [ eq : mapud_f]),([eq : mapud_l]),([eq : mapdu_f ] ) , ( [ eq : mapdu_l ] ) one can follow the evolution of @xmath41 , @xmath42 and @xmath43 , starting from a mono - energetic and isotropic initial injection distribution upstream .",
    "the distribution @xmath44 eventually provides the accelerated particle population .",
    "a similar formal development of the acceleration process by repeated shock crossings has been proposed independently by vietri ( 2002 ) : the flux of particles crossing the shock in the stationary regime , noted @xmath45 in vietri ( 2002 ) is related to the above as @xmath46 with @xmath47 a normalization constant .",
    "this method assumes that the angular probability laws do not depend on rigidity .",
    "this is true in the diffusive limit but one might expect some weak dependence to appear in the relativistic limit @xmath48 .",
    "indeed we have found numerically such a weak dependence of @xmath49 and @xmath50 on the particle rigidity .",
    "however it remains weak , and the change in @xmath51 averages to a few percent when the rigidity changes by two orders of magnitude . in terms of energy spectral index @xmath52 ,",
    "this dependence introduces an error of @xmath53 for @xmath1 up to @xmath54 for @xmath55 .",
    "therefore in the following we neglect the dependence on rigidity but keep the above errors as uncertainties on our results .",
    "note that one can in principle incorporate this dependence on rigidity in our method at the expense of having to calculate the probability laws @xmath56 for a wide range of values of the rigidity .",
    "the present technique has significant advantages when compared to standard monte - carlo techniques which follow the particle trajectories on both sides of the shock through the whole acceleration process .",
    "indeed , provided one neglects the dependence on rigidity of @xmath56 , one can simulate the trajectories of particles of high rigidity only ( near the end of the resonance range ) which are must faster to integrate than the trajectories of particles of small rigidity since the ratio of scattering time to larmor time decreases with increasing rigidity .",
    "the direct monte - carlo methods also suffer from the problem of a small dynamic range of the magnetic fields as compared to the wide dynamic range of particles momenta .",
    "the present method also offers a significant gain in signal as will be obvious in the following .",
    "finally our method differs from gallant et al .",
    "( 2000 ) as they use it differential techniques to simulate scattering downstream and analytical methods for scattering in a regular magnetic field upstream assuming @xmath3 .",
    "in contrast , the present simulations can be applied to any shock lorentz factor and magnetic field configuration .",
    "furthermore they use monte - carlo methods to simulate the acceleration process after constructing the laws of return probability while we directly fold over repeatedly the probability distributions in conjunction with the energy gain formula .",
    "the downstream return probability to the shock as a function of ingress pitch angle cosine is shown in fig .",
    "[ fig1 ] for @xmath57 .",
    "the return probability for @xmath58 is an asymptote which is reached to within a percent as early as @xmath59 . in fig .",
    "[ fig4 ] , we show the average energy gain @xmath60 per cycle @xmath61 ( diamonds ) and @xmath62 ( triangles ) for @xmath58 . this energy gain is defined as the ratio of the average energies at the end @xmath63 and at the beginning of the cycle @xmath64 , with @xmath65 . the average energy gain in each cycle subsequent to first shock crossing is @xmath66 per cycle u ",
    "u for @xmath55 , and this asymptotic value is reached immediately after the first cycle .",
    "this is a rather dramatic confirmation of the analytical expectations of gallant & achterberg ( 1999 ) and achterberg et al .",
    "( 2001 ) which had argued that only the first cycle should yield a gain @xmath67 since the anisotropy of the distribution function upstream is so pronounced that the gain in subsequent cycles is reduced to @xmath68 .",
    "an example of the spectrum of accelerated particles for @xmath58 after 20 cycles @xmath69 is shown in fig .",
    "[ fig3 ] ; the thin lines in this figure show the fractions of particles @xmath70 that escape after @xmath23 shock crossings .",
    "one clearly sees in this figure the piling up of populations of particles of ever decreasing size ( due to finite escape probability ) and ever increasing energy which gives rise to the accelerated population @xmath71 .",
    "the spectral index of the escaping population for @xmath55 is here @xmath72 ( incorporating the error due to dependence of @xmath56 on rigidity ) , in excellent agreement with previous results by bednarz & ostrowksi ( 1998 ) , kirk et al .",
    "( 2000 ) and achterberg et al .",
    "( 2001 ) .    finally , in fig .",
    "[ fig5 ] , we give the average return probabilities ( open squares ) , average asymptotic energy gains ( diamonds ) and spectral indices ( filled circles ) for values of @xmath8 comprised between 2 and 100 .",
    "the average return probabilities shown in this figure are the return probabilities shown in fig .",
    "[ fig1 ] weighted by the corresponding asymptotic downstream ingress pitch angle distribution , i.e. @xmath73 . a naive unweighted average of the return probability shown in fig .  [ fig1 ] for @xmath55 would give 0.33 , whereas the weighted average gives 0.40 : the difference is directly related to the strong anisotropy at shock crossing .",
    "the standard non - relativistic formula for the ( energy ) spectral index @xmath52 ( bell 1978 ) , @xmath74 , with @xmath75 the average energy gain , is in relatively good agreement with the slopes obtained , provided one uses the weighted average for the return probability as above , see fig .",
    "a more general formula which includes relativistic effects has been proposed by vietri ( 2002 ) : @xmath76 .",
    "one can derive this formula and variants of it by using our eqs .",
    "( [ eq : mapud_f]),([eq : mapud_l]),([eq : mapdu_f ] ) , ( [ eq : mapdu_l ] ) . for instance , insert eq .",
    "( [ eq : mapdu_f ] ) into eq .",
    "( [ eq : mapud_f ] ) then sum over @xmath77 ( shock crossing number ) to go to the stationary regime and consider an energy range where @xmath78 , @xmath79 being the maximal injection energy .",
    "there one expects that @xmath80 , i.e. the distribution factorizes out in an energy power law times a function of pitch angle , and indeed this property is verified numerically to high accuracy .",
    "then one introduces the energy gain per cycle @xmath81 and integrates over @xmath82 both sides of the equation .",
    "finally , dividing one side by the other yields the following relation , which is a variant of the formula of vietri ( 2002 ) : @xmath83 in this equation , @xmath84 simply corresponds to @xmath50 expressed in terms of downstream pitch angle cosines , and @xmath85 .",
    "equation  ( [ eq : viet ] ) is indeed verified to within the numerical noise ( @xmath86% ) .",
    "our simulations also provide a direct measurement of the acceleration timescale , which can be defined as the cycle time in the upstream rest frame when @xmath3 : @xmath87 , where @xmath88 and @xmath89 denote the upstream and downstream return times measured in their respective rest frames for a particle of energy @xmath90 . for @xmath91",
    "we find to within the noise of the simulations : @xmath92 , with @xmath93 the scattering time downstream .",
    "the scattering time is given as a function of larmor time @xmath94 in casse , lemoine & pelletier ( 2001 ) , and for pure turbulence one finds : @xmath95 for @xmath96 and @xmath97 for @xmath98 . here",
    "@xmath99 denotes the rigidity , with @xmath100 the smallest wavenumber of the magnetic field modes .",
    "the above result for @xmath101 can be understood as follows . in the non - relativistic limit",
    "one derives @xmath102 and we find @xmath103 in the relativistic limit , which gives @xmath104 .",
    "gallant & achterberg ( 1999 ) have conjectured @xmath105 for @xmath3 , corresponding to deflection by an angle of order @xmath106 in a regular magnetic field .",
    "we confirm this result up to a small residual dependence on scattering time / rigidity : @xmath107 for @xmath108 . in the mildly relativistic case , for @xmath1 , we find @xmath109 , which indicates that the particles have time to wander before being caught by the shock in this case .",
    "the final acceleration time depends on how the magnetic field downstream @xmath110 is related to that upstream @xmath111 ( gallant & achterberg 1999 ) .",
    "if one assumes that @xmath112 with @xmath113 , and the turbulence is isotropic downstream but the length scale has been contracted by a factor @xmath114 , i.e. @xmath115 , one finds , for @xmath116 , @xmath117 .",
    "the acceleration timescale can thus be as short as a fraction of larmor time in the ultra - relativistic limit .",
    "this is a most interesting aspect of relativistic fermi acceleration , as it implies that the particles can reach the energy confinement limit @xmath118 when the acceleration is limited by expansion losses or by the age of the shock wave .",
    "here , @xmath119 , @xmath120 is the size of the accelerating region , @xmath121 the age or losses timescale and @xmath122 , all quantities being expressed in the comoving frame .",
    "this is particularly relevant for the generation of ultra - high energy cosmic rays in relativistic winds such as @xmath6ray bursts ( waxman 1995 , vietri 1995 , gallant & achterberg 1999 , gialis & pelletier 2003 ) . in particular",
    "our results for @xmath1 are of direct relevance to the acceleration of protons and electrons in internal shocks of @xmath6ray bursts , while the results for @xmath3 can be applied directly to the external shock model of @xmath6ray bursts .    to sum up",
    ", our simulations confirm the results of bednarz & ostrowski ( 1998 ) concerning the spectral index and those of achterberg et al .",
    "( 2001 ) concerning the spectral index , the acceleration time scale and energy gains . very recently",
    ", ellison & double ( 2002 ) found a similar index by taking into account the backreaction of cosmic rays on the shock structure . in the near future",
    ", the present method will be applied to more general magnetic field configurations including parallel , transverse , subluminal and superluminal shocks .",
    "achterberg , a. , gallant , y. a. , kirk , j. g. , & guthmann , a. w. 2001 , , 328 , 393 ballard , k. r. , & heavens , a. f. 1992 , , 259 , 89 bednarz , j. , & ostrowski , m. 1998 , , 80 , 3911 .",
    "bell , a. r. 1978 , , 182 , 147 .",
    "blandford , r. , & mckee , c. 1977 , phys .",
    "fluids , 19 , 1130 .",
    "casse , f. , lemoine , m. , & pelletier , g. 2001 , phys .",
    "d , 65 , 023002 .",
    "ellison , d. , & double , g. 2002 , astroparticle physics , 18 , 213 .",
    "gallant , y. a. , & achterberg , a. 1999 , , 305 , l6 .",
    "gallant , y. a. et al .",
    "2000 , in gamma - ray bursts , eds .",
    "r. m. kippen et al . , aip conference series , vol.526 , p.524 ( new - york : american institute of physics ) gallant , y. a. 2002 , to appear in relativistic flows in astrophysics , eds .",
    "a. w. guthmann et al .",
    ", lecture notes in physics ( berlin : springer - verlag ) , arxiv : astro - ph/0201243 gialis , d. & pelletier , g. , astropart . phys . in press ,",
    "arxiv : astro - ph/0302231 .",
    "kirk , j. g. , & schneider , p. 1987",
    ", , 315 , 425 kirk , j. , & duffy , p. 1999",
    ", j. phys .",
    "g , 25 , r163 .",
    "kirk , j. , guthmann , a. , gallant , y. , & achterberg , a. 2000 , , 542 , 235 .",
    "ostrowski , m. 1993 , , 264 , 248 peacock , j. 1981 , , 196 , 135 .",
    "vietri , m. 1995 , apj , 453 , 883 .",
    "vietri , m. 2002 , arxiv : astro - ph/0212352 .",
    "waxman , e. 1995 , phys .",
    "lett . , 75 , 386 ."
  ],
  "abstract_text": [
    "<S> this paper presents a new method of monte - carlo simulations of test particle fermi acceleration at relativistic shocks . </S>",
    "<S> the particle trajectories in tangled magnetic fields are integrated out exactly from entry to exit through the shock , and the conditional probability of return as a function of ingress and egress pitch angles is constructed by monte - carlo iteration . </S>",
    "<S> these upstream and downstream probability laws are then used in conjunction with the energy gain formula at shock crossing to reproduce fermi acceleration . for pure kolmogorov magnetic turbulence upstream and downstream , the spectral index </S>",
    "<S> is found to evolve smoothly from @xmath0 for mildly relativistic shocks with lorentz factor @xmath1 to @xmath2 in the ultra - relativistic limit @xmath3 . </S>",
    "<S> the energy gain is @xmath4 at first shock crossing , and @xmath5 in all subsequent cycles as anticipated by gallant & achterberg ( 1999 ) . </S>",
    "<S> the acceleration timescale is found to be as short as a fraction of larmor time when @xmath3 . </S>"
  ]
}