{
  "article_text": [
    "a central feature of evolutionary adaptation is that the space of potential innovations can vary with the evolutionary history of a population .",
    "examples are common in the microbial world : the ability to import a nutrient may be beneficial only if a mechanism has evolved to utilize it @xcite , while a previously advantageous drug resistance mutation can be rendered obsolete by the acquisition of a second resistance allele @xcite .",
    "this capacity for evolutionary feedback is quantified in terms of _ epistasis _ , which measures how the effect of a mutation depends on the genetic background in which it arises . in principle",
    ", epistasis can lead to widespread historical contingency , and can fundamentally alter the dynamics of adaptation @xcite .",
    "but in practice , the long - term evolutionary impact of epistasis remains largely uncharacterized .",
    "empirical patterns of epistasis are most commonly measured using a direct approach ( see @xcite for a recent review ) .",
    "candidate mutations are introduced into a set of genetic backgrounds via crossing or other genetic reconstruction techniques , and the fitnesses of the reconstructed genotypes are measured using competitive fitness assays or related proxies .",
    "these data yield a functional relationship between the fitness effect of a mutation and its genetic background , with the traditional pairwise epistasis emerging as a special case when the backgrounds are single mutants .",
    "we will use to term _ microscopic epistasis _ to refer to these measurements , since they track the background - dependence of individual mutations .",
    "of course , the precise background dependence of any given mutation is essentially an empirical matter : the fitness effects depend on the biological details of the organism , its environment , and the identities of the mutations themselves .",
    "empirical estimates of these quantities therefore provide valuable insight into the physiological and biophysical properties of the organism @xcite .    with enough reconstructions , one can also obtain information about the larger - scale structure of the fitness landscape .",
    "for example , one can assess whether interactions between mutations are generally antagonistic or synergistic @xcite , or estimate the prevalence of sign epistasis @xcite and overall levels of modularity @xcite .",
    "these questions are typically quantified using statistical summaries of the microscopic epistasis ( e.g. , the distribution of pairwise epistasis values ) , which are aggregated over a large ensemble of mutations and genetic backgrounds . while the biological interpretation of these statistics is sometimes unclear",
    ", they can in principle exhibit regular and generalizable patterns .",
    "this makes them potentially amenable to comparison with simple fitness landscape models , such as fisher s geometrical model @xcite , the uncorrelated landscape @xcite , and the nk landscape @xcite . yet",
    "while these statistics are designed to capture global properties of the fitness landscape , they are still fundamentally microscopic in nature , since they can only be estimated from microscopic ( i.e. reconstruction - based ) measurements .",
    "as such , they suffer from the same throughput limitations as any other reconstruction - based method , and one can only focus on a small subset of possible genotypes .",
    "however , an evolving population typically explores a much larger number of genotypes than is feasible to reconstruct experimentally .",
    "the evolutionary dynamics depends on the entire _ distribution _ of fitness effects ( `` the dfe '' ) , and on how this distribution varies among different genetic backgrounds .",
    "we denote this background - dependent dfe by @xmath0 : the fraction of mutations with fitness effect @xmath1 in genetic background @xmath2 .",
    "in contrast to the statistics above , the background dependence of the dfe is a _",
    "macroscopic _ form of epistasis , since it includes no information about the background - dependence of any individual mutation .",
    "like many macroscopic quantities , there is not a one - to - one correspondence between the underlying microscopic epistasis and its macroscopic manifestation .",
    "for example , one can imagine a scenario where epistasis changes the identities of beneficial mutations after every substitution , but in a way that preserves the overall shape of the dfe . in this case , the widespread patterns of microscopic epistasis are masked at the macroscopic level , and the dynamics of adaptation will be indistinguishable from a non - epistatic scenario . at the opposite extreme ,",
    "the dfe can change even without any microscopic epistasis once selection starts to deplete the finite supply of beneficial mutations . in this case",
    ", the dynamics of adaptation will show signatures of macroscopic epistasis even though there are no direct interactions between mutations .    despite the potential importance of macroscopic epistasis in evolutionary adaptation",
    ", it remains less well - characterized than its microscopic counterpart . in principle , it is possible to measure the background dependence of the dfe directly , by assaying the fitness of large libraries of random mutants @xcite .",
    "however , such studies suffer from similar throughput limitations as the microscopic approach above .",
    "these throughput limitations are compounded by the fact that the most important changes in the dfe , from an evolutionary perspective , are often located in difficult - to - sample regions such as the high - fitness tail @xcite .    to avoid these these issues ,",
    "a number of studies have focused on the evolutionary outcomes themselves , associating observed differences in the adaptability of different strains with differences in the underlying dfe @xcite . in principle",
    ", this approach offers the greatest sensitivity for detecting relevant differences in the dfe among related genetic backgrounds .",
    "however , it does so by transforming the measurement into an inverse problem : the patterns of macroscopic epistasis must ultimately be inferred from the dynamics of a few observable quantities ( e.g. changes in fitness over time or across experimental treatments ) , which depend on the complex population genetics of an evolving microbial population @xcite .",
    "thus , while it is easy to demonstrate the _ existence _ of macroscopic epistasis with this approach , it is difficult to associate the observed differences in adaptability with the precise changes in the underlying dfe .",
    "this , in turn , has made it hard to distinguish between competing models of epistasis when interpreting the results of the experiment @xcite .    in the present manuscript , we propose a general framework for quantifying patterns of macroscopic epistasis from observed differences in adaptability .",
    "we then use this framework to investigate the role of epistasis in a well - studied laboratory evolution experiment in _",
    "e. coli _ @xcite . by analyzing the differences in the dynamics of adaptation through time",
    ", we can make inferences about the changes in the dfe that have accumulated over the course of the experiment .",
    "these changes constitute the most basic form of epistasis that arises during adaptation to a constant environment .",
    "similar to @xcite , we focus on two simple summaries of the dynamics : the competitive fitness and the total number of genetic changes relative to the ancestor .",
    "we use a combination of theory and numerical simulations to investigate how well these data are explained by several popular models of macroscopic epistasis , including the recently proposed diminishing returns model of @xcite .",
    "we find that fitness measurements alone have little power to discriminate between different models of epistasis , while the addition of genetic information is sufficient to rule out many existing explanations of the data .",
    "together , these results highlight the need for more sophisticated models of macroscopic epistasis that are compatible with _ all _ of the experimental data , as well as additional dna sequence data to test their predictions .",
    "in the long - term evolution experiment ( ltee ) conducted by lenski and collaborators , twelve populations of _ escherichia coli _ were founded from a single common ancestor @xcite and propagated in a constant environment for more than @xmath3 generations ( see @xcite for a recent summary of experimental details ) . a central observable quantity is the fitness of the evolved populations , which can be measured using competition assays with a marked ancestor .",
    "if @xmath4 and @xmath5 denote the frequencies of the evolved strain at the beginning and end of the competition assay , then the ( log)-fitness , @xmath6 , is given by @xmath7\\ , , \\label{eq : fitness}\\end{aligned}\\ ] ] where @xmath8 is the duration of the competition in generations .",
    "note that this definition of fitness differs from the traditional measure @xmath9 reported in previous studies of the ltee .",
    "although the two measures are correlated , eq .",
    "( [ eq : fitness ] ) provides a more direct connection to the population genetic theory described in the following sections .    using the fitness assays reported in @xcite , we calculated the fitness defined by eq .",
    "( [ eq : fitness ] ) for each population at approximately 40 timepoints during the first 50,000 generations of evolution ( see appendix ) .",
    "we plot the fitness trajectories for the six complete , non - mutator populations in fig .",
    "[ fig : trajectory]a . measurement error estimated from replicate assays is substantial ( @xmath10 , fig .",
    "[ fig : trajectory]c ) , leaving us with little power to distinguish fluctuations in individual trajectories . instead , we pool all six populations and focus on the _ average fitness trajectory _",
    "@xmath11 ( fig .",
    "[ fig : trajectory]b ) . bootstrap resampling from the errors in fig .",
    "[ fig : trajectory]c suggests that the measurement error in @xmath11 is smaller ( @xmath12 ) and more normally distributed ( fig .",
    "[ fig : trajectory]d ) .",
    "however , even for the average fitness trajectory , the fluctuations between neighboring timepoints still fall within experimental uncertainty , so we can only obtain robust inferences from long - term trends in the data .",
    "the most striking trend is the pronounced slowdown in the rate of adaptation during the course of the experiment : nearly two - thirds of the total fitness was gained in the first 5,000 generations of evolution .",
    "this deceleration is inconsistent with a constant dfe , which would predict that the average fitness increases linearly with time .",
    "instead , the slowdown in the rate of adaptation has long been interpreted as a signature of _ diminishing returns epistasis _ , consistent with the approach to a fitness plateau @xcite .",
    "previous work has argued that the shape of the deceleration is best captured by a logarithmic fitness trajectory , @xmath13 where @xmath14 gives the initial rate of fitness increase and @xmath15 controls the severity of the slowdown @xcite ; the best - fit parameters are shown in fig .",
    "[ fig : trajectory]b .",
    "the shape of this trajectory , in combination with more precise measurements of the change in fitness between generations 40,000 and 50,000 ( @xmath16 , see inset of fig .",
    "[ fig : trajectory]b ) , have been used to argue that fitness is still increasing in the ltee @xcite , rather than asymptoting to a fitness peak @xcite .",
    "more recent work has tried to use the shape of the fitness trajectory to make inferences about the underlying model of epistasis in the ltee @xcite . however , to truly distinguish between different models , we must move beyond the simple curve fitting implied by eq .",
    "( [ eq : wiser - trajectory ] ) and postulate a set of concrete population genetic models that can be used to generate predictions for @xmath17 . the likelihood of the observed fitness trajectory",
    "can then be written in the form @xmath18 here , @xmath19 is the probability distribution of the data vector @xmath20 in the underlying model , which depends on some set of parameters @xmath21 , and @xmath22 is the distribution of measurement errors , which we assume to be independent and normally distributed with variance @xmath23 for each timepoint of @xmath11 ( fig .",
    "[ fig : trajectory ] ) and @xmath24 for @xmath25 ( fig .",
    "[ fig : trajectory]b , inset ) . by computing this likelihood",
    ", we can assess the fit of a given model using standard statistical techniques ( see appendix ) .",
    "in contrast to the curve - fitting approach of earlier work , this method correctly accounts for inherent stochasticity of the evolutionary process , which can lead to correlated fluctuations in the observed fitness trajectory . yet in practice , it is often difficult to compute the likelihood in eq .",
    "( [ eq : likelihood ] ) because the model distribution @xmath19 is unknown .",
    "this is largely due to the large population size of the ltee ( @xmath26 ) , which makes it difficult to analyze even the simplest population genetic models @xcite . to avoid these issues , we use computer simulations of the model to obtain accurate predictions of the fitness trajectory ( see appendix ) , computing the approximate likelihood function as @xmath27    unfortunately",
    ", regardless of the method used for inference , we will demonstrate that there is little power to distinguish between different models of epistasis based on the fitness trajectory alone . as noted by @xcite",
    ", it is relatively easy to devise an epistatic model that reproduces the observed fitness trajectory in fig .",
    "[ fig : trajectory]b , and we outline several specific examples below . fortunately , the average fitness trajectory is not the only quantity that has been measured in the ltee .",
    "dna sequences from a small number of clones are available for several timepoints in a subset of the lines @xcite .",
    "although this genetic data is more sparse than the fitness measurements , it provides a crucial window into the the molecular changes responsible for the observed patterns of fitness evolution . in fig .",
    "[ fig : trajectory]b , we plot the average number of genetic differences between the ancestor and a set of clones sampled from the non - mutator populations ( see appendix ) . when viewed as a function of time , this _ mutational trajectory",
    "_ @xmath28 is the natural genetic analogue of the average fitness trajectory @xmath11 .",
    "any evolutionary model which purports to explain the long term trends in @xmath11 must also be consistent with the observed values of @xmath28 .",
    "as we will see below , this turns out to be much more informative than fitting the fitness trajectory on its own .",
    "the most striking feature of the mutation trajectory in fig .  [ fig : trajectory ] is the sheer number of mutations that have accumulated during the experiment .",
    "although the full data no longer support the constant substitution rate observed in the first 10,000 generations of evolution @xcite , the number of mutations in the later portion of the experiment is still much higher than one might expect based on the fitness trajectory .",
    "roughly half of all mutations accumulated _ after _ the first 10,000 generations , when rate of fitness increase had already slowed substantially .",
    "of course , some unknown fraction of these mutations are likely to be selectively neutral , as these accumulate continuously at the neutral mutation rate @xmath29 @xcite .",
    "there are no _ a priori _ estimates of @xmath29 , but evidence from the synonymous substitution rate and mutation accumulation lines suggest that a reasonable upper bound is @xmath30 ( file s1 ) . with this estimate , fewer than 30 neutral mutations should have accumulated by generation 40,000 , which suggests that most of the @xmath31 observed mutations in fig .",
    "[ fig : trajectory ] are beneficial .",
    "in fact , the substitution rate in the first 10,000 generations is so rapid that many of these beneficial mutations must be segregating in the population at the same time . given that the typical fitness effect of a fixed mutation is at most about @xmath32 @xcite , the fixation time of a successful mutation is much longer than the maximum possible waiting time between mutations . as a result , these mutations must compete for fixation within the population  a process known as _ clonal interference _ @xcite .",
    "this will prove to be an important factor in the theoretical analysis below .      although a decelerating fitness trajectory is a clear signature of _ macroscopic _ epistasis ( i.e. , a changing dfe ) , this does not necessarily imply that _ microscopic _ epistasis must be at work .",
    "the dfe can change even in the absence of epistasis provided that the length of the genome is finite . given enough time ,",
    "the population will eventually exhaust the supply of beneficial mutations , and the rate of adaptation will slow substantially .",
    "thus , this non - epistatic scenario offers one of the simplest possible explanations for the decelerating rate of adaptation in the ltee , provided that it can also _ quantitatively _ reproduce the trajectories in fig .",
    "[ fig : trajectory ] .    in the simplest version of this model",
    ", the beneficial dfe evolves according to the mean - field dynamics , @xmath33 where @xmath34 is the number of sites and @xmath35 is the fixation probability of a new mutation .",
    "equation  ( [ eq : dfe - evolution ] ) accounts for the fact that , once a beneficial mutation fixes , a second mutation at that site is not likely to be beneficial , effectively removing this site from the beneficial portion of the dfe .",
    "the overall normalization of @xmath36 will therefore decrease as more mutations are driven to fixation .",
    "the rate of change of the dfe in eq .",
    "( [ eq : dfe - evolution ] ) is inversely proportional to @xmath34 , and it vanishes in the limit that @xmath37 as expected . in a true `` finite sites '' model , each of the @xmath34 beneficial mutations corresponds to a single site in the genome , and the ratio @xmath38 is set by the per - site mutation rate @xmath39 .",
    "however , eq .  ( [ eq : dfe - evolution ] ) also describes the evolution of the dfe in a generalized `` running out of mutations '' model  for example , there could be @xmath34 genes which are beneficial to knock out , or @xmath34 modules to improve @xcite . in these cases",
    ", @xmath34 represents the total number of non - redundant mutations , e.g. the number of genes to knock out , and @xmath38 is the target size of each module . note that this model assumes that all modules share the same target size ; the variable target size case is treated in more detail in file  s1 .    given a solution for the time - dependent dfe in eq .",
    "( [ eq : dfe - evolution ] ) , the expected fitness and mutation trajectories are given by    [ eq : trajectory - equations ] @xmath40    unfortunately , both equations  ( [ eq : dfe - evolution ] ) and ( [ eq : trajectory - equations ] ) are difficult to solve in general , since the fixation probability also depends on the dfe @xcite . despite this difficulty",
    ", we can gain considerable qualitative insight by focusing on the strong - selection , weak - mutation ( sswm ) limit , where the fixation probability is given by haldane s formula , @xmath41 @xcite . in this limit ,",
    "the evolution of the dfe greatly simplifies , and the distribution of beneficial fitness effects is given by @xmath42 where @xmath43 is the dfe in the ancestral background .",
    "the average fitness and mutation trajectories can then be obtained by substituting eq .",
    "( [ eq : sswm - dfe - evolution ] ) into eq .",
    "( [ eq : trajectory - equations ] ) and evaluating the resulting integral . for example",
    ", arguments from extreme value theory suggest that the ancestral dfe may often be exponential @xcite , which leads to an average fitness trajectory of the form @xmath44 \\ , , \\label{eq : finite - exponential - trajectory}\\end{aligned}\\ ] ] where @xmath45 and @xmath46 .",
    "however , while this trajectory shares the same qualitative deceleration as the data in fig .",
    "[ fig : trajectory ] , it predicts a much sharper deceleration in the adaptation rate than is actually observed ( fig .",
    "[ fig : trajectory - curvefits ] ) .",
    "this shows that for a fixed dfe shape , we will not always be able to quantitatively reproduce the observed fitness trajectory with our finite - sites model .    however , the situation changes if we are allowed to arbitrarily tune the shape of the dfe to match to the observed fitness trajectory .",
    "in particular , we find that the adaptation rate for the dfe in eq .",
    "( [ eq : sswm - dfe - evolution ] ) is proportional to the laplace transform of @xmath47 , which leads to an inverse relation of the form @xmath48 in other words , we can reproduce a particular fitness trajectory within our finite sites model by choosing the ancestral dfe to match the expression above .",
    "note that eq .",
    "( [ eq : general - finite - dfe ] ) implicitly assumes that the inverse laplace transform exists and yields a proper probability distribution .",
    "this places certain constraints on the fitness trajectories that we can reproduce with this model , e.g. , requiring that @xmath49 is monotonically decreasing .",
    "the intuitive reason for this restriction is clear from the definition of the model : exhausting the supply of beneficial mutations can never lead to an increasing adaptation rate , no matter how exotic the ancestral dfe .",
    "note , however , that deleterious mutations @xcite , clonal interference @xcite , and the fixation of mutator phenotypes @xcite can complicate this picture considerably .",
    "the other apparent limitation of this model is that the fitness trajectory must be bounded , since the maximum possible fitness that can be attained is @xmath50 . at first glance ,",
    "this would seem to preclude the logarithmic trajectory in eq .",
    "( [ eq : wiser - trajectory ] ) , which has no maximum value .",
    "however , since experimental trajectories are only observed over a finite time window , @xmath51 , we can always satisfy this restriction in practice by assuming that @xmath52 . for example , the logarithmic fitness trajectory in eq .",
    "( [ eq : wiser - trajectory ] ) corresponds to an ancestral dfe of the form @xmath53 where @xmath54 is a lower cutoff chosen to maintain normalization ( see file s1 ) .",
    "the fitting parameters in eq .",
    "( [ eq : wiser - trajectory ] ) are given by @xmath55 and @xmath56 .",
    "a similar argument shows that we can also reproduce a given mutation trajectory ( subject to the same technical constraints ) , provided that the ancestral dfe satisfies @xmath57 however , while we can fit a broad class of fitness and mutation trajectories by choosing the appropriate ancestral dfe , we do not have complete freedom to fit both quantities at the same time . in the weak mutation limit , the average fitness and mutation trajectories in our finite sites model",
    "are related by @xmath58 \\",
    ", d\\tau \\ , , \\label{eq : finite - mutation - trajectory } \\end{aligned}\\ ] ] regardless of the choice of ancestral dfe . by choosing @xmath43 to fit the fitness trajectory",
    ", we severely constrain the shape of the mutation trajectory ( and vice versa ) , with only an overall scale @xmath59 that can be tuned to fit the data .",
    "for example , the logarithmic fitness trajectory in eq .",
    "( [ eq : wiser - trajectory ] ) implies a constant substitution rate @xmath60 where @xmath61 .",
    "this linear increase is inconsistent with the mutation trajectory in fig .",
    "[ fig : trajectory ] , which starts to show deviations from linearity after generation @xmath62 .",
    "however , a potential caveat with this analysis is that the mutation trajectory in eq .",
    "( [ eq : finite - wiser - mutation - trajectory ] ) ( and much of the analysis preceding it ) depends on our assumption of the weak - mutation limit , which requires that @xmath63 .",
    "this is often not self - consistent : in the ltee , the weak - mutation analysis typically leads us to infer parameter values that violate the weak - mutation assumptions .",
    "for example , in the finite - sites model defined by eq .",
    "( [ eq : wiser - dfe ] ) , the fitted values of @xmath15 and @xmath14 in fig .",
    "[ fig : trajectory ] require that @xmath64 , which violates the weak - mutation condition used to derive eqs .",
    "( [ eq : wiser - dfe ] ) and ( [ eq : finite - wiser - mutation - trajectory ] ) .",
    "thus , we must turn to our computational framework to rigorously compare this model with the data .    ) with @xmath65 ( solid lines ) .",
    "we have included all simulated combinations of @xmath66 , @xmath67 , and @xmath34 with @xmath68 and @xmath69 .",
    "each line is colored according to the relative error of the mutation trajectory , @xmath70 , after fitting the best - fit neutral mutation rate @xmath71 by least - squares . for comparison , we have also included the observed fitness and mutation trajectories from fig .",
    "[ fig : trajectory]b .",
    "( b ) the relative error of the mutation trajectory for all simulated parameter combinations . for each combination of @xmath66 and @xmath67",
    ", we plot the minimum error across all simulated values of @xmath34 , and we have only included parameter combinations for which @xmath68 .",
    "[ fig : finite - sites - fit ] ]    to do so , we performed a grid search over combinations of @xmath72 , @xmath34 , and @xmath67 for the ancestral dfe defined by eq .",
    "( [ eq : wiser - dfe ] ) .",
    "the posterior predictive @xmath73-value for the fitness trajectory is @xmath74 ( @xmath75 test , see appendix ) , which shows that the finite - sites model can still reproduce the observed fitness trajectory in the presence of clonal interference .",
    "figure  [ fig : finite - sites - fit ] shows the average fitness and mutation trajectories for all parameters with @xmath68 .",
    "the mutation trajectories also include a best - fit rate of neutral mutations ( @xmath76 ) which is fit to minimize the mean squared error from the observed mutation trajectory .",
    "even with this correction , the mutation trajectories remain inconsistent with the data , which allows us to reject the simple finite sites model in eq .",
    "( [ eq : dfe - evolution ] ) .",
    "we next consider an alternative model of macroscopic epistasis  the _ uncorrelated fitness landscape _  which represents the opposite limit of the additive finite - genome models above @xcite . in this model ,",
    "the fitness of every genotype is drawn independently from the same distribution @xmath77 . in our notation",
    ", this implies that the dfe is given by @xmath78 where @xmath79 denotes the fitness of genotype @xmath2 .",
    "this uncorrelated landscape contains extensive microscopic epistasis , with the standard deviation of the pairwise epistasis @xmath80 on the same order as @xmath81 .",
    "the fitness effect of a given mutation is therefore barely heritable .",
    "however , much of this idiosyncratic microscopic epistasis averages out at the level of the dfe , which depends on the genetic background only through the fitness @xmath79 .",
    "the dynamics of adaptation become particularly simple when @xmath77 is exponentially distributed , since the beneficial portion of the dfe remains exponential ( with the same mean ) regardless of the fitness .",
    "instead , epistasis primarily acts to reduce the beneficial mutation rate via @xmath82 , where @xmath67 is the average fitness effect in the ancestral background . in the weak - mutation limit",
    ", this diminishing mutation rate leads to the same logarithmic fitness trajectory as eq .",
    "( [ eq : wiser - trajectory ] ) , with @xmath83 and @xmath84 @xcite .",
    "thus , the fitnesses in fig .",
    "[ fig : trajectory ] can also be reproduced in this model of extreme epistasis , in addition to the purely additive model in eq .",
    "( [ eq : wiser - dfe ] ) .",
    "however , the corresponding mutation trajectory , @xmath85 contains no free parameters .",
    "this form of @xmath86 implies a beneficial substitution rate of essentially zero after @xmath87 generations , which is clearly inconsistent with the data , both on a curve - fitting level ( fig .",
    "[ fig : mutation - curvefits ] ) and in simulation ( fig .",
    "[ fig : uncorrelated - fit ] ) .",
    "thus , while the fitness trajectory is consistent with an uncorrelated landscape , this model is again unable to reproduce the observed mutation trajectory .",
    "the general patterns of macroscopic epistasis in the uncorrelated landscape can also be realized in other models which have much less microscopic epistasis .",
    "for example , a key simplifying assumption of the uncorrelated landscape is that the effective beneficial mutation rate only depends on the fitness of the genetic background and not on its specific genotype .",
    "this leads us to consider a broader class of models of the form @xmath88 where the shape of the dfe is similarly mediated by fitness .",
    "this form of epistasis has been implicated in recent genetic reconstruction studies @xcite , and it has been hypothesized to describe the patterns of epistasis in the ltee as well @xcite . most of these studies have focused on an even simpler class of models of the form @xmath89 where the fitness - dependence of the dfe is given by a simple change of scale .",
    "we assume by convention that @xmath90 , so that @xmath43 represents the ancestral dfe . in the weak mutation limit , the fitness trajectories for eq .",
    "( [ eq : macroscopic - rescaling - epistasis ] ) must satisfy the implicit relation @xmath91 where @xmath92 .",
    "we can then invert this equation to solve for @xmath77 as a function of the fitness trajectory : @xmath93^{1/2 } \\ , .",
    "\\label{eq : general - fitness - mediated - epistasis}\\end{aligned}\\ ] ] thus , like the finite - sites model above , we can reproduce a given fitness trajectory with the rescaled dfe in eq .",
    "( [ eq : macroscopic - rescaling - epistasis ] ) by choosing the correct form for @xmath77 . note , however , that eq .",
    "( [ eq : general - fitness - mediated - epistasis ] ) implicitly assumes that the right - hand side exists and is a real - valued function , which is satisfied for all @xmath94 .",
    "this is a less restrictive condition than we found for the finite sites model in eq .",
    "( [ eq : general - finite - dfe ] ) , which reflects the fact that fitness - mediated epistasis can generate accelerating as well as decelerating fitness trajectories with the appropriate choice of @xmath77",
    ".    we can realize this model microscopically by assuming that fitness effects of individual mutations obey the same scaling relation , @xmath95 which allows us to make predictions for microscopic quantities like the fitness effects of reconstructed strains . however , there is not complete freedom to choose @xmath77 in this microscopic model , since the combined effects of a sequence of mutations must commute with each other .",
    "the only rescaling that satisfies this commutative property is the linear relation @xmath96 , where @xmath15 represents the global fitness maximum . in this case , the fitness effect of each mutation is scaled by the fractional distance to the peak , similar to the `` stick - breaking '' model of @xcite . in the weak - mutation limit , this model reproduces the hyperbolic fitness trajectory @xmath97 which has been used to fit the ltee fitness data in previous studies @xcite . however , as shown by @xcite , eq .  ( [ eq : hyperbolic - trajectory ] ) provides a relatively poor fit to the observed fitness trajectory ( fig .",
    "[ fig : trajectory - curvefits ] ) , even after accounting for clonal interference ( posterior predictive @xmath98 ) .",
    "this allows us to rule out all microscopic models of the form in eq .",
    "( [ eq : microscopic - rescaling - epistasis ] ) .     constructed for the global diminishing returns model in eq .",
    "( [ eq : wiser - epistasis ] ) with an exponential ancestral dfe .",
    "note the change in scale for the relative error in the mutation trajectory .",
    "[ fig : wiser - fit ] ]    for other choices of @xmath77 , eq .",
    "( [ eq : macroscopic - rescaling - epistasis ] ) will hold only in a statistical sense , with a more complicated pattern of microscopic epistasis than predicted by eq .",
    "( [ eq : microscopic - rescaling - epistasis ] ) ( file  s1 ) . @xcite",
    "have shown that the logarithmic fitness trajectory in eq .",
    "( [ eq : wiser - trajectory ] ) can be recovered by setting @xmath99 however , like the additive and uncorrelated models above , the mutation trajectory in this case is strongly constrained by @xmath11 . in the weak mutation limit , the mutation trajectories for eq .",
    "( [ eq : macroscopic - rescaling - epistasis ] ) must satsify @xmath100^{1/2 } \\ , dt \\",
    ", , \\label{eq : general - wiser - mutation - trajectory}\\end{aligned}\\ ] ] with only an overall scale @xmath101 that can be tuned to fit the data .",
    "note that the shape of @xmath43 remains largely unconstrained by this choice : two beneficial dfes with the same @xmath102 can reproduce the same pair of fitness and mutation trajectories , although the required value of @xmath72 will be different .    for the logarithmic fitness trajectory in eq .",
    "( [ eq : wiser - trajectory ] ) , @xcite have shown that the corresponding mutation trajectory grows as a square root of time : @xmath103 at first glance , eq .",
    "( [ eq : wiser - mutation - trajectory ] ) appears to give a decent fit to the observed mutation trajectory ( fig .",
    "[ fig : mutation - curvefits ] ) , although it systematically overestimates the curvature .",
    "however , the best - fit scale @xmath104 lies in the clonal interference regime , so we must again turn to our computational framework to rigorously compare this model with the data .",
    "to do so , we performed a grid search over combinations of @xmath66 , @xmath67 , and @xmath105 for an exponential ancestral dfe , @xmath106 , which was the specific generative model proposed by @xcite .",
    "the posterior predictive @xmath73-value for the fitness trajectory is @xmath74 , which shows that the global diminishing returns model can still reproduce the observed fitness trajectory even when @xmath107 .",
    "figure  [ fig : wiser - fit]a shows the average fitness and mutation trajectories for all parameters with @xmath68 . as expected , there is a large `` ridge '' of parameter values that reproduce the observed fitness trajectory , but the vast majority of these parameter combinations are inconsistent with the observed mutation trajectory .",
    "those parameters with the best estimates of @xmath28 still display some small systematic errors , underestimating the number of mutations in the first part of the experiment and overestimating them later ( fig .",
    "[ fig : wiser - fit]b ) .",
    "the numerical values of these parameters are also wildly unrealistic , since they predict that the mutation rate to fitness effects above @xmath108 is more than a quarter of the genomic point mutation rate . in light of this information , we conclude that the mutation data is inconsistent with the particular global diminishing returns model proposed by @xcite .    however , our findings in the sswm limit above suggest that the precise value of the estimated beneficial mutation rate can dramatically vary with the shape of the ancestral dfe , while the predictions of eqs .",
    "( [ eq : general - fitness - mediated - epistasis ] ) and ( [ eq : general - wiser - mutation - trajectory ] ) are insensitive to this choice .",
    "similar insensitivity to the dfe has been noted in the clonal interference regime as well @xcite . in accordance with this intuition ,",
    "the inferred parameters become more realistic if we truncate the exponential distribution at @xmath109 , although the systematic errors in the mutation trajectory remain ( fig .",
    "[ fig : modified - wiser - fit ] ) . compared to the finite - sites model and uncorrelated landscape above ( as well as the original wiser _ et al _ model ) , this modified version of the global diminishing returns model is the only one that can plausibly reproduce _ all _ of the observed data .      while the discrepancies in the mutation trajectory are too small to reject the fitness - mediated epistasis model outright , these systematic errors still suggest that the model defined by eq .",
    "( [ eq : wiser - epistasis ] ) may be missing a key feature of the experiment .",
    "this argues for a degree of caution in interpreting the parameters inferred in fig .",
    "[ fig : wiser - fit ] , particularly far into the future where the errors in the fitness and mutation trajectories start to grow larger .",
    "of course , we could continue to postulate more elaborate models of epistasis to account for the mutation trajectory , and with enough additional parameters this approach is likely to be successful .",
    "for example , the fitness and mutation trajectories can both be reproduced by generalized finite sites models where we can tune the individual target sizes ( file s1 ) , or by fitness - mediated epistasis models where the overall mutation rate also depends on the fitness .",
    "but without a biological basis for choosing among the space of possible models , these additional assumptions are likely to overfit the mutation trajectory and lead to incorrect predictions for other observables ( e.g. , genetic diversity or variation among lines ) .",
    "instead , we focus on an alternative class of models that are simpler in some ways , though more complex in others .",
    "c , along with the predictions of the non - epistatic curve in eq .",
    "( [ eq : nonepistatic - trajectory ] ) ( solid lines ) .",
    "the estimated parameters are @xmath110 and @xmath111 . for comparison , the best - fit logarithmic trajectory from eq .",
    "( [ eq : wiser - trajectory ] ) is shown by the dashed line .",
    "( inset ) predictions for the average change in fitness between generations 40,000 and 50,000 ( lines ) compared to the independent measurement from the inset of fig .",
    "[ fig : trajectory]b ( square ) .",
    "( b ) the likelihood of the fitness trajectory for a constant , exponential dfe truncated at @xmath112 , with a @xmath113-intercept fitted using maximum likelihood .",
    "we have only included parameters whose substitution rates are consistent with the observed mutation trajectory ( @xmath114 ) .",
    "[ fig : after-10k - fit ] ]    revisiting the original data in fig .",
    "[ fig : trajectory ] , we note that we were initially led to consider models of macroscopic epistasis , rather than a constant dfe , because of the differences between the initial part of the experiment ( e.g. , before generation 10,000 ) and the later part of the experiment ( e.g. , after generation 10,000 ) .",
    "the differences in the rate of adaptation are so striking that we can clearly rule out a constant dfe even without a rigorous statistical comparison .",
    "in contrast , the deceleration in the fitness trajectory in the final 40,000 generations of evolution is much less pronounced .",
    "this leads us to consider a simple statistical question : does the later portion of the experiment actually contain evidence of macroscopic epistasis , or are we simply extrapolating from the strong deceleration in the early part of the fitness trajectory ?",
    "we can frame this statistical question as a model of epistasis with two evolutionary epochs : an initial `` poorly adapted '' phase in the first 10,000 generations followed by a more `` well - adapted '' phase for the remaining 40,000 generations .",
    "we do not attempt to model the initial phase , but instead simply assume that the population is subject to some complicated and unspecified model of epistasis that generates the observed data with probability one .",
    "this could account for the fact that the large - effect mutations available at the beginning of the experiment might depend on specific details of the ancestral strain or other experimental details .",
    "after this initial phase of adaptation is complete , the population enters a second phase of evolution with negligible macroscopic epistasis . in other words , rather than try to fit a single model of a changing dfe to the whole experiment , we neglect the first 10,000 generations and instead try to fit an evolutionary model with a constant dfe to the last 40,000 generations of evolution .    assuming a constant dfe implies that the fitness and mutation trajectories after generation 10,000 are given by @xmath115 this fitness trajectory has the same number of nominal parameters as the logarithmic curve in eq .",
    "( [ eq : wiser - trajectory ] ) , although it is important to remember that eq .",
    "( [ eq : wiser - trajectory ] ) carries an implicit functional degree of freedom that was used to obtain the logarithmic trajectory in the first place .",
    "figure  [ fig : after-10k - fit ] shows that even on a purely curve - fitting level , the non - epistatic fitness trajectory is only marginally less accurate than its epistatic counterpart .",
    "we infer an adaptation rate of @xmath116 per 1000 generations and a substitution rate of @xmath117 per 1000 generations .",
    "although this adaptation rate appears to overestimate the fitness gain after generation @xmath118 , the more precise fitness assays performed between generations @xmath118 and @xmath119 corroborate the @xmath120 increase ( fig .",
    "[ fig : after-10k - fit ] , inset ) .",
    "the fitted values of @xmath14 and @xmath121 can be used to infer the typical fitness effect of a fixed mutation and a corresponding effective mutation rate based on the relations @xmath122 derived in previous theoretical work @xcite . for the values of @xmath14 and @xmath121",
    "above , we find a typical fixed fitness effect of order @xmath123 and an effective mutation rate of order @xmath124 .    however , this discussion has so far been based purely on curve - fitting and not on a specific generative model of the dynamics . using our computational framework",
    ", we can evaluate the fit of the two - epoch model more rigorously .",
    "to do so , we performed a grid search over combinations of @xmath66 , @xmath67 , and @xmath15 for a truncated exponential distribution ( @xmath109 ) . recall that there is little power to infer the shape of the dfe in this model",
    "; we chose the truncated exponential distribution because its parameters can be directly compared to the best - fit diminishing returns model in eq .",
    "( [ eq : wiser - epistasis ] ) .",
    "we find that the best non - epistatic models are statistically consistent with the observed fitness trajectory ( @xmath74 ; @xmath75 test ) , and provide only a marginally worse fit than the diminishing returns models above ( @xmath125 ) .",
    "moreover , this difference in likelihood vanishes completely if we restrict our attention to the last @xmath126 generations of the experiment rather than the last @xmath118 .",
    "together , these results suggest that there is limited evidence for macroscopic epistasis in the later portion of the ltee based on the currently available data .",
    "genetic reconstructions provide numerous examples of interactions between the fitness effects of individual mutations .",
    "the existence of these interactions is hardly surprising , given the physiological and developmental complexity of most organisms .",
    "however , the evolutionary implications of these interactions remain controversial . in this study",
    ", we used longitudinal data from a long - term evolution experiment in _ e. coli _ to investigate the evolutionary influence of epistasis in a simple empirical setting .",
    "we focused on two basic questions : ( 1 ) how do naturally occurring patterns of epistasis alter the rate of fitness increase and the accumulation of new mutations in a constant environment ? and",
    "( 2 ) what are the simplest models of epistasis that are consistent with the observed data ?",
    "the first of these questions is largely descriptive , and has been the focus of previous work in this experimental system and many others @xcite .",
    "the latter question , in contrast , demands a quantitative approach , and must account for the fact that the underlying model of epistasis can only be observed through the filter of population genetic stochasticity and measurement error . in this study",
    ", we developed a computational framework to account for these confounding factors , which allows us to quantify the consistency of a predicted fitness trajectory using well - established statistical tools .",
    "combined with analytical results in the weak - mutation limit , we used this framework to investigate the compatibility of several popular models of epistasis .",
    "we found that the shape of a decelerating fitness trajectory on its own provides little power to distinguish between different models of epistasis , including finite - sites models that lack any direct interactions between mutations .",
    "this suggests that the underlying `` symmetry group '' or universality class for this observable may be quite large @xcite , which could potentially explain why previous studies have been so successful at fitting the ltee fitness trajectory with simple epistatic models @xcite .",
    "however , this symmetry is broken as soon as we include information about the number of mutations that have accumulated , and the combination of fitness and genetic data places much stronger constraints on the set of possible models .",
    "of the simple 2 and 3-parameter models considered here , we found that a variant of the global diminishing returns model proposed by @xcite provides the best fit to the observed data , although certain systematic errors still remain .",
    "these systematic errors , combined with the weak - diminishing returns signal in the first five mutations in the ara-1 population ( file  s1 ) , suggest a degree of caution in interpreting the support for this model .    instead , we find that the data are equally well explained by a two - epoch model of adaptation , in which an initial burst of macroscopic epistasis is followed by a steady accumulation of mutations under a constant dfe .",
    "although this model offers no insight into the initial ( presumably idiosyncratic ) phase of adaptation , it provides a more parsimonious explanation for the dynamics in the latter phase of the experiment .",
    "moreover , given that this second phase accounts for three quarters of the present duration of the ltee and more than half of the accumulated mutations , it could be argued that it provides a better description of the `` typical '' dynamics of adaptation in a constant environment than the initial , epistatic phase of the adaptive walk . under this hypothesis ,",
    "the widespread diminishing returns epistasis observed in other experimental systems may simply be a reflection of their comparatively brief duration .    in light of this speculation ,",
    "it is worth commenting on the population genetic parameters estimated in the second , slower phase of the ltee .",
    "when faced with a constant environment , it is natural to expect that a population will eventually enter a slower phase of adaptation once the most obvious beneficial mutations are exhausted .",
    "however , this steady - state is usually assumed to have a negligible beneficial mutation rate and correspondingly simple evolutionary dynamics .",
    "in contrast , the scaled mutation rates that we estimate for the ltee are surprisingly large ( @xmath127 ) , and are comparable to rapidly evolving laboratory yeast populations near the beginning of their adaptive walk @xcite .",
    "although the fitness effects of these mutations ( @xmath128 ) fall below the resolution limit of most fitness assays , the effective population size is large enough that the scaled selection strengths are quite large from a population genetic standpoint ( @xmath129 ) .",
    "interestingly , these scaled beneficial mutation rates and selection strengths are sufficiently large that deleterious mutations are expected to have a negligible influence on the rate of adaptation @xcite .",
    "( we also note that extrapolating these estimates to the mutator lines would suggest that the declining mutation rate observed in ara-1 @xcite may involve selection for more than just a reduced deleterious load . )    together , these estimates suggest that even the `` slow '' phase of the ltee is characterized by rapid adaptation , in which multiple beneficial mutations compete for fixation at the same time .",
    "these dynamics are illustrated by the simulated mutation trajectories in fig .",
    "[ fig : hypothetical - timecourse ] , which display an even greater amount of hitchhiking and clonal interference than similar trajectories measured in a recent evolution experiment in yeast @xcite .",
    "however , since the individual fitness effects are an order of magnitude smaller , the competition between beneficial mutations occurs over a much longer timescale than is normally observed in experimental evolution .",
    "for example , it is not uncommon to find a beneficial mutation that persists for thousands of generations at intermediate frequencies before it accumulates enough additional mutations to sweep to fixation .",
    "these transiently stable polymorphisms would suggest adaptive radiation or frequency - dependent selection on a more traditional experimental timescale ( e.g. less than @xmath130 generations ) , but they arise here as a natural consequence of the population genetic process .    of course , the preceding discussion should be treated with a degree of caution , since our present estimates are based on a limited number of clone sequences and relatively noisy fitness measurements .",
    "it is possible that additional data would indicate a departure from the constant adaptation rate in the second phase of the experiment , or reverse some of the systematic errors of the global diminishing returns model .",
    "moreover , even a perfectly resolved fitness and mutation trajectory will likely be consistent with more than one evolutionary model , just as a perfectly resolved fitness trajectory is consistent with multiple mutation trajectories .",
    "our estimates should therefore be viewed as merely consistent with the available data , rather than strongly supported by them .",
    "nevertheless , our results demonstrate that an easy - to - measure genetic observable such as the mutation trajectory can greatly restrict the set of models that are consistent with a measured fitness trajectory .",
    "additional information about the genetic diversity within the population ( e.g. , measured from pairwise heterozygosity among clones ) will likely provide even more power to distinguish between competing hypotheses .",
    "the computational framework developed here provides a powerful and flexible method for incorporating this genetic information as it becomes available .",
    "we thank sergey kryazhimskiy , elizabeth jerison , and daniel rice for useful discussions , and joshua plotkin , david mccandlish , and two reviewers for helpful comments on the manuscript .",
    "this work was supported in part by a national science foundation graduate research fellowship , the james s. mcdonnell foundation , the alfred p. sloan foundation , the harvard milton fund , grant phy 1313638 from the nsf , and grant gm104239 from the nih .",
    "simulations in this paper were performed on the odyssey cluster supported by the research computing group at harvard university .",
    "\\2014 . a bayesian mcmc approach to assess the complete distribution of fitness effects of new mutations : uncovering the potential for adaptive walks in challenging environments .",
    "196:841852 .",
    "\\2010 . _ escherichia coli _ rpob mutants have increased evolvability in proportion to their fitness defects . 27:1338 .",
    "\\2009 . genome evolution and adaptation in a long - term experiment with _",
    "escherichia coli_. 461:12431247 .",
    "effects of linkage on rates of molecular evolution . 85:64146418 .",
    "historical contingency and the evolution of a key innovation in an experimental population of _",
    "escherichia coli_. 105:78997906 .",
    "evolvability of an rna virus is determined by its mutational neighbourhood .",
    "406:625628 .",
    "diminishing returns epistasis among beneficial mutations decelerates adaptation .",
    "332:11901192 .",
    "the genetic landscape of a cell . 327:425431 .",
    "\\2014 . empirical fitness landscapes and the predictability of evolution .",
    "15:480490 .",
    "beneficial mutation selection balance and the effect of genetic linkage on positive selection .",
    "176:17591798 .",
    "selection biases the prevalence and type of epistasis along adaptive trajectories .",
    "67:31203131 .",
    "asexual evolution waves : fluctuations and universality .",
    "2013:p01011 .",
    "\\1930 . the distribution of gene ratios for rare mutations . 50:204219 .",
    "clonal interference , multiple mutations and adaptation in large asexual populations .",
    "180:21632173 .",
    "generative models versus underlying symmetries to explain biological pattern",
    ". 27:11721178 .",
    "the fates of mutant lineages and the distribution of fitness effects of beneficial mutations in laboratory budding yeast populations . 196:12171226 .",
    "the fate of competing beneficial mutations in an asexual population .",
    "127:127144 .",
    "molecular evolution over the mutational landscape .",
    "38:11161129 .",
    "deleterious passengers in adapting populations . 198:11831208 .",
    "distribution of fixed beneficial mutations and the rate of adaptation in asexual populations .",
    "109:49504955 .    \\1989 .",
    "wonderful life : the burgess shale and the nature of history .",
    "w w norton , new york .",
    "the mathematical theory of natural and artificial selection , part v : selection and mutation .",
    "23:828844 .",
    "an equivalence principle for the incorporation of favorable mutations in asexual populations .",
    "311:16151617 .",
    "epistatic buffering of fitness loss in yeast double deletion strains .",
    "39:550554 .",
    "\\1987 . towards a general theory of adaptive walks on rugged landscapes . 128:1145 .    \\1989 . the nk model of rugged fitness landscape and its application to maturation of the immune response .",
    "141:211245 .",
    "negative epistasis between beneficial mutations in an evolving bacterial population .",
    "332:11931196 .    \\1978 . a simple model for the balance between selection and mutation . 15:112 .    \\2010 . using deep sequencing to characterize the biophysical mechanism of a transcriptional regulatory sequence",
    ". 107:91589163 .",
    "the dynamics of adaptation on correlated fitness landscapes .",
    "106:1863818643 .",
    "population subdivision and adaptation in asexual populations of saccharomyces cerevisiae .",
    "66:19311941 .",
    "global epistasis makes adaptation predictable despite sequence - level stochasticity .",
    "344:15191522 .",
    "\\2008 . estimating the per - base - pair mutation rate in the yeast _ saccharomyces cerevisiae_. 178:6782 .",
    "pervasive genetic hitchhiking and clonal interference in forty evolving yeast populations .",
    "500:571574 .",
    "rate and molecular spectrum of spontaneous mutations in the bacterium _ escherichia coli _ as determined by whole - genome sequencing .",
    "109:e2774e2783 .",
    ". long - term experimental evolution in escherichia coli .",
    "i. adaptation and divergence during 2,000 generations .",
    "138:13151341 .",
    "dynamics of adaptation and diversification : a 10,000-generation experiment with bacterial populations . 91:68086814 .",
    "\\2010 . diminishing returns from beneficial mutations and pervasive epistasis shape the fitness landscape for rifampicin resistance in _",
    "pseudomonas aeruginosa_. 186:13451354 .",
    "highly variable mutation rates in commensal and pathogenic _",
    "escherichia coli_. 277:18331834 .",
    "the inevitability of unconditionally deleterious substitutions during adaptation . evolution . 68:13511365 .",
    "2014b . on the role of epistasis in adaptation . .",
    "mutational effects and population dynamics during viral adaptation challenge current models",
    ". 187:185202 .",
    "stickbreaking : a novel fitness landscape model that harbors epistasis and is consistent with commonly observed patterns of adaptive evolution .",
    "190:655667 .",
    "the population genetics of adaptation : the adaptation of dna sequences . 56:13171330 .",
    "rates of fitness decline and rebound suggest pervasive epistasis .",
    "68:150162 .",
    "recursive genomewide recombination and sequencing reveals a key refinement step in the evolution of a metabolic innovation in _",
    "escherichia coli_. 111:22172222 .",
    ". long - term experimental evolution in escherichia coli .",
    "dynamics of a balanced polymorphism . 155:2435 .",
    "emergent neutrality in adaptive asexual evolution .",
    "189:13611375 .",
    "modular epistasis in yeast metabolism .",
    "37:7783 .",
    "evolution and extinction dynamics in rugged fitness landscapes .",
    "12:361391 .",
    "\\2007 . understanding the evolutionary fate of finite populations : the dynamics of mutational effects .",
    "5:e94 .    \\2007 .",
    "systematic pathway analysis using high - resolution fitness profiling of combinatorial gene deletions .",
    "39:199  206 .",
    "\\2012 . the molecular diversity of adaptive convergence . 335:457461 .",
    "darwinian evolution can follow only very few mutational paths to fitter proteins . 312:111114 .",
    "different trajectories of parallel evolution during viral adaptation . 285:422424 .",
    "mutation rate inferred from synonymous substitutions in a long - term evolution experiment with escherichia coli .",
    "1:183186 .",
    "\\2013 . mutation rate dynamics in a bacterial population reflect tension between adaptation and genetic load .",
    "110:222227 .",
    "long - term dynamics of adaptation in asexual populations . 342:13641367 .    \\2011 .",
    "second - order selection for evolvability in a large _ escherichia coli _ population .",
    "331:14331436 .",
    "the roles of mutation , inbreeding , crossbreeding and selection in evolution .",
    "proceedings of the vi international congress of genetics , pp . 356366 .",
    "precise estimates of mutation rate and spectrum in yeast . 111:e2310e2318 .",
    "[ [ fitness - trajectories . ] ] fitness trajectories .",
    "+ + + + + + + + + + + + + + + + + + + + +    the fitnesses of the ltee strains were calculated from eq .",
    "( [ eq : fitness ] ) using the raw competition assays reported by @xcite .",
    "the quantity @xmath131 was estimated from the ratio of red and white colonies when plated on arabinose media , and the duration each competition was @xmath132 generations .",
    "the fitness gains between generation @xmath118 and @xmath119 were calculated in a similar manner , but with a longer competition time of @xmath133 generations .",
    "subsequent analysis of the fitness trajectory was restricted to the six non - mutator populations with complete fitness measurements : ara@xmath134 , ara@xmath135 , ara@xmath136 , ara@xmath137 , ara@xmath138 , and ara@xmath139 @xcite .",
    "these populations were chosen because they have complete fitness trajectories that can be reasonably expected to evolve under the same population genetic model .",
    "notably , this subset excludes both the citrate - metabolizing population ( ara@xmath140 ) studied by @xcite , as well as the crossfeeding population ( ara@xmath141 ) studied by @xcite .",
    "[ [ fitness - effects - of - individual - mutations . ] ] fitness effects of individual mutations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the fitness effects of the five mutations in fig .  [",
    "fig : khan - trajectory ] were calculated from the raw competition assays reported by @xcite .",
    "the fitness effect @xmath1 was defined as the difference between the fitness of the mutant and background genotypes , which were estimated from the competition assays using the same procedure as above .",
    "[ [ the - mutation - trajectory . ] ] the mutation trajectory .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    the total number of genetic changes was estimated from the dna sequences of clones analyzed by @xcite and @xcite .",
    "the finalized mutation calls for the clones in @xcite were obtained from supplementary tables 1 and 2 of that work , and the mutation calls for the clones in @xcite were obtained from the supplementary data files available at http://barricklab.org/twiki/pub/lab/supplementlongtermmutationrates/long-term_mutation_rates.zip . to obtain a more densely sampled mutation trajectory",
    ", we included clones from populations that were excluded from the fitness trajectory analysis above .",
    "this includes seven clones sampled from the ara@xmath142 population prior to the spread of the mutator phenotype , and two clones sampled from the ara@xmath140 population prior to the spread of the citrate - metabolizing phenotype .",
    "the complete list of included clones is given in table  [ table : clone - list ] .",
    "[ [ population - genetic - simulations . ] ] population genetic simulations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    simulated fitness and mutation trajectories were obtained from a forward - time algorithm designed to mimic the serial transfer protocol of the ltee . between each transfer",
    ", lineages are assumed to expand clonally for @xmath143 generations at a deterministic exponential growth rate @xmath144 , where @xmath6 is the fitness relative to the ancestor . at the transfer step",
    ", the population is diluted 100-fold ( with poisson sampling noise ) to @xmath145 individuals .",
    "mutations accumulate at a constant rate @xmath66 during the growth phase , but we assumed that they do not significantly influence the fitness of the individual until the next transfer cycle .",
    "thus , mutation was approximated by assuming that each individual has a probability @xmath146 of gaining a mutation at the end of a transfer step , with additive fitness effects drawn from the genotype - specific dfe , @xmath0 .",
    "for the finite - sites model , a discrete ancestral dfe was initialized by drawing @xmath147 fitness effects from the continuous distribution @xmath43 , with the same realization shared across replicate lines .",
    "a copy of our implementation in ` c++ ` is available at ` https://github.com/benjaminhgood/ltee_inference ` .",
    "[ [ likelihood - estimation . ] ] likelihood estimation .",
    "+ + + + + + + + + + + + + + + + + + + + + +    the likelihood of each parameter combination was estimated from simulations using eq .",
    "( [ eq : approx - likelihood ] ) . to speed computation",
    ", we simulated 18 replicate populations and generated @xmath148 different 6-population averages by bootstrap resampling .",
    "the scaled likelihood @xmath149 , which differs from @xmath150 by a constant factor , was defined as @xmath151 \\\\      & \\times \\exp \\left [ - \\frac{({\\delta { \\overline{x}}}_\\mathrm{obs } - { \\delta { \\overline{x}}}_i)^2}{2 { \\sigma_{\\mathrm{err},{\\delta { \\overline{x}}}}}^2 } \\right ] \\ , , \\end{aligned}\\end{aligned}\\ ] ] where the measurement uncertainties @xmath23 and @xmath24 were estimated from fig .",
    "[ fig : trajectory ] .    [ [ statistical - tests . ] ] statistical tests .",
    "+ + + + + + + + + + + + + + + + + +    the consistency of each parameter combination was assessed using a @xmath75 goodness - of - fit test .",
    "we simulated 18 replicate populations to estimate @xmath11 and @xmath25 , and we generated @xmath152 different 6-population averages by bootstrap resampling these replicates and adding unbiased gaussian measurement noise with @xmath153 and @xmath154 .",
    "the @xmath73-value is then approximated by @xmath155 \\approx \\frac{1}{n } \\sum_{i=1}^n \\theta \\left ( \\chi_i^2 - \\chi_\\mathrm{obs}^2 \\right)\\end{aligned}\\ ] ] where @xmath156 is the heaviside step function and @xmath157 is the mean squared error , @xmath158 the posterior predictive @xmath73-value for the entire model is then defined by @xmath159 p(\\overline{x}_\\mathrm{obs}|\\theta ) p(\\theta ) \\",
    ", d\\theta}{\\int p(\\overline{x}_\\mathrm{obs}|\\theta ) p(\\theta ) } \\ , d\\theta \\ , , \\end{aligned}\\ ] ] where @xmath160 is the prior distribution of parameter values .",
    "to predict the patterns of fitness and mutation accumulation in the ltee , our population genetic model utilizes the key approximation , @xmath161 which partitions the dfe into a set of strongly beneficial `` driver '' mutations and a collection of nearly neutral `` passengers '' @xcite . by assumption",
    ", the driver mutations set the important evolutionary timescales in the system ( e.g. , the rate of adaptation and the coalescence timescale ) , while the passenger mutations constitute a perturbative correction . in recent theoretical work , we have shown that this approximation is accurate when the mutation rate is small compared to the relevant fitness differences in the population @xcite , which is expected to be the case for the non - mutator lines in the ltee . note that as defined above , the passenger portion of the dfe is comprised not only of truly neutral mutations ( @xmath162 ) , but also those mutations that approach the neutral substitution rate by hitchhiking with the beneficial drivers . as such",
    ", @xmath163 has an implicit dependence on both @xmath164 and @xmath165 .",
    "since @xmath163 is an effective parameter , it can not be measured directly .",
    "instead , it must be self - consistently inferred from the data along with the other model parameters . in principle , this is straightforward : the passenger mutations do not influence the fitness trajectory by construction , so the neutral mutation rate can be estimated from a regression of the mutation trajectory residuals , @xmath166 .",
    "nevertheless , we will find it useful to place some crude bounds on @xmath163 , both to limit the range of the regression and to allow for back - of - the - envelope arguments that do not require the full precision of our computational inference scheme . to establish these bounds",
    ", we will make use of the fact that the neutral mutation rate can not exceed the total per genome mutation rate or the observed mutation accumulation rate .",
    "unlike the @xmath163 , the total genomic mutation rate is a directly measurable quantity , although these measurements can be confounded by dependence on the genetic background @xcite , genomic heterogeneity @xcite , and the role of complex mutational events . in previous work ,",
    "@xcite estimated that the total point mutation rate in the ltee strain is approximately @xmath167 , based on the number of synonymous mutations that have accumulated over the course of the experiment . a mutation accumulation study in a different strain of _",
    "e. coli _ found that small indels occur approximately an order of magnitude less freuqently than point mutations @xcite , or @xmath168 .",
    "this is comparable to observations in other organisms such as yeast @xcite . in comparison ,",
    "much less is known about the mutation rate for larger indels and other chromosomal rearrangements , such as those arising from insertion sequence ( is ) elements .",
    "this uncertainty is particularly problematic for the ltee , since these complex mutations constitute a substantial fraction of the observed mutation trajectory .",
    "a recent mutation accumulation study in a different strain of _",
    "e. coli _ estimated that the total rate of is events in their background is approximately @xmath169 . in the ltee lines ,",
    "@xmath170 rearrangements were observed across all twelve populations by generation 40,000 , which suggests that the mutation rate to neutral is mutations is bounded by @xmath171 .",
    "however , this is likely to be an overestimate , since some of these mutations are probably beneficial .",
    "for example , in the single population where timecourse information is available ( ara-1 ) , the accumulation of rearrangements slows significantly after 10,000 generations .",
    "if we restrict our attention to the mutations that have accumulated after generation 10,000 , the bound on @xmath172 drops to @xmath173 , which is more in line with the rate of small indels .",
    "note , however , that all of these estimates are based on extremely limited data , and are highly susceptible to statistical fluctuations and other ascertainment biases . in the absence of more precise estimates",
    ", we decided to employ the combined bound , @xmath174 with the hope that any underestimation of the rate of complex mutational events is balanced by an overestimation of the neutral fraction of point mutations .",
    "in the main text , we analyzed the patterns of fitness and mutation accumulation in a simple `` running out of mutations '' model of macroscopic epistasis . here , we present our model in more detail , and show how the continuum analysis in the main text emerges from a model which is fundamentally based on a finite number of sites . in the most general form of this model , we consider a collection of @xmath34 sites with fitness effects @xmath175 and target sizes @xmath176 , from which we can define a _",
    "distribution of target sizes and fitness effects , @xmath177 here , @xmath178 can be interpreted as the probability density that a randomly drawn site has a target size @xmath39 and fitness effect @xmath1 . similarly , the marginal distribution @xmath179 can be interpreted as the probability density that a randomly drawn site has fitness effect @xmath1 , independent of the target size .",
    "note that @xmath180 differs from the traditional dfe , @xmath43 , which is the probability density that a randomly drawn _ mutation _ has fitness effect @xmath1 .",
    "since mutations will be biased towards sites with larger target sizes , the dfe corresponds to the weighted integral , @xmath181 so far , our discussion has been purely notational .",
    "the content of this model comes from the assumption that , once a given site has mutated , further mutations at that site are no longer beneficial .",
    "for example , after a loss - of - function mutation in a particular pathway , further loss - of - function mutations in the same pathway are expected to have little to no effect ( @xmath182 ) , while the reversion will restore the original function of the gene ( @xmath183 ) . in the large population limit , these mutated sites will behave as if they are effectively removed from the beneficial portion of the dfe . based on this intuition",
    ", we define a collection of indicator variables @xmath184 , where @xmath185 if a mutation at site @xmath186 has fixed by time @xmath187 .",
    "we can use these indicator variables to define a time - dependent version of @xmath178 , @xmath188 \\delta(\\mu-\\mu_i ) \\delta(s - s_i ) \\",
    ", , \\end{aligned}\\ ] ] which satisfies the initial condition @xmath189 . in the sswm limit , @xmath190 is independent of @xmath191 , so that the latter evolves as @xmath192 or @xmath193 where @xmath194 denotes the expectation value over @xmath184 .",
    "it is similarly straightforward to show that the average fitness and mutation trajectories , @xmath195 and @xmath196 , evolve as    [ eq : modular - epistasis - trajectories ] @xmath197    thus , our model corresponds to the strong - selection ( @xmath198 ) limit of the weak - mutation model analyzed by @xcite .",
    "we recover eqs .",
    "( [ eq : dfe - evolution ] ) , ( [ eq : trajectory - equations ] ) , and ( [ eq : sswm - dfe - evolution ] ) in the main text by demanding that all sites have the same target size @xmath199 , so that @xmath200 note that in the present framework , our pseudo - continuous dfes exist purely for notational convenience , since the set of available mutations is always bounded in practice . however , in certain cases it will be computationally convenient to consider the large @xmath34 limit of these equations , in which sums over discrete numbers of sites are replaced with integrals over a continuous distribution .",
    "we have constructed our notation in such a way that this limit requires no modification of our equations , with the implicit caveat that we can only consider distributions for which this limit is well - defined .",
    "this excludes pathological cases like heavy - tailed dfes , which lead to singular dynamics in the @xmath201 limit .      in this section ,",
    "we show how one can obtain a logarithmic fitness trajectory from a finite sites model with an ancestral dfe , @xmath202 where @xmath203 is a small parameter .",
    "we will make use of the asymptotic expansion @xmath204 the normalizing constant for the dfe is therefore given by @xmath205 and the mean and mean - squared fitness effects are @xmath206 substituting eq .",
    "( [ eq : sswm - dfe - evolution ] ) into eq .",
    "( [ eq : trajectory - equations ] ) , we find that the fitness trajectory is given by @xmath207 \\ , d\\xi \\ , , \\nonumber \\\\      & \\approx \\left ( \\frac{2 n { u_b}\\epsilon \\sigma^2}{1+\\frac{2 n { u_b}\\sigma t}{l } } \\right )   e^{- \\frac{2n{u_b}\\sigma \\epsilon t}{l } } \\ , , \\end{aligned}\\ ] ] which yields a logarithmic fitness trajectory @xmath208 provided that @xmath209 .",
    "when @xmath210 , we have @xmath211 , so we can also write this condition in the form @xmath212 . even after fitting @xmath213 and @xmath56 , there is still sufficient freedom to choose the parameters so that this condition holds for any finite time @xmath214 or fitness @xmath215 .",
    "it is also useful to investigate the consequences of the running out of mutations model when we relax the uniform target size assumption .",
    "this becomes unwieldy in our original dfe notation , but simplifies considerably if we change variables from the target size @xmath39 to the substitution rate @xmath216 . from the change of variables theorem ,",
    "this induces induces a related joint distribution , @xmath217 which allows us to rewrite the fitness and mutation trajectories in the form    [ eq : transformed - modular - epistasis - trajectories ] @xmath218    here , @xmath219 is the marginal distribution of @xmath220 and @xmath221 is the conditional mean of @xmath1 given @xmath220 .",
    "thus , it is easy to see that for a _ fixed _",
    "@xmath222 , the relationship between @xmath11 and @xmath86 is completely determined .",
    "for example , we recover eq .",
    "( [ eq : finite - mutation - trajectory ] ) in the main text when @xmath223 , even if the distribution of target sizes is not completely uniform .",
    "however , it is also clear that if we are allowed to tune @xmath222 and @xmath224 independently , then it is possible to fit both @xmath11 and @xmath28 simultaneously with the inverse laplace transforms    @xmath225    subject to the same technical restrictions on @xmath11 and @xmath86 that we encountered in the text .",
    "see also related results by @xcite , who study similar questions while relaxing the strong selection requirement .",
    "for example , we can reproduce both the fitness and mutation trajectories of the global diminishing returns model in eq .",
    "( [ eq : wiser - epistasis ] ) by choosing @xmath226 where @xmath227 and @xmath228 is a small parameter chosen to maintain normalization .",
    "we can achieve this by choosing a joint distribution for @xmath220 and @xmath1 of the form @xmath229 r^{-3/2 } e^{-r/\\tilde{r } } & \\text{if $ r > \\epsilon \\tilde{r}$ , } \\\\ 0 & \\text{else . }",
    "\\end{cases}\\end{aligned}\\ ] ] switching back to @xmath39 and @xmath1 , we have @xmath230 ( 2ns\\mu)^{-3/2 } e^{-2ns \\mu / \\tilde{r } } & \\text{if $ 2ns\\mu > \\epsilon \\tilde{r}$ , } \\\\ 0 & \\text{else , } \\end{cases } \\nonumber \\\\      & \\propto \\begin{cases }       ( 2ns)^{-1/2 } \\cdot \\delta \\left [ \\mu - \\frac{\\tilde{r } s}{2nc^2 } \\right ] \\mu^{-3/2 } e^{-2 n s \\mu / \\tilde{r } } & \\text{if $ 2ns\\mu > \\epsilon \\tilde{r}$ , } \\\\       0 & \\text{else , } \\end{cases } \\nonumber \\\\      & \\propto \\begin{cases }       \\delta \\left [ \\mu - \\frac{{u_b}\\langle s \\rangle s}{{x_c}c } \\right ] s^{-2 } \\exp \\left [ - \\left ( \\frac{s}{c } \\right)^{2 } \\right ] & \\text{if $ s > c\\sqrt{\\epsilon}$ , } \\\\       0 & \\text{else , }   \\end{cases}\\end{aligned}\\ ] ] where the normalization factor is @xmath231 in terms of the traditional dfe , @xmath43 , we have @xmath232 where the overall mutation rate is given by @xmath233 these expressions show that ( within the context of the sswm limit ) the scaling of @xmath11 and @xmath28 with @xmath234 can not be used to distinguish between the generalized running out of mutations model and the global diminishing returns model in eq .",
    "( [ eq : wiser - epistasis ] ) .",
    "however , the time - dependent dfe , @xmath235 , differs between the two models , which implies that they still constitute different models of macroscopic epistasis . in principle",
    ", these differences can be elucidated by considering additional observables or by probing the scaling with @xmath164 and @xmath72 in the clonal interference regime .",
    "in the main text , we have focused on signatures of epistasis in long - term patterns of fitness and mutation accumulation . since",
    "our inferences are conducted at this aggregate level , it is natural to ask how our results relate to more traditional measures of epistasis derived from the fitness effects of individual mutations .",
    "actual data in this case is somewhat limited , given the general difficulty of identifying and reconstructing mutations that arose during the course of an evolution experiment .",
    "fortunately , in the case of the ltee , a small scale study was recently carried out by @xcite , who reconstructed all @xmath236 allelic combinations of the first 5 mutations that fixed in the ara-1 population .",
    "this allowed them to measure the fitness effects of 5 mutations in 16 different genetic backgrounds , 3 of which showed signatures of diminishing returns epistasis .",
    "one the one hand , it is tempting to apply our global diminishing returns models directly to the full dataset , e.g. , plotting @xmath237 as a function of @xmath6 for each of the 5 mutations . @xcite employed a related method to support the global diminishing returns model in eq .",
    "( [ eq : wiser - epistasis ] ) .",
    "however , as we have argued above , we must be careful when extrapolating from macroscopic models of epistasis to fundamentally microscopic measurements .",
    "in particular , we showed in the text that one can not define a consistent model of microscopic epistasis where @xmath238 , since this would violate the bookkeeping property @xcite .",
    "thus , in a technical sense , the dependence of @xmath237 on @xmath6 can not provide additional evidence for the model in eq .",
    "( [ eq : wiser - epistasis ] ) .",
    "however , there is one aspect of the reconstruction data that _ can _ be used to gauge the support for the macroscopic model in eq .",
    "( [ eq : wiser - dfe ] ) . if global diminishing returns is responsible for the decelerating fitness trajectory in fig .",
    "[ fig : trajectory ] , then the fitness effects of fixed mutations should decrease along the line of descent , independent of their effects in other backgrounds . for example , in the sswm limit , the distribution of fitness effects of fixed mutations ( measured in the background in which they arise ) must satisfy the scaling relation , @xmath239 this distribution becomes more complicated in the clonal interference regime , but the scaling with @xmath77 is approximately preserved up to logarithmic corrections @xcite . in either case , we expect the fitness effects of fixed mutations to decrease roughly proportionally to @xmath77",
    ". however , the data itself shows no such decrease ( fig .",
    "[ fig : khan - trajectory ] ) . of course",
    ", this finding should be treated with a degree of caution , since it is based on a sample of five mutations from @xmath240 with considerable sampling noise .",
    "nevertheless , it implies that there is limited evidence in the @xcite data to suggest that global diminishing returns is driving the deceleration in the fitness trajectory . as suggested by @xcite",
    ", the stronger diminishing returns signal off the line of descent may reflect ascertainment biases inherent in any set of fixed mutations .       ) , ( [ eq : finite - exponential - trajectory ] ) , ( [ eq : hyperbolic - trajectory ] ) , and ( [ eq : nonepistatic - trajectory ] ) .",
    "the best - fit parameters were obtained by minimizing the mean squared error , and the fit of the linear trajectory in eq .",
    "( [ eq : nonepistatic - trajectory ] ) was restricted to the last 40,000 generations of evolution .",
    "[ fig : trajectory - curvefits ] ]    ) , ( [ eq : uncorrelated - mutation - trajectory ] ) , ( [ eq : wiser - mutation - trajectory ] ) , and ( [ eq : nonepistatic - trajectory ] ) .",
    "the best - fit parameters were obtained by minimizing the mean squared error in the presence of an unknown neutral mutation rate @xmath241 , and the fit of the linear trajectory in eq .",
    "( [ eq : nonepistatic - trajectory ] ) was restricted to the last 40,000 generations of evolution .",
    "[ fig : mutation - curvefits ] ]     constructed for the uncorrelated landscape model in eq .",
    "( [ eq : uncorrelated - epistasis ] ) with an exponential ancestral dfe .",
    "note the change in scale for the relative error in the mutation trajectory . to ensure better convergence of the ensemble mean fitness trajectory , we simulated 100 independent populations for bootstrap resampling instead of the 18 used for the other models .",
    "[ fig : uncorrelated - fit ] ]"
  ],
  "abstract_text": [
    "<S> genetic interactions can strongly influence the fitness effects of individual mutations , yet the impact of these epistatic interactions on evolutionary dynamics remains poorly understood . here </S>",
    "<S> we investigate the evolutionary role of epistasis over 50,000 generations in a well - studied laboratory evolution experiment in _ </S>",
    "<S> e. coli_. the extensive duration of this experiment provides a unique window into the effects of epistasis during long - term adaptation to a constant environment . </S>",
    "<S> guided by analytical results in the weak - mutation limit , we develop a computational framework to assess the compatibility of a given epistatic model with the observed patterns of fitness gain and mutation accumulation through time . </S>",
    "<S> we find that a decelerating fitness trajectory alone provides little power to distinguish between competing models , including those that lack any direct epistatic interactions between mutations . </S>",
    "<S> however , when combined with the mutation trajectory , these observables place strong constraints on the set of possible models of epistasis , ruling out many existing explanations of the data . instead , we find that the data are consistent with `` two - epoch '' model of adaptation , in which an initial burst of diminishing returns epistasis is followed by a steady accumulation of mutations under a constant distribution of fitness effects . </S>",
    "<S> our results highlight the need for additional dna sequencing of these populations , as well as for more sophisticated models of epistasis that are compatible with all of the experimental data .    </S>",
    "<S> = 1 </S>"
  ]
}